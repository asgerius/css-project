[{"tags": ["go", "types"], "answers": [{"comments": [{"owner": {"reputation": 578, "user_id": 1092229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a7f76b9b053e428b3e00cad069a7787?s=128&d=identicon&r=PG", "display_name": "barksten", "link": "https://stackoverflow.com/users/1092229/barksten"}, "edited": false, "score": 0, "creation_date": 1446106808, "post_id": 33406445, "comment_id": 54608661, "body": "Thanks. This is what I ended up doing. I just needed some more understanding about go types."}], "tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": true, "score": 1, "last_activity_date": 1446095896, "creation_date": 1446095896, "answer_id": 33406445, "question_id": 33403041, "link": "https://stackoverflow.com/questions/33403041/how-does-type-aliases-work-in-go/33406445#33406445", "title": "How does type aliases work in Go?", "body": "<p>in official document, there are two kinds of type, static type and underlying type. <code>Server</code> is your static type and <code>*gin.Engine</code> is the underlying type. most place in golang just use static type, so <code>Server</code> and <code>*.gin.Engine</code> are two types. check the golang <a href=\"https://golang.org/ref/spec#Types\" rel=\"nofollow\">spec</a></p>\n\n<p>well it not help you in your problem. in your situation, you need <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow\">embedding</a> struct of golang, which help you inherit all method from one struct to another.</p>\n"}], "owner": {"reputation": 578, "user_id": 1092229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a7f76b9b053e428b3e00cad069a7787?s=128&d=identicon&r=PG", "display_name": "barksten", "link": "https://stackoverflow.com/users/1092229/barksten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1446106868, "accepted_answer_id": 33406445, "answer_count": 1, "score": 0, "last_activity_date": 1446107245, "creation_date": 1446073101, "last_edit_date": 1446107245, "question_id": 33403041, "link": "https://stackoverflow.com/questions/33403041/how-does-type-aliases-work-in-go", "closed_reason": "Duplicate", "title": "How does type aliases work in Go?", "body": "<p>I have a type wrapper in my code:</p>\n\n<pre><code>package my_package\nimport \"github.com/gin-gonic/gin\"\ntype Server *gin.Engine\n</code></pre>\n\n<p>It works perfectly fine to use it within my package like:</p>\n\n<pre><code>func NewServer() Server {\n    s:= Server(gin.Default())\n    // I can call *gin.Engine functions on my s here without problems\n    return s\n}\n</code></pre>\n\n<p>In my test suite (which resides in another package) I import my package and get the Server type. However, when I try to call some \"inherited\" functions on it doesn't work.</p>\n\n<pre><code>server_test.go:68: server.ServeHTTP undefined (type my_package.Server has no field or method ServeHTTP)\n</code></pre>\n\n<p>What's going on?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The solution I found is related to @jiang-yd answer below:\nChange the type to a embedding struct</p>\n\n<pre><code>type Server struct {\n    *gin.Engine\n}\n</code></pre>\n\n<p>and change the \"cast\"</p>\n\n<pre><code>s := Server{gin.Default()}\n</code></pre>\n"}, {"tags": ["go", "types"], "answers": [{"comments": [{"owner": {"reputation": 7822, "user_id": 107245, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/9667ec81220b1d7acbe6cdf5e2e913c1?s=128&d=identicon&r=PG", "display_name": "Lajos Nagy", "link": "https://stackoverflow.com/users/107245/lajos-nagy"}, "edited": false, "score": 1, "creation_date": 1446069106, "post_id": 33402189, "comment_id": 54595811, "body": "Then why does Double() compile in the first place? How can I add (using operator &#39;+&#39;) two MyInt values? Oh, and by the way, does this mean boxing/unboxing of MyInt values to/from int values?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 7822, "user_id": 107245, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/9667ec81220b1d7acbe6cdf5e2e913c1?s=128&d=identicon&r=PG", "display_name": "Lajos Nagy", "link": "https://stackoverflow.com/users/107245/lajos-nagy"}, "edited": false, "score": 2, "creation_date": 1446069440, "post_id": 33402189, "comment_id": 54595993, "body": "@LajosNagy method resolution and assignment follow different rules, assignment is more strict. If you have two <code>MyInt</code> values you can add them the same as you would two <code>int</code> values, however you can&#39;t add an <code>int</code> and a <code>MyInt</code> without a type conversion because it will say &quot;mismatched types&quot;. example here; <a href=\"https://play.golang.org/p/KNqdbqGpfd\" rel=\"nofollow noreferrer\">play.golang.org/p/KNqdbqGpfd</a> I&#39;d have to read the spec to give a reasonable explanation of how method resolution is done in Go so I think you&#39;d be better served looking into it yourself. I simply avoid situations that require anything more than common sense to know what will happen."}, {"owner": {"reputation": 7822, "user_id": 107245, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/9667ec81220b1d7acbe6cdf5e2e913c1?s=128&d=identicon&r=PG", "display_name": "Lajos Nagy", "link": "https://stackoverflow.com/users/107245/lajos-nagy"}, "edited": false, "score": 0, "creation_date": 1446069794, "post_id": 33402189, "comment_id": 54596172, "body": "Sorry, one more thing: do you know if Go uses boxing/unboxing for MyInt? I mean, is it the size of an int or not? (It can matter if there&#39;s a cost to using MyInt instead of int.)"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 7822, "user_id": 107245, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/9667ec81220b1d7acbe6cdf5e2e913c1?s=128&d=identicon&r=PG", "display_name": "Lajos Nagy", "link": "https://stackoverflow.com/users/107245/lajos-nagy"}, "edited": false, "score": 0, "creation_date": 1446069916, "post_id": 33402189, "comment_id": 54596238, "body": "@LajosNagy nbd, good quesionts. They are the same size, here&#39;s another example demonstrating that ;) <a href=\"https://play.golang.org/p/xSm_OX47HO\" rel=\"nofollow noreferrer\">play.golang.org/p/xSm_OX47HO</a>"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "reply_to_user": {"reputation": 7822, "user_id": 107245, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/9667ec81220b1d7acbe6cdf5e2e913c1?s=128&d=identicon&r=PG", "display_name": "Lajos Nagy", "link": "https://stackoverflow.com/users/107245/lajos-nagy"}, "edited": false, "score": 4, "creation_date": 1446089804, "post_id": 33402189, "comment_id": 54602396, "body": "@LajosNagy This isn&#39;t boxing, there is no actual conversion executing at runtime.  It&#39;s merely a compile time safety check to make sure you don&#39;t add Dollars and Degrees (ie: don&#39;t add unlike types together, regardless of underlying type, unless you say so by &quot;converting&quot; the type."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 1, "creation_date": 1446089846, "post_id": 33402189, "comment_id": 54602415, "body": "to add to that, if the underlying data types are different, ie: int and float64, then there is a runtime conversion to perform"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 4, "last_activity_date": 1446068850, "creation_date": 1446068850, "answer_id": 33402189, "question_id": 33402126, "link": "https://stackoverflow.com/questions/33402126/function-calls-assignment-and-underlying-types-in-go/33402189#33402189", "title": "Function calls, assignment, and &#39;underlying types&#39; in Go", "body": "<p>Go has a strict type system. Just because your type is merely an alias for <code>int</code> doesn't mean you can interchange the two freely, you'll still have to do a type conversion. Below is a working version of your main, here's the code on play ground; <a href=\"https://play.golang.org/p/kdVY145lrJ\">https://play.golang.org/p/kdVY145lrJ</a></p>\n\n<pre><code>func main() {\n    var a int = 3\n    var x MyInt = MyInt(a)  // Why does this fail?\n    fmt.Println(x.Double())\n    var y int = AddTwo(int(x))  // Why does this fail?\n    fmt.Println(y)\n}\n</code></pre>\n"}], "owner": {"reputation": 7822, "user_id": 107245, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/9667ec81220b1d7acbe6cdf5e2e913c1?s=128&d=identicon&r=PG", "display_name": "Lajos Nagy", "link": "https://stackoverflow.com/users/107245/lajos-nagy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "accepted_answer_id": 33402189, "answer_count": 1, "score": 1, "last_activity_date": 1446068850, "creation_date": 1446068611, "question_id": 33402126, "link": "https://stackoverflow.com/questions/33402126/function-calls-assignment-and-underlying-types-in-go", "title": "Function calls, assignment, and &#39;underlying types&#39; in Go", "body": "<p>I'm learning Go (like it so far) but I've run into an interesting problem. The code that fails to compile is:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype MyInt int\n\nfunc (i MyInt) Double() MyInt {\n    return i + i\n}\n\nfunc AddTwo(i int) int {\n    return i + 2\n}\n\nfunc main() {\n    var a int = 3\n    var x MyInt = a  // Why does this fail?\n    fmt.Println(x.Double())\n    var y int = AddTwo(x)  // Why does this fail?\n    fmt.Println(y)\n}\n</code></pre>\n\n<p>Here's the Go Playground link: <a href=\"https://play.golang.org/p/MEqV9yJPBh\" rel=\"nofollow\">MyInt</a></p>\n\n<p>When I try to run this, I get the following errors:</p>\n\n<pre><code>  prog.go:17: cannot use a (type int) as type MyInt in assignment\n  prog.go:19: cannot use x (type MyInt) as type int in argument to AddTwo\n</code></pre>\n\n<p>However, if I'm reading the spec correctly, this code should compile. First of all, the underlying type of <code>MyInt</code> is <code>int</code> <a href=\"https://golang.org/ref/spec#Types\" rel=\"nofollow\">according to this section</a>. In fact, one of the examples given is <code>type T1 string</code> and it says the underlying type of <code>T1</code> is <code>string</code>. So why can't I assign <code>a</code> to <code>x</code>? Don't they have the same underlying type? Same goes for the function call to <code>AddTwo()</code>. Isn't <code>x</code> has the underlying type <code>int</code>? Why can't I use it as an <code>int</code> argument?</p>\n\n<p>Also, how come <code>Double()</code> compiles at all? In the expression <code>i + i</code> I'm adding two <code>MyInt</code> values. The fact that it compiles suggests that <code>MyInt</code> <em>is</em> an <code>int</code> at least in some sense.</p>\n\n<p>Anyhow, I'm a bit confused. So I thought the point of declarations like <code>type MyInt int</code> was that now you can add methods to primitive types. But if you lose the ability to treat them as <code>int</code> (needing to cast), then what's the point of having this whole 'underlying type' business?</p>\n"}, {"tags": ["go", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1446067426, "last_edit_date": 1446067426, "creation_date": 1446064622, "answer_id": 33401155, "question_id": 33400530, "link": "https://stackoverflow.com/questions/33400530/golang-idiomatic-way-to-stop-a-for/33401155#33401155", "title": "golang idiomatic way to stop a for", "body": "<p>I think you answered your own question. In my opinion, it is the cleanest most idiomatic approach. And I think most Gophers would agree. The other options is to share state through some variable which you'd have to wrap in a <code>Mutex</code>, you'd still have a similar for loop though it would have an if at the top or bottom where it checks the flag to see if it's supposed to abort.</p>\n\n<p>I think when creating consumer and producer structs the best design is to clearly name the methods that are intended to run in Go routines like <code>ReadFilesAsync</code> and define the quit and/or abort channel on the same struct. It gives consumers of your classes a clean, simple, consistent thing to interact with. If the method is async, you call it within a go routine. If you want to stop it, the object you called the method on also exposes and abort channel you can signal on to do that. This removes the need for boiler plate code like declaring the abort channel in the calling scope and passing it into the asynchronous method.</p>\n\n<p>EDIT: note this is more about stopping a goroutine than it is about stopping a for. That's just a matter of putting in <code>break</code> or <code>return</code>. The need for coordination only exists if that for loop is running in a goroutine.</p>\n"}, {"tags": [], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "is_accepted": false, "score": 0, "last_activity_date": 1446067286, "creation_date": 1446067286, "answer_id": 33401816, "question_id": 33400530, "link": "https://stackoverflow.com/questions/33400530/golang-idiomatic-way-to-stop-a-for/33401816#33401816", "title": "golang idiomatic way to stop a for", "body": "<p>I don't feel like expert, but I think your approach is good. I could imagine bit different approach with goroutine. The input of goroutines would be a channel of runes. Than ask to stop could be close an input channel and result could be result of each iteration.</p>\n\n<p>But in this simple case it could be probably longer and slower than your code, therefore I thing you write a good code.</p>\n"}, {"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 4, "last_activity_date": 1446071735, "creation_date": 1446071735, "answer_id": 33402766, "question_id": 33400530, "link": "https://stackoverflow.com/questions/33400530/golang-idiomatic-way-to-stop-a-for/33402766#33402766", "title": "golang idiomatic way to stop a for", "body": "<p>Correct, use the <em>quit</em> channel. Especially as you're already sending to the channel in the loop, handling additional one is easy. However, I wouldn't use the form you proposed, but simpler and <em>safer</em> version:</p>\n\n<pre><code>for scanner.Scan() {\n    select {\n    case &lt;- quit:\n        return\n    case processingChan &lt;- scanner.Text():\n    }\n}\n</code></pre>\n\n<p>Why is it safer? Because it doesn't deadlock, contrary to your example with <code>default</code>. You might be lucky and never encounter it, but there're scenarios where you will. The problem lies in the fact you have two routines talking to each other, which always needs a little bit more of attention. Consider this:</p>\n\n<pre><code>quit := make(chan error, 1)\nprod := make(chan int)\n\ngo func() {\n    for n := range prod {\n        runtime.Gosched()\n        if n%66 == 0 {\n            quit &lt;- errors.New(\"2/3 of evil\")\n            return\n        }\n    }\n}()\n\nfor n := 1; n &lt; 1000; n++ {\n    select {\n    case &lt;-quit:\n        fmt.Println(n)\n        return\n    default:\n        prod &lt;- n\n    }\n}\n</code></pre>\n\n<p>// <a href=\"https://play.golang.org/p/3kDRAAwaKR\" rel=\"nofollow\">https://play.golang.org/p/3kDRAAwaKR</a></p>\n\n<p>Boom! Main routine is trying to send to <code>prod</code> channel, but there is nobody to receive it; the same issue with our consumer. </p>\n\n<p>Adding buffers to the channels won't solve the problem either, but would make it less likely.</p>\n\n<p>Compare the previous example with the following change:</p>\n\n<pre><code>select {\ncase &lt;-quit:\n    fmt.Println(n)\n    return\ncase prod &lt;- n:\n}\n</code></pre>\n\n<p>// <a href=\"https://play.golang.org/p/pz8DMYdrVV\" rel=\"nofollow\">https://play.golang.org/p/pz8DMYdrVV</a></p>\n\n<p>Works nicely.</p>\n\n<p>I understand one would like to use the first option to make sure they're quitting as early as possible, but it's usually not a massive issue if you send one or two additional items for processing before exiting.</p>\n"}], "owner": {"reputation": 761, "user_id": 2242116, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/0v7eI.jpg?s=128&g=1", "display_name": "weeanon", "link": "https://stackoverflow.com/users/2242116/weeanon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2632, "favorite_count": 0, "accepted_answer_id": 33402766, "answer_count": 3, "score": 1, "last_activity_date": 1446071735, "creation_date": 1446062446, "question_id": 33400530, "link": "https://stackoverflow.com/questions/33400530/golang-idiomatic-way-to-stop-a-for", "title": "golang idiomatic way to stop a for", "body": "<p>I'm new to Go so I apologize in advance if the answer to my question is obvious :)</p>\n\n<p>I'm planning a producer that reads a file and send each line to a channel, like:</p>\n\n<pre><code>scanner := bufio.NewScanner(file)\nfor scanner.Scan() {\n    processingChan &lt;- scanner.Text()\n}\n</code></pre>\n\n<p>and add some goroutines to consume the lines.</p>\n\n<p>now, what I want is that if ANY line fails to process in a goroutine (let's say the line contains an invalid value for my business rules), I want to stop the producer loop, close the file (already defered) and finish the program.</p>\n\n<p>the question is: how can I \"notify\" the producer loop/for to stop?</p>\n\n<p>I found someone suggesting:</p>\n\n<pre><code>for scanner.Scan() {\n    select {\n    case &lt;- quit:\n        // break / return\n    default:\n        // send next line to channel\n    }\n}\n</code></pre>\n\n<p>and the consumer goroutines would write to a \"quit\" (or error) channel in case of any fault.</p>\n\n<p>this approach possibly solves the question, but I wonder if there is a cleaner/better or just common/popular approach. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1446062128, "post_id": 33400325, "comment_id": 54592148, "body": "your format string argument is called <code>fmt</code>, but you&#39;re using <code>format</code> in the <code>Sprintf</code> call."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1446062566, "post_id": 33400325, "comment_id": 54592396, "body": "This doesn&#39;t demonstrate what you&#39;re describing: <a href=\"http://play.golang.org/p/IKwT8oKX3k\" rel=\"nofollow noreferrer\">play.golang.org/p/IKwT8oKX3k</a>"}], "answers": [{"comments": [{"owner": {"reputation": 363, "user_id": 1201327, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6653f9cc2fccbd7dbe03e16e95eaad7?s=128&d=identicon&r=PG", "display_name": "dialAlpha", "link": "https://stackoverflow.com/users/1201327/dialalpha"}, "edited": false, "score": 0, "creation_date": 1446065263, "post_id": 33400582, "comment_id": 54593845, "body": "The error was indeed between chair and keyboard. I mixed up the following interfaces:      <code>func Print(v ...interface{})&#39; and      &#39;func Printf(format string, v ...interface{})</code>  Some of my code was calling the library without a format string. See here for a more detailed example: <a href=\"http://play.golang.org/p/Xx79qujaFp\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1473398317, "post_id": 33400582, "comment_id": 66133992, "body": "@BoppreH That <i>fmt</i> doc reference was invaluable."}], "tags": [], "owner": {"reputation": 5620, "user_id": 252218, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c6b551b65980ad7d5f2577687d5eafe9?s=128&d=identicon&r=PG", "display_name": "BoppreH", "link": "https://stackoverflow.com/users/252218/boppreh"}, "is_accepted": true, "score": 17, "last_activity_date": 1446062620, "creation_date": 1446062620, "answer_id": 33400582, "question_id": 33400325, "link": "https://stackoverflow.com/questions/33400325/golang-fmt-variadic-args-and-extra-type-value-error/33400582#33400582", "title": "Golang: fmt, variadic args and %!(EXTRA type=value) error", "body": "<p>I can't reproduce this behavior. Are you sure it's not a simple error that you forgot to show here?</p>\n\n<p><a href=\"https://play.golang.org/p/-jtmll17Xj\" rel=\"noreferrer\">https://play.golang.org/p/-jtmll17Xj</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc Info(format string, args ...interface{}){\n    msg := fmt.Sprintf(format, args...)\n    fmt.Print(msg)\n}\n\nfunc main() {\n    Info(\"Hello %s\", \"World\")\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>Hello World\n</code></pre>\n\n<p>According to <a href=\"https://golang.org/pkg/fmt/\" rel=\"noreferrer\">the <code>fmt</code> docs</a>, <code>%!(EXTRA string=WORLD)</code> is added to the string when you pass extra parameters, unexpected by the format. Maybe you are using the format string <code>\"Hello World\"</code> instead of <code>\"Hello %s\"</code>, or passing the argument twice?</p>\n"}, {"tags": [], "owner": {"reputation": 363, "user_id": 1201327, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6653f9cc2fccbd7dbe03e16e95eaad7?s=128&d=identicon&r=PG", "display_name": "dialAlpha", "link": "https://stackoverflow.com/users/1201327/dialalpha"}, "is_accepted": false, "score": 7, "last_activity_date": 1446065121, "creation_date": 1446065121, "answer_id": 33401293, "question_id": 33400325, "link": "https://stackoverflow.com/questions/33400325/golang-fmt-variadic-args-and-extra-type-value-error/33401293#33401293", "title": "Golang: fmt, variadic args and %!(EXTRA type=value) error", "body": "<p>The error was between the chair and keyboard. I mixed up the following interfaces:</p>\n\n<pre><code>func Print(v ...interface{})\nfunc Printf(format string, v ...interface{})\n</code></pre>\n\n<p>Some of my code was calling the library without a format string.See here for a more detailed example: <a href=\"http://play.golang.org/p/Xx79qujaFp\" rel=\"noreferrer\">http://play.golang.org/p/Xx79qujaFp</a></p>\n"}, {"tags": [], "owner": {"reputation": 392, "user_id": 5767484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/063da3e00ffcf4d3a001a1329c4e51b8?s=128&d=identicon&r=PG&f=1", "display_name": "NotX", "link": "https://stackoverflow.com/users/5767484/notx"}, "is_accepted": false, "score": 0, "last_activity_date": 1590660231, "creation_date": 1590660231, "answer_id": 62062036, "question_id": 33400325, "link": "https://stackoverflow.com/questions/33400325/golang-fmt-variadic-args-and-extra-type-value-error/62062036#62062036", "title": "Golang: fmt, variadic args and %!(EXTRA type=value) error", "body": "<p>Happens aswell when your message has no verbs and the varargs are empty but coming from elsewhere:</p>\n\n<pre><code>func CustomPrintf(message string, a ...interface{}) {\n    fmt.Printf(message, a) // for no verbs in message you'll get this \"EXTRA\" suffix\n}\n</code></pre>\n\n<p>That's a special case of a general error. You've got to spread <code>a</code> first. So use <code>fmt.Printf(message, a...)</code> to make it to varags again.</p>\n"}], "owner": {"reputation": 363, "user_id": 1201327, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6653f9cc2fccbd7dbe03e16e95eaad7?s=128&d=identicon&r=PG", "display_name": "dialAlpha", "link": "https://stackoverflow.com/users/1201327/dialalpha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12876, "favorite_count": 3, "accepted_answer_id": 33400582, "answer_count": 3, "score": 11, "last_activity_date": 1590660231, "creation_date": 1446061765, "last_edit_date": 1446062402, "question_id": 33400325, "link": "https://stackoverflow.com/questions/33400325/golang-fmt-variadic-args-and-extra-type-value-error", "title": "Golang: fmt, variadic args and %!(EXTRA type=value) error", "body": "<p>I'm implementing a wrapper around the standard log package to make a logger with various log levels.</p>\n\n<p>I have the following interface:</p>\n\n<pre><code>type Logger interface {\n  Trace(fmt string, args ...interface{})\n  Debug(fmt string, args ...interface{})\n  Info(fmt string, args ...interface{})\n  Warn(fmt string, args ...interface{})\n  Error(fmt string, args ...interface{})\n  Fatal(fmt string, args ...interface{})\n  Panic(fmt string, args ...interface{})\n}\n</code></pre>\n\n<p>In the implementation I have something like this (not the exact code)</p>\n\n<pre><code>func Info(format string, args ...interface{}){\n  msg := fmt.Sprintf(format, args...)\n  log.Println(msg)\n}\n</code></pre>\n\n<p>Now, assume I call my library like this:</p>\n\n<pre><code>logger.Info(\"Hello %s\", \"World\")\n</code></pre>\n\n<p>I get the printout: \"Hello %!(EXTRA string=WORLD)\", instead of the expected \"Hello World\". There a similar output if I do</p>\n\n<pre><code>msg := fmt.Sprintf(format, args)\n</code></pre>\n\n<p>This returns \"Hello World%!EXTRA []interface{}=[]\".</p>\n"}, {"tags": ["json", "go", "coding-style"], "answers": [{"comments": [{"owner": {"reputation": 2900, "user_id": 581665, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3a7d3308cfeb7ab814b0580de19ccc5f?s=128&d=identicon&r=PG", "display_name": "mbb", "link": "https://stackoverflow.com/users/581665/mbb"}, "edited": false, "score": 0, "creation_date": 1446058529, "post_id": 33399186, "comment_id": 54590087, "body": "Excellent. That did it! I was doing so and ran into a problem when I introduced a space between <code>json:</code> and <code>&quot;value&quot;</code>. Thank you!"}], "tags": [], "owner": {"reputation": 817, "user_id": 4165295, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fziJ5.jpg?s=128&g=1", "display_name": "Kern", "link": "https://stackoverflow.com/users/4165295/kern"}, "is_accepted": true, "score": 3, "last_activity_date": 1446058016, "creation_date": 1446058016, "answer_id": 33399186, "question_id": 33399035, "link": "https://stackoverflow.com/questions/33399035/using-struct-with-api-call-in-go/33399186#33399186", "title": "Using struct with API call in Go", "body": "<p>To output a proper JSON object from a structure, you have to export the fields of this structure. To do it, just capitalize the first letter of the field.</p>\n\n<p>Then you can add some kind of annotations, to tell your program how to name your JSON fields :</p>\n\n<pre><code>type Contestant struct {\n    Label  string `json:\"label\"`\n    Value int8 `json:\"value\"`\n    PreviousRank int8 `json:\"previous_rank\"` \n}\n</code></pre>\n"}], "owner": {"reputation": 2900, "user_id": 581665, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3a7d3308cfeb7ab814b0580de19ccc5f?s=128&d=identicon&r=PG", "display_name": "mbb", "link": "https://stackoverflow.com/users/581665/mbb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 33399186, "answer_count": 1, "score": 1, "last_activity_date": 1446058016, "creation_date": 1446057490, "question_id": 33399035, "link": "https://stackoverflow.com/questions/33399035/using-struct-with-api-call-in-go", "title": "Using struct with API call in Go", "body": "<p>I'm new to Go and working hard to follow its style and I'm not sure how to proceed. </p>\n\n<p>I want to push a JSON object to a <a href=\"https://developer.geckoboard.com/#supported-sizes-9\" rel=\"nofollow\">Geckoboard leaderboard</a>, which I believe requires the following format based on the <a href=\"https://developer.geckoboard.com/#parameters-10\" rel=\"nofollow\">API doc</a> and the one for leaderboards specifically: </p>\n\n<pre><code>{\n  \"api_key\": \"222f66ab58130a8ece8ccd7be57f12e2\",\n  \"data\": {\n     \"item\": [\n        { \"label\": \"Bob\", \"value\": 4, \"previous_value\": 6 },\n        { \"label\": \"Alice\", \"value\": 3, \"previous_value\": 4 }\n      ]\n  }\n}\n</code></pre>\n\n<p>My instinct is to build a <code>struct</code> for the API call itself and another called <code>Contestants</code>, which will be nested under <code>item</code>. In order to use <code>json.Marshall(Contestant1)</code>, the naming convention of my variables would not meet <code>fmt</code>'s expectations: </p>\n\n<pre><code>// Contestant structure to nest into the API call\ntype Contestant struct {\n    label  string\n    value int8\n    previous_rank int8  \n}\n</code></pre>\n\n<p>This feels incorrect. How should I configure my <code>Contestant</code> objects and be able to marshall them into JSON without breaking convention? </p>\n"}, {"tags": ["email", "go", "sendgrid"], "comments": [{"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1446096578, "post_id": 33398963, "comment_id": 54604397, "body": "Maybe AddSubstitutions is slightly broken? The only test I can see for AddSubstitution in the repo is in smtpapi_test.go. It is <code>header.AddSubstitution(&quot;sub&quot;, &quot;val&quot;)</code> which is a single call, using a single string. So maybe the code doesn&#39;t work the way you need it to. Maybe the code is out-of-synch with the documentation?"}, {"owner": {"reputation": 1094, "user_id": 381385, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4c3a996a2b224de62d5c2aae1f2760b?s=128&d=identicon&r=PG", "display_name": "bvanvugt", "link": "https://stackoverflow.com/users/381385/bvanvugt"}, "edited": false, "score": 0, "creation_date": 1446585013, "post_id": 33398963, "comment_id": 54801779, "body": "You might want to try a dedicated templating service on top of SendGrid -- take a look at sendwithus or customer.io. They&#39;re generally easier to work with, and I believe they provide Go API Clients."}], "owner": {"reputation": 2908, "user_id": 1220243, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A8tm4.jpg?s=128&g=1", "display_name": "zero_cool", "link": "https://stackoverflow.com/users/1220243/zero-cool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1446057260, "creation_date": 1446057260, "question_id": 33398963, "link": "https://stackoverflow.com/questions/33398963/how-to-use-sendgrids-addsubstitutions-method-to-dynamically-populate-email-temp", "title": "How to use Sendgrid&#39;s AddSubstitutions method to dynamically populate email template", "body": "<p>Using Go, and Sendgrid's API to send emails using Sendgrid email templates. There is a feature Sendgrid added that allows you to dynamically populate strings in the email template. This works. However, I'm trying to use their AddSubstitutions method (Sendgrid's definition of 'AddSubstitutions' below) to pass an array of strings, to be dynamically populated in a Sendgrid email template. </p>\n\n<p>Link to the Sendgrid SMTPAPI Repo: \n<a href=\"https://github.com/sendgrid/smtpapi-go/blob/master/smtpapi.go\" rel=\"nofollow\">https://github.com/sendgrid/smtpapi-go/blob/master/smtpapi.go</a></p>\n\n<pre><code>// AddSubstitutions adds a multiple substitutions to a specific key\nfunc (h *SMTPAPIHeader) AddSubstitutions(key string, subs []string) {\n    for i := 0; i &lt; len(subs); i++ {\n        h.AddSubstitution(key, subs[i])\n    }\n}\n</code></pre>\n\n<p>When the API call is made - there are no errors, and an email is sent, however, only the first string in the array that's passed with the 'AddSubstitutions' method populates the email. I've printed the contents of the array to the console, and I can see multiple values exist in the array. In the template, I've tried adding additional '-keys-' to be populated, but when I do that, the first element in the array gets populated multiple times. How can I pass an array to Sendgrid's API, and have it populate the body of the email template with every string in the array? Code below:</p>\n\n<pre><code> nickNameArray := make([]string, 0)\n\n for i, _ := range names {\n        nickNameArray = append(nickNameArray, names[i])\n }\n\n m.AddSubstitutions(\"-nickNames-\", nickNameArray)\n</code></pre>\n\n<p>The message is sent to Sendgrid via another function - this is the relevant logic. </p>\n"}, {"tags": ["go", "error-handling"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 18, "last_activity_date": 1446058056, "creation_date": 1446058056, "answer_id": 33399201, "question_id": 33398110, "link": "https://stackoverflow.com/questions/33398110/in-golang-os-openfile-doesnt-return-os-errnotexist-if-file-does-not-exist/33399201#33399201", "title": "In golang os.OpenFile doesn&#39;t return os.ErrNotExist if file does not exist", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/os/\">Package os</a></p>\n  \n  <p><a href=\"https://golang.org/pkg/os/#IsExist\">func IsExist</a></p>\n\n<pre><code>func IsExist(err error) bool\n</code></pre>\n  \n  <p>IsExist returns a boolean indicating whether the error is known to\n  report that a file or directory already exists. It is satisfied by\n  ErrExist as well as some syscall errors.</p>\n  \n  <p><a href=\"https://golang.org/pkg/os/#IsNotExist\">func IsNotExist</a></p>\n\n<pre><code>func IsNotExist(err error) bool\n</code></pre>\n  \n  <p>IsNotExist returns a boolean indicating whether the error is known to\n  report that a file or directory does not exist. It is satisfied by\n  ErrNotExist as well as some syscall errors.</p>\n</blockquote>\n\n<p>Use the <code>os.IsNotExist</code> function. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    fname := \"No File\"\n    _, err := os.OpenFile(fname, os.O_WRONLY, 0600)\n    if err != nil {\n        if os.IsNotExist(err) {\n            fmt.Print(\"File Does Not Exist: \")\n        }\n        fmt.Println(err)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>File Does Not Exist: open No File: No such file or directory\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 5445207, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hhkB7xYYS1c/AAAAAAAAAAI/AAAAAAAAAQs/R_4UuV1sTGg/photo.jpg?sz=128", "display_name": "Adri&#224; Casaj&#250;s", "link": "https://stackoverflow.com/users/5445207/adri%c3%a0-casaj%c3%bas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6253, "favorite_count": 2, "answer_count": 1, "score": 9, "last_activity_date": 1446058056, "creation_date": 1446054529, "question_id": 33398110, "link": "https://stackoverflow.com/questions/33398110/in-golang-os-openfile-doesnt-return-os-errnotexist-if-file-does-not-exist", "title": "In golang os.OpenFile doesn&#39;t return os.ErrNotExist if file does not exist", "body": "<p>I'm trying to open a file and I'd like to know if it doesn't exist to react. But the error </p>\n\n<pre><code>os.OpenFile(fName, os.O_WRONLY, 0600) \n</code></pre>\n\n<p>returns when the file does not exist is different than os.ErrNotExists</p>\n\n<pre><code>os.ErrNotExists -&gt; \"file does not exist\"\nerr.(*os.PathError).Err -&gt; \"no such file or directory\"\n</code></pre>\n\n<p>os.Stat also return the same error if the file is not there. Is there a predefined error I can compare to instead of having to do it by hand?</p>\n"}, {"tags": ["go", "webserver"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1446052064, "post_id": 33397241, "comment_id": 54585854, "body": "yes, it can be used in production."}, {"owner": {"reputation": 18043, "user_id": 28045, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/e4TH3.jpg?s=128&g=1", "display_name": "johnny", "link": "https://stackoverflow.com/users/28045/johnny"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1446052284, "post_id": 33397241, "comment_id": 54585999, "body": "@JimB Do you have a reference?  No offense intended."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1446052433, "post_id": 33397241, "comment_id": 54586105, "body": "I would say the reference is that there&#39;s nothing that says &quot;don&#39;t use this in production&quot;. The http server is used heavily in production by lots of large companies, including Google."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 2, "creation_date": 1446052459, "post_id": 33397241, "comment_id": 54586119, "body": "In my professional experience it was the only thing used as a web server for Go development. And it worked great. If I were writing a simple API today and could choose any tools, I would use it."}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 1, "creation_date": 1446097185, "post_id": 33397241, "comment_id": 54604594, "body": "FWIW I believe there are several presentations by Pike or Gerrand where they state that the golang.org web site runs on the package net/http HTTP server. I also think I&#39;ve seen presentations by non-google, companies who claim they use it. Maybe search the web for gophercon or golang meetups?"}], "answers": [{"comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 1, "creation_date": 1446282942, "post_id": 33397444, "comment_id": 54686962, "body": "You will, of course, need to layer on handlers that will provide production features: security, logging, metrics etc as required in your own case."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 1, "last_activity_date": 1446052624, "creation_date": 1446052624, "answer_id": 33397444, "question_id": 33397241, "link": "https://stackoverflow.com/questions/33397241/is-the-go-language-built-in-http-server-a-production-server/33397444#33397444", "title": "Is the Go language built-in http server a production server?", "body": "<p>Yes. It is a 'production' server if you use it as such. There is no reason why you would not. It is was made with the intent of you using it for real production applications, not just for testing and playing around with the language.</p>\n"}], "owner": {"reputation": 18043, "user_id": 28045, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/e4TH3.jpg?s=128&g=1", "display_name": "johnny", "link": "https://stackoverflow.com/users/28045/johnny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 0, "accepted_answer_id": 33397444, "answer_count": 1, "score": 0, "last_activity_date": 1446052624, "creation_date": 1446051977, "question_id": 33397241, "link": "https://stackoverflow.com/questions/33397241/is-the-go-language-built-in-http-server-a-production-server", "title": "Is the Go language built-in http server a production server?", "body": "<p>I did not see that answer in the documentation, <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow\">https://golang.org/pkg/net/http/</a>.</p>\n\n<p>It seems pretty complete, but typically I find the built in web servers are never recommended, such as Python, PHP, etc., for anything but development.</p>\n"}, {"tags": ["web", "go", "websocket"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1446051035, "post_id": 33396842, "comment_id": 54585203, "body": "Have you considered storing the connections unique identifier in a secure HTTPOnly cookie? If that doesn&#39;t exist, issue a new one, if it does you know what their connection is. You can avoid maintaining his stuff server side by depending on the browser to maintain that state in a secure fashion."}, {"owner": {"user_type": "does_not_exist", "display_name": "user870339"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1446051307, "post_id": 33396842, "comment_id": 54585391, "body": "I see what you mean, you would check for whether that cookie exists. However, I would prefer to perform server side checking, it would be easy to remove that particular cookie and establish a new connection."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1446051873, "post_id": 33396842, "comment_id": 54585746, "body": "You do the check on the server. The cookie is HTTPOnly so the only way it&#39;s gonna get removed is if the user clears their cookies in which case their session will probably be hosed anyway so you&#39;ll have to give them a new connection. Think of an HTTPOnly cookie as a server side resource because that&#39;s really what it is. You control it, the browser carries it along for you, nothing can touch it, it&#39;s your storage."}, {"owner": {"user_type": "does_not_exist", "display_name": "user870339"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1446052680, "post_id": 33396842, "comment_id": 54586271, "body": "I think I can make that work. Thanks for the advice, appreciate it!"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1446062727, "post_id": 33396842, "comment_id": 54592489, "body": "This doesnt stop someone from using Chrome in incognito mode, or firefox + chrome.  Also, an in-memory map doesn&#39;t allow you to scale past 1 server... unless you have a means of doing src address based sticky balancing or something like that"}, {"owner": {"reputation": 31897, "user_id": 307976, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zSNAW.jpg?s=128&g=1", "display_name": "vtortola", "link": "https://stackoverflow.com/users/307976/vtortola"}, "edited": false, "score": 0, "creation_date": 1446065378, "post_id": 33396842, "comment_id": 54593897, "body": "Think that such behavior may not be what your users expect. People expect to open a new browser and have a fully functional page. You may be shooting yourself in the feet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user870339"}, "edited": false, "score": 0, "creation_date": 1446073073, "post_id": 33396842, "comment_id": 54597499, "body": "David Budworth makes some good points. I hadn&#39;t considered multiple browsers and the scaling issue. I ended doing it through a flag in the database, since it had to be accessed and written to anyway, it could freeload off of that, and the fact that its meant to be consistent."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1446059135, "last_edit_date": 1446059135, "creation_date": 1446057809, "answer_id": 33399121, "question_id": 33396842, "link": "https://stackoverflow.com/questions/33396842/enforcing-1-unique-websocket-connection-per-client/33399121#33399121", "title": "Enforcing 1 unique websocket connection per client?", "body": "<p>I wouldn't be concerned about the performance of the solution outlined in the question. If you want to close the previous connection, there's no way around maintaining server side maps. Assuming a single server and that you are using the Gorilla websocket package, the following code should do the trick:</p>\n\n<pre><code>var (\n   mu sync.Mutex\n   conns map[string]*websocket.Conn\n)\n\nfunc addConn(sessionID string, conn *websocket.Conn) {\n   mu.Lock()\n   prev := conns[sessionID]\n   conns[sessionID] = conn\n   mu.Unlock()\n   if prev != nil {\n      // Close will stop concurrent reads and writes.\n      prev.Close()\n   }\n}\n\nfunc removeConn(sessionID string, conn *websocket.Conn) {\n   mu.Lock()\n   // We don't simply delete(conns, session) to avoid race on cleanup.\n   if conns[sessionID] == conn {\n      delete(conns, sessionID)\n   }\n   mu.Unlock()\n}\n</code></pre>\n\n<p>The cost of updating this map is small compared to the cost of accepting an incoming network connection, completing websocket handshake and everything else that's happening in scenario. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user870339"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 634, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446059135, "creation_date": 1446050749, "question_id": 33396842, "link": "https://stackoverflow.com/questions/33396842/enforcing-1-unique-websocket-connection-per-client", "title": "Enforcing 1 unique websocket connection per client?", "body": "<p>I have a webpage that establishes a websocket connection with the server. I have to make sure that a user of the site can only establish a single connection, so opening a new tab and navigating to the same page will close the previous connection.</p>\n\n<p>I was thinking of maintaining a map with the session id as the key; however, as the map would have to be constantly adjusted in size as more and more clients connect I am afraid of it having performance problems, and since it's accessed concurrently you would probably have to do some kind of locking.</p>\n\n<p>Any ideas for performance efficient ways of ensuring a unique connection per client? Would love to hear suggestions, thank you.</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1446049654, "post_id": 33396376, "comment_id": 54584212, "body": "I&#39;m not familiar with mochajs, but isn&#39;t a test case without a test function just a comment a la a docstring or an <a href=\"https://blog.golang.org/examples\" rel=\"nofollow noreferrer\">Example</a>? Or is there some subtlety I don&#39;t understand"}, {"owner": {"reputation": 5072, "user_id": 537500, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/cd1f9e76e6bc4adaa787e84f15b63eb6?s=128&d=identicon&r=PG", "display_name": "Rana", "link": "https://stackoverflow.com/users/537500/rana"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1446051985, "post_id": 33396376, "comment_id": 54585803, "body": "yes, it is! See the selected answer, working perfectly in same way!"}], "answers": [{"comments": [{"owner": {"reputation": 5072, "user_id": 537500, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/cd1f9e76e6bc4adaa787e84f15b63eb6?s=128&d=identicon&r=PG", "display_name": "Rana", "link": "https://stackoverflow.com/users/537500/rana"}, "edited": false, "score": 0, "creation_date": 1446050854, "post_id": 33396487, "comment_id": 54585068, "body": "Totally worked like a charm! Thanks! Just to add, need to run &quot;go test -v -test.short&quot;"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 11, "last_activity_date": 1446051364, "last_edit_date": 1446051364, "creation_date": 1446049796, "answer_id": 33396487, "question_id": 33396376, "link": "https://stackoverflow.com/questions/33396376/how-to-write-pending-tests-in-go/33396487#33396487", "title": "How To Write Pending Tests In Go", "body": "<p><a href=\"https://golang.org/pkg/testing/\">The package docs</a> describe such example with <code>testing.(*T).Skip</code>:</p>\n\n<blockquote>\n  <p>Tests and benchmarks may be skipped if not applicable with a call to the Skip method of *T and *B:</p>\n\n<pre><code>func TestTimeConsuming(t *testing.T) {\n    if testing.Short() {\n        t.Skip(\"skipping test in short mode.\")\n    }\n    ...\n}\n</code></pre>\n</blockquote>\n\n<p>The message you provided for <code>Skip</code> will be printed if you launch <code>go test</code> with a <code>-v</code> flag (in this example you'll also need to provide <code>-short</code> flag to see the skip message).</p>\n"}], "owner": {"reputation": 5072, "user_id": 537500, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/cd1f9e76e6bc4adaa787e84f15b63eb6?s=128&d=identicon&r=PG", "display_name": "Rana", "link": "https://stackoverflow.com/users/537500/rana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 0, "accepted_answer_id": 33396487, "answer_count": 1, "score": 5, "last_activity_date": 1446051364, "creation_date": 1446049480, "question_id": 33396376, "link": "https://stackoverflow.com/questions/33396376/how-to-write-pending-tests-in-go", "title": "How To Write Pending Tests In Go", "body": "<p>Is there legitimate way to write down a test case for which I intent to write full test function later on? As like pending tests of mochajs?</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1446049433, "post_id": 33396333, "comment_id": 54584034, "body": "The name of the test isn&#39;t directly related to what it&#39;s testing. Call them what you want."}, {"owner": {"reputation": 5072, "user_id": 537500, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/cd1f9e76e6bc4adaa787e84f15b63eb6?s=128&d=identicon&r=PG", "display_name": "Rana", "link": "https://stackoverflow.com/users/537500/rana"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1446049597, "post_id": 33396333, "comment_id": 54584171, "body": "Yeah, I know. I was actually looking for a standard way. Such as &#39;TestInternalmxxx&#39; or similar, which practice other golang devs might already be ."}], "answers": [{"comments": [{"owner": {"reputation": 5072, "user_id": 537500, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/cd1f9e76e6bc4adaa787e84f15b63eb6?s=128&d=identicon&r=PG", "display_name": "Rana", "link": "https://stackoverflow.com/users/537500/rana"}, "edited": false, "score": 0, "creation_date": 1446049661, "post_id": 33396403, "comment_id": 54584215, "body": "nice idea, didn&#39;t try this way."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 3, "last_activity_date": 1446049542, "creation_date": 1446049542, "answer_id": 33396403, "question_id": 33396333, "link": "https://stackoverflow.com/questions/33396333/testing-internals-in-go/33396403#33396403", "title": "Testing Internals In Go", "body": "<p>You can use underscores. E.g.</p>\n\n<pre><code>func Test_mxxxx(t *testing.T) {\n    // ...\n}\n</code></pre>\n\n<p>This should run just fine.</p>\n"}], "owner": {"reputation": 5072, "user_id": 537500, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/cd1f9e76e6bc4adaa787e84f15b63eb6?s=128&d=identicon&r=PG", "display_name": "Rana", "link": "https://stackoverflow.com/users/537500/rana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1446049542, "creation_date": 1446049361, "question_id": 33396333, "link": "https://stackoverflow.com/questions/33396333/testing-internals-in-go", "title": "Testing Internals In Go", "body": "<p>The recommended golang test method signature format is:</p>\n\n<pre><code>func TestMxxxx(t *testing.T) {\n\n}\n</code></pre>\n\n<p>I have noticed if I use 'Testmxxxx', it simply skips the tests. Now, if I have two function in a package, one name myFunc (as private, not exported), and another Myfunc(exported). What will be the approach to write separate test method for each of them?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 817, "user_id": 4165295, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fziJ5.jpg?s=128&g=1", "display_name": "Kern", "link": "https://stackoverflow.com/users/4165295/kern"}, "edited": false, "score": 0, "creation_date": 1446048183, "post_id": 33395706, "comment_id": 54583105, "body": "I&#39;m an idiot.. I knew this, I just didn&#39;t look. I focused on my main problem with the <code>messages</code> key. Thank you :D"}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "reply_to_user": {"reputation": 817, "user_id": 4165295, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fziJ5.jpg?s=128&g=1", "display_name": "Kern", "link": "https://stackoverflow.com/users/4165295/kern"}, "edited": false, "score": 0, "creation_date": 1446049200, "post_id": 33395706, "comment_id": 54583863, "body": "@Kern since you have modified the question after the answer, it has become irrelevant. Do you still have a problem, or did that answer actually solve it ? In the latter case, you might want to undo your latest edit because the question does not exhibit any problem that can be reproduced."}, {"owner": {"reputation": 817, "user_id": 4165295, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fziJ5.jpg?s=128&g=1", "display_name": "Kern", "link": "https://stackoverflow.com/users/4165295/kern"}, "reply_to_user": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1446049732, "post_id": 33395706, "comment_id": 54584273, "body": "@SirDarius I just did a rollback, hoping that it makes the question more clear ! In fact, I had a main problem with the <code>messages</code> key of my JSON, I just talked about the <code>users</code> key thinking it would help to understand the problem.  The messages contained in my <code>Chatroom</code> struct are just ignored when I marshal them, I don&#39;t understand why and this is my main problem !  Ty for your comment :) !"}], "tags": [], "owner": {"reputation": 1509, "user_id": 4897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4mbYz.jpg?s=128&g=1", "display_name": "Mike Reedell", "link": "https://stackoverflow.com/users/4897/mike-reedell"}, "is_accepted": false, "score": 1, "last_activity_date": 1446047594, "creation_date": 1446047594, "answer_id": 33395706, "question_id": 33395447, "link": "https://stackoverflow.com/questions/33395447/go-encode-nested-structure/33395706#33395706", "title": "Go - Encode nested structure", "body": "<p>The go JSON marshaler will only output exported (capitalized) fields.  The field in the <code>User</code> struct are un-exported (lower-case), which means the JSON marshaler doesn't know they are there and can't output them.</p>\n"}, {"tags": [], "owner": {"reputation": 817, "user_id": 4165295, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fziJ5.jpg?s=128&g=1", "display_name": "Kern", "link": "https://stackoverflow.com/users/4165295/kern"}, "is_accepted": true, "score": 0, "last_activity_date": 1446125966, "creation_date": 1446125966, "answer_id": 33415842, "question_id": 33395447, "link": "https://stackoverflow.com/questions/33395447/go-encode-nested-structure/33415842#33415842", "title": "Go - Encode nested structure", "body": "<p>The problem was totally elsewhere : The Chatroom instance I used when adding some messages wasn't bound correctly to <code>s.Chatrooms[\"main\"]</code>, due to my misunderstanding of pointers.</p>\n\n<p>When I marshaled <code>s.Chatrooms[\"main\"]</code>, the messages weren't inside !</p>\n\n<p>Ty for your help !</p>\n\n<p>I hope this will help some others go-learners :D</p>\n"}], "owner": {"reputation": 817, "user_id": 4165295, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fziJ5.jpg?s=128&g=1", "display_name": "Kern", "link": "https://stackoverflow.com/users/4165295/kern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 33415842, "answer_count": 2, "score": 0, "last_activity_date": 1446125966, "creation_date": 1446046933, "last_edit_date": 1446049576, "question_id": 33395447, "link": "https://stackoverflow.com/questions/33395447/go-encode-nested-structure", "title": "Go - Encode nested structure", "body": "<p>I'm working on an extension of <a href=\"http://gary.burd.info/go-websocket-chat\" rel=\"nofollow\">http://gary.burd.info/go-websocket-chat</a>.</p>\n\n<p>This example sends raw text through websockets.</p>\n\n<p>I want to use JSON data instead.</p>\n\n<p>I did some structures in my Go code, but when I convert it to JSON to write it to the client, the nested structures are not in the result.</p>\n\n<p>Some code :</p>\n\n<pre><code>type(\n    ChatroomData struct {\n        Token string `json:\"token\"`\n        Chatroom *Chatroom `json:\"chatroom\"`\n    }\n    Message struct {\n        Token string `json:\"token,omitempty\"`\n        Type string `json:\"type\"`\n        Author string `json:\"author\"`\n        Content string `json:\"content\"`\n        Chatroom string `json:\"chatroom\"`\n    }\n    Messages []Message\n)\n</code></pre>\n\n<p>The chatroom struct :</p>\n\n<pre><code>Chatroom struct {\n    Name string `json:\"name\"`\n    Users []User `json:\"users\"`\n    Messages Messages `json:\"messages\"`\n    Hub *WsHub `json:\"-\"`\n}\nChatrooms map[string]*Chatroom\nUser struct {\n    username string `json:\"username\"`\n    token string `json:\"-\"`\n}\nUsers []User\n</code></pre>\n\n<p>Start the chatroom :</p>\n\n<pre><code>func (s *Server) startMainChatroom() {\n    s.Chatrooms[\"main\"] = &amp;Chatroom{\n        Name: \"main\",\n        Users: make([]User, 0),\n        Messages: make([]Message, 0),\n        Hub: NewHub(),\n    }\n    go s.Chatrooms[\"main\"].Hub.Run()\n}\n</code></pre>\n\n<p>The way to append messages to the chatroom :</p>\n\n<pre><code>message := Message{}\njson.Unmarshal([]byte(data), &amp;message)\nmessage.Token = \"\"\nmessage.Type = \"message\"\nchatroom.Messages = append(chatroom.Messages, message)\n</code></pre>\n\n<p>Send data to the client :</p>\n\n<pre><code>func (u *User) SendChatroomData(w http.ResponseWriter, c *Chatroom, status int) {\n    chatroomData := ChatroomData{Token: u.token, Chatroom: c}\n\n    w.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n    w.Header().Set(\"Access-Control-Allow-Headers\", \"accept, authorization\")\n    w.Header().Set(\"Access-Control-Allow-Methods\", \"GET, POST\")\n    w.WriteHeader(status)\n    if err := json.NewEncoder(w).Encode(&amp;chatroomData); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>The printed result is :</p>\n\n<pre><code>{\n     \"token\":\"a638ed3ba0c30ba3d0810fc79e12a50a\",\n     \"chatroom\":{\n         \"name\":\"main\",\n         \"users\":[{},{}],\n         \"messages\":[]\n     }\n}\n</code></pre>\n\n<p>There are two users and three messages were sent. If I use <code>fmt.Printf(\"%v\\n\", chatroom.Messages)</code>, I have the three messages correctly stored. Same for the users, data is here when I dump it.</p>\n\n<p>Many things are strange :</p>\n\n<ul>\n<li>Why the <code>messages</code> key stays empty ?</li>\n<li><em>Why the <code>users</code> key doesn't, but the slice items are empty ?</em> (<strong>solved by Mike Reedell</strong>)</li>\n</ul>\n\n<p>Thank you for your help, don't hesitate to ask me more code if it needs to be. I hope my post isn't already too long (and not too full of english errors X)) !</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 2, "creation_date": 1446027910, "post_id": 33388268, "comment_id": 54568953, "body": "Write a package, expose your configured logger. Import that package in your controllers."}, {"owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1446028849, "post_id": 33388268, "comment_id": 54569556, "body": "@thwd So I have made a package called log. Invoked the logging code inside a function called &quot;init()&quot; then imported in my controller `\t_ &quot;github.com/MediaMath/apps_api/log&quot;` but I get the error of <code>undefined: log in log.Error</code> when I try and invoke, any ideas? - Updated Question"}, {"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 1, "creation_date": 1446029322, "post_id": 33388268, "comment_id": 54569859, "body": "In your second example, <code>var log</code> is inside <code>main()</code>&#39;s scope. It should be a global variable (with uppercase first letter) for it to be access of outside of <code>main</code> and the package itself."}, {"owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "reply_to_user": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1446029523, "post_id": 33388268, "comment_id": 54569994, "body": "@Nadh Updated again, similar error"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 1, "creation_date": 1446029693, "post_id": 33388268, "comment_id": 54570100, "body": "Importing with <code>_</code> omits the package&#39;s identifiers. I think you want <code>import . &quot;github.com&#47;blablabla&#47;log&quot;</code>"}, {"owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1446029825, "post_id": 33388268, "comment_id": 54570178, "body": "@thwd Thanks for the help, missed the extra log off! Working!"}], "owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1883, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1446029509, "creation_date": 1446027241, "last_edit_date": 1446029509, "question_id": 33388268, "link": "https://stackoverflow.com/questions/33388268/golang-package-go-logging", "title": "Golang package - go-logging", "body": "<p>I am trying to use the golang package: <a href=\"https://github.com/op/go-logging\" rel=\"nofollow\">https://github.com/op/go-logging</a></p>\n\n<p>I have set it up following the instructions and it works.</p>\n\n<pre><code>var log = logging.MustGetLogger(\"example\")\n\nvar format = logging.MustStringFormatter(\n    \"%{color}%{time:15:04:05.000} %{shortfunc} \u25b6 %{level:.4s} %{id:03x}%{color:reset} %{message}\",\n)\n\nfunc main() {\n\n    backend2 := logging.NewLogBackend(os.Stderr, \"\", 0)\n    backend2Formatter := logging.NewBackendFormatter(backend2, format)\n    logging.SetBackend(backend2Formatter)\n\n    log.Info(\"info\")\n    log.Notice(\"notice\")\n    log.Warning(\"warning\")\n    log.Error(\"err\")\n    log.Critical(\"crit\")\n\n    r.POST(\"/v1.0/route-one/\", controllers.RouteOne)\n    r.GET(\"/v1.0/route-two\", controllers.RouteTwo)\n\n    r.Run(\":8080\")\n\n}\n</code></pre>\n\n<p>However I want to create logs from any of the controllers from within my App, how would I create logs from within a controller after the initial declaration in main.go without having to re-write the format etc? Ideally id like to be able to just write <code>log.Error(\"err\")</code> anywhere to create a log.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Created a package:</p>\n\n<pre><code>package log\n\nimport (\n    \"github.com/op/go-logging\"\n    \"os\"\n)\n\nvar Log = logging.MustGetLogger(\"example\")\n\nvar format = logging.MustStringFormatter(\n    \"%{color}%{time:15:04:05.000} %{shortfunc} \u25b6 %{level:.4s} %{id:03x}%{color:reset} %{message}\",\n)\n\nfunc init() {\n\n    backend2 := logging.NewLogBackend(os.Stderr, \"\", 0)\n    backend2Formatter := logging.NewBackendFormatter(backend2, format)\n    logging.SetBackend(backend2Formatter)\n\n    Log.Info(\"info\")\n    Log.Notice(\"notice\")\n    Log.Warning(\"warning\")\n    Log.Error(\"err\")\n    Log.Critical(\"crit\")\n}\n</code></pre>\n\n<p>Then tried to add it into my controller by importing and running <code>Log.Error(\"test\")</code> but I get the error of <code>undefined: Log in Log.Error</code></p>\n"}, {"tags": ["go", "garbage-collection", "slice"], "comments": [{"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1446098754, "post_id": 33385664, "comment_id": 54605158, "body": "How can <code>func (self *DataSlots) addData(data interface{})</code> be called? Their appears to be a potential &#39;race&#39; between addData and manageSlots. Assuming New is always called to create instances of DataSlots, then there will be always be a manageSlots for every DataSlots. It looks like it can race with addData; <code>self.slots[0] = nil</code> vs <code>self.slots[0] = append(self.slots[0], data)</code>. Even then, the lost memory should be garbage collected."}, {"owner": {"reputation": 51, "user_id": 1662780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85a1f6cf9bbc0ed1eadbb94a8ee395?s=128&d=identicon&r=PG", "display_name": "user1662780", "link": "https://stackoverflow.com/users/1662780/user1662780"}, "reply_to_user": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1446109623, "post_id": 33385664, "comment_id": 54610275, "body": "Thanks. In my actual code, I do have this critical region mutex protected. Removed it here to make the code concise."}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1446133619, "post_id": 33385664, "comment_id": 54627094, "body": "Okay. Might be worth adding a short comment to your question to say something about that; it is hard to read the code without noticing."}, {"owner": {"reputation": 51, "user_id": 1662780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85a1f6cf9bbc0ed1eadbb94a8ee395?s=128&d=identicon&r=PG", "display_name": "user1662780", "link": "https://stackoverflow.com/users/1662780/user1662780"}, "reply_to_user": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1446139099, "post_id": 33385664, "comment_id": 54630851, "body": "@gbulmer, edited the post."}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1446139269, "post_id": 33385664, "comment_id": 54630964, "body": "Cool. IMHO protecting from the race condition isn&#39;t key to your question, so that should help without distracting anyone. Concise and complete !-)"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 1662780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85a1f6cf9bbc0ed1eadbb94a8ee395?s=128&d=identicon&r=PG", "display_name": "user1662780", "link": "https://stackoverflow.com/users/1662780/user1662780"}, "edited": false, "score": 0, "creation_date": 1446048179, "post_id": 33392571, "comment_id": 54583102, "body": "Thanks. Answers my queries."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 5, "last_activity_date": 1524678761, "last_edit_date": 1524678761, "creation_date": 1446039494, "answer_id": 33392571, "question_id": 33385664, "link": "https://stackoverflow.com/questions/33385664/do-clearing-slices-in-golang-guarantees-garbage-collection/33392571#33392571", "title": "Do Clearing slices in golang guarantees garbage collection?", "body": "<p>Once your slice is set too <code>nil</code>, any values contained in the slice are available for garbage collection, provided that the underlying array isn't shared with another slice.</p>\n\n<p>Since there are no slice operations in your program, you never have multiple references to the same array, nor are you leaving data in any inaccessible portions of the underlying array. </p>\n\n<p>What you need to be careful of, is when you're using slice operations:</p>\n\n<pre><code>a := []int{1, 2, 3, 4}\nb := a[1:3]\na = nil\n// the values 1 and 4 can't be collected, because they are\n// still contained in b's underlying array\n\nc := []int{1, 2, 3, 4}\nc = append(c[1:2], 5)\n// c is now []int{2, 5}, but again the values 1 and 4 are\n// still in the underlying array. The 4 may be overwritten\n// by a later append, but the 1 is inaccessible and won't\n// be collected until the underlying array is copied.\n</code></pre>\n\n<p>While <code>append</code> does copy values when the capacity of the slice in insufficient, only the values contained in the slice are copied. There is no deep copy of any of the values.</p>\n"}], "owner": {"reputation": 51, "user_id": 1662780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85a1f6cf9bbc0ed1eadbb94a8ee395?s=128&d=identicon&r=PG", "display_name": "user1662780", "link": "https://stackoverflow.com/users/1662780/user1662780"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1964, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1524678761, "creation_date": 1446019014, "last_edit_date": 1446523577, "question_id": 33385664, "link": "https://stackoverflow.com/questions/33385664/do-clearing-slices-in-golang-guarantees-garbage-collection", "title": "Do Clearing slices in golang guarantees garbage collection?", "body": "<p>I wanted to implement time based slots for holding data using golang slices. I managed to come up with a go program like this and it also works. But I have few questions regarding garbage collection and the general performance of this program. Does this program guarantee garbage collection of items once slice is equated to nil? And while shuffling slices, I hope this program does not do any deep copying. </p>\n\n<pre><code>type DataSlots struct {\n    slotDuration  int //in milliseconds\n    slots         [][]interface{}\n    totalDuration int //in milliseconds\n}\n\nfunc New(slotDur int, totalDur int) *DataSlots {\n    dat := &amp;DataSlots{slotDuration: slotDur,\n        totalDuration: totalDur}\n    n := totalDur / slotDur\n    dat.slots = make([][]interface{}, n)\n    for i := 0; i &lt; n; i++ {\n        dat.slots[i] = make([]interface{}, 0)\n    }\n    go dat.manageSlots()\n    return dat\n}\n\nfunc (self *DataSlots) addData(data interface{}) {\n    self.slots[0] = append(self.slots[0], data)\n}\n\n// This should be a go routine\nfunc (self *DataSlots) manageSlots() {\n    n := self.totalDuration / self.slotDuration\n    for {\n        time.Sleep(time.Duration(self.slotDuration) * time.Millisecond)\n        for i := n - 1; i &gt; 0; i-- {\n            self.slots[i] = self.slots[i-1]\n        }\n        self.slots[0] = nil\n    }\n}\n</code></pre>\n\n<p>I removed critical section handling in this snippet to make it concise.</p>\n"}, {"tags": ["postgresql", "go", "sqlx"], "answers": [{"tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": false, "score": 5, "last_activity_date": 1446010158, "last_edit_date": 1446010158, "creation_date": 1446009317, "answer_id": 33383384, "question_id": 33382981, "link": "https://stackoverflow.com/questions/33382981/go-how-to-get-last-insert-id-on-postgresql-with-namedexec/33383384#33383384", "title": "Go: How to get last insert id on Postgresql with NamedExec()", "body": "<p><code>resp.LastInsertID()</code> only (typically) works with mySQL, and only works for integer IDs: <a href=\"https://golang.org/pkg/database/sql/#Result\" rel=\"noreferrer\">https://golang.org/pkg/database/sql/#Result</a></p>\n\n<p>Note that since you're using <code>sqlx</code> (by the use of <code>NamedExec</code>) you'll want to instead use <code>tx.Get</code> to exec the query and capture the return value:</p>\n\n<pre><code>// id should match the type of your ID \n// e.g. int64 for a bigserial column, or string for a uuid\nvar id string\nresp, err := tx.Get(&amp;id, query, v1, v2, v3)\n</code></pre>\n\n<p>See this relevant discussion on the sqlx GitHub repo: <a href=\"https://github.com/jmoiron/sqlx/issues/154#issuecomment-148216948\" rel=\"noreferrer\">https://github.com/jmoiron/sqlx/issues/154#issuecomment-148216948</a></p>\n"}, {"tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": true, "score": 39, "last_activity_date": 1465718582, "creation_date": 1465718582, "answer_id": 37771986, "question_id": 33382981, "link": "https://stackoverflow.com/questions/33382981/go-how-to-get-last-insert-id-on-postgresql-with-namedexec/37771986#37771986", "title": "Go: How to get last insert id on Postgresql with NamedExec()", "body": "<p>The reason for this is because PostgreSQL does not return you the last inserted id. This is because last inserted id is available only if you create a new row in a table that uses a sequence.</p>\n\n<p>If you actually insert a row in the table where a sequence is assigned, you have to use <a href=\"https://www.postgresql.org/docs/9.1/static/sql-insert.html\" rel=\"noreferrer\"><code>RETURNING</code> clause</a>. Something like this: <code>INSERT INTO table (name) VALUES(\"val\") RETURNING id\"</code>. </p>\n\n<p>I am not sure about your driver, but in <a href=\"https://github.com/lib/pq\" rel=\"noreferrer\">pq</a> you will do this in the following way: </p>\n\n<pre><code>lastInsertId := 0\nerr = db.QueryRow(\"INSERT INTO brands (name) VALUES($1) RETURNING id\", name).Scan(&amp;lastInsertId)\n</code></pre>\n"}], "owner": {"reputation": 1057, "user_id": 1750407, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EobHJ.jpg?s=128&g=1", "display_name": "Wendy Adi", "link": "https://stackoverflow.com/users/1750407/wendy-adi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14686, "favorite_count": 2, "accepted_answer_id": 37771986, "answer_count": 2, "score": 26, "last_activity_date": 1517933617, "creation_date": 1446006942, "last_edit_date": 1517933617, "question_id": 33382981, "link": "https://stackoverflow.com/questions/33382981/go-how-to-get-last-insert-id-on-postgresql-with-namedexec", "title": "Go: How to get last insert id on Postgresql with NamedExec()", "body": "<p>I use <a href=\"https://github.com/jmoiron/sqlx\" rel=\"noreferrer\" title=\"jmoiron/sqlx\">jmoiron/sqlx</a> library for communicating with my PostgreSql server in my Go apps. Somewhere on my apps i have this following code: </p>\n\n<pre><code>sqlQuery := `\n    INSERT INTO table_to_insert  (\n        code,\n        status,\n        create_time,\n        create_by\n    ) VALUES (\n        '',\n        0,\n        CURRENT_TIMESTAMP,\n        0\n    ) RETURNING id\n`\n\ndatas, err := tx.NamedExec(sqlQuery, structToInsert)\n</code></pre>\n\n<p>Question: how can i get the last insert id using the return from <code>tx.NamedExec()</code>? I've tried <code>datas.LastInsertId()</code> but its always return 0.</p>\n\n<p>Note: im sure the insert to postgres is success.</p>\n"}, {"tags": ["xml", "go"], "answers": [{"tags": [], "owner": {"reputation": 15505, "user_id": 857238, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e7efe5b6a2b92bb52c23a639b88b544c?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/857238/chris"}, "is_accepted": true, "score": 3, "last_activity_date": 1446007556, "creation_date": 1446007556, "answer_id": 33383087, "question_id": 33382610, "link": "https://stackoverflow.com/questions/33382610/how-to-golang-unmarshal-a-xml-message-into-a-struct/33383087#33383087", "title": "how to golang Unmarshal a xml message into a struct", "body": "<p>The definition of your struct implies the following XML format which doesn't match what you're providing:</p>\n\n<pre><code>&lt;BucketLocation&gt;\n    &lt;LocationConstraint&gt;oss-cn-hangzhou&lt;/LocationConstraint&gt;\n&lt;/BucketLocation&gt;\n</code></pre>\n\n<p>To read the example XML that you've given you would do something this:</p>\n\n<pre><code>var v string\nxml.Unmarshal(xml_content, &amp;v)\n</code></pre>\n"}], "owner": {"reputation": 685, "user_id": 2151287, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aea53781b823a637e50add15cb9aa111?s=128&d=identicon&r=PG", "display_name": "sundq", "link": "https://stackoverflow.com/users/2151287/sundq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 33383087, "answer_count": 1, "score": 2, "last_activity_date": 1446007556, "creation_date": 1446004348, "question_id": 33382610, "link": "https://stackoverflow.com/questions/33382610/how-to-golang-unmarshal-a-xml-message-into-a-struct", "title": "how to golang Unmarshal a xml message into a struct", "body": "<p>how to decode this xml </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;LocationConstraint&gt;oss-cn-hangzhou&lt;/LocationConstraint&gt;\n</code></pre>\n\n<p>my code is like this:</p>\n\n<pre><code>type BucketLocation struct {\n    LocationConstraint string `xml:\"LocationConstraint\"`\n}\nv := &amp;BucketLocation{}\nxml.Unmarshal(xml_content, v)\n</code></pre>\n\n<p>but it does not work.</p>\n"}, {"tags": ["heroku", "deployment", "go", "bower"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1446023608, "post_id": 33381155, "comment_id": 54566187, "body": "The Go build pack for Heroku won&#39;t read or run a package.json or bower.json - you should run them before you do a <code>git push</code> to Heroku, and/or as part of a commit hook that rebuilds the assets - either should put them into a static/ or dist/ directory that your Go application then serves."}], "answers": [{"comments": [{"owner": {"reputation": 2903, "user_id": 4257217, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/i1EYW.png?s=128&g=1", "display_name": "GreenRaccoon23", "link": "https://stackoverflow.com/users/4257217/greenraccoon23"}, "edited": false, "score": 0, "creation_date": 1452891074, "post_id": 33387855, "comment_id": 57381591, "body": "After adding this nodejs buildpack, I also had to add bower to package.json as a dependency. Then instead of pointing the <code>Procfile</code> to the Go binary, I pointed it to a Bash script which would call <code>bower install</code> if the directory set in <code>.bowerrc</code> did not exist (e.g., &quot;bower_components&quot;). Afterwards, the Bash script called the Go binary. So it looked like <code>[ -d &quot;bower_components&quot; ] || bower install; server&#47;bin&#47;serve;</code>"}, {"owner": {"reputation": 29107, "user_id": 122080, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6fa1cdda524d49996a8bc6917328de3d?s=128&d=identicon&r=PG", "display_name": "Damien MATHIEU", "link": "https://stackoverflow.com/users/122080/damien-mathieu"}, "reply_to_user": {"reputation": 2903, "user_id": 4257217, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/i1EYW.png?s=128&g=1", "display_name": "GreenRaccoon23", "link": "https://stackoverflow.com/users/4257217/greenraccoon23"}, "edited": false, "score": 1, "creation_date": 1452952362, "post_id": 33387855, "comment_id": 57397168, "body": "Adding <code>bower install</code> as a post install script (<a href=\"https://devcenter.heroku.com/articles/node-best-practices#hook-things-up\" rel=\"nofollow noreferrer\">devcenter.heroku.com/articles/&hellip;</a>) would be better, as it would compile your scripts at deploy time, not boot time. That would speed up boot time, which has a 60 seconds timeout (<a href=\"https://devcenter.heroku.com/articles/limits#boot-timeout\" rel=\"nofollow noreferrer\">devcenter.heroku.com/articles/limits#boot-timeout</a>)."}], "tags": [], "owner": {"reputation": 29107, "user_id": 122080, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6fa1cdda524d49996a8bc6917328de3d?s=128&d=identicon&r=PG", "display_name": "Damien MATHIEU", "link": "https://stackoverflow.com/users/122080/damien-mathieu"}, "is_accepted": true, "score": 2, "last_activity_date": 1446026113, "creation_date": 1446026113, "answer_id": 33387855, "question_id": 33381155, "link": "https://stackoverflow.com/questions/33381155/deploying-golang-app-with-bower-on-heroku/33387855#33387855", "title": "Deploying Golang app with Bower on Heroku", "body": "<p>You can use several buildpacks in your app:</p>\n\n<pre><code>heroku buildpacks:set https://github.com/heroku/heroku-buildpack-go.git\nheroku buildpacks:add https://github.com/heroku/heroku-buildpack-nodejs\n</code></pre>\n\n<p>Once these two commands are executed, your app will first be compiled as a Go one, then as a Node one.<br>\nYour Go app will then be compiled and launchable. Your npm dependencies will also be installed, and the script command in <code>package.json</code> be executable allowing you to install bower dependencies.</p>\n\n<p>See <a href=\"https://devcenter.heroku.com/articles/using-multiple-buildpacks-for-an-app\" rel=\"nofollow\">https://devcenter.heroku.com/articles/using-multiple-buildpacks-for-an-app</a><br>\nAnd <a href=\"https://devcenter.heroku.com/articles/nodejs-support#customizing-the-build-process\" rel=\"nofollow\">https://devcenter.heroku.com/articles/nodejs-support#customizing-the-build-process</a></p>\n"}], "owner": {"reputation": 65, "user_id": 2536945, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/a7fcV.jpg?s=128&g=1", "display_name": "Y-M", "link": "https://stackoverflow.com/users/2536945/y-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 1, "accepted_answer_id": 33387855, "answer_count": 1, "score": 1, "last_activity_date": 1446026113, "creation_date": 1445993961, "question_id": 33381155, "link": "https://stackoverflow.com/questions/33381155/deploying-golang-app-with-bower-on-heroku", "title": "Deploying Golang app with Bower on Heroku", "body": "<p>I have a bower.json file in my root directory, but it doesn't run \"bower install.\" Otherwise my Go app works, but without Bootstrap and other dependencies. But when I add a package.json file and format it correctly, Heroku incorrectly tries to deploy my app as a Node.js app and fails. Is it possible to get Golang and Bower to play nice on a Heroku deployment?</p>\n"}, {"tags": ["reflection", "go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1445996515, "last_edit_date": 1445996515, "creation_date": 1445995076, "answer_id": 33381304, "question_id": 33380708, "link": "https://stackoverflow.com/questions/33380708/how-can-i-make-this-reflect-based-go-code-simpler/33381304#33381304", "title": "How can I make this reflect based GO code simpler?", "body": "<p>Use a <a href=\"https://golang.org/ref/spec#Type_switches\" rel=\"nofollow\">type switch</a> on the <a href=\"https://godoc.org/reflect#Value.Interface\" rel=\"nofollow\">underlying value</a>:</p>\n\n<pre><code>switch v := ve.Interface().(type) {\ncase time.Time:\n    log.Println(\"Handling time.Time\")\n    enc.encodeTime(v)\n    return\ncase []byte:\n    log.Println(\"Handling []uint8\")\n    enc.writeOctetString(v)\n    return\ncase byte:\n    enc.writeUint8(v)\n    return\n// ... and more types here\ndefault:\n    log.Printf(\"Handling type: %v by kind: %v\\n\", ve.Type(), ve.Kind())\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/VR5WafoTzv\" rel=\"nofollow\">playground example</a></p>\n\n<p>You can also switch on the <a href=\"https://godoc.org/reflect#Type\" rel=\"nofollow\">reflect.Type</a> instead of the string:</p>\n\n<pre><code>switch ve.Type() {\ncase reflect.TypeOf(time.Time{}):\n    log.Println(\"Handling time.Time\")\n    ...\ncase reflect.TypeOf([]byte{}):\n    log.Println(\"Handling []uint8\")\n    ...\ncase reflect.TypeOf(uint8(0)):\n    ...\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/0z2YvN0cMO\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 1201, "user_id": 651028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d5887835c21dace586b98180544c74e?s=128&d=identicon&r=PG", "display_name": "Sergei G", "link": "https://stackoverflow.com/users/651028/sergei-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 33381304, "answer_count": 1, "score": 2, "last_activity_date": 1446136073, "creation_date": 1445990945, "last_edit_date": 1446136073, "question_id": 33380708, "link": "https://stackoverflow.com/questions/33380708/how-can-i-make-this-reflect-based-go-code-simpler", "title": "How can I make this reflect based GO code simpler?", "body": "<p>I am encoding a rather complex structure using a very complicated protocol that's a mix of ASN and a variant of XDR and other encodings.</p>\n\n<p>I based the implementation on xdr encoder available on github. The code is reflection based and it works, but I don't like how I implemented target type switch:</p>\n\n<pre><code>st := ve.Type().String()\n    switch st {\n    case \"time.Time\":\n</code></pre>\n\n<p>I think the following approach might be better, but I could not get it to work properly:</p>\n\n<pre><code>switch ve.(type) {\ncase time.Time:\n</code></pre>\n\n<p>The reason it does not work is that ve is of the same reflection type and not the target type.</p>\n\n<p>The following function provides full context of the code:</p>\n\n<pre><code>func (enc *encoderState) encode(v reflect.Value) {\n\nve := enc.indirect(v)\n\nst := ve.Type().String()\nswitch st {\ncase \"time.Time\":\n    log.Println(\"Handling time.Time\")\n    t, ok := ve.Interface().(time.Time)\n    if !ok {\n        enc.err = errors.New(\"Failed to type assert to time.Time\")\n        return\n    }\n    enc.encodeTime(t)\n    return\ncase \"[]uint8\":\n    log.Println(\"Handling []uint8\")\n    enc.writeOctetString(ve.Bytes())\n    return\ndefault:\n    log.Printf(\"Handling type: %v by kind: %v\\n\", st, ve.Kind())\n}\n\n// Handle native Go types.\nswitch ve.Kind() {\ncase reflect.Uint8: // , reflect.Int8\n    enc.writeUint8(uint8(v.Uint()))\n    return\ncase reflect.Uint16: // , reflect.Int16\n    enc.writeUint16(uint16(v.Uint()))\n    return\ncase reflect.Bool:\n    enc.writeBool(ve.Bool())\n    return\ncase reflect.Struct:\n    enc.encodeStruct(ve)\n    return\ncase reflect.Interface:\n    enc.encodeInterface(ve)\n    return\n}\n\n// The only unhandled types left are unsupported.  At the time of this\n// writing the only remaining unsupported types that exist are\n// reflect.Uintptr and reflect.UnsafePointer.\nenc.err = errors.New(fmt.Sprintf(\"unsupported Go type '%s'\", ve.Kind().String()))\n</code></pre>\n\n<p>}</p>\n\n<p>If you know of a better example that can switch by type and kind better, please, let me know.</p>\n\n<p>Thank you</p>\n\n<p>UPDATE</p>\n\n<p>After reading the solution I adjusted to a variation that works:</p>\n\n<pre><code>vi := ve.Interface()\nswitch st := vi.(type) {\ncase time.Time:\n    enc.encodeTime(vi.(time.Time))\n    return\ncase []uint8:\n    enc.writeOctetString(vi.([]byte))\n    return\ndefault:\n    log.Printf(\"Handling type: %v by kind: %v\\n\", st, ve.Kind())\n}\n</code></pre>\n"}, {"tags": ["go", "docker", "boot2docker", "dockerfile"], "comments": [{"owner": {"reputation": 23608, "user_id": 2915097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91318014af3b3d389901d50d5f9276d5?s=128&d=identicon&r=PG&f=1", "display_name": "user2915097", "link": "https://stackoverflow.com/users/2915097/user2915097"}, "edited": false, "score": 0, "creation_date": 1446024832, "post_id": 33379567, "comment_id": 54566953, "body": "I guess you have already read <a href=\"https://medium.com/@gchudnov/trapping-signals-in-docker-containers-7a57fdda7d86#.7noi7qvsy\" rel=\"nofollow noreferrer\">medium.com/@gchudnov/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 240, "user_id": 3104936, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0f61928cd66725be1481fec1ec1f43d6?s=128&d=identicon&r=PG&f=1", "display_name": "ehaydenr", "link": "https://stackoverflow.com/users/3104936/ehaydenr"}, "edited": false, "score": 0, "creation_date": 1446054128, "post_id": 33396870, "comment_id": 54587320, "body": "Thank you!! This was the issue!"}, {"owner": {"reputation": 19673, "user_id": 145435, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/824b41e6108a22c4c96f50ee23419369?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/145435/matt"}, "edited": false, "score": 1, "creation_date": 1487158207, "post_id": 33396870, "comment_id": 71654445, "body": "wow, thank you. for those coming to this later... <code>ENTRYPOINT app</code> will not capture signals, but <code>ENTRYPOINT [&quot;app&quot;]</code> will :-|"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 9, "last_activity_date": 1446051644, "last_edit_date": 1446051644, "creation_date": 1446050846, "answer_id": 33396870, "question_id": 33379567, "link": "https://stackoverflow.com/questions/33379567/sending-signals-to-golang-application-in-docker/33396870#33396870", "title": "Sending signals to Golang application in Docker", "body": "<p>You are running your server inside a shell, and the shell is the process receiving the signals. Your server doesn't exit until you force the shell to quit. </p>\n\n<p>When you use the \"shell\" form of CMD, it starts your server as an argument to <code>/bin/sh -c</code>. In order to exec the server binary directly, you need to provide an array of arguments to either CMD or ENTRYPOINT, starting with the full path of the executable. </p>\n\n<pre><code>CMD [\"/go/bin/simple_server\"]\n</code></pre>\n\n<p>A note from ENTRYPOINT in the <a href=\"https://docs.docker.com/reference/builder/\">Dockerfile docs</a>:</p>\n\n<blockquote>\n  <p>The shell form prevents any CMD or run command line arguments from being used, but has the disadvantage that your ENTRYPOINT will be started as a subcommand of /bin/sh -c, which does not pass signals.</p>\n</blockquote>\n"}], "owner": {"reputation": 240, "user_id": 3104936, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0f61928cd66725be1481fec1ec1f43d6?s=128&d=identicon&r=PG&f=1", "display_name": "ehaydenr", "link": "https://stackoverflow.com/users/3104936/ehaydenr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1882, "favorite_count": 0, "accepted_answer_id": 33396870, "answer_count": 1, "score": 4, "last_activity_date": 1446051644, "creation_date": 1445984783, "last_edit_date": 1445985483, "question_id": 33379567, "link": "https://stackoverflow.com/questions/33379567/sending-signals-to-golang-application-in-docker", "title": "Sending signals to Golang application in Docker", "body": "<p>I am trying to run servers written in golang inside docker containers. For example:</p>\n\n<pre><code>package main\n\nimport \"net/http\"\n\nfunc main() {\n  http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"Hello\"))\n  })\n  http.ListenAndServe(\":3000\", nil)\n}\n</code></pre>\n\n<p>If I run this code on my local machine, I can send it a <code>SIGINT</code> with <kbd>Ctrl-C</kbd> and it will close the application. When I run it inside a docker container, I can't seem to kill it with <kbd>Ctrl-C</kbd>.</p>\n\n<pre><code># Dockerfile\nFROM ubuntu:14.04\n\nRUN apt-get update &amp;&amp; apt-get -y upgrade\nRUN apt-get install -y golang\n\nENV GOPATH /go\n\nCOPY . /go/src/github.com/ehaydenr/simple_server\n\nRUN cd /go/src/github.com/ehaydenr/simple_server &amp;&amp; go install\n\nCMD /go/bin/simple_server\n</code></pre>\n\n<p>I then proceeded to use docker to send signals to the container.</p>\n\n<pre><code>docker kill --signal=INT 9354f574afd4\n</code></pre>\n\n<p>Still running...</p>\n\n<pre><code>docker kill --signal=TERM 9354f574afd4\n</code></pre>\n\n<p>Still running...</p>\n\n<pre><code>docker kill --signal=KILL 9354f574afd4\n</code></pre>\n\n<p>Finally dead.</p>\n\n<p>I'm not catching any signals in my code and ignoring them. I've even tried augmented the code above to catch signals and print them out (which works on my host, but when in the container, it's as if the signals never got to the program).</p>\n\n<p>Has anyone experienced this before? I haven't tried something like this in another language, but I able to kill servers (e.g. <code>mongo</code>, <code>nginx</code>) using <kbd>Ctrl-C</kbd> while they're in a docker container.. Why isn't Go be getting the signals?</p>\n\n<p>Not sure if this makes a difference, but I am on OSX and using docker-machine.</p>\n\n<p>Any help is much appreciated.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 2, "creation_date": 1445981800, "post_id": 33378899, "comment_id": 54551786, "body": "I would go so far as to say Manager2 and Manager3 should not contain context at all: <a href=\"https://play.golang.org/p/YkxjPZ4Hm6\" rel=\"nofollow noreferrer\">play.golang.org/p/YkxjPZ4Hm6</a>. Unless they need ot have unique values. But then they would all need to implement the function."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 1, "creation_date": 1445982820, "post_id": 33378899, "comment_id": 54552280, "body": "@captncraig yes I thought I made that point in the second to last paragraph. Maybe it wasn&#39;t clear. But yes, if <code>Manager1</code> has a <code>Context</code> instance, it would be a poor design to put that same field in anything that embeds <code>Manager1</code>. On top of being redundant it&#39;s god damned confusing!"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 3, "last_activity_date": 1445983290, "last_edit_date": 1445983290, "creation_date": 1445981657, "answer_id": 33378899, "question_id": 33378714, "link": "https://stackoverflow.com/questions/33378714/embedding-structs-to-override-methods/33378899#33378899", "title": "Embedding structs to override methods", "body": "<p>You're misusing embedding. The thing is, you've defined <code>Context</code> on <code>Manager1</code>, in spite of that you've redefined it on each subsequent type. In <code>Manager3</code> you're setting the value for it's <code>Context</code> instance. When <code>Hello()</code> is called, it's defined on <code>Manager2</code> and accesses it's <code>Context</code> instance which doesn't have a value. Check out this example to demonstrate that <a href=\"http://play.golang.org/p/XebShA9ap4\" rel=\"nofollow\">http://play.golang.org/p/XebShA9ap4</a></p>\n\n<p>Money line is:\n<code>m3 = Manager3{Manager2: Manager2{Context: Context{Value: \"testing3\"}}}</code></p>\n\n<p>As you can see, if I instantiate the <code>Manager2</code> instance embedded in <code>Manager3</code> and set it's <code>Context</code> value it gets printed. I would recommend changing your types so that <code>Context</code> is only defined on <code>Manager1</code> and then use syntax like that in my example when you initialize your types.</p>\n\n<p>EDIT: To put the design discussed in comments in writing, you would change your types to this;</p>\n\n<pre><code>type Context struct {\n    Value string\n}\n\ntype Manager1 struct {\n    Context Context\n}\n\ntype Manager2 struct {\n    Manager1\n}\n\ntype Manager3 struct {\n    Manager2\n}\n</code></pre>\n\n<p>Delete the implementation of <code>Hello()</code> on <code>Manager2</code> altogether. Then update your composite-literal initialization to this;</p>\n\n<pre><code>m1 := Manager1{Context: Context{Value: \"testing1\"}}\nm2 := Manager2{Manager1: Manager1{Context: Context{Value: \"testing2\"}}}\nm3 := Manager3{Manager2: Manager2{Manager1: Manager1{Context: Context{Value: \"testing3\"}}}}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 2, "last_activity_date": 1445981716, "creation_date": 1445981716, "answer_id": 33378910, "question_id": 33378714, "link": "https://stackoverflow.com/questions/33378714/embedding-structs-to-override-methods/33378910#33378910", "title": "Embedding structs to override methods", "body": "<p>You are misunderstanding calling methods of embedded  structs via the embedding struct: This is just syntactic sugar!</p>\n\n<p>You are allowed to abbreviate <code>m3.Manager2.Hello()</code> to <code>m3.Hello()</code> but the Hello method is never invoked \"on\" m3 but always on the embedded <code>Manager2</code> (which has a nil Contex).</p>\n\n<p>Embedding does not allow to \"overwrite methods\". Embedding is not subclassing, it is syntactic sugar only.</p>\n"}, {"tags": [], "owner": {"reputation": 300, "user_id": 607454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9796099c4e108fa300fd0ede11697c4b?s=128&d=identicon&r=PG", "display_name": "justinian", "link": "https://stackoverflow.com/users/607454/justinian"}, "is_accepted": false, "score": 0, "last_activity_date": 1445981808, "creation_date": 1445981808, "answer_id": 33378930, "question_id": 33378714, "link": "https://stackoverflow.com/questions/33378714/embedding-structs-to-override-methods/33378930#33378930", "title": "Embedding structs to override methods", "body": "<p>Your <code>Manager3</code> struct contains a number of <code>Context</code> members - you're setting <code>Manager3.Context</code>, but printing <code>Manager2.Context</code>. What you're probably looking for is removing the redundant <code>Context</code> members from <code>Manager1</code> and <code>Manager2</code> and initializing the structs this way:</p>\n\n<pre><code>var (\n    m1 = Manager1{Context: Context{Value: \"testing1\"}}\n    m2 = Manager2{Manager1: Manager1{Context: Context{Value: \"testing2\"}}}\n    m3 = Manager3{Manager2: Manager2{Manager1: Manager1{Context: Context{Value: \"testing3\"}}}}\n)\n</code></pre>\n\n<p>Full example here: <a href=\"http://play.golang.org/p/13DOYKWN5C\" rel=\"nofollow\">http://play.golang.org/p/13DOYKWN5C</a></p>\n\n<p>Providing accessors or factory functions might make this a little nicer.</p>\n"}], "owner": {"reputation": 1993, "user_id": 623949, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cf441bdd92dabf1b772104901c78cf99?s=128&d=identicon&r=PG", "display_name": "tgrosinger", "link": "https://stackoverflow.com/users/623949/tgrosinger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 33378899, "answer_count": 3, "score": 0, "last_activity_date": 1445983290, "creation_date": 1445980902, "question_id": 33378714, "link": "https://stackoverflow.com/questions/33378714/embedding-structs-to-override-methods", "title": "Embedding structs to override methods", "body": "<p><strong>TL;DR</strong> See playground link at bottom.</p>\n\n<p>I have methods defined on a <code>Manager</code> struct which contains a <code>Context</code>. The <code>Manager</code>s are versioned, allowing a new version to only define functions which have changed, and automatically use the functions from the old version if they are not redefined.</p>\n\n<pre><code>type Context struct { ... }\n\ntype Manager1 struct{\n    Context Context\n}\n\ntype Manager2 struct {\n    Manager1\n    Context Context\n}\n</code></pre>\n\n<p>When calling a function on <code>Manager2</code> which is not defined on <code>Manager2</code> the <code>Context</code> is nil. Is there a way to do this where the context will be available?</p>\n\n<p>This example demonstrates the problem better than I can explain it:\n<a href=\"http://play.golang.org/p/gFe6GgUKEJ\" rel=\"nofollow\">http://play.golang.org/p/gFe6GgUKEJ</a></p>\n"}, {"tags": ["go", "beego"], "answers": [{"tags": [], "owner": {"reputation": 566, "user_id": 2232944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d574ec26a01516e243e9b6faeb9346c3?s=128&d=identicon&r=PG", "display_name": "Will Krause", "link": "https://stackoverflow.com/users/2232944/will-krause"}, "is_accepted": false, "score": 1, "last_activity_date": 1446606172, "creation_date": 1446606172, "answer_id": 33512999, "question_id": 33377528, "link": "https://stackoverflow.com/questions/33377528/beego-template-render-partials/33512999#33512999", "title": "Beego template render partials", "body": "<p>Yes, though they are not explicitly referenced as partials in the documentation, you can compose templates like you described.\nFrom the <a href=\"http://beego.me/docs/mvc/view/view.md\" rel=\"nofollow\">documentation</a> for views.</p>\n\n<pre><code>{{template \"header.html\"}}\n  Logic code\n{{template \"footer.html\"}}\n</code></pre>\n\n<p>Because Beego is an MVC framework, it will automatically look for your \"partials\" in the views directory. </p>\n\n<p>If you had another subdirectory called views/base then your partial would look like this:</p>\n\n<pre><code>{{template \"base/header.html\" .}}\n</code></pre>\n\n<p>A good reference implementation that will provide more examples in the context of a real world app, check out the <a href=\"https://github.com/beego/wetalk\" rel=\"nofollow\">wetalk</a> project on github </p>\n"}], "owner": {"reputation": 1030, "user_id": 1826041, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/02248a1542f3d31b240677f65c5e714e?s=128&d=identicon&r=PG", "display_name": "Myth Rush", "link": "https://stackoverflow.com/users/1826041/myth-rush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 737, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1446606172, "creation_date": 1445976485, "question_id": 33377528, "link": "https://stackoverflow.com/questions/33377528/beego-template-render-partials", "title": "Beego template render partials", "body": "<p>Is there a functionality to render partial templates in the Beego? I used this functionality in RoR. </p>\n\n<p><strong><em>Ruby on Rails partials:</em></strong>\nPartial templates - usually just called \"partials\" - are another device for breaking the rendering process into more manageable chunks. With a partial, you can move the code for rendering a particular piece of a response to its own file.</p>\n\n<p><strong>Example from RoR:</strong></p>\n\n<pre><code>&lt;!-- html.erb --&gt;\n&lt;h1&gt;New zone&lt;/h1&gt;\n&lt;%= render partial: \"form\", locals: {zone: @zone} %&gt;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>&lt;!-- _form.html.erb --&gt;\n&lt;%= form_for(zone) do |f| %&gt;\n  &lt;p&gt;\n    &lt;b&gt;Zone name&lt;/b&gt;&lt;br&gt;\n    &lt;%= f.text_field :name %&gt;\n  &lt;/p&gt;\n  &lt;p&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1445966629, "post_id": 33374061, "comment_id": 54543284, "body": "What is the signature of <code>OtherFunc</code>? is it <code>OtherFunc(values ...inteface{})</code> or something else?"}, {"owner": {"reputation": 692, "user_id": 2355596, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/pXs2u.jpg?s=128&g=1", "display_name": "Thiago Augustus Oliveira", "link": "https://stackoverflow.com/users/2355596/thiago-augustus-oliveira"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1445967093, "post_id": 33374061, "comment_id": 54543576, "body": "I&#39;m using <b>gorm</b> and the signature is <code>func (s *DB) AutoMigrate(values ...interface{}) *DB</code>"}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 3, "last_activity_date": 1445965374, "creation_date": 1445965374, "answer_id": 33374134, "question_id": 33374061, "link": "https://stackoverflow.com/questions/33374061/go-multiple-pointers/33374134#33374134", "title": "GO Multiple Pointers", "body": "<p>I'm not sure this will solve your problem entirely however, the exact thing you requested is a feature in the language. You just have to use composite-literal syntax for instantiation instead of new. So you could do this to pass pointers; <code>MyFunc( &amp;Model{}, &amp;Mode2{} )</code></p>\n\n<p>Thing is, you're still going to be dealing with an <code>interface{}</code> within <code>MyFunc</code> so I'm not sure that will just be able to call <code>OtherFunc</code> without some unboxing (would probably be a type assertion if you want to get technical).</p>\n"}], "owner": {"reputation": 692, "user_id": 2355596, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/pXs2u.jpg?s=128&g=1", "display_name": "Thiago Augustus Oliveira", "link": "https://stackoverflow.com/users/2355596/thiago-augustus-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 33374134, "answer_count": 1, "score": 0, "last_activity_date": 1445965374, "creation_date": 1445965194, "question_id": 33374061, "link": "https://stackoverflow.com/questions/33374061/go-multiple-pointers", "title": "GO Multiple Pointers", "body": "<p>I'm trying to create a function that receives multiple types of struct and add those pointer values to another function. </p>\n\n<blockquote>\n  <p>Example:  </p>\n</blockquote>\n\n<pre class=\"lang-go prettyprint-override\"><code>type Model1 struct {\n  Name string\n}\n\ntype Model2 struct {\n  Type bool\n}\n\nfunc MyFunc(value ...interface{}) {\n  OtherFunc(value...)\n}\n\nfunc main() {\n  MyFunc( new(Model), new(Mode2) );\n}\n</code></pre>\n\n<p>The problem is that <code>OtherFunc</code> only allow <code>&amp;value, &amp;value, etc</code> as parameter. Have some way to pass those values like <code>OtherFunc(&amp;value...)</code>?</p>\n"}, {"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1445963741, "post_id": 33373443, "comment_id": 54541381, "body": "That <i>should</i> work fine, maybe meddler is doing something wrong?"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1445964400, "post_id": 33373673, "comment_id": 54541860, "body": "@thwd: I know ;) just showing the type assertion in case the OP wasn&#39;t sure how to get the concrete type out of the reflect.MakeSlice."}, {"owner": {"reputation": 916, "user_id": 88633, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ac7a0d0a7e2b544abed5b9f963009d7?s=128&d=identicon&r=PG", "display_name": "i0n", "link": "https://stackoverflow.com/users/88633/i0n"}, "edited": false, "score": 0, "creation_date": 1445966457, "post_id": 33373673, "comment_id": 54543177, "body": "Hey there. I tried that already, but thought that perhaps I was missing something because I get the following error: ScanAll called with pointer to non-slice: *interface {} which is being emitted from meddler. I&#39;m not married to using meddler, just want a quick and simple way of querying MySQL. I&#39;d happily remove it."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 916, "user_id": 88633, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ac7a0d0a7e2b544abed5b9f963009d7?s=128&d=identicon&r=PG", "display_name": "i0n", "link": "https://stackoverflow.com/users/88633/i0n"}, "edited": false, "score": 0, "creation_date": 1445967578, "post_id": 33373673, "comment_id": 54543852, "body": "@i0n: you have to assert the type before you take the address, since you can&#39;t use a pointer to an interface. I&#39;ll add an example about creating a pointer with reflect if that&#39;s what you&#39;re looking for."}, {"owner": {"reputation": 916, "user_id": 88633, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ac7a0d0a7e2b544abed5b9f963009d7?s=128&d=identicon&r=PG", "display_name": "i0n", "link": "https://stackoverflow.com/users/88633/i0n"}, "edited": false, "score": 0, "creation_date": 1445968835, "post_id": 33373673, "comment_id": 54544591, "body": "Hey, thanks for the help! I think what I need to do is create a slice of pointers to a struct type that is passed in through the functions interface. The resulting slice needs to have type slice etc when it is introspected, because I think this is what is causing meddler to blow up. Is this possible?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 916, "user_id": 88633, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ac7a0d0a7e2b544abed5b9f963009d7?s=128&d=identicon&r=PG", "display_name": "i0n", "link": "https://stackoverflow.com/users/88633/i0n"}, "edited": false, "score": 0, "creation_date": 1445969471, "post_id": 33373673, "comment_id": 54544962, "body": "@i0n: The first example makes a <code>[]*MyType</code>, the second makes a <code>*[]*MyType</code>. Those are the actual types which will come out of the interface{}. I think the second example is what you&#39;re looking for, since you want the pass the pointer to <code>meddler.QueryAll</code> immediately."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 4, "last_activity_date": 1445967691, "last_edit_date": 1445967691, "creation_date": 1445964100, "answer_id": 33373673, "question_id": 33373443, "link": "https://stackoverflow.com/questions/33373443/create-slice-of-pointers-using-reflection-in-go/33373673#33373673", "title": "Create slice of pointers using reflection in Go", "body": "<p>You can create a slice using reflect and an example of the type like so:</p>\n\n<pre><code>var t *MyType\n\ntypeOfT := reflect.TypeOf(t)\nsliceOfT := reflect.SliceOf(typeOfT)\n\ns := reflect.MakeSlice(sliceOfT, 0, 0).Interface()\n</code></pre>\n\n<p>In order to pass a pointer to the slice without knowing the type, you can create the pointer first, then set the slice value:</p>\n\n<pre><code>ptr := reflect.New(sliceOfT)\nptr.Elem().Set(reflect.MakeSlice(sliceOfT, 0, 0))\ns := ptr.Interface()\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/zGSqe45E60\" rel=\"nofollow\">http://play.golang.org/p/zGSqe45E60</a></p>\n"}], "owner": {"reputation": 916, "user_id": 88633, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ac7a0d0a7e2b544abed5b9f963009d7?s=128&d=identicon&r=PG", "display_name": "i0n", "link": "https://stackoverflow.com/users/88633/i0n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1056, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1445967691, "creation_date": 1445963491, "question_id": 33373443, "link": "https://stackoverflow.com/questions/33373443/create-slice-of-pointers-using-reflection-in-go", "title": "Create slice of pointers using reflection in Go", "body": "<p>I've seen a few examples of reflection around this topic, but I can't find anything that solves this issue. It feels a little convoluted, but the alternative is a massive amount of repetition so I thought I'd give it a try.</p>\n\n<p>I have a function that returns a function (handler). The wrapping function passes in an instance of a struct. I need the inner function to create a slice of pointers to that struct type:</p>\n\n<pre><code>func createCollectionHandler(app *appSession, record interface{}, name string) func(res http.ResponseWriter, req *http.Request) {\n    return func(res http.ResponseWriter, req *http.Request) {\n        res.Header().Set(\"Content-Type\", \"application/json\")\n\n        // This line needs to be dynamic:\n        var result []*Person\n\n        err := meddler.QueryAll(app.MysqlDB, &amp;result, \"select * from \"+name)\n        if err != nil {\n            log.Fatal(err)\n        }\n        json, err := json.MarshalIndent(result, \"\", \" \")\n        if err != nil {\n            log.Println(err)\n        }\n        res.Write([]byte(json))\n        return\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3563, "user_id": 4126167, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-baFe5bbrU-Q/AAAAAAAAAAI/AAAAAAAAEno/Z_qgijE14aE/photo.jpg?sz=128", "display_name": "Katharine Osborne", "link": "https://stackoverflow.com/users/4126167/katharine-osborne"}, "edited": false, "score": 0, "creation_date": 1445955402, "post_id": 33370205, "comment_id": 54535223, "body": "So I&#39;ve found this documentation that indicates that it needs to be explicitly declared in the app.yaml file:  <a href=\"https://cloud.google.com/appengine/docs/go/config/appconfig\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/go/config/appconfig</a>  Which I&#39;ve done (and changed the path to absolute in the script element), but I still have the same error."}, {"owner": {"reputation": 1855, "user_id": 1558705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1563795271fe55bf0beab2d12cd69b0?s=128&d=identicon&r=PG", "display_name": "Dean Elbaz", "link": "https://stackoverflow.com/users/1558705/dean-elbaz"}, "edited": false, "score": 0, "creation_date": 1445957672, "post_id": 33370205, "comment_id": 54536887, "body": "using devtools on chrome (or similar) can you check if main.js is loaded? Does it have the correct content type? if it&#39;s not too big can you post it here?"}, {"owner": {"reputation": 3563, "user_id": 4126167, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-baFe5bbrU-Q/AAAAAAAAAAI/AAAAAAAAEno/Z_qgijE14aE/photo.jpg?sz=128", "display_name": "Katharine Osborne", "link": "https://stackoverflow.com/users/4126167/katharine-osborne"}, "reply_to_user": {"reputation": 1855, "user_id": 1558705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1563795271fe55bf0beab2d12cd69b0?s=128&d=identicon&r=PG", "display_name": "Dean Elbaz", "link": "https://stackoverflow.com/users/1558705/dean-elbaz"}, "edited": false, "score": 0, "creation_date": 1445959507, "post_id": 33370205, "comment_id": 54538292, "body": "@DeanElbaz I&#39;ve added a screenshot to show you what&#39;s happening (main.js is actual javascript, just a short little geolocation thing to find the user&#39;s lat/long)."}], "answers": [{"comments": [{"owner": {"reputation": 3563, "user_id": 4126167, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-baFe5bbrU-Q/AAAAAAAAAAI/AAAAAAAAEno/Z_qgijE14aE/photo.jpg?sz=128", "display_name": "Katharine Osborne", "link": "https://stackoverflow.com/users/4126167/katharine-osborne"}, "edited": false, "score": 0, "creation_date": 1446213569, "post_id": 33372106, "comment_id": 54663497, "body": "So the solution to catching all the files is to move the - url: /.* handler to the bottom of the list of handlers. As the file is parsed, it will stop at the first match and not read in anything else."}], "tags": [], "owner": {"reputation": 3563, "user_id": 4126167, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-baFe5bbrU-Q/AAAAAAAAAAI/AAAAAAAAEno/Z_qgijE14aE/photo.jpg?sz=128", "display_name": "Katharine Osborne", "link": "https://stackoverflow.com/users/4126167/katharine-osborne"}, "is_accepted": true, "score": 0, "last_activity_date": 1445959822, "creation_date": 1445959822, "answer_id": 33372106, "question_id": 33370205, "link": "https://stackoverflow.com/questions/33370205/template-file-in-go-app-reading-itself-instead-of-js-and-css-files/33372106#33372106", "title": "Template file in go app reading itself instead of js and css files", "body": "<p>(\u256f\u00b0\u25a1\u00b0\uff09\u256f\ufe35 \u253b\u2501\u253b Ah it was the app.yaml file. I had:</p>\n\n<pre><code>application: bedlington\nversion: 1\nruntime: go\napi_version: go1\n\nhandlers:\n- url: /.*\n  script: _go_app\n\n- url: /css\n  static_dir: css\n\n- url: /js\n  static_dir: js\n</code></pre>\n\n<p>But that first url handler catches all the things. So instead this solved the problem:</p>\n\n<pre><code>application: bedlington\nversion: 1\nruntime: go\napi_version: go1\n\nhandlers:\n- url: /\n  script: _go_app\n\n- url: /css\n  static_dir: css\n\n- url: /js\n  static_dir: js\n</code></pre>\n\n<p>Now I don't know how to catch all the urls (or how to properly exclude resource folders), but it solves the initial problem.</p>\n"}], "owner": {"reputation": 3563, "user_id": 4126167, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-baFe5bbrU-Q/AAAAAAAAAAI/AAAAAAAAEno/Z_qgijE14aE/photo.jpg?sz=128", "display_name": "Katharine Osborne", "link": "https://stackoverflow.com/users/4126167/katharine-osborne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 33372106, "answer_count": 1, "score": 0, "last_activity_date": 1445959822, "creation_date": 1445954860, "last_edit_date": 1445959391, "question_id": 33370205, "link": "https://stackoverflow.com/questions/33370205/template-file-in-go-app-reading-itself-instead-of-js-and-css-files", "title": "Template file in go app reading itself instead of js and css files", "body": "<p>I've just starting learning go and I'm noodling around with web apps using the Google app engine. I've worked through the guestbook tutorial, and have now started my own project. The go part compiles just fine, but there's something strange happening when the template tries to render. It's able to render all the HTML, but I've added both CSS and JS, and the template is somehow reading in itself instead of the respective CSS and JS files. It's bizarre. I'm not sure it's a path problem (I would expect a 404).</p>\n\n<p>This is the error I'm getting in the console:</p>\n\n<pre><code>Uncaught SyntaxError: Unexpected token &lt;\n</code></pre>\n\n<p>And when I view the resource it's picking up for the js file, it's identical to the template. I've placed my js and css relative to the template folder, so I would expect it would find it:</p>\n\n<pre><code>app/\n- templates/\n- css/\n- js/\n</code></pre>\n\n<p>So my script is called thusly in the template:</p>\n\n<pre><code>&lt;script src=\"../js/main.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>How should I be structuring my JS and CSS resources (and later, images, and SASS/LESS)?</p>\n\n<p><em>Edit</em></p>\n\n<p>This is what I see in the source for Chrome devtools:</p>\n\n<p><a href=\"https://i.stack.imgur.com/w7B2A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w7B2A.png\" alt=\"screenshot of devtools\"></a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1445950497, "post_id": 33368510, "comment_id": 54531580, "body": "It&#39;s <code>go vet</code>, not <code>go tool vet</code>."}, {"owner": {"reputation": 79, "user_id": 3919161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IMDJF.jpg?s=128&g=1", "display_name": "talking penguin", "link": "https://stackoverflow.com/users/3919161/talking-penguin"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1445954322, "post_id": 33368510, "comment_id": 54534424, "body": "It&#39;s exactly the same.     bash-4.3# go vet     go tool: no such tool &quot;vet&quot;"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1445957362, "post_id": 33368510, "comment_id": 54536666, "body": "@P.C: Your use of <code>echo</code> is pointless. You are showing what you think Go is looking at. To find out what Go is actually looking at post the output from <code>go env</code>."}, {"owner": {"reputation": 79, "user_id": 3919161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IMDJF.jpg?s=128&g=1", "display_name": "talking penguin", "link": "https://stackoverflow.com/users/3919161/talking-penguin"}, "edited": false, "score": 0, "creation_date": 1445957862, "post_id": 33368510, "comment_id": 54537015, "body": "Ah thanks a lot. I get a similar output.      bash-4.3# go env     GOARCH=&quot;amd64&quot;     GOBIN=&quot;&quot;     GOEXE=&quot;&quot;     GOHOSTARCH=&quot;amd64&quot;     GOHOSTOS=&quot;linux&quot;     GOOS=&quot;linux&quot;     GOPATH=&quot;/go&quot;     GORACE=&quot;&quot;     GOROOT=&quot;/usr/lib/go&quot;     GOTOOLDIR=&quot;/usr/lib/go/pkg/tool/linux_amd64&quot;     GO15VENDOREXPERIMENT=&quot;&quot;     CC=&quot;gcc&quot;     GOGCCFLAGS=&quot;-fPIC -m64 -pthread -fmessage-length=0&quot;     CXX=&quot;g++&quot;     CGO_ENABLED=&quot;1&quot;"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1445963440, "post_id": 33368510, "comment_id": 54541167, "body": "@PC: The output of <code>go env</code> is good. As expected, the <code>vet</code> program is in <code>$GOPATH&#47;bin</code> (<code>&#47;go&#47;bin</code>). Post the output of the <code>$PATH</code> command. With <code>&#47;go&#47;bin</code> in your <code>$PATH</code>, run <code>go vet</code> on a package or <code>go tool vet</code> on files or a directory. See <a href=\"https://godoc.org/golang.org/x/tools/cmd/vet\" rel=\"nofollow noreferrer\">Command vet</a>."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1445963663, "post_id": 33368510, "comment_id": 54541323, "body": "@Ainar-G: <code>go vet</code> or <code>go tool vet</code>: <a href=\"https://godoc.org/golang.org/x/tools/cmd/vet\" rel=\"nofollow noreferrer\">Command vet</a>."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1445964169, "post_id": 33368510, "comment_id": 54541694, "body": "@P.C:  Post the full list. Post the output ot <code>$PATH</code>. I get <code>$ go tool addr2line api asm cgo compile cover dist doc fix link newlink nm objdump pack pprof trace vet yacc $</code>"}, {"owner": {"reputation": 79, "user_id": 3919161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IMDJF.jpg?s=128&g=1", "display_name": "talking penguin", "link": "https://stackoverflow.com/users/3919161/talking-penguin"}, "edited": false, "score": 0, "creation_date": 1445965487, "post_id": 33368510, "comment_id": 54542565, "body": "Added it to the information dump. I can see <code>vet</code> in the $GOPATH/bin but <code>go tool</code> doesn&#39;t list it."}], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 3919161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IMDJF.jpg?s=128&g=1", "display_name": "talking penguin", "link": "https://stackoverflow.com/users/3919161/talking-penguin"}, "is_accepted": false, "score": -1, "last_activity_date": 1446052161, "creation_date": 1446052161, "answer_id": 33397303, "question_id": 33368510, "link": "https://stackoverflow.com/questions/33368510/go-tool-unable-to-find-binary-go-tool-no-such-tool-vet/33397303#33397303", "title": "Go tool unable to find binary. go tool: no such tool &quot;vet&quot;", "body": "<p>Figured out the issue. It appears that I had missed installing go tools on the base docker image that I was using.</p>\n\n<pre><code>RUN apk --update-cache --allow-untrusted \\\n--repository http://dl-3.alpinelinux.org/alpine/edge/community/ \\\n--arch=x86_64 add \\\ngo=${GOLANG_VERSION}-r3 \\\ngo-tools=${GOLANG_VERSION}-r3 \\\ngit \\\n&amp;&amp; rm -rf /var/cache/apk/* \\\n&amp;&amp; mkdir -p /go/src /go/bin \\\n&amp;&amp; chmod -R 777 /go\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1547330145, "creation_date": 1547330145, "answer_id": 54164220, "question_id": 33368510, "link": "https://stackoverflow.com/questions/33368510/go-tool-unable-to-find-binary-go-tool-no-such-tool-vet/54164220#54164220", "title": "Go tool unable to find binary. go tool: no such tool &quot;vet&quot;", "body": "<p>Warning: starting Go 1.12 (February 2019, 3.5 years later), <code>go tool vet</code> won't be available at all. Only <code>go vet</code>.</p>\n\n<p>See <a href=\"https://tip.golang.org/doc/go1.12#vet\" rel=\"nofollow noreferrer\">go 1.12 release notes</a>:</p>\n\n<blockquote>\n  <p>The <code>go vet</code> command has been rewritten to serve as the base for a range of different source code analysis tools. See the <a href=\"https://godoc.org/golang.org/x/tools/go/analysis\" rel=\"nofollow noreferrer\"><code>golang.org/x/tools/go/analysis</code></a> package for details. </p>\n  \n  <p><strong>A side-effect is that <code>go tool vet</code> is no longer supported</strong>.<br>\n  External tools that use <code>go tool vet</code> must be changed to use <code>go vet</code>.<br>\n  Using <code>go vet</code> instead of <code>go tool vet</code> should work with all supported versions of Go.</p>\n  \n  <p>As part of this change, the experimental <code>-shadow</code> option is no longer available with <code>go vet</code>.<br>\n  Checking for variable shadowing may now be done using:</p>\n</blockquote>\n\n<pre><code>go install golang.org/x/tools/go/analysis/passes/shadow/cmd/shadow\ngo vet -vettool=$(which shadow)\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 3919161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IMDJF.jpg?s=128&g=1", "display_name": "talking penguin", "link": "https://stackoverflow.com/users/3919161/talking-penguin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3110, "favorite_count": 4, "answer_count": 2, "score": 2, "last_activity_date": 1547330145, "creation_date": 1445950402, "last_edit_date": 1445965405, "question_id": 33368510, "link": "https://stackoverflow.com/questions/33368510/go-tool-unable-to-find-binary-go-tool-no-such-tool-vet", "title": "Go tool unable to find binary. go tool: no such tool &quot;vet&quot;", "body": "<p>I'm running golang in a docker container. And 'go tool' is unable to find 'vet'. Could you give me ideas on how to debug this?</p>\n\n<p>I've used the Dockerfile for 1.5 as a template. <a href=\"https://github.com/docker-library/golang/blob/51d6eacd41fe80d41105142b9ad32f575082970f/1.5/Dockerfile\" rel=\"nofollow\">https://github.com/docker-library/golang/blob/51d6eacd41fe80d41105142b9ad32f575082970f/1.5/Dockerfile</a></p>\n\n<pre><code>ENV GOLANG_VERSION 1.5.1\nENV GOLANG_DOWNLOAD_URL https://golang.org/dl/go$GOLANG_VERSION.linux-        amd64.tar.gz\nENV GOLANG_DOWNLOAD_SHA1 46eecd290d8803887dec718c691cc243f2175fe0\n\nRUN curl -fsSL \"$GOLANG_DOWNLOAD_URL\" -o golang.tar.gz \\\n&amp;&amp; echo \"$GOLANG_DOWNLOAD_SHA1  golang.tar.gz\" | sha1sum -c - \\\n&amp;&amp; tar -C /usr/local -xzf golang.tar.gz \\\n&amp;&amp; rm golang.tar.gz\n\nENV GOPATH /go\nENV PATH $GOPATH/bin:/usr/local/go/bin:$PATH\n</code></pre>\n\n<p>However, when I install govet with</p>\n\n<pre><code>go get golang.org/x/tools/cmd/vet \n</code></pre>\n\n<p>and try</p>\n\n<pre><code>bash-4.3# go tool vet\ngo tool: no such tool \"vet\"\n</code></pre>\n\n<p>I have the following go environment set up:</p>\n\n<pre><code>$PATH includes $GOPATH/bin /usr/lib/go/bin:/go/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n\nbash# go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/go\"\nGORACE=\"\"\nGOROOT=\"/usr/lib/go\"\nGOTOOLDIR=\"/usr/lib/go/pkg/tool/linux_amd64\"\nGO15VENDOREXPERIMENT=\"\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nbash# ls $GOPATH/bin\nfgt               go-junit-report   godep             golint            mt-content-blogs  vet   \nbash# ls $GOROOT/bin/\ngo     gofmt\n</code></pre>\n\n<p><strong>The crux of the issue is that go tools does not list vet, even after installing it with <code>go get golang.org/x/tools/cmd/vet</code></strong></p>\n\n<pre><code>bash# go tool\naddr2line\napi\nasm\ncgo\ncompile\ndist\ndoc\nfix\nlink\nnm\nobjdump\npack\npprof\ntrace\nyacc\n</code></pre>\n"}, {"tags": ["go", "garbage-collection"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1445938782, "post_id": 33364138, "comment_id": 54523468, "body": "I&#39;d recommend adding your Go version and an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> to your question so that more people could try to reproduce and tell you what&#39;s wrong."}, {"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 3, "creation_date": 1445940328, "post_id": 33364138, "comment_id": 54524619, "body": "unrelated sidenote: In your<code>PacketWriter</code> you should use a channel (and <code>range</code> over it) rather than the busy <code>for</code> loop"}, {"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 3, "creation_date": 1445941233, "post_id": 33364138, "comment_id": 54525267, "body": "Oh, my sidenote may not be that unrelated: try adding a <code>runtime.Gosched()</code> inside of that tight <code>for</code> loop in the writer"}], "answers": [{"tags": [], "owner": {"reputation": 720, "user_id": 2535434, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yLud4.jpg?s=128&g=1", "display_name": "molenzwiebel", "link": "https://stackoverflow.com/users/2535434/molenzwiebel"}, "is_accepted": true, "score": 2, "last_activity_date": 1445949266, "last_edit_date": 1495541720, "creation_date": 1445949266, "answer_id": 33368135, "question_id": 33364138, "link": "https://stackoverflow.com/questions/33364138/go-gc-stopping-my-goroutine/33368135#33368135", "title": "Go GC stopping my goroutine?", "body": "<p>As per <a href=\"https://stackoverflow.com/users/5292835/mrd0ll4r\">mrd0ll4r</a>s comment, changed the writer to use channels instead of a slice (I don't even know why I did that in the first place). That seemed to give the GC enough \"mobility\" to allow the threads to stop. Adding in the <code>runtime.Gosched()</code> and still using slices also worked though, but the channels seemed more \"go-esque\".</p>\n"}], "owner": {"reputation": 720, "user_id": 2535434, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yLud4.jpg?s=128&g=1", "display_name": "molenzwiebel", "link": "https://stackoverflow.com/users/2535434/molenzwiebel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "accepted_answer_id": 33368135, "answer_count": 1, "score": 1, "last_activity_date": 1445949266, "creation_date": 1445938121, "last_edit_date": 1445939206, "question_id": 33364138, "link": "https://stackoverflow.com/questions/33364138/go-gc-stopping-my-goroutine", "title": "Go GC stopping my goroutine?", "body": "<p>I have been trying to get into Go from the more traditional languages such as Java and C and so far I've been enjoying the well-thought out design choices that Go offers. When I started my first \"real\" project though, I ran into a problem that almost nobody seems to have.</p>\n\n<p>My project is a simple networking implementation that sends and receives packets. The general structure is something like this (of course simplified):</p>\n\n<p>A client manages the <code>net.Conn</code> with the server. This <code>Client</code>creates a <code>PacketReader</code>and a <code>PacketWriter</code>. These both run infinite loops in a different goroutine. The <code>PacketReader</code> takes an interface with a single <code>OnPacketReceived</code> function that is implemented by the client.</p>\n\n<p>The <code>PacketReader</code> code looks something like this:</p>\n\n<pre><code>go func() {\n    for {\n        bytes, err := reader.ReadBytes(10) // Blocks the current routine until bytes are available.\n        if err != nil {\n            panic(err) // Handle error\n        }\n        reader.handler.OnPacketReceived(reader.parseBytes(bytes))\n    }\n}()\n</code></pre>\n\n<p>The <code>PacketWriter</code> code looks something like this:</p>\n\n<pre><code>go func() {\n\n    for {\n        if len(reader.packetQueue) &gt; 0 {\n            // Write packet\n        }\n    }\n}()\n</code></pre>\n\n<p>In order to make <code>Client</code> blocking, the client makes a channel that gets filled by <code>OnPacketReceived</code>, something like this:</p>\n\n<pre><code>type Client struct {\n    callbacks map[int]chan interface{}\n    // More fields\n}\n\nfunc (c *Client) OnPacketReceived(packet *Packet) {\n    c.callbacks[packet.Id] &lt;- packet.Data\n}\n\nfunc (c *Client) SendDataBlocking(id int, data interface{}) interface{} {\n    c.PacketWriter.QueuePacket(data)\n    return &lt;-c.callbacks[id]\n}\n</code></pre>\n\n<p>Now here is my problem: the <code>reader.parseBytes</code> function does some intensive decoding operation that creates quite a lot of objects (to the point that the GC decides to run). <em>The GC however, pauses the reader goroutine that is currently decoding the bytes, and then hangs</em>. A problem that seems similar to mine is described <a href=\"https://github.com/golang/go/issues/12553\" rel=\"nofollow\">here</a>. I have confirmed that it is actually the GC causing it, because running it with <code>GOGC=off</code> runs successfully.  </p>\n\n<p>At this point, my 3 routines look like this:<br>\n- <code>Client (main routine)</code>: Waiting for channel<br>\n- <code>Writer</code>: Still running, waiting for new data in queue<br>\n- <code>Reader</code>: Set as runnable, but not actually running  </p>\n\n<p>Somehow, the GC is either not able to stop all routines in order to run, or it does not resume said goroutines after it stopped them.  </p>\n\n<p>So my question is this: <strong>Is there any way to fix this?</strong> I am new to Go so I don't really know if my design choices are even remotely conventional, and I'm all up with changing the structure of my program. Do I need to change the way I handle packet reading callbacks, do I need to try and make the packet decoder less intensive? Thanks!   </p>\n\n<p><strong>Edit</strong>: I am running Go 1.5.1, I'll try to get a working example later today.</p>\n"}, {"tags": ["pointers", "struct", "go"], "answers": [{"tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 19, "last_activity_date": 1445926930, "creation_date": 1445926930, "answer_id": 33361153, "question_id": 33361070, "link": "https://stackoverflow.com/questions/33361070/is-it-common-to-have-struct-members-be-pointers/33361153#33361153", "title": "Is it common to have struct members be pointers?", "body": "<p>In the github package the reason is that most structs are intended to be serialized/deserialized from json from the github api.</p>\n\n<p>The reason they use <code>*int</code> instead of <code>int</code> is because the zero value of a pointer is <code>nil</code>, while the zero value of <code>int</code> is <code>0</code>. It allows the client to distingish between \"this field was not included in the response\" and \"the value of this field is zero\". </p>\n\n<p>This is particularly useful for things like times, where if you do not have nilable types, you will end up with a lot of 00-00-0000 type dates.</p>\n"}], "owner": {"reputation": 3238, "user_id": 2469769, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7b880cf2f7613e8752fba1e19e7bc7bc?s=128&d=identicon&r=PG", "display_name": "AndrewH", "link": "https://stackoverflow.com/users/2469769/andrewh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1920, "favorite_count": 5, "accepted_answer_id": 33361153, "answer_count": 1, "score": 12, "last_activity_date": 1572599153, "creation_date": 1445926590, "last_edit_date": 1572599153, "question_id": 33361070, "link": "https://stackoverflow.com/questions/33361070/is-it-common-to-have-struct-members-be-pointers", "title": "Is it common to have struct members be pointers?", "body": "<p>Take, for example, the <a href=\"https://godoc.org/github.com/google/go-github/github\" rel=\"noreferrer\">go github package</a>. Just about every member of every struct defined is a pointer to a value rather than a value.</p>\n\n<p>Is this idiomatic Go? Why?</p>\n\n<p>I understand that it reduces the size of the struct (assuming the size of the pointer is less than the size of the value it points to) which may important if you are passing around structs by value a lot. But why not have a struct of values and pass the struct by pointer instead?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 462, "user_id": 1365520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/aa5f0c4003145813dec46fddbf8c470a?s=128&d=identicon&r=PG", "display_name": "mcbain83", "link": "https://stackoverflow.com/users/1365520/mcbain83"}, "edited": false, "score": 0, "creation_date": 1445903731, "post_id": 33357384, "comment_id": 54511104, "body": "Thanks for the answer. I wanted to know if it could be done or not. Looks like no. The why isn&#39;t important for answer although I do recognise it&#39;s not an ideal situation so I will need to rethink this approach. Thanks again"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 2, "last_activity_date": 1445902184, "creation_date": 1445902184, "answer_id": 33357384, "question_id": 33357309, "link": "https://stackoverflow.com/questions/33357309/golang-compiling-the-same-package-from-two-different-file-locations/33357384#33357384", "title": "golang compiling the same package from two different file locations", "body": "<p>Are you asking to essentially \"split\" the code for a package between two folders in two different gopaths? The go tool cannot do this, as it takes the first folder it finds on any folder in your gopath. If you are actively working on a project, why would it go in the vendor gopath and not in the src one?</p>\n\n<p>It is because of distinctions like this that I generally recommend one gopath for everything. If you want to vendor dependencies I recommend doing that for each individual main package you have.</p>\n"}, {"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 1, "last_activity_date": 1445924877, "creation_date": 1445924877, "answer_id": 33360722, "question_id": 33357309, "link": "https://stackoverflow.com/questions/33357309/golang-compiling-the-same-package-from-two-different-file-locations/33360722#33360722", "title": "golang compiling the same package from two different file locations", "body": "<p>As captncraig said: The go tool cannot do this.</p>\n\n<p>But you are free to call the go compiler itself on any set of files you want: <code>go tool compile &lt;file.go&gt;...</code> </p>\n\n<p>Of course this would reintroduce some kind of Makefile style build system. It is doable but all the heavy lifting done by <code>go build</code> or <code>go install</code> is lost and will have to live in your Makefiles.</p>\n"}], "owner": {"reputation": 462, "user_id": 1365520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/aa5f0c4003145813dec46fddbf8c470a?s=128&d=identicon&r=PG", "display_name": "mcbain83", "link": "https://stackoverflow.com/users/1365520/mcbain83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 836, "favorite_count": 0, "accepted_answer_id": 33357384, "answer_count": 2, "score": 0, "last_activity_date": 1445924877, "creation_date": 1445901753, "question_id": 33357309, "link": "https://stackoverflow.com/questions/33357309/golang-compiling-the-same-package-from-two-different-file-locations", "title": "golang compiling the same package from two different file locations", "body": "<p>The way I have my projects structured is similar to the following</p>\n\n<pre><code>/workspace\n  /src\n    /package1\n  /vendor\n    /src\n      /somepackage\n      /anotherpackage\n      /package1\n</code></pre>\n\n<p>My GOPATH is set to <code>/workspace;/workspace/vendor</code></p>\n\n<p>Note this is not using the go 1.5 vendor option.</p>\n\n<p>So far everything has been compiling and working fine within out build / development workflow. \nI'm in a situation now where I would like to import a library into the vendor directory workspace/vendor/src/package1 but write some unit tests in the workspace/src/package1 directory..   </p>\n\n<p>When the tests run it cannot find methods from the package1 in the vendor dir.  </p>\n\n<p>Is there a way to get the vendor package code recognised into the same namespace like this?</p>\n"}, {"tags": ["go", "gnupg"], "comments": [{"owner": {"reputation": 1919, "user_id": 448831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae82dcc4e407ab6016125d3bcdc2316c?s=128&d=identicon&r=PG", "display_name": "Wayne Walker", "link": "https://stackoverflow.com/users/448831/wayne-walker"}, "edited": false, "score": 1, "creation_date": 1445913001, "post_id": 33357222, "comment_id": 54513572, "body": "I have since added <code>&quot;--output&quot;, &quot;-&quot; </code> to the Args and that &quot;fixes&quot; it but I&#39;m still wondering what the difference is between at the shell and spawned from Go in that same shell environment."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1445951234, "post_id": 33357222, "comment_id": 54532156, "body": "A lot of programs change their behavior if the output is a tty or not."}, {"owner": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "edited": false, "score": 1, "creation_date": 1445984012, "post_id": 33357222, "comment_id": 54552762, "body": "You should remove your email from this question."}], "owner": {"reputation": 1919, "user_id": 448831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae82dcc4e407ab6016125d3bcdc2316c?s=128&d=identicon&r=PG", "display_name": "Wayne Walker", "link": "https://stackoverflow.com/users/448831/wayne-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1446821600, "creation_date": 1445901209, "last_edit_date": 1446821600, "question_id": 33357222, "link": "https://stackoverflow.com/questions/33357222/calling-gpg-from-inside-golang-changes-its-behavior", "title": "Calling gpg from inside golang changes it&#39;s behavior", "body": "<p>First, I'm using gpg, because openpgp module doesn't support gpg-agent.</p>\n\n<p>My problem:</p>\n\n<p>If, at the command line, I run the following, gpg decrypts the file and writes its contents to stdout (like I want):</p>\n\n<pre><code>/usr/bin/gpg --decrypt /home/wwalker/castle_keys.asc\n</code></pre>\n\n<p>So, then, I run it from inside Go, and the behavior changes, it writes to a sibling file to the asc file (I've change the exec'd app to env and run it and the environment is the same as the parent (as expected)).  I don't know if this is a Go thing (I doubt it) or a gpg thing (I expect it to be very wary of where it writes to):</p>\n\n<pre><code>wwalker@hatter:~/golang_workspace/src/devops/play$ ./play\n\nYou need a passphrase to unlock the secret key for\nuser: \"Wayne Walker (Ruby Hacker) &lt;wwalker@redacted.com&gt;\"\n4096-bit ELG-E key, ID 39D0C3D7, created 2007-12-31 (main key ID A62B624A)\n\nFile `/home/wwalker/Files/castle_keys' exists. Overwrite? (y/N) \nEnter new filename: asdf\n</code></pre>\n\n<p>play.go:</p>\n\n<pre><code>wwalker@hatter:~/golang_workspace/src/devops/play$ cat main.go\n// Author wwalker\n\npackage main\n\nimport (\n        \"bytes\"\n        \"fmt\"\n        \"os/exec\"\n)\n\nfunc decryptFile(filename string) ([]byte, error) {\n        //cmd := exec.Command(\"/usr/bin/env\")\n        var cmd exec.Cmd\n        var output bytes.Buffer\n\n        cmd.Path = \"/usr/bin/gpg\"\n        cmd.Args = []string{\"--decrypt\", filename}\n        cmd.Stdout = &amp;output\n\n        if err := cmd.Run(); err != nil {\n                return nil, err\n        }\n\n        return output.Bytes(), nil\n}\n\nfunc main() {\n        bytes, err := decryptFile(\"/home/wwalker/Files/castle_keys.asc\")\n        if err == nil {\n                fmt.Printf(\"%s\\n\", string(bytes))\n        }\n}\n</code></pre>\n"}, {"tags": ["csv", "go"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 21, "last_activity_date": 1445901921, "last_edit_date": 1445901921, "creation_date": 1445901580, "answer_id": 33357286, "question_id": 33357156, "link": "https://stackoverflow.com/questions/33357156/write-struct-to-csv-file/33357286#33357286", "title": "Write struct to csv file", "body": "<p>It would be a lot easier if you used a concrete type. You'll probably want to use the <code>encoding/csv</code> package, here is a relevant example; <a href=\"https://golang.org/pkg/encoding/csv/#example_Writer\" rel=\"noreferrer\">https://golang.org/pkg/encoding/csv/#example_Writer</a></p>\n\n<p>As you can see, the <code>Write</code> method is expecting a <code>[]string</code> so in order to generate this, you'll have to either 1) provide a helper method or 2) reflect <code>my_struct</code>. Personally, I prefer the first method but it depends on your needs. If you want to go route two you can get all the fields on the struct an use them as the column headers, then iterate the fields getting the value for each, use <code>append</code> in that loop to add them to a <code>[]string</code> and then pass it to <code>Write</code> out side of the loop.</p>\n\n<p>For the first option, I would define a <code>ToSlice</code> or something on each type and then I would make an interface call it <code>CsvAble</code> that requires the <code>ToSlice</code> method. Change the type in your method <code>my_struct CsvAble</code> instead of using the empty interface and then you can just call <code>ToSlice</code> on <code>my_struct</code> and pass the return value into <code>Write</code>. You could have that return the column headers as well (meaning you would get back a <code>[][]string</code> and need to iterate the outer dimension passing each <code>[]string</code> into <code>Write</code>) or you could require another method to satisfy the interface like <code>GetHeaders</code> that returns a <code>[]string</code> which is the column headers. If that were the case your code would look something like;</p>\n\n<pre><code>w := csv.NewWriter(os.Stdout)\nheaders := my_struct.GetHeaders()\nvalues := my_struct.ToSlice()\nif err := w.Write(headers); err != nil {\n    //write failed do something\n}\nif err := w.Write(values); err != nil {\n    //write failed do something\n}\n</code></pre>\n\n<p>If that doesn't make sense let me know and I can follow up with a code sample for either of the two approaches.</p>\n"}], "owner": {"reputation": 1104, "user_id": 7229, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d544328222b79642f37d47e1190dd5f9?s=128&d=identicon&r=PG", "display_name": "webwesen", "link": "https://stackoverflow.com/users/7229/webwesen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20272, "favorite_count": 4, "accepted_answer_id": 33357286, "answer_count": 1, "score": 9, "last_activity_date": 1445903040, "creation_date": 1445900748, "last_edit_date": 1445903040, "question_id": 33357156, "link": "https://stackoverflow.com/questions/33357156/write-struct-to-csv-file", "title": "Write struct to csv file", "body": "<p>What is an idiomatic golang way to dump the struct into a csv file provided? I am inside a func where my struct is passed as interface{}:</p>\n\n<pre><code>func decode_and_csv(my_response *http.Response, my_struct interface{})\n</code></pre>\n\n<p>Why interface{}? - reading data from JSON and there could be a few different structs returned, so trying to write a generic enough function.</p>\n\n<p>an example of my types:</p>\n\n<pre><code>type Location []struct {\n    Name                   string `json: \"Name\"`\n    Region                 string `json: \"Region\"`\n    Type                   string `json: \"Type\"`\n}\n</code></pre>\n"}, {"tags": ["go", "build"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4867687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9660ffb6cdb517e33f653f3a7531c00d?s=128&d=identicon&r=PG&f=1", "display_name": "eben", "link": "https://stackoverflow.com/users/4867687/eben"}, "edited": false, "score": 0, "creation_date": 1445965693, "post_id": 33355541, "comment_id": 54542690, "body": "Thank you, that did the trick!  BTW, the reason for multiple GOPATHs is that we have been using go 1.4 up to now, and we were dependent on older versions of certain external packages, so for different versions of our own code we use specific GOPATHs and saved versions of the external packages."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 11, "user_id": 4867687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9660ffb6cdb517e33f653f3a7531c00d?s=128&d=identicon&r=PG&f=1", "display_name": "eben", "link": "https://stackoverflow.com/users/4867687/eben"}, "edited": false, "score": 1, "creation_date": 1445965871, "post_id": 33355541, "comment_id": 54542795, "body": "Very good. We have been solving problems like that by copying packages we depend on into the source tree for our individual main packages. I have found <a href=\"https://github.com/kardianos/govendor\" rel=\"nofollow noreferrer\">govendor</a> to be quite good for that. Then each project has their own version of their dependencies."}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 5, "last_activity_date": 1445893265, "creation_date": 1445893265, "answer_id": 33355541, "question_id": 33355472, "link": "https://stackoverflow.com/questions/33355472/golang-matched-no-packages-error-with-absolute-path-fine-with-relative-path/33355541#33355541", "title": "golang &quot;matched no packages&quot; error with absolute path, fine with relative path", "body": "<p><code>pwd</code> will use the full absolute path, but the <code>go</code> tool expects paths relative to <code>$gopath</code>.</p>\n\n<p>What you really want is <code>go install github.com/couchbaselabs/cbq-gui/...</code> most likely. Assuming your gopath is set to <code>/Users/eben/src/cbq-gui</code> which is a bit odd to me. </p>\n\n<p>Most people use a single gopath for all their projects.</p>\n"}, {"tags": [], "owner": {"reputation": 2764, "user_id": 5326634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/agDBB.jpg?s=128&g=1", "display_name": "Siyaram Malav", "link": "https://stackoverflow.com/users/5326634/siyaram-malav"}, "is_accepted": false, "score": 0, "last_activity_date": 1570727908, "creation_date": 1570727908, "answer_id": 58328088, "question_id": 33355472, "link": "https://stackoverflow.com/questions/33355472/golang-matched-no-packages-error-with-absolute-path-fine-with-relative-path/58328088#58328088", "title": "golang &quot;matched no packages&quot; error with absolute path, fine with relative path", "body": "<p>You need to run go installation command in your $GOPATH(\"/Users/eben/src/cbq-gui/\") with go mod.</p>\n\n<pre><code>$ GO111MODULE=on go get -u github.com/couchbaselabs/cbq-gui/...\n</code></pre>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 11, "user_id": 4867687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9660ffb6cdb517e33f653f3a7531c00d?s=128&d=identicon&r=PG&f=1", "display_name": "eben", "link": "https://stackoverflow.com/users/4867687/eben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7113, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1570727908, "creation_date": 1445893031, "last_edit_date": 1445893389, "question_id": 33355472, "link": "https://stackoverflow.com/questions/33355472/golang-matched-no-packages-error-with-absolute-path-fine-with-relative-path", "title": "golang &quot;matched no packages&quot; error with absolute path, fine with relative path", "body": "<p>I have a tree of golang code. I am using golang 1.5.1 on a Mac (OS X 10.11). I can successfully build my code with the following command with relative paths on the command line.</p>\n\n<p>go install ./...</p>\n\n<p>But, if I use an absolute path, I get an error message. E.g.,</p>\n\n<p>go install `pwd`/...]</p>\n\n<p>warning: \"/Users/eben/src/cbq-gui/src/github.com/couchbaselabs/cbq-gui/...\"   matched no packages</p>\n\n<p>That seems pretty odd, since \".\" and `pwd` should evaluate to the same thing. What am I missing? Thanks.</p>\n"}, {"tags": ["go", "url-routing", "gorilla", "mux"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1445888055, "post_id": 33354077, "comment_id": 54503851, "body": "Are you asking how to use something like <code>curl</code> to make a request from the command line?"}, {"owner": {"reputation": 607, "user_id": 2624018, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9ffd4aabd89fcc3c50fd7430d7d8b222?s=128&d=identicon&r=PG", "display_name": "AbhishekSaha", "link": "https://stackoverflow.com/users/2624018/abhisheksaha"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1445888343, "post_id": 33354077, "comment_id": 54504006, "body": "@JimB No, definitely not that. This question tends to be pretty confusing to ask. It&#39;s more like, the url is given on the command line like so &quot;go run *.go -url=&quot;<a href=\"http://localhost:8080/something\" rel=\"nofollow noreferrer\">localhost:8080/something</a>&quot; where the go application parses the URL flag for the URL"}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1445888535, "post_id": 33354077, "comment_id": 54504100, "body": "Posting the code you have would help"}, {"owner": {"reputation": 431, "user_id": 460593, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/WsDHr.jpg?s=128&g=1", "display_name": "Circuit in the wall", "link": "https://stackoverflow.com/users/460593/circuit-in-the-wall"}, "edited": false, "score": 0, "creation_date": 1445888591, "post_id": 33354077, "comment_id": 54504136, "body": "When you enter the URL into the command line, what is the problem you&#39;re running into? Does the program throw an error? Posting that would help."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1445888677, "post_id": 33354077, "comment_id": 54504184, "body": "Are you trying to serve from the url the user entered? Because that&#39;s what you&#39;re code is doing. If you&#39;re trying to make a request to it, my answer should have you covered."}, {"owner": {"reputation": 607, "user_id": 2624018, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9ffd4aabd89fcc3c50fd7430d7d8b222?s=128&d=identicon&r=PG", "display_name": "AbhishekSaha", "link": "https://stackoverflow.com/users/2624018/abhisheksaha"}, "edited": false, "score": 0, "creation_date": 1445889044, "post_id": 33354077, "comment_id": 54504396, "body": "I&#39;m not sure what &quot;serving&quot;, I apologize I&#39;m really new to this. Basically, I want to make an API call from a specific URL. I can do this by entering the URL in a browser window, I want to do the same thing via a GO method and a given URL without opening a broswer window"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1445889965, "post_id": 33354077, "comment_id": 54504949, "body": "is this the same question? <a href=\"http://stackoverflow.com/questions/33293072/how-to-redirect-url-in-go-main-method\" title=\"how to redirect url in go main method\">stackoverflow.com/questions/33293072/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 607, "user_id": 2624018, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9ffd4aabd89fcc3c50fd7430d7d8b222?s=128&d=identicon&r=PG", "display_name": "AbhishekSaha", "link": "https://stackoverflow.com/users/2624018/abhisheksaha"}, "edited": false, "score": 0, "creation_date": 1445889795, "post_id": 33354273, "comment_id": 54504854, "body": "That didn&#39;t work. I did:  http.Get(&quot;<a href=\"http://localhost:8080/list&quot;\" rel=\"nofollow noreferrer\">localhost:8080/list&quot;</a>)   And nothing happened. I entered &quot;<a href=\"http://localhost:8080/list\" rel=\"nofollow noreferrer\">localhost:8080/list</a>&quot; into a browser, and it made the API call"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 607, "user_id": 2624018, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9ffd4aabd89fcc3c50fd7430d7d8b222?s=128&d=identicon&r=PG", "display_name": "AbhishekSaha", "link": "https://stackoverflow.com/users/2624018/abhisheksaha"}, "edited": false, "score": 3, "creation_date": 1445890027, "post_id": 33354273, "comment_id": 54504975, "body": "@AbhishekSaha make sure you use <code>http:&#47;&#47;localhost:8080&#47;list</code> for your request in Go. Then check the value of <code>err</code> and <code>resp</code>. If <code>err</code> is not nil you got a 200 and can proceed to read the response body. Try printing it to console for debugging. I guarantee that method will do what you want if you use it right."}, {"owner": {"reputation": 607, "user_id": 2624018, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9ffd4aabd89fcc3c50fd7430d7d8b222?s=128&d=identicon&r=PG", "display_name": "AbhishekSaha", "link": "https://stackoverflow.com/users/2624018/abhisheksaha"}, "edited": false, "score": 0, "creation_date": 1445891540, "post_id": 33354273, "comment_id": 54505905, "body": "If I try the http.Get call after I start the router, it doesn&#39;t get called. If I try the http.Get call before I start the router, I get this error: &quot;getsockopt: connection refused&quot;.   I start the router like so: &quot;log.Fatal(http.ListenAndServe(&quot;:8080&quot;, router))&quot;"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 607, "user_id": 2624018, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9ffd4aabd89fcc3c50fd7430d7d8b222?s=128&d=identicon&r=PG", "display_name": "AbhishekSaha", "link": "https://stackoverflow.com/users/2624018/abhisheksaha"}, "edited": false, "score": 1, "creation_date": 1445891931, "post_id": 33354273, "comment_id": 54506120, "body": "@AbhishekSaha this code should not be in your API... They should be two different applications. Start your API, write this code as it&#39;s own little stand alone main and run it from the command line. Your API calling itself based on arguments passed in from the command line by a user makes no sense at all..."}, {"owner": {"reputation": 607, "user_id": 2624018, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9ffd4aabd89fcc3c50fd7430d7d8b222?s=128&d=identicon&r=PG", "display_name": "AbhishekSaha", "link": "https://stackoverflow.com/users/2624018/abhisheksaha"}, "edited": false, "score": 0, "creation_date": 1445897098, "post_id": 33354273, "comment_id": 54508847, "body": "That worked, thanks for the help man. Trust me, I would not be using Go if I didn&#39;t have to"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 607, "user_id": 2624018, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9ffd4aabd89fcc3c50fd7430d7d8b222?s=128&d=identicon&r=PG", "display_name": "AbhishekSaha", "link": "https://stackoverflow.com/users/2624018/abhisheksaha"}, "edited": false, "score": 0, "creation_date": 1445897360, "post_id": 33354273, "comment_id": 54508943, "body": "@AbhishekSaha np. Try to keep a positive outlook. Go is a great language and these concepts carry over to others. If you wanted to do the same in C# the code required would be nearly the same, even down to the methods, class and package names."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1445888622, "creation_date": 1445888622, "answer_id": 33354273, "question_id": 33354077, "link": "https://stackoverflow.com/questions/33354077/how-to-call-open-a-url-within-go-method/33354273#33354273", "title": "How to call/open a URL within Go method?", "body": "<p>If you're trying to make an HTTP request in Go there are easy to use methods for that purpose in the standard library at; <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow\">https://golang.org/pkg/net/http/</a></p>\n\n<p>As JimB pointed out in comment you could use something like <code>curl</code> and just forgo using Go altogether. Launching <code>curl</code> from Go doesn't make a whole lot of sense to me when you can just do <code>resp, err := http.Get(urlArg)</code> and get the same result. There are also methods for other HTTP verbs and if you need more fine tuned control of the request you can use the <code>Do</code> method and create <code>Request</code> object to do things like set headers.</p>\n"}], "owner": {"reputation": 607, "user_id": 2624018, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9ffd4aabd89fcc3c50fd7430d7d8b222?s=128&d=identicon&r=PG", "display_name": "AbhishekSaha", "link": "https://stackoverflow.com/users/2624018/abhisheksaha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1358, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1445889837, "creation_date": 1445887963, "last_edit_date": 1445889837, "question_id": 33354077, "link": "https://stackoverflow.com/questions/33354077/how-to-call-open-a-url-within-go-method", "title": "How to call/open a URL within Go method?", "body": "<p>I have a Gorilla Mux router set up in Go. I have routes set up within that router, as well as function handlers associated with those routes. The router works perfectly, <strong>if</strong> you open a browser window and enter specific URLs. However, the problem I'm running into is what to do if the URL is entered on the command line. I know how to store the URL from the command line arguments, but I don't know how to forward the URL, stored as a URL variable in Go, to the router. Like, how do you call a route's function handler if the URL is given on the command line INSTEAD of entered via browser window?</p>\n\n<p>Code:</p>\n\n<pre><code>u, err := url.Parse(os.Args[1])\nif err != nil {\n    fmt.Println(err.Error())\n}\n\nhost, port, _ := net.SplitHostPort(u.Host)\n\ns := []string{\":\", port};\n\nrouter := ANewRouter()\n\nlog.Fatal(http.ListenAndServe(strings.Join(s, \"\"), router))\n\n//Route URL to router, somehow\n</code></pre>\n"}, {"tags": ["testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 431, "user_id": 460593, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/WsDHr.jpg?s=128&g=1", "display_name": "Circuit in the wall", "link": "https://stackoverflow.com/users/460593/circuit-in-the-wall"}, "edited": false, "score": 0, "creation_date": 1445944188, "post_id": 33355263, "comment_id": 54527275, "body": "Neat! Upvoted. But I&#39;ll still wait for an answer that can run examples that you don&#39;t have push access over, and/or can compile them &quot;properly&quot; into single runnable binaries."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1445947167, "last_edit_date": 1445947167, "creation_date": 1445892282, "answer_id": 33355263, "question_id": 33354043, "link": "https://stackoverflow.com/questions/33354043/how-to-run-go-examples-which-dont-have-output-comments/33355263#33355263", "title": "How to run Go examples, which don&#39;t have output comments?", "body": "<p>You can call the <code>Example*</code> functions from a regular <code>Test*</code> function.</p>\n\n<pre><code>func ExampleOutput() {\n    fmt.Println(\"HEELLO\")\n}\n\nfunc TestExampleOutput(t *testing.T) {\n    if !testing.Verbose() {\n        return\n    }\n    ExampleOutput()\n}\n</code></pre>\n\n<p>This body of this example would show up under <code>Output</code> in the docs, and if you don't want the output every time, it's limited to only calling it with the <code>-v</code> flag.</p>\n\n<hr>\n\n<p>Specifically, to run only the example you're interested in you can either:</p>\n\n<pre><code>go test path/to/pkg -run TestExampleOutput -v\n</code></pre>\n\n<p>Or to compile once and run multiple times:</p>\n\n<pre><code>go test path/to/pkg -c\n./pkg.test -test.run TestExampleOutput -test.v\n</code></pre>\n"}], "owner": {"reputation": 431, "user_id": 460593, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/WsDHr.jpg?s=128&g=1", "display_name": "Circuit in the wall", "link": "https://stackoverflow.com/users/460593/circuit-in-the-wall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 33355263, "answer_count": 1, "score": 2, "last_activity_date": 1445947167, "creation_date": 1445887805, "last_edit_date": 1445889118, "question_id": 33354043, "link": "https://stackoverflow.com/questions/33354043/how-to-run-go-examples-which-dont-have-output-comments", "title": "How to run Go examples, which don&#39;t have output comments?", "body": "<p>Testable Go examples look awesome. </p>\n\n<pre><code>func ExampleReverse() {\n    fmt.Println(stringutil.Reverse(\"hello\"))\n    // Output: olleh\n}\n</code></pre>\n\n<p>The above, for example, is equivalent to a unit test that asserts:</p>\n\n<pre><code>stringutil.Reverse(\"hello\") == \"olleh\"\n</code></pre>\n\n<p>According to <a href=\"https://blog.golang.org/examples\" rel=\"nofollow\">the golang blog</a>, we can write examples that don't have an output comment, but then the <code>go test</code> and <code>go test -run ExampleReverse</code> commands only <em>compile</em> the example and don't run it:</p>\n\n<blockquote>\n  <p>If we remove the output comment entirely then the example function is compiled but not executed. Examples without output comments are useful for demonstrating code that cannot run as unit tests, such as that which accesses the network, while guaranteeing the example at least compiles.</p>\n</blockquote>\n\n<p>The output of such examples, although not testable, could still be useful for the user to produce and read. And the examples themselves - useful to run on their computer.</p>\n\n<p>So is there a way or a tool that can run example functions in *_test.go files from the terminal?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1053, "user_id": 3608492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e469e0555fc5221b227deb0d9a305a?s=128&d=identicon&r=PG&f=1", "display_name": "Satyen Rai", "link": "https://stackoverflow.com/users/3608492/satyen-rai"}, "is_accepted": true, "score": 2, "last_activity_date": 1445893516, "creation_date": 1445893516, "answer_id": 33355616, "question_id": 33353469, "link": "https://stackoverflow.com/questions/33353469/compile-go-for-windows-phone/33355616#33355616", "title": "Compile Go for Windows Phone", "body": "<p>As of Go 1.5, Windows on ARM is not a supported target.</p>\n"}], "owner": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 33355616, "answer_count": 1, "score": 0, "last_activity_date": 1445893516, "creation_date": 1445885711, "question_id": 33353469, "link": "https://stackoverflow.com/questions/33353469/compile-go-for-windows-phone", "title": "Compile Go for Windows Phone", "body": "<p>I know it is possible to build Go for Android and iOS.</p>\n\n<p>Can we build Go to be consumed by say, a Windows Phone app in the same was as Android and iOS?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 6, "creation_date": 1445878997, "post_id": 33351387, "comment_id": 54498338, "body": "You can&#39;t import packages that are not in <code>$GOPATH&#47;src</code>. Try creating a <code>project&#47;baz</code> package, you won&#39;t be able to import it either. Put all your projects into GOPATH."}, {"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 2, "creation_date": 1445879167, "post_id": 33351387, "comment_id": 54498481, "body": "What if I don&#39;t want to place every project under GOPATH?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1445879209, "post_id": 33351387, "comment_id": 54498509, "body": "That&#39;s how the go tools work. If you want to use a package, it needs to be under GOPATH."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1445880418, "post_id": 33351387, "comment_id": 54499337, "body": "There is no &quot;I want&quot; with the go tooling: Use the tools like they are meant to be used; everything else will lead to pain."}, {"owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "edited": false, "score": 1, "creation_date": 1471539968, "post_id": 33351387, "comment_id": 65398376, "body": "If you don&#39;t want to place your source code under $GOPATH, you can create a symbolic link with the <code>ln</code> command to your source directory, if you&#39;re on *UNIX (mainly Mac OS X or Linux). If you&#39;re on Windows, use the <code>mklink</code> command which is a built-in of the shell."}, {"owner": {"reputation": 358, "user_id": 2512445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fca43f048bbe3afea9d222b86dfd638?s=128&d=identicon&r=PG", "display_name": "Cade Daniel", "link": "https://stackoverflow.com/users/2512445/cade-daniel"}, "edited": false, "score": 1, "creation_date": 1569962435, "post_id": 33351387, "comment_id": 102763283, "body": "Note that these comments have been outdated by <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">go modules</a> -- they allow users to build go src outside of GOPATH."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 21, "last_activity_date": 1445880170, "last_edit_date": 1445880170, "creation_date": 1445879474, "answer_id": 33351610, "question_id": 33351387, "link": "https://stackoverflow.com/questions/33351387/how-to-use-internal-packages/33351610#33351610", "title": "How to use &quot;internal&quot; packages?", "body": "<p>The packages have to be located in your <code>$GOPATH</code> in order to be imported. The example you gave with <code>import \"./internal/foo|bar\"</code> works because it does a local-import. <code>internal</code> only makes it so code that doesn't share a common root directory to your <code>internal</code> directory can't import the packages within <code>internal</code>.</p>\n\n<p>If you put all this in your gopath then tried to import from a different location like <code>OuterFolder/project2/main.go</code> where <code>OuterFolder</code> contains both <code>project</code> and <code>project2</code> then <code>import \"../../project/internal/foo\"</code> would fail. It would also fail as <code>import \"foo\"</code> or any other way your tried due to not satisfying this condition;</p>\n\n<blockquote>\n  <p>An import of a path containing the element \u201cinternal\u201d is disallowed if\n  the importing code is outside the tree rooted at the parent of the\n  \u201cinternal\u201d directory.</p>\n</blockquote>\n\n<p>Now if you had the path <code>$GOPATH/src/project</code> then you could do <code>import \"foo\"</code> and <code>import \"bar\"</code> from within <code>$GOPATH/src/project/main.go</code> and the import would succeed. Things that are not contained underneath <code>project</code> however would not be able to import <code>foo</code> or <code>bar</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3641, "user_id": 3139595, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/r1GRx.png?s=128&g=1", "display_name": "Edwin O.", "link": "https://stackoverflow.com/users/3139595/edwin-o"}, "is_accepted": false, "score": 19, "last_activity_date": 1527584497, "last_edit_date": 1527584497, "creation_date": 1520592915, "answer_id": 49192168, "question_id": 33351387, "link": "https://stackoverflow.com/questions/33351387/how-to-use-internal-packages/49192168#49192168", "title": "How to use &quot;internal&quot; packages?", "body": "<p>below way is more scalable, especially when you plan to build multiple binaries </p>\n\n<pre><code>github.com/servi-io/api\n\u251c\u2500\u2500 cmd/\n\u2502   \u251c\u2500\u2500 servi/\n\u2502   \u2502   \u251c\u2500\u2500 cmdupdate/\n\u2502   \u2502   \u251c\u2500\u2500 cmdquery/\n\u2502   \u2502   \u2514\u2500\u2500 main.go\n\u2502   \u2514\u2500\u2500 servid/\n\u2502       \u251c\u2500\u2500 routes/\n\u2502       \u2502   \u2514\u2500\u2500 handlers/\n\u2502       \u251c\u2500\u2500 tests/\n\u2502       \u2514\u2500\u2500 main.go\n\u251c\u2500\u2500 internal/\n\u2502   \u251c\u2500\u2500 attachments/\n\u2502   \u251c\u2500\u2500 locations/\n\u2502   \u251c\u2500\u2500 orders/\n\u2502   \u2502   \u251c\u2500\u2500 customers/\n\u2502   \u2502   \u251c\u2500\u2500 items/\n\u2502   \u2502   \u251c\u2500\u2500 tags/\n\u2502   \u2502   \u2514\u2500\u2500 orders.go\n\u2502   \u251c\u2500\u2500 registrations/\n\u2502   \u2514\u2500\u2500 platform/\n\u2502       \u251c\u2500\u2500 crypto/\n\u2502       \u251c\u2500\u2500 mongo/\n\u2502       \u2514\u2500\u2500 json/\n</code></pre>\n\n<p>The folders inside <code>cmd/</code> represents the number of binaries you want to build.</p>\n\n<p><a href=\"https://www.ardanlabs.com/blog/2017/02/package-oriented-design.html\" rel=\"noreferrer\">for more</a> </p>\n"}, {"tags": [], "owner": {"reputation": 2984, "user_id": 1315512, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/24a3c7cbc4d169a5b5a731baf4b4ce15?s=128&d=identicon&r=PG", "display_name": "FranticRock", "link": "https://stackoverflow.com/users/1315512/franticrock"}, "is_accepted": false, "score": 0, "last_activity_date": 1555357654, "last_edit_date": 1555357654, "creation_date": 1555355738, "answer_id": 55695897, "question_id": 33351387, "link": "https://stackoverflow.com/questions/33351387/how-to-use-internal-packages/55695897#55695897", "title": "How to use &quot;internal&quot; packages?", "body": "<p>Also to check: When you are using your externally imported object types:  <strong>make sure you are prefixing them with the namespace they're in.</strong>  As a golang newbie, I didn't know I had to do that, and was wondering why is VS Code just removing my import (for not being used) when I saved.   It's because I had to <strong>prefix the imported object with the namespace name:</strong></p>\n\n<pre><code>Example:\nimport (\n    \"myInternalPackageName\"  // works fine as long as you follow all instructions in this thread\n)\n\n//Usage in code: \nmyInternalPackageName.TheStructName   // prefix it, or it won't work. \n</code></pre>\n\n<p>If you don't put the namespace prefix before the object/struct name, VS code just removes your import for being unused, and then you still have the error:  \"Can't find TheStructName\"...   That was very confusing, and I had to do a build without VS code through the command line to understand that.  </p>\n\n<p><strong>The point is:  I had to specify the package prefix when actually using the struct from that internal package.</strong> </p>\n\n<p>If you don't want to use the qualifier prefix when using imported objects, use: </p>\n\n<pre><code>import . \"thePath\"    // Can use contents without prefixing. \n</code></pre>\n\n<p>Reference: <a href=\"https://stackoverflow.com/questions/6478962/what-does-the-dot-or-period-in-a-go-import-statement-do\">What does the &#39;.&#39; (dot or period) in a Go import statement do?</a></p>\n"}, {"comments": [{"owner": {"reputation": 10390, "user_id": 596370, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8571b5b8d990c5ed1220f78cc3b55c49?s=128&d=identicon&r=PG", "display_name": "rashok", "link": "https://stackoverflow.com/users/596370/rashok"}, "edited": false, "score": 1, "creation_date": 1611681048, "post_id": 61941386, "comment_id": 116527053, "body": "Nice explanation"}], "tags": [], "owner": {"reputation": 58368, "user_id": 30038, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/mPvRH.jpg?s=128&g=1", "display_name": "Vlad Bezden", "link": "https://stackoverflow.com/users/30038/vlad-bezden"}, "is_accepted": false, "score": 15, "last_activity_date": 1593714115, "last_edit_date": 1593714115, "creation_date": 1590085925, "answer_id": 61941386, "question_id": 33351387, "link": "https://stackoverflow.com/questions/33351387/how-to-use-internal-packages/61941386#61941386", "title": "How to use &quot;internal&quot; packages?", "body": "<p>With modules introduction in Go v1.11 and above you don't have to specify your project path in $GOPATH/src</p>\n<p>You need to tell Go about where each module located by creating go.mod file. Please refer to <code>go help mod</code> documentation.</p>\n<p>Here is an example of how to do it:</p>\n<pre><code>project\n|   go.mod\n|   main.go\n|\n\\---internal\n    +---bar\n    |       bar.go\n    |       go.mod\n    |\n    \\---foo\n            foo.go\n            go.mod\n</code></pre>\n<p>project/internal/bar/go.mod</p>\n<pre><code>module bar\n\ngo 1.14\n</code></pre>\n<p>project/internal/bar/bar.go</p>\n<pre><code>package bar\n\nimport &quot;fmt&quot;\n\n//Bar prints &quot;Hello from Bar&quot;\nfunc Bar() {\n    fmt.Println(&quot;Hello from Bar&quot;)\n}\n\n</code></pre>\n<p>project/internal/foo/go.mod</p>\n<pre><code>module foo\n\ngo 1.14\n</code></pre>\n<p>project/internal/foo/foo.go</p>\n<pre><code>package foo\n\nimport &quot;fmt&quot;\n\n//Foo prints &quot;Hello from Foo&quot;\nfunc Foo() {\n    fmt.Println(&quot;Hello from Foo&quot;)\n}\n</code></pre>\n<p>project/main.go</p>\n<pre><code>package main\n\nimport (\n    &quot;internal/bar&quot;\n    &quot;internal/foo&quot;\n)\n\nfunc main() {\n    bar.Bar()\n    foo.Foo()\n}\n\n</code></pre>\n<p>Now the most important module\nproject/go.mod</p>\n<pre><code>module project\n\ngo 1.14\n\n\nrequire internal/bar v1.0.0\nreplace internal/bar =&gt; ./internal/bar\nrequire internal/foo v1.0.0\nreplace internal/foo =&gt; ./internal/foo\n\n</code></pre>\n<p>Couple things here:</p>\n<ol>\n<li>You can have any name in require. You can have project/internal/bar if you wish. What Go think it is URL address for the package, so it will try to pull it from web and give you error</li>\n</ol>\n<pre><code>go: internal/bar@v1.0.0: malformed module path &quot;internal/bar&quot;: missing dot in first path element\n</code></pre>\n<p>That is the reason why you need to have <code>replace</code> where you tell Go where to find it, and that is the key!</p>\n<pre><code>replace internal/bar =&gt; ./internal/bar\n</code></pre>\n<ol start=\"2\">\n<li>The version doesn't matter in this case. You can have v0.0.0 and it will work.</li>\n</ol>\n<p>Now, when you execute your code you will have</p>\n<pre><code>Hello from Bar\nHello from Foo\n</code></pre>\n<p><a href=\"https://github.com/vlad-bezden/gonestedmodules\" rel=\"noreferrer\">Here is GitHub link for this code example</a></p>\n"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45147, "favorite_count": 7, "accepted_answer_id": 33351610, "answer_count": 4, "score": 37, "last_activity_date": 1593714115, "creation_date": 1445878785, "last_edit_date": 1445960030, "question_id": 33351387, "link": "https://stackoverflow.com/questions/33351387/how-to-use-internal-packages", "title": "How to use &quot;internal&quot; packages?", "body": "<p>I try understand how to organize go code using \"internal\" packages. Let me show what the structure I have:</p>\n\n<pre><code>project/\n  internal/\n    foo/\n      foo.go # package foo\n    bar/\n      bar.go # package bar\n  main.go\n\n# here is the code from main.go\npackage main\n\nimport (\n  \"project/internal/foo\"\n  \"project/internal/bar\"\n)\n</code></pre>\n\n<p><code>project/</code> is outside from GOPATH tree. Whatever path I try to import from <code>main.go</code> nothing works, the only case working fine is <code>import \"./internal/foo|bar\"</code>. I think I do something wrong or get \"internal\" package idea wrong in general. Could anybody make things clearer, please?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>The example above is correct the only what I need was to place <code>project/</code> folder under <code>$GOPATH/src</code>. So the thing is import path like the <code>project/internal/foo|bar</code> is workable if we only import it from <code>project/</code> subtree and not from the outside.</p>\n"}, {"tags": ["go", "package"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1445878535, "post_id": 33351282, "comment_id": 54498006, "body": "see <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1445878752, "post_id": 33351282, "comment_id": 54498170, "body": "What command did you use to build? From what I gather, to build with a &#39;local import&#39; you have to indicate that your main package is also local by explicitly providing it to the build command like <code>go build main.go</code>"}], "answers": [{"comments": [{"owner": {"reputation": 40992, "user_id": 40106, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/164ca8ba426bdb10381290b9617d3ea7?s=128&d=identicon&r=PG&f=1", "display_name": "4thSpace", "link": "https://stackoverflow.com/users/40106/4thspace"}, "edited": false, "score": 0, "creation_date": 1445883846, "post_id": 33351436, "comment_id": 54501489, "body": "To access a struct in Helper, do I need to declare an alias on the import?  Otherwise, I get an error when trying to access a struct in Helper."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 40992, "user_id": 40106, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/164ca8ba426bdb10381290b9617d3ea7?s=128&d=identicon&r=PG&f=1", "display_name": "4thSpace", "link": "https://stackoverflow.com/users/40106/4thspace"}, "edited": false, "score": 0, "creation_date": 1445885459, "post_id": 33351436, "comment_id": 54502433, "body": "@4thSpace: You access identifiers in <code>Helper</code> just like you would any other package; <code>packagename.Identifer</code>. e.g. <code>fmt.Println</code> from the <code>fmt</code> package."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1445878925, "creation_date": 1445878925, "answer_id": 33351436, "question_id": 33351282, "link": "https://stackoverflow.com/questions/33351282/how-to-include-external-file-in-go/33351436#33351436", "title": "How to include external file in Go?", "body": "<p>You import packages by import path. For package <code>Helper</code>, located in <code>$GOPATH/src/Helper/</code>, use:</p>\n\n<pre><code>import \"Helper\"\n</code></pre>\n\n<p>While they can work in some cases, relative paths aren't supported by the go toolchain, and are discouraged. </p>\n"}], "owner": {"reputation": 40992, "user_id": 40106, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/164ca8ba426bdb10381290b9617d3ea7?s=128&d=identicon&r=PG&f=1", "display_name": "4thSpace", "link": "https://stackoverflow.com/users/40106/4thspace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1602, "favorite_count": 0, "accepted_answer_id": 33351436, "answer_count": 1, "score": -2, "last_activity_date": 1445878925, "creation_date": 1445878453, "question_id": 33351282, "link": "https://stackoverflow.com/questions/33351282/how-to-include-external-file-in-go", "title": "How to include external file in Go?", "body": "<p>I'm using LiteIDE for Go.  I have a Go file located here: </p>\n\n<pre><code>/Users/username/go/src/src/Helper/Helper.go\n</code></pre>\n\n<p>When I include the file using:</p>\n\n<blockquote>\n  <p>import \"../Helper\"</p>\n</blockquote>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>can't load package: /Users/username/go/src/src/projectA/main.go:4:8:\n  local import \"../Helper\" in non-local package</p>\n</blockquote>\n\n<p>Any ideas what I'm doing wrong?</p>\n"}, {"tags": ["windows", "go", "windows-services"], "comments": [{"owner": {"reputation": 660, "user_id": 1621659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ecfb1be8455d6711ca9fd2f4970f787?s=128&d=identicon&r=PG", "display_name": "Chris Becke", "link": "https://stackoverflow.com/users/1621659/chris-becke"}, "edited": false, "score": 0, "creation_date": 1445925468, "post_id": 33350024, "comment_id": 54517144, "body": "Services should pretty much NEVER use any of the SH* methods as they all, for the most part, assume an interactive user is available to answer prompts and such like."}], "answers": [{"comments": [{"owner": {"reputation": 122, "user_id": 1648324, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/deb556554b341644361a5d9fbcc73a81?s=128&d=identicon&r=PG", "display_name": "Vincent Rischmann", "link": "https://stackoverflow.com/users/1648324/vincent-rischmann"}, "edited": false, "score": 0, "creation_date": 1445973848, "post_id": 33350196, "comment_id": 54547398, "body": "yeah I was looking at this package which triggered this question. Thanks!"}], "tags": [], "owner": {"reputation": 1053, "user_id": 3608492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e469e0555fc5221b227deb0d9a305a?s=128&d=identicon&r=PG&f=1", "display_name": "Satyen Rai", "link": "https://stackoverflow.com/users/3608492/satyen-rai"}, "is_accepted": true, "score": 2, "last_activity_date": 1445875023, "creation_date": 1445875023, "answer_id": 33350196, "question_id": 33350024, "link": "https://stackoverflow.com/questions/33350024/whats-the-recommended-way-to-store-configuration-data-in-a-windows-service/33350196#33350196", "title": "What&#39;s the recommended way to store configuration data in a Windows service?", "body": "<p>You are almost always better off storing your configuration data in Registry. That is what a typical Windows admin would expect of a well behaved service. Windows ain't Unix. :-)</p>\n\n<p>You can use <a href=\"https://godoc.org/golang.org/x/sys/windows/registry\" rel=\"nofollow\">this</a> package to interact with the registry.</p>\n"}], "owner": {"reputation": 122, "user_id": 1648324, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/deb556554b341644361a5d9fbcc73a81?s=128&d=identicon&r=PG", "display_name": "Vincent Rischmann", "link": "https://stackoverflow.com/users/1648324/vincent-rischmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 33350196, "answer_count": 1, "score": 0, "last_activity_date": 1445875023, "creation_date": 1445874579, "question_id": 33350024, "link": "https://stackoverflow.com/questions/33350024/whats-the-recommended-way-to-store-configuration-data-in-a-windows-service", "title": "What&#39;s the recommended way to store configuration data in a Windows service?", "body": "<p>So, I have written a Windows service in Go using <a href=\"https://godoc.org/golang.org/x/sys/windows/svc\" rel=\"nofollow\">this API</a>.</p>\n\n<p>Everything is working well, but I am wondering what's the best way to store configuration data in a service.</p>\n\n<p>Usually, I use <a href=\"https://msdn.microsoft.com/fr-fr/library/windows/desktop/bb762188(v=vs.85).aspx\" rel=\"nofollow\">SHGetKnownFolderPath</a> to get to the AppData directory and create my app directory in there.</p>\n\n<p>However, in a service this gives me a path in C:/Windows/system32/config/userprofile, which is fine technically since I can do what I need in there, but I'm left wondering if maybe there's a preferred way to store configuration.</p>\n\n<p>Is it better to use the registry for this ? Or is there something else on Windows for this purpose ?</p>\n\n<p>What do Windows sysadmins expect from a service in this case ?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["arrays", "json", "go"], "answers": [{"tags": [], "owner": {"reputation": 4662, "user_id": 140377, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d421e9a5c4254129b7159ec2717da5ac?s=128&d=identicon&r=PG", "display_name": "Swoogan", "link": "https://stackoverflow.com/users/140377/swoogan"}, "is_accepted": false, "score": 2, "last_activity_date": 1445873914, "creation_date": 1445873914, "answer_id": 33349770, "question_id": 33349695, "link": "https://stackoverflow.com/questions/33349695/creating-json-array-in-go/33349770#33349770", "title": "Creating JSON array in Go", "body": "<p>You need to <code>import \"encoding/json\"</code> and then use <code>json.Marshal</code> with your structure. </p>\n\n<p><a href=\"https://golang.org/pkg/encoding/json/#example_Marshal\" rel=\"nofollow\">https://golang.org/pkg/encoding/json/#example_Marshal</a></p>\n"}, {"tags": [], "owner": {"reputation": 12672, "user_id": 1200821, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Cm117.jpg?s=128&g=1", "display_name": "Juan Diego Godoy Robles", "link": "https://stackoverflow.com/users/1200821/juan-diego-godoy-robles"}, "is_accepted": true, "score": 4, "last_activity_date": 1463686617, "last_edit_date": 1463686617, "creation_date": 1445875254, "answer_id": 33350267, "question_id": 33349695, "link": "https://stackoverflow.com/questions/33349695/creating-json-array-in-go/33350267#33350267", "title": "Creating JSON array in Go", "body": "<p>Quite <em>straightforward</em> as <strong>@swoogan</strong> comments:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype myJSON struct {\n    Array []string\n}\n\nfunc main() {\n    jsondat := &amp;myJSON{Array: []string{\"one\", \"two\", \"three\"}}\n    encjson, _ := json.Marshal(jsondat)\n    fmt.Println(string(encjson))\n}\n</code></pre>\n\n<p>Demo avaliable <a href=\"https://play.golang.org/p/PI21OMmdo1\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 2144, "user_id": 1143357, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8aebc0e3ebfeb4bebe9d20140d373a27?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1143357/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7354, "favorite_count": 0, "accepted_answer_id": 33350267, "answer_count": 2, "score": 2, "last_activity_date": 1463686617, "creation_date": 1445873731, "question_id": 33349695, "link": "https://stackoverflow.com/questions/33349695/creating-json-array-in-go", "title": "Creating JSON array in Go", "body": "<p>How do I construct and send a JSON array with Go?</p>\n\n<p>For example:</p>\n\n<pre><code>{ myArray: [\"one\", \"two\", \"three\"] }\n</code></pre>\n\n<p>At the moment the closest I can get it sending JSON down to the browser as a string like this:</p>\n\n<pre><code>{ myArrayString: '[\"once\", \"two\", \"three\"]' } \n</code></pre>\n\n<p>Which is not what I'm trying to achieve.</p>\n"}, {"tags": ["sockets", "go", "network-programming", "listener", "icmp"], "answers": [{"tags": [], "owner": {"reputation": 1053, "user_id": 3608492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e469e0555fc5221b227deb0d9a305a?s=128&d=identicon&r=PG&f=1", "display_name": "Satyen Rai", "link": "https://stackoverflow.com/users/3608492/satyen-rai"}, "is_accepted": true, "score": 8, "last_activity_date": 1445870280, "last_edit_date": 1445870280, "creation_date": 1445869695, "answer_id": 33348237, "question_id": 33345683, "link": "https://stackoverflow.com/questions/33345683/how-to-listen-for-icmp-packets/33348237#33348237", "title": "How to listen for ICMP packets?", "body": "<p><code>icmp.ListenPacket()</code> creates a <code>*icmp.PacketConn</code> - in other words a listener. You are creating listeners in an infinite loop! Since you are not even closing them, your program will start complaining about <code>too many open files</code> faster than you can say \"ping\".</p>\n\n<p>Here is an example of a working listener</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"golang.org/x/net/icmp\"\n    \"log\"\n)\n\nfunc main() {\n    conn, err := icmp.ListenPacket(\"ip4:icmp\", \"192.168.0.12\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    for {\n        var msg []byte\n        length, sourceIP, err := conn.ReadFrom(msg)\n        if err != nil {\n            log.Println(err)\n            continue\n        }\n\n        log.Printf(\"message = '%s', length = %d, source-ip = %s\", string(msg), length, sourceIP)\n    }\n    _ = conn.Close()\n}\n</code></pre>\n\n<p>This produces:</p>\n\n<pre><code>2015/10/26 10:35:00 message = '', length = 0, source-ip = 192.168.0.7\n2015/10/26 10:35:00 message = '', length = 0, source-ip = 192.168.0.25\n2015/10/26 10:35:01 message = '', length = 0, source-ip = 192.168.0.7\n2015/10/26 10:35:01 message = '', length = 0, source-ip = 192.168.0.25\n2015/10/26 10:35:02 message = '', length = 0, source-ip = 192.168.0.7\n2015/10/26 10:35:02 message = '', length = 0, source-ip = 192.168.0.25\n</code></pre>\n\n<p>I was pinging the host from 2 hosts simultaneously.</p>\n\n<p>You can choose to discard the incoming message and other return values if you want.</p>\n"}], "owner": {"reputation": 1117, "user_id": 1636883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f18625a3fce041f061d2e426c94bd7bd?s=128&d=identicon&r=PG", "display_name": "kkirsche", "link": "https://stackoverflow.com/users/1636883/kkirsche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2123, "favorite_count": 1, "accepted_answer_id": 33348237, "answer_count": 1, "score": 5, "last_activity_date": 1445870280, "creation_date": 1445862174, "last_edit_date": 1445870266, "question_id": 33345683, "link": "https://stackoverflow.com/questions/33345683/how-to-listen-for-icmp-packets", "title": "How to listen for ICMP packets?", "body": "<p>I'm working on a two part application where one side sends ICMP packets and the other side listens for the ICMP packets and takes action when it receives them. The problem is, I'm not sure how to keep the listener alive indefinitely (just want it sitting there in a loop only taking action when it receives a packet).</p>\n\n<p>Currently, I'm able to use the <a href=\"https://github.com/tatsushid/go-fastping\" rel=\"noreferrer\">go-fastping</a> library and can send and receive packets if it's a two way communication (I send it, they respond, I process the remote response). The question is how do I make this asymmetrical?</p>\n\n<p>My attempt at a listener was:</p>\n\n<pre><code>for {\n    conn, err := icmp.ListenPacket(\"ip4:icmp\", \"192.168.1.8\")\n    if err != nil {\n        fmt.Println(err)\n    }\n}\n</code></pre>\n\n<p>but this doesn't work. My logic here was that I want a <code>while true</code> loop to keep the listener alive (in this case that's the <code>for {</code>), then I listen for new packets with ICMP's <code>ListenPacket</code> but I don't seem to be getting anything using this approach. </p>\n\n<p>Any ideas or help would be greatly appreciated. Thanks in advance for your time and assistance.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1445850021, "post_id": 33341726, "comment_id": 54479356, "body": "Do you have a working 1.4 install? 1.5 is compiled with go, so you need 1.4 to compile 1.5."}, {"owner": {"reputation": 1945, "user_id": 1202194, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/MHJgz.jpg?s=128&g=1", "display_name": "Aydar Omurbekov", "link": "https://stackoverflow.com/users/1202194/aydar-omurbekov"}, "reply_to_user": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1445850596, "post_id": 33341726, "comment_id": 54479683, "body": "@mrd0ll4r installed 1.4, same error"}, {"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1445851047, "post_id": 33341726, "comment_id": 54479931, "body": "And I guess you <code>gvm use</code> that go1.4 too? There are mutiple issues about this on github, for example <a href=\"https://github.com/moovweb/gvm/issues/166\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://github.com/moovweb/gvm/issues/160\" rel=\"nofollow noreferrer\">this</a>, so that&#39;s where I got the idea... Anyways, you could still install the binaries with the <code>-B</code> flag, i guess?"}, {"owner": {"reputation": 1945, "user_id": 1202194, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/MHJgz.jpg?s=128&g=1", "display_name": "Aydar Omurbekov", "link": "https://stackoverflow.com/users/1202194/aydar-omurbekov"}, "reply_to_user": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1445851796, "post_id": 33341726, "comment_id": 54480380, "body": "Yep, thank you much anyway!"}, {"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1445852401, "post_id": 33341726, "comment_id": 54480692, "body": "Oh, another idea: What about <code>gvm install go1.5.1</code> ?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1445853544, "post_id": 33341726, "comment_id": 54481364, "body": "Although not a direct solution, <a href=\"https://github.com/travis-ci/gimme\" rel=\"nofollow noreferrer\">github.com/travis-ci/gimme</a> may be an alternative tool to gvm."}], "answers": [{"comments": [{"owner": {"reputation": 1629, "user_id": 998919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/947cfda8c228b7ca9b72764e93d2600e?s=128&d=identicon&r=PG", "display_name": "fgblomqvist", "link": "https://stackoverflow.com/users/998919/fgblomqvist"}, "edited": false, "score": 0, "creation_date": 1470396922, "post_id": 33362319, "comment_id": 64946614, "body": "I&#39;m not sure what implode does, but I did not need to run that first. Neither did I have to reinstall gvm, just run the above commands (except for implode)."}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "reply_to_user": {"reputation": 1629, "user_id": 998919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/947cfda8c228b7ca9b72764e93d2600e?s=128&d=identicon&r=PG", "display_name": "fgblomqvist", "link": "https://stackoverflow.com/users/998919/fgblomqvist"}, "edited": false, "score": 0, "creation_date": 1510936112, "post_id": 33362319, "comment_id": 81662755, "body": "@fgblomqvist implode removes gvm."}], "tags": [], "owner": {"reputation": 1945, "user_id": 1202194, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/MHJgz.jpg?s=128&g=1", "display_name": "Aydar Omurbekov", "link": "https://stackoverflow.com/users/1202194/aydar-omurbekov"}, "is_accepted": true, "score": 1, "last_activity_date": 1445931804, "creation_date": 1445931804, "answer_id": 33362319, "question_id": 33341726, "link": "https://stackoverflow.com/questions/33341726/error-unrecognized-go-version/33362319#33362319", "title": "ERROR: Unrecognized Go version", "body": "<p>Installed successfully after reinstalling gvm  </p>\n\n<pre><code>gvm implode\ngvm install go1.4\ngvm use go1.4\ngvm install go1.5\n</code></pre>\n"}], "owner": {"reputation": 1945, "user_id": 1202194, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/MHJgz.jpg?s=128&g=1", "display_name": "Aydar Omurbekov", "link": "https://stackoverflow.com/users/1202194/aydar-omurbekov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1127, "favorite_count": 0, "accepted_answer_id": 33362319, "answer_count": 1, "score": 1, "last_activity_date": 1445931804, "creation_date": 1445849552, "question_id": 33341726, "link": "https://stackoverflow.com/questions/33341726/error-unrecognized-go-version", "title": "ERROR: Unrecognized Go version", "body": "<p>I am installing go1.5 with gvm v1.0.22\nand getting the following error:</p>\n\n<pre><code>gvm install go1.5\nUpdating Go source...\nERROR: Unrecognized Go version\n</code></pre>\n"}, {"tags": ["go", "session-cookies"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 5239706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3fd18c4ea2522fc605c41be0dc7ed8e?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5239706/sohail-shaikh"}, "edited": false, "score": 1, "creation_date": 1445847904, "post_id": 33341024, "comment_id": 54478287, "body": "thanks elithrar for your detailed answer. +1 for it. is it good to use <code>Cookie</code>? By encoding (encrypting) cookie data."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 155, "user_id": 5239706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3fd18c4ea2522fc605c41be0dc7ed8e?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5239706/sohail-shaikh"}, "edited": false, "score": 0, "creation_date": 1445850753, "post_id": 33341024, "comment_id": 54479784, "body": "Signed cookies are safe from modification by a (bad) user, and gorilla/sessions provides this by default. You can optionally encrypt them, which will then prevent them from being <i>read</i>, but if you are serving your site over HTTPS (you should be) then it&#39;s not entirely necessary."}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 4, "last_activity_date": 1445852971, "last_edit_date": 1495539919, "creation_date": 1445846578, "answer_id": 33341024, "question_id": 33339986, "link": "https://stackoverflow.com/questions/33339986/how-to-pass-multiple-values-in-cookie-with-map/33341024#33341024", "title": "How to pass multiple values in cookie with map", "body": "<ul>\n<li><p><code>var retMap = make(map[string]string)</code> is a global map that you both read and write to, which is unsafe: when you have more than one user concurrently you will be overwriting the contents of this map.</p></li>\n<li><p>You aren't using the securecookie package to encode your cookie values at all - in fact it's not clear where you're using it at all.</p>\n\n<pre><code>cookie := http.Cookie{\n    Name:    \"session\",\n    // This should be encoded.\n    Value:   sessionData[\"userName\"], //Here i want map or something else that can accept multiple values\n    Expires: expiration,\n    //MaxAge: 3600,\n}\n</code></pre></li>\n<li><p>Too many packages: you have a <code>loginpackage</code>, a <code>sessionpackage</code> and a <code>package main</code>. Packages should fulfil a 'theme' - an <code>auth</code> package might make more sense, or even just a single <code>package main</code> until you get more familiar with Go.</p></li>\n<li><p>You're not hashing your passwords - storing the plain text password in the database and looking it up with the value of <code>r.FormValue(\"password\")</code> is extremely insecure. Read this to see how to hash passwords safely in Go: <a href=\"https://stackoverflow.com/questions/18545676/golang-app-engine-securely-hashing-a-users-password\">Golang/App Engine - securely hashing a user&#39;s password</a></p></li>\n<li><p>You should be using the <a href=\"http://www.gorillatoolkit.org/pkg/sessions\" rel=\"nofollow noreferrer\">gorilla/sessions</a> package rather than the lower-level securecookie package.</p></li>\n</ul>\n\n<p>Modifying the gorilla/sessions example in the documentation:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"github.com/gorilla/sessions\"\n)\n\n// Use the CookieStore\nvar store = sessions.NewCookieStore([]byte(\"something-very-secret\"))\n\nfunc LoginOperation(w http.ResponseWriter, r *http.Request) {\n    // Your existing DB code - shorter to make the example here clearer\n    err := db.QueryRow(\"SELECT lvl_flag FROM admin_instance WHERE user_name = ? AND passwd = ?\", r.FormValue(\"username\"), r.FormValue(\"password\")).Scan(&amp;lvl)\n\n    // Don't use a global map - create a new one\n    userDetails := make(map[string]string)\n    userDetails[\"msg\"] = \"Login successfully\"\n    userDetails[\"err\"] = \"Not Login\"\n    userDetails[\"lvl\"] = lvl\n    userDetails[\"fullName\"] = uFullName\n\n    // Get a session (existing/new)\n    session, err := store.Get(r, \"session-name\")\n    if err != nil {\n        http.Error(w, err.Error(), 500)\n        return\n    }\n\n    // Set some session values.\n    session.Values[\"userDetails\"] = userDetails\n    // Save it before we write to the response/return from the handler.\n    session.Save(r, w)\n}\n</code></pre>\n\n<p>Later, if you want to retrieve the details:</p>\n\n<pre><code>func RequireAuth(w http.ResponseWriter, r *http.Request) {\n    // Get a session (existing/new)\n    session, err := store.Get(r, \"session-name\")\n    if err != nil {\n        http.Error(w, err.Error(), 500)\n        return\n    }\n\n    // Type assert our userDetails map out of the session's map[string]interface{}\n    userDetails, ok := session.Values[\"userDetails\"].(map[string]string)\n    if !ok {\n        // User does not have an existing session - treat them as not logged in and/or re-direct them to your login page.\n        http.Error(w, http.StatusCode(401), 401)\n        return\n    }\n\n\n    // Check the user details - e.g. if userDetails[\"lvl\"] == \"ACTIVE\" { ... }\n    // TODO\n    }\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 5239706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3fd18c4ea2522fc605c41be0dc7ed8e?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5239706/sohail-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1660, "favorite_count": 0, "accepted_answer_id": 33341024, "answer_count": 1, "score": 0, "last_activity_date": 1458179526, "creation_date": 1445842422, "last_edit_date": 1458179526, "question_id": 33339986, "link": "https://stackoverflow.com/questions/33339986/how-to-pass-multiple-values-in-cookie-with-map", "title": "How to pass multiple values in cookie with map", "body": "<p>Got stuck while passing multiple values in cookie. I'm not able to find a better way for managing session and cookies. Trying to use <code>github.com/gorilla/securecookie</code> this package. </p>\n\n<h3>loginMain.go</h3>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"log\"\n    \"net/http\"\n    \"shambhavi/packages/loginPkg\"   \n    _ \"github.com/go-sql-driver/mysql\"\n    \"github.com/gorilla/mux\"\n)\n\nvar router = mux.NewRouter()\nvar db *sql.DB\n\nfunc connectDb() *sql.DB {\n    db, dberr := sql.Open(\"mysql\", \"root:root@tcp(127.0.0.1:8889)/shambhavi_db\")\n    if dberr != nil {\n        log.Println(dberr)\n    }\n    return db\n}\nfunc login(w http.ResponseWriter, r *http.Request) {\n    var db *sql.DB = connectDb()\n    loginPkg.LoginOperation(w, r, db)\n\n}\n\nfunc main() {\n    http.HandleFunc(\"/demo\", login)\n    http.Handle(\"/\", router)\n    err := http.ListenAndServe(port, nil) // setting listening port\nif err != nil {\n    log.Fatal(\"ListenAndServe: \", err)\n}\n}  \n</code></pre>\n\n<h3>LoginPkg.go</h3>\n\n<pre><code>package loginPkg\n\nimport (\n    \"database/sql\"\n    \"encoding/json\"\n    \"fmt\"\n    \"net/http\"\n    \"shambhavi/packages/sessionPkg\"\n\n    _ \"github.com/go-sql-driver/mysql\"\n)\n\nvar retMap = make(map[string]string)\n\nfunc ErrorHandler(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n\nfunc LoginOperation(w http.ResponseWriter, r *http.Request, db *sql.DB) {\n    fmt.Println(\"In LoginOperation \")\n    r.ParseForm()\n    if len(r.Form[\"username\"][0]) == 0 &amp;&amp; len(r.Form[\"password\"][0]) == 0 {\n        fmt.Fprintf(w, \"Something is blank !!!\")\n    } else {\n        var lvl string\n        var uFullName string\n        err := db.QueryRow(\"SELECT lvl_flag FROM admin_instance WHERE user_name = ? AND passwd = ?\", r.FormValue(\"username\"), r.FormValue(\"password\")).Scan(&amp;lvl)\n\n        er := db.QueryRow(\"SELECT emp_name FROM emp_detail WHERE emp_uname = ?\", r.FormValue(\"username\")).Scan(&amp;uFullName)\n        ErrorHandler(er)\n        retMap[\"msg\"] = \"Login successfully\"\n        retMap[\"err\"] = \"Not Login\"\n        retMap[\"lvl\"] = lvl\n        retMap[\"fullName\"] = uFullName\n        b, _ := json.Marshal(retMap)\n        if err != nil {\n            fmt.Println(err)\n            fmt.Fprintf(w, \"%s\", b)\n\n        } else {\n            if lvl == \"1\" || lvl == \"2\" || lvl == \"3\" {\n                sessionPkg.SetSession(w, r, r.FormValue(\"username\"), retMap) // Passing map to the fun, retMap\n                fmt.Fprintf(w, \"%s\", b)\n                usrnm := sessionPkg.GetUserName(r)\n                fmt.Println(\"From session variable\", usrnm)\n            } else {\n                fmt.Println(\"Chukala ....\")\n                fmt.Fprintf(w, \"%s\", b)\n            }   \n        }\n    }\n    defer db.Close()\n}\n</code></pre>\n\n<p>The problem lies in following file....</p>\n\n<h3>sessionHandler.go</h3>\n\n<pre><code>package sessionPkg\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"time\"\n\n    \"github.com/gorilla/securecookie\"\n)\n\nvar cookieHandler = securecookie.New(\n    securecookie.GenerateRandomKey(64),\n    securecookie.GenerateRandomKey(32))\n\n\nfunc SetSession(w http.ResponseWriter, r *http.Request, username string, retMap map[string]string) {\n\n    sessionData := map[string]string{\n        \"userName\": username,\n        \"lvl\":      retMap[\"lvl\"],\n        \"fullName\": retMap[\"fullName\"],\n    }\n\n    expiration := time.Now().Add(365 * 24 * time.Hour)\n\n    //if encoded, err := cookieHandler.Encode(\"session\", sessionData); err == nil {\n    cookie := http.Cookie{\n        Name:    \"session\",\n        Value:   sessionData[\"userName\"], //Here i want map or something else that can accept multiple values\n        Expires: expiration,\n        //MaxAge: 3600,\n    }\n\n    http.SetCookie(w, &amp;cookie)\n    //}\n}\n\nfunc GetUserName(request *http.Request) (userName string) {\n    //fmt.Println(request.Cookie(\"session\"))\n    cookieValue := make(map[string]string)\n    if cookie, err := request.Cookie(\"session\"); err == nil {\n\n        fmt.Println(\"cookieValue = \", cookie.Value)\n        //if err = cookieHandler.Decode(\"session\", cookie.Value, &amp;cookieValue); err == nil {\n        //fmt.Println(cookie)\n        cookieValue[\"userName\"] = cookie.Value\n        //fmt.Println(cookieValue[\"userName\"])\n        //}\n        /*else {\n            fmt.Println(\"Error \", err)\n        }*/\n    }\n    return cookieValue[\"userName\"]\n}\n\n/*func GetFullName(request *http.Request) (fullName string) {\n    fmt.Println(\"In GetFullName\")\n    cookieValue := make(map[string]string)\n    if cookie2, err := request.Cookie(\"session\"); err == nil {\n\n        fmt.Println(\"cookieValue = \", cookie2.Value)\n        //if err = cookieHandler.Decode(\"session\", cookie.Value, &amp;cookieValue); err == nil {\n        fmt.Println(cookie2)\n        cookieValue[\"fullName\"] = cookie2.Value\n        fmt.Println(cookieValue[\"fullName\"])\n        //}\n    }\n    return cookieValue[\"fullName\"]\n}*/\n\nfunc ClearSession(response http.ResponseWriter) {\n    cookie := &amp;http.Cookie{\n        Name:   \"session\",\n        Value:  \"\",\n        Path:   \"/\",\n        MaxAge: -1,\n    }\n    http.SetCookie(response, cookie)\n}\n</code></pre>\n\n<p>Problem indicated in code by comment. I want to use session like in PHP. Suggest the better way to secure the cookie and maintain the session. Give some explanation too.  </p>\n\n<p>Edited: Explain <code>cookieHandler.Encode()</code> and <code>cookieHandler.Decode()</code>. It is not decoding the data which is passed to it.</p>\n"}, {"tags": ["windows", "go"], "comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 4, "creation_date": 1445837397, "post_id": 33337943, "comment_id": 54474228, "body": "Go tools do not use Windows built in command <code>cd</code>. So everything should work as expected. Why not give it a try and see yourself?"}], "answers": [{"tags": [], "owner": {"reputation": 1286, "user_id": 1071090, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vdLa6.jpg?s=128&g=1", "display_name": "Peter Hommel", "link": "https://stackoverflow.com/users/1071090/peter-hommel"}, "is_accepted": true, "score": 2, "last_activity_date": 1445844006, "creation_date": 1445844006, "answer_id": 33340379, "question_id": 33337943, "link": "https://stackoverflow.com/questions/33337943/putting-gopath-or-any-environment-variable-on-a-separate-drive-in-windows/33340379#33340379", "title": "Putting GOPATH (or any environment variable) on a separate drive in Windows", "body": "<p>This behavior on the command line is solely cd's fault. If you would write out the whole gopath string, you would get exactly the same behaviour. As go does (have to) make the drive/folder distinction on it's own while processing the path, everything will work just fine.</p>\n"}], "owner": {"reputation": 431, "user_id": 3271700, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c9d6e80a762e962de924bd6f1efc3ee0?s=128&d=identicon&r=PG&f=1", "display_name": "errolflynn", "link": "https://stackoverflow.com/users/3271700/errolflynn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 33340379, "answer_count": 1, "score": 0, "last_activity_date": 1445860936, "creation_date": 1445829222, "question_id": 33337943, "link": "https://stackoverflow.com/questions/33337943/putting-gopath-or-any-environment-variable-on-a-separate-drive-in-windows", "title": "Putting GOPATH (or any environment variable) on a separate drive in Windows", "body": "<p>I have a drive that I use for non-executable stuff, and I set <code>%GOPATH%</code> to point to a directory on that drive (<code>D:\\go\\path</code>). However, I can't simply type </p>\n\n<pre><code>cd %GOPATH% \n</code></pre>\n\n<p>from the C:\\ drive and navigate there. I need to type </p>\n\n<pre><code>cd /c d:\\go\\path \n</code></pre>\n\n<p>Will the go linker/compiler/assembler/other stuff still function the same way?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 4821, "user_id": 3751, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/066de1134a7eabd47d45c9355d2d4975?s=128&d=identicon&r=PG", "display_name": "Ovesh", "link": "https://stackoverflow.com/users/3751/ovesh"}, "edited": false, "score": 0, "creation_date": 1445831436, "post_id": 33338090, "comment_id": 54472882, "body": "oh right. So methods &quot;defined on&quot; a non-pointer receiver are just like global methods that get passed that receiver by value as an extra argument. (come to think of it, if the receiver is a pointer, the pointer is passed by value). Correct?"}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 0, "creation_date": 1445848741, "post_id": 33338090, "comment_id": 54478703, "body": "And you don&#39;t need to use a pointer receiver for your GetMember method. Using a value receiver means a caller has (some) guarantees that you will not modify the contents."}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "reply_to_user": {"reputation": 4821, "user_id": 3751, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/066de1134a7eabd47d45c9355d2d4975?s=128&d=identicon&r=PG", "display_name": "Ovesh", "link": "https://stackoverflow.com/users/3751/ovesh"}, "edited": false, "score": 0, "creation_date": 1445909131, "post_id": 33338090, "comment_id": 54512673, "body": "@Ovesh, I am not familiar with term <code>global methods</code>, do you means just a regular function? If so then, yes, methods defined or a struct at similar to functions where a struct is passed as an argument. This not only for non-pointer receiver.  A struct can be passed by value or it can be passed by a pointer. You could have  a function <code>set_member(h *Holder, new_i int)</code> which would change the field  <code>i</code> in the object <code>Holder</code>."}], "tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": true, "score": 2, "last_activity_date": 1445831047, "last_edit_date": 1445831047, "creation_date": 1445830579, "answer_id": 33338090, "question_id": 33337914, "link": "https://stackoverflow.com/questions/33337914/why-is-the-struct-field-value-forgotten/33338090#33338090", "title": "Why is the struct field value forgotten", "body": "<p>In the second example you passing the struct object itself, you are a pointer receiver. You see the change because you have actually modified the original object. In the first example you are passing the copy of the object that contains the same values, you are using a value receiver. You don't see the change because your original object was not changed.</p>\n\n<p>To convince yourself, you can print the addresses of the objects inside <code>main</code> and your <code>SetMember</code> method.</p>\n\n<p>When using pointer receiver:</p>\n\n<p>In main:</p>\n\n<pre><code>fmt.Printf(\"address in main: %p\\n\", c)\n</code></pre>\n\n<p>In <code>SetMember</code> (should be the same as in main):</p>\n\n<pre><code>fmt.Printf(\"address in SetMember: %p\\n\", h)\n</code></pre>\n\n<p>When using value receiver:</p>\n\n<p>In main: </p>\n\n<pre><code>fmt.Printf(\"address in main: %p\\n\", &amp;c)\n</code></pre>\n\n<p>In <code>SetMember</code> (should be different from what is in main) :</p>\n\n<pre><code>fmt.Printf(\"address in SetMember: %p\\n\", &amp;h)\n</code></pre>\n"}], "owner": {"reputation": 4821, "user_id": 3751, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/066de1134a7eabd47d45c9355d2d4975?s=128&d=identicon&r=PG", "display_name": "Ovesh", "link": "https://stackoverflow.com/users/3751/ovesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 33338090, "answer_count": 1, "score": 0, "last_activity_date": 1445831047, "creation_date": 1445829032, "question_id": 33337914, "link": "https://stackoverflow.com/questions/33337914/why-is-the-struct-field-value-forgotten", "title": "Why is the struct field value forgotten", "body": "<p><a href=\"http://play.golang.org/p/wU44VOa_uP\" rel=\"nofollow\">http://play.golang.org/p/wU44VOa_uP</a></p>\n\n<p>Here's a simple example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Holder struct {\n    i int\n}\n\nfunc (h Holder) SetMember(i1 int) {\n    fmt.Println(i1)\n    h.i = i1\n}\n\nfunc (h Holder) GetMember() int {\n    fmt.Println(h.i)\n    return h.i\n}\n\nfunc main() {\n    c := Holder{i:3}\n    c.SetMember(5)\n    c.GetMember()\n}\n</code></pre>\n\n<p>I'm probably missing a very basic truth about golang.\nWhy doesn't the value 5 stick after setting it?</p>\n\n<p>This example works:\n<a href=\"http://play.golang.org/p/j8hdKWPdsc\" rel=\"nofollow\">http://play.golang.org/p/j8hdKWPdsc</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Holder struct {\n    i int\n}\n\nfunc (h *Holder) SetMember(i1 int) {\n    fmt.Println(i1)\n    h.i = i1\n}\n\nfunc (h *Holder) GetMember() int {\n    fmt.Println(h.i)\n    return h.i\n}\n\nfunc main() {\n    c := &amp;Holder{i:3}\n    c.SetMember(5)\n    c.GetMember()\n}\n</code></pre>\n"}, {"tags": ["go", "docker"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 1, "creation_date": 1446014947, "post_id": 33337457, "comment_id": 54562056, "body": "Why not just compile statically linked binaries for the apps that you need, and put them in your containers? Go binaries are usually not that big that you need to be worried about excessive disk usage. One of the great things about Go is it allows you to build self-contained, statically linked binaries, and one of the great things about Docker is it allows you to build self-contained, isolated... well... containers. You&#39;d have to have a pretty compelling reason to circumvent these two nice features in the interest of saving a bit of disk space."}, {"owner": {"reputation": 95, "user_id": 2058478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe504bbfb1baa1c1491f42de7aa30f4?s=128&d=identicon&r=PG", "display_name": "Phil", "link": "https://stackoverflow.com/users/2058478/phil"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1446079201, "post_id": 33337457, "comment_id": 54599563, "body": "I&#39;m not trying to save disk space.  I trying to reduce memory consumption by loading my Go shared libraries into a memory region that will be shared by all containers.  I want the isolation that Docker provides but with less memory use.  Think thousands of containers."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1445839637, "creation_date": 1445839637, "answer_id": 33339414, "question_id": 33337457, "link": "https://stackoverflow.com/questions/33337457/go-shared-libraries-for-docker-containers-to-share/33339414#33339414", "title": "Go shared libraries for Docker containers to share", "body": "<p>The image size is less about memory and more about disk space.</p>\n\n<p>You could set those shared dynamic library in an image of their own, with a shared VOLUME path.</p>\n\n<p>You then docker create a container based on that image: that is a <a href=\"https://docs.docker.com/userguide/dockervolumes/#creating-and-mounting-a-data-volume-container\" rel=\"nofollow\">data volume container</a>.</p>\n\n<p>Finally, you reuse that created container as many time as you want, with a <a href=\"https://docs.docker.com/reference/run/#volume-shared-filesystems\" rel=\"nofollow\"><code>--volumes-from=&lt;yourCreatedContainer&gt;</code></a> for each go app <code>docker run</code> containers.</p>\n"}], "owner": {"reputation": 95, "user_id": 2058478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe504bbfb1baa1c1491f42de7aa30f4?s=128&d=identicon&r=PG", "display_name": "Phil", "link": "https://stackoverflow.com/users/2058478/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 968, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1446012238, "creation_date": 1445825573, "last_edit_date": 1446012238, "question_id": 33337457, "link": "https://stackoverflow.com/questions/33337457/go-shared-libraries-for-docker-containers-to-share", "title": "Go shared libraries for Docker containers to share", "body": "<p>In Docker is there a way to put Go shared libraries that are needed by containerized go apps in a read only shared memory area? The objective is to allow many containers to the execute the same code reducing memory requirements in the containers. I expect a side effect would be smaller container images.</p>\n\n<p>Where would these Go shared libraries be in memory?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 2, "creation_date": 1445826710, "post_id": 33337403, "comment_id": 54471797, "body": "&quot;Why is this useful?&quot; feels like too broad of a question."}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 1, "creation_date": 1445826793, "post_id": 33337403, "comment_id": 54471821, "body": "<a href=\"https://golang.org/ref/spec#Variables\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Variables</a>: &quot;The static type (or just type) of a variable is the type given in its declaration, the type provided in the new call or composite literal, or the type of an element of a structured variable. Variables of interface type also have a distinct dynamic type, which is the concrete type of the value assigned to the variable at run time (unless the value is the predeclared identifier nil, which has no type). The dynamic type may vary during execution but values stored in interface variables are always assignable to the static type of the variable.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1445860157, "post_id": 33341764, "comment_id": 54485482, "body": "This does not explain what &quot;dynamic type&quot; means."}, {"owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "reply_to_user": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1445860454, "post_id": 33341764, "comment_id": 54485676, "body": "@Elyse Because that is not what he asked. &quot;What is an example of this, and why this is useful?&quot;"}, {"owner": {"reputation": 9619, "user_id": 534617, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7cd10a43f8fab06f82c32ace961f9fa0?s=128&d=identicon&r=PG", "display_name": "Qiang Li", "link": "https://stackoverflow.com/users/534617/qiang-li"}, "edited": false, "score": 0, "creation_date": 1445873746, "post_id": 33341764, "comment_id": 54494679, "body": "How is it related to &quot;An interface type can contain a reference to an instance of any of the types that implement the interface&quot;? Can you give specific references to these &quot;reference&quot;/&quot;type&quot;/&quot;instance&quot;?"}, {"owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "reply_to_user": {"reputation": 9619, "user_id": 534617, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7cd10a43f8fab06f82c32ace961f9fa0?s=128&d=identicon&r=PG", "display_name": "Qiang Li", "link": "https://stackoverflow.com/users/534617/qiang-li"}, "edited": false, "score": 0, "creation_date": 1445876055, "post_id": 33341764, "comment_id": 54496343, "body": "@QiangLi The interface type is Locker in the example above. The type that implement the interface is Foo. So it means that a variable of type Locker can contain a reference to any kind of types that comply with the Locker contract (e.g. Foo)."}, {"owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "edited": false, "score": 0, "creation_date": 1445876561, "post_id": 33341764, "comment_id": 54496675, "body": "Re: &quot;having dynamic type instead of explicit interface declaration&quot;: You&#39;ve misunderstood the term &quot;dynamic type&quot;. (It doesn&#39;t mean what you think it does.)"}, {"owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "reply_to_user": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "edited": false, "score": 0, "creation_date": 1445876861, "post_id": 33341764, "comment_id": 54496859, "body": "@ruakh You&#39;re right. I misread that bit. I fixed the post. Does it sound better to you now?"}, {"owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "edited": false, "score": 0, "creation_date": 1445881706, "post_id": 33341764, "comment_id": 54500172, "body": "@basgys: Thanks. The thing is, the title of the question is &quot;What does &#39;dynamic type&#39; mean in a Go interface?&quot;. So while I take your point that the body of the question doesn&#39;t explicitly ask what that term means, I do think you need to address it."}, {"owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "reply_to_user": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "edited": false, "score": 0, "creation_date": 1445934957, "post_id": 33341764, "comment_id": 54521261, "body": "@ruakh Fair point. I updated the answer to give a definition."}], "tags": [], "owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "is_accepted": false, "score": 3, "last_activity_date": 1445934858, "last_edit_date": 1491982281, "creation_date": 1445849665, "answer_id": 33341764, "question_id": 33337403, "link": "https://stackoverflow.com/questions/33337403/what-does-dynamic-type-mean-in-a-go-interface/33341764#33341764", "title": "What does &quot;dynamic type&quot; mean in a Go interface?", "body": "<p><strong>Definition</strong></p>\n\n<blockquote>\n  <p>An interface has what is called a dynamic type</p>\n</blockquote>\n\n<p>A dynamic type means that it can hold a reference to different types (e.g. string, int, ...) and that it can change at runtime, whereas a static type is checked at compile time and cannot change.</p>\n\n<p>However, the definition given by the book is questioned. According to the official Golang website :</p>\n\n<blockquote>\n  <p>Some people say that Go's interfaces are dynamically typed, but that is misleading. They are statically typed: a variable of interface type always has the same static type, and even though at run time the value stored in the interface variable may change type, that value will always satisfy the interface.</p>\n</blockquote>\n\n<p><a href=\"http://blog.golang.org/laws-of-reflection\" rel=\"nofollow noreferrer\">Source</a></p>\n\n<p><strong>Example</strong></p>\n\n<p>Even though an interface is not truly a dynamic type, here is how to use them.</p>\n\n<p>Say you have the following interface.</p>\n\n<pre><code>type Locker interface {\n  Lock()\n  Unlock()\n}\n</code></pre>\n\n<p><em>That's actually the <code>Locker</code> from <code>sync</code> package.</em></p>\n\n<p>Now if you create two structs that implement the functions defined by the Locker interface. In other words, if you fulfil the <code>Locker</code> contract you will be able to use the structs <code>Foo</code> and <code>Bar</code> as a <code>Locker</code> interface. </p>\n\n<pre><code>type Foo struct {\n  A string\n}\n\nfunc (f *Foo) String() string {\n  return f.A\n}\n\nfunc (f *Foo) Lock() {\n  // ...\n}\n\nfunc (f *Foo) Unlock() {\n  // ...\n}\n\ntype Bar struct {}\n\nfunc (b *Bar) Lock() {\n  // ...\n}\n\nfunc (b *Bar) Unlock() {\n  // ...\n}\n</code></pre>\n\n<p>So given the definition you gave :</p>\n\n<blockquote>\n  <p>An interface type can contain a reference to an instance of any of the types that implement the interface (an interface has what is called a dynamic type)</p>\n</blockquote>\n\n<p>It could be translated into :</p>\n\n<blockquote>\n  <p>A Locker (interface) type can contain a reference to an instance of any of the types that implement its contract (e.g. Foo, Bar, ...).</p>\n</blockquote>\n\n<p>Which in code means :</p>\n\n<pre><code>var lock Locker\n\nlock = &amp;Foo{\"Foo\"} // We assign an instance of type Foo to a Locker var\nlock.Lock() // We can call all functions defined by the interface Locker\nlock.Unlock()\nlock.String() // This won't work because the Locker interface does not define the String() function, even though Foo implements it. \n\nlock = &amp;Bar{}\nlock.Lock()\n</code></pre>\n\n<p>In the example above we can see that the variable <code>lock</code> holds a reference to different types, but it is not truly dynamic because the condition to assign a type to <code>lock</code> is that its type comply with the <code>Locker</code> contract. And that part is defined at compile time.</p>\n\n<p><strong>Why is it useful?</strong></p>\n\n<p>This post will explain why interfaces are useful better than me. <a href=\"https://softwareengineering.stackexchange.com/questions/108240/why-are-interfaces-useful\">https://softwareengineering.stackexchange.com/questions/108240/why-are-interfaces-useful</a></p>\n"}, {"comments": [{"owner": {"reputation": 9619, "user_id": 534617, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7cd10a43f8fab06f82c32ace961f9fa0?s=128&d=identicon&r=PG", "display_name": "Qiang Li", "link": "https://stackoverflow.com/users/534617/qiang-li"}, "edited": false, "score": 0, "creation_date": 1445873754, "post_id": 33345080, "comment_id": 54494689, "body": "How is it related to &quot;An interface type can contain a reference to an instance of any of the types that implement the interface&quot;? Can you give specific references to these &quot;reference&quot;/&quot;type&quot;/&quot;instance&quot;?"}, {"owner": {"reputation": 1239, "user_id": 856769, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/691ecfb55a585a28ed57916b7cd1bd46?s=128&d=identicon&r=PG", "display_name": "nfirvine", "link": "https://stackoverflow.com/users/856769/nfirvine"}, "edited": false, "score": 0, "creation_date": 1454370075, "post_id": 33345080, "comment_id": 58005349, "body": "I think the author&#39;s wording is poor. It might be more clear as: &quot;An instance of an interface type <b>is</b> a reference to an instance of any of the types that satisfy the interface.&quot; I.e., the variable <code>x</code> declared with static type <code>I</code> can be assigned any type that satisfies interface <code>I</code>; when it is assigned to, it now has a dynamic type of whatever the type of the value is."}], "tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": false, "score": 9, "last_activity_date": 1445860547, "last_edit_date": 1445860547, "creation_date": 1445860245, "answer_id": 33345080, "question_id": 33337403, "link": "https://stackoverflow.com/questions/33337403/what-does-dynamic-type-mean-in-a-go-interface/33345080#33345080", "title": "What does &quot;dynamic type&quot; mean in a Go interface?", "body": "<p>Say you have an interface:</p>\n\n<pre><code>type I interface{ F() }\n</code></pre>\n\n<p>And two implementations of said interface:</p>\n\n<pre><code>type S struct{}\nfunc (S) F() { }\n\ntype T struct{}\nfunc (T) F() { }\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>var x I\nx = S{}\n</code></pre>\n\n<p>Now the static type of <code>x</code> is <code>I</code>, and its dynamic type is <code>S</code>.</p>\n\n<p>You can reassign <code>x</code> a value of a different type that implements <code>I</code>:</p>\n\n<pre><code>x = T{}\n</code></pre>\n\n<p>Now the static type of <code>x</code> is still <code>I</code> (it will never change), and its dynamic type is <code>T</code>.</p>\n\n<p>IOW: the dynamic type of an interface value is the type of the value that was originally converted to an interface type.</p>\n"}, {"tags": [], "owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "is_accepted": false, "score": 0, "last_activity_date": 1445920139, "last_edit_date": 1445920139, "creation_date": 1445919809, "answer_id": 33359940, "question_id": 33337403, "link": "https://stackoverflow.com/questions/33337403/what-does-dynamic-type-mean-in-a-go-interface/33359940#33359940", "title": "What does &quot;dynamic type&quot; mean in a Go interface?", "body": "<p>Every variable has a type. That type is either an a static type (int, string, bool, map, struct, slice, etc) or an interface type.</p>\n\n<p>An interface can be implemented by any static type (typically by an aliased type).</p>\n\n<p>A variable of an interface type is actually stored in two parts. The first part is the symbolic name of the underlying static type. The second part is the data in the format of that static type.</p>\n\n<p>So if a variable is declared to be of an interface type, that means that its type is dynamic in the sense that the underlying type could end up being any of the static types that implement the interface.</p>\n\n<p>Typically the usefulness of this pattern is to define an extended behavior of a class of types from some shared behaviour. Doing this you gain the ability to encapsulate the functionality that you care about in any particular case, rather than worrying about the specifics of a given type. For example, any Reader can be Read from, and once you've decided that you have a reader you don't need to worry about all the other methods that underlying type might have, meaning that you can easily define a single function that uses <em>any</em> reader. </p>\n\n<p>This is close to polymorphism and shares most of the benefits.</p>\n"}], "owner": {"reputation": 9619, "user_id": 534617, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7cd10a43f8fab06f82c32ace961f9fa0?s=128&d=identicon&r=PG", "display_name": "Qiang Li", "link": "https://stackoverflow.com/users/534617/qiang-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4950, "favorite_count": 3, "answer_count": 3, "score": 5, "last_activity_date": 1445934858, "creation_date": 1445825087, "last_edit_date": 1445860124, "question_id": 33337403, "link": "https://stackoverflow.com/questions/33337403/what-does-dynamic-type-mean-in-a-go-interface", "title": "What does &quot;dynamic type&quot; mean in a Go interface?", "body": "<p><em>The Way to Go: A Thorough Introduction To The Go Programming Language</em> (Ivo Balbaert) contains this sentence which I don't quite understand:</p>\n\n<blockquote>\n  <p>An interface type can contain a reference to an instance of any of the types that implement the interface (an interface has what is called a dynamic type)</p>\n</blockquote>\n\n<p>What is an example of this, and why this is useful?</p>\n"}, {"tags": ["google-app-engine", "go", "uber-api"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1445863812, "post_id": 33337360, "comment_id": 54487718, "body": "<code>req, _ := http.NewRequest(&quot;POST&quot;, UberTokenHost, strings.NewReader(string(uberRequestFormJson)))</code> looks suspect. How does Uber want you to supply the data? As a JSON body? Should be bytes, not a string."}], "answers": [{"tags": [], "owner": {"reputation": 6263, "user_id": 313113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jTKEm.png?s=128&g=1", "display_name": "Alex Bitek", "link": "https://stackoverflow.com/users/313113/alex-bitek"}, "is_accepted": false, "score": 0, "last_activity_date": 1456435351, "creation_date": 1456435351, "answer_id": 35638613, "question_id": 33337360, "link": "https://stackoverflow.com/questions/33337360/doing-a-post-request-on-golang-for-uber-authentication-not-working/35638613#35638613", "title": "Doing a post request on golang for uber authentication not working", "body": "<ul>\n<li>The <a href=\"https://developer.uber.com/docs/authentication\" rel=\"nofollow\">authorization and authentication documentation</a> doesn't mention anything about JSON.   </li>\n<li>The request to the <a href=\"https://developer.uber.com/docs/authentication#section-step-one-authorize\" rel=\"nofollow\">GET https://login.uber.com/oauth/v2/authorize\n</a> endpoint requires you to send the parameters in the query string of the URL using the GET HTTP method, <strong>not</strong> in the body of the HTTP request.</li>\n<li>Make sure to <a href=\"https://en.wikipedia.org/wiki/Percent-encoding#The_application.2Fx-www-form-urlencoded_type\" rel=\"nofollow\">URL/percent encode</a> each parameter you are sending.</li>\n</ul>\n"}], "owner": {"reputation": 457, "user_id": 2929041, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/HPrbm.jpg?s=128&g=1", "display_name": "macmania314", "link": "https://stackoverflow.com/users/2929041/macmania314"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456435351, "creation_date": 1445824717, "last_edit_date": 1445825046, "question_id": 33337360, "link": "https://stackoverflow.com/questions/33337360/doing-a-post-request-on-golang-for-uber-authentication-not-working", "title": "Doing a post request on golang for uber authentication not working", "body": "<p>I'm getting a 400 Bad Request when doing a request do oauth on uber API. I was successful in doing redirection. But when trying to do oauth, it fails. Here's how I've set up my code. </p>\n\n<pre><code>type UberRequest struct {\n    ClientSecret string `json:\"client_secret\"`\n    ClientId     string `json:\"client_id\"`\n    GrantType    string `json:\"grant_type\"`\n    RedirectURI  string `json:\"redirect_uri\"`\n    Code         string `json:\"code\"`\n}\n\nfunc HandlerUberAPI(w http.ResponseWriter, r *http.Request){\n   c := appengine.NewContext(r)\n   AuthorizationCode := r.URL.Query().Get(\"code\")\n\n   client := urlfetch.Client(c)\n\n   uberRequestForm := &amp;UberRequest{\n       ClientSecret: CLIENT_SECRET,\n       ClientId:     CLIENT_ID,\n       GrantType:    \"authorization_code\",\n       RedirectURI:  URI_REDIRECT,\n       Code:         CODE,\n   }\n\n   uberRequestFormJson, _ := json.Marshal(uberRequestForm)\n   req, _ := http.NewRequest(\"POST\", UberTokenHost, strings.NewReader(string(uberRequestFormJson)))\n   req.Header.Set(\"Content-Type\", \"application/json\")\n}\n</code></pre>\n\n<p>Also, if you're interested in looking at the golang code via playground - here it is <a href=\"https://play.golang.org/p/o8EtgudiMR\" rel=\"nofollow\">https://play.golang.org/p/o8EtgudiMR</a></p>\n\n<p>I know that my client secret and other information works as I've tested in on postman, I don't know why it fails on google app engine. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6529, "user_id": 4252320, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh3.googleusercontent.com/-_DAs7Dtci9U/AAAAAAAAAAI/AAAAAAAAIf8/96ZNJAUF2Xk/photo.jpg?sz=128", "display_name": "ergonaut", "link": "https://stackoverflow.com/users/4252320/ergonaut"}, "edited": false, "score": 0, "creation_date": 1445821872, "post_id": 33336998, "comment_id": 54470642, "body": "perhaps mod.Name() is nil even though mod is not nil?"}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "reply_to_user": {"reputation": 6529, "user_id": 4252320, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh3.googleusercontent.com/-_DAs7Dtci9U/AAAAAAAAAAI/AAAAAAAAIf8/96ZNJAUF2Xk/photo.jpg?sz=128", "display_name": "ergonaut", "link": "https://stackoverflow.com/users/4252320/ergonaut"}, "edited": false, "score": 0, "creation_date": 1445822020, "post_id": 33336998, "comment_id": 54470676, "body": "mod.Name() returns string.  It therefore cannot return nil.  Or did you mean the function?  If a zero-valued interface that is not nil can hold a nil implementation, how to check for that condition?"}, {"owner": {"reputation": 6529, "user_id": 4252320, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh3.googleusercontent.com/-_DAs7Dtci9U/AAAAAAAAAAI/AAAAAAAAIf8/96ZNJAUF2Xk/photo.jpg?sz=128", "display_name": "ergonaut", "link": "https://stackoverflow.com/users/4252320/ergonaut"}, "edited": false, "score": 0, "creation_date": 1445822377, "post_id": 33336998, "comment_id": 54470769, "body": "I don&#39;t know go, but I was just suspecting that there was something wrong with the LHS of the assignment.  perhaps mods is nil.  or mods[mod.Name()] is invalid to begin with."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1445822640, "post_id": 33336998, "comment_id": 54470833, "body": "See <a href=\"https://golang.org/doc/faq#nil_error\" rel=\"nofollow noreferrer\">golang.org/doc/faq#nil_error</a> for a likely explanation of what&#39;s going on. Show us the code for srt.PrimaryModule()."}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1445828285, "post_id": 33336998, "comment_id": 54472162, "body": "&quot;An interface value is nil only if the inner value and type are both unset, (nil, nil).&quot;   Ah, perfect.  TYVM, that&#39;s what I was missing!"}], "answers": [{"comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1445829102, "post_id": 33337146, "comment_id": 54472369, "body": "Thanks, last link is very helpful in particular.   Is there a way to explicitly check if the the concrete value is nil without knowing the concrete type?   Seems sketchy/no, since nils are typed - but would be nice if some reflect package method could do it (none seem to!)  My yucky workaround is just to have the Name() method of all implementing types bail out with a &quot;&quot; if the receiver is nil, and check for that also..."}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1445829157, "post_id": 33337146, "comment_id": 54472381, "body": "(InterfaceData(), perhaps?   But it&#39;s barely documented...)"}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1445829411, "post_id": 33337146, "comment_id": 54472455, "body": "(Or, you know, adding a func (m *Module) IsValid() bool { return m != nil } is much cleaner...)"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 1, "creation_date": 1445838848, "post_id": 33337146, "comment_id": 54474638, "body": "@BadZen: See the question in my revised answer. Also, &quot;The actual implementation of srt is a struct that returns an uninitialized Module value from its fields.&quot;  What do you mean exactly? What&#39;s missing is a good working example: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a>."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1445838679, "last_edit_date": 1445838679, "creation_date": 1445822873, "answer_id": 33337146, "question_id": 33336998, "link": "https://stackoverflow.com/questions/33336998/weird-nil-not-nil-behavior/33337146#33337146", "title": "Weird nil / not-nil behavior", "body": "<p>if any concrete value has been stored in the interface, the interface will not be <code>nil</code>. However, the concrete value stored in the interface can be a <code>nil</code> pointer.</p>\n\n<p>For example, is the <code>fmt.Println(mod)</code> output, the concrete value, <code>nil</code>?</p>\n\n<pre><code>if mod != nil {\n    fmt.Println(mod)\n    mods[mod.Name()] = mod\n}\n</code></pre>\n\n<p>Does <code>srt.PrimaryModule()</code> return a <code>nil</code> pointer to <code>mod</code>? If so, <code>mod.Name()</code> will <code>panic</code> with a <code>nil pointer dereference</code>.</p>\n\n<p>References:</p>\n\n<p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow\">The Go Programming Language Specification</a>: <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow\">Interface types</a></p>\n\n<p><a href=\"http://research.swtch.com/interfaces\" rel=\"nofollow\">Go Data Structures: Interfaces</a> </p>\n\n<p><a href=\"https://golang.org/doc/faq#nil_error\" rel=\"nofollow\">Why is my nil error value not equal to nil?</a></p>\n\n<hr>\n\n<p>What is the output from this revised version of your code?</p>\n\n<pre><code>mod := srt.PrimaryModule()\nif mod != nil {\n    fmt.Printf(\"%T %v\\n\", mod, mod)\n    if mod.(Module) != nil {\n        fmt.Println(mod.Name())\n        mods[mod.Name()] = mod\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1445838679, "creation_date": 1445821757, "question_id": 33336998, "link": "https://stackoverflow.com/questions/33336998/weird-nil-not-nil-behavior", "title": "Weird nil / not-nil behavior", "body": "<p>I have the following code in my project:</p>\n\n<pre><code>        mod := srt.PrimaryModule()\n        if mod != nil {\n            mods[mod.Name()] = mod\n        }\n</code></pre>\n\n<p>When it executes, I get:</p>\n\n<pre><code>PANIC: runtime error: invalid memory address or nil pointer dereference\n</code></pre>\n\n<p>with the stack right at the third line of that.  (Yes it's the <code>mod</code> dereference, the map <code>mods</code> is created just a line above...)</p>\n\n<p>So, when is a nil value not equal to nil?   And why?</p>\n\n<pre><code> srt.PrimaryModule() \n</code></pre>\n\n<p>returns an interface type, <code>Module</code>, with a <code>Name()</code> method defined returning <code>string</code>.</p>\n\n<p>In this particular case, <code>srt</code> is typed <code>StdReflectedType</code>, which is an interface type with a function <code>PrimaryModule()</code> returning type <code>Module</code>.   The actual implementation of <code>srt</code> is a struct that returns an uninitialized <code>Module</code> value from its fields.</p>\n\n<p>Further, if I do</p>\n\n<p><code>reflect.ValueOf(mod)</code> </p>\n\n<p>the result is the zero reflect.Value.</p>\n\n<p>From the reflect package documentation:</p>\n\n<pre><code> ValueOf returns a new Value initialized to the concrete value stored in the interface i. ValueOf(nil) returns the zero Value\n</code></pre>\n\n<p>Which seems right, except the previous line just determined <code>mod != nil</code>.   So what gives?</p>\n\n<p>I cannot seem to reproduce this in a minimal example - is there any sensible behavior that could cause those lines to do this - am I not understandig something important about interface values and nil pointers?</p>\n"}, {"tags": ["google-app-engine", "go", "yaml"], "answers": [{"comments": [{"owner": {"reputation": 457, "user_id": 2929041, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/HPrbm.jpg?s=128&g=1", "display_name": "macmania314", "link": "https://stackoverflow.com/users/2929041/macmania314"}, "edited": false, "score": 0, "creation_date": 1446092535, "post_id": 33361178, "comment_id": 54603153, "body": "Hi @icza - i&#39;ve tried the implementation here but I don&#39;t think it&#39;s working. Can you give more background on how this sync.DoOnce actually works when adding it in the main handler?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1446095404, "last_edit_date": 1446095404, "creation_date": 1445927030, "answer_id": 33361178, "question_id": 33336850, "link": "https://stackoverflow.com/questions/33336850/environment-variables-specified-on-app-yaml-but-its-not-fetching-on-main-go/33361178#33361178", "title": "Environment variables specified on app.yaml but it&#39;s not fetching on main.go", "body": "<p>It is undocumented in the official doc: <a href=\"https://cloud.google.com/appengine/docs/go/config/appconfig#Go_app_yaml_Defining_environment_variables\" rel=\"nofollow\">Defining environment variables</a>, but environment variables defined in <code>app.yaml</code> in production are not set before <code>init()</code> functions are called. They are only set before serving the first request.</p>\n\n<p>This issue was reported <a href=\"https://code.google.com/p/googleappengine/issues/detail?id=12006\" rel=\"nofollow\">here</a>. Quoting an AppEngine engineer's answer:</p>\n\n<blockquote>\n  <p>Right. Due to the nature of the implementation, environment variables are not available in your init functions, unfortunately.\n  Although they are not tied to requests, they are not set until after all the init functions have already run, but are set before the first request is handled.</p>\n  \n  <p>As a result, you could use a sync.DoOnce in your main handler to perform any actions required based on the value of an environment variable since it will be properly set by that time.</p>\n</blockquote>\n\n<p>Example of achieving this with <a href=\"https://golang.org/pkg/sync/#Once.Do\" rel=\"nofollow\"><code>Once.Do()</code></a>:</p>\n\n<pre><code>var once = sync.Once{}\n\nfunc MainHandler(w http.ResponseWriter, r *http.Request) {\n    once.Do(mysetup)\n    // do your regular stuff here\n}\n\nfunc mysetup() {\n    // This function is executed only once. Read / use env vars here.\n    var1 := os.Getenv(\"ENVIRONMENT_VAR1\")\n    _ = var1 // use var1\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 144, "user_id": 788275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb33150db41e23ebf0850f8cc263e253?s=128&d=identicon&r=PG", "display_name": "Andrew Watson", "link": "https://stackoverflow.com/users/788275/andrew-watson"}, "is_accepted": false, "score": 0, "last_activity_date": 1450194150, "creation_date": 1450194150, "answer_id": 34293366, "question_id": 33336850, "link": "https://stackoverflow.com/questions/33336850/environment-variables-specified-on-app-yaml-but-its-not-fetching-on-main-go/34293366#34293366", "title": "Environment variables specified on app.yaml but it&#39;s not fetching on main.go", "body": "<p>The answer icza provided worked for me.  In addition, I put the once.Do() call in a handler for the /_ah/start method so that it would be called immediately when GAE started up my application.</p>\n"}], "owner": {"reputation": 457, "user_id": 2929041, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/HPrbm.jpg?s=128&g=1", "display_name": "macmania314", "link": "https://stackoverflow.com/users/2929041/macmania314"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "accepted_answer_id": 33361178, "answer_count": 2, "score": 2, "last_activity_date": 1450194150, "creation_date": 1445820562, "last_edit_date": 1445968342, "question_id": 33336850, "link": "https://stackoverflow.com/questions/33336850/environment-variables-specified-on-app-yaml-but-its-not-fetching-on-main-go", "title": "Environment variables specified on app.yaml but it&#39;s not fetching on main.go", "body": "<p>I've specified my environment variables in app.yaml and it's being fetched when I'm running it on my local machine but once I have it deployed - it's not fetching it. </p>\n\n<p>Here's how I've set it up:</p>\n\n<pre><code>application: some-application\nversion: 1\nruntime: go\napi_version: go1\nthreadsafe: true\n\nhandlers: \n- url: /.*\n  script: main.go\n  secure: always\n\nenv_variables: \n  ENVIRONMENT_VAR1: 'some key'\n  ENVIRONMENT_VAR2: 'some key'\n  ENVIRONMENT_VAR3: 'some key'\n</code></pre>\n\n<p>And I'm using <code>os.Getenv(\"ENVIRONMENT_VAR1\")</code> to retrieve the key and it works when I run it on my local but fails to work when deployed on google app engine. </p>\n"}, {"tags": ["go", "binary-operators"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1445820397, "last_edit_date": 1445820397, "creation_date": 1445818449, "answer_id": 33336602, "question_id": 33336336, "link": "https://stackoverflow.com/questions/33336336/go-perform-unsigned-shift-operation/33336602#33336602", "title": "Go - Perform unsigned shift operation", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Numeric_types\" rel=\"nofollow\">Numeric types</a></p>\n  \n  <p>A numeric type represents sets of integer or floating-point values.\n  The predeclared architecture-independent numeric types include:</p>\n\n<pre><code>uint8       the set of all unsigned  8-bit integers (0 to 255)\nuint16      the set of all unsigned 16-bit integers (0 to 65535)\nuint32      the set of all unsigned 32-bit integers (0 to 4294967295)\nuint64      the set of all unsigned 64-bit integers (0 to 18446744073709551615)\n\nint8        the set of all signed  8-bit integers (-128 to 127)\nint16       the set of all signed 16-bit integers (-32768 to 32767)\nint32       the set of all signed 32-bit integers (-2147483648 to 2147483647)\nint64       the set of all signed 64-bit integers (-9223372036854775808 to 9223372036854775807)\n\nbyte        alias for uint8\nrune        alias for int32\n</code></pre>\n  \n  <p>The value of an n-bit integer is n bits wide and represented using\n  two's complement arithmetic.</p>\n  \n  <p>There is also a set of predeclared numeric types with\n  implementation-specific sizes:</p>\n\n<pre><code>uint     either 32 or 64 bits\nint      same size as uint\nuintptr  an unsigned integer large enough to store the uninterpreted bits of a pointer value\n</code></pre>\n  \n  <p>Conversions are required when different numeric types are mixed in an\n  expression or assignment.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Arithmetic_operators\" rel=\"nofollow\">Arithmetic operators</a></p>\n\n<pre><code>&lt;&lt;   left shift             integer &lt;&lt; unsigned integer\n&gt;&gt;   right shift            integer &gt;&gt; unsigned integer\n</code></pre>\n  \n  <p>The shift operators shift the left operand by the shift count\n  specified by the right operand. They implement arithmetic shifts if\n  the left operand is a signed integer and logical shifts if it is an\n  unsigned integer. There is no upper limit on the shift count. Shifts\n  behave as if the left operand is shifted n times by 1 for a shift\n  count of n. As a result, x &lt;&lt; 1 is the same as x*2 and x >> 1 is the\n  same as x/2 but truncated towards negative infinity.</p>\n</blockquote>\n\n<p>In Go, it's an unsigned integer shift. Go has signed and unsigned integers.</p>\n\n<p>It depends on what type the value <code>0xFF</code> is. Assume it's one of the unsigned integer types, for example, <code>uint</code>.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    n := uint(0xFF)\n    fmt.Printf(\"%X\\n\", n)\n    n = n &gt;&gt; 3\n    fmt.Printf(\"%X\\n\", n)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>FF\n1F\n</code></pre>\n\n<p>Assume it's one of the signed integer types, for example, <code>int</code>.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    n := int(0xFF)\n    fmt.Printf(\"%X\\n\", n)\n    n = int(uint(n) &gt;&gt; 3)\n    fmt.Printf(\"%X\\n\", n)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>FF\n1F\n</code></pre>\n"}], "owner": {"reputation": 2925, "user_id": 660675, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8qJ6x.jpg?s=128&g=1", "display_name": "resilva87", "link": "https://stackoverflow.com/users/660675/resilva87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1315, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1445820397, "creation_date": 1445815989, "question_id": 33336336, "link": "https://stackoverflow.com/questions/33336336/go-perform-unsigned-shift-operation", "title": "Go - Perform unsigned shift operation", "body": "<p>Is there anyway to perform an unsigned shift (namely, unsigned right shift) operation in Go? Something like this in Java</p>\n\n<pre><code>0xFF &gt;&gt;&gt; 3\n</code></pre>\n\n<p>The only thing I could find on this matter is this <a href=\"https://groups.google.com/forum/#!msg/golang-nuts/2L7NfqtZYls/Ezf6TbFhlEEJ\" rel=\"nofollow\">post</a> but I'm not sure what I have to do.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 944, "user_id": 1300418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22bad5c2555166a95807a6ce3dd089b1?s=128&d=identicon&r=PG", "display_name": "vansimke", "link": "https://stackoverflow.com/users/1300418/vansimke"}, "edited": false, "score": 0, "creation_date": 1445851763, "post_id": 33335788, "comment_id": 54480352, "body": "What is the type of myArray? If it isn&#39;t []interface{}, then that should work. One thing that could be happening is if myArray&#39;s type is defined in another package or source file. Gocode only reads compiled libraries, not raw source code. Try &quot;go install {path to package}&quot; and see if autocomplete lights up."}, {"owner": {"reputation": 35619, "user_id": 84539, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/277f6eb5c0f422fa7bec5b1d2cb51e82?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/84539/jon"}, "reply_to_user": {"reputation": 944, "user_id": 1300418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22bad5c2555166a95807a6ce3dd089b1?s=128&d=identicon&r=PG", "display_name": "vansimke", "link": "https://stackoverflow.com/users/1300418/vansimke"}, "edited": false, "score": 0, "creation_date": 1445851922, "post_id": 33335788, "comment_id": 54480447, "body": "Its in another package but a subfolder of my application so is that the same?"}, {"owner": {"reputation": 892, "user_id": 1553664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828efb4fa17de9f81c7e9ebae6833a69?s=128&d=identicon&r=PG", "display_name": "ignatov", "link": "https://stackoverflow.com/users/1553664/ignatov"}, "edited": false, "score": 0, "creation_date": 1447708976, "post_id": 33335788, "comment_id": 55258161, "body": "Please file an issue \u2013 <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/new\" rel=\"nofollow noreferrer\">github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/new</a>"}], "answers": [{"tags": [], "owner": {"reputation": 35619, "user_id": 84539, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/277f6eb5c0f422fa7bec5b1d2cb51e82?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/84539/jon"}, "is_accepted": false, "score": 0, "last_activity_date": 1445853695, "creation_date": 1445853695, "answer_id": 33342930, "question_id": 33335788, "link": "https://stackoverflow.com/questions/33335788/lack-of-intellisense-on-array-of-structs/33342930#33342930", "title": "Lack of intellisense on array of structs", "body": "<p>The answer comes from @vansimke in that I needed to have <code>go install myapp</code> executed for GoCode to pick up the heirachy of dependencies so it would give me the intellisense.</p>\n"}, {"tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": false, "score": 0, "last_activity_date": 1446856658, "last_edit_date": 1446856658, "creation_date": 1446053158, "answer_id": 33397610, "question_id": 33335788, "link": "https://stackoverflow.com/questions/33335788/lack-of-intellisense-on-array-of-structs/33397610#33397610", "title": "Lack of intellisense on array of structs", "body": "<p>In IntelliJ it should totally be possible to get the autocompletion to work. I use it daily and I don't have any issues with that. There might be some well hidden edge cases where this happens so if you indeed have problems with it, please open a detailed issue here: <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/new\" rel=\"nofollow\">https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/new</a> and you should be able to receive more guidance.</p>\n\n<p>Also, it would help to know a bit more about your code layout (paths and so on) and a sample of code that can reproduce the issue.</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 35619, "user_id": 84539, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/277f6eb5c0f422fa7bec5b1d2cb51e82?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/84539/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1446856658, "creation_date": 1445811823, "question_id": 33335788, "link": "https://stackoverflow.com/questions/33335788/lack-of-intellisense-on-array-of-structs", "title": "Lack of intellisense on array of structs", "body": "<p>In Atom and IntelliJ writing golang, when I have an array of structs and I loop over it in a <code>range</code>or have <code>firstItem = myArray[0]</code> when I try to interact with that variable the editor doesn't give me properties etc of the struct via intellisense.</p>\n\n<p>Any ideas? </p>\n"}, {"tags": ["ssh", "go", "hugo"], "answers": [{"tags": [], "owner": {"reputation": 31539, "user_id": 367985, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/761edb9c3cf7a0a643e73ef40666a1f7?s=128&d=identicon&r=PG", "display_name": "CuriousMind", "link": "https://stackoverflow.com/users/367985/curiousmind"}, "is_accepted": true, "score": 3, "last_activity_date": 1445801788, "creation_date": 1445801788, "answer_id": 33334170, "question_id": 33334122, "link": "https://stackoverflow.com/questions/33334122/installing-hugo-web-engine-without-ssh/33334170#33334170", "title": "Installing Hugo web engine without SSH", "body": "<blockquote>\n  <p>After running <code>hugo server</code> for local web development, you need to do\n  a final hugo run without the <code>server</code> command and without <code>--watch</code> or\n  <code>-w</code> to rebuild your site.</p>\n  \n  <p>then, You may deploy your site by copying the <code>public/</code> directory (by\n  FTP, SFTP, WebDAV, Rsync, git push, etc.) to your web host.</p>\n</blockquote>\n\n<p>Since Hugo generates a static website, your site can be hosted anywhere as in the most basic host provide FTP access. For more please see <a href=\"https://gohugo.io/overview/usage/\" rel=\"nofollow\">Using Hugo</a></p>\n"}], "owner": {"reputation": 11, "user_id": 2814959, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/defc837812d31e4b7c0e23601b3b5234?s=128&d=identicon&r=PG&f=1", "display_name": "Darksidezoo", "link": "https://stackoverflow.com/users/2814959/darksidezoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 33334170, "answer_count": 1, "score": -1, "last_activity_date": 1445801788, "creation_date": 1445801501, "question_id": 33334122, "link": "https://stackoverflow.com/questions/33334122/installing-hugo-web-engine-without-ssh", "title": "Installing Hugo web engine without SSH", "body": "<p>I use a basic hosting service that does not include secure shell access, Is there another way that I can deploy Hugo?</p>\n"}, {"tags": ["html", "twitter-bootstrap", "go", "martini"], "answers": [{"tags": [], "owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "is_accepted": true, "score": 3, "last_activity_date": 1446128211, "last_edit_date": 1446128211, "creation_date": 1445788155, "answer_id": 33331655, "question_id": 33331350, "link": "https://stackoverflow.com/questions/33331350/martini-routes-with-named-parameter-fails-static-files-loading/33331655#33331655", "title": "Martini routes with named parameter fails static files loading", "body": "<p>The links in your supplied html snippet are relative links. This means that when the browser resolves the URL it appends the given path to the current host and path ie, <code>http://&lt;hostname_and_port&gt;/edit + assets/css/bootstrap.min.css</code>. </p>\n\n<p>You can use a root path instead of a relative path to ensure that when the browser resolves urls it appends the given path to the root of the host no matter what the full URL path is. This is done by putting a forward slash at the beginning of your path. In the following example I have added a forward slash to the <code>src</code> and <code>href</code> attribute paths.</p>\n\n<pre><code>&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/css/bootstrap.min.css\"&gt;\n&lt;script type=\"text/javascript\" src=\"/assets/js/bootstrap.min.js\"&gt;&lt;/script&gt;\n</code></pre>\n"}], "owner": {"reputation": 800, "user_id": 4828850, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/epNbR.jpg?s=128&g=1", "display_name": "Sergei Stralenia", "link": "https://stackoverflow.com/users/4828850/sergei-stralenia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 33331655, "answer_count": 1, "score": 2, "last_activity_date": 1468507429, "creation_date": 1445786461, "last_edit_date": 1468507429, "question_id": 33331350, "link": "https://stackoverflow.com/questions/33331350/martini-routes-with-named-parameter-fails-static-files-loading", "title": "Martini routes with named parameter fails static files loading", "body": "<p>I wrote my first Go application with Martini. I have route with named parameter:</p>\n\n<pre><code>m := martini.Classic()\n\nstaticOptions := martini.StaticOptions{Prefix: \"assets\"}\nm.Use(martini.Static(\"assets\", staticOptions))\n\nm.Get(\"/edit/:id\", editHandler)\nm.Run()\n</code></pre>\n\n<p>The editHandler renders edit template with bootstrap stylesheet and script which lie in <code>assets/css</code> and <code>assets/js</code> folders accordingly.</p>\n\n<pre><code>&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"assets/css/bootstrap.min.css\"&gt;\n&lt;script type=\"text/javascript\" src=\"assets/js/bootstrap.min.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>But when I open edit page in my browser my static files don't load, because browser makes requests to <code>edit/assets/css/bootstrap.min.css</code> and <code>edit/assets/js/bootstrap.min.js</code>.\nHow can I strip any route prefix?('edit', 'show' and others)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1445783495, "post_id": 33330814, "comment_id": 54458376, "body": "Is this <code>Point</code> struct your actual use case? Are you able to explain a little more about where you are trying to do this?"}, {"owner": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "edited": false, "score": 0, "creation_date": 1445783535, "post_id": 33330814, "comment_id": 54458390, "body": "What do you expect this code to do?"}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1445783580, "post_id": 33330814, "comment_id": 54458404, "body": "The field names of <code>Point</code> are <code>x</code> and <code>y</code>, not <code>a</code>."}, {"owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "edited": false, "score": 0, "creation_date": 1445783615, "post_id": 33330814, "comment_id": 54458414, "body": "why doesn&#39;t it give <code>pt.x = 2</code> ?"}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 1, "creation_date": 1445784159, "post_id": 33330814, "comment_id": 54458566, "body": "string <code>&quot;x&quot;</code> has nothing to do with field <code>pt.x</code>"}, {"owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "reply_to_user": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1445784476, "post_id": 33330814, "comment_id": 54458684, "body": "@Akavall how can I convert <code>&quot;x&quot;</code> into <code>x</code> ?  Python has <code>eval()</code> function so that <code>eval(&quot;2 + 3&quot;) = 5</code>"}, {"owner": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "edited": false, "score": 0, "creation_date": 1445784515, "post_id": 33330814, "comment_id": 54458702, "body": "Write <code>pt.x</code> instead?"}, {"owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "reply_to_user": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "edited": false, "score": 0, "creation_date": 1445784615, "post_id": 33330814, "comment_id": 54458736, "body": "@FilipeGon&#231;alves  the string <code>&quot;x&quot;</code> is a URL parameter, and I would like to find data in a struct relating to <code>x</code>"}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1445784714, "post_id": 33330814, "comment_id": 54458769, "body": "Why not use <code>map</code> instead of <code>struct</code> then?"}, {"owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "reply_to_user": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1445784792, "post_id": 33330814, "comment_id": 54458795, "body": "@Akavall perhaps <code>map</code> is more appropriate then... thanks"}, {"owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 0, "creation_date": 1445789779, "post_id": 33330814, "comment_id": 54460705, "body": "Are you trying to use reflection to use a dynamic field name for a struct field?"}, {"owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "reply_to_user": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 0, "creation_date": 1445793670, "post_id": 33330814, "comment_id": 54462136, "body": "@benjic I solved it by switching to <code>map[string]int</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1053, "user_id": 3608492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e469e0555fc5221b227deb0d9a305a?s=128&d=identicon&r=PG&f=1", "display_name": "Satyen Rai", "link": "https://stackoverflow.com/users/3608492/satyen-rai"}, "is_accepted": false, "score": 3, "last_activity_date": 1445872299, "creation_date": 1445872299, "answer_id": 33349175, "question_id": 33330814, "link": "https://stackoverflow.com/questions/33330814/struct-field-names-starting-with-a-string/33349175#33349175", "title": "Struct field names starting with a string", "body": "<p>If you need to access a field whose name is given as a string, you have no choice but to use reflection. Go ain't Python. :-)</p>\n\n<p><a href=\"http://blog.golang.org/laws-of-reflection\" rel=\"nofollow\">This blog</a> has a nice explanation.</p>\n\n<p><a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow\">Here</a> is the reflect package documentation.</p>\n\n<p>But note that reflection should usually be used as a last resort only. It removes the static type safety and is detrimental for performance. </p>\n\n<p>What are you really looking for? There may be a way to address your requirements without using reflection. For example, if you don't need methods attached to your struct, you could use <code>map[string]int</code>.</p>\n"}], "owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445872299, "creation_date": 1445783342, "last_edit_date": 1445783705, "question_id": 33330814, "link": "https://stackoverflow.com/questions/33330814/struct-field-names-starting-with-a-string", "title": "Struct field names starting with a string", "body": "<p>I have a go struct and I need to work with one of the fields.  However I am starting with a string.  How do I case it to get the field itself.</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc main() {\n\n    type Point struct{\n  x int\n  y int\n}\n\n    pt := Point{x:2, y:3}\n    a  := \"x\"\n    fmt.Printf(\"%s\", pt.a)\n} \n</code></pre>\n\n<p>Since <code>a = \"x\"</code> I am expecting <code>pt.x = 2</code>.  Here's the error message it prints out.  I am definitely starting with a string so I can't just remove the quotation marks.</p>\n\n<pre><code>$ go run point.go\n# command-line-arguments\n./point.go:14: pt.a undefined (type Point has no field or method a)\n</code></pre>\n"}, {"tags": ["go", "compiler-errors", "linker", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 1246431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4254d4b6c9eebe54fecd792d2a0314f6?s=128&d=identicon&r=PG", "display_name": "bgeyts668", "link": "https://stackoverflow.com/users/1246431/bgeyts668"}, "is_accepted": true, "score": 2, "last_activity_date": 1445777938, "creation_date": 1445777938, "answer_id": 33329971, "question_id": 33329744, "link": "https://stackoverflow.com/questions/33329744/building-go-with-c-interface-to-gtk/33329971#33329971", "title": "Building Go with C interface to Gtk+", "body": "<p>Well, I figured out that cgo does link well with static libraries. So I decided to archive my <code>ui.o</code> into <code>libui.a</code> and link it using <code>#cgo LDFLAGS: -L. -lui</code> and it worked correctly.</p>\n"}], "owner": {"reputation": 126, "user_id": 1246431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4254d4b6c9eebe54fecd792d2a0314f6?s=128&d=identicon&r=PG", "display_name": "bgeyts668", "link": "https://stackoverflow.com/users/1246431/bgeyts668"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 33329971, "answer_count": 1, "score": 1, "last_activity_date": 1445777938, "creation_date": 1445776546, "question_id": 33329744, "link": "https://stackoverflow.com/questions/33329744/building-go-with-c-interface-to-gtk", "title": "Building Go with C interface to Gtk+", "body": "<p>I'm trying to build a Go programm which uses external C code as an interface for Gtk+.</p>\n\n<p>That's the basic Go code I've got (ui.h.go):</p>\n\n<pre><code>package main\n\n//#cgo pkg-config: gtk+-3.0\n//#include \"ui.h\"\nimport \"C\"\n\nfunc CInit() {\n    C.Init(nil, 0)\n}\n\nfunc CMain() {\n    C.Main()\n}\n\nfunc CShowWindow() {\n    C.ShowWindow()\n}\n\nfunc main() {\n    CInit()\n    CShowWindow()\n    CMain()\n}\n</code></pre>\n\n<p>C code is compiled from vala into an object file (ui.o) and a header file (ui.h):</p>\n\n<pre><code>#ifndef __UI_H__\n#define __UI_H__\n\n#include &lt;glib.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nG_BEGIN_DECLS\n\nvoid ShowWindow (void);\nvoid Init (gchar** args, int args_length1);\nvoid Main (void);\n\nG_END_DECLS\n\n#endif\n</code></pre>\n\n<p>When I try <code>go build ui.h.go</code> I get:</p>\n\n<pre><code># command-line-arguments\n/tmp/go-build916459533/command-line-arguments/_obj/ui.h.cgo2.o: In function `_cgo_80fc53cbf347_Cfunc_Init':\n./ui.h.go:37: undefined reference to `Init'\n/tmp/go-build916459533/command-line-arguments/_obj/ui.h.cgo2.o: In function `_cgo_80fc53cbf347_Cfunc_Main':\n./ui.h.go:46: undefined reference to `Main'\n/tmp/go-build916459533/command-line-arguments/_obj/ui.h.cgo2.o: In function `_cgo_80fc53cbf347_Cfunc_ShowWindow':\n./ui.h.go:55: undefined reference to `ShowWindow'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Which is logical, I haven't provided my object file. But if I specify it in cgo header of <code>ui.h.go</code> like that...</p>\n\n<pre><code>//#cgo LDFLAGS: ui.o\n//#cgo pkg-config: gtk+-3.0\n//#include \"ui.h\"\nimport \"C\"\n</code></pre>\n\n<p>I get multiple definition error, as if it's being linked twice.</p>\n\n<pre><code># command-line-arguments\n/usr/local/go/pkg/tool/linux_amd64/link: running gcc failed: exit status 1\nui.o:(.bss+0x0): multiple definition of `window'\n/tmp/go-link-461834384/000000.o:/home/oleg/\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b/Projects/rasp/ui.h.go:38: first defined here\nui.o: In function `ShowWindow':\nui.c:(.text+0x0): multiple definition of `ShowWindow'\n/tmp/go-link-461834384/000000.o:(.text+0x25): first defined here\nui.o: In function `Init':\nui.c:(.text+0x29): multiple definition of `Init'\n/tmp/go-link-461834384/000000.o:(.text+0x4e): first defined here\nui.o: In function `Main':\nui.c:(.text+0x116): multiple definition of `Main'\n/tmp/go-link-461834384/000000.o:(.text+0x13b): first defined here\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>How do I link my ui.o file to the Go program correctly?\nThank you.</p>\n"}, {"tags": ["sockets", "go", "udp", "type-conversion"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 1306251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51a33e61874bf25461b46069cddbc359?s=128&d=identicon&r=PG", "display_name": "Sync", "link": "https://stackoverflow.com/users/1306251/sync"}, "edited": false, "score": 0, "creation_date": 1445870586, "post_id": 33329424, "comment_id": 54492422, "body": "Thanks that seems to work fine. I still haven&#39;t achieved what I needed from my code, but the conversion works! Many thanks!"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1445774327, "creation_date": 1445774327, "answer_id": 33329424, "question_id": 33328907, "link": "https://stackoverflow.com/questions/33328907/send-float32-values-over-udp-socket/33329424#33329424", "title": "Send float32 values over udp socket", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/binary\"\n    \"fmt\"\n    \"math\"\n)\n\nfunc Float32Bytes(float float32) []byte {\n    bits := math.Float32bits(float)\n    bytes := make([]byte, 4)\n    binary.LittleEndian.PutUint32(bytes, bits)\n    return bytes\n}\n\nfunc BytesFloat32(bytes []byte) float32 {\n    bits := binary.LittleEndian.Uint32(bytes)\n    float := math.Float32frombits(bits)\n    return float\n}\n\nfunc main() {\n    pi := float32(math.Pi)\n    b := Float32Bytes(pi)\n    f := BytesFloat32(b)\n    fmt.Println(f, f == pi, BytesFloat32(Float32Bytes(pi)) == pi)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>3.1415927 true true\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 1306251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51a33e61874bf25461b46069cddbc359?s=128&d=identicon&r=PG", "display_name": "Sync", "link": "https://stackoverflow.com/users/1306251/sync"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 2, "accepted_answer_id": 33329424, "answer_count": 1, "score": 3, "last_activity_date": 1445774609, "creation_date": 1445770876, "last_edit_date": 1445774609, "question_id": 33328907, "link": "https://stackoverflow.com/questions/33328907/send-float32-values-over-udp-socket", "title": "Send float32 values over udp socket", "body": "<p>I'm working on a Go project and I would like to send float32 values using an UDPSocket.\nThe thing that I don't understand is what is the best way to convert these numbers to a byte buffer before sending them and how to convert them back to float32 after receiving them.</p>\n\n<p>At the moment I'm converting float32->[]byte with the following function that I've found online, but I'm not even sure I'm getting what I want:</p>\n\n<pre><code>func Float32bytes(float float32) []byte {\n    bits := math.Float32bits(float)\n    bytes := make([]byte, 4)\n    binary.LittleEndian.PutUint32(bytes, bits)\n    return bytes\n}\n</code></pre>\n\n<p>I still don't know how to convert them to float32.</p>\n"}, {"tags": ["go", "batch-processing", "channel"], "comments": [{"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 0, "creation_date": 1445765469, "post_id": 33328000, "comment_id": 54453350, "body": "There is no way to batch read values from a channel. If you don&#39;t want to call <code>multipleRemoteCopy</code> multiple times just buffer the values locally."}], "answers": [{"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": false, "score": 6, "last_activity_date": 1445774005, "last_edit_date": 1445774005, "creation_date": 1445765384, "answer_id": 33328162, "question_id": 33328000, "link": "https://stackoverflow.com/questions/33328000/reading-multiple-elements-from-a-channel-in-go/33328162#33328162", "title": "Reading multiple elements from a channel in Go", "body": "<p>Something like this should work:</p>\n\n<pre><code>for {\n    // we initialize our slice. You may want to add a larger cap to avoid multiple memory allocations on `append`\n    capturedFrames := make([]Frame, 1)\n    // We block waiting for a first frame\n    capturedFrames[0] = &lt;-capturedFrameChan\n\nforLoop:\n    for {\n        select {\n        case buf := &lt;-capturedFrameChan:\n            // if there is more frame immediately available, we add them to our slice\n            capturedFrames = append(capturedFrames, buf)\n        default:\n            // else we move on without blocking\n            break forLoop\n        }\n    }\n\n    multipleRemoteCopy(capturedFrames)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": -1, "last_activity_date": 1445767390, "creation_date": 1445767390, "answer_id": 33328433, "question_id": 33328000, "link": "https://stackoverflow.com/questions/33328000/reading-multiple-elements-from-a-channel-in-go/33328433#33328433", "title": "Reading multiple elements from a channel in Go", "body": "<p>Seems you can also benchmark just</p>\n\n<pre><code>for {\n    capturedFrame := &lt;-capturedFrameChan\n    go remoteCopy(capturedFrame)\n}\n</code></pre>\n\n<p>without any codebase refactoring to see if it increase efficiency.  </p>\n"}, {"tags": [], "owner": {"reputation": 78861, "user_id": 561309, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6d833d9f0ffa2265a01359ccecd26d54?s=128&d=identicon&r=PG&f=1", "display_name": "laurent", "link": "https://stackoverflow.com/users/561309/laurent"}, "is_accepted": true, "score": -1, "last_activity_date": 1449435611, "creation_date": 1449435611, "answer_id": 34122681, "question_id": 33328000, "link": "https://stackoverflow.com/questions/33328000/reading-multiple-elements-from-a-channel-in-go/34122681#34122681", "title": "Reading multiple elements from a channel in Go", "body": "<p>I've ended up doing it as below. Basically I've used <code>len(capturedFrames)</code> to know how many frames are available, then retrieved them in a loop:</p>\n\n<pre><code>for {\n    var paths []string\n    itemCount := len(capturedFrames)\n    if itemCount &lt;= 0 {\n        time.Sleep(50 * time.Millisecond)\n        continue\n    }\n\n    for i := 0; i &lt; itemCount; i++ {\n        f := &lt;-capturedFrames\n        paths = append(paths, f)\n    }\n\n    err := multipleRemoteCopy(paths, opts)\n    if err != nil {\n        fmt.Printf(\"Error: could not remote copy \\\"%s\\\": %s\", paths, err)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3281, "user_id": 4131775, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KDmA5SDbD84/AAAAAAAAAAI/AAAAAAAAAAA/WQxPLtYrNu4/photo.jpg?sz=128", "display_name": "Feiyu Zhou", "link": "https://stackoverflow.com/users/4131775/feiyu-zhou"}, "is_accepted": false, "score": 0, "last_activity_date": 1557034815, "creation_date": 1557034815, "answer_id": 55989153, "question_id": 33328000, "link": "https://stackoverflow.com/questions/33328000/reading-multiple-elements-from-a-channel-in-go/55989153#55989153", "title": "Reading multiple elements from a channel in Go", "body": "<p>By using <code>len(capturedFrames)</code>, you can do it like below:</p>\n\n<pre><code>for {\n    select {\n    case frame := &lt;-capturedFrames:\n        frames := []Frame{frame}\n        for i := 0; i &lt; len(capturedFrames); i++ {\n           frames = append(frames, &lt;-capturedFrames)\n        }\n        multipleRemoteCopy(frames)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 5473726, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RULZQ.jpg?s=128&g=1", "display_name": "Sorush Purabdi", "link": "https://stackoverflow.com/users/5473726/sorush-purabdi"}, "is_accepted": false, "score": 1, "last_activity_date": 1566001306, "creation_date": 1566001306, "answer_id": 57532396, "question_id": 33328000, "link": "https://stackoverflow.com/questions/33328000/reading-multiple-elements-from-a-channel-in-go/57532396#57532396", "title": "Reading multiple elements from a channel in Go", "body": "<p>Try this (for channel <code>ch</code> with type <code>T</code>):</p>\n\n<pre><code>for firstItem := range ch {                      // For ensure that any batch could not be empty\n    var itemsBatch []T\n    itemsBatch = append(itemsBatch, firstItem)\nRemaining: \n    for len(itemsBatch) &lt; BATCHSIZE {            // For control maximum size of batch\n        select {\n        case item := &lt;-ch:\n            itemsBatch = append(itemsBatch, item)\n        default:\n            break Remaining\n        }\n    }\n    // Consume itemsBatch here...\n}\n</code></pre>\n\n<p>But, if <code>BATCHSIZE</code> is constant, this code would be more efficient:</p>\n\n<pre><code>var i int\nitemsBatch := [BATCHSIZE]T{}\nfor firstItem := range ch {                      // For ensure that any batch could not be empty\n    itemsBatch[0] = firstItem\nRemaining:\n    for i = 1; i &lt; BATCHSIZE; i++ {              // For control maximum size of batch\n        select {\n        case itemsBatch[i] = &lt;-ch:\n        default:\n            break Remaining\n        }\n    }\n    // Now you have itemsBatch with length i &lt;= BATCHSIZE;\n    // Consume that here...\n}\n</code></pre>\n"}], "owner": {"reputation": 78861, "user_id": 561309, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6d833d9f0ffa2265a01359ccecd26d54?s=128&d=identicon&r=PG&f=1", "display_name": "laurent", "link": "https://stackoverflow.com/users/561309/laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2260, "favorite_count": 0, "accepted_answer_id": 34122681, "answer_count": 5, "score": 4, "last_activity_date": 1566001306, "creation_date": 1445764259, "question_id": 33328000, "link": "https://stackoverflow.com/questions/33328000/reading-multiple-elements-from-a-channel-in-go", "title": "Reading multiple elements from a channel in Go", "body": "<p>I'm reading values from a channel in a loop like this:</p>\n\n<pre><code>for {\n    capturedFrame := &lt;-capturedFrameChan\n    remoteCopy(capturedFrame)\n}\n</code></pre>\n\n<p>To make it more efficient, I would like to read these values in a batch, with something like this (pseudo-code):</p>\n\n<pre><code>for {\n    capturedFrames := &lt;-capturedFrameChan\n    multipleRemoteCopy(capturedFrames)\n}\n</code></pre>\n\n<p>But I'm not sure how to do that. If I call <code>capturedFrames := &lt;-capturedFrameChan</code> multiple times it's going to block.</p>\n\n<p>Basically, what I would like is to read all the available values in <code>captureFrameChan</code> and, if none is available, it blocks as usual.</p>\n\n<p>What would be the way to accomplish this in Go?</p>\n"}, {"tags": ["select", "go", "channel"], "answers": [{"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": true, "score": 0, "last_activity_date": 1445763743, "creation_date": 1445763743, "answer_id": 33327915, "question_id": 33327201, "link": "https://stackoverflow.com/questions/33327201/go-golang-select-statement-cannot-receive-sended-value/33327915#33327915", "title": "Go Golang select statement cannot receive sended value", "body": "<p>Using <a href=\"http://pro-tips-dot-com.tumblr.com/post/47677612115/kill-a-hung-go-process-and-print-stack-traces\" rel=\"nofollow\"><code>kill -ABRT &lt;PID&gt;</code></a> you can see that all your Workers are blocked on <code>done &lt;- w</code> while your Balancer is blocked on <code>w.request &lt;- req</code>, creating a deadlock (workers can't go further until the balancer receives their \"done\" signals, and the balancer can't go further until the selected worker takes the request).</p>\n\n<p>If you replace <code>done &lt;- w</code> by <code>go func() { done &lt;- w }()</code>, you can see that your program will process the 16 requests without hanging.</p>\n\n<p>Side note: instead of <code>time.Sleep(200000 * time.Millisecond)</code>, look into <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow\"><code>sync.WaitGroup</code></a></p>\n"}], "owner": {"reputation": 13, "user_id": 5485303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85ba5daaa71e15b0b766a8cb15a3e0bd?s=128&d=identicon&r=PG&f=1", "display_name": "user5485303", "link": "https://stackoverflow.com/users/5485303/user5485303"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 33327915, "answer_count": 1, "score": 1, "last_activity_date": 1445763743, "creation_date": 1445757434, "question_id": 33327201, "link": "https://stackoverflow.com/questions/33327201/go-golang-select-statement-cannot-receive-sended-value", "title": "Go Golang select statement cannot receive sended value", "body": "<p>I'm new to Go and trying to implement a simple load balancer as seen in this slides:\n<a href=\"http://concur.rspace.googlecode.com/hg/talk/concur.html#slide-42\" rel=\"nofollow\">http://concur.rspace.googlecode.com/hg/talk/concur.html#slide-42</a></p>\n\n<p>The complete code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"container/heap\"\n)\n\ntype Request struct {\n    fn func(*Worker) int\n    c  chan int\n}\n\nfunc requester(work chan &lt;-Request) {\n    c := make(chan int)\n    work &lt;- Request{workFn, c}\n    result := &lt;-c\n    furtherProcess(result)\n}\n\nfunc workFn(w *Worker) int {\n    time.Sleep(1000 * time.Millisecond)\n    return w.index\n}\n\nfunc furtherProcess(result int) {\n    fmt.Println(result)\n}\n\ntype Worker struct {\n    request chan Request\n    pending int\n    index   int\n}\n\nfunc (w *Worker) work(done chan *Worker) {\n    for req := range w.request {\n        req.c &lt;- req.fn(w)\n        fmt.Println(\"sending to done:\", done)\n        done &lt;- w\n        fmt.Println(\"sended to done\")\n    }\n}\n\ntype Pool []*Worker\n\ntype Balancer struct {\n    pool Pool\n    done chan *Worker\n}\n\nfunc (b *Balancer) balance(work chan Request) {\n    for {\n        fmt.Println(\"selecting, done:\", b.done)\n        select {\n        case req := &lt;-work:\n            b.dispatch(req)\n        case w := &lt;-b.done:\n            fmt.Println(\"completed\")\n            b.completed(w)\n        }\n    }\n}\n\nfunc (p Pool) Len() int {\n    return len(p)\n}\n\nfunc (p Pool) Less(i, j int) bool {\n    return p[i].pending &lt; p[j].pending\n}\n\nfunc (p Pool) Swap(i, j int) {\n    p[i], p[j] = p[j], p[i]\n}\n\nfunc (p *Pool) Push(x interface{}) {\n    *p = append(*p, x.(*Worker))\n}\n\nfunc (p *Pool) Pop() interface{} {\n    old := *p\n    n := len(old)\n    x := old[n - 1]\n    *p = old[0 : n - 1]\n    return x\n}\n\nfunc (b *Balancer) dispatch(req Request) {\n    w := heap.Pop(&amp;b.pool).(*Worker)\n    w.request &lt;- req\n    w.pending++\n    heap.Push(&amp;b.pool, w)\n    fmt.Println(\"dispatched to worker\", w.index)\n}\n\nfunc (b *Balancer) completed(w *Worker) {\n    w.pending--\n    heap.Remove(&amp;b.pool, w.index)\n    heap.Push(&amp;b.pool, w)\n}\n\nfunc Run() {\n    NumWorkers := 4\n    req := make(chan Request)\n    done := make(chan *Worker)\n    b := Balancer{make([]*Worker, NumWorkers), done}\n    for i := 0; i &lt; NumWorkers; i++ {\n        w := Worker{make(chan Request), 0, i}\n        b.pool[i] = &amp;w\n        go w.work(done)\n    }\n    go b.balance(req)\n    for i := 0; i &lt; NumWorkers * 4; i++ {\n        go requester(req)\n    }\n    time.Sleep(200000 * time.Millisecond)\n}\n\nfunc main() {\n    Run()\n}\n</code></pre>\n\n<p>When I ran it, I got following outputs:</p>\n\n<pre><code>selecting, done: 0xc0820082a0\ndispatched to worker 0\nselecting, done: 0xc0820082a0\ndispatched to worker 3\nselecting, done: 0xc0820082a0\ndispatched to worker 2\nselecting, done: 0xc0820082a0\ndispatched to worker 1\nselecting, done: 0xc0820082a0\nsending to done: 0xc0820082a0\nsending to done: 0xc0820082a0\n3\nsending to done: 0xc0820082a0\n2\n1\n0\nsending to done: 0xc0820082a0\n</code></pre>\n\n<p>As you can see, it was selecting on and sending to the same pipe (done: 0xc0820082a0), but the select didn't receive the sended value and was blocking forever. How could this happen? What's the problem with the above code? Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1510589324, "post_id": 33325395, "comment_id": 81487988, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/15926697/what-is-the-less-than-followed-by-dash-operator-in-go-language\">what is the &quot;less than followed by dash&quot; operator in go language?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13306, "user_id": 162698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HnjBG.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/162698/rob"}, "is_accepted": true, "score": 9, "last_activity_date": 1445782209, "last_edit_date": 1445782209, "creation_date": 1445739404, "answer_id": 33325500, "question_id": 33325395, "link": "https://stackoverflow.com/questions/33325395/what-is-the-difference-between-and-in-golang/33325500#33325500", "title": "What is the difference between = and &lt;- in golang", "body": "<p>This is related to channels in Go. You are thinking it's related to assignment as in other languages. In your code, a value \"j\" is being sent to the channel \"jobs\". </p>\n\n<p><a href=\"https://gobyexample.com/channels\" rel=\"noreferrer\">https://gobyexample.com/channels</a></p>\n"}, {"tags": [], "owner": {"reputation": 3115, "user_id": 994614, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/UsVRm.png?s=128&g=1", "display_name": "Kaicui", "link": "https://stackoverflow.com/users/994614/kaicui"}, "is_accepted": false, "score": 5, "last_activity_date": 1445742839, "creation_date": 1445742839, "answer_id": 33325787, "question_id": 33325395, "link": "https://stackoverflow.com/questions/33325395/what-is-the-difference-between-and-in-golang/33325787#33325787", "title": "What is the difference between = and &lt;- in golang", "body": "<ul>\n<li>\"=\" is assignment,just like other language.</li>\n<li>&lt;- is a operator only work with <strong>channel</strong>,it means <strong>put</strong> or <strong>get</strong> a message from a channel.</li>\n<li><strong>channel</strong> is an important concept in go,especially in concurrent programming.you can try this <a href=\"https://tour.golang.org/concurrency/2\" rel=\"noreferrer\">Channel TourPage</a>  to see its using scene.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "is_accepted": false, "score": 9, "last_activity_date": 1445742867, "creation_date": 1445742867, "answer_id": 33325789, "question_id": 33325395, "link": "https://stackoverflow.com/questions/33325395/what-is-the-difference-between-and-in-golang/33325789#33325789", "title": "What is the difference between = and &lt;- in golang", "body": "<p>The <a href=\"https://golang.org/ref/spec#Assignments\" rel=\"noreferrer\">= operator</a> deals with variable assignment as in most languages. It expresses the idea of wanting to update the value that an identifier references. The <a href=\"https://golang.org/ref/spec#Receive_operator\" rel=\"noreferrer\"><code>&lt;-</code> operator</a> represents the idea of passing a value from a channel to a reference. If you think of the channel as a queue using an assignment operator <code>=</code> would assign the reference to the queue to the target variable. The receive operator <code>&lt;-</code> is equivalent to dequeuing from the queue and assigning the value of the item to the target variable.</p>\n\n<p>You cannot use the operators interchangeably because of a type mismatch. Please note the links to the Go specification which speak at greater length to the operators.  </p>\n"}], "owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6809, "favorite_count": 2, "accepted_answer_id": 33325500, "answer_count": 3, "score": 6, "last_activity_date": 1445782209, "creation_date": 1445738358, "question_id": 33325395, "link": "https://stackoverflow.com/questions/33325395/what-is-the-difference-between-and-in-golang", "title": "What is the difference between = and &lt;- in golang", "body": "<pre><code>func worker(id int, jobs &lt;-chan int, results chan&lt;- int) {\n    for j := range jobs {\n        fmt.Println(\"worker\", id, \"processing job\", j)\n        time.Sleep(time.Second)\n        results &lt;- j * 2\n    }\n}\n\nfunc main() {\n    t := time.Now()\n    fmt.Println(t)\n    jobs := make(chan int, 100)\n    results := make(chan int, 100)\n    for w := 1; w &lt;= 4; w++ {\n        go worker(w, jobs, results)\n    }\n    for j := 1; j &lt;= 20; j++ {\n        jobs &lt;- j\n    }\n    close(jobs)\n    for a := 1; a &lt;= 20; a++ {\n        &lt;-results\n    }\n\n    t = time.Now()\n    fmt.Println(t)\n}\n</code></pre>\n\n<p>I am confused of the \"&lt;-\" and I can not find any related documents about \"&lt;-\". So what is the difference between &lt;- and =?? why I can not use = here?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1445740726, "post_id": 33324912, "comment_id": 54448927, "body": "This doesn&#39;t answer your question, but paints a more complete picture: <a href=\"http://play.golang.org/p/WkvIZ5I1b1\" rel=\"nofollow noreferrer\">play.golang.org/p/WkvIZ5I1b1</a>. Running in the playground gives all 0.00 ns/op for some reason. On my machine, when the length is a literal 8, constant 8, sum of two literals adding up to 8, or sum of a constant and a literal adding up to 8, they&#39;re all about the same, roughly 1.45 ns/op.  When the length is a variable 8, or a variable plus a literal summing to 8, they&#39;re about the same, much slower than the previous group, roughly 91 ns/op. To run it, paste the contents into a file and simply <code>go run PATH_TO_FILE</code>."}], "answers": [{"comments": [{"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 2, "creation_date": 1445778667, "post_id": 33326587, "comment_id": 54456902, "body": "Do you know why in the second case the compiler doesn\u2019t perform constant propagation on <code>7 + length</code> and generate the same code? Is this just something that Go doesn\u2019t (currently) do, or is it something that can\u2019t be done?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 2, "creation_date": 1445780224, "post_id": 33326587, "comment_id": 54457401, "body": "@matt: Since the value of <code>7 + length</code> is a runtime variable expression, the compiler has to conduct a data flow analysis to prove that the only value it has for <code>make([], 7+length</code> is 8. If we write <code>const length = 1</code> it&#39;s easy. If we write, as is the case here, <code>var length = 1</code> it&#39;s harder and time consuming. The first step is an SSA compiler: <a href=\"https://en.wikipedia.org/wiki/Static_single_assignment_form\" rel=\"nofollow noreferrer\">Static single assignment form</a>. Now that the <code>gc</code> compiler is written in Go, an SSA <code>gc</code> compiler for Go is under development: <a href=\"https://go.googlesource.com/go/+/dev.ssa\" rel=\"nofollow noreferrer\">dev.ssa</a>."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 14, "last_activity_date": 1445777307, "last_edit_date": 1445777307, "creation_date": 1445751416, "answer_id": 33326587, "question_id": 33324912, "link": "https://stackoverflow.com/questions/33324912/golang-make-slice-performance/33326587#33326587", "title": "Golang: make slice performance", "body": "<p>The constant expression <code>8</code> is evaluated at compile time. The <code>make</code> is allocated on a goroutine stack (cheap). The variable expression <code>7 + length</code> is evaluated at run time. The <code>make</code> is allocated on the program heap (expensive). If the <code>make</code> size is too large for a stack allocation (for example, constant <code>(64*1024)</code> and variable <code>(64*1024-1)+length</code>) then both allocations are made on the heap and the benchmark times are the same.</p>\n\n<pre><code>$ go tool compile -m a_test.go\na_test.go:5: Benchmark1 b does not escape\na_test.go:7: Benchmark1 make([]byte, 8) does not escape\na_test.go:14: make([]byte, 7 + length) escapes to heap\na_test.go:11: Benchmark2 b does not escape\n$ \n</code></pre>\n\n<p><code>a_test.go</code>:</p>\n\n<pre><code>package a\n\nimport \"testing\"\n\nfunc Benchmark1(b *testing.B) {\n    for n := 0; n &lt; b.N; n++ {\n        _ = make([]byte, 8)\n    }\n}\n\nfunc Benchmark2(b *testing.B) {\n    length := 1\n    for n := 0; n &lt; b.N; n++ {\n        _ = make([]byte, 7+length)\n    }\n}\n</code></pre>\n\n<p>Go pseudo-assembler:</p>\n\n<pre><code>$ go tool compile -S a_test.go\n</code></pre>\n\n<p>Benchmark1:</p>\n\n<pre><code>\"\".Benchmark1 t=1 size=112 value=0 args=0x8 locals=0x20\n    0x0000 00000 (a_test.go:5)  TEXT    \"\".Benchmark1(SB), $32-8\n    0x0000 00000 (a_test.go:5)  SUBQ    $32, SP\n    0x0004 00004 (a_test.go:5)  MOVQ    \"\".b+40(FP), CX\n    0x0009 00009 (a_test.go:5)  FUNCDATA    $0, gclocals\u00b787d20ce1b58390b294df80b886db78bf(SB)\n    0x0009 00009 (a_test.go:5)  FUNCDATA    $1, gclocals\u00b7790e5cc5051fc0affc980ade09e929ec(SB)\n    0x0009 00009 (a_test.go:6)  MOVQ    $0, AX\n    0x000b 00011 (a_test.go:6)  NOP\n    0x000b 00011 (a_test.go:6)  MOVQ    112(CX), BX\n    0x000f 00015 (a_test.go:6)  CMPQ    BX, AX\n    0x0012 00018 (a_test.go:6)  JLE $0, 98\n    0x0014 00020 (a_test.go:7)  MOVQ    $0, BX\n    0x0016 00022 (a_test.go:7)  MOVB    BL, \"\".autotmp_0001(SP)\n    0x0019 00025 (a_test.go:7)  MOVB    BL, \"\".autotmp_0001+1(SP)\n    0x001d 00029 (a_test.go:7)  MOVB    BL, \"\".autotmp_0001+2(SP)\n    0x0021 00033 (a_test.go:7)  MOVB    BL, \"\".autotmp_0001+3(SP)\n    0x0025 00037 (a_test.go:7)  MOVB    BL, \"\".autotmp_0001+4(SP)\n    0x0029 00041 (a_test.go:7)  MOVB    BL, \"\".autotmp_0001+5(SP)\n    0x002d 00045 (a_test.go:7)  MOVB    BL, \"\".autotmp_0001+6(SP)\n    0x0031 00049 (a_test.go:7)  MOVB    BL, \"\".autotmp_0001+7(SP)\n    0x0035 00053 (a_test.go:7)  LEAQ    \"\".autotmp_0001(SP), BX\n    0x0039 00057 (a_test.go:7)  CMPQ    BX, $0\n    0x003d 00061 (a_test.go:7)  JEQ $1, 103\n    0x003f 00063 (a_test.go:7)  MOVQ    $8, \"\".autotmp_0002+16(SP)\n    0x0048 00072 (a_test.go:7)  MOVQ    $8, \"\".autotmp_0002+24(SP)\n    0x0051 00081 (a_test.go:7)  MOVQ    BX, \"\".autotmp_0002+8(SP)\n    0x0056 00086 (a_test.go:6)  INCQ    AX\n    0x0059 00089 (a_test.go:6)  NOP\n    0x0059 00089 (a_test.go:6)  MOVQ    112(CX), BX\n    0x005d 00093 (a_test.go:6)  CMPQ    BX, AX\n    0x0060 00096 (a_test.go:6)  JGT $0, 20\n    0x0062 00098 (a_test.go:9)  ADDQ    $32, SP\n    0x0066 00102 (a_test.go:9)  RET\n    0x0067 00103 (a_test.go:7)  MOVL    AX, (BX)\n    0x0069 00105 (a_test.go:7)  JMP 63\n</code></pre>\n\n<p><code>Benchmark2</code>:</p>\n\n<pre><code>\"\".Benchmark2 t=1 size=144 value=0 args=0x8 locals=0x58\n    0x0000 00000 (a_test.go:11) TEXT    \"\".Benchmark2(SB), $88-8\n    0x0000 00000 (a_test.go:11) MOVQ    (TLS), CX\n    0x0009 00009 (a_test.go:11) CMPQ    SP, 16(CX)\n    0x000d 00013 (a_test.go:11) JLS 129\n    0x000f 00015 (a_test.go:11) SUBQ    $88, SP\n    0x0013 00019 (a_test.go:11) FUNCDATA    $0, gclocals\u00b787d20ce1b58390b294df80b886db78bf(SB)\n    0x0013 00019 (a_test.go:11) FUNCDATA    $1, gclocals\u00b7790e5cc5051fc0affc980ade09e929ec(SB)\n    0x0013 00019 (a_test.go:12) MOVQ    $1, \"\".length+56(SP)\n    0x001c 00028 (a_test.go:13) MOVQ    $0, AX\n    0x001e 00030 (a_test.go:13) MOVQ    \"\".b+96(FP), BP\n    0x0023 00035 (a_test.go:13) NOP\n    0x0023 00035 (a_test.go:13) MOVQ    112(BP), BX\n    0x0027 00039 (a_test.go:13) MOVQ    AX, \"\".n+48(SP)\n    0x002c 00044 (a_test.go:13) CMPQ    BX, AX\n    0x002f 00047 (a_test.go:13) JLE $0, 124\n    0x0031 00049 (a_test.go:14) MOVQ    \"\".length+56(SP), AX\n    0x0036 00054 (a_test.go:14) ADDQ    $7, AX\n    0x003a 00058 (a_test.go:14) LEAQ    type.[]uint8(SB), BX\n    0x0041 00065 (a_test.go:14) MOVQ    BX, (SP)\n    0x0045 00069 (a_test.go:14) MOVQ    AX, 8(SP)\n    0x004a 00074 (a_test.go:14) MOVQ    AX, 16(SP)\n    0x004f 00079 (a_test.go:14) PCDATA  $0, $0\n    0x004f 00079 (a_test.go:14) CALL    runtime.makeslice(SB)\n    0x0054 00084 (a_test.go:14) MOVQ    24(SP), BX\n    0x0059 00089 (a_test.go:14) MOVQ    BX, \"\".autotmp_0005+64(SP)\n    0x005e 00094 (a_test.go:14) MOVQ    32(SP), BX\n    0x0063 00099 (a_test.go:14) MOVQ    BX, \"\".autotmp_0005+72(SP)\n    0x0068 00104 (a_test.go:14) MOVQ    40(SP), BX\n    0x006d 00109 (a_test.go:14) MOVQ    BX, \"\".autotmp_0005+80(SP)\n    0x0072 00114 (a_test.go:13) MOVQ    \"\".n+48(SP), AX\n    0x0077 00119 (a_test.go:13) INCQ    AX\n    0x007a 00122 (a_test.go:13) NOP\n    0x007a 00122 (a_test.go:13) JMP 30\n    0x007c 00124 (a_test.go:16) ADDQ    $88, SP\n    0x0080 00128 (a_test.go:16) RET\n    0x0081 00129 (a_test.go:11) CALL    runtime.morestack_noctxt(SB)\n    0x0086 00134 (a_test.go:11) JMP 0\n</code></pre>\n"}], "owner": {"reputation": 875, "user_id": 1213341, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f8d3dc6ff251858d56451294f2efbbcc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1213341/anton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1099, "favorite_count": 8, "accepted_answer_id": 33326587, "answer_count": 1, "score": 13, "last_activity_date": 1445777307, "creation_date": 1445733675, "question_id": 33324912, "link": "https://stackoverflow.com/questions/33324912/golang-make-slice-performance", "title": "Golang: make slice performance", "body": "<p>Why these benchmark results are so different?</p>\n\n<pre><code>func Benchmark1(b *testing.B) {\n    for n := 0; n &lt; b.N; n++ {\n        _ = make([]byte, 8)\n    }\n}\n\nfunc Benchmark2(b *testing.B) {\n    length := 1\n    for n := 0; n &lt; b.N; n++ {\n        _ = make([]byte, 7+length)\n    }\n}\n</code></pre>\n\n<p>Benchmark results:</p>\n\n<pre><code>Benchmark1-8                    500000000            3.37 ns/op\nBenchmark2-8                    30000000            50.6 ns/op\n</code></pre>\n"}, {"tags": ["go", "websocket", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 684, "user_id": 5017647, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/af8091d51c64e0558d5b600a3cbde430?s=128&d=identicon&r=PG&f=1", "display_name": "Whiteclaws", "link": "https://stackoverflow.com/users/5017647/whiteclaws"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1445779383, "post_id": 33325723, "comment_id": 54457126, "body": "Check the Origin header of the WebSocket handshake request on the server, since that header was designed to protect the server against attacker-initiated cross-site connections of victim browsers! Use session-individual random tokens (like CSRF-Tokens) on the handshake request and verify them on the server.that is a quote from a websocket security blog i was reading.And so doesn&#39;t the empty CheckOrigin function cause any security vulnerabilities? @CodingPickle"}, {"owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "reply_to_user": {"reputation": 684, "user_id": 5017647, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/af8091d51c64e0558d5b600a3cbde430?s=128&d=identicon&r=PG&f=1", "display_name": "Whiteclaws", "link": "https://stackoverflow.com/users/5017647/whiteclaws"}, "edited": false, "score": 1, "creation_date": 1445786953, "post_id": 33325723, "comment_id": 54459648, "body": "@Whiteclaws If you want to use the default CheckOrigin function you need to ensure that your client library includes the Origin header with it&#39;s request. If you update the question to include your architecture I can update my answer to reflect the update."}], "tags": [], "owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "is_accepted": true, "score": 4, "last_activity_date": 1445741990, "creation_date": 1445741990, "answer_id": 33325723, "question_id": 33323337, "link": "https://stackoverflow.com/questions/33323337/update-send-the-origin-header-with-js-websockets/33325723#33325723", "title": "Update: Send the origin header with js websockets", "body": "<p>Reading through the <a href=\"https://godoc.org/github.com/gorilla/websocket\" rel=\"nofollow\">Gorilla WebSocket Documentation</a> indicates that when a nil value is provided for the <code>CheckOrigin</code> field of an <a href=\"https://godoc.org/github.com/gorilla/websocket#Upgrader\" rel=\"nofollow\"><code>Upgrader</code></a> type a safe default is used. The default checks the <strong>Origin</strong> field of the incoming request with the <strong>Host</strong> header value to confirm they are equal before allowing the request. The documentation indicates that browsers do not enforce cross origin validity and it is the responsibility of the server application to enforce. You can see exactly how this is done in the <a href=\"https://github.com/gorilla/websocket/blob/master/server.go#L61\" rel=\"nofollow\">source code</a> for the Gorilla library.</p>\n\n<p>The documentation and source indicate an <a href=\"https://godoc.org/github.com/gorilla/websocket#Upgrade\" rel=\"nofollow\"><code>Upgrade</code></a> function in the <code>websocket</code> package that acts as a factory for your example code above. <a href=\"https://github.com/gorilla/websocket/blob/master/server.go#L223\" rel=\"nofollow\">The factory function</a> takes a custom buffer size and overrides the CheckOrigin to always return true. Instead of creating a custom <code>Upgrader</code> you can use this factory function in the <code>HttpHandler</code> to upgrade your connections.</p>\n\n<pre><code>func webSocketHandler(w http.ResponseWriter, r *http.Request) {\n    conn, err := websocket.Upgrade(w, r, nil, 1024, 1024)\n    defer conn.Close()\n\n    if err != nil {\n        http.Error(w, err, http.StatusInternalServerError)\n        return\n    }\n\n    conn.WriteMessage(websocket.TextMessage, []byte(\"Hello, world!\"))\n}\n</code></pre>\n"}], "owner": {"reputation": 684, "user_id": 5017647, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/af8091d51c64e0558d5b600a3cbde430?s=128&d=identicon&r=PG&f=1", "display_name": "Whiteclaws", "link": "https://stackoverflow.com/users/5017647/whiteclaws"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4497, "favorite_count": 0, "accepted_answer_id": 33325723, "answer_count": 1, "score": 2, "last_activity_date": 1445795554, "creation_date": 1445720720, "last_edit_date": 1445795554, "question_id": 33323337, "link": "https://stackoverflow.com/questions/33323337/update-send-the-origin-header-with-js-websockets", "title": "Update: Send the origin header with js websockets", "body": "<p>I've been playing around with gorilla-websocket in Go, and as I implemented the basic echo example, I logged an error after deploying the server,</p>\n\n<blockquote>\n  <p>Origin is not found\n  Websocket version != 13</p>\n</blockquote>\n\n<p>I found a way to bypass this by making the function that checks the origin always return true</p>\n\n<pre><code>var wsUpgrader = websocket.Upgrader{\n    ReadBufferSize:  1024,\n    WriteBufferSize: 1024,\n    CheckOrigin: func(r *http.Request) bool {\n        return true\n    },\n}\n</code></pre>\n\n<p>But it doesn't feel right. Therefore, I am looking for a way to fix that issue.</p>\n\n<p>Update: After having another look at the issue it seems like I'm actually looking to add the origin header to the client implementation which is the javascript websocket implementation</p>\n\n<p>@benjic\nIm connecting to the websocket via a javascript html5 application that isn't hosted on the same server but is run locally by me via chrome</p>\n\n<p>So how do I do that.</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore", "blobstore"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1445731876, "post_id": 33322260, "comment_id": 54447132, "body": "Generally, you want to follow that link to their <a href=\"https://cloud.google.com/storage/\" rel=\"nofollow noreferrer\">Cloud Storage API</a> (think &quot;Amazon S3, but by Google&quot;) and use that. More links: <a href=\"https://cloud.google.com/storage/docs/json_api/v1/json-api-go-samples\" rel=\"nofollow noreferrer\">Go samples</a>, <a href=\"https://godoc.org/google.golang.org/api/storage/v1\" rel=\"nofollow noreferrer\">reference for the package</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1728, "user_id": 1628065, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uhAcU.png?s=128&g=1", "display_name": "drtf", "link": "https://stackoverflow.com/users/1628065/drtf"}, "is_accepted": false, "score": 0, "last_activity_date": 1445780157, "creation_date": 1445780157, "answer_id": 33330287, "question_id": 33322260, "link": "https://stackoverflow.com/questions/33322260/i-need-help-updating-this-golang-code-the-methods-in-it-have-been-deprecated-a/33330287#33330287", "title": "I need help updating this Golang code. The methods in it have been deprecated, and I don&#39;t understand the cloud datastore very well", "body": "<p>I'm using the storage api \"google.golang.org/cloud/storage\"</p>\n\n<ol>\n<li><p>You need to create an oauth2 context</p>\n\n<pre><code>func NewCloudStorageContext(c context.Context) context.Context {\nhc := &amp;http.Client{\n    Transport: &amp;oauth2.Transport{\n        Source: google.AppEngineTokenSource(c, storage.ScopeFullControl),\n        Base:   &amp;urlfetch.Transport{Context: c},\n    },\n}\nreturn cloud.NewContext(appengine.AppID(c), hc)}\n</code></pre></li>\n<li><p>Upload data</p>\n\n<pre><code>func Upload(c context.Context, req UploadRequest) (string, error) {\n\n// get CloudStorage Authenticated Context\nctx := NewCloudStorageContext(c)\n\n// generate file name\nfileName := BackupFolder + req.Table + \"/\" + generateFileName(16)\n\n// get default bucket\nbucketName, err := getDefaultBucket(c)\nif err != nil {\n    log.Errorf(c, \"failed to get default GCS bucket name: %v\", err)\n    return fileName, err\n}\n\nlog.Debugf(c, \"Creating file. bucket: %s, file name : %s\", bucketName, fileName)\n\nwc := storage.NewWriter(ctx, bucketName, fileName)\nwc.ContentType = req.FileType\nwc.ACL = []storage.ACLRule{{storage.AllUsers, storage.RoleReader}}\n\ndefer wc.Close()\n//Write file\nif _, err := wc.Write(req.Payload); err != nil {\n    log.Errorf(c, \"createFile: unable to write data to bucket %s, error: %s\", bucketName, err.Error)\n    return fileName, err\n}\nif err := wc.Close(); err != nil {\n    log.Errorf(c, \"createFile: unable to close bucket %s, error : %s\", bucketName, err.Error)\n    return fileName, err\n}\n\nreturn fileName, nil}\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 31, "user_id": 5408290, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xdpHIZL6E1M/AAAAAAAAAAI/AAAAAAAAAPs/rVehYeDh5S8/photo.jpg?sz=128", "display_name": "Marcin", "link": "https://stackoverflow.com/users/5408290/marcin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477975863, "creation_date": 1445714072, "last_edit_date": 1477975863, "question_id": 33322260, "link": "https://stackoverflow.com/questions/33322260/i-need-help-updating-this-golang-code-the-methods-in-it-have-been-deprecated-a", "title": "I need help updating this Golang code. The methods in it have been deprecated, and I don&#39;t understand the cloud datastore very well", "body": "<p>Can anyone help me rewrite this function.  The methods in it have been deprecated, but I don't understand enough about Google's datastore  to update this code.  <a href=\"https://cloud.google.com/appengine/docs/deprecations/files_api\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/deprecations/files_api</a></p>\n\n<pre><code>func uploadBlob(w http.ResponseWriter, r *http.Request) {\n    bodyData, error := ioutil.ReadAll(r.Body)\n    fileType := r.URL.Query()[\"type\"][0]\n\n    var mimeType string\n\n    if fileType == \"png\" {\n        mimeType = \"image/png\"\n    } else {\n        mimeType = \"application/pdf\"\n    }\n\n    context := appengine.NewContext(r)\n\n    writer, error := blobstore.Create(context, mimeType)\n    if error != nil {\n        return\n    }\n\n    _, error = writer.Write(bodyData)\n    if error != nil {\n        return\n    }\n\n    error = writer.Close()\n    if error != nil {\n        return\n    }\n\n    var k appengine.BlobKey\n    k, _ = writer.Key()\n\n    encoder := json.NewEncoder(w)\n    encoder.Encode(&amp;UploadBlobResponse{ Key: string(k) })\n}\n</code></pre>\n\n<p>Thanks in advance.  If you'd need more information let me know.  The package is short so I can probably link all of it.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 3, "last_activity_date": 1445716085, "creation_date": 1445716085, "answer_id": 33322602, "question_id": 33321893, "link": "https://stackoverflow.com/questions/33321893/golang-log-fatal-change-line-number-in-fatal-error/33322602#33322602", "title": "Golang log.Fatal change line number in fatal error", "body": "<p>you can get the line number of whatever called your fatal function using <a href=\"https://golang.org/pkg/runtime/#Caller\" rel=\"nofollow\"><code>runtime.Caller(1)</code></a></p>\n\n<p>Here's an example on <a href=\"http://play.golang.org/p/0pv7fJlWiD\" rel=\"nofollow\">Play</a></p>\n"}], "owner": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "accepted_answer_id": 33322602, "answer_count": 1, "score": 2, "last_activity_date": 1445716085, "creation_date": 1445711889, "question_id": 33321893, "link": "https://stackoverflow.com/questions/33321893/golang-log-fatal-change-line-number-in-fatal-error", "title": "Golang log.Fatal change line number in fatal error", "body": "<p>This program emits\n<code>app: 2015/10/24 11:28:15 example.go:22: open some-crazy-non-existent-file: no such file or directory</code>\nwhich corresponds to a line inside the <code>fatal</code> function\ninstead of inside <code>main</code> where the error is logically being generated/handled. I have a lot of repetitive error handling code that I want to wrap in a function, but I don't want to lose the convenience of informative line numbers. How do I make my <code>fatal</code> function transparent to whatever mechanism associates line numbers with log messages, or generate the line number earlier?</p>\n\n<p>This would be a wonderful use of a preprocessor / macro system if golang had one</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n)\n\n// logger configured to emit app name, line number, timestamps etc.\nvar mylog = log.New(os.Stderr, \"app: \", log.LstdFlags|log.Lshortfile)\n\n// in order to avoid repetitive error handling code like\n//\n// result, err := someOperation(argument0, argument1)\n// if err != nil {\n//     mylog.Fatal(err)\n// }\n//\n// I defined the following function\n\nfunc fatal(err error) {\n    if err != nil {\n        mylog.Fatal(err)\n    }\n}\n\nfunc main() {\n    _, err := os.Open(\"some-crazy-non-existent-file\")\n    fatal(err)\n}\n</code></pre>\n"}, {"tags": ["image", "go", "base64"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1445700336, "post_id": 33319759, "comment_id": 54437603, "body": "I don&#39;t think you are not receiving valid base64 data. Running <code>echo -n &quot;iVkhdfjdAjdfirtn=&quot; | base64 -d &gt; image.png</code> also indicates your data is invalid."}, {"owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1445700414, "post_id": 33319759, "comment_id": 54437634, "body": "Thtat was an example the dataurl Im getting is massive to put it here"}], "answers": [{"comments": [{"owner": {"reputation": 534, "user_id": 6192935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-WzVJWA1aLts/AAAAAAAAAAI/AAAAAAAABfQ/FxZhI2PBCBA/photo.jpg?sz=128", "display_name": "Manish Champaneri", "link": "https://stackoverflow.com/users/6192935/manish-champaneri"}, "edited": false, "score": 0, "creation_date": 1504422710, "post_id": 33321592, "comment_id": 79001642, "body": "Can you update this answer that can be used for both jpg and png images"}, {"owner": {"reputation": 1598, "user_id": 2819754, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/326f7b0e36e8bbf46c6442668c6a0749?s=128&d=identicon&r=PG&f=1", "display_name": "John Cargo", "link": "https://stackoverflow.com/users/2819754/john-cargo"}, "reply_to_user": {"reputation": 534, "user_id": 6192935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-WzVJWA1aLts/AAAAAAAAAAI/AAAAAAAABfQ/FxZhI2PBCBA/photo.jpg?sz=128", "display_name": "Manish Champaneri", "link": "https://stackoverflow.com/users/6192935/manish-champaneri"}, "edited": false, "score": 0, "creation_date": 1565544890, "post_id": 33321592, "comment_id": 101379108, "body": "@mchampaneri - just import <code>image&#47;jpeg</code> and use <code>jpeg.DecodeConfig(reader)</code> and you are good to go."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1445711151, "last_edit_date": 1495539886, "creation_date": 1445710031, "answer_id": 33321592, "question_id": 33319759, "link": "https://stackoverflow.com/questions/33319759/go-base64-image-decode/33321592#33321592", "title": "Go base64 image decode", "body": "<p>What you have is a <a href=\"https://en.wikipedia.org/wiki/Data_URI_scheme\" rel=\"nofollow noreferrer\">Data URI scheme</a>, info on how to decode it and more on this is in this question and answer:</p>\n\n<p><strong><a href=\"https://stackoverflow.com/questions/31031589/illegal-base64-data-at-input-byte-4-when-using-base64-stdencoding-decodestrings\">Illegal base64 data at input byte 4 when using base64.StdEncoding.DecodeString(str)</a></strong></p>\n\n<p>But note that <a href=\"https://golang.org/pkg/image/#DecodeConfig\" rel=\"nofollow noreferrer\"><code>image.Decodeconfig()</code></a> will only decode image formats that are registered prior to calling this function, so you need the image format handlers to be registered in advance. This can be done with imports like</p>\n\n<pre><code>import _ \"image/png\"\n</code></pre>\n\n<p>More on this is in the package doc of <a href=\"https://golang.org/pkg/image/\" rel=\"nofollow noreferrer\"><code>image</code></a>. Or if you know the exact format (e.g. in your example it's PNG), you can directly use <a href=\"https://golang.org/pkg/image/png/#DecodeConfig\" rel=\"nofollow noreferrer\"><code>png.DecodeConfig()</code></a>.</p>\n\n<p>So it doesn't work for you because your actual encoded image is of PNG format, but you didn't register the the PNG format handler and so <code>image.DecodeConfig()</code> won't use the PNG handler (and so it will not be able to decode it => <code>\"Unknown image format\"</code>).</p>\n\n<p>Also note that replacing the prefix that is not part of the Base64 encoded image is a poor solution to get rid of it. Instead simply slice the input string:</p>\n\n<pre><code>input := \"data:image/png;base64,iVkhdfjdAjdfirtn=\"\nb64data := input[strings.IndexByte(input, ',')+1:]\n</code></pre>\n\n<p>Slicing a string will not even copy the string in memory, it will just create a new (two-word) string header.</p>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4010, "favorite_count": 0, "accepted_answer_id": 33321592, "answer_count": 1, "score": 1, "last_activity_date": 1445711151, "creation_date": 1445700096, "last_edit_date": 1445700440, "question_id": 33319759, "link": "https://stackoverflow.com/questions/33319759/go-base64-image-decode", "title": "Go base64 image decode", "body": "<p>Im currently getting a base64 image data url from a canvas something like this (not the dataurl im getting just to show how the string looks like)</p>\n\n<pre><code>data:image/png;base64,iVkhdfjdAjdfirtn=\n</code></pre>\n\n<p>I need to decode that image to check the width and the height of the image</p>\n\n<pre><code>    dataurl := strings.Replace(req.PostFormValue(\"dataurl\"), \"data:image/png;base64,\", \"\", 1)\n\n    reader := base64.NewDecoder(base64.StdEncoding, strings.NewReader(dataurl))\n    c, _, err := image.DecodeConfig(reader)\n    if err != nil {\n        log.Fatal(err)\n    }\n    log.Println(c.Width)\n</code></pre>\n\n<p>But Im getting an error while trying to decode the config </p>\n\n<pre><code>Unknown image format\n</code></pre>\n\n<p>So yeah the way Im making the dataurl must be wrong but cant figure what to do. I also tried passing the full dataurl (with data:image...) still no success</p>\n"}, {"tags": ["mongodb", "go", "bson"], "answers": [{"tags": [], "owner": {"reputation": 62894, "user_id": 1114486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0513d720af96f4496f4b869fe9579a?s=128&d=identicon&r=PG", "display_name": "Didier Spezia", "link": "https://stackoverflow.com/users/1114486/didier-spezia"}, "is_accepted": true, "score": 3, "last_activity_date": 1445692396, "creation_date": 1445692396, "answer_id": 33318602, "question_id": 33318181, "link": "https://stackoverflow.com/questions/33318181/find-in-db-with-explicitly-excluded-fields/33318602#33318602", "title": "find in db with explicitly excluded fields", "body": "<p>See <a href=\"https://godoc.org/gopkg.in/mgo.v2#Query.Select\" rel=\"nofollow\">https://godoc.org/gopkg.in/mgo.v2#Query.Select</a></p>\n\n<p>You are supposed to use something like:</p>\n\n<pre><code>err := col.Find(nil).Select(bson.M{\"name\": 0}).All(&amp;result)\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 5250918, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a241b785773d58ae2cd8be649f9b97a?s=128&d=identicon&r=PG&f=1", "display_name": "Kaign", "link": "https://stackoverflow.com/users/5250918/kaign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 33318602, "answer_count": 1, "score": 3, "last_activity_date": 1445692396, "creation_date": 1445689642, "question_id": 33318181, "link": "https://stackoverflow.com/questions/33318181/find-in-db-with-explicitly-excluded-fields", "title": "find in db with explicitly excluded fields", "body": "<p>How can I perform this operation :\n<a href=\"https://docs.mongodb.org/manual/reference/method/db.collection.find/#explicitly-excluded-fields\" rel=\"nofollow\">link</a></p>\n\n<p>For example I want to get all documents but without field \"name\":</p>\n\n<pre><code>err := col.Find([]bson.M{{}, {\"name\": false}}).All(&amp;result)\n</code></pre>\n\n<p>In result always will be 0 elements, why?(field name exists in collection)</p>\n"}, {"tags": ["c#", ".net", "go"], "comments": [{"owner": {"reputation": 8321, "user_id": 1213006, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/utGQE.jpg?s=128&g=1", "display_name": "rhughes", "link": "https://stackoverflow.com/users/1213006/rhughes"}, "edited": false, "score": 0, "creation_date": 1445665981, "post_id": 33314958, "comment_id": 54428519, "body": "How are you trying to do this? Can you please show us some code?"}, {"owner": {"reputation": 465, "user_id": 1804335, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/72bd8446992f4ed1ce219792df20adb8?s=128&d=identicon&r=PG&f=1", "display_name": "165plo", "link": "https://stackoverflow.com/users/1804335/165plo"}, "reply_to_user": {"reputation": 8321, "user_id": 1213006, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/utGQE.jpg?s=128&g=1", "display_name": "rhughes", "link": "https://stackoverflow.com/users/1213006/rhughes"}, "edited": false, "score": 0, "creation_date": 1445667124, "post_id": 33314958, "comment_id": 54428713, "body": "I have added the last attempt I made. This version is causing a error when attempting to call go install with   <i>undefined: syscall.NewLazyDLL</i>"}], "answers": [{"tags": [], "owner": {"reputation": 7681, "user_id": 534056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac7bd076b188bae0fd39e6a29b7958e5?s=128&d=identicon&r=PG", "display_name": "ptpaterson", "link": "https://stackoverflow.com/users/534056/ptpaterson"}, "is_accepted": false, "score": 8, "last_activity_date": 1495655793, "creation_date": 1495655793, "answer_id": 44167406, "question_id": 33314958, "link": "https://stackoverflow.com/questions/33314958/can-a-dll-made-in-c-be-used-in-a-golang-application/44167406#44167406", "title": "Can a dll made in c# be used in a golang application", "body": "<p>There is a project on Github that aims to do this.</p>\n\n<p><a href=\"https://github.com/matiasinsaurralde/go-dotnet\" rel=\"noreferrer\">https://github.com/matiasinsaurralde/go-dotnet</a></p>\n\n<p>C# assemblies are not the same as C or C++ and will not load using syscall like we might want.</p>\n"}], "owner": {"reputation": 465, "user_id": 1804335, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/72bd8446992f4ed1ce219792df20adb8?s=128&d=identicon&r=PG&f=1", "display_name": "165plo", "link": "https://stackoverflow.com/users/1804335/165plo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11251, "favorite_count": 2, "answer_count": 1, "score": 12, "last_activity_date": 1542730233, "creation_date": 1445665698, "last_edit_date": 1542730233, "question_id": 33314958, "link": "https://stackoverflow.com/questions/33314958/can-a-dll-made-in-c-be-used-in-a-golang-application", "title": "Can a dll made in c# be used in a golang application", "body": "<p>I have created a basic class that adds two numbers in c#. I have built it into a dll but when attempting to call it in golang I am unsuccessful. </p>\n\n<p>Is this possible currently in golang? If so can someone provide a example how to do this?</p>\n\n<p>Edit: I have included the last attempt I made at doing this. The C# dll is simply a method that adds the two numbers that are passed in.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"syscall\"\n)\n\nfunc main() {\n    var mod = syscall.NewLazyDLL(\"MathForGo.dll\")\n    var proc = mod.NewProc(\"Add\");\n    proc.Call(2,3);\n    fmt.Printf(\"%v\",proc)\n}\n</code></pre>\n"}, {"tags": ["url", "go"], "answers": [{"tags": [], "owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "is_accepted": true, "score": 3, "last_activity_date": 1445700720, "last_edit_date": 1445700720, "creation_date": 1445664861, "answer_id": 33314888, "question_id": 33314790, "link": "https://stackoverflow.com/questions/33314790/equivalent-function-for-url-openstream-in-golang/33314888#33314888", "title": "Equivalent function for url.openStream() in Golang", "body": "<p>Hope this will help:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc Error(err error) {\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n\nfunc main() {\n    response, err := http.Get(\"http://www.oracle.com/\")\n    Error(err)\n\n    defer response.Body.Close()\n\n    contents, err := ioutil.ReadAll(response.Body)\n    Error(err)\n\n    fmt.Printf(\"%s\\n\", contents)\n}\n</code></pre>\n\n<p>For more details: <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow\">https://golang.org/pkg/net/http/</a></p>\n"}], "owner": {"reputation": 3, "user_id": 5158026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6095271211625ea176a995088f118087?s=128&d=identicon&r=PG&f=1", "display_name": "ZORO", "link": "https://stackoverflow.com/users/5158026/zoro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 33314888, "answer_count": 1, "score": -4, "last_activity_date": 1445700720, "creation_date": 1445663907, "last_edit_date": 1445668048, "question_id": 33314790, "link": "https://stackoverflow.com/questions/33314790/equivalent-function-for-url-openstream-in-golang", "title": "Equivalent function for url.openStream() in Golang", "body": "<pre><code>import java.net.*;\nimport java.io.*;\n\npublic class URLReader {\n    public static void main(String[] args) throws Exception {\n\n    URL oracle = new URL(\"http://www.oracle.com/\");\n    BufferedReader in = new BufferedReader(\n    new InputStreamReader(oracle.openStream()));\n\n    String inputLine;\n    while ((inputLine = in.readLine()) != null)\n        System.out.println(inputLine);\n    in.close();\n}\n}\n</code></pre>\n\n<p>I need to do the same in <code>golang</code> i.e read and print the html source code, but cannot find the relation between two, I am a beginner with Go language, thank you in advance</p>\n"}, {"tags": ["struct", "go", "platform"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1445700519, "post_id": 33313210, "comment_id": 54437671, "body": "Put <code>newWindowsSpecifcThing()</code> in an <code>init</code> function within a <code>foo_windows.go</code> file."}], "answers": [{"tags": [], "owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "is_accepted": false, "score": 4, "last_activity_date": 1445649761, "creation_date": 1445649761, "answer_id": 33313570, "question_id": 33313210, "link": "https://stackoverflow.com/questions/33313210/how-to-import-platform-specific-struct/33313570#33313570", "title": "How to import platform-specific struct?", "body": "<p>I think your solution would be to have some method on your struct which is used on all platforms. Look at how the <a href=\"https://golang.org/src/os\" rel=\"nofollow\">dir_*.go</a> files work for the <code>os</code> package. The <code>func (file *File) readdirnames(n int) (names []string, err error)</code> is available on all platforms by providing it in <code>dir_plan9.go</code>, <code>dir_unix.go</code> and <code>dir_windows.go</code>.</p>\n\n<p>For your problem, I'd take the same approach but with some generic method that does <em>internal</em> work. In your application logic you'd call that function and in your <code>file_unix.go</code> file you'd define that function to do nothing (empty body).</p>\n"}, {"tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 3, "last_activity_date": 1445651205, "creation_date": 1445651205, "answer_id": 33313682, "question_id": 33313210, "link": "https://stackoverflow.com/questions/33313210/how-to-import-platform-specific-struct/33313682#33313682", "title": "How to import platform-specific struct?", "body": "<p>Somewhere you clearly have a function that calls <code>newWindowsSpecificThing()</code>. That should be in a Windows-specific file. If it were, then it wouldn't matter that it isn't available. The fact that you have something \"check if it is running on Windows\" suggests a <code>if runtime.GOOS == \"windows\"</code> statement somewhere. Rather than have that, move the entire <code>if</code> into a function that is defined in a Windows-specific file. You'll also need to define that function in a <code>!windows</code> file, which is fine.</p>\n\n<p>As an example from my code, I have a function:</p>\n\n<pre><code>func Setup() *config {\n    var cfg *config\n    // setup portable parts of cfg\n    return PlatformSpecificSetup(cfg)\n}\n</code></pre>\n\n<p>I then have a file marked <code>// +build windows</code> that defines <code>PlatformSpecificSetup()</code> one way, and another marked <code>// +build !windows</code> that defines it another. I never have to check <code>runtime.GOOS</code> and I never have to deal with undefined data types. The <code>config</code> struct itself is defined in those files, so it can have different fields for each platform (as long as they agree enough for <code>Setup()</code>). If I were being more careful, I could create a struct like:</p>\n\n<pre><code>type config struct {\n  // independent stuff\n  plat *platformConfig\n}\n</code></pre>\n\n<p>And then just define <code>platformConfig</code> in each platform file, but in practice I've found that more trouble than it's worth.</p>\n"}], "owner": {"reputation": 63413, "user_id": 193619, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/11e74c6cb64be4d24fdee076ddb374b0?s=128&d=identicon&r=PG", "display_name": "Nathan Osman", "link": "https://stackoverflow.com/users/193619/nathan-osman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 33313682, "answer_count": 2, "score": 0, "last_activity_date": 1445651205, "creation_date": 1445646125, "last_edit_date": 1445647683, "question_id": 33313210, "link": "https://stackoverflow.com/questions/33313210/how-to-import-platform-specific-struct", "title": "How to import platform-specific struct?", "body": "<p>I've got a struct in a file that begins with this line:</p>\n\n<pre><code>// +build windows\n</code></pre>\n\n<p>Therefore it will only be built on Windows. However, the part of the application that initializes everything needs to check if it is running on Windows and if so, create an instance of the struct. I have no idea how to do this without breaking things on other platforms.</p>\n\n<p>For example, if the file contains a function <code>newWindowsSpecificThing()</code> and I compile on Linux, the function won't exist because it is defined in a file that isn't being compiled. (And, of course, this will produce an error.)</p>\n\n<p>How do I work around this dilemma?</p>\n"}, {"tags": ["html", "templates", "go", "escaping"], "comments": [{"owner": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "edited": false, "score": 0, "creation_date": 1445629731, "post_id": 33310283, "comment_id": 54419548, "body": "What <i>is</i> shown when using <code>html&#47;template</code>?"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1445629732, "post_id": 33310283, "comment_id": 54419549, "body": "Put a <code>fmt.Println(&quot;string&quot;)</code> inside your <code>String</code> method and you should see fast if is being called or not. Any chance your Id string has unsafe html string in it?"}, {"owner": {"reputation": 3627, "user_id": 979784, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce4aa9f914ee797e1c8ae6546b86d5e8?s=128&d=identicon&r=PG", "display_name": "wuliwong", "link": "https://stackoverflow.com/users/979784/wuliwong"}, "reply_to_user": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "edited": false, "score": 0, "creation_date": 1445630184, "post_id": 33310283, "comment_id": 54419809, "body": "@EtienneBruines it prints out something like 123 456 789 and our <code>.String()</code> method would output 123-456-789. So, our <code>.String()</code> method basically adds dashes."}, {"owner": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "edited": false, "score": 0, "creation_date": 1445630274, "post_id": 33310283, "comment_id": 54419857, "body": "Explicitly calling <code>.String()</code> for the <code>html&#47;template</code>, does that show the correct version? (doesn&#39;t answer your question, though) -- looking at <a href=\"https://golang.org/src/html/template/template.go?s=3012:3076#L90\" rel=\"nofollow noreferrer\">the code</a> for <code>template.Execute</code>, it seems to use the same function as the <code>text&#47;template</code> part."}, {"owner": {"reputation": 3627, "user_id": 979784, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce4aa9f914ee797e1c8ae6546b86d5e8?s=128&d=identicon&r=PG", "display_name": "wuliwong", "link": "https://stackoverflow.com/users/979784/wuliwong"}, "reply_to_user": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "edited": false, "score": 0, "creation_date": 1445631070, "post_id": 33310283, "comment_id": 54420188, "body": "@EtienneBruines yes, we have tried explicitly calling <code>.String()</code> and it worked."}, {"owner": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "edited": false, "score": 0, "creation_date": 1445631389, "post_id": 33310283, "comment_id": 54420340, "body": "Since <code>html&#47;template</code> should use <code>text&#47;template</code> <code>Parse</code>, this is really weird. My first guess would be that there&#39;s a bug somewhere. What does this output? <code>fmt.Println(fmt.Sprint(thatIdThingyYouWantToFormat))</code>? With dashes, or without? (perhaps they&#39;re using <code>fmt.Sprint</code>)"}, {"owner": {"reputation": 3627, "user_id": 979784, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce4aa9f914ee797e1c8ae6546b86d5e8?s=128&d=identicon&r=PG", "display_name": "wuliwong", "link": "https://stackoverflow.com/users/979784/wuliwong"}, "reply_to_user": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "edited": false, "score": 0, "creation_date": 1445632203, "post_id": 33310283, "comment_id": 54420759, "body": "@EtienneBruines it prints without the dashes."}, {"owner": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1445632537, "post_id": 33310283, "comment_id": 54420928, "body": "Then I would assume it uses <code>fmt.Sprint</code> or something similar, for the output. But looking at their code, I would disagree. Have you confirmed what @captncraig proposed?"}, {"owner": {"reputation": 3627, "user_id": 979784, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce4aa9f914ee797e1c8ae6546b86d5e8?s=128&d=identicon&r=PG", "display_name": "wuliwong", "link": "https://stackoverflow.com/users/979784/wuliwong"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1445633120, "post_id": 33310283, "comment_id": 54421199, "body": "@captncraig I did as you suggested and verified that the <code>.String()</code> method is not being called."}, {"owner": {"reputation": 3627, "user_id": 979784, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce4aa9f914ee797e1c8ae6546b86d5e8?s=128&d=identicon&r=PG", "display_name": "wuliwong", "link": "https://stackoverflow.com/users/979784/wuliwong"}, "reply_to_user": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "edited": false, "score": 0, "creation_date": 1445874491, "post_id": 33310283, "comment_id": 54495253, "body": "@EtienneBruines The <code>String()</code> method was defined with a pointer to the <code>Id</code> attribute. When changed it from using a pointer it now works as expected. I do not feel comfortable submitting it as an answer on Stackoverflow yet as this doesn&#39;t explain why @captncraig&#39;s suggestion didn&#39;t show the <code>String()</code> method was being called for both packages."}], "owner": {"reputation": 3627, "user_id": 979784, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce4aa9f914ee797e1c8ae6546b86d5e8?s=128&d=identicon&r=PG", "display_name": "wuliwong", "link": "https://stackoverflow.com/users/979784/wuliwong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 288, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1445629489, "creation_date": 1445629489, "question_id": 33310283, "link": "https://stackoverflow.com/questions/33310283/what-method-is-called-when-i-display-a-variable-in-a-golang-html-template", "title": "What method is called when I display a variable in a golang html template", "body": "<p>I am trying to figure out what method is called when I show a variable in an \"html/template\" template in Go via <code>{{ .SomeVariable }}</code>.</p>\n\n<p>I am using the package \"html/template\".</p>\n\n<p>I am using this function to render a template:</p>\n\n<pre><code>func renderTemplate(w http.ResponseWriter, tmpl string, p *Page) {\n    t, _ := template.ParseFiles(\"public/\" + tmpl + \".html\")\n    t.Execute(w, p)\n}\n</code></pre>\n\n<p>with </p>\n\n<pre><code>type Page struct {\n    Title  string\n    Users []*model.User\n}\n</code></pre>\n\n<p>and an example template</p>\n\n<pre><code>&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;Listing Users&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;h1&gt;Listing users&lt;/h1&gt;\n\n    {{range .Params}}\n      &lt;h3&gt;\n        id {{.Id }}\n        &amp;nbsp;\n        email {{.Email}}\n        &amp;nbsp;\n         name {{.Name}}\n      &lt;/h3&gt;\n    {{end}}\n\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>We store <code>Id</code> in a certain way and have a <code>.String()</code> method defined for displaying it.</p>\n\n<p>When we use the package \"text/template\" the <code>Id</code> attribute displays correctly but when we use \"html/template\" it does not. My guess is that the former is calling <code>.String()</code> when displaying a variable and latter is not. I haven't been able to glean from the documentation what method is being called.</p>\n\n<p>This is the first SO question I've ever written for Go. Hopefully made it clear but feel free to ask for additional info as I am a complete Go noob.  </p>\n\n<p>Thanks. </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "is_accepted": false, "score": 1, "last_activity_date": 1445636448, "last_edit_date": 1445636448, "creation_date": 1445635600, "answer_id": 33311639, "question_id": 33310172, "link": "https://stackoverflow.com/questions/33310172/inverted-return-from-strings-replace-golang/33311639#33311639", "title": "Inverted Return from strings.Replace() Golang", "body": "<p>This can be another solution</p>\n\n<pre><code>package main\n\nimport (\n    \"strings\"\n    \"fmt\"\n)\n\nfunc Reverse(s string) string {\n    n := len(s)\n    runes := make([]rune, n)\n    for _, rune := range s {\n        n--\n        runes[n] = rune\n    }\n    return string(runes[n:])\n}\n\nfunc main() {\n    S := \"AA-BB-CC-DD-EE\"\n    S = Reverse(strings.Replace(Reverse(S), \"-\", \"\", strings.Count(S, \"-\")-1))\n    fmt.Println(S)\n}\n</code></pre>\n\n<p>Another solution:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    S := strings.Replace(\"AA-BB-CC-DD-EE\", \"-\", \"*\", 1)\n    S = strings.Replace(S, \"-\", \"\", -1)\n    fmt.Println(strings.Replace( S, \"*\", \"-\", 1))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "is_accepted": false, "score": 0, "last_activity_date": 1445663112, "creation_date": 1445663112, "answer_id": 33314732, "question_id": 33310172, "link": "https://stackoverflow.com/questions/33310172/inverted-return-from-strings-replace-golang/33314732#33314732", "title": "Inverted Return from strings.Replace() Golang", "body": "<p>This was a fun question to answer. While the solutions offered work neatly, splitting and replacing, to say nothing of calling Replace 3 times doesn't seem likely to be performant.</p>\n\n<p>The answer? Don't reinvent the wheel, the go standard library has already <em>almost</em> solved this problem with <a href=\"https://golang.org/src/strings/strings.go?s=18112:18158#L675\" rel=\"nofollow\">Replace()</a>, let's tweak it. I stumbled a bit over how the API of our new function should work, finally settling on leaving the signature unchanged, but deciding on minimal change from strings.Replace:</p>\n\n<p><code>func ReplaceAfter(s,old,new string,skip int) string</code></p>\n\n<p>The variable <code>skip</code> replaces <code>n</code> to clarify what it does since the caller will specify how many instances of <code>old</code> to skip replacing. <code>skip==0</code> is defined as replacing every instance and <code>skip==-1</code> is defined as replacing no instances.</p>\n\n<p>From here there were really only a few bits of the function that needed changing.</p>\n\n<pre><code>func ReplaceAfter(s, old, new string, skip int) string {\n    if old == new || skip == -1 { // changed\n        return s // avoid allocation\n    }\n\n    // Compute number of replacements.\n    m := strings.Count(s, old)\n    if m == 0 || m &lt; skip { // changed\n        return s // avoid allocation\n    } // changed (removed else if)\n\n    // Apply replacements to buffer.\n    n := m - skip // changed, n means the same thing but is calculated\n    t := make([]byte, len(s)+n*(len(new)-len(old))) // longer buffer\n    w := 0\n    start := 0\n    for i := 0; i &lt; m; i++ {\n        j := start\n        if len(old) == 0 {\n            if i &gt; 0 {\n                _, wid := utf8.DecodeRuneInString(s[start:])\n                j += wid\n            }\n        } else {\n            j += strings.Index(s[start:], old)\n        }\n        if i &gt;= skip { // changed, replace\n            w += copy(t[w:], s[start:j])\n            w += copy(t[w:], new)\n        } else { // changed, skip ahead\n            w += copy(t[w:], s[start:j+len(old)])\n        }\n        start = j + len(old)\n    }\n    w += copy(t[w:], s[start:])\n    return string(t[0:w])\n}\n</code></pre>\n\n<p>Here's a <a href=\"http://play.golang.org/p/3oMYoS9N0J\" rel=\"nofollow\">playground link</a> with a working demo. If you're interested, I also copied and adapted the relevant Test functions from go/src/strings/, to make sure that the function as written behaved itself predictably.</p>\n"}, {"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 4, "last_activity_date": 1445666733, "creation_date": 1445666733, "answer_id": 33315056, "question_id": 33310172, "link": "https://stackoverflow.com/questions/33310172/inverted-return-from-strings-replace-golang/33315056#33315056", "title": "Inverted Return from strings.Replace() Golang", "body": "<p>String slices!</p>\n\n<pre><code>in := \"AA-BB-CC-DD-EE\"\nafterDash := strings.Index(in, \"-\") + 1\nfmt.Println(in[:afterDash] + strings.Replace(in[afterDash:], \"-\", \"\", -1))\n</code></pre>\n\n<p>(might require some tweaking to get the behavior you want in the case that the input has no dashes).</p>\n"}, {"tags": [], "owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "is_accepted": false, "score": 1, "last_activity_date": 1445678898, "last_edit_date": 1592644375, "creation_date": 1445678898, "answer_id": 33316587, "question_id": 33310172, "link": "https://stackoverflow.com/questions/33310172/inverted-return-from-strings-replace-golang/33316587#33316587", "title": "Inverted Return from strings.Replace() Golang", "body": "<p>I think you want to use <code>strings.Map</code> rather than rigging things with compositions of functions. It's basically meant for this scenario: character replacement with more complex requirements than <code>Replace</code> and cousins can handle. The definition:</p>\n<blockquote>\n<p>Map returns a copy of the string s with all its characters modified according to the mapping function. If mapping returns a negative value, the character is dropped from the string with no replacement.</p>\n</blockquote>\n<p>Your mapping function can be built with a fairly simple closure:</p>\n<pre><code>func makeReplaceFn(toReplace rune, skipCount int) func(rune) rune {\n    count := 0\n    return func(r rune) rune {\n        if r == toReplace &amp;&amp; count &lt; skipCount {\n            count++\n        } else if r == toReplace &amp;&amp; count &gt;= skipCount {\n            return -1\n        }\n\n        return r\n    }\n}\n</code></pre>\n<p>From there, it's a very straightforward program:</p>\n<pre><code>strings.Map(makeReplaceFn('-', 1), &quot;AA-BB-CC-DD-EE&quot;)\n</code></pre>\n<p><a href=\"http://play.golang.org/p/KodamVhmyE\" rel=\"nofollow noreferrer\">Playground</a>, this produces the desired output:</p>\n<blockquote>\n<p>AA-BBCCDDEE</p>\n<p>Program exited.</p>\n</blockquote>\n<p>I'm not sure whether this is faster or slower than other solutions without benchmarking, because on one hand it has to call a function for each rune in the string, while on the other hand it doesn't have to convert (and thus copy) between a <code>[]byte</code>/<code>[]rune</code> and <code>string</code> between each function call (though the subslicing answer by hobbs is probably overall the best).</p>\n<p>In addition, the method can be easily adapted to other scenarios (e.g. retaining every other dash), with the caveat that <code>strings.Map</code> can only do <strong>rune to rune</strong> mapping, and not <strong>rune to string</strong> mapping like <code>strings.Replace</code> does.</p>\n"}], "owner": {"reputation": 873, "user_id": 307862, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/722274c13fd9a66e3d1fc70dca23c0a7?s=128&d=identicon&r=PG", "display_name": "anthony", "link": "https://stackoverflow.com/users/307862/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 644, "favorite_count": 0, "accepted_answer_id": 33315056, "answer_count": 4, "score": 1, "last_activity_date": 1445678898, "creation_date": 1445629029, "question_id": 33310172, "link": "https://stackoverflow.com/questions/33310172/inverted-return-from-strings-replace-golang", "title": "Inverted Return from strings.Replace() Golang", "body": "<p>I have a large dataset where I needed to do some string manipulation (I know strings are immutable). The <code>Replace()</code> function in the <code>strings</code> package does exactly what I need, except I need it to search in reverse.</p>\n\n<p>Say I have this string: <code>AA-BB-CC-DD-EE</code></p>\n\n<p>Run this script:</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"strings\"\n)\n\nfunc main() {\n    fmt.Println(strings.Replace(\"AA-BB-CC-DD-EE\", \"-\", \"\", 1))\n}\n</code></pre>\n\n<p>It outputs: <code>AABB-CC-DD-EE</code></p>\n\n<p>What I need is: <code>AA-BBCCDDEE</code>, where the first instance of the search key is found, and the rest discarded.</p>\n\n<p>Splitting the string, inserting the dash, and joining it back together works. But, I'm thinking there is a more performant way to achieve this.</p>\n"}, {"tags": ["api", "go"], "answers": [{"tags": [], "owner": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "is_accepted": false, "score": 0, "last_activity_date": 1445630984, "creation_date": 1445630984, "answer_id": 33310610, "question_id": 33310131, "link": "https://stackoverflow.com/questions/33310131/api-design-app-on-one-domain-api-on-a-different-domain-how-to-retrieve-user/33310610#33310610", "title": "API design - app on one domain, api on a different domain. How to retrieve user specific data without passing user id", "body": "<p>There are two ways you can solve this:</p>\n\n<ul>\n<li>Change the session storage to something the API and app both share (i.e.: <a href=\"https://github.com/srinathgs/mysqlstore\" rel=\"nofollow\">MySQL</a>).</li>\n<li>Start using (encrypted) cookies instead of session data.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": false, "score": 0, "last_activity_date": 1445645961, "last_edit_date": 1445645961, "creation_date": 1445641401, "answer_id": 33312666, "question_id": 33310131, "link": "https://stackoverflow.com/questions/33310131/api-design-app-on-one-domain-api-on-a-different-domain-how-to-retrieve-user/33312666#33312666", "title": "API design - app on one domain, api on a different domain. How to retrieve user specific data without passing user id", "body": "<p>You can still access the user ID.</p>\n\n<ul>\n<li>Your API server on api.domain.com can save the ID in a session cookie on login. The cookie will be for the <code>api.domain.com</code> domain. Use <a href=\"http://www.gorillatoolkit.org/pkg/sessions\" rel=\"nofollow\">gorilla/sessions</a> to get signed cookies by default.</li>\n<li>The Angular client on <code>www.example.com</code> (different domain) won't be able to read/write to the cookie at all due to the <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\" rel=\"nofollow\">same-origin policy</a> that browsers enforce on cookies, but will still send the cookie back in AJAX requests to the <code>api.domain.com</code> server.</li>\n</ul>\n\n<p>As per the Angular docs (<a href=\"https://docs.angularjs.org/api/ng/service/\" rel=\"nofollow\">https://docs.angularjs.org/api/ng/service/</a>$http) you'll want to set <code>withCredentials = true</code> to send a cookie on cross-domain requests (ref: <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS#Requests_with_credentials\" rel=\"nofollow\">Mozilla CORS docs</a>). Make a request to get a cookie (e.g. POST login credentials over HTTPS), and then successive AJAX requests will present that cookie to the server.</p>\n\n<p>The alternative would be to issue OAuth2 Bearer Tokens (\"token auth\"), record token &lt;=> user ID in a backend (Redis, Bolt, mySQL, etc) and have the Angular app save that in local storage and send it in the header of each request. </p>\n"}], "owner": {"reputation": 327, "user_id": 5422600, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71453149679dde4ee7e714ed4ed517b5?s=128&d=identicon&r=PG&f=1", "display_name": "davidjh", "link": "https://stackoverflow.com/users/5422600/davidjh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1445645961, "creation_date": 1445628852, "question_id": 33310131, "link": "https://stackoverflow.com/questions/33310131/api-design-app-on-one-domain-api-on-a-different-domain-how-to-retrieve-user", "title": "API design - app on one domain, api on a different domain. How to retrieve user specific data without passing user id", "body": "<p>I am trying to build quite a simple web app (for learning purposes) using Golang and Angular JS.</p>\n\n<p>I am comfortable with the Go and AngularJS code but I am having difficulties trying to create an adequate API structure.</p>\n\n<p>At the moment I have all my code running the app and the API code bundled together.</p>\n\n<p>Ideally I would like to separate this out, so I can have my app run on a subdomain such as app.mything.com and the API run on api.mything.com</p>\n\n<p>The problem I have is my API has MYSQL calls such as -</p>\n\n<pre><code>select * FROM sometable where userid = userID\n</code></pre>\n\n<p>userID is a user ID that it is saved in a session.</p>\n\n<p>So while all the code is bundled together this is possible and works fine.\nIf I was to separate the code to two separate sub domains the session will not be accessible on both. </p>\n\n<p>How is it possible to achieve something like this?</p>\n\n<p>Thanks\nDave</p>\n"}, {"tags": ["go", "socks"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1445625106, "post_id": 33309089, "comment_id": 54417104, "body": "<a href=\"https://godoc.org/golang.org/x/crypto/ssh\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/crypto/ssh</a>"}, {"owner": {"reputation": 1889, "user_id": 892404, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6c64aa7f128d8b6e4cfeafae93782ec7?s=128&d=identicon&r=PG", "display_name": "Parham Doustdar", "link": "https://stackoverflow.com/users/892404/parham-doustdar"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1445625753, "post_id": 33309089, "comment_id": 54417430, "body": "I&#39;m not sure, but I can&#39;t find anything about dynamic application-level port forwarding in that library."}, {"owner": {"reputation": 1889, "user_id": 892404, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6c64aa7f128d8b6e4cfeafae93782ec7?s=128&d=identicon&r=PG", "display_name": "Parham Doustdar", "link": "https://stackoverflow.com/users/892404/parham-doustdar"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1445627157, "post_id": 33309089, "comment_id": 54418185, "body": "This sounds like a proxy client, not a server?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1445629116, "post_id": 33309089, "comment_id": 54419202, "body": "you&#39;re right, that x/net/proxy doesn&#39;t provide access to the protocol. After a quick search, I didn&#39;t see any socks packages that provide a server you could plug the ssh dialer into. You&#39;re probably going to have to adapt one to suit your needs."}], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 1, "last_activity_date": 1445629675, "creation_date": 1445629675, "answer_id": 33310335, "question_id": 33309089, "link": "https://stackoverflow.com/questions/33309089/is-there-a-way-to-do-dynamic-socks-based-port-forwarding-in-go-like-the-d-swit/33310335#33310335", "title": "Is there a way to do dynamic socks-based port forwarding in Go, like the -d switch in SSH?", "body": "<p>This might not be ideal, but you could pretty easily use a combination of <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow\">https://github.com/jteeuwen/go-bindata</a> and <a href=\"https://github.com/getlantern/byteexec\" rel=\"nofollow\">https://github.com/getlantern/byteexec</a> - essentially you would embed the plink executable inside of your own executable, then load it and run it with something like:</p>\n\n<pre><code>func runPlink() {\n    programBytes, err := Asset(\"plink.exe\")\n    be, err := byteexec.New(programBytes)\n    if err != nil {\n        log.Fatalf(\"Uh oh: %s\", err)\n    }\n    cmd := be.Command(\"-N\", \"-C\", \"-D\", \"8888\", \"-pw\", \"password\", \"username@example.com\")\n    if output, err := cmd.CombinedOutput(); err != nil {\n        log.Println(string(output), err.Error())\n        runPlink()\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1889, "user_id": 892404, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6c64aa7f128d8b6e4cfeafae93782ec7?s=128&d=identicon&r=PG", "display_name": "Parham Doustdar", "link": "https://stackoverflow.com/users/892404/parham-doustdar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "accepted_answer_id": 33310335, "answer_count": 1, "score": 0, "last_activity_date": 1445629675, "creation_date": 1445624737, "last_edit_date": 1445627652, "question_id": 33309089, "link": "https://stackoverflow.com/questions/33309089/is-there-a-way-to-do-dynamic-socks-based-port-forwarding-in-go-like-the-d-swit", "title": "Is there a way to do dynamic socks-based port forwarding in Go, like the -d switch in SSH?", "body": "<p>I used to use a batch script to create an SSH tunnel that would be usable as a socks5 proxy. Today, I thought I'd implement it in Go, both to learn the language and to remove the need for me to constantly run a batch script file whenever the connection drops.</p>\n\n<p>Right now, how I do this is to use <a href=\"http://the.earth.li/~sgtatham/putty/latest/x86/plink.exe\" rel=\"nofollow\">plink</a>. The command to do this with plink is:</p>\n\n<pre><code>plink -N -C -D 8888 -pw password username@example.com\n</code></pre>\n\n<p>And here is my Go code:</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"os/exec\"\n    \"log\"\n)\n\nfunc runPlink() {\n    command := exec.Command(\"plink.exe\", \"-N\", \"-C\", \"-D\", \"8888\", \"-pw\", \"password\", \"username@example.com\")\n\n    if output, err := command.CombinedOutput(); err != nil {\n        log.Println(string(output), err.Error())\n        runPlink()\n    }\n}\n\nfunc main() {\n    if _, err := os.Stat(\"plink.exe\"); os.IsNotExist(err) {\n        log.Fatalln(\"Cannot find plink.exe. Please copy it next to this application.\")\n    }\n\n    runPlink()\n}\n</code></pre>\n\n<p>I would like to make this application self-contained, so that it doesn't rely on the existence of <code>plink.exe</code> to work.</p>\n\n<p>Is there a way to achieve this in Go?</p>\n"}, {"tags": ["unit-testing", "go", "mocking"], "answers": [{"comments": [{"owner": {"reputation": 3025, "user_id": 1183531, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7f5a8ecd70ee4917a62634d6f8225b37?s=128&d=identicon&r=PG", "display_name": "Hacking Life", "link": "https://stackoverflow.com/users/1183531/hacking-life"}, "edited": false, "score": 0, "creation_date": 1445696458, "post_id": 33308935, "comment_id": 54436321, "body": "I&#39;ve been working with this - but it doesn&#39;t seem to solve the core problem of EventHandler&#39;s argument &quot;bucket&quot; being of type datastore.Storage. In your line EventHandler(w,r,ms)  ms is the MockStore struct. So the error: cannot use  type MockStore as type datastore.Storage still exists."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 3025, "user_id": 1183531, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7f5a8ecd70ee4917a62634d6f8225b37?s=128&d=identicon&r=PG", "display_name": "Hacking Life", "link": "https://stackoverflow.com/users/1183531/hacking-life"}, "edited": false, "score": 0, "creation_date": 1445699885, "post_id": 33308935, "comment_id": 54437479, "body": "@HackingLife: I have just updated my answer; see if those changes help any."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 2, "last_activity_date": 1445699860, "last_edit_date": 1495542593, "creation_date": 1445624093, "answer_id": 33308935, "question_id": 33308887, "link": "https://stackoverflow.com/questions/33308887/golang-mocking-problems-with-type-collision/33308935#33308935", "title": "Golang Mocking - problems with type collision", "body": "<p>A few things:</p>\n\n<ul>\n<li>Create an interface that will be implemented both by <code>datastore.Storage</code> and your mock store.</li>\n<li>Use the above interface as the argument type in <code>EventHandler</code> <a href=\"https://stackoverflow.com/questions/27178635/cast-a-struct-pointer-to-interface-pointer-in-golang\">(not a pointer to the interface)</a>.</li>\n<li>Pass a pointer to your <code>MockStore</code> to <code>EventHandler</code>, as the <code>Get</code> method is defined for a pointer to the struct.</li>\n</ul>\n\n<p>Your updated code should be something like the following:</p>\n\n<pre><code>type Store interface {\n   Get() (interface{}, bool) // change as needed\n   Set(interface{}) bool\n}\n\ntype MockStore struct {\n   mock.Mock\n}\n\nfunc (s *MockStore) Get() ... \n\nfunc EventHandler(w http.ResponseWriter, r *http.Request,bucket datastore.Storage){\n   //Does HTTP stuff and stores things in a data store\n   // Need to mock out the data store get/sets\n}\n\n\n// Later in my Tests\nms := &amp;MockStore{}\nEventHandler(w,r,ms)\n</code></pre>\n"}], "owner": {"reputation": 3025, "user_id": 1183531, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7f5a8ecd70ee4917a62634d6f8225b37?s=128&d=identicon&r=PG", "display_name": "Hacking Life", "link": "https://stackoverflow.com/users/1183531/hacking-life"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1948, "favorite_count": 0, "accepted_answer_id": 33308935, "answer_count": 1, "score": 0, "last_activity_date": 1445699860, "creation_date": 1445623872, "last_edit_date": 1445624219, "question_id": 33308887, "link": "https://stackoverflow.com/questions/33308887/golang-mocking-problems-with-type-collision", "title": "Golang Mocking - problems with type collision", "body": "<p>I'm mocking out a DataStore and it's Get/Set functionality. The trouble I'm having is: cannot use s (type *MockStore) as type *datastore.Storage in argument to EventHandler</p>\n\n<p>This is caused by my EventHandler function needing to be passed a *datastore.Storage as an argument type. I want to Test (http test) EvenHandler() using the MockStore I've created instead of the real datastore. I'm using the golang testify mock package. </p>\n\n<p>Some Code Examples</p>\n\n<pre><code>type MockStore struct{\n  mock.Mock\n}\n\nfunc (s *MockStore) Get() ... \n\nfunc EventHandler(w http.ResponseWriter, r *http.Request, bucket *datastore.Storage){\n  //Does HTTP stuff and stores things in a data store\n  // Need to mock out the data store get/sets\n}\n\n// Later in my Tests\nms := MockStore\nEventHandler(w,r,ms)\n</code></pre>\n"}, {"tags": ["json", "encoding", "go"], "answers": [{"tags": [], "owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "is_accepted": true, "score": 1, "last_activity_date": 1445624649, "creation_date": 1445624649, "answer_id": 33309072, "question_id": 33308795, "link": "https://stackoverflow.com/questions/33308795/golang-json-marshall-encoding-synthax/33309072#33309072", "title": "Golang Json Marshall encoding synthax", "body": "<p>You have to add an annotation to the <code>Name</code> field.</p>\n\n<p>Supposing your struct is:</p>\n\n<pre><code>type User struct {\n    Name string\n }\n</code></pre>\n\n<p>You have to change it to:</p>\n\n<pre><code>type User struct {\n    Name string `json:\"name\"`\n }\n</code></pre>\n\n<p>The json marshaller will replace <code>Name</code> with <code>name</code></p>\n"}], "owner": {"reputation": 39, "user_id": 5273213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8225edf7e7e3658201e31ae323d63eb4?s=128&d=identicon&r=PG&f=1", "display_name": "RieuxThomas", "link": "https://stackoverflow.com/users/5273213/rieuxthomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "closed_date": 1445624830, "accepted_answer_id": 33309072, "answer_count": 1, "score": -4, "last_activity_date": 1445624649, "creation_date": 1445623562, "question_id": 33308795, "link": "https://stackoverflow.com/questions/33308795/golang-json-marshall-encoding-synthax", "closed_reason": "Duplicate", "title": "Golang Json Marshall encoding synthax", "body": "<p>i would know if json.Marshal Put Uppercase a the first letter  of each name fields ? I need to encode some data with just a lowercase at each field name first letter. </p>\n\n<p>just:</p>\n\n<pre><code>{\n  \"name\":\"thomas\"\n}\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>{\n  \"Name\":\"thomas\"\n}\n</code></pre>\n\n<p>Thanks ! </p>\n"}, {"tags": ["intellij-idea", "go"], "comments": [{"owner": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "edited": false, "score": 0, "creation_date": 1445629814, "post_id": 33308073, "comment_id": 54419591, "body": "Which version of the plugin are you using?"}, {"owner": {"reputation": 696, "user_id": 1364759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3b01238f289cc93432a681999f9e07d8?s=128&d=identicon&r=PG", "display_name": "Shadoninja", "link": "https://stackoverflow.com/users/1364759/shadoninja"}, "reply_to_user": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "edited": false, "score": 0, "creation_date": 1445630849, "post_id": 33308073, "comment_id": 54420108, "body": "The version is 0.9.562"}, {"owner": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "edited": false, "score": 0, "creation_date": 1445631113, "post_id": 33308073, "comment_id": 54420207, "body": "Hmm, latest alpha build, OK. What happens when you go to <code>File</code> -&gt; <code>Settings</code> -&gt; <code>Language and Frameworks</code> -&gt; <code>Go</code>. Are the <code>Libraries</code> configured correctly? Is the SDK set? (you may have to look for the settings menu; I&#39;m using WebStorm, not IDEA)"}, {"owner": {"reputation": 696, "user_id": 1364759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3b01238f289cc93432a681999f9e07d8?s=128&d=identicon&r=PG", "display_name": "Shadoninja", "link": "https://stackoverflow.com/users/1364759/shadoninja"}, "reply_to_user": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "edited": false, "score": 0, "creation_date": 1445633391, "post_id": 33308073, "comment_id": 54421304, "body": "I have my [GOPATH] pointing to my go directory for projects and I have a second entry for my go binaries (/usr/local/go as I am running CentOS)"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1446053331, "post_id": 33308073, "comment_id": 54586755, "body": "Can you please add more details about your setup? Eventually some screenshots? Also you can report the issue here: <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/new\" rel=\"nofollow noreferrer\">github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/new</a> and you might be able to get more help faster."}, {"owner": {"reputation": 696, "user_id": 1364759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3b01238f289cc93432a681999f9e07d8?s=128&d=identicon&r=PG", "display_name": "Shadoninja", "link": "https://stackoverflow.com/users/1364759/shadoninja"}, "edited": false, "score": 0, "creation_date": 1446937431, "post_id": 33308073, "comment_id": 54953728, "body": "I can do that. Other people on my team have been seeing the same issue, so maybe it is a bug. Will get more information soon."}], "owner": {"reputation": 696, "user_id": 1364759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3b01238f289cc93432a681999f9e07d8?s=128&d=identicon&r=PG", "display_name": "Shadoninja", "link": "https://stackoverflow.com/users/1364759/shadoninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1445620766, "creation_date": 1445620766, "question_id": 33308073, "link": "https://stackoverflow.com/questions/33308073/is-there-a-way-to-extend-how-deep-intellijs-real-time-and-autocomplete-features", "title": "Is there a way to extend how deep Intellij&#39;s real-time and autocomplete features look into import statements?", "body": "<p>My import line looks like this:</p>\n\n<p><code>github.schq.secious.com/Company/Godeps/_workspace/src/github.com/boltdb/bolt</code></p>\n\n<p>My code compiles and my tests pass, but the real-time help that I get from Intellij tells me the methods on my bolt object don't exist. Autocomplete doesn't work on them either which causes a lot of headache if I try to ignore the false errors.</p>\n\n<p>If I copy boltdb to the classic location and import it accordingly</p>\n\n<p><code>github.com/boltdb/bolt</code></p>\n\n<p>My autocomplete and real-time notifications work just fine and my code continues to compile and pass its tests.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4199433, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007597295687/picture?type=large", "display_name": "Gretch", "link": "https://stackoverflow.com/users/4199433/gretch"}, "edited": false, "score": 0, "creation_date": 1445627329, "post_id": 33308569, "comment_id": 54418262, "body": "My solution was:  \t\tpage := &amp;Pages{ \t\t\tContents:    template.HTML(contents), \t\t}"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1445622743, "creation_date": 1445622743, "answer_id": 33308569, "question_id": 33307947, "link": "https://stackoverflow.com/questions/33307947/golang-scan-ignoring-type-template-html/33308569#33308569", "title": "Golang: .Scan() ignoring type template.HTML", "body": "<p>You can't Marshal or Unamrshal an <code>html.Template</code>. </p>\n\n<p>You either need to store the a reference to the template name, the raw template data, or the rendered html in the DB. </p>\n"}], "owner": {"reputation": 17, "user_id": 4199433, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007597295687/picture?type=large", "display_name": "Gretch", "link": "https://stackoverflow.com/users/4199433/gretch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 33308569, "answer_count": 1, "score": -2, "last_activity_date": 1445622743, "creation_date": 1445620264, "question_id": 33307947, "link": "https://stackoverflow.com/questions/33307947/golang-scan-ignoring-type-template-html", "title": "Golang: .Scan() ignoring type template.HTML", "body": "<p>So right now .Scan() is not taking in the type template.HTML; it completely ignores it and outputs nothing to the HTML. This is the one thing I am stuck on and uncertain about. </p>\n\n<p>If I pass it as a string it works, but the HTML outputs as escaped characters</p>\n\n<pre><code>&amp;lt;h2&amp;gt;metus congue\n</code></pre>\n\n<p>If there is an alternative solution that would be neat.</p>\n\n<p>The code is a one pager- full page here: <a href=\"http://pastebin.com/E4jXiv6p\" rel=\"nofollow\">http://pastebin.com/E4jXiv6p</a></p>\n\n<p>The Struct</p>\n\n<pre><code>type Pages struct {\n    Name        string\n    Url         string\n    Title       string\n    Description string\n    H1          string\n    Hero        string\n    Contents    template.HTML\n    Sidebar     string\n    Page_list   [][]string\n}\n</code></pre>\n\n<p>Querying pages</p>\n\n<pre><code>func db_query_pages(db *sql.DB, err error, page_list [][]string) {\n\n    var name, url, title, description, h1, hero, sidebar string\n\n    var contents template.HTML\n\n    rows, err := db.Query(\"SELECT * FROM pages\")\n\n    for rows.Next() {\n\n        rows.Scan(&amp;name, &amp;url, &amp;title, &amp;description, &amp;h1, &amp;hero, &amp;contents, &amp;sidebar)\n\n        page := &amp;Pages{\n\n            Name:        name,\n            Url:         url,\n            Title:       title,\n            Description: description,\n            H1:          h1,\n            Hero:        hero,\n            Contents:    contents,\n            Sidebar:     sidebar,\n            Page_list:   page_list,\n        }\n\n        render_page(page)\n\n    }\n\n}\n</code></pre>\n\n<p>Rendering pages </p>\n\n<pre><code>func render_page(new_page *Pages) {\n\n    http.HandleFunc(new_page.Url,\n        func(w http.ResponseWriter, r *http.Request) {\n\n            templates.ExecuteTemplate(w, \"main\", new_page)\n\n        })\n\n}\n</code></pre>\n\n<p>HTML</p>\n\n<pre><code>{{define \"content\"}}\n\n    &lt;h1&gt;{{.H1}}&lt;/h1&gt;\n\n    &lt;img class=\"margin-bottom-md block common-border padding-md\" src=\"{{.Hero}}\"&gt;\n\n    {{.Contents}}\n\n{{end}}\n</code></pre>\n"}, {"tags": ["javascript", "ajax", "asynchronous", "go", "request"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3448529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05d6ea51b6328408e8399c7827d968f2?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/3448529/anonymous"}, "edited": false, "score": 0, "creation_date": 1445637498, "post_id": 33310409, "comment_id": 54422954, "body": "thanks i remember now that trick, so this is the url i have: <a href=\"http://uri1/modules/blocklayered/blocklayered-ajax.php?id_category_layered=7&amp;layered_price_slider=285_3999&amp;orderby=position&amp;orderway=desc&amp;n=12&amp;p=5&amp;_=1445616085057\" rel=\"nofollow noreferrer\">uri1/modules/blocklayered/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "is_accepted": true, "score": 0, "last_activity_date": 1445629961, "creation_date": 1445629961, "answer_id": 33310409, "question_id": 33307501, "link": "https://stackoverflow.com/questions/33307501/how-to-execute-javascript-async-code-in-a-golang-request/33310409#33310409", "title": "How to execute javascript async code in a Golang request", "body": "<p>As some have downvoted your answer, I'll just try to point you in the right direction. </p>\n\n<p><strong>You don't execute javascript in Go.</strong> You usually do so in your browser, using Development Tools (F12 or something), view the Network tab to see which URL is being called, and then call <em>that</em> URL in your code. </p>\n"}], "owner": {"reputation": 1, "user_id": 3448529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05d6ea51b6328408e8399c7827d968f2?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/3448529/anonymous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1057, "favorite_count": 0, "accepted_answer_id": 33310409, "answer_count": 1, "score": -3, "last_activity_date": 1445629961, "creation_date": 1445618645, "last_edit_date": 1445620716, "question_id": 33307501, "link": "https://stackoverflow.com/questions/33307501/how-to-execute-javascript-async-code-in-a-golang-request", "title": "How to execute javascript async code in a Golang request", "body": "<p>I need to read the content of a dynamically generated page with <a href=\"/questions/tagged/ajax\" class=\"post-tag\" title=\"show questions tagged &#39;ajax&#39;\" rel=\"tag\">ajax</a> from a website with this code in <a href=\"/questions/tagged/golang\" class=\"post-tag\" title=\"show questions tagged &#39;golang&#39;\" rel=\"tag\">golang</a>, it works fine for non ajax pages but i can't find a package or example to do this. Thanks.</p>\n\n<pre><code>package main\n\nimport(\n\n    \"fmt\"\n    \"time\"\n    \"net/http\"\n    \"github.com/PuerkitoBio/goquery\"\n    \"strings\"\n    \"strconv\"\n\n)\n\nfunc main() {\n\n    var masterURI [1]string\n    masterURI[0] = \"http://uri1\"\n    /*masterURI[1] = \"http://uri2\"\n    masterURI[2] = \"http://uri3\"*/\n\n    for _, uri := range masterURI {\n\n        doc, err := extractHTML(uri)\n\n        check(err)\n\n        search := doc.Find(\".pagination li a span\").Eq(-1)\n\n        numPages, err := strconv.Atoi(search.Text())\n\n        check(err)\n\n        var i int\n\n        for i = 1; i &lt;= numPages; i++ {\n\n            page := uri + \"#/page-\" + strconv.Itoa(i)\n\n            fmt.Println(\"\\n========&gt; \" + page)\n\n            doc, err := extractHTML(page)\n\n            check(err)\n\n            search := doc.Find(\".product-name\")\n\n            for i := range search.Nodes {\n                product := strings.TrimSpace(search.Eq(i).Text())\n                fmt.Println(product)\n                // use `single` as a selection of 1 node\n            }\n\n        }\n\n        fmt.Println(\" --- \")\n\n    }\n\n}\n\nfunc extractHTML(url string) (doc *goquery.Document, err error) {\n\n    userAgent := \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.93 Safari/537.36 OPR/32.0.1948.69\";\n\n    trans := &amp;http.Transport{\n       DisableKeepAlives: true,\n    }\n\n    timeout := time.Duration(600 * time.Second)\n\n    myClient := &amp;http.Client{Transport: trans, Timeout: timeout}\n\n    req, err := http.NewRequest(\"GET\", url, nil)\n\n    check(err)\n\n    req.Header.Add(\"User-Agent\", userAgent)\n\n    resp, err := myClient.Do(req)\n\n    req.Close = true\n\n    check(err)\n\n    if resp.StatusCode == 200 {\n\n        doc, err = goquery.NewDocumentFromResponse(resp) \n\n    }\n\n    check(err)\n\n    resp.Body.Close()\n\n    return doc, err\n\n}\n\nfunc check(err error) {\n\n    if err != nil {\n\n        panic(err)\n\n    }\n\n}\n</code></pre>\n"}, {"tags": ["authentication", "go", "reactjs"], "comments": [{"owner": {"reputation": 21876, "user_id": 1678362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ba023d18099cde022b9e4394d5714c0?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/1678362/aaron"}, "edited": false, "score": 1, "creation_date": 1445616840, "post_id": 33306896, "comment_id": 54412757, "body": "I&#39;m not too sure what&#39;s your question here. Frontend can access cookies, see Document.cookie for javascript. A more modern solution is using localstorage. However, both those solutions should not be trusted too much by a backend since they can be modified by the user."}, {"owner": {"reputation": 3055, "user_id": 2865186, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/ehbWg.jpg?s=128&g=1", "display_name": "MattSizzle", "link": "https://stackoverflow.com/users/2865186/mattsizzle"}, "edited": false, "score": 5, "creation_date": 1445616877, "post_id": 33306896, "comment_id": 54412784, "body": "As the &quot;front-end&quot; executes (lives) on the client-side you CAN do this, but you would Never Ever want to. Authentication means they need to be verified prior to accessing data. If the means for authentication can be seen by the user it is always insecure."}, {"owner": {"reputation": 154, "user_id": 5480839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toXvN.jpg?s=128&g=1", "display_name": "AndrewGentry", "link": "https://stackoverflow.com/users/5480839/andrewgentry"}, "edited": false, "score": 0, "creation_date": 1445639365, "post_id": 33306896, "comment_id": 54423517, "body": "Pretty much what I was thinking. Thank you kindly for the advice!"}], "owner": {"reputation": 154, "user_id": 5480839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toXvN.jpg?s=128&g=1", "display_name": "AndrewGentry", "link": "https://stackoverflow.com/users/5480839/andrewgentry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1445616418, "creation_date": 1445616418, "question_id": 33306896, "link": "https://stackoverflow.com/questions/33306896/front-end-authentication-without-a-back-end-serving-cookies-on-page-load", "title": "Front-end authentication without a back-end serving cookies on page load?", "body": "<p>Is there any way a front-end tool like <a href=\"https://facebook.github.io/react/\" rel=\"nofollow\">React</a> can be used effectively to authenticate users without a backend serving cookies on page load?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1445602347, "creation_date": 1445602347, "answer_id": 33302032, "question_id": 33301847, "link": "https://stackoverflow.com/questions/33301847/how-to-compare-a-value-in-a-map-with-a-set-of-known-values/33302032#33302032", "title": "How to compare a value in a map with a set of known values", "body": "<blockquote>\n  <p>I notice when the values print they print with \"[]\" surrounding them.</p>\n</blockquote>\n\n<p>That's because <code>url.Values</code> is <code>map[string][]string</code>, not <code>map[string]string</code>. Use <code>url.Values.Get</code> to access the parameter directly.</p>\n\n<blockquote>\n  <p>I'd like to value the value of each a,b,c and check to see if it is contained in a comma-delimited string.</p>\n</blockquote>\n\n<p>I'd suggest splitting the string and using the result as map keys, so that you could use the map as a set. I.e.</p>\n\n<pre><code>allowedAMap := map[string]struct{}{}\nallowedAStrs := strings.Split(allowedA, \",\")\nfor _, s := range allowedAStrs {\n    allowedAMap[s] = struct{}{}\n}\n//...\nif _, ok := allowedAMap[a]; !ok {\n    fmt.Println(\"wrong a\")\n    return\n}\nfmt.Println(\"correct a\")\n</code></pre>\n"}], "owner": {"reputation": 583, "user_id": 5012927, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FY35gnHOQPg/AAAAAAAAAAI/AAAAAAAABhE/hU7tQ-I8dkA/photo.jpg?sz=128", "display_name": "Terry Chambers - Onix", "link": "https://stackoverflow.com/users/5012927/terry-chambers-onix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1445616479, "creation_date": 1445601711, "last_edit_date": 1445616479, "question_id": 33301847, "link": "https://stackoverflow.com/questions/33301847/how-to-compare-a-value-in-a-map-with-a-set-of-known-values", "title": "How to compare a value in a map with a set of known values", "body": "<p>I have some code that pulls out the URL parameters from a URL and places it into a map.  I can successfully print out the values of the map items that I want to examine.</p>\n\n<pre><code>values := r.URL.Query()\n\na := values[\"a\"]\n\nfmt.Println(a)\n</code></pre>\n\n<p>I notice when the values print they print with \"[]\" surrounding them.</p>\n\n<p>I'd like to value the value of each a,b,c and check to see if it is contained in a comma-delimited string.</p>\n\n<pre><code>allowedA = \"value1,value2,value3\"\n</code></pre>\n\n<p>i.e. something similar to:</p>\n\n<pre><code>if(contains(allowedA,a)\n</code></pre>\n\n<p>Meaning \"if the value in 'a' is contained in the variable 'allowedA' then return true.</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["go", "openssl", "digital-signature"], "comments": [{"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 2, "creation_date": 1445601415, "post_id": 33301318, "comment_id": 54402202, "body": "just a side note: you should either choose shorter variable names or wirte them in camelCase, as <code>recoveredpemdsaparameteres</code> is not only hard to read, but also, after close inspection, incorrect."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1445614501, "post_id": 33301318, "comment_id": 54411275, "body": "The panic is because <code>recoveredprivateKey</code> is nil. Allocate the structure before trying to Unmarshal into it."}, {"owner": {"reputation": 169, "user_id": 1778790, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/01069edf720360058c811015d8f3d851?s=128&d=identicon&r=PG", "display_name": "mr-ma", "link": "https://stackoverflow.com/users/1778790/mr-ma"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1445614950, "post_id": 33301318, "comment_id": 54411567, "body": "@JimB yes right, but it did not solve the problem as I had another panic due to struct mismatch. See my answer... I would be more than happy if it works out of the box!"}, {"owner": {"reputation": 169, "user_id": 1778790, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/01069edf720360058c811015d8f3d851?s=128&d=identicon&r=PG", "display_name": "mr-ma", "link": "https://stackoverflow.com/users/1778790/mr-ma"}, "reply_to_user": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 1, "creation_date": 1445615042, "post_id": 33301318, "comment_id": 54411625, "body": "@mrd0ll4r Agree. I considered your tip and rewrote the function accordingly. Hope it is more readable now."}], "answers": [{"comments": [{"owner": {"reputation": 353, "user_id": 590399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984e02805e2cd4b576030beba0377f06?s=128&d=identicon&r=PG", "display_name": "xjdrew", "link": "https://stackoverflow.com/users/590399/xjdrew"}, "edited": false, "score": 1, "creation_date": 1515057050, "post_id": 33306405, "comment_id": 83158152, "body": "there is a implemention in golang/crypto: <a href=\"https://github.com/golang/crypto/blob/master/ssh/keys.go#L869\" rel=\"nofollow noreferrer\">github.com/golang/crypto/blob/master/ssh/keys.go#L869</a>"}], "tags": [], "owner": {"reputation": 169, "user_id": 1778790, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/01069edf720360058c811015d8f3d851?s=128&d=identicon&r=PG", "display_name": "mr-ma", "link": "https://stackoverflow.com/users/1778790/mr-ma"}, "is_accepted": true, "score": 1, "last_activity_date": 1445615741, "last_edit_date": 1445615741, "creation_date": 1445614823, "answer_id": 33306405, "question_id": 33301318, "link": "https://stackoverflow.com/questions/33301318/load-openssl-generated-dsa-private-key-from-pem-file/33306405#33306405", "title": "Load (openssl generated) DSA private key from PEM file", "body": "<p>After spending couple of hours, I managed to fix my problem\nI post my finding so it may save someone's time:</p>\n\n<p>First I reviewed my pem file encoding using this great online tool: <a href=\"http://lapo.it/asn1js/\" rel=\"nofollow\">http://lapo.it/asn1js/</a>. Only then I realized go is expecting the pem file to have different structure... Not nice!\nAftwerwards, it was not hard to relate each value within the file to the corresponding dsa.PrivateKey struct. \nSo, I made a new struct and named it MyPrivateKey with the same order as the pem file:</p>\n\n<pre><code>type MyPrivateKey struct {\n    E1, P, Q, G, Y, X *big.Int\n}\n</code></pre>\n\n<p>Then, instead of trying to unmarshal directly to dsa.PrivateKey, I unmarshaled the asn1 encoded value to my self made struct. And magically it worked. Here is the modified func:</p>\n\n<pre><code>func getDSAPrivateKeyFromPemFile(pemFilePath string) (privateKey *dsa.PrivateKey, err error) {\n    pemfile, err := os.Open(pemFilePath)\n\n    if err != nil {\n        return nil, err\n    }\n    recoveredBytes, err := ioutil.ReadAll(pemfile)\n    if err != nil {\n        return nil, err\n    }\n    pemfile.Close()\n\n    pemDSAParameters, rest := pem.Decode(recoveredBytes)\n    if pemDSAParameters == nil {\n        return nil, errors.New(\"No pem recovered\")\n    }\n    pemDSAPrivateKey, _ := pem.Decode(rest)\n    keyParameters := dsa.Parameters{G: big.NewInt(0), P: big.NewInt(0), Q: big.NewInt(0)}\n    _, err = asn1.Unmarshal(pemDSAParameters.Bytes, &amp;keyParameters)\n    if err != nil {\n        return nil, err\n    }\n    //fmt.Printf(\"\\n\\n\\n\\n\\n\\nP:%x\\n\\nG:%x\\n\\nQ:%x\\n\\n\\n\\n\\n\\n\", keyParameters.P, keyParameters.G, keyParameters.Q)\n    myPrivateKey := MyPrivateKey{}\n    _, err = asn1.Unmarshal(pemDSAPrivateKey.Bytes, &amp;myPrivateKey)\n    if err != nil {\n        return nil, err\n    }\n    //fmt.Printf(\"\\nprivate\\nE1:%x\\n\\nP:%x\\n\\nQ:%x\\n\\nG:%x\\n\\nY:%x\\nX:%x\\n\\n\\n\\n\", myPrivateKey.E1, myPrivateKey.P, myPrivateKey.Q, myPrivateKey.G, myPrivateKey.Y, myPrivateKey.X)\n    privateKey = &amp;dsa.PrivateKey{}\n    privateKey.Parameters = keyParameters\n    privateKey.X = myPrivateKey.X\n\n    return privateKey, nil\n}\n</code></pre>\n\n<p>Maybe there was a much easier way to this all and I simply overlooked! If you know a better way please be my guest! Otherwise, I believe go should handle this kind of issues in the standard libraries.</p>\n"}], "owner": {"reputation": 169, "user_id": 1778790, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/01069edf720360058c811015d8f3d851?s=128&d=identicon&r=PG", "display_name": "mr-ma", "link": "https://stackoverflow.com/users/1778790/mr-ma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 726, "favorite_count": 0, "accepted_answer_id": 33306405, "answer_count": 1, "score": 1, "last_activity_date": 1445615741, "creation_date": 1445600004, "question_id": 33301318, "link": "https://stackoverflow.com/questions/33301318/load-openssl-generated-dsa-private-key-from-pem-file", "title": "Load (openssl generated) DSA private key from PEM file", "body": "<p>I'm trying to load a dsa private key in my program, Here is how I approached it:</p>\n\n<ol>\n<li><p>I create a dsa key pair using openssl:</p>\n\n<pre><code>openssl dsaparam -genkey 2048 -out dsakey.pem\n</code></pre></li>\n<li><p>I use the following function to parse the pem file</p>\n\n<pre><code>func getDSAPrivateKeyFromPemFile(pemfilepath string) (recoveredprivateKey *dsa.PrivateKey, err error) {\npemfile, err := os.Open(pemfilepath)\nif err != nil {\n    return nil, err\n}\nrecoveredbytes, err := ioutil.ReadAll(pemfile)\nif err != nil {\n    return nil, err\n}\n\nrecoveredpemdsaparameteres, rest := pem.Decode(recoveredbytes)\nif recoveredpemdsaparameteres == nil {\n    return nil, errors.New(\"No pem recovered\")\n}\n\n_, err = asn1.Unmarshal(append(recoveredpemdsaparameteres.Bytes, recoveredpemdsaprivatekey.Bytes...), recoveredprivateKey)\nif err != nil {\n    return nil, err\n }\n fmt.Printf(\"PEM:%v\\n\", recoveredpemdsaparameteres)\n\n recoveredpemdsaprivatekey, _ := pem.Decode(rest)\n fmt.Printf(\"PEM:%v\\n\", recoveredpemdsaprivatekey)\n pemfile.Close()\n}\n</code></pre></li>\n</ol>\n\n<p>When I call this function if fails:</p>\n\n<pre><code>panic: reflect: call of reflect.Value.Type on zero Value\n\ngoroutine 1 [running]:\nreflect.Value.Type(0x0, 0x0, 0x0, 0x0, 0x0)\n    /usr/local/go/src/reflect/value.go:1664 +0x7b\nencoding/asn1.parseField(0x0, 0x0, 0x0, 0xc8200b0600, 0x58b, 0x600, 0x0, 0x0, 0x0, 0x0, ...)\n    /usr/local/go/src/encoding/asn1/asn1.go:558 +0xbd\nencoding/asn1.UnmarshalWithParams(0xc8200b0600, 0x58b, 0x600, 0x1383e0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n    /usr/local/go/src/encoding/asn1/asn1.go:957 +0x16e\nencoding/asn1.Unmarshal(0xc8200b0600, 0x58b, 0x600, 0x1383e0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0)\n    /usr/local/go/src/encoding/asn1/asn1.go:950 +0x8f\nmain.getDSAPrivateKeyFromPemFile(0x1e7fa0, 0x26, 0x0, 0x0, 0x0)\n</code></pre>\n\n<p>However, I can perfectly see my dsa key in output:</p>\n\n<pre><code>PEM:&amp;{DSA PARAMETERS map[] [48 130 2 45 2 130...]}\nPEM:&amp;{DSA PRIVATE KEY map[] [48 130 3 86 2 1 0 ...]}\n</code></pre>\n\n<p>The problem is in fact how to unmarshal pem bytes to dsa.PrivateKey.\nAny ideas?</p>\n\n<p>P.S: I was not able to find any example of loading DSA private key pem file over the internet. </p>\n"}, {"tags": ["http", "templates", "web", "go", "panic"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 5, "creation_date": 1445598720, "post_id": 33300868, "comment_id": 54400652, "body": "You&#39;re calling <code>err.Error()</code> without checking if <code>err</code> is <code>nil</code>."}, {"owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1445599067, "post_id": 33300868, "comment_id": 54400834, "body": "Yes, but I just triing to fix the bug, if I delete it the panic is still there."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 0, "creation_date": 1445599555, "post_id": 33300868, "comment_id": 54401126, "body": "remove err.Error() and try again."}, {"owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "edited": false, "score": 0, "creation_date": 1445599765, "post_id": 33300868, "comment_id": 54401266, "body": "It works, but i dont understand why."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1445601651, "post_id": 33300868, "comment_id": 54402357, "body": "If <code>err</code> is <code>nil</code>, you&#39;re calling a method on a null pointer, which leads to segfault."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 6, "creation_date": 1445602636, "post_id": 33300868, "comment_id": 54402929, "body": "Calling a method on a <code>nil</code> value <a href=\"http://play.golang.org/p/CGJOrjt8c0\" rel=\"nofollow noreferrer\">is okay and valid</a>. It&#39;s the method that panics because it tries to access some string that is not accessible."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1445612600, "post_id": 33300868, "comment_id": 54409963, "body": "Side note, you almost never want or need to call an error&#39;s <code>Error</code> method. If you had just done a plain <code>fmt.Println(err)</code> then it would print &quot;&lt;nil&gt;&quot; or the return value of <code>Error</code>. You want to do <a href=\"http://stackoverflow.com/tags/go/info\">some basic Go tutorials or read the language spec</a>."}], "answers": [{"comments": [{"owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1445639594, "post_id": 33305749, "comment_id": 54423584, "body": "@DaveC Good catch. it&#39;s fixed"}], "tags": [], "owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "is_accepted": true, "score": 4, "last_activity_date": 1445639960, "last_edit_date": 1445639960, "creation_date": 1445613037, "answer_id": 33305749, "question_id": 33300868, "link": "https://stackoverflow.com/questions/33300868/go-http-panic-serving/33305749#33305749", "title": "Go http panic serving", "body": "<p>The panic stacktrace gives you this info :</p>\n\n<pre><code>2015/10/23 13:00:39 http: panic serving [::1]:63868: runtime error: invalid memory address or nil pointer dereference goroutine 33 [running]:\n</code></pre>\n\n<p>It means you're trying to access something that does not exist (nil pointer). </p>\n\n<p>Then the first line that comes from your file is this one :</p>\n\n<pre><code>v8.5/duplicate_submissions/server.go:27\n</code></pre>\n\n<p>Which is there :</p>\n\n<pre><code>26: t, err := template.ParseFiles(\"templates/index.gtpl\")\n27: fmt.Println(err.Error())\n28: err = t.Execute(w, token)\n</code></pre>\n\n<p>It means err is nil.</p>\n\n<p><strong>Solution</strong></p>\n\n<p>If you get the error, you cannot continue the process. That's the reason why you cannot just print out the error. In order to stop gracefully the process, you need to return an HTTP status code and then return. For the case above, you can return a code 500 (internal server error).</p>\n\n<pre><code>t, err := template.ParseFiles(\"templates/index.gtpl\")\nif err != nil {\n  fmt.Println(err) // Ugly debug output\n  w.WriteHeader(http.StatusInternalServerError) // Proper HTTP response\n  return\n}\n</code></pre>\n\n<p>That has to be done for a <em>template.ParseFiles</em> and <em>t.Execute</em> too.</p>\n\n<p><em>By the way, that is called the \"comma ok\" pattern</em></p>\n"}], "owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7890, "favorite_count": 1, "accepted_answer_id": 33305749, "answer_count": 1, "score": 0, "last_activity_date": 1445639960, "creation_date": 1445598474, "question_id": 33300868, "link": "https://stackoverflow.com/questions/33300868/go-http-panic-serving", "title": "Go http panic serving", "body": "<p>I got this panic: </p>\n\n<pre><code>C:\\Users\\loow\\Desktop\\USBWebserver v8.5\\duplicate_submissions&gt;go run server.go\n2015/10/23 13:00:39 http: panic serving [::1]:63867: runtime error: invalid memo\nry address or nil pointer dereference\ngoroutine 5 [running]:\nnet/http.(*conn).serve.func1(0xc0820a1810, 0x3b55b8, 0xc082024040)\n        c:/go/src/net/http/server.go:1287 +0xbc\nmain.login(0x2990058, 0xc0820d4000, 0xc0820be1c0)\n        C:/Users/loow/Desktop/USBWebserver v8.5/duplicate_submissions/server.go:\n27 +0x5a5\nnet/http.HandlerFunc.ServeHTTP(0x8326a8, 0x2990058, 0xc0820d4000, 0xc0820be1c0)\n        c:/go/src/net/http/server.go:1422 +0x41\nnet/http.(*ServeMux).ServeHTTP(0xc082062360, 0x2990058, 0xc0820d4000, 0xc0820be1\nc0)\n        c:/go/src/net/http/server.go:1699 +0x184\nnet/http.serverHandler.ServeHTTP(0xc08200c360, 0x2990058, 0xc0820d4000, 0xc0820b\ne1c0)\n        c:/go/src/net/http/server.go:1862 +0x1a5\nnet/http.(*conn).serve(0xc0820a1810)\n        c:/go/src/net/http/server.go:1361 +0xbf5\ncreated by net/http.(*Server).Serve\n        c:/go/src/net/http/server.go:1910 +0x3fd\n2015/10/23 13:00:39 http: panic serving [::1]:63868: runtime error: invalid memo\nry address or nil pointer dereference\ngoroutine 33 [running]:\nnet/http.(*conn).serve.func1(0xc082114000, 0x3b55b8, 0xc082112000)\n        c:/go/src/net/http/server.go:1287 +0xbc\nmain.login(0x2990058, 0xc0821140b0, 0xc0821200e0)\n        C:/Users/loow/Desktop/USBWebserver v8.5/duplicate_submissions/server.go:\n27 +0x5a5\nnet/http.HandlerFunc.ServeHTTP(0x8326a8, 0x2990058, 0xc0821140b0, 0xc0821200e0)\n        c:/go/src/net/http/server.go:1422 +0x41\nnet/http.(*ServeMux).ServeHTTP(0xc082062360, 0x2990058, 0xc0821140b0, 0xc0821200\ne0)\n        c:/go/src/net/http/server.go:1699 +0x184\nnet/http.serverHandler.ServeHTTP(0xc08200c360, 0x2990058, 0xc0821140b0, 0xc08212\n00e0)\n        c:/go/src/net/http/server.go:1862 +0x1a5\nnet/http.(*conn).serve(0xc082114000)\n        c:/go/src/net/http/server.go:1361 +0xbf5\ncreated by net/http.(*Server).Serve\n        c:/go/src/net/http/server.go:1910 +0x3fd\nexit status 2\n</code></pre>\n\n<p>Whit this code: </p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n    \"net/http\"\n    \"html/template\"\n    \"log\"\n    \"time\"\n    \"crypto/md5\"\n    \"io\"\n    \"strconv\"\n)\n\nfunc loginForm(w http.ResponseWriter, r *http.Request){\n\n}\n\nfunc login(w http.ResponseWriter, r *http.Request){\n    fmt.Println(r.Method)\n    if r.Method == \"GET\"{\n        cruTime := time.Now().Unix()\n        h := md5.New()\n        io.WriteString(h,strconv.FormatInt(cruTime,10))\n        token := fmt.Sprintf(\"%x\", h.Sum(nil))\n        fmt.Println(token)\n        t, err := template.ParseFiles(\"templates/index.gtpl\")\n        fmt.Println(err.Error())\n        err = t.Execute(w, token)\n        fmt.Println(err.Error())\n    } else{\n        r.ParseForm()\n        token := r.Form.Get(\"token\")\n        if token != \"\"{\n            fmt.Println(token)\n        } else{\n            fmt.Println(\"There is no token\")\n        }\n        fmt.Println(\"username length: \", len(r.Form[\"username\"][0]))\n        fmt.Println(\"username: \", template.HTMLEscapeString(r.Form.Get(\"username\")))\n        fmt.Println(\"password: \", template.HTMLEscapeString(r.Form.Get(\"password\")))\n        template.HTMLEscape(w, []byte(r.Form.Get(\"username\")))\n\n    }\n}\n\nfunc main(){\n    http.HandleFunc(\"/\", loginForm)\n    http.HandleFunc(\"/login\", login)\n    err := http.ListenAndServe(\":9090\", nil)\n    if err != nil {\n        log.Fatal(\"ListenAndServe: \", err)\n    }\n}\n</code></pre>\n\n<p>I cant fix it, I tried everything what I found in the stackoverflow. What is the problem? There is no error, and the panic said that the problem in t, err := template.ParseFiles(\"templates/index.gtpl\")..</p>\n\n<p>There is the template file:</p>\n\n<pre><code>&lt;input type=\"checkbox\" name=\"interest\" value=\"football\"&gt;Football\n&lt;input type=\"checkbox\" name=\"interest\" value=\"basketball\"&gt;Basketball\n&lt;input type=\"checkbox\" name=\"interest\" value=\"tennis\"&gt;Tennis\nUsername: &lt;input type=\"text\" name=\"username\"&gt;\nPassword: &lt;input type=\"password\" name=\"password\"&gt;\n&lt;input type=\"hidden\" name=\"token\" value=\"{{.}}\"&gt;\n&lt;input type=\"submit\" value=\"Login\"&gt;\n</code></pre>\n"}, {"tags": ["go", "empty-list"], "comments": [{"owner": {"reputation": 46273, "user_id": 574479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/79f682361ccbe900f8846a1098d13921?s=128&d=identicon&r=PG", "display_name": "biziclop", "link": "https://stackoverflow.com/users/574479/biziclop"}, "edited": false, "score": 2, "creation_date": 1445594965, "post_id": 33299616, "comment_id": 54398490, "body": "I&#39;d probably try to measure it."}, {"owner": {"reputation": 9718, "user_id": 87584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f6dfb6c18bce2c8487312b77c32dbc3?s=128&d=identicon&r=PG", "display_name": "Fabien", "link": "https://stackoverflow.com/users/87584/fabien"}, "reply_to_user": {"reputation": 46273, "user_id": 574479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/79f682361ccbe900f8846a1098d13921?s=128&d=identicon&r=PG", "display_name": "biziclop", "link": "https://stackoverflow.com/users/574479/biziclop"}, "edited": false, "score": 1, "creation_date": 1445602138, "post_id": 33299616, "comment_id": 54402612, "body": "Yes but subtle measures tend to be error-prone and I&#39;m afraid the context of my test might have side effects that have nothing to do with the underlying problem I&#39;m dealing with. Plus, I&#39;d rather know <i>why</i> what I measure happens rather than just observe it happened."}], "answers": [{"comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1445612370, "post_id": 33300201, "comment_id": 54409798, "body": "@CodingPickle I was careful not to suggest otherwise. Why the down vote?"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1445614513, "post_id": 33300201, "comment_id": 54411290, "body": "First part: fair enough. I&#39;ll edit the answer to be explicit about nil. Second part: The Go spec makes no guarantees about stack vs heap. In that sense, an <code>int</code> value can perfectly live on the heap. Passing by value or pointer doesn&#39;t have anything to do with it either. As OP puts his slice headers onto another slice, they&#39;re <i>most probably</i> allocated on the heap. If not, then copied there from the stack. Anyhow these are implementation details."}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 3, "last_activity_date": 1445598448, "last_edit_date": 1445598448, "creation_date": 1445596125, "answer_id": 33300201, "question_id": 33299616, "link": "https://stackoverflow.com/questions/33299616/in-go-is-it-worth-avoiding-creating-slices-of-size-0/33300201#33300201", "title": "In go, is it worth avoiding creating slices of size 0?", "body": "<blockquote>\n  <p>Does make([]int, 0) allocates some memory</p>\n</blockquote>\n\n<p>Yes, it allocates a slice header but no backing array. If the slice header doesn't escape the current scope it may be allocated on the stack.</p>\n\n<blockquote>\n  <p>less memory efficient than a nil slice</p>\n</blockquote>\n\n<p>In terms of memory used, they're the same.</p>\n\n<blockquote>\n  <p>is it worth doing a test to avoid useless allocations</p>\n</blockquote>\n\n<p>In general yes, the 3 or 4 instructions it takes to compare an int are nothing compared to the cycles you'd need to do a memory allocation and initialization.</p>\n"}, {"tags": [], "owner": {"reputation": 15557, "user_id": 390807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f64fce01ffa86130c3fae06b1fcadef?s=128&d=identicon&r=PG", "display_name": "chill", "link": "https://stackoverflow.com/users/390807/chill"}, "is_accepted": true, "score": 4, "last_activity_date": 1445597889, "creation_date": 1445597889, "answer_id": 33300699, "question_id": 33299616, "link": "https://stackoverflow.com/questions/33299616/in-go-is-it-worth-avoiding-creating-slices-of-size-0/33300699#33300699", "title": "In go, is it worth avoiding creating slices of size 0?", "body": "<p>There is no difference in the allocated memory between</p>\n\n<pre><code>var a []T // nil slice\n</code></pre>\n\n<p>and</p>\n\n<pre><code>a := make([]T, 0) // zero-length, zero-capacity, non-nil slice\n</code></pre>\n\n<p>The difference is in the slice header content. In the second case the slice pointer contains some fixed address, same for all 0-sized allocations.</p>\n\n<p>If this code is in a performance critical part of the program, the difference makes ... quite a difference. In the first case you do zero the slice header, in the second case you go through 3-4 function calls, some range checks for cap and length, etc. before malloc returns a pointer to the zero base.</p>\n"}], "owner": {"reputation": 9718, "user_id": 87584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f6dfb6c18bce2c8487312b77c32dbc3?s=128&d=identicon&r=PG", "display_name": "Fabien", "link": "https://stackoverflow.com/users/87584/fabien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "accepted_answer_id": 33300699, "answer_count": 2, "score": 1, "last_activity_date": 1445598448, "creation_date": 1445594294, "question_id": 33299616, "link": "https://stackoverflow.com/questions/33299616/in-go-is-it-worth-avoiding-creating-slices-of-size-0", "title": "In go, is it worth avoiding creating slices of size 0?", "body": "<p>I have a program in which I'm going to make lots and lots of slices, some of which might be empty:</p>\n\n<pre><code>nb := something() // something might return 0\nslices = append(slices, make([]int, nb))\n</code></pre>\n\n<p>Does <code>make([]int, 0)</code> allocates some memory and is, thus, less memory efficient than a <code>nil</code> slice although they share the same behavior ? By how much ?</p>\n\n<p>If so, is it worth doing a test to avoid useless allocations, or is the CPU time cost of the test not worth the saving in memory (or any other reason not to do so) ?</p>\n\n<pre><code>var sl slice\nnb := something()\nif nb &gt; 0 {\n    sl = make([]int, nb)\n}\nslices = append(slices, sl)\n</code></pre>\n"}, {"tags": ["go", "unmarshalling"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1445593172, "post_id": 33299099, "comment_id": 54397383, "body": "Why not just make <code>FullName</code> a method? This way it will always return a correct full name even if <code>FirstName</code> or <code>LastName</code> change."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1445594118, "post_id": 33299099, "comment_id": 54397981, "body": "Of course you can make encoding/json make use your own unmarshilng code, just implement Unmarshaller (<a href=\"https://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/json/#Unmarshaler</a>). But Ainars idea is better (at least for tiny and fast computations)."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1445594393, "creation_date": 1445594393, "answer_id": 33299644, "question_id": 33299099, "link": "https://stackoverflow.com/questions/33299099/automatically-create-computed-fields-after-json-unmarshalling/33299644#33299644", "title": "Automatically create computed fields after JSON unmarshalling", "body": "<p>In this case I would just turn <code>FullName</code> into a method. But if you really need to make it that way, just create a wrapper type that is also a <code>json.Unmarshaler</code>:</p>\n\n<pre><code>type DataEntryForJSON DataEntry\n\nfunc (d *DataEntryForJSON) UnmarshalJSON(b []byte) error {\n    if err := json.Unmarshal(b, (*DataEntry)(d)); err != nil {\n        return err\n    }\n    d.FullName = d.FirstName + \" \" + d.LastName\n    return nil\n}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/g9BnytB5DG\" rel=\"nofollow\">http://play.golang.org/p/g9BnytB5DG</a>.</p>\n"}], "owner": {"reputation": 15349, "user_id": 2282538, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0a4fff09f1f0e3360daeabb30c2c06bb?s=128&d=identicon&r=PG", "display_name": "Tyler", "link": "https://stackoverflow.com/users/2282538/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 33299644, "answer_count": 1, "score": 0, "last_activity_date": 1445594393, "creation_date": 1445592779, "last_edit_date": 1445592895, "question_id": 33299099, "link": "https://stackoverflow.com/questions/33299099/automatically-create-computed-fields-after-json-unmarshalling", "title": "Automatically create computed fields after JSON unmarshalling", "body": "<p><em>Simplified example</em></p>\n\n<p>Lets say I have a struct which I use to unmarshall some json:</p>\n\n<pre><code>type DataEntry struct {\n    FirstName string `json:\"first\"`\n    LastName  string `json:\"last\"`\n    FullName  string\n}\n</code></pre>\n\n<p>What I want to fill the <code>FullName</code> property, which would be <code>FirstName + LastName</code>.  </p>\n\n<hr>\n\n<p>What I am currently doing is defining a method for DataEntry, which does these kind of computations:</p>\n\n<pre><code>func (de *DataEntry) Compute() {\n   de.FullName = de.FirstName + \" \" + de.LastName\n}\n</code></pre>\n\n<p>and calling if after the struct gets filled from the JSON:</p>\n\n<pre><code>// Grab data\nrequest, _ := http.Get(\"http://........\")\nvar entry DataEntry\ndec := json.NewDecoder(request.Body)\ndec.Decode(&amp;entry)\n\n// Compute the computed fields\nentry.Compute()\n</code></pre>\n\n<hr>\n\n<p>Is there a better way to do this?  Could I use create my own <code>UnmarshalJSON</code> and use that as a trigger to automatically compute the <code>FullName</code> field?</p>\n"}, {"tags": ["json", "go", "type-assertion"], "comments": [{"owner": {"reputation": 11891, "user_id": 1930219, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5ae618e4950c81bf0d83d17c2c2ddaab?s=128&d=identicon&r=PG", "display_name": "Alex Netkachov", "link": "https://stackoverflow.com/users/1930219/alex-netkachov"}, "edited": false, "score": 0, "creation_date": 1445591910, "post_id": 33298489, "comment_id": 54396615, "body": "This is called &quot;generics&quot; or &quot;templates&quot; and they are not available in Go (I hope it is temporary :-) But you probably can generate these functions."}, {"owner": {"reputation": 10946, "user_id": 1259261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a105607c3fd93df0d386c6d6a6b4aad?s=128&d=identicon&r=PG", "display_name": "Daniel Robinson", "link": "https://stackoverflow.com/users/1259261/daniel-robinson"}, "reply_to_user": {"reputation": 11891, "user_id": 1930219, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5ae618e4950c81bf0d83d17c2c2ddaab?s=128&d=identicon&r=PG", "display_name": "Alex Netkachov", "link": "https://stackoverflow.com/users/1930219/alex-netkachov"}, "edited": false, "score": 1, "creation_date": 1445592641, "post_id": 33298489, "comment_id": 54397069, "body": "yeh I understand it&#39;s generics and that go doesn&#39;t have them, but sometimes some smart person comes up with some way of doing something that reduces the amount of repeated code."}, {"owner": {"reputation": 11891, "user_id": 1930219, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5ae618e4950c81bf0d83d17c2c2ddaab?s=128&d=identicon&r=PG", "display_name": "Alex Netkachov", "link": "https://stackoverflow.com/users/1930219/alex-netkachov"}, "edited": false, "score": 0, "creation_date": 1445593236, "post_id": 33298489, "comment_id": 54397425, "body": "I see. Sorry, but there is no such way :) For example, because there is no way to &quot;templatize&quot; the output type."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 2, "creation_date": 1445594585, "post_id": 33298489, "comment_id": 54398282, "body": "Note that getters in Go are written <a href=\"https://golang.org/doc/effective_go.html#Getters\" rel=\"nofollow noreferrer\">without the Get prefix</a>."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1445595503, "post_id": 33298489, "comment_id": 54398832, "body": "what about using reflect. then <code>GetString</code> can be <code>Get(Kind.String)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1445595679, "post_id": 33300032, "comment_id": 54398924, "body": "FYI, there is already a library that does this that you may find useful: <a href=\"https://godoc.org/github.com/bitly/go-simplejson\" rel=\"nofollow noreferrer\">godoc.org/github.com/bitly/go-simplejson</a>"}], "tags": [], "owner": {"reputation": 10946, "user_id": 1259261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a105607c3fd93df0d386c6d6a6b4aad?s=128&d=identicon&r=PG", "display_name": "Daniel Robinson", "link": "https://stackoverflow.com/users/1259261/daniel-robinson"}, "is_accepted": true, "score": 0, "last_activity_date": 1446481679, "last_edit_date": 1446481679, "creation_date": 1445595582, "answer_id": 33300032, "question_id": 33298489, "link": "https://stackoverflow.com/questions/33298489/is-there-a-more-concise-way-of-using-json-objects-of-unknown-structure-in-golang/33300032#33300032", "title": "Is there a more concise way of using json objects of unknown structure in golang?", "body": "<p>This is the best I've got right now, as a very simple example: <a href=\"https://play.golang.org/p/U9WJ0bIJPp\" rel=\"nofollow\">https://play.golang.org/p/U9WJ0bIJPp</a>\nI can't imagine you'd be able to compress/extract it much more than this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"errors\"\n)\n\ntype T interface{}\ntype JsonObj map[string]T\n\nfunc (jo JsonObj) Type(name string, defaultVal T, typeName string, typeAsserter func(val T) (T, bool)) (T, error){\n    if val, exists := jo[name]; exists {\n        if v, ok := typeAsserter(val); ok {\n            return v, nil\n        }\n        return defaultVal, errors.New(name+\" is not of type \"+typeName)\n    }\n    return defaultVal, errors.New(name+\" property not found\")\n}\n\nfunc (jo JsonObj) String(name string) (string, error) {\n    ret, err := jo.Type(name, \"\", \"string\", func(val T)(ret T, ok bool){ret, ok = val.(string);return})\n    return ret.(string), err\n}\n\nfunc (jo JsonObj) Float64(name string) (float64, error) {\n    ret, err := jo.Type(name, 0, \"float64\", func(val T)(ret T, ok bool){ret, ok = val.(float64);return})\n    return ret.(float64), err\n}\n\nfunc (jo JsonObj) Int(name string) (int, error) {\n    ret, err := jo.Type(name, 0, \"int\", func(val T)(ret T, ok bool){if ret, ok = val.(float64); ok {ret = int(ret.(float64))};return})\n    return ret.(int), err\n}\n\nfunc (jo JsonObj) Bool(name string) (bool, error) {\n    ret, err := jo.Type(name, false, \"bool\", func(val T)(ret T, ok bool){ret, ok = val.(bool);return})\n    return ret.(bool), err\n}\n\nfunc main() {\n    jo := JsonObj{\n        \"aString\": \"foo\",\n        \"aFloat64\": 3.142,\n        \"anInt\": 42.0, //in a json string unmarshalling all numbers are float64 even \"int\"s\n        \"aBool\": true,\n\n    }\n    fmt.Println(jo.String(\"aString\"))\n    fmt.Println(jo.Float64(\"aFloat64\"))\n    fmt.Println(jo.Int(\"anInt\"))\n    fmt.Println(jo.Bool(\"aBool\"))\n    fmt.Println(jo.String(\"missingString\"))\n    fmt.Println(jo.Bool(\"anInt\"))\n}\n</code></pre>\n\n<p>But as mentioned in the comments there is a library which provides a much more robust means of working with arbitrary json, <a href=\"https://github.com/bitly/go-simplejson\" rel=\"nofollow\">https://github.com/bitly/go-simplejson</a></p>\n"}], "owner": {"reputation": 10946, "user_id": 1259261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a105607c3fd93df0d386c6d6a6b4aad?s=128&d=identicon&r=PG", "display_name": "Daniel Robinson", "link": "https://stackoverflow.com/users/1259261/daniel-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 33300032, "answer_count": 1, "score": 3, "last_activity_date": 1446481679, "creation_date": 1445590753, "last_edit_date": 1445591156, "question_id": 33298489, "link": "https://stackoverflow.com/questions/33298489/is-there-a-more-concise-way-of-using-json-objects-of-unknown-structure-in-golang", "title": "Is there a more concise way of using json objects of unknown structure in golang?", "body": "<p>When I have a reliable rest api endpoint that returns some simple json, I can use a struct to define exactly the structure of the expected json result, but there are certain endpoints I have to use that return very large and complex json result data, and the structure of these results are not always known.</p>\n\n<p>I have been using this to unmarshal into:</p>\n\n<pre><code>type JsonObj map[string]interface{}\n\nfunc (jo JsonObj) GetString(name string) (string, error) {\n    if val, exists := jo[name]; exists {\n        if v, ok := val.(string); ok {\n            return v, nil\n        }\n        return \"\", errors.New(name+\" is not a string\")\n    }\n    return \"\", errors.New(name+\" property not found\")\n}\n\nfunc (jo JsonObj) GetFloat64(name string) (float64, error) {\n    if val, exists := jo[name]; exists {\n        if v, ok := val.(float64); ok {\n            return v, nil\n        }\n        return 0, errors.New(name+\" is not a float64\")\n    }\n    return 0, errors.New(name+\" property not found\")\n}\n</code></pre>\n\n<p>and in this same way I have <code>GetInt</code>, <code>GetBool</code>, <code>GetSlice</code>, <code>GetJsonObj</code>,</p>\n\n<p>but as you can see all of these functions are virtually identical in content except for the type assertion parameter. is there a way of passing in the type assertion parameter to reduce all these functions effectively to a single function?</p>\n"}, {"tags": ["sql", "go", "initialization"], "answers": [{"comments": [{"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 2, "creation_date": 1445606604, "post_id": 33298070, "comment_id": 54405591, "body": "Wrong, since db.Open does not open a connection to the database but creates a connection pool. You should not open and close it all the time. I manages the connections for you."}], "tags": [], "owner": {"reputation": 27, "user_id": 2658497, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5d2daa947b7155ffc1f01fb9d7e83aaf?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/2658497/james"}, "is_accepted": false, "score": -2, "last_activity_date": 1445589348, "creation_date": 1445589348, "answer_id": 33298070, "question_id": 33298030, "link": "https://stackoverflow.com/questions/33298030/initialize-database-as-global-variable/33298070#33298070", "title": "Initialize database as global variable", "body": "<p>As a rule of thumb I don't think its good practice to use database connections this way, you should privatize it and just open/close as you need it :)</p>\n\n<p>But if it works and you like it then nothings wrong with doing it that way.</p>\n"}, {"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1445615812, "post_id": 33303308, "comment_id": 54412116, "body": "<a href=\"http://www.alexedwards.net/blog/organising-database-access\" rel=\"nofollow noreferrer\">alexedwards.net/blog/organising-database-access</a> also discusses other approaches to this."}], "tags": [], "owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "is_accepted": false, "score": 2, "last_activity_date": 1445608264, "last_edit_date": 1445608264, "creation_date": 1445606314, "answer_id": 33303308, "question_id": 33298030, "link": "https://stackoverflow.com/questions/33298030/initialize-database-as-global-variable/33303308#33303308", "title": "Initialize database as global variable", "body": "<p>In go you typicallly initialize a global *DB struct using Open (at least global in your Database Access package). That does not open an actual connection to the DB, but creates a connection pool. Therefore there should be only one instance of it. You can initialize that in init of your package.</p>\n\n<p>See \n<a href=\"http://go-database-sql.org/\" rel=\"nofollow\">http://go-database-sql.org/</a>\nor \n<a href=\"https://www.vividcortex.com/blog/2015/01/14/the-ultimate-guide-to-building-database-driven-apps-with-go/\" rel=\"nofollow\">https://www.vividcortex.com/blog/2015/01/14/the-ultimate-guide-to-building-database-driven-apps-with-go/</a>\nfor a good introductory guide.</p>\n"}, {"tags": [], "owner": {"reputation": 1945, "user_id": 1586394, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/1hfhi.jpg?s=128&g=1", "display_name": "maddygoround", "link": "https://stackoverflow.com/users/1586394/maddygoround"}, "is_accepted": false, "score": 0, "last_activity_date": 1445668755, "creation_date": 1445668755, "answer_id": 33315302, "question_id": 33298030, "link": "https://stackoverflow.com/questions/33298030/initialize-database-as-global-variable/33315302#33315302", "title": "Initialize database as global variable", "body": "<p>Yes it is a good approach. when you go through the go documentation it clearly tells you </p>\n\n<blockquote>\n  <p>It is rare to Close a DB, as the DB handle is meant to be long-lived\n  and shared between many go routines.</p>\n</blockquote>\n\n<p>Go maintains its own pool of idle connections. Thus, the Open function should be called just once. It is rarely necessary to close a DB.</p>\n"}], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1445668755, "creation_date": 1445589218, "question_id": 33298030, "link": "https://stackoverflow.com/questions/33298030/initialize-database-as-global-variable", "title": "Initialize database as global variable", "body": "<p>Is it a good idea to initialize databaze as global variable? Can it work?</p>\n\n<p>I'm thinking about something like that:</p>\n\n<pre><code>func MustDB(d *sql.DB, err error) *sql.DB {\n   if err != nil {\n     log.Panic(err)\n   }\n   return d\n}\n\n// what I don't know - is how to call db.Close()\n// username and password can also be read similar way\nvar db *DB = MustDB(db.Open(...))\n\nfunc MustPrepare(db *sql.DB, query string) *sql.Stmt {\n  res, err := sql.Prepare(db, query)\n  if err!=nil {\n    log.Panic(err)\n  }\n  return ret;\n}\n</code></pre>\n\n<p>The advantage is, I can simple create prepared sql statements as global variables. I don't have to create and manage a storage, where all sql commands will be put. Only I write:</p>\n\n<pre><code>var s1 *sql.Stmt = MustPrepare(db, \"SELECT * FROM MyTable\")\nvar s2 *sql.Stmt = MustPrepare(db, \"INSERT INTO MyTable(col1, col2) VALUES(?,?)\")\nvar s3 *sql.Stmt = MustPrepare(db, \"DELETE FROM MyTable WHERE col1=?\")\n</code></pre>\n\n<p>Do you think, that pattern is usefull, or it cannot work at all.</p>\n"}, {"tags": ["go", "docker", "gdb", "ubuntu-14.04", "cgdb"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1445607274, "post_id": 33295788, "comment_id": 54406049, "body": "Are you trying to use gccgo (I don&#39;t think <code>-O0</code> is a valid option for anything in the go toolchain)?."}], "owner": {"reputation": 781, "user_id": 4162248, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/20a90b2be1791eb0ca90f6a16fa543c4?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Petr", "link": "https://stackoverflow.com/users/4162248/greg-petr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 347, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1445581923, "creation_date": 1445580244, "last_edit_date": 1445581923, "question_id": 33295788, "link": "https://stackoverflow.com/questions/33295788/debug-docker-deamon-with-gdb-or-cgdb", "title": "debug docker deamon with gdb or cgdb", "body": "<p>I have been trying to debug and step into docker daemon code using <code>gdb</code> or <code>cgdb</code> on a Ubuntu 14.04 container running on host OS (ubuntu 14.04 OS). I have used <code>-O0 -g</code> flags while building the debug binaries within a container. </p>\n\n<p>Version of go used in the container:</p>\n\n<pre><code># go version\ngo version go1.4.3 linux/amd64\n</code></pre>\n\n<p>I am unable to step through the code using <code>cgdb</code>: </p>\n\n<pre><code>&lt;http://www.gnu.org/software/gdb/documentation/&gt;. \nFor help, type \"help\". \nType \"apropos word\" to search for commands related to \"word\"... Reading symbols from bundles/1.9.0-dev/dynbinary/docker...done. (\n\ngdb) b main.handleGlobalDaemonFlag \nBreakpoint 1 at 0x497b30 \n(gdb) r daemon -D \nStarting program: /go/src/github.com/docker/docker/bundles/1.9.0-dev/dynbinary/docker daemon -D \n[Thread debugging using libthread_db enabled] \nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\". \n[New Thread 0x7ffff5a00700 (LWP 2775)] \n[New Thread 0x7ffff51ff700 (LWP 2776)] \n[New Thread 0x7ffff49fe700 (LWP 2777)]\n\nBreakpoint 1, 0x0000000000497b30 in main.handleGlobalDaemonFlag () \n\n(gdb) n Single stepping until exit from function main.handleGlobalDaemonFlag, which has no line number information.\n\nBreakpoint 1, 0x0000000000497b30 in main.handleGlobalDaemonFlag () \n(gdb) l 1       in /tmp/go-build212795923/github.com/docker/docker/pkg/term/_obj/_cgo_export.c \n\n(gdb)\n</code></pre>\n\n<p>How to confirm that the built binaries are debug ? Can I use a tool <code>readelf</code> to read through the headers to confirm this ? </p>\n\n<p>Should I be setting a GOPATH or GOROOT to a specific directory ? </p>\n\n<pre><code>root@6511af5b06c1:/go/src/github.com/docker/docker# echo $GOROOT\n\nroot@6511af5b06c1:/go/src/github.com/docker/docker# echo $GOPATH\n/go:/go/src/github.com/docker/docker/vendor\n</code></pre>\n\n<p>Are there any other dependencies which could be missing on my environment ?</p>\n"}, {"tags": ["postgresql", "hash", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1445582756, "post_id": 33295624, "comment_id": 54391891, "body": "You can always truncate the output of a hash function, but then this is no longer the value of the hash. Maybe you could describe your real problem/task?"}, {"owner": {"reputation": 217, "user_id": 4443249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100000487150108/picture?type=large", "display_name": "nanolab", "link": "https://stackoverflow.com/users/4443249/nanolab"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1445583208, "post_id": 33295624, "comment_id": 54392074, "body": "@Volker already described the problem. I need to store uint64 hash in database as bigserial. Seems my code works, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1445586217, "post_id": 33296486, "comment_id": 54393573, "body": "If my thinking is correct, this could produce <code>hash == 0</code>, which is not allowed in OPs database, so I guess we should do <code>hash = (hash % 9223372036854775806) + 1</code>?"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1445586349, "post_id": 33296486, "comment_id": 54393641, "body": "Yes, according to the original post you&#39;re correct."}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 2, "last_activity_date": 1445587879, "last_edit_date": 1445587879, "creation_date": 1445583442, "answer_id": 33296486, "question_id": 33295624, "link": "https://stackoverflow.com/questions/33295624/modified-fnv-1-hash-algorithm-in-golang/33296486#33296486", "title": "Modified FNV-1 hash algorithm in golang", "body": "<blockquote>\n  <p>Is it correct?</p>\n</blockquote>\n\n<p>Yes, it's a correct XOR-folding to 63 bits. But there's a much easier way:</p>\n\n<pre><code>hash = hash % 9223372036854775808\n</code></pre>\n\n<p>The distribution of XOR-folding is dubious, probably proven somewhere but not immediately obvious. Modulo, however, is clearly a wrapping of the hash algo's distribution to a smaller codomain.</p>\n"}], "owner": {"reputation": 217, "user_id": 4443249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100000487150108/picture?type=large", "display_name": "nanolab", "link": "https://stackoverflow.com/users/4443249/nanolab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 0, "accepted_answer_id": 33296486, "answer_count": 1, "score": 0, "last_activity_date": 1445587879, "creation_date": 1445579265, "last_edit_date": 1445582825, "question_id": 33295624, "link": "https://stackoverflow.com/questions/33295624/modified-fnv-1-hash-algorithm-in-golang", "title": "Modified FNV-1 hash algorithm in golang", "body": "<p>Native library has FNV-1 hash algorithm <a href=\"https://golang.org/pkg/hash/fnv/\" rel=\"nofollow\">https://golang.org/pkg/hash/fnv/</a> that returns uint64 value (range: 0 through 18446744073709551615).\nI need to store this value in PostgreSQL bigserial, but it's range is 1 to 9223372036854775807.</p>\n\n<p>It is possible to change hash size to eg. 56?<a href=\"http://www.isthe.com/chongo/tech/comp/fnv/index.html#xor-fold\" rel=\"nofollow\">http://www.isthe.com/chongo/tech/comp/fnv/index.html#xor-fold</a></p>\n\n<p>Can someone help to change native algorithm to produce 56 bit hashes?\n<a href=\"https://golang.org/src/hash/fnv/fnv.go\" rel=\"nofollow\">https://golang.org/src/hash/fnv/fnv.go</a></p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>Did it myself using this doc <a href=\"http://www.isthe.com/chongo/tech/comp/fnv/index.html#xor-fold\" rel=\"nofollow\">http://www.isthe.com/chongo/tech/comp/fnv/index.html#xor-fold</a></p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"hash/fnv\"\n)\n\nfunc main() {\n    const MASK uint64 = 1&lt;&lt;63 - 1\n    h := fnv.New64()\n    h.Write([]byte(\"1133\"))\n    hash := h.Sum64()\n    fmt.Printf(\"%#x\\n\", MASK)\n    fmt.Println(hash)\n    hash = (hash &gt;&gt; 63) ^ (hash &amp; MASK)\n    fmt.Println(hash)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/j7q3D73qqu\" rel=\"nofollow\">http://play.golang.org/p/j7q3D73qqu</a></p>\n\n<p>Is it correct?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1016, "user_id": 927687, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1be4ac81206ec06500f79d1b9972f25d?s=128&d=identicon&r=PG", "display_name": "Bhoomtawath Plinsut", "link": "https://stackoverflow.com/users/927687/bhoomtawath-plinsut"}, "edited": false, "score": 0, "creation_date": 1445583596, "post_id": 33296464, "comment_id": 54392251, "body": "Thank you. I&#39;m new to Go and still unfamiliar with the way it represent an interface implementation."}, {"owner": {"reputation": 2219, "user_id": 8608146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3B2gl.jpg?s=128&g=1", "display_name": "Phani Rithvij", "link": "https://stackoverflow.com/users/8608146/phani-rithvij"}, "edited": false, "score": 0, "creation_date": 1603885600, "post_id": 33296464, "comment_id": 114176223, "body": "@mrd0ll4r&#39;s answer is correct. This indeed results in wrong frames."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1445583365, "creation_date": 1445583365, "answer_id": 33296464, "question_id": 33295023, "link": "https://stackoverflow.com/questions/33295023/how-to-split-gif-into-images/33296464#33296464", "title": "How to split gif into images", "body": "<p><a href=\"https://golang.org/pkg/image/#Image\" rel=\"nofollow\"><code>image.Image</code></a> is an interface, and <a href=\"https://golang.org/pkg/image/#Paletted\" rel=\"nofollow\"><code>*image.Paletted</code></a> implements the interface, so for example if you want to save every frame of a GIF into a PNG file, you can just encode every image:</p>\n\n<pre><code>for i, frame := range img.Image {\n    frameFile, err := os.OpenFile(fmt.Sprintf(\"%d.png\", i+1), os.O_CREATE|os.O_TRUNC|os.O_WRONLY, 0666)\n    if err != nil {\n        log.Fatal(err)\n    }\n    err = png.Encode(frameFile, frame)\n    if err != nil {\n        log.Fatal(err)\n    }\n    // Not using defer here because we're in a loop, not a function.\n    frameFile.Close()\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1445611814, "post_id": 33296596, "comment_id": 54409361, "body": "Oh yeah, that&#39;s correct. I have taken the code from a project I&#39;ve written some time ago, so I probably didn&#39;t know about it then, will fix, thanks!"}, {"owner": {"reputation": 1016, "user_id": 927687, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1be4ac81206ec06500f79d1b9972f25d?s=128&d=identicon&r=PG", "display_name": "Bhoomtawath Plinsut", "link": "https://stackoverflow.com/users/927687/bhoomtawath-plinsut"}, "edited": false, "score": 0, "creation_date": 1445780624, "post_id": 33296596, "comment_id": 54457517, "body": "draw.Draw will blend the current frame with the previous frame, right? Thank you for your detailed answer."}, {"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "reply_to_user": {"reputation": 1016, "user_id": 927687, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1be4ac81206ec06500f79d1b9972f25d?s=128&d=identicon&r=PG", "display_name": "Bhoomtawath Plinsut", "link": "https://stackoverflow.com/users/927687/bhoomtawath-plinsut"}, "edited": false, "score": 1, "creation_date": 1445842722, "post_id": 33296596, "comment_id": 54475979, "body": "@BhoomtawathPlinsut <code>draw.Draw</code> will blend the current frame with <i>all</i> the previous frames, which in turn were blended with their previous frames, so yes :)"}, {"owner": {"reputation": 2903, "user_id": 4257217, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/i1EYW.png?s=128&g=1", "display_name": "GreenRaccoon23", "link": "https://stackoverflow.com/users/4257217/greenraccoon23"}, "edited": false, "score": 1, "creation_date": 1453828640, "post_id": 33296596, "comment_id": 57766218, "body": "One small note: the <code>os.Open</code> call inside the &#39;for&#39; loop will return an error if the file doesn&#39;t exist, and it probably will not exist. A better one might be <code>os.OpenFile(fmt.Sprintf(&quot;%s%d%s&quot;, &quot;&lt;some path&gt;&quot;, i, &quot;.png&quot;), os.O_RDWR|os.O_CREATE|os.O_APPEND, 0655)</code>"}, {"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "reply_to_user": {"reputation": 2903, "user_id": 4257217, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/i1EYW.png?s=128&g=1", "display_name": "GreenRaccoon23", "link": "https://stackoverflow.com/users/4257217/greenraccoon23"}, "edited": false, "score": 1, "creation_date": 1453879058, "post_id": 33296596, "comment_id": 57787538, "body": "@GreenRaccoon23, thanks, I should&#39;ve know that! I changed it to use <code>os.Create</code>, which is probably easier to understand"}], "tags": [], "owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "is_accepted": true, "score": 7, "last_activity_date": 1453879004, "last_edit_date": 1453879004, "creation_date": 1445583891, "answer_id": 33296596, "question_id": 33295023, "link": "https://stackoverflow.com/questions/33295023/how-to-split-gif-into-images/33296596#33296596", "title": "How to split gif into images", "body": "<p>Consider the following:<br>\nFrames can contain transparent pixels or areas, a good example is <a href=\"https://de.wikipedia.org/wiki/Graphics_Interchange_Format#/media/File:SmallFullColourGIF.gif\" rel=\"noreferrer\">this image on wikipedia</a> which (I guess) has one of these full-color blocks per frame and the rest of the frame transparent.</p>\n\n<p>This introduces a problem for you: Especially with animated GIFs, that do not use multiple frames to create a true-colored static image, the frames that <code>DecodeAll</code> returns are <em>not</em> what you actually see if you, for example, open the image in your browser.</p>\n\n<p>You'll have to process the image in the same way your browser would, i.e. leave the old frames on a kind of canvas and overpaint with the new frame. <strong>BUT</strong> this is not always true. GIF frames can, AFAIK, contain a disposal method, specifying how (or if?) you should dispose of the frame.</p>\n\n<p>Anyways, to get to your point, the most simple approach that will also work in most cases is something like</p>\n\n<pre><code>import (\n    \"errors\"\n    \"fmt\"\n    \"image\"\n    \"image/draw\"\n    \"image/gif\"\n    \"image/png\"\n    \"io\"\n    \"os\"\n)\n\n// Decode reads and analyzes the given reader as a GIF image\nfunc SplitAnimatedGIF(reader io.Reader) (err error) {\n    defer func() {\n        if r := recover(); r != nil {\n            err = fmt.Errorf(\"Error while decoding: %s\", r)\n        }\n    }()\n\n    gif, err := gif.DecodeAll(reader)\n\n    if err != nil {\n        return err\n    }\n\n    imgWidth, imgHeight := getGifDimensions(gif)\n\n    overpaintImage := image.NewRGBA(image.Rect(0, 0, imgWidth, imgHeight))\n    draw.Draw(overpaintImage, overpaintImage.Bounds(), gif.Image[0], image.ZP, draw.Src)\n\n    for i, srcImg := range gif.Image {\n        draw.Draw(overpaintImage, overpaintImage.Bounds(), srcImg, image.ZP, draw.Over)\n\n        // save current frame \"stack\". This will overwrite an existing file with that name\n        file, err := os.Create(fmt.Sprintf(\"%s%d%s\", \"&lt;some path&gt;\", i, \".png\"))\n        if err != nil {\n            return err\n        }\n\n        err = png.Encode(file, overpaintImage)\n        if err != nil {\n            return err\n        }\n\n        file.Close()\n    }\n\n    return nil\n}\n\nfunc getGifDimensions(gif *gif.GIF) (x, y int) {\n    var lowestX int\n    var lowestY int\n    var highestX int\n    var highestY int\n\n    for _, img := range gif.Image {\n        if img.Rect.Min.X &lt; lowestX {\n            lowestX = img.Rect.Min.X\n        }\n        if img.Rect.Min.Y &lt; lowestY {\n            lowestY = img.Rect.Min.Y\n        }\n        if img.Rect.Max.X &gt; highestX {\n            highestX = img.Rect.Max.X\n        }\n        if img.Rect.Max.Y &gt; highestY {\n            highestY = img.Rect.Max.Y\n        }\n    }\n\n    return highestX - lowestX, highestY - lowestY\n}\n</code></pre>\n\n<p>(untested, but should work)</p>\n\n<p>Note that <code>gif.DecodeAll</code> can and will panic <em>frequently</em>, because a lot of the GIF images on the internet are somewhat broken. Your browser tries to decode them and will, for example, replace missing colors with black. <code>image/gif</code> will not do that, but panic instead. That's why we <code>defer</code> the <code>recover</code>.</p>\n\n<p>Also, I used the <code>getGifDimensions</code> for a similar reason as stated above: single frames need not be what you see in your browser. In this case, the frames are just smaller than the complete image, that's why we have to iterate over all frames and get the \"true\" dimensions of the image.</p>\n\n<p>If you really <em>really</em> want to do it right, you should probably read the GIF spec <a href=\"http://www.w3.org/Graphics/GIF/spec-gif87.txt\" rel=\"noreferrer\">GIF87a</a>, <a href=\"http://www.w3.org/Graphics/GIF/spec-gif89a.txt\" rel=\"noreferrer\">GIF89a</a> and something like <a href=\"http://www.webreference.com/content/studio/disposal.html\" rel=\"noreferrer\">this article</a> which is a lot easier to understand. From that, you should decide how to dispose of the frames and what to do with transparency while overpainting.</p>\n\n<p><strong>EDIT</strong>: Some of the effects mentioned earlier can be observed easily if you split some GIFs online, for example <a href=\"http://ezgif.com/split/ecd3597e36.gif\" rel=\"noreferrer\">this</a> or <a href=\"http://ezgif.com/split/5ea1f2a24c.gif\" rel=\"noreferrer\">this</a> - play around with \"Ignore optimizations\" and \"Redraw every frame with details from previous frames\" to see what I mean.</p>\n"}], "owner": {"reputation": 1016, "user_id": 927687, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1be4ac81206ec06500f79d1b9972f25d?s=128&d=identicon&r=PG", "display_name": "Bhoomtawath Plinsut", "link": "https://stackoverflow.com/users/927687/bhoomtawath-plinsut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1622, "favorite_count": 0, "accepted_answer_id": 33296596, "answer_count": 2, "score": 4, "last_activity_date": 1453879004, "creation_date": 1445575419, "question_id": 33295023, "link": "https://stackoverflow.com/questions/33295023/how-to-split-gif-into-images", "title": "How to split gif into images", "body": "<p>How can I split gif into images in go?\nimage/gif's DecodeAll return GIF, which contains an array of palette. But don't know how to convert each palette into an image?</p>\n"}, {"tags": ["go", "webserver"], "comments": [{"owner": {"reputation": 1615, "user_id": 1376205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff8ba613f2dc50cc30e7f3af3e2914?s=128&d=identicon&r=PG", "display_name": "Will C", "link": "https://stackoverflow.com/users/1376205/will-c"}, "edited": false, "score": 1, "creation_date": 1445568298, "post_id": 33293293, "comment_id": 54387799, "body": "Hm.. seems to have worked for me... Although it might be because you&#39;re trying to go to <code>http:&#47;&#47;127.0.0.1.12000</code> instead of <code>http:&#47;&#47;127.0.0.1:12000</code>. You have a period instead a colon that separates the host from the port."}, {"owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "edited": false, "score": 6, "creation_date": 1445572136, "post_id": 33293293, "comment_id": 54388702, "body": "Is there a reason you&#39;re trying to reinvent the standard library? net/http makes all this trivial."}, {"owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 0, "creation_date": 1445574968, "post_id": 33293293, "comment_id": 54389365, "body": "You can print any <code>error</code> you receive instead of &quot;Launching error&lt;n&gt;...&quot;. This may help shed some light on your error."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1445582929, "post_id": 33293293, "comment_id": 54391968, "body": "If you want to reimplement HTTP to access your server via a browser, then your server should answer with HTTP (i.e. proper headers and body) and not just some random string."}], "answers": [{"comments": [{"owner": {"reputation": 1258, "user_id": 3680301, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2cb1423ce8e33f52dc8f01ae174f44da?s=128&d=identicon&r=PG&f=1", "display_name": "Parthian Shot", "link": "https://stackoverflow.com/users/3680301/parthian-shot"}, "edited": false, "score": 0, "creation_date": 1457638787, "post_id": 33297984, "comment_id": 59509791, "body": "<code>the typical HTTP port is 80 and the alternative&#47;testing one is 8080</code> Well... the first statement there is true. The second one isn&#39;t, really. A lot of servers do use <code>8080</code> (mainly in the Java world, haven&#39;t seen it as much elsewhere), but that&#39;s because of the larger informal convention of simply catenating the port number to create an alternate / testing port number (i.e. running an SSH server on <code>2222</code> instead of <code>22</code>, or an SMTP server on <code>2525</code> instead of <code>25</code>). There&#39;s nothing actually special about <code>8080</code>."}, {"owner": {"reputation": 1258, "user_id": 3680301, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2cb1423ce8e33f52dc8f01ae174f44da?s=128&d=identicon&r=PG&f=1", "display_name": "Parthian Shot", "link": "https://stackoverflow.com/users/3680301/parthian-shot"}, "edited": false, "score": 0, "creation_date": 1457639235, "post_id": 33297984, "comment_id": 59510043, "body": "Other examples of the &#39;str(port) * 2` trend include port 2121 (FTP proxy) and 5353 (mDNS)."}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "reply_to_user": {"reputation": 1258, "user_id": 3680301, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2cb1423ce8e33f52dc8f01ae174f44da?s=128&d=identicon&r=PG&f=1", "display_name": "Parthian Shot", "link": "https://stackoverflow.com/users/3680301/parthian-shot"}, "edited": false, "score": 0, "creation_date": 1458522201, "post_id": 33297984, "comment_id": 59883435, "body": "The second statement is true. It is registered on <a href=\"http://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?&amp;page=108\" rel=\"nofollow noreferrer\">iana</a> as http-alt."}], "tags": [], "owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "is_accepted": true, "score": 2, "last_activity_date": 1445589703, "last_edit_date": 1445589703, "creation_date": 1445589040, "answer_id": 33297984, "question_id": 33293293, "link": "https://stackoverflow.com/questions/33293293/simple-web-server-implementation-golang/33297984#33297984", "title": "Simple Web Server Implementation: GoLang", "body": "<p>Just to add some information here.. That that isn't a simple server that you're writing. You're trying to write an HTTP server without the <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow\"><code>net/http</code></a> package. This is nontrivial. Perhaps you want an echo server instead? </p>\n\n<p>Your browser wants a properly formatted HTTP response. That means you can't just write a random string to the connection and expect it to know what to do with it. Here is a <a href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol\" rel=\"nofollow\">wikipedia</a> to the HTTP protocol description (I don't intend to describe an entire protocol in a SO answer).</p>\n\n<p>If you want just a bare bones answer that should work:</p>\n\n<pre><code>HTTP/1.1 200 OK\nContent-Type: text/plain; charset=UTF-8;\nContent-Length: LENGTH OF BODY HERE\n\nBODY\n</code></pre>\n\n<p>Note that headers are separated by <code>\\r\\n</code> and the last header is followed by two: <code>\\r\\n\\r\\n</code>.</p>\n\n<p>So this:</p>\n\n<pre><code>conn.Write([]byte(\"HTTP/1.1 200 OK\\r\\n\"))\nconn.Write([]byte(\"Content-Type: text/plain; charset=UTF-8\\r\\n\"))\nnewmessage := \"Hello World!\"\nconn.Write([]byte(\"Content-Length: \" + strconv.Itoa(len(newmessage)) + \"\\r\\n\\r\\n\"))\nconn.Write([]byte(newmessage + \"\\n\"))\n</code></pre>\n\n<p>Also, I guess since this is a protocol issue I could also let you know that the typical HTTP port is 80 and the alternative/testing one is 8080. Just some added convention for your knowledge I guess.</p>\n"}], "owner": {"reputation": 1, "user_id": 5478040, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pUKfsKwJEGc/AAAAAAAAAAI/AAAAAAAAAFI/qsAS_5d27rc/photo.jpg?sz=128", "display_name": "Phani Mandava", "link": "https://stackoverflow.com/users/5478040/phani-mandava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 608, "favorite_count": 0, "accepted_answer_id": 33297984, "answer_count": 1, "score": -2, "last_activity_date": 1445589703, "creation_date": 1445562440, "last_edit_date": 1445570137, "question_id": 33293293, "link": "https://stackoverflow.com/questions/33293293/simple-web-server-implementation-golang", "title": "Simple Web Server Implementation: GoLang", "body": "<p>I am trying to implement a simple web server using Go. I expected \"Hello World\" to be displayed on the client's browser at the URL \"<a href=\"http://127.0.0.1.12000/\" rel=\"nofollow\">http://127.0.0.1.12000/</a>\".</p>\n\n<p>I have tried the following code but ended up with errors.</p>\n\n<pre><code>package main\n\nimport \"net\"\nimport \"fmt\"\nimport \"bufio\"\n\n// import \"strings\"\n// only needed below for sample processing\n\nfunc main() {\n    fmt.Println(\"Launching server...\")\n\n    // listen on all interfaces\n    ln, err := net.Listen(\"tcp\", \":12000\")\n    if err != nil {\n        fmt.Println(\"Launching error1...\")\n        return\n    }\n    // run loop forever (or until ctrl-c)\n    for {\n        // accept connection on port\n        conn, err := ln.Accept()\n        if err != nil {\n            fmt.Println(\"Launching error2...\")\n            return\n        }\n\n        // will listen for message to process ending in newline (\\n)\n        message, err := bufio.NewReader(conn).ReadString('\\n')\n\n        if err != nil {\n            fmt.Println(\"Launching error3...\")\n            newmessage := \"Hello World!\"\n            conn.Write([]byte(newmessage + \"\\n\"))\n            return\n        }\n\n        // output message received\n        fmt.Print(\"Message Received:\", string(message))\n\n        // sample process for string received\n        newmessage := \"Hello World!\"\n        conn.Write([]byte(newmessage + \"\\n\"))\n    }\n}\n</code></pre>\n\n<p>When I tried to execute the code, the command line shows the following, but there is no output on browser..</p>\n\n<pre><code>Launching server...\nMessage Received:GET / HTTP/1.1\nMessage Received:GET / HTTP/1.1\n</code></pre>\n\n<p>Am I missing anything? Did I make any mistakes?</p>\n"}, {"tags": ["go", "http-redirect"], "answers": [{"comments": [{"owner": {"reputation": 607, "user_id": 2624018, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9ffd4aabd89fcc3c50fd7430d7d8b222?s=128&d=identicon&r=PG", "display_name": "AbhishekSaha", "link": "https://stackoverflow.com/users/2624018/abhisheksaha"}, "edited": false, "score": 0, "creation_date": 1445606432, "post_id": 33295048, "comment_id": 54405465, "body": "No no, I know how to set up a Handler. What I want to do is that instead of opening up my browser and typing in the URL to trigger the API call via the router, I want to trigger the API call with a URL, via command line argument, within the program.   So if I were to type in command line:   go run *.go -url=&quot;localhost:8080/Whatever&quot;  The go program&#39;s main method would parse the URL and send it to the router. I&#39;m basically trying to figure out how to send the URL to the Mux Router within the main method"}], "tags": [], "owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "is_accepted": false, "score": 1, "last_activity_date": 1512065647, "last_edit_date": 1512065647, "creation_date": 1445575549, "answer_id": 33295048, "question_id": 33293072, "link": "https://stackoverflow.com/questions/33293072/how-to-redirect-url-in-go-main-method/33295048#33295048", "title": "How to redirect URL in Go main method?", "body": "<p>An HTTP redirect is a response to a client and should be called from an invocation of a handler. The <code>http.redirect(w http.ResponseWriter, r *http.Request)</code> function has no meaning in the context of the main function. </p>\n\n<p>You can register a handler for the given route like so:</p>\n\n<pre><code>router.Path(\"/whatever\").Handler(func(writer http.ResponseWriter, req *http.Request) {\n    http.Redirect(writer, req, \"localhost:8080/whatever\", http.StatusMovedPermanently)\n))\n</code></pre>\n\n<p>This adds a path to the router and invokes the simple <code>http.Handlerfunc</code> which contains a call to <code>http.Redirect(...)</code>. Here this makes sense because we are handling a response to a client connection. It is logical to return a 301 status code and the URL for the target of the redirect.</p>\n"}], "owner": {"reputation": 607, "user_id": 2624018, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9ffd4aabd89fcc3c50fd7430d7d8b222?s=128&d=identicon&r=PG", "display_name": "AbhishekSaha", "link": "https://stackoverflow.com/users/2624018/abhisheksaha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3601, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1512065647, "creation_date": 1445560683, "question_id": 33293072, "link": "https://stackoverflow.com/questions/33293072/how-to-redirect-url-in-go-main-method", "title": "How to redirect URL in Go main method?", "body": "<p>I have a GorrilaMux set up in Go that will make an API call if type in a specific URL in a browser. I want to make the same API call in my main method in go if the URL is given as a command line argument. However, the http.redirect() method which seems to be able to do this, requires a HTTP ResponseWriter and a *HTTPRequest variables as function parameters. I do not know how to produce these variables within a main method. How do I do this, OR, is there a better way to make the API call from the URL in Golang?</p>\n\n<p>Code to set up Router</p>\n\n<pre><code>func main(){\n   router := mux.NewRouter().StrictSlash(true)\n   for _, route := range routes { //Sets up predefined routes\n     router.\n        Path(route.Path).\n        Name(route.Name).\n        Handler(route.HandlerFunc)\n    }\n\n  URL:=\"localhost:8080/whatever\" //URL I want to redirect, route would be \"/whatever\"\n\n http.redirect(????)\n\n }\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1445550998, "post_id": 33291374, "comment_id": 54383165, "body": "RTFM: <a href=\"https://golang.org/ref/spec#String_concatenation\" rel=\"nofollow noreferrer\">golang.org/ref/spec#String_concatenation</a>"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 3, "creation_date": 1445554220, "post_id": 33291374, "comment_id": 54384404, "body": "kind of funny since you concatenate strings with a <code>+</code> operator in Go, just like Java, just like you have in your example."}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 9, "last_activity_date": 1445550920, "creation_date": 1445550920, "answer_id": 33291446, "question_id": 33291374, "link": "https://stackoverflow.com/questions/33291374/go-inline-string-concatenation/33291446#33291446", "title": "Go: Inline string concatenation", "body": "<p>The most portable way to do path concatenation is by using <a href=\"https://godoc.org/path/filepath#Join\" rel=\"noreferrer\"><code>filepath.Join</code></a>:</p>\n\n<pre><code>import \"path/filepath\"\n\nfile, err := os.Open(filepath.Join(\"XML\", fileinfo.Name()))\n</code></pre>\n"}], "owner": {"reputation": 2524, "user_id": 1476289, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/aa9f28cc449a272dbd654e8edf660877?s=128&d=identicon&r=PG", "display_name": "Cody Smith", "link": "https://stackoverflow.com/users/1476289/cody-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 33291446, "answer_count": 1, "score": -6, "last_activity_date": 1504368822, "creation_date": 1445550599, "last_edit_date": 1504368822, "question_id": 33291374, "link": "https://stackoverflow.com/questions/33291374/go-inline-string-concatenation", "title": "Go: Inline string concatenation", "body": "<p>I need to <code>call os.Open</code> to open a file. I have the path <code>./XML/</code> and the filename <code>foo.xml</code>, which changes each time. That is I have an array of xml files read from a dir which I am trying to open one at a time (or threaded, doesn't matter).</p>\n\n<p>I need to simple add <code>./XML/</code> to <code>SOMETHING.xml</code>. In Java this is trivial,</p>\n\n<pre><code>String a = \"whatever\", b = \"whatever\";\ndoSomething(a + b);\n</code></pre>\n\n<p>How is this done in Go? Google has failed me.</p>\n\n<pre><code>file, err := os.Open(????????????)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1445583016, "post_id": 33291216, "comment_id": 54391995, "body": "Please work through the &quot;Tour of Go&quot; at least twice."}], "answers": [{"comments": [{"owner": {"reputation": 2524, "user_id": 1476289, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/aa9f28cc449a272dbd654e8edf660877?s=128&d=identicon&r=PG", "display_name": "Cody Smith", "link": "https://stackoverflow.com/users/1476289/cody-smith"}, "edited": false, "score": 0, "creation_date": 1445550037, "post_id": 33291241, "comment_id": 54382706, "body": "Works great now, thx. You&#39;ll get the answer when the timer expires."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1445550044, "last_edit_date": 1445550044, "creation_date": 1445549907, "answer_id": 33291241, "question_id": 33291216, "link": "https://stackoverflow.com/questions/33291216/go-not-getting-string-value/33291241#33291241", "title": "Go, not getting string value", "body": "<p><a href=\"https://godoc.org/os#FileInfo\" rel=\"nofollow\"><code>FileInfo.Name</code></a> is a function of the <code>FileInfo</code> interface; the function's memory address is being printed. To display the name of the file, you need to evaluate the function before printing:</p>\n\n<pre><code>for _, element := range systems {\n    fmt.Println(element.Name())\n}\n</code></pre>\n"}], "owner": {"reputation": 2524, "user_id": 1476289, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/aa9f28cc449a272dbd654e8edf660877?s=128&d=identicon&r=PG", "display_name": "Cody Smith", "link": "https://stackoverflow.com/users/1476289/cody-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 33291241, "answer_count": 1, "score": -2, "last_activity_date": 1445550044, "creation_date": 1445549798, "question_id": 33291216, "link": "https://stackoverflow.com/questions/33291216/go-not-getting-string-value", "title": "Go, not getting string value", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n)\n\nfunc main() {\n\n    // Just count the files...\n    systems,_ := ioutil.ReadDir(\"./XML\")\n    fmt.Printf(\"# of planetary systems\\t%d\\r\\n\", len(systems))\n\n    // For each datafile\n    for _,element := range systems {\n        fmt.Println(element.Name)\n    }\n\n}\n</code></pre>\n\n<p>This line...</p>\n\n<pre><code>fmt.Println(element.Name)\n</code></pre>\n\n<p>Is outputting a memory address instead of what I assume to be the filename string. Why? How do I get the actual string? Thanks.</p>\n\n<p>Also all the addresses are the same, I would expect them to difer, meaning my for-each loop might be broken.</p>\n"}, {"tags": ["multithreading", "go", "mutex"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1445531216, "post_id": 33285808, "comment_id": 54372004, "body": "Have a single method that locks, writes and unlocks and let all other methods use that one."}], "answers": [{"comments": [{"owner": {"reputation": 90, "user_id": 4985707, "user_type": "registered", "profile_image": "https://graph.facebook.com/993366030683226/picture?type=large", "display_name": "Daniel Eder", "link": "https://stackoverflow.com/users/4985707/daniel-eder"}, "edited": false, "score": 0, "creation_date": 1445545485, "post_id": 33286129, "comment_id": 54380204, "body": "Thanks. I just refactored the code to lock closer to the actual data access and this saved the issue. Seems like I was too deep in the code to see that obvious mistake."}, {"owner": {"reputation": 1306, "user_id": 1015188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec3c080c0980eb6dcea2b565b22aba0?s=128&d=identicon&r=PG", "display_name": "atedja", "link": "https://stackoverflow.com/users/1015188/atedja"}, "edited": false, "score": 0, "creation_date": 1445757079, "post_id": 33286129, "comment_id": 54451560, "body": "I would rather have <code>b()</code> does the locking.  It seems that, from your example, <code>t.bar()</code> is the resource that is concurrently sensitive, not <code>A()</code> nor <code>B()</code>"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1445761274, "post_id": 33286129, "comment_id": 54452350, "body": "So can be <code>t.foo()</code>. It&#39;s about composability, cases where you need to do <code>t.foo()</code> and <code>t.bar()</code> in one &quot;transaction&quot;. Lowercase methods are unexported so they&#39;re not supposed to be used only outside the package anyway."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1445531853, "creation_date": 1445531853, "answer_id": 33286129, "question_id": 33285808, "link": "https://stackoverflow.com/questions/33285808/resolving-duplicate-mutex-lock-in-go/33286129#33286129", "title": "Resolving duplicate mutex lock in Go", "body": "<p>It seems like a design flaw of your system. You should factor out the part that you need both locked and unlocked. E.g. if what you do is</p>\n\n<pre><code>func (t *Thing) A() { t.Lock(); defer t.Unlock(); t.foo(); t.B() }\nfunc (t *Thing) B() { t.Lock(); defer t.Unlock(); t.bar() }\n</code></pre>\n\n<p>then what you should do instead is</p>\n\n<pre><code>func (t *Thing) A() { t.Lock(); defer t.Unlock(); t.foo(); t.b() }\nfunc (t *Thing) B() { t.Lock(); defer t.Unlock(); t.b() }\nfunc (t *Thing) b() { t.bar() }\n</code></pre>\n"}], "owner": {"reputation": 90, "user_id": 4985707, "user_type": "registered", "profile_image": "https://graph.facebook.com/993366030683226/picture?type=large", "display_name": "Daniel Eder", "link": "https://stackoverflow.com/users/4985707/daniel-eder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 33286129, "answer_count": 1, "score": 0, "last_activity_date": 1445531853, "creation_date": 1445530861, "question_id": 33285808, "link": "https://stackoverflow.com/questions/33285808/resolving-duplicate-mutex-lock-in-go", "title": "Resolving duplicate mutex lock in Go", "body": "<p>I have a bunch of functions in a Go program that work on a struct that uses a mutex to manage concurrent access to its functions. </p>\n\n<p>Some of these functions, that operate on specific data, need locks and thereby use mutex.Lock() to get hold of a mutex that manages the access to that data. Today I encountered an issue when two of these locking methods call each other. As soon as mutex.Lock() is called a second time it blocks - of course.</p>\n\n<p>The problem I am facing is very similar to this code: <a href=\"http://play.golang.org/p/rPARZsordI\" rel=\"nofollow\">http://play.golang.org/p/rPARZsordI</a></p>\n\n<p>Is there any best-practise in Go on how to solve this issue? As far as I know recursive locks are not available in Go.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1445529530, "post_id": 33285193, "comment_id": 54371051, "body": "Do you need the OS name, or are you just trying to parse it for version info? (There&#39;s <code>syscall.GetVersion</code> for the latter)"}, {"owner": {"reputation": 26363, "user_id": 53007, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9bf3ccd1cf9b015cfb86d947f09aa77d?s=128&d=identicon&r=PG", "display_name": "scottm", "link": "https://stackoverflow.com/users/53007/scottm"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1445530508, "post_id": 33285193, "comment_id": 54371624, "body": "The OS name, for example <code>Windows Server 2012 R2 Datacenter</code>"}], "answers": [{"tags": [], "owner": {"reputation": 924, "user_id": 3068922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zjwoG.png?s=128&g=1", "display_name": "HighlyUnavailable", "link": "https://stackoverflow.com/users/3068922/highlyunavailable"}, "is_accepted": false, "score": 1, "last_activity_date": 1445539168, "creation_date": 1445539168, "answer_id": 33288328, "question_id": 33285193, "link": "https://stackoverflow.com/questions/33285193/what-is-the-best-way-to-get-windows-full-name-from-go/33288328#33288328", "title": "What is the best way to get windows full name from go?", "body": "<p>One way to do it is to use the <a href=\"https://godoc.org/golang.org/x/sys/windows/registry\" rel=\"nofollow\">golang.org/x/sys/windows/registry</a> package.</p>\n\n<p>A simple example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"golang.org/x/sys/windows/registry\"\n)\n\nfunc main() {\n    key, _ := registry.OpenKey(registry.LOCAL_MACHINE, `SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion`, registry.QUERY_VALUE) // error discarded for brevity\n    defer key.Close()\n    productName, _, _ := key.GetStringValue(\"ProductName\") // error discarded for brevity\n    fmt.Println(productName)\n}\n</code></pre>\n\n<p>This prints <code>Windows 8.1 Pro</code> on my computer.</p>\n"}], "owner": {"reputation": 26363, "user_id": 53007, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9bf3ccd1cf9b015cfb86d947f09aa77d?s=128&d=identicon&r=PG", "display_name": "scottm", "link": "https://stackoverflow.com/users/53007/scottm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445539168, "creation_date": 1445528842, "question_id": 33285193, "link": "https://stackoverflow.com/questions/33285193/what-is-the-best-way-to-get-windows-full-name-from-go", "title": "What is the best way to get windows full name from go?", "body": "<p>In Windows, I can run something like <code>systeminfo | findstr /C:\"OS Name</code> to output the Windows full name to the console. I've tried a couple different variations of piping output from one command to the other, but I just get empty strings. </p>\n\n<p><strong>Example</strong></p>\n\n<pre><code>first := exec.Command(\"systeminfo\")\nsecond := exec.Command(\"findstr /C:'OS Name'\")\n\nreader, writer := io.Pipe()\n\nfirst.Stdout = writer\nsecond.Stdin = reader\n\nvar buffer bytes.Buffer\nsecond.Stdout = &amp;buffer\n\nfirst.Start()\nsecond.Start()\nfirst.Wait()\nwriter.Close()\nsecond.Wait()\n\noutput := buffer.String()\n\nlog.Printf(\"output: %s\", output)\n</code></pre>\n\n<p>`</p>\n\n<p>Are there any built in methods to get this information?</p>\n"}, {"tags": ["data-structures", "go"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 4, "last_activity_date": 1445523173, "last_edit_date": 1445523173, "creation_date": 1445522660, "answer_id": 33282981, "question_id": 33282897, "link": "https://stackoverflow.com/questions/33282897/understanding-go-nested-structs/33282981#33282981", "title": "Understanding go nested structs", "body": "<p>They are the same. See <a href=\"https://golang.org/ref/spec#Selectors\" rel=\"nofollow\">the Go Spec on selectors</a>:</p>\n\n<blockquote>\n  <p>For a value <code>x</code> of type <code>T</code> or <code>*T</code> where <code>T</code> is not a pointer or interface type, <code>x.f</code> denotes the field or method at the shallowest depth in <code>T</code> where there is such an <code>f</code>. If there is not exactly one <code>f</code> with shallowest depth, the selector expression is illegal.</p>\n</blockquote>\n\n<p>Note that this means that <code>b.a</code> is illegal if type <code>B</code> embeds two types with the same field on the same depth:</p>\n\n<pre><code>type A1 struct{ a string }\ntype A2 struct{ a string }\ntype B struct {\n    A1\n    A2\n}\n\n// ...\nb := B{A1{\"a1\"}, A2{\"a2\"}}\nfmt.Println(b.a) // Error: ambiguous selector b.a\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/PTqm-HzBDr\" rel=\"nofollow\">http://play.golang.org/p/PTqm-HzBDr</a>.</p>\n"}], "owner": {"reputation": 34006, "user_id": 20601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z9vyi.png?s=128&g=1", "display_name": "Lucas Gabriel S&#225;nchez", "link": "https://stackoverflow.com/users/20601/lucas-gabriel-s%c3%a1nchez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 751, "favorite_count": 0, "accepted_answer_id": 33282981, "answer_count": 1, "score": 2, "last_activity_date": 1445523173, "creation_date": 1445522431, "last_edit_date": 1445522822, "question_id": 33282897, "link": "https://stackoverflow.com/questions/33282897/understanding-go-nested-structs", "title": "Understanding go nested structs", "body": "<p>I'm trying to understand nested structs in go, so I made a little test: (<a href=\"https://play.golang.org/p/A17zcOECeH\" rel=\"nofollow\">playground</a>)</p>\n\n<pre><code>type A struct {\n    a string\n}\n\ntype B struct {\n    A\n    b string\n}\n\nfunc main() {\n    b := B{A{\"a val\"}, \"b val\"}\n\n    fmt.Printf(\"%T -&gt; %v\\n\", b, b)   // B has a nested A and some values \n    // main.B -&gt; {{a val} b val}\n\n    fmt.Println(\"b.b -&gt;\", b.b)       // B's own value\n    // b.b -&gt; b val\n\n    fmt.Println(\"b.A.a -&gt;\", b.A.a)   // B's nested value\n    // b.a -&gt; a val\n\n    fmt.Println(\"b.a -&gt;\", b.a)       // B's nested value? or own value?\n    // b.a -&gt; a val\n}\n</code></pre>\n\n<p>So how and why the last two lines work? Are they are same? Which should I use?</p>\n"}, {"tags": ["node.js", "encryption", "go", "aes"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1445524499, "post_id": 33282838, "comment_id": 54367384, "body": "I guessing it&#39;s something to do with your key+iv generation. You don&#39;t have an iv at all here, since your <code>evpBytesToKey</code> function returns an empty iv, and your ciphertext isn&#39;t long enough to have an iv prepended."}, {"owner": {"reputation": 33, "user_id": 2136448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bbaa4eeeec81767a64ddab0114f04e?s=128&d=identicon&r=PG", "display_name": "JConnell", "link": "https://stackoverflow.com/users/2136448/jconnell"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1445525648, "post_id": 33282838, "comment_id": 54368250, "body": "I forgot I was in the middle of editing the code and stepped away from it for like a month. Crap. Yeah that evpBytesToKey returns two byte slices, but I&#39;m calling it like it still returns 1. SHITE. I may have to scrap this question and work on it alone for a while again."}, {"owner": {"reputation": 33, "user_id": 2136448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bbaa4eeeec81767a64ddab0114f04e?s=128&d=identicon&r=PG", "display_name": "JConnell", "link": "https://stackoverflow.com/users/2136448/jconnell"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1445529797, "post_id": 33282838, "comment_id": 54371239, "body": "I&#39;ve noticed that the cipher text that the encrypt method creates is a lot longer than the ones that were created by node.js  ...  Thanks for your help @JimB I will continue digging."}, {"owner": {"reputation": 33, "user_id": 2136448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bbaa4eeeec81767a64ddab0114f04e?s=128&d=identicon&r=PG", "display_name": "JConnell", "link": "https://stackoverflow.com/users/2136448/jconnell"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1445530394, "post_id": 33282838, "comment_id": 54371566, "body": "The other route I can go is to update the node.js code to mimic the Go code, and batch update all passwords from the old method to the new method. Use that going forward until the application is rewritten in Go. Then the Go program can just pick up where the Node one left off"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1445533255, "post_id": 33282838, "comment_id": 54373203, "body": "Yeah I was gonna point out that if you just do a one off decryption with node you could migrate to a new algorithm in Go. Not sure what the pros and cons of that would be vs this approach, but something to consider maybe."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 2136448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bbaa4eeeec81767a64ddab0114f04e?s=128&d=identicon&r=PG", "display_name": "JConnell", "link": "https://stackoverflow.com/users/2136448/jconnell"}, "edited": false, "score": 0, "creation_date": 1445647685, "post_id": 33290665, "comment_id": 54425615, "body": "Wow awesome. Yeah it&#39;s a password, like not a word, but random hard to remember one. I will try this when I can get to a computer. It seemed like there was something up with the length, that would explain it!! Thank you, I will let you know soon. Right now I forget the pw and don&#39;t have access to that system from outside the network, so even if you told me what it decrypted to, I couldn&#39;t verify"}, {"owner": {"reputation": 33, "user_id": 2136448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bbaa4eeeec81767a64ddab0114f04e?s=128&d=identicon&r=PG", "display_name": "JConnell", "link": "https://stackoverflow.com/users/2136448/jconnell"}, "edited": false, "score": 0, "creation_date": 1445657547, "post_id": 33290665, "comment_id": 54427176, "body": "Yes!  Thank you!  That did it. I tested with another stored password and it decrypted fine! I don&#39;t have enough rep to upvote but it is marked as the answer."}, {"owner": {"reputation": 33, "user_id": 2136448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bbaa4eeeec81767a64ddab0114f04e?s=128&d=identicon&r=PG", "display_name": "JConnell", "link": "https://stackoverflow.com/users/2136448/jconnell"}, "edited": false, "score": 0, "creation_date": 1445960782, "post_id": 33290665, "comment_id": 54539255, "body": "Interesting, yet smart. Investigating the value of the padded bytes, the number is how many bytes it is padded by.  For example, it might decrypt to &quot;Go Decryption&quot; and that&#39;s 13 characters, so the last 3 bytes will just be [3,3,3]  .  For one that&#39;s 12, it&#39;ll be [4,4,4,4].  It&#39;s embarrassing how little knowledge I have in encryption, maybe I&#39;ll read a book or something..."}, {"owner": {"reputation": 846, "user_id": 3332282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/802cbc0369003c129ade6a040394320c?s=128&d=identicon&r=PG", "display_name": "Brian Stengaard - Podio", "link": "https://stackoverflow.com/users/3332282/brian-stengaard-podio"}, "reply_to_user": {"reputation": 33, "user_id": 2136448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bbaa4eeeec81767a64ddab0114f04e?s=128&d=identicon&r=PG", "display_name": "JConnell", "link": "https://stackoverflow.com/users/2136448/jconnell"}, "edited": false, "score": 0, "creation_date": 1446051356, "post_id": 33290665, "comment_id": 54585434, "body": "Ah, I see. But what happens then when the cleartext is <code>0123456789abcde\\x01</code>?  That will decrypt to <code>0123456789abcde</code>."}, {"owner": {"reputation": 846, "user_id": 3332282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/802cbc0369003c129ade6a040394320c?s=128&d=identicon&r=PG", "display_name": "Brian Stengaard - Podio", "link": "https://stackoverflow.com/users/3332282/brian-stengaard-podio"}, "reply_to_user": {"reputation": 33, "user_id": 2136448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bbaa4eeeec81767a64ddab0114f04e?s=128&d=identicon&r=PG", "display_name": "JConnell", "link": "https://stackoverflow.com/users/2136448/jconnell"}, "edited": false, "score": 0, "creation_date": 1446051409, "post_id": 33290665, "comment_id": 54585468, "body": "Unless you add a new block with just padding."}, {"owner": {"reputation": 846, "user_id": 3332282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/802cbc0369003c129ade6a040394320c?s=128&d=identicon&r=PG", "display_name": "Brian Stengaard - Podio", "link": "https://stackoverflow.com/users/3332282/brian-stengaard-podio"}, "reply_to_user": {"reputation": 33, "user_id": 2136448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bbaa4eeeec81767a64ddab0114f04e?s=128&d=identicon&r=PG", "display_name": "JConnell", "link": "https://stackoverflow.com/users/2136448/jconnell"}, "edited": false, "score": 0, "creation_date": 1446052497, "post_id": 33290665, "comment_id": 54586136, "body": "Which is exactly what PKCS#7 padding does. (<a href=\"https://en.wikipedia.org/wiki/Padding_(cryptography)#PKCS7\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Padding_(cryptography)#PKCS7</a>)"}, {"owner": {"reputation": 33, "user_id": 2136448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bbaa4eeeec81767a64ddab0114f04e?s=128&d=identicon&r=PG", "display_name": "JConnell", "link": "https://stackoverflow.com/users/2136448/jconnell"}, "edited": false, "score": 0, "creation_date": 1446068911, "post_id": 33290665, "comment_id": 54595694, "body": "We&#39;re onto something :)  But that makes it difficult to encrypt a bunch of bytes that are non-ascii, and that happen to end with 3,3,3 as the last 3 bytes!  I guess it&#39;s just for ASCII?   padding := decrypted[len(decrypted)-1]"}, {"owner": {"reputation": 846, "user_id": 3332282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/802cbc0369003c129ade6a040394320c?s=128&d=identicon&r=PG", "display_name": "Brian Stengaard - Podio", "link": "https://stackoverflow.com/users/3332282/brian-stengaard-podio"}, "reply_to_user": {"reputation": 33, "user_id": 2136448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bbaa4eeeec81767a64ddab0114f04e?s=128&d=identicon&r=PG", "display_name": "JConnell", "link": "https://stackoverflow.com/users/2136448/jconnell"}, "edited": false, "score": 0, "creation_date": 1446156554, "post_id": 33290665, "comment_id": 54640064, "body": "if you have cleartext ending in 3,3,3 a complete block will be appended with all padding (16,16,16,...)."}], "tags": [], "owner": {"reputation": 846, "user_id": 3332282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/802cbc0369003c129ade6a040394320c?s=128&d=identicon&r=PG", "display_name": "Brian Stengaard - Podio", "link": "https://stackoverflow.com/users/3332282/brian-stengaard-podio"}, "is_accepted": true, "score": 1, "last_activity_date": 1445547650, "creation_date": 1445547650, "answer_id": 33290665, "question_id": 33282838, "link": "https://stackoverflow.com/questions/33282838/golang-decrypting-strings-that-were-encrypted-with-node-js/33290665#33290665", "title": "Golang Decrypting strings that were encrypted with Node.js", "body": "<p>In OpenSSL 'aes256' is equivalent to 'aes-256-cbc'. So your use of <code>NewCFBDecrypter</code> seems off. Other than that the IV/key generation needed to be tweaked a little to actually generate an IV.</p>\n\n<p>This test script gives me an output that's at least ASCII. </p>\n\n<p><a href=\"http://play.golang.org/p/zsPMd8QN0b\" rel=\"nofollow\">http://play.golang.org/p/zsPMd8QN0b</a></p>\n\n<p>I found the IV / key to look for by having OpenSSL generate it for me (made debugging <code>genIvAndKey</code> a little easier).</p>\n\n<p>Note that you still need to determine where to split between the actual password and the padding. (<code>unicode.IsPrint</code>?)</p>\n"}], "owner": {"reputation": 33, "user_id": 2136448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bbaa4eeeec81767a64ddab0114f04e?s=128&d=identicon&r=PG", "display_name": "JConnell", "link": "https://stackoverflow.com/users/2136448/jconnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2208, "favorite_count": 1, "accepted_answer_id": 33290665, "answer_count": 1, "score": 3, "last_activity_date": 1445547650, "creation_date": 1445522255, "question_id": 33282838, "link": "https://stackoverflow.com/questions/33282838/golang-decrypting-strings-that-were-encrypted-with-node-js", "title": "Golang Decrypting strings that were encrypted with Node.js", "body": "<p>I have a bunch passwords for an internal app that were encrypted with node.js and stored (irrelevantly) in mongodb. I would like to convert this application to Go, but I'm getting tripped up on the node.js encryption. I've looked through the node.js source code for this, and it's using the OpenSSL evpBytesToKey method. I've found a Golang implementation of this on the web, but I still can't decrypt the password in Go that was encrypted with node.js.  \"algo\" is <code>\"aes256\"</code></p>\n\n<pre><code>this.encrypt = function(s){\nvar cipher = crypto.createCipher(algo, key);\n\nvar i = 0;\nvar encrypted = \"\";\nwhile (i &lt; s.length){\n    var end = Math.min(s.length-i, 15);\n    var chunk = s.substring(i, end+i);\n    encrypted += cipher.update(chunk, \"utf8\", \"base64\");\n    i+= end;\n}\n\nencrypted += cipher.final(\"base64\");\nencrypted = encrypted.replace(/\\//g,\"_\").replace(/\\+/g, \"-\"); // base64 url encode\nreturn encrypted;\n}\n</code></pre>\n\n<p>And the Go code:</p>\n\n<pre><code>func evpBytesToKey(password string, keyLen int) (key []byte, iv []byte) {\nconst md5Len = 16\n\ncnt := (keyLen-1)/md5Len + 1\nm := make([]byte, cnt*md5Len)\nkey = make([]byte, keyLen)\niv = make([]byte, md5Len)\n\n\ncopy(m, md5sum([]byte(password)))\n\n// Repeatedly call md5 until bytes generated is enough.\n// Each call to md5 uses data: prev md5 sum + password.\nd := make([]byte, md5Len+len(password))\nstart := 0\nfor i := 1; i &lt; cnt; i++ {\n    start += md5Len\n    copy(d, m[start-md5Len:start])\n    copy(d[md5Len:], password)\n    copy(m[start:], md5sum(d))\n}\nreturn m[:keyLen], iv\n}\n</code></pre>\n\n<p>And the decrypt function</p>\n\n<pre><code>func Decrypt(key string, b64 string) string {\ntext := decodeBase64(b64)   // base64.StdEncoding.DecodeString helper method\nblock, err := aes.NewCipher(evpBytesToKey(key,32))\nif err != nil {\n    panic(err)\n}\nif len(text) &lt; aes.BlockSize {\n    panic(\"ciphertext too short\")\n}\niv := text[:aes.BlockSize]\ntext = text[aes.BlockSize:]\n\nfmt.Println(iv)\nfmt.Println(text)\n\ncfb := cipher.NewCFBDecrypter(block, iv)\ncfb.XORKeyStream(text, text)\nreturn string(text)\n}\n</code></pre>\n\n<p>Here is some sample data:</p>\n\n<p><code>8PTcrR0Nf0sltmdtvLUrFg==</code>   (you tell ME what it decrypts to :)</p>\n\n<p>The key is <code>var key = \"random array of characters\";</code>  literally.</p>\n\n<p>This is above my personal encryption experience and training. It is my last roadblock... Thanks for any help and guidance you can provide.</p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 13, "last_activity_date": 1445521145, "creation_date": 1445521145, "answer_id": 33282413, "question_id": 33282061, "link": "https://stackoverflow.com/questions/33282061/go-templates-with-eq-and-index/33282413#33282413", "title": "Go templates with eq and index", "body": "<p><code>eq</code> is a prefix operation:</p>\n\n<pre><code>{{if eq (index $n 0) (index $n 1)}}={{else}}!={{end}}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/KEfXH6s7N1\" rel=\"noreferrer\">http://play.golang.org/p/KEfXH6s7N1</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1538397720, "last_edit_date": 1538397720, "creation_date": 1445521162, "answer_id": 33282420, "question_id": 33282061, "link": "https://stackoverflow.com/questions/33282061/go-templates-with-eq-and-index/33282420#33282420", "title": "Go templates with eq and index", "body": "<p>You use wrong operator and argument order. You have to first write the operator and then the operands:</p>\n\n<pre><code>{{if eq (index $n 0) (index $n 1)}}\n</code></pre>\n\n<p>This is more readable and handy as <code>eq</code> can take more than just 2 arguments, so you could write for example:</p>\n\n<pre><code>{{if eq (index $n 0) (index $n 1) (index $n 2)}}\n</code></pre>\n\n<blockquote>\n  <p>For simpler multi-way equality tests, eq (only) accepts two or more arguments and compares the second and subsequent to the first, returning in effect</p>\n\n<pre><code>arg1==arg2 || arg1==arg3 || arg1==arg4 ...\n</code></pre>\n  \n  <p>(Unlike with || in Go, however, eq is a function call and all the arguments will be evaluated.)</p>\n</blockquote>\n\n<p>With this change the output (try it on the <a href=\"http://play.golang.org/p/bUHaVrmfhu\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>1 != 2\n\n2 = 2\n\n4 != 2\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>You are not required to introduce a \"loop\" variable, the <code>{{range}}</code> action changes the dot to the current item:</p>\n\n<blockquote>\n  <p>...<em>dot is set to the successive elements of the array, slice, or map</em>...</p>\n</blockquote>\n\n<p>So you can simplify your template, this is equivalent to yours:</p>\n\n<pre><code>{{range .}}\n    {{index . 0}} {{if eq (index . 0) (index . 1)}}={{else}}!={{end}} {{index . 1}}\n{{end}}\n</code></pre>\n\n<p>Also note that you can create variables in the template yourself, which is recommended if you use the same expression multiple times which is nontrivial (such as <code>index . 0</code>). This is also equivalent to your template:</p>\n\n<pre><code>{{range .}}{{$0 := index . 0}}{{$1 := index . 1}}\n    {{$0}} {{if eq $0 $1}}={{else}}!={{end}} {{$1}}\n{{end}}\n</code></pre>\n\n<p>Also note that in this specific case since the things you want to output in the <code>if</code> and <code>else</code> branches both contain the <code>=</code> sign, you don't need 2 branches, <code>=</code> needs to be outputted in both cases, you just need an extra <code>!</code> sign if they are not equal. So the following final template is also equivalent to yours:</p>\n\n<pre><code>{{range .}}{{$0 := index . 0}}{{$1 := index . 1}}\n    {{$0}} {{if ne $0 $1}}!{{end}}= {{$1}}\n{{end}}\n</code></pre>\n"}], "owner": {"reputation": 2762, "user_id": 357937, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cec99ad76b136c8e5c8002370499365e?s=128&d=identicon&r=PG", "display_name": "Ondra", "link": "https://stackoverflow.com/users/357937/ondra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16211, "favorite_count": 3, "accepted_answer_id": 33282413, "answer_count": 2, "score": 10, "last_activity_date": 1538397720, "creation_date": 1445520063, "question_id": 33282061, "link": "https://stackoverflow.com/questions/33282061/go-templates-with-eq-and-index", "title": "Go templates with eq and index", "body": "<p>Go templates have some unexpected results when using <code>eq</code> with <code>index</code> for me. See this code:</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"text/template\"\n)\n\nfunc main() {\n    const myTemplate = `\n{{range $n := .}}\n    {{index $n 0}} {{if (index $n 0) eq (index $n 1)}}={{else}}!={{end}} {{index $n 1}}\n{{end}}\n`\n    t := template.Must(template.New(\"\").Parse(myTemplate))\n\n    t.Execute(os.Stdout,\n        [][2]int{\n            [2]int{1, 2},\n            [2]int{2, 2},\n            [2]int{4, 2},\n        })\n\n}\n</code></pre>\n\n<p>I expect to have output</p>\n\n<pre><code>1 != 2\n2 = 2\n4 != 2\n</code></pre>\n\n<p>but I get </p>\n\n<pre><code>1 = 2\n2 = 2\n4 = 2\n</code></pre>\n\n<p>What should I change to be able to compare array members in go templates?</p>\n"}, {"tags": ["go", "postmark"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1445518662, "post_id": 33281207, "comment_id": 54363494, "body": "Check the errors returned by <code>ioutil.ReadDir</code> and <code>os.Open</code>."}], "owner": {"reputation": 21, "user_id": 4698794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b8f874223c902f2088a0b562816024?s=128&d=identicon&r=PG", "display_name": "madnazz", "link": "https://stackoverflow.com/users/4698794/madnazz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 334, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1445517369, "creation_date": 1445517369, "question_id": 33281207, "link": "https://stackoverflow.com/questions/33281207/sending-attachments-to-postmark-with-go", "title": "Sending attachments to Postmark with Go", "body": "<p>I was trying to implement a file uploader using DropzoneJS and writing the backend using Go (first attempt at programming with the language). I'm trying to use <a href=\"https://github.com/hjr265/postmark.go\" rel=\"nofollow\">https://github.com/hjr265/postmark.go</a> which appears to be Postmarks recommendation for Go libraries.</p>\n\n<p>The app consists of 3 different handlers, one provides a token (ApplicationID in the code below) which is used in the headers.</p>\n\n<p>The second handler handles the individual file uploads to the server. The files are grouped together inside a directory with the same name as the ApplicationID.</p>\n\n<p>Up to here everything is working well. </p>\n\n<p>The final handler loops over the files in a given directory and adds them to a slice of Attachments.</p>\n\n<p>What I thought I'd be able to do is create an Attachment and add it to a slice of attachments and pass that in with the message however whenever I test this I send an email with everything except the attachments. Here is my code for the submission handler:</p>\n\n<pre><code>http.HandleFunc(\"/submission\", func(w http.ResponseWriter, r *http.Request){\n\n    client := postmark.Client{\n        ApiKey: \"SOME-POSTMARK-API-KEY\",\n        Secure: true,\n    }\n    fmt.Println(client)\n\n    attachments := []postmark.Attachment{}\n\n    switch r.Method {\n        case \"POST\":\n            appId := r.Header.Get(\"ApplicationID\")\n\n            files, _ := ioutil.ReadDir(\"/tmp/uploader/\" + appId)\n            for _, f := range files {\n                fullpath := \"/tmp/uploader/\" + appId + \"/\" + string(f.Name())\n                extension := filepath.Ext(fullpath)\n                mimeType := mime.TypeByExtension(extension)\n                upload, _ := os.Open(fullpath)\n                attachment := postmark.Attachment{\n                    Name: f.Name(),\n                    Content: upload,\n                    ContentType: mimeType,\n                }\n                attachments = append(attachments, attachment)\n            }\n    }\n\n    res, err := client.Send(&amp;postmark.Message{\n        From: &amp;mail.Address{\n            Name:    \"SENDER-NAME\",\n            Address: \"sender@example.com\",\n        },\n        To: []*mail.Address{\n            {\n                Name:    \"RECIPIENT-NAME\",\n                Address: \"recipient@example.com\",\n            },\n        },\n        Subject:  \"Hooking up Postmark for sending email\",\n        TextBody: strings.NewReader(\"MESSAGE-BODY-AS-TEXT\"),\n        Attachments: attachments,\n    })\n\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Printf(\"%#v\\n\", res)\n})\n</code></pre>\n\n<p>And this is an example of the result I'm getting back from Postmark:</p>\n\n<pre><code> &amp;postmark.Result{ErrorCode:0, Message:\"OK\", MessageID:\"29fdf3da-ae5d-40c8-af92-c13e93fa6b69\", SubmittedAt:\"2015-10-22T07:39:17.2297478-04:00\", To:\"\\\"RECIPIENT-NAME\\\" &lt;recipient@example.com&gt;\"}\n</code></pre>\n\n<p>I'm hoping that I'm making a rookie mistake with how I'm working with the attachments and fundamentally missing something easy in Go?</p>\n\n<p><em>Minor Note: I reverted the commit in the repo that added templating as I not using templates and I wasn't sure how to send without a template being specified</em></p>\n"}, {"tags": ["session", "go", "mgo"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1445527938, "post_id": 33275357, "comment_id": 54369982, "body": "I posted the wrong link here previously. Here&#39;s the right one: <a href=\"http://stackoverflow.com/questions/26574594/best-practice-to-maintain-a-mgo-session\" title=\"best practice to maintain a mgo session\">stackoverflow.com/questions/26574594/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 2, "creation_date": 1445622939, "post_id": 33295663, "comment_id": 54416039, "body": "<a href=\"https://godoc.org/gopkg.in/mgo.v2#Session.Copy\" rel=\"nofollow noreferrer\">mgo.Session.Copy()</a> does the same in a much simpler way plus it preserves authentication information and other configurationof the original session and the session is set up lazily."}], "tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": -1, "last_activity_date": 1445622744, "last_edit_date": 1445622744, "creation_date": 1445579576, "answer_id": 33295663, "question_id": 33275357, "link": "https://stackoverflow.com/questions/33275357/should-i-copy-session-for-each-operation-in-mgo/33295663#33295663", "title": "Should I copy session for each operation in mgo?", "body": "<p>yes, it is good to copy a session to perform one or several operations, letting the connection pool in mgo to improve the performance. the default limit is 4096 for one mongo server, to prevent too much connection.</p>\n\n<pre><code>func newSession(consistency Mode, cluster *mongoCluster, timeout time.Duration) (session *Session) {\n    cluster.Acquire()\n    session = &amp;Session{\n        cluster_:    cluster,\n        syncTimeout: timeout,\n        sockTimeout: timeout,\n        poolLimit:   4096,\n    }\n    debugf(\"New session %p on cluster %p\", session, cluster)\n    session.SetMode(consistency, true)\n    session.SetSafe(&amp;Safe{})\n    session.queryConfig.prefetch = defaultPrefetch\n    return session\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1582, "user_id": 986408, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eadebf2bf096f4e870d18b7c400ea58e?s=128&d=identicon&r=PG", "display_name": "codepushr", "link": "https://stackoverflow.com/users/986408/codepushr"}, "edited": false, "score": 0, "creation_date": 1529414088, "post_id": 33310401, "comment_id": 88857596, "body": "I like this approach. However, how do you deal with closing sessions? I saw people use defer to close sessions at some points in time. Is this really necessary? If so, how should we incorporate this into your example?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 1582, "user_id": 986408, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eadebf2bf096f4e870d18b7c400ea58e?s=128&d=identicon&r=PG", "display_name": "codepushr", "link": "https://stackoverflow.com/users/986408/codepushr"}, "edited": false, "score": 0, "creation_date": 1529414180, "post_id": 33310401, "comment_id": 88857660, "body": "@codepushr Uuups... ;) Feel free, or I&#39;ll do it later"}, {"owner": {"reputation": 1582, "user_id": 986408, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eadebf2bf096f4e870d18b7c400ea58e?s=128&d=identicon&r=PG", "display_name": "codepushr", "link": "https://stackoverflow.com/users/986408/codepushr"}, "edited": false, "score": 0, "creation_date": 1529414297, "post_id": 33310401, "comment_id": 88857737, "body": "I&#39;m not sure how it&#39;s done properly though, probably defer session.Close() inside main, and also in the handler but using the copy?"}], "tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 15, "last_activity_date": 1445629936, "creation_date": 1445629936, "answer_id": 33310401, "question_id": 33275357, "link": "https://stackoverflow.com/questions/33275357/should-i-copy-session-for-each-operation-in-mgo/33310401#33310401", "title": "Should I copy session for each operation in mgo?", "body": "<p>First of all, we need to see the difference between <a href=\"https://godoc.org/gopkg.in/mgo.v2#Session.Copy\" rel=\"noreferrer\">mgo.Session.Copy()</a> and <a href=\"https://godoc.org/gopkg.in/mgo.v2#Session.Clone\" rel=\"noreferrer\">mgo.Session.Clone()</a>. While <code>go.Session.Clone()</code> returns a new session, the session uses the same socket connection. That isn't necessarily a bad thing, but keep in mind that on the server side, a stack is allocated <em>per connection</em>. So the sessions would share the same stack. Depending on your use cases, that may make a big difference.</p>\n\n<p>And here is the problem \u2013 if you open a new socket connect for each record, this leads to a three way handshake, which is slowish. Reusing the same socket reduces this overhead, but there still is some and has the drawback described above.</p>\n\n<p>What I tend to do is to establish a new connection per long(er) running unit of work. A simple example illustrates this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    mgo \"gopkg.in/mgo.v2\"\n    bson \"gopkg.in/mgo.v2/bson\"\n    \"net/http\"\n)\n\nvar (\n    Database *mgo.Database\n)\n\n\n// The listEntries lists all posts\nfunc listPosts(w http.ResponseWriter, r *http.Request) {\n\n    // We have a rather long running unit of work\n    // (reading and listing all posts)\n    // So it is worth copying the session   \n    collection := Database.C(\"posts\").With( Database.Session.Copy() )\n\n    post  := bson.D{}\n    posts := collection.Find(bson.M{}).Iter()\n\n    for posts.Next(&amp;post) {\n        // Process posts and send it to w\n    }\n\n}\n\nfunc main() {\n\n    session, _ := mgo.Dial(\"mongodb://localhost:27017\")\n\n    Database := session.DB(\"myDb\")\n\n    // Count is a rather fast operation\n    // No need to copy the session here\n    count, _ := Database.C( \"posts\" ).Count()\n\n    fmt.Printf(\"Currently %d posts in the database\", count )\n\n    http.HandleFunc(\"/posts\", listPosts)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n"}], "owner": {"reputation": 6317, "user_id": 2849157, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/81de56159f8a6f58c78e3e7d88d7fbe5?s=128&d=identicon&r=PG&f=1", "display_name": "roger", "link": "https://stackoverflow.com/users/2849157/roger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7411, "favorite_count": 2, "answer_count": 2, "score": 5, "last_activity_date": 1445629936, "creation_date": 1445498492, "question_id": 33275357, "link": "https://stackoverflow.com/questions/33275357/should-i-copy-session-for-each-operation-in-mgo", "title": "Should I copy session for each operation in mgo?", "body": "<p>I want to <code>upsert</code> a list of record, so I have two choice, one just use one session, another copy a session for every record. So, as my opinion, first method may slower than the second, but will the first one cause too many session created?</p>\n\n<p>1.use one session</p>\n\n<pre><code>func (this *CvStoreServiceImpl) SetCvJobItemMeasureList(accessToken *base_datatype.ServiceAccessToken, versionPolicy string, jobItemList []*cv_common_type.CvJobItemMeasure) (err error) {\n    session := this.session.Clone()\n    defer session.Close()\n\n    for _, jobItem := range jobItemList {\n        objKey := &amp;orm.ItemIdKey{\n            VersionName: versionPolicy, //XXX\n            ItemId:      jobItem.ItemId,\n        }\n        obj := orm.ConvertToCvJobItemMeasureObj(versionPolicy, jobItem)\n        _, err2 := this.jobMeasureCollection.With(session).Upsert(objKey, obj)\n        if nil != err2 {\n            err = &amp;common_error.NamedError{err2.Error()}\n            this.logger.Println(err2.Error())\n        }\n    }\n    return\n}\n</code></pre>\n\n<p>2.copy session for every record</p>\n\n<pre><code>func (this *CvStoreServiceImpl) SetCvJobItemMeasure(accessToken *base_datatype.ServiceAccessToken, versionPolicy string, jobItem *cv_common_type.CvJobItemMeasure) (err error) {\n    session := this.session.Clone()\n    defer session.Close()\n\n    objKey := &amp;orm.ItemIdKey{\n        VersionName: versionPolicy, //XXX\n        ItemId:      jobItem.ItemId,\n    }\n    obj := orm.ConvertToCvJobItemMeasureObj(versionPolicy, jobItem)\n    _, err2 := this.jobMeasureCollection.With(session).Upsert(objKey, obj)\n    if nil != err2 {\n        err = &amp;common_error.NamedError{err2.Error()}\n        return\n    }\n    return\n}\n</code></pre>\n\n<p>then call this method in forloop:</p>\n\n<pre><code>for _, item := range cvMeasure.GetJobList() {\n    err = this.SetCvJobItemMeasure(accessToken, versionPolicy, item)\n    if nil != err {\n        return\n    }\n}\n</code></pre>\n"}, {"tags": ["multithreading", "go", "synchronization"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1445497297, "post_id": 33274920, "comment_id": 54350756, "body": "As I understand it: visibility of the value of b in g is not determined by f. <i>Inside</i> f a is set first and b afterwards and never the other way around."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 5403506, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1082656138424733/picture?type=large", "display_name": "Kyuntae Ethan Kim", "link": "https://stackoverflow.com/users/5403506/kyuntae-ethan-kim"}, "edited": false, "score": 0, "creation_date": 1445497580, "post_id": 33275092, "comment_id": 54350896, "body": "Thanks icza. Hmm.. this is a compiler and processor issue then. (I mean this is not a problem but the cause is compiler and processor.)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 121, "user_id": 5403506, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1082656138424733/picture?type=large", "display_name": "Kyuntae Ethan Kim", "link": "https://stackoverflow.com/users/5403506/kyuntae-ethan-kim"}, "edited": false, "score": 1, "creation_date": 1445503209, "post_id": 33275092, "comment_id": 54353995, "body": "@KyuntaeEthanKim It&#39;s an optimization <i>and</i> a synchronization issue: your goroutines are not synchronized so you have no guarantee what and if any of the updated values are observed by the other goroutine. It may print <code>2</code> and <code>1</code>, it may print <code>2</code> and <code>0</code>, it may print <code>0</code> and <code>1</code> and it may print <code>0</code> and <code>0</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 8, "last_activity_date": 1445500493, "last_edit_date": 1445500493, "creation_date": 1445497291, "answer_id": 33275092, "question_id": 33274920, "link": "https://stackoverflow.com/questions/33274920/incorrect-synchronization-in-go-lang/33275092#33275092", "title": "Incorrect synchronization in go lang", "body": "<p>Variables <code>a</code> and <code>b</code> are allocated and initialized with the zero values of their respective type (which is <code>0</code> in case of <code>int</code>) before any of the functions start to execute, at this line:</p>\n\n<pre><code>var a, b int\n</code></pre>\n\n<p>What may change is the order new values are assigned to them in the <code>f()</code> function.</p>\n\n<p>Quoting from that page: <a href=\"https://golang.org/ref/mem#tmp_2\" rel=\"noreferrer\">Happens Before</a>:</p>\n\n<blockquote>\n  <p>Within a single goroutine, reads and writes must behave as if they executed in the order specified by the program. That is, compilers and processors may reorder the reads and writes executed within a single goroutine only when the reordering does not change the behavior within that goroutine as defined by the language specification. Because of this reordering, the execution order observed by one goroutine may differ from the order perceived by another. For example, if one goroutine executes <code>a = 1; b = 2;</code>, another might observe the updated value of <code>b</code> before the updated value of <code>a</code>.</p>\n</blockquote>\n\n<p>Assignment to <code>a</code> and <code>b</code> may not happen in the order you write them if reordering them does not make a difference in the same goroutine. The compiler may reorder them for example if first changing the value of <code>b</code> is more efficient (e.g. because its address is already loaded in a register). If changing the assignment order would (or may) cause issue in the same goroutine, then obviously the compiler is not allowed to change the order. Since the goroutine of the <code>f()</code> function does nothing with the variables <code>a</code> and <code>b</code> after the assignment, the compiler is free to carry out the assignments in whatever order.</p>\n\n<p>Since there is no synchronization between the 2 goroutines in the above example, the compiler makes no effort to check whether reordering would cause any issues in the other goroutine. It doesn't have to.</p>\n\n<p>Buf if you synchronize your goroutines, the compiler will make sure that at the \"synchronization point\" there will be no inconsistencies: you will have guarantee that at that point both the assignments will be \"completed\"; so if the \"synchronization point\" is before the <code>print()</code> calls, then you will see the assigned new values printed: <code>2</code> and <code>1</code>.</p>\n"}], "owner": {"reputation": 121, "user_id": 5403506, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1082656138424733/picture?type=large", "display_name": "Kyuntae Ethan Kim", "link": "https://stackoverflow.com/users/5403506/kyuntae-ethan-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 3, "accepted_answer_id": 33275092, "answer_count": 1, "score": 4, "last_activity_date": 1494234727, "creation_date": 1445496531, "last_edit_date": 1445497043, "question_id": 33274920, "link": "https://stackoverflow.com/questions/33274920/incorrect-synchronization-in-go-lang", "title": "Incorrect synchronization in go lang", "body": "<p>While I was taking a look on the golang memory model document(<a href=\"https://golang.org/ref/mem#tmp_10\" rel=\"nofollow\">link</a>), I found a weird behavior on go lang. This document says that below code can happen that g prints 2 and then 0.</p>\n\n<pre><code>var a, b int\n\nfunc f() {\n    a = 1\n    b = 2\n}\n\nfunc g() {\n    print(b)\n    print(a)\n}\n\nfunc main() {\n    go f()\n    g()\n}\n</code></pre>\n\n<p>Is this only go routine issue? Because I am curious that why value assignment of variable 'b' can happen before that of 'a'? Even if value assignment of 'a' and 'b would happen in different thread(not in main thread), does it have to be ensured that 'a' should be assigned before 'b' in it's own thread?(because assignment of 'a' comes first and that of 'b' comes later) Can anyone please tell me about this issue clearly?</p>\n"}, {"tags": ["go", "google-drive-api"], "comments": [{"owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "edited": false, "score": 0, "creation_date": 1445497457, "post_id": 33274427, "comment_id": 54350832, "body": "define cant download the file."}, {"owner": {"reputation": 709, "user_id": 1804475, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1d2b87e166e80d825e030dccc7399ca1?s=128&d=identicon&r=PG", "display_name": "KTW", "link": "https://stackoverflow.com/users/1804475/ktw"}, "reply_to_user": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "edited": false, "score": 0, "creation_date": 1445498646, "post_id": 33274427, "comment_id": 54351404, "body": "As mentioned, both the file DownloadUrl and the ExportFormats properties are always empty."}, {"owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "edited": false, "score": 0, "creation_date": 1445498923, "post_id": 33274427, "comment_id": 54351544, "body": "what scope did you authenticate with?"}, {"owner": {"reputation": 709, "user_id": 1804475, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1d2b87e166e80d825e030dccc7399ca1?s=128&d=identicon&r=PG", "display_name": "KTW", "link": "https://stackoverflow.com/users/1804475/ktw"}, "reply_to_user": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "edited": false, "score": 0, "creation_date": 1445499369, "post_id": 33274427, "comment_id": 54351770, "body": "I used this example code for authorization <a href=\"https://developers.google.com/drive/web/quickstart/go\" rel=\"nofollow noreferrer\">developers.google.com/drive/web/quickstart/go</a> under the same user account (mine) which was used for uploading the files. (From an android app)"}, {"owner": {"reputation": 709, "user_id": 1804475, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1d2b87e166e80d825e030dccc7399ca1?s=128&d=identicon&r=PG", "display_name": "KTW", "link": "https://stackoverflow.com/users/1804475/ktw"}, "reply_to_user": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "edited": false, "score": 0, "creation_date": 1445499755, "post_id": 33274427, "comment_id": 54352003, "body": "What I meant was authentication. :-)"}, {"owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "edited": false, "score": 0, "creation_date": 1445499778, "post_id": 33274427, "comment_id": 54352009, "body": "OK my GO skills are beyond nub range.  but ..  drive.DriveMetadataReadonlyScope  is probably your problem  see if you can find something like drive.DriveScope or drive.DriveFileScope   (I am guessing here) check this <a href=\"https://developers.google.com/drive/web/scopes\" rel=\"nofollow noreferrer\">developers.google.com/drive/web/scopes</a>"}, {"owner": {"reputation": 6535, "user_id": 2037269, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/oDhyJ.jpg?s=128&g=1", "display_name": "seanpj", "link": "https://stackoverflow.com/users/2037269/seanpj"}, "edited": false, "score": 0, "creation_date": 1445504421, "post_id": 33274427, "comment_id": 54354712, "body": "I&#39;m no a GO guy, but I just answered something similar in Java, see  <a href=\"http://stackoverflow.com/questions/33250924/unable-to-download-file-from-google-drive-using-java-api/33276864#33276864\">here</a>. You may try to translate it to GO."}, {"owner": {"reputation": 709, "user_id": 1804475, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1d2b87e166e80d825e030dccc7399ca1?s=128&d=identicon&r=PG", "display_name": "KTW", "link": "https://stackoverflow.com/users/1804475/ktw"}, "reply_to_user": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "edited": false, "score": 0, "creation_date": 1445506219, "post_id": 33274427, "comment_id": 54355924, "body": "Ahhh, @DaImTo - You might be on to something there :-) The app has View Metadata. Now I just need to figure out how to change this. I will test when I get home. Thanks!"}, {"owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "edited": false, "score": 0, "creation_date": 1445507205, "post_id": 33274427, "comment_id": 54356560, "body": "Yup viewmeta data wont let you download the file.  Up the scope and reauthentcate try again."}, {"owner": {"reputation": 6535, "user_id": 2037269, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/oDhyJ.jpg?s=128&g=1", "display_name": "seanpj", "link": "https://stackoverflow.com/users/2037269/seanpj"}, "edited": false, "score": 0, "creation_date": 1445515785, "post_id": 33274427, "comment_id": 54361661, "body": "... and another version of the same problem (in Java again) is <a href=\"http://stackoverflow.com/questions/33279687/download-google-docs-file-from-google-drive-with-java/33280384#33280384\">here</a>."}], "answers": [{"comments": [{"owner": {"reputation": 709, "user_id": 1804475, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1d2b87e166e80d825e030dccc7399ca1?s=128&d=identicon&r=PG", "display_name": "KTW", "link": "https://stackoverflow.com/users/1804475/ktw"}, "edited": false, "score": 0, "creation_date": 1445842825, "post_id": 33274913, "comment_id": 54476021, "body": "No, the files are not restricted. Values: {Hidden:false Restricted:false Starred:false Trashed:false Viewed:true}"}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": false, "score": 1, "last_activity_date": 1445496518, "creation_date": 1445496518, "answer_id": 33274913, "question_id": 33274427, "link": "https://stackoverflow.com/questions/33274427/cannot-download-files-using-google-drive-api-in-go/33274913#33274913", "title": "Cannot download files using Google Drive API in Go", "body": "<p>Is the file restricted?</p>\n\n<p>See <a href=\"https://developers.google.com/drive/v2/reference/files\" rel=\"nofollow\">files docs</a> under <code>labels.restricted</code></p>\n\n<p><code>labels.restricted</code>     <code>boolean</code>   Whether viewers and commenters are prevented from downloading, printing, and copying this file.</p>\n"}], "owner": {"reputation": 709, "user_id": 1804475, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1d2b87e166e80d825e030dccc7399ca1?s=128&d=identicon&r=PG", "display_name": "KTW", "link": "https://stackoverflow.com/users/1804475/ktw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1298, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1527004652, "creation_date": 1445494273, "last_edit_date": 1592644375, "question_id": 33274427, "link": "https://stackoverflow.com/questions/33274427/cannot-download-files-using-google-drive-api-in-go", "title": "Cannot download files using Google Drive API in Go", "body": "<p>I am trying to download some *.FIT files using Google Drive API for Go, from a private folder stored in my Google Drive. (Garmin 310XT data)</p>\n<p>I have followed the wizard and guide found <a href=\"https://developers.google.com/drive/web/quickstart/go\" rel=\"nofollow noreferrer\">here</a>, and have successfully obtained a full list of files from a folder by id.</p>\n<p>I am using <a href=\"https://developers.google.com/drive/v2/reference/files/get\" rel=\"nofollow noreferrer\">this sample code</a>, but I cannot download any of the files.\nBoth the file DownloadUrl and the ExportFormats properties are always empty.\nHas anyone successfully done this, or am I just missing something important?</p>\n<p>Edit:\nThe first problem was about scope, but after changing it to drive.DriveScope I can only download 0 byte files.</p>\n<hr />\n<h3>Solved</h3>\n<p>Using the correct http.RoundTripper solved the 0 byte size issue.\n(client.Transport)</p>\n"}]