[{"tags": ["dataframe", "go", "google-sheets-api"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1505951417, "post_id": 46333186, "comment_id": 79627427, "body": "What is the panic, including the stack trace?"}], "answers": [{"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": 0, "last_activity_date": 1505952006, "creation_date": 1505952006, "answer_id": 46333404, "question_id": 46333186, "link": "https://stackoverflow.com/questions/46333186/how-to-marshal-and-unmarshal-or-convert-objects-while-avoiding-type-in-golang/46333404#46333404", "title": "How to marshal and unmarshal or convert objects while avoiding type in golang", "body": "<p>Try to provide a runnable example, as it makes it easier to debug. This looks like it uses private code, but you should be able to reproduce without using your gosheets lib, with test input. </p>\n\n<p>So trying this for example as sheetdata produces a panic:</p>\n\n<pre><code>sheetdata := [][]string{{\"1\", \"2\", \"3\", \"4\", \"5\"}, {\"1\", \"2\", \"3\"}}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/hJXBlO_40O\" rel=\"nofollow noreferrer\">https://play.golang.org/p/hJXBlO_40O</a></p>\n\n<p>so if your error is this:</p>\n\n<pre><code>panic: runtime error: index out of range\n\ngithub.com/kniren/gota/dataframe.LoadRecords(0xc420058060, 0x2, 0x4, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\ngithub.com/kniren/gota/dataframe/dataframe.go:693 +0xc53\n</code></pre>\n\n<p>Your probably have data which has header fields longer than following rows (assuming it is looking at csv data). This assumption is baked in <a href=\"https://sourcegraph.com/github.com/kniren/gota@531ec7b7d82e2a7b7355b63011197a29d401aba6/-/blob/dataframe/dataframe.go#L710\" rel=\"nofollow noreferrer\">here</a>, LoadRecords should really check and return an error not panic.</p>\n"}], "owner": {"reputation": 764, "user_id": 1405725, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/85157a97c87155b8ec2671e86aef1087?s=128&d=identicon&r=PG", "display_name": "Darian311", "link": "https://stackoverflow.com/users/1405725/darian311"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1505952006, "creation_date": 1505950195, "question_id": 46333186, "link": "https://stackoverflow.com/questions/46333186/how-to-marshal-and-unmarshal-or-convert-objects-while-avoiding-type-in-golang", "title": "How to marshal and unmarshal or convert objects while avoiding type in golang", "body": "<p>I'm working on code to integrate Google Sheets with a dataframe sdk: <a href=\"https://github.com/kniren/gota\" rel=\"nofollow noreferrer\">https://github.com/kniren/gota</a>.  This code causes a panic at   \"df := dataframe.LoadRecords(values)\" everytime. When I use a debugger it shows a panic.  Everything in the watcher shows values in my [][]string exactly as expected. If there is a better way to convert sheets cells into an [][]string, please comment.   </p>\n\n<pre><code>package main\n\nimport (\n    \"bitbucket.org/gosheets\"\n    \"fmt\"\n    \"github.com/kniren/gota/dataframe\"\n    \"reflect\"\n)\n\nfunc main() {\n    sheetdata := gosheets.Setup()\n    // row1 is column names\n    fmt.Println(reflect.TypeOf(sheetdata.Values))\n    values := [][]string{}\n    //sheetdata.Values.(*sheets.ValueRange)\n    fmt.Sprintln(sheetdata.Values)\n    for _, row := range sheetdata.Values.Values {\n        sr := []string{}\n        for i, cell := range row {\n            //capping columns at 5 for starters\n            if i &gt;= 5 {\n                break\n            }\n            sr = append(sr, fmt.Sprint(cell))\n        }\n        fmt.Sprintln(row)\n        values = append(values, sr)\n        //values = append(values, fmt.Sprintln(row))\n    }\n    //opts := dataframe.LoadOption{detectTypes: false}\n    df := dataframe.LoadRecords(values)\n\n    //df := dataframe.ReadCSV(sheetdata.Values)\n    //fmt.Println(sheetdata.Values)\n    fmt.Println(df.Names())\n\n}\n</code></pre>\n"}, {"tags": ["sockets", "networking", "go", "client-server", "p2p"], "comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 1, "creation_date": 1505949930, "post_id": 46332498, "comment_id": 79627103, "body": "So, when a peer connects to you, you try to connect back on that socket&#39;s remote port?   You do realize that sockets are bi-directional, right?   Or is there some more complex thing going on that requires each node to have two connections between them?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1505953765, "post_id": 46332498, "comment_id": 79627947, "body": "Why is it important what port you dial out from?"}, {"owner": {"reputation": 1419, "user_id": 3788493, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/eLdB2.jpg?s=128&g=1", "display_name": "jeanluc", "link": "https://stackoverflow.com/users/3788493/jeanluc"}, "edited": false, "score": 0, "creation_date": 1505964172, "post_id": 46332498, "comment_id": 79630128, "body": "When a new node boots up, it has a list of addresses that it needs to ping. You must first ping those nodes before they contact you back"}], "answers": [{"comments": [{"owner": {"reputation": 1419, "user_id": 3788493, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/eLdB2.jpg?s=128&g=1", "display_name": "jeanluc", "link": "https://stackoverflow.com/users/3788493/jeanluc"}, "edited": false, "score": 0, "creation_date": 1505964827, "post_id": 46333161, "comment_id": 79630291, "body": "Unfortunately that does not work when using the same port as the listener. You get error: <code>bind: address already in use</code>"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 0, "last_activity_date": 1505950081, "creation_date": 1505950081, "answer_id": 46333161, "question_id": 46332498, "link": "https://stackoverflow.com/questions/46332498/dial-address-from-same-port-that-is-being-listened-to/46333161#46333161", "title": "Dial address from same port that is being listened to", "body": "<p>If you are looking to control the local port when dialing out, you can use <a href=\"https://golang.org/pkg/net/#DialTCP\" rel=\"nofollow noreferrer\">net.DialTCP</a></p>\n"}], "owner": {"reputation": 1419, "user_id": 3788493, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/eLdB2.jpg?s=128&g=1", "display_name": "jeanluc", "link": "https://stackoverflow.com/users/3788493/jeanluc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505950081, "creation_date": 1505945386, "question_id": 46332498, "link": "https://stackoverflow.com/questions/46332498/dial-address-from-same-port-that-is-being-listened-to", "title": "Dial address from same port that is being listened to", "body": "<p>I'm developing a P2P application and would like the nodes to serve as both clients and servers. For example, say that I establish a listening node with the following code running in a goroutine:</p>\n\n<pre><code>ln, _ := net.Listen(\"tcp\", \":8080\")\nfor { \n    conn, err := ln.Accept() \n    ..... \n}\n</code></pre>\n\n<p>Then, in another goroutine the logic has determined that it must contact another node to let it know of its existence, say on the localhost address \":8081\" which also has a similar listening loop running.</p>\n\n<p>If I just use <code>net.Dial(\"tcp\", \":8081\")</code>, it will choose a random port number to connect from, and the node on <code>8081</code> will try to contact that port instead of the correct one on <code>8080</code>. Is there a way to initiate the <code>net.Dial</code> call from <code>8080</code>? Is such a thing even allowed, or would the listener get confused and intercept the communications that were meant for the socket returned by <code>net.Dial</code>?</p>\n"}, {"tags": ["image", "go", "draw"], "answers": [{"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 1, "last_activity_date": 1505945632, "creation_date": 1505945632, "answer_id": 46332534, "question_id": 46331906, "link": "https://stackoverflow.com/questions/46331906/go-draw-over-image-mask/46332534#46332534", "title": "Go draw over image mask", "body": "<p>You look like you're just replacing pixels with the colour if all components match. If you look at the compositing methods in <a href=\"https://github.com/anthonynsimon/bild\" rel=\"nofollow noreferrer\">bild/blend</a> you should find one that suits you for combining images - you probably want Opacity or Multiply modes and could extract code from this file:</p>\n\n<p><a href=\"https://github.com/anthonynsimon/bild/blob/master/blend/blend.go\" rel=\"nofollow noreferrer\">https://github.com/anthonynsimon/bild/blob/master/blend/blend.go</a></p>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "accepted_answer_id": 46332534, "answer_count": 1, "score": 1, "last_activity_date": 1505945632, "creation_date": 1505942195, "question_id": 46331906, "link": "https://stackoverflow.com/questions/46331906/go-draw-over-image-mask", "title": "Go draw over image mask", "body": "<p>I am trying to draw over an image using a template, the template image is the following</p>\n\n<p><a href=\"https://i.stack.imgur.com/l49Zf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l49Zf.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to colorize the image red, green, blue and yellow colors with custom colors and achieve something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qNpX6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qNpX6.png\" alt=\"enter image description here\"></a></p>\n\n<p>In order to achieve this I currently use this image as a base</p>\n\n<p><a href=\"https://i.stack.imgur.com/lX3zB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lX3zB.png\" alt=\"enter image description here\"></a></p>\n\n<p>And then draw over the template using <code>draw.Draw(outfitImage, outfitImage.Bounds(), generatorImage, image.ZP, draw.Over)</code></p>\n\n<p>This however gives a very weird result (nothing near the expected result), this is how I replace pixels</p>\n\n<pre><code>func paintPixels(img *image.NRGBA, base color.Color, dst color.Color) {\n    br, bg, bb, ba := base.RGBA()\n    dr, dg, db, _ := dst.RGBA()\n    for x := 0; x &lt; img.Bounds().Dx(); x++ {\n        for y := 0; y &lt; img.Bounds().Dy(); y++ {\n            r, g, b, a := img.At(x, y).RGBA()\n            if br == r &amp;&amp; bg == g &amp;&amp; bb == b &amp;&amp; ba == a {\n                img.Set(x, y, color.RGBA{uint8(dr), uint8(dg), uint8(db), 255})\n            }\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/wTFiG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wTFiG.png\" alt=\"enter image description here\"></a></p>\n\n<p>The result can vary depending on the alpha value I use when colorizing the image template. So I cant think of a way to achieve the expected result, I guess I should use a mask with <code>draw.DrawMask</code> but I have no clue where to start or how to achieve the result I am looking for</p>\n"}, {"tags": ["function", "go", "parameters", "casting"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1505938486, "post_id": 46330770, "comment_id": 79622885, "body": "This can be done but it is ugly. As a beginner don&#39;t try to fight Go&#39;s static typing. You could write three different functions with static types. Given that the function is 4 lines long this is okay. Once you mastered Go you could pass in a pointer to the result. This would work very well with the empty interface and there would be no need to return anything. For now: Write statically typed code is the best advice I can give."}, {"owner": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1505938731, "post_id": 46330770, "comment_id": 79623012, "body": "@Volker - Unfortunately the function is not 4 lines in my code, more like 25. It also includes authentication using jwt. So I would like to keep it one function. If I need to keep this one function, are there any other ways you could suggest?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1505971356, "post_id": 46330770, "comment_id": 79631866, "body": "Then it will be 25 lines of code. My suggestion is: Do not fight the type system as a beginner. And no, I won&#39;t suggest reflection to a beginner. Btw. Your code would work if you dropped returning the value."}], "answers": [{"tags": [], "owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "is_accepted": false, "score": 0, "last_activity_date": 1505938814, "creation_date": 1505938814, "answer_id": 46331139, "question_id": 46330770, "link": "https://stackoverflow.com/questions/46330770/how-to-use-interface-as-flexible-function-argument-and-return-type/46331139#46331139", "title": "How to use interface{} as flexible function argument and return type?", "body": "<p>I'll first say that you should always check for errors from any function that possibly returns one.</p>\n\n<p>The error you are seeing is because you are trying to declare a variable <code>item</code> as type <code>return_type</code> and that is the name of a function argument.</p>\n\n<p>The other error is from <code>Index</code> being a type declaration and not a concrete value of the <code>Index</code> type.</p>\n\n<p>I agree with Volker's comment but to put it in code, you could use something like this:</p>\n\n<pre><code>func (self *RestClient) request(action string, return_type interface{}) {\n    res, err := goreq.Request{Uri:self.url + action}.Do()\n    if err != nil {\n        // Do something with error here.\n    }\n    res.Body.FromJsonTo(return_type)\n}\n\nvar index Index\nrest_client.request(\"/some/path\", &amp;index)\n</code></pre>\n\n<p>This allows flexibility but could lead to strange cases if you forget to pass a pointer to the value <code>return_type</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": 4, "last_activity_date": 1505945303, "last_edit_date": 1505945303, "creation_date": 1505944709, "answer_id": 46332388, "question_id": 46330770, "link": "https://stackoverflow.com/questions/46330770/how-to-use-interface-as-flexible-function-argument-and-return-type/46332388#46332388", "title": "How to use interface{} as flexible function argument and return type?", "body": "<p>A few hints based on this code: </p>\n\n<ul>\n<li>Don't use self - use a meaningful identifier </li>\n<li>Don't use interface{} to avoid dealing with the type system</li>\n<li>Don't use reflection</li>\n<li>Don't ignore errors returned (as from FromJsonTo or goreq.Request)</li>\n<li>Don't use a library like goreq unless you are sure you need it (you don't) - you are pulling in <a href=\"https://sourcegraph.com/github.com/franela/goreq@b5b0f5eb2d16f20345cce0a544a75163579c0b00/-/blob/goreq.go#L276:18\" rel=\"nofollow noreferrer\">lots</a> of code you don't need and it is teaching you bad habits like attempting to use empty interface and reflection to solve simple problems. </li>\n</ul>\n\n<p>Have a look at the definition of <a href=\"https://sourcegraph.com/github.com/franela/goreq@b5b0f5eb2d16f20345cce0a544a75163579c0b00/-/blob/goreq.go#L117:16\" rel=\"nofollow noreferrer\">FromJsonTo</a> - if you look through this library you'll see it isn't saving you much effort and is adding lots of complexity. Here is how you could do it without the library:</p>\n\n<pre><code>func (c *RestClient) Request(action string, resource interface{}) error {\n    res, err := http.Get(c.url + action)\n    if err != nil {\n        return err\n    }\n    defer res.Body.Close()\n    return json.NewDecoder(res.Body).Decode(resource)\n}\n</code></pre>\n\n<p>Or use an interface and move the decoding to the resource (which could embed a default decoder): </p>\n\n<pre><code>type Decoder interface {\n    Decode(r io.Reader) error\n}\n\n// RequestDecode fetches a request and feeds it to the decoder\nfunc (c *RestClient) RequestDecode(action string, resource Decoder) error {\n    res, err := http.Get(c.url + action)\n    if err != nil {\n        return err\n    }\n    defer res.Body.Close()\n    return resource.Decode(res.Body)\n}\n</code></pre>\n"}], "owner": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1505945303, "creation_date": 1505937336, "question_id": 46330770, "link": "https://stackoverflow.com/questions/46330770/how-to-use-interface-as-flexible-function-argument-and-return-type", "title": "How to use interface{} as flexible function argument and return type?", "body": "<p>I'm a beginner with Go, and I'm now writing a function which can call an API. The function receives a part of the url (<code>/user</code>, <code>/account</code>, etc) and the struct to convert the returned json to (the structs <code>User</code> or <code>Account</code> for example) as arguments.</p>\n\n<p>So I now have this:</p>\n\n<pre><code>func (self *RestClient) request(action string, return_type interface{}) interface{} {\n    res, _ := goreq.Request{Uri:self.url + action}.Do()\n    var item return_type\n    res.Body.FromJsonTo(&amp;item)\n    return item\n}\n</code></pre>\n\n<p>And I try to call this function using (with <code>Index</code> being the struct for the return type):</p>\n\n<pre><code>self.request(\"/api/v1/public/index\", Index)\n</code></pre>\n\n<p>But this doesn't work. I get the following errors:</p>\n\n<pre><code>return_type is not a type\ntype Index is not an expression\n</code></pre>\n\n<p>I guess I understand why this is. I think I have to somehow find out the type of <code>return_type</code> and then convert <code>return_type</code> to that type, before using it as the type for <code>item</code>. I have no idea how though.\nAbout the second error I have no idea. I don't even understand what is meant by it.</p>\n\n<p>Could anybody help me out? How can I make this work? Or should this be done in a completely different way all together? All tips are welcome!</p>\n"}, {"tags": ["go", "routing"], "comments": [{"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 0, "creation_date": 1505947233, "post_id": 46329506, "comment_id": 79626368, "body": "Have you tried removing the use of the cas client middleware? Perhaps try it with the simplest possible handlers first, without client.HandleFunc or any cas.xxx calls. You might find cas is redirecting to /."}, {"owner": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "reply_to_user": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 0, "creation_date": 1505954487, "post_id": 46329506, "comment_id": 79628077, "body": "Yes. I&#39;ll edit the post to add the simplest test case I can think of."}], "answers": [{"comments": [{"owner": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "edited": false, "score": 0, "creation_date": 1506017677, "post_id": 46334453, "comment_id": 79661506, "body": "Thanks for the help. I&#39;m not quite sure what I&#39;m doing here, but here&#39;s a printout from one attempt:  REQUEST_SCHEME=http CONTEXT_PREFIX= CONTEXT_DOCUMENT_ROOT=/home/user1/public_html SERVER_ADMIN=webmaster@user1.mycpanel.sample.com SCRIPT_FILENAME=/home/user1/public_html/main.cgi REMOTE_PORT=45516 GATEWAY_INTERFACE=CGI/1.1 SERVER_PROTOCOL=HTTP/1.1 REQUEST_METHOD=get QUERY_STRING= REQUEST_URI=/main.cgi/other SCRIPT_NAME=/other PATH_INFO=/other PATH_TRANSLATED=/home/user1/public_html/other"}, {"owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "reply_to_user": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "edited": false, "score": 0, "creation_date": 1506020465, "post_id": 46334453, "comment_id": 79662971, "body": "Take a look here to see how Go builds the request based on those vars: <a href=\"https://golang.org/src/net/http/cgi/child.go?#L94\" rel=\"nofollow noreferrer\">golang.org/src/net/http/cgi/child.go?#L94</a>"}, {"owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "reply_to_user": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "edited": false, "score": 0, "creation_date": 1506026632, "post_id": 46334453, "comment_id": 79665880, "body": "@Brent: see my edit in the answer based on what you pasted"}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 1, "last_activity_date": 1506026603, "last_edit_date": 1506026603, "creation_date": 1505960679, "answer_id": 46334453, "question_id": 46329506, "link": "https://stackoverflow.com/questions/46329506/web-address-routing-works-fine-with-http-listenandserve-but-fails-with-cgi-serv/46334453#46334453", "title": "Web address routing works fine with http.ListenAndServe, but fails with cgi.Serve()", "body": "<p>The CGI program expects some variables to be set in order to build the request.</p>\n\n<p>Probably there is some issue with the configuration of your web server in which the variables are either not set correctly or not named correctly.</p>\n\n<p>To verify this:</p>\n\n<p>1) Add this before calling <code>cgi.Serve</code> and you'll see how the right handler is called (<code>otherHandler</code>)</p>\n\n<pre><code>os.Setenv(\"REQUEST_METHOD\", \"get\")\nos.Setenv(\"SERVER_PROTOCOL\", \"HTTP/1.1\")\nos.Setenv(\"SCRIPT_NAME\", \"/other\")\n</code></pre>\n\n<p>2) Add this at the beginning of the <code>main</code> to check how the variables are being set by the web server:</p>\n\n<pre><code>fmt.Println(os.Environ())\n</code></pre>\n\n<p>In that output, look for the CGI meta variables defined in the spec:</p>\n\n<p><a href=\"http://www.ietf.org/rfc/rfc3875\" rel=\"nofollow noreferrer\">http://www.ietf.org/rfc/rfc3875</a></p>\n\n<p>Look for the section \"Request Meta-Variables\" in that page, you are probably looking for the <code>SCRIPT_NAME</code> or <code>PATH_INFO</code> variables.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>From the variable values you pasted below, it seems the issue is that the REQUEST_URI contains an additional path component:</p>\n\n<pre><code>REQUEST_URI=/main.cgi/other\n</code></pre>\n\n<p>So the easiest fix would be for you to map the routes accordingly:</p>\n\n<pre><code>http.HandleFunc(\"/main.cgi/other\", otherHandler)\nhttp.HandleFunc(\"/\", defaultHandler)  // or maybe /main.cgi\n</code></pre>\n"}], "owner": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 46334453, "answer_count": 1, "score": 0, "last_activity_date": 1506026603, "creation_date": 1505932783, "last_edit_date": 1505954761, "question_id": 46329506, "link": "https://stackoverflow.com/questions/46329506/web-address-routing-works-fine-with-http-listenandserve-but-fails-with-cgi-serv", "title": "Web address routing works fine with http.ListenAndServe, but fails with cgi.Serve()", "body": "<p>I'm working on a website using Go. The server constraints require that I use CGI. When I test the following code locally using http.ListenAndServe() (commented out below), the various handlers are called correctly depending on the address requested. However, if I use cgi.Serve() instead, the default router is executed for all addresses (i.e., the handler for \"/\" is always executed). I'd appreciate any clues as to how to fix the issue.</p>\n\n<p>EDIT: Here is the simplest test case I can think of to show the problem:</p>\n\n<p>//=============SIMPLIFIED CODE================//</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"net/http/cgi\"\n)\n\nfunc defaultHandler(w http.ResponseWriter, r *http.Request) {\n\n    fmt.Fprintf(w, \"Default\")\n}\n\nfunc otherHandler(w http.ResponseWriter, r *http.Request) {\n\n    fmt.Fprintf(w, \"Other\")\n}\n\n func main() {\n\n    http.HandleFunc(\"/other\", otherHandler)\n\n    http.HandleFunc(\"/\", defaultHandler)\n\n    /*\n        //Works fine\n        err := http.ListenAndServe(\":8090\", nil)\n        if err != nil {\n            panic(err)\n        }\n    */\n\n   //Always fires defaultHandler no matter the address requested\n    err := cgi.Serve(nil)\n\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>//=============CODE FROM ORIGINAL POST===================//</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"net/http/cgi\"\n    \"net/url\"\n    \"os\"\n\n    \"github.com/go-cas/cas\"\n)\n\nfunc logoutHandler(w http.ResponseWriter, r *http.Request) {\n    cas.RedirectToLogout(w, r)\n}\n\nfunc calendarHandler(w http.ResponseWriter, r *http.Request) {\n    if !cas.IsAuthenticated(r) {\n        cas.RedirectToLogin(w, r)\n}\n\n    fmt.Fprintf(w, \"Calendar for %s\", cas.Username(r))\n}\n\nfunc defaultHandler(w http.ResponseWriter, r *http.Request) {\n    if !cas.IsAuthenticated(r) {\n        cas.RedirectToLogin(w, r)\n    }\n\n    fmt.Fprintf(w, \"Hi there %s!\", cas.Username(r))\n}\n\nfunc main() {\n    u, _ := url.Parse(\"https://www.examplecasserver.com\")\n\n    client := cas.NewClient(&amp;cas.Options{\n        URL: u,\n    })\n\n    http.Handle(\"/logout\", client.HandleFunc(logoutHandler))\n\n    http.Handle(\"/calendar\", client.HandleFunc(calendarHandler))\n\n    http.Handle(\"/\", client.HandleFunc(defaultHandler))\n\n    /*\n        err := http.ListenAndServe(\":8080\", nil)\n        if err != nil {\n            log.Fatal(\"ListenAndServe: \", err)\n        }\n    */\n\n    err := cgi.Serve(nil)\n\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n"}, {"tags": ["macos", "go", "tensorflow", "clang"], "comments": [{"owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "edited": false, "score": 0, "creation_date": 1505929831, "post_id": 46327624, "comment_id": 79618328, "body": "Are you sure to have exported <b>both</b> <code>export LIBRARY_PATH=$LIBRARY_PATH:~&#47;mydir&#47;lib</code> and <code>export DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH:~&#47;mydir&#47;lib</code> ? Because the error is pretty clear, it seems the linker can&#39;t find the library (thus <code>DYLD_LIBRARY_PATH</code> does not contain the path of the tensorflow lib)"}], "answers": [{"comments": [{"owner": {"reputation": 1424, "user_id": 3585387, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/WPE9J.jpg?s=128&g=1", "display_name": "Jan Sila", "link": "https://stackoverflow.com/users/3585387/jan-sila"}, "edited": false, "score": 0, "creation_date": 1505977050, "post_id": 46332400, "comment_id": 79634354, "body": "that did solve it, thanks! I added <code>$DYLD_LIBRARY_PATH</code> and <code>$LIBRARY_PATH</code> to my <code>bash_profile</code> and works like a charm from terminal now. Not from PyCharm as editor, but I will figure that one out. Thanks a lot!"}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1557075295, "post_id": 46332400, "comment_id": 98636020, "body": "Good answer, I just want to add that detailed instructions on how to install tensorflow and configure the linker are provided here: <a href=\"https://www.tensorflow.org/install/lang_c\" rel=\"nofollow noreferrer\">tensorflow.org/install/lang_c</a>"}], "tags": [], "owner": {"reputation": 5655, "user_id": 6708503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b6830ee25bc34994df9835cc17b64aa?s=128&d=identicon&r=PG&f=1", "display_name": "ash", "link": "https://stackoverflow.com/users/6708503/ash"}, "is_accepted": true, "score": 4, "last_activity_date": 1505944760, "creation_date": 1505944760, "answer_id": 46332400, "question_id": 46327624, "link": "https://stackoverflow.com/questions/46327624/cannot-find-ltensorflow/46332400#46332400", "title": "Cannot find -ltensorflow", "body": "<p><code>$DYLD_LIBRARY_PATH</code> and <code>$LIBRARY_PATH</code> need to include the directory in which the C library (<code>libtensorflow.so</code>) is installed, not the Go libraries.</p>\n\n<p>I suspect this is not the case for you\n(<code>ls ${DYLD_LIBRARY_PATH}/libtensorflow.so</code>). (See Step 2 and 3 in <a href=\"https://www.tensorflow.org/install/install_go\" rel=\"nofollow noreferrer\">https://www.tensorflow.org/install/install_go</a>).</p>\n\n<p>To avoid needing the environment variables, you could also ensure that <code>libtensorflow.so</code> is in <code>/usr/local/lib</code> and then run <code>ldconfig</code> once after extracting it.</p>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 1424, "user_id": 3585387, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/WPE9J.jpg?s=128&g=1", "display_name": "Jan Sila", "link": "https://stackoverflow.com/users/3585387/jan-sila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1219, "favorite_count": 0, "accepted_answer_id": 46332400, "answer_count": 1, "score": 1, "last_activity_date": 1505944760, "creation_date": 1505925999, "last_edit_date": 1505932170, "question_id": 46327624, "link": "https://stackoverflow.com/questions/46327624/cannot-find-ltensorflow", "title": "Cannot find -ltensorflow", "body": "<p>I'm trying to make work <code>TF</code> on <code>Mac OS X</code>. I ran the tutorial <a href=\"https://www.tensorflow.org/install/install_go\" rel=\"nofollow noreferrer\">how to install it.</a> All went well, the tensorflow library is install in my <code>GOPATH</code> but I keep getting this error.</p>\n\n<pre><code>/usr/local/go/pkg/tool/darwin_amd64/link: running clang failed: exit status 1\nld: library not found for -ltensorflow\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>I understand it is something about <code>C</code> compiler cannot found <code>ltensorflow</code> library. <code>TF</code> runs all good with <code>Python2.7</code> though.  </p>\n\n<p>Any ideas how to fix it, please?</p>\n\n<p><strong>EDIT</strong>:</p>\n\n<pre><code>Air-MacBook-Air-Fonzik:GoTensor air$ echo $DYLD_LIBRARY_PATH \n/Users/air/PycharmProjects/GoTensor/\nAir-MacBook-Air-Fonzik:GoTensor air$ echo $LIBRARY_PATH \n/Users/air/PycharmProjects/GoTensor/\nAir-MacBook-Air-Fonzik:GoTensor air$ echo $GOPATH\n/Users/air/PycharmProjects/GoTensor/\n</code></pre>\n\n<p>this is the output of my paths now, still does not work. The folder <code>GoTensor</code> contains the <code>pkg</code> and <code>src</code> of <code>tensorflow</code> go package. Is this setup correct?</p>\n"}, {"tags": ["function", "go", "functional-programming"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1505914185, "post_id": 46323067, "comment_id": 79607524, "body": "If there is a package-wide variable or function declared, it can be used anywhere else in the package (and outside the package if it&#39;s exported), even if you use it before it&#39;s declared. However, the specifics of JavaScript hoisting don&#39;t apply to Go."}, {"owner": {"reputation": 593, "user_id": 3956094, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/100003002375819/picture?type=large", "display_name": "Yosua Lijanto Binar", "link": "https://stackoverflow.com/users/3956094/yosua-lijanto-binar"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1505914962, "post_id": 46323067, "comment_id": 79608161, "body": "@Gavin Your explanation is great, but does it have same functionality like function declaration?"}], "answers": [{"comments": [{"owner": {"reputation": 593, "user_id": 3956094, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/100003002375819/picture?type=large", "display_name": "Yosua Lijanto Binar", "link": "https://stackoverflow.com/users/3956094/yosua-lijanto-binar"}, "edited": false, "score": 0, "creation_date": 1505915196, "post_id": 46323745, "comment_id": 79608368, "body": "Great! So if I can say, it&#39;s all about simplicity, right?"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "reply_to_user": {"reputation": 593, "user_id": 3956094, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/100003002375819/picture?type=large", "display_name": "Yosua Lijanto Binar", "link": "https://stackoverflow.com/users/3956094/yosua-lijanto-binar"}, "edited": false, "score": 1, "creation_date": 1505916399, "post_id": 46323745, "comment_id": 79609243, "body": "I think it&#39;s about simplicity, expressiveness and compactness."}], "tags": [], "owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "is_accepted": true, "score": 4, "last_activity_date": 1505920643, "last_edit_date": 1505920643, "creation_date": 1505914988, "answer_id": 46323745, "question_id": 46323067, "link": "https://stackoverflow.com/questions/46323067/when-to-use-function-expression-rather-than-function-declaration-in-go/46323745#46323745", "title": "When to use function expression rather than function declaration in Go?", "body": "<p>Anonymous functions in Go are used in various situations:  <br><br>\n- to start a goroutine</p>\n\n<pre><code>go func() {\n    // body\n}()\n</code></pre>\n\n<p>- with a defer statement  </p>\n\n<pre><code>defer func() {\n    // body\n}()\n</code></pre>\n\n<p>- as an argument to another function  </p>\n\n<pre><code>err := filepath.Walk(root, func(path string, info os.FileInfo, err error) error {\n    // todo\n})\n</code></pre>\n\n<p>- as a closure (<a href=\"https://www.calhoun.io/5-useful-ways-to-use-closures-in-go/\" rel=\"nofollow noreferrer\">examples</a>)</p>\n\n<p>Function declarations are used when you want to refer to the function by name. Maybe to call it from multiple places in your own code, or to expose it to other packages.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 5, "last_activity_date": 1505922391, "last_edit_date": 1505922391, "creation_date": 1505918563, "answer_id": 46325118, "question_id": 46323067, "link": "https://stackoverflow.com/questions/46323067/when-to-use-function-expression-rather-than-function-declaration-in-go/46325118#46325118", "title": "When to use function expression rather than function declaration in Go?", "body": "<p>There is one unique property to each:</p>\n\n<ul>\n<li><p>A <a href=\"https://golang.org/ref/spec#Function_declarations\" rel=\"nofollow noreferrer\">function declaration</a> <strong>binds</strong> an identifier, the <em>function name</em>, to a function; so the function name will be an <a href=\"https://golang.org/ref/spec#Identifiers\" rel=\"nofollow noreferrer\">identifier</a> which <strong>you can refer to</strong>.</p></li>\n<li><p>A <a href=\"https://golang.org/ref/spec#Function_literals\" rel=\"nofollow noreferrer\">function literals</a> represents an anonymous function. Function literals are <em>closures</em>, they <strong>capture the surrounding environment</strong>: they may refer to variables defined in a surrounding function. Those variables are then shared between the surrounding function and the function literal, and they survive as long as they are accessible.</p></li>\n</ul>\n\n<p>Don't be deluded: syntactically whenever a function literal is used, a declared function could also be used. For example the following code is a valid and working Go code:</p>\n\n<pre><code>func do() {}\n\nfunc main() {\n    go do()\n    defer do()\n}\n</code></pre>\n\n<p>The answer to <em>when</em> to use one over the other lies in the unique properties listed above.</p>\n\n<p>Use function declaration when you want to refer to the function, when you want to reuse it. This is also a good way to separate code, function declaration must be at the file level: you can't declare a function in another function. See <a href=\"https://stackoverflow.com/questions/28252117/golang-nested-class-inside-function/28252170#28252170\">Golang nested class inside function</a> for details.</p>\n\n<p>Use function literals when you want the function to have access to the local variables and other identifiers surrounding it. Since you can't declare a function in another function, to capture the local variables and identifiers, the only option here is a function literal (unless you want to pass everything as arguments to a declared function, which could quickly get dirty if the function needs to modify the values in which case they need to be \"transformed\" into pointers and addresses need to be passed). For an interesting related question, check out <a href=\"https://stackoverflow.com/questions/28099441/define-a-recursive-function-within-a-function-in-go/28099510#28099510\">Define a recursive function within a function in Go</a>.</p>\n\n<p>When the function does not need to have a name, and the function does not need access to the local variables, you may choose which one to use, relying on your judgement, examples seen in other (quality) projects and prior experiences. If the function body is \"small\", easier / simpler to use a function literal. If the function body is \"big\", code will be easier to read and understand if you declare it as a separate function and provide sufficient documentation to it.</p>\n\n<p>An interesting / related topic is a variable of function type, which you may initialize using either a function literal or with a declared function. It has the benefits that it is an identifier so you can refer to it, and that its value can be changed and a new function can be assigned to it.</p>\n\n<p>For example:</p>\n\n<pre><code>func do() { fmt.Println(\"Doing...\") }\n\nvar f = do\n\nfunc main() {\n    f()\n    f = func() { fmt.Println(\"Not doing!\") }\n    f()\n}\n</code></pre>\n\n<p>Output of the above (try it on the <a href=\"https://play.golang.org/p/Dz7g0hACzY\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Doing...\nNot doing!\n</code></pre>\n\n<p>Very useful for mocking functions in tests. For an example, see <a href=\"https://stackoverflow.com/questions/40615641/testing-os-exit-scenarios-in-go-with-coverage-information-coveralls-io-goverall/40801733#40801733\">Testing os.Exit scenarios in Go with coverage information (coveralls.io/Goveralls)</a>.</p>\n"}], "owner": {"reputation": 593, "user_id": 3956094, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/100003002375819/picture?type=large", "display_name": "Yosua Lijanto Binar", "link": "https://stackoverflow.com/users/3956094/yosua-lijanto-binar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2027, "favorite_count": 2, "accepted_answer_id": 46323745, "answer_count": 2, "score": 3, "last_activity_date": 1530716777, "creation_date": 1505913249, "last_edit_date": 1530716777, "question_id": 46323067, "link": "https://stackoverflow.com/questions/46323067/when-to-use-function-expression-rather-than-function-declaration-in-go", "title": "When to use function expression rather than function declaration in Go?", "body": "<p>When to use functioneExpression rather than function declaration in Go?</p>\n\n<p>I searched Function Expression vs Function Declaration (in JS), it's about hoisting. How about Golang?</p>\n"}, {"tags": ["go", "oauth-2.0"], "answers": [{"tags": [], "owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "is_accepted": false, "score": 0, "last_activity_date": 1505963039, "creation_date": 1505963039, "answer_id": 46334776, "question_id": 46321454, "link": "https://stackoverflow.com/questions/46321454/how-can-i-add-a-custom-authentication-bearer-token-to-go-oauth2-exchange-functio/46334776#46334776", "title": "How can I add a custom Authentication Bearer token to go oauth2 Exchange function?", "body": "<p>I'm not sure if this is the most optimal way of doing it, but it seems to work.  This is the redirect callback handler that is called as a result of visiting the an auth endpoint.</p>\n\n<pre><code>// Create a custom tokenSource type\ntype tokenSource struct{ token *oauth2.Token }\n\nfunc (t *tokenSource) Token() (*oauth2.Token, error) {\n    fmt.Println(\"TokenSource!\", t.token)\n    return t.token, nil\n}\n\nfunc handleCallback(w http.ResponseWriter, r *http.Request) {\n\n    state := r.FormValue(\"state\")\n    if state != oauthStateString {\n        fmt.Printf(\"invalid oauth state, expected '%s', got '%s'\\n\", oauthStateString, state)\n        http.Redirect(w, r, \"/\", http.StatusTemporaryRedirect)\n        return\n    }\n\n    code := r.FormValue(\"code\")\n\n    // Create a tokenSource and fill in our application Bearer token\n    ts := &amp;tokenSource{\n        token: &amp;oauth2.Token{\n            AccessToken: appToken.AccessToken,\n            TokenType: appToken.TokenType,\n        },\n    }\n\n    tr := &amp;oauth2.Transport{\n        Source: ts,\n    }\n\n    ctx := context.WithValue(context.Background(), oauth2.HTTPClient, &amp;http.Client{\n        Transport: tr,\n    })\n\n    // myConfig defined previously and in the usual way. Look at the examples.\n    token, err := myConfig.Exchange(ctx, code)\n    if err != nil {\n        fmt.Printf(\"Code exchange failed with '%s'\\n\", err)\n        http.Redirect(w, r, \"/\", http.StatusTemporaryRedirect)\n        return\n    }\n\n    fmt.Printf(\"token: %+v\", token)\n\n    // token can now be used.\n}\n</code></pre>\n"}], "owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 533, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505963039, "creation_date": 1505908694, "question_id": 46321454, "link": "https://stackoverflow.com/questions/46321454/how-can-i-add-a-custom-authentication-bearer-token-to-go-oauth2-exchange-functio", "title": "How can I add a custom Authentication Bearer token to go oauth2 Exchange function?", "body": "<p>We have an oauth2 endpoint that seems to require a client_credentials token to use as a Bearer for the initial code to token exchange process.  I have successfully obtained the token for that.</p>\n\n<p>However, in go's current implementation of oauth2 client lib, the Exchange() function (see: <a href=\"https://github.com/golang/oauth2/blob/13449ad91cb26cb47661c1b080790392170385fd/oauth2.go#L178\" rel=\"nofollow noreferrer\">Exchange</a> which eventually calls <a href=\"https://github.com/golang/oauth2/blob/master/internal/token.go#L171\" rel=\"nofollow noreferrer\">RetrieveToken</a>)</p>\n\n<p>It doesn't add an \"Authentication: Bearer \" header with a token I can slip in during the Exchange.  It can however add a Basic auth header.  Our implementation does not currently support basic auth though.</p>\n\n<p>If possible, I'd like to make it add the header without modifying the source code to to oauth2 package.</p>\n\n<p>It would appear if I call oauth2.RegisterBrokenAuthHeaderProvider it might skip the attempt to add a basic auth header which is needed in my case since that'll not work.</p>\n\n<p>Then finally the call to do the http request which is setup as a POST.</p>\n\n<p>Code:</p>\n\n<pre><code>func RetrieveToken(ctx context.Context, clientID, clientSecret, tokenURL string, v url.Values) (*Token, error) {\n    hc, err := ContextClient(ctx)\n    if err != nil {\n        return nil, err\n    }\n    bustedAuth := !providerAuthHeaderWorks(tokenURL)\n    if bustedAuth {\n        if clientID != \"\" {\n            v.Set(\"client_id\", clientID)\n        }\n        if clientSecret != \"\" {\n            v.Set(\"client_secret\", clientSecret)\n        }\n    }\n    req, err := http.NewRequest(\"POST\", tokenURL, strings.NewReader(v.Encode()))\n    if err != nil {\n        return nil, err\n    }\n    req.Header.Set(\"Content-Type\", \"application/x-www-form-urlencoded\")\n    if !bustedAuth {\n        req.SetBasicAuth(url.QueryEscape(clientID), url.QueryEscape(clientSecret))\n    }\n    r, err := ctxhttp.Do(ctx, hc, req)\n    if err != nil {\n        return nil, err\n    }\n\n  // rest of code ...\n}\n</code></pre>\n\n<p>the ctxhttp.Do can take a context.  I've been reading about these but I don't understand how they work.  Can I use them to add my header or any other headers I might require?</p>\n"}, {"tags": ["unit-testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 3713521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b5b4208f4e2874340cdf3e704289d6d?s=128&d=identicon&r=PG&f=1", "display_name": "Disuan", "link": "https://stackoverflow.com/users/3713521/disuan"}, "edited": false, "score": 0, "creation_date": 1505966892, "post_id": 46320940, "comment_id": 79630724, "body": "Thank you @icza, I got it."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 0, "last_activity_date": 1505907221, "creation_date": 1505907221, "answer_id": 46320940, "question_id": 46319732, "link": "https://stackoverflow.com/questions/46319732/golang-mocking-function-called-twice-times/46320940#46320940", "title": "Golang mocking function called twice times", "body": "<p>For any function or method to act differently based on the call number, this info needs to be available in it.</p>\n\n<p>Easiest is to add and increment a counter on each call, and inside the function examine the counter's current value, and act differently depending on its value:</p>\n\n<pre><code>type MockGetDeviceList struct {\n    returnResult []resources.DeviceListDataReturn\n    returnError  string\n    getCount     int\n}\n\nfunc (m *MockGetDeviceList) Get(familyName string, name string,\n    firmwareVersion string) ([]resources.DeviceListDataReturn, string) {\n\n    m.getCount++\n    if m.getCount == 1 {\n        // First call:\n        return nil, m.returnError\n    }\n    // Sencond and subsequent calls:\n    return m.returnResult, \"\"\n}\n</code></pre>\n\n<p>Another solution would be to replace the mock object / function after the first call, but this solution is harder to understand, more fragile and less maintainable.</p>\n"}], "owner": {"reputation": 63, "user_id": 3713521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b5b4208f4e2874340cdf3e704289d6d?s=128&d=identicon&r=PG&f=1", "display_name": "Disuan", "link": "https://stackoverflow.com/users/3713521/disuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2757, "favorite_count": 0, "accepted_answer_id": 46320940, "answer_count": 1, "score": 1, "last_activity_date": 1505907221, "creation_date": 1505903584, "last_edit_date": 1505903908, "question_id": 46319732, "link": "https://stackoverflow.com/questions/46319732/golang-mocking-function-called-twice-times", "title": "Golang mocking function called twice times", "body": "<p>I'm writing unit test for testing main.go and inside the function it's call Get function ( DeviceRepo.Get() ) twice then I would like to mock the Get function which return different but I can mock just first time when it called, So I have no idea how do I mock the Get function at the second time?</p>\n\n<p>main.go:</p>\n\n<pre><code>type DeviceInterface interface {}\ntype DeviceStruct struct{}\n\nvar DeviceRepo repositories.DeviceRepoInterface =  &amp;repositories.DeviceRepoStruct{}\n\nfunc (d *DeviceStruct) CheckDevice(familyname string, name string, firmwareversion string) string {\ndeviceList, deviceListErr := DeviceRepo.Get(familyname, name, firmwareversion)\n\nif deviceListErr != \"\" {\n    return \"some error\"\n}\n\nif len(deviceList) == 0 {\n    deviceList, _ := DeviceRepo.Get(familyname, name, \"\")\n\n    if len(deviceList) &gt; 0 {\n        return \"Invalid firmware version.\"\n    } else {\n        return \"Unknown device.\"\n    }\n}\n\nreturn \"Success\"\n}\n</code></pre>\n\n<p>main_test.go:</p>\n\n<pre><code>  type MockGetDeviceList struct {\n    returnResult []resources.DeviceListDataReturn\n    returnError  string\n  }\n\n  func (m *MockGetDeviceList) Get(familyName string, name string, firmwareVersion string) ([]resources.DeviceListDataReturn, string) {\n    return m.returnResult, m.returnError\n  }\n\n  func Test_CheckDevice_WrongFirmwareVersion(t *testing.T) {\n   Convey(\"Test_CheckDevice_WrongFirmwareVersion\", t, func() {\n    familyNameMock := \"A\"\n    nameMock := \"A\"\n    firmwareVersionMock := \"3\"\n\n    mockReturnData := []resources.DeviceListDataReturn{}\n\n    mockReturnDataSecond := []resources.DeviceListDataReturn{\n        {\n            FamilyName:      \"f\",\n            Name:            \"n\",\n            FirmwareVersion: \"1.0\",\n        },\n    }\n\n    deviceModel := DeviceStruct{}\n\n    getDeviceList := DeviceRepo\n    defer func() { DeviceRepo = getDeviceList }()\n    DeviceRepo = &amp;MockGetDeviceList{returnResult: mockReturnData}\n\n    getDeviceList = DeviceRepo\n    defer func() { DeviceRepo = getDeviceList }()\n    DeviceRepo = &amp;MockGetDeviceList{returnResult: mockReturnDataSecond}\n\n    expectReturn := \"Invalid firmware version.\"\n\n    actualResponse := deviceModel.CheckDevice(familyNameMock, nameMock, firmwareVersionMock)\n\n    Convey(\"Checking check-device wrong firmware version\", func() {\n        So(actualResponse, ShouldEqual, expectReturn)\n    })\n})\n}\n</code></pre>\n\n<p>I would like to mock the Get function return []resources.DeviceListDataReturn{} at first time and then return []resources.DeviceListDataReturn{\n{\n            FamilyName:      \"f\",\n            Name:            \"n\",\n            FirmwareVersion: \"1.0\",\n        },\n    } in the second time.</p>\n"}, {"tags": ["go", "reflection"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7119141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea760c3e0f83d43a5a748d50e98ea379?s=128&d=identicon&r=PG&f=1", "display_name": "lin van", "link": "https://stackoverflow.com/users/7119141/lin-van"}, "edited": false, "score": 0, "creation_date": 1505892028, "post_id": 46314827, "comment_id": 79592705, "body": "my first question, thank you sincerely~ i found the difference,  <code>fmt.Println(reflect.ValueOf(w).Type())&#47;&#47;print *main.Testg</code>   <code>fmt.Println(reflect.ValueOf(&amp;w).Type())&#47;&#47;print *main.Worker</code>  in the case I use the second way(I think this can change the value w point to)"}, {"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "reply_to_user": {"reputation": 23, "user_id": 7119141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea760c3e0f83d43a5a748d50e98ea379?s=128&d=identicon&r=PG&f=1", "display_name": "lin van", "link": "https://stackoverflow.com/users/7119141/lin-van"}, "edited": false, "score": 1, "creation_date": 1505908802, "post_id": 46314827, "comment_id": 79603621, "body": "@linvan You&#39;re welcome! Yes, <code>&amp;w</code> is quite useless, really. It will give you a pointer to an interface containing a pointer to the value. And you very seldom (never, really) work with pointers to interfaces in Go."}], "tags": [], "owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "is_accepted": true, "score": 3, "last_activity_date": 1505889633, "last_edit_date": 1505889633, "creation_date": 1505889226, "answer_id": 46314827, "question_id": 46314316, "link": "https://stackoverflow.com/questions/46314316/get-underlying-type-from-a-specific-interface-in-golang/46314827#46314827", "title": "get underlying type from a specific interface in golang", "body": "<p>Since <code>w</code> contains a pointer to a <code>Worker</code>, you might want to get a zero value of <em>the element it is pointing to</em>. Once you get the element, you can create a zero value of its type:</p>\n\n<pre><code>v := reflect.ValueOf(w).Elem() // Get the element pointed to\nzero := reflect.Zero(v.Type()) // Create the zero value\n</code></pre>\n\n<p>Above code snippet will panic if you pass in a non-pointer to <code>MakeSomething</code>. To prevent this, you might want to do the following instead:</p>\n\n<pre><code>v := reflect.ValueOf(w)\nif reflect.TypeOf(w).Kind() == reflect.Ptr {\n    v = v.Elem()\n}\nzero := reflect.Zero(v.Type())\n</code></pre>\n\n<p>If you actually want to have a pointer to a new <code>Worker</code>, you just replace <code>reflect.Zero(v.Type())</code> with  <code>reflect.New(v.Type())</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 7119141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea760c3e0f83d43a5a748d50e98ea379?s=128&d=identicon&r=PG&f=1", "display_name": "lin van", "link": "https://stackoverflow.com/users/7119141/lin-van"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5749, "favorite_count": 1, "accepted_answer_id": 46314827, "answer_count": 1, "score": 2, "last_activity_date": 1505889633, "creation_date": 1505887163, "question_id": 46314316, "link": "https://stackoverflow.com/questions/46314316/get-underlying-type-from-a-specific-interface-in-golang", "title": "get underlying type from a specific interface in golang", "body": "<p>As the example, can I get a zero value of its underlying type from the interface Work?</p>\n\n<pre><code>func MakeSomething(w Worker){\n    w.Work()\n\n    //can I get a zeor value type of The type underlying w?\n    //I tried as followed, but failed\n\n    copy :=w\n    v := reflect.ValueOf(&amp;copy)\n    fm :=v.Elem()\n    modified :=reflect.Zero(fm.Type())//fm.type is Worker, and modified comes to be nil\n    fm.Set(modified)\n    fmt.Println(copy)\n}\n\ntype Worker interface {\n    Work()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/rToji-2SFT\" rel=\"nofollow noreferrer\">the playground</a></p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1505885781, "post_id": 46313971, "comment_id": 79589550, "body": "If your criteria for searching is properties of the &quot;User&quot;, then surely it makes more sense to search from the &quot;User&quot; collection and then only return the  &quot;deactivation_requests&quot; which are joined to those users or user as the case may be. That&#39;s a lot more efficient than joining the collections first and then brute force searching the joined results for matching users."}, {"owner": {"reputation": 63, "user_id": 4971613, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c16e556a4e543395322dd15157db49b8?s=128&d=identicon&r=PG&f=1", "display_name": "Swati", "link": "https://stackoverflow.com/users/4971613/swati"}, "reply_to_user": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1505891028, "post_id": 46313971, "comment_id": 79592136, "body": "@NeilLunn Thanks for your answer. I have updated my question please take a look."}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 4971613, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c16e556a4e543395322dd15157db49b8?s=128&d=identicon&r=PG&f=1", "display_name": "Swati", "link": "https://stackoverflow.com/users/4971613/swati"}, "is_accepted": false, "score": 0, "last_activity_date": 1507128870, "creation_date": 1507128870, "answer_id": 46567994, "question_id": 46313971, "link": "https://stackoverflow.com/questions/46313971/how-do-i-perform-joinquery-with-search-in-mongodb-and-go/46567994#46567994", "title": "How do I perform Joinquery with search in MongoDB and go?", "body": "<p>Hello</p>\n\n<p>I found the answer for my query. I have tried the following code and it works for me.</p>\n\n<pre>\n\n    result := []bson.M{}\n            skip := 0\n            limit := 20\n            c := mongoSession.DB(\"database\").C(\"deactivation_requests\")\n            pipe := c.Pipe([]bson.M{\n                                    bson.M{\"$lookup\": bson.M{\n                                                        \"localField\"    : \"_id\",\n                                                        \"from\"          : \"users\",\n                                                        \"foreignField\"  : \"uid\",\n                                                        \"as\"            : \"profile\"}},\n                                    bson.M{\"$unwind\": \"$profile\"},\n                                    bson.M{\"$match\": bson.M{\"$or\": []bson.M{ \n                                                        bson.M{\"profile.first_name\":bson.RegEx{\"(?i).*\"+name+\".*\", \"i\"} },\n                                                        bson.M{\"profile.last_name\": bson.RegEx{ \"(?i).*\"+name+\".*\", \"i\"} }, \n                                                        bson.M{\"profile.email_id\": bson.RegEx{\"(?i).*\"+name+\".*\", \"i\"} }, \n                                                        bson.M{\"profile.phone_number\": bson.RegEx{\".*\"+keyword+\".*\", \"i\"} }, \n                                                        bson.M{\"profile.alt_phone_number\": bson.RegEx{\".*\"+keyword+\".*\", \"i\"} }, \n                                    }}},\n                                    bson.M{\"$skip\": skip},\n                                    bson.M{\"$limit\": limit},})\n            err = pipe.All(&result)\n            if err != nil {\n                return result, err\n            }\n\n</pre>\n"}], "owner": {"reputation": 63, "user_id": 4971613, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c16e556a4e543395322dd15157db49b8?s=128&d=identicon&r=PG&f=1", "display_name": "Swati", "link": "https://stackoverflow.com/users/4971613/swati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507128870, "creation_date": 1505885444, "last_edit_date": 1505893606, "question_id": 46313971, "link": "https://stackoverflow.com/questions/46313971/how-do-i-perform-joinquery-with-search-in-mongodb-and-go", "title": "How do I perform Joinquery with search in MongoDB and go?", "body": "<p>Hello Everyone, </p>\n\n<p>I am working on a project where customers can send account deactivation request and as admin I can see the list and deactivate them on a page, on the same page I have a search filter to filter by name, email and phone number. I have a collection to hold customers and another collection to save deactivation request. I have done the listing part as its simple with select query but facing problem to get list by search filters, I have following 2 structs in Go lang to get the record: </p>\n\n<pre>\n\n type DeactivationRequest struct {\n        Id                          int         `json:\"id\" bson:\"id\"`\n        Uid                         int         `json:\"uid\" bson:\"uid\"`\n        RequestTime                 int64       `json:\"request_time\" bson:\"request_time\"`\n        Status                      int         `json:\"status\" bson:\"status\"`\n        Note                        string      `json:\"note\" bson:\"note\"`\n    }\n\n    type User struct {\n        Id                         int         `json:\"id\" bson:\"_id,omitempty\"`\n        FirstName                  string      `json:\"first_name,omitempty\" bson:\"first_name,omitempty\"`\n        LastName                   string      `json:\"last_name,omitempty\" bson:\"last_name,omitempty\"`\n        EmailId                    string      `json:\"email_id,omitempty\" bson:\"email_id,omitempty\"`\n        Password                   string      `json:\"password,omitempty\" bson:\"password,omitempty\"`\n        PhoneNumber                string      `json:\"phone_number,omitempty\" bson:\"phone_number,omitempty\"`\n        AltPhoneNumber             string      `json:\"alt_phone_number,omitempty\" bson:\"alt_phone_number,omitempty\"`\n        Status                     int         `json:\"status\" bson:\"status\"`\n        Role                       string      `json:\"role,omitempty\" bson:\"role,omitempty\"`\n    }\n\n</pre>\n\n<p>I am facing problem with join query to get records based on search keywords for which I have written following code.</p>\n\n<pre>\n\n    result := []bson.M{}\n        skip := 0\n        limit := 20\n        c := mongoSession.DB(\"database\").C(\"deactivation_requests\")\n        pipe := c.Pipe([]bson.M{bson.M{\"$match\": bson.M{ \"status\" : 0 }},\n                                bson.M{\"$lookup\": bson.M{\n                                                    \"localField\"    : \"_id\",\n                                                    \"from\"          : \"users\",\n                                                    \"foreignField\"  : \"uid\",\n                                                    \"as\"            : \"profile\"}},\n                                bson.M{\"$unwind\": \"$profile\"},\n                                bson.M{\"$skip\": skip},\n                                bson.M{\"$limit\": limit},})\n        err = pipe.All(&result)\n        if err != nil {\n            return result, err\n        }\n\n</pre>\n\n<p>Expected format for the result is as given below:</p>\n\n<p>What is the best way to do this?</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>&lt;table&gt;\n        &lt;tr&gt;\n            &lt;th&gt;Name&lt;/th&gt;\n            &lt;th&gt;Email&lt;/th&gt;\n            &lt;th&gt;Phone Number&lt;/th&gt;\n            &lt;th&gt;Note&lt;/th&gt;\n        &lt;/tr&gt;\n        &lt;tr&gt;\n            &lt;td&gt;Swati Sharma&lt;/td&gt;\n            &lt;td&gt;swati@swatii.com&lt;/td&gt;\n            &lt;td&gt;987-999-9999&lt;/td&gt;\n            &lt;td&gt;I don't want my acount&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr&gt;\n            &lt;td&gt;James Black&lt;/td&gt;\n            &lt;td&gt;james@jamess.com&lt;/td&gt;\n            &lt;td&gt;999-999-3120&lt;/td&gt;\n            &lt;td&gt;I don't want my acount&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/table&gt;\n</code></pre>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1505881571, "post_id": 46313250, "comment_id": 79588175, "body": "All assignments in Go are copies. The address are the same, because you are taking the address of the same value every time. Experiment with putting some other values in those structs."}, {"owner": {"reputation": 527, "user_id": 3591466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/977d21dd4dde36df3ae73e9bef6ecf49?s=128&d=identicon&r=PG&f=1", "display_name": "user3591466", "link": "https://stackoverflow.com/users/3591466/user3591466"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505881753, "post_id": 46313250, "comment_id": 79588214, "body": "I am trying to print 6 different values, address of <code>top_level</code> , address of <code>top_level. Level1 </code> <code>top_level.Level1.Level_2</code> etc..... Can you explain why they are all the same?"}, {"owner": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "edited": false, "score": 0, "creation_date": 1505882615, "post_id": 46313250, "comment_id": 79588458, "body": "Even though assign := top_level, assign will have its own space in memory different from top_level as it is new assignment. Every reference of same location will return same location."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505883023, "post_id": 46313250, "comment_id": 79588596, "body": "@user3591466: structs have no size other than what they contain, and you only have a single int value in them. What values do you expect to see?"}, {"owner": {"reputation": 527, "user_id": 3591466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/977d21dd4dde36df3ae73e9bef6ecf49?s=128&d=identicon&r=PG&f=1", "display_name": "user3591466", "link": "https://stackoverflow.com/users/3591466/user3591466"}, "reply_to_user": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "edited": false, "score": 0, "creation_date": 1505883083, "post_id": 46313250, "comment_id": 79588618, "body": "@Godfrey it make sense <code>assign</code> has a different address than <code>top_level</code> since now i know that <code>:=</code> will make a new copy of the operand recursively, but it does not make sense to have all the nested struct to have the same address as the parent struct. I must be getting something wrong here."}, {"owner": {"reputation": 527, "user_id": 3591466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/977d21dd4dde36df3ae73e9bef6ecf49?s=128&d=identicon&r=PG&f=1", "display_name": "user3591466", "link": "https://stackoverflow.com/users/3591466/user3591466"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505883363, "post_id": 46313250, "comment_id": 79588719, "body": "@JimB I expected each child struct to have a different address than the parent struct, but it seems like the child struct have the exact same address as the parent address, which confuses me."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505883713, "post_id": 46313250, "comment_id": 79588834, "body": "@user3591466: again, structs themselves have no size, they are are only an abstract concept, so there is no reason for them to take up space in memory: <a href=\"https://play.golang.org/p/JOEY_ygSl4\" rel=\"nofollow noreferrer\">play.golang.org/p/JOEY_ygSl4</a>"}, {"owner": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "edited": false, "score": 0, "creation_date": 1505883939, "post_id": 46313250, "comment_id": 79588910, "body": "@user3591466, i agree with JimB here. A copy of a new address will more likely have previous inherited addresses than new everything or else it will be inefficient.."}, {"owner": {"reputation": 527, "user_id": 3591466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/977d21dd4dde36df3ae73e9bef6ecf49?s=128&d=identicon&r=PG&f=1", "display_name": "user3591466", "link": "https://stackoverflow.com/users/3591466/user3591466"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505884710, "post_id": 46313250, "comment_id": 79589146, "body": "@JimB Sorry, I am very confused. I print out <code>nested_level2</code> <code>nested_level1</code> and <code>top_level</code> and found that they indeed have different address  <a href=\"https://play.golang.org/p/TIL7TGT_9p\" rel=\"nofollow noreferrer\">playground</a> , I also try playing around by adding more element as you suggested and found out that if I add more element, the first field in the struct will always have the same address as its parent <a href=\"https://play.golang.org/p/rA-sx__j7d\" rel=\"nofollow noreferrer\">playground</a> . While the second or third parameter will have a different address. I am still confuse on why the behavior is this way."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1505886037, "post_id": 46313250, "comment_id": 79589646, "body": "@user3591466 &quot;each child struct to have a different address than the parent struct&quot; Go has no notion of &quot;parent&quot; and &quot;child&quot;. What you construct has a very well defined memory layout which you try to see by printing addresses. Forget about &quot;parent&quot; and &quot;child&quot; now. It is not helpful. All you code does is giving fancy names to one word in memory."}, {"owner": {"reputation": 527, "user_id": 3591466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/977d21dd4dde36df3ae73e9bef6ecf49?s=128&d=identicon&r=PG&f=1", "display_name": "user3591466", "link": "https://stackoverflow.com/users/3591466/user3591466"}, "reply_to_user": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "edited": false, "score": 0, "creation_date": 1505886512, "post_id": 46313250, "comment_id": 79589847, "body": "@Godfrey I finally understand what you guys meant, I was under the assumption that golang struct work like object in other language where each nested wrap will request a block of memory containing the inner wrap like a russian doll. But it seems like golang struct is optimize such that there is no wrapper and nested concept, any nested struct only implies that the memory address of the actual content is very close to each other, in another word they are all serialize into a block of memory not like a reference pointing to another block of memory."}], "answers": [{"comments": [{"owner": {"reputation": 527, "user_id": 3591466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/977d21dd4dde36df3ae73e9bef6ecf49?s=128&d=identicon&r=PG&f=1", "display_name": "user3591466", "link": "https://stackoverflow.com/users/3591466/user3591466"}, "edited": false, "score": 0, "creation_date": 1505884926, "post_id": 46313813, "comment_id": 79589223, "body": "Sorry, I am still confused on why do they all have the same address? And why does the same address behavior only exist for the first field of the struct like in <a href=\"https://play.golang.org/p/rA-sx__j7d\" rel=\"nofollow noreferrer\">this playground</a>?"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1505887473, "last_edit_date": 1505887473, "creation_date": 1505884678, "answer_id": 46313813, "question_id": 46313250, "link": "https://stackoverflow.com/questions/46313250/why-does-all-nested-struct-object-have-the-same-address-when-printed-out/46313813#46313813", "title": "Why does all nested struct object have the same address when printed out?", "body": "<p>My guess is that you are looking for something like this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n// Nesting: type T2 struct{ F3 int }\ntype T2 struct{ F3 int }\n\n// Nesting: type T1 struct{ { F2 struct{ F3 int } }\ntype T1 struct{ F2 T2 }\n\n// Nesting: type T0 struct{ F1 struct{ F2 struct{ F3 int } } }\ntype T0 struct{ F1 T1 }\n\nfunc main() {\n    t2 := T2{F3: 42}\n    fmt.Printf(\n        \"%p %p %d\\n\",\n        // 0xc4200120d0 0xc4200120d0 42\n        &amp;t2, &amp;t2.F3, t2.F3,\n    )\n\n    t1 := T1{F2: t2}\n    fmt.Printf(\n        \"%p %p %p %d\\n\",\n        // 0xc4200120f0 0xc4200120f0 0xc4200120f0 42\n        &amp;t1, &amp;t1.F2, &amp;t1.F2.F3, t1.F2.F3,\n    )\n\n    t0 := T0{F1: t1}\n    fmt.Printf(\n        \"%p %p %p %p %d\\n\",\n        // 0xc420012100 0xc420012100 0xc420012100 0xc420012100 42\n        &amp;t0, &amp;t0.F1, &amp;t0.F1.F2, &amp;t0.F1.F2.F3, t0.F1.F2.F3,\n    )\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0xc4200120d0 0xc4200120d0 42\n0xc4200120f0 0xc4200120f0 0xc4200120f0 42\n0xc420012100 0xc420012100 0xc420012100 0xc420012100 42\n</code></pre>\n\n<hr>\n\n<p>For <code>T0</code></p>\n\n<pre><code>type T0 struct{ F1 T1 }\n\ntype T1 struct{ F2 T2 }\n\ntype T2 struct{ F3 int }\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>type T0 struct {\n    F1 struct {\n        F2 struct {\n            F3 int\n        }\n    }\n}\n</code></pre>\n\n<p>and <code>T0</code>, <code>F1</code>, <code>F2</code>, and <code>F3</code> have the same address.</p>\n\n<hr>\n\n<p>In your new example, <code>T0</code></p>\n\n<pre><code>type T2 struct{ F3A, F3B int }\n\ntype T1 struct{ F2 T2 }\n\ntype T0 struct{ F1 T1 }\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>type T0 struct {\n    F1 struct {\n        F2 struct {\n            F3A int\n            F3B int\n        }\n    }\n}\n</code></pre>\n\n<p>and <code>T0</code>, <code>F1</code>, <code>F2</code>, and <code>F3A</code> have the same address. <code>F3A</code> and <code>F3B</code> have different addresses.</p>\n"}, {"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 3, "last_activity_date": 1505896554, "creation_date": 1505896554, "answer_id": 46317154, "question_id": 46313250, "link": "https://stackoverflow.com/questions/46313250/why-does-all-nested-struct-object-have-the-same-address-when-printed-out/46317154#46317154", "title": "Why does all nested struct object have the same address when printed out?", "body": "<p>Types in Go are not autonomes wrappers around other things but just two things: Types allow to attach methods and types provide a layout in memory. For the question here the ability to attach methods to types is irrelevant. Let's take a look a neutral formulation of the question:</p>\n\n<pre><code>type A int64\ntype B { a A }\ntype C { b B }\n</code></pre>\n\n<p>This declares three types with the following memory layout:</p>\n\n<ul>\n<li>Type A has the memory layout of a int64 (that is 8 bytes).</li>\n<li>Type B has the memory layout of a single A, that is a int64, so 8 bytes.</li>\n<li>Type C has the memory layout of a single B, that is a single A, that is a int64, so 8 bytes.</li>\n</ul>\n\n<p>Type B in regard to memory layout is <em>not</em> a \"wrapper\" around A, at least the wrapper adds absolutely nothing. From a purely memory-layout perspective defining type B would be useless (but it allows to attach different methods to B than to A).</p>\n\n<p>Now it should be clear that the address of a <code>c C</code> is that of the first of its 8 bytes and this is the same as c.b's address which is the same than c.b.a. And any assignment to a C is just a copy of one machine word (on 64bit architectures).</p>\n\n<p>If you define <code>type D { a A; b B }</code> it gets more interesting as a D is now 16 bytes long. (Adding more to a D might even leave holes due to padding.) But still does D not provide anything (expect a new method set) to an A and a B adjacent to each other in memory.</p>\n"}], "owner": {"reputation": 527, "user_id": 3591466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/977d21dd4dde36df3ae73e9bef6ecf49?s=128&d=identicon&r=PG&f=1", "display_name": "user3591466", "link": "https://stackoverflow.com/users/3591466/user3591466"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 2, "answer_count": 2, "score": 2, "last_activity_date": 1505896554, "creation_date": 1505881197, "last_edit_date": 1505883300, "question_id": 46313250, "link": "https://stackoverflow.com/questions/46313250/why-does-all-nested-struct-object-have-the-same-address-when-printed-out", "title": "Why does all nested struct object have the same address when printed out?", "body": "<p>I am trying to find out in <code>a := b</code> if <code>a</code> will be a different copy of struct like <code>func pass_by_value(a some_struct)</code></p>\n\n<p>But I find that I don't understand the print statement.</p>\n\n<p>Consider this <a href=\"https://play.golang.org/p/TO0BN1lp3E\" rel=\"nofollow noreferrer\">go playground</a></p>\n\n<pre><code>    nested_level2 := test_assign_nested_level2{}\n    nested_level1 := test_assign_nested{nested_level2}\n    top_level := test_assign{nested_level1}\n\n    assign := top_level\n    fmt.Println(\"top_level address\")\n    fmt.Printf(\"%p\", &amp;top_level)\n    fmt.Println(\" \")\n    fmt.Println(\"1 level address\")\n    fmt.Printf(\"%p\", &amp;top_level.Level1)\n    fmt.Println(\" \")\n    fmt.Println(\"2 level address\")\n    fmt.Printf(\"%p\", &amp;top_level.Level1.Level_2)\n    fmt.Println(\"------------------------\")\n\n    fmt.Println(\"assign top_level address\")\n    fmt.Printf(\"%p\", &amp;assign)\n    fmt.Println(\" \")\n    fmt.Println(\"1 level address\")\n    fmt.Printf(\"%p\", &amp;assign.Level1)\n    fmt.Println(\" \")\n    fmt.Println(\"2 level address\")\n    fmt.Printf(\"%p\", &amp;assign.Level1.Level_2)\n</code></pre>\n\n<p>The output of the above is </p>\n\n<pre><code>top_level address\n0x10410020 \n1 level address\n0x10410020 \n2 level address\n0x10410020 \nassign top_level address\n0x10410024 \n1 level address\n0x10410024 \n2 level address\n0x10410024\n</code></pre>\n\n<p>I expect the output to be similar to </p>\n\n<pre><code>    fmt.Println(\"top_level address\")\n    fmt.Printf(\"%p\", &amp;top_level)\n    fmt.Println(\" \")\n    fmt.Println(\"1 level address\")\n    fmt.Printf(\"%p\", &amp;nested_level1)\n    fmt.Println(\" \")\n    fmt.Println(\"2 level address\")\n    fmt.Printf(\"%p\", &amp;nested_level2)\n    fmt.Println(\" \")\n    fmt.Println(\" ------------------------------- \")\n</code></pre>\n\n<p>where </p>\n\n<pre><code>top_level address\n0x421152280 \n1 level address\n0x421152270 \n2 level address\n0x421152260 \n</code></pre>\n\n<p>each struct have a different address. but it seems like the child struct have the same address as the parent struct.</p>\n\n<p>Why does all the nested element in the struct have the same address?</p>\n\n<p>And does <code>:=</code> actually copy a new <code>struct</code> recursively? Like the print statement indicated? (ie. <code>:=</code> will return a brand new copy of struct with each of its field content also a brand new copy recursively)</p>\n"}, {"tags": ["go", "import"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1505878010, "post_id": 46312734, "comment_id": 79587303, "body": "If you want to use the Go tools you need to follow the conventions. If you want <code>go get</code> to work, then you need to import it with the full name, otherwise put it wherever you want in GOPATH."}], "answers": [{"tags": [], "owner": {"reputation": 1988, "user_id": 6716410, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbA3G.png?s=128&g=1", "display_name": "sf9v", "link": "https://stackoverflow.com/users/6716410/sf9v"}, "is_accepted": false, "score": 0, "last_activity_date": 1505879297, "creation_date": 1505879297, "answer_id": 46312970, "question_id": 46312734, "link": "https://stackoverflow.com/questions/46312734/golang-import-path-best-practice/46312970#46312970", "title": "Golang import path best practice", "body": "<p>We are also developing a project (privately) and we are hosting it on GitLab and I am well aware that <code>go get</code> doesn't work well on private repositories (at least as far as i know).</p>\n\n<p>What we did is we created a folder, lets say <code>$GOPATH/src/theproject</code> and clone all the repositories inside that folder. </p>\n\n<p>So far, it works well for us, but you might also think that it is tedious to do that, and it is, but we don't have any other way to do it. We manually update the code by using <code>git pull</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 361, "user_id": 4528203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-dn99v7mRclc/AAAAAAAAAAI/AAAAAAAAB84/rhfC9jjVsrs/photo.jpg?sz=128", "display_name": "Levin Kwong", "link": "https://stackoverflow.com/users/4528203/levin-kwong"}, "edited": false, "score": 0, "creation_date": 1505888147, "post_id": 46313408, "comment_id": 79590574, "body": "@Topo Thanks! I may need time to digest."}, {"owner": {"reputation": 361, "user_id": 4528203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-dn99v7mRclc/AAAAAAAAAAI/AAAAAAAAB84/rhfC9jjVsrs/photo.jpg?sz=128", "display_name": "Levin Kwong", "link": "https://stackoverflow.com/users/4528203/levin-kwong"}, "edited": false, "score": 0, "creation_date": 1505888384, "post_id": 46313408, "comment_id": 79590674, "body": "@Topo Let say I use <code>github.com&#47;foo&#47;bar</code> at first, and later I changed to <code>foo.com&#47;bar</code>. Also, I use canonical import after the change of repo. What exactly will happen in someone else project that originally has the code <code>import &quot;github.com&#47;foo&#47;bar&quot;</code> ???"}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "edited": false, "score": 1, "creation_date": 1505888978, "post_id": 46313408, "comment_id": 79590986, "body": "If they keep working with the same version of your code than before, then it will keep working because the restriction is on the go command locally. But if they <code>git pull</code> the code to get the version with the new change then they will get this error: <code>can&#39;t load package: package github.com&#47;foo&#47;bar: code in directory $GOPATH&#47;src&#47;github.com&#47;foo&#47;bar expects import &quot;foo.com&#47;bar&quot;</code>. Also if they try to <code>go get</code> the code using the github path it will give them an error. So it&#39;s better to do it sooner rather than later."}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "reply_to_user": {"reputation": 361, "user_id": 4528203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-dn99v7mRclc/AAAAAAAAAAI/AAAAAAAAB84/rhfC9jjVsrs/photo.jpg?sz=128", "display_name": "Levin Kwong", "link": "https://stackoverflow.com/users/4528203/levin-kwong"}, "edited": false, "score": 1, "creation_date": 1505889192, "post_id": 46313408, "comment_id": 79591085, "body": "@LevinKwong Although a quick google search for the error and/or a comment on the project README will probably let them know what the issue is and fix it, so it&#39;s not the worst case, but if you are just starting your project I think you should do it. If it&#39;s an old project people already use, you can let them know in advance, do the vanity import and then at a later date do the canonical import so they have time to fix it."}], "tags": [], "owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "is_accepted": true, "score": 14, "last_activity_date": 1524611180, "last_edit_date": 1524611180, "creation_date": 1505882319, "answer_id": 46313408, "question_id": 46312734, "link": "https://stackoverflow.com/questions/46312734/golang-import-path-best-practice/46313408#46313408", "title": "Golang import path best practice", "body": "<p>The answer to your question:</p>\n\n<blockquote>\n  <p>I don't know what is the proper way to define the import path for local packages.</p>\n</blockquote>\n\n<p>As @JimB said: </p>\n\n<blockquote>\n  <p>If you want to use the Go tools you need to follow the conventions. If you want go get to work, then you need to import it with the full name, otherwise put it wherever you want in GOPATH</p>\n</blockquote>\n\n<p>So you need to use the complete import path <code>github.com/levin/foo</code> if you want <code>go get</code> to work, and you should do it this way if you expect other people to use your package.</p>\n\n<p>The answer to your second question:</p>\n\n<blockquote>\n  <p>Wouldn't it cause much rework if I move my codes to Bitbucket or I host my own git server in AWS? </p>\n</blockquote>\n\n<p>There is a way to use a custom domain name as import path and still host your code wherever you want, it's called a <em>vanity import path</em> I think. You just need to add some meta tags to the html file that gets served in the import file that you use.</p>\n\n<p><a href=\"https://texlution.com/post/golang-canonical-import-paths/\" rel=\"noreferrer\">This</a> article explains how to do it, but in summary, in the file that gets served in your custom domain when the custom import path is accessed, you need to add a <code>go-import</code> meta tag that points to where you hosted the code. The article uses <code>github.com/foo/bar</code> as example of where you are hosting your code and <code>foo.com/bar</code> as your real import path.</p>\n\n<p>So in the file that gets served when accessing <code>foo.com/bar</code> there should be a meta tag like this:</p>\n\n<pre><code>&lt;meta name=\"go-import\" content=\"golang.org/x/tools git http://github.com/foo/bar\"&gt;\n</code></pre>\n\n<p>And you continue to host your code in github. Then if you change the hosting place to your code you just change the value of the meta tag, but all the code that uses the package continue to use the exact same import path <code>\"foo.com/bar</code>.</p>\n\n<p>The only issue with this is that now your project can get imported by 2 different paths: <code>foo.com/bar</code> and <code>github.com/foo/bar</code>. To fix this they have  <a href=\"https://golang.org/doc/go1.4#canonicalimports\" rel=\"noreferrer\">canonical imports</a> which only allow the package to be imported using the custom path and not the github one, it's only adding a comment next to the package name on each package file:</p>\n\n<pre><code>package bar // import \"foo.com/bar\"\n</code></pre>\n\n<p>This is the only way to avoid the issue you have. You can use @srxf answer if you are using a package that is just going to be used locally just know that the go tools are not going to work with that code (like <code>go get</code>). If you want the code to work as it is intended then this is the way to go.</p>\n\n<p>As a comment, I know it feels silly importing <code>github.com/levin/foo</code> for a local package, but if you use that package in another package (say <code>foo2</code>) and someone else imports <code>foo2</code>, this allows the compiler to know exactly where to get the dependencies for <code>foo2</code>, because all the import in the code include the whole route, not the name of a local file. This way people can always get the dependencies they need for your package without having to include those files in your repo, and without having to configure anything for it to work. It's not perfect but it's the way go works, they call it <em>convention over configuration</em> or something like that.</p>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 5049924, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/OojKH.jpg?s=128&g=1", "display_name": "Nicholas Siebenaller", "link": "https://stackoverflow.com/users/5049924/nicholas-siebenaller"}, "is_accepted": false, "score": 1, "last_activity_date": 1571710674, "creation_date": 1571710674, "answer_id": 58496272, "question_id": 46312734, "link": "https://stackoverflow.com/questions/46312734/golang-import-path-best-practice/58496272#58496272", "title": "Golang import path best practice", "body": "<p>This question should probably be re-answered as of Go 1.11 with the introduction of Go Modules. Modules can be used to solve this \"local path\" dilemma as well as pesky projects outside the scope of GOPATH. \nYou may now initialize your project via...</p>\n\n<pre><code>go mod init &lt;main package name&gt;\n</code></pre>\n\n<p>You may then reference a local package by their package name.\nLike this...</p>\n\n<pre><code>go mod init app\n</code></pre>\n\n<p>Then (assuming you have another local package called \"models\") reference within your file</p>\n\n<pre><code>import (\n  \"app/models\"\n)\n</code></pre>\n\n<p>Refs: </p>\n\n<p><a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/Modules</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/52026284/accessing-local-packages-within-a-go-module-go-1-11\">Accessing local packages within a go module (go 1.11)</a></p>\n"}], "owner": {"reputation": 361, "user_id": 4528203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-dn99v7mRclc/AAAAAAAAAAI/AAAAAAAAB84/rhfC9jjVsrs/photo.jpg?sz=128", "display_name": "Levin Kwong", "link": "https://stackoverflow.com/users/4528203/levin-kwong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10486, "favorite_count": 6, "accepted_answer_id": 46313408, "answer_count": 3, "score": 13, "last_activity_date": 1571710674, "creation_date": 1505877746, "last_edit_date": 1505882561, "question_id": 46312734, "link": "https://stackoverflow.com/questions/46312734/golang-import-path-best-practice", "title": "Golang import path best practice", "body": "<p>I am currently working on a private project using Golang (and I am new to it).</p>\n\n<p>But I have the problem that I don't know what is the proper way to define the <code>import path</code> for local packages.</p>\n\n<p>I have the same feeling as the author from this link <a href=\"https://medium.com/@c9s/golang-the-annoying-remote-import-path-c6c7e76517e5\" rel=\"noreferrer\">https://medium.com/@c9s/golang-the-annoying-remote-import-path-c6c7e76517e5</a> </p>\n\n<p>In short, if I host a project <code>foo</code> in Github. I feel strange to use <code>github.com/levin/foo</code> as import path instead of just <code>foo</code>. Wouldn't it cause much rework if I move my codes to Bitbucket or I host my own git server in AWS? <br></p>\n\n<p>And worse, I can rewrite my code to change the import path, but how would people <b>using</b> my code in theirs notify the change of repo? And I feel no sense to ask others to update their codes.</p>\n\n<p>I am new to Golang so feel free to say something like \"your question is not even valid\".</p>\n"}, {"tags": ["html", "go", "web-scraping", "html-parsing"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1505870744, "post_id": 46311740, "comment_id": 79585659, "body": "You can only read the <code>response.Body</code> once. It has already been used up in your <code>GetHtml</code> function. Why are you reading the whole html string, then tossing it anyway?"}, {"owner": {"reputation": 58, "user_id": 8359091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/425fcec432285183cce1f7d7ad46f86d?s=128&d=identicon&r=PG&f=1", "display_name": "King", "link": "https://stackoverflow.com/users/8359091/king"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1505871273, "post_id": 46311740, "comment_id": 79585776, "body": "I&#39;m used to Python so I thought that I had to read the html and return it as a string. This is the first Go program that I&#39;ve written and I&#39;m very new to the language so I&#39;m trying to understand it."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1505871454, "post_id": 46311740, "comment_id": 79585812, "body": "When you come across <code>io.Reader</code>s or <code>io.ReadCloser</code>s, you want to avoid reading it all into a variable if you can. There are optimizations for these types that can make things more efficient if used properly. This is why <code>html.NewTokenizer</code> takes one in the first place. Just some advice. It&#39;s often totally okay to <code>ioutil.ReadAll</code> if you are sure that the response isn&#39;t enormous."}, {"owner": {"reputation": 58, "user_id": 8359091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/425fcec432285183cce1f7d7ad46f86d?s=128&d=identicon&r=PG&f=1", "display_name": "King", "link": "https://stackoverflow.com/users/8359091/king"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1505871684, "post_id": 46311740, "comment_id": 79585865, "body": "Thank you! I&#39;m going to definitely keep your advice in mind moving along to future projects. So io.Reader is more like a buffer?"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1505872261, "post_id": 46311740, "comment_id": 79586017, "body": "Yes. Depending on the underlying source, it could actually be reading from e.g. a network socket, or some other source not actually in memory at the time. Something like <code>html.NewTokenizer</code> can take advantage of this by reading in just enough data to get a full token without having to have the full input in memory. There is a lot of cool stuff going on behind the scenes with go. Read the godocs and feel free to delve into the source (which is linked directly from the docs) when you have learned more, or want to know what is really going on. Go is written in Go :)"}], "answers": [{"comments": [{"owner": {"reputation": 58, "user_id": 8359091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/425fcec432285183cce1f7d7ad46f86d?s=128&d=identicon&r=PG&f=1", "display_name": "King", "link": "https://stackoverflow.com/users/8359091/king"}, "edited": false, "score": 0, "creation_date": 1505871205, "post_id": 46311885, "comment_id": 79585761, "body": "Thank you, this fixed the issue and I wasn&#39;t even aware of the connection leak. I&#39;m very new to Go obviously"}, {"owner": {"reputation": 58, "user_id": 8359091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/425fcec432285183cce1f7d7ad46f86d?s=128&d=identicon&r=PG&f=1", "display_name": "King", "link": "https://stackoverflow.com/users/8359091/king"}, "edited": false, "score": 0, "creation_date": 1505871731, "post_id": 46311885, "comment_id": 79585878, "body": "That&#39;s actually exactly what I did lol. Thank you though, great advice!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1566225741, "last_edit_date": 1566225741, "creation_date": 1505870751, "answer_id": 46311885, "question_id": 46311740, "link": "https://stackoverflow.com/questions/46311740/parsing-html-with-go/46311885#46311885", "title": "Parsing HTML with Go", "body": "<p>The application reads to the end of the body in <code>GetHtml</code>.  The tokenizer returns <code>html.TokenTypeEnd</code> because read on the body returns EOF.</p>\n\n<p>Use this code:</p>\n\n<pre><code>htmlTokens := html.NewTokenizer(strings.NewReader(htmlSrc))\n</code></pre>\n\n<p>to create the tokenizer.</p>\n\n<p>Also, close the response body in<code>GetHtml</code> to prevent a connection leak.</p>\n\n<p>The code can be simplified to:</p>\n\n<pre><code>    response, err := http.Get(\"https://www.coastal.edu/scs/employee\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer response.Body.Close()\n    htmlTokens := html.NewTokenizer(response.Body)\nloop:\n    for {\n        tt := htmlTokens.Next()\n        fmt.Printf(\"%T\", tt)\n        switch tt {\n        case html.ErrorToken:\n            fmt.Println(\"End\")\n            break loop\n        case html.TextToken:\n            fmt.Println(tt)\n        case html.StartTagToken:\n            t := htmlTokens.Token()\n            isAnchor := t.Data == \"a\"\n            if isAnchor {\n                fmt.Println(\"We found an anchor!\")\n            }\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 58, "user_id": 8359091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/425fcec432285183cce1f7d7ad46f86d?s=128&d=identicon&r=PG&f=1", "display_name": "King", "link": "https://stackoverflow.com/users/8359091/king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8268, "favorite_count": 0, "accepted_answer_id": 46311885, "answer_count": 1, "score": 0, "last_activity_date": 1566225741, "creation_date": 1505869444, "last_edit_date": 1515422160, "question_id": 46311740, "link": "https://stackoverflow.com/questions/46311740/parsing-html-with-go", "title": "Parsing HTML with Go", "body": "<p>I'm trying to build a web-scraper using Go, I'm fairly new to the language and I'm not sure what I'm doing wrong while using the html parser. I'm trying to parse the html to find anchor tags but I keep getting html.TokenTypeEnd instead. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"golang.org/x/net/html\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\nfunc GetHtml(url string) (text string, resp *http.Response, err error) {\n    var bytes []byte\n    if url == \"https://www.coastal.edu/scs/employee\" {\n        resp, err = http.Get(url)\n        if err != nil {\n            fmt.Println(\"There seems to ben an error with the Employee Console.\")\n        }\n        bytes, err = ioutil.ReadAll(resp.Body)\n        if err != nil {\n            fmt.Println(\"Cannot read byte response from Employee Console.\")\n        }\n        text = string(bytes)\n    } else {\n        fmt.Println(\"Issue with finding URL. Looking for: \" + url)\n    }\n\n    return text, resp, err\n}\n\nfunc main() {\n    htmlSrc, response, err := GetHtml(\"https://www.coastal.edu/scs/employee\")\n    if err != nil {\n        fmt.Println(\"Cannot read HTML source code.\")\n    }\n    _ = htmlSrc\n    htmlTokens := html.NewTokenizer(response.Body)\n    i := 0\n    for i &lt; 1 {\n\n        tt := htmlTokens.Next()\n        fmt.Printf(\"%T\", tt)\n        switch tt {\n\n        case html.ErrorToken:\n            fmt.Println(\"End\")\n            i++\n\n        case html.TextToken:\n            fmt.Println(tt)\n\n        case html.StartTagToken:\n            t := htmlTokens.Token()\n\n            isAnchor := t.Data == \"a\"\n            if isAnchor {\n                fmt.Println(\"We found an anchor!\")\n            }\n\n        }\n\n    }\n</code></pre>\n\n<p>I'm getting html.TokenTypeEnd whenever I'm printing\n<code>fmt.Printf(\"%T\", tt)</code></p>\n"}, {"tags": ["database", "postgresql", "go"], "answers": [{"tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 2, "last_activity_date": 1505875584, "last_edit_date": 1505875584, "creation_date": 1505875124, "answer_id": 46312378, "question_id": 46311546, "link": "https://stackoverflow.com/questions/46311546/mocking-postgresql-with-a-stored-procedure/46312378#46312378", "title": "Mocking postgresql with a stored procedure", "body": "<p>The sqlmock library works pretty well for this.</p>\n\n<p>But please note that the <code>ExpectExec</code> receives a regular expression in order to match:</p>\n\n<pre><code>// ExpectExec expects Exec() to be called with sql query\n// which match sqlRegexStr given regexp.\n// the *ExpectedExec allows to mock database response\nExpectExec(sqlRegexStr string) *ExpectedExec\n</code></pre>\n\n<p>You are sending that function the exact string you expect to receive without any escaping.</p>\n\n<p>To escape the string, add this:</p>\n\n<pre><code>import (\n   \"regexp\"\n)\n</code></pre>\n\n<p>And then when adding the expectation, escape your string (note the <code>regexp.QuoteMeta</code>):</p>\n\n<pre><code>mock.ExpectExec(regexp.QuoteMeta(`\n    CREATE OR REPLACE FUNCTION val() RETURNS INT AS\n        $$\n        SELECT 1;\n        $$\n    LANGUAGE sql;\n`),\n).WillReturnResult(sqlmock.NewResult(0, 0))\n</code></pre>\n\n<p>That way, the escaped regexp will match your exec command.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1620, "favorite_count": 2, "accepted_answer_id": 46312378, "answer_count": 1, "score": 1, "last_activity_date": 1505879088, "creation_date": 1505867412, "last_edit_date": 1505879088, "question_id": 46311546, "link": "https://stackoverflow.com/questions/46311546/mocking-postgresql-with-a-stored-procedure", "title": "Mocking postgresql with a stored procedure", "body": "<p>I've been going through the test files of <a href=\"https://github.com/DATA-DOG/go-sqlmock\" rel=\"nofollow noreferrer\">https://github.com/DATA-DOG/go-sqlmock</a> to figure out how to create a stored procedure for mocking purposes. I have:</p>\n\n<pre><code>_, err = db.Exec(`\n    CREATE OR REPLACE FUNCTION val() RETURNS INT AS \n        $$ SELECT 1; $$ \n    LANGUAGE sql;   \n`)\n\nif err != nil {\n    t.Fatal(err)\n}\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>all expectations were already fulfilled, call to exec 'CREATE OR REPLACE FUNCTION val() RETURNS INT AS $$ SELECT 1; $$ LANGUAGE sql;' query with args [] was not expected\n</code></pre>\n\n<p>If, instead, I try it with</p>\n\n<pre><code>        mock.ExpectExec(`\n            CREATE OR REPLACE FUNCTION val() RETURNS INT AS\n                $$ SELECT 1; $$\n            LANGUAGE sql;\n        `,\n        ).WillReturnResult(sqlmock.NewResult(0, 0))\n\n        if err := mock.ExpectationsWereMet(); err != nil {\n            t.Fatal(err)\n        }\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>there is a remaining expectation which was not matched: ExpectedExec =&gt; expecting Exec which:\n              - matches sql: 'CREATE OR REPLACE FUNCTION val() RETURNS INT AS $$ SELECT 1; $$ LANGUAGE sql;'\n              - is without arguments\n              - should return Result having:\n                  LastInsertId: 0\n                  RowsAffected: 0\n</code></pre>\n\n<p>I am really confused on how to setup a basic stored procedure.</p>\n"}, {"tags": ["postgresql", "go"], "answers": [{"comments": [{"owner": {"reputation": 543, "user_id": 7491660, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh5.googleusercontent.com/-cGWG7agUpXU/AAAAAAAAAAI/AAAAAAAAA3M/gXMwQQmKhIY/photo.jpg?sz=128", "display_name": "richard_d_sim", "link": "https://stackoverflow.com/users/7491660/richard-d-sim"}, "edited": false, "score": 0, "creation_date": 1505868890, "post_id": 46311343, "comment_id": 79585203, "body": "I&#39;m not too familar with the term interpole and binding, would you mind providing an example?"}, {"owner": {"reputation": 12640, "user_id": 3583500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4ce1d8bc75165d4a798eea02c091e91?s=128&d=identicon&r=PG&f=1", "display_name": "khampson", "link": "https://stackoverflow.com/users/3583500/khampson"}, "reply_to_user": {"reputation": 543, "user_id": 7491660, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh5.googleusercontent.com/-cGWG7agUpXU/AAAAAAAAAAI/AAAAAAAAA3M/gXMwQQmKhIY/photo.jpg?sz=128", "display_name": "richard_d_sim", "link": "https://stackoverflow.com/users/7491660/richard-d-sim"}, "edited": false, "score": 0, "creation_date": 1505869676, "post_id": 46311343, "comment_id": 79585377, "body": "@richard_d_sim: Added to my original answer."}], "tags": [], "owner": {"reputation": 12640, "user_id": 3583500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4ce1d8bc75165d4a798eea02c091e91?s=128&d=identicon&r=PG&f=1", "display_name": "khampson", "link": "https://stackoverflow.com/users/3583500/khampson"}, "is_accepted": true, "score": 4, "last_activity_date": 1505869562, "last_edit_date": 1505869562, "creation_date": 1505865652, "answer_id": 46311343, "question_id": 46311169, "link": "https://stackoverflow.com/questions/46311169/coalesce-is-returning-a-text-type-instead-of-a-time-stamp-type-in-postgres/46311343#46311343", "title": "COALESCE is returning a text type instead of a time_stamp type in Postgres", "body": "<p>You can <strong>cast</strong> the <code>text</code> string to a <code>timestamp</code>, like so:</p>\n\n<pre><code>`SELECT mc.company_name_full, msc.company_id, msc.cdate, %s\n      FROM %s AS mc INNER JOIN %s AS msc\n      ON (mc.id = msc.company_id)\n      WHERE %s AND\n      msc.company_id = COALESCE($1, msc.company_id) AND\n      mc.company_name_full ~* COALESCE($2, mc.company_name_full) AND\n      msc.cdate &gt;= COALESCE($3, '2017-07-01'::timestamp) AND\n      msc.cdate &lt;= COALESCE($4, '%s'::timestamp)`\n</code></pre>\n\n<p><strong>General Caveat:</strong></p>\n\n<p>I'm not too familiar with the syntax of <em>Go</em>, but from what I can tell, <code>%s</code> here is used by <code>Sprintf</code> for direct formatting (interpolation), so having these in your <code>where</code> clause still technically allows <em>SQL Injection</em>.</p>\n\n<p>Anywhere possible (and for some things, like table names, it really isn't, but even in that case you need to be as careful as possible from where the variables that are interpolated come), <em>bindings</em> should be used.</p>\n\n<p>e.g. why can't <code>time.Now().Local().Format(\"2006-01-02\")</code> be passed as a binding and not interpolated?</p>\n\n<p><strong>Update in response to comment from OP:</strong></p>\n\n<p>From the <a href=\"https://godoc.org/github.com/lib/pq\" rel=\"nofollow noreferrer\">Go lib/pq package doc</a>, in the example code:</p>\n\n<pre><code>rows, err := db.Query(`SELECT name FROM users WHERE favorite_fruit = $1\n    OR age BETWEEN $2 AND $2 + 3`, \"orange\", 64)\n</code></pre>\n\n<p>the <code>$1</code> and <code>$2</code> are <em>bindings</em>. That is to say, the library handles escaping them (<em>Go</em>'s <code>pq</code> package is a <em>Go</em> wrapper around the pure <em>Postgres libpq</em> library), and should prevent <em>SQL Injection</em>. They <em>bind</em> (that is, connect to) the arguments that are subsequently passed.</p>\n\n<p>e.g. <code>$1</code> maps to <code>\"orange\"</code> and <code>$2</code> maps to <code>64</code>.</p>\n\n<p>The references to <code>%s</code> in your original queries, in contrast, are directly formatted -- meaning there is no <em>Postgres</em>-based (<em>libpq</em>) escaping, and as such, no protection from <em>SQL Injection</em>. The values are simply passed right on through.</p>\n\n<p>More detail on <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\"><em>Go formatting</em></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": false, "score": 2, "last_activity_date": 1505867141, "creation_date": 1505867141, "answer_id": 46311514, "question_id": 46311169, "link": "https://stackoverflow.com/questions/46311169/coalesce-is-returning-a-text-type-instead-of-a-time-stamp-type-in-postgres/46311514#46311514", "title": "COALESCE is returning a text type instead of a time_stamp type in Postgres", "body": "<p>In addition to @khampson's answer, CAST(expression as type) can convert types. </p>\n\n<p>Also agree on the risk of sql injection; coalesce by itself is not an effective way to prevent it. </p>\n\n<p>Use prepared queries &amp; bind parameters for general parameter substitution. To substitute table name variables, go sql package doesn't yet provide a standard interface (<a href=\"https://github.com/golang/go/issues/18478\" rel=\"nofollow noreferrer\">in progress</a>), so use a database library specific quote function, eg: <a href=\"https://godoc.org/github.com/lib/pq#QuoteIdentifier\" rel=\"nofollow noreferrer\">QuoteIdentifier</a>. See also <a href=\"https://www.postgresql.org/docs/current/static/plpgsql-statements.html#PLPGSQL-QUOTE-LITERAL-EXAMPLE\" rel=\"nofollow noreferrer\">postgres parameter quoting</a> examples.</p>\n"}], "owner": {"reputation": 543, "user_id": 7491660, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh5.googleusercontent.com/-cGWG7agUpXU/AAAAAAAAAAI/AAAAAAAAA3M/gXMwQQmKhIY/photo.jpg?sz=128", "display_name": "richard_d_sim", "link": "https://stackoverflow.com/users/7491660/richard-d-sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 0, "accepted_answer_id": 46311343, "answer_count": 2, "score": 0, "last_activity_date": 1505869562, "creation_date": 1505864062, "question_id": 46311169, "link": "https://stackoverflow.com/questions/46311169/coalesce-is-returning-a-text-type-instead-of-a-time-stamp-type-in-postgres", "title": "COALESCE is returning a text type instead of a time_stamp type in Postgres", "body": "<p>I'm trying to use COALESCE to deal with sql injections in Go.</p>\n\n<pre><code>query := `SELECT mc.company_name_full, msc.company_id, msc.cdate, %s\n          FROM %s AS mc INNER JOIN %s AS msc\n          ON (mc.id = msc.company_id)\n          WHERE %s AND\n          msc.company_id = COALESCE($1, msc.company_id) AND\n          mc.company_name_full ~* COALESCE($2, mc.company_name_full) AND\n          msc.cdate &gt;= '2017-07-01' AND\n          msc.cdate &lt;= '%s'`\nquery = fmt.Sprintf(query, selectParam, companyTable, statsTable, whereParam, time.Now().Local().Format(\"2006-01-02\"))\n</code></pre>\n\n<p>This query works, but when I try to use COALESCE with Time_stamp</p>\n\n<pre><code>query := `SELECT mc.company_name_full, msc.company_id, msc.cdate, %s\n          FROM %s AS mc INNER JOIN %s AS msc\n          ON (mc.id = msc.company_id)\n          WHERE %s AND\n          msc.company_id = COALESCE($1, msc.company_id) AND\n          mc.company_name_full ~* COALESCE($2, mc.company_name_full) AND\n          msc.cdate &gt;= COALESCE($3, '2017-07-01') AND\n          msc.cdate &lt;= COALESCE($4, '%s')`\n</code></pre>\n\n<p>but I get this error</p>\n\n<pre><code>pq:operator does not exist: timestamp without time zone &gt;= text\n</code></pre>\n\n<p>What can I do to ensure that COALESCE returns a timestamp type?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 3, "creation_date": 1505857488, "post_id": 46310113, "comment_id": 79582274, "body": "So how do you perform a <code>PUT</code> request? How making a <code>PUT</code> request would be different from making a <code>DELETE</code> one?"}, {"owner": {"reputation": 1902, "user_id": 2946480, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1410130b0742994273f53d17e0fb9360?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/2946480/micha%c5%82"}, "edited": false, "score": 0, "creation_date": 1505860570, "post_id": 46310113, "comment_id": 79583193, "body": "Just a guess, but if your code is not receiving the <code>DELETE</code> requests you might need to configure CORS (<a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CO&zwnj;&#8203;RS</a>). What CORS does is basically send an <code>OPTIONS</code> request that asks for permission to send a <code>DELETE</code> request. That would happen if you are sending requests from the browser. You can try tools like <code>curl</code> or <code>postman</code> to make sure that an actual <code>DELETE</code> request is being sent. Also, if it turns out to be the problem, you can use a Go framework like Gorilla to properly handle CORS."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 1902, "user_id": 2946480, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1410130b0742994273f53d17e0fb9360?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/2946480/micha%c5%82"}, "edited": false, "score": 0, "creation_date": 1505863869, "post_id": 46310113, "comment_id": 79584080, "body": "@Micha\u0142 CORS is for client-side originated requests only. OP performs http requests from the server side application, hence CORS is not applicable."}, {"owner": {"reputation": 1902, "user_id": 2946480, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1410130b0742994273f53d17e0fb9360?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/2946480/micha%c5%82"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1505863937, "post_id": 46310113, "comment_id": 79584095, "body": "@zerkms My bad, I thought he was serving it"}], "answers": [{"comments": [{"owner": {"reputation": 436, "user_id": 8345637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/teknC.png?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8345637/jonathan"}, "edited": false, "score": 0, "creation_date": 1505870070, "post_id": 46311110, "comment_id": 79585472, "body": "I think this is a generally good answer, but I would recommend (for the sake of helping OP avoid issues down the line) changing just a few things: <a href=\"http://devs.cloudimmunity.com/gotchas-and-common-mistakes-in-go-golang/#anameclose_http_resp_bodyaclosinghttpresponsebody\" rel=\"nofollow noreferrer\">close the response body</a> and <a href=\"http://devs.cloudimmunity.com/gotchas-and-common-mistakes-in-go-golang/#anameclose_http_connaclosinghttpconnections\" rel=\"nofollow noreferrer\">close the connection once the request completes</a>. There are a few cases where you wouldn&#39;t want to do these things in the same func, but I usually need to."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 436, "user_id": 8345637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/teknC.png?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8345637/jonathan"}, "edited": false, "score": 0, "creation_date": 1505876872, "post_id": 46311110, "comment_id": 79587056, "body": "@Jonathan: some of those examples are incorrect, and you should follow the official documentation. Yes, you should always close the response body, but <i>always</i> check the error first and defer it after; the response object is not guaranteed to be valid at all in the case of an error. Also you should generally <i>not</i> close the request."}, {"owner": {"reputation": 436, "user_id": 8345637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/teknC.png?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8345637/jonathan"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505882757, "post_id": 46311110, "comment_id": 79588512, "body": "@JimB: Thanks for the feedback and for your thoughts. Good point about official documentation - I took a closer look at some of the other recommendations on that page and am thinking they were written pre-1.5. Sure, something that old may have some nuggets of helpful info, but not really appropriate to share in this setting when they don&#39;t fall in line with current official docs. Thanks"}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 0, "creation_date": 1505891789, "post_id": 46311110, "comment_id": 79592571, "body": "Thanks for your comments, I updated the answer hope is better now."}, {"owner": {"reputation": 2646, "user_id": 10951752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771de42f31de7fd407adc253c2dc994?s=128&d=identicon&r=PG&f=1", "display_name": "flaxel", "link": "https://stackoverflow.com/users/10951752/flaxel"}, "edited": false, "score": 0, "creation_date": 1556531064, "post_id": 46311110, "comment_id": 98457474, "body": "If you use the method Do(request), it is not necessary that you close the body. <b>The request Body, if non-nil, will be closed by the underlying Transport, even on errors.</b> Comment from the go <a href=\"https://golang.org/pkg/net/http/#Client.Do\" rel=\"nofollow noreferrer\">documentation</a>"}, {"owner": {"reputation": 1351, "user_id": 519951, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/CBIAn.jpg?s=128&g=1", "display_name": "ruhong", "link": "https://stackoverflow.com/users/519951/ruhong"}, "edited": false, "score": 1, "creation_date": 1568782212, "post_id": 46311110, "comment_id": 102378869, "body": "You can also use <code>http.MethodDelete</code> constant instead of the string."}], "tags": [], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "is_accepted": true, "score": 23, "last_activity_date": 1505891710, "last_edit_date": 1505891710, "creation_date": 1505863605, "answer_id": 46311110, "question_id": 46310113, "link": "https://stackoverflow.com/questions/46310113/consume-a-delete-endpoint-from-golang/46311110#46311110", "title": "Consume a DELETE endpoint from golang", "body": "<p>Here is a small example of how to do it:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\nfunc sendRequest() {\n    // Request (DELETE http://www.example.com/bucket/sample)\n\n    // Create client\n    client := &amp;http.Client{}\n\n    // Create request\n    req, err := http.NewRequest(\"DELETE\", \"http://www.example.com/bucket/sample\", nil)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    // Fetch Request\n    resp, err := client.Do(req)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    defer resp.Body.Close()\n\n    // Read Response Body\n    respBody, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    // Display Results\n    fmt.Println(\"response Status : \", resp.Status)\n    fmt.Println(\"response Headers : \", resp.Header)\n    fmt.Println(\"response Body : \", string(respBody))\n}\n</code></pre>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12151, "favorite_count": 2, "accepted_answer_id": 46311110, "answer_count": 1, "score": 13, "last_activity_date": 1543235480, "creation_date": 1505857106, "question_id": 46310113, "link": "https://stackoverflow.com/questions/46310113/consume-a-delete-endpoint-from-golang", "title": "Consume a DELETE endpoint from golang", "body": "<p>I am working in a Golang project, I need to perform some operations over an external API: GET, PUT, POST and DELETE. Currently am using <code>net/http</code> I created a <code>&amp;http.Client{}</code> to make GET and PUT, that is working as expected.</p>\n\n<p>Now I need to perform a DELETE and I cannot find anything about it, is it supported? I need to call basically an url like this:</p>\n\n<pre><code>somedomain.com/theresource/:id\nMethod: DELETE\n</code></pre>\n\n<p>How can I perform that?</p>\n"}, {"tags": ["date", "go", "time"], "comments": [{"owner": {"reputation": 1343, "user_id": 3185502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c65699a0d998330d47145a96b2b54b2?s=128&d=identicon&r=PG&f=1", "display_name": "Vasif", "link": "https://stackoverflow.com/users/3185502/vasif"}, "edited": false, "score": 0, "creation_date": 1505857710, "post_id": 46310040, "comment_id": 79582360, "body": "Sorry i don&#39;t get your format.. what date is <code>31916</code> ? are you trying like march 19 2016?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1505857795, "post_id": 46310040, "comment_id": 79582384, "body": "As a crazy idea: you may have changed format to <code>1 2 06</code> and generate all permutations of <code>31916</code> with spaces. It would be just 16 combinations. Then check each."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1505863240, "last_edit_date": 1505863240, "creation_date": 1505861631, "answer_id": 46310819, "question_id": 46310040, "link": "https://stackoverflow.com/questions/46310040/month-out-of-range-when-parsing-date-without-separators/46310819#46310819", "title": "&quot;month out of range&quot; when parsing date without separators", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc parseDate(date string) (time.Time, error) {\n    if len(date) == 5 {\n        date = \"0\" + date\n    }\n    return time.Parse(\"010206\", date)\n\n}\n\nfunc main() {\n    date, err := parseDate(\"31916\")\n    fmt.Println(date, err)\n    date, err = parseDate(\"031916\")\n    fmt.Println(date, err)\n    date, err = parseDate(\"121916\")\n    fmt.Println(date, err)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2016-03-19 00:00:00 +0000 UTC &lt;nil&gt;\n2016-03-19 00:00:00 +0000 UTC &lt;nil&gt;\n2016-12-19 00:00:00 +0000 UTC &lt;nil&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1902, "user_id": 2946480, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1410130b0742994273f53d17e0fb9360?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/2946480/micha%c5%82"}, "is_accepted": false, "score": 4, "last_activity_date": 1505861710, "creation_date": 1505861710, "answer_id": 46310828, "question_id": 46310040, "link": "https://stackoverflow.com/questions/46310040/month-out-of-range-when-parsing-date-without-separators/46310828#46310828", "title": "&quot;month out of range&quot; when parsing date without separators", "body": "<p>You can't. The layout you pass is not deterministic - there is no way for Go to know when the month ends and the day starts in your string - besides when one option fails and the other one does not (think of <code>\"11106\"</code> - is that <code>1\\11\\06</code> or <code>11\\1\\06</code>?). Your best bet is to write a wrapper which makes the choice deterministic:</p>\n\n<pre><code>import (\n  \"time\"\n  \"strconv\"\n)\n\nfunc parseWeirdLayout(dateString string) (time.Time, error) {\n  parsedString := \"\"\n  if len(dateString) == 5 {\n    month, err := strconv.Atoi(dateString[0:2])\n    if err != nil {\n      return time.Now(), err\n    }\n    if month &lt; 1 || month &gt; 12 {\n      parsedString = \"0\" + dateString \n    } else {\n      parsedString = dateString[:2] + \"0\" + dateString[2:]\n    }\n  } else if len(dateString) == 4 {\n    parsedString = \"0\" + dateString[:1] + \"0\" + dateString[1:]\n  }\n\n  return time.Parse(\"010206\", parsedString)\n}\n</code></pre>\n\n<p>Test here: <a href=\"https://play.golang.org/p/u1QFPzehMj\" rel=\"nofollow noreferrer\">https://play.golang.org/p/u1QFPzehMj</a></p>\n\n<p>Or simply use a different, deterministic layout, e.g. <code>\"010206\"</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 8636958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f81e7b30b2fc480632671a60c5a3f9c?s=128&d=identicon&r=PG&f=1", "display_name": "codcoder", "link": "https://stackoverflow.com/users/8636958/codcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1167, "favorite_count": 1, "accepted_answer_id": 46310819, "answer_count": 2, "score": 2, "last_activity_date": 1505863240, "creation_date": 1505856668, "question_id": 46310040, "link": "https://stackoverflow.com/questions/46310040/month-out-of-range-when-parsing-date-without-separators", "title": "&quot;month out of range&quot; when parsing date without separators", "body": "<p>Any ideas how to get golang to properly parse a date string such as <code>31916</code>\nI keep getting a <strong>month out of range</strong> error.</p>\n\n<pre><code>date, err := time.Parse(\"1206\", \"31916\")\nfmt.Println(date, err)\n</code></pre>\n\n<p>Of course I want to treat the month as 3 and not 31 like it's doing, but I'm not sure how to force it to stop at 3 for the month outside of adding separators to the format.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1505856093, "post_id": 46309810, "comment_id": 79581764, "body": "Try creating the reader once outside the loop instead of on every iteration. <code>ReadString</code> is reading beyond the <code>\\n</code>, but you lose that buffered data because you keep creaeting a new reader."}, {"owner": {"reputation": 1615, "user_id": 3000014, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/862c2edb8707ea662df19224baeb48e0?s=128&d=identicon&r=PG&f=1", "display_name": "bkr879", "link": "https://stackoverflow.com/users/3000014/bkr879"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1505857353, "post_id": 46309810, "comment_id": 79582228, "body": "Thank you. That was indeed the solution."}], "answers": [{"comments": [{"owner": {"reputation": 1615, "user_id": 3000014, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/862c2edb8707ea662df19224baeb48e0?s=128&d=identicon&r=PG&f=1", "display_name": "bkr879", "link": "https://stackoverflow.com/users/3000014/bkr879"}, "edited": false, "score": 0, "creation_date": 1505857320, "post_id": 46310000, "comment_id": 79582211, "body": "Thank you. The name of the NewReader function should have given me a hint as to what it does and why it&#39;s there..."}], "tags": [], "owner": {"reputation": 10078, "user_id": 2709018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/p98Vl.png?s=128&g=1", "display_name": "myaut", "link": "https://stackoverflow.com/users/2709018/myaut"}, "is_accepted": true, "score": 3, "last_activity_date": 1505856428, "creation_date": 1505856428, "answer_id": 46310000, "question_id": 46309810, "link": "https://stackoverflow.com/questions/46309810/does-readstring-discard-bytes-following-newline/46310000#46310000", "title": "Does ReadString() discard bytes following newline?", "body": "<p><code>ReadString()</code> doesn't discard data, it is still <em>buffered</em> in <code>bufio.Reader</code> object, i.e.:</p>\n\n<pre><code>conn := bytes.NewBufferString(\"message1\\n message2\\n message3\\n \")\nreader := bufio.NewReader(conn)\n\nin, _ := reader.ReadString('\\n')                 // \"message1\\n\"\nfmt.Println(strconv.Quote(in))\nin, _ = reader.ReadString('\\n')                  // \"message2\\n\"\nfmt.Println(strconv.Quote(in))\nfmt.Println(strconv.Quote(conn.String()))        // \"\"\n</code></pre>\n\n<p>Note that despite all data was drained from <code>conn</code> buffer, it is still accessible through subsequent <code>reader.ReadString()</code> call. However, you discard your reader object on each iteration, and all data is lost. </p>\n\n<p>You should create buffered readers outside loop, so you'll still have your reader on the second loop:</p>\n\n<pre><code>reader := bufio.NewReader(conn)\nfor {\n    in, err := reader.ReadString('\\n')\n    ...\n</code></pre>\n"}], "owner": {"reputation": 1615, "user_id": 3000014, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/862c2edb8707ea662df19224baeb48e0?s=128&d=identicon&r=PG&f=1", "display_name": "bkr879", "link": "https://stackoverflow.com/users/3000014/bkr879"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 0, "accepted_answer_id": 46310000, "answer_count": 1, "score": 1, "last_activity_date": 1505856428, "creation_date": 1505855486, "question_id": 46309810, "link": "https://stackoverflow.com/questions/46309810/does-readstring-discard-bytes-following-newline", "title": "Does ReadString() discard bytes following newline?", "body": "<p>I am trying to read from a network connection, in the following way:</p>\n\n<pre><code>func getIn(conn net.Conn){\n    for{\n        in, err := bufio.NewReader(conn).ReadString('\\n')\n        if err!=nil{\n            fmt.Printf(err.Error())\n        }\n        fmt.Printf(\"[%s]\", in)\n    }\n}\n</code></pre>\n\n<p>The stream of input being sent to that connection is of the following pattern:</p>\n\n<blockquote>\n  <p>message1\\n message2\\n message3\\n message4\\n message5\\n</p>\n</blockquote>\n\n<p>etc...</p>\n\n<p>I noticed that my function skips messages, outputting, for instance,:</p>\n\n<blockquote>\n  <p>message1\\nmessage2\\nmessage4\\n message5\\n</p>\n</blockquote>\n\n<p>This leads me to think that the bufio ReadString method discards the incoming buffer every time a newline character is encountered. Say the buffer consists of:</p>\n\n<blockquote>\n  <p>message1\\nmess</p>\n</blockquote>\n\n<p>at the moment of reading. Then, <strong><em>message1</em></strong> gets read and the remaining part <strong><em>mess</em></strong> is discarded. This does not entirely make sense either, because then the next input should be <strong><em>age2</em></strong>, but in reality it is <strong><em>message3</em></strong>.</p>\n\n<p>I used a different function, net.Conn.Read(), which indeed does not skip any part of the input, but requires more string parsing on my side. How can I make the ReadString() function work for me?</p>\n"}, {"tags": ["go", "grpc"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 8612140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3b2d33f61f0c03070723fa52000dbd78?s=128&d=identicon&r=PG&f=1", "display_name": "ErlangWannabe", "link": "https://stackoverflow.com/users/8612140/erlangwannabe"}, "edited": false, "score": 0, "creation_date": 1505853406, "post_id": 46309314, "comment_id": 79580613, "body": "&quot;do you mean a new grpc listening TCP port for each service&quot; Yes, I meant having a listener for each device. &quot;a TCP listener doing a reverse proxy back to thousands of other devices&quot; that was my backup plan, but it requires a bit more bookkeeping and synchronization."}, {"owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "reply_to_user": {"reputation": 143, "user_id": 8612140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3b2d33f61f0c03070723fa52000dbd78?s=128&d=identicon&r=PG&f=1", "display_name": "ErlangWannabe", "link": "https://stackoverflow.com/users/8612140/erlangwannabe"}, "edited": false, "score": 0, "creation_date": 1505853818, "post_id": 46309314, "comment_id": 79580808, "body": "in any case, i haven&#39;t seen anything about grpc or Go that indicate bad scalability.  it is really easy to write scalable code in Go, because the libraries don&#39;t make big mistakes like slurping io streams into huge byte arrays, or writing unnecessarily blocking code.  grpc in particular is just an efficient binary encoding for use inside an http2 transport."}, {"owner": {"reputation": 143, "user_id": 8612140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3b2d33f61f0c03070723fa52000dbd78?s=128&d=identicon&r=PG&f=1", "display_name": "ErlangWannabe", "link": "https://stackoverflow.com/users/8612140/erlangwannabe"}, "edited": false, "score": 0, "creation_date": 1505854161, "post_id": 46309314, "comment_id": 79580945, "body": "Cool, thanks for confirming. I guess you are right, having one listener and doing a revers proxy makes more sense."}], "tags": [], "owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "is_accepted": true, "score": 1, "last_activity_date": 1505853086, "creation_date": 1505853086, "answer_id": 46309314, "question_id": 46309202, "link": "https://stackoverflow.com/questions/46309202/golang-grpc-how-scalable-is-it/46309314#46309314", "title": "Golang grpc: how scalable is it?", "body": "<p>do you mean a new grpc listening TCP port for each service?  Go can't fix the scalability of that; huge numbers of TCP listeners has scalability issues at the scope of the operating system.</p>\n\n<p>If you instead mean a TCP listener doing a reverse proxy back to thousands of other devices, then Go is a pretty good fit for that.  What Go does well is cheap \"threads\", because they don't have to allocate full thread stacks.  In Go, spawning a \"goroutine\" costs about 4k, rather than being a 1MB minimum penalty vs a real thread.</p>\n\n<p>grpc is designed to tranpsport over http2 and reuse the socket efficiently, and pack data efficiently.</p>\n"}], "owner": {"reputation": 143, "user_id": 8612140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3b2d33f61f0c03070723fa52000dbd78?s=128&d=identicon&r=PG&f=1", "display_name": "ErlangWannabe", "link": "https://stackoverflow.com/users/8612140/erlangwannabe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 46309314, "answer_count": 1, "score": -2, "last_activity_date": 1505853086, "creation_date": 1505852641, "question_id": 46309202, "link": "https://stackoverflow.com/questions/46309202/golang-grpc-how-scalable-is-it", "title": "Golang grpc: how scalable is it?", "body": "<p>How scalable is GRPC on Go?</p>\n\n<p>Can I run a GRPC server for every IoT device connected to my server app? I.e. have 10-20k of GRPC servers per process?</p>\n"}, {"tags": ["json", "rest", "go", "struct"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1505852056, "post_id": 46308787, "comment_id": 79580002, "body": "Perhaps the body is empty..though it could be the object isn&#39;t being passed correctly by reference... You might want to go ahead and get the body&#39;s bytes and unmarshal into your struct yourself... or test that you can unmarshal the raw bytes yourself."}, {"owner": {"reputation": 443, "user_id": 5948237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/338252eadaab6846d185b8927a05e621?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek Chavda", "link": "https://stackoverflow.com/users/5948237/vivek-chavda"}, "edited": false, "score": 1, "creation_date": 1505852328, "post_id": 46308787, "comment_id": 79580129, "body": "<code>FromJsonTo()</code> returns an error, so you might try printing that out and see if goreq can give you more information about what&#39;s going on"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1505852341, "post_id": 46308787, "comment_id": 79580141, "body": "Also looking at the git example..  <a href=\"https://github.com/franela/goreq/#user-content-receiving-json\" rel=\"nofollow noreferrer\">github.com/franela/goreq/#user-content-receiving-json</a>  They don&#39;t seem to be using json tags in their structs."}, {"owner": {"reputation": 1988, "user_id": 6716410, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbA3G.png?s=128&g=1", "display_name": "sf9v", "link": "https://stackoverflow.com/users/6716410/sf9v"}, "edited": false, "score": 0, "creation_date": 1505877141, "post_id": 46308787, "comment_id": 79587116, "body": "do you strictly needed goreq? if not, then there are other libraries that you might try like gorequest, <a href=\"https://github.com/parnurzeal/gorequest\" rel=\"nofollow noreferrer\">github.com/parnurzeal/gorequest</a>"}], "answers": [{"comments": [{"owner": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "edited": false, "score": 0, "creation_date": 1505889516, "post_id": 46314095, "comment_id": 79591273, "body": "Awesome, that was it!"}], "tags": [], "owner": {"reputation": 2028, "user_id": 711336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b48c9965a4ceb5193259840d3abdf38b?s=128&d=identicon&r=PG", "display_name": "s7anley", "link": "https://stackoverflow.com/users/711336/s7anley"}, "is_accepted": true, "score": 2, "last_activity_date": 1505886205, "creation_date": 1505886205, "answer_id": 46314095, "question_id": 46308787, "link": "https://stackoverflow.com/questions/46308787/how-to-convert-json-to-struct-using-goreq/46314095#46314095", "title": "How to convert json to struct using goreq?", "body": "<p>By calling <code>res.Body.ToString()</code> you read the whole body of the response. Next, when you call <code>res.Body.FromJsonTo()</code>, body is empty and therefore <code>EOF</code> error is returned. Removing <code>ToString()</code> from your code should help.</p>\n"}], "owner": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 46314095, "answer_count": 1, "score": 0, "last_activity_date": 1505886205, "creation_date": 1505850942, "last_edit_date": 1505851925, "question_id": 46308787, "link": "https://stackoverflow.com/questions/46308787/how-to-convert-json-to-struct-using-goreq", "title": "How to convert json to struct using goreq?", "body": "<p>Using Go I'm trying to get some json from a server for which I'm using the <a href=\"https://github.com/franela/goreq/\" rel=\"nofollow noreferrer\">goreq library</a>. When I print out the resulting string as follows:</p>\n\n<pre><code>s, _ := res.Body.ToString()\nfmt.Println(s)\n</code></pre>\n\n<p>I get a correct json string:</p>\n\n<pre><code>{\"success\":true,\"testnet\":false,\"message\":\"\",\"result\":{\"btc\":4014.16,\"edp\":4014.16},\"msIn\":1505820331492,\"msOut\":1505820331492}\n</code></pre>\n\n<p>So using <a href=\"https://transform.now.sh/json-to-go/\" rel=\"nofollow noreferrer\">this json-to-go webservice</a> I converted this json message to a struct:</p>\n\n<pre><code>type Index struct {\n    Success bool   `json:\"success\"`\n    Testnet bool   `json:\"testnet\"`\n    Message string `json:\"message\"`\n    Result  struct {\n        Btc float64 `json:\"btc\"`\n        Edp float64 `json:\"edp\"`\n    } `json:\"result\"`\n    MsIn  int64 `json:\"msIn\"`\n    MsOut int64 `json:\"msOut\"`\n}\n</code></pre>\n\n<p>and I use that as follows (<a href=\"https://github.com/franela/goreq/blob/master/goreq.go#L117-L119\" rel=\"nofollow noreferrer\">implementation of FromJsonTo() here</a>):</p>\n\n<pre><code>var item Index\nres.Body.FromJsonTo(&amp;item)\nfmt.Println(item)\n</code></pre>\n\n<p>This just prints out the nulled Index struct though (while the json str is still the same):</p>\n\n<pre><code>{false false  {0 0} 0 0}\n</code></pre>\n\n<p>Any idea what I might be doing wrong here?</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1505848515, "post_id": 46308129, "comment_id": 79578243, "body": "Have you tried to dereference them? <code>rows, err := a.DB.Query(*query, *qf.companyIDFilter, *qf.companyNameFilter, ...)</code> ?"}, {"owner": {"reputation": 543, "user_id": 7491660, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh5.googleusercontent.com/-cGWG7agUpXU/AAAAAAAAAAI/AAAAAAAAA3M/gXMwQQmKhIY/photo.jpg?sz=128", "display_name": "richard_d_sim", "link": "https://stackoverflow.com/users/7491660/richard-d-sim"}, "reply_to_user": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1505848674, "post_id": 46308129, "comment_id": 79578329, "body": "Their default values are null though...  Could the sql query know that it is null if I pass NULL as a string?"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1505875764, "creation_date": 1505875764, "answer_id": 46312458, "question_id": 46308129, "link": "https://stackoverflow.com/questions/46308129/how-to-use-coalesce-in-go-with-the-database-sql-lib/46312458#46312458", "title": "How to use COALESCE in go with the database/sql lib?", "body": "<p>Remove the quotes from around the placeholders (<code>$1</code>, <code>$2</code>, ...):</p>\n\n<pre><code>query := `SELECT mc.company_name_full, msc.company_id, msc.cdate, msc.value-&gt;&gt;'n_rules', msc.value-&gt;&gt;'pct_interfaces_classified'\n                  FROM mn_company AS mc INNER JOIN mn_statistics_company AS msc\n                      ON (mc.id = msc.company_id)\n                  WHERE (msc.value-&gt;&gt;'n_rules')::int&gt;0 AND (msc.value-&gt;&gt;'pct_interfaces_classified')::int&gt;0  AND\n                      msc.company_id = COALESCE($1, msc.company_id) AND\n                      mc.company_name_full ~* COALESCE($2, mc.company_name_full) AND\n                      msc.cdate &gt;= COALESCE($3, 2017-07-01) AND\n                  msc.cdate &lt;= COALESCE($4, 2017-09-19)`\n</code></pre>\n\n<p>The lib/pq package automatically adds the quotes where needed.</p>\n"}], "owner": {"reputation": 543, "user_id": 7491660, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh5.googleusercontent.com/-cGWG7agUpXU/AAAAAAAAAAI/AAAAAAAAA3M/gXMwQQmKhIY/photo.jpg?sz=128", "display_name": "richard_d_sim", "link": "https://stackoverflow.com/users/7491660/richard-d-sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 46312458, "answer_count": 1, "score": -1, "last_activity_date": 1505875764, "creation_date": 1505848289, "question_id": 46308129, "link": "https://stackoverflow.com/questions/46308129/how-to-use-coalesce-in-go-with-the-database-sql-lib", "title": "How to use COALESCE in go with the database/sql lib?", "body": "<p>I'm trying to pass arguments into a postgres sql statement that are injection safe.</p>\n\n<p>I\u2019m having a bit of trouble with passing in arugements using DB.Query of the database/sql package in Go.</p>\n\n<p>This is what Postgres registers</p>\n\n<pre><code>STATEMENT:  SELECT mc.company_name_full, msc.company_id, msc.cdate, msc.value-&gt;&gt;'n_rules', msc.value-&gt;&gt;'pct_interfaces_classified'\n                  FROM mn_company AS mc INNER JOIN mn_statistics_company AS msc\n                      ON (mc.id = msc.company_id)\n                  WHERE (msc.value-&gt;&gt;'n_rules')::int&gt;0 AND (msc.value-&gt;&gt;'pct_interfaces_classified')::int&gt;0  AND\n                      msc.company_id = COALESCE('$1', msc.company_id) AND\n                      mc.company_name_full ~* COALESCE('$2', mc.company_name_full) AND\n                      msc.cdate &gt;= COALESCE('$3', 2017-07-01) AND\n                  msc.cdate &lt;= COALESCE('$4', 2017-09-19)\n</code></pre>\n\n<p>This is my function call </p>\n\n<pre><code>rows, err := a.DB.Query(*query, qf.companyIDFilter, qf.companyNameFilter, firstDate, secondDate)\n</code></pre>\n\n<p>all arguments that are being pasted into a.DB.Query are pointers.</p>\n\n<p>I\u2019m trying to replaces the $1, $2,\u2026 with arguments</p>\n"}, {"tags": ["javascript", "go", "axios", "preflight"], "comments": [{"owner": {"reputation": 1988, "user_id": 6716410, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbA3G.png?s=128&g=1", "display_name": "sf9v", "link": "https://stackoverflow.com/users/6716410/sf9v"}, "edited": false, "score": 0, "creation_date": 1505878232, "post_id": 46308055, "comment_id": 79587359, "body": "Can you try to add <code>Access-Control-Allow-Origin</code> in your allowed headers? and see if it will work"}], "answers": [{"comments": [{"owner": {"reputation": 1619, "user_id": 2154356, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ffcaa1db1773c9d484f330b774d9699d?s=128&d=identicon&r=PG", "display_name": "jona j&#252;rgen", "link": "https://stackoverflow.com/users/2154356/jona-j%c3%bcrgen"}, "edited": false, "score": 1, "creation_date": 1505906104, "post_id": 46308277, "comment_id": 79601724, "body": "I tried both your suggestions, but it does not work. Preflight is still unsuccessful."}], "tags": [], "owner": {"reputation": 194, "user_id": 6411354, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-exo7_Eom8Ok/AAAAAAAAAAI/AAAAAAAAAMc/JAuBvEh_tbw/photo.jpg?sz=128", "display_name": "Hashemi Rafsan", "link": "https://stackoverflow.com/users/6411354/hashemi-rafsan"}, "is_accepted": false, "score": 0, "last_activity_date": 1505882295, "last_edit_date": 1505882295, "creation_date": 1505848862, "answer_id": 46308277, "question_id": 46308055, "link": "https://stackoverflow.com/questions/46308055/vue-js-axios-post-request-to-golang-server-preflight-error/46308277#46308277", "title": "Vue js axios post request to golang server, Preflight error", "body": "<p>I have solved this type of problem in laravel 5.5 (PHP)</p>\n\n<pre><code>header(\"Access-Control-Allow-Credentials: true\");\nheader(\"Access-Control-Max-Age: 1000\");\nheader(\"Access-Control-Allow-Headers: X-Requested-With, Content-Type, Origin, Cache-Control, Pragma, Authorization, Accept, Accept-Encoding\");\nheader(\"Access-Control-Allow-Methods: PUT, POST, GET, OPTIONS, DELETE\");\n</code></pre>\n\n<p>you can try this type headers on golang</p>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 8411216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/076324715c8779834391def594ffb0a0?s=128&d=identicon&r=PG", "display_name": "ngurajeka", "link": "https://stackoverflow.com/users/8411216/ngurajeka"}, "is_accepted": true, "score": 1, "last_activity_date": 1506000453, "creation_date": 1506000453, "answer_id": 46345239, "question_id": 46308055, "link": "https://stackoverflow.com/questions/46308055/vue-js-axios-post-request-to-golang-server-preflight-error/46345239#46345239", "title": "Vue js axios post request to golang server, Preflight error", "body": "<p>Maybe you can try this, i use this on my web api.</p>\n\n<pre><code>var handler http.Handler\n{\n    handler = handlers.CORS(\n        handlers.AllowedOrigins([]string{\"*\"}),\n        handlers.AllowedMethods([]string{\"GET\", \"PUT\", \"PATCH\", \"POST\", \"DELETE\", \"OPTIONS\"}),\n        handlers.AllowedHeaders([]string{\"Origin\", \"Authorization\", \"Content-Type\"}),\n        handlers.ExposedHeaders([]string{\"\"}),\n        handlers.MaxAge(10),\n        handlers.AllowCredentials(),\n    )(r)\n    handler = handlers.RecoveryHandler(handlers.PrintRecoveryStack(true))(handler)\n}\nhttp.Handle(\"/\", handler)\nhttp.ListenAndServe(\":8080\", nil)\n</code></pre>\n"}], "owner": {"reputation": 1619, "user_id": 2154356, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ffcaa1db1773c9d484f330b774d9699d?s=128&d=identicon&r=PG", "display_name": "jona j&#252;rgen", "link": "https://stackoverflow.com/users/2154356/jona-j%c3%bcrgen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1520, "favorite_count": 0, "accepted_answer_id": 46345239, "answer_count": 2, "score": 0, "last_activity_date": 1506000453, "creation_date": 1505847994, "last_edit_date": 1505882707, "question_id": 46308055, "link": "https://stackoverflow.com/questions/46308055/vue-js-axios-post-request-to-golang-server-preflight-error", "title": "Vue js axios post request to golang server, Preflight error", "body": "<p>I try to send a post api request from a front end website (localhost:8888) to a golang backend (localhost:8000). I get the errors listed below. I looked on stackoverflow and the problems seems to be cross origin request and preflight request handling. I added the headers as shown below but the problem still occurs. I hope you guys can help me :)   </p>\n\n<p>Axios error:</p>\n\n<pre><code>OPTIONS http://localhost:8000/api/heimdall/signup 404 (Not Found)\n\nFailed to load http://localhost:8000/api/heimdall/signup: Response to preflight request doesn't pass access control check: No 'Access-Control-Allow-Origin' header is present on the requested resource. Origin 'http://localhost:8888' is therefore not allowed access. The response had HTTP status code 404.\n</code></pre>\n\n<p>Mux CORS handler</p>\n\n<pre><code>methodsOk := handlers.AllowedMethods([]string{\"GET\", \"HEAD\", \"POST\", \"PUT\", \"OPTIONS\"})\noriginsOk := handlers.AllowedOrigins([]string{\"*\"})\nheadersOk := handlers.AllowedHeaders([]string{\"Accept\", \"Content-Type\", \"Content-Length\", \"Accept-Encoding\", \"X-CSRF-Token\", \"Authorization\"})\n\nlog.Fatal(http.ListenAndServe(\":8000\", handlers.CORS(methodsOk, originsOk, headersOk)(r)))\n</code></pre>\n\n<p>Axois Code:</p>\n\n<pre><code>'use strict';\n\n var axios = require('axios');\n\nfunction Signup(email, password) {\nvar apiURL = 'http://localhost:8000/api/heimdall/signup';\n\nreturn new Promise((resolve, reject) =&gt; {\n    axios.post(apiURL, {\n        email: email,\n        password: password\n    })\n    .then(respone =&gt; {\n        console.log('Promise Signup response:', respone);\n        resolve(respone);\n    }, error =&gt; {\n        console.log('Promise Signup error:', error);\n        reject(error);\n    });\n});\n}\n\nexport {\n   Signup\n};\n</code></pre>\n"}, {"tags": ["macos", "go", "electron", "grpc", "mac-app-store"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1505941152, "post_id": 46307201, "comment_id": 79624087, "body": "looks like you can do grpc over stdin/out : <a href=\"https://stackoverflow.com/questions/37240385/how-do-i-make-a-go-grpc-work-with-standard-io-on-the-server-side\" title=\"how do i make a go grpc work with standard io on the server side\">stackoverflow.com/questions/37240385/&hellip;</a>"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1505941234, "post_id": 46307201, "comment_id": 79624123, "body": "but if you are planning to do grpc from javascript then I did not see that work (yet)"}, {"owner": {"reputation": 191, "user_id": 8225565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/etcEc.jpg?s=128&g=1", "display_name": "bunoi", "link": "https://stackoverflow.com/users/8225565/bunoi"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1505994066, "post_id": 46307201, "comment_id": 79645793, "body": "From what I can see gRPC will work in electron (it works on node <a href=\"https://grpc.io/docs/tutorials/basic/node.html\" rel=\"nofollow noreferrer\">grpc.io/docs/tutorials/basic/node.html</a>).  There is a great simple video here <a href=\"https://www.youtube.com/watch?v=jl2M1SfsoWk\" rel=\"nofollow noreferrer\">youtube.com/watch?v=jl2M1SfsoWk</a>"}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 8225565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/etcEc.jpg?s=128&g=1", "display_name": "bunoi", "link": "https://stackoverflow.com/users/8225565/bunoi"}, "edited": false, "score": 0, "creation_date": 1506098287, "post_id": 46360128, "comment_id": 79698367, "body": "Thank you, I&#39;ve looked into all of this. The UI library that uses electron actually uses TCP under the hood so I may as well keep it simple and use gRPC (bringing me back to my initial question part 2 - which is evolving into &#39;Can I have a node process communicate via TCPIP with my main app?&#39;).  There is an nw.js one that looks like it may work but I find the nw.js documentation is not as good as electrons and it looks like electron is the safer bet for future innovation."}, {"owner": {"reputation": 191, "user_id": 8225565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/etcEc.jpg?s=128&g=1", "display_name": "bunoi", "link": "https://stackoverflow.com/users/8225565/bunoi"}, "edited": false, "score": 0, "creation_date": 1506098582, "post_id": 46360128, "comment_id": 79698492, "body": "I&#39;m struggling to understand how C bindings (cgo) would help me call go from electron?  I can see that go now allows building a C-compatible dynamically-linked library with buildmode=c-shared. That allows any language that can call C dynamic libraries to call go meaning node could call it using node-ffi BUT the go dynamically-linked library functionality looks like it doesn&#39;t work on windows or OS X."}], "tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": 2, "last_activity_date": 1506068682, "creation_date": 1506068682, "answer_id": 46360128, "question_id": 46307201, "link": "https://stackoverflow.com/questions/46307201/can-i-submit-a-go-program-with-a-mac-app-store-app/46360128#46360128", "title": "Can I submit a Go program with a Mac App Store app?", "body": "<p>Yes. There is no reason you cannot submit an app that uses go code - see the ivy calculator on the ios app store (which has even stricter rules than the mac app store):</p>\n\n<p><a href=\"https://itunes.apple.com/us/app/ivy-big-number-calculator/id1012116478?mt=8\" rel=\"nofollow noreferrer\">https://itunes.apple.com/us/app/ivy-big-number-calculator/id1012116478?mt=8</a></p>\n\n<p>So it doesn't have to be a separate binary, you could use cgo for example to call Go code using C bindings. Here is a list of x-platform UI libraries for Go, some of which use electron.  </p>\n\n<p><a href=\"https://github.com/avelino/awesome-go#gui\" rel=\"nofollow noreferrer\">https://github.com/avelino/awesome-go#gui</a></p>\n\n<p>You can also use a separate command line tool within the app that you spawn for specific operations, as long as it doesn't continue running after the app is closed. Many apps on OS X wrap command line tools, so your tool could be in go and then the app just call it. </p>\n\n<p>What you're not allowed to do is change code after submission, or run background processes separate from the app which don't close when it does. </p>\n\n<p>Or you could make the bulk of your app resident on a server (written in go), and have the app(s) query that server for responses - this would let you keep most code in Go while serving various platforms with a thin wrapper on each platform (for example mac os, ios, android) - this might be worth considering if you think it would be viable, as it lets you do the bulk of the work in go, <em>and</em> keep your app updated easily for all platforms without having to go through the gatekeeper of the various app stores. If you're think of an electron app anyway, and the app relies on information from the web, it's a possibility. </p>\n\n<p>It depends very much on the nature of your app and what it does which approach is most suitable, but the approach you outline of bundling a go app should be fine. </p>\n"}], "owner": {"reputation": 191, "user_id": 8225565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/etcEc.jpg?s=128&g=1", "display_name": "bunoi", "link": "https://stackoverflow.com/users/8225565/bunoi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1104, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1506068682, "creation_date": 1505844722, "last_edit_date": 1506004717, "question_id": 46307201, "link": "https://stackoverflow.com/questions/46307201/can-i-submit-a-go-program-with-a-mac-app-store-app", "title": "Can I submit a Go program with a Mac App Store app?", "body": "<p>I'm trying to plan a product I'd like to build and release on the Mac App Store.</p>\n\n<p>I have a lot of functionality in a Go program that I'd like to use from an Electron app, ideally I would like to use gRPC to interface between them.  I'm concerned that this will be rejected by the app review process, can anyone tell me:</p>\n\n<ol>\n<li>Is it allowable to have your main app 'call' a bundled Go program?</li>\n<li>If it is, would I be limited to stdin/stdout (I'm concerned that to use gRPC my Go Program would have to run at startup and that may not be allowed)?</li>\n</ol>\n\n<p>I've tried to establish the answers to the above by reading this <a href=\"https://developer.apple.com/app-store/review/guidelines/\" rel=\"nofollow noreferrer\">https://developer.apple.com/app-store/review/guidelines/</a> but without experience which hopefully some of you have I can't be sure.  I'd like to avoid investing a lot of time building it a way that will be rejected.</p>\n\n<h2>Edit/Update:</h2>\n\n<p>An update - Doing some further research and thinking, I have re-read this part of the App Store review guidelines \"<em>2.4.5 (iii) They may not auto-launch or have other code run automatically at startup or login without consent nor spawn processes that continue to run without consent after a user has quit the app.</em>\".  </p>\n\n<ul>\n<li>Looking at it, the \"other code\" I would run would have consent (as part of the app bundle structure/package) and I would engineer it so that it would shut when the user quits the app.</li>\n</ul>\n\n<p>I also found that <a href=\"https://developer.apple.com/library/content/documentation/CoreFoundation/Conceptual/CFBundles/BundleTypes/BundleTypes.html\" rel=\"nofollow noreferrer\">an applications Xcode bundle structure</a> has this comment about the 'MacOS' directory: <em>\"MacOS\n(Required) Contains the application\u2019s standalone executable code. Typically, this directory contains only one binary file with your application\u2019s main entry point and statically linked code. However, <strong>you may put other standalone executables (such as command-line tools)</strong> in this directory as well.\"</em></p>\n\n<ul>\n<li>So, it looks like my question part 1 is answered but <strong>I am still unclear on part 2 of my question.</strong></li>\n</ul>\n\n<h2>Edit/Update 2:</h2>\n\n<p>In the <a href=\"https://developer.apple.com/library/content/documentation/Miscellaneous/Reference/EntitlementKeyReference/Chapters/EnablingAppSandbox.html#//apple_ref/doc/uid/TP40011195-CH4-SW9\" rel=\"nofollow noreferrer\">app sandboxing entitlement guide</a> I have found this \"<em>To enable your app to connect to a server process running on another machine (<strong>or on the same machine</strong>), enable outgoing network connections.\nTo enable opening a network listening socket so that other computers can connect to your app, allow incoming network connections.</em>\"</p>\n\n<p>This implies I could use TCP/gRPC but isn't definitive... I'll continue to chase a definitive answer!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6705, "user_id": 177317, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c274b26c61d02138249ea516576844d8?s=128&d=identicon&r=PG", "display_name": "George Polevoy", "link": "https://stackoverflow.com/users/177317/george-polevoy"}, "edited": false, "score": 0, "creation_date": 1505844041, "post_id": 46306888, "comment_id": 79575839, "body": "Where is the code which generates this compiler message?"}], "answers": [{"tags": [], "owner": {"reputation": 6705, "user_id": 177317, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c274b26c61d02138249ea516576844d8?s=128&d=identicon&r=PG", "display_name": "George Polevoy", "link": "https://stackoverflow.com/users/177317/george-polevoy"}, "is_accepted": false, "score": 4, "last_activity_date": 1505844659, "last_edit_date": 1505844659, "creation_date": 1505844345, "answer_id": 46307117, "question_id": 46306888, "link": "https://stackoverflow.com/questions/46306888/implementing-interface-in-golang-gives-method-has-pointer-receiver/46307117#46307117", "title": "Implementing interface in golang gives method has pointer receiver", "body": "<p>A pointer receiver requires you to assign pointers of a concrete class to variables of the interface type.</p>\n\n<pre><code>func usage() {\n    var x Person\n\n    // Notice the ampersand '&amp;'\n    x = &amp;Member{}\n\n    x.BasicInfo()\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 187, "user_id": 1268030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eORlM.png?s=128&g=1", "display_name": "Benji L.", "link": "https://stackoverflow.com/users/1268030/benji-l"}, "edited": false, "score": 0, "creation_date": 1612291204, "post_id": 46307148, "comment_id": 116719309, "body": "Just wanna say this is the clearest and simplest explanation of &quot;why&quot; this error occurs generally that I&#39;ve seen."}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 18, "last_activity_date": 1505844479, "creation_date": 1505844479, "answer_id": 46307148, "question_id": 46306888, "link": "https://stackoverflow.com/questions/46306888/implementing-interface-in-golang-gives-method-has-pointer-receiver/46307148#46307148", "title": "Implementing interface in golang gives method has pointer receiver", "body": "<p>If your interface is declared like this:</p>\n\n<pre><code>type Person interface {\n    BasicInfo() MemberBasicInfo\n}\n</code></pre>\n\n<p>Then any type that implements a <code>BasicInfo() MemberBasicInfo</code> will fulfil the interface.</p>\n\n<p>In your case, you then created this method:</p>\n\n<pre><code>func (member *Member) BasicInfo() MemberBasicInfo\n</code></pre>\n\n<p>That means that the type <code>*Member</code> fulfils the interface.</p>\n\n<p>But.. note the <code>*</code> there. <code>Member</code> does not implement the interface, it is <code>*Member</code> who does.</p>\n\n<p>So when trying to assign a type to an interface variable, make sure to use a pointer and not a direct value.</p>\n\n<p>This should work:</p>\n\n<pre><code>var p Person\np = &amp;Member{}\n</code></pre>\n\n<p>But this will not:</p>\n\n<pre><code>var p Person\np = Member{}\n</code></pre>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5065, "favorite_count": 0, "closed_date": 1570832380, "accepted_answer_id": 46307148, "answer_count": 2, "score": 4, "last_activity_date": 1505844659, "creation_date": 1505843515, "question_id": 46306888, "link": "https://stackoverflow.com/questions/46306888/implementing-interface-in-golang-gives-method-has-pointer-receiver", "closed_reason": "Duplicate", "title": "Implementing interface in golang gives method has pointer receiver", "body": "<p>am working in Golang, am trying to use interfaces to agroup a set of structs that are using a similar method. Briefly I have this:</p>\n\n<pre><code>type Person interface {\n    BasicInfo() MemberBasicInfo\n}\n\ntype MemberBasicInfo struct {\n    ID                         uint       \n    MemberFirstName            string     \n    MemberNickname             string     \n    MemberEmail                string    \n}\n</code></pre>\n\n<p>Then, the structs that should work as interfaces:</p>\n\n<pre><code>func (member *Member) BasicInfo() MemberBasicInfo{\n    return MemberBasicInfo{\n        ID: member.ID,\n        ...other mapping here...\n    }\n}\n\nfunc (user *User) BasicInfo() MemberBasicInfo{\n    return MemberBasicInfo{\n        ID: uint(user.ID),\n        ...other mapping here...\n    }\n}\n\ncannot use memberData (type Member) as type Member.Person in return argument: Member does not implement Person (BasicInfo method has pointer receiver)\ncannot use memberData (type User) as type Person in return argument: User does not implement Person (BasicInfo method has pointer receiver)\n</code></pre>\n\n<p>What am I missing? or what am I doing wrong?</p>\n"}, {"tags": ["go", "homebrew", "snappy"], "answers": [{"tags": [], "owner": {"reputation": 842, "user_id": 3450122, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/yR1sJ.jpg?s=128&g=1", "display_name": "del bao", "link": "https://stackoverflow.com/users/3450122/del-bao"}, "is_accepted": false, "score": 0, "last_activity_date": 1512862969, "creation_date": 1512862969, "answer_id": 47734413, "question_id": 46306785, "link": "https://stackoverflow.com/questions/46306785/snappy-version-mismatch-issue/47734413#47734413", "title": "snappy version mismatch issue", "body": "<p>I figured it out. Downgrading to snappy 1.1.4 solve the problem</p>\n"}], "owner": {"reputation": 842, "user_id": 3450122, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/yR1sJ.jpg?s=128&g=1", "display_name": "del bao", "link": "https://stackoverflow.com/users/3450122/del-bao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 252, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512862969, "creation_date": 1505843087, "question_id": 46306785, "link": "https://stackoverflow.com/questions/46306785/snappy-version-mismatch-issue", "title": "snappy version mismatch issue", "body": "<p>I am running some go progam on OSX but got</p>\n\n<pre><code>dyld: Library not loaded: /usr/local/lib/libsnappy.1.dylib\nReferenced from: /private/var/folders/n3/g8c23hd44v6q5f3xll_0hm80000gn/T/__TestS3Download_in_budget_test_go\nReason: Incompatible library version: ___TestS3Download_in_budget_test_go requires version 4.0.0 or later, but libsnappy.1.dylib provides version 1.0.0\"\n</code></pre>\n\n<p>I've already installed snappy via homebrew. </p>\n\n<pre><code>$ brew info snappy\nsnappy: stable 1.1.7 (bottled), \nHEAD Compression/decompression library aiming for high speed  \n/usr/local/Cellar/snappy/1.1.7 (18 files, 115.2KB) \n* Poured from bottle on 2017-09-09 at 20:21:48 From:  ==&gt; Dependencies Build: cmake \u2714, pkg-config \u2714\n</code></pre>\n\n<p>All other packages are fine so it should only be a homebrew snappy issue</p>\n"}, {"tags": ["csv", "go", "encoding", "utf-16"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 4, "last_activity_date": 1505841867, "creation_date": 1505841867, "answer_id": 46306436, "question_id": 46305956, "link": "https://stackoverflow.com/questions/46305956/weird-output-when-parsing-csv-file/46306436#46306436", "title": "weird output when parsing csv file", "body": "<p>As you suspected, the input data must be transformed from a stream of UTF-16 encoded characters to UTF-8 encoded ones. You can do that by using the Go sub-repository package <a href=\"https://godoc.org/golang.org/x/text/encoding/unicode\" rel=\"nofollow noreferrer\"><code>golang.org/x/text/encoding/unicode</code></a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/csv\"\n    \"io\"\n    \"log\"\n    \"net/http\"\n    \"strings\"\n\n    \"golang.org/x/text/encoding/unicode\"\n)\n\nvar url = \"http://storage.googleapis.com/play_public/supported_devices.csv\"\n\nfunc main() {\n\n    resp, err := http.Get(url)\n    if err != nil {\n        return\n    }\n    defer resp.Body.Close()\n\n    dec := unicode.UTF16(unicode.LittleEndian, unicode.UseBOM).NewDecoder()\n    reader := dec.Reader(resp.Body)\n\n    r := csv.NewReader(reader)\n    r.LazyQuotes = true\n    r.FieldsPerRecord = -1\n    // skip header\n    r.Read()\n\n    m := make(map[string]string)\n    for {\n        record, err := r.Read()\n        if err == io.EOF {\n            break\n        }\n        if err != nil {\n            log.Println(err)\n            continue\n        }\n        if len(record) &gt;= 4 {\n            m[strings.TrimSpace(record[3])] = strings.TrimSpace(record[1])\n            for k, v := range m {\n                log.Printf(\"k=%s, v=%s\\n\", k, v)\n            }\n            break\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1087, "favorite_count": 0, "accepted_answer_id": 46306436, "answer_count": 1, "score": 1, "last_activity_date": 1505841867, "creation_date": 1505840212, "question_id": 46305956, "link": "https://stackoverflow.com/questions/46305956/weird-output-when-parsing-csv-file", "title": "weird output when parsing csv file", "body": "<p>I'm parsing a csv file from google api with golang, the file is encoded in utf-16, code below try to read one record(skip header) and print the record, but it gives me the output like this which is weird:</p>\n\n<pre><code>, v=/09/20 00:35:42 k=Smartfren Andromax AD681H\n</code></pre>\n\n<p>I guess it's probably related with utf-16 encoding, but don't know the detail, here is the code:\n    package main</p>\n\n<pre><code>import (\n    \"encoding/csv\"\n    \"io\"\n    \"log\"\n    \"net/http\"\n    \"strings\"\n)\n\nvar url = \"http://storage.googleapis.com/play_public/supported_devices.csv\"\n\nfunc main() {\n\n    resp, err := http.Get(url)\n    if err != nil {\n        return\n    }\n    defer resp.Body.Close()\n\n    r := csv.NewReader(resp.Body)\n    r.LazyQuotes = true\n    r.FieldsPerRecord = -1\n    // skip header\n    r.Read()\n\n    m := make(map[string]string)\n    for {\n        record, err := r.Read()\n        if err == io.EOF {\n            break\n        }\n        if err != nil {\n            log.Println(err)\n            continue\n        }\n        if len(record) &gt;= 4 {\n            m[strings.TrimSpace(record[3])] = strings.TrimSpace(record[1])\n            for k, v := range m {\n                log.Printf(\"k=%s, v=%s\\n\", k, v)\n            }\n            break\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 12, "last_activity_date": 1505840437, "last_edit_date": 1505840437, "creation_date": 1505839917, "answer_id": 46305869, "question_id": 46305812, "link": "https://stackoverflow.com/questions/46305812/concatenate-2-slices-in-golang/46305869#46305869", "title": "Concatenate 2 slices in golang", "body": "<p>This is what the builtin <a href=\"https://golang.org/pkg/builtin/#append\" rel=\"noreferrer\"><code>append()</code></a> function is for: to append values (which may be values of a slice) to the end of another. And the result is the concatenation.</p>\n\n<p>If you want <code>s3</code> to be \"independent\" of <code>s1</code> and <code>s2</code>, then append <code>s1</code> to an empty or <code>nil</code> slice, then append <code>s2</code> to the result:</p>\n\n<pre><code>s3 := append(append([]int{}, s1...), s2...)\nfmt.Println(s3)\n</code></pre>\n\n<p>If <code>s3</code> may use / overlap <code>s1</code>, you can simply append <code>s2</code> to <code>s1</code>:</p>\n\n<pre><code>s4 := append(s1, s2...)\nfmt.Println(s4)\n</code></pre>\n\n<p>Output in both cases (try it on the <a href=\"https://play.golang.org/p/IraYWETFl-\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[1 2 3 4 5 3 4 5 6 7]\n</code></pre>\n\n<p>Note: What this \"overlapping\" means is that if you append values to <code>s1</code>, if it has enough capacity, no new slice will be allocated, <code>s1</code> will be resliced to have enough length to accommodate the elements you want to append to it. This may have surprising side-effects if used unwisely, like in this example:</p>\n\n<pre><code>arr := [...]int{1, 2, 3, 4, 5, 6, 7, 0, 0, 0}\n\ns1 := arr[:5]\ns2 := arr[2:7]\nfmt.Println(\"s1:\", s1, \"cap:\", cap(s1))\nfmt.Println(\"s2:\", s2)\n\ns3 := append(s1, s2...)\nfmt.Println(\"s3:\", s3)\n\nfmt.Println(\"s2:\", s2)\n</code></pre>\n\n<p>Output is (try it on the <a href=\"https://play.golang.org/p/cKLTBZRcT2\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>s1: [1 2 3 4 5] cap: 10\ns2: [3 4 5 6 7]\ns3: [1 2 3 4 5 3 4 5 6 7]\ns2: [3 4 5 3 4]\n</code></pre>\n\n<p>What may be surprising here is that when we appended <code>s2</code> to <code>s1</code> and stored the result in <code>s3</code> (which is what we expected), contents (elements) of <code>s2</code> also changed. The reason for this is that <code>append()</code> saw that <code>s1</code> has enough capacity to append <code>s2</code> to it (elements of <code>s2</code>), so it did not create a new array, it just resliced <code>s1</code> and added elements \"in-place\". But the area where the additional elements were written is the exact same memory where elements of <code>s2</code> reside, so elements of <code>s2</code> also got overwritten.</p>\n"}, {"comments": [{"owner": {"reputation": 1842, "user_id": 2254802, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d32c3e8c2bd04797670b2b51e50c902e?s=128&d=identicon&r=PG&f=1", "display_name": "impossible", "link": "https://stackoverflow.com/users/2254802/impossible"}, "edited": false, "score": 0, "creation_date": 1505840774, "post_id": 46305979, "comment_id": 79574223, "body": "Sure. It is helpful. :)"}], "tags": [], "owner": {"reputation": 1944, "user_id": 4120554, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh5.googleusercontent.com/-RKmmNTC8iUo/AAAAAAAAAAI/AAAAAAAAAGs/oQQp9tU-Zb4/photo.jpg?sz=128", "display_name": "Marco Talento", "link": "https://stackoverflow.com/users/4120554/marco-talento"}, "is_accepted": false, "score": 4, "last_activity_date": 1505840272, "creation_date": 1505840272, "answer_id": 46305979, "question_id": 46305812, "link": "https://stackoverflow.com/questions/46305812/concatenate-2-slices-in-golang/46305979#46305979", "title": "Concatenate 2 slices in golang", "body": "<p>I would recommend you to give a look at this page: <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/SliceTricks</a></p>\n\n<p>It's an official documentation by golang for slices. For your problem you just need to use <code>append</code> :)</p>\n"}], "owner": {"reputation": 1842, "user_id": 2254802, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d32c3e8c2bd04797670b2b51e50c902e?s=128&d=identicon&r=PG&f=1", "display_name": "impossible", "link": "https://stackoverflow.com/users/2254802/impossible"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7460, "favorite_count": 0, "accepted_answer_id": 46305869, "answer_count": 2, "score": 3, "last_activity_date": 1505840437, "creation_date": 1505839678, "last_edit_date": 1505840290, "question_id": 46305812, "link": "https://stackoverflow.com/questions/46305812/concatenate-2-slices-in-golang", "title": "Concatenate 2 slices in golang", "body": "<p>I have 2 slices, </p>\n\n<pre><code>s1 := []int{1, 2, 3, 4, 5}\ns2 := []int{3, 4, 5, 6, 7}\n</code></pre>\n\n<p>I want the resultant </p>\n\n<pre><code>s3 = []int{1, 2, 3, 4, 5, 3, 4, 5, 6, 7}\n</code></pre>\n\n<p>I am doing something like:</p>\n\n<pre><code>for _, x := range s1 {\n        s2 = append(s2, x)\n    }\n</code></pre>\n\n<p>This looks very trivial question but trust me I don't find a one line solution to this. \nHow can we go about this?</p>\n"}, {"tags": ["go", "quickfix", "quickfixgo"], "answers": [{"tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": true, "score": 1, "last_activity_date": 1505908389, "creation_date": 1505908389, "answer_id": 46321336, "question_id": 46305687, "link": "https://stackoverflow.com/questions/46305687/read-md-groups-in-quickfixgo/46321336#46321336", "title": "Read MD groups in QuickFixGo", "body": "<p>Most likely you should be using one of the pre-defined implementation. Such as <a href=\"https://godoc.org/github.com/quickfixgo/quickfix/fix44/massquote#NoPartyIDsRepeatingGroup\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/quickfixgo/quickfix/fix44/massquote#NoPartyIDsRepeatingGroup</a></p>\n\n<p>If you want to implement a non-standard group you can follow e.g. <a href=\"https://github.com/quickfixgo/quickfix/blob/102166066b60662e45cc963e405d281cd3e20101/fix44/massquote/MassQuote.generated.go#L3895\" rel=\"nofollow noreferrer\">https://github.com/quickfixgo/quickfix/blob/102166066b60662e45cc963e405d281cd3e20101/fix44/massquote/MassQuote.generated.go#L3895</a></p>\n"}], "owner": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 46321336, "answer_count": 1, "score": 0, "last_activity_date": 1505908389, "creation_date": 1505839204, "last_edit_date": 1505840088, "question_id": 46305687, "link": "https://stackoverflow.com/questions/46305687/read-md-groups-in-quickfixgo", "title": "Read MD groups in QuickFixGo", "body": "<p>How can I use the function:</p>\n\n<p><a href=\"https://github.com/quickfixgo/quickfix/blob/master/field_map.go#L150\" rel=\"nofollow noreferrer\">https://github.com/quickfixgo/quickfix/blob/master/field_map.go#L150</a></p>\n\n<p>Has anybody got an example code snippet showing how to implement the <code>FieldGroupReader</code> interface?</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["networking", "go", "network-programming", "multicast"], "answers": [{"tags": [], "owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "is_accepted": true, "score": 9, "last_activity_date": 1505833393, "creation_date": 1505833393, "answer_id": 46303850, "question_id": 46303587, "link": "https://stackoverflow.com/questions/46303587/how-to-use-golang-to-implement-multicast-over-internet/46303850#46303850", "title": "How to use golang to implement multicast over Internet?", "body": "<p>Multicast routing is <em>very</em> different from unicast routing. Multicast is a form of broadcast, and it normally doesn't cross routers. You can enable multicast routing, but it must be enabled (using the same multicast routing type) on all the routers in a path, and that simply cannot happen on the public Internet. The public Internet would collapse from dense mode multicast, and no ISPs are going to dedicate resources to sparse mode.</p>\n\n<p>I'm not sure why you think VoIP uses multicast (it doesn't).</p>\n\n<p>If you want to multicast from one site to another site across the public Internet, then you must use a tunnel that supports multicast, e.g. GRE. This will wrap your multicast packets inside unicast packets to cross the public Internet. You must still configure the routers on each side to support multicast routing.</p>\n"}], "owner": {"reputation": 33, "user_id": 8253105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f359628961620bc71aa82bff437351ac?s=128&d=identicon&r=PG&f=1", "display_name": "kangsouth", "link": "https://stackoverflow.com/users/8253105/kangsouth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1511, "favorite_count": 0, "accepted_answer_id": 46303850, "answer_count": 1, "score": 1, "last_activity_date": 1505833393, "creation_date": 1505832654, "question_id": 46303587, "link": "https://stackoverflow.com/questions/46303587/how-to-use-golang-to-implement-multicast-over-internet", "title": "How to use golang to implement multicast over Internet?", "body": "<p>I'm a new person in golang programming and multicast programming.I saw a program about golang multicast in <a href=\"https://gist.github.com/fiorix/9664255\" rel=\"nofollow noreferrer\">https://gist.github.com/fiorix/9664255</a>.</p>\n\n<pre><code>import (\n    \"encoding/hex\"\n    \"log\"\n    \"net\"\n    \"time\"\n)\n\nconst (\n    srvAddr         = \"224.0.0.1:9999\"\n    maxDatagramSize = 8192\n)\n\n//send multicast data\nfunc ping(a string) {\n    addr, err := net.ResolveUDPAddr(\"udp\", a)\n    if err != nil {\n        log.Fatal(err)\n    }\n    c, err := net.DialUDP(\"udp\", nil, addr)\n    for {\n        c.Write([]byte(\"hello, world\\n\"))\n        time.Sleep(1 * time.Second)\n    }\n}\n\n//print received data\nfunc msgHandler(src *net.UDPAddr, n int, b []byte) {\n    log.Println(n, \"bytes read from\", src)\n    log.Println(hex.Dump(b[:n]))\n}\n\n//join multicast group and receive multicast data\nfunc serveMulticastUDP(a string, h func(*net.UDPAddr, int, []byte)) {\n    addr, err := net.ResolveUDPAddr(\"udp\", a)\n    if err != nil {\n        log.Fatal(err)\n    }\n    l, err := net.ListenMulticastUDP(\"udp\", nil, addr)\n    l.SetReadBuffer(maxDatagramSize)\n    for {\n        b := make([]byte, maxDatagramSize)\n        n, src, err := l.ReadFromUDP(b)\n        if err != nil {\n            log.Fatal(\"ReadFromUDP failed:\", err)\n        }\n        h(src, n, b)\n    }\n}\n</code></pre>\n\n<p>I ran the code on several computers in a University lab LAN.One computer ran function ping to send multicast packets and others ran function serveMulticastUDP to receive the Multicast packets.It seccessed.\nBut when I ran function ping on one computer and ran function serveMulticastUDP on an other computer in the Internet(two computers are not in a LAN),it could not receive the data.The receiver has a NAT and did not have a public IP address.</p>\n\n<p>I saw some people's answer that Internet don't support multicast.But as I know that VOIP is an example of multicast technology,we can implement multicast in the Internet.</p>\n\n<p>So what's the reason that the receiver couldn't receive packets?What should I do to modify the code to implement multicast over Internet?</p>\n"}, {"tags": ["dictionary", "go", "idioms", "type-assertion"], "answers": [{"comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 3, "creation_date": 1505826732, "post_id": 46300383, "comment_id": 79565150, "body": "&quot;You cannot combine map lookup and type assertion like this.&quot; - Obviously you can if this code compiles. ... &quot;Your code is incapable to determine whether &quot;key&quot; is in the map or not.&quot; - The OP never stated wanting to determine that."}, {"owner": {"reputation": 378, "user_id": 1111580, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d85573698b9b2bc3f3e0c33f54cef73?s=128&d=identicon&r=PG", "display_name": "pythonator", "link": "https://stackoverflow.com/users/1111580/pythonator"}, "edited": false, "score": 0, "creation_date": 1505827127, "post_id": 46300383, "comment_id": 79565467, "body": "Perhaps I should&#39;ve stated that more clear (I assumed it was obvious by the messages I print); I can not distinguish between missing key and wrong value type using this &quot;shortcut&quot;."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1505827703, "post_id": 46300383, "comment_id": 79565946, "body": "Exactly you cannot. Which makes your code unclear. This is wrong. You do a plain simple comm-okay type assertion, and map-lookup has nothing to do with this. It&#39;s like being astonished that (2*3)+4 is multiply-and-add in one step. No it&#39;s not. It&#39;s plain multiply and plain add. With one difference: It&#39;s clear."}, {"owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "edited": false, "score": 4, "creation_date": 1505829032, "post_id": 46300383, "comment_id": 79566943, "body": "@Volker it clearly <b>isn&#39;t wrong</b>. It is both correct and behaves as expected by the OP. It might instead be unclear for readers but neither wrong nor bad. See icza&#39;s answer."}, {"owner": {"reputation": 378, "user_id": 1111580, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d85573698b9b2bc3f3e0c33f54cef73?s=128&d=identicon&r=PG", "display_name": "pythonator", "link": "https://stackoverflow.com/users/1111580/pythonator"}, "edited": false, "score": 0, "creation_date": 1505832730, "post_id": 46300383, "comment_id": 79569518, "body": "I&#39;ll easily concede that this is somewhat unclear. I never said it was the preferred way to do it. It&#39;s ok (at least in my specific case) that the code only acts on the case where the key exists and the value is of the correct type, and nothing else. That is, its behavior is the same for non-existance and incorrect type. If the desire is to weed out all existing-but-bad-data cases, then yes, this will not cut it."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": -3, "last_activity_date": 1505823816, "creation_date": 1505823816, "answer_id": 46300383, "question_id": 46300164, "link": "https://stackoverflow.com/questions/46300164/is-it-bad-form-to-perform-map-lookup-and-type-assertion-in-one-statement/46300383#46300383", "title": "Is it &quot;bad form&quot; to perform map lookup and type assertion in one statement?", "body": "<blockquote>\n  <p>Is this considered bad?</p>\n</blockquote>\n\n<p>No, this is plain wrong. You <strong>cannot</strong> combine map lookup and type assertion like this.</p>\n\n<p>What you code does is:</p>\n\n<ol>\n<li><p>It looks up \"key\" in the map <em>unconditional</em>. If \"key\" is not in the map it will yield nil (as this is the zero value of interface{}).</p></li>\n<li><p>The value retrieved from the map (possible nil if not in the map is type asserted to a string.</p></li>\n</ol>\n\n<p>Your code is incapable to determine whether \"key\" is in the map or not.</p>\n"}, {"comments": [{"owner": {"reputation": 378, "user_id": 1111580, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d85573698b9b2bc3f3e0c33f54cef73?s=128&d=identicon&r=PG", "display_name": "pythonator", "link": "https://stackoverflow.com/users/1111580/pythonator"}, "edited": false, "score": 0, "creation_date": 1505827236, "post_id": 46300976, "comment_id": 79565558, "body": "Yeah, I did a small test in the playground to test all combinations and it does indeed work (i.e. not panic). I was mostly curious whether this was an unsupported quirk or something actually intended."}, {"owner": {"reputation": 843, "user_id": 1816774, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6bee690bd3d6a8f900f7a8667f3211ce?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/1816774/tim"}, "edited": false, "score": 0, "creation_date": 1559594984, "post_id": 46300976, "comment_id": 99463059, "body": "I was wondering the same, it works but the language spec doesn&#39;t say anything about it. I forgot the fact the map lookup returns <code>nil</code> if there was noting added with that key..."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 843, "user_id": 1816774, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6bee690bd3d6a8f900f7a8667f3211ce?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/1816774/tim"}, "edited": false, "score": 0, "creation_date": 1559633655, "post_id": 46300976, "comment_id": 99472169, "body": "@Tim Map indexing returns the zero value of the map&#39;s value type, which is <code>nil</code> for <code>interface{}</code>, but for example it&#39;s <code>0</code> for <code>int</code>. E.g. <code>map[string]int{}[&quot;a&quot;]</code> will result in <code>0</code>, not <code>nil</code>."}, {"owner": {"reputation": 843, "user_id": 1816774, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6bee690bd3d6a8f900f7a8667f3211ce?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/1816774/tim"}, "edited": false, "score": 0, "creation_date": 1559650182, "post_id": 46300976, "comment_id": 99480629, "body": "Yes, I implicitly meant <code>map[string]interface{}</code>. It wouldn&#39;t be possible to do type assertion if it wouldn&#39;t ;). Thanks tho."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 13, "last_activity_date": 1559633512, "last_edit_date": 1559633512, "creation_date": 1505825487, "answer_id": 46300976, "question_id": 46300164, "link": "https://stackoverflow.com/questions/46300164/is-it-bad-form-to-perform-map-lookup-and-type-assertion-in-one-statement/46300976#46300976", "title": "Is it &quot;bad form&quot; to perform map lookup and type assertion in one statement?", "body": "<p>What you do actually works, because you use the special comma-ok idiom of the <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a> which does not panic if the assertion does not hold, and because maps can be indexed with keys which are not in it (which will result in the zero value of the value type of the map).</p>\n\n<p>It's true that with this you can't tell if the key is in the map or not, or it is but its value is <code>nil</code>, but you already suspected this as if the assertion does not hold, you print <em>\"value does not exist or is not a string\"</em>.</p>\n\n<p>To test all \"corner\" cases, see this example:</p>\n\n<pre><code>m := map[string]interface{}{\n    \"key\":  \"the value\",\n    \"key2\": 2,\n    \"key3\": nil,\n    // \"key4\":\"\", // Uncommented on purpose\n}\n\nfor _, k := range []string{\"key\", \"key2\", \"key3\", \"key4\"} {\n    if value, ok := m[k].(string); ok {\n        fmt.Printf(\"[key: %s] value exists and is a string: %s\\n\", k, value)\n    } else {\n        fmt.Printf(\"[key: %s] value does not exist or is not a string: %s\\n\",\n            k, value)\n    }\n}\n</code></pre>\n\n<p>Output (try it on the Go Playground):</p>\n\n<pre><code>[key: key] value exists and is a string: the value\n[key: key2] value does not exist or is not a string: \n[key: key3] value does not exist or is not a string: \n[key: key4] value does not exist or is not a string: \n</code></pre>\n\n<p>So basically you <em>can</em> use this, nothing bad will happen from it (e.g. panic or memory leak), just know its limits (e.g. you couldn't get the value associated for <code>\"key2\"</code> as it's not of <code>string</code> type).</p>\n\n<p>If your intention is to get the value for a key if it exists and is of type <code>string</code>, then this is what your code exactly does. Although you should avoid data structures and constructs where you need this, as it's harder to understand and maintain in larger projects.</p>\n\n<p>What I mean by this is for example if at some point in your code you expect the key <code>\"somekey\"</code> to have a <code>string</code> value associated and it does not, you won't immediately know why it is so; is it because the map does not contain that key, or is it because it does but with a value of wrong type (or the value may even be <code>nil</code>)? Further testing / debugging is needed to track down the root cause.</p>\n"}], "owner": {"reputation": 378, "user_id": 1111580, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d85573698b9b2bc3f3e0c33f54cef73?s=128&d=identicon&r=PG", "display_name": "pythonator", "link": "https://stackoverflow.com/users/1111580/pythonator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "accepted_answer_id": 46300976, "answer_count": 2, "score": 9, "last_activity_date": 1559633512, "creation_date": 1505823149, "last_edit_date": 1505827602, "question_id": 46300164, "link": "https://stackoverflow.com/questions/46300164/is-it-bad-form-to-perform-map-lookup-and-type-assertion-in-one-statement", "title": "Is it &quot;bad form&quot; to perform map lookup and type assertion in one statement?", "body": "<p>I just realized that it's possible to do a map lookup and a type/interface-assertion in one statement.</p>\n\n<pre><code>m := map[string]interface{}{\n    \"key\": \"the value\",\n}\nif value, ok := m[\"key\"].(string); ok {\n    fmt.Printf(\"value exists and is a string: %s\\n\", value)\n} else {\n    fmt.Println(\"value does not exist or is not a string\")\n}\n</code></pre>\n\n<p>Is this considered bad?\nI've not seen any official documentation commenting this.</p>\n\n<p>edit: I know this code can not distinguish between \"key doesn't exist\" and \"value is of incorrect type\".</p>\n\n<p>edit2: ahem, the print in the else-clause was incorrect :(</p>\n"}, {"tags": ["http", "go", "http-headers"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1505819736, "post_id": 46298064, "comment_id": 79560133, "body": "Can you describe the problem in more detail (and less code)?"}, {"owner": {"reputation": 183, "user_id": 4903596, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-l1la9rNAGIU/AAAAAAAAAAI/AAAAAAAAACk/m-VUMTDlbu0/photo.jpg?sz=128", "display_name": "vijay", "link": "https://stackoverflow.com/users/4903596/vijay"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1505909231, "post_id": 46298064, "comment_id": 79603880, "body": "@Volker basically i want to send response headers and reponse cookies in next http request"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1505909695, "post_id": 46298064, "comment_id": 79604241, "body": "Well, net/http provides access to both, the response header and the response cookies, so you can use them them in the next request: The request also has a header. I have to admit I still do not understand the problem. Why not just write the whole response header to the next request? (That would handle cookies as well). Can you describe the problems with cookies a bit more in depth?"}, {"owner": {"reputation": 183, "user_id": 4903596, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-l1la9rNAGIU/AAAAAAAAAAI/AAAAAAAAACk/m-VUMTDlbu0/photo.jpg?sz=128", "display_name": "vijay", "link": "https://stackoverflow.com/users/4903596/vijay"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1505911584, "post_id": 46298064, "comment_id": 79605626, "body": "@Volker, okay so problem here is first request is an authentication request which returns headers and cookies for further requests. next requests will be processed only if it contains the cookies and headers returned in first/auth request.... am i clear"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1505912008, "post_id": 46298064, "comment_id": 79605923, "body": "Then just save the headers/cookies for further use and add them to the subsequent requests. I still cannot see a fundamental problem, just some programming needed."}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 4903596, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-l1la9rNAGIU/AAAAAAAAAAI/AAAAAAAAACk/m-VUMTDlbu0/photo.jpg?sz=128", "display_name": "vijay", "link": "https://stackoverflow.com/users/4903596/vijay"}, "edited": false, "score": 0, "creation_date": 1505909191, "post_id": 46304431, "comment_id": 79603863, "body": "and if i send back reponse cookies in next request?"}, {"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "reply_to_user": {"reputation": 183, "user_id": 4903596, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-l1la9rNAGIU/AAAAAAAAAAI/AAAAAAAAACk/m-VUMTDlbu0/photo.jpg?sz=128", "display_name": "vijay", "link": "https://stackoverflow.com/users/4903596/vijay"}, "edited": false, "score": 0, "creation_date": 1505998020, "post_id": 46304431, "comment_id": 79648554, "body": "Cookies are just headers, you can include them or omit them, what exactly is the problem you&#39;re seeing?"}], "tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 8, "last_activity_date": 1505835193, "creation_date": 1505835193, "answer_id": 46304431, "question_id": 46298064, "link": "https://stackoverflow.com/questions/46298064/get-all-the-headers-of-http-response-and-send-it-back-in-next-http-request/46304431#46304431", "title": "Get all the headers of HTTP response and send it back in next HTTP request", "body": "<p>You may be interested in the httputil package and the reverse proxy example provided if you wish to proxy requests transparently:</p>\n\n<p><a href=\"https://golang.org/src/net/http/httputil/reverseproxy.go\" rel=\"noreferrer\">https://golang.org/src/net/http/httputil/reverseproxy.go</a></p>\n\n<p>You can copy the headers from one request to another one fairly easily - the Header is a separate object, if r and rc are http.Requests and you don't mind them sharing a header (you may need to clone instead if you want independent requests): </p>\n\n<pre><code>rc.Header = r.Header // note shallow copy\nfmt.Println(\"Headers\", r.Header, rc.Header)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/q2KUHa_qiP\" rel=\"noreferrer\">https://play.golang.org/p/q2KUHa_qiP</a></p>\n\n<p>Or you can look through keys and values and only copy certain headers, and/or do a clone instead to ensure you share no memory. See the http util package here for examples of this - see the functions cloneHeader and copyHeader inside reverseproxy.go linked above. </p>\n"}], "owner": {"reputation": 183, "user_id": 4903596, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-l1la9rNAGIU/AAAAAAAAAAI/AAAAAAAAACk/m-VUMTDlbu0/photo.jpg?sz=128", "display_name": "vijay", "link": "https://stackoverflow.com/users/4903596/vijay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12943, "favorite_count": 0, "accepted_answer_id": 46304431, "answer_count": 1, "score": 7, "last_activity_date": 1555240517, "creation_date": 1505816767, "last_edit_date": 1555240517, "question_id": 46298064, "link": "https://stackoverflow.com/questions/46298064/get-all-the-headers-of-http-response-and-send-it-back-in-next-http-request", "title": "Get all the headers of HTTP response and send it back in next HTTP request", "body": "<p><strong>Go version: go1.8.1 windows/amd64</strong></p>\n\n<p>Sample code for HTTP request is:</p>\n\n<pre><code>func (c *Client) RoundTripSoap12(action string, in, out Message) error {\n    fmt.Println(\"****************************************************************\")\n    headerFunc := func(r *http.Request) {\n        r.Header.Add(\"Content-Type\", fmt.Sprintf(\"text/xml; charset=utf-8\"))\n        r.Header.Add(\"SOAPAction\", fmt.Sprintf(action))\n        r.Cookies()\n    }\n    return doRoundTrip(c, headerFunc, in, out)\n}\n\nfunc doRoundTrip(c *Client, setHeaders func(*http.Request), in, out Message) error {\n    req := &amp;Envelope{\n        EnvelopeAttr: c.Envelope,\n        NSAttr:       c.Namespace,\n        Header:       c.Header,\n        Body:         Body{Message: in},\n    }\n\n    if req.EnvelopeAttr == \"\" {\n        req.EnvelopeAttr = \"http://schemas.xmlsoap.org/soap/envelope/\"\n    }\n    if req.NSAttr == \"\" {\n        req.NSAttr = c.URL\n    }\n    var b bytes.Buffer\n    err := xml.NewEncoder(&amp;b).Encode(req)\n    if err != nil {\n        return err\n    }\n    cli := c.Config\n    if cli == nil {\n        cli = http.DefaultClient\n    }\n    r, err := http.NewRequest(\"POST\", c.URL, &amp;b)\n    if err != nil {\n        return err\n    }\n    setHeaders(r)\n    if c.Pre != nil {\n        c.Pre(r)\n    }\n    fmt.Println(\"*************\", r)\n    resp, err := cli.Do(r)\n    if err != nil {\n        fmt.Println(\"error occured is as follows \", err)\n        return err\n    }\n    fmt.Println(\"response headers are: \", resp.Header.Get(\"sprequestguid\"))\n    defer resp.Body.Close()\n    if resp.StatusCode != http.StatusOK {\n        // read only the first Mb of the body in error case\n        limReader := io.LimitReader(resp.Body, 1024*1024)\n        body, _ := ioutil.ReadAll(limReader)\n        return fmt.Errorf(\"%q: %q\", resp.Status, body)\n    }\n    return xml.NewDecoder(resp.Body).Decode(out)\n</code></pre>\n\n<p>I will call the <code>RoundTripSoap12</code> function on the corresponding HTTP client.\nWhen I send a request for the first time I will be getting some headers in the HTTP response, so these HTTP response headers should be sent as-is in my next HTTP request.</p>\n"}, {"tags": ["github", "go"], "comments": [{"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 1, "creation_date": 1505816647, "post_id": 46297202, "comment_id": 79558032, "body": "If you have some trouble with a github repository, ... open an issue in that repository."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1505819606, "post_id": 46297202, "comment_id": 79560035, "body": "The problem is in cracklord. It&#39;s install description is broken at least for Go 1.9."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1505819929, "post_id": 46297202, "comment_id": 79560281, "body": "Try cloning manually via <code>git clone</code> et al. and building manually via <code>go build</code>."}], "answers": [{"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": 0, "last_activity_date": 1505815952, "creation_date": 1505815952, "answer_id": 46297782, "question_id": 46297202, "link": "https://stackoverflow.com/questions/46297202/confusion-github-project-broken-instructions-not-clear-mercurial-setup/46297782#46297782", "title": "Confusion: GitHub Project broken(?), Instructions not clear: Mercurial setup(?)", "body": "<p>You don't need to set gopath anymore, it is set by default to: </p>\n\n<pre><code>~/go\n</code></pre>\n\n<p>You don't say which os you're using, but given your paths I assume linux. I suspect you haven't exported the environment variable correctly. You might want to try setting up a simpler package first and verifying you have your go setup right. Follow the instructions here (including verifying your setup is working, and just using the default gopath):</p>\n\n<p><a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">https://golang.org/doc/install</a></p>\n\n<p>And try downloading and running something simpler (which doesn't require several components installed) to verify your setup first. </p>\n"}], "owner": {"reputation": 1, "user_id": 8632407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4CtuQ.png?s=128&g=1", "display_name": "Paul Walker", "link": "https://stackoverflow.com/users/8632407/paul-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505817640, "creation_date": 1505814509, "last_edit_date": 1505817640, "question_id": 46297202, "link": "https://stackoverflow.com/questions/46297202/confusion-github-project-broken-instructions-not-clear-mercurial-setup", "title": "Confusion: GitHub Project broken(?), Instructions not clear: Mercurial setup(?)", "body": "<p>first of all, i've never done something with github, this is my first try, so please be polite and help me on the train. </p>\n\n<p>I would like to use this github-project:\n<a href=\"https://github.com/jmmcatee/cracklord\" rel=\"nofollow noreferrer\">https://github.com/jmmcatee/cracklord</a> which is completly in go language. </p>\n\n<p>from the instructions:\nIf you'd like to get things build from source, it will first require you to have a working Go build environment with the GOPATH setup. Additionally, you'll probably want Git and Mercurial setup to gather the various libraries and plugins that we've used in the code.</p>\n\n<p>Here are my Questions:\nI've done installing git and i'm able to clone the repro, which works fine.\nI've installed mercurial, but have no idea how to \"setup\" mercurial. \nCan someone explain what mercurial setup togehter with this githubproject example means?</p>\n\n<p>why i'm asking\nafter creating a directory <code>git-repos</code>\nchanging into this directory with <code>cd git-repos</code>\npath is now <code>/root/git-repos</code></p>\n\n<pre><code># set GOPATH to /root/git-repos\nexport GOPATH=/root/git-repos\n</code></pre>\n\n<p>and doing <code>go get github.com/jmmcatee/cracklord</code></p>\n\n<p>gives this error-message:</p>\n\n<pre><code>go get github.com/jmmcatee/cracklord\ncan't load package: package github.com/jmmcatee/cracklord: no Go files in /root/git-repos/src/github.com/jmmcatee/cracklord\n</code></pre>\n\n<p>okay. \nSo, when i'm following the instructions i'm not able to finish. Can someone explain what i'm doing wrong? </p>\n\n<p>Thank you\nPaul</p>\n"}, {"tags": ["c++", "go", "swig", "clang++", "cgo"], "comments": [{"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 2, "creation_date": 1505810303, "post_id": 46295661, "comment_id": 79553779, "body": "&quot;Guthub&quot;, your one-stop source for free organs! ... I&#39;ll edit, but I wanted to preserve this beautiful typo for posterity ;)"}, {"owner": {"reputation": 2368, "user_id": 789655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7fac771a6c8fccc82fe34f951b7b3fd?s=128&d=identicon&r=PG", "display_name": "Sthe", "link": "https://stackoverflow.com/users/789655/sthe"}, "reply_to_user": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1505810492, "post_id": 46295661, "comment_id": 79553882, "body": "Ouch! My bad. I mean no disrespect to Github :-)"}], "answers": [{"comments": [{"owner": {"reputation": 1380, "user_id": 5735049, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AJG5e.jpg?s=128&g=1", "display_name": "d0ye", "link": "https://stackoverflow.com/users/5735049/d0ye"}, "edited": false, "score": 0, "creation_date": 1545231425, "post_id": 46386816, "comment_id": 94555029, "body": "how about the next? I have simple_wrap.cxx and simple.go file,  and try to compile simple.go with \u2018\u2019\u2018go tool compile simple.go\u2019\u2018\u2019 but reports simple.go:38:8: can&#39;t find import: &quot;C&quot;"}], "tags": [], "owner": {"reputation": 2368, "user_id": 789655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7fac771a6c8fccc82fe34f951b7b3fd?s=128&d=identicon&r=PG", "display_name": "Sthe", "link": "https://stackoverflow.com/users/789655/sthe"}, "is_accepted": true, "score": 2, "last_activity_date": 1506230074, "creation_date": 1506230074, "answer_id": 46386816, "question_id": 46295661, "link": "https://stackoverflow.com/questions/46295661/has-swig-for-go-become-outdated-since-the-removal-of-some-c-in-golang/46386816#46386816", "title": "Has SWIG for go become outdated since the removal of some C in Golang?", "body": "<p>It looks like I was missing a flag on my Swig command. My original command looked like this:</p>\n\n<pre><code>swig -go -intgosize 64 godelta.swig\n</code></pre>\n\n<p>But as pointed out on the <a href=\"https://github.com/swig/swig/issues/1099\" rel=\"nofollow noreferrer\">issue</a> I eventually filed, I was supposed to include <code>-c++</code> and <code>-cgo</code> ending up with:</p>\n\n<pre><code>swig -c++ -go -cgo -intgosize 64 godelta.swig\n</code></pre>\n\n<p>It's working fine now :-)</p>\n"}], "owner": {"reputation": 2368, "user_id": 789655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7fac771a6c8fccc82fe34f951b7b3fd?s=128&d=identicon&r=PG", "display_name": "Sthe", "link": "https://stackoverflow.com/users/789655/sthe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 644, "favorite_count": 0, "accepted_answer_id": 46386816, "answer_count": 1, "score": 1, "last_activity_date": 1506230074, "creation_date": 1505810163, "last_edit_date": 1505810321, "question_id": 46295661, "link": "https://stackoverflow.com/questions/46295661/has-swig-for-go-become-outdated-since-the-removal-of-some-c-in-golang", "title": "Has SWIG for go become outdated since the removal of some C in Golang?", "body": "<p>I've been trying to generate a Go wrapper for <code>open-vcdiff</code> so I took a look at SWIG for the first time with the following attempt:</p>\n\n<p>godelta.swig</p>\n\n<pre><code>%module godelta\n%include \"include/godelta.hpp\"\n</code></pre>\n\n<p>godelta.hpp</p>\n\n<pre><code>#include \"config.h\"\n#include &lt;assert.h&gt;\n#include &lt;errno.h&gt;\n#ifdef WIN32\n#include &lt;fcntl.h&gt;\n#include &lt;io.h&gt;\n#endif  // WIN32\n#include &lt;stdio.h&gt;\n#include \"google/vcdecoder.h\"\n#include \"google/vcencoder.h\"\n#include \"google/jsonwriter.h\"\n#include \"google/encodetable.h\"\n#include \"unique_ptr.h\" // auto_ptr, unique_ptr\n\n#ifndef HAS_GLOBAL_STRING\n\n#endif  // !HAS_GLOBAL_STRING\n\nstatic const size_t kDefaultMaxTargetSize = 1 &lt;&lt; 26;      // 64 MB\n\nnamespace godelta {\n\n    class Godelta {\n    public:\n        Godelta();\n        ~Godelta();\n\n        bool Encode();\n        bool Decode();\n        bool DecodeAndCompare();\n\n        int opt_buffersize;\n        int opt_max_target_window_size;\n        int opt_max_target_file_size;\n\n    private:\n        input file\n        static bool FileSize(FILE* file, size_t* file_size);\n        bool OpenFileForReading(const string&amp; file_name,\n                            const char* file_type,\n                            FILE** file,\n                            std::vector&lt;char&gt;* buffer);\n        bool OpenDictionary();\n        bool OpenInputFile() {\n            return OpenFileForReading(input_file_name_,\n                                  input_file_type_,\n                                  &amp;input_file_,\n                                  &amp;input_buffer_);\n        }\n\n        bool OpenOutputFile();\n        bool OpenOutputFileForCompare() {\n            return OpenFileForReading(output_file_name_,\n                                  output_file_type_,\n                                  &amp;output_file_,\n                                  &amp;compare_buffer_);\n        }\n\n        bool ReadInput(size_t* bytes_read);\n        bool WriteOutput(const string&amp; output);\n        bool CompareOutput(const string&amp; output);\n\n        std::vector&lt;char&gt; dictionary_;\n\n        UNIQUE_PTR&lt;open_vcdiff::HashedDictionary&gt; hashed_dictionary_;\n\n        const char* input_file_type_;\n        const char* output_file_type_;\n\n        string input_file_name_;\n        string output_file_name_;\n\n        FILE* input_file_;\n        FILE* output_file_;\n\n        std::vector&lt;char&gt; input_buffer_;\n        std::vector&lt;char&gt; compare_buffer_;\n\n        Godelta(const Godelta&amp;);  // NOLINT\n        void operator=(const Godelta&amp;);\n    };\n\n} // namespace godelta\n</code></pre>\n\n<p>Swig works well, generating the files <code>godelta_wrap.cxx</code>, <code>godelta_gc.c</code> and <code>godelta.go</code>. The problem I'm facing now is that it's generating the includes:</p>\n\n<pre><code>#include \"runtime.h\"\n#include \"cgocall.h\"\n</code></pre>\n\n<p>Resulting in the error:</p>\n\n<pre><code>godelta_gc.c:2:10: fatal error: 'runtime.h' file not found\n</code></pre>\n\n<p>I have looked everywhere for that file, even searched the Go repository on GitHub. I'm only finding what seems to be replacements of that file in Go.</p>\n\n<p>By the way, my go version is:</p>\n\n<pre><code>go version go1.9 darwin/amd64\n</code></pre>\n\n<p>Clang:</p>\n\n<pre><code>Apple LLVM version 8.1.0 (clang-802.0.42)\nTarget: x86_64-apple-darwin16.7.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n</code></pre>\n\n<p>And SWIG:</p>\n\n<pre><code>SWIG Version 3.0.12\nCompiled with g++ [x86_64-apple-darwin16.7.0]\nConfigured options: +pcre\n</code></pre>\n\n<p>Any insight on the subject will be highly appreciated, especially if it leads to me being able to run <code>go build</code> on the package without this error :-)</p>\n"}, {"tags": ["google-app-engine", "go", "gcloud"], "answers": [{"comments": [{"owner": {"reputation": 345, "user_id": 2501078, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0762aaca094446e39043dec807a16abd?s=128&d=identicon&r=PG", "display_name": "nafmo", "link": "https://stackoverflow.com/users/2501078/nafmo"}, "edited": false, "score": 0, "creation_date": 1538138348, "post_id": 52545863, "comment_id": 92049628, "body": "That explains the deploy case very well, thank you. The problem is that I cannot get appserver to run locally <i>without</i> vendoring the libraries, I would like to find a way to be able to run both without messing with symlinking and moving stuff around."}, {"owner": {"reputation": 1529, "user_id": 3029676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qTCxh.png?s=128&g=1", "display_name": "wgoodall01", "link": "https://stackoverflow.com/users/3029676/wgoodall01"}, "reply_to_user": {"reputation": 345, "user_id": 2501078, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0762aaca094446e39043dec807a16abd?s=128&d=identicon&r=PG", "display_name": "nafmo", "link": "https://stackoverflow.com/users/2501078/nafmo"}, "edited": false, "score": 0, "creation_date": 1538140100, "post_id": 52545863, "comment_id": 92050638, "body": "I had this problem before--I remember one particularly janky solution was to <code>go get</code> the dependencies directly into appengine&#39;s local <code>$GOROOT</code>. I think, though, what ultimately fixed it for me was an update to <code>gcloud</code> and all components."}, {"owner": {"reputation": 475, "user_id": 2407809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1f74d31bda8fe6fe3cd66b12996400ae?s=128&d=identicon&r=PG", "display_name": "ds011591", "link": "https://stackoverflow.com/users/2407809/ds011591"}, "edited": false, "score": 0, "creation_date": 1550528319, "post_id": 52545863, "comment_id": 96293883, "body": "If you use cloudbuild to deploy your app vendoring is OK"}], "tags": [], "owner": {"reputation": 1529, "user_id": 3029676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qTCxh.png?s=128&g=1", "display_name": "wgoodall01", "link": "https://stackoverflow.com/users/3029676/wgoodall01"}, "is_accepted": true, "score": 3, "last_activity_date": 1538086613, "creation_date": 1538086613, "answer_id": 52545863, "question_id": 46295469, "link": "https://stackoverflow.com/questions/46295469/gcloud-app-deploy-fails-cannot-import-internal-package/52545863#52545863", "title": "gcloud app deploy fails &quot;cannot import internal package&quot;", "body": "<p>The reason this happens is because of how App Engine builds Go apps. </p>\n\n<p>Because of the App Engine standard environment <a href=\"https://cloud.google.com/appengine/docs/standard/go/runtime#Go_The_sandbox\" rel=\"nofollow noreferrer\">security sandbox</a> and container model, they prohibit Go code from importing any packages which could potentially mess with their systems--like <code>unsafe</code>, for instance. They also block direct imports of the internal appengine packages (<code>google.golang.org/appengine/internal/whatever</code>) for the same reason.</p>\n\n<p>For this project, you've locally vendored your dependencies. For the app engine app builder, though, this looks no different then if you had just made another sub-package in your app and put the dependencies in there. It's functionally the same as if you had just copied and pasted <code>appengine/search</code> straight into your project.</p>\n\n<p>Because <code>appengine/search</code> imports its corresponding internal package, <code>appengine/internal/search</code>, and the Go app builder doesn't really differentiate between what's in your application code and what's in your <code>vendor</code> directory, it fails the build. To App Engine, it looks like <em>you</em> imported <code>appengine/internal/search</code>, which is prohibited by the security model. It doesn't know how <code>appengine/internal/search</code> is being used, because it doesn't control what's in <code>vendor</code>, so to keep the sandbox secure it doesn't let you import it.</p>\n\n<p>The solution to this problem is, basically, to not vendor your dependencies. </p>\n\n<p>If you remove all the <code>appengine/whatever</code> packages from <code>vendor</code>, then the App Engine builder will look for them on Google's build servers instead of in your project. The App Builder trusts its own local copies of the <code>appengine</code> libraries not to misbehave, so they're permitted to import <code>appengine/whatever/internal</code> packages.</p>\n\n<p>(As an aside, if you haven't already, make sure <code>gcloud</code> and all related components are up to date. This can sometimes resolve gnarly dependency issues)</p>\n"}], "owner": {"reputation": 345, "user_id": 2501078, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0762aaca094446e39043dec807a16abd?s=128&d=identicon&r=PG", "display_name": "nafmo", "link": "https://stackoverflow.com/users/2501078/nafmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1218, "favorite_count": 1, "accepted_answer_id": 52545863, "answer_count": 1, "score": 5, "last_activity_date": 1538086613, "creation_date": 1505809510, "last_edit_date": 1505981848, "question_id": 46295469, "link": "https://stackoverflow.com/questions/46295469/gcloud-app-deploy-fails-cannot-import-internal-package", "title": "gcloud app deploy fails &quot;cannot import internal package&quot;", "body": "<p>I am compiling a GO app that I want to upload and run on the Google Cloud Platform. I am importing the <code>appengine/datastore</code> package and am running into problems with vendoring of the packages. Since I want to provide stable builds I want to have as much of the dependencies vendored in my source tree, but when I vendor <code>appengine/datastore</code> I run in to problems runnning <code>gcloud app deploy</code>:</p>\n\n<p>OperationError: Error Response: [9] Deployment contains files that cannot be compiled: Compile failed:\n2017/09/19 01:07:31 go-app-builder: Failed parsing input: package \"vendor/google.golang.org/appengine/search\" cannot import internal package \"google.golang.org/appengine/internal/search\"</p>\n\n<pre><code>ERROR: (gcloud.app.deploy) Error Response: [9] Deployment contains files that cannot be compiled: Compile failed:\n2017/09/19 01:07:31 go-app-builder: Failed parsing input: package \"vendor/google.golang.org/appengine/search\" cannot import internal package \"google.golang.org/appengine/internal/search\"\n</code></pre>\n\n<p>I can run the <code>dev_appserver.py</code> script just fine, the application runs smoothly locally, and <code>go test</code> succeeds compiling and running all the module tests.</p>\n\n<p>If I try to remove the vendoring of any of the appengine packages and instead use <code>go get</code> to install them outside of the version control, <code>dev_appserver.py</code> no longer runs, complaining about duplicate packages:</p>\n\n<pre><code>rm -rf ../vendor/google.golang.org/appengine\ngo get google.golang.org/appengine\ndev_appserver.py app.yaml\n[....]\n2017/09/19 10:20:10 go-app-builder: Failed parsing input: package \"golang.org/x/net/context\" is imported from multiple locations: \"/home/peter/src/myproject/go/src/myproject/vendor/golang.org/x/net/context\" and \"/home/peter/src/myproject/go/src/golang.org/x/net/context\"\n</code></pre>\n\n<p>while <code>gcloud app deploy</code> instead complains about not finding the packages at all:</p>\n\n<pre><code>[...]\nFile upload done.\nUpdating service [default]...failed.                                                             \nERROR: (gcloud.app.deploy) Error Response: [9] Deployment contains files that cannot be compiled: Compile failed:\nCompile failed:\n2017/09/19 01:22:13 go-app-builder: build timing: 7\u00d7compile (1.749s total), 0\u00d7link (0s total)\n2017/09/19 01:22:13 go-app-builder: failed running compile: exit status 2\nmyproject/vendor/golang.org/x/text/unicode/norm/normalize.go:15: can't find import: \"golang.org/x/text/transform\"\n$ find .. -name transform\n../vendor/golang.org/x/text/transform\n</code></pre>\n\n<p><strong>EDIT</strong>: <em>WORKAROUND</em>: I have found that I can make it compile with <code>gcloud</code> by symlinking the vendored directories (<code>github.com</code> and <code>golang.org</code>) into the application directory (<code>ln -s ../vendor/* .</code>), and downloading the appengine package manually (<code>go get google.golang.org/appengine</code>). However, I need to delete the symlinks to be able to run <code>dev_appserver.py</code>, so this is not nearly optimal.</p>\n"}, {"tags": ["json", "rest", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "edited": false, "score": 0, "creation_date": 1505812042, "post_id": 46296093, "comment_id": 79554879, "body": "Thanks for the answer. I already thought of something like this, but coming from Python I just couldn&#39;t imagine that it&#39;s so cumbersome to receive some simple json. But the reality is; it IS that cumbersome. I&#39;m calling about 10 different API calls, and from many I just want to get one simple number. In Python I can just do a oneliner per call: <code>requests.get(&#39;http:&#47;&#47;url.com&#47;facts&#39;).json()[&#39;result&#39;][&#39;bids&#39;&zwnj;&#8203;][0][&#39;price&#39;]</code>. In go it takes me about 25 lines per call. Go is awesome in many ways, but this is not one of them."}, {"owner": {"reputation": 5182, "user_id": 550967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w1NTf.jpg?s=128&g=1", "display_name": "DallaRosa", "link": "https://stackoverflow.com/users/550967/dallarosa"}, "reply_to_user": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "edited": false, "score": 0, "creation_date": 1505813201, "post_id": 46296093, "comment_id": 79555670, "body": "I totally understand how you&#39;re feeling coming from Python/Ruby myself. However with time you&#39;ll see that there actually are positive sides to this approach. By the way, if you&#39;re satisfied with the answer, please don&#39;t foget to accept it :)"}, {"owner": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "edited": false, "score": 0, "creation_date": 1505816065, "post_id": 46296093, "comment_id": 79557624, "body": "May I ask what you think are the positive sides of this approach? I would love to see why this can actually be awesome, but currently I fail to do so."}], "tags": [], "owner": {"reputation": 5182, "user_id": 550967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w1NTf.jpg?s=128&g=1", "display_name": "DallaRosa", "link": "https://stackoverflow.com/users/550967/dallarosa"}, "is_accepted": true, "score": 2, "last_activity_date": 1505811477, "creation_date": 1505811477, "answer_id": 46296093, "question_id": 46295450, "link": "https://stackoverflow.com/questions/46295450/how-to-receive-complex-json-with-goreq/46296093#46296093", "title": "How to receive complex json with goreq?", "body": "<p><strong>TL;DR</strong></p>\n\n<blockquote>\n  <p>Can I write it in one struct</p>\n</blockquote>\n\n<p>Yes</p>\n\n<blockquote>\n  <p>or do I need to use maps for the bid and ask arrays, and yet another\n  struct for the bid and ask objects?</p>\n</blockquote>\n\n<p>Yes</p>\n\n<p>Before I actually do the hand holding here, I'm gonna recommend that you actually spend some more time getting used to the way things are done in Go. This might be tedious work but it is very simple.</p>\n\n<p><strong>Long Version</strong></p>\n\n<blockquote>\n  <p>I'm not sure how I would create a struct which represents this complex\n  structure.</p>\n</blockquote>\n\n<p>You are going to do it the same way if you just had to represent this in your program, without any JSON.</p>\n\n<p>Let's explain what you have in that message in English before we translate it to Go:</p>\n\n<p>You have a struct with the fields: </p>\n\n<ul>\n<li>Success - Boolean</li>\n<li>Message - String</li>\n<li>Result  - Struct</li>\n</ul>\n\n<p>Now, Result is also a struct, so we need to describe it:</p>\n\n<ul>\n<li>Bids - Array of Struct</li>\n<li>Asks - Array of Struct</li>\n<li>Slip - Integer</li>\n</ul>\n\n<p>Let's do the same for Bids and Asks (the look the same so I'll save space)</p>\n\n<ul>\n<li>Quantity - Integer</li>\n<li>Price - Float64</li>\n<li>Cm - String</li>\n</ul>\n\n<p>Now let's define our struct:</p>\n\n<p>Let's call the container struct \"Response\" and the result one \"Result\"</p>\n\n<pre><code>type Response struct {\n  Success bool `json:\"success\"`\n  Message string `json:\"message\"`\n  Result  Result `json:\"result\"`\n}\n\ntype Result struct {\n  Bids []Quote `json:\"bids\"`\n  Asks []Quote `json:\"asks\"`\n  Slip int `json:\"slip\"`\n}\n\ntype Quote struct { \n//As asks and bids are have the same structure we can save code\n  Quantity int `json:\"quantity\"`\n  Price float64 `json:\"price\"`\n  Cm string `json:\"cm\"`\n}\n</code></pre>\n\n<p>Don't forget to add annotations so that the (Un)Marshaling functions can properly match fields in JSON to the Struct.</p>\n\n<p>I believe the above is the best and more maintainable way of implementing this, however you can also write the same as one struct with nested anonymous structs:</p>\n\n<pre><code>type Response struct {\n    Success bool   `json:\"success\"`\n    Message string `json:\"message\"`\n    Result  struct {\n        Bids []struct {\n            Quantity int     `json:\"quantity\"`\n            Price    float64 `json:\"price\"`\n            Cm       string  `json:\"cm\"`\n        } `json:\"bids\"`\n        Asks []struct {\n            Quantity int     `json:\"quantity\"`\n            Price    float64 `json:\"price\"`\n            Cm       string  `json:\"cm\"`\n        } `json:\"asks\"`\n        Slip int `json:\"slip\"`\n    } `json:\"result\"`\n}\n</code></pre>\n\n<p>By the way, there's an interesting tool that I found a few weeks ago that automatically transforms JSON to a Go struct that you can declare in your code right away: <a href=\"https://transform.now.sh/json-to-go/\" rel=\"nofollow noreferrer\">https://transform.now.sh/json-to-go/</a></p>\n"}], "owner": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 46296093, "answer_count": 1, "score": 1, "last_activity_date": 1505811477, "creation_date": 1505809446, "last_edit_date": 1505811157, "question_id": 46295450, "link": "https://stackoverflow.com/questions/46295450/how-to-receive-complex-json-with-goreq", "title": "How to receive complex json with goreq?", "body": "<p>I'm a beginner in Go and I'm trying to call a json rest-API for which I'm trying to use the <a href=\"https://github.com/franela/goreq\" rel=\"nofollow noreferrer\">goreq request lib</a>. In the readme it gives <a href=\"https://github.com/franela/goreq#receiving-json\" rel=\"nofollow noreferrer\">the following example</a> for decoding the received json:</p>\n\n<pre><code>type Item struct {\n    Id int\n    Name string\n}\n\nvar item Item\n\nres.Body.FromJsonTo(&amp;item)\n</code></pre>\n\n<p>I understand this example, but the json I'm receiving is way more complex (see below). I'm not sure how I would create a <code>struct</code> which represents this complex structure. Can I write it in one <code>struct</code>, or do I need to use maps for the bid and ask arrays, another struct for the bid and ask objects, and yet one more struct for the <code>\"vars\"</code> object? </p>\n\n<p>Isn't there any automagic <code>json_to_struct()</code> function which dynamically builds the struct upon receiving the json (I've looked but I can't find anything)?</p>\n\n<p>All tips are welcome!</p>\n\n<pre><code>{\n    \"success\": true,\n    \"message\": \"something\",\n    \"vars\": {\"some\": \"value\", \"thenumber\": 7612.32},\n    \"result\": {\n        \"bids\": [\n            {\"quantity\": 2, \"price\": 416.02, \"cm\": \"some text\"},\n            etc..\n        ],\n        \"asks\": [\n            {\"quantity\": 1, \"price\": 420.02, \"cm\": \"some text\"},\n            etc..\n        ],\n        \"slip\": 4\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1505815407, "post_id": 46295343, "comment_id": 79557185, "body": "take a look at this: <a href=\"https://stackoverflow.com/questions/24863164/how-to-analyse-golang-memory\" title=\"how to analyse golang memory\">stackoverflow.com/questions/24863164/&hellip;</a>. Eg: you can only tell if you have a leak after a memory profile."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505878575, "post_id": 46295343, "comment_id": 79587448, "body": "A memory profile doesn&#39;t necessarily point to a leak (usually it doesn&#39;t), but you do need to use the memory statistics from within the process as the external measurements don&#39;t necessarily reflect what the process claims. This graph looks like it&#39;s approaching a sustained max, does it ever increase more? What does gctrace say is happening at that point? What are the runtime memory stats?"}], "owner": {"reputation": 5501, "user_id": 1491531, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/13409f124d810d9c0e92d30a9364105a?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/1491531/anton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 624, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1575278273, "creation_date": 1505809100, "last_edit_date": 1575278273, "question_id": 46295343, "link": "https://stackoverflow.com/questions/46295343/current-rss-slowly-increasing-while-heap-is-not", "title": "Current RSS slowly increasing while heap is not", "body": "<p>This is a graph of current RSS. The decrease in the beginning is due to a restart, and then it seems to slowly increase infinitely.\n<a href=\"https://i.stack.imgur.com/B13lh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/B13lh.png\" alt=\"Current RSS\"></a></p>\n\n<p>This is the heap. The idle heap seems to also be on a slowly upwards trend. The non-idle heap seems to stay down.\n<a href=\"https://i.stack.imgur.com/s0xiF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s0xiF.png\" alt=\"Heap\"></a></p>\n\n<p>Do I have a memory leak, or does this seem normal?</p>\n"}, {"tags": ["go", "pptp"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1505837758, "post_id": 46293435, "comment_id": 79572726, "body": "Perhaps the shell is not reaping the child process, although I don&#39;t knw why it wouldn&#39;t.  Try invoking the commands directly: <code>exec.Command(&quot;pppd&quot;, &quot;call&quot;, &quot;vpn&quot;).CombinedOutput()</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505878863, "post_id": 46293435, "comment_id": 79587525, "body": "This is <a href=\"https://golang.org/issue/18874\" rel=\"nofollow noreferrer\">issue 18874</a>. The latest docs make note of this: <code>Wait waits for the command to exit and waits for any copying to stdin or copying from stdout or stderr to complete</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1071, "user_id": 3296612, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/DXU72.jpg?s=128&g=1", "display_name": "xren", "link": "https://stackoverflow.com/users/3296612/xren"}, "edited": false, "score": 2, "creation_date": 1505828928, "post_id": 46294294, "comment_id": 79566863, "body": "Actually .CombinedOutput() already has called wait(). I guess the wait() is onlying waiting for <code>sh</code> instead of the child processes  sh created. Do you know how to resolve this ?"}, {"owner": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "reply_to_user": {"reputation": 1071, "user_id": 3296612, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/DXU72.jpg?s=128&g=1", "display_name": "xren", "link": "https://stackoverflow.com/users/3296612/xren"}, "edited": false, "score": 0, "creation_date": 1505850336, "post_id": 46294294, "comment_id": 79579180, "body": "If that is the case, no. Well, yes. Start the command directly, without <code>sh</code>, eg <code>exec.Command(&quot;pppd call vpn&quot;).CombinedOutput()</code>."}], "tags": [], "owner": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "is_accepted": true, "score": 8, "last_activity_date": 1505875696, "last_edit_date": 1505875696, "creation_date": 1505805594, "answer_id": 46294294, "question_id": 46293435, "link": "https://stackoverflow.com/questions/46293435/golang-exec-command-cause-a-lot-of-defunct-processes/46294294#46294294", "title": "golang exec.Command cause a lot of defunct processes", "body": "<p>These <a href=\"https://en.m.wikipedia.org/wiki/Zombie_process\" rel=\"noreferrer\">\"zombie\" processes</a> are created when a process has finished, but the parent has not read their exit status via the <code>wait</code> system call.</p>\n\n<p>I would guess that all you need to do is call <code>(*Cmd).Wait()</code> on every command structure you create. Obviously This will be less straight forward than you may like, since you probably don't want to call <code>Wait</code> on the first command until after the second command is finished.</p>\n\n<hr>\n\n<p>EDIT: As is pointed out in the comments, <a href=\"https://golang.org/src/os/exec/exec.go?s=13634:13680#L486\" rel=\"noreferrer\"><code>(*Cmd).CombinedOutput()</code></a> calls <a href=\"https://golang.org/src/os/exec/exec.go?s=8356:8381#L275\" rel=\"noreferrer\"><code>(*Cmd).Run()</code></a>, which calls <code>(*Cmd).Wait()</code>... So the above is wrong. The real answer in this case is that for some reason <code>sh</code> isn't cleaning up, and so the solution is to cut out the midle man and do the call like so:</p>\n\n<pre><code>exec.Command(\"pppd\", \"call\", \"vpn\").CombinedOutput()\n</code></pre>\n\n<p>That'll teach me to read the docs a little closer next time...</p>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 638224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1de97ea98d0f52a0953b193d6f59c6?s=128&d=identicon&r=PG", "display_name": "Jonathan B", "link": "https://stackoverflow.com/users/638224/jonathan-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1525906619, "creation_date": 1525906619, "answer_id": 50263187, "question_id": 46293435, "link": "https://stackoverflow.com/questions/46293435/golang-exec-command-cause-a-lot-of-defunct-processes/50263187#50263187", "title": "golang exec.Command cause a lot of defunct processes", "body": "<p>A simpler way to cancel your command would be to use <a href=\"https://godoc.org/os/exec#CommandContext\" rel=\"nofollow noreferrer\">exec.CommandContext</a>. e.g.</p>\n\n<pre><code>ctx, cancel := context.WithCancel(context.Background())\nexec.CommandContext(ctx, \"pppd\", \"call\", \"vpn\").CombinedOutput()\n\n// in some other goroutine...\ncancel()\n</code></pre>\n\n<p>Maybe this would solve your zombie problem?</p>\n"}, {"tags": [], "owner": {"reputation": 147, "user_id": 6630386, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2iael.jpg?s=128&g=1", "display_name": "levinit", "link": "https://stackoverflow.com/users/6630386/levinit"}, "is_accepted": false, "score": 0, "last_activity_date": 1619274903, "creation_date": 1619274903, "answer_id": 67243907, "question_id": 46293435, "link": "https://stackoverflow.com/questions/46293435/golang-exec-command-cause-a-lot-of-defunct-processes/67243907#67243907", "title": "golang exec.Command cause a lot of defunct processes", "body": "<p>run subprocess in a new thread</p>\n<pre class=\"lang-golang prettyprint-override\"><code>go exec.Command(&quot;sh&quot;, &quot;-c&quot;, &quot;pppd call vpn&quot;).CombinedOutput()\n</code></pre>\n<p>kill subprocess</p>\n<pre><code>exec.Command(&quot;pkill&quot;, &quot;pppd&quot;).CombinedOutput().CombinedOutput()\n</code></pre>\n"}], "owner": {"reputation": 1071, "user_id": 3296612, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/DXU72.jpg?s=128&g=1", "display_name": "xren", "link": "https://stackoverflow.com/users/3296612/xren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3485, "favorite_count": 0, "accepted_answer_id": 46294294, "answer_count": 3, "score": 3, "last_activity_date": 1619274903, "creation_date": 1505802811, "question_id": 46293435, "link": "https://stackoverflow.com/questions/46293435/golang-exec-command-cause-a-lot-of-defunct-processes", "title": "golang exec.Command cause a lot of defunct processes", "body": "<p>I'm using golang to call pppd and then kill it after a while. However I got a lot of defunct proccesses in this way.</p>\n\n<p>This is how I run pppd</p>\n\n<pre><code>exec.Command(\"sh\", \"-c\", \"pppd call vpn\").CombinedOutput()\n</code></pre>\n\n<p>This is how I kill it.</p>\n\n<pre><code>exec.Command(\"sh\", \"-c\", \"pkill pppd\").CombinedOutput()\n</code></pre>\n\n<p>Then I got a lot of this</p>\n\n<pre><code>root     31541 23536  0 10:54 ?        00:00:00 [pppd] &lt;defunct&gt;\nroot     31929 23356  0 10:55 ?        00:00:00 [pptpgw] &lt;defunct&gt;\nroot     31933 23356  0 10:55 ?        00:00:00 [pptpcm] &lt;defunct&gt;\nroot     31940 23356  0 10:55 ?        00:00:00 [pppd] &lt;defunct&gt;\nroot     31993 23536  0 10:55 ?        00:00:00 [pptpgw] &lt;defunct&gt;\nroot     31997 23536  0 10:55 ?        00:00:00 [pptpcm] &lt;defunct&gt;\nroot     31998 23536  0 10:55 ?        00:00:00 [pppd] &lt;defunct&gt;\nroot     32012 23356  0 10:55 ?        00:00:00 [pptpgw] &lt;defunct&gt;\nroot     32016 23356  0 10:55 ?        00:00:00 [pptpcm] &lt;defunct&gt;\nroot     32017 23356  0 10:56 ?        00:00:00 [pppd] &lt;defunct&gt;\nroot     32070 23536  0 10:56 ?        00:00:00 [pptpgw] &lt;defunct&gt;\nroot     32074 23536  0 10:56 ?        00:00:00 [pptpcm] &lt;defunct&gt;\nroot     32075 23536  0 10:56 ?        00:00:00 [pppd] &lt;defunct&gt;\nroot     32083 23356  0 10:56 ?        00:00:00 [pptpgw] &lt;defunct&gt;\nroot     32087 23356  0 10:56 ?        00:00:00 [pptpcm] &lt;defunct&gt;\nroot     32089 23356  0 10:56 ?        00:00:00 [pppd] &lt;defunct&gt;\nroot     32131 23536  0 10:57 ?        00:00:00 [pptpgw] &lt;defunct&gt;\nroot     32135 23536  0 10:57 ?        00:00:00 [pptpcm] &lt;defunct&gt;\nroot     32148 23536  0 10:57 ?        00:00:00 [pppd] &lt;defunct&gt;\nroot     32160 23356  0 10:57 ?        00:00:00 [pptpgw] &lt;defunct&gt;\nroot     32164 23356  0 10:57 ?        00:00:00 [pptpcm] &lt;defunct&gt;\nroot     32165 23356  0 10:57 ?        00:00:00 [pppd] &lt;defunct&gt;\nroot     32177 23536  0 10:57 ?        00:00:00 [pptpgw] &lt;defunct&gt;\nroot     32181 23536  0 10:57 ?        00:00:00 [pptpcm] &lt;defunct&gt;\n</code></pre>\n\n<p>How can I avoid defunct processes.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 1, "creation_date": 1505801677, "post_id": 46293070, "comment_id": 79548522, "body": "The real question is &quot;why should it matter to you?&quot;. Is there some specific reason why you think you need to determine whether a collection exists or not?"}, {"owner": {"reputation": 667, "user_id": 7091706, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/kIdrY.jpg?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/7091706/habib"}, "reply_to_user": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1505801870, "post_id": 46293070, "comment_id": 79548632, "body": "Yes its really matter for me.  I am creating <b>seeds</b> in a <b>users</b> collection.  If there is no <b>user</b> and no <b>collection</b> than my server will create a collection first than it will create a default user."}, {"owner": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 3, "creation_date": 1505802299, "post_id": 46293070, "comment_id": 79548910, "body": "You do realize that if you simply ask for the <code>count</code> from a collection, then whether it exists or not it always returns a number. So empty or not present would be <code>0</code>. There is a distinction, and there are cases where you might actually need to test for the presence of a collection. But your case does not appear to be one of them."}], "answers": [{"comments": [{"owner": {"reputation": 667, "user_id": 7091706, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/kIdrY.jpg?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/7091706/habib"}, "edited": false, "score": 0, "creation_date": 1505806253, "post_id": 46293794, "comment_id": 79551379, "body": "So you mean to say it doesn&#39;t matter if a collection exists or not. I just have to add a document? right?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 667, "user_id": 7091706, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/kIdrY.jpg?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/7091706/habib"}, "edited": false, "score": 2, "creation_date": 1505806652, "post_id": 46293794, "comment_id": 79551650, "body": "@HabibM.Farooq Exactly. If you attempt to insert a document into a non-existing collection, the collection will be created automatically for you."}, {"owner": {"reputation": 667, "user_id": 7091706, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/kIdrY.jpg?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/7091706/habib"}, "edited": false, "score": 0, "creation_date": 1505811480, "post_id": 46293794, "comment_id": 79554528, "body": "Thank you for your perfect answer and thank you for your help."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1526552325, "last_edit_date": 1526552325, "creation_date": 1505804053, "answer_id": 46293794, "question_id": 46293070, "link": "https://stackoverflow.com/questions/46293070/how-to-check-if-collection-exists-or-not-mongodb-golang/46293794#46293794", "title": "How to check if collection exists or not MongoDB Golang", "body": "<p>You may simply use the <a href=\"https://godoc.org/gopkg.in/mgo.v2#Database.CollectionNames\" rel=\"nofollow noreferrer\"><code>Database.CollectionNames()</code></a> method which returns the collection names present in the given db. It returns a slice in which you have to check if your collection is listed.</p>\n\n<pre><code>sess := ... // obtain session\ndb := sess.DB(\"\") // Get db, use db name if not given in connection url\n\nnames, err := db.CollectionNames()\nif err != nil {\n    // Handle error\n    log.Printf(\"Failed to get coll names: %v\", err)\n    return\n}\n\n// Simply search in the names slice, e.g.\nfor _, name := range names {\n    if name == \"collectionToCheck\" {\n        log.Printf(\"The collection exists!\")\n        break\n    }\n}\n</code></pre>\n\n<p>But as Neil Lunn wrote in his comments, you shouldn't need this. You should change your logic to use MongoDB not to rely on this check. Collections are created automatically if you try to insert a document, and querying from non-existing collections yields no error (and no result of course).</p>\n"}], "owner": {"reputation": 667, "user_id": 7091706, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/kIdrY.jpg?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/7091706/habib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4085, "favorite_count": 3, "accepted_answer_id": 46293794, "answer_count": 1, "score": 7, "last_activity_date": 1526552325, "creation_date": 1505801498, "question_id": 46293070, "link": "https://stackoverflow.com/questions/46293070/how-to-check-if-collection-exists-or-not-mongodb-golang", "title": "How to check if collection exists or not MongoDB Golang", "body": "<p>I am new to <strong>GO</strong> language and I am using <strong>MongoDB</strong> with it. I am creating a backend for an application and its frontend on <strong>Angular 4</strong>. I want to check if collection exists or not. </p>\n\n<p>Here is my code and I have checked it using <strong>nil</strong>. </p>\n\n<pre><code>collection := GetCollection(\"users\")    \nfmt.Println(\"collection\", collection)   \nif collection == nil {      \n   fmt.Println(\"Collection is empty\")   \n}\n</code></pre>\n\n<p>I have created a <strong>GetCollection</strong> function which return a collection when we pass it a collection name. \nSo when if there is no collection how can I check that if it exists or not?\nI have tried many things but failed. </p>\n"}, {"tags": ["go", "slice", "middleware"], "answers": [{"tags": [], "owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "is_accepted": false, "score": 1, "last_activity_date": 1505805920, "creation_date": 1505805920, "answer_id": 46294392, "question_id": 46292705, "link": "https://stackoverflow.com/questions/46292705/nest-functions-from-slice/46294392#46294392", "title": "Nest Functions From Slice", "body": "<pre><code>func Auth(n http.Handler) http.Handler {\n  return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n      log.Printf(\"Start\")\n      n.ServeHTTP(w, r)\n      log.Printf(\"End\")\n  })\n}\n\nfunc processReq(w http.ResponseWriter, r *http.Request) {\n  w.Write([]byte(\"Success\"))\n}\n\n\nfunc main() {\n  handler := http.HandlerFunc(processReq)\n\n  http.Handle(\"/\",Auth(handler))\n  http.ListenAndServe(\":8000\", nil)\n}\n</code></pre>\n\n<p>can be done using http.handler</p>\n"}, {"tags": [], "owner": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "is_accepted": false, "score": 0, "last_activity_date": 1505806808, "creation_date": 1505806808, "answer_id": 46294711, "question_id": 46292705, "link": "https://stackoverflow.com/questions/46292705/nest-functions-from-slice/46294711#46294711", "title": "Nest Functions From Slice", "body": "<p>Simple. You define each handler like so:</p>\n\n<pre><code>// So I don't have to type it over and over...\ntype HTTPHandler func(w http.ResponseWriter, r *http.Request)\n\nfunc Handler1(next HTTPHandler) HTTPHandler {\n    return func(w http.ResponseWriter, r *http.Request){\n        // Do stuff\n\n        if next != nil {\n            next(w, r)\n        }\n    }\n}\n\n// Handler2 ... HandlerN defined in the same basic way.\n\n// Chaining:\nhttp.Handle(\"/\", Handler1(Handler2(nil)))\n</code></pre>\n\n<p>Each handler takes the next handler and returns a closure that does whatever you want plus calling the next handler. If you need lots of these it may make sense to write a helper similar to this one:</p>\n\n<pre><code>func MakeHandler(worker, next HTTPHandler) HTTPHandler {\n    return func(w http.ResponseWriter, r *http.Request){\n        // Maybe have to worker return an error and do standard error\n        // handling here? Could simplify your code some depending on\n        // what you are doing.\n        worker(w, r)\n\n        if next != nil {\n            next(w, r)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 2045171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99c4080f412ccf46b9b564db7f482907?s=128&d=identicon&r=PG", "display_name": "KukicAdo", "link": "https://stackoverflow.com/users/2045171/kukicado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1505806808, "creation_date": 1505799995, "last_edit_date": 1505805676, "question_id": 46292705, "link": "https://stackoverflow.com/questions/46292705/nest-functions-from-slice", "title": "Nest Functions From Slice", "body": "<p>I am building a Go web application that supports various middleware functions when handling routing. I'm trying to stick to <code>net/http</code> as much as possible and was wondering how I might accomplish this without using middleware libraries like <strong>negroni</strong>.</p>\n\n<p>Essentially what I would like to do is to be able to provide a slice of middleware functions, say one for logging, one for checking for a valid JWT, and then finally the handler to handle the request.</p>\n\n<p>I am able to do this with negroni fairly simply by defining the following struct:</p>\n\n<pre><code>// Route ..\ntype Route struct {\n  Method     string\n  Path       string\n  Middleware []negroni.Handler\n  Handler    http.HandlerFunc\n}\n</code></pre>\n\n<p>and then defining a route like:</p>\n\n<pre><code>var commonRoutes = []Route{\n    {\n        Method:     \"GET\",\n        Path:       \"/info\",\n        Middleware: []negroni.Handler{negroni.HandlerFunc(middleware.CheckCache), negroni.HandlerFunc(middleware.Authenticated), negroni.NewLogger()},\n        Handler:    handlers.APIInfo,\n    },\n}\n</code></pre>\n\n<p>Finally when I boot up my server, I import the list of routes and register them like so:</p>\n\n<pre><code>for _, r := range routes {\n\n  handler := append(r.Middleware, negroni.Wrap(r.Handler))\n\n  router.Handle(r.Path, negroni.New(handler...)).Methods(r.Method)\n}\n</code></pre>\n\n<p>And this works perfectly. </p>\n\n<p>Any idea how I might be able to do this with just the standard <code>net/http</code> signature and way of defining middleware handlers that look like this:</p>\n\n<pre><code>http.Handle(\"/\", middlewareOne(middlewareTwo(finalHandler)))\n</code></pre>\n\n<p>Thank you :)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1505802410, "post_id": 46292695, "comment_id": 79548986, "body": "What format does the server expect (application/x-www-form-urlencoded or multipart/form-data)?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1505802923, "post_id": 46292695, "comment_id": 79549304, "body": "Turning ints and floats into strings is as simple as fmt.Sprintf(&quot;%d&quot;, i) and fmt.Sprintf(&quot;%f&quot;, f) so this cannot be the problem, or?"}, {"owner": {"reputation": 1007, "user_id": 1288335, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/XpqwZ.jpg?s=128&g=1", "display_name": "Soumya Rauth", "link": "https://stackoverflow.com/users/1288335/soumya-rauth"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1505803304, "post_id": 46292695, "comment_id": 79549508, "body": "server expect multipart/form-data @CeriseLim&#243;n"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1505836400, "post_id": 46292695, "comment_id": 79571930, "body": "Create multipart form body and WriteField(name, fmt.Sprintf(&quot;%v&quot;, value)) for each field."}], "answers": [{"comments": [{"owner": {"reputation": 1007, "user_id": 1288335, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/XpqwZ.jpg?s=128&g=1", "display_name": "Soumya Rauth", "link": "https://stackoverflow.com/users/1288335/soumya-rauth"}, "edited": false, "score": 0, "creation_date": 1505823020, "post_id": 46299893, "comment_id": 79562347, "body": "But how do I convert a struct into String"}, {"owner": {"reputation": 11, "user_id": 8633247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa94563d35053cd9db2567978d9b073?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/8633247/siddharth"}, "reply_to_user": {"reputation": 1007, "user_id": 1288335, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/XpqwZ.jpg?s=128&g=1", "display_name": "Soumya Rauth", "link": "https://stackoverflow.com/users/1288335/soumya-rauth"}, "edited": false, "score": 1, "creation_date": 1505910326, "post_id": 46299893, "comment_id": 79604716, "body": "b, err := json.Marshal(c) b which is a byte array can be typecast in a string variable and then again typecast and unmarshalled at server end"}], "tags": [], "owner": {"reputation": 11, "user_id": 8633247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa94563d35053cd9db2567978d9b073?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/8633247/siddharth"}, "is_accepted": false, "score": 1, "last_activity_date": 1505822378, "creation_date": 1505822378, "answer_id": 46299893, "question_id": 46292695, "link": "https://stackoverflow.com/questions/46292695/sending-struct-to-form-field-in-golang/46299893#46299893", "title": "sending struct to form field in golang", "body": "<p>The Form values in HTTP form are sent as string values only.</p>\n\n<p>If you have the liberty of deciding the form keys as well then you can add the whole structure as a json-encoded string against a generic \"data\" field and send the request. Else, you'd have to convert the structure values to string representation to send them in request. </p>\n"}], "owner": {"reputation": 1007, "user_id": 1288335, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/XpqwZ.jpg?s=128&g=1", "display_name": "Soumya Rauth", "link": "https://stackoverflow.com/users/1288335/soumya-rauth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1929, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1505822378, "creation_date": 1505799962, "question_id": 46292695, "link": "https://stackoverflow.com/questions/46292695/sending-struct-to-form-field-in-golang", "title": "sending struct to form field in golang", "body": "<p>I have a struct which I have to send to an api and it's a post request. But the input are form field. And the fields contains strings, integer, float and image. \nI tried to use WriteField function but since this function only takes strings as parameters, I can't process integer and float. How do I do that. Here is my struct and the code snippet. </p>\n\n<pre><code>c := finalObject{\n    name: Name,\n    ProfilePic:\"/img/unknown.jpg\",\n    owner:\"Mr Hall\",\n    latitude:26.5473828,\n    longitude:88.4249179,\n    opendays:\"Monday-Friday\",\n    openhours:\"10am to 5pm\",\n    catId:82,\n    address:address,\n    phone_number:2312312,\n    mobile_number:312312,\n    email:\"dsdas@a.com\",\n  }\n\n  url := \"https://abcd.com/a\"\n    fmt.Println(\"URL:&gt;\", url)\n    b, err := json.Marshal(c)\n    if err != nil {\n      fmt.Println(\"error:\", err)\n    }\n    os.Stdout.Write(b)\n    var jsonStr = []byte(b)\n    req, err := http.NewRequest(\"POST\", url, bytes.NewBuffer(jsonStr))\n    req.Header.Set(\"Authorization\", \"AUTH_TOKEN\")\n    req.Header.Set(\"enctype\", \"multipart/form-data\")\n\n    client := &amp;http.Client{}\n    resp, err := client.Do(req)\n    if err != nil {\n      panic(err)\n    }\n    defer resp.Body.Close()\n\n    fmt.Println(\"response Status:\", resp.Status)\n    fmt.Println(\"response Headers:\", resp.Header)\n    body, _ := ioutil.ReadAll(resp.Body)\n    fmt.Println(\"response Body:\", string(body))\n    fmt.Printf(\"%#v\", c);\n  }\n</code></pre>\n"}, {"tags": ["go", "main", "process.start"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1505799803, "creation_date": 1505799803, "answer_id": 46292665, "question_id": 46292604, "link": "https://stackoverflow.com/questions/46292604/go-main-function-not-operated-first/46292665#46292665", "title": "Go main function not operated first", "body": "<p>The <a href=\"https://golang.org/ref/spec#Package_initialization\" rel=\"nofollow noreferrer\">specification says</a>:</p>\n\n<blockquote>\n  <p>If a package has imports, the imported packages are initialized before initializing the package itself.</p>\n</blockquote>\n\n<p>and </p>\n\n<blockquote>\n  <p>Program execution begins by initializing the main package and then invoking the function main.</p>\n</blockquote>\n\n<p>It follows that the <a href=\"https://github.com/shirou/gopsutil/blob/084e5f47b47ee4dce70b1cafa83c13027e9e9483/cpu/cpu.go#L55-L61\" rel=\"nofollow noreferrer\">initialization code</a> in the imported <code>cpu</code> package is executed before any code in <code>main</code>.</p>\n"}], "owner": {"reputation": 7, "user_id": 5783176, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/88f95b7ea0b6ee22a1b175b994dfc59d?s=128&d=identicon&r=PG&f=1", "display_name": "\uc5fc\uacbd\ud6c8", "link": "https://stackoverflow.com/users/5783176/%ec%97%bc%ea%b2%bd%ed%9b%88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1505799803, "creation_date": 1505799475, "last_edit_date": 1592644375, "question_id": 46292604, "link": "https://stackoverflow.com/questions/46292604/go-main-function-not-operated-first", "title": "Go main function not operated first", "body": "<pre><code>package main\nimport (\n    &quot;bytes&quot;\n    &quot;encoding/json&quot;\n    &quot;io/ioutil&quot;\n    &quot;log&quot;\n    &quot;net/http&quot;\n    &quot;os&quot;\n    &quot;os/signal&quot;\n    &quot;strings&quot;\n    &quot;unicode/utf8&quot;\n    &quot;sync&quot;\n    &quot;github.com/robfig/cron&quot;\n     cpu &quot;github.com/shirou/gopsutil/cpu&quot;\n    &quot;fmt&quot;\n)\n\nconst NumofResource = 4\n\n// \uad6c\uc870\uccb4\ntype HostInfo struct {\n    Hostid string\n}\n\nvar c *cron.Cron\nvar lastCPUTimes []cpu.TimesStat\n\nfunc main() {\n    fmt.Println(&quot;1.main.go &gt; main() start&quot;)\n    defer l4g.Close()\n\nvar err interface{}\nlastCPUTimes, err = cpu.Times(false) //nil\nfmt.Println(&quot;2.main.go &gt; err&quot;, err)\nfmt.Println(&quot;3.main.go &gt; lastCPUTimes&quot;, lastCPUTimes)\n\nif err != nil {\n    l4g.Error(err)\n}\n}\n</code></pre>\n<p>I know that the main function is executed first.\nHowever, we confirmed that the library called cpu_windows.go is executed first.\nWhy?</p>\n<blockquote>\n<p>cpu_windows.go : Times(bool) false</p>\n<p>cpu_windows.go : common.ProcGetSystemTimes.Call  1</p>\n<p>cpu_windows.go : Times(bool) true</p>\n<p>cpu_windows.go : return perCPUTimes()</p>\n<p>1.main.go : main() start</p>\n<p>cpu_windows.go : Times(bool) false</p>\n<p>cpu_windows.go : common.ProcGetSystemTimes.Call  1</p>\n<p>2.main.go : err </p>\n</blockquote>\n"}, {"tags": ["go", "byte"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1505800669, "last_edit_date": 1505800669, "creation_date": 1505800310, "answer_id": 46292776, "question_id": 46292602, "link": "https://stackoverflow.com/questions/46292602/how-to-convert-a-single-character-to-a-single-byte/46292776#46292776", "title": "How to convert a single character to a single byte?", "body": "<p>The <a href=\"https://golang.org/ref/spec#Rune_literals\" rel=\"nofollow noreferrer\">rune literal</a> <code>'?'</code> is the untyped integer value of the question mark rune.</p>\n\n<p>Use <a href=\"https://godoc.org/bytes#ContainsRune\" rel=\"nofollow noreferrer\">bytes.ContainsRune</a>:</p>\n\n<pre><code>if bytes.ContainsRune(readBuf[:n], '?') {\n   return true\n}\n</code></pre>\n\n<p>Because the character <code>?</code> is encoded as a single byte in UTF-8, the test can also be written as:</p>\n\n<pre><code>for _, b := range readBuf[:n] {\n    if b =='?'{   \n        return true\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1615, "user_id": 3000014, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/862c2edb8707ea662df19224baeb48e0?s=128&d=identicon&r=PG&f=1", "display_name": "bkr879", "link": "https://stackoverflow.com/users/3000014/bkr879"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1344, "favorite_count": 0, "accepted_answer_id": 46292776, "answer_count": 1, "score": 0, "last_activity_date": 1505800669, "creation_date": 1505799471, "last_edit_date": 1505799980, "question_id": 46292602, "link": "https://stackoverflow.com/questions/46292602/how-to-convert-a-single-character-to-a-single-byte", "title": "How to convert a single character to a single byte?", "body": "<p>I am trying to check if a given character is present in a byte:</p>\n\n<pre><code>//readBuf: []byte\n//n: int\nfor i:=0;i&lt;n;i++{\n    if readBuf[i]==\"?\"{\n        return true\n    }\n}\n</code></pre>\n\n<p>\"?\" is of type string, so I am getting an error, since readBuf[i] is a byte. How can I convert \"?\" to a byte to be able to compare it to readBuf[i]?</p>\n\n<p>It seems that []byte(\"?\")[0] is working (convert the 1-element string to 1-element byte array, the extract the first value), but I am sure this is not the correct way of doing it.</p>\n"}, {"tags": ["sql", "go", "interface", "cql"], "answers": [{"tags": [], "owner": {"reputation": 183, "user_id": 1190149, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f423c8bed516d3c83e4d0c92753a4dcc?s=128&d=identicon&r=PG", "display_name": "Jesse Walton", "link": "https://stackoverflow.com/users/1190149/jesse-walton"}, "is_accepted": false, "score": 1, "last_activity_date": 1505798450, "creation_date": 1505798450, "answer_id": 46292386, "question_id": 46291389, "link": "https://stackoverflow.com/questions/46291389/go-sql-scan-value-interface-issue/46292386#46292386", "title": "Go SQL Scan/Value Interface Issue", "body": "<p>The value was already structured as a byte array, so the solution ended up being:</p>\n\n<pre><code>fmt.Sprintf(\"%s\", sv) \n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 1190149, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f423c8bed516d3c83e4d0c92753a4dcc?s=128&d=identicon&r=PG", "display_name": "Jesse Walton", "link": "https://stackoverflow.com/users/1190149/jesse-walton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505798450, "creation_date": 1505792317, "question_id": 46291389, "link": "https://stackoverflow.com/questions/46291389/go-sql-scan-value-interface-issue", "title": "Go SQL Scan/Value Interface Issue", "body": "<p>I am attempting to add a scan/value interface for automatic conversion for my custom structs. I was also able to implement both Value() and Scan() on a bool type, but when trying to implement it on something with a gocql.UUID field, I can't get the Scan() to work. </p>\n\n<p>Any suggestions would be very much appreciated!</p>\n\n<p>Short Example:</p>\n\n<pre><code>type Uid struct {\n    gocql.UUID\n}\n\nfunc (u *Uid) Scan(value interface{}) error {\n    ...\n    if sv, err := driver.String.ConvertValue(value); err == nil {\n    if v, ok := sv.(string); ok { // &lt;---  THIS DOESN'T WORK\n        parsedUUID, _ := gocql.ParseUUID(v)\n        ...\n    }\n}\n</code></pre>\n\n<p>Full code:\n<a href=\"https://play.golang.org/p/ndCZTJZ5rb\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ndCZTJZ5rb</a></p>\n"}, {"tags": ["rest", "go", "packages"], "comments": [{"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "edited": false, "score": 0, "creation_date": 1505783960, "post_id": 46290294, "comment_id": 79543612, "body": "Paste the complete error into the question. And also the location of your myproj folder inside of your GOPATH"}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "edited": false, "score": 0, "creation_date": 1505784605, "post_id": 46290294, "comment_id": 79543777, "body": "It&#39;s saying that GetPortAndURL is undefined. Have you defined that?"}, {"owner": {"reputation": 310, "user_id": 4317190, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/91ead7da4d55ff9f56f05a9a8a27bf85?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cheek", "link": "https://stackoverflow.com/users/4317190/tyler-cheek"}, "edited": false, "score": 0, "creation_date": 1505784736, "post_id": 46290294, "comment_id": 79543810, "body": "Yes, I&#39;ve defined it as a function in util.go. I&#39;ve edited my question to reflect the method as well."}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "edited": false, "score": 1, "creation_date": 1505785081, "post_id": 46290294, "comment_id": 79543888, "body": "If the code here is the same as in your project the issue is that the function is called <code>GetPortandURL</code> in package util but you are calling function <code>GetPortAndURL</code> with a capital <code>A</code>."}, {"owner": {"reputation": 310, "user_id": 4317190, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/91ead7da4d55ff9f56f05a9a8a27bf85?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cheek", "link": "https://stackoverflow.com/users/4317190/tyler-cheek"}, "edited": false, "score": 0, "creation_date": 1505785455, "post_id": 46290294, "comment_id": 79543979, "body": "This is the correct answer. Why did go alert me that &quot;util in util.GetPortAndURL is undefined&quot; instead of &quot;GetPortandURL in util.GetPortAndURL is undefined&quot;?"}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "edited": false, "score": 3, "creation_date": 1505785692, "post_id": 46290294, "comment_id": 79544043, "body": "@TylerCheek The error as you put it in the question is correct. It doesn&#39;t says &#39;package util&#39; is undefined, it says &#39;undefined: util.GetPortAndURL&#39; that is the function <code>GetPortAndURL</code> in package <code>util</code>. Otherwise it would be unclear to which function it is referring as 2 packages can have a function with the same name."}], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 6641502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ECGH4.jpg?s=128&g=1", "display_name": "Korede Aderele", "link": "https://stackoverflow.com/users/6641502/korede-aderele"}, "is_accepted": false, "score": 0, "last_activity_date": 1505851597, "creation_date": 1505851597, "answer_id": 46308938, "question_id": 46290294, "link": "https://stackoverflow.com/questions/46290294/why-does-a-go-package-show-up-as-undefined/46308938#46308938", "title": "Why does a Go package show up as undefined?", "body": "<p>Call it as <code>port, url := GetPortAndURL()</code>. I don't believe it needs the \"util.\" package prefix if util.go (the definition) is in the same package.</p>\n"}], "owner": {"reputation": 310, "user_id": 4317190, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/91ead7da4d55ff9f56f05a9a8a27bf85?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cheek", "link": "https://stackoverflow.com/users/4317190/tyler-cheek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505851597, "creation_date": 1505783520, "last_edit_date": 1505785286, "question_id": 46290294, "link": "https://stackoverflow.com/questions/46290294/why-does-a-go-package-show-up-as-undefined", "title": "Why does a Go package show up as undefined?", "body": "<p>I'm having trouble understanding what the issue is with my code below. The Visual Studio Code compiler is giving me errors such as the following because the package \"util\" is undefined.</p>\n\n<pre><code>'Error' message: 'undefined: util.GetPortAndURL\n</code></pre>\n\n<p>I'm placing the following at the top of my util.go file</p>\n\n<pre><code>package util\n</code></pre>\n\n<p>I'm also importing the package myproj/util in my handlers.go file, which is the one calling the below code in its init method. </p>\n\n<pre><code>file, err := ioutil.ReadFile(\"./creds.json\")\nif err != nil {\n    fmt.Printf(\"File error: %v\\n\", err)\n    // use a better error pattern here\n}\njson.Unmarshal(file, &amp;oathCred)\nport, url := util.GetPortAndURL() &lt;-------- Here\nif (port != nil) &amp;&amp; (url != nil) {\n    oathConf = &amp;oauth2.Config{\n        ClientID:     oathCred.ClientID,\n        ClientSecret: oathCred.ClientSecret,\n        RedirectURL:  url + \":\" + string(port) + \"/auth\",\n        Scopes: []string{\n            \"https://www.googleapis.com/auth/userinfo.email\", // You have to select your own scope from here -&gt; https://developers.google.com/identity/protocols/googlescopes#google_sign-in\n        },\n        Endpoint: google.Endpoint,\n    }\n}\n</code></pre>\n\n<p>The getPortAndURL() function is in util.go and is as follows</p>\n\n<pre><code>// GetPortandURL returns the URL and Port currently used\n/*\n'\nThis function should be used to set the port and url for the program until a\nset function is created.\n'\n*/\nfunc GetPortandURL() (int, string) {\n    port := 8080\n    url := \"http://127.0.0.1\"\n    return port, url\n}\n</code></pre>\n\n<p>My GOPATH is C:\\Users\\Me\\Documents\\code\\go</p>\n\n<p>The file structure is as follows</p>\n\n<pre><code>go/src/\n\u2514\u2500\u2500 myproj\n    \u251c\u2500\u2500 handlers\n    \u251c\u2500\u2500 main\n    \u2514\u2500\u2500 util\n</code></pre>\n"}, {"tags": ["nginx", "go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 3, "last_activity_date": 1505779614, "creation_date": 1505779614, "answer_id": 46289827, "question_id": 46289816, "link": "https://stackoverflow.com/questions/46289816/go-using-environment-variables-in-if-statement-in-template/46289827#46289827", "title": "Go: Using environment variables in if statement in Template", "body": "<p>Change</p>\n\n<pre><code> {{ if eq ({{envOrKey \"IS_CUSTOMER\"}}) \"true\" }}\n</code></pre>\n\n<p>to</p>\n\n<pre><code> {{ if eq (envOrKey \"IS_CUSTOMER\") \"true\" }}\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 4178878, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eed651dfdf330bf5605e464b3fa2d49f?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar Kalburgi", "link": "https://stackoverflow.com/users/4178878/sagar-kalburgi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1327, "favorite_count": 0, "accepted_answer_id": 46289827, "answer_count": 1, "score": 1, "last_activity_date": 1505779614, "creation_date": 1505779507, "question_id": 46289816, "link": "https://stackoverflow.com/questions/46289816/go-using-environment-variables-in-if-statement-in-template", "title": "Go: Using environment variables in if statement in Template", "body": "<p>Below is a Go template code that I am using for NGINX configuration. In the nested if statement, I am trying to check if the value of the environment variable IS_CUSTOMER is equal to \"true\".</p>\n\n<pre><code> {{ if eq .instanceName \"apple\" }}\n       {{ if eq ({{envOrKey \"IS_CUSTOMER\"}}) \"true\" }}\n         listen  127.0.0.1:{{.port}};\n       {{else}}\n         listen  {{.bindAddress}}:{{.port}};\n       {{end}}\n     {{else}}\n         listen  {{.bindAddress}}:{{.port}};\n     {{end}}\n     listen  443 ssl ;\n</code></pre>\n\n<p>But when I execute the template, I am getting the following error:</p>\n\n<pre><code>tenanttemplate.tmpl:13: unexpected \\\"{\\\" in operand\" \n</code></pre>\n\n<p>I went through online documentation of Go template and some other answers on Stack overflow, it didn't help.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "is_accepted": false, "score": 1, "last_activity_date": 1505779372, "creation_date": 1505779372, "answer_id": 46289798, "question_id": 46288812, "link": "https://stackoverflow.com/questions/46288812/golang-check-if-javascript-is-enabled/46289798#46289798", "title": "golang check if javascript is enabled", "body": "<p>It is not possible to do that in Golang since it is a server side language. I don't even think it is possible with JavaScript.</p>\n\n<p>It is not something you can add/set/get from the headers.</p>\n\n<p>What you are trying to do is check browser specific flags.</p>\n\n<p>You might be able to find third party libraries used to manage Chrome flags or Firefox flags etc. That is your best option.</p>\n"}], "owner": {"reputation": 65, "user_id": 8629072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5731c78f87782981828c2e3b18f5fb?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano Conte", "link": "https://stackoverflow.com/users/8629072/stefano-conte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505779372, "creation_date": 1505772139, "last_edit_date": 1505773030, "question_id": 46288812, "link": "https://stackoverflow.com/questions/46288812/golang-check-if-javascript-is-enabled", "title": "golang check if javascript is enabled", "body": "<p>this is my actual code :</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"net/http/httputil\"\n    \"net/url\"\n)\n\nconst BaseUrl = \"http://127.0.01:5000\"\nconst ListeningPort = \"80\"\n\nfunc main() {\n    // intercept call\n    http.HandleFunc(\"/test\", Test)\n\n    // all other traffic pass on\n    http.HandleFunc(\"/\", ProxyFunc)\n    http.ListenAndServe(\":\"+ListeningPort, nil)\n}\n\nfunc ProxyFunc(w http.ResponseWriter, r *http.Request) {\n    u, err := url.Parse(BaseUrl)\n    if err != nil {\n        w.Write([]byte(err.Error()))\n        return\n    }\n\n    proxy := httputil.NewSingleHostReverseProxy(u)\n    proxy.ServeHTTP(w, r)\n}\n\nfunc Test(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"TEST\"))\n}\n</code></pre>\n\n<p>first to accept client connexion, i want to check if browser have enabled javascript, how i can do this in my actual code ?</p>\n\n<p>i want check with this method :\n<a href=\"https://pastebin.com/ZASFQumf\" rel=\"nofollow noreferrer\">https://pastebin.com/ZASFQumf</a></p>\n"}, {"tags": ["curl", "go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1505771114, "post_id": 46288611, "comment_id": 79540439, "body": "Check <a href=\"https://golang.org/src/net/http/client.go\" rel=\"nofollow noreferrer\">golang.org/src/net/http/client.go</a> <code>redirectBehavior</code>, so yes, it&#39;s by default."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1505771335, "post_id": 46288611, "comment_id": 79540512, "body": "Gotcha so to be redundant, a generic Go requests implies <code>curl -L</code> behavior."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1505772543, "post_id": 46288611, "comment_id": 79540864, "body": "Yes. And I don&#39;t see a way to disable it even if you wanted."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 4, "creation_date": 1505802615, "post_id": 46288611, "comment_id": 79549108, "body": "@zerkms To disable following redirects, set a <a href=\"https://godoc.org/net/http#Client.CheckRedirect\" rel=\"nofollow noreferrer\">check redirect</a> function that returns <a href=\"https://godoc.org/net/http#ErrUseLastResponse\" rel=\"nofollow noreferrer\">ErrUseLastResponse</a>."}], "owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 239, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505772709, "creation_date": 1505770886, "last_edit_date": 1505772709, "question_id": 46288611, "link": "https://stackoverflow.com/questions/46288611/whats-the-equivalent-of-curl-l-in-go", "title": "What&#39;s the equivalent of curl -L in Go?", "body": "<p>I've got a curl request that exhibits expected behavior when executed via the command line. But when I try to make that same request in my Go program I'm getting what looks like a weird redirect. \nHere's the curl request: </p>\n\n<pre><code>curl -L -H \"Accept: application/json\" -H \"Authorization: redacted\" -d \"zip_url=value?&amp;env_id=value&amp;autocreate=true&amp;\" https://redacted\n</code></pre>\n\n<p>Here's the Go code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>payload.Set(\"zip_url\", value)\npayload.Set(\"env_id\", value)\npayload.Set(\"autocreate\", \"true\")\npayload.Set(\"orgGuid\", value)\npayload.Set(\"spaceGuid\", value)\nencodedPayload := payload.Encode()\nclient := http.Client{}\nreq, err := http.NewRequest(\"POST\", d.apiEndpoint, bytes.NewBufferString(encodedPayload))\nif err != nil {\n    fmt.Println(\"Error: \", err.Error())\n}\nreq.Header.Set(\"Content-Type\", \"application/x-www-form-urlencoded\")\nreq.Header.Set(\"Authorization\", redacted)\nreq.Header.Set(\"Accept\", \"application/json\")\nresp, err := client.Do(req)\n</code></pre>\n\n<p>I'm wondering if there's anything special I need to do in order to get the same behavior as curl's <code>-L</code> option, my understand of Go is that it follows redirects by default. </p>\n"}, {"tags": ["go", "glide-golang"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1505768419, "post_id": 46287984, "comment_id": 79539381, "body": "it looks like your code isn&#39;t in GOPATH. It may also be because you&#39;re trying to build a single file rather than the package itself."}, {"owner": {"reputation": 786, "user_id": 915946, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8058574172fc6832970e51811264bad5?s=128&d=identicon&r=PG", "display_name": "rubio", "link": "https://stackoverflow.com/users/915946/rubio"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505826286, "post_id": 46287984, "comment_id": 79564778, "body": "My code is in <code>&#47;Users&#47;myuser&#47;go&#47;src&#47;goserver</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505877849, "post_id": 46287984, "comment_id": 79587272, "body": "You&#39;re trying to use a relative import path, those are not allowed in packages within GOPATH."}, {"owner": {"reputation": 786, "user_id": 915946, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8058574172fc6832970e51811264bad5?s=128&d=identicon&r=PG", "display_name": "rubio", "link": "https://stackoverflow.com/users/915946/rubio"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505920163, "post_id": 46287984, "comment_id": 79612006, "body": "So for importing <code>&quot;github.com&#47;gorilla&#47;mux&quot;</code> i need to have the full path?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505922970, "post_id": 46287984, "comment_id": 79614171, "body": "No, you are trying to import a package via a relative path -- possibly <code>main.go</code> is importing <code>&quot;.&#47;goserver&quot;</code> or something similar."}, {"owner": {"reputation": 786, "user_id": 915946, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8058574172fc6832970e51811264bad5?s=128&d=identicon&r=PG", "display_name": "rubio", "link": "https://stackoverflow.com/users/915946/rubio"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505998683, "post_id": 46287984, "comment_id": 79649055, "body": "@JimB It was the relative import. Do you want to add that as an answer? I will mark it as correct once you do."}], "owner": {"reputation": 786, "user_id": 915946, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8058574172fc6832970e51811264bad5?s=128&d=identicon&r=PG", "display_name": "rubio", "link": "https://stackoverflow.com/users/915946/rubio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 540, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553444880, "creation_date": 1505767791, "last_edit_date": 1553444880, "question_id": 46287984, "link": "https://stackoverflow.com/questions/46287984/go-only-looks-in-vendor-directory-if-dependency-is-incorrect", "title": "Go only looks in vendor directory if dependency is incorrect", "body": "<p>Go only looks in my vendor directory if i spell the dependacy wrong. I used glide to add the vendor.</p>\n\n<p>This import is spelled correctly</p>\n\n<pre><code>package goserver\n\nimport (\n    \"net/http\"\n    \"fmt\"\n    \"github.com/gorilla/mux\"\n)\n</code></pre>\n\n<p>The result of a correctly spelled dep. <strong>Go looks in 2 directories and does not look into vendor tree directory</strong></p>\n\n<pre><code>myhost:goserver myuser$ go build main.go \ngo-server/routers.go:6:2: cannot find package \"_/Users/myuser/go/src/goserver/vendor/github.com/gorilla/mux\" in any of:\n    /usr/local/Cellar/go/1.9/libexec/src/_/Users/myuser/go/src/goserver/vendor/github.com/gorilla/mux (from $GOROOT)\n    /Users/myuser/go/src/_/Users/myuser/go/src/goserver/vendor/github.com/gorilla/mux (from $GOPATH)\n</code></pre>\n\n<p>Import is spelled incorrectly</p>\n\n<pre><code>package goserver\n\nimport (\n    \"net/http\"\n    \"fmt\"\n    \"githubwwwww.com/gorilla/mux\"\n)\n</code></pre>\n\n<p>The result of a incorrectly spelled dep. <strong>Go looks into 3 directories and looks into vendor directory</strong></p>\n\n<pre><code> myhost:goserver myuser$ go build main.go \n    go-server/routers.go:6:2: cannot find package \"githubwwwww.com/gorilla/mux\" in any of:\n        /Users/myuser/go/src/goserver/vendor/githubwwwww.com/gorilla/mux (vendor tree)\n        /usr/local/Cellar/go/1.9/libexec/src/githubwwwww.com/gorilla/mux (from $GOROOT)\n        /Users/myuser/go/src/githubwwwww.com/gorilla/mux (from $GOPATH)\n</code></pre>\n\n<p>Proof that gorrila/mux is there</p>\n\n<pre><code>myhost:goserver myuser$ ls /Users/myuser/go/src/goserver/vendor/github.com/gorilla/mux/\nLICENSE         bench_test.go       context_gorilla_test.go context_native_test.go  mux.go          old_test.go     route.go\nREADME.md       context_gorilla.go  context_native.go   doc.go          mux_test.go     regexp.go\n</code></pre>\n\n<p>Go env result</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/myuser/go/\"\nGORACE=\"\"\nGOROOT=\"/usr/local/Cellar/go/1.9/libexec\"\nGOTOOLDIR=\"/usr/local/Cellar/go/1.9/libexec/pkg/tool/darwin_amd64\"\nGCCGO=\"gccgo\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/var/folders/ty/vksmqd9x38vclbmpbnvnqwwh0000gp/T/go-build089246630=/tmp/go-build -gno-record-gcc-switches -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\nPKG_CONFIG=\"pkg-config\"\n</code></pre>\n"}, {"tags": ["go", "macos-sierra", "goland"], "answers": [{"comments": [{"owner": {"reputation": 1844, "user_id": 5052651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206988837307468/picture?type=large", "display_name": "Arthur Zagretdinov", "link": "https://stackoverflow.com/users/5052651/arthur-zagretdinov"}, "edited": false, "score": 0, "creation_date": 1505768949, "post_id": 46286569, "comment_id": 79539649, "body": "Thank for answer! I was thinking that I used up-date version, because JetBrains Tool showed me that everything was updated. But when I double-checked, I found out that I started previous version instead the latest."}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 0, "last_activity_date": 1505761897, "creation_date": 1505761897, "answer_id": 46286569, "question_id": 46286362, "link": "https://stackoverflow.com/questions/46286362/cannot-start-debug-in-gogland-1-0-eap-on-macos-sierra/46286569#46286569", "title": "Cannot start debug in Gogland 1.0 EAP on macOS Sierra", "body": "<p>You are using an old version of the IDE, please upgrade to the latest one and it will work as expected. </p>\n\n<p>For reference, this issue was addressed in EAP 13 / 14 (which is the latest), see the original issue here: <a href=\"https://youtrack.jetbrains.com/issue/GO-4430\" rel=\"nofollow noreferrer\">https://youtrack.jetbrains.com/issue/GO-4430</a></p>\n"}], "owner": {"reputation": 1844, "user_id": 5052651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206988837307468/picture?type=large", "display_name": "Arthur Zagretdinov", "link": "https://stackoverflow.com/users/5052651/arthur-zagretdinov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 46286569, "answer_count": 1, "score": 0, "last_activity_date": 1505761897, "creation_date": 1505761013, "question_id": 46286362, "link": "https://stackoverflow.com/questions/46286362/cannot-start-debug-in-gogland-1-0-eap-on-macos-sierra", "title": "Cannot start debug in Gogland 1.0 EAP on macOS Sierra", "body": "<p>I've switched to Go not so long ago. I've chosen JetBrains Gogland as IDE. I like both: Go and IDE, except a one issue. I don't know whether it is an issue with IDE or with Go lang configuration on macOS Sierra. But when I'm trying start debuging for a test from Gogland, the build fails with message: </p>\n\n<pre><code>GOROOT=/usr/local/go\nGOPATH=/Users/username/project/go\n/usr/local/go/bin/go test -c -i -o /private/var/folders/3b/hlrss45s1p93cgtq9xgsw4gh0000gn/T/All_in__bitbucket_org_ username_package_matrix_go -gcflags \"-N -l\" -a bitbucket.org/usaername/package/matrix\ngo install runtime/internal/sys: open /usr/local/go/pkg/darwin_amd64/runtime/internal/sys.a: permission denied\n</code></pre>\n\n<p>I use Go 1.9</p>\n\n<pre><code>$ go version\ngo version go1.9 darwin/amd64\n$ go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/azagretdinov/project/go\"\nGORACE=\"\"\nGOROOT=\"/usr/local/Cellar/go/1.9/libexec\"\nGOTOOLDIR=\"/usr/local/Cellar/go/1.9/libexec/pkg/tool/darwin_amd64\"\nGCCGO=\"gccgo\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/var/folders/3b/hlrss45s1p93cgtq9xgsw4gh0000gn/T/go-build006508560=/tmp/go-build -gno-record-gcc-switches -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\nPKG_CONFIG=\"pkg-config\"\n</code></pre>\n\n<p>Information about Gogland</p>\n\n<pre><code>Gogland (1.0 Preview) 1.0 EAP\nBuild #GO-172.3757.46, built on August 11, 2017\nGogland EAP User\nExpiration date: November 9, 2017\nJRE: 1.8.0_152-release-915-b10 x86_64\nJVM: OpenJDK 64-Bit Server VM by JetBrains s.r.o\nMac OS X 10.12.6\n</code></pre>\n"}, {"tags": ["c", "docker", "logging", "go"], "comments": [{"owner": {"reputation": 133, "user_id": 8511579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/857381adc3966b094ee29d3987dafa03?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Tustanowski", "link": "https://stackoverflow.com/users/8511579/jakub-tustanowski"}, "edited": false, "score": 0, "creation_date": 1505756367, "post_id": 46285216, "comment_id": 79533462, "body": "I am new to go and I am not a sole creator of that code. However, I welcome all critical comments on the quality of the code."}, {"owner": {"reputation": 1435, "user_id": 180656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c91c0ae420dcaf04e5e9061be6a93c?s=128&d=identicon&r=PG", "display_name": "Josef Grahn", "link": "https://stackoverflow.com/users/180656/josef-grahn"}, "edited": false, "score": 0, "creation_date": 1506071949, "post_id": 46285216, "comment_id": 79681872, "body": "On code quality: There is no validation of the input argument. <code>os.Args[1]</code> might not exist, for example. Moreover, you could use <code>os.Mkdir</code> or <code>os.MkdirAll</code> rather than calling the shell."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1506522376, "post_id": 46285216, "comment_id": 79856542, "body": "If that echo statement really makes a difference, it might indicate that docker is line-buffering stderr. Perhaps it does the same with stdout. Can you add the C source file to your question?"}, {"owner": {"reputation": 133, "user_id": 8511579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/857381adc3966b094ee29d3987dafa03?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Tustanowski", "link": "https://stackoverflow.com/users/8511579/jakub-tustanowski"}, "edited": false, "score": 0, "creation_date": 1506522674, "post_id": 46285216, "comment_id": 79856737, "body": "I don&#39;t have a static C source file - the program shall read it via http. I&#39;ve experimented with printf and fprintf(stderr) so far."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1506523238, "post_id": 46285216, "comment_id": 79857162, "body": "Share your experiment. It&#39;s a crucial puzzle piece. You leave us guessing as to what the C programm does. For instance, if it is not writing a newline it supports my hypothesis about line-buffering. For all we know it might not even write to stdout."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1506524009, "post_id": 46285216, "comment_id": 79857723, "body": "By the way, don&#39;t use client supplied filenames when writing files. You are wide open to path traversal issues. E.g., I could simply name my file &quot;../etc/passwd&quot;; you get the point. Consider using ioutil.TempFile. <a href=\"https://golang.org/pkg/io/ioutil/#TempFile\" rel=\"nofollow noreferrer\">golang.org/pkg/io/ioutil/#TempFile</a>"}, {"owner": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "edited": false, "score": 0, "creation_date": 1506529320, "post_id": 46285216, "comment_id": 79861234, "body": "What happens if you disable IO buffering in your script. <code>stdbuf -o0 -e0 gcc -Wall $F00  -o hello &amp;&amp; stdbuf -o0 -e0 .&#47;hello</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2422, "user_id": 2622394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d36f32e6280af5bb307cead90e3844f?s=128&d=identicon&r=PG", "display_name": "lmars", "link": "https://stackoverflow.com/users/2622394/lmars"}, "is_accepted": true, "score": 1, "last_activity_date": 1506124924, "creation_date": 1506124924, "answer_id": 46374722, "question_id": 46285216, "link": "https://stackoverflow.com/questions/46285216/cant-reach-stdout-from-docker-using-go-client/46374722#46374722", "title": "Can&#39;t reach stdout from Docker using Go client", "body": "<p>You should consider running the Docker CLI as a separate process and just reading its stdout and stderr, for example:</p>\n\n<pre><code>cmd := exec.Command(\"docker\", \"run\", \"-v=&lt;volumes-to-mount&gt;\", \"&lt;image&gt;\")\nout, err := cmd.CombinedOutput()\nif err != nil {\n    return err\n}\n// `out` now contains the combined stdout / stderr from Docker\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8682353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b8f854d3821b6a4c3b36dc91825544d?s=128&d=identicon&r=PG", "display_name": "Yonah Russ", "link": "https://stackoverflow.com/users/8682353/yonah-russ"}, "is_accepted": false, "score": 0, "last_activity_date": 1506517578, "creation_date": 1506517578, "answer_id": 46448706, "question_id": 46285216, "link": "https://stackoverflow.com/questions/46285216/cant-reach-stdout-from-docker-using-go-client/46448706#46448706", "title": "Can&#39;t reach stdout from Docker using Go client", "body": "<p>I'm not familiar with the Go but the code seems to be reading from the docker log stream. It could be that your Docker daemon is configured to use a different log driver. The docker logs command is not available for drivers other than json-file and journald. You can check with the following command:</p>\n\n<pre><code>$ docker info |grep 'Logging Driver'\n</code></pre>\n\n<p>You can change the logging driver on a per container basis like so:</p>\n\n<pre><code>$ docker run -it --log-driver json-file &lt;image&gt; &lt;command&gt;\n</code></pre>\n\n<p>You should be able to pass this parameter via the api when creating the container as well.</p>\n"}, {"tags": [], "owner": {"reputation": 399, "user_id": 8264607, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WQKpnhD7pmQ/AAAAAAAAAAI/AAAAAAAAABM/vjTCAvnmiD0/photo.jpg?sz=128", "display_name": "scriptonist", "link": "https://stackoverflow.com/users/8264607/scriptonist"}, "is_accepted": false, "score": 2, "last_activity_date": 1510047715, "creation_date": 1510047715, "answer_id": 47154486, "question_id": 46285216, "link": "https://stackoverflow.com/questions/46285216/cant-reach-stdout-from-docker-using-go-client/47154486#47154486", "title": "Can&#39;t reach stdout from Docker using Go client", "body": "<p>I believe the following method can be used to obtain the <code>stdout</code> and <code>stderr</code> of running containers.</p>\n\n<pre><code>import \"github.com/docker/docker/pkg/stdcopy\"\n</code></pre>\n\n<p>import this package from the docker SDK.</p>\n\n<pre><code>    data, err := cli.ContainerLogs(ctx, resp.ID, types.ContainerLogsOptions{ShowStdout: true, ShowStderr: true})\n    if err != nil {\n        panic(err)\n    }\n</code></pre>\n\n<p>get the logs from the running container and store it to <code>data</code>.Now create two buffers to store the streams.</p>\n\n<pre><code>    // Demultiplex stdout and stderror\n    // from the container logs\n    stdoutput := new(bytes.Buffer)\n    stderror := new(bytes.Buffer)\n</code></pre>\n\n<p>now use the imported <code>stdcopy</code> to save the two streams to the buffers.</p>\n\n<pre><code>    stdcopy.StdCopy(stdoutput, stderror, data)\n    if err != nil {\n        panic(err)\n    }\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 8511579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/857381adc3966b094ee29d3987dafa03?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Tustanowski", "link": "https://stackoverflow.com/users/8511579/jakub-tustanowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2439, "favorite_count": 3, "accepted_answer_id": 46374722, "answer_count": 3, "score": 8, "last_activity_date": 1510047715, "creation_date": 1505756267, "last_edit_date": 1505763063, "question_id": 46285216, "link": "https://stackoverflow.com/questions/46285216/cant-reach-stdout-from-docker-using-go-client", "title": "Can&#39;t reach stdout from Docker using Go client", "body": "<p>I have a small project in which my go server copies the C files send by http into Docker containers, where they are compiled and run.\nHowever, I am not able to obtain any data send to stdout in the container.</p>\n\n<p>I have determined that file is sent into Docker container, what's more - any problems with compilation are shown on the error stream. However, sending data through stderr in C program also didn't show any results until I have, playing with Dockerfile, used '>&amp;2 echo \"\"' which somehow pushed data through the stream and I was able to read it.</p>\n\n<p>Right now, as mentioned above, I can only read stderr and solely thanks to a workaround. Any idea why I can't do it using standard methods?</p>\n\n<p><em>Go server</em></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"io\"\n    \"os\"\n    \"os/exec\"\n    \"log\"\n    \"encoding/json\"\n\n    \"github.com/docker/docker/client\"\n    dockertypes \"github.com/docker/docker/api/types\"\n    \"github.com/docker/docker/api/types/container\"\n    \"golang.org/x/net/context\"\n    \"time\"\n    \"bytes\"\n)\n\ntype Result struct {\n    CompilationCode int\n    RunCode int\n    TestsPositive int\n    TestsTotal int\n}\n\nfunc upload(w http.ResponseWriter, r *http.Request) {\n    log.Println(\"method:\", r.Method)\n    if r.Method == \"POST\" {\n        log.Println(\"Processing new SUBMISSION.\")\n        // https://github.com/astaxie/build-web-application-with-golang/blob/master/de/04.5.md\n        r.ParseMultipartForm(32 &lt;&lt; 20)\n        file, handler, err := r.FormFile(\"file\")\n        if err != nil {\n            fmt.Println(err)\n            return\n        }\n\n        defer file.Close()\n        baseName:= os.Args[1]\n        f, err := os.OpenFile(baseName+handler.Filename, os.O_WRONLY|os.O_CREATE, 777)\n        if err != nil {\n            fmt.Println(err)\n            return\n        }\n        defer f.Close()\n        io.Copy(f, file)\n        if err != nil {\n            fmt.Println(err)\n            return\n        }\n\n        compilationCode, runCode, testsPositive, testsTotal := processWithDocker(baseName + handler.Filename, handler.Filename)\n\n        result := Result{\n            CompilationCode: compilationCode,\n            RunCode: runCode,\n            TestsPositive:testsPositive,\n            TestsTotal:testsTotal,\n        }\n        resultMarshaled, _ := json.Marshal(result)\n        w.Write(resultMarshaled)\n    } else {\n        w.Write([]byte(\"GO server is active. Use POST to submit your solution.\"))\n    }\n}\n\n// there is assumption that docker is installed where server.go is running\n// and the container is already pulled\n// TODO: handle situation when container is not pulled\n// TODO: somehow capture if compilation wasn't successful and\n// TODO: distinguish it from possible execution / time limit / memory limit error\n// http://stackoverflow.com/questions/18986943/in-golang-how-can-i-write-the-stdout-of-an-exec-cmd-to-a-file\n\nfunc processWithDocker(filenameWithDir string, filenameWithoutDir string) (int, int, int, int) {\n\n    ctx, cancel := context.WithTimeout(context.Background(), 10*time.Second)\n    defer cancel()\n    cli, err := client.NewEnvClient()\n    if err != nil {\n        panic(err)\n    }\n\n    var hostVolumeString = filenameWithDir\n    var hostConfigBindString = hostVolumeString  + \":/WORKING_FOLDER/\" + filenameWithoutDir\n\n    var hostConfig = &amp;container.HostConfig{\n        Binds: []string{hostConfigBindString},\n    }\n\n    resp, err := cli.ContainerCreate(ctx, &amp;container.Config{\n        Image: \"tusty53/ubuntu_c_runner:twelfth\",\n        Env: []string{\"F00=\" + filenameWithoutDir},\n        Volumes: map[string]struct{}{\n            hostVolumeString: struct{}{},\n        },\n    }, hostConfig, nil, \"\")\n    if err != nil {\n        panic(err)\n    }\n\n    if err := cli.ContainerStart(ctx, resp.ID, dockertypes.ContainerStartOptions{}); err != nil {\n        panic(err)\n    }\n\n    fmt.Println(resp.ID)\n\n    var exited = false\n\n    for !exited {\n\n        json, err := cli.ContainerInspect(ctx, resp.ID)\n        if err != nil {\n            panic(err)\n        }\n\n        exited = json.State.Running\n\n        fmt.Println(json.State.Status)\n    }\n\n    normalOut, err := cli.ContainerLogs(ctx, resp.ID, dockertypes.ContainerLogsOptions{ShowStdout: true, ShowStderr: false})\n    if err != nil {\n        panic(err)\n    }\n\n    errorOut, err := cli.ContainerLogs(ctx, resp.ID, dockertypes.ContainerLogsOptions{ShowStdout: false, ShowStderr: true})\n    if err != nil {\n        panic(err)\n    }\n\n    buf := new(bytes.Buffer)\n    buf.ReadFrom(normalOut)\n    sOut := buf.String()\n\n    buf2 := new(bytes.Buffer)\n    buf2.ReadFrom(errorOut)\n    sErr := buf2.String()\n\n    log.Printf(\"start\\n\")\n    log.Printf(sOut)\n    log.Printf(\"end\\n\")\n\n    log.Printf(\"start error\\n\")\n    log.Printf(sErr)\n    log.Printf(\"end error\\n\")\n\n\n    var testsPositive=0\n    var testsTotal=0\n\n    if(sErr!=\"\"){\n        return 0,0,0,0\n    }\n\n    if(sOut!=\"\"){\n        fmt.Sscanf(sOut, \"%d %d\", &amp;testsPositive, &amp;testsTotal)\n        return 1,1,testsPositive,testsTotal\n    }\n    return 1,0,0,0\n\n}\n\n\n// Creates examine directory if it doesn't exist.\n// If examine directory already exists, then comes an error.\nfunc prepareDir() {\n    cmdMkdir := exec.Command(\"mkdir\", os.Args[1])\n    errMkdir := cmdMkdir.Run()\n    if errMkdir != nil {\n        log.Println(errMkdir)\n    }\n}\n\nfunc main() {\n    prepareDir()\n    go http.HandleFunc(\"/submission\", upload)\n    http.ListenAndServe(\":8123\", nil)\n}\n</code></pre>\n\n<p><em>Dockerfile</em></p>\n\n<pre><code>FROM ubuntu\nENV DEBIAN_FRONTEND noninteractive\nRUN apt-get update &amp;&amp; \\\n    apt-get -y install gcc\nCOPY . /WORKING_FOLDER\nWORKDIR /WORKING_FOLDER\nCMD [\"./chain\"] \n</code></pre>\n\n<p><em>Chain file</em></p>\n\n<pre><code>#!/bin/bash\ngcc -Wall $F00  -o hello\n./hello\n&gt;&amp;2 echo \"\"\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1505753691, "post_id": 46284464, "comment_id": 79532065, "body": "Your laptop is dedicated hardware that is always running. A VM is not necessarily always running. Other VMs are competing for limited resources. When the infrastructure detects your program blocking, it could possibly put the VM to sleep or context switch, which would take it&#39;s own amount of time to wake or context switch back to."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1505754209, "post_id": 46284464, "comment_id": 79532323, "body": "Use the Time methods or time.Since to compare times in go1.9 which will use monotonic times to increase the accuracy (though that still can&#39;t take into account the VM not experiencing real time)"}, {"owner": {"reputation": 2705, "user_id": 1501456, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/660e626ccb2d55bc2f3ca14940fb882e?s=128&d=identicon&r=PG", "display_name": "Buzzy", "link": "https://stackoverflow.com/users/1501456/buzzy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505804770, "post_id": 46284464, "comment_id": 79550332, "body": "@JimB I tried that and it didn&#39;t help."}], "answers": [{"tags": [], "owner": {"reputation": 2705, "user_id": 1501456, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/660e626ccb2d55bc2f3ca14940fb882e?s=128&d=identicon&r=PG", "display_name": "Buzzy", "link": "https://stackoverflow.com/users/1501456/buzzy"}, "is_accepted": false, "score": -2, "last_activity_date": 1505812455, "creation_date": 1505812455, "answer_id": 46296419, "question_id": 46284464, "link": "https://stackoverflow.com/questions/46284464/time-sleep-sleeps-for-incorrect-time-on-a-vm/46296419#46296419", "title": "time.Sleep sleeps for incorrect time on a VM", "body": "<p>I eventually came up with the following:</p>\n\n<pre><code>func SleepMilliseconds(duration int, limit int) {\n   startTime := time.Now()\n   tempDuration := duration\n   for {\n      tempDuration = tempDuration / 2\n      time.Sleep(time.Duration(tempDuration) * time.Millisecond)\n      elapsed := int((time.Now().UnixNano() - startTime.UnixNano()) / int64(time.Millisecond))\n      tempDuration = duration - elapsed\n      if tempDuration &lt; limit {\n          break\n      }\n  }\n}\n</code></pre>\n\n<p><strong>Disclaimer: I don't think this is a proper solution nor am I going to use it in my project, I just put it here in the rare case where your life (or production env) is dependent on an immediate solution and you don't know what else to do.</strong></p>\n"}], "owner": {"reputation": 2705, "user_id": 1501456, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/660e626ccb2d55bc2f3ca14940fb882e?s=128&d=identicon&r=PG", "display_name": "Buzzy", "link": "https://stackoverflow.com/users/1501456/buzzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505812455, "creation_date": 1505753364, "last_edit_date": 1505754546, "question_id": 46284464, "link": "https://stackoverflow.com/questions/46284464/time-sleep-sleeps-for-incorrect-time-on-a-vm", "title": "time.Sleep sleeps for incorrect time on a VM", "body": "<p>I am running the following code: <a href=\"https://play.golang.org/p/5bhXs_QulH\" rel=\"nofollow noreferrer\">https://play.golang.org/p/5bhXs_QulH</a></p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"time\"\n)\n\nfunc main() {\n    startTime := time.Now()\n    foo := 0.200\n    fmt.Println(int((time.Now().UnixNano() - startTime.UnixNano()) / int64(time.Millisecond)))\n    time.Sleep(time.Duration(foo*1000) * time.Millisecond)\n    fmt.Println(int((time.Now().UnixNano() - startTime.UnixNano()) / int64(time.Millisecond)))\n}\n</code></pre>\n\n<p>When I run it on my laptop or the playground I get:</p>\n\n<pre><code>0\n200\n</code></pre>\n\n<p>But when I run it on a Virtual Machine (VM) I get:</p>\n\n<pre><code>0\nanything between 150 - 250\n</code></pre>\n\n<p>I am not 100% sure which infrastructure the VM is allocated on but it is an Enterprise infrastructure for the entire company and I think it is VMWare.</p>\n\n<p>Could anyone explain the difference in measurements between a physical machine and a virtual one and how to overcome it and get a consistent sleep time?</p>\n"}, {"tags": ["go", "nan"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 3, "creation_date": 1505753463, "post_id": 46284285, "comment_id": 79531957, "body": "Do you know what floating-point infinity and NaN are?"}, {"owner": {"reputation": 157, "user_id": 4122368, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0638c85a16d9c723cde9fb6aa425bace?s=128&d=identicon&r=PG&f=1", "display_name": "sjtwiv", "link": "https://stackoverflow.com/users/4122368/sjtwiv"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1505753911, "post_id": 46284285, "comment_id": 79532168, "body": "@user2347112 - As I understand it NaN means Not a Number and represents responses to things like 0/0, a number to a negative power or an infinity. Infinity is any number to long to be represented by float. at least this is what my research has lead me to believe so far."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 7, "creation_date": 1505754366, "post_id": 46284285, "comment_id": 79532421, "body": "IsInf tests for positive or negative infinity. IsNaN tests for NaN. If you need one or both of those tests, use the function or functions that do what you need."}, {"owner": {"reputation": 2867, "user_id": 1001395, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/859e6602a10637f67d17a82a0a6ef9d6?s=128&d=identicon&r=PG", "display_name": "Fernando Gonzalez Sanchez", "link": "https://stackoverflow.com/users/1001395/fernando-gonzalez-sanchez"}, "edited": false, "score": 0, "creation_date": 1613968980, "post_id": 46284285, "comment_id": 117230394, "body": "I found  this question, while doing the same exercise for &quot;The Go Programming Langauge&quot; book."}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 1940424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7361fddddbb12ef4a1b4eaab8416c5e7?s=128&d=identicon&r=PG", "display_name": "Michael Albertson", "link": "https://stackoverflow.com/users/1940424/michael-albertson"}, "is_accepted": true, "score": 5, "last_activity_date": 1505766863, "creation_date": 1505766863, "answer_id": 46287784, "question_id": 46284285, "link": "https://stackoverflow.com/questions/46284285/which-is-better-for-testing-for-non-finite-floats-isnan-or-isinf/46287784#46287784", "title": "Which is better for testing for non finite floats IsNaN or IsInf?", "body": "<p>If you only need to account for either infinities, then <code>math.IsInf()</code> should suffice. However, if you need to guard against both infinities and values that are not numbers, you should use both in conjunction.</p>\n\n<p>For more reading on floats: <a href=\"https://en.wikipedia.org/wiki/IEEE_754\" rel=\"noreferrer\">https://en.wikipedia.org/wiki/IEEE_754</a></p>\n\n<p>An example of <code>math.IsNaN()</code> not working for infinite values: <a href=\"https://play.golang.org/p/blHjr8i7p9\" rel=\"noreferrer\">https://play.golang.org/p/blHjr8i7p9</a></p>\n"}, {"comments": [{"owner": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "edited": false, "score": 3, "creation_date": 1505834891, "post_id": 46288799, "comment_id": 79570951, "body": "Expressions can be valid but still produce senseless results (e.g.:  divide-by-zero).  How do you propose to resolve this weirdness without evaluating the whole program?  This is just the halting problem in disguise:  <a href=\"https://en.wikipedia.org/wiki/Halting_problem\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Halting_problem</a>"}, {"owner": {"reputation": 2453, "user_id": 7287271, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh6.googleusercontent.com/-lIchAiYNFGA/AAAAAAAAAAI/AAAAAAAABZQ/iI3fowVrwIM/photo.jpg?sz=128", "display_name": "Carl Thom&#233;", "link": "https://stackoverflow.com/users/7287271/carl-thom%c3%a9"}, "reply_to_user": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "edited": false, "score": 0, "creation_date": 1505892756, "post_id": 46288799, "comment_id": 79593175, "body": "Thanks for downvoting, but division by zero is also an invalid expression that should not compile (or at least produce a runtime error, e.g. NaN)... Are you familiar with mathematical limits? Anyway, smarter programming languages are on the horizon (but unlikely to see mainstream adoption anytime soon). You&#39;ll want to google dependent types and/or total functional programming."}, {"owner": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "edited": false, "score": 2, "creation_date": 1505993801, "post_id": 46288799, "comment_id": 79645616, "body": "the downvote isn&#39;t from me :)  I understand mathematical limits just fine -- do you understand why compile-time analysis cannot do what you would like it to do?  Do you understand how this is just the halting problem in disguise?  Simple example:  <code>1 &#47; randint(0, 10)</code>.  Should this compile?  How about this example:  <code>1 &#47; int(user_input(&quot;enter a digit&quot;))</code>?  Your choices are (a) refuse to compile because you <i>might</i> get a <code>0</code> or (b) produce a <code>NaN</code> if you get a <code>0</code> value at runtime."}, {"owner": {"reputation": 2453, "user_id": 7287271, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh6.googleusercontent.com/-lIchAiYNFGA/AAAAAAAAAAI/AAAAAAAABZQ/iI3fowVrwIM/photo.jpg?sz=128", "display_name": "Carl Thom&#233;", "link": "https://stackoverflow.com/users/7287271/carl-thom%c3%a9"}, "reply_to_user": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "edited": false, "score": 0, "creation_date": 1506174512, "post_id": 46288799, "comment_id": 79718908, "body": "Since you seem interested in the halting problem, you&#39;ll probably enjoy reading about <i>total functional programming</i> and its distinction between data and codata! Anyway, you&#39;ll find that many languages are slowly moving towards actually not just letting <code>1 &#47; int(user_input(&quot;enter a digit&quot;))</code> through a compiler without at least some form of explicit error handling (Maybe monads are even common in js these days!)."}, {"owner": {"reputation": 2453, "user_id": 7287271, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh6.googleusercontent.com/-lIchAiYNFGA/AAAAAAAAAAI/AAAAAAAABZQ/iI3fowVrwIM/photo.jpg?sz=128", "display_name": "Carl Thom&#233;", "link": "https://stackoverflow.com/users/7287271/carl-thom%c3%a9"}, "reply_to_user": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "edited": false, "score": 0, "creation_date": 1506174657, "post_id": 46288799, "comment_id": 79718956, "body": "And my whole point is just that NaN is a poor way of handling runtime exceptions, and it primarily lingers on due to legacy."}], "tags": [], "owner": {"reputation": 2453, "user_id": 7287271, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh6.googleusercontent.com/-lIchAiYNFGA/AAAAAAAAAAI/AAAAAAAABZQ/iI3fowVrwIM/photo.jpg?sz=128", "display_name": "Carl Thom&#233;", "link": "https://stackoverflow.com/users/7287271/carl-thom%c3%a9"}, "is_accepted": false, "score": -3, "last_activity_date": 1506375119, "last_edit_date": 1506375119, "creation_date": 1505772089, "answer_id": 46288799, "question_id": 46284285, "link": "https://stackoverflow.com/questions/46284285/which-is-better-for-testing-for-non-finite-floats-isnan-or-isinf/46288799#46288799", "title": "Which is better for testing for non finite floats IsNaN or IsInf?", "body": "<p>Mathematically speaking, it's weird that NaN is a thing in programming because invalid expressions should not compile (unfortunately they do however).</p>\n\n<p>Use <code>math.IsNaN()</code> if your number won't fit on the real line (like sqrt(-1), for example) or if it's mathematically undefined (like 0/0).</p>\n\n<p>Use <code>math.IsInf()</code> if your number might be really large (in either the positive or negative direction) such that you don't have enough bits to represent it, or if it actually should be infinity.</p>\n"}], "owner": {"reputation": 157, "user_id": 4122368, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0638c85a16d9c723cde9fb6aa425bace?s=128&d=identicon&r=PG&f=1", "display_name": "sjtwiv", "link": "https://stackoverflow.com/users/4122368/sjtwiv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1806, "favorite_count": 0, "accepted_answer_id": 46287784, "answer_count": 2, "score": 10, "last_activity_date": 1506375119, "creation_date": 1505752693, "last_edit_date": 1505854327, "question_id": 46284285, "link": "https://stackoverflow.com/questions/46284285/which-is-better-for-testing-for-non-finite-floats-isnan-or-isinf", "title": "Which is better for testing for non finite floats IsNaN or IsInf?", "body": "<p>I need to test for non finite floats and eliminate them. I was planing to use  <code>math.IsInf()</code>  to test the floats but I have seen some ppl using  <code>math.IsNaN()</code>  for this purpose. Is one of these better for this purpose than the other ? and if so why?</p>\n\n<p>edit: This has been put on hold because it is unclear so here is more information that will hopefully clarify the question. I was doing exercise 3.1 from \"The Go Programming Language\" which references this <a href=\"https://github.com/adonovan/gopl.io/blob/master/ch3/surface/main.go\" rel=\"noreferrer\">program</a>. The exercise it asks</p>\n\n<blockquote>\n  <p>If the function f returns a non-finite float64 value, the SVG file will   > contain invalid  elements (although many SVG renderers handle   > this gracefully). Modify the program to skip invalid polygons.</p>\n</blockquote>\n\n<p>I was planing to solve it by adding the following to the corner func</p>\n\n<pre><code>if math.IsInf(z, 0) {\n    return math.NaN(), math.NaN()\n}    \n</code></pre>\n\n<p>and changing the contents of the second for loop in main to</p>\n\n<pre><code>ax, ay := corner(i+1, j)\nif math.IsNaN(ax) {\n    continue\n}\nbx, by := corner(i, j)\nif math.IsNaN(bx) {\n    continue\n}\ncx, cy := corner(i, j+1)\nif math.IsNaN(cx) {\n    continue\n}\ndx, dy := corner(i+1, j+1)\nif math.IsNaN(dx) {\n    continue\n}\nfmt.Printf(\"&lt;polygon points='%g,%g %g,%g %g,%g %g,%g'/&gt;\\n\",\n           ax, ay, bx, by, cx, cy, dx, dy)\n</code></pre>\n\n<p>I wanted to check my work so I decided to look up any answers other ppl had posted online to this problem. No one else that I found had used  <code>math.IsInf()</code>  in there solutions but most had used  <code>math.IsNaN()</code> . This made me wonder if I was missing some something and if  <code>math.IsNaN()</code>  was better for this purpose for some reason. So I looked through the Go Docs for both functions. I looked up NaN on wikipedia and the IEEE 754. I did general web searches for why everyone else was using  <code>math.IsNaN()</code>  even though it seemed less intuitive to me. Then I did searches on here and on stackoverflow for answers after all of that I didn't really have an answer so I decided to post a question.</p>\n"}, {"tags": ["go", "cryptography", "elliptic-curve", "ecdh"], "comments": [{"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1505766880, "post_id": 46283760, "comment_id": 79538704, "body": "I guess somebody that understands the math needs to lift the implementation from a different ECC library. You ask for best practice, but I guess you&#39;re really asking for an implementation."}], "answers": [{"comments": [{"owner": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "edited": false, "score": 3, "creation_date": 1533282119, "post_id": 46289709, "comment_id": 90297956, "body": "Great answer.  It&#39;s a shame the question is so niche, so you haven&#39;t got the upvotes this deserves."}], "tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": false, "score": 10, "last_activity_date": 1505778513, "creation_date": 1505778513, "answer_id": 46289709, "question_id": 46283760, "link": "https://stackoverflow.com/questions/46283760/how-to-uncompress-a-single-x9-62-compressed-point-on-an-ecdh-p256-curve-in-go/46289709#46289709", "title": "How to uncompress a single X9.62 compressed point on an ECDH P256 curve in Go?", "body": "<p>As far as I know there is no point decompression function in the Go standard library (or the \u201cx\u201d packages), so you\u2019d have to do it yourself (or find an existing implementation).</p>\n\n<p>The implementation is not too difficult, although there are a couple of things to looks out for.</p>\n\n<p>Basically, you need plug your <code>X</code> value into the curve equation <code>Y<sup>2</sup> = X<sup>3</sup> + aX + b</code>, and then determine which of the two roots you want using the sign bit. The tricky bit is remembering that all this needs to be done modulo the field prime of the group.</p>\n\n<p>I find <a href=\"https://golang.org/pkg/math/big/\" rel=\"noreferrer\">Go\u2019s big integer package</a> can be a bit odd to use sometimes, because it uses mutable values, but it does have a <a href=\"https://golang.org/pkg/math/big/#Int.ModSqrt\" rel=\"noreferrer\">modular square root function</a> which makes things a lot easier for us. The curve parameters are available in the <a href=\"https://golang.org/pkg/crypto/elliptic/\" rel=\"noreferrer\"><code>crypto/elliptic</code> package</a>, although you need to know the <code>a</code> parameter is always <code>-3</code> for these curves.</p>\n\n<p>Assuming you have the compressed point as a <code>[]byte</code> (with a leading <code>0x02</code> or <code>0x03</code>) in <code>compressed_bytes</code>, the <a href=\"https://play.golang.org/p/2Wyt0tG0MS\" rel=\"noreferrer\">following should work</a>. This is a pretty direct implementation of the equation, broken up with comments and lots of named variables to attempt to explain what\u2019s going on. Have a look at the source of <a href=\"https://golang.org/pkg/crypto/elliptic/#CurveParams.IsOnCurve\" rel=\"noreferrer\"><code>CurveParams.IsOnCurve</code></a> for a slightly more efficient (and shorter) implementation. It\u2019s basically the same up until the modular square root.</p>\n\n<pre><code>compressed_bytes := //...\n\n// Split the sign byte from the rest\nsign_byte := uint(compressed_bytes[0])\nx_bytes := compressed_bytes[1:]\n\n// Convert to big Int.\nx := new(big.Int).SetBytes(x_bytes)\n\n// We use 3 a couple of times\nthree := big.NewInt(3)\n\n// and we need the curve params for P256\nc := elliptic.P256().Params()\n\n// The equation is y^2 = x^3 - 3x + b\n// First, x^3, mod P\nx_cubed := new(big.Int).Exp(x, three, c.P)\n\n// Next, 3x, mod P\nthree_X := new(big.Int).Mul(x, three)\nthree_X.Mod(three_X, c.P)\n\n// x^3 - 3x ...\ny_squared := new(big.Int).Sub(x_cubed, three_X)\n\n// ... + b mod P\ny_squared.Add(y_squared, c.B)\ny_squared.Mod(y_squared, c.P)\n\n// Now we need to find the square root mod P.\n// This is where Go's big int library redeems itself.\ny := new(big.Int).ModSqrt(y_squared, c.P)\nif y == nil {\n    // If this happens then you're dealing with an invalid point.\n    // Panic, return an error, whatever you want here.\n}\n\n// Finally, check if you have the correct root by comparing\n// the low bit with the low bit of the sign byte. If it\u2019s not\n// the same you want -y mod P instead of y.\nif y.Bit(0) != sign_byte &amp; 1 {\n    y.Neg(y)\n    y.Mod(y, c.P)\n}\n\n// Now your y coordinate is in y, for all your ScalarMult needs.\n</code></pre>\n"}], "owner": {"reputation": 13364, "user_id": 63775, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/029a02787eaa511b45a261da93c9fb36?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/63775/brandon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1164, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1505778513, "creation_date": 1505750677, "question_id": 46283760, "link": "https://stackoverflow.com/questions/46283760/how-to-uncompress-a-single-x9-62-compressed-point-on-an-ecdh-p256-curve-in-go", "title": "How to uncompress a single X9.62 compressed point on an ECDH P256 curve in Go?", "body": "<p>Golang's elliptical curve library can derive a secret key given a public coordinate with a X and Y value (uncompressed coordinates).</p>\n\n<p>However, when the point given is a single value in X9.62 compressed form with a given y-bit, how do I uncompress it?</p>\n\n<p>OpenSSL handles this scenario with this method:</p>\n\n<p><a href=\"https://github.com/openssl/openssl/blob/4e9b720e90ec154c9708139e96ec0ff8e2796c82/include/openssl/ec.h#L494\" rel=\"noreferrer\">https://github.com/openssl/openssl/blob/4e9b720e90ec154c9708139e96ec0ff8e2796c82/include/openssl/ec.h#L494</a></p>\n\n<p>There also appears to be a similar question addressing the math involved, but not a best practice for Go, specifically:</p>\n\n<p><a href=\"https://crypto.stackexchange.com/questions/8914/ecdsa-compressed-public-key-point-back-to-uncompressed-public-key-point\">https://crypto.stackexchange.com/questions/8914/ecdsa-compressed-public-key-point-back-to-uncompressed-public-key-point</a></p>\n\n<p>How should this be done in Go?</p>\n"}, {"tags": ["go", "google-cloud-platform"], "answers": [{"comments": [{"owner": {"reputation": 2623, "user_id": 3697163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/611ce881510094605af96f479d2c0472?s=128&d=identicon&r=PG&f=1", "display_name": "DaveBensonPhillips", "link": "https://stackoverflow.com/users/3697163/davebensonphillips"}, "edited": false, "score": 0, "creation_date": 1505750886, "post_id": 46283764, "comment_id": 79530516, "body": "Thanks - yeah Zapp does seem to be working as intended and it sounds like I can try to reconfigure zap to put the error message under &quot;message&quot;, and see if google cloud will work with that. I&#39;ll give it a shot and get back."}, {"owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "reply_to_user": {"reputation": 2623, "user_id": 3697163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/611ce881510094605af96f479d2c0472?s=128&d=identicon&r=PG&f=1", "display_name": "DaveBensonPhillips", "link": "https://stackoverflow.com/users/3697163/davebensonphillips"}, "edited": false, "score": 0, "creation_date": 1505751169, "post_id": 46283764, "comment_id": 79530708, "body": "My hunch is that the log processor expects a <code>message</code> field, and if it doesn&#39;t find one will try to make a best guess. <code>zap.Error</code> adds the field under the <code>error</code> key, and that seems like a sensible alternative if there&#39;s no <code>message</code> field. I think you&#39;re right that configuring <code>msg</code> to be <code>message</code> in zap will fix the issue. Good luck!"}, {"owner": {"reputation": 2623, "user_id": 3697163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/611ce881510094605af96f479d2c0472?s=128&d=identicon&r=PG&f=1", "display_name": "DaveBensonPhillips", "link": "https://stackoverflow.com/users/3697163/davebensonphillips"}, "edited": false, "score": 0, "creation_date": 1505752130, "post_id": 46283764, "comment_id": 79531281, "body": "Thanks, I can set the flags with <code>config := zap.NewProductionConfig(); config.EncoderConfig.StacktraceKey = &quot;stack&quot;</code>"}], "tags": [], "owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "is_accepted": true, "score": 1, "last_activity_date": 1505750687, "creation_date": 1505750687, "answer_id": 46283764, "question_id": 46283090, "link": "https://stackoverflow.com/questions/46283090/zap-stack-traces-vs-error-messages-on-google-cloud/46283764#46283764", "title": "Zap stack traces vs. error messages on google cloud", "body": "<p>zap by default puts the message under the <code>msg</code> key, the stacktrace under <code>stacktrace</code>, and prints log lines as json to stdout. You should be able to see this in action by just running your binary locally.</p>\n\n<p>Your logging system presumably processes these log lines as they're printed. It will read them, parse them, and maybe do some restructuring or add some metadata, and then send them off somewhere else to be saved or processed more.</p>\n\n<p>Since zap is in all likeliness working as intended, you need to look at the system that processes your logs. How does it expect them to look? Does it have special rules for any particular keys? Will it inject any keys of its own?</p>\n\n<p>Note that you can configure zap to use different keys for all of its standard fields.</p>\n"}], "owner": {"reputation": 2623, "user_id": 3697163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/611ce881510094605af96f479d2c0472?s=128&d=identicon&r=PG&f=1", "display_name": "DaveBensonPhillips", "link": "https://stackoverflow.com/users/3697163/davebensonphillips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1436, "favorite_count": 0, "accepted_answer_id": 46283764, "answer_count": 1, "score": 0, "last_activity_date": 1505750687, "creation_date": 1505748599, "question_id": 46283090, "link": "https://stackoverflow.com/questions/46283090/zap-stack-traces-vs-error-messages-on-google-cloud", "title": "Zap stack traces vs. error messages on google cloud", "body": "<p>I'm using zapp to log error messages on a service hosted on google cloud, and am seeing that while errors are logged successfully, the text stored in the \"message\" field of the google cloud log is the stack trace, and not the error message I have logged.</p>\n\n<p>Example code:</p>\n\n<pre><code>var log *zap.Logger\nif err := doStuff(); err != nil {\n    log.Error(&lt;error message I want to log&gt;, zap.Error(err))\n}\n</code></pre>\n\n<p>This works well except google cloud logging and stackdriver will use the stack-trace caught by the call to <code>zap.Error</code> in the <code>message</code> field of the structured log. The message I've defined appears in the <code>msg</code> field, but the former appears to be the one displayed predominantly in the logging console and used by stackdriver for indexing errors. </p>\n\n<p>This means that when navigating logs and errors via the console, I only see stacktraces, and no indication of the associated error string.</p>\n\n<p>The tricky thing is I have no idea if this \"issue\" is cloud-side or zapp-side. I've spent some time digging around in Zapp to no avail, and am out of ideas.</p>\n"}, {"tags": ["go", "ide", "goland"], "answers": [{"comments": [{"owner": {"reputation": 46878, "user_id": 296387, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5b86bedcaa244cfeb499072ec278cd7a?s=128&d=identicon&r=PG", "display_name": "Nick Weaver", "link": "https://stackoverflow.com/users/296387/nick-weaver"}, "edited": false, "score": 0, "creation_date": 1505749608, "post_id": 46282609, "comment_id": 79529718, "body": "While this link may answer the question, it is better to include the essential parts of the answer here and provide the link for reference.  Link-only answers can become invalid if the linked page changes. - <a href=\"/review/low-quality-posts/17369048\">From Review</a>"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 46878, "user_id": 296387, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5b86bedcaa244cfeb499072ec278cd7a?s=128&d=identicon&r=PG", "display_name": "Nick Weaver", "link": "https://stackoverflow.com/users/296387/nick-weaver"}, "edited": false, "score": 0, "creation_date": 1505751924, "post_id": 46282609, "comment_id": 79531171, "body": "@NickWeaver thank you, I&#39;ve edited my response based on your feedback. Please let me know if I can make it any better. Thank you."}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": false, "score": 1, "last_activity_date": 1505751876, "last_edit_date": 1505751876, "creation_date": 1505747140, "answer_id": 46282609, "question_id": 46282178, "link": "https://stackoverflow.com/questions/46282178/hi-i-started-gogland-i-cant-running/46282609#46282609", "title": "Hi, I started gogland. I can&#39;t running", "body": "<p>The error message says that you much pick a file in order for the configuration to work. Specifically it must be a file containing the <code>func main()</code> declaration.</p>\n\n<p>You can use the Run Type: Package instead of file in order to run a package.</p>\n\n<p>For example, if your main is under <code>$GOPATH/src/github.com/dlsniper/demo/cmd/mycmd/main.go</code> then you need to use <code>github.com/dlsniper/demo/cmd/mycmd</code> in order to run it.</p>\n\n<p>Moreover, from the screenshot you've pasted, it seems like you are not under a valid Go workspace. Please see here what a Go Workspace is and how to create one: <a href=\"https://golang.org/doc/code.html#Workspaces\" rel=\"nofollow noreferrer\">https://golang.org/doc/code.html#Workspaces</a></p>\n\n<p>Finally, if you prefer a visual guide for this, please have a look at this video on how to create and use Run Configurations in Gogland: <a href=\"https://www.youtube.com/watch?v=ko-wKntCLjg\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=ko-wKntCLjg</a></p>\n"}], "owner": {"reputation": 19, "user_id": 6917352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9148e9efdf7153a14c973f6ed85e8c95?s=128&d=identicon&r=PG&f=1", "display_name": "yahox", "link": "https://stackoverflow.com/users/6917352/yahox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": -7, "last_activity_date": 1505751876, "creation_date": 1505745911, "last_edit_date": 1505745978, "question_id": 46282178, "link": "https://stackoverflow.com/questions/46282178/hi-i-started-gogland-i-cant-running", "title": "Hi, I started gogland. I can&#39;t running", "body": "<p>I started gogland. I have a running problem.\n<img src=\"https://i.stack.imgur.com/pnab4.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/7GtGR.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1505755583, "post_id": 46282110, "comment_id": 79533034, "body": "Can you show us some code that you&#39;ve tried out but didn&#39;t work?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1505816916, "post_id": 46282110, "comment_id": 79558195, "body": "The multitenancy document you&#39;ve linked to uses <code>google.golang.org&#47;appengine&#47;datastore</code> but you are using <code>cloud.google.com&#47;go&#47;datastore</code>... while these two packages look almost the same they are not so there is a high probability that the reason you can&#39;t get namespaces to work is, depending on which way you look at it, because you&#39;ve been reading the wrong documentation, or because you&#39;re using the wrong package."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6043285"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1505827593, "post_id": 46282110, "comment_id": 79565856, "body": "Yes I do found same thing 1.&quot;cloud.google.com/go/datastore&quot; - By using this package i am able to insert the entities with out namespace 2.&quot;google.golang.org/appengine/datastore&quot; - I found this package from multi tenancy link by google, I got the clarity that I need to use this package to assign namespaces but I am getting errors while using this package"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1505828566, "post_id": 46282110, "comment_id": 79566600, "body": "The stack trace says line <code>270</code> of file <code>appengine&#47;internal&#47;api.go</code> so go here <a href=\"https://github.com/golang/appengine/blob/master/internal/api.go#L270\" rel=\"nofollow noreferrer\">github.com/golang/appengine/blob/master/internal/api.go#L270</a> and read the comments. <b>Make sure your local app runs in the <code>appengine</code> environment.</b> Also this new error you are getting is different from the original question so you should create a new question to get more help."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6043285"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1506082062, "post_id": 46282110, "comment_id": 79688029, "body": "I am trying to run from local development server (Google Cloud SDK) , I am using <b>goapp serve</b> and getting below error <b>&#39;goapp&#39; is not recognized as an internal or external command, operable program or batch file.</b> Please help me to fix this"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1506083644, "post_id": 46282110, "comment_id": 79689143, "body": "If you&#39;ve installed the google cloud SDK run the command <code>gcloud components list</code> and see if <code>app-engine-go</code> is installed, if not, install it with <code>gcloud components install app-engine-go</code>. <a href=\"https://cloud.google.com/sdk/gcloud/reference/components/install\" rel=\"nofollow noreferrer\">cloud.google.com/sdk/gcloud/reference/components/install</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6043285"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1506083770, "post_id": 46282110, "comment_id": 79689239, "body": "Yes have installed still getting same issue"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1506086763, "post_id": 46282110, "comment_id": 79691267, "body": "Did you install the <code>original App Engine SDK for Go</code> or did you install <code>Google Cloud SDK</code> + <code>gcloud components install app-engine-go</code>??"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6043285"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1506086847, "post_id": 46282110, "comment_id": 79691325, "body": "I have installed Google Cloud SDK + gcloud components install app-engine-go"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1506086917, "post_id": 46282110, "comment_id": 79691369, "body": "Ok I&#39;ll provide an answer to your question <a href=\"https://stackoverflow.com/questions/46344198/goapp-serve-not-working-goapp-is-not-recognized-as-an-internal-or-external\">here</a> in a few minutes."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6043285"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1506086951, "post_id": 46282110, "comment_id": 79691389, "body": "Sure,Thank you for quick replays, If needed i will send my screen shots about environment variables etc.,"}], "owner": {"user_type": "does_not_exist", "display_name": "user6043285"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 334, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1505827875, "creation_date": 1505745709, "last_edit_date": 1505827875, "question_id": 46282110, "link": "https://stackoverflow.com/questions/46282110/how-to-set-namespace-in-appengine-using-go-lang", "title": "How to set namespace in appengine using go lang?", "body": "<p>I am able to insert the entities with default namespace but I need to achieve multitenancy. Below is the code i am using to insert the entities and get the entities,but I need to assign namespaces for each entity.So i have followed below link but i am unable to set namespace please help me to fix </p>\n\n<p><a href=\"https://cloud.google.com/appengine/docs/standard/go/multitenancy/multitenancy\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/standard/go/multitenancy/multitenancy</a></p>\n\n<p>I found that there are two packages  </p>\n\n<p>1.\"cloud.google.com/go/datastore\" - By using this package i am able to insert the entities with out namespace\n2.\"google.golang.org/appengine/datastore\" - I found this package from multi tenancy link by google,\nI got the clarity that I need to use this package to assign namespaces but I am getting errors while using this package, Please help me to fix this </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n\n    \"google.golang.org/appengine\"\n    \"google.golang.org/appengine/datastore\"\n)\n\ntype user struct {\n    UserName string\n    Password string\n    First    string\n    Last     string\n}\n\nfunc main() {\n    fmt.Println(\"hi\")\n    http.HandleFunc(\"/\", handle)\n    http.Handle(\"/favicon.ico\", http.NotFoundHandler())\n    http.ListenAndServe(\":8080\", nil)\n\n}\n\nfunc handle(w http.ResponseWriter, r *http.Request) {\n    ctx := appengine.NewContext(r)\n\n    k := datastore.NewKey(ctx, \"user\", \"stringID\", 0, nil)\n    e := new(user)\n    if err := datastore.Get(ctx, k, e); err != nil {\n        http.Error(w, err.Error(), 500)\n        return\n    }\n\n    old := e.First\n    e.First = r.URL.Path\n\n    if _, err := datastore.Put(ctx, k, e); err != nil {\n        http.Error(w, err.Error(), 500)\n        return\n    }\n\n    w.Header().Set(\"Content-Type\", \"text/plain; charset=utf-8\")\n    fmt.Fprintf(w, \"old=%q\\nnew=%q\\n\", old, e.First)\n}\n</code></pre>\n\n<p>Error :</p>\n\n<pre><code>While running the code from local host I am getting below error\n\nE:/GoWork/src/google.golang.org/appengine/internal/api.go:270 +0x186\ngoogle.golang.org/appengine.WithContext(0xd60000, 0xc04200c320, 0xc042174000, 0xd60000, 0xc04200c320)\nE:/GoWork/src/google.golang.org/appengine/appengine.go:73 +0x46\ngoogle.golang.org/appengine.NewContext(0xc042174000, 0x987460, 0xc04216c034)\nE:/GoWork/src/google.golang.org/appengine/appengine.go:66 +0x6e\nmain.handle(0x959da0, 0xc042180000, 0xc042174000)\nE:/GoWork/src/simplystdatastore/main.go:27 +0x4a \nnet/http.HandlerFunc.ServeHTTP(0x7e49c8, 0x959da0, 0xc042180000, 0xc042174000)\nc:/go/src/net/http/server.go:1942 +0x4b\nnet/http.(*ServeMux).ServeHTTP(0x987460, 0x959da0, 0xc042180000, 0xc042174000)\nc:/go/src/net/http/server.go:2238 +0x137\nnet/http.serverHandler.ServeHTTP(0xc042075550, 0x959da0, 0xc042180000, 0xc042174000)\nc:/go/src/net/http/server.go:2568 +0x99\nnet/http.(*conn).serve(0xc0421280a0, 0x95a3a0, 0xc04216e040)\nc:/go/src/net/http/server.go:1825 +0x619\ncreated by net/http.(*Server).Serve\nc:/go/src/net/http/server.go:2668 +0x2d5 \n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9712, "user_id": 66907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f45da391d77044534895e4dd3770ffd2?s=128&d=identicon&r=PG", "display_name": "Sascha", "link": "https://stackoverflow.com/users/66907/sascha"}, "edited": false, "score": 0, "creation_date": 1505737883, "post_id": 46279205, "comment_id": 79521481, "body": "You are looking for a way to provide another timeout or you want to cancel due to another non time based situation?"}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1505738488, "post_id": 46279205, "comment_id": 79521922, "body": "Have you looked at <a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">blog.golang.org/context</a> package?"}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1505738933, "post_id": 46279205, "comment_id": 79522252, "body": "According to the documentation, context is for request processing that we must be able to cancel or is limited in time. My app is not a request handler. My app has multiple concurrent clients running in different go routines. I implemented my own variant of context that allows to terminate a group of go routines. This works well, except for goroutines locked in a dial attempt. Normally, on unix a connect attempt doesn&#39;t last long if there is no remote server. In Go it seam to last at least 30s. How can I terminate a go routine blocked in a Dial attempt."}], "answers": [{"comments": [{"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1505739310, "post_id": 46279623, "comment_id": 79522533, "body": "Excellent. That is what I was looking for. I was using the example given in the Overview. <code>conn, err := net.Dial(&quot;tcp&quot;, &quot;golang.org:80&quot;)</code>. I didn&#39;t look in the right place."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 7, "last_activity_date": 1505740946, "last_edit_date": 1505740946, "creation_date": 1505738703, "answer_id": 46279623, "question_id": 46279205, "link": "https://stackoverflow.com/questions/46279205/how-to-abort-a-net-dial-call-in-go/46279623#46279623", "title": "How to abort a net.Dial call in Go?", "body": "<p>The <a href=\"https://golang.org/pkg/net/#Dialer\" rel=\"nofollow noreferrer\"><code>net.Dialer</code></a> has <code>Timeout</code> and <code>Deadline</code> fields, and also can use a context with <a href=\"https://golang.org/pkg/net/#Dialer.DialContext\" rel=\"nofollow noreferrer\"><code>DialContext</code></a> which allows for timeout and cancelation. </p>\n\n<p>You can refer to <a href=\"https://golang.org/pkg/net/#DialTimeout\" rel=\"nofollow noreferrer\"><code>DialTimeout</code></a> to see how to setup the basic Dialer:</p>\n\n<pre><code>func DialTimeout(network, address string, timeout time.Duration) (Conn, error) {\n    d := Dialer{Timeout: timeout}\n    return d.Dial(network, address)\n}\n</code></pre>\n\n<p>And an example with a <code>context.Context</code>:</p>\n\n<pre><code>var d Dialer\nctx, cancel := context.WithTimeout(context.Background(), 5*time.Second)\ndefer cancel()\n\nreturn d.DialContext(ctx, network, address)\n</code></pre>\n"}], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1575, "favorite_count": 0, "accepted_answer_id": 46279623, "answer_count": 1, "score": 1, "last_activity_date": 1505740946, "creation_date": 1505737389, "question_id": 46279205, "link": "https://stackoverflow.com/questions/46279205/how-to-abort-a-net-dial-call-in-go", "title": "How to abort a net.Dial call in Go?", "body": "<p>I\u00a0have a client who try to connect to a server. </p>\n\n<p>I need to be able to terminate the client and abort this Dial attempt. Is this possible ?\u00a0How could I do that ?</p>\n\n<p>The timeout is apparently longer than 30s since the test blocks until the 30s elapse without a failure of the Dial call. </p>\n\n<p>Can we specify a timeout ourself ? </p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "answers": [{"tags": [], "owner": {"reputation": 2028, "user_id": 711336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b48c9965a4ceb5193259840d3abdf38b?s=128&d=identicon&r=PG", "display_name": "s7anley", "link": "https://stackoverflow.com/users/711336/s7anley"}, "is_accepted": true, "score": 4, "last_activity_date": 1505749684, "creation_date": 1505749684, "answer_id": 46283439, "question_id": 46279091, "link": "https://stackoverflow.com/questions/46279091/what-is-the-difference-between-s3-download-and-getobject/46283439#46283439", "title": "what is the difference between s3 download and getobject", "body": "<p><code>GetObject</code> is a low-level <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/API/RESTObjectGET.html\" rel=\"nofollow noreferrer\">call to S3 rest API</a>. Downloader it's using it internally for concurrent download of chunks of the requested file. So, for example, it makes sense to use it in case you want to write your custom downloader. As an end user, you should stick with Downloader.</p>\n"}], "owner": {"reputation": 179, "user_id": 743552, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a53032d16a9b7fa04ee49385acb07749?s=128&d=identicon&r=PG", "display_name": "Sunil Kumar Mohanty", "link": "https://stackoverflow.com/users/743552/sunil-kumar-mohanty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1280, "favorite_count": 0, "accepted_answer_id": 46283439, "answer_count": 1, "score": 2, "last_activity_date": 1505749684, "creation_date": 1505736999, "question_id": 46279091, "link": "https://stackoverflow.com/questions/46279091/what-is-the-difference-between-s3-download-and-getobject", "title": "what is the difference between s3 download and getobject", "body": "<p>My question is with reference to aws sdk for golang. There are two ways to download a file </p>\n\n<ul>\n<li>GetObject</li>\n<li>Download (S3Manager)</li>\n</ul>\n\n<p>I understand that Download uses concurrent GET requests to download a file. If this is the case, is not this always a better option? If not, could you please advise when to use GetObject method?</p>\n"}, {"tags": ["json", "go", "encoding", "marshalling"], "answers": [{"comments": [{"owner": {"reputation": 1972, "user_id": 3059945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0913331bcf360849ca2acec0612081b2?s=128&d=identicon&r=PG", "display_name": "Shahidh", "link": "https://stackoverflow.com/users/3059945/shahidh"}, "edited": false, "score": 0, "creation_date": 1505739239, "post_id": 46279230, "comment_id": 79522474, "body": "Thanks Eugene. I want to be able to restrict unmarshalling to only the specified types. Using and interface will result in successful unmarshallling for any kind of values for the key. Is there anyway that can be done?"}, {"owner": {"reputation": 1972, "user_id": 3059945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0913331bcf360849ca2acec0612081b2?s=128&d=identicon&r=PG", "display_name": "Shahidh", "link": "https://stackoverflow.com/users/3059945/shahidh"}, "edited": false, "score": 0, "creation_date": 1505816235, "post_id": 46279230, "comment_id": 79557744, "body": "Thanks again Eugene. We had tried this method and it works. But the problem is that we have lots of structs where this validation has to happen. So, writing <code>MarshaJSON</code> and <code>UnmarshalJSON</code> for every struct is not a feasible solution. Sadly, I can&#39;t write these methods for an <code>interface{}</code>. Otherwise I would have written it for <code>TheParam</code>.  But, we found another method in which we can do struct validations by adding <code>validate</code> tags using packages like <a href=\"https://github.com/asaskevich/govalidator\" rel=\"nofollow noreferrer\">github.com/asaskevich/govalidator</a>. Trying them out now. Will update if that&#39;s the way to go forward"}, {"owner": {"reputation": 1972, "user_id": 3059945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0913331bcf360849ca2acec0612081b2?s=128&d=identicon&r=PG", "display_name": "Shahidh", "link": "https://stackoverflow.com/users/3059945/shahidh"}, "edited": false, "score": 0, "creation_date": 1505816691, "post_id": 46279230, "comment_id": 79558060, "body": "I am checking out the link you shared."}, {"owner": {"reputation": 1972, "user_id": 3059945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0913331bcf360849ca2acec0612081b2?s=128&d=identicon&r=PG", "display_name": "Shahidh", "link": "https://stackoverflow.com/users/3059945/shahidh"}, "edited": false, "score": 0, "creation_date": 1507014003, "post_id": 46279230, "comment_id": 80031907, "body": "Only way to do this is to define <code>MarshalJSON</code> and <code>UnmarshalJSON</code> for every type. Macro support would have made this easier."}], "tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": true, "score": 2, "last_activity_date": 1505771369, "last_edit_date": 1505771369, "creation_date": 1505737471, "answer_id": 46279230, "question_id": 46279048, "link": "https://stackoverflow.com/questions/46279048/encoding-decoding-multi-type-fields-in-json-golang/46279230#46279230", "title": "Encoding/Decoding multi-type fields in JSON golang", "body": "<p>UPDATED. <code>interface</code> gets encoded and decoded to JSON well automatically. If you wish to control types, you may add special <code>UnmarshalJSON</code> and perform checks in it:</p>\n\n<pre><code>type TheParam interface{}\n\ntype MyData struct {\n    Name  string   `json:\"name\"`\n    Value int32    `json:\"value\"`\n    Param TheParam `json:\"param\"`\n}\n\ntype myData MyData\n\nfunc (m *MyData) UnmarshalJSON(b []byte) error {\n    var mm myData\n    if err := json.Unmarshal(b, &amp;mm); err != nil {\n        return err\n    }\n    switch mm.Param.(type) {\n    case float64, string, map[string]interface{}:\n        *m = MyData(mm)\n        return nil\n    default:\n        return InvalidFieldTypeError{value: mm.Param}\n    }\n    return nil\n}\n</code></pre>\n\n<p>Type <code>InvalidFieldTypeError</code> may be convenient to return such class of errors and can be defined as:</p>\n\n<pre><code>type InvalidFieldTypeError struct {\n    value interface{}\n}\n\nfunc (e InvalidFieldTypeError) Error() string {\n    return fmt.Sprintf(\"Field type '%T' is not valid for MyData\", e.value)\n}\n</code></pre>\n\n<p>The whole example: <a href=\"https://play.golang.org/p/MuW6gwSAKi\" rel=\"nofollow noreferrer\">https://play.golang.org/p/MuW6gwSAKi</a></p>\n\n<p>Also I'd like to recommend this article <a href=\"https://attilaolah.eu/2013/11/29/json-decoding-in-go/\" rel=\"nofollow noreferrer\">https://attilaolah.eu/2013/11/29/json-decoding-in-go/</a></p>\n"}], "owner": {"reputation": 1972, "user_id": 3059945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0913331bcf360849ca2acec0612081b2?s=128&d=identicon&r=PG", "display_name": "Shahidh", "link": "https://stackoverflow.com/users/3059945/shahidh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2199, "favorite_count": 1, "accepted_answer_id": 46279230, "answer_count": 1, "score": 0, "last_activity_date": 1505771369, "creation_date": 1505736909, "question_id": 46279048, "link": "https://stackoverflow.com/questions/46279048/encoding-decoding-multi-type-fields-in-json-golang", "title": "Encoding/Decoding multi-type fields in JSON golang", "body": "<p>I am trying to create a struct where a field can hold data of a few particular types, say <code>int</code>, <code>string</code> and a <code>CustomType</code>. I want to decode/encode this struct to/from JSON. How can we achieve this in go/golang?</p>\n\n<p>For example, I have a struct for the following definition:</p>\n\n<pre><code>type MyData struct {\n  Name  string                                    `json:\"name\"`\n  Value int32                                     `json:\"value\"`\n  Param &lt;can be either int, string or CustomType&gt; `json:\"param\"`\n}\n</code></pre>\n\n<p>Where <code>CustomType</code> is </p>\n\n<pre><code>type CustomType struct {\n  Custom bool `json:\"custom\"`\n}\n</code></pre>\n\n<p>Let's say I need to unmarshal the following JSONs to the above struct <code>MyData</code>:</p>\n\n<pre><code>{\n  \"name\": \"Hello\",\n  \"value\": 32\n  \"param\": \"World\"\n}\n</code></pre>\n\n<p>And this one:</p>\n\n<pre><code>{\n  \"name\": \"Hello\",\n  \"value\": 32\n  \"param\": 100\n}\n</code></pre>\n\n<p>And this one also:</p>\n\n<pre><code>{\n  \"name\": \"Hello\",\n  \"value\": 32\n  \"param\": {\n     \"custom\": true\n  }\n}\n</code></pre>\n\n<p>How do I achieve this?</p>\n\n<p>Can I define my own <code>MarshalJSON</code> and <code>UnmarshalJSON</code> on <code>MyData</code> and achieve this?</p>\n\n<p>Or is there a way of defining a custom type, say <code>IntOrStringOrCustom</code> and define <code>MyData</code> as</p>\n\n<pre><code>type MyData struct {\n  Name  string              `json:\"name\"`\n  Value int32               `json:\"value\"`\n  Param IntOrStringOrCustom `json:\"param\"`\n}\n</code></pre>\n\n<p>and then define <code>MarshalJSON</code> and <code>UnmarshalJSON</code> on <code>IntOrStringOrCustom</code>? </p>\n\n<p>I have also seen <code>json.RawMessage</code>. Can we use it somehow here?</p>\n\n<p>Issue with using <code>interface{}</code> is that I will have to write the encoding/decoding logic everywhere, where I am trying to use this data. Or is there an elegant way of doing this with <code>interface{}</code>?</p>\n"}, {"tags": ["dictionary", "go", "heap-memory"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 11, "last_activity_date": 1505734259, "creation_date": 1505734259, "answer_id": 46278240, "question_id": 46278003, "link": "https://stackoverflow.com/questions/46278003/how-much-memory-do-golang-maps-reserve/46278240#46278240", "title": "How much memory do golang maps reserve?", "body": "<p>You may use the Go testing tool to measure size of arbitrary complex data structures. This is detailed in this answer: <a href=\"https://stackoverflow.com/questions/44257522/how-to-get-variable-memory-size-of-variable-in-golang/44258164#44258164\">How to get variable memory size of variable in golang?</a></p>\n\n<p>To measure the size of a map created by <code>make(map[string]int)</code>, use the following benchmark function:</p>\n\n<pre><code>var x map[string]int\n\nfunc BenchmarkEmptyMap(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        x = make(map[string]int)\n    }\n}\n</code></pre>\n\n<p>Executing with</p>\n\n<pre><code>go test -bench . -benchmem\n</code></pre>\n\n<p>The result is:</p>\n\n<pre><code>BenchmarkEmptyMap-4     20000000   110 ns/op      48 B/op    1 allocs/op\n</code></pre>\n\n<p>So the answer is on my 64-bit architecture: <strong>48 bytes</strong>.</p>\n\n<p>As hinted, size may depend on architecture. Also size may depend on the initial capacity you may pass to <a href=\"https://golang.org/pkg/builtin/#make\" rel=\"noreferrer\"><code>make()</code></a>, as you can see in this example:</p>\n\n<pre><code>func BenchmarkEmptyMapCap100(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        x = make(map[string]int, 100)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>BenchmarkEmptyMapCap100-4   1000000    1783 ns/op   4176 B/op    3 allocs/op\n</code></pre>\n\n<p>A map of type <code>map[string]int</code> with an initial capacity of 100 now requires 4176 bytes (on 64-bit arch).</p>\n\n<p>The default initial capacity is around 7 if not specified explicitly.</p>\n"}, {"tags": [], "owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "is_accepted": false, "score": 11, "last_activity_date": 1585406721, "last_edit_date": 1585406721, "creation_date": 1505736457, "answer_id": 46278889, "question_id": 46278003, "link": "https://stackoverflow.com/questions/46278003/how-much-memory-do-golang-maps-reserve/46278889#46278889", "title": "How much memory do golang maps reserve?", "body": "<p>If you look at the <a href=\"https://github.com/golang/go/blob/d99fe1f40dfacfdebee22c13ed4471fd50f2cc1a/src/runtime/map.go#L303\" rel=\"nofollow noreferrer\">source</a> of Go's map type, you will see, that a map consists of a header (type <code>hmap</code>) and an array of buckets (type <code>bmap</code>). When you create a new map and don't specify the initial space (<code>hint</code>), only one bucket is created. </p>\n\n<p>A header consists of several fields: </p>\n\n<p>1 * <code>int</code>,<br>\n  2 * <code>uint8</code>,<br>\n  1 * <code>uint16</code>,<br>\n  1 * <code>uint32</code>,<br>\n  2 * <code>unsafe.Pointer</code>,<br>\n  1 * <code>uintptr</code>. </p>\n\n<p>Size of the types <code>int</code>, <code>uintptr</code>, and <code>unsafe.Pointer</code> equals the size of a word (8 bytes on 64 bit machines).</p>\n\n<p>A bucket consists of an array of 8 * <code>uint8</code>. </p>\n\n<p>This gives a total of 40 + 8 = 48 bytes (64 bit architecture)</p>\n"}], "owner": {"reputation": 636, "user_id": 3333488, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/49Fx1.jpg?s=128&g=1", "display_name": "lash", "link": "https://stackoverflow.com/users/3333488/lash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6484, "favorite_count": 3, "answer_count": 2, "score": 7, "last_activity_date": 1585406721, "creation_date": 1505733452, "last_edit_date": 1523913004, "question_id": 46278003, "link": "https://stackoverflow.com/questions/46278003/how-much-memory-do-golang-maps-reserve", "title": "How much memory do golang maps reserve?", "body": "<p>Given a map allocation where the initial <a href=\"https://golang.org/ref/spec#Making_slices_maps_and_channels\" rel=\"noreferrer\">space</a> is not specified, for example:</p>\n\n<pre><code>foo := make(map[string]int)\n</code></pre>\n\n<p>The <a href=\"https://golang.org/ref/spec#Making_slices_maps_and_channels\" rel=\"noreferrer\">documentation</a> suggests that the memory allocation here is implementation dependent. So (how) can I tell how much memory my implementation is allocating to this map?</p>\n"}, {"tags": ["go", "gzip", "reverse-proxy"], "answers": [{"comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1505733113, "post_id": 46277888, "comment_id": 79518407, "body": "And please stop doing things like <code>*(*string)(unsafe.Pointer(&amp;b))</code>. Please."}, {"owner": {"reputation": 21, "user_id": 8595148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef9444b9027f5ad4c683b7789611db0?s=128&d=identicon&r=PG&f=1", "display_name": "code", "link": "https://stackoverflow.com/users/8595148/code"}, "edited": false, "score": 0, "creation_date": 1505746541, "post_id": 46277888, "comment_id": 79527642, "body": "Did you even read the question, the information I get from the response is dynamic, I have no control over it, I had questions if I should even post to this site, that is the most noob answer that I have ever seen.  Can you at least try to answer the question."}, {"owner": {"reputation": 21, "user_id": 8595148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef9444b9027f5ad4c683b7789611db0?s=128&d=identicon&r=PG&f=1", "display_name": "code", "link": "https://stackoverflow.com/users/8595148/code"}, "edited": false, "score": 0, "creation_date": 1505747113, "post_id": 46277888, "comment_id": 79528032, "body": "Just an fyi, i am not trying to log binary data, I am trying to convert the data, but I suppose you would have to understand the well defined question before you could actually give an intelligent answer."}, {"owner": {"reputation": 21, "user_id": 8595148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef9444b9027f5ad4c683b7789611db0?s=128&d=identicon&r=PG&f=1", "display_name": "code", "link": "https://stackoverflow.com/users/8595148/code"}, "edited": false, "score": 0, "creation_date": 1505747256, "post_id": 46277888, "comment_id": 79528135, "body": "I will post my own answer after I figure it out, intelligently."}, {"owner": {"reputation": 21, "user_id": 8595148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef9444b9027f5ad4c683b7789611db0?s=128&d=identicon&r=PG&f=1", "display_name": "code", "link": "https://stackoverflow.com/users/8595148/code"}, "edited": false, "score": 0, "creation_date": 1505747879, "post_id": 46277888, "comment_id": 79528572, "body": "Just an fyi, I love stack, so dont misunderstand me, I use it constantly.  Sometimes you get Volker, and sometimes you get someone that gives a crap about the questions.  5050 chance and I got volker."}, {"owner": {"reputation": 21, "user_id": 8595148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef9444b9027f5ad4c683b7789611db0?s=128&d=identicon&r=PG&f=1", "display_name": "code", "link": "https://stackoverflow.com/users/8595148/code"}, "edited": false, "score": 0, "creation_date": 1505838374, "post_id": 46277888, "comment_id": 79573087, "body": "Volker, I was a little hard on you to, so I am sorry as well.  I am close to a solution, I will post it when I am done.  thanks for everything, and ignore my previous comments, lets just get this solved.."}, {"owner": {"reputation": 21, "user_id": 8595148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef9444b9027f5ad4c683b7789611db0?s=128&d=identicon&r=PG&f=1", "display_name": "code", "link": "https://stackoverflow.com/users/8595148/code"}, "edited": false, "score": 0, "creation_date": 1506367845, "post_id": 46277888, "comment_id": 79783390, "body": "Solved the issue Volker, so the real question is how to copy the stream.  Below is the answer:"}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 0, "last_activity_date": 1505733002, "creation_date": 1505733002, "answer_id": 46277888, "question_id": 46276891, "link": "https://stackoverflow.com/questions/46276891/golang-dumpresponse-gzip-issue-when-logging-response-body-reverseproxy/46277888#46277888", "title": "Golang DumpResponse gzip issue when logging response body (reverseproxy)", "body": "<blockquote>\n  <p>does DumpResponse give me the ability to decompress gzip</p>\n</blockquote>\n\n<p>No it does not.</p>\n\n<p>To me it seems as if the major problem is neither the reverse proxy nor DumpResponse but that you are trying to \"log\" binary data: Be it gzip, or other binary data like images. Just fix your logging logic: If the raw body is binary you should render some kind of representation or transformation of it. For gziped stuff gunzip it first (but this might still be binary \"non utf8\" data unsuitable for logging). Focus on the real problem: How to \"log\" binary data.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8595148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef9444b9027f5ad4c683b7789611db0?s=128&d=identicon&r=PG&f=1", "display_name": "code", "link": "https://stackoverflow.com/users/8595148/code"}, "is_accepted": false, "score": 1, "last_activity_date": 1506368195, "creation_date": 1506368195, "answer_id": 46412902, "question_id": 46276891, "link": "https://stackoverflow.com/questions/46276891/golang-dumpresponse-gzip-issue-when-logging-response-body-reverseproxy/46412902#46412902", "title": "Golang DumpResponse gzip issue when logging response body (reverseproxy)", "body": "<p>The answer is to copy the stream, then you can use the second variable to re-post the stream back to the request.body object so you don't lose any data.</p>\n\n<pre><code>buf, _ := ioutil.ReadAll(response.Body)\nresponseuse1 := ioutil.NopCloser(bytes.NewBuffer(buf))\nresponsehold := ioutil.NopCloser(bytes.NewBuffer(buf))\n</code></pre>\n\n<p>Method to pull logging:  extractLogging(responseuse1)\nPush the hold back to the body so its untouched:  response.Body = responsehold</p>\n\n<p>return response</p>\n"}], "owner": {"reputation": 21, "user_id": 8595148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef9444b9027f5ad4c683b7789611db0?s=128&d=identicon&r=PG&f=1", "display_name": "code", "link": "https://stackoverflow.com/users/8595148/code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1506368195, "creation_date": 1505729997, "question_id": 46276891, "link": "https://stackoverflow.com/questions/46276891/golang-dumpresponse-gzip-issue-when-logging-response-body-reverseproxy", "title": "Golang DumpResponse gzip issue when logging response body (reverseproxy)", "body": "<p>I have created a simple reverse proxy in my main.go as follows:</p>\n\n<pre><code>reverseproxy := httputil.NewSingleHostReverseProxy(\"https://someurl/someuri\")\n</code></pre>\n\n<p>this is working fine, however, I would like to log the response that comes back from the server.  I can also do this utilizing the following code inside the standard RoundTrip method recommended by golang:</p>\n\n<pre><code>response, err := http.DefaultTransport.RoundTrip(request)\ndumpresp, err := httputil.DumpResponse(response, true)\n\nif err != nil {\n    return nil, err\n}\nlog.Printf(\"%s\", dumpresp)\n</code></pre>\n\n<p>All the above works as expected aside from one thing, the response, when Content-Encoding: gzip, the string appears to the logs as non-utf8 gzip characters.  it seems to be a golang oversight but maybe there is something i have missed in the documentation, which I have read to its completion a few times.  I can't post the logs here because the characters are non utf8 so they would not display on this site anyway.  So, I know what your thinking, just grab the gzip content and use a method to remove the gzip compression.  That would be great if the response from DumpResponse was not partly gzip and partly standard utf8 with no way to separate the sections from each other.</p>\n\n<p>So I know what your going to say, why not just take the raw response like the following and gzip decode, and \"not\" use DumpResponse.  Well I can do that as well, but there is an issue with the following:</p>\n\n<pre><code>var reader io.Reader\nstartreader := httputility.NewChunkedReader(reader)\nswitch response.Header.Get(\"Content-Encoding\") {\ncase \"gzip\":\n    startreader, err = gzip.NewReader(response.Body)\n    log.Println(\"Response body gzip: \")\n    buf := new(bytes.Buffer)\n    buf.ReadFrom(startreader)\n    b := buf.Bytes()\n    s := *(*string)(unsafe.Pointer(&amp;b))\n    for name, value := range response.Header {\n        var hvaluecomp string = \"\"\n        for i := 0; i &lt; len(value); i++ {\n            hvaluecomp += value[i]\n        }\n        response.Header.Add(name,hvaluecomp)\n    }\n    log.Printf(\"%s\", s)\n\n\n\ndefault:\n    startreader = response.Body\n    buf := new(bytes.Buffer)\n    buf.ReadFrom(startreader)\n    b := buf.Bytes()\n    s := *(*string)(unsafe.Pointer(&amp;b))\n    for name, value := range response.Header {\n        fmt.Printf(\"%v: %v\\n\", name, value)\n    }\n    log.Printf(\"%s\", s)\n}\n</code></pre>\n\n<p>The issue with the above is, responses can only be read one time via the reader, after that the response cannot be read by the reverse proxy anymore and it makes the proxy response back to the browser nil =), so again I was met with failure.  I cant imagine that the folks coding golang would have missed decoding gzip, just strange, it seems to be so simple. </p>\n\n<p>So in the end, my question is, does DumpResponse give me the ability to decompress gzip so I can log the actual response instead of non utf8 characters? This does the log reader no good when debugging an issue for the production product.  This would render the built in golang reverse proxy useless in my eyes and I would start development on my own.</p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1505731421, "post_id": 46276095, "comment_id": 79517305, "body": "This sounds like an <a href=\"https://meta.stackexchange.com/q/66377/166789\">XY problem</a>. It&#39;s always best to describe the goal you&#39;re trying to accomplish, instead of the solution you think that might fit."}, {"owner": {"reputation": 4166, "user_id": 1898070, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c29fa44faffe872325c40c6d5aea0393?s=128&d=identicon&r=PG", "display_name": "Nipun Talukdar", "link": "https://stackoverflow.com/users/1898070/nipun-talukdar"}, "reply_to_user": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1505739295, "post_id": 46276095, "comment_id": 79522519, "body": "@Carpetsmoker the problem I had lots of messages are pushed to a channel and from the channel some consumer gets the message and process them. Sometimes the processing fails (because the target service times out or some other issues). If the processing fails, then they need to be retried and retry of failed messages should ideally happen before the newly arrived messages. Also, the processing of the messages and getting failed or success response for them happen asynchronously."}, {"owner": {"reputation": 1435, "user_id": 180656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c91c0ae420dcaf04e5e9061be6a93c?s=128&d=identicon&r=PG", "display_name": "Josef Grahn", "link": "https://stackoverflow.com/users/180656/josef-grahn"}, "edited": false, "score": 0, "creation_date": 1505741840, "post_id": 46276095, "comment_id": 79524320, "body": "@NipunTalukdar: Have you considered using some message queueing software or library? If message delivery guarantees is important there are solutions that will likely be a lot more robust than rolling it yourself (e.g. what about persistence if the process dies?). If you don&#39;t need that and just want something simple and lightweight, how about just having a retry loop in the handler rather than enqueueing the message again?"}, {"owner": {"reputation": 4166, "user_id": 1898070, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c29fa44faffe872325c40c6d5aea0393?s=128&d=identicon&r=PG", "display_name": "Nipun Talukdar", "link": "https://stackoverflow.com/users/1898070/nipun-talukdar"}, "reply_to_user": {"reputation": 1435, "user_id": 180656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c91c0ae420dcaf04e5e9061be6a93c?s=128&d=identicon&r=PG", "display_name": "Josef Grahn", "link": "https://stackoverflow.com/users/180656/josef-grahn"}, "edited": false, "score": 0, "creation_date": 1505742885, "post_id": 46276095, "comment_id": 79525059, "body": "@JosefGrahn yes. We are using Kafka. Scenario is like this. Some PHP web components push events to a local event collector (which is golang component) which evaluates the events and if fine pushes it to Kafka. I am using sarama kafka library from Shopify and I am using the async producer. The response from Kafka comes asynchronously. If it gets a failed response from Kafka, that event needs to be retried (push again to Kafka) and ideally that should be retried before the newer events. Eventcollector pushes the events to a channel, nd from the channel a goroutine peek and send to async producer"}, {"owner": {"reputation": 1435, "user_id": 180656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c91c0ae420dcaf04e5e9061be6a93c?s=128&d=identicon&r=PG", "display_name": "Josef Grahn", "link": "https://stackoverflow.com/users/180656/josef-grahn"}, "edited": false, "score": 0, "creation_date": 1505745534, "post_id": 46276095, "comment_id": 79526962, "body": "It really feels like you are going at the problem from the wrong angle... Why don&#39;t you just have a basic retry loop in a goroutine? The goroutine can wait  (synchronously) for the response from Kafka. Spawn one per message push or keep a pool of workers. But that channel and goroutine is still a week link in your message delivery unless you also push failures downstream and let them handle it (i.e. don&#39;t ack the clients until you have pushed it onto the Kafka queue)."}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 4, "last_activity_date": 1505727571, "creation_date": 1505727571, "answer_id": 46276131, "question_id": 46276095, "link": "https://stackoverflow.com/questions/46276095/is-there-any-way-to-push-to-the-front-of-a-channel-in-golang/46276131#46276131", "title": "Is there any way to push to the front of a channel in golang?", "body": "<blockquote>\n  <p>But is there a way to push element to the \"front\" of the channel</p>\n</blockquote>\n\n<p>No there is not.</p>\n"}, {"tags": [], "owner": {"reputation": 1435, "user_id": 180656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c91c0ae420dcaf04e5e9061be6a93c?s=128&d=identicon&r=PG", "display_name": "Josef Grahn", "link": "https://stackoverflow.com/users/180656/josef-grahn"}, "is_accepted": false, "score": 2, "last_activity_date": 1505727685, "creation_date": 1505727685, "answer_id": 46276170, "question_id": 46276095, "link": "https://stackoverflow.com/questions/46276095/is-there-any-way-to-push-to-the-front-of-a-channel-in-golang/46276170#46276170", "title": "Is there any way to push to the front of a channel in golang?", "body": "<p>No, a channel is strictly FIFO. You'll have to play with multiple channels if you want priority, or use some other data structure, like a heap: <a href=\"https://golang.org/pkg/container/heap/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/container/heap/</a>.</p>\n"}], "owner": {"reputation": 4166, "user_id": 1898070, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c29fa44faffe872325c40c6d5aea0393?s=128&d=identicon&r=PG", "display_name": "Nipun Talukdar", "link": "https://stackoverflow.com/users/1898070/nipun-talukdar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 902, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505727685, "creation_date": 1505727451, "question_id": 46276095, "link": "https://stackoverflow.com/questions/46276095/is-there-any-way-to-push-to-the-front-of-a-channel-in-golang", "title": "Is there any way to push to the front of a channel in golang?", "body": "<p>In golang channels, the element pushed last is consumed last. But is there a way to push element to the \"front\" of the channel so that the element get a chance to get consumed out of turn?  Assume elements 1,2,3,4,5,6,7,8 are added to the channel and element 4 failed to process (1,2,3 are processed successfully). In this case I want to push the element 4 again to the channel in such a way that it may get a chance to get processed before elements 5,6,7,8 and subsequent elements added (if they are not already pulled from the channel for processing). This can be easily achieved using blocking queues. But I don't want to use them. </p>\n"}, {"tags": ["xml", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 600, "user_id": 1917804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a839042f0b21e836959319bf4f8d991?s=128&d=identicon&r=PG", "display_name": "Vishnu Prasad Kallummel", "link": "https://stackoverflow.com/users/1917804/vishnu-prasad-kallummel"}, "edited": false, "score": 0, "creation_date": 1505808193, "post_id": 46275446, "comment_id": 79552579, "body": "Sure, it wasn&#39;t."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 1, "last_activity_date": 1505725507, "creation_date": 1505725507, "answer_id": 46275446, "question_id": 46275266, "link": "https://stackoverflow.com/questions/46275266/golang-refactoring-xml-tag-definition-in-struct/46275446#46275446", "title": "GoLang: Refactoring xml tag definition in struct", "body": "<blockquote>\n  <p>Is it possible?</p>\n</blockquote>\n\n<p>No. This is not possible.</p>\n"}, {"comments": [{"owner": {"reputation": 600, "user_id": 1917804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a839042f0b21e836959319bf4f8d991?s=128&d=identicon&r=PG", "display_name": "Vishnu Prasad Kallummel", "link": "https://stackoverflow.com/users/1917804/vishnu-prasad-kallummel"}, "edited": false, "score": 0, "creation_date": 1505807701, "post_id": 46275471, "comment_id": 79552273, "body": "That&#39;s a great suggestion (y)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1505808159, "last_edit_date": 1505808159, "creation_date": 1505725554, "answer_id": 46275471, "question_id": 46275266, "link": "https://stackoverflow.com/questions/46275266/golang-refactoring-xml-tag-definition-in-struct/46275471#46275471", "title": "GoLang: Refactoring xml tag definition in struct", "body": "<p>It's not a headache to repeat a <a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go/30889373#30889373\">tag</a> whenever you need it. Note that the spec does not allow you to use constants or variables when defining tags for struct fields. The struct tag can only be a <a href=\"https://golang.org/ref/spec#string_lit\" rel=\"nofollow noreferrer\">string literal</a>. Quoting from <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">Spec: Struct types:</a></p>\n\n<blockquote>\n<pre><code>StructType    = \"struct\" \"{\" { FieldDecl \";\" } \"}\" .\nFieldDecl     = (IdentifierList Type | EmbeddedField) [ Tag ] .\nEmbeddedField = [ \"*\" ] TypeName .\nTag           = string_lit .\n</code></pre>\n</blockquote>\n\n<p>One way to \"outsource\" the tag definition would be to \"outsource\" the whole struct field into another struct, and have <code>Social</code> embed that struct.</p>\n\n<p>For example:</p>\n\n<pre><code>type Social struct {\n    XMLName xml.Name `xml:\"social\"`\n    HasFacebook\n    Twitter string `xml:\"twitter\"`\n    Youtube string `xml:\"youtube\"`\n}\n\ntype HasFacebook struct {\n    Facebook string `xml:\"facebook\"`\n}\n</code></pre>\n\n<p>And now you can reuse it in other types / structs:</p>\n\n<pre><code>type Social2 struct {\n    HasFacebook\n    Linkedin string `xml:\"linkedin\"`\n}\n</code></pre>\n\n<p>Testing both types (<code>Social</code> and <code>Social2</code>):</p>\n\n<pre><code>func main() {\n    var s *Social\n    if err := xml.Unmarshal([]byte(src), &amp;s); err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"%+v\\n\", s)\n\n    var s2 *Social2\n    if err := xml.Unmarshal([]byte(src), &amp;s2); err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"%+v\\n\", s2)\n}\n\nconst src = `&lt;social&gt;\n    &lt;facebook&gt;someface&lt;/facebook&gt;\n    &lt;twitter&gt;sometwitter&lt;/twitter&gt;\n    &lt;linkedin&gt;somelinkedin&lt;/linkedin&gt;\n&lt;/social&gt;`\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/fbpv6AOAIF\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>&amp;{XMLName:{Space: Local:social} HasFacebook:{Facebook:someface} Twitter:sometwitter Youtube:}\n&amp;{HasFacebook:{Facebook:someface} Linkedin:somelinkedin}\n</code></pre>\n"}], "owner": {"reputation": 600, "user_id": 1917804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a839042f0b21e836959319bf4f8d991?s=128&d=identicon&r=PG", "display_name": "Vishnu Prasad Kallummel", "link": "https://stackoverflow.com/users/1917804/vishnu-prasad-kallummel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 46275471, "answer_count": 2, "score": 1, "last_activity_date": 1505808159, "creation_date": 1505724975, "last_edit_date": 1505807996, "question_id": 46275266, "link": "https://stackoverflow.com/questions/46275266/golang-refactoring-xml-tag-definition-in-struct", "title": "GoLang: Refactoring xml tag definition in struct", "body": "<pre><code>type Social struct {\n    XMLName  xml.Name `xml:\"social\"`\n    Facebook string   `xml:\"facebook\"`\n    Twitter  string   `xml:\"twitter\"`\n    Youtube  string   `xml:\"youtube\"`\n}\n</code></pre>\n\n<p>In the above example I have the <code>xml:\"facebook\"</code> reused in multiple structs. I would like to know if I can extract it to a constant and reference it in all structs.</p>\n\n<p>Or is that how you have to define the struct I read through the specs/documentations and did not find any specific way to achieve this.</p>\n\n<p>Is it possible?</p>\n\n<p>PS: My intention was to reduce the duplicate code as it is easy to mistype when you create a new struct (as it had happened to me few times).</p>\n"}, {"tags": ["go", "return-value"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1505712615, "post_id": 46271620, "comment_id": 79506649, "body": "You are basically asking: Why does Go implement the language specification?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1505719436, "post_id": 46271620, "comment_id": 79509888, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28487036/return-map-like-ok-in-golang-on-normal-functions/28487270#28487270\">Return map like &#39;ok&#39; in Golang on normal functions</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "is_accepted": false, "score": 2, "last_activity_date": 1505710524, "last_edit_date": 1505710524, "creation_date": 1505709642, "answer_id": 46271704, "question_id": 46271620, "link": "https://stackoverflow.com/questions/46271620/how-to-understand-the-golang-multi-return-value/46271704#46271704", "title": "How to understand the golang multi-return value", "body": "<p>You are confusing multiple values returned from a function with the so-called \"comma ok\" idiom.</p>\n\n<p>With a function's return values you must either handle all of them, or none of them. Simple.</p>\n\n<p>\"Comma ok\" is more subtle. Often the <em>behavior is changed</em> if you have a second value specified. Consider these statements:</p>\n\n<pre><code>v, ok := x.(int)\n// vs\nv := x.(int)\n</code></pre>\n\n<p>If <code>x</code> is an interface holding an integer, all is well, however, if <code>x</code> holds a different type the first statement will work (returning <code>0, false</code>), and the second one will panic.</p>\n\n<p>Each type of statement with a \"comma ok\" form is a different special case, and they are not the same as other kinds of multiple assignments (such as multiple function return values). You cannot compare them, each is its own thing, with its own rules.</p>\n"}, {"tags": [], "owner": {"reputation": 38497, "user_id": 104014, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3d186f3c6ad2de59b356c1cfad9af404?s=128&d=identicon&r=PG", "display_name": "Artem Barger", "link": "https://stackoverflow.com/users/104014/artem-barger"}, "is_accepted": true, "score": 11, "last_activity_date": 1505710108, "creation_date": 1505710108, "answer_id": 46271781, "question_id": 46271620, "link": "https://stackoverflow.com/questions/46271620/how-to-understand-the-golang-multi-return-value/46271781#46271781", "title": "How to understand the golang multi-return value", "body": "<p>This behavior clearly specified in the <a href=\"https://golang.org/ref/spec\" rel=\"noreferrer\">golang specification</a>:</p>\n\n<ol>\n<li><a href=\"https://golang.org/ref/spec#Receive_operator\" rel=\"noreferrer\">Receive operator</a></li>\n</ol>\n\n<blockquote>\n  <p>A receive expression used in an assignment or initialization of the special form</p>\n</blockquote>\n\n<pre><code>x, ok = &lt;-ch\nx, ok := &lt;-ch\nvar x, ok = &lt;-ch\nvar x, ok T = &lt;-ch\n</code></pre>\n\n<blockquote>\n  <p>yields an additional untyped boolean result reporting whether the communication succeeded. The value of ok is true if the value received was delivered by a successful send operation to the channel, or false if it is a zero value generated because the channel is closed and empty. </p>\n</blockquote>\n\n<ol start=\"2\">\n<li><a href=\"https://golang.org/ref/spec#Index_expressions\" rel=\"noreferrer\">Index expression</a></li>\n</ol>\n\n<blockquote>\n  <p>An index expression on a map a of type map[K]V used in an assignment or initialization of the special form</p>\n</blockquote>\n\n<pre><code>v, ok = a[x]\nv, ok := a[x]\nvar v, ok = a[x]\nvar v, ok T = a[x]\n</code></pre>\n\n<blockquote>\n  <p>yields an additional untyped boolean value. The value of ok is true if the key x is present in the map, and false otherwise. </p>\n</blockquote>\n\n<ol start=\"3\">\n<li><a href=\"https://golang.org/ref/spec#assign_op\" rel=\"noreferrer\">Assignments</a></li>\n</ol>\n\n<blockquote>\n  <p>A tuple assignment assigns the individual elements of a multi-valued operation to a list of variables. There are two forms. In the first, the right hand operand is a single multi-valued expression such as a function call, a channel or map operation, or a type assertion. The number of operands on the left hand side must match the number of values. For instance, if f is a function returning two values,</p>\n</blockquote>\n\n<pre><code>x, y = f()\n</code></pre>\n\n<blockquote>\n  <p>assigns the first value to x and the second to y. In the second form, the number of operands on the left must equal the number of expressions on the right, each of which must be single-valued, and the nth expression on the right is assigned to the nth operand on the left.</p>\n</blockquote>\n\n<p>Therefore as you can see this behavior being specified by language design and you cannot achieve those specified for <code>Receive operator</code> and <code>Index expression</code> by yourself.</p>\n"}], "owner": {"reputation": 95, "user_id": 6507836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80a17bb7ecb37f2f1f0e2906b0e2c253?s=128&d=identicon&r=PG", "display_name": "Sotter.liu", "link": "https://stackoverflow.com/users/6507836/sotter-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1457, "favorite_count": 0, "accepted_answer_id": 46271781, "answer_count": 2, "score": 1, "last_activity_date": 1537522918, "creation_date": 1505708880, "last_edit_date": 1537522918, "question_id": 46271620, "link": "https://stackoverflow.com/questions/46271620/how-to-understand-the-golang-multi-return-value", "title": "How to understand the golang multi-return value", "body": "<p>Golang supports assigning multiple return values to multiple left hand side variables. E.g:</p>\n\n<pre><code>func test() (string, string) {\n  return \"1\", \"1\"\n}\n\na, b := test()\n</code></pre>\n\n<p>or</p>\n\n<pre><code>a, _ := test()\n</code></pre>\n\n<p>and the number of receiving variables and return values must match:</p>\n\n<pre><code>b = test()   //wrong\n</code></pre>\n\n<p>But for some built-in types, such as [] or &lt;-, a variable number of return values are supported</p>\n\n<pre><code>key, exist := map[key]\n\nkey := map[key]\n</code></pre>\n\n<p>I can read value from channel like this</p>\n\n<pre><code>c &lt;- myChan\n\nc, exist &lt;- myChan\n</code></pre>\n\n<p>How can we explain the inconsistency? Is this a capability reserved to the core go runtime/language?</p>\n"}, {"tags": ["email", "go", "gmail"], "answers": [{"comments": [{"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 0, "creation_date": 1505785798, "post_id": 46272017, "comment_id": 79544075, "body": "You are right. Apparently the email not properly set to send from insecure devices. Thanks!"}], "tags": [], "owner": {"reputation": 2784, "user_id": 1487843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1BFY8.jpg?s=128&g=1", "display_name": "Marc Lambrichs", "link": "https://stackoverflow.com/users/1487843/marc-lambrichs"}, "is_accepted": true, "score": 1, "last_activity_date": 1505717857, "last_edit_date": 1505717857, "creation_date": 1505711707, "answer_id": 46272017, "question_id": 46271449, "link": "https://stackoverflow.com/questions/46271449/smtp-error-534-when-sending-email-through-gmail-in-golang-app/46272017#46272017", "title": "smtp error: 534 when sending email through gmail in golang app", "body": "<p>I've copied your gist, replaced from, to and password and it works flawlessly. The only reason why this code is not working is that you are NOT allowing less secure apps in gmail. </p>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1040, "favorite_count": 0, "accepted_answer_id": 46272017, "answer_count": 1, "score": 0, "last_activity_date": 1505717857, "creation_date": 1505707557, "last_edit_date": 1505708685, "question_id": 46271449, "link": "https://stackoverflow.com/questions/46271449/smtp-error-534-when-sending-email-through-gmail-in-golang-app", "title": "smtp error: 534 when sending email through gmail in golang app", "body": "<p>On my golang app I use <a href=\"https://gist.github.com/jpillora/cb46d183eca0710d909a\" rel=\"nofollow noreferrer\">this</a> snippet to send email from my gmail account:</p>\n\n<pre><code>func send(body string) {\n    from := \"myaccount@gmail.com\"\n    pass := \"mysupersecretpasswd\"\n    to := \"whoever@whatever.com\"\n\n    msg := \"From: \" + from + \"\\n\" +\n        \"To: \" + to + \"\\n\" +\n        \"Subject: Hello there\\n\\n\" +\n        body\n\n    err := smtp.SendMail(\"smtp.gmail.com:587\",\n        smtp.PlainAuth(\"\", from, pass, \"smtp.gmail.com\"),\n        from, []string{to}, []byte(msg))\n\n    if err != nil {\n        log.Printf(\"smtp error: %s\", err)\n        return\n    }\n\n    log.Print(\"sent, visit whatever)\n}\n</code></pre>\n\n<p>I get this error instead:</p>\n\n<pre><code>smtp error: 534 5.7.14 &lt;https://accounts.google.com/signin/continue?sarp=1&amp;scc=1&amp;plt=AKgnsbud\n5.7.14 lxVDnr-tXOckmxXi0fxExY5BKDRczBpGvMCpGWGF97jAI5DlM2oeGMDcIkvBhKT9rJAVnH\n5.7.14 WP7zxssynLtkzMb35et-wxJF2AfeBhMA81QqMh2F8fkQRdf9GidA3swFnjfsUl0Pw6fiMT\n5.7.14 b3zvEJyD6WAKEWcuxEGJIBTaqCtfDjipQ58cFJweUiKg1_4AJp0fGpC9ufnjBGWqWVKeW9\n5.7.14 QVbUstROYK0SzjWXTTvsvZhhG3RjM&gt; Please log in via your web browser and\n5.7.14 then try again.\n5.7.14  Learn more at\n5.7.14  https://support.google.com/mail/answer/78754 61sm6182123wre.44 - gsmtp\n</code></pre>\n\n<p>I have installed postfix on my localhost. I have also allowed less secure apps to access my account. \nI have also tried the same code on my VPS, but it does not send emails either.</p>\n\n<p>So what could be wrong? How can I fix it?</p>\n"}, {"tags": ["javascript", "go", "websocket"], "comments": [{"owner": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "edited": false, "score": 0, "creation_date": 1505727195, "post_id": 46271256, "comment_id": 79514620, "body": "Please write what error are you getting while running your go code. Without that it&#39;s hard to say what happened."}, {"owner": {"reputation": 23, "user_id": 8624441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/298d5c75780a95f368cb56e337d201ad?s=128&d=identicon&r=PG&f=1", "display_name": "Belarus", "link": "https://stackoverflow.com/users/8624441/belarus"}, "reply_to_user": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "edited": false, "score": 0, "creation_date": 1505730335, "post_id": 46271256, "comment_id": 79516618, "body": "@Nebril - Error message updated."}], "answers": [{"tags": [], "owner": {"reputation": 769, "user_id": 2647655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qGHOi.png?s=128&g=1", "display_name": "kataras", "link": "https://stackoverflow.com/users/2647655/kataras"}, "is_accepted": false, "score": 1, "last_activity_date": 1525274109, "creation_date": 1525274109, "answer_id": 50138045, "question_id": 46271256, "link": "https://stackoverflow.com/questions/46271256/websocket-message-to-specific-room-golang-kataras-iris/50138045#50138045", "title": "Websocket message to Specific Room - Golang Kataras/Iris", "body": "<p>It was a tiny bug, <strong>fixed</strong> just moments ago. Please upgrade with:</p>\n\n<pre><code>go get -u github.com/kataras/iris\n</code></pre>\n\n<p>A new release \"v10.6.3\" was also pushed.</p>\n\n<p>Thank you a lot @Belarus, you're great!</p>\n\n<p>Sincerely,</p>\n\n<p><em>Gerasimos Maropoulos,\nAuthor of the Iris web framework.</em></p>\n"}], "owner": {"reputation": 23, "user_id": 8624441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/298d5c75780a95f368cb56e337d201ad?s=128&d=identicon&r=PG&f=1", "display_name": "Belarus", "link": "https://stackoverflow.com/users/8624441/belarus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525274109, "creation_date": 1505705962, "last_edit_date": 1505730315, "question_id": 46271256, "link": "https://stackoverflow.com/questions/46271256/websocket-message-to-specific-room-golang-kataras-iris", "title": "Websocket message to Specific Room - Golang Kataras/Iris", "body": "<p>I am trying to send Message to Particular Room, but it doesn't work and It sends message to all room along with my message being received twice from my name and with first chat room user name. Message from 1 Room is broadcasted to all Chat Room.</p>\n\n<p>I have used Example Code from here- <a href=\"https://github.com/kataras/iris/blob/master/_examples/websocket/secure/main.go\" rel=\"nofollow noreferrer\">https://github.com/kataras/iris/blob/master/_examples/websocket/secure/main.go</a>.  and \n<a href=\"https://github.com/kataras/iris/blob/master/_examples/websocket/native-messages/main.go\" rel=\"nofollow noreferrer\">https://github.com/kataras/iris/blob/master/_examples/websocket/native-messages/main.go</a></p>\n\n<p>Below is the Code, I am using, that is giving me the error :</p>\n\n<pre><code>        var myChatRoom = strconv.Itoa(room.ID)\n        ws := websocket.New(websocket.Config{})\n        ws.OnConnection(func(c websocket.Connection) {\n            c.Join(myChatRoom)\n            c.To(myChatRoom).EmitMessage([]byte(user.(users).Username + \" has Joined Chat!\"))\n            c.OnMessage(func(data []byte) {\n                message := string(data)\n                if message == \"leave\" {\n                    c.Leave(myChatRoom)\n                    c.To(myChatRoom).EmitMessage([]byte(user.(users).Username + \" has Left Chat!\"))\n                    return\n                }\n                c.To(myChatRoom).EmitMessage([]byte(user.(users).Username + \": \" + message))\n            })\n            c.OnDisconnect(func() {\n                fmt.Printf(\"Connection with ID: %s has been disconnected!\\n\", c.ID())\n            })\n        })\n</code></pre>\n\n<p>HTML Code:</p>\n\n<pre><code>&lt;div id=\"messages\" style=\"border-width: 1px; border-style: solid; height: 200px;overflow:auto\"&gt;&lt;/div&gt;\n    &lt;input type=\"text\" id=\"messageTxt\" /&gt;\n    &lt;button type=\"button\" id=\"sendBtn\"&gt;Send&lt;/button&gt;\n</code></pre>\n\n<p>Javascript Code:</p>\n\n<pre><code>&lt;script&gt;\n  var messageTxt;\n  var messages;\n  var HOST = 'localhost'\n  jQuery(function() {\n    messageTxt = jQuery(\"#messageTxt\");\n    messages = jQuery(\"#messages\");\n    w = new WebSocket(\"ws://\" + HOST + \"/my_endpoint\");\n    w.onopen = function() {\n      console.log(\"Websocket connection enstablished\");\n    };\n    w.onclose = function() {\n      appendMessage(jQuery(\"&lt;div&gt;&lt;center&gt;&lt;h3&gt;Disconnected&lt;/h3&gt;&lt;/center&gt;&lt;/div&gt;\"));\n    };\n    w.onmessage = function(message) {\n      console.log(\"Message Appended: \" + message)\n      appendMessage(jQuery(\"&lt;div&gt;\" + message.data + \"&lt;/div&gt;\"));\n    };\n    jQuery(\"#sendBtn\").click(function() {\n      w.send(messageTxt.val().toString());\n      messageTxt.val(\"\");\n    });\n  })\n\n  function appendMessage(messageDiv) {\n    messageDiv.appendTo(jQuery(\"#messages\"));\n  }\n&lt;/script&gt;\n</code></pre>\n\n<p><strong>Error:</strong></p>\n\n<ol>\n<li><p>It sends message to all ROOM and not specific Room.</p></li>\n<li><p>User who created room first automatically joins all the ROOM</p></li>\n<li><p>People sending message in other ROOM see their message being Repeated/cloned in their ROOM by \"FirstUser\" who created first room in chat. (Irrespective of whether he is member of the chat group or not)</p></li>\n</ol>\n\n<p><strong>Expecting:</strong></p>\n\n<ol>\n<li><p>People can send/receive message to only those room where they have joined.</p></li>\n<li><p>First User should not be able to join CHATRoom automatically.</p></li>\n<li><p>People should not see their message being repeated again with \"FirstUser\" name.</p></li>\n</ol>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1505750101, "post_id": 46269946, "comment_id": 79530017, "body": "@Wiktor this is not exactly duplicate. Even if I know the other post, I would love to know how to do this in Golang."}], "answers": [{"tags": [], "owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "is_accepted": true, "score": 4, "last_activity_date": 1505693402, "creation_date": 1505693402, "answer_id": 46269994, "question_id": 46269946, "link": "https://stackoverflow.com/questions/46269946/golang-split-strings-by-char-type/46269994#46269994", "title": "Golang split strings by char type", "body": "<p>Try splitting on this pattern:</p>\n\n<pre><code>\\d+|\\D+\n</code></pre>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>re:=regexp.MustCompile(\"\\\\d+|\\\\D+\")\nfmt.Println(re.FindAllString(\"abc123def\", -1))\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>[abc 123 def]\n</code></pre>\n\n<p><strong>Demo here:</strong></p>\n\n<p><a href=\"http://rextester.com/HGAO19558\" rel=\"nofollow noreferrer\"><h1>Rextester</h1></a></p>\n"}], "owner": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "closed_date": 1505719639, "accepted_answer_id": 46269994, "answer_count": 1, "score": 0, "last_activity_date": 1505693402, "creation_date": 1505692794, "question_id": 46269946, "link": "https://stackoverflow.com/questions/46269946/golang-split-strings-by-char-type", "closed_reason": "Duplicate", "title": "Golang split strings by char type", "body": "<p>I want to be able to split the string into substrings where characters and numbers are separate groups:</p>\n\n<pre><code>re:=regexp.MustCompile(\"**MAGIC HERE**\")\nfmt.Println(re.FindAllString(\"abc123def\", -1))\n</code></pre>\n\n<p>I want to be able to get</p>\n\n<pre><code>[abc 123 def]\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "edited": false, "score": 0, "creation_date": 1505683164, "post_id": 46268940, "comment_id": 79500449, "body": "since the json keys are dynamic/unpredictable, you can simply define a struct field e.g. <i>Names</i> with type <code>map[string]uint64</code>. what you need is a method to get the value from input name, as in the map. Likewise, your <code>loadFileToJson</code> can accept the <i>settings</i> struct and parse it to <i>Names</i> field"}, {"owner": {"reputation": 10216, "user_id": 854207, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/R6DhK.jpg?s=128&g=1", "display_name": "paul", "link": "https://stackoverflow.com/users/854207/paul"}, "reply_to_user": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "edited": false, "score": 0, "creation_date": 1505683592, "post_id": 46268940, "comment_id": 79500551, "body": "@Anzel yor solution does not work, I&#180;m doing something wrong?. Thanks"}, {"owner": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "edited": false, "score": 0, "creation_date": 1505684033, "post_id": 46268940, "comment_id": 79500650, "body": "does it work for you now, I have included a mini sample for your reference. Basically, depending on your map values, you may define that as <code>map[string]uint64</code> or whatever like <code>map[string]interface{}</code>."}, {"owner": {"reputation": 10216, "user_id": 854207, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/R6DhK.jpg?s=128&g=1", "display_name": "paul", "link": "https://stackoverflow.com/users/854207/paul"}, "reply_to_user": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "edited": false, "score": 0, "creation_date": 1505684352, "post_id": 46268940, "comment_id": 79500734, "body": "Yeah I create the Struct with that type, but does not working. As you suggest now it&#180;s working. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 3, "last_activity_date": 1505683652, "creation_date": 1505683652, "answer_id": 46269027, "question_id": 46268940, "link": "https://stackoverflow.com/questions/46268940/unmarshal-json-without-elements-names/46269027#46269027", "title": "Unmarshal json without elements names", "body": "<p>As @Anzel pointed out your data appears to be perfect for a <code>map[string]uint64</code>.  This assumes a couple things, namely that your object keys are always strings (as in your example) and that the values are always uint64 (again as your sample data suggested).  As such, unmarshal into that data type instead of <code>interface{}</code></p>\n\n<pre><code>plan := []byte(`{\"707514313\":1505680270,\"1568212945\":1505676950,\"732898933\":1505681884}`)\nvar data map[string]uint64\njson.Unmarshal(plan, &amp;data)\nfmt.Printf(\"Data is %+v\\n\", data)\n</code></pre>\n\n<p><strong>OUTPUT</strong></p>\n\n<pre><code>Data is map[1568212945:1505676950 732898933:1505681884 707514313:1505680270]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "is_accepted": true, "score": 2, "last_activity_date": 1505684312, "last_edit_date": 1505684312, "creation_date": 1505683764, "answer_id": 46269041, "question_id": 46268940, "link": "https://stackoverflow.com/questions/46268940/unmarshal-json-without-elements-names/46269041#46269041", "title": "Unmarshal json without elements names", "body": "<p>As commented, you just need to set the field type as <code>map[string]uint64</code> and implement a few methods to parse the file and get the map value.</p>\n\n<p>See in this playground for some pseudo code:\n<a href=\"https://play.golang.org/p/OfSF2kMid9\" rel=\"nofollow noreferrer\">playground</a></p>\n\n<p>However, depending on your map values, you may need to define the field type as <code>map[string]uint64</code> or whatever reflecting the json structure, e.g. <code>map[string]interface{}</code> or even a separate embedded struct with nested structure.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 10216, "user_id": 854207, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/R6DhK.jpg?s=128&g=1", "display_name": "paul", "link": "https://stackoverflow.com/users/854207/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1028, "favorite_count": 0, "accepted_answer_id": 46269041, "answer_count": 2, "score": -2, "last_activity_date": 1505684312, "creation_date": 1505682866, "last_edit_date": 1505683525, "question_id": 46268940, "link": "https://stackoverflow.com/questions/46268940/unmarshal-json-without-elements-names", "title": "Unmarshal json without elements names", "body": "<p>I\u00b4m trying to read a json file and parse into jsonObject in my Go class.\nThe json has a random names and number of elements when I receive it.\nFor example:</p>\n\n<pre><code>{\"707514313\":1505680270,\"1568212945\":1505676950,\"732898933\":1505681884}\n</code></pre>\n\n<p>So all the examples that I\u00b4ve seen that use an struct to define the interface for the unmarshal, where they put the names of the json values, but in my case I cannot do it since I dont know how many and the name of the values of the json.</p>\n\n<pre><code>var settings struct {\n    Name1  string `json:\"707514313\"`\n    Name2  string `json:\"1568212945\"`\n    Who knows how many more and with which names?!\n}\n</code></pre>\n\n<p>So I end up unmarshalling with the default interface</p>\n\n<pre><code>func loadFileToJson(filename string) {\n    plan, _ := ioutil.ReadFile(filename)\n    var data interface{}\n    checkError(json.Unmarshal(plan, &amp;data))\n    fmt.Println(\"Data %s \", data)\n}\n</code></pre>\n\n<p>That load in data a <code>(map[String]interface{})</code></p>\n\n<p>Any idea how to achieve what I want.</p>\n\n<p>EDIT:</p>\n\n<p>I create this struct</p>\n\n<pre><code>type Structure struct {\n    Name map[string]uint64\n}\n</code></pre>\n\n<p>And changing the old default by </p>\n\n<pre><code>var jsonObject []Structure\ncheckError(json.Unmarshal(plan, &amp;jsonObject))\n</code></pre>\n\n<p>Is giving me this error</p>\n\n<pre><code>json: cannot unmarshal object into Go value of type []main.StructureData %s  []\n</code></pre>\n"}, {"tags": ["go", "fuse"], "answers": [{"tags": [], "owner": {"reputation": 792, "user_id": 3729597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOwN9.jpg?s=128&g=1", "display_name": "lyang", "link": "https://stackoverflow.com/users/3729597/lyang"}, "is_accepted": false, "score": 0, "last_activity_date": 1544260469, "last_edit_date": 1544260469, "creation_date": 1544250111, "answer_id": 53680109, "question_id": 46267972, "link": "https://stackoverflow.com/questions/46267972/fuse-avoid-calculating-size-in-getattr/53680109#53680109", "title": "FUSE - avoid calculating size in GetAttr", "body": "<p>The problem you are seeing is because the the kernel is buffering your read, and when it does so, it uses the size of the inode to calculate exactly how many bytes it has to copy to userspace (<a href=\"https://elixir.bootlin.com/linux/v4.19.7/source/mm/filemap.c#L2137\" rel=\"nofollow noreferrer\">https://elixir.bootlin.com/linux/v4.19.7/source/mm/filemap.c#L2137</a>). So there are different workarounds:</p>\n\n<ol>\n<li><p>Return huge st_size from GetAttr</p></li>\n<li><p>When you open the file, set the direct_io flag so you don't use page caches.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 548, "user_id": 5614677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65189b587a759ea394764c2b449cd3be?s=128&d=identicon&r=PG&f=1", "display_name": "randomeval", "link": "https://stackoverflow.com/users/5614677/randomeval"}, "is_accepted": false, "score": 0, "last_activity_date": 1586881773, "creation_date": 1586881773, "answer_id": 61212593, "question_id": 46267972, "link": "https://stackoverflow.com/questions/46267972/fuse-avoid-calculating-size-in-getattr/61212593#61212593", "title": "FUSE - avoid calculating size in GetAttr", "body": "<p>I don't know the go-fuse's API. Below info is based on libfuse's API.</p>\n\n<p>The SSHFS's GetAttr is implement in function <code>sshfs_getattr</code>, it looks like send network request get file size info.</p>\n\n<p>When you run <code>cd</code>, it will run <code>.access</code> callback to check directory exists.</p>\n\n<p>When you run <code>ls</code>, it will first call <code>.readdir</code> callback get dir info, then call <code>.getattr</code> get info for files in that dir.</p>\n\n<p>When you run <code>cat</code>, it will first call <code>.getattr</code> get info for file and info for path. Then call <code>.open</code> => <code>.read</code> => <code>.release</code>.</p>\n\n<p>FUSE's is lack of doc, you better first write an example, then you can add some <code>printf</code> in those callbacks to get some info. </p>\n\n<ol>\n<li>In <code>.open</code>, you can create an privite data and set it to <code>fuse_file_info::fh</code>. This <code>fuse_file_info::fh</code> can be used in later <code>.read</code> callbacks.</li>\n<li>You can set all size info to zero in <code>.getattr</code> callbacks. Then in <code>.open</code>, you set <code>fuse_file_info::direct_io</code> to 1. In <code>.read</code>, first read data from network, if you reach the end of file, then <code>return 0</code> in <code>.read</code>.</li>\n</ol>\n\n<p>This <a href=\"https://www.cs.hmc.edu/~geoff/classes/hmc.cs135.201001/homework/fuse/fuse_doc.html\" rel=\"nofollow noreferrer\">doc</a> helps me a lot, when I wrote my filesystem.</p>\n"}], "owner": {"reputation": 4600, "user_id": 310298, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/PkUnq.png?s=128&g=1", "display_name": "itaysk", "link": "https://stackoverflow.com/users/310298/itaysk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 944, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1586881773, "creation_date": 1505676007, "last_edit_date": 1505719693, "question_id": 46267972, "link": "https://stackoverflow.com/questions/46267972/fuse-avoid-calculating-size-in-getattr", "title": "FUSE - avoid calculating size in GetAttr", "body": "<p>I'm implementing a FUSE file system for a remote service.\nWhen the user opens a file I do a network call to get the file's contents. <a href=\"https://github.com/hanwen/go-fuse/issues/186\" rel=\"noreferrer\">It appears</a> that the file's size must be reported through <code>GetAttr</code> in order for open to work.<br>\nIn order to know the file's size, I have to issue a network call, and since <code>GetAttr</code> is called for every entry when doing <code>ls</code>, I'm concerned about this design (if a user does <code>ls</code> in a directory with many items, it will have to get all the files, even if the user didn't want to open any of them).</p>\n\n<p>How can I work around this problem? My thoughts were:</p>\n\n<ul>\n<li>Use a lower level method for reading that doesn't rely on reported size? I thought using <code>Read</code> instead of <code>Open</code> could help, however I couldn't get it to work without a size.</li>\n<li>If I could distinguish <code>GetAttr</code> calls that originated from <code>Open</code> from other calls (including <code>ls</code>), I could issue the network calls only when needed.</li>\n</ul>\n\n<p>I use Go and <a href=\"https://github.com/hanwen/go-fuse\" rel=\"noreferrer\">go-fuse</a>, but I think it shouldn't matter because it's a general FUSE question.</p>\n\n<p>Also, FUSE docs are very minimal (missing actually) documentation. It would be nice if someone familiar with the matter can explain the call flow for <code>ls</code>, <code>cd</code> and <code>cat</code> - what FUSE functions are called in which order.<br>\nFor example, why there is both <code>Open</code> and <code>Read</code>.</p>\n\n<p><strong>Update:</strong><br>\nI've been browsing SSHFS which is considered the canonical example for a FUSE filesystem, and it seems that it also gets the file over network on getattr: <a href=\"https://github.com/libfuse/sshfs/blob/master/sshfs.c#L3167\" rel=\"noreferrer\">https://github.com/libfuse/sshfs/blob/master/sshfs.c#L3167</a><br>\nWhat do you think?</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 1, "creation_date": 1505674127, "post_id": 46267073, "comment_id": 79497895, "body": "Use <code>select * from mytest()</code>"}, {"owner": {"reputation": 24536, "user_id": 111124, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8215e290861f1c44a457d26c4f24af70?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/111124/andrew"}, "edited": false, "score": 0, "creation_date": 1505679829, "post_id": 46267073, "comment_id": 79499570, "body": "use Query not QueryRow and store your data into a suitable structure e.g. array of a struct, or an array of map[string]interface"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1505683279, "post_id": 46267073, "comment_id": 79500474, "body": "IMHO the &quot;ideomatic&quot; way in postgres is: dont use &quot;stored procedures&quot;. Just assume they don&#39;t exist. Instead generate queries on the fly or use pre-cooked views."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 0, "last_activity_date": 1505670921, "creation_date": 1505670921, "answer_id": 46267149, "question_id": 46267073, "link": "https://stackoverflow.com/questions/46267073/what-is-the-idiomatic-way-to-retrieve-results-from-a-stored-procedure/46267149#46267149", "title": "What is the idiomatic way to retrieve results from a stored procedure?", "body": "<p>Instead of a Query, you could try a PostgreSQL typesafe1 ORM , like <a href=\"https://github.com/src-d/go-kallax\" rel=\"nofollow noreferrer\"><code>src-d/go-kallax</code></a>, which <a href=\"https://github.com/src-d/go-kallax/blob/a7eb23f15001a897bd8b24c284dbe67b060effd3/generator/processor.go#L389-L406\" rel=\"nofollow noreferrer\">deals with tuples</a>.</p>\n\n<p>You can see kalax presented in this <a href=\"https://blog.sourced.tech/post/kallax/\" rel=\"nofollow noreferrer\">blog post</a></p>\n\n<blockquote>\n  <ul>\n  <li>the first priority of kallax is to provide type safety to the data access layer. </li>\n  <li>Another goal of kallax is to make sure all models are, first and foremost, Go structs without having to use database-specific types such as, for example, sql.NullInt64. Support for arrays and slices of all basic Go types and all JSON and arrays operators is provided as well.</li>\n  </ul>\n</blockquote>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 2, "accepted_answer_id": 46267149, "answer_count": 1, "score": 2, "last_activity_date": 1505670921, "creation_date": 1505670471, "question_id": 46267073, "link": "https://stackoverflow.com/questions/46267073/what-is-the-idiomatic-way-to-retrieve-results-from-a-stored-procedure", "title": "What is the idiomatic way to retrieve results from a stored procedure?", "body": "<pre><code>DROP function mytest();\nCREATE OR REPLACE FUNCTION mytest() \nRETURNS TABLE(name text, age int)\n AS \n$$ \nSELECT name, age FROM names\n$$ \nLANGUAGE sql;\n</code></pre>\n\n<p>Most of the examples I've seen with a stored procedure return a single row with a single column and can be used with QueryRow. Here I am using a table as the output. This above returns 4 rows:</p>\n\n<pre><code>    mytest   \n------------\n (bob,12)\n (fred,18)\n (james,22)\n (bill,27)\n(4 rows)\n</code></pre>\n\n<p>In Go, what is the idiomatic way to deal with the tuples:</p>\n\n<pre><code>rows, err := db.Query(\"SELECT mytest()\")\nif err != nil {\n    panic(err)\n}\n\ndefer rows.Close()\nfor rows.Next() {\n    var items string\n\n    if err = rows.Scan(&amp;items); err != nil {\n        panic(err)\n    }\n\n    log.Println(items) // items is a string...now what?\n\n}\nif err = rows.Err(); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>// prints some tuples:</p>\n\n<pre><code>(bob,12)\n(fred,18)\n(james,22)\n(bill,27)\n</code></pre>\n\n<p>Maybe there's a package for this but I haven't found it ;(</p>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1505718734, "post_id": 46265834, "comment_id": 79509439, "body": "Please explain why it is not appropriate to use <code>fmt.Sscan(&quot;10&quot;, &amp;S.I)</code> (which works as expected)."}, {"owner": {"reputation": 10078, "user_id": 2709018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/p98Vl.png?s=128&g=1", "display_name": "myaut", "link": "https://stackoverflow.com/users/2709018/myaut"}, "reply_to_user": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 1, "creation_date": 1505724738, "post_id": 46265834, "comment_id": 79512974, "body": "@KavehShahbazian because type of structure is not known"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1505665535, "creation_date": 1505665535, "answer_id": 46266297, "question_id": 46265834, "link": "https://stackoverflow.com/questions/46265834/setting-value-of-the-structure-via-fmt-sscan/46266297#46266297", "title": "Setting value of the structure via fmt.Sscan", "body": "<p>The <code>Interface()</code> method returns the value, not a reference to the value.  Take the address (by calling <a href=\"https://godoc.org/reflect#Value.Addr\" rel=\"nofollow noreferrer\"><code>Addr()</code></a>) of the field to scan directly to the field:</p>\n\n<pre><code>var S struct{ I int }\nf := reflect.Indirect(reflect.ValueOf(&amp;S)).Field(0)\nfmt.Sscan(\"10\", f.Addr().Interface())  \nfmt.Println(S) // {0}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/6_4DjiFZB2\" rel=\"nofollow noreferrer\">https://play.golang.org/p/6_4DjiFZB2</a></p>\n"}], "owner": {"reputation": 10078, "user_id": 2709018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/p98Vl.png?s=128&g=1", "display_name": "myaut", "link": "https://stackoverflow.com/users/2709018/myaut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 46266297, "answer_count": 1, "score": 0, "last_activity_date": 1505665702, "creation_date": 1505662628, "last_edit_date": 1505665702, "question_id": 46265834, "link": "https://stackoverflow.com/questions/46265834/setting-value-of-the-structure-via-fmt-sscan", "title": "Setting value of the structure via fmt.Sscan", "body": "<p>I want to synchronize state between <code>map[string]string</code> and custom Go structure and came to a conclusion that simplest way to parse it is to use <code>fmt.Sscan</code> for fields. </p>\n\n<p>Unfortunately, direct approach is not working (<a href=\"https://play.golang.org/p/QaRuinJ_dv\" rel=\"nofollow noreferrer\">playground</a>):</p>\n\n<pre><code>var S struct{ I int }\n\nf := reflect.Indirect(reflect.ValueOf(&amp;S)).Field(0)\nfmt.Sscan(\"10\", f.Interface())\nfmt.Println(S) // {0}\n</code></pre>\n\n<p>Introducing an intermediate value and using <code>Set()</code>, however, solves the issue:</p>\n\n<pre><code>nv := reflect.New(f.Type())\nfmt.Sscan(\"10\", nv.Interface())\nf.Set(reflect.Indirect(nv))\nfmt.Println(S) // {10}\n</code></pre>\n\n<p>I wonder why the first approach didn't work. Isn't <code>Interface()</code> returns a kind of reference to a field which can be used to change its value?</p>\n"}, {"tags": ["go", "composition"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1505712790, "post_id": 46265777, "comment_id": 79506713, "body": "Just because something is syntactically valid doesn&#39;t mean it is idiomatic. Please do not try to model your code like you would in traditional OOP."}, {"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1505713010, "post_id": 46265777, "comment_id": 79506787, "body": "I am looking for idiomatic solutions. I know only traditional OOP."}], "answers": [{"comments": [{"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 0, "creation_date": 1505675567, "post_id": 46266534, "comment_id": 79498343, "body": "IronMan is also Runner and Cyclist. With your solution you must pass three time person? IronMan{Swimmer{Person{&quot;Mariottide&quot;},Runner{Person{&quot;Mariotti&zwnj;&#8203;de&quot;}, ...}"}, {"owner": {"reputation": 728, "user_id": 3348617, "user_type": "registered", "profile_image": "https://graph.facebook.com/1475953069/picture?type=large", "display_name": "zdebra", "link": "https://stackoverflow.com/users/3348617/zdebra"}, "reply_to_user": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 0, "creation_date": 1505678358, "post_id": 46266534, "comment_id": 79499167, "body": "Yes. You can create factory for that. This is how golang composition works. Check this article <a href=\"http://hackthology.com/object-oriented-inheritance-in-go.html\" rel=\"nofollow noreferrer\">hackthology.com/object-oriented-inheritance-in-go.html</a>"}], "tags": [], "owner": {"reputation": 728, "user_id": 3348617, "user_type": "registered", "profile_image": "https://graph.facebook.com/1475953069/picture?type=large", "display_name": "zdebra", "link": "https://stackoverflow.com/users/3348617/zdebra"}, "is_accepted": true, "score": 1, "last_activity_date": 1505721402, "last_edit_date": 1505721402, "creation_date": 1505667151, "answer_id": 46266534, "question_id": 46265777, "link": "https://stackoverflow.com/questions/46265777/is-this-a-valid-implementation-of-composition-in-go/46266534#46266534", "title": "Is this a valid implementation of composition in Go?", "body": "<p>Go has <code>struct</code> embedding:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Person struct{ name string }\n\nfunc (p *Person) Talk(message string) {\n    fmt.Printf(\"%s says: %s\\n\", p.name, message)\n}\n\ntype Swimmer struct {\n    Person\n}\n\nfunc (s *Swimmer) Swim() {\n    fmt.Printf(\"%s is swimming\\n\", s.name)\n}\n\ntype IronMan struct {\n    Swimmer\n}\n\nfunc main() {\n    ironMan := IronMan{Swimmer{Person{\"Mariottide\"}}}\n\n    ironMan.Swim()\n    ironMan.Talk(\"Hey\")\n}\n</code></pre>\n"}], "owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 46266534, "answer_count": 1, "score": 0, "last_activity_date": 1505721402, "creation_date": 1505662215, "last_edit_date": 1505721349, "question_id": 46265777, "link": "https://stackoverflow.com/questions/46265777/is-this-a-valid-implementation-of-composition-in-go", "title": "Is this a valid implementation of composition in Go?", "body": "<p>Is this valid composition? Or there are other solutions?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\ntype Person struct{ name string }\n\ntype Swimmer struct{}\n\nfunc (s *Swimmer) Swim(name string) {\n    fmt.Println(strings.Join([]string{\n        name,\n        \" is swimming\",\n    }, \"\"))\n}\n\ntype IronMan struct {\n    person  Person\n    swimmer Swimmer\n}\n\nfunc (i *IronMan) Swim() {\n    i.swimmer.Swim(i.person.name)\n}\n\nfunc main() {\n    ironMan := IronMan{\n        person:  Person{\"Mariottide\"},\n        swimmer: Swimmer{},\n    }\n\n    ironMan.Swim()\n}\n</code></pre>\n"}, {"tags": ["go", "marshalling"], "answers": [{"tags": [], "owner": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "is_accepted": true, "score": 0, "last_activity_date": 1505673059, "creation_date": 1505673059, "answer_id": 46267526, "question_id": 46265751, "link": "https://stackoverflow.com/questions/46265751/omitting-json-for-empty-custom-type/46267526#46267526", "title": "Omitting JSON for Empty Custom Type", "body": "<p>If you create you type like so:</p>\n\n<pre><code>Data {\n    X: datetime,\n    Y: value,\n    Stderr: nil,\n}\n</code></pre>\n\n<p><code>omitempty</code> will kick in and \"do the right thing\". Sadly, I'm pretty sure this won't help you.</p>\n\n<p>If you really want to omit a field based and internal state, you need to implement <code>json.Marshaller</code> on your structure, not its children. The easiest way to do this would be as follows:</p>\n\n<pre><code>func (d Data) MarshalJSON() ([]byte, error) {\n    if !d.Stderr.Valid {\n        return json.Marshal(Data{d.X, d.Y, nil})\n    }\n    return json.Marshal(d)\n}\n</code></pre>\n"}], "owner": {"reputation": 5438, "user_id": 1944335, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8675e8c601fc98c0ad3a8272b417d0de?s=128&d=identicon&r=PG&f=1", "display_name": "James Taylor", "link": "https://stackoverflow.com/users/1944335/james-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 959, "favorite_count": 0, "accepted_answer_id": 46267526, "answer_count": 1, "score": 2, "last_activity_date": 1505673059, "creation_date": 1505662050, "last_edit_date": 1505662500, "question_id": 46265751, "link": "https://stackoverflow.com/questions/46265751/omitting-json-for-empty-custom-type", "title": "Omitting JSON for Empty Custom Type", "body": "<p>I am trying to write a custom marshaler for a possibly <code>nil</code> database type. It is structured in the exact same way as the <code>sql.NullFloat64</code> type:</p>\n\n<pre><code>type NullFloat64 sql.NullFloat64\n\nfunc (ni *NullFloat64) MarshalJSON() ([]byte, error) {\n    if !ni.Valid {\n        return []byte(\"null\"), nil\n    }\n    return json.Marshal(ni.Float64)\n}\n</code></pre>\n\n<p>Which is a part of larger <code>struct</code> to be marshaled:</p>\n\n<pre><code>type Data struct {\n    X time.Time `json:\"x\"`\n    Y float32 `json:\"y\"`\n    Stderr NullFloat64 `json:\"stderr\"`\n}\n</code></pre>\n\n<p>If I try to <code>json.Marshal()</code> this <code>struct</code>, it works correctly, creating:</p>\n\n<pre><code>{\"x\":\"2017-01-12T23:36:12-05:00\",\"y\":4,\"stderr\":null}\n</code></pre>\n\n<p>I would like to omit the JSON key entirely if the value is <code>null</code>. I added <code>json:\"stderr,omitempty\"</code> to <code>Data</code>.</p>\n\n<p>Per the suggestion <a href=\"https://stackoverflow.com/a/18089594/1944335\">here</a>, I tried just returning a <code>nil</code> value from <code>MarshalJSON</code>, but got:</p>\n\n<pre><code>json: error calling MarshalJSON for type common.NullFloat64: unexpected end of JSON input\n</code></pre>\n\n<p>I also tried updating <code>Data</code> as:</p>\n\n<pre><code>type Data struct {\n    X time.Time `json:\"x\"`\n    Y float32 `json:\"y\"`\n    Stderr *NullFloat64 `json:\"stderr,omitempty\"`\n}\n</code></pre>\n\n<p>And marshaling:</p>\n\n<pre><code>Data {\n    X: datetime,\n    Y: value,\n    Stderr: &amp;stderr,\n}\n</code></pre>\n\n<p>But got the same error when returning <code>nil</code> from <code>MarshalJSON</code> as before.</p>\n\n<p>So, how can I implement <code>MarshalJSON</code> for a custom type and omit the key when marshaling?\nThanks for the help! </p>\n"}, {"tags": ["go", "composite"], "answers": [{"tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 1, "last_activity_date": 1505674365, "creation_date": 1505674365, "answer_id": 46267724, "question_id": 46265534, "link": "https://stackoverflow.com/questions/46265534/can-go-object-components-talk-to-each-others-in-composite-pattern/46267724#46267724", "title": "Can go object components talk to each others in composite pattern?", "body": "<p>Yes, it is possible.</p>\n\n<p>You can declare a <code>Train()</code> method for <code>CompositeAthlete</code>, and that method would have access to all <code>CompositeAthlete</code> fields (the function and the <code>athlete</code>).</p>\n\n<p>Then you can use the function from inside the method.</p>\n\n<p>Here's how you'd implement it, to make it more clear.</p>\n\n<p><strong>CompositeAthlete definition</strong></p>\n\n<p>(note that I have changed the field to <code>TrainFunc</code> so that it does not conflict with the method name)</p>\n\n<pre><code>type CompositeAthlete struct {\n    athlete Athlete\n    TrainFunc   func(name string)\n}\n</code></pre>\n\n<p>Then the <code>Train()</code> method would just do:</p>\n\n<pre><code>func (c *CompositeAthlete) Train() {\n    c.TrainFunc(c.athlete.name)\n}\n</code></pre>\n\n<p>And you would use it almost the same as before (only the field name has changed):</p>\n\n<pre><code>comp := CompositeAthlete{\n    athlete: athlete,\n    TrainFunc:   Swim,\n}\ncomp.Train()\n</code></pre>\n\n<p>See it working in this playground:</p>\n\n<p><a href=\"https://play.golang.org/p/xibH_tFers\" rel=\"nofollow noreferrer\">https://play.golang.org/p/xibH_tFers</a></p>\n"}], "owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 46267724, "answer_count": 1, "score": 0, "last_activity_date": 1505674365, "creation_date": 1505660785, "question_id": 46265534, "link": "https://stackoverflow.com/questions/46265534/can-go-object-components-talk-to-each-others-in-composite-pattern", "title": "Can go object components talk to each others in composite pattern?", "body": "<p>I am trying to implement composite design pattern. I understood how to compose an object of object. In this example I have an athlete and the swim function.</p>\n\n<pre><code>type Athlete struct {\n    name string\n}\n\ntype CompositeAthlete struct {\n    athlete Athlete\n    Train   func(name string)\n}\n</code></pre>\n\n<p>But if I need to pass the name after composed object creation:</p>\n\n<pre><code>    comp := CompositeAthlete{\n        athlete: athlete,\n        Train:   Swim,\n    }\n    comp.Train(athlete.name)\n</code></pre>\n\n<p>Is it possible to inject a method that is able to read inside the object where is injected;</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\ntype Athlete struct {\n    name string\n}\n\ntype CompositeAthlete struct {\n    athlete Athlete\n    Train   func(name string)\n}\n\nfunc (a *Athlete) Train() {\n    fmt.Println(\"training ...\")\n}\n\nfunc Swim(name string) {\n    fmt.Println(strings.Join([]string{\n        name,\n        \" is swimming\",\n    }, \"\"))\n}\n\nfunc main() {\n    fmt.Println(\"vim-go\")\n\n    athlete := Athlete{\"Mariottide\"}\n    athlete.Train()\n\n    comp := CompositeAthlete{\n        athlete: athlete,\n        Train:   Swim,\n    }\n    comp.Train(athlete.name)\n}\n</code></pre>\n\n<p>I would like that <code>comp</code> as composed object should not receive name from outside, but from athlete. IS it possible?</p>\n"}, {"tags": ["windows", "go", "output"], "comments": [{"owner": {"reputation": 6103, "user_id": 565244, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WnmbD.png?s=128&g=1", "display_name": "Codebeat", "link": "https://stackoverflow.com/users/565244/codebeat"}, "edited": false, "score": 0, "creation_date": 1505654698, "post_id": 46264161, "comment_id": 79491919, "body": "You discovered Windows 0-isolation. Google it."}], "answers": [{"tags": [], "owner": {"reputation": 3592, "user_id": 6276385, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89c7b071a5c25c2f6ccc6f1f41bdb2e3?s=128&d=identicon&r=PG&f=1", "display_name": "gonutz", "link": "https://stackoverflow.com/users/6276385/gonutz"}, "is_accepted": false, "score": 0, "last_activity_date": 1505674042, "creation_date": 1505674042, "answer_id": 46267668, "question_id": 46264161, "link": "https://stackoverflow.com/questions/46264161/gloang-exec-bat-or-exe-file-but-dont-get-output/46267668#46267668", "title": "Gloang exec .bat or .exe file but don&#39;t get output", "body": "<p>I have created a little hello world program <code>hello.exe</code> that just prints \"Hello World!\" to stdout. Then the following program calls <code>hello.exe</code> and prints \"Hello World!\" as well.</p>\n\n<p>Maybe there is an error in your piping code or the scanner stuff, try a simple example first and see where it fails.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n    output, err := exec.Command(\"cmd\", \"/C\", \"hello.exe\").CombinedOutput()\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(output))\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8122153, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wxiikuPhR2g/AAAAAAAAAAI/AAAAAAAADGA/ZWtWxu2GuY8/photo.jpg?sz=128", "display_name": "Cyril Connan", "link": "https://stackoverflow.com/users/8122153/cyril-connan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 501, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505756712, "creation_date": 1505651872, "last_edit_date": 1505756712, "question_id": 46264161, "link": "https://stackoverflow.com/questions/46264161/gloang-exec-bat-or-exe-file-but-dont-get-output", "title": "Gloang exec .bat or .exe file but don&#39;t get output", "body": "<p>I want to exec .exe file with golang and send the output value in web socket. </p>\n\n<p>It's work great in linux, when I run an bash file but not working in windows with .exe or .bat file (.bat file run .exe file with some parameters). The program was executed but i never see and recive the output of script. My problem is just how to get the output of script in windows. If you can help me it's would be apreciated. </p>\n\n<p>Thanks :)</p>\n\n<pre><code>cmd := exec.Command(\"cmd\", \"/C\", \"file.exe or file.bat\", \"parameters\")\nstdout, err := cmd.StdoutPipe()\nif err != nil {\n    panic(err)\n}\nstderr, err := cmd.StderrPipe()\nif err != nil {\n    panic(err)\n}\nerr = cmd.Start()\nif err != nil {\n    panic(err)\n}\n\nscannerOut := bufio.NewScanner(stdout)\nfor scannerOut.Scan() {\n\n    log.Printf(\"%s\", scannerOut.Text())\n\n    err = socket.Emit(\"test\", map[string]interface{}{\"user\": user, \"name\": Name, \"data\": scannerOut.Text()})\n    if err != nil {\n        log.Println(err)\n    }\n}\n</code></pre>\n\n<p>thanks for your help i tried that but again for me the script was executed but i don't have the output :/</p>\n\n<pre><code>output, err := exec.Command(\"cmd\", \"/C\", cmdPath).CombinedOutput()\n//cmd := exec.Command(\"ping\", \"google.fr\", \"-t\")\n//cmd := exec.Command(\"cmd\", \"/C\", \"C:/Users/Cyril/Desktop/zec_miner/miner\", \"--server\", \"zec-eu1.nanopool.org\", \"--user\", \"t1cjM242nws6QjfGWApeASG9DNDpsrHWv8A.ccl3ouf/cyril.connan@gmail.com\", \"--pass\", \"z\", \"--port\", \"6666\")\n/*stdout, err := cmd.StdoutPipe()*/\nif err != nil {\n    panic(err)\n}\n\nlog.Printf(\"%s\", string(output))\n\nerr = socket.Emit(\"test\", map[string]interface{}{\"user\": user, \"rig_name\": rigName, \"data\": output})\nif err != nil {\n    log.Println(err)\n}\n</code></pre>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 2296, "user_id": 4209136, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000376796894/picture?type=large", "display_name": "bigless", "link": "https://stackoverflow.com/users/4209136/bigless"}, "edited": false, "score": 0, "creation_date": 1505658491, "post_id": 46263893, "comment_id": 79493026, "body": "what about json Marshal option omit? <a href=\"https://stackoverflow.com/questions/17306358/removing-fields-from-struct-or-hiding-them-in-json-response\" title=\"removing fields from struct or hiding them in json response\">stackoverflow.com/questions/17306358/&hellip;</a>"}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1505659693, "post_id": 46263893, "comment_id": 79493400, "body": "Have you tried <code>Password string `json:&quot;-&quot;`</code> and the same for <code>Username</code>?"}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1505660159, "post_id": 46263893, "comment_id": 79493532, "body": "<a href=\"https://play.golang.org/p/10MKQXmEyV\" rel=\"nofollow noreferrer\">play.golang.org/p/10MKQXmEyV</a>"}, {"owner": {"reputation": 6155, "user_id": 4378314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7935867003690df779b06563293f6293?s=128&d=identicon&r=PG", "display_name": "MarsAndBack", "link": "https://stackoverflow.com/users/4378314/marsandback"}, "edited": false, "score": 0, "creation_date": 1505666129, "post_id": 46263893, "comment_id": 79495274, "body": "Eugene: Thx for the suggestion, however this means excluding those fields for all other uses of User. For example, on the user&#39;s profile page, I would need to display the Email field (using the regular User struct)."}], "answers": [{"comments": [{"owner": {"reputation": 6155, "user_id": 4378314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7935867003690df779b06563293f6293?s=128&d=identicon&r=PG", "display_name": "MarsAndBack", "link": "https://stackoverflow.com/users/4378314/marsandback"}, "edited": false, "score": 0, "creation_date": 1505684181, "post_id": 46268985, "comment_id": 79500697, "body": "Thanks, this works! What I see now is that the excluded fields still exist in the JSON output (although empty). I suppose I&#39;ll have to process the JSON and remove empty fields before sending it out."}, {"owner": {"reputation": 6155, "user_id": 4378314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7935867003690df779b06563293f6293?s=128&d=identicon&r=PG", "display_name": "MarsAndBack", "link": "https://stackoverflow.com/users/4378314/marsandback"}, "edited": false, "score": 1, "creation_date": 1505684463, "post_id": 46268985, "comment_id": 79500769, "body": "... or just simply forget all this composite struct business and just make a totally new, seperate struct just for public instances of the user. Which right now seems a lot better."}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 3, "last_activity_date": 1505683238, "creation_date": 1505683238, "answer_id": 46268985, "question_id": 46263893, "link": "https://stackoverflow.com/questions/46263893/go-accessing-fields-of-a-pointer-struct/46268985#46268985", "title": "Go - Accessing fields of a pointer struct", "body": "<p>Problem there is that when you initialize the variable here:</p>\n\n<pre><code>var user PublicUser\n</code></pre>\n\n<p>All the fields for <code>user</code> take their \"zero\" values.</p>\n\n<p>Since you are embedding a pointer, and zero value for pointers is <code>nil</code>, you can't use that pointer without getting an error.</p>\n\n<p>In order for this to work, you should initialize <code>user</code> like this:</p>\n\n<pre><code>user = PublicUser{ User: &amp;User{} }\n</code></pre>\n\n<p>(or don't declare it as a pointer)</p>\n\n<p>See a playground here showing the issue and then initializing the variable as described above for it to work.</p>\n\n<p><a href=\"https://play.golang.org/p/fXwvATUm_L\" rel=\"nofollow noreferrer\">https://play.golang.org/p/fXwvATUm_L</a></p>\n"}], "owner": {"reputation": 6155, "user_id": 4378314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7935867003690df779b06563293f6293?s=128&d=identicon&r=PG", "display_name": "MarsAndBack", "link": "https://stackoverflow.com/users/4378314/marsandback"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2438, "favorite_count": 2, "accepted_answer_id": 46268985, "answer_count": 1, "score": 1, "last_activity_date": 1505683238, "creation_date": 1505650072, "question_id": 46263893, "link": "https://stackoverflow.com/questions/46263893/go-accessing-fields-of-a-pointer-struct", "title": "Go - Accessing fields of a pointer struct", "body": "<p>I have a User struct containing sensitive fields like password and email. For a public instance of User, for example a public RSVP on an event page, I want to exclude sensitive fields from appearing in my JSON output, even if they're blank.</p>\n\n<p>Based on this <a href=\"https://attilaolah.eu/2014/09/10/json-and-struct-composition-in-go/\" rel=\"nofollow noreferrer\">article</a>, I\u2019m using a composite struct to mask undesired fields.</p>\n\n<p>QUESTION: during rows.Scan in my database func, how do I properly access the fields of the pointer struct within the composite struct? I\u2019m getting panic errors thrown, because fields are not being found.</p>\n\n<p>My regular User struct:</p>\n\n<pre><code>type User struct {\n    ID          int `json:\"id\"`\n    FirstName   string `json:\"firstname\"`\n    LastName    string `json:\"lastname\"`\n    Registered  int `json:\"registered\"`\n    Email       string `json:\"email\"`\n    Password    string `json:\"password\"`\n    ProfilePic  string `json:\"profilepic\"`\n}\n</code></pre>\n\n<p>The new additional structs based on the method in the article linked above:</p>\n\n<pre><code>type omit *struct {\n\n}\n\n\ntype PublicUser struct {\n    *User\n    Registered omit `json:\u201dregistered,omitempty\"`\n    Email omit `json:\u201demail,omitempty\"`\n    Password omit `json:\"password,omitempty\"`\n}\n</code></pre>\n\n<p>My database func, where an error is occuring:</p>\n\n<pre><code>func getUsers(db *sql.DB) ([]PublicUser, error) {\n\n    query := `SELECT users.id, users.name_first, users.name_last\n    FROM users\n    ORDER BY users.name_first asc`\n\n    users := []PublicUser{}\n\n    rows, err := db.Query(query, e.ID)\n    if err != nil {\n        return nil, err\n    }\n    defer rows.Close()\n\n    for rows.Next() {\n\n        var user PublicUser\n\n\n        // ERROR OCCURS HERE. Seems like these fields cannot be found in PublicUser.\n        // Is the pointer to User working within my PublicUser struct?\n\n        err := rows.Scan(&amp;user.ID, &amp;user.FirstName, &amp;user.LastName)\n\n\n\n        if err != nil {\n            return nil, err\n        }\n\n        users = append(users, user)\n    }\n\n    return users, nil\n\n}\n</code></pre>\n\n<p>My original JSON output, not using the articles' method; only using my regular User struct:</p>\n\n<pre><code>[{\n\n    \"ID\": 25,\n    \"FirstName\": \"Jim\",\n    \"LastName\": \"Brown\",\n    \"Registered\": 0,\n    \"Email\": \"\",\n    \"Password\": \"\",\n    \"ProfilePic\": \"\"\n\n},\n\u2026\n]\n</code></pre>\n\n<p>Desired JSON output:</p>\n\n<pre><code>[{\n\n    \"ID\": 25,\n    \"FirstName\": \"Jim\",\n    \"LastName\": \"Brown\",\n    \"ProfilePic\": \"\"\n\n},\n\u2026\n]\n</code></pre>\n"}, {"tags": ["bash", "unit-testing", "testing", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1505673286, "last_edit_date": 1505673286, "creation_date": 1505654603, "answer_id": 46264545, "question_id": 46263599, "link": "https://stackoverflow.com/questions/46263599/go-test-in-complex-folder-structure/46264545#46264545", "title": "go test in complex folder structure", "body": "<p>What's wrong with using the <code>...</code>? Change directory to <code>creational</code>, then</p>\n\n<pre><code>go test ./...\n</code></pre>\n\n<p>This will recurse to all subfolders and execute tests of all packages found. For details, see <a href=\"https://stackoverflow.com/questions/42972827/difference-in-output-when-calling-go-test-with-package/42973175#42973175\">Difference in output when calling go test with package</a>; and <a href=\"https://stackoverflow.com/questions/39012108/how-do-you-run-go-test-when-test-files-are-within-a-module/39012546#39012546\">How do you run `go test` when test files are within a module?</a></p>\n\n<p>Note: starting with 1.9, packages in <code>vendor</code> subfolders are not matched if <code>./...</code> is used. Source: <a href=\"https://golang.org/doc/go1.9#vendor-dotdotdot\" rel=\"nofollow noreferrer\">Go 1.9 Release Notes - Vendor matching with ./...</a>. Prior to Go 1.9, <code>go test ./...</code> also went into the <code>vendor</code> subfolder and ran tests of vendored packages.</p>\n"}], "owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "accepted_answer_id": 46264545, "answer_count": 1, "score": 3, "last_activity_date": 1505673286, "creation_date": 1505648024, "last_edit_date": 1505654426, "question_id": 46263599, "link": "https://stackoverflow.com/questions/46263599/go-test-in-complex-folder-structure", "title": "go test in complex folder structure", "body": "<p>I am building a repository of design patterns in golang. To run all tests, I use this bash script. It works.</p>\n\n<pre><code>#!/bin/bash\ngo test creational/abstract_factory/*.go\ngo test creational/builder/*.go\ngo test creational/factory/*.go\ngo test creational/pool/*.go\ngo test creational/prototype/*.go\ngo test creational/singleton/*.go\n</code></pre>\n\n<p>It works fine:</p>\n\n<pre><code>prompt&gt; ./runtests.sh\nok      command-line-arguments  0.006s\nok      command-line-arguments  0.006s\nok      command-line-arguments  0.006s\nok      command-line-arguments  0.006s\nok      command-line-arguments  0.005s\nok      command-line-arguments  0.006s\n</code></pre>\n\n<p>But, ... If I try to send more directory to <code>go test</code> I receive this message \"named files must all be in one directory; have creational/pool/ and creational/factory/\". This is the reason I've created that bash script.</p>\n\n<p>Is there the possibility to test all folder in one single command?</p>\n"}, {"tags": ["arrays", "go", "struct"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1505635756, "post_id": 46261548, "comment_id": 79487133, "body": "<a href=\"https://tour.golang.org/moretypes/6\" rel=\"nofollow noreferrer\">tour.golang.org/moretypes/6</a> ff"}, {"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 3, "creation_date": 1505707595, "post_id": 46261548, "comment_id": 79505305, "body": "Is not an array, it is a slice"}], "answers": [{"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1505633015, "post_id": 46261610, "comment_id": 79486560, "body": "<code>day := []DayAndTime{}</code> --- it&#39;s not <code>nil</code> here though."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1595588178, "post_id": 46261610, "comment_id": 111533848, "body": "@zerkms yes it is a zero length slice"}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 19, "last_activity_date": 1540607959, "last_edit_date": 1540607959, "creation_date": 1505632454, "answer_id": 46261610, "question_id": 46261548, "link": "https://stackoverflow.com/questions/46261548/initializing-an-empty-array-of-struct-type-in-golang/46261610#46261610", "title": "Initializing an empty array of struct type in golang", "body": "<p>Here you have a zero-length slice, the <code>len</code> and <code>cap</code> functions will both return 0 for a zero-valued slice </p>\n\n<blockquote>\n  <p>A slice cannot be grown beyond its capacity. Attempting to do so will\n  cause a runtime panic, just as when indexing outside the bounds of a\n  slice or array. Similarly, slices cannot be re-sliced below zero to\n  access earlier elements in the array.</p>\n</blockquote>\n\n<p>You may us make to initialize the slice with capacity and assign with index or use append to add values to slice </p>\n\n<p>Both are valid code</p>\n\n<pre><code>var day []DayAndTime\nday = append(day, DayAndTime{\"Monday\", \"8.00 PM\"})\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var day = make([]DayAndTime, 1)\nday[0] = DayAndTime{\"Monday\", \"8.00 PM\"}\n</code></pre>\n\n<blockquote>\n  <p>Using append is recomended</p>\n</blockquote>\n\n<p>Here is a sample code justifying/explaining the answer\n<a href=\"https://play.golang.org/p/ajsli-6Vqw\" rel=\"noreferrer\">https://play.golang.org/p/ajsli-6Vqw</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype DayAndTime struct {\n    days string\n    time string\n}\n\nfunc ZeroLength() {\n    var day = []DayAndTime{}\n    fmt.Println(\"Hello, playground\", cap(day), len(day), day)\n}\n\nfunc AppendArray() {\n    var day = []DayAndTime{}\n    day = append(day, DayAndTime{\"Monday\", \"8.00 PM\"})\n    fmt.Println(\"Hello, playground\", cap(day), len(day), day)\n}\n\nfunc SetIndex() {\n    var day = make([]DayAndTime, 1)\n    day[0] = DayAndTime{\"Monday\", \"8.00 PM\"}\n    fmt.Println(\"Hello, playground\", cap(day), len(day), day)\n}\n\nfunc main() {\n    ZeroLength()\n    AppendArray()\n    SetIndex()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "is_accepted": false, "score": -1, "last_activity_date": 1505707943, "last_edit_date": 1505707943, "creation_date": 1505635849, "answer_id": 46261989, "question_id": 46261548, "link": "https://stackoverflow.com/questions/46261548/initializing-an-empty-array-of-struct-type-in-golang/46261989#46261989", "title": "Initializing an empty array of struct type in golang", "body": "<p>You asked for a solution for arrays, but in your code you show a slice.</p>\n\n<pre><code>foo := []string{}\nt := reflect.TypeOf(foo)\nfmt.Println(t.Kind()) // slice\n\nbar := [2]string{}\ntt := reflect.TypeOf(bar)\nfmt.Println(tt.Kind()) // array\n</code></pre>\n\n<p>Anyway, ... you got that error because days[0] is out of range in the slice. Thant actually contains zero item and its length is zero. You have to use append, that return new slice, and then you can access to days[0]. Or can initialize with make.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype DayAndTime struct {\n    days string\n    time string\n}\n\nfunc main() {\n    days := []DayAndTime{}\n    days = append(days, DayAndTime{\"days ...\", \"time ...\"})\n    fmt.Printf(\"%v\", days[0].days)\n}\n</code></pre>\n\n<p>Another solution is to build an array instead of slice</p>\n\n<pre><code>func main() {\n    days := [2]DayAndTime{}\n    days[0].days = \"fooo\"\n    fmt.Printf(\"%v\", days[0].days)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 5429860, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uJgVQdMge1s/AAAAAAAAAAI/AAAAAAAAABI/7KMbbfYvUrQ/photo.jpg?sz=128", "display_name": "\u591c\u9611\u542c\u98ce", "link": "https://stackoverflow.com/users/5429860/%e5%a4%9c%e9%98%91%e5%90%ac%e9%a3%8e"}, "is_accepted": false, "score": 0, "last_activity_date": 1508155773, "creation_date": 1508155773, "answer_id": 46770006, "question_id": 46261548, "link": "https://stackoverflow.com/questions/46261548/initializing-an-empty-array-of-struct-type-in-golang/46770006#46770006", "title": "Initializing an empty array of struct type in golang", "body": "<p>If you print the length of <code>day</code>, you will get <strong>0</strong>, so you cannot access <code>day[0]</code>, which does not exist.</p>\n\n<p>You can write it in this way: <code>day = append(day, DayAndTime{\"Monday\", \"8.00 PM\"})</code></p>\n"}], "owner": {"reputation": 1007, "user_id": 1288335, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/XpqwZ.jpg?s=128&g=1", "display_name": "Soumya Rauth", "link": "https://stackoverflow.com/users/1288335/soumya-rauth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24213, "favorite_count": 2, "accepted_answer_id": 46261610, "answer_count": 3, "score": 13, "last_activity_date": 1540607959, "creation_date": 1505631840, "last_edit_date": 1505722151, "question_id": 46261548, "link": "https://stackoverflow.com/questions/46261548/initializing-an-empty-array-of-struct-type-in-golang", "title": "Initializing an empty array of struct type in golang", "body": "<p>I have initialized a struct :   </p>\n\n<pre><code>type DayAndTime struct {\n    days string\n    time string\n  }\n</code></pre>\n\n<p>I have initialized an empty set of array of this <code>DayAndTime</code> type:</p>\n\n<pre><code>day := []DayAndTime{}\n</code></pre>\n\n<p>And put a value in it:\n<code>day[0] = DayAndTime{\"Monday\", \"8.00 PM\"}</code></p>\n\n<p>But it shows a runtime error:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n</code></pre>\n\n<p>Why is this happenning and what could be a possible solution?</p>\n\n<p>edit: It's actually a slice not an array.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": true, "score": 1, "last_activity_date": 1505628980, "creation_date": 1505628980, "answer_id": 46261268, "question_id": 46261204, "link": "https://stackoverflow.com/questions/46261204/sort-struct-by-order-of-string-with-same-values/46261268#46261268", "title": "Sort struct by order of string with same values", "body": "<p>In your slice-sorting function, you're comparing <code>c[i].Initial</code> to <code>s</code>. That's simply wrong. Instead, you want to find whether <code>c[i].Initial</code> appears in <code>s</code> before or after <code>c[j].Initial</code>.</p>\n\n<p>Here's some example code, <a href=\"https://play.golang.org/p/S14Ij5aKfh\" rel=\"nofollow noreferrer\">or see it running on the playground</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n    \"strings\"\n)\n\ntype Container struct {\n    Initial string\n}\n\nfunc main() {\n    s := \"dfah\"\n    c := []Container{}\n\n    for _, r := range \"fadh\" {\n        c = append(c, Container{Initial: string(r)})\n    }\n\n    sort.Slice(c, func(i, j int) bool {\n        return strings.Index(s, c[i].Initial) &lt;= strings.Index(s, c[j].Initial)\n    })\n\n    fmt.Printf(\"Result: %s\\n\", c)         // returns [{d} {f} {a} {h}]\n    fmt.Printf(\"Desired result: %s\\n\", s) // returns 'dfah'\n}\n</code></pre>\n\n<p>Note in practice, this is inefficient, since it involves scanning <code>s</code> lots of times. If this were real code, I'd be building a map from characters of <code>s</code> to their index so that the <code>strings.Index</code> calls could be replaced by map lookups.</p>\n"}], "owner": {"reputation": 43, "user_id": 8537167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1feb5a370afc6f979f9f05981160b50b?s=128&d=identicon&r=PG&f=1", "display_name": "Mat&#237;as Salen", "link": "https://stackoverflow.com/users/8537167/mat%c3%adas-salen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 46261268, "answer_count": 1, "score": 0, "last_activity_date": 1505628980, "creation_date": 1505628198, "question_id": 46261204, "link": "https://stackoverflow.com/questions/46261204/sort-struct-by-order-of-string-with-same-values", "title": "Sort struct by order of string with same values", "body": "<p>I'm trying to sort a collection of structs by the order of another strings characters with the same values.</p>\n\n<p>Here's an example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n    \"strings\"\n)\n\ntype Container struct {\n    Initial  string\n}\n\nfunc main() {\n    s := \"dfah\"\n    c := []Container{}\n\n    for _, r := range \"fadh\" {\n        c = append(c, Container{Initial: string(r)})\n    }\n\n    sort.Slice(c, func(i, j int) bool {\n        str := strings.Compare(c[i].Initial, s)\n\n        if str == -1 {\n            return true\n        } else {\n            return false\n        }\n    })\n\n    fmt.Printf(\"Result: %s\\n\", c) // returns 'dafh'\n    fmt.Printf(\"Desired result: %s\\n\", s) // returns 'dfah'\n}\n</code></pre>\n\n<p>The desired result would be the sorted collection of <code>Container</code> structs, with the same order of the 'dfah' string.</p>\n\n<p><a href=\"https://play.golang.org/p/eDW5-xpCzv\" rel=\"nofollow noreferrer\">https://play.golang.org/p/eDW5-xpCzv</a></p>\n\n<p>They  will always have the same characters/number of characters, just unsorted. I'm not sure what the correct way to accomplish this is. Any ideas? Thanks!</p>\n"}, {"tags": ["html", "css", "image", "go"], "answers": [{"comments": [{"owner": {"reputation": 233, "user_id": 7754272, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cfeb16e28f562b8aedfe985ce41553ab?s=128&d=identicon&r=PG&f=1", "display_name": "GoofBall101", "link": "https://stackoverflow.com/users/7754272/goofball101"}, "edited": false, "score": 0, "creation_date": 1505603438, "post_id": 46259223, "comment_id": 79482035, "body": "It should be correct. I am taking the exact file path and it still doesn&#39;t load."}, {"owner": {"reputation": 241, "user_id": 5916612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242b88b9cf6df4a5b766abf48adaa2a2?s=128&d=identicon&r=PG&f=1", "display_name": "ShaneCalder", "link": "https://stackoverflow.com/users/5916612/shanecalder"}, "reply_to_user": {"reputation": 233, "user_id": 7754272, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cfeb16e28f562b8aedfe985ce41553ab?s=128&d=identicon&r=PG&f=1", "display_name": "GoofBall101", "link": "https://stackoverflow.com/users/7754272/goofball101"}, "edited": false, "score": 0, "creation_date": 1505603745, "post_id": 46259223, "comment_id": 79482074, "body": "The file path is in relation to where your html file is not the file path on your computer, etc."}, {"owner": {"reputation": 241, "user_id": 5916612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242b88b9cf6df4a5b766abf48adaa2a2?s=128&d=identicon&r=PG&f=1", "display_name": "ShaneCalder", "link": "https://stackoverflow.com/users/5916612/shanecalder"}, "reply_to_user": {"reputation": 233, "user_id": 7754272, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cfeb16e28f562b8aedfe985ce41553ab?s=128&d=identicon&r=PG&f=1", "display_name": "GoofBall101", "link": "https://stackoverflow.com/users/7754272/goofball101"}, "edited": false, "score": 0, "creation_date": 1505604673, "post_id": 46259223, "comment_id": 79482235, "body": "here is a youtube video that might explain it better or at least a visual. <a href=\"https://www.youtube.com/watch?v=Tg1ujA_TuDM\" rel=\"nofollow noreferrer\">youtube.com/watch?v=Tg1ujA_TuDM</a>"}], "tags": [], "owner": {"reputation": 241, "user_id": 5916612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242b88b9cf6df4a5b766abf48adaa2a2?s=128&d=identicon&r=PG&f=1", "display_name": "ShaneCalder", "link": "https://stackoverflow.com/users/5916612/shanecalder"}, "is_accepted": false, "score": 1, "last_activity_date": 1505603610, "last_edit_date": 1505603610, "creation_date": 1505603104, "answer_id": 46259223, "question_id": 46259184, "link": "https://stackoverflow.com/questions/46259184/html-image-will-not-load-under-any-change-golang/46259223#46259223", "title": "Html Image will not load under any change - Golang", "body": "<p>Looks like it may be a file path issue. \n<br>Take a look at this page it has a good example.<br>\n<a href=\"https://www.w3schools.com/html/html_filepaths.asp\" rel=\"nofollow noreferrer\">https://www.w3schools.com/html/html_filepaths.asp</a><br>\n<br>\nAlso try renaming the image with a _ and not use the -.  </p>\n"}, {"comments": [{"owner": {"reputation": 233, "user_id": 7754272, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cfeb16e28f562b8aedfe985ce41553ab?s=128&d=identicon&r=PG&f=1", "display_name": "GoofBall101", "link": "https://stackoverflow.com/users/7754272/goofball101"}, "edited": false, "score": 0, "creation_date": 1505617012, "post_id": 46259259, "comment_id": 79483892, "body": "It is saying the path is localhost/images/image.png? Its correct but it still will not show? I download it and it shows image.png.html? Would that mean anything?"}, {"owner": {"reputation": 178, "user_id": 3626368, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NO1Oq.jpg?s=128&g=1", "display_name": "balumanzano", "link": "https://stackoverflow.com/users/3626368/balumanzano"}, "reply_to_user": {"reputation": 233, "user_id": 7754272, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cfeb16e28f562b8aedfe985ce41553ab?s=128&d=identicon&r=PG&f=1", "display_name": "GoofBall101", "link": "https://stackoverflow.com/users/7754272/goofball101"}, "edited": false, "score": 0, "creation_date": 1505630703, "post_id": 46259259, "comment_id": 79486140, "body": "i mean, you have a index.html file in a folder , all that is in the sime level folder size of that html file should be aded with direct path call, example : if you have a index.html file inside folder &quot;myFolder&quot;, all that is inside the &quot;myfolder&quot;,  should called with absolute path &#39;code&#39; &lt;img src=&quot;image.png&quot;&gt;&#39;code&#39;, that&#39;s if you have in the same folder  level the image file, and the index.html file, if you have a folder &quot;image&quot; inside &quot;myFolder&quot;, you should calle &#39;code&#39; &lt;img src=&quot;image/myimage.png&quot;&gt;&#39;code&#39;"}, {"owner": {"reputation": 178, "user_id": 3626368, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NO1Oq.jpg?s=128&g=1", "display_name": "balumanzano", "link": "https://stackoverflow.com/users/3626368/balumanzano"}, "reply_to_user": {"reputation": 233, "user_id": 7754272, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cfeb16e28f562b8aedfe985ce41553ab?s=128&d=identicon&r=PG&f=1", "display_name": "GoofBall101", "link": "https://stackoverflow.com/users/7754272/goofball101"}, "edited": false, "score": 0, "creation_date": 1505630860, "post_id": 46259259, "comment_id": 79486171, "body": "look at [link]<a href=\"https://developer.mozilla.org/en-US/docs/Learn/Getting_started_with_the_web/Dealing_with_files\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Learn/&hellip;</a>"}, {"owner": {"reputation": 233, "user_id": 7754272, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cfeb16e28f562b8aedfe985ce41553ab?s=128&d=identicon&r=PG&f=1", "display_name": "GoofBall101", "link": "https://stackoverflow.com/users/7754272/goofball101"}, "edited": false, "score": 0, "creation_date": 1505691934, "post_id": 46259259, "comment_id": 79502229, "body": "the path is 100% correct looking at all of these examples. I have moved it to every type of folder and it still will not work. It just shows the small little blue question mark. I right click and say open in a new tab and it loads my localhost page again?"}], "tags": [], "owner": {"reputation": 178, "user_id": 3626368, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NO1Oq.jpg?s=128&g=1", "display_name": "balumanzano", "link": "https://stackoverflow.com/users/3626368/balumanzano"}, "is_accepted": false, "score": 1, "last_activity_date": 1505603440, "creation_date": 1505603440, "answer_id": 46259259, "question_id": 46259184, "link": "https://stackoverflow.com/questions/46259184/html-image-will-not-load-under-any-change-golang/46259259#46259259", "title": "Html Image will not load under any change - Golang", "body": "<p>In first instance you have to understand the path source, when you are on a HTML file, your path inside the file should be : </p>\n\n<pre><code>&lt;img src=\"images/website-Bucket.png\" alt=\"test\"&gt;\n</code></pre>\n\n<p>that's because :\nthe path of your .html file can access trough files the inside path with the \"/folder/file\" structure route in the html file, so your structure files should be:</p>\n\n<ul>\n<li><p>yourfiel.html  (your file render on browser) /imagesfolder </p></li>\n<li><p>-website-Bucket.png\"  (you call it on your html as</p></li>\n<li>/imagesfolder/website/Bucket.png)./</li>\n</ul>\n\n<p>you can learn more about paths here :\n<a href=\"http://www.coffeecup.com/help/articles/absolute-vs-relative-pathslinks/\" rel=\"nofollow noreferrer\">http://www.coffeecup.com/help/articles/absolute-vs-relative-pathslinks/</a></p>\n"}, {"tags": [], "owner": {"reputation": 622, "user_id": 2297688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QPMNN.png?s=128&g=1", "display_name": "Guille", "link": "https://stackoverflow.com/users/2297688/guille"}, "is_accepted": false, "score": 1, "last_activity_date": 1505603749, "creation_date": 1505603749, "answer_id": 46259291, "question_id": 46259184, "link": "https://stackoverflow.com/questions/46259184/html-image-will-not-load-under-any-change-golang/46259291#46259291", "title": "Html Image will not load under any change - Golang", "body": "<p>Open Console in any browser and see if you see any errors that mention not being able to find the source path of the picture. </p>\n\n<p>It should give you a hint of where your browser is trying to find that img.</p>\n"}, {"comments": [{"owner": {"reputation": 178, "user_id": 3626368, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NO1Oq.jpg?s=128&g=1", "display_name": "balumanzano", "link": "https://stackoverflow.com/users/3626368/balumanzano"}, "edited": false, "score": 0, "creation_date": 1505829083, "post_id": 46270210, "comment_id": 79566982, "body": "thanks you too, try to change the subject to something more closed to Golang, so other people can access to the solution, greetings"}, {"owner": {"reputation": 2795, "user_id": 1991020, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Pe5yX.png?s=128&g=1", "display_name": "Isaac Pak", "link": "https://stackoverflow.com/users/1991020/isaac-pak"}, "edited": false, "score": 0, "creation_date": 1611724617, "post_id": 46270210, "comment_id": 116539985, "body": "The title has Golang in it..."}], "tags": [], "owner": {"reputation": 233, "user_id": 7754272, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cfeb16e28f562b8aedfe985ce41553ab?s=128&d=identicon&r=PG&f=1", "display_name": "GoofBall101", "link": "https://stackoverflow.com/users/7754272/goofball101"}, "is_accepted": false, "score": 0, "last_activity_date": 1505696161, "creation_date": 1505696161, "answer_id": 46270210, "question_id": 46259184, "link": "https://stackoverflow.com/questions/46259184/html-image-will-not-load-under-any-change-golang/46270210#46270210", "title": "Html Image will not load under any change - Golang", "body": "<p>All of your guy's responses were correct. I had the correct path. It was <strong>a Golang thing</strong>. I did not make a <strong>handlefunc</strong> when the server wants the <strong>/image.png</strong>. It was never serving the image, it just was doing nothing with it. Thank you for the responses. </p>\n"}], "owner": {"reputation": 233, "user_id": 7754272, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cfeb16e28f562b8aedfe985ce41553ab?s=128&d=identicon&r=PG&f=1", "display_name": "GoofBall101", "link": "https://stackoverflow.com/users/7754272/goofball101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 890, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1505859846, "creation_date": 1505602684, "last_edit_date": 1505859846, "question_id": 46259184, "link": "https://stackoverflow.com/questions/46259184/html-image-will-not-load-under-any-change-golang", "title": "Html Image will not load under any change - Golang", "body": "<p>I am trying to load an image locally onto my html. I first tried serving an image path through a <strong>/images/</strong> folder, but that did not work. I then tried serving images with the whole path to the image like <code>&lt;img src=\"/Users/code/src/code/go/src/websites/website/website-Bucket.png\" alt=\"test\"&gt;</code> but I still had no luck. I checked my html and it has no errors. I have <strong>restarted my P</strong>C, changed the image to <strong>.jpg</strong>, and it still did not want to work. I get an error in Safari - <strong>An error occurred while trying to load the resource</strong> and the image shows as a blue box and question mark. What things would you try to troubleshoot? </p>\n\n<p>Extra - I am using goLang to serve the files. I have it so a <strong>http.handleFunc()</strong> goes off and serves the images folder when it is requested. The path is showing <strong><a href=\"http://localhost/images/theImage.png\" rel=\"nofollow noreferrer\">http://localhost/images/theImage.png</a></strong> \"the correct path\" but nothing happens. So, I save the image and it shows it as a html and shows a section of the page?? Would that be a path thing? </p>\n"}, {"tags": ["go", "environment-variables", "integration-testing"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1505582988, "post_id": 46256475, "comment_id": 79476687, "body": "Is the db connection used by your program a global? If yes, just have your test create a test conn and set that as the value of the global var."}, {"owner": {"reputation": 143, "user_id": 1885122, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/67654cfb9cd17b795ec81d5748c5024d?s=128&d=identicon&r=PG", "display_name": "Martin Flower", "link": "https://stackoverflow.com/users/1885122/martin-flower"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1505586496, "post_id": 46256475, "comment_id": 79477744, "body": "<code>var db = DB.getConnectionUsingEnvironmentVariable()</code>"}, {"owner": {"reputation": 143, "user_id": 1885122, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/67654cfb9cd17b795ec81d5748c5024d?s=128&d=identicon&r=PG", "display_name": "Martin Flower", "link": "https://stackoverflow.com/users/1885122/martin-flower"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1505586589, "post_id": 46256475, "comment_id": 79477774, "body": "This is in the main program. This currently panics. I could change it so that it doesn&#39;t attempt to create a connection if the environment variable is missing, and call the same code from the test, once I have set the environment variable. Is this what you had in mind?"}, {"owner": {"reputation": 143, "user_id": 1885122, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/67654cfb9cd17b795ec81d5748c5024d?s=128&d=identicon&r=PG", "display_name": "Martin Flower", "link": "https://stackoverflow.com/users/1885122/martin-flower"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1505586953, "post_id": 46256475, "comment_id": 79477870, "body": "Actually, just realised that if I move this line inside the function (instead of being global), then I <i>can</i> set the environment variable in the test before the function is called. This seems like a good solution to me."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1505587241, "post_id": 46256475, "comment_id": 79477953, "body": "You said you want <code>an automated test that exercises the program against a test database</code> that means, I assume, your program is using a db connection, possibly <code>*sql.DB</code>, looks like its the <code>db</code> var from your snippet, if that&#39;s the case then to have your program talk to a test database you just need to, at the beginning of your test, create a new test connection and set it as the value of the <code>db</code> var, and so then when your program is using <code>db</code> to talk to the database it will be talkiing to the test one."}, {"owner": {"reputation": 143, "user_id": 1885122, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/67654cfb9cd17b795ec81d5748c5024d?s=128&d=identicon&r=PG", "display_name": "Martin Flower", "link": "https://stackoverflow.com/users/1885122/martin-flower"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1505589234, "post_id": 46256475, "comment_id": 79478564, "body": "That&#39;s right - exactly as you say. The problem is that the code snippet is executed in the main program at start-up time (and fails due to missing environment variable). I can either implement the solution I just outlined, or leave var db as global, but uninitialised, and ensure that is it initialised by the time the function is called (by setting it in the test). Thanks for your suggestion."}], "answers": [{"comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1506130182, "post_id": 46299476, "comment_id": 79709579, "body": "if your using mysql i suggest <a href=\"https://github.com/DATA-DOG/go-sqlmock\" rel=\"nofollow noreferrer\">github.com/DATA-DOG/go-sqlmock</a> if you don&#39;t want to mock the structures yourself."}], "tags": [], "owner": {"reputation": 143, "user_id": 1885122, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/67654cfb9cd17b795ec81d5748c5024d?s=128&d=identicon&r=PG", "display_name": "Martin Flower", "link": "https://stackoverflow.com/users/1885122/martin-flower"}, "is_accepted": false, "score": 0, "last_activity_date": 1505821161, "creation_date": 1505821161, "answer_id": 46299476, "question_id": 46256475, "link": "https://stackoverflow.com/questions/46256475/go-integration-test-uses-test-database-connection/46299476#46299476", "title": "Go - integration test uses test database connection", "body": "<p>My current solution is to make the connection an uninitialised global. The function checks to see if the connection is nil - if so, it initialises it. The test has a setup() function which sets the connection to the integration test database - an alternative would be for the test to just set the environment variable.</p>\n"}], "owner": {"reputation": 143, "user_id": 1885122, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/67654cfb9cd17b795ec81d5748c5024d?s=128&d=identicon&r=PG", "display_name": "Martin Flower", "link": "https://stackoverflow.com/users/1885122/martin-flower"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 381, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505821161, "creation_date": 1505582277, "question_id": 46256475, "link": "https://stackoverflow.com/questions/46256475/go-integration-test-uses-test-database-connection", "title": "Go - integration test uses test database connection", "body": "<p>A go program connects to a database using a connection string. Currently that connection string is stored in an environment variable.</p>\n\n<p>My challenge is to write a an automated test that exercises the program against a test database.</p>\n\n<p>I thought I would set the connection string environment variable in the init() function of the test, but the main program's init() function is called before the test init(), so this does not work. </p>\n\n<p>The workaround seems to be to default the connection string to the test database. If no environment variable is defined, use test; if it is defined (production), then use that instead.</p>\n\n<p>Is there an alternative? Is there a better approach?</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 1576, "user_id": 5453515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c41cae4ee9e62e14df6757fc7a364cb2?s=128&d=identicon&r=PG&f=1", "display_name": "Stephane Martin", "link": "https://stackoverflow.com/users/5453515/stephane-martin"}, "edited": false, "score": 1, "creation_date": 1505583285, "post_id": 46256197, "comment_id": 79476770, "body": "<a href=\"https://kylewbanks.com/blog/query-result-to-map-in-golang\" rel=\"nofollow noreferrer\">kylewbanks.com/blog/query-result-to-map-in-golang</a>"}, {"owner": {"reputation": 37, "user_id": 6729835, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d588e17cf2999875673201cbc65078d?s=128&d=identicon&r=PG&f=1", "display_name": "rocco", "link": "https://stackoverflow.com/users/6729835/rocco"}, "reply_to_user": {"reputation": 1576, "user_id": 5453515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c41cae4ee9e62e14df6757fc7a364cb2?s=128&d=identicon&r=PG&f=1", "display_name": "Stephane Martin", "link": "https://stackoverflow.com/users/5453515/stephane-martin"}, "edited": false, "score": 0, "creation_date": 1505633983, "post_id": 46256197, "comment_id": 79486793, "body": "@StephaneMartin thanks, your answer helped me!"}], "answers": [{"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 2, "creation_date": 1505620769, "post_id": 46258332, "comment_id": 79484434, "body": "&quot;Don&#39;t do it&quot;. Hah, no kidding. People always come from Python and want crazy weird flexibility without realizing that Go is a statically typed language, and that it&#39;s a good thing."}, {"owner": {"reputation": 13086, "user_id": 1431239, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e0085b2fdc60b5c84310fa29529a6648?s=128&d=identicon&r=PG", "display_name": "Mike Mackintosh", "link": "https://stackoverflow.com/users/1431239/mike-mackintosh"}, "edited": false, "score": 0, "creation_date": 1505626342, "post_id": 46258332, "comment_id": 79485437, "body": "your guidance is worthy of a +1"}, {"owner": {"reputation": 37, "user_id": 6729835, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d588e17cf2999875673201cbc65078d?s=128&d=identicon&r=PG&f=1", "display_name": "rocco", "link": "https://stackoverflow.com/users/6729835/rocco"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1505629225, "post_id": 46258332, "comment_id": 79485888, "body": "@RayfenWindspear you right, Python is my background:) And less flexibility is a good thing in Go, i agree. It&#39;s like crazy flexibility of Joomla with crazy hangs vs self-maded CMS"}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 3, "last_activity_date": 1505595054, "creation_date": 1505595054, "answer_id": 46258332, "question_id": 46256197, "link": "https://stackoverflow.com/questions/46256197/dynamically-generate-struct-fields-from-sql-queryrow-result/46258332#46258332", "title": "Dynamically generate struct fields from SQL QueryRow result", "body": "<blockquote>\n  <p>generate struct fields dynamically</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/pkg/reflect/#StructOf\" rel=\"nofollow noreferrer\">https://golang.org/pkg/reflect/#StructOf</a></p>\n\n<p>But please: Don't do it.</p>\n"}], "owner": {"reputation": 37, "user_id": 6729835, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d588e17cf2999875673201cbc65078d?s=128&d=identicon&r=PG&f=1", "display_name": "rocco", "link": "https://stackoverflow.com/users/6729835/rocco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 46258332, "answer_count": 1, "score": 0, "last_activity_date": 1505595054, "creation_date": 1505580395, "last_edit_date": 1505586336, "question_id": 46256197, "link": "https://stackoverflow.com/questions/46256197/dynamically-generate-struct-fields-from-sql-queryrow-result", "title": "Dynamically generate struct fields from SQL QueryRow result", "body": "<p>I want to retrieve all fields of the row and than render them to html. I know how to do it and here is a code for a row with 3 fields:</p>\n\n<pre><code>type View struct {\n    Id         int\n    Name_and_requisits string\n    Reg_Date  string\n}\nfunc getViewById(id int) (*View, error){\n    var vie View\n    row := db.QueryRow(\"select id, name_and_requisits, reg_date from book where id = ?;\", id)\n    err := row.Scan(&amp;vie.Id, &amp;vie.Name_and_requisites, &amp;vie.Reg_Date)\n    if err != nil {\n        return nil, err\n    }\n\n    return &amp;vie, nil\n}\n</code></pre>\n\n<p>But in my table one row includes about 20 columns and i need all of them with their names but i dont want to create a nasted hardcoded struct. I have an idea like to generate struct fields dynamically, from names of columns, and than use row.Scan on it. Any ideas? Maybe map is better for this situation? </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "cryptography"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1505581123, "post_id": 46255506, "comment_id": 79476148, "body": "Do you have a question? Also, please make your questions self contained."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505588830, "post_id": 46255506, "comment_id": 79478457, "body": "Print the result of <code>sha3.Sum256([]byte(&quot;c342dbf7cdd3096c4c3910c511a57049e62847dd&zwnj;&#8203;\u200c\u200b5030c7e644bc855acc&zwnj;&#8203;1f\u200c\u200bd626&quot;))</code> and see the same &quot;incorrect&quot; result"}], "answers": [{"comments": [{"owner": {"reputation": 1054, "user_id": 4201205, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7186d11fd2ae12a5da22d2a8e7a684ad?s=128&d=identicon&r=PG&f=1", "display_name": "Constantine", "link": "https://stackoverflow.com/users/4201205/constantine"}, "edited": false, "score": 0, "creation_date": 1505596350, "post_id": 46256431, "comment_id": 79480537, "body": "Thanks @Maarten Bodewes, totaly missed that stuff with string."}], "tags": [], "owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "is_accepted": true, "score": 3, "last_activity_date": 1505582603, "last_edit_date": 1505582603, "creation_date": 1505581974, "answer_id": 46256431, "question_id": 46255506, "link": "https://stackoverflow.com/questions/46255506/go-lang-sha3-256-gives-invalid-output/46256431#46256431", "title": "Go lang SHA3-256 gives invalid output?", "body": "<p>You are assuming that the online converters that you've tested perform hexadecimal decoding. They don't; they just take the ASCII/UTF-8/whatever value of the string and use that, i.e. they hash the text.</p>\n\n<p>This can be easily observed by inputting your <code>c342...</code> string and then inputting <code>hello</code>. Both will work, while <code>hello</code> obviously doesn't contain hexadecimals. Another way is to start with an uppercase <code>C</code> instead of <code>c</code>, which will also return a different result, while the hexadecimal decoding should return an identical byte array and thus hash.</p>\n\n<p>And a small Java application does indeed confirm your value of:</p>\n\n<pre><code>8a3ccc097f854811f4c49346da9c3bd1745d087ed539fa7817960f3e0ed8a44f\n</code></pre>\n\n<p>Note that most if not all online tools are basically hobby projects by amateur cryptographers. Expect all kind of encoding / decoding issues, errors and uncertainties in the implementation. If you want to test your implementation, use the official NIST test vectors.</p>\n"}], "owner": {"reputation": 1054, "user_id": 4201205, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7186d11fd2ae12a5da22d2a8e7a684ad?s=128&d=identicon&r=PG&f=1", "display_name": "Constantine", "link": "https://stackoverflow.com/users/4201205/constantine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "closed_date": 1505596439, "accepted_answer_id": 46256431, "answer_count": 1, "score": -2, "last_activity_date": 1505582603, "creation_date": 1505575844, "last_edit_date": 1505581813, "question_id": 46255506, "link": "https://stackoverflow.com/questions/46255506/go-lang-sha3-256-gives-invalid-output", "closed_reason": "Needs details or clarity", "title": "Go lang SHA3-256 gives invalid output?", "body": "<p>I am facing strange results fo <code>go</code> SHA3-256 function:\nhere is <a href=\"https://gist.github.com/r8d8/d206fb277d6bf34366d1854568517f8f\" rel=\"nofollow noreferrer\">source code</a></p>\n\n<pre><code>import (\n    \"golang.org/x/crypto/sha3\"\n    \"encoding/hex\"\n)\n\nfunc main() {\n    pub, _ := hex.DecodeString(\"c342dbf7cdd3096c4c3910c511a57049e62847dd5030c7e644bc855acc1fd626\")\n    h := sha3.Sum256(pub[:])\n    fmt.Printf(\"SHA3 %x\\n\", h)\n    // expected: b32562e67d3ea44ba1367ce134caac49fd305b24cde6716ad3857ac682576379\n    // received: 8a3ccc097f854811f4c49346da9c3bd1745d087ed539fa7817960f3e0ed8a44f\n}\n</code></pre>\n\n<p>I verified result on couple of online converters, they all give same result, different from mine.</p>\n"}, {"tags": ["go", "version-control"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1505572216, "post_id": 46254790, "comment_id": 79473353, "body": "Just recompile the sync package in place."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505572450, "post_id": 46254790, "comment_id": 79473412, "body": "@JimB How do I recompile it?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505575344, "post_id": 46254790, "comment_id": 79474392, "body": "Just like any other, <code>go install sync</code>. Since many things depend on that package <code>go install std</code> might be more efficient"}], "answers": [{"tags": [], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "is_accepted": true, "score": -1, "last_activity_date": 1505572637, "creation_date": 1505572637, "answer_id": 46255036, "question_id": 46254790, "link": "https://stackoverflow.com/questions/46254790/modify-golang-internal-file/46255036#46255036", "title": "Modify Golang internal file?", "body": "<p>In your installation of Go, navigate to the <code>src</code> folder and run the file called <code>run.bat</code> which will recompile all the packages removing the first error you described.</p>\n"}, {"comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1505577788, "post_id": 46255805, "comment_id": 79475173, "body": "But I was thinking of making a pull request to the Golang github repository. But thank you for this code, I&#39;ll probably be using it."}, {"owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "edited": false, "score": 0, "creation_date": 1505709927, "post_id": 46255805, "comment_id": 79505849, "body": "You will need a mutex to manage concurrent access, while checking and modifying <code>wgl.current</code>"}], "tags": [], "owner": {"reputation": 116, "user_id": 1696780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe6116b69ce99e0ed9928b95e6dddb5b?s=128&d=identicon&r=PG&f=1", "display_name": "AleGra", "link": "https://stackoverflow.com/users/1696780/alegra"}, "is_accepted": false, "score": 0, "last_activity_date": 1505577749, "creation_date": 1505577749, "answer_id": 46255805, "question_id": 46254790, "link": "https://stackoverflow.com/questions/46254790/modify-golang-internal-file/46255805#46255805", "title": "Modify Golang internal file?", "body": "<p>I really wouldn't do this by changing the standard library, but instead wrap the WaitGroup to keep track of the counter like so:</p>\n\n<pre><code>type wg_limit struct {\n    wg           sync.WaitGroup\n    current, max int\n}\n\nfunc (wgl *wg_limit) Add(delta int) error {\n    if wgl.current+delta &gt; wgl.max {\n    return fmt.Errorf(\"counter exceeded (current: %d, max: %d)\", wgl.current, wgl.max)\n    }\n    wgl.current += delta\n    wgl.wg.Add(delta)\n    return nil\n}\n\nfunc (wgl *wg_limit) Done() {\n    wgl.current -= 1\n    wgl.wg.Done()\n}\n</code></pre>\n\n<p>Then init wg_limit with a value for max and use the resulting variable just like a WaitGroup:</p>\n\n<pre><code>wgl := wg_limit{max: 3}\nif err := wgl.Add(1); err != nil {\n    // go something()\n    // ...\n    wgl.Done()\n}\n</code></pre>\n\n<p>If the WaitGroup counter would be exceeded by the delta of Add(delta), an error is returned and the WaitGroup is unchanged.</p>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "accepted_answer_id": 46255036, "answer_count": 2, "score": -1, "last_activity_date": 1505577749, "creation_date": 1505570945, "question_id": 46254790, "link": "https://stackoverflow.com/questions/46254790/modify-golang-internal-file", "title": "Modify Golang internal file?", "body": "<p>I had the idea of adding a <code>sync.WaitGroup</code> <code>Limit(max int)</code> function to resrict the number of the <code>WaitGroup</code> counter.</p>\n\n<p>So I opened the <code>waitgroup.go</code> file in <code>go/src/sync</code> and made the changes, saved the file and tried testing it in a main.go file on my desktop. When I ran the file, it says:</p>\n\n<pre><code>$ go run main.go\nwg.Limit undefined (type sync.WaitGroup has no field or method Limit)\n</code></pre>\n\n<p>To fix this error message, I copied the folder from <code>go/src/sync</code> into the folder on my desktop containing my <code>main.go</code> file and changed the import from <code>sync</code> to <code>./sync</code>.</p>\n\n<p>After running <code>go run main.go</code> this time, I got the following output:</p>\n\n<pre><code>$ go run main.go\nsync\\mutex.go:14:2: use of internal package not allowed\nsync\\pool.go:8:2: use of internal package not allowed\nsync\\rwmutex.go:8:2: use of internal package not allowed\nsync\\waitgroup.go:8:2: use of internal package not allowed\n</code></pre>\n\n<p>To fix these messages, I copied <code>go/src/internal</code> into the folder on my desktop containing my <code>main.go</code> file and I modified all the files in <code>./sync</code> that reference <code>internal/..</code> to <code>./internal/..</code></p>\n\n<p>I run it again and I get the following output:</p>\n\n<pre><code>$ go run main.go\n# _/C_/.../sync\nsync\\mutex.go:20: missing function body for \"throw\"\nsync\\pool.go:66: missing function body for \"fastrand\"\nsync\\pool.go:249: missing function body for \"runtime_registerPoolCleanup\"\nsync\\pool.go:250: missing function body for \"runtime_procPin\"\nsync\\pool.go:251: missing function body for \"runtime_procUnpin\"\nsync\\runtime.go:14: missing function body for \"runtime_Semacquire\"\nsync\\runtime.go:17: missing function body for \"runtime_SemacquireMutex\"\nsync\\runtime.go:23: missing function body for \"runtime_Semrelease\"\nsync\\runtime.go:36: missing function body for \"runtime_notifyListAdd\"\nsync\\runtime.go:39: missing function body for \"runtime_notifyListWait\"\nsync\\runtime.go:39: too many errors\n</code></pre>\n\n<hr>\n\n<p><strong>How can I implement my simple idea by modifying the source files of <code>go/src</code> without receiving these errors?</strong></p>\n"}, {"tags": ["go", "directory-structure"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1505568908, "post_id": 46254423, "comment_id": 79472378, "body": "That&#39;s the structure of GOPATH, not packages"}], "answers": [{"comments": [{"owner": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "edited": false, "score": 0, "creation_date": 1505585070, "post_id": 46255507, "comment_id": 79477316, "body": "Ah, I think I get it now. Do you mean to say that I will have ALL my projects in separate repositories in the <code>src&#47;</code> folder? So whenever I open my editor (Gogland) I always open the same project, in which I then open the src folder of my choice?"}, {"owner": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "edited": false, "score": 0, "creation_date": 1505592980, "post_id": 46255507, "comment_id": 79479648, "body": "And the advantage is that you can always use all packages in all your projects right? Does it also mean that packages imported with <code>go get package</code> exist in the same <code>src&#47;</code> folder next to your own projects and packages?"}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 1, "last_activity_date": 1505575850, "creation_date": 1505575850, "answer_id": 46255507, "question_id": 46254423, "link": "https://stackoverflow.com/questions/46254423/why-cant-i-find-any-go-package-which-follows-the-standard-src-pkg-bin-structure/46255507#46255507", "title": "Why can&#39;t I find any go package which follows the standard src/pkg/bin structure?", "body": "<p>The structure you reference in your question is not how projects are structured but rather how the local workspace is configured.</p>\n\n<p><a href=\"https://golang.org/doc/code.html#Workspaces\" rel=\"nofollow noreferrer\">https://golang.org/doc/code.html#Workspaces</a></p>\n\n<p>Typically, you'll set up one workspace in your local machine, for example you would set up your workspace root to be:</p>\n\n<p><code>$HOME/go</code></p>\n\n<p>You then point your GOPATH environment variable to <code>$HOME/go</code> to let Go know that's your workspace location.</p>\n\n<p>Inside your workspace you then create the <code>src</code>, <code>bin</code> and <code>pkg</code> folders that the documentation describes.</p>\n\n<p>Inside <code>src</code> is where you checkout (or create your own) project folders.</p>\n"}], "owner": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 46255507, "answer_count": 1, "score": 0, "last_activity_date": 1505575850, "creation_date": 1505568444, "question_id": 46254423, "link": "https://stackoverflow.com/questions/46254423/why-cant-i-find-any-go-package-which-follows-the-standard-src-pkg-bin-structure", "title": "Why can&#39;t I find any go package which follows the standard src/pkg/bin structure?", "body": "<p>I'm a beginner in golang, and I was reading the article <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to write Go code</a> on the go website. It explains how the typical Go structure contains three folders in the root of the project:</p>\n\n<pre><code>bin/\n    contains compiled code\npkg/\n    contains package objects\nsrc/\n    contains the Go source files\n</code></pre>\n\n<p>So to learn from other projects I checked out some popular go projects in github, but to my surprise I don't see this src/pkg/bin structure in any of those projects. </p>\n\n<p>What am I missing here? Does anybody know a (preferably simple) project in golang which follows this structure? I think I could learn a lot from reading other people's code.</p>\n"}, {"tags": ["c++", "go", "goroutine", "fiber", "boost-coroutine"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 3, "creation_date": 1505535998, "post_id": 46249794, "comment_id": 79464166, "body": "Go started using contiguous stacks in version 1.3"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1505536890, "post_id": 46249794, "comment_id": 79464291, "body": "@tkausl Hmm..  Just read about it and that definitely seems like something that would require support from the language itself, and would to hard to implement as a library like Boost.Coroutine.  Right?  The contiguous stack approach seems easier to understand though"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505593932, "post_id": 46249794, "comment_id": 79479907, "body": "@Curious: yes it requires language support -- Go has a different stack layout and calling convention than C/C++."}], "answers": [{"tags": [], "owner": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "is_accepted": true, "score": 9, "last_activity_date": 1505584680, "last_edit_date": 1505584680, "creation_date": 1505544424, "answer_id": 46250986, "question_id": 46249794, "link": "https://stackoverflow.com/questions/46249794/how-do-segmented-stacks-work/46250986#46250986", "title": "How do segmented stacks work", "body": "<p>I'll give you a quick sketch of one possible implementation.</p>\n\n<p>First, assume most stack frames are smaller than some size. For ones that are larger, we can use a longer instruction sequence at entry to make sure there is enough stack space. Let's assume we're on an architecture that that has 4k pages and we're choosing 4k - 1 as the maximum size stack frame handled by the fast path.</p>\n\n<p>The stack is allocated with a single guard page at the bottom. That is, a page that is not mapped for write. At function entry, the stack pointer is decremented by the stack frame size, which is less than the size of a page, and then the program arranges to write a value at the lowest address in the newly allocated stack frame. If the end of the stack has been reached, this write will cause a processor exception and ultimately be turned into some sort of upcall from the OS to the user program -- e.g. a signal in UNIX family OSes.</p>\n\n<p>The signal handler (or equivalent) has to be able to determine this is a stack extension fault from the address of the instruction that faulted and the address it was writing to. This is determinable as the instruction is in the prolog of a function and the address being written to is in the guard page of the stack for the current thread. The instruction being in the prolog can be recognized by requiring a very specific pattern of instructions at the start of functions, or possibly by maintaining metadata about functions. (Possibly using traceback tables.)</p>\n\n<p>At this point the handler can allocate a new stack block, set the stack pointer to the top of the block, do something to handle unchaining the stack block, and then call the function that faulted again. This second call is safe because the fault is in the function prolog the compiler generated and no side effects are allowed before validating there is enough stack space. (The code may also need to fixup the return address for architectures that push it onto the stack automatically. If the return address is in a register, it just needs to be in the same register when the second call is made.)</p>\n\n<p>Likely the easiest way to handle unchaining is to push a small stack frame onto the new extension block for a routine that when returned to unchains the new stack block and frees the allocated memory. It then returns the processor registers to the state they were in when the call was made that caused the stack to need to be extended.</p>\n\n<p>The advantage of this design is that the function entry sequence is very few instructions and is very fast in the non-extending case. The disadvantage is that in the case where the stack does need to be extended, the processor incurs an exception, which may cost much much more than a function call.</p>\n\n<p>Go doesn't actually use a guard page if I understand correctly. Rather the function prolog explicitly checks the stack limit and if the new stack frame won't fit it calls a function to extend the stack.</p>\n\n<p>Go 1.3 changed its design to not use a linked list of stack blocks. This is to avoid the trap cost if the extension boundary is crossed in both directions many times in a certain calling pattern. They start with a small stack, and use a similar mechanism to detect the need for extension. But when a stack extension fault does occur, the entire stack is moved to a larger block. This removes the need for unchaining entirely.</p>\n\n<p>There are quite a few details glossed over here. (E.g. one may not be able to do the stack extension in the signal handler itself. Rather the handler can arrange to have the thread suspended and hand it off to a manager thread. One likely has to use a dedicated signal stack to handle the signal as well.)</p>\n\n<p>Another common pattern with this sort of thing is the runtime requiring there to be a certain amount of valid stack space below the current stack frame for either something like a signal handler or for calling special routines in the runtime. Go works this way and the stack limit test guarantees a certain fixed amount of stack space is available below the current frame. One can e.g. call plain C functions on the stack so long as one guarantees they do not consume more than the fixed stack reserve amount. (One can use this to call C library routines in theory, though most of these have no formal specification of how much stack they might use.)</p>\n\n<p>Dynamic allocation in the stack frame, such as alloca or stack allocated variable length arrays, add some complexity to the implementation. If the routine can compute the entire final size of the frame in the prolog then it is fairly straightforward. Any increase in the frame size while the routine is running likely has to be modeled as a new call, though with Go's new architecture that allows moving the stack, it is possible the alloca point in the routine can be made such that all the state allows a stack move to happen there.</p>\n"}], "owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1482, "favorite_count": 5, "accepted_answer_id": 46250986, "answer_count": 1, "score": 11, "last_activity_date": 1505584680, "creation_date": 1505533172, "last_edit_date": 1505569919, "question_id": 46249794, "link": "https://stackoverflow.com/questions/46249794/how-do-segmented-stacks-work", "title": "How do segmented stacks work", "body": "<p>How do segmented stacks work?  This question also applies to <code>Boost.Coroutine</code> so I am using the C++ tag as well here.  The main doubt comes from this <a href=\"https://blog.cloudflare.com/how-stacks-are-handled-in-go/\" rel=\"noreferrer\">article</a> It looks like what they do is keep some space at the bottom of the stack and check if it has gotten corrupted by registering some sort of signal handler with the memory allocated there (perhaps via <code>mmap</code> and <code>mprotect</code>?)  And then when they detect that they have run out of space they continue by allocating more memory and then continuing from there.  3 questions about this</p>\n\n<ol>\n<li><p>Isn't this construct a user space thing?  How do they control where the new stack is allocated and how do the instructions the program is compiled down to get aware of that?  </p>\n\n<p>A push instruction is basically just adding a value to the stack pointer and then storing the value in a register on the stack, then how can the push instruction be aware of where the new stack starts and correspondingly how can the pop know when it has to move the stack pointer back to the old stack?</p></li>\n<li><p>They also say </p>\n\n<blockquote>\n  <p>After we've got a new stack segment, we restart the <code>goroutine</code> by retrying the function that caused us to run out of stack</p>\n</blockquote>\n\n<p>what does this mean?  Do they restart the entire goroutine?  Won't this possibly cause non deterministic behavior?</p></li>\n<li><p>How do they detect that the program has overrun the stack?  If they keep a canary-ish memory area at the bottom then what happens when the user program creates an array big enough that overflows that?  Will that not cause a stack overflow and is a potential security vulnerability?</p></li>\n</ol>\n\n<p>If the implementations are different for Go and Boost I would be happy to know how either of them deal with this situation \ud83d\ude42 </p>\n"}, {"tags": ["go", "tensorflow"], "answers": [{"comments": [{"owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "reply_to_user": {"reputation": 23, "user_id": 7360967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b4322cbacb06c634933e2530a32e06?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Xia", "link": "https://stackoverflow.com/users/7360967/johnny-xia"}, "edited": false, "score": 0, "creation_date": 1505565654, "post_id": 46251876, "comment_id": 79471446, "body": "yes, I also wrote it in my article (I&#39;m galeone, you&#39;re mailing me these days): read it carefully!"}, {"owner": {"reputation": 23, "user_id": 7360967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b4322cbacb06c634933e2530a32e06?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Xia", "link": "https://stackoverflow.com/users/7360967/johnny-xia"}, "edited": false, "score": 0, "creation_date": 1505596804, "post_id": 46251876, "comment_id": 79480663, "body": "Oh what a coincidence!Thanks for your help in these days.Now i&#39;ve changed another frame to learn neural network.Do you have some useful resource to give me advice ?"}, {"owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "reply_to_user": {"reputation": 23, "user_id": 7360967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b4322cbacb06c634933e2530a32e06?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Xia", "link": "https://stackoverflow.com/users/7360967/johnny-xia"}, "edited": false, "score": 0, "creation_date": 1505632702, "post_id": 46251876, "comment_id": 79486500, "body": "Use tensorflow &amp; python. The tensorflow manual is a good starting place. For a more theoretical approach, just look at some university course on ML and you&#39;ll be fine"}], "tags": [], "owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "is_accepted": true, "score": 0, "last_activity_date": 1505550836, "creation_date": 1505550836, "answer_id": 46251876, "question_id": 46249621, "link": "https://stackoverflow.com/questions/46249621/why-tensorflow-in-go-didnt-find-the-optimizer-as-python/46251876#46251876", "title": "Why TensorFlow in Go didn&#39;t find the optimizer as python?", "body": "<p>You <strong>can't</strong> train a Tensorflow model using Go.</p>\n\n<p>The only thing you can do is load a pre-trained model and use it for the inference. </p>\n\n<p>You can't because the Go implementation lacks the <code>Variable</code> support, therefore it's impossible to train anything at the moment.</p>\n"}], "owner": {"reputation": 23, "user_id": 7360967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b4322cbacb06c634933e2530a32e06?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Xia", "link": "https://stackoverflow.com/users/7360967/johnny-xia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 46251876, "answer_count": 1, "score": 1, "last_activity_date": 1505592366, "creation_date": 1505530757, "last_edit_date": 1505592366, "question_id": 46249621, "link": "https://stackoverflow.com/questions/46249621/why-tensorflow-in-go-didnt-find-the-optimizer-as-python", "title": "Why TensorFlow in Go didn&#39;t find the optimizer as python?", "body": "<p>I am a newbie of <code>TensorFlow</code> in <code>Go</code>.</p>\n\n<p>There are some doubts during my first traing demo. I just find one optimizer in Go's <code>wrappers.go</code>. </p>\n\n<p>But i learn the demos of python,they has serveral optimizers. Like </p>\n\n<pre><code>GradientDescentOptimizer\nAdagradOptimizer\nAdagradDAOptimizer\nMomentumOptimizer\nAdamOptimizer\nFtrlOptimizer\nRMSPropOptimizer\n</code></pre>\n\n<p>The similar prefix of func like <code>ResourceApply...\n                                         GradientDescent\n                                         Adagrad\n                                         AdagradDA\n                                         Momentum\n                                         Adam\n                                         Ftrl\n                                         RMSProp</code>.</p>\n\n<p>And they return a option.I don't know what are their purpose. I cant find the relation of them and optimizer.</p>\n\n<p>And how can i make a train in <code>Go</code> by <code>TensorFlow</code>.</p>\n\n<p>What should I should use like python's <code>tf.Variable</code> in <code>Go</code>?</p>\n"}, {"tags": ["javascript", "jquery", "go"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 7144676, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04a4329266dae70cc14af9e22175b555?s=128&d=identicon&r=PG&f=1", "display_name": "vijay varikol", "link": "https://stackoverflow.com/users/7144676/vijay-varikol"}, "edited": false, "score": 0, "creation_date": 1505537258, "post_id": 46249669, "comment_id": 79464337, "body": "yes but even after updating it still doesn&#39;t reach golang. I&#39;m unable to figure out the mistake i&#39;m doing"}], "tags": [], "owner": {"reputation": 320, "user_id": 427680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d92f04c0a3c4935a2e905296152b1eae?s=128&d=identicon&r=PG", "display_name": "Kremlan", "link": "https://stackoverflow.com/users/427680/kremlan"}, "is_accepted": false, "score": 0, "last_activity_date": 1505531477, "creation_date": 1505531477, "answer_id": 46249669, "question_id": 46249587, "link": "https://stackoverflow.com/questions/46249587/unable-to-access-post-request-params-in-golang/46249669#46249669", "title": "unable to access post request params in golang", "body": "<p>Your JS snippet contains syntax errors, so I assume no request reaches your golang API.</p>\n\n<pre><code>var jsn = {\n    vvv = $(\"#textinput\").val();   \n};\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>var jsn = {\n    vvv : $(\"#textinput\").val()\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "is_accepted": false, "score": 3, "last_activity_date": 1505532941, "last_edit_date": 1505532941, "creation_date": 1505531892, "answer_id": 46249696, "question_id": 46249587, "link": "https://stackoverflow.com/questions/46249587/unable-to-access-post-request-params-in-golang/46249696#46249696", "title": "unable to access post request params in golang", "body": "<p>You've sent your request with a JSON body, but <code>ParseForm</code> on an <code>*http.Request</code> does not handle JSON. You need to read the body of the request and parse it as JSON, or don't send your body as JSON.</p>\n\n<pre><code>func MainConversion(w http.ResponseWriter, r *http.Request) {\n    var body = make(map[string]string)\n    if err := json.NewDecoder(r.Body).Decode(&amp;body); err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n    text := body[\"vvv\"]\n    w.Write([]byte(text))\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7144676, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04a4329266dae70cc14af9e22175b555?s=128&d=identicon&r=PG&f=1", "display_name": "vijay varikol", "link": "https://stackoverflow.com/users/7144676/vijay-varikol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505560690, "creation_date": 1505530094, "last_edit_date": 1505560690, "question_id": 46249587, "link": "https://stackoverflow.com/questions/46249587/unable-to-access-post-request-params-in-golang", "title": "unable to access post request params in golang", "body": "<p>I am trying to access post params in golang which are sent via jquery ajax. Maybe I am missing something obvious. Here are my code snippets</p>\n\n<p>\n\n    </p>\n\n<pre><code>    $('form').submit(function(e) {\n        e.preventDefault();\n        var jsn = {\n            vvv = $(\"#textinput\").val();   \n        };\n        console.log(jsn);\n        $.ajax({\n            type: \"POST\",\n            async : true,\n        //enctype: 'multipart/form-data',\n        url: \"/homepage\",\n        data: jsn,\n        processData: true,\n        contentType: \"application/json\",\n        cache: false,\n    }).done(function(response){\n        $(\"#resultdiv\").html(response);\n    });\n});\n</code></pre>\n\n<p></p>\n\n<p>here is my golang code:</p>\n\n<pre><code> func MainConversion(w http.ResponseWriter, r *http.Request) {\n     r.ParseForm()    \n        text := r.FormValue(\"vvv\")\n        fmt.Fprint(w, string(text))\n        return\n    })\n</code></pre>\n\n<p>I have tried f.formValue(), r.Form.get() . Thanks in advance</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505511925, "post_id": 46247825, "comment_id": 79459955, "body": "If you want to print it as json, you need to marshal it into json. The template package won&#39;t do that for you."}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 6660177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1003ed085d1a8463f60af3a2f24577?s=128&d=identicon&r=PG&f=1", "display_name": "user666N", "link": "https://stackoverflow.com/users/6660177/user666n"}, "is_accepted": false, "score": 1, "last_activity_date": 1505547089, "creation_date": 1505547089, "answer_id": 46251396, "question_id": 46247825, "link": "https://stackoverflow.com/questions/46247825/how-to-print-an-object-in-golang-template-like-if-we-could-have-done-in-javascri/46251396#46251396", "title": "how to print an object in Golang template like if we could have done in JavaScript", "body": "<p>Use fmt.Sprintf function, maybe something like below:</p>\n\n<pre><code>renderTemplate(w, \"index\", fmt.Sprintf(\"%s\", ActuallQAll))\n</code></pre>\n\n<p>I'm not sure what exactly the object looks like.</p>\n"}], "owner": {"reputation": 6278, "user_id": 2646226, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7030bd05d9dc7920f066578f878b4688?s=128&d=identicon&r=PG", "display_name": "Ezeewei", "link": "https://stackoverflow.com/users/2646226/ezeewei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505592257, "creation_date": 1505511725, "last_edit_date": 1505592257, "question_id": 46247825, "link": "https://stackoverflow.com/questions/46247825/how-to-print-an-object-in-golang-template-like-if-we-could-have-done-in-javascri", "title": "how to print an object in Golang template like if we could have done in JavaScript", "body": "<pre><code>renderTemplate(w, \"index\", map[string]interface{}{\n    \"ActualQAll\": req.URL.Query(),\n})\n</code></pre>\n\n<p>and inside golanghtml</p>\n\n<pre><code>...{{.ActualQAll}}...\n</code></pre>\n\n<p>But it shows nothing.</p>\n\n<p>how can I print the whole object out like if I could do in javascript by doing JSON.stringify(obj) an object?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["python", "http", "networking", "go", "zeroconf"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1505507913, "post_id": 46247131, "comment_id": 79458537, "body": "That zeroconf go lib looks to be a work-in-progress, maybe check with the project maintainer and/or submit an issue on GitHub."}], "owner": {"reputation": 1056, "user_id": 5424931, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/011a6628fb6be07b5b77cf0ac6b93282?s=128&d=identicon&r=PG", "display_name": "Rolando Urquiza", "link": "https://stackoverflow.com/users/5424931/rolando-urquiza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505840076, "creation_date": 1505507706, "last_edit_date": 1505840076, "question_id": 46247131, "link": "https://stackoverflow.com/questions/46247131/discover-python-service-in-go", "title": "Discover python service in go", "body": "<p>I currently have a http server implemented in python using flask. The service is registered using the zeroconf <a href=\"https://pypi.python.org/pypi/zeroconf\" rel=\"nofollow noreferrer\">module</a>:</p>\n\n<pre><code>info = ServiceInfo('_http._tcp.local.',\n                   'MyServer._http._tcp.local.',\n                   inet_aton(host), port, properties={})\nzc = Zeroconf()\nzc.register_service(info, allow_name_change=True)\n</code></pre>\n\n<p>Also, I have a go application browsing the available services using <a href=\"https://github.com/grandcat/zeroconf\" rel=\"nofollow noreferrer\">zeroconf</a>. The problem is that if I start the go program after the python server the go program never discovers the server. If I start the go program first there's no issue. I even try extending the <code>ttl</code> on the <code>register_service</code> function with no results.</p>\n\n<p>I'm trying that the go program discovers the python servers that where already running when it gets started.</p>\n\n<p>I recently discover that the go part functions perfectly, I register the service using <code>avahi-publish</code> and go discover it correctly. So I guess the python module is the problem. I know now that I can run <code>avahi</code> but I would like a python implementation of the protocol, having dependencies only in python.</p>\n"}, {"tags": ["assembly", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1505508485, "post_id": 46247086, "comment_id": 79458746, "body": "Also see the faq: <a href=\"https://golang.org/doc/faq#stack_or_heap\" rel=\"nofollow noreferrer\">golang.org/doc/faq#stack_or_heap</a>"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 3, "creation_date": 1505508832, "post_id": 46247086, "comment_id": 79458879, "body": "Note that in C, that&#39;s not what would happen. Rather, <i>undefined behaviour</i> would occur and the results would be unpredictable."}, {"owner": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1505576505, "post_id": 46247086, "comment_id": 79474755, "body": "@fuz: exactly.  In this case, gcc7.2 for x86-64 decides to compile <code>main()</code> to 2 instructions: <code>mov eax, [0]</code> and <code>ud2</code>.  <a href=\"https://godbolt.org/g/ZNJ5ti\" rel=\"nofollow noreferrer\">godbolt.org/g/ZNJ5ti</a>  So if loading a null pointer doesn&#39;t segfault, then the illegal instruction will definitely fault.  Or with <code>-O1</code> instead of <code>-O3</code>, it still compiles a call to printf, but with <code>*p</code> still inlined as load of a null pointer.  Even at <code>-O0</code>, it compiles <code>test()</code> to always return NULL.  @ Taylor, you could get recent <code>gcc -O0</code> to return the address of a local by storing it in a temporary first, though."}, {"owner": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1505576789, "post_id": 46247086, "comment_id": 79474839, "body": "<code>gcc -Og</code> output is interesting <a href=\"https://godbolt.org/g/UGGosQ\" rel=\"nofollow noreferrer\">godbolt.org/g/UGGosQ</a>.  With a temporary <code>int*</code> inside <code>test()</code>, we can get it to return a stack address, but still optimize away the &quot;dead&quot; store to that address.  So it prints whatever garbage was on the stack.  (Likely <code>0</code> if <code>main</code> is the deepest the call stack has gone)."}], "answers": [{"tags": [], "owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "is_accepted": false, "score": 2, "last_activity_date": 1505576223, "last_edit_date": 1505576223, "creation_date": 1505575692, "answer_id": 46255478, "question_id": 46247086, "link": "https://stackoverflow.com/questions/46247086/stack-variables-in-go/46255478#46255478", "title": "Stack variables in go?", "body": "<p>It is somewhat strange that we don't have good official documentation on escape analysis (or maybe even if it's there I haven't found it yet!) but here's something I found useful : <a href=\"http://blog.rocana.com/golang-escape-analysis\" rel=\"nofollow noreferrer\">http://blog.rocana.com/golang-escape-analysis</a></p>\n\n<p>You can use something like this to do an escape analysis for your code (assuming your filename is main.go):</p>\n\n<pre><code>go run -gcflags '-m -l' main.go\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5301333, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RlLC4OA8Cdg/AAAAAAAAAAI/AAAAAAAAA74/5ocxKYnviHg/photo.jpg?sz=128", "display_name": "Taylor King", "link": "https://stackoverflow.com/users/5301333/taylor-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "closed_date": 1505598731, "answer_count": 1, "score": 0, "last_activity_date": 1505576223, "creation_date": 1505507454, "question_id": 46247086, "link": "https://stackoverflow.com/questions/46247086/stack-variables-in-go", "closed_reason": "Duplicate", "title": "Stack variables in go?", "body": "<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"os\"\n)\n\nfunc main() {\n  var l = test(4)\n  test(5)\n  fmt.Fprintf(os.Stdout, \"%d\\n\", *l)\n}\n\nfunc test(v int) *int {\n  var p = v\n  return &amp;p\n}\n</code></pre>\n\n<p>In C, the equivalent code would print 5 because the the variable p in the first stack frame would be overwritten by the same variable p in the second stack frame. I disassembled the code but am not able to make too much sense of it. </p>\n\n<pre><code>#include &lt;stdio.h&gt;                                                                                                                                                                                                                                                                                                           \n\nint* test(int v); \nint main() {\n    int* p = test(4);\n    test(5);\n    printf(\"%d\\n\", *p);\n}\n\nint* test(int v) {\n    int p = v;\n    return &amp;p; \n}\n</code></pre>\n\n<p>Can somebody give me a basic synopsis of how memory management works in Go? Do function variables go on the heap? </p>\n"}, {"tags": ["go", "comparison", "deepequals"], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 3, "last_activity_date": 1505506261, "creation_date": 1505506261, "answer_id": 46246868, "question_id": 46246728, "link": "https://stackoverflow.com/questions/46246728/testing-cookie-returned-from-function-in-go/46246868#46246868", "title": "Testing Cookie returned from Function in Go", "body": "<p>Using <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\"><code>fmt.Printf(\"%#v\")</code></a> shows the issue:</p>\n\n<pre><code>got=        &amp;http.Cookie{Name:\"mycookie\", Value:\"SomeValue\", Path:\"/mysite\", Domain:\"\", Expires:time.Time{wall:0x0, ext:0, loc:(*time.Location)(nil)}, RawExpires:\"\", MaxAge:0, Secure:true, HttpOnly:true, Raw:\"mycookie=SomeValue; Path=/mysite; HttpOnly; Secure\", Unparsed:[]string(nil)}\nvalidCookie=&amp;http.Cookie{Name:\"mycookie\", Value:\"SomeValue\", Path:\"/mysite\", Domain:\"\", Expires:time.Time{wall:0x0, ext:0, loc:(*time.Location)(nil)}, RawExpires:\"\", MaxAge:0, Secure:true, HttpOnly:true, Raw:\"\", Unparsed:[]string(nil)}\n</code></pre>\n\n<p>The <code>Raw</code> value of the parsed cookie is filled, while the constructed cookie has no <code>Raw</code> value, understandably.</p>\n\n<p>Playground: <a href=\"https://play.golang.org/p/ghzkjUoEGW\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ghzkjUoEGW</a></p>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 3, "last_activity_date": 1505506331, "creation_date": 1505506331, "answer_id": 46246882, "question_id": 46246728, "link": "https://stackoverflow.com/questions/46246728/testing-cookie-returned-from-function-in-go/46246882#46246882", "title": "Testing Cookie returned from Function in Go", "body": "<p>Comparing Cookies with <code>reflect.DeepEquals</code> is a very bad idea. The <a href=\"https://golang.org/pkg/net/http/#Cookie\" rel=\"nofollow noreferrer\">http.Cookie type</a> contains components that do not translate into the literal header representation of the cookie, depending on how it's parsed and/or manipulated.</p>\n\n<p>If you change your code to use <code>%#v</code>:</p>\n\n<pre><code>if got := GetCookie(ts.URL); !reflect.DeepEqual(got, validCookie) {\n    log.Fatalf(\"NOT THE SAME\\n got = '%#v'\\nwant = '%#v'\", got, validCookie)\n}\n</code></pre>\n\n<p>... you'll see the difference:</p>\n\n<pre><code>EqualL Cookies: true\n2009/11/10 23:00:00 NOT THE SAME\n got = '&amp;http.Cookie{Name:\"mycookie\", Value:\"SomeValue\", Path:\"/mysite\", Domain:\"\", Expires:time.Time{wall:0x0, ext:0, loc:(*time.Location)(nil)}, RawExpires:\"\", MaxAge:0, Secure:true, HttpOnly:true, Raw:\"mycookie=SomeValue; Path=/mysite; HttpOnly; Secure\", Unparsed:[]string(nil)}'\nwant = '&amp;http.Cookie{Name:\"mycookie\", Value:\"SomeValue\", Path:\"/mysite\", Domain:\"\", Expires:time.Time{wall:0x0, ext:0, loc:(*time.Location)(nil)}, RawExpires:\"\", MaxAge:0, Secure:true, HttpOnly:true, Raw:\"\", Unparsed:[]string(nil)}'\n</code></pre>\n\n<p>Instead, just compare the URL strings directly:</p>\n\n<pre><code>if got := GetCookie(ts.URL); got.String() == validCookie.String() {\n</code></pre>\n"}], "owner": {"reputation": 2008, "user_id": 710618, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/779233af08fd9f187990a44146f1778c?s=128&d=identicon&r=PG", "display_name": "Alexandre Thenorio", "link": "https://stackoverflow.com/users/710618/alexandre-thenorio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 975, "favorite_count": 0, "accepted_answer_id": 46246882, "answer_count": 2, "score": 0, "last_activity_date": 1505506331, "creation_date": 1505505580, "last_edit_date": 1505506138, "question_id": 46246728, "link": "https://stackoverflow.com/questions/46246728/testing-cookie-returned-from-function-in-go", "title": "Testing Cookie returned from Function in Go", "body": "<p>I am attempting to test a function that retrieves a Cookie from a request in Go however even though they have the same value, the comparison fails.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"net/http/httptest\"\n    \"reflect\"\n)\n\nfunc GetCookie(url string) *http.Cookie {\n    req, err := http.NewRequest(\"GET\", url, nil)\n    req.Header.Set(\"Content-Type\", \"application/x-www-form-urlencoded\")\n\n    client := http.DefaultClient\n\n    res, err := client.Do(req)\n    if err != nil {\n        panic(err)\n    }\n    defer res.Body.Close()\n\n    cookies := res.Cookies()\n    var mycookie *http.Cookie\n    for _, c := range cookies {\n        if c.Name == \"mycookie\" {\n            mycookie = c\n        }\n    }\n\n    return mycookie\n}\n\nfunc main() {\n    validCookie := &amp;http.Cookie{\n        Name:     \"mycookie\",\n        Value:    \"SomeValue\",\n        Path:     \"/mysite\",\n        HttpOnly: true,\n        Secure:   true,\n    }\n\n    ts := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        http.SetCookie(w, validCookie)\n        w.Header().Set(\"Content-Type\", \"text/plain\")\n        w.WriteHeader(200)\n    }))\n    defer ts.Close()\n\n    fmt.Printf(\"EqualL Cookies: %t\\n\", reflect.DeepEqual(validCookie, validCookie))\n\n    if got := GetCookie(ts.URL); !reflect.DeepEqual(got, validCookie) {\n        log.Fatalf(\"NOT THE SAME\\n got = '%v'\\nwant = '%v'\", got, validCookie)\n    }\n}\n</code></pre>\n\n<p>Playground link: <a href=\"https://play.golang.org/p/T4dbZycMuT\" rel=\"nofollow noreferrer\">https://play.golang.org/p/T4dbZycMuT</a></p>\n\n<p>I have checked the documentation on the DeepEqual function and from what I can see the 2 structs/pointer should be the same (Specially given that Cookie has no unexported fields).</p>\n\n<p>I can change the function to compare the Cookie Strings however I would like to know if there is a simple explanation why this does not work or is it due to \"inconsistency\" as the documentation specifies.\nAlso is there any way to test for the struct rather than the string representation in this scenarion (Or did I make a mistake maybe)?</p>\n"}, {"tags": ["go", "visual-studio-code", "vscode-settings", "delve", "gopath"], "answers": [{"comments": [{"owner": {"reputation": 486, "user_id": 6513167, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/597312657096897/picture?type=large", "display_name": "Martin Niederl", "link": "https://stackoverflow.com/users/6513167/martin-niederl"}, "edited": false, "score": 0, "creation_date": 1505507194, "post_id": 46246744, "comment_id": 79458268, "body": "already followed everything in this list before with no change at all, so i&#39;ve redone that settings"}, {"owner": {"reputation": 1059, "user_id": 8368990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e3e253063cfcfeff6159f83a5c2404d?s=128&d=identicon&r=PG&f=1", "display_name": "fanduin", "link": "https://stackoverflow.com/users/8368990/fanduin"}, "reply_to_user": {"reputation": 486, "user_id": 6513167, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/597312657096897/picture?type=large", "display_name": "Martin Niederl", "link": "https://stackoverflow.com/users/6513167/martin-niederl"}, "edited": false, "score": 0, "creation_date": 1505510696, "post_id": 46246744, "comment_id": 79459547, "body": "Are you using the dlv debugger?"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1505513375, "post_id": 46246744, "comment_id": 79460358, "body": "This information <i>belongs</i> in an answer, you just need to add a <i>summary</i> of the information into your answer itself, so it&#39;s not all buried behind that link and subject to becoming lost when the link inevitably rots. We require that all answers here be self-contained. That either needs to be a summary in your own words, or a quotation of the relevant portions, with appropriate <a href=\"https://stackoverflow.com/help/referencing\">referencing</a>. I edited that into your answer for you this time. Please use this as a model for future answers!"}, {"owner": {"reputation": 1059, "user_id": 8368990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e3e253063cfcfeff6159f83a5c2404d?s=128&d=identicon&r=PG&f=1", "display_name": "fanduin", "link": "https://stackoverflow.com/users/8368990/fanduin"}, "edited": false, "score": 0, "creation_date": 1505513609, "post_id": 46246744, "comment_id": 79460446, "body": "My apologies, thank you very much for the advice. I will be sure to keep this in mind in the future!"}, {"owner": {"reputation": 486, "user_id": 6513167, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/597312657096897/picture?type=large", "display_name": "Martin Niederl", "link": "https://stackoverflow.com/users/6513167/martin-niederl"}, "edited": false, "score": 0, "creation_date": 1505552121, "post_id": 46246744, "comment_id": 79467564, "body": "@fanduin If you mean the Delve debugger, than yes, i use it"}], "tags": [], "owner": {"reputation": 1059, "user_id": 8368990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e3e253063cfcfeff6159f83a5c2404d?s=128&d=identicon&r=PG&f=1", "display_name": "fanduin", "link": "https://stackoverflow.com/users/8368990/fanduin"}, "is_accepted": false, "score": -1, "last_activity_date": 1505513445, "last_edit_date": 1505513445, "creation_date": 1505505657, "answer_id": 46246744, "question_id": 46246213, "link": "https://stackoverflow.com/questions/46246213/wrong-gopath-when-debugging-project-in-vs-code/46246744#46246744", "title": "Wrong gopath when debugging project in VS Code", "body": "<p>If you're using the vscode-go extension, try changing the <code>go.gopath</code> setting as described on <a href=\"https://github.com/Microsoft/vscode-go/wiki/GOPATH-in-the-VS-Code-Go-extension\" rel=\"nofollow noreferrer\" title=\"https://github.com/Microsoft/vscode-go/wiki/GOPATH-in-the-VS-Code-Go-extension\">the Microsoft vscode-go wiki</a>:</p>\n\n<blockquote>\n  <p>Setting <code>go.gopath</code> in User settings overrides the GOPATH that was derived from the above logic. Setting <code>go.gopath</code> in Workspace settings overrides the one from User settings. You can set multiple folders as GOPATH in this setting. Note that they should be <code>;</code> separated in Windows and <code>:</code> separated otherwise.</p>\n</blockquote>\n\n<p>I initially had problems with Visual Studio Code recognising my gopath, and this fixed it.</p>\n"}], "owner": {"reputation": 486, "user_id": 6513167, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/597312657096897/picture?type=large", "display_name": "Martin Niederl", "link": "https://stackoverflow.com/users/6513167/martin-niederl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1242, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505552889, "creation_date": 1505503106, "last_edit_date": 1505552889, "question_id": 46246213, "link": "https://stackoverflow.com/questions/46246213/wrong-gopath-when-debugging-project-in-vs-code", "title": "Wrong gopath when debugging project in VS Code", "body": "<p>From one day to the next I can't manage to debug a project where everything worked perfectly before.\nI'm sure I haven't changed anything about the project or its settings during this time. All I did was work on another project in the same <strong>IDE (VS Code)</strong>.</p>\n\n<h2>The actual error in VS Code:</h2>\n\n<pre><code>dbInteraction.go:8:2: cannot find package \"github.com/go-sql-driver/mysql\" in any of:\nC:\\Go\\src\\github.com\\go-sql-driver\\mysql (from $GOROOT)\nc:\\Users\\Mani\\Documents\\Programmier Projekte\\PRJCTNAME\\src\\github.com\\go-sql-driver\\mysql (from $GOPATH)\nmain.go:8:2: cannot find package \"github.com/gorilla/mux\" in any of:\nC:\\Go\\src\\github.com\\gorilla\\mux (from $GOROOT)\nc:\\Users\\Mani\\Documents\\Programmier Projekte\\PRJCTNAME\\src\\github.com\\gorilla\\mux (from $GOPATH)\nexit status 1\nProcess exiting with code: 1\n</code></pre>\n\n<h2>Checking the environment variables:</h2>\n\n<pre><code>C:\\Users\\Mani&gt;echo %GOPATH%\nC:\\Users\\Mani\\go\n\nC:\\Users\\Mani&gt;echo %GOROOT%\nC:\\Go\\\n</code></pre>\n\n<p>As you can see, my environment variables are set as desired and the $GOPATH in the debug output does not match this path; in contract it is the actual path of my go sources for this project.</p>\n\n<p>When i build the project over the command line with <code>go build</code> (in the project directory) it works perfectly. That gives me the suspicion that VS Code is responsible for the problem.</p>\n\n<p><strong>The user settings and workspace settings in VS Code are both empty. Also empty is the project specific VS-Code <code>settings.go</code> and the <code>launch.go</code> has not changed from the default.</strong></p>\n\n<p><strong>EDIT 1:</strong> If i remember correctly, i think I switched from <code>VS Code 32bit</code> to <code>VS Code 64bit</code> in between.</p>\n\n<p><strong>EDIT 2:</strong> After setting the env parameter in the launch.json I am able to debug the program again but now i <strong><em>do not get any output in the debug console.</em></strong></p>\n"}, {"tags": ["go", "timezone"], "answers": [{"comments": [{"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1505502590, "post_id": 46245856, "comment_id": 79456380, "body": "Good suggestion. The problem is that I don&#39;t know the time zone name."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1505502611, "post_id": 46245856, "comment_id": 79456393, "body": "Specifically, a true time zone entry includes details like observance and schedule for daylight savings/summer time, which is not included in a simple UTC offset."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1505502923, "post_id": 46245856, "comment_id": 79456539, "body": "@chmike: If you don&#39;t know the actual time zone name, then you can only guess, or leave it out entirely. I only used &quot;EDT&quot; as an example, it&#39;s not a real time zone."}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1505503483, "post_id": 46245856, "comment_id": 79456768, "body": "@Adrian You are right. An UTC time with an offset could match multiple locations if their time offset are the same during some period. There would be an ambiguity. The FixedZone is thus the best solution so that it is still possible to produce ISO 8601 time format or equivalent without zone name."}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1505505167, "post_id": 46245856, "comment_id": 79457498, "body": "The zone name is only used in old time representation (RFC822, Unix time). More recent time representation use only the time offset."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1505505309, "post_id": 46245856, "comment_id": 79457560, "body": "@chmike: yes, as long as you&#39;re choosing a suitable output format, just leave the name field bank (the time package will use the offset for the name if the format asks for it)"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1505552122, "post_id": 46245856, "comment_id": 79467565, "body": "@chmike and JimB: &quot;Etc/GMT-14&quot; through &quot;Etc/GMT+12&quot; are perfectly valid timezones and hence according &quot;locations&quot; should be available."}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1505552369, "post_id": 46245856, "comment_id": 79467628, "body": "@MarkusWMahlberg what are these ? Time zone names ? The time offset I have is in minutes. There are many locations that don&#39;t have a time offset rounded to hours."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1505554473, "post_id": 46245856, "comment_id": 79468202, "body": "@chmike Those are timezone names in the IANA TZ database. If you need a more precise approach, using RFC3339 timestamps might be the handiest option."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1505511162, "last_edit_date": 1505511162, "creation_date": 1505501534, "answer_id": 46245856, "question_id": 46245784, "link": "https://stackoverflow.com/questions/46245784/how-to-set-the-zone-of-a-go-time-value-when-knowing-the-utc-time-and-time-offset/46245856#46245856", "title": "How to set the Zone of a Go time value when knowing the UTC&#160;time and time offset?", "body": "<p>Without an actual entry to lookup in the time zone database, you can't know the true location for the time. If you want to work with just an offset, you can create a fixed location using <a href=\"https://golang.org/pkg/time/#FixedZone\" rel=\"nofollow noreferrer\"><code>time.FixedZone</code></a></p>\n\n<pre><code>edt := time.FixedZone(\"EDT\", -60*60*4)\nt, _ := time.ParseInLocation(\"02 Jan 06 15:04\", \"15 Sep 17 14:55\", edt)\nfmt.Println(t)\n\n// 2017-09-15 14:55:00 -0400 EDT\n</code></pre>\n\n<p>You can opt to specify a non-existent zone name, or none at all, as long as the output format you use doesn't require one.</p>\n\n<pre><code>minus4 := time.FixedZone(\"\", -60*60*4)\nt, _ = time.ParseInLocation(\"02 Jan 06 15:04\", \"15 Sep 17 14:55\", minus4)\nfmt.Println(t.Format(time.RFC3339))\n\n// 2017-09-15T14:55:00-04:00\n</code></pre>\n"}], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2217, "favorite_count": 1, "accepted_answer_id": 46245856, "answer_count": 1, "score": 3, "last_activity_date": 1505511162, "creation_date": 1505501213, "question_id": 46245784, "link": "https://stackoverflow.com/questions/46245784/how-to-set-the-zone-of-a-go-time-value-when-knowing-the-utc-time-and-time-offset", "title": "How to set the Zone of a Go time value when knowing the UTC&#160;time and time offset?", "body": "<p>I have an UTC\u00a0time and a time offset in seconds, and need to return the corresponding Go time value. </p>\n\n<p>It is trivial to instantiate the UTC\u00a0time value by using the time.Unix() function. But to set the Zone, I need to determine the time.Location.</p>\n\n<p>How can I find the time.Location when knowing the UTC\u00a0time and time offset ?  </p>\n"}, {"tags": ["function", "unit-testing", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1505500312, "post_id": 46245549, "comment_id": 79455367, "body": "What are &quot;free&quot; functions?"}, {"owner": {"reputation": 231, "user_id": 784411, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cBwYs.png?s=128&g=1", "display_name": "RomaH", "link": "https://stackoverflow.com/users/784411/romah"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505500581, "post_id": 46245549, "comment_id": 79455467, "body": "Functions without Go receivers.  They are not tied with a structure."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1505500837, "post_id": 46245549, "comment_id": 79455576, "body": "So, you mean &quot;functions&quot;, since anything with a receiver would be considered a method. Functions are used extensively in most idiomatic go, and there&#39;s nothing stopping those from being unit tested. What exactly do you want to mock? Go usually doesn&#39;t take the path of &quot;mock everything&quot; that some languages use, which often just ends up testing the mocks more than anything useful."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1505507438, "post_id": 46245549, "comment_id": 79458367, "body": "The typical way to test a function is to pass input, and compare the output against what you expect. Whether mocks are necessary depends on the inputs and outputs--not on whether it&#39;s a function or a method. If you can provide some examples of what you&#39;re trying to test, a better answer may be possible. Otherwise, the only option really is guessing."}], "answers": [{"tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 0, "last_activity_date": 1505505493, "creation_date": 1505505493, "answer_id": 46246708, "question_id": 46245549, "link": "https://stackoverflow.com/questions/46245549/golang-testing-with-functions/46246708#46246708", "title": "Golang testing with functions", "body": "<p>You can do this by using a reference to the actual function whenever you need to call it.</p>\n\n<p>Then, when you need to mock the function you just point the reference to a mock implementation.</p>\n\n<p>Let's say this is your external function:</p>\n\n<pre><code>// this is the wrapper for an external function\nfunc externalFunction(i int) int {\n   return i * 10  // do something with input\n}\n</code></pre>\n\n<p>You never call this directly but instead declare a reference to it:</p>\n\n<pre><code>var processInt func(int) int = externalFunction\n</code></pre>\n\n<p>When you need to invoke the function you do it using the reference:</p>\n\n<pre><code>fmt.Println(processInt(5))\n</code></pre>\n\n<p>Then, went you want to mock the function you just assign a mock implementation to that reference:</p>\n\n<pre><code>processInt = mockFunction\n</code></pre>\n\n<p>This playground puts it together and might be more clear than the explanation:</p>\n\n<p><a href=\"https://play.golang.org/p/xBuriFHlm9\" rel=\"nofollow noreferrer\">https://play.golang.org/p/xBuriFHlm9</a></p>\n\n<p>If you have a function that receives a <code>func(int) int</code>, you can send that function either the actual <code>externalFunction</code> or the <code>mockFunction</code> when you want it to use the mock implementation.</p>\n"}], "owner": {"reputation": 231, "user_id": 784411, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cBwYs.png?s=128&g=1", "display_name": "RomaH", "link": "https://stackoverflow.com/users/784411/romah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 46246708, "answer_count": 1, "score": 0, "last_activity_date": 1505507064, "creation_date": 1505500216, "last_edit_date": 1505507064, "question_id": 46245549, "link": "https://stackoverflow.com/questions/46245549/golang-testing-with-functions", "title": "Golang testing with functions", "body": "<p>I am using a third-party library that is a wrapper over some C functions.  Unfortunately, nearly all of the Go functions are free (they don't have a receiver, they are not methods); not the design approach I would have taken but it is what I have.</p>\n\n<p>Using just Go's standard \"testing\" library:</p>\n\n<p>Is there a solution that allows me to create tests where I can mock functions?</p>\n\n<p>Or is the solution to wrap the library into structures and interfaces, then mock the interface to achieve my goal?</p>\n\n<hr>\n\n<p>I have created a monte carlo simulation that also process the produced dataset.  One of my evaluation algorithms looks for specific models that it then passes the third-party function for its evaluation. I know my edge cases and know what the call counts should be, and this is what I want to test.  </p>\n\n<p>Perhaps a simple counter is all that is needed?</p>\n\n<hr>\n\n<p>Other projects using this library, that I have found, do not have full coverage or no testing at all.</p>\n"}, {"tags": ["go", "aggregation", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 1458, "user_id": 2032771, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/UNFib.jpg?s=128&g=1", "display_name": "avrono", "link": "https://stackoverflow.com/users/2032771/avrono"}, "edited": false, "score": 0, "creation_date": 1505999601, "post_id": 46290198, "comment_id": 79649779, "body": "thanks for such a comprehensive answer and explanation !"}], "tags": [], "owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "is_accepted": true, "score": 2, "last_activity_date": 1511994723, "last_edit_date": 1511994723, "creation_date": 1505782671, "answer_id": 46290198, "question_id": 46244098, "link": "https://stackoverflow.com/questions/46244098/mgo-with-aggregation-and-grouping/46290198#46290198", "title": "mgo with aggregation and grouping", "body": "<p>The reason you're getting NULL is because your <code>$match</code> filter is filtering out all of documents after the <code>$group</code> phase. </p>\n\n<p>After your first stage of <code>$group</code> the documents are only as below example:</p>\n\n<pre><code>  {\"_id\": { \"user\": \"foo\"}},\n  {\"_id\": { \"user\": \"bar\"}},\n  {\"_id\": { \"user\": \"baz\"}}\n</code></pre>\n\n<p>They no longer contains the other fields i.e. <code>user</code>, <code>date_updated</code> and <code>organization</code>. If you would like to keep their values, you can utilise <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/group/#accumulator-operator\" rel=\"nofollow noreferrer\">Group Accumulator Operator</a>. Depending on your use case you may also benefit from using <a href=\"https://docs.mongodb.com/manual/reference/aggregation-variables/\" rel=\"nofollow noreferrer\">Aggregation Expression Variables</a></p>\n\n<p>As an example using <a href=\"https://docs.mongodb.com/manual/mongo/\" rel=\"nofollow noreferrer\">mongo shell</a>, let's use <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/first/#grp._S_first\" rel=\"nofollow noreferrer\">$first operator</a> which basically pick the first occurrence. This may make sense for <code>organization</code> but not for <code>date_updated</code>. Please choose a more appropriate accumulator operator. </p>\n\n<pre><code>{\"$group\": { \n          \"_id\":\"$user\", \n          \"date_updated\": {\"$first\":\"$date_updated\"}, \n          \"organization\": {\"$first\":\"$organization\"}\n         }\n}\n</code></pre>\n\n<p>Note that the above also replaces <code>{\"_id\":{\"user\":\"$user\"}}</code> with simpler <code>{\"_id\":\"$user\"}</code>. </p>\n\n<p>Next we'll add <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/project/\" rel=\"nofollow noreferrer\">$project stage</a> to rename our result of <code>_id</code> field from the group operation back to <code>user</code>. Also carry along the other fields without modifications. </p>\n\n<pre><code>{\"$project\": {\n              \"user\": \"$_id\", \n              \"date_updated\": 1, \n              \"organization\": 1\n             }\n }\n</code></pre>\n\n<p>Your <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/match/\" rel=\"nofollow noreferrer\">$match stage</a> can be simplified, by just listing the <code>date_updated</code> filter. First we can remove <code>_id</code> as it's no longer relevant up to this point in the pipeline, and also if you would like to make sure that you only process documents with <code>user</code> value you should placed <code>$match</code> before the <code>$group</code>. See <a href=\"https://docs.mongodb.com/manual/core/aggregation-pipeline-optimization/\" rel=\"nofollow noreferrer\">Aggregation Pipeline Optimization</a> for more. </p>\n\n<p>So, all of those combined will look something as below: </p>\n\n<pre><code>[\n {\"$group\":{ \n             \"_id\": \"$user\", \n             \"date_updated\": { \"$first\": \"$date_updated\"}, \n             \"organization\": { $first: \"$organization\"} \n           }\n },\n {\"$project\":{ \n               \"user\": \"$_id\", \n               \"date_updated\": 1, \n               \"organization\": 1\n             }\n }, \n {\"$match\":{\n          \"date_updated\": {\"$gt\": durationDays } }\n }, \n {\"$lookup\":{\n             \"from\": \"users\", \n             \"localField\": \"user\", \n             \"foreignField\": \"_id\", \n             \"as\": \"user_details\"\n            }\n }, \n {\"$lookup\":{\n            \"from\": \"organizations\", \n            \"localField\": \"organization\", \n            \"foreignField\": \"_id\", \n            \"as\": \"organization_details\"\n            }\n }\n]\n</code></pre>\n\n<p>(I know you're aware of it) Lastly, based on the database schema above with <code>users</code> and <code>organizations</code> collections, depending on your application use case you may re-consider embedding some values. You may find <a href=\"https://www.mongodb.com/blog/post/6-rules-of-thumb-for-mongodb-schema-design-part-1\" rel=\"nofollow noreferrer\">6 Rules of Thumb for MongoDB Schema Design</a> useful. </p>\n"}], "owner": {"reputation": 1458, "user_id": 2032771, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/UNFib.jpg?s=128&g=1", "display_name": "avrono", "link": "https://stackoverflow.com/users/2032771/avrono"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1163, "favorite_count": 0, "accepted_answer_id": 46290198, "answer_count": 1, "score": 0, "last_activity_date": 1511994723, "creation_date": 1505493282, "last_edit_date": 1505493993, "question_id": 46244098, "link": "https://stackoverflow.com/questions/46244098/mgo-with-aggregation-and-grouping", "title": "mgo with aggregation and grouping", "body": "<p>I am trying to perform a query using golang mgo \nto effectively get distinct values from a join, I understand that this might not be the best paradigm to work with in Mongo. </p>\n\n<p>Something like this:</p>\n\n<pre><code>pipe := []bson.M{\n\n    {\n        \"$group\": bson.M{\n            \"_id\":  bson.M{\"user\": \"$user\"},\n\n        },\n    },\n\n    {\n        \"$match\": bson.M{\n            \"_id\":  bson.M{\"$exists\": 1},\n            \"user\": bson.M{\"$exists\": 1},\n            \"date_updated\": bson.M{\n                \"$gt\": durationDays,\n            },\n        },\n\n    },\n\n    {\n        \"$lookup\": bson.M{\n            \"from\":         \"users\",\n            \"localField\":   \"user\",\n            \"foreignField\": \"_id\",\n            \"as\":           \"user_details\",\n        },\n    },\n    {\n        \"$lookup\": bson.M{\n            \"from\":         \"organizations\",\n            \"localField\":   \"organization\",\n            \"foreignField\": \"_id\",\n            \"as\":           \"organization_details\",\n        },\n    },\n\n}\n\nerr := d.Pipe(pipe).All(&amp;result)\n</code></pre>\n\n<p>If I comment out the <code>$group</code> section, the query returns the join as expected. </p>\n\n<p>If I run as is, I get <code>NULL</code></p>\n\n<p>If I move the <code>$group</code> to the bottom of the pipe I get an array response with Null values</p>\n\n<p>Is it possible to do do an aggregation with a <code>$group</code> (with the goal of simulating <code>DISTINCT</code>) ?</p>\n"}, {"tags": ["go", "interface", "mocking", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "is_accepted": true, "score": 1, "last_activity_date": 1505514341, "creation_date": 1505514341, "answer_id": 46248198, "question_id": 46244007, "link": "https://stackoverflow.com/questions/46244007/mocking-mgo-chaining-functions/46248198#46248198", "title": "Mocking mgo chaining functions", "body": "<p>The function signatures are different, which is why you're running into a compilation error. Your interface version of <code>Select</code> returns <em>your</em> <code>Query</code> type, while mgo's <code>Select</code> returns <code>*mgo.Query</code>, which is a different type. Even if that type <em>does</em> implement your interface, the function signatures are still different. You will need to add another layer to this where you are able to wrap the mgo package.</p>\n\n<pre><code>type MgoQuery struct {\n    *mgo.Query\n}\n\nfunc (q *MgoQuery) Select(selector interface{}) Query {\n    return q.Query.Select(selector)\n}\n\n...\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5294130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a127f33b25b985a7ab2bb51145669d0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Wendling", "link": "https://stackoverflow.com/users/5294130/steven-wendling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "accepted_answer_id": 46248198, "answer_count": 1, "score": 1, "last_activity_date": 1505514341, "creation_date": 1505492917, "question_id": 46244007, "link": "https://stackoverflow.com/questions/46244007/mocking-mgo-chaining-functions", "title": "Mocking mgo chaining functions", "body": "<p>While testing some of my codebase I found it useful to mock out objects from \"gopkg.in/mgo.v2\" with interfaces. I'm running into a problem where mgo.Query does not implement my interface Query.</p>\n\n<pre><code>import mgo \"gopkg.in/mgo.v2\"\n\ntype Collection interface {\n    FindId(interface{}) Query\n    Find(interface{}) Query\n    UpdateId(interface{}, interface{}) error\n    Update(interface{}, interface{}) error\n    UpsertId(interface{}, interface{}) (interface{}, error)\n    Insert(...interface{}) error\n    RemoveId(interface{}) error\n}\n\ntype Query interface {\n    One(interface{}) error\n    All(interface{}) error\n    Select(interface{}) Query\n}\n\nvar _ Query = (*mgo.Query)(nil)\n</code></pre>\n\n<p>The Query cast kicks up the error:</p>\n\n<pre><code>cannot use (*mgo.Query)(nil) (type *mgo.Query) as type Query in assignment:\n    *mgo.Query does not implement Query (wrong type for Select method)\n        have Select(interface {}) *mgo.Query\n        want Select(interface {}) Query\n</code></pre>\n\n<p>Is this a problem with chain functions not being able to be defined in an interface? I'm not sure how to make a Select header that will match the mgo implementation.</p>\n"}, {"tags": ["go", "goland"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505483704, "post_id": 46241177, "comment_id": 79446351, "body": "Also make sure you do not have GOROOT set in your environment (or set it very carefully if you <i>really</i> need it, which you probably don&#39;t)"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1505501392, "post_id": 46241177, "comment_id": 79455837, "body": "In HomeBrew&#39;s case GOROOT is needed, which sadly leads to some other issues."}], "answers": [{"comments": [{"owner": {"reputation": 972, "user_id": 1260548, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b2ca990a7888cda2671c3eb1b3161068?s=128&d=identicon&r=PG", "display_name": "Markus Tenghamn", "link": "https://stackoverflow.com/users/1260548/markus-tenghamn"}, "edited": false, "score": 3, "creation_date": 1505484119, "post_id": 46241274, "comment_id": 79446681, "body": "Thank you, I was able to solve this by running <code>brew uninstall --force go</code> and then downloading the latest installer. Anyone who reads this and wants to use brew you could probably just do <code>brew install go</code> after the forced uninstall. I had to restart my terminal and Gogland after doing this."}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 7, "last_activity_date": 1505483635, "creation_date": 1505483635, "answer_id": 46241274, "question_id": 46241177, "link": "https://stackoverflow.com/questions/46241177/in-gogland-i-get-flag-provided-but-not-defined-goversion-using-go-run/46241274#46241274", "title": "In Gogland I get &#39;flag provided but not defined: -goversion&#39; using go run", "body": "<p>You've installed one Go version from one distribution and another Go version from another distribution (likely one from Homebrew and another from the distribution binaries, for example).</p>\n\n<p>Either remove one or the other as your system is currently in an undefined state.</p>\n\n<p>Gogland has nothing to do with this as it does not inject any parameters when you are using the terminal. You can run the file from Gogland itself by clicking on the green arrow next to <code>func main()</code> and it will use the internal logic to determine the execution model based on the SDK selected and the other parameters provided. You can customize the build process via Run | Edit Configurations.</p>\n"}], "owner": {"reputation": 972, "user_id": 1260548, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b2ca990a7888cda2671c3eb1b3161068?s=128&d=identicon&r=PG", "display_name": "Markus Tenghamn", "link": "https://stackoverflow.com/users/1260548/markus-tenghamn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6441, "favorite_count": 0, "accepted_answer_id": 46241274, "answer_count": 1, "score": 4, "last_activity_date": 1505483635, "creation_date": 1505483354, "question_id": 46241177, "link": "https://stackoverflow.com/questions/46241177/in-gogland-i-get-flag-provided-but-not-defined-goversion-using-go-run", "title": "In Gogland I get &#39;flag provided but not defined: -goversion&#39; using go run", "body": "<p>I am trying to run my go script called <code>release.go</code> in the Goglang built in terminal and it gives me the following output</p>\n\n<pre><code>$ go run release.go\n# command-line-arguments\nflag provided but not defined: -goversion\nusage: compile [options] file.go...\n  -%    debug non-static initializers\n...\n</code></pre>\n\n<p>If I run this in my terminal outside of Gogland the <code>release.go</code> file runs without issue.</p>\n\n<p>This problem started occurring after upgrading from version 1.8.3 to 1.9 and I have never used the <code>-goversion</code> flag before.</p>\n\n<p>Current Gogland version: </p>\n\n<pre><code>Gogland (1.0 Preview) 1.0 EAP\nBuild #GO-172.3968.45, built on September 5, 2017\nGogland EAP User\nExpiration date: December 4, 2017\nJRE: 1.8.0_152-release-915-b11 x86_64\nJVM: OpenJDK 64-Bit Server VM by JetBrains s.r.o\nMac OS X 10.12.6\n</code></pre>\n\n<p><strong>How can I fix this problem so that I can run go from the built in terminal in Gogland?</strong></p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505483494, "post_id": 46241146, "comment_id": 79446189, "body": "You&#39;re mounting your local directories as volumes with the <code>-v</code> flag. See the <code>docker run --help</code> output. Also, there are no C dependencies, you have <code>CGO_ENABLED=0</code>."}, {"owner": {"reputation": 562, "user_id": 1066063, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/31VvD.jpg?s=128&g=1", "display_name": "nciao", "link": "https://stackoverflow.com/users/1066063/nciao"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505484360, "post_id": 46241146, "comment_id": 79446868, "body": "Any chance you know why the CGO_ENABLED=0 flag is needed then? (in the context of being able to minimize the final docker container output?)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505484519, "post_id": 46241146, "comment_id": 79446976, "body": "<code>CGO_ENABLED=0</code> and <code>-a --installsuffix</code> are there to make sure <i>nothing</i> is built with cgo, so that the resulting binary isn&#39;t linked to any particular version of libc."}, {"owner": {"reputation": 562, "user_id": 1066063, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/31VvD.jpg?s=128&g=1", "display_name": "nciao", "link": "https://stackoverflow.com/users/1066063/nciao"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505484609, "post_id": 46241146, "comment_id": 79447040, "body": "what does it use instead then?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505484646, "post_id": 46241146, "comment_id": 79447061, "body": "What does it use instead of <i>what</i>?"}, {"owner": {"reputation": 562, "user_id": 1066063, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/31VvD.jpg?s=128&g=1", "display_name": "nciao", "link": "https://stackoverflow.com/users/1066063/nciao"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505484775, "post_id": 46241146, "comment_id": 79447140, "body": "presumably the default build makes use of libc in some way.  Providing these flags makes sure that libc is not used.    So now that I&#39;m not using it, does it mean that I&#39;m just hooped if I use a golang feature that just happens to eventually result in a libc call?  Does something else fill in the gap?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1505485180, "post_id": 46241146, "comment_id": 79447419, "body": "Yes, go works fine in nearly all cases without cgo. On Linux the only cases that would cause a problem are if your host has an /etc/resolv.conf or /etc/nsswitch.conf that requires libc for name resolution or user lookups."}], "answers": [{"comments": [{"owner": {"reputation": 562, "user_id": 1066063, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/31VvD.jpg?s=128&g=1", "display_name": "nciao", "link": "https://stackoverflow.com/users/1066063/nciao"}, "edited": false, "score": 0, "creation_date": 1505484127, "post_id": 46241267, "comment_id": 79446693, "body": "Do you know why we need to use a temporary docker container for the compilation? (as opposed to just compiling it normally - without a temp docker container)?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 562, "user_id": 1066063, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/31VvD.jpg?s=128&g=1", "display_name": "nciao", "link": "https://stackoverflow.com/users/1066063/nciao"}, "edited": false, "score": 0, "creation_date": 1505484589, "post_id": 46241267, "comment_id": 79447026, "body": "@nciao: you don&#39;t. It&#39;s just an example."}], "tags": [], "owner": {"reputation": 21540, "user_id": 139506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3292268cbf7710f1a900203e087be1a2?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/139506/chris"}, "is_accepted": true, "score": 2, "last_activity_date": 1505483614, "creation_date": 1505483614, "answer_id": 46241267, "question_id": 46241146, "link": "https://stackoverflow.com/questions/46241146/how-does-this-docker-command-which-makes-a-small-golang-container-work/46241267#46241267", "title": "How does this Docker command, which makes a small GoLang container, work?", "body": "<p>You're actually using 2 different docker containers, each with a different image. The first container is only around during the compilation... it uses the image golang:1.8. What you're doing is mounting your current working directory into that image and compiling it with the version of GO contained in the image.</p>\n\n<p>The second command builds your custom image that uses the iron/base image as its base. You then copy your built application into that image and run it.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1505573015, "post_id": 46254962, "comment_id": 79473579, "body": "Yeah, you just have to lurk for awhile before oyu gain enough rep to comment. See here for tips on rep: <a href=\"https://meta.stackexchange.com/questions/139661/how-to-get-initial-reputation-on-stack-overflow-with-the-new-user-restrictions-i\" title=\"how to get initial reputation on stack overflow with the new user restrictions i\">meta.stackexchange.com/questions/139661/&hellip;</a>"}, {"owner": {"reputation": 562, "user_id": 1066063, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/31VvD.jpg?s=128&g=1", "display_name": "nciao", "link": "https://stackoverflow.com/users/1066063/nciao"}, "edited": false, "score": 0, "creation_date": 1505578272, "post_id": 46254962, "comment_id": 79475300, "body": "Is it possible to put all the volume mounting (or alternatively, just pull my dependencies with Glide) and building steps into the DockerFile itself?  (So building the docker image also builds the Go binary inside it)?"}, {"owner": {"reputation": 116, "user_id": 1696780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe6116b69ce99e0ed9928b95e6dddb5b?s=128&d=identicon&r=PG&f=1", "display_name": "AleGra", "link": "https://stackoverflow.com/users/1696780/alegra"}, "edited": false, "score": 0, "creation_date": 1505578696, "post_id": 46254962, "comment_id": 79475432, "body": "The building steps yes, but the mounting no. The Dockerfile VOLUME command creates a mount point inside the container only. But you could use docker-compose for that."}], "tags": [], "owner": {"reputation": 116, "user_id": 1696780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe6116b69ce99e0ed9928b95e6dddb5b?s=128&d=identicon&r=PG&f=1", "display_name": "AleGra", "link": "https://stackoverflow.com/users/1696780/alegra"}, "is_accepted": false, "score": 1, "last_activity_date": 1505572159, "creation_date": 1505572159, "answer_id": 46254962, "question_id": 46241146, "link": "https://stackoverflow.com/questions/46241146/how-does-this-docker-command-which-makes-a-small-golang-container-work/46254962#46254962", "title": "How does this Docker command, which makes a small GoLang container, work?", "body": "<p>Using a golang container to build the binary is usually done for reproducibility of the build process, i.e.:</p>\n\n<ul>\n<li>it ensures that always the same Go version is used,</li>\n<li>compilation takes place in an alway clean environment,</li>\n<li>and the build host needs no Go installed at all, or can have a different version,</li>\n</ul>\n\n<p>This way, all parts needed to build the \"hello\" image can be tracked in a version control system.</p>\n\n<p>However, this example mounts the whole local GOPATH, defeating above purpose. Dependencies must be available to the build container, e.g. by vendoring them. Maybe the author considered vendoring out of scope for his example.</p>\n\n<p>(note: this should be a comment, but my reputation does not allow that)</p>\n"}], "owner": {"reputation": 562, "user_id": 1066063, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/31VvD.jpg?s=128&g=1", "display_name": "nciao", "link": "https://stackoverflow.com/users/1066063/nciao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 46241267, "answer_count": 2, "score": 0, "last_activity_date": 1505572159, "creation_date": 1505483271, "question_id": 46241146, "link": "https://stackoverflow.com/questions/46241146/how-does-this-docker-command-which-makes-a-small-golang-container-work", "title": "How does this Docker command, which makes a small GoLang container, work?", "body": "<p>New to docker here.  I followed the instructions <a href=\"https://www.iron.io/an-easier-way-to-create-tiny-golang-docker-images/\" rel=\"nofollow noreferrer\">here</a> to make a slim &amp; trim container for my Go Project.  I do not fully understand what it's doing though, hopefully someone can enlighten me.</p>\n\n<p>Specifically there are two steps to generating this docker container.</p>\n\n<ol>\n<li><code>docker run --rm -it -v \"$GOPATH\":/gopath -v \"$(pwd)\":/app -e \"GOPATH=/gopath\" -w /app golang:1.8 sh -c 'CGO_ENABLED=0 go build -a --installsuffix cgo --ldflags=\"-s\" -o hello'</code></li>\n<li><code>docker build -t myDockerImageName .</code></li>\n</ol>\n\n<p>The DockerFile itself just contains</p>\n\n<pre><code>FROM iron/base\nWORKDIR /app\nCOPY hello /app/\nENTRYPOINT [\"./hello\"]\n</code></pre>\n\n<p>I understand (in a broad sense) that the 1st step is compiling the go program and statically linking the C-dependencies (and doing all this inside an unnamed docker container).  The 2nd step just generates the docker image according to the instructions in the DockerFile.</p>\n\n<p>What I don't understand is why the first command starts with <code>docker run</code> (why does it need to be run inside a docker container?  Why are we not just generating the Go binary outside of it, and then copying it in?)</p>\n\n<p>And if it's being run inside a docker container, how is binary generated in the docker container being dropped on my local machine's file system?(e.g. why do I need to copy the binary back into the image - as it seems to be doing on line 3 of the DockerFile?)</p>\n"}]