[{"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1477518934, "post_id": 40272698, "comment_id": 67805409, "body": "What line does your error actually come from? The simple answer is, you have some type that is being represented by the empty interface <code>interface{}</code>. If the underlying type is in fact a <code>map[string]interface{}</code> then you can do a type assert on it <code>v.(map[string]interface{})</code> in order to get the correct type for subsequent statements. If the underlying type isn&#39;t a <code>map[string]interface{}</code> then you need to look at your input because it differs from what the statements down the page expect."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1477518976, "creation_date": 1477518976, "answer_id": 40272771, "question_id": 40272698, "link": "https://stackoverflow.com/questions/40272698/how-do-typecast-a-type-in-go/40272771#40272771", "title": "How do typecast a type in Go", "body": "<p>Use a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">type assertion</a>:</p>\n\n<pre><code>func printMap(m map[string]interface{}) {\n  for k, v := range m {\n    m, ok := v.(map[string]interface{}) // &lt;-- assert that v is a map\n    if ok {\n        printMap(m)\n    } else {\n        fmt.Println(k, v)\n    }\n  }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/S6k9DicmVY\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 437, "user_id": 686334, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd88dca6931036c734fdfc34535277aa?s=128&d=identicon&r=PG", "display_name": "CrabbyPete", "link": "https://stackoverflow.com/users/686334/crabbypete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477518976, "creation_date": 1477518710, "question_id": 40272698, "link": "https://stackoverflow.com/questions/40272698/how-do-typecast-a-type-in-go", "title": "How do typecast a type in Go", "body": "<p>I am trying to make a recursive routine that prints the elements of a complex json </p>\n\n<pre><code>func printMap(m map[string]interface{}) {\nfor k, v := range m {\n    typ := reflect.ValueOf(v).Kind()\n    if typ == reflect.Map {\n        printMap(v)\n    } else {\n        fmt.Println(k, v)\n    }\n} }\n</code></pre>\n\n<p>but I get a build error \ncan use type v ( type interface {} ) as type map[string] interface{}</p>\n\n<p>Is there a way to type cast it or someway I can get it to work?</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3", "aws-sdk", "aws-sdk-go"], "answers": [{"comments": [{"owner": {"reputation": 5779, "user_id": 876686, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0dc9f06a29ef13328a46d31db59634ea?s=128&d=identicon&r=PG", "display_name": "tier1", "link": "https://stackoverflow.com/users/876686/tier1"}, "edited": false, "score": 0, "creation_date": 1477662166, "post_id": 40273730, "comment_id": 67869909, "body": "Much appreciated.  Hate to be the guy that didn&#39;t read / understand the docs"}], "tags": [], "owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "is_accepted": true, "score": 7, "last_activity_date": 1477524450, "last_edit_date": 1592644375, "creation_date": 1477524450, "answer_id": 40273730, "question_id": 40269901, "link": "https://stackoverflow.com/questions/40269901/s3-objects-not-expiring-using-the-golang-sdk/40273730#40273730", "title": "S3 objects not expiring using the Golang SDK", "body": "<p>Well, <code>Expires</code> is just the wrong field:</p>\n<blockquote>\n<p>// The date and time at which the object is no longer cacheable.</p>\n</blockquote>\n<p>What you want is <code>Object Expiration</code> which can be set as a bucket rule and not per object.</p>\n<p>Basically, you add a Lifecycle rule (on the bucket properties) specifying:</p>\n<blockquote>\n<p>Each rule has the following attributes:</p>\n<p>Prefix \u2013 Initial part of the key name, (e.g. logs/), or the entire key name. Any object in the bucket with a matching prefix will be subject to this expiration rule. An empty prefix will match all objects in the bucket.</p>\n<p>Status \u2013 Either Enabled or Disabled. You can choose to enable rules from time to time to perform deletion or garbage collection on your buckets, and leave the rules disabled at other times.</p>\n<p>Expiration \u2013 Specifies an expiration period for the objects that are subject to the rule, as a number of days from the object\u2019s creation date.</p>\n<p>Id \u2013 Optional, gives a name to the rule.</p>\n</blockquote>\n<p>This rule will then be evaluated daily and any expired objects will be removed.</p>\n<p>See <a href=\"https://aws.amazon.com/blogs/aws/amazon-s3-object-expiration/\" rel=\"noreferrer\">https://aws.amazon.com/blogs/aws/amazon-s3-object-expiration/</a> for a more in-depth explanation.</p>\n"}, {"tags": [], "owner": {"reputation": 971, "user_id": 2202757, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/U5NGN.jpg?s=128&g=1", "display_name": "sh0umik", "link": "https://stackoverflow.com/users/2202757/sh0umik"}, "is_accepted": false, "score": 2, "last_activity_date": 1583496560, "creation_date": 1583496560, "answer_id": 60563793, "question_id": 40269901, "link": "https://stackoverflow.com/questions/40269901/s3-objects-not-expiring-using-the-golang-sdk/60563793#60563793", "title": "S3 objects not expiring using the Golang SDK", "body": "<p>One way to expire objects in S3 using Golang SDK is to tag your upload with something like </p>\n\n<p><code>Tagging: aws.String(\"temp=true\")</code></p>\n\n<p>Then, Go to S3 Bucket Managment Console and Set a LifeCycle Rule <strong>targeting for that specific ta</strong>g like this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/I0buY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I0buY.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can configure the time frame to expire the object during the creation of the Rule in LifeCycle.</p>\n"}], "owner": {"reputation": 5779, "user_id": 876686, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0dc9f06a29ef13328a46d31db59634ea?s=128&d=identicon&r=PG", "display_name": "tier1", "link": "https://stackoverflow.com/users/876686/tier1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1301, "favorite_count": 1, "accepted_answer_id": 40273730, "answer_count": 2, "score": 4, "last_activity_date": 1583496560, "creation_date": 1477507396, "last_edit_date": 1485806212, "question_id": 40269901, "link": "https://stackoverflow.com/questions/40269901/s3-objects-not-expiring-using-the-golang-sdk", "title": "S3 objects not expiring using the Golang SDK", "body": "<p>Using the AWS Golang SDK, I'm attempting to set an expiration date for some of the objects that I'm uploading.  I'm pretty sure that the header is being set correctly, however, when logging into S3 and viewing the properties of the new object, it doesn't appear to have a expiration date.</p>\n\n<p>Below is a snippet of how I'm uploading objects</p>\n\n<pre><code>exp := time.Now()\nexp = exp.Add(time.Hour * 24)\n\nsvc := s3.New(session.New(config))\n_, err = svc.PutObject(&amp;s3.PutObjectInput{\n    Bucket:        aws.String(\"MyBucketName\"),\n    Key:           aws.String(\"201700689.zip\"),\n    Body:          fileBytes,\n    ContentLength: aws.Int64(size),\n    ContentType:   aws.String(fileType),\n    Expires:       &amp;exp,\n})\n</code></pre>\n\n<p>And here is what I see when logging into the site\n<a href=\"https://i.stack.imgur.com/BEDsF.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/BEDsF.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any idea what is going on here?  Thanks</p>\n"}, {"tags": ["github", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477507510, "post_id": 40269848, "comment_id": 67799887, "body": "Changing directories in another instance of <code>&#47;bin&#47;sh</code> doesn&#39;t change your working directory. Also, why not just call <code>git</code> directly?"}, {"owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477507630, "post_id": 40269848, "comment_id": 67799963, "body": "Sorry, for posting dummy questions again, but I run go run main.go in &quot;/generator&quot;, but I need to go to sibling dir or I can hardcode dir /home/svitlana/go/src/realsiter/realster and run there git pull <a href=\"https://github\" rel=\"nofollow noreferrer\">github</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1477508105, "post_id": 40269848, "comment_id": 67800225, "body": "Executing a new shell and changing <i>its</i> directory does nothing. You can use <code>os.Chdir</code> if you want to change the working directory of your process. But again, why not just execute <code>git pull</code> directly, rather than trying to use various libgit2 bindings?"}, {"owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477508741, "post_id": 40269848, "comment_id": 67800537, "body": "a good idea :-). And how to specify auth info?"}, {"owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477509205, "post_id": 40269848, "comment_id": 67800765, "body": "executable file not found in $PATH"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1477509769, "post_id": 40269848, "comment_id": 67801079, "body": "You can use ssh, which will fetch your key from an agent. If you require https access, you can use a netrc file or other various options: <a href=\"https://stackoverflow.com/questions/5343068/is-there-a-way-to-skip-password-typing-when-using-https-on-github\" title=\"is there a way to skip password typing when using https on github\">stackoverflow.com/questions/5343068/&hellip;</a>"}, {"owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477509939, "post_id": 40269848, "comment_id": 67801152, "body": "Thank you, Jim.  Already reading, hope to get it done. Thank you for your time!"}], "answers": [{"tags": [], "owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "is_accepted": false, "score": 0, "last_activity_date": 1477510608, "creation_date": 1477510608, "answer_id": 40270792, "question_id": 40269848, "link": "https://stackoverflow.com/questions/40269848/golang-clone-private-github-repository/40270792#40270792", "title": "Golang clone private github repository", "body": "<p>Credits comes to @JimB :-)   </p>\n\n<pre><code> func update_ghub(wg *sync.WaitGroup) {\n    var (\n        cmdOut []byte\n        err    error\n    )\n    err = os.Chdir(\"/home/svitlana/go/src/realsiter/realster\")\n    if err != nil {\n        log.Fatalln(err)\n    }\n\n    cmdName := \"git\"\n    cmdArgs := []string{\"pull\"}\n\n    if cmdOut, err = exec.Command(cmdName, cmdArgs...).Output(); err != nil {\n        fmt.Fprintln(os.Stderr, \"There was an error running git rev-parse command: \", err)\n        os.Exit(1)\n    }\n    sha := string(cmdOut)\n    fmt.Println(\"Response:\", sha)\n    wg.Done()\n}\n</code></pre>\n"}], "owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 938, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1477510608, "creation_date": 1477507190, "question_id": 40269848, "link": "https://stackoverflow.com/questions/40269848/golang-clone-private-github-repository", "title": "Golang clone private github repository", "body": "<p>I am writing a go-lang app and I need to:</p>\n\n<ol>\n<li><p>Go to the sibling directory\ntried with:</p>\n\n<p><code>exec.Command(\"/bin/sh\", \"-c\", \"cd ..\").Output()</code></p></li>\n<li><p>And clone/update GitHub private repository:\ngit clone ....GitHub repository</p></li>\n</ol>\n\n<p>I cannot accomplish neither of those tasks. \nI tried GitHub/libgit2/git2go but on Ubuntu 16.04 <code>libgit2</code> cannot understand https.</p>\n\n<p>Thank you for any help.</p>\n"}, {"tags": ["go", "types"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1477502911, "post_id": 40268276, "comment_id": 67797270, "body": "You don&#39;t need the type names for typed string literals when you define a <code>map[MAC]HOST</code>. Package <code>net</code>&#39;s <code>type IP []byte</code> is kind of a precedent for having a barebones address type, but it&#39;s doing a bit of real work (binary&lt;=&gt;string conversion and treating 4- and 16-byte IPs as IPv4 and IPv6). The host type I see less use for and would also be named Host under normal Go capitalization rules. I&#39;d be inclined <i>not</i> to add the types unless you wind up with a lot of stuff you want to do in/with them."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1477503445, "post_id": 40268276, "comment_id": 67797556, "body": "The reason for naming types is almost always to define methods."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1477506339, "post_id": 40268276, "comment_id": 67799179, "body": "Only use new types when you want to extend the behavior of a string or integer for instance, in your case I don&#39;t see why new types. Also Go has a well defined encapsulation system using lowercase for private fields and uppercase for public ones, so create vars and types all in uppercase like MAC doesn&#39;t look good in Go, in other languages maybe, but in Go is not idiomatic."}], "answers": [{"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": false, "score": 0, "last_activity_date": 1477504290, "creation_date": 1477504290, "answer_id": 40268999, "question_id": 40268276, "link": "https://stackoverflow.com/questions/40268276/best-practices-to-use-own-type-in-golang-alians-to-build-type/40268999#40268999", "title": "Best practices to use own type in golang. Alians to build type", "body": "<p>One of the most important features of Go is interfaces. In Go by defining the method/s of an Interface you implement the interface, and the only way to implement an interface is by adding a Method to your type. For instance, say you want to implement the <a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"nofollow\"><code>Stringer</code></a> interface from the <code>fmt</code> package.</p>\n\n<p>In your example <code>type MACHINES map[string]string</code> you would add a method called <code>String</code> to your type.</p>\n\n<pre><code>func (m MACHINES) String() string {\n    s := \"MACHINES\\n\"\n    for k, v := range m {\n        s += fmt.Sprintf(\"%v: %v\\n\", k, v)\n    }\n    return s\n}\n</code></pre>\n\n<p>Any other function that accepts the <code>Stringer</code> interfaces can now also accept your MACHINES type since you implemented the <code>Stringer</code> interface.</p>\n\n<p>For example the <code>fmt.Printf</code> checks if the passed in type implements the <code>Stringer</code> interface</p>\n\n<pre><code>m := MACHINES{\"foo\":\"bar\", \"baz\": \"bust\"}\nfmt.Printf(\"%s\", m)\n</code></pre>\n\n<p>Will invoke MACHINES String method</p>\n\n<p>Example from the <a href=\"https://play.golang.org/p/Fc_8LkgAlf\" rel=\"nofollow\">playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "is_accepted": false, "score": 4, "last_activity_date": 1477504378, "creation_date": 1477504378, "answer_id": 40269029, "question_id": 40268276, "link": "https://stackoverflow.com/questions/40268276/best-practices-to-use-own-type-in-golang-alians-to-build-type/40269029#40269029", "title": "Best practices to use own type in golang. Alians to build type", "body": "<p>Without commenting on your specific example, there are a few reasons you'd generally want to use a new type:</p>\n\n<ul>\n<li>You need to define methods on the type</li>\n<li>You don't want the type to be comparable with literals or variables with the type it's derived from (eg. to reduce user confusion or make sure they don't do something invalid like attempt to compare your special string with some other random string)</li>\n<li>You just need a place to put documentation, or to group methods that return a specific type (eg. if you have several Dial methods that return a <code>net.Conn</code>, you might create a <code>type Conn net.Conn</code> and return that instead just for the sake of grouping the functions under the Conn type header in godoc or to provide general documentation for the net.Conn returned by the methods).</li>\n<li>Because you want people to be able to check if something of a generic type came from your package or not (eg. even if your Conn is just a normal net.Conn, it gives you the option of type switching and checking if it's a yourpackage.Conn as well)</li>\n<li>You want a function to take an argument from a predefined list of things and you don't want the user to be able to make new values that can be passed in (eg. a list of exported constants of an unexported type)</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 491, "user_id": 4699030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PtpXlAvuawc/AAAAAAAAAAI/AAAAAAAABgA/eeoUql28GSs/photo.jpg?sz=128", "display_name": "Juan Carlos Garcia", "link": "https://stackoverflow.com/users/4699030/juan-carlos-garcia"}, "is_accepted": true, "score": 1, "last_activity_date": 1477504826, "creation_date": 1477504826, "answer_id": 40269161, "question_id": 40268276, "link": "https://stackoverflow.com/questions/40268276/best-practices-to-use-own-type-in-golang-alians-to-build-type/40269161#40269161", "title": "Best practices to use own type in golang. Alians to build type", "body": "<p>Creating type alias is only useful when you require to add extra methods (such as validation functions) or when you want to document the desired use of some value (for example, the <a href=\"https://godoc.org/net#IP\" rel=\"nofollow\">net.IP</a> type).</p>\n\n<p>Type alias <em>could</em> help you to prevent API misunderstanding, but won't if you're using constant values. For example, this code is valid:</p>\n\n<pre><code>type Host string\ntype Mac string\nhosts := map[Mac]Host{\"ad:cb..\": \"localhost\"}\n</code></pre>\n\n<p>For further information about how constants work in Go, you can check the <a href=\"https://blog.golang.org/constants\" rel=\"nofollow\">Rob Pike's blog post</a> </p>\n"}, {"comments": [{"owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "edited": false, "score": 0, "creation_date": 1477519623, "post_id": 40269510, "comment_id": 67805628, "body": "Yes ofcorse. This was be only example. For me important is usage own type when, why, and when I shuldn&#39;t use. thx"}], "tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 0, "last_activity_date": 1477506041, "creation_date": 1477506041, "answer_id": 40269510, "question_id": 40268276, "link": "https://stackoverflow.com/questions/40268276/best-practices-to-use-own-type-in-golang-alians-to-build-type/40269510#40269510", "title": "Best practices to use own type in golang. Alians to build type", "body": "<p>You do want to use your own types in my opinion.</p>\n\n<p>As an example, lists of function arguments that are all \"string\" or all \"int\" are confusing and very easy to get wrong.</p>\n\n<p>And a comment on your type names. \"MAC\" is an acronym for Media Access Control so it should stay as all caps. But \"HOST\" should be \"Host\" since it is just a word. I don't recall where it is exactly, but there's a recommended form for Go names which is CamelCase with all-capital abbreviations, like \"GetIPv4AddressFromDNS\"</p>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 4706966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87783d48f814a3408b91c481cce250e8?s=128&d=identicon&r=PG&f=1", "display_name": "very", "link": "https://stackoverflow.com/users/4706966/very"}, "is_accepted": false, "score": 0, "last_activity_date": 1496745020, "creation_date": 1496745020, "answer_id": 44387590, "question_id": 40268276, "link": "https://stackoverflow.com/questions/40268276/best-practices-to-use-own-type-in-golang-alians-to-build-type/44387590#44387590", "title": "Best practices to use own type in golang. Alians to build type", "body": "<p>I think another reason to use your own types, that hasn't been mentioned here, is if you are not sure exactly what the right type for something is e.g. uint8 / uint16 and you want to easily change it later all in one place. </p>\n\n<p>This will however make conversions necessary whenever you want to use the built-in types' methods. Or you will need to define them on your own type.</p>\n"}], "owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1507, "favorite_count": 0, "accepted_answer_id": 40269161, "answer_count": 5, "score": 1, "last_activity_date": 1496745020, "creation_date": 1477501727, "last_edit_date": 1493226158, "question_id": 40268276, "link": "https://stackoverflow.com/questions/40268276/best-practices-to-use-own-type-in-golang-alians-to-build-type", "title": "Best practices to use own type in golang. Alians to build type", "body": "<p>I wonder when or if it should be use own type in golang. When this will be more friendly to understand my code, or when I shouldn't use own type. </p>\n\n<p>Example:\nI want to create <code>map</code> type with <strong>MAC</strong>, and <strong>name host</strong>:</p>\n\n<p>in first way the simplest I can do that</p>\n\n<pre><code>var machines map[string]string{\n   \"11:22...\": \"myHost\",\n   \"22:33..\":  \"yourHost\",\n}\n</code></pre>\n\n<p>in second way</p>\n\n<pre><code>type MAC string\ntype HOST string\n\n  machines := map[MAC]HOST{\n       MAC(\"11:22..\") : HOST(\"myHost\"),\n       MAC(\"22:33..\") : HOST(\"yourHost\"),\n    }\n</code></pre>\n\n<p>In above exmaple I can get additional controle on my type <code>MAC</code>, <code>HOST</code> trought write method to validation, compare etc it is better ?</p>\n\n<p>Third way</p>\n\n<pre><code>type MACHINES map[string]string\n\nm := MACHINES{}\n    m = map[string]string{\n     \"11:22..\" : \"myHost\",\n     \"22:33\" : \"yourHost\",\n    }\n</code></pre>\n\n<p>above example for me is worst to understand  less intuitive to some else. I think that above example should be also filled about HOST, and MAC because type MACHINE nothing to say developer how this should be implement so I would like</p>\n\n<pre><code>  type MACHINES map[MAC]HOST\n</code></pre>\n\n<p>However, please about comment to better understand about usage own type in golang. </p>\n"}, {"tags": ["c", "go", "dlopen", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1477496989, "post_id": 40266634, "comment_id": 67793832, "body": "What is the output of running <code>ldd</code> on your go binary?"}, {"owner": {"reputation": 41, "user_id": 3218590, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed421600c9a989bef750d7b457ce880d?s=128&d=identicon&r=PG&f=1", "display_name": "user3218590", "link": "https://stackoverflow.com/users/3218590/user3218590"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477501393, "post_id": 40266634, "comment_id": 67796488, "body": "updated the output of ldd"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477502680, "post_id": 40266634, "comment_id": 67797142, "body": "Does this help? <a href=\"https://groups.google.com/d/msg/golang-nuts/NPEKogRR9Q0/IC-IUUy7CQAJ\" rel=\"nofollow noreferrer\">groups.google.com/d/msg/golang-nuts/NPEKogRR9Q0/IC-IUUy7CQAJ</a>"}, {"owner": {"reputation": 41, "user_id": 3218590, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed421600c9a989bef750d7b457ce880d?s=128&d=identicon&r=PG&f=1", "display_name": "user3218590", "link": "https://stackoverflow.com/users/3218590/user3218590"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477504230, "post_id": 40266634, "comment_id": 67798038, "body": "No it didn&#39;t help"}], "owner": {"reputation": 41, "user_id": 3218590, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed421600c9a989bef750d7b457ce880d?s=128&d=identicon&r=PG&f=1", "display_name": "user3218590", "link": "https://stackoverflow.com/users/3218590/user3218590"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1477501238, "creation_date": 1477496649, "last_edit_date": 1477501238, "question_id": 40266634, "link": "https://stackoverflow.com/questions/40266634/issue-with-c-and-golang-integration", "title": "Issue with C and Golang integration", "body": "<p>I have a C shared library named libtest.so which in turn use another shared library lihelp.so.\nThe code for libtest.so use dlopen() to load the libhelp.so</p>\n\n<p>I have integrated libtest.so with my GO script gotest.go</p>\n\n<p>When I run gotest.go after building and installing, I am seeing libtest.so is getting loaded successfully and function in libtest is executed successfully.\nBut the dlopen() call in libtest.so to load libhelp.so is failining with error \"undefined symbol: dlopen\"</p>\n\n<p>But if I write a C application which use libtest.so all execution are fine withour any error.</p>\n\n<p>Here is the code snippet of my Go file</p>\n\n<pre><code>/*\n #cgo CFLAGS: -I./include\n #cgo LDFLAGS: -L. -ltest -ldl\n*/\n</code></pre>\n\n<p>Here is the Makefile entry for building libtest.so</p>\n\n<pre><code>CC = gcc # C compiler\nCFLAGS = -c -fPIC -I./include # C flags\nLDFLAGS = -shared -L/lib -ldl # linking flags\n</code></pre>\n\n<p>Can any one suggest what can be the problem?</p>\n\n<hr>\n\n<p>Output of ldd of my go binary</p>\n\n<pre><code>ldd app\n    linux-gate.so.1 =&gt;  (0xb77c3000)\n    libtest.so =&gt; ./libtest.so (0xb77bc000)\n    libgo.so.5 =&gt; /usr/lib/i386-linux-gnu/libgo.so.5 (0xb6ed0000)\n    libgcc_s.so.1 =&gt; /lib/i386-linux-gnu/libgcc_s.so.1 (0xb6eb2000)\n    libc.so.6 =&gt; /lib/i386-linux-gnu/libc.so.6 (0xb6d03000)\n    /lib/ld-linux.so.2 (0xb77c4000)\n    libpthread.so.0 =&gt; /lib/i386-linux-gnu/libpthread.so.0 (0xb6ce7000)\n    libm.so.6 =&gt; /lib/i386-linux-gnu/libm.so.6 (0xb6ca1000)\n</code></pre>\n"}, {"tags": ["mysql", "go"], "answers": [{"comments": [{"owner": {"reputation": 3240, "user_id": 2694306, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/a36c65851474c1cca6200426379fd82f?s=128&d=identicon&r=PG&f=1", "display_name": "user2694306", "link": "https://stackoverflow.com/users/2694306/user2694306"}, "edited": false, "score": 0, "creation_date": 1477496947, "post_id": 40266692, "comment_id": 67793800, "body": "Is there a way to cast a string to NullString?"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 14, "last_activity_date": 1477497473, "last_edit_date": 1477497473, "creation_date": 1477496792, "answer_id": 40266692, "question_id": 40266633, "link": "https://stackoverflow.com/questions/40266633/golang-insert-null-into-sql-instead-of-empty-string/40266692#40266692", "title": "Golang Insert NULL into sql instead of empty string", "body": "<p>The <code>database/sql</code> package has a <code>NullString</code> type (<a href=\"https://golang.org/pkg/database/sql/#NullString\" rel=\"noreferrer\">docs</a>) for just this situation.</p>\n\n<p>Basically just use <code>sql.NullString</code> in place of strings where you want them to be nullable in db. </p>\n\n<p>You could also use a <code>*string</code> in your code to the same effect. </p>\n\n<p>The problem in either case is in mapping to/from a nullable string to a non-nullable string. The empty string is technically a value, so you will almost always have to do something like this if you decide empty string should be translated to nil:</p>\n\n<pre><code>nullableS := &amp;s\nif s == \"\" {\n  nullableS = nil\n}\n</code></pre>\n\n<p>The alternative would be to just use <code>*string</code> instead of <code>string</code> in your models throughout your app. </p>\n\n<p>In databases, I have been taking the approach that empty string and null are equivalent, and just storing empty sting in the db, and making most columns non-nullable. </p>\n"}, {"comments": [{"owner": {"reputation": 4197, "user_id": 1632346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c043a71ec4903a9a9e6a4de90c787fa1?s=128&d=identicon&r=PG", "display_name": "slomek", "link": "https://stackoverflow.com/users/1632346/slomek"}, "edited": false, "score": 1, "creation_date": 1477547566, "post_id": 40268372, "comment_id": 67812918, "body": "Why don&#39;t you make your <code>NewNullString(..)</code> function return <code>interface{}</code>, so that if <code>s</code> is not an empty string, you could return it without wrapping into <code>sql.NullString</code>?"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 4197, "user_id": 1632346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c043a71ec4903a9a9e6a4de90c787fa1?s=128&d=identicon&r=PG", "display_name": "slomek", "link": "https://stackoverflow.com/users/1632346/slomek"}, "edited": false, "score": 5, "creation_date": 1477616539, "post_id": 40268372, "comment_id": 67851171, "body": "@slomek I would find it confusing if a function named <code>NewNullString</code> did not return a type called NullString."}, {"owner": {"reputation": 4197, "user_id": 1632346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c043a71ec4903a9a9e6a4de90c787fa1?s=128&d=identicon&r=PG", "display_name": "slomek", "link": "https://stackoverflow.com/users/1632346/slomek"}, "edited": false, "score": 0, "creation_date": 1477674013, "post_id": 40268372, "comment_id": 67876813, "body": "I would rename this function then, as returning sth other than an actual Null value seems confusing now. Don&#39;t take me wrong, this is after all the correct answer, I&#39;m just wondering ;)"}, {"owner": {"reputation": 398, "user_id": 2492825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98ea8df2183abd96fbc07697a720bce1?s=128&d=identicon&r=PG", "display_name": "praveent", "link": "https://stackoverflow.com/users/2492825/praveent"}, "edited": false, "score": 0, "creation_date": 1588424688, "post_id": 40268372, "comment_id": 108892597, "body": "@jmaloney It is an old question and kind of not in scope of question but, you should warn users to add ability to handle NullStrings while reading back using query. I ran into this issue today while trying to <code>Scan</code> <code>Null</code> value into a <code>string</code>."}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 58, "last_activity_date": 1477502105, "creation_date": 1477502105, "answer_id": 40268372, "question_id": 40266633, "link": "https://stackoverflow.com/questions/40266633/golang-insert-null-into-sql-instead-of-empty-string/40268372#40268372", "title": "Golang Insert NULL into sql instead of empty string", "body": "<p>In my code I have a function that converts a string to <a href=\"https://golang.org/pkg/database/sql/#NullString\" rel=\"noreferrer\"><code>sql.NullString</code></a></p>\n\n<pre><code>func NewNullString(s string) sql.NullString {\n    if len(s) == 0 {\n        return sql.NullString{}\n    }\n    return sql.NullString{\n         String: s,\n         Valid: true,\n    }\n}\n</code></pre>\n\n<p>Then whenever I am using <code>Exec</code> I wrap my strings that could be NULL in the DB with the <code>NewNullString</code> function.</p>\n\n<pre><code>db.Exec(`\n  insert into\n      users first_name, last_name, email\n      values (?,?,?)`,\n  firstName,\n  lastName,\n  NewNullString(email),\n)\n</code></pre>\n"}], "owner": {"reputation": 3240, "user_id": 2694306, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/a36c65851474c1cca6200426379fd82f?s=128&d=identicon&r=PG&f=1", "display_name": "user2694306", "link": "https://stackoverflow.com/users/2694306/user2694306"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21415, "favorite_count": 7, "accepted_answer_id": 40268372, "answer_count": 2, "score": 32, "last_activity_date": 1477502105, "creation_date": 1477496648, "question_id": 40266633, "link": "https://stackoverflow.com/questions/40266633/golang-insert-null-into-sql-instead-of-empty-string", "title": "Golang Insert NULL into sql instead of empty string", "body": "<p>I'm trying to insert data into a mysql database using golang. In the case where my value takes on an empty string, I would want to insert a null. How can I adjust the following to insert nulls instead of empty string? Thanks.</p>\n\n<pre><code>_, err := m.Db.Exec(`INSERT INTO \n                         visitor_events\n                         (type, \n                          info, \n                          url_path, \n                          visitor_id, \n                          created_at, \n                          domain)\n                          VALUES\n                          (?, ?, ?, ?, ?, ?)`,\n                          m.SaveEventType(ve), ve.EventInfo, m.SaveURLPath(ve.UrlPath), ve.VisitorId, time.Now().UTC(), ve.Domain)\n</code></pre>\n"}, {"tags": ["go", "reflection"], "answers": [{"comments": [{"owner": {"reputation": 472, "user_id": 2064183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9d0065dda5ffd11d5c0f516fc2bce5?s=128&d=identicon&r=PG", "display_name": "Kyaw Myint Thein", "link": "https://stackoverflow.com/users/2064183/kyaw-myint-thein"}, "edited": false, "score": 0, "creation_date": 1477552493, "post_id": 40267397, "comment_id": 67815493, "body": "In this case, I think we can use bt := fmt.Sprintf(&quot;%s&quot;,ts.Type), I am not sure which one is better."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 472, "user_id": 2064183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9d0065dda5ffd11d5c0f516fc2bce5?s=128&d=identicon&r=PG", "display_name": "Kyaw Myint Thein", "link": "https://stackoverflow.com/users/2064183/kyaw-myint-thein"}, "edited": false, "score": 1, "creation_date": 1477580150, "post_id": 40267397, "comment_id": 67834023, "body": "It&#39;s usually better to use methods and fields to inspect the AST than whatever fmt.Sprintf prints out."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 3, "last_activity_date": 1477499455, "last_edit_date": 1477499455, "creation_date": 1477498829, "answer_id": 40267397, "question_id": 40266003, "link": "https://stackoverflow.com/questions/40266003/how-to-assert-ast-typespec-to-int-type-in-golang/40267397#40267397", "title": "How to assert ast.TypeSpec to int type in Golang?", "body": "<p>The types in the AST represent the syntax used to declare the type and not the actual type. For example:</p>\n\n<pre><code>type t struct { }\n\nvar a int          // TypeSpec.Type is *ast.Ident\nvar b struct { }   // TypeSpec.Type is *ast.StructType\nvar c t            // TypeSpec.Type is *ast.Ident, but c variable is a struct type\n</code></pre>\n\n<p>I find it's helpful to print example ASTs when trying to understand how different syntax is represented. <a href=\"https://play.golang.org/p/Hof55EHNsu\" rel=\"nofollow\">Run this program to see an example</a>.</p>\n\n<p>This code will check for ints in most cases, but does not do so reliably:</p>\n\n<pre><code>if id, ok := ts.Type.(*ast.Ident); ok {\n    if id.Name == \"int\" {\n        // it might be an int\n    }\n}\n</code></pre>\n\n<p>The code is not correct for the following cases:</p>\n\n<pre><code>type myint int\nvar a myint          // the underlying type of a is int, but it's not declared as int\n\ntype int anotherType \nvar b int            // b is anotherType, not the predeclared int type\n</code></pre>\n\n<p>To reliably find the actual types in the source, use the <a href=\"https://godoc.org/go/types\" rel=\"nofollow\">go/types</a> package.  <a href=\"https://github.com/golang/example/tree/master/gotypes\" rel=\"nofollow\">A tutorial on the package is available</a>.</p>\n"}], "owner": {"reputation": 472, "user_id": 2064183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9d0065dda5ffd11d5c0f516fc2bce5?s=128&d=identicon&r=PG", "display_name": "Kyaw Myint Thein", "link": "https://stackoverflow.com/users/2064183/kyaw-myint-thein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1477499455, "creation_date": 1477494816, "last_edit_date": 1477494853, "question_id": 40266003, "link": "https://stackoverflow.com/questions/40266003/how-to-assert-ast-typespec-to-int-type-in-golang", "title": "How to assert ast.TypeSpec to int type in Golang?", "body": "<p>I have following code for Golang docs parsing. \"ts\" is ast.TypeSpec. I can check StructType and etc. But, ts.Type is \"int\". How can I assert for int and other basic type?</p>\n\n<pre><code>ts, ok := d.Decl.(*ast.TypeSpec)\nswitch ts.Type.(type) {\ncase *ast.StructType:\n    fmt.Println(\"StructType\")\ncase *ast.ArrayType:\n    fmt.Println(\"ArrayType\")\ncase *ast.InterfaceType:\n    fmt.Println(\"InterfaceType\")\ncase *ast.MapType:\n    fmt.Println(\"MapType\")\n}\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 2, "creation_date": 1477492906, "post_id": 40265190, "comment_id": 67790894, "body": "<a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow noreferrer\"><code>*json.RawMessage</code></a>"}, {"owner": {"reputation": 4293, "user_id": 4069913, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100007329305829/picture?type=large", "display_name": "Orest Savchak", "link": "https://stackoverflow.com/users/4069913/orest-savchak"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1477492982, "post_id": 40265190, "comment_id": 67790957, "body": "@thwd would it parse json object, or string only?"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1477493035, "post_id": 40265190, "comment_id": 67791001, "body": "It will treat the JSON value as an opaque slice of bytes i.e. not parse it."}, {"owner": {"reputation": 4293, "user_id": 4069913, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100007329305829/picture?type=large", "display_name": "Orest Savchak", "link": "https://stackoverflow.com/users/4069913/orest-savchak"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1477493720, "post_id": 40265190, "comment_id": 67791555, "body": "@thwd looks like it does a job, thanks!"}], "owner": {"reputation": 4293, "user_id": 4069913, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100007329305829/picture?type=large", "display_name": "Orest Savchak", "link": "https://stackoverflow.com/users/4069913/orest-savchak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1477493038, "creation_date": 1477492658, "last_edit_date": 1477493038, "question_id": 40265190, "link": "https://stackoverflow.com/questions/40265190/ffjson-semi-stream-parsing", "title": "FFJSON semi-stream parsing", "body": "<p>I'm newbie to Golang, and we have problem with JSON parsing.\nWe have structure like that:</p>\n\n<pre><code>{\n method : \"get\",\n endpoint : \"users\",\n data : {\n   key1 : \"val1\",\n   key2 : \"val2\",\n   ... \n }\n}\n</code></pre>\n\n<p>And out data value can be very large, so default library produce a lot of garbage during parsing.\nOur goal is to parse generic JSON, and send data to endpoint, so we don't need to parse it.\nI can not find out how to do it correct in ffjson, how should by struct be described?</p>\n\n<pre><code>type struct Entity {\n   Endpoint string\n   Method string\n   Data ???\n}\n</code></pre>\n"}, {"tags": ["go", "buffer-overflow"], "answers": [{"comments": [{"owner": {"reputation": 409, "user_id": 3661748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc0e02aa0793fbb31142e13e2bfb5fc9?s=128&d=identicon&r=PG&f=1", "display_name": "cody.tv.weber", "link": "https://stackoverflow.com/users/3661748/cody-tv-weber"}, "edited": false, "score": 0, "creation_date": 1520366911, "post_id": 40263029, "comment_id": 85283426, "body": "Do you have a source for this?"}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "reply_to_user": {"reputation": 409, "user_id": 3661748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc0e02aa0793fbb31142e13e2bfb5fc9?s=128&d=identicon&r=PG&f=1", "display_name": "cody.tv.weber", "link": "https://stackoverflow.com/users/3661748/cody-tv-weber"}, "edited": false, "score": 2, "creation_date": 1520374127, "post_id": 40263029, "comment_id": 85286982, "body": "@codemon2002 It is defined in the linked language specification."}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 12, "last_activity_date": 1520374089, "last_edit_date": 1520374089, "creation_date": 1477486900, "answer_id": 40263029, "question_id": 40262971, "link": "https://stackoverflow.com/questions/40262971/is-go-vulnerable-for-buffer-overflow/40263029#40263029", "title": "Is Go vulnerable for buffer overflow", "body": "<p><a href=\"https://golang.org/ref/spec#Index_expressions\" rel=\"noreferrer\">Go checks for bounds in strings, arrays and slices</a> so it is not vulnerable as long as you are not playing around with <a href=\"https://golang.org/pkg/unsafe/\" rel=\"noreferrer\">unsafe</a> package.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 7075185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba1e4df09f1ba75e39d6b3d24efffcaf?s=128&d=identicon&r=PG&f=1", "display_name": "Rowern", "link": "https://stackoverflow.com/users/7075185/rowern"}, "is_accepted": false, "score": 3, "last_activity_date": 1477487204, "creation_date": 1477487204, "answer_id": 40263134, "question_id": 40262971, "link": "https://stackoverflow.com/questions/40262971/is-go-vulnerable-for-buffer-overflow/40263134#40263134", "title": "Is Go vulnerable for buffer overflow", "body": "<p>After a quick search I found this link: <a href=\"http://0xdabbad00.com/2015/04/12/looking_for_security_trouble_spots_in_go_code/\" rel=\"nofollow\">http://0xdabbad00.com/2015/04/12/looking_for_security_trouble_spots_in_go_code/</a></p>\n\n<p>It states that golang is safe from most \"known\" attacks (\"known\" as in used in C). For instance, the fact that there is no pointer arithmetics, no manual memory management make it less prone to errors that would lead to \"exploitable\" code.</p>\n\n<p>I'm no expert of golang but it seems like a well thought language with a good environment (std lib, compiler, etc...)</p>\n"}], "owner": {"reputation": 2809, "user_id": 6720987, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0TSHr.png?s=128&g=1", "display_name": "Jan-Fokke", "link": "https://stackoverflow.com/users/6720987/jan-fokke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6740, "favorite_count": 0, "accepted_answer_id": 40263029, "answer_count": 2, "score": 9, "last_activity_date": 1520374089, "creation_date": 1477486722, "last_edit_date": 1477486811, "question_id": 40262971, "link": "https://stackoverflow.com/questions/40262971/is-go-vulnerable-for-buffer-overflow", "title": "Is Go vulnerable for buffer overflow", "body": "<p>I know languages like c# aren't vulnerable to buffer overflows unless you marshal or use unsafe code. But is go vulnerable for buffer overflows?</p>\n"}, {"tags": ["datetime", "go", "time"], "answers": [{"comments": [{"owner": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "edited": false, "score": 0, "creation_date": 1477480481, "post_id": 40260666, "comment_id": 67782153, "body": "Okay, Thanks for the quick answer. I did it:  <code>var duration time.Duration = trip.EndTime.Sub(trip.StartTime) </code>fmt.Println(&quot;Time difference: Minutes&quot;, duration.Minutes(), &quot;Seconds: &quot;, duration.Seconds())  But this does not seem to be giving the right numbers."}, {"owner": {"reputation": 3058, "user_id": 2776473, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/JvVL6.jpg?s=128&g=1", "display_name": "Shmulik Klein", "link": "https://stackoverflow.com/users/2776473/shmulik-klein"}, "reply_to_user": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "edited": false, "score": 0, "creation_date": 1477480831, "post_id": 40260666, "comment_id": 67782376, "body": "What is <code>trip.EndTime\\StartTime</code> ?"}, {"owner": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "edited": false, "score": 0, "creation_date": 1477480914, "post_id": 40260666, "comment_id": 67782421, "body": "Sorry! Think of it as:  t1 = trip.StartTime t2 = trip.EndTime"}, {"owner": {"reputation": 3058, "user_id": 2776473, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/JvVL6.jpg?s=128&g=1", "display_name": "Shmulik Klein", "link": "https://stackoverflow.com/users/2776473/shmulik-klein"}, "reply_to_user": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "edited": false, "score": 0, "creation_date": 1477481174, "post_id": 40260666, "comment_id": 67782600, "body": "It is OK, but how does it implemented ?"}, {"owner": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "edited": false, "score": 0, "creation_date": 1477481274, "post_id": 40260666, "comment_id": 67782667, "body": "Implemented what? I did not write anything else than above two lines for the duration."}, {"owner": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "edited": false, "score": 0, "creation_date": 1477482194, "post_id": 40260666, "comment_id": 67783215, "body": "As I said, think of trip.Starttime and trip.EndTime as t1 and t2 respectively."}, {"owner": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "edited": false, "score": 0, "creation_date": 1477482227, "post_id": 40260666, "comment_id": 67783224, "body": "Alright. Thanks for the edit. In your code, in case I need to get only hours/minutes, then?"}, {"owner": {"reputation": 3058, "user_id": 2776473, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/JvVL6.jpg?s=128&g=1", "display_name": "Shmulik Klein", "link": "https://stackoverflow.com/users/2776473/shmulik-klein"}, "reply_to_user": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "edited": false, "score": 0, "creation_date": 1477482699, "post_id": 40260666, "comment_id": 67783491, "body": "Then just use <code>fmt.Printf(&quot;The hours difference is: %d&quot;, t1.Sub(t2).Hours())</code> or <code>fmt.Printf(&quot;The minutes difference is: %d&quot;, t1.Sub(t2).Minutes())</code>"}], "tags": [], "owner": {"reputation": 3058, "user_id": 2776473, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/JvVL6.jpg?s=128&g=1", "display_name": "Shmulik Klein", "link": "https://stackoverflow.com/users/2776473/shmulik-klein"}, "is_accepted": false, "score": 10, "last_activity_date": 1477482687, "last_edit_date": 1477482687, "creation_date": 1477479964, "answer_id": 40260666, "question_id": 40260599, "link": "https://stackoverflow.com/questions/40260599/difference-between-two-time-time-objects/40260666#40260666", "title": "Difference between two time.Time objects", "body": "<p>Actually, the <code>time</code> package's documentation does discuss it:</p>\n\n<p><a href=\"https://godoc.org/time#Time.Sub\" rel=\"noreferrer\">https://godoc.org/time#Time.Sub</a></p>\n\n<p><a href=\"https://godoc.org/time#Duration.Hours\" rel=\"noreferrer\">https://godoc.org/time#Duration.Hours</a></p>\n\n<p>You should produce a <code>Duration</code> object using <code>Sub()</code> and then use one of the <code>Seconds()</code>, <code>Minutes()</code>, <code>Hours()</code>.</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"time\"\n)\n\nfunc main() {\n        t1 := time.Date(1984, time.November, 3, 13, 0, 0, 0, time.UTC)\n        t2 := time.Date(1984, time.November, 3, 10, 0, 0, 0, time.UTC)\n        fmt.Printf(\"The hours diffrence is: %d\", t1.Sub(t2).Hours())\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "edited": false, "score": 0, "creation_date": 1477481285, "post_id": 40260853, "comment_id": 67782677, "body": "Bang on! Thank you."}, {"owner": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "edited": false, "score": 0, "creation_date": 1477482169, "post_id": 40260853, "comment_id": 67783204, "body": "How about if I say I need only hours or minutes?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "edited": false, "score": 0, "creation_date": 1477484551, "post_id": 40260853, "comment_id": 67784704, "body": "@HemantBhargava Then use a different layout string, one that only contains hours and minutes: <code>out.Format(&quot;15:04&quot;)</code>"}, {"owner": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "edited": false, "score": 0, "creation_date": 1477564754, "post_id": 40260853, "comment_id": 67823069, "body": "This is not working.  <code>t1 := time.Now() </code>t2 := t1.Add(time.Second * 34100)  <code>diff := t2.Sub(t1) </code>fmt.Println(diff.Minutes())  out := time.Time{}.Add(diff) fmt.Println(out.Format(&quot;15:30&quot;))   This outputs : 568.3333333333334 09:90  Which is not correct."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "edited": false, "score": 0, "creation_date": 1477576308, "post_id": 40260853, "comment_id": 67831127, "body": "@HemantBhargava Yes of course because <code>&quot;15:30&quot;</code> is an invalid layout string. Please take the time and read the doc at <a href=\"https://golang.org/pkg/time/#Time.Format\" rel=\"nofollow noreferrer\"><code>Time.Format()</code></a> to know what the layout string is. Using <code>out.Format(&quot;15:04:05&quot;)</code> outputs <code>09:28:20</code> which is correct. If you only need hour+min, then use <code>out.Format(&quot;15:04&quot;)</code> which outputs <code>09:28</code>, as you can see this on the <a href=\"https://play.golang.org/p/mEEpMNNt6P\" rel=\"nofollow noreferrer\">Go Playground</a>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 79, "last_activity_date": 1477480496, "last_edit_date": 1495539988, "creation_date": 1477480496, "answer_id": 40260853, "question_id": 40260599, "link": "https://stackoverflow.com/questions/40260599/difference-between-two-time-time-objects/40260853#40260853", "title": "Difference between two time.Time objects", "body": "<p>You may use <a href=\"https://golang.org/pkg/time/#Time.Sub\" rel=\"noreferrer\"><code>Time.Sub()</code></a> to get the difference between the 2 <a href=\"https://golang.org/pkg/time/#Time\" rel=\"noreferrer\"><code>time.Time</code></a> values, result will be a value of <a href=\"https://golang.org/pkg/time/#Duration\" rel=\"noreferrer\"><code>time.Duration</code></a>.</p>\n\n<p>When printed, a <code>time.Duration</code> formats itself \"intelligently\":</p>\n\n<pre><code>t1 := time.Now()\nt2 := t1.Add(time.Second * 341)\n\nfmt.Println(t1)\nfmt.Println(t2)\n\ndiff := t2.Sub(t1)\nfmt.Println(diff)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2009-11-10 23:00:00 +0000 UTC\n2009-11-10 23:05:41 +0000 UTC\n5m41s\n</code></pre>\n\n<p>If you want the time format <code>HH:mm:ss</code>, you may constuct a <code>time.Time</code> value and use its <a href=\"https://golang.org/pkg/time/#Time.Format\" rel=\"noreferrer\"><code>Time.Format()</code></a> method like this:</p>\n\n<pre><code>out := time.Time{}.Add(diff)\nfmt.Println(out.Format(\"15:04:05\"))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>00:05:41\n</code></pre>\n\n<p>Try the examples on the <a href=\"https://play.golang.org/p/7Uyk__vH2j\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p>Of course this will only work if the time difference is less than a day. If the difference may be bigger, then it's another story. The result must include days, months and years. Complexity increases significnatly. See this question for details:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/36530251/golang-time-since-with-months-and-years/36531443#36531443\">golang time.Since() with months and years</a></p>\n\n<p>The solution presented there solves this issue by showing a function with signature:</p>\n\n<pre><code>func diff(a, b time.Time) (year, month, day, hour, min, sec int)\n</code></pre>\n\n<p>You may use that even if your times are within 24 hours (in which case <code>year</code>, <code>month</code> and <code>day</code> will be <code>0</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 966, "user_id": 1834377, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0c01a667b3332390a8953ac36cc9381?s=128&d=identicon&r=PG", "display_name": "jk-kim", "link": "https://stackoverflow.com/users/1834377/jk-kim"}, "edited": false, "score": 3, "creation_date": 1508952161, "post_id": 40262557, "comment_id": 80824098, "body": "leap seconds considerations and data type consideration?  this is a $1000 answer to $10 question..."}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 3, "last_activity_date": 1477485564, "creation_date": 1477485564, "answer_id": 40262557, "question_id": 40260599, "link": "https://stackoverflow.com/questions/40260599/difference-between-two-time-time-objects/40262557#40262557", "title": "Difference between two time.Time objects", "body": "<p>To complement Shmulik Klein's answer:</p>\n\n<p>Another way to calculate disjoint hours/minutes/seconds out of a time.Duration:</p>\n\n<p><a href=\"https://play.golang.org/p/VRoXG5NxLo\" rel=\"nofollow\">https://play.golang.org/p/VRoXG5NxLo</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n    \"time\"\n)\n\nfunc main() {\n    t1 := time.Date(1984, time.November, 3, 13, 0, 0, 0, time.UTC)\n    t2 := time.Date(1984, time.November, 3, 10, 23, 34, 0, time.UTC)\n\n    hs := t1.Sub(t2).Hours()\n\n    hs, mf := math.Modf(hs)\n    ms := mf * 60\n\n    ms, sf := math.Modf(ms)\n    ss := sf * 60\n\n    fmt.Println(hs, \"hours\", ms, \"minutes\", ss, \"seconds\")\n}\n</code></pre>\n\n<blockquote>\n  <p>2 hours 36 minutes 25.999999999999375 seconds</p>\n</blockquote>\n\n<p>note:</p>\n\n<ul>\n<li>slight precision loss due to the use of the float64 type</li>\n<li>we ignore leap seconds and assume every minute has 60 seconds</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 5450, "user_id": 942317, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/SY5ID.jpg?s=128&g=1", "display_name": "STEEL", "link": "https://stackoverflow.com/users/942317/steel"}, "is_accepted": false, "score": 0, "last_activity_date": 1578654649, "creation_date": 1578654649, "answer_id": 59680522, "question_id": 40260599, "link": "https://stackoverflow.com/questions/40260599/difference-between-two-time-time-objects/59680522#59680522", "title": "Difference between two time.Time objects", "body": "<p><a href=\"https://play.golang.org/p/oRqOyaUYN0W\" rel=\"nofollow noreferrer\">DEMO</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>\npackage main\n\nimport (\n    \"fmt\"\n    \"math\"\n    \"time\"\n)\n\nfunc TimeAsString(dt float64) string {\n    time := dt\n    hours := math.Floor(time / 3600)\n    minutes := math.Ceil(math.Mod(time, 3600)/60) - 1\n    seconds := int(time) % 60\n    return fmt.Sprintf(\"%v:%v:%v\", hours, minutes, seconds)\n}\n\nfunc main() {\n    mytime := 0.0\n    last := time.Now()\n\n    tick := time.Tick(33 * time.Millisecond)\n    for {\n\n        select {\n        case &lt;-tick:\n            dt := time.Since(last).Seconds()\n            last = time.Now()\n\n            mytime += dt\n            fmt.Println(TimeAsString(mytime))\n        }\n\n    }\n}\n\n\n\n</code></pre>\n"}], "owner": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72826, "favorite_count": 8, "accepted_answer_id": 40260853, "answer_count": 4, "score": 54, "last_activity_date": 1578654649, "creation_date": 1477479807, "question_id": 40260599, "link": "https://stackoverflow.com/questions/40260599/difference-between-two-time-time-objects", "title": "Difference between two time.Time objects", "body": "<p>Very new to the 'Go'. Question might be basic one.</p>\n\n<p>I have two time.Time objects and I want to get the difference between the two in terms of hours/minutes/seconds. Lets say:</p>\n\n<pre><code>t1 = 2016-09-09 19:09:16 +0530 IST\nt2 = 2016-09-09 19:09:16 +0530 IST\n</code></pre>\n\n<p>In above case, since the difference is 0. It should give me 00:00:00. Consider another case:</p>\n\n<pre><code>t1 = 2016-09-14 14:12:48 +0530 IST\nt2 = 2016-09-14 14:18:29 +0530 IST\n</code></pre>\n\n<p>In this case, difference would be 00:05:41. I looked at the <a href=\"https://godoc.org/time\" rel=\"noreferrer\">https://godoc.org/time</a> but could not make anything out of it.</p>\n"}, {"tags": ["go", "grpc", "protoc"], "comments": [{"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 1, "creation_date": 1477477906, "post_id": 40259551, "comment_id": 67780543, "body": "Off-hand, that sounds like &quot;you don&#39;t want to&quot;. But I guess a <code>map&lt;string,google.protobuf.Any&gt;</code> might work, maybe?"}], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "is_accepted": true, "score": 19, "last_activity_date": 1477492697, "creation_date": 1477492697, "answer_id": 40265197, "question_id": 40259551, "link": "https://stackoverflow.com/questions/40259551/create-variable-of-type-mapstringinterface-in-grpc-protoc-buffer-golang/40265197#40265197", "title": "Create variable of type Map[string]interface{} in gRPC protoc buffer golang", "body": "<p>proto3 has type <code>Any</code></p>\n\n<pre><code>import \"google/protobuf/any.proto\";\n\nmessage ErrorStatus {\n  string message = 1;\n  repeated google.protobuf.Any details = 2;\n}\n</code></pre>\n\n<p>but if you look at its implementation, it is simply as</p>\n\n<pre><code>message Any {\n  string type_url = 1;\n  bytes value = 2;\n}\n</code></pre>\n\n<p>You have to define such a message yourself by possibly using reflection and an intermediate type. </p>\n\n<p>See <a href=\"https://github.com/logrusorgru/gopb3any\" rel=\"noreferrer\">example application</a></p>\n\n<p><a href=\"https://github.com/golang/protobuf/issues/60\" rel=\"noreferrer\">https://github.com/golang/protobuf/issues/60</a></p>\n"}, {"tags": [], "owner": {"reputation": 749, "user_id": 76199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d38343994d650e09acf2861e4b5db41a?s=128&d=identicon&r=PG", "display_name": "ptone", "link": "https://stackoverflow.com/users/76199/ptone"}, "is_accepted": false, "score": 1, "last_activity_date": 1499120078, "creation_date": 1499120078, "answer_id": 44894480, "question_id": 40259551, "link": "https://stackoverflow.com/questions/40259551/create-variable-of-type-mapstringinterface-in-grpc-protoc-buffer-golang/44894480#44894480", "title": "Create variable of type Map[string]interface{} in gRPC protoc buffer golang", "body": "<p>While it gets a little verbose to deal with, the \"struct\" type in protocol buffers is probably closer to golang's map[string]interface{} </p>\n\n<p>But like interface{}  will take some reflection-style overhead to determine what the actual stored type is.</p>\n\n<p>for example see comment here: <a href=\"https://github.com/golang/protobuf/issues/370\" rel=\"nofollow noreferrer\">https://github.com/golang/protobuf/issues/370</a></p>\n"}, {"tags": [], "owner": {"reputation": 488, "user_id": 5789008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84df850bc871c873225d0da16b5045bf?s=128&d=identicon&r=PG&f=1", "display_name": "F. Norbert", "link": "https://stackoverflow.com/users/5789008/f-norbert"}, "is_accepted": false, "score": 1, "last_activity_date": 1606412265, "creation_date": 1606412265, "answer_id": 65026894, "question_id": 40259551, "link": "https://stackoverflow.com/questions/40259551/create-variable-of-type-mapstringinterface-in-grpc-protoc-buffer-golang/65026894#65026894", "title": "Create variable of type Map[string]interface{} in gRPC protoc buffer golang", "body": "<p>I <a href=\"https://stackoverflow.com/a/65026774/5789008\">wrote</a> a longer post about how to use <code>google.protobuf.Struct</code> to work with arbitrary JSON input. The <code>structpb</code> package capable to produce a <code>map[string]interface{}</code> from a <code>structpb.Struct</code> via its <code>AsMap()</code> function.</p>\n<p>Official documentation: <a href=\"https://pkg.go.dev/google.golang.org/protobuf/types/known/structpb\" rel=\"nofollow noreferrer\">https://pkg.go.dev/google.golang.org/protobuf/types/known/structpb</a></p>\n"}], "owner": {"reputation": 295, "user_id": 3009171, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8d702f72b002b8b3656bd20ecba6d53b?s=128&d=identicon&r=PG&f=1", "display_name": "Radhika.S", "link": "https://stackoverflow.com/users/3009171/radhika-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18479, "favorite_count": 4, "accepted_answer_id": 40265197, "answer_count": 3, "score": 16, "last_activity_date": 1606412265, "creation_date": 1477476974, "question_id": 40259551, "link": "https://stackoverflow.com/questions/40259551/create-variable-of-type-mapstringinterface-in-grpc-protoc-buffer-golang", "title": "Create variable of type Map[string]interface{} in gRPC protoc buffer golang", "body": "<p>I'm using grpc golang to communicate between client and server application.\nBelow is the code for protoc buffer.</p>\n\n<pre><code>syntax = \"proto3\";\npackage Trail;\n\nservice TrailFunc {\n  rpc HelloWorld (Request) returns (Reply) {}\n}\n\n// The request message containing the user's name.\nmessage Request {\n  map&lt;string,string&gt; inputVar = 1;\n}\n// The response message containing the greetings\nmessage Reply {\n  string outputVar = 1;\n}\n</code></pre>\n\n<p>I need to create a field inputVar of type map[string]interface{} inside message data structure instead of map[string]string.\nHow can I achieve it?\nThanks in advance.</p>\n"}, {"tags": ["mongodb", "go", "aggregation-framework", "mgo"], "comments": [{"owner": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "edited": false, "score": 0, "creation_date": 1477523985, "post_id": 40259171, "comment_id": 67806959, "body": "Just split each stage and use<code>bson.M{}</code> to wrap around each nest level of your query with quotation marks, something like: <code>match := bson.M{&quot;$match&quot;: bson.M{&quot;userId&quot;: &quot;...&quot;, ...}}</code>, then <code>project := bson.M{&quot;$project&quot;...}</code>. Now use mgo driver <code>Pipe</code> with those, like <code>pipe := collection.Pipe([]bson.M{match, project})</code>, and finally retrieve the result with <code>pipe.All(&amp;yourResultStruct)</code>. Read their docs of <code>Pipe</code> <a href=\"https://godoc.org/labix.org/v2/mgo#Collection.Pipe\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1478065315, "post_id": 40373000, "comment_id": 67999273, "body": "Thank you for the detailed answer. Yes, you got it right about not me not being able to correctly translate the various parts in the aggregation query. Kudos!"}, {"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1478069221, "post_id": 40373000, "comment_id": 68000676, "body": "I needed to make a minor correction in the query on the lines of this - <a href=\"http://stackoverflow.com/questions/27686914/behaviour-of-the-project-stage-operator-in-projecting-arrays\" title=\"behaviour of the project stage operator in projecting arrays\">stackoverflow.com/questions/27686914/&hellip;</a> in order to make it work in my case. In stage_project, the &#39;weight&#39; parameter needs to be defined as &quot;weight&quot;: bson.M{&quot;$literal&quot;: condition_weight}"}, {"owner": {"reputation": 343, "user_id": 8411263, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nLuEd7kVkpA/AAAAAAAAAAI/AAAAAAAAACI/XGfe0AyH8n8/photo.jpg?sz=128", "display_name": "Manouchehr Rasouli", "link": "https://stackoverflow.com/users/8411263/manouchehr-rasouli"}, "edited": false, "score": 0, "creation_date": 1587452907, "post_id": 40373000, "comment_id": 108509365, "body": "thanks for answer that&#39;s a good practice to write illustrated aggregation query"}], "tags": [], "owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "is_accepted": true, "score": 7, "last_activity_date": 1478064250, "creation_date": 1478064250, "answer_id": 40373000, "question_id": 40259171, "link": "https://stackoverflow.com/questions/40259171/mongo-aggregation-query-with-mgo-driver/40373000#40373000", "title": "mongo aggregation query with mgo driver", "body": "<p>The examples on the docs would be sufficient to get started. However, if you are not familiar with golang, the <code>$cond</code> part could be a bit tricky. See below example code:</p>\n\n\n\n<pre><code>    collection := session.DB(\"dbName\").C(\"devices\")\n\n    stage_match := bson.M{\"$match\":bson.M{\"userId\":\"v73TuQqZykbxFXsWo\", \"state\": true}}\n\n    condition_weight := []interface{}{bson.M{\"$or\": []bson.M{\n                       bson.M{\"$eq\": []string{\"$categorySlug\", \"air_fryer\"}},\n                       bson.M{\"$eq\": []string{\"$categorySlug\", \"iron\"}},\n    }}, 0, 1}\n\n    stage_project:= bson.M{\"$project\": bson.M{\"userId\":1, \"categorySlug\":1, \"weight\": condition_weight}}\n\n    stage_sort := bson.M{\"$sort\": bson.M{\"weight\":1}}\n\n    stage_limit := bson.M{\"$limit\": 10}\n\n    pipe := collection.Pipe([]bson.M{stage_match, stage_project, stage_sort, stage_limit})\n</code></pre>\n\n<p>See also <a href=\"https://godoc.org/gopkg.in/mgo.v2#Pipe\" rel=\"noreferrer\">mgo: type Pipe</a></p>\n"}], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5519, "favorite_count": 0, "accepted_answer_id": 40373000, "answer_count": 1, "score": 4, "last_activity_date": 1614257999, "creation_date": 1477475895, "last_edit_date": 1614257999, "question_id": 40259171, "link": "https://stackoverflow.com/questions/40259171/mongo-aggregation-query-with-mgo-driver", "title": "mongo aggregation query with mgo driver", "body": "<p>I have the following query in mongodb:</p>\n<pre><code>db.devices.aggregate({\n$match: {userId: &quot;v73TuQqZykbxFXsWo&quot;, state: true}},\n{\n  $project: {\n    userId: 1,\n    categorySlug: 1,\n    weight: { \n      $cond: [ \n        {&quot;$or&quot;: [  \n          {$eq: [&quot;$categorySlug&quot;, &quot;air_fryer&quot;] }, \n          {$eq: [&quot;$categorySlug&quot;, &quot;iron&quot;] } \n        ] }, \n      0, 1] } \n    } },  \n    {$sort: {weight: 1}},\n    { $limit : 10 }\n);\n</code></pre>\n<p>I'm trying to write this in Go using the mgo driver but not able to wrap my head around this at all!</p>\n<p>How do I translate this to a Go mgo query?</p>\n"}, {"tags": ["post", "go", "params", "revel"], "answers": [{"comments": [{"owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "edited": false, "score": 0, "creation_date": 1477475743, "post_id": 40258788, "comment_id": 67779177, "body": "Thanks @TheHippo but I get this error: The Go code app/controllers/app.go does not compile: invalid operation: c.Controller.Params[&quot;Origin&quot;] (type *revel.Params does not support indexing)"}, {"owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "reply_to_user": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "edited": false, "score": 0, "creation_date": 1477485422, "post_id": 40258788, "comment_id": 67785302, "body": "@EloyFern&#225;ndezFranco you are right. There is another way around this. Edited my answer."}, {"owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "edited": false, "score": 0, "creation_date": 1477558472, "post_id": 40258788, "comment_id": 67819124, "body": "Thanks again @TheHippo Yes... your edited code works... now the question is what way is better (faster, secure...)?? A calling to a function (c.Params.Get(&quot;Origin&quot;)) or the inspection and indexing of an &quot;object&quot; (c.Request.Form[&quot;Origin&quot;][0])..."}, {"owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "reply_to_user": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "edited": false, "score": 0, "creation_date": 1477563987, "post_id": 40258788, "comment_id": 67822603, "body": "@EloyFern&#225;ndezFranco There shouldn&#39;t be any significant difference regarding speed. Without checking I would say my version is more secure, because, there will be some checking if a value with that name actually exists, instead of blindly accessing a map and assuming that there is any slice within."}, {"owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "edited": false, "score": 0, "creation_date": 1477564121, "post_id": 40258788, "comment_id": 67822679, "body": "Ok!! In this case, I&#39;ll use yours. Thanks @TheHippo"}], "tags": [], "owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "is_accepted": true, "score": 0, "last_activity_date": 1477485381, "last_edit_date": 1477485381, "creation_date": 1477474890, "answer_id": 40258788, "question_id": 40258729, "link": "https://stackoverflow.com/questions/40258729/how-to-get-the-post-params-in-revel-golang/40258788#40258788", "title": "How to get the POST params in revel golang", "body": "<p>It's all just a simple map and all values are in an slice. To get the <code>Origin</code> value from the request:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>c.Params[\"Origin\"][0]\n</code></pre>\n\n<p><strong>EDIT:</strong> The above does not work, but this should:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>c.Params.Get(\"Origin\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "is_accepted": false, "score": -1, "last_activity_date": 1477561283, "last_edit_date": 1477561283, "creation_date": 1477477730, "answer_id": 40259826, "question_id": 40258729, "link": "https://stackoverflow.com/questions/40258729/how-to-get-the-post-params-in-revel-golang/40259826#40259826", "title": "How to get the POST params in revel golang", "body": "<p>Finally I find an answer, I don't know if it is the best way. After follow step by step <a href=\"https://revel.github.io/docs/src/params.html\" rel=\"nofollow\">this post</a>, I find the solution:</p>\n\n<pre><code> fmt.Println(c.Request.Form[\"Origin\"][0])\n</code></pre>\n\n<p>The output is LHR.</p>\n"}, {"tags": [], "owner": {"reputation": 1986, "user_id": 422131, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d46192872b1cab3ef46da47bdd56e12?s=128&d=identicon&r=PG", "display_name": "CppNoob", "link": "https://stackoverflow.com/users/422131/cppnoob"}, "is_accepted": false, "score": 0, "last_activity_date": 1516352960, "creation_date": 1516352960, "answer_id": 48337541, "question_id": 40258729, "link": "https://stackoverflow.com/questions/40258729/how-to-get-the-post-params-in-revel-golang/48337541#48337541", "title": "How to get the POST params in revel golang", "body": "<p>It depends on whether the <code>Content-Type</code> in your request is set to <code>application/json</code> / <code>text/json</code>. If so, you will need to explicitly convert it to a map:</p>\n\n<pre><code>var j map[string]interface{}\nc.Params.BindJSON(&amp;j)\norigin := j[\"Origin\"] // etc.\n</code></pre>\n\n<p>Otherwise this should work:</p>\n\n<pre><code>origin := c.Params.Form[\"Origin\"]\n</code></pre>\n"}], "owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1455, "favorite_count": 0, "accepted_answer_id": 40258788, "answer_count": 3, "score": 2, "last_activity_date": 1516352960, "creation_date": 1477474718, "question_id": 40258729, "link": "https://stackoverflow.com/questions/40258729/how-to-get-the-post-params-in-revel-golang", "title": "How to get the POST params in revel golang", "body": "<p>How can I get the parameters on a POST request in revel?? I have this:  </p>\n\n<pre><code>func (c App) Ndc() revel.Result {\n    fmt.Println(c.Params)\n    //more simple code to return a json...\n}\n</code></pre>\n\n<p>I have tested many things but nothing works, so I prefer let the code cleaner as possible. This is the output:</p>\n\n<pre><code>&amp;{map[Origin:[LHR] Destination:[DME] DepartureDate:[2016-10-31] ArrivalDate:[]] map[] map[] map[] map[Origin:[LHR] Destination:[DME] DepartureDate:[2016-10-31] ArrivalDate:[]] map[] []}\n</code></pre>\n\n<p>The content is good, but... how can I get one by one these variables and their values??<br>\nThank you.</p>\n"}, {"tags": ["javascript", "arrays", "mongodb", "go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "is_accepted": true, "score": 1, "last_activity_date": 1477476503, "creation_date": 1477476503, "answer_id": 40259380, "question_id": 40256945, "link": "https://stackoverflow.com/questions/40256945/issue-in-mongo-query-with-multiple-conditions-by-using-golang/40259380#40259380", "title": "Issue in mongo query with multiple conditions by using golang", "body": "<p>I was able to achieve this by constructing the <code>$and</code> part separately -</p>\n\n<pre><code>var AndQuery []map[string]interface{}\nfor i := 0; i &lt; len(body.Properties); i++ {\n    log.Println(body.Properties[i])\n    currentCondition := bson.M{\"properties\": bson.M{\"$elemMatch\": bson.M{\"propertyName\": body.Properties[i].PropertyName, \"propertyValue\": body.Properties[i].PropertyValue}}}\n    AndQuery = append(AndQuery, currentCondition)\n}\n</code></pre>\n\n<p>and then my query looked like -</p>\n\n<pre><code>c.Find(bson.M{\"brandId\": body.BrandID, \"category\": body.Category, \"$and\": AndQuery})\n</code></pre>\n"}], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2263, "favorite_count": 0, "accepted_answer_id": 40259380, "answer_count": 1, "score": 1, "last_activity_date": 1477476503, "creation_date": 1477469389, "last_edit_date": 1477476191, "question_id": 40256945, "link": "https://stackoverflow.com/questions/40256945/issue-in-mongo-query-with-multiple-conditions-by-using-golang", "title": "Issue in mongo query with multiple conditions by using golang", "body": "<p>I have a document as follows -</p>\n\n<pre><code>{ \n    \"_id\" : \"580eef0e4dcc220df897a9cb\", \n    \"brandId\" : 15, \n    \"category\" : \"air_conditioner\", \n    \"properties\" : [\n        {\n            \"propertyName\" : \"A123\", \n            \"propertyValue\" : \"A123 678\"\n        }, \n        {\n            \"propertyName\" : \"B123\", \n            \"propertyValue\" : \"B123 678\"\n        }, \n        {\n            \"propertyName\" : \"C123\", \n            \"propertyValue\" : \"C123 678\"\n        }\n    ]\n}\n</code></pre>\n\n<p>In this, the <code>properties</code> array can have multiple number of elements.\nWhen I perform a search via my API,\nI would ideally pass an array similar to <code>properties</code> in the body of my <code>POST</code> request -</p>\n\n<pre><code>{ \n    \"brandId\" : 15, \n    \"category\" : \"air_conditioner\", \n    \"properties\" : [\n        {\n            \"propertyName\" : \"A123\", \n            \"propertyValue\" : \"A123 678\"\n        }, \n        {\n            \"propertyName\" : \"B123\", \n            \"propertyValue\" : \"B123 678\"\n        }, \n        {\n            \"propertyName\" : \"C123\", \n            \"propertyValue\" : \"C123 678\"\n        }\n    ]\n}\n</code></pre>\n\n<p>I have a struct to receive and decode this information -</p>\n\n<pre><code>type Properties struct {\n    PropertyName  string `json:\"propertyName\" bson:\"propertyName\"`\n    PropertyValue string `json:\"propertyValue\" bson:\"propertyValue\"`\n}\n\ntype ReqInfo struct {\n    BrandID      int             `json:\"brandId\" bson:\"brandId\"`\n    Category     string          `json:\"category\" bson:\"category\"`\n    Properties   []Properties    `json:\"properties\" bson:\"properties\"`\n}\n</code></pre>\n\n<p>I can also perform a mongodb <code>$and</code> operation over the various <code>properties</code> and only when all of them match, the document is returned.\nThe problem here is that the number of elements in the <code>properties</code> array is not fixed.\nI need to be able to send just</p>\n\n<pre><code>{ \n    \"brandId\" : 15, \n    \"category\" : \"air_conditioner\", \n    \"properties\" : [\n        {\n            \"propertyName\" : \"A123\", \n            \"propertyValue\" : \"A123 678\"\n        }\n    ]\n}\n</code></pre>\n\n<p>and retrieve all the matching documents (not just one).</p>\n\n<p>I tried my hand at creating a variable size <code>bson.M</code> using a for loop depending on the size of the <code>properties</code> array being received as the input but couldn't get the right way to do it!</p>\n\n<p>How should this be approached?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 425, "user_id": 3902984, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fd4e4c3801b65345a38686f8844cf390?s=128&d=identicon&r=PG&f=1", "display_name": "Parag", "link": "https://stackoverflow.com/users/3902984/parag"}, "edited": false, "score": 0, "creation_date": 1477468311, "post_id": 40256210, "comment_id": 67774599, "body": "The clarity of your statement helped me track the issue. Many thanks!"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 18, "last_activity_date": 1477466971, "creation_date": 1477466971, "answer_id": 40256210, "question_id": 40256161, "link": "https://stackoverflow.com/questions/40256161/exported-and-unexported-fields-in-go-language/40256210#40256210", "title": "Exported and Unexported fields in Go Language", "body": "<p>In go, fields and variables that start with an Uppercase letter are \"Exported\", and are visible to other packages. Fields that start with a lowercase letter are \"unexported\", and are only visible inside their own package.</p>\n\n<p>The encoding/gob package depends on reflection to encode values, and can only see <em>exported</em> struct fields. </p>\n\n<p>In order to make things encodable, capitalize the first letter of each field name in your <code>stateNode</code> struct that you want to be saved.</p>\n"}, {"tags": [], "owner": {"reputation": 7907, "user_id": 1592008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e208220f7cb95e6854adb653663736a?s=128&d=identicon&r=PG", "display_name": "Oleg Neumyvakin", "link": "https://stackoverflow.com/users/1592008/oleg-neumyvakin"}, "is_accepted": false, "score": 6, "last_activity_date": 1477467033, "creation_date": 1477467033, "answer_id": 40256229, "question_id": 40256161, "link": "https://stackoverflow.com/questions/40256161/exported-and-unexported-fields-in-go-language/40256229#40256229", "title": "Exported and Unexported fields in Go Language", "body": "<p>Exported field it's a filed which name started with capitalized char like:</p>\n\n<pre><code>type stateNode struct {\n    ImExported string // Exported\n    butImNot string // unexported\n}\n</code></pre>\n"}], "owner": {"reputation": 425, "user_id": 3902984, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fd4e4c3801b65345a38686f8844cf390?s=128&d=identicon&r=PG&f=1", "display_name": "Parag", "link": "https://stackoverflow.com/users/3902984/parag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7718, "favorite_count": 4, "accepted_answer_id": 40256210, "answer_count": 2, "score": 5, "last_activity_date": 1477468431, "creation_date": 1477466775, "last_edit_date": 1477468431, "question_id": 40256161, "link": "https://stackoverflow.com/questions/40256161/exported-and-unexported-fields-in-go-language", "title": "Exported and Unexported fields in Go Language", "body": "<p>I have a function in Go, the return value of which I hope to encode using gob. The return value is a struct pointer. However even though I do understand what exported variables are, I am not quite sure how to get it working.</p>\n\n<p>Here is what my function is like</p>\n\n<pre><code>fun loadXYZ(root *structABC) *structABC{\n    const once = \"stateData.bin\"\n    rd, errr := ioutil.ReadFile(once)\n    if errr!=nil{\n\n        //Do some computation and store in \"root\"\n\n        buf := &amp;bytes.Buffer{}\n        errr = gob.NewEncoder(buf).Encode(root)\n        if errr != nil {\n            panic(errr)\n        }\n        errr = ioutil.WriteFile(once, buf.Bytes(), 0666)\n        if errr != nil {\n            panic(errr)\n        }\n        return root\n    }\n    var d *structABC\n    errr = gob.NewDecoder(bytes.NewReader(rd)).Decode(&amp;d)\n    if errr != nil {\n         panic(errr)\n    }\n    return d\n}\n</code></pre>\n\n<p>This is the error I get</p>\n\n<pre><code>panic: gob: type main.stateNode has no exported fields\n</code></pre>\n\n<p>I know why the error is occurring. But can someone help me solve it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1477457925, "post_id": 40254007, "comment_id": 67769914, "body": "What types of values are you trying to store?"}, {"owner": {"reputation": 425, "user_id": 3902984, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fd4e4c3801b65345a38686f8844cf390?s=128&d=identicon&r=PG&f=1", "display_name": "Parag", "link": "https://stackoverflow.com/users/3902984/parag"}, "reply_to_user": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1477458476, "post_id": 40254007, "comment_id": 67770076, "body": "key type : is an integer and value would be an array of something like &#39;&#39;map[name:1954]&#39;&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 425, "user_id": 3902984, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fd4e4c3801b65345a38686f8844cf390?s=128&d=identicon&r=PG&f=1", "display_name": "Parag", "link": "https://stackoverflow.com/users/3902984/parag"}, "edited": false, "score": 0, "creation_date": 1477460511, "post_id": 40254035, "comment_id": 67770746, "body": "Thanks. That was useful!"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 2, "last_activity_date": 1477457843, "creation_date": 1477457843, "answer_id": 40254035, "question_id": 40254007, "link": "https://stackoverflow.com/questions/40254007/go-equivalent-of-pythons-dictionary/40254035#40254035", "title": "Go equivalent of Python&#39;s Dictionary", "body": "<p>In go, the key/value collection is called a <code>map</code>. You create it with <code>myMap := map[keyType]valType{}</code></p>\n\n<p>Usually something like <code>mapA := map[string]int{}</code>. If you want to store multiple values per key, perhaps something like:</p>\n\n<p><code>mapB := map[string][]string{}</code> where each element is itself a slice of strings. You can then add members with something like:</p>\n\n<p><code>mapB[\"foo\"] = append(mapB[\"foo\"], \"fizzbuzz\")</code></p>\n\n<p>For a great read see <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow\">Go maps in action</a></p>\n"}, {"comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1477459646, "post_id": 40254293, "comment_id": 67770438, "body": "You raise a good point. I wonder if by &quot;multiple values&quot; he means &quot;multiple fields&quot; and a <code>map[int]*Thing</code> would suffice."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1477459698, "post_id": 40254293, "comment_id": 67770459, "body": "nvm. read comment again. looks like he probably wants a slice of structs. maybe."}, {"owner": {"reputation": 425, "user_id": 3902984, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fd4e4c3801b65345a38686f8844cf390?s=128&d=identicon&r=PG&f=1", "display_name": "Parag", "link": "https://stackoverflow.com/users/3902984/parag"}, "edited": false, "score": 0, "creation_date": 1477460161, "post_id": 40254293, "comment_id": 67770625, "body": "Thanks. I am working on legacy data which is in a pretty bad shape. So what I am trying to do here is something like : myMap[100]={map[&quot;john&quot;:42],map[&quot;Alice&quot;:32],map[&quot;Fred&quot;:19]}. It&#39;s weird the way in which I have to deal with this data."}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1477460429, "post_id": 40254293, "comment_id": 67770710, "body": "A <code>map</code> doesn&#39;t really make sense as your value since you won&#39;t ever know the keys and will need to iterate the key, value pair even though there is only a single entry.  A struct makes much more sense here."}, {"owner": {"reputation": 425, "user_id": 3902984, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fd4e4c3801b65345a38686f8844cf390?s=128&d=identicon&r=PG&f=1", "display_name": "Parag", "link": "https://stackoverflow.com/users/3902984/parag"}, "edited": false, "score": 0, "creation_date": 1477460489, "post_id": 40254293, "comment_id": 67770735, "body": "The &#39;map[    ]&#39;  thing is creating hurdles for me to access data like John:42. Any means by which I can make life better for myself? It would be ideal if I can do something like &#39; Does John belong to myMap[100]&#39;?"}, {"owner": {"reputation": 425, "user_id": 3902984, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fd4e4c3801b65345a38686f8844cf390?s=128&d=identicon&r=PG&f=1", "display_name": "Parag", "link": "https://stackoverflow.com/users/3902984/parag"}, "edited": false, "score": 0, "creation_date": 1477461666, "post_id": 40254293, "comment_id": 67771206, "body": "Thank you all! @sberry Yes I did!"}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 3, "last_activity_date": 1477460842, "last_edit_date": 1477460842, "creation_date": 1477459305, "answer_id": 40254293, "question_id": 40254007, "link": "https://stackoverflow.com/questions/40254007/go-equivalent-of-pythons-dictionary/40254293#40254293", "title": "Go equivalent of Python&#39;s Dictionary", "body": "<p>Based on your response in comments I would suggest something like the following using a struct (though if you are only interested in a single value like <code>name</code> for each item in your slice then you could just use a <code>map[int][]string{}</code></p>\n\n<pre><code>type Thing struct {\n    name string\n    age  int\n}\n\nmyMap := map[int][]Thing{}\n</code></pre>\n\n<p>If you want to add things then you just do...</p>\n\n<pre><code>myMap[100] = append(myMap[100], Thing{\"sberry\": 37})\n</code></pre>\n\n<p>Or if you want to create it in place:</p>\n\n<pre><code>myMap := map[int][]Thing{\n        100: []Thing{Thing{\"sberry\", 37}},\n        2:   []Thing{Thing{\"johndoe\", 22}},\n    }\n</code></pre>\n\n<p><strong>EDIT:</strong> Adding a \"nameIn\" function based on comments as demo:</p>\n\n<pre><code>func nameIn(things []Thing, name string) bool {\n    for _, thing := range things {\n        if thing.name == name {\n            return true\n        }\n    }\n    return false\n}\n\nif nameIn(myMap[100], \"John\") {\n    ...\n</code></pre>\n\n<p>If the slices are really big and speed is  concern then you could keep a reverse lookup map like <code>map[string]int</code> where an entry would be <code>John: 100</code>, but you will need to most likely use some user defined functions to do your map modifications so it can change the reverse lookup as well.  This also limits you by requiring unique names.</p>\n\n<p>Most likely the <code>nameIn</code> would work just fine.</p>\n"}], "owner": {"reputation": 425, "user_id": 3902984, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fd4e4c3801b65345a38686f8844cf390?s=128&d=identicon&r=PG&f=1", "display_name": "Parag", "link": "https://stackoverflow.com/users/3902984/parag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4466, "favorite_count": 1, "accepted_answer_id": 40254293, "answer_count": 2, "score": 3, "last_activity_date": 1477460842, "creation_date": 1477457689, "last_edit_date": 1477457933, "question_id": 40254007, "link": "https://stackoverflow.com/questions/40254007/go-equivalent-of-pythons-dictionary", "title": "Go equivalent of Python&#39;s Dictionary", "body": "<p>I am looking for a way to store multiple values for each key (just like we can in python using dictionary) using Go.\nIs there a way this can be achieved in Go?</p>\n"}, {"tags": ["serialization", "go", "marshalling"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1477450828, "post_id": 40252962, "comment_id": 67768097, "body": "Too short for answer: <a href=\"https://godoc.org/encoding/gob\" rel=\"nofollow noreferrer\">godoc.org/encoding/gob</a>.  See also: <a href=\"http://stackoverflow.com/questions/38129076/is-it-possible-to-pickle-instances-of-structs-in-golang\" title=\"is it possible to pickle instances of structs in golang\">stackoverflow.com/questions/38129076/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3254, "user_id": 2927601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d06918d96014e4de287f37dc5ecba1b1?s=128&d=identicon&r=PG", "display_name": "Laily", "link": "https://stackoverflow.com/users/2927601/laily"}, "is_accepted": false, "score": 2, "last_activity_date": 1509186979, "last_edit_date": 1509186979, "creation_date": 1477451654, "answer_id": 40253090, "question_id": 40252962, "link": "https://stackoverflow.com/questions/40252962/load-and-store-in-go-language/40253090#40253090", "title": "Load and Store in Go Language", "body": "<p>I don't know about how pickle work, if you want to dump a struct into file, may be you can use <a href=\"http://golang.org/pkg/encoding/gob\" rel=\"nofollow noreferrer\">gob package</a>, see more detail for this <a href=\"https://stackoverflow.com/questions/12854125/how-do-i-dump-the-struct-into-the-byte-array-without-reflection\">How do I dump the struct into the byte array without reflection?</a>\u3002</p>\n\n<p>Also, I found a package that can read and write Python's pickle <a href=\"https://github.com/hydrogen18/stalecucumber\" rel=\"nofollow noreferrer\">https://github.com/hydrogen18/stalecucumber</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "is_accepted": false, "score": -1, "last_activity_date": 1477455627, "creation_date": 1477455627, "answer_id": 40253674, "question_id": 40252962, "link": "https://stackoverflow.com/questions/40252962/load-and-store-in-go-language/40253674#40253674", "title": "Load and Store in Go Language", "body": "<p>Perhaps the gob package is closest:\n<a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow\">https://golang.org/pkg/encoding/gob/</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 0, "last_activity_date": 1477461894, "last_edit_date": 1495541796, "creation_date": 1477459481, "answer_id": 40254324, "question_id": 40252962, "link": "https://stackoverflow.com/questions/40252962/load-and-store-in-go-language/40254324#40254324", "title": "Load and Store in Go Language", "body": "<p>Calculate your variables once and save them all once in a file,<br>\nthen open that file and load them all.<br>\nWhen there is no file to open, it is the first time, so calculate and save it once.<br>\nYou may use your own file format, if you like, or use <a href=\"https://golang.org/pkg/encoding/#pkg-subdirectories\" rel=\"nofollow noreferrer\">standard library</a>, like <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\"><code>\"encoding/json\"</code></a>, <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow noreferrer\"><code>\"encoding/gob\"</code></a>, <a href=\"https://golang.org/pkg/encoding/csv/\" rel=\"nofollow noreferrer\"><code>\"encoding/csv\"</code></a>, <a href=\"https://golang.org/pkg/encoding/xml/\" rel=\"nofollow noreferrer\"><code>\"encoding/xml\"</code></a>, ....</p>\n\n<hr>\n\n<p>This:  </p>\n\n<pre><code>data := calcOnce()\n</code></pre>\n\n<p>reads file:</p>\n\n<pre><code>rd, err := ioutil.ReadFile(once)\n</code></pre>\n\n<p>and if there is no error loads all the variables, otherwise calculates and  saves them once.   </p>\n\n<p>Here's the working code: </p>\n\n<p>1- Using <code>\"encoding/json\"</code>, try it on <a href=\"https://play.golang.org/p/X1grBzSS-0\" rel=\"nofollow noreferrer\">The Go Playground</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n)\n\ntype Data struct {\n    A [2]int\n    B map[int]string\n}\n\nfunc main() {\n    data := calcOnce()\n\n    fmt.Println(data) // {[101 102] map[1:Hello  2:World.]}\n}\n\nfunc calcOnce() Data {\n    const once = \"date.json\"\n    rd, err := ioutil.ReadFile(once)\n    if err != nil {\n        //calc and save once:\n        data := Data{[2]int{101, 102}, map[int]string{1: \"Hello \", 2: \"World.\"}}\n        buf, err := json.Marshal(data)\n        if err != nil {\n            panic(err)\n        }\n        //fmt.Println(string(buf))\n        err = ioutil.WriteFile(once, buf, 0666)\n        if err != nil {\n            panic(err)\n        }\n        return data\n    }\n    var d *Data\n    err = json.Unmarshal(rd, &amp;d)\n    if err != nil {\n        panic(err)\n    }\n    return *d\n}\n</code></pre>\n\n<hr>\n\n<p>2- Using <code>\"encoding/gob\"</code>, try it on <a href=\"https://play.golang.org/p/zM4Utmaga9\" rel=\"nofollow noreferrer\">The Go Playground</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/gob\"\n    \"fmt\"\n    \"io/ioutil\"\n)\n\ntype Data struct {\n    A [2]int\n    B map[int]string\n}\n\nfunc main() {\n    data := calcOnce()\n\n    fmt.Println(data) // {[1010 102] map[2:World. 1:Hello ]}\n}\n\nfunc calcOnce() Data {\n    const once = \"date.bin\"\n    rd, err := ioutil.ReadFile(once)\n    if err != nil {\n        //calc and save once:\n        data := Data{[2]int{101, 102}, map[int]string{1: \"Hello \", 2: \"World.\"}}\n        buf := &amp;bytes.Buffer{}\n        err = gob.NewEncoder(buf).Encode(data)\n        if err != nil {\n            panic(err)\n        }\n        err = ioutil.WriteFile(once, buf.Bytes(), 0666)\n        if err != nil {\n            panic(err)\n        }\n        return data\n    }\n    var d Data\n    err = gob.NewDecoder(bytes.NewReader(rd)).Decode(&amp;d)\n    if err != nil {\n        panic(err)\n    }\n    return d\n}\n</code></pre>\n\n<hr>\n\n<p>3- for protobuf see: <a href=\"https://stackoverflow.com/questions/37618399/efficient-go-serialization-of-struct-to-disk\">Efficient Go serialization of struct to disk</a></p>\n"}], "owner": {"reputation": 425, "user_id": 3902984, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fd4e4c3801b65345a38686f8844cf390?s=128&d=identicon&r=PG&f=1", "display_name": "Parag", "link": "https://stackoverflow.com/users/3902984/parag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "closed_date": 1477488846, "answer_count": 3, "score": 1, "last_activity_date": 1509186979, "creation_date": 1477450711, "last_edit_date": 1477461288, "question_id": 40252962, "link": "https://stackoverflow.com/questions/40252962/load-and-store-in-go-language", "closed_reason": "Duplicate", "title": "Load and Store in Go Language", "body": "<p>I am new to Go and was wondering if there is a way to load and store precomputed variables in Go like pickle in Python.<br>\nMy code is creating a map and an array from some data and I don't want to spend time in computation of those, every time the code runs.<br>\nI want to load that map and array directly next time I run the code.<br>\nCan someone help me with this?</p>\n\n<p>TIA :)</p>\n"}, {"tags": ["ios", "go", "cross-platform", "google-oauth"], "answers": [{"tags": [], "owner": {"reputation": 543, "user_id": 85495, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/3481f8f21487a05b33c3cc7a7dfd22e3?s=128&d=identicon&r=PG", "display_name": "eipipuz", "link": "https://stackoverflow.com/users/85495/eipipuz"}, "is_accepted": true, "score": 1, "last_activity_date": 1479178601, "creation_date": 1479178601, "answer_id": 40601268, "question_id": 40252570, "link": "https://stackoverflow.com/questions/40252570/how-to-set-up-ios-google-sign-in-with-backend-integration/40601268#40601268", "title": "How to set up iOS Google Sign In with backend integration?", "body": "<p>I found the way.</p>\n\n<p>First, forget about \"audience:server:client_id:\".</p>\n\n<pre><code>    let signin = GIDSignIn.sharedInstance()\n    signin.clientID = \"XXXX-YYYY.apps.googleusercontent.com\"\n    signin.serverClientID = \"XXXX-ZZZZ.apps.googleusercontent.com\"\n    signin.scopes.append(\"https://www.googleapis.com/auth/plus.me\")\n    signin.delegate = self\n</code></pre>\n\n<p>Second, redirect_uris don't matter.</p>\n\n<p>Last, the only thing else that you need to be careful is that <code>serverAuthCode</code> will only come once. So be sure to <code>GIDSignIn.sharedInstance().signOut</code> if you support log out.</p>\n"}], "owner": {"reputation": 543, "user_id": 85495, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/3481f8f21487a05b33c3cc7a7dfd22e3?s=128&d=identicon&r=PG", "display_name": "eipipuz", "link": "https://stackoverflow.com/users/85495/eipipuz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 40601268, "answer_count": 1, "score": 0, "last_activity_date": 1479178601, "creation_date": 1477447580, "last_edit_date": 1495542296, "question_id": 40252570, "link": "https://stackoverflow.com/questions/40252570/how-to-set-up-ios-google-sign-in-with-backend-integration", "title": "How to set up iOS Google Sign In with backend integration?", "body": "<p>I'm trying to follow the instructions at: <a href=\"https://developers.google.com/identity/sign-in/ios/offline-access\" rel=\"nofollow noreferrer\">https://developers.google.com/identity/sign-in/ios/offline-access</a>. Whenever I send a token I get: \"redirect_uri_mismatch\".</p>\n\n<p>I read in another question that client ids need to wait for a bit. This is not the case. The backend id has been active since August. The web app works fine. The server json sets \"redirect_uris\" to \"postmessage\".</p>\n\n<p>This looks very similar to the question: <a href=\"https://stackoverflow.com/questions/33877951/cross-platform-google-oauth-signin-redirect-uri-mismatch\">Cross-platform Google OAuth Signin: redirect_uri mismatch</a> but my scenario is with iOS and Go.</p>\n\n<p>If I add a scope \"audience:server:client_id:\" as suggested by <a href=\"https://developers.google.com/identity/protocols/CrossClientAuth\" rel=\"nofollow noreferrer\">https://developers.google.com/identity/protocols/CrossClientAuth</a> I get an \"invalid scope\" error.</p>\n"}, {"tags": ["caching", "go", "dns"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477487679, "post_id": 40251727, "comment_id": 67786909, "body": "No, but it&#39;s quite common to use a local dns server to cache responses."}, {"owner": {"reputation": 11022, "user_id": 317916, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/21dda5ab7f19b2cf21502358eb0410e1?s=128&d=identicon&r=PG", "display_name": "cbednarski", "link": "https://stackoverflow.com/users/317916/cbednarski"}, "edited": false, "score": 1, "creation_date": 1557031023, "post_id": 40251727, "comment_id": 98626184, "body": "You don&#39;t want Go to do this. Go the runtime / stdlib / language absolutely should not, and your app probably shouldn&#39;t either. Java does this and it&#39;s a pain and leads to all sorts of unexpected situations. How do you clear the cache without modifying or restarting the program? How do you know what&#39;s in the cache? How long is it there for? How do you troubleshoot it? It&#39;s opaque."}], "answers": [{"comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 2, "creation_date": 1478298361, "post_id": 40252460, "comment_id": 68113625, "body": "In addition, many Linuxes now include local DNS caching so there is not much benefit to be had from extra caching within apps. Ubuntu is the obvious example. You can see this in action by e.g. <code>dig www.google.com</code>, which shows some comments that might include <code>;; SERVER: 127.0.1.1</code>, this being your local DNS cache in operation."}, {"owner": {"reputation": 71, "user_id": 1953809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20550003f15d0ba8b56d709c938f827e?s=128&d=identicon&r=PG", "display_name": "Zhang Boyang", "link": "https://stackoverflow.com/users/1953809/zhang-boyang"}, "edited": false, "score": 0, "creation_date": 1589863026, "post_id": 40252460, "comment_id": 109454004, "body": "It&#39;s better to use <code>net.SplitHostPort</code> to split <code>address</code>."}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 12, "last_activity_date": 1477446738, "creation_date": 1477446738, "answer_id": 40252460, "question_id": 40251727, "link": "https://stackoverflow.com/questions/40251727/does-go-cache-dns-lookups/40252460#40252460", "title": "Does Go cache DNS lookups?", "body": "<p>The answer to your question is no. There is no built-in dns caching in the std lib resolver. Would it be helpful? Maybe in some cases. Our org runs a local dns cache on each server and points resolv.conf there. So it wouldn't necessarily help us much to have caching in the language.</p>\n\n<p>There are some solutions that could help you. <a href=\"https://github.com/viki-org/dnscache\">This package</a> seems to have a pretty good solution. From the snippet in their readme you could even do:</p>\n\n<pre><code>http.DefaultClient.Transport = &amp;http.Transport {\n  MaxIdleConnsPerHost: 64,\n  Dial: func(network string, address string) (net.Conn, error) {\n    separator := strings.LastIndex(address, \":\")\n    ip, _ := dnscache.FetchString(address[:separator])\n    return net.Dial(\"tcp\", ip + address[separator:])\n  },\n}\n</code></pre>\n\n<p>To enable it for all http requests from <code>http.Get</code> and friends.</p>\n"}, {"tags": [], "owner": {"reputation": 4456, "user_id": 4127569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b728c7d6c1dce81f5a82249b7617756?s=128&d=identicon&r=PG&f=1", "display_name": "jch", "link": "https://stackoverflow.com/users/4127569/jch"}, "is_accepted": false, "score": 4, "last_activity_date": 1479255842, "creation_date": 1479255842, "answer_id": 40622084, "question_id": 40251727, "link": "https://stackoverflow.com/questions/40251727/does-go-cache-dns-lookups/40622084#40622084", "title": "Does Go cache DNS lookups?", "body": "<p>The Go resolver does not do any in-process caching.  While it would be possible to roll your own, your best bet is probably to run a system-wide DNS cache on each machine.  (My favourite being <a href=\"http://www.thekelleys.org.uk/dnsmasq/doc.html\" rel=\"nofollow noreferrer\">dnsmasq</a>.)</p>\n"}], "owner": {"reputation": 50646, "user_id": 99923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/211755e2897f699737d63f5e2ecf5b07?s=128&d=identicon&r=PG", "display_name": "Xeoncross", "link": "https://stackoverflow.com/users/99923/xeoncross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9283, "favorite_count": 2, "accepted_answer_id": 40252460, "answer_count": 2, "score": 10, "last_activity_date": 1479569127, "creation_date": 1477440838, "last_edit_date": 1479569127, "question_id": 40251727, "link": "https://stackoverflow.com/questions/40251727/does-go-cache-dns-lookups", "title": "Does Go cache DNS lookups?", "body": "<p>I am building a test crawler and wanted to know if Go (golang) caches DNS queries. I don't see anything about caching in the <a href=\"https://golang.org/src/net/dnsclient_unix.go\" rel=\"noreferrer\">dnsclient</a>. This seems like an important thing to add to any crawler to prevent lots of extra DNS queries. </p>\n\n<p><strong>Does Go (1.4+) cache DNS lookups?</strong></p>\n\n<p>If not, does debian/ubuntu/linux, windows, or darwin/OSX do any caching at the network level Go benefits from?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1477433053, "post_id": 40250449, "comment_id": 67763641, "body": "You can&#39;t assign <code>int8</code> to <code>int16</code> or <code>int32</code>, but you can safely convert them."}, {"owner": {"reputation": 3058, "user_id": 2776473, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/JvVL6.jpg?s=128&g=1", "display_name": "Shmulik Klein", "link": "https://stackoverflow.com/users/2776473/shmulik-klein"}, "edited": false, "score": 1, "creation_date": 1477433058, "post_id": 40250449, "comment_id": 67763643, "body": "You have to explicitly cast it using <code>int16()</code>, etc"}, {"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477433640, "post_id": 40250449, "comment_id": 67763865, "body": "@JimB, Thank you for your comment. I might be wrong, however, Safe assignment and conversion is different."}, {"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "reply_to_user": {"reputation": 3058, "user_id": 2776473, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/JvVL6.jpg?s=128&g=1", "display_name": "Shmulik Klein", "link": "https://stackoverflow.com/users/2776473/shmulik-klein"}, "edited": false, "score": 0, "creation_date": 1477433949, "post_id": 40250449, "comment_id": 67763975, "body": "@ShmulikKlein, Thanks for your comment. Casting might be a valid if we try to down cast. But this is a case of up casting. So, I assume, this should be an easy task for compiler with out any helping hands."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1477434415, "post_id": 40250449, "comment_id": 67764133, "body": "@Nair: What exactly are you asking? You cannot assign an <code>int8</code> to an <code>int16</code>/<code>int32</code>/etc. Just because it&#39;s &quot;safe&quot; doesn&#39;t mean they are assignable; they are different types. <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Assignability</a>"}, {"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477435021, "post_id": 40250449, "comment_id": 67764324, "body": "@JimB, Is it true that int8/int16/int32 are integer/integral type with varying storage capacity."}, {"owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "edited": false, "score": 0, "creation_date": 1477450723, "post_id": 40250449, "comment_id": 67768063, "body": "@Nair that&#39;s correct, int8/int16/int32 are 8 bits, 16 bits, and 32 bits wide as you&#39;d expect. You may find <a href=\"https://tour.golang.org/basics/13\" rel=\"nofollow noreferrer\">tour.golang.org/basics/13</a> useful. You are also correct that the compiler <i>could</i> easily widen the smaller types to match the return types, but it doesn&#39;t. Just because you can do something doesn&#39;t mean you should, and in this case it is the go philosophy that you should be explicit about such things; this satisfies the principle of least suprise."}, {"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1477471090, "post_id": 40250449, "comment_id": 67776141, "body": "I&#39;m not sure some of us are obsessed with down voting without explaining what they found in question as off topic."}, {"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "reply_to_user": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "edited": false, "score": 0, "creation_date": 1477471254, "post_id": 40250449, "comment_id": 67776229, "body": "@SamWhited, If this is how Go designed to handle such situation then I accept it and I am open enough to respect every language it it&#39;s level. You can post you comment as answer in answer section."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477486967, "post_id": 40250449, "comment_id": 67786395, "body": "@Nair: the question is probably downvoted because &quot;Is it it safe for language to assume int8 is safely assignable to int16 or int32&quot; is very unclear, which is one of the criteria for downvoting (and the number of comments here is an indication that many didn&#39;t understand what you&#39;re asking). The fact that it may theoretically be safe for &quot;language&quot; (Go?) to assign an <code>int8</code> to an <code>int16</code> is irrelevant, because the language as specified doesn&#39;t allow assignment between different underlying types (see &quot;Assignability&quot; specification link in my previous comment)."}, {"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479336059, "post_id": 40250449, "comment_id": 68519365, "body": "@JimB, Thank you for your guidance. I must go with Go and its strict type restriction to know why such assignability is not possible. Sorry still learning."}], "answers": [{"comments": [{"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1477471434, "post_id": 40251080, "comment_id": 67776336, "body": "Thanks for your support. My Question was not how to fix error message. Rather, I am interested in knowing why Go can&#39;t make safe conversion"}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "reply_to_user": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 2, "creation_date": 1477478305, "post_id": 40251080, "comment_id": 67780746, "body": "@Nair Why unable to do safe conversion? &quot;Because that is how the language is defined&quot;."}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 2, "creation_date": 1477478367, "post_id": 40251080, "comment_id": 67780784, "body": "You&#39;re probably better off doing <code>int16(a) * int16(b)</code> rather than <code>int16(a * b)</code>... Unless you can guarantee that <code>a *  b</code> won&#39;t wrap, that is."}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": false, "score": 2, "last_activity_date": 1477436315, "creation_date": 1477436315, "answer_id": 40251080, "question_id": 40250449, "link": "https://stackoverflow.com/questions/40250449/golang-func-return-type/40251080#40251080", "title": "Golang func - return type", "body": "<p>The error says that you have to return <strong>int16</strong> and <strong>int32</strong>, all you have to do is convert the result like this:</p>\n\n<pre><code>func Arithmetic(a, b int8) (int8, string, int16, int32) {\n    return a - b, \"add\", int16(a * b), int32(a / b)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 3, "last_activity_date": 1477488315, "creation_date": 1477488315, "answer_id": 40263548, "question_id": 40250449, "link": "https://stackoverflow.com/questions/40250449/golang-func-return-type/40263548#40263548", "title": "Golang func - return type", "body": "<blockquote>\n  <p>Is it it safe for language to assume int8 is safely assignable to int16 or int32</p>\n</blockquote>\n\n<p>Yes, It would be, if Go did implicit conversions on assignment. But it does not (only interface-wrapping when applicable).</p>\n\n<p>There are several reasons:</p>\n\n<ul>\n<li>The concept of automatic conversion cannot be generalized to all types without introducing the concept of a type hierarchy. And, as you know, all concrete types in Go are invariant.</li>\n<li>Go is \"anti-magic\" and in this spirit it doesn't do stuff you did not request it to do (except e.g. write-barriers on pointers).</li>\n</ul>\n"}], "owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2064, "favorite_count": 0, "accepted_answer_id": 40263548, "answer_count": 2, "score": 1, "last_activity_date": 1479336173, "creation_date": 1477432829, "last_edit_date": 1479336173, "question_id": 40250449, "link": "https://stackoverflow.com/questions/40250449/golang-func-return-type", "title": "Golang func - return type", "body": "<p>This is my first <code>Golang</code> program after 'Hello world'. Please find following code block which aims to perform basic arithmetic and multiple type return demo. This is just a hypothetical sample to learn <code>Go func</code>. However, I am getting following exception on compilation. From exception, i assume, operations on <code>int8</code> operand return <code>int16/int32</code> as return type and which is not correct as per go.</p>\n\n<p><strong>Question:</strong> Isn't it safe for language to assume <code>int8</code> is safely assignable to <code>int16</code> or <code>int32</code></p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n)\nfunc Arithmetic(a,b int8) (int8,string,int16,int32){\n    return a-b, \"add\",a*b,a/b\n}\nfunc main() {\n    a,b,c,d :=Arithmetic(5,10)\n    fmt.Println(a,b,c,d)\n}\n</code></pre>\n\n<p><strong>Error:</strong></p>\n\n<pre><code>C:/Go\\bin\\go.exe run C:/GoWorkspace/src/tlesource/ff.go\n# command-line-arguments\n.\\ff.go:15: cannot use a * b (type int8) as type int16 in return argument\n.\\ff.go:15: cannot use a / b (type int8) as type int32 in return argument\n\nProcess finished with exit code 2\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1477426610, "post_id": 40248930, "comment_id": 67760251, "body": "That is how you set it for the default logger.  What do you mean by &quot;add to every function&quot;?"}, {"owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477426753, "post_id": 40248930, "comment_id": 67760329, "body": "Thank you, Jim. I have to start every function with that settings:         func GetSettings(path string) string { \tlog.SetFlags(log.Llongfile) \tf, err := os.Open(&quot;config.json&quot;) \tif err != nil { \t\tlog.Fatal(err) \t}"}, {"owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477426851, "post_id": 40248930, "comment_id": 67760384, "body": "and if I log.fatal in main - I got only short description"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1477427019, "post_id": 40248930, "comment_id": 67760494, "body": "I don&#39;t understand. <code>log.SetFlags</code> sets the flags for the default output from the <code>log</code> package. If you want that set for all calls to the log package functions, set it once before you call any of those functions."}, {"owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477427889, "post_id": 40248930, "comment_id": 67760939, "body": "sorry, I am a go beginner :-). when I run it in main - first line, it works only for main. so any other package shows short form. Probably setting this flag and then passing logger to every package will work. But is it any more elegant solution?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1477428651, "post_id": 40248930, "comment_id": 67761389, "body": "Setting it once in main will affect <i>any</i> package that uses the default logger (unless those packages later change it back). There&#39;s nothing you can do to globally affect packages that don&#39;t use the default logger called by the log package functions."}, {"owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477430041, "post_id": 40248930, "comment_id": 67762181, "body": "Yes, Jim. It does work. I mess something up earlier. THANK YOU. Would be happy to add Star to you if you can answer me."}], "answers": [{"comments": [{"owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "edited": false, "score": 0, "creation_date": 1477494847, "post_id": 40253113, "comment_id": 67792394, "body": "OMG, Mr Sigit. That&#39;s exactly what I needed. My whole-heart appreciation of your help."}], "tags": [], "owner": {"reputation": 121, "user_id": 990115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F0Bzk.jpg?s=128&g=1", "display_name": "sigit_prayoga", "link": "https://stackoverflow.com/users/990115/sigit-prayoga"}, "is_accepted": true, "score": 0, "last_activity_date": 1477451814, "creation_date": 1477451814, "answer_id": 40253113, "question_id": 40248930, "link": "https://stackoverflow.com/questions/40248930/error-handling-in-go-which-file-and-line/40253113#40253113", "title": "Error handling in go, which file and line?", "body": "<p>You might want to consider <a href=\"https://github.com/codegangsta/gin\" rel=\"nofollow\"><code>gin</code></a> to watch and tells you where errors happened after build.</p>\n"}], "owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 40253113, "answer_count": 1, "score": -3, "last_activity_date": 1477451814, "creation_date": 1477426510, "question_id": 40248930, "link": "https://stackoverflow.com/questions/40248930/error-handling-in-go-which-file-and-line", "title": "Error handling in go, which file and line?", "body": "<p>I did not find a better way to show error details in long form.</p>\n\n<pre><code>log.SetFlags(log.Llongfile)\n</code></pre>\n\n<p>I am particularly interested which file and line error happened. Is it any way to set long format application wide rather than add to every function?</p>\n"}, {"tags": ["go", "methods", "struct", "embedding"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 3705892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27cdf54f1655844be2469a2aa5f80f0c?s=128&d=identicon&r=PG&f=1", "display_name": "simplebird", "link": "https://stackoverflow.com/users/3705892/simplebird"}, "edited": false, "score": 0, "creation_date": 1477424713, "post_id": 40248342, "comment_id": 67759160, "body": "Thx for the great explanation!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 15, "last_activity_date": 1477425657, "last_edit_date": 1477425657, "creation_date": 1477424394, "answer_id": 40248342, "question_id": 40248156, "link": "https://stackoverflow.com/questions/40248156/golang-type-assign-with-another-struct/40248342#40248342", "title": "Golang: Type assign with another struct", "body": "<p>This:</p>\n\n<pre><code>type Form Rectangle\n</code></pre>\n\n<p>Creates a <em>new</em> type named <code>Form</code>, having <code>Rectangle</code> as its <em>underlying</em> type.</p>\n\n<p>This means that the fields of <code>Rectangle</code> (which is a struct) will be defined for <code>Form</code> as well.</p>\n\n<p>But methods are bound to a specific type. When you create a new type (<code>Form</code>), that new type will not have any of the methods of its underlying type, so you can't call <code>c.SomethingElse()</code> as <code>SomethingElse()</code> is a method of the <code>Rectangle</code> type.</p>\n\n<p><code>c.Circle.Something()</code> works, because <code>c.Circle</code> is a field of type <code>Circle</code>, and <code>Something()</code> is a method of the <code>Circle</code> type.</p>\n\n<p>If you want to call the <code>Rectangle.SomethingElse()</code> method, that requires a value of type <code>Rectangle</code> (the receiver type is <code>Rectangle</code>). Since underlying type of <code>Form</code> is <code>Rectangle</code>, you can simply obtain a value of type <code>Rectangle</code> from a value of type <code>Form</code> using a simple type <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">conversion</a>:</p>\n\n<pre><code>Rectangle(c).SomethingElse() // This works\n</code></pre>\n\n<p>The benefit of creating a new type is that so you can create / add your own methods for it. A common example is implementing the <a href=\"https://golang.org/pkg/sort/#Interface\" rel=\"noreferrer\"><code>sort.Interface</code></a> interface. Let's say you have a slice of something, e.g. <code>[]Rectangle</code>, or a slice of some type which you have no control over (beause it's part of another package \u2013 and methods for a type can only be defined in the same package). If you want to sort this slice, you create a new type for which you can define methods, the methods of <code>sort.Interface</code>, e.g.:</p>\n\n<pre><code>type SortRectangle []Rectangle\n\nfunc (s SortRectangle) Len() int           { return len(s) }\nfunc (s SortRectangle) Less(i, j int) bool { return s[i] &lt;some-logic&gt; s[j] }\nfunc (s SortRectangle) Swap(i, j int)      { s[i], s[j] = s[j], s[i] }\n</code></pre>\n\n<p>The <code>sort.Sort()</code> function is able to sort any values that implement <code>sort.Interface</code>. The <code>[]Rectangle</code> does not, but we just created a new type <code>SortRectangle</code> which does. And if we have a value of type <code>[]Rectangle</code>, we can convert it to <code>SortRectangle</code> because the former is the underlying type of the latter, and by doing a conversion, we have a value of type <code>SortRectangle</code> which can be passed to <code>sort.Sort()</code>, in order to have it sorted:</p>\n\n<pre><code>rs := []Rectangle{}\n// Sort rs:\nsort.Sort(SortRectangle(rs))\n</code></pre>\n\n<p>Note that a conversion like the above <code>SortRectangle(rs)</code> only changes the runtime type information, it does not change the memory representation of <code>rs</code>, so it's pefectly <em>safe</em> and <em>efficient</em>.</p>\n\n<p>If you want the new type to have the methods of the \"old\" type, then use embedding. See Ainar-G's answer. In fact, you already did this by embedding <code>Circle</code> in <code>Rectangle</code>: the type <code>Rectangle</code> has a method <code>Something()</code>, because <code>Something()</code> is a method of <code>Circle</code>:</p>\n\n<pre><code>Rectangle{}.Something()  // Prints \"something\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 1, "last_activity_date": 1477424521, "creation_date": 1477424521, "answer_id": 40248380, "question_id": 40248156, "link": "https://stackoverflow.com/questions/40248156/golang-type-assign-with-another-struct/40248380#40248380", "title": "Golang: Type assign with another struct", "body": "<p>The whole (and only) reason to do <code>type Form Rectangle</code> is to define a <em>new</em> type with <em>different</em> methods. In your example: No methods. <code>c</code> is a Form and has no methods, it's only raison d'\u00eatre is <em>not</em> having a <code>SomethingElse()</code> method.</p>\n\n<p>But a <code>Form</code> still embeds a Circle which is accessible as <code>c.Circle</code> and which is a <code>Circle</code> so it obviousely has the method <code>Something()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 5, "last_activity_date": 1477424570, "last_edit_date": 1495535385, "creation_date": 1477424570, "answer_id": 40248395, "question_id": 40248156, "link": "https://stackoverflow.com/questions/40248156/golang-type-assign-with-another-struct/40248395#40248395", "title": "Golang: Type assign with another struct", "body": "<p>A simple rule in Go. If you want the type's methods, do</p>\n\n<pre><code>type A struct { B }\n</code></pre>\n\n<p>and if you <em>don't</em> want the type's methods, do</p>\n\n<pre><code>type A B\n</code></pre>\n\n<p>Why do we need the second form? <em>Interfaces,</em> for example. Sometimes we <em>don't</em> want a value to satisfy an interface, like <a href=\"https://stackoverflow.com/a/34859671/1892060\">here</a>. Other times you just need the types and not its methods.</p>\n\n<p>Go gives you the possibility to get the type that is the same, but with an empty method set.</p>\n"}], "owner": {"reputation": 91, "user_id": 3705892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27cdf54f1655844be2469a2aa5f80f0c?s=128&d=identicon&r=PG&f=1", "display_name": "simplebird", "link": "https://stackoverflow.com/users/3705892/simplebird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3372, "favorite_count": 3, "accepted_answer_id": 40248342, "answer_count": 3, "score": 8, "last_activity_date": 1477425657, "creation_date": 1477423791, "last_edit_date": 1477425553, "question_id": 40248156, "link": "https://stackoverflow.com/questions/40248156/golang-type-assign-with-another-struct", "title": "Golang: Type assign with another struct", "body": "<p>So I have this example here:\n<a href=\"https://play.golang.org/p/h_SojewkBG\" rel=\"noreferrer\">Go Playground</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Circle struct{}\n\nfunc (c Circle) Something() {\n    fmt.Println(\"something\")\n}\n\ntype Rectangle struct {\n    Circle\n}\n\nfunc (a Rectangle) SomethingElse() {\n    fmt.Println(\"SomethingElse\")\n}\n\ntype Form Rectangle\n\nfunc main() {\n    c := Form{}\n    c.Circle.Something()\n    c.SomethingElse()\n}\n</code></pre>\n\n<p>I don't understand why I can call <code>Something</code> from the embedded <code>Circle</code>, but cannot call <code>Somethingelse</code> from the <code>Rectangle</code> within the <code>Form</code> type. Also I don't understand what benefit I get when I declare a type of some other type, like here in <code>Form</code>.</p>\n"}, {"tags": ["bash", "go", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 0, "creation_date": 1477424653, "post_id": 40248315, "comment_id": 67759125, "body": "Totally what I was looking for, thanks. Another little question. Do you think this is the most cost-efficient way of doing &quot;parallel&quot; operations using <code>Go</code>? I have to do that for like <code>1.000.000</code> different <code>a[0]</code> arguments and store the result in a <code>file</code> or in a <code>db</code> (e.g. MongoDB)."}, {"owner": {"reputation": 1267, "user_id": 1598790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11ea12f06eefbb34068f4c1090e2e0b?s=128&d=identicon&r=PG", "display_name": "ramrunner", "link": "https://stackoverflow.com/users/1598790/ramrunner"}, "reply_to_user": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 0, "creation_date": 1477424956, "post_id": 40248315, "comment_id": 67759291, "body": "This really depends. running goroutines is a fantastic way to distribute jobs on tens of thousands of workers. i&#39;m afraid that in your problem you&#39;ll hit the wall probably with your db driver though. a lot of golang database connectors scale well with a a lot of workers (i don&#39;t know about MongoDB but in cassandra that i have used make sure to have them share the database session.). the other end is running 1mil processes from your script. again... what is the median runtime of the command? can you batch ops by consolidating a couple of thousands of arguments in one command invocation?"}, {"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 0, "creation_date": 1477425519, "post_id": 40248315, "comment_id": 67759650, "body": "It takes like <code>42 seconds</code> to execute it and print it <code>100.000</code> times. It is a pretty slow <code>Ocaml encryption script</code>. I have to pass it different <code>6 Hex Chars</code> each time and store the result. Well, with <code>NodeJS</code> I was really struggling to get such performance. Now, as you said, I have to test if saving the results on <code>MongoDB</code> is a good idea or not.  Unluckily, no, I cannot pass it more than <code>a[0]</code> per time. It accepts <code>-s</code>, <code>Hex Key</code> and <code>A 24 Hex Chars PlainText</code>. So I have to execute it per each different key in the range of <code>000000</code> - <code>FFFFFF</code>."}, {"owner": {"reputation": 1267, "user_id": 1598790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11ea12f06eefbb34068f4c1090e2e0b?s=128&d=identicon&r=PG", "display_name": "ramrunner", "link": "https://stackoverflow.com/users/1598790/ramrunner"}, "reply_to_user": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 1, "creation_date": 1477426283, "post_id": 40248315, "comment_id": 67760076, "body": "hmm i can&#39;t really help without more details. but keep in mind that disk i/o is slow  and also printing to stdout can also be. i would investigate writing to byte.Buffers (using the StdoutPipe or even appending the Output()) and then with a counter flush that whole buffer of results to disk or a db. you don&#39;t need to do one store operation per script execution."}, {"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 0, "creation_date": 1477426779, "post_id": 40248315, "comment_id": 67760340, "body": "I will dig into that, thank you very much, I really appreciated your help."}, {"owner": {"reputation": 1267, "user_id": 1598790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11ea12f06eefbb34068f4c1090e2e0b?s=128&d=identicon&r=PG", "display_name": "ramrunner", "link": "https://stackoverflow.com/users/1598790/ramrunner"}, "reply_to_user": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 0, "creation_date": 1477426806, "post_id": 40248315, "comment_id": 67760357, "body": "no worries :) have fun with golang. it&#39;s a beautiful language."}, {"owner": {"reputation": 1267, "user_id": 1598790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11ea12f06eefbb34068f4c1090e2e0b?s=128&d=identicon&r=PG", "display_name": "ramrunner", "link": "https://stackoverflow.com/users/1598790/ramrunner"}, "reply_to_user": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 0, "creation_date": 1477427122, "post_id": 40248315, "comment_id": 67760550, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/126662/discussion-between-ramrunner-and-andream16\">continue this discussion in chat</a>."}, {"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 0, "creation_date": 1477429164, "post_id": 40248315, "comment_id": 67761692, "body": "For today I&#39;m off, If you are available we can speak  tomorrow around the same hour :)"}, {"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 0, "creation_date": 1477592870, "post_id": 40248315, "comment_id": 67841861, "body": "Hi, if you are online and want to speak about the argument you find me on the chat you just created."}], "tags": [], "owner": {"reputation": 1267, "user_id": 1598790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11ea12f06eefbb34068f4c1090e2e0b?s=128&d=identicon&r=PG", "display_name": "ramrunner", "link": "https://stackoverflow.com/users/1598790/ramrunner"}, "is_accepted": true, "score": 5, "last_activity_date": 1477424325, "creation_date": 1477424325, "answer_id": 40248315, "question_id": 40247726, "link": "https://stackoverflow.com/questions/40247726/go-execute-a-bash-command-n-times-using-goroutines-and-store-print-its-resul/40248315#40248315", "title": "Go - Execute a Bash Command n Times using goroutines and Store &amp; Print its result", "body": "<p>so the following fixes your problem</p>\n\n<ul>\n<li><p>you can call Cmd.Output() to get the output of the command.\notherwise you could connect the Cmd.StdOutPipe pipe to a byte.Buffer for\nexample and read from that.</p></li>\n<li><p>your goroutine logic was wrong. it would only execute 4 times cause then the waitgroup would be Done() and main would exit. You are correct to close the channel from main to signal the workers to exit the for range loop. wg.Done should be called after that so i defered it.</p></li>\n<li><p>when you execute anonymous functions with the go command try not to capture anything from the parent scope. it can lead to disaster. instead figure out which parameters you want and pass them to the function.</p></li>\n</ul>\n\n<p>`</p>\n\n<pre><code>package main \n\nimport (\n    \"fmt\"\n    \"os/exec\"\n    \"sync\"\n)\nfunc main() {\n    cmd := \"./foo.sh\"\n    //Arguments to get passed to the command\n    args := []string{\"bar\", \"baz\"}\n\n    //Common Channel for the goroutines\n    tasks := make(chan *exec.Cmd, 64)\n\n    //Spawning 4 goroutines\n    var wg sync.WaitGroup\n    for i := 0; i &lt; 4; i++ {\n            wg.Add(1)\n            go func(num int, w *sync.WaitGroup) {\n                    defer w.Done()\n                    var (\n                            out []byte\n                            err error\n                    )\n                    for cmd := range tasks { // this will exit the loop when the channel closes\n                            out, err = cmd.Output()\n                            if err != nil {\n                                    fmt.Printf(\"can't get stdout:\", err)\n                            }\n                            fmt.Printf(\"goroutine %d command output:%s\", num, string(out))\n                    }\n            }(i, &amp;wg)\n    }\n    //Generate Tasks\n    for i := 0; i &lt; 10; i++ {\n            tasks &lt;- exec.Command(cmd, args...)\n    }\n    close(tasks)\n\n    // wait for the workers to finish\n    wg.Wait()\n\n    fmt.Println(\"Done\")\n\n}\n</code></pre>\n\n<p>`</p>\n"}], "owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3895, "favorite_count": 0, "accepted_answer_id": 40248315, "answer_count": 1, "score": 3, "last_activity_date": 1477424325, "creation_date": 1477422120, "last_edit_date": 1495541891, "question_id": 40247726, "link": "https://stackoverflow.com/questions/40247726/go-execute-a-bash-command-n-times-using-goroutines-and-store-print-its-resul", "title": "Go - Execute a Bash Command n Times using goroutines and Store &amp; Print its result", "body": "<p>I'm pretty new to <code>Golang</code> in general and I'm trying to execute a <code>bash command with its arguments n times</code>, then, store the <code>Output</code> in a variable and <code>Print</code> it.</p>\n\n<p>I'm able to do it just one time, or just using <code>loops</code> like the following:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n    \"os\"\n    \"sync\"\n)\n\n\nfunc main() {\n\n    //Default Output\n    var (\n        cmdOut []byte\n        err    error\n    )\n\n    //Bash Command\n    cmd  := \"./myCmd\"\n   //Arguments to get passed to the command\n   args := []string{\"arg1\", \"arg2\", \"arg3\"}\n\n    //Execute the Command\n    if cmdOut, err = exec.Command(cmd, args...).Output(); err != nil {\n        fmt.Fprintln(os.Stderr, \"There was an error running \"+cmd+\" \"+args[0]+args[1]+args[2], err)\n        os.Exit(1)\n    }\n    //Store it\n    sha := string(cmdOut)\n    //Print it\n    fmt.Println(sha)\n}\n</code></pre>\n\n<p>This works just fine, I'm able to read the <code>output</code> easily.</p>\n\n<p>Now, I would like to repeat this very same operation for <code>n</code> times, using <code>goroutines</code>.</p>\n\n<p>I tried following the very same approach of the guy who answered <a href=\"https://stackoverflow.com/questions/18405023/how-would-you-define-a-pool-of-goroutines-to-be-executed-at-once-in-golang\">How would you define a pool of goroutines to be executed at once in Golang?</a> but I'm not able to make it work.</p>\n\n<p>That's what I tried so far:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n    \"sync\"\n)\n\n\nfunc main() {\n\n    //Bash Command\n    cmd  := \"./myCmd\"\n    //Arguments to get passed to the command\n     args := []string{\"arg1\", \"arg2\", \"arg3\"}\n\n    //Common Channel for the goroutines\n    tasks := make(chan *exec.Cmd, 64)\n\n    //Spawning 4 goroutines\n    var wg sync.WaitGroup\n    for i := 0; i &lt; 4; i++ {\n        wg.Add(1)\n        go func() {\n            for cmd := range tasks {\n                cmd.Run()\n            }\n            wg.Done()\n        }()\n    }\n\n    //Generate Tasks\n    for i := 0; i &lt; 10; i++ {\n        tasks &lt;- exec.Command(cmd, args...)\n        //Here I should somehow print the result of the latter command\n    }\n    close(tasks)\n\n    // wait for the workers to finish\n    wg.Wait()\n\n    fmt.Println(\"Done\")\n\n}\n</code></pre>\n\n<p>But, I don't really find out how to store the <code>i-result</code> of an executed command and print it.</p>\n\n<p><strong>How can I achieve this?</strong></p>\n\n<p>Thanks in advance, for any clarification on the question just leave a comment.</p>\n"}, {"tags": ["go", "zip"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 1, "creation_date": 1477414531, "post_id": 40245442, "comment_id": 67753440, "body": "I fear the simplest thing to do would be to copy it into a <code>bytes.Buffer</code> or to disk. How big are the nested zips?"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1477414614, "post_id": 40245442, "comment_id": 67753485, "body": "You may find the api for <a href=\"https://godoc.org/golang.org/x/tools/godoc/vfs/zipfs\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/tools/godoc/vfs/zipfs</a> a bit more accommodating as well. Not sure."}, {"owner": {"reputation": 1071, "user_id": 437211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/12eb6d3d6ed5ebf10e23215bc9113d10?s=128&d=identicon&r=PG", "display_name": "freb", "link": "https://stackoverflow.com/users/437211/freb"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1477417923, "post_id": 40245442, "comment_id": 67755307, "body": "@captncraig This is for a small scanning program so I won&#39;t know what zip files I&#39;ll encounter. I&#39;m not sure how common this will be either, I just felt so close to being able to plumb everything together using streams. Good call on the <code>bytes.Buffer</code>, I suppose I can just check file sizes before reading the whole thing since I have access to that."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 1, "creation_date": 1477417995, "post_id": 40245442, "comment_id": 67755346, "body": "Just be careful for things like <a href=\"https://en.wikipedia.org/wiki/Zip_bomb\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Zip_bomb</a>"}, {"owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "edited": false, "score": 0, "creation_date": 1477452157, "post_id": 40245442, "comment_id": 67768457, "body": "Duplicate of <a href=\"https://stackoverflow.com/questions/19642245/need-io-readerat-from-zip-archive-entry-the-entry-is-a-nested-xlsx-file\" title=\"need io readerat from zip archive entry the entry is a nested xlsx file\">stackoverflow.com/questions/19642245/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 2, "last_activity_date": 1477535277, "creation_date": 1477535277, "answer_id": 40275140, "question_id": 40245442, "link": "https://stackoverflow.com/questions/40245442/handling-nested-zip-files-with-archive-zip/40275140#40275140", "title": "Handling nested zip files with archive/zip", "body": "<p>How about an <code>io.ReaderAt</code> from an <code>io.Reader</code> that reinitializes if you decided to go backwards: (this code is largely untested, but hopefully you get the idea)</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"io/ioutil\"\n    \"os\"\n    \"strings\"\n)\n\ntype inefficientReaderAt struct {\n    rdr    io.ReadCloser\n    cur    int64\n    initer func() (io.ReadCloser, error)\n}\n\nfunc newInefficentReaderAt(initer func() (io.ReadCloser, error)) *inefficientReaderAt {\n    return &amp;inefficientReaderAt{\n        initer: initer,\n    }\n}\n\nfunc (r *inefficientReaderAt) Read(p []byte) (n int, err error) {\n    n, err = r.rdr.Read(p)\n    r.cur += int64(n)\n    return n, err\n}\n\nfunc (r *inefficientReaderAt) ReadAt(p []byte, off int64) (n int, err error) {\n    // reset on rewind\n    if off &lt; r.cur || r.rdr == nil {\n        r.cur = 0\n        r.rdr, err = r.initer()\n        if err != nil {\n            return 0, err\n        }\n    }\n\n    if off &gt; r.cur {\n        sz, err := io.CopyN(ioutil.Discard, r.rdr, off-r.cur)\n        n = int(sz)\n        if err != nil {\n            return n, err\n        }\n    }\n\n    return r.Read(p)\n}\n\nfunc main() {\n    r := newInefficentReaderAt(func() (io.ReadCloser, error) {\n        return ioutil.NopCloser(strings.NewReader(\"ABCDEFG\")), nil\n    })\n\n    io.Copy(os.Stdout, io.NewSectionReader(r, 0, 3))\n    io.Copy(os.Stdout, io.NewSectionReader(r, 1, 3))\n}\n</code></pre>\n\n<p>If you mostly move forwards this probably works ok. Especially if you use a buffered reader.</p>\n\n<ul>\n<li>I should note that this violates the <code>io.ReaderAt</code> guarantees: <a href=\"https://godoc.org/io#ReaderFrom\" rel=\"nofollow\">https://godoc.org/io#ReaderFrom</a> , namely it doesn't allow parallel calls to <code>ReadAt</code>, and doesn't block on full reads, so this may not even work properly</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 140828, "user_id": 89771, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/be9e4cbcfa96b7e4ad4bc28c88cfdb2b?s=128&d=identicon&r=PG", "display_name": "Alix Axel", "link": "https://stackoverflow.com/users/89771/alix-axel"}, "is_accepted": false, "score": 0, "last_activity_date": 1557665182, "creation_date": 1557665182, "answer_id": 56099384, "question_id": 40245442, "link": "https://stackoverflow.com/questions/40245442/handling-nested-zip-files-with-archive-zip/56099384#56099384", "title": "Handling nested zip files with archive/zip", "body": "<p>I ran into the exact same need and came up with the following approach, not sure if its any help to you:</p>\n\n<pre><code>// NewZipFromReader ...\nfunc NewZipFromReader(file io.ReadCloser, size int64) (*zip.Reader, error) {\n    in := file.(io.Reader)\n\n    if _, ok := in.(io.ReaderAt); ok != true {\n        buffer, err := ioutil.ReadAll(in)\n\n        if err != nil {\n            return nil, err\n        }\n\n        in = bytes.NewReader(buffer)\n        size = int64(len(buffer))\n    }\n\n    reader, err := zip.NewReader(in.(io.ReaderAt), size)\n\n    if err != nil {\n        return nil, err\n    }\n\n    return reader, nil\n}\n</code></pre>\n\n<p>So if <code>file</code> doesn't implement <code>io.ReaderAt</code> it reads the whole contents into a buffer.</p>\n\n<p>It's probably not safe to handle ZIP bombs, and will defenitely fail with OOM for files larger than RAM.</p>\n"}], "owner": {"reputation": 1071, "user_id": 437211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/12eb6d3d6ed5ebf10e23215bc9113d10?s=128&d=identicon&r=PG", "display_name": "freb", "link": "https://stackoverflow.com/users/437211/freb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 922, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1557665182, "creation_date": 1477413987, "last_edit_date": 1477414374, "question_id": 40245442, "link": "https://stackoverflow.com/questions/40245442/handling-nested-zip-files-with-archive-zip", "title": "Handling nested zip files with archive/zip", "body": "<p>I'm struggling to handle nested zip files in Go (where a zip file contains another zip file). I'm trying to recurse a zip file and list all of the files it contains.</p>\n\n<p>archive/zip gives you two methods for handling a zip file:</p>\n\n<ul>\n<li>zip.NewReader</li>\n<li>zip.OpenReader</li>\n</ul>\n\n<p><code>OpenReader</code> opens a file on disk. <code>NewReader</code> accepts an <code>io.ReaderAt</code> and a file size. As you iterate through the zipped files with either of these, you get out a <code>zip.File</code> for each file inside the zip. To get the file contents of file f, you call <code>f.Open</code> which gives you a <code>zip.ReadCloser</code>. To open a nested zip file, I'd need to use <code>NewReader</code>, but <code>zip.File</code> and <code>zip.ReadCloser</code> do not satisfy the <code>io.ReaderAt</code> interface.</p>\n\n<p><code>zip.File</code> has a private field <code>zipr</code> which is an <code>io.ReaderAt</code> and <code>zip.ReadCloser</code> has a private field <code>f</code> which is an <code>os.File</code> which should satisfy the requirements for <code>NewReader</code>.</p>\n\n<p>My question: is there any way to open a nested zip file without first writing the contents to a file on disk, or reading the whole thing into memory.</p>\n\n<p>It looks like everything that is needed is available in zip.File, but isn't exported. I'm hoping I missed something.</p>\n"}, {"tags": ["go", "concurrency", "race-condition", "rational-number"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1477410812, "post_id": 40244358, "comment_id": 67751076, "body": "<code>big.Rat</code> does not state it is safe for concurrent access. No values in Go are safe for concurrent read/write access. No methods are safe unless otherwise documented."}], "answers": [{"comments": [{"owner": {"reputation": 8073, "user_id": 2852624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/682806d261e4f00f77aa8633689a9558?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias247", "link": "https://stackoverflow.com/users/2852624/matthias247"}, "edited": false, "score": 1, "creation_date": 1477411324, "post_id": 40244525, "comment_id": 67751423, "body": "It&#39;s correct that this is an issue. However it&#39;s not the thing he asked about (whether big.Rat is thread safe)."}], "tags": [], "owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "is_accepted": false, "score": 0, "last_activity_date": 1477411645, "last_edit_date": 1477411645, "creation_date": 1477410994, "answer_id": 40244525, "question_id": 40244358, "link": "https://stackoverflow.com/questions/40244358/data-race-in-big-rat/40244525#40244525", "title": "Data race in big.Rat", "body": "<p><code>Rat.Denom</code> appears not to be thread safe, as @JimB pointed out in the comment. The general rule with the standard library is that methods are not thread safe unless explicitly noted.</p>\n\n<p>Your other issue is a common pitfall with closure loops.</p>\n\n<p>See <a href=\"https://github.com/golang/go/wiki/CommonMistakes\" rel=\"nofollow\">this article</a> for a description of the issue. You must pass the variable into the closure, as seen below.</p>\n\n<p>Working example:</p>\n\n<pre><code>package main\n\nimport (\n    \"math/big\"\n    \"sync\"\n    \"fmt\"\n)\n\nfunc main() {\n    x := big.NewRat(5, 1)\n    wg := new(sync.WaitGroup)\n\n    // just for testing\n    for i := 0; i &lt; 10; i++ {\n    wg.Add(1)\n        go func(i int) {\n            fmt.Println(\"x: \", x)\n            defer wg.Done()\n            if i%2 == 0 {\n                fmt.Printf(\"i: %d, x.Cmp(x): %+v\", i, x.Cmp(x))\n            } else {\n                fmt.Println(\"x.Denom(): \", x.Denom())\n            }\n        }(i)\n    }\n    wg.Wait()\n}\n</code></pre>\n\n<p>See: <a href=\"https://play.golang.org/p/aKo3gHuSeT\" rel=\"nofollow\">https://play.golang.org/p/aKo3gHuSeT</a> for a live example.</p>\n"}, {"tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": false, "score": 1, "last_activity_date": 1477420132, "creation_date": 1477420132, "answer_id": 40247131, "question_id": 40244358, "link": "https://stackoverflow.com/questions/40244358/data-race-in-big-rat/40247131#40247131", "title": "Data race in big.Rat", "body": "<p>You have a clear race condition, in short a race condition is when more than two asynchronous routines (threads, process, co-routines. etc.) are trying to access(write or read) a resource(memory or i/o devices) and at least one of those routines has intentions to write.</p>\n\n<p>In your case you're creating goroutines that are accessing a shared resource (<strong>var x Rat</strong>) and as you may note the method <strong>Denom()</strong> modifies its own value in line <em>403</em> and <em>405</em> and it seems that the Cmp() method is only reading. All we have to do is protect the memory with a <a href=\"https://golang.org/pkg/sync/#RWMutex\" rel=\"nofollow\">RWMutex</a>:</p>\n\n<pre><code>package main \n\nimport (\n    \"math/big\" \n    \"sync\"\n)\n\nfunc main() {\n    x := big.NewRat(5, 1)\n    wg := new(sync.WaitGroup)\n    mutex := new(sync.RWMutex)\n\n    wg.Add(10) // all goroutines\n\n    for i := 0; i &lt; 10; i++ {\n\n        go func(index int) {\n            defer wg.Done()\n\n            if index%2 == 0 {\n\n                mutex.RLock() // locks only for reading\n                x.Cmp(x)\n                mutex.RUnlock() // unlocks for reading\n\n            } else {\n\n                mutex.Lock() // locks for writing\n                x.Denom()\n                mutex.Unlock() // unlock for writing\n\n            }\n        }(i)\n    }\n\n    wg.Wait()\n}\n</code></pre>\n\n<p>Note that we're using RLock and RUnlock for reading operation and Lock and Unlock() for write. Also if you know the number of goroutines to be created I always recommend do the <code>wg.Add(n)</code> in just one line because if you do after wg.Add(1) the go func(){...} you'll be in troubles.</p>\n\n<p>And indeed you have a common mistake of using a <strong>for</strong> index inside a goroutine, always pass them as parameters.</p>\n\n<p>Finally I recommend you to use the <strong>-race</strong> flag to <strong>go run</strong> or <strong>go build</strong> commands, like:</p>\n\n<p><code>go run -race rat.go</code></p>\n\n<p>In fact you will see the difference between your code and my solution just using <strong>-race</strong></p>\n"}], "owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1477453987, "creation_date": 1477410508, "last_edit_date": 1477453987, "question_id": 40244358, "link": "https://stackoverflow.com/questions/40244358/data-race-in-big-rat", "title": "Data race in big.Rat", "body": "<p>I used math/big.Rat to represent numbers for accuracy. \nDenom() returns the denominator of number and Cmp() to compare two numbers. Both of them seems to be a pure read only functions. But when I ran my code with data race enabled, my whole assumption went wrong. When these functions are called concurrently with the same Rat instance, system throws data race scenario. Are these functions not read-only?  </p>\n\n<p>my test case</p>\n\n<pre><code>package main\n\nimport (\n    \"math/big\"\n    \"sync\"\n)\n\nfunc main() {\n    x := big.NewRat(5, 1)\n    wg := new(sync.WaitGroup)\n\n    // just for testing\n    for i := 0; i &lt; 10; i++ {\n        go func() {\n            wg.Add(1)\n            defer wg.Done()\n            if i%2 == 0 {\n                x.Cmp(x)\n            } else {\n                x.Denom()\n            }\n        }()\n    }\n    wg.Wait()\n}\n</code></pre>\n\n<p>When I check the source, every time Denom() function is called, it resets value in the same object. Is this an issue in the source? or I shouldn't take use Rat Denom() and Cmp() concurrently.</p>\n\n<p>Denom() source from <a href=\"https://golang.org/src/math/big/rat.go\" rel=\"nofollow\">Golang for ref</a>.</p>\n\n<pre><code>// Denom returns the denominator of x; it is always &gt; 0.\n   400  // The result is a reference to x's denominator; it\n   401  // may change if a new value is assigned to x, and vice versa.\n   402  func (x *Rat) Denom() *Int {\n   403      x.b.neg = false // the result is always &gt;= 0\n   404      if len(x.b.abs) == 0 {\n   405          x.b.abs = x.b.abs.set(natOne) // materialize denominator\n   406      }\n   407      return &amp;x.b\n   408  }\n</code></pre>\n\n<p>I am adding few more points based on the discussions below and I accept that I made a mistake in using the varibale 'i' for the intended purpose (But still it will work to show the Data race scenario).</p>\n\n<p>My point here is the operation performed in the Denom() won't have modification in the value represented by Rat. This can be performed upon creation of Rat to represent a value or a new value is set in the Rat. My concern is the repeated computaion (not concurrent safe) of same value again and again unless the value represented by the Rat is changed. Then why can't this be done at the creation/modifcation part?</p>\n"}, {"tags": ["encryption", "go", "rsa", "public-key-encryption", "encryption-asymmetric"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1477409392, "post_id": 40243857, "comment_id": 67750038, "body": "RSA is not suitable for encrypting large files. Google it. General practice is to generate an AES key which is small and you can encode the AES key with the RSA key, and you proceed with encrypting the large file with the AES key (symmetric encryption)."}, {"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1477409605, "post_id": 40243857, "comment_id": 67750181, "body": "In addition to @icza&#39;s comment, the golang rsa package has a note on this: <a href=\"https://golang.org/src/crypto/rsa/rsa.go#L335\" rel=\"nofollow noreferrer\">golang.org/src/crypto/rsa/rsa.go#L335</a>"}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1477409717, "post_id": 40243857, "comment_id": 67750266, "body": "But it is not necessary to RSA encrypt the symmetric key unless a public/private key pair are required. What is the iuse case for a public/private key pair"}], "answers": [{"tags": [], "owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "is_accepted": true, "score": 9, "last_activity_date": 1597757213, "last_edit_date": 1597757213, "creation_date": 1477410703, "answer_id": 40244430, "question_id": 40243857, "link": "https://stackoverflow.com/questions/40243857/how-to-encrypt-large-file-with-rsa/40244430#40244430", "title": "How to encrypt large file with RSA?", "body": "<p>RSA can only encrypt data smaller than (or equal to) the key length.</p>\n<p>The answer is to encrypt the data with a symmetric algorithm such as AES which is designed to encrypt small and large data.</p>\n<p>If an RSA public/private key pair are required encrypt the symmetric (AES) key with RSA. This is referred to as hybrid encryption and in essence is how HTTPS encrypts data.</p>\n<p>But it is may not necessary to RSA encrypt the symmetric key unless a public/private key pair are required. In the general case one just uses symmetric (AES) and that key. What is the use case for a public/private key pair?</p>\n"}, {"tags": [], "owner": {"reputation": 1177, "user_id": 4564156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff0db7eb380f134a95557e70d57e582?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsenasm", "link": "https://stackoverflow.com/users/4564156/mohsenasm"}, "is_accepted": false, "score": 5, "last_activity_date": 1582463079, "last_edit_date": 1582463079, "creation_date": 1582462140, "answer_id": 60362338, "question_id": 40243857, "link": "https://stackoverflow.com/questions/40243857/how-to-encrypt-large-file-with-rsa/60362338#60362338", "title": "How to encrypt large file with RSA?", "body": "<p>If you don't want to chunk the file, One approach is creating a random symmetric key <code>R</code> on the air, encrypting the large file with the random symmetric key <code>EF=Sym(F, R)</code> and sending the encrypted file <code>EF</code> with symmetric key, encrypted by your asymmetric RSA public key <code>Pub(R)</code>.</p>\n\n<p>Encryption:</p>\n\n<pre><code>+---------------------+      +--------------------+\n|                     |      |                    |\n| generate random key |      |   the large file   |\n|        (R)          |      |        (F)         |\n|                     |      |                    |\n+--------+--------+---+      +----------+---------+\n         |        |                     |\n         |        +------------------+  |\n         |                           |  |\n         v                           v  v\n+--------+------------+     +--------+--+------------+\n|                     |     |                        |\n| encrypt (R) with    |     | encrypt (F)            |\n| your RSA public key |     | with symmetric key (R) |\n|                     |     |                        |\n|  ASym(PublicKey, R) |     |     EF = Sym(F, R)     |\n|                     |     |                        |\n+----------+----------+     +------------+-----------+\n           |                             |\n           +------------+ +--------------+\n                        | |\n                        v v\n         +--------------+-+---------------+\n         |                                |\n         |   send this files to the peer  |\n         |                                |\n         |     ASym(PublicKey, R) + EF    |\n         |                                |\n         +--------------------------------+\n</code></pre>\n\n<p>Decryption:</p>\n\n<pre><code>   +----------------+        +--------------------+\n   |                |        |                    |\n   | EF = Sym(F, R) |        | ASym(PublicKey, R) |\n   |                |        |                    |\n   +-----+----------+        +---------+----------+\n         |                             |\n         |                             |\n         |                             v\n         |   +-------------------------+-----------------+\n         |   |                                           |\n         |   |             restore key (R)               |\n         |   |                                           |\n         |   | R &lt;= ASym(PrivateKey, ASym(PublicKey, R)) |\n         |   |                                           |\n         |   +---------------------+---------------------+\n         |                         |\n         v                         v\n     +---+-------------------------+---+\n     |                                 |\n     |       restore the file (F)      |\n     |                                 |\n     |      F &lt;= Sym(Sym(F, R), R)     |\n     |                                 |\n     +---------------------------------+\n</code></pre>\n"}], "owner": {"reputation": 248, "user_id": 6073838, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1530379783927023/picture?type=large", "display_name": "\u0410\u043d\u0434\u0440\u0435\u0439 \u0410\u043d\u0442\u043e\u043d\u043e\u0432", "link": "https://stackoverflow.com/users/6073838/%d0%90%d0%bd%d0%b4%d1%80%d0%b5%d0%b9-%d0%90%d0%bd%d1%82%d0%be%d0%bd%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5362, "favorite_count": 2, "accepted_answer_id": 40244430, "answer_count": 2, "score": 3, "last_activity_date": 1597757213, "creation_date": 1477409082, "question_id": 40243857, "link": "https://stackoverflow.com/questions/40243857/how-to-encrypt-large-file-with-rsa", "title": "How to encrypt large file with RSA?", "body": "<p>Code <a href=\"https://play.golang.org/p/CUEqjsJq5c\" rel=\"nofollow\">https://play.golang.org/p/CUEqjsJq5c</a> </p>\n\n<p>Error:</p>\n\n<pre><code>panic: crypto/rsa: message too long for RSA public key size\n\ngoroutine 1 [running]:\npanic(0x4a6d80, 0xc420010420)\n    /usr/local/go/src/runtime/panic.go:500 +0x1a1\nmain.main()\n    /tmp/sample.go:28 +0xfa\n</code></pre>\n\n<p>File size 811 byte (for test encrypt self source file). I want encrypt some bigger files, 1..500 mb. Can I do it with RSA or need use some other methods?</p>\n"}, {"tags": ["go", "process", "io"], "answers": [{"comments": [{"owner": {"reputation": 1166, "user_id": 211195, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/47ffd6538b8c1694db320e07af4397ff?s=128&d=identicon&r=PG", "display_name": "rosencreuz", "link": "https://stackoverflow.com/users/211195/rosencreuz"}, "edited": false, "score": 0, "creation_date": 1477556197, "post_id": 40243948, "comment_id": 67817749, "body": "This works, but I don&#39;t understand why. How does the process write to file after it&#39;s closed? If that doesn&#39;t matter why do we need to open it at all?"}, {"owner": {"reputation": 3824, "user_id": 2728768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb82b13cda86d3b821fa44100335ddf?s=128&d=identicon&r=PG", "display_name": "thoeni", "link": "https://stackoverflow.com/users/2728768/thoeni"}, "reply_to_user": {"reputation": 1166, "user_id": 211195, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/47ffd6538b8c1694db320e07af4397ff?s=128&d=identicon&r=PG", "display_name": "rosencreuz", "link": "https://stackoverflow.com/users/211195/rosencreuz"}, "edited": false, "score": 0, "creation_date": 1477558888, "post_id": 40243948, "comment_id": 67819359, "body": "I didn&#39;t think about that. So, I&#39;ll investigate and come back to you, but I was reading the documentation and the exec.Cmd and the stdout we redirect is managed by a writer descriptor which, I believe, will take care of closing it (and it looks like opening it as well...): <a href=\"https://golang.org/src/os/exec/exec.go?s=6559:7169#L231\" rel=\"nofollow noreferrer\">golang.org/src/os/exec/exec.go?s=6559:7169#L231</a>"}], "tags": [], "owner": {"reputation": 3824, "user_id": 2728768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb82b13cda86d3b821fa44100335ddf?s=128&d=identicon&r=PG", "display_name": "thoeni", "link": "https://stackoverflow.com/users/2728768/thoeni"}, "is_accepted": true, "score": 3, "last_activity_date": 1477412154, "last_edit_date": 1495542744, "creation_date": 1477409334, "answer_id": 40243948, "question_id": 40243197, "link": "https://stackoverflow.com/questions/40243197/start-detached-command-with-redirect-to-file/40243948#40243948", "title": "Start detached command with redirect to file", "body": "<p>Maybe you can try to use this: <a href=\"https://stackoverflow.com/a/28918814/2728768\">https://stackoverflow.com/a/28918814/2728768</a></p>\n\n<p>Opening a file (and <code>os.File</code> implements <code>io.Writer</code>), and then passing it as the <code>command.Stdout</code> could do the trick:</p>\n\n<pre><code>func main() {\n    command := exec.Command(\"./tmp/test.sh\")\n    f, err := os.OpenFile(\"/tmp/out\", os.O_RDWR|os.O_CREATE|os.O_APPEND, 0666)\n    if err != nil {\n        fmt.Printf(\"error opening file: %v\", err)\n    }\n    defer f.Close()\n    // On this line you're going to redirect the output to a file\n    command.Stdout = f\n    if err := command.Start(); err != nil {\n        fmt.Fprintln(os.Stderr, \"Command failed.\", err)\n        os.Exit(1)\n    }\n\n    fmt.Println(\"Process ID:\", command.Process.Pid)\n}\n</code></pre>\n\n<p>Not sure this could be a viable solution for your case. I've tried it locally and it seems working... remember that your user should be able to create/update the file.</p>\n"}, {"comments": [{"owner": {"reputation": 1166, "user_id": 211195, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/47ffd6538b8c1694db320e07af4397ff?s=128&d=identicon&r=PG", "display_name": "rosencreuz", "link": "https://stackoverflow.com/users/211195/rosencreuz"}, "edited": false, "score": 0, "creation_date": 1477579159, "post_id": 40244435, "comment_id": 67833262, "body": "Thanks for the answer. Although nothing wrong with yours, I&#39;m going with the answer from @thoeni, because it&#39;s single solution for windows and linux which is more convenient for me."}, {"owner": {"reputation": 354, "user_id": 2169951, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fecf52737a2b6902cd7e8e9abb4f0d7d?s=128&d=identicon&r=PG", "display_name": "M. Gopal", "link": "https://stackoverflow.com/users/2169951/m-gopal"}, "edited": false, "score": 0, "creation_date": 1593267810, "post_id": 40244435, "comment_id": 110722498, "body": "This is good if we need to use the os provided stdOut and file redirection, After trigger no need an another go process running on top of the actual process. Thanks"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1477412019, "last_edit_date": 1477412019, "creation_date": 1477410716, "answer_id": 40244435, "question_id": 40243197, "link": "https://stackoverflow.com/questions/40243197/start-detached-command-with-redirect-to-file/40244435#40244435", "title": "Start detached command with redirect to file", "body": "<p>You may start a shell which executes your command / app, and you may redirect its output to a file. The shell will continue to run and execute your script / app even if your Go app exits.</p>\n\n<p>Example:</p>\n\n<pre><code>cmd := exec.Command(\"sh\", \"-c\", \"/tmp/test.sh &gt; /tmp/out\")\nif err := cmd.Start(); err != nil {\n    panic(err)\n}\nfmt.Println(\"Process ID:\", cmd.Process.Pid)\n</code></pre>\n\n<p>Test it with this simple Go app (replace <code>/tmp/test.sh</code> with the name of the executable binary you compile this into):</p>\n\n<pre><code>package main\nimport (\"fmt\"; \"time\")\nfunc main() {\n    for i := 0; i &lt; 10; i++ {\n        fmt.Printf(\"%d.: %v\\n\", i, time.Now())\n        time.Sleep(time.Second)\n    }\n}\n</code></pre>\n\n<p>This app simply prints a line to the standard output once every second. You can see how the output file is being written e.g. with <code>tail -f /tmp/out</code>.</p>\n\n<p>Note that you may use other shells to execute your scripts to your liking (and to what the <code>test.sh</code> script dictates).</p>\n\n<p>For example to use <code>bash</code>:</p>\n\n<pre><code>cmd := exec.Command(\"/bin/bash\", \"-c\", \"/tmp/test.sh &gt; /tmp/out\")\n// rest is unchanged\n</code></pre>\n\n<p>Note that the command to be executed by the shell is passed as a single <code>string</code> argument, and it is not broken down into multiple as you would do it if you were to execute it directly in the command prompt.</p>\n"}], "owner": {"reputation": 1166, "user_id": 211195, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/47ffd6538b8c1694db320e07af4397ff?s=128&d=identicon&r=PG", "display_name": "rosencreuz", "link": "https://stackoverflow.com/users/211195/rosencreuz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1163, "favorite_count": 1, "accepted_answer_id": 40243948, "answer_count": 2, "score": 2, "last_activity_date": 1477412154, "creation_date": 1477407231, "question_id": 40243197, "link": "https://stackoverflow.com/questions/40243197/start-detached-command-with-redirect-to-file", "title": "Start detached command with redirect to file", "body": "<p>I'm trying to start a command in a detached process so that it can continue after go program exits. I need to redirect the output of the command to a file.</p>\n\n<p>What I need is something like this:</p>\n\n<pre><code>func main() {\n    command := exec.Command(\"/tmp/test.sh\", \"&gt;\", \"/tmp/out\")\n\n    if err := command.Start(); err != nil {\n        fmt.Fprintln(os.Stderr, \"Command failed.\", err)\n        os.Exit(1)\n    }\n\n    fmt.Println(\"Process ID:\", command.Process.Pid)\n}\n</code></pre>\n\n<p>Obviously such redirect doesn't work. As I immediately exit from the program after starting the long running command, I cannot open a file and bind it to the Stdout.</p>\n\n<p>Is there any way to achieve such a redirect?</p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1477407194, "post_id": 40243054, "comment_id": 67748425, "body": "At the endpoint where it is created."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1477407454, "post_id": 40243054, "comment_id": 67748607, "body": "If there&#39;s no clear point where the channel should be closed, why are you closing it?"}, {"owner": {"reputation": 2118, "user_id": 6360083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1f8b36d7776a9f46b9206cdfa036c38?s=128&d=identicon&r=PG&f=1", "display_name": "Techradar", "link": "https://stackoverflow.com/users/6360083/techradar"}, "edited": false, "score": 0, "creation_date": 1477408564, "post_id": 40243054, "comment_id": 67749414, "body": "Having a clear point of where the channel should be closed would also mean to notify the other endpoint so it won&#39;t send any new messages to it, right? Thats the problem which seems to be solved pretty well with the paradigm that the sender should close the channel... so the only way to solve is to not use bidirectional channels."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1477408858, "post_id": 40243054, "comment_id": 67749646, "body": "If both participants may signal &quot;no more messages&quot;, that warrants 2 channels (or other means, e.g. special &quot;no more messages&quot; message)."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1477409851, "post_id": 40243054, "comment_id": 67750367, "body": "The sender closes the channel. A receiver with a bidirectional channel should not close the channel."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 1, "creation_date": 1477418500, "post_id": 40243054, "comment_id": 67755628, "body": "you&#39;re not forced to close a channel in Go, there&#39;s nothing wrong with let it open"}, {"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 0, "creation_date": 1477446847, "post_id": 40243054, "comment_id": 67767194, "body": "Writing to or closing a closed channel will panic, so if both sides are potentially senders, you need to recover from those potential crashes.  Even if you check that the channel is still open before writing, there&#39;s still a race condition unless you use a mutex, which kind of defeats the point. A select statement will sometimes panic (the spec is ambiguous about what should happen, seems to depend on lexical order: <a href=\"https://play.golang.org/p/0oLAx68sX3\" rel=\"nofollow noreferrer\">1</a> <a href=\"https://play.golang.org/p/SWewpj40xv\" rel=\"nofollow noreferrer\">2</a>."}], "answers": [{"comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 2, "creation_date": 1477430213, "post_id": 40249652, "comment_id": 67762264, "body": "Surely golang channels are bidirectional, even the language spec states that they are (unless you specify a direction as part of its type)"}, {"owner": {"reputation": 2118, "user_id": 6360083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1f8b36d7776a9f46b9206cdfa036c38?s=128&d=identicon&r=PG&f=1", "display_name": "Techradar", "link": "https://stackoverflow.com/users/6360083/techradar"}, "edited": false, "score": 0, "creation_date": 1478263537, "post_id": 40249652, "comment_id": 68094311, "body": "Thanks for your answer and besides the statement, that go doesnt have bidirectional channels you got some interesting input here. I didnt knew that the garbage collector would collect unclosed channels because I thought they could not be forced to be closed from the outside. It doesnt feel good to not have control over what exactly happens so I stay with using channels strictly in a single-direction way and open up two for such purposes."}], "tags": [], "owner": {"reputation": 8073, "user_id": 2852624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/682806d261e4f00f77aa8633689a9558?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias247", "link": "https://stackoverflow.com/users/2852624/matthias247"}, "is_accepted": true, "score": 1, "last_activity_date": 1477429404, "creation_date": 1477429404, "answer_id": 40249652, "question_id": 40243054, "link": "https://stackoverflow.com/questions/40243054/go-which-of-channels-endpoints-has-to-close-the-channel-when-its-bidirectional/40249652#40249652", "title": "go: which of channels endpoints has to close the channel when its bidirectional?", "body": "<p>The question is a little bit hard to interpret since go does not have bidirectional channels. Data flows only in a single direction - from a writer to a reader.</p>\n\n<p>What you can have in Go is multiple readers or writers on a channel. Whether this makes sense depends a little bit on the context. If you have multiple writers you would need some kind of synchronization for the close operation, e.g. a mutex. However you would then also need to lock this before each write operation in order to ensure that you don't write on a closed channel. If you don't really need the information that the channel was closed on receiver side you could also simply omit the close, as the garbage collector will also collect unclosed channels just fine.</p>\n"}], "owner": {"reputation": 2118, "user_id": 6360083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1f8b36d7776a9f46b9206cdfa036c38?s=128&d=identicon&r=PG&f=1", "display_name": "Techradar", "link": "https://stackoverflow.com/users/6360083/techradar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 40249652, "answer_count": 1, "score": -1, "last_activity_date": 1477429404, "creation_date": 1477406849, "question_id": 40243054, "link": "https://stackoverflow.com/questions/40243054/go-which-of-channels-endpoints-has-to-close-the-channel-when-its-bidirectional", "title": "go: which of channels endpoints has to close the channel when its bidirectional?", "body": "<p>Due to Go's philosophy a channel should be closed by the sender only. When a channel is bidirectional where should it be closed?</p>\n"}, {"tags": ["go", "interface", "dry", "go-interface"], "comments": [{"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "reply_to_user": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 1, "creation_date": 1477404521, "post_id": 40242142, "comment_id": 67746439, "body": "@Thilo, I&#39;m just trying to keep it simple to not to hide the meaning of the question. Definitely it is possible if I want to return pre-known value."}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 2, "creation_date": 1477405307, "post_id": 40242142, "comment_id": 67747094, "body": "I know you&#39;ve rewritten this to try to make it more abstract, but it now doesn&#39;t compile (or actually make sense; you can&#39;t square an <code>Aa</code> as you&#39;ve written it). It still very much looks like you&#39;re misusing interfaces. What&#39;s your actual interface? Are you sure it&#39;s <i>really</i> an interface, and not a class in disguise? (Remember, Go is not object oriented. If you try to reinvent classes, you will fight the language all day.)"}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "reply_to_user": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1477408423, "post_id": 40242142, "comment_id": 67749321, "body": "@RobNapier, I understand your point. so rolled back my changes with a disclaimer to consistent to the answer which solved my issue."}], "answers": [{"comments": [{"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1477404961, "post_id": 40242265, "comment_id": 67746829, "body": "Got it. I confused you guys with my question. I have edited it to be clearer. thanks!"}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "reply_to_user": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1477405040, "post_id": 40242265, "comment_id": 67746873, "body": "I&#39;ll write up the difference, but there&#39;s no difference. You just want a struct full of methods rather than as struct full of strings."}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": false, "score": 3, "last_activity_date": 1477404531, "creation_date": 1477404531, "answer_id": 40242265, "question_id": 40242142, "link": "https://stackoverflow.com/questions/40242142/how-to-keep-code-dry-in-golang/40242265#40242265", "title": "How to keep code DRY in Golang", "body": "<p>This looks very much like an misuse of interfaces. Interfaces are not a replacement for classes; they're an expression of what a type can <em>do</em>. What you have here is data. Store data in structs.</p>\n\n<pre><code>type Animal struct {\n    kingdom string\n    phylum  string\n    family  string\n}\n\nvar wolf = Animal{\"Animalia\", \"Chordata\", \"Canidae\"}\nvar tiger = wolf\ntiger.family = \"Felidae\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 1, "creation_date": 1477408522, "post_id": 40242308, "comment_id": 67749388, "body": "I am very grateful to you."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 13, "last_activity_date": 1477404640, "creation_date": 1477404640, "answer_id": 40242308, "question_id": 40242142, "link": "https://stackoverflow.com/questions/40242142/how-to-keep-code-dry-in-golang/40242308#40242308", "title": "How to keep code DRY in Golang", "body": "<p>This is classical composition:</p>\n\n<pre><code>type Wolf struct {\n    Animalia\n    Chordata\n    Canidae\n}\ntype Tiger struct {\n    Animalia\n    Chordata\n    Felidae\n}\n\ntype Animalia struct{}\n\nfunc (Animalia) Kingdom() string { return \"Animalia\" }\n\ntype Chordata struct{}\n\nfunc (Chordata) Phylum() string { return \"Chordata\" }\n\ntype Canidae struct{}\n\nfunc (Canidae) Family() string { return \"Canidae\" }\n\ntype Felidae struct{}\n\nfunc (Felidae) Family() string { return \"Felidae\" }\n\nfunc main() {\n    w := Wolf{}\n    t := Tiger{}\n    fmt.Println(w.Kingdom(), w.Phylum(), w.Family())\n    fmt.Println(t.Kingdom(), t.Phylum(), t.Family())\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/Jp22N2IuHL\">https://play.golang.org/p/Jp22N2IuHL</a>.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7174053"}, "edited": false, "score": 1, "creation_date": 1512669590, "post_id": 40261519, "comment_id": 82362059, "body": "The issue with your example is the exact one that I am currently struggling with continuing to learn and work with Go - you inherit the Person in the Speaker which is totally fine, but you write method for speaker and not for person which means there is no DRY and you write a ton of code over and over again."}], "tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 3, "last_activity_date": 1512729103, "last_edit_date": 1512729103, "creation_date": 1477482575, "answer_id": 40261519, "question_id": 40242142, "link": "https://stackoverflow.com/questions/40242142/how-to-keep-code-dry-in-golang/40261519#40261519", "title": "How to keep code DRY in Golang", "body": "<p>Since I'm interested in the feature I have read a few articles about the topic and aggregated it to several reference points.</p>\n\n<h2>Embedding</h2>\n\n<p>The feature named \"embedding\". And it solves the issue with repeated methods implementations. Base syntax:</p>\n\n<pre><code>type Person struct {\n    Name string\n}\n\ntype Speaker struct { // Speaker is an abstract concept it has no name\n    *Person // There is a type without field name. It is Anonymous.\n}\n</code></pre>\n\n<h2>Wrapping and decoration</h2>\n\n<p>Yes, there is no OOP but code must be DRY anyway. The clearest way to think about the feature is take this as wrapping structs with methods. So the most veracious way to describe anonymous fields is \"decorator\" pattern (well known for Pythonistas).</p>\n\n<pre><code>func (a *Speaker) Introduce(){ // But speaker can introduce itself\n    fmt.Println(a.Name) // We have direct access to a wrapped struct attributes.\n}\n</code></pre>\n\n<h2>Combining and overriding</h2>\n\n<p>Also we can combine methods implemented on a structs</p>\n\n<pre><code>func (s Speaker) Speak() string {\n    return \"Blah-blah\"\n}\n\ntype Den struct { // Combine Person and Speaker under Den struct\n    Person\n    Speaker\n}\n\nfunc (d Den) Speak() string { // Override Speak method only for Dennis \n    return \"I'm quit!\"\n}\n\nfunc main() {\n    den := Den{Person: Person{Name: \"Dennis\",}}\n    mike := Speaker{Person: Person{Name: \"Michael\",}}\n\n    fmt.Println(den.Introduce())\n    fmt.Println(den.Speak())\n    fmt.Println(mike.Introduce())\n    fmt.Println(mike.Speak())\n}\n</code></pre>\n\n<p>In this way we can avoid implementation of each required method for each type.</p>\n\n<h2>Interfaces</h2>\n\n<p>Same thing with interfaces. But if several interfaces are combined it means just that we don't need to declare methods which already declared in used interfaces.</p>\n\n<p><a href=\"https://play.golang.org/p/EbJjzpCaH_\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<p><a href=\"http://dennissuratna.com/using-anonymous-field-to-extend-in-go/\" rel=\"nofollow noreferrer\">Dennis Suratna's Blog article</a></p>\n\n<p><a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">Docs</a></p>\n"}], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2151, "favorite_count": 3, "accepted_answer_id": 40242308, "answer_count": 3, "score": 11, "last_activity_date": 1512729103, "creation_date": 1477404209, "last_edit_date": 1592644375, "question_id": 40242142, "link": "https://stackoverflow.com/questions/40242142/how-to-keep-code-dry-in-golang", "title": "How to keep code DRY in Golang", "body": "<h3>EDIT++:</h3>\n<p>How to not to repeat my code in Go?</p>\n<pre><code>type Animal interface {\n    Kingdom() string\n    Phylum() string\n    Family() string\n}\n\ntype Wolf struct {}\ntype Tiger struct {}\n\nfunc (w Wolf) Kingdom() string {return &quot;Animalia&quot;}\nfunc (w Wolf) Phylum() string {return &quot;Chordata&quot;}\nfunc (w Wolf) Family() string {return &quot;Canidae&quot;}\n</code></pre>\n<p>I implemented a three methods for <code>Wolf</code> type and I need to implement all the methods for <code>Tiger</code> type to implement the interface. But <code>Kingdom</code> and <code>Phylum</code> methods are the same for both types. Is it somehow possible to implement only <code>Family</code> method for <code>Tiger</code> type:</p>\n<pre><code>func (t Tiger) Family() string {return &quot;Felidae&quot;}\n</code></pre>\n<p>and not to repeat all the three methods for each type?</p>\n<h3>Disclaimer</h3>\n<p><em>Please don't be confused with simple string returns in the methods, in a real case I need different method implementations not just pre-defined values. Using this silly style I want to avoid of defiling your brains. So skip methods at all is not the way.</em> Thanks</p>\n"}, {"tags": ["go", "types", "interface"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1477395882, "post_id": 40238977, "comment_id": 67739879, "body": "Use an interface when you may way to change out the underlying implementation, but not change all the code that uses it."}, {"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1594374268, "post_id": 40238977, "comment_id": 111109843, "body": "What is the  benefit of using an interface? Decouple code. See <a href=\"https://stackoverflow.com/a/62297796/12817546\">stackoverflow.com/a/62297796/12817546</a>. Call a method \u201cdynamically\u201d. See <a href=\"https://stackoverflow.com/a/62336440/12817546\">stackoverflow.com/a/62336440/12817546</a>. Access a Go package. See <a href=\"https://stackoverflow.com/a/62278078/12817546\">stackoverflow.com/a/62278078/12817546</a>. Assign any value to a variable. See <a href=\"https://stackoverflow.com/a/62337836/12817546\">stackoverflow.com/a/62337836/12817546</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "edited": false, "score": 0, "creation_date": 1477396977, "post_id": 40239077, "comment_id": 67740608, "body": "Thank you. Can you please say a brief real world example? It is okay, just I can&#39;t imagine how can I use the interface{} benefits in a real world problem."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "edited": false, "score": 0, "creation_date": 1477397119, "post_id": 40239077, "comment_id": 67740705, "body": "@PumpkinSeed <a href=\"https://golang.org/pkg/fmt/#Println\" rel=\"nofollow noreferrer\"><code>fmt.Println()</code></a> which you call in your example also takes values of <code>interface{}</code> type, which means you can pass any value to it."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1477412823, "last_edit_date": 1495541797, "creation_date": 1477395875, "answer_id": 40239077, "question_id": 40238977, "link": "https://stackoverflow.com/questions/40238977/golang-interface-benefits/40239077#40239077", "title": "Golang interface benefits", "body": "<p>If you're always want to print <code>string</code> values, then the first using <code>[]interface{}</code> is not better at all, it's worse as you lose some compile-time checking: it won't warn you if you pass a slice which contains values other than <code>string</code>s.</p>\n\n<p>If you want to print values other than <code>string</code>s, then the second with <code>[]string</code> wouldn't even compile.</p>\n\n<p>For example the first also handles this:</p>\n\n<pre><code>PrintAll([]interface{}{\"one\", 2, 3.3})\n</code></pre>\n\n<p>While the 2nd would give you a compile-time error:</p>\n\n<blockquote>\n  <p>cannot use []interface {} literal (type []interface {}) as type []string in argument to PrintAll</p>\n</blockquote>\n\n<p>The 2nd gives you compile-time guarantee that only a slice of type <code>[]string</code> is passed; should you attempt to pass anything other will result in compile-time error.</p>\n\n<p>Also see related question: <a href=\"https://stackoverflow.com/questions/39092925/why-are-interfaces-needed-in-golang\">Why are interfaces needed in Golang?</a></p>\n"}], "owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "accepted_answer_id": 40239077, "answer_count": 1, "score": 2, "last_activity_date": 1477412823, "creation_date": 1477395527, "last_edit_date": 1477412619, "question_id": 40238977, "link": "https://stackoverflow.com/questions/40238977/golang-interface-benefits", "title": "Golang interface benefits", "body": "<p>I read about the interfaces a lot and I think I understand how it works. I read about the <code>interface{}</code> type and use it to take an argument of function. It is clear. My question (and what I don't understand) is what is my benefit if I am using it. It is possible I didn't get it entirely but for example I have this: </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc PrintAll(vals []interface{}) {\n    for _, val := range vals {\n        fmt.Println(val)\n    }\n}\n\nfunc main() {\n    names := []string{\"stanley\", \"david\", \"oscar\"}\n    vals := make([]interface{}, len(names))\n    for i, v := range names {\n        vals[i] = v\n    }\n    PrintAll(vals)\n}\n</code></pre>\n\n<p>Why is it better than this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc PrintAll(vals []string) {\n    for _, val := range vals {\n        fmt.Println(val)\n    }\n}\n\nfunc main() {\n    names := []string{\"stanley\", \"david\", \"oscar\"}\n    PrintAll(names)\n}\n</code></pre>\n"}, {"tags": ["javascript", "jquery", "html", "forms", "go"], "comments": [{"owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "edited": false, "score": 0, "creation_date": 1477390029, "post_id": 40236915, "comment_id": 67736215, "body": "Just from skimming over the echo docs, there seem to be a function on <code>echo.Context</code>: <code>Redirect(int, string) error</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1030, "user_id": 1108547, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0316db582650c52c8aa85bdf621ae216?s=128&d=identicon&r=PG", "display_name": "Alexander W", "link": "https://stackoverflow.com/users/1108547/alexander-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1477395779, "creation_date": 1477395779, "answer_id": 40239054, "question_id": 40236915, "link": "https://stackoverflow.com/questions/40236915/page-redirect-when-submitting-a-form/40239054#40239054", "title": "Page redirect when submitting a form", "body": "<p>As mentioned in the comments, Echo have another response handler called \"Redirect\". <a href=\"https://github.com/labstack/echo/blob/master/context.go#L455\" rel=\"nofollow\">Source</a>.</p>\n\n<p>It takes a response code (must be between 300 &amp; 307) as the first argument and a URL as the second. It handles the header and sends the appropriate header-values to the User-Agent (in your case probably the web browser).</p>\n\n<p>Replace the last line: </p>\n\n<p><code>return ctx.String(http.StatusOK, \"worked\")</code> </p>\n\n<p>with </p>\n\n<p><code>return ctx.Redirect(http.StatusSeeOther, \"http://your.new.url.here?foo=bar\")</code></p>\n"}], "owner": {"reputation": 19, "user_id": 6859683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a17f8091eeacfe4a5f0ee75e442d832?s=128&d=identicon&r=PG&f=1", "display_name": "computerNoob", "link": "https://stackoverflow.com/users/6859683/computernoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477395779, "creation_date": 1477389536, "last_edit_date": 1477394584, "question_id": 40236915, "link": "https://stackoverflow.com/questions/40236915/page-redirect-when-submitting-a-form", "title": "Page redirect when submitting a form", "body": "<p>Working on getting a form to send data to mysql when submitted, using API calls. I currently have the form submitted successfully and displaying a message on a blank page simply displaying \"worked\". I am using GO as my backend, and using bootstrap and HTML for the front end</p>\n\n<p>The issue I am having is trying to get the page to redirect to a url instead of displaying that message. I have tried to implement something in the HTML form however it seems to be overridden by the function in my GO application</p>\n\n<p>This is the current GO function which handles the process:</p>\n\n<pre><code>func insertv4Reservation(ctx echo.Context) error {\nstmt, err := ipamDB.Prepare(ipamSQL.Insertv4HostsStatement)\nif err != nil {\n    log.Fatal(err)\n}\ndefer stmt.Close()\n\nvar identifier_value = ctx.FormValue(\"dhcp_identifier_value\")\nvar identifier_type = 0 //value 0 corresponds to hw-address,\nvar dhcp_subnet_id  = ctx.FormValue(\"dhcp4_subnet_id\")\nvar ipv4_reservation = ctx.FormValue(\"octet1\")\nvar hostname = ctx.FormValue(\"hostname\")\nvar next_server = ctx.FormValue(\"dhcp4_next_server1\")\n//var dhcp4_ser_host = ctx.FormValue(\"dhcp4_server_hostname\")\n//var dhcp4_bf_name = ctx.FormValue(\"dhcp4_boot_file_name\")\n\nres, err := stmt.Exec(identifier_value, identifier_type, dhcp_subnet_id, ipv4_reservation, hostname, next_server)\nif err != nil {\n    log.Fatal(err)\n}\n\nlastId, err := res.LastInsertId()\nif err != nil {\n    log.Fatal(err)\n}\n\nrowCnt, err := res.RowsAffected()\nif err != nil {\n    log.Fatal(err)\n}\n\nlog.Printf(\"ID = %d, affected = %d\\n\", lastId, rowCnt)\nreturn ctx.String(http.StatusOK, \"worked\")\n</code></pre>\n\n<p>please bear in mind I am relatively new to GO, so please do comment any code given</p>\n"}, {"tags": ["json", "string", "elasticsearch", "go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1477389177, "creation_date": 1477389177, "answer_id": 40236787, "question_id": 40236700, "link": "https://stackoverflow.com/questions/40236700/elasticsearch-return-raw-json-with-golang-beats/40236787#40236787", "title": "Elasticsearch return raw JSON with Golang Beats", "body": "<p><a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow\"><code>json.RawMessage</code></a> is a byte slice:</p>\n\n<pre><code>type RawMessage []byte\n</code></pre>\n\n<p>You can convert a byte slice to a <code>string</code> with a simple type <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow\">conversion</a>:</p>\n\n<pre><code>var result SearchResults\n// ...\nfor _, v := range result.Hits {\n    fmt.Println(\"Total:\", v.Total, \"Hits:\", string(v.Hits))\n}\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>fmt.Printf(\"Total: %d, Hits: %s\\n\", v.Total, v.Hits)\n</code></pre>\n\n<p>See this example:</p>\n\n<pre><code>var raw json.RawMessage\nraw = json.RawMessage(`something raw`)\nfmt.Println(raw)\nfmt.Println(string(raw))\nfmt.Printf(\"%s\\n\", raw)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/KbEqfQV0sk\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>[115 111 109 101 116 104 105 110 103 32 114 97 119]\nsomething raw\nsomething raw\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7068692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c245502887c50cd18a9fb5908371d5e?s=128&d=identicon&r=PG&f=1", "display_name": "plosxh", "link": "https://stackoverflow.com/users/7068692/plosxh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 616, "favorite_count": 0, "accepted_answer_id": 40236787, "answer_count": 1, "score": 3, "last_activity_date": 1477403819, "creation_date": 1477388956, "last_edit_date": 1477403819, "question_id": 40236700, "link": "https://stackoverflow.com/questions/40236700/elasticsearch-return-raw-json-with-golang-beats", "title": "Elasticsearch return raw JSON with Golang Beats", "body": "<p>I'm working on a beat that interrogate our elastic search, the goal is to get elements in elastics to modify them to avoid duplication.</p>\n\n<p>I've written a search and it works:</p>\n\n<pre><code>client,err :=elasticsearch.NewClient(elasticsearch.ClientSettings{URL:host,Index:indexSel,Username: username,Password: password,Timeout:  60 * time.Second,}, nil)\nif err != nil {\n    log.Fatal(err)\n}\n\nparams := map[string]string{\n    \"q\": \"_id:\"+maref,\n}\n_, resp, err := client.SearchURI(index, \"\", params)\n\nif err != nil {\n    log.Fatal(err)\n    return\n} else {\n    fmt.Println(string(resp))\n}\n</code></pre>\n\n<p>And here is the function from the elastic <code>api.go</code>:</p>\n\n<pre><code>func (es *Connection) SearchURI(index string, docType string, params map[string]string) (int, *SearchResults, error) {\nstatus, resp, err := es.apiCall(\"GET\", index, docType, \"_search\", \"\", params, nil)\nif err != nil {\n    return status, nil, err\n}\nresult, err := readSearchResult(resp)\n    return status, result, err\n}\n\n\nfunc readSearchResult(obj []byte) (*SearchResults, error) {\n    var result SearchResults\n    if obj == nil {\n        return nil, nil\n    }\n\n    err := json.Unmarshal(obj, &amp;result)\n    if err != nil {\n        return nil, err\n    }\n    return &amp;result, err\n}\n</code></pre>\n\n<p>With the following types:</p>\n\n<pre><code>type SearchResults struct {\n    Took   int                        `json:\"took\"`\n    Shards json.RawMessage            `json:\"_shards\"`\n    Hits   Hits                       `json:\"hits\"`\n    Aggs   map[string]json.RawMessage `json:\"aggregations\"`\n}\n\ntype Hits struct {\n    Total int\n    Hits  []json.RawMessage `json:\"hits\"`\n}\n</code></pre>\n\n<p>For now the answer is a raw JSON:</p>\n\n<pre><code>&amp;{11 [123 34 116 111 116 97 108 34 58 53 44 34 115 117 99 99 101 115 115 102 117 108 34 58 53 44 34 102 97 105 108 101 100 34 58 48 125] {1 [[123 34 95 105 110 100 101 120 34 58 34 99 111 112 105 108 98 101 97 116 45 50 48 49 54 46 49 48 46 50 53 34 44 34 95 116 121 112 101 34 58 34 73 110 99 105 100 101 110 116 34 44 34 95 105 100 34 58 34 65 86 102 54 55 69 103 109 74 66 45 119 85 116 103 82 99 90 113 97 34 44 34 95 115 99 111 114 101 34 58 49 46 48 44 34 95 115 111 117 114 99 101 34 58 123 34 64 116 105 109 101 115 116 97 109 112 34 58 34 50 48 49 54 45 49 48 45 50 53 84 48 56 58 49 54 58 53 55 46 53 53 57 90 34 44 34 97 103 101 110 116 95 105 100 34 58 49 53 44 34 98 101 97 116 34 58 123 34 104 111 115 116 110 97 109 101 34 58 34 53 55 99 53 99 49 57 49 101 48 100 57 34 44 34 110 97 109 101 34 58 34 53 55 99 53 99 49 57 49 101 48 100 57 34 125 44 34 100 101 115 99 114 105 112 116 105 111 110 34 58 34 101 108 97 115 116 105 99 34 44 34 102 105 110 97 108 99 108 97 115 115 34 58 34 34 44 34 105 100 34 58 34 73 45 48 48 53 56 50 54 34 44 34 111 114 103 95 105 100 34 58 49 55 44 34 111 114 103 95 110 97 109 101 34 58 34 83 104 97 109 34 44 34 112 114 105 111 114 105 116 121 34 58 52 44 34 114 101 102 101 114 101 110 99 101 34 58 34 73 45 48 48 53 56 50 54 34 44 34 115 116 97 114 116 95 100 97 116 101 34 58 34 50 48 49 54 45 49 48 45 50 53 84 49 48 58 49 54 58 53 54 46 56 56 49 55 55 52 49 43 48 50 58 48 48 34 44 34 115 116 97 116 117 115 34 58 34 97 115 115 105 103 110 101 100 34 44 34 116 116 111 34 58 48 44 34 116 116 111 95 49 48 48 95 116 114 105 103 103 101 114 101 100 34 58 48 44 34 116 116 114 34 58 48 44 34 116 116 114 95 49 48 48 95 116 114 105 103 103 101 114 101 100 34 58 48 44 34 116 121 112 101 34 58 34 73 110 99 105 100 101 110 116 34 125 125]]} map[]}\n</code></pre>\n\n<p>So my question is:</p>\n\n<p>How can I convert the result to ascii?\nI've read it's probably due to the <code>json.RawMessage</code> type that doesn't convert JSON but I can't find how to convert it.</p>\n\n<p>Thanks by advance,</p>\n\n<p>Plosxh.</p>\n\n<p>EDIT : Solution:</p>\n\n<p>Thx to icza, here's my solution I change my <code>\"fmt.Println(resp)\"</code> into:</p>\n\n<pre><code>for _, v := range resp.Hits.Hits {\n    fmt.Println(string(v))\n}\n</code></pre>\n\n<p>It works like a charm!</p>\n\n<p>Edit 2 :\nI had to re-create a whole type en json.Unmarshal \"resp.Hits.Hits\" in order to use it like a regular json. </p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 2611792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f286f01d47274693d53ed50fa6bafd4?s=128&d=identicon&r=PG", "display_name": "&#201;ric Robert", "link": "https://stackoverflow.com/users/2611792/%c3%89ric-robert"}, "is_accepted": false, "score": 0, "last_activity_date": 1480555541, "creation_date": 1480555541, "answer_id": 40901137, "question_id": 40235755, "link": "https://stackoverflow.com/questions/40235755/golang-aws-s3-nosuchkey-the-specified-key-does-not-exist/40901137#40901137", "title": "Golang Aws S3 NoSuchKey: The specified key does not exist", "body": "<p>I had the same problem with recent versions of the library. Sometimes, the object key will be prefixed with a \"./\" that the SDK will remove by default making the download fail.</p>\n\n<p>Try adding this to your <code>aws.Config</code> and see if it helps:</p>\n\n<pre><code>config := aws.Config{\n    ...\n    DisableRestProtocolURICleaning: aws.Bool(true),\n}\n</code></pre>\n\n<p>I submitted an <a href=\"https://github.com/aws/aws-sdk-go/issues/970\" rel=\"nofollow noreferrer\">issue</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 7068602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdbf322806eb5a7203b41a37e8f1ff01?s=128&d=identicon&r=PG&f=1", "display_name": "Xu Shang", "link": "https://stackoverflow.com/users/7068602/xu-shang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1002, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510003922, "creation_date": 1477386271, "last_edit_date": 1510003922, "question_id": 40235755, "link": "https://stackoverflow.com/questions/40235755/golang-aws-s3-nosuchkey-the-specified-key-does-not-exist", "title": "Golang Aws S3 NoSuchKey: The specified key does not exist", "body": "<p>I'm trying to download Objects from S3, the following is my code:</p>\n\n<pre><code>func listFile(bucket, prefix string) error {\n    svc := s3.New(sess)\n    params := &amp;s3.ListObjectsInput{\n        Bucket: aws.String(bucket), // Required\n        Prefix: aws.String(prefix),\n    }\n    return svc.ListObjectsPages(params, func(p *s3.ListObjectsOutput, lastPage bool) bool {\n        for _, o := range p.Contents {\n            //log.Println(*o.Key)\n            log.Println(*o.Key)\n            download(bucket, *o.Key)\n            return true\n        }\n        return lastPage\n    })\n}\n\nfunc download(bucket, key string) {\n    logDir := conf.Cfg.Section(\"share\").Key(\"LOG_DIR\").MustString(\".\")\n    tmpLogPath := filepath.Join(logDir, bucket, key)\n    s3Svc := s3.New(sess)\n    downloader := s3manager.NewDownloaderWithClient(s3Svc, func(d *s3manager.Downloader) {\n        d.PartSize = 2 * 1024 * 1024 // 2MB per part\n    })\n    f, err := os.OpenFile(tmpLogPath, os.O_CREATE|os.O_WRONLY, 0644)\n    if _, err = downloader.Download(f, &amp;s3.GetObjectInput{\n        Bucket: aws.String(bucket),\n        Key:    aws.String(key),\n    }); err != nil {\n        log.Fatal(err)\n    }\n    f.Close()\n}\n\nfunc main() {\n    bucket := \"mybucket\"\n    key := \"myprefix\"\n    listFile(bucket, key)\n}\n</code></pre>\n\n<p>I can get the objects list in the function <code>listFile()</code>, but a 404 returned when call download, why?</p>\n"}, {"tags": ["string", "go", "binary", "binary-operators"], "comments": [{"owner": {"reputation": 3828, "user_id": 1432545, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9adeae2daceb6831a988d6c677db4847?s=128&d=identicon&r=PG&f=1", "display_name": "das_j", "link": "https://stackoverflow.com/users/1432545/das-j"}, "edited": false, "score": 0, "creation_date": 1477386015, "post_id": 40235464, "comment_id": 67733507, "body": "Can you add the imports to the sample? It helps a lot when trying to use <code>go doc</code> :)"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1477387950, "last_edit_date": 1495535568, "creation_date": 1477386721, "answer_id": 40235914, "question_id": 40235464, "link": "https://stackoverflow.com/questions/40235464/bitmasking-conversion-of-cpu-ids-with-go/40235914#40235914", "title": "Bitmasking conversion of CPU ids with Go", "body": "<p>What you're doing is essentially outputting the indices of the <code>\"1\"</code>'s in the binary representation from left-to-right, and starting index counting from the left (unusal).</p>\n\n<p>You can achieve the same using bitmasks and bitwise operators, without converting it to a binary string. And I would return a slice of indices instead of its formatted string, easier to work with.</p>\n\n<p>To test if the lowest (rightmost) bit is <code>1</code>, you can do it like <code>x&amp;0x01 == 1</code>, and to shift a whole number bitwise to the right: <code>x &gt;&gt;= 1</code>. After a shift, the rightmost bit \"disappears\", and the previously 2nd bit becomes the 1st, so you can test again with the same logic. You may loop until the number is greater than 0 (which means it sill has 1-bits).</p>\n\n<p>See this question for more examples of bitwise operations: <a href=\"https://stackoverflow.com/questions/28432398/difference-between-some-operators-golang/28433370#28433370\">Difference between some operators &quot;|&quot;, &quot;^&quot;, &quot;&amp;&quot;, &quot;&amp;^&quot;. Golang</a></p>\n\n<p>Of course if we test the rightmost bit and shift right, we get the bits (indices) in <em>reverse</em> order (compared to what you want), and the indices are counted from right, so we have to correct this before returning the result.</p>\n\n<p>So the solution looks like this:</p>\n\n<pre><code>func getCpuIds(cpuMap string) (r []int) {\n    ci, err := strconv.ParseInt(cpuMap, 0, 64)\n    if err != nil {\n        panic(err)\n    }\n\n    count := 0\n    for ; ci &gt; 0; count, ci = count+1, ci&gt;&gt;1 {\n        if ci&amp;0x01 == 1 {\n            r = append(r, count)\n        }\n    }\n\n    // Indices are from the right, correct it:\n    for i, v := range r {\n        r[i] = count - v - 1\n    }\n    // Result is in reverse order:\n    for i, j := 0, len(r)-1; i &lt; j; i, j = i+1, j-1 {\n        r[i], r[j] = r[j], r[i]\n    }\n\n    return\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/q44cd2HxXu\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[0 2 24]\n</code></pre>\n\n<p>If for some reason you need the result as a comma separated <code>string</code>, this is how you can obtain that:</p>\n\n<pre><code>buf := &amp;bytes.Buffer{}\nfor i, v := range cpuIds {\n    if i &gt; 0 {\n        buf.WriteString(\",\")\n    }\n    buf.WriteString(strconv.Itoa(v))\n}\ncpuIdsStr := buf.String()\nfmt.Println(cpuIdsStr)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/CVuj51G5BH\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>0,2,24\n</code></pre>\n"}], "owner": {"reputation": 4335, "user_id": 1898534, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XKxNa.jpg?s=128&g=1", "display_name": "PlagTag", "link": "https://stackoverflow.com/users/1898534/plagtag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 40235914, "answer_count": 1, "score": 2, "last_activity_date": 1477401737, "creation_date": 1477385407, "last_edit_date": 1477401737, "question_id": 40235464, "link": "https://stackoverflow.com/questions/40235464/bitmasking-conversion-of-cpu-ids-with-go", "title": "Bitmasking conversion of CPU ids with Go", "body": "<p>I have a mask that contains a binary counting of cpu_ids (<code>0xA00000800000</code> for 3 CPUs) which I want to convert into a <code>string</code> of comma separated cpu_ids: <code>\"0,2,24\"</code>.</p>\n\n<p>I did the following Go implementation (I am a Go starter). Is it the best way to do it? Especially the handling of byte buffers seems to be inefficient!</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main(){\n    cpuMap     := \"0xA00000800000\"\n    cpuIds     = getCpuIds(cpuMap)\n    fmt.Println(cpuIds)\n}\n\nfunc getCpuIds(cpuMap string) string {\n    // getting the cpu ids\n    cpu_ids_i, _ := strconv.ParseInt(cpuMap, 0, 64) // int from string\n    cpu_ids_b := strconv.FormatInt(cpu_ids_i, 2)    // binary as string\n\n    var buff bytes.Buffer\n    for i, runeValue := range cpu_ids_b {\n        // take care! go returns code points and not the string    \n        if runeValue == '1' {\n            //fmt.Println(bitString, i)\n            buff.WriteString(fmt.Sprintf(\"%d\", i))\n        }\n        if (i+1 &lt; len(cpu_ids_b)) &amp;&amp; (runeValue == '1') {\n            //fmt.Println(bitString)\n            buff.WriteString(string(\",\"))\n        }\n\n    }\n    cpuIds := buff.String()\n    // remove last comma\n    cpuIds = cpuIds[:len(cpuIds)-1]\n    //fmt.Println(cpuIds)\n    return cpuIds\n}\n</code></pre>\n\n<p>Returns: </p>\n\n<blockquote>\n  <p>\"0,2,24\"</p>\n</blockquote>\n"}, {"tags": ["go", "marshalling", "unmarshalling"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1477375953, "post_id": 40232098, "comment_id": 67727616, "body": "What would be wrong with reading the documentation of json.Marshal (<a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/json/#Marshal</a>)? It describes your main problem (export your fields!) in the paragraph &quot;The Go visibility rules...&quot; and is clear on cyclic data structures: &quot;JSON cannot represent cyclic data structures and Marshal does not handle them.&quot; (Maybe not your problem as &quot;sibling&quot; hints at a non-cyclic structure). Is it really faster/easier/more natural/better to ask on SO than read the official, complete and helpful documentation?"}], "answers": [{"tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": true, "score": 7, "last_activity_date": 1477374901, "creation_date": 1477374901, "answer_id": 40232339, "question_id": 40232098, "link": "https://stackoverflow.com/questions/40232098/marshal-recursive-types-in-go/40232339#40232339", "title": "Marshal recursive types in go", "body": "<p>Your problem is not with recursion, it's understand encapsulation with Golang, e.i. public and private members.\nIn order to encode in Go, your struct has to have public fields (starting with Uppercase):</p>\n\n<pre><code>type Dog struct {\n    Age     int\n    Sibling *Dog\n}\n</code></pre>\n\n<p>Full example: <a href=\"https://play.golang.org/p/eNdLaTfKtN\" rel=\"noreferrer\">https://play.golang.org/p/eNdLaTfKtN</a></p>\n"}], "owner": {"reputation": 497, "user_id": 3003363, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/eb34b5175fd0b3eb8259160eb3d1ae0c?s=128&d=identicon&r=PG&f=1", "display_name": "Ross", "link": "https://stackoverflow.com/users/3003363/ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1028, "favorite_count": 1, "closed_date": 1477376054, "accepted_answer_id": 40232339, "answer_count": 1, "score": 3, "last_activity_date": 1477374901, "creation_date": 1477373888, "question_id": 40232098, "link": "https://stackoverflow.com/questions/40232098/marshal-recursive-types-in-go", "closed_reason": "Duplicate", "title": "Marshal recursive types in go", "body": "<p>I want to Marshal and Unmarshal a recursive type in go something like this:</p>\n\n<pre><code>type Dog struct {\n    age int\n    sibling *Dog\n}\n</code></pre>\n\n<p>Is there any way to do this in golang? I tried with json.Marshal but it doesn't work. </p>\n"}, {"tags": ["json", "encryption", "go", "rsa", "decode"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4780955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-x6VZfsNx5bY/AAAAAAAAAAI/AAAAAAAAQ80/Upuy-T4hutg/photo.jpg?sz=128", "display_name": "Gentry Rolofson", "link": "https://stackoverflow.com/users/4780955/gentry-rolofson"}, "edited": false, "score": 1, "creation_date": 1477378205, "post_id": 40232379, "comment_id": 67728770, "body": "Thank you, unmarshal works perfectly your techniques are great thank you again."}, {"owner": {"reputation": 648, "user_id": 9323388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cef802072695bf44b64d63a6805c7901?s=128&d=identicon&r=PG&f=1", "display_name": "Margach Chris", "link": "https://stackoverflow.com/users/9323388/margach-chris"}, "edited": false, "score": 0, "creation_date": 1606908839, "post_id": 40232379, "comment_id": 115104024, "body": "A different way to build the solution, for information purposes only  <a href=\"https://gist.github.com/jshap70/259a87a7146393aab5819873a193b88c\" rel=\"nofollow noreferrer\">gist.github.com/jshap70/259a87a7146393aab5819873a193b88c</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 2, "last_activity_date": 1477375478, "last_edit_date": 1477375478, "creation_date": 1477375049, "answer_id": 40232379, "question_id": 40231805, "link": "https://stackoverflow.com/questions/40231805/storing-and-retrieving-rsa-encryption-key/40232379#40232379", "title": "Storing and retrieving RSA encryption key", "body": "<p>You need to Unmarshal it:</p>\n\n<pre><code>var data *rsa.PrivateKey\nerr = json.Unmarshal(serverKey, &amp;data)\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>And you may use</p>\n\n<pre><code>err = ioutil.WriteFile(\"secrets.json\", buf.Bytes(), 0666)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>serverKey, err := ioutil.ReadFile(\"secrets.json\")\n</code></pre>\n\n<p>See:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"crypto/rand\"\n    \"crypto/rsa\"\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n)\n\nfunc main() {\n    mimicPrivateKey, err := rsa.GenerateKey(rand.Reader, 2048)\n    if err != nil {\n        panic(err)\n    }\n    var buf bytes.Buffer\n    err = json.NewEncoder(&amp;buf).Encode(mimicPrivateKey)\n    if err != nil {\n        panic(err)\n    }\n    err = ioutil.WriteFile(\"secrets.json\", buf.Bytes(), 0666)\n    if err != nil {\n        panic(err)\n    }\n\n    serverKey, err := ioutil.ReadFile(\"secrets.json\")\n    if err != nil {\n        panic(err)\n    }\n    var data *rsa.PrivateKey\n    err = json.Unmarshal(serverKey, &amp;data)\n    if err != nil {\n        panic(err)\n    }\n    serverKeyPublic := data.PublicKey\n    fmt.Println(serverKeyPublic)\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4780955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-x6VZfsNx5bY/AAAAAAAAAAI/AAAAAAAAQ80/Upuy-T4hutg/photo.jpg?sz=128", "display_name": "Gentry Rolofson", "link": "https://stackoverflow.com/users/4780955/gentry-rolofson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1280, "favorite_count": 1, "accepted_answer_id": 40232379, "answer_count": 1, "score": 0, "last_activity_date": 1477394613, "creation_date": 1477372222, "last_edit_date": 1477394613, "question_id": 40231805, "link": "https://stackoverflow.com/questions/40231805/storing-and-retrieving-rsa-encryption-key", "title": "Storing and retrieving RSA encryption key", "body": "<p>I am trying to build an API, but to secure it properly I believe I need to go with RSA encryption for a private key stored on my server and a public key for the client. I have stored the generated private key into a JSON file, I plan to store on my server but to write to JSON, I needed to convert the type too <code>[]byte</code>. Now when I try to retrieve the private key to generate a public key, but it will not let me use type bytes for <code>*Publickey</code>\nThe only other way I can think of to accomplish this goal is to seed the random number generator, so I can have the seed a secret on my server and then my private key should always generate to the same thing, any help this this would be great.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"crypto/rand\"\n    \"crypto/rsa\"\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n)\n\nfunc main() {\n    mimicPrivateKey, err := rsa.GenerateKey(rand.Reader, 2048)\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n    buf := new(bytes.Buffer)\n    json.NewEncoder(buf).Encode(mimicPrivateKey)\n    secrets, _ := os.OpenFile(\"secrets.json\",    os.O_RDWR|os.O_APPEND|os.O_CREATE, 0666)\n    // Close the secrets file when the surrounding function exists\n\n    secrets.WriteString(buf.String())\n    secrets.Close()\n\n    secrets, _ = os.OpenFile(\"secrets.json\", os.O_RDWR, 0666)\n    serverKey, _ := ioutil.ReadAll(secrets)\n    if serverKey != nil {\n        fmt.Println(\"can not open key\")\n    }\n\n    serverKeyPublic := &amp;serverKey.PublicKey\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1477378657, "post_id": 40231761, "comment_id": 67729044, "body": "Do you want to <i>insert</i> to the beginning, or <i>overwrite</i> content at the beginning?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 6, "last_activity_date": 1477372553, "creation_date": 1477372553, "answer_id": 40231869, "question_id": 40231761, "link": "https://stackoverflow.com/questions/40231761/write-to-beginning-of-the-buffer-in-golang/40231869#40231869", "title": "Write to beginning of the buffer in Golang?", "body": "<p>Since the underlying <code>buf</code> not exported from <code>bytes.Buffer</code>, you may use: </p>\n\n<pre><code>buffer.WriteString(\"B\")\ns := buffer.String()\nbuffer.Reset()\nbuffer.WriteString(\"A\")\nbuffer.WriteString(s)\n</code></pre>\n\n<p>Try this <a href=\"https://play.golang.org/p/bUxFjbn3ek\" rel=\"noreferrer\">The Go Playground</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n)\n\nfunc main() {\n    var buffer bytes.Buffer\n    buffer.WriteString(\"B\")\n    s := buffer.String()\n    buffer.Reset()\n    buffer.WriteString(\"A\" + s)\n    fmt.Println(buffer.String())\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>AB\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 984, "user_id": 5303401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/903c091913c61d706eb066e1513a2438?s=128&d=identicon&r=PG&f=1", "display_name": "Ozan", "link": "https://stackoverflow.com/users/5303401/ozan"}, "edited": false, "score": 0, "creation_date": 1477383153, "post_id": 40234309, "comment_id": 67731708, "body": "+1 very detailed answer. I wonder if the slice is valid <code>... only until the next call to a method like Read, Write, Reset, or Truncate</code> or before buffer grow?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 984, "user_id": 5303401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/903c091913c61d706eb066e1513a2438?s=128&d=identicon&r=PG&f=1", "display_name": "Ozan", "link": "https://stackoverflow.com/users/5303401/ozan"}, "edited": false, "score": 1, "creation_date": 1477383811, "post_id": 40234309, "comment_id": 67732110, "body": "@ozy The internal slice of the <code>Buffer</code> will not grow by itself, only if you call certain methods on <code>Buffer</code>. But until you do, you&#39;re free to modify its content via the slice you acquired by calling <code>Byffer.Bytes()</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1477382876, "last_edit_date": 1477382876, "creation_date": 1477381914, "answer_id": 40234309, "question_id": 40231761, "link": "https://stackoverflow.com/questions/40231761/write-to-beginning-of-the-buffer-in-golang/40234309#40234309", "title": "Write to beginning of the buffer in Golang?", "body": "<p><em>Inserting</em> to the beginning is not possible, see Amd's answer for a \"workaround\". For <em>overwriting</em> content at the beginning, read on.</p>\n\n<p>Note that the internal byte slice <code>Buffer.buf</code> is not exported, but the method <a href=\"https://golang.org/pkg/bytes/#Buffer.Bytes\" rel=\"nofollow\"><code>Buffer.Bytes()</code></a> returns a slice sharing the same backing array as the <code>Buffer.buf</code> internal slice.</p>\n\n<p>This means if you create a new <a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"nofollow\"><code>bytes.Buffer</code></a> by calling <a href=\"https://golang.org/pkg/bytes/#NewBuffer\" rel=\"nofollow\"><code>Bytes.NewBuffer()</code></a>, and pass this slice after <em>reslicing</em> it to zero length and capacity retained, you can write to the beginning of the buffer, <em>overwriting</em> original data of the first buffer.</p>\n\n<p>See this example:</p>\n\n<pre><code>buf := &amp;bytes.Buffer{}\nbuf.WriteString(\"Hello  World\")\nfmt.Println(\"buf:\", buf)\n\nbuf2 := bytes.NewBuffer(buf.Bytes()[:0])\nbuf2.WriteString(\"Gopher\")\nfmt.Println(\"buf:\", buf)\nfmt.Println(\"buf2:\", buf2)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/SzZQZmQnxJ\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>buf: Hello  World\nbuf: Gopher World\nbuf2: Gopher\n</code></pre>\n\n<p>Note: Using this technique, you can also overwrite content at arbitrary position, by reslicing using the desired index instead of <code>0</code> and passing the slice. For example:</p>\n\n<pre><code>buf := &amp;bytes.Buffer{}\nbuf.WriteString(\"Hello  World\")\nfmt.Println(\"buf:\", buf)\n\nbuf2 := bytes.NewBuffer(buf.Bytes()[6:6]) // Start after the \"Hello\"\nbuf2.WriteString(\"Gopher\")\nfmt.Println(\"buf:\", buf)\nfmt.Println(\"buf2:\", buf2)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/-TIKSO__yO\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>buf: Hello  World\nbuf: Hello Gopher\nbuf2: Gopher\n</code></pre>\n\n<p>Note that the \"manipulation\" of the content through the slice returned by <code>Buffer.Bytes()</code> may only succeed until the <code>Buffer</code> is modified, after that there's a chance that <code>Buffer</code> allocates a new backing array and the one you have will be \"detached\" (and so further modification on it will not be reflected in the original <code>Buffer</code>):</p>\n\n<blockquote>\n  <p>The slice is valid for use only until the next buffer modification (that is, only until the next call to a method like Read, Write, Reset, or Truncate).</p>\n</blockquote>\n"}], "owner": {"reputation": 1229, "user_id": 6336858, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ebcd58007a9088efe7c1605069558559?s=128&d=identicon&r=PG&f=1", "display_name": "omgj", "link": "https://stackoverflow.com/users/6336858/omgj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5932, "favorite_count": 0, "accepted_answer_id": 40231869, "answer_count": 2, "score": 6, "last_activity_date": 1477382876, "creation_date": 1477372030, "last_edit_date": 1477372913, "question_id": 40231761, "link": "https://stackoverflow.com/questions/40231761/write-to-beginning-of-the-buffer-in-golang", "title": "Write to beginning of the buffer in Golang?", "body": "<p>I have:</p>\n\n<pre><code>var buffer bytes.Buffer\ns := \"something to do\"\nfor i := 0; i &lt; 10; i++ {\n   buffer.WriteString(s)\n}\n</code></pre>\n\n<p>Which appends to the buffer, is it possible to write to the beginning of a buffer?</p>\n"}, {"tags": ["go", "swagger", "go-swagger"], "comments": [{"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1477377790, "post_id": 40231599, "comment_id": 67728545, "body": "go-swagger has no <code>server</code> command"}], "answers": [{"comments": [{"owner": {"reputation": 1197, "user_id": 2572703, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ea9bb5d1f7a8a598ebc867c3b88e7aaa?s=128&d=identicon&r=PG", "display_name": "Sakib", "link": "https://stackoverflow.com/users/2572703/sakib"}, "edited": false, "score": 0, "creation_date": 1477438797, "post_id": 40247510, "comment_id": 67765289, "body": "I installed it with brew. I am on 0.6.0 with brew but when I check using swagger, I am on 0.5.0"}, {"owner": {"reputation": 1197, "user_id": 2572703, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ea9bb5d1f7a8a598ebc867c3b88e7aaa?s=128&d=identicon&r=PG", "display_name": "Sakib", "link": "https://stackoverflow.com/users/2572703/sakib"}, "edited": false, "score": 0, "creation_date": 1477438840, "post_id": 40247510, "comment_id": 67765306, "body": "$ brew upgrade go-swagger                                                                                 <code>Error: go-swagger&#47;go-swagger&#47;go-swagger 0.6.0 already installed</code> $ swagger version                                                                                         <code>0.5.0-171-gae8082b</code>"}, {"owner": {"reputation": 1197, "user_id": 2572703, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ea9bb5d1f7a8a598ebc867c3b88e7aaa?s=128&d=identicon&r=PG", "display_name": "Sakib", "link": "https://stackoverflow.com/users/2572703/sakib"}, "edited": false, "score": 0, "creation_date": 1477439418, "post_id": 40247510, "comment_id": 67765444, "body": "is swagger 0.7.0 compatible with go version 1.5.3?"}, {"owner": {"reputation": 1159, "user_id": 23418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39a948a58f4569c53d971c2e120920?s=128&d=identicon&r=PG", "display_name": "Casual Jim", "link": "https://stackoverflow.com/users/23418/casual-jim"}, "reply_to_user": {"reputation": 1197, "user_id": 2572703, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ea9bb5d1f7a8a598ebc867c3b88e7aaa?s=128&d=identicon&r=PG", "display_name": "Sakib", "link": "https://stackoverflow.com/users/2572703/sakib"}, "edited": false, "score": 0, "creation_date": 1477456761, "post_id": 40247510, "comment_id": 67769605, "body": "we support the last 2 versions of go, so no 1.5 sorry. There should be a 0.7.x version of swagger in brew at this stage. It should be as compatible as 0.6.x for go versions though."}], "tags": [], "owner": {"reputation": 1159, "user_id": 23418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39a948a58f4569c53d971c2e120920?s=128&d=identicon&r=PG", "display_name": "Casual Jim", "link": "https://stackoverflow.com/users/23418/casual-jim"}, "is_accepted": false, "score": 1, "last_activity_date": 1477421439, "creation_date": 1477421439, "answer_id": 40247510, "question_id": 40231599, "link": "https://stackoverflow.com/questions/40231599/go-swagger-swagger-serve-command-not-found/40247510#40247510", "title": "go-swagger - swagger serve command not found", "body": "<p>what's the version you're on? serve was added in the 0.7.x series so you may have to update your binary.</p>\n"}], "owner": {"reputation": 1197, "user_id": 2572703, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ea9bb5d1f7a8a598ebc867c3b88e7aaa?s=128&d=identicon&r=PG", "display_name": "Sakib", "link": "https://stackoverflow.com/users/2572703/sakib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1008, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1477421439, "creation_date": 1477371163, "question_id": 40231599, "link": "https://stackoverflow.com/questions/40231599/go-swagger-swagger-serve-command-not-found", "title": "go-swagger - swagger serve command not found", "body": "<p>I'm trying to serve a swagger.json file with the command <code>swagger serve</code> but I get the error </p>\n\n<pre><code>Unknown command `serve'. Please specify one command of: generate, init, validate or version\n</code></pre>\n\n<p>Where is the documentation getting the serve command from?</p>\n"}, {"tags": ["go", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5022470, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ee72d453902986c4cdf84eb49e147095?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash Kumar", "link": "https://stackoverflow.com/users/5022470/prakash-kumar"}, "edited": false, "score": 0, "creation_date": 1477374901, "post_id": 40231224, "comment_id": 67727165, "body": "Thanks for the explanation."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 0, "last_activity_date": 1477368816, "last_edit_date": 1477368816, "creation_date": 1477368502, "answer_id": 40231224, "question_id": 40231069, "link": "https://stackoverflow.com/questions/40231069/need-understanding-of-goroutines/40231224#40231224", "title": "Need understanding of goroutines", "body": "<p>Two things:</p>\n\n<ol>\n<li>If you return from <code>main</code> without having explicitly waited for your\ngoroutine to finish, there's no guarantee that it will finish before\nthe program exits.</li>\n<li>The argument type of <code>time.Sleep()</code> is <code>time.Duration</code>,\nthe units of which are nanoseconds. Since you're barely delaying at\nall, it's not surprising that your results were random. If you sleep\nfor a more substantial amount of time in <code>main</code>, you should see both\nlines printed (although it isn't guaranteed).</li>\n</ol>\n\n<p>If you need to wait for a goroutine to finish, there are various ways to do that (e.g, channels and <code>sync.WaitGroup</code>).</p>\n\n<p>You may want to go through <a href=\"https://tour.golang.org\" rel=\"nofollow\">A Tour of Go</a> and/or take a look at <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow\">Effective Go</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 5022470, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ee72d453902986c4cdf84eb49e147095?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash Kumar", "link": "https://stackoverflow.com/users/5022470/prakash-kumar"}, "edited": false, "score": 1, "creation_date": 1477374869, "post_id": 40231290, "comment_id": 67727149, "body": "Thanks for detailed explanation."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 1, "last_activity_date": 1477369667, "last_edit_date": 1477369667, "creation_date": 1477368974, "answer_id": 40231290, "question_id": 40231069, "link": "https://stackoverflow.com/questions/40231069/need-understanding-of-goroutines/40231290#40231290", "title": "Need understanding of goroutines", "body": "<p><a href=\"https://golang.org/ref/spec#Program_execution\" rel=\"nofollow\">Program execution</a>:  </p>\n\n<blockquote>\n  <p>When the function <code>main</code> returns, the program exits. It does not wait\n  for other (non-main) goroutines to complete.</p>\n</blockquote>\n\n<p>1- <code>main</code> is goroutine too, you need to wait for other goroutines to finish, and you may use </p>\n\n<pre><code>time.Sleep(5 * time.Second)\n</code></pre>\n\n<p>for 5 Seconds wait, try it on <a href=\"https://play.golang.org/p/xUAcqJqhOv\" rel=\"nofollow\">The Go Playground</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc t(i int) {\n    fmt.Println(\"In func t\")\n    time.Sleep(1 * time.Second)\n}\n\nfunc t1(i int) {\n    fmt.Println(\"In func t1\")\n    time.Sleep(1 * time.Second)\n}\n\nfunc main() {\n    fmt.Println(\"Hello Good Morning\")\n    go t(1)\n    t1(2)\n    time.Sleep(5 * time.Second)\n    fmt.Println(\"End of func main\")\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Hello Good Morning\nIn func t1\nIn func t\nEnd of func main\n</code></pre>\n\n<p>And see Docs:</p>\n\n<blockquote>\n<pre><code>// Sleep pauses the current goroutine for at least the duration d.\n// A negative or zero duration causes Sleep to return immediately.\nfunc Sleep(d Duration)\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>2- You may use <code>sync.WaitGroup</code> to wait for other goroutines, try it on <a href=\"https://play.golang.org/p/snxphtgx0v\" rel=\"nofollow\">The Go Playground</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nvar w sync.WaitGroup\n\nfunc say(s string) {\n    for i := 0; i &lt; 2; i++ {\n        time.Sleep(100 * time.Millisecond)\n        fmt.Println(s)\n    }\n    w.Done()\n}\n\nfunc main() {\n    w.Add(1)\n    go say(\"A\")\n\n    w.Add(1)\n    say(\"B\")\n\n    w.Wait()\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>B\nA\nA\nB\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 5022470, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ee72d453902986c4cdf84eb49e147095?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash Kumar", "link": "https://stackoverflow.com/users/5022470/prakash-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1477369816, "accepted_answer_id": 40231290, "answer_count": 2, "score": -1, "last_activity_date": 1477369667, "creation_date": 1477367379, "last_edit_date": 1477369282, "question_id": 40231069, "link": "https://stackoverflow.com/questions/40231069/need-understanding-of-goroutines", "closed_reason": "Duplicate", "title": "Need understanding of goroutines", "body": "<p>I am new to Go language programming and learning it step by step.<br>\nWhile practicing it, I found random behavior of goroutines.<br>\nIf I call goroutine (function having sleep of 1 second), some times it completed successfully and some times it doesn't:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc t(i int) {\n    fmt.Println(\"In func t\")\n    time.Sleep(1)\n}\n\nfunc t1(i int) {\n    fmt.Println(\"In func t1\")\n    time.Sleep(1)\n}\n\nfunc main() {\n    fmt.Println(\"Hello Good Morning\")\n    go t(1)\n    t1(2)\n    time.Sleep(5)\n    fmt.Println(\"End of func main\")\n}\n</code></pre>\n\n<p>O/p 1 :</p>\n\n<pre><code>  Hello Good Morning\n  In func t1\n  In func t\n  End of func main\n</code></pre>\n\n<p>O/p 2 :</p>\n\n<pre><code>  Hello Good Morning\n  In func t1\n  End of func main\n</code></pre>\n\n<p>Could someone explain why goroutine is not guaranteeing the execution of that goroutine function call. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 482, "user_id": 3467895, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f0b3cb0db6a6945898b777562ebf41bc?s=128&d=identicon&r=PG&f=1", "display_name": "user3467895", "link": "https://stackoverflow.com/users/3467895/user3467895"}, "edited": false, "score": 0, "creation_date": 1477384758, "post_id": 40230067, "comment_id": 67732697, "body": "Thanks. It is interesting that you can elide the type in the context of an array, slice or map but not in a struct or variable."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 482, "user_id": 3467895, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f0b3cb0db6a6945898b777562ebf41bc?s=128&d=identicon&r=PG&f=1", "display_name": "user3467895", "link": "https://stackoverflow.com/users/3467895/user3467895"}, "edited": false, "score": 0, "creation_date": 1477402208, "post_id": 40230067, "comment_id": 67744597, "body": "Yeah, it would almost make sense for <code>var i *index = {1,3}</code> to be valid, but it isn&#39;t. It&#39;s just as easy to use <code>i := &amp;index{1,3}</code> though."}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 5, "last_activity_date": 1477359587, "creation_date": 1477359587, "answer_id": 40230067, "question_id": 40229931, "link": "https://stackoverflow.com/questions/40229931/how-is-it-that-i-can-initialize-a-slice-of-pointers-like-this/40230067#40230067", "title": "How is it that I can initialize a slice of pointers like this?", "body": "<p>From <a href=\"https://golang.org/ref/spec#Composite_literals\">the spec</a>:</p>\n\n<blockquote>\n  <p>Within a composite literal of array, slice, or map type T, elements or\n  map keys that are themselves composite literals may elide the\n  respective literal type if it is identical to the element or key type\n  of T. Similarly, elements or keys that are addresses of composite\n  literals may elide the &amp;T when the element or key type is *T.</p>\n</blockquote>\n\n<p>Basically, it already knows each element will be a <code>*index</code>, so it saves you having to actually type <code>&amp;index</code> over and over again.</p>\n\n<p>If the slice type is not the same as the element type (perhaps it is a slice of an interface type), you would have to specify the type of each element like so:</p>\n\n<p><code>indices := []interface{}{&amp;index{0, 1}, &amp;index{1, 3}}</code></p>\n"}], "owner": {"reputation": 482, "user_id": 3467895, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f0b3cb0db6a6945898b777562ebf41bc?s=128&d=identicon&r=PG&f=1", "display_name": "user3467895", "link": "https://stackoverflow.com/users/3467895/user3467895"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 1, "accepted_answer_id": 40230067, "answer_count": 1, "score": 4, "last_activity_date": 1544498104, "creation_date": 1477358390, "last_edit_date": 1544498104, "question_id": 40229931, "link": "https://stackoverflow.com/questions/40229931/how-is-it-that-i-can-initialize-a-slice-of-pointers-like-this", "title": "How is it that I can initialize a slice of pointers like this?", "body": "<p>I was surprised I could initialize a slice of pointers in this way:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype index struct {\n    i, j int\n}\n\nfunc main() {\n    indices := []*index{{0, 1}, {1, 3}} // Why does this work?\n\n    fmt.Println(*indices[1])\n}\n</code></pre>\n\n<p>I was expecting to have to write something more verbose like:</p>\n\n<pre><code>indices := []*index{&amp;index{0, 1}, &amp;index{1, 3}}\n</code></pre>\n\n<p>Where would I find this in the documentation?</p>\n"}, {"tags": ["arrays", "go", "struct", "initialization"], "answers": [{"tags": [], "owner": {"reputation": 425, "user_id": 3902984, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fd4e4c3801b65345a38686f8844cf390?s=128&d=identicon&r=PG&f=1", "display_name": "Parag", "link": "https://stackoverflow.com/users/3902984/parag"}, "is_accepted": false, "score": 4, "last_activity_date": 1477359128, "creation_date": 1477359128, "answer_id": 40230014, "question_id": 40229880, "link": "https://stackoverflow.com/questions/40229880/array-of-struct-in-go-language/40230014#40230014", "title": "Array of struct in Go language", "body": "<p>This worked for me</p>\n\n<pre><code>type node struct {\n    name string\n    children map[string]int\n}\n\ncities:=[]*node{}\ncity:=new(node)\ncity.name=strconv.Itoa(0)\ncity.children=make(map[string]int)\ncities=append(cities,city)\nfor i := 1; i&lt;47 ;i++ {\n    city=new(node)\n    city.name=strconv.Itoa(i)\n    city.children=make(map[string]int)\n    cities=append(cities,city)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 29, "last_activity_date": 1477360691, "creation_date": 1477360691, "answer_id": 40230206, "question_id": 40229880, "link": "https://stackoverflow.com/questions/40229880/array-of-struct-in-go-language/40230206#40230206", "title": "Array of struct in Go language", "body": "<p>You are initializing cities as a slice of nodes with one element (an empty node).</p>\n\n<p>You can initialize it to a fixed size with <code>cities := make([]node,47)</code>, or you could initialize it to an empty slice, and <code>append</code> to it:</p>\n\n<pre><code>cities := []node{}\nfor i := 0; i&lt;47 ;i++ {\n  n := node{name: strconv.Itoa(i), children: map[string]int{}}\n  cities = append(cities,n)\n}\n</code></pre>\n\n<p>I'd definitely recommend reading <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"noreferrer\">this article</a> if you are a bit shaky on how slices work.</p>\n"}], "owner": {"reputation": 425, "user_id": 3902984, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fd4e4c3801b65345a38686f8844cf390?s=128&d=identicon&r=PG&f=1", "display_name": "Parag", "link": "https://stackoverflow.com/users/3902984/parag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56561, "favorite_count": 6, "accepted_answer_id": 40230206, "answer_count": 2, "score": 13, "last_activity_date": 1477360691, "creation_date": 1477357971, "question_id": 40229880, "link": "https://stackoverflow.com/questions/40229880/array-of-struct-in-go-language", "title": "Array of struct in Go language", "body": "<p>I am new to Go and want to create and initialise an struct array in go. My code is like this</p>\n\n<pre><code>type node struct {\nname string\nchildren map[string]int\n}\n\ncities:= []node{node{}}\nfor i := 0; i&lt;47 ;i++ {\n    cities[i].name=strconv.Itoa(i)\n    cities[i].children=make(map[string]int)\n}\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>panic: runtime error: index out of range\n\ngoroutine 1 [running]:\npanic(0xa6800, 0xc42000a080)\n</code></pre>\n\n<p>Please help. TIA :)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 10078, "user_id": 2709018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/p98Vl.png?s=128&g=1", "display_name": "myaut", "link": "https://stackoverflow.com/users/2709018/myaut"}, "edited": false, "score": 2, "creation_date": 1477350940, "post_id": 40229011, "comment_id": 67721087, "body": "Although go supports <a href=\"http://golangcookbook.com/chapters/running/cross-compiling/\" rel=\"nofollow noreferrer\">cross-compilation</a>, I think it would be easier to keep RedHat VM for that."}, {"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "reply_to_user": {"reputation": 10078, "user_id": 2709018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/p98Vl.png?s=128&g=1", "display_name": "myaut", "link": "https://stackoverflow.com/users/2709018/myaut"}, "edited": false, "score": 0, "creation_date": 1477351065, "post_id": 40229011, "comment_id": 67721115, "body": "@myaut Thank You. I will read that bit."}], "owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "closed_date": 1477351244, "answer_count": 0, "score": 0, "last_activity_date": 1477350972, "creation_date": 1477350749, "last_edit_date": 1477350972, "question_id": 40229011, "link": "https://stackoverflow.com/questions/40229011/go-windows-to-linux", "closed_reason": "Duplicate", "title": "Go - Windows to Linux", "body": "<p><strong>Background:</strong>\nI am an absolute newbie when it comes to Golang. I am on 32-bit windows machine, downloaded <code>Go</code> compiler and wrote my first Hello world. Happy days!</p>\n\n<p><strong>Question:</strong> Can someone be kind enough to explain me the process of porting the aforementioned from 32 bit windows 64 bit Redhat.</p>\n"}, {"tags": ["postgresql", "go", "go-pg"], "comments": [{"owner": {"reputation": 1037, "user_id": 2730407, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ea8cbda44bec55c4db6250eff89bbd8?s=128&d=identicon&r=PG&f=1", "display_name": "Ronna", "link": "https://stackoverflow.com/users/2730407/ronna"}, "edited": false, "score": 0, "creation_date": 1477394695, "post_id": 40228803, "comment_id": 67739063, "body": "can you get the underlying query that resulted?"}], "answers": [{"comments": [{"owner": {"reputation": 102535, "user_id": 20128, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/4b62eef3ad218a5d3cbdd1077660ca8b?s=128&d=identicon&r=PG", "display_name": "serg", "link": "https://stackoverflow.com/users/20128/serg"}, "edited": false, "score": 1, "creation_date": 1477412282, "post_id": 40238119, "comment_id": 67752055, "body": "Thanks, yeah I tried that, it seems to add this table on top, not to change the core table. The resulting sql is <code>SELECT &quot;mymodel&quot;.&quot;id&quot;, &quot;mymodel&quot;.&quot;name&quot; FROM &quot;mymodels&quot; AS &quot;mymodel&quot;, &quot;temp_table1&quot;</code>"}], "tags": [], "owner": {"reputation": 1037, "user_id": 2730407, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ea8cbda44bec55c4db6250eff89bbd8?s=128&d=identicon&r=PG&f=1", "display_name": "Ronna", "link": "https://stackoverflow.com/users/2730407/ronna"}, "is_accepted": false, "score": 1, "last_activity_date": 1477396014, "last_edit_date": 1592644375, "creation_date": 1477392984, "answer_id": 40238119, "question_id": 40228803, "link": "https://stackoverflow.com/questions/40228803/how-to-dynamically-set-table-name-for-every-query-in-go-pg/40238119#40238119", "title": "How to dynamically set table name for every query in go-pg?", "body": "<p>Seems you can <a href=\"https://github.com/go-pg/pg/blob/v5/orm/query.go#L92\" rel=\"nofollow noreferrer\">specify the table directly</a>: <code>db.Model(&amp;mymodels).Table('temp_table1').Column(&quot;mymodel.id&quot;, &quot;mymodel.name&quot;).Select()</code></p>\n"}, {"tags": [], "owner": {"reputation": 102535, "user_id": 20128, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/4b62eef3ad218a5d3cbdd1077660ca8b?s=128&d=identicon&r=PG", "display_name": "serg", "link": "https://stackoverflow.com/users/20128/serg"}, "is_accepted": false, "score": 2, "last_activity_date": 1477418370, "creation_date": 1477418370, "answer_id": 40246638, "question_id": 40228803, "link": "https://stackoverflow.com/questions/40228803/how-to-dynamically-set-table-name-for-every-query-in-go-pg/40246638#40246638", "title": "How to dynamically set table name for every query in go-pg?", "body": "<p>Got an answer on <a href=\"https://github.com/go-pg/pg/issues/377#issuecomment-256109421\" rel=\"nofollow\">github</a>:</p>\n\n<pre><code>err := db.Model().TableExpr(\"temp_table_999 AS mymodel\").Column(\"mymodel.id\", \"mymodel.name\").Select(&amp;mymodels)\n</code></pre>\n"}], "owner": {"reputation": 102535, "user_id": 20128, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/4b62eef3ad218a5d3cbdd1077660ca8b?s=128&d=identicon&r=PG", "display_name": "serg", "link": "https://stackoverflow.com/users/20128/serg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3079, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1477418370, "creation_date": 1477349442, "question_id": 40228803, "link": "https://stackoverflow.com/questions/40228803/how-to-dynamically-set-table-name-for-every-query-in-go-pg", "title": "How to dynamically set table name for every query in go-pg?", "body": "<p>I have a bunch of similar temp tables which I am trying to query using <a href=\"https://github.com/go-pg/pg\" rel=\"nofollow\">go-pg</a>'s ORM. I can't find a way to dynamically change the queried table during a select: </p>\n\n<pre><code>import \"gopkg.in/pg.v4\"\n\ntype MyModel struct {\n    TableName struct{} `sql:\"temp_table1\"`\n    Id              int64\n    Name            string  \n}\n\nvar mymodels []MyModel\nerr := db.Model(&amp;mymodels).Column(\"mymodel.id\", \"mymodel.name\").Select()\n</code></pre>\n\n<p>This will query <code>temp_table1</code> as defined in the model's <code>TableName</code>. Is there a way to pass table name as a parameter so I can query <code>temp_table_X</code>?</p>\n\n<p>(I can just not use ORM and go with raw <code>db.Query()</code>, but I wanted to see if there is a way to use ORM).</p>\n"}, {"tags": ["go", "netflow"], "comments": [{"owner": {"reputation": 1235, "user_id": 4470895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac18a4e724071d9e029e921786264b97?s=128&d=identicon&r=PG&f=1", "display_name": "HenryTK", "link": "https://stackoverflow.com/users/4470895/henrytk"}, "edited": false, "score": 0, "creation_date": 1477329655, "post_id": 40223913, "comment_id": 67711512, "body": "What is the structure of this nfcapd binary file? Is it actually a text file with reasonably structured lines? Is your problem you don&#39;t know how to read the file efficiently, or do you need help with the parsing of IPs as well?"}, {"owner": {"reputation": 1235, "user_id": 4470895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac18a4e724071d9e029e921786264b97?s=128&d=identicon&r=PG&f=1", "display_name": "HenryTK", "link": "https://stackoverflow.com/users/4470895/henrytk"}, "edited": false, "score": 0, "creation_date": 1477330104, "post_id": 40223913, "comment_id": 67711723, "body": "I have found an example output file in GitHub Gist: <a href=\"https://gist.githubusercontent.com/asachs/bfbfebdb39b33a5ded61/raw/319f206b29e5b7a046e48768f24b4be0f5e2f07c/gistfile1.txt\" rel=\"nofollow noreferrer\">gist.githubusercontent.com/asachs/bfbfebdb39b33a5ded61/raw/&hellip;</a>  I will assume a very large version of that is what you are dealing with."}, {"owner": {"reputation": 77, "user_id": 5907708, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSQg1EPwSzg/AAAAAAAAAAI/AAAAAAAAhaY/_3DwmORurno/photo.jpg?sz=128", "display_name": "memu", "link": "https://stackoverflow.com/users/5907708/memu"}, "reply_to_user": {"reputation": 1235, "user_id": 4470895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac18a4e724071d9e029e921786264b97?s=128&d=identicon&r=PG&f=1", "display_name": "HenryTK", "link": "https://stackoverflow.com/users/4470895/henrytk"}, "edited": false, "score": 0, "creation_date": 1477330629, "post_id": 40223913, "comment_id": 67712006, "body": "@HenryTK I have added more information about file. I do not now know how to read file efficiently and parsing IPs. I am newbie in Golang."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1477330885, "post_id": 40223913, "comment_id": 67712129, "body": "why are you creating a goroutine to read the file <code>go Read(file)</code> ?? Well I warn you that you program will do nothing for sure, the main() function will end and that&#39;s it."}, {"owner": {"reputation": 77, "user_id": 5907708, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSQg1EPwSzg/AAAAAAAAAAI/AAAAAAAAhaY/_3DwmORurno/photo.jpg?sz=128", "display_name": "memu", "link": "https://stackoverflow.com/users/5907708/memu"}, "reply_to_user": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1477331857, "post_id": 40223913, "comment_id": 67712662, "body": "@YandryPozo oh, sorry. It was typo"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477336555, "post_id": 40223913, "comment_id": 67715102, "body": "I don&#39;t understand the premise &quot;that it is not desirable to open and read very large (more than 1 GB) files with <code>io</code> or <code>os</code> package.&quot;, those are precisely the packages you need to use to read a file efficiently, maybe with the addition of <code>bufio</code> too."}, {"owner": {"reputation": 77, "user_id": 5907708, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSQg1EPwSzg/AAAAAAAAAAI/AAAAAAAAhaY/_3DwmORurno/photo.jpg?sz=128", "display_name": "memu", "link": "https://stackoverflow.com/users/5907708/memu"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477387510, "post_id": 40223913, "comment_id": 67734495, "body": "@JimB I have made an assumption after reading <a href=\"http://stackoverflow.com/questions/1821811/how-to-read-write-from-to-file\" title=\"how to read write from to file\">stackoverflow.com/questions/1821811/&hellip;</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477401692, "post_id": 40223913, "comment_id": 67744200, "body": "I&#39;m not sure how you make that assumption, since you can&#39;t read the file at all (well, not easily at least) without using the <code>os</code> and <code>io</code> packages. I cannot figure out what your intent is with the Read function, as what you&#39;re doing makes no sense, i.e. why are you reading the first 2 bytes twice? You&#39;re going to be constrained by the IO of reading the file, and if you intend to process all parts concurrently, you need to load them all into memory in the first place. Just read the file once in its entirety."}, {"owner": {"reputation": 77, "user_id": 5907708, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSQg1EPwSzg/AAAAAAAAAAI/AAAAAAAAhaY/_3DwmORurno/photo.jpg?sz=128", "display_name": "memu", "link": "https://stackoverflow.com/users/5907708/memu"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477402336, "post_id": 40223913, "comment_id": 67744693, "body": "@JimB Assumption was about bufio and other packages which I can not use to read the whole file at once.  It is just draft start. I do not have any experience with concurrent programming and especially with Golang. My question was getting to know how to process very large files concurrently to read IP addresses and use them."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 5907708, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSQg1EPwSzg/AAAAAAAAAAI/AAAAAAAAhaY/_3DwmORurno/photo.jpg?sz=128", "display_name": "memu", "link": "https://stackoverflow.com/users/5907708/memu"}, "edited": false, "score": 0, "creation_date": 1477485643, "post_id": 40244431, "comment_id": 67785460, "body": "It is not possible to read this binary file with netflow as you imagine. Due to this <code>if statement</code>: <a href=\"https://github.com/tehmaze/netflow/blob/master/netflow5/packet.go#L62\" rel=\"nofollow noreferrer\">github.com/tehmaze/netflow/blob/master/netflow5/packet.go#L6&zwnj;&#8203;2</a> You can not read the whole file at once. My goal is to read it separately to send flows to Unmarshall data."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 77, "user_id": 5907708, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSQg1EPwSzg/AAAAAAAAAAI/AAAAAAAAhaY/_3DwmORurno/photo.jpg?sz=128", "display_name": "memu", "link": "https://stackoverflow.com/users/5907708/memu"}, "edited": false, "score": 0, "creation_date": 1477486059, "post_id": 40244431, "comment_id": 67785749, "body": "@memu: if the netflow package won&#39;t parse it, you need something that will. You can&#39;t separate the pieces of the binary file without some rudimentary parsing. The workflow is still the same, wrap the file in a <code>bufio.Reader</code> and read it serially."}, {"owner": {"reputation": 77, "user_id": 5907708, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSQg1EPwSzg/AAAAAAAAAAI/AAAAAAAAhaY/_3DwmORurno/photo.jpg?sz=128", "display_name": "memu", "link": "https://stackoverflow.com/users/5907708/memu"}, "edited": false, "score": 0, "creation_date": 1477486499, "post_id": 40244431, "comment_id": 67786065, "body": "What do you mean under &quot;serial reading&quot;? Does it reading with chunks of bytes array? If so, which size should I choose?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 77, "user_id": 5907708, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSQg1EPwSzg/AAAAAAAAAAI/AAAAAAAAhaY/_3DwmORurno/photo.jpg?sz=128", "display_name": "memu", "link": "https://stackoverflow.com/users/5907708/memu"}, "edited": false, "score": 0, "creation_date": 1477486875, "post_id": 40244431, "comment_id": 67786328, "body": "@memu: I mean read the file once from start to finish without trying to add unnecessary concurrency. The point of using buffered IO is that it makes the size irrelevant, you read the size you need."}, {"owner": {"reputation": 77, "user_id": 5907708, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSQg1EPwSzg/AAAAAAAAAAI/AAAAAAAAhaY/_3DwmORurno/photo.jpg?sz=128", "display_name": "memu", "link": "https://stackoverflow.com/users/5907708/memu"}, "edited": false, "score": 0, "creation_date": 1477487128, "post_id": 40244431, "comment_id": 67786512, "body": "I want to read and process file very quickly. What else I should apply except concurrency?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 77, "user_id": 5907708, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSQg1EPwSzg/AAAAAAAAAAI/AAAAAAAAhaY/_3DwmORurno/photo.jpg?sz=128", "display_name": "memu", "link": "https://stackoverflow.com/users/5907708/memu"}, "edited": false, "score": 1, "creation_date": 1477487511, "post_id": 40244431, "comment_id": 67786767, "body": "@memu, again, in general, concurrency won&#39;t let you read a file faster when you are constrained by IO. Trying to read multiple parts of a file concurrently causes more random IO, which can significantly reduce your throughput. Concurrency is not parallelism, nor can it magically make non-parallel things faster. <i>If</i> there is significant computation to apply to <i>independent</i>, <i>isolated</i> data structures read from the file, then that specific computation may benefit from parallelism, but parsing a file is not that case."}, {"owner": {"reputation": 77, "user_id": 5907708, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSQg1EPwSzg/AAAAAAAAAAI/AAAAAAAAhaY/_3DwmORurno/photo.jpg?sz=128", "display_name": "memu", "link": "https://stackoverflow.com/users/5907708/memu"}, "edited": false, "score": 0, "creation_date": 1477487888, "post_id": 40244431, "comment_id": 67787067, "body": "But what you think about this answer?: <a href=\"http://stackoverflow.com/a/27217975/5907708\">stackoverflow.com/a/27217975/5907708</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 77, "user_id": 5907708, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSQg1EPwSzg/AAAAAAAAAAI/AAAAAAAAhaY/_3DwmORurno/photo.jpg?sz=128", "display_name": "memu", "link": "https://stackoverflow.com/users/5907708/memu"}, "edited": false, "score": 0, "creation_date": 1477488467, "post_id": 40244431, "comment_id": 67787540, "body": "@memu: There&#39;s no concurrency in <i>reading</i> the file in that answer. The scanner reads one line at a time; then sends a copy of each line off to be processed concurrently. This is exactly what I described in my last comment, the file is read serially while the computation is concurrent. You can use that same pattern, but you need to write the equivalent of <code>scanner.Scan</code> for your file&#39;s binary format (and note that in doing so, you may find that there is little or no speedup for your added effort)"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 0, "last_activity_date": 1477410712, "creation_date": 1477410712, "answer_id": 40244431, "question_id": 40223913, "link": "https://stackoverflow.com/questions/40223913/getting-ip-addresses-from-big-nfcapd-binary-files/40244431#40244431", "title": "Getting IP addresses from big nfcapd binary files", "body": "<p>IO is is almost always going to be the limiting factor when parsing a file, and unless there is heavy computation involved, reading a single file serially is going to be the fastest way to process it.</p>\n\n<p>Wrap the file in a <code>bufio.Reader</code> and give it to the <code>Read</code> function:</p>\n\n<pre><code>file, err := os.Open(fileName)\nif err != nil {\n    log.Fatal((err)\n}\ndefer file.Close()\n\npacket, err := netflow5.Read(bufio.NewReader(file))\n</code></pre>\n\n<p>Once it's parsed, you can then split up the records if you need to handle the chunks separately.</p>\n"}], "owner": {"reputation": 77, "user_id": 5907708, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSQg1EPwSzg/AAAAAAAAAAI/AAAAAAAAhaY/_3DwmORurno/photo.jpg?sz=128", "display_name": "memu", "link": "https://stackoverflow.com/users/5907708/memu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1158, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1477574225, "creation_date": 1477329254, "last_edit_date": 1477574225, "question_id": 40223913, "link": "https://stackoverflow.com/questions/40223913/getting-ip-addresses-from-big-nfcapd-binary-files", "title": "Getting IP addresses from big nfcapd binary files", "body": "<p>I need to get information about source IPs and destination IPs from nfcapd binary file. The problem is in file's size. I know that it is not desirable to open and read very large (more than 1 GB) files with io or os package.</p>\n\n<p>Here is my hacking and draft start:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"os\"\n    \"github.com/tehmaze/netflow/netflow5\"\n    \"log\"\n    \"io\"\n    \"bytes\"\n)\n\ntype Message interface {}\n\nfunc main() {\n    startTime := time.Now()\n    getFile := os.Args[1]\n    processFile(getFile)\n    endTime := time.Since(startTime)\n    log.Printf(\"Program executes in %s\", endTime)\n}\n\nfunc processFile(fileName string) {\n    file, err := os.Open(fileName)\n    // Check if file is not empty. If it is, then exit from program\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n\n    // Useful to close file after getting information about it\n    defer file.Close()\n    Read(file)\n}\n\nfunc Read(r io.Reader) (Message, error) {\n    data := [2]byte{}\n    if _, err := r.Read(data[:]); err != nil {\n        return nil, err\n    }\n    buffer := bytes.NewBuffer(data[:])\n    mr := io.MultiReader(buffer, r)\n    return netflow5.Read(mr)\n}\n</code></pre>\n\n<p>I want to split file into chunks with 24 flows and process it concurrently after reading with <a href=\"https://github.com/tehmaze/netflow\" rel=\"nofollow\">netflow</a> <a href=\"https://github.com/tehmaze/netflow/blob/master/netflow5/packet.go#L62\" rel=\"nofollow\">package</a>. But I do not imagine how to do it without losing any data during division.</p>\n\n<p>Please fix me if I missed something in code or description. I spend a lot of time in searching my solution on the web and thinking about another possible implementations.</p>\n\n<p>Any help and/or advice will be highly appreciated.</p>\n\n<p>File has the following properties (command <code>file -I &lt;file_name&gt;</code> in terminal):</p>\n\n<p><code>file_name: application/octet-stream; charset=binary</code></p>\n\n<p>The output of file after command <code>nfdump -r &lt;file_name&gt;</code> has this structure:</p>\n\n<pre><code>Date first seen          Duration Proto      Src IP Addr:Port          Dst IP Addr:Port   Packets    Bytes Flows\n</code></pre>\n\n<p>Every property is on own column.</p>\n\n<p><strong>UPDATE 1:</strong>\nUnfortunately, it is <a href=\"https://github.com/tehmaze/netflow/issues/15\" rel=\"nofollow\">impossible</a> to parse file with netflow package due to difference in binary file structure after saving it on disk via nfcapd. This answer was given by <a href=\"https://github.com/phaag/nfdump/graphs/contributors\" rel=\"nofollow\">one</a> of the <a href=\"https://github.com/phaag/nfdump\" rel=\"nofollow\">nfdump</a> contributors.</p>\n\n<p>The only way now is to run nfdump from terminal in go program like <a href=\"https://github.com/JustinAzoff/pynfdump/tree/master\" rel=\"nofollow\">pynfdump</a>.</p>\n\n<p>Another <a href=\"https://github.com/google/gopacket/issues/246\" rel=\"nofollow\">possible</a> solution in the future is to use <a href=\"https://github.com/google/gopacket\" rel=\"nofollow\">gopacket</a>.</p>\n"}, {"tags": ["pointers", "go", "reflection", "types", "go-reflect"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1477328892, "creation_date": 1477328892, "answer_id": 40223817, "question_id": 40223698, "link": "https://stackoverflow.com/questions/40223698/assign-result-of-reflect-appendslice-to-pointer/40223817#40223817", "title": "Assign result of reflect.AppendSlice to pointer", "body": "<p>Use <a href=\"https://godoc.org/reflect#Value.Set\" rel=\"nofollow\">Value.Set</a> to set the value in the slice.</p>\n\n<pre><code>func rotateSlice(a interface{}, i int) {\n    v := reflect.ValueOf(a).Elem()\n    x, b := v.Slice(0, i), v.Slice(i, v.Len())\n    v.Set(reflect.AppendSlice(b, x))\n}\n</code></pre>\n\n<p>Call the function with a pointer to a slice:</p>\n\n<pre><code>a := []string{\"a\", \"b\", \"c\", \"d\"}\nroateSlice(&amp;a, 2)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/8L3IF5rg_K\" rel=\"nofollow\">playground example</a></p>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1477334567, "last_edit_date": 1477334567, "creation_date": 1477328906, "answer_id": 40223820, "question_id": 40223698, "link": "https://stackoverflow.com/questions/40223698/assign-result-of-reflect-appendslice-to-pointer/40223820#40223820", "title": "Assign result of reflect.AppendSlice to pointer", "body": "<p><code>a</code> is an <code>interface{}</code> not a pointer, so you can't dereference it. Even if you have a pointer to a slice, you can't assigned the result of<code>reflect.AppendSlice</code>, because it returns the type <code>reflect.Value</code>. You need to set the value via <a href=\"https://godoc.org/reflect#Value.Set\" rel=\"nofollow\"><code>Value.Set</code></a>. </p>\n\n<p><a href=\"https://play.golang.org/p/JCF8jsRJ_O\" rel=\"nofollow\">https://play.golang.org/p/JCF8jsRJ_O</a></p>\n\n<pre><code>func rotateSlice(a interface{}, i int) {\n    v := reflect.ValueOf(a).Elem()\n    x, b := v.Slice(0, i), v.Slice(i, v.Len())\n    v.Set(reflect.AppendSlice(b, x))\n}\n</code></pre>\n"}], "owner": {"reputation": 25546, "user_id": 658718, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/661bb4dee881617e676c4d954ce97a70?s=128&d=identicon&r=PG", "display_name": "Konrad Reiche", "link": "https://stackoverflow.com/users/658718/konrad-reiche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "accepted_answer_id": 40223820, "answer_count": 2, "score": 0, "last_activity_date": 1477334567, "creation_date": 1477328404, "question_id": 40223698, "link": "https://stackoverflow.com/questions/40223698/assign-result-of-reflect-appendslice-to-pointer", "title": "Assign result of reflect.AppendSlice to pointer", "body": "<p>I have troubles translating this piece of code, which is effectively a left rotate on a slice, into a more generic version which accepts <code>interface{}</code> as an input parameter.</p>\n\n<pre><code>func rotate(a *[]int, i int) {\n    x, b := (*a)[:i], (*a)[i:]\n    *a = append(b, x...)\n}\n</code></pre>\n\n<p>I have troubles with the final assignment:</p>\n\n<pre><code>func rotateSlice(a interface{}, i int) {\n    v := reflect.ValueOf(a)\n    x, b := v.Elem().Slice(0, i), v.Elem().Slice(i, v.Elem().Len())\n    *a = reflect.AppendSlice(b, x)\n}\n</code></pre>\n\n<p>The error message is <code>invalid indirect of a (type {})</code>. The value of <code>a</code> is <code>interface{}</code>, hence <code>*a =</code> would be to assign the right-hand value to the space where the pointer is pointing to. My call to <code>AppendSlice</code> returns <code>Value</code> though. I am not sure where the type assertion needs to happen, I suppose on the left-hand side?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 1, "creation_date": 1477331083, "post_id": 40222222, "comment_id": 67712248, "body": "Any reason why you are invoking <code>os.Args[0]</code> through bash and not directly?"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1477338189, "last_edit_date": 1477338189, "creation_date": 1477326401, "answer_id": 40223180, "question_id": 40222222, "link": "https://stackoverflow.com/questions/40222222/unable-to-see-command-arguments-at-os-level-issued-from-exec-command/40223180#40223180", "title": "unable to see command arguments at OS level issued from exec.Command", "body": "<p>The <code>-c</code> bash flag takes a single string argument to interpret. Since the argument to <code>-c</code> is only the string <code>os.Args[0]</code>, that is all bash is executing, and the rest of the args are being ignored.</p>\n\n<p>To provide the arguments to your binary to be executed by <code>bash -c</code>, join them into a single string:</p>\n\n<pre><code>var args []string\nargs = append(args, os.Args[0])\nargs = append(args, \"--duration\")\nargs = append(args, \"10000\")\nfor i := 0; i &lt; 10; i++ {\n    proc := exec.Command(\"/bin/bash\", \"-c\", stringsJoin(args, \" \"))\n    go proc.Start()\n}\n</code></pre>\n\n<p>Or simply exec your binary directly without the extra shell.</p>\n"}], "owner": {"reputation": 6987, "user_id": 816415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6718587772b15f57b3e7923aee8420ea?s=128&d=identicon&r=PG", "display_name": "gextra", "link": "https://stackoverflow.com/users/816415/gextra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 40223180, "answer_count": 1, "score": 0, "last_activity_date": 1477338189, "creation_date": 1477323178, "last_edit_date": 1477323771, "question_id": 40222222, "link": "https://stackoverflow.com/questions/40222222/unable-to-see-command-arguments-at-os-level-issued-from-exec-command", "title": "unable to see command arguments at OS level issued from exec.Command", "body": "<p>My routine is supposed to spin 10 child processes from the same go executable binary (os.Args[0]), adding some command line arguments that are valid. All processes should live for a number of seconds, which is specified in one of the arguments.</p>\n\n<pre><code>func spinChildProcesses() {\n    cmdParts := make([]string, 4)\n    cmdParts[0] = \"-c\"\n    cmdParts[1] = os.Args[0]\n    cmdParts[2] = \"--duration\"\n    cmdParts[3] = \"10000\"\n    for i := 0; i &lt; 10; i++ {\n        proc := exec.Command(\"bash\", cmdParts...)\n        go proc.Start()\n    }\n}\n\nfunc main() {\n    # not showing code that parses duration arg\n    # create 10 child subprocesses\n    go spinChildProcesses()\n    // set a duration to the process and terminate\n    time.Sleep(time.Second * time.Duration(duration))\n    fmt.Println(\" - process terminating normaly\")\n}\n</code></pre>\n\n<p>When the above is run, looking at OS level I can see the arguments are not carried out. Only the root process has the arguments which I typed:</p>\n\n<pre><code>ps -ef | grep my-test-pr\nroot      3806 14446  0 15:23 pts/1    00:00:00 ./my-test-pr --duration 10000\nroot      3810  3806  0 15:23 pts/1    00:00:00 ./my-test-pr\nroot      3811  3806  0 15:23 pts/1    00:00:00 ./my-test-pr\nroot      3813  3806  0 15:23 pts/1    00:00:00 ./my-test-pr\nroot      3814  3806  0 15:23 pts/1    00:00:00 ./my-test-pr\nroot      3818  3806  0 15:23 pts/1    00:00:00 ./my-test-pr\nroot      3823  3806  0 15:23 pts/1    00:00:00 ./my-test-pr\nroot      3824  3806  0 15:23 pts/1    00:00:00 ./my-test-pr\nroot      3829  3806  0 15:23 pts/1    00:00:00 ./my-test-pr\nroot      3836  3806  0 15:23 pts/1    00:00:00 ./my-test-pr\nroot      3840  3806  0 15:23 pts/1    00:00:00 ./my-test-pr\n</code></pre>\n\n<p>Any idea why and how to ensure the arguments are passed to the children processes ?</p>\n"}, {"tags": ["git", "go", "ibm-cloud", "blockchain"], "answers": [{"comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1477315301, "post_id": 40219535, "comment_id": 67702252, "body": "To get it working, he could just manually check it out to $GOPATH/hyperledger-archived/fabric"}, {"owner": {"reputation": 3824, "user_id": 2728768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb82b13cda86d3b821fa44100335ddf?s=128&d=identicon&r=PG", "display_name": "thoeni", "link": "https://stackoverflow.com/users/2728768/thoeni"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1477315848, "post_id": 40219535, "comment_id": 67702666, "body": "Yes, that&#39;s an option, and then he can switch to the proper branch with <code>git branch v0.5-developer-preview</code>"}], "tags": [], "owner": {"reputation": 3824, "user_id": 2728768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb82b13cda86d3b821fa44100335ddf?s=128&d=identicon&r=PG", "display_name": "thoeni", "link": "https://stackoverflow.com/users/2728768/thoeni"}, "is_accepted": false, "score": 0, "last_activity_date": 1477315636, "last_edit_date": 1495540415, "creation_date": 1477315097, "answer_id": 40219535, "question_id": 40217666, "link": "https://stackoverflow.com/questions/40217666/go-get-not-working-for-downloading-hyperledgerfabric/40219535#40219535", "title": "Go Get not Working for downloading HyperledgerFabric", "body": "<p><code>go get</code> doesn't allow you to pull a specific branch of a library.</p>\n\n<p>You can pull the master with:</p>\n\n<p><code>go get -d github.com/hyperledger-archives/fabric/core/chaincode/shim</code></p>\n\n<p>What you're looking for is probably using the <strong>vendoring</strong> folder.</p>\n\n<p>Some resources on how to use it, and what it is, are here:</p>\n\n<ul>\n<li><a href=\"https://www.reddit.com/r/golang/comments/4c0up7/how_to_use_go_vendoring/d1f7z3q/\" rel=\"nofollow noreferrer\">A post on reddit on how to use Vendoring</a></li>\n<li><a href=\"https://stackoverflow.com/a/30188904/2728768\">A post on StackOverflow</a></li>\n<li><a href=\"https://blog.gopheracademy.com/advent-2015/vendor-folder/\" rel=\"nofollow noreferrer\">A blog post about the <code>govendor</code> tool</a></li>\n</ul>\n\n<p>Remember that vendoring has been introduced as experimental with Go 1.5, accepted in 1.6, and is default in 1.7 at the time we're writing, therefore in general if your build tool finds the same library in the <code>vendor</code> folder, it will use that one (in your case you can pull the specific version of the code you need)</p>\n\n<p>You can do this manually, or using one of the <a href=\"https://github.com/golang/go/wiki/PackageManagementTools#go15vendorexperiment\" rel=\"nofollow noreferrer\">package management tools available.</a></p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 4916043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IKB0c.jpg?s=128&g=1", "display_name": "K P", "link": "https://stackoverflow.com/users/4916043/k-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1477590936, "creation_date": 1477590936, "answer_id": 40291258, "question_id": 40217666, "link": "https://stackoverflow.com/questions/40217666/go-get-not-working-for-downloading-hyperledgerfabric/40291258#40291258", "title": "Go Get not Working for downloading HyperledgerFabric", "body": "<p>We are in the process of correcting the documentation. You can use</p>\n\n<blockquote>\n  <p>get github.com/hyperledger/fabric/core/chaincode/shim </p>\n</blockquote>\n\n<p>or </p>\n\n<blockquote>\n  <p>go get github.com/hyperledger-archives/fabric/core/chaincode/shim</p>\n</blockquote>\n\n<p>which fixes the problem.</p>\n"}], "owner": {"reputation": 9, "user_id": 2020654, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/1846e36645b32209e552daeadd75d48c?s=128&d=identicon&r=PG", "display_name": "Shubhra", "link": "https://stackoverflow.com/users/2020654/shubhra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 790, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1547262225, "creation_date": 1477309847, "last_edit_date": 1478880497, "question_id": 40217666, "link": "https://stackoverflow.com/questions/40217666/go-get-not-working-for-downloading-hyperledgerfabric", "title": "Go Get not Working for downloading HyperledgerFabric", "body": "<p>I am trying to run this sample app from the IBM Bluemix BlockChain Examples:\n<a href=\"https://console.ng.bluemix.net/docs/services/blockchain/ibmblockchain_tutorials.html#hellocc\" rel=\"nofollow noreferrer\">https://console.ng.bluemix.net/docs/services/blockchain/ibmblockchain_tutorials.html#hellocc</a></p>\n\n<p>I am running the following Command:\nC:\\goProjects>go get github.com/hyperledger-archives/fabric/tree/v0.5-developer-preview/core/chaincode/shim</p>\n\n<p>The error I get is below.</p>\n\n<pre><code>package github.com/hyperledger-archives/fabric/tree/v0.5-developer-preview/core/chaincode/shim: cannot find package \"github.com/hyperledger-archives/fabric/tree/v0.5-developer-preview/core/chaincode/shim\" in any of:\n        C:\\Go\\src\\github.com\\hyperledger-archives\\fabric\\tree\\v0.5-developer-preview\\core\\chaincode\\shim (from $GOROOT)\n        C:\\goProjects\\src\\github.com\\hyperledger-archives\\fabric\\tree\\v0.5-developer-preview\\core\\chaincode\\shim (from $GOPATH)\n</code></pre>\n\n<p>Please let me know how to proceed.</p>\n"}, {"tags": ["go", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 1, "creation_date": 1477306075, "post_id": 40216428, "comment_id": 67696522, "body": "In Go memory-management should not be the responsibility of the developer, it will do the garbage collector."}], "answers": [{"tags": [], "owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "is_accepted": true, "score": 3, "last_activity_date": 1477305947, "creation_date": 1477305947, "answer_id": 40216486, "question_id": 40216428, "link": "https://stackoverflow.com/questions/40216428/golang-new-memory-allocation/40216486#40216486", "title": "Golang new memory allocation", "body": "<p>Go has garbage collection. This means the Go runtime checks in the background if an object or any other variable is not used anymore and if this is the case, frees the memory.</p>\n\n<p>Also see the Go FAQ: <a href=\"https://golang.org/doc/faq#garbage_collection\" rel=\"nofollow\">Why is the syntax so different from C? - Why do garbage collection? Won't it be too expensive?</a></p>\n"}, {"tags": [], "owner": {"reputation": 6499, "user_id": 680372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qQ6rK.jpg?s=128&g=1", "display_name": "pylover", "link": "https://stackoverflow.com/users/680372/pylover"}, "is_accepted": false, "score": 4, "last_activity_date": 1477305986, "last_edit_date": 1477305986, "creation_date": 1477305957, "answer_id": 40216490, "question_id": 40216428, "link": "https://stackoverflow.com/questions/40216428/golang-new-memory-allocation/40216490#40216490", "title": "Golang new memory allocation", "body": "<p>As you see <a href=\"https://golang.org/doc/faq\" rel=\"nofollow\">here</a>:</p>\n\n<blockquote>\n  <p>Go is fully garbage-collected and provides fundamental support for concurrent execution and communication.</p>\n</blockquote>\n\n<p>So you don't have to care about memory allocation.</p>\n"}, {"tags": [], "owner": {"reputation": 13260, "user_id": 6612932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3mwe.jpg?s=128&g=1", "display_name": "rgmt", "link": "https://stackoverflow.com/users/6612932/rgmt"}, "is_accepted": false, "score": 1, "last_activity_date": 1477306024, "creation_date": 1477306024, "answer_id": 40216513, "question_id": 40216428, "link": "https://stackoverflow.com/questions/40216428/golang-new-memory-allocation/40216513#40216513", "title": "Golang new memory allocation", "body": "<p>In Go, unlike in C and C++, but like in Java, memory is managed automatically by a <a href=\"https://golang.org/doc/faq#garbage_collection\" rel=\"nofollow\">garbage collector</a>.</p>\n\n<p>There is no <code>delete</code> to call.</p>\n\n<p><strong>Off-topic:</strong></p>\n\n<blockquote>\n  <p>in C++ when <code>new</code> is used on an object you <strong>can</strong> <code>delete</code> the object once there is no longer any need for the object to be stored.</p>\n</blockquote>\n\n<p>You <strong>must</strong> delete, otherwise you have memory leak.</p>\n"}], "owner": {"reputation": 279, "user_id": 3863813, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e80397110a9646af0dec7113148afaf8?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/3863813/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3285, "favorite_count": 1, "accepted_answer_id": 40216486, "answer_count": 3, "score": 1, "last_activity_date": 1477306883, "creation_date": 1477305771, "last_edit_date": 1477306883, "question_id": 40216428, "link": "https://stackoverflow.com/questions/40216428/golang-new-memory-allocation", "title": "Golang new memory allocation", "body": "<p>I have started programming in Go and I was wondering when <code>new(Object)</code> is used it allocates memory to the size of that object right? If this is the case how do I free this memory once I have finished using the object? </p>\n\n<p>I ask this because in C++ when <code>new</code> is used on an object you can <code>delete</code> the object once there is no longer any need for the object to be stored.</p>\n\n<p>I have been searching to see if Go does have <code>delete</code> or something similar to C++ but I have been unable to find anything.</p>\n\n<p>Any help is much appreciated.</p>\n"}, {"tags": ["go", "struct", "dry", "embedding"], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 6743038, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8b1f7c217b2b5516a0c139448c1711bc?s=128&d=identicon&r=PG&f=1", "display_name": "user6743038", "link": "https://stackoverflow.com/users/6743038/user6743038"}, "edited": false, "score": 0, "creation_date": 1477303907, "post_id": 40215730, "comment_id": 67695343, "body": "This is not what I&#39;m asking about. <code>collectionName</code> struct field is intentionally started with lower case, because this is not model field, but rather service field which stores collection into which model should be stored"}], "tags": [], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "is_accepted": false, "score": -1, "last_activity_date": 1477303707, "creation_date": 1477303707, "answer_id": 40215730, "question_id": 40215326, "link": "https://stackoverflow.com/questions/40215326/access-all-fields-from-parent-method/40215730#40215730", "title": "Access all fields from parent method", "body": "<p>Well known problem ;o) Member variables (like collectionName) which name starts with lower letter are not visible from other packages (like json). Therefore change struct to:</p>\n\n<pre><code>type BaseModel struct {\n    Id             int    `json:\"_id\"`\n    CollectionName string `json:\"collectionName\"`\n}\n</code></pre>\n\n<p>and world will be better place to live in.</p>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 6743038, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8b1f7c217b2b5516a0c139448c1711bc?s=128&d=identicon&r=PG&f=1", "display_name": "user6743038", "link": "https://stackoverflow.com/users/6743038/user6743038"}, "edited": false, "score": 0, "creation_date": 1477305745, "post_id": 40215842, "comment_id": 67696341, "body": "Yeah, but to insert something into collection, I need it&#39;s name first. That&#39;s why I have <code>collectionName</code> field. I don&#39;t want to pull another variable/const in every package, where I want to save model.  Thanks for pointing to GORM, I didn&#39;t use/see it before. As I see, they solved problem of naming tables simply by pluralising model name. I&#39;d like to have ability to set collection name to whatever I want. Any advices?"}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": false, "score": 1, "last_activity_date": 1477304037, "creation_date": 1477304037, "answer_id": 40215842, "question_id": 40215326, "link": "https://stackoverflow.com/questions/40215326/access-all-fields-from-parent-method/40215842#40215842", "title": "Access all fields from parent method", "body": "<p>In Golang, you can't override a parent method, because that's not how polymorphism works. The <code>Insert</code> method will apply on the <code>BaseModel</code> member, and not on <code>MyModel</code>.</p>\n\n<p>Also, you're trying to use mgo in an improper way. If you want to insert documents in collections, then you already have an <code>Insert</code> method for a <code>Collection</code> struct which works on <code>interface{}</code> types (same as <code>json.Marshal</code>).</p>\n\n<p>Of course, you can have a <code>BaseModel</code> that will contain fields shared by all of your models. In fact, GORM uses a similar approach and provides a <code>Model</code> struct to be included in every child model.</p>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 6743038, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8b1f7c217b2b5516a0c139448c1711bc?s=128&d=identicon&r=PG&f=1", "display_name": "user6743038", "link": "https://stackoverflow.com/users/6743038/user6743038"}, "edited": false, "score": 0, "creation_date": 1477305727, "post_id": 40215931, "comment_id": 67696323, "body": "&gt; You also had a &quot;typo&quot; in the tags: Yeah. Copy-paste :)  What about collectionName? I like the idea of having it inside model. What would be good solution? Probably <code>Insert</code> should accept my own interface (instead of empty one), which implements <code>GetCollectionName</code> method? Or there is better way? Also I didn&#39;t get the &quot;Pass the pointer&quot; way."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 129, "user_id": 6743038, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8b1f7c217b2b5516a0c139448c1711bc?s=128&d=identicon&r=PG&f=1", "display_name": "user6743038", "link": "https://stackoverflow.com/users/6743038/user6743038"}, "edited": false, "score": 1, "creation_date": 1477306619, "post_id": 40215931, "comment_id": 67696827, "body": "@user6743038 Yes, your own interface with <code>CollectionName()</code> method is better. What I presented is just the principle. Also for the other method, see edited answer. I included a complete, runnable example for that too."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1477306869, "last_edit_date": 1495541959, "creation_date": 1477304289, "answer_id": 40215931, "question_id": 40215326, "link": "https://stackoverflow.com/questions/40215326/access-all-fields-from-parent-method/40215931#40215931", "title": "Access all fields from parent method", "body": "<p>This is not possible, for details see my answer: <a href=\"https://stackoverflow.com/questions/30622605/can-embedded-struct-method-have-knowledge-of-parent-child/30629132#30629132\">Can embedded struct method have knowledge of parent/child?</a></p>\n\n<p>You may do 2 things:</p>\n\n<h3>1. Abandon method and make it a helper / utility function</h3>\n\n<p>The idea is to make <code>Insert()</code> detached from <code>BaseModel</code> and make it a simple function, and you pass the document to it which you want to save.</p>\n\n<p>I personally prefer this option, as it requires less hassle and maintenance. It could look like this:</p>\n\n<pre><code>func Insert(doc interface{}) {\n    j, _ := json.Marshal(doc)\n    fmt.Println(string(j))\n}\n</code></pre>\n\n<p>You also had a \"typo\" in the tags:</p>\n\n<pre><code>type MyModel struct {\n    *BaseModel\n    Foo string `json:\"foo\"`\n    Bar string `json:\"bar\"`\n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>Insert(m)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/LBKlIGhcUh\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{\"_id\":42,\"foo\":\"Some value for foo\",\"bar\":\"Here we set some value for bar\"}\n</code></pre>\n\n<h3>2. Pass the (pointer to) the wrapper to the <code>BaseModel</code></h3>\n\n<p>In this approach, you have to pass a pointer to the embedder struct so the <code>BaseModel.Insert()</code> method will have a pointer to it, and may use that to save / marshal. This is basically manually maintaining a \"reference\" to the struct that embeds us and is being saved/marshalled.</p>\n\n<p>This is how it could look like:</p>\n\n<pre><code>type BaseModel struct {\n    Id             int `json:\"_id\"`\n    collectionName string\n\n    wrapper interface{}\n}\n</code></pre>\n\n<p>And then in the <code>Insert()</code> method save the <code>wrapper</code>:</p>\n\n<pre><code>func (m *BaseModel) Insert() {\n    fmt.Printf(\"Saving to '%v'\\n\", m.collectionName)\n    j, _ := json.Marshal(m.wrapper)\n    fmt.Println(string(j))\n}\n</code></pre>\n\n<p>Creation is slightly more complex:</p>\n\n<pre><code>func NewMyModel() *MyModel {\n    mm := &amp;MyModel{\n        Foo: \"Some value for foo\",\n    }\n    mm.BaseModel = NewBaseModel(\"my_model_collection\", mm)\n    return mm\n}\n</code></pre>\n\n<p>But output is as you wish:</p>\n\n<pre><code>Saving to 'my_model_collection'\n{\"_id\":42,\"foo\":\"Some value for foo\",\"bar\":\"Here we set some value for bar\"}\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/CAhVDSS2FK\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 129, "user_id": 6743038, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8b1f7c217b2b5516a0c139448c1711bc?s=128&d=identicon&r=PG&f=1", "display_name": "user6743038", "link": "https://stackoverflow.com/users/6743038/user6743038"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 0, "accepted_answer_id": 40215931, "answer_count": 3, "score": 1, "last_activity_date": 1477340130, "creation_date": 1477302477, "last_edit_date": 1592644375, "question_id": 40215326, "link": "https://stackoverflow.com/questions/40215326/access-all-fields-from-parent-method", "title": "Access all fields from parent method", "body": "<p>I'm developing an application where data is stored in mongodb. There are several collections and of course all of them have some common fields (like Id, creation date, etc) and methods (for example Insert). In my vision, I need to create base model struct with needed fields and methods, and then embed this struct into my models. Unfortunately, this doesn't work because method defined for base model doesn't see child fields.</p>\n<p>I don't know how to explain further. Here is code in playground:\n<a href=\"https://play.golang.org/p/_x-B78g4TV\" rel=\"nofollow noreferrer\">https://play.golang.org/p/_x-B78g4TV</a></p>\n<p>It uses json instead of mgo, but idea is still the same.</p>\n<p>I want the output to be:</p>\n<blockquote>\n<p>Saving to 'my_model_collection'</p>\n<p>{&quot;_id&quot;:42, &quot;foo&quot;: &quot;Some value for foo&quot;, &quot;bar&quot;: &quot;Here we set some value for bar&quot;}</p>\n</blockquote>\n<p>Not:</p>\n<blockquote>\n<p>Saving to 'my_model_collection'</p>\n<p>{&quot;_id&quot;:42}</p>\n</blockquote>\n<p>Writing that insert method for each my model seems to be against DRY, so what is correct/idiomatic way to achieve this in Go?</p>\n"}, {"tags": ["xml", "go", "xml-parsing"], "answers": [{"comments": [{"owner": {"reputation": 2368, "user_id": 562097, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58997ceeac4d64b33a438f9ca7e73880?s=128&d=identicon&r=PG", "display_name": "Leonardo Rossi", "link": "https://stackoverflow.com/users/562097/leonardo-rossi"}, "edited": false, "score": 0, "creation_date": 1477305895, "post_id": 40214572, "comment_id": 67696415, "body": "Thanks. I wasn&#39;t clear enough in my first question so I have edited it with some more details"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1477308687, "last_edit_date": 1477308687, "creation_date": 1477300129, "answer_id": 40214572, "question_id": 40214265, "link": "https://stackoverflow.com/questions/40214265/xml-parsing-with-golang-abuse-of-entity-attributes/40214572#40214572", "title": "XML parsing with Golang (abuse of entity attributes)", "body": "<p>I don't know what kind of issue you're dealing with, but your XML actually looks like a stream of XML values, so you should decode it as such:</p>\n\n<pre><code>type Table struct {\n    Name string `xml:\"name,attr\"`\n    Rows []Row  `xml:\"row\"`\n}\n\ntype Row struct {\n    Cols []Col `xml:\"col\"`\n}\n\ntype Col struct {\n    Name  string `xml:\"name,attr\"`\n    Value string `xml:\",chardata\"`\n}\n\n//...\n\nvar err error\ndec := xml.NewDecoder(bytes.NewReader(b))\nfor err == nil {\n    t := Table{}\n    err = dec.Decode(&amp;t)\n    fmt.Printf(\"%v, %+v\\n\", err, t)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/w4PqLv-Uc0\" rel=\"nofollow\">https://play.golang.org/p/w4PqLv-Uc0</a>.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> If you want to decode such XML directly into appropriate structs, you'll need a more complex machinery. Here's an example for users:</p>\n\n<pre><code>type User struct {\n    ID      int\n    Name    string\n    Surname string\n}\n\nfunc (u *User) UnmarshalXML(d *xml.Decoder, start xml.StartElement) error {\n    var err error\n\n    type col struct {\n        Name  string `xml:\"name,attr\"`\n        Value string `xml:\",chardata\"`\n    }\n\n    for {\n        c := col{}\n        err = d.Decode(&amp;c)\n        if err != nil {\n            if err == io.EOF {\n                break\n            }\n\n            return err\n        }\n        switch c.Name {\n        case \"id\":\n            u.ID, err = strconv.Atoi(c.Value)\n            if err != nil {\n                return err\n            }\n        case \"name\":\n            u.Name = c.Value\n            continue\n        case \"surname\":\n            u.Surname = c.Value\n        }\n    }\n\n    return nil\n}\n\ntype UserTable struct {\n    Users []User `xml:\"row\"`\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/Hqta3Ngjo3\" rel=\"nofollow\">https://play.golang.org/p/Hqta3Ngjo3</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1477300860, "last_edit_date": 1495540837, "creation_date": 1477300143, "answer_id": 40214577, "question_id": 40214265, "link": "https://stackoverflow.com/questions/40214265/xml-parsing-with-golang-abuse-of-entity-attributes/40214577#40214577", "title": "XML parsing with Golang (abuse of entity attributes)", "body": "<p>The doc of the <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshal\" rel=\"nofollow noreferrer\"><code>xml.Unmarshal()</code></a> function describes how the mapping between XML documents and structs work (supplemented by doc of <a href=\"https://golang.org/pkg/encoding/xml/#Marshal\" rel=\"nofollow noreferrer\"><code>json.Marshal()</code></a>). If you're not familiar with struct tags, check out this answer: <a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go/30889373#30889373\">What are the use(s) for tags in Go?</a></p>\n\n<p>First you need to model the XML document. Note that if you don't have a wrapper XML element around all the others, that is not 1 XML document but multiple, such as your case. You have multiple <code>&lt;table&gt;</code> documents.</p>\n\n<p>You can model them like this:</p>\n\n<pre><code>type Col struct {\n    Name  string `xml:\"name,attr\"`\n    Value string `xml:\",chardata\"`\n}\n\ntype Row struct {\n    Cols []Col `xml:\"col\"`\n}\n\ntype Table struct {\n    Name string `xml:\"name,attr\"`\n    Rows []Row  `xml:\"row\"`\n}\n</code></pre>\n\n<p>And since you have multiple <code>&lt;table&gt;</code> elements, easiest is to create an <a href=\"https://golang.org/pkg/encoding/xml/#Decoder\" rel=\"nofollow noreferrer\"><code>xml.Decoder()</code></a> and parse each separately with a <a href=\"https://golang.org/pkg/encoding/xml/#Decoder.Decode\" rel=\"nofollow noreferrer\"><code>Decoder.Decode()</code></a> call (<code>Decoder.Decode()</code> will attempt to parse 1 XML document from its source reader).</p>\n\n<p>This is how it can be done:</p>\n\n<pre><code>d := xml.NewDecoder(strings.NewReader(data))\nfor {\n    var table Table\n    if err := d.Decode(&amp;table); err != nil {\n        fmt.Println(err)\n        break\n    }\n    fmt.Printf(\"%+v\\n\", table)\n}\n</code></pre>\n\n<p>When there are no more data in the source <code>string</code>, <code>Decoder.Decode()</code> will report <a href=\"https://golang.org/pkg/io/#EOF\" rel=\"nofollow noreferrer\"><code>io.EOF</code></a>. Running the above cod with the following <code>data</code> string:</p>\n\n<pre><code>const data = `&lt;table name=\"table1\"&gt;\n    &lt;row&gt;\n        &lt;col name=\"col1\"&gt;value1&lt;/col&gt;\n        &lt;col name=\"col2\"&gt;value2&lt;/col&gt;\n        &lt;col name=\"col3\"&gt;value3&lt;/col&gt;\n    &lt;/row&gt;\n    &lt;row&gt;\n        &lt;col name=\"col1\"&gt;value4&lt;/col&gt;\n        &lt;col name=\"col2\"&gt;value5&lt;/col&gt;\n        &lt;col name=\"col3\"&gt;value6&lt;/col&gt;\n    &lt;/row&gt;\n&lt;/table&gt;\n&lt;table name=\"table2\"&gt;\n    &lt;row&gt;\n        &lt;col name=\"col1\"&gt;value7&lt;/col&gt;\n        &lt;col name=\"col2\"&gt;value8&lt;/col&gt;\n        &lt;col name=\"col3\"&gt;value9&lt;/col&gt;\n        &lt;col name=\"col4\"&gt;valueA&lt;/col&gt;\n    &lt;/row&gt;\n&lt;/table&gt;`\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>{Name:table1 Rows:[{Cols:[{Name:col1 Value:value1} {Name:col2 Value:value2} {Name:col3 Value:value3}]} {Cols:[{Name:col1 Value:value4} {Name:col2 Value:value5} {Name:col3 Value:value6}]}]}\n{Name:table2 Rows:[{Cols:[{Name:col1 Value:value7} {Name:col2 Value:value8} {Name:col3 Value:value9} {Name:col4 Value:valueA}]}]}\nEOF\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/JA4CVwpDrx\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "is_accepted": false, "score": 1, "last_activity_date": 1477320880, "creation_date": 1477320880, "answer_id": 40221453, "question_id": 40214265, "link": "https://stackoverflow.com/questions/40214265/xml-parsing-with-golang-abuse-of-entity-attributes/40221453#40221453", "title": "XML parsing with Golang (abuse of entity attributes)", "body": "<p>To unmarshal each field into a different type based on the name, you'll need to get each start element token, check the name, and then decode as appropriate. Something like the following (where <code>getName</code> is a function that returns the <code>name</code> attribute; see the playground link for a minimal working example):</p>\n\n<pre><code>d := xml.NewDecoder(\u2026)\nfor {\n    tok, err := d.Token()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    start, ok := tok.(xml.StartElement)\n    if !ok {\n        // This is chardata or some other token.\n        // If it's bad XML, it will be caught on the next call to Token()\n        continue\n    }\n    switch getName(start) {\n    case \"user\":\n        u := &amp;User{}\n        err = d.DecodeElement(u, &amp;start)\n        if err != nil {\n            log.Fatal(err)\n        }\n        // Do whatever you want to do with your struct here.\n        fmt.Printf(\"Decoded a user: %+v\\n\", u)\n    case \"category\":\n        u := &amp;Category{}\n        err = d.DecodeElement(u, &amp;start)\n        if err != nil {\n            log.Fatal(err)\n        }\n        fmt.Printf(\"Decoded a category: %+v\\n\", u)\n    default:\n        // If the name is unrecognized, skip the rest of the element.\n        // We could also return an error\n        d.Skip()\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/l7Vmj_8Igp\" rel=\"nofollow\">https://play.golang.org/p/l7Vmj_8Igp</a></p>\n"}], "owner": {"reputation": 2368, "user_id": 562097, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58997ceeac4d64b33a438f9ca7e73880?s=128&d=identicon&r=PG", "display_name": "Leonardo Rossi", "link": "https://stackoverflow.com/users/562097/leonardo-rossi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 871, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1477320880, "creation_date": 1477299135, "last_edit_date": 1477301649, "question_id": 40214265, "link": "https://stackoverflow.com/questions/40214265/xml-parsing-with-golang-abuse-of-entity-attributes", "title": "XML parsing with Golang (abuse of entity attributes)", "body": "<p>I have an XML formatted like this, coming from a dump of a database</p>\n\n<pre><code>&lt;table name=\"table1\"&gt;\n    &lt;row&gt;\n        &lt;col name=\"col1\"&gt;value&lt;/col&gt;\n        &lt;col name=\"col2\"&gt;value&lt;/col&gt;\n        &lt;col name=\"col3\"&gt;value&lt;/col&gt;\n    &lt;/row&gt;\n   ...\n&lt;/table&gt;\n&lt;table name=\"table2\"&gt;\n    &lt;row&gt;\n        &lt;col name=\"col1\"&gt;value&lt;/col&gt;\n        &lt;col name=\"col2\"&gt;value&lt;/col&gt;\n        &lt;col name=\"col3\"&gt;value&lt;/col&gt;\n        &lt;col name=\"col4\"&gt;value&lt;/col&gt;\n    &lt;/row&gt;\n   ...\n&lt;/table&gt;\n</code></pre>\n\n<p>I am trying to parse this in Go with <code>xml.Decode()</code> function but I can't handle such an XML. \nI tried to match some of the examples found googling XML parsing in Golang, but nothing suits this kind of format (with <code>name</code> attributes all over the entities).</p>\n\n<p><em>Update</em></p>\n\n<p>Thanks for the answers! What I'd like to achieve is: let's say I have a Table called \"users\" and a table called \"categories\", I'd like to create as many <code>User</code> and <code>Category</code> objects starting from that XML.\nBased on your first answers I can easily use the <code>Table</code> objects parsed and then create my own objects, but I'd like to know if I can skip that and decode directly my objects instead.</p>\n"}, {"tags": ["c", "go", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477313048, "post_id": 40213224, "comment_id": 67700782, "body": "It&#39;s generally preferred to use through an array, rather than relying on the reflection package: see <a href=\"https://github.com/golang/go/wiki/cgo#turning-c-arrays-into-go-slices\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/cgo#turning-c-arrays-into-go-slice&zwnj;&#8203;s</a>"}], "owner": {"reputation": 984, "user_id": 5303401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/903c091913c61d706eb066e1513a2438?s=128&d=identicon&r=PG&f=1", "display_name": "Ozan", "link": "https://stackoverflow.com/users/5303401/ozan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "closed_date": 1477312957, "answer_count": 0, "score": 2, "last_activity_date": 1477295447, "creation_date": 1477295447, "question_id": 40213224, "link": "https://stackoverflow.com/questions/40213224/conversion-from-c-pointer-to-go-slice", "closed_reason": "Duplicate", "title": "Conversion from C pointer to Go Slice", "body": "<p>I am new to Go language and I have a problem below regarding conversion from C void pointer to Go byte slice.</p>\n\n<p>There is a <code>C</code> function <code>cCallback</code> like this. This calls exported Go function <code>myStreamCallback</code></p>\n\n<pre><code>int cCallback(const void *inputBuffer, void *outputBuffer, unsigned long frames, const PaStreamCallbackTimeInfo *timeInfo,\n    PaStreamCallbackFlags statusFlags, void *userData) {\n    PaStreamCallbackResult res;\n\n    goCallback((void*)inputBuffer, outputBuffer, frames, (PaStreamCallbackTimeInfo*)timeInfo, statusFlags, userData, &amp;res);\n    /* some stuff */\n}\n</code></pre>\n\n<p>My exported <code>myStreamCallback</code> function in Go is </p>\n\n<pre><code>//export myStreamCallback\nfunc goCallback(inputBuffer, outputBuffer unsafe.Pointer, framesPerBuffer C.ulong, timeInfo *C.PaStreamCallbackTimeInfo,\n    statusFlags C.PaStreamCallbackFlags, userData unsafe.Pointer, result *C.PaStreamCallbackResult) C.PaStreamCallbackResult {\n    /* some stuff */\n\n    Len := int(framesPerBuffer)\n    h := &amp;reflect.SliceHeader{Data: uintptr(inputBuffer), Len: Len, Cap: Len}\n    NewSlice := *(*[]byte)(unsafe.Pointer(h)) //conversion to slice\n\n    /* some stuff */\n}\n</code></pre>\n\n<p>What I want to do is to convert C's <code>inputBuffer</code> to a Go slice that is called <code>NewSlice</code>. This solution is what I found on the web but I don't know if it is an elegant, fast and safe way to convert C's char array to a Go slice or if there are other methods? In addition to this, I do not know what happens if <code>inputBuffer</code> is freed in <code>C</code> side after slice is created. I will be glad If you help me to understand considering I am new to Go.</p>\n"}, {"tags": ["c", "go", "cgo"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1477294931, "post_id": 40212918, "comment_id": 67690223, "body": "Not a <a href=\"https://stackoverflow.com/questions/tagged/go\">go</a> expert, but you <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> function takes an array. From <a href=\"https://stackoverflow.com/questions/tagged/go\">go</a> side you are passing a simple pointer."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1477304150, "post_id": 40212918, "comment_id": 67695481, "body": "Thanks for your comment @LPs, declaring an array and passing a pointer to the first element works (the function actually accepts a char * ). The message is printed."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477313293, "post_id": 40212918, "comment_id": 67700924, "body": "<code>C.GoString</code> allocates space as necessary, and it should work in this instance whenever you have a null terminated string. If The string isn&#39;t null terminated, or may contain null characters, just treat it as bytes, and use <code>C.GoBytes</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1477313467, "post_id": 40212918, "comment_id": 67701034, "body": "@LPs: doesn&#39;t the array decay to a pointer in the C function anyway?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1477314205, "post_id": 40212918, "comment_id": 67701541, "body": "@JimB Yes, for sure. It decay to a pointer. But not the contrary: if you use a pointer it has to point to an allocated memory."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1477318799, "post_id": 40212918, "comment_id": 67704878, "body": "@LPs: ah yes, I now I see what the question is ;)"}], "answers": [{"comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1477344649, "post_id": 40221039, "comment_id": 67718981, "body": "Brilliant, thanks @JimB. Appreciate the tip to avoid the copy."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1477333186, "last_edit_date": 1477333186, "creation_date": 1477319468, "answer_id": 40221039, "question_id": 40212918, "link": "https://stackoverflow.com/questions/40212918/how-to-read-a-string-from-a-c-function-into-go/40221039#40221039", "title": "How to read a string from a C function into Go?", "body": "<p>In your first example you are passing a <code>nil</code> pointer, so there is no allocated memory for <code>C.last_error</code> to write the output to (and luckily, it appears to just do nothing).</p>\n\n<p>You need to allocate the memory somehow, and the most straightforward way to do that in Go is to use a slice, rather than create an array with a static size. </p>\n\n<pre><code>buf := make([]byte, ERROR_SIZE)\nC.last_error((*C.char)(unsafe.Pointer(&amp;buf[0])), len(buf))\n\n// While C.GoString will find the terminating null if it's there, \n// there's no reason to copy the string in C, and allocate another slice.\nif i := bytes.IndexByte(buf, 0); i &gt;= 0 {\n    buf = buf[:i]\n}\n\nfmt.Printf(\"message: %s\\n\", buf)\n</code></pre>\n"}], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 0, "accepted_answer_id": 40221039, "answer_count": 1, "score": 1, "last_activity_date": 1477333186, "creation_date": 1477294358, "last_edit_date": 1477303811, "question_id": 40212918, "link": "https://stackoverflow.com/questions/40212918/how-to-read-a-string-from-a-c-function-into-go", "title": "How to read a string from a C function into Go?", "body": "<p>I'm trying to call a C function from Go with cgo to read an error message. The function produces a message of an unknown length less than 256 bytes.</p>\n\n<p>Working example in C:</p>\n\n<pre><code>char message[ERROR_SIZE]; //256\nlast_error( message, sizeof(message) );         \nprintf( \"message: %s\\n\", message );\n</code></pre>\n\n<p>My attempt in Go (not working):</p>\n\n<pre><code>var ptr *C.char\nC.last_error(ptr, ERROR_SIZE)\nvar message = C.GoString(ptr)\nfmt.Printf(\"message: %s\\n\", message)\n</code></pre>\n\n<p>When the go code is run, the message is empty. Does the go version need to preallocate space for the message? How to do this?</p>\n\n<hr>\n\n<p>Update after comment by LPs to pass an array. This works, but seems a bit awkward:</p>\n\n<pre><code>var buf [ERROR_SIZE]byte\nvar ptr = (*C.char)(unsafe.Pointer(&amp;buf[0]))\nC.last_error(ptr, len(buf))\nvar message = C.GoString(ptr)\nfmt.Printf(\"message: %s\\n\", message)\n</code></pre>\n\n<p>Is there a simpler way?</p>\n"}, {"tags": ["go", "websocket", "gopherjs"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1477323467, "creation_date": 1477323467, "answer_id": 40222306, "question_id": 40212148, "link": "https://stackoverflow.com/questions/40212148/websocket-compatibility-with-gopherjs/40222306#40222306", "title": "WebSocket compatibility with GopherJS", "body": "<p>I don't have any guidance on what you should do, but can share these facts:</p>\n\n<p>The gorilla/websocket package is an implementation of the Websocket protocol on TCP connections. Because browser applications cannot access TCP connections directly, the gorilla/websocket package will not run in the browser.</p>\n\n<p>There's a difference in the models presented by gorilla/websocket package and the gopherjs/websocket packages. The WebSocket protocol is message-based and the gorilla/websocket package exposes an API around messages. The gopherjs/websocket provides bindings that make the message-based WebSocket protocol look like a stream of bytes. Messages are not exposed in the gopherjs/websocket API.</p>\n\n<p>The x/net/websocket package is all but abandoned. There are <a href=\"https://github.com/golang/go/issues/7632\" rel=\"nofollow\">long standing issues with protocol compliance</a> that have not been addressed.</p>\n"}], "owner": {"reputation": 3760, "user_id": 68573, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5da07e59b10b6827e3f0c0a4c2ade987?s=128&d=identicon&r=PG", "display_name": "jeffcook2150", "link": "https://stackoverflow.com/users/68573/jeffcook2150"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "closed_date": 1492318166, "answer_count": 1, "score": 0, "last_activity_date": 1477323467, "creation_date": 1477291373, "question_id": 40212148, "link": "https://stackoverflow.com/questions/40212148/websocket-compatibility-with-gopherjs", "closed_reason": "Opinion-based", "title": "WebSocket compatibility with GopherJS", "body": "<p>Looking for some general guidance on how to implement a WebSocket client in a way that works on both native Go execution platforms and through GopherJS.</p>\n\n<p>It appears that GopherJS has two WebSocket libraries, one at <a href=\"https://github.com/gopherjs/websocket\" rel=\"nofollow\"><code>gopherjs/websocket</code></a> and one at <a href=\"https://github.com/goxjs/websocket\" rel=\"nofollow\"><code>goxjs/websocket</code></a>. It seems that <code>goxjs/websocket</code> is \"isomorphic\", meaning it should work in GopherJS while remaining API-compatible with <code>golang.org/x/net/websocket</code>. That would provide compatibility in both execution environments, which is fine, but I'm not sure if it's the best solution. <code>gopherjs/websocket</code> doesn't appear to work outside of the browser execution environment, so it's a non-starter.</p>\n\n<p>The most recommended WebSocket implementation for native Go apps seems to be <a href=\"https://github.com/gorilla/websocket\" rel=\"nofollow\"><code>gorilla/websocket</code></a> at the moment. I'd like to use this as it seems to have a good API and it seems rather fully-featured. I <em>can</em> successfully run <code>gopherjs build</code> if I import <code>gorilla/websocket</code>, but I'm concerned that it will fail in the JavaScript environment, or that it will be compiled down into JavaScript that doesn't use the browser's implementation of the WebSocket API.</p>\n\n<p>I'm not seeing much guidance on which library is appropriate for which scenario, so hoping this can help compare and contrast and provide the direction necessary to make a good choice.</p>\n"}, {"tags": ["unit-testing", "go", "delve"], "comments": [{"owner": {"reputation": 48, "user_id": 3188737, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nLDVwXD0GBs/AAAAAAAAAAI/AAAAAAAANFE/3hWLM1sCsnA/photo.jpg?sz=128", "display_name": "jhselvik", "link": "https://stackoverflow.com/users/3188737/jhselvik"}, "edited": false, "score": 0, "creation_date": 1493582784, "post_id": 40211159, "comment_id": 74465612, "body": "It looks like there is a related question <a href=\"http://stackoverflow.com/questions/43380530/debugging-tests-with-delve\">here</a> with some details."}], "owner": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1477286293, "creation_date": 1477286293, "question_id": 40211159, "link": "https://stackoverflow.com/questions/40211159/golang-delve-drop-into-debugger-when-unit-test-fails", "title": "Golang Delve: Drop into debugger when unit test fails", "body": "<p>I'm trying to have Delve drop into a debugger when a test from the <code>testing</code> package fails. How can I do this?</p>\n\n<p>For reference, I'm looking for functionality similar to nose, pytest, or other python testing packages. <a href=\"http://nose.readthedocs.io/en/latest/plugins/debug.html\" rel=\"nofollow\">Using nose</a>, I can do</p>\n\n<pre><code>nosetests test_things.py --pdb\n</code></pre>\n\n<p>which would let me trop into a debugger when any unit tests fail.</p>\n"}, {"tags": ["session", "go", "gob"], "owner": {"reputation": 11, "user_id": 7062185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Of6Ae.jpg?s=128&g=1", "display_name": "Tal Lannder", "link": "https://stackoverflow.com/users/7062185/tal-lannder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1482223621, "creation_date": 1477270970, "last_edit_date": 1482223621, "question_id": 40209415, "link": "https://stackoverflow.com/questions/40209415/beego-session-save-struct", "title": "beego session save struct", "body": "<p>I'm giving up after few weeks, can't figure out a way to encode/decode a struct in session between <strong>beego</strong> apps.</p>\n\n<p>Question:\nHow to store properly in session a struct say <a href=\"https://github.com/TalLannder/app1/blob/master/models/user.go\" rel=\"nofollow noreferrer\"><code>app1/models/User</code></a> and decode it in other process/app to <a href=\"https://github.com/TalLannder/app2/blob/master/models/user.go\" rel=\"nofollow noreferrer\"><code>app2/models/User</code></a> without importing anything from app1?</p>\n\n<p>in app2 we do know the struct structure:</p>\n\n<pre><code>struct {\n  Name string\n  Age    int\n}\n</code></pre>\n\n<p>I've put together two examples for app1 and app2, not sure if they are of any help since in app2 I cant properly decode the struct :(.</p>\n\n<p><a href=\"https://github.com/TalLannder/app1\" rel=\"nofollow noreferrer\">https://github.com/TalLannder/app1</a></p>\n\n<p><a href=\"https://github.com/TalLannder/app2\" rel=\"nofollow noreferrer\">https://github.com/TalLannder/app2</a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "edited": false, "score": 0, "creation_date": 1477286812, "post_id": 40209921, "comment_id": 67686482, "body": "Thanks for the answer, but do you think by upload the entire workspace is a good?"}, {"owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "reply_to_user": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "edited": false, "score": 0, "creation_date": 1477318688, "post_id": 40209921, "comment_id": 67704805, "body": "Oops, sorry, yah, I could have addressed the original question at the begining. I don&#39;t know your particular use case well enough to say, but in general I&#39;d say &quot;no, that&#39;s a bad idea&quot;. It&#39;s just going to make things harder to manage as your workspace grows, and people will have to create work arounds and hacks to make it fit in with their normal development process (where they may want things in their workspace that aren&#39;t in the global one, but that they don&#39;t want to accidentally check in to Git)."}], "tags": [], "owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "is_accepted": false, "score": 3, "last_activity_date": 1477276253, "creation_date": 1477276253, "answer_id": 40209921, "question_id": 40209254, "link": "https://stackoverflow.com/questions/40209254/golang-workspace-for-a-project/40209921#40209921", "title": "Golang workspace for a project", "body": "<p>If you expect your server to move frequently one possible solution is to use a <a href=\"https://golang.org/cmd/go/#hdr-Remote_import_paths\" rel=\"nofollow\">vanity import path</a>.</p>\n\n<p>Vanity import paths allow you to keep your code at an import path on a domain you own which redirects you to the location where the code is stored. For instance, if you host your code on Bitbucket but are worried you might move in the future and you own the domain <code>example.net</code>, you could host your code such that you'd import it with <code>import \"example.net/myproject\"</code> and behind the scenes the <code>go get</code> tool would fetch it from Bitbucket. To do this, you must serve a document on the domain you want that contains a custom meta tag of the form:</p>\n\n<pre><code>&lt;meta name=\"go-import\" content=\"import-prefix vcs repo-root\"&gt;\n</code></pre>\n\n<p>So for instance serving the following HTML file at <code>example.net/myproject</code> would redirect <code>go get</code> to clone the provided Bitbucket URL (it could also of course point to any other Git service including your own):</p>\n\n<pre><code>&lt;meta name=\"go-import\" content=\"example.net/myproject git https://bitbucket.org/myname/myproject.git\"&gt;\n</code></pre>\n\n<p>To configure Nginx to serve these redirects, a configuration like the following can be used (replacing <code>myPackage</code> and the URLs with your projects name and URLs, of course):</p>\n\n<pre><code>location ~ /myPackage/[a-z][a-z0-9]* {\n    if ($args = \"go-get=1\") {\n        add_header Content-Type text/html;\n        return 200 '&lt;meta name=\"go-import\" content=\"$host/myPackage git https://bitbucket.org/myName/myPackage.git\"&gt;';\n    }\n    rewrite ^ https://mygithosting.example.org/myName/myPackage? permanent;\n}\nlocation ~ /myPackage$ {\n    if ($args = \"go-get=1\") {\n        add_header Content-Type text/html;\n        return 200 '&lt;meta name=\"go-import\" content=\"$host/myPackage git https://mygithosting.example.org/myName/myPackage.git\"&gt;';\n    }\n    rewrite ^ https://mygithosting.example.org/myName/myPackage? permanent;\n}\n</code></pre>\n\n<p>Now any time you move your Git server, you can just change the URL in the meta tag.</p>\n\n<p>If you're worried about some users importing directly from your Git server and others using the vanity import path, you can also set this path as the packages canonical import path. Canonical import paths are specified as special comments on the <code>package</code> line in one file of a Go program (it doesn't matter which one). They look like this:</p>\n\n<pre><code>import mypackage // import \"example.com/mypackage\"\n</code></pre>\n\n<p>Now if the above code is actually hosted somewhere else and someone tries to import it directly, <code>go get</code> will complain:</p>\n\n<p>$ go get mygithosting.example.org/myName/myPackage\npackage mygithosting.example.org/myName/myPackage: code in directory /go/mygithosting.example.org/myName/myPackage expects import \"example.com/mypackage\"</p>\n"}], "owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477276253, "creation_date": 1477269620, "question_id": 40209254, "link": "https://stackoverflow.com/questions/40209254/golang-workspace-for-a-project", "title": "Golang workspace for a project", "body": "<p>I have a golang project and I put the code somewhere in git server.\nAll my code are now on $GOPATH/mygitserver/folder/.</p>\n\n<p>Everything is goods until the time that the gitserver is changes the url, so I need to replace all import to new gitserver url. So, i don't want to have it again in the future and want to change the way it works.</p>\n\n<p>So instead of push the package only to my git server, now I am planning to upload the entire workspace to git (exclude the external library). So, I will have a package direcly to src folder (example : src/mypackage). So, when I change the gitserver url, everything will still works.</p>\n\n<p>The question is : is it a good practice to do it (upload the workspace to git)? Or do we have another option?</p>\n\n<p>And also it comes with another problem that not exist before. So, after I clone my workspace, I have to call \"go get\" for all of my library used by the project. (This not happen before because when I call go get mygitserver/package, Golang automatically download the dependency). Is there any way to make all the dependency downloaded my just one command?</p>\n"}, {"tags": ["go", "directory", "vendor", "glide-golang"], "comments": [{"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1477341934, "post_id": 40207922, "comment_id": 67717836, "body": "Is there a reason you don&#39;t want to use the full path to your user pkg? Your life will be a lot easier if you develop your Go programs like everyone else."}, {"owner": {"reputation": 41, "user_id": 6827635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdf22d2653346da9a1d217ddf8915e6?s=128&d=identicon&r=PG&f=1", "display_name": "user6827635", "link": "https://stackoverflow.com/users/6827635/user6827635"}, "reply_to_user": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1477411469, "post_id": 40207922, "comment_id": 67751509, "body": "The full path to the package would be, in my case      &#39;import &quot;./user&quot;&#39;  . That will fail to build due to a compliant about local imports. I could include the folder name like &#39;import &quot;MyCode/user&quot;&#39; but if I change the folder name the code won&#39;t compile and I would need all references to MyCode changed to the new folder name"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1477428293, "post_id": 40207922, "comment_id": 67761184, "body": "Why would the folder name change? All of the code in MyCode aka your application should be code that is written for MyCode and be imported with the path prefix of &quot;MyCode/&quot;. If you you have code that you plan on reusing in other projects that code should be under a different path/repo and MyCode should/could list that code as a dependency."}, {"owner": {"reputation": 41, "user_id": 6827635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdf22d2653346da9a1d217ddf8915e6?s=128&d=identicon&r=PG&f=1", "display_name": "user6827635", "link": "https://stackoverflow.com/users/6827635/user6827635"}, "reply_to_user": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1477435345, "post_id": 40207922, "comment_id": 67764423, "body": "It is common for me to git clone the project more than once in the same directory so that I&#39;m doing different work in different folders. You can&#39;t have two folders with the same name so one is renamed but if I do that the code will no longer build. I can try to avoid renaming the folder and changing my import statements to see how painful it is."}], "owner": {"reputation": 41, "user_id": 6827635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdf22d2653346da9a1d217ddf8915e6?s=128&d=identicon&r=PG&f=1", "display_name": "user6827635", "link": "https://stackoverflow.com/users/6827635/user6827635"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 284, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553439164, "creation_date": 1477257692, "last_edit_date": 1553439164, "question_id": 40207922, "link": "https://stackoverflow.com/questions/40207922/using-glide-with-subdirectories", "title": "Using glide with subdirectories", "body": "<p>I have the following structure for my project</p>\n\n<p>MyCode</p>\n\n<p>== main.go</p>\n\n<p>== user</p>\n\n<p>==== user.go</p>\n\n<p>I would like to build my code with 'go build' so in main.go I have a </p>\n\n<pre><code>import \"user\"\n</code></pre>\n\n<p>so that I can access the code in the package in that directory. In order to build this properly I would need my user directory inside my vendor directory. However, when I do a 'glide install' the user directory is deleted. I do not want to move my user directory into my vendor directory manually everytime. </p>\n\n<p>The goal is to git clone my project, do a glide install then a go build and have it work. Is there a way I can have glide move my user directory into the vendor directory without having to do it manually?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2549, "user_id": 181509, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/bc38deaf59377e15ec390fa1c7903393?s=128&d=identicon&r=PG", "display_name": "EmpireJones", "link": "https://stackoverflow.com/users/181509/empirejones"}, "edited": false, "score": 1, "creation_date": 1477259713, "post_id": 40208023, "comment_id": 67680877, "body": "Awesome, this is exactly what I was looking for. Thanks for the help! :)"}], "tags": [], "owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "is_accepted": true, "score": 2, "last_activity_date": 1477258916, "last_edit_date": 1477258916, "creation_date": 1477258573, "answer_id": 40208023, "question_id": 40207878, "link": "https://stackoverflow.com/questions/40207878/collections-of-generic-structs-with-embedded-locks-in-golang/40208023#40208023", "title": "Collections of generic structs with embedded locks in golang", "body": "<p>It's impossible to store the wrapping type in <code>[]*ThignWithLock</code> since go has no notion of structural subtyping.</p>\n\n<p>Your assertion that an interface will result in copying <a href=\"https://play.golang.org/p/yvUkmC4Vuw\" rel=\"nofollow\">is incorrect</a>, and you can get the desired effect by doing:</p>\n\n<pre><code>type InterfaceOfThingThatParticipatesInAHierarchy interface {\n    AddChild(InterfaceOfThingThatParticipatesInAHierarchy)\n    SetValue(int)\n}\n\ntype ThingWithLock struct {\n    ...\n    children []InterfaceOfThingThatParticipatesInAHierarchy\n}\n\nfunc (thingWithLock *ThingWithLock) AddChild(newChild InterfaceOfThingThatParticipatesInAHierarchy) { ... }\n</code></pre>\n\n<p>As long as the interface is implemented on a <code>*ThingWithLock</code> and not <code>ThingWithLock</code>, there will be no copying of the receiver struct itself, only the pointer to the struct will be copied on the stack.</p>\n"}], "owner": {"reputation": 2549, "user_id": 181509, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/bc38deaf59377e15ec390fa1c7903393?s=128&d=identicon&r=PG", "display_name": "EmpireJones", "link": "https://stackoverflow.com/users/181509/empirejones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 40208023, "answer_count": 1, "score": 0, "last_activity_date": 1477258916, "creation_date": 1477257327, "question_id": 40207878, "link": "https://stackoverflow.com/questions/40207878/collections-of-generic-structs-with-embedded-locks-in-golang", "title": "Collections of generic structs with embedded locks in golang", "body": "<p>Below I have an example of one structure which embeds another. I'm trying to figure out how to pass the more specific structure pointer to be stored in a less specific one. You can think of it as a collection. Wrapping in an interface doesn't seem to work, as doing so would make a copy, which isn't valid for structs with locks. Ideas?</p>\n\n<pre><code>package stackoverflow\n\nimport \"sync\"\n\ntype CoolerThingWithLock struct {\n    fancyStuff string\n    ThingWithLock\n}\n\nfunc NewCoolerThingWithLock() *CoolerThingWithLock {\n    coolerThingWithLock := &amp;CoolerThingWithLock{}\n    coolerThingWithLock.InitThingWithLock()\n    return coolerThingWithLock\n}\n\ntype ThingWithLock struct {\n    value    int\n    lock     sync.Mutex\n    children []*ThingWithLock\n}\n\nfunc (thingWithLock *ThingWithLock) InitThingWithLock() {\n    thingWithLock.children = make([]*ThingWithLock, 0)\n}\n\nfunc NewThingWithLock() *ThingWithLock {\n    newThingWithLock := &amp;ThingWithLock{}\n    newThingWithLock.InitThingWithLock()\n    return newThingWithLock\n}\n\nfunc (thingWithLock *ThingWithLock) AddChild(newChild *ThingWithLock) {\n    thingWithLock.children = append(thingWithLock.children, newChild)\n}\n\nfunc (thingWithLock *ThingWithLock) SetValue(newValue int) {\n    thingWithLock.lock.Lock()\n    defer thingWithLock.lock.Unlock()\n\n    thingWithLock.value = newValue\n\n    for _, child := range thingWithLock.children {\n        child.SetValue(newValue)\n    }\n}\n\nfunc main() {\n    thingOne := NewThingWithLock()\n    thingTwo := NewCoolerThingWithLock()\n    thingOne.AddChild(thingTwo)\n\n    thingOne.SetValue(42)\n}\n</code></pre>\n\n<blockquote>\n  <p>Error: cannot use thingTwo (type *CoolerThingWithLock) as type\n  *ThingWithLock in argument to thingOne.AddChild</p>\n</blockquote>\n"}, {"tags": ["oop", "go", "struct", "dependency-injection", "dependencies"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1477255811, "post_id": 40207528, "comment_id": 67679835, "body": "I&#39;m not sure exactly what you&#39;re asking, but I don&#39;t see anything wrong with what you&#39;re doing (other than passing <code>int</code> to those functions instead of <code>id</code> \u2013 it won&#39;t compile as-is)."}, {"owner": {"reputation": 1475, "user_id": 5203951, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/fd9dc7df52e3a9be33094cd877e3f8fb?s=128&d=identicon&r=PG", "display_name": "Yami Odymel", "link": "https://stackoverflow.com/users/5203951/yami-odymel"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1477256595, "post_id": 40207528, "comment_id": 67680052, "body": "Oops, thanks for the correction, like I said, I&#39;m from a OOP background, but I&#39;m not sure if I should bring my &quot;old thoughts&quot; to the new language, because I heard a lot about &quot;Don&#39;t use OOP in Golang&quot;, that&#39;s why I&#39;m not sure if I was doing it right or wrong."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 3, "creation_date": 1477257718, "post_id": 40207528, "comment_id": 67680367, "body": "I think admonitions against using OOP in Go are silly. Clearly, Go is not a typical object-oriented language in the model of C++ or Java, but it certainly has features that allow you to use OO principles in developing software. As you said, Go doesn&#39;t have traditional classes, but it has structs, interfaces, methods with receivers, and embedding, all of which allow you to do things that are similar to what you can do in an OO language. Some notable exceptions are the absence of constructors and destructors and there being no direct equivalent of subclassing (although embedding is similar)."}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1477323122, "post_id": 40207528, "comment_id": 67707745, "body": "im also unclear what you&#39;re asking so some random thougths: dependency injection is the way to go; you can certainly think of a struct definition as a class and instances of that struct as objects; and you may want a <code>func NewUser(m *models.User) User { ... }</code>"}, {"owner": {"reputation": 1475, "user_id": 5203951, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/fd9dc7df52e3a9be33094cd877e3f8fb?s=128&d=identicon&r=PG", "display_name": "Yami Odymel", "link": "https://stackoverflow.com/users/5203951/yami-odymel"}, "reply_to_user": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1477323671, "post_id": 40207528, "comment_id": 67708083, "body": "@Plato I considered to use <code>func NewUser(m *models.User) User { ... }</code> before, but I had to pass the <code>models.User</code> around my functions, plus, it&#39;s not flexible if I want to add a new parameter for the function."}], "answers": [{"tags": [], "owner": {"reputation": 1201, "user_id": 651028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d5887835c21dace586b98180544c74e?s=128&d=identicon&r=PG", "display_name": "Sergei G", "link": "https://stackoverflow.com/users/651028/sergei-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1477355779, "creation_date": 1477355779, "answer_id": 40229629, "question_id": 40207528, "link": "https://stackoverflow.com/questions/40207528/is-it-bad-to-use-a-struct-and-treat-it-like-a-class-to-solve-the-dependency-in-g/40229629#40229629", "title": "Is it bad to use a struct and treat it like a class to solve the dependency in Golang?", "body": "<p>From overall conceptual standpoint there is nothing wrong in your implementation.</p>\n\n<p>On a detailed view there are inconsistencies that raise questions.</p>\n\n<p>In all cases below there is a potential concurrency issue due to data shared across various Delete calls.</p>\n\n<h2>Case A</h2>\n\n<p>If models.User{} does all the work, then why can't we just</p>\n\n<pre><code>userModel := &amp;models.User{}\nuserModel.Delete(userId)\n</code></pre>\n\n<h1>Case B</h1>\n\n<p>If User is our public interface:</p>\n\n<pre><code>user      := User{model: userModel}\nuser.Delete(1)\n</code></pre>\n\n<p>then taking userId to delete is redundant and shall be done as:</p>\n\n<pre><code>user.Delete()\n</code></pre>\n\n<p>userId is taken from user context.</p>\n\n<h1>Case C</h1>\n\n<p>Otherwise, we might want to make userModel to be set for all User instances:</p>\n\n<pre><code>package User;\n// private package level variable\nvar model = userModel\nfunc Delete(userId int) {\n    model.Delete(userId)\n}\n...\nUser.Delete(userId)\n</code></pre>\n\n<h1>Conclusion</h1>\n\n<p>Each case above solves the same problem with a slightly different emphasis.  Case A is straightforward.  Case B and C rely on underlying shared code that could be used with event notifications.  Case B and C are different in User scope.  In Case B User is a structure.  In Case C user is a package name.  I think Case C is used less often than Case B.  So, if use insist on having an underlying model, then Case B is probably the most intuitive solution from user code point of view.</p>\n"}, {"tags": [], "owner": {"reputation": 1362, "user_id": 5699570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-fRpOyxCifSQ/AAAAAAAAAAI/AAAAAAAAAWA/NtmKw1pR05c/photo.jpg?sz=128", "display_name": "kien bui", "link": "https://stackoverflow.com/users/5699570/kien-bui"}, "is_accepted": false, "score": 1, "last_activity_date": 1494902777, "creation_date": 1494902777, "answer_id": 43991706, "question_id": 40207528, "link": "https://stackoverflow.com/questions/40207528/is-it-bad-to-use-a-struct-and-treat-it-like-a-class-to-solve-the-dependency-in-g/43991706#43991706", "title": "Is it bad to use a struct and treat it like a class to solve the dependency in Golang?", "body": "<p>you can use interface with method\n In service (connect db)</p>\n\n<pre><code>// UserServiceInterface include method list\ntype UserServiceInterface interface {\n    GetAll(helpers.ParamsGetAll) (models.PublicUsers, error)\n    Get(int64) (models.User, error)\n    Delete(int64) (bool, error)\n    Create(models.User) (int64, error)\n    Update(models.User) (models.User, error)\n    CheckExistUsername(string) (bool, error)\n    CheckExistEmail(string) (bool, error)\n    CreateEmailActive(string, string, int64) error\n    CheckExistUser(int64) (bool, error)\n}\n\n// UserService struct\ntype userService struct{}\n\n// NewUserService to constructor\nfunc NewUserService() userService {\n    return userService{}\n}\n\nfunc (userService )GetAll (p helpers.ParamGetAll)(models.PublicUser, error) {\n    code here....\n}\n</code></pre>\n\n<p>In user controller</p>\n\n<pre><code>// UserController controller\ntype UserController struct {\n    Service services.UserServiceInterface\n}\n    func (controller UserController) GetAll(c *gin.Context) {\n    users, errGetAll := controller.Service.GetAll(params)\n}\n</code></pre>\n"}], "owner": {"reputation": 1475, "user_id": 5203951, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/fd9dc7df52e3a9be33094cd877e3f8fb?s=128&d=identicon&r=PG", "display_name": "Yami Odymel", "link": "https://stackoverflow.com/users/5203951/yami-odymel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 40229629, "answer_count": 2, "score": 0, "last_activity_date": 1494902777, "creation_date": 1477254853, "last_edit_date": 1477256408, "question_id": 40207528, "link": "https://stackoverflow.com/questions/40207528/is-it-bad-to-use-a-struct-and-treat-it-like-a-class-to-solve-the-dependency-in-g", "title": "Is it bad to use a struct and treat it like a class to solve the dependency in Golang?", "body": "<p>I wrote a lot PHP with the OOP frameworks before, and I'm learning Golang,</p>\n\n<p>When I was using PHP, The <code>class</code> is useful that I could pass a <code>$model</code> in to my class then <strong>share it between functions</strong>:</p>\n\n<pre><code>class User {\n   function __construct(UserModel $model) {\n       $this-&gt;model = $model\n   }\n\n   function delete($id) {\n       $this-&gt;model-&gt;delete($id);\n   }\n\n   function update($id) {\n       $this-&gt;model-&gt;update($id);\n   }\n}\n\n$UserModel = new UserModel();\n$User      = new User($UserModel);\n$User-&gt;delete(1);\n</code></pre>\n\n<p>But there's no <code>class</code> in Golang, I knew that I could treat structs like a class:</p>\n\n<pre><code>type User struct {\n    model *models.User\n}\n\nfunc (u *User) Delete(id int) {\n    u.model.Delete(id)\n}\n\nfunc (u *User) Update(id int) {\n    u.model.Update(id)\n}\n\nuserModel := &amp;models.User{}\nuser      := User{model: userModel}\nuser.Delete(1)\n</code></pre>\n\n<p>I felt like the <code>struct</code> is <strong>used to store the information</strong>, and <strong>the method of the struct should be used to modify the value of the struct</strong>. </p>\n\n<p>But right now I made a struct just because I want to <strong>treat it like a class</strong> and <strong>solve the dependency</strong> problem, is it bad to use such approach in Golang?</p>\n"}, {"tags": ["go", "synchronization", "mutex"], "answers": [{"tags": [], "owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "is_accepted": true, "score": 3, "last_activity_date": 1477249131, "last_edit_date": 1477249131, "creation_date": 1477248775, "answer_id": 40206639, "question_id": 40206561, "link": "https://stackoverflow.com/questions/40206561/what-is-sync-sync-rwmutex-in-golang/40206639#40206639", "title": "what is sync (sync.RWMutex) in golang", "body": "<p>Gorrila's context associates data structures with one another by means of a map, but <a href=\"https://golang.org/doc/faq#atomic_maps\" rel=\"nofollow\">maps are not safe for concurrent use in go</a>.</p>\n\n<p>To allow multiple goroutines to safely access the same map, the mutex is used to ensure only one goro has write access to the map at any given time.</p>\n\n<p>However, since <a href=\"https://groups.google.com/forum/#!msg/golang-nuts/HpLWnGTp-n8/hyUYmnWJqiQJ\" rel=\"nofollow\">maps <em>are</em> safe for concurrent <em>reads</em> in go</a>, RWMutex allows shared concurrent access for reading data off of the map by splitting up the two access roles, sothat at any point in time there are either no lockers, a single write locker, or one or more read lockers currently holding the mutex.</p>\n"}], "owner": {"reputation": 680, "user_id": 5775751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4d69900ef436335a78df1ed16ee54f5?s=128&d=identicon&r=PG", "display_name": "onerciller", "link": "https://stackoverflow.com/users/5775751/onerciller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "accepted_answer_id": 40206639, "answer_count": 1, "score": 0, "last_activity_date": 1477249131, "creation_date": 1477248271, "question_id": 40206561, "link": "https://stackoverflow.com/questions/40206561/what-is-sync-sync-rwmutex-in-golang", "title": "what is sync (sync.RWMutex) in golang", "body": "<p>I am looking gorilla context to source code. I don't understand  what it does sync,mutex.Lock, mutex.Unlock exactly. it still is running when I removed mutex.Lock and Mutex.Unlock from source codes.  </p>\n\n<pre><code>import (\n    \"net/http\"\n    \"sync\"\n    \"time\"\n)\n\nvar (\n    mutex sync.RWMutex\n    data  = make(map[*http.Request]map[interface{}]interface{})\n    datat = make(map[*http.Request]int64)\n)\n\n// Set stores a value for a given key in a given request.\nfunc Set(r *http.Request, key, val interface{}) {\n    mutex.Lock()\n    if data[r] == nil {\n        data[r] = make(map[interface{}]interface{})\n        datat[r] = time.Now().Unix()\n    }\n    data[r][key] = val\n    mutex.Unlock()\n}\n</code></pre>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1477240146, "post_id": 40204770, "comment_id": 67674708, "body": "That limitation means that you cannot seek backward nor re-read any read section. Is that OK?"}, {"owner": {"reputation": 806, "user_id": 304957, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wYo2j.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/304957/rob"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1477240680, "post_id": 40204770, "comment_id": 67674906, "body": "Hey Tim, yeah, that&#39;d be fine.  The end goal would be a SectionReader, so no reading backwards and no re-reading necessary."}], "answers": [{"comments": [{"owner": {"reputation": 806, "user_id": 304957, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wYo2j.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/304957/rob"}, "edited": false, "score": 0, "creation_date": 1477248613, "post_id": 40206454, "comment_id": 67677530, "body": "This is great!  Thanks :)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1477254338, "post_id": 40206454, "comment_id": 67679395, "body": "2nd return should be <code>return written, err</code> instead of  <code>return 0, err</code>."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1477253345, "last_edit_date": 1477253345, "creation_date": 1477247681, "answer_id": 40206454, "question_id": 40204770, "link": "https://stackoverflow.com/questions/40204770/create-an-io-readerat-from-io-reader/40206454#40206454", "title": "Create an io.ReaderAt from io.Reader", "body": "<p>Yes, this is possible. As mentioned in my comment above, the implementation is limited in that you cannot seek backward nor can you re-read a section that has already been read.</p>\n\n<p>Here is a example implementation:</p>\n\n<pre><code>type unbufferedReaderAt struct {\n    R io.Reader\n    N int64\n}\n\nfunc NewUnbufferedReaderAt(r io.Reader) io.ReaderAt {\n    return &amp;unbufferedReaderAt{R: r}\n}\n\nfunc (u *unbufferedReaderAt) ReadAt(p []byte, off int64) (n int, err error) {\n    if off &lt; u.N {\n        return 0, errors.New(\"invalid offset\")\n    }\n    diff := off - u.N\n    written, err := io.CopyN(ioutil.Discard, u.R, diff)\n    u.N += written\n    if err != nil {\n        return 0, err\n    }\n\n    n, err = u.R.Read(p)\n    u.N += int64(n)\n    return\n}\n</code></pre>\n\n<p>Example usage:</p>\n\n<pre><code>s := strings.NewReader(\"hello world\")\n\nvar b [5]byte\nura := NewUnbufferedReaderAt(s)\nif _, err := ura.ReadAt(b[:], 0); err != nil {\n    panic(err)\n}\nfmt.Printf(\"%s\\n\", b[:]) // prints \"hello\"\n\n/*\nif _, err := ura.ReadAt(b[:], 0); err != nil {\n    panic(err) // panics\n}\nfmt.Printf(\"%s\\n\", b[:])\n*/\n\nif _, err := ura.ReadAt(b[:], 6); err != nil {\n    panic(err)\n}\nfmt.Printf(\"%s\\n\", b[:]) // prints \"world\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1071, "user_id": 241993, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/zfpeC.jpg?s=128&g=1", "display_name": "Mohamed Bana", "link": "https://stackoverflow.com/users/241993/mohamed-bana"}, "is_accepted": false, "score": 4, "last_activity_date": 1552918299, "creation_date": 1552918299, "answer_id": 55223341, "question_id": 40204770, "link": "https://stackoverflow.com/questions/40204770/create-an-io-readerat-from-io-reader/55223341#55223341", "title": "Create an io.ReaderAt from io.Reader", "body": "<p>Something like the below. Note <code>bytes.Reader</code> implements the <code>ReadAt(...)</code> method/function: <a href=\"https://golang.org/pkg/bytes/#Reader.ReadAt\" rel=\"nofollow noreferrer\">https://golang.org/pkg/bytes/#Reader.ReadAt</a>. So the line <code>bytes.NewReader</code> is esssentially what you are looking for.</p>\n\n<p>Getting a <code>bytes.Reader</code>:</p>\n\n<pre><code>var ioReader io.Reader\n...\nbuff := bytes.NewBuffer([]byte{})\nsize, err := io.Copy(buff, ioReader)\nif err != nil {\n    return err\n}\n\nreader := bytes.NewReader(buff.Bytes())\n// Do something with `reader`\n</code></pre>\n"}], "owner": {"reputation": 806, "user_id": 304957, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wYo2j.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/304957/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3616, "favorite_count": 2, "accepted_answer_id": 40206454, "answer_count": 2, "score": 3, "last_activity_date": 1552918299, "creation_date": 1477237870, "question_id": 40204770, "link": "https://stackoverflow.com/questions/40204770/create-an-io-readerat-from-io-reader", "title": "Create an io.ReaderAt from io.Reader", "body": "<p>Is there an implementation of <code>io.ReaderAt</code> that can be created from an implementation of <code>io.Reader</code> without first being read into a <code>[]byte</code> or <code>string</code>?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "edited": false, "score": 0, "creation_date": 1477213229, "post_id": 40201209, "comment_id": 67667322, "body": "Is <code>m</code> <code>nil</code> in the code that calls this?"}, {"owner": {"reputation": 4705, "user_id": 562465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f01d5241604fe5419279afc0d11e739d?s=128&d=identicon&r=PG", "display_name": "Rob Fox", "link": "https://stackoverflow.com/users/562465/rob-fox"}, "reply_to_user": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "edited": false, "score": 0, "creation_date": 1477213380, "post_id": 40201209, "comment_id": 67667352, "body": "I don&#39;t know, this happens rarely in production code. I haven&#39;t found a way to replicate it. Is it even possible for m to be nil in go?"}, {"owner": {"reputation": 973, "user_id": 2176812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U480Q.png?s=128&g=1", "display_name": "patilnitin", "link": "https://stackoverflow.com/users/2176812/patilnitin"}, "edited": false, "score": 0, "creation_date": 1491792185, "post_id": 40201209, "comment_id": 73695205, "body": "You have missed reffering m <a href=\"https://play.golang.org/p/j9T0dQ8-oH\" rel=\"nofollow noreferrer\">Updated</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4705, "user_id": 562465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f01d5241604fe5419279afc0d11e739d?s=128&d=identicon&r=PG", "display_name": "Rob Fox", "link": "https://stackoverflow.com/users/562465/rob-fox"}, "edited": false, "score": 0, "creation_date": 1477213871, "post_id": 40201281, "comment_id": 67667477, "body": "Oh I see, it confuses me that the error is for the Attributes function line. Is it ever usable to call a function on a nil object?"}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "reply_to_user": {"reputation": 4705, "user_id": 562465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f01d5241604fe5419279afc0d11e739d?s=128&d=identicon&r=PG", "display_name": "Rob Fox", "link": "https://stackoverflow.com/users/562465/rob-fox"}, "edited": false, "score": 1, "creation_date": 1477213977, "post_id": 40201281, "comment_id": 67667507, "body": "The problem is <i>dereferencing</i> the nil pointer in <code>m.hash</code>. If you comment out <code>+ m.hash</code> it will be fine - see <a href=\"https://play.golang.org/p/KSQ0cMxkmb\" rel=\"nofollow noreferrer\">play.golang.org/p/KSQ0cMxkmb</a> - (i.e. yes, it&#39;s ok to call a function with a <code>nil</code> object if you do not dereference the pointer)."}], "tags": [], "owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "is_accepted": true, "score": 17, "last_activity_date": 1477214653, "last_edit_date": 1477214653, "creation_date": 1477213736, "answer_id": 40201281, "question_id": 40201209, "link": "https://stackoverflow.com/questions/40201209/unexpected-invalid-memory-address-or-nil-pointer-dereference/40201281#40201281", "title": "Unexpected invalid memory address or nil pointer dereference", "body": "<p>This means that <code>Attributes</code> is being called with receiver <code>m</code> as <code>nil</code>.</p>\n\n<p>In principle methods can be called with <code>nil</code> receivers (and this may even be useful if they check for <code>nil</code>) - see <a href=\"http://groups.google.com/forum/#!topic/golang-nuts/wcrZ3P1zeAk\" rel=\"noreferrer\">here</a> - but this particular method <code>Attributes()</code> is not designed to be called with a <code>nil</code> receiver, as <code>m</code> is being dereferenced without a <code>nil</code> check. This (method being called with a <code>nil</code> receiver <code>m</code>) is what is happening in your calling code. </p>\n\n<p>See a simplified example <a href=\"https://play.golang.org/p/d-MxAtKMPG\" rel=\"noreferrer\">on the playground here</a>, and note that commenting out <code>+ m.hash</code> makes the whole thing work fine, as <a href=\"http://play.golang.org/p/KSQ0cMxkmb\" rel=\"noreferrer\">here</a>.</p>\n\n<p>Code below:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Channel struct {\n    hash string\n}\n\nfunc (m *Channel) Attributes() {\n    r := \"x\" + m.hash\n    fmt.Println(r)\n}\n\nfunc main() {\n    var c *Channel\n    c.Attributes()\n}\n</code></pre>\n\n<p>The output of which is:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0xffffffff addr=0x0 pc=0x20131]\n\ngoroutine 1 [running]:\npanic(0x102360, 0x1040a038)\n    /usr/local/go/src/runtime/panic.go:500 +0x720\nmain.(*Channel).Attributes(0x0, 0x104000f0)\n/tmp/sandbox285779060/main.go:12 +0x131\nmain.main()\n    /tmp/sandbox285779060/main.go:18 +0x20\n</code></pre>\n"}], "owner": {"reputation": 4705, "user_id": 562465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f01d5241604fe5419279afc0d11e739d?s=128&d=identicon&r=PG", "display_name": "Rob Fox", "link": "https://stackoverflow.com/users/562465/rob-fox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35921, "favorite_count": 2, "accepted_answer_id": 40201281, "answer_count": 1, "score": 16, "last_activity_date": 1491792185, "creation_date": 1477213125, "last_edit_date": 1477213404, "question_id": 40201209, "link": "https://stackoverflow.com/questions/40201209/unexpected-invalid-memory-address-or-nil-pointer-dereference", "title": "Unexpected invalid memory address or nil pointer dereference", "body": "<p>I'm getting a runtime error for an invalid memory address.</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x10 pc=0x4e0f24]\n\ngoroutine 1192592 [running]:\npanic(0x793540, 0xc420010040)\n#011/usr/local/go/src/runtime/panic.go:500 +0x1a1\nfoobar/sd.(*Channel).Attributes(0x0, 0xc420110101, 0xc42278f9b0, 0x9)\n#011/home/app/go/src/foobar/sd/channel.go:36 +0x54\n</code></pre>\n\n<p>channel.go looks like this:</p>\n\n<pre><code>35 func (m *Channel) Attributes() (*ChannelAttrs, error) {\n36    redisHash := \"sd:channels:\" + m.hash\n37\n38    rc := m.ctx.RedisPool.Get()\n39    values, err := redis.Values(rc.Do(\"HGETALL\", redisHash))\n40    rc.Close()\n41    if err != nil {\n42        return nil, err\n43    }\n44    attrs := ChannelAttrs{}\n45    redis.ScanStruct(values, &amp;attrs)\n46    return &amp;attrs, nil\n47 }\n</code></pre>\n\n<p>How is it possible that the line 36 is causing this? Is it somehow possible for <code>m</code> to be nil? If so, how?</p>\n\n<p>Note: hash is defined as string</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 74019, "user_id": 292291, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e31d9d39e9fb0ec4cc5573a5e5b01ce7?s=128&d=identicon&r=PG", "display_name": "Jiew Meng", "link": "https://stackoverflow.com/users/292291/jiew-meng"}, "edited": false, "score": 0, "creation_date": 1477205579, "post_id": 40200337, "comment_id": 67665825, "body": "yeah, then you will probably need to return r and pass it down the request chain, or else return the user, and have the middleware actually set it on the context."}, {"owner": {"reputation": 74019, "user_id": 292291, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e31d9d39e9fb0ec4cc5573a5e5b01ce7?s=128&d=identicon&r=PG", "display_name": "Jiew Meng", "link": "https://stackoverflow.com/users/292291/jiew-meng"}, "edited": false, "score": 0, "creation_date": 1477205615, "post_id": 40200337, "comment_id": 67665832, "body": "What I thought was that since request was passed by reference, it will be changed?"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 74019, "user_id": 292291, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e31d9d39e9fb0ec4cc5573a5e5b01ce7?s=128&d=identicon&r=PG", "display_name": "Jiew Meng", "link": "https://stackoverflow.com/users/292291/jiew-meng"}, "edited": false, "score": 0, "creation_date": 1477205689, "post_id": 40200337, "comment_id": 67665846, "body": "<code>*r = r.WithContext...</code> or something similar might do that. I&#39;m not super confident if that would or would not screw other things up though."}, {"owner": {"reputation": 7522, "user_id": 2142441, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1296edcd40a8fb8af4086e1544fcc2a9?s=128&d=identicon&r=PG", "display_name": "mattes", "link": "https://stackoverflow.com/users/2142441/mattes"}, "edited": false, "score": 0, "creation_date": 1523659117, "post_id": 40200337, "comment_id": 86667720, "body": "In regards to <code>*r = r.WithContext</code>, see also <a href=\"https://stackoverflow.com/questions/49825733/how-to-set-context-value-inside-http-handlefunc\" title=\"how to set context value inside http handlefunc\">stackoverflow.com/questions/49825733/&hellip;</a>"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 7, "last_activity_date": 1477205257, "creation_date": 1477205257, "answer_id": 40200337, "question_id": 40199880, "link": "https://stackoverflow.com/questions/40199880/how-to-use-golang-1-7-context-with-http-request-for-authentication/40200337#40200337", "title": "How to use golang 1.7 context with http.Request (for Authentication)", "body": "<p>It is not clear to me exactly how what you show is a \"middleware\", or how it is being executed. Since you are only changing your local variable <code>r</code>, and never giving that to anyone else, there is no way your change wil be visible outside your function.</p>\n\n<p>There have been a variety of middleware flavors in the go landscape, but since go 1.7 I have seen a lot more moving towards middleware functions of the form:</p>\n\n<pre><code>func IsAuthenticated(next http.Handler) http.Handler{\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request){\n       //authenticate. Set cookies.\n       //403 if not authenticated, etc.\n       ctx := context.WithValue(r.Context(), \"user\",u)\n       next(w,r.WithContext(ctx))\n    })\n}\n</code></pre>\n\n<p>This can be used to chain handlers together like so:</p>\n\n<pre><code>http.Handle(\"/foo/bar\", IsAuthenticated(myHandler))\n</code></pre>\n\n<p>(or use something like <a href=\"https://github.com/justinas/alice\" rel=\"noreferrer\">alice</a> to make chaining middlewares even easier.)</p>\n\n<p>This way, when <code>myHandler</code> gets invoked, it will have the new request created by <code>IsAuthenticated</code>, and it can fetch the user with something like:</p>\n\n<p><code>user := r.Context().Get(\"user\").(*User)</code></p>\n"}], "owner": {"reputation": 74019, "user_id": 292291, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e31d9d39e9fb0ec4cc5573a5e5b01ce7?s=128&d=identicon&r=PG", "display_name": "Jiew Meng", "link": "https://stackoverflow.com/users/292291/jiew-meng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1037, "favorite_count": 0, "accepted_answer_id": 40200337, "answer_count": 1, "score": 5, "last_activity_date": 1477205487, "creation_date": 1477200686, "last_edit_date": 1477205487, "question_id": 40199880, "link": "https://stackoverflow.com/questions/40199880/how-to-use-golang-1-7-context-with-http-request-for-authentication", "title": "How to use golang 1.7 context with http.Request (for Authentication)", "body": "<p>I have an <code>IsAuthenticated</code> function to check if the request is authenticated (checking the JWT in the <code>Authorization</code> header)</p>\n\n<pre><code>func IsAuthenticated(a *framework.AppContext, r *http.Request) (int, error) {\n  // ... do authentication. user is authenticated User object\n  ctx := context.WithValue(r.Context(), \"user\", user)\n  r = r.WithContext(ctx) \n  return 200, nil\n} \n</code></pre>\n\n<p>I find that it appears that <code>r = r.WithContext(ctx)</code> does not override the request object? How should I implement this? Do I need to requrn a request instead? </p>\n"}, {"tags": ["go", "fuse"], "comments": [{"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1584071417, "post_id": 40199047, "comment_id": 107330059, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/a/60663003\">Ensure a type implements an interface at compile time in Go</a>"}, {"owner": {"reputation": 3968, "user_id": 2402061, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VUGa3.png?s=128&g=1", "display_name": "Ricky Mutschlechner", "link": "https://stackoverflow.com/users/2402061/ricky-mutschlechner"}, "reply_to_user": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 1, "creation_date": 1584124409, "post_id": 40199047, "comment_id": 107350371, "body": "@TomL yes it does, as did the answer below my question that was also submitted almost 4 years ago. Thanks for checking though."}], "answers": [{"comments": [{"owner": {"reputation": 3968, "user_id": 2402061, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VUGa3.png?s=128&g=1", "display_name": "Ricky Mutschlechner", "link": "https://stackoverflow.com/users/2402061/ricky-mutschlechner"}, "edited": false, "score": 0, "creation_date": 1477197041, "post_id": 40199095, "comment_id": 67664610, "body": "Thanks! This was my hypothesis, but wanted to make sure from someone with more experience than myself :)"}, {"owner": {"reputation": 8073, "user_id": 2852624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/682806d261e4f00f77aa8633689a9558?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias247", "link": "https://stackoverflow.com/users/2852624/matthias247"}, "edited": false, "score": 1, "creation_date": 1477207363, "post_id": 40199095, "comment_id": 67666152, "body": "The pattern is also described in the Go documentation: <a href=\"https://golang.org/doc/effective_go.html#blank_implements\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#blank_implements</a>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1477192288, "last_edit_date": 1477192288, "creation_date": 1477191624, "answer_id": 40199095, "question_id": 40199047, "link": "https://stackoverflow.com/questions/40199047/what-does-this-snippet-of-go-do-is-it-inheritance/40199095#40199095", "title": "What does this snippet of Go do? Is it inheritance?", "body": "<p>This line of code is a compile time assertion that the type <code>*FS</code> satisfies the <code>fs.FS</code> interface.  The compiler reports an error if the assertion is not true:</p>\n\n<pre><code>*FS does not implement fs.FS (missing &lt;method name&gt; method)\n</code></pre>\n\n<p>The typical use of a line like this is to ensure that a type satisfies some interface and there's no other code in the package that depends on the type satisfying the interface.</p>\n\n<p>The line has no effect on the execution of the program.</p>\n"}], "owner": {"reputation": 3968, "user_id": 2402061, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VUGa3.png?s=128&g=1", "display_name": "Ricky Mutschlechner", "link": "https://stackoverflow.com/users/2402061/ricky-mutschlechner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 1, "accepted_answer_id": 40199095, "answer_count": 1, "score": 3, "last_activity_date": 1477192288, "creation_date": 1477190916, "question_id": 40199047, "link": "https://stackoverflow.com/questions/40199047/what-does-this-snippet-of-go-do-is-it-inheritance", "title": "What does this snippet of Go do? Is it inheritance?", "body": "<p>I'm reading <a href=\"https://blog.gopheracademy.com/advent-2014/fuse-zipfs/\" rel=\"nofollow\">a tutorial</a> on using Bazil/Fuse to make a file system using Go. </p>\n\n<p>In the tutorial, I see the following as an example (specifically to get the Root of the file system):</p>\n\n<pre><code>var _ fs.FS = (*FS)(nil)\n\nfunc (f *FS) Root() (fs.Node, fuse.Error) {\n    n := &amp;Dir{\n        archive: f.archive,\n    }\n    return n, nil\n}\n</code></pre>\n\n<p>The specific line I'm not understanding is the first one. What is that actually doing? I believe if I don't include that line, I can make the signature for this method whatever I want - if I do include it, I have to match their specific signature to override. </p>\n\n<p>Can someone explain exactly what this line does, and when I would want to use it?</p>\n"}, {"tags": ["windows", "go", "build"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 1, "creation_date": 1477191699, "post_id": 40199028, "comment_id": 67663916, "body": "your package is <code>github.com&#47;llnw&#47;login</code> and not <code>github.com&#47;llnw&#47;login&#47;login</code>, just execute <code>go build github.com&#47;llnw&#47;login</code>"}, {"owner": {"reputation": 293, "user_id": 3997991, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4acd506b7267eade68ce2a18028b1771?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Murphy", "link": "https://stackoverflow.com/users/3997991/steve-murphy"}, "reply_to_user": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1477231537, "post_id": 40199028, "comment_id": 67672167, "body": "Thanks, Yandry. You answered the question but there is no checkmark so I can&#39;t indicate that you answered it."}], "answers": [{"tags": [], "owner": {"reputation": 109227, "user_id": 641955, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/Hg2nO.jpg?s=128&g=1", "display_name": "janos", "link": "https://stackoverflow.com/users/641955/janos"}, "is_accepted": true, "score": 0, "last_activity_date": 1477201011, "creation_date": 1477201011, "answer_id": 40199919, "question_id": 40199028, "link": "https://stackoverflow.com/questions/40199028/running-go-install-results-in-error/40199919#40199919", "title": "Running go install results in error", "body": "<p>From <code>go build -h</code>:</p>\n\n<blockquote>\n<pre><code>usage: build [-o output] [-i] [build flags] [packages]\n\nBuild compiles the packages named by the import paths,\nalong with their dependencies, but it does not install the results.\n\nIf the arguments to build are a list of .go files, build treats\nthem as a list of source files specifying a single package.\n</code></pre>\n</blockquote>\n\n<p>In your example, <code>github.com/llnw/login/login</code> looks neither like a package, nor a list of <code>.go</code> files. Probably you're looking for this:</p>\n\n<pre><code>go build github.com/llnw/login\n</code></pre>\n\n<p>Assuming that when you execute this command, the relative path <code>github.com/llnw/login</code> exists.</p>\n"}], "owner": {"reputation": 293, "user_id": 3997991, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4acd506b7267eade68ce2a18028b1771?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Murphy", "link": "https://stackoverflow.com/users/3997991/steve-murphy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 40199919, "answer_count": 1, "score": 0, "last_activity_date": 1477201011, "creation_date": 1477190699, "question_id": 40199028, "link": "https://stackoverflow.com/questions/40199028/running-go-install-results-in-error", "title": "Running go install results in error", "body": "<p>I installed go on Windows. GOPATH is set to this:</p>\n\n<pre><code>    c:\\go-workspace\n</code></pre>\n\n<p>I have file called login.go in this directory:</p>\n\n<pre><code>    C:\\go-workspace\\src\\github.com\\llnw\\login\n</code></pre>\n\n<p>login.go contains this:</p>\n\n<pre><code>    package main\n    func main() {\n      fmt.Printf(\"login\\n\")\n    }\n</code></pre>\n\n<p>I tried the following to build:</p>\n\n<pre><code>    go build github.com/llnw/login/login\n</code></pre>\n\n<p>But I get this error:</p>\n\n<pre><code>    can't load package: package github.com/llnw/login/login: cannot find package \"github.com/llnw/login/login\" in any of:\n    C:\\Go\\src\\github.com\\llnw\\login\\login (from $GOROOT)\n    C:\\go-workspace\\src\\github.com\\llnw\\login\\login (from $GOPATH)\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["encryption", "go", "aes"], "comments": [{"owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 2, "creation_date": 1477200132, "post_id": 40199015, "comment_id": 67665017, "body": "I guess that you mean &#39;then&#39; instead of &#39;than&#39;."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1477198818, "creation_date": 1477198818, "answer_id": 40199701, "question_id": 40199015, "link": "https://stackoverflow.com/questions/40199015/golang-decrypt-a-command-than-execute-it/40199701#40199701", "title": "GoLang Decrypt a command than execute it", "body": "<p>Regarding the encryption/decryption, you can look at <a href=\"https://golang.org/src/crypto/cipher/example_test.go\" rel=\"nofollow\"><code>crypto/cipher/example_test.go</code></a>.</p>\n\n<p>All you need to is to <a href=\"https://gobyexample.com/writing-files\" rel=\"nofollow\">write the encrypted result into a file</a>, or <a href=\"https://gobyexample.com/reading-files\" rel=\"nofollow\">read the encrypted result</a>.</p>\n\n<p>Once decrypted, you can execute the string (provided it is a valid command) with exec.Command: see <a href=\"https://golang.org/src/os/exec/example_test.go\" rel=\"nofollow\"><code>os/exec/example_test.go</code></a>.</p>\n"}], "owner": {"reputation": 73, "user_id": 6636401, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/149305398832655/picture?type=large", "display_name": "Alex Rieker", "link": "https://stackoverflow.com/users/6636401/alex-rieker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1477198818, "creation_date": 1477190552, "question_id": 40199015, "link": "https://stackoverflow.com/questions/40199015/golang-decrypt-a-command-than-execute-it", "title": "GoLang Decrypt a command than execute it", "body": "<p>So I was wondering if you can decrypt a command than execute it...</p>\n\n<p>So the command is a exec.Command and I want to encrypt it in a separate file. Than take the hash (AES) and decrypt it in another file separately than when it is decrypted I want to execute it.</p>\n\n<p>I'm fairly new to Golang so excuse my misunderstanding of the language and its capabilities. </p>\n\n<p>Thank you in advanced.</p>\n"}, {"tags": ["go", "ms-word", "docx", "doc"], "comments": [{"owner": {"reputation": 8109, "user_id": 237351, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a2fb09f37c93194e9515f32de43bd258?s=128&d=identicon&r=PG", "display_name": "DMin", "link": "https://stackoverflow.com/users/237351/dmin"}, "edited": false, "score": 6, "creation_date": 1492619859, "post_id": 40196378, "comment_id": 74057101, "body": "Why was this downvoted? its the first result from google.."}], "answers": [{"tags": [], "owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "is_accepted": true, "score": 7, "last_activity_date": 1477168025, "creation_date": 1477168025, "answer_id": 40196722, "question_id": 40196378, "link": "https://stackoverflow.com/questions/40196378/parse-doc-docx-for-get-all-text-using-golang/40196722#40196722", "title": "Parse .doc &amp; .docx for get all text using golang?", "body": "<p>You can get some inspiration from those projects:</p>\n\n<p><a href=\"https://github.com/nguyenthenguyen/docx\" rel=\"noreferrer\">https://github.com/nguyenthenguyen/docx</a><br>\n<a href=\"https://github.com/opencontrol/doc-template\" rel=\"noreferrer\">https://github.com/opencontrol/doc-template</a></p>\n\n<p>Basically, DOCX is a Zip file with XMLs in it.\nAll the texts are inside <code>document.xml</code></p>\n\n<p>What both project do is remove all XML tags, leaving only text intact. You should see if that approach suits you too.</p>\n"}], "owner": {"reputation": 105, "user_id": 4598412, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/645848692209028/picture?type=large", "display_name": "Alexander Barac", "link": "https://stackoverflow.com/users/4598412/alexander-barac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6303, "favorite_count": 1, "accepted_answer_id": 40196722, "answer_count": 1, "score": 4, "last_activity_date": 1504401563, "creation_date": 1477165957, "last_edit_date": 1477170662, "question_id": 40196378, "link": "https://stackoverflow.com/questions/40196378/parse-doc-docx-for-get-all-text-using-golang", "title": "Parse .doc &amp; .docx for get all text using golang?", "body": "<p>How can I parse word documents \".doc\", \".docx\" to get all the text using golang?</p>\n"}, {"tags": ["oop", "go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 3, "creation_date": 1477161713, "post_id": 40195682, "comment_id": 67657245, "body": "The difference is that one calls the function on an interface and the other calls the function on a type."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1477176828, "post_id": 40195682, "comment_id": 67661448, "body": "Go doesn&#39;t force you to use OO, but the language has everything to do OOP"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1477223222, "post_id": 40195682, "comment_id": 67669837, "body": "Related / possible duplicates: <a href=\"http://stackoverflow.com/questions/29390736/go-embedded-struct-call-child-method-instead-parent-method\">one</a>; <a href=\"http://stackoverflow.com/questions/30622605/can-embedded-struct-method-have-knowledge-of-parent-child\">two</a>; <a href=\"http://stackoverflow.com/questions/29144622/what-is-the-idiomatic-way-in-go-to-create-a-complex-hierarchy-of-structs\">three</a>; <a href=\"http://stackoverflow.com/questions/36710259/go-ensuring-embedded-structs-implement-interface-without-introducing-ambiguity\">four</a>."}, {"owner": {"reputation": 3824, "user_id": 2728768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb82b13cda86d3b821fa44100335ddf?s=128&d=identicon&r=PG", "display_name": "thoeni", "link": "https://stackoverflow.com/users/2728768/thoeni"}, "edited": false, "score": 1, "creation_date": 1477313480, "post_id": 40195682, "comment_id": 67701038, "body": "If you&#39;re interested, these two articles are really good and can clarify some of your concerns: <a href=\"https://www.goinggo.net/2016/10/reducing-type-hierarchies.html\" rel=\"nofollow noreferrer\">goinggo.net/2016/10/reducing-type-hierarchies.html</a> and <a href=\"https://www.goinggo.net/2014/05/methods-interfaces-and-embedded-types.html\" rel=\"nofollow noreferrer\">goinggo.net/2014/05/methods-interfaces-and-embedded-types.ht&zwnj;&#8203;ml</a>"}, {"owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "reply_to_user": {"reputation": 3824, "user_id": 2728768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb82b13cda86d3b821fa44100335ddf?s=128&d=identicon&r=PG", "display_name": "thoeni", "link": "https://stackoverflow.com/users/2728768/thoeni"}, "edited": false, "score": 0, "creation_date": 1477357173, "post_id": 40195682, "comment_id": 67722593, "body": "@thoeni, very good links! Thx."}], "answers": [{"tags": [], "owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "is_accepted": false, "score": 2, "last_activity_date": 1477163384, "creation_date": 1477163384, "answer_id": 40195990, "question_id": 40195682, "link": "https://stackoverflow.com/questions/40195682/go-polymorphism/40195990#40195990", "title": "Go &quot;polymorphism&quot;", "body": "<p>First of all I would like to discuss the \"impossible\" part.</p>\n\n<pre><code>import \"fmt\"\n\ntype Animal interface {\n    Say() string\n}\n\ntype Cat struct {}\n\nfunc (cat Cat) Say() string {\n    return \"miao\"\n}\n\ntype Sheep struct {}\n\nfunc (sheep Sheep) Say() string {\n    return \"bahh\"\n}\n\ntype Cow struct {}\n\nfunc (cow Cow) Say() string {\n    return \"moo\"\n}\n\nfunc main() {\n\n    cat := Cat{}\n    sheep := Sheep{}\n    cow := Cow{}\n\n    fmt.Println(cat.Say())\n    fmt.Println(sheep.Say())\n    fmt.Println(cow.Say())\n}\n</code></pre>\n\n<p>This will work exactly as you would expect. So there is a polymorphism in terms of \"different structs responding differently to same method\".</p>\n\n<p>The intention of Exhibit#1 demonstrates that what Go does is actually similar to Java castings before @Overrides.</p>\n\n<p>Just add the following method to the first example and see how that will work:</p>\n\n<pre><code>func (this B) strange() {\n    fmt.Printf(\"my string is %q\\n\", this.str())\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 2, "last_activity_date": 1477172487, "last_edit_date": 1477172487, "creation_date": 1477163977, "answer_id": 40196098, "question_id": 40195682, "link": "https://stackoverflow.com/questions/40195682/go-polymorphism/40196098#40196098", "title": "Go &quot;polymorphism&quot;", "body": "<p>Your two exhibits are doing different things.</p>\n\n<p>In the first one, <code>B</code> has <code>A</code> embedded in it, and <code>B</code> doesn't implement the <code>strange()</code> method itself, so when you call <code>b.strange()</code>, you get the implementation of <code>strange()</code> defined for <code>A</code>. The receiver (<code>this</code>) of the <code>strange</code> method is <code>b.A</code>, not <code>b</code>, so the value <code>b.A.astring</code> is printed. If you wanted <code>strange</code> to print <code>bstring</code>, you would have to define <code>strange</code> for <code>B</code>.</p>\n\n<p>This points out one of the differences between Go and other OO languages: embedding <code>A</code> within <code>B</code> does not mean that <code>B</code> is a \"subclass\" of <code>A</code>, so an object of type <code>B</code> cannot be used where an object of type <code>A</code> is expected. However, since <code>B</code> inherits the fields and methods of <code>A</code>, any interface that's implemented by <code>A</code> is also implemented by <code>B</code>, and, unless those methods are defined specifically for <code>B</code>, they operate on the <code>A</code> within <code>B</code>, not <code>B</code> itself.</p>\n\n<p>In the second exhibit, you have the <code>Shape</code> interface which is implemented by the types <code>Circle</code> and <code>Rectangle</code>. The element type of your map is <code>Shape</code>, so any type that implements that interface can be an element in the map. When working with a value of an interface type as you are doing in the loop, you can call any method defined in the interface on the value, and the definition corresponding to the actual type of the value will be called.</p>\n"}], "owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 40196098, "answer_count": 2, "score": 2, "last_activity_date": 1477172487, "creation_date": 1477161414, "question_id": 40195682, "link": "https://stackoverflow.com/questions/40195682/go-polymorphism", "title": "Go &quot;polymorphism&quot;", "body": "<p>People are saying, Go is not an OO (Object Oriented) language; don't use OO terms on Go. OK, let me describe what I am able to do with OO --</p>\n\n<p>With an OO language, I can make different animals say different things based on their classes:</p>\n\n<pre><code>cat.Say() // miao\nsheep.Say() // bahh\ncow.Say() // moo\n</code></pre>\n\n<p>The same is getting the Area() from Shapes. </p>\n\n<p>However, <a href=\"https://github.com/suntong/lang/blob/master/lang/Go/src/oo/Polymorphism-Subtype.go\" rel=\"nofollow\">this go demo code</a> made me believe that it is impossible. Included below as Exhibit#1. </p>\n\n<p>Then today, I found <a href=\"https://github.com/suntong/lang/blob/master/lang/Go/src/oo/Polymorphism-Shape.go\" rel=\"nofollow\">this go demo code</a>, which makes it entirely possible. Included below as Exhibit#2. </p>\n\n<p>So my question is, what's fundamentally different between the two, that makes the first one wrong and second one correct? \nHow to make the first one \"works\"?</p>\n\n<p>Exhibit#1:</p>\n\n<pre><code>// Credits: hutch\n//          https://groups.google.com/d/msg/golang-nuts/N4MBApd09M8/0ij9yGHK_8EJ\n////////////////////////////////////////////////////////////////////////////\n\n/*\n\nhttps://groups.google.com/d/msg/golang-nuts/N4MBApd09M8/tOO5ZXtwbhYJ\n\nLRN:\n\nSubtype polymorphism: Not applicable (Go doesn't have subtyping).\nAlthough if you embed a struct A implementing interface X into a struct B,\nstruct B will implement interface X, and can be used instead of struct A in\nplaces where struct A is expected. So, kind of yes.\n\nRobert Johnstone:\n\ninterfaces behave similarly to virtual functions, but they are not identical.  See the (following) example program by hutch.\n\n*/\n\npackage main\n\nimport \"fmt\"\n\ntype A struct {\n    astring string\n}\n\ntype B struct {\n    A\n    bstring string\n}\n\ntype Funny interface {\n    strange()\n    str() string\n}\n\nfunc (this *A) strange() {\n    fmt.Printf(\"my string is %q\\n\", this.str())\n}\n\nfunc (this *A) str() string {\n    return this.astring\n}\n\nfunc (this *B) str() string {\n    return this.bstring\n}\n\nfunc main() {\n    b := new(B)\n    b.A.astring = \"this is an A string\"\n    b.bstring = \"this is a B string\"\n\n    b.strange()\n    // Output: my string is \"this is an A string\"\n\n    // Many people familiar with OO (and unfamiliar with Go) will be quite\n    // surprised at the output of that program.\n}\n</code></pre>\n\n<p>Exhibit#2:</p>\n\n<pre><code>// Credits: https://play.golang.org/p/Zn7TjiFQik\n////////////////////////////////////////////////////////////////////////////\n\n/*\n\nProblem (From Polymorphism-Subtype.go):\n\nhttps://groups.google.com/d/msg/golang-nuts/N4MBApd09M8/tOO5ZXtwbhYJ\n\nLRN: Subtype polymorphism: Not applicable (Go doesn't have subtyping).\n\nGoal:\n\nThis is to demo that \"polymorphism\" is still doable in Go.\n\n*/\n\npackage main\n\nimport (\n    \"fmt\"\n)\n\ntype Shape interface {\n    Area() float32\n}\n\ntype Point struct {\n    x float32\n    y float32\n}\n\n// Make sure the structs are different sizes so we're sure it'll work with\n// all sorts of types\ntype Circle struct {\n    center Point\n    radius float32\n}\n\nfunc (c Circle) Area() float32 {\n    return 3.1415 * c.radius * c.radius\n}\n\ntype Rectangle struct {\n    ul Point\n    lr Point\n}\n\nfunc (r Rectangle) Area() float32 {\n    xDiff := r.lr.x - r.ul.x\n    yDiff := r.ul.y - r.lr.y\n    return xDiff * yDiff\n}\n\nfunc main() {\n    mtDict := make(map[string]Shape)\n    // No problem storing different custom types in the multitype dict\n    mtDict[\"circ\"] = Circle{Point{3.0, 3.0}, 2.0}\n    mtDict[\"rect\"] = Rectangle{Point{2.0, 4.0}, Point{4.0, 2.0}}\n\n    for k, v := range mtDict {\n        fmt.Printf(\"[%v] [%0.2f]\\n\", k, v.Area())\n    }\n}\n\n/*\n\n$ go run Polymorphism-Shape.go\n[circ] [12.57]\n[rect] [4.00]\n\n*/\n</code></pre>\n"}, {"tags": ["date", "go"], "comments": [{"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1477160825, "post_id": 40195312, "comment_id": 67656956, "body": "It could be an issue with Time Zone conversion to UTC"}], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 2, "last_activity_date": 1477160966, "creation_date": 1477160966, "answer_id": 40195608, "question_id": 40195312, "link": "https://stackoverflow.com/questions/40195312/golang-date-parsing-a-yyyy-mm-dd-date/40195608#40195608", "title": "Golang - Date Parsing a YYYY-MM-DD date", "body": "<p>I think the correct way is to send <code>time.Time</code> type to your template and then use <code>Format</code> function on it. You can use <code>ParseTime</code> to parse your <code>2016-07-08</code> format.</p>\n\n<pre><code>type Data struct {\n    CreatedOn time.Time\n}\n\ntemplate.Execute(w, Data{})\n</code></pre>\n\n<p>Template:</p>\n\n<pre><code>&lt;span&gt;{{ .CreatedOn.Format \"January 02, 2006\" }}&lt;/span&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 247, "user_id": 1977351, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f7aa38696c910f7d786272695003a499?s=128&d=identicon&r=PG", "display_name": "user1977351", "link": "https://stackoverflow.com/users/1977351/user1977351"}, "edited": false, "score": 0, "creation_date": 1477166116, "post_id": 40196220, "comment_id": 67658686, "body": "Thank you very much. This was in depth and useful. Sorted out my problem due to this. Resulting code: {{ dateInZone &quot;January 02, 2006 (MST)&quot; .Date &quot;UTC&quot;}} Thank you - I have no idea how to mark your question as the answer thought :S."}, {"owner": {"reputation": 707, "user_id": 2071056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7147138fc22fbd2b9d71611506c93701?s=128&d=identicon&r=PG", "display_name": "davidcv5", "link": "https://stackoverflow.com/users/2071056/davidcv5"}, "reply_to_user": {"reputation": 247, "user_id": 1977351, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f7aa38696c910f7d786272695003a499?s=128&d=identicon&r=PG", "display_name": "user1977351", "link": "https://stackoverflow.com/users/1977351/user1977351"}, "edited": false, "score": 0, "creation_date": 1477166291, "post_id": 40196220, "comment_id": 67658737, "body": "Awesome, glad I could help. Good luck :) .. I see you marked it already.. Thanks."}], "tags": [], "owner": {"reputation": 707, "user_id": 2071056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7147138fc22fbd2b9d71611506c93701?s=128&d=identicon&r=PG", "display_name": "davidcv5", "link": "https://stackoverflow.com/users/2071056/davidcv5"}, "is_accepted": true, "score": 8, "last_activity_date": 1477165161, "last_edit_date": 1477165161, "creation_date": 1477164835, "answer_id": 40196220, "question_id": 40195312, "link": "https://stackoverflow.com/questions/40195312/golang-date-parsing-a-yyyy-mm-dd-date/40196220#40196220", "title": "Golang - Date Parsing a YYYY-MM-DD date", "body": "<p>It's because of the time zone, you're getting the right date, but <code>sprig</code> formats to <strong>\"Local\"</strong> by default, where <code>golang.org/pkg/time</code> defaults to <strong>\"UTC\"</strong></p>\n\n<p>Here is a sample code: <em>(omitting error handling for simplicity)</em></p>\n\n<pre><code>func main() {\n    // using the \"time\" package\n    mydate, _ := time.Parse(\"2006-01-02\", \"2016-07-08\")\n    fmt.Println(\"time:\", mydate.In(time.Local).Format(\"January 02, 2006 (MST)\"), \"-- specify Local time zone\")\n    fmt.Println(\"time:\", mydate.Format(\"January 02, 2006 (MST)\"), \"-- defaults to UTC\")\n\n    d := struct{ MyDate time.Time }{mydate}\n\n    //using sprig\n    fmap := sprig.TxtFuncMap()\n    localTpl := `sprig: {{ date \"January 02, 2006 (MST)\" .MyDate }} -- defaults to Local`\n    t := template.Must(template.New(\"test\").Funcs(fmap).Parse(localTpl))\n    var localdate bytes.Buffer\n    t.Execute(&amp;localdate, d)\n    fmt.Println(localdate.String())\n\n    utcTpl := `sprig: {{ dateInZone \"January 02, 2006 (MST)\" .MyDate \"UTC\"}} -- specify UTC time zone`\n    t = template.Must(template.New(\"test\").Funcs(fmap).Parse(utcTpl))\n    var utcdate bytes.Buffer\n    t.Execute(&amp;utcdate, d)\n    fmt.Println(utcdate.String())\n\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>time:  July 07, 2016 (EDT) -- specify Local time zone                                                                                  \ntime:  July 08, 2016 (UTC) -- defaults to UTC                                                                                          \nsprig: July 07, 2016 (EDT) -- defaults to Local                                                                                        \nsprig: July 08, 2016 (UTC) -- specify UTC time zone  \n</code></pre>\n\n<p>Here is some reference:</p>\n\n<p><strong>time</strong>: <a href=\"https://golang.org/pkg/time\" rel=\"noreferrer\">https://golang.org/pkg/time</a></p>\n\n<blockquote>\n  <p>In the absence of a time zone indicator, Parse returns a time in UTC.</p>\n</blockquote>\n\n<p><strong>spig</strong>: <a href=\"https://github.com/Masterminds/sprig/blob/master/functions.go#L407\" rel=\"noreferrer\">https://github.com/Masterminds/sprig/blob/master/functions.go#L407</a></p>\n\n<pre><code>func date(fmt string, date interface{}) string {\n    return dateInZone(fmt, date, \"Local\")\n}\n</code></pre>\n\n<p><strong>Note:</strong> if you want to format to a specific time zone, look at the 2nd template:</p>\n\n<pre><code>utcTpl := `sprig: {{ dateInZone \"January 02, 2006 (MST)\" .MyDate \"UTC\"}} -- specify UTC time zone`\n</code></pre>\n"}], "owner": {"reputation": 247, "user_id": 1977351, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f7aa38696c910f7d786272695003a499?s=128&d=identicon&r=PG", "display_name": "user1977351", "link": "https://stackoverflow.com/users/1977351/user1977351"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8786, "favorite_count": 2, "accepted_answer_id": 40196220, "answer_count": 2, "score": 3, "last_activity_date": 1477165161, "creation_date": 1477159153, "question_id": 40195312, "link": "https://stackoverflow.com/questions/40195312/golang-date-parsing-a-yyyy-mm-dd-date", "title": "Golang - Date Parsing a YYYY-MM-DD date", "body": "<p>Hi so I can't seem to find anything to help me on this.</p>\n\n<p>I am using the format string\n\"January 02, 2006\"\nand the time string\n\"2016-07-08\"</p>\n\n<p>However when I run a format using these parameters the response I get is July 7th, 2016. The correct response would be July 8th, 2016.</p>\n\n<p>As a note, I am also trying to use this via Sprig. </p>\n\n<pre><code>{{ date \"January 02, 2006\" .MyDate }}\n</code></pre>\n\n<p>If I can get any assistance it would be much appreciated</p>\n"}, {"tags": ["go", "json-rpc"], "answers": [{"comments": [{"owner": {"reputation": 999, "user_id": 1509414, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/410ac3df4157f9e37d90585d04018768?s=128&d=identicon&r=PG", "display_name": "Gavello", "link": "https://stackoverflow.com/users/1509414/gavello"}, "edited": false, "score": 0, "creation_date": 1477170549, "post_id": 40195501, "comment_id": 67660015, "body": "so you suggest to implement one service [service-identity-provider] where service authenticate and get a JWT containing claims regarding its authorizations than pass that token along with the RPC request as a parameter and use it for authorization verification on the other side of the request. Am I right?"}], "tags": [], "owner": {"reputation": 667, "user_id": 7058050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/307b8a4eb324c043ff6bba1370750097?s=128&d=identicon&r=PG&f=1", "display_name": "djd0", "link": "https://stackoverflow.com/users/7058050/djd0"}, "is_accepted": true, "score": 2, "last_activity_date": 1477160292, "creation_date": 1477160292, "answer_id": 40195501, "question_id": 40194599, "link": "https://stackoverflow.com/questions/40194599/golang-json-rpc-authorization/40195501#40195501", "title": "golang JSON RPC authorization", "body": "<p>You could handle authorisation in a similar way to authorisation of REST services.</p>\n\n<p>JSON Web Tokens (JWT) are a widely used authorisation method. You can find demonstrations and a conceptual overview of JWTs at <a href=\"https://jwt.io/\" rel=\"nofollow\">jwt.io</a>. In brief, JWTs are a signed JSON object, encoded as a string. The JSON object can make any number of arbitrary \"claims\" about the permissions the client has. </p>\n\n<p>Your service would sign a JWT (using a private key) and pass it to the client during authentication, which I suggest would be done by a JSON-RPC method that checks the permissions of the client (by API key, username and password or whatever). Your protected methods could then require a JWT as one of their parameters: performing their normal functionality if the JWT is verified and has the correct claims, else returning an error.</p>\n\n<p>I suggest having a look at the <a href=\"https://github.com/dgrijalva/jwt-go\" rel=\"nofollow\">github.com/dgrijalva/jwt-go</a> package. It provides methods for issuing and verifying JWTs.</p>\n"}], "owner": {"reputation": 999, "user_id": 1509414, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/410ac3df4157f9e37d90585d04018768?s=128&d=identicon&r=PG", "display_name": "Gavello", "link": "https://stackoverflow.com/users/1509414/gavello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1286, "favorite_count": 0, "accepted_answer_id": 40195501, "answer_count": 1, "score": 1, "last_activity_date": 1477160292, "creation_date": 1477154784, "question_id": 40194599, "link": "https://stackoverflow.com/questions/40194599/golang-json-rpc-authorization", "title": "golang JSON RPC authorization", "body": "<p>I was experimenting with RPC as alternative to some services actually implemented using http REST APIs. Since this services are actually not public and are used only by other services using RPC could make more sense.</p>\n\n<p>I'm looking for some hint regarding RPC authorization best practices\nsince I'm really not sure about the way to follow.</p>\n\n<p>I'm using golang for this </p>\n\n<ul>\n<li><p>how do I make sure an RPC get used only by authorized services</p></li>\n<li><p>can I authorize only a subset of the exposed procedures </p></li>\n</ul>\n\n<p>Thx</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 3, "creation_date": 1477152056, "post_id": 40194141, "comment_id": 67654201, "body": "Since Go regexp does not support lookarounds, you cannot combine them all into 1 regex."}], "answers": [{"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 2, "last_activity_date": 1477165016, "creation_date": 1477165016, "answer_id": 40196245, "question_id": 40194141, "link": "https://stackoverflow.com/questions/40194141/is-it-possible-to-perform-all-these-string-validations-in-a-single-regexp/40196245#40196245", "title": "Is it possible to perform all these string validations in a single regexp?", "body": "<p>It's possible, but it would be ugly. A single regexp would have to contain 24 subexpressions of the form <code>[0-9].*[a-z].*[A-Z].*\\W</code> to match each of the possible orders in which the four required character types could occur. The way you're doing it now is much better. </p>\n\n<p>By the way, instead of checking for errors from your <code>MatchString</code> calls (which means that the regular expression was invalid), you should probably precompile them with <code>regexp.MustCompile</code>, which panics if the regexp is invalid.</p>\n"}], "owner": {"reputation": 10946, "user_id": 1259261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a105607c3fd93df0d386c6d6a6b4aad?s=128&d=identicon&r=PG", "display_name": "Daniel Robinson", "link": "https://stackoverflow.com/users/1259261/daniel-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 40196245, "answer_count": 1, "score": 0, "last_activity_date": 1477165016, "creation_date": 1477151960, "last_edit_date": 1477152310, "question_id": 40194141, "link": "https://stackoverflow.com/questions/40194141/is-it-possible-to-perform-all-these-string-validations-in-a-single-regexp", "title": "Is it possible to perform all these string validations in a single regexp?", "body": "<p>I'm trying to figure out if I can combine all these statements into a single regexp check, but not being particularly well versed in regex doing it in these separate checks is the best I've got so far:</p>\n\n<pre><code>func ValidatePwd(pwd string) error {\n    pwdRuneCount := utf8.RuneCountInString(pwd)\n    containsAtLeastOneDigit, err := regexp.MatchString(\"[0-9]\", pwd)\n    if err != nil {\n        return err\n    }\n    containsAtLeastOneLowercase, err := regexp.MatchString(\"[a-z]\", pwd)\n    if err != nil {\n        return err\n    }\n    containsAtLeastOneUppercase, err := regexp.MatchString(\"[A-Z]\", pwd)\n    if err != nil {\n        return err\n    }\n    containsAtLeastOneNonWordChar, err := regexp.MatchString(`[\\W]`, pwd)\n    if err != nil {\n        return err\n    }\n    if pwdRuneCount &lt; PwdMinRuneCount || pwdRuneCount &gt; PwdMaxRuneCount || !containsAtLeastOneDigit || !containsAtLeastOneLowercase || !containsAtLeastOneUppercase || !containsAtLeastOneNonWordChar {\n        return PwdErr\n    }\n    return nil\n}\n</code></pre>\n"}, {"tags": ["json", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 2517, "user_id": 3654352, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/40fc4503427ae3fcf5c37b89dfad207b?s=128&d=identicon&r=PG", "display_name": "mehdy", "link": "https://stackoverflow.com/users/3654352/mehdy"}, "edited": false, "score": 0, "creation_date": 1477156084, "post_id": 40192874, "comment_id": 67655470, "body": "no it didn&#39;t work! its still there! and even if it could work it seems a little confusing to me! it may raise some problems!"}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": false, "score": 0, "last_activity_date": 1477143835, "creation_date": 1477143835, "answer_id": 40192874, "question_id": 40192738, "link": "https://stackoverflow.com/questions/40192738/how-to-include-exclude-a-structs-field-in-json-dynamically/40192874#40192874", "title": "How to include / exclude a struct&#39;s field in JSON dynamically?", "body": "<p>Try something like this:</p>\n\n<pre><code>type Base struct {\n    Name string `json: \"name,omitempty\"`\n    // ... other fields\n}\n\ntype First struct {\n    Base\n    // ... other fields\n}\n\ntype Second struct {\n    Base\n    Name string `json: \"-\"`\n    // ... other fields\n}\n</code></pre>\n\n<p>This means you must not call Second.Base.Name anymore in the code but just Second.Name.</p>\n"}, {"comments": [{"owner": {"reputation": 2517, "user_id": 3654352, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/40fc4503427ae3fcf5c37b89dfad207b?s=128&d=identicon&r=PG", "display_name": "mehdy", "link": "https://stackoverflow.com/users/3654352/mehdy"}, "edited": false, "score": 0, "creation_date": 1477162231, "post_id": 40195664, "comment_id": 67657399, "body": "it makes sense but I don&#39;t want to change the value! is it possible just to ignore the field in <code>MarshalJSON</code> function?"}, {"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "reply_to_user": {"reputation": 2517, "user_id": 3654352, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/40fc4503427ae3fcf5c37b89dfad207b?s=128&d=identicon&r=PG", "display_name": "mehdy", "link": "https://stackoverflow.com/users/3654352/mehdy"}, "edited": false, "score": 1, "creation_date": 1477168096, "post_id": 40195664, "comment_id": 67659296, "body": "@mehdy this is the cleanest solution. Once you have set as empty the Name property the json.Marshal will not parse and you will not able to get it again using the deserializer"}, {"owner": {"reputation": 680, "user_id": 3677188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d17944f3cb838dc1b4430a584a904d17?s=128&d=identicon&r=PG&f=1", "display_name": "tobiash", "link": "https://stackoverflow.com/users/3677188/tobiash"}, "edited": false, "score": 0, "creation_date": 1477235935, "post_id": 40195664, "comment_id": 67673512, "body": "maybe save the value prior to Marshal()? <code>foo := str.Base.Name; str.Base.Name = &quot;&quot;; result := json.Marshal(str); str.Base.Name = foo; return result</code>"}, {"owner": {"reputation": 2517, "user_id": 3654352, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/40fc4503427ae3fcf5c37b89dfad207b?s=128&d=identicon&r=PG", "display_name": "mehdy", "link": "https://stackoverflow.com/users/3654352/mehdy"}, "edited": false, "score": 3, "creation_date": 1477292239, "post_id": 40195664, "comment_id": 67688663, "body": "It&#39;s not possible! <code>json.Marshal(str)</code> leads to calling itself over and over and it&#39;ll cause stackoverflow"}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "reply_to_user": {"reputation": 2517, "user_id": 3654352, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/40fc4503427ae3fcf5c37b89dfad207b?s=128&d=identicon&r=PG", "display_name": "mehdy", "link": "https://stackoverflow.com/users/3654352/mehdy"}, "edited": false, "score": 0, "creation_date": 1477296642, "post_id": 40195664, "comment_id": 67691095, "body": "@mehdy Sorry about that, fixed it."}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "reply_to_user": {"reputation": 2517, "user_id": 3654352, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/40fc4503427ae3fcf5c37b89dfad207b?s=128&d=identicon&r=PG", "display_name": "mehdy", "link": "https://stackoverflow.com/users/3654352/mehdy"}, "edited": false, "score": 0, "creation_date": 1477538960, "post_id": 40195664, "comment_id": 67810416, "body": "@mehdy Is there anything else to clear up in the answer ? This approach also doesn&#39;t change the value in the struct."}, {"owner": {"reputation": 2517, "user_id": 3654352, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/40fc4503427ae3fcf5c37b89dfad207b?s=128&d=identicon&r=PG", "display_name": "mehdy", "link": "https://stackoverflow.com/users/3654352/mehdy"}, "edited": false, "score": 0, "creation_date": 1477552946, "post_id": 40195664, "comment_id": 67815795, "body": "@JohnSPerayil the problem is it&#39;s messy and I don&#39;t like it!"}], "tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": true, "score": 4, "last_activity_date": 1478791880, "last_edit_date": 1478791880, "creation_date": 1477161291, "answer_id": 40195664, "question_id": 40192738, "link": "https://stackoverflow.com/questions/40192738/how-to-include-exclude-a-structs-field-in-json-dynamically/40195664#40195664", "title": "How to include / exclude a struct&#39;s field in JSON dynamically?", "body": "<p>You can implement the <code>Marshaler</code> interface for type <code>Second</code> and create a dummy type <code>SecondClone</code>.</p>\n\n<pre><code>type SecondClone Second\n\nfunc (str Second) MarshalJSON() (byt []byte, err error) {\n\n   var temp SecondClone\n   temp = SecondClone(str)\n   temp.Base.Name = \"\"\n   return json.Marshal(temp)\n}\n</code></pre>\n\n<p>This will work with no other changes to your code.</p>\n\n<p>And it won't modify the value in <code>Name</code> as it works on a different type / copy.</p>\n"}], "owner": {"reputation": 2517, "user_id": 3654352, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/40fc4503427ae3fcf5c37b89dfad207b?s=128&d=identicon&r=PG", "display_name": "mehdy", "link": "https://stackoverflow.com/users/3654352/mehdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 961, "favorite_count": 0, "accepted_answer_id": 40195664, "answer_count": 2, "score": 5, "last_activity_date": 1478796015, "creation_date": 1477142977, "last_edit_date": 1478796015, "question_id": 40192738, "link": "https://stackoverflow.com/questions/40192738/how-to-include-exclude-a-structs-field-in-json-dynamically", "title": "How to include / exclude a struct&#39;s field in JSON dynamically?", "body": "<p>I have a \u200d\u200dstruct <code>Base</code> :</p>\n\n<pre><code>type Base struct {\n        Name string `json:\"name,omitempty\"`\n        // ... other fields\n}\n</code></pre>\n\n<p>And two more structs that embed <code>Base</code>:</p>\n\n<pre><code>type First struct {\n        Base\n        // ... other fields\n}\n\ntype Second struct {\n        Base\n        // ... other fields\n}\n</code></pre>\n\n<p>Now I want to Marshal the structs <code>First</code> and <code>Second</code> but with a little difference. I want  to include the <code>Name</code> field in <code>First</code> but I don't want to include it in <code>Second</code>.</p>\n\n<p>Or to simplify the question I want to opt in and out a struct's field in its JSON dynamically. </p>\n\n<p>Note:\nThe <code>Name</code> value <strong>always</strong> has value and I don't want to change it.</p>\n"}, {"tags": ["go", "tcp", "buffer", "telnet"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1477137241, "post_id": 40190438, "comment_id": 67649780, "body": "Yes you need to loop around the read to read more than once. Don&#39;t panic on errors, there&#39;s no reason to crash your program if the connection closes."}, {"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 1, "creation_date": 1477140789, "post_id": 40190438, "comment_id": 67650876, "body": "I think that this is the correct implementation. Just an hint: after you have called <code>conn.Close()</code> remeber call a break statement otherwise the for loop will run for ever"}, {"owner": {"reputation": 11294, "user_id": 1239122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/8cf239e31df87733c835e53851283548?s=128&d=identicon&r=PG", "display_name": "Gravy", "link": "https://stackoverflow.com/users/1239122/gravy"}, "edited": false, "score": 0, "creation_date": 1477176693, "post_id": 40190438, "comment_id": 67661427, "body": "JimB Thanks. Re panicking on errors - I was just doing in dev as I have not built proper error handler yet. And just wanted to capture the error. Tinwor - Good spot."}], "answers": [{"comments": [{"owner": {"reputation": 11294, "user_id": 1239122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/8cf239e31df87733c835e53851283548?s=128&d=identicon&r=PG", "display_name": "Gravy", "link": "https://stackoverflow.com/users/1239122/gravy"}, "edited": false, "score": 1, "creation_date": 1477176883, "post_id": 40191868, "comment_id": 67661455, "body": "Not quite what I wanted, but very useful. Thanks"}], "tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": false, "score": 3, "last_activity_date": 1541751918, "last_edit_date": 1541751918, "creation_date": 1477137350, "answer_id": 40191868, "question_id": 40190438, "link": "https://stackoverflow.com/questions/40190438/accept-a-persistent-tcp-connection-in-golang-server/40191868#40191868", "title": "Accept a persistent tcp connection in Golang Server", "body": "<p>Not sure if this is what you're looking for. Taken from <code>net/http</code> implementation, wrapping your <code>net.TCPListener</code>'s <code>Accept</code> method.</p>\n\n<p><code>tcpKeepAliveListener{listener.(*net.TCPListener)}</code></p>\n\n<pre><code>type tcpKeepAliveListener struct {\n    *net.TCPListener\n}\n\nfunc (ln tcpKeepAliveListener) Accept() (c net.Conn, err error) {\n    tc, err := ln.AcceptTCP()\n    if err != nil {\n        return\n    }\n    tc.SetKeepAlive(true)\n    tc.SetKeepAlivePeriod(3 * time.Minute)\n    return tc, nil\n}\n</code></pre>\n\n<p>Refer : <a href=\"https://github.com/golang/go/blob/release-branch.go1.7/src/net/http/server.go#L2219\" rel=\"nofollow noreferrer\">Link 1</a> &amp; <a href=\"https://github.com/golang/go/blob/release-branch.go1.7/src/net/http/server.go#L2599-L2615\" rel=\"nofollow noreferrer\">Link 2</a></p>\n"}, {"tags": [], "owner": {"reputation": 8073, "user_id": 2852624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/682806d261e4f00f77aa8633689a9558?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias247", "link": "https://stackoverflow.com/users/2852624/matthias247"}, "is_accepted": true, "score": 5, "last_activity_date": 1477138288, "creation_date": 1477138288, "answer_id": 40192014, "question_id": 40190438, "link": "https://stackoverflow.com/questions/40190438/accept-a-persistent-tcp-connection-in-golang-server/40192014#40192014", "title": "Accept a persistent tcp connection in Golang Server", "body": "<p>Your second example with the loop is already what you want. You simply loop and read as long as you want (or probably until some read/write timeout or an external cancellation signal).</p>\n\n<p>However it still has an error in it:\nTCP gives you a stream of bytes, where it is not guaranteed that one write from a side will yield exactly one read on the other side with the same data length. This means if the client writes <code>PING\\r\\n</code> you could still receive only <code>PI</code> in the first read. You could fix that by using a <code>bufio.Scanner</code> and always read up to the first newline.</p>\n"}], "owner": {"reputation": 11294, "user_id": 1239122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/8cf239e31df87733c835e53851283548?s=128&d=identicon&r=PG", "display_name": "Gravy", "link": "https://stackoverflow.com/users/1239122/gravy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4084, "favorite_count": 5, "accepted_answer_id": 40192014, "answer_count": 2, "score": 5, "last_activity_date": 1541751918, "creation_date": 1477128191, "last_edit_date": 1477128698, "question_id": 40190438, "link": "https://stackoverflow.com/questions/40190438/accept-a-persistent-tcp-connection-in-golang-server", "title": "Accept a persistent tcp connection in Golang Server", "body": "<p>I am experimenting with Go - and would like to create a TCP server which I can telnet to, send commands and receive responses.</p>\n\n<pre><code>const (\n    CONN_HOST = \"localhost\"\n    CONN_PORT = \"3333\"\n    CONN_TYPE = \"tcp\"\n)\n\nfunc main() {\n\n    listener, err := net.Listen(CONN_TYPE, fmt.Sprintf(\"%s:%s\", CONN_HOST, CONN_PORT))\n    if err != nil {\n        log.Panicln(err)\n    }\n\n    defer listener.Close()\n\n    for {\n        conn, err := listener.Accept()\n        if err != nil {\n            log.Panicln(err)\n        }\n\n        go handleRequest(conn)\n    }\n}\n\nfunc handleRequest(conn net.Conn) {\n    buffer := make([]byte, 1024)\n\n    length, err := conn.Read(buffer)\n    if err != nil {\n        log.Panicln(err)\n    }\n\n    str := string(buffer[:length])\n\n    fmt.Println(conn.RemoteAddr().String())\n    fmt.Printf(\"Received command %d\\t:%s\\n\", length, str)\n\n    switch str {\n        case \"PING\\r\\n\":\n        sendResponse(\"PONG\", conn)\n        case \"PUSH\\r\\n\":\n        sendResponse(\"GOT PUSH\", conn)\n    default:\n        conn.Write([]byte(fmt.Sprintf(\"UNKNOWN_COMMAND: %s\\n\", str)))\n    }\n\n    conn.Close() // closes the connection\n}\n\nfunc sendResponse(res string, conn net.Conn) {\n    conn.Write([]byte(res+\"\\n\"))\n}\n</code></pre>\n\n<p>The above snippet will close the connection every time, kicking me out of the terminal session. But what I actually want, is to be able to keep the connection open for more I/O operations. If I simply remove the <code>conn.Close()</code>, then the server appears to hang somewhere as it does not get any more responses.</p>\n\n<p>The way I have resolved this is to have my handleRequest method endlessly loop so that it never exits till it receives a <code>QUIT\\r\\n</code> message. Is this appropriate - or is there a better way of achieving?</p>\n\n<pre><code>func handleRequest(conn net.Conn) {\n    for {\n        log.Println(\"Handling Request\")\n        buffer := make([]byte, 1024)\n\n        length, err := conn.Read(buffer)\n        if err != nil {\n            log.Panicln(err)\n        }\n\n        str := string(buffer[:length])\n\n        fmt.Println(conn.RemoteAddr().String())\n        fmt.Printf(\"Received command %d\\t:%s\\n\", length, str)\n\n        switch str {\n        case \"PING\\r\\n\":\n            sendResponse(\"PONG\", conn)\n        case \"PUSH\\r\\n\":\n            sendResponse(\"GOT PUSH\", conn)\n        case \"QUIT\\r\\n\":\n            sendResponse(\"Goodbye\", conn)\n            conn.Close()\n        default:\n            conn.Write([]byte(fmt.Sprintf(\"UNKNOWN_COMMAND: %s\\n\", str)))\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1057, "user_id": 974990, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c5a813df5e1175a873c40b2bf07db802?s=128&d=identicon&r=PG", "display_name": "Gregorio Di Stefano", "link": "https://stackoverflow.com/users/974990/gregorio-di-stefano"}, "edited": false, "score": 0, "creation_date": 1477142312, "post_id": 40191551, "comment_id": 67651292, "body": "ouch, how did I miss this? Thanks!"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 2, "last_activity_date": 1477135498, "creation_date": 1477135498, "answer_id": 40191551, "question_id": 40190136, "link": "https://stackoverflow.com/questions/40190136/calculating-hash-of-encrypted-data-with-a-multiwriter/40191551#40191551", "title": "Calculating hash of encrypted data with a multiwriter", "body": "<p>You need to move your <code>io.MultiWriter</code> to be the writer of the <code>cipher.StreamWriter</code>. This will calculate the hash of the cypher text, rather than plain text:</p>\n\n<pre><code>writer := &amp;cipher.StreamWriter{\n    S: cipher.NewCTR(block, iv),\n    W: io.MultiWriter(writeFile, hash),\n}\nwriteFile.Write(iv)\n\nif _, err := io.Copy(writer, readFile); err != nil {\n    fmt.Println(\"error during crypto: \" + err.Error())\n    return \"\", err\n}\n</code></pre>\n"}], "owner": {"reputation": 1057, "user_id": 974990, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c5a813df5e1175a873c40b2bf07db802?s=128&d=identicon&r=PG", "display_name": "Gregorio Di Stefano", "link": "https://stackoverflow.com/users/974990/gregorio-di-stefano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 40191551, "answer_count": 1, "score": 1, "last_activity_date": 1477135498, "creation_date": 1477126062, "question_id": 40190136, "link": "https://stackoverflow.com/questions/40190136/calculating-hash-of-encrypted-data-with-a-multiwriter", "title": "Calculating hash of encrypted data with a multiwriter", "body": "<p>I was hoping to be able to calculate the hash of the encrypted data in parallel, but it seems like using a multiple writer as below, the hash is being calculate with plaintext bytes.</p>\n\n<p>Anyone know how I can use a single copy to achieve both encrypting the data and hashing it?</p>\n\n<pre><code>    writer := &amp;cipher.StreamWriter{S: cipher.NewCTR(block, iv), W: writeFile}\n    writeFile.Write(iv)\n\n    if _, err := io.Copy(io.MultiWriter(writer, hash), readFile); err != nil {\n        fmt.Println(\"error during crypto: \" + err.Error())\n        return \"\", err\n    }\n</code></pre>\n"}, {"tags": ["json", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 4115763, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/gtV8W.jpg?s=128&g=1", "display_name": "Master Sketchiggle", "link": "https://stackoverflow.com/users/4115763/master-sketchiggle"}, "edited": false, "score": 0, "creation_date": 1477125873, "post_id": 40189930, "comment_id": 67646764, "body": "Thanks. I don&#39;t full grasp the concept it seems. I tried to implement that change. See the edit above. What am I missing."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "reply_to_user": {"reputation": 83, "user_id": 4115763, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/gtV8W.jpg?s=128&g=1", "display_name": "Master Sketchiggle", "link": "https://stackoverflow.com/users/4115763/master-sketchiggle"}, "edited": false, "score": 0, "creation_date": 1477167577, "post_id": 40189930, "comment_id": 67659139, "body": "You&#39;re trying to Unmarshal a slice into a Chart struct, a little trick: if you see &#39;{ }&#39; in the json use structs of maps, and &#39;[ ]&#39; for slices. I edited my answer too :)"}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": false, "score": 1, "last_activity_date": 1477167439, "last_edit_date": 1495542805, "creation_date": 1477124650, "answer_id": 40189930, "question_id": 40189818, "link": "https://stackoverflow.com/questions/40189818/golang-to-json-creating-google-charts/40189930#40189930", "title": "Golang to Json, creating Google Charts", "body": "<p>I always use json-to-go is one of my favorites tool, but I found a bug <a href=\"https://github.com/mholt/json-to-go/issues/18\" rel=\"nofollow noreferrer\">https://github.com/mholt/json-to-go/issues/18</a></p>\n\n<p>Your struct should looks like: <code>type Chart [][]interface{}</code> in other words a slice of slices. See this question too <a href=\"https://stackoverflow.com/questions/39902502/unmarshall-nested-json-arrays-in-go-golang\">Unmarshall nested JSON Arrays in Go / Golang</a></p>\n\n<p><strong>Edit:</strong></p>\n\n<p>More specific your <strong>rows</strong> is a slice of slices of strings and numbers, so sadly we have to use something similar what I wrote you: <code>[][]interface{}</code> because a slice has to have the same type and in this case we have strings and numbers so the solution is empty interface{}. Also always try to use ticks `` to represent raw Json in Go it looks better and you don't have to escape quotes.</p>\n\n<pre><code>jsonString := `[\n    [\"Month\", \"Days\"], [\"Jan\", 31], [\"Feb\", 28], [\"Mar\", 31]\n]`\n\nvar rows [][]interface{}\n\nerr := json.Unmarshal([]byte(jsonString), &amp;rows)\n\nif err != nil {\n    fmt.Println(\"error:\", err)\n    return\n}\n\nfmt.Printf(\"%+v \\n\\n\", rows)\n\nfor _, row := range rows { // each row in this example is just one\n\n    if len(row) &lt; 2 {\n        fmt.Println(\"unexpected row len\")\n        continue // or return error\n    }\n\n    // we can access to [0] or [1]\n\n    month := row[0].(string) // column 1\n    day := row[1]            // column 2\n\n    if dayNumber, isNumber := day.(float64); isNumber { // by default use the biggest type for numbers float64\n        fmt.Println(\"Month:\", month, \"Day number:\", dayNumber)\n        continue\n    }\n\n    if dayStr, isString := day.(string); isString {\n        fmt.Println(\"Month:\", month, \"Day string:\", dayStr)\n        continue\n    }\n}\n</code></pre>\n\n<p>Full example: <a href=\"https://play.golang.org/p/ZGtBRqP3Uj\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ZGtBRqP3Uj</a></p>\n"}], "owner": {"reputation": 83, "user_id": 4115763, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/gtV8W.jpg?s=128&g=1", "display_name": "Master Sketchiggle", "link": "https://stackoverflow.com/users/4115763/master-sketchiggle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 815, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477167439, "creation_date": 1477123844, "last_edit_date": 1477125843, "question_id": 40189818, "link": "https://stackoverflow.com/questions/40189818/golang-to-json-creating-google-charts", "title": "Golang to Json, creating Google Charts", "body": "<p>I'm using Polymer Google Charts. I want to create JSON for a single Controller.ServeJSON call, but two if it's better design.</p>\n\n<p>Here is an example of what the JSON would include if it was two call.</p>\n\n<p>cols='[{\"label\":\"Mth\", \"type\":\"string\"}, {\"label\":\"Days\", \"type\":\"number\"}]'\nrows='[[\"Jan\", 31],[\"Feb\", 28],[\"Mar\", 31]]'</p>\n\n<p>And if it was one</p>\n\n<p>data='[[\"Month\", \"Days\"], [\"Jan\", 31], [\"Feb\", 28], [\"Mar\", 31]]'</p>\n\n<p>This can be found at <a href=\"https://elements.polymer-project.org/elements/google-chart\" rel=\"nofollow\">https://elements.polymer-project.org/elements/google-chart</a></p>\n\n<p>I used <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow\">https://mholt.github.io/json-to-go/</a> to convert the JSON into a struct.</p>\n\n<p>Assuming Two Calls, Got this..</p>\n\n<pre><code>    type Chart struct {\n        Cols []struct {\n            Label string `json:\"label\"`\n            Type  string `json:\"type\"`\n        } `json:\"cols\"`\n        Rows []struct {\n            Num0 string `json:\"0\"`\n            Num1 int    `json:\"1\"`\n</code></pre>\n\n<p>All help and advice would be most appreciated.</p>\n\n<p>Cheers.</p>\n\n<p>EDIT..</p>\n\n<pre><code>    func (c *ChillController) Get() {\n\njsonString := \"[[\\\"Month\\\", \\\"Days\\\"], [\\\"Jan\\\", 31], [\\\"Feb\\\", 28], [\\\"Mar\\\", 31]]\"\nd := [][]Chart{}\n\njson.Unmarshal([]byte(jsonString), &amp;d)\n\nfmt.Printf(\"%v\", &amp;d)\n\nc.Data[\"json\"] = &amp;d\nc.ServeJSON()\n</code></pre>\n\n<p>}</p>\n\n<p>And it returned..</p>\n\n<p>[\n  [\n    null,\n    null\n  ],\n  [\n    null,\n    null\n  ]\n]</p>\n\n<p>What have I missed.</p>\n"}, {"tags": ["heroku", "go", "deployment", "circleci"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1477110436, "post_id": 40188257, "comment_id": 67643746, "body": "If you&#39;re new in Go take the chance of not using a framework, there&#39;s no necessity to use it with Golang, good readings <a href=\"https://www.nicolasmerouze.com/build-web-framework-golang/\" rel=\"nofollow noreferrer\">nicolasmerouze.com/build-web-framework-golang</a> and <a href=\"https://medium.com/code-zen/why-i-don-t-use-go-web-frameworks-1087e1facfa4#.5lmlr8k6r\" rel=\"nofollow noreferrer\">medium.com/code-zen/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": true, "score": 1, "last_activity_date": 1477124455, "creation_date": 1477124455, "answer_id": 40189899, "question_id": 40188257, "link": "https://stackoverflow.com/questions/40188257/deployment-build-using-local-package-fails-with-import-path-does-not-begin-with/40189899#40189899", "title": "Deployment Build Using Local Package Fails with &quot;import path does not begin with hostname&quot;", "body": "<p>You need to have all imported libraries in your <code>$GOPATH</code> (external libs) or <code>$GOROOT</code> (std lib)</p>\n\n<p>The <code>go get</code> command can fetch libraries from remote and put them in your <code>$GOPATH</code></p>\n\n<p>So if you <code>go get github.com/labstack/echo</code> it fetches the library from the URL and places it in <code>$GOPATH/github.com/labstack/echo</code> locally.</p>\n\n<p>This is not possible for the library <code>go-todo/models</code> to be fetched remotely like that, so you need to make sure in your CI that it is copied and made available locally at <code>$GOPATH/go-todo/models</code>.</p>\n\n<p>Or you can try <a href=\"https://blog.gopheracademy.com/advent-2015/vendor-folder/\" rel=\"nofollow\">vendoring</a>. </p>\n"}], "owner": {"reputation": 15, "user_id": 6020311, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WH4v74yxML0/AAAAAAAAAAI/AAAAAAAAIYQ/Vt_obHvmQsQ/photo.jpg?sz=128", "display_name": "Casey A. Childers", "link": "https://stackoverflow.com/users/6020311/casey-a-childers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4148, "favorite_count": 0, "accepted_answer_id": 40189899, "answer_count": 1, "score": 1, "last_activity_date": 1477124455, "creation_date": 1477109911, "last_edit_date": 1477111199, "question_id": 40188257, "link": "https://stackoverflow.com/questions/40188257/deployment-build-using-local-package-fails-with-import-path-does-not-begin-with", "title": "Deployment Build Using Local Package Fails with &quot;import path does not begin with hostname&quot;", "body": "<p>I'm new to Go, and I imagine this is an obvious situation for anyone who's worked with Go deployment in the past. In the most TL;DR sense, I built out a demo project from Scotch.IO for a simple todo list using Go (<a href=\"https://scotch.io/tutorials/create-a-single-page-app-with-go-echo-and-vue\" rel=\"nofollow\">https://scotch.io/tutorials/create-a-single-page-app-with-go-echo-and-vue</a>), and it works flawlessly on my machine, but it breaks in CircleCI when it attempts to import locally defined packages:</p>\n\n<pre><code>  import (\n     \"database/sql\"\n     \"net/http\"\n     \"strconv\"\n\n     \"go-todo/models\" // &lt;- This\n\n     \"github.com/labstack/echo\"\n  )\n</code></pre>\n\n<p>I know there's no real reason to deploy an app like this, but I'd like to understand it better before diving into larger projects where deployment is essential. The logs at the breakpoint read:</p>\n\n<pre><code>package go-todo/handlers: unrecognized import path \"go-todo/handlers\" (import path does not begin with hostname)\npackage go-todo/models: unrecognized import path \"go-todo/models\" (import path does not begin with hostname)\n</code></pre>\n\n<p>And while I grasp that the path is incomplete from a remote environment perspective, I also know that relative paths won't fix it, and I have to assume there's some environmental variable that my ignorance is making me blind to in this context.</p>\n\n<p>It's also worth noting that all of the <code>go get</code> calls for remote packages play nicely as expected.</p>\n\n<p>Any help will be greatly appreciated. Refining my google searches is just bringing back the same stack of seemingly unrelated questions.</p>\n"}, {"tags": ["go", "methods", "interface", "crud"], "comments": [{"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 1, "creation_date": 1477121589, "post_id": 40188111, "comment_id": 67645747, "body": "Your CRUD interface could be better if it is designed similar to <a href=\"https://godoc.org/github.com/sauerbraten/crudapi#Storage\" rel=\"nofollow noreferrer\">this one</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1477138145, "post_id": 40188111, "comment_id": 67650067, "body": "You really should try and come up with a <i>minimal</i> example. And please: get rid of the empty interface. Whatever you try to do, it will be wrong when done with <code>interface {}</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1528, "user_id": 6509830, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-a2iUCqNxm8g/AAAAAAAAAAI/AAAAAAAAADk/L30vHNHz62Q/photo.jpg?sz=128", "display_name": "Sourabh Bhagat", "link": "https://stackoverflow.com/users/6509830/sourabh-bhagat"}, "is_accepted": false, "score": 4, "last_activity_date": 1477146781, "creation_date": 1477146781, "answer_id": 40193340, "question_id": 40188111, "link": "https://stackoverflow.com/questions/40188111/how-to-return-an-interface-from-an-method-which-it-has-implemented/40193340#40193340", "title": "How to return an interface from an method which it has implemented?", "body": "<p>I think you should store the return value to a variable. Also make sure that this return value (result) is slice of interface.\nIf it's not then convert it by </p>\n\n<pre><code>v := reflect.ValueOf(s)\nintf := make([]interface{}, v.Len())\n</code></pre>\n\n<p>In your case your UpdateQuery function might look like</p>\n\n<pre><code>func (post Post) UpdateQuery() (interface{}, bool) {\n\n    result,err := []Struct{}\n\n    return result, err\n}\n</code></pre>\n\n<p>Demo :\n<a href=\"https://play.golang.org/p/HOU56KibUd\" rel=\"nofollow\">https://play.golang.org/p/HOU56KibUd</a></p>\n"}], "owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1664, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500808245, "creation_date": 1477108022, "last_edit_date": 1500808245, "question_id": 40188111, "link": "https://stackoverflow.com/questions/40188111/how-to-return-an-interface-from-an-method-which-it-has-implemented", "title": "How to return an interface from an method which it has implemented?", "body": "<p>Sorry if this question is a bit basic.\nI am trying to use Golang interfaces to make the implementation of CRUD more dynamic.\nI have implemented an interface as follows</p>\n\n<pre><code>type Datastore interface {\n    AllQuery() ([]interface{}, error)\n    ReadQuery() ([]interface{}, error)\n    UpdateQuery() ([]interface{}, error)\n    CreateQuery() ([]interface{}, error)\n    DestroyQuery() ([]interface{}, error)//Im not sure if the return value implementation is correct\n}\n</code></pre>\n\n<p>That can be used with a multitude of models <code>category Category</code>,<code>tag Tag</code>.etc\nIt implements the methods indicative of the structs which represent the models in the app.</p>\n\n<p>Here is the simplified handler/controller\n    func UpdateHandler(c handler.context) error {\n        p := new(models.Post)\n        return Update(p,c)\n    }</p>\n\n<p>This is the function implementing the interface  </p>\n\n<pre><code>  func Update(data Datastore,c handler.context) error{\n        if err := c.Bind(data); err != nil {\n              log.Error(err)\n        }\n        d, err := data.UpdateQuery()\n        //stuff(err checking .etc)\n        return c.JSON(fasthttp.StatusOK, d)///the returned value is used here\n    }\n</code></pre>\n\n<p>This is the method I am using to query the database</p>\n\n<pre><code>func (post Post) UpdateQuery() ([]interface{}, error){\n//run query using the \nreturn //I dont know how to structure the return statement\n}\n</code></pre>\n\n<p>How do I structure the interface above and the methods it implements so that I can return the result of the query back to the implementing function.\nPlease let me know if I need to add anything to the question or improve it I will try to do so promptly.\nThanks!</p>\n"}, {"tags": ["regex", "go", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "is_accepted": false, "score": 0, "last_activity_date": 1478438456, "creation_date": 1478438456, "answer_id": 40449801, "question_id": 40187904, "link": "https://stackoverflow.com/questions/40187904/gorilla-mux-regex-for-number-between-range-and-predefined-options/40449801#40449801", "title": "Gorilla Mux Regex for number between range and predefined options", "body": "<pre><code>func ValidetaChannel() Adapter {\n    return func(h http.Handler) http.Handler {\n        return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n            channel, err := strconv.Atoi(mux.Vars(r)[\"channel\"])\n            if err != nil {\n                http.Error(w, http.StatusText(400), 400)\n                return\n            }\n            if channel &gt;= 1 &amp;&amp; channel &lt;= viper.GetInt(\"channels\") {\n                h.ServeHTTP(w, r)\n                return\n            }\n            http.Error(w, http.StatusText(400), 400)\n\n        })\n    }\n}\n\n\nfunc ValidetaAction() Adapter {\n    return func(h http.Handler) http.Handler {\n        return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n            if mux.Vars(r)[\"action\"] == \"true\" || mux.Vars(r)[\"action\"] == \"false\" {\n                h.ServeHTTP(w, r)\n                return\n            }\n            http.Error(w, http.StatusText(400), 400)\n        })\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478438456, "creation_date": 1477105377, "question_id": 40187904, "link": "https://stackoverflow.com/questions/40187904/gorilla-mux-regex-for-number-between-range-and-predefined-options", "title": "Gorilla Mux Regex for number between range and predefined options", "body": "<p>My route looks like this</p>\n\n<pre><code>max := viper.GetInt(\"channels\")\n\nlights_router.Path(\"/{channel}/{action}\").\n    Methods(\"OPTIONS\",\"GET\").\n    Handler( util.Adapt(SerialHandler(router), util.EnableCORS()))\n</code></pre>\n\n<p>Channels have to be between 1 and max and action has to be either false or true.</p>\n"}, {"tags": ["algorithm", "go", "compiler-construction", "implementation", "abstract-syntax-tree"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1477098690, "post_id": 40187186, "comment_id": 67642210, "body": "Your project looks pretty interesting, around six months I did a little parser for Boolean expressions and the source code of Go helped me a lot with the parser and <a href=\"https://github.com/golang/go/tree/master/src/go/scanner\" rel=\"nofollow noreferrer\">lexer</a> refreshing my knowledge about languages theory. I recommend you take a look to the <a href=\"https://golang.org/pkg/go/\" rel=\"nofollow noreferrer\">go</a> package of Go :) Btw, I&#39;m a big fan of Dijkstra"}, {"owner": {"reputation": 69864, "user_id": 444991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c57f597182ae324d8eb33b935f7d38af?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/444991/matt"}, "edited": false, "score": 0, "creation_date": 1477398578, "post_id": 40187186, "comment_id": 67741807, "body": "I&#39;m voting to close this question as off-topic because it has been cross-posted on a better suited Stack Exchange site. In future, please only post your question on a single Stack Exchange site. For more information, see <a href=\"http://meta.stackexchange.com/q/64068\">here</a>. <a href=\"http://cs.stackexchange.com/questions/64939/shunting-yard-algorithm-extension-and-ast-generation\" title=\"shunting yard algorithm extension and ast generation\">cs.stackexchange.com/questions/64939/&hellip;</a>"}], "owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 1, "closed_date": 1477398578, "answer_count": 0, "score": 2, "last_activity_date": 1477096664, "creation_date": 1477096664, "question_id": 40187186, "link": "https://stackoverflow.com/questions/40187186/shunting-yard-algorithm-extension-and-implementation-issues", "closed_reason": "Not suitable for this site", "title": "Shunting Yard Algorithm extension and implementation issues", "body": "<p>Let me introduce you to my current project (that obviously yields the problem I face  hence I post here).  I am writing a  so-called  \"compiler\" for  a simplistic language.  I have already built a VM to run  the produced bytecode, the associated Lexer   (all this project  is  an optional  assignment).  My  problem lies  in the Expression parsing bit.  I use the Shunting Yard Algorithm by  Dijkstra to convert my postfix expressions into the corresponding AST structure, and I am incapable of adjusting the algorithm correctly to generate the correct AST if -and only if- I try to implement function calls and array subscript.</p>\n\n<p>Here a sample of the algorithm implementation (everything is pretty self-explanatory I believe)</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func (p *parser) shuntingyard(input token.TQueue) *ast.Node {\n    var operands ast.NStack\n    var operators *token.TStack\n\n    operands = make(ast.NStack, 0)\n    operators = token.TokenStack()\n\n    for tok := input.Dequeue(); tok.Sym != \"EOF\"; tok = input.Dequeue() {\n        switch tok.Kind {\n        case \"LParen\":\n            operators.Push(tok)\n        case \"RParen\":\n            for {\n                // pop item (\"(\" or operator) from stack\n                if operators.Empty() {\n                    p.errorf(\"Unmatched parenthesis on line %d, expected '(' to match closing parenthesis in expression\", p.lno)\n                }\n\n                op := operators.Pop()\n                if op.Sym == \"(\" {\n                    break // discard \"(\"\n                }\n\n                if isUnary(op.Sym) {\n                    node := ast.MakeNode(*op)\n                    node.AddChild(operands.Pop())\n                    operands.Push(node)\n                    break\n                }\n\n                RHS := operands.Pop()\n                LHS := operands.Pop()\n                operands.Push(ast.MakeParentNode(*op, RHS, LHS))\n            }\n        default:\n            if o1, isOp := prOps[tok.Sym]; isOp {\n                // token is an operator\n                for !operators.Empty() {\n                    // consider top item on stack\n                    op := operators.PeekTop()\n                    if o2, isOp := prOps[op.Sym]; !isOp || o1.prec &gt; o2.prec || o1.prec == o2.prec &amp;&amp; o1.rAssoc {\n                        break\n                    }\n\n                    // top item is an operator that needs to come off\n                    op = operators.Pop()\n                    if isUnary(op.Sym) {\n                        node := ast.MakeNode(*op)\n                        node.AddChild(operands.Pop())\n                        operands.Push(node)\n                        break\n                    }\n                    RHS := operands.Pop()\n                    LHS := operands.Pop()\n                    operands.Push(ast.MakeParentNode(*op, RHS, LHS))\n                }\n                // push operator (the new one) to stack\n                operators.Push(tok)\n            } else {\n                operands.Push(ast.MakeNode(*tok))\n            }\n        }\n    }\n\n    // drain stack to result\n    for !operators.Empty() {\n        if operators.PeekTop().Sym == \"(\" {\n            p.errorf(\"Unmatched parenthesis on line %d, expected ')' to match previous parenthesis in expression\", p.lno)\n        }\n\n        RHS := operands.Pop()\n        LHS := operands.Pop()\n        operands.Push(ast.MakeParentNode(*operators.Pop(), RHS, LHS))\n    }\n\n    result := operands.Pop()\n    for !operands.Empty() {\n        result.AddSibling(operands.Pop())\n    }\n\n    return result\n}\n</code></pre>\n\n<p>The idea is pretty straightforward when you encounter a binary operator from the operator stack, you pop off of the operand stack two nodes that you set as children of the operator encountered (or one if the operator is unary). And you push the resulting node on the operands stack.</p>\n\n<p>For instance, this input:</p>\n\n<pre><code>c = 0;\na = 1 &lt;&lt; 3 + 2;\n</code></pre>\n\n<p>results in the (valid) AST:</p>\n\n<pre><code>\u2523\u2501 Assign           =\n\u2503   \u2523\u2501 Identifier       'a'\n\u2503   \u2517\u2501 Lshift           &lt;&lt;\n\u2503       \u2523\u2501 Number           1\n\u2503       \u2517\u2501 Plus             +\n\u2503           \u2523\u2501 Number           3\n\u2503           \u2517\u2501 Number           2\n\u2517\u2501 Assign           =\n    \u2523\u2501 Identifier       'c'\n    \u2517\u2501 Number           0\n</code></pre>\n\n<p>However, the output is being wrong whenever I try to nest function calls:</p>\n\n<pre><code> foo(bar(0))\n</code></pre>\n\n<p>the result is (obviously) not correct:</p>\n\n<pre><code>\u2523\u2501 Number           0\n\u2523\u2501 Function         bar\n\u2517\u2501 Function         foo\n</code></pre>\n\n<p>when I should have had:</p>\n\n<pre><code>\u2517\u2501 Function         foo\n    \u2517\u2501 Function         bar\n        \u2517\u2501 Number        0\n</code></pre>\n\n<p>My first question is: <strong>What modification do I have to bring to my implementation to support AST generation for function calls ?</strong> Since all I have found on the Internet regarding the SY Algorithm is always generating an RPN string ...</p>\n\n<p>Another thing is that an input such as:</p>\n\n<pre><code>-i++;\n</code></pre>\n\n<p>generates the valid output:</p>\n\n<pre><code>\u2517\u2501 UnaryMinus       -u\n    \u2517\u2501 PlusPlus         ++\n        \u2517\u2501 Identifier       'i'\n</code></pre>\n\n<p>but <code>(-i++);</code> reports and unbalanced parenthesised expression ?</p>\n\n<p>The <code>map</code> used to work with operators is:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var prOps = map[string]struct {\n    prec   int\n    rAssoc bool\n}{\n    \"++\" : {50, false}, \"--\" : {50, false},\n\n    \".\"  : {40, false}, \"[\"  : {40, false},\n\n    \"!\"  : {30, true}, \"~\"   : {30, true},\n    \"-u\" : {29, true}, \"--u\" : {29, true}, \"++u\": {29, true},\n    \"**\" : {28, true},\n\n    \"*\"  : {27, false}, \"/\"  : {27, false}, \"%\" : {27, false},\n    \"+\"  : {26, false}, \"-\"  : {26, false},\n    \"&gt;&gt;\" : {25, false}, \"&lt;&lt;\" : {25, false},\n    \"&gt;\"  : {24, false}, \"&gt;=\" : {24, false}, \"&lt;\" : {24, false}, \"&lt;=\" : {24, false},\n    \"==\" : {23, false}, \"!=\" : {23, false},\n    \"&amp;\"  : {22, false},\n    \"^\"  : {21, false},\n    \"|\"  : {20, false},\n    \"&amp;&amp;\" : {19, false},\n    \"||\" : {18, false},\n\n    \"=\"  : {10, true}, \"+=\"  : {10, true}, \"-=\" : {10, true}, \"*=\"  : {10, true},\n    \"/=\" : {10, true}, \"**=\" : {10, true}, \"^=\" : {10, true}, \"~=\"  : {10, true},\n    \"|=\" : {10, true}, \"&amp;=\"  : {10, true}, \"%=\" : {10, true}, \"&lt;&lt;=\" : {10, true},\n    \"&gt;&gt;=\": {10, true},\n    \",\"  : {9, false},\n}\n</code></pre>\n\n<p>Where <code>-u</code>, <code>++u</code>, <code>--u</code> are the instances of the meant operator, but unarily.</p>\n\n<p>On the other note, is the Shunting Yard Algorithm what I <strong>truly</strong> need ? I mean, if parsing an object-oriented expression with this algorithm <a href=\"https://github.com/eriksank/dijkstra-shunting-yard\" rel=\"nofollow\">is feasable</a>, is that my best choice ?</p>\n\n<p>I also read (a lot) on parsers in a larger sense. I believe, from what I read, that writing a Recursive Descent parser is my best chance to achieve my goal within reasonable amount of time. I read some source codes, but parsers tend not to be reader-friendly. <strong>What is a guideline I should keep for this project regarding the parser and AST generation ?</strong></p>\n\n<p>Please tell me if I did anything wrong with this thread :) And do ask if I missed to link/give any ressources needed !</p>\n\n<p>In the hope of having some helpful answers.</p>\n"}, {"tags": ["excel", "go", "reader"], "answers": [{"comments": [{"owner": {"reputation": 711, "user_id": 3125693, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3872b84555f5d5abe102f041780200f?s=128&d=identicon&r=PG&f=1", "display_name": "user3125693", "link": "https://stackoverflow.com/users/3125693/user3125693"}, "edited": false, "score": 0, "creation_date": 1477354025, "post_id": 40187986, "comment_id": 67721855, "body": "How do I know that File is of io.ReaderAt interface? ReaderAt interface requires implementation of &quot;ReadAt()&quot; function <a href=\"https://godoc.org/io#ReaderAt\" rel=\"nofollow noreferrer\">godoc.org/io#ReaderAt</a> . However... File (returned from req.FormFIle) does not seem to implement any functions: <a href=\"https://golang.org/pkg/mime/multipart/#File\" rel=\"nofollow noreferrer\">golang.org/pkg/mime/multipart/#File</a>"}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "reply_to_user": {"reputation": 711, "user_id": 3125693, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3872b84555f5d5abe102f041780200f?s=128&d=identicon&r=PG&f=1", "display_name": "user3125693", "link": "https://stackoverflow.com/users/3125693/user3125693"}, "edited": false, "score": 0, "creation_date": 1477374456, "post_id": 40187986, "comment_id": 67726979, "body": "<code>multipart.File</code> is an interface that embeds other interfaces, one of which is <code>io.ReaderAt</code>. You can see that in the <a href=\"https://golang.org/pkg/mime/multipart/#File\" rel=\"nofollow noreferrer\">link</a> you posted."}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "reply_to_user": {"reputation": 711, "user_id": 3125693, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3872b84555f5d5abe102f041780200f?s=128&d=identicon&r=PG&f=1", "display_name": "user3125693", "link": "https://stackoverflow.com/users/3125693/user3125693"}, "edited": false, "score": 0, "creation_date": 1477509682, "post_id": 40187986, "comment_id": 67801025, "body": "@user3125693 Is there anything else to clear up in the answer ?"}, {"owner": {"reputation": 711, "user_id": 3125693, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3872b84555f5d5abe102f041780200f?s=128&d=identicon&r=PG&f=1", "display_name": "user3125693", "link": "https://stackoverflow.com/users/3125693/user3125693"}, "edited": false, "score": 1, "creation_date": 1477526136, "post_id": 40187986, "comment_id": 67807476, "body": "Nope you answered it perfectly. I didn&#39;t actually know you could embed an interface into another interface. Thank you!"}], "tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": true, "score": 4, "last_activity_date": 1525978726, "last_edit_date": 1525978726, "creation_date": 1477106564, "answer_id": 40187986, "question_id": 40187001, "link": "https://stackoverflow.com/questions/40187001/golang-excel-file-reading/40187986#40187986", "title": "Golang excel file reading", "body": "<p><code>func OpenReaderAt(r io.ReaderAt, size int64) (*File, error)</code></p>\n\n<p><code>xlsx.OpenReaderAt</code> takes in an <code>io.ReaderAt</code> interface and <code>multipart.File</code> also implements <code>io.ReaderAt</code>.</p>\n\n<p>So you can directly pass it to <code>xlsx.OpenReaderAt</code></p>\n\n<pre><code>var (\nfile multipart.File\nsize int64\nerr error\n)\n\nfile, _,err = req.FormFile(\"key\")\n// size = // Calculate size\nxlsx.OpenReaderAt(file,size)\n</code></pre>\n"}], "owner": {"reputation": 711, "user_id": 3125693, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3872b84555f5d5abe102f041780200f?s=128&d=identicon&r=PG&f=1", "display_name": "user3125693", "link": "https://stackoverflow.com/users/3125693/user3125693"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4882, "favorite_count": 1, "accepted_answer_id": 40187986, "answer_count": 1, "score": 1, "last_activity_date": 1525978726, "creation_date": 1477094948, "last_edit_date": 1477137462, "question_id": 40187001, "link": "https://stackoverflow.com/questions/40187001/golang-excel-file-reading", "title": "Golang excel file reading", "body": "<p>I'm using tealeg xlsx library to read an excel file <a href=\"https://github.com/tealeg/xlsx\" rel=\"nofollow\">https://github.com/tealeg/xlsx</a> . They have documentation here <a href=\"https://godoc.org/github.com/tealeg/\" rel=\"nofollow\">https://godoc.org/github.com/tealeg/</a> . It works perfectly fine if I call the <code>OpenFile()</code> by local directory, but I wanted to use an <code>http.Request.FormFile()</code> return object which is of type <code>multipart.Form</code>.  How do I use this file to be read by the tealeg package?</p>\n\n<p>Tealeg's <code>OpenReaderAt()</code> looks like something I should use, but the multipart. Form object returned from <code>http.Request.FormFile()</code> returns a file interface but I'm not sure how to access the readerAt object? <a href=\"https://golang.org/pkg/mime/multipart/#File\" rel=\"nofollow\">https://golang.org/pkg/mime/multipart/#File</a></p>\n"}, {"tags": ["go", "reflection", "struct", "interface"], "answers": [{"comments": [{"owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 0, "creation_date": 1477093793, "post_id": 40186843, "comment_id": 67641340, "body": "Hey Thanks for answering! After setting the field values  would I then need to return <code>reflect.Value</code>? How would I re-insert this into the struct specified i.e. <code>Post</code> in this case for further use?"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1477094274, "last_edit_date": 1477094274, "creation_date": 1477093382, "answer_id": 40186843, "question_id": 40186815, "link": "https://stackoverflow.com/questions/40186815/golang-loop-through-fields-of-a-struct-modify-them-and-and-return-the-struct/40186843#40186843", "title": "Golang: loop through fields of a struct modify them and and return the struct?", "body": "<p>The variable <code>field</code> has type <code>reflect.Value</code>. Call the <a href=\"https://godoc.org/reflect#Value.Set\" rel=\"nofollow\">Set*</a> methods on <code>field</code> to set the fields in the struct. For example:</p>\n\n<pre><code> field.SetString(\"hello\")\n</code></pre>\n\n<p>sets the the struct field to \"hello\".</p>\n\n<p>You must pass a pointer to the struct if you want to retain the values:</p>\n\n<pre><code>function foo(){ \n    p:=Post{fieldName:\"bar\"} \n    check(&amp;p)\n}\n\nfunc check(d Datastore){\n   value := reflect.ValueOf(d)\n   if value.Kind() != reflect.Ptr {\n      // error\n   }\n   CheckSwitch(value.Elem())\n   ...\n}\n</code></pre>\n\n<p>Also, the field names must be <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow\">exported</a>.</p>\n\n<p><a href=\"https://play.golang.org/p/0Uqf8Qi0lC\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3765, "favorite_count": 1, "accepted_answer_id": 40186843, "answer_count": 1, "score": 3, "last_activity_date": 1477094274, "creation_date": 1477093105, "question_id": 40186815, "link": "https://stackoverflow.com/questions/40186815/golang-loop-through-fields-of-a-struct-modify-them-and-and-return-the-struct", "title": "Golang: loop through fields of a struct modify them and and return the struct?", "body": "<p>I am trying to loop through the individual fields of a struct applying a function to each field and then return the original struct as a whole with the modified field values.\nObviously, this would not present a challenge if it were for one struct but I need the function to be dynamic.\nFor this instance, I am referencing the Post and Category struct as shown below</p>\n\n<pre><code>type Post struct{\n    fieldName           data     `check:\"value1\"\n    ...\n}\n\ntype Post struct{\n    fieldName           data     `check:\"value2\"\n    ...\n}\n</code></pre>\n\n<p>I then have a switch function that loops through the respective fields of the structs and depending on what value the <code>check</code> has, applies a function to that field's <code>data</code> as follows</p>\n\n<pre><code>type Datastore interface {\n     ...\n}\n\n func CheckSwitch(value reflect.Value){\n    //this loops through the fields\n    for i := 0; i &lt; value.NumField(); i++ { // iterates through every struct type field\n        tag := value.Type().Field(i).Tag // returns the tag string\n        field := value.Field(i) // returns the content of the struct type field\n\n        switch tag.Get(\"check\"){\n            case \"value1\":\n                  fmt.Println(field.String())//or some other function\n            case \"value2\":\n                  fmt.Println(field.String())//or some other function\n            ....\n\n        }\n        ///how could I modify the struct data during the switch seen above and then return the struct with the updated values?\n\n\n}\n}\n\n//the check function is used i.e \nfunction foo(){ \np:=Post{fieldName:\"bar\"} \ncheck(p)\n}\n\nfunc check(d Datastore){\n     value := reflect.ValueOf(d) ///this gets the fields contained inside the struct\n     CheckSwitch(value)\n\n     ...\n}   \n</code></pre>\n\n<p>How do I, in essence, re-insert the modified values after the switch statement in <code>CheckSwitch</code> back into the struct specified by the interface in the above example.\nPlease let me know if you need anything else.\nThanks</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1172, "user_id": 4621508, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7edbd50ad77354c926f108838b77b938?s=128&d=identicon&r=PG&f=1", "display_name": "rumdrums", "link": "https://stackoverflow.com/users/4621508/rumdrums"}, "edited": false, "score": 0, "creation_date": 1477162619, "post_id": 40186852, "comment_id": 67657548, "body": "This approach still requires more repetition than I was hoping for in each function that calls doPaged, in order to strip out the paging info from the responses, but the approach you outline is probably as good as I&#39;ll get -- thanks!"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 1, "last_activity_date": 1477094679, "last_edit_date": 1477094679, "creation_date": 1477093485, "answer_id": 40186852, "question_id": 40186434, "link": "https://stackoverflow.com/questions/40186434/golang-avoiding-duplicate-code-with-unknown-type/40186852#40186852", "title": "Golang -- Avoiding duplicate code with unknown type", "body": "<p>One thing you could do is have an interface for anything that is pagable. Perhaps called <code>Pagable</code>:</p>\n\n<pre><code>type Pagable interface { Paging() PagingData }\n</code></pre>\n\n<p>and a single type that implements it:</p>\n\n<pre><code>type Pager struct { \n  Paging PagingData `json:\"paging\"`\n}\nfunc(p Pager) Paging() PagingData {\n   return p.Paging\n}\n</code></pre>\n\n<p>Then your other types can \"embed\" a <code>Pager</code> to automatically implement <code>Pagable</code> and include those fields:</p>\n\n<pre><code>type PagedLenderResponse struct {\n    Paging\n    Items  []Lender   `json: \"lenders\"`\n}\n</code></pre>\n\n<p>If <code>doPaged</code> then accepts a <code>Pagable</code> instead of <code>interface{}</code> for <code>v</code>, you can call <code>Paging()</code> on it, and get the page stuff, and then the json package can write the rest of it out to the response for you. No <code>interface{}</code> and no reflect needed.</p>\n"}], "owner": {"reputation": 1172, "user_id": 4621508, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7edbd50ad77354c926f108838b77b938?s=128&d=identicon&r=PG&f=1", "display_name": "rumdrums", "link": "https://stackoverflow.com/users/4621508/rumdrums"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 40186852, "answer_count": 1, "score": 1, "last_activity_date": 1477094679, "creation_date": 1477089914, "question_id": 40186434, "link": "https://stackoverflow.com/questions/40186434/golang-avoiding-duplicate-code-with-unknown-type", "title": "Golang -- Avoiding duplicate code with unknown type", "body": "<p>Still a bit of a go newb. As a simple project, I'm trying to write an API wrapper for <a href=\"https://build.kiva.org/api\" rel=\"nofollow\">Kiva's API</a>. I'm trying to avoid writing duplicate code for handling paged responses from the API, but, given Go's lack of generic types, I haven't found a way to do it and am not sure if it's possible.</p>\n\n<p>I've tried using type switches and the reflect package to avoid doing the exact same thing in multiple functions but haven't had any luck. This is the current iteration of my (totally non-functional) code:</p>\n\n<pre><code>type PagingData struct {\n    Total    int `json: \"total\"`\n    Page     int `json: \"page\"`\n    PageSize int `json: \"page_size\"`\n    Pages    int `json: \"pages\"`\n}\n\ntype PagedLoanResponse struct {\n    Paging PagingData `json: \"paging\"`\n    Items  []Loan     `json: \"loans\"`\n}\n\ntype PagedLenderResponse struct {\n    Paging PagingData `json: \"paging\"`\n    Items  []Lender   `json: \"lenders\"`\n}\n\n\nfunc (c *Client) doPaged(method string, urlpath string, query url.Values, body io.Reader, v interface{}, numPages int) ([]interface{}, error) {\n\n    if numPages &lt; 0 {\n        return nil, fmt.Errorf(\"less than zero is unacceptable\")\n    }\n\n    pr := reflect.New(reflect.TypeOf(v))\n    if query == nil {\n        query = url.Values{}\n    }\n\n    // get the first page\n    err := c.do(method, urlpath, query, body, &amp;pr)\n    if err != nil {\n        return nil, err\n    }\n\n    if pr.Paging.Pages == 1 {\n        return pr.Items, nil\n    }\n\n    if numPages == 0 {\n        numPages = pr.Paging.Pages\n    }\n\n    items := make(reflect.New(reflect.TypeOf(pr.Items)), 0, pr.Paging.Total)\n    items = append(items, pr.Items...)\n\n    for i := 2; i &lt;= numPages; i++ {\n        query.Set(\"page\", strconv.Itoa(i))\n        err := c.do(\"GET\", urlpath, query, nil, &amp;pr)\n        if err != nil {\n            return nil\n        }\n        items = append(items, pr.Items...)\n    }\n\n    return items, nil\n}\n\n\nfunc (c *Client) GetNewestLoans(numPages int) ([]Loan, error) {\n    baseURL := \"/v1/loans/newest\"\n    var p PagedLoanResponse\n    loans, nil := c.doPaged(\"GET\", baseURL, nil, nil, p, numPages)\n}\n</code></pre>\n"}, {"tags": ["arrays", "sorting", "go"], "answers": [{"tags": [], "owner": {"reputation": 29582, "user_id": 1427098, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Bvdm0.jpg?s=128&g=1", "display_name": "Darshan Rivka Whittle", "link": "https://stackoverflow.com/users/1427098/darshan-rivka-whittle"}, "is_accepted": true, "score": 5, "last_activity_date": 1477074629, "creation_date": 1477074629, "answer_id": 40183289, "question_id": 40183194, "link": "https://stackoverflow.com/questions/40183194/go-loops-over-sorted-array-sort-sort-used-as-value/40183289#40183289", "title": "Go: Loops over sorted array, sort.Sort used as value", "body": "<p><code>sort.Sort</code> sorts in place; it doesn't return a value.</p>\n\n<pre><code>fmt.Println(people)\nsort.Sort(ByAge(people))  // After this, people is already sorted\nfmt.Println(people)\n\nfor _, p := range people { // Just range over people if you want\n    fmt.Println(p.String())\n}\n</code></pre>\n"}], "owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1228, "favorite_count": 0, "accepted_answer_id": 40183289, "answer_count": 1, "score": 1, "last_activity_date": 1477074629, "creation_date": 1477074274, "question_id": 40183194, "link": "https://stackoverflow.com/questions/40183194/go-loops-over-sorted-array-sort-sort-used-as-value", "title": "Go: Loops over sorted array, sort.Sort used as value", "body": "<p>How to loop over sorted array?</p>\n\n<p>I got \"sort.Sort used as value\" error:\n<a href=\"https://play.golang.org/p/HP30OyJVrz\" rel=\"nofollow\">https://play.golang.org/p/HP30OyJVrz</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n)\n\ntype Person struct {\n    Name string\n    Age  int\n}\n\nfunc (p Person) String() string {\n    return fmt.Sprintf(\"%s: %d\", p.Name, p.Age)\n}\n\n// ByAge implements sort.Interface for []Person based on\n// the Age field.\ntype ByAge []Person\n\nfunc (a ByAge) Len() int           { return len(a) }\nfunc (a ByAge) Swap(i, j int)      { a[i], a[j] = a[j], a[i] }\nfunc (a ByAge) Less(i, j int) bool { return a[i].Age &lt; a[j].Age }\n\nfunc main() {\n    people := []Person{\n        {\"Bob\", 31},\n        {\"John\", 42},\n        {\"Michael\", 17},\n        {\"Jenny\", 26},\n    }\n\n    fmt.Println(people)\n    sort.Sort(ByAge(people))\n    fmt.Println(people)\n\n    for _, p := range sort.Sort(ByAge(people)) {\n        fmt.Println(p.String())\n    }\n\n}\n</code></pre>\n"}, {"tags": ["go", "binary"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1477071719, "creation_date": 1477071719, "answer_id": 40182548, "question_id": 40182501, "link": "https://stackoverflow.com/questions/40182501/switch-endianness-when-reading-binary-file/40182548#40182548", "title": "switch endianness when reading binary file", "body": "<p><code>binary.BigEndian</code> and <code>binary.LittleEndian</code> are are both implementations of <a href=\"https://golang.org/pkg/encoding/binary/#ByteOrder\" rel=\"nofollow\"><code>binary.ByteOrder</code></a>. Declare <code>e</code> as type <code>binary.ByteOrder</code>, and you can switch back and forth between the two implementations. </p>\n\n<p><a href=\"https://play.golang.org/p/GzL_2q5wvn\" rel=\"nofollow\">https://play.golang.org/p/GzL_2q5wvn</a></p>\n\n<pre><code>var b byte = 0xe2\nvar e binary.ByteOrder\nswitch b {\ncase 0xe2:\n    e = binary.BigEndian\ndefault:\n    e = binary.LittleEndian\n}\nfmt.Println(reflect.TypeOf(e))\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 2089085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d502a84950aab65b9246e6b24b6adcbc?s=128&d=identicon&r=PG", "display_name": "hankivstmb", "link": "https://stackoverflow.com/users/2089085/hankivstmb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 40182548, "answer_count": 1, "score": 1, "last_activity_date": 1477071719, "creation_date": 1477071548, "question_id": 40182501, "link": "https://stackoverflow.com/questions/40182501/switch-endianness-when-reading-binary-file", "title": "switch endianness when reading binary file", "body": "<p>Trying to parse a file with binary records. The first byte of each record tells you the endianness of each record. Theoretically the endianness can change between records. How can I switch from binary.BigEndian to binary.LittleEndian. I'm a total Golang newbie...</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    //\"time\"\n    \"reflect\"\n    \"encoding/binary\"\n)\n\nfunc main() {\n    var b byte = 0xe2\n    e := binary.BigEndian\n    switch b {\n    case 0xe2:\n        e = binary.BigEndian\n    default:\n        e = binary.LittleEndian\n    }\n    fmt.Println(reflect.TypeOf(e))\n}\n</code></pre>\n\n<p><code>tmp/sandbox356311773/main.go:17: cannot use binary.LittleEndian (type binary.littleEndian) as type binary.bigEndian in assignment</code></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1477073618, "post_id": 40182352, "comment_id": 67633459, "body": "@cliquot-the-dog, JFTR keep in mind that <code>encoding&#47;binary</code> is able to marshal and unmarshal binary data from values/into variables of custom <code>struct</code> types (by <code>reflect</code>ing over their structure), so one often can &quot;unpack&quot; complex binary strings right into custom <code>struct</code>ures and back."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "edited": false, "score": 0, "creation_date": 1490111265, "post_id": 40182352, "comment_id": 72961167, "body": "@xaav: I&#39;m not sure what you mean, this example itself decodes a non-zero argument."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 6, "last_activity_date": 1477070908, "creation_date": 1477070908, "answer_id": 40182352, "question_id": 40182289, "link": "https://stackoverflow.com/questions/40182289/golang-equivalent-of-pythons-struct-pack-struct-unpack/40182352#40182352", "title": "Golang equivalent of Python&#39;s struct.pack / struct.unpack", "body": "<p>Yes, \"encoding/binary\" is what you want, you just don't want the variable length format.</p>\n\n<p><a href=\"https://play.golang.org/p/e81LuPO_JR\" rel=\"noreferrer\">https://play.golang.org/p/e81LuPO_JR</a></p>\n\n<pre><code>bs := make([]byte, 8)\nbinary.LittleEndian.PutUint64(bs, uint64(64))\nfmt.Printf(\"%#v\\n\", bs)\n\ni := binary.LittleEndian.Uint64(bs)\nfmt.Println(i)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1201, "user_id": 651028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d5887835c21dace586b98180544c74e?s=128&d=identicon&r=PG", "display_name": "Sergei G", "link": "https://stackoverflow.com/users/651028/sergei-g"}, "is_accepted": false, "score": 3, "last_activity_date": 1495818810, "last_edit_date": 1495818810, "creation_date": 1495818485, "answer_id": 44206858, "question_id": 40182289, "link": "https://stackoverflow.com/questions/40182289/golang-equivalent-of-pythons-struct-pack-struct-unpack/44206858#44206858", "title": "Golang equivalent of Python&#39;s struct.pack / struct.unpack", "body": "<p>There are a couple interesting solutions.  </p>\n\n<p>1st is gist that's simple to follow and its limitations are clear:</p>\n\n<p><a href=\"https://gist.github.com/cloveryume/9a59e8d77f5836f11720#file-golang_struct_packed-go\" rel=\"nofollow noreferrer\">https://gist.github.com/cloveryume/9a59e8d77f5836f11720#file-golang_struct_packed-go</a></p>\n\n<p>2nd is a package that tries to the job of packing:</p>\n\n<p><a href=\"https://github.com/lunixbochs/struc\" rel=\"nofollow noreferrer\">https://github.com/lunixbochs/struc</a></p>\n"}], "owner": {"reputation": 468, "user_id": 3236133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40ae0b1f5c86380a2f89355a011b0dbd?s=128&d=identicon&r=PG&f=1", "display_name": "Clicquot the Dog", "link": "https://stackoverflow.com/users/3236133/clicquot-the-dog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7471, "favorite_count": 3, "accepted_answer_id": 40182352, "answer_count": 2, "score": 6, "last_activity_date": 1495818810, "creation_date": 1477070593, "question_id": 40182289, "link": "https://stackoverflow.com/questions/40182289/golang-equivalent-of-pythons-struct-pack-struct-unpack", "title": "Golang equivalent of Python&#39;s struct.pack / struct.unpack", "body": "<p>In Python, using the <code>struct</code> module, I can do something like this to get a packed representation of a value as a string:</p>\n\n<pre><code>import struct\nprint struct.pack('L', 64)\n\"@\\x00\\x00\\x00\\x00\\x00\\x00\\x00\"\nstruct.unpack('L', '@\\x00\\x00\\x00\\x00\\x00\\x00\\x00')\n(64,)\n</code></pre>\n\n<p>I'd like to do something similar in Go, except I'm a little unclear on how to do so. I know I can do something like this:</p>\n\n<pre><code>import (\n    \"encoding/binary\"\n    \"fmt\"\n)\n\nbs := make([]byte, 8)\nbinary.PutUvarint(bs, uint64(64))\nfmt.Printf(\"%s\", bs)\n\"@\"\n</code></pre>\n\n<p>But that's very different and probably not what I want.</p>\n"}, {"tags": ["email", "go", "gmail", "google-groups"], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 2585073, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3478605d2726eddbe05a158ebf4b41fc?s=128&d=identicon&r=PG", "display_name": "mudejar", "link": "https://stackoverflow.com/users/2585073/mudejar"}, "edited": false, "score": 0, "creation_date": 1477071457, "post_id": 40182350, "comment_id": 67632319, "body": "Thank you for the interesting link (I was following another one that is slightly different). Do you know if it&#39;s possible to send unique emails to individual members of a group, but from the group itself using Go? What I mean is say that one email has content specifically directed for one user in the golang-nuts group, and another emails has slightly different content. Could I send an email where the &quot;sender&quot; header is golang-nuts@googlegroups.com instead of my email?"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 2, "last_activity_date": 1477070898, "creation_date": 1477070898, "answer_id": 40182350, "question_id": 40181931, "link": "https://stackoverflow.com/questions/40181931/can-i-post-a-new-topic-on-a-google-group-using-go/40182350#40182350", "title": "Can I post a new topic on a google group using Go?", "body": "<p>Each google group should have an email address associated with it. <a href=\"https://groups.google.com/forum/#!forum/golang-nuts\" rel=\"nofollow\">golang-nuts</a> is <code>golang-nuts@googlegroups.com</code> for example. Any mail sent to that should be posted to the group, assuming it is from a member of the group. </p>\n\n<p>In order to send from your own gmail account, you can use gmail's outgoing smtp feature with the net/smtp package. Configuration is explained better <a href=\"https://www.digitalocean.com/community/tutorials/how-to-use-google-s-smtp-server\" rel=\"nofollow\">on this digital ocean post</a></p>\n"}], "owner": {"reputation": 167, "user_id": 2585073, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3478605d2726eddbe05a158ebf4b41fc?s=128&d=identicon&r=PG", "display_name": "mudejar", "link": "https://stackoverflow.com/users/2585073/mudejar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1477070898, "creation_date": 1477069107, "question_id": 40181931, "link": "https://stackoverflow.com/questions/40181931/can-i-post-a-new-topic-on-a-google-group-using-go", "title": "Can I post a new topic on a google group using Go?", "body": "<p>I'm writing a program that should send emails to multiple users with content extracted from an excel spreadsheet. I know how to do this using the net/smtp package in Go, but I would like to know if it's possible to send an email with the sender being a google group (i.e googlegroup@gmail.com) instead of my email without resorting to using the gmail API? Currently I have a working program that can log in through an email and password, which is then used for auth credentials, but seeing as that google groups don't have the same kind of interface I'm not quite sure how to change it so emails are sent from a group instead of an individual user.</p>\n"}, {"tags": ["go", "response", "channel"], "answers": [{"tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 1, "last_activity_date": 1477068389, "creation_date": 1477068389, "answer_id": 40181745, "question_id": 40181510, "link": "https://stackoverflow.com/questions/40181510/getting-response-from-function-without-return-golang/40181745#40181745", "title": "Getting response from function without return - Golang", "body": "<p>The channel is a good option. To read all messages, just read from channel in a loop until it closes:</p>\n\n<pre><code>func check(s string, ch chan&lt;- string) {\n    for i := 0; i &lt; 5; i++ { \n        //this could go forever, or until some condition is met\n        ch &lt;- fmt.Sprintf(\"I did something %s %d\", s, i)\n        time.Sleep(time.Millisecond)\n    }\n    close(ch)\n}\n\nfunc main() {\n    ch := make(chan string)\n    go check(\"FOO\", ch)\n    for msg := range ch { //will break when ch closes\n        fmt.Println(msg)\n    }\n    fmt.Println(\"DONE!\")\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/6-V0pbPMUi\" rel=\"nofollow\">playground</a></p>\n\n<p>Another option is passing a callback into the function:</p>\n\n<pre><code>func check(s string, cb func(string)) {\n    for i := 0; i &lt; 5; i++ { \n        //this could go forever, or until some condition is met\n        cb(fmt.Sprintf(\"I did something %s %d\", s, i))\n        time.Sleep(time.Millisecond)\n    }\n}\n\nfunc main() {\n    msgs := []string{}\n    check(\"FOO\", func(s string) { msgs = append(msgs, s) })\n    fmt.Println(msgs)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Wvx8P8K2rH\" rel=\"nofollow\">playground</a></p>\n"}], "owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 545, "favorite_count": 0, "accepted_answer_id": 40181745, "answer_count": 1, "score": 0, "last_activity_date": 1477068389, "creation_date": 1477067469, "question_id": 40181510, "link": "https://stackoverflow.com/questions/40181510/getting-response-from-function-without-return-golang", "title": "Getting response from function without return - Golang", "body": "<p>I have a service function in Golang where running an endless for loop. I wanted to get data from this function without return. What is the best solution, a channel, or io.Writer? The function and where I call it in a different package, because the funcion in <code>package something</code> while where I call it is the main. There is an example with channels: </p>\n\n<pre><code>func Check(dst string, w chan string) bool {    \n  for {\n    w &lt;- data\n  }\n  return false\n}\n</code></pre>\n\n<p>On the otherside where I call this function:</p>\n\n<pre><code>var wg sync.WaitGroup\nfunc main() {\n    messages := make(chan string, 10)\n\n    wg.Add(3)\n    go checking(\"10.1.1.1\", messages)\n    msg := &lt;-messages\n    fmt.Println(msg)\n    wg.Wait()\n}\n\nfunc checking(ip string, msg chan string) {\n    defer wg.Done()\n    w := worker.ContainerAliveIndicator{}\n    w.Check(ip, msg)\n}\n</code></pre>\n\n<p>In this case I only get the first message what the function take to the channel. </p>\n"}, {"tags": ["go", "google-account"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1477069306, "post_id": 40179105, "comment_id": 67631236, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/q/13317987/121660\">stackoverflow.com/q/13317987/121660</a>"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1477069445, "post_id": 40179105, "comment_id": 67631307, "body": "That answer suggests making a simple web server to perform the <a href=\"https://developers.google.com/+/web/api/rest/oauth\" rel=\"nofollow noreferrer\">oauth flow</a> until you get a refresh token. You can then give the refresh token to your command line app to exchange for a valid access token. Kind of a run around, but there it is."}, {"owner": {"reputation": 495, "user_id": 5934834, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/263e6d6ad912197d1f650c8fead44bba?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/5934834/gonzalez"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1477070560, "post_id": 40179105, "comment_id": 67631845, "body": "@captncraig sorry but I don&#39;t think you&#39;re right here. Yes, the question is similar, but I don&#39;t find any answer other than running a webserver and ask the user to enter their password all the time."}], "answers": [{"tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 0, "last_activity_date": 1477071753, "last_edit_date": 1477071753, "creation_date": 1477071326, "answer_id": 40182449, "question_id": 40179105, "link": "https://stackoverflow.com/questions/40179105/login-with-google-account-programmatically/40182449#40182449", "title": "Login with Google+ account programmatically", "body": "<p>The standard way to authenticate a user with google is through a three-legged <a href=\"https://developers.google.com/+/web/api/rest/oauth\" rel=\"nofollow\">oauth</a> authentication flow (in a browser). You can do this in go using the <a href=\"https://godoc.org/golang.org/x/oauth2\" rel=\"nofollow\">oauth2</a> or with a more comprehensive package like <a href=\"https://github.com/markbates/goth\" rel=\"nofollow\">goth</a></p>\n\n<p>The general flow is:</p>\n\n<ol>\n<li>redirect user to a landing page on google's site where they are prompted to grant you access.</li>\n<li>google will make a callback to your site with a special code.</li>\n<li>you make another request to exchange that code for an access token and a refresh token.</li>\n<li>Use access token to use google apis, and use refresh token to get a new access token anytime it expires.</li>\n</ol>\n\n<p>It is more detailed than this, and there is a lot to get right to keep it secure, but that is the general idea. </p>\n\n<p>Now, like you've said, your app is a command line thing, so it is hard to do that flow. Unfortunately, you may need to do that once, just to get a refresh token. Once you have that, you could give it to your application: <code>myapp -google-token=FOOBAR123</code>, and your app can exchange the referesh token for a valid access token. </p>\n\n<p>Maybe this will help: <a href=\"https://github.com/burnash/gspread/wiki/How-to-get-OAuth-access-token-in-console%3F\" rel=\"nofollow\">https://github.com/burnash/gspread/wiki/How-to-get-OAuth-access-token-in-console%3F</a></p>\n"}], "owner": {"reputation": 495, "user_id": 5934834, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/263e6d6ad912197d1f650c8fead44bba?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/5934834/gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 493, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477071753, "creation_date": 1477059701, "question_id": 40179105, "link": "https://stackoverflow.com/questions/40179105/login-with-google-account-programmatically", "title": "Login with Google+ account programmatically", "body": "<p>there is a service where one can authorize using their Google account.\nI need to automate the workflow with that service, so my software has to log-in with a given Google account.\nBut as I've never done that before I don't know where to start. Most related answers suggest to display the authorization page to the user letting them to enter their login/password of their Google account, but that's not the case since my software must be fully automated, plus it is being ran in terminal mode so no browser neither any human to enter anything should be involved.</p>\n\n<p>I wonder if such automation could be possible and where should I start.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 6743038, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8b1f7c217b2b5516a0c139448c1711bc?s=128&d=identicon&r=PG&f=1", "display_name": "user6743038", "link": "https://stackoverflow.com/users/6743038/user6743038"}, "edited": false, "score": 0, "creation_date": 1477059551, "post_id": 40178776, "comment_id": 67625190, "body": "Thanks! Regarding the &quot;correctness&quot; I don&#39;t have stale opinion yet. Probably you are right."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1477061565, "post_id": 40178776, "comment_id": 67626738, "body": "While this answer addresses the question as stated, I&#39;m with @mellow-marmot on this matter: such things should be kept configurable -- that is, pulled at startup from some configuration file and/or the environment etc."}], "tags": [], "owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "is_accepted": true, "score": 5, "last_activity_date": 1477059228, "last_edit_date": 1477059228, "creation_date": 1477058821, "answer_id": 40178776, "question_id": 40178568, "link": "https://stackoverflow.com/questions/40178568/different-const-value-for-dev-and-prod-env-in-go/40178776#40178776", "title": "Different const value for dev and prod env in go", "body": "<p>Personally I think using environment variables as you've done in your example is the \"correct\" way to do this. This allows you to tweak the behavior without rebuilding the application, which may be very useful while debugging. However, if you really want this done at compile time it can be accomplished with <a href=\"https://golang.org/pkg/go/build/#hdr-Build_Constraints\" rel=\"nofollow\">build constraints</a>.</p>\n\n<p>A built constraint is a special comment placed at the top of a file that says \"only build this file if a specific condition is met\". Conditions can be things like the machine architecture we're building on, the OS we're running, or custom build tags that the user specifies when building.</p>\n\n<p>For example, you could tweak your function to something like:</p>\n\n<pre><code>func NewRecord() Record {\n    return Record{Moderation: ModLevel}\n}\n</code></pre>\n\n<p>and then define ModLevel twice, once in a file <code>modlevel_prod.go</code> that looks like this:</p>\n\n<pre><code>// +build !dev\n\npackage mypackage\n\nconst ModLevel = Awaiting\n</code></pre>\n\n<p>and one in <code>modlevel_dev.go</code> (or whever, the filename doesn't matter in this case) that looks like this:</p>\n\n<pre><code>// +build dev\n\npackage mypackage\n\nconst ModLevel = Approved\n</code></pre>\n\n<p>Now, when you build, the production version of the file is the default and if you want to build the dev version of the file you have to explicitly include the build tag:</p>\n\n<pre><code>$ go build -tags dev\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 6743038, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8b1f7c217b2b5516a0c139448c1711bc?s=128&d=identicon&r=PG&f=1", "display_name": "user6743038", "link": "https://stackoverflow.com/users/6743038/user6743038"}, "edited": false, "score": 0, "creation_date": 1477061745, "post_id": 40179048, "comment_id": 67626866, "body": "Thanks. I, actually, will use this approach, but the marked answer describes how to achieve what I wanted when the question was asked."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1477059544, "creation_date": 1477059544, "answer_id": 40179048, "question_id": 40178568, "link": "https://stackoverflow.com/questions/40178568/different-const-value-for-dev-and-prod-env-in-go/40179048#40179048", "title": "Different const value for dev and prod env in go", "body": "<p>Evaluate the expression once at <a href=\"https://golang.org/ref/spec#Package_initialization\" rel=\"nofollow\">package initialization</a>:</p>\n\n<pre><code>var defaultModeration int\n\nfunc init() {\n    if os.Getenv(mykey) == \"production\" {\n        defaultModeration = Awaiting\n    } else {\n        defaultModeration = Approved\n    }\n}\n\nfunc NewRecord() Record { return Record{Moderation: defaultModeration} }\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 6743038, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8b1f7c217b2b5516a0c139448c1711bc?s=128&d=identicon&r=PG&f=1", "display_name": "user6743038", "link": "https://stackoverflow.com/users/6743038/user6743038"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1331, "favorite_count": 0, "accepted_answer_id": 40178776, "answer_count": 2, "score": 4, "last_activity_date": 1477059544, "creation_date": 1477058202, "question_id": 40178568, "link": "https://stackoverflow.com/questions/40178568/different-const-value-for-dev-and-prod-env-in-go", "title": "Different const value for dev and prod env in go", "body": "<p>For example I'm developing guestbook. It allows to add records, that need to be approved by moderator. But when developing further functionality, it's a pain to approve each record, that is added during testing.\nSo, is it possible to build dev version of application that creates such records with appropriate flag set?</p>\n\n<p>For example prod build is compiled with the following fucntion:</p>\n\n<pre><code>func NewRecord() Record {\n    return Record{Moderation: Awaiting}\n}\n</code></pre>\n\n<p>And in dev build is compiled with:</p>\n\n<pre><code>func NewRecord() Record {\n    return Record{Moderation: Approved}\n}\n</code></pre>\n\n<p>I know in frontend, when you building some JS app, it's a common practice to set NODE_ENV=production environment variable when building for production.\nI'm looking for something similar in Go.\nI see two ways, but don't like any of them:</p>\n\n<ol>\n<li>I can just set <code>Awaiting = Approved</code> while developing and then change it back to actual value when building prod version. But I afraid that one day I will forget about this mock, will commit it to repo or something like that.</li>\n<li><p>Change function to something like</p>\n\n<pre><code>func NewRecord() Record {\n    if os.Getenv(mykey) == \"production\" {\n            return Record{Moderation: Awaiting}\n    } else {\n            return Record{Moderation: Approved}\n    }\n}\n</code></pre>\n\n<p>But I don't like that this condition is evaluated in runtime for each new record. It just seems to be wrong for compiled language.</p></li>\n</ol>\n\n<p>As a bonus it would be nice, if such application can show warning (to stdout/stderr) if it's build as dev version.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["sql-server", "go", "go-gorm"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1477057400, "post_id": 40178215, "comment_id": 67623609, "body": "Can you define &quot;this doesn&#39;t work&quot;? What does that mean?"}, {"owner": {"reputation": 2866, "user_id": 2584786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KbRVX.jpg?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/2584786/neo"}, "edited": false, "score": 0, "creation_date": 1477057515, "post_id": 40178215, "comment_id": 67623695, "body": "What does GORM stand for?"}, {"owner": {"reputation": 14844, "user_id": 243373, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NxxWB.jpg?s=128&g=1", "display_name": "TT.", "link": "https://stackoverflow.com/users/243373/tt"}, "reply_to_user": {"reputation": 2866, "user_id": 2584786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KbRVX.jpg?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/2584786/neo"}, "edited": false, "score": 1, "creation_date": 1477057707, "post_id": 40178215, "comment_id": 67623845, "body": "@MisterPositive If you hover over the tag you&#39;ll see: <code>GORM is Grails&#39; object relational mapping (ORM) implementation.</code>"}, {"owner": {"reputation": 2866, "user_id": 2584786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KbRVX.jpg?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/2584786/neo"}, "reply_to_user": {"reputation": 14844, "user_id": 243373, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NxxWB.jpg?s=128&g=1", "display_name": "TT.", "link": "https://stackoverflow.com/users/243373/tt"}, "edited": false, "score": 0, "creation_date": 1477057745, "post_id": 40178215, "comment_id": 67623870, "body": "@TT LOL, missed the flag.  duh..."}, {"owner": {"reputation": 2866, "user_id": 2584786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KbRVX.jpg?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/2584786/neo"}, "edited": false, "score": 0, "creation_date": 1477057792, "post_id": 40178215, "comment_id": 67623893, "body": "Can you translate the rest of the error message to English?"}, {"owner": {"reputation": 219328, "user_id": 15498, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Wi4EN.png?s=128&g=1", "display_name": "Damien_The_Unbeliever", "link": "https://stackoverflow.com/users/15498/damien-the-unbeliever"}, "edited": false, "score": 0, "creation_date": 1477058007, "post_id": 40178215, "comment_id": 67624048, "body": "<code>IDENTITY_INSERT</code> is a per-session setting and it defaults to <code>OFF</code>. There should be no need to set it explicitly when you&#39;ve just opened a connection, as you show here. So, no matter what the current problem is, changing the <code>IDENTITY_INSERT</code> setting isn&#39;t part of the solution."}, {"owner": {"reputation": 14844, "user_id": 243373, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NxxWB.jpg?s=128&g=1", "display_name": "TT.", "link": "https://stackoverflow.com/users/243373/tt"}, "edited": false, "score": 1, "creation_date": 1477058068, "post_id": 40178215, "comment_id": 67624087, "body": "Are you really sure you want to insert an explicit value for the ID column when that column is clearly an IDENTITY column? Values in an identity column are supposed to be generated by the database engine, not by you on the presentation layer."}, {"owner": {"reputation": 905, "user_id": 2323245, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/692ba01c39a0306d91a706c1273ca840?s=128&d=identicon&r=PG", "display_name": "sbouaked", "link": "https://stackoverflow.com/users/2323245/sbouaked"}, "reply_to_user": {"reputation": 2866, "user_id": 2584786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KbRVX.jpg?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/2584786/neo"}, "edited": false, "score": 0, "creation_date": 1477058296, "post_id": 40178215, "comment_id": 67624257, "body": "@MisterPositive i tried to translate :) , TT i&#39;m just trying to learn how GORM working :) and to follow the documentation :x"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1477068702, "post_id": 40178215, "comment_id": 67630917, "body": "You probably shouldn&#39;t do this in our application code. It would be a lot more appropriate to set in a deploy script. Also, isn&#39;t that the default behavior on the table? You have id as primary key? Auto increment int?"}], "answers": [{"comments": [{"owner": {"reputation": 2866, "user_id": 2584786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KbRVX.jpg?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/2584786/neo"}, "reply_to_user": {"reputation": 905, "user_id": 2323245, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/692ba01c39a0306d91a706c1273ca840?s=128&d=identicon&r=PG", "display_name": "sbouaked", "link": "https://stackoverflow.com/users/2323245/sbouaked"}, "edited": false, "score": 0, "creation_date": 1477058547, "post_id": 40178606, "comment_id": 67624431, "body": "I did not see the ON part in your code sample above, and the error clearly says Identity_Insert is set to off."}, {"owner": {"reputation": 905, "user_id": 2323245, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/692ba01c39a0306d91a706c1273ca840?s=128&d=identicon&r=PG", "display_name": "sbouaked", "link": "https://stackoverflow.com/users/2323245/sbouaked"}, "edited": false, "score": 0, "creation_date": 1477058654, "post_id": 40178606, "comment_id": 67624513, "body": "following <a href=\"https://msdn.microsoft.com/fr-fr/library/ms188059.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/fr-fr/library/ms188059.aspx</a> Identity_Insert have to be Off to insert element WITHOUT a specific ID"}, {"owner": {"reputation": 2866, "user_id": 2584786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KbRVX.jpg?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/2584786/neo"}, "reply_to_user": {"reputation": 905, "user_id": 2323245, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/692ba01c39a0306d91a706c1273ca840?s=128&d=identicon&r=PG", "display_name": "sbouaked", "link": "https://stackoverflow.com/users/2323245/sbouaked"}, "edited": false, "score": 0, "creation_date": 1477058725, "post_id": 40178606, "comment_id": 67624576, "body": "No -- you have to set Identity_Insert On to allow for inserts where you want to specify the value for the identity column, then you disable it by turning it off.  The code included is correct way to insert into a table with Identity column"}, {"owner": {"reputation": 905, "user_id": 2323245, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/692ba01c39a0306d91a706c1273ca840?s=128&d=identicon&r=PG", "display_name": "sbouaked", "link": "https://stackoverflow.com/users/2323245/sbouaked"}, "edited": false, "score": 0, "creation_date": 1477059834, "post_id": 40178606, "comment_id": 67625406, "body": "it&#39;s doesn&#39;t work too with the ON value.. :( have the same error"}], "tags": [], "owner": {"reputation": 2866, "user_id": 2584786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KbRVX.jpg?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/2584786/neo"}, "is_accepted": false, "score": 0, "last_activity_date": 1477058838, "last_edit_date": 1477058838, "creation_date": 1477058326, "answer_id": 40178606, "question_id": 40178215, "link": "https://stackoverflow.com/questions/40178215/how-to-turn-off-identity-insert-for-gorm/40178606#40178606", "title": "How to turn OFF IDENTITY_INSERT for GORM", "body": "<p>If you <strong>really</strong> need to do this, and there are rare cases for this you have to enable this functionality ( to set the value for identity column ) like so</p>\n\n<pre><code>Set Identity_Insert dbo.users On\nInsert Into users (YOURIDENTITYCOLUMN, NAME)\nValues(1, 'your value')\nSet Identity_Insert dbo.users Off\n</code></pre>\n\n<p>If your not trying to set the value of the identity column, then remove the statement SET Identity_Insert dbo.users Off portion from your query.</p>\n"}, {"tags": [], "owner": {"reputation": 929, "user_id": 6146337, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10207160730031528/picture?type=large", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/6146337/sebastian"}, "is_accepted": false, "score": 1, "last_activity_date": 1594765853, "creation_date": 1594765853, "answer_id": 62904921, "question_id": 40178215, "link": "https://stackoverflow.com/questions/40178215/how-to-turn-off-identity-insert-for-gorm/62904921#62904921", "title": "How to turn OFF IDENTITY_INSERT for GORM", "body": "<p>you have to use a transaction</p>\n<pre><code>tx := db.Begin()\nif err := tx.Exec(&quot;SET IDENTITY_INSERT users OFF;&quot;).Error; err != nil {\n    return err\n}\nif err := tx.Commit().Error; err != nil {\n    return err\n}\n</code></pre>\n"}], "owner": {"reputation": 905, "user_id": 2323245, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/692ba01c39a0306d91a706c1273ca840?s=128&d=identicon&r=PG", "display_name": "sbouaked", "link": "https://stackoverflow.com/users/2323245/sbouaked"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 574, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1594765853, "creation_date": 1477057240, "last_edit_date": 1527756906, "question_id": 40178215, "link": "https://stackoverflow.com/questions/40178215/how-to-turn-off-identity-insert-for-gorm", "title": "How to turn OFF IDENTITY_INSERT for GORM", "body": "<p>I would like to turn OFF the <code>IDENTITY_INSERT</code> to insert data with GORM without specify any ID.</p>\n\n<p>I try this :</p>\n\n<pre><code>func main() {\n\n    db, err := gorm.Open(\"mssql\", \"...\")\n\n    //...\n    db.DropTable(&amp;User{})\n    db.CreateTable(&amp;User{})\n    db.Exec(\"SET IDENTITY_INSERT users OFF;\") &lt;-- this doesn't work\n\n    for _, user := range users {\n        db.Create(&amp;user)\n    }\n\n}\n\ntype User struct {\n    ID        uint\n    UserName  string\n    FirstName string\n    LastName  string\n}\n\nvar users []User = []User{\n    User{UserName: \"testUserName\", FirstName: \"testFirstName\", LastName: \"TestLastName\"},\n    User{UserName: \"testUserName\", FirstName: \"testFirstName\", LastName: \"TestLastName\"},\n    User{UserName: \"testUserName\", FirstName: \"testFirstName\", LastName: \"TestLastName\"},\n}\n</code></pre>\n\n<p>EDIT :</p>\n\n<p>The data is not create in database, I have the following error (sorry in french) :</p>\n\n<pre><code>(mssql: Une valeur explicite doit \u00eatre sp\u00e9cifi\u00e9e dans la colonne d'identit\u00e9 de la table 'users' quand IDENTITY_INSERT est d\u00e9fini \u00e0 ON, ou qu'un utilisateur de la r\u00e9plication effectue une insertion dans une colonne d'identit\u00e9 NOT FOR REPLICATION.)\n</code></pre>\n\n<p>in en :</p>\n\n<pre><code>Cannot insert explicit value for identity column in table 'users' when IDENTITY_INSERT is set to OFF.\"\n</code></pre>\n\n<p>The program work if I add the ID value like :</p>\n\n<pre><code>User{ID: 1, UserName: \"testUserName\", FirstName: \"testFirstName\", LastName: \"TestLastName\"}\n</code></pre>\n\n<p>Someone have any idea ?</p>\n"}, {"tags": ["unit-testing", "testing", "go", "automated-tests"], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 5608289, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab011a0f1618b7f9bec3dcf25d079549?s=128&d=identicon&r=PG&f=1", "display_name": "Sapna Mishra", "link": "https://stackoverflow.com/users/5608289/sapna-mishra"}, "edited": false, "score": 0, "creation_date": 1477284929, "post_id": 40178658, "comment_id": 67685894, "body": "Ok then how I can call &quot; func (imc ImessageSoundController) ImessageSound(w http.ResponseWriter, r *http.Request) &quot; api method in http.HandlerFunc ?"}, {"owner": {"reputation": 11, "user_id": 7053511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66cd35981be74eaf68a90f1802bb39a0?s=128&d=identicon&r=PG&f=1", "display_name": "Proton14", "link": "https://stackoverflow.com/users/7053511/proton14"}, "reply_to_user": {"reputation": 157, "user_id": 5608289, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab011a0f1618b7f9bec3dcf25d079549?s=128&d=identicon&r=PG&f=1", "display_name": "Sapna Mishra", "link": "https://stackoverflow.com/users/5608289/sapna-mishra"}, "edited": false, "score": 0, "creation_date": 1477943196, "post_id": 40178658, "comment_id": 67953360, "body": "You create an instance of struct ImessageSoundController inside the test function, configure it with desired values and then call the method in the test function."}], "tags": [], "owner": {"reputation": 11, "user_id": 7053511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66cd35981be74eaf68a90f1802bb39a0?s=128&d=identicon&r=PG&f=1", "display_name": "Proton14", "link": "https://stackoverflow.com/users/7053511/proton14"}, "is_accepted": false, "score": 0, "last_activity_date": 1477058472, "creation_date": 1477058472, "answer_id": 40178658, "question_id": 40176643, "link": "https://stackoverflow.com/questions/40176643/testing-in-go-api-call/40178658#40178658", "title": "Testing in go api call", "body": "<p>A test should be a function, not a method. Just make it:</p>\n\n<pre><code>func TestHealthCheckHandler(t *testing.T) {\n    ...\n}\n</code></pre>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 157, "user_id": 5608289, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab011a0f1618b7f9bec3dcf25d079549?s=128&d=identicon&r=PG&f=1", "display_name": "Sapna Mishra", "link": "https://stackoverflow.com/users/5608289/sapna-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477058472, "creation_date": 1477052704, "question_id": 40176643, "link": "https://stackoverflow.com/questions/40176643/testing-in-go-api-call", "title": "Testing in go api call", "body": "<p>I want to write test cases for my api like: database query fail,error in code,response error etc.</p>\n\n<p>So I have created one file called controller_test.go in controllers folder.</p>\n\n<p>here is my code:</p>\n\n<pre><code>    package controllers\n\n    import (\n       \"net/http\"\n       \"testing\"\n       \"net/http/httptest\"\n     )\n\n func (imc ImessageSoundController) TestHealthCheckHandler(t *testing.T) {\n\n    req, err := http.NewRequest(\"GET\",\"sound/imessage_sound\", nil)\n    if err != nil {\n        t.Fatal(err)\n    }\n    rr := httptest.NewRecorder()\n    handler := http.HandlerFunc(imc.ImessageSound)\n    handler.ServeHTTP(rr, req)\n\n    if status := rr.Code; status != http.StatusOK {\n        t.Errorf(\"handler returned wrong status code: got %v want %v\",\n            status, http.StatusOK)\n    }\n}\n</code></pre>\n\n<p>My api logic is written in code.go in controllers folder.\nhere is my code:</p>\n\n<pre><code>package controllers\n\nimport (\n   //required packages\n)\n\ntype (\n    ImessageSoundController struct {\n        session *sql.DB\n    }\n)\n\nfunc NewImessageSoundController(s *sql.DB) *ImessageSoundController {\n    return &amp;ImessageSoundController{s}\n}\n\nfunc (imc ImessageSoundController) ImessageSound(w http.ResponseWriter, r *http.Request) {\n //Code logic\n}\n</code></pre>\n\n<p>I am getting this output for above case:</p>\n\n<pre><code>testing: warning: no tests to run\nPASS\nok      tingtong2.1/controllers 0.004s\n</code></pre>\n\n<p>As I am new to this I am not able to find reason for this error.</p>\n"}, {"tags": ["arrays", "string", "parsing", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 4609, "user_id": 1699956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oBr6e.jpg?s=128&g=1", "display_name": "Mangat Rai Modi", "link": "https://stackoverflow.com/users/1699956/mangat-rai-modi"}, "edited": false, "score": 0, "creation_date": 1477051459, "post_id": 40175783, "comment_id": 67619429, "body": "Ah, I thought that string has to be {[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;]} for unmarshal to work, but again an array is json object by itself"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1477053138, "last_edit_date": 1477053138, "creation_date": 1477050072, "answer_id": 40175783, "question_id": 40175664, "link": "https://stackoverflow.com/questions/40175664/go-deserialize-array-string/40175783#40175783", "title": "Go: Deserialize array string", "body": "<p>How about using <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow\"><code>json.Unmarshal()</code></a>?</p>\n\n<pre><code>s := `[\"a\",\"b\",\"c\"]`\n\nvar arr []string\nif err := json.Unmarshal([]byte(s), &amp;arr); err != nil {\n    fmt.Println(\"Error:\", err)\n}\nfmt.Printf(\"%q\", arr)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/zOXSW9UQmu\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>[\"a\" \"b\" \"c\"]\n</code></pre>\n\n<p>But know that package <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow\"><code>json</code></a> does a lot of reflection kung-fu under the hood, it's faster if you write the parsing yourself. On the other hand, package <code>json</code> will also handle random white-spaces in the input \u2013 even newline characters and Unicode sequences, like this one (it's equivalent to <code>[\"a\",\"b\",\"c\"]</code>):</p>\n\n<pre><code>s := `[ \"a\" , \"b\"  \n ,\"\\u0063\"  ]  `\n</code></pre>\n"}], "owner": {"reputation": 4609, "user_id": 1699956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oBr6e.jpg?s=128&g=1", "display_name": "Mangat Rai Modi", "link": "https://stackoverflow.com/users/1699956/mangat-rai-modi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 40175783, "answer_count": 1, "score": 3, "last_activity_date": 1477053138, "creation_date": 1477049683, "last_edit_date": 1477050213, "question_id": 40175664, "link": "https://stackoverflow.com/questions/40175664/go-deserialize-array-string", "title": "Go: Deserialize array string", "body": "<p>I have a string as: - <code>[\"a\",\"b\",\"c\"]</code>. How to parse / convert it into a Go array? I can do string parsing but is there any out of the box function in Go for the same.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1477048577, "post_id": 40175001, "comment_id": 67617565, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/23542989/pointers-vs-values-in-parameters-and-return-values\">Pointers vs. values in parameters and return values</a>; and <a href=\"http://stackoverflow.com/questions/31932822/why-should-constructor-of-go-return-address\">Why should constructor of Go return address?</a>, and <a href=\"http://stackoverflow.com/questions/32208363/returning-value-vs-pointer-in-go-constructor\">returning value vs pointer in Go constructor</a>."}, {"owner": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1477049109, "post_id": 40175001, "comment_id": 67617907, "body": "Hi @icza, thanks for pointing those out, they did not appeared as suggestions as I typed. The first one indeed seems to address the same question, but the selected answer 1/ refer to &quot;guidelines&quot; and &quot;good practice&quot; without clearly stating the reasons why (but a lot of useful info, still!) and 2/ quite seems to recommend actually avoiding using &amp;Type{} by default :) I guess it could be useful to clearly state the reasons in favor of this pattern here."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1477052360, "post_id": 40175001, "comment_id": 67620066, "body": "That&#39;s not only about speed, Olivier. Consider you constructed a bunch of <code>Foo</code>s, and placed these values into several distinct containers (say, slices) copying them by value. This means each container now has a copy of each of the source value, and changing each of them in any of these containers will not have any effect on the others. Sometimes it&#39;s okay, sometimes it&#39;s not. In each case you should think what <i>semantics</i> you want to put to the values of a type you&#39;re creating and how do you intend to use values of that type."}, {"owner": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "edited": false, "score": 0, "creation_date": 1477052781, "post_id": 40175001, "comment_id": 67620345, "body": "Indeed :) In that example, does dereferencing upon variable initialization offers anything more than using <code>append( myslice, &amp;myItem )</code>, though?"}], "answers": [{"comments": [{"owner": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "edited": false, "score": 1, "creation_date": 1477049653, "post_id": 40175360, "comment_id": 67618249, "body": "Hi Teoman,  thanks for answer! I&#39;ll make a benchmark to try to measure the actual cost of duplication. Thanks for the doc, too, but I was actually wondering about docs around the <code>&amp;Type{}</code> pattern :) I&#39;ll clarify the question."}, {"owner": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "edited": false, "score": 1, "creation_date": 1477050666, "post_id": 40175360, "comment_id": 67618886, "body": "Ok, here is a benchmark : <a href=\"https://gist.github.com/oelmekki/d7e93170b00278d73ccea052a2ee7ed7\" rel=\"nofollow noreferrer\">gist.github.com/oelmekki/d7e93170b00278d73ccea052a2ee7ed7</a> That&#39;s about 500ms difference for 1B function calls. So I guess the conclusion is that it&#39;s worth using references for extremely intensive computation (like networking you mentioned), but not that much for smaller apps."}, {"owner": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "edited": false, "score": 0, "creation_date": 1477050835, "post_id": 40175360, "comment_id": 67619006, "body": "Just to be sure, I ran the benchmark again with setting an actual value in the <code>Name</code> field, this does not change the results."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "edited": false, "score": 1, "creation_date": 1477054054, "post_id": 40175360, "comment_id": 67621266, "body": "@OlivierElMekki: dereferencing a pointer can be expensive, and a CPU can copy a lot of data in the same time. Structures smaller than a cache-line or 2 (which most are) aren&#39;t going to benefit performance wise from pointers. The logic of the program, sharing the address for mutability or copying the value, is going to dictate which to use."}, {"owner": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477058931, "post_id": 40175360, "comment_id": 67624716, "body": "@JimB Can you show an example where this happens? I&#39;ve edited my benchmark to include accessing a field value, and it&#39;s still 500ms better when passing a reference: <a href=\"https://gist.github.com/oelmekki/c39a1347455badfbbff268da27c3ccba\" rel=\"nofollow noreferrer\">gist.github.com/oelmekki/c39a1347455badfbbff268da27c3ccba</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "edited": false, "score": 1, "creation_date": 1477060498, "post_id": 40175360, "comment_id": 67625922, "body": "@OlivierElMekki: benchmarks are hard to get right, especially microbenchmarks that need to take into account data locality, CPU specific cache behavior and branch prediction. In your example, the compiler could choose to completely remove either of those calls, and you could be timing something else entirely since you&#39;re not doing any real work. Using the current compiler and benchmarking tool, both those calls will take exactly the same amount of time, probably because they are optimized out"}], "tags": [], "owner": {"reputation": 24651, "user_id": 628273, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/999ac8e29041aeeda8e0e35b416efa04?s=128&d=identicon&r=PG", "display_name": "Teoman Soygul", "link": "https://stackoverflow.com/users/628273/teoman-soygul"}, "is_accepted": true, "score": 1, "last_activity_date": 1477049148, "last_edit_date": 1477049148, "creation_date": 1477048838, "answer_id": 40175360, "question_id": 40175001, "link": "https://stackoverflow.com/questions/40175001/any-documentation-article-about-the-mytype-pattern-in-golang/40175360#40175360", "title": "Any documentation/article about the `&amp;MyType{}` pattern in golang?", "body": "<p>Go is pass by value. I try to use references like in your example as much as possible to remove the mental process of thinking about not making duplicates of objects. Go is mostly meant for networking &amp; scaling, which makes performance a priority. Obvious downside of this is as you say, receiving methods can destroy the object that the pointer points to.</p>\n\n<p>Otherwise there is no rule as to which you should use. Both are quite ok.</p>\n\n<p>Also, somewhat related to the question, from the Go docs: <a href=\"https://golang.org/doc/effective_go.html#pointers_vs_values\" rel=\"nofollow\">Pointers vs. Values</a></p>\n"}], "owner": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 40175360, "answer_count": 1, "score": -1, "last_activity_date": 1477049723, "creation_date": 1477047847, "last_edit_date": 1477049723, "question_id": 40175001, "link": "https://stackoverflow.com/questions/40175001/any-documentation-article-about-the-mytype-pattern-in-golang", "title": "Any documentation/article about the `&amp;MyType{}` pattern in golang?", "body": "<p>In most golang codebases I look, people are using types by reference:</p>\n\n<pre><code>type Foo struct {}\nmyFoo := &amp;Foo{}\n</code></pre>\n\n<p>I usually take the opposite approach, passing everything as copy and only pass by reference when I want to perform something destructive on the value, which allows me to easily spot destructive functions (and which is fairly rare).</p>\n\n<p>But seeing how references are commonplace, I guess it's not just a matter of taste. I get there's a cost in duplicating values, is it that much of a game changer? Or are there other reasons why references are preferred?</p>\n\n<p>It would be great if someone could point me to an article or documentation about why references are preferred.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1477041683, "post_id": 40172613, "comment_id": 67613178, "body": "<code>all.bash</code> is all you need to build all."}, {"owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "edited": false, "score": 0, "creation_date": 1477059836, "post_id": 40172613, "comment_id": 67625407, "body": "Building will put the output in the first directory in your Go path + ./src/go/bin/go, this will need to be on your path in front of wherever your bootstrap Go install lives. It may also put the binaries in $GOBIN if set, IIRC."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "edited": false, "score": 0, "creation_date": 1477070398, "post_id": 40172613, "comment_id": 67631752, "body": "@SamWhited: no it won&#39;t. Stdlib packages are special cased, and installed in GOROOT."}, {"owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477072475, "post_id": 40172613, "comment_id": 67632846, "body": "@JimB if you have goroot set, but you really shouldn&#39;t: <a href=\"http://dave.cheney.net/2013/06/14/you-dont-need-to-set-goroot-really\" rel=\"nofollow noreferrer\">dave.cheney.net/2013/06/14/you-dont-need-to-set-goroot-reall&zwnj;&#8203;y</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "edited": false, "score": 1, "creation_date": 1477072777, "post_id": 40172613, "comment_id": 67633008, "body": "@SamWhited: no, GOROOT is implied whether you set it or not (look at the output of <code>go env GOROOT</code>, and yes, you should not set it). You can see the see the output from my example (or use <code>-x</code> if you want everything), and check the timestamp on <code>GOROOT&#47;pkg&#47;GOOS_GOARCH&#47;runtime.a</code>."}, {"owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "edited": false, "score": 0, "creation_date": 1477086025, "post_id": 40172613, "comment_id": 67639302, "body": "Yes, I&#39;m aware of that. Looks like I was wrong about the path though; you&#39;re correct. I changed my GOPATH and it still put it where the previous source was."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1477070451, "creation_date": 1477070451, "answer_id": 40182259, "question_id": 40172613, "link": "https://stackoverflow.com/questions/40172613/golang-runtime-recompile/40182259#40182259", "title": "Golang Runtime recompile", "body": "<p>You install packages by their import path, so you don't use the <code>src/</code> prefix.</p>\n\n<p>To recompile the runtime package, use:</p>\n\n<pre><code>$ go install -a -v runtime\nruntime/internal/sys\nruntime/internal/atomic\nruntime\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6138702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d90f2fdcb61fd7a4cf719cd004ef34c?s=128&d=identicon&r=PG&f=1", "display_name": "JinM", "link": "https://stackoverflow.com/users/6138702/jinm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1528, "favorite_count": 0, "accepted_answer_id": 40182259, "answer_count": 1, "score": 2, "last_activity_date": 1477070451, "creation_date": 1477041008, "question_id": 40172613, "link": "https://stackoverflow.com/questions/40172613/golang-runtime-recompile", "title": "Golang Runtime recompile", "body": "<p>Well ,I sooooo flesh for the Golang . And I get a mission to recompile the Golang 's runtime via this <a href=\"https://www.ibm.com/blogs/bluemix/2015/11/docker-insane-scale-on-ibm-power-systems/\" rel=\"nofollow\">blog</a>.</p>\n\n<p><code>\nOne way is to change this default number in the GO runtime (GCC-GO or GC) and recompile the runtime. In proc.go, you can change the line sched.maxmcount = 10000 to a number that is appropriate.\n</code></p>\n\n<h3>First: recompile the whole golang.</h3>\n\n<p>I follow this <a href=\"https://golang.org/doc/install/source\" rel=\"nofollow\">Installing Go from source</a> ,and execute this cmd\uff1a</p>\n\n<p><code>./all.bash</code></p>\n\n<p>Output is :</p>\n\n<pre><code>Building Go bootstrap tool.\ncmd/dist\nimport cycle not allowed\npackage cmd/dist\n    imports bytes\n    imports errors\n    imports runtime\n    imports runtime/internal/atomic\n    imports unsafe\n    imports runtime\n</code></pre>\n\n<p>It seems everything work well, but while I check about the <code>go</code> cmd\uff0cit's the same. Also ,I can't find any change to bin or pkg dir.</p>\n\n<h3>Then ,try to build pkg</h3>\n\n<p><code>go install src/runtime</code></p>\n\n<p>Also, it doesn't come out any error and I can't find any target build. </p>\n\n<p>I  have no any idea how to do it  :(</p>\n\n<p>Any suggestion well so appresiate !</p>\n"}, {"tags": ["go", "hyperledger", "hyperledger-fabric"], "comments": [{"owner": {"reputation": 15819, "user_id": 1149423, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KmNLc.png?s=128&g=1", "display_name": "Sufiyan Ghori", "link": "https://stackoverflow.com/users/1149423/sufiyan-ghori"}, "edited": false, "score": 0, "creation_date": 1477263962, "post_id": 40170010, "comment_id": 67681824, "body": "which version of fabric are you using ?"}, {"owner": {"reputation": 366, "user_id": 6264316, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cOoBh.jpg?s=128&g=1", "display_name": "6londe", "link": "https://stackoverflow.com/users/6264316/6londe"}, "reply_to_user": {"reputation": 15819, "user_id": 1149423, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KmNLc.png?s=128&g=1", "display_name": "Sufiyan Ghori", "link": "https://stackoverflow.com/users/1149423/sufiyan-ghori"}, "edited": false, "score": 0, "creation_date": 1477272340, "post_id": 40170010, "comment_id": 67683389, "body": "@SufiyanGhori Maybe latest. I used this command for download :  <code>git clone ssh:&#47;&#47;LFID@gerrit.hyperledger.org:29418&#47;fabric &amp;&amp; scp -p -P 29418 LFID@gerrit.hyperledger.org:hooks&#47;commit-msg fabric&#47;.git&#47;hooks&#47;</code>"}, {"owner": {"reputation": 366, "user_id": 6264316, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cOoBh.jpg?s=128&g=1", "display_name": "6londe", "link": "https://stackoverflow.com/users/6264316/6londe"}, "reply_to_user": {"reputation": 15819, "user_id": 1149423, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KmNLc.png?s=128&g=1", "display_name": "Sufiyan Ghori", "link": "https://stackoverflow.com/users/1149423/sufiyan-ghori"}, "edited": false, "score": 0, "creation_date": 1477277240, "post_id": 40170010, "comment_id": 67684320, "body": "@SufiyanGhori <code>git branch</code> shows only <code>master</code>. <code>git log</code> shows that <code>4b53c7c04b8502de108040ef4ff81f4de0d257d2</code> is top latest."}, {"owner": {"reputation": 366, "user_id": 6264316, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cOoBh.jpg?s=128&g=1", "display_name": "6londe", "link": "https://stackoverflow.com/users/6264316/6londe"}, "reply_to_user": {"reputation": 15819, "user_id": 1149423, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KmNLc.png?s=128&g=1", "display_name": "Sufiyan Ghori", "link": "https://stackoverflow.com/users/1149423/sufiyan-ghori"}, "edited": false, "score": 0, "creation_date": 1477282431, "post_id": 40170010, "comment_id": 67685279, "body": "@SufiyanGhori Thank you for your replies.  (1) I tried to pull the latest updates and it showed same error. (2) I used your example code, it worked but showed another error in Terminal 3. <code>Error: Error building chaincode: rpc error: code = 2 desc = Error getting chaincode package bytes: Cannot generate hashcode from empty chaincode path</code>  I&#39;m trying to find the solution now..."}], "answers": [{"tags": [], "owner": {"reputation": 1758, "user_id": 4627552, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/PKXU2.jpg?s=128&g=1", "display_name": "Clyde D&#39;Cruz", "link": "https://stackoverflow.com/users/4627552/clyde-dcruz"}, "is_accepted": true, "score": 3, "last_activity_date": 1477297467, "creation_date": 1477297467, "answer_id": 40213756, "question_id": 40170010, "link": "https://stackoverflow.com/questions/40170010/hyperledger-fabric-chaincode-deploy-connection-error/40213756#40213756", "title": "Hyperledger-fabric : chaincode deploy connection error", "body": "<p>It seems you are missing the compose statements to map the required ports from the docker container to the host machine (where you are trying out the peer command ). So its possible that the peer process is listening on port 7051 inside your peer docker container, but this connection is not available to the peer command used outside of this container in terminal 3.</p>\n\n<p>You can map ports using the 'ports' tag. eg:</p>\n\n<pre><code>membersrvc:\n  image: hyperledger/fabric-membersrvc\n  ports:\n    - \"7054:7054\"\n  command: membersrvc\n\nvp0:\n  image: hyperledger/fabric-peer\n  ports:\n    - \"7050:7050\"\n    - \"7051:7051\"\n    - \"7053:7053\"\n  environment:\n    - CORE_PER_ID=vp0\n    - CORE_PEER_ADDRESSAUTODETECT=true\n    - CORE_VM_ENDPOINT=http://0.0.0.0:2375\n    - CORE_LOGGING_LEVEL=DEBUG\n  command: sh -c \"sleep 5; peer node start --peer-chaincodedev\"\n</code></pre>\n\n<p>Before you do <code>peer chaincode deploy ...</code>in terminal 3, you can check if a the peer process is listening on port 7051 using </p>\n\n<pre><code>netstat -lnptu |grep 7051\n</code></pre>\n"}], "owner": {"reputation": 366, "user_id": 6264316, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cOoBh.jpg?s=128&g=1", "display_name": "6londe", "link": "https://stackoverflow.com/users/6264316/6londe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2724, "favorite_count": 1, "accepted_answer_id": 40213756, "answer_count": 1, "score": 0, "last_activity_date": 1478833337, "creation_date": 1477032305, "question_id": 40170010, "link": "https://stackoverflow.com/questions/40170010/hyperledger-fabric-chaincode-deploy-connection-error", "title": "Hyperledger-fabric : chaincode deploy connection error", "body": "<p>I'm trying to test fabric chaincode example02, with docker. I'm newbie :)</p>\n\n<p>This is my <code>docker-compose.yml</code> :</p>\n\n<pre><code>membersrvc:\n  image: hyperledger/fabric-membersrvc\n  command: membersrvc\n\nvp0:\n  image: hyperledger/fabric-peer\n  environment:\n    - CORE_PER_ID=vp0\n    - CORE_PEER_ADDRESSAUTODETECT=true\n    - CORE_VM_ENDPOINT=http://0.0.0.0:2375\n    - CORE_LOGGING_LEVEL=DEBUG\n  command: sh -c \"sleep 5; peer node start --peer-chaincodedev\"\n\nvp1:\n  extends:\n    service: vp0\n  environment:\n    - CORE_PEER_ID=vp1\n    - CORE_PEER_DISCOVERY_ROOTNODE=vp0:7051\n  links:\n    - vp0\n\nvp2:\n  extends:\n    service: vp0\n  environment:\n    - CORE_PEER_ID=vp2\n    - CORE_PEER_DISCOVERY_ROOTNODE=vp0:7051\n  links:\n    - vp0\n</code></pre>\n\n<p>and I run (I refered to <a href=\"http://hyperledger-fabric.readthedocs.io/en/latest/Setup/Chaincode-setup/#vagrant\" rel=\"nofollow\">Fabric chaincode setup page</a>):</p>\n\n<p>Terminal 1 :</p>\n\n<p><code>$ docker-compose up</code></p>\n\n<p>Terminal 2 :</p>\n\n<p><code>$ cd /hyperledger/examples/chaincode/go/chaincode_example02</code></p>\n\n<p><code>$ CORE_CHAINCODE_ID_NAME=mycc CORE_PEER_ADDRESS=0.0.0.0:7051 ./chaincode_example02</code></p>\n\n<p>Terminal 3 :</p>\n\n<p><code>$ peer chaincode deploy -n mycc -c '{\"Args\": [\"init\", \"a\",\"100\", \"b\", \"200\"]}'</code></p>\n\n<p>It works well in terminal 1,2. But terminal 3 shows connection error.</p>\n\n<pre><code>2016/10/21 04:39:15 grpc: addrConn.resetTransport failed to create client\ntransport: connection error: desc = \"transport: dial tcp 0.0.0.0:7051:\ngetsockopt: connection refused\"; Reconnecting to {\"0.0.0.0:7051\" &lt;nil&gt;}\nError: Error building chaincode: Error trying to connect to local peer: \ngrpc: timed out when dialing\n</code></pre>\n\n<p>What's the problem?</p>\n"}, {"tags": ["go", "go-interface"], "answers": [{"comments": [{"owner": {"reputation": 468, "user_id": 3236133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40ae0b1f5c86380a2f89355a011b0dbd?s=128&d=identicon&r=PG&f=1", "display_name": "Clicquot the Dog", "link": "https://stackoverflow.com/users/3236133/clicquot-the-dog"}, "edited": false, "score": 0, "creation_date": 1477023005, "post_id": 40168235, "comment_id": 67604643, "body": "I tried to better demonstrate the problem, please see my last edit"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1477023159, "last_edit_date": 1477023159, "creation_date": 1477022869, "answer_id": 40168235, "question_id": 40168185, "link": "https://stackoverflow.com/questions/40168185/using-interfaces-correctly-when-creating-structs/40168235#40168235", "title": "Using interfaces correctly when creating structs", "body": "<p>The variable <code>something</code> is declared as the empty interface. There are no methods on the empty interface. To call the <code>Dong</code> method, declare <code>something</code> as a <code>foo.Foo</code> .</p>\n\n<p>Change </p>\n\n<pre><code>var something interface{}\n</code></pre>\n\n<p>to</p>\n\n<pre><code>var something foo.Foo \n</code></pre>\n\n<p>This assumes that <code>bar</code> being like <code>foo</code> means that <code>bar</code> satisfies the <code>foo.Foo</code> interface.</p>\n"}, {"tags": [], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "is_accepted": false, "score": 1, "last_activity_date": 1477036845, "creation_date": 1477036845, "answer_id": 40171303, "question_id": 40168185, "link": "https://stackoverflow.com/questions/40168185/using-interfaces-correctly-when-creating-structs/40171303#40171303", "title": "Using interfaces correctly when creating structs", "body": "<p>If looks, that you are a bit confused. Please, choose - one of two possibilities. If all the types, that you want to put into variable \"something\" has methods Ding, and Dong - than define interface for it.\nFoo is not the best name, better is DingDonger (<a href=\"https://golang.org/doc/effective_go.html#interface-names\" rel=\"nofollow\">https://golang.org/doc/effective_go.html#interface-names</a>).</p>\n\n<p>After:</p>\n\n<pre><code>var something DingDonger\n</code></pre>\n\n<p>each assign to something will be checked, whether type really has required methods, and therefore something.Ding() can not cause an error.</p>\n\n<p>If any variable is type interface{} no one knows, whether it has or not such method and you have to use type assertion (<a href=\"https://golang.org/doc/effective_go.html#interface_conversions\" rel=\"nofollow\">https://golang.org/doc/effective_go.html#interface_conversions</a>) to verify whether method is implemented.</p>\n"}], "owner": {"reputation": 468, "user_id": 3236133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40ae0b1f5c86380a2f89355a011b0dbd?s=128&d=identicon&r=PG&f=1", "display_name": "Clicquot the Dog", "link": "https://stackoverflow.com/users/3236133/clicquot-the-dog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 40168235, "answer_count": 2, "score": -1, "last_activity_date": 1477036845, "creation_date": 1477022540, "last_edit_date": 1477022985, "question_id": 40168185, "link": "https://stackoverflow.com/questions/40168185/using-interfaces-correctly-when-creating-structs", "title": "Using interfaces correctly when creating structs", "body": "<p>I'm trying to write a small program in which I have a few packages, each with a struct that implements an interface. The idea is that based on user input, I can choose what package to use to build a particular struct and then call a function on it that they're all supposed to have. Since I don't know the type ahead of time, I was under the impression that I could use a <code>interface{}</code> and use that as a forward declaration (see the last code snippet). I have something that looks like this:</p>\n\n<pre><code>package foo\n\ntype FooInput struct {\n    Bar string\n    Baz    int\n}\n\ntype Foo interface {\n    Ding()\n    Dong()\n}\n</code></pre>\n\n<p>In another package, <code>bob</code>, I have something like:</p>\n\n<pre><code>type Bob struct {\n    foo.FooInput\n}\nfunc (mybob *Bob) Ding() {}\nfunc (mybob *Bob) Dong() {}\nfunc MakeBob(foo_input foo.FooInput) (*Bob, error) {\n    my_bob := Bob{foo_input}\n    return &amp;my_bob, nil\n}\n</code></pre>\n\n<p>In my main package, I have something that looks like so:</p>\n\n<pre><code>data = foo.FooInput(\"awyiss\", 1}\nvar something interface{}\nvar err error\n\nswitch some_string {\ncase \"foo\":\n    something, err = bob.MakeBob(foo_input)\ncase \"bar\":\n    // imagine bar is like foo\n    something, err = bar.MakeBar(foo_input)\n// imagine other cases\n}\nsomething.Dong()\n</code></pre>\n\n<p>When running / building / etc, I get the following error:</p>\n\n<pre><code>something.Dong undefined (type interface {} is interface with no methods)\n</code></pre>\n\n<p>I'm a bit confused as to what I'm doing wrong... any clarifiers on how I should use <code>interface{}</code> (if at all) would be extremely helpful!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1477026145, "post_id": 40168086, "comment_id": 67605470, "body": "You could take a look at <a href=\"https://github.com/dpw/vendetta\" rel=\"nofollow noreferrer\">vendetta</a>."}], "answers": [{"comments": [{"owner": {"reputation": 3064, "user_id": 245837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fc0571c15487ff32f4a6ce17113d8eba?s=128&d=identicon&r=PG", "display_name": "jnadro52", "link": "https://stackoverflow.com/users/245837/jnadro52"}, "edited": false, "score": 0, "creation_date": 1477061413, "post_id": 40171150, "comment_id": 67626622, "body": "This is a great answer.  It seems the &quot;what am I missing&quot; comment is answered by &quot;glide&quot; :-)  It seems to make package management much more like node or python, which is amenable to me.  I&quot;m going to give this a whirl.  I think your suggestion will suffice for my need, but I&#39;m going to try it out and wait before i mark it answered.  Thank you!"}, {"owner": {"reputation": 3064, "user_id": 245837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fc0571c15487ff32f4a6ce17113d8eba?s=128&d=identicon&r=PG", "display_name": "jnadro52", "link": "https://stackoverflow.com/users/245837/jnadro52"}, "edited": false, "score": 1, "creation_date": 1477864235, "post_id": 40171150, "comment_id": 67923114, "body": "Glide, specifically using the &quot;mirror&quot; functionality, was exactly what I was looking for.  You can mirror a repo to a local folder and work on it as if it was in the same path.  You just need to remember to run <code>glide update</code> after you change the shared library for the project you&#39;re working on."}], "tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": true, "score": 1, "last_activity_date": 1477036339, "creation_date": 1477036339, "answer_id": 40171150, "question_id": 40168086, "link": "https://stackoverflow.com/questions/40168086/vendoring-golang-shared-repository/40171150#40171150", "title": "Vendoring Golang Shared Repository", "body": "<p>i suggest to use a manifest based approach with version constraint.</p>\n\n<pre><code>Project A == Manifest\n             |- Repo A@~1.0.1\n             |- Repo B@~1.0.1\n\nRepo A == Manifest\n             |- Repo C@~1.0.1\n\nRepo B == Manifest\n             |- Repo C@~1.0.5\n\nRepo C == Manifest empty\n</code></pre>\n\n<p>Which will resolve into</p>\n\n<pre><code>Project A == Resolved Manifest\n             |- Repo A@1.0.1\n             |- Repo B@1.0.1\n             |- Repo C@1.0.5\n</code></pre>\n\n<p>where <code>~1.0.1</code> means <code>&gt;=1.0.1 &lt;1.1.0</code>.</p>\n\n<p>As you see B and A dependency to C are independent, yet within project they are resolved correctly.</p>\n\n<p>In the event A and B would define incompatible dependency to C, an error should occur as the project should not be build-able.</p>\n\n<p>You may prefer to use caret <code>^</code> rather than tilde <code>~</code>, <code>^1.0.1</code> -> <code>&gt;=1.0.1 &lt; 2.0.0</code>.</p>\n\n<p>Note that you are not forced to use those 'helpers' such tilde and caret, you may define explicit version range.</p>\n\n<p>You shall decide which constraint to apply given the level of confidence you give to the remote author to correctly upgrade its version number.</p>\n\n<p>Finally,you can use glide to solve that for you.</p>\n\n<p>Starting with Repo C, assuming you already tagged the repos, run <code>glide init</code>, <code>git commit -am 'glide init'</code>, <code>git push</code></p>\n\n<p>Repo A, <code>glide init</code>, <code>glide get git@repo.com/repoc</code>, <code>git commit -am 'glide init'</code>, <code>git push</code></p>\n\n<p>Repo B, <code>glide init</code>, <code>glide get git@repo.com/repoc</code>, <code>git commit -am 'glide init'</code>, <code>git push</code></p>\n\n<p>Finally, Project A, <code>glide init</code>, <code>glide get git@repo.com/repoa</code>, <code>glide get git@repo.com/repob</code>, <code>git commit -am 'glide init'</code>, <code>git push</code></p>\n\n<p>To re install the project, <code>glide install</code>, <code>go build</code>. </p>\n\n<p>Nothing prevent you to tarball ProjectA with its vendor folder, in order to skip the glide install command when you execute the remote installation.</p>\n\n<p>But you normally don t want to commit the vendor folder for a development environment. You d usually add <code>vendor/</code> to your <code>.gitignore</code> file and run <code>glide install</code> or <code>glide update</code>.</p>\n\n<p>Expect some difficulties in the begin, passed that step, things will work.</p>\n\n<p>Once you jumped to that workflow, note that you ll have to bump every changes on your repos.</p>\n\n<p>That is bloatware when you work both project A and repo B to reach a viable change, so in that case, rather than vendoring repoB into project A (you can leave the manifest definition, but get ride of the repoB folder into vendor/), install repoB as a <code>go</code> module with the <code>go get</code> command. \nDoing so the changes are taken in effect immediately on re-build. Once the change set is completed, browse into each repos and bump them appropriately.</p>\n\n<p>Finally you may want to use a version bumper to help you to get it done quick and fast, it happens i did <a href=\"https://github.com/mh-cbon/gump\" rel=\"nofollow\">one</a> for my personal usage.</p>\n\n<p>hope this helps.</p>\n"}], "owner": {"reputation": 3064, "user_id": 245837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fc0571c15487ff32f4a6ce17113d8eba?s=128&d=identicon&r=PG", "display_name": "jnadro52", "link": "https://stackoverflow.com/users/245837/jnadro52"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "accepted_answer_id": 40171150, "answer_count": 1, "score": 1, "last_activity_date": 1477036339, "creation_date": 1477021820, "question_id": 40168086, "link": "https://stackoverflow.com/questions/40168086/vendoring-golang-shared-repository", "title": "Vendoring Golang Shared Repository", "body": "<p>Trying to move to the officially supported Golang vendoring solution from legacy Godeps workflow.</p>\n\n<p>Scenario:</p>\n\n<pre><code>Repo A===\n         \\\n           ========&gt; Repo C (shared library code)\n         /  \nRepo B===\n</code></pre>\n\n<p>What is the best workflow I can choose for a mid-size (roughly 5-10 member) team of engineers to vendor Repo C for both Repo A and Repo B? Engineers of varying abilities, most of which probably shouldn't need to know the details of this at all?  </p>\n\n<p>I'm currently using govendor for this. I'd prefer not to switch but would if there is a tool that provides a better workflow.</p>\n\n<p>This needs to integrate with a CI server running the builds. I can think of 3 scenarios:</p>\n\n<p>Vendor Repo C into A &amp; B:</p>\n\n<ul>\n<li><p>Pros:</p>\n\n<ul>\n<li>Reproducible Builds</li>\n<li>Easy integration with CI</li>\n</ul></li>\n<li><p>Cons:</p>\n\n<ul>\n<li>Manual and Error Prone - Can easily vendor incorrect code</li>\n<li>Engineers need decent knowledge of vendor tool and methodology</li>\n</ul></li>\n</ul>\n\n<p>Symlink Repo C trunk branch into vendor folders of A &amp; B:</p>\n\n<ul>\n<li><p>Pros:</p>\n\n<ul>\n<li>Engineers need no knowledge of vendor tool</li>\n<li>Low Developer Maintenance</li>\n</ul></li>\n<li><p>Cons:</p>\n\n<ul>\n<li>Builds not (easily) reproducible</li>\n<li>Possibility of including code in build that shouldn't be released</li>\n<li>Less Flexible (Repo A and Repo B can't have differing versions of C)</li>\n</ul></li>\n</ul>\n\n<p>Include Repo C as a git submodule or subtree in Repo A and Repo B (either utilizing vendor or not):</p>\n\n<ul>\n<li><p>Pros:   </p>\n\n<ul>\n<li>Engineers need no knowledge of vendor tool   </li>\n<li>Easy Setup   </li>\n<li>Less Maintenance   </li>\n<li>Reproducible Builds</li>\n</ul></li>\n<li><p>Cons:   </p>\n\n<ul>\n<li>Having to use git submodule or subtree</li>\n</ul></li>\n</ul>\n\n<p>Finding surprisingly little about this question on the internet.  Is there some idiomatic way of doing this?  I'm sure there are other ways of doing this; what am I missing?</p>\n"}, {"tags": ["go", "protocol-buffers"], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "is_accepted": true, "score": 1, "last_activity_date": 1477055563, "creation_date": 1477055563, "answer_id": 40177599, "question_id": 40166997, "link": "https://stackoverflow.com/questions/40166997/go-protocol-buffer-set-up-wrong/40177599#40177599", "title": "go protocol buffer set up wrong?", "body": "<p>Please repeat all steps:</p>\n\n<pre><code>go get -u github.com/golang/protobuf/protoc-gen-go\nnano ~/.profile\n</code></pre>\n\n<p>check/add to the end (I don't use GOROOT)</p>\n\n<pre><code>export GOPATH=$HOME/go\nexport PATH=$PATH:/usr/local/go/bin:$GOPATH/bin\n</code></pre>\n\n<p>reload profile (for sure)</p>\n\n<pre><code>sudo shutdown -r now\n</code></pre>\n\n<p>try now</p>\n\n<pre><code>protoc --go_out=. *.proto\n</code></pre>\n"}], "owner": {"reputation": 627, "user_id": 6094757, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9ce3b104859784083e933fa62f7f8985?s=128&d=identicon&r=PG&f=1", "display_name": "Deidara", "link": "https://stackoverflow.com/users/6094757/deidara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 40177599, "answer_count": 1, "score": 0, "last_activity_date": 1477055563, "creation_date": 1477013641, "last_edit_date": 1477013772, "question_id": 40166997, "link": "https://stackoverflow.com/questions/40166997/go-protocol-buffer-set-up-wrong", "title": "go protocol buffer set up wrong?", "body": "<p>I am trying to follow the instructions from <a href=\"https://github.com/golang/protobuf\" rel=\"nofollow\">https://github.com/golang/protobuf</a> and \n<a href=\"https://github.com/google/protobuf/releases\" rel=\"nofollow\">https://github.com/google/protobuf/releases</a> to install protocol buffer. After I added the bin path from the download folder to <code>$PATH</code>, I tried to run <code>protoc-gen-go</code>, but it shows <code>-bash: protoc-gen-go: command not found</code></p>\n\n<p>Is there a way to tell if I have install the protobuf correctly?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 2, "creation_date": 1477008174, "post_id": 40165842, "comment_id": 67601286, "body": "You can&#39;t add mismatched types anyway unless you make them the same type before performing the addition. Plus what should the return type be?"}, {"owner": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "reply_to_user": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 3, "creation_date": 1477030957, "post_id": 40165842, "comment_id": 67607306, "body": "Many other languages, e.g. Java, let you add mismatched types. For ints, the return type would be larger of the two ints. For floats + ints, the return type would be float. This is a well established convention."}], "answers": [{"comments": [{"owner": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "edited": false, "score": 1, "creation_date": 1477006943, "post_id": 40166010, "comment_id": 67601018, "body": "The code does not support adding floats and ints, nor does it support adding <code>int8</code> to <code>int16</code>"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "reply_to_user": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "edited": false, "score": 2, "creation_date": 1477019271, "post_id": 40166010, "comment_id": 67603746, "body": "I left you an example with only 2 types, you can use it as model to add or remove the types that you want to"}, {"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "reply_to_user": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "edited": false, "score": 0, "creation_date": 1477049311, "post_id": 40166010, "comment_id": 67618031, "body": "I can&#39;t agree more with @Max here. This solution with type switcher is hard to imagine even for basic numeric types. What do we got is 10 types and 2 arguments, so the total possible number of switch combinations would be 10^2 = 100!"}, {"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477058170, "post_id": 40166010, "comment_id": 67624169, "body": "@JimB I&#39;m afraid you&#39;re mistaken. You don&#39;t use typed values. Please try <code>fmt.Println(f1(int8(1), int16(2))) </code> you&#39;ll get error"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "edited": false, "score": 0, "creation_date": 1477058743, "post_id": 40166010, "comment_id": 67624583, "body": "@MarcelNovy: oops, pasted Yandry&#39;s link, not mine. Well, I said I only spent 2 minutes on it, cut&amp;pasted without [u]int16 cases."}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": false, "score": 4, "last_activity_date": 1504899310, "last_edit_date": 1504899310, "creation_date": 1477005534, "answer_id": 40166010, "question_id": 40165842, "link": "https://stackoverflow.com/questions/40165842/function-that-accepts-all-numeric-types-int-float-and-adds-them/40166010#40166010", "title": "function that accepts all numeric types (int, float, ..) and adds them", "body": "<p>Don't use reflection: <a href=\"http://go-proverbs.github.io\" rel=\"nofollow noreferrer\">Reflection is never clear</a></p>\n\n<p>You have two good options, you can use switch with .(type) or doing an explicit cast to your desire type like a.(int), something like this:</p>\n\n<pre><code>func f1(a interface{}, b interface{}) interface{} {\n\n    switch ta := a.(type) {\n    case int:\n        switch b.(type) {\n        case int:\n            return a.(int) + b.(int)\n        }\n    case float64:\n        switch b.(type) {\n        case float64:\n            return a.(float64) + b.(float64)\n        }\n\n    // you can add all your combinations ... byte, uint, int64, float32 etc. etc.\n\n    default:\n        fmt.Printf(\"unrecognized type '%T'\\n\", ta)\n    }\n\n    return nil // like super zero value of interface{}\n}\n\nfunc f2(a interface{}, b interface{}) interface{} {\n\n    val_a, isAInt := a.(int)\n    if !isAInt {\n        return nil // a is not integer\n    }\n\n    val_b, isBInt := b.(int)\n    if !isBInt {\n        return nil // a is not integer\n    }\n\n    // more cast with different types (uint, floats, etc.)\n\n    return val_a + val_b\n}\n</code></pre>\n\n<p>Full example: <a href=\"https://play.golang.org/p/RCeJikC8py\" rel=\"nofollow noreferrer\">https://play.golang.org/p/RCeJikC8py</a></p>\n"}, {"tags": [], "owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "is_accepted": false, "score": 0, "last_activity_date": 1477016744, "creation_date": 1477016744, "answer_id": 40167398, "question_id": 40165842, "link": "https://stackoverflow.com/questions/40165842/function-that-accepts-all-numeric-types-int-float-and-adds-them/40167398#40167398", "title": "function that accepts all numeric types (int, float, ..) and adds them", "body": "<p>Adds any number of numeric arguments and even strings</p>\n\n<pre><code>func f(things... interface{}) interface{} {\n    var x, y big.Float\n\n    for _, v := range things {\n        if _, _, err := x.Parse(fmt.Sprint(v), 10); err != nil {\n            return nil\n        }\n        y.Add(&amp;y, &amp;x)\n    }\n    return y.String()\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/HqCsy0UaDy\" rel=\"nofollow\">https://play.golang.org/p/HqCsy0UaDy</a></p>\n"}, {"comments": [{"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "edited": false, "score": 0, "creation_date": 1477058961, "post_id": 40178331, "comment_id": 67624745, "body": "that&#39;s what I&#39;ve been talking. Also you have multiple panic errors here like <code>case int64: return int64(x) + int64(y)</code> or uint to int assertion, don&#39;t you find it?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "edited": false, "score": 0, "creation_date": 1477060388, "post_id": 40178331, "comment_id": 67625832, "body": "@MarcelNovy: those won&#39;t panic, they are subject to the same overflow/truncation rules. This could have checks for overflow and such, or you could also just replace all conversions with <code>float64</code>, or even use <code>math&#47;big</code>. Regardless, the problem is very tractable, and doesn&#39;t require formatting and parsing strings."}, {"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "edited": false, "score": 0, "creation_date": 1477061496, "post_id": 40178331, "comment_id": 67626685, "body": "right, it simply produce wrong result, see yourself <code>fmt.Println(add(int(255), ^uint64(0)))</code> . My point is- if you switch to <code>math&#47;big</code> and then convert everything to <code>float64</code>, then how is it different from my solution? Simply replace big.Float.Parse to just few type switchers and get job done in few lines, do you need 2 mins for that?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "edited": false, "score": 0, "creation_date": 1477063557, "post_id": 40178331, "comment_id": 67628092, "body": "@MarcelNovy: that&#39;s the result I&#39;d expect given the types we&#39;re working with; and if you want arbitrary precision math, this could use math/big as well without the string interpolation. What I would not expect is a math function to use reflection, make 15 allocation, and take 10-50x longer to execute. Yes, your way works, I&#39;m just showing a possible example using a type switch (which your example does implicitly though the fmt package)."}, {"owner": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "edited": false, "score": 0, "creation_date": 1477065563, "post_id": 40178331, "comment_id": 67629243, "body": "Hmm this seems very verbose. I guess it is the only way. I&#39;m writing a virtual machine and this code is a little crazy to use for implementing the <code>ADD</code> instruction. More worrisome is that a million comparisons need to happen just to do arithmetic..."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "edited": false, "score": 0, "creation_date": 1477066637, "post_id": 40178331, "comment_id": 67629808, "body": "@Max: the comparisons need to happen at some level, whether you see them in your code or whether they&#39;re done by the compiler. What you can do is limit yourself as much as possible to 2 or 3 primary types to reduce comparisons, i.e. <code>int64</code> <code>float64</code>. For example, Javascript gets by with only <code>float64</code> (though there are sometimes various optimizations going on under the hood), and cpython only uses a few numeric types for most operations, and upgrades numbers to arbitrary precision as needed."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "edited": false, "score": 0, "creation_date": 1477079632, "post_id": 40178331, "comment_id": 67636498, "body": "@Max: I condensed the generated example down to a much smaller version with a via a helper function if it helps."}, {"owner": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "edited": false, "score": 0, "creation_date": 1477091748, "post_id": 40178331, "comment_id": 67640902, "body": "@JimB: Thanks. I&#39;m still trying to figure out exactly what to do. I&#39;m thinking about only allowing additions of the same type and have the <code>ADD</code> instruction take the width as a parameter. Then, an additional instruction <code>RESIZE</code> would be used to resize types so that additions could be carried out on two same sized types."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1477075471, "last_edit_date": 1477075471, "creation_date": 1477057585, "answer_id": 40178331, "question_id": 40165842, "link": "https://stackoverflow.com/questions/40165842/function-that-accepts-all-numeric-types-int-float-and-adds-them/40178331#40178331", "title": "function that accepts all numeric types (int, float, ..) and adds them", "body": "<p>To expand on @YandryPozo's answer, you can generate the combinations once, then you don't need to rely on formatting and parsing strings, or reflection. This will convert any numeric type to <code>int64</code> or <code>float64</code> to be added, returning one of those types. You could go through the individual cases and remove extra type conversions to only convert to the minimum common base which would be even more efficient, but then any type could be returned and you would have to type-switch all possible types on the return. You could even add <code>string</code> cases in there if you wanted to parse strings.</p>\n\n<p><a href=\"https://play.golang.org/p/e_4IMlsSR0\" rel=\"nofollow\">https://play.golang.org/p/e_4IMlsSR0</a> (or expanded out <a href=\"https://play.golang.org/p/M2niXz2It_\" rel=\"nofollow\">https://play.golang.org/p/M2niXz2It_</a>)</p>\n\n<pre><code>func add(x, y interface{}) interface{} {\n    switch x := get64(x).(type) {\n    case int64:\n        switch y := get64(y).(type) {\n        case int64:\n            return x + y\n        case float64:\n            return float64(x) + y\n        }\n    case float64:\n        switch y := get64(y).(type) {\n        case int64:\n            return x + float64(y)\n        case float64:\n            return x + y\n        }\n    }\n\n    panic(\"invlaid input\")\n}\n\nfunc get64(x interface{}) interface{} {\n    switch x := x.(type) {\n    case uint8:\n        return int64(x)\n    case int8:\n        return int64(x)\n    case uint16:\n        return int64(x)\n    case int16:\n        return int64(x)\n    case uint32:\n        return int64(x)\n    case int32:\n        return int64(x)\n    case uint64:\n        return int64(x)\n    case int64:\n        return int64(x)\n    case int:\n        return int64(x)\n    case float32:\n        return float64(x)\n    case float64:\n        return float64(x)\n    }\n    panic(\"invalid input\")\n}\n</code></pre>\n\n<p>If you want arbitrary precision for any arguments, without overflow or truncations, you could convert all arguments to <code>math/big</code> types. This example converts everything to a <code>big.Float</code> with a single type switch, and you could expand this like above to combine <code>big.Int</code> and <code>big.Float</code>. </p>\n\n<pre><code>func addBig(nums ...interface{}) *big.Float {\n    var total big.Float\n    for _, n := range nums {\n        total.Add(&amp;total, getFloat(n))\n    }\n    return &amp;total\n}\n\nfunc getFloat(i interface{}) *big.Float {\n    var f big.Float\n    switch i := i.(type) {\n    case uint8:\n        f.SetInt64(int64(i))\n    case int8:\n        f.SetInt64(int64(i))\n    case uint32:\n        f.SetInt64(int64(i))\n    case int32:\n        f.SetInt64(int64(i))\n    case uint64:\n        f.SetUint64(i)\n    case int64:\n        f.SetInt64(i)\n    case int:\n        f.SetInt64(int64(i))\n    case float32:\n        f.SetFloat64(float64(i))\n    case float64:\n        f.SetFloat64(float64(i))\n    }\n    return &amp;f\n}\n</code></pre>\n"}], "owner": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2156, "favorite_count": 0, "accepted_answer_id": 40178331, "answer_count": 3, "score": 1, "last_activity_date": 1504899310, "creation_date": 1477004509, "last_edit_date": 1477052904, "question_id": 40165842, "link": "https://stackoverflow.com/questions/40165842/function-that-accepts-all-numeric-types-int-float-and-adds-them", "title": "function that accepts all numeric types (int, float, ..) and adds them", "body": "<p>I would like to write a function that accepts two arguments of type <code>int</code>, <code>int8</code>, <code>int16</code>, ..., <code>float</code>, and <code>float64</code>. The type of arguments doesn't have to match. This function should take two arguments and add them. What is a good way to do this?</p>\n\n<p>Essentially I want something like this:</p>\n\n<pre><code>func f(a interface{}, b interface{}) interface{} {\n    return a + b\n}\n\nf(int8(1), int16(2))    // 3\nf(float64(2.2), int(1)) // 3.2\n</code></pre>\n\n<p>Is there a way to do this in Go? I'm open to using reflection, but would also like to see ways without reflection if possible. </p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 824, "user_id": 941163, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/aR3zU.png?s=128&g=1", "display_name": "bitsofinfo", "link": "https://stackoverflow.com/users/941163/bitsofinfo"}, "edited": false, "score": 1, "creation_date": 1477058901, "post_id": 40170999, "comment_id": 67624691, "body": "Thanks, the problem is that I don&#39;t have access to the go code that is processing the template: (i&#39;m using consul-template)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 12, "last_activity_date": 1477035721, "creation_date": 1477035721, "answer_id": 40170999, "question_id": 40164896, "link": "https://stackoverflow.com/questions/40164896/capture-or-assign-golang-template-output-to-variable/40170999#40170999", "title": "Capture or assign golang template output to variable", "body": "<p>There is no \"builtin\" action for getting the result of a template execution, but you may do it by registering a function which does that.</p>\n\n<p>You can register functions with the <a href=\"https://golang.org/pkg/text/template/#Template.Funcs\" rel=\"noreferrer\"><code>Template.Funcs()</code></a> function, you may execute a named template with <a href=\"https://golang.org/pkg/text/template/#Template.ExecuteTemplate\" rel=\"noreferrer\"><code>Template.ExecuteTemplate()</code></a> and you may use a <a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"noreferrer\"><code>bytes.Buffer</code></a> as the target (direct template execution result into a buffer).</p>\n\n<p>Here is a complete example:</p>\n\n<pre><code>var t *template.Template\n\nfunc execTempl(name string) (string, error) {\n    buf := &amp;bytes.Buffer{}\n    err := t.ExecuteTemplate(buf, name, nil)\n    return buf.String(), err\n}\n\nfunc main() {\n    t = template.Must(template.New(\"\").Funcs(template.FuncMap{\n        \"execTempl\": execTempl,\n    }).Parse(tmpl))\n    if err := t.Execute(os.Stdout, nil); err != nil {\n        panic(err)\n    }\n}\n\nconst tmpl = `{{define \"my-template\"}}my-template content{{end}}\nSee result:\n{{$var := execTempl \"my-template\"}}\n{{$var}}\n`\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/ccN3Zb8WdM\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>See result:\n\nmy-template content\n</code></pre>\n\n<p>The <code>\"my-template\"</code> template is executed by the registered function <code>execTempl()</code>, and the result is returned as a <code>string</code>, which is stored in the <code>$var</code> template variable, which then is simply added to the output, but you may use it to pass to other functions if you want to.</p>\n"}], "owner": {"reputation": 824, "user_id": 941163, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/aR3zU.png?s=128&g=1", "display_name": "bitsofinfo", "link": "https://stackoverflow.com/users/941163/bitsofinfo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6815, "favorite_count": 0, "answer_count": 1, "score": 9, "last_activity_date": 1477035836, "creation_date": 1476999069, "last_edit_date": 1477035836, "question_id": 40164896, "link": "https://stackoverflow.com/questions/40164896/capture-or-assign-golang-template-output-to-variable", "title": "Capture or assign golang template output to variable", "body": "<p>Within a template, how can I achieve this?</p>\n\n<pre><code>{{$var := template \"my-template\"}}\n</code></pre>\n\n<p>I just get <code>\"unexpected &lt;template&gt; in operand\"</code>.</p>\n"}]