[{"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1541029876, "post_id": 53093089, "comment_id": 93083619, "body": "The function InitInputChannel uses a <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">short variable declaration</a> to assign a channel to a local variable.  It looks like you were expecting to set the package-level variable instead. If so, use simple assignment instead of short variable declaration."}, {"owner": {"reputation": 9, "user_id": 3761289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/343f73119fac49a32c756d19d71303aa?s=128&d=identicon&r=PG&f=1", "display_name": "user3761289", "link": "https://stackoverflow.com/users/3761289/user3761289"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1541031519, "post_id": 53093089, "comment_id": 93083972, "body": "@ThunderCat Ahhhhh I can&#39;t believe it was so simple. Well this is at least a lesson I won&#39;t forget."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 3761289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/343f73119fac49a32c756d19d71303aa?s=128&d=identicon&r=PG&f=1", "display_name": "user3761289", "link": "https://stackoverflow.com/users/3761289/user3761289"}, "is_accepted": false, "score": 1, "last_activity_date": 1541031764, "creation_date": 1541031764, "answer_id": 53093642, "question_id": 53093089, "link": "https://stackoverflow.com/questions/53093089/initializing-channel-in-function-causing-go-routine-deadlock/53093642#53093642", "title": "Initializing channel in function causing go routine deadlock", "body": "<p>As ThunderCat mentioned in the comments on my question, I was using the incorrect form of variable declaration. So I should have done something like this:</p>\n\n<pre><code>package input\n\nconst UP = 1\nconst RIGHT = 2\nconst DOWN = 3\nconst LEFT = 4\n\nvar inputChannel chan int\n\ntype InputReader interface {\n    ReadNextInt() int\n}\n\nfunc InitChan() chan int {\n  inputChannel = make(chan int, 1)\n  return inputChannel\n}\n\nfunc SendInput(inputReader InputReader) {\n    inputChannel &lt;- inputReader.ReadNextInt()\n}\n</code></pre>\n\n<p>The key to notice is the '<strong><em>inputChannel = make(.....)</em></strong>' rather than '<strong><em>inputChannel := make(....)</em></strong>' like I was trying before.</p>\n"}], "owner": {"reputation": 9, "user_id": 3761289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/343f73119fac49a32c756d19d71303aa?s=128&d=identicon&r=PG&f=1", "display_name": "user3761289", "link": "https://stackoverflow.com/users/3761289/user3761289"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1541031764, "creation_date": 1541026895, "question_id": 53093089, "link": "https://stackoverflow.com/questions/53093089/initializing-channel-in-function-causing-go-routine-deadlock", "title": "Initializing channel in function causing go routine deadlock", "body": "<p>I am new to Go so I'm sure this is something simple I am missing. I am trying to initialize a channel to capture user input from another function. I tried the following:</p>\n\n<pre><code>package input\n\nconst UP = 1\nconst RIGHT = 2\nconst DOWN =3\nconst LEFT = 4\n\nvar inputChannel chan int\n\ntype InputReader interface {\n  ReadNextInt() int\n}\n\nfunc InitInputChannel() chan int {\n  inputChannel := make(chan int, 1)\n  return inputChannel\n}\n\nfunc SendInput(inputReader InputReader) {\n    inputChannel &lt;- inputReader.ReadNextInt()\n}\n</code></pre>\n\n<p>I then called the code with the following:</p>\n\n<pre><code>package input\n\nimport (\n  \"testing\"\n  \"github.com/stretchr/testify/assert\"\n  \"github.com/stretchr/testify/mock\"\n)\n\ntype MockedInputReader struct {\n  mock.Mock\n}\n\nfunc (reader MockedInputReader) ReadNextInt() int {\n  return 1\n}\n\nfunc TestShouldSendUpValueToChannelWhenUpKeyPressed(t *testing.T) {\n  inputReader := new(MockedInputReader)\n  inputReader.On(\"ReadNextInt\").Return(UP)\n\n  receiverChannel := SendInput(inputReader)\n\n  actualInput := &lt;- receiverChannel\n  assert.Equal(t, UP, actualInput)\n}\n</code></pre>\n\n<p>Looking at the code I just couldn't figure out the issue so I decided to restructure some things since I was getting desperate. I ended up with the following which worked:</p>\n\n<pre><code>package input\n\nconst UP = 1\nconst RIGHT = 2\nconst DOWN =3\nconst LEFT = 4\n\nvar inputChannel chan int = make(chan int, 1)\n\ntype InputReader interface {\n  ReadNextInt() int\n}\n\nfunc SendInput(inputReader InputReader) chan int {\n    inputChannel &lt;- inputReader.ReadNextInt()\n    return inputChannel\n}\n</code></pre>\n\n<p>While I am glad that I got it working I am confused why my first solution didn't work. I am also not really crazy about returning my channel for every single SendInput call when it only needs grabbed once. Maybe a 'InputChannel() chan int' getter would be better? Any insight?  Thanks</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1541027011, "post_id": 53093087, "comment_id": 93082920, "body": "Sure -- and that&#39;d work in Python. How would you approach this in Golang? The two approaches aren&#39;t that different"}, {"owner": {"reputation": 1158, "user_id": 6117625, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cff13813080b5f227531191b1dc96b60?s=128&d=identicon&r=PG&f=1", "display_name": "Dean coakley", "link": "https://stackoverflow.com/users/6117625/dean-coakley"}, "edited": false, "score": 0, "creation_date": 1541031309, "post_id": 53093087, "comment_id": 93083929, "body": "Can you post your attempt or say what part in particular you are confused about?"}, {"owner": {"reputation": 1, "user_id": 10588433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7cf2fb6a573f28ee8e729d0b79d2b72?s=128&d=identicon&r=PG&f=1", "display_name": "hallowedtrooper", "link": "https://stackoverflow.com/users/10588433/hallowedtrooper"}, "edited": false, "score": 0, "creation_date": 1541455111, "post_id": 53093087, "comment_id": 93216074, "body": "Sorry for the late reply.  The responses by xspare and myxaxa were very helpful to answer my question.  Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 2, "last_activity_date": 1541042844, "creation_date": 1541042844, "answer_id": 53094841, "question_id": 53093087, "link": "https://stackoverflow.com/questions/53093087/golang-simple-user-input-product-math-question-like-321-6/53094841#53094841", "title": "Golang Simple User Input Product Math Question like 3*2*1 = 6", "body": "<p>You need to learn about the go language itself first, after that you'll be able to convert your python code into go, <em>easily</em>.</p>\n\n<p>Few go learning resources:</p>\n\n<ul>\n<li><a href=\"https://tour.golang.org\" rel=\"nofollow noreferrer\">https://tour.golang.org</a></li>\n<li><a href=\"https://gobyexample.com\" rel=\"nofollow noreferrer\">https://gobyexample.com</a></li>\n<li><a href=\"https://golang.org/doc\" rel=\"nofollow noreferrer\">https://golang.org/doc</a></li>\n</ul>\n\n<hr>\n\n<p>But anyway, here is the go version of your python code:</p>\n\n<pre><code>func a(num int) int {\n    x := 1\n    for i := 0; i &lt; num; i++ {\n        x = x * (i + 1)\n    }\n    return x\n}\n\nfunc main() {\n    fmt.Println(a(5)) // 120\n    fmt.Println(a(4)) // 24\n    fmt.Println(a(3)) // 6\n}\n</code></pre>\n\n<p>Working playground: <a href=\"https://play.golang.org/p/glHwuMhTDYj\" rel=\"nofollow noreferrer\">https://play.golang.org/p/glHwuMhTDYj</a></p>\n"}, {"tags": [], "owner": {"reputation": 1263, "user_id": 7099984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb73d10a9ce4b91379b514722601f9ee?s=128&d=identicon&r=PG&f=1", "display_name": "myxaxa", "link": "https://stackoverflow.com/users/7099984/myxaxa"}, "is_accepted": false, "score": 0, "last_activity_date": 1541068923, "creation_date": 1541068923, "answer_id": 53099630, "question_id": 53093087, "link": "https://stackoverflow.com/questions/53093087/golang-simple-user-input-product-math-question-like-321-6/53099630#53099630", "title": "Golang Simple User Input Product Math Question like 3*2*1 = 6", "body": "<p>the main function taken from previous answer - only the scanf added here as you requested</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc a(num int) int {\n    x := 1\n    for i := 0; i &lt; num; i++ {\n        x = x * (i + 1)\n    }\n    return x\n}\n\nfunc main() {\n    var i int\n    _, err := fmt.Scanf(\"%d\", &amp;i)\n    if nil == err {\n        fmt.Println(a(i))\n    } else {\n        panic(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10588433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7cf2fb6a573f28ee8e729d0b79d2b72?s=128&d=identicon&r=PG&f=1", "display_name": "hallowedtrooper", "link": "https://stackoverflow.com/users/10588433/hallowedtrooper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1541068923, "creation_date": 1541026888, "question_id": 53093087, "link": "https://stackoverflow.com/questions/53093087/golang-simple-user-input-product-math-question-like-321-6", "title": "Golang Simple User Input Product Math Question like 3*2*1 = 6", "body": "<p>I'm trying to create a small program that allows a user to input an integer which will output the product such as follows: </p>\n\n<p>For example: </p>\n\n<pre><code>a = 5, 5*4*3*2 = 120\na = 4, 4*3*2*1 = 24  \na = 3, 3*2*1 = 6\n</code></pre>\n\n<p>Can someone provide guidance as I'm stuck on how to frame this more efficiently.  If using Python, I would probably write the logic something like: </p>\n\n<pre><code>def a(num):\n    x = 1\n    for i in range (num):\n            x=x*(i + 1)\n    return x\n\nprint a(5)\n</code></pre>\n"}, {"tags": ["dictionary", "go", "dry"], "comments": [{"owner": {"reputation": 1158, "user_id": 6117625, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cff13813080b5f227531191b1dc96b60?s=128&d=identicon&r=PG&f=1", "display_name": "Dean coakley", "link": "https://stackoverflow.com/users/6117625/dean-coakley"}, "edited": false, "score": 0, "creation_date": 1541031179, "post_id": 53092117, "comment_id": 93083889, "body": "In Go it is considered fine to repeat yourself in this way as far as I know"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1541047832, "post_id": 53092117, "comment_id": 93087017, "body": "Those functions are &quot;DRY&quot; already."}, {"owner": {"reputation": 2304, "user_id": 2126889, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ZLkKF.jpg?s=128&g=1", "display_name": "timthelion", "link": "https://stackoverflow.com/users/2126889/timthelion"}, "edited": false, "score": 0, "creation_date": 1541050081, "post_id": 53092117, "comment_id": 93087476, "body": "Are you guys trolling?"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1541059219, "post_id": 53092117, "comment_id": 93090446, "body": "no they are not, there good are reasons about that. However you can still use reflection to achieve dryness. You can search for something similar to this <a href=\"https://github.com/clementauger/st\" rel=\"nofollow noreferrer\">github.com/clementauger/st</a>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1541021896, "creation_date": 1541021896, "answer_id": 53092314, "question_id": 53092117, "link": "https://stackoverflow.com/questions/53092117/how-can-i-write-dry-golang-map-manipulation-functions/53092314#53092314", "title": "How can I write DRY golang map manipulation functions", "body": "<p>You can't \"dry\" that in a way that will be close in performance. You could use reflection, but the resulting code will be drastically slower.</p>\n\n<p>What to do? Until generics arrive (maybe in Go 2?), you may keep creating such functions for all required types, or just use the <code>for</code> loop where it's needed. It's just 3 lines of code including the loop and brackets...</p>\n"}], "owner": {"reputation": 2304, "user_id": 2126889, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ZLkKF.jpg?s=128&g=1", "display_name": "timthelion", "link": "https://stackoverflow.com/users/2126889/timthelion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1541024542, "creation_date": 1541020834, "last_edit_date": 1541024542, "question_id": 53092117, "link": "https://stackoverflow.com/questions/53092117/how-can-i-write-dry-golang-map-manipulation-functions", "title": "How can I write DRY golang map manipulation functions", "body": "<p>As far as I know, golang has no type variables. So how can I DRY out these two functions?</p>\n\n<pre><code>func merge_modes32(nm map[uint32]pb.Mode, om map[uint32]pb.Mode) {\n    for k, v := range nm {\n        om[k] = v\n    }\n}\n\nfunc merge_modes64(nm map[uint64]pb.Mode, om map[uint64]pb.Mode) {\n    for k, v := range nm {\n        om[k] = v\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "concurrency", "channel"], "answers": [{"tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": true, "score": 4, "last_activity_date": 1541020804, "creation_date": 1541020804, "answer_id": 53092112, "question_id": 53091753, "link": "https://stackoverflow.com/questions/53091753/could-someone-explain-this-block-of-go-code-that-uses-channels-i-dont-understa/53092112#53092112", "title": "Could someone explain this block of Go code that uses channels? I don&#39;t understand how it&#39;s doing 500 actions at a time", "body": "<p>It isn\u2019t 500, it is 200, and the magic line is:</p>\n\n<pre><code>for i := 0; i &lt; max; i++ {\n    go worker(t, reqChan, respChan)\n}\n</code></pre>\n\n<p>max defaults to 200; and may be over ridden with a command line switch.\nEach of these \u201cgo routines\u201d, which are akin to ridiculously lightweight threads, initializes itself then waits for channel input.   This is where the magic occurs - when a request comes in, it results in sending on a channel.   There are max (200) go-routines receiving from this channel, and the channel is unbuffered, therefore up to 200 requests can be inflight.   The 201th would cause the sender to wait until one of the workers completed and invoked the receive (&lt;-) op.</p>\n\n<p>The subtlety of Go\u2019s message passing deserves far better, and a bit of googling around will uncover well written essays, tutorials and examples of concurrency in Go.</p>\n\n<p>Good luck with Go; I think it is a wonderful language.  It is elegant, expressive and concise.   You might never be able to stomach c++ or java again....</p>\n"}], "owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 53092112, "answer_count": 1, "score": -2, "last_activity_date": 1541020804, "creation_date": 1541018926, "question_id": 53091753, "link": "https://stackoverflow.com/questions/53091753/could-someone-explain-this-block-of-go-code-that-uses-channels-i-dont-understa", "title": "Could someone explain this block of Go code that uses channels? I don&#39;t understand how it&#39;s doing 500 actions at a time", "body": "<p>I was looking up knowledge on how to perform a lot of HTTP requests efficiently, and I came across this answer: <a href=\"https://stackoverflow.com/a/23319730/749851\">https://stackoverflow.com/a/23319730/749851</a> with this code:</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"runtime\"\n    \"time\"\n)\n\nvar (\n    reqs int\n    max  int\n)\n\nfunc init() {\n    flag.IntVar(&amp;reqs, \"reqs\", 1000000, \"Total requests\")\n    flag.IntVar(&amp;max, \"concurrent\", 200, \"Maximum concurrent requests\")\n}\n\ntype Response struct {\n    *http.Response\n    err error\n}\n\n// Dispatcher\nfunc dispatcher(reqChan chan *http.Request) {\n    defer close(reqChan)\n    for i := 0; i &lt; reqs; i++ {\n        req, err := http.NewRequest(\"GET\", \"http://localhost/\", nil)\n        if err != nil {\n            log.Println(err)\n        }\n        reqChan &lt;- req\n    }\n}\n\n// Worker Pool\nfunc workerPool(reqChan chan *http.Request, respChan chan Response) {\n    t := &amp;http.Transport{}\n    for i := 0; i &lt; max; i++ {\n        go worker(t, reqChan, respChan)\n    }\n}\n\n// Worker\nfunc worker(t *http.Transport, reqChan chan *http.Request, respChan chan Response) {\n    for req := range reqChan {\n        resp, err := t.RoundTrip(req)\n        r := Response{resp, err}\n        respChan &lt;- r\n    }\n}\n\n// Consumer\nfunc consumer(respChan chan Response) (int64, int64) {\n    var (\n        conns int64\n        size  int64\n    )\n    for conns &lt; int64(reqs) {\n        select {\n        case r, ok := &lt;-respChan:\n            if ok {\n                if r.err != nil {\n                    log.Println(r.err)\n                } else {\n                    size += r.ContentLength\n                    if err := r.Body.Close(); err != nil {\n                        log.Println(r.err)\n                    }\n                }\n                conns++\n            }\n        }\n    }\n    return conns, size\n}\n\nfunc main() {\n    flag.Parse()\n    runtime.GOMAXPROCS(runtime.NumCPU())\n    reqChan := make(chan *http.Request)\n    respChan := make(chan Response)\n    start := time.Now()\n    go dispatcher(reqChan)\n    go workerPool(reqChan, respChan)\n    conns, size := consumer(respChan)\n    took := time.Since(start)\n    ns := took.Nanoseconds()\n    av := ns / conns\n    average, err := time.ParseDuration(fmt.Sprintf(\"%d\", av) + \"ns\")\n    if err != nil {\n        log.Println(err)\n    }\n    fmt.Printf(\"Connections:\\t%d\\nConcurrent:\\t%d\\nTotal size:\\t%d bytes\\nTotal time:\\t%s\\nAverage time:\\t%s\\n\", conns, max, size, took, average)\n}\n</code></pre>\n\n<p>I'm coming from node so I don't really understand this \"go\" code.</p>\n\n<p>What part of it is limiting it to 500 HTTP actions at a time? And is it operating in chunks of 500, waiting until that chunk of 500 is finished then starting a new 500, OR is it just always chugging along adding 1 more once it hits 499, etc.</p>\n\n<p>I see that the \"workerPool\" func goes over a loop only as many times as the maximum amount of concurrent requests, calling \"worker\" 500 times, but how does it do the next 500 or even the whole 1 million eventually?</p>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1541017895, "post_id": 53091082, "comment_id": 93079902, "body": "It&#39;s unclear what you want to do. What do you want to mock? <code>mStruct.function1()</code> returns <code>true</code> in your code. You want it to return <code>false</code> during the test?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4445419"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1541018009, "post_id": 53091082, "comment_id": 93079943, "body": "@icza - I want to test function <code>callSomething</code> with different implementations for <code>function1</code> sometime with true and sometime with false"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4445419"}, "edited": false, "score": 0, "creation_date": 1541018767, "post_id": 53091649, "comment_id": 93080207, "body": "Thanks, sorry what is <code>mockedVInterface</code> and where should I put it in the tests ? if so can you provide the full code ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1541018825, "post_id": 53091649, "comment_id": 93080225, "body": "<code>mockedVInterface</code> is a new type created solely for testing purposes. You may simply put it in the same test file where you have <code>Test_callSomething()</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4445419"}, "edited": false, "score": 0, "creation_date": 1541018984, "post_id": 53091649, "comment_id": 93080291, "body": "ok I put it inside the test function but I got error for function <code>func (m mockedVInterface) function1() bool {     return m.value }</code>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1541019012, "post_id": 53091649, "comment_id": 93080302, "body": "@JhonD You can&#39;t put it <i>inside</i> a function, put it <i>before</i> the function. You can&#39;t define methods inside a function."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4445419"}, "edited": false, "score": 0, "creation_date": 1541019154, "post_id": 53091649, "comment_id": 93080363, "body": "thanks, 1+ , can you please explain why you use mock interface instead of mock function ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1541019264, "post_id": 53091649, "comment_id": 93080416, "body": "@JhonD Because as you said, you want to test <code>callSomething()</code>, and this function takes (requires) a value of interface type <code>vInterface</code>. So you must have a mocked implementation of this interface. You can&#39;t pass a function value to <code>callSomething()</code>, it expects an interface value, so you have to give it that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4445419"}, "edited": false, "score": 0, "creation_date": 1541019347, "post_id": 53091649, "comment_id": 93080447, "body": "in this way we can achieve the dependency injection like ?does it better approach for testing ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1541019476, "post_id": 53091649, "comment_id": 93080497, "body": "@JhonD I&#39;m not sure what you&#39;re asking, but yes, using interfaces is one way to handle different implementations of some abstraction the same way."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4445419"}, "edited": false, "score": 0, "creation_date": 1541019551, "post_id": 53091649, "comment_id": 93080522, "body": "I mean something like this ? <a href=\"https://appliedgo.net/di/\" rel=\"nofollow noreferrer\">appliedgo.net/di</a> ? this is not the same approach ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1541020074, "post_id": 53091649, "comment_id": 93080715, "body": "@JhonD I&#39;m sorry, I do not intend to go through that article, therefore cannot answer your question with certainty."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4445419"}, "edited": false, "score": 0, "creation_date": 1541020280, "post_id": 53091649, "comment_id": 93080786, "body": "Sure np, you said that we can use the interface if we only have 1 method, can you please provide example if we have more then one method ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1541020605, "post_id": 53091649, "comment_id": 93080900, "body": "@JhonD The first solution using a struct to mock the implementation is a general one, you can use that with interfaces having arbitrary number of methods. The second, more specialized solution is what can only be used with a single method with single return value, as the mocking type is just a single boolean value (which can&#39;t &quot;encode&quot; multiple return values)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4445419"}, "edited": false, "score": 0, "creation_date": 1541062641, "post_id": 53091649, "comment_id": 93091810, "body": "Sorry last question which is a bit tricky in this context ... is it possible to call to function <code>vl1</code> with mock to the function  <code>function1</code> ? please see my update . hope you can help"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4445419"}, "edited": false, "score": 0, "creation_date": 1541063446, "post_id": 53091649, "comment_id": 93092159, "body": "should I open new question ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4445419"}, "edited": false, "score": 0, "creation_date": 1541064151, "post_id": 53091649, "comment_id": 93092453, "body": "I close this question, it will be great if you can have a look at this . <a href=\"https://stackoverflow.com/questions/53098327/mock-inner-function-in-golang\" title=\"mock inner function in golang\">stackoverflow.com/questions/53098327/&hellip;</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1541019177, "last_edit_date": 1541019177, "creation_date": 1541018467, "answer_id": 53091649, "question_id": 53091082, "link": "https://stackoverflow.com/questions/53091082/how-to-use-function-interface-with-diff-implementation/53091649#53091649", "title": "How to use function interface with diff implementation", "body": "<p>First you need a type (any type) that implements the <code>vInterface</code> interface. Here's a simple example:</p>\n\n<pre><code>type mockedVInterface struct {\n    value bool\n}\n\nfunc (m mockedVInterface) function1() bool {\n    return m.value\n}\n</code></pre>\n\n<p>This is a simple enough implementation which we can control: we can tell what its <code>function1()</code> function should return by simply setting that value to its <code>value</code> field.</p>\n\n<p>This <code>mockedVInterface</code> type is created solely for testing purposes, the production code does not need it. Put it in the same file where you have the test code (put it before <code>Test_callSomething()</code>).</p>\n\n<p>And here's the testing code:</p>\n\n<pre><code>func Test_callSomething(t *testing.T) {\n    type args struct {\n        si vInterface\n    }\n    tests := []struct {\n        name string\n        args args\n        want bool\n    }{\n        {\n            name: \"testing false\",\n            args: args{\n                si: mockedVInterface{value: false},\n            },\n            want: false,\n        },\n        {\n            name: \"testing true\",\n            args: args{\n                si: mockedVInterface{value: true},\n            },\n            want: true,\n        },\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            if got := callSomething(tt.args.si); got != tt.want {\n                t.Errorf(\"callSomething() = %v, want %v\", got, tt.want)\n            }\n        })\n    }\n}\n</code></pre>\n\n<p>Note that in this simple case we could also use a simple non-struct type that has <code>bool</code> as its underlying type like this:</p>\n\n<pre><code>type mockedVInterface bool\n\nfunc (m mockedVInterface) function1() bool {\n    return bool(m)\n}\n</code></pre>\n\n<p>And it works and testing code is also simpler:</p>\n\n<pre><code>tests := []struct {\n        name string\n        args args\n        want bool\n    }{\n        {\n            name: \"testing false\",\n            args: args{\n                si: mockedVInterface(false),\n            },\n            want: false,\n        },\n        {\n            name: \"testing true\",\n            args: args{\n                si: mockedVInterface(true),\n            },\n            want: true,\n        },\n    }\n</code></pre>\n\n<p>But this only works if the mockable interface has a single function with a single return value. In the general case a struct is needed.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4445419"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 53091649, "answer_count": 1, "score": 3, "last_activity_date": 1541063239, "creation_date": 1541015948, "last_edit_date": 1541063239, "question_id": 53091082, "link": "https://stackoverflow.com/questions/53091082/how-to-use-function-interface-with-diff-implementation", "title": "How to use function interface with diff implementation", "body": "<p>Im using <code>interface</code> which I want to <strong>mock</strong> one method in it  <code>function1</code> in test and I wasn't able to figure it out how is the best to do it that for prod code it will provide 1 value and for test provide some mock value , can someone please give example ? (edited)\nthis is the code: </p>\n\n<p><a href=\"https://play.golang.org/p/w367IOjADFV\" rel=\"nofollow noreferrer\">https://play.golang.org/p/w367IOjADFV</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype vInterface interface {\n    function1() bool\n}\n\ntype mStruct struct {\n    info string\n    time time.Time\n}\n\nfunc (s *mStruct) function1() bool {\n    return true\n}\n\nfunc callSomething(si vInterface) bool {\n    return si.function1()\n}\n\nfunc (s *mStruct) vl1() bool {\n    s.time = time.Now()\n    s.info = \"vl1-&gt;info\"\n    return callSomething(s)\n}\n\nvar currentVt1 mStruct\n\nfunc main() {\n    vl1 := currentVt1.vl1()\n\n    fmt.Println(vl1)\n}\n</code></pre>\n\n<p><strong>The test is like this</strong></p>\n\n<pre><code>func Test_callSomething(t *testing.T) {\n    type args struct {\n        si vInterface\n    }\n    tests := []struct {\n        name string\n        args args\n        want bool\n    }{\n        {\n            name: \"my tests\",\n            args: args{\n\n            },\n            want: false,\n        },\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            if got := callSomething(tt.args.si); got != tt.want {\n                t.Errorf(\"callSomething() = %v, want %v\", got, tt.want)\n            }\n        })\n    }\n}\n</code></pre>\n\n<p>But not sure how to mock it right ...</p>\n\n<p><strong>update</strong></p>\n\n<pre><code>func Test_mStruct_vl1(t *testing.T) {\n    type fields struct {\n        info string\n        time time.Time\n    }\n    tests := []struct {\n        name   string\n        fields fields\n        want   bool\n    }{\n        {\n            name: \"some test\",\n            fields: struct {\n                info string\n                time time.Time\n            }{info: \"myinfo\", time: time.Now() },\n\n        },\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            s := &amp;mStruct{\n                info: tt.fields.info,\n                time: tt.fields.time,\n            }\n            if got := s.vl1(); got != tt.want {\n                t.Errorf(\"vl1() = %v, want %v\", got, tt.want)\n            }\n        })\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1541011518, "post_id": 53089983, "comment_id": 93077146, "body": "It looks like your posted code is the mock, so it&#39;s not really clear what your question is about it."}, {"owner": {"reputation": 5073, "user_id": 1365697, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cb3baa9178e40e8d47248ac73c4a24e?s=128&d=identicon&r=PG", "display_name": "user1365697", "link": "https://stackoverflow.com/users/1365697/user1365697"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1541011610, "post_id": 53089983, "comment_id": 93077193, "body": "I want to do mock for this function doLoginAndReadDestinations1 in the test How I can do it ?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1541011976, "post_id": 53089983, "comment_id": 93077342, "body": "Is the one posted not a mock? The one that&#39;s just <code>return true</code>?"}, {"owner": {"reputation": 5073, "user_id": 1365697, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cb3baa9178e40e8d47248ac73c4a24e?s=128&d=identicon&r=PG", "display_name": "user1365697", "link": "https://stackoverflow.com/users/1365697/user1365697"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1541012191, "post_id": 53089983, "comment_id": 93077422, "body": "it is just an example the idea that there is any logic there , I will update it"}, {"owner": {"reputation": 5073, "user_id": 1365697, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cb3baa9178e40e8d47248ac73c4a24e?s=128&d=identicon&r=PG", "display_name": "user1365697", "link": "https://stackoverflow.com/users/1365697/user1365697"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1541012381, "post_id": 53089983, "comment_id": 93077501, "body": "The verifyLogin on Session is called to doLoginAndReadDestinations1 that have complex logic with HTTP call and more logic and I in my test I just want that this method will return true,"}], "answers": [{"comments": [{"owner": {"reputation": 5073, "user_id": 1365697, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cb3baa9178e40e8d47248ac73c4a24e?s=128&d=identicon&r=PG", "display_name": "user1365697", "link": "https://stackoverflow.com/users/1365697/user1365697"}, "edited": false, "score": 0, "creation_date": 1541012903, "post_id": 53090301, "comment_id": 93077710, "body": "The idea that Call to method verifyLogin that call to callDest1 that it is interface of doLoginAndReadDestinations1 I want to mock this function and not to call to the real one. do I need to change the real code ? if yes how ?"}, {"owner": {"reputation": 5073, "user_id": 1365697, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cb3baa9178e40e8d47248ac73c4a24e?s=128&d=identicon&r=PG", "display_name": "user1365697", "link": "https://stackoverflow.com/users/1365697/user1365697"}, "edited": false, "score": 0, "creation_date": 1541012947, "post_id": 53090301, "comment_id": 93077729, "body": "My problem that I want to write test that will not do the logic of doLoginAndReadDestinations1 in the verifyLogin  test"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 5073, "user_id": 1365697, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cb3baa9178e40e8d47248ac73c4a24e?s=128&d=identicon&r=PG", "display_name": "user1365697", "link": "https://stackoverflow.com/users/1365697/user1365697"}, "edited": false, "score": 0, "creation_date": 1541014206, "post_id": 53090301, "comment_id": 93078285, "body": "Again, <i>you cannot mock a method, you can only mock a type</i>. If you want to mock only that function, you need to move it to a new type, create an interface, add a field to the original type, and fill that new field with your mock implementation in your tests and the real implementation in your production code."}, {"owner": {"reputation": 5073, "user_id": 1365697, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cb3baa9178e40e8d47248ac73c4a24e?s=128&d=identicon&r=PG", "display_name": "user1365697", "link": "https://stackoverflow.com/users/1365697/user1365697"}, "edited": false, "score": 0, "creation_date": 1541014659, "post_id": 53090301, "comment_id": 93078511, "body": "sorry I am not expert in this could you give me an example How I need to do it ?"}, {"owner": {"reputation": 5073, "user_id": 1365697, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cb3baa9178e40e8d47248ac73c4a24e?s=128&d=identicon&r=PG", "display_name": "user1365697", "link": "https://stackoverflow.com/users/1365697/user1365697"}, "edited": false, "score": 0, "creation_date": 1541014681, "post_id": 53090301, "comment_id": 93078527, "body": "could we have a short chat ?"}, {"owner": {"reputation": 5073, "user_id": 1365697, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cb3baa9178e40e8d47248ac73c4a24e?s=128&d=identicon&r=PG", "display_name": "user1365697", "link": "https://stackoverflow.com/users/1365697/user1365697"}, "edited": false, "score": 0, "creation_date": 1541016656, "post_id": 53090301, "comment_id": 93079471, "body": "type SessionInterface1 interface { \tdoLoginAndReadDestinations1() bool } is a new type with interface"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 2, "last_activity_date": 1541012446, "creation_date": 1541012446, "answer_id": 53090301, "question_id": 53089983, "link": "https://stackoverflow.com/questions/53089983/how-to-mock-function-in-go/53090301#53090301", "title": "How to mock function in go?", "body": "<p>In your unit test, you're only calling methods on <code>Session1</code>, not on something that <em>calls</em> <code>Session1</code>'s methods; so there isn't anything to mock. When using mocking for tests, you don't mock <em>methods</em>, you mock <em>types</em>, when those types are <em>dependencies</em> of the type under test. For example, if you have a type <code>Foo</code> which depends on (calls methods of) a type <code>Bar</code>, and you want to test <code>Foo</code> in isolation, you would create a mock of type <code>Bar</code>, and in your tests for <code>Foo</code>, you'd give it your <code>BarMock</code> instead of <code>Bar</code>. In your real code, you'd give it the real <code>Bar</code>. There is no way to mock a single method of a type.</p>\n\n<p>You might find <a href=\"https://stackoverflow.com/questions/2665812/what-is-mocking\">this StackOverflow question</a> and its extensive answers helpful.</p>\n"}, {"comments": [{"owner": {"reputation": 5073, "user_id": 1365697, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cb3baa9178e40e8d47248ac73c4a24e?s=128&d=identicon&r=PG", "display_name": "user1365697", "link": "https://stackoverflow.com/users/1365697/user1365697"}, "edited": false, "score": 0, "creation_date": 1541013085, "post_id": 53090443, "comment_id": 93077786, "body": "but I create interface for this method type SessionInterface1 interface {     doLoginAndReadDestinations1() bool }"}, {"owner": {"reputation": 5073, "user_id": 1365697, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cb3baa9178e40e8d47248ac73c4a24e?s=128&d=identicon&r=PG", "display_name": "user1365697", "link": "https://stackoverflow.com/users/1365697/user1365697"}, "edited": false, "score": 0, "creation_date": 1541013152, "post_id": 53090443, "comment_id": 93077812, "body": "Do I need to change my implementation ? if yes what do you suggest ?"}, {"owner": {"reputation": 5073, "user_id": 1365697, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cb3baa9178e40e8d47248ac73c4a24e?s=128&d=identicon&r=PG", "display_name": "user1365697", "link": "https://stackoverflow.com/users/1365697/user1365697"}, "edited": false, "score": 0, "creation_date": 1541013201, "post_id": 53090443, "comment_id": 93077832, "body": "and I want to mock doLoginAndReadDestinations1 in my case"}, {"owner": {"reputation": 5073, "user_id": 1365697, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cb3baa9178e40e8d47248ac73c4a24e?s=128&d=identicon&r=PG", "display_name": "user1365697", "link": "https://stackoverflow.com/users/1365697/user1365697"}, "edited": false, "score": 0, "creation_date": 1541013329, "post_id": 53090443, "comment_id": 93077887, "body": "can I use  stretchr/testify in my real code or I need to change it ?"}], "tags": [], "owner": {"reputation": 1604, "user_id": 3351097, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/yInN3.jpg?s=128&g=1", "display_name": "Maxian Nicu", "link": "https://stackoverflow.com/users/3351097/maxian-nicu"}, "is_accepted": true, "score": 2, "last_activity_date": 1541013022, "creation_date": 1541013022, "answer_id": 53090443, "question_id": 53089983, "link": "https://stackoverflow.com/questions/53089983/how-to-mock-function-in-go/53090443#53090443", "title": "How to mock function in go?", "body": "<p>You will need to abstract everything you want to mock. Instead of resolving  dependency as a concrete implementation, use an interface. Then you will be able to create a mock which will implement this interface.</p>\n\n<p>Generally, I would suggest you <a href=\"https://github.com/stretchr/testify\" rel=\"nofollow noreferrer\">stretchr/testify</a> for testing. It has methods for :</p>\n\n<ol>\n<li>assert</li>\n<li>require</li>\n<li><strong>mock</strong></li>\n<li>suite</li>\n</ol>\n\n<p>This library will help you structuring test, writing tests and remove your boilerplate code. <strong>It has mocking mechanisms inside</strong>. Read about mocking interfaces at <a href=\"https://github.com/stretchr/testify\" rel=\"nofollow noreferrer\">testify mock section</a></p>\n"}], "owner": {"reputation": 5073, "user_id": 1365697, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cb3baa9178e40e8d47248ac73c4a24e?s=128&d=identicon&r=PG", "display_name": "user1365697", "link": "https://stackoverflow.com/users/1365697/user1365697"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 53090443, "answer_count": 2, "score": -1, "last_activity_date": 1541013022, "creation_date": 1541010960, "last_edit_date": 1541012222, "question_id": 53089983, "link": "https://stackoverflow.com/questions/53089983/how-to-mock-function-in-go", "title": "How to mock function in go?", "body": "<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"sync\"\n    \"time\"\n)\n\ntype SessionInterface1 interface {\n    doLoginAndReadDestinations1() bool\n}\n\ntype Session1 struct {\n    sessionCookie string\n    mux           sync.Mutex\n    sessionTime   time.Time\n    targetAddress string\n    currentJwt    string\n    transport     *http.Transport\n}\n\nvar currentSession1 Session1\n\nfunc main() {\n\n    currentSession1.verifyLogin1()\n\n}\n\nfunc (s *Session1) doLoginAndReadDestinations1() bool {\n    ..logic...\n    ... for example return true\n\n}\n\nfunc callDest1(si SessionInterface1) bool {\n    return si.doLoginAndReadDestinations1()\n}\n\nfunc (s *Session1) verifyLogin1() bool {\n    return callDest1(s)\n}\n</code></pre>\n\n<p>I want to create unit test and to mock doLoginAndReadDestinations1\nI tried to create interface for this method and I create test</p>\n\n<pre><code>func test1(t *testing.T) {\n    type args struct {\n    }\n    tests := []struct {\n        name string\n        args args\n        want bool\n    }{{\n        name: \"test\",\n        args: args{},\n        want: false,\n    }}\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            var s1 *Session1\n            count := 10\n            s1 = &amp;Session1{\"\", sync.Mutex{}, time.Now(), \"\", \"\", nil}\n\n            var got1 = s1.verifyLogin()\n\n            if got1 != tt.want {\n                t.Errorf(\"getJwt() = %v, want %v\", got, tt.want)\n            }\n\n        })\n    }\n}\n</code></pre>\n\n<p>I didn't know how I can change the logic of function doLoginAndReadDestinations1 in the test and to change the logic in the first main</p>\n"}, {"tags": ["file", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1540999840, "post_id": 53086797, "comment_id": 93070835, "body": "Why can you only read 4096 bytes? What is a &quot;full file&quot; when reading from a stream oriented connection?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1541000122, "post_id": 53086797, "comment_id": 93071028, "body": "How many bytes are read in one go is up to the Reader implementation. Call Read repeatedly, or use something like io.ReadFull, io.ReadAtLeast, etc. if you want to do it in one call."}, {"owner": {"reputation": 13, "user_id": 8458811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1cda89620a83c0ee1ab416e2aba7d2?s=128&d=identicon&r=PG&f=1", "display_name": "klynxe", "link": "https://stackoverflow.com/users/8458811/klynxe"}, "edited": false, "score": 0, "creation_date": 1541000845, "post_id": 53086797, "comment_id": 93071547, "body": "Thank Peter, i will try use io instade of bufio. Jim, I send big file to this socket and when I try read, bufio.reader read only first 4096 bytes (in first call)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1541001485, "post_id": 53086797, "comment_id": 93071950, "body": "@klynxe: yes, reading from a stream requires multiple calls to <code>Read</code>, but you also need to know how to detect what is a &quot;full file&quot;, which depends on how you&#39;re sending it, and any higher level protocol being used."}], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 1, "last_activity_date": 1541072652, "last_edit_date": 1541072652, "creation_date": 1541002443, "answer_id": 53087803, "question_id": 53086797, "link": "https://stackoverflow.com/questions/53086797/golang-read-more-4096-bytes/53087803#53087803", "title": "golang read more 4096 bytes", "body": "<p><code>io.Reader.Read(p []byte)</code> \u2014 if succeeds, \u2014 is free to return any number of bytes between 1 and <code>len(p)</code>; this is by\n<a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\">its contract</a>:</p>\n\n<blockquote>\n  <p>Read reads up to <code>len(p)</code> bytes into <code>p</code>. It returns the number of bytes read (<code>0 &lt;= n &lt;= len(p)</code>) and any error encountered. Even if <code>Read</code> returns <code>n &lt; len(p)</code>, it may use all of p as scratch space during the call. If some data is available but not <code>len(p)</code> bytes, <em><code>Read</code> conventionally returns what is available instead of waiting for more.</em></p>\n</blockquote>\n\n<p>(Emphasis mine.)</p>\n\n<p>The \"magic number\" 4096 you're observing is likely the size of the cache of some piece of software under your TLS connection.</p>\n\n<p>This actually matches the contract of the <a href=\"https://manpages.debian.org/2/read\" rel=\"nofollow noreferrer\"><code>read(2)</code></a> POSIX syscall\n(for sockets, it actually will be <a href=\"https://manpages.debian.org/2/recv\" rel=\"nofollow noreferrer\"><code>recv(2)</code></a> \u2014 from \"BSD sockets\" which every platform supported by Go implements, including Windows; <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winsock2/nf-winsock2-wsarecv\" rel=\"nofollow noreferrer\">its counterpart from Winsock</a> has the same semantics, FWIW).</p>\n\n<p>If you <em>know exactly</em> how many bytes you need to read from the source, use the <a href=\"https://golang.org/pkg/io/#ReadFull\" rel=\"nofollow noreferrer\"><code>io.ReadFull</code></a> helper.\nThis is usually the simplest approach to deal with data\nencoded in a <a href=\"https://en.wikipedia.org/wiki/Type-length-value\" rel=\"nofollow noreferrer\">TLV</a>-like format (and <a href=\"https://golang.org/pkg/encoding/binary/\" rel=\"nofollow noreferrer\"><code>encoding/binary</code></a> helps as well).</p>\n"}], "owner": {"reputation": 13, "user_id": 8458811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1cda89620a83c0ee1ab416e2aba7d2?s=128&d=identicon&r=PG&f=1", "display_name": "klynxe", "link": "https://stackoverflow.com/users/8458811/klynxe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1541072652, "creation_date": 1540999270, "question_id": 53086797, "link": "https://stackoverflow.com/questions/53086797/golang-read-more-4096-bytes", "title": "golang read more 4096 bytes", "body": "<p>I try read file from TLS connect, but I can read only 4096 bytes (n = 4096). How I can read full file?</p>\n\n<pre><code>reader := bufio.NewReader(pc.conn)\nmsg := make([]byte, 10*1024*1024)\nn,err:=reader.Read(msg)\n</code></pre>\n"}, {"tags": ["go", "version-control"], "comments": [{"owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "edited": false, "score": 0, "creation_date": 1541676678, "post_id": 53086744, "comment_id": 93301695, "body": "See also <a href=\"https://stackoverflow.com/questions/53086136/fixing-versions-of-tools-used-by-go/53089261#53089261\" title=\"fixing versions of tools used by go\">stackoverflow.com/questions/53086136/&hellip;</a> which covers the same problem solution for installable commands written in go. Has answer for both go 1.11 with modules and earlier versions."}], "answers": [{"comments": [{"owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "edited": false, "score": 0, "creation_date": 1541007038, "post_id": 53088951, "comment_id": 93075041, "body": "both glide and dep are obsoleted by modules. However I&#39;m using go 1.7.4 as provided with Debian 9. dep might work but is offically supported only for 1.9 above."}, {"owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "edited": false, "score": 1, "creation_date": 1541007041, "post_id": 53088951, "comment_id": 93075043, "body": "Thanks, I will try your solution and accept if it works for me."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "reply_to_user": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "edited": false, "score": 0, "creation_date": 1541007136, "post_id": 53088951, "comment_id": 93075099, "body": "Yes, modules are preferred, but I believe dep is the more &quot;official&quot; tool for Go &lt; 1.11. If you are free to upgrade, you could use snap to get the latest Go."}, {"owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "edited": false, "score": 0, "creation_date": 1541066873, "post_id": 53088951, "comment_id": 93093757, "body": "That seems to work and answers another question I had. Using -o for out of source builds. The trick seems to be the /*.go if you try to be clever go doesn&#39;t like it, it wants to be clever for you."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "reply_to_user": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "edited": false, "score": 0, "creation_date": 1541084557, "post_id": 53088951, "comment_id": 93103098, "body": "You are welcome. And as I said, if the reason you are using such an old Go version only has to do with what is provided by Debian, you can use snap. To install snap on Debian 9 you can follow a guide here <a href=\"https://docs.snapcraft.io/installing-snap-on-debian/6742\" rel=\"nofollow noreferrer\">docs.snapcraft.io/installing-snap-on-debian/6742</a> and here is a link to Go snap package <a href=\"https://snapcraft.io/go\" rel=\"nofollow noreferrer\">snapcraft.io/go</a>"}, {"owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "edited": false, "score": 1, "creation_date": 1541085783, "post_id": 53088951, "comment_id": 93103801, "body": "In production you don&#39;t want a constantly moving target. In general I try to use the versions of packages the OS vendor provides for stability. Debian and RedHat are both a little on the conservative side but 1.8 was only released late in 2016. In this case I&#39;m copying colleagues who&#39;ve recently introduced go."}, {"owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "edited": false, "score": 0, "creation_date": 1541676567, "post_id": 53088951, "comment_id": 93301616, "body": "Having moved to go 1.11 I now have no GOPATH and no vendor directory just some go.mod files and it is a simpler solution as I don&#39;t have to explain the use of third party tools."}], "tags": [], "owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "is_accepted": true, "score": 1, "last_activity_date": 1541006594, "creation_date": 1541006594, "answer_id": 53088951, "question_id": 53086744, "link": "https://stackoverflow.com/questions/53086744/multiple-go-projects-and-sharing-a-vendor-directory-in-go-before-1-11/53088951#53088951", "title": "multiple go projects and sharing a vendor directory (in go before 1.11)", "body": "<p>It should be possible to have a shared vendor directory. The way I am doing it involves Go 1.11 and the new Go feature called modules. But I am pretty sure it should work with vendor and tools like glide and dep. To use dep/glide your directory structure might looks like this</p>\n\n<pre><code>- src\n  - projects\n      - project1\n      - project2\n      - vendor\n      - Glide.yaml\n</code></pre>\n\n<p>And you can build it either from the projects folder using <code>go build -o p1 project1/*.go</code> or from individual project folder using <code>go build</code></p>\n\n<p>The same structure, but outside of GOPATH will work for Go 1.11 modules. You would have to set the GO111MODULE variable to \"on\" or \"auto\". Mind you that go modules store dependencies in some other location and download them automatically during the build process when needed.</p>\n\n<p>Note: glide github page recommends switching to dep as the more official tool</p>\n\n<p>Edit: Just tested it with dep. It works for me.</p>\n"}, {"comments": [{"owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "edited": false, "score": 0, "creation_date": 1541676351, "post_id": 53091707, "comment_id": 93301479, "body": "That is correct for go 1.11 which I have now switched to as it is a better solution than depending on glide and retool. I had to accept the other answer however as my question refers to an earlier version of go."}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "reply_to_user": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "edited": false, "score": 0, "creation_date": 1541793244, "post_id": 53091707, "comment_id": 93351851, "body": "Yes, that&#39;s fair. Besides the question, I recommend to start learning from the fresh versions - they have big improvements. And you will not waste time relearning. I&#39;ve had spent some time investigating modules after <i>classic</i> GOPATH."}], "tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1541018738, "creation_date": 1541018738, "answer_id": 53091707, "question_id": 53086744, "link": "https://stackoverflow.com/questions/53086744/multiple-go-projects-and-sharing-a-vendor-directory-in-go-before-1-11/53091707#53091707", "title": "multiple go projects and sharing a vendor directory (in go before 1.11)", "body": "<p>I recommend look at new vendoring system - <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/Modules</a></p>\n\n<p>It allows you to fix versions of packages used:</p>\n\n<pre><code>module github.com/my/thing\n\nrequire (\n    github.com/some/dependency v1.2.3\n    github.com/another/dependency/v4 v4.0.0\n)\n</code></pre>\n"}], "owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 956, "favorite_count": 0, "accepted_answer_id": 53088951, "answer_count": 2, "score": 1, "last_activity_date": 1541676414, "creation_date": 1540999074, "last_edit_date": 1541676414, "question_id": 53086744, "link": "https://stackoverflow.com/questions/53086744/multiple-go-projects-and-sharing-a-vendor-directory-in-go-before-1-11", "title": "multiple go projects and sharing a vendor directory (in go before 1.11)", "body": "<p>I have started learning <em>go</em> (1.7.4) and have a project which currently produces two executables. I have a directory structure as below following the standard go layout:</p>\n\n<pre><code>GOPATH=`pwd`\nbin\nsrc/\nsrc/&lt;project1&gt;\nsrc/&lt;project1&gt;/vendor\nsrc/&lt;project1&gt;/glide.yaml\nsrc/&lt;project2&gt;\nsrc/&lt;project2&gt;/vendor\nsrc/&lt;project2&gt;/glide.yaml\npkg/\n</code></pre>\n\n<p>Project 1 and project 2 share a lot of dependencies. \n<strong>Is there a way to share the vendor directory between project1 and project2 and still pin the versions to ensure reproducible builds?</strong></p>\n\n<p>I don't want to duplicate the glide.yaml and vendor directories for each project as it bloats the build and violates DRY.</p>\n\n<p>The pkg directory is the obvious the way to do this but unlike vendor I don't have a dependency manager tool like glide to ensure a specific version is used (see also my <a href=\"https://stackoverflow.com/questions/53086136/fixing-versions-of-tools-used-by-go\">related question</a>).</p>\n\n<p>A possibly related issue is how this project is organised. I believe in <em>go</em> it would be more conventional for each project sub-directory to map to a single github repository. However, for my project I want to build at least two executables. I realise you can do this by using different package names but it confuses go and glide. I wrestled with getting this to work under a single project and decided/discovered it was easier to use the standard go layout and work two levels up. For example, an advantage is that \"go build\" etc. in the subdirectories just works without having to name the package. I can also have my build, test and package machinery at the top level operate on all projects and keep my go environment separate from any others.\nThe programs are not complex enough to warrant separate git repositories (even as submodules). If there is a pattern that makes this work it might render my original question moot.</p>\n"}, {"tags": ["go", "glide-golang"], "comments": [{"owner": {"reputation": 148, "user_id": 7263440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b16f456d714f65cb780cee9a87dc0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan N", "link": "https://stackoverflow.com/users/7263440/dan-n"}, "edited": false, "score": 0, "creation_date": 1540998857, "post_id": 53086136, "comment_id": 93070145, "body": "I&#39;m not sure about other go dependency tools, but dep will also not install binaries. There&#39;s an <a href=\"https://github.com/golang/dep/issues/221\" rel=\"nofollow noreferrer\">issue</a> about it already open. What I do, is keep a separate gotools GOPATH where I keep all my go based tools. Especially ones that vscode uses. This keeps my project GOPATH from being &quot;contaminated&quot; with external things."}, {"owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "reply_to_user": {"reputation": 148, "user_id": 7263440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b16f456d714f65cb780cee9a87dc0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan N", "link": "https://stackoverflow.com/users/7263440/dan-n"}, "edited": false, "score": 0, "creation_date": 1541000546, "post_id": 53086136, "comment_id": 93071341, "body": "Its not clear if vgo will solve this either - <a href=\"https://go.googlesource.com/proposal/+/master/design/24301-versioned-go.md\" rel=\"nofollow noreferrer\">go.googlesource.com/proposal/+/master/design/&hellip;</a>"}, {"owner": {"reputation": 148, "user_id": 7263440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b16f456d714f65cb780cee9a87dc0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan N", "link": "https://stackoverflow.com/users/7263440/dan-n"}, "edited": false, "score": 1, "creation_date": 1541000799, "post_id": 53086136, "comment_id": 93071505, "body": "I just played around with the <code>go mod</code> that was added in go1.11. It like the other dependency tools don&#39;t install packages, they just download them. So you won&#39;t be able to track a build dependency tool like go2xunit."}, {"owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "reply_to_user": {"reputation": 148, "user_id": 7263440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b16f456d714f65cb780cee9a87dc0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan N", "link": "https://stackoverflow.com/users/7263440/dan-n"}, "edited": false, "score": 0, "creation_date": 1541002170, "post_id": 53086136, "comment_id": 93072387, "body": "Doh! Reproducible builds are still a way off then! Thanks for the insight though."}, {"owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "reply_to_user": {"reputation": 148, "user_id": 7263440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b16f456d714f65cb780cee9a87dc0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan N", "link": "https://stackoverflow.com/users/7263440/dan-n"}, "edited": false, "score": 0, "creation_date": 1541003514, "post_id": 53086136, "comment_id": 93073207, "body": "I&#39;m sure this must be a known issue but having failed to find it I&#39;ve raised it here - <a href=\"https://github.com/golang/go/issues/28512\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/28512</a>"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1541013953, "post_id": 53086136, "comment_id": 93078153, "body": "For go mod see <a href=\"https://stackoverflow.com/questions/52428230/how-do-go-modules-work-with-installable-commands/52430466#52430466\" title=\"how do go modules work with installable commands\">stackoverflow.com/questions/52428230/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "edited": false, "score": 0, "creation_date": 1541617820, "post_id": 53089261, "comment_id": 93280903, "body": "Note that this answer is essentially a duplicate of the answer to <a href=\"https://stackoverflow.com/questions/52428230/how-do-go-modules-work-with-installable-commands?noredirect=1&amp;lq=1\" title=\"how do go modules work with installable commands\">stackoverflow.com/questions/52428230/&hellip;</a> except that this also covers older versions of go"}], "tags": [], "owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "is_accepted": true, "score": 0, "last_activity_date": 1541617719, "last_edit_date": 1541617719, "creation_date": 1541007957, "answer_id": 53089261, "question_id": 53086136, "link": "https://stackoverflow.com/questions/53086136/fixing-versions-of-tools-used-by-go/53089261#53089261", "title": "fixing versions of tools used by go", "body": "<p>The solution for go1.11 using go modules is to create a <a href=\"https://github.com/golang/go/issues/25922\" rel=\"nofollow noreferrer\">fake tools package</a>.\nYou create a <em>tools.go</em> file like the following:</p>\n\n<pre><code>// +build tools\n\npackage tools\n\nimport (\n        _ \"github.com/tebeka/go2xunit\"\n)\n</code></pre>\n\n<p><em>+build</em> tools is a magic comment which prevents the package being built.</p>\n\n<pre><code>&gt;go mod init tools\n</code></pre>\n\n<p>Will create a <em>go.mod</em> file for the fake <em>tools</em> package</p>\n\n<pre><code>&gt;go install github.com/tebeka/go2xunit\n</code></pre>\n\n<p>Will install go2xunit and update go.mod as follows.</p>\n\n<pre><code>module tools\n\nrequire github.com/tebeka/go2xunit v1.4.8 // indirect\n</code></pre>\n\n<p>Now if you run <em>go install github.com/tebeka/go2xunit</em> in the future (for a clean build say) its version will be fixed to v1.4 by the go.mod</p>\n\n<hr>\n\n<p>For versions of go before 1.11 the tool to use is <a href=\"https://github.com/twitchtv/retool\" rel=\"nofollow noreferrer\">retool</a>.\nIt works like this:</p>\n\n<p>bootstrap:</p>\n\n<pre><code>go get github.com/twitchtv/retool\n</code></pre>\n\n<p>add tool:</p>\n\n<pre><code>retool add github.com/jteeuwen/go-bindata/go-bindata origin/master\n</code></pre>\n\n<p>use tool:</p>\n\n<pre><code>retool do go-bindata -pkg testdata -o ./testdata/testdata.go ./testdata/data.json\n</code></pre>\n\n<p>Adding support for this may be on the roadmap to target go 1.12 (<a href=\"https://github.com/golang/go/issues/27653\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/27653</a>)</p>\n"}, {"tags": [], "owner": {"reputation": 63890, "user_id": 151312, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a8b345ddcfc5401f578c850442f1e1b?s=128&d=identicon&r=PG", "display_name": "coolaj86", "link": "https://stackoverflow.com/users/151312/coolaj86"}, "is_accepted": false, "score": 0, "last_activity_date": 1582576154, "creation_date": 1582576154, "answer_id": 60383471, "question_id": 53086136, "link": "https://stackoverflow.com/questions/53086136/fixing-versions-of-tools-used-by-go/60383471#60383471", "title": "fixing versions of tools used by go", "body": "<p>I did this very similarly, but just different enough that I think it's worth sharing again:</p>\n\n<h1>If you get an error</h1>\n\n<p>I was not seeing the dependency that I wanted added to the go.mod and I was getting this error:</p>\n\n<pre><code>tools/tools.go:6:5: import \"github.com/UnnoTed/fileb0x\" is a program, not an importable package\n</code></pre>\n\n<p>(fileb0x is the thing I'm trying to add)</p>\n\n<p>I'm not 100% clear on the sequence of events that fixed it, but I did all of these things:</p>\n\n<h1>Using a \"tools\" package</h1>\n\n<p>I made a <code>tools</code> directory:</p>\n\n<pre><code>mkdir -p tools\n</code></pre>\n\n<p>I put the tools package inside of it (as mentioned above):</p>\n\n<pre><code>// +build tools\n\npackage tools\n\nimport (\n    _ \"github.com/UnnoTed/fileb0x\"\n)\n</code></pre>\n\n<p>Note that the tag is <em>mostly</em> not important. You could use foo:</p>\n\n<pre><code>// +build foo\n</code></pre>\n\n<p>However, you cannot use <code>ignore</code>. That's a special predefined tag.</p>\n\n<pre><code>// +build ignore\n\n// NO NO NO NO NO\n// `ignore` is a special keyword which (surprise) will cause\n// the file to be ignore, even for dependencies\n</code></pre>\n\n<h1>Updating go.mod</h1>\n\n<p>The <strong>best way</strong> is probably to run <code>go mod tidy</code>:</p>\n\n<pre><code>go mod tidy\n</code></pre>\n\n<p>However, before I did that I ran a number of commands trying to figure out which one would cause it to go into <code>go.mod</code>:</p>\n\n<pre><code>go install github.com/UnnoTed/fileb0x # didn't seem to do the trick\ngo get\ngo generate ./...\ngo build ./...\ngo install ./...\ngo mod vendor\n</code></pre>\n\n<p>Later I did a <code>git reset</code> and <code>rm -rf ~/go/pkg/mod; mkdir ~/go/pkg/mod</code> and found that <code>go mod tidy</code> did well enough on its own.</p>\n\n<h1>vendoring</h1>\n\n<p>In order to actually take advantage of the modules cache in a project you need to copy-in the source code</p>\n\n<pre><code>go mod vendor\n</code></pre>\n\n<p>That will grab all dependencies from go.mod</p>\n\n<p>You also need to change nearly all of your go commands to use <code>-mod=vendor</code> in any <code>Makefile</code>s, <code>Dockerfile</code>s or other scripts.</p>\n\n<pre><code>go fmt -mod=vendor ./... # has a bug which should be fixed in go1.15\ngo generate -mod=vendor ./...\ngo build -mod=vendor ./...\n</code></pre>\n\n<p>That includes <code>go build</code>, <code>go get</code>, <code>go install</code>, and any <code>go run</code> called by <code>go generate</code> (and even the <code>go generate</code> itself)</p>\n\n<pre><code>//go:generate go run -mod=vendor github.com/UnnoTed/fileb0x b0x.toml\npackage main\n\n// ...\n</code></pre>\n"}], "owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 53089261, "answer_count": 2, "score": 0, "last_activity_date": 1582576154, "creation_date": 1540997353, "question_id": 53086136, "link": "https://stackoverflow.com/questions/53086136/fixing-versions-of-tools-used-by-go", "title": "fixing versions of tools used by go", "body": "<p>I am looking to create reproducible builds with go. \nFor individual projects we are using glide.</p>\n\n<p>So for example I use:</p>\n\n<pre><code>glide get github.com/stretchr/testify\n</code></pre>\n\n<p>to fix the version of the \"testify\" package.\nThis does not work for tools however.\nFor example:</p>\n\n<pre><code>glide install github.com/tebeka/go2xunit\n</code></pre>\n\n<p>returns success but does not actually install go2xunit\nso I have to use:</p>\n\n<pre><code>go get github.com/tebeka/go2xunit\n</code></pre>\n\n<p>which installs <em>go2xunit</em> to <em>$GOPATH/bin</em>. </p>\n\n<p><strong>Q How can I fix the version of tools like go2xunit?</strong></p>\n\n<p>I also note that <a href=\"https://github.com/Masterminds/glide\" rel=\"nofollow noreferrer\">glide says use dep instead</a> and dep says <a href=\"https://github.com/golang/dep\" rel=\"nofollow noreferrer\">golang has diverged from its implementation</a> and will probably end up using something based on <a href=\"https://github.com/golang/go/wiki/vgo\" rel=\"nofollow noreferrer\">vgo</a>. There are a plethora of dependency management tools for go perhaps one of the less well known ones supports this?</p>\n\n<p>In case its relevant I'm using go 1.7.4 as provided by Debian9.</p>\n"}, {"tags": ["linux", "go"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1540996931, "post_id": 53085978, "comment_id": 93068769, "body": "Are both OS installed on the same system ?"}, {"owner": {"reputation": 131, "user_id": 5692700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b2969408288806ee76cbb4a400fbea?s=128&d=identicon&r=PG&f=1", "display_name": "jhall1990", "link": "https://stackoverflow.com/users/5692700/jhall1990"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1540997687, "post_id": 53085978, "comment_id": 93069321, "body": "The linux machine is virtual, running on the windows machine."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540998353, "post_id": 53085978, "comment_id": 93069772, "body": "What happens on Linux with the goroutine? HTTP error? Timeout? Any console output from your app? Does the app continue running or does it exit?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1540998417, "post_id": 53085978, "comment_id": 93069819, "body": "Also note that your <code>for {}</code> will tie up one CPU core at 100% as long as the app is running. <code>select {}</code> is more friendly as it uses no resources."}, {"owner": {"reputation": 131, "user_id": 5692700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b2969408288806ee76cbb4a400fbea?s=128&d=identicon&r=PG&f=1", "display_name": "jhall1990", "link": "https://stackoverflow.com/users/5692700/jhall1990"}, "edited": false, "score": 0, "creation_date": 1540999193, "post_id": 53085978, "comment_id": 93070371, "body": "Looks like it was the     for {} that was the problem. I changed it to select {} and it works on both Windows and Linux now. Thanks!"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1541003074, "post_id": 53085978, "comment_id": 93072952, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/46120712/goroutine-soon-blocked-the-http-server-when-it-was-requested\" title=\"goroutine soon blocked the http server when it was requested\">stackoverflow.com/questions/46120712/&hellip;</a>, <a href=\"https://stackoverflow.com/questions/26624959/golang-http-server-blocks-when-starts-a-goroutine-of-infinite-loop\" title=\"golang http server blocks when starts a goroutine of infinite loop\">stackoverflow.com/questions/26624959/&hellip;</a>,"}, {"owner": {"reputation": 10828, "user_id": 1394729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9Ri8.jpg?s=128&g=1", "display_name": "tink", "link": "https://stackoverflow.com/users/1394729/tink"}, "edited": false, "score": 0, "creation_date": 1541005330, "post_id": 53085978, "comment_id": 93074142, "body": "Not sure what you&#39;re doing wrong, but if I uncomment the line &quot;only works on windows&quot; I get my test page just fine on linux.  Which version of go are you using on which OS?"}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540998506, "post_id": 53086487, "comment_id": 93069875, "body": "Per the posted code, <code>main</code> won&#39;t exit until the app is killed. The last line in <code>main</code> is <code>for {}</code>. There is <i>no way</i> that &quot;main exits before your go routine finish execution&quot; with the given code in the question."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540998734, "post_id": 53086487, "comment_id": 93070048, "body": "@Adrian Surely I have just read the comments and along with that if there is never ending for loop, the program will hang after sometime or if there are less cores used than it will hang within few minutes. Hence again my answer is correct what can be the reason behind. And you have also provided same reason in the comments."}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": -1, "last_activity_date": 1541000962, "last_edit_date": 1541000962, "creation_date": 1540998374, "answer_id": 53086487, "question_id": 53085978, "link": "https://stackoverflow.com/questions/53085978/cant-run-go-web-serve-in-goroutine-on-linux-mint/53086487#53086487", "title": "Can&#39;t run go web serve in goroutine on Linux (Mint)", "body": "<p>Actually that depends on the number cores available in the CPU. That's how go routines works. In your case running the same program on Windows provide all the cores available for your go routine to run.</p>\n\n<p>But when you are running your program on virtual linux OS. It will limit to less number of resource.</p>\n\n<p>To check that how many cores your program is using use GOMAXPROCS on both linux and windows separately.</p>\n\n<pre><code>package main\n\nimport (\n    \"runtime\"\n    \"fmt\"\n)\n\nfunc getGOMAXPROCS() int {\n    return runtime.GOMAXPROCS(0)\n}\n\nfunc main() {\n    fmt.Printf(\"GOMAXPROCS is %d\\n\", getGOMAXPROCS())\n}\n</code></pre>\n\n<p>Working Code on <a href=\"https://play.golang.org/p/jEIrw-XhBap\" rel=\"nofollow noreferrer\">Go playground</a></p>\n\n<blockquote>\n  <p>GOMAXPROCS sets the maximum number of CPUs that can be executing\n  simultaneously and returns the previous setting. If n &lt; 1, it does not\n  change the current setting. The number of logical CPUs on the local\n  machine can be queried with NumCPU. This call will go away when the\n  scheduler improves.</p>\n</blockquote>\n\n<p><strong>Note:</strong> Also do not use never ending loop even if you want to wait for go routine use <code>WaitGroups.</code></p>\n"}], "owner": {"reputation": 131, "user_id": 5692700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b2969408288806ee76cbb4a400fbea?s=128&d=identicon&r=PG&f=1", "display_name": "jhall1990", "link": "https://stackoverflow.com/users/5692700/jhall1990"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541000962, "creation_date": 1540996859, "question_id": 53085978, "link": "https://stackoverflow.com/questions/53085978/cant-run-go-web-serve-in-goroutine-on-linux-mint", "title": "Can&#39;t run go web serve in goroutine on Linux (Mint)", "body": "<p>I am trying to start a web server inside my go application. When I run my code on Windows everything works as expected. The application runs it starts the web server and then waits. On linux it appears to do the same thing except I am unable to access the web server.</p>\n\n<p>If I start the web server without using a goroutine the server works, it's only when I use a goroutine that it fails.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    // go startWebServer()  // This only works on Windows.\n    // startWebServer()     // This works on both Windows and Linux.\n    fmt.Println(\"Started web server...\")\n    for {}\n}\n\nfunc startWebServer() {\n    fileServer := http.FileServer(http.Dir(\"./web\"))\n    http.Handle(\"/web/\", http.StripPrefix(\"/web/\", fileServer))\n    log.Fatal(http.ListenAndServe(\":8101\", nil))\n}\n</code></pre>\n\n<p>I have a simple HTML file in my web folder, any valid HTML will do.</p>\n\n<pre><code> &lt;h1&gt;THIS IS A TEST&lt;/h1&gt;\n</code></pre>\n\n<p>Then I point the browser to <a href=\"http://127.0.0.1:8101/web/index.html\" rel=\"nofollow noreferrer\">http://127.0.0.1:8101/web/index.html</a> </p>\n\n<p>On Windows I get my page regardless of which method I use.</p>\n\n<p>On Linux I can only get to my page if I DON'T use a goroutine.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 1553, "user_id": 9818506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcca0f9bb243465345ff084448c35e8c?s=128&d=identicon&r=PG&f=1", "display_name": "Rene Knop", "link": "https://stackoverflow.com/users/9818506/rene-knop"}, "edited": false, "score": 0, "creation_date": 1540996240, "post_id": 53085693, "comment_id": 93068326, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/47256201/golang-ignore-json-fields-when-marshalling-not-unmarshalling\">Golang ignore Json fields when marshalling not unmarshalling</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6480, "user_id": 1267140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UOHte.jpg?s=128&g=1", "display_name": "Havelock", "link": "https://stackoverflow.com/users/1267140/havelock"}, "is_accepted": false, "score": 3, "last_activity_date": 1540996169, "creation_date": 1540996169, "answer_id": 53085764, "question_id": 53085693, "link": "https://stackoverflow.com/questions/53085693/write-specific-json-fields-to-file/53085764#53085764", "title": "Write specific JSON fields to file", "body": "<p>If I understood correctly, you'd like to omit some of the fields when marshalling to JSON. Then use <code>json:\"-\"</code> as a field tag.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6911482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f337b2049ba02871c898e2bcb6769217?s=128&d=identicon&r=PG&f=1", "display_name": "Timur.C", "link": "https://stackoverflow.com/users/6911482/timur-c"}, "edited": false, "score": 0, "creation_date": 1540997616, "post_id": 53086147, "comment_id": 93069273, "body": "Thanks, that&#39;s exactly what I need!"}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 3, "last_activity_date": 1540997387, "creation_date": 1540997387, "answer_id": 53086147, "question_id": 53085693, "link": "https://stackoverflow.com/questions/53085693/write-specific-json-fields-to-file/53086147#53086147", "title": "Write specific JSON fields to file", "body": "<p>Per the <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\"><code>json.Marshal(...)</code> documentation</a>:</p>\n\n<blockquote>\n  <p>As a special case, if the field tag is \"-\", the field is always omitted.</p>\n</blockquote>\n\n<p>So you just need to use the tag <code>\"-\"</code> for any public field that you do not want serialized, for example (<a href=\"https://play.golang.com/p/yHYYozCkV5x\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>type Example struct {\n  Ifindex  int    `json:\"ifindex\"`\n  HostID   int    `json:\"-\"`\n  Hostname string `json:\"hostname\"`\n  Name     string `json:\"-\"`\n}\n\nfunc main() {\n  eg := Example{Ifindex: 1, HostID: 2, Hostname: \"foo\", Name: \"bar\"}\n  bs, err := json.Marshal(&amp;eg)\n  if err != nil {\n    panic(err)\n  }\n\n  fmt.Println(string(bs))\n  // {\"ifindex\":1,\"hostname\":\"foo\"}\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6911482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f337b2049ba02871c898e2bcb6769217?s=128&d=identicon&r=PG&f=1", "display_name": "Timur.C", "link": "https://stackoverflow.com/users/6911482/timur-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1540997387, "creation_date": 1540995973, "last_edit_date": 1540997158, "question_id": 53085693, "link": "https://stackoverflow.com/questions/53085693/write-specific-json-fields-to-file", "title": "Write specific JSON fields to file", "body": "<p>I've just started studying Golang and don't understand how to write only specific JSON fields to an output file.</p>\n\n<p>For example I have this struct:</p>\n\n<pre><code>type example struct {\n        Ifindex  int    `json:\"ifindex\"`\n        HostID   int    `json:\"host_id\"`\n        Hostname string `json:\"hostname\"`\n        Name     string `json:\"name\"`\n}\n</code></pre>\n\n<p>My output file should be in the following format: </p>\n\n<pre><code>[{\"Ifindex\": int, \"Hostname\": string}, {...}]\n</code></pre>\n\n<p>How can I do it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 704, "user_id": 4792552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a528513962a9c962ff32df92a1a350b?s=128&d=identicon&r=PG", "display_name": "Berkant Ipek", "link": "https://stackoverflow.com/users/4792552/berkant-ipek"}, "edited": false, "score": 2, "creation_date": 1540994708, "post_id": 53085193, "comment_id": 93067305, "body": "Your CommandController receiver is a value receiver. Try to replace it with a pointer receiver like: func(c *CommandController) { . . . }. This is because you are mutating the receiver itself but currently your methods duplicate it and mutate the duplicate, not original receiver itself."}], "answers": [{"comments": [{"owner": {"reputation": 500, "user_id": 1387080, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/99e7b6e873999ac1ad6fd82217de5fc1?s=128&d=identicon&r=PG", "display_name": "Journerist", "link": "https://stackoverflow.com/users/1387080/journerist"}, "edited": false, "score": 0, "creation_date": 1541004970, "post_id": 53085251, "comment_id": 93073965, "body": "awesome...Thanks,  this makes sense. Why should I favour a call by value over a call by reference?"}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 2, "last_activity_date": 1540994591, "creation_date": 1540994591, "answer_id": 53085251, "question_id": 53085193, "link": "https://stackoverflow.com/questions/53085193/pointer-reference-not-stored-in-a-struct-in-my-go-program/53085251#53085251", "title": "Pointer reference not stored in a struct in my go program", "body": "<p>Change</p>\n\n<pre><code>func (c CommandController) Init(app *iris.Application, repository command.CommandRepository)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>func (c *CommandController) Init(app *iris.Application, repository command.CommandRepository)\n</code></pre>\n\n<p>since <code>Init</code> receives <code>c</code> by value in your version, any changes it makes to <code>c</code> don't appear outside of the <code>Init</code> method.</p>\n"}], "owner": {"reputation": 500, "user_id": 1387080, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/99e7b6e873999ac1ad6fd82217de5fc1?s=128&d=identicon&r=PG", "display_name": "Journerist", "link": "https://stackoverflow.com/users/1387080/journerist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 53085251, "answer_count": 1, "score": -3, "last_activity_date": 1540994591, "creation_date": 1540994379, "question_id": 53085193, "link": "https://stackoverflow.com/questions/53085193/pointer-reference-not-stored-in-a-struct-in-my-go-program", "title": "Pointer reference not stored in a struct in my go program", "body": "<p>I am new to go-lang and I try to figure out how to work properly with structs and dependency injection. I am a bit stuck because I am not able to properly store a reference to another struct.</p>\n\n<p>Here's my method that generates a CommandController. There is a valid reference to iris.Application.</p>\n\n<pre><code>func ProvideCommandController(application *iris.Application, commandRepository command.CommandRepository) (*interfaces.CommandController, error) {\ncommandController := interfaces.CommandController{}\ncommandController.Init(application, commandRepository)\ncommandController.Start()\nreturn &amp;commandController, nil\n</code></pre>\n\n<p>}</p>\n\n<p>The struct looks like this:</p>\n\n<pre><code>type CommandController struct {\n    commandRepository command.CommandRepository\n    app   *iris.Application\n}\n\nfunc (c CommandController) Init(app *iris.Application, repository command.CommandRepository) {\n    c.app = app\n    c.commandRepository = repository\n}\n\nfunc (c CommandController) Start() {\n    c.app.Get(\"/command\", c.readAll)\n    c.app.Get(\"/command/{id:string}/execute\", c.executeCommand)\n\n    c.app.Run(iris.Addr(\":8080\"))\n}\n</code></pre>\n\n<p>When the <code>ProvideCommandController</code> function gets executed I can debug and observe that all references look good. Unfortunately, <code>commandController.Start()</code>fails because of <code>c.app</code> is nil.</p>\n\n<p>What piece of understanding do I miss? Somehow, the stored reference get's deleted between the Init and the Start function call.</p>\n\n<p>Thanks in advance :)</p>\n"}, {"tags": ["go", "centos", "redhat", "yum"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4972469, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bldr2qcvznw/AAAAAAAAAAI/AAAAAAAAAA4/Q1OP9YFCnhk/photo.jpg?sz=128", "display_name": "Arun Prakash", "link": "https://stackoverflow.com/users/4972469/arun-prakash"}, "edited": false, "score": 0, "creation_date": 1540991380, "post_id": 53084090, "comment_id": 93064901, "body": "can you help me with an example?"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 57, "user_id": 4972469, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bldr2qcvznw/AAAAAAAAAAI/AAAAAAAAAA4/Q1OP9YFCnhk/photo.jpg?sz=128", "display_name": "Arun Prakash", "link": "https://stackoverflow.com/users/4972469/arun-prakash"}, "edited": false, "score": 0, "creation_date": 1540991648, "post_id": 53084090, "comment_id": 93065103, "body": "I added a link to one"}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 3, "last_activity_date": 1540991637, "last_edit_date": 1540991637, "creation_date": 1540991215, "answer_id": 53084090, "question_id": 53083752, "link": "https://stackoverflow.com/questions/53083752/how-do-i-give-option-to-a-terminal-command-running-through-go-script/53084090#53084090", "title": "How do i give option to a terminal command running through go script?", "body": "<p>The <code>y</code> is inputted via <code>stdin</code>. When you launch a subprocess, you give it a writer where you can write to its <code>stdin</code>.</p>\n\n<p>The os/exec docs have an <a href=\"https://golang.org/pkg/os/exec/#example_Cmd_StdinPipe\" rel=\"nofollow noreferrer\">example</a>.</p>\n"}], "owner": {"reputation": 57, "user_id": 4972469, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bldr2qcvznw/AAAAAAAAAAI/AAAAAAAAAA4/Q1OP9YFCnhk/photo.jpg?sz=128", "display_name": "Arun Prakash", "link": "https://stackoverflow.com/users/4972469/arun-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540991637, "creation_date": 1540990174, "question_id": 53083752, "link": "https://stackoverflow.com/questions/53083752/how-do-i-give-option-to-a-terminal-command-running-through-go-script", "title": "How do i give option to a terminal command running through go script?", "body": "<p>Lets suppose I have a go script which invokes the command </p>\n\n<p><code>yum install packagename</code>. </p>\n\n<p>It comes to a point where it asks <code>y/n</code> to install the package, there is <code>--assumeyes</code> option in yum (in this case) which i dont want to use.</p>\n\n<p>Is there any other way in <code>go</code> to send <code>y</code> to the command as i dont want to give the <code>y</code> manually when running the script</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1540987373, "post_id": 53082613, "comment_id": 93062542, "body": "Undoable. Order is fixed."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 3459940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dad0879410dc0158bde692b40637cf10?s=128&d=identicon&r=PG&f=1", "display_name": "user3459940", "link": "https://stackoverflow.com/users/3459940/user3459940"}, "edited": false, "score": 0, "creation_date": 1540990622, "post_id": 53083580, "comment_id": 93064354, "body": "Thank you! It&#39;s a pretty!"}], "tags": [], "owner": {"reputation": 111, "user_id": 10472119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525151dc37c4066a2047b3f49fe4fb29?s=128&d=identicon&r=PG", "display_name": "Kerie", "link": "https://stackoverflow.com/users/10472119/kerie"}, "is_accepted": false, "score": 3, "last_activity_date": 1540989654, "creation_date": 1540989654, "answer_id": 53083580, "question_id": 53082613, "link": "https://stackoverflow.com/questions/53082613/set-the-order-for-output-by-flag-printdefaults/53083580#53083580", "title": "Set the order for output by flag.PrintDefaults()", "body": "<p>According to the <a href=\"https://github.com/golang/go/blob/master/src/flag/flag.go#L385\" rel=\"nofollow noreferrer\">source code of flag</a>, it is impossible to modify the order of <code>flag.PrintDefault()</code>.</p>\n\n<p>However, you can write a custom <code>flag.Usage</code> function, like the following example:\n</p>\n\n<pre><code>package main\nimport (\n    \"flag\"\n    \"fmt\"\n)\nfunc main() {\n    flag.String(\"aaa\", \"foo\", \"input file of aaa\")\n    flag.String(\"bbb\", \"foo\", \"input file of aaa\")\n    flag.String(\"mode\", \"foo\", \"job's mode\")\n\n    flag.Usage = func() {\n        flagSet := flag.CommandLine\n        fmt.Printf(\"Custom Usage of %s:\\n\", \"./mytool\")\n        order := []string{\"mode\", \"aaa\", \"bbb\"}\n        for _, name := range order {\n            flag := flagSet.Lookup(name)\n            fmt.Printf(\"-%s\\n\", flag.Name)\n            fmt.Printf(\"  %s\\n\", flag.Usage)\n        }\n    }\n    flag.Parse()\n}\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>Custom Usage of ./mytool:\n-mode\n  job's mode\n-aaa\n  input file of aaa\n-bbb\n  input file of aaa\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 3459940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dad0879410dc0158bde692b40637cf10?s=128&d=identicon&r=PG&f=1", "display_name": "user3459940", "link": "https://stackoverflow.com/users/3459940/user3459940"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1540989654, "creation_date": 1540986412, "question_id": 53082613, "link": "https://stackoverflow.com/questions/53082613/set-the-order-for-output-by-flag-printdefaults", "title": "Set the order for output by flag.PrintDefaults()", "body": "<p>I want to make the help message by my program more clear by changing stdout output. Now I using of <strong>flag.Usage</strong> for provide of additional information but also I want to change of an order of output the flags. Now flags are sorted by alphabetical but I need to change an order to logical. E.g.\nNow:</p>\n\n<pre><code>./mytool --help\n-aaa\n  input file of aaa\n-bbb \n  input file of bbb\n-mode \n  job's mode\n</code></pre>\n\n<p>I wish :)</p>\n\n<pre><code>./mytool --help\n-mode \n  job's mode\n-aaa\n  input file of aaa\n-bbb \n  input file of bbb\n</code></pre>\n\n<p>Thank you so much!</p>\n"}, {"tags": ["debugging", "go", "benchmarking"], "comments": [{"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1540995022, "post_id": 53082371, "comment_id": 93067511, "body": "Probably a problem with your own server, the  <code>-b</code> option is the right one."}, {"owner": {"reputation": 6480, "user_id": 1267140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UOHte.jpg?s=128&g=1", "display_name": "Havelock", "link": "https://stackoverflow.com/users/1267140/havelock"}, "edited": false, "score": 0, "creation_date": 1540996727, "post_id": 53082371, "comment_id": 93068635, "body": "If <code>-b</code> stands for body and looking at your examples, I&#39;d imagine you&#39;d like to use JSON for your body. None of your examples is a valid JSON though..."}], "answers": [{"comments": [{"owner": {"reputation": 1948, "user_id": 308578, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4a5dc52399848c014faae9d66a3d2d7b?s=128&d=identicon&r=PG", "display_name": "saber tabatabaee yazdi", "link": "https://stackoverflow.com/users/308578/saber-tabatabaee-yazdi"}, "edited": false, "score": 0, "creation_date": 1607920262, "post_id": 53103884, "comment_id": 115414433, "body": "is there any way to export commands for bombardier from insomnia or postman. or need to develop a new plugin for insomnia to do it?"}, {"owner": {"reputation": 491, "user_id": 4589103, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iTimZmLLsDA/AAAAAAAAAAI/AAAAAAAAABk/9LNyqxJ8AOo/photo.jpg?sz=128", "display_name": "\u041f\u0435\u0442\u0440\u043e \u0414\u0430\u0440\u0456\u0439", "link": "https://stackoverflow.com/users/4589103/%d0%9f%d0%b5%d1%82%d1%80%d0%be-%d0%94%d0%b0%d1%80%d1%96%d0%b9"}, "reply_to_user": {"reputation": 1948, "user_id": 308578, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4a5dc52399848c014faae9d66a3d2d7b?s=128&d=identicon&r=PG", "display_name": "saber tabatabaee yazdi", "link": "https://stackoverflow.com/users/308578/saber-tabatabaee-yazdi"}, "edited": false, "score": 1, "creation_date": 1607944095, "post_id": 53103884, "comment_id": 115421733, "body": "unfortunately i don&#39;t know"}], "tags": [], "owner": {"reputation": 491, "user_id": 4589103, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iTimZmLLsDA/AAAAAAAAAAI/AAAAAAAAABk/9LNyqxJ8AOo/photo.jpg?sz=128", "display_name": "\u041f\u0435\u0442\u0440\u043e \u0414\u0430\u0440\u0456\u0439", "link": "https://stackoverflow.com/users/4589103/%d0%9f%d0%b5%d1%82%d1%80%d0%be-%d0%94%d0%b0%d1%80%d1%96%d0%b9"}, "is_accepted": true, "score": 2, "last_activity_date": 1541084470, "creation_date": 1541084470, "answer_id": 53103884, "question_id": 53082371, "link": "https://stackoverflow.com/questions/53082371/using-bombardier-for-server-benchmarking-but-cant-add-body-parameters/53103884#53103884", "title": "Using bombardier for server benchmarking - but can&#39;t add body parameters", "body": "<p>Just found the solution, - you need to write body variables like this:</p>\n\n<pre><code>-b \"isTemplate=1\"\n</code></pre>\n\n<p>So final request:</p>\n\n<pre><code>./bombardier -c 1 -n 1 -m PATCH -H \"Authorization: Bearer MYBEARERGOESHERE\" -H \"Content-Type: application/x-www-form-urlencoded\" -b \"isTemplate=1\" http://localhost:8082/presentation/6525/update\n</code></pre>\n"}], "owner": {"reputation": 491, "user_id": 4589103, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iTimZmLLsDA/AAAAAAAAAAI/AAAAAAAAABk/9LNyqxJ8AOo/photo.jpg?sz=128", "display_name": "\u041f\u0435\u0442\u0440\u043e \u0414\u0430\u0440\u0456\u0439", "link": "https://stackoverflow.com/users/4589103/%d0%9f%d0%b5%d1%82%d1%80%d0%be-%d0%94%d0%b0%d1%80%d1%96%d0%b9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 745, "favorite_count": 0, "accepted_answer_id": 53103884, "answer_count": 1, "score": 1, "last_activity_date": 1541084470, "creation_date": 1540985560, "question_id": 53082371, "link": "https://stackoverflow.com/questions/53082371/using-bombardier-for-server-benchmarking-but-cant-add-body-parameters", "title": "Using bombardier for server benchmarking - but can&#39;t add body parameters", "body": "<p>So, I'm using <a href=\"https://github.com/codesenberg/bombardier\" rel=\"nofollow noreferrer\">bombardier</a> on MacOS Sierra\nfor server benchmarking from command line.\nIn this example i'm using 1 connection and 1 request, and two headers:\n\"Authorization\" and \"Content-Type\" and body: \"{isTemplate:1}\"\nBut server does not receiving body.</p>\n\n<pre><code>./bombardier -c 1 -n 1 -m PATCH -H \"Authorization: Bearer MYBEARERGOESHERE\" -H \"Content-Type: application/x-www-form-urlencoded\" -b \"{isTemplate:1}\" http://localhost:8082/presentation/6525/update\n</code></pre>\n\n<p>I tried:</p>\n\n<pre><code>-b \"{isTemplate:1}\"\n\n-b \"isTemplate:1\"\n</code></pre>\n\n<p>Any thoughts? </p>\n"}, {"tags": ["go", "reverse-proxy"], "comments": [{"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1540992324, "post_id": 53082355, "comment_id": 93065605, "body": "I&#39;m have some question here. So the <code>req.ParseForm()</code> statement is called twice?"}, {"owner": {"reputation": 1, "user_id": 8206842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a240e5e5cdf1aafef9a6a02bfbe0375?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil", "link": "https://stackoverflow.com/users/8206842/kamil"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1540993101, "post_id": 53082355, "comment_id": 93066183, "body": "no, only once, but I wanted to show places where I try to call this statement."}, {"owner": {"reputation": 1181, "user_id": 818341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f45a2e41581efd75e909a55943eb91?s=128&d=identicon&r=PG&f=1", "display_name": "Arash", "link": "https://stackoverflow.com/users/818341/arash"}, "edited": false, "score": 0, "creation_date": 1540995447, "post_id": 53082355, "comment_id": 93067787, "body": "The location of error in stack trace doesn&#39;t seem to be related to this function. Can you show how you setup the reverse proxy?"}, {"owner": {"reputation": 1, "user_id": 8206842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a240e5e5cdf1aafef9a6a02bfbe0375?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil", "link": "https://stackoverflow.com/users/8206842/kamil"}, "edited": false, "score": 0, "creation_date": 1541786012, "post_id": 53082355, "comment_id": 93348698, "body": "This is all setup of the reverse proxy I use other function only to pass target to func serveReverseProxy. I think a problem is with ParseForm(), because if I use it before proxy.ServeHTTP(res, req) it generate this bug, when I dont use it everything works good, and if I use ParseForm() after proxy.ServeHTTP(res, req) or with defer -  proxy works but I get empty value of POST request given parameteres."}], "owner": {"reputation": 1, "user_id": 8206842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a240e5e5cdf1aafef9a6a02bfbe0375?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil", "link": "https://stackoverflow.com/users/8206842/kamil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 877, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540985512, "creation_date": 1540985512, "question_id": 53082355, "link": "https://stackoverflow.com/questions/53082355/golang-proxy-http-request-post-parameters", "title": "GoLang Proxy http.request POST parameters", "body": "<p>I have written a simple http proxy in Go and need to read values of an HTTP POST sent parameters. </p>\n\n<p>I have called request.ParseForm() in the application before create the reverse proxy and I got these parameteres but my reverse proxy stopped work. When I call request.ParseForm() after reverse proxy I get empty values. </p>\n\n<p>error in go:</p>\n\n<pre><code>2018/10/31 12:26:45 http: panic serving [::1]:49967: runtime error: invalid \nmemory address or nil pointer dereference\ngoroutine 51 [running]:\nnet/http.(*conn).serve.func1(0xc0001c2000)\n    C:/Go/src/net/http/server.go:1746 +0xd7\npanic(0x7ae340, 0xb00ba0)\n    C:/Go/src/runtime/panic.go:513 +0x1c7\nmain.(*myTransport).RoundTrip(0xb2bb10, 0xc000140400, 0xf, 0xc0000ec301, 0x3)\n</code></pre>\n\n<p>error in chrome: ERR_EMPTY_RESPONSE</p>\n\n<pre><code>func serveReverseProxy(target string, res http.ResponseWriter, req *http.Request) {\n\n    if req.Method == \"POST\" {\n\n        // req.ParseForm() here broke the reverse proxy but I get value of HTTP POST Param\n        req.ParseForm()\n        value := req.Form.Get(\"url\")\n        fmt.Println(value)\n\n        // parse the url\n        url, _ := url.Parse(target)\n\n        // create the reverse proxy\n        proxy := httputil.NewSingleHostReverseProxy(url)\n\n        // Update the headers to allow for SSL redirection\n        req.URL.Path = url.Path\n        req.URL.Host = url.Host\n        req.URL.Scheme = url.Scheme\n        req.Header.Set(\"X-Forwarded-Host\", req.Header.Get(\"Host\"))\n        req.Host = url.Host\n\n\n        proxy.Transport = &amp;myTransport{}\n        proxy.ServeHTTP(res, req)\n\n        // if I use req.ParseForm() here the reverse proxy works good but I get empty value of HTTP POST param\n        req.ParseForm()\n        value := req.Form.Get(\"url\")\n        fmt.Println(value)\n\n        if(ableToSaveInDB){\n            handleInsert(res,req, value)\n        }\n    }\n}\n\n\nfunc (t *myTransport) RoundTrip(request *http.Request) (*http.Response, error) {\n\n    response, err := http.DefaultTransport.RoundTrip(request)\n\n    if(response.StatusCode == 200) {\n        ableToSaveInDB = true\n    }\n\n    return response, err\n}\n</code></pre>\n"}, {"tags": ["firebase", "go", "google-cloud-firestore"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 954331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ff3096eb0e2f282cdf620da21f2fa3?s=128&d=identicon&r=PG", "display_name": "Faried Nawaz", "link": "https://stackoverflow.com/users/954331/faried-nawaz"}, "edited": false, "score": 0, "creation_date": 1540986333, "post_id": 53081519, "comment_id": 93061936, "body": "<i>It means that you are getting from the database only the documents within 2006-01 collection and only those documents, nothing more.</i>  That is exactly what I want -- the list of documents named (in this example) <code>2018-10-15</code> and <code>2018-10-22</code>.  I don&#39;t want the documents inside the <code>Events</code> subcollections under them."}, {"owner": {"reputation": 89473, "user_id": 5246885, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Bxclj.jpg?s=128&g=1", "display_name": "Alex Mamo", "link": "https://stackoverflow.com/users/5246885/alex-mamo"}, "reply_to_user": {"reputation": 21, "user_id": 954331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ff3096eb0e2f282cdf620da21f2fa3?s=128&d=identicon&r=PG", "display_name": "Faried Nawaz", "link": "https://stackoverflow.com/users/954331/faried-nawaz"}, "edited": false, "score": 0, "creation_date": 1540987270, "post_id": 53081519, "comment_id": 93062474, "body": "For that, please see the official documentation regarding <a href=\"https://godoc.org/cloud.google.com/go/firestore\" rel=\"nofollow noreferrer\">func (Query) Select</a> -&gt; <code>Select returns a new Query that specifies the paths to return from the result documents. Each path argument can be a single field or a dot-separated sequence of fields, and must not contain any of the runes &quot;\u02dc*&#47;[]&quot;.  An empty Select call will produce a query that returns only document IDs.</code>."}, {"owner": {"reputation": 21, "user_id": 954331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ff3096eb0e2f282cdf620da21f2fa3?s=128&d=identicon&r=PG", "display_name": "Faried Nawaz", "link": "https://stackoverflow.com/users/954331/faried-nawaz"}, "edited": false, "score": 0, "creation_date": 1540990849, "post_id": 53081519, "comment_id": 93064498, "body": "I&#39;ve tried <code>iter := colref.Select().Documents(ctx)</code> (or with <code>.SelectPaths()</code>) and looping over <code>iter</code> doesn&#39;t return any documents.  I&#39;ve also tried <code>iter := colref.Documents(ctx)</code>."}, {"owner": {"reputation": 21, "user_id": 954331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ff3096eb0e2f282cdf620da21f2fa3?s=128&d=identicon&r=PG", "display_name": "Faried Nawaz", "link": "https://stackoverflow.com/users/954331/faried-nawaz"}, "edited": false, "score": 0, "creation_date": 1540992045, "post_id": 53081519, "comment_id": 93065403, "body": "It doesn&#39;t return any docs or errors.  I have a <code>log.Printf</code> inside the loop that iterates over <code>iter</code> and it&#39;s never called.  (Nor are any of the error checks inside the loop triggered, either.)  I can put all my event entries under one collection, and add fields to each event like &quot;YearMonth&quot; or &quot;WeekStart&quot; with strings for the dates I&#39;ll later need, but then it becomes impossible to browse that collection using the web console."}, {"owner": {"reputation": 89473, "user_id": 5246885, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Bxclj.jpg?s=128&g=1", "display_name": "Alex Mamo", "link": "https://stackoverflow.com/users/5246885/alex-mamo"}, "reply_to_user": {"reputation": 21, "user_id": 954331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ff3096eb0e2f282cdf620da21f2fa3?s=128&d=identicon&r=PG", "display_name": "Faried Nawaz", "link": "https://stackoverflow.com/users/954331/faried-nawaz"}, "edited": false, "score": 0, "creation_date": 1540992174, "post_id": 53081519, "comment_id": 93065492, "body": "But any other values from the database are displayed correctly, right?"}, {"owner": {"reputation": 21, "user_id": 954331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ff3096eb0e2f282cdf620da21f2fa3?s=128&d=identicon&r=PG", "display_name": "Faried Nawaz", "link": "https://stackoverflow.com/users/954331/faried-nawaz"}, "edited": false, "score": 0, "creation_date": 1541000333, "post_id": 53081519, "comment_id": 93071181, "body": "Yes, if I try to fetch a document at the end of the tree, it works.  So, I can get <code>&#47;TimeEntries&#47;2018&#47;2018-10&#47;2018-10-22&#47;Events&#47;401675</code> and deserialize it to a struct (or read it as a <code>map[string]interface{}</code>), but not <code>&#47;TimeEntries&#47;2018&#47;2018-10</code> or <code>&#47;TimeEntries&#47;2018</code>.  The error says it can&#39;t find it: <code>rpc error: code = NotFound desc = &quot;projects&#47;my-gcloud-project&#47;databases&#47;(default)&#47;documents&#47;Ti&zwnj;&#8203;meEntries&#47;2018&quot; not found</code>"}, {"owner": {"reputation": 89473, "user_id": 5246885, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Bxclj.jpg?s=128&g=1", "display_name": "Alex Mamo", "link": "https://stackoverflow.com/users/5246885/alex-mamo"}, "reply_to_user": {"reputation": 21, "user_id": 954331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ff3096eb0e2f282cdf620da21f2fa3?s=128&d=identicon&r=PG", "display_name": "Faried Nawaz", "link": "https://stackoverflow.com/users/954331/faried-nawaz"}, "edited": false, "score": 0, "creation_date": 1541000669, "post_id": 53081519, "comment_id": 93071430, "body": "Are you sure all of your variables that you pass to those functions are correct? And the result is an existing reference?"}, {"owner": {"reputation": 21, "user_id": 954331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ff3096eb0e2f282cdf620da21f2fa3?s=128&d=identicon&r=PG", "display_name": "Faried Nawaz", "link": "https://stackoverflow.com/users/954331/faried-nawaz"}, "edited": false, "score": 0, "creation_date": 1541020802, "post_id": 53081519, "comment_id": 93080987, "body": "Yes, I&#39;m positive there&#39;s no mistake there."}], "tags": [], "owner": {"reputation": 89473, "user_id": 5246885, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Bxclj.jpg?s=128&g=1", "display_name": "Alex Mamo", "link": "https://stackoverflow.com/users/5246885/alex-mamo"}, "is_accepted": false, "score": 0, "last_activity_date": 1540982741, "creation_date": 1540982741, "answer_id": 53081519, "question_id": 53080331, "link": "https://stackoverflow.com/questions/53080331/cannot-seem-to-fetch-documents-with-subcollections/53081519#53081519", "title": "Cannot seem to fetch documents with subcollections", "body": "<p>When you are using the following collection reference:</p>\n\n<pre><code>colref := client.Collection(\"TimeEntries\").Doc(week.Format(\"2006\")).Collection(week.Format(\"2006-01\"))\n</code></pre>\n\n<p>It means that you are getting from the database <strong>only</strong> the documents within <code>2006-01</code> collection and only those documents, nothing more. Unfortunately, there is no way in Firestore to also get all the documents within <code>Events</code> collection, which is a subcollection within <code>2006-01-02</code> document in a single query. Queries in Firestore are shallow: they only get items from the collection that the query is run against. There is no way to get documents from another top-level collection and other collections or subcollections in a single query. Firestore doesn't support queries across different collections in one step. A single query may only use properties of documents in a single collection.</p>\n\n<p>If you want to query your Cloud Firestore database for documents within a single collection by <code>documentId</code>, you can achieve this using  <code>FieldPath.documentId()</code> like this:</p>\n\n<pre><code>client.collection.where(firebase.firestore.FieldPath.documentId(), '&lt;', 'yourDate').get();\n</code></pre>\n\n<p>But be aware that the document ids are <strong>String</strong> and therefore this will include documents with id like <code>2018-10-15</code> or <code>2018-10-22</code>. So when you order strings, the result are ordered lexicographically and I think that this is not what you want. So if you want to query a collection by numeric values, you'll need to write the document ID as a numeric value.</p>\n\n<p>But the most efficient solution in this case would be to simplify your database by creating a single collection that holds <code>event</code> documents and add under each event object a date property so you can query your database according to it. In this case you can use all the functions that Firestore SDK provides and filter with a range comparison (&lt;, &lt;=, >, >=).</p>\n"}], "owner": {"reputation": 21, "user_id": 954331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ff3096eb0e2f282cdf620da21f2fa3?s=128&d=identicon&r=PG", "display_name": "Faried Nawaz", "link": "https://stackoverflow.com/users/954331/faried-nawaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 413, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1540982741, "creation_date": 1540978685, "last_edit_date": 1540978743, "question_id": 53080331, "link": "https://stackoverflow.com/questions/53080331/cannot-seem-to-fetch-documents-with-subcollections", "title": "Cannot seem to fetch documents with subcollections", "body": "<p>I have a tree-like structure with subcollections that I can build, insert objects into and fetch from, but I cannot list the documents in the middle.  The tree looks like</p>\n\n<pre><code>/TimeEntries/2018/2018-10/2018-10-15/Events\n/TimeEntries/2018/2018-10/2018-10-22/Events\n</code></pre>\n\n<p>In the above, <code>2018</code> is a document, <code>2018-10</code> is a subcollection, and <code>2018-10-15</code> and <code>2018-10-22</code> are documents with <code>Events</code> subcollections.</p>\n\n<p>This is made with something like</p>\n\n<pre><code>func SaveEvents(week time.Time, events []Event) {\n    colref := client.Collection(\"TimeEntries\").Doc(week.Format(\"2006\")).Collection(week.Format(\"2006-01\")).Doc(week.Format(\"2006-01-02\")).Collection(\"Events\")\n    batch := client.Batch()\n\n    for _, event := range events {\n        batch.Set(colref.Doc(strconv.Itoa(event.Id)), event)\n    }\n    if _, err := batch.Commit(context.Background()); err != nil {\n        log.Fatalf(\"unable to create event docs: %v\", err)\n    }\n}\n</code></pre>\n\n<p>There are times when I'll want events by week and events by month.  I can fetch events by week right now, but to fetch events by month I have to fetch the list of documents in the middle of the tree, and then get their subcollections' documents.  Unfortunately, trying to list the documents in the middle of the tree doesn't work; this always logs <code>0 events</code>:</p>\n\n<pre><code>func FetchEventsForMonth(week time.Time) {\n    colref := client.Collection(\"TimeEntries\").Doc(week.Format(\"2006\")).Collection(week.Format(\"2006-01\"))\n\n    snaps, err := colref.Documents(context.Background()).GetAll()\n    if err != nil {\n        log.Printf(\"cannot fetch docs: %v\", err)\n        return\n    }\n\n    log.Printf(\"%d events\", len(snaps))\n}\n</code></pre>\n\n<p>I can't see anything in the documentation that explains this behavior.  What am I missing?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1540974181, "post_id": 53078974, "comment_id": 93055437, "body": "From: <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/json/#Unmarshal</a> &quot;To unmarshal JSON into a struct, Unmarshal matches incoming object keys to the keys used by Marshal (either the struct field name or its tag), preferring an exact match but also accepting a case-insensitive match.&quot; You should read the full documentation first. Then you should do an experiment, e.g .by modifying the provided examples. Then ask."}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 5, "last_activity_date": 1540975062, "last_edit_date": 1592644375, "creation_date": 1540974457, "answer_id": 53079131, "question_id": 53078974, "link": "https://stackoverflow.com/questions/53078974/does-the-case-of-the-json-field-name-matters-while-doing-marshal-and-unmarshal/53079131#53079131", "title": "Does the case of the JSON field name matters while doing Marshal and Unmarshal?", "body": "<p>This is easily answered by <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\">reading the docs</a>, or with a simple test.  But specifically, see these notes (emphasis added) for <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\">Marshal</a>:</p>\n<blockquote>\n<p>Struct values encode as JSON objects. Each exported struct field becomes a member of the object, <strong>using the field name as the object key</strong>, unless the field is omitted for one of the reasons given below.</p>\n<p>The encoding of each struct field can be customized by the format string stored under the &quot;json&quot; key in the struct field's tag. <strong>The format string gives the name of the field</strong>, possibly followed by a comma-separated list of options. The name may be empty in order to specify options without overriding the default field name.</p>\n</blockquote>\n<p>and <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\">Unmarshal</a>:</p>\n<blockquote>\n<p>To unmarshal JSON into a struct, Unmarshal matches incoming object keys to the keys used by Marshal (either the struct field name or its tag), <strong>preferring an exact match but also accepting a case-insensitive match</strong>. By default, object keys which don't have a corresponding struct field are ignored (see Decoder.DisallowUnknownFields for an alternative).</p>\n</blockquote>\n<p>So TL;DR; for marshaling, case is observed exactly, and for unmarshaling, exact case is preferred with a fallback to a case-insensitive match.</p>\n"}], "owner": {"reputation": 203, "user_id": 7919991, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c67ec46250dd36b37af6c51f7ee6c899?s=128&d=identicon&r=PG&f=1", "display_name": "nihal", "link": "https://stackoverflow.com/users/7919991/nihal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1599637102, "creation_date": 1540973778, "last_edit_date": 1599637102, "question_id": 53078974, "link": "https://stackoverflow.com/questions/53078974/does-the-case-of-the-json-field-name-matters-while-doing-marshal-and-unmarshal", "title": "Does the case of the JSON field name matters while doing Marshal and Unmarshal?", "body": "<p>Are Marshal and Unmarshal functions strictly case sensitive?</p>\n<p>The following structure defines a ticket:</p>\n<pre><code>    type TicketInfo struct {\n         TicketKey                  string `json:&quot;ticketKey&quot;`       \n         Ticketextnum               string `json:&quot;ticketextnum&quot;`        \n         TicketDate                 string `json:&quot;ticketDate&quot;`      \n         TicketDesc                 string `json:&quot;ticketDesc&quot;`\n    }       \n</code></pre>\n<p>This stringified form of this json will be passed as a single parameter in the payload of an API call by the source systems. What will happen if the source system sends, for example, &quot;TicketKey&quot; instead of &quot;ticketKey&quot; for the first field. Will json.Marshal correctly received the ticketKey field?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1540971445, "post_id": 53078228, "comment_id": 93054237, "body": "Your code is unrelated to JSON. What is the actual question. map[string]map[string].. might or might not be the best data structure for a problem. You did not state the problem. Can you clarify?"}, {"owner": {"reputation": 886, "user_id": 1619524, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b4c576b8a343b40cd00f38be1513a92d?s=128&d=identicon&r=PG", "display_name": "user1619524", "link": "https://stackoverflow.com/users/1619524/user1619524"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1540971507, "post_id": 53078228, "comment_id": 93054259, "body": "I seek alternative to using map[string]map[string]map[string]map[string]string"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1540972226, "post_id": 53078228, "comment_id": 93054561, "body": "The code you showed can be simplified by using a simple string literal. You really have to describe the problem in more detail."}], "answers": [{"comments": [{"owner": {"reputation": 886, "user_id": 1619524, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b4c576b8a343b40cd00f38be1513a92d?s=128&d=identicon&r=PG", "display_name": "user1619524", "link": "https://stackoverflow.com/users/1619524/user1619524"}, "edited": false, "score": 0, "creation_date": 1540971244, "post_id": 53078314, "comment_id": 93054152, "body": "can you please post a full example, i can&#39;t compile with map[string]interface{}, thanks a lot."}, {"owner": {"reputation": 886, "user_id": 1619524, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b4c576b8a343b40cd00f38be1513a92d?s=128&d=identicon&r=PG", "display_name": "user1619524", "link": "https://stackoverflow.com/users/1619524/user1619524"}, "edited": false, "score": 1, "creation_date": 1540973561, "post_id": 53078314, "comment_id": 93055146, "body": "Thank you so much Henry"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1540975222, "post_id": 53078314, "comment_id": 93055913, "body": "To represent arbitrary JSON, <a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow noreferrer\">json.RawMessage</a> or <code>map[string]json.RawMessage</code> is more efficient than the empty interface and can still be unmarshaled later into concrete types."}], "tags": [], "owner": {"reputation": 9542, "user_id": 8068625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4spqa.png?s=128&g=1", "display_name": "Henry Woody", "link": "https://stackoverflow.com/users/8068625/henry-woody"}, "is_accepted": true, "score": 0, "last_activity_date": 1540973197, "last_edit_date": 1540973197, "creation_date": 1540970898, "answer_id": 53078314, "question_id": 53078228, "link": "https://stackoverflow.com/questions/53078228/is-there-a-better-way-to-declare-json-variable/53078314#53078314", "title": "Is there a better way to declare json variable", "body": "<p>The simplest way would be to use the type <code>map[string]interface{}</code>. Since the empty interface, <code>interface{}</code>, refers to any type and therefore handles the arbitrarily nested nature of JSON.</p>\n\n<p>To do this you'll have to write your literal data as a string first and then parse the string into a Go <code>map</code>.</p>\n\n<p>With that in mind here is a refactor of your example:</p>\n\n<p>first: <code>import \"encoding/json\"</code>, then</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>snapsStr := `{\n    \"distros\": {\n        \"aws\": {\n            \"eu-west-1\" : {\n                \"snap-0\": \"/dev/sdm\"\n            },\n            \"eu-west-2\": {\n                \"snap-1\": \"/dev/sdm\"\n            }\n        }\n    }\n}`\n\nvar snaps map[string]interface{}\n\njson.Unmarshal([]byte(snapsStr), &amp;snaps)\n</code></pre>\n\n<p>And now <code>snaps</code> is as desired.</p>\n\n<p>This is the most generic format for JSON data in Go and is one of the ways that the Go JSON library handles types for JSON. See these docs: <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\">https://golang.org/pkg/encoding/json/#Unmarshal</a></p>\n"}], "owner": {"reputation": 886, "user_id": 1619524, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b4c576b8a343b40cd00f38be1513a92d?s=128&d=identicon&r=PG", "display_name": "user1619524", "link": "https://stackoverflow.com/users/1619524/user1619524"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 53078314, "answer_count": 1, "score": -3, "last_activity_date": 1540973197, "creation_date": 1540970566, "question_id": 53078228, "link": "https://stackoverflow.com/questions/53078228/is-there-a-better-way-to-declare-json-variable", "title": "Is there a better way to declare json variable", "body": "<p>Declaring a variable of type map[string]map[string]... is not ideal, is there a better way</p>\n\n<pre><code>    snaps := map[string]map[string]map[string]map[string]string{\n    \"distros\": {\n        \"aws\": {\n            \"eu-west-1\": {\n                \"snap-0\": \"/dev/sdm\",\n            },\n            \"eu-west-2\": {\n                \"snap-1\": \"/dev/sdm\",\n            },\n        },\n    },\n}\n\nfmt.Println(snaps[\"distros\"][\"aws\"][\"eu-west-1\"])\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 4, "creation_date": 1540967484, "post_id": 53077442, "comment_id": 93052670, "body": "Don&#39;t ignore the error returned by <code>LoadLocation</code>."}, {"owner": {"reputation": 43, "user_id": 10544250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d3a5e7589914ba517a86b0afead9e72?s=128&d=identicon&r=PG&f=1", "display_name": "Doe", "link": "https://stackoverflow.com/users/10544250/doe"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1540967609, "post_id": 53077442, "comment_id": 93052712, "body": "@peter can you explain how i resolve it"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1540967865, "post_id": 53077442, "comment_id": 93052811, "body": "@Doe, by inspecting the error. Ignoring errors is a waste of time. Don&#39;t do it."}, {"owner": {"reputation": 43, "user_id": 10544250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d3a5e7589914ba517a86b0afead9e72?s=128&d=identicon&r=PG&f=1", "display_name": "Doe", "link": "https://stackoverflow.com/users/10544250/doe"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1540969149, "post_id": 53077442, "comment_id": 93053298, "body": "@peter okay I will take care of this :)"}, {"owner": {"reputation": 839, "user_id": 851428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22296c67ba443c0bad5cefbe5e83a3e0?s=128&d=identicon&r=PG", "display_name": "luismartingil", "link": "https://stackoverflow.com/users/851428/luismartingil"}, "edited": false, "score": 0, "creation_date": 1583228274, "post_id": 53077442, "comment_id": 107036291, "body": "Using this library <a href=\"https://godoc.org/4d63.com/tz\" rel=\"nofollow noreferrer\">godoc.org/4d63.com/tz</a>"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10544250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d3a5e7589914ba517a86b0afead9e72?s=128&d=identicon&r=PG&f=1", "display_name": "Doe", "link": "https://stackoverflow.com/users/10544250/doe"}, "edited": false, "score": 0, "creation_date": 1540967847, "post_id": 53077574, "comment_id": 93052804, "body": "thanks for this it resolve my problem omg its mistake of timeZone string I&#39;m giving Thankyou for your precious time"}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 3, "last_activity_date": 1540968224, "last_edit_date": 1540968224, "creation_date": 1540967590, "answer_id": 53077574, "question_id": 53077442, "link": "https://stackoverflow.com/questions/53077442/how-to-solve-the-error-of-the-missing-location-in-call-to-date-in-golang/53077574#53077574", "title": "How to solve the error of the &quot;missing Location in call to Date&quot; in golang", "body": "<p>It should be <code>America/Phoenix</code>, not <code>America/Pheonix</code>.</p>\n\n<pre><code>timeZone, _ := time.LoadLocation(\"America/Phoenix\")\n</code></pre>\n\n<p>For more information about list of available time zones string, please see: <a href=\"https://golang.org/src/time/zoneinfo_abbrs_windows.go\" rel=\"nofollow noreferrer\">https://golang.org/src/time/zoneinfo_abbrs_windows.go</a></p>\n"}], "owner": {"reputation": 43, "user_id": 10544250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d3a5e7589914ba517a86b0afead9e72?s=128&d=identicon&r=PG&f=1", "display_name": "Doe", "link": "https://stackoverflow.com/users/10544250/doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3882, "favorite_count": 0, "closed_date": 1540984821, "accepted_answer_id": 53077574, "answer_count": 1, "score": -1, "last_activity_date": 1540968224, "creation_date": 1540967016, "last_edit_date": 1540967698, "question_id": 53077442, "link": "https://stackoverflow.com/questions/53077442/how-to-solve-the-error-of-the-missing-location-in-call-to-date-in-golang", "closed_reason": "Not suitable for this site", "title": "How to solve the error of the &quot;missing Location in call to Date&quot; in golang", "body": "<p>I have written a golang program to generate the start date and end date of the month for different locations </p>\n\n<pre><code>if month != \"\" &amp;&amp; year != \"\" {\n    var monthInt, _ = strconv.Atoi(month)\n    var yearInt, _ = strconv.Atoi(year)\n    timeZone, err := time.LoadLocation(\"America/Pheonix\")\n    if err != nil {\n        fmt.Println(err)// nil\n    }\n    // currentLocation := time.Now().Location(timeZone) // when I use this it will works \n    // both are of same type \n    fmt.Println(reflect.TypeOf(timeZone))\n    fmt.Println(reflect.TypeOf(time.UTC))\n    firstOfMonth := time.Date(yearInt, time.Month(monthInt), 1, 0, 0, 0, 0, timeZone)\n    onlyStartDate := strings.Split(firstOfMonth.Format(\"2006-01-02 00:00:00 -0000\"), \" \")\n    lastOfMonth := firstOfMonth.AddDate(0, 1, -1).Format(\"2006-01-02 00:00:00 -0000\")\n    onlyLastDate := strings.Split(lastOfMonth, \" \")\n    merchantDb.GetProvidersOfTheMonth(onlyStartDate[0], onlyLastDate[0])\n}\n</code></pre>\n\n<p>But when I run this code it will give me the error of the:-</p>\n\n<blockquote>\n  <p>time: missing Location in call to Date</p>\n</blockquote>\n\n<p>Why this error is generating and how I will solve this error?</p>\n\n<p>Please any suggestions!</p>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1540966645, "post_id": 53077067, "comment_id": 93052328, "body": "You gave the answer as a tag: Use reflection. It is not trivial. XY problem? Redesign?"}, {"owner": {"reputation": 2960, "user_id": 3521243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EJDD8.jpg?s=128&g=1", "display_name": "Emile Pels", "link": "https://stackoverflow.com/users/3521243/emile-pels"}, "edited": false, "score": 1, "creation_date": 1540968454, "post_id": 53077067, "comment_id": 93053043, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/23507033/golang-reflection-get-tag-from-struct-field\">Golang Reflection: Get Tag from struct field</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 0, "last_activity_date": 1540968842, "creation_date": 1540968842, "answer_id": 53077849, "question_id": 53077067, "link": "https://stackoverflow.com/questions/53077067/how-to-print-tag-for-slice-of-struct-within-a-struct/53077849#53077849", "title": "How to print tag for slice of struct within a struct", "body": "<p>Create new variable using <code>AnotherStruct</code>, then by using reflect try to get the <code>Bank</code> field, after that you'll be able to get it's tag.</p>\n\n<pre><code>// new object created from struct AnotherStruct\nobj := AnotherStruct{}\n\n// getting `Bank` field information. \n// the `FieldByName` function return two variables, \n// 1. the field data \n// 2. a boolean data, determines whether field is exists or not\nbankField, ok := reflect.TypeOf(obj).FieldByName(\"Bank\")\nif ok {\n    // if the field is exists, then get the desired tag\n    jsonTagValue := bankField.Tag.Get(\"json\")\n    fmt.Println(jsonTagValue) // bank\n}\n</code></pre>\n\n<p>Working playground: <a href=\"https://play.golang.org/p/TJDCEVm23Hz\" rel=\"nofollow noreferrer\">https://play.golang.org/p/TJDCEVm23Hz</a></p>\n"}], "owner": {"reputation": 13, "user_id": 10110504, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kL0CAwRk_Xw/AAAAAAAAAAI/AAAAAAAAClc/biJ5mU7JBq0/photo.jpg?sz=128", "display_name": "Prashant Gupta", "link": "https://stackoverflow.com/users/10110504/prashant-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 1, "accepted_answer_id": 53077849, "answer_count": 1, "score": -1, "last_activity_date": 1540974512, "creation_date": 1540964964, "last_edit_date": 1540974512, "question_id": 53077067, "link": "https://stackoverflow.com/questions/53077067/how-to-print-tag-for-slice-of-struct-within-a-struct", "title": "How to print tag for slice of struct within a struct", "body": "<p>I have struct Config which consist of Field <strong>SliceOfAnotherStruct</strong> which contained the slice of pointer to\n<strong>AnotherStruct</strong>.</p>\n\n<p>Here how could I get the json tag for field Bank in AnotherStruct.</p>\n\n<pre><code>type Config struct {\n    SliceOfAnotherStruct         []*AnotherStruct        `bson:\"anotherStruct\" json:\"anotherStruct\" validate:\"required,dive,required\"`\n}\n\ntype AnotherStruct struct {\n    Name                   string        `bson:\"name\" json:\"name\" validate:\"required\"`\n    Cost                   string        `bson:\"cost\" json:\"cost\" validate:\"required\"`\n    Bank    string        `bson:\"bank\" json:\"bank\" validate:\"required\"`\n    IFSC     string        `bson:\"ifsc\" json:\"ifsc\" validate:\"required\"`\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1540966531, "post_id": 53077011, "comment_id": 93052290, "body": "&quot;If I need to benchmark only the init() method&quot;. No you don&#39;t. And you cannot. And you should not. init functions are a way of doing one-time setup work. One-time work <i>cannot</i> be benchmarked reliably. If you have two different ways of doing this work: Write two functions, benchmark them and call the faster one in init. Done. Trying to benchmark init by itself is <i>wrong</i>."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1540966556, "post_id": 53077011, "comment_id": 93052299, "body": "You worry about a function that runs exactly once and takes a few microseconds? Really? Then you have to move your code into a new function, call it from init, and benchmark that new function."}], "answers": [{"tags": [], "owner": {"reputation": 148, "user_id": 7263440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b16f456d714f65cb780cee9a87dc0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan N", "link": "https://stackoverflow.com/users/7263440/dan-n"}, "is_accepted": false, "score": 4, "last_activity_date": 1540998453, "last_edit_date": 1540998453, "creation_date": 1540966097, "answer_id": 53077254, "question_id": 53077011, "link": "https://stackoverflow.com/questions/53077011/how-to-benchmark-init-function/53077254#53077254", "title": "How to benchmark init() function", "body": "<p>Yes there can be multiple <code>init()</code>'s in a package, in-fact you can have multiple <code>init()</code>'s in a file. More information about init can be found <a href=\"https://golang.org/doc/effective_go.html#init\" rel=\"nofollow noreferrer\">here</a>. Remember that <code>init()</code> is automatically called one time before your program's <code>main()</code> is even started.</p>\n\n<p>The benchmark framework runs your code multiple times (in your case 100000). This allows it to measure very short functions, as well as very long functions. It doesn't make sense for benchmark to include the time for <code>init()</code>. The problem you are having is that you are not understanding the purpose of benchmarking. Benchmarking lets you compare two or more separate implementations to determine which one is faster (also you can compare performance based on input of the same function). It does not tell you where you should be doing that.</p>\n\n<p>What you are basically doing is known as <a href=\"http://wiki.c2.com/?PrematureOptimization\" rel=\"nofollow noreferrer\">Premature Optimization</a>. It's where you start optimizing code trying to make it as fast as possible, without knowing where your program actually spends most of its time. <a href=\"https://en.wikipedia.org/wiki/Profiling_(computer_programming)\" rel=\"nofollow noreferrer\">Profiling</a> is the process of measuring the time and space complexity of a program. In practice, it allows you to see where your program is spending most of its time. Using that information, you can write more efficient functions. More information about profiling in go can be found in this <a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">blog post</a>. </p>\n"}], "owner": {"reputation": 432, "user_id": 6340231, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mHxBsfkZqiQ/AAAAAAAAAAI/AAAAAAAAAtU/ToLwyfBT1HM/photo.jpg?sz=128", "display_name": "Abhay Kumar", "link": "https://stackoverflow.com/users/6340231/abhay-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1540998453, "creation_date": 1540964685, "question_id": 53077011, "link": "https://stackoverflow.com/questions/53077011/how-to-benchmark-init-function", "title": "How to benchmark init() function", "body": "<p>I was playing with following Go code which calculates Population count using lookup table:</p>\n\n<pre><code>package population\n\nimport (\n        \"fmt\"\n)\n\nvar pc [256]byte\n\nfunc init(){\n        for i := range pc {\n                pc[i] = pc[i/2] + byte(i&amp;1)\n        }\n}\n\nfunc countPopulation() {\n        var x uint64 = 65535\n        populationCount := int(pc[byte(x&gt;&gt;(0*8))] +\n                pc[byte(x&gt;&gt;(1*8))] +\n                pc[byte(x&gt;&gt;(2*8))] +\n                pc[byte(x&gt;&gt;(3*8))] +\n                pc[byte(x&gt;&gt;(4*8))] +\n                pc[byte(x&gt;&gt;(5*8))] +\n                pc[byte(x&gt;&gt;(6*8))] +\n                pc[byte(x&gt;&gt;(7*8))])\n\n        fmt.Printf(\"Population count: %d\\n\", populationCount)\n}\n</code></pre>\n\n<p>I have written following benchmark code to check performance of above code block:</p>\n\n<pre><code>package population\n\nimport \"testing\"\n\nfunc BenchmarkCountPopulation(b *testing.B) {\n        for i := 0; i &lt; b.N; i++ {\n                countPopulation()\n        }\n}\n</code></pre>\n\n<p>Which gave me following result:</p>\n\n<pre><code>100000             18760 ns/op\nPASS\nok      gopl.io/ch2     2.055s\n</code></pre>\n\n<p>Then I moved the code from <code>init()</code> function to the <code>countPopulation()</code> function as below:</p>\n\n<pre><code>func countPopulation() {\n        var pc [256]byte\n\n        for i := range pc {\n                pc[i] = pc[i/2] + byte(i&amp;1)\n        }\n\n        var x uint64 = 65535\n        populationCount := int(pc[byte(x&gt;&gt;(0*8))] +\n                pc[byte(x&gt;&gt;(1*8))] +\n                pc[byte(x&gt;&gt;(2*8))] +\n                pc[byte(x&gt;&gt;(3*8))] +\n                pc[byte(x&gt;&gt;(4*8))] +\n                pc[byte(x&gt;&gt;(5*8))] +\n                pc[byte(x&gt;&gt;(6*8))] +\n                pc[byte(x&gt;&gt;(7*8))])\n\n        fmt.Printf(\"Population count: %d\\n\", populationCount)\n}\n</code></pre>\n\n<p>and once again ran the same benchmark code, which gave me following result:</p>\n\n<pre><code>100000             20565 ns/op\nPASS\nok      gopl.io/ch2     2.303s\n</code></pre>\n\n<p>After observing both the results it is clear that <code>init()</code> function is not in the scope of benchmark function. That's why first benchmark execution took lesser time compared to second execution.</p>\n\n<p>Now I have another question which I am looking to get answer for.</p>\n\n<p><strong>If I need to benchmark only the <code>init()</code> method, considering there can be multiple <code>init()</code> functions in a package. How is it done in <code>golang</code>?</strong></p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["go", "time"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1540960961, "post_id": 53076290, "comment_id": 93050672, "body": "The current month&#39;s start is the 1. which is true for any month. The current mont&#39;s end day is one of 28, 29, 30 or 31. Which of these is determined by the current month and the year. Stop trying to do &quot;clever&quot; date manipulations (Add, Sub, ...)  as these do not work."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1540967392, "post_id": 53076290, "comment_id": 93052635, "body": "A word of caution: &quot;beginning and end of the year&quot; isn&#39;t an easy thing for not-so-recent years: <a href=\"https://en.m.wikipedia.org/wiki/Gregorian_calendar#Beginning_of_the_year\" rel=\"nofollow noreferrer\">en.m.wikipedia.org/wiki/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10544250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d3a5e7589914ba517a86b0afead9e72?s=128&d=identicon&r=PG&f=1", "display_name": "Doe", "link": "https://stackoverflow.com/users/10544250/doe"}, "edited": false, "score": 0, "creation_date": 1540963079, "post_id": 53076606, "comment_id": 93051166, "body": "But in my code the month will be taken in int is there some stuff for it converting the month into time?"}], "tags": [], "owner": {"reputation": 470, "user_id": 9219620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7bddbf0c416e48b5224e84c43caf022?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet", "link": "https://stackoverflow.com/users/9219620/puneet"}, "is_accepted": false, "score": 0, "last_activity_date": 1540963253, "last_edit_date": 1540963253, "creation_date": 1540962207, "answer_id": 53076606, "question_id": 53076290, "link": "https://stackoverflow.com/questions/53076290/how-to-get-the-start-date-and-end-date-of-current-month-using-golang/53076606#53076606", "title": "How to get the start date and end date of current month using golang?", "body": "<p>Umm You have to just see the below code I have written for you and just read the comments and learn it. By taking the reference of <a href=\"https://stackoverflow.com/questions/36830212/get-the-first-and-last-day-of-current-month-in-go-golang\">this</a> and  <a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\">this time package in golang</a>:</p>\n\n<pre><code>package main\n\nimport (\n \"fmt\"\n \"strings\"\n \"time\"\n)\n\nfunc main() {\n var year int\n year = 2019\n currentLocation := time.Now().Location() // got current location\n if year != 0 {\n    firstOfMonth := time.Date(year, time.February, 1, 0, 0, 0, 0, currentLocation) // first date of the month\n    fmt.Println(firstOfMonth)\n    lastOfMonth := firstOfMonth.AddDate(0, 1, -1).Format(\"2006-01-02 00:00:00 -0000\") // last date of the month \n    fmt.Println(lastOfMonth)\n    onlyDate := strings.Split(lastOfMonth, \" \")\n    fmt.Println(onlyDate[0])\n } \n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/rWqZzYLY4t9\" rel=\"nofollow noreferrer\">go playground link</a></p>\n\n<p><strong>Edited</strong></p>\n\n<pre><code>package main\n\nimport (\n \"fmt\"\n \"time\"\n)\n\nfunc main() {\n month := 1\n fmt.Println(time.Month(month))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/QcqsQPdkatP\" rel=\"nofollow noreferrer\">converting int month into time link playground</a></p>\n\n<p>Hope it will help you:).</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1540966693, "last_edit_date": 1540966693, "creation_date": 1540963830, "answer_id": 53076887, "question_id": 53076290, "link": "https://stackoverflow.com/questions/53076290/how-to-get-the-start-date-and-end-date-of-current-month-using-golang/53076887#53076887", "title": "How to get the start date and end date of current month using golang?", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc monthInterval(y int, m time.Month) (firstDay, lastDay time.Time) {\n    firstDay = time.Date(y, m, 1, 0, 0, 0, 0, time.UTC)\n    lastDay = time.Date(y, m+1, 1, 0, 0, 0, -1, time.UTC)\n    return firstDay, lastDay\n}\n\nfunc main() {\n    var (\n        y int\n        m time.Month\n    )\n\n    y, m, _ = time.Now().Date()\n    first, last := monthInterval(y, m)\n    fmt.Println(first.Format(\"2006-01-02\"))\n    fmt.Println(last.Format(\"2006-01-02\"))\n\n    y, m = 2018, time.Month(2)\n    first, last = monthInterval(y, m)\n    fmt.Println(first.Format(\"2006-01-02\"))\n    fmt.Println(last.Format(\"2006-01-02\"))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2018-10-01\n2018-10-31\n2018-02-01\n2018-02-28\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/TkzCo9jLpZR\" rel=\"nofollow noreferrer\">https://play.golang.org/p/TkzCo9jLpZR</a></p>\n"}, {"tags": [], "owner": {"reputation": 78, "user_id": 10567252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sZyTZ.jpg?s=128&g=1", "display_name": "Praveen Raj", "link": "https://stackoverflow.com/users/10567252/praveen-raj"}, "is_accepted": false, "score": 1, "last_activity_date": 1540973378, "last_edit_date": 1592644375, "creation_date": 1540973378, "answer_id": 53078891, "question_id": 53076290, "link": "https://stackoverflow.com/questions/53076290/how-to-get-the-start-date-and-end-date-of-current-month-using-golang/53078891#53078891", "title": "How to get the start date and end date of current month using golang?", "body": "<p>You can do with <a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\">time package in golang</a> itself.</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;time&quot;\n)\n\nfunc main() {\n    t := time.Now()\n    fmt.Println(BeginningOfMonth(t))\n    fmt.Println(EndOfMonth(t))\n\n    // If you need only date use Format(). But remember Format() will return as a string\n    dateFormat := &quot;2006-01-02&quot;\n    fmt.Println(BeginningOfMonth(t).Format(dateFormat))\n    fmt.Println(EndOfMonth(t).Format(dateFormat))\n}\n\nfunc BeginningOfMonth(t time.Time) time.Time {\n    return time.Date(t.Year(), t.Month(), 1, 0, 0, 0, 0, t.Location())\n}\n\nfunc EndOfMonth(t time.Time) time.Time {\n    return BeginningOfMonth(t).AddDate(0, 1, 0).Add(-time.Second)\n}\n</code></pre>\n<p><strong>Output:</strong></p>\n<blockquote>\n<p>2018-10-01 00:00:00 +0530 IST</p>\n<p>2018-10-31 23:59:59 +0530 IST</p>\n<p>2018-10-01</p>\n<p>2018-10-31</p>\n</blockquote>\n"}], "owner": {"reputation": 43, "user_id": 10544250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d3a5e7589914ba517a86b0afead9e72?s=128&d=identicon&r=PG&f=1", "display_name": "Doe", "link": "https://stackoverflow.com/users/10544250/doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4709, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1540973378, "creation_date": 1540959974, "question_id": 53076290, "link": "https://stackoverflow.com/questions/53076290/how-to-get-the-start-date-and-end-date-of-current-month-using-golang", "title": "How to get the start date and end date of current month using golang?", "body": "<p>I want to make a simple program of golang which only tell me the current month start date and and month's end date. There is also a condition in this is that if the user will entered the month and year then it will give me the start date and end date of that year and month. For this I have tried the below program but it will not giving me the right results:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"time\"\n)\n\nfunc main() {\n  var year int\n  var month int\n  year = 2018\n  month = 1\n  if year != 0 &amp;&amp; month != 0 {\n     t2 := time.Now().AddDate(year, month, 0)\n    fmt.Println(t2)\n  } else {\n    t2 := time.Now().AddDate(0, 0, 0)\n    fmt.Println(t2)\n }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/bcE3EWru_NV\" rel=\"nofollow noreferrer\">go playground link</a></p>\n\n<p>Can any body tell me how I will correct the program.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["sqlite", "go"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1540962089, "post_id": 53075959, "comment_id": 93050920, "body": "What you <i>should</i> be looking into is if go&#39;s sqlite bindings support the <a href=\"https://www.sqlite.org/backup.html\" rel=\"nofollow noreferrer\">backup API</a>. WAL mode is completely meaningless for in memory databases and isn&#39;t a backup mechanism anyways."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1540967748, "post_id": 53075959, "comment_id": 93052770, "body": "If you want the database on disk, why do you use an in-memory connection to begin with?"}, {"owner": {"reputation": 2776, "user_id": 1987437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/508e14a7e9414311eff04b2fd8d20ed6?s=128&d=identicon&r=PG", "display_name": "Liam Kelly", "link": "https://stackoverflow.com/users/1987437/liam-kelly"}, "edited": false, "score": 0, "creation_date": 1616417030, "post_id": 53075959, "comment_id": 117987076, "body": "@gyuaisdfaasf what did you end up using out of curiosity?"}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 1, "last_activity_date": 1540995410, "last_edit_date": 1540995410, "creation_date": 1540994733, "answer_id": 53085310, "question_id": 53075959, "link": "https://stackoverflow.com/questions/53075959/how-to-save-in-memory-sqlite-to-disk-periodically/53085310#53085310", "title": "How to save in-memory sqlite to disk periodically", "body": "<p>Maybe you can issue the <a href=\"https://www.sqlite.org/cli.html#converting_an_entire_database_to_an_ascii_text_file\" rel=\"nofollow noreferrer\"><code>.dump</code> command</a> and store the results in a file?</p>\n\n<p>It looks like <a href=\"https://github.com/schollz/sqlite3dump\" rel=\"nofollow noreferrer\">schollz/sqlite3dump</a> may do exactly what you want.</p>\n"}], "owner": {"reputation": 329, "user_id": 9437085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZbW0.jpg?s=128&g=1", "display_name": "gyuaisdfaasf", "link": "https://stackoverflow.com/users/9437085/gyuaisdfaasf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 749, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1540995410, "creation_date": 1540957416, "last_edit_date": 1540978022, "question_id": 53075959, "link": "https://stackoverflow.com/questions/53075959/how-to-save-in-memory-sqlite-to-disk-periodically", "title": "How to save in-memory sqlite to disk periodically", "body": "<p>I have a program using sqlite as in-memory db and I would like to save the database to disk periodically. I saw <a href=\"https://www.sqlite.org/wal.html\" rel=\"nofollow noreferrer\">this</a> on the sqlite documentation site and I wonder if there are go APIs for such task.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1540969877, "post_id": 53075597, "comment_id": 93053582, "body": "Hi @CarsonS5, which MongoDB Go driver are you using ? Also, which MongoDB version are you using ? You can try to use <a href=\"https://docs.mongodb.com/manual/reference/operator/query/elemMatch/#array-of-embedded-documents\" rel=\"nofollow noreferrer\">$elemMatch: array of embedded documents</a> to query."}, {"owner": {"reputation": 57, "user_id": 10583586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nbpXq.png?s=128&g=1", "display_name": "CarsonS5", "link": "https://stackoverflow.com/users/10583586/carsons5"}, "reply_to_user": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1540987309, "post_id": 53075597, "comment_id": 93062499, "body": "@WanBachtiar I am using the mgo.v2 driver with the latest version of MongoDB installed. I&#39;ve looked at the link you&#39;ve provided, but I want to check just within a specific document. So, if player Y wants to join game X check game X for any other entries of player Y&#39;s username."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10583586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nbpXq.png?s=128&g=1", "display_name": "CarsonS5", "link": "https://stackoverflow.com/users/10583586/carsons5"}, "edited": false, "score": 0, "creation_date": 1540987694, "post_id": 53080283, "comment_id": 93062703, "body": "That is what I have tried to do, however I want to search a specific document in the DB, not all of them.   So I want to find if there is another player with the same username in a specific game."}, {"owner": {"reputation": 637, "user_id": 9770810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe00ad674db2d0f1241736a6925005d?s=128&d=identicon&r=PG&f=1", "display_name": "Senthur Deva", "link": "https://stackoverflow.com/users/9770810/senthur-deva"}, "reply_to_user": {"reputation": 57, "user_id": 10583586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nbpXq.png?s=128&g=1", "display_name": "CarsonS5", "link": "https://stackoverflow.com/users/10583586/carsons5"}, "edited": false, "score": 0, "creation_date": 1540988247, "post_id": 53080283, "comment_id": 93062993, "body": "check my edited answer, Now you can find a particular game and player is already exists or not."}], "tags": [], "owner": {"reputation": 637, "user_id": 9770810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe00ad674db2d0f1241736a6925005d?s=128&d=identicon&r=PG&f=1", "display_name": "Senthur Deva", "link": "https://stackoverflow.com/users/9770810/senthur-deva"}, "is_accepted": true, "score": 0, "last_activity_date": 1540988153, "last_edit_date": 1540988153, "creation_date": 1540978530, "answer_id": 53080283, "question_id": 53075597, "link": "https://stackoverflow.com/questions/53075597/check-for-duplicates-in-an-array-of-objects-in-golang-with-mongodb/53080283#53080283", "title": "Check for duplicates in an array of objects in Golang with MongoDB", "body": "<p>You can use <a href=\"https://docs.mongodb.com/manual/reference/operator/query/elemMatch/#array-of-embedded-documents\" rel=\"nofollow noreferrer\">$elemMatch</a></p>\n\n<pre><code>collection.Find(bson.M{\"gamecode\": entry.GameCode},bson.M{\"players\": bson.M{\"$elemMatch\": bson.M{\"playerid\": playerid}}}).Limit(1).Count()\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10583586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nbpXq.png?s=128&g=1", "display_name": "CarsonS5", "link": "https://stackoverflow.com/users/10583586/carsons5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1049, "favorite_count": 0, "accepted_answer_id": 53080283, "answer_count": 1, "score": 2, "last_activity_date": 1540988153, "creation_date": 1540954303, "last_edit_date": 1540987583, "question_id": 53075597, "link": "https://stackoverflow.com/questions/53075597/check-for-duplicates-in-an-array-of-objects-in-golang-with-mongodb", "title": "Check for duplicates in an array of objects in Golang with MongoDB", "body": "<p>I need to find duplicate entries of a specific value in an array of objects in a Mongo database. My structure looks something like this:</p>\n\n<pre><code>type gameTemplate struct {\nID       bson.ObjectId `bson:\"_id\" json:\"id\"`\nGameCode string        `bson:\"gamecode\" json:\"gamecode\"`\nPlayers  []player      `bson:\"players\" json:\"players\"`\n}\n\ntype player struct {\nPlayerID bson.ObjectId `bson:\"playerid\" json:\"playerid\"`\nUsername string        `bson:\"username\" json:\"username\"`\n}\n</code></pre>\n\n<p>If a new player is joining the game, I want to check to make sure their username is not taken. I used this method for checking for duplicate game codes (if <code>count</code> is greater than 1, I know there's a game that exists):</p>\n\n<pre><code>count, err := collection.Find(bson.M{\"gamecode\": entry.GameCode}).Limit(1).Count()\n</code></pre>\n\n<p>Which works well, but obviously won't work to check the <code>username</code> value of an object in the array of players. I am thinking I would have to do something along the lines of checking the size of the array and iterating through each option to find a duplicate, but I haven't had any sort of success.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I am running the latest version of MongoDB and am using the mgo.v2 driver for go. The flow of what I am trying to achieve looks something like this:</p>\n\n<blockquote>\n  <p>Player Y wants to join game X. Game X can only have a single instance of a 'username', but that same username can be present in other games.</p>\n</blockquote>\n"}, {"tags": ["go", "math"], "comments": [{"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 1, "creation_date": 1540959270, "post_id": 53074737, "comment_id": 93050271, "body": "To trouble-shoot something like this you could look at each part of you calculation and see if it gives you the expected result, quickly you would come to <code>1 &#47; 30</code> giving you zero."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1540961159, "post_id": 53074737, "comment_id": 93050719, "body": "Note that the best approximation to a real number (for whatever reals you like) in Go are mathh/big.Float and the next less accurate are float64s which you used. But <i>never</i> think of them as reals!"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 6, "last_activity_date": 1540949262, "last_edit_date": 1540949262, "creation_date": 1540946727, "answer_id": 53074760, "question_id": 53074737, "link": "https://stackoverflow.com/questions/53074737/real-numbers-in-go/53074760#53074760", "title": "Real numbers in Go", "body": "<p>Use floating-point (real), not integer, division. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\nfunc main() {\n    fmt.Print(math.Pow((627.71 / 640.26), (1.0 / 30.0)))\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/o7uVw9doaMu\" rel=\"nofollow noreferrer\">https://play.golang.org/p/o7uVw9doaMu</a></p>\n\n<p>Output:</p>\n\n<pre><code>0.999340348749526\n</code></pre>\n\n<hr>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(1 / 30)     // integer division\n    fmt.Println(1.0 / 30.0) // floating-point division\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/VW9vilCC9M8\" rel=\"nofollow noreferrer\">https://play.golang.org/p/VW9vilCC9M8</a></p>\n\n<p>Output:</p>\n\n<pre><code>0\n0.03333333333333333\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Integer_literals\" rel=\"nofollow noreferrer\">Integer literals</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Floating-point_literals\" rel=\"nofollow noreferrer\">Floating-point literals</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Arithmetic_operators\" rel=\"nofollow noreferrer\">Arithmetic operators</a></p>\n  \n  <p>Integer operators</p>\n  \n  <p>For two integer values x and y, the integer quotient q = x / y and\n  remainder r = x % y satisfy the following relationships:</p>\n\n<pre><code>x = q*y + r  and  |r| &lt; |y|\n</code></pre>\n  \n  <p>with x / y truncated towards zero (\"truncated division\").</p>\n</blockquote>\n"}], "owner": {"reputation": 61, "user_id": 1846320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82cfca685b4bda4a49484e8cc6b640fc?s=128&d=identicon&r=PG", "display_name": "Mauro Delazeri", "link": "https://stackoverflow.com/users/1846320/mauro-delazeri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 1, "closed_date": 1540961019, "accepted_answer_id": 53074760, "answer_count": 1, "score": 1, "last_activity_date": 1540949262, "creation_date": 1540946511, "last_edit_date": 1540947690, "question_id": 53074737, "link": "https://stackoverflow.com/questions/53074737/real-numbers-in-go", "closed_reason": "Duplicate", "title": "Real numbers in Go", "body": "<p>How to work with real numbers in Go?</p>\n\n<p>For instance:</p>\n\n<pre><code>(627.71/640.26)^(1/30) = 0.999340349 --&gt; correct result\n</code></pre>\n\n<p>but with Go:</p>\n\n<pre><code>fmt.Print(math.Pow((627.71 / 640.26), (1 / 30))) = 1 --&gt; wrong\n</code></pre>\n"}, {"tags": ["go", "struct", "types"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1540946619, "post_id": 53074659, "comment_id": 93047829, "body": "Follow the <a href=\"https://blog.golang.org/context#TOC_3.2.\" rel=\"nofollow noreferrer\">userIP example</a> in the blog post announcing the context package. Replace userIP with your user type."}], "answers": [{"tags": [], "owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "is_accepted": true, "score": 1, "last_activity_date": 1540967014, "creation_date": 1540967014, "answer_id": 53077441, "question_id": 53074659, "link": "https://stackoverflow.com/questions/53074659/how-to-properly-augment-context/53077441#53077441", "title": "How to properly augment context", "body": "<p>You cannot access values added to a context directly\u2014you need to use the <code>Value(key interface{}) interface{}</code> API.</p>\n\n<p>This is because any value added to a <code>Context</code> needs to be immutable in order to be thread safe. Any changes to existing values on a <code>Context</code>, is accomplished by creating a new <code>Context</code>.</p>\n\n<p>This is the updated <code>my-lambda.go</code>:</p>\n\n<pre><code>func Handler(ctx context.Context, request events.APIGatewayProxyRequest) (events.APIGatewayProxyResponse, error) {\n    fmt.Println(ctx.value(\"user\").(models.User))\n\n    return events.APIGatewayProxyResponse{}, nil\n}\n</code></pre>\n\n<p>Value returns an interface, so you need to use type assertion.</p>\n\n<p>NB: the use of plain strings as keys on a Context is not recommended, as this could result in key collision.</p>\n"}], "owner": {"reputation": 153, "user_id": 10542686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A-EjroLSsEo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAhns3lDS_jtO57Lpdlfk1kFTjhZA/mo/photo.jpg?sz=128", "display_name": "Evanusso", "link": "https://stackoverflow.com/users/10542686/evanusso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 53077441, "answer_count": 1, "score": 1, "last_activity_date": 1540967014, "creation_date": 1540945722, "question_id": 53074659, "link": "https://stackoverflow.com/questions/53074659/how-to-properly-augment-context", "title": "How to properly augment context", "body": "<p>I'm trying to create an authentication middleware in my Lambda, which basically injects a property <code>user</code> in the <code>ctx</code> struct, and call the handler function. How I'm doing:</p>\n\n<p>middlewares/authentication.go:</p>\n\n<pre><code>package middlewares\n\nimport (\n    \"context\"\n\n    \"github.com/aws/aws-lambda-go/events\"\n    \"github.com/passus/api/models\"\n)\n\nfunc Authentication(next MiddlewareSignature) MiddlewareSignature {\n    user := models.User{}\n\n    return func(ctx context.Context, request events.APIGatewayProxyRequest) (events.APIGatewayProxyResponse, error) {\n        claims := request.RequestContext.Authorizer[\"claims\"]\n\n        // Find user by claims properties.\n        if err := user.Current(claims); err != nil {\n            return events.APIGatewayProxyResponse{}, err\n        }\n\n        // Augment ctx with user property.\n        ctx = context.WithValue(ctx, \"user\", user)\n        return next(ctx, request)\n    }\n}\n</code></pre>\n\n<p>my-lambda.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n\n    \"github.com/aws/aws-lambda-go/events\"\n    \"github.com/aws/aws-lambda-go/lambda\"\n    \"github.com/passus/api/middlewares\"\n)\n\nfunc Handler(ctx context.Context, request events.APIGatewayProxyRequest) (events.APIGatewayProxyResponse, error) {\n    fmt.Println(ctx.user)\n\n    return events.APIGatewayProxyResponse{}, nil\n}\n\nfunc main() {\n    lambda.Start(\n        middlewares.Authentication(Handler),\n    )\n}\n</code></pre>\n\n<p>The problem with this approach is that: it doesn't work. I see the following error when I try to build it: <code>create/main.go:13:17: ctx.user undefined (type context.Context has no field or method user)</code></p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["go", "apache-kafka", "sarama"], "owner": {"reputation": 99, "user_id": 9135554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ddcd4c670ac9b36aac69a39aa688aae?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/9135554/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1540978091, "creation_date": 1540945159, "last_edit_date": 1540978091, "question_id": 53074611, "link": "https://stackoverflow.com/questions/53074611/package-unable-to-consume-from-a-partition", "title": "package unable to consume from a partition", "body": "<p>I'm not able to consume from a topic and I'm not sure if there's something wrong with my code or my kafka configuration. The problem I'm getting is it's stuck on the print statement of \"Starts\" so it's not receiving a message from the channel &lt;-partitionConsumer.Messages(). </p>\n\n<p>These are the steps I took for my kafka setup (<a href=\"https://kafka.apache.org/quickstart\" rel=\"nofollow noreferrer\">https://kafka.apache.org/quickstart</a>) with some messages in them, and I know for sure they exist because when I run the following command I see values. </p>\n\n<blockquote>\n  <p>bin/kafka-console-consumer.sh --partition 0 --topic test\n  --bootstrap-server localhost:9092 --offset earliest</p>\n  \n  <ol>\n  <li>bin/zookeeper-server-start.sh config/zookeeper.properties</li>\n  <li>bin/kafka-server-start.sh config/server.properties</li>\n  <li>bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic test</li>\n  <li>bin/kafka-console-producer.sh --broker-list localhost:9092 --topic test</li>\n  </ol>\n</blockquote>\n\n<pre><code>func RetrieveConsumed() (int){\n    consumer, err := sarama.NewConsumer([]string{\"localhost:9092\"}, nil)\n    if err != nil {\n        fmt.Println(\"ERROR\")\n        panic(err)\n    }\n\n    defer func() {\n        if err := consumer.Close(); err != nil {\n            fmt.Println(\"ERROR\")\n        }\n    }()\n\n    partitionConsumer, err := consumer.ConsumePartition(\"test\", 0, sarama.OffsetOldest)\n    if err != nil {\n        fmt.Println(\"ERROR\")\n        panic(err)\n    }\n    defer func() {\n        if err := partitionConsumer.Close(); err != nil {\n            fmt.Println(\"ERROR\")\n        }\n    }()\n\n    // Trap SIGINT to trigger a shutdown.\n    signals := make(chan os.Signal, 1)\n    signal.Notify(signals, os.Interrupt)\n\n    consumed := 0\n    ConsumerLoop:\n        for {\n            fmt.Println(\"Starts\")\n            select {\n            case msg := &lt;-partitionConsumer.Messages():\n                fmt.Printf(\"Consumed message offset %d\\n\", msg.Offset)\n                consumed++\n            case &lt;- partitionConsumer.Errors():\n                break ConsumerLoop\n            case &lt;-signals:\n                break ConsumerLoop\n            }\n        }\n\n        fmt.Printf(\"Consumed: %d\\n\", consumed)\n        return consumed\n}\n</code></pre>\n"}, {"tags": ["go", "math", "exponent", "math.sqrt"], "answers": [{"comments": [{"owner": {"reputation": 2288, "user_id": 8408080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b487ee532f07476aea6610f459b3fdaf?s=128&d=identicon&r=PG&f=1", "display_name": "user8408080", "link": "https://stackoverflow.com/users/8408080/user8408080"}, "reply_to_user": {"reputation": 61, "user_id": 1846320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82cfca685b4bda4a49484e8cc6b640fc?s=128&d=identicon&r=PG", "display_name": "Mauro Delazeri", "link": "https://stackoverflow.com/users/1846320/mauro-delazeri"}, "edited": false, "score": 1, "creation_date": 1540941267, "post_id": 53074151, "comment_id": 93046621, "body": "feel free to accept the answer, so others see, that the problem is solved ;)"}], "tags": [], "owner": {"reputation": 2288, "user_id": 8408080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b487ee532f07476aea6610f459b3fdaf?s=128&d=identicon&r=PG&f=1", "display_name": "user8408080", "link": "https://stackoverflow.com/users/8408080/user8408080"}, "is_accepted": true, "score": 1, "last_activity_date": 1540941120, "creation_date": 1540941120, "answer_id": 53074151, "question_id": 53074071, "link": "https://stackoverflow.com/questions/53074071/square-negative-number-in-go/53074151#53074151", "title": "Square negative number in go", "body": "<p>The problem is:</p>\n\n<pre><code>(2*(1-0.5)-4)/((4*(4-2))/(2-1))^(1/2)\n</code></pre>\n\n<p>is evaluated as <code>(2*(1-0.5)-4)</code> divided by <code>((4*(4-2))/(2-1))^(1/2)</code> in your calculator, which indeed yields <code>-1.06..</code>.</p>\n\n<p>But you gave Go <code>(2*(1-0.5)-4)/((4*(4-2))/(2-1))</code>, which is a negative number, and told it to calculate the square root of that, which would be complex. </p>\n\n<p>So try:</p>\n\n<pre><code>fmt.Print((2*(1-0.5) - 4) / math.Sqrt(((4 * (4 - 2)) / (2 - 1))))\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 1846320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82cfca685b4bda4a49484e8cc6b640fc?s=128&d=identicon&r=PG", "display_name": "Mauro Delazeri", "link": "https://stackoverflow.com/users/1846320/mauro-delazeri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 53074151, "answer_count": 1, "score": -1, "last_activity_date": 1540941120, "creation_date": 1540940417, "question_id": 53074071, "link": "https://stackoverflow.com/questions/53074071/square-negative-number-in-go", "title": "Square negative number in go", "body": "<p>I'm having problems to square a negative number in go...</p>\n\n<p><code>(2*(1-0.5)-4)/((4*(4-2))/(2-1))^(1/2) = -1.06066017</code></p>\n\n<p>but with go I get <code>NaN</code></p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"math\"\n)\n\nfunc main() {\n    fmt.Print(math.Sqrt((2*(1-0.5) - 4) / ((4 * (4 - 2)) / (2 - 1))))\n}\n</code></pre>\n\n<p>or if I use <code>math.Abs</code> like this:</p>\n\n<pre><code>fmt.Print(math.Sqrt(math.Abs((2*(1-0.5) - 4) / ((4 * (4 - 2)) / (2 - 1)))))\n</code></pre>\n\n<p>I got back: <code>0.6123724356957</code> that is not correct, the correct result is: <code>-1.06066017</code></p>\n\n<p>is there any way to work around this?</p>\n"}, {"tags": ["go", "switch-statement", "code-readability"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1540939314, "post_id": 53073833, "comment_id": 93046082, "body": "Shorter isn&#39;t more elegant. Maybe use the increment operator if you&#39;re trying to save a few characters, but otherwise I&#39;m not sure what you expect to accomplish."}, {"owner": {"reputation": 944, "user_id": 1499575, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/82374abfce29c20a6f214de4fa2226f5?s=128&d=identicon&r=PG", "display_name": "mreff555", "link": "https://stackoverflow.com/users/1499575/mreff555"}, "edited": false, "score": 2, "creation_date": 1540939992, "post_id": 53073833, "comment_id": 93046299, "body": "There is nothing wrong with that statement.  &quot;Tricks&quot; so save space, may be ok for showing off, but they usually result in harder to read code and in some cases, considerably slower code.  Remember, even c, less bytes in your code does not necessarily compile to less assembler instructions.  That being said, I would use the increment operators."}], "answers": [{"comments": [{"owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "edited": false, "score": 0, "creation_date": 1540940172, "post_id": 53073953, "comment_id": 93046355, "body": "take it into account"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1540939681, "creation_date": 1540939681, "answer_id": 53073953, "question_id": 53073833, "link": "https://stackoverflow.com/questions/53073833/rewrite-ans-shorten-switch-case-expression/53073953#53073953", "title": "Rewrite ans shorten switch case expression", "body": "<p>More idiomatic:</p>\n\n<pre><code>switch fileInfo.RequestType {\ncase lib.Write:\n    writeCounter++\ncase lib.Read:\n    readCounter++\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 1, "last_activity_date": 1540945434, "creation_date": 1540945434, "answer_id": 53074641, "question_id": 53073833, "link": "https://stackoverflow.com/questions/53073833/rewrite-ans-shorten-switch-case-expression/53074641#53074641", "title": "Rewrite ans shorten switch case expression", "body": "<p>I'm not really sure what elegant here mean. Maybe putting the <code>case</code> statement to be inline?</p>\n\n<pre><code>switch fileInfo.RequestType {\n    case lib.WRITE: WriteCounter += 1\n    case lib.READ: ReadCounter += 1\n}\n</code></pre>\n\n<p>Writing style like above are valid, but it doesn't follow the <code>gofmt</code> standard.</p>\n"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1540945434, "creation_date": 1540938849, "last_edit_date": 1540939989, "question_id": 53073833, "link": "https://stackoverflow.com/questions/53073833/rewrite-ans-shorten-switch-case-expression", "title": "Rewrite ans shorten switch case expression", "body": "<p>I have such code block where I just increment counters:</p>\n\n<pre><code>switch fileInfo.RequestType {\ncase lib.WRITE:\n    WriteCounter += 1\ncase lib.READ:\n    ReadCounter += 1\n}\n</code></pre>\n\n<p>It seems to me that this snippet doesn't look like a idiomatic golang code. Can it be done more short and \"elegant\"?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 6, "creation_date": 1540937286, "post_id": 53073506, "comment_id": 93045370, "body": "The first is a type conversion of string to []byte. The second is formally a []byte literal with one element; but of course a string cannot be a byte so this one fails. Your really should take the Tour of Go and read the language spec."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540996405, "post_id": 53073506, "comment_id": 93068431, "body": "<a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">tour.golang.org/welcome/1</a>"}], "answers": [{"tags": [], "owner": {"reputation": 39296, "user_id": 560299, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c38fe465734e8428048585e0acf6174f?s=128&d=identicon&r=PG", "display_name": "Ibu", "link": "https://stackoverflow.com/users/560299/ibu"}, "is_accepted": false, "score": 2, "last_activity_date": 1540938012, "last_edit_date": 1540938012, "creation_date": 1540937421, "answer_id": 53073600, "question_id": 53073506, "link": "https://stackoverflow.com/questions/53073506/parenthesis-and-curly-braces-difference-in-golang/53073600#53073600", "title": "parenthesis and curly braces difference in golang", "body": "<p>In the first one <code>a := []byte(\"H\")</code> you are type casting the string <code>\"H\"</code> into a byte array.</p>\n\n<p>In the second one <code>a := []byte{\"H\"}</code> you are defining a byte array and assigning \"H\" as it's first value, which is invalid.</p>\n\n<p>You can compare the second one with defining a string array:</p>\n\n<pre><code>s := []string{\"hello\",\"world\",\"..\"} // works\nf := []string{1,2,4} // fails because the datatype is wrong\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 4, "last_activity_date": 1540938568, "creation_date": 1540938568, "answer_id": 53073779, "question_id": 53073506, "link": "https://stackoverflow.com/questions/53073506/parenthesis-and-curly-braces-difference-in-golang/53073779#53073779", "title": "parenthesis and curly braces difference in golang", "body": "<p>The reason is the difference between <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">type conversions</a> and <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">slice literals</a>.</p>\n\n<pre><code>_ = []byte(\"Hi!\")         // Converts a string literal to a []byte.\n_ = []byte{'H', 'i', '!'} // Initializes a []byte literal\n</code></pre>\n\n<p>Your second example <code>[]byte{\"H\"}</code> fails to compile because <code>\"H\"</code> is a <em>string</em> literal that is being used in place of a <a href=\"https://golang.org/ref/spec#Rune_literals\" rel=\"nofollow noreferrer\"><em>rune</em> literal</a>, it's comparable to trying to assign a string to a byte typed variable:</p>\n\n<pre><code>var y byte = 'H' // OK\nvar x byte = \"H\" // ERROR: cannot use \"H\" (type string) as type byte in assignment\n</code></pre>\n"}], "owner": {"reputation": 3597, "user_id": 150365, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/16a3c870cbb36c719333528fdc655102?s=128&d=identicon&r=PG", "display_name": "MK.", "link": "https://stackoverflow.com/users/150365/mk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1882, "favorite_count": 2, "accepted_answer_id": 53073779, "answer_count": 2, "score": 1, "last_activity_date": 1540938568, "creation_date": 1540936946, "question_id": 53073506, "link": "https://stackoverflow.com/questions/53073506/parenthesis-and-curly-braces-difference-in-golang", "title": "parenthesis and curly braces difference in golang", "body": "<pre><code>a := []byte(\"H\") //works\na := []byte{\"H\"} //does not compile\n</code></pre>\n\n<p>What is the conceptual difference between () and {} as used above? </p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-dynamodb"], "answers": [{"comments": [{"owner": {"reputation": 182, "user_id": 4896607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c717d91b76d0d0c0db225f4da167885?s=128&d=identicon&r=PG&f=1", "display_name": "jacobisaman", "link": "https://stackoverflow.com/users/4896607/jacobisaman"}, "edited": false, "score": 0, "creation_date": 1540978882, "post_id": 53073536, "comment_id": 93057924, "body": "Thanks! I knew I had to be missing something."}, {"owner": {"reputation": 1185, "user_id": 1520421, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/5a4e98bb784ee939598e7b93705f3eaf?s=128&d=identicon&r=PG", "display_name": "Dattatray", "link": "https://stackoverflow.com/users/1520421/dattatray"}, "edited": false, "score": 0, "creation_date": 1553501886, "post_id": 53073536, "comment_id": 97392400, "body": "I tried using similar expression, but got an error - buildTree error: unset parameter: ConditionBuilder"}], "tags": [], "owner": {"reputation": 3597, "user_id": 7946807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UkEte.png?s=128&g=1", "display_name": "Schidu Luca", "link": "https://stackoverflow.com/users/7946807/schidu-luca"}, "is_accepted": true, "score": 3, "last_activity_date": 1561479701, "last_edit_date": 1561479701, "creation_date": 1540937093, "answer_id": 53073536, "question_id": 53073212, "link": "https://stackoverflow.com/questions/53073212/aws-sdk-for-go-dynamodb-add-multiple-conditions-to-filterexpression/53073536#53073536", "title": "AWS SDK for Go - DynamoDb - Add multiple conditions to FilterExpression", "body": "<p>You can try adding multiple conditions with <code>And</code> , <code>Or</code> and <code>Not</code> methods from the <code>ConditionBuilder</code> struct. Example:</p>\n\n<pre><code>cond1 := expression.Name(\"foo\").Equal(expression.Value(5))\ncond2 := expression.Name(\"bar\").Equal(expression.Value(6))\nexpr, err := expression.NewBuilder().\n    WithCondition(cond1.And(cond2)).\n    Build()\nif err != nil {\n    fmt.Println(err)\n}\n</code></pre>\n\n<p><a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/dynamodb/expression\" rel=\"nofollow noreferrer\">Documentation</a>.</p>\n"}], "owner": {"reputation": 182, "user_id": 4896607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c717d91b76d0d0c0db225f4da167885?s=128&d=identicon&r=PG&f=1", "display_name": "jacobisaman", "link": "https://stackoverflow.com/users/4896607/jacobisaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2359, "favorite_count": 0, "accepted_answer_id": 53073536, "answer_count": 1, "score": 3, "last_activity_date": 1561479701, "creation_date": 1540935172, "question_id": 53073212, "link": "https://stackoverflow.com/questions/53073212/aws-sdk-for-go-dynamodb-add-multiple-conditions-to-filterexpression", "title": "AWS SDK for Go - DynamoDb - Add multiple conditions to FilterExpression", "body": "<p>I am attempting to filter a DynamoDb scan by multiple conditions using the expression builder. According to this <a href=\"https://aws.amazon.com/blogs/developer/introducing-amazon-dynamodb-expression-builder-in-the-aws-sdk-for-go/\" rel=\"nofollow noreferrer\">blog post</a>, attempting to add another condition in the builder will overwrite the previous condition. There must be some way to add another condition, but I have not been able to find a way to do it. </p>\n\n<h2>This won't work</h2>\n\n<pre><code>cond1 := expression.Name(\"foo\").Equal(expression.Value(5))\ncond2 := expression.Name(\"bar\").Equal(expression.Value(6))\nexpr, err := expression.NewBuilder().\n    WithCondition(cond1).\n    WithCondition(cond2).\n    Build()\nif err != nil {\nfmt.Println(err)\n</code></pre>\n\n<p>}</p>\n\n<h2>This is a working example with a single filter</h2>\n\n<pre><code>filt := expression.Name(\"Artist\").Equal(expression.Value(\"No One You Know\"))\nproj := expression.NamesList(\n    expression.Name(\"SongTitle\"),\n    expression.Name(\"AlbumTitle\"),\n)\nexpr, err := expression.NewBuilder().\nWithFilter(filt).\nWithProjection(proj).\nBuild()\nif err != nil {\n  fmt.Println(err)\n}\n\ninput := &amp;dynamodb.ScanInput{\n  ExpressionAttributeNames:  expr.Names(),\n  ExpressionAttributeValues: expr.Values(),\n  FilterExpression:          expr.Filter(),\n  ProjectionExpression:      expr.Projection(),\n  TableName:                 aws.String(\"Music\"),\n}\n</code></pre>\n\n<p>I have been able to accomplish this without using the expression buidler, but I would prefer to use the expression builder. How could I add another condition to that filter?</p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 1, "creation_date": 1540932794, "post_id": 53072109, "comment_id": 93043879, "body": "The <code>github.com&#47;docker&#47;docker&#47;client</code> library seems to have pretty decent docs with some examples. Is there a specific problem you are having?"}, {"owner": {"reputation": 451, "user_id": 4624605, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/CLvcA.jpg?s=128&g=1", "display_name": "Paul Oskar Mayer", "link": "https://stackoverflow.com/users/4624605/paul-oskar-mayer"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1541021127, "post_id": 53072109, "comment_id": 93081103, "body": "i dont understand the differences between the two"}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 827008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5337c17b3aefa1de031b99553731051a?s=128&d=identicon&r=PG", "display_name": "Ruslan Gustomyasov", "link": "https://stackoverflow.com/users/827008/ruslan-gustomyasov"}, "is_accepted": true, "score": 1, "last_activity_date": 1540934753, "creation_date": 1540934753, "answer_id": 53073146, "question_id": 53072109, "link": "https://stackoverflow.com/questions/53072109/controlling-docker-from-a-golang-webserver/53073146#53073146", "title": "Controlling Docker from a Golang-Webserver", "body": "<p><a href=\"https://godoc.org/github.com/docker/docker/client\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/docker/docker/client</a> docs looks good to me. For some more example use can look at my project <a href=\"https://github.com/loqutus/rws/blob/master/server/server.go\" rel=\"nofollow noreferrer\">https://github.com/loqutus/rws/blob/master/server/server.go</a></p>\n"}], "owner": {"reputation": 451, "user_id": 4624605, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/CLvcA.jpg?s=128&g=1", "display_name": "Paul Oskar Mayer", "link": "https://stackoverflow.com/users/4624605/paul-oskar-mayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 53073146, "answer_count": 1, "score": 0, "last_activity_date": 1540934753, "creation_date": 1540929903, "question_id": 53072109, "link": "https://stackoverflow.com/questions/53072109/controlling-docker-from-a-golang-webserver", "title": "Controlling Docker from a Golang-Webserver", "body": "<p>I am looking for a way to control my docker-containers on a server from a golang-webserver. So far i found \"github.com/docker/docker/client\" and \"docker.io/go-docker\". both do the same thing i guess, but neither of them have a decent documentation nor examples to work with. Does someone have any experience with those libs?</p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 3, "creation_date": 1540924710, "post_id": 53070735, "comment_id": 93040064, "body": "Since <code>[]int</code> is sorted, you can use <a href=\"https://golang.org/pkg/sort/#SearchInts\" rel=\"nofollow noreferrer\"><code>sort.SearchInts</code></a>, which performs a binary search (runs in logarithmic time, rather than linear)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1540924770, "post_id": 53070735, "comment_id": 93040090, "body": "there&#39;s also no need for <code>arr2</code>, just return the 2 slices, <code>arr[:i], arr[i:]</code>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1540925299, "post_id": 53070735, "comment_id": 93040311, "body": "Do you mean slices? Your code uses slices, but you talk about arrays."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540925740, "post_id": 53070892, "comment_id": 93040547, "body": "This is good advice but offers an unsolicited optimization while ignoring the actual question, which was due to an off-by-one error (it fixes the error, but doesn&#39;t mention it)."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540926259, "post_id": 53070892, "comment_id": 93040808, "body": "@Adrian thanks for the feedback; I&#39;ve updated my answer."}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 7, "last_activity_date": 1540926238, "last_edit_date": 1540926238, "creation_date": 1540924877, "answer_id": 53070892, "question_id": 53070735, "link": "https://stackoverflow.com/questions/53070735/best-way-to-cut-a-sorted-slice/53070892#53070892", "title": "Best way to cut a sorted slice", "body": "<p>Your implementation contains an off-by-one error, which can easily be worked around by using the index of the leftmost target value as the pivot point using the slice expressions <code>arr[:i]</code> and <code>arr[i:]</code>.</p>\n\n<p>Also, consider using <a href=\"https://golang.org/pkg/sort/#SearchInts\" rel=\"noreferrer\"><code>sort.SearchInts(...)</code></a> to find the target index in <code>O(lg(n))</code> time instead of <code>O(n)</code>. Using a builtin function will also likely improve legibility and maintainability of the code.</p>\n\n<p>For example (<a href=\"https://play.golang.com/p/8stD_wXHMrB\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>func cutBefore(xs []int, x int) ([]int, []int) {\n  i := sort.SearchInts(xs, x)\n  return xs[:i], xs[i:]\n}\n\nfunc main() {\n  xss := [][]int{\n    {1, 2, 3, 4, 5, 6, 7, 8},\n    {1, 5},\n    {1},\n    {5},\n    {5, 6},\n    {5, 5},\n    {7, 7, 7},\n  }\n  for _, xs := range xss {\n    fmt.Println(cutBefore(xs, 5))\n  }\n  // [1 2 3 4] [5 6 7 8]\n  // [1] [5]\n  // [1] []\n  // [] [5]\n  // [] [5 6]\n  // [] [5 5]\n  // [] [7 7 7]\n}\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 410245, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f92a642e8a8e77b6b27bd16b2280587f?s=128&d=identicon&r=PG", "display_name": "Richard Hoffman", "link": "https://stackoverflow.com/users/410245/richard-hoffman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 53070892, "answer_count": 1, "score": 2, "last_activity_date": 1540928949, "creation_date": 1540924300, "last_edit_date": 1540928949, "question_id": 53070735, "link": "https://stackoverflow.com/questions/53070735/best-way-to-cut-a-sorted-slice", "title": "Best way to cut a sorted slice", "body": "<p>I want to cut an array of integers before a specified value, and return an array containing those values and the remaining values in the array. We can assume the array is sorted. This is what I have so far:</p>\n\n<pre><code>func cutIntArrBefore(arr1 []int, n int) ([]int, []int) {\n    arr2 := make([]int, 0, len(arr1))\n    sliceIndex := 0\n\n\n    for i, num := range arr1 {\n        if num &lt; n {\n            arr2 = append(arr2, num)\n            sliceIndex = i\n        }\n    }\n\n    sliceIndex = sliceIndex + 1\n    if sliceIndex &gt;= len(arr1) {\n        return arr2, nil\n    } else {\n        arr1 := arr1[sliceIndex:]   \n        return arr2, arr1\n    }\n}\n</code></pre>\n\n<p>test code:</p>\n\n<pre><code>func main() {\n    var arr1, arr2, arr3 []int\n    arr1 = []int{1,2,3,4,5,6,7,8}\n    arr2, arr3 = cutIntArrBefore(arr1, 5)\n    fmt.Printf(\"(%+v) = %+v, %+v\\n\", arr1, arr2, arr3)\n\n    arr1 = []int{1,5}\n    arr2, arr3 = cutIntArrBefore(arr1, 5)\n    fmt.Printf(\"(%+v) = %+v, %+v\\n\", arr1, arr2, arr3)\n\n    arr1 = []int{1}\n    arr2, arr3 = cutIntArrBefore(arr1, 5)\n    fmt.Printf(\"(%+v) = %+v, %+v\\n\", arr1, arr2, arr3)\n\n    arr1 = []int{5}\n    arr2, arr3 = cutIntArrBefore(arr1, 5)\n    fmt.Printf(\"(%+v) = %+v, %+v\\n\", arr1, arr2, arr3)\n\n    arr1 = []int{5,6}\n    arr2, arr3 = cutIntArrBefore(arr1, 5)\n    fmt.Printf(\"(%+v) = %+v, %+v\\n\", arr1, arr2, arr3)\n\n    arr1 = []int{5,5}\n    arr2, arr3 = cutIntArrBefore(arr1, 5)\n    fmt.Printf(\"(%+v) = %+v, %+v\\n\", arr1, arr2, arr3)\n\n    arr1 = []int{7,7,7}\n    arr2, arr3 = cutIntArrBefore(arr1, 5)\n    fmt.Printf(\"(%+v) = %+v, %+v\\n\", arr1, arr2, arr3)\n}\n</code></pre>\n\n<p>output: </p>\n\n<pre><code>([1 2 3 4 5 6 7 8]) = [1 2 3 4], [5 6 7 8]\n([1 5]) = [1], [5]\n([1]) = [1], []\n([5]) = [], []\n([5 6]) = [], [6]\n([5 5]) = [], [5]\n([7 7 7]) = [], [7 7]\n</code></pre>\n\n<p>Unfortunately, as you can see, if the first element is after the specified value, it gets skipped over. I want to do this as elegantly as possible. I'm hoping there's another way without having to create two arrays, or adding another if statement.</p>\n"}, {"tags": ["go", "fetch", "axios", "fetch-api"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540918966, "post_id": 53069404, "comment_id": 93037192, "body": "Are you calling <code>ParseForm</code> first?"}, {"owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540919003, "post_id": 53069404, "comment_id": 93037211, "body": "yes I am calling req.ParseForm()"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1540919071, "post_id": 53069404, "comment_id": 93037248, "body": "That&#39;s not shown in your quoted code. Please update your question to include a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, Verifiable Example</a>."}, {"owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540919156, "post_id": 53069404, "comment_id": 93037291, "body": "I&#39;ve updated my question"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1540919189, "post_id": 53069404, "comment_id": 93037306, "body": "You&#39;ve added that one line, but most of the function is still <code>...</code>. Please update your question to include a MCVE."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540919240, "post_id": 53069404, "comment_id": 93037334, "body": "Also, be sure to inspect the outgoing request in your browser&#39;s developer console to ensure that the request its sending is what you think it&#39;s sending."}, {"owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540919452, "post_id": 53069404, "comment_id": 93037443, "body": "I&#39;ve added the image of outgoing request"}], "answers": [{"comments": [{"owner": {"reputation": 348, "user_id": 6321206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7rEQ.jpg?s=128&g=1", "display_name": "Andrii Soluk", "link": "https://stackoverflow.com/users/6321206/andrii-soluk"}, "edited": false, "score": 1, "creation_date": 1540937339, "post_id": 53073202, "comment_id": 93045391, "body": "Please update the title of the question. It has nothing to do with GO :)"}], "tags": [], "owner": {"reputation": 348, "user_id": 6321206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7rEQ.jpg?s=128&g=1", "display_name": "Andrii Soluk", "link": "https://stackoverflow.com/users/6321206/andrii-soluk"}, "is_accepted": true, "score": 1, "last_activity_date": 1540936465, "last_edit_date": 1540936465, "creation_date": 1540935098, "answer_id": 53073202, "question_id": 53069404, "link": "https://stackoverflow.com/questions/53069404/axios-and-fetch-gives-empty-mapping-in-golang-even-when-url-encoded-header-is-a/53073202#53073202", "title": "Axios and fetch gives empty mapping in Golang even when url-encoded (header is added)", "body": "<p>You need something like this:</p>\n\n<pre><code>var querystring = require('querystring');\naxios.post('http://localhost:3000/login', querystring.stringify({'answer': 42},headers: {\n    'Content-Type': 'application/x-www-form-urlencoded'\n});\n</code></pre>\n\n<p>You can set query string parameters using the params config option,\nIt will definitely works:</p>\n\n<pre><code>axios.post(\"http://localhost:3000/login\", \"\", {\n    params: {answer: 42},\n    headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n    }\n})\n</code></pre>\n\n<p>To find out more please read this <a href=\"https://github.com/axios/axios/issues/350#issuecomment-227270046\" rel=\"nofollow noreferrer\">https://github.com/axios/axios/issues/350#issuecomment-227270046</a></p>\n"}], "owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "accepted_answer_id": 53073202, "answer_count": 1, "score": 0, "last_activity_date": 1540952461, "creation_date": 1540918912, "last_edit_date": 1540952461, "question_id": 53069404, "link": "https://stackoverflow.com/questions/53069404/axios-and-fetch-gives-empty-mapping-in-golang-even-when-url-encoded-header-is-a", "title": "Axios and fetch gives empty mapping in Golang even when url-encoded (header is added)", "body": "<p>I'm using axios to send http requests ( i used fetch also but it gives the same result ).</p>\n\n<pre><code>axios.post(\"http://localhost:3000/login\",\n            {\n                answer: 42\n            },\n            {\n                headers: {\n                    \"Content-Type\": \"application/x-www-form-urlencoded\",\n                },\n            })\n</code></pre>\n\n<p>In my go file I'm logging the response</p>\n\n<pre><code>func post(req *http.Request, res http.ResponseWriter) {\n    req.ParseForm()\n\n    fmt.Println(req.Form)\n}\n</code></pre>\n\n<p>The log is as follows :</p>\n\n<pre><code>map[{\"answer\":42}:[]]\n</code></pre>\n\n<p>However i want it to be as follows :</p>\n\n<pre><code>map[\"answer\":[42]]\n</code></pre>\n\n<p>(I get such when i use postman)</p>\n\n<p>What is the issue with this.</p>\n\n<p>Outgoing data for reference</p>\n\n<p><a href=\"https://i.stack.imgur.com/VNfrW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VNfrW.png\" alt=\"Outgoing data\"></a></p>\n\n<hr>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I used request ( built-in with nodejs) and also with jQuery ajax. Both of them work well.</p>\n\n<p>Its just with <strong>axios and fetch</strong> which is not working</p>\n\n<p>Here is the code :</p>\n\n<ul>\n<li><p>request</p>\n\n<p>The following code using nodejs request</p>\n\n<pre><code>var request = require(\"request\"); \nvar options = { method: 'POST',\n  url: 'http://localhost:3000/login',\n  headers: \n   { \n     'cache-control': 'no-cache',\n     'Content-Type': 'application/x-www-form-urlencoded' },\n  form: { answer: '42' } };\n\nrequest(options, function (error, response, body) {\n  if (error) throw new Error(error);\n\n  console.log(body);\n});\n</code></pre></li>\n<li><p>jQuery ajax</p></li>\n</ul>\n\n<p>The following is my jQuery code</p>\n\n<pre><code>var settings = {\n\"async\": true,\n  \"crossDomain\": true,\n  \"url\": \"http://localhost:3000/login\",\n  \"method\": \"POST\",\n  \"headers\": {\n    \"Content-Type\": \"application/x-www-form-urlencoded\",\n    \"cache-control\": \"no-cache\",\n  },\n  \"data\": {\n    \"answer\": \"42\"\n  }\n}\n\n$.ajax(settings).done(function (response) {\n  console.log(response);\n});\n</code></pre>\n\n<p>However, I am still unable to get axios and fetch to work. If someone finds it please update the answer</p>\n"}, {"tags": ["git", "go", "gitlab"], "comments": [{"owner": {"reputation": 14131, "user_id": 2224996, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/EDCvE.jpg?s=128&g=1", "display_name": "maja", "link": "https://stackoverflow.com/users/2224996/maja"}, "edited": false, "score": 0, "creation_date": 1540920717, "post_id": 53069387, "comment_id": 93038083, "body": "Yes, it&#39;s possible by configuring git (globally or for a single go project only) to fetch data from your custom server instead. I&#39;m using it with gitea, and I haven&#39;t had any issues since. Unfortunately, it&#39;s not possible with dep only."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1540921472, "post_id": 53069387, "comment_id": 93038479, "body": "Probably the same as using go tools with other private repos. Have you tried configuring git to use ssh instead of https?"}, {"owner": {"reputation": 2155, "user_id": 310783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1b0117d379a7ee82da5a716718f1ed?s=128&d=identicon&r=PG", "display_name": "patrick-fitzgerald", "link": "https://stackoverflow.com/users/310783/patrick-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1540925928, "post_id": 53069387, "comment_id": 93040635, "body": "My question about using <code>go dep</code> instead of <code>go get</code>."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1540926789, "post_id": 53069387, "comment_id": 93041059, "body": "Both, <code>go get</code> and <code>dep</code> just invoke <code>git</code>. Duplicate."}], "owner": {"reputation": 2155, "user_id": 310783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1b0117d379a7ee82da5a716718f1ed?s=128&d=identicon&r=PG", "display_name": "patrick-fitzgerald", "link": "https://stackoverflow.com/users/310783/patrick-fitzgerald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "closed_date": 1540929178, "answer_count": 0, "score": 0, "last_activity_date": 1540918846, "creation_date": 1540918846, "question_id": 53069387, "link": "https://stackoverflow.com/questions/53069387/using-go-dep-with-private-gitlab-repository", "closed_reason": "Duplicate", "title": "Using Go Dep with Private Gitlab repository", "body": "<p>I'm trying to use a private GitLab repository with Go Dep.</p>\n\n<p>Is it possible to use a GitLab Deploy Key to clone the project with Dep?</p>\n\n<p>Below is my sample Gopkg.toml &amp; Deploy Token:</p>\n\n<h3>Gopkg.toml</h3>\n\n<pre><code>[[constraint]]\n  name = \"gitlab.com/example/foo\"\n  branch = \"master\"\n</code></pre>\n\n<h3>Deploy Token:</h3>\n\n<p><code>Username: gitlab+deploy-token-1234</code></p>\n\n<p><code>Password: a1234567</code></p>\n"}, {"tags": ["go", "ascii"], "comments": [{"owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "edited": false, "score": 0, "creation_date": 1540918225, "post_id": 53069040, "comment_id": 93036790, "body": "According to <a href=\"https://golang.org/pkg/unicode/\" rel=\"nofollow noreferrer\">go doc</a> there is no such a way to do this, I think you did research well."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1540918395, "post_id": 53069040, "comment_id": 93036883, "body": "Looks good to me, ship it :thumbsup:"}, {"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "edited": false, "score": 0, "creation_date": 1540918493, "post_id": 53069040, "comment_id": 93036927, "body": "I believe an ASCII character is represented by a byte whereas the UTF-8 encoding of a non-ASCII character requires two or more bytes. I wonder if checking whether the number of bytes of a string is equal to its length is a reliable method to determine whether it contains ASCII only characters."}, {"owner": {"reputation": 1604, "user_id": 3351097, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/yInN3.jpg?s=128&g=1", "display_name": "Maxian Nicu", "link": "https://stackoverflow.com/users/3351097/maxian-nicu"}, "reply_to_user": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "edited": false, "score": 0, "creation_date": 1540918956, "post_id": 53069040, "comment_id": 93037182, "body": "@daplho I think this can be done with <code>utf8.RuneCount(buf) == len(buf)</code>, but unsure about performance"}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1540919549, "post_id": 53069040, "comment_id": 93037491, "body": "@daphlo the only issue there is that bytes are in the range of <code>[0,0xff]</code> whereas ASCII characters are in <code>[0,0x7f]</code>; so even if the lengths are equal there could still be bytes with values outside of the valid range."}, {"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "reply_to_user": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1540919900, "post_id": 53069040, "comment_id": 93037669, "body": "yeah @maerics, given this discussion it does look to me that the OP is really the most reliable and efficient way to do this."}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 6, "last_activity_date": 1540921124, "last_edit_date": 1540921124, "creation_date": 1540920074, "answer_id": 53069704, "question_id": 53069040, "link": "https://stackoverflow.com/questions/53069040/checking-a-string-contains-only-ascii-characters/53069704#53069704", "title": "Checking a string contains only ASCII characters", "body": "<p>It looks like your way is best.</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/ASCII\" rel=\"nofollow noreferrer\">ASCII</a> is simply defined as:</p>\n\n<blockquote>\n  <p>ASCII encodes 128 specified characters into seven-bit integers</p>\n</blockquote>\n\n<p>As such, characters have values 0-2<sup>7</sup> (or 0-127, 0x0-0x7F).</p>\n\n<p>Go provides no way to check that every rune in a string (or byte in a slice) has numerical values in a specific range, so your code seems to be the best way to do it.</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 16, "last_activity_date": 1540921766, "last_edit_date": 1540921766, "creation_date": 1540920565, "answer_id": 53069799, "question_id": 53069040, "link": "https://stackoverflow.com/questions/53069040/checking-a-string-contains-only-ascii-characters/53069799#53069799", "title": "Checking a string contains only ASCII characters", "body": "<p>In Go, we care about performance, Therefore, we would benchmark your code:</p>\n\n<pre><code>func isASCII(s string) bool {\n    for _, c := range s {\n        if c &gt; unicode.MaxASCII {\n            return false\n        }\n    }\n    return true\n}\n\nBenchmarkRange-4    20000000    82.0 ns/op\n</code></pre>\n\n<p>A faster (better, more idiomatic) version, which avoids unnecessary rune conversions:</p>\n\n<pre><code>func isASCII(s string) bool {\n    for i := 0; i &lt; len(s); i++ {\n        if s[i] &gt; unicode.MaxASCII {\n            return false\n        }\n    }\n    return true\n}\n\nBenchmarkIndex-4    30000000    55.4 ns/op\n</code></pre>\n\n<hr>\n\n<p><code>ascii_test.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"testing\"\n    \"unicode\"\n)\n\nfunc isASCIIRange(s string) bool {\n    for _, c := range s {\n        if c &gt; unicode.MaxASCII {\n            return false\n        }\n    }\n    return true\n}\n\nfunc BenchmarkRange(b *testing.B) {\n    str := ascii()\n    b.ResetTimer()\n    for N := 0; N &lt; b.N; N++ {\n        is := isASCIIRange(str)\n        if !is {\n            b.Fatal(\"notASCII\")\n        }\n    }\n}\n\nfunc isASCIIIndex(s string) bool {\n    for i := 0; i &lt; len(s); i++ {\n        if s[i] &gt; unicode.MaxASCII {\n            return false\n        }\n    }\n    return true\n}\n\nfunc BenchmarkIndex(b *testing.B) {\n    str := ascii()\n    b.ResetTimer()\n    for N := 0; N &lt; b.N; N++ {\n        is := isASCIIIndex(str)\n        if !is {\n            b.Log(\"notASCII\")\n        }\n    }\n}\n\nfunc ascii() string {\n    byt := make([]byte, unicode.MaxASCII+1)\n    for i := range byt {\n        byt[i] = byte(i)\n    }\n    return string(byt)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go test ascii_test.go -bench=.\nBenchmarkRange-4    20000000    82.0 ns/op\nBenchmarkIndex-4    30000000    55.4 ns/op\n$\n</code></pre>\n"}], "owner": {"reputation": 1604, "user_id": 3351097, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/yInN3.jpg?s=128&g=1", "display_name": "Maxian Nicu", "link": "https://stackoverflow.com/users/3351097/maxian-nicu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5608, "favorite_count": 3, "accepted_answer_id": 53069799, "answer_count": 2, "score": 10, "last_activity_date": 1540921766, "creation_date": 1540917495, "question_id": 53069040, "link": "https://stackoverflow.com/questions/53069040/checking-a-string-contains-only-ascii-characters", "title": "Checking a string contains only ASCII characters", "body": "<p>Does Go have any method or there is a suggestion how to check if a string contains only ASCII characters? What is the right way to do it?</p>\n\n<p>From my research, one of the solution is to check whatever there is any char greater than 127.</p>\n\n<pre><code>func isASCII(s string) bool {\n    for _, c := range s {\n        if c &gt; unicode.MaxASCII {\n            return false\n        }\n    }\n\n    return true\n}\n</code></pre>\n"}, {"tags": ["macos", "go", "opengl", "sdl-2", "glfw"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1540917238, "post_id": 53068854, "comment_id": 93036212, "body": "Put <code>handleEvents()</code> after your <code>gl.Clear</code> and <code>window.GLSwap</code> calls. Also, you can drop <code>true</code> from <code>for true {</code>."}, {"owner": {"reputation": 113, "user_id": 10462330, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aWSVdkR9Vso/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXWI6PsAVNBNdEuzk3G2yuqMmzqRw/mo/photo.jpg?sz=128", "display_name": "Reece Ward", "link": "https://stackoverflow.com/users/10462330/reece-ward"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1540917454, "post_id": 53068854, "comment_id": 93036357, "body": "It makes no difference"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1540971120, "post_id": 53068854, "comment_id": 93054096, "body": "@ReeceWard what OS version? can you show your <code>handleEvents</code> code?"}], "owner": {"reputation": 113, "user_id": 10462330, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aWSVdkR9Vso/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXWI6PsAVNBNdEuzk3G2yuqMmzqRw/mo/photo.jpg?sz=128", "display_name": "Reece Ward", "link": "https://stackoverflow.com/users/10462330/reece-ward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540921750, "creation_date": 1540916804, "last_edit_date": 1540921750, "question_id": 53068854, "link": "https://stackoverflow.com/questions/53068854/how-to-draw-purple-screen-instead-of-black-before-moving-the-window", "title": "How to draw purple screen instead of black, before moving the window", "body": "<p>I am building a simple 3D application in Go. I have this nuisance problem when I first load the app. Here is a sample that should work fine:</p>\n\n<pre><code>func main() {\n    if err := sdl.Init(sdl.INIT_EVERYTHING); err != nil {\n        panic(err)\n    }\n\n    window, err := sdl.CreateWindow(\"go3d\", sdl.WINDOWPOS_CENTERED, sdl.WINDOWPOS_CENTERED, 800, 600, sdl.WINDOW_OPENGL)\n    if err != nil {\n        panic(err)\n    }\n\n    context, err := window.GLCreateContext()\n    if err != nil {\n        panic(err)\n    }\n    defer sdl.GLDeleteContext(context)\n\n\n    if err := gl.Init(); err != nil {\n        panic(err)\n    }\n\n    gl.ClearColor(1, 0, 1, 1)\n    gl.Viewport(0, 0, 800, 600)\n\n    for true {\n        handleEvents()\n        gl.Clear(gl.COLOR_BUFFER_BIT)\n        window.GLSwap()\n    }\n}\n</code></pre>\n\n<p>When I build a run this I am greeted with a nice black screen. It should be purple? </p>\n\n<p>When I move the window slightly (I have to move it, clicking on it or trying to interact won't do anything) it starts working... but why? I've tried this with GLFW and SDL and got the same result. I checked my loop and it does run fine, anyone know whats up?</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540912777, "post_id": 53067518, "comment_id": 93033412, "body": "Just looking for differences between the two, in Go you&#39;re sending a <code>Content-Type</code> (which is invalid because there&#39;s no body content to have a type) which you are not sending in your <code>curl</code> command. You might find <a href=\"https://mholt.github.io/curl-to-go/\" rel=\"nofollow noreferrer\">mholt.github.io/curl-to-go</a> to be helpful."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 1, "creation_date": 1540913391, "post_id": 53067518, "comment_id": 93033832, "body": "One thing you can do to get more info about the request is to use <code>curl -v ...</code> (verbose mode) so you can see the full HTTP request and response. The full data set will help you and others here understand why the server is responding differently to the different requests made by your curl and go clients."}, {"owner": {"reputation": 196, "user_id": 7579943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3d16de3d46eec5650e7acc8d4cb31a?s=128&d=identicon&r=PG&f=1", "display_name": "Guus", "link": "https://stackoverflow.com/users/7579943/guus"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540914731, "post_id": 53067518, "comment_id": 93034703, "body": "Thanks @Adrian, that site will be a helpful tool for the future. For now it seems to write the same code that I was already using, with the one exception <code>http.DefaultClient.Do(req)</code> rather than <code>client := &amp;http.Client(); client.Do(req)</code>. It&#39;s still failing, even with the change"}, {"owner": {"reputation": 196, "user_id": 7579943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3d16de3d46eec5650e7acc8d4cb31a?s=128&d=identicon&r=PG&f=1", "display_name": "Guus", "link": "https://stackoverflow.com/users/7579943/guus"}, "reply_to_user": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1540914821, "post_id": 53067518, "comment_id": 93034745, "body": "@maerics using <code>curl -v</code> the only clear difference I can distinguish is that curl keeps my access token lowercase, whereas Go transforms the header into CamelCase: <code>x-access-token</code> vs <code>X-Access-Token</code>. Could that possibly be the problem? If yes, why is Go transforming it?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1540915048, "post_id": 53067518, "comment_id": 93034872, "body": "That&#39;s not the only difference. There&#39;s also the content-type header, as I mentioned in my first comment"}, {"owner": {"reputation": 196, "user_id": 7579943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3d16de3d46eec5650e7acc8d4cb31a?s=128&d=identicon&r=PG&f=1", "display_name": "Guus", "link": "https://stackoverflow.com/users/7579943/guus"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540915150, "post_id": 53067518, "comment_id": 93034935, "body": "@Adrian Yes, I&#39;ve removed that line as well. With or without, it doesn&#39;t affect the response"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1540915159, "post_id": 53067518, "comment_id": 93034943, "body": "Aside: outgoing requests are subtly different from received requests, so you should use <a href=\"https://golang.org/pkg/net/http/httputil/#DumpRequestOut\" rel=\"nofollow noreferrer\">httputil.DumpRequestOut</a> to dump them."}, {"owner": {"reputation": 2960, "user_id": 3521243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EJDD8.jpg?s=128&g=1", "display_name": "Emile Pels", "link": "https://stackoverflow.com/users/3521243/emile-pels"}, "edited": false, "score": 1, "creation_date": 1540915259, "post_id": 53067518, "comment_id": 93035000, "body": "@Guus The casing should not, but can be, a problem. You can prevent Go from uppercasing the header key by doing <code>req.Header[k] = []string{v}</code>"}, {"owner": {"reputation": 196, "user_id": 7579943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3d16de3d46eec5650e7acc8d4cb31a?s=128&d=identicon&r=PG&f=1", "display_name": "Guus", "link": "https://stackoverflow.com/users/7579943/guus"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1540915360, "post_id": 53067518, "comment_id": 93035067, "body": "@Peter Thanks, I&#39;ve updated the output accordingly"}, {"owner": {"reputation": 196, "user_id": 7579943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3d16de3d46eec5650e7acc8d4cb31a?s=128&d=identicon&r=PG&f=1", "display_name": "Guus", "link": "https://stackoverflow.com/users/7579943/guus"}, "reply_to_user": {"reputation": 2960, "user_id": 3521243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EJDD8.jpg?s=128&g=1", "display_name": "Emile Pels", "link": "https://stackoverflow.com/users/3521243/emile-pels"}, "edited": false, "score": 0, "creation_date": 1540915502, "post_id": 53067518, "comment_id": 93035158, "body": "@EmilePels Thanks, I&#39;ve tried it but unfortunately no difference in response"}, {"owner": {"reputation": 2960, "user_id": 3521243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EJDD8.jpg?s=128&g=1", "display_name": "Emile Pels", "link": "https://stackoverflow.com/users/3521243/emile-pels"}, "edited": false, "score": 1, "creation_date": 1540915584, "post_id": 53067518, "comment_id": 93035204, "body": "@Guus Really odd situation you got here. Another obvious difference in the requests you&#39;re firing is the user-agent."}, {"owner": {"reputation": 196, "user_id": 7579943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3d16de3d46eec5650e7acc8d4cb31a?s=128&d=identicon&r=PG&f=1", "display_name": "Guus", "link": "https://stackoverflow.com/users/7579943/guus"}, "edited": false, "score": 0, "creation_date": 1540916110, "post_id": 53067518, "comment_id": 93035499, "body": "Yes, but I don&#39;t know how I would be able to fix that. It seems it&#39;s Go&#39;s HTTP module vs Unix&#39; curl"}, {"owner": {"reputation": 196, "user_id": 7579943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3d16de3d46eec5650e7acc8d4cb31a?s=128&d=identicon&r=PG&f=1", "display_name": "Guus", "link": "https://stackoverflow.com/users/7579943/guus"}, "edited": false, "score": 0, "creation_date": 1540916419, "post_id": 53067518, "comment_id": 93035696, "body": "I&#39;m also seeing this difference. Curl: <code>Accept: *&#47;*</code> Go HTTP: <code>Accept-Encoding: gzip</code>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540917106, "post_id": 53067518, "comment_id": 93036117, "body": "You can try adding the <code>Accept: *&#47;*</code> to your Go request. The <code>Accept-Encoding</code> could be a problem but it&#39;s unlikely."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 1, "creation_date": 1540917262, "post_id": 53067518, "comment_id": 93036231, "body": "Header names are not case sensitive. So it doesn&#39;t really matter what the case is. Or it shouldn&#39;t. Your server might have a bug in which it isn&#39;t properly reading the X-Access-Token header because it is improperly ignoring the header. In that case the server must be fixed as it is not RFC compliant."}, {"owner": {"reputation": 196, "user_id": 7579943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3d16de3d46eec5650e7acc8d4cb31a?s=128&d=identicon&r=PG&f=1", "display_name": "Guus", "link": "https://stackoverflow.com/users/7579943/guus"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540917534, "post_id": 53067518, "comment_id": 93036401, "body": "Thanks @Adrian, @MichaelHampton; I&#39;m starting to suspect the server as well. I&#39;m having a look at other git repos from my colleagues and they&#39;re using the same code."}, {"owner": {"reputation": 196, "user_id": 7579943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3d16de3d46eec5650e7acc8d4cb31a?s=128&d=identicon&r=PG&f=1", "display_name": "Guus", "link": "https://stackoverflow.com/users/7579943/guus"}, "edited": false, "score": 0, "creation_date": 1540917950, "post_id": 53067518, "comment_id": 93036633, "body": "My colleague just recommended using <a href=\"https://github.com/moul/http2curl\" rel=\"nofollow noreferrer\">github.com/moul/http2curl</a>; Adding the following two lines for debugging purposes, I get the following output. <code>cmd, _ := http2curl.GetCurlCommand(req); fmt.Println(cmd)</code>: <code>curl -X &#39;GET&#39; -H &#39;x-access-token: a1b2c3d4&#39; &#39;my_server&#39;</code>"}, {"owner": {"reputation": 196, "user_id": 7579943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3d16de3d46eec5650e7acc8d4cb31a?s=128&d=identicon&r=PG&f=1", "display_name": "Guus", "link": "https://stackoverflow.com/users/7579943/guus"}, "edited": false, "score": 0, "creation_date": 1540918190, "post_id": 53067518, "comment_id": 93036768, "body": "The curl output works like a charm when running it directly. I&#39;m at a loss here."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540918372, "post_id": 53067518, "comment_id": 93036873, "body": "There are a number of minute differences between them (eg header case, accept-encoding, user-agent) which <i>should</i> be irrelevant to the issue but which <i>could</i> be causing the issue if the server has a defect. I think at this point the only way to solve it would be to inspect the server side."}], "answers": [{"tags": [], "owner": {"reputation": 196, "user_id": 7579943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3d16de3d46eec5650e7acc8d4cb31a?s=128&d=identicon&r=PG&f=1", "display_name": "Guus", "link": "https://stackoverflow.com/users/7579943/guus"}, "is_accepted": true, "score": 0, "last_activity_date": 1540933887, "creation_date": 1540933887, "answer_id": 53072983, "question_id": 53067518, "link": "https://stackoverflow.com/questions/53067518/unused-headers-in-curl-request/53072983#53072983", "title": "Unused headers in curl request", "body": "<p>After a lot of rewriting and debugging, I figured out that <code>getJson(api, &amp;data)</code> was <em>also</em> making a http.Get call but without headers. Since that took place <em>after</em> the request we were discussing, it bypassed all testing and printing.</p>\n"}], "owner": {"reputation": 196, "user_id": 7579943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3d16de3d46eec5650e7acc8d4cb31a?s=128&d=identicon&r=PG&f=1", "display_name": "Guus", "link": "https://stackoverflow.com/users/7579943/guus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 53072983, "answer_count": 1, "score": 0, "last_activity_date": 1540933887, "creation_date": 1540912537, "last_edit_date": 1540915668, "question_id": 53067518, "link": "https://stackoverflow.com/questions/53067518/unused-headers-in-curl-request", "title": "Unused headers in curl request", "body": "<p>I'm trying to emulate a curl -X GET with Go, but the server I'm contacting has authentication. I've followed several sites that recommend me to use <code>r.Header.Add()</code>, but I can't get my curl call to work.</p>\n\n<p>My curl call that actually returns something:\n<code>curl -X GET https://myserver.com/test/anothertest -H 'x-access-token: a1b2c3d4'</code></p>\n\n<p>My code that doesn't return the expected JSON object:</p>\n\n<pre><code>func get(api string, headers map[string]string, dataStruct interface{}) (data interface{}, err error) {\n\n    req, _ := http.NewRequest(\"GET\", api, nil)\n    for k, v := range headers {\n        req.Header[k] = []string{v}\n    }\n\n    currentHeader, _ := httputil.DumpRequestOut(req, true)\n    fmt.Println(string(currentHeader))\n\n    client := &amp;http.Client{}\n    resp, err := client.Do(req)\n\n    if err != nil {\n        return\n    }\n    defer resp.Body.Close()\n\n    data = dataStruct\n    err = getJson(api, &amp;data)\n    if err != nil {\n        return\n    }\n\n    return\n}\n\nfunc main() {\n    // args := parse_args(Options{})\n\n    args := Options{Api: \"my_server\",\n    Headers: map[string]string{\n        \"x-access-token\": \"a1b2c3d4\"}}\n\n    body, _ := get(args.Api, args.Headers, HistoryDecoder{})\n    fmt.Println(body)\n}\n</code></pre>\n\n<p>Returns:</p>\n\n<pre><code>GET /v1pre3/users/current HTTP/1.1\nHost: my_server\nUser-Agent: Go-http-client/1.1\nX-Access-Token: a1b2c3d4\nAccept-Encoding: gzip\n\n\nmap[ResponseStatus:map[Message:Please ensure that valid credentials are being provided for this API call (This request requires authentication but none were provided)] Notifications:[map[Type:error Item:Please ensure that valid credentials are being provided for this API call (This request requires authentication but none were provided)]]]\n</code></pre>\n\n<p>Could anyone please tell me what I'm doing wrong?</p>\n\n<p><strong>edit</strong> adding <code>curl -v</code> response</p>\n\n<pre><code>* About to connect() to my_server port 443 (#0)\n*   Trying 54.210.110.53...\n* Connected to my_server (54.210.110.53) port 443 (#0)\n* Initializing NSS with certpath: sql:/etc/pki/nssdb\n*   CAfile: /etc/pki/tls/certs/ca-bundle.crt\n  CApath: none\n* SSL connection using TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\n* Server certificate:\n*       subject: CN=*.cloud-test.com\n*       start date: Feb 28 00:00:00 2018 GMT\n*       expire date: Mar 28 12:00:00 2019 GMT\n*       common name: *.cloud-test.com\n*       issuer: CN=Amazon,OU=Server CA 1B,O=Amazon,C=US\n&gt; GET /v1pre3/users/current HTTP/1.1\n&gt; User-Agent: curl/7.29.0\n&gt; Host: my_server\n&gt; Accept: */*\n&gt; x-access-token: a1b2c3d4\n&gt;\n&lt; HTTP/1.1 200 OK\n&lt; Cache-Control: no-cache, no-store, must-revalidate\n&lt; Content-Type: application/json\n&lt; Date: Tue, 30 Oct 2018 15:49:00 GMT\n&lt; Expires: 0\n&lt; Pragma: no-cache\n&lt; Server:\n&lt; x-capabilities: audit\n&lt; X-Content-Type-Options: nosniff\n&lt; X-Request-ID: 2018.10.30.15.49.00.9zHjdeQ-ZEmg2IvzTymnxQ\n&lt; transfer-encoding: chunked\n&lt; Connection: keep-alive\n&lt;\n* Connection #0 to host my_server left intact\n</code></pre>\n"}, {"tags": ["go", "cassandra"], "answers": [{"tags": [], "owner": {"reputation": 747, "user_id": 5539547, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/z3y7F.jpg?s=128&g=1", "display_name": "Tahseen", "link": "https://stackoverflow.com/users/5539547/tahseen"}, "is_accepted": false, "score": -1, "last_activity_date": 1540912994, "creation_date": 1540912994, "answer_id": 53067655, "question_id": 53067051, "link": "https://stackoverflow.com/questions/53067051/golang-type-for-cassandra-decimal/53067655#53067655", "title": "Golang type for Cassandra Decimal", "body": "<p><a href=\"https://github.com/gocql/gocql/blob/master/helpers.go\" rel=\"nofollow noreferrer\">https://github.com/gocql/gocql/blob/master/helpers.go</a></p>\n\n<p>As per this link I found that inf.Dec type of Golang maps to Cassandra's Decimal </p>\n\n<pre><code>var decimal inf.Dec\n</code></pre>\n\n<p>or</p>\n\n<pre><code>decimal := inf.NewDec(1, 0)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158, "user_id": 10245760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RNQ3BJ-mSGQ/AAAAAAAAAAI/AAAAAAAAAAw/B-wcw98aIqQ/photo.jpg?sz=128", "display_name": "Karl Anthony Baluyot", "link": "https://stackoverflow.com/users/10245760/karl-anthony-baluyot"}, "is_accepted": false, "score": 5, "last_activity_date": 1565062062, "last_edit_date": 1565062062, "creation_date": 1564816020, "answer_id": 57336228, "question_id": 53067051, "link": "https://stackoverflow.com/questions/53067051/golang-type-for-cassandra-decimal/57336228#57336228", "title": "Golang type for Cassandra Decimal", "body": "<p>You may use the infinite-precision decimal package and import this gopkg directly,</p>\n\n<p><code>import \"gopkg.in/inf.v0\"</code></p>\n\n<p>Let's say you have a particular model that reflects or binds to your Scylla/Cassandra table with a decimal data type,</p>\n\n<pre><code>type TradeModel struct {\n    Balance *inf.Dec\n}\n</code></pre>\n\n<p>To cast or convert your string to this decimal data type, you may use this function:</p>\n\n<pre><code>func ToDecimal(s string) *inf.Dec {\n    d := new(inf.Dec)\n\n    res, _ := d.SetString(s)\n    return res\n}\n</code></pre>\n\n<p>Take a look with these examples: <a href=\"https://github.com/go-inf/inf/blob/master/dec.go\" rel=\"nofollow noreferrer\">https://github.com/go-inf/inf/blob/master/dec.go</a></p>\n\n<p>NOTE: I did not explicitly write the second result from the return value of SetString for simplicity. That argument will return a boolean whether the conversion is success or not which is important (in my case this is already in direct helpers).</p>\n"}], "owner": {"reputation": 747, "user_id": 5539547, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/z3y7F.jpg?s=128&g=1", "display_name": "Tahseen", "link": "https://stackoverflow.com/users/5539547/tahseen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1565062062, "creation_date": 1540911151, "question_id": 53067051, "link": "https://stackoverflow.com/questions/53067051/golang-type-for-cassandra-decimal", "title": "Golang type for Cassandra Decimal", "body": "<p>Sorry for asking this question but after being tired am writing it here.</p>\n\n<p>I am not able to map any variable type of Golang to Cassandra's Decimal type, which is multi precision</p>\n\n<p>I used interface {}, which works so long as I don't place value in the variable. The moment I do, it has issue</p>\n"}, {"tags": ["go", "encoding", "base64"], "comments": [{"owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 3, "creation_date": 1540910128, "post_id": 53066636, "comment_id": 93031738, "body": "Why do you think that&#39;s an invalid string?"}, {"owner": {"reputation": 105, "user_id": 9368823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sam White", "link": "https://stackoverflow.com/users/9368823/sam-white"}, "reply_to_user": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 0, "creation_date": 1540910383, "post_id": 53066636, "comment_id": 93031915, "body": "I was under the impression that base64.RawURLEncoding.Encode() would only take strings consisting of base64 chars detailed here <a href=\"https://en.wikipedia.org/wiki/Base64#Base64_table\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Base64#Base64_table</a>"}, {"owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 1, "creation_date": 1540910455, "post_id": 53066636, "comment_id": 93031954, "body": "Those are the characters which are used in the result of a base64&#39;ed string."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1540910607, "post_id": 53066636, "comment_id": 93032063, "body": "You can <i>en</i>code arbitrary bytes in base64 (which is why the encoding functions don&#39;t return errors). Only <i>de</i>coding can fail."}, {"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 1, "creation_date": 1540910633, "post_id": 53066636, "comment_id": 93032081, "body": "Base64 encoding accepts any binary data. This is from the wiki page you posted: &quot;Base64 is a group of similar binary-to-text encoding schemes that represent binary data in an ASCII string format&quot;"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1540910696, "post_id": 53066636, "comment_id": 93032117, "body": "The whole point of Base64 encoding is to take arbitrary bytes and reduce them to printable ASCII characters. There is no such thing as an invalid character for <i>encoding</i>, only for <i>decoding</i>."}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1540911304, "creation_date": 1540911304, "answer_id": 53067107, "question_id": 53066636, "link": "https://stackoverflow.com/questions/53066636/base64-encoding-doesnt-fail-with-invalid-characters/53067107#53067107", "title": "Base64 encoding doesn&#39;t fail with invalid characters", "body": "<p>base64 encoding works by interpreting an arbitrary bit stream as a string of 6-bit integers, which are then mapped one-by-one to the chosen base64 alphabet.</p>\n\n<p>Your example string starts with these 8-bit bytes:</p>\n\n<pre><code>11000010 10111010 11000010 10101010 11100010 10000000\n</code></pre>\n\n<p>Re-arrange them into 6-bit numbers:</p>\n\n<pre><code>110000 101011 101011 000010 101010 101110 001010 000000\n</code></pre>\n\n<p>And map them to a base64 alphabet (here URL encoding):</p>\n\n<pre><code>  w      r      r      C      q      u      K      A\n</code></pre>\n\n<p>Since every 6-bit number can be mapped to a character in the alphabet (there's exactly 64 of them), there are no invalid inputs to base64. This is precisely what base64 is used for: turn arbitrary input into printable ASCII characters.</p>\n\n<p><em>De</em>coding, on the other hand, can and will fail if the input contains bytes outside of the base64 alphabet &mdash; they can't be mapped back to the 6-bit integer.</p>\n"}, {"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 1, "last_activity_date": 1540912578, "last_edit_date": 1540912578, "creation_date": 1540911817, "answer_id": 53067274, "question_id": 53066636, "link": "https://stackoverflow.com/questions/53066636/base64-encoding-doesnt-fail-with-invalid-characters/53067274#53067274", "title": "Base64 encoding doesn&#39;t fail with invalid characters", "body": "<p>To clarify, <a href=\"https://en.wikipedia.org/wiki/Base64\" rel=\"nofollow noreferrer\">Base64</a> is an encoding scheme which allows you to take arbitrary binary data and safely encode it into ASCII characters which can later be decoded into the original binary string.</p>\n\n<p>That means that the \"Base64-<strong>en</strong>code\" operation can take literally any input and produce valid, encoded data. However, the \"Base64-<strong>de</strong>code\" operation will fail if its input string contains characters outside of set of ASCII characters that the encoding uses (meaning that the given string was <em>not</em> produced by a valid Base64-encoder).</p>\n\n<p>To test if a string contains a valid Base64 encoded sequence, you just need to call <a href=\"https://golang.org/pkg/encoding/base64/#Encoding.DecodeString\" rel=\"nofollow noreferrer\"><code>base64.Encoding.DecodeString(...)</code></a> and test if the error is \"nil\".</p>\n\n<p>For example (<a href=\"https://play.golang.com/p/yDabDecynpY\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>func IsValidBase64(s string) bool {\n  _, err := base64.StdEncoding.DecodeString(s)\n  return err == nil\n}\n\nfunc main() {\n  ss := []string{\"ABBA\", \"T0sh\", \"Foo=\", \"Bogus\\x01\"}\n\n  for _, s := range ss {\n    if IsValidBase64(s) {\n      fmt.Printf(\"OK: valid Base64 %q\\n\", s)\n    } else {\n      fmt.Printf(\"ERR: invalid Base64 %q\\n\", s)\n    }\n  }\n  // OK: valid Base64 \"ABBA\"\n  // OK: valid Base64 \"T0sh\"\n  // OK: valid Base64 \"Foo=\"\n  // ERR: invalid Base64 \"Bogus\\x01\"\n}\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 9368823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sam White", "link": "https://stackoverflow.com/users/9368823/sam-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1743, "favorite_count": 0, "closed_date": 1540977744, "accepted_answer_id": 53067274, "answer_count": 2, "score": -4, "last_activity_date": 1540921845, "creation_date": 1540909941, "last_edit_date": 1540921845, "question_id": 53066636, "link": "https://stackoverflow.com/questions/53066636/base64-encoding-doesnt-fail-with-invalid-characters", "closed_reason": "Needs details or clarity", "title": "Base64 encoding doesn&#39;t fail with invalid characters", "body": "<p>I am trying to ensure a string coming from an http request is valid for use in a base64 url param. I've been experimenting with <code>base64.RawURLEncoding</code> as I assumed encoding an invalid string would throw an err, or at least decoding the result of this would fail, however it quite happily encodes/decodes the string regardless of the input.</p>\n\n<p><a href=\"https://play.golang.org/p/3sHUfl2NSJK\" rel=\"nofollow noreferrer\">https://play.golang.org/p/3sHUfl2NSJK</a></p>\n\n<p>I have created the above playground showing the issue I'm having (albeit an extreme example). Is there another way of ascertaining whether a string consists entirely of valid base64 characters?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540909179, "post_id": 53066361, "comment_id": 93031115, "body": "&quot;But not able to do&quot; why? What problem are you having?"}, {"owner": {"reputation": 1502, "user_id": 2685083, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Afo3M.jpg?s=128&g=1", "display_name": "Sathish", "link": "https://stackoverflow.com/users/2685083/sathish"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540909258, "post_id": 53066361, "comment_id": 93031164, "body": "Updated the question with output @Adrian"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540909366, "post_id": 53066361, "comment_id": 93031235, "body": "OK. What&#39;s the problem with the output? Please specify what issue you&#39;re having."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540909545, "post_id": 53066361, "comment_id": 93031369, "body": "For that matter, what&#39;s the problem with the input string? Your date string is <i>already in</i> ISO 8601 format."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1540909701, "post_id": 53066490, "comment_id": 93031482, "body": "<code>time.Now().Unix()</code> gives <i>seconds</i> since the epoch, not ms, and the question asked how to convert &quot;to ISO format&quot;, not to milliseconds or seconds."}], "tags": [], "owner": {"reputation": 2862, "user_id": 10115847, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Okv0j.jpg?s=128&g=1", "display_name": "Or Yaacov", "link": "https://stackoverflow.com/users/10115847/or-yaacov"}, "is_accepted": false, "score": -1, "last_activity_date": 1540909721, "last_edit_date": 1540909721, "creation_date": 1540909496, "answer_id": 53066490, "question_id": 53066361, "link": "https://stackoverflow.com/questions/53066361/how-to-convert-a-date-with-timezone-to-javascript-iso-format/53066490#53066490", "title": "How to convert a date with timezone to Javascript ISO format?", "body": "<p>you can just convert it by using the RFC3339 format:</p>\n\n<pre><code> unitTimeInRFC3339 :=time.Now().Format(time.RFC3339)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 2, "last_activity_date": 1540913177, "last_edit_date": 1540913177, "creation_date": 1540910068, "answer_id": 53066685, "question_id": 53066361, "link": "https://stackoverflow.com/questions/53066361/how-to-convert-a-date-with-timezone-to-javascript-iso-format/53066685#53066685", "title": "How to convert a date with timezone to Javascript ISO format?", "body": "<p>Note that your input string is valid <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">ISO 8601 format</a>.</p>\n\n<p>However, for JSON serialization, JavaScript uses a slightly different (but still completely valid) style of ISO 8601 date format in which only 3 digits are used for fractional seconds (giving millisecond resolution) and the timezone is adjusted to <a href=\"https://en.wikipedia.org/wiki/ISO_8601#Coordinated_Universal_Time_(UTC)\" rel=\"nofollow noreferrer\">Coordinated Universal Time (UTC)</a>, (aka GMT+0, or \"Zulu\" timezone) designated with a <code>Z</code>.</p>\n\n<pre><code>// JavaScript\nJSON.stringify(new Date()); // =&gt; \"2018-10-30T15:22:30.293Z\"\n// Millisecond resolution \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253a\u253b\u251b\u2503\n// \"Zulu\" (UTC) time zone \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u251a\n</code></pre>\n\n<p>You can convert your timestamp into the JavaScript style by first parsing the input string, then converting to Zulu time via the <a href=\"https://golang.org/pkg/time/#Time.UTC\" rel=\"nofollow noreferrer\"><code>UTC()</code> method</a>, then formatting with the desired output format.</p>\n\n<p>For example (<a href=\"https://play.golang.com/p/lho-8DHDRVk\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>const (\n  INPUT_FORMAT  = \"2006-01-02T15:04:05.999999999-07:00\"\n  OUTPUT_FORMAT = \"2006-01-02T15:04:05.000Z\"\n)\n\nfunc timestampToJavaScriptISO(s string) (string, error) {\n  t, err := time.Parse(INPUT_FORMAT, s)\n  if err != nil {\n    return \"\", err\n  }\n  return t.UTC().Format(OUTPUT_FORMAT), nil\n}\n\nfunc main() {\n  s := \"2018-10-29T11:48:09.180022-04:00\"\n  s2, err := timestampToJavaScriptISO(s)\n  if err != nil {\n    panic(err)\n  }\n\n  fmt.Println(s2)\n  // 2018-10-29T15:48:09.180Z\n}\n</code></pre>\n"}], "owner": {"reputation": 1502, "user_id": 2685083, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Afo3M.jpg?s=128&g=1", "display_name": "Sathish", "link": "https://stackoverflow.com/users/2685083/sathish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 694, "favorite_count": 0, "accepted_answer_id": 53066685, "answer_count": 2, "score": 0, "last_activity_date": 1540921932, "creation_date": 1540909097, "last_edit_date": 1540921932, "question_id": 53066361, "link": "https://stackoverflow.com/questions/53066361/how-to-convert-a-date-with-timezone-to-javascript-iso-format", "title": "How to convert a date with timezone to Javascript ISO format?", "body": "<p>I am trying to convert this date string (\"2018-10-29T11:48:09.180022-04:00\") to ISO format in Go. But not able to do. Can anyone help?</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    l,_ := time.Parse(\"2006-01-02T15:04:05Z07:00\", \"2018-10-29T15:18:20-04:00\")\n    fmt.Println(l, time.Now(), time.Now().UTC().Format(\"2006-01-02T15:04:05Z07:00\"))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2018-10-29 15:18:20 -0400 -0400 2009-11-10 23:00:00 +0000 UTC m=+0.000000001 2009-11-10T23:00:00Z\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/gXw39_Y-hpR\" rel=\"nofollow noreferrer\">https://play.golang.org/p/gXw39_Y-hpR</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1540902660, "post_id": 53064255, "comment_id": 93026995, "body": "That&#39;s not how slices work. See <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">golang.org/doc/faq#convert_slice_of_interface</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": true, "score": 4, "last_activity_date": 1540903893, "last_edit_date": 1540903893, "creation_date": 1540902738, "answer_id": 53064383, "question_id": 53064255, "link": "https://stackoverflow.com/questions/53064255/cannot-use-struct-that-implements-interface/53064383#53064383", "title": "Cannot use struct that implements interface", "body": "<p>This seems counter-intuitive but <code>[]data</code> is of a different type to <code>[]implementation</code> because of how slice types are represented in Go.</p>\n\n<p>This is actually discussed in the the <a href=\"https://github.com/golang/go/wiki/InterfaceSlice\" rel=\"nofollow noreferrer\">Go Wiki</a></p>\n\n<p>Edit: Consider this</p>\n\n<pre><code>var impl []*implementation\nvar data []data = impl\n</code></pre>\n\n<p>The compiler will complain with</p>\n\n<pre><code>cannot use impl (type []*implementation) as type []data in assignment\n</code></pre>\n\n<p>It's more code but you actually have to create a slice of your interface as what the comments in this thread recommends, like so:</p>\n\n<pre><code>var impl []*implementation\nvar data []data\n\n// assuming impl already has values\nfor _, v := range impl {\n    data = append(data, v)\n}\n</code></pre>\n"}], "owner": {"reputation": 3490, "user_id": 1886138, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/02141f6936e61d6e1674a1e49cbafab8?s=128&d=identicon&r=PG", "display_name": "Farseer", "link": "https://stackoverflow.com/users/1886138/farseer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 869, "favorite_count": 1, "closed_date": 1540904865, "accepted_answer_id": 53064383, "answer_count": 1, "score": 3, "last_activity_date": 1540903893, "creation_date": 1540902273, "question_id": 53064255, "link": "https://stackoverflow.com/questions/53064255/cannot-use-struct-that-implements-interface", "closed_reason": "Duplicate", "title": "Cannot use struct that implements interface", "body": "<p>code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype implementation struct {\n    d []int\n}\n\nfunc (impl *implementation) getData() interface{} {\n    return impl.d\n}\n\ntype phase struct{}\n\ntype data interface {\n    getData() interface{}\n}\n\nfunc MakeIntDataPhase() *phase {\n    return &amp;phase{}\n}\n\nfunc (p *phase) run(population []data) []data {\n    return nil\n}\n\nfunc main() {\n    var population []implementation\n    MyPhase := MakeIntDataPhase()\n    fmt.Println(MyPhase.run(population))\n\n}\n</code></pre>\n\n<p>When running following code in playground I got following error: <code>prog.go:30:25: cannot use population (type []implementation) as type []data in argument to MyPhase.run</code></p>\n\n<p>I am new to golang and I don't understand why is this happening?</p>\n\n<p>Struct <code>implementation</code> implements method <code>getData()</code> from <code>data</code> interface. Isn't it enough to use  a slice of <code>implementation</code> in <code>run</code> method? </p>\n\n<p>Where my reasoning is wrong?</p>\n"}, {"tags": ["json", "go", "marshalling"], "answers": [{"comments": [{"owner": {"reputation": 18, "user_id": 10063131, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cQAF1gu3oHs/AAAAAAAAAAI/AAAAAAAAAPc/kFL_zVD1pyo/photo.jpg?sz=128", "display_name": "rudy tjhia", "link": "https://stackoverflow.com/users/10063131/rudy-tjhia"}, "edited": false, "score": 0, "creation_date": 1540953563, "post_id": 53063026, "comment_id": 93049103, "body": "is this j in json.unmarshal([]byte(j),&amp;requests) refer to my json that I send from postman?"}, {"owner": {"reputation": 2957, "user_id": 1248436, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/120a039571e907a64bcfbafda75d472b?s=128&d=identicon&r=PG", "display_name": "mtyurt", "link": "https://stackoverflow.com/users/1248436/mtyurt"}, "reply_to_user": {"reputation": 18, "user_id": 10063131, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cQAF1gu3oHs/AAAAAAAAAAI/AAAAAAAAAPc/kFL_zVD1pyo/photo.jpg?sz=128", "display_name": "rudy tjhia", "link": "https://stackoverflow.com/users/10063131/rudy-tjhia"}, "edited": false, "score": 1, "creation_date": 1541063060, "post_id": 53063026, "comment_id": 93091996, "body": "yes, <code>j</code> should be the json you have sent from the client."}], "tags": [], "owner": {"reputation": 2957, "user_id": 1248436, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/120a039571e907a64bcfbafda75d472b?s=128&d=identicon&r=PG", "display_name": "mtyurt", "link": "https://stackoverflow.com/users/1248436/mtyurt"}, "is_accepted": true, "score": 1, "last_activity_date": 1540897830, "creation_date": 1540897830, "answer_id": 53063026, "question_id": 53062672, "link": "https://stackoverflow.com/questions/53062672/json-marshal-araylist-in-golang/53063026#53063026", "title": "json marshal araylist in golang", "body": "<p>You have multiple issues here:</p>\n\n<ol>\n<li>Tag names don't match the JSON input, e.g. <code>id_employee</code> vs <code>IDEmployee</code>.</li>\n<li>Your tag syntax is not correct, it shows when you run <code>go vet</code>, it should be <code>json:\"id_employee\"</code></li>\n<li><p>You don't need another <code>List</code> struct, if you use it your json should be <code>{\"requests\":[...]}</code>. Instead you can deserialize a slice:</p>\n\n<pre><code>var requests []EmployeeRequest\nif err := json.Unmarshal([]byte(j), &amp;requests); err != nil {\n    log.Fatal(err)\n}\n</code></pre></li>\n</ol>\n\n<p>You can see a running version here: <a href=\"https://play.golang.org/p/HuycpNxE6k8\" rel=\"nofollow noreferrer\">https://play.golang.org/p/HuycpNxE6k8</a></p>\n"}, {"tags": [], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "is_accepted": false, "score": 1, "last_activity_date": 1540897847, "creation_date": 1540897847, "answer_id": 53063033, "question_id": 53062672, "link": "https://stackoverflow.com/questions/53062672/json-marshal-araylist-in-golang/53063033#53063033", "title": "json marshal araylist in golang", "body": "<pre><code>type EmployeeRequest struct {\n    IDEmployee string `json:\"IDEmployee\"`\n    IDBranch   string `json:\"IDBranch\"`\n    IDJob      string `json:\"IDJob\"`\n    Name       string `json:\"name\"`\n    Street     string `json:\"street\"`\n    Phone      string `json:\"phone\"`\n    JoinDate   string `json:\"join_date\"`\n    Status     string `json:\"status\"`\n\n    Enabled int `json:\"enabled\"`\n    Deleted int `json:\"deletedstring\"`\n}\n</code></pre>\n\n<p>some of json tags didn't match with fields.</p>\n"}], "owner": {"reputation": 18, "user_id": 10063131, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cQAF1gu3oHs/AAAAAAAAAAI/AAAAAAAAAPc/kFL_zVD1pyo/photo.jpg?sz=128", "display_name": "rudy tjhia", "link": "https://stackoverflow.com/users/10063131/rudy-tjhia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 53063026, "answer_count": 2, "score": -2, "last_activity_date": 1540897847, "creation_date": 1540896647, "question_id": 53062672, "link": "https://stackoverflow.com/questions/53062672/json-marshal-araylist-in-golang", "title": "json marshal araylist in golang", "body": "<p>Hi there I back to ask again \nsorry if you guys think I lack of searching but been doing this for hours and I still don't get it why</p>\n\n<p>I have a controller like this in Golang :</p>\n\n<pre><code>c3 := router.CreateNewControllerInstance(\"index\", \"/v4\")\nc3.Post(\"/insertEmployee\", insertEmployee)\n</code></pre>\n\n<p>and using <strong>Postman</strong> to throw this arraylist request , the request is like this </p>\n\n<pre><code>[{\n  \"IDEmployee\": \"EMP4570787\",\n  \"IDBranch\": \"ALMST\",\n  \"IDJob\": \"PRG\",\n  \"name\": \"Mikey Ivanyushin\",\n  \"street\": \"1 Bashford Point\",\n  \"phone\": \"9745288064\",\n  \"join_date\": \"2008-09-18\",\n  \"status\": \"fulltime\"\n},{\n  \"IDEmployee\": \"EMP4570787\",\n  \"IDBranch\": \"ALMST\",\n  \"IDJob\": \"PRG\",\n  \"name\": \"Mikey Ivanyushin\",\n  \"street\": \"1 Bashford Point\",\n  \"phone\": \"9745288064\",\n  \"join_date\": \"2008-09-18\",\n  \"status\": \"fulltime\"\n}]\n</code></pre>\n\n<p>and also I have 2 Struct like this </p>\n\n<pre><code>type EmployeeRequest struct {\n    IDEmployee string `json: \"id_employee\"`\n    IDBranch   string `json: \"id_branch\"    `\n    IDJob      string `json: \"id_job\"   `\n    Name       string `json: \"name\" `\n    Street     string `json: \"street\"   `\n    Phone      string `json: \"phone\"    `\n    JoinDate   string `json: \"join_date\"    `\n    Status     string `json: \"status\"   `\n    Enabled int `json: \"enabled\"    `\n    Deleted int `json: \"deletedstring\"`\n}\n\ntype ListEmployeeRequest struct {\n    ListEmployee []EmployeeRequest `json: \"request\"`\n}\n</code></pre>\n\n<p>for some reason the problem start here , when I try to run my function to read the json that I send from Postman</p>\n\n<p>here is the function that I try to run</p>\n\n<pre><code>func insertEmployee(ctx context.Context) {\n    tempReq := services.ListEmployeeRequest{}\n\n    temp1 := ctx.ReadJSON(&amp;tempReq.ListEmployee)\n\n    var err error\n    if err = ctx.ReadJSON(temp1); config.FancyHandleError(err) {\n        fmt.Println(\"err readjson \", err.Error())\n    }\n    parsing, errParsing := json.Marshal(temp1)\n        fmt.Println(\"\", string(parsing))\n    fmt.Print(\"\", errParsing)\n}\n</code></pre>\n\n<p>the problem occur on the line <strong>if err = ctx.ReadJSON(temp1); config.FancyHandleError(err)</strong> \nit tell me that I got unexpected end of JSON input am I doing something wrong there when I throw the request from Postman? or I made a wrong validation code?</p>\n\n<p>can someone tell me what to do next for me to be able to read the JSON that I throw from postman?</p>\n\n<p>thanks for your attention and help , much love &lt;3</p>\n"}, {"tags": ["docker", "go", "gitlab"], "comments": [{"owner": {"reputation": 407, "user_id": 3461549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73440cf71c71747a010d5114de459b10?s=128&d=identicon&r=PG&f=1", "display_name": "msound", "link": "https://stackoverflow.com/users/3461549/msound"}, "edited": false, "score": 0, "creation_date": 1542165062, "post_id": 53061061, "comment_id": 93466667, "body": "Read <a href=\"https://medium.com/@tonistiigi/build-secrets-and-ssh-forwarding-in-docker-18-09-ae8161d066\" rel=\"nofollow noreferrer\">an article</a> today about new improvements in docker that allows sharing secrets during docker build time. Does that help?"}, {"owner": {"reputation": 523, "user_id": 8980988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37b92727f9c9f58bb720a08be26e3d3a?s=128&d=identicon&r=PG&f=1", "display_name": "danielsmith1789", "link": "https://stackoverflow.com/users/8980988/danielsmith1789"}, "reply_to_user": {"reputation": 407, "user_id": 3461549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73440cf71c71747a010d5114de459b10?s=128&d=identicon&r=PG&f=1", "display_name": "msound", "link": "https://stackoverflow.com/users/3461549/msound"}, "edited": false, "score": 0, "creation_date": 1542390329, "post_id": 53061061, "comment_id": 93564686, "body": "I am using this approach for my environment variables that I need to inject into my containers, this doesn&#39;t really apply to using a private repository as a pkg in my gland project."}], "answers": [{"tags": [], "owner": {"reputation": 523, "user_id": 8980988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37b92727f9c9f58bb720a08be26e3d3a?s=128&d=identicon&r=PG&f=1", "display_name": "danielsmith1789", "link": "https://stackoverflow.com/users/8980988/danielsmith1789"}, "is_accepted": true, "score": 0, "last_activity_date": 1542390264, "creation_date": 1542390264, "answer_id": 53342910, "question_id": 53061061, "link": "https://stackoverflow.com/questions/53061061/using-a-gitlab-private-repo-as-a-golang-dependancy-in-docker/53342910#53342910", "title": "Using a gitlab private repo as a golang dependancy in docker", "body": "<p>It appears that golang v1.11 includes <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">modules</a>.</p>\n\n<p>To quote the source</p>\n\n<blockquote>\n  <p>A module is a collection of related Go packages that are versioned together as a single unit. Most often, a single version-control repository corresponds exactly to a single module.</p>\n</blockquote>\n\n<p>Using the latest version of golang along with modules allows me to use all of my dependencies. </p>\n"}], "owner": {"reputation": 523, "user_id": 8980988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37b92727f9c9f58bb720a08be26e3d3a?s=128&d=identicon&r=PG&f=1", "display_name": "danielsmith1789", "link": "https://stackoverflow.com/users/8980988/danielsmith1789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1461, "favorite_count": 0, "accepted_answer_id": 53342910, "answer_count": 1, "score": 5, "last_activity_date": 1542390264, "creation_date": 1540891639, "last_edit_date": 1541059573, "question_id": 53061061, "link": "https://stackoverflow.com/questions/53061061/using-a-gitlab-private-repo-as-a-golang-dependancy-in-docker", "title": "Using a gitlab private repo as a golang dependancy in docker", "body": "<p>I am mirroring a popular go library in my organizations gitlab's group (for redundancy).</p>\n\n<p>In my code I have: <code>import ( \"gitlab.com/org/group/library.git\" )</code></p>\n\n<p>I used <a href=\"https://stackoverflow.com/a/27501172/8980988\">this answer</a> for guidance on using go get with a private repository. On my machine <code>go get ./...</code> works because I configured git using the following command: </p>\n\n<pre><code>$ git config --global url.git@gitlab.com:.insteadOf https://gitlab.com/\n</code></pre>\n\n<p>When I try to build a docker container the command <code>RUN go get ./...</code> fails with the following output: </p>\n\n<pre><code>package gitlab.com/org/group/library.git: cannot download, git://gitlab.com/org/group/library uses insecure protocol\n</code></pre>\n\n<p>It seems the popular answer from a <a href=\"https://stackoverflow.com/questions/26161541/docker-go-get-from-a-private-github-repo\">similar thread</a> or <a href=\"https://divan.github.io/posts/go_get_private/\" rel=\"nofollow noreferrer\">this article</a> is to do something like upload your ssh keys to the docker container. I don't really feel comfortable with that because I don't exactly understand what is doing, or the security implications. </p>\n\n<p>Any insight on how to properly configure my dockerfile or my golang work flow would be of great assistance. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1540886941, "post_id": 53059641, "comment_id": 93018309, "body": "<a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">golang.org/doc/faq#convert_slice_of_interface</a>"}, {"owner": {"reputation": 343, "user_id": 4463948, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh3.googleusercontent.com/-S4sJgV9C73Y/AAAAAAAAAAI/AAAAAAAAAK8/T0-k3cyZu54/photo.jpg?sz=128", "display_name": "tsuda7", "link": "https://stackoverflow.com/users/4463948/tsuda7"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1540887495, "post_id": 53059641, "comment_id": 93018509, "body": "Thanks Volker, the link seems really helpful!"}], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 4463948, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh3.googleusercontent.com/-S4sJgV9C73Y/AAAAAAAAAAI/AAAAAAAAAK8/T0-k3cyZu54/photo.jpg?sz=128", "display_name": "tsuda7", "link": "https://stackoverflow.com/users/4463948/tsuda7"}, "edited": false, "score": 1, "creation_date": 1540887524, "post_id": 53059817, "comment_id": 93018516, "body": "Thank you for your answer, I understand."}], "tags": [], "owner": {"reputation": 2505, "user_id": 1929635, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/adQln.png?s=128&g=1", "display_name": "boaz_shuster", "link": "https://stackoverflow.com/users/1929635/boaz-shuster"}, "is_accepted": true, "score": 5, "last_activity_date": 1540887247, "last_edit_date": 1540887247, "creation_date": 1540886733, "answer_id": 53059817, "question_id": 53059641, "link": "https://stackoverflow.com/questions/53059641/notation-in-append-doesnt-work-for-appending-different-type-slices/53059817#53059817", "title": "&quot;...&quot; notation in append() doesn&#39;t work for appending different type slices", "body": "<p>The problem is that <code>interface{}</code> and <code>string</code> are two different types.\nTo convert a slice from <code>string</code> to <code>interface{}</code> you will have to do it in one of the following ways:</p>\n\n<p>create sliceA and initialize its size to sliceX length</p>\n\n<pre><code>sliceA := make([]A, len(sliceX))\nfor ix, item := range sliceX {\n    sliceA[ix] = item\n}\n</code></pre>\n\n<p>dynamically append sliceX items to appendedSlice</p>\n\n<pre><code>var appendedSlice []A\nfor ix := range sliceX {\n    appendedSlice = append(appendedSlice, sliceX[ix])\n}\n</code></pre>\n\n<p>Please read more here\n<a href=\"https://stackoverflow.com/questions/27689058/convert-string-to-interface\">Convert []string to []interface{}</a></p>\n"}], "owner": {"reputation": 343, "user_id": 4463948, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh3.googleusercontent.com/-S4sJgV9C73Y/AAAAAAAAAAI/AAAAAAAAAK8/T0-k3cyZu54/photo.jpg?sz=128", "display_name": "tsuda7", "link": "https://stackoverflow.com/users/4463948/tsuda7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "accepted_answer_id": 53059817, "answer_count": 1, "score": 0, "last_activity_date": 1540888546, "creation_date": 1540885968, "last_edit_date": 1540888546, "question_id": 53059641, "link": "https://stackoverflow.com/questions/53059641/notation-in-append-doesnt-work-for-appending-different-type-slices", "title": "&quot;...&quot; notation in append() doesn&#39;t work for appending different type slices", "body": "<p>I need an abstracted slice that contains multiple types. The most simplified code is this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype A interface{}\n\ntype X string\n\nfunc main() {\n    sliceA := make([]A, 0, 0)\n    sliceX := []X{\"x1\", \"x2\"}\n    var appendedSlice []A\n    appendedSlice = append(sliceA, sliceX[0], sliceX[1])  // (1) works\n    appendedSlice = append(sliceA, sliceX...)             // (2) doesn't work\n    fmt.Println(appendedSlice)\n\n}\n</code></pre>\n\n<p>In my real program, the interface A defines some functions, and X and also other types implement it.</p>\n\n<p>Line (2) raises an error <code>cannot use sliceX (type []X) as type []A in append</code>.</p>\n\n<p>I thought (2) is a syntax sugar for (1), but I'm probably missing something... Do I have to always add an element X into slice A one by one?</p>\n\n<p>Thank you guys in advance!</p>\n"}, {"tags": ["api", "go", "bad-gateway"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1540882552, "post_id": 53058778, "comment_id": 93016508, "body": "That sounds like <i>maybe</i> the API is broken but more importantly, what&#39;s your question?"}], "answers": [{"comments": [{"owner": {"reputation": 5283, "user_id": 6336221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Rh8CEJ_IGpA/AAAAAAAAAAI/AAAAAAAAALc/VV4nk6Yyqhg/photo.jpg?sz=128", "display_name": "Nisal Edu", "link": "https://stackoverflow.com/users/6336221/nisal-edu"}, "edited": false, "score": 0, "creation_date": 1540884156, "post_id": 53059169, "comment_id": 93017143, "body": "Thank, this is the issue I just contact our AWS guy"}], "tags": [], "owner": {"reputation": 124, "user_id": 4129127, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-e7dDFf8tF8s/AAAAAAAAAAI/AAAAAAAACvA/wDSMzf1XvJE/photo.jpg?sz=128", "display_name": "Allen Koch", "link": "https://stackoverflow.com/users/4129127/allen-koch"}, "is_accepted": true, "score": 2, "last_activity_date": 1540883846, "creation_date": 1540883846, "answer_id": 53059169, "question_id": 53058778, "link": "https://stackoverflow.com/questions/53058778/502-error-comes-for-api-call-one-after-the-other/53059169#53059169", "title": "502 error comes for API call one after the other", "body": "<p>Looks like issue happened because of the load balancing. Normally round-robin routing policy is used in load balancing. For example, if you have two servers one request goes for the first one and other one goes for the other server. So for your question, the first request is going for the working server and other is going for the non-working server. Check whether your other servers are working properly.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9092620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fbec5458be6c28dceedb930dab2d94?s=128&d=identicon&r=PG&f=1", "display_name": "zbwzbw", "link": "https://stackoverflow.com/users/9092620/zbwzbw"}, "is_accepted": false, "score": -1, "last_activity_date": 1540895947, "creation_date": 1540895947, "answer_id": 53062465, "question_id": 53058778, "link": "https://stackoverflow.com/questions/53058778/502-error-comes-for-api-call-one-after-the-other/53062465#53062465", "title": "502 error comes for API call one after the other", "body": "<p>You may need to check the circulation of IP data transmission between different computers under its control.</p>\n"}], "owner": {"reputation": 5283, "user_id": 6336221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Rh8CEJ_IGpA/AAAAAAAAAAI/AAAAAAAAALc/VV4nk6Yyqhg/photo.jpg?sz=128", "display_name": "Nisal Edu", "link": "https://stackoverflow.com/users/6336221/nisal-edu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 53059169, "answer_count": 2, "score": 1, "last_activity_date": 1540895947, "creation_date": 1540882088, "question_id": 53058778, "link": "https://stackoverflow.com/questions/53058778/502-error-comes-for-api-call-one-after-the-other", "title": "502 error comes for API call one after the other", "body": "<p>I'm experiencing kind of weird error, I'm calling API (which written in golang) to get access token, that API returns the correct value for one time but if I send that API call again it returns 502 error code, then if I call that API once again it will return the correct value. this happens one after the other.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 432, "user_id": 6340231, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mHxBsfkZqiQ/AAAAAAAAAAI/AAAAAAAAAtU/ToLwyfBT1HM/photo.jpg?sz=128", "display_name": "Abhay Kumar", "link": "https://stackoverflow.com/users/6340231/abhay-kumar"}, "edited": false, "score": 0, "creation_date": 1540878929, "post_id": 53058148, "comment_id": 93015196, "body": "Thanks peterSO for the solution. Its really clean one."}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 432, "user_id": 6340231, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mHxBsfkZqiQ/AAAAAAAAAAI/AAAAAAAAAtU/ToLwyfBT1HM/photo.jpg?sz=128", "display_name": "Abhay Kumar", "link": "https://stackoverflow.com/users/6340231/abhay-kumar"}, "edited": false, "score": 0, "creation_date": 1540880688, "post_id": 53058148, "comment_id": 93015790, "body": "@AbhayKumar if you feel this answer solves your problem, kindly please approve it. for more information please read <a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1540878978, "last_edit_date": 1540878978, "creation_date": 1540878594, "answer_id": 53058148, "question_id": 53058108, "link": "https://stackoverflow.com/questions/53058108/how-to-declare-uint8-in-for-loop-initialization-as-var-is-not-allowed-in-for-lo/53058148#53058148", "title": "How to declare uint8 in for-loop initialization, as var is not allowed in for loop initialization", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec#Variable_declarations\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Variable_declarations\" rel=\"nofollow noreferrer\">Variable declarations</a></p>\n  \n  <p>... each variable is given the type of the corresponding\n  initialization value in the assignment.</p>\n</blockquote>\n\n<hr>\n\n<p><code>i := uint(0)</code>. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var pc [256]byte\n\n    for i := range pc {\n        pc[i] = pc[i/2] + byte(i&amp;1)\n    }\n\n    var x uint64 = 65535\n    var population uint8\n\n    for i := uint(0); i &lt; 8; i++ {\n        population = population + pc[byte(x&gt;&gt;(i*8))]\n    }\n\n    fmt.Printf(\"Population Count: %d\", population)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/H_4cn9w_dOq\" rel=\"nofollow noreferrer\">https://play.golang.org/p/H_4cn9w_dOq</a></p>\n\n<p>Output:</p>\n\n<pre><code>Population Count: 16\n</code></pre>\n"}], "owner": {"reputation": 432, "user_id": 6340231, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mHxBsfkZqiQ/AAAAAAAAAAI/AAAAAAAAAtU/ToLwyfBT1HM/photo.jpg?sz=128", "display_name": "Abhay Kumar", "link": "https://stackoverflow.com/users/6340231/abhay-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1131, "favorite_count": 1, "accepted_answer_id": 53058148, "answer_count": 1, "score": 3, "last_activity_date": 1540878978, "creation_date": 1540878322, "question_id": 53058108, "link": "https://stackoverflow.com/questions/53058108/how-to-declare-uint8-in-for-loop-initialization-as-var-is-not-allowed-in-for-lo", "title": "How to declare uint8 in for-loop initialization, as var is not allowed in for loop initialization", "body": "<p>I am writing following code to calculate Population Count as below:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var pc [256]byte\n\n    for i := range pc {\n        pc[i] = pc[i/2] + byte(i&amp;1)\n    }\n\n    var x uint64 = 65535\n    var population uint8\n\n    for i := 0; i &lt; 8; i++ {\n        population  = population + pc[byte(x&gt;&gt;(i*8))]\n    }\n\n    fmt.Printf(\"Population Count: %d\", population)\n}\n</code></pre>\n\n<p>On compilation I get following error:</p>\n\n<blockquote>\n  <p>prog.go:19:39: invalid operation: x >> (i * 8) (shift count type int,\n  must be unsigned integer)</p>\n</blockquote>\n\n<p>The problem is with the variable <code>i</code> which is declared while initializing the for loop. The shorthand initialization of <code>i</code> makes it of type <code>int</code> which in internally of type <code>signed int32</code>. This is why the following line:</p>\n\n<pre><code>population  = population + pc[byte(x&gt;&gt;(i*8))]\n</code></pre>\n\n<p>is causing the problem. Because shift operator <code>&gt;&gt;</code> is expecting only unsigned integer, but the expression <code>i*8</code> results into <code>int</code> which is internally <code>signed int32</code>.</p>\n\n<p>As <code>var</code> can not be used in <code>for</code> initialization. </p>\n\n<pre><code>for var i uint8 = 0; i &lt; 8; i++ { ... }\n</code></pre>\n\n<blockquote>\n  <p>syntax error: var declaration not allowed in for initializer</p>\n</blockquote>\n\n<p>I can declare variable <code>i</code> outside of <code>for loop</code>, but I do not find it clean and readable.</p>\n\n<p>What should be the clean way to achieve the same?</p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1540880072, "post_id": 53057869, "comment_id": 93015565, "body": "can you please give us more codes? or near-complete code? because the <code>DbUpdateAll</code> function is not from mgo"}, {"owner": {"reputation": 25, "user_id": 9999536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f05a59f4a6460df7878bf32a305c91d?s=128&d=identicon&r=PG&f=1", "display_name": "ansh", "link": "https://stackoverflow.com/users/9999536/ansh"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1540881008, "post_id": 53057869, "comment_id": 93015903, "body": "@xpare see the update"}, {"owner": {"reputation": 912, "user_id": 5881773, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/479bdf67986817e8c9b23d53b020ba5c?s=128&d=identicon&r=PG&f=1", "display_name": "Vipul", "link": "https://stackoverflow.com/users/5881773/vipul"}, "edited": false, "score": 0, "creation_date": 1540892138, "post_id": 53057869, "comment_id": 93020950, "body": "@ansh as you cant add a limit on update /updateMany or update with multi True"}, {"owner": {"reputation": 25, "user_id": 9999536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f05a59f4a6460df7878bf32a305c91d?s=128&d=identicon&r=PG&f=1", "display_name": "ansh", "link": "https://stackoverflow.com/users/9999536/ansh"}, "reply_to_user": {"reputation": 912, "user_id": 5881773, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/479bdf67986817e8c9b23d53b020ba5c?s=128&d=identicon&r=PG&f=1", "display_name": "Vipul", "link": "https://stackoverflow.com/users/5881773/vipul"}, "edited": false, "score": 0, "creation_date": 1540894469, "post_id": 53057869, "comment_id": 93022356, "body": "@vipul is there is any method in golang which is used to update the documents in the given limit"}, {"owner": {"reputation": 912, "user_id": 5881773, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/479bdf67986817e8c9b23d53b020ba5c?s=128&d=identicon&r=PG&f=1", "display_name": "Vipul", "link": "https://stackoverflow.com/users/5881773/vipul"}, "edited": false, "score": 0, "creation_date": 1540902846, "post_id": 53057869, "comment_id": 93027083, "body": "no there isnt any such method. If you have criteria then you add use that eg. db.users.update({&quot;_id:{$in:[1,2,4,5,6,]}},{update value});"}], "owner": {"reputation": 25, "user_id": 9999536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f05a59f4a6460df7878bf32a305c91d?s=128&d=identicon&r=PG&f=1", "display_name": "ansh", "link": "https://stackoverflow.com/users/9999536/ansh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1639, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540884239, "creation_date": 1540876761, "last_edit_date": 1540884239, "question_id": 53057869, "link": "https://stackoverflow.com/questions/53057869/how-to-update-many-documents-in-mongodb-using-golang", "title": "How to update many documents in mongodb using golang", "body": "<p>While reading the update many records <a href=\"https://docs.mongodb.com/manual/reference/method/db.collection.update/\" rel=\"nofollow noreferrer\">link</a>. There is mongodb shell query which is used to update many records in the db. Then I want to implement below given query in the golang for update many documents. I also check the <a href=\"https://godoc.org/gopkg.in/mgo.v2#Bulk.UpdateAll\" rel=\"nofollow noreferrer\">mgo</a> document There is a function which update many documents But it will take only two parameters first is <code>selector</code> and other one is the <code>update</code>. But in the mongodb <a href=\"https://docs.mongodb.com/manual/reference/method/db.collection.update/\" rel=\"nofollow noreferrer\">link</a> there are three parameters we have to pass in the query. In the collection there are 200k records and I have only update the 2000 records. I want to implement the below query in the golang:</p>\n\n<pre><code>db.collection.update(\n &lt;query&gt;,\n &lt;update&gt;,\n {\n   upsert: &lt;boolean&gt;,\n   multi: &lt;boolean&gt;,\n   writeConcern: &lt;document&gt;,\n   collation: &lt;document&gt;,\n   arrayFilters: [ &lt;filterdocument1&gt;, ... ]\n  }\n)\n</code></pre>\n\n<p>I used it like this:</p>\n\n<pre><code>UpdateAll(config.BookingsCollection, nil, bson.M{\"$set\": bson.M{\"is_price_field\": 1}}).Limit(2000)\n</code></pre>\n\n<p>It will gives me the error:</p>\n\n<blockquote>\n  <p>multiple-value UpdateAll() in single-value context</p>\n</blockquote>\n\n<p>When I remove the Limit(2000) then it will show no error but it will not satisfy my result.</p>\n\n<p><strong>Updated</strong> </p>\n\n<p>Basically I'm following the MVC structure</p>\n\n<p>Controllers:</p>\n\n<pre><code>func BulkUpdateBookings(c *gin.Context) {\n err := models.UpdateBulkBookingsDb()\n fmt.Println(err)\n}\n</code></pre>\n\n<p>Models:</p>\n\n<pre><code>func UpdateBulkBookingsDb() (err error) {\n  mongoSession := config.ConnectDb()// database connection\n  defer mongoSession.Close()\n  sessionCopy := mongoSession.Copy()\n  defer sessionCopy.Close()\n  getCollection := sessionCopy.DB(Database).C(collection)\n   _, err = getCollection.UpdateAll(nil, bson.M{\"$set\": bson.M{\"is_price_update\": 0}})\n  return err\n}\n</code></pre>\n"}, {"tags": ["go", "scheduled-tasks", "scheduler"], "comments": [{"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 1, "creation_date": 1540872561, "post_id": 53057237, "comment_id": 93013511, "body": "<code>I found some implementation in go by using Timer, but not satisfied for the production use-case.</code> we need more explanation about this one why are you not satisfied"}, {"owner": {"reputation": 656, "user_id": 6793457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHWs1.jpg?s=128&g=1", "display_name": "Siddhanta Rath", "link": "https://stackoverflow.com/users/6793457/siddhanta-rath"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1540872792, "post_id": 53057237, "comment_id": 93013559, "body": "Need pool of routines for executing one task per routine and no memory leakage :) @xpare"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 2, "creation_date": 1540873658, "post_id": 53057237, "comment_id": 93013764, "body": "I would say that needing a pool of routines sounds like something a go routine will fill. Ranging a timer and stopping it when you&#39;re done will not leak memory"}], "answers": [{"comments": [{"owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "edited": false, "score": 4, "creation_date": 1540873444, "post_id": 53057336, "comment_id": 93013714, "body": "Actually it would be best to use a <a href=\"https://golang.org/pkg/time/#NewTicker\" rel=\"nofollow noreferrer\">time.Ticker</a>"}, {"owner": {"reputation": 656, "user_id": 6793457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHWs1.jpg?s=128&g=1", "display_name": "Siddhanta Rath", "link": "https://stackoverflow.com/users/6793457/siddhanta-rath"}, "reply_to_user": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "edited": false, "score": 0, "creation_date": 1540873906, "post_id": 53057336, "comment_id": 93013832, "body": "@Ullaakut can you give one example ?"}, {"owner": {"reputation": 656, "user_id": 6793457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHWs1.jpg?s=128&g=1", "display_name": "Siddhanta Rath", "link": "https://stackoverflow.com/users/6793457/siddhanta-rath"}, "edited": false, "score": 0, "creation_date": 1540874385, "post_id": 53057336, "comment_id": 93013941, "body": "you guys are awesome. Thank you all :)"}, {"owner": {"reputation": 656, "user_id": 6793457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHWs1.jpg?s=128&g=1", "display_name": "Siddhanta Rath", "link": "https://stackoverflow.com/users/6793457/siddhanta-rath"}, "edited": false, "score": 1, "creation_date": 1541131905, "post_id": 53057336, "comment_id": 93120010, "body": "@xpare approved it. Thanks again. :)"}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 21, "last_activity_date": 1603364119, "last_edit_date": 1603364119, "creation_date": 1540873002, "answer_id": 53057336, "question_id": 53057237, "link": "https://stackoverflow.com/questions/53057237/how-to-schedule-a-task-at-go-periodically/53057336#53057336", "title": "How to schedule a task at go periodically?", "body": "<p>No need to use 3rd party library to achieve that. Simply take the advantage of goroutine and use available <code>time.Sleep()</code> API from <code>time</code> package, then the very same result can be achieved.</p>\n<p>Example:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>go func() {\n    for true {\n        fmt.Println(&quot;Hello !!&quot;)\n        time.Sleep(1 * time.Second)\n    }\n}()\n</code></pre>\n<p>Playground: <a href=\"https://play.golang.org/p/IMV_IAt-VQX\" rel=\"nofollow noreferrer\">https://play.golang.org/p/IMV_IAt-VQX</a></p>\n<hr />\n<h2>Example using ticker #1</h2>\n<p>As per suggestion from Siddhanta. Here is one example to achieve the same result by using ticker (taken from <a href=\"https://golang.org/pkg/time/#NewTicker\" rel=\"nofollow noreferrer\">go documentation page of ticker</a>, with some modifications following your requirement).</p>\n<pre class=\"lang-golang prettyprint-override\"><code>done := make(chan bool)\nticker := time.NewTicker(1 * time.Second)\n\ngo func() {\n    for {\n        select {\n        case &lt;-done:\n            ticker.Stop()\n            return\n        case &lt;-ticker.C:\n            fmt.Println(&quot;Hello !!&quot;)\n        }\n    }\n}()\n\n// wait for 10 seconds\ntime.Sleep(10 *time.Second)\ndone &lt;- true\n</code></pre>\n<p>The ticker time information (the time when the <code>Hello !!</code> executed) can be taken from <code>ticker.C</code> channel.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>case t := &lt;-ticker.C:\n    fmt.Println(t)\n</code></pre>\n<p>Playground: <a href=\"https://play.golang.org/p/TN2M-AMr39L\" rel=\"nofollow noreferrer\">https://play.golang.org/p/TN2M-AMr39L</a></p>\n<hr />\n<h2>Example using ticker #2</h2>\n<p>Another simplified example of ticker, taken from <a href=\"https://gobyexample.com/tickers\" rel=\"nofollow noreferrer\">https://gobyexample.com/tickers</a></p>\n<pre class=\"lang-golang prettyprint-override\"><code>ticker := time.NewTicker(1 * time.Second)\ngo func() {\n    for range ticker.C {\n        fmt.Println(&quot;Hello !!&quot;)\n    }\n}()\n\n// wait for 10 seconds\ntime.Sleep(10 *time.Second)\nticker.Stop()\n</code></pre>\n"}], "owner": {"reputation": 656, "user_id": 6793457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHWs1.jpg?s=128&g=1", "display_name": "Siddhanta Rath", "link": "https://stackoverflow.com/users/6793457/siddhanta-rath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10124, "favorite_count": 2, "accepted_answer_id": 53057336, "answer_count": 1, "score": 13, "last_activity_date": 1610966226, "creation_date": 1540872260, "last_edit_date": 1563975735, "question_id": 53057237, "link": "https://stackoverflow.com/questions/53057237/how-to-schedule-a-task-at-go-periodically", "title": "How to schedule a task at go periodically?", "body": "<p>Is there any native library or third party support like <code>ScheduledExecutorService</code> by java native library at go lang for production use case? </p>\n\n<p>Please find the code snippet in java 1.8 :</p>\n\n<pre><code>import java.util.concurrent.Executors;\nimport java.util.concurrent.ScheduledExecutorService;\nimport java.util.concurrent.TimeUnit;\n\n\npublic class TaskScheduler {\n\n    /**\n     * @param args\n     */\n    public static void main(String[] args) {\n        Runnable runnable = ()-&gt; {\n                // task to run goes here\n                System.out.println(\"Hello !!\");\n        };\n        ScheduledExecutorService service = Executors.newScheduledThreadPool(1);\n        service.scheduleAtFixedRate(runnable, 0, 1, TimeUnit.SECONDS);\n\n    }\n\n}\n</code></pre>\n\n<p>It will print <code>Hello !!</code> in every one second.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1540874124, "post_id": 53056800, "comment_id": 93013882, "body": "That&#39;s not how HTTP works. Get your HTTP request-response chains straight first."}, {"owner": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1540932609, "post_id": 53056800, "comment_id": 93043790, "body": "huh?what do you mean?"}], "answers": [{"comments": [{"owner": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "edited": false, "score": 0, "creation_date": 1540872485, "post_id": 53056920, "comment_id": 93013495, "body": "Is there another way to do what I&#39;m after?"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "edited": false, "score": 0, "creation_date": 1540873137, "post_id": 53056920, "comment_id": 93013633, "body": "Hard to say. A GET and a POST are deliberately different. If you just want to communicate that a GET is invalid, then a 405 is a good choice."}, {"owner": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "edited": false, "score": 0, "creation_date": 1540932566, "post_id": 53056920, "comment_id": 93043763, "body": "It seems more like a bug because the redirect is not honoring the request I send it.  You feed the function a request and then the function ignores the request."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "edited": false, "score": 0, "creation_date": 1540941054, "post_id": 53056920, "comment_id": 93046579, "body": "So you might be looking for httputil.ReverseProxy. a redirect just instructs the client where to look"}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 2, "last_activity_date": 1540869773, "creation_date": 1540869773, "answer_id": 53056920, "question_id": 53056800, "link": "https://stackoverflow.com/questions/53056800/how-do-i-redirect-a-get-request-to-a-post-request-with-some-data/53056920#53056920", "title": "How do I redirect a GET request to a POST request with some data?", "body": "<p>Unfortunately I don't believe a redirect can change the verb (e.g., <code>GET</code>, <code>POST</code>) or add data to the request. It can only change the URL.</p>\n\n<p>See <a href=\"https://golang.org/pkg/net/http/#Redirect\" rel=\"nofollow noreferrer\">Redirect ()</a> for more information.</p>\n"}, {"tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": false, "score": 4, "last_activity_date": 1540882681, "creation_date": 1540882681, "answer_id": 53058902, "question_id": 53056800, "link": "https://stackoverflow.com/questions/53056800/how-do-i-redirect-a-get-request-to-a-post-request-with-some-data/53058902#53058902", "title": "How do I redirect a GET request to a POST request with some data?", "body": "<p>A HTTP redirect (i.e. reply with status code 301, 302, 307,308 and <code>Location</code> header) can only redirect the existing request to another location and not change the payload of the request. It can add some cookies in the response header though.</p>\n\n<p>In order to automatically change a GET request into a POST request with a specific payload you might try to send the client a HTML page with a <code>&lt;form method=POST...</code> and the payload with hidden input fields, i.e. <code>&lt;input name=... value=... type=hidden&gt;</code> and then add some JavaScript to the page which automatically submits the form. But this kind of hack will only work in browsers and only if JavaScript is enabled and will not work with all kind of payloads either.</p>\n\n<p>To keep compatibility with a broader range of clients it is probably better to design it differently, i.e. keep the GET request in the redirect but give the necessary payload as a parameter to the new target, i.e. <code>http://new.target/foo?payload=....</code>. But the details depend on what the target of the request can deal with.</p>\n"}, {"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1541019361, "creation_date": 1541019361, "answer_id": 53091836, "question_id": 53056800, "link": "https://stackoverflow.com/questions/53056800/how-do-i-redirect-a-get-request-to-a-post-request-with-some-data/53091836#53091836", "title": "How do I redirect a GET request to a POST request with some data?", "body": "<p>I've never heard about changing verb from GET to POST. I guess it's impossible because POST supposes body of body (however may be empty) and GET doesn't. So in general case browser would not be able to take the body from nothing.\nOtherwise is possible: you may send 302 redirect after post to make browser perform get. Also verb can be kept with 307 reply code.</p>\n\n<p>Try to rethink browser-server interaction. May be you can redirect POST to another location to solve a task?</p>\n"}], "owner": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1673, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1541019361, "creation_date": 1540868747, "question_id": 53056800, "link": "https://stackoverflow.com/questions/53056800/how-do-i-redirect-a-get-request-to-a-post-request-with-some-data", "title": "How do I redirect a GET request to a POST request with some data?", "body": "<p>When a user hits a certain url with a GET request I'd like to redirect them to a POST request at another location. </p>\n\n<pre><code>package main\n\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"net/url\"\n)\n\nfunc old(w http.ResponseWriter, r *http.Request) {\n    newURL := \"/new\"\n    var bdy = []byte(`title=Buy cheese and bread for breakfast.`)\n\n    r.Method = \"POST\"\n    r.URL, _ = url.Parse(newURL)\n    r.RequestURI = newURL\n    r.Body = ioutil.NopCloser(bytes.NewReader(bdy))\n    r.Header.Set(\"Content-Type\", \"application/x-www-form-urlencoded\")\n    http.Redirect(w, r, newURL, 302)\n}\n\nfunc new(w http.ResponseWriter, r *http.Request) {\n    r.ParseForm()\n    fmt.Printf(\"Method:%v\\n\", r.Method)\n    fmt.Printf(\"Title:%v\\n\", r.Form.Get(\"title\"))\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", old)\n    http.HandleFunc(\"/new\", new)\n    port := 8000\n    fmt.Printf(\"listening on %v\\n\", port)\n    if err := http.ListenAndServe(fmt.Sprintf(\":%v\", port), nil); err != nil {\n        log.Fatal(\"ListenAndServe: \", err)\n    }\n}\n</code></pre>\n\n<p>When I hit \"/\" I end up getting redirected to \"/new\" but with a GET request and no form data:</p>\n\n<pre><code>Method:GET\nTitle:\n</code></pre>\n\n<p>If I curl \"/new\" directly I get :</p>\n\n<pre><code>curl -XPOST localhost:8000/new -d \"title=Buy cheese and bread for breakfast.\"\n\nMethod:POST\nTitle:Buy cheese and bread for breakfast.\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "aws-lambda", "amazon-cognito"], "answers": [{"tags": [], "owner": {"reputation": 178, "user_id": 5396095, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IDb1FSLNLzk/AAAAAAAAAAI/AAAAAAAAAC0/yy90p8_VuMM/photo.jpg?sz=128", "display_name": "Mohammad Nasirifar", "link": "https://stackoverflow.com/users/5396095/mohammad-nasirifar"}, "is_accepted": true, "score": 2, "last_activity_date": 1540867052, "creation_date": 1540867052, "answer_id": 53056610, "question_id": 53056000, "link": "https://stackoverflow.com/questions/53056000/how-to-create-an-authentication-middleware-inside-an-aws-lambda/53056610#53056610", "title": "How to create an authentication middleware inside an AWS Lambda", "body": "<p>1st question about using the middleware:</p>\n\n<p>There is certainly nothing wrong with the approach. Maybe the function will look a little better if you define the function type and use the defined name. <code>net/http</code> does the same thing with the <code>HandlerFunc</code>:</p>\n\n<pre><code>type HandlerFunc func(ResponseWriter, *Request)\n</code></pre>\n\n<p>Which will make the signature of a middleware more reasonable:</p>\n\n<pre><code>func AuthMiddleware(nextHop HandlerFunc) HandlerFunc\n</code></pre>\n\n<p>EDIT: doesn't the lambda library define such a type for the function signature? I would expect one to exist.</p>\n\n<p>Also I don't know if the suffix <code>Middleware</code> makes sense in your case, but I think <em>some suffix</em> should make sense for you to give a little more context to the name of the function and make it more understandable. <code>AuthenticationMiddleware</code> could be an example.</p>\n\n<p>EDIT: just saw the package name. LGTM really.</p>\n\n<p>2nd question:</p>\n\n<p>See <a href=\"https://golang.org/pkg/context/#example_WithValue\" rel=\"nofollow noreferrer\">this</a> for the correct use of <code>context</code>. There's also a common pitfal: <code>context.WithValue</code> returns a new context to use. Therefore you should not expect the passed parameter context to be mutated and should use the new one that is returned.</p>\n"}], "owner": {"reputation": 153, "user_id": 10542686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A-EjroLSsEo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAhns3lDS_jtO57Lpdlfk1kFTjhZA/mo/photo.jpg?sz=128", "display_name": "Evanusso", "link": "https://stackoverflow.com/users/10542686/evanusso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1043, "favorite_count": 2, "accepted_answer_id": 53056610, "answer_count": 1, "score": 1, "last_activity_date": 1540870194, "creation_date": 1540861759, "last_edit_date": 1540870194, "question_id": 53056000, "link": "https://stackoverflow.com/questions/53056000/how-to-create-an-authentication-middleware-inside-an-aws-lambda", "title": "How to create an authentication middleware inside an AWS Lambda", "body": "<p>I'm using AWS Cognito to authenticate my users, and once authenticated, they can call my API (API Gateway + Lambda). I'm doing all that using the Serverless Framework.</p>\n\n<p>Once authenticated, when they call an endpoint that requires this authentication, my lambda will receive the user attributes through the <code>request.RequestContext.Authorizer[\"claims\"]</code>. I had the idea of creating an authentication middleware to inject the current user into the context. But I'm certain that I'm doing something wrong (or can be improved).</p>\n\n<p>How it works:</p>\n\n<p>my-lambda.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n\n    \"github.com/aws/aws-lambda-go/events\"\n    \"github.com/aws/aws-lambda-go/lambda\"\n    \"github.com/company/api/middlewares\"\n)\n\nfunc Handler(ctx context.Context, request events.APIGatewayProxyRequest) (events.APIGatewayProxyResponse, error) {\n    fmt.Println(ctx.user)\n\n    return events.APIGatewayProxyResponse{}, nil\n}\n\nfunc main() {\n    lambda.Start(\n        middlewares.Authentication(Handler),\n    )\n}\n</code></pre>\n\n<p>middlewares/authentication.go</p>\n\n<pre><code>package middlewares\n\nimport (\n    \"context\"\n\n    \"github.com/aws/aws-lambda-go/events\"\n    \"github.com/company/api/models\"\n)\n\nfunc Authentication(next func(context.Context, events.APIGatewayProxyRequest) (events.APIGatewayProxyResponse, error)) func(context.Context, events.APIGatewayProxyRequest) (events.APIGatewayProxyResponse, error) {\n    var user models.User\n\n    return func(ctx context.Context, request events.APIGatewayProxyRequest) (events.APIGatewayProxyResponse, error) {\n        claims := request.RequestContext.Authorizer[\"claims\"]\n\n        // Find user by claims properties.\n        if err := user.Current(claims); err != nil {\n            return events.APIGatewayProxyResponse{}, err\n        }\n\n        ctx.user = user\n        return next(ctx, request)\n    }\n}\n</code></pre>\n\n<p>models/user.go:</p>\n\n<pre><code>package models\n\nimport (\n    \"github.com/jinzhu/gorm\"\n    \"github.com/mitchellh/mapstructure\"\n)\n\ntype User struct {\n    gorm.Model\n    // Override ID cause we are using cognito.\n    Email string `gorm:\"primary_key,not null\"`\n    Site  Site\n}\n\nfunc (u *User) Current(claims interface{}) error {\n    if err := mapstructure.Decode(claims, u); err != nil {\n        panic(err)\n    }\n\n    if err := Database.Find(u).Error; err != nil {\n        return err\n    }\n    return nil\n}\n</code></pre>\n\n<p>I have 2 questions:</p>\n\n<ul>\n<li>Is this the right way to define a function (Authentication function) that receives a function and returns another function? Because it is too verbose, I am feeling this is wrong.</li>\n<li>Is there a way to augment the <code>ctx</code> with an <code>user</code> attribute? The way that I'm trying, I see the error <code>ctx.user undefined (type context.Context has no field or method user)</code>.</li>\n</ul>\n"}, {"tags": ["go", "post"], "answers": [{"comments": [{"owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "edited": false, "score": 0, "creation_date": 1540861019, "post_id": 53055903, "comment_id": 93011126, "body": "I won&#39;t bother adding an example because @CarsonHoffman beat me to it."}, {"owner": {"reputation": 331, "user_id": 4857969, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YHlcGGA6Vms/AAAAAAAAAAI/AAAAAAAAAUk/gnwvtrI87g8/photo.jpg?sz=128", "display_name": "Carson Hoffman", "link": "https://stackoverflow.com/users/4857969/carson-hoffman"}, "edited": false, "score": 0, "creation_date": 1540861075, "post_id": 53055903, "comment_id": 93011141, "body": "I didn&#39;t see your post before I made mine, but you responded first, sorry. I&#39;m not super familiar with the etiquette here, so if it would be better to go with the first answer I understand."}, {"owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "reply_to_user": {"reputation": 331, "user_id": 4857969, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YHlcGGA6Vms/AAAAAAAAAAI/AAAAAAAAAUk/gnwvtrI87g8/photo.jpg?sz=128", "display_name": "Carson Hoffman", "link": "https://stackoverflow.com/users/4857969/carson-hoffman"}, "edited": false, "score": 0, "creation_date": 1540913281, "post_id": 53055903, "comment_id": 93033750, "body": "That&#39;s fine, it&#39;s not the first response that should get the votes, but the best.  In this case there were lots of quality answers!"}], "tags": [], "owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "is_accepted": false, "score": 1, "last_activity_date": 1540860822, "creation_date": 1540860822, "answer_id": 53055903, "question_id": 53055878, "link": "https://stackoverflow.com/questions/53055878/how-do-i-get-the-post-values-from-this-request/53055903#53055903", "title": "How do I get the POST values from this request?", "body": "<p>Because your request isn't a form.  It doesn't have any GET parameters, and it isn't form-encoded data.  </p>\n\n<blockquote>\n  <p>For other HTTP methods, or when the Content-Type is not application/x-www-form-urlencoded, the request Body is not read, and r.PostForm is initialized to a non-nil, empty value.</p>\n</blockquote>\n\n<p>[ <a href=\"https://golang.org/pkg/net/http/#Request.ParseForm\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#Request.ParseForm</a> ]</p>\n\n<p>You're free to parse the body of the request as <code>application/json</code>, but that isn't the same as <em>form</em> data.  </p>\n"}, {"tags": [], "owner": {"reputation": 331, "user_id": 4857969, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YHlcGGA6Vms/AAAAAAAAAAI/AAAAAAAAAUk/gnwvtrI87g8/photo.jpg?sz=128", "display_name": "Carson Hoffman", "link": "https://stackoverflow.com/users/4857969/carson-hoffman"}, "is_accepted": true, "score": 3, "last_activity_date": 1540860904, "creation_date": 1540860904, "answer_id": 53055910, "question_id": 53055878, "link": "https://stackoverflow.com/questions/53055878/how-do-i-get-the-post-values-from-this-request/53055910#53055910", "title": "How do I get the POST values from this request?", "body": "<p>As noted <a href=\"https://golang.org/pkg/net/http/#Request.ParseForm\" rel=\"nofollow noreferrer\">in the GoDoc</a> for the <code>http.Request.ParseForm</code> method, the type of the body must be  <code>application/x-www-form-urlencoded</code>, not JSON like your current example:</p>\n\n<blockquote>\n  <p>For other HTTP methods, <strong>or when the Content-Type is not application/x-www-form-urlencoded,</strong> the request Body is not read, and r.PostForm is initialized to a non-nil, empty value. </p>\n</blockquote>\n\n<p>Here is an updated example of your code using a form body, which gives the intended result: <a href=\"https://play.golang.org/p/Zrw05T2Zb5Z\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Zrw05T2Zb5Z</a></p>\n\n<p>If you want to extract values from a JSON body, that can be done using a method such as <code>json.Unmarshal</code>, however a JSON body doesn't represent a form.</p>\n"}, {"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 2, "last_activity_date": 1540863098, "last_edit_date": 1540863098, "creation_date": 1540861358, "answer_id": 53055957, "question_id": 53055878, "link": "https://stackoverflow.com/questions/53055878/how-do-i-get-the-post-values-from-this-request/53055957#53055957", "title": "How do I get the POST values from this request?", "body": "<p>The 3rd argument of <code>http.NewRequest</code> is the http payload.</p>\n\n<p>In your case, payload type is <code>application/json</code>. It's need to be treated as json, only then you'll be able to get certain value from the it. In this case, we just cannot use the same technique like on getting value from query string or form data.</p>\n\n<p>So just unmarshal the <code>jsonStr</code> data into map or struct.</p>\n\n<pre><code>res := make(map[string]interface{})\nerr := json.Unmarshal(jsonStr, &amp;res)\nif err != nil {\n    panic(err)\n}\nfmt.Printf(\"%#v \\n\", res[\"title\"])\n</code></pre>\n\n<hr>\n\n<p>To be honest I'm quite confused with your question, why you need to get the payload from http client request.</p>\n\n<p>If what you want is actually how to get the payload from the web server end, you can get it by decoding the request body. Example:</p>\n\n<pre><code>http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n    payload := make(map[string]interface{})\n    err := json.NewDecoder(r.Body).Decode(&amp;payload)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    title := payload[\"title\"].(string)\n    w.Write([]byte(title))\n})\n</code></pre>\n\n<p>Curl example (based on your code):</p>\n\n<pre><code>curl -d '{\"title\":\"Buy cheese and bread for breakfast.\"}' \\\n     -H \"Content-Type: application/json\" \\\n     -X POST http://localhost:9000\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Buy cheese and bread for breakfast.\n</code></pre>\n"}], "owner": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2037, "favorite_count": 1, "accepted_answer_id": 53055910, "answer_count": 3, "score": 1, "last_activity_date": 1540863098, "creation_date": 1540860545, "question_id": 53055878, "link": "https://stackoverflow.com/questions/53055878/how-do-i-get-the-post-values-from-this-request", "title": "How do I get the POST values from this request?", "body": "<p>I have the <a href=\"https://play.golang.org/p/lkoTX5jb9Zl\" rel=\"nofollow noreferrer\">following code</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc main() {\n\n    var jsonStr = []byte(`{\"title\":\"Buy cheese and bread for breakfast.\"}`)\n    req, err := http.NewRequest(\"POST\", \"/\", bytes.NewBuffer(jsonStr))\n    if err != nil {\n        panic(err)\n    }\n    req.Header.Set(\"X-Custom-Header\", \"myvalue\")\n    req.Header.Set(\"Content-Type\", \"application/json\")\n\n    req.ParseForm()\n    fmt.Printf(\"%v:%v\", \"title\", req.Form.Get(\"title\"))\n}\n</code></pre>\n\n<p>I am unable to extract the \"title\" param and not sure why.</p>\n"}, {"tags": ["go", "web-crawler"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 8591480, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-31Ia1OYP5JU/AAAAAAAAAAI/AAAAAAAAABA/QIDgbeFV9ds/photo.jpg?sz=128", "display_name": "fang jinxu", "link": "https://stackoverflow.com/users/8591480/fang-jinxu"}, "edited": false, "score": 0, "creation_date": 1540964254, "post_id": 53056646, "comment_id": 93051563, "body": "Thanks for your reply. But Do you know how to configure http Transport/DialContext to make the Control only receive a ipv6 connection?"}], "tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": false, "score": 1, "last_activity_date": 1540867380, "creation_date": 1540867380, "answer_id": 53056646, "question_id": 53055808, "link": "https://stackoverflow.com/questions/53055808/golang-force-net-http-client-to-use-ipv4-ipv6/53056646#53056646", "title": "golang force net/http client to use IPv4 / IPv6", "body": "<p>The <code>network</code> passed to the <code>Control</code> function is either <code>tcp4</code> for an IPv4 connection or <code>tcp6</code> for an IPv6 connection, if you are making an outgoing TCP connection.</p>\n\n<p>From the comments on <a href=\"https://golang.org/pkg/net/#Dialer\" rel=\"nofollow noreferrer\"><code>type Dialer</code></a>:</p>\n\n<blockquote>\n<pre><code>        // Network and address parameters passed to Control method are not\n        // necessarily the ones passed to Dial. For example, passing \"tcp\" to Dial\n        // will cause the Control function to be called with \"tcp4\" or \"tcp6\".\n</code></pre>\n</blockquote>\n\n<p>(In case of non-TCP connection, <a href=\"https://golang.org/pkg/net/#Dial\" rel=\"nofollow noreferrer\">other strings</a> are possible.)</p>\n\n<blockquote>\n  <p>Known networks are \"tcp\", \"tcp4\" (IPv4-only), \"tcp6\" (IPv6-only), \"udp\", \"udp4\" (IPv4-only), \"udp6\" (IPv6-only), \"ip\", \"ip4\" (IPv4-only), \"ip6\" (IPv6-only), \"unix\", \"unixgram\" and \"unixpacket\". </p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 8591480, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-31Ia1OYP5JU/AAAAAAAAAAI/AAAAAAAAABA/QIDgbeFV9ds/photo.jpg?sz=128", "display_name": "fang jinxu", "link": "https://stackoverflow.com/users/8591480/fang-jinxu"}, "is_accepted": false, "score": 1, "last_activity_date": 1541076054, "creation_date": 1541076054, "answer_id": 53101472, "question_id": 53055808, "link": "https://stackoverflow.com/questions/53055808/golang-force-net-http-client-to-use-ipv4-ipv6/53101472#53101472", "title": "golang force net/http client to use IPv4 / IPv6", "body": "<p>Oh. I fixed the problem myself.</p>\n\n<p>We could not configure force ipv6 connection because it is hard coded</p>\n\n<pre><code>...\nif cm.scheme() == \"https\" &amp;&amp; t.DialTLS != nil {\n        var err error\n        pconn.conn, err = t.DialTLS(\"tcp\", cm.addr())\n        if err != nil {\n            return nil, wrapErr(err)\n        }\n...\n</code></pre>\n\n<p>( <a href=\"https://github.com/golang/go/blob/6c9b655ac1ab99eb2d3f944deb09b0339717f8cc/src/net/http/transport.go#L1250\" rel=\"nofollow noreferrer\">code here</a>.)</p>\n\n<p>I add a ipv6only flag for transport.go, a getTcpString() and it works.</p>\n\n<p>(<a href=\"http://www.mergely.com/BHOKmRtc/\" rel=\"nofollow noreferrer\">diff here</a>)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4319010, "user_type": "registered", "profile_image": "https://graph.facebook.com/801785153/picture?type=large", "display_name": "Amit Kulkarni", "link": "https://stackoverflow.com/users/4319010/amit-kulkarni"}, "is_accepted": false, "score": -1, "last_activity_date": 1591040307, "creation_date": 1591040307, "answer_id": 62139740, "question_id": 53055808, "link": "https://stackoverflow.com/questions/53055808/golang-force-net-http-client-to-use-ipv4-ipv6/62139740#62139740", "title": "golang force net/http client to use IPv4 / IPv6", "body": "<p>I think even when the server is listening on \"tcp6\", client running net.Dial using \"tcp\" should work fine - in dual stack setups.</p>\n\n<p>When I ran into this issue, the culprit was /etc/hosts. It had an entry for the host which was mapped to an ipv4 address instead of ipv6 address. This lead to connection refusal.</p>\n\n<p>My test example as follows:</p>\n\n<p>Client Code:</p>\n\n<pre><code>package main\n\nimport \"net\"\nimport \"fmt\"\n\nfunc main() {\n    conn, err := net.Dial(\"tcp\", \"hostname:9876\")\n    if err != nil {\n        fmt.Println(\"Error in net.Dial\", err)\n        return\n    }\n\n    conn.Close()\n    fmt.Println(\"Successful\")\n}\n</code></pre>\n\n<p>Server Code:</p>\n\n<pre><code>package main\n\nimport \"net\"\nimport \"fmt\"\n\nfunc main() {\n    lis, err := net.Listen(\"tcp6\", \":9876\")\n    if err != nil {\n        fmt.Println(\"Error in listen\", err)\n        return\n    }\n\n    for {\n        _, err := lis.Accept()\n        if err != nil {\n            fmt.Println(\"Error in Accept\", err)\n            return\n        }\n    }\n}\n</code></pre>\n\n<p>This code should work fine with clean /etc/hosts file on dual stack setups.</p>\n\n<p>Thanks.</p>\n"}], "owner": {"reputation": 151, "user_id": 8591480, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-31Ia1OYP5JU/AAAAAAAAAAI/AAAAAAAAABA/QIDgbeFV9ds/photo.jpg?sz=128", "display_name": "fang jinxu", "link": "https://stackoverflow.com/users/8591480/fang-jinxu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5161, "favorite_count": 0, "answer_count": 3, "score": 8, "last_activity_date": 1591040307, "creation_date": 1540859955, "question_id": 53055808, "link": "https://stackoverflow.com/questions/53055808/golang-force-net-http-client-to-use-ipv4-ipv6", "title": "golang force net/http client to use IPv4 / IPv6", "body": "<p>I' using go1.11 net/http and want to decect if a domain is ipv6-only.</p>\n\n<h3>What did you do?</h3>\n\n<p>I create my own DialContext because want I to detect if a domain is ipv6-only. code below</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\nimport (\n    \"errors\"\n    \"fmt\"\n    \"net\"\n    \"net/http\"\n    \"syscall\"\n    \"time\"\n)\nfunc ModifiedTransport() {\n    var MyTransport = &amp;http.Transport{\n        DialContext: (&amp;net.Dialer{\n            Timeout:   30 * time.Second,\n            KeepAlive: 30 * time.Second,\n            DualStack: false,\n            Control: func(network, address string, c syscall.RawConn) error {\n                if network == \"ipv4\" {\n                    // I want to  cancel connection here client.Get(\"http://myexample.com\") return a non-nil err.\n                    return errors.New(\"you should not use ipv4\")\n                }\n                return nil\n            },\n        }).DialContext,\n        MaxIdleConns:          100,\n        IdleConnTimeout:       90 * time.Second,\n        TLSHandshakeTimeout:   10 * time.Second,\n        ExpectContinueTimeout: 1 * time.Second,\n    }\n    var myClient = http.Client{Transport: MyTransport}\n    resp, myerr := myClient.Get(\"http://www.github.com\")\n    if myerr != nil {\n        fmt.Println(\"request error\")\n        return \n    }\n    var buffer = make([]byte, 1000)\n    resp.Body.Read(buffer)\n    fmt.Println(string(buffer))\n}\nfunc main(){\n    ModifiedTransport();\n}\n</code></pre>\n\n<p>I do not now how to close the request even when I can get into <code>network == \"ipv4\"</code>.</p>\n\n<h3>addition</h3>\n\n<p>Python can solve the question via <a href=\"https://stackoverflow.com/questions/33046733/force-requests-to-use-ipv4-ipv6\">Force requests to use IPv4 / IPv6</a>. I do not know how to do it in golang. Could someone one help me?\nThanks so much!</p>\n"}, {"tags": ["go", "websocket", "mqtt", "paho"], "comments": [{"owner": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1540884124, "post_id": 53055790, "comment_id": 93017135, "body": "Edit the question to show just the code you used to connect to a single broker (probably just the local one) and show the output along with the logs from the broker as you try to connect)"}, {"owner": {"reputation": 27, "user_id": 9822273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/65mbV.jpg?s=128&g=1", "display_name": "ddhille", "link": "https://stackoverflow.com/users/9822273/ddhille"}, "reply_to_user": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1540889065, "post_id": 53055790, "comment_id": 93019230, "body": "I just tried this on another computer / network. At least the websocket connection to my local broker works now. Therefore it probably was a network problem only. Thanks anyway for your comment @hardillb !"}, {"owner": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1540889253, "post_id": 53055790, "comment_id": 93019337, "body": "Then please feel free to delete the question"}], "owner": {"reputation": 27, "user_id": 9822273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/65mbV.jpg?s=128&g=1", "display_name": "ddhille", "link": "https://stackoverflow.com/users/9822273/ddhille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 546, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540860255, "creation_date": 1540859833, "last_edit_date": 1540860255, "question_id": 53055790, "link": "https://stackoverflow.com/questions/53055790/paho-mqtt-golang-not-connecting-via-websockets", "title": "paho.mqtt.golang not connecting via websockets", "body": "<p>I am not able to connect to any MQTT broker via websockets.</p>\n\n<p>I first set up a local broker with websockets enabled. The connection did not establish. I then tried to connect to some public brokers which also does not work.\nCould you give me a hint on solving this?\nIt may only be a firewall problem..</p>\n\n<pre><code>package main\n\u00a0\nimport (\n\u00a0\u00a0\u00a0\u00a0\"fmt\"\n\u00a0\u00a0\u00a0\u00a0\"sync\"\n\u00a0\u00a0\u00a0\u00a0\"time\"\n\u00a0\n\u00a0\u00a0\u00a0\u00a0mqtt \"github.com/eclipse/paho.mqtt.golang\"\n)\n\u00a0\nfunc main() {\n\u00a0\u00a0\u00a0\u00a0var ipRange []string\n\u00a0\u00a0\u00a0\u00a0ipRange = append(ipRange,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"tcp://mqtt.flespi.io:1883\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"tcp://test.mosquitto.org:1883\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"tcp://iot.eclipse.org:1883\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"tcp://mqtt.fluux.io:1883\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"tcp://broker.hivemq.com:1883\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"ws://mqtt.flespi.io:80\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"ws://iot.eclipse.org:80\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"ws://broker.hivemq.com:8000\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"ws://test.mosquitto.org:80\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"ws://broker.bevywise.com:8443\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"ws://mqtt.dioty.co:8080\",\n\u00a0\u00a0\u00a0\u00a0)\n\u00a0\n\u00a0\u00a0\u00a0\u00a0opts := mqtt.NewClientOptions()\n\u00a0\u00a0\u00a0\u00a0opts.ConnectTimeout = 1 * time.Second\n\u00a0\u00a0\u00a0\u00a0opts.PingTimeout = 1 * time.Second\n\u00a0\u00a0\u00a0\u00a0opts.WriteTimeout = 1 * time.Second\n\u00a0\n\u00a0\u00a0\u00a0\u00a0var clients []mqtt.Client\n\u00a0\u00a0\u00a0\u00a0for i := 0; i &lt; len(ipRange); i++ {\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0opt := *opts\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0opt.AddBroker(ipRange[i])\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0clients = append(clients, mqtt.NewClient(&amp;opt))\n\u00a0\u00a0\u00a0\u00a0}\n\u00a0\n\u00a0\u00a0\u00a0\u00a0startTime := time.Now()\n\u00a0\u00a0\u00a0\u00a0var validBrokers []string\n\u00a0\u00a0\u00a0\u00a0var wg sync.WaitGroup\n\u00a0\u00a0\u00a0\u00a0wg.Add(len(clients))\n\u00a0\n\u00a0\u00a0\u00a0\u00a0fmt.Println(\"--- discovery started (\", len(clients), \"clients) ---\")\n\u00a0\u00a0\u00a0\u00a0for i := 0; i &lt; len(clients); i++ {\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0go connectMQTT(clients[i], &amp;wg, &amp;validBrokers)\n\u00a0\u00a0\u00a0\u00a0}\n\u00a0\u00a0\u00a0\u00a0wg.Wait()\n\u00a0\n\u00a0\u00a0\u00a0\u00a0fmt.Println(\"--- discovery finished ---\")\n\u00a0\u00a0\u00a0\u00a0fmt.Println(\"\\nvalid brokers after\", time.Now().Sub(startTime), \":\")\n\u00a0\u00a0\u00a0\u00a0for i := 0; i &lt; len(validBrokers); i++ {\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0fmt.Println(validBrokers[i])\n\u00a0\u00a0\u00a0\u00a0}\n}\n\u00a0\nfunc connectMQTT(client mqtt.Client, waitgroup *sync.WaitGroup, brokers *[]string) {\n\u00a0\u00a0\u00a0\u00a0defer waitgroup.Done()\n\u00a0\u00a0\u00a0\u00a0bla := client.OptionsReader()\n\u00a0\u00a0\u00a0\u00a0if token := client.Connect(); token.Wait() {\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0fmt.Println(bla.Servers()[0].Hostname()+\":\"+bla.Servers()[0].Port(), client.IsConnected())\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0if token.Error() == nil {\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0*brokers = append(*brokers, bla.Servers()[0].Hostname()+\":\"+bla.Servers()[0].Port())\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0}\n\u00a0\u00a0\u00a0\u00a0}\n}\n</code></pre>\n"}, {"tags": ["rest", "go", "google-cloud-platform", "google-compute-engine", "go-gin"], "answers": [{"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 3, "last_activity_date": 1540860660, "last_edit_date": 1540860660, "creation_date": 1540859848, "answer_id": 53055794, "question_id": 53054670, "link": "https://stackoverflow.com/questions/53054670/gin-gonic-cannot-assign-requested-address/53055794#53055794", "title": "gin-gonic cannot assign requested address", "body": "<p>You need to use <code>0.0.0.0</code> instead of what you are currently using on <code>.Run()</code> statement. By using <code>0.0.0.0</code>, the server will be accessible from available network interface.</p>\n\n<pre><code>r.Run(\"0.0.0.0:8080\")\n</code></pre>\n\n<p>So accessing <code>35.237.89.107:8080</code> from external IP will points towards your app.</p>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 9176568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34d232748cf925b364aa476d05f7178?s=128&d=identicon&r=PG&f=1", "display_name": "Oktfolio", "link": "https://stackoverflow.com/users/9176568/oktfolio"}, "is_accepted": true, "score": 2, "last_activity_date": 1540888580, "last_edit_date": 1540888580, "creation_date": 1540885478, "answer_id": 53059525, "question_id": 53054670, "link": "https://stackoverflow.com/questions/53054670/gin-gonic-cannot-assign-requested-address/53059525#53059525", "title": "gin-gonic cannot assign requested address", "body": "<p>You can only listen localhost, then access via your host's ip, like <code>35.237.89.107:8080</code>.</p>\n\n<p>use </p>\n\n<pre><code>r.Run(\":8080\")\n</code></pre>\n\n<p><code>0.0.0.0</code> is not necessary.</p>\n"}], "owner": {"reputation": 43, "user_id": 6657397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THnd9.jpg?s=128&g=1", "display_name": "Malcolm", "link": "https://stackoverflow.com/users/6657397/malcolm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1112, "favorite_count": 0, "accepted_answer_id": 53059525, "answer_count": 2, "score": 1, "last_activity_date": 1561177866, "creation_date": 1540851275, "last_edit_date": 1540914012, "question_id": 53054670, "link": "https://stackoverflow.com/questions/53054670/gin-gonic-cannot-assign-requested-address", "title": "gin-gonic cannot assign requested address", "body": "<p>So I am currently working on building a restful api in go using the gin-gonic package. I hope to deploy the code to a google cloud platform compute engine VM. When I run the code on my local machine it works with using local host but when running it on the actual VM instance with the external IP specified I get a bind error with the TCP connection. Any help appreciated.</p>\n\n<p>server.go</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"os\"\n\n    \"github.com/gin-gonic/gin\"\n)\n\ntype headlines struct {\n    Author      string\n    Title       string\n    Description string\n    Url         string\n    UrlToImage  string\n    PublishedAt string\n    Content     string\n}\n\ntype NewsResponse struct {\n    Status       string\n    TotalResults int\n    Articles     []headlines\n}\n\nfunc GetSourceHeadlines(source string) NewsResponse {\n    newsAPIKey := os.Getenv(\"NEWS_API_KEY\")\n    var newsResponse NewsResponse\n    resp, err := http.Get(\"https://newsapi.org/v2/top-headlines?sources=\" + source + \"&amp;apiKey=\" + newsAPIKey)\n\n    if err != nil {\n        panic(err)\n    }\n\n    defer resp.Body.Close()\n\n    if resp.StatusCode == http.StatusOK {\n        bodyBytes, _ := ioutil.ReadAll(resp.Body)\n        err := json.Unmarshal(bodyBytes, &amp;newsResponse)\n        if err == nil {\n            return newsResponse\n        }\n    }\n    return newsResponse\n}\n\nfunc main() {\n    r := gin.Default()\n    r.GET(\"/headlines/ign\", func(c *gin.Context) {\n        c.JSON(http.StatusOK, GetSourceHeadlines(\"ign\"))\n    })\n\n    r.GET(\"/headlines/polygon\", func(c *gin.Context) {\n        c.JSON(http.StatusOK, GetSourceHeadlines(\"polygon\"))\n    })\n\n    r.GET(\"/headlines/techcrunch\", func(c *gin.Context) {\n        c.JSON(http.StatusOK, GetSourceHeadlines(\"techcrunch\"))\n    })\n\n    r.GET(\"/headlines/hacker-news\", func(c *gin.Context) {\n        c.JSON(http.StatusOK, GetSourceHeadlines(\"hacker-news\"))\n    })\n    r.Run(\"35.237.89.107:8080\")\n}\n</code></pre>\n\n<p>Console:</p>\n\n<pre><code>[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.\n\n[GIN-debug] [WARNING] Running in \"debug\" mode. Switch to \"release\" mode in production.\n - using env:   export GIN_MODE=release\n - using code:  gin.SetMode(gin.ReleaseMode)\n\n[GIN-debug] GET    /headlines/ign            --&gt; main.main.func1 (3 handlers)\n[GIN-debug] GET    /headlines/polygon        --&gt; main.main.func2 (3 handlers)\n[GIN-debug] GET    /headlines/techcrunch     --&gt; main.main.func3 (3 handlers)\n[GIN-debug] Listening and serving HTTP on 35.237.89.107:8080\n[GIN-debug] [ERROR] listen tcp 35.237.89.107:8080: bind: cannot assign requested address\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1540847279, "post_id": 53053811, "comment_id": 93007237, "body": "Sounds like you&#39;re looking for <a href=\"https://golang.org/pkg/strconv/#Unquote\" rel=\"nofollow noreferrer\"><code>strconv.Unquote</code></a>."}, {"owner": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1540874576, "post_id": 53053811, "comment_id": 93013988, "body": "So there are no helper functions in that regard, have to write conversion manually like by line ?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1540881525, "post_id": 53053811, "comment_id": 93016100, "body": "Nothing forces you to do this line by line. You can also read the whole file and call Unquote once."}, {"owner": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "edited": false, "score": 0, "creation_date": 1540883269, "post_id": 53053811, "comment_id": 93016771, "body": "Ok ive seen GoValidator it wouldnt be an approach i should use this for ? ( i would need some other formatting too in regards to variable fields where i have {{unknown}} where i would need to test for start {{ and end }} and extract the content in the mifdle ( the variable name )"}], "owner": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1540863096, "creation_date": 1540847152, "last_edit_date": 1540863096, "question_id": 53053811, "link": "https://stackoverflow.com/questions/53053811/custom-templating-ascii-conversion-of-hex-values", "title": "Custom templating / ASCII conversion of hex values", "body": "<p>I have a file which is a \"template\" in pure ASCII containing hex values represented like ex <code>\\x0d\\0a</code> for <code>CR\\LF</code>.</p>\n\n<p>A line in the file could look like this:</p>\n\n<pre>\nTEXT100\\x1b\\x03\n</pre>\n\n<p>I would like to convert this into a byte array ( so <code>0x1b</code> becomes 1 single byte - ASCII for ESC ) the simplest way in Go - is there any way this can be done without writing one that manually goes through each line from scratch? </p>\n\n<p>Can the ASCII/templating module support or be adjusted to understand such a format?</p>\n"}, {"tags": ["sql-server", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1540844639, "post_id": 53052179, "comment_id": 93006084, "body": "What and where are the connections in TIME_WAIT? Are they definitely SQL connections? Are they on the SQL host or the Go app host?"}, {"owner": {"reputation": 191, "user_id": 2021149, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2e54ce8e2a85707376526aaa64915c53?s=128&d=identicon&r=PG", "display_name": "RohanC", "link": "https://stackoverflow.com/users/2021149/rohanc"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540844981, "post_id": 53052179, "comment_id": 93006237, "body": "I&#39;m referring to the connections between the go server (servicing http requests and using the SQL client) and the SQL instance (either RDS or Azure SQL). They&#39;re on the Go app host."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1540901030, "post_id": 53052179, "comment_id": 93026151, "body": "Have you checked <a href=\"https://golang.org/pkg/database/sql/#DB.SetConnMaxLifetime\" rel=\"nofollow noreferrer\"><code>MaxConnLifetime</code></a> as well? Looks like not your case (judged from the usage) but if the connections are picked from the idle pool unevenly for some reason, this could explain the fact some of them time out."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1540901069, "post_id": 53052179, "comment_id": 93026175, "body": "(BTW +1 for such a well-formulated question, which is, sadly, a rare thing.)"}, {"owner": {"reputation": 191, "user_id": 2021149, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2e54ce8e2a85707376526aaa64915c53?s=128&d=identicon&r=PG", "display_name": "RohanC", "link": "https://stackoverflow.com/users/2021149/rohanc"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1540920933, "post_id": 53052179, "comment_id": 93038192, "body": "@kostix thanks! :) I am not setting the MaxConnLifetime, which (from what I can tell by going through the code) defaults to 0 and therefore does not have a timeout"}, {"owner": {"reputation": 191, "user_id": 2021149, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2e54ce8e2a85707376526aaa64915c53?s=128&d=identicon&r=PG", "display_name": "RohanC", "link": "https://stackoverflow.com/users/2021149/rohanc"}, "edited": false, "score": 0, "creation_date": 1541553401, "post_id": 53052179, "comment_id": 93254910, "body": "Minor <a href=\"https://github.com/denisenkom/go-mssqldb/issues/426\" rel=\"nofollow noreferrer\">update</a> for anyone that happens upon this question"}], "owner": {"reputation": 191, "user_id": 2021149, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2e54ce8e2a85707376526aaa64915c53?s=128&d=identicon&r=PG", "display_name": "RohanC", "link": "https://stackoverflow.com/users/2021149/rohanc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1540844348, "creation_date": 1540839767, "last_edit_date": 1540844348, "question_id": 53052179, "link": "https://stackoverflow.com/questions/53052179/go-database-client-killing-more-connections-to-sql-server-than-expected", "title": "Go database client killing more connections to SQL Server than expected", "body": "<p>As part of debugging some other issues on our server I noticed some really odd behavior with respect to connections that I'm hoping to understand.</p>\n\n<p>I have 2 go servers, one of which talks to a SQL Server RDS instance, and another that talks to a managed SQL Server instance in Azure.</p>\n\n<p>I believe there is a slight difference in the way the 2 backends work - RDS has a single port (1433) on which the client authenticates and subsequently establishes the connection. Azure SQL seems to authenticate on port 1433 and then redirect the client to another service that actually handles the connections.</p>\n\n<p>In both cases I've got substantial load running against the servers. At least 500 requests/s, with peaks of about 2k req/s. Each of these requests results in a Select query which returns a single row with a primary key lookup - so really short lived connections to SQL. The average time per query is 50-80ms on both, with p95 in the 100-150ms range</p>\n\n<p><strong>Behavior I'm trying to understand:</strong></p>\n\n<p>I'm using the go database/sql driver with an MS-SQL implementation (Specifically <a href=\"https://github.com/denisenkom/go-mssqldb\" rel=\"noreferrer\" title=\"go-mssqldb\">go-mssqldb</a>).</p>\n\n<p>I've set Max Idle connections and Max Open connections to 64. </p>\n\n<p><strong><em>What I would expect</em></strong>: 64 long running Established connections that are occasionally idle but quickly reused.</p>\n\n<p><strong><em>What I'm seeing</em></strong>: Generally 64 Established connections, with the number often dropping down to somewhere between 50 and 64. This also results in 200-400 connections in the TIME_WAIT state at any given time.</p>\n\n<p>What could be causing this behavior? It is just the fact that the go driver lazily closes connections? If so why would the number drop below 64?</p>\n\n<p>I'm happy to provide any more details!</p>\n"}, {"tags": ["json", "go", "struct", "tags", "marshalling"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 14, "creation_date": 1540839184, "post_id": 53051979, "comment_id": 93003620, "body": "Try removing the space after the colon i.e. <code>`json:&quot;name&quot;`</code>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1540840401, "post_id": 53051979, "comment_id": 93004146, "body": "The valid syntax is <i>exactly</i> what is described in <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\">the documentation for encoding/json</a>. It is not forgiving of differences in whitespace etc."}, {"owner": {"reputation": 338, "user_id": 6687273, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/WSZKQ.jpg?s=128&g=1", "display_name": "puneeth8994", "link": "https://stackoverflow.com/users/6687273/puneeth8994"}, "edited": false, "score": 0, "creation_date": 1557588957, "post_id": 53051979, "comment_id": 98819832, "body": "Why was this downvoted?"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1583441818, "post_id": 53051979, "comment_id": 107128229, "body": "<code>go vet</code> is your friend."}], "answers": [{"comments": [{"owner": {"reputation": 725, "user_id": 2648736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a4ece008e633bd5a0f62059dc113da?s=128&d=identicon&r=PG", "display_name": "clarenswd", "link": "https://stackoverflow.com/users/2648736/clarenswd"}, "edited": false, "score": 0, "creation_date": 1558068274, "post_id": 53052139, "comment_id": 98985253, "body": "thanks for the answer, I had something similar with the space in:  <code>json:&quot;containers, omitempty&quot;` </code>"}, {"owner": {"reputation": 1436, "user_id": 3557946, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1016184623/picture?type=large", "display_name": "zooblin", "link": "https://stackoverflow.com/users/3557946/zooblin"}, "edited": false, "score": 3, "creation_date": 1585167749, "post_id": 53052139, "comment_id": 107672065, "body": "You saved infinite amount of time of all people that starting with Go"}, {"owner": {"reputation": 58, "user_id": 6200999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89248307b2d70b47ca3bf3cb4fe2e6e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jarri Abidi", "link": "https://stackoverflow.com/users/6200999/jarri-abidi"}, "edited": false, "score": 0, "creation_date": 1601040008, "post_id": 53052139, "comment_id": 113288358, "body": "2 years into Go and still making this mistake lol"}, {"owner": {"reputation": 77, "user_id": 5961277, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/84f3b2901f08b1c39bfb752c82165a06?s=128&d=identicon&r=PG", "display_name": "JunsungChoi", "link": "https://stackoverflow.com/users/5961277/junsungchoi"}, "edited": false, "score": 0, "creation_date": 1602605759, "post_id": 53052139, "comment_id": 113770938, "body": "Thanks bro, I struggled this simple issue for 3 days :)"}], "tags": [], "owner": {"reputation": 1539, "user_id": 423292, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/682568435d3372e1385b671da7f1f793?s=128&d=identicon&r=PG", "display_name": "David Jones", "link": "https://stackoverflow.com/users/423292/david-jones"}, "is_accepted": false, "score": 43, "last_activity_date": 1540839635, "creation_date": 1540839635, "answer_id": 53052139, "question_id": 53051979, "link": "https://stackoverflow.com/questions/53051979/why-is-go-json-marshal-rejecting-these-struct-tags-what-is-proper-syntax-for-js/53052139#53052139", "title": "Why is Go json.Marshal rejecting these struct tags? What is proper syntax for json tags?", "body": "<p>Oh my goodness!  I just figured it out.  There is no space allowed between <code>json:</code> and the field name <code>\"name\"</code>.</p>\n\n<p>The \"go vet\" error message (<code>\"bad syntax\"</code>) is remarkably unhelpful.</p>\n\n<p>The following code works.  Can you see the difference?</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Person struct {\n    Name string `json:\"name\"`\n    Age  int    `json:\"age\"`\n}\n\nfunc main() {\n    p := Person{Name: \"Alice\", Age: 29}\n    bytes, _ := json.Marshal(p)\n    fmt.Println(\"JSON = \", string(bytes))\n}\n</code></pre>\n"}], "owner": {"reputation": 1539, "user_id": 423292, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/682568435d3372e1385b671da7f1f793?s=128&d=identicon&r=PG", "display_name": "David Jones", "link": "https://stackoverflow.com/users/423292/david-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7671, "favorite_count": 0, "closed_date": 1540844877, "answer_count": 1, "score": 16, "last_activity_date": 1540839982, "creation_date": 1540838915, "last_edit_date": 1540839982, "question_id": 53051979, "link": "https://stackoverflow.com/questions/53051979/why-is-go-json-marshal-rejecting-these-struct-tags-what-is-proper-syntax-for-js", "closed_reason": "Duplicate", "title": "Why is Go json.Marshal rejecting these struct tags? What is proper syntax for json tags?", "body": "<p>I am trying to use json.Marshal but it refuses to accept my struct tags.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Here is the source code for \"marshal.go\"</p>\n\n<p><a href=\"https://play.golang.org/p/eFe03_89Ly9\" rel=\"noreferrer\">https://play.golang.org/p/eFe03_89Ly9</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Person struct {\n    Name string `json: \"name\"`\n    Age  int    `json: \"age\"`\n}\n\nfunc main() {\n    p := Person{Name: \"Alice\", Age: 29}\n    bytes, _ := json.Marshal(p)\n    fmt.Println(\"JSON = \", string(bytes))\n}\n</code></pre>\n\n<p>I get these error messages from \"go vet marshal.go\"</p>\n\n<pre><code>./marshal.go:9: struct field tag `json: \"name\"` not compatible with reflect.StructTag.Get: bad syntax for struct tag value\n./marshal.go:10: struct field tag `json: \"age\"` not compatible with reflect.StructTag.Get: bad syntax for struct tag value\n</code></pre>\n\n<p>I get this output when I run the program.</p>\n\n<pre><code>% ./marshal\nJSON =  {\"Name\":\"Alice\",\"Age\":29}\n</code></pre>\n\n<p>Notice the field names match the Go structure and ignore the json tags.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["go", "colors", "pie-chart", "go-chart"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 4398653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yj8yP.png?s=128&g=1", "display_name": "veerg404", "link": "https://stackoverflow.com/users/4398653/veerg404"}, "edited": false, "score": 0, "creation_date": 1540877383, "post_id": 53053651, "comment_id": 93014750, "body": "I tried chart.Style attribute but what I really want is to add a different color every time the loop iterates. Can we store the color attributes in an array so for every iteration we keep on changing the color ? Or there is any other way to keep on changing colors using chart.Style within the loop?"}], "tags": [], "owner": {"reputation": 2041, "user_id": 1333724, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/acc5cea42dca926af89f94eb56fbbdbb?s=128&d=identicon&r=PG", "display_name": "maxm", "link": "https://stackoverflow.com/users/1333724/maxm"}, "is_accepted": false, "score": 0, "last_activity_date": 1540846447, "creation_date": 1540846447, "answer_id": 53053651, "question_id": 53051930, "link": "https://stackoverflow.com/questions/53051930/add-custom-colors-to-go-chart-slices/53053651#53053651", "title": "add custom colors to go chart slices", "body": "<p>See this example: <a href=\"https://github.com/wcharczuk/go-chart/blob/master/_examples/custom_styles/main.go\" rel=\"nofollow noreferrer\">https://github.com/wcharczuk/go-chart/blob/master/_examples/custom_styles/main.go</a></p>\n\n<p>For each one of your <code>chart.Value{Label: l, Value: float64(v)}</code> you can provide a <code>Style</code> attribute: <a href=\"https://godoc.org/github.com/wcharczuk/go-chart#Value\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/wcharczuk/go-chart#Value</a></p>\n\n<p>The style attribute can take a color, stroke and other things:</p>\n\n<pre><code>Style: chart.Style{\n    Show:        true,                           //note; if we set ANY other properties, we must set this to true.\n    StrokeColor: drawing.ColorRed,               // will supercede defaults\n    FillColor:   drawing.ColorRed.WithAlpha(64), // will supercede defaults\n},\n</code></pre>\n\n<p>More options here: <a href=\"https://godoc.org/github.com/wcharczuk/go-chart#Style\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/wcharczuk/go-chart#Style</a></p>\n\n<p>Please make sure to link to the library you're using in the future. </p>\n\n<p>If you want the custom colors in JSON, either use the RGB values in the json string and parse them into a struct, or define the colors in a struct in your code and use the passed values.</p>\n"}], "owner": {"reputation": 81, "user_id": 4398653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yj8yP.png?s=128&g=1", "display_name": "veerg404", "link": "https://stackoverflow.com/users/4398653/veerg404"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583743942, "creation_date": 1540838706, "last_edit_date": 1583743942, "question_id": 53051930, "link": "https://stackoverflow.com/questions/53051930/add-custom-colors-to-go-chart-slices", "title": "add custom colors to go chart slices", "body": "<p>I am having trouble to add custom colors in pie chart slices. I am using go chart library and not sure how to add custom colors in my chart dynamically.</p>\n\n<p>Here I am working on a graph using this code, I know we have a chart style option to assign colors using <code>drawing.Color{R,G,B,A}</code> but that will specific only one color for all the slices. I want to have my own custom color specified for each pie chart slice dynamically </p>\n\n<pre><code>   raw := `{\"reaction_summary\": {\"ANGRY\": 7,\"HAHA\": 40,\"LIKE\": 161,\"LOVE\": 56,\"SAD\": 26,\"SHOCK\": 6}}`\n\n// Parse JSON\ndata := struct {\n    ReactionSummary map[string]int `json:\"reaction_summary\"`\n}{}\nif err := json.Unmarshal([]byte(raw), &amp;data); err != nil {\n    log.Fatal(err)\n}\n// Populate a slice of chart values\nvar values []chart.Value\nfor l, v := range data.ReactionSummary {\n    values = append(values, chart.Value{Label: l, Value: float64(v)})\n}\n// Initialize the chart\npie := chart.PieChart{\n    Width:  512,\n    Height: 512,\n    Values: values,\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/DvxZg.png\" rel=\"nofollow noreferrer\">Pie chart here</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1540836449, "post_id": 53051253, "comment_id": 93002341, "body": "Why exactly do you think that should timeout? The timeouts are for when the client is too slow, but you are purposely blocking the server&#39;s handler code, so none of those timeouts apply. You&#39;ve already mentioned the correct answer, which is to set a timeout for the entire handler itself."}, {"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1540837868, "post_id": 53051253, "comment_id": 93003044, "body": "I second @JimB&#39;s answer that <code>http.TimeoutHandler</code> is the proper way to handle this."}, {"owner": {"reputation": 121, "user_id": 7419285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f572dc67369ef9cc3e880da8e0584e7f?s=128&d=identicon&r=PG&f=1", "display_name": "CptJero", "link": "https://stackoverflow.com/users/7419285/cptjero"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1540840201, "post_id": 53051253, "comment_id": 93004049, "body": "@JimB I guess I don&#39;t fully understand what <code>ReadTimeout</code>, <code>ReadHeaderTimeout</code>, and <code>WriteTimeout</code> are for then. Is it solely to safeguard against malicious clients?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1540842878, "post_id": 53051253, "comment_id": 93005270, "body": "They are for precisely what their names describe; <code>ReadTimeout</code> is the timeout when reading a request, <code>ReadHeaderTimeout</code> is the timeout reading only the request headers, and <code>WriteTimeout</code> is the timeout writing a response. Your handler is not reading or writing <i>anything</i> while it is blocked, nor can your handler actually cause those to block."}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 7419285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f572dc67369ef9cc3e880da8e0584e7f?s=128&d=identicon&r=PG&f=1", "display_name": "CptJero", "link": "https://stackoverflow.com/users/7419285/cptjero"}, "is_accepted": true, "score": 0, "last_activity_date": 1540844140, "creation_date": 1540844140, "answer_id": 53053168, "question_id": 53051253, "link": "https://stackoverflow.com/questions/53051253/how-to-implement-server-side-timeouts-confused-about-http-server-timeouts/53053168#53053168", "title": "How to implement server side timeouts? (Confused about http.Server timeouts)", "body": "<p>The answer is to use <code>http.TimeoutHandler</code>. I misunderstood the purpose of the <code>http.Server</code> Timeout fields.</p>\n"}], "owner": {"reputation": 121, "user_id": 7419285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f572dc67369ef9cc3e880da8e0584e7f?s=128&d=identicon&r=PG&f=1", "display_name": "CptJero", "link": "https://stackoverflow.com/users/7419285/cptjero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 664, "favorite_count": 0, "accepted_answer_id": 53053168, "answer_count": 1, "score": 4, "last_activity_date": 1540844140, "creation_date": 1540835790, "question_id": 53051253, "link": "https://stackoverflow.com/questions/53051253/how-to-implement-server-side-timeouts-confused-about-http-server-timeouts", "title": "How to implement server side timeouts? (Confused about http.Server timeouts)", "body": "<p>I'm trying to implement server-side timeouts for my service. If the request takes longer than X seconds, the server should return 503 Service Unavailable. </p>\n\n<p>I know that this can easily be accomplished by wrapping all of my endpoints in <a href=\"https://golang.org/pkg/net/http/#TimeoutHandler\" rel=\"nofollow noreferrer\">http.TimeoutHandler</a>, but I'm confused why this isn't being done automatically by the <a href=\"https://golang.org/pkg/net/http/#Server\" rel=\"nofollow noreferrer\">Timeout fields of http.Server</a></p>\n\n<p>Here is a trivial example that I am using for testing. If I cURL or POSTman this server, it hangs forever, rather than the 5 seconds I expect.</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"time\"\n)\n\nfunc main() {\n    mux := http.NewServeMux()\n    mux.HandleFunc(\"/timeouttest\", func(_ http.ResponseWriter, _ *http.Request) {\n        // busy infinite loop\n        // for { _ = struct {}{}}\n\n        // non-busy infinite loop\n        select {}\n    })\n    srv := &amp;http.Server{\n        Addr:              \"localhost:5000\",\n        Handler:           mux,\n        ReadTimeout:       5 * time.Second,\n        ReadHeaderTimeout: 5 * time.Second,\n        WriteTimeout:      5 * time.Second,\n        IdleTimeout:       90 * time.Second,\n    }\n    srv.ListenAndServe()\n}\n</code></pre>\n\n<p>EDIT: forgot to link some Cloudflare articles that I have been using as inspiration. \n<a href=\"https://blog.cloudflare.com/the-complete-guide-to-golang-net-http-timeouts/\" rel=\"nofollow noreferrer\">complete guide to golang http timeouts</a>\n<a href=\"https://blog.cloudflare.com/exposing-go-on-the-internet/\" rel=\"nofollow noreferrer\">so you want to expose go on the internet</a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": false, "score": 0, "last_activity_date": 1540838641, "creation_date": 1540838641, "answer_id": 53051914, "question_id": 53049354, "link": "https://stackoverflow.com/questions/53049354/how-to-take-the-exponent-of-math-big-float-in-go/53051914#53051914", "title": "How to take the exponent of math/big.Float in Go?", "body": "<p>You may use <a href=\"https://godoc.org/math/big#Float.MantExp\" rel=\"nofollow noreferrer\">MantExp()</a> to take the exponent of a <code>big.Float</code> for a particular base/mantissa. Note that the formula for calculating the exponent for a given mantissa is:</p>\n\n<pre><code>x == mant \u00d7 2**exp\n</code></pre>\n"}], "owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 444, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1540838641, "creation_date": 1540828652, "last_edit_date": 1540830481, "question_id": 53049354, "link": "https://stackoverflow.com/questions/53049354/how-to-take-the-exponent-of-math-big-float-in-go", "title": "How to take the exponent of math/big.Float in Go?", "body": "<p>I couldn't find anything in <a href=\"https://godoc.org/math/big\" rel=\"nofollow noreferrer\">the API</a>. Converting the number to a <code>math/big.Int</code> and back is not an option because the fractional component is significant to my calculation.</p>\n\n<hr>\n\n<p>I'll end up repeatedly multiplying if there's no API, but that's a dissatisfying solution (<code>math/big.Int.Exp</code> is just <code>O(log(n))</code>)  which might not be practical when I run into this problem again.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1540827587, "post_id": 53048977, "comment_id": 92997678, "body": "It&#39;s hard to get simpler than &quot;rm&quot;."}, {"owner": {"reputation": 1386, "user_id": 1382284, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/j3sde.jpg?s=128&g=1", "display_name": "Sitesh", "link": "https://stackoverflow.com/users/1382284/sitesh"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1540827802, "post_id": 53048977, "comment_id": 92997822, "body": "The problem with rm is that we have to identify all the files manually which can be tedious at times.. In your view &quot;go get&quot; also can be simply replaced by a cURL or something similar.. :) I wanted to know if the support is provided by golang itself.."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1540827851, "post_id": 53048977, "comment_id": 92997855, "body": "<code>rm -r $GOPATH&#47;src&#47;package</code> should do it. No need to manually identify anything. There&#39;s no equivalent replacement for <code>go get</code>."}, {"owner": {"reputation": 1386, "user_id": 1382284, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/j3sde.jpg?s=128&g=1", "display_name": "Sitesh", "link": "https://stackoverflow.com/users/1382284/sitesh"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1540827953, "post_id": 53048977, "comment_id": 92997911, "body": "If I am not wrong &quot;go get&quot; downloads (clones) the required repository as well which also should be cleaned up when you delete the package. And deleting both are not same as running a single command like go get.. to be more precise I am looking for a counterpart of go get.."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1540828065, "post_id": 53048977, "comment_id": 92997988, "body": "For git (and AFAIK, all other popular/supported RCSs), their meta data is stored within the checked-out directory, so I don&#39;t see any problem here."}, {"owner": {"reputation": 1386, "user_id": 1382284, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/j3sde.jpg?s=128&g=1", "display_name": "Sitesh", "link": "https://stackoverflow.com/users/1382284/sitesh"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1540832422, "post_id": 53048977, "comment_id": 93000404, "body": "Do you mean the meta data is not needed once the package is built ?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1540836716, "post_id": 53048977, "comment_id": 93002473, "body": "The meta data isn&#39;t need ever, unless you wish to interact with the RCS (i.e. do a &#39;git pull&#39;). It&#39;s never used for package building. I&#39;m not really sure what you&#39;re asking."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1540836859, "post_id": 53048977, "comment_id": 93002539, "body": "A comment on your recent edit: I&#39;m not sure what distinction you&#39;re trying to draw. You say &quot;I am aware that we can remove the downloaded files from src and pkg directory manually by using rm command&quot;, but then appear to be contrasting that with &quot;But is there a simple way to delete the downloaded package&quot;. Do you see these as different things? Because to me they seem to be the same."}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 9, "creation_date": 1540841021, "post_id": 53048977, "comment_id": 93004388, "body": "I am a bit surprised that there are so many downvotes. I think this is a perfectly valid question as other package manager do provide utilities to uninstall installed packages, e.g. <code>gem uninstall</code>, <code>npm uninstall</code> or <code>pip uninstall</code>"}, {"owner": {"reputation": 1386, "user_id": 1382284, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/j3sde.jpg?s=128&g=1", "display_name": "Sitesh", "link": "https://stackoverflow.com/users/1382284/sitesh"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1540860340, "post_id": 53048977, "comment_id": 93010989, "body": "@Flimzy basically I meant if there is golang way of removing the pkg as provided by other package managers."}, {"owner": {"reputation": 1386, "user_id": 1382284, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/j3sde.jpg?s=128&g=1", "display_name": "Sitesh", "link": "https://stackoverflow.com/users/1382284/sitesh"}, "reply_to_user": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1540882759, "post_id": 53048977, "comment_id": 93016592, "body": "@mbuechmann You are right.. there is no respect for a simple question in SO even if they don&#39;t have a solution/answer."}, {"owner": {"reputation": 1914, "user_id": 9811969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/184e2e46b8d8b8c483c85589709b8563?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/9811969/nik"}, "edited": false, "score": 3, "creation_date": 1554721735, "post_id": 53048977, "comment_id": 97842732, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/13792254/removing-packages-installed-with-go-get\">Removing packages installed with go get</a>"}], "answers": [{"comments": [{"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 2, "creation_date": 1540848805, "post_id": 53049015, "comment_id": 93007861, "body": "What if the package installs files into $GOPATH/pkg or $GOPATH/bin? And how would you know if it did?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 1, "creation_date": 1540880548, "post_id": 53049015, "comment_id": 93015726, "body": "@MadWombat: &quot;The package&quot; won&#39;t install files there--but the go compiler might. There&#39;s no automatic way to remove those. Removing $GOPATH/pkg files would be as simple as a second rm command such as <code>rm -r $GOPATH&#47;pkg&#47;*&#47;&lt;PACKAGE_NAME&gt;</code>. There is no way to tie the contents of <code>$GOPATH&#47;bin</code> back to the source package, though--as multiple packages could create the same output name."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 14, "creation_date": 1540913142, "post_id": 53049015, "comment_id": 93033650, "body": "So the <code>rm -r $GOPATH&#47;src&#47;&lt;PACKAGE_NAME&gt;</code> command in your answer does not, in fact, remove the package completely. And what you seem to be saying is that there is no way to remove an installed package completely.  That is a sad state of affairs for a language that is supposed to be &quot;modern&quot;"}, {"owner": {"reputation": 601, "user_id": 4223749, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/895a3e50a4188f3dce19eb25927b19f9?s=128&d=identicon&r=PG&f=1", "display_name": "dtrckd", "link": "https://stackoverflow.com/users/4223749/dtrckd"}, "edited": false, "score": 0, "creation_date": 1586295353, "post_id": 53049015, "comment_id": 108076397, "body": "<code>go clean -i &lt;package_name&gt;</code> seems to do the job at the moment."}], "tags": [], "owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "is_accepted": false, "score": 10, "last_activity_date": 1540827801, "last_edit_date": 1540827801, "creation_date": 1540827596, "answer_id": 53049015, "question_id": 53048977, "link": "https://stackoverflow.com/questions/53048977/how-to-remove-a-go-package-downloaded-with-go-get-command/53049015#53049015", "title": "How to remove a Go package downloaded with &quot;go get&quot; command?", "body": "<p>You can just delete it from you disk:</p>\n\n<pre><code>rm -r $GOPATH/src/&lt;PACKAGE_NAME&gt;\n</code></pre>\n\n<p>This will remove the package completely. Alas, there is no tool or go command for removing packages. But this should be simple enough.</p>\n"}, {"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 6, "last_activity_date": 1540827600, "creation_date": 1540827600, "answer_id": 53049017, "question_id": 53048977, "link": "https://stackoverflow.com/questions/53048977/how-to-remove-a-go-package-downloaded-with-go-get-command/53049017#53049017", "title": "How to remove a Go package downloaded with &quot;go get&quot; command?", "body": "<blockquote>\n  <p>But is there a simple way to delete the downloaded package (go delete PACKAGE_NAME?) ?</p>\n</blockquote>\n\n<p>No there is not.</p>\n\n<p>Manually <code>rm</code>ing is the way to go.</p>\n"}, {"tags": [], "owner": {"reputation": 1661, "user_id": 6453726, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fdbb3111485753ce50c22e66e42a8468?s=128&d=identicon&r=PG", "display_name": "guizo", "link": "https://stackoverflow.com/users/6453726/guizo"}, "is_accepted": false, "score": 4, "last_activity_date": 1587246125, "last_edit_date": 1587246125, "creation_date": 1587221291, "answer_id": 61291081, "question_id": 53048977, "link": "https://stackoverflow.com/questions/53048977/how-to-remove-a-go-package-downloaded-with-go-get-command/61291081#61291081", "title": "How to remove a Go package downloaded with &quot;go get&quot; command?", "body": "<p>For those using Go Modules <code>rm</code> is not enought as your <code>go.mod</code> and <code>go.sum</code> files stays dirty. You can use <code>go mod tidy</code> command which works but is not so intuitive.</p>\n\n<p>From <a href=\"https://blog.golang.org/migrating-to-go-modules\" rel=\"nofollow noreferrer\">https://blog.golang.org/migrating-to-go-modules</a>:</p>\n\n<blockquote>\n  <p>Removing a dependency can only be done after checking all packages in\n  a module, and all possible build tag combinations for those packages.\n  An ordinary build command does not load this information, and so it\n  cannot safely remove dependencies.</p>\n  \n  <p>The go mod tidy command cleans up these unused dependencies</p>\n</blockquote>\n\n<p>The first time I used it removed unused dependencies but also installed new ones. Later I discovered that it run tests to check if a dependency can be removed as described in <a href=\"https://github.com/golang/go/wiki/Modules#why-does-go-mod-tidy-record-indirect-and-test-dependencies-in-my-gomod\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/Modules#why-does-go-mod-tidy-record-indirect-and-test-dependencies-in-my-gomod</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 8088218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b515836044a66efb4538c19cae395e4?s=128&d=identicon&r=PG&f=1", "display_name": "Claude Roy", "link": "https://stackoverflow.com/users/8088218/claude-roy"}, "is_accepted": false, "score": 0, "last_activity_date": 1598881214, "creation_date": 1598881214, "answer_id": 63671922, "question_id": 53048977, "link": "https://stackoverflow.com/questions/53048977/how-to-remove-a-go-package-downloaded-with-go-get-command/63671922#63671922", "title": "How to remove a Go package downloaded with &quot;go get&quot; command?", "body": "<p>I found an easy solution for doing this. I am using fish shell so I just added this simple function in ~/.config/fish/config.fish.</p>\n<p>It does the job perfectly with cleaning up empty folders under $GOPATH. You might want to remove this part if you want to keep empty folders but for me, it was just annoying.</p>\n<p>Note that your GOPATH must be declared before the function declaration or this will not work.</p>\n<p>Make sure that you are checking for empty args because otherwise, this would remove the whole $GOPATH/src folder and you do not want that.</p>\n<p>If you're not under Mac, you'd need to edit the 'darwin_amd64' folder and if you're not on fish, this will not work but you can simply modify it to fit your current shell.</p>\n<pre><code>export GOPATH=$HOME/Go\n\nfunction godel\n   if string length -q $argv\n      rm -rf $GOPATH/src/$argv $GOPATH/pkg/darwin_amd64/$argv.a\n      find $GOPATH -type d -empty -delete\n   else\n      echo you must send an argument\n   end\nend\n</code></pre>\n"}], "owner": {"reputation": 1386, "user_id": 1382284, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/j3sde.jpg?s=128&g=1", "display_name": "Sitesh", "link": "https://stackoverflow.com/users/1382284/sitesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16902, "favorite_count": 2, "accepted_answer_id": 53049017, "answer_count": 4, "score": 18, "last_activity_date": 1598881214, "creation_date": 1540827467, "last_edit_date": 1542265635, "question_id": 53048977, "link": "https://stackoverflow.com/questions/53048977/how-to-remove-a-go-package-downloaded-with-go-get-command", "title": "How to remove a Go package downloaded with &quot;go get&quot; command?", "body": "<p>I want to know if there is golang way to delete or remove a go package. To be simpler, opposite to <strong>go get</strong> command.</p>\n\n<pre><code>e.g. \n$ go get &lt;PACKAGE_NAME&gt; \n$ go delete &lt;PACKAGE_NAME&gt;    (Looking for similar functionality)\n</code></pre>\n\n<p><strong>Please NOTE that I am aware that we can remove the downloaded files from <em>src</em> and pkg directory manually by using <em>rm</em> command. \nBut the problem is that system command <em>rm</em> is not aware of your go specific stuffs (etc. to look inside $GOPATH/pkg .. ) and this is an extra step for the user while using <em>rm</em> . I am looking for something which all package managers provides.. as mentioned in one comment.. (npm uninstall, pip uninstall etc..).</strong></p>\n"}, {"tags": ["go", "interface", "dry"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1540827898, "post_id": 53048766, "comment_id": 92997883, "body": "You want to put some code into a function. Okay. Just do it. Where is the problem? Are you overthinking it? Stop trying to do &quot;generic&quot; stuff with the excuse of &quot;DRY&quot; (or any other nonsense acronym)."}, {"owner": {"reputation": 41, "user_id": 10495639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2edf2adc6c69d546d1514508d136fe2?s=128&d=identicon&r=PG&f=1", "display_name": "fjson01", "link": "https://stackoverflow.com/users/10495639/fjson01"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1540828149, "post_id": 53048766, "comment_id": 92998048, "body": "That wasn&#39;t the issue. As I stated, all I wanted to know was, &quot; how to return this&quot; This being how do I return a non primitive type from another package library such as bigquery.NewClient(). What do I need to specify as a return type for the function in order to do this. Sorry if you misunderstood."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1540829921, "post_id": 53048766, "comment_id": 92999175, "body": "There is <i>no</i> <i>difference</i> between &quot;primitive types&quot; and other types. I&#39;d recommend taking the Tour of Go."}, {"owner": {"reputation": 41, "user_id": 10495639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2edf2adc6c69d546d1514508d136fe2?s=128&d=identicon&r=PG&f=1", "display_name": "fjson01", "link": "https://stackoverflow.com/users/10495639/fjson01"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1540830088, "post_id": 53048766, "comment_id": 92999284, "body": "Again, not what I was asking but thanks"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10495639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2edf2adc6c69d546d1514508d136fe2?s=128&d=identicon&r=PG&f=1", "display_name": "fjson01", "link": "https://stackoverflow.com/users/10495639/fjson01"}, "edited": false, "score": 0, "creation_date": 1540830041, "post_id": 53049736, "comment_id": 92999250, "body": "Oh, so you must include a pointer to the package name and struct that it references. This answers it perfectly. Thanks Adam this is what I was looking for"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 41, "user_id": 10495639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2edf2adc6c69d546d1514508d136fe2?s=128&d=identicon&r=PG&f=1", "display_name": "fjson01", "link": "https://stackoverflow.com/users/10495639/fjson01"}, "edited": false, "score": 1, "creation_date": 1540830254, "post_id": 53049736, "comment_id": 92999370, "body": "@fjson01 no, you must provide the type you&#39;re returning. In this case, since you&#39;re referring to <code>bigquery.NewClient</code> as such, it&#39;s clear that <code>Client</code> is named <code>bigquery.Client</code> in your context. Since <code>NewClient</code> returns a pointer to a <code>Client</code>, you must return a pointer as well (or resolve that pointer in your wrapping function, but that seems bad."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 41, "user_id": 10495639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2edf2adc6c69d546d1514508d136fe2?s=128&d=identicon&r=PG&f=1", "display_name": "fjson01", "link": "https://stackoverflow.com/users/10495639/fjson01"}, "edited": false, "score": 3, "creation_date": 1540830298, "post_id": 53049736, "comment_id": 92999396, "body": "For what it&#39;s worth, I agree with Volker that you should take the Tour of Go. You seem to be misunderstanding some fundamental aspects of the language."}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 2, "last_activity_date": 1540829961, "creation_date": 1540829961, "answer_id": 53049736, "question_id": 53048766, "link": "https://stackoverflow.com/questions/53048766/how-do-you-return-a-non-primitive-type-variable-in-golang/53049736#53049736", "title": "How do you return a non primitive type variable in golang", "body": "<p>Looks like <code>bigquery.NewClient</code> returns a <code>(*Client, error)</code>, so if you're trying to encapsulate that, you can probably just write a function that returns a <code>*bigquery.Client</code></p>\n"}, {"tags": [], "owner": {"reputation": 552, "user_id": 606880, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f0039481cbb27fea7ef2a47764e5335f?s=128&d=identicon&r=PG", "display_name": "viggy", "link": "https://stackoverflow.com/users/606880/viggy"}, "is_accepted": false, "score": 0, "last_activity_date": 1540833608, "creation_date": 1540833608, "answer_id": 53050705, "question_id": 53048766, "link": "https://stackoverflow.com/questions/53048766/how-do-you-return-a-non-primitive-type-variable-in-golang/53050705#53050705", "title": "How do you return a non primitive type variable in golang", "body": "<p>Ideally you want a helper go file instantiated as a singleton in OOPS terms. </p>\n\n<pre><code>package somehelper\n\ntype SomeData struct {\n    SubData1 SubDataType1\n    SubData2 SubDataType2\n}\n\nvar singleton *SomeData\nvar once sync.Once\n\nfunc Createsingleton(data1 SubDataType1, data2 SubDataType2) {\n    once.Do(func() {\n        singleton = &amp;SomeData{SubData1:data1, SubData2: data2}\n    })\n}\n\nfunc GetSingleton() *SomeData {\n    if singleton == nil {\n        panic(\"SomeDataHelper needs to be instantiated!!!\")\n    }\n    return singleton\n}\n\n\nfunc (i *SomeData) GetSubData1() SubData1{\n    return i.SubData1\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10495639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2edf2adc6c69d546d1514508d136fe2?s=128&d=identicon&r=PG&f=1", "display_name": "fjson01", "link": "https://stackoverflow.com/users/10495639/fjson01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 53049736, "answer_count": 2, "score": -4, "last_activity_date": 1541090967, "creation_date": 1540826792, "last_edit_date": 1541090967, "question_id": 53048766, "link": "https://stackoverflow.com/questions/53048766/how-do-you-return-a-non-primitive-type-variable-in-golang", "title": "How do you return a non primitive type variable in golang", "body": "<p>How do you return a non primitive type variable in golang</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1540824607, "post_id": 53048013, "comment_id": 92995775, "body": "shouldn&#39;t Inner be Inner string?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1540824929, "post_id": 53048013, "comment_id": 92995990, "body": "@Pizzalord: no, because it&#39;s an embedded field of type <code>Inner</code>, not a string."}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1540826296, "post_id": 53048081, "comment_id": 92996871, "body": "And to expand, if you have two embedded structs, both of which have a String() function, then calling <code>String()</code> on the embedding struct is ambiguous, and thus those those String() methods are not promoted.  This causes the embedding struct (<code>A</code>) to no longer implement the <code>fmt.Stringer</code> interface, so <code>fmt</code> falls back to the default printing format, which is why you get the full structure in that case."}], "tags": [], "owner": {"reputation": 14131, "user_id": 2224996, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/EDCvE.jpg?s=128&g=1", "display_name": "maja", "link": "https://stackoverflow.com/users/2224996/maja"}, "is_accepted": true, "score": 6, "last_activity_date": 1540825062, "last_edit_date": 1540825062, "creation_date": 1540824738, "answer_id": 53048081, "question_id": 53048013, "link": "https://stackoverflow.com/questions/53048013/why-v-is-printing-unexpected-value-for-nested-struct/53048081#53048081", "title": "Why %v is printing unexpected value for nested struct?", "body": "<p>Since you are embedding <code>Inner</code>, you inherent all its properties - including the String() - function. So <code>%v</code> is actually calling <code>Inner.String()</code></p>\n\n<p>From the docs (<a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/fmt/</a>) :</p>\n\n<blockquote>\n  <ol start=\"5\">\n  <li>If an operand implements method <code>String() string</code>, that method will\n  be invoked to convert the object to a string, which will then be\n  formatted as required by the verb (if any).</li>\n  </ol>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": false, "score": 1, "last_activity_date": 1540825037, "last_edit_date": 1592644375, "creation_date": 1540825037, "answer_id": 53048180, "question_id": 53048013, "link": "https://stackoverflow.com/questions/53048013/why-v-is-printing-unexpected-value-for-nested-struct/53048180#53048180", "title": "Why %v is printing unexpected value for nested struct?", "body": "<p>Because the <code>fmt</code> package states the rules for <code>%v</code> as:</p>\n<blockquote>\n<p>If the format (which is implicitly %v for Println etc.) is valid for a string (%s %q %v %x %X), the following two rules apply:</p>\n<ol start=\"4\">\n<li><p>If an operand implements the error interface, the Error method will be invoked to convert the object to a string, which will then be formatted as required by the verb (if any).</p>\n</li>\n<li><p>If an operand implements method String() string, that method will be invoked to convert the object to a string, which will then be formatted as required by the verb (if any).</p>\n</li>\n</ol>\n</blockquote>\n<p>Hence, <code>%v</code> actually uses the <code>String()</code> method for arguments that are stringers.</p>\n"}], "owner": {"reputation": 2676, "user_id": 558032, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/J2uZ3.png?s=128&g=1", "display_name": "PixelsTech", "link": "https://stackoverflow.com/users/558032/pixelstech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "accepted_answer_id": 53048081, "answer_count": 2, "score": -2, "last_activity_date": 1540828349, "creation_date": 1540824518, "last_edit_date": 1540828349, "question_id": 53048013, "link": "https://stackoverflow.com/questions/53048013/why-v-is-printing-unexpected-value-for-nested-struct", "title": "Why %v is printing unexpected value for nested struct?", "body": "<p>When printing a struct with nested struct which has a String() implemented, the <code>%v</code> format prints an 'unexpected' value per our understanding. </p>\n\n<p>Below is the code snippet.</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n)\n\ntype Inner struct {\n}\n\ntype A struct {\n    Inner\n    FieldA string\n}\n\nfunc (i Inner) String() string {\n    return \"anything\"\n}\n\nfunc main() {\n    myA := A{FieldA: \"A\"}\n    fmt.Printf(\"%v\", myA)\n}\n</code></pre>\n\n<p>We expect the output to be</p>\n\n<blockquote>\n  <p>{anything A}</p>\n</blockquote>\n\n<p>But the actual result is</p>\n\n<blockquote>\n  <p>anything</p>\n</blockquote>\n\n<p>Why this result? It seems <code>FieldA</code> is ignored? To make it more confusing, if we have two nested structs where both of them have String() implemented, the output is expected.</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n)\n\ntype Inner struct {\n}\n\ntype InnerAgain struct {\n}\n\ntype A struct {\n    Inner\n    InnerAgain\n    FieldA string\n}\n\nfunc (i Inner) String() string {\n    return \"anything\"\n}\n\nfunc (i InnerAgain) String() string {\n    return \"nothing\"\n}\n\nfunc main() {\n    myA := A{FieldA: \"A\"}\n    fmt.Printf(\"%v\", myA)\n}\n</code></pre>\n\n<p>The output is</p>\n\n<blockquote>\n  <p>{anything nothing A}</p>\n</blockquote>\n\n<p>...</p>\n"}, {"tags": ["go", "dependency-injection", "revel"], "comments": [{"owner": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1540825720, "post_id": 53047617, "comment_id": 92996513, "body": "<a href=\"http://github.com/jwells131313/dargo\" rel=\"nofollow noreferrer\">github.com/jwells131313/dargo</a> is a dependency injection system for go that handles adding in test mocks that override the &quot;real&quot; service for unit testing.  It might be what you are looking for"}, {"owner": {"reputation": 554, "user_id": 1990221, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6410f7d7324d1f9e0d6ef21a7cfb8d0c?s=128&d=identicon&r=PG", "display_name": "Stuart Moore", "link": "https://stackoverflow.com/users/1990221/stuart-moore"}, "reply_to_user": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1540827187, "post_id": 53047617, "comment_id": 92997418, "body": "Thanks. What I&#39;m struggling with is how to couple that with Revel - i.e. what is the correct place to put the code that obtains the dependencies, so that Revel executes it as part of creating a constructor"}, {"owner": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1540827458, "post_id": 53047617, "comment_id": 92997579, "body": "Unfortunately I can&#39;t help with that, I don&#39;t know anything about revel.  Dargo does allow for constructor functions for services and you could use that constructor function to construct your revel services maybe?"}], "answers": [{"comments": [{"owner": {"reputation": 554, "user_id": 1990221, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6410f7d7324d1f9e0d6ef21a7cfb8d0c?s=128&d=identicon&r=PG", "display_name": "Stuart Moore", "link": "https://stackoverflow.com/users/1990221/stuart-moore"}, "edited": false, "score": 1, "creation_date": 1541070088, "post_id": 53091961, "comment_id": 93095386, "body": "Thanks - I&#39;m specifically looking for a suggested way to use DI with Revel. It seems there isn&#39;t one - the best I have come up with is getting the dependencies on the Before() method of each controller, which works but may lead to unnecessary work, as it occurs for every request rather than once per controller."}], "tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1541019988, "creation_date": 1541019988, "answer_id": 53091961, "question_id": 53047617, "link": "https://stackoverflow.com/questions/53047617/revel-dependency-injection/53091961#53091961", "title": "Revel Dependency Injection", "body": "<p>In fact there's a lot of DI systems for GO. I've searched for several, tried to use and finally have chosen one with some patches for more convenience. Usage is quite easy:</p>\n\n<pre><code>package dependency\n\nimport (\n   \"fmt\"\n\n   \"github.com/lisitsky/inject\"\n)\n\nfunc init() {\n   inject.Provide(NewStringer)\n}\n\ntype stringer struct{}\n\nfunc (s stringer) String() string {\n    return \"Hello, World\"\n}\n\nfunc NewStringer() fmt.Stringer {\n    return stringer{}\n}\n</code></pre>\n\n<p>On a side accepting dependency (main.go):</p>\n\n<pre><code>package main\n\n\nimport (\n   \"fmt\"\n\n   \"github.com/lisitsky/inject\"\n\n   _ \"github.com/lisitsky/inject/examples/simple/dependency\"\n)\n\nvar ( \n   str fmt.Stringer\n)\n\nfunc main() {\n   inject.Construct(&amp;str)\n   fmt.Println(\"My Stringer is:\", str)\n}\n</code></pre>\n\n<p>Also it supports delayed initialization: </p>\n\n<pre><code>func main() {\n   // define variables to be constructed later\n   inject.ConstructLater(&amp;str)\n\n   // define dependency providers\n   inject.Provide(NewStringer)\n\n   // finalize construction - all DI variables would be initialized at one call\n   injector.FinishConstruct()\n\n   fmt.Println(\"My Stringer is:\", str)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 58775, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "is_accepted": true, "score": 1, "last_activity_date": 1553439677, "creation_date": 1553439677, "answer_id": 55325127, "question_id": 53047617, "link": "https://stackoverflow.com/questions/53047617/revel-dependency-injection/55325127#55325127", "title": "Revel Dependency Injection", "body": "<p>I use a <a href=\"https://revel.github.io/manual/filters.html\" rel=\"nofollow noreferrer\">filter</a> to inject dependencies.</p>\n\n<p>The filter tests if the controller implements specific interfaces and stuffs the correct dependency in. Here's an example that inserts a database-related dependency:</p>\n\n<pre><code>func DependencyFilter(c *revel.Controller, filterChain []revel.Filter) {\n    if ctrl, ok := c.AppController.(DataServiceController); ok {\n        ctrl.SetDataService(&lt;your dependency&gt;)\n    }\n\n    // Different dependencies could be injected here:\n    //if ctrl, ok := c.AppController.(FooController); ok {\n    //  ctrl.SetFooService(&lt;your dependency&gt;)\n    //}\n\n    // Call the next filter\n    if len(filterChain) &gt; 0 {\n        filterChain[0](c, filterChain[1:])\n    }\n}\n</code></pre>\n\n<p>Where <code>DataServiceController</code> is:</p>\n\n<pre><code>type DataServiceController interface {\n    SetDataService(ds services.DataService)\n}\n</code></pre>\n\n<p>I inserted my filter as the penultimate entry in <code>init.go</code>:</p>\n\n<pre><code>revel.Filters = []revel.Filter{\n    revel.PanicFilter,             // Recover from panics and display an error page instead.\n    // ...\n    DependencyFilter,              // Add dependencies\n    revel.ActionInvoker,           // Invoke the action.\n}\n</code></pre>\n\n<p>Most of my controllers need the same dependencies, so I have a base controller that they all embed:</p>\n\n<pre><code>type BaseController struct {\n    *revel.Controller\n    DataService services.DataService\n}\n\nfunc (c *BaseController) SetDataService(ds services.DataService) {\n    c.DataService = ds\n} \n</code></pre>\n\n<p>So my concrete controllers look like this:</p>\n\n<pre><code>type Home struct {\n    BaseController\n}\n\nfunc (c Home) Index() revel.Result {\n    // ...\n}\n</code></pre>\n\n<p>There might be better ways, but this is my approach.</p>\n"}], "owner": {"reputation": 554, "user_id": 1990221, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6410f7d7324d1f9e0d6ef21a7cfb8d0c?s=128&d=identicon&r=PG", "display_name": "Stuart Moore", "link": "https://stackoverflow.com/users/1990221/stuart-moore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "accepted_answer_id": 55325127, "answer_count": 2, "score": 2, "last_activity_date": 1553439677, "creation_date": 1540823132, "question_id": 53047617, "link": "https://stackoverflow.com/questions/53047617/revel-dependency-injection", "title": "Revel Dependency Injection", "body": "<p>I'm looking to have my revel controllers use various services, which I mock out for unit tests. I'm new to Go; in C# I'd inject them using dependency injection. Is there a common way to do this in revel?</p>\n\n<p>It seems like the best way I've found is to initialise the real services in the controller's Before() method (possibly using a method solved by wire), and to set the mock versions in the the test's Before() method. Or is there a better way?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1540823785, "post_id": 53046636, "comment_id": 92995251, "body": "If you just want the local timezone, you can use <code>time.Local.String()</code>. <a href=\"https://golang.org/pkg/time/#Location\" rel=\"nofollow noreferrer\">golang.org/pkg/time/#Location</a>"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1540824161, "post_id": 53046636, "comment_id": 92995492, "body": "This information is stored in the <code>time.Location</code> struct but is in an unexported field, and is not available from any exported method receiver."}], "answers": [{"tags": [], "owner": {"reputation": 148, "user_id": 7263440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b16f456d714f65cb780cee9a87dc0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan N", "link": "https://stackoverflow.com/users/7263440/dan-n"}, "is_accepted": false, "score": 3, "last_activity_date": 1540837061, "last_edit_date": 1540837061, "creation_date": 1540836241, "answer_id": 53051355, "question_id": 53046636, "link": "https://stackoverflow.com/questions/53046636/how-to-check-whether-current-local-time-is-dst/53051355#53051355", "title": "How to check whether current local time is DST?", "body": "<p>The <a href=\"https://golang.org/pkg/time/#Location\" rel=\"nofollow noreferrer\">Location</a> api doesn't export the DST value of the timezone. This was brought up in the <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/IOjBxMcq8IM\" rel=\"nofollow noreferrer\">golang-nuts forum</a> several years ago. One suggestion is to compare the January 1 timezone offset to the July 1 timezone offset. A working <a href=\"https://play.golang.org/p/JvHUk1NjO5\" rel=\"nofollow noreferrer\">solution</a> of this was posted using this method. One caveat is that goplay has the wrong local time, so it doesn't correctly report the information if you run it there. You can run it locally to verify that it does work.</p>\n\n<p>Another way would be to use reflection via the <a href=\"https://golang.org/pkg/reflect\" rel=\"nofollow noreferrer\">reflect</a> package. A solution that I wrote to do this is available <a href=\"https://play.golang.org/p/CaMHaqAN3Ex\" rel=\"nofollow noreferrer\">here</a>. There are a lot of problems with this method. </p>\n\n<p><em>Edit:</em> Really it should probably use <code>cacheZone</code> but does a linear search of the zones to find one that matches. This can lead to errors because some timezones share name and offset. The correct way would be to look at <code>cacheZone</code> and use that if it is set. Otherwise, you'll need to either look at <code>zoneTrans</code> or at least look at how <code>lookup(int64)</code> is implemented.</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1540841175, "last_edit_date": 1540841175, "creation_date": 1540840772, "answer_id": 53052382, "question_id": 53046636, "link": "https://stackoverflow.com/questions/53046636/how-to-check-whether-current-local-time-is-dst/53052382#53052382", "title": "How to check whether current local time is DST?", "body": "<p>You can infer the result. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\n// isTimeDST returns true if time t occurs within daylight saving time\n// for its time zone.\nfunc isTimeDST(t time.Time) bool {\n    // If the most recent (within the last year) clock change\n    // was forward then assume the change was from std to dst.\n    hh, mm, _ := t.UTC().Clock()\n    tClock := hh*60 + mm\n    for m := -1; m &gt; -12; m-- {\n        // assume dst lasts for least one month\n        hh, mm, _ := t.AddDate(0, m, 0).UTC().Clock()\n        clock := hh*60 + mm\n        if clock != tClock {\n            if clock &gt; tClock {\n                // std to dst\n                return true\n            }\n            // dst to std\n            return false\n        }\n    }\n    // assume no dst\n    return false\n}\n\nfunc main() {\n    pstLoc, err := time.LoadLocation(\"America/Los_Angeles\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    utc := time.Date(2018, 10, 29, 14, 0, 0, 0, time.UTC)\n    fmt.Println(utc, utc.Location(), \": DST\", isTimeDST(utc))\n    local := utc.In(time.Local)\n    fmt.Println(local, local.Location(), \": DST\", isTimeDST(local))\n    pst := utc.In(pstLoc)\n    fmt.Println(pst, pst.Location(), \": DST\", isTimeDST(pst))\n\n    utc = utc.AddDate(0, 3, 0)\n    fmt.Println(utc, utc.Location(), \": DST\", isTimeDST(utc))\n    local = utc.In(time.Local)\n    fmt.Println(local, local.Location(), \": DST\", isTimeDST(local))\n    pst = utc.In(pstLoc)\n    fmt.Println(pst, pst.Location(), \": DST\", isTimeDST(pst))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2018-10-29 14:00:00 +0000 UTC UTC : DST false\n2018-10-29 10:00:00 -0400 EDT Local : DST true\n2018-10-29 07:00:00 -0700 PDT America/Los_Angeles : DST true\n2019-01-29 14:00:00 +0000 UTC UTC : DST false\n2019-01-29 09:00:00 -0500 EST Local : DST false\n2019-01-29 06:00:00 -0800 PST America/Los_Angeles : DST false\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 0, "last_activity_date": 1606226546, "creation_date": 1606226546, "answer_id": 64988098, "question_id": 53046636, "link": "https://stackoverflow.com/questions/53046636/how-to-check-whether-current-local-time-is-dst/64988098#64988098", "title": "How to check whether current local time is DST?", "body": "<p>In a pinch, this should do the trick:</p>\n<pre><code>func inDST(t time.Time) bool {\n\n    jan1st := time.Date(t.Year(), 1, 1, 0, 0, 0, 0, t.Location()) // January 1st is always outside DST window\n\n    _, off1 := t.Zone()\n    _, off2 := jan1st.Zone()\n\n    return off1 != off2\n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 1989863, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/3397588b77ce50008a7f19b4e1a2aa37?s=128&d=identicon&r=PG&f=1", "display_name": "XZen", "link": "https://stackoverflow.com/users/1989863/xzen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1526, "favorite_count": 2, "answer_count": 3, "score": 11, "last_activity_date": 1606226546, "creation_date": 1540820073, "last_edit_date": 1540832226, "question_id": 53046636, "link": "https://stackoverflow.com/questions/53046636/how-to-check-whether-current-local-time-is-dst", "title": "How to check whether current local time is DST?", "body": "<p>In Ruby, for example, there's the <code>Time#dst?</code> function, which returns true in the case it is daylight saving time. Is there a Go standard library API call to do the same?</p>\n"}, {"tags": ["postgresql", "unit-testing", "go", "pq"], "answers": [{"comments": [{"owner": {"reputation": 1534, "user_id": 6619424, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52542029d07d6ca5d28ab46c837cb2bd?s=128&d=identicon&r=PG&f=1", "display_name": "Arun", "link": "https://stackoverflow.com/users/6619424/arun"}, "edited": false, "score": 1, "creation_date": 1540869749, "post_id": 53046906, "comment_id": 93012930, "body": "So how can I construct the error code? <code>pq.Error{Code: pq.ErrorCode(23505)}</code> doesn&#39;t seems to be working"}, {"owner": {"reputation": 331, "user_id": 4857969, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YHlcGGA6Vms/AAAAAAAAAAI/AAAAAAAAAUk/gnwvtrI87g8/photo.jpg?sz=128", "display_name": "Carson Hoffman", "link": "https://stackoverflow.com/users/4857969/carson-hoffman"}, "reply_to_user": {"reputation": 1534, "user_id": 6619424, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52542029d07d6ca5d28ab46c837cb2bd?s=128&d=identicon&r=PG&f=1", "display_name": "Arun", "link": "https://stackoverflow.com/users/6619424/arun"}, "edited": false, "score": 1, "creation_date": 1540870522, "post_id": 53046906, "comment_id": 93013103, "body": "The underlying type is still a <code>string</code>, so you should be doing <code>pq.Error{Code: &quot;23505&quot;}</code>."}, {"owner": {"reputation": 331, "user_id": 4857969, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YHlcGGA6Vms/AAAAAAAAAAI/AAAAAAAAAUk/gnwvtrI87g8/photo.jpg?sz=128", "display_name": "Carson Hoffman", "link": "https://stackoverflow.com/users/4857969/carson-hoffman"}, "reply_to_user": {"reputation": 1534, "user_id": 6619424, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52542029d07d6ca5d28ab46c837cb2bd?s=128&d=identicon&r=PG&f=1", "display_name": "Arun", "link": "https://stackoverflow.com/users/6619424/arun"}, "edited": false, "score": 1, "creation_date": 1540870608, "post_id": 53046906, "comment_id": 93013128, "body": "Could you give any more information? What is <code>err.Code.Name()</code> returning?"}], "tags": [], "owner": {"reputation": 331, "user_id": 4857969, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YHlcGGA6Vms/AAAAAAAAAAI/AAAAAAAAAUk/gnwvtrI87g8/photo.jpg?sz=128", "display_name": "Carson Hoffman", "link": "https://stackoverflow.com/users/4857969/carson-hoffman"}, "is_accepted": true, "score": 4, "last_activity_date": 1540820890, "creation_date": 1540820890, "answer_id": 53046906, "question_id": 53046324, "link": "https://stackoverflow.com/questions/53046324/go-mock-postgresql-errors/53046906#53046906", "title": "Go Mock postgresql errors", "body": "<p>As noted in the <a href=\"https://godoc.org/github.com/lib/pq#ErrorCode\" rel=\"nofollow noreferrer\">Godoc</a>, <code>ErrorCode is a five-character error code.</code> <code>err.Code.Name()</code> gets the human-friendly version of the error, but the error itself should be represented, and thus constructed, by the error code, which <a href=\"https://github.com/lib/pq/blob/master/error.go#L178\" rel=\"nofollow noreferrer\">in this case is 23505</a>.</p>\n"}], "owner": {"reputation": 1534, "user_id": 6619424, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52542029d07d6ca5d28ab46c837cb2bd?s=128&d=identicon&r=PG&f=1", "display_name": "Arun", "link": "https://stackoverflow.com/users/6619424/arun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 53046906, "answer_count": 1, "score": 0, "last_activity_date": 1540820890, "creation_date": 1540818978, "question_id": 53046324, "link": "https://stackoverflow.com/questions/53046324/go-mock-postgresql-errors", "title": "Go Mock postgresql errors", "body": "<p>As discussed in this <a href=\"https://stackoverflow.com/a/37560627/6619424\">answer</a>, I have written code for checking a unique key violation:</p>\n\n<pre><code>if err, ok := err.(*pq.Error); ok {\n    if err.Code.Name() == \"unique_violation\" {\n        fail(w, http.StatusBadRequest, 0, \"Item already exists\")\n                    return\n        }\n}\n</code></pre>\n\n<p>For writing unit-testcases, I need to mock this error. I have written the mock for the error like this: </p>\n\n<pre><code>return pq.Error{Code: \"unique_violation\"}\n</code></pre>\n\n<p>But this does not matches with the code. How do I mock the <code>pq.Error</code>?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 2, "creation_date": 1540815790, "post_id": 53045384, "comment_id": 92990213, "body": "Any gotchas? I can&#39;t see any reason why this can&#39;t be done by simply counting from the left."}, {"owner": {"reputation": 548, "user_id": 5345652, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZdgGaohbRX0/AAAAAAAAAAI/AAAAAAAAAAA/65laXilEcK8/photo.jpg?sz=128", "display_name": "Sharon Katz", "link": "https://stackoverflow.com/users/5345652/sharon-katz"}, "reply_to_user": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 0, "creation_date": 1540816193, "post_id": 53045384, "comment_id": 92990442, "body": "Looking for something embedded in GO, or very short format. example for writing:   strings.Repeat(padStr, pLen) .   Need the read function"}, {"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 0, "creation_date": 1540816492, "post_id": 53045384, "comment_id": 92990595, "body": "Maybe you just need <a href=\"https://golang.org/pkg/strconv/#Atoi\" rel=\"nofollow noreferrer\">golang.org/pkg/strconv/#Atoi</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1540816786, "post_id": 53045384, "comment_id": 92990773, "body": "I&#39;m voting to close this question as off-topic because: Homework"}, {"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 2, "creation_date": 1540817179, "post_id": 53045384, "comment_id": 92990982, "body": "@SharonKatz what do you mean by &quot;embedded&quot;? As Volker is pointing out, this seems like a homework question without enough context or constraints."}, {"owner": {"reputation": 548, "user_id": 5345652, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZdgGaohbRX0/AAAAAAAAAAI/AAAAAAAAAAA/65laXilEcK8/photo.jpg?sz=128", "display_name": "Sharon Katz", "link": "https://stackoverflow.com/users/5345652/sharon-katz"}, "edited": false, "score": 0, "creation_date": 1540818262, "post_id": 53045384, "comment_id": 92991630, "body": "I meant to ask if anything is embedded in the language. e.g for writing there is:  strings.Repeat(&quot;0&quot;, 3)   but agree to close or delete this question."}], "answers": [{"tags": [], "owner": {"reputation": 98839, "user_id": 3848, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W10YY.jpg?s=128&g=1", "display_name": "Motti", "link": "https://stackoverflow.com/users/3848/motti"}, "is_accepted": false, "score": -1, "last_activity_date": 1540816038, "creation_date": 1540816038, "answer_id": 53045502, "question_id": 53045384, "link": "https://stackoverflow.com/questions/53045384/is-there-an-embedded-opposite-of-strings-repeat0-3-detecting-number-of-lea/53045502#53045502", "title": "Is there an embedded opposite of strings.Repeat(&quot;0&quot;, 3) (detecting number of lead zeros) in Golang?", "body": "<p>Using regular expressions:</p>\n\n<pre><code>func LeadingZeros(str string) int {\n    re := regexp.MustCompile(\"^0.*\")\n    match := re.FindString(str)\n    return len(match)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1604, "user_id": 3351097, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/yInN3.jpg?s=128&g=1", "display_name": "Maxian Nicu", "link": "https://stackoverflow.com/users/3351097/maxian-nicu"}, "is_accepted": false, "score": 1, "last_activity_date": 1540816329, "last_edit_date": 1592644375, "creation_date": 1540816067, "answer_id": 53045509, "question_id": 53045384, "link": "https://stackoverflow.com/questions/53045384/is-there-an-embedded-opposite-of-strings-repeat0-3-detecting-number-of-lea/53045509#53045509", "title": "Is there an embedded opposite of strings.Repeat(&quot;0&quot;, 3) (detecting number of lead zeros) in Golang?", "body": "<pre><code>func LeadZeros(num string) int{\n    leadZerosNumber := 0\n    for leadZerosNumber &lt; len(num) &amp;&amp; num[leadZerosNumber] == '0' {  \n        leadZerosNumber++\n    }\n\n    return leadZerosNumber\n}\n</code></pre>\n<p>You can check all entire code on <a href=\"https://play.golang.org/p/49c9XQfC3Ho\" rel=\"nofollow noreferrer\">playground</a></p>\n<p>To adapt code to output these cases:</p>\n<blockquote>\n<p>LeadZeros(&quot;0&quot;)    --&gt; 0</p>\n<p>LeadZeros(&quot;00&quot;)   --&gt; 1</p>\n</blockquote>\n<p>Just change <strong>for</strong> condition from <code>leadZerosNumber &lt; len(num) &amp;&amp; num[leadZerosNumber] == '0'</code> to <code>leadZerosNumber &lt; len(num) - 1 &amp;&amp; num[leadZerosNumber] == '0'</code></p>\n"}, {"tags": [], "owner": {"reputation": 288, "user_id": 1469313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CsDQv.jpg?s=128&g=1", "display_name": "Bhavin Panara", "link": "https://stackoverflow.com/users/1469313/bhavin-panara"}, "is_accepted": false, "score": 0, "last_activity_date": 1540816123, "creation_date": 1540816123, "answer_id": 53045521, "question_id": 53045384, "link": "https://stackoverflow.com/questions/53045384/is-there-an-embedded-opposite-of-strings-repeat0-3-detecting-number-of-lea/53045521#53045521", "title": "Is there an embedded opposite of strings.Repeat(&quot;0&quot;, 3) (detecting number of lead zeros) in Golang?", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    yourString := \"0012\"\n    fmt.Println(\"Number Of Initial 0 = \", leadZeros(yourString))\n}\n\nfunc leadZeros(num string) (leadZerosNumber int) {\n\n    for index := range num {\n        if string(num[index]) == \"0\" {\n            leadZerosNumber++\n        } else {\n            break\n        }\n    }\n\n    return leadZerosNumber\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1540833162, "post_id": 53045558, "comment_id": 93000790, "body": "One might also want to range over the string runes rather than bytes so you don&#39;t match <code>0x30</code> in multi-byte characters."}], "tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": true, "score": 3, "last_activity_date": 1540816729, "last_edit_date": 1540816729, "creation_date": 1540816259, "answer_id": 53045558, "question_id": 53045384, "link": "https://stackoverflow.com/questions/53045384/is-there-an-embedded-opposite-of-strings-repeat0-3-detecting-number-of-lea/53045558#53045558", "title": "Is there an embedded opposite of strings.Repeat(&quot;0&quot;, 3) (detecting number of lead zeros) in Golang?", "body": "<pre><code>func LeadZeros(num string) int {\n\n    i := 0\n    for ;i &lt; len(num) &amp;&amp; num[i] == '0'; i++ {\n    }\n\n    return i\n}\n</code></pre>\n\n<p>There are a lot of ways to do this and I would suggest the easiest to understand. Here is another one-liner:</p>\n\n<pre><code>func LeadZeros(num string) int {\n    return len(num) - len(strings.TrimLeft(num, \"0\"))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 579, "user_id": 7327745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fcbd2d8ea52236dffc3449c0a29e881?s=128&d=identicon&r=PG&f=1", "display_name": "Subbu M", "link": "https://stackoverflow.com/users/7327745/subbu-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1540816315, "creation_date": 1540816315, "answer_id": 53045571, "question_id": 53045384, "link": "https://stackoverflow.com/questions/53045384/is-there-an-embedded-opposite-of-strings-repeat0-3-detecting-number-of-lea/53045571#53045571", "title": "Is there an embedded opposite of strings.Repeat(&quot;0&quot;, 3) (detecting number of lead zeros) in Golang?", "body": "<pre><code>package main\n\nimport \"fmt\"\n\nfunc main(){\n   fmt.Println(LeadingZeros(\"0010\"))\n}\n\n\nfunc LeadingZeros(s string) int {\nc:=0\n for _,v := range s {\n    if v=='0'{\n        c++\n    }else{\n        break\n    }\n }\n return c\n}\n</code></pre>\n"}], "owner": {"reputation": 548, "user_id": 5345652, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZdgGaohbRX0/AAAAAAAAAAI/AAAAAAAAAAA/65laXilEcK8/photo.jpg?sz=128", "display_name": "Sharon Katz", "link": "https://stackoverflow.com/users/5345652/sharon-katz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 53045558, "answer_count": 5, "score": -4, "last_activity_date": 1540818523, "creation_date": 1540815562, "last_edit_date": 1540818523, "question_id": 53045384, "link": "https://stackoverflow.com/questions/53045384/is-there-an-embedded-opposite-of-strings-repeat0-3-detecting-number-of-lea", "title": "Is there an embedded opposite of strings.Repeat(&quot;0&quot;, 3) (detecting number of lead zeros) in Golang?", "body": "<p>I have strings starting with 0's. need to get number of leading zeros:\nSomething like:</p>\n\n<pre><code>func LeadZeros(num string) int{\n    // count the leading zeros\n    return leadZerosNumber\n}\n\nLeadZeros(\"0012\") --&gt; 2\nLeadZeros(\"5\")    --&gt; 0\nLeadZeros(\"05\")   --&gt; 1\nLeadZeros(\"0\")    --&gt; 0 (1 also good)\nLeadZeros(\"00\")   --&gt; 1 (2 also good)\n</code></pre>\n\n<p>Looking for something embedded in go (or very short format)</p>\n\n<p>e.g for writing there is: strings.Repeat(\"0\", 3)</p>\n"}, {"tags": ["go", "mapping"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7693743, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QGwTlCk5rm0/AAAAAAAAAAI/AAAAAAAAAX8/eIRYXHFG02Q/photo.jpg?sz=128", "display_name": "Jerin Joseph", "link": "https://stackoverflow.com/users/7693743/jerin-joseph"}, "is_accepted": false, "score": 0, "last_activity_date": 1540814192, "creation_date": 1540814192, "answer_id": 53045002, "question_id": 53044584, "link": "https://stackoverflow.com/questions/53044584/how-to-access-nested-mapped-data-in-golang/53045002#53045002", "title": "How to access nested mapped data in golang?", "body": "<pre><code>for _, v := range mp3 {\n    for _,v1:= range v.(map[string]interface{}){\n    fmt.Println(v1)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/9zt0Z2Z4lXe\" rel=\"nofollow noreferrer\">https://play.golang.org/p/9zt0Z2Z4lXe</a></p>\n"}], "owner": {"reputation": 25, "user_id": 9999536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f05a59f4a6460df7878bf32a305c91d?s=128&d=identicon&r=PG&f=1", "display_name": "ansh", "link": "https://stackoverflow.com/users/9999536/ansh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1540859326, "creation_date": 1540812576, "last_edit_date": 1540812776, "question_id": 53044584, "link": "https://stackoverflow.com/questions/53044584/how-to-access-nested-mapped-data-in-golang", "title": "How to access nested mapped data in golang?", "body": "<p>Here I have a variable which show me the result in the nested mapped data but I want to access the nested mapped data values. How I will try to get the nested mapped data in the below program:-</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var five []int\n    var ten []int\n    mp1 := make(map[string]interface{})\n\n    for i := 0; i &lt; 0; i++ {\n        if i &gt; 5 {\n            five = append(five, i)\n        }\n        ten = append(ten, i)\n        fmt.Println(i)\n    }\n    mp1[\"not_completed\"] = five\n    mp1[\"completed\"] = ten\n\n    mp3 := make(map[string]interface{})\n    mp3[\"new_data\"] = mp1\n\n    fmt.Println(mp3)\n    fmt.Println(mp3[\"new_data\"])\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/mIU1-FQwou7\" rel=\"nofollow noreferrer\">This</a> is the link of the go playground I want to access the values of the data mapped in \"completed\" and \"not_completed\" . Will anyone give some help to me to solve this.</p>\n"}, {"tags": ["python", "regex", "go", "regex-lookarounds"], "comments": [{"owner": {"reputation": 820, "user_id": 4957508, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wBY-4a1-0jo/AAAAAAAAAAI/AAAAAAAAAfc/4BCoMMK1rqg/photo.jpg?sz=128", "display_name": "Jeff Schaller", "link": "https://stackoverflow.com/users/4957508/jeff-schaller"}, "edited": false, "score": 1, "creation_date": 1540811047, "post_id": 53050884, "comment_id": 93001325, "body": "How does it fail?"}, {"owner": {"reputation": 2568, "user_id": 9380694, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HF6fu.jpg?s=128&g=1", "display_name": "KC.", "link": "https://stackoverflow.com/users/9380694/kc"}, "edited": false, "score": 0, "creation_date": 1540866164, "post_id": 53050884, "comment_id": 93012139, "body": "you need to give us some examples and your code as you can."}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1540834327, "question_id": 478394}, "owner": {"reputation": 765, "user_id": 6932973, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/50b31fcb701115d22ba2ffa33649583a?s=128&d=identicon&r=PG&f=1", "display_name": "Rohith", "link": "https://stackoverflow.com/users/6932973/rohith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1540861859, "creation_date": 1540807156, "last_edit_date": 1540861859, "question_id": 53050884, "link": "https://stackoverflow.com/questions/53050884/regex-throws-error-template-variables-could-not-be-initialized", "title": "RegEx throws Error : Template variables could not be initialized", "body": "<p>I am using the below regex : <code>^(?!.*(ab1-canary|cd1-staging|cf-ab1-canary)).*$</code> ; This works well in python but fails to do so in GO language. Could you please help me in getting the right regex for GO.</p>\n\n<p>Regards,\nRohith</p>\n"}, {"tags": ["go", "pie-chart", "go-chart"], "comments": [{"owner": {"reputation": 51325, "user_id": 474349, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/ZMmIm.png?s=128&g=1", "display_name": "Hong Ooi", "link": "https://stackoverflow.com/users/474349/hong-ooi"}, "edited": false, "score": 1, "creation_date": 1540802961, "post_id": 53041702, "comment_id": 92982664, "body": "A Legends of Pi chart would be pretty cool to see"}, {"owner": {"reputation": 81, "user_id": 4398653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yj8yP.png?s=128&g=1", "display_name": "veerg404", "link": "https://stackoverflow.com/users/4398653/veerg404"}, "reply_to_user": {"reputation": 51325, "user_id": 474349, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/ZMmIm.png?s=128&g=1", "display_name": "Hong Ooi", "link": "https://stackoverflow.com/users/474349/hong-ooi"}, "edited": false, "score": 0, "creation_date": 1540803525, "post_id": 53041702, "comment_id": 92982977, "body": "raw := <code>{&quot;reaction_summary&quot;: {&quot;ANGRY&quot;: 7,&quot;HAHA&quot;: 40,&quot;LIKE&quot;: 161,&quot;LOVE&quot;: 56,&quot;SAD&quot;: 26,&quot;SHOCK&quot;: 6}}</code>  // Parse JSON data := struct {     ReactionSummary map[string]int <code>json:&quot;reaction_summary&quot;</code> }{} if err := json.Unmarshal([]byte(raw), &amp;data); err != nil {     log.Fatal(err) } // Populate a slice of chart values var values []chart.Value for l, v := range data.ReactionSummary {     values = append(values, chart.Value{Label: l, Value: float64(v)}) } // Initialize the chart pie := chart.PieChart{     Width:  512,     Height: 512,     Values: values, }  how to set legends"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1540805592, "post_id": 53041702, "comment_id": 92984271, "body": "@zaheerabbas can you please put the code on your question instead of putting it as comment? fyi, there is <b>edit</b> button underneath question"}, {"owner": {"reputation": 81, "user_id": 4398653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yj8yP.png?s=128&g=1", "display_name": "veerg404", "link": "https://stackoverflow.com/users/4398653/veerg404"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1540808002, "post_id": 53041702, "comment_id": 92985700, "body": "@xpare its edited. please review it"}], "owner": {"reputation": 81, "user_id": 4398653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yj8yP.png?s=128&g=1", "display_name": "veerg404", "link": "https://stackoverflow.com/users/4398653/veerg404"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1583743919, "creation_date": 1540802752, "last_edit_date": 1583743919, "question_id": 53041702, "link": "https://stackoverflow.com/questions/53041702/legends-of-pie-chart-using-go-chart-library", "title": "Legends of Pie chart using Go Chart library", "body": "<p>I am using \"<a href=\"https://github.com/wcharczuk/go-chart\" rel=\"nofollow noreferrer\">https://github.com/wcharczuk/go-chart</a>\" library to create pie chart. </p>\n\n<pre><code>raw := `{\"reaction_summary\": {\"ANGRY\": 7,\"HAHA\": 40,\"LIKE\": 161,\"LOVE\": 56,\"SAD\": 26,\"SHOCK\": 6}}`\n\n// Parse JSON\ndata := struct {\n    ReactionSummary map[string]int `json:\"reaction_summary\"`\n}{}\nif err := json.Unmarshal([]byte(raw), &amp;data); err != nil {\n    log.Fatal(err)\n}\n// Populate a slice of chart values\nvar values []chart.Value\nfor l, v := range data.ReactionSummary {\n    values = append(values, chart.Value{Label: l, Value: float64(v)})\n}\n// Initialize the chart\npie := chart.PieChart{\n    Width:  512,\n    Height: 512,\n    Values: values,\n}\n</code></pre>\n\n<p>I am having trouble in making legends for the graph. \nCould you please let me know about how to set legends for the graph?</p>\n\n<p><a href=\"https://i.stack.imgur.com/UpkyA.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "is_accepted": false, "score": 0, "last_activity_date": 1540802366, "creation_date": 1540802366, "answer_id": 53041615, "question_id": 53041519, "link": "https://stackoverflow.com/questions/53041519/gorilla-websocket-setting-read-limit/53041615#53041615", "title": "gorilla/websocket setting read limit?", "body": "<p>This does not seem to be well-documented indeed, but according to the <a href=\"https://github.com/gorilla/websocket/blob/3130e8d3f1986de7dc3fd86255f4ce9618677508/conn_test.go#L460\" rel=\"nofollow noreferrer\">corresponding test</a> it is in bytes. I'd assume that to be a default unit anyway.</p>\n\n<p>The relevant test code:</p>\n\n<pre><code>// Send message at the limit with interleaved pong.\nw, _ := wc.NextWriter(BinaryMessage)\nw.Write(message[:readLimit-1])\nwc.WriteControl(PongMessage, []byte(\"this is a pong\"), time.Now().Add(10*time.Second))\nw.Write(message[:1])\nw.Close()\n\n// Send message larger than the limit.\nwc.WriteMessage(BinaryMessage, message[:readLimit+1])\n\n// ...\n\n_, err = io.Copy(ioutil.Discard, r)\nif err != ErrReadLimit {\n    t.Fatalf(\"io.Copy() returned %v\", err)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1604, "user_id": 3351097, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/yInN3.jpg?s=128&g=1", "display_name": "Maxian Nicu", "link": "https://stackoverflow.com/users/3351097/maxian-nicu"}, "is_accepted": true, "score": 2, "last_activity_date": 1540802457, "creation_date": 1540802457, "answer_id": 53041636, "question_id": 53041519, "link": "https://stackoverflow.com/questions/53041519/gorilla-websocket-setting-read-limit/53041636#53041636", "title": "gorilla/websocket setting read limit?", "body": "<p>Based on the sources of <code>gorilla/websocket</code>, it's in bytes.</p>\n\n<pre><code>const readLimit = 512\nmessage := make([]byte, readLimit+1)\n.....\nrc.SetReadLimit(readLimit)\n</code></pre>\n\n<p>Here is the full unit test:</p>\n\n<pre><code>func TestReadLimit(t *testing.T) {\n\n    const readLimit = 512\n    message := make([]byte, readLimit+1)\n\n    var b1, b2 bytes.Buffer\n    wc := newConn(&amp;fakeNetConn{Writer: &amp;b1}, false, 1024, readLimit-2, nil, nil, nil)\n    rc := newTestConn(&amp;b1, &amp;b2, true)\n    rc.SetReadLimit(readLimit)\n\n    // Send message at the limit with interleaved pong.\n    w, _ := wc.NextWriter(BinaryMessage)\n    w.Write(message[:readLimit-1])\n    wc.WriteControl(PongMessage, []byte(\"this is a pong\"), time.Now().Add(10*time.Second))\n    w.Write(message[:1])\n    w.Close()\n\n    // Send message larger than the limit.\n    wc.WriteMessage(BinaryMessage, message[:readLimit+1])\n\n    op, _, err := rc.NextReader()\n    if op != BinaryMessage || err != nil {\n        t.Fatalf(\"1: NextReader() returned %d, %v\", op, err)\n    }\n    op, r, err := rc.NextReader()\n    if op != BinaryMessage || err != nil {\n        t.Fatalf(\"2: NextReader() returned %d, %v\", op, err)\n    }\n    _, err = io.Copy(ioutil.Discard, r)\n    if err != ErrReadLimit {\n        t.Fatalf(\"io.Copy() returned %v\", err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 10527936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10faded8ee52ba8dcdf52cd40204f52c?s=128&d=identicon&r=PG&f=1", "display_name": "faker", "link": "https://stackoverflow.com/users/10527936/faker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 900, "favorite_count": 0, "accepted_answer_id": 53041636, "answer_count": 2, "score": 0, "last_activity_date": 1540802457, "creation_date": 1540801927, "question_id": 53041519, "link": "https://stackoverflow.com/questions/53041519/gorilla-websocket-setting-read-limit", "title": "gorilla/websocket setting read limit?", "body": "<pre><code>// SetReadLimit sets the maximum size for a message read from the peer. If a\n// message exceeds the limit, the connection sends a close message to the peer\n// and returns ErrReadLimit to the application.\nfunc (c *Conn) SetReadLimit(limit int64) {\n    c.readLimit = limit\n}\n</code></pre>\n\n<p>What is the unit of limit? KB? MB ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1540800338, "post_id": 53041048, "comment_id": 92981500, "body": "you have not filled in the ou and dc parts, it should look something like this  cn=username,ou=folder,dc=sitename,dc=com"}, {"owner": {"reputation": 11, "user_id": 8224773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ae33c2a13b44acd049c5e651382e47b?s=128&d=identicon&r=PG&f=1", "display_name": "Shirokovea", "link": "https://stackoverflow.com/users/8224773/shirokovea"}, "reply_to_user": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1540800819, "post_id": 53041048, "comment_id": 92981721, "body": "I deleted these fields myself, i don`t want to show the structure. In real, there is like this cn=username,ou=folder,dc=sitename,dc=com"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1540804935, "post_id": 53041048, "comment_id": 92983846, "body": "You are violating constraints on your LDAP server.  The Go program is fine, your input string is not allowed by policy"}, {"owner": {"reputation": 11, "user_id": 8224773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ae33c2a13b44acd049c5e651382e47b?s=128&d=identicon&r=PG&f=1", "display_name": "Shirokovea", "link": "https://stackoverflow.com/users/8224773/shirokovea"}, "edited": false, "score": 0, "creation_date": 1540866323, "post_id": 53041048, "comment_id": 93012177, "body": "Then why does modify description work? Or on the LDAP server different constraints on change of attributes?"}, {"owner": {"reputation": 11, "user_id": 8224773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ae33c2a13b44acd049c5e651382e47b?s=128&d=identicon&r=PG&f=1", "display_name": "Shirokovea", "link": "https://stackoverflow.com/users/8224773/shirokovea"}, "edited": false, "score": 0, "creation_date": 1540869753, "post_id": 53041048, "comment_id": 93012932, "body": "Success. I changed the groupType to Global."}], "owner": {"reputation": 11, "user_id": 8224773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ae33c2a13b44acd049c5e651382e47b?s=128&d=identicon&r=PG&f=1", "display_name": "Shirokovea", "link": "https://stackoverflow.com/users/8224773/shirokovea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 469, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1540799760, "creation_date": 1540799760, "question_id": 53041048, "link": "https://stackoverflow.com/questions/53041048/ldap-cant-add-user-to-group", "title": "Ldap can&#39;t add user to group", "body": "<p>I need add a user to the group.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"crypto/tls\"\n    \"gopkg.in/ldap.v2\"\n)\n\nfunc main() {\n\n    bindusername := \"user\"\n    bindpassword := \"pass\"\n\n    l, err := ldap.Dial(\"tcp\", fmt.Sprintf(\"%s:%d\", \"ldap.example.com\", 389))\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(\"Connect dial\")\n    defer l.Close()\n\n    // Reconnect with TLS\n    err = l.StartTLS(&amp;tls.Config{InsecureSkipVerify: true})\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    err = l.Bind(bindusername, bindpassword)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(\"Connect bind\")\n\n    modify := ldap.NewModifyRequest(\"CN=test-group,OU=,DC=,DC=,DC=\")\n    modify.Add(\"member\", []string{\"CN=test-user,OU=,OU=,OU=,DC=,DC=,DC=\"})\n\n\n    err = l.Modify(modify)\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>But i can an errors:\n2018/10/29 10:33:00 LDAP Result Code 53 \"Unwilling To Perform\": 00002147: SvcErr: DSID-031A12D2, problem 5003 (WILL_NOT_PERFORM), data 0.</p>\n\n<p>If I change </p>\n\n<pre><code>modify.Add(\"member\", []string{\"CN=test-user,OU=,OU=,OU=,DC=,DC=,DC=\"})\n</code></pre>\n\n<p>to </p>\n\n<pre><code>modify.Add(\"description\", []string{\"test\"})\n</code></pre>\n\n<p>, there is no error. Help, please.</p>\n"}, {"tags": ["date", "datetime", "go", "format"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1540808815, "post_id": 53040935, "comment_id": 92986164, "body": "What does the error say?"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1540803999, "last_edit_date": 1540803999, "creation_date": 1540799749, "answer_id": 53041045, "question_id": 53040935, "link": "https://stackoverflow.com/questions/53040935/golang-strange-format-date/53041045#53041045", "title": "Golang strange format date", "body": "<p>See Go <a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\">package time</a>.</p>\n\n<p><code>0001-01-01 00:00:00 +0000 UTC</code> is the zero value for <code>time.Time</code>. The zero value is returned when a parsing error has occurred. </p>\n\n<p>Check for errors. Use the <code>time.RFC1123Z</code> (RFC1123 with numeric zone) layout for parsing to match your input. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    dt_pub, err := time.Parse(time.RFC1123Z, \"Thu, 01 Nov 2018 14:20:34 +0700\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Println(dt_pub)\n    fmt.Println(dt_pub.Format(\"2006-01-02 15:04:05\"))\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/rIoRVWArhfx\" rel=\"nofollow noreferrer\">https://play.golang.org/p/rIoRVWArhfx</a></p>\n\n<p>Output:</p>\n\n<pre><code>2018-11-01 14:20:34 +0700 +0700\n2018-11-01 14:20:34\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10526311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XhaUv.jpg?s=128&g=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10526311/paolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 1, "accepted_answer_id": 53041045, "answer_count": 1, "score": 1, "last_activity_date": 1540803999, "creation_date": 1540799173, "last_edit_date": 1540803119, "question_id": 53040935, "link": "https://stackoverflow.com/questions/53040935/golang-strange-format-date", "title": "Golang strange format date", "body": "<p>I have to convert a string date with this format:</p>\n\n<pre><code>Thu, 01 Nov 2018 14:20:34 +0700\n</code></pre>\n\n<p>.. into this format:</p>\n\n<pre><code>2018-11-01 14:20:34\n</code></pre>\n\n<p>I tried it with the following code:</p>\n\n<pre><code>dt_pub, err := time.Parse(\"RFC1123\", Thu, 01 Nov 2018 14:20:34 +0700)\ndt_pub.Format(\"2006-01-02 15:04:05\")\n</code></pre>\n\n<p>But unfortunately, the result looks like this:</p>\n\n<pre><code>0001-01-01 00:00:00 +0000 UTC\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "edited": false, "score": 0, "creation_date": 1540797754, "post_id": 53040335, "comment_id": 92980369, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/24512112/how-to-print-struct-variables-in-console\">How to print struct variables in console?</a>"}, {"owner": {"reputation": 2293, "user_id": 1098584, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7ab6b6d44e367a743580c3089026b7bc?s=128&d=identicon&r=PG", "display_name": "sontags", "link": "https://stackoverflow.com/users/1098584/sontags"}, "reply_to_user": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "edited": false, "score": 0, "creation_date": 1540797893, "post_id": 53040335, "comment_id": 92980444, "body": "No, as mentioned I only want to print the struct definition, not its content."}, {"owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "edited": false, "score": 0, "creation_date": 1540809581, "post_id": 53040335, "comment_id": 92986626, "body": "The accepted answer give examples on how to do both."}], "answers": [{"comments": [{"owner": {"reputation": 2293, "user_id": 1098584, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7ab6b6d44e367a743580c3089026b7bc?s=128&d=identicon&r=PG", "display_name": "sontags", "link": "https://stackoverflow.com/users/1098584/sontags"}, "edited": false, "score": 0, "creation_date": 1540804598, "post_id": 53041137, "comment_id": 92983641, "body": "Thats it, neat!"}], "tags": [], "owner": {"reputation": 7843, "user_id": 1368582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Dtbc.jpg?s=128&g=1", "display_name": "Tushar", "link": "https://stackoverflow.com/users/1368582/tushar"}, "is_accepted": true, "score": 4, "last_activity_date": 1540800199, "creation_date": 1540800199, "answer_id": 53041137, "question_id": 53040335, "link": "https://stackoverflow.com/questions/53040335/print-struct-definition-from-an-instance-in-go/53041137#53041137", "title": "Print struct definition from an instance in Go", "body": "<p>Would something like this work? Might need some adjusting depending on your specific struct and use case (whether you want to print interfaces{} where the value is actually a struct, etc.)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc printStruct(t interface{}, prefix string) {\n    s := reflect.Indirect(reflect.ValueOf(t))\n    typeOfT := s.Type()\n\n    for i := 0; i &lt; s.NumField(); i++ {\n        f := s.Field(i)\n\n        fmt.Printf(\"%s%s %s\\n\", prefix, typeOfT.Field(i).Name, typeOfT.Field(i).Type)\n        switch f.Type().Kind() {\n        case reflect.Struct, reflect.Ptr:\n            fmt.Printf(\"%s{\\n\", prefix)\n            printStruct(f.Interface(), prefix+\"\\t\")\n            fmt.Printf(\"%s}\\n\", prefix)\n\n        }\n    }\n}\n</code></pre>\n\n<p>Then, for this struct:</p>\n\n<pre><code>type C struct {\n    D string\n}\n\ntype T struct {\n    A int\n    B string\n    C *C\n    E interface{}\n    F map[string]int\n}\n\nt := T{\n    A: 23,\n    B: \"hello_world\",\n    C: &amp;C{\n        D: \"pointer\",\n    },\n    E: &amp;C{\n        D: \"interface\",\n    },\n}\n</code></pre>\n\n<p>You get:</p>\n\n<pre><code>A int\nB string\nC *main.C\n{\n    D string\n}\nE interface {}\nF map[string]int\n</code></pre>\n\n<p>Go Playground Link: <a href=\"https://play.golang.org/p/IN8-fCOe0OS\" rel=\"nofollow noreferrer\">https://play.golang.org/p/IN8-fCOe0OS</a></p>\n"}, {"tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": false, "score": 3, "last_activity_date": 1540800529, "last_edit_date": 1540800529, "creation_date": 1540800218, "answer_id": 53041143, "question_id": 53040335, "link": "https://stackoverflow.com/questions/53040335/print-struct-definition-from-an-instance-in-go/53041143#53041143", "title": "Print struct definition from an instance in Go", "body": "<p>I can see no other option than using reflection</p>\n\n<pre><code>func Sprint(v interface{}) string {\n\n    t := reflect.Indirect(reflect.ValueOf(v)).Type()\n\n    fieldFmt := \"\"\n\n    for i := 0; i &lt; t.NumField(); i++ {\n        field := t.Field(i)\n        fieldFmt += \"\\t\" + field.Name + \" \" + field.Type.Name() + \"\\n\"\n    }\n\n    return \"type \" + t.Name() + \" struct {\\n\" + fieldFmt + \"}\"\n}\n</code></pre>\n\n<p>Note though that this function has no validation/checking and might panic for non struct input.</p>\n\n<p>Edit:\nGo playground: <a href=\"https://play.golang.org/p/5RiAt86Wj9F\" rel=\"nofollow noreferrer\">https://play.golang.org/p/5RiAt86Wj9F</a></p>\n\n<p>Which outputs:</p>\n\n<pre><code>type Foo struct {\n    Bar string\n    Other int\n}\n</code></pre>\n"}], "owner": {"reputation": 2293, "user_id": 1098584, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7ab6b6d44e367a743580c3089026b7bc?s=128&d=identicon&r=PG", "display_name": "sontags", "link": "https://stackoverflow.com/users/1098584/sontags"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 53041137, "answer_count": 2, "score": 4, "last_activity_date": 1540812719, "creation_date": 1540796606, "last_edit_date": 1540812719, "question_id": 53040335, "link": "https://stackoverflow.com/questions/53040335/print-struct-definition-from-an-instance-in-go", "title": "Print struct definition from an instance in Go", "body": "<p>I am looking for a lib or snippet that allows to (pretty) print not the content of a struct instance but its structure. Heres a some code and the expected output:</p>\n\n<pre><code>package main\n\nimport \"fantastic/structpp\"\n\ntype Foo struct {\n    Bar string\n    Other int\n}\n\nfunc main() {\n    i := Foo{Bar: \"This\", Other: 1}\n    str := structpp.Sprint{i}\n    fmt.Println(str)\n}\n</code></pre>\n\n<p>would print (this or similar):</p>\n\n<pre><code>Foo struct {\n    Bar string\n    Other int\n}   \n</code></pre>\n\n<p>Note that I am aware of <code>github.com/davecgh/go-spew/spew</code> but I don't want to prettyprint the data, I only need the definition of the struct.</p>\n"}, {"tags": ["go", "proxy", "ftp"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1540797103, "post_id": 53040270, "comment_id": 92980076, "body": "FTP is notoriously difficult to proxy, because it uses more than one TCP connection per client. You have to intercept and rewrite the client&#39;s <code>PORT</code> command and/or the server&#39;s response to the <code>PASV</code> command, and then proxy the data connections dynamically (so far you only proxy the control connection). A simple io.Copy won&#39;t cut it for FTP."}, {"owner": {"reputation": 1, "user_id": 9810705, "user_type": "registered", "profile_image": "https://graph.facebook.com/2081099065470421/picture?type=large", "display_name": "Sergey Malkov", "link": "https://stackoverflow.com/users/9810705/sergey-malkov"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1540798497, "post_id": 53040270, "comment_id": 92980701, "body": "Thanks, @Peter. Maybe you know way to do this easy? Perhaps online service?"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 1, "creation_date": 1540812156, "post_id": 53040270, "comment_id": 92988117, "body": "work out which ftp server you need to use and then use this to set a proxy environment variable at the client end.  Alternatively, monitor the two ftp servers and alter DNS (using a short TTL) to give a different canonical name depending on which is up"}], "owner": {"reputation": 1, "user_id": 9810705, "user_type": "registered", "profile_image": "https://graph.facebook.com/2081099065470421/picture?type=large", "display_name": "Sergey Malkov", "link": "https://stackoverflow.com/users/9810705/sergey-malkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1540796917, "creation_date": 1540796260, "last_edit_date": 1540796917, "question_id": 53040270, "link": "https://stackoverflow.com/questions/53040270/proxying-between-2-ftp-servers-for-failover-using-3rd-server", "title": "Proxying between 2 FTP servers for failover using 3rd server", "body": "<p>I have a 1st ftp server on VDS # 1 (primary), which can sometimes be disabled by hosting. We have created a second VDS # 2 (secondary) that can help with fault tolerance when VDS # 1 is unreachable. VDS # 2 always has the same list of users with VDS # 1, with their usernames, passwords and directory tree.</p>\n\n<p>When users cannot access VDS # 1, we want to automatically redirect them to VDS # 2.\nI wrote the GOlang code (code below), but it does not work correctly, I do n't know why, I am new to FTP issues.</p>\n\n<p><a href=\"https://i.stack.imgur.com/w4adk.png\" rel=\"nofollow noreferrer\">Schematic view</a></p>\n\n<p>Can you help me? Perhaps there is a way to easily redirect the FTP request through a special server response or something like that?\nBig thanks to all!</p>\n\n<pre><code>func proxyConn(connection net.Conn) {\n\n    defer connection.Close()\n\n    remoteServer, remoteServerError := getActiveServer()\n    if remoteServerError != nil {\n        Error{}.PrintAndSave(remoteServerError.Error())\n        return\n    }\n\n    remoteConnection, remoteError := net.DialTCP(\"tcp\", nil, remoteServer)\n    if remoteError != nil {\n        Error{}.PrintAndSave(remoteError.Error())\n        return\n    }\n    defer remoteConnection.Close()\n\n    io.Copy(remoteConnection, connection)\n    io.Copy(connection, remoteConnection)\n}\n\nfunc getActiveServer() (*net.TCPAddr, error) {\n\n    connectedServerIndex := -1\n\n    for ftpServerIndex, ftpServer := range FTP_SERVERS {\n        connectedServer, serverError := net.DialTimeout(\"tcp\", fmt.Sprintf(\"%s:%d\", ftpServer, FTP_DEFAULT_PORT), CONNECTION_TIMEOUT)\n        if serverError != nil {\n            if ftpServerIndex == 0 {\n                // Send e-mail \"Server unreachable\"\n            }\n        } else {\n            connectedServerIndex = ftpServerIndex\n            connectedServer.Close()\n            break\n        }\n    }\n\n    if connectedServerIndex == -1 {\n        return nil, errors.New(\"active servers not found\")\n    }\n\n    return net.ResolveTCPAddr(\"tcp\", fmt.Sprintf(\"%s:%d\", FTP_SERVERS[connectedServerIndex], FTP_DEFAULT_PORT))\n}\n\nfunc main() {\n\n    localAddress, localAddressErr := net.ResolveTCPAddr(\"tcp\", fmt.Sprintf(\"%s:%d\", LOCAL_ADDRESS, FTP_DEFAULT_PORT))\n    if localAddressErr != nil {\n        Error{}.PrintAndSave(localAddressErr.Error())\n    }\n\n    server, serverError := net.ListenTCP(\"tcp\", localAddress)\n    if serverError != nil {\n        Error{}.PrintAndSave(serverError.Error())\n        return\n    }\n\n    for {\n        connection, connectionError := server.Accept()\n        if connectionError != nil {\n            Error{}.PrintAndSave(fmt.Sprintf(\"failed to accept listener: %v\", connectionError))\n        }\n\n        go proxyConn(connection)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "kibana", "elastic-stack", "metricbeat"], "comments": [{"owner": {"reputation": 5778, "user_id": 1847883, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3c1c5855c2dbaf4ca449654f807c5047?s=128&d=identicon&r=PG", "display_name": "ArcSet", "link": "https://stackoverflow.com/users/1847883/arcset"}, "edited": false, "score": 0, "creation_date": 1540792945, "post_id": 53039553, "comment_id": 92978475, "body": "Not  a powershell question. Removing tag"}, {"owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "edited": false, "score": 0, "creation_date": 1540793709, "post_id": 53039553, "comment_id": 92978730, "body": "Not a go question either"}], "owner": {"reputation": 1, "user_id": 10562435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c611a2489d83df455f4949a9c0d1028?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Jain", "link": "https://stackoverflow.com/users/10562435/gaurav-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540797125, "creation_date": 1540792646, "last_edit_date": 1540797125, "question_id": 53039553, "link": "https://stackoverflow.com/questions/53039553/kibana-visualization-of-winlogbeat-sending-sysmon-data-of-launch-time-applicatio", "title": "Kibana visualization of Winlogbeat sending sysmon data of launch time application of the application", "body": "<p>in the kibana dashboard, winlogbeat records the sysmon event and send it to elasticsearch and henceforth to kibana. there are 3 field name on time basis and i am not able to understand the difference between them namely event_data.PreviousCreationUtcTime, event_data.UtcTime and event_data.CreationUtcTime.<a href=\"https://i.stack.imgur.com/okXRN.png\" rel=\"nofollow noreferrer\">in the below link, it's kibana visualization </a></p>\n\n<p><a href=\"https://i.stack.imgur.com/okXRN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/okXRN.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["html", "go", "go-html-template"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1540795470, "post_id": 53039554, "comment_id": 92979357, "body": "Well, HTML has a certain structure. This structure is enforced e.g. by a browser and that&#39;s probably what you showed. E.g. the structure requires tbody-tags and those got inserted. If your data does not belong behind a tr tag (well, nothing belongs there except other tr tags) it will get moved. You <i>must</i> generate valid HTML. Without knowing what Data is, it is hard to tell what you dod wrong. Note that if Data contains <i>preformated</i> HTML you have to tell that to html.template via <a href=\"https://godoc.org/html/template#HTML\" rel=\"nofollow noreferrer\">godoc.org/html/template#HTML</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1540795566, "post_id": 53039554, "comment_id": 92979397, "body": "Best advice is: Do not render preformated HTML. Make Data a struct or a slice of structs, whatever and let html.template do the heavy work of escaping."}, {"owner": {"reputation": 17, "user_id": 10560513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7a4259d67507083e88345bfa578d2fc?s=128&d=identicon&r=PG&f=1", "display_name": "user10560513", "link": "https://stackoverflow.com/users/10560513/user10560513"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1540801003, "post_id": 53039554, "comment_id": 92981801, "body": "Thank you for the help, using template.HTML works"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1540818875, "post_id": 53039554, "comment_id": 92991985, "body": "<code>template.HTML</code> works but as Volker said, it&#39;s very much the wrong solution. Why bother using templates at all if you&#39;re passing HTML to them? Render your HTML in the template, not in the controller."}], "answers": [{"tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": false, "score": 0, "last_activity_date": 1540820421, "creation_date": 1540820421, "answer_id": 53046762, "question_id": 53039554, "link": "https://stackoverflow.com/questions/53039554/golang-html-template-not-properly-formatted/53046762#53046762", "title": "golang html template not properly formatted", "body": "<p>Just pass the entire slice of exchange rates to the template, and use <a href=\"https://golang.org/pkg/text/template/#hdr-Actions\" rel=\"nofollow noreferrer\"><code>range</code></a> to iterate over it.</p>\n\n<p>For example, if you have a struct like:</p>\n\n<pre><code>var ExchangeRates []ExchangeRate\n\ntype ExchangeRate struct {\n    From            string\n    To              string\n    Rate            float64\n    SevenDayAverage float64\n}\n</code></pre>\n\n<p>You will pass <code>ExchangeRates</code> to the template, and the template might look like:</p>\n\n<pre><code>&lt;table&gt;\n    &lt;tbody&gt;&lt;tr&gt;\n        &lt;td&gt;From&lt;/td&gt;\n        &lt;td&gt;To&lt;/td&gt;\n        &lt;td&gt;Rate&lt;/td&gt;\n        &lt;td&gt;7-day avg&lt;/td&gt;\n    &lt;/tr&gt;\n    {{range .ExchangeRates}}\n    &lt;tr&gt;\n        &lt;td&gt;{{.From}}&lt;/td&gt;\n        &lt;td&gt;{{.To}}&lt;/td&gt;\n        &lt;td&gt;{{.Rate}}&lt;/td&gt;\n        &lt;td&gt;{{.SevenDayAverage}}&lt;/td&gt;\n    &lt;/tr&gt;\n    {{end}}\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10560513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7a4259d67507083e88345bfa578d2fc?s=128&d=identicon&r=PG&f=1", "display_name": "user10560513", "link": "https://stackoverflow.com/users/10560513/user10560513"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1540820421, "creation_date": 1540792644, "question_id": 53039554, "link": "https://stackoverflow.com/questions/53039554/golang-html-template-not-properly-formatted", "title": "golang html template not properly formatted", "body": "<p>this might be a very basic question as I am not familiar with web programming at all. I am trying to create a table using html template which content is filled through a go script. My problem is that the  tag does not fall where I intended it to. This is the html used for the html template</p>\n\n<pre><code>&lt;h1&gt;Exchange Rate for {{.Title}}&lt;/h1&gt;\n\n&lt;form action=\"/dateShow/react\" method=\"POST\"&gt;\n&lt;table&gt;\n    &lt;tr&gt;\n        &lt;td&gt;From&lt;/td&gt;\n        &lt;td&gt;To&lt;/td&gt;\n        &lt;td&gt;Rate&lt;/td&gt;\n        &lt;td&gt;7-day avg&lt;/td&gt;\n    &lt;/tr&gt;{{.Data}}\n&lt;/table&gt;\n&lt;div&gt;&lt;input type=\"submit\" value=\"Save\"&gt;&lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>I was expecting that the GO script would print the \"data\" after the first \"tr\"tag and inside the \"table\" tag. Instead, this is what I get</p>\n\n<pre><code>&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Exchange Rate for 2018-07-02&lt;/h1&gt;\n\n&lt;form action=\"/dateShow/react\" method=\"POST\"&gt;\n&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;usd&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;idr&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;15.000000&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;14.238334&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;usd&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;sgd&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;1.320000&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;1.310000&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;\n&lt;table&gt;\n    &lt;tbody&gt;&lt;tr&gt;\n        &lt;td&gt;From&lt;/td&gt;\n        &lt;td&gt;To&lt;/td&gt;\n        &lt;td&gt;Rate&lt;/td&gt;\n        &lt;td&gt;7-day avg&lt;/td&gt;\n    &lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;\n&lt;div&gt;&lt;input type=\"submit\" value=\"Save\"&gt;&lt;/div&gt;\n&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<p>This is so weird to be as the \"title\" part works fine and landed Where I want it to. But not the case for the body</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1540795654, "post_id": 53039515, "comment_id": 92979434, "body": "Slice are common in Go, arrays are not. Don&#39;t use arrays unless there is a compelling reason. Your code has no reason for an array."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1540795840, "post_id": 53039515, "comment_id": 92979518, "body": "@Volker more about why it wasn&#39;t working, maybe show how to do with with a slice instead, for the newbs like me?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1540800848, "post_id": 53039515, "comment_id": 92981737, "body": "Why it doesn&#39;t work: The language forbids it. Variadic arguments <i>require</i> a slice: <a href=\"https://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Passing_arguments_to_..._parameters</a> . It is worth reading the language specification: It is clear, short and understandable. How to do with a slice: See ssemilla&#39;s answer: No ..."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1540841143, "post_id": 53039515, "comment_id": 93004448, "body": "there must be some very good reason why it works for a slice but an array"}], "answers": [{"comments": [{"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 1, "creation_date": 1540794455, "post_id": 53039774, "comment_id": 92978996, "body": "<code>[...]string{&quot;POST&quot;, &quot;PUT&quot;}</code> created an array of string with size of 2. That is why you are getting &quot;type [2]string&quot; in the error message."}], "tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": true, "score": 5, "last_activity_date": 1540794334, "last_edit_date": 1540794334, "creation_date": 1540793892, "answer_id": 53039774, "question_id": 53039515, "link": "https://stackoverflow.com/questions/53039515/cannot-spread-array-to-pass-as-multiple-arguments/53039774#53039774", "title": "Cannot spread array to pass as multiple arguments", "body": "<p>You don't need the <code>...</code> in <code>methods := [...]string{\"POST\", \"PUT\"}</code></p>\n\n<pre><code> methods := []string{\"POST\", \"PUT\"}\n</code></pre>\n\n<p>Edit:\nArrays are slightly different from slices. The <code>[...]</code> notation creates an array while a variadic function like <code>Methods()</code> accepts a slice. If you really need an array you can take a slice of it using <code>[:]</code>:</p>\n\n<pre><code>router.HandleFunc(h.makeRegisterNewUser(\"/api/v1/register\", v)).Methods(methods[:]...)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1541178828, "creation_date": 1541178828, "answer_id": 53123096, "question_id": 53039515, "link": "https://stackoverflow.com/questions/53039515/cannot-spread-array-to-pass-as-multiple-arguments/53123096#53123096", "title": "Cannot spread array to pass as multiple arguments", "body": "<p>The confusion arises from little bit different naming in Go and other languages. The data structure that resembles an array with different length and is called as \"array\", \"vector\", \"list\" in miscellaneous languages in Go is called \"slice\". And \"array\" in Go is another thing - a structure of fixed length. </p>\n"}], "owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 53039774, "answer_count": 2, "score": -1, "last_activity_date": 1541178828, "creation_date": 1540792460, "question_id": 53039515, "link": "https://stackoverflow.com/questions/53039515/cannot-spread-array-to-pass-as-multiple-arguments", "title": "Cannot spread array to pass as multiple arguments", "body": "<p>I have this:</p>\n\n<pre><code>methods := [...]string{\"POST\", \"PUT\"}\nrouter.HandleFunc(h.makeRegisterNewUser(\"/api/v1/register\", v)).Methods(\"POST\", \"PUT\")\n</code></pre>\n\n<p>that works except <code>methods</code> is unused. If I try this:</p>\n\n<pre><code>methods := [...]string{\"POST\", \"PUT\"}\nrouter.HandleFunc(h.makeRegisterNewUser(\"/api/v1/register\", v)).Methods(methods...)\n</code></pre>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>cannot use methods (type [2]string) as type []string in argument to\n  router.HandleFunc(h.makeRegisterNewUser(\"/api/v1/register\",\n  v)).Methods</p>\n</blockquote>\n\n<p>I can't figure this one out</p>\n"}, {"tags": ["sql", "validation", "go"], "answers": [{"tags": [], "owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "is_accepted": false, "score": 1, "last_activity_date": 1584612010, "last_edit_date": 1584612010, "creation_date": 1549663196, "answer_id": 54600822, "question_id": 53039386, "link": "https://stackoverflow.com/questions/53039386/go-validator-with-sql-null-types/54600822#54600822", "title": "Go validator with sql null types?", "body": "<p><strong>UPDATE</strong></p>\n\n<p>There is an <a href=\"https://github.com/go-playground/validator/blob/v9/_examples/custom/main.go\" rel=\"nofollow noreferrer\">Example</a> specifically for that. You may check it out. My other proposed solution should still work though.</p>\n\n<hr>\n\n<p>Since the value you are trying to validate is <code>Int64</code> inside <code>sql.NullInt64</code>, the easiest way would be to remove the <code>validate</code> tag and just register a <a href=\"https://github.com/go-playground/validator/blob/v9/_examples/struct-level/main.go\" rel=\"nofollow noreferrer\">Struct Level</a> validation using:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>validate.RegisterStructValidation(NullInt64StructLevelValidation, NullInt64{})\n</code></pre>\n\n<p>while <code>NullInt64StructLevelValidation</code> is a <code>StructLevelFunc</code> that looks like this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func NullInt64StructLevelValidation(sl validator.StructLevel) {\n    ni := sl.Current().Interface().(NullInt64)\n    if ni.NullInt64.Int64 &lt; 10 {\n        sl.ReportError(ni.NullInt64.Int64, \"Int64\", \"\", \"min\", \"\")\n    }\n}\n</code></pre>\n\n<p>Note #1: this line <code>thing := Thing{number,&amp;number,n,&amp;n}</code> has one argument too many. I assume you meant <code>thing := Thing{number, n, &amp;n}</code></p>\n\n<p>Note #2: Go tooling including <a href=\"https://golang.org/cmd/gofmt/\" rel=\"nofollow noreferrer\">gofmt</a> is considered to be one of the most powerful features of the language. Please consider using it/<a href=\"https://dev.to/plutov/go-tools-are-awesome-bom\" rel=\"nofollow noreferrer\">them</a>.</p>\n\n<p><strong>EDIT #1:</strong>\nI don't think implementing <code>Valuer</code> interface is of any value in this context.</p>\n"}], "owner": {"reputation": 28441, "user_id": 27305, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/174ac998689321daaa7cfecf910522e4?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/27305/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1584612010, "creation_date": 1540791674, "last_edit_date": 1549692125, "question_id": 53039386, "link": "https://stackoverflow.com/questions/53039386/go-validator-with-sql-null-types", "title": "Go validator with sql null types?", "body": "<p>I am having problems getting the golang validator to work with SQL null types.  Here's an example of what I tried:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"database/sql\"\n    \"database/sql/driver\"\n    \"log\"\n\n    \"gopkg.in/go-playground/validator.v9\"\n)\n\n// NullInt64\ntype NullInt64 struct {\n    sql.NullInt64\n    Set bool\n}\n\nfunc MakeNullInt64(valid bool, val int64) NullInt64 {\n    n := NullInt64{}\n    n.Set = true\n    n.Valid = valid\n    if valid {\n        n.Int64 = val\n    }\n    return n\n}\nfunc (n *NullInt64) Value() (driver.Value, error) {\n    if !n.NullInt64.Valid {\n        return nil, nil\n    }\n    return n.NullInt64.Int64, nil\n}\n\ntype Thing struct {\n    N2 NullInt64 `validate:\"min=10\"`\n    N3 int64     `validate:\"min=10\"`\n    N4 *int64    `validate:\"min=10\"`\n}\n\nfunc main() {\n    validate := validator.New()\n\n    n := int64(6)\n    number := MakeNullInt64(true, n)\n    thing := Thing{number, n, &amp;n}\n    e := validate.Struct(thing)\n\n    log.Println(e)\n}\n</code></pre>\n\n<p>When I run this code, I only get this output:</p>\n\n<blockquote>\n  <p>Key: 'Thing.N3' Error:Field validation for 'N3' failed on the 'min'\n  tag</p>\n  \n  <p>Key: 'Thing.N4' Error:Field validation for 'N4' failed on the\n  'min' tag</p>\n</blockquote>\n\n<p>The problem is that I want it to also show that <code>Thing.N2</code> failed for the same reasons as <code>Thing.N3</code> and <code>Thing.N4</code>.</p>\n\n<p>I tried introducing the <code>func (n *NullInt64) Value()</code> method because it was mentioned in the <a href=\"https://godoc.org/gopkg.in/go-playground/validator.v9\" rel=\"nofollow noreferrer\">documentation</a>.  But I think I misunderstood something.  Can anyone tell me what I did wrong?</p>\n"}, {"tags": ["docker", "go", "docker-compose"], "answers": [{"tags": [], "owner": {"reputation": 2285, "user_id": 4519500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/FRdEr.jpg?s=128&g=1", "display_name": "Sergiu", "link": "https://stackoverflow.com/users/4519500/sergiu"}, "is_accepted": false, "score": 0, "last_activity_date": 1540797588, "creation_date": 1540797588, "answer_id": 53040561, "question_id": 53039381, "link": "https://stackoverflow.com/questions/53039381/go-applications-fails-and-exits-when-running-using-docker-compose-but-works-fin/53040561#53040561", "title": "Go applications fails and exits when running using docker-compose, but works fine with docker run command", "body": "<p>The Go container stops running because of this:</p>\n\n<pre><code>WORKDIR $GOPATH/src/example.com/myapp\nRUN go build\n\n#EXPOSE 80\n\n#ENTRYPOINT $GOPATH/src/example.com/myapp/myapp\nENTRYPOINT ./myapp\n</code></pre>\n\n<p>You are switching directories to <em>$GOPATH/src/example.com/myapp</em> where you build your app, however, your <em>entry point</em> is pointing to the wrong location. </p>\n\n<p>To solve this, you either copy the app into the root directory and keep the same <em>ENTRYPOINT</em> command or you copy the application to a different location and pass the full path such as:</p>\n\n<pre><code>ENTRYPOINT /my/go/app/location\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "edited": false, "score": 0, "creation_date": 1540820246, "post_id": 53043420, "comment_id": 92992852, "body": "Thanks David!  I was up til 2am trying to figure this out.  Woke up and got it working in 5 minutes with your help."}], "tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": true, "score": 2, "last_activity_date": 1540808686, "creation_date": 1540808686, "answer_id": 53043420, "question_id": 53039381, "link": "https://stackoverflow.com/questions/53039381/go-applications-fails-and-exits-when-running-using-docker-compose-but-works-fin/53043420#53043420", "title": "Go applications fails and exits when running using docker-compose, but works fine with docker run command", "body": "<p>Your <code>docker-compose.yml</code> file says:</p>\n\n<pre><code>volumes:\n - /home/deploy/apps/myapp:/go/src/example.com/myapp\n</code></pre>\n\n<p>which means your host system's source directory is mounted over, and hides, everything that the Dockerfile builds.  <code>./myapp</code> is the <em>host's</em> copy of the <code>myapp</code> executable and if something is different (maybe you have a MacOS or Windows host) that will cause this error.</p>\n\n<p>This is a popular setup for interpreted languages where developers want to run their application without running a normal test-build-deploy sequence, but it doesn't really make sense for a compiled language like Go where you don't have a choice.  I'd delete this block entirely.</p>\n"}], "owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 53043420, "answer_count": 2, "score": 0, "last_activity_date": 1554789898, "creation_date": 1540791653, "last_edit_date": 1554789898, "question_id": 53039381, "link": "https://stackoverflow.com/questions/53039381/go-applications-fails-and-exits-when-running-using-docker-compose-but-works-fin", "title": "Go applications fails and exits when running using docker-compose, but works fine with docker run command", "body": "<p>I am running all of these operations on a remove server that is a\n<strong>VM running Ubuntu 16.04.5 x64</strong>.</p>\n\n<p>My Go project's Dockerfile looks like:</p>\n\n<pre><code>FROM golang:latest\n\nADD . $GOPATH/src/example.com/myapp\nWORKDIR $GOPATH/src/example.com/myapp\nRUN go build\n\n#EXPOSE 80\n\n#ENTRYPOINT $GOPATH/src/example.com/myapp/myapp\nENTRYPOINT ./myapp\n#CMD [\"./myapp\"]\n</code></pre>\n\n<p>When I run the docker container using <code>docker-compose up -d</code>, the Go application exits and I see this in the docker logs:</p>\n\n<blockquote>\n  <p>myapp_1  | /bin/sh: 1: ./myapp: Exec format error docker_myapp_1\n  exited with code 2</p>\n</blockquote>\n\n<p>If I locate the image using <code>docker images</code> and run the image like:</p>\n\n<pre><code> docker run -it 75d4a95ef5ec \n</code></pre>\n\n<p>I can see that my golang applications runs just fine:</p>\n\n<blockquote>\n  <p>viper environment is: development HTTP server listening on address:\n  \":3005\"</p>\n</blockquote>\n\n<p>When I googled for this error some people suggested compiling with some special flags but I am running this container on the same Ubuntu host so I am really confused why this isn't working using docker.</p>\n\n<p>My docker-compose.yml looks like:</p>\n\n<pre><code>version: \"3\"\n\nservices:\n  openresty:\n    build: ./openresty\n    ports:\n     - \"80:80\"\n     - \"443:443\"\n    depends_on:\n      - myapp\n    env_file:\n     - '.env'\n    restart: always\n\n  myapp:\n    build: ../myapp\n    volumes:\n     - /home/deploy/apps/myapp:/go/src/example.com/myapp\n    ports:\n      - \"3005:3005\"\n    depends_on:\n      - db\n      - redis\n      - memcached\n    env_file:\n      - '.env'\n\n  redis:\n    image: redis:alpine\n    ports:\n    - \"6379:6379\"\n    volumes:\n     - \"/home/deploy/v/redis:/data\"\n    restart: always\n\n  memcached:\n    image: memcached\n    ports:\n      - \"11211:11211\"\n    restart: always\n\n  db:\n    image: postgres:9.4\n    volumes:\n      - \"/home/deploy/v/pgdata:/var/lib/postgresql/data\"\n    restart: always\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1540792365, "post_id": 53039039, "comment_id": 92978313, "body": "What&#39;s wrong with fmt.Sprintf(&quot;{}&quot;)?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1540792969, "post_id": 53039039, "comment_id": 92978485, "body": "@Volker maybe you can write what you think the question means? How would I get the struct  representation into there? aka,<code>fmt.Sprintf(ResolutionValue)</code>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1540795146, "post_id": 53039039, "comment_id": 92979259, "body": "What is the JSON encoding of a non-existing i.e. non-instantiated thing? It probably is a fixed string. So just use that string value. If it is something dynamic it probably depends on the values. If you are interested in the struct fields: Reflect. The requirement &quot;not instantiated&quot; is 100% useless as it unnecessarily complicates things without any benefit. Your question makes no sense."}], "answers": [{"tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": true, "score": 1, "last_activity_date": 1540790396, "last_edit_date": 1540790396, "creation_date": 1540790090, "answer_id": 53039105, "question_id": 53039039, "link": "https://stackoverflow.com/questions/53039039/creating-json-from-struct-not-struct-value/53039105#53039105", "title": "Creating JSON from struct, not struct value", "body": "<p>Even with reflection, you would need an actual value to get the type using <code>reflect.TypeOf</code>. So I would suggest just using the zero value of your type.</p>\n\n<pre><code>json.Marshal(ResolutionValue{})\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 53039105, "answer_count": 1, "score": -1, "last_activity_date": 1540790396, "creation_date": 1540789651, "question_id": 53039039, "link": "https://stackoverflow.com/questions/53039039/creating-json-from-struct-not-struct-value", "title": "Creating JSON from struct, not struct value", "body": "<p>I imagine I would need the reflect package to do this. Say I have a struct like so:</p>\n\n<pre><code>type Inner struct {\n   Whatever int\n}\n\ntype ResolutionValue struct {\n    Val string\n    Inner\n}\n</code></pre>\n\n<p>say I want to generate a JSON representation of the ResolutionValue struct...is there some way to create a JSON representation without instantiating it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 1, "creation_date": 1540789434, "post_id": 53038922, "comment_id": 92977547, "body": "Are you trying to implement an inner type? If so, that is really hard to do without making it messy. I&#39;d suggest going with your second option.  <a href=\"https://stackoverflow.com/questions/24809235/initialize-a-nested-struct-in-golang\" title=\"initialize a nested struct in golang\">stackoverflow.com/questions/24809235/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "edited": false, "score": 0, "creation_date": 1540790619, "post_id": 53039050, "comment_id": 92977813, "body": "yeah you may want to mention that I can just do <code>ResolutionValue</code> instead of <code>ResolutionValue ResolutionValue</code>, I just learned that a few minutes ago"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "edited": false, "score": 0, "creation_date": 1540790663, "post_id": 53039050, "comment_id": 92977827, "body": "For example, <code>Inner</code> here: <a href=\"https://stackoverflow.com/questions/53039039/creating-json-from-struct-not-struct-value\" title=\"creating json from struct not struct value\">stackoverflow.com/questions/53039039/&hellip;</a>"}, {"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 0, "creation_date": 1540790917, "post_id": 53039050, "comment_id": 92977892, "body": "I&#39;d edit the answer, but based from what you were trying to accomplish, it was more of an inner struct/type."}], "tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": true, "score": 0, "last_activity_date": 1540791163, "last_edit_date": 1540791163, "creation_date": 1540789745, "answer_id": 53039050, "question_id": 53038922, "link": "https://stackoverflow.com/questions/53038922/refer-to-inner-struct/53039050#53039050", "title": "Refer to inner struct", "body": "<p>As of Go 1.11, nested types are not supported.</p>\n\n<p><a href=\"https://github.com/golang/go/issues/20467\" rel=\"nofollow noreferrer\">Proposal discussion</a></p>\n\n<p>Your revision looks a lot nicer IMO.</p>\n\n<p>Edit: Maybe unrelated to the question but you can use type embedding to simplify your types. However, note that the representation are different:</p>\n\n<pre><code>type Inner struct {\n    Whatever int\n}\n\ntype ResolutionValue struct {\n    Val string\n    Inner\n}\n\ntype ResolutionValue2 struct {\n    Val    string\n    Inner Inner\n}\n\nfunc main() {\n\n    a, _ := json.Marshal(ResolutionValue{})\n    b, _ := json.Marshal(ResolutionValue2{})\n    fmt.Printf(\"%s\\n%s\", a, b)\n\n}\n</code></pre>\n\n<p>Which prints:</p>\n\n<pre><code>{\"Val\":\"\",\"Whatever\":0}\n{\"Val\":\"\",\"Inner\":{\"Whatever\":0}}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 53039050, "answer_count": 1, "score": 0, "last_activity_date": 1540791163, "creation_date": 1540788680, "question_id": 53038922, "link": "https://stackoverflow.com/questions/53038922/refer-to-inner-struct", "title": "Refer to inner struct", "body": "<p>I am trying to create some API docs programmatically, I have this:</p>\n\n<pre><code>type APIDoc struct {\n    Route           string\n    ResolutionValue struct {\n       v           string\n    }\n}\n</code></pre>\n\n<p>and then I tried doing this:</p>\n\n<pre><code>    json.NewEncoder(w).Encode(APIDoc.ResolutionValue{\"foo\"})\n</code></pre>\n\n<p>but it says that </p>\n\n<blockquote>\n  <p>APIDoc.ResolutionValue undefined (type APIDoc has no method\n  ResolutionValue)</p>\n</blockquote>\n\n<p>so I resorted to doing this:</p>\n\n<pre><code>type ResolutionValue struct {\n    v string\n}\n\ntype APIDoc struct {\n    Route           string\n    ResolutionValue ResolutionValue\n}\n</code></pre>\n\n<p>and then doing:</p>\n\n<pre><code>    json.NewEncoder(w).Encode(ResolutionValue{\"foo\"})\n</code></pre>\n\n<p>kinda lame tho, is there a way to ensure integrity somehow?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "edited": false, "score": 0, "creation_date": 1540788735, "post_id": 53038676, "comment_id": 92977408, "body": "severely dumb design for this env var, but that is not your fault, thx"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1540788837, "post_id": 53038676, "comment_id": 92977422, "body": "It&#39;s being removed in 1.12. So at least it won&#39;t last."}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 2, "last_activity_date": 1540786592, "creation_date": 1540786592, "answer_id": 53038676, "question_id": 53038556, "link": "https://stackoverflow.com/questions/53038556/setting-gocache-on-put-a-bunch-of-files-in-the-on-directory/53038676#53038676", "title": "setting GOCACHE=&quot;on&quot; put a bunch of files in the on/ directory", "body": "<p>Only <code>off</code> is valid. Anything other than that will be treated as a directory/path to put the cached objects. See <a href=\"https://github.com/golang/go/issues/28290\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/28290</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 53038676, "answer_count": 1, "score": -1, "last_activity_date": 1540819026, "creation_date": 1540785415, "last_edit_date": 1540819026, "question_id": 53038556, "link": "https://stackoverflow.com/questions/53038556/setting-gocache-on-put-a-bunch-of-files-in-the-on-directory", "title": "setting GOCACHE=&quot;on&quot; put a bunch of files in the on/ directory", "body": "<p>I had this test helper script:</p>\n\n<pre><code>#!/usr/bin/env bash\n\nexport GOPATH=\"$PWD\"\nexport GOCACHE=\"off\" \n\nif [[ -z \"$2\" ]]; then\n     go test -test.v \"$1\" \nelse\n     go test -test.v -run \"$1\"  \"$2\"\nfi\n</code></pre>\n\n<p>in my infinite curiosity I change it to:</p>\n\n<pre><code>export GOCACHE=\"on\"\n</code></pre>\n\n<p>and now I have a bunch of files in the on/ dir, looks like:</p>\n\n<pre><code>rm 'on/f5/f545eea03c3b3918eb9ea8da640e4096bb88e737da8fe79b982282e391034a00-d'\nrm 'on/f5/f5f8e6ba734b39e6e3994bd38ae138ee5f1c934fb31aa3d67b6ebab51e064550-d'\nrm 'on/f7/f77ddf07d9322f6fc37a8ccd8a3b1e204df20269d046d9f26e514ce8ee71dd24-a'\nrm 'on/f9/f95e42f33f46590cc13a52c8c5ced78ee10b1d6223116b96e5048bbfca45a8fa-a'\nrm 'on/f9/f960e1bdd90bdbedd9c1b6a4f84034b695366008fe9572f8eade4d6091ab7783-a'\nrm 'on/f9/f983bb0548444122f704c06b85bfc940edea3ad6674c8bed4b259d3682e61ed6-a'\nrm 'on/fa/fa0f06fb98f8e24e2896e173fa5ffafe741f388ecbc0ab05980bc6d7e582822e-a'\nrm 'on/fa/fa21e4bcc0150a1df51f1c0342c16a12a1bbf3fc6266258794e8c4bed7366bd7-d'\nrm 'on/fa/fac556023783b822b6b37ae37bf02932456e965ad1b37f4e45419c9779eb648e-a'\nrm 'on/fb/fb1df4e560bc5701575401f7a3f12d29545b2ff1b931852f45f5e79ff798ab0e-a'\nrm 'on/fb/fb32adee7638f775a9161a321db4fc76419e6370795c0d83d51a9edc116d3c65-a'\nrm 'on/fb/fbd3f0a0b1bcb06b94a210547b346183455be303d482240b6e3b775ad91141c1-d'\nrm 'on/fb/fbf683cd1314637c28aaf4fb65205d990c459938c32673d6492b0a046c5a2483-d'\nrm 'on/fc/fc40abd0343f9a80c5b3dab549574858d22f9d70262ed2d3a847fdb54e3e303e-d'\nrm 'on/fc/fc55620605eb3828cb262ebff9a1e314f65646349b01e6d7b2fb71b68a24b067-a'\nrm 'on/fc/fc6ca27ea05682c412053e174d21b2736ede872a69331fb58fb740\n</code></pre>\n\n<p>anybody know what that's about?</p>\n"}, {"tags": ["go", "binary"], "comments": [{"owner": {"reputation": 1762, "user_id": 4809143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f33979f2bebd6f01e560573520b13c?s=128&d=identicon&r=PG&f=1", "display_name": "moreON", "link": "https://stackoverflow.com/users/4809143/moreon"}, "edited": false, "score": 2, "creation_date": 1540784841, "post_id": 53038469, "comment_id": 92976718, "body": "Why do you think that you would? What do you think cat does? How do you think other files that are not compiled &quot;binaries&quot; are stored?"}], "answers": [{"tags": [], "owner": {"reputation": 106867, "user_id": 13663, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/92f0c7fe372960ea92560487665a8720?s=128&d=identicon&r=PG", "display_name": "Will Hartung", "link": "https://stackoverflow.com/users/13663/will-hartung"}, "is_accepted": false, "score": 4, "last_activity_date": 1540784843, "creation_date": 1540784843, "answer_id": 53038497, "question_id": 53038469, "link": "https://stackoverflow.com/questions/53038469/when-i-compile-a-program-and-cat-on-it-why-dont-i-see-0s-and-1s/53038497#53038497", "title": "When I compile a program and cat on it, why don&#39;t I see 0&#39;s and 1&#39;s", "body": "<p>Because even though the code is compiled in to \"binary code\", <code>cat</code> just dumps out characters, which are 8-bit bytes. </p>\n\n<p>If you used, for example, something like <code>od -x</code> you'd see the program represented as hexadecimal numbers, which is the most common representation today for \"binary\" data.</p>\n"}, {"tags": [], "owner": {"reputation": 1623, "user_id": 7273274, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/YJ2PI.png?s=128&g=1", "display_name": "Fuji Komalan", "link": "https://stackoverflow.com/users/7273274/fuji-komalan"}, "is_accepted": false, "score": 0, "last_activity_date": 1540784934, "creation_date": 1540784934, "answer_id": 53038508, "question_id": 53038469, "link": "https://stackoverflow.com/questions/53038469/when-i-compile-a-program-and-cat-on-it-why-dont-i-see-0s-and-1s/53038508#53038508", "title": "When I compile a program and cat on it, why don&#39;t I see 0&#39;s and 1&#39;s", "body": "<p>Computers don't understand what you have typed on the source code file ( The file that you have compiled is called source code). You have to translate all you have typed into the source code into a format that computers can understand ( The language of the computer is known as machine code). Compilation is a translation process, which translate your source code into machine code. you are actually cat the machine code file, which is not a text file instead it is a binary file. we can not open a binary file using cat command.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10443186"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1540784934, "creation_date": 1540784604, "question_id": 53038469, "link": "https://stackoverflow.com/questions/53038469/when-i-compile-a-program-and-cat-on-it-why-dont-i-see-0s-and-1s", "title": "When I compile a program and cat on it, why don&#39;t I see 0&#39;s and 1&#39;s", "body": "<p>The question is simple: When I compile a program and cat on it, why don't I see 0's and 1's?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "is_accepted": false, "score": 1, "last_activity_date": 1540782666, "creation_date": 1540782666, "answer_id": 53038243, "question_id": 53038204, "link": "https://stackoverflow.com/questions/53038204/panic-runtime-error-index-out-of-range-1/53038243#53038243", "title": "panic: runtime error: index out of range 1", "body": "<p>You create an <code>obj</code> n, then do nothing with it until you try to append it. So there are no <code>obj</code>s in <code>myobj</code> yet.</p>\n\n<pre><code>var myobj = []*obj{}\nn := new(obj)\nn.Targets = [2]string{\"10.0.0.1\", \"10.0.0.2\"}\nn.Labels = make(map[string]string)\nn.Labels[\"job\"] = \"db2\"\nmyobj = append(myobj, n)\nk := new(obj)\nk.Targets = [2]string{\"192.168.1.12\", \"192.168.1.13\"}\nk.Labels = make(map[string]string)\nk.Labels[\"job\"] = \"mysql\"\nmyobj = append(myobj, k)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 857, "user_id": 1208081, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ca2d4ef0024cd926cc7a6218f7a4aed8?s=128&d=identicon&r=PG", "display_name": "user1208081", "link": "https://stackoverflow.com/users/1208081/user1208081"}, "is_accepted": true, "score": -2, "last_activity_date": 1540782781, "creation_date": 1540782781, "answer_id": 53038254, "question_id": 53038204, "link": "https://stackoverflow.com/questions/53038204/panic-runtime-error-index-out-of-range-1/53038254#53038254", "title": "panic: runtime error: index out of range 1", "body": "<p>finally i figure this out XD!</p>\n\n<pre><code>type obj struct {\n    Targets []string  `json:\"targets\"`\n    Labels  map[string]string `json:\"labels\"`\n}\n\nfunc main() {\n    // Creating simulation\n    var myobj = []*obj{}\n    n := new(obj)\n    n.Targets = append(n.Targets, \"10.0.0.1\")\n    n.Labels = make(map[string]string)\n    n.Labels[\"job\"] = \"db2\"\n    myobj = append(myobj, n)\n    k := new(obj)\n    k.Targets = append(k.Targets, \"192.168.1.12\")\n    k.Targets = append(k.Targets, \"192.168.1.13\")\n    k.Labels = make(map[string]string)\n    k.Labels[\"job\"] = \"mysql\"\n    myobj = append(myobj, k)\n</code></pre>\n"}], "owner": {"reputation": 857, "user_id": 1208081, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ca2d4ef0024cd926cc7a6218f7a4aed8?s=128&d=identicon&r=PG", "display_name": "user1208081", "link": "https://stackoverflow.com/users/1208081/user1208081"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 53038254, "answer_count": 2, "score": -6, "last_activity_date": 1540782781, "creation_date": 1540782211, "question_id": 53038204, "link": "https://stackoverflow.com/questions/53038204/panic-runtime-error-index-out-of-range-1", "title": "panic: runtime error: index out of range 1", "body": "<p>i can not figure out this problem ,anyone can help?                                     </p>\n\n<p>panic: runtime error: index out of range</p>\n\n<p>goroutine 1 [running]:\nmain.main()\n        /root/go/src/k8s.io/client-go/examples/in-cluster-client-configuration/test_json.go:15 +0x42</p>\n\n<pre><code>type obj struct {\n    Targets [2]string  `json:\"targets\"`\n    Labels  map[string]string `json:\"labels\"`\n}\n\nfunc main() {\n    // Creating simulation\n    var myobj = []*obj{}\n    n := new(obj)\n    myobj[0].Targets = [2]string{\"10.0.0.1\", \"10.0.0.2\"}\n    myobj[0].Labels = make(map[string]string)\n    myobj[0].Labels[\"job\"] = \"db2\"\n    myobj = append(myobj, n)\n    k := new(obj)\n    myobj[1].Targets = [2]string{\"192.168.1.12\", \"192.168.1.13\"}\n    myobj[1].Labels = make(map[string]string)\n    myobj[1].Labels[\"job\"] = \"mysql\"\n    myobj = append(myobj, k)\n\n    // Converting to JSON, for transmission over web\n    data, err := json.Marshal(myobj)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 331, "user_id": 4857969, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YHlcGGA6Vms/AAAAAAAAAAI/AAAAAAAAAUk/gnwvtrI87g8/photo.jpg?sz=128", "display_name": "Carson Hoffman", "link": "https://stackoverflow.com/users/4857969/carson-hoffman"}, "is_accepted": true, "score": 4, "last_activity_date": 1540783257, "last_edit_date": 1540783257, "creation_date": 1540781989, "answer_id": 53038177, "question_id": 53038095, "link": "https://stackoverflow.com/questions/53038095/unmarshal-returns-blank-object-due-to-encoding/53038177#53038177", "title": "Unmarshal returns blank object due to encoding", "body": "<p>Your input is not valid JSON. The <a href=\"https://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf\" rel=\"nofollow noreferrer\">JSON spec</a> states that </p>\n\n<blockquote>\n  <p>All code points may be placed within the quotation marks except for the code points that must be escaped: quotation mark (U+0022), reverse solidus (U+005C), and the control characters U+0000 to U+001F.</p>\n</blockquote>\n\n<p>Additionally, although there are two-character escape sequences, <code>\\x</code> is not one of them, and thus it is being correctly interpreted as an invalid escape sequence by the Go parser. If you want to have a backslash literal in your JSON, it needs to be represented by <code>\\\\</code> in the JSON input itself. See a modified version of your example: <a href=\"https://play.golang.org/p/JZdPJGpPR5q\" rel=\"nofollow noreferrer\">https://play.golang.org/p/JZdPJGpPR5q</a></p>\n\n<p>(note that this is not an issue with your Go string literal since you're already using a raw (<code>``</code>) string literal\u2014the JSON itself needs to have two backslashes.)</p>\n"}, {"tags": [], "owner": {"reputation": 2086, "user_id": 7695859, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o2i_xhVzt2A/AAAAAAAAAAI/AAAAAAAAAB4/DfExOz6hJ2k/photo.jpg?sz=128", "display_name": "Emruz Hossain", "link": "https://stackoverflow.com/users/7695859/emruz-hossain"}, "is_accepted": false, "score": 0, "last_activity_date": 1540824973, "creation_date": 1540824973, "answer_id": 53048149, "question_id": 53038095, "link": "https://stackoverflow.com/questions/53038095/unmarshal-returns-blank-object-due-to-encoding/53048149#53048149", "title": "Unmarshal returns blank object due to encoding", "body": "<p>You can replace <code>\\x</code> with <code>\\\\x</code> using <code>string.Replace()</code> function. Then, Unmarshal the replaced string. <a href=\"https://play.golang.org/p/bKLZhdL3oEM\" rel=\"nofollow noreferrer\">Here is a working example.</a></p>\n"}], "owner": {"reputation": 11724, "user_id": 233337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dqjJ9.jpg?s=128&g=1", "display_name": "Serg Chernata", "link": "https://stackoverflow.com/users/233337/serg-chernata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 53038177, "answer_count": 2, "score": -1, "last_activity_date": 1540824973, "creation_date": 1540781262, "question_id": 53038095, "link": "https://stackoverflow.com/questions/53038095/unmarshal-returns-blank-object-due-to-encoding", "title": "Unmarshal returns blank object due to encoding", "body": "<p>I'm attempting to unmarshal a raw <code>json</code> string. There seems to be an error with encoding but I can't quite figure it out.</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n)\n\ntype Foo struct {\n    Transmission string `json:\"transmission\"`\n    Trim         string `json:\"trim\"`\n    Uuid         string `json:\"uuid\"`\n    Vin          string `json:\"vin\"`\n}\n\nfunc main() {\n\n    var foo Foo\n\n    sample := `{\n        \"transmission\": \"continuously\\x20variable\\x20automatic\",\n        \"trim\": \"SL\",\n        \"uuid\" : \"6993e4090a0e0ae80c59a76326e360a1\",\n        \"vin\": \"5N1AZ2MH6JN192059\"\n    }`\n\n    err := json.Unmarshal([]byte(sample), &amp;foo)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(foo)\n\n}\n</code></pre>\n\n<blockquote>\n  <p>2009/11/10 23:00:00 invalid character 'x' in string escape code</p>\n</blockquote>\n\n<p>It works if transmission entry is removed.</p>\n\n<p><a href=\"https://play.golang.org/p/tFNBzjzw7kM\" rel=\"nofollow noreferrer\">Here is a working playground</a>.</p>\n"}, {"tags": ["html", "go", "datatable"], "answers": [{"tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 2, "last_activity_date": 1540780364, "creation_date": 1540780364, "answer_id": 53037988, "question_id": 53037498, "link": "https://stackoverflow.com/questions/53037498/dynamic-url-in-datatable-with-golang/53037988#53037988", "title": "Dynamic URL in DataTable with golang", "body": "<p>The standard <code>http</code> package does not allow URL variables. There are a few packages that do, for example <a href=\"https://github.com/gorilla/mux\" rel=\"nofollow noreferrer\">gorilla mux</a> is quite popular and can do that for you.</p>\n"}], "owner": {"reputation": 103, "user_id": 10280864, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AjN1aZOMjGI/AAAAAAAAAAI/AAAAAAAACYY/kURDWDY_LwU/photo.jpg?sz=128", "display_name": "victor leon", "link": "https://stackoverflow.com/users/10280864/victor-leon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1540780364, "creation_date": 1540774891, "question_id": 53037498, "link": "https://stackoverflow.com/questions/53037498/dynamic-url-in-datatable-with-golang", "title": "Dynamic URL in DataTable with golang", "body": "<p>am trying of create dynamic URL in DataTable with golang</p>\n\n<p><strong>The idea is to have some icons that remove an element from the table</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/TKCUW.png\" rel=\"nofollow noreferrer\">Screenshot of the table</a></p>\n\n<p>The columns are created in the controller by directly passing the link\nall this after consulting the BDD\nwhere the variable \"id\" concatenated in the string represents each element</p>\n\n<pre><code>cadenaS := \"&lt;a class='links' href='/history/search/\" + id + \"'&gt;&lt;i class='fas fa-search' aria-hidden='true'&gt;&lt;/i&gt;&lt;/a&gt;\"\n\ncadenaT := \"&lt;a class='links' href='/history/delete/\" + id + \"'&gt;&lt;i class='far fa-trash-alt' aria-hidden='true'&gt;&lt;/i&gt;&lt;/a&gt;\"\n\nhis = append(his, History{ID: ID, Email: Email, Search: Search, Tipo: Tipo, Visited: Visited, Icon: &amp;Icon{Search: cadenaS, Trash: cadenaT}})\n</code></pre>\n\n<p>To show it, the call is simply made with a response json</p>\n\n<pre><code>\"columns\": [\n    {\"data\": \"Icon.Search\"},\n    {\"data\": \"Search\"},\n    {\"data\": \"Visited\"},\n    {\"data\": \"Icon.Trash\"}\n],\n</code></pre>\n\n<p>the URL that will receive the request to delete the item</p>\n\n<pre><code>http.HandleFunc(\"/history/delete/{id}\", deleteHistory)\n</code></pre>\n\n<p>but never manages to make the call because the \"ID\" in the URL is not recognizing</p>\n"}, {"tags": ["go", "timezone"], "answers": [{"comments": [{"owner": {"reputation": 1728, "user_id": 1589165, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/g0kW4.jpg?s=128&g=1", "display_name": "Harshil Sharma", "link": "https://stackoverflow.com/users/1589165/harshil-sharma"}, "edited": false, "score": 0, "creation_date": 1540777931, "post_id": 53037671, "comment_id": 92975529, "body": "Ah! That&#39;s an interesting bit of information. Finally, history makes a personal impact!"}], "tags": [], "owner": {"reputation": 331, "user_id": 4857969, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YHlcGGA6Vms/AAAAAAAAAAI/AAAAAAAAAUk/gnwvtrI87g8/photo.jpg?sz=128", "display_name": "Carson Hoffman", "link": "https://stackoverflow.com/users/4857969/carson-hoffman"}, "is_accepted": true, "score": 2, "last_activity_date": 1540776916, "creation_date": 1540776916, "answer_id": 53037671, "question_id": 53037318, "link": "https://stackoverflow.com/questions/53037318/why-is-a-different-timezone-being-printed-with-parseinlocation/53037671#53037671", "title": "Why is a different timezone being printed with ParseInLocation?", "body": "<p>This may be a relic of the fact that your year for <code>now</code> is 0000, while <code>time.Now()</code> returns the current time. Timezones are weird, and certain locations haven't always used the same timezone. This is an excerpt from the <a href=\"https://www.iana.org/time-zones\" rel=\"nofollow noreferrer\">IANA Time Zone Database</a>:</p>\n\n<pre><code># Zone  NAME        GMTOFF  RULES   FORMAT  [UNTIL]\nZone    Asia/Kolkata    5:53:28 -   LMT 1854 Jun 28 # Kolkata\n        5:53:20 -   HMT 1870        # Howrah Mean Time?\n        5:21:10 -   MMT 1906 Jan  1 # Madras local time\n        5:30    -   IST 1941 Oct\n        5:30    1:00    +0630   1942 May 15\n        5:30    -   IST 1942 Sep\n        5:30    1:00    +0630   1945 Oct 15\n        5:30    -   IST\n</code></pre>\n\n<p>If I am interpreting this correctly, it seems HMT was used from 1854 until 1870\u2014I'm not exactly sure why this would cause it to be used for year 0000, which would seem to fall under LMT, but it's possible the Go database is slightly different (or it's possible that I'm misinterpreting the database). If you're concerned about the correct timezone being used for historical dates (like 0000) I'm not sure I can give a great answer, however for anything recent IST should be correctly used.</p>\n"}], "owner": {"reputation": 1728, "user_id": 1589165, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/g0kW4.jpg?s=128&g=1", "display_name": "Harshil Sharma", "link": "https://stackoverflow.com/users/1589165/harshil-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 1, "accepted_answer_id": 53037671, "answer_count": 1, "score": 2, "last_activity_date": 1540776916, "creation_date": 1540773100, "question_id": 53037318, "link": "https://stackoverflow.com/questions/53037318/why-is-a-different-timezone-being-printed-with-parseinlocation", "title": "Why is a different timezone being printed with ParseInLocation?", "body": "<p>I'm trying to parse a string into time with a user-specific timezone location -</p>\n\n<pre><code>// error handling skipped for brevity\nloc, _ := time.LoadLocation(\"Asia/Kolkata\")\nnow, _ := time.ParseInLocation(\"15:04\", \"10:10\", loc)\nfmt.Println(\"Location : \", loc, \" Time : \", now)\n</code></pre>\n\n<p>The output I get on my system is - <code>Location :  Asia/Kolkata  Time :  0000-01-01 10:10:00 +0553 HMT</code></p>\n\n<p>Where did this <code>HMT</code> time zone come from?</p>\n\n<p>If instead of parsing the time I use <code>now := time.Now().In(loc)</code>, the timezone printed is correct - <code>IST</code>. Am I doing something wrong with timezone parsng or is my system timezone database faulty?</p>\n"}, {"tags": ["dictionary", "go", "range"], "comments": [{"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 0, "creation_date": 1540779150, "post_id": 53036829, "comment_id": 92975729, "body": "An easy way to get a consistent ordering is to use <a href=\"https://golang.org/pkg/sort/\" rel=\"nofollow noreferrer\">the sort package</a>."}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1540872039, "post_id": 53036829, "comment_id": 93013411, "body": "Interesting Question, I was going to say, &quot;you should not rely on it in any language&quot;, but that would be incorrect apparently you can rely on it in Python: <a href=\"https://stackoverflow.com/a/20504062/1078084\">stackoverflow.com/a/20504062/1078084</a>"}], "answers": [{"tags": [], "owner": {"reputation": 890, "user_id": 1435116, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e8d8f792c2beb8c405080649d1e19fc?s=128&d=identicon&r=PG", "display_name": "Adeynack", "link": "https://stackoverflow.com/users/1435116/adeynack"}, "is_accepted": false, "score": 2, "last_activity_date": 1540767660, "creation_date": 1540767660, "answer_id": 53036830, "question_id": 53036829, "link": "https://stackoverflow.com/questions/53036829/does-go-iterate-map-entries-always-in-the-same-order-when-using-range/53036830#53036830", "title": "Does GO iterate map entries always in the same order when using range?", "body": "<p>The answer is: <strong>No, it does not</strong>.</p>\n\n<p>I wrote the following test to assert that.</p>\n\n<pre><code>func Test_GO_Map_Range(t *testing.T) {\n    originalMap := map[string]int {\n        \"a\": 1,\n        \"b\": 2,\n        \"c\": 3,\n        \"d\": 4,\n        \"e\": 5,\n        \"f\": 6,\n    }\n    getKeys := func(m map[string]int) []string{\n        mapKeys := make([]string, len(m))\n        i := 0\n        for n := range m {\n            mapKeys[i] = n\n            i++\n        }\n        return mapKeys\n    }\n    keys := getKeys(originalMap)\n    for i := 0; i &lt; 5; i++ {\n        assert.Equal(t, keys, getKeys(originalMap))\n    }\n}\n</code></pre>\n\n<p>I get results like:</p>\n\n<pre><code>Error:          Not equal: \n                expected: []string{\"d\", \"e\", \"f\", \"a\", \"b\", \"c\"}\n                actual  : []string{\"a\", \"b\", \"c\", \"d\", \"e\", \"f\"}\n\nError:          Not equal: \n                expected: []string{\"d\", \"e\", \"f\", \"a\", \"b\", \"c\"}\n                actual  : []string{\"f\", \"a\", \"b\", \"c\", \"d\", \"e\"}\n\nError:          Not equal: \n                expected: []string{\"d\", \"e\", \"f\", \"a\", \"b\", \"c\"}\n                actual  : []string{\"c\", \"d\", \"e\", \"f\", \"a\", \"b\"}\n\nError:          Not equal: \n                expected: []string{\"d\", \"e\", \"f\", \"a\", \"b\", \"c\"}\n                actual  : []string{\"b\", \"c\", \"d\", \"e\", \"f\", \"a\"}\n\nError:          Not equal: \n                expected: []string{\"d\", \"e\", \"f\", \"a\", \"b\", \"c\"}\n                actual  : []string{\"a\", \"b\", \"c\", \"d\", \"e\", \"f\"}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 890, "user_id": 1435116, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e8d8f792c2beb8c405080649d1e19fc?s=128&d=identicon&r=PG", "display_name": "Adeynack", "link": "https://stackoverflow.com/users/1435116/adeynack"}, "edited": false, "score": 0, "creation_date": 1540802505, "post_id": 53036842, "comment_id": 92982443, "body": "Thanks for this answer. I also came accross <a href=\"https://nathanleclaire.com/blog/2014/04/27/a-surprising-feature-of-golang-that-colored-me-impressed/\" rel=\"nofollow noreferrer\">this</a>, which stole most of its content from the article you did link."}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 7, "last_activity_date": 1540767877, "last_edit_date": 1592644375, "creation_date": 1540767877, "answer_id": 53036842, "question_id": 53036829, "link": "https://stackoverflow.com/questions/53036829/does-go-iterate-map-entries-always-in-the-same-order-when-using-range/53036842#53036842", "title": "Does GO iterate map entries always in the same order when using range?", "body": "<p>No, it is intentionally randomized (to keep programmers from relying on it, since it is not specified in the language spec).</p>\n<p>from <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"noreferrer\">the Go Blog</a></p>\n<blockquote>\n<p>Iteration order</p>\n<p>When iterating over a map with a range loop, the iteration order is not specified and is not guaranteed to be the same from one iteration to the next. Since the release of Go 1.0, the runtime has randomized map iteration order. Programmers had begun to rely on the stable iteration order of early versions of Go, which varied between implementations, leading to portability bugs.</p>\n</blockquote>\n"}], "owner": {"reputation": 890, "user_id": 1435116, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e8d8f792c2beb8c405080649d1e19fc?s=128&d=identicon&r=PG", "display_name": "Adeynack", "link": "https://stackoverflow.com/users/1435116/adeynack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "closed_date": 1540926883, "accepted_answer_id": 53036842, "answer_count": 2, "score": 0, "last_activity_date": 1540767877, "creation_date": 1540767660, "question_id": 53036829, "link": "https://stackoverflow.com/questions/53036829/does-go-iterate-map-entries-always-in-the-same-order-when-using-range", "closed_reason": "Duplicate", "title": "Does GO iterate map entries always in the same order when using range?", "body": "<p>Will this code always display the same result?\nUnderlying question: will <code>range</code> always iterate a map in the same order?</p>\n\n<pre><code>m := map[string]int {\n    \"a\": 1,\n    \"b\": 2,\n    \"c\": 3,\n    \"d\": 4,\n    \"e\": 5,\n    \"f\": 6,\n}\nfor k, v := range m {\n    fmt.Printf(\"%v = %v\", k, v)\n}\n</code></pre>\n"}, {"tags": ["go", "struct", "types", "literals"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1540761656, "post_id": 53036159, "comment_id": 92972454, "body": "1. The args value should be typed <a href=\"https://play.golang.org/p/v0HxXoM0Sf-\" rel=\"nofollow noreferrer\">play.golang.org/p/v0HxXoM0Sf-</a> 2. No"}, {"owner": {"reputation": 223, "user_id": 4612922, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YUf7c-HJsVM/AAAAAAAAAAI/AAAAAAAABx0/O6o7vBe8bW8/photo.jpg?sz=128", "display_name": "moismailzai", "link": "https://stackoverflow.com/users/4612922/moismailzai"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1540762640, "post_id": 53036159, "comment_id": 92972688, "body": "Thank you for the full example using my types. Do you have a reference for 2? If so, please add an answer so I can accept it."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1540763795, "post_id": 53036159, "comment_id": 92973024, "body": "I&#39;m not sure it&#39;s possible to refer to something that is not in the spec."}], "answers": [{"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1540762042, "post_id": 53036218, "comment_id": 92972548, "body": "This would not be assignable to <code>Rule</code>"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1540762401, "post_id": 53036218, "comment_id": 92972630, "body": "I&#39;ve left my comment <b>before</b> you provided the changed structure. My comment addresses the fact that your solution would not work for the OP&#39;s types."}, {"owner": {"reputation": 223, "user_id": 4612922, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YUf7c-HJsVM/AAAAAAAAAAI/AAAAAAAABx0/O6o7vBe8bW8/photo.jpg?sz=128", "display_name": "moismailzai", "link": "https://stackoverflow.com/users/4612922/moismailzai"}, "edited": false, "score": 1, "creation_date": 1540762771, "post_id": 53036218, "comment_id": 92972729, "body": "Thank you poy, that clarifies my first question. If you can expand with an answer for the second question (I&#39;m looking for a reference) I&#39;ll mark this as the accepted answer."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1540763605, "post_id": 53036218, "comment_id": 92972971, "body": "@zerkms Thanks for the comment. I added a note."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 223, "user_id": 4612922, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YUf7c-HJsVM/AAAAAAAAAAI/AAAAAAAABx0/O6o7vBe8bW8/photo.jpg?sz=128", "display_name": "moismailzai", "link": "https://stackoverflow.com/users/4612922/moismailzai"}, "edited": false, "score": 0, "creation_date": 1540763620, "post_id": 53036218, "comment_id": 92972978, "body": "@moismailzai I appended to the answer."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1540766324, "post_id": 53036218, "comment_id": 92973527, "body": "I added that a second part to the answer"}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 3, "last_activity_date": 1540764014, "last_edit_date": 1540764014, "creation_date": 1540761942, "answer_id": 53036218, "question_id": 53036159, "link": "https://stackoverflow.com/questions/53036159/does-go-support-nested-type-declarations-or-literal-assignments-to-anonymous-str/53036218#53036218", "title": "Does Go support nested type declarations or literal assignments to anonymous structs?", "body": "<p>Nested structs are a thing in go, but they can induce some messiness. To instantiate the given object, try this:</p>\n\n<pre><code>type Rule struct {\n    handler func() (err error)\n    creator string\n    args struct {\n        extension string\n        action string\n    }\n}\n\nrule := Rule{\n    args: struct {\n        extension string\n        action    string\n    }{\n        extension: \"png,jpg,gif,svg\",\n        action:    \"move\",\n    },\n}\n</code></pre>\n\n<p>Notice that I have the structure's argument names and types listed. Also note I removed the <code>folder</code> argument for brevity.</p>\n\n<p>If you want to do it in multiple lines:</p>\n\n<pre><code>rule2 := Rule{}\nrule2.args.action = \"some-action\"\n</code></pre>\n"}], "owner": {"reputation": 223, "user_id": 4612922, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YUf7c-HJsVM/AAAAAAAAAAI/AAAAAAAABx0/O6o7vBe8bW8/photo.jpg?sz=128", "display_name": "moismailzai", "link": "https://stackoverflow.com/users/4612922/moismailzai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 53036218, "answer_count": 1, "score": 0, "last_activity_date": 1540765691, "creation_date": 1540761368, "last_edit_date": 1540765691, "question_id": 53036159, "link": "https://stackoverflow.com/questions/53036159/does-go-support-nested-type-declarations-or-literal-assignments-to-anonymous-str", "title": "Does Go support nested type declarations or literal assignments to anonymous structs?", "body": "<p>I'm new to Go and have two questions about types. </p>\n\n<p>For example, take this code:</p>\n\n<pre><code>type Rule struct {\n    handler func() (err error)\n    creator string\n    args struct {\n        extension string\n        action string\n        folder struct {\n            location string\n            storage string\n        }\n    }\n}\n</code></pre>\n\n<p>1) How can I create a new <code>Rule</code> using a <strong>single</strong> literal declaration and assign values to the properties of <code>args</code>? What is wrong with this code:</p>\n\n<pre><code>rule := Rule{\n    args: {\n        extension: \"png,jpg,gif,svg\",\n        action: \"move\",\n    },\n}\n</code></pre>\n\n<p>2) Is it possible to define types within types? For instance, without breaking the code into two separate type declarations, could I modify the <code>args</code> portion of the <code>Rule</code> type so that it defines a second type called <code>RuleArgs</code>?</p>\n\n<p>I know that I <strong>can</strong> break these out into multiple assignments and declarations, but my question is do I have to (ie. does Go make it impossible not to)?</p>\n"}, {"tags": ["go", "types", "casting", "slice", "assertion"], "answers": [{"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1540760039, "post_id": 53035741, "comment_id": 92972112, "body": "It presumably was not a type alias then."}], "tags": [], "owner": {"reputation": 241, "user_id": 5672542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29ab50545414b03b9c669d03bb631019?s=128&d=identicon&r=PG&f=1", "display_name": "Chelovek", "link": "https://stackoverflow.com/users/5672542/chelovek"}, "is_accepted": false, "score": 0, "last_activity_date": 1540758111, "creation_date": 1540758111, "answer_id": 53035741, "question_id": 53035590, "link": "https://stackoverflow.com/questions/53035590/golang-type-assertion-failure/53035741#53035741", "title": "Golang Type Assertion Failure", "body": "<p>I have found the Reason.</p>\n\n<p>That Slice of Bytes was really of 'ByteString' Type which really was a Slice of Bytes.\nWhy the Compiler does not understand that these are equal Types I can not understand.</p>\n\n<p>I had to change the Field's Type from a Type Alias to simple '[]byte', and it now works.</p>\n"}], "owner": {"reputation": 241, "user_id": 5672542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29ab50545414b03b9c669d03bb631019?s=128&d=identicon&r=PG&f=1", "display_name": "Chelovek", "link": "https://stackoverflow.com/users/5672542/chelovek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 766, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540758111, "creation_date": 1540756966, "question_id": 53035590, "link": "https://stackoverflow.com/questions/53035590/golang-type-assertion-failure", "title": "Golang Type Assertion Failure", "body": "<p>In Golang,\nI am trying to convert an Interface to Slice of Bytes.\nDebugger clearly shows that it is a Slice of Bytes.</p>\n\n<pre><code>    // Check an Interface's Type.\n    ifcType = reflect.TypeOf(ifc).Kind()\n\n    // Array?\n    if ifcType == reflect.Slice {\n\n        // Get Type of Sub-Elements.\n        ifcElementType = reflect.TypeOf(ifc).Elem().Kind()\n        if ifcElementType == reflect.Uint8 {\n\n            // Array of Bytes.\n            // =&gt; 'bencode' Byte String.\n\n            // Convert the Type.\n            ba, ok = ifc.([]byte)\n            if !ok {\n                return nil, ErrTypeAssertion\n            }\n</code></pre>\n\n<p>When I have checked that Interface's Type is Slice and Sub-Item's Type is Uint8, I do the Type Assertion. But for some Reason, it fails. How can that be ?</p>\n\n<p>GoLand's Debugger Screenshot just after 'ok' Variable has become 'false':\n<a href=\"http://imagehost.cc/image/v4403\" rel=\"nofollow noreferrer\">http://imagehost.cc/image/v4403</a></p>\n\n<p>Thank you!</p>\n"}, {"tags": ["go", "aws-lambda", "structure", "microservices", "go-modules"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1540756560, "post_id": 53035362, "comment_id": 92971231, "body": "Pass the fully qualified import path (which starts with the module name), or <code>.&#47;lambda&#47;account_create</code> (note the leading <code>.&#47;</code>)."}, {"owner": {"reputation": 10846, "user_id": 1673776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0llsY.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/1673776/victor"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1540757754, "post_id": 53035362, "comment_id": 92971551, "body": "@Peter it does not complain anymore but there is no executable generated."}, {"owner": {"reputation": 10846, "user_id": 1673776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0llsY.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/1673776/victor"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1540761610, "post_id": 53035362, "comment_id": 92972440, "body": "Why downvote? I really am trying to find a good structure for such a project and I am sure others would be interested too."}, {"owner": {"reputation": 693, "user_id": 1802697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eH3MJ.jpg?s=128&g=1", "display_name": "Igor Maznitsa", "link": "https://stackoverflow.com/users/1802697/igor-maznitsa"}, "edited": false, "score": 0, "creation_date": 1545471149, "post_id": 53035362, "comment_id": 94635020, "body": "That&#39;s no so easy to develop multi-module projects sharing common code parts with Golang, I had some requests from users of my Maven golang wrapper tool (Maven provides great way to build multi-module applications) and I have made some example of Maven multi-module Golang project, if you want try such approach, just install Maven and build project skeleton from architype as written in <a href=\"https://github.com/raydac/mvn-golang-example\" rel=\"nofollow noreferrer\">github.com/raydac/mvn-golang-example</a>"}], "answers": [{"comments": [{"owner": {"reputation": 10846, "user_id": 1673776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0llsY.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/1673776/victor"}, "edited": false, "score": 0, "creation_date": 1540764377, "post_id": 53036492, "comment_id": 92973147, "body": "Thanks for the answer! I replied to Peter\u2019s comment on the question saying that the command is indeed returning no error however no executable seems to be created."}, {"owner": {"reputation": 10846, "user_id": 1673776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0llsY.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/1673776/victor"}, "edited": false, "score": 0, "creation_date": 1540764487, "post_id": 53036492, "comment_id": 92973174, "body": "Yes. It produces an executable without the \u201cx\u201d permission attached to it (which is the first strange thing) and if I attach that permission, it gives a strange error when run."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 10846, "user_id": 1673776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0llsY.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/1673776/victor"}, "edited": false, "score": 0, "creation_date": 1540764739, "post_id": 53036492, "comment_id": 92973233, "body": "Do you have a main function and is it in the main package?"}, {"owner": {"reputation": 10846, "user_id": 1673776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0llsY.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/1673776/victor"}, "edited": false, "score": 0, "creation_date": 1540764780, "post_id": 53036492, "comment_id": 92973236, "body": "Which main package are we referring to? The one in root or the one in <code>lambda&#47;account_create</code>?"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 10846, "user_id": 1673776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0llsY.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/1673776/victor"}, "edited": false, "score": 0, "creation_date": 1540764826, "post_id": 53036492, "comment_id": 92973247, "body": "The main.go in lambda/account_create"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 10846, "user_id": 1673776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0llsY.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/1673776/victor"}, "edited": false, "score": 0, "creation_date": 1540764986, "post_id": 53036492, "comment_id": 92973276, "body": "Change the package to main"}, {"owner": {"reputation": 10846, "user_id": 1673776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0llsY.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/1673776/victor"}, "edited": false, "score": 0, "creation_date": 1540765260, "post_id": 53036492, "comment_id": 92973324, "body": "Please add some advice for my first question regarding the structure itself if you can! Thanks!"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 10846, "user_id": 1673776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0llsY.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/1673776/victor"}, "edited": false, "score": 0, "creation_date": 1540765441, "post_id": 53036492, "comment_id": 92973351, "body": "Haha I&#39;ll throw in some opinions"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 10846, "user_id": 1673776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0llsY.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/1673776/victor"}, "edited": false, "score": 0, "creation_date": 1540765834, "post_id": 53036492, "comment_id": 92973432, "body": "I added some stuff about layout"}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 3, "last_activity_date": 1540765820, "last_edit_date": 1592644375, "creation_date": 1540764155, "answer_id": 53036492, "question_id": 53035362, "link": "https://stackoverflow.com/questions/53035362/structuring-a-multi-executable-go-project/53036492#53036492", "title": "Structuring a multi-executable Go project", "body": "<p>To answer the latter part of your question (as the first half is more about preference), you need to do:</p>\n<pre><code>go build ./lambda/account_create\n</code></pre>\n<p>Notice the <code>./</code>. <code>go build</code> takes in a package name or a path. If you don't prepend the path with a <code>./</code>, it assumes you are giving it a package name.</p>\n<p><strong>Edit</strong>: the package has to be <code>main</code> if you want an executable. According to the <a href=\"https://golang.org/doc/code.html#PackageNames\" rel=\"nofollow noreferrer\">docs</a>, you always have to use <code>package main</code> for projects that build an executable:</p>\n<blockquote>\n<p>Executable commands must always use <code>package main</code>.</p>\n</blockquote>\n<p><strong>Edit</strong>: I'll add some opinions on layout:</p>\n<p>Consider which parts of your project are exported to other go projects. Meaning someone could import your package and expect to gain value and not have their code break when yours changes.</p>\n<p>That should be either in a <code>github.com/you/pkg/somepath</code> package or just <code>github.com/you/somepath</code>.</p>\n<p>Anything else (other than main packages) should be under a <code>/internal</code> package.</p>\n<p>I typically make a <code>/cmd/myexecurable1</code>  <code>/cmd/myexecurable2</code> and so forth for each executable.</p>\n"}], "owner": {"reputation": 10846, "user_id": 1673776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0llsY.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/1673776/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1167, "favorite_count": 0, "accepted_answer_id": 53036492, "answer_count": 1, "score": 4, "last_activity_date": 1540765820, "creation_date": 1540755128, "last_edit_date": 1540764876, "question_id": 53035362, "link": "https://stackoverflow.com/questions/53035362/structuring-a-multi-executable-go-project", "title": "Structuring a multi-executable Go project", "body": "<p>I am trying to build a micro-services architecture project in Go. I am currently using Go 1.11 which supports modules, so I put my root directory in an arbitrary chosen directory, outside of <code>GOPATH</code>.</p>\n\n<p>If I am getting the micro-services architecture concepts right, although my microservices need to be independent, they can share dependencies (and I don't see another way to do stuff, is it?)</p>\n\n<p>Below is my directory structure:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 go.mod\n\u251c\u2500\u2500 lambda\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 account_create\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 main.go\n\u251c\u2500\u2500 readme.md\n\u2514\u2500\u2500 types\n    \u251c\u2500\u2500 account.go\n    \u251c\u2500\u2500 location.go\n    \u251c\u2500\u2500 order.go\n    \u251c\u2500\u2500 pricing.go\n    \u251c\u2500\u2500 product.go\n    \u2514\u2500\u2500 types.go\n</code></pre>\n\n<p>Now the behavior I expected was to be able to run <code>go build lambda/account_create</code> and get an executable with that functionality so I can supply it to the respective AWS Lambda function.</p>\n\n<p>However, when I run the command, I get:</p>\n\n<pre><code>can't load package: package lambda/account_create: unknown import path \"lambda/account_create\": cannot find module providing package lambda/account_create\n</code></pre>\n\n<p>Please explain me why this does not work and give me some advice on how a project like this should look.</p>\n\n<p>Thank you very much!</p>\n\n<p><strong>Edit</strong> Here is my <code>lambda/account_create/main.go</code> file contents:</p>\n\n<pre><code>package account_create\n\nimport (\n    \"fmt\"\n    \"roasted.ro/pkg/types\"\n)\n\nfunc main() {\n    account := types.UserAccount{Name: \"Victor\"}\n    fmt.Printf(\"Welcome %s\", account.Name)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1540753138, "post_id": 53034939, "comment_id": 92970200, "body": "The curl command indicates that the documentation is wrong when it mentions a multipart request. Try as the request body <code>strings.NewReader(&quot;grant_type=client_credentials&quot;)</code> (for anything more complicated use <a href=\"https://golang.org/pkg/net/url/#Values\" rel=\"nofollow noreferrer\">url.Values</a> though, which handles escaping properly). In any case, you are calling CreateFormField wrong: the argument is just the field name, not name and value."}, {"owner": {"reputation": 1, "user_id": 10571499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f3c8c80e35576706ebd846f4812dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Greg L", "link": "https://stackoverflow.com/users/10571499/greg-l"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1540755001, "post_id": 53034939, "comment_id": 92970741, "body": "@peter I tried that and still got the invalid request error"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1540755643, "post_id": 53034939, "comment_id": 92970933, "body": "You may have to set the Content-Type header also: <code>req.Header.Set(&quot;Content-Type&quot;, &quot;application&#47;x-www-form-urlencoded&quot;)</code>."}, {"owner": {"reputation": 1, "user_id": 10571499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f3c8c80e35576706ebd846f4812dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Greg L", "link": "https://stackoverflow.com/users/10571499/greg-l"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1540756035, "post_id": 53034939, "comment_id": 92971048, "body": "Still nothing unfortunately"}, {"owner": {"reputation": 1, "user_id": 10571499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f3c8c80e35576706ebd846f4812dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Greg L", "link": "https://stackoverflow.com/users/10571499/greg-l"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1540758463, "post_id": 53034939, "comment_id": 92971747, "body": "Never mind this worked, I had made a typo changing the code so the id was off. Thank you very much!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10571499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f3c8c80e35576706ebd846f4812dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Greg L", "link": "https://stackoverflow.com/users/10571499/greg-l"}, "edited": false, "score": 0, "creation_date": 1540754968, "post_id": 53035103, "comment_id": 92970727, "body": "Will PostForm allow me to still use the &#39;SetBasicAuth(id, secret)&#39; part or will I need to do something else? I tried the other response and added &#39;strings.NewReader(&quot;grant_type=client_credentials&quot;)&#39; as the body and it still gave me the invalid request"}], "tags": [], "owner": {"reputation": 178, "user_id": 5396095, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IDb1FSLNLzk/AAAAAAAAAAI/AAAAAAAAAC0/yy90p8_VuMM/photo.jpg?sz=128", "display_name": "Mohammad Nasirifar", "link": "https://stackoverflow.com/users/5396095/mohammad-nasirifar"}, "is_accepted": false, "score": 0, "last_activity_date": 1540753464, "creation_date": 1540753464, "answer_id": 53035103, "question_id": 53034939, "link": "https://stackoverflow.com/questions/53034939/making-post-request-in-go-with-formdata-and-authentication/53035103#53035103", "title": "Making POST request in Go with formdata and authentication", "body": "<p>From curl manual we have:</p>\n\n<pre><code>       -d, --data &lt;data&gt;\n          (HTTP)  Sends  the specified data in a POST request to the HTTP server, in the same way that a browser does when a user has filled in an HTML form and\n          presses the submit button. This will cause curl to pass the data to the server using the content-type application/x-www-form-urlencoded.   Compare  to\n          -F, --form.\n</code></pre>\n\n<p>Note the <code>content-type application/x-www-form-urlencoded</code> part.</p>\n\n<p>as opposed to:</p>\n\n<pre><code>       -F, --form &lt;name=content&gt;\n          (HTTP SMTP IMAP) For HTTP protocol family, this lets curl emulate a filled-in form in which a user has pressed the submit button. This causes curl  to\n          POST data using the Content-Type multipart/form-data according to RFC 2388.\n</code></pre>\n\n<p>Therefore based on your <code>curl</code>, <code>mime/multipart</code> is probably not what you're looking for and you should be using <a href=\"https://godoc.org/net/http#Client.PostForm\" rel=\"nofollow noreferrer\"><code>Client.PostForm</code></a>, from the manual of which we have:</p>\n\n<pre><code>The Content-Type header is set to application/x-www-form-urlencoded. To set other headers, use NewRequest and Client.Do.\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10571499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f3c8c80e35576706ebd846f4812dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Greg L", "link": "https://stackoverflow.com/users/10571499/greg-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 527, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1540753464, "creation_date": 1540752324, "question_id": 53034939, "link": "https://stackoverflow.com/questions/53034939/making-post-request-in-go-with-formdata-and-authentication", "title": "Making POST request in Go with formdata and authentication", "body": "<p>I'm currently trying to interface with an OAuth api with the example curl command <code>curl -u {client_id}:{client_secret} -d grant_type=client_credentials https://us.battle.net/oauth/token</code>. My current go file is:  </p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"mime/multipart\"\n    \"net/http\"\n)\n\nfunc checkErr(err error) bool {\n    if err != nil {\n        panic(err)\n    }\n    return true\n}\n\nfunc authcode(id string, secret string, cli http.Client) string {\n    //un(trace(\"authcode\"))\n    var form bytes.Buffer\n    w := multipart.NewWriter(&amp;form)\n    _, err := w.CreateFormField(\"grant_type=client_credentials\")\n    checkErr(err)\n    req, err := http.NewRequest(\"POST\", \"https://us.battle.net/oauth/token\", &amp;form)\n    checkErr(err)\n    req.SetBasicAuth(id, secret)\n    resp, err := cli.Do(req)\n    checkErr(err)\n    defer resp.Body.Close()\n    json := make([]byte, 1024)\n    _, err = resp.Body.Read(json)\n    checkErr(err)\n    return string(json)\n}\n\nfunc main() {\n    //un(trace(\"main\"))\n    const apiID string = \"user\"\n    const apiSecret string = \"password\"\n    apiClient := &amp;http.Client{}\n    auth := authcode(apiID, apiSecret, *apiClient)\n    fmt.Printf(\"%s\", auth)\n}\n</code></pre>\n\n<p>When I run this I get a response of <code>{\"error\":\"invalid_request\",\"error_description\":\"Missing grant type\"}</code></p>\n\n<p>For reference, the api flow states:<br>\n\"To request access tokens, an application must make a POST request with the following multipart form data to the token URI: grant_type=client_credentials</p>\n\n<p>The application must pass basic HTTP auth credentials using the client_id as the user and client_secret as the password.\"<br>\nand the expected response is a json string containing an access token, token type, expiration in seconds, and the scope of functions available with said token</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-lambda", "amazon-cognito", "serverless"], "comments": [{"owner": {"reputation": 883, "user_id": 4652445, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cbbe00d8ebe0df7c7231d58382129856?s=128&d=identicon&r=PG", "display_name": "Aabid", "link": "https://stackoverflow.com/users/4652445/aabid"}, "edited": false, "score": 0, "creation_date": 1540807501, "post_id": 53033873, "comment_id": 92985439, "body": "Instead of using code level authentication you should to use <code>Amazon API Gateway level Authentication</code>."}, {"owner": {"reputation": 153, "user_id": 10542686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A-EjroLSsEo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAhns3lDS_jtO57Lpdlfk1kFTjhZA/mo/photo.jpg?sz=128", "display_name": "Evanusso", "link": "https://stackoverflow.com/users/10542686/evanusso"}, "reply_to_user": {"reputation": 883, "user_id": 4652445, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cbbe00d8ebe0df7c7231d58382129856?s=128&d=identicon&r=PG", "display_name": "Aabid", "link": "https://stackoverflow.com/users/4652445/aabid"}, "edited": false, "score": 0, "creation_date": 1540817454, "post_id": 53033873, "comment_id": 92991140, "body": "Did you read the question? I am, cognito is responsible for authenticating, I just need inject into the context."}], "owner": {"reputation": 153, "user_id": 10542686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A-EjroLSsEo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAhns3lDS_jtO57Lpdlfk1kFTjhZA/mo/photo.jpg?sz=128", "display_name": "Evanusso", "link": "https://stackoverflow.com/users/10542686/evanusso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1540766889, "creation_date": 1540745352, "last_edit_date": 1540766889, "question_id": 53033873, "link": "https://stackoverflow.com/questions/53033873/how-to-properly-create-an-authentication-middleware-inside-an-aws-lambda", "title": "How to properly create an authentication middleware inside an AWS Lambda", "body": "<p>I'm using AWS Cognito to authenticate my users, and once authenticated, they can call my API (API Gateway + Lambda). I'm doing all that using the Serverless Framework.</p>\n\n<p>Once authenticated, when they call an endpoint that requires this authentication, my lambda will receive the user attributes through the <code>request.RequestContext.Authorizer[\"claims\"]</code>. I had the idea of creating an authentication middleware to inject the current user into the context. But I'm certain that I'm doing something wrong (or can be improved).</p>\n\n<p>How it works:</p>\n\n<p>my-lambda-handler.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n\n    \"github.com/aws/aws-lambda-go/events\"\n    \"github.com/aws/aws-lambda-go/lambda\"\n    \"github.com/company/api/middlewares\"\n)\n\nfunc Handler(ctx context.Context, request events.APIGatewayProxyRequest) (events.APIGatewayProxyResponse, error) {\n    fmt.Println(ctx.user)\n\n    return events.APIGatewayProxyResponse{}, nil\n}\n\nfunc main() {\n    lambda.Start(\n        middlewares.Authentication(Handler),\n    )\n}\n</code></pre>\n\n<p>middlewares/authentication.go</p>\n\n<pre><code>package middlewares\n\nimport (\n    \"context\"\n\n    \"github.com/aws/aws-lambda-go/events\"\n    \"github.com/company/api/models\"\n)\n\nfunc Authentication(next func(context.Context, events.APIGatewayProxyRequest) (events.APIGatewayProxyResponse, error)) func(context.Context, events.APIGatewayProxyRequest) (events.APIGatewayProxyResponse, error) {\n    var user models.User\n\n    return func(ctx context.Context, request events.APIGatewayProxyRequest) (events.APIGatewayProxyResponse, error) {\n        claims := request.RequestContext.Authorizer[\"claims\"]\n\n        // Find user by claims properties.\n        if err := user.Current(claims); err != nil {\n            return events.APIGatewayProxyResponse{}, err\n        }\n\n        ctx.user = user\n        return next(ctx, request)\n    }\n}\n</code></pre>\n\n<p>models/user.go:</p>\n\n<pre><code>package models\n\nimport (\n    \"github.com/jinzhu/gorm\"\n    \"github.com/mitchellh/mapstructure\"\n)\n\ntype User struct {\n    gorm.Model\n    // Override ID cause we are using cognito.\n    Email string `gorm:\"primary_key,not null\"`\n    Site  Site\n}\n\nfunc (u *User) Current(claims interface{}) error {\n    if err := mapstructure.Decode(claims, u); err != nil {\n        panic(err)\n    }\n\n    if err := Database.Find(u).Error; err != nil {\n        return err\n    }\n    return nil\n}\n</code></pre>\n\n<p>I have two questions:</p>\n\n<ul>\n<li>Is this the right way to define a function (Authentication function) that receives a function and returns another function? Because it's too verbose, I'm feeling this is wrong.</li>\n<li>Is there a way to augment the <code>ctx</code> with an <code>user</code> attribute? The way that I'm trying, I see the error <code>ctx.user undefined (type context.Context has no field or method user)</code></li>\n</ul>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["go", "gofmt"], "answers": [{"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1540756753, "post_id": 53033837, "comment_id": 92971289, "body": "There is also the <a href=\"https://golang.org/pkg/fmt/#Formatter\" rel=\"nofollow noreferrer\">fmt.Formatter interface</a> for more precise control."}], "tags": [], "owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "is_accepted": true, "score": 3, "last_activity_date": 1540745459, "last_edit_date": 1540745459, "creation_date": 1540745144, "answer_id": 53033837, "question_id": 53033667, "link": "https://stackoverflow.com/questions/53033667/define-string-output-for-type-in-golang/53033837#53033837", "title": "Define string output for type in Golang", "body": "<p>You need to implement the interface <a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"nofollow noreferrer\"><code>Stringer</code></a>, like this:</p>\n\n<pre><code>import \"fmt\"\n\ntype Point struct {\n    x int\n    y int\n}\n\nfunc (p Point) String() string {\n    return fmt.Sprintf(\"(%d, %d)\", p.x, p.y)\n}\n\nfunc main() {\n    fmt.Println(Point{1, 2})\n}\n</code></pre>\n\n<p>(<a href=\"https://play.golang.org/p/RLFmfjfYxLz\" rel=\"nofollow noreferrer\">Go Playground</a>)</p>\n\n<p>In Go you don't specify which interfaces a type implements, you just implements the required methods.</p>\n"}], "owner": {"reputation": 6456, "user_id": 728236, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SOeHR.jpg?s=128&g=1", "display_name": "Brian Leishman", "link": "https://stackoverflow.com/users/728236/brian-leishman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 53033837, "answer_count": 1, "score": 1, "last_activity_date": 1540745459, "creation_date": 1540744157, "question_id": 53033667, "link": "https://stackoverflow.com/questions/53033667/define-string-output-for-type-in-golang", "title": "Define string output for type in Golang", "body": "<p>I'm wondering if there's a way through <code>fmt</code> to specify the way a string would get outputted for specific types. For example, I have a <code>token</code> struct that contains a bunch of information on the token, like token type (which is an int, but for clarity reasons, it would make more sense if I could output the name of the token type as a string). </p>\n\n<p>So when I print a specific type of variable, is there a straightforward way to specify/implement the string output of such a type?</p>\n\n<p>If that doesn't really make sense, Rust has an excellent form of doing so (from their doc)</p>\n\n<pre><code>use std::fmt;\n\nstruct Point {\n    x: i32,\n    y: i32,\n}\n\nimpl fmt::Display for Point {\n    fn fmt(&amp;self, f: &amp;mut fmt::Formatter) -&gt; fmt::Result {\n        write!(f, \"({}, {})\", self.x, self.y)\n    }\n}\n\nlet origin = Point { x: 0, y: 0 };\n\nprintln!(\"The origin is: {}\", origin); // prints \"The origin is: (0, 0)\"\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1540751747, "post_id": 53033362, "comment_id": 92969747, "body": "Symbols from imported packages must be used slack.InteractionCallback."}], "answers": [{"comments": [{"owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "edited": false, "score": 0, "creation_date": 1540744148, "post_id": 53033414, "comment_id": 92967468, "body": "I prefixed it with slack, and added the import.  I get the same error <code>undefined: slack.InteractionCallback</code>"}, {"owner": {"reputation": 750, "user_id": 2947756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qpCxL.png?s=128&g=1", "display_name": "xReprisal", "link": "https://stackoverflow.com/users/2947756/xreprisal"}, "reply_to_user": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "edited": false, "score": 0, "creation_date": 1540748085, "post_id": 53033414, "comment_id": 92968568, "body": "Could you post self contained piece of code where you get this error?"}], "tags": [], "owner": {"reputation": 750, "user_id": 2947756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qpCxL.png?s=128&g=1", "display_name": "xReprisal", "link": "https://stackoverflow.com/users/2947756/xreprisal"}, "is_accepted": false, "score": 0, "last_activity_date": 1540742447, "creation_date": 1540742447, "answer_id": 53033414, "question_id": 53033362, "link": "https://stackoverflow.com/questions/53033362/the-type-interactioncallback-is-not-being-found-and-atom-is-removing-the-import/53033414#53033414", "title": "The type InteractionCallback is not being found, and atom is removing the import statement", "body": "<p>You need to specify from which package <code>InteractionCallback</code> comes from, in your case its slack package - <code>slack.InteractionCallback</code></p>\n"}, {"comments": [{"owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "edited": false, "score": 0, "creation_date": 1540752146, "post_id": 53034409, "comment_id": 92969882, "body": "strange, I used dep ensure -add to add the library to my vendor folder.  When I look in the vendor folder my dialog.go is missing code like this line <a href=\"https://github.com/nlopes/slack/blob/master/dialog.go#L52\" rel=\"nofollow noreferrer\">github.com/nlopes/slack/blob/master/dialog.go#L52</a>"}, {"owner": {"reputation": 750, "user_id": 2947756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qpCxL.png?s=128&g=1", "display_name": "xReprisal", "link": "https://stackoverflow.com/users/2947756/xreprisal"}, "edited": false, "score": 0, "creation_date": 1540760681, "post_id": 53034409, "comment_id": 92972249, "body": "dep by default pulls latest release of repository, not the master branch. <a href=\"https://github.com/nlopes/slack/blob/v0.4.0/dialog.go\" rel=\"nofollow noreferrer\">github.com/nlopes/slack/blob/v0.4.0/dialog.go</a>"}], "tags": [], "owner": {"reputation": 348, "user_id": 6321206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7rEQ.jpg?s=128&g=1", "display_name": "Andrii Soluk", "link": "https://stackoverflow.com/users/6321206/andrii-soluk"}, "is_accepted": true, "score": 1, "last_activity_date": 1540748614, "creation_date": 1540748614, "answer_id": 53034409, "question_id": 53033362, "link": "https://stackoverflow.com/questions/53033362/the-type-interactioncallback-is-not-being-found-and-atom-is-removing-the-import/53034409#53034409", "title": "The type InteractionCallback is not being found, and atom is removing the import statement", "body": "<p>Please use this command in your terminal:\n    go get -u github.com/nlopes/slack</p>\n\n<p>After that try to run this code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"github.com/nlopes/slack\"\n)\n\nfunc unmarshalSuggestionCallback(j string) (*slack.InteractionCallback, error) {\n    callback := &amp;slack.InteractionCallback{}\n    if err := json.Unmarshal([]byte(j), &amp;callback); err != nil {\n        return nil, err\n    }\n    return callback, nil\n}\n\nfunc main() {\n    callback,_:=unmarshalSuggestionCallback(`{\"type\":\"callback\"}`)\n    fmt.Println(callback.Type)\n}\n</code></pre>\n\n<p>Everything should work fine, I have checked in my PC</p>\n"}], "owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 53034409, "answer_count": 2, "score": -1, "last_activity_date": 1540748614, "creation_date": 1540742139, "question_id": 53033362, "link": "https://stackoverflow.com/questions/53033362/the-type-interactioncallback-is-not-being-found-and-atom-is-removing-the-import", "title": "The type InteractionCallback is not being found, and atom is removing the import statement", "body": "<p>I am using the atom IDE, and for some reason whenever I add this to my imports:</p>\n\n<p>\"github.com/nlopes/slack\"</p>\n\n<p>And save the file, it removes the import.  So I'm not sure why but it isn't finding the InteractionCallback type in the library?</p>\n\n<p>I copied this code from the <a href=\"https://github.com/nlopes/slack/blob/8608e3c203889d74f3e98e41028145c4fdcfc8ea/dialog_test.go#L246\" rel=\"nofollow noreferrer\">example</a>:</p>\n\n<pre><code>func unmarshalSuggestionCallback(j string) (*InteractionCallback, error) {\n    callback := &amp;InteractionCallback{}\n    if err := json.Unmarshal([]byte(j), &amp;callback); err != nil {\n        return nil, err\n    }\n    return callback, nil\n}\n</code></pre>\n\n<p>I am getting this error:</p>\n\n<blockquote>\n  <p>undefined: InteractionCallback</p>\n</blockquote>\n\n<p>How can I tell if my library I just downloaded has the type defined?  Or am I referencing the type incorrectly?</p>\n"}, {"tags": ["variables", "go", "interface", "switch-statement"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1540738860, "post_id": 53032820, "comment_id": 92965957, "body": "Use <code>io.Reader</code> and don&#39;t do short variable declaration inside the cases. Please read more about interfaces and take the Tour of Go (once more)."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1540739397, "post_id": 53032820, "comment_id": 92966098, "body": "You can set it to an empty interface"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1540739571, "post_id": 53032820, "comment_id": 92966144, "body": "the line that errors isn&#39;t required.  See this Tour of Go example for how to do it <a href=\"https://tour.golang.org/methods/16\" rel=\"nofollow noreferrer\">tour.golang.org/methods/16</a>"}, {"owner": {"reputation": 31, "user_id": 10570838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7d9cfbb9441572bd76081a1f470e720?s=128&d=identicon&r=PG&f=1", "display_name": "AT_Def", "link": "https://stackoverflow.com/users/10570838/at-def"}, "edited": false, "score": 0, "creation_date": 1540739879, "post_id": 53032820, "comment_id": 92966226, "body": "Hi Vorsprung.i need requestData variable for my http.NewRequest, if I remove this variable, there is no way to do it. Other than copying entire request into each switch case. Hi poy, I did that before, but then it does not work with the http.Request &quot;request, err := http.NewRequest(&quot;POST&quot;, website, requestData.())&quot;"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1540742311, "post_id": 53032820, "comment_id": 92966911, "body": "<a href=\"https://play.golang.org/p/F4zxG9owZ-J\" rel=\"nofollow noreferrer\">play.golang.org/p/F4zxG9owZ-J</a>"}, {"owner": {"reputation": 31, "user_id": 10570838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7d9cfbb9441572bd76081a1f470e720?s=128&d=identicon&r=PG&f=1", "display_name": "AT_Def", "link": "https://stackoverflow.com/users/10570838/at-def"}, "edited": false, "score": 0, "creation_date": 1540744829, "post_id": 53032820, "comment_id": 92967656, "body": "Thank you mkopriva that helps a lot!!"}], "answers": [{"tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": false, "score": 0, "last_activity_date": 1540742404, "creation_date": 1540742404, "answer_id": 53033404, "question_id": 53032820, "link": "https://stackoverflow.com/questions/53032820/change-variable-type-based-on-switch-statement/53033404#53033404", "title": "Change variable type based on switch statement", "body": "<p>get the typed data into the switch</p>\n\n<pre><code>typedData:=switch data.(type) {\n</code></pre>\n\n<p>then use that to convert for instance</p>\n\n<pre><code>case []byte: // JSON\n        requestData := bytes.NewBuffer(typedData) // *Buffer type\n</code></pre>\n\n<p>Although @mkopriva 's playground example looks like a better idea</p>\n"}], "owner": {"reputation": 31, "user_id": 10570838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7d9cfbb9441572bd76081a1f470e720?s=128&d=identicon&r=PG&f=1", "display_name": "AT_Def", "link": "https://stackoverflow.com/users/10570838/at-def"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1409, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1540744537, "creation_date": 1540738510, "last_edit_date": 1540744537, "question_id": 53032820, "link": "https://stackoverflow.com/questions/53032820/change-variable-type-based-on-switch-statement", "title": "Change variable type based on switch statement", "body": "<p>I am in the process of creating a POST HTTP request function in Go that will accept different data types through parameter but I am stuck when assigning value from switch statement to requestData variable.</p>\n\n<p>Ideally, the requestData would be of nil type until we go to switch statement and then assign value and type to it. Any help appreciated :)</p>\n\n<p>Error message on requestData:\n\"syntax error: unexpected type, expecting type\"</p>\n\n<p>My code:</p>\n\n<pre><code>main() {\n    ..\n\n    // CASE 1: we are passing the form of url.Values type\n    form := url.Values{}\n    form.Add(\"note\", \"john2424\")\n    form.Add(\"http\", \"clear\")\n\n    response := POST(\"www.google.co.uk\", client, form) // first POST request\n\n\n\n    // CASE 2: we are passing the JSON data using []byte type\n    jsonData := []byte(`{\"ids\":[12345]}`)\n    response := POST(\"www.google.co.uk\", client, jsonData) // second POST request\n}\n\nfunc POST(website string, client *http.Client, data interface{}) (bodyString string) {\n    var requestData type // &lt;&lt;&lt;&lt;&lt;&lt;&lt; Change requestData to a variable from switch case \n\n    switch data.(type) { // switch case based on type \n    case url.Values: // URL form data\n        formattedData := data.(url.Values) // convert interface to url.Values\n        requestData := strings.NewReader(formattedData.Encode()) // *Reader type\n    case []byte: // JSON\n        formattedData := data.([]byte) // convert interface to []byte\n        requestData := bytes.NewBuffer(formattedData) // *Buffer type\n    default: // anything else\n\n    }\n\n    request, err := http.NewRequest(\"POST\", website, requestData)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n\n    response, err := client.Do(request)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    defer response.Body.Close()\n    body, err := ioutil.ReadAll(response.Body)\n    if err != nil {\n        log.Fatal(err)\n    } else {\n        bodyString = string(body)\n    }\n\n    return\n}\n</code></pre>\n"}, {"tags": ["bash", "go", "operating-system", "goroutine"], "comments": [{"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 2, "creation_date": 1540734267, "post_id": 53032089, "comment_id": 92964704, "body": "a process cannot catch a sigkill, thus it cannot &quot;forward&quot; the signal to its chidren. You script will probably remain alive (unless a side effect has it to die like broken pipe or else..)"}], "answers": [{"tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 1, "last_activity_date": 1540738417, "creation_date": 1540738417, "answer_id": 53032789, "question_id": 53032089, "link": "https://stackoverflow.com/questions/53032089/will-a-bash-script-continue-execution-even-if-the-go-routine-it-is-defined-withi/53032789#53032789", "title": "Will a bash-script continue execution even if the go-routine it is defined within is killed?", "body": "<p>A process has a <a href=\"https://golang.org/pkg/os/#Process.Kill\" rel=\"nofollow noreferrer\">Kill()</a> method that needs to be invoked to stop the script. So by killing the parent process, you'll be leaking the child processes.</p>\n"}], "owner": {"reputation": 366, "user_id": 8215209, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mUcp9x419TE/AAAAAAAAAAI/AAAAAAAAAAA/x_oltuemiFo/photo.jpg?sz=128", "display_name": "achilles", "link": "https://stackoverflow.com/users/8215209/achilles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1540738417, "creation_date": 1540733703, "question_id": 53032089, "link": "https://stackoverflow.com/questions/53032089/will-a-bash-script-continue-execution-even-if-the-go-routine-it-is-defined-withi", "title": "Will a bash-script continue execution even if the go-routine it is defined within is killed?", "body": "<p>I am running a Go application which has multiple Go routines . In one of the go-routines we are executing a bash script using the os.exec command which on one particular condition will kill the main thread of the application using SIGKILL (kill -9) and respawn the application once more . My doubt is whether the bash script will resume its operations once the goroutine is killed or will it also be stopped.</p>\n"}]