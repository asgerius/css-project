[{"tags": ["docker", "go", "amazon-rds", "aurora"], "comments": [{"owner": {"reputation": 25905, "user_id": 313421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ipQVy.jpg?s=128&g=1", "display_name": "Xaqron", "link": "https://stackoverflow.com/users/313421/xaqron"}, "edited": false, "score": 0, "creation_date": 1531958724, "post_id": 51412435, "comment_id": 89796702, "body": "That&#39;s a DNS error and domain cannot be resolved to IP address."}, {"owner": {"reputation": 37, "user_id": 4364069, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/44a15ae61bc2f2630f2c49592ebda7c1?s=128&d=identicon&r=PG&f=1", "display_name": "GeekyCoder", "link": "https://stackoverflow.com/users/4364069/geekycoder"}, "reply_to_user": {"reputation": 25905, "user_id": 313421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ipQVy.jpg?s=128&g=1", "display_name": "Xaqron", "link": "https://stackoverflow.com/users/313421/xaqron"}, "edited": false, "score": 0, "creation_date": 1531958888, "post_id": 51412435, "comment_id": 89796743, "body": "@Xaqron is that a proxy issue? or do I need to append http://"}, {"owner": {"reputation": 25905, "user_id": 313421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ipQVy.jpg?s=128&g=1", "display_name": "Xaqron", "link": "https://stackoverflow.com/users/313421/xaqron"}, "edited": false, "score": 0, "creation_date": 1531960827, "post_id": 51412435, "comment_id": 89797164, "body": "Probably a proxy issue. Depends on 1) if your proxy resides in AWS and 2) your app forwards DNS queries to the proxy. BTW that domain resolves to a private IP which is valid only inside AWS network but you are using Google DNS server to resolve it and it fails."}], "owner": {"reputation": 37, "user_id": 4364069, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/44a15ae61bc2f2630f2c49592ebda7c1?s=128&d=identicon&r=PG&f=1", "display_name": "GeekyCoder", "link": "https://stackoverflow.com/users/4364069/geekycoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 511, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571658834, "creation_date": 1531957760, "last_edit_date": 1532249950, "question_id": 51412435, "link": "https://stackoverflow.com/questions/51412435/unable-to-connect-to-aurora-mysql-from-docker-container-but-works-using-command", "title": "unable to connect to aurora mysql from docker container but works using command line", "body": "<p>am trying to do this from an ec2 instance, trying to connect to aws rds aurora mysql. The following command lets me connect to the  rds:\nmysql -h cluster.cluster-c3dpvouhxmjg.us-east-1.rds.amazonaws.com --port 3306 -u root -p</p>\n\n<p>I have written a golang application and containerized it using docker here:\nDockerfile:</p>\n\n<pre><code>FROM artifactory.cloud.com/research/golang:1.10-alpine3.7\n\nRUN mkdir -p /go/src/github.com/perfGo/\nWORKDIR /go/src/github.com/perfGo\nCOPY ./ $WORKDIR\nRUN apk update &amp;&amp; apk upgrade\nRUN go build\n\nRUN chmod +x ./entrypoint.sh\nRUN ls\nRUN chmod +x ./perfGo\nEXPOSE 3306\n#I set the proxies here\n\nENTRYPOINT [\"./entrypoint.sh\"]\n</code></pre>\n\n<p>entrypoint.sh</p>\n\n<pre><code>#!/usr/bin/env bash\n./perfGo\n</code></pre>\n\n<p>perf.go</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n _ \"github.com/go-sql-driver/mysql\"\n)\n\nfunc main() {\n    db, err := sql.Open(\"mysql\", \"root:fdsffdsfs@tcp(cluster.cluster-c3dpvouhxmjg.us-east-1.rds.amazonaws.com:3306)/testdb\")\n    checkErr(err)\n    _,dbErr := db.Exec(\"USE testdb\")\n    if err != nil {\n        panic(dbErr)\n    }\n\n    // insert\n    _, inErr := db.Query(\"INSERT INTO books VALUES('tttt','dsfdsfs','fdsfasaf','55')\")\n\n    defer db.Close()\n    // if there is an error inserting, handle it\n    if inErr != nil {\n        panic(inErr.Error())\n    }\n\n}\n\nfunc checkErr(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>The command I use to run the contianer is </p>\n\n<pre><code>docker run -p 3306:3306 -ti 23b3c5c510b4\n</code></pre>\n\n<p>The error I see is :\npanic: dial tcp: lookup cluster.cluster-c3dpvouhxmjg.us-east-1.rds.amazonaws.com on 8.8.4.4:53: read udp 172.17.0.2:52640->8.8.4.4:53: i/o timeout\nCan someone pls help me out on this. This totally works on container on my mac using mysql on localhost</p>\n"}, {"tags": ["mysql", "docker", "go"], "comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1531954334, "post_id": 51411724, "comment_id": 89795651, "body": "<code>localhost</code> is a technical term, and it&#39;s probably less confusing to say something like &quot;running on my desktop&quot; than &quot;running on my localhost&quot;...particularly since from the point of view of the container the server <i>isn&#39;t</i> running on <code>localhost</code>."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4364069, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/44a15ae61bc2f2630f2c49592ebda7c1?s=128&d=identicon&r=PG&f=1", "display_name": "GeekyCoder", "link": "https://stackoverflow.com/users/4364069/geekycoder"}, "edited": false, "score": 0, "creation_date": 1531953179, "post_id": 51411820, "comment_id": 89795336, "body": "My goodness, that worked, one last step, what would that be if am running the app container on ubuntu based EC2 trying to connect to a database cluster Ip on 3306 , something like databaseclusterIP:3306"}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 1, "creation_date": 1531954278, "post_id": 51411820, "comment_id": 89795636, "body": "It would be the exact same configuration as if you were running it not in a container and the database was on a different host."}, {"owner": {"reputation": 37, "user_id": 4364069, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/44a15ae61bc2f2630f2c49592ebda7c1?s=128&d=identicon&r=PG&f=1", "display_name": "GeekyCoder", "link": "https://stackoverflow.com/users/4364069/geekycoder"}, "reply_to_user": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1531954492, "post_id": 51411820, "comment_id": 89795685, "body": "@DavidMaze I have the database host to be something like this cluster-c3dpvouhxmjg.us-east-1.rds.amazonaws.com. Now I see error as :  panic: dial tcp: lookup cluster-c3dpvouhxmjg.us-east-1.rds.amazonaws.com on 8.8.4.4:53: read udp 172.17.0.2:50209-&gt;8.8.4.4:53: i/o timeout"}], "tags": [], "owner": {"reputation": 2756, "user_id": 1375316, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/62627013dd03b525ba5954cff57b0f9b?s=128&d=identicon&r=PG", "display_name": "threeve", "link": "https://stackoverflow.com/users/1375316/threeve"}, "is_accepted": true, "score": 1, "last_activity_date": 1531952724, "creation_date": 1531952724, "answer_id": 51411820, "question_id": 51411724, "link": "https://stackoverflow.com/questions/51411724/unable-to-connect-to-mysql-running-on-my-mac/51411820#51411820", "title": "unable to connect to mysql running on my mac", "body": "<p>If the application is running in a container, and the database is on the host, then the address of the database from the container is obviously not <code>localhost</code> (That is the loopback device of the container).</p>\n\n<p>If you are  using Docker For Mac, then you can use:</p>\n\n<p><code>\"docker.for.mac.localhost:3306\"</code> in place of <code>\"localhost:3306\"</code></p>\n"}], "owner": {"reputation": 37, "user_id": 4364069, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/44a15ae61bc2f2630f2c49592ebda7c1?s=128&d=identicon&r=PG&f=1", "display_name": "GeekyCoder", "link": "https://stackoverflow.com/users/4364069/geekycoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 51411820, "answer_count": 1, "score": 1, "last_activity_date": 1531952724, "creation_date": 1531952042, "last_edit_date": 1592644375, "question_id": 51411724, "link": "https://stackoverflow.com/questions/51411724/unable-to-connect-to-mysql-running-on-my-mac", "title": "unable to connect to mysql running on my mac", "body": "<p>I am using golang app , wrapped up in a docker container to connect to mysql db running on my localhost(not container). Her eis what I tried:\nDocker File</p>\n<pre><code>FROM artifactory.cloud.com//golang:1.10-alpine3.7\n\nRUN mkdir -p /go/src/github.kdc.mafsafdfsacys.com/perfGo/\nWORKDIR /go/src/github.kdc.mafsafdfsacys.com/perfGo\nCOPY ./ $WORKDIR\nRUN apk update &amp;&amp; apk upgrade\nRUN go build\n\nRUN chmod +x ./entrypoint.sh\nRUN ls\nRUN chmod +x ./perfGo\nENTRYPOINT [&quot;./entrypoint.sh&quot;]\n</code></pre>\n<p>perfGo.go</p>\n<pre><code>package main\n\nimport (\n    &quot;database/sql&quot;\n    _ &quot;github.com/go-sql-driver/mysql&quot;\n)\n\nfunc main() {\n    db, err := sql.Open(&quot;mysql&quot;, &quot;root:@tcp(localhost:3306)/testdb&quot;)\n    checkErr(err)\n    _,dbErr := db.Exec(&quot;USE testdb&quot;)\n    if err != nil {\n        panic(dbErr)\n    }\n\n    // insert\n    _, inErr := db.Query(&quot;INSERT INTO books VALUES('rewyrewryewwrewyt','dsfdsfs','fdsfasaf','55')&quot;)\n\n    defer db.Close()\n    // if there is an error inserting, handle it\n    if inErr != nil {\n        panic(inErr.Error())\n    }\n\n}\n\nfunc checkErr(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n<p>entrypoint.sh</p>\n<h1>!/usr/bin/env bash</h1>\n<p>./perfGo</p>\n<p>Command am using to build is</p>\n<pre><code>docker build .\n</code></pre>\n<p>command used to run the container:\ndocker run -p 3306:3306 -ti </p>\n<p>The error that I see is</p>\n<pre><code>panic: dial tcp 127.0.0.1:3306: connect: connection refused\n\ngoroutine 1 [running]:\nmain.main()\n    /go/src/github.kdc.capitalone.com/midnight-tokens/perfGo/perf.go:22 +0x1d4\n</code></pre>\n<p>If I run the binary without the container, it runs totally fine on my mac, but when I try to run it as part of docker container, it fails to connect</p>\n"}, {"tags": ["docker", "go", "dockerfile"], "comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 1, "creation_date": 1531952322, "post_id": 51411655, "comment_id": 89795140, "body": "When you run <code>docker build</code>, are you in the <code>project</code> directory, and is the <code>Dockerfile</code> there too?  Does adding <code>RUN ls</code> to the <code>Dockerfile</code> after the <code>COPY</code> give any helpful suggestions?"}, {"owner": {"reputation": 405, "user_id": 4062625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-Qsrh1RHLGX8/AAAAAAAAAAI/AAAAAAAAAGw/dCVzh6lGlLA/photo.jpg?sz=128", "display_name": "Coco Bennett", "link": "https://stackoverflow.com/users/4062625/coco-bennett"}, "reply_to_user": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1531957462, "post_id": 51411655, "comment_id": 89796443, "body": "Yes I&#39;m in the project main which besides main.go, it does make the Dockerfile and Makefile as well as package1/, package2/, and that reflects in ls"}, {"owner": {"reputation": 1292, "user_id": 1479093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d7a14cd513e892a7cac9ebef7dd9165?s=128&d=identicon&r=PG", "display_name": "Jayachandran", "link": "https://stackoverflow.com/users/1479093/jayachandran"}, "edited": false, "score": 0, "creation_date": 1531965710, "post_id": 51411655, "comment_id": 89798106, "body": "Does the import in main.go specifies the path like this: import github.company.com/project-repo/project/package1?"}, {"owner": {"reputation": 405, "user_id": 4062625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-Qsrh1RHLGX8/AAAAAAAAAAI/AAAAAAAAAGw/dCVzh6lGlLA/photo.jpg?sz=128", "display_name": "Coco Bennett", "link": "https://stackoverflow.com/users/4062625/coco-bennett"}, "edited": false, "score": 0, "creation_date": 1531965955, "post_id": 51411655, "comment_id": 89798157, "body": "Yes yes it does! Does that help you?"}, {"owner": {"reputation": 405, "user_id": 4062625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-Qsrh1RHLGX8/AAAAAAAAAAI/AAAAAAAAAGw/dCVzh6lGlLA/photo.jpg?sz=128", "display_name": "Coco Bennett", "link": "https://stackoverflow.com/users/4062625/coco-bennett"}, "edited": false, "score": 0, "creation_date": 1531966017, "post_id": 51411655, "comment_id": 89798171, "body": "I&#39;ve tried /go/src/github.company.com/project-repo/project/package1. Maybe I need to drop the /go/src?"}, {"owner": {"reputation": 1292, "user_id": 1479093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d7a14cd513e892a7cac9ebef7dd9165?s=128&d=identicon&r=PG", "display_name": "Jayachandran", "link": "https://stackoverflow.com/users/1479093/jayachandran"}, "edited": false, "score": 0, "creation_date": 1531971520, "post_id": 51411655, "comment_id": 89799310, "body": "yes, it should be import github.company.com/project-repo/project/package1"}, {"owner": {"reputation": 1292, "user_id": 1479093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d7a14cd513e892a7cac9ebef7dd9165?s=128&d=identicon&r=PG", "display_name": "Jayachandran", "link": "https://stackoverflow.com/users/1479093/jayachandran"}, "edited": false, "score": 0, "creation_date": 1531971824, "post_id": 51411655, "comment_id": 89799384, "body": "Also could you add a &#39;RUN ls -al&#39; after &#39;RUN go get&#39; and provide the results here?"}, {"owner": {"reputation": 405, "user_id": 4062625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-Qsrh1RHLGX8/AAAAAAAAAAI/AAAAAAAAAGw/dCVzh6lGlLA/photo.jpg?sz=128", "display_name": "Coco Bennett", "link": "https://stackoverflow.com/users/4062625/coco-bennett"}, "reply_to_user": {"reputation": 1292, "user_id": 1479093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d7a14cd513e892a7cac9ebef7dd9165?s=128&d=identicon&r=PG", "display_name": "Jayachandran", "link": "https://stackoverflow.com/users/1479093/jayachandran"}, "edited": false, "score": 0, "creation_date": 1532007006, "post_id": 51411655, "comment_id": 89818884, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/176337/discussion-between-coco-bennett-and-jayachandran\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 536, "user_id": 3956589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39365ac79e46dc67ace5d93a627a068d?s=128&d=identicon&r=PG&f=1", "display_name": "whitespace", "link": "https://stackoverflow.com/users/3956589/whitespace"}, "is_accepted": false, "score": -1, "last_activity_date": 1531972889, "creation_date": 1531972889, "answer_id": 51414153, "question_id": 51411655, "link": "https://stackoverflow.com/questions/51411655/go-install-cant-find-my-internal-packages-in-dockerfile/51414153#51414153", "title": "Go install can&#39;t find my internal packages in Dockerfile", "body": "<p>did you make(<code>mkdir</code>) the <code>WORKDIR</code> before setting its value? </p>\n"}, {"tags": [], "owner": {"reputation": 405, "user_id": 4062625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-Qsrh1RHLGX8/AAAAAAAAAAI/AAAAAAAAAGw/dCVzh6lGlLA/photo.jpg?sz=128", "display_name": "Coco Bennett", "link": "https://stackoverflow.com/users/4062625/coco-bennett"}, "is_accepted": false, "score": 2, "last_activity_date": 1532024502, "creation_date": 1532024502, "answer_id": 51429478, "question_id": 51411655, "link": "https://stackoverflow.com/questions/51411655/go-install-cant-find-my-internal-packages-in-dockerfile/51429478#51429478", "title": "Go install can&#39;t find my internal packages in Dockerfile", "body": "<p>Wow, golang really is picky about paths! It was just that I had assigned my working directory to the wrong place. There was another file in the tree:</p>\n\n<pre><code>WORKDIR /go/src/github.company.com/COMPANY/project-repo/project\n</code></pre>\n"}], "owner": {"reputation": 405, "user_id": 4062625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-Qsrh1RHLGX8/AAAAAAAAAAI/AAAAAAAAAGw/dCVzh6lGlLA/photo.jpg?sz=128", "display_name": "Coco Bennett", "link": "https://stackoverflow.com/users/4062625/coco-bennett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1368, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1532024502, "creation_date": 1531951621, "question_id": 51411655, "link": "https://stackoverflow.com/questions/51411655/go-install-cant-find-my-internal-packages-in-dockerfile", "title": "Go install can&#39;t find my internal packages in Dockerfile", "body": "<p>So I'm trying to Dockerize my project which looks like this:</p>\n\n<pre><code>project/\n  main.go\n  package1/\n  package2/\n  package3/\n</code></pre>\n\n<p>And it also requires some outside packages such as github.com/gorilla/mux\nNote my project is internal on a github.company.com domain so I'm not sure if that matters.\nSo here's my Dockerfile and yes, my GOPATH and GOROOT is set and PLEASE don't just tell me to read <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">https://golang.org/doc/code.html</a>. I have and am still am having this issue.</p>\n\n<pre><code>### STAGE 1: Build ###\n\nFROM golang:1.10 as builder\nWORKDIR /go/src/github.company.com/project-repo/project\nCOPY . .\nRUN go get \nRUN go install &lt;- ERROR HERE\nRUN CGO_ENABLED=0 go build -ldflags=\"-s -w\" -o executable -a -installsuffix cgo .\n\n### STAGE 2: Setup ###\n\nFROM python:3.6-alpine\nCOPY --from=builder /go/src/github.company.com/project-repo/project/executable /api/executable\nCMD [\"/api/executable\"]\n</code></pre>\n\n<p>Then I run:</p>\n\n<pre><code>docker build -t myapp .\n</code></pre>\n\n<p>And get this error:</p>\n\n<pre><code>main.go: cannot find package github.company.com/project-repo/project/package1 in any of:\n/usr/local/go/src/github.company.com/project-repo/project/package1 (from $GOROOT)\n/go/src/github.company.com/project-repo/project/package1 (from $GOPATH)\n</code></pre>\n\n<p>And keep in mind those paths are correct. Why can't go install packages that are within itself?? Main.go imports package1, but for sure reason \"go install\" doesn't install packages inside itself..</p>\n"}, {"tags": ["go", "goland"], "answers": [{"tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 11, "last_activity_date": 1531949318, "creation_date": 1531949318, "answer_id": 51411233, "question_id": 51410979, "link": "https://stackoverflow.com/questions/51410979/how-to-stop-goland-from-auto-removal-of-unused-imports/51411233#51411233", "title": "How to stop GoLand from auto removal of unused imports?", "body": "<p>This feature is used so that you do not receive compilation errors for unused imports from Go.</p>\n\n<p>While you can deactivate the feature via \"Settings (Preferences) | Go | Imports | Optimize imports on the fly\", my recommendation is to leave this as is and instead let the IDE manage the imports for you.</p>\n\n<p>For example, you can start typing \"template.New\" inside the \"main\" function and the IDE will ask which \"template\" package to import as there are two packages in the standard library \"text/template\" and \"html/template\". When only one package is available, that will be imported automatically. When you will remove the last reference to the \"template\" package, the IDE will remove the import automatically, thus allowing you to run the code without any compilation issues.</p>\n"}], "owner": {"reputation": 133, "user_id": 9972257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e74f95420aa9c7491a6c8f5de79bfe2?s=128&d=identicon&r=PG&f=1", "display_name": "nombreinvicto", "link": "https://stackoverflow.com/users/9972257/nombreinvicto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4400, "favorite_count": 2, "accepted_answer_id": 51411233, "answer_count": 1, "score": 7, "last_activity_date": 1611097276, "creation_date": 1531947952, "last_edit_date": 1593142193, "question_id": 51410979, "link": "https://stackoverflow.com/questions/51410979/how-to-stop-goland-from-auto-removal-of-unused-imports", "title": "How to stop GoLand from auto removal of unused imports?", "body": "<p>I am working with JetBrains GoLand and wondering if it's possible to somehow disable the auto removal of unused imports. I have searched the JetBrains forums earlier and there is no such information specifically for Goland.</p>\n<p><a href=\"https://i.stack.imgur.com/6mRII.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6mRII.gif\" alt=\"This picture shows the problem.\" /></a></p>\n"}, {"tags": ["postgresql", "docker", "go"], "comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1531954586, "post_id": 51410806, "comment_id": 89795720, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31249112/allow-docker-container-to-connect-to-a-local-host-postgres-database\">Allow docker container to connect to a local/host postgres database</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1185, "user_id": 6907941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15451877a4ff142541b59b1d68212451?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas Bergner", "link": "https://stackoverflow.com/users/6907941/jonas-bergner"}, "edited": false, "score": 0, "creation_date": 1531948264, "post_id": 51410922, "comment_id": 89793554, "body": "Your third solution worked like a charm. Thank you so much!"}], "tags": [], "owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "is_accepted": true, "score": 8, "last_activity_date": 1531947718, "creation_date": 1531947718, "answer_id": 51410922, "question_id": 51410806, "link": "https://stackoverflow.com/questions/51410806/unable-to-connect-containerized-app-to-containerized-postgres-receiving-dial-tc/51410922#51410922", "title": "Unable to connect containerized app to containerized postgres, receiving dial tcp connection refused error", "body": "<p>You are using <code>localhost</code> address within the container which is not the same as your host's address. You should do one of the following instead:</p>\n\n<ul>\n<li>Use your <strong>actual</strong> host's IP from app's container</li>\n<li>Use <code>postgresdb</code> container's IP with <strong>the native port (5432)</strong>. You can discover this IP using <code>docker inspect postgresdb</code>.</li>\n<li>Use <code>postgresdb</code> as host name and the native port (5432) when connecting both containers to the same network </li>\n</ul>\n"}], "owner": {"reputation": 1185, "user_id": 6907941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15451877a4ff142541b59b1d68212451?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas Bergner", "link": "https://stackoverflow.com/users/6907941/jonas-bergner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2816, "favorite_count": 1, "accepted_answer_id": 51410922, "answer_count": 1, "score": 2, "last_activity_date": 1531991976, "creation_date": 1531947147, "last_edit_date": 1531991976, "question_id": 51410806, "link": "https://stackoverflow.com/questions/51410806/unable-to-connect-containerized-app-to-containerized-postgres-receiving-dial-tc", "title": "Unable to connect containerized app to containerized postgres, receiving dial tcp connection refused error", "body": "<p>This community is my last resort for this problem, as I have been fighting with this for several hours now.</p>\n\n<p>I have a go app running in one container, in the other container I am running a postgres db. I am able to connect to the postgres db from my go application as long as <strong>only</strong> my postgres is within a container, and my go app is running locally as usual. However, when my go app is trying to access the postgres from within a docker container i am getting the following <strong>error</strong>:</p>\n\n<pre><code>dial tcp 127.0.0.1:8080: connect: connection refused \n</code></pre>\n\n<p>Below I try to provide enough information, but will gladly add more if requested.</p>\n\n<hr>\n\n<p>I have 2 docker containers running with the following <strong>ports</strong>:</p>\n\n<ul>\n<li>go application, port info: 8081/tcp -> 0.0.0.0:8081</li>\n<li>postgres db, port info: 5432/tcp -> 0.0.0.0:8080</li>\n</ul>\n\n<hr>\n\n<p>I am <strong>running</strong> the go app with:</p>\n\n<pre><code>docker run -it --rm --name gographqlserver --link postgresdb:postgres -d -p 8081:8081 gogogopher;\n</code></pre>\n\n<p>and the postgres db with:</p>\n\n<pre><code>docker run -it --rm --name postgresdb -e POSTGRES_PASSWORD=hello123 -d -p 8080:5432 postgresimage;\n</code></pre>\n\n<p>both containers can be started without any problems.</p>\n\n<hr>\n\n<p>I have also tried <strong>connecting</strong> both containers within a <code>docker network</code>, which did not help.</p>\n\n<hr>\n\n<p>help would be immensely appreciated!</p>\n"}, {"tags": ["arrays", "go", "fileinfo"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531944631, "post_id": 51410182, "comment_id": 89791908, "body": "What is the error?"}, {"owner": {"reputation": 870, "user_id": 4522501, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/929253393772654/picture?type=large", "display_name": "Javier Salas", "link": "https://stackoverflow.com/users/4522501/javier-salas"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531944711, "post_id": 51410182, "comment_id": 89791937, "body": "Adrian, this is the error: &quot;cannot use file (type string) as type os.FileInfo in append&quot;"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1531944791, "post_id": 51410182, "comment_id": 89791987, "body": "That seems pretty clear. You&#39;re trying to append <code>file</code> (the path to the file, a <code>string</code>, as the error says) to a <code>[]os.FileInfo</code>, which only takes elements of type <code>os.FileInfo</code>. You probably meant to append your <code>fileInfo</code> variable to the slice, rather than your <code>file</code> variable."}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1531944863, "post_id": 51410182, "comment_id": 89792029, "body": "fileList = append(fileList, fileInfo)"}, {"owner": {"reputation": 870, "user_id": 4522501, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/929253393772654/picture?type=large", "display_name": "Javier Salas", "link": "https://stackoverflow.com/users/4522501/javier-salas"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1531944940, "post_id": 51410182, "comment_id": 89792058, "body": "You&#39;re right @Uvelichitel! i tried that and it worked."}], "answers": [{"tags": [], "owner": {"reputation": 3592, "user_id": 6276385, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89c7b071a5c25c2f6ccc6f1f41bdb2e3?s=128&d=identicon&r=PG&f=1", "display_name": "gonutz", "link": "https://stackoverflow.com/users/6276385/gonutz"}, "is_accepted": true, "score": 1, "last_activity_date": 1532290350, "last_edit_date": 1532290350, "creation_date": 1532244621, "answer_id": 51462957, "question_id": 51410182, "link": "https://stackoverflow.com/questions/51410182/how-to-append-items-to-os-fileinfo-in-golang/51462957#51462957", "title": "how to append items to []os.FileInfo in GoLang", "body": "<p>You try to append a string to an array of os.FileInfo. That is a type error.</p>\n\n<p>Here is a version of your code that does what you want and looks more Go-like, with shorter variable names, unnamed return types (their types perfectly decribe what they do) and using <code>var</code> to create an empty slice.</p>\n\n<pre><code>func GetFilesRecursively(root string) ([]os.FileInfo, error) {\n    var files []os.FileInfo\n\n    // walk all directories but only collect files\n    err := filepath.Walk(root, func(path string, f os.FileInfo, err error) error {\n        if !f.IsDir() {\n            files = append(files, f)\n        }\n        return nil\n    })\n\n    return files, err\n}\n</code></pre>\n"}], "owner": {"reputation": 870, "user_id": 4522501, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/929253393772654/picture?type=large", "display_name": "Javier Salas", "link": "https://stackoverflow.com/users/4522501/javier-salas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1457, "favorite_count": 0, "accepted_answer_id": 51462957, "answer_count": 1, "score": -1, "last_activity_date": 1532290350, "creation_date": 1531944305, "last_edit_date": 1531944840, "question_id": 51410182, "link": "https://stackoverflow.com/questions/51410182/how-to-append-items-to-os-fileinfo-in-golang", "title": "how to append items to []os.FileInfo in GoLang", "body": "<p>I'm making a function like ioutil.ReadDir() but recursively due I want all the files in folders and subfolders and ioutil.ReadDir() just do it in the specified folder but I don't know how to append items to an array of []os.FileInfo that I've created.</p>\n\n<p>This is what I have:</p>\n\n<pre><code>func GetFilesRecursively(searchDirectory string) (foundFileList []os.FileInfo, errorGenerated error){\n\n   fileList := []os.FileInfo{}\n   allFilesAndFolders := []string{}\n\n   //Get all the files and directories\n   err := filepath.Walk(searchDirectory, func(path string, f os.FileInfo, err error) error {\n       allFilesAndFolders = append(allFilesAndFolders, path)\n       return nil\n   })\n\n   // Remove directories due those are also added into the array and we don't need them\n   for _, file := range allFilesAndFolders{\n\n       fileInfo, _ := os.Stat(file)\n\n       if (!fileInfo.Mode().IsDir()){\n          fileList = append(fileList, file) //error here!!\n       }\n   }\n\n   return fileList, err\n}\n</code></pre>\n\n<p>The error is in the comments in the code snippet above</p>\n\n<p>How could I do that?</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 12973, "user_id": 894067, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7503014a9e8a710b63b3f76d64d6d3e3?s=128&d=identicon&r=PG", "display_name": "Charlie Fish", "link": "https://stackoverflow.com/users/894067/charlie-fish"}, "edited": false, "score": 3, "creation_date": 1531937719, "post_id": 51408511, "comment_id": 89788297, "body": "What is it showing in the AWS console?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1531939710, "post_id": 51408511, "comment_id": 89789454, "body": "Triple-check the bucket name is the same on the upload &amp; download."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 12973, "user_id": 894067, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7503014a9e8a710b63b3f76d64d6d3e3?s=128&d=identicon&r=PG", "display_name": "Charlie Fish", "link": "https://stackoverflow.com/users/894067/charlie-fish"}, "edited": false, "score": 0, "creation_date": 1531975176, "post_id": 51408511, "comment_id": 89800111, "body": "@CharlieFish I cannot access AWS console. I just have access keys that I am using with sdk"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531975289, "post_id": 51408511, "comment_id": 89800138, "body": "@Adrian I have triple checked the bucket. I thinks there is a policy that is applied to bucket to upload not more than a bucket count. But I am not sure if this is the problem because the api response shown successfully uploaded bucket"}, {"owner": {"reputation": 12973, "user_id": 894067, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7503014a9e8a710b63b3f76d64d6d3e3?s=128&d=identicon&r=PG", "display_name": "Charlie Fish", "link": "https://stackoverflow.com/users/894067/charlie-fish"}, "edited": false, "score": 1, "creation_date": 1531977712, "post_id": 51408511, "comment_id": 89800880, "body": "@Himanshu I think it\u2019d throw an error. But are you sure you have permissions to upload AND get files? Sometimes those permissions can be strange and produce unexpected results if you don\u2019t have them setup correctly."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 12973, "user_id": 894067, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7503014a9e8a710b63b3f76d64d6d3e3?s=128&d=identicon&r=PG", "display_name": "Charlie Fish", "link": "https://stackoverflow.com/users/894067/charlie-fish"}, "edited": false, "score": 1, "creation_date": 1531979735, "post_id": 51408511, "comment_id": 89801610, "body": "@CharlieFish yes I have listed the objects before uploading a new object and then listed objects again but did not see any changes"}, {"owner": {"reputation": 12973, "user_id": 894067, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7503014a9e8a710b63b3f76d64d6d3e3?s=128&d=identicon&r=PG", "display_name": "Charlie Fish", "link": "https://stackoverflow.com/users/894067/charlie-fish"}, "edited": false, "score": 0, "creation_date": 1531980038, "post_id": 51408511, "comment_id": 89801723, "body": "@Himanshu Honestly at this point it\u2019s blind guesses. If there are no errors and you see other objects getting returned but not the one you uploaded we are blind to the issue. You haven\u2019t really provided enough detail to be able to help us solve your problem. Sadly I don\u2019t know what other information you can provide. I mean if I was in your position I would just rely on the standard debugging techniques and maybe consider reaching out to AWS support"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 12973, "user_id": 894067, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7503014a9e8a710b63b3f76d64d6d3e3?s=128&d=identicon&r=PG", "display_name": "Charlie Fish", "link": "https://stackoverflow.com/users/894067/charlie-fish"}, "edited": false, "score": 0, "creation_date": 1531980305, "post_id": 51408511, "comment_id": 89801850, "body": "@CharlieFish let me check it once again if i could get more information to recreate the issue. Well thanks for your time."}, {"owner": {"reputation": 118, "user_id": 3960617, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000491850862/picture?type=large", "display_name": "Steve Doolan", "link": "https://stackoverflow.com/users/3960617/steve-doolan"}, "edited": false, "score": 0, "creation_date": 1615043015, "post_id": 51408511, "comment_id": 117571975, "body": "I had something similar where I had files being uploaded (in my case from signed URLs) and returning 204 success responses but not showing up in the bucket.   It turns out <b>I had a forward slash at the start of the object key</b>, and instead of parsing it like a file system (ie start at root) it created an entire duplicate folder structure in a folder in the root called <code>&#47;</code>, and put my files there."}], "answers": [{"comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533740950, "post_id": 51749150, "comment_id": 90459883, "body": "It was some kind of permission issue because when I tried to upload the file in another bucket it returns with information of uploaded file including the location on aws s3. And when I try to list the objects inside that bucket it shows the updated list with new file."}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533793219, "post_id": 51749150, "comment_id": 90478177, "body": "but surely if you had a permission error the upload script would have thrown an error?"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533795401, "post_id": 51749150, "comment_id": 90479044, "body": "I don&#39;t know why I didn&#39;t get an error while uploading the file. But now my problem is solved by using another bucket."}, {"owner": {"reputation": 1700, "user_id": 627806, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c6022ce776b5415ea90bddd94355fffa?s=128&d=identicon&r=PG", "display_name": "Jon Burgess", "link": "https://stackoverflow.com/users/627806/jon-burgess"}, "edited": false, "score": 0, "creation_date": 1568787149, "post_id": 51749150, "comment_id": 102380365, "body": "What is a reasonable time for consistency to be achieved? I guess it&#39;s some sort of statistical distribution strictly speaking, so there&#39;s no simple answer. I am seeing objects not there 10-15s after they&#39;re written, what are the chances of that happening (because of this)?"}], "tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": true, "score": 12, "last_activity_date": 1533738336, "creation_date": 1533738336, "answer_id": 51749150, "question_id": 51408511, "link": "https://stackoverflow.com/questions/51408511/aws-s3-uploaded-files-not-showing/51749150#51749150", "title": "AWS S3 uploaded files not showing", "body": "<p>s3 is eventually consistent and may not show an object that has been recently written in a list, even from within the same zone:</p>\n\n<blockquote>\n  <p>Amazon S3 achieves high availability by replicating data across\n  multiple servers within Amazon's data centers. If a PUT request is\n  successful, your data is safely stored. However, information about the\n  changes must replicate across Amazon S3, which can take some time, and\n  so you might observe the following behaviors:</p>\n  \n  <p>A process writes a new object to Amazon S3 and immediately lists keys\n  within its bucket. Until the change is fully propagated, the object\n  might not appear in the list.</p>\n  \n  <p>A process replaces an existing object and immediately attempts to read\n  it. Until the change is fully propagated, Amazon S3 might return the\n  prior data.</p>\n  \n  <p>A process deletes an existing object and immediately attempts to read\n  it. Until the deletion is fully propagated, Amazon S3 might return the\n  deleted data.</p>\n  \n  <p>A process deletes an existing object and immediately lists keys within\n  its bucket. Until the deletion is fully propagated, Amazon S3 might\n  list the deleted object.</p>\n</blockquote>\n\n<p>see <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/Introduction.html\" rel=\"noreferrer\">S3 developer guide</a></p>\n\n<p>There is a polling Go AWS API call \"func (*S3) WaitUntilObjectExists\" which keeps looking for a file until it appears or a time out happens</p>\n"}], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10766, "favorite_count": 0, "accepted_answer_id": 51749150, "answer_count": 1, "score": 4, "last_activity_date": 1572890669, "creation_date": 1531937596, "question_id": 51408511, "link": "https://stackoverflow.com/questions/51408511/aws-s3-uploaded-files-not-showing", "title": "AWS S3 uploaded files not showing", "body": "<p>I am using golang sdk to upload files to a bucket on amazon S3.The response gives no error and the file is uploaded successfully. My problem is when I am listing the objects of the bucket in the same region in which I have uploaded a new <code>.jpg</code> file. I am getting same files list with no new file added to the Bucket. I don't know what I am doing wrong. This is the code that I am using to list objects inside the bucket.</p>\n\n<pre><code>input := &amp;s3.ListObjectsInput{\n    Bucket: aws.String(\"Bucket Name\"),\n}\nresult2, err := svc.ListObjects(input)\nif err != nil {\n    if aerr, ok := err.(awserr.Error); ok {\n        switch aerr.Code() {\n        case s3.ErrCodeNoSuchBucket:\n            fmt.Println(s3.ErrCodeNoSuchBucket, aerr.Error())\n        default:\n            fmt.Println(aerr.Error())\n        }\n    } else {\n        // Print the error, cast err to awserr.Error to get the Code and\n        // Message from an error.\n        fmt.Println(err.Error())\n    }\n    return\n}\nlog.Println(\"Bucket List\", result2)\n</code></pre>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1531936058, "post_id": 51408034, "comment_id": 89787462, "body": "This is sql error which database you are using when inserting data."}], "owner": {"reputation": 11, "user_id": 10101168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f58b22dec9cd3f36ce1c65adc44b14?s=128&d=identicon&r=PG&f=1", "display_name": "J Stefano", "link": "https://stackoverflow.com/users/10101168/j-stefano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1531940190, "creation_date": 1531935619, "last_edit_date": 1531940190, "question_id": 51408034, "link": "https://stackoverflow.com/questions/51408034/error-01-error-1062-duplicate-entry-enquiry-564-for-key-type-entity-id", "title": "Error #01: Error 1062: Duplicate entry &#39;enquiry-564&#39; for key &#39;type_entity_id&#39;", "body": "<p>I have error in golang application developed with gin framework, i losed 1 day, but i dont understend where i wrong, because enquiry-564 is not duplicate. this is the curent error :</p>\n\n<pre><code>{[{\"body\": {\"text\": \"\"}, \"enquiryID\": 564, \"meta\": {\"message\": {\"enquiry_offer\": {\"delivery_time\": 1, \"revision_count\": 3, \"_service_title\": \"c c sharp cpp java vb work\", \"price\": 1100, \"expired_on\": \"2018-07-21T17:02:29Z\", \"id\": 82, \"_service_id\": \"lBdHu0\"}}}, \"userID\": 1, \"type\": \"enquiry_offer\"}]}[GIN] 2018/07/18 - 17:02:28 | 500 |    1.597772ms | 2a01:7e01:0:0:f03c:91ff:fe3e:826a | POST     /api/private/message/enquiry\n</code></pre>\n\n<blockquote>\n  <p>Error #01: Error 1062: Duplicate entry 'enquiry-564' for key\n  'type_entity_id'</p>\n</blockquote>\n\n<pre><code>[GIN] 2018/07/18 - 17:02:28 | 500 |    1.659839ms | 2a01:7e01:0:0:f03c:91ff:fe3e:826a | POST     /api/private/message/enquiry\nError #01: Error 1062: Duplicate entry 'enquiry-564' for key 'type_entity_id'\n</code></pre>\n\n<p>this is the received json data :</p>\n\n<pre><code>{\n  [\n    {\n      \"body\": {\n        \"text\": \"\"\n      },\n      \"enquiryID\": 564,\n      \"meta\": {\n        \"message\": {\n          \"enquiry_offer\": {\n            \"delivery_time\": 1,\n            \"revision_count\": 3,\n            \"_service_title\": \"c c sharp cpp java vb work\",\n            \"price\": 1100,\n            \"expired_on\": \"2018-07-21T17:02:29Z\",\n            \"id\": 82,\n            \"_service_id\": \"lBdHu0\"\n          }\n        }\n      },\n      \"userID\": 1,\n      \"type\": \"enquiry_offer\"\n    }\n  ]\n}\n</code></pre>\n\n<p>this is the complete function code :</p>\n\n<pre><code>func (p *PrivateRouter) postMessageEnquiry(c *gin.Context) {\n    logRequestBody(c)\n    type Message struct {\n        EnquiryId int64   `json:\"enquiryID\" binding:\"required\"`\n        UserID    int64   `json:\"userID\"`\n        Type      string  `json:\"type\" binding:\"required\"`\n        Users     []int64 `json:\"users\" binding:\"required\"`\n        Body      struct {\n                            Text string `json:\"text\" binding:\"required\"`\n                        } `json:\"body\" binding:\"required\"`\n        Meta struct {\n            Room    interface{} `json:\"room\"`\n            Message interface{} `json:\"message\"`\n        } `json:\"meta\"`\n    }\n\n    type MessagesRequest []*Message\n\n    // this function need for debug\n    fmt.Printf(\"%s\", c.Request.Body)\n\n    /// read either one entity or array of entities from JSON request\n    isArr, err := requestIsJsonArray(c)\n    if err != nil {\n        responseInternalError(c, err)\n        return\n    }\n\n    var messages MessagesRequest\n    if isArr {\n        err = c.Bind(&amp;messages)\n        if err != nil {\n            return\n        }\n    } else {\n        messages = make(MessagesRequest, 0)\n        var message Message\n        err = c.Bind(&amp;message)\n        if err != nil {\n            return\n        }\n        messages = append(messages, &amp;message)\n    }\n    ///\n\n    for _, message := range messages {\n        room, err := p.roomRepo.FindOneWithUsers(model.RoomTypeEnquiry, message.EnquiryId, message.Users)\n        if err != nil {\n            responseInternalError(c, err)\n            return\n        }\n\n        if room == nil {\n            roomMetaJson, err := json.Marshal(message.Meta.Room)\n            if err != nil {\n                responseInternalError(c, err)\n                return\n            }\n\n            room, err = p.roomRepo.AddEnquiryRoom(message.EnquiryId, roomMetaJson, message.Users)\n            if err != nil {\n                responseInternalError(c, err)\n                return\n            }\n        }\n\n        roomStringId := model.GenerateRoomStringId(model.RoomTypeEnquiry, message.EnquiryId)\n        if message.Type == \"\" {\n            message.Type = \"message\"\n        }\n        err = p.createMessage(room.Id, roomStringId, message.Type, message.Meta.Message, message.Body.Text, message.UserID)\n        if err != nil {\n            responseInternalError(c, err)\n            return\n        }\n    }\n\n    sendOkResponse(c)\n}\n</code></pre>\n\n<p>can anyone tell me where I'm wrong?</p>\n\n<p>sql function for store in database</p>\n\n<pre><code>func (rep *MessagesRepository) Add(roomId int64, messageType string, metaJson []byte, message string, senderId int64) (*Message, error) {\n\n        var err error\n        var res sql.Result\n\n        cols := []string{\"room_id\", \"type\", \"message\"}\n        args := []interface{}{roomId, messageType, message}\n\n        if string(metaJson) != \"null\" {\n            cols = append(cols, \"meta_json\")\n            args = append(args, metaJson)\n        }\n        if senderId &gt; 0 {\n            cols = append(cols, \"user_id\")\n            args = append(args, senderId)\n        }\n\n        q := `INSERT INTO messages (` + strings.Join(cols, \", \") + `) VALUES (?` + strings.Repeat(\", ?\", len(cols)-1) + `)`\n        res, err = rep.db.Exec(q, args...)\n        if err == nil {\n            messageId, err := res.LastInsertId()\n            if err == nil {\n                return rep.FindByPk(messageId)\n            }\n        }\n        return nil, err\n    }\n</code></pre>\n"}, {"tags": ["linux", "go"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 8371222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7260680a42d0df879dc21584b5e09e41?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh k", "link": "https://stackoverflow.com/users/8371222/vignesh-k"}, "edited": false, "score": 0, "creation_date": 1532095577, "post_id": 51406963, "comment_id": 89858690, "body": "Thanks for your answer @JimB. It worked and I am now able build the package."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 8, "last_activity_date": 1531931518, "creation_date": 1531931518, "answer_id": 51406963, "question_id": 51406672, "link": "https://stackoverflow.com/questions/51406672/not-able-to-find-executable-binary-file-after-go-build-command/51406963#51406963", "title": "not able to find executable/binary file after &quot;go build&quot; command", "body": "<p>You're building a package that isn't <code>main</code>, so there is no executable to create. Setting the <code>-o</code> flag forces <code>build</code> to output the object file that would otherwise be discarded, but that is not an executable. Go object files start with the string <code>!&lt;arch&gt;\\n</code>, which is why you receive that error when you attempt to execute it.</p>\n\n<p>Change your package name to <code>main</code>. </p>\n"}], "owner": {"reputation": 79, "user_id": 8371222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7260680a42d0df879dc21584b5e09e41?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh k", "link": "https://stackoverflow.com/users/8371222/vignesh-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1229, "favorite_count": 0, "accepted_answer_id": 51406963, "answer_count": 1, "score": 2, "last_activity_date": 1531931518, "creation_date": 1531930476, "question_id": 51406672, "link": "https://stackoverflow.com/questions/51406672/not-able-to-find-executable-binary-file-after-go-build-command", "title": "not able to find executable/binary file after &quot;go build&quot; command", "body": "<p>I am new to golang and I have a single package go file \"hello_world.go\" which I am compiling via \"go build hello_world.go\".\nAfter this I expect to see executable \"hello_world\". But I donot see it.</p>\n\n<p>I tried options -x and -v with \"go build \" and below is the output</p>\n\n<pre><code>go build -x -v hello_world.go\nWORK=/tmp/go-build697702511\ncommand-line-arguments\nmkdir -p $WORK/command-line-arguments/_obj/\nmkdir -p $WORK/\ncd /home/vignesh/exercism/go/hello-world\n/usr/local/go/pkg/tool/linux_amd64/compile -o $WORK/command-line- arguments.a -trimpath $WORK -goversion go1.9.2 -p command-line-arguments -complete -buildid 1d40767f999b0c5cb646b061911455ddde0101d2 -D _/home/vignesh/exercism/go/hello-world -I $WORK -pack ./hello_world.go\n</code></pre>\n\n<p>below  is the  content  of  my working directory after above two \"go build\" operations</p>\n\n<pre><code>-rw------- 1 vignesh vignesh  208 Jul 17 20:50 .solution.json\n-rw-rw-r-- 1 vignesh vignesh 1451 Jul 17 20:50 README.md\n-rw-rw-r-- 1 vignesh vignesh 1311 Jul 17 20:50 hello_test.go_bkp\ndrwxr-xr-x 4 vignesh vignesh 4096 Jul 18 18:27 ..\n-rw-rw-r-- 1 vignesh vignesh 1311 Jul 18 20:27 hello_test.go\n-rw-rw-r-- 1 vignesh vignesh  684 Jul 18 20:29 hello_world.go\ndrwxr-xr-x 2 vignesh vignesh 4096 Jul 18 20:57 .\n</code></pre>\n\n<p>I then tried \"go build -o aaa hello_world.go\" which generated binary file \"aaa\", which on execution gave following errors:</p>\n\n<pre><code>./aaa: line 1: syntax error near unexpected token `newline'\n./aaa: line 1: `!&lt;arch&gt;'\n</code></pre>\n\n<p>below is the output of  \"go  env \"</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/vignesh/exercism/go\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\"\nGCCGO=\"gccgo\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build845978294=/tmp/go-build -gno-record-gcc-switches\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\nPKG_CONFIG=\"pkg-config\"\n</code></pre>\n\n<p>Kindly help me with a fix or any sugestions to debug this issue.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["json", "go", "environment-variables"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1531929720, "post_id": 51406335, "comment_id": 89783961, "body": "That is not valid JSON. You would need to use some kind of  preprocessor."}, {"owner": {"reputation": 1086, "user_id": 1589069, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9f809239a5dad2e72ba6a0e53a714712?s=128&d=identicon&r=PG&f=1", "display_name": "aec", "link": "https://stackoverflow.com/users/1589069/aec"}, "edited": false, "score": 0, "creation_date": 1531995857, "post_id": 51406335, "comment_id": 89811272, "body": "is this possibly for reading a config file?"}], "answers": [{"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1531931730, "post_id": 51406865, "comment_id": 89785176, "body": "text/template is certainly a viable option, but your solution is still missing support for environment variables. You should update the code to show how <a href=\"https://golang.org/pkg/text/template/#Template.Funcs\" rel=\"nofollow noreferrer\">Template.Funcs</a> can be used to make os.Getenv available in the template."}, {"owner": {"reputation": 104, "user_id": 10070765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G9ZAN.png?s=128&g=1", "display_name": "Zanicar", "link": "https://stackoverflow.com/users/10070765/zanicar"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1531946505, "post_id": 51406865, "comment_id": 89792768, "body": "Added my suggestion for dealing with arbitrary environment variables..."}, {"owner": {"reputation": 410, "user_id": 5568862, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9c6994d7fdaf8f77fa5e18a822793029?s=128&d=identicon&r=PG&f=1", "display_name": "Sourav", "link": "https://stackoverflow.com/users/5568862/sourav"}, "edited": false, "score": 0, "creation_date": 1531997870, "post_id": 51406865, "comment_id": 89812631, "body": "@Zanicar -- The solution looks pretty good. Thanks. However, do you think this would be a feasible or less complicated solution if we are dealing with large JSON objects?"}, {"owner": {"reputation": 104, "user_id": 10070765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G9ZAN.png?s=128&g=1", "display_name": "Zanicar", "link": "https://stackoverflow.com/users/10070765/zanicar"}, "reply_to_user": {"reputation": 410, "user_id": 5568862, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9c6994d7fdaf8f77fa5e18a822793029?s=128&d=identicon&r=PG&f=1", "display_name": "Sourav", "link": "https://stackoverflow.com/users/5568862/sourav"}, "edited": false, "score": 0, "creation_date": 1532017254, "post_id": 51406865, "comment_id": 89826335, "body": "@Sourav for complex structures you will probably be better off defining types that compose into large JSON objects. You will have to implement the JSON Marshaler and Unmarshaler interfaces. If you use a composite design pattern then you just call json.Marshal on the type and its subtypes to generate your large JSON structures. You will also be able to include some more refined sanity checking and validation."}], "tags": [], "owner": {"reputation": 104, "user_id": 10070765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G9ZAN.png?s=128&g=1", "display_name": "Zanicar", "link": "https://stackoverflow.com/users/10070765/zanicar"}, "is_accepted": false, "score": 2, "last_activity_date": 1531946440, "last_edit_date": 1531946440, "creation_date": 1531931152, "answer_id": 51406865, "question_id": 51406335, "link": "https://stackoverflow.com/questions/51406335/how-to-read-environment-variables-in-json-file-using-golang/51406865#51406865", "title": "How to read environment variables in JSON file using golang?", "body": "<p>Yes, you should be able to achieve this by using text/template <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/text/template/</a></p>\n\n<p>You will then be able to define json template files, for example:</p>\n\n<pre><code>// JSON file: user.tpl.json\n{\n    \"username\": \"{{ .Username }}\",\n    \"password\": \"{{ .PasswordHash }}\",\n    \"email\": \"{{ Email }}\",\n}\n</code></pre>\n\n<p>Let's assume the following data structure:</p>\n\n<pre><code>type User struct {\n    Username string\n    Password []byte // use a properly hashed password (bcrypt / scrypt)\n    Email string\n}\n</code></pre>\n\n<p>To utilize the template:</p>\n\n<pre><code>// parse the template\ntpl, err := template.ParseFiles(\"user.tpl.json\")\nif err != nil {\n    log.Fatal(err)\n}\n\n// define some data for the template, you have 2 options here:\n// 1. define a struct with exported fields,\n// 2. use a map with keys corresponding to the template variables\nu := User {\n    Username: \"ThereIsNoSpoon\",\n    Password: pwdHash, // obtain proper hash using bcrypt / scrypt\n    Email: nospoon@me.com,\n}\n\n// execute the template with the given data\nvar ts bytes.Buffer\nerr = tpl.Execute(&amp;ts, u)  // Execute will fill the buffer so pass as reference\nif err != nil {\n    log.Fatal(err)\n}\n\nfmt.Printf(\"User JSON:\\n%v\\n\", ts.String())\n</code></pre>\n\n<p>The code above should produce the following output:</p>\n\n<pre><code>User JSON:\n{\n    \"username\": \"ThereIsNoSpoon\",\n    \"Password\": \"$2a$10$SNCKzLpj/AqBJSjVEF315eAwbsAM7nZ0e27poEhjhj9rHG3LkZzxS\",\n    \"Email\": \"nospoon@me.com\"\n}\n</code></pre>\n\n<p>Your template variable names must correspond to the exported values of the data struct you pass to Execute. The example password hash is 10 rounds of bcrypt on the string \"BadPassword123\". Using the bytes. Buffer allows for flexible use such as passing over the network, writing to file, or displaying to console using the String() function.</p>\n\n<p>For environment variables I would recommend the second approach, namely the golang map:</p>\n\n<pre><code>// declare a map that will serve as the data structure between environment\n// variables and the template\ndmap := make(map[string]string)\n\n// insert environment variables into the map using a key relevant to the\n// template\ndmap[\"Username\"] = os.GetEnv(\"USER\")\n// ...\n\n// execute template by passing the map instead of the struct\n</code></pre>\n"}], "owner": {"reputation": 410, "user_id": 5568862, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9c6994d7fdaf8f77fa5e18a822793029?s=128&d=identicon&r=PG&f=1", "display_name": "Sourav", "link": "https://stackoverflow.com/users/5568862/sourav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2117, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531991625, "creation_date": 1531929323, "last_edit_date": 1531991625, "question_id": 51406335, "link": "https://stackoverflow.com/questions/51406335/how-to-read-environment-variables-in-json-file-using-golang", "title": "How to read environment variables in JSON file using golang?", "body": "<p>Is there any way to put placeholders in json file which we can dynamically fill with values?\nfor e.g., </p>\n\n<pre><code>{\n   \"name\": \"{{$name}}\"\n}\n</code></pre>\n\n<p>Here, <code>{{$name}}</code> is a placeholder</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "is_accepted": false, "score": 1, "last_activity_date": 1531921622, "creation_date": 1531921622, "answer_id": 51403691, "question_id": 51403496, "link": "https://stackoverflow.com/questions/51403496/why-pointer-of-array-slice-change-in-go-if-len-doesnt-change/51403691#51403691", "title": "Why pointer of Array/Slice change in Go if len doesnt change?", "body": "<p>Because you are passing each time a copy of slice. While underlying array is not copied the slice does. I think in principal you can treat slice as a struct:</p>\n\n<pre><code>type Slice struct {\n   pointer PointerToArray\n   StartIndex int\n   Len int\n}\n</code></pre>\n\n<p>Code below should print the same pointer:</p>\n\n<pre><code>func tstSlice2() {\n    var meuSlice = make([]int, 1, 2)\n    meuSlice[0] = 1\n    printSlice(&amp;meuSlice, \"meuSlice\")\n    meuSlice[0] = 2\n    printSlice(&amp;meuSlice, \"meuSlice\")\n    meuSlice[0] = 3\n    printSlice(&amp;meuSlice, \"meuSlice\")\n}\n\nfunc printSlice(meuSlice *[]int, sliceName string) {\n    fmt.Printf(\"%v&gt; %v - %v - %v - %p \\n\", sliceName, len(*meuSlice), cap(*meuSlice), *meuSlice, meuSlice)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1531927471, "post_id": 51403894, "comment_id": 89782419, "body": "&quot;elements are by default passed by value&quot;. Not by default, <i>always</i>. <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Calls</a>"}, {"owner": {"reputation": 556, "user_id": 3581874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2073bb9adeaf4226234f85ff4c1b69?s=128&d=identicon&r=PG&f=1", "display_name": "MichalG", "link": "https://stackoverflow.com/users/3581874/michalg"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1532001641, "post_id": 51403894, "comment_id": 89815129, "body": "true, that was a bit of a mental shortcut. Indeed, in Go arguments are <i>always</i> passed as values. What I meant was that we may choose to pass the pointer, that will be passed as a value, but it will point to the same address. I edited the answer to add this clarification."}], "tags": [], "owner": {"reputation": 556, "user_id": 3581874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2073bb9adeaf4226234f85ff4c1b69?s=128&d=identicon&r=PG&f=1", "display_name": "MichalG", "link": "https://stackoverflow.com/users/3581874/michalg"}, "is_accepted": true, "score": 1, "last_activity_date": 1532002307, "last_edit_date": 1532002307, "creation_date": 1531922122, "answer_id": 51403894, "question_id": 51403496, "link": "https://stackoverflow.com/questions/51403496/why-pointer-of-array-slice-change-in-go-if-len-doesnt-change/51403894#51403894", "title": "Why pointer of Array/Slice change in Go if len doesnt change?", "body": "<p>What you are passing in <code>printSlice</code> function is not a slice but a slice header, that is describing the underlying array. When you pass a slice to a function, a copy of the header is made, since in go elements are <em>always</em> <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">passed by value</a>.</p>\n\n<blockquote>\n  <p>In a function call, the function value and arguments are evaluated in\n  the usual order. After they are evaluated, the parameters of the call\n  are passed by value to the function and the called function begins\n  execution. The return parameters of the function are passed by value\n  back to the calling function when the function returns.</p>\n</blockquote>\n\n<p>If you want to inspect what's inside of this header, check <a href=\"https://golang.org/pkg/reflect/#SliceHeader\" rel=\"nofollow noreferrer\">reflect.SliceHeader</a> type.</p>\n\n<p><strong>An example of the code:</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n    \"unsafe\"\n)\n\nfunc main() {\n    tstSlice2()\n\n}\n\nfunc tstSlice2() {\n    var meuSlice = make([]int, 1, 2)\n    meuSlice[0] = 1\n    printSlice(meuSlice, \"meuSlice\")\n    meuSlice[0] = 2\n    printSlice(meuSlice, \"meuSlice\")\n    meuSlice[0] = 3\n    printSlice(meuSlice, \"meuSlice\")\n}\n\nfunc printSlice(meuSlice []int, sliceName string) {\n    hdr := (*reflect.SliceHeader)(unsafe.Pointer(&amp;meuSlice))\n    fmt.Printf(\"%v&gt; %v - %v - %v - %p - array: %v\\n\", sliceName, len(meuSlice), cap(meuSlice), meuSlice, &amp;meuSlice, hdr.Data)\n\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>meuSlice&gt; 1 - 2 - [1] - 0xc42000a060 - array: 842350559504\nmeuSlice&gt; 1 - 2 - [2] - 0xc42000a0a0 - array: 842350559504\nmeuSlice&gt; 1 - 2 - [3] - 0xc42000a0e0 - array: 842350559504\n</code></pre>\n\n<p><strong>Go playground:</strong> <a href=\"https://play.golang.org/p/x2OoIHgU9St\" rel=\"nofollow noreferrer\">https://play.golang.org/p/x2OoIHgU9St</a></p>\n\n<p>You can find more information in the blog post <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Go Slices: usage and internals</a> (especially Slice internals section)</p>\n\n<blockquote>\n  <p>A slice is a descriptor of an array segment. It consists of a pointer\n  to the array, the length of the segment, and its capacity (the maximum\n  length of the segment).</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/rTs3T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rTs3T.png\" alt=\"Slice\"></a></p>\n\n<p>What you are passing to your function is a value of this struct, not the underlying array itself. To do that, you'd need to use <code>*[]int</code> argument, as mentioned in other answers.</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1531938511, "last_edit_date": 1531938511, "creation_date": 1531927197, "answer_id": 51405648, "question_id": 51403496, "link": "https://stackoverflow.com/questions/51403496/why-pointer-of-array-slice-change-in-go-if-len-doesnt-change/51405648#51405648", "title": "Why pointer of Array/Slice change in Go if len doesnt change?", "body": "<p>A slice value contains a pointer to a backing array, length and capacity.  See <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Go Slices: usage and internals</a> for all of the details.</p>\n\n<p>The program prints the address of the slice <code>menuSlice</code>. The address of the argument is not the same from call to call. </p>\n\n<p>It looks like your goal is to print the address of the slice's backing array. To do this, print the address of the first slice element.  The address of the first element is the same as the address of the entire backing array.</p>\n\n<pre><code>func printSlice(meuSlice []int, sliceName string) {\n    fmt.Printf(\"%v&gt; %v - %v - %v - %p \\n\", sliceName, len(meuSlice), cap(meuSlice), meuSlice, &amp;meuSlice[0])\n}\n</code></pre>\n\n<p>The output of this program is:</p>\n\n<pre><code>meuSlice&gt; 1 - 2 - [1] - 0x10414020 \nmeuSlice&gt; 1 - 2 - [2] - 0x10414020 \nmeuSlice&gt; 1 - 2 - [3] - 0x10414020 \n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/VKSuvAoutix\" rel=\"nofollow noreferrer\">playground example</a></p>\n\n<p>The above code panics on nil and zero length slices. To protect against the panic, check the length of the slice before take the address of the first element:</p>\n\n<pre><code>func printSlice(meuSlice []int, sliceName string) {\n    var p *int\n    if len(meuSlice) &gt; 0 {\n        p = &amp;meuSlice[0]\n    }\n    fmt.Printf(\"%v&gt; %v - %v - %v - %p \\n\", sliceName, len(meuSlice), cap(meuSlice), meuSlice, p)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/2pR_0rBSP7W\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 854, "user_id": 2402546, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/98d6b90a67cab3fb3924747158d0d14c?s=128&d=identicon&r=PG", "display_name": "thur", "link": "https://stackoverflow.com/users/2402546/thur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "accepted_answer_id": 51403894, "answer_count": 3, "score": 0, "last_activity_date": 1532002307, "creation_date": 1531921117, "question_id": 51403496, "link": "https://stackoverflow.com/questions/51403496/why-pointer-of-array-slice-change-in-go-if-len-doesnt-change", "title": "Why pointer of Array/Slice change in Go if len doesnt change?", "body": "<p>I made a program to learn more about arrays and slices, in this example I just change the value of a fix position. When I look to the pointer address it changed after each change. Why this happen?</p>\n\n<p><strong>Source:</strong></p>\n\n<pre><code>func main() {\n    tstSlice2()\n\n}\n\nfunc tstSlice2() {\n    var meuSlice = make([]int, 1, 2)\n    meuSlice[0] = 1\n    printSlice(meuSlice, \"meuSlice\")\n    meuSlice[0] = 2\n    printSlice(meuSlice, \"meuSlice\")\n    meuSlice[0] = 3\n    printSlice(meuSlice, \"meuSlice\")\n}\n\nfunc printSlice(meuSlice []int, sliceName string) {\n    fmt.Printf(\"%v&gt; %v - %v - %v - %p \\n\", sliceName, len(meuSlice), cap(meuSlice), meuSlice, &amp;meuSlice)\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>\u25b6 go run .\\src\\array_e_slices\\slice.go    \nmeuSlice&gt; 1 - 2 - [1] - 0xc0420503e0  \nmeuSlice&gt; 1 - 2 - [2] - 0xc042050440  \nmeuSlice&gt; 1 - 2 - [3] - 0xc042050480 \n</code></pre>\n"}, {"tags": ["go", "memory-management", "webassembly"], "comments": [{"owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "edited": false, "score": 0, "creation_date": 1531921215, "post_id": 51401185, "comment_id": 89777923, "body": "You can run this example: <a href=\"https://github.com/udhos/hellowasm/\" rel=\"nofollow noreferrer\">github.com/udhos/hellowasm</a> (you will need you have Go 1.11beta1)."}, {"owner": {"reputation": 1455, "user_id": 465147, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e824e3adb5aa777566fa8e53f89bebbe?s=128&d=identicon&r=PG", "display_name": "sprabhakaran", "link": "https://stackoverflow.com/users/465147/sprabhakaran"}, "reply_to_user": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "edited": false, "score": 0, "creation_date": 1531998970, "post_id": 51401185, "comment_id": 89813361, "body": "What is the difference between those two examples? I explore this package and didn&#39;t find anything from the previous example? Can you please explain this?"}, {"owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "edited": false, "score": 0, "creation_date": 1532010788, "post_id": 51401185, "comment_id": 89821687, "body": "The tutorial you have tried is from before wasm landing as supported Go platform. If you install go1.11beta1 or higher, you can more easily run the example I pointed out. Or other examples on the Internet, like this: <a href=\"https://sebastian-holstein.de/post/2018-07-05-go-wasm-application/\" rel=\"nofollow noreferrer\">sebastian-holstein.de/post/2018-07-05-go-wasm-application</a>"}], "owner": {"reputation": 1455, "user_id": 465147, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e824e3adb5aa777566fa8e53f89bebbe?s=128&d=identicon&r=PG", "display_name": "sprabhakaran", "link": "https://stackoverflow.com/users/465147/sprabhakaran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2616, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1531914226, "creation_date": 1531914226, "question_id": 51401185, "link": "https://stackoverflow.com/questions/51401185/webassembly-throwing-memory-access-out-of-bounds", "title": "Webassembly throwing - memory access out of bounds", "body": "<p>I have followed the tutorial on blog.gopheracademy.com/advent-2017/go-wasm for generating the .wasm file from golang language.</p>\n\n<p>I faced the below error when I execute the program,</p>\n\n<blockquote>\n  <p><em>/home/user/test ></em> node wasm_exec.js test.wasm</p>\n</blockquote>\n\n<pre><code>RuntimeError: memory access out of bounds\n    at memchr (wasm-function[75]:96)\n    at internal_bytealg.IndexByteString (wasm-function[72]:24)\n    at runtime.findnull (wasm-function[683]:227)\n    at runtime.gostring (wasm-function[678]:126)\n    at runtime.goenvs_unix (wasm-function[604]:639)\n    at runtime.goenvs (wasm-function[432]:86)\n    at runtime.schedinit (wasm-function[498]:780)\n    at runtime.rt0_go (wasm-function[860]:165)\n    at _rt0_wasm_js (wasm-function[907]:71)\n    at global.Go.run (/home/user/test/wasm_exec.js:378:24)\n</code></pre>\n\n<p>Sometimes getting the below error too,</p>\n\n<blockquote>\n  <p>runtime: memory allocated by OS [0x30000000, 0x938ab2fd34000000) not\n  in usable address space: end outside usable address space </p>\n  \n  <p>fatal error:\n  memory reservation exceeds address space limit</p>\n</blockquote>\n\n<p>I have used the default WebAssembly.Memory of this program (default memory is around 1033MB).</p>\n\n<pre><code>    WebAssembly.instantiate(fs.readFileSync(\"test.wasm\"), go.importObject).then((result) =&gt; {\nprocess.on(\"exit\", () =&gt; { // Node.js exits if no callback is pending\n                    if (!go.exited) {\n                        console.error(\"error: all goroutines asleep and no JavaScript callback pending - deadlock!\");\n                        process.exit(1);\n                    }\n                });\n                result.instance.exports.run()\n                return go.run(result.instance);\n            }).catch((err) =&gt; {\n                console.error(err);\n                go.exited = true;\n                process.exit(1);\n            });\n</code></pre>\n\n<p>Is anything I missed here? </p>\n"}, {"tags": ["go", "cron"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 6821422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PHi21.png?s=128&g=1", "display_name": "Jeet", "link": "https://stackoverflow.com/users/6821422/jeet"}, "edited": false, "score": 0, "creation_date": 1533104432, "post_id": 51402983, "comment_id": 90217523, "body": "Got it, thanks. What if I need to restart the gocron jobs again?"}, {"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "reply_to_user": {"reputation": 45, "user_id": 6821422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PHi21.png?s=128&g=1", "display_name": "Jeet", "link": "https://stackoverflow.com/users/6821422/jeet"}, "edited": false, "score": 1, "creation_date": 1533107539, "post_id": 51402983, "comment_id": 90219095, "body": "Instead of trying to restart stopped things, maybe the best / clearest / simplest way would be just to start new jobs that do the same work as the previous set of jobs."}], "tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": true, "score": 1, "last_activity_date": 1531919647, "creation_date": 1531919647, "answer_id": 51402983, "question_id": 51400831, "link": "https://stackoverflow.com/questions/51400831/how-do-i-stop-gocron-jobs-efficiently/51402983#51402983", "title": "How do I stop gocron jobs efficiently?", "body": "<p>Your problem is in the select block here:</p>\n\n<pre><code>    select {\n    case &lt;-quit:\n        return\n    default:\n        //cron jobs\n        g := gocron.NewScheduler()\n        g.Every(1).Second().Do(stuff)\n        &lt;-g.Start()\n    }\n</code></pre>\n\n<p>This code says: select the case we can read from <code>quit</code> and exit, or do the default case.</p>\n\n<p>Entering the <code>default</code> part of the case will block the goroutine on <code>&lt;-g.Start()</code> until all the jobs are done. We have to wait here for the jobs to finish. While we are still waiting on <code>&lt;-g.Start()</code> we do not consider the <code>quit</code> channel.</p>\n\n<p>Instead do:</p>\n\n<pre><code>func jobs(quit &lt;-chan bool) {\n    for {\n        //cron jobs\n        g := gocron.NewScheduler()\n        g.Every(1).Second().Do(stuff)\n\n        select {\n        case &lt;-quit:\n            // here we receive from quit and exit\n            // if `g` has started, we may want to `g.Clear()`\n            // or the scheduled jobs will continue, we will just not be waiting for them to finish.\n            return\n        case &lt;-g.Start():\n            // here we know all the jobs are done, and go round the loop again\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 6821422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PHi21.png?s=128&g=1", "display_name": "Jeet", "link": "https://stackoverflow.com/users/6821422/jeet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1055, "favorite_count": 0, "accepted_answer_id": 51402983, "answer_count": 1, "score": 0, "last_activity_date": 1531924075, "creation_date": 1531913081, "last_edit_date": 1531924075, "question_id": 51400831, "link": "https://stackoverflow.com/questions/51400831/how-do-i-stop-gocron-jobs-efficiently", "title": "How do I stop gocron jobs efficiently?", "body": "<p>I am doing something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n\n    \"github.com/jasonlvhit/gocron\"\n)\n\nfunc jobs(quit &lt;-chan bool) {\n    for {\n        select {\n        case &lt;-quit:\n            return\n        default:\n            //cron jobs\n            g := gocron.NewScheduler()\n            g.Every(1).Second().Do(stuff)\n            &lt;-g.Start()\n        }\n    }\n}\n\nfunc stuff() {\n    fmt.Println(\"doing job\")\n}\n\nfunc main() {\n    q := make(chan bool)\n    go jobs(q)\n    time.Sleep(3 * time.Second)\n\n //to quit the goroutine\n    q &lt;- true    \n    close(q)\n    fmt.Println(\"main\")\n}\n</code></pre>\n\n<p>I'm trying to stop the gocrons by killing the goroutine by closing the channel but I'm not able to stop gocron jobs. I am getting output </p>\n\n<pre><code>            doing job\n            doing job\n            doing job\n            doing job\n            doing job\n            doing job\n            doing job\n            .\n            .\n</code></pre>\n\n<p>Instead of </p>\n\n<pre><code>            doing job\n            doing job\n            doing job\n            main\n</code></pre>\n\n<p>What am I doing wrong? Is there any better solution to stop gocron jobs?</p>\n"}, {"tags": ["go", "kubernetes"], "answers": [{"comments": [{"owner": {"reputation": 80, "user_id": 3030524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cKRPv.jpg?s=128&g=1", "display_name": "UmairAhmad", "link": "https://stackoverflow.com/users/3030524/umairahmad"}, "edited": false, "score": 1, "creation_date": 1531918900, "post_id": 51399714, "comment_id": 89776126, "body": "well observing the behavior of watcher i came across the same findings, and now its confirm that i&#39;m hearing it from you. i want to know how can i run watcher till the main thread(listener) ends @philipGough"}, {"owner": {"reputation": 1589, "user_id": 2983542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4840fe7bdf44e6d7dea4ceb828ac70b5?s=128&d=identicon&r=PG&f=1", "display_name": "PhilipGough", "link": "https://stackoverflow.com/users/2983542/philipgough"}, "reply_to_user": {"reputation": 80, "user_id": 3030524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cKRPv.jpg?s=128&g=1", "display_name": "UmairAhmad", "link": "https://stackoverflow.com/users/3030524/umairahmad"}, "edited": false, "score": 0, "creation_date": 1531919254, "post_id": 51399714, "comment_id": 89776375, "body": "You can handle the timeout gracefully just as you might for any other disconnect reason. How will you currently handle it if you need to retry? Or take a look at some blog posts around writing Kubernetes controllers, for example <a href=\"https://engineering.bitnami.com/articles/a-deep-dive-into-kubernetes-controllers.html\" rel=\"nofollow noreferrer\">engineering.bitnami.com/articles/&hellip;</a>."}, {"owner": {"reputation": 656, "user_id": 381493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQOmd.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/381493/michael"}, "edited": false, "score": 0, "creation_date": 1551362659, "post_id": 51399714, "comment_id": 96619422, "body": "I&#39;ve observed similar behavior as the initial post, even with a timeout set, where it doesn&#39;t exit the watch like would happen after timeout, but no more data comes in the channel.  Have not yet solved it :("}], "tags": [], "owner": {"reputation": 1589, "user_id": 2983542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4840fe7bdf44e6d7dea4ceb828ac70b5?s=128&d=identicon&r=PG&f=1", "display_name": "PhilipGough", "link": "https://stackoverflow.com/users/2983542/philipgough"}, "is_accepted": false, "score": 2, "last_activity_date": 1531909826, "creation_date": 1531909826, "answer_id": 51399714, "question_id": 51399407, "link": "https://stackoverflow.com/questions/51399407/watch-in-k8s-golang-api-watches-and-get-events-but-after-sometime-doesnt-get-an/51399714#51399714", "title": "Watch in k8s golang api watches and get events but after sometime doesn&#39;t get any more events", "body": "<p>There is a default timeout on the watch. I believe it is set to 30 minutes.</p>\n\n<p>You can override this value in <code>ListOptions</code>. So for example, to set the timeout to an hour:</p>\n\n<pre><code>timeout := int64(3600)\nwatchres, error := jobsClient.Watch(metav1.ListOptions{\n    TimeoutSeconds: &amp;timeout,\n})\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 656, "user_id": 381493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQOmd.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/381493/michael"}, "edited": false, "score": 0, "creation_date": 1551455784, "post_id": 54930836, "comment_id": 96659089, "body": "I deployed this yesterday, and it was looking good.... but then it got hung again late last night and didn&#39;t actually quit.  So I guess we&#39;ll call this a work-in-progress."}], "tags": [], "owner": {"reputation": 656, "user_id": 381493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQOmd.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/381493/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1551376887, "last_edit_date": 1551376887, "creation_date": 1551373585, "answer_id": 54930836, "question_id": 51399407, "link": "https://stackoverflow.com/questions/51399407/watch-in-k8s-golang-api-watches-and-get-events-but-after-sometime-doesnt-get-an/54930836#54930836", "title": "Watch in k8s golang api watches and get events but after sometime doesn&#39;t get any more events", "body": "<p>As I said in a previous comment, I've had K8s just not feed me more events down the channel, but not actually hangup like the timeout is supposed to.</p>\n\n<p>So I've worked out something here using select - the idea is to wait for events but restart the watcher every 30 minutes just in case K8s doesn't hang up.  So far, this is working:</p>\n\n<pre><code>func watchEvents() {\n    for {\n        if err := RunLoop(); err != nil {\n            log.Error(err)\n        }\n        time.Sleep(5 * time.Second)\n    }\n}\n\nfunc runLoop() error {\n    watcher, err := clientset.EventsV1beta1().Events(\"\").Watch(metav1.ListOptions{})\n    if err != nil {\n        return err\n    }\n    ch := watcher.ResultChan()\n    for {\n        select {\n        case event, ok := &lt;-ch:\n            if !ok {\n                // the channel got closed, so we need to restart\n                log.Info(\"Kubernetes hung up on us, restarting event watcher\")\n                return nil\n            }\n\n            // handle the event\n\n        case &lt;-time.After(30 * time.Minute):\n            // deal with the issue where we get no events\n            log.Infof(\"Timeout, restarting event watcher\")\n            return nil\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 80, "user_id": 3030524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cKRPv.jpg?s=128&g=1", "display_name": "UmairAhmad", "link": "https://stackoverflow.com/users/3030524/umairahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1403, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1551376887, "creation_date": 1531908933, "last_edit_date": 1531991986, "question_id": 51399407, "link": "https://stackoverflow.com/questions/51399407/watch-in-k8s-golang-api-watches-and-get-events-but-after-sometime-doesnt-get-an", "title": "Watch in k8s golang api watches and get events but after sometime doesn&#39;t get any more events", "body": "<p>I'm using AKS and K8s golang API. </p>\n\n<p>I'm creating a Kubernetes watcher for watching jobs like </p>\n\n<pre><code>watchres, error := jobsClient.Watch(metav1.ListOptions{})\n</code></pre>\n\n<p>After that i'm getting the events channel like </p>\n\n<pre><code>eventres := watchres.ResultChan()\n</code></pre>\n\n<p>After that i'm getting events in a loop using </p>\n\n<pre><code>we := &lt;-eventres\n</code></pre>\n\n<p>then on the basis of these event i'm performing some action (for example delete a resource when kubernetes job gets successful)</p>\n\n<p>The issue i am facing is that everything seems to work fine but after some period of time the watcher does not delete resources however the jobs gets successful, what might be the issue, is there a timeout for the channel?? however i'm not closing the channel implicitly.</p>\n"}, {"tags": ["json", "api", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1531906022, "post_id": 51398322, "comment_id": 89767648, "body": "You already have the code. Why don&#39;t you try it?"}, {"owner": {"reputation": 17, "user_id": 6427290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73496797f103021acb54ef3d112a9c4c?s=128&d=identicon&r=PG&f=1", "display_name": "zeirash", "link": "https://stackoverflow.com/users/6427290/zeirash"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1531906083, "post_id": 51398322, "comment_id": 89767688, "body": "I don&#39;t have the api key and api secret, so I can&#39;t tested it on my own"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1531906127, "post_id": 51398322, "comment_id": 89767710, "body": "You can &quot;hard-code&quot; the source JSON text for the time of the test."}, {"owner": {"reputation": 17, "user_id": 6427290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73496797f103021acb54ef3d112a9c4c?s=128&d=identicon&r=PG&f=1", "display_name": "zeirash", "link": "https://stackoverflow.com/users/6427290/zeirash"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1531935784, "post_id": 51398322, "comment_id": 89787319, "body": "Ah yes, thanks for the advice"}], "answers": [{"tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": false, "score": 1, "last_activity_date": 1531921362, "creation_date": 1531921362, "answer_id": 51403590, "question_id": 51398322, "link": "https://stackoverflow.com/questions/51398322/accessing-necessary-field-json-golang/51403590#51403590", "title": "Accessing necessary field json golang", "body": "<p>From the <code>json.Unmarshal</code> docs</p>\n\n<blockquote>\n  <p>By default, object keys which don't have a corresponding struct field are ignored (see Decoder.DisallowUnknownFields for an alternative).</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\">https://golang.org/pkg/encoding/json/#Unmarshal</a></p>\n\n<p>Here is a runnable example, showing it working as expected</p>\n\n<p><a href=\"https://play.golang.org/p/PwnSj03hnEV\" rel=\"nofollow noreferrer\">https://play.golang.org/p/PwnSj03hnEV</a></p>\n"}], "owner": {"reputation": 17, "user_id": 6427290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73496797f103021acb54ef3d112a9c4c?s=128&d=identicon&r=PG&f=1", "display_name": "zeirash", "link": "https://stackoverflow.com/users/6427290/zeirash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531921362, "creation_date": 1531905927, "last_edit_date": 1531907460, "question_id": 51398322, "link": "https://stackoverflow.com/questions/51398322/accessing-necessary-field-json-golang", "title": "Accessing necessary field json golang", "body": "<p>I've been trying to access field from third party api.\nFor example the json response from third party api is like this:</p>\n\n<pre><code>{\n    \"request_id\": \"bba3b69370774f87bed0e70398a97f45\",\n    \"account_id\": \"2c1cd618\",\n    \"number\": \"6289523686433\"\n}\n</code></pre>\n\n<p>I want to get request_id only\ncan I create interface only like this:</p>\n\n<pre><code>type Response struct {\n   RequestID string json:\"request_id\"\n}\n</code></pre>\n\n<p>and then do this:</p>\n\n<pre><code>var resp Response\njson.Unmarshal(body,&amp;resp)\n</code></pre>\n\n<p>Is it possible to do this? Or do I need to make all field of response body in Response struct to be able to unmarshall?\nThanks</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1531904447, "post_id": 51397687, "comment_id": 89766537, "body": "I ran your plugin and app for like 2 minutes, and it produced no errors. Are you sure this is the exact code that produces the error you posted? What is your Go version and environment (include the output of <code>go env</code> and <code>go version</code>)? Are you running the main app on the same host where you compiled the plugin? As it is, this question is off-topic."}, {"owner": {"reputation": 329, "user_id": 9437085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZbW0.jpg?s=128&g=1", "display_name": "gyuaisdfaasf", "link": "https://stackoverflow.com/users/9437085/gyuaisdfaasf"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1531904561, "post_id": 51397687, "comment_id": 89766604, "body": "@icza yes, this is the exact code. Go version 1.10.3 on latest macOS. Yes they are on the same host"}, {"owner": {"reputation": 329, "user_id": 9437085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZbW0.jpg?s=128&g=1", "display_name": "gyuaisdfaasf", "link": "https://stackoverflow.com/users/9437085/gyuaisdfaasf"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1531904676, "post_id": 51397687, "comment_id": 89766679, "body": "@icza are you on linux?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1531904834, "post_id": 51397687, "comment_id": 89766795, "body": "Yes, I use linux. I don&#39;t experience any errors, even after running your app more than 5 minutes. This bug must be OS-X specific, or something wrong with your OS or Go installation. Note that plugin support originally was added only for Linux, macOS support was only added recently (in Go 1.10)."}, {"owner": {"reputation": 329, "user_id": 9437085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZbW0.jpg?s=128&g=1", "display_name": "gyuaisdfaasf", "link": "https://stackoverflow.com/users/9437085/gyuaisdfaasf"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1531905017, "post_id": 51397687, "comment_id": 89766953, "body": "@icza I&#39;ve updated the go version and go env"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1531905220, "post_id": 51397687, "comment_id": 89767105, "body": "I see nothing wrong in your code or at your side. Maybe someone else with macOS can test it and approve or disprove it. I would&#39;ve suggested to file a bug report, but for reference, you&#39;ve already done that: <a href=\"https://github.com/golang/go/issues/26436\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/26436</a>"}, {"owner": {"reputation": 329, "user_id": 9437085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZbW0.jpg?s=128&g=1", "display_name": "gyuaisdfaasf", "link": "https://stackoverflow.com/users/9437085/gyuaisdfaasf"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1531905449, "post_id": 51397687, "comment_id": 89767241, "body": "@icza thanks I&#39;ll test it with my colleague&#39;s Mac and later on a ubuntu machine. I&#39;ll see how it goes."}], "owner": {"reputation": 329, "user_id": 9437085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZbW0.jpg?s=128&g=1", "display_name": "gyuaisdfaasf", "link": "https://stackoverflow.com/users/9437085/gyuaisdfaasf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531926409, "creation_date": 1531904156, "last_edit_date": 1531926409, "question_id": 51397687, "link": "https://stackoverflow.com/questions/51397687/fatal-error-when-passing-byte-array-back-and-forth-to-plugin", "title": "Fatal error when passing byte array back and forth to plugin", "body": "<p>I am writing a golang plugin where I need to keep getting a byte array from the plug function and passing it to another function provided by the plugin.\nHowever, after a couple of iterations I got this error</p>\n\n<blockquote>\n  <p>fatal error: invalid pointer found on stack</p>\n</blockquote>\n\n<p>client.go</p>\n\n<pre><code>package main\n\nimport (\n    \"plugin\"\n    \"log\"\n)\n\ntype T interface {\n    GenByte() []byte\n    PrintByte(data []byte)\n}\n\nfunc main()  {\n    plgin, _ := plugin.Open(\"./plugin.so\")\n    symbol, _ := plgin.Lookup(\"Endpoint\")\n    b, _ := symbol.(T)\n    log.Println(\"From main\")\n    for{\n        data := b.GenByte()\n        b.PrintByte(data)\n    }\n\n\n}\n</code></pre>\n\n<p>plugin.go</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n)\n\ntype dummy struct {}\n\nfunc (d dummy)GenByte() []byte  {\n    log.Println(\"From plugin GenByte\")\n    data:=[]byte{1,2,3,4,5}\n    return data\n}\n\nfunc (d dummy)PrintByte(data []byte)  {\n    log.Println(\"From plugin PrintByte\")\n    log.Println(data)\n}\n\nvar Endpoint dummy\n\n\nfunc main() {\n\n}\n</code></pre>\n\n<hr>\n\n<pre><code>output\n2018/07/18 16:47:51 From plugin GenByte\n2018/07/18 16:47:51 From plugin PrintByte\n2018/07/18 16:47:51 [1 2 3 4 5]\n[repeat a number of times]\nruntime: bad pointer in frame plugin/unnamed-8b1a52c90a93f94ad1c14cee47dc41ef6a9bc487.dummy.PrintByte at 0xc420055eb0: 0x5\nfatal error: invalid pointer found on stack\n</code></pre>\n\n<p>Update:\ngo version go1.10.3 darwin/amd64</p>\n\n<p>go env</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOCACHE=\"/Users/yishengyang/Library/Caches/go-build\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/yishengyang//go\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTMPDIR=\"\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/darwin_amd64\"\nGCCGO=\"gccgo\"\nCC=\"clang\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\nPKG_CONFIG=\"pkg-config\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/var/folders/vh/6m51srdn3ps28tc64qy1343h0000gp/T/go-build637303097=/tmp/go-build -gno-record-gcc-switches -fno-common\"\n</code></pre>\n"}, {"tags": ["go", "go-micro", "goa"], "comments": [{"owner": {"reputation": 983, "user_id": 7861179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9c2400b191f563b54923485cf44d3c2b?s=128&d=identicon&r=PG&f=1", "display_name": "rellocs wood", "link": "https://stackoverflow.com/users/7861179/rellocs-wood"}, "edited": false, "score": 0, "creation_date": 1531903291, "post_id": 51397328, "comment_id": 89765728, "body": "I&#39;m quite new to GO ( also English... ), so please give more detail as possible in plain   words ,thx~"}, {"owner": {"reputation": 1944, "user_id": 4120554, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh5.googleusercontent.com/-RKmmNTC8iUo/AAAAAAAAAAI/AAAAAAAAAGs/oQQp9tU-Zb4/photo.jpg?sz=128", "display_name": "Marco Talento", "link": "https://stackoverflow.com/users/4120554/marco-talento"}, "edited": false, "score": 1, "creation_date": 1531904780, "post_id": 51397328, "comment_id": 89766755, "body": "Please have a look at the official documentation: <a href=\"https://golang.org/cmd/go/#hdr-Download_and_install_packages_and_dependencies\" rel=\"nofollow noreferrer\">golang.org/cmd/go/&hellip;</a>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 1944, "user_id": 4120554, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh5.googleusercontent.com/-RKmmNTC8iUo/AAAAAAAAAAI/AAAAAAAAAGs/oQQp9tU-Zb4/photo.jpg?sz=128", "display_name": "Marco Talento", "link": "https://stackoverflow.com/users/4120554/marco-talento"}, "edited": false, "score": 1, "creation_date": 1531905357, "post_id": 51397328, "comment_id": 89767188, "body": "@MarcoTalento: You need to take into account the limits on internet access in China. Some of them are mentioned in the question. For China, <a href=\"https://golang.google.cn\" rel=\"nofollow noreferrer\">golang.google.cn</a> may be a better site: <a href=\"https://blog.golang.org/hello-china\" rel=\"nofollow noreferrer\">The Go Blog: Hello, \u4e2d\u56fd!</a>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531919800, "post_id": 51397328, "comment_id": 89776782, "body": "What happens when you try the <code>go get</code>? Do you get an error, and if so, what is it?"}, {"owner": {"reputation": 983, "user_id": 7861179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9c2400b191f563b54923485cf44d3c2b?s=128&d=identicon&r=PG&f=1", "display_name": "rellocs wood", "link": "https://stackoverflow.com/users/7861179/rellocs-wood"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1531961402, "post_id": 51397328, "comment_id": 89797270, "body": "@peterSO golang.google.cn is exactly what I need! THX!"}], "answers": [{"tags": [], "owner": {"reputation": 1659, "user_id": 3113419, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f2dc3f344d5931dfa7d2af17520f6e87?s=128&d=identicon&r=PG&f=1", "display_name": "kkpoon", "link": "https://stackoverflow.com/users/3113419/kkpoon"}, "is_accepted": true, "score": 15, "last_activity_date": 1531904692, "creation_date": 1531904692, "answer_id": 51397887, "question_id": 51397328, "link": "https://stackoverflow.com/questions/51397328/how-to-install-go-package-manually-from-source-code/51397887#51397887", "title": "How to install Go package manually from source code", "body": "<p>for example, you have the <code>repo_url</code> at <a href=\"https://github.com/hello/example\" rel=\"noreferrer\">https://github.com/hello/example</a></p>\n\n<p>You can do <code>go get</code> manually by</p>\n\n<pre><code>$ cd $GOPATH\n$ mkdir -p src/github.com/hello\n$ cd src/github.com/hello\n$ git clone https://github.com/hello/example.git\n$ cd example\n$ go install\n</code></pre>\n\n<p>the binary will install into <code>$GOPATH/bin</code></p>\n\n<p>if the go program of the repo_url depends on other go package. you have to manually get it and put it to correct path location too.</p>\n"}, {"tags": [], "owner": {"reputation": 746, "user_id": 4501494, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vQlbzv2NqHE/AAAAAAAAAAI/AAAAAAAAADA/UayTLkri1BA/photo.jpg?sz=128", "display_name": "Esmaeil MIRZAEE", "link": "https://stackoverflow.com/users/4501494/esmaeil-mirzaee"}, "is_accepted": false, "score": 0, "last_activity_date": 1600453709, "creation_date": 1600453709, "answer_id": 63961011, "question_id": 51397328, "link": "https://stackoverflow.com/questions/51397328/how-to-install-go-package-manually-from-source-code/63961011#63961011", "title": "How to install Go package manually from source code", "body": "<p>Two things are important when one looks to get a required package manually,</p>\n<ol>\n<li><p>Path to the package repository; for example, <a href=\"https://github.com/golang/crypto\" rel=\"nofollow noreferrer\">github.com/golang/crypto.git</a> package is hosted on Github. However, when using on code should import as <a href=\"http://golang.org/x/crypto/bcrypt\" rel=\"nofollow noreferrer\">golang.org/x/crypto/bcrypt</a></p>\n<p>Google the required package</p>\n</li>\n<li><p>Path in the <code>$GOPATH</code>. In this example, the repository should be cloned inside <code>golang.org</code> directory and inside the appropriate directories. To me, the solution to find the path is running code and read the errors for missing modules/packages.</p>\n</li>\n</ol>\n"}], "owner": {"reputation": 983, "user_id": 7861179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9c2400b191f563b54923485cf44d3c2b?s=128&d=identicon&r=PG&f=1", "display_name": "rellocs wood", "link": "https://stackoverflow.com/users/7861179/rellocs-wood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10318, "favorite_count": 2, "accepted_answer_id": 51397887, "answer_count": 2, "score": 9, "last_activity_date": 1600453709, "creation_date": 1531903161, "last_edit_date": 1531992006, "question_id": 51397328, "link": "https://stackoverflow.com/questions/51397328/how-to-install-go-package-manually-from-source-code", "title": "How to install Go package manually from source code", "body": "<p>I'm living in China and is not able to download &amp; install GO package through command (event I use the vpn network):</p>\n\n<pre><code> go get -u &lt;repo_url&gt;\n</code></pre>\n\n<p>but I can access the <strong>repo_url</strong> and downloand its source code.\nSo my question is can I put the scource code under <strong>src</strong> folder and run commamd ? :</p>\n\n<pre><code>go install \n</code></pre>\n\n<p>if yes, what's the different betweeen the two way ?</p>\n"}, {"tags": ["go", "multi-tenant", "apex"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531920357, "post_id": 51397160, "comment_id": 89777216, "body": "That link appears to predate the inclusion of the <a href=\"https://golang.org/pkg/plugin/\" rel=\"nofollow noreferrer\">golang.org/pkg/plugin</a> package in the standard library. You can now use compiled Go plugins in-process on Linux and MacOS."}, {"owner": {"reputation": 309, "user_id": 4517341, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/100000867481103/picture?type=large", "display_name": "Kumar Siva", "link": "https://stackoverflow.com/users/4517341/kumar-siva"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531932182, "post_id": 51397160, "comment_id": 89785439, "body": "Yes. But I need to have  plugins for each user in the database. So where to store the plugin? How load and unload the plugin to each request?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531932426, "post_id": 51397160, "comment_id": 89785556, "body": "If you&#39;re going to handle more than one request at a time, you wouldn&#39;t want to load and unload the plugins for each request; not only would that be incredibly slow, it would also cause all sorts of issues because plugins are global, there&#39;s no way to have a request-scoped plugin. You&#39;ll want to carefully consider your design and how this would actually work in practice before you commit to an architecture and implementation."}, {"owner": {"reputation": 309, "user_id": 4517341, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/100000867481103/picture?type=large", "display_name": "Kumar Siva", "link": "https://stackoverflow.com/users/4517341/kumar-siva"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531933486, "post_id": 51397160, "comment_id": 89786157, "body": "Any other way to achieve this? Any script like lua will work?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531933580, "post_id": 51397160, "comment_id": 89786195, "body": "There are probably many ways to achieve whatever you&#39;re trying to accomplish (though the question is pretty light on details). However, <i>Questions asking us to recommend or find a book, tool, software library, tutorial or other off-site resource are off-topic for Stack Overflow</i>."}], "owner": {"reputation": 309, "user_id": 4517341, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/100000867481103/picture?type=large", "display_name": "Kumar Siva", "link": "https://stackoverflow.com/users/4517341/kumar-siva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531902654, "creation_date": 1531902654, "question_id": 51397160, "link": "https://stackoverflow.com/questions/51397160/is-it-possible-to-build-salesforce-apex-kind-of-framework-using-golang-plugin", "title": "Is it possible to build salesforce apex kind of framework using golang plugin?", "body": "<p>Need to run golang code run dynamically. I have golang function as a string.   Dynamically creating a new golang file and using exec command to run that go file won't be faster and also not a correct approach. </p>\n\n<p>So I am trying to write my function as a plugin. But where to store that function? In multi-tenancy app we cannot store all plugin's in app container. Can anyone explain with example? </p>\n\n<p>I referred <a href=\"https://appliedgo.net/plugins/\" rel=\"nofollow noreferrer\">https://appliedgo.net/plugins/</a></p>\n"}, {"tags": ["go", "plugins", "segmentation-fault"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1531899233, "last_edit_date": 1531899233, "creation_date": 1531898899, "answer_id": 51396043, "question_id": 51395930, "link": "https://stackoverflow.com/questions/51395930/passing-byte-array-to-plugin-function/51396043#51396043", "title": "Passing byte array to plugin function", "body": "<p>First, you should always check returned errors (and the result of type assertion from the plugin symbol)!</p>\n\n<p>The problem in your case is that the <code>sayHi()</code> method is unexported. So if you create an interface in your app, it will not match the unexported method created in the plugin.</p>\n\n<p>Export the method, and it will work (given you don't get any other errors).</p>\n\n<p>In the plugin:</p>\n\n<pre><code>func (d dummy) SayHi(data []byte) {\n    log.Println(\"From plugin\")\n    log.Println(data)\n}\n</code></pre>\n\n<p>In your main app:</p>\n\n<pre><code>type T interface {\n    SayHi(data []byte)\n}\n</code></pre>\n\n<p>And when calling it:</p>\n\n<pre><code>b.SayHi(data)\n</code></pre>\n\n<p>One thing to note here. When you lookup a variable from a plugin, you get a <em>pointer</em> to the variable (else you could not change its value). For details, see: <a href=\"https://stackoverflow.com/questions/49656283/plugin-symbol-as-function-return/49668505#49668505\">Plugin symbol as function return</a>. What this means is that <code>symbol</code> will be of type <code>*dummy</code>, not <code>dummy</code>. This doesn't cause any troubles here, as the <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">method set</a> of <code>*dummy</code> also contains the <code>SayHi()</code> method, just like the method set of <code>dummy</code>, but you should not forget about this if you would attempt to type-assert a non-interface type (a concrete type) out of a plugin symbol.</p>\n"}], "owner": {"reputation": 329, "user_id": 9437085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZbW0.jpg?s=128&g=1", "display_name": "gyuaisdfaasf", "link": "https://stackoverflow.com/users/9437085/gyuaisdfaasf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 862, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531991996, "creation_date": 1531898587, "last_edit_date": 1531991996, "question_id": 51395930, "link": "https://stackoverflow.com/questions/51395930/passing-byte-array-to-plugin-function", "title": "Passing byte array to plugin function", "body": "<p>I need to write a golang plugin with a function that accepts an array of golang bytes, but when I try to call this function after loading the plugin in the client code, it always gives me </p>\n\n<blockquote>\n  <p>panic: runtime error: invalid memory address or nil pointer dereference\n  [signal SIGSEGV: segmentation violation code=0x1 addr=0x18 pc=0x40b22af]</p>\n</blockquote>\n\n<p>Any suggestions on how to resolve this?</p>\n\n<p>code to reproduce(highly simplified, but the same error occurs)</p>\n\n<p>client.go</p>\n\n<pre><code>package main\n\nimport (\n    \"plugin\"\n    \"log\"\n)\n\ntype T interface {\n    sayHi(data []byte)\n}\n\nfunc main()  {\n    plgin, _ := plugin.Open(\"./plugin.so\")\n    symbol, _ := plgin.Lookup(\"Endpoint\")\n    b, _ := symbol.(T)\n    log.Println(\"From main\")\n    data := []byte{1,2,3,4,5}\n    b.sayHi(data)\n\n}\n</code></pre>\n\n<p>plugin.go(this program is built with <code>buildmode=plugin</code>)</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n)\n\ntype dummy struct {}\n\nfunc (d dummy)sayHi(data []byte)  {\n    log.Println(\"From plugin\")\n    log.Println(data)\n}\n\nvar Endpoint dummy\n\n\nfunc main() {\n\n}\n</code></pre>\n"}, {"tags": ["go", "pluralize", "cldr"], "answers": [{"comments": [{"owner": {"reputation": 15031, "user_id": 1256496, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/hlmB0.jpg?s=128&g=1", "display_name": "zemirco", "link": "https://stackoverflow.com/users/1256496/zemirco"}, "edited": false, "score": 0, "creation_date": 1531915779, "post_id": 51400909, "comment_id": 89774046, "body": "It starts making sense. I still do not understand the second argument to <code>plural.Selectf</code> <code>&quot;%d&quot;</code>. I&#39;ve tried changing it and it seems like I can write anything I want there. I literally wrote &quot;anything&quot; and it still works."}, {"owner": {"reputation": 4628, "user_id": 744534, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/iWWdZ.jpg?s=128&g=1", "display_name": "Thaadikkaaran", "link": "https://stackoverflow.com/users/744534/thaadikkaaran"}, "reply_to_user": {"reputation": 15031, "user_id": 1256496, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/hlmB0.jpg?s=128&g=1", "display_name": "zemirco", "link": "https://stackoverflow.com/users/1256496/zemirco"}, "edited": false, "score": 0, "creation_date": 1531983760, "post_id": 51400909, "comment_id": 89803680, "body": "What i am aware of the second argument to <code>plural.Selectf</code> is that it accepts only <code>%d, %f, %g, %e</code>. If we provide other than these, it is simply ignoring the value. And this format verb is been used with catalog.Message type."}], "tags": [], "owner": {"reputation": 4628, "user_id": 744534, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/iWWdZ.jpg?s=128&g=1", "display_name": "Thaadikkaaran", "link": "https://stackoverflow.com/users/744534/thaadikkaaran"}, "is_accepted": true, "score": 2, "last_activity_date": 1531913350, "creation_date": 1531913350, "answer_id": 51400909, "question_id": 51395452, "link": "https://stackoverflow.com/questions/51395452/trying-to-understand-golang-pluralization/51400909#51400909", "title": "Trying to understand Golang pluralization", "body": "<p>Here you go!</p>\n\n<p>The first argument of <code>plural.Selectf</code> is an <code>int</code>. So it can be any valid integer.\nThe second argument is a <code>string</code>. It should be a format verb i.e <code>%d</code> or <code>%s</code> or <code>%f</code>\nThe third argument is an empty interface, could receive any type i.e string, struct, catalog.Message, ..</p>\n\n<p>Let's take this example,</p>\n\n<pre><code>func main() {\n\n    var (\n            msg = plural.Selectf(2, \"%d\",\n                \"=10\", \"%[1]d task and %[2]d processes remaining!\", // interface 1\n                \"=1\", \"%[1]d task and %[2]d processes\", // interface 2\n                \"other\", \"%d tasks and %d processes!\" // interface 3\n            )\n            key = \"%d task - %d process\"\n            tag = \"en\"\n        )\n\n        lTag := language.MustParse(tag)\n        message.Set(lTag, key, msg)\n\n        p := message.NewPrinter(language.English)\n        p.Printf(\"%d task - %d process\", 1, 10)\n\n}\n</code></pre>\n\n<p>Here we have created a <code>NewPrinter</code> with language English and set the translation messages with the key <code>%d task(s) remaining!</code> for tag <code>en</code>(short code for English language).</p>\n\n<p>When <code>p.Printf(\"%d task - %d process\", 1, 3)</code> line executes, the translation mechanism takes the first argument(format specifier) i.e <code>%d task - %d process</code> and checks for the message by comparing with key we set in for <code>en</code> tag. If the key is found, then it processes the message i.e <code>msg</code>.</p>\n\n<p>Here the <code>Selectf</code>s first argument says that take <code>nth</code> (i.e 2nd in our case) format verb's value from <code>Printf</code> (i.e 10 in the second value for %d) and compare with selector of cases i.e <code>=10</code> in the case 1 (interface 1). If the comparison is success then returns the processed value i.e <code>1 task and 10 processes</code> in case 1. </p>\n\n<p>If the <code>Printf</code> receives values for 2nd %d other than 1 &amp; 10 then it would return the value from case 3 (interface 3)</p>\n\n<p>And,</p>\n\n<p>The <code>%[n]d</code> could be used like,</p>\n\n<p><code>fmt.Printf(\"%[2]d %[1]d\\n\", 11, 22)</code> and it prints <code>22 11</code>.</p>\n\n<p>Hope, this helps you.</p>\n"}], "owner": {"reputation": 15031, "user_id": 1256496, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/hlmB0.jpg?s=128&g=1", "display_name": "zemirco", "link": "https://stackoverflow.com/users/1256496/zemirco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1380, "favorite_count": 0, "accepted_answer_id": 51400909, "answer_count": 1, "score": 0, "last_activity_date": 1531913350, "creation_date": 1531897028, "question_id": 51395452, "link": "https://stackoverflow.com/questions/51395452/trying-to-understand-golang-pluralization", "title": "Trying to understand Golang pluralization", "body": "<p>I'm trying to understand pluralization in Go. The example from the docs <a href=\"https://godoc.org/golang.org/x/text/message/catalog#hdr-String_interpolation\" rel=\"nofollow noreferrer\">https://godoc.org/golang.org/x/text/message/catalog#hdr-String_interpolation</a> does not work. The method <code>plural.Select</code> does not event exist. It should be <code>plural.Selectf</code>. Note the <code>f</code> at the end.</p>\n\n<pre><code>message.Set(language.English, \"You are %d minute(s) late.\",\ncatalog.Var(\"minutes\", plural.Selectf(1, \"one\", \"minute\")),\ncatalog.String(\"You are %d ${minutes} late.\"))\np := message.NewPrinter(language.English)\np.Printf(\"You are %d minute(s) late.\", 5)\n</code></pre>\n\n<p>I found another tutorial here <a href=\"https://phraseapp.com/blog/posts/internationalization-i18n-go/\" rel=\"nofollow noreferrer\">https://phraseapp.com/blog/posts/internationalization-i18n-go/</a>. This code works fine</p>\n\n<pre><code>message.Set(language.English, \"You have %d problem\",\n    catalog.Var(\"minutes\", plural.Selectf(1, \"%d\", \"one\", \"minute\", \"other\", \"minutes\")),\n    catalog.String(\"You are %d ${minutes} late.\"))\nprinter := message.NewPrinter(language.English)\nprinter.Printf(\"You have %d problem\", 1)\nprinter.Println()\nprinter.Printf(\"You have %d problem\", 3)\nprinter.Println()\n\n// result\n// You are 1 minute late.\n// You are 3 minutes late.\n</code></pre>\n\n<p>Both examples use the advanced string interpolation. Now I'm trying to understand <code>plural.Selectf</code>. What is the first argument <code>1</code> doing? Why do I need the second argument <code>%d</code>? I think I understand the rest</p>\n\n<pre><code>\"one\"  : \"minute\"\n\"other\": \"minutes\"\n</code></pre>\n\n<p>I also saw <code>%[1]d</code> in <code>catalog.String</code>. What does this do?</p>\n\n<p>Thanks a lot! I'm super confused right now.</p>\n"}, {"tags": ["macos", "go", "macos-high-sierra", "cgo"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1531897420, "post_id": 51394968, "comment_id": 89762182, "body": "Why don&#39;t you check the return value of <code>C.fputs</code>? It may very well hint at the problem."}, {"owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1531897571, "post_id": 51394968, "comment_id": 89762263, "body": "thanks: <code>.&#47;main.go:15: cannot convert nil to type _Ctype_int</code>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1531897665, "post_id": 51394968, "comment_id": 89762338, "body": "You mean you&#39;re doing something like <code>if C.fputs(...) != nil</code>? Then yeah C&#39;s <code>fputs</code> obviously does not return <code>nil</code> as C does not know anything about Go-style error handling. C&#39;s <code>fputs</code> retuns an <code>int</code>. Please read the manual page on <code>fputs</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "edited": false, "score": 0, "creation_date": 1531897626, "post_id": 51395438, "comment_id": 89762305, "body": "I&#39;m not sure if your reasoning is correct but accepting because the code works."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531897956, "post_id": 51395438, "comment_id": 89762540, "body": "That&#39;s kind of hide the problem instead of solve it."}, {"owner": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "edited": false, "score": 0, "creation_date": 1531898858, "post_id": 51395438, "comment_id": 89763098, "body": "Thank you for the constructive criticism to help me learn, and feel free to downvote but I was simply trying to provide an explanation of why the code that was being tried wasn&#39;t working and to provide a sample that still accomplished what the OP was looking for without getting too granular."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531900025, "post_id": 51395438, "comment_id": 89763778, "body": "@waymobetta then did you explain why the part <code>(*C.FILE)(C.stdout)</code> doesn&#39;t work?"}, {"owner": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531931674, "post_id": 51395438, "comment_id": 89785142, "body": "@leafbebop fair, I alluded to it with the first line about how stdout is being redirected to the file [that doesn&#39;t exist]. I could have explained in more depth about what he tried and why it didn&#39;t work. I&#39;ll edit my post."}], "tags": [], "owner": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "is_accepted": true, "score": 1, "last_activity_date": 1531932878, "last_edit_date": 1531932878, "creation_date": 1531896979, "answer_id": 51395438, "question_id": 51394968, "link": "https://stackoverflow.com/questions/51394968/unable-to-print-to-stdout/51395438#51395438", "title": "Unable to print to stdout", "body": "<p>Try this:</p>\n\n<pre><code>package main\n\n// #include &lt;stdlib.h&gt;\n// #include &lt;stdio.h&gt;\nimport \"C\"\nimport \"unsafe\"\n\nfunc main() {\n    cs := C.CString(\"hello\")\n    defer C.free(unsafe.Pointer(cs))\n    C.puts(cs)\n}\n</code></pre>\n\n<p>Explanation:</p>\n\n<p>The <code>fputs</code> method writes a string to a data stream, in your case stdout, which is directed towards a pointer to a file that doesn't exist because it has neither been opened nor defined anywhere previously. So even though the program appears to execute without error, you aren't seeing any of the stdout because it is being redirected to a nonexistent file.</p>\n\n<p>Further, it should be noted that simply dropping the code from the <a href=\"https://blog.golang.org/c-go-cgo\" rel=\"nofollow noreferrer\">Strings and things</a> section into a main program without some customization would not work because it is provided in the blog as a package, which is why there was confusion about the file existing. It seems that the <code>print</code> package from the blog post simply assumes the file you are attempting to write the data stream to has already been defined somewhere previously. It's a little confusing and they should probably adjust that.</p>\n\n<p>I replaced <code>fputs</code> with <code>puts</code> as well as removed the pointer to the file and the program executes just fine.</p>\n\n<p>Hope that even with the modifications this helps accomplish what you are looking for!</p>\n"}, {"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 1, "last_activity_date": 1531898242, "creation_date": 1531898242, "answer_id": 51395816, "question_id": 51394968, "link": "https://stackoverflow.com/questions/51394968/unable-to-print-to-stdout/51395816#51395816", "title": "Unable to print to stdout", "body": "<p>Another cause might be due to the fact you have the C <em>standard library</em> linked with your Go program, but the \"standard I/O streams\" (in the form of <code>FILE*</code>) is a property of the <em>C runtime,</em> and they have to be initialized before use.</p>\n\n<p>For a typical program written in C, the compiler creates a special prologue code which actually runs before C's <code>main()</code> (usually to do that it links in a small object file standard for the target platform which does the necessary stuff and then jumps to <code>main</code>).</p>\n\n<p>Supposedly in a Go program such initialization does not happen and so these high-level wrappers for the standard I/O streams left\nuninitialized.</p>\n\n<p>You might check if this is true by trying something like this:</p>\n\n<pre><code>f = fdopen(C.int(os.Stdout.Fd()), C.CString(\"w\"))\nC.fputs(cs, f)\n</code></pre>\n\n<p>and see if it works.</p>\n\n<p>The <code>fdopen(3)</code> makes a <code>FILE*</code> object out of an OS-level\nfile descriptor for an already opened file,\nand the <code>Fd()</code> function pulls just that out of a Go's <code>*os.File</code>.</p>\n"}], "owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 51395438, "answer_count": 2, "score": 1, "last_activity_date": 1531932878, "creation_date": 1531895307, "question_id": 51394968, "link": "https://stackoverflow.com/questions/51394968/unable-to-print-to-stdout", "title": "Unable to print to stdout", "body": "<p>I'm able to get the program <a href=\"https://golang.org/cmd/cgo/#hdr-Go_references_to_C\" rel=\"nofollow noreferrer\">here</a> to print 42 as expected.</p>\n\n<p>But I am unable to get the following program to print to stdout:</p>\n\n<pre><code>package main\n\n// #include &lt;stdlib.h&gt;\n// #include &lt;stdio.h&gt;\nimport \"C\"\n\nimport (\n    \"unsafe\"\n)\n\nfunc main() {\n    cs := C.CString(\"hello\")\n    defer C.free(unsafe.Pointer(cs))\n    C.fputs(cs, (*C.FILE)(C.stdout))\n}\n</code></pre>\n\n<p>It runs without error, but it doesn't print anything. The above snippet is mostly based off the \"Strings and things\" code <a href=\"https://blog.golang.org/c-go-cgo\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": ["go", "pipeline", "channel"], "answers": [{"comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531897668, "post_id": 51395209, "comment_id": 89762340, "body": "Just as a note: Rob Pike <a href=\"https://github.com/golang/go/issues/26282\" rel=\"nofollow noreferrer\">proposed</a> to add a <code>splice</code> to channel in Go 2 which seems to be just for this problem."}, {"owner": {"reputation": 3879, "user_id": 183662, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ffbae1bce3720e05537f5ff9e9b5887d?s=128&d=identicon&r=PG", "display_name": "Pepijn", "link": "https://stackoverflow.com/users/183662/pepijn"}, "edited": false, "score": 0, "creation_date": 1531906628, "post_id": 51395209, "comment_id": 89768060, "body": "The original splice proposal does not really cover what I want, but <a href=\"https://github.com/golang/go/issues/26282#issuecomment-405786296\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/26282#issuecomment-405786296</a> this is exactly what I described above. Except I&#39;m not sure what he means by how to refactor that code."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1531897209, "last_edit_date": 1531897209, "creation_date": 1531896251, "answer_id": 51395209, "question_id": 51394957, "link": "https://stackoverflow.com/questions/51394957/how-can-i-transfer-a-value-from-one-go-channel-to-another-without-an-implicit-bu/51395209#51395209", "title": "How can I transfer a value from one Go channel to another without an implicit buffer?", "body": "<p>You can't do this with 2 channels. In order to perform a send on <code>ch2</code>, the value to be sent must already be ready, evaluated. <a href=\"https://golang.org/ref/spec#Send_statements\" rel=\"nofollow noreferrer\">Spec: Send statements:</a></p>\n\n<blockquote>\n  <p>Both the channel and the value expression are evaluated before communication begins.</p>\n</blockquote>\n\n<p>So even if you would do this, which seemingly does not buffer the value in any variable:</p>\n\n<pre><code>ch2 &lt;- (&lt;- ch1)\n</code></pre>\n\n<p>Still, the receive from <code>ch1</code> would be evaluated first, and only then would the send be attempted.</p>\n\n<p>Which means that value must have already  been received from <code>ch1</code>. But you can't tell if anyone is \"listening\" on <code>ch2</code> (meaning if a send on <code>ch2</code> could proceed) without attempting to send on <code>ch2</code> (and even if you could, there is no guarantee that attempting a send after a check there would still be someone listening on it).</p>\n"}], "owner": {"reputation": 3879, "user_id": 183662, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ffbae1bce3720e05537f5ff9e9b5887d?s=128&d=identicon&r=PG", "display_name": "Pepijn", "link": "https://stackoverflow.com/users/183662/pepijn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 51395209, "answer_count": 1, "score": 2, "last_activity_date": 1531897209, "creation_date": 1531895277, "question_id": 51394957, "link": "https://stackoverflow.com/questions/51394957/how-can-i-transfer-a-value-from-one-go-channel-to-another-without-an-implicit-bu", "title": "How can I transfer a value from one Go channel to another without an implicit buffer?", "body": "<p>Imagine I have a goroutine that reads from one channel and writes to another.</p>\n\n<pre><code>ch1 := make(chan int)\nch2 := make(chan int)\ngo func() {\n  for num := range ch1 {\n    ch2 &lt;- num+1\n  }\n}()\n</code></pre>\n\n<p>If <code>ch2</code> is blocked, the goroutine will still read a value from <code>ch1</code>, effectively introducing a buffer of 1 in the channel. Since I'm using channels for control flow I don't want any buffering.</p>\n\n<p>How can I make a pipeline that executes in a completely lock-step fashion?\nOr put differently, how can I transfer a value from one channel to the next in one atomic operation?</p>\n\n<p>I basically want to wait for both <code>ch1</code> and <code>ch2</code> to be at a rendezvous point.</p>\n"}, {"tags": ["go", "hyperledger-fabric", "blockchain"], "comments": [{"owner": {"reputation": 451, "user_id": 503805, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/be388769325a9d50c49a8ec153b8d964?s=128&d=identicon&r=PG", "display_name": "Haider", "link": "https://stackoverflow.com/users/503805/haider"}, "edited": false, "score": 0, "creation_date": 1539584858, "post_id": 51394881, "comment_id": 92539568, "body": "Any luck with this issue?"}, {"owner": {"reputation": 109, "user_id": 6790808, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TPlkCn6NLB8/AAAAAAAAAAI/AAAAAAAAA_I/hgXs7P28_yk/photo.jpg?sz=128", "display_name": "Ashish Mishra", "link": "https://stackoverflow.com/users/6790808/ashish-mishra"}, "reply_to_user": {"reputation": 451, "user_id": 503805, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/be388769325a9d50c49a8ec153b8d964?s=128&d=identicon&r=PG", "display_name": "Haider", "link": "https://stackoverflow.com/users/503805/haider"}, "edited": false, "score": 0, "creation_date": 1541414342, "post_id": 51394881, "comment_id": 93195764, "body": "No! created a new setup. Did waste about a week to fix it. Nothing worked."}, {"owner": {"reputation": 2119, "user_id": 469718, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/61631f8c2dec374fd3fd30a3cb7b50ce?s=128&d=identicon&r=PG", "display_name": "kisna", "link": "https://stackoverflow.com/users/469718/kisna"}, "edited": false, "score": 0, "creation_date": 1541749253, "post_id": 51394881, "comment_id": 93329986, "body": "can you add the version, sdk and chaincode languages? also reproduced in v1.3 Java chain codes <a href=\"https://stackoverflow.com/questions/52982837/problem-about-instantiating-java-chaincode-in-hyperledger-fabric-v1-3-failed-t/53221489#53221489\" title=\"problem about instantiating java chaincode in hyperledger fabric v1 3 failed t\">stackoverflow.com/questions/52982837/&hellip;</a>"}], "owner": {"reputation": 109, "user_id": 6790808, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TPlkCn6NLB8/AAAAAAAAAAI/AAAAAAAAA_I/hgXs7P28_yk/photo.jpg?sz=128", "display_name": "Ashish Mishra", "link": "https://stackoverflow.com/users/6790808/ashish-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1531894947, "creation_date": 1531894947, "question_id": 51394881, "link": "https://stackoverflow.com/questions/51394881/lscc-chaincode-timeout-error", "title": "lscc chaincode timeout error", "body": "<p>I have a setup, which was working until today. Since morning I 'm not able to create new channels or install new chaincodes. Existing chaincodes are working.\nGetting lscc chaincode timeout error when trying to install new chaincodes or create new channel.</p>\n\n<p>Here are the logs, can someone please help?</p>\n\n<pre><code>2018-07-18 05:44:59.527 UTC [endorser] SimulateProposal -&gt; ERRO 0d0 [][51efedf7] failed to invoke chaincode name:\"lscc\" , error: timeout expired while executing transaction\ngithub.com/hyperledger/fabric/core/chaincode.(*Handler).Execute\n    /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/handler.go:919\ngithub.com/hyperledger/fabric/core/chaincode.(*ChaincodeSupport).execute\n    /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/chaincode_support.go:253\ngithub.com/hyperledger/fabric/core/chaincode.(*ChaincodeSupport).Invoke\n    /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/chaincode_support.go:239\ngithub.com/hyperledger/fabric/core/chaincode.(*ChaincodeSupport).Execute\n    /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/chaincode_support.go:179\ngithub.com/hyperledger/fabric/core/endorser.(*SupportImpl).Execute\n    /opt/gopath/src/github.com/hyperledger/fabric/core/endorser/support.go:141\ngithub.com/hyperledger/fabric/core/endorser.(*Endorser).callChaincode\n    /opt/gopath/src/github.com/hyperledger/fabric/core/endorser/endorser.go:136\ngithub.com/hyperledger/fabric/core/endorser.(*Endorser).SimulateProposal\n    /opt/gopath/src/github.com/hyperledger/fabric/core/endorser/endorser.go:287\ngithub.com/hyperledger/fabric/core/endorser.(*Endorser).ProcessProposal\n    /opt/gopath/src/github.com/hyperledger/fabric/core/endorser/endorser.go:501\ngithub.com/hyperledger/fabric/core/handlers/auth/filter.(*expirationCheckFilter).ProcessProposal\n    /opt/gopath/src/github.com/hyperledger/fabric/core/handlers/auth/filter/expiration.go:61\ngithub.com/hyperledger/fabric/core/handlers/auth/filter.(*filter).ProcessProposal\n    /opt/gopath/src/github.com/hyperledger/fabric/core/handlers/auth/filter/filter.go:31\ngithub.com/hyperledger/fabric/protos/peer._Endorser_ProcessProposal_Handler\n    /opt/gopath/src/github.com/hyperledger/fabric/protos/peer/peer.pb.go:112\ngithub.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).processUnaryRPC\n    /opt/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:923\ngithub.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).handleStream\n    /opt/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:1148\ngithub.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).serveStreams.func1.1\n    /opt/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:637\nruntime.goexit\n    /opt/go/src/runtime/asm_amd64.s:2361\nerror sending\nfailed to execute transaction 51efedf7934af10cc3d6627c85262df4542d3186127c94f2a7156bb0111b2f72\ngithub.com/hyperledger/fabric/core/chaincode.(*ChaincodeSupport).Execute\n    /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/chaincode_support.go:181\ngithub.com/hyperledger/fabric/core/endorser.(*SupportImpl).Execute\n    /opt/gopath/src/github.com/hyperledger/fabric/core/endorser/support.go:141\ngithub.com/hyperledger/fabric/core/endorser.(*Endorser).callChaincode\n    /opt/gopath/src/github.com/hyperledger/fabric/core/endorser/endorser.go:136\ngithub.com/hyperledger/fabric/core/endorser.(*Endorser).SimulateProposal\n    /opt/gopath/src/github.com/hyperledger/fabric/core/endorser/endorser.go:287\ngithub.com/hyperledger/fabric/core/endorser.(*Endorser).ProcessProposal\n    /opt/gopath/src/github.com/hyperledger/fabric/core/endorser/endorser.go:501\ngithub.com/hyperledger/fabric/core/handlers/auth/filter.(*expirationCheckFilter).ProcessProposal\n    /opt/gopath/src/github.com/hyperledger/fabric/core/handlers/auth/filter/expiration.go:61\ngithub.com/hyperledger/fabric/core/handlers/auth/filter.(*filter).ProcessProposal\n    /opt/gopath/src/github.com/hyperledger/fabric/core/handlers/auth/filter/filter.go:31\ngithub.com/hyperledger/fabric/protos/peer._Endorser_ProcessProposal_Handler\n    /opt/gopath/src/github.com/hyperledger/fabric/protos/peer/peer.pb.go:112\ngithub.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).processUnaryRPC\n    /opt/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:923\ngithub.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).handleStream\n    /opt/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:1148\ngithub.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).serveStreams.func1.1\n    /opt/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:637\nruntime.goexit\n    /opt/go/src/runtime/asm_amd64.s:2361\n</code></pre>\n"}, {"tags": ["mysql", "json", "database", "go", "web"], "answers": [{"comments": [{"owner": {"reputation": 256, "user_id": 2159157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c323144a3291bbe0dfc91b4398e4d3?s=128&d=identicon&r=PG", "display_name": "Lobsterman", "link": "https://stackoverflow.com/users/2159157/lobsterman"}, "edited": false, "score": 0, "creation_date": 1569077019, "post_id": 51398842, "comment_id": 102483160, "body": "I believe OP asked about how to deal with json from MySQL (presumably using the json mysql data type). While this addresses how to handle JSON in golang in general, it says nothing about dealing with databases."}], "tags": [], "owner": {"reputation": 104, "user_id": 10070765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G9ZAN.png?s=128&g=1", "display_name": "Zanicar", "link": "https://stackoverflow.com/users/10070765/zanicar"}, "is_accepted": false, "score": -1, "last_activity_date": 1531907279, "creation_date": 1531907279, "answer_id": 51398842, "question_id": 51394852, "link": "https://stackoverflow.com/questions/51394852/reading-json-data-from-mysql-in-golang/51398842#51398842", "title": "Reading Json Data from MySql in Golang?", "body": "<p>A quick hack, not necessarily the most elegant approach, is to use Golang's default JSON Unmarshaler behavior for golang maps:</p>\n\n<pre><code>jstr := `{\"key\": \"userKeyValue\", \"value\": \"userValueValue\"}`\n\n// declare a map that has a key string and value interface{} so that any values or\n// types will be accepted;\njmap := make(map[string]interface{})\n\nerr := json.Unmarshal(jstr, &amp;jmap)\nif err != nil {\n    log.Fatal(err)\n}\n\nfor k, v := range jmap {\n    fmt.Printf(\"Key: %v, Value: %v\\n\", k, v)\n    // If you want to directly work with v remember it is an interface{}\n    // Thus to use it as a string you must v.(string)\n}\n// Will output the following:\n// Key: key, Value: userKeyValue\n// Key: value, Value: userValueValue\n</code></pre>\n\n<p>You can now use standard golang map to manipulate or manage the received data... The more elegant approach is to implement the JSON Marshaler and Unmarshaler interfaces for your declared type. These are described in the golang documentation: <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/encoding/json/</a></p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 294249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04091ab3975a72fd2ee7acad151344e0?s=128&d=identicon&r=PG", "display_name": "JediMind", "link": "https://stackoverflow.com/users/294249/jedimind"}, "is_accepted": false, "score": 1, "last_activity_date": 1590738475, "creation_date": 1590738475, "answer_id": 62081108, "question_id": 51394852, "link": "https://stackoverflow.com/questions/51394852/reading-json-data-from-mysql-in-golang/62081108#62081108", "title": "Reading Json Data from MySql in Golang?", "body": "<p>You can use the JSON Unmarshaler interface, but depending on how you are retrieving the data from MySql, will vary your implementation. But the idea is the same. For this example, I use <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"nofollow noreferrer\">https://github.com/go-sql-driver/mysql</a> and assuming you want to store the data in an actual JSON field (Mysql >= 5.7), you could do something like this:</p>\n\n<pre><code>type MyField struct {\n    Key string `json:\"key\"`\n    Value string `json:\"value\"`\n}\n\ntype MyModel struct {\n    ID uint64\n    MyFieldName MyField `json:\"my_field_name\"`\n}\n\n\nfunc (m *MyField) Scan(src interface{}) error {\n    // The data stored in a JSON field is actually returned as []uint8\n    val := src.([]uint8)\n    return json.Unmarshal(val, &amp;m)\n}\n\nfunc main() {\n    db, err := sql.Open(\"mysql\", \"root:password@tcp(127.0.0.1)/dbname\")\n    if err != nil {\n        panic(err.Error())\n    }\n    defer db.Close()\n\n    results, err := db.Query(\"SELECT id, my_field_name FROM my_table\")\n\n    if err != nil {\n        panic(err.Error())\n    }\n\n    for results.Next() {\n        var row MyModel\n        err := results.Scan(&amp;row.ID, &amp;row.MyFieldName)\n        if err != nil {\n            panic(err.Error())\n        }\n        fmt.Println(row.MyFieldName.Key)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 8800020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdcb019d5421cb1a585d2dccf6698a0d?s=128&d=identicon&r=PG", "display_name": "user8800020", "link": "https://stackoverflow.com/users/8800020/user8800020"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1266, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1590738475, "creation_date": 1531894811, "last_edit_date": 1531899666, "question_id": 51394852, "link": "https://stackoverflow.com/questions/51394852/reading-json-data-from-mysql-in-golang", "title": "Reading Json Data from MySql in Golang?", "body": "<p>I am facing a case where I had to store dynamic values in the database with key and value pairs given by the user itself. </p>\n\n<p>User gives the key and value, and I interpret it as </p>\n\n<p><code>{\"key\": \"user Given\", \"value\": \"user Given\"}</code></p>\n\n<p>and I add all such things to an array, and I want this array to be read into Go code where the <em>array of objects</em> is read from the Database  table.</p>\n"}, {"tags": ["go", "hashmap"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10097192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GYMDl.jpg?s=128&g=1", "display_name": "Liam Murnux", "link": "https://stackoverflow.com/users/10097192/liam-murnux"}, "edited": false, "score": 0, "creation_date": 1531920841, "post_id": 51396404, "comment_id": 89777655, "body": "Thank you for a clear explanation regarding the ticker, I implemented your solution and is working as intended. Thanks again. :)"}], "tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": true, "score": 0, "last_activity_date": 1531900117, "creation_date": 1531900117, "answer_id": 51396404, "question_id": 51393608, "link": "https://stackoverflow.com/questions/51393608/running-code-every-x-seconds-using-map-from-database/51396404#51396404", "title": "Running code every x seconds using map from database", "body": "<p>Your problem is in this function:</p>\n\n<pre><code>func TimedCommands(conn net.Conn, channel string, name string) {\n    timedcoms := LoadTimedCommands()\n    for k, v := range timedcoms {\n        for range time.NewTicker(v * time.Second).C {\n            BotSendMsg(conn, channel, k, name)\n        }\n    }\n}\n</code></pre>\n\n<p>In this section, where you <code>range</code> over the channel <code>time.NewTicker(...).C</code>:</p>\n\n<pre><code>for range time.NewTicker(v * time.Second).C {\n    BotSendMsg(conn, channel, k, name)\n}\n</code></pre>\n\n<p>This will try and read values from this <strong>one</strong> ticker until the channel <code>C</code> is closed. This means that the outer loop only does one iteration, then we block on the inner loop until <code>C</code> is closed. And we never create more than one <code>Ticker</code> at once.</p>\n\n<p>You could get around this by creating tickers in their own goroutines:</p>\n\n<pre><code>for k, v := range timedcoms {\n    go func(conn net.Conn, channel, name, k string, v time.Duration) {\n        for range time.NewTicker(v * time.Second).C {\n            BotSendMsg(conn, channel, k, name)\n        }\n    }(conn, channel, k, v)\n}\n</code></pre>\n\n<p>But you will probably want to include some synchronisation to ensure that you can stop the goroutines that you start, or to ensure that <code>BotSendMsg(...)</code> can be called from multiple goroutines at the same time etc.</p>\n"}], "owner": {"reputation": 31, "user_id": 10097192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GYMDl.jpg?s=128&g=1", "display_name": "Liam Murnux", "link": "https://stackoverflow.com/users/10097192/liam-murnux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 51396404, "answer_count": 1, "score": 1, "last_activity_date": 1531992015, "creation_date": 1531888141, "last_edit_date": 1531992015, "question_id": 51393608, "link": "https://stackoverflow.com/questions/51393608/running-code-every-x-seconds-using-map-from-database", "title": "Running code every x seconds using map from database", "body": "<p>Using golang's time.NewTicker, I am trying to run each record from a database (consisting of text and a timer, i.e the number of seconds before it repeats) but it is only repeating the first record it grabs</p>\n\n<pre><code>func LoadTimedCommands() map[string]time.Duration {\n    database := InitializeDB()\n\n    rows, _ := database.Query(\"SELECT TimedResponse, Timer from timedcommands\")\n\n    com := make(map[string]time.Duration)\n    for rows.Next() {\n        var TimedResponse string\n        var Timer time.Duration\n        rows.Scan(&amp;TimedResponse, &amp;Timer)\n        com[TimedResponse] = Timer\n    }\n    return com\n}\n\nfunc TimedCommands(conn net.Conn, channel string, name string) {\n    timedcoms := LoadTimedCommands()\n    for k, v := range timedcoms {\n        for range time.NewTicker(v * time.Second).C {\n            BotSendMsg(conn, channel, k, name)\n        }\n    }\n}\n</code></pre>\n\n<p>So if I have two records to use from:\n<a href=\"https://i.stack.imgur.com/iCxnQ.png\" rel=\"nofollow noreferrer\">Sqlite data</a></p>\n\n<p>Then the code should run the first record every 15 seconds, and the second every 10. But again, only the first one that is loaded into the map is run.</p>\n"}, {"tags": ["go", "go-flag"], "answers": [{"comments": [{"owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "edited": false, "score": 0, "creation_date": 1531878535, "post_id": 51392338, "comment_id": 89756674, "body": "Thank you so much!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1531878253, "last_edit_date": 1531878253, "creation_date": 1531877788, "answer_id": 51392338, "question_id": 51392322, "link": "https://stackoverflow.com/questions/51392322/value-returned-by-flags-into-my-struct/51392338#51392338", "title": "value returned by flags into my struct", "body": "<p>Use the <code>*Var</code> methods to set set values to existing variables from flags, in this case you want <a href=\"https://golang.org/pkg/flag/#StringVar:\" rel=\"nofollow noreferrer\"><code>flag.StringVar</code></a></p>\n\n<pre><code>destDbCfg = &amp;dbhelper.DbConfig{}\n\nflag.StringVar(&amp;destDbCfg.Database, \"destDBName\", \"\", \"Destination DB Database Name\")\nflag.Parse()\n</code></pre>\n"}], "owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531889931, "creation_date": 1531877659, "last_edit_date": 1531889931, "question_id": 51392322, "link": "https://stackoverflow.com/questions/51392322/value-returned-by-flags-into-my-struct", "title": "value returned by flags into my struct", "body": "<p>How can I assign the string value returned by flag into my struct?  I have the following code.</p>\n\n<pre><code>destDbCfg = &amp;dbhelper.DbConfig {}\n\ndestDbCfg.Database = flag.String( \"destDBName\", \"\", \"Destination DB Database Name\")\nflag.Parse()\n</code></pre>\n\n<p>Database is a string</p>\n"}, {"tags": ["docker", "go", "networking", "protocol-buffers", "grpc"], "comments": [{"owner": {"reputation": 1183, "user_id": 4274484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0dPT2.jpg?s=128&g=1", "display_name": "hypnoglow", "link": "https://stackoverflow.com/users/4274484/hypnoglow"}, "edited": false, "score": 0, "creation_date": 1532017963, "post_id": 51392236, "comment_id": 89826759, "body": "&gt; Now I run the container without port mapping. Why would you do this? And what are you trying to achieve? If you remove the port mapping, you can access that container only from the docker network (e.g. from another container in the same network), and this network can be configured in different ways."}], "owner": {"reputation": 27, "user_id": 6939771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qu5yl.jpg?s=128&g=1", "display_name": "AerysNan", "link": "https://stackoverflow.com/users/6939771/aerysnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 259, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1531877040, "creation_date": 1531877040, "question_id": 51392236, "link": "https://stackoverflow.com/questions/51392236/error-when-trying-to-connect-to-docker-container-using-grpc", "title": "Error when trying to connect to docker container using grpc", "body": "<p>I try to connect to a docker container using golang grpc but run into the following problem. OS I use is Linux.</p>\n\n<p>My .proto file appears like this:</p>\n\n<pre><code>syntax = \"proto3\"; \npackage reverse;\nservice Reverse {\n    rpc Do(Request) returns (Response) {}\n}\nmessage Request {\n    string message = 1;\n}\nmessage Response {\n    string message = 1;\n}\n</code></pre>\n\n<p>Client main.go:</p>\n\n<pre><code>func main() {\n    opts := []grpc.DialOption{\n        grpc.WithInsecure(),\n        grpc.WithBlock(),\n    }\n    args := os.Args\n    conn, err := grpc.Dial(\"127.0.0.1:5300\", opts...)\n    if err != nil {\n        grpclog.Fatalf(\"fail to dial: %v\", err)\n    }\n    defer conn.Close()\n    log.Info(\"Connect finished\")\n    client := pb.NewReverseClient(conn)\n    request := &amp;pb.Request{\n        Message: args[1],\n    }\n    response, err := client.Do(context.Background(), request)\n    if err != nil {\n        grpclog.Fatalf(\"fail to dial: %v\", err)\n    }\n    fmt.Println(response.Message)\n}\n</code></pre>\n\n<p>Server main.go:</p>\n\n<pre><code>func main() {\n    listener, err := net.Listen(\"tcp\", \":5300\")\n    if err != nil {\n        grpclog.Fatalf(\"failed to listen: %v\", err)\n    }\n    opts := []grpc.ServerOption{}\n    grpcServer := grpc.NewServer(opts...)\n    pb.RegisterReverseServer(grpcServer, &amp;server{})\n    grpcServer.Serve(listener)\n}\ntype server struct{}\nfunc (s *server) Do(c context.Context, request *pb.Request) (response *pb.Response, err error) {\n    n := 0\n    rune := make([]rune, len(request.Message))\n    for _, r := range request.Message {\n        rune[n] = r\n        n++\n    }\n    rune = rune[0:n]\n    for i := 0; i &lt; n/2; i++ {\n        rune[i], rune[n-1-i] = rune[n-1-i], rune[i]\n    }\n    output := string(rune)\n    response = &amp;pb.Response{\n        Message: output,\n    }\n    return response, nil    \n}\n</code></pre>\n\n<p>It is expected that the client can receive the reverse of the string passed by command line argument. This works fine, and I try to pack the server into a docker image.\nDockerfile:</p>\n\n<pre><code>FROM scratch\nADD . /bin/\nENTRYPOINT [\"/bin/server\"]\nEXPOSE 5300\n</code></pre>\n\n<p>Here is my problem: When I run the docker container with argument <code>-p 5300:5300</code> then the correct value can be returned. Now I run the container without port mapping. I find the container's IP address by <code>docker inspect</code> and its address is 172.17.0.2. Then I change the IP address in <code>grpc.Dial</code> function in Client main.go to 172.17.0.2. I run the client again and find the program is stuck at <code>client.Do</code> function. So what I want to ask is that how can I connect to docker container using direct IP address?</p>\n"}, {"tags": ["loops", "for-loop", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 6, "creation_date": 1531859192, "post_id": 51389665, "comment_id": 89751396, "body": "<code>text</code> is a nil slice, so it doesn&#39;t contain any data. What is it you expected to see?"}, {"owner": {"reputation": 47, "user_id": 6460289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce48cfad1c713deffe5e0fd7953db8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/6460289/priyanka"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531859537, "post_id": 51389665, "comment_id": 89751555, "body": "I am actually, trying to convert the following to go.."}, {"owner": {"reputation": 47, "user_id": 6460289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce48cfad1c713deffe5e0fd7953db8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/6460289/priyanka"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531859541, "post_id": 51389665, "comment_id": 89751558, "body": "text = new long[text]; Var num = 4                          for (int i=0; i&lt;num; i++)         {             text[I] = 0; \t    if num &gt; 1 { \t\t//above code \t\t} \t}"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1531859690, "post_id": 51389665, "comment_id": 89751634, "body": "<code>text = new long[text]; </code> wot?"}, {"owner": {"reputation": 47, "user_id": 6460289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce48cfad1c713deffe5e0fd7953db8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/6460289/priyanka"}, "edited": false, "score": 0, "creation_date": 1531859831, "post_id": 51389665, "comment_id": 89751694, "body": "text = new long[num];"}, {"owner": {"reputation": 47, "user_id": 6460289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce48cfad1c713deffe5e0fd7953db8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/6460289/priyanka"}, "edited": false, "score": 0, "creation_date": 1531859840, "post_id": 51389665, "comment_id": 89751699, "body": "sorry , that was a typo"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1531859909, "post_id": 51389665, "comment_id": 89751729, "body": "@Priyanka: don&#39;t put code in the comments. Update your question with the relevant information."}, {"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 0, "creation_date": 1531859937, "post_id": 51389665, "comment_id": 89751745, "body": "Please tell us what your goal is. We don&#39;t know what you&#39;re trying to do."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1531859950, "post_id": 51389665, "comment_id": 89751747, "body": "and <code>num</code> is undefined at that point. Do you have a complete and working piece of java(I presume) code that we can work of?"}, {"owner": {"reputation": 47, "user_id": 6460289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce48cfad1c713deffe5e0fd7953db8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/6460289/priyanka"}, "edited": false, "score": 0, "creation_date": 1531860390, "post_id": 51389665, "comment_id": 89751949, "body": "The goal is to convert the above java code to go"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1531877354, "last_edit_date": 1531877354, "creation_date": 1531874528, "answer_id": 51391963, "question_id": 51389665, "link": "https://stackoverflow.com/questions/51389665/multiple-initialization-in-golang/51391963#51391963", "title": "Multiple initialization in golang", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Index_expressions\" rel=\"nofollow noreferrer\">Index expressions</a></p>\n  \n  <p>For a slice <code>a</code>, <code>a[x]</code> denotes the element of the slice <code>a</code> indexed by <code>x</code>.\n  The index <code>x</code> is in range if <code>0 &lt;= x &lt; len(a)</code>, otherwise it is out of\n  range.</p>\n</blockquote>\n\n<hr>\n\n<p>The variables <code>i</code> and <code>j</code> are indexes for the slice <code>text</code>. They must always be within range: <code>0 &lt;= i &lt; len(text)</code> and <code>0 &lt;= j &lt; len(text)</code>. Since <code>i &lt; j</code>, that simplifies to <code>0 &lt;= i</code> and<code>j &lt; len(text)</code>.</p>\n\n<p>For your Go example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar text []int64\n\nfunc main() {\n    for i, j := 0, 1; i &lt; 4 &amp;&amp; j &lt; len(text); i, j = i+1, j+1 {\n        fmt.Println(\"Value of i, j:\", i, j)\n        fmt.Println(text[j])\n    }\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/02r_VY9VMa5\" rel=\"nofollow noreferrer\">https://play.golang.org/p/02r_VY9VMa5</a></p>\n"}], "owner": {"reputation": 47, "user_id": 6460289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce48cfad1c713deffe5e0fd7953db8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/6460289/priyanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 1, "accepted_answer_id": 51391963, "answer_count": 1, "score": -5, "last_activity_date": 1531877354, "creation_date": 1531859102, "last_edit_date": 1531874877, "question_id": 51389665, "link": "https://stackoverflow.com/questions/51389665/multiple-initialization-in-golang", "title": "Multiple initialization in golang", "body": "<p>Following id the code snippet</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar text []int64\n\nfunc main() {\n\n    for i, j := 0, 1; i &lt; 4; i, j = i+1, j+1 {\n        fmt.Println(\"Value of i, j:\", i, j)\n        fmt.Println(text[j])\n    }\n\n}\n</code></pre>\n\n<p>And it shows the following error;</p>\n\n<pre><code>Value of i, j: 0 1\npanic: runtime error: index out of range\n\ngoroutine 1 [running]:\nmain.main()\n    /home/cg/root/6063741/main.go:13 +0x268\nexit status 2\n</code></pre>\n\n<p>I wanted to know how to resolve this error.</p>\n\n<p>Thanks</p>\n\n<p>Here is the java code that I am trying to convert to go;</p>\n\n<pre><code>long    text[]; \nint     num        = 1\n\ntext = new long[num];\n\nfor (int i=0; i&lt;num; i++)\n        {\n            text[i] = 0;\n        // do something\n}\nif (num &gt; 1) {\n            for (int i=0,j=1; i&lt;numSubs; i++,j++) {\n        // do something\n        System.out.Println(text[i]\n)\n       }\n}\n</code></pre>\n"}, {"tags": ["debugging", "go", "func"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1531860044, "post_id": 51389608, "comment_id": 89751788, "body": "&quot;any way to run a go script&quot; no such thing. Go is not a scripting language. Go is only executable compiled down to a complete native binary. Trying to write Go programs like bash scripts (or anything else besides Go) will only lead to frustration."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 6746717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Y_vxMHCybSk/AAAAAAAAAAI/AAAAAAAAAFU/2oZypfKPxSU/photo.jpg?sz=128", "display_name": "Ilie Soltanici", "link": "https://stackoverflow.com/users/6746717/ilie-soltanici"}, "edited": false, "score": 0, "creation_date": 1531861809, "post_id": 51390047, "comment_id": 89752591, "body": "Mihailo, your solution is very close to what I&#39;m looking for. Just, by using this method I&#39;m getting the line number inside the logHandler function, but what i&#39;m looking for - is to get it from the main function, so in your example it actually should be number &#39;11&#39; instead of &#39;23&#39;."}, {"owner": {"reputation": 135, "user_id": 6746717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Y_vxMHCybSk/AAAAAAAAAAI/AAAAAAAAAFU/2oZypfKPxSU/photo.jpg?sz=128", "display_name": "Ilie Soltanici", "link": "https://stackoverflow.com/users/6746717/ilie-soltanici"}, "edited": false, "score": 0, "creation_date": 1531862751, "post_id": 51390047, "comment_id": 89752950, "body": "Mihailo, Great!, that&#39;s exactly what i&#39;m looking for. Thank you a lot!"}, {"owner": {"reputation": 3784, "user_id": 6182569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/595afc3cb368ac51e5643e7e71dfdb4d?s=128&d=identicon&r=PG", "display_name": "Mihailo", "link": "https://stackoverflow.com/users/6182569/mihailo"}, "reply_to_user": {"reputation": 135, "user_id": 6746717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Y_vxMHCybSk/AAAAAAAAAAI/AAAAAAAAAFU/2oZypfKPxSU/photo.jpg?sz=128", "display_name": "Ilie Soltanici", "link": "https://stackoverflow.com/users/6746717/ilie-soltanici"}, "edited": false, "score": 0, "creation_date": 1531862792, "post_id": 51390047, "comment_id": 89752968, "body": "Great! Glad I could help."}], "tags": [], "owner": {"reputation": 3784, "user_id": 6182569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/595afc3cb368ac51e5643e7e71dfdb4d?s=128&d=identicon&r=PG", "display_name": "Mihailo", "link": "https://stackoverflow.com/users/6182569/mihailo"}, "is_accepted": true, "score": 2, "last_activity_date": 1531862763, "last_edit_date": 1531862763, "creation_date": 1531860884, "answer_id": 51390047, "question_id": 51389608, "link": "https://stackoverflow.com/questions/51389608/golang-debug-function/51390047#51390047", "title": "Golang Debug Function", "body": "<p>Here's one elegant way you can do it.</p>\n\n<p>We'll be using the <strong><code>runtime</code></strong> package, here's how:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n)\n\nfunc main() {\n    logHandler(\"warning\", \"Test Function\")\n    logHandler(\"error\", \"Test Function\")\n    logHandler(\"debug\", \"Test Function\")\n}\n\nfunc logHandler(t, e string) {\n    switch t {\n    case \"warning\":\n        fmt.Println(\"WARNING |\", e)\n    case \"error\":\n        fmt.Println(\"ERROR   |\", e)\n    case \"debug\":\n        // 0 = This function\n        // 1 = Function that called this function\n        _, fn, line, _ := runtime.Caller(1)\n        fmt.Printf(\"DEBUG   | %s:%d | %v\\n\", fn, line, e)\n    }\n}\n</code></pre>\n\n<blockquote>\n  <p>Outputs:</p>\n</blockquote>\n\n<pre><code>WARNING | Test Function\nERROR   | Test Function\nDEBUG   | /home/runner/main.go:11 | Test Function\n</code></pre>\n\n<h3><a href=\"https://repl.it/@mihailo_misic/runtime-debug\" rel=\"nofollow noreferrer\">Working example link</a></h3>\n\n<hr>\n\n<p>You could basically do this for all of them <em>(warning and debug)</em></p>\n\n<p>If you're interested here's some additional reading regarding the <strong><a href=\"https://golang.org/pkg/runtime/\" rel=\"nofollow noreferrer\">runtime package</a></strong>.</p>\n\n<hr>\n\n<p><em>Inspired by <a href=\"https://stackoverflow.com/a/24809646/6182569\">this great answer</a> from <a href=\"https://stackoverflow.com/users/145587/oneofone\">OneOfOne</a>.</em></p>\n"}], "owner": {"reputation": 135, "user_id": 6746717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Y_vxMHCybSk/AAAAAAAAAAI/AAAAAAAAAFU/2oZypfKPxSU/photo.jpg?sz=128", "display_name": "Ilie Soltanici", "link": "https://stackoverflow.com/users/6746717/ilie-soltanici"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "accepted_answer_id": 51390047, "answer_count": 1, "score": 4, "last_activity_date": 1531862763, "creation_date": 1531858881, "question_id": 51389608, "link": "https://stackoverflow.com/questions/51389608/golang-debug-function", "title": "Golang Debug Function", "body": "<p>Coming from shell programming, where i used a lot such function:</p>\n\n<pre><code>log_action() {\ncase \"${1}\" in\n'ERROR')\n    EXIT_CODE=\"${3}\"\n    echo \"[${1}] | $(date +\"%T\") | ${2} | Exiting (${EXIT_CODE})\"\n    exit ${EXIT_CODE};\n;;\n'WARNING')\n    echo \"[${1}] | $(date +\"%T\") | ${2} | Line: (${3})\"\n;;\n'DEBUG')\n    if [[ ${DEBUG} -eq \"1\" ]]; then {\n    echo \"[${1}] | $(date +\"%T\") | ${2} | ${3}\"\n    }; fi\n;;\n*)\n    echo \"[${1}] | $(date +\"%T\") | ${2} | ${3}\"\n;;\nesac\n}\n\n\nlog_action \"WARNING\" \"Cannot Connect to MySQL Database\" \"${LINENO}\")\n</code></pre>\n\n<p>Now, i started to learn golang and will like to convert all bash scripts to go. So, I need the same function to use in golang, i tried the following:</p>\n\n<pre><code>func logHandler(t string, e string, l string) {\n    switch t {\n    case \"warning\":\n        fmt.Println(\"WARNING\")\n    case \"error\":\n        fmt.Println(\"ERROR\")\n    case \"debug\":\n        fmt.Println(\"DEBUG |\", e, l)\n    }\n}\n\nlogHandler(\"debug\", \"Test Function\", \"LineNumber\")\n</code></pre>\n\n<p>but i don't know how to get the current linenumber variable (LineNumber) when calling logHandler function and pass it to the function as string or as int.</p>\n\n<p>Also, is there any way to run a go script in trace mode like in bash option: set -o xtrace?</p>\n\n<p>I'm just a beginner so if i'm doing something wrong please point me to the right direction.\nThank You.</p>\n"}, {"tags": ["go", "exception-handling"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1531858163, "post_id": 51389364, "comment_id": 89750915, "body": "Go does not have exceptions, it&#39;s not for performance reasons, and no one has &quot;implemented a few&quot;. What exactly are you referring to?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1531858247, "post_id": 51389364, "comment_id": 89750953, "body": "Everything supported by the Go language is in the spec: <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">golang.org/ref/spec</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7336312"}, "edited": false, "score": 0, "creation_date": 1531858318, "post_id": 51389364, "comment_id": 89750984, "body": "I&#39;m referring to the current exception support in Go. If it has exceptions or not."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7336312"}, "edited": false, "score": 0, "creation_date": 1531858800, "post_id": 51389567, "comment_id": 89751220, "body": "Very nice answer. Thanks."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1531898974, "post_id": 51389567, "comment_id": 89763161, "body": "A sort-of obligatory reference to an essay which provides factual evidence for why a language&#39;s designers may chose not to have exceptions is <a href=\"http://250bpm.com/blog:4\" rel=\"nofollow noreferrer\">this</a> ;-)"}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 3, "last_activity_date": 1531858659, "creation_date": 1531858659, "answer_id": 51389567, "question_id": 51389364, "link": "https://stackoverflow.com/questions/51389364/exception-support-in-go-programming-language/51389567#51389567", "title": "Exception support in Go programming language", "body": "<p>Go does not have exceptions, and <a href=\"https://golang.org/doc/faq#exceptions\" rel=\"nofollow noreferrer\">that is a design decision</a>, not based on performance:</p>\n\n<blockquote>\n  <p>We believe that coupling exceptions to a control structure, as in the try-catch-finally idiom, results in convoluted code. It also tends to encourage programmers to label too many ordinary errors, such as failing to open a file, as exceptional.</p>\n  \n  <p>Go takes a different approach. For plain error handling, Go's multi-value returns make it easy to report an error without overloading the return value. A canonical error type, coupled with Go's other features, makes error handling pleasant but quite different from that in other languages.</p>\n</blockquote>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7336312"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "accepted_answer_id": 51389567, "answer_count": 1, "score": -4, "last_activity_date": 1531858659, "creation_date": 1531857710, "question_id": 51389364, "link": "https://stackoverflow.com/questions/51389364/exception-support-in-go-programming-language", "title": "Exception support in Go programming language", "body": "<p>Some sources says that Go does not support exceptions for performance reasons, but some others says that Google Team implemented a few. What is the current exception support in Go?</p>\n"}, {"tags": ["go", "queue", "boltdb"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1531856800, "post_id": 51388621, "comment_id": 89750290, "body": "If you&#39;re using <code>NextSequence</code> to generate keys, they&#39;ll already be in order."}, {"owner": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531909273, "post_id": 51388621, "comment_id": 89769806, "body": "@Adrian sweet? Shall I still convert that uint64 to byte array using the Big endian function? Thanks"}], "owner": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 214, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531854424, "creation_date": 1531854424, "question_id": 51388621, "link": "https://stackoverflow.com/questions/51388621/sortedness-of-bolt-db-items", "title": "Sortedness of Bolt DB items", "body": "<p>I am planning on implementing a queue and persisting the objects into a Bolt DB instance. I was wondering how to determine the sortedness of the items when reloading my application and determining head/tail.</p>\n\n<p>To quote the Bolt DB project on insertion of items to a bucket:</p>\n\n<blockquote>\n  <p>Bolt stores its keys in byte-sorted order within a bucket</p>\n</blockquote>\n\n<p>So basically the keys for the DB are byte [arrays] and sorted. I see an implementation online that uses the following line to convert an int to a byte array in little endian.</p>\n\n<pre><code>key := make([]byte, 8)\nbinary.BigEndian.PutUint64(key, id)\n</code></pre>\n\n<p>What other ways are there to convert the keys to byte arrays for sortedness?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "ethereum"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531850982, "post_id": 51386896, "comment_id": 89747496, "body": "This is a <code>git</code> issue. The command printing the error is <code>git pull --ff-only</code>. Fix or remove that checkout."}, {"owner": {"reputation": 2066, "user_id": 6363050, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f9db389fc3801b8ecef05ed3074e2f03?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Dare", "link": "https://stackoverflow.com/users/6363050/samuel-dare"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531852723, "post_id": 51386896, "comment_id": 89748326, "body": "Thanks for this. Not sure how to fix the check out. Should I report it as a bug or would you be able to give some guidance ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531852781, "post_id": 51386896, "comment_id": 89748353, "body": "If you don&#39;t know how to use git, just delete the directory and <code>go get</code> will fetch it again."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1531854299, "post_id": 51386896, "comment_id": 89749063, "body": "Did you do something inappropriate such as make your entire GOPATH a single git repository?"}, {"owner": {"reputation": 2066, "user_id": 6363050, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f9db389fc3801b8ecef05ed3074e2f03?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Dare", "link": "https://stackoverflow.com/users/6363050/samuel-dare"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1531864945, "post_id": 51386896, "comment_id": 89753683, "body": "@MichaelHampton newbie here can you please expand on this?"}, {"owner": {"reputation": 2066, "user_id": 6363050, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f9db389fc3801b8ecef05ed3074e2f03?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Dare", "link": "https://stackoverflow.com/users/6363050/samuel-dare"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531864959, "post_id": 51386896, "comment_id": 89753687, "body": "@JimB deleted it , but its still not working"}, {"owner": {"reputation": 2066, "user_id": 6363050, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f9db389fc3801b8ecef05ed3074e2f03?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Dare", "link": "https://stackoverflow.com/users/6363050/samuel-dare"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1531865034, "post_id": 51386896, "comment_id": 89753702, "body": "@MichaelHampton the git file are in the github.com folder in the $GOPATH dont think I have messed with these"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531865231, "post_id": 51386896, "comment_id": 89753771, "body": "@Data_Kid: you should not have any git files in <code>$GOPATH&#47;src&#47;github.com</code>. I don&#39;t know how you got to this state, but you might need to just wipe the GOPATH and start over."}, {"owner": {"reputation": 2066, "user_id": 6363050, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f9db389fc3801b8ecef05ed3074e2f03?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Dare", "link": "https://stackoverflow.com/users/6363050/samuel-dare"}, "edited": false, "score": 0, "creation_date": 1531865766, "post_id": 51386896, "comment_id": 89753918, "body": "Apologies they arent there but in the package ie. $GOPATH/src/github.com/ethereum/go-ethereum"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531924598, "post_id": 51402247, "comment_id": 89780403, "body": "You should not have changes in that directory at all. If you&#39;re using the upstream package, then your checkout should match that source. Keeping the modifications is only delaying problems for later."}], "tags": [], "owner": {"reputation": 2066, "user_id": 6363050, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f9db389fc3801b8ecef05ed3074e2f03?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Dare", "link": "https://stackoverflow.com/users/6363050/samuel-dare"}, "is_accepted": true, "score": 0, "last_activity_date": 1531917523, "creation_date": 1531917523, "answer_id": 51402247, "question_id": 51386896, "link": "https://stackoverflow.com/questions/51386896/unable-to-install-package/51402247#51402247", "title": "Unable to install package", "body": "<p>I was able to solve this by doing the following:</p>\n\n<ul>\n<li><code>cd /Users/pro/go/src/golang.org/x/tools</code> (This is the repo that had the issues)</li>\n<li>Run <code>git stash save &amp;&amp; git merge origin/master &amp;&amp; git stash pop</code></li>\n<li>Run <code>make devtools</code> (The make file contains the instructions for installing abigen and placing it in <code>usr/bin</code></li>\n</ul>\n\n<p>I got help from this answer:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/14318234/how-do-i-ignore-an-error-on-git-pull-about-my-local-changes-would-be-overwritt\">How do I ignore an error on &#39;git pull&#39; about my local changes would be overwritten by merge?</a></p>\n"}], "owner": {"reputation": 2066, "user_id": 6363050, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f9db389fc3801b8ecef05ed3074e2f03?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Dare", "link": "https://stackoverflow.com/users/6363050/samuel-dare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 51402247, "answer_count": 1, "score": -1, "last_activity_date": 1531917523, "creation_date": 1531847285, "last_edit_date": 1531847916, "question_id": 51386896, "link": "https://stackoverflow.com/questions/51386896/unable-to-install-package", "title": "Unable to install package", "body": "<p>Initially posted this on the Ethereum forum but feel that there might be more knowledge of the issue here as it is a Golang/git package installation issue</p>\n\n<hr>\n\n<p>I am trying to compile smart contracts using the go-ethereum client.</p>\n\n<p>I have go installed on my pc and installed ran the following commands:</p>\n\n<pre><code>go get -u github.com/ethereum/go-ethereum \ncd $GOPATH/src/github.com/ethereum/go-ethereum/ \nmake\n</code></pre>\n\n<p>Which all work fine.</p>\n\n<p>When I run </p>\n\n<pre><code>make devtools\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>Pros-MacBook-Pro:go-ethereum Santi$ make devtools\nenv GOBIN= go get -u golang.org/x/tools/cmd/stringer\n# cd /Users/pro/go/src/golang.org/x/tools; git pull --ff-only\nerror: Your local changes to the following files would be overwritten by merge:\n        CONTRIBUTING.md\n        blog/blog.go\n        cmd/godoc/autocert.go\n        cmd/godoc/blog.go\n        cmd/godoc/godoc_test.go\n        cmd/godoc/handlers.go\n        cmd/godoc/main.go\n        cmd/godoc/x.go\n        cmd/goimports/goimports.go\n        cmd/gomvpkg/main.go\n        cmd/goyacc/yacc.go\n        cmd/guru/guru.go\n        cmd/guru/guru_test.go\n        cmd/guru/main.go\n        cmd/guru/referrers.go\n        cmd/guru/testdata/src/referrers/int_test.go\n        cmd/guru/testdata/src/referrers/main.go\n        cmd/guru/testdata/src/referrers/main.golden\n        cmd/present/static/styles.css\n        cmd/present/templates/slides.tmpl\n        cmd/stringer/endtoend_test.go\n        cmd/stringer/stringer.go\n        cmd/tip/tip.go\n        go/ast/astutil/imports.go\n        go/ast/astutil/imports_test.go\n        go/buildutil/allpackages_test.go\n        go/buildutil/fakecontext.go\n        go/buildutil/util_test.go\n        go/gcexportdata/example_test.go\n        go/gcexportdata/gcexportdata.go\n        go/gcexportdata/main.go\n        go/gcimporter15/bexport.go\n        go/gcimporter15/bexport19_test.go\n        go/gcimporter15/bexport_test.go\n        go/gcimporter15/bimport.go\n        go/gcimporter15/exportdata.go\n        go/gcimporter15/gcimporter.go\n        go/gcimporter15/gcimporter_test.go\n        go/gcimporter15/isAlias18.go\n        go/gcimporter15/isAlias19.go\n        go/gcimporter15/testdata/a.go\n        go/gcimporter15/testdata/b.go\n        go/gcimporter15/testdata/exports.go\n        go/gcimporter15/testdata/issue15920.go\n        go/gcimporter15/testdata/issue20046.go\n        go/gcimporter15/testdata/p.go\n        go/gcimporter15/testdata/versions/test.go\n        go/gcimporter15/testdata/versions/test_go1.7_0.a\n        go/gcimporter15/testdata/versions/test_go1.7_1.a\n        go/internal/gccgoimporter/gccgoinstallation_test.go\n        go/internal/gccgoimporter/importer_test.go\n        go/internal/gccgoimporter/parser.go\n        go/loader/loader_test.go\n        go/ssa/interp/external.go\n        go/ssa/ssa.go\n        go/vcs/vcs.go\n        go/vcs/vcs_test.go\n        godoc/cmdline.go\n        godoc/cmdline_test.go\n        godoc/dirtrees.go\n        godoc/dl/dl.go\n        godoc/godoc.go\n        godoc/index.go\n        godoc/pres.go\n        godoc/server.go\n        godoc/spec.go\n        godoc/static/gen.go\n        godoc/static/godoc.html\n        godoc/static/godocs.js\n        godoc/static/makestatic.go\n        godoc/static/package.html\n        godoc/static/playground.js\n        godoc/static/static.go\n        godoc/static/style.css\n        godoc/template.go\n        godoc/vfs/emptyvfs.go\n        godoc/vfs/gatefs/gatefs.go\n        godoc/vfs/mapfs/mapfs.go\n        godoc/vfs/namespace.go\n        godoc/vfs/os.go\n        godoc/vfs/vfs.go\n        godoc/vfs/zipfs/zipfs.go\n        imports/fastwalk.go\n        imports/fastwalk_dirent_fileno.go\n        imports/fastwalk_dirent_ino.go\n        imports/fastwalk_portable.go\n        imports/fastwalk_test.go\n        imports/fastwalk_unix.go\n        imports/fix.go\n        imports/fix_test.go\n        imports/imports.go\n        imports/sortimports.go\n        present/parse.go\n        refactor/eg/eg.go\n        refactor/eg/eg_test.go\n        refactor/eg/rewrite.go\n        refactor/eg/testdata/no_after_return.template\n        refactor/rename/rename.go\nPlease commit your changes or stash them before you merge.\nAborting\nUpdating 73e16cff..d74aaa1f\npackage golang.org/x/tools/cmd/stringer: exit status 1\nmake: *** [devtools] Error 1\n</code></pre>\n\n<p>Hoping that this wasnt too serious, I tries creating my go file with the following line:</p>\n\n<pre><code>abigen -abi=Store.abi --pkg=store --out=Store.go\nbash: abigen: command not found\n</code></pre>\n\n<p>I suspect this has to do with my failed install and will appreciate any pointers on this</p>\n"}, {"tags": ["security", "authentication", "go", "configuration", "go-templates"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1531849721, "post_id": 51386455, "comment_id": 89746866, "body": "Whether or not a struct field is exported has nothing to do with security, only with code organization and managing API surface area. Exporting a field just makes it accessible to the rest of the code in your application."}], "owner": {"reputation": 267, "user_id": 8020595, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e03b1dff3295eab007f791de5f787f60?s=128&d=identicon&r=PG&f=1", "display_name": "mwalto7", "link": "https://stackoverflow.com/users/8020595/mwalto7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 267, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1531992035, "creation_date": 1531845610, "last_edit_date": 1531992035, "question_id": 51386455, "link": "https://stackoverflow.com/questions/51386455/secure-password-prompt", "title": "Secure password prompt", "body": "<p>I'm working on a package <code>config</code> that specifies configuration options and commands for use in batch-configuring network devices. Right now, the <code>config.New</code> function accepts yaml source text which can contain text template values. For the <code>auth</code> key in the yaml file, you can specify the template value <code>auth: {{.Password}}</code> to prompt the user for their password on template execution. </p>\n\n<p>Is this function secure? The original yaml source file is not modified on template execution, and as far as I can tell the password value specified by the user is only accessible through the <code>*Config</code> struct returned from <code>config.New</code>. Unfortunately, the fields of <code>Config</code> must be exported in order for the yaml to be unmarshalled by <code>viper</code>. Does that introduce a security issue?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>package config\n\nimport (\n    \"fmt\"\n    \"github.com/spf13/viper\"\n    \"golang.org/x/crypto/ssh/terminal\"\n    \"io\"\n    \"os\"\n    \"text/template\"\n)\n\n// Config contains network device configuration options and commands.\ntype Config struct {\n    Hosts   string `yaml:\"hosts\"`   // hosts to configure\n    User    string `yaml:\"user\"`    // username for host login\n    Auth    string `yaml:\"auth\"`    // SSH authentication method\n    Allow   string `yaml:\"allow\"`   // allow either all or known hosts\n    Timeout int    `yaml:\"timeout\"` // duration to wait to establish a connection\n    Config []struct {\n        Vendor string   `yaml:\"vendor\"` // vendor that supports `cmds`\n        Cmds   []string `yaml:\"cmds\"`   // configuration commands to run\n    } `yaml:\"config\"`               // list of vendor-configuration command sets\n}\n\n// New creates a new Config from a yaml or text template file.\nfunc New(src string) (*Config, error) {\n    var cfg Config\n    pr, pw := io.Pipe()\n    tmpl, err := template.New(\"config\").Parse(src)\n    if err != nil {\n        return nil, err\n    }\n    tmplErr := make(chan error, 1)\n    go func(tmpl *template.Template, cfg Config, pw *io.PipeWriter, tmplErr chan&lt;- error) {\n        defer pw.Close()\n        if err := tmpl.Execute(pw, &amp;cfg); err != nil {\n            tmplErr &lt;- err\n        }\n        close(tmplErr)\n    }(tmpl, cfg, pw, tmplErr)\n    select {\n    case err := &lt;-tmplErr:\n        return nil, err\n    default:\n        v := viper.New()\n        v.SetConfigType(\"yaml\")\n        if err := v.ReadConfig(pr); err != nil {\n            return nil, err\n        }\n        if err := v.Unmarshal(&amp;cfg); err != nil {\n            return nil, err\n        }\n        return &amp;cfg, nil\n    }\n}\n\n// Password prompts the user for their password.\nfunc (c *Config) Password() string {\n    fmt.Fprint(os.Stderr, \"Password: \")\n    password, err := terminal.ReadPassword(int(os.Stdin.Fd()))\n    if err != nil {\n        panic(err)\n    }\n    fmt.Fprintln(os.Stderr)\n    return string(password)\n}\n</code></pre>\n\n<p>Example <code>main.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \".../config\"\n    \"log\"\n)\n\nconst TestConfig = `\n# Example configuration for restarting access points.\n---\nhosts  : access_points\nuser   : user\nauth   : &amp;password {{.Password}} # Prompt for password and store the value.\nallow  : known_hosts             # Only allow connections to known hosts.\ntimeout: 5\n\nconfig:\n  - vendor: cisco\n    cmds:\n      - enable\n      - *password                # Pass the password value to enter enabled mode.\n      - capwap ap restart\n      - exit\n`\n\nfunc main() {\n    cfg, err := config.New(TestConfig)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(cfg.Auth)\n}\n</code></pre>\n\n<p>Any tips or suggestions are appreciated. I don't want to accidentally expose anyone's passwords or leak sensitive data.</p>\n"}, {"tags": ["json", "go", "struct"], "comments": [{"owner": {"reputation": 3623, "user_id": 491557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3c20e970d3e909fa67a7809965c4936?s=128&d=identicon&r=PG", "display_name": "Spangen", "link": "https://stackoverflow.com/users/491557/spangen"}, "edited": false, "score": 0, "creation_date": 1531844608, "post_id": 51386066, "comment_id": 89744248, "body": "Where is <code>input</code> defined? As it should be a byte array of data."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1531844778, "post_id": 51386066, "comment_id": 89744345, "body": "<code>asset</code> is a JSON array, so the <code>Asset</code> field must be a slice of <code>AssetStorage</code>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531844855, "post_id": 51386066, "comment_id": 89744388, "body": "If you&#39;re having trouble unmarshalling JSON, please include a sample of the JSON data in the body of your question."}], "answers": [{"tags": [], "owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "is_accepted": false, "score": 0, "last_activity_date": 1531844679, "creation_date": 1531844679, "answer_id": 51386200, "question_id": 51386066, "link": "https://stackoverflow.com/questions/51386066/json-unmarshal-in-nested-struct/51386200#51386200", "title": "JSON unmarshal in nested struct", "body": "<p>The answer is in the error message:</p>\n\n<blockquote>\n  <p>Invalid input. JSON badly formatted. json: cannot unmarshal array into Go struct field DataInput.Asset of type app.AssetStorage</p>\n</blockquote>\n\n<p>The json you're parsing has <code>DataInput.Asset</code> as an <em>array</em> of <code>AssetStorage</code> objects. So, the type needs to be <code>[]AssetStorage</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 3, "last_activity_date": 1531847289, "creation_date": 1531847289, "answer_id": 51386897, "question_id": 51386066, "link": "https://stackoverflow.com/questions/51386066/json-unmarshal-in-nested-struct/51386897#51386897", "title": "JSON unmarshal in nested struct", "body": "<p>There are three bugs in your code, one is that your are not using address of <code>DataInput</code> struct when you are unmarshalling your JSON. </p>\n\n<p>This should be:</p>\n\n<pre><code>var data DataInput\njson.Unmarshal(input, data)\n</code></pre>\n\n<p>like below:</p>\n\n<pre><code>var data DataInput\nif err := json.Unmarshal(input, &amp;data); err != nil {\n    log.Println(err)\n}\n</code></pre>\n\n<p>One Piece of advice in above code. Never skip errors to know more about the error</p>\n\n<p>Next as the error says:</p>\n\n<blockquote>\n  <p>Invalid input. JSON badly formatted. json: cannot unmarshal array into\n  Go struct field DataInput.Asset of type app.AssetStorage</p>\n</blockquote>\n\n<p><code>DataInput.Asset</code> should be an array of json objects there you should change your <code>AssetStorage</code> to <code>[]AssetStorage</code> in your declaration in <code>DataInput</code> struct.</p>\n\n<p>One more error is that you are declaring the type of <code>EmployeeID</code> field for <code>AssetStorage</code> struct to be an <code>int</code> which should be a <code>string</code> </p>\n\n<p>Working Code on <a href=\"https://play.golang.org/p/taGvAHvDWYK\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}], "owner": {"reputation": 1051, "user_id": 4414774, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/100001877007099/picture?type=large", "display_name": "Sjors Hijgenaar", "link": "https://stackoverflow.com/users/4414774/sjors-hijgenaar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 937, "favorite_count": 0, "accepted_answer_id": 51386897, "answer_count": 2, "score": 1, "last_activity_date": 1531847289, "creation_date": 1531844238, "question_id": 51386066, "link": "https://stackoverflow.com/questions/51386066/json-unmarshal-in-nested-struct", "title": "JSON unmarshal in nested struct", "body": "<p>I am trying to unmarshal an incoming JSON into a struct that contains an array of structs. However I get the error</p>\n\n<blockquote>\n  <p>\"Invalid input. JSON badly formatted. json: cannot unmarshal array into Go struct field DataInput.Asset of type app.AssetStorage\"</p>\n</blockquote>\n\n<p>I have tried to recreate the code here: <a href=\"https://play.golang.org/p/RuBaBjPmWxO\" rel=\"nofollow noreferrer\">https://play.golang.org/p/RuBaBjPmWxO</a>, however I can't reproduce the error (although the incoming message and code are identical). </p>\n\n<pre><code>type AssetStorage struct {\n    Event         string   `json:\"Event\"`\n    EmployeeID    int      `json:\"EmployeeID\"`\n    EmployeeEmail string   `json:\"EmployeeEmail\"`\n    PerformedBy   string   `json:\"PerformedBy\"`\n    Timestamp     string   `json:\"Timestamp\"`\n    AlgorithmID   string   `json:\"AlgorithmID\"`\n    AlgorithmHash string   `json:\"AlgorithmHash\"`\n    Objects       []Object `json:\"Objects\"`\n}\n\ntype Object struct {\n    ShortName   string `json:\"ShortName\"`\n    Hash        string `json:\"Hash\"`\n    DestroyDate string `json:\"DestroyDate\"`\n}\n\ntype DataInput struct {\n    Username string\n    Token    string       `json:\"Token\"`\n    Asset    AssetStorage `json:\"Asset\"`\n}\n\nfunc main() {\n    var data DataInput\n    json.Unmarshal(input, data)\n    data.Username = data.Asset.EmployeeEmail\n    fmt.Printf(\"%+v\\n\", data)\n}\n</code></pre>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531844936, "post_id": 51386048, "comment_id": 89744437, "body": "Your code slices <code>rows</code> and then attempts to re-slice it. To get only certain colums from each row, you&#39;ll need to loop over the rows and copy the desired colums to a new slice of slices."}, {"owner": {"reputation": 137, "user_id": 7808537, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-MW9XsQwpqZg/AAAAAAAAAAI/AAAAAAAAwkk/dIeGpJGuLS4/photo.jpg?sz=128", "display_name": "Hugues", "link": "https://stackoverflow.com/users/7808537/hugues"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531846294, "post_id": 51386048, "comment_id": 89745128, "body": "ok, looping through the rows i think i know how to do, but how to copy only the desired columns ?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531846570, "post_id": 51386048, "comment_id": 89745289, "body": "If you don&#39;t care about memory use, you can just take slices, if you do care about memory use, use <code>copy</code> to make a new slice so that GC can clean up the unneeded elements."}, {"owner": {"reputation": 137, "user_id": 7808537, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-MW9XsQwpqZg/AAAAAAAAAAI/AAAAAAAAwkk/dIeGpJGuLS4/photo.jpg?sz=128", "display_name": "Hugues", "link": "https://stackoverflow.com/users/7808537/hugues"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531847070, "post_id": 51386048, "comment_id": 89745563, "body": "i do care about memory usage, my file contains &gt; 200&#39;000 rows. But again, how to copy only selected columns and not all columns ? I checked the copy function, it does not seem to handle specific columns unless i&#39;m mistaken: <a href=\"https://golang.org/pkg/builtin/#copy\" rel=\"nofollow noreferrer\">golang.org/pkg/builtin/#copy</a>"}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 7808537, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-MW9XsQwpqZg/AAAAAAAAAAI/AAAAAAAAwkk/dIeGpJGuLS4/photo.jpg?sz=128", "display_name": "Hugues", "link": "https://stackoverflow.com/users/7808537/hugues"}, "edited": false, "score": 0, "creation_date": 1531849938, "post_id": 51387164, "comment_id": 89746972, "body": "Thanks a lot Adrian, it&#39;s getting clearer now, indeed i should not see these as rows and columns but dimensions, the code above is what i was looking for !"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1531848749, "last_edit_date": 1531848749, "creation_date": 1531848391, "answer_id": 51387164, "question_id": 51386048, "link": "https://stackoverflow.com/questions/51386048/how-to-read-a-subset-of-an-array-or-slice/51387164#51387164", "title": "How to read a subset of an array or slice", "body": "<p>The key here I think is to stop thinking of it as rows and colums; in your code, you're operating on slices of slices. You can slice the outer level to get the rows you want, then iterate those to get the columns you want from each row. If you just take slices, though, all of the data you're not using will still be held in memory as part of the arrays backing the slices. For memory efficiency, you'll probably want to copy the desired data to completely new slices with new backing arrays:</p>\n\n<pre><code>    rows := xlsx.GetRows(\"ticker\")\n\n    df2 := make([][]string, 5) // I don't know what data type the cells are, assuming string, adjust the number to the number of rows you want to avoid unnecessary allocations)\n    idx := 0\n    for _, row := range rows[10:15] { // iterate over desired rows\n        df2row := make([]string, 2) // again, assuming 2 columns of string cells, adjust as needed\n        copy(df2row, row[23:25]) // copy desired columns to new row slice\n        df2[idx] = df2row\n        idx++\n    }\n\n    fmt.Println(df2)\n</code></pre>\n\n<p>There's an excellent, detailed rundown of slice operations here: <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">https://blog.golang.org/go-slices-usage-and-internals</a></p>\n\n<p>Here's a runable playground example with generated dummy data: <a href=\"https://play.golang.org/p/wRKcTpnTUA2\" rel=\"nofollow noreferrer\">https://play.golang.org/p/wRKcTpnTUA2</a></p>\n"}], "owner": {"reputation": 137, "user_id": 7808537, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-MW9XsQwpqZg/AAAAAAAAAAI/AAAAAAAAwkk/dIeGpJGuLS4/photo.jpg?sz=128", "display_name": "Hugues", "link": "https://stackoverflow.com/users/7808537/hugues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "accepted_answer_id": 51387164, "answer_count": 1, "score": 0, "last_activity_date": 1531992073, "creation_date": 1531844191, "last_edit_date": 1531992073, "question_id": 51386048, "link": "https://stackoverflow.com/questions/51386048/how-to-read-a-subset-of-an-array-or-slice", "title": "How to read a subset of an array or slice", "body": "<p>In Go, I can now read an excel file and put it into a slice.</p>\n\n<p>I know also how to read the value of a specific cell.</p>\n\n<p>But I would like now to read a subset of the initial slice, so basically read only rows 10 to 15 and columns 23 to 25 for example.</p>\n\n<p>My code below does not do that, it reads rows 35 and 36 and all columns. How can I read only columns 23 to 25 into df2?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/360EntSecGroup-Skylar/excelize\"\n)\n\nfunc main() {\n    xlsx, err := excelize.OpenFile(\"/media/Snaps/test.xlsm\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    rows := xlsx.GetRows(\"ticker\")\n\n    df2 := rows[10:15][23:25]\n    fmt.Println(df2)\n}\n</code></pre>\n"}, {"tags": ["json", "go", "nested", "unmarshalling"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531842928, "post_id": 51385573, "comment_id": 89743319, "body": "Please include a sample of the JSON structure you&#39;re trying to parse."}, {"owner": {"reputation": 31, "user_id": 10060029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff1f6c9ef04cf1fe8d31d90218dfbf7?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/10060029/john-smith"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531843074, "post_id": 51385573, "comment_id": 89743419, "body": "The sample JSON is the Github pull request event, <a href=\"https://developer.github.com/v3/activity/events/types/#pullrequestevent\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531844169, "post_id": 51385573, "comment_id": 89744017, "body": "Please include all necessary details <i>in the body of your question</i>. Links break, and not everyone wants to have to go to multiple sites to gather enough information to answer your question."}], "answers": [{"tags": [], "owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "is_accepted": true, "score": 0, "last_activity_date": 1531844370, "creation_date": 1531844370, "answer_id": 51386109, "question_id": 51385573, "link": "https://stackoverflow.com/questions/51385573/nested-json-deserializing-in-go/51386109#51386109", "title": "Nested JSON deserializing in Go", "body": "<p>There's no issue with the code you posted, except that there is no field <code>title_url</code> in the response you expect (you probably wanted just <code>title</code>). <a href=\"https://play.golang.org/p/ydwUVIddd-S\" rel=\"nofollow noreferrer\">Here's</a> a playground example that showcases it.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/json\"\n    \"log\"\n)\n\nconst examplePayload = `\n{\n  \"action\": \"closed\",\n  \"number\": 1,\n  \"pull_request\": {\n    \"url\": \"https://api.github.com/repos/Codertocat/Hello-World/pulls/1\",\n    \"id\": 191568743,\n    \"node_id\": \"MDExOlB1bGxSZXF1ZXN0MTkxNTY4NzQz\",\n    \"html_url\": \"https://github.com/Codertocat/Hello-World/pull/1\",\n    \"diff_url\": \"https://github.com/Codertocat/Hello-World/pull/1.diff\",\n    \"patch_url\": \"https://github.com/Codertocat/Hello-World/pull/1.patch\",\n    \"issue_url\": \"https://api.github.com/repos/Codertocat/Hello-World/issues/1\",\n    \"number\": 1,\n    \"state\": \"closed\",\n    \"locked\": false,\n    \"title\": \"Update the README with new information\"\n  }\n}\n`\n\ntype PullRequestEvent struct {\n    Action      string `json:\"action\"`\n    Number      int    `json:\"number\"`\n    PullRequest struct {\n        Url     string `json:\"url\"`\n        HtmlUrl string `json:\"html_url\"`\n        DiffUrl string `json:\"diff_url\"`\n        Title   string `json:\"title\"`\n    } `json:\"pull_request\"`\n}\n\nfunc main() {\n  var ev PullRequestEvent\n    ex := bytes.NewReader([]byte(examplePayload))\n    if err := json.NewDecoder(ex).Decode(&amp;ev); err != nil {\n        log.Fatal(err)\n    }\n    log.Printf(\"%#v\", ev)\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10060029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff1f6c9ef04cf1fe8d31d90218dfbf7?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/10060029/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 51386109, "answer_count": 1, "score": -1, "last_activity_date": 1531844458, "creation_date": 1531842463, "last_edit_date": 1531844458, "question_id": 51385573, "link": "https://stackoverflow.com/questions/51385573/nested-json-deserializing-in-go", "title": "Nested JSON deserializing in Go", "body": "<p>I am attempting to convert a nested JSON response to a struct. The struct looks as follows: </p>\n\n<pre><code>type PullRequestEvent struct {\n    Action               string   `json:\"action\"`\n    Number               int      `json:\"number\"`\n    PullRequest          struct { \n        Url              string   `json:\"url\"`\n        HtmlUrl          string   `json:\"html_url\"`\n        DiffUrl          string   `json:\"diff_url\"` \n        Title            string   `json:\"title_url\"` \n    } `json:\"pull_request\"`\n}\n</code></pre>\n\n<p>However, only the top-level fields (<code>Action</code>,<code>Number</code>) are being parsed; the rest remain <code>nil</code> or 0. The conversion code is as follows: </p>\n\n<pre><code>func whatever(w http.ResponseWriter, r *http.Request) {\n    var ev PullRequestEvent\n    dec := json.NewDecoder(r.Body)\n    err := dec.Decode(&amp;ev)\n    if err != nil {\n        // fail request \n    }\n}\n</code></pre>\n\n<p>The JSON is the pull request event <a href=\"https://developer.github.com/v3/activity/events/types/#pullrequestevent\" rel=\"nofollow noreferrer\">here</a>. The relevant parts are </p>\n\n<pre><code>{   \n    \"action\": \"closed\",   \"number\": 1,   \"pull_request\": {\n    \"url\": \"https://api.github.com/repos/Codertocat/Hello-World/pulls/1\",\n    \"id\": 191568743,\n    \"node_id\": \"MDExOlB1bGxSZXF1ZXN0MTkxNTY4NzQz\",\n    \"html_url\": \"https://github.com/Codertocat/Hello-World/pull/1\",\n    \"diff_url\": \"https://github.com/Codertocat/Hello-World/pull/1.diff\",\n    \"number\": 1,\n    \"state\": \"closed\",\n    \"locked\": false,\n    \"title\": \"Update the README with new information\",\n    \"user\": {\n      \"login\": \"Codertocat\",\n      \"id\": 21031067,\n      \"node_id\": \"MDQ6VXNlcjIxMDMxMDY3\",\n      \"gravatar_id\": \"\",\n      \"url\": \"https://api.github.com/users/Codertocat\",\n      \"html_url\": \"https://github.com/Codertocat\",\n      \"subscriptions_url\": \"link\",\n      \"organizations_url\": \"link\",\n      \"repos_url\": \"link\",\n      \"events_url\": \"https://api.github.com/users/Codertocat/events{/privacy}\",\n      \"received_events_url\": \"link\",\n      \"type\": \"User\",\n      \"site_admin\": false\n    }\n    //...  }\n</code></pre>\n\n<p>What is wrong with the code here? </p>\n"}, {"tags": ["c", "go", "unsafe-pointers"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531838837, "post_id": 51384245, "comment_id": 89740660, "body": "You use <code>unsafe.Pointer</code> when you need it. If you&#39;re converting <i>unsafely</i> between types, then you&#39;re going to need to use the unsafe package to &quot;remove&quot; the type in order to complete the conversion."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531839305, "post_id": 51384245, "comment_id": 89740981, "body": "&quot;The fact that it works doesn&#39;t make me confident that its safer&quot; -- why? It&#39;s safer because it&#39;s a valid type conversion. Try it with a different type than can&#39;t be converted and see the difference."}, {"owner": {"reputation": 738, "user_id": 678950, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e0161297463503b10774dd9b236d301c?s=128&d=identicon&r=PG", "display_name": "Diamondo25", "link": "https://stackoverflow.com/users/678950/diamondo25"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531839629, "post_id": 51384245, "comment_id": 89741202, "body": "So how exactly is <code>*byte =&gt; *uint8 =&gt; *C.uchar</code> less of a valid conversion than <code>*byte =&gt; *uint8 =&gt; *ArbitraryType =&gt; *C.uchar</code> ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531839819, "post_id": 51384245, "comment_id": 89741318, "body": "I don&#39;t understand what you mean. If you change the type (to uint32 for example) without using unsafe, you&#39;ll get an error like <code>cannot convert &amp;buf[0] (type *uint32) to type *_Ctype_uchar</code>"}, {"owner": {"reputation": 738, "user_id": 678950, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e0161297463503b10774dd9b236d301c?s=128&d=identicon&r=PG", "display_name": "Diamondo25", "link": "https://stackoverflow.com/users/678950/diamondo25"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531841172, "post_id": 51384245, "comment_id": 89742185, "body": "Well, yes, that&#39;s when you want to interpret the input object as a regular pointer and then convert it to something else. I suppose it is really just a NOP for []byte -&gt; uint8_t* conversions"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1531841712, "post_id": 51384245, "comment_id": 89742552, "body": "Sorry, I&#39;m still not following you. You can&#39;t convert <code>[]byte -&gt; uint8_t* </code>, but you&#39;re not doing that, you&#39;re converting <code>*byte -&gt; *uint8</code> which is safe. (and yes, <code>uint8</code>, <code>byte</code> and <code>C.uchar</code> are all the same type, which is why the conversion succeeds). Also note that many type conversions are &quot;NOP&quot;, since you&#39;re not doing any action other than changing the declared type for the compiler. (the exceptions are all laid out in the spec: <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Conversions</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1532023121, "last_edit_date": 1532023121, "creation_date": 1532021840, "answer_id": 51428826, "question_id": 51384245, "link": "https://stackoverflow.com/questions/51384245/c-ucharbuffer0-vs-c-ucharunsafe-pointerbuffer0/51428826#51428826", "title": "(*C.uchar)(&amp;buffer[0]) vs (*C.uchar)(unsafe.Pointer(&amp;buffer[0]))", "body": "<p>The Go documention is littered with warnings against using package <code>unsafe</code> to needlessly defeat Go's type system. <code>unsafe.Pointer</code> is clearly identified as unsafe for a reason.</p>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/pkg/unsafe/\" rel=\"nofollow noreferrer\">Package unsafe</a></p>\n  \n  <p>Package unsafe contains operations that step around the type safety of\n  Go programs.</p>\n  \n  <p>Packages that import unsafe may be non-portable and are not protected\n  by the Go 1 compatibility guidelines.</p>\n  \n  <p><a href=\"https://golang.org/pkg/unsafe/#Pointer\" rel=\"nofollow noreferrer\">type Pointer</a></p>\n  \n  <p>Pointer therefore allows a program to defeat the type system and read\n  and write arbitrary memory. It should be used with extreme care.</p>\n  \n  <hr>\n  \n  <p><a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">Command cgo</a></p>\n  \n  <p><a href=\"https://golang.org/cmd/cgo/#hdr-Passing_pointers\" rel=\"nofollow noreferrer\">Passing pointers</a></p>\n  \n  <p>Go is a garbage collected language, and the garbage collector needs to\n  know the location of every pointer to Go memory. Because of this,\n  there are restrictions on passing pointers between Go and C.</p>\n  \n  <p>[These] rules are checked dynamically at runtime.</p>\n  \n  <p>It is possible to defeat this enforcement by using the unsafe package,\n  and of course there is nothing stopping the C code from doing anything\n  it likes. However, programs that break these rules are likely to fail\n  in unexpected and unpredictable ways.</p>\n</blockquote>\n\n<hr>\n\n<p>Let's review a realistic example.</p>\n\n<p>Here's a C function that receives a bytes buffer.</p>\n\n<pre><code>void printbuf(size_t len, unsigned char *buf)\n</code></pre>\n\n<p>In Go, using cgo and preserving type safety with matching types, we could write,</p>\n\n<pre><code>var buf []byte\n\nC.printbuf(C.size_t(len(buf)), (*C.uchar)(&amp;buf[0]))\n</code></pre>\n\n<p>However, that's still unsafe, <code>buf[0]</code> will be out of range if <code>len(buf) == 0</code>. When <code>buf</code> is initialized to it's zero-value the array pointer will also be <code>nil</code>.  We can neatly encapsulate the integrity checks in a Go function, which the Go gc optimizing compiler will inline.</p>\n\n<pre><code>func cbuf(buf []byte) (size C.size_t, ptr *C.uchar) {\n    var bufptr *byte\n    if cap(buf) &gt; 0 {\n        bufptr = &amp;(buf[:1][0])\n    }\n    return C.size_t(len(buf)), (*C.uchar)(bufptr)\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>bufsize, bufptr := cbuf(buf)\nC.printbuf(bufsize, bufptr)\n</code></pre>\n\n<p>Defeating the type system by using <code>unsafe.Pointer</code> is unsafe. For example,</p>\n\n<pre><code>C.printbuf(C.size_t(len(buf)), (*C.uchar)(unsafe.Pointer(&amp;buf[0])))\n</code></pre>\n\n<p>The <code>buf</code> type could be any indexed type: array, pointer to array, slice, string or map. Even worse, the size, if not one byte, will be wrong. Now it gets get really ugly,</p>\n\n<pre><code>C.printbuf(C.size_t(len(buf)*int(unsafe.Sizeof(buf[0]))), (*C.uchar)(unsafe.Pointer(&amp;buf[0])))\n</code></pre>\n\n<p>And we haven't taken into account nil pointers and out of range values.</p>\n\n<p>Next the code review: code should be correct, maintainable, robust, reasonably efficient, and, most importantly, readable. Don't expect the code review of <code>unsafe.Pointer</code> usage to go well.</p>\n\n<hr>\n\n<p>Let's hear your rationale for the use of unsafe.Pointer for this purpose.</p>\n\n<hr>\n\n<p><strong>Sample code</strong>:</p>\n\n<p><code>printbuf.go</code>:</p>\n\n<pre><code>package main\n\n/*\n#include &lt;stdio.h&gt;\n\nvoid printbuf(size_t len, unsigned char *buf) {\n    printf(\"%lu [\", len);\n    if (!buf) {\n        len = 0;\n    }\n    size_t maxwidth = 16;\n    size_t width = len &lt;= maxwidth ? len : maxwidth;\n    for (size_t i = 0; i &lt; width; i++) {\n        if (i &gt; 0) {\n            printf(\" \");\n        }\n        printf(\"%02X\", buf[i]);\n    }\n    if (width &lt; len) {\n        printf(\" ...\");\n    }\n    printf(\"]\\n\");\n}\n*/\nimport \"C\"\n\nimport (\n    \"unsafe\"\n)\n\n// NOTE: -gcflags='-m' : can inline cbuf : inlining call to cbuf\nfunc cbuf(buf []byte) (size C.size_t, ptr *C.uchar) {\n    var bufptr *byte\n    if cap(buf) &gt; 0 {\n        bufptr = &amp;(buf[:1][0])\n    }\n    return C.size_t(len(buf)), (*C.uchar)(bufptr)\n}\n\nfunc main() {\n\n    var buf []byte // zero-value = nil, len = 0, cap = 0\n\n    bufsize, bufptr := cbuf(buf)\n    C.printbuf(bufsize, bufptr)\n\n    buf = make([]byte, 0) // len = 0, cap = 0\n\n    bufsize, bufptr = cbuf(buf)\n    C.printbuf(bufsize, bufptr)\n\n    buf = make([]byte, 0, 32) // len = 0\n\n    bufsize, bufptr = cbuf(buf)\n    C.printbuf(bufsize, bufptr)\n\n    buf = make([]byte, 32) // len &gt; 0\n    for i := range buf {\n        buf[i] = byte(i)\n    }\n\n    bufsize, bufptr = cbuf(buf)\n    C.printbuf(bufsize, bufptr)\n\n    if len(buf) &gt; 0 {\n\n        C.printbuf(C.size_t(len(buf)), (*C.uchar)(&amp;buf[0]))\n\n        C.printbuf(C.size_t(len(buf)), (*C.uchar)(unsafe.Pointer(&amp;buf[0])))\n\n        C.printbuf(C.size_t(len(buf)*int(unsafe.Sizeof(buf[0]))), (*C.uchar)(unsafe.Pointer(&amp;buf[0])))\n\n    }\n\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0 []\n0 []\n0 []\n32 [00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F ...]\n32 [00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F ...]\n32 [00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F ...]\n32 [00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F ...]\n</code></pre>\n"}], "owner": {"reputation": 738, "user_id": 678950, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e0161297463503b10774dd9b236d301c?s=128&d=identicon&r=PG", "display_name": "Diamondo25", "link": "https://stackoverflow.com/users/678950/diamondo25"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1729, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1532023121, "creation_date": 1531838531, "question_id": 51384245, "link": "https://stackoverflow.com/questions/51384245/c-ucharbuffer0-vs-c-ucharunsafe-pointerbuffer0", "title": "(*C.uchar)(&amp;buffer[0]) vs (*C.uchar)(unsafe.Pointer(&amp;buffer[0]))", "body": "<p>We have a discussion here over using (or not) <code>unsafe.Pointer</code> for passing pointers to byte arrays from Go to C. </p>\n\n<p>What is the biggest reason (not) to use <code>unsafe.Pointer()</code> ? I would take consistency as a reason, as you'd call an 'external' function, even in a different language, and you want to guarantee that its a Pointer type.</p>\n\n<p>However, due to the Go language style looking a bit like C, using a straight cast using <code>(*C.uchar)(&amp;buffer[0]))</code> is valid <em>and</em> works. The fact that it works doesn't make me confident that its <em>safer</em> than using <code>unsafe.Pointer()</code>. </p>\n\n<p>Maybe I'm a bit confused/conflicted by the Go casts looking like function calls, and <code>Pointer</code> being defined as <code>type Pointer *ArbitraryType</code> <em>actually</em> says <code>(*ArbitraryType)&amp;buffer[0]</code> and does <em>not</em> actually invoke any command to do the 'conversion' but really just helps explaining what is going on, on a functional level, kind of like a macro <em>could</em> do.</p>\n"}, {"tags": ["go", "solaris", "elastic-stack", "filebeat", "gccgo"], "owner": {"reputation": 11, "user_id": 10094190, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-t7kNdlkdy94/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7q84kZTO1TFte-D3jgnQ5PYSKAUuQ/mo/photo.jpg?sz=128", "display_name": "ahmed charafouddine", "link": "https://stackoverflow.com/users/10094190/ahmed-charafouddine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 387, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1531836887, "creation_date": 1531836887, "question_id": 51383671, "link": "https://stackoverflow.com/questions/51383671/filebeat-libbeat-compiler-on-gccgo-for-solaris-sparc", "title": "filebeat/libbeat compiler on gccgo for solaris/sparc", "body": "<p>I am driving to compile the project filebeat going for solar / SPARC environments. Officially, Elastic tools are not supported by Solaris.</p>\n\n<p>Neamoins, there is circumventenement to this problem / compile via gccgo. I actually prepare my gccgo compiler. I can compile a small project (with a single file hello.go) see below. But as soon as I try to compile the filebeat project, it does not work. can be a problem of dependencies.I do not know too much. if anyone could help me. Thank you</p>\n\n<p><a href=\"http://ggolang.blogspot.com/2015/05/gccgo-gcc510-cross-compile-for-sparc.html\" rel=\"nofollow noreferrer\">inspired link here </a></p>\n\n<p>Commande : go build --compiler gccgo --gccgoflags \"-v -static-libgo -Wl,-dy -lnsl -lsocket -lrt -lsendfile\"</p>\n\n<p><strong>Example 1 :</strong> </p>\n\n<pre><code>xxxx@ubuntu:~/Documents/GCC$ cat hello.go\npackage main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"hello world\")\n}\n\nmorosus@ubuntu:~/Documents/GCC$ gccgo -m64 -v -static-libgo -o hello hello.go\n-Wl,-dy -lnsl -lsocket -lrt -lsendfile\nUsing built-in specs.\nCOLLECT_GCC=gccgo\nCOLLECT_LTO_WRAPPER=/opt/cross/libexec/gcc/sparc-sun-solaris2.10/8.1.0/lto-wrapper\nTarget: sparc-sun-solaris2.10\n   elf64_sparc\nCOLLECT_GCC_OPTIONS='-m64' '-v' '-o' 'hello' '-shared-libgcc'\nxxxxxx@ub\n</code></pre>\n\n<p>It works very well\nbut, </p>\n\n<p><strong>Example 2</strong></p>\n\n<pre><code> xxxx@ubuntu:~/go/src/github.com/elastic/beats/filebeat$ go build --compiler gccgo --gccgoflags \"-v -static-libgo -Wl,-dy -lnsl -lsocket -lrt -lsendfile\"\n# github.com/elastic/beats/libbeat/plugin\n../libbeat/plugin/load.go:25:2: error: import file \u2018plugin\u2019 not found\n  goplugin \"plugin\"\n  ^\n../libbeat/plugin/load.go:29:12: error: reference to undefined name \u2018goplugin\u2019\n  p, err := goplugin.Open(path)\n            ^\n# github.com/elastic/beats/vendor/github.com/elastic/go-seccomp-bpf\n../vendor/github.com/elastic/go-seccomp-bpf/seccomp_linux.go:59:22: error: reference to undefined identifier \u2018syscall.SockFprog\u2019\n  program := &amp;syscall.SockFprog{\n</code></pre>\n\n<p><strong>that's where I'm stuck</strong></p>\n\n<p>THANK YOU</p>\n"}, {"tags": ["bash", "shell", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531836211, "post_id": 51383387, "comment_id": 89738669, "body": "<code>su</code> is trying to prevent this kind of usage with good reason. Can you a) run your Go application with root privileges, or b) make the script usable by the account your Go app is running as?"}, {"owner": {"reputation": 111, "user_id": 9137052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0165e4b37ac88ceaedc18940b097d0d4?s=128&d=identicon&r=PG&f=1", "display_name": "Xander May", "link": "https://stackoverflow.com/users/9137052/xander-may"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531836668, "post_id": 51383387, "comment_id": 89739008, "body": "@Adrian The application has to be the thing doing privilege escalation as the person running this binary will not have knowledge of the root password, and no it must be run in a standardized environment (ships with hardware and cannot be assumed that it is changed on the other side)."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531836749, "post_id": 51383387, "comment_id": 89739079, "body": "So in addition to trying to circumvent <code>su</code>&#39;s built-in security measures, you&#39;re also going to be including the root password in your application&#39;s source and binary?"}, {"owner": {"reputation": 111, "user_id": 9137052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0165e4b37ac88ceaedc18940b097d0d4?s=128&d=identicon&r=PG&f=1", "display_name": "Xander May", "link": "https://stackoverflow.com/users/9137052/xander-may"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531837127, "post_id": 51383387, "comment_id": 89739359, "body": "@Adrian Thats the gist of it. The password/binary/src is not distributed outside the org, this is only for log collection and testing. But the environment must be consistent with that which would be seen outside"}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 2, "creation_date": 1531837140, "post_id": 51383387, "comment_id": 89739370, "body": "Instead of trying to force <code>su</code> to do something it should never do, it would be a little less insecure to invoke a special-purpose setuid binary to run the script. In this way you at least avoid writing the root password in the program; and it will work even if the root password is changed. (You do tell your users to change the root password immediately after unpacking the device, don&#39;t you?)"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531837323, "post_id": 51383387, "comment_id": 89739507, "body": "You mean it&#39;s not <i>intentionally</i> distributed outside the org. This sounds like a disaster waiting to happen."}, {"owner": {"reputation": 111, "user_id": 9137052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0165e4b37ac88ceaedc18940b097d0d4?s=128&d=identicon&r=PG&f=1", "display_name": "Xander May", "link": "https://stackoverflow.com/users/9137052/xander-may"}, "edited": false, "score": 0, "creation_date": 1531837631, "post_id": 51383387, "comment_id": 89739719, "body": "Listen, I understand these are not best practices, I am not trying to pretend that it is, and I&#39;m not in charge of what the organization or user does. I&#39;m just trying to execute an existing script as root so that I can ask our tech to collect certain logs that require root privileges without them needing the root password or us needing to remote in and do it manually. Is there a way, given that I am going to keep the root password in this binary encoded or not, to execute a script as root with go."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1531992997, "post_id": 51383387, "comment_id": 89809222, "body": "So an <i>internal</i> program that keeps the root password is OK but an <i>internal</i> configuration that enables sudo is not OK and an <i>internal</i> suid execitable is also not OK? You are working in an <i>interesting</i> company, security-wise."}, {"owner": {"reputation": 111, "user_id": 9137052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0165e4b37ac88ceaedc18940b097d0d4?s=128&d=identicon&r=PG&f=1", "display_name": "Xander May", "link": "https://stackoverflow.com/users/9137052/xander-may"}, "edited": false, "score": 0, "creation_date": 1532009365, "post_id": 51383387, "comment_id": 89820630, "body": "Modification of a static environment is what we&#39;re trying to avoid. This has to emulate the environment found in a device that ships with a certain config"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1532025603, "post_id": 51383387, "comment_id": 89830494, "body": "Look, the way of giving that one special executable root permissions was invented back in 1987 by Dennis Ritchie. It is called setuid. Having a setuid program on your system &quot;modifies the environment&quot; no more and no less than having a program that gets root permissions in some other way. The setuid way is secure though."}, {"owner": {"reputation": 111, "user_id": 9137052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0165e4b37ac88ceaedc18940b097d0d4?s=128&d=identicon&r=PG&f=1", "display_name": "Xander May", "link": "https://stackoverflow.com/users/9137052/xander-may"}, "edited": false, "score": 0, "creation_date": 1532026173, "post_id": 51383387, "comment_id": 89830781, "body": "Should I setuid on 8 different custom binaries (which I have no control over making) that I only want run with the specific flags that wont harm the kernel?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1532035116, "post_id": 51383387, "comment_id": 89834590, "body": "If you believe it&#39;s safe to run these 8 executables with specific flags, you may make just one setuid program that is able to run either of those 8 executables, selectable with a command like switch, and pass the selected one its respective safe flags."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 9137052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0165e4b37ac88ceaedc18940b097d0d4?s=128&d=identicon&r=PG&f=1", "display_name": "Xander May", "link": "https://stackoverflow.com/users/9137052/xander-may"}, "edited": false, "score": 0, "creation_date": 1531839810, "post_id": 51384495, "comment_id": 89741313, "body": "I do understand that this is not recommended (to say the least) but thank you for giving a solution rather than trying to change the environment in which this has to work. I will try pty now"}, {"owner": {"reputation": 111, "user_id": 9137052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0165e4b37ac88ceaedc18940b097d0d4?s=128&d=identicon&r=PG&f=1", "display_name": "Xander May", "link": "https://stackoverflow.com/users/9137052/xander-may"}, "edited": false, "score": 0, "creation_date": 1532009408, "post_id": 51384495, "comment_id": 89820666, "body": "Ended up doing full on SSH into its-self as this gives the option for me to remotely control it myself too. Thanks for the suggestion!"}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 2, "last_activity_date": 1531839222, "creation_date": 1531839222, "answer_id": 51384495, "question_id": 51383387, "link": "https://stackoverflow.com/questions/51383387/executing-su-with-os-exec-returns-error/51384495#51384495", "title": "Executing &#39;su&#39; with os.exec returns error", "body": "<p>Try running it so that it's connected to a <a href=\"https://en.wikipedia.org/wiki/Pseudoterminal\" rel=\"nofollow noreferrer\">pseudo TTY</a>.</p>\n\n<p><a href=\"https://godoc.org/github.com/kr/pty\" rel=\"nofollow noreferrer\"><code>github.com/kr/pty</code></a> and\n<a href=\"https://godoc.org/?q=pty\" rel=\"nofollow noreferrer\">other packages</a> may help with this.</p>\n\n<hr>\n\n<p>I must recap what others have written in their respective comments\nthat this practice is <em>utterly and irreversively broken.</em></p>\n"}], "owner": {"reputation": 111, "user_id": 9137052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0165e4b37ac88ceaedc18940b097d0d4?s=128&d=identicon&r=PG&f=1", "display_name": "Xander May", "link": "https://stackoverflow.com/users/9137052/xander-may"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 51384495, "answer_count": 1, "score": -1, "last_activity_date": 1531992091, "creation_date": 1531836109, "last_edit_date": 1531992091, "question_id": 51383387, "link": "https://stackoverflow.com/questions/51383387/executing-su-with-os-exec-returns-error", "title": "Executing &#39;su&#39; with os.exec returns error", "body": "<p>As I understand it Go's exec function executes the command directly with the kernel, rather than creating a local a terminal session or something like that. Unfortunately, I need to use the <code>su</code> command in order to run a script, which involves running <code>su</code> then piping the root password in via stdin. </p>\n\n<p>Yes I have to use <code>su</code> (business use case on devices with <code>sudo</code> disabled), and I also do need to be able to pipe the password in. </p>\n\n<p>So far the code I have is as follows</p>\n\n<pre><code>rootRun := exec.Command(\"su\", \"-c\", \"whoami\")\n\nrootRun.Stderr = os.Stdout\nrootRun.Stdout = os.Stdout\n\nerr = rootRun.Run()\ncheck(err)\n</code></pre>\n\n<p>and the error is</p>\n\n<pre><code>su: must be run from a terminal\npanic: exit status 1\n</code></pre>\n\n<p>The only way I can think to do this would be to somehow emulate a terminal on the machine with go (I dont know what packages could be used, please let me know if you know of one) or create some kind of local ssh connection that gives me a pty session to work with, but thats not great as the devices will sometimes have ssh disabled. Hopefully there is another way around this, please let me know.</p>\n"}, {"tags": ["go", "system-calls", "mmap"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 3, "creation_date": 1531834511, "post_id": 51382605, "comment_id": 89737376, "body": "<code>bytes.Split</code> can be very expensive. To choose an appropriate data structure we need to know what you are tryng to accomplish. The XY problem is asking about your attempted solution rather than your actual problem: <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">The XY Problem</a>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1531836452, "post_id": 51382605, "comment_id": 89738833, "body": "If the messages are not fixed-length, there is a definite limit to how efficient this can be; getting message <i>n</i> will always require reading every message from 0..n, and parsing every character looking for the delimiter (whether you do this with <code>Split</code> or some other method)."}, {"owner": {"reputation": 1881, "user_id": 229154, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/79qdK.jpg?s=128&g=1", "display_name": "Wojciech Kaczmarek", "link": "https://stackoverflow.com/users/229154/wojciech-kaczmarek"}, "edited": false, "score": 0, "creation_date": 1531843958, "post_id": 51382605, "comment_id": 89743915, "body": "You could use msgpack for the internal repsentation of your data."}], "owner": {"reputation": 435, "user_id": 10061533, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fv61VUShbCs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rTOnJlSCJr_asOOUez6u2WFiAdCQ/mo/photo.jpg?sz=128", "display_name": "Cubey Mew", "link": "https://stackoverflow.com/users/10061533/cubey-mew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531992082, "creation_date": 1531833991, "last_edit_date": 1531992082, "question_id": 51382605, "link": "https://stackoverflow.com/questions/51382605/efficient-way-to-read-mmap", "title": "Efficient way to read Mmap", "body": "<p>I am using <code>syscall</code> to read a byte array out of <code>mmap</code>:</p>\n\n<pre><code>file, e := os.Open(path)\nif e != nil {...}\ndefer file.Close()\n\nfi, e := file.Stat()\nif e != nil {...}\ndata, e := syscall.Mmap(int(file.Fd()), 0, int(fi.Size()), syscall.PROT_READ, syscall.MAP_SHARED)\nif e != nil {...}\n</code></pre>\n\n<p><code>data</code> is the binary array I need.</p>\n\n<p>I am using <code>||</code> as a delimiter, so I can get slices by using <code>bytes.Split</code>:</p>\n\n<pre><code>slices := bytes.Split(data, []byte(\"||\"))\nfor _, s := range slices {\n    str := string(s[:])\n    fmt.Println(str)\n}\n</code></pre>\n\n<p>This works fine, and I also stored the total number of messages (its type is <code>uint32</code> which takes 8 bytes) at the beginning of the <code>mmap</code>.</p>\n\n<p>When a new message is written in, I can get the total number of messages by reading the first 8 bytes.</p>\n\n<p>Assuming I have the number of messages as <code>n</code>, I still need to do the following to read the new message:</p>\n\n<pre><code>slices := bytes.Split(data, []byte(\"||\"))\ns := slices[n - 1]\nstr := string(s[:])\nfmt.Println(str)\n</code></pre>\n\n<p>Is there a more efficient way to do this?</p>\n"}, {"tags": ["json", "go", "github"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1531833139, "post_id": 51381660, "comment_id": 89736334, "body": "Your are making four labels but populate only one. The remaining three will be empty (i.e. invalid). Same with assignees."}, {"owner": {"reputation": 27, "user_id": 4024354, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Markus", "link": "https://stackoverflow.com/users/4024354/markus"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1531900426, "post_id": 51381660, "comment_id": 89764002, "body": "I tried creating only one label and one assignees but the issue is not resolved"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4024354, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Markus", "link": "https://stackoverflow.com/users/4024354/markus"}, "edited": false, "score": 0, "creation_date": 1531900620, "post_id": 51382293, "comment_id": 89764116, "body": "The hard coded(the one in your reply) works. I&#39;m trying to use a struct and trying to create a issue from user input. But i have tried sending no label data and still get the same error."}], "tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": false, "score": 0, "last_activity_date": 1531833140, "creation_date": 1531833140, "answer_id": 51382293, "question_id": 51381660, "link": "https://stackoverflow.com/questions/51381660/github-api-create-issue-returns-status-422/51382293#51382293", "title": "github api create issue returns status 422", "body": "<p>Based on the validation message:</p>\n\n<pre><code>{\n  \"message\": \"Validation Failed\",\n  \"errors\": [{\n    \"resource\": \"Label\",\n    \"field\": \"name\",\n    \"code\": \"missing_field\"\n  }],\n  \"documentation_url\": \"https://developer.github.com/v3/issues/#create-an-issue\"\n}\n</code></pre>\n\n<p>It looks to be a problem with the labels that you are attempting to attach to the issue.</p>\n\n<p>Try removing this section of the create issue body:</p>\n\n<pre><code> \"labels\": [\n    \"bug\"\n  ]\n</code></pre>\n\n<p>Or create a label with name \"bug\": \n<a href=\"https://developer.github.com/v3/issues/labels/#create-a-label\" rel=\"nofollow noreferrer\">https://developer.github.com/v3/issues/labels/#create-a-label</a></p>\n"}], "owner": {"reputation": 27, "user_id": 4024354, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Markus", "link": "https://stackoverflow.com/users/4024354/markus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531900689, "creation_date": 1531831266, "last_edit_date": 1531900689, "question_id": 51381660, "link": "https://stackoverflow.com/questions/51381660/github-api-create-issue-returns-status-422", "title": "github api create issue returns status 422", "body": "<p>I'm trying to create an GitHub issue through their API but it returns status 422. The code works when i try it with the hard coded values, but as soon as i try it with input from the stdin i get the following response </p>\n\n<p><code>{\n   \"message\":\"Validation Failed\",\n    \"errors\":[{\"resource\":\"Label\",\n\"field\":\"name\",\n\"code\":\"missing_field\"\n}],\n  \"documentation_url\":\"https://developer.github.com/v3/issues/#create-an-issue\"\n}</code></p>\n\n<p>Note that i would like to use marshaling since i'm doing asignments from a book i'm working on. </p>\n\n<p>Thank you!</p>\n\n<pre><code>func main() {\n    var issue githubissues.IssueReq\n    issue = userInput()\n    //Hardcoded testvalues that work\n    var jsonStr = []byte(`{\n            \"title\": \"Found a bug\",\n            \"body\": \"I'm having a problem with this.\",\n            \"assignees\": [\n            \"AssigneNR1\"\n            ],\n            \"milestone\": 1,\n            \"labels\": [\n            \"bug\"\n            ]\n        }`)\n\n    issueMars, err := json.Marshal(issue)\n    if err != nil {\n        fmt.Println(\"Marshal Error\", err)\n    }\n    req, err := http.NewRequest(\"POST\", url, bytes.NewBuffer(issueMars))\n    req.Header.Set(\"X-Custom-Header\", \"myvalue\")\n    req.Header.Set(\"Content-Type\", \"application/json\")\n\n    client := &amp;http.Client{}\n    resp, err := client.Do(req)\n    if err != nil {\n        panic(err)\n    }\n    defer resp.Body.Close()\n\n    fmt.Println(\"Response Status:\", resp.Status)\n    fmt.Println(\"Response Headers:\", resp.Header)\n    body, _ := ioutil.ReadAll(resp.Body)\n    fmt.Println(\"Response body\", string(body))\n}\n\nfunc userInput() githubissues.IssueReq {\n    var issue githubissues.IssueReq\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Issue Title:\")\n    issue.Title, _ = reader.ReadString('\\n')\n    fmt.Print(\"Body:\")\n    issue.Body, _ = reader.ReadString('\\n')\n    fmt.Print(\"Assignee:\")\n    issue.Assignees = make([]string, 4)\n    assigne, _ := reader.ReadString('\\n')\n    issue.Assignees = append(issue.Assignees, stripSpaces(assigne))\n    fmt.Print(\"Milestone:\")\n    issue.Milestone, _ = reader.ReadString('\\n')\n    issue.Milestone = strings.TrimSuffix(issue.Milestone, \"\\r\\n\")\n    fmt.Print(\"Label:\")\n    issue.Labels = make([]string, 4)\n    label, _ := reader.ReadString('\\n')\n    issue.Labels = append(issue.Labels, stripSpaces(label))\n    return issue\n\n}\n\nfunc stripSpaces(str string) string {\n    return strings.Map(func(r rune) rune {\n        if unicode.IsSpace(r) {\n            return -1\n        }\n        return r\n    }, str)\n}\n</code></pre>\n"}, {"tags": ["bash", "go", "terminal", "alias"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531830367, "post_id": 51381295, "comment_id": 89734388, "body": "Where is your <code>alias</code> located? It should be a <code>.bashrc</code> file or other scripts. Either parse the file yourself and replace the alias with auctual command or ask bash to parse it."}, {"owner": {"reputation": 134, "user_id": 4098847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd49d43c52289efda3178fc27039c54?s=128&d=identicon&r=PG", "display_name": "Rem&#39;s", "link": "https://stackoverflow.com/users/4098847/rems"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531830576, "post_id": 51381295, "comment_id": 89734558, "body": "My alias are located in <code>~&#47;.bash_aliases</code> as mentioned in the question. Does it have a more simple way to call it instead of parsing the file."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531830628, "post_id": 51381295, "comment_id": 89734598, "body": "run <code>bash -c &quot;source ~&#47;.bash_aliases; cmd&quot;</code>."}, {"owner": {"reputation": 134, "user_id": 4098847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd49d43c52289efda3178fc27039c54?s=128&d=identicon&r=PG", "display_name": "Rem&#39;s", "link": "https://stackoverflow.com/users/4098847/rems"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531831521, "post_id": 51381295, "comment_id": 89735197, "body": "It does not work unfortunately. I tried <code>&#47;bin&#47;bash -i -c cmd</code> as well."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531832771, "post_id": 51381295, "comment_id": 89736077, "body": "Try <code>bash -ic -rcfile ~&#47;.bash_alias &quot;cmd&quot;</code>."}, {"owner": {"reputation": 134, "user_id": 4098847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd49d43c52289efda3178fc27039c54?s=128&d=identicon&r=PG", "display_name": "Rem&#39;s", "link": "https://stackoverflow.com/users/4098847/rems"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531833416, "post_id": 51381295, "comment_id": 89736541, "body": "It doesn&#39;t work as well. I have the following error message :  <code>fork&#47;exec bash -ic -rcfile ~&#47;.bash_aliases &quot;cmd&quot;: no such file or directory</code>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1531836550, "post_id": 51381295, "comment_id": 89738920, "body": "It&#39;s probably not a good idea to have a Go program rely on a user having an alias defined in the first place."}], "answers": [{"tags": [], "owner": {"reputation": 134, "user_id": 4098847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd49d43c52289efda3178fc27039c54?s=128&d=identicon&r=PG", "display_name": "Rem&#39;s", "link": "https://stackoverflow.com/users/4098847/rems"}, "is_accepted": false, "score": 0, "last_activity_date": 1531922243, "creation_date": 1531922243, "answer_id": 51403951, "question_id": 51381295, "link": "https://stackoverflow.com/questions/51381295/launch-a-terminal-command-in-go-that-is-defined-as-an-alias/51403951#51403951", "title": "Launch a terminal command in Go that is defined as an alias", "body": "<p>If you want to launch a command that is defined as an alias in your <code>~/.bashrc</code> or<code>~/.bash_aliases</code> files, you can use the <code>bash -c cmd</code> command described in the other comments.\nNevertheless, you must implement it in a proper way in Go.\nHere is the command:</p>\n\n<pre><code>exec.Command(\"/bin/bash\", \"-c\", \"aliasCmd \"+ _alias_arguments)\n</code></pre>\n\n<p>However, you should not have your program to rely on a user defined alias. ;-)</p>\n"}], "owner": {"reputation": 134, "user_id": 4098847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd49d43c52289efda3178fc27039c54?s=128&d=identicon&r=PG", "display_name": "Rem&#39;s", "link": "https://stackoverflow.com/users/4098847/rems"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 564, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531922243, "creation_date": 1531830164, "question_id": 51381295, "link": "https://stackoverflow.com/questions/51381295/launch-a-terminal-command-in-go-that-is-defined-as-an-alias", "title": "Launch a terminal command in Go that is defined as an alias", "body": "<p>I am writing a program in Go that sends some commands.\nI can run any command that is in the $PATH.\nI check that the command is runnable with the LookPath function.</p>\n\n<pre><code>path, err := exec.LookPath(\"pwd\")\n</code></pre>\n\n<p>and then run it with the following command:</p>\n\n<pre><code>func Run(command string, args []string) string {\n    cmd := exec.Command(command, args...)\n\n    output, err := cmd.CombinedOutput()\n    if err != nil {\n        logging.PrintlnError(fmt.Sprint(err) + \": \" + string(output))\n        return \"\"\n    }\n    return string(output)\n}\n</code></pre>\n\n<p>The <code>Run(\"pwd\", \"\")</code> is working\nBut if I am using an alias, it doesnt' work.</p>\n\n<p>For instance, I have <code>alias l='ls -lah'</code> in my <code>~/.bash_aliases</code> file, but when I want to run that command in Go, it doesn't work.</p>\n\n<p><code>Run(\"l\")</code> is not working.</p>\n\n<p>I have the following error message :</p>\n\n<pre><code>exec: \"l\": executable file not found in $PATH:\n</code></pre>\n\n<p>I tried as well to use another method to run some alias' command.</p>\n\n<pre><code>func RunCmd(cmd string) string {\n    out, err := exec.Command(cmd).Output()\n    if err != nil {\n        logging.PrintlnError(\"error occured\")\n        logging.PrintlnError(fmt.Sprint(err))\n    }\n    fmt.Printf(\"%s\", out)\n\n    return string(out)\n}\n</code></pre>\n\n<p>But it is not working as well.</p>\n\n<p>Do you know what function I can use to launch a command that is defined as an alias in my shell?\nI tried to launch <code>bash -c cmd</code> but unfortunately as well.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 219, "user_id": 10093490, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-K-HkLheA9uM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ozdVcVH7ARZk7IhIhgAzGdme_k3Q/mo/photo.jpg?sz=128", "display_name": "Suman", "link": "https://stackoverflow.com/users/10093490/suman"}, "edited": false, "score": 0, "creation_date": 1531848079, "post_id": 51381146, "comment_id": 89746069, "body": "I am a new to GoLang. Thank you for the help."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1531844398, "last_edit_date": 1531844398, "creation_date": 1531829739, "answer_id": 51381146, "question_id": 51380543, "link": "https://stackoverflow.com/questions/51380543/calculating-arithmetic-mean-using-custom-golang-library/51381146#51381146", "title": "Calculating Arithmetic Mean using custom Golang Library", "body": "<blockquote>\n  <p><a href=\"https://godoc.org/github.com/ematvey/go-fn/fn\" rel=\"nofollow noreferrer\">package fn</a></p>\n\n<pre><code>type Vector\n\ntype Vector struct {\n    A   []float64 // data\n    L   int       // length\n}\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    maths \"github.com/ematvey/go-fn/fn\"\n)\n\nfunc main() {\n    a := []float64{2, 3, 5, 7, 11, 13}\n    v := &amp;maths.Vector{A: a, L: len(a)}\n    avg := maths.ArithMean(v)\n    fmt.Println(avg)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>6.833333333333333\n</code></pre>\n\n<hr>\n\n<p>Other statistical packages may be easier and more intuitive to use.</p>\n\n<p>For example,</p>\n\n<blockquote>\n  <p>func Mean</p>\n\n<pre><code>func Mean(x, weights []float64) float64\n</code></pre>\n  \n  <p>Mean computes the weighted mean of the data set.</p>\n\n<pre><code>sum_i {w_i * x_i} / sum_i {w_i}\n</code></pre>\n  \n  <p>If weights is nil then all of the weights are 1. If weights is not\n  nil, then len(x) must equal len(weights).</p>\n</blockquote>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"gonum.org/v1/gonum/stat\"\n)\n\nfunc main() {\n    a := []float64{2, 3, 5, 7, 11, 13}\n    mean := stat.Mean(a, nil)\n    fmt.Println(mean)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>6.833333333333333\n</code></pre>\n"}], "owner": {"reputation": 219, "user_id": 10093490, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-K-HkLheA9uM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ozdVcVH7ARZk7IhIhgAzGdme_k3Q/mo/photo.jpg?sz=128", "display_name": "Suman", "link": "https://stackoverflow.com/users/10093490/suman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 425, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531844398, "creation_date": 1531827841, "last_edit_date": 1531827923, "question_id": 51380543, "link": "https://stackoverflow.com/questions/51380543/calculating-arithmetic-mean-using-custom-golang-library", "title": "Calculating Arithmetic Mean using custom Golang Library", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    maths \"github.com/ematvey/go-fn/fn\"\n)\n\nvar avg float64\n\nfunc main() {\n\n    A := []float64{2, 3, 5, 7, 11, 13}\n\n    avg := maths.ArithMean(A)\n    fmt.Println(avg)\n}\n</code></pre>\n\n<p>I am not able to call the ArithMean function. It is giving the error: </p>\n\n<blockquote>\n  <p>cannot use A (type []float64) as type *fn.Vector in argument to fn.ArithMean</p>\n</blockquote>\n"}, {"tags": ["http", "testing", "go", "race-condition"], "answers": [{"comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531830171, "post_id": 51380636, "comment_id": 89734241, "body": "Do you run the race detector? I am on mobile I can&#39;t do it myself but to me it seems like a data-race."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531831327, "post_id": 51380636, "comment_id": 89735067, "body": "<code>handlerIdx</code> is running on another goroutine with the server. But as long as it is only for these tests and the tests does not parel, I think it is ok then."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531831345, "post_id": 51380636, "comment_id": 89735086, "body": "@leafbebop You&#39;re right. Ran the race detector, didn&#39;t find anything, because tests were run sequentially. But you&#39;re right, access to <code>handlerIdx</code> must be synchronized."}, {"owner": {"reputation": 159, "user_id": 108356, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1b59e6a790104d49c17a961e099fb6bf?s=128&d=identicon&r=PG", "display_name": "braz", "link": "https://stackoverflow.com/users/108356/braz"}, "edited": false, "score": 0, "creation_date": 1531835050, "post_id": 51380636, "comment_id": 89737805, "body": "Thanks for explanation and solution. Its a bit confusing that documentation never mentions its not safe to set Config.Handler directly, even worse that tests run fine without -race flag. I will start a new server for every test."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1531832159, "last_edit_date": 1531832159, "creation_date": 1531828132, "answer_id": 51380636, "question_id": 51380383, "link": "https://stackoverflow.com/questions/51380383/race-condition-in-httptestserver-when-changing-handler/51380636#51380636", "title": "Race condition in httptestserver when changing handler", "body": "<p><a href=\"https://golang.org/pkg/net/http/httptest/#Server\" rel=\"nofollow noreferrer\"><code>httptest.Server</code></a> was not \"designed\" to change its handler. You may only change its handler if you've created it with <a href=\"https://golang.org/pkg/net/http/httptest/#NewUnstartedServer\" rel=\"nofollow noreferrer\"><code>httptest.NewUnstartedServer()</code></a>, and only before you start it with <a href=\"https://golang.org/pkg/net/http/httptest/#Server.Start\" rel=\"nofollow noreferrer\"><code>Server.Start()</code></a> or <a href=\"https://golang.org/pkg/net/http/httptest/#Server.StartTLS\" rel=\"nofollow noreferrer\"><code>Server.StartTLS()</code></a>.</p>\n\n<p>Just create and start a new server when you want to test a new handler.</p>\n\n<p>If you have really a lot of handlers you want to test this way and  performance is that critical for you, you may create a \"multiplexer\" handler, and pass that to a single <code>httptest.Server</code>. When you're done testing a handler, change the \"state\" of the multiplexer handler to switch over to the next testable handler.</p>\n\n<p>Let's see an example how it could look like (put all these code into <code>TestAPICaller_RunApiMethod</code>):</p>\n\n<p>Let's say we want to test the following handlers:</p>\n\n<pre><code>handlersToTest := []http.Handler{\n    http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) { w.Write([]byte{0}) }),\n    http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) { w.Write([]byte{1}) }),\n    http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) { w.Write([]byte{2}) }),\n}\n</code></pre>\n\n<p>Here's an example multiplexer handler:</p>\n\n<pre><code>handlerIdx := int32(0)\nmuxHandler := func(w http.ResponseWriter, r *http.Request) {\n    idx := atomic.LoadInt32(&amp;handlerIdx)\n    handlersToTest[idx].ServeHTTP(w, r)\n}\n</code></pre>\n\n<p>Which we use for the test server:</p>\n\n<pre><code>server := httptest.NewServer(http.HandlerFunc(muxHandler))\ndefer server.Close()\n</code></pre>\n\n<p>And code to test all handlers:</p>\n\n<pre><code>for i := range handlersToTest {\n    atomic.StoreInt32(&amp;handlerIdx, int32(i))\n    t.Run(fmt.Sprint(\"Testing idx\", i), func(t *testing.T) {\n        res, err := http.Get(server.URL)\n        if err != nil {\n            log.Fatal(err)\n        }\n        data, err := ioutil.ReadAll(res.Body)\n        if err != nil {\n            log.Fatal(err)\n        }\n        res.Body.Close()\n\n        if len(data) != 1 || data[0] != byte(i) {\n            t.Errorf(\"Expected response %d, got %d\", i, data[0])\n        }\n    })\n}\n</code></pre>\n\n<p>One thing to note here: the \"state\" of the multiplexer handler is the <code>handlerIdx</code> variable. Since the multiplexer handler is called from another goroutine, access to this variable must be synchronized (because we're writing to it and the server's goroutine reads it).</p>\n"}], "owner": {"reputation": 159, "user_id": 108356, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1b59e6a790104d49c17a961e099fb6bf?s=128&d=identicon&r=PG", "display_name": "braz", "link": "https://stackoverflow.com/users/108356/braz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 51380636, "answer_count": 1, "score": 1, "last_activity_date": 1531856294, "creation_date": 1531827304, "last_edit_date": 1531856294, "question_id": 51380383, "link": "https://stackoverflow.com/questions/51380383/race-condition-in-httptestserver-when-changing-handler", "title": "Race condition in httptestserver when changing handler", "body": "<p>I have a slice of tests and I want to run them over one instance of httptest.Server. Each test has its own handler function.</p>\n\n<pre><code>func TestAPICaller_RunApiMethod(t *testing.T) {\n\n    server := httptest.NewServer(http.HandlerFunc(nil))\n    defer server.Close()\n\n    for _, test := range testData {     \n        server.Config.Handler = http.HandlerFunc(test.handler)\n\n        t.Run(test.Name, func(t *testing.T) {\n           ... some code which calls server\n        }\n    })\n}\n</code></pre>\n\n<p>This code gives a race when running with \"go test -race\". It is probably because server runs in goroutine and I'm trying to change a handler concurrently. Am I correct? </p>\n\n<p>If I try alternative code where I create a new server for every test, then no races: </p>\n\n<pre><code>func TestAPICaller_RunApiMethod(t *testing.T) {\n\n    for _, test := range testData {     \n        server := httptest.NewServer(http.HandlerFunc(test.handler))\n\n        t.Run(test.Name, func(t *testing.T) {\n           ... some code which calls server\n        }\n\n        server.Close()\n    })\n}\n</code></pre>\n\n<p>So first question what is the best way to use one server for a slice of tests and change handler on the fly without races? And is it worth it in terms of performance to have one server instead of creating new ones?</p>\n"}, {"tags": ["json", "go", "struct", "marshalling"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 2, "creation_date": 1531823475, "post_id": 51379113, "comment_id": 89729745, "body": "Just add a fied tag <code>json:&quot;-&quot;</code>. Note that this struct is as a whole is not going to be parsed by <code>encoding&#47;json</code> as long as you don&#39;t export fields"}], "answers": [{"comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1531827084, "post_id": 51379168, "comment_id": 89732111, "body": "Seems, reliable way with field of any type(not just int) would be p.rank=new(Person).rank"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 1, "creation_date": 1531827145, "post_id": 51379168, "comment_id": 89732159, "body": "@Uvelichitel But that may be really inefficient, compared to what is needed."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1531836684, "post_id": 51379168, "comment_id": 89739018, "body": "@Uvelichitel You could also do it with reflection if your goal is to expend resources. Go is a type-safe language, you know when you&#39;re writing the code what each field&#39;s type is, there&#39;s no reason to use extra code to figure out the zero value at runtime."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1531823863, "last_edit_date": 1531823863, "creation_date": 1531823468, "answer_id": 51379168, "question_id": 51379113, "link": "https://stackoverflow.com/questions/51379113/golang-unset-struct-field/51379168#51379168", "title": "Golang unset Struct Field", "body": "<p>To unset a field, assign its zero value to it, like:</p>\n\n<pre><code>var p Person\np.rank = 0\n</code></pre>\n\n<p>Also know that if you want to use <code>Person</code> to work with JSON, you have to export the fields, unexported fields are not processed by the <code>encoding/json</code> package, so change <code>Person</code> to:</p>\n\n<pre><code>type Person struct {\n    Name string\n    Age  int\n    rank int\n}\n</code></pre>\n\n<p>This alone will make <code>rank</code> left out from JSON processing, as it is unexported.</p>\n\n<p>If you need to export the <code>rank</code> field too, then use the <code>json:\"-\"</code> tag value to exclude an exported field from JSON processing:</p>\n\n<pre><code>type Person struct {\n    Name string\n    Age  int\n    Rank int `json:\"-\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 510, "user_id": 9149597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f041b176fdf55b7af8b6786c162d8d35?s=128&d=identicon&r=PG&f=1", "display_name": "RKP", "link": "https://stackoverflow.com/users/9149597/rkp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2111, "favorite_count": 0, "accepted_answer_id": 51379168, "answer_count": 1, "score": 2, "last_activity_date": 1531840152, "creation_date": 1531823288, "last_edit_date": 1531840152, "question_id": 51379113, "link": "https://stackoverflow.com/questions/51379113/golang-unset-struct-field", "title": "Golang unset Struct Field", "body": "<p>In Golang, I have below Struct with three fields</p>\n\n<pre><code>type Person struct {\n   name string\n   age  int\n   rank int\n}\n</code></pre>\n\n<p>For Processing, I need a rank field, but for output, I want to exclude the rank field from struct as I am directly passing above struct to JSON encoder to throw a response.</p>\n\n<p>Is there any way by which I can unset rank field from Struct?</p>\n"}, {"tags": ["dictionary", "pointers", "go", "struct", "interface"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1531823253, "post_id": 51379055, "comment_id": 89729602, "body": "This is what <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertions</a> are for. Another mean is <a href=\"https://golang.org/ref/spec#Switch_statements\" rel=\"nofollow noreferrer\">type switches</a>."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1531837270, "last_edit_date": 1531837270, "creation_date": 1531827095, "answer_id": 51380309, "question_id": 51379055, "link": "https://stackoverflow.com/questions/51379055/how-to-cast-an-interface-to-a-struct-pointer/51380309#51380309", "title": "How to cast an interface{} to a struct pointer?", "body": "<p>You can't do that. If you \"wrap\" a non-pointer value in an interface, you can only get a non-pointer value out of it, using either a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a> or a <a href=\"https://golang.org/ref/spec#Switch_statements\" rel=\"nofollow noreferrer\">type switch</a>. And since type assertion expressions are not <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow noreferrer\">addressable</a>, you can't get the address of the \"value\" wrapped in the interface.</p>\n\n<p>If you only have a value wrapped in an interface, you won't be able to get a pointer to the original value that was wrapped in the interface. Why? Because the value wrapped in the interface may only be a copy, completely detached from the original. See examples and explanation here: <a href=\"https://stackoverflow.com/questions/36077566/how-can-a-slice-contain-itself/36078970#36078970\">How can a slice contain itself?</a></p>\n\n<p>Note that under the hood the value actually wrapped may or may not be a pointer (depending on the value's size) even if you wrapped a non-pointer value, but this is implementation detail and is hidden from you. When you extract the value, you will of course get a non-pointer.</p>\n"}], "owner": {"reputation": 1626, "user_id": 1488821, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ff34020e0a05e5f3b45e4e3825bf7c64?s=128&d=identicon&r=PG", "display_name": "Ivan Voras", "link": "https://stackoverflow.com/users/1488821/ivan-voras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "accepted_answer_id": 51380309, "answer_count": 1, "score": 1, "last_activity_date": 1531856346, "creation_date": 1531823138, "last_edit_date": 1531856346, "question_id": 51379055, "link": "https://stackoverflow.com/questions/51379055/how-to-cast-an-interface-to-a-struct-pointer", "title": "How to cast an interface{} to a struct pointer?", "body": "<p>Interfaces already contain a pointer to a value, and I in my case it's a struct, and I need to get a struct pointer out of an interface{}.</p>\n\n<p>The use case is with sync.Map, where I put a struct containing a lock into the map, and with the Load() method I can read an interface{} value. I want to get the pointer to the original struct, so I don't copy the lock.</p>\n\n<p>The alternative is to add a pointer to the struct to the Map instead, then read it back and cast the interface{} to the struct pointer, but I'm curious if the first case can be achieved.</p>\n"}, {"tags": ["pointers", "go", "reflection", "types"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1531822486, "post_id": 51378635, "comment_id": 89729105, "body": "New returns a reflect.Value, calling TypeOf with it as its argument will return the reflect.Type of the reflect.Value type. reflect.Value has a method Type, try that. i.e. <code>reflect.New(t).Type()</code> instead of <code>reflect.TypeOf(reflect.New(t))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1531822557, "creation_date": 1531822557, "answer_id": 51378830, "question_id": 51378635, "link": "https://stackoverflow.com/questions/51378635/how-to-convert-one-reflect-type-to-its-ptr-type/51378830#51378830", "title": "How to convert one reflect.Type to its ptr type?", "body": "<p><a href=\"https://golang.org/pkg/reflect/#New\" rel=\"nofollow noreferrer\"><code>reflect.New()</code></a> returns a value of type <a href=\"https://golang.org/pkg/reflect/#Value\" rel=\"nofollow noreferrer\"><code>reflect.Value()</code></a>. If you pass this to <a href=\"https://golang.org/pkg/reflect/#TypeOf\" rel=\"nofollow noreferrer\"><code>reflect.TypeOf()</code></a>, that will be the descriptor of <code>reflect.Value</code>, not your <code>*T</code>.</p>\n\n<p>Simply call <a href=\"https://golang.org/pkg/reflect/#Value.Type\" rel=\"nofollow noreferrer\"><code>Value.Type()</code></a> from the value returned by <code>reflect.New()</code>:</p>\n\n<pre><code>el := reflect.New(t)\nt = el.Type()\nmt, exists = t.MethodByName(name)\nfmt.Println(t, mt, exists)\n</code></pre>\n"}], "owner": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 51378830, "answer_count": 1, "score": 1, "last_activity_date": 1531823187, "creation_date": 1531822000, "last_edit_date": 1531823187, "question_id": 51378635, "link": "https://stackoverflow.com/questions/51378635/how-to-convert-one-reflect-type-to-its-ptr-type", "title": "How to convert one reflect.Type to its ptr type?", "body": "<p>I have one reflect.Type and I need to call <code>MethodByName</code>. If the method is defined on type <code>T</code>, no problem to find it. If it's defined on <code>*T</code>, this mehtod will return invalid value. So I tried to convert <code>T</code> to <code>*T</code> and failed. Here is what I do:</p>\n\n<p>First, I tried to create a new value from the type. Type infomation seems to lost after creation.</p>\n\n<pre><code>t := reflect.TypeOf(src) // src is interface{} type\nmt, exists := t.MethodByName(name)\nif !exists {\n    el := reflect.New(t)\n    t = reflect.TypeOf(el)\n    mt, exists = t.MethodByName(name)\n    fmt.Println(t, mt, exists)\n}\n</code></pre>\n\n<p>Then, I tried to get type directly from src(the interface type), and failed   also.</p>\n\n<pre><code>t := reflect.TypeOf(src)\nmt, exists := t.MethodByName(name)\nif !exists {\n    t = reflect.TypeOf(&amp;src) // *interface{} type, not what I want\n    mt, exists = t.MethodByName(name)\n    fmt.Println(t, mt, exists)\n}\n</code></pre>\n"}, {"tags": ["database", "postgresql", "rest", "go", "buffalo"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1531820102, "post_id": 51376852, "comment_id": 89727367, "body": "On which line this error occurs can you add a comment to that line in your posted code snippet"}], "answers": [{"comments": [{"owner": {"reputation": 1091, "user_id": 1240938, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2a1d9dcf1bed0566568415137cdcfc79?s=128&d=identicon&r=PG", "display_name": "varnothing", "link": "https://stackoverflow.com/users/1240938/varnothing"}, "edited": false, "score": 0, "creation_date": 1531826338, "post_id": 51378138, "comment_id": 89731557, "body": "I think this is correct way to go, if you can provide some example it&#39;ll be more helpful to golang newbie like me. :)"}], "tags": [], "owner": {"reputation": 316, "user_id": 4901191, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--zVehh4nWiU/AAAAAAAAAAI/AAAAAAAAAGU/8tzmW126jBM/photo.jpg?sz=128", "display_name": "Stanislas Michalak", "link": "https://stackoverflow.com/users/4901191/stanislas-michalak"}, "is_accepted": false, "score": 2, "last_activity_date": 1531820635, "creation_date": 1531820635, "answer_id": 51378138, "question_id": 51376852, "link": "https://stackoverflow.com/questions/51376852/restfull-api-on-model-with-foreign-key/51378138#51378138", "title": "restfull api on model with foreign-key", "body": "<p>You're trying to bind a <code>Track</code> containing a <code>Composer</code> with its ID, but <code>Composer</code> is defined as a struct.</p>\n\n<p>To make it work, you need to implement the <a href=\"https://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"nofollow noreferrer\">Unmarshaler</a> interface and define how to convert this ID into the <code>Composer</code> struct you want.</p>\n"}, {"tags": [], "owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "is_accepted": false, "score": 0, "last_activity_date": 1531843827, "creation_date": 1531843827, "answer_id": 51385959, "question_id": 51376852, "link": "https://stackoverflow.com/questions/51376852/restfull-api-on-model-with-foreign-key/51385959#51385959", "title": "restfull api on model with foreign-key", "body": "<p>You should add a <code>ComposerID</code> field to your <code>Track</code> struct. Then you can use <code>Eager</code> or <code>Load</code>, and pop will load the associated <code>Composer</code> object for you. This is shown on the page you've linked to for your Models reference.</p>\n"}], "owner": {"reputation": 1091, "user_id": 1240938, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2a1d9dcf1bed0566568415137cdcfc79?s=128&d=identicon&r=PG", "display_name": "varnothing", "link": "https://stackoverflow.com/users/1240938/varnothing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1531843827, "creation_date": 1531816939, "question_id": 51376852, "link": "https://stackoverflow.com/questions/51376852/restfull-api-on-model-with-foreign-key", "title": "restfull api on model with foreign-key", "body": "<p><strong>TLDR; How to create REST api on model having Foreign key (or db relationship in general) in buffalo framework?</strong></p>\n\n<p>I am absolute beginner  in go and I am trying to write an RESTFul service using buffalo framework following  following example given on it official website. I am able to create RESTful api on models which have no database relationship. But I am stuck when I faced a situation where model has a foreign key. I am not able to find any documentation or reference on web. I concept on Go is also weak, you can also educate me on those thins. </p>\n\n<p>Models: (ref: <a href=\"https://gobuffalo.io/en/docs/db/relations#example\" rel=\"nofollow noreferrer\">https://gobuffalo.io/en/docs/db/relations#example</a></p>\n\n<pre><code>type Composer struct {\n    ID              uuid.UUID `json:\"id\" db:\"id\"`\n    Name            string    `json:\"name\" db:\"name\"`\n    Description     string    `json:\"description\" db:\"description\"`\n    CreatedAt       time.Time `json:\"created_at\" db:\"created_at\"`\n    UpdatedAt       time.Time `json:\"updated_at\" db:\"updated_at\"`\n\n}\n\n\ntype Track struct {\n    ID          uuid.UUID           `json:\"id\" db:\"id\"`\n    Title       string              `json:\"title\" db:\"title\"`\n    Description string              `json:\"description\" db:\"description\"`\n    Composer    Composer            `has_one:\"composer\" fk_id:\"id\"`\n    CreatedAt   time.Time           `json:\"created_at\" db:\"created_at\"`\n    UpdatedAt   time.Time           `json:\"updated_at\" db:\"updated_at\"`\n}\n</code></pre>\n\n<p>Resources: (ref: <a href=\"https://gobuffalo.io/en/docs/resources\" rel=\"nofollow noreferrer\">https://gobuffalo.io/en/docs/resources</a>)</p>\n\n<pre><code>type TrackResource struct {\n    buffalo.Resource\n}\n\n\nfunc (v TrackResource) List(c buffalo.Context) error {\n    tx, ok := c.Value(\"tx\").(*pop.Connection)\n    if !ok {\n        return errors.WithStack(errors.New(\"no transaction found\"))\n    }\n\n    pieces := &amp;models.Tracks{}\n\n    q := tx.PaginateFromParams(c.Params())\n\n    if err := q.All(pieces); err != nil {\n        return errors.WithStack(err)\n    }\n\n    c.Set(\"pagination\", q.Paginator)\n\n    return c.Render(200, r.JSON(pieces))\n}\n\n\nfunc (v TrackResource) Show(c buffalo.Context) error {\n    tx, ok := c.Value(\"tx\").(*pop.Connection)\n    if !ok {\n        return errors.WithStack(errors.New(\"no transaction found\"))\n    }\n\n    piece := &amp;models.Track{}\n\n    if err := tx.Find(piece, c.Param(\"track_id\")); err != nil {\n        return c.Render(404, r.JSON(err))\n    }\n\n    return c.Render(200, r.JSON(piece))\n}\n\n\nfunc (v TrackResource) Create(c buffalo.Context) error {\n\n    piece := &amp;models.Track{}\n\n    if err := c.Bind(piece); err != nil {\n        return errors.WithStack(err)\n    }\n\n    tx, ok := c.Value(\"tx\").(*pop.Connection)\n    if !ok {\n        return errors.WithStack(errors.New(\"no transaction found\"))\n    }\n\n    verrs, err := piece.Create(tx)\n    if err != nil {\n        return errors.WithStack(err)\n    }\n\n    if verrs.HasAny() {\n        return c.Render(422, r.JSON(verrs))\n    }\n\n    return c.Render(201, r.Auto(c, piece))\n}\n\n\nfunc (v TrackResource) Update(c buffalo.Context) error {\n\n    tx, ok := c.Value(\"tx\").(*pop.Connection)\n    if !ok {\n        return errors.WithStack(errors.New(\"no transaction found\"))\n    }\n\n    piece := &amp;models.Track{}\n\n    if err := tx.Find(piece, c.Param(\"track_id\")); err != nil {\n        return c.Error(404, err)\n    }\n\n    if err := c.Bind(piece); err != nil {\n        return errors.WithStack(err)\n    }\n\n    verrs, err := piece.Update(tx)\n    if err != nil {\n        return errors.WithStack(err)\n    }\n\n    if verrs.HasAny() {\n        return c.Render(422, r.JSON(verrs))\n    }\n\n    return c.Render(200, r.JSON(piece))\n}\n\n\nfunc (v TrackResource) Destroy(c buffalo.Context) error {\n\n    tx, ok := c.Value(\"tx\").(*pop.Connection)\n    if !ok {\n        return errors.WithStack(errors.New(\"no transaction found\"))\n    }\n\n    piece := &amp;models.Track{}\n\n    if err := tx.Find(piece, c.Param(\"track_id\")); err != nil {\n        return c.Error(404, err)\n    }\n\n    if err := tx.Destroy(piece); err != nil {\n        return errors.WithStack(err)\n    }\n\n    return c.Render(200, r.JSON(piece))\n}\n</code></pre>\n\n<p>When I am trying to create a track. I am getting error:</p>\n\n<pre><code>json: cannot unmarshal string into Go struct field Track.Composer of type models.Composer\ngitlab.com/****/****/actions.TrackResource.Create\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/I7aRO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I7aRO.png\" alt=\"enter image description here\"></a></p>\n\n<p>Please help.</p>\n"}, {"tags": ["git", "go", "github", "hyperledger-fabric", "hyperledger"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1531831545, "post_id": 51376830, "comment_id": 89735218, "body": "This is unrelated to the <code>go</code> command; the command that&#39;s failing is <code>git clone</code> for the stated reason. You need to figure out why you can&#39;t connect to <code>github.com:443</code>."}], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 9942350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c3691b98533432ee7d8e05f3a98a194?s=128&d=identicon&r=PG&f=1", "display_name": "Blockchaindeveloper", "link": "https://stackoverflow.com/users/9942350/blockchaindeveloper"}, "is_accepted": true, "score": 0, "last_activity_date": 1532549912, "creation_date": 1532549912, "answer_id": 51527041, "question_id": 51376830, "link": "https://stackoverflow.com/questions/51376830/cannot-connect-to-github-issue-in-download-a-go-function-connection-timed-ou/51527041#51527041", "title": "Cannot connect to GitHub - Issue in download a Go function - Connection timed out", "body": "<p>I was able to resolve this issue by updating inbound and outbound details and selecting the ip address for all SSH,TCP etc as -'from anywhere'</p>\n"}], "owner": {"reputation": 97, "user_id": 9942350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c3691b98533432ee7d8e05f3a98a194?s=128&d=identicon&r=PG&f=1", "display_name": "Blockchaindeveloper", "link": "https://stackoverflow.com/users/9942350/blockchaindeveloper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 51527041, "answer_count": 1, "score": -1, "last_activity_date": 1532549912, "creation_date": 1531816863, "last_edit_date": 1531818844, "question_id": 51376830, "link": "https://stackoverflow.com/questions/51376830/cannot-connect-to-github-issue-in-download-a-go-function-connection-timed-ou", "title": "Cannot connect to GitHub - Issue in download a Go function - Connection timed out", "body": "<p>I am facing an issue while running a Go command for cloning</p>\n\n<pre><code>go get -u --tags nopkcs11 github.com/hyperledger/fabric/core/chaincode/shim\n\n# cd .; git clone https://github.com/hyperledger/fabric /home/ubuntu/go/src/github.com/hyperledger/fabric\nCloning into '/home/ubuntu/go/src/github.com/hyperledger/fabric'...\nfatal: unable to access 'https://github.com/hyperledger/fabric/': Failed to connect to github.com port 443: Connection timed out\npackage github.com/hyperledger/fabric/core/chaincode/shim: exit status 128\n</code></pre>\n\n<p>I am using an AWS virtual machine and I have checked all my inbound traffic. I searched other questions of this website for the same issue but it didn't help. Request you guys to help on this.</p>\n"}, {"tags": ["node.js", "go", "goroutine", "event-loop"], "comments": [{"owner": {"reputation": 3784, "user_id": 6182569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/595afc3cb368ac51e5643e7e71dfdb4d?s=128&d=identicon&r=PG", "display_name": "Mihailo", "link": "https://stackoverflow.com/users/6182569/mihailo"}, "edited": false, "score": 0, "creation_date": 1531816302, "post_id": 51375902, "comment_id": 89724844, "body": "Your code will start <code>len(threads)</code> of <b>goroutines</b> and doesn&#39;t wait for them. So the code fires them up and finishes. The cases you mention don&#39;t make sense."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1531816622, "post_id": 51375902, "comment_id": 89725061, "body": "Your code is also racy, and will randomly crash."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1531816647, "post_id": 51375902, "comment_id": 89725090, "body": "Beyond that, I don&#39;t understand what you&#39;re asking."}, {"owner": {"reputation": 596, "user_id": 4725732, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/47ea99f84a3a1f95009c8dae6b062f7f?s=128&d=identicon&r=PG&f=1", "display_name": "CoderX", "link": "https://stackoverflow.com/users/4725732/coderx"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1531817341, "post_id": 51375902, "comment_id": 89725541, "body": "@Flimzy thanks for pointing that out :)   But that&#39;s not the concern since its just an example. And kindly run the code on your machine to see what I am talking about.  I have modified to include the <b>main()</b> as well."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1531817961, "post_id": 51375902, "comment_id": 89725920, "body": "The reason for my downvote is that the question is based on the ridiculous premise that because you seem to have found a way to make Go hang occasionally, under precise (and buggy) conditions, that it might be an indication that Go won&#39;t perform adequately under a theoretical, unspecified, production workload. This question (wait, is there even a question here?) has too many layers of abstraction, on top of a buggy premise, to be answered."}, {"owner": {"reputation": 3384, "user_id": 3342835, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/7vBYI.jpg?s=128&g=1", "display_name": "li x", "link": "https://stackoverflow.com/users/3342835/li-x"}, "edited": false, "score": 1, "creation_date": 1531818588, "post_id": 51375902, "comment_id": 89726362, "body": "Dunno what kind of crusade your on here, but there isn&#39;t any actual question that is specifically answerable without it being broad and vague, I downvoted your post."}], "answers": [{"comments": [{"owner": {"reputation": 596, "user_id": 4725732, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/47ea99f84a3a1f95009c8dae6b062f7f?s=128&d=identicon&r=PG&f=1", "display_name": "CoderX", "link": "https://stackoverflow.com/users/4725732/coderx"}, "edited": false, "score": 0, "creation_date": 1531819298, "post_id": 51377559, "comment_id": 89726826, "body": "Thanks a lot. This was extremely helpful.   Yeah, I know, this case is very rare :)  just came along an example while studying goRoutines and go Scheduler.  So, had to construct the case for clarification.   Thanks for clearing things up :)"}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 3, "last_activity_date": 1531819091, "last_edit_date": 1531819091, "creation_date": 1531818988, "answer_id": 51377559, "question_id": 51375902, "link": "https://stackoverflow.com/questions/51375902/comparison-of-nodejs-eventloop-with-cluster-module-and-golang-scheduler/51377559#51377559", "title": "Comparison of Nodejs EventLoop (with cluster module) and Golang Scheduler", "body": "<p>Currently (Go 1.11 and earlier versions) your so-called\n<em>tight loop</em> will indeed clog the code.\nThis would happen simply because currently the Go compiler\ninserts code which does \"preemption checks\" (\u00abshould I yield\nto the scheduler so it runs another goroutine?\u00bb) only in\nprologues of the functions it compiles (almost, but let's not digress).\nIf your loop does not call any function, no preemption checks\nwill be made.</p>\n\n<p>The Go developers are well aware of this\nand <a href=\"https://github.com/golang/go/issues/10958\" rel=\"nofollow noreferrer\">are working on eventually alleviating this issue</a>.</p>\n\n<p>Still, note that your alleged problem is a non-issue in\nmost real-world scenarious: the code which performs long\nruns of CPU-intensive work <em>without calling any function</em>\nis rare and far in between.</p>\n\n<p>In the cases, where you really have such code and you <em>have\ndetected</em> it really makes other goroutines starve\n(let me underline: you have detected that through profiling\u2014as\nopposed to just conjuring up \"it must be slow\"), you may\napply several techniques to deal with this:</p>\n\n<ul>\n<li>Insert calls to <a href=\"https://golang.org/pkg/runtime/#Gosched\" rel=\"nofollow noreferrer\"><code>runtime.Gosched()</code></a> in certain key points\nof your long-running CPU-intensive code.\nThis will forcibly relinquish control to another goroutine\nwhile not actually suspending the caller goroutine (so it will\nrun as soon as it will have been scheduled again).</li>\n<li>Dedicate OS threads for the goroutines running\nthose CPU hogs:\n\n<ol>\n<li>Bound the set of such CPU hogs to, say, <code>N</code> \"worker goroutines\";</li>\n<li>Put a dispatcher in front of them (this is called <a href=\"https://blog.golang.org/pipelines#TOC_4.\" rel=\"nofollow noreferrer\">\"fan-out\"</a>);</li>\n<li>Make sure that <code>N</code> is sensibly smaller than <a href=\"https://golang.org/pkg/runtime/#GOMAXPROCS\" rel=\"nofollow noreferrer\"><code>runtime.GOMAXPROCS</code></a>\n<em>or</em> raise the latter so that you have those <code>N</code> extra threads.</li>\n<li>Shovel units of work to those dedicated goroutines via the dispatcher.</li>\n</ol></li>\n</ul>\n"}], "owner": {"reputation": 596, "user_id": 4725732, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/47ea99f84a3a1f95009c8dae6b062f7f?s=128&d=identicon&r=PG&f=1", "display_name": "CoderX", "link": "https://stackoverflow.com/users/4725732/coderx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 1, "accepted_answer_id": 51377559, "answer_count": 1, "score": -2, "last_activity_date": 1531819091, "creation_date": 1531813517, "last_edit_date": 1531817976, "question_id": 51375902, "link": "https://stackoverflow.com/questions/51375902/comparison-of-nodejs-eventloop-with-cluster-module-and-golang-scheduler", "title": "Comparison of Nodejs EventLoop (with cluster module) and Golang Scheduler", "body": "<p>In nodejs the main critics are based on its <em>single threaded event loop model.</em></p>\n\n<p>The biggest disadvantage of nodejs is that one can not perform CPU intensive tasks in the application. For demonstration purpose, lets take the example of a while loop (which is perhaps analogous to a db function returning hundred thousand of records and then processing those records in nodejs.)  </p>\n\n<pre><code>while(1){\n    x++\n}\n</code></pre>\n\n<p>Such sort of the code will block the <em>main stack</em> and consequently all other tasks waiting in the Event Queue will never get the chance to be executed. (and in a web Applications, new users will not be able to connect to the App).  </p>\n\n<p>However, one could possibly use module like <code>cluster</code> to leverage the multi core system and partially solve the above issue. The Cluster module allows one to create a small network of separate processes which can share server ports, which gives the Node.js application access to the full power of the server. (However, one of the biggest disadvantage of using Cluster is that the state cannot be maintained in the application code).\nBut again there is a high possibility that we would end up in the same situation (as described above) again if there is too much server load.   </p>\n\n<p>When I started learning the Go language and had a look at its architecture and goroutines, I thought it would possibly solve the problem that arises due to the single threaded event loop model of nodejs. And that it would probably avoid the above scenario of CPU intensive tasks, until I came across this interesting code, which blocks all of the GO application and nothing happens, much like a while loop in nodejs.    </p>\n\n<pre><code>func main() {\n    var x int\n    threads := runtime.GOMAXPROCS(0)\n    for i := 0; i &lt; threads; i++ {\n        go func() {\n            for { x++ }\n        }()\n    }\n    time.Sleep(time.Second)\n    fmt.Println(\"x =\", x)\n}\n//or perhaps even if we use some number that is just greater than the threads.\n</code></pre>\n\n<p>So, the question is, if I have an application which is load intensive and there would be lot of CPU intensive tasks as well, I could probably get stuck in the above sort of scenario. (where db returns numerous amount of rows and then the application need to process and modify some thing in those rows). Would not the incoming users would be blocked and so would all other tasks as well?     </p>\n\n<p>So, how could the above problem be solved?  </p>\n\n<p>P.S<br>\nOr perhaps, the use cases I have mentioned does not make much of the sense? :)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1292, "user_id": 1479093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d7a14cd513e892a7cac9ebef7dd9165?s=128&d=identicon&r=PG", "display_name": "Jayachandran", "link": "https://stackoverflow.com/users/1479093/jayachandran"}, "edited": false, "score": 0, "creation_date": 1531810276, "post_id": 51374820, "comment_id": 89721289, "body": "What is your executable supposed to do? Is that executable dependent on other files (dlls for example) on a relative path? Can you manually copy the file to the new location and execute it successfully?"}, {"owner": {"reputation": 83, "user_id": 8927786, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BdMJ09pDlmI/AAAAAAAAAAI/AAAAAAAACqo/X6LE-QOP3ds/photo.jpg?sz=128", "display_name": "Pavlo Blazhchuk", "link": "https://stackoverflow.com/users/8927786/pavlo-blazhchuk"}, "reply_to_user": {"reputation": 1292, "user_id": 1479093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d7a14cd513e892a7cac9ebef7dd9165?s=128&d=identicon&r=PG", "display_name": "Jayachandran", "link": "https://stackoverflow.com/users/1479093/jayachandran"}, "edited": false, "score": 0, "creation_date": 1531810827, "post_id": 51374820, "comment_id": 89721600, "body": "@Jayachandran This application just logs some user actions. Only .exe file without any additional libraries. Manually copy works correctly."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1531811370, "post_id": 51374820, "comment_id": 89721925, "body": "You give us some fragments of code. We need reproducible errors. Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a>"}, {"owner": {"reputation": 83, "user_id": 8927786, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BdMJ09pDlmI/AAAAAAAAAAI/AAAAAAAACqo/X6LE-QOP3ds/photo.jpg?sz=128", "display_name": "Pavlo Blazhchuk", "link": "https://stackoverflow.com/users/8927786/pavlo-blazhchuk"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1531816793, "post_id": 51374820, "comment_id": 89725195, "body": "@peterSO Thanks for the comment, I updated my question and added additional code samples."}], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 8927786, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BdMJ09pDlmI/AAAAAAAAAAI/AAAAAAAACqo/X6LE-QOP3ds/photo.jpg?sz=128", "display_name": "Pavlo Blazhchuk", "link": "https://stackoverflow.com/users/8927786/pavlo-blazhchuk"}, "is_accepted": true, "score": -1, "last_activity_date": 1531830211, "creation_date": 1531830211, "answer_id": 51381310, "question_id": 51374820, "link": "https://stackoverflow.com/questions/51374820/copy-executable-golang-file-to-another-folder/51381310#51381310", "title": "Copy executable golang file to another folder", "body": "<p>I have found an error.</p>\n\n<blockquote>\n  <p>The process cannot access the file because it is being used by another process.</p>\n</blockquote>\n\n<p>I was trying to copy the .exe file to its own path.</p>\n\n<pre><code>func copy(src, dst string) error {\n    if _, err := os.Stat(dst); os.IsNotExist(err) {\n        in, err := os.Open(src)\n        if err != nil {\n            return err\n        }\n        defer in.Close()\n\n        out, err := os.Create(dst)\n        if err != nil {\n            return err\n        }\n        defer out.Close()\n\n        _, err = io.Copy(out, in)\n        if err != nil {\n            return err\n        }\n    }\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 8927786, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BdMJ09pDlmI/AAAAAAAAAAI/AAAAAAAACqo/X6LE-QOP3ds/photo.jpg?sz=128", "display_name": "Pavlo Blazhchuk", "link": "https://stackoverflow.com/users/8927786/pavlo-blazhchuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "accepted_answer_id": 51381310, "answer_count": 1, "score": -1, "last_activity_date": 1531830211, "creation_date": 1531809784, "last_edit_date": 1531815265, "question_id": 51374820, "link": "https://stackoverflow.com/questions/51374820/copy-executable-golang-file-to-another-folder", "title": "Copy executable golang file to another folder", "body": "<p>I wonder if possible to copy running .exe file to another folder. I am trying to do this using usual copy approach in Go like that.</p>\n\n<pre><code>func copy(src, dst string) error {\n    in, err := os.Open(src)\n    if err != nil {\n        return err\n    }\n    defer in.Close()\n\n    out, err := os.Create(dst)\n    if err != nil {\n        return err\n    }\n    defer out.Close()\n\n    _, err = io.Copy(out, in)\n    if err != nil {\n        return err\n    }\n    return out.Close()\n}\n</code></pre>\n\n<p>...</p>\n\n<pre><code>copyErr := copy(os.Args[0], \"D:\"+\"\\\\\"+\"whs.exe\")\nif copyErr != nil {\n    log.Panicf(\"copy -&gt; %v\", copyErr)\n}\n</code></pre>\n\n<p>The file copied with the same size but I can't open it correctly. I have only a fast cmd flash. After several milliseconds, cmd is closing and I can't see even any errors.\nI was trying to write errors to log file but it's empty.</p>\n\n<pre><code>f, err := os.OpenFile(\"debug.log\", os.O_RDWR|os.O_CREATE|os.O_APPEND, 0777)\nif err != nil {\n    log.Panicf(\"setLogOutput -&gt; %v\", err)\n}\ndefer f.Close()\n\nlog.SetOutput(f)\n</code></pre>\n\n<p>If I open not copied .exe file everything works correctly.</p>\n\n<p>I've reduced my program to only one main method. The result was the same.</p>\n\n<pre><code>func main() {\n    log.Println(\"Starting...\")\n    copyErr := copy(os.Args[0], \"F:\"+\"\\\\\"+\"whs.exe\")\n    if copyErr != nil {\n        log.Panicf(\"copy -&gt; %v\", copyErr)\n    }\n    os.Stdin.Read([]byte{0})\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "encryption"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1531812287, "post_id": 51374801, "comment_id": 89722450, "body": "The &quot;event&quot; is the actual call to your <code>GetBSON()</code> and <code>SetBSON()</code> methods."}], "answers": [{"tags": [], "owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "is_accepted": true, "score": 0, "last_activity_date": 1576185734, "creation_date": 1576185734, "answer_id": 59312908, "question_id": 51374801, "link": "https://stackoverflow.com/questions/51374801/golang-mongodb-field-level-encryption/59312908#59312908", "title": "Golang mongodb field level encryption", "body": "<blockquote>\n  <p>Since mongodb does not support field level encryption</p>\n</blockquote>\n\n<p>MongoDB v4.2 now supports <a href=\"https://docs.mongodb.com/manual/core/security-client-side-encryption/\" rel=\"nofollow noreferrer\">Client-Side Field Level Encryption</a>, see also <a href=\"https://www.mongodb.com/blog/post/field-level-encryption-is-ga\" rel=\"nofollow noreferrer\">Field Level Encryption is GA</a>. There are two supported types: </p>\n\n<ul>\n<li><p><a href=\"https://docs.mongodb.com/manual/core/security-explicit-client-side-encryption/\" rel=\"nofollow noreferrer\">Manual Client-Side Field Level Encryption</a></p>\n\n<p>Applications must modify any code associated with constructing read and write operations to include encryption/decryption logic via the driver encryption library. Applications are responsible for selecting the appropriate data encryption key for encryption/decryption on a per-operation basis.</p></li>\n<li><p><a href=\"https://docs.mongodb.com/manual/core/security-automatic-client-side-encryption/\" rel=\"nofollow noreferrer\">Automatic Client-Side Field Level Encryption</a> (available only on <a href=\"https://www.mongodb.com/cloud/atlas\" rel=\"nofollow noreferrer\">MongoDB Atlas</a>, or <a href=\"https://www.mongodb.com/products/mongodb-enterprise-advanced\" rel=\"nofollow noreferrer\">MongoDB Enterprise Advanced</a>) </p>\n\n<p>Applications do not have to modify code associated with the read/write operation.</p></li>\n</ul>\n\n<p>Looking at your requirements, it seems that you'd want the <code>automatic</code> encryption/decryption. You can try this with Free-Tier Atlas cluster see: <a href=\"https://docs.atlas.mongodb.com/getting-started/\" rel=\"nofollow noreferrer\">Getting Started with Atlas</a>. </p>\n\n<blockquote>\n  <p>encrypt certain fields in mongodb using mgo and Golang</p>\n</blockquote>\n\n<p>Unfortunately this is not available on <a href=\"https://github.com/globalsign/mgo\" rel=\"nofollow noreferrer\">mgo</a>, but on <a href=\"https://godoc.org/go.mongodb.org/mongo-driver/mongo\" rel=\"nofollow noreferrer\">mongo-go-driver</a> v1.2+. You can see some examples on <a href=\"https://godoc.org/go.mongodb.org/mongo-driver/mongo#hdr-Client_Side_Encryption\" rel=\"nofollow noreferrer\">MongoDB Go driver: Client Side Encryption</a>. An example to create a <code>MongoClient</code> configured with auto encryption is: </p>\n\n<pre><code>func createEncryptedClient() *mongo.Client {\n        // create a client with auto encryption\n        schemaMap := map[string]interface{}{\n                \"foo.bar\": readJSONFile(\"collection_schema.json\"),\n        }\n        autoEncOpts := options.AutoEncryption().\n                SetKeyVaultNamespace(\"keyvault.__datakeys\").\n                SetKmsProviders(kmsProviders).\n                SetSchemaMap(schemaMap)\n\n        clientOpts := options.Client().ApplyURI(uri).SetAutoEncryptionOptions(autoEncOpts)\n        autoEncryptionClient, err := mongo.Connect(ctx, clientOpts)\n        if err != nil {\n                log.Fatalf(\"Connect error for client with automatic encryption: %v\", err)\n        }\n        return autoEncryptionClient\n}\n</code></pre>\n\n<p>See also <a href=\"https://github.com/mongodb-labs/field-level-encryption-sandbox/tree/master/go\" rel=\"nofollow noreferrer\">github.com/mongodb-labs/field-level-encryption-sandbox</a></p>\n"}], "owner": {"reputation": 1170, "user_id": 4732633, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh6.googleusercontent.com/-3EqkwkKBaTo/AAAAAAAAAAI/AAAAAAAAAAA/hhuYb3A-0qo/photo.jpg?sz=128", "display_name": "Rahul Ganguly", "link": "https://stackoverflow.com/users/4732633/rahul-ganguly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "accepted_answer_id": 59312908, "answer_count": 1, "score": 1, "last_activity_date": 1576185734, "creation_date": 1531809705, "question_id": 51374801, "link": "https://stackoverflow.com/questions/51374801/golang-mongodb-field-level-encryption", "title": "Golang mongodb field level encryption", "body": "<p>I am trying to encrypt certain fields in mongodb using mgo and Golang. Since mongodb does not support field level encryption , I was thinking of encrypting and decrypting the data while marshalling the data and unmarshalling the data.</p>\n\n<p>For example, in the struct below I want to encrypt Name and Gender</p>\n\n<p>if my struct as like this</p>\n\n<pre><code>type User struct {\nUserID      string `json:\"userID,omitempty\" bson:\"userID,omitempty\"`\nUserName    string `json:\"userName,omitempty\" bson:\"userName,omitempty\"`\nUserAge   string `json:\"userAge,omitempty\" bson:\"userAge,omitempty\"`\nUserGender string `json:\"userGender,omitempty\" bson:\"userGender,omitempty\"`\n}\n</code></pre>\n\n<p>One way to solve this is after marshalling the data, encrypt the data before saving in the db, and a similar approach for sending the data back to the UI.  Is there an event that I can listen to before the marshalling and unmarshalling of data? or is there a better way to do it? </p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 4807, "user_id": 7581078, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a38b827703f4a9d3f237866ab72ec04a?s=128&d=identicon&r=PG&f=1", "display_name": "david_k", "link": "https://stackoverflow.com/users/7581078/david-k"}, "edited": false, "score": 0, "creation_date": 1531812559, "post_id": 51372306, "comment_id": 89722607, "body": "This looks like an issue with docker, not an issue with hyperledger fabric or hyperledger composer, might be worth changing the tags to reflect this."}, {"owner": {"reputation": 3572, "user_id": 1037295, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/8a4b0b11ae8fcdc4690db9fa4eb63280?s=128&d=identicon&r=PG", "display_name": "yong ho", "link": "https://stackoverflow.com/users/1037295/yong-ho"}, "reply_to_user": {"reputation": 4807, "user_id": 7581078, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a38b827703f4a9d3f237866ab72ec04a?s=128&d=identicon&r=PG&f=1", "display_name": "david_k", "link": "https://stackoverflow.com/users/7581078/david-k"}, "edited": false, "score": 0, "creation_date": 1532421717, "post_id": 51372306, "comment_id": 89956704, "body": "@david_k So how to fix this issue? I have docker running on the menu bar."}, {"owner": {"reputation": 4807, "user_id": 7581078, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a38b827703f4a9d3f237866ab72ec04a?s=128&d=identicon&r=PG&f=1", "display_name": "david_k", "link": "https://stackoverflow.com/users/7581078/david-k"}, "edited": false, "score": 0, "creation_date": 1532427387, "post_id": 51372306, "comment_id": 89960036, "body": "Sorry I have no idea. Personally I don&#39;t bother with running docker on a mac since all it does is use a linux VM under the covers. I just prefer to work directly with my own linux VM."}], "owner": {"reputation": 3572, "user_id": 1037295, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/8a4b0b11ae8fcdc4690db9fa4eb63280?s=128&d=identicon&r=PG", "display_name": "yong ho", "link": "https://stackoverflow.com/users/1037295/yong-ho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531829294, "creation_date": 1531793632, "last_edit_date": 1531829294, "question_id": 51372306, "link": "https://stackoverflow.com/questions/51372306/downloadfabric-sh-unexpected-fault-address-0x183e42838582", "title": "./downloadFabric.sh unexpected fault address 0x183e42838582", "body": "<p>When I am executing this command: <code>./downloadFabric.sh</code>. The error:</p>\n\n<pre><code>Development only script for Hyperledger Fabric control\nRunning 'downloadFabric.sh'\nFABRIC_VERSION is unset, assuming hlfv11\nFABRIC_START_TIMEOUT is unset, assuming 15 (seconds)\nunexpected fault address 0x183e42838582\nfatal error: fault\n[signal 0xb code=0x1 addr=0x183e42838582 pc=0x183e42838582]\n\ngoroutine 17 [running]:\nruntime.throw(0x664da8, 0x5)\n    /usr/local/go/src/runtime/panic.go:527 +0x90 fp=0xc820041928 sp=0xc820041910\nruntime.sigpanic()\n    /usr/local/go/src/runtime/sigpanic_unix.go:27 +0x2ba fp=0xc820041978 sp=0xc820041928\nnet/http.(*Transport).dial(0xc82007a630, 0x666de8, 0x3, 0xc820302820, 0x17, 0x0, 0x0, 0x0, 0x0)\n    /usr/local/go/src/net/http/transport.go:499 +0x79 fp=0xc8200419c0 sp=0xc820041978\nnet/http.(*Transport).dialConn(0xc82007a630, 0x0, 0x665378, 0x4, 0xc820302820, 0x17, 0xc82018ae40, 0x0, 0x0)\n    /usr/local/go/src/net/http/transport.go:596 +0x19a9 fp=0xc820041f00 sp=0xc8200419c0\nnet/http.(*Transport).getConn.func4(0xc82007a630, 0x0, 0x665378, 0x4, 0xc820302820, 0x17, 0xc8203320c0)\n    /usr/local/go/src/net/http/transport.go:549 +0x66 fp=0xc820041f78 sp=0xc820041f00\nruntime.goexit()\n    /usr/local/go/src/runtime/asm_amd64.s:1721 +0x1 fp=0xc820041f80 sp=0xc820041f78\ncreated by net/http.(*Transport).getConn\n    /usr/local/go/src/net/http/transport.go:551 +0x265\n\ngoroutine 1 [select]:\nnet/http.(*Transport).getConn(0xc82007a630, 0xc82033c000, 0x0, 0x665378, 0x4, 0xc820302820, 0x17, 0x0, 0x0, 0x0)\n    /usr/local/go/src/net/http/transport.go:554 +0x663\nnet/http.(*Transport).RoundTrip(0xc82007a630, 0xc82033c000, 0xb2, 0x0, 0x0)\n    /usr/local/go/src/net/http/transport.go:228 +0x4ac\nnet/http.send(0xc82033c000, 0xbf3548, 0xc82007a630, 0xc8203064d0, 0x0, 0x0)\n    /usr/local/go/src/net/http/client.go:220 +0x52c\nnet/http.(*Client).send(0xc820261c50, 0xc82033c000, 0x68, 0x0, 0x0)\n    /usr/local/go/src/net/http/client.go:143 +0x15a\nnet/http.(*Client).doFollowingRedirects(0xc820261c50, 0xc82033c000, 0x776560, 0x0, 0x0, 0x0)\n    /usr/local/go/src/net/http/client.go:380 +0xbc0\nnet/http.(*Client).Do(0xc820261c50, 0xc82033c000, 0xc, 0x0, 0x0)\n    /usr/local/go/src/net/http/client.go:178 +0x188\ngithub.com/docker/engine-api/client.(*Client).sendClientRequest(0xc8202b6cb0, 0x6630e0, 0x4, 0x66a7b0, 0xe, 0xc82030a810, 0xbf8438, 0xc820306380, 0xc82030a840, 0x5fe7e0, ...)\n    /go/src/github.com/docker/docker/vendor/src/github.com/docker/engine-api/client/request.go:91 +0x3cd\ngithub.com/docker/engine-api/client.(*Client).sendRequest(0xc8202b6cb0, 0x6630e0, 0x4, 0x66a7b0, 0xe, 0xc82030a810, 0x0, 0x0, 0xc82030a840, 0x958e00, ...)\n    /go/src/github.com/docker/docker/vendor/src/github.com/docker/engine-api/client/request.go:69 +0x296\ngithub.com/docker/engine-api/client.(*Client).post(0xc8202b6cb0, 0x66a7b0, 0xe, 0xc82030a810, 0x0, 0x0, 0xc82030a840, 0x20, 0x0, 0x0)\n    /go/src/github.com/docker/docker/vendor/src/github.com/docker/engine-api/client/request.go:33 +0x94\ngithub.com/docker/engine-api/client.(*Client).tryImageCreate(0xc8202b6cb0, 0xc82030a810, 0xc820302760, 0x20, 0xc82030a810, 0x0, 0x0)\n    /go/src/github.com/docker/docker/vendor/src/github.com/docker/engine-api/client/image_create.go:25 +0x14c\ngithub.com/docker/engine-api/client.(*Client).ImagePull(0xc8202b6cb0, 0xc82030a690, 0x24, 0x0, 0x0, 0xc820302760, 0x20, 0xc82030a660, 0x0, 0x0, ...)\n    /go/src/github.com/docker/docker/vendor/src/github.com/docker/engine-api/client/image_pull.go:22 +0x2b1\ngithub.com/docker/docker/api/client.(*DockerCli).imagePullPrivileged(0xc8201a4d00, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n    /go/src/github.com/docker/docker/api/client/pull.go:80 +0x155\ngithub.com/docker/docker/api/client.(*DockerCli).CmdPull(0xc8201a4d00, 0xc82000a230, 0x1, 0x1, 0x0, 0x0)\n    /go/src/github.com/docker/docker/api/client/pull.go:65 +0xa3c\nreflect.callMethod(0xc820261cb0, 0xc820145c28)\n    /usr/local/go/src/reflect/value.go:628 +0x1fc\nreflect.methodValueCall(0xc82000a230, 0x1, 0x1, 0x1, 0xc820261cb0, 0x0, 0x0, 0xc820261cb0, 0x0, 0x66834, ...)\n    /usr/local/go/src/reflect/asm_amd64.s:29 +0x36\ngithub.com/docker/docker/cli.(*Cli).Run(0xc820261800, 0xc82000a220, 0x2, 0x2, 0x0, 0x0)\n    /go/src/github.com/docker/docker/cli/cli.go:89 +0x383\nmain.main()\n    /go/src/github.com/docker/docker/docker/docker.go:63 +0x43c\n\ngoroutine 5 [syscall]:\nos/signal.loop()\n    /usr/local/go/src/os/signal/signal_unix.go:22 +0x18\ncreated by os/signal.init.1\n    /usr/local/go/src/os/signal/signal_unix.go:28 +0x37\n\ngoroutine 7 [runnable]:\nruntime.SetFinalizer(0x64f540, 0xc8202b6ee0, 0x0, 0x0)\n    /usr/local/go/src/runtime/mfinal.go:261\nnet.(*netFD).destroy(0xc8202b6ee0)\n    /usr/local/go/src/net/fd_unix.go:137 +0x7e\nnet.(*netFD).decref(0xc8202b6ee0)\n    /usr/local/go/src/net/fd_unix.go:153 +0x40\nnet.(*netFD).Close(0xc8202b6ee0, 0x0, 0x0)\n    /usr/local/go/src/net/fd_unix.go:199 +0x87\nnet.(*conn).Close(0xc82002c418, 0x0, 0x0)\n    /usr/local/go/src/net/net.go:196 +0xab\nnet/http.(*persistConn).closeLocked(0xc820094210)\n    /usr/local/go/src/net/http/transport.go:1248 +0x4e\nnet/http.(*persistConn).close(0xc820094210)\n    /usr/local/go/src/net/http/transport.go:1242 +0x7a\nnet/http.(*persistConn).readLoop(0xc820094210)\n    /usr/local/go/src/net/http/transport.go:1004 +0x954\ncreated by net/http.(*Transport).dialConn\n    /usr/local/go/src/net/http/transport.go:685 +0xc78\n\ngoroutine 8 [select]:\nnet/http.(*persistConn).writeLoop(0xc820094210)\n    /usr/local/go/src/net/http/transport.go:1009 +0x40c\ncreated by net/http.(*Transport).dialConn\n    /usr/local/go/src/net/http/transport.go:686 +0xc9d\n</code></pre>\n\n<p>Version used: go version 1.10.3</p>\n\n<p>Operating System and version (desktop or mobile): Mac OS 10.13.6</p>\n"}, {"tags": ["go", "synchronization"], "comments": [{"owner": {"reputation": 207, "user_id": 8761117, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/16acc432246d077441e7eeb7a2d116cb?s=128&d=identicon&r=PG&f=1", "display_name": "HowToGo", "link": "https://stackoverflow.com/users/8761117/howtogo"}, "edited": false, "score": 1, "creation_date": 1531787158, "post_id": 51371587, "comment_id": 89715315, "body": "It seems like it actually works. Just had to give some time to start goroutines."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1531788975, "post_id": 51371587, "comment_id": 89715593, "body": "Yup, Broadcast is called in main before the goroutines call Wait."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1531808501, "post_id": 51371587, "comment_id": 89720306, "body": "A minor nitpick: a mutex can be declared way simpler using just <code>var M sync.Mutex</code>. Your cond var can also be declared simpler by just <code>var C = sync.NewCond(&amp;M)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 8761117, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/16acc432246d077441e7eeb7a2d116cb?s=128&d=identicon&r=PG&f=1", "display_name": "HowToGo", "link": "https://stackoverflow.com/users/8761117/howtogo"}, "edited": false, "score": 0, "creation_date": 1531834454, "post_id": 51375225, "comment_id": 89737339, "body": "Yeah, thanks. I realised it after i posted the question."}], "tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": true, "score": 2, "last_activity_date": 1531811309, "creation_date": 1531811309, "answer_id": 51375225, "question_id": 51371587, "link": "https://stackoverflow.com/questions/51371587/broadcast-in-golang/51375225#51375225", "title": "Broadcast() in Golang", "body": "<p>As mentioned in the comments, the call to broadcast is probably happening before the goroutines get to <code>C.Wait()</code></p>\n\n<p>You can fix this with another part of the <code>sync</code> package. A <code>WaitGroup</code></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nvar M sync.Mutex\nvar C *sync.Cond = sync.NewCond(&amp;M)\nvar wg sync.WaitGroup // create a wait group\n\nfunc ff(){\n    wg.Done() // tell the group that one routine has started\n    M.Lock()\n    C.Wait()\n    fmt.Println(\"broadcasting\")\n    M.Unlock()\n}\n\nfunc main() {\n\n    num := [6]int{}\n\n    wg.Add(len(num)) // tell the group you are waiting for len(num) goroutines to start\n    for _, _= range num {\n        go ff()\n    }  \n\n    M.Lock()\n    wg.Wait() // wait for all the routines to start\n    C.Broadcast()\n    M.Unlock()\n\n    fmt.Println(\"done\")\n    time.Sleep(5 * time.Second)\n}\n</code></pre>\n\n<p>Also; it is not strictly necessary for you to hold the lock on <code>M sync.Mutex</code> when calling <code>C.Broadcast()</code></p>\n\n<p>From the docs:</p>\n\n<blockquote>\n  <p>It is allowed but not required for the caller to hold c.L during the call.</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/pkg/sync/#Cond\" rel=\"nofollow noreferrer\">https://golang.org/pkg/sync/#Cond</a></p>\n"}], "owner": {"reputation": 207, "user_id": 8761117, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/16acc432246d077441e7eeb7a2d116cb?s=128&d=identicon&r=PG&f=1", "display_name": "HowToGo", "link": "https://stackoverflow.com/users/8761117/howtogo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1028, "favorite_count": 0, "closed_date": 1531821055, "accepted_answer_id": 51375225, "answer_count": 1, "score": 1, "last_activity_date": 1531811309, "creation_date": 1531786870, "question_id": 51371587, "link": "https://stackoverflow.com/questions/51371587/broadcast-in-golang", "closed_reason": "Not suitable for this site", "title": "Broadcast() in Golang", "body": "<p>I am trying to use Broadcast() function from \"sync\" but it does not work as i wish to.</p>\n\n<p>I need to lock execution for all of the goroutines and then simply by calling C.Broadcast() release them and let them execute but it is not happening. </p>\n\n<p>How can i make it work?</p>\n\n<p>This is everything what is written in docs **Broadcast wakes all goroutines waiting on *sync.Cond. ** </p>\n\n<p>Here is the code i am trying to make work:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nvar M sync.Mutex = sync.Mutex{}\nvar C *sync.Cond = sync.NewCond(&amp;M)\n\nfunc ff(){\n    M.Lock()\n    C.Wait()\n    fmt.Println(\"broadcasting\")\n    M.Unlock()\n}\n\nfunc main() {\n\n    num := [6]int{}\n\n    for _, _= range num {\n        go ff()\n    }  \n\n    M.Lock()\n    C.Broadcast()\n    M.Unlock()\n\n    fmt.Println(\"done\")\n    time.Sleep(5 * time.Second)\n}\n</code></pre>\n"}, {"tags": ["go", "wifi", "netlink"], "answers": [{"tags": [], "owner": {"reputation": 197, "user_id": 5578790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IdI7U.jpg?s=128&g=1", "display_name": "Danek Duvall", "link": "https://stackoverflow.com/users/5578790/danek-duvall"}, "is_accepted": false, "score": 0, "last_activity_date": 1531853884, "creation_date": 1531853884, "answer_id": 51388523, "question_id": 51370678, "link": "https://stackoverflow.com/questions/51370678/netlink-sequence-numbers-out-of-sequence/51388523#51388523", "title": "netlink sequence numbers out of sequence", "body": "<p>I still don't understand why this situation occurs, but it appears the TL;DR fix is to read the next packet: it will have the same data with the correct sequence number.</p>\n\n<p>I tried writing a program with a different <a href=\"https://github.com/vishvananda/netlink/\" rel=\"nofollow noreferrer\">netlink package</a>, and discovered that while it had the same issue, it repeated the <code>recvmsg()</code> call when it runs into this situation.  The code that does that is here:</p>\n\n<p><a href=\"https://github.com/vishvananda/netlink/blob/a06dabf/nl/nl_linux.go#L425\" rel=\"nofollow noreferrer\">https://github.com/vishvananda/netlink/blob/a06dabf/nl/nl_linux.go#L425</a></p>\n\n<p>The commit that introduced that code doesn't explain why this loop is correct, but emulating it in the other package takes care of the problem.</p>\n"}], "owner": {"reputation": 197, "user_id": 5578790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IdI7U.jpg?s=128&g=1", "display_name": "Danek Duvall", "link": "https://stackoverflow.com/users/5578790/danek-duvall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 370, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531853884, "creation_date": 1531778559, "question_id": 51370678, "link": "https://stackoverflow.com/questions/51370678/netlink-sequence-numbers-out-of-sequence", "title": "netlink sequence numbers out of sequence", "body": "<p>I'm using the <a href=\"https://github.com/mdlayher/netlink\" rel=\"nofollow noreferrer\"><code>netlink</code></a> and <a href=\"https://github.com/mdlayher/genetlink\" rel=\"nofollow noreferrer\"><code>genetlink</code></a> Go packages to write a utility to interact with the <code>MAC80211_HWSIM</code> netlink family functions. It's working well ... almost.</p>\n\n<p>I'm finding that if I do a <code>GET_RADIO</code> call, the next call into the family fails to validate because the sequence number of the response doesn't match that of the request.  Specifically, the pattern I see is</p>\n\n<pre><code>GET_RADIO request:  seq=655\nGET_RADIO response: seq=655\nDEL_RADIO request:  seq=656\nDEL_RADIO response: seq=655\n</code></pre>\n\n<p>It doesn't matter which command I issue after <code>GET_RADIO</code>, this same pattern shows up. If <code>GET_RADIO</code> isn't in the mix, then the sequence numbers are exactly as expected.</p>\n\n<p>There's an existing command written in C, using <code>libnl</code> and <code>libgenl</code>, which I modified to run more than one command. As best I can tell, that implementation does a very similar thing, but doesn't have the issue with the sequence numbers, so I'm disinclined to think the problem lies with the kernel module. But strace clearly shows that the kernel is responding with an out-of-sequence number (please forgive the excessive side-scrolling):</p>\n\n<pre><code>socket(AF_NETLINK, SOCK_RAW, NETLINK_GENERIC) = 3\nbind(3, {sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, 12) = 0\ngetsockname(3, {sa_family=AF_NETLINK, nl_pid=18357, nl_groups=00000000}, [112-&gt;12]) = 0\nsendmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=12, msg_iov=[{iov_base={{len=40, type=0x10 /* NLMSG_??? */, flags=NLM_F_REQUEST, seq=2596996163, pid=18357}, \"\\3\\1\\0\\0\\23\\0\\2\\0MAC80211_HWSIM\\0\\0\"}, iov_len=40}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 40\nrecvmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=112-&gt;12, msg_iov=[{iov_base=[{{len=224, type=0x10 /* NLMSG_??? */, flags=0, seq=2596996163, pid=18357}, \"\\1\\2\\0\\0\\23\\0\\2\\0MAC80211_HWSIM\\0\\0\\6\\0\\1\\0\\31\\0\\0\\0\"...}, {{len=0, type=0 /* NLMSG_??? */, flags=0, seq=0, pid=0}}], iov_len=4096}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, MSG_PEEK) = 224\nrecvmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=112-&gt;12, msg_iov=[{iov_base=[{{len=224, type=0x10 /* NLMSG_??? */, flags=0, seq=2596996163, pid=18357}, \"\\1\\2\\0\\0\\23\\0\\2\\0MAC80211_HWSIM\\0\\0\\6\\0\\1\\0\\31\\0\\0\\0\"...}, {{len=0, type=0 /* NLMSG_??? */, flags=0, seq=0, pid=0}}], iov_len=4096}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 224\nsendmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=12, msg_iov=[{iov_base={{len=28, type=0x19 /* NLMSG_??? */, flags=NLM_F_REQUEST|NLM_F_ACK, seq=2596996164, pid=18357}, \"\\6\\1\\0\\0\\10\\0\\n\\0T\\0\\0\\0\"}, iov_len=28}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 28\nrecvmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=112-&gt;12, msg_iov=[{iov_base=[{{len=48, type=0x19 /* NLMSG_??? */, flags=0, seq=2596996164, pid=18357}, \"\\6\\1\\0\\0\\10\\0\\n\\0T\\0\\0\\0\\10\\0\\t\\0\\1\\0\\0\\0\\t\\0\\21\\0phy84\\0\\0\\0\"}, {{len=0, type=0 /* NLMSG_??? */, flags=0, seq=0, pid=0}}], iov_len=4096}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, MSG_PEEK) = 48\nrecvmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=112-&gt;12, msg_iov=[{iov_base=[{{len=48, type=0x19 /* NLMSG_??? */, flags=0, seq=2596996164, pid=18357}, \"\\6\\1\\0\\0\\10\\0\\n\\0T\\0\\0\\0\\10\\0\\t\\0\\1\\0\\0\\0\\t\\0\\21\\0phy84\\0\\0\\0\"}, {{len=0, type=0 /* NLMSG_??? */, flags=0, seq=0, pid=0}}], iov_len=4096}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 48\nsendmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=12, msg_iov=[{iov_base={{len=28, type=0x19 /* NLMSG_??? */, flags=NLM_F_REQUEST|NLM_F_ACK, seq=2596996165, pid=18357}, \"\\5\\1\\0\\0\\10\\0\\n\\0T\\0\\0\\0\"}, iov_len=28}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 28\nrecvmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=112-&gt;12, msg_iov=[{iov_base=[{{len=36, type=NLMSG_ERROR, flags=0, seq=2596996164, pid=18357}, \"\\0\\0\\0\\0\\34\\0\\0\\0\\31\\0\\5\\0D\\4\\313\\232\\265G\\0\\0\"}, {{len=0, type=0 /* NLMSG_??? */, flags=0, seq=0, pid=0}}], iov_len=4096}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, MSG_PEEK) = 36\nrecvmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=112-&gt;12, msg_iov=[{iov_base=[{{len=36, type=NLMSG_ERROR, flags=0, seq=2596996164, pid=18357}, \"\\0\\0\\0\\0\\34\\0\\0\\0\\31\\0\\5\\0D\\4\\313\\232\\265G\\0\\0\"}, {{len=0, type=0 /* NLMSG_??? */, flags=0, seq=0, pid=0}}], iov_len=4096}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 36\nclose(3)                                = 0\n+++ exited with 0 +++\n</code></pre>\n\n<p>Note that there are two <code>recvmsg()</code> calls for each <code>sendmsg()</code> because the first one simply does a <code>MSG_PEEK</code> to see if an answer is available.  Of the three sets of requests and responses, the first (sequence ...163) is simply getting the family information.  The second (sequence 164) is doing the <code>GET_RADIO</code> (<code>\\6</code>) call, and the third is the one with the out-of-sequence response: this <code>DEL_RADIO</code> (<code>\\5</code>) call sends a message with a ...165 sequence number, but the response that comes back, otherwise well-formed, has a sequence number matching the previous command: ...164.</p>\n\n<p>Because this is Go, there are multiple threads active at once, but all the calls in the strace output above are from the same thread. The only calls missing from the trace are those to <code>futex()</code>.</p>\n\n<p>The C version, because it uses the callback mechanisms provided by <code>libnl</code> and <code>libgenl</code>, does process the response in a different thread than the request came from.  The request trace:</p>\n\n<pre><code>socket(AF_NETLINK, SOCK_RAW|SOCK_CLOEXEC, NETLINK_GENERIC) = 3\nsetsockopt(3, SOL_SOCKET, SO_SNDBUF, [32768], 4) = 0\nsetsockopt(3, SOL_SOCKET, SO_RCVBUF, [32768], 4) = 0\ngetpid()                                = 21338\nbind(3, {sa_family=AF_NETLINK, nl_pid=-1300212902, nl_groups=00000000}, 12) = 0\ngetsockname(3, {sa_family=AF_NETLINK, nl_pid=-1300212902, nl_groups=00000000}, [12]) = 0\nsendmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=12, msg_iov=[{iov_base={{len=20, type=0x10 /* NLMSG_??? */, flags=NLM_F_REQUEST|NLM_F_ACK|0x300, seq=1530817156, pid=2994754394}, \"\\3\\1\\0\\0\"}, iov_len=20}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 20\nrecvmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=12, msg_iov=[{iov_base=[{{len=116, type=0x10 /* NLMSG_??? */, flags=NLM_F_MULTI, seq=1530817156, pid=2994754394}, \"\\1\\2\\0\\0\\v\\0\\2\\0nlctrl\\0\\0\\6\\0\\1\\0\\20\\0\\0\\0\\10\\0\\3\\0\\2\\0\\0\\0\"...}, {{len=96, type=0x10 /* NLMSG_??? */, flags=NLM_F_MULTI, seq=1530817156, pid=2994754394}, \"\\1\\2\\0\\0\\16\\0\\2\\0VFS_DQUOT\\0\\0\\0\\6\\0\\1\\0\\21\\0\\0\\0\\10\\0\\3\\0\"...}, {{len=104, type=0x10 /* NLMSG_??? */, flags=NLM_F_MULTI, seq=1530817156, pid=2994754394}, \"\\1\\2\\0\\0\\17\\0\\2\\0acpi_event\\0\\0\\6\\0\\1\\0\\23\\0\\0\\0\\10\\0\\3\\0\"...}, {{len=108, type=0x10 /* NLMSG_??? */, flags=NLM_F_MULTI, seq=1530817156, pid=2994754394}, \"\\1\\2\\0\\0\\22\\0\\2\\0thermal_event\\0\\0\\0\\6\\0\\1\\0\\24\\0\\0\\0\"...}, {{len=112, type=0x10 /* NLMSG_??? */, flags=NLM_F_MULTI, seq=1530817156, pid=2994754394}, \"\\1\\2\\0\\0\\20\\0\\2\\0tcp_metrics\\0\\6\\0\\1\\0\\25\\0\\0\\0\\10\\0\\3\\0\"...}, {{len=112, type=0x10 /* NLMSG_??? */, flags=NLM_F_MULTI, seq=1530817156, pid=2994754394}, \"\\1\\2\\0\\0\\16\\0\\2\\0TASKSTATS\\0\\0\\0\\6\\0\\1\\0\\26\\0\\0\\0\\10\\0\\3\\0\"...}, {{len=2076, type=0x10 /* NLMSG_??? */, flags=NLM_F_MULTI, seq=1530817156, pid=2994754394}, \"\\1\\2\\0\\0\\f\\0\\2\\0nl80211\\0\\6\\0\\1\\0\\30\\0\\0\\0\\10\\0\\3\\0\\1\\0\\0\\0\"...}, {{len=224, type=0x10 /* NLMSG_??? */, flags=NLM_F_MULTI, seq=1530817156, pid=2994754394}, \"\\1\\2\\0\\0\\23\\0\\2\\0MAC80211_HWSIM\\0\\0\\6\\0\\1\\0\\31\\0\\0\\0\"...}, {{len=0, type=0 /* NLMSG_??? */, flags=0, seq=0, pid=0}}], iov_len=16384}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 2948\nrecvmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=12, msg_iov=[{iov_base=[{{len=20, type=NLMSG_DONE, flags=NLM_F_MULTI, seq=1530817156, pid=2994754394}, \"\\0\\0\\0\\0\"}, {{len=0, type=0 /* NLMSG_??? */, flags=0, seq=0, pid=65542}}], iov_len=16384}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 20\nmmap(NULL, 8392704, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, -1, 0) = 0x7fdb752ce000\nmprotect(0x7fdb752ce000, 4096, PROT_NONE) = 0\nclone(child_stack=0x7fdb75acdff0, flags=CLONE_VM|CLONE_FS|CLONE_FILES|CLONE_SIGHAND|CLONE_THREAD|CLONE_SYSVSEM|CLONE_SETTLS|CLONE_PARENT_SETTID|CLONE_CHILD_CLEARTID, parent_tidptr=0x7fdb75ace9d0, tls=0x7fdb75ace700, child_tidptr=0x7fdb75ace9d0) = 21339\nsendmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=12, msg_iov=[{iov_base={{len=28, type=0x19 /* NLMSG_??? */, flags=NLM_F_REQUEST|NLM_F_ACK, seq=1530817157, pid=2994754394}, \"\\6\\1\\0\\0\\10\\0\\n\\0_\\0\\0\\0\"}, iov_len=28}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 28\nnanosleep({tv_sec=2, tv_nsec=0}, 0x7ffff64ac200) = 0\nwrite(1, \"Deleting radio with id '95'...\\n\", 31) = 31\nsendmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=12, msg_iov=[{iov_base={{len=28, type=0x19 /* NLMSG_??? */, flags=NLM_F_REQUEST|NLM_F_ACK, seq=1530817158, pid=2994754394}, \"\\5\\1\\0\\0\\10\\0\\n\\0_\\0\\0\\0\"}, iov_len=28}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 28\nnanosleep({tv_sec=2, tv_nsec=0},  &lt;unfinished ...&gt;) = ?\n+++ exited with 0 +++\n</code></pre>\n\n<p>and the response trace:</p>\n\n<pre><code>recvmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=12, msg_iov=[{iov_base=[{{len=48, type=0x19 /* NLMSG_??? */, flags=0, seq=1530817157, pid=2994754394}, \"\\6\\1\\0\\0\\10\\0\\n\\0_\\0\\0\\0\\10\\0\\t\\0\\1\\0\\0\\0\\t\\0\\21\\0phy95\\0\\0\\0\"}, {{len=0, type=0 /* NLMSG_??? */, flags=0, seq=0, pid=0}}], iov_len=16384}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 48\nepoll_wait(4, [{EPOLLIN, {u32=3, u64=3}}], 32, -1) = 1\nrecvmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=12, msg_iov=[{iov_base=[{{len=36, type=NLMSG_ERROR, flags=0, seq=1530817157, pid=2994754394}, \"\\0\\0\\0\\0\\34\\0\\0\\0\\31\\0\\5\\0\\205j&gt;[ZS\\200\\262\"}, {{len=1114121, type=0x6870 /* NLMSG_??? */, flags=NLM_F_REQUEST|NLM_F_ECHO|NLM_F_DUMP_INTR|NLM_F_DUMP_FILTERED|0x3940, seq=53, pid=0}, \"\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\"...}], iov_len=16384}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 36\nfstat(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(136, 0), ...}) = 0\nwrite(1, \"new SSID defined to interface 95\"..., 33) = 33\nepoll_wait(4, [{EPOLLIN, {u32=3, u64=3}}], 32, -1) = 1\nrecvmsg(3, {msg_name={sa_family=AF_NETLINK, nl_pid=0, nl_groups=00000000}, msg_namelen=12, msg_iov=[{iov_base=[{{len=36, type=NLMSG_ERROR, flags=0, seq=1530817158, pid=2994754394}, \"\\0\\0\\0\\0\\34\\0\\0\\0\\31\\0\\5\\0\\206j&gt;[ZS\\200\\262\"}, {{len=1114121, type=0x6870 /* NLMSG_??? */, flags=NLM_F_REQUEST|NLM_F_ECHO|NLM_F_DUMP_INTR|NLM_F_DUMP_FILTERED|0x3940, seq=53, pid=0}, \"\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\"...}], iov_len=16384}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 36\nwrite(1, \"Successfully deleted device with\"..., 39) = 39\nexit_group(0)                                       = ?\n+++ exited with 0 +++\n</code></pre>\n\n<p>The only thing that seems relevant to me (other than the threading structure) is that it uses different flags (<code>NLM_F_DUMP_INTR|NLM_F_DUMP_FILTERED</code> in the C code, <code>0</code> in the Go code).</p>\n\n<p>I'm not sure what other tools I can bring to bear on this, since I don't know how those sequence numbers are constructed. There didn't seem to me to be anything unusually wrong with the code in the kernel module, in the Go packages, or in my Go code, but there could always be a mismatch between the way an interface was supposed to be used and the way it actually was. Does this problem seem familiar to anyone, or does anyone have any thoughts on how to make progress on this?</p>\n"}, {"tags": ["go", "glide-golang"], "answers": [{"tags": [], "owner": {"reputation": 1163, "user_id": 3878945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/346dfffc2ad8e4db132d75c277ef3d1f?s=128&d=identicon&r=PG", "display_name": "Bigman", "link": "https://stackoverflow.com/users/3878945/bigman"}, "is_accepted": false, "score": 0, "last_activity_date": 1531785335, "creation_date": 1531785335, "answer_id": 51371462, "question_id": 51370295, "link": "https://stackoverflow.com/questions/51370295/glide-update-empties-glide-lock/51371462#51371462", "title": "glide update empties glide.lock", "body": "<p>I figured out. Just my own noob question. When I import packages in a local project, I can just import and do not have to <code>glide get</code> from Github.</p>\n\n<p>I do not really need a dependency. This is why glide.lock is empty.</p>\n"}], "owner": {"reputation": 1163, "user_id": 3878945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/346dfffc2ad8e4db132d75c277ef3d1f?s=128&d=identicon&r=PG", "display_name": "Bigman", "link": "https://stackoverflow.com/users/3878945/bigman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531785335, "creation_date": 1531776209, "last_edit_date": 1531783942, "question_id": 51370295, "link": "https://stackoverflow.com/questions/51370295/glide-update-empties-glide-lock", "title": "glide update empties glide.lock", "body": "<p>In my golang project, <code>glide update</code> command clears out my glide.lock file instead of updating my dependencies. Can anyone help?</p>\n\n<p>Let me explain in details.\nMy golang project is set up correctly,\n1. I am on Windows\n2. source code is under GOPATH/src/github.com/myName/repoName/\n3. special: Since I am syncing to my private repo on Github, I have this reroute setting in .gitconfig</p>\n\n<pre><code>[url \"git@github.com:\"]\ninsteadOf = https://github.com/\n</code></pre>\n\n<ol start=\"4\">\n<li>I can do <code>glide get</code> normally</li>\n</ol>\n\n<p>Issues: prior to <code>glide up</code>, my vendor folders have dependencies and my glide.lock looks like this,</p>\n\n<p><a href=\"https://i.stack.imgur.com/XqWbK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XqWbK.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now if I either do <code>glide up</code> or <code>glide update github.com/name/chaintest0/blockchain</code>, the glide.lock would look like being cleared.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Srp4P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Srp4P.png\" alt=\"enter image description here\"></a></p>\n\n<p>Also the vendor folder would be cleared. However, glide.yaml still looks normal.</p>\n\n<p>Now I <code>glide get</code> to keep updating. This would work until dependencies get big.. </p>\n\n<p>So am I using <code>glide up</code> in a wrong way, or is it just a glide bug?</p>\n"}, {"tags": ["json", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9932573, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vpEqDZ1RcdE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2gkMZ5CmhZ_vNZXs6Ng1MxylkcfQ/mo/photo.jpg?sz=128", "display_name": "Grehgous", "link": "https://stackoverflow.com/users/9932573/grehgous"}, "edited": false, "score": 0, "creation_date": 1531774637, "post_id": 51369770, "comment_id": 89712250, "body": "Thank you! That was extremely insightful and helpful. Out of curiosity, do you have some trick for determining the path, or is it just a matter of tediously going through and finding the path for each attribute that I want to get to?  Also, how would I write to that location in foo? When I try to <code>put := blah</code> on the right of that long line it produces the error: expected identifier on left side of :=  EDIT: disregard that last setting it equal think. As soon as I typed that I realized that it is just = and not :="}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 29, "user_id": 9932573, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vpEqDZ1RcdE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2gkMZ5CmhZ_vNZXs6Ng1MxylkcfQ/mo/photo.jpg?sz=128", "display_name": "Grehgous", "link": "https://stackoverflow.com/users/9932573/grehgous"}, "edited": false, "score": 0, "creation_date": 1531774783, "post_id": 51369770, "comment_id": 89712304, "body": "That depends entirely on the data itself. You might have to do some experimenting to find something that works. Honestly it sounds like you&#39;re saddled with a pretty badly structured JSON so tedious may be the only option."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 0, "last_activity_date": 1531773523, "creation_date": 1531773523, "answer_id": 51369770, "question_id": 51369547, "link": "https://stackoverflow.com/questions/51369547/working-with-deeply-nested-json-in-go-lang/51369770#51369770", "title": "Working with deeply nested JSON in Go Lang", "body": "<p>Your initial attempt didn't work because you used structs where you need a slice of struct (<code>Value []struct{...}</code>). But that won't work either, because in some cases the values are slices and in some cases they're strings, which <code>encoding/json</code> does not like. Your best bet is one of two options: raw text manipulation, which will probably be quicker but more fragile and error-prone, or decoding as in your second example into a <code>map[string]interface{}</code> and doing some gnarly type assertions:</p>\n\n<pre><code>var foo map[string]interface{}\nerr := json.Unmarshal(blob, &amp;foo)\nif err != nil {\n    fmt.Println(\"error:\", err)\n}\n\nfoo[\"value\"].([]interface{})[0].(map[string]interface{})[\"value\"].([]interface{})[1].(map[string]interface{})[\"value\"].([]interface{})[0].(map[string]interface{})[\"value\"].([]interface{})[1].(map[string]interface{})[\"value\"].([]interface{})[0].(map[string]interface{})[\"value\"]\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9932573, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vpEqDZ1RcdE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2gkMZ5CmhZ_vNZXs6Ng1MxylkcfQ/mo/photo.jpg?sz=128", "display_name": "Grehgous", "link": "https://stackoverflow.com/users/9932573/grehgous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "accepted_answer_id": 51369770, "answer_count": 1, "score": 0, "last_activity_date": 1531773523, "creation_date": 1531772371, "question_id": 51369547, "link": "https://stackoverflow.com/questions/51369547/working-with-deeply-nested-json-in-go-lang", "title": "Working with deeply nested JSON in Go Lang", "body": "<p>I have what I would consider a very messy block of JSON, and I want to read and \nmodify two values that are deeply nested within (denoted: I want this!) using Go.\nDue to the server that I am sending it to,\nI cannot change the label names. What makes it especially difficult\nfor me is that parents have multiple children which are also nested, and since there are so many \"value\" labels I don't know how to specify which \"value\" child thatI want to enter.</p>\n\n<p>I got the values in Bash very quickly using this </p>\n\n<pre><code>jq ' .value[0].value[1].value[0].value[1].value[0].value=\"'\"$one\"'\" | '\\ '\n.value[0].value[1].value[0].value[1].value[1].value=\"'\"$two\"'\"'\n</code></pre>\n\n<p>I tried a format like this in Go initially, but could not get it working because of the issue where children are all named \"value\" and I want to go into one other than the first. Unfortunately none of those magic JSON to Go struct were able to handle all of the nesting either.</p>\n\n<pre><code>type Bar struct {\n    Value struct { // Value[0]\n        Value struct {  // Value[1]\n            Value struct { // Value[0]\n                Value struct { // Value[1]\n                    Value struct { // Value[1] or Value[2]\n                    }}}}}}\n</code></pre>\n\n<p>This code converts the JSON into a more struct/map friendly form, and prints the whole thing. </p>\n\n<pre><code>var foo interface{}\nerr := json.Unmarshal(blob, &amp;foo)\nif err != nil {\n    fmt.Println(\"error:\", err)\n}\n\nm := foo.(map[string]interface{})\n\n// print all\nfmt.Println(\"Loop: \", m)\nfor k, v := range m {\n    fmt.Printf(\"%v : %v\", k, v)\n}\n</code></pre>\n\n<p>Here is the JSON that I am storing as a variable</p>\n\n<pre><code>var blob = []byte(`{\n\"tag\": \"1\",\n\"value\": [{\n        \"tag\": \"2\",\n        \"value\": [{\n                \"tag\": \"3\",\n                \"value\": [{\n                        \"tag\": \"4\",\n                        \"type\": \"x\",\n                        \"value\": \"x\"\n                    }, {\n                        \"tag\": \"5\",\n                        \"type\": \"x\",\n                        \"value\": \"x\"\n                    }\n                ]\n            }, {\n                \"tag\": \"6\",\n                \"value\": [{\n                        \"tag\": \"7\",\n                        \"value\": [{\n                                \"tag\": \"8\",\n                                \"type\": \"x\",\n                                \"value\": \"x\"\n                            }, {\n                                \"tag\": \"9\",\n                                \"value\": [{\n                                        \"tag\": \"10\",\n                                        \"type\": \"x\",\n                                        \"value\": \"I want this!\"\n                                    }, {\n                                        \"tag\": \"11\",\n                                        \"type\": \"Thanks for the help mate!\",\n                                        \"value\": \"I want this!\"\n                                    }\n                                ]\n                            }\n                        ]\n                    }\n                ]\n            }, {\n                \"tag\": \"12\",\n                \"type\": \"x\",\n                \"value\": \"x\"\n            }\n        ]\n    }, {\n        \"tag\": \"13\",\n        \"value\": [{\n                \"tag\": \"14\",\n                \"type\": \"x\",\n                \"value\": \"x\"\n            }, {\n                \"tag\": \"15\",\n                \"value\": [{\n                        \"tag\": \"16\",\n                        \"value\": [{\n                                \"tag\": \"17\",\n                                \"type\": \"x\",\n                                \"value\": \"x\"\n                            }\n                        ]\n                    }\n                ]\n            }\n        ]\n    }\n]\n}`)\n</code></pre>\n\n<p>I would appreciate any help or advice that you could give me. </p>\n"}, {"tags": ["go", "runtime", "elf", "gopath"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531778104, "post_id": 51368837, "comment_id": 89713369, "body": "Are you just trying to manually implement this? <a href=\"https://stackoverflow.com/questions/45279385/remove-file-paths-from-text-directives-in-go-binaries\" title=\"remove file paths from text directives in go binaries\">stackoverflow.com/questions/45279385/&hellip;</a>"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1531781010, "post_id": 51368837, "comment_id": 89714165, "body": "You probably want <code>runtime.GOROOT</code>"}, {"owner": {"reputation": 416, "user_id": 1636016, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31df8d0cf36ca98f74829948fd734452?s=128&d=identicon&r=PG", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/1636016/dibyendu"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1531799585, "post_id": 51368837, "comment_id": 89717660, "body": "@MichaelHampton, using <code>runtime.GOROOT</code> doesn&#39;t solve my problem. Actually I&#39;ll compile the code on machine <b>A</b>, where golang will be installed in some custom location as <code>&#47;home&#47;userA</code>, but I&#39;ll run the executable on some machine where go will be installed in its standard location like <code>&#47;usr&#47;bin</code>. So, using <code>GOROOT</code>, I won&#39;t be able to replace the prefix successfully."}, {"owner": {"reputation": 416, "user_id": 1636016, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31df8d0cf36ca98f74829948fd734452?s=128&d=identicon&r=PG", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/1636016/dibyendu"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531803243, "post_id": 51368837, "comment_id": 89718509, "body": "@JimB your solution works but only for a single file, not for any imported packages (both from my project and from any 3rd party vendor). I&#39;ve updated the post with the situation."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1531842254, "last_edit_date": 1531842254, "creation_date": 1531839373, "answer_id": 51384549, "question_id": 51368837, "link": "https://stackoverflow.com/questions/51368837/golang-runtime-package-sets-filepaths-from-the-system-on-which-it-was-built/51384549#51384549", "title": "golang runtime package sets filepaths from the system on which it was built", "body": "<p>What are you tring to accomplish? The XY problem is asking about your attempted solution rather than your actual problem: <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">The XY Problem</a>.</p>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/cmd/go/\" rel=\"nofollow noreferrer\">Command go</a></p>\n  \n  <p>The GOPATH environment variable lists places to look for Go code. On\n  Unix, the value is a colon-separated string. On Windows, the value is\n  a semicolon-separated string. On Plan 9, the value is a list.</p>\n</blockquote>\n\n<hr>\n\n<p>GOPATH is an artifact of the Go tools. It is not covered by the Go language compatibility guarantees. </p>\n\n<p>What should happen if the GOPATH list has more than one element?</p>\n\n<hr>\n\n<p>Does this work for you?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n    \"strings\"\n)\n\nfunc srcFile(path string) string {\n    const src = `/src/`\n    i := strings.LastIndex(path, src)\n    if i &gt;= 0 {\n        path = path[i+len(src):]\n    }\n    return path\n}\n\nfunc bar() {\n    pc := make([]uintptr, 1000)\n    n := runtime.Callers(0, pc)\n    frames := runtime.CallersFrames(pc[:n])\n    for {\n        frame, more := frames.Next()\n        if !more {\n            break\n        }\n        fmt.Printf(\"PATH = %s and FUNC = %s\\n\", frame.File, frame.Function)\n        fmt.Printf(\"FILE = %s and FUNC = %s\\n\", srcFile(frame.File), frame.Function)\n    }\n}\n\nfunc foo() {\n    bar()\n}\n\nfunc main() {\n    foo()\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>PATH = /home/peter/go/src/runtime/extern.go and FUNC = runtime.Callers\nFILE = runtime/extern.go and FUNC = runtime.Callers\nPATH = /home/peter/gopath/src/so/gopath.go and FUNC = main.bar\nFILE = so/gopath.go and FUNC = main.bar\nPATH = /home/peter/gopath/src/so/gopath.go and FUNC = main.foo\nFILE = so/gopath.go and FUNC = main.foo\nPATH = /home/peter/gopath/src/so/gopath.go and FUNC = main.main\nFILE = so/gopath.go and FUNC = main.main\nPATH = /home/peter/go/src/runtime/proc.go and FUNC = runtime.main\nFILE = runtime/proc.go and FUNC = runtime.main\n</code></pre>\n"}], "owner": {"reputation": 416, "user_id": 1636016, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31df8d0cf36ca98f74829948fd734452?s=128&d=identicon&r=PG", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/1636016/dibyendu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 316, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1531842254, "creation_date": 1531769102, "last_edit_date": 1531806465, "question_id": 51368837, "link": "https://stackoverflow.com/questions/51368837/golang-runtime-package-sets-filepaths-from-the-system-on-which-it-was-built", "title": "golang runtime package sets filepaths from the system on which it was built", "body": "<p>I've a simple go code, that uses the <strong>runtime</strong> package as follows:</p>\n\n<pre><code>package main\n\nimport (\n    \"runtime\"\n    \"fmt\"\n)\n\nfunc bar() {\n    pc := make([]uintptr, 1000)\n    n := runtime.Callers(0, pc)\n    frames := runtime.CallersFrames(pc[:n])\n    for {\n        frame, more := frames.Next()\n        if ! more {\n            break\n        }\n        fmt.Printf(\"FILE = %s and FUNC = %s\\n\", frame.File, frame.Function)\n    }\n}\n\nfunc foo() {\n    bar()\n}\n\nfunc main() {\n    foo()\n}\n</code></pre>\n\n<p>I've Go binary installed in a custom location (/home/<strong>userA</strong>/bin/go) on a Ubuntu machine (say <strong>machine A</strong>)</p>\n\n<p>I've compiled it on machine <strong>A</strong> and ran the executable on the same machine to get the output:</p>\n\n<pre><code>FILE = /home/userA/bin/go/src/runtime/extern.go and FUNC = runtime.Callers\nFILE = /home/userA/src/main.go and FUNC = main.bar\nFILE = /home/userA/src/main.go and FUNC = main.foo\nFILE = /home/userA/src/main.go and FUNC = main.main\nFILE = /home/userA/bin/go/src/runtime/proc.go and FUNC = runtime.main\n</code></pre>\n\n<p>Now I copied the compiled executable to another Ubuntu machine (say <strong>machine B</strong>) where Go binary was installed in another different custom location (/home/<strong>userB</strong>/bin/go). I ran the executable from <strong>/home/userB</strong>. But this time also, I got the same output as before:</p>\n\n<pre><code>FILE = /home/userA/bin/go/src/runtime/extern.go and FUNC = runtime.Callers\nFILE = /home/userA/src/main.go and FUNC = main.bar\nFILE = /home/userA/src/main.go and FUNC = main.foo\nFILE = /home/userA/src/main.go and FUNC = main.main\nFILE = /home/userA/bin/go/src/runtime/proc.go and FUNC = runtime.main\n</code></pre>\n\n<p>It seems that the <strong>runtime</strong> package sets the stack-frames during compilation time.</p>\n\n<p>I need to do some processing on the file paths based on <strong>GOPATH</strong> environment variable, which I've set as <strong>/home/userA</strong> on machine <strong>A</strong> and as <strong>/home/userB</strong> on machine <strong>B</strong>.</p>\n\n<p>I need to strip the GOPATH part from each of those file paths. I'm doing it with this simple function call: <code>strings.Replace(frame.File, GOPATH, \"\", 1)</code></p>\n\n<p>But, because of this behaviour of the runtime package, the <code>strings.Replace</code> function fails to replace the initial portion of the file paths on machine <strong>B</strong>.</p>\n\n<p>Any idea on how to accomplish this on machine <strong>B</strong> ?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Following the suggestion from @JimB, I've built the project with</p>\n\n<p><code>CGO_ENABLED=0 go build -a -ldflags=\"-w -s\" -gcflags=-trimpath=/home/userA -asmflags=-trimpath=/home/userA</code></p>\n\n<p>Now, running the executable on the same machine gives output as:</p>\n\n<pre><code>FILE = /home/userA/bin/go/src/runtime/extern.go and FUNC = runtime.Callers\nFILE = /home/userA/src/vendor/github.com/kataras/golog/golog.go and FUNC = vendor/github.com/kataras/golog.Error\nFILE = /home/userA/src/test/test_logger.go and FUNC = test/test_logger.TestLogger\nFILE = src/main.go and FUNC = main.bar\nFILE = src/main.go and FUNC = main.foo\nFILE = src/main.go and FUNC = main.main\nFILE = /home/userA/bin/go/src/runtime/proc.go and FUNC = runtime.main\n</code></pre>\n\n<p>The path prefix is trimmed only for the main file. It's still there for any vendor imported package or any locally imported package.</p>\n"}, {"tags": ["unit-testing", "google-app-engine", "go"], "comments": [{"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 1, "creation_date": 1531820926, "post_id": 51368456, "comment_id": 89728010, "body": "Try <a href=\"https://cloud.google.com/appengine/docs/standard/go/modules/reference#DefaultVersion\" rel=\"nofollow noreferrer\">DefaultVersion</a>, this appears to be the equivalent of the python&#39;s <code>modules.get_hostname()</code> that I&#39;m using for such goal, as described in <a href=\"https://stackoverflow.com/questions/31141247/resolve-discovery-path-on-app-engine-module/31145647#31145647\" title=\"resolve discovery path on app engine module\">stackoverflow.com/questions/31141247/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 275, "user_id": 7964813, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7ddc7c1757041ed0db2e0c5dd7501d9f?s=128&d=identicon&r=PG&f=1", "display_name": "smandrus", "link": "https://stackoverflow.com/users/7964813/smandrus"}, "is_accepted": false, "score": 1, "last_activity_date": 1531845747, "creation_date": 1531845747, "answer_id": 51386492, "question_id": 51368456, "link": "https://stackoverflow.com/questions/51368456/how-to-get-host-name-when-testing-using-gae/51386492#51386492", "title": "How to get host name when testing using GAE?", "body": "<p>I was able to achieve my goal by first getting the list of modules. (It is <em>likely</em> the service name you are looking for will be <code>default</code>, however I chose to use the first name in the list anyways). Using the module name, I got the default version for the module. Using both of these (and an empty instance name), I was able to get the module host name which provided the value I was looking for. </p>\n\n<p>A code sample is shown below:</p>\n\n<pre><code>    ml, - := module.List(ctx)\n    mv, _ := module.DefaultVersion(ctx, ml[0])\n    hn, _ := appengine.ModuleHostname(ctx, ml[0], mv, \"\")\n</code></pre>\n\n<p>Thanks to <a href=\"https://stackoverflow.com/users/4495081/dan-cornilescu\">Dan</a> for pointing me in the right direction.</p>\n"}], "owner": {"reputation": 275, "user_id": 7964813, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7ddc7c1757041ed0db2e0c5dd7501d9f?s=128&d=identicon&r=PG&f=1", "display_name": "smandrus", "link": "https://stackoverflow.com/users/7964813/smandrus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531845747, "creation_date": 1531767339, "last_edit_date": 1531819284, "question_id": 51368456, "link": "https://stackoverflow.com/questions/51368456/how-to-get-host-name-when-testing-using-gae", "title": "How to get host name when testing using GAE?", "body": "<p>When using the local development server, the port for my default service always defaults to 8080. However, when I use <code>aetest</code>, the port number always changes. The command used to start the local server when unit testing specifies <code>--port=0</code>. However, since this is in the app engine package, I do not want to modify it. I also can't specify the port number manually since tests are run using <code>go test</code> and not <code>dev_appserver.py</code>.</p>\n\n<p><strong>What I need</strong></p>\n\n<p>The code I am testing requires a particular response from a different microservice to continue execution successfully. To keep testing to this microservice, I am trying to set up a fake endpoint to provide me with the response I need. </p>\n\n<p><em>Sample of code being tested</em></p>\n\n<pre><code>func Sample(c *gin.Context) {\n    ...\n    url := os.Getenv(\"some_service\") + \"/some-endpoint\"\n    req, err := http.NewRequest(\"POST\", url, r.Body)\n    if err != nil {\n        // error handling\n    }\n    ...\n}\n</code></pre>\n\n<p>I need the host of the current service being tested to be able to set dummy environment variables for another microservice it interacts with. The host url should be the url of the service currently undergoing tests. This way I can use factory responses since I am not testing the other services in this set of tests.</p>\n\n<p><strong>What I've Tried</strong></p>\n\n<ul>\n<li>Using <code>appengine.DefaultVersionHostname()</code>, however this returns an empty string</li>\n<li>Using the http request I create to get the url from that, however it does not include the host as needed (just the path)</li>\n</ul>\n\n<p><strong>Question</strong></p>\n\n<p>Is there any way to obtain the host for the local development server when running unit tests in GAE? Or, is there a way to specify the port number for app engine tests?</p>\n"}, {"tags": ["elasticsearch", "go"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 7208518, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157792812395472/picture?type=large", "display_name": "ricarzd", "link": "https://stackoverflow.com/users/7208518/ricarzd"}, "is_accepted": false, "score": 3, "last_activity_date": 1531812336, "creation_date": 1531812336, "answer_id": 51375518, "question_id": 51367782, "link": "https://stackoverflow.com/questions/51367782/massive-updates-in-elasticsearch-with-go/51375518#51375518", "title": "Massive updates in elasticsearch with go", "body": "<p>I resolved the problem:</p>\n\n<pre><code>out_name, err := client.UpdateByQuery().Index(\"test\").Type(\"test\").Query(query).Script(elastic.NewScriptInline(\"ctx._source.user_name = '\" + requestName + \"';ctx._source.user_nick = '\" + requestNick + \"';ctx._source.user_photo = '\" + fullImageURL + \"';ctx._source.user_thumb = '\" + thumbnailURL + \"'\")).Do(ctx)\n    if nil != err {\n        log.Println(err)\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 6398854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c09022bc2fb20ddf41a6677d25477d52?s=128&d=identicon&r=PG&f=1", "display_name": "tommy", "link": "https://stackoverflow.com/users/6398854/tommy"}, "is_accepted": false, "score": 0, "last_activity_date": 1551758714, "creation_date": 1551758714, "answer_id": 54995221, "question_id": 51367782, "link": "https://stackoverflow.com/questions/51367782/massive-updates-in-elasticsearch-with-go/54995221#54995221", "title": "Massive updates in elasticsearch with go", "body": "<p><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-update-by-query.html\" rel=\"nofollow noreferrer\">https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-update-by-query.html</a></p>\n\n<p>If you want to simply count version conflicts, and not cause the _update_by_query to abort, you can set conflicts=proceed on the url or \"conflicts\": \"proceed\" in the request body. The first example does this because it is just trying to pick up an online mapping change, and a version conflict simply means that the conflicting document was updated between the start of the _update_by_query and the time when it attempted to update the document. This is fine because that update will have picked up the online mapping update.</p>\n\n<p>you only need to set conflicts=proceed on the url or \"conflicts\": \"proceed\" in the request body.</p>\n"}], "owner": {"reputation": 41, "user_id": 7208518, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157792812395472/picture?type=large", "display_name": "ricarzd", "link": "https://stackoverflow.com/users/7208518/ricarzd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1141, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1551758714, "creation_date": 1531764536, "last_edit_date": 1531807943, "question_id": 51367782, "link": "https://stackoverflow.com/questions/51367782/massive-updates-in-elasticsearch-with-go", "title": "Massive updates in elasticsearch with go", "body": "<p>I try to update my database of elasticsearch with golang.I have two functions :</p>\n\n<pre><code>func UpdateAllByUserID(client *elastic.Client, id string, requestName string, requestNick string) error {\n    ctx := context.Background()\n\n    query := elastic.NewMatchQuery(\"user_id\", id)\n\n    out_name, err := client.UpdateByQuery().Index(\"test\").Type(\"test\").Query(query).Script(elastic.NewScriptInline(\"ctx._source.user_name = '\" + requestName + \"'\")).Do(ctx)\n    if nil != err {\n        log.Println(err)\n    }\n\n    fmt.Println(\"update all name: \", out_name.Updated)\n\n    return nil\n\n}\n\n\nfunc UpdateAllNicksByUserIdInFeed(client *elastic.Client, id string, requestNick string) error {\n    ctx := context.Background()\n\n    query := elastic.NewMatchQuery(\"user_id\", id)\n\n\n    out_nick, err := client.UpdateByQuery().Index(\"test\").Type(\"test\").Query(query).Script(elastic.NewScriptInline(\"ctx._source.user_nick = '\" + requestNick + \"'\")).Do(ctx)\n    if nil != err {\n        log.Println(err)\n    }\n\n    fmt.Println(\"update all nick: \", out_nick.Updated)\n\n    return nil\n\n}\n</code></pre>\n\n<p>The POST in elastic:</p>\n\n<pre><code>POST {index}/{type}/_update_by_query\n{\n  \"script\": {\n    \"inline\": \"ctx._source.user_name = 'test'\",\n    \"inline\": \"ctx._source.user_nick = 'test test'\"\n  },\n  \"query\": {\n    \"match\": {\n      \"user_id\": \"mtJZngDOy6Qj22Qv9MEf1MhSLVb2\"\n    }\n  }\n}\n</code></pre>\n\n<p>I'm using the library github.com/olivere/elastic. The versi\u00f3n of elasticsearch is 5.6\nThis functions per separate it works well, but I have two problems:</p>\n\n<p>How can update in the same function?\nWhy then use the two functions at the same time I have this error:</p>\n\n<p>elastic: Error 409 (Conflict)</p>\n"}, {"tags": ["go", "protocol-buffers", "proto", "twirp"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1531758587, "post_id": 51366306, "comment_id": 89704930, "body": "You forgot <code>export</code> before <code>PATH=</code>."}, {"owner": {"reputation": 11, "user_id": 10077259, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AgIpeT3aUts/AAAAAAAAAAI/AAAAAAAAAEI/jyTO9TUdpSs/photo.jpg?sz=128", "display_name": "Carlos Rueda", "link": "https://stackoverflow.com/users/10077259/carlos-rueda"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1531765519, "post_id": 51366306, "comment_id": 89708385, "body": "I tried this and it is still not working."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1531765740, "post_id": 51366306, "comment_id": 89708501, "body": "Type <code>which protoc-gen-twirp</code> in your console.  If it outputs nothing, the binary isn&#39;t detected in your PATH."}, {"owner": {"reputation": 11, "user_id": 10077259, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AgIpeT3aUts/AAAAAAAAAAI/AAAAAAAAAEI/jyTO9TUdpSs/photo.jpg?sz=128", "display_name": "Carlos Rueda", "link": "https://stackoverflow.com/users/10077259/carlos-rueda"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1531765960, "post_id": 51366306, "comment_id": 89708596, "body": "Indeed it outputs nothing, how could I fix this?"}, {"owner": {"reputation": 11, "user_id": 10077259, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AgIpeT3aUts/AAAAAAAAAAI/AAAAAAAAAEI/jyTO9TUdpSs/photo.jpg?sz=128", "display_name": "Carlos Rueda", "link": "https://stackoverflow.com/users/10077259/carlos-rueda"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1531850382, "post_id": 51366306, "comment_id": 89747202, "body": "I fixed this by adding     /bin at the end of the second line in my .bashrc.      <code>PATH=$PATH:&#47;usr&#47;local&#47;bin&#47;go&#47;bin:$GOPATH&#47;bin</code>"}, {"owner": {"reputation": 170, "user_id": 8819631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8kvBO.jpg?s=128&g=1", "display_name": "Avinash Dhinwa", "link": "https://stackoverflow.com/users/8819631/avinash-dhinwa"}, "edited": false, "score": 0, "creation_date": 1559452618, "post_id": 51366306, "comment_id": 99421554, "body": "@CarlosRueda, please post your solution in the answers."}, {"owner": {"reputation": 711, "user_id": 3125693, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3872b84555f5d5abe102f041780200f?s=128&d=identicon&r=PG&f=1", "display_name": "user3125693", "link": "https://stackoverflow.com/users/3125693/user3125693"}, "edited": false, "score": 0, "creation_date": 1588724365, "post_id": 51366306, "comment_id": 109007966, "body": "How did you get the protoc-gen-twirp binary again?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10077259, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AgIpeT3aUts/AAAAAAAAAAI/AAAAAAAAAEI/jyTO9TUdpSs/photo.jpg?sz=128", "display_name": "Carlos Rueda", "link": "https://stackoverflow.com/users/10077259/carlos-rueda"}, "is_accepted": false, "score": 0, "last_activity_date": 1580335977, "creation_date": 1580335977, "answer_id": 59976374, "question_id": 51366306, "link": "https://stackoverflow.com/questions/51366306/twirp-not-working-with-proto/59976374#59976374", "title": "Twirp not working with proto", "body": "<p>I fixed this by adding /bin at the end of the second line in my .bashrc. <code>PATH=$PATH:/usr/local/bin/go/bin:$GOPATH/bin</code></p>\n"}], "owner": {"reputation": 11, "user_id": 10077259, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AgIpeT3aUts/AAAAAAAAAAI/AAAAAAAAAEI/jyTO9TUdpSs/photo.jpg?sz=128", "display_name": "Carlos Rueda", "link": "https://stackoverflow.com/users/10077259/carlos-rueda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580335977, "creation_date": 1531758450, "question_id": 51366306, "link": "https://stackoverflow.com/questions/51366306/twirp-not-working-with-proto", "title": "Twirp not working with proto", "body": "<p>I seem to be unable to install twirp correctly to work with protobuf.</p>\n\n<pre><code>protoc --proto_path=$GOPATH/bin:. --twirp_out=. --go_out=. ./rpc/person/service.proto\n</code></pre>\n\n<p>is the command I'm trying to do when compiling and creating my twirp file, however I get the following error:</p>\n\n<pre><code>protoc-gen-twirp:program not found or is not executable\n--twirp_out: protoc-gen-twirp: Plugin failed with status code 1.\n</code></pre>\n\n<p>My .bashrc already has these two lines for Golang:</p>\n\n<pre><code>export GOPATH=/home/carlosrueda/Documents/go\nPATH=$PATH:/usr/local/bin/go/bin:$GOPATH\n</code></pre>\n\n<p>Any help to solve this will be greatly appreciated, thank you.</p>\n"}, {"tags": ["go", "kubernetes", "openshift"], "answers": [{"tags": [], "owner": {"reputation": 1589, "user_id": 2983542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4840fe7bdf44e6d7dea4ceb828ac70b5?s=128&d=identicon&r=PG&f=1", "display_name": "PhilipGough", "link": "https://stackoverflow.com/users/2983542/philipgough"}, "is_accepted": false, "score": 1, "last_activity_date": 1531825595, "creation_date": 1531825595, "answer_id": 51379863, "question_id": 51365926, "link": "https://stackoverflow.com/questions/51365926/openshift-api-cannot-use-config/51379863#51379863", "title": "OpenShift API - cannot use config", "body": "<p>The problem is that the package exists in the vendored folder in <code>vendor/</code> and also on your <code>$GOPATH</code>. Vendoring <code>\"github.com/openshift/client-go\"</code> should solve your problem.</p>\n\n<p>To answer your second question, for the use case you have described, not really. If you want to create an OpenShift build then yes you need to use the client as this API object does not exist in Kubernetes. If you want to simply create a Pod then you don't need the build client. A simple example for the <a href=\"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.11/#pod-v1-core\" rel=\"nofollow noreferrer\">API reference</a> might look as follows:</p>\n\n<pre><code>package main\n\nimport (\n    \"k8s.io/api/core/v1\"\n    \"k8s.io/client-go/tools/clientcmd\"\n\n    metav1 \"k8s.io/apimachinery/pkg/apis/meta/v1\"\n    corev1client \"k8s.io/client-go/kubernetes/typed/core/v1\"\n)\n\nfunc main() {\n    kubeconfig := clientcmd.NewNonInteractiveDeferredLoadingClientConfig(\n        clientcmd.NewDefaultClientConfigLoadingRules(),\n        &amp;clientcmd.ConfigOverrides{},\n    )\n    namespace, _, err := kubeconfig.Namespace()\n    if err != nil {\n        panic(err)\n    }\n    restconfig, err := kubeconfig.ClientConfig()\n    if err != nil {\n        panic(err)\n    }\n    coreclient, err := corev1client.NewForConfig(restconfig)\n    if err != nil {\n        panic(err)\n    }\n\n    _, err = coreclient.Pods(namespace).Create(&amp;v1.Pod{\n        ObjectMeta: metav1.ObjectMeta{\n            Name: \"example\",\n        },\n        Spec: v1.PodSpec{\n            Containers: []v1.Container{\n                {\n                    Name:    \"ubuntu\",\n                    Image:   \"ubuntu:trusty\",\n                    Command: []string{\"echo\"},\n                    Args:    []string{\"Hello World\"},\n                },\n            },\n        },\n    })\n    if err != nil {\n        panic(err)\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 337, "user_id": 1338631, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8987b8a8b1cc862d332b9ed4ed1030e6?s=128&d=identicon&r=PG", "display_name": "simonszu", "link": "https://stackoverflow.com/users/1338631/simonszu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531825595, "creation_date": 1531756940, "question_id": 51365926, "link": "https://stackoverflow.com/questions/51365926/openshift-api-cannot-use-config", "title": "OpenShift API - cannot use config", "body": "<p>I am trying to connect to an OpenShift/K8s cluster from inside a running pod via the Go API. Therfore, i am following the tutorial from <a href=\"https://docs.openshift.org/latest/go_client/connecting_to_the_cluster.html#connecting-from-within-a-pod-running-in-the-cluster\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>Currently i have a problem with creating the OpenShift build client, whose constructor gets a previously created <code>rest.InClusterConfig()</code> as an argument. This <em>should</em> work, since it is shown in the example, but i get this error:</p>\n\n<pre><code>cannot use restconfig (type *\"k8s.io/client-go/rest\".Config) as type *\"github.com/openshift/client-go/vendor/k8s.io/client-go/rest\".Config in argument to \"github.com/openshift/client-go/build/clientset/versioned/typed/build/v1\".NewForConfig\n</code></pre>\n\n<p>I am a little confused, since <code>rest.InClusterConfig()</code> returns a <code>*Config</code>. This is accepted in <code>corev1client.NewForConfig()</code> which expects a <code>*rest.Config</code>. But <code>buildv1client.NewForConfig()</code> also expects a <code>*rest.Config</code> - but not exactly the restconfig i am creating with <code>rest.InClusterConfig()</code>. </p>\n\n<p>Where is my mistake? Bonus points for: I am taking my first steps with the API, and all it should do is to generate a second pod, from an image where some parameters are applied. Do i need the <code>buildv1client</code> client? This is pretty much Kubernetes core functionality. </p>\n"}, {"tags": ["go", "reflection"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 5, "last_activity_date": 1531756473, "last_edit_date": 1531756473, "creation_date": 1531756088, "answer_id": 51365676, "question_id": 51365591, "link": "https://stackoverflow.com/questions/51365591/execute-methods-which-dont-accept-arguments/51365676#51365676", "title": "Execute methods which don&#39;t accept arguments", "body": "<ol>\n<li>Change <a href=\"https://godoc.org/reflect#TypeOf\" rel=\"nofollow noreferrer\"><code>reflect.TypeOf</code></a> to <a href=\"https://godoc.org/reflect#ValueOf\" rel=\"nofollow noreferrer\"><code>reflect.ValueOf</code></a></li>\n<li>Check the <a href=\"https://godoc.org/reflect#Type\" rel=\"nofollow noreferrer\">type</a> of the <a href=\"https://godoc.org/reflect#Value.Method\" rel=\"nofollow noreferrer\"><code>Method</code></a> to ensure that is accepts zero parameters</li>\n<li>Call the method with <a href=\"https://godoc.org/reflect#Value.Call\" rel=\"nofollow noreferrer\"><code>Call</code></a></li>\n</ol>\n\n\n\n<pre><code>foo := reflect.ValueOf(X{})\nfor i := 0; i &lt; foo.NumMethod(); i++ {\n    method := foo.Method(i)\n    if method.Type().NumIn() == 0 {\n        method.Call(nil)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/KYAfaFlEjVt\" rel=\"nofollow noreferrer\">https://play.golang.org/p/KYAfaFlEjVt</a></p>\n"}], "owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 51365676, "answer_count": 1, "score": 0, "last_activity_date": 1531758589, "creation_date": 1531755795, "question_id": 51365591, "link": "https://stackoverflow.com/questions/51365591/execute-methods-which-dont-accept-arguments", "title": "Execute methods which don&#39;t accept arguments", "body": "<p>Given an arbitrary instance of a struct, I'd like to be able to execute all of its public methods which don't accept arguments.</p>\n\n<p>For example in the code below, I'd like to be able to execute X{}.Foo() and X{}.Bar() without knowing that they exist.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype X struct {\n    Y string\n}\n\nfunc (x X) Foo() string {\n    return x.Y\n}\n\nfunc (x X) Bar() {\n}\n\nfunc (x X) Baz(q string) {\n}\n\nfunc main() {\n    fooType := reflect.TypeOf(X{})\n    for i := 0; i &lt; fooType.NumMethod(); i++ {\n        method := fooType.Method(i)\n        fmt.Println(method.Name)\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4609, "user_id": 4636715, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ebd8c54bb287f99b94373429b588e21?s=128&d=identicon&r=PG&f=1", "display_name": "vahdet", "link": "https://stackoverflow.com/users/4636715/vahdet"}, "edited": false, "score": 0, "creation_date": 1531752322, "post_id": 51364331, "comment_id": 89701243, "body": "Using a dependency manager like <a href=\"https://golang.github.io/dep/\" rel=\"nofollow noreferrer\">dep</a> automatically generates that folder. In that folder there are all of the dependencies the project needs. It helps shipping in a self-contained way."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1531753022, "post_id": 51364331, "comment_id": 89701730, "body": "Some people track vendor, others keep a lock file. Both have pro&#39;s and cons. Personally, I wouldn&#39;t track my vendor dir if I have a dependency on things like kubernetes. It creates bloat in your repo, every update of a dependency is going to be shown as a diff, and it&#39;s fairly trivial to create a build image that just runs the command to get all your deps at build time. The downside of the latter is that your builds would take longer. Then again, you might have the deps on your local machine, so you could just conditionally run the <code>dep ensure</code> or <code>glide install</code> command"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1531771038, "post_id": 51364331, "comment_id": 89710729, "body": "@EliasVanOotegem Glide is not longer recommended for use. The project page states that one should use dep instead. If one is feeling (a little) adventurous, <a href=\"https://github.com/golang/go/wiki/vgo\" rel=\"nofollow noreferrer\">vgo</a> is another option."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1531819372, "post_id": 51364331, "comment_id": 89726883, "body": "@MarkusWMahlberg I know it&#39;s no longer recommended as golang chose <code>dep</code> as the standard, doesn&#39;t mean people might be using it still. I&#39;m personally inclined to stick with glide until vgo is stable"}], "owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1531751948, "creation_date": 1531751948, "question_id": 51364331, "link": "https://stackoverflow.com/questions/51364331/vendor-lib-inside-new-github-project", "title": "vendor lib inside new github project", "body": "<p>I need to publish a new go project into git, I saw that some libraries (like kubernetess )  are commit also the vendor folder with all the 3rd party lib's, what is the reason to do it ? </p>\n"}, {"tags": ["string", "go", "append", "slice"], "comments": [{"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "edited": false, "score": 1, "creation_date": 1531750232, "post_id": 51363767, "comment_id": 89699831, "body": "It is correct but you should use a pair of {} instead of { and )."}], "answers": [{"comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1531751908, "post_id": 51363886, "comment_id": 89700983, "body": "Just curious what benchmarking would say about the <code>concat</code> func if you specify a cap by first iterating over the <code>[]byte</code> arguments and just do something like <code>size := 0</code> and a simple <code>for i := range s { size += len(s[i]) }</code> and use <code>res := make([]byte, 0, size)</code>. It would ensure no over-allocation, and only 1 alloc call is actually made"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1531752564, "post_id": 51363886, "comment_id": 89701401, "body": "OK, really micro-optimisation, but hacked out a little benchmark. <code>Concat2</code> is the one with multiple allocations (ie no cap specified):  <code>BenchmarkConcat-8    \t20000000\t        82.5 ns&#47;op</code>  vs  <code>BenchmarkConcat2-8   \t20000000\t       109 ns&#47;op</code>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1531752958, "post_id": 51363886, "comment_id": 89701676, "body": "@EliasVanOotegem I just wanted to show the option of using a utility function and its basic implementation. If I would need this and would use it a lot, obviously I would optimize it. In that case I would just preallocate the big slice and use <code>copy()</code> instead of <code>append()</code>, so you can get rid of slice header assignments."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1531755202, "last_edit_date": 1531755202, "creation_date": 1531750455, "answer_id": 51363886, "question_id": 51363767, "link": "https://stackoverflow.com/questions/51363767/go-array-initialization-containing-a-string-literal/51363886#51363886", "title": "go array initialization containing a string literal", "body": "<p>What you did in your first attempt in 3 lines is probably more readable that any one-liners:</p>\n\n<p>(You can try all the examples on the <a href=\"https://play.golang.org/p/V5OHiXmisoc\" rel=\"nofollow noreferrer\">Go Playground</a>.)</p>\n\n<pre><code>// Doing one-by-one:\na := []byte{1, 2}\na = append(a, []byte(\"foo\")...)\na = append(a, 3, 4)\nfmt.Println(a)\n\n// Using individual chars:\na = []byte{1, 2, 'f', 'o', 'o', 3, 4}\nfmt.Println(a)\n\n// Using a single string literal:\na = []byte(\"\\x01\\x02foo\\x03\\x04\")\nfmt.Println(a)\n\n// Using several \"nested\" appends:\na = append(append([]byte{1, 2}, []byte(\"foo\")...), 3, 4)\nfmt.Println(a)\n</code></pre>\n\n<p>Except if you create a helper function:</p>\n\n<pre><code>func concat(s ...[]byte) []byte {\n    var res []byte\n    for _, v := range s {\n        res = append(res, v...)\n    }\n    return res\n}\n</code></pre>\n\n<p>And then using it:</p>\n\n<pre><code>// With a utility function:\na = concat([]byte{1, 2}, []byte(\"foo\"), []byte{3, 4})\nfmt.Println(a)\n\n// With a utility function, formatted differently:\na = concat(\n    []byte{1, 2},\n    []byte(\"foo\"),\n    []byte{3, 4},\n)\nfmt.Println(a)\n</code></pre>\n\n<p>You could also do it using a single keyed composite literal and a single <code>copy()</code> call to \"insert\" the string:</p>\n\n<pre><code>// With keyed literal and copy:\na = []byte{1, 2, 5: 3, 4}\ncopy(a[2:], \"foo\")\nfmt.Println(a)\n</code></pre>\n\n<p>Still I don't think it's more readable or worth it.</p>\n\n<hr>\n\n<h2>Concat optimization</h2>\n\n<p>As per comments left below, @EliasVanOotegem benchmarked the solution above (using append on an empty slice) and compared it to summing the total capacity of the byte slice required and allocating that memory in one go. The latter turns out to be slightly more efficiend (~20%), so I'll include that version below:</p>\n\n<pre><code>func concat(s ...[]byte) []byte {\n    c := 0\n    for _, v := range s {\n        c += len(v)\n    }\n    res := make([]byte, 0, c) // allocate everything\n    for _, v := range s {\n        res = append(res, v...)\n    }\n    return res\n}\n</code></pre>\n\n<p>I personally would use the following optimized version which does not require slice header assignments as it uses the builtin <code>copy()</code>:</p>\n\n<pre><code>func concat(s ...[]byte) []byte {\n    size := 0\n    for _, v := range s {\n        size += len(v)\n    }\n    res, i := make([]byte, size), 0\n    for _, v := range s {\n        i += copy(res[i:], v)\n    }\n    return res\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "is_accepted": false, "score": 2, "last_activity_date": 1531750499, "creation_date": 1531750499, "answer_id": 51363900, "question_id": 51363767, "link": "https://stackoverflow.com/questions/51363767/go-array-initialization-containing-a-string-literal/51363900#51363900", "title": "go array initialization containing a string literal", "body": "<p>I think I misunderstood what you are trying initially. You could write it as a string with hex embedded:</p>\n\n<pre><code>c := []byte(\"\\x01\\x02foo\\x03\\x04\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28098, "user_id": 86072, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/dd41ab60469c4ee32c957c97fc101b9d?s=128&d=identicon&r=PG", "display_name": "LeGEC", "link": "https://stackoverflow.com/users/86072/legec"}, "is_accepted": false, "score": 0, "last_activity_date": 1531750729, "creation_date": 1531750729, "answer_id": 51363955, "question_id": 51363767, "link": "https://stackoverflow.com/questions/51363767/go-array-initialization-containing-a-string-literal/51363955#51363955", "title": "go array initialization containing a string literal", "body": "<p>FWIW : it is possible to remove the cast to <code>[]byte(...)</code> in the append call :</p>\n\n<pre><code>a := []byte{65, 66}\na = append(a, \"foo\"...)\na = append(a, 67, 68)\n\nfmt.Printf(\"%s\", a)\n\n// outputs : ABfooCD\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/us75l0Adzbp\" rel=\"nofollow noreferrer\">see it on play.golang.org</a></p>\n"}], "owner": {"reputation": 11, "user_id": 1345263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62819bf356335e0f4dfcb34d835610e?s=128&d=identicon&r=PG", "display_name": "WarrenBurstein", "link": "https://stackoverflow.com/users/1345263/warrenburstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1531755202, "creation_date": 1531750036, "last_edit_date": 1531750632, "question_id": 51363767, "link": "https://stackoverflow.com/questions/51363767/go-array-initialization-containing-a-string-literal", "title": "go array initialization containing a string literal", "body": "<p>I'm trying to initialize a byte array as a mix of numbers and a string.  I've managed to do it using a pair of appends, or by splitting the string into individual chars, but for the sake of readability is there a way to do it as a single initializer containing a string?</p>\n\n<pre><code>// method 1, with two appends\na := []byte{1, 2}\na = append(a, []byte(\"foo\")...);\na = append(a, 3, 4);\n\n// method 2, splitting the string into chars\nb := []byte{1, 2, 'f', 'o', 'o', 3, 4)\n</code></pre>\n"}, {"tags": ["go", "govendor"], "comments": [{"owner": {"reputation": 135, "user_id": 191399, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5573e6097c5e5af8b17ed8a9955f06b?s=128&d=identicon&r=PG", "display_name": "Jim", "link": "https://stackoverflow.com/users/191399/jim"}, "edited": false, "score": 0, "creation_date": 1531749249, "post_id": 51363361, "comment_id": 89699117, "body": "So, I think it&#39;s a bug with govendor license where if the first package is tagged with &#39;u&#39; it doesn&#39;t work.  When I added the +local flag, or +external flag, it worked.  On the other hand, it only printed a license for 3 of 20 or 30 packages but at least it found one."}], "owner": {"reputation": 135, "user_id": 191399, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5573e6097c5e5af8b17ed8a9955f06b?s=128&d=identicon&r=PG", "display_name": "Jim", "link": "https://stackoverflow.com/users/191399/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1531748723, "creation_date": 1531748723, "question_id": 51363361, "link": "https://stackoverflow.com/questions/51363361/govendor-license-command-apparently-skipping-the-vendor-folder-and-only-using-go", "title": "Govendor license command apparently skipping the vendor folder and only using Gopath", "body": "<p>I've had some success with 'govendor license' in the past, but now, it seems to only be searching in GOPATH, rather than looking in the vendor folder first.</p>\n\n<pre><code>dibbj@USENDIBBJL4C MINGW64 ~/go/src/mlx-agent (master)\n$ govendor license\nError: Failed to discover license for \"github.com/StackExchange/wmi\" open `C:\\Users\\dibbj\\go\\src\\github.com\\StackExchange\\wmi: The system cannot find the path specified.`\n\ndibbj@USENDIBBJL4C MINGW64 ~/go/src/mlx-agent (master)\n$ ls vendor/github.com/StackExchange/wmi\nLICENSE  README.md  swbemservices.go  wmi.go\n\nGOPATH=C:\\Users\\dibbj\\go\n</code></pre>\n\n<p>I'm getting the same behavior on both Ubuntu and Win10.  Other govendor commands seem to work and in fact show the correct path</p>\n\n<pre><code> $ govendor list -p\n vu C:\\Users\\dibbj\\go\\src\\mlx-agent\\vendor\\github.com\\StackExchange\\wmi                  \n vu C:\\Users\\dibbj\\go\\src\\mlx-agent\\vendor\\github.com\\shirou\\gopsutil\\internal\\common    \n vu C:\\Users\\dibbj\\go\\src\\mlx-agent\\vendor\\github.com\\shirou\\gopsutil\\process            \n vu C:\\Users\\dibbj\\go\\src\\mlx-agent\\vendor\\golang.org\\x\\sys\\unix \n\n$ govendor -version\nv1.0.9\n\n$ go version\ngo version go1.10.3 windows/amd64\n</code></pre>\n\n<p>Any suggestions?\nThanks</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["node.js", "go", "events", "hyperledger-fabric", "hyperledger"], "answers": [{"tags": [], "owner": {"reputation": 2064, "user_id": 1927543, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ad92404d9739ea60c7c90e1a7d0c6742?s=128&d=identicon&r=PG", "display_name": "Karthikeyan", "link": "https://stackoverflow.com/users/1927543/karthikeyan"}, "is_accepted": false, "score": 0, "last_activity_date": 1566805915, "creation_date": 1566805915, "answer_id": 57653805, "question_id": 51363178, "link": "https://stackoverflow.com/questions/51363178/hyperledger-fabric-registerchaincodeevent-method-not-getting-the-event-from-ch/57653805#57653805", "title": "Hyperledger Fabric registerChaincodeEvent() method not getting the event from chaincode", "body": "<p>The latest high-level API makes it simple, </p>\n\n<pre><code>        const listener = await contract.addContractListener('asset creation-listener', 'saveAsset123456789', (err, event, blockNumber, transactionId, status) =&gt; {\n            if (err) {\n                console.error(err);\n                return;\n            }\n            console.log(`The event payload is :${event.payload}`)\n            console.log(`Block Number: ${blockNumber} Transaction ID: ${transactionId} Status: ${status}`);\n        })\n</code></pre>\n\n<p>check <a href=\"https://fabric-sdk-node.github.io/release-1.4/tutorial-listening-to-events.html\" rel=\"nofollow noreferrer\">this</a> doc for more information</p>\n"}], "owner": {"reputation": 544, "user_id": 7219783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fNszA.jpg?s=128&g=1", "display_name": "Riccardo Persiani", "link": "https://stackoverflow.com/users/7219783/riccardo-persiani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 828, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1566805915, "creation_date": 1531748188, "last_edit_date": 1531748679, "question_id": 51363178, "link": "https://stackoverflow.com/questions/51363178/hyperledger-fabric-registerchaincodeevent-method-not-getting-the-event-from-ch", "title": "Hyperledger Fabric registerChaincodeEvent() method not getting the event from chaincode", "body": "<p>After deploying my chaincode successfully and being able to perform some get from its data (all data returned are correct), I am not able to check if an event is emitted.\nThe function inside <code>Invoke()</code> is <code>queryAllMachines()</code> and if I call just this function it returns a set of machines (the set of machine insert in the method InitLedger())</p>\n\n<p>I follow the documentation and my chaincode (in go) should emit an event in this code line inside its <code>queryAllMachines()</code> function:</p>\n\n<pre><code>func (s *testContract) queryAllMachines(APIstub shim.ChaincodeStubInterface) sc.Response {\n    fmt.Println(\"inside queryAllMachines\\n\")\n    ...\n    err = APIstub.SetEvent(\"evtsender\", []byte(\"adadsads\"))\n    if err != nil {\n        return shim.Error(\"event not set\")\n    }\n    fmt.Printf(\"No errors\\n\")\n}\n</code></pre>\n\n<p>This code always prints \"no errors\", so I suppose the events is emitted rightly.</p>\n\n<p>Then in my .js file for query i have the request:</p>\n\n<pre><code>let request = {\n        chaincodeId: 'oraclize-test-integration',\n        fcn: 'queryAllMachines',\n        args: [''],\n        txId: tx_object\n    };\n</code></pre>\n\n<p>Then this is the part of my .js file where I have the problem and where I want to launch <code>registerChaincodeEvent()</code>:</p>\n\n<pre><code>let event_monitor = new Promise((resolve, reject) =&gt; {\n        let regid = null;\n        let handle = setTimeout(() =&gt; {\n            if (regid) {\n                // might need to do the clean up this listener\n                channel_event_hub.unregisterChaincodeEvent(regid);\n                console.log('Timeout - Failed to receive the chaincode event');\n            }\n            reject(new Error('Timed out waiting for chaincode event'));\n        }, 20000);\n\n        regid = channel_event_hub.registerChaincodeEvent('oraclize-test-integration', 'evtsender',\n            (event, block_num, txnid, status) =&gt; {\n                // This callback will be called when there is a chaincode event name\n                // within a block that will match on the second parameter in the registration\n                // from the chaincode with the ID of the first parameter.\n                console.log('Successfully got a chaincode event with transid:' + txnid + ' with status:' + status);\n\n                // might be good to store the block number to be able to resume if offline\n                storeBlockNumForLater(block_num);\n\n                // to see the event payload, the channel_event_hub must be connected(true)\n                let event_payload = event.payload.toString('utf8');\n                if (event_payload.indexOf('CHAINCODE') &gt; -1) {\n                    clearTimeout(handle);\n                    // Chaincode event listeners are meant to run continuously\n                    // Therefore the default to automatically unregister is false\n                    // So in this case we want to shutdown the event listener once\n                    // we see the event with the correct payload\n                    channel_event_hub.unregisterChaincodeEvent(regid);\n                    console.log('Successfully received the chaincode event on block number ' + block_num);\n                    resolve('RECEIVED');\n                } else {\n                    console.log('Successfully got chaincode event ... just not the one we are looking for on block number ' + block_num);\n                }\n            }, (error) =&gt; {\n                clearTimeout(handle);\n                console.log('Failed to receive the chaincode event ::' + error);\n                reject(error);\n            }\n            // no options specified\n            // startBlock will default to latest\n            // endBlock will default to MAX\n            // unregister will default to false\n            // disconnect will default to false\n        );\n    });\n\n    // build the promise to send the proposals to the orderer\n    let send_trans = channel.sendTransaction({\n        proposalResponses: query_responses[0],\n        proposal: query_responses[1]\n    });\n\n    // now that we have two promises all set to go... execute them\n    return Promise.all([event_monitor, send_trans]);\n</code></pre>\n\n<p>The error that appears is: </p>\n\n<blockquote>\n  <p>Timeout - Failed to receive the chaincode event (node:9180)\n  UnhandledPromiseRejectionWarning: Unhandled promise rejection\n  (rejection id: 3): Error: Timed out waiting for chaincode event\n  (node:9180) [DEP0018] DeprecationWarning: Unhandled promise rejections\n  are deprecated. In the future, promise rejections that are not handled\n  will terminate the Node.js process with anon-zero exit code.</p>\n</blockquote>\n\n<p>So the functions times out in this part of the code, even if I launch another .js file that execute successfully the call to <code>queryAllMachines()</code> function: </p>\n\n<pre><code>let handle = setTimeout(() =&gt; {\n            if (regid) {\n                // might need to do the clean up this listener\n                channel_event_hub.unregisterChaincodeEvent(regid);\n                console.log('Timeout - Failed to receive the chaincode event');\n            }\n            reject(new Error('Timed out waiting for chaincode event'));\n        }, 20000);\n</code></pre>\n"}, {"tags": ["mongodb", "go"], "answers": [{"tags": [], "owner": {"reputation": 104, "user_id": 10070765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G9ZAN.png?s=128&g=1", "display_name": "Zanicar", "link": "https://stackoverflow.com/users/10070765/zanicar"}, "is_accepted": false, "score": 0, "last_activity_date": 1531769648, "creation_date": 1531769648, "answer_id": 51368957, "question_id": 51361988, "link": "https://stackoverflow.com/questions/51361988/how-we-write-the-conditions-in-golang/51368957#51368957", "title": "How we write the conditions in golang?", "body": "<p>If I understand correctly you want a function that will be able to handle different key value pairs as your query input. I implemented it in Go as follows:</p>\n\n<pre><code>type UserResolver int\n\n// String satisfies the Stringer interface\nfunc (ur UserResolver) String() string {\n    strs := [...]string {\n        \"ID\",\n        \"Code\",\n    }\n    // return empty string if index out of bounds\n    if int(ur) &gt;= len(strs) {\n        return \"\"\n    }\n    return strs[ur]\n}\n\n// Add any required functions to UserResolver that you may require,\n// such as schemaKey() that returns the specified schema key value:\n// In your example case \"_id\", \"Code\", \"is_deleted\", etc.\n\nconst (\n    ID UserResolver = iota\n    Code\n)\n\nfunc ResolveUser(by UserResolver, value interface{}) (User, error) {\n    if by.String() == \"\" {\n        return nil, fmt.Errorf(\"Unknown UserResolver specified\")\n    }\n\n    if value == nil {\n        return nil, fmt.Errorf(\"Nil value provided, unable to resolve User\")\n    }\n\n    // Query details here:\n    // It will be specific to your persistence model and remember to follow the\n    // best practices for your specific db, such as properly escaping inputs...\n\n    return User, nil\n}\n</code></pre>\n\n<p>This approach allows you great flexibility by extending the UserResolver functionality with additional functions that may be exported or unexported (according to your API design). It basically maps various options into slices with a common index as defined in the const section using iota (automatic enumeration). You may now add functions that uses switch statements to do type or condition specific work.</p>\n\n<p>The function can now be called by other packages as follows:</p>\n\n<pre><code>u, err := ResolveUser(user.ID, uid)\nif err != nil {\n    return fmt.Errorf(\n        \"User not found! Unable to obtain user by %s = %v\",\n        user.ID,\n        uid,\n    )\n}\n</code></pre>\n\n<p>The conditions portion can be implemented similarly and then properly separates between the lookup index and the lookup conditions.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10031766"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531769648, "creation_date": 1531744545, "last_edit_date": 1531746241, "question_id": 51361988, "link": "https://stackoverflow.com/questions/51361988/how-we-write-the-conditions-in-golang", "title": "How we write the conditions in golang?", "body": "<p>I am writing the queries in the controller section but according to MVC structure the logic are in models and the controller section is used to send data only so in past I'm using like below conditions:- </p>\n\n<pre><code>models.Retrieve(bson.M{\"_id\": Id, \"is_deleted\": false})\n\n//fucntion for this query is \nfucn Retrieve(query interface{}){\n\n    // do stuff\n\n}\n</code></pre>\n\n<p>But now Above query will change using mapping and I'm writing a function to use it for the multiple purpose for retrieving the data like:- </p>\n\n<pre><code>conditions := make(map[string]interface{})\nconditions[\"operator1\"] = \"_id\"\ncodnitions[\"value1\"] = id\nconditions[\"operator2\"] = \"is_deleted\"\nconditions[\"value2\"] = false\n\nfunc Retrieve(data map[string]interface{}){\n\n//queries here\n\n}\n</code></pre>\n\n<p>anyone tell me that this is a right way to this. if yes, then tell me how?</p>\n\n<p>If no, Can you please tell me an example of this or suitable answer for my question.</p>\n\n<p><strong>Edited</strong> :- </p>\n\n<p>This function is also used for the finding by the \"code\" means <code>models.Retrieve(bson.M{\"code\": Code, \"is_deleted\": false})</code></p>\n\n<p>It is also be written like that:-</p>\n\n<pre><code>conditions := make(map[string]interface{})\nconditions[\"operator1\"] = \"code\"\ncodnitions[\"value1\"] = Code\nconditions[\"operator2\"] = \"is_deleted\"\nconditions[\"value2\"] = false\n</code></pre>\n\n<p>Thank you in advance. </p>\n"}, {"tags": ["go", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9439409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf47fd042786ecd19111f5e83817911?s=128&d=identicon&r=PG&f=1", "display_name": "prog_noob", "link": "https://stackoverflow.com/users/9439409/prog-noob"}, "edited": false, "score": 0, "creation_date": 1531741029, "post_id": 51360807, "comment_id": 89693855, "body": "thanks for your reply Elias, please correct me if I am wrong but the buffered channel would also block once the buffer is filled up?   I was trying to come up with a solution that would not block at all because the application that I am writing I dont know what the appropriate buffer should be, to make sure it remains unblocked.  thanks for the tip on time.Seconds  re the last point, I was struggling with deadlocks if I dont close the channel where I am closing now. Could you suggest an alternative whereby the channel is closed in the same routine?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 25, "user_id": 9439409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf47fd042786ecd19111f5e83817911?s=128&d=identicon&r=PG&f=1", "display_name": "prog_noob", "link": "https://stackoverflow.com/users/9439409/prog-noob"}, "edited": false, "score": 0, "creation_date": 1531741210, "post_id": 51360807, "comment_id": 89693969, "body": "@prog_noob: Yes, but considering you know how much data you&#39;re pushing onto the main channel, that shouldn&#39;t be an issue. Blocking channels once the buffer fills up is completely fine, mainly because it&#39;s a mechanism that easily allows you to throttle the throughput. Sometimes having a buffer of just 1 is all it takes (e.g. when writing a package that handles signals but you don&#39;t want it to interfere with the code using that package)."}, {"owner": {"reputation": 25, "user_id": 9439409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf47fd042786ecd19111f5e83817911?s=128&d=identicon&r=PG&f=1", "display_name": "prog_noob", "link": "https://stackoverflow.com/users/9439409/prog-noob"}, "edited": false, "score": 0, "creation_date": 1531741774, "post_id": 51360807, "comment_id": 89694317, "body": "thanks, I&#39;ve had a little play I think I might be able change the code by buffering the second channel. I have also noticed the additional tips in your original comment I will check them out."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 25, "user_id": 9439409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf47fd042786ecd19111f5e83817911?s=128&d=identicon&r=PG&f=1", "display_name": "prog_noob", "link": "https://stackoverflow.com/users/9439409/prog-noob"}, "edited": false, "score": 0, "creation_date": 1531741846, "post_id": 51360807, "comment_id": 89694368, "body": "@prog_noob linked to a playground example where I just pasted your code and changed a couple of things. I&#39;ve added some more details in the <code>fmt</code> output so it&#39;s clear where values are being consumed, but the overal idea should come through"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 25, "user_id": 9439409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf47fd042786ecd19111f5e83817911?s=128&d=identicon&r=PG&f=1", "display_name": "prog_noob", "link": "https://stackoverflow.com/users/9439409/prog-noob"}, "edited": false, "score": 0, "creation_date": 1531742019, "post_id": 51360807, "comment_id": 89694487, "body": "@prog_noob: Updated the playground link. channels are, essentially like shared slices with a <code>cap</code> (being the buffer). You can dynamically determine the size of the buffer of the second channel: we&#39;re forwarding multiples of 3, so <code>cap(jobs)&#47;3</code> might be a good buffer size"}], "tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": true, "score": 3, "last_activity_date": 1531755519, "last_edit_date": 1531755519, "creation_date": 1531740656, "answer_id": 51360807, "question_id": 51360343, "link": "https://stackoverflow.com/questions/51360343/go-routine-getting-blocked/51360807#51360807", "title": "go routine getting blocked", "body": "<p>Your routines are sort-of blocking because the channels aren't buffered. A write/read on an unbuffered channel is a blocking operation. Therefore your routines by definition have to wait on eachother.</p>\n\n<p>Essentially, your sleep of half a second is kind of irrelevant, because the second worker sleeps for 10 seconds. Those 10 seconds will block reads/writes to the second channel. Add a buffer to the channel to get around this.</p>\n\n<p>Some other things I'd like to point out are:</p>\n\n<ul>\n<li><code>time.Sleep(time.Second/2)</code> isn't going to work (well, it is, but dividing by 3 for example isn't). <code>time.Sleep</code> expects a <code>time.Duration</code> argument, which is an <code>int64</code>. You need to pass something like <code>time.Millisecond * 500</code> instead</li>\n<li>It's bad form to pass a channel to a routine, and close it from the routine that didn't create the channel. The channels creation and closing should be contained within a single routine. If not, it works, but maintenance becomes a real nightmare.</li>\n<li>Group your imports, instead of repeating the <code>import \"package\"</code>, just use <code>import ( \"package1\"\\n\"package2\")</code></li>\n<li>Don't use globals if you don't have to. Create the waitgroup in the function that starts all of the routines, and pass a pointer to it to all routines. Including the anonymous function, just to be safe (once you start adding buffers to channels, for example)</li>\n<li>Consider looking into <code>context.Context</code> and the <code>select</code> construct. You can create a <code>context.WithCancel</code> and in select listen for <code>ctx.Done()</code> in all routines. Then you can just cancel all routines in one go without having to handle signals and pushing stuff onto a cancel channel</li>\n</ul>\n\n<h2>Demo</h2>\n\n<p>I've changed a couple of things (mainly channel creation, and some minor code-cleanup), and created a playground example <a href=\"https://play.golang.org/p/nOjA0vvW2qM\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 25, "user_id": 9439409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf47fd042786ecd19111f5e83817911?s=128&d=identicon&r=PG&f=1", "display_name": "prog_noob", "link": "https://stackoverflow.com/users/9439409/prog-noob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 51360807, "answer_count": 1, "score": 2, "last_activity_date": 1531755519, "creation_date": 1531739120, "last_edit_date": 1531740532, "question_id": 51360343, "link": "https://stackoverflow.com/questions/51360343/go-routine-getting-blocked", "title": "go routine getting blocked", "body": "<p>I am leaning go, so this might be a stupid question. </p>\n\n<p>I can't seem to figure out why one of my go routines is being blocked by another.  My understanding (could be wrong) go routines run as independent light weight threads so they should not be blocking each other, unless I have messed up :)</p>\n\n<p>I have pasted the code below and would appreciate any help / tips to figure this out.</p>\n\n<pre><code>package main\nimport \"fmt\"\nimport \"time\"\nimport \"sync\"\n\n\n\nfunc worker( jobs &lt;-chan int, job2 chan&lt;- int) {\n    defer wg.Done()\n    for j := range jobs {\n        fmt.Println(\"finished job\", j)\n        time.Sleep(time.Second/2)\n\n        if(j%3==0){\n           job2 &lt;- j   \n        }  \n\n   } \n   close(job2)\n   fmt.Println(\"channel job2 closed\")\n }\n\nfunc worker2(job2 &lt;-chan int) {\n    defer wg.Done()\n    for i:= range job2 {\n        fmt.Println(i)\n        time.Sleep(time.Second*10)\n    } \n}\n\nvar wg sync.WaitGroup\n\nfunc main() {\n\n    wg.Add(2)\n    jobs := make(chan int)\n\n    job2 := make(chan int)\n\n    go func() {\n        for j := 1; j &lt;= 10; j++ {\n             jobs &lt;- j\n        }\n        close(jobs)\n        fmt.Println(\"channel jobs closed\")\n    }()\n\n    go worker(jobs,job2)\n    go worker2(job2)\n\n    wg.Wait()\n    fmt.Println(\"exiting main\")     \n\n}\n</code></pre>\n\n<p>I get the following output when I run this code</p>\n\n<pre><code>finished job 1\nfinished job 2\nfinished job 3\nfinished job 4\n3\nfinished job 5\nfinished job 6\n6\nfinished job 7\nfinished job 8\nfinished job 9\n9\nfinished job 10\nchannel jobs closed\nchannel job2 closed\nexiting main\n</code></pre>\n\n<p>however I was expecting something like this?</p>\n\n<pre><code>finished job 1\nfinished job 2\nfinished job 3\nfinished job 4\n3\nfinished job 5\nfinished job 6\nfinished job 7\nfinished job 8\nfinished job 9\nfinished job 10\nchannel jobs closed\n6\n9    \nchannel job2 closed\nexiting main\n</code></pre>\n"}, {"tags": ["go", "deferred"], "answers": [{"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 0, "last_activity_date": 1531739190, "creation_date": 1531739190, "answer_id": 51360365, "question_id": 51360229, "link": "https://stackoverflow.com/questions/51360229/the-deferred-calls-arguments-are-evaluated-immediately/51360365#51360365", "title": "The deferred call&#39;s arguments are evaluated immediately", "body": "<blockquote>\n  <p>The deferred call's arguments are evaluated immediately, but the\n  function call is not executed until the surrounding function returns.</p>\n</blockquote>\n\n<p>Above sentence means the deferred function arguments are evaluated at the line where they are deferred but the function will run after the surrounding function which is <code>main</code> returns.</p>\n\n<blockquote>\n  <p>A defer statement pushes a function call onto a list. The list of\n  saved calls is executed after the surrounding function returns. Defer\n  is commonly used to simplify functions that perform various clean-up\n  actions.</p>\n</blockquote>\n\n<p>Deferred function calls are executed in Last In First Out order after the surrounding function returns.</p>\n\n<p>Deferred functions may read and assign to the returning function's named return values.</p>\n\n<p>The  above line clearly states that it will return the value to the main function.</p>\n\n<p>For eg:-</p>\n\n<pre><code>func c() (i int) {\n    defer func() { i++ }()\n    return 1\n}\n</code></pre>\n\n<p>Above function will return <code>2</code> value rather than <code>1</code>. That's why this line</p>\n\n<pre><code>return func(){ fmt.Println(\"clean up\") }\n</code></pre>\n\n<p>will be called in the last.</p>\n\n<p>For more information on defer. <a href=\"https://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow noreferrer\">Please read golang blog for defer</a></p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1531742127, "last_edit_date": 1531742127, "creation_date": 1531739425, "answer_id": 51360421, "question_id": 51360229, "link": "https://stackoverflow.com/questions/51360229/the-deferred-calls-arguments-are-evaluated-immediately/51360421#51360421", "title": "The deferred call&#39;s arguments are evaluated immediately", "body": "<p>In</p>\n\n<pre><code>defer def(\"defered line\")()\n</code></pre>\n\n<p><code>def(\"defered line\")</code> and <code>()</code> are deferred call's arguments evaluated immediately.</p>\n\n<p><code>def(\"defered line\")</code> evaluates to <code>func(){ fmt.Println(\"clean up\") }</code> with side effects. </p>\n"}, {"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 0, "last_activity_date": 1531740644, "creation_date": 1531740644, "answer_id": 51360800, "question_id": 51360229, "link": "https://stackoverflow.com/questions/51360229/the-deferred-calls-arguments-are-evaluated-immediately/51360800#51360800", "title": "The deferred call&#39;s arguments are evaluated immediately", "body": "<p>It will be more clear if you change the argument you're passing to <code>def(string)</code> from a string literal (evaluated at compile time) to something more interesting, say:</p>\n\n<pre><code>func bar(s sting) string {\n    return s + \" bar \"\n}\n\nfunc main() {\n    defer def(bar(os.Args[1]) + \"defered line\")()\n    fmt.Println(\"main\")\n}\n</code></pre>\n\n<p>When the <code>defer def(bar(os.Args[1]) + \"defered line\")()</code> statement\nis executed, the argument to <code>def</code> will be fully evaluated,\nand this means calling <code>bar</code> passing it the first command-line\nargument supplied by the user when running your program,\ntaking whatever <code>bar</code> returned and appending\na string literal to it.</p>\n\n<p>The resulting string is then saved, and will be passed to <code>def</code>\nwhen it will run.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1531743369, "last_edit_date": 1531743369, "creation_date": 1531742924, "answer_id": 51361500, "question_id": 51360229, "link": "https://stackoverflow.com/questions/51360229/the-deferred-calls-arguments-are-evaluated-immediately/51361500#51361500", "title": "The deferred call&#39;s arguments are evaluated immediately", "body": "<p>To learn how defer and evaluations work, first let's look at the <a href=\"https://golang.org/ref/spec#Defer_statements\" rel=\"noreferrer\">Spec: defer statements:</a></p>\n\n<blockquote>\n  <p>Each time a \"defer\" statement executes, <strong>the function value and parameters to the call</strong> are <a href=\"https://golang.org/ref/spec#Calls\" rel=\"noreferrer\">evaluated as usual</a> and saved anew but the actual function is not invoked.</p>\n</blockquote>\n\n<p>Both the function value (whose call is deferred) and its parameters are evaluated. But the deferred function is not yet called.</p>\n\n<p>Let's iterate toward your example with small steps:</p>\n\n<pre><code>defer f(\"a\")\n</code></pre>\n\n<p>In this case the function value is evaluated (which will be <code>f</code>), and the parameters are evaluated, which is a constant, so that's gonna be <code>\"a\"</code>.</p>\n\n<p>Next step:</p>\n\n<pre><code>defer f(g(\"a\"))\n</code></pre>\n\n<p>In this case the function value is evaluated (which will be <code>f</code>), and the parameters are evaluated, which means <code>g</code> will be called with <code>\"a\"</code> (because <code>g</code>'s return value is the param to <code>f</code>).</p>\n\n<p>Next step:</p>\n\n<pre><code>defer f()()\n</code></pre>\n\n<p>This is valid if the <code>f</code> function returns a function. The function value will be evaluated (which means <code>f</code> will be called!) but its return value will not be called, that is what will be deferred.</p>\n\n<pre><code>defer f(g())()\n</code></pre>\n\n<p>In this case the deferred function is the return value of <code>f</code>, so to evaluate the deferred function value, <code>f</code> must be called, and to do that <code>g</code> must be called prior. The return value of <code>f</code> will be deferred (not called).</p>\n\n<p><strong>Back to your example:</strong></p>\n\n<pre><code>defer def(\"defered line\")()\n</code></pre>\n\n<p>The function value is evaluated, which is the return value of <code>def</code>, so <code>def</code> is called. The return value of <code>def</code> will be deferred. Its parameters are evaluated, but actually it has no parameters.</p>\n\n<p>So <strong>logically</strong> this is what happens:</p>\n\n<ol>\n<li>The deferred function value is evaluated, which requires that:\n\n<ul>\n<li><code>def</code> function must be called, which requires that:\n\n<ul>\n<li>Params to <code>def</code> are evaluated, it's a constant: \"<code>defered line\"</code></li>\n</ul></li>\n</ul></li>\n<li>Parameters to the deferred function are evaluated; since there are no params to it, this step is done.</li>\n</ol>\n\n<p>This is what happens <strong>sequentially</strong> if we lay out the above structure:</p>\n\n<ul>\n<li>Param to <code>def</code> is evaluated: it's a constant <code>\"defered line\"</code></li>\n<li><code>def</code> is called which prints <code>tier up</code> and its argument: <code>defered line</code></li>\n<li>The return value of <code>def</code> is <strong>not</strong> called, that is what's deferred.</li>\n<li>Function <code>main</code> prints: <code>main</code></li>\n<li>Function <code>main</code> returns, so deferred functions are called now. The deferred function prints <code>clean up</code></li>\n</ul>\n"}], "owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 0, "accepted_answer_id": 51361500, "answer_count": 4, "score": 4, "last_activity_date": 1531748239, "creation_date": 1531738727, "last_edit_date": 1531748239, "question_id": 51360229, "link": "https://stackoverflow.com/questions/51360229/the-deferred-calls-arguments-are-evaluated-immediately", "title": "The deferred call&#39;s arguments are evaluated immediately", "body": "<p>In <a href=\"https://tour.golang.org/flowcontrol/12\" rel=\"nofollow noreferrer\">A Tour of Go</a> is written:</p>\n\n<blockquote>\n  <p>The deferred call's arguments are evaluated immediately, but the\n  function call is not executed until the surrounding function returns.</p>\n</blockquote>\n\n<p>I have difficulty in understanding the first part of the quote. What is called immediately? </p>\n\n<pre><code>func def(s string) func() {\n    fmt.Println(\"tier up\")\n    fmt.Println(s)\n    return func(){ fmt.Println(\"clean up\") }\n}\n\nfunc main() {\n    defer def(\"defered line\")()\n    fmt.Println(\"main\")\n}\n\n//Output:\n//tier up\n//defered line\n//main\n//clean up\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Av3mAEXxA4R\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Av3mAEXxA4R</a></p>\n\n<p>What is deferred here and what is evaluated immediately?</p>\n"}, {"tags": ["string", "sorting", "go", "numbers"], "answers": [{"tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": false, "score": 0, "last_activity_date": 1531738890, "creation_date": 1531738890, "answer_id": 51360278, "question_id": 51359930, "link": "https://stackoverflow.com/questions/51359930/sorting-strings-with-numbers-in-filenames-with-golang/51360278#51360278", "title": "Sorting strings with numbers in filenames with Golang", "body": "<p>Collect each item into a slice and then <a href=\"https://golang.org/pkg/sort/\" rel=\"nofollow noreferrer\">use the <code>sort</code> package</a> to sort them.  There are examples and explanation in the package docs.</p>\n\n<p>In your case it may be easier to extract the numbers prior to sorting.  For that, <a href=\"https://golang.org/pkg/fmt/#Sscanf\" rel=\"nofollow noreferrer\">you might find <code>fmt.Sscanf</code></a> useful.</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 1529965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bb3bd65ad960a8441088081eea598f?s=128&d=identicon&r=PG", "display_name": "Locust", "link": "https://stackoverflow.com/users/1529965/locust"}, "edited": false, "score": 1, "creation_date": 1531751586, "post_id": 51363401, "comment_id": 89700753, "body": "Brilliant that works like a charm. Quite a lot of code compared to python, but go&#180;s simplicity in other fields still makes it my new weapon of choice. :-)"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1531809868, "last_edit_date": 1531809868, "creation_date": 1531748816, "answer_id": 51363401, "question_id": 51359930, "link": "https://stackoverflow.com/questions/51359930/sorting-strings-with-numbers-in-filenames-with-golang/51363401#51363401", "title": "Sorting strings with numbers in filenames with Golang", "body": "<p>Go has a <a href=\"https://golang.org/pkg/sort/\" rel=\"nofollow noreferrer\"><code>sort</code> package</a>. Construct a sortable name from a name with a non-negative integer suffix.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/binary\"\n    \"fmt\"\n    \"os\"\n    \"path/filepath\"\n    \"sort\"\n    \"strconv\"\n)\n\n// sortName returns a filename sort key with\n// non-negative integer suffixes in numeric order.\n// For example, amt, amt0, amt2, amt10, amt099, amt100, ...\nfunc sortName(filename string) string {\n    ext := filepath.Ext(filename)\n    name := filename[:len(filename)-len(ext)]\n    // split numeric suffix\n    i := len(name) - 1\n    for ; i &gt;= 0; i-- {\n        if '0' &gt; name[i] || name[i] &gt; '9' {\n            break\n        }\n    }\n    i++\n    // string numeric suffix to uint64 bytes\n    // empty string is zero, so integers are plus one\n    b64 := make([]byte, 64/8)\n    s64 := name[i:]\n    if len(s64) &gt; 0 {\n        u64, err := strconv.ParseUint(s64, 10, 64)\n        if err == nil {\n            binary.BigEndian.PutUint64(b64, u64+1)\n        }\n    }\n    // prefix + numeric-suffix + ext\n    return name[:i] + string(b64) + ext\n}\n\nfunc main() {\n    dirname := \"someDir\"\n    d, err := os.Open(dirname)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    defer d.Close()\n    fi, err := d.Readdir(-1)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    fmt.Println(\"\\nUnsorted:\")\n    for _, fi := range fi {\n        if fi.Mode().IsRegular() {\n            fmt.Println(fi.Name())\n        }\n    }\n\n    sort.Slice(\n        fi,\n        func(i, j int) bool {\n            return sortName(fi[i].Name()) &lt; sortName(fi[j].Name())\n        },\n    )\n\n    fmt.Println(\"\\nSorted:\")\n    for _, fi := range fi {\n        if fi.Mode().IsRegular() {\n            fmt.Println(fi.Name())\n        }\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Unsorted:\namt099.txt\namt.txt\namt2.txt\namt100.txt\namt10.txt\namt1.txt\n\nSorted:\namt.txt\namt1.txt\namt2.txt\namt10.txt\namt099.txt\namt100.txt\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 1529965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bb3bd65ad960a8441088081eea598f?s=128&d=identicon&r=PG", "display_name": "Locust", "link": "https://stackoverflow.com/users/1529965/locust"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1459, "favorite_count": 2, "answer_count": 2, "score": 4, "last_activity_date": 1531809868, "creation_date": 1531737625, "last_edit_date": 1531743748, "question_id": 51359930, "link": "https://stackoverflow.com/questions/51359930/sorting-strings-with-numbers-in-filenames-with-golang", "title": "Sorting strings with numbers in filenames with Golang", "body": "<p>I'm trying to convert some old python code into Go lang. But i got stuck at sorting the files in a folder. Since the files are always <code>AMA1.txt</code>, <code>AMA2.txt</code> etc. In python source code i did this:</p>\n\n<pre><code>files=[]\nfor file in os.listdir(someDir):\n\n    if file.endswith(\".txt\"):\n     files.append(file) \n\nconvert = lambda text: int(text) if text.isdigit() else text \nalphanum_key = lambda key: [ convert(c) for c in re.split('([0-9]+)',key) ]\n\nfiles.sort( key=alphanum_key )\n\nfor i in files:\n    print (i)\n</code></pre>\n\n<p>I got so far, but missing the sorting :</p>\n\n<pre><code>func main() {\n    dirname := \"someDir\"\n    d, err := os.Open(dirname)\n\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    defer d.Close()\n\n    fi, err := d.Readdir(-1)\n\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    for _, fi := range fi {\n        if fi.Mode().IsRegular() {\n            fmt.Println(fi.Name())\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["json", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1531734733, "post_id": 51358796, "comment_id": 89690134, "body": "always show the code you have written to battle the issue"}, {"owner": {"reputation": 107, "user_id": 5780608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f17fa3cec17273e3a38f9bb2817d9da7?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Singh", "link": "https://stackoverflow.com/users/5780608/aditi-singh"}, "reply_to_user": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1531735324, "post_id": 51358796, "comment_id": 89690518, "body": "@ScottStensland edited the question"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1531735377, "post_id": 51358796, "comment_id": 89690556, "body": "Implement unmarshaler interface to parse the json to implement in to struct"}], "answers": [{"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 0, "last_activity_date": 1531737575, "creation_date": 1531737575, "answer_id": 51359919, "question_id": 51358796, "link": "https://stackoverflow.com/questions/51358796/golang-json-unmarshal-according-to-key-value-pair/51359919#51359919", "title": "Golang json unmarshal according to key value pair", "body": "<p>Implement Unmarshaler interface:</p>\n\n<blockquote>\n  <p>Unmarshaler is the interface implemented by types that can unmarshal a\n  JSON description of themselves. The input can be assumed to be a valid\n  encoding of a JSON value. UnmarshalJSON must copy the JSON data if it\n  wishes to retain the data after returning.</p>\n</blockquote>\n\n<p>json unmarshaler interface assign the value from json to struct after parsing the result and applying conditions to fetch the value.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Details struct {\n    Data []universeSearchInfo `json:\"data\"`\n}\n\ntype universeTypeData struct {\n    Recent  universeSearchInfo\n    Popular universeSearchInfo\n    Digital universeSearchInfo\n}\n\ntype universeSearchInfo struct {\n    ID    string   `json:\"id\"`\n    Name  string   `json:\"name\"`\n    Items []string `json:\"items\"`\n}\n\nfunc main() {\n    var result universeTypeData\n    jsonBytes := []byte(`{\"data\": [\n                    {\n                        \"id\": \"recent_search\",\n                        \"items\": [],\n                        \"name\": \"\"\n                    },\n                    {\n                        \"id\": \"popular_search\",\n                        \"items\": [],\n                        \"name\": \"\"\n                    },\n                    {\n                        \"id\": \"digital\",\n                        \"items\": [],\n                        \"name\": \"DIGITAL\"\n                    }\n                ]}`)\n    if err := json.Unmarshal(jsonBytes, &amp;result); err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(result)\n\n}\n\nfunc (universeData *universeTypeData) UnmarshalJSON(data []byte) error {\n    var result Details\n    if err := json.Unmarshal(data, &amp;result); err != nil {\n        return err\n    }\n    for _,value := range result.Data{\n        switch value.ID {\n            case \"recent_search\":\n                universeData.Recent = value\n        }\n    }\n    return nil\n}\n</code></pre>\n\n<p>Working code on <a href=\"https://play.golang.org/p/AfZ99Ry5nso\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 2, "last_activity_date": 1531746578, "creation_date": 1531746578, "answer_id": 51362625, "question_id": 51358796, "link": "https://stackoverflow.com/questions/51358796/golang-json-unmarshal-according-to-key-value-pair/51362625#51362625", "title": "Golang json unmarshal according to key value pair", "body": "<p>You want to unmurshal JSON array into Go struct which is not natural mapping. Any way, you most likely should be first unmurshal in slice and then parse this slice. Some workaround is to use json.Decoder</p>\n\n<pre><code>dec := json.NewDecoder(JSONdataReader)\nvar res universeTypeData\n// read open bracket\ndec.Token()\n// while the array contains values\nfor dec.More() {\n    var m universeSearchInfo\n    // decode an array value\n    dec.Decode(&amp;m)\n    switch m.ID {\n    case \"recent_search\":\n        res.Recent = m\n    case \"popular_search\":\n        res.Popular = m\n    case \"digital\":\n        res.Digital = m\n    }\n}\n// read closing bracket\ndec.Token()\n</code></pre>\n\n<p>which allow you to decode on the fly, in one pass, without consuming intermediate slice representation. <a href=\"https://play.golang.org/p/EDRWgf7Jbz1\" rel=\"nofollow noreferrer\">Working example</a> </p>\n"}], "owner": {"reputation": 107, "user_id": 5780608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f17fa3cec17273e3a38f9bb2817d9da7?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Singh", "link": "https://stackoverflow.com/users/5780608/aditi-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3338, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1531746578, "creation_date": 1531733949, "last_edit_date": 1531735248, "question_id": 51358796, "link": "https://stackoverflow.com/questions/51358796/golang-json-unmarshal-according-to-key-value-pair", "title": "Golang json unmarshal according to key value pair", "body": "<p>I have json as following </p>\n\n<pre><code>\"data\": [\n    {\n        \"id\": \"recent_search\",\n        \"items\": [],\n        \"name\": \"\"\n    },\n    {\n        \"id\": \"popular_search\",\n        \"items\": [],\n        \"name\": \"\"\n    },\n    {\n        \"id\": \"digital\",\n        \"items\": [],\n        \"name\": \"DIGITAL\"\n    }\n]\n</code></pre>\n\n<p>and the structs are as follows:</p>\n\n<pre><code>type universeTypeData struct {\nRecent       universeSearchInfo \nPopular      universeSearchInfo \nDigital      universeSearchInfo \n}\n\ntype universeSearchInfo struct {\nID    string               `json:\"id\"`\nName  string               `json:\"name\"`\nItems []universeSearchItem `json:\"items\"`\n}\n</code></pre>\n\n<p>I want to unmarshal my json as \"id\" with value \"recent_search\" map to Recent, \"id\" with value \"popular_search\" map to Popular. Is there any way of doing this in golang? </p>\n\n<p>My approach of doing it is </p>\n\n<pre><code>for _, v := range result.Data {\n    if v.ID == \"in_category\" {\n        finalResult.Universe.InCategory.ID = v.ID\n        finalResult.Universe.InCategory.Name = v.Name\n        for _, abc := range v.Items {\n            finalResult.Universe.InCategory.Items = append(finalResult.Universe.InCategory.Items, abc)\n        }\n    }\n    if v.ID == \"recent_search\" {\n        finalResult.Universe.Recent.ID = v.ID\n        finalResult.Universe.Recent.Name = v.Name\n        for _, abc := range v.Items {\n            finalResult.Universe.Recent.Items = append(finalResult.Universe.Recent.Items, abc)\n        }\n    }\n    if v.ID == \"popular_search\" {\n        finalResult.Universe.Popular.ID = v.ID\n        finalResult.Universe.Popular.Name = v.Name\n        for _, abc := range v.Items {\n            finalResult.Universe.Popular.Items = append(finalResult.Universe.Popular.Items, abc)\n        }\n    }\n</code></pre>\n\n<p>Is there any better way of doing it?</p>\n"}, {"tags": ["docker", "go", "binary"], "comments": [{"owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "edited": false, "score": 2, "creation_date": 1531733250, "post_id": 51358411, "comment_id": 89689263, "body": "It looks like you are trying to use <a href=\"https://docs.docker.com/develop/develop-images/multistage-build/#use-multi-stage-builds\" rel=\"nofollow noreferrer\">multi-stage builds</a>. But I don&#39;t see the <code>COPY --from=builder</code> line which is supposed to copy the built artifact from the previous stage into the new stage. Have you checked if this is the problem?"}, {"owner": {"reputation": 15564, "user_id": 6394722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/117654f31d6ad5c9b2b0e00dcf4b24f3?s=128&d=identicon&r=PG&f=1", "display_name": "atline", "link": "https://stackoverflow.com/users/6394722/atline"}, "edited": false, "score": 1, "creation_date": 1531734606, "post_id": 51358411, "comment_id": 89690046, "body": "You log shown to us seems not come from the dockerfile you attached."}, {"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "reply_to_user": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "edited": false, "score": 1, "creation_date": 1531738629, "post_id": 51358411, "comment_id": 89692468, "body": "as suggested by @tgogos just comment out the <code>ADD main &#47;</code>  and add <code>COPY --from=builder  &#47;go&#47;src&#47;gitlab.com&#47;main&#47;server&#47;main . </code> then it will build and execute fine ... at least it does at my end"}, {"owner": {"reputation": 168, "user_id": 4805474, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-M62BNisOBUs/AAAAAAAAAAI/AAAAAAAAABk/N1apXvYQP0E/photo.jpg?sz=128", "display_name": "Mathias Egekvist", "link": "https://stackoverflow.com/users/4805474/mathias-egekvist"}, "reply_to_user": {"reputation": 15564, "user_id": 6394722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/117654f31d6ad5c9b2b0e00dcf4b24f3?s=128&d=identicon&r=PG&f=1", "display_name": "atline", "link": "https://stackoverflow.com/users/6394722/atline"}, "edited": false, "score": 0, "creation_date": 1531747308, "post_id": 51358411, "comment_id": 89697814, "body": "@atline yeah sorry about that tried a bunch of different things and forgot to correct both, but I got the error all the places :) Thank you @tgogos! Apparently, it was the only thing missing and now it is working!"}], "answers": [{"tags": [], "owner": {"reputation": 168, "user_id": 4805474, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-M62BNisOBUs/AAAAAAAAAAI/AAAAAAAAABk/N1apXvYQP0E/photo.jpg?sz=128", "display_name": "Mathias Egekvist", "link": "https://stackoverflow.com/users/4805474/mathias-egekvist"}, "is_accepted": true, "score": 1, "last_activity_date": 1532863659, "creation_date": 1532863659, "answer_id": 51579850, "question_id": 51358411, "link": "https://stackoverflow.com/questions/51358411/how-to-run-go-server-on-docker-from-binary/51579850#51579850", "title": "How to run go server on docker from binary", "body": "<p>As @tgogos pointed out did I need to use what I build in the first step. </p>\n\n<p>My final Dockerfile ended like this with a few further improvements: The important part is second last line though:</p>\n\n<pre><code>FROM golang:1.10.3 AS build\nWORKDIR /go/src/gitlab.com/main/server\nCOPY . .\nRUN go get github.com/golang/dep/cmd/dep &amp;&amp; \\\n      dep ensure &amp;&amp; \\\n      rm -f schema/bindata.go &amp;&amp; \\\n      go generate ./schema\nRUN CGO_ENABLED=0 GOOS=linux go build -a -o main .\n\nFROM alpine\nRUN apk add --no-cache ca-certificates\nCOPY --from=build /go/src/gitlab.com/main/server/main .\nCMD [\"/main\"]\n</code></pre>\n"}], "owner": {"reputation": 168, "user_id": 4805474, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-M62BNisOBUs/AAAAAAAAAAI/AAAAAAAAABk/N1apXvYQP0E/photo.jpg?sz=128", "display_name": "Mathias Egekvist", "link": "https://stackoverflow.com/users/4805474/mathias-egekvist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1250, "favorite_count": 0, "accepted_answer_id": 51579850, "answer_count": 1, "score": 2, "last_activity_date": 1532863659, "creation_date": 1531732653, "question_id": 51358411, "link": "https://stackoverflow.com/questions/51358411/how-to-run-go-server-on-docker-from-binary", "title": "How to run go server on docker from binary", "body": "<p>I have been trying to make a Dockerfile, that would let me build my go server as binary and then run it either from the scratch image or alpine. The server works fine locally, on macOS 10.13.5, and I made it work when it wasn't from binary on Docker. </p>\n\n<p>I keep getting this error:</p>\n\n<blockquote>\n  <p>standard_init_linux.go:190: exec user process caused \"exec format error\"</p>\n</blockquote>\n\n<p>I have been googling around and found something about system architecture. I am not sure how to check if that is the error and/or how to fix it. </p>\n\n<p>Any hints for debugging or possible fix are much appreciated.</p>\n\n<p>My Dockerfile:</p>\n\n<pre><code>FROM golang:1.10.3 as builder\nWORKDIR /go/src/gitlab.com/main/server\nCOPY . .\nRUN go get -d -v ./...\nRUN CGO_ENABLED=0 GOOS=linux go build -a -o main .\n\nFROM scratch\nADD main /\nCMD [\"/main\"]\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>Building go\nStep 1/9 : FROM golang:1.10.3 as builder\n ---&gt; 4e611157870f\nStep 2/9 : WORKDIR /go/src/gitlab.com/main/server\nRemoving intermediate container 20cd4d66008b\n ---&gt; 621d9fc02dde\nStep 3/9 : COPY . .\n ---&gt; cab639571baf\nStep 4/9 : RUN go get -d -v ./...\n ---&gt; Running in 7681f9adc7b2\nRemoving intermediate container 7681f9adc7b2\n ---&gt; 767a4c9dfb94\nStep 5/9 : RUN go build -a -installsuffix cgo -o main .\n ---&gt; Running in a6ec73121163\nRemoving intermediate container a6ec73121163\n ---&gt; b9d7d1c0d2f9\nStep 6/9 : FROM alpine:latest\n ---&gt; 11cd0b38bc3c\nStep 7/9 : WORKDIR /app\n ---&gt; Using cache\n ---&gt; 6d321d334b8f\nStep 8/9 : COPY . .\n ---&gt; 048a59fcdd8f\nStep 9/9 : CMD [\"/app/main\"]\n ---&gt; Running in d50d174644ff\nRemoving intermediate container d50d174644ff\n ---&gt; 68f8f3c6cdf7\nSuccessfully built 68f8f3c6cdf7\nSuccessfully tagged main_go:latest\nCreating go ... done\nAttaching to go\ngo           | standard_init_linux.go:190: exec user process caused \"exec format error\"\ngo exited with code 1\n</code></pre>\n"}, {"tags": ["go", "handler", "middleware"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1531732036, "post_id": 51358152, "comment_id": 89688546, "body": "No, it&#39;s not idiomatic to put data into context. Yes, it is idiomatic to create endpoint specific handlers."}, {"owner": {"reputation": 65, "user_id": 1223183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91c3714e6617808d979f396e361ae22?s=128&d=identicon&r=PG", "display_name": "user1223183", "link": "https://stackoverflow.com/users/1223183/user1223183"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1531732620, "post_id": 51358152, "comment_id": 89688881, "body": "Hey! Thanks for answer! Could you please elaborate on why it is not idiomatic to use context to pass data to further handlers/middlewares? I didn&#39;t found such information in <a href=\"https://golang.org/pkg/context/\" rel=\"nofollow noreferrer\">golang.org/pkg/context</a> . As I&#39;m starting with golang, all insight would be helpful! Thanks!"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1531736337, "post_id": 51358152, "comment_id": 89691149, "body": "It is in the first paragraph of the documentation you linked, although it&#39;s not very exact and it only states what the context is intended to carry and not what it should not, and so it is easy to overlook. If you need more info you can google &quot;what to put into golang context&quot; and you&#39;ll see a bunch of articles thay may be useful, for example: <a href=\"https://dave.cheney.net/2017/08/20/context-isnt-for-cancellation\" rel=\"nofollow noreferrer\">dave.cheney.net/2017/08/20/context-isnt-for-cancellation</a> and the linked articles in it should be of value to you."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1531747400, "post_id": 51358152, "comment_id": 89697869, "body": "Context is generally a very poor mechanism for storing/transfering data (due to implementation complexity and loss of type safety), and is best used for cancellation only if possible."}, {"owner": {"reputation": 65, "user_id": 1223183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91c3714e6617808d979f396e361ae22?s=128&d=identicon&r=PG", "display_name": "user1223183", "link": "https://stackoverflow.com/users/1223183/user1223183"}, "edited": false, "score": 0, "creation_date": 1531753408, "post_id": 51358152, "comment_id": 89701974, "body": "Thank you all for your answers! Probably question for another thread, but is there any other way to move data down to final handler? In most cases, I&#39;ll need user details, which I was expecting to grab in first middleware, right after auth check."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1531753929, "post_id": 51358152, "comment_id": 89702306, "body": "Many ways. One that has served me well is creating a &quot;request handler&quot; type to store request-specific details in a type-safe way. Each request gets a new instance created, and the actual handlers are implemented as methods on this type."}], "owner": {"reputation": 65, "user_id": 1223183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91c3714e6617808d979f396e361ae22?s=128&d=identicon&r=PG", "display_name": "user1223183", "link": "https://stackoverflow.com/users/1223183/user1223183"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531732263, "creation_date": 1531731757, "last_edit_date": 1531732263, "question_id": 51358152, "link": "https://stackoverflow.com/questions/51358152/are-custom-handlers-used-only-on-specific-urls-idiomatic-in-go", "title": "Are custom handlers (used only on specific urls) idiomatic in go", "body": "<p>Is it good practice in golang to write custom handlers used just in specific endpoints?</p>\n\n<p>I.e. given following endpoint: <code>/users/someusername/items/1</code> I know I'll need user information (for user with id: <code>someusername</code>) and also information for item with id: <code>1</code>. Would it be good practice to create 2 custom handlers, one which will handle pulling user data and putting it in context (and exit on error with proper response) and another one for pulling item data (and also putting it in context to use by further handlers)? \nAnd then using them as follow:</p>\n\n<pre><code>userItemsHandler := userContextHandler(itemConextHandler(ItemGET))\nr.Handle(\"/users/{username}/items/{itemId}\", userItemsHandler).Methods(\"PUT\")\n</code></pre>\n\n<p>In example, custom handler for items will be probably used in only couple endpoints, though I can see multiple usage for user handler.</p>\n\n<p>Thanks in advance for answers.</p>\n"}, {"tags": ["string", "go", "byte"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 3, "creation_date": 1531737922, "post_id": 51357928, "comment_id": 89692064, "body": "You should try to make it as easy as possible for people to help you. Your code doesn&#39;t compile because of unrelated errors. It&#39;s not a minimal example of your problem. Here&#39;s a simple, near minimal example that illustrates your problem: <a href=\"https://play.golang.org/p/5AypoIALwNv\" rel=\"nofollow noreferrer\">play.golang.org/p/5AypoIALwNv</a>  See <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a>"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 3, "last_activity_date": 1531756014, "last_edit_date": 1531756014, "creation_date": 1531738324, "answer_id": 51360122, "question_id": 51357928, "link": "https://stackoverflow.com/questions/51357928/how-to-solve-mismatched-types-string-and-byte-in-golang/51360122#51360122", "title": "How to solve (mismatched types string and byte) in Golang", "body": "<p>The error message describes your problem: <code>invalid operation: new_str + str[i + 1] (mismatched types string and byte)</code>. <code>str[i + 1]</code> is a byte from the underlying <code>str</code> array. Go requires explicit conversions. Write <code>string(str[i + 1])</code>.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nfunc g(str string) string {\n    var i = 0\n    var new_str = \"\"\n    for i &lt; len(str)-1 {\n\n        // invalid operation: new_str + str[i + 1] (mismatched types string and byte)\n        // new_str = new_str + str[i+1]\n\n        new_str = new_str + string(str[i+1])\n        i = i + 1\n    }\n    return new_str\n}\n\nfunc main() {}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/E9-n7IO-Q_z\" rel=\"nofollow noreferrer\">https://play.golang.org/p/E9-n7IO-Q_z</a></p>\n"}], "owner": {"reputation": 39, "user_id": 10087034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a9e323f6582ad2eea714aa6316e119?s=128&d=identicon&r=PG&f=1", "display_name": "Bizz", "link": "https://stackoverflow.com/users/10087034/bizz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4871, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1531756014, "creation_date": 1531730973, "question_id": 51357928, "link": "https://stackoverflow.com/questions/51357928/how-to-solve-mismatched-types-string-and-byte-in-golang", "title": "How to solve (mismatched types string and byte) in Golang", "body": "<pre><code>func g(str string) string {\n    var i = 0\n    var new_str = \"\"\n    for i &lt; len(str) - 1 {\n        new_str = new_str + str[i + 1]\n        i = i + 1\n}\n\nfunc f(str string) string {\nif len(str) == 0 {\n    return \"\"\n} else {\n    if len(str) == 1 {\n        return str\n    } else {\n        return f(g(str)) + str[0]\n    }\n}\n\nfunc h(n uint64, str string) string {\nfor n != 1 {\n    if n % 2 == 0 {\n        n = n / 2\n    } else {\n        n = 3*n + 1\n    }\n    str = f(str)\n}\nreturn str\n}\n\n\nfunc pow(x, y uint64) uint64 {\nif y == 0 {\n    return 1\n} else {\n    return x * pow(x, y-1)\n}\n}\n\n\nfunc main() {\nfmt.Println(h(1, \"fruits\"))\nfmt.Println(h(2, \"fruits\"))\nfmt.Println(h(5, \"fruits\"))\nfmt.Println(h(pow(2, 1000000000000000), \"fruits\"))\nfmt.Println(h(pow(2, 1000000000000000), \"fruits\"))\n}\n</code></pre>\n\n<blockquote>\n  <h1>command-line-arguments</h1>\n  \n  <blockquote>\n    <p>.\\fruits.go:11:21: invalid operation: new_str + str[i + 1] (mismatched types string and byte)\n    .\\fruits.go:24:21: invalid operation: f(g(str)) + str[0] (mismatched types string and byte)</p>\n  </blockquote>\n</blockquote>\n"}, {"tags": ["go", "concurrency", "channel", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1531729493, "last_edit_date": 1531729493, "creation_date": 1531729181, "answer_id": 51357429, "question_id": 51357361, "link": "https://stackoverflow.com/questions/51357361/deadlock-issue-when-using-routine-with-channel/51357429#51357429", "title": "Deadlock issue when using routine with channel", "body": "<p>You have 2 goroutines in your example: the main goroutine running the <code>main()</code> function, and the other you launch inside it. The main goroutine waits for the other to complete (to call <code>wg.Done()</code>), and the other goroutine blocks in the line where it attempts to send a value on channel <code>c</code>. Since nobody is receiving from that channel, and because that channel is unbuffered, this goroutine will never advance, so all your 2 goroutines will block forever.</p>\n\n<p>Note that <code>defer wg.Done()</code> should be the first statement in the goroutine. If it's the last, <code>defer</code> won't make any difference.</p>\n\n<p>If the channel would have a buffer of at least one, the send operation could proceed:</p>\n\n<pre><code>c := make(chan int, 1)\n</code></pre>\n\n<p>And output will be (try it on the <a href=\"https://play.golang.org/p/5v-g-xgnN-R\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>10\n</code></pre>\n\n<p>If we leave the channel unbuffered, there must be another goroutine that receives from the channel, e.g.:</p>\n\n<pre><code>wg.Add(1)\ngo func() {\n    defer wg.Done()\n    x := &lt;-c\n    fmt.Println(\"Received:\", x)\n}()\n</code></pre>\n\n<p>Then output will be (try it on the <a href=\"https://play.golang.org/p/DwXpf3eUCdm\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>10\nReceived: 10\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9395162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tran Tran", "link": "https://stackoverflow.com/users/9395162/tran-tran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 51357429, "answer_count": 1, "score": 1, "last_activity_date": 1531755457, "creation_date": 1531728898, "last_edit_date": 1531755457, "question_id": 51357361, "link": "https://stackoverflow.com/questions/51357361/deadlock-issue-when-using-routine-with-channel", "title": "Deadlock issue when using routine with channel", "body": "<p>I have issue when using Go routine with channel. The code looks like this:</p>\n\n<pre><code>func main() {\n    c := make(chan int)\n    var wg sync.WaitGroup\n\n    wg.Add(1)\n    go func (c chan int, x int) {\n        c &lt;- x\n        fmt.Println(x)\n        close(c)\n\n        defer wg.Done()\n    }(c,10)\n\n    wg.Wait()\n}\n</code></pre>\n\n<p>When run the code I got this error:</p>\n\n<pre><code>fatal error: all goroutines are asleep - deadlock!\n</code></pre>\n\n<p>I cannot understand why this issue happens. Please help me to understand</p>\n"}, {"tags": ["go", "iis", "websocket", "socket.io"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3857884, "user_type": "registered", "profile_image": "https://graph.facebook.com/1739364881/picture?type=large", "display_name": "Hamed Fazaely", "link": "https://stackoverflow.com/users/3857884/hamed-fazaely"}, "is_accepted": false, "score": 0, "last_activity_date": 1531766760, "creation_date": 1531766760, "answer_id": 51368313, "question_id": 51357142, "link": "https://stackoverflow.com/questions/51357142/iis-as-reverse-proxy-to-golang-socket-io/51368313#51368313", "title": "IIS as reverse proxy to golang socket.io", "body": "<p>I don't know how but the problem is solved by using wss instead of ws</p>\n"}], "owner": {"reputation": 1, "user_id": 3857884, "user_type": "registered", "profile_image": "https://graph.facebook.com/1739364881/picture?type=large", "display_name": "Hamed Fazaely", "link": "https://stackoverflow.com/users/3857884/hamed-fazaely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531766760, "creation_date": 1531728091, "last_edit_date": 1531728805, "question_id": 51357142, "link": "https://stackoverflow.com/questions/51357142/iis-as-reverse-proxy-to-golang-socket-io", "title": "IIS as reverse proxy to golang socket.io", "body": "<p>I use IIS httpPlatformHandler to run a golang implementation of socket.io behind IIS. </p>\n\n<p>When I disable IIS websocket module to let socket.io handle websocket connections I get an error reporting Sec-WebSocket-Accept response header is not present. </p>\n\n<p>When I run the app as a standalone process the header is present and everything works fine. I enabled iis websocket module and the Sec-WebSocket-Accept is present now but the connection is not stable and the client gets disconnected with reason transport close. </p>\n\n<p>Is there any solution for this?</p>\n"}, {"tags": ["go", "command-line-interface"], "answers": [{"tags": [], "owner": {"reputation": 6085, "user_id": 203200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f338eea2c0d517d29cf99865b831d3af?s=128&d=identicon&r=PG", "display_name": "Jawher", "link": "https://stackoverflow.com/users/203200/jawher"}, "is_accepted": false, "score": 0, "last_activity_date": 1534756354, "creation_date": 1534756354, "answer_id": 51927502, "question_id": 51356838, "link": "https://stackoverflow.com/questions/51356838/accept-empty-value-in-cmd-spec-mow-cli/51927502#51927502", "title": "Accept empty value in cmd.Spec mow.cli", "body": "<p>How about simply not passing the -p option ? i.e.:</p>\n\n<pre><code>config add XX -u=user\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 2670611, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5d4cc4c6f65ae16fe1b95a723f3251bd?s=128&d=identicon&r=PG", "display_name": "ToniyaSundaram", "link": "https://stackoverflow.com/users/2670611/toniyasundaram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1534756354, "creation_date": 1531726880, "last_edit_date": 1531735012, "question_id": 51356838, "link": "https://stackoverflow.com/questions/51356838/accept-empty-value-in-cmd-spec-mow-cli", "title": "Accept empty value in cmd.Spec mow.cli", "body": "<p>I took this code from mow.cli library A Larger Multi-Command Example <a href=\"https://github.com/jawher/mow.cli#spec\" rel=\"nofollow noreferrer\">https://github.com/jawher/mow.cli#spec</a>. if my command is \"config add \"XX\" -u=\"yname\" -p=\"123\"\". the result is \nAdding account user:admin@XX\nBut if I give a empty passphrase. Ex: \"config add \"XX\" -u=\"yname\" -p=\" the program throws error. </p>\n\n<pre><code>Error: incorrect usage \n</code></pre>\n\n<p>I see the cmd.Spec = \"ACCOUNT [ -u= ] [ -p=]\" is responsible for the input args. \nwhen I tried changing cmd.Spec = \"ACCOUNT [ -u= ] [ -p=&lt;>]\" it does not work. </p>\n\n<pre><code>panic: Parse error at position 32:ACCOUNT [ -u=&lt;username&gt; ] [ -p=&lt;&gt;]\n</code></pre>\n\n<p>Is there any option where the program can accept a empty passphrase. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 506, "user_id": 2832138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a572640dcd7416b0783869fe6759d32?s=128&d=identicon&r=PG", "display_name": "Maxim", "link": "https://stackoverflow.com/users/2832138/maxim"}, "edited": false, "score": 1, "creation_date": 1531730233, "post_id": 51356836, "comment_id": 89687444, "body": "I think you just abuse pointers in your example. Wherever you have * here you don&#39;t need it."}, {"owner": {"reputation": 13, "user_id": 9844996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0309f1f7243d5490829d1d47ef5ee82?s=128&d=identicon&r=PG&f=1", "display_name": "Sam lee", "link": "https://stackoverflow.com/users/9844996/sam-lee"}, "reply_to_user": {"reputation": 506, "user_id": 2832138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a572640dcd7416b0783869fe6759d32?s=128&d=identicon&r=PG", "display_name": "Maxim", "link": "https://stackoverflow.com/users/2832138/maxim"}, "edited": false, "score": 0, "creation_date": 1531790869, "post_id": 51356836, "comment_id": 89715955, "body": "Because i&#39;m taking over other&#39;s works. And these three type is used in many other codes"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9844996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0309f1f7243d5490829d1d47ef5ee82?s=128&d=identicon&r=PG&f=1", "display_name": "Sam lee", "link": "https://stackoverflow.com/users/9844996/sam-lee"}, "edited": false, "score": 0, "creation_date": 1531790718, "post_id": 51370354, "comment_id": 89715924, "body": "thanks for your answer, i&#39;m very sorry to cause you trouble because i ignore too much information, and now i have supplement more information in these three type and explain why i have these three type, as i add in my question, these three type already exist when i taking over other&#39;s works. And had used in many other code so it is so difficult to adjust."}], "tags": [], "owner": {"reputation": 104, "user_id": 10070765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G9ZAN.png?s=128&g=1", "display_name": "Zanicar", "link": "https://stackoverflow.com/users/10070765/zanicar"}, "is_accepted": true, "score": 0, "last_activity_date": 1531818030, "last_edit_date": 1531818030, "creation_date": 1531776628, "answer_id": 51370354, "question_id": 51356836, "link": "https://stackoverflow.com/questions/51356836/golang-copy-pointer-value-from-pointer-type-slice/51370354#51370354", "title": "golang copy pointer value from pointer type slice", "body": "<p>From your example and clarification we can focus on main to achieve your goal:</p>\n\n<pre><code>type Order struct {\n    *Res\n    Status int\n}\n\ntype Res struct {\n    ResID            int64\n    OtaBookID        string\n    StayDetail       []*ResElement\n    TotalCharge      float64\n    CustFName        string\n    CustLName        string\n    CreateTime       time.Time\n}\n\ntype ResElement struct {\n    Res        *Res\n    OtaEleID   string\n    OtaRoomID  string\n    RoomID     int\n    Arrival    time.Time\n    Depart     time.Time\n    Charge     float64\n    CreateTime time.Time\n}\n\nfunc main() {\n    var orderList []*Order\n\n    res := new(Res)\n    res.OtaBookID = \"A123\"\n\n    resElt := new(ResElement)\n    resElt.Res = res\n    res.StayDetail = append(res.StayDetail, resElt)\n\n    order := new(Order)\n    order.Res = res\n\n    orderList = append(orderList, order)\n\n    originalOrder := new(Order)\n    originalOrder.Res = new(Res)\n\n    // The following statement will copy the values in the memory space of order to the memory\n    // space of originalOrder, but take note that a pointer contains a memory address. Thus,\n    // following this statement originalOrder.Res.StayDetail will point to the same address\n    // as order.Res.StayDetail as slices are pointers...\n    *originalOrder.Res = *order.Res\n\n    // We now have to manually copy the slice to ensure it is different from the one in order.\n    // We must create a new slice to avoid overwriting the source.\n    originalOrder.Res.StayDetail := make([]*ResElement, len(order.Res.StayDetail))\n\n    // Further, this slice contains pointers so we must copy these as well to ensure they do not\n    // point to the ResElements of order.\n    for i, v := range order.Res.StayDetail {\n        re := new(ResElement)\n\n        // copy the values of the memory in v to the values in the memory of re\n        *re = *v\n\n        // set re.Res to point to originalOrder.Res as it currently point to order.Res\n        re.Res = originalOrder.Res\n\n        // Now we must place re in the slice of originalOrder as it currently points to an\n        // empty array of the correct size. Thus, we will not use append (which will grow\n        // the size), we will just set the index to the correct value. Thus:\n        originalOrder.StayDetail[i] = re\n    }\n    // The pointers and structures have now been properly set up, thus the following are equivalent:\n    // originalOrder.OtaBookID = \"B123\" - Res via embedding\n    // originalOrder.Res.OtaBookID = \"B123\" - Res directly\n    // originalOrder.Res.StayDetail[0].Res.OtaBookID = \"B123\" - Res via ResElement pointer Res\n    // They all point to the exact same memory space\n\n    originalOrder.Res.OtaBookID = \"B123\"\n\n    orderList = append(orderList, originalOrder)\n\n    fmt.Println(orderList[0].Res.OtaBookID)  //A123\n    fmt.Println(orderList[1].Res.OtaBookID)  //B123\n    fmt.Println(orderList[0].Res.StayDetail[0].Res.OtaBookID)  //A123\n    fmt.Println(orderList[1].Res.StayDetail[0].Res.OtaBookID)  //B123\n}\n</code></pre>\n\n<p>Always remember that a pointer is just a memory address. If the address value is 0xffab67e1 a copy of the pointer will also contain the same value of 0xffab67e1 and effectively point to the same thing. Thus you must deliberately assign new memory space at a new address and copy the internal values. This must be done for any structures that contain pointers. We call this a Deep Copy or a Clone.</p>\n"}], "owner": {"reputation": 13, "user_id": 9844996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0309f1f7243d5490829d1d47ef5ee82?s=128&d=identicon&r=PG&f=1", "display_name": "Sam lee", "link": "https://stackoverflow.com/users/9844996/sam-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2601, "favorite_count": 0, "accepted_answer_id": 51370354, "answer_count": 1, "score": 0, "last_activity_date": 1531818030, "creation_date": 1531726869, "last_edit_date": 1531790301, "question_id": 51356836, "link": "https://stackoverflow.com/questions/51356836/golang-copy-pointer-value-from-pointer-type-slice", "title": "golang copy pointer value from pointer type slice", "body": "<pre><code>type Order struct {\n    *Res\n    Status int\n}\n\ntype Res struct {\n    ResID            int64\n    OtaBookID        string\n    StayDetail       []*ResElement\n    TotalCharge      float64\n    CustFName        string\n    CustLName        string\n    CreateTime       time.Time\n}\n\ntype ResElement struct {\n    Res        *Res\n    OtaEleID   string\n    OtaRoomID  string\n    RoomID     int\n    Arrival    time.Time\n    Depart     time.Time\n    Charge     float64\n    CreateTime time.Time\n}\n</code></pre>\n\n<p>I have a slice named orderList to record orders.\nNow i have the first order which OtaBookID is \"A123\", and i want to copy this order and change its OtaBookID to \"B123\". The ResElement type have some other detail info to record this order and i hide them because it not affect my question. I can success change Res.OtaBookID but i have no idea how to change Res.StayDetail[0].Res.OtaBookID</p>\n\n<pre><code>func main() {\n    var orderList []*Order\n\n    res := new(Res)\n    res.OtaBookID = \"A123\"\n\n    resElt := new(ResElement)\n    resElt.Res = res\n    res.StayDetail = append(res.StayDetail, resElt)\n\n    order := new(Order)\n    order.Res = res\n\n    orderList = append(orderList, order)\n\n    originalOrder := new(Order)\n    originalOrder.Res = new(Res)\n    *originalOrder.Res = *order.Res\n    //originalOrder.Res.StayDetail[0].Res.OtaBookID = \"B123\" //this will make all become \"B123\"\n\n    originalOrder.Res.OtaBookID = \"B123\"\n\n    orderList = append(orderList, originalOrder)\n\n    fmt.Println(orderList[0].Res.OtaBookID)  //A123\n    fmt.Println(orderList[1].Res.OtaBookID)  //B123\n    fmt.Println(orderList[0].Res.StayDetail[0].Res.OtaBookID)  //A123\n    fmt.Println(orderList[1].Res.StayDetail[0].Res.OtaBookID)  //A123, i want this become B123\n}\n</code></pre>\n\n<p>The result i want is orderList[0].Res.OtaBookID and orderList[0].Res.StayDetail[0].Res.OtaBookID is \"A123\" and other is \"B123\"</p>\n\n<p>ps: Because i'm taking over other's works. So the three type already fixed and can not adjust. I want to know in this situation whether have any method to arrive my goal</p>\n"}, {"tags": ["go", "dll", "shared-libraries"], "comments": [{"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 2, "creation_date": 1531725864, "post_id": 51356541, "comment_id": 89685263, "body": "Go has not the concept of compiled libraries per-se. Implementing it as a service - and providing some end points such as REST, NATS, gRPC, etc - seems to be more convenient."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1531726471, "post_id": 51356541, "comment_id": 89685533, "body": "The sample code you posted is doable with plugins. Check out the <a href=\"https://golang.org/pkg/plugin/\" rel=\"nofollow noreferrer\"><code>plugin</code></a> package."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1531726952, "post_id": 51356541, "comment_id": 89685800, "body": "@icza I have been advised against using <code>plugin</code> package because it might go away. Does that still stands?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1531727055, "post_id": 51356541, "comment_id": 89685862, "body": "@KavehShahbazian I haven&#39;t heard anything about plugins going away. Can you give a (reliable) source?"}, {"owner": {"reputation": 329, "user_id": 9437085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZbW0.jpg?s=128&g=1", "display_name": "gyuaisdfaasf", "link": "https://stackoverflow.com/users/9437085/gyuaisdfaasf"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1531727633, "post_id": 51356541, "comment_id": 89686154, "body": "Thanks! @icza Is it possible to reverse engineer a go plugin"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1531727739, "post_id": 51356541, "comment_id": 89686206, "body": "@Ethan To some extent, yes. To reconstruct the exact same Go source, not. If you worry that much about your code, the only option is not to share your code but run a server and let clients connect to it."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1531729767, "post_id": 51356541, "comment_id": 89687171, "body": "@icza My mistake, sorry; yet this comment by Ian Lance Taylor suggests that it might hange. <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/nKY2rDRe9sE\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-nuts/nKY2rDRe9sE</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 2, "creation_date": 1531730029, "post_id": 51356541, "comment_id": 89687327, "body": "@KavehShahbazian The current plugin (package) interface is very minimalistic. Even if they introduce changes, I doubt they will be backward-incompatible changes; it&#39;s too easy to &quot;keep&quot; this minimalistic interface. Also there is the Go 1 compatibility promise."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531753125, "post_id": 51356541, "comment_id": 89701789, "body": "But bear in mind that plugins are only supported on Linux."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531754920, "post_id": 51356541, "comment_id": 89702917, "body": "@Adrian And macOS since Go 1.10: <i>&quot;Currently plugins are only supported on Linux and macOS. &quot;</i>"}], "owner": {"reputation": 329, "user_id": 9437085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZbW0.jpg?s=128&g=1", "display_name": "gyuaisdfaasf", "link": "https://stackoverflow.com/users/9437085/gyuaisdfaasf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531725704, "creation_date": 1531725704, "question_id": 51356541, "link": "https://stackoverflow.com/questions/51356541/golang-encapsulate-a-function", "title": "Golang encapsulate a function", "body": "<p>I have a function in go that I want to provide it to others(in other Go programs on unix servers). However, I don't want them to know the implementation so I can not just give them the source code. I've check out the c-shared buildmode but it seems troublesome because of all the conversions between C types and Go. I wonder if there are simpler ways like</p>\n\n<pre><code>lib := load(somelib)\nres := lib.somefunc(args)\n</code></pre>\n"}, {"tags": ["java", "go", "encryption", "cryptography", "blowfish"], "comments": [{"owner": {"reputation": 33331, "user_id": 1898563, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d99204bcce923f40f5c72b7f80121644?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1898563/michael"}, "edited": false, "score": 0, "creation_date": 1531725875, "post_id": 51356504, "comment_id": 89685267, "body": "In the decryption you specify no padding and in the encryption you do use padding."}, {"owner": {"reputation": 2339, "user_id": 4362675, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d818323432fae637c7932918a5bdf966?s=128&d=identicon&r=PG&f=1", "display_name": "The Coder", "link": "https://stackoverflow.com/users/4362675/the-coder"}, "reply_to_user": {"reputation": 33331, "user_id": 1898563, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d99204bcce923f40f5c72b7f80121644?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1898563/michael"}, "edited": false, "score": 0, "creation_date": 1531726421, "post_id": 51356504, "comment_id": 89685510, "body": "@Michael For testing both encryption and decryption in Java, I use <code>Blowfish&#47;ECB&#47;PKCS5Padding</code> for encryption and <code>Blowfish&#47;ECB&#47;NoPadding</code> for decryption which works as expected. So I think if padding is problem, it would&#39;ve already spitted with <code>BadPaddingException</code>"}, {"owner": {"reputation": 33331, "user_id": 1898563, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d99204bcce923f40f5c72b7f80121644?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1898563/michael"}, "edited": false, "score": 0, "creation_date": 1531726605, "post_id": 51356504, "comment_id": 89685615, "body": "Edit the info into the question please"}, {"owner": {"reputation": 8340, "user_id": 1645712, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/48781792c1fb7d61086b4fb612938c13?s=128&d=identicon&r=PG", "display_name": "gusto2", "link": "https://stackoverflow.com/users/1645712/gusto2"}, "edited": false, "score": 0, "creation_date": 1531726748, "post_id": 51356504, "comment_id": 89685697, "body": "I believe you problem is in the <code>bytes</code> of thr golang example. I am no expert in golang, but I&#39;d assume you are creating a bytearray from the string characters, not decoding the hex value"}, {"owner": {"reputation": 2339, "user_id": 4362675, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d818323432fae637c7932918a5bdf966?s=128&d=identicon&r=PG&f=1", "display_name": "The Coder", "link": "https://stackoverflow.com/users/4362675/the-coder"}, "reply_to_user": {"reputation": 8340, "user_id": 1645712, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/48781792c1fb7d61086b4fb612938c13?s=128&d=identicon&r=PG", "display_name": "gusto2", "link": "https://stackoverflow.com/users/1645712/gusto2"}, "edited": false, "score": 0, "creation_date": 1531727239, "post_id": 51356504, "comment_id": 89685962, "body": "@gusto2 gotcha..! Problem is with in converting key to byte[], rather than decoding the hex, simply converted it to byte. You could post this as answer."}], "answers": [{"tags": [], "owner": {"reputation": 8340, "user_id": 1645712, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/48781792c1fb7d61086b4fb612938c13?s=128&d=identicon&r=PG", "display_name": "gusto2", "link": "https://stackoverflow.com/users/1645712/gusto2"}, "is_accepted": true, "score": 2, "last_activity_date": 1531744368, "last_edit_date": 1531744368, "creation_date": 1531728415, "answer_id": 51357226, "question_id": 51356504, "link": "https://stackoverflow.com/questions/51356504/blowfish-golang-encryption-and-java-decryption/51357226#51357226", "title": "Blowfish GoLang Encryption and Java Decryption", "body": "<pre><code>key := []byte(\"1c157d26e2db9a96a556e7614e1fbe36\")\n</code></pre>\n\n<p>I believe this piece of code returns byte array of the string itself, not hex decoded value. To get a  valid key you may try to use <a href=\"https://golang.org/pkg/encoding/hex/\" rel=\"nofollow noreferrer\">hex decoding</a> </p>\n"}], "owner": {"reputation": 2339, "user_id": 4362675, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d818323432fae637c7932918a5bdf966?s=128&d=identicon&r=PG&f=1", "display_name": "The Coder", "link": "https://stackoverflow.com/users/4362675/the-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 923, "favorite_count": 0, "accepted_answer_id": 51357226, "answer_count": 1, "score": 1, "last_activity_date": 1531744368, "creation_date": 1531725583, "last_edit_date": 1531727309, "question_id": 51356504, "link": "https://stackoverflow.com/questions/51356504/blowfish-golang-encryption-and-java-decryption", "title": "Blowfish GoLang Encryption and Java Decryption", "body": "<p>Unable to decrypt the cipher text in Java which is ecrypted in GoLang using Blowfish.</p>\n\n<p><strong>Encryption</strong></p>\n\n<pre><code>import (\n    \"testing\"\n    \"golang.org/x/crypto/blowfish\"\n    \"github.com/andreburgaud/crypt2go/ecb\"\n    \"github.com/andreburgaud/crypt2go/padding\"\n    \"fmt\"\n    \"encoding/base64\"\n)\n\nfunc TestEncrypt(t *testing.T) {\n\n    bytes := []byte(\"cap\")\n    key := []byte(\"1c157d26e2db9a96a556e7614e1fbe36\")\n\n    encByte := encrypt(bytes, key)\n    enc := base64.StdEncoding.EncodeToString(encByte)\n    fmt.Printf(\"ENC - %s\\n\", enc)\n}\n\nfunc encrypt(pt, key []byte) []byte {\n    block, err := blowfish.NewCipher(key)\n    if err != nil {\n        panic(err.Error())\n    }\n    mode := ecb.NewECBEncrypter(block)\n    padder := padding.NewPkcs5Padding()\n    pt, err = padder.Pad(pt) // padd last block of plaintext if block size less than block cipher size\n    if err != nil {\n        panic(err.Error())\n    }\n    ct := make([]byte, len(pt))\n    mode.CryptBlocks(ct, pt)\n    return ct\n}\n\n// Output\n// ENC - AP9atM49v8o=\n</code></pre>\n\n<p><strong>Decryption</strong></p>\n\n<pre><code>import lombok.SneakyThrows;\n\nimport javax.crypto.Cipher;\nimport javax.crypto.spec.SecretKeySpec;\n\nimport static java.util.Base64.getDecoder;\nimport static java.util.Base64.getEncoder;\n\npublic class UserAuthenticationFilter {\n\n    public static void main(String[] args) throws Exception {\n        String key = \"1c157d26e2db9a96a556e7614e1fbe36\";\n        System.out.println(decrypt(getDecoder().decode(\"AP9atM49v8o=\"), key));\n\n        // encryption and decryption verification\n        // String plainText = \"cap\";\n        // String cipher = encrypt(plainText, key);\n        // String decrypted = decrypt(getDecoder().decode(enc), key);\n        // assert decrypted.equals(plainText);\n    }\n\n    @SneakyThrows\n    public static String encrypt(String plainText, String key) {\n        byte[] myKeyByte = hexToBytes(key);\n        SecretKeySpec skeySpec = new SecretKeySpec(myKeyByte, \"Blowfish\");\n        Cipher ecipher = Cipher.getInstance(\"Blowfish/ECB/PKCS5Padding\");\n        ecipher.init(Cipher.ENCRYPT_MODE, skeySpec);\n\n        byte[] src = ecipher.doFinal(plainText.getBytes(\"ISO-8859-1\"));\n        return getEncoder().encodeToString(src);\n    }\n\n    @SneakyThrows\n    public static String decrypt(byte[] cipherContent, String key) {\n        byte[] myKeyByte = hexToBytes(key);\n        SecretKeySpec skeySpec = new SecretKeySpec(myKeyByte, \"Blowfish\");\n        Cipher dcipher = Cipher.getInstance(\"Blowfish/ECB/NoPadding\");\n        dcipher.init(2, skeySpec);\n        byte[] dcontent = dcipher.doFinal(cipherContent);\n        return (new String(dcontent, \"ISO-8859-1\")).trim();\n    }\n\n    private static byte[] hexToBytes(String str) {\n        if (str == null) {\n            return null;\n        } else if (str.length() &lt; 2) {\n            return null;\n        } else {\n            int len = str.length() / 2;\n            byte[] buffer = new byte[len];\n\n            for(int i = 0; i &lt; len; ++i) {\n                buffer[i] = (byte)Integer.parseInt(str.substring(i * 2, i * 2 + 2), 16);\n            }\n\n            return buffer;\n        }\n    }\n\n}\n\n// Output\n// BY x\u00b3\n</code></pre>\n\n<p>As per the outputs, encryption in GoLang and decryption in Java doesn't produce the same plain text. Initially, thought the problem might be related to golang's byte (0 to 255) and java's byte (-128 to 127) involved in base64 encoding and decoding. But poking in Java's decryption code, it's handled correctly with <code>value &amp; 255</code>.</p>\n\n<p>Decryption of the same cipher text in golang works perfectly. Also encryption and decryption in Java works perfectly. But not the encryption in one and decryption in other.</p>\n\n<p>I think the encryption and decryption logic were correct. Only guess might be there's some language specific ??? is missing when the cipher text is ported to other language for decryption.</p>\n"}, {"tags": ["go", "reverse-proxy", "httpwebresponse"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531753216, "post_id": 51356104, "comment_id": 89701847, "body": "It doesn&#39;t show it in the browser, or in the raw response? Because if you&#39;re just looking in the browser, you likely won&#39;t see your added text because you&#39;re prepending it to an HTML file, before the doctype or root tag, which is syntactically invalid and may be discarded by the browser."}], "answers": [{"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": true, "score": 6, "last_activity_date": 1531764295, "creation_date": 1531764295, "answer_id": 51367728, "question_id": 51356104, "link": "https://stackoverflow.com/questions/51356104/how-do-i-use-proxy-modifyresponse/51367728#51367728", "title": "How do I use proxy.ModifyResponse?", "body": "<p>Your <code>ModifyResponse</code> code is not modifying the response. In your code, you have:</p>\n\n<pre><code>r.Write(bytes.NewBufferString(\"monkeys\"+html))\n</code></pre>\n\n<p>It seems that you are writing to the response, but nope. <code>r</code> is of <code>*http.Response</code> which has a <code>Write</code> method:</p>\n\n<pre><code>func (r *Response) Write(w io.Writer) error\n</code></pre>\n\n<p>The <a href=\"https://golang.org/pkg/net/http/#Response.Write\" rel=\"noreferrer\">document</a> says:</p>\n\n<blockquote>\n  <p>Write writes r to w in the HTTP/1.x server response format, including the status line, headers, body, and optional trailer. </p>\n</blockquote>\n\n<p>Since <code>bytes.Buffer</code> also implements a <code>io.Writer</code>, the code compiles, but instead of write to the response from the buffer, it write the response to the buffer, which is absolutely undesired.</p>\n\n<p>The fact is, <code>http.Response</code> simply don't provide a way to modify its <code>Body</code>. It is clear that <code>Bodey</code> is an <code>io.ReadCloser</code>. What you can do is create a new <code>io.ReadCloser</code> with the body. Remember to change <code>Content-Length</code> field in the <code>Header</code> or it may cause problem.</p>\n\n<pre><code>func UpdateResponse(r *http.Response) error {\n    b, _ := ioutil.ReadAll(r.Body)\n    buf := bytes.NewBufferString(\"Monkey\")\n    buf.Write(b)\n    r.Body = ioutil.NopCloser(buf)\n    r.Header[\"Content-Length\"] = []string{fmt.Sprint(buf.Len())}\n    return nil\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/_Tyvo6GVN3x\" rel=\"noreferrer\">https://play.golang.org/p/_Tyvo6GVN3x</a></p>\n"}], "owner": {"reputation": 764, "user_id": 1405725, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/85157a97c87155b8ec2671e86aef1087?s=128&d=identicon&r=PG", "display_name": "Darian311", "link": "https://stackoverflow.com/users/1405725/darian311"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2238, "favorite_count": 1, "accepted_answer_id": 51367728, "answer_count": 1, "score": 2, "last_activity_date": 1531764295, "creation_date": 1531723956, "question_id": 51356104, "link": "https://stackoverflow.com/questions/51356104/how-do-i-use-proxy-modifyresponse", "title": "How do I use proxy.ModifyResponse?", "body": "<p>I've implemented the most basic Reverse Proxy to pull a page and then add some content to the body.  Unfortunately my attempt to add to the html isn't taking effect.  The code below just shows the original page but without the \"monkeys\" I prepended to the response.  What additional calls are needed to get this to work? I eventually want to use this to replace css for custom css. </p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"net/http/httputil\"\n    \"net/url\"\n    \"fmt\"\n    \"github.com/PuerkitoBio/goquery\"\n    \"bytes\"\n)\n\ntype Director func(*http.Request)\n\nfunc (f Director) Then(g Director) Director {\n    return func(req *http.Request) {\n        f(req)\n        g(req)\n    }\n}\n\nfunc hostDirector(host string) Director {\n    return func(req *http.Request) {\n        req.Host = host\n    }\n}\n\nfunc UpdateResponse(r *http.Response) error {\n    doc, err := goquery.NewDocumentFromReader(r.Body)\n    if err != nil{\n        //log.New(\"Research\")\n        log.Fatal(\"Bad doc %v\", err)\n        return err\n    }\n    html, err := goquery.OuterHtml(doc.First())\n    if err != nil{\n        log.Fatal(\"Bad html %v\", err)\n        return err\n    }\n    fmt.Printf(\"Body %v\", html)\n    r.Write(bytes.NewBufferString(\"monkeys\"+html))\n\n    return nil\n}\n\nfunc main() {\n    url, _ := url.Parse(\"http://cnn.com/\")\n    proxy := httputil.NewSingleHostReverseProxy(url)\n\n    d := proxy.Director\n    // sequence the default director with our host director\n    proxy.Director = Director(d).Then(hostDirector(url.Hostname()))\n    proxy.ModifyResponse = UpdateResponse\n    http.Handle(\"/\", proxy)\n    log.Fatal(http.ListenAndServe(\":9090\", nil))\n}\n</code></pre>\n"}, {"tags": ["go", "visual-studio-code"], "comments": [{"owner": {"reputation": 150862, "user_id": 790387, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/450fd2737dd0355700a574bd12842509?s=128&d=identicon&r=PG", "display_name": "Burhan Khalid", "link": "https://stackoverflow.com/users/790387/burhan-khalid"}, "edited": false, "score": 0, "creation_date": 1531722820, "post_id": 51355755, "comment_id": 89683847, "body": "Seems not: <a href=\"https://code.visualstudio.com/docs/languages/go\" rel=\"nofollow noreferrer\">code.visualstudio.com/docs/languages/go</a> - why not stick with what works?"}, {"owner": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "reply_to_user": {"reputation": 150862, "user_id": 790387, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/450fd2737dd0355700a574bd12842509?s=128&d=identicon&r=PG", "display_name": "Burhan Khalid", "link": "https://stackoverflow.com/users/790387/burhan-khalid"}, "edited": false, "score": 0, "creation_date": 1531722862, "post_id": 51355755, "comment_id": 89683863, "body": "@BurhanKhalid, I am still contemplating whether to buy goland as I have the trial version only"}], "answers": [{"comments": [{"owner": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "edited": false, "score": 0, "creation_date": 1531753025, "post_id": 51362168, "comment_id": 89701733, "body": "it says plugin is deprecated now. Says use VS provided plugin or sth. Does that all the capabilities you mention? How do I install this plugin otherwise?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531753316, "post_id": 51362168, "comment_id": 89701912, "body": "For the last point, it does the opposite of what is asked (shows structs implementing an interface, not interfaces implemented by a struct)."}, {"owner": {"reputation": 556, "user_id": 3581874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2073bb9adeaf4226234f85ff4c1b69?s=128&d=identicon&r=PG&f=1", "display_name": "MichalG", "link": "https://stackoverflow.com/users/3581874/michalg"}, "reply_to_user": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "edited": false, "score": 0, "creation_date": 1531754177, "post_id": 51362168, "comment_id": 89702449, "body": "@curiousengineer you&#39;re right. The extension seems to be deprecated now, I haven&#39;t noticed it, just found right now. However, native Code Outline view seems to be working the same way, you can enable it here: <a href=\"https://code.visualstudio.com/updates/v1_24#_outline-view\" rel=\"nofollow noreferrer\">code.visualstudio.com/updates/v1_24#_outline-view</a> Does that work for you?"}], "tags": [], "owner": {"reputation": 556, "user_id": 3581874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2073bb9adeaf4226234f85ff4c1b69?s=128&d=identicon&r=PG&f=1", "display_name": "MichalG", "link": "https://stackoverflow.com/users/3581874/michalg"}, "is_accepted": false, "score": 4, "last_activity_date": 1531745110, "creation_date": 1531745110, "answer_id": 51362168, "question_id": 51355755, "link": "https://stackoverflow.com/questions/51355755/vscode-for-golang/51362168#51362168", "title": "VSCODE for golang", "body": "<p>Actually it is possible to do all three things in VS Code as well.</p>\n\n<p><strong>1. List of all functions, structs, interface - Code Outline</strong></p>\n\n<p>There is a great extension <a href=\"https://marketplace.visualstudio.com/items?itemName=patrys.vscode-code-outline\" rel=\"nofollow noreferrer\">Code Outline</a> that works very well with Go code. I'm using it successfully without any problems.</p>\n\n<p><a href=\"https://i.stack.imgur.com/C1uGQ.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C1uGQ.gif\" alt=\"Code outline\"></a></p>\n\n<p><strong>2. Is there a way to click on an interface and see who all implement it?</strong></p>\n\n<p>According to VS Code <a href=\"https://code.visualstudio.com/docs/editor/editingevolved#_go-to-implementation\" rel=\"nofollow noreferrer\">documentation</a>, it is possible to go to definition using <kbd>Ctrl</kbd>+<kbd>F12</kbd> shortcut. It seems to work well for Go source code at this point.</p>\n\n<p><a href=\"https://i.stack.imgur.com/vvKmD.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vvKmD.gif\" alt=\"Interface to implementation\"></a></p>\n\n<p><strong>3. Is there a way to click on a struct and see what all interfaces it implements?</strong></p>\n\n<p>Similarly as with answer above, and according to documentation, <kbd>Ctrl</kbd>+<kbd>F12</kbd> shortcut seems to be working well in that case.</p>\n\n<blockquote>\n  <p>For an interface, this shows all the implementors of that interface\n  and for abstract methods, this shows all concrete implementations of\n  that method.</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/mu40I.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mu40I.gif\" alt=\"Implementation to interface\"></a></p>\n"}], "owner": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2034, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1531745110, "creation_date": 1531722482, "last_edit_date": 1531724378, "question_id": 51355755, "link": "https://stackoverflow.com/questions/51355755/vscode-for-golang", "title": "VSCODE for golang", "body": "<p>I have been using VSCode forGolang and sometimes GoLand trial version. I want to stick with VSCode but I cannot find the below things in the plugin. Can anyone tell me if it is possible or not</p>\n\n<ul>\n<li>There is no way for me to have a pop-up show up to see the list of all functions, structs, interfaces in the file that I have open?</li>\n<li>Is there a way to click on an interface and see who all implement it?</li>\n<li>Is there a way to click on a struct and see what all interfaces it implements?</li>\n</ul>\n\n<p>GoLand has all the 3 and that is what makes it amazing. Other than that most things are similar.</p>\n"}, {"tags": ["go", "grafana", "building"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10086099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf7cb683d832bc267a7583007d1279c?s=128&d=identicon&r=PG&f=1", "display_name": "gunsimar", "link": "https://stackoverflow.com/users/10086099/gunsimar"}, "edited": false, "score": 0, "creation_date": 1531719006, "post_id": 51354652, "comment_id": 89682545, "body": "Thank you for your reply. I did that and then tried &#39;go run build.go setup&#39; but it still gives the same error of the system cannot find the file specified."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 11, "user_id": 10086099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf7cb683d832bc267a7583007d1279c?s=128&d=identicon&r=PG&f=1", "display_name": "gunsimar", "link": "https://stackoverflow.com/users/10086099/gunsimar"}, "edited": false, "score": 0, "creation_date": 1531722629, "post_id": 51354652, "comment_id": 89683750, "body": "@gunsimar first, it depend in which folder you are executing that command. Second, make sure the shell session you are in, when executing that command, does have <code>GOPATH</code> still set to <code>C:\\myFolder</code>. Third, check first that <code>$GOPATH\\src\\github.com\\grafana\\grafana</code> does exists after <code>go get</code>."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 0, "last_activity_date": 1531715747, "creation_date": 1531715747, "answer_id": 51354652, "question_id": 51354458, "link": "https://stackoverflow.com/questions/51354458/system-cannot-find-path-specified-file-specified-grafana/51354652#51354652", "title": "system cannot find path specified / file specified grafana", "body": "<p>Try to create a new empty folder:</p>\n\n<pre><code>mkdir C:\\myFolder\ncd C:\\myFolder\nset GOPATH=C:\\myFolder\ngo get github.com/grafana/grafana\n</code></pre>\n\n<p>That should create a <code>src\\github.com\\grafana\\grafana</code> folder, with the sources inside.</p>\n"}], "owner": {"reputation": 11, "user_id": 10086099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf7cb683d832bc267a7583007d1279c?s=128&d=identicon&r=PG&f=1", "display_name": "gunsimar", "link": "https://stackoverflow.com/users/10086099/gunsimar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1078, "favorite_count": 1, "accepted_answer_id": 51354652, "answer_count": 1, "score": 0, "last_activity_date": 1531875839, "creation_date": 1531714015, "last_edit_date": 1531875839, "question_id": 51354458, "link": "https://stackoverflow.com/questions/51354458/system-cannot-find-path-specified-file-specified-grafana", "title": "system cannot find path specified / file specified grafana", "body": "<p>I've been trying to build grafana from its source code on windows by following the instructions <a href=\"http://docs.grafana.org/project/building_from_source/#dependencies\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>I am stuck and am failing to set the GOPATH path properly.\nI set it to the default go directory in C:\\myname but whenever I try to change to that directory using the command \"cd $GOPATH/src/github.com/grafana/grafana\" it says the system cannot find the specified path.\nAnd even if I put the path manually and in the directory try to run \"go run build.go setup\" the system cannot find the file specified.</p>\n\n<p>If someone could help me that'd be great! </p>\n"}, {"tags": ["go", "soap", "soapserver"], "comments": [{"owner": {"reputation": 480, "user_id": 9448870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ckK5P.jpg?s=128&g=1", "display_name": "Daniel Sch&#252;tte", "link": "https://stackoverflow.com/users/9448870/daniel-sch%c3%bctte"}, "edited": false, "score": 1, "creation_date": 1531874223, "post_id": 51354047, "comment_id": 89755807, "body": "What is your problem? What errors does your code produce? Please ask an actually question instead of asking for general advise."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 8793376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395db94bd0f93b19452a7ef5773ad69a?s=128&d=identicon&r=PG&f=1", "display_name": "425devon", "link": "https://stackoverflow.com/users/8793376/425devon"}, "is_accepted": false, "score": 1, "last_activity_date": 1538696418, "last_edit_date": 1538696418, "creation_date": 1538684973, "answer_id": 52654702, "question_id": 51354047, "link": "https://stackoverflow.com/questions/51354047/how-to-use-gowsdl-to-connect-with-soap-server/52654702#52654702", "title": "How to use gowsdl to connect with soap server?", "body": "<p>Make a new client based off of the myservice.go file that was generated:</p>\n\n<pre><code>client := NewSoapClient(\"http://yourEndPoint.svc\", false, nil)\n</code></pre>\n\n<p>Use that client to do stuff:</p>\n\n<pre><code>resp, err := client.SomeStuffDefinedInSoapService()\nif err != nil {\nhandle error...\n}\nfmt.Println(resp)\n</code></pre>\n"}], "owner": {"reputation": 16, "user_id": 8860794, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-M1sw1b7LhyA/AAAAAAAAAAI/AAAAAAAAAZY/WAJ5JXng0ic/photo.jpg?sz=128", "display_name": "Prilandini", "link": "https://stackoverflow.com/users/8860794/prilandini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538696418, "creation_date": 1531710157, "last_edit_date": 1531894380, "question_id": 51354047, "link": "https://stackoverflow.com/questions/51354047/how-to-use-gowsdl-to-connect-with-soap-server", "title": "How to use gowsdl to connect with soap server?", "body": "<p>I'm just starting with golang and SOAP service. I want to connect with SOAP server using gowsdl. I've generated with <strong>gowsdl</strong> and got <strong>myservice.go</strong>. What do I need to do next?</p>\n"}, {"tags": ["google-app-engine", "go", "google-container-registry"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1531715064, "post_id": 51353818, "comment_id": 89681530, "body": "Can you check your PATH value in your ~/.bashrc? Does it include /usr/bin?"}, {"owner": {"reputation": 2516, "user_id": 2293705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b985837e65bbdfc841f890511abd859?s=128&d=identicon&r=PG", "display_name": "calcinai", "link": "https://stackoverflow.com/users/2293705/calcinai"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1531718873, "post_id": 51353818, "comment_id": 89682507, "body": "In my ~/.bashrc or the remote one? I don&#39;t know how to access the running instance in GCR..."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1531719289, "post_id": 51353818, "comment_id": 89682615, "body": "The remote one."}, {"owner": {"reputation": 2516, "user_id": 2293705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b985837e65bbdfc841f890511abd859?s=128&d=identicon&r=PG", "display_name": "calcinai", "link": "https://stackoverflow.com/users/2293705/calcinai"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1531721690, "post_id": 51353818, "comment_id": 89683371, "body": "Is it possible to access the remote shell in GCR? I guess that&#39;s is really my question, if I could get in and have a look I might be able to fix it."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1531722227, "post_id": 51353818, "comment_id": 89683584, "body": "Maybe using cloud shell? <a href=\"https://console.cloud.google.com/getting-started?cloudshell\" rel=\"nofollow noreferrer\">console.cloud.google.com/getting-started?cloudshell</a>"}, {"owner": {"reputation": 2516, "user_id": 2293705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b985837e65bbdfc841f890511abd859?s=128&d=identicon&r=PG", "display_name": "calcinai", "link": "https://stackoverflow.com/users/2293705/calcinai"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1531731512, "post_id": 51353818, "comment_id": 89688243, "body": "I&#39;ve had a look through the docs and I can&#39;t see any specific references to it. Do you know if it&#39;s possible to test with the <code>gcr.io</code> images locally?  Even if I manage that, and I fix the <code>PATH</code>, I don&#39;t see a way to modify Google&#39;s container templates."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1531732592, "post_id": 51353818, "comment_id": 89688858, "body": "Not sure: <a href=\"https://github.com/GoogleContainerTools/container-structure-test/issues/93\" rel=\"nofollow noreferrer\">github.com/GoogleContainerTools/container-structure-test/iss&zwnj;&#8203;ues/&hellip;</a> maybe?"}, {"owner": {"reputation": 1028, "user_id": 5557074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MtjhA.jpg?s=128&g=1", "display_name": "David Bendory", "link": "https://stackoverflow.com/users/5557074/david-bendory"}, "edited": false, "score": 0, "creation_date": 1531755979, "post_id": 51353818, "comment_id": 89703542, "body": "You can run a build with a build step that overrides the entrypoint to use the bash shell and echo your $PATH -- set the <code>entrypoint</code> on <code>BuildStep</code> to <code>&#47;bin&#47;bash</code> and use args <code>[ &quot;-c&quot;, &quot;whatever bash command you want to run&quot; ]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2516, "user_id": 2293705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b985837e65bbdfc841f890511abd859?s=128&d=identicon&r=PG", "display_name": "calcinai", "link": "https://stackoverflow.com/users/2293705/calcinai"}, "edited": false, "score": 0, "creation_date": 1531794922, "post_id": 51365908, "comment_id": 89716741, "body": "I guess this is my best bet. It does seem strange that that Google&#39;s build image can&#39;t even build the App Engine SDK! (when I remove it as a dep, it deploys fine)"}, {"owner": {"reputation": 1028, "user_id": 5557074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MtjhA.jpg?s=128&g=1", "display_name": "David Bendory", "link": "https://stackoverflow.com/users/5557074/david-bendory"}, "reply_to_user": {"reputation": 2516, "user_id": 2293705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b985837e65bbdfc841f890511abd859?s=128&d=identicon&r=PG", "display_name": "calcinai", "link": "https://stackoverflow.com/users/2293705/calcinai"}, "edited": false, "score": 0, "creation_date": 1531917252, "post_id": 51365908, "comment_id": 89774998, "body": "I filed this issue: <a href=\"https://github.com/GoogleCloudPlatform/golang-docker/issues/141\" rel=\"nofollow noreferrer\">github.com/GoogleCloudPlatform/golang-docker/issues/141</a>; if this is critical to you, they no doubt accept pull requests..."}, {"owner": {"reputation": 7570, "user_id": 348162, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/681843573f794800a9a19b0957b37c98?s=128&d=identicon&r=PG", "display_name": "Montaro", "link": "https://stackoverflow.com/users/348162/montaro"}, "edited": false, "score": 0, "creation_date": 1584232450, "post_id": 51365908, "comment_id": 107374033, "body": "Another option is to change the <code>app.yaml</code> to have <code>runtime: custom</code> and create your own Dockerfile with your favorite image to build the app: ``` FROM golang:latest RUN mkdir /app ADD . /app/ WORKDIR /app RUN go build -o main . CMD [&quot;/app/main&quot;] ```"}], "tags": [], "owner": {"reputation": 1028, "user_id": 5557074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MtjhA.jpg?s=128&g=1", "display_name": "David Bendory", "link": "https://stackoverflow.com/users/5557074/david-bendory"}, "is_accepted": false, "score": 2, "last_activity_date": 1531756869, "creation_date": 1531756869, "answer_id": 51365908, "question_id": 51353818, "link": "https://stackoverflow.com/questions/51353818/exec-gcc-executable-file-not-found-in-path/51365908#51365908", "title": "exec: &quot;gcc&quot;: executable file not found in $PATH", "body": "<p>It looks like you are using container <a href=\"http://gcr.io/gcp-runtimes/go1-builder\" rel=\"nofollow noreferrer\">gcr.io/gcp-runtimes/go1-builder</a> as your build step. Looking at the <a href=\"https://github.com/GoogleCloudPlatform/golang-docker/tree/master/runtime-builder\" rel=\"nofollow noreferrer\">source in GitHub</a>, I see that there have been no updates since ~late June. I see in the <a href=\"https://github.com/GoogleCloudPlatform/golang-docker/blob/master/runtime-builder/Dockerfile\" rel=\"nofollow noreferrer\">Dockerfile</a> that the base image in the <code>FROM</code> directive is <code>gcr.io/google-appengine/debian9:latest</code>, and a look at that image reveals no <code>gcc</code> installed. I see no step in the <code>Dockerfile</code> installing gcc, and looking at your build step image confirms that it isn't there:</p>\n\n<pre><code>~$ docker run --rm -t -i --entrypoint /bin/bash gcr.io/gcp-runtimes/go1-builder@sha256:c62ac3fbec31ddec70601d6c5b44d07063bcff6a823bdcf5e0bbaa9d3799d1db -- which gcc\nUnable to find image 'gcr.io/gcp-runtimes/go1-builder@sha256:c62ac3fbec31ddec70601d6c5b44d07063bcff6a823bdcf5e0bbaa9d3799d1db' locally\nsha256:c62ac3fbec31ddec70601d6c5b44d07063bcff6a823bdcf5e0bbaa9d3799d1db: Pulling from gcp-runtimes/go1-builder\ne154cec6816f: Pull complete \n&lt;pulls elided&gt;\nDigest: sha256:c62ac3fbec31ddec70601d6c5b44d07063bcff6a823bdcf5e0bbaa9d3799d1db\nStatus: Downloaded newer image for gcr.io/gcp-runtimes/go1-builder@sha256:c62ac3fbec31ddec70601d6c5b44d07063bcff6a823bdcf5e0bbaa9d3799d1db\n~$ \n</code></pre>\n\n<p>Perhaps an earlier version of the base <code>debian9</code> image had it installed, you could dig into history to look. But it looks like there is no recent change to the <code>go1-builder</code> image to remove gcc.</p>\n\n<p>If you need <code>gcc</code>, you can always separate building your app from deploying it. Build with your own <code>cloudbuild.yaml</code> via <code>gcloud container builds submit</code> and then deploy the built container using <code>gcloud app deploy --image-url=...</code> With full control over the build, you can always based on the <code>go-builder</code> image and install additional tooling you need like <code>gcc</code> on top of that before using Docker to build your final app container.</p>\n"}], "owner": {"reputation": 2516, "user_id": 2293705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b985837e65bbdfc841f890511abd859?s=128&d=identicon&r=PG", "display_name": "calcinai", "link": "https://stackoverflow.com/users/2293705/calcinai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5837, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1531756869, "creation_date": 1531707777, "last_edit_date": 1531714451, "question_id": 51353818, "link": "https://stackoverflow.com/questions/51353818/exec-gcc-executable-file-not-found-in-path", "title": "exec: &quot;gcc&quot;: executable file not found in $PATH", "body": "<p>I'm having an issue where an App Engine project will no longer build remotely (via <code>gcloud app deploy</code>)</p>\n\n<p>This has started out of the blue, with no code changes at this end.  Not sure if relevant, but it's a go 1.9 project deploying to the App Engine Flex environment.</p>\n\n<p>I'm not sure how to test this in the same environment as the build, since the error is coming from Google's Container Registry</p>\n\n<p>Here is the log from the Container Registry console</p>\n\n<pre><code>starting build \"73f85b4d-7370-41bd-bbb2-bcf42fc38873\" \n\nFETCHSOURCE \nFetching storage object: gs://staging.[project].appspot.com/us.gcr.io/[project]/appengine/default.1ed3c690ead06f27aa651a30fab342611:latest#1531698266413753 \nCopying gs://staging.[project].appspot.com/us.gcr.io/[project]/appengine/default.1ed3c690ead49f731806f27aa630fab342611:latest#1531698266413753... \nOperation completed over 1 objects/1.7 MiB.  \n\nBUILD \nStarting Step #0 \nStep #0: Pulling image: gcr.io/gcp-runtimes/go1-builder@sha256:c62ac3fbec31ddec70601d6c5b44d07063bcff6a823bdcf5e0bbaa9d3799d1db \nStep #0: sha256:c62ac3fbec31ddec70601d6c5b44d07063bcff6a823bdcf5e0bbaa9d3799d1db: Pulling from gcp-runtimes/go1-builder \nStep #0: Digest: sha256:c62ac3fbec31ddec70601d6c5b44d07063bcff6a823bdcf5e0bbaa9d3799d1db \nStep #0: Status: Downloaded newer image for gcr.io/gcp-runtimes/go1-builder@sha256:c62ac3fbec31ddec70601d6c5b44d07063bcff6a823bdcf5e0bbaa9d3799d1db \nStep #0: exec: \"gcc\": executable file not found in $PATH Finished \nStep #0 ERROR ERROR: build step 0 \"gcr.io/gcp-runtimes/go1-builder@sha256:c62ac3fbec31ddec70601d6c5b44d07063bcff6a823bdcf5e0bbaa9d3799d1db\" failed: exit status 2\n</code></pre>\n"}, {"tags": ["go", "reflection", "runtime"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6653958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c9c84d0991fccec20641719999a332?s=128&d=identicon&r=PG", "display_name": "lee", "link": "https://stackoverflow.com/users/6653958/lee"}, "edited": false, "score": 0, "creation_date": 1531715492, "post_id": 51354213, "comment_id": 89681627, "body": "how the get the single line in caller? or  so it is impossible to get the caller arguments string?"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "reply_to_user": {"reputation": 9, "user_id": 6653958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c9c84d0991fccec20641719999a332?s=128&d=identicon&r=PG", "display_name": "lee", "link": "https://stackoverflow.com/users/6653958/lee"}, "edited": false, "score": 0, "creation_date": 1531715580, "post_id": 51354213, "comment_id": 89681646, "body": "That piece of info is not build into the binary, so you cannot access it without the source file."}], "tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": false, "score": 0, "last_activity_date": 1531711865, "creation_date": 1531711865, "answer_id": 51354213, "question_id": 51353793, "link": "https://stackoverflow.com/questions/51353793/how-to-get-caller-arguments-string-in-golang-is-it-impossible/51354213#51354213", "title": "how to get caller arguments string in golang? is it impossible?", "body": "<p>The nearest thing you can get is the filename and line number where the function is being called, by querying <code>runtime.Caller</code>. <a href=\"https://golang.org/pkg/runtime/#Caller\" rel=\"nofollow noreferrer\">https://golang.org/pkg/runtime/#Caller</a></p>\n\n<pre><code>func Caller(skip int) (pc uintptr, file string, line int, ok bool)\n</code></pre>\n\n<blockquote>\n  <p>Caller reports file and line number information about function invocations on the calling goroutine's stack. The argument skip is the number of stack frames to ascend, with 0 identifying the caller of Caller. (For historical reasons the meaning of skip differs between Caller and Callers.) The return values report the program counter, file name, and line number within the file of the corresponding call. The boolean ok is false if it was not possible to recover the information. </p>\n</blockquote>\n\n<p>However, you need to have access to that file and be able to parse the file (or that single line) to get \"caller arguments string\".</p>\n"}], "owner": {"reputation": 9, "user_id": 6653958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c9c84d0991fccec20641719999a332?s=128&d=identicon&r=PG", "display_name": "lee", "link": "https://stackoverflow.com/users/6653958/lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531890358, "creation_date": 1531707479, "last_edit_date": 1531890358, "question_id": 51353793, "link": "https://stackoverflow.com/questions/51353793/how-to-get-caller-arguments-string-in-golang-is-it-impossible", "title": "how to get caller arguments string in golang? is it impossible?", "body": "<p>How can I return <code>user.Class.Name</code> string in reflectCallArgs. Is it impossible?</p>\n\n<pre><code>type User struct {\n    Class struct {\n        Name string\n    }\n}\nvar user = &amp;User{}\nreflectCallArgs := func(src interface{}) string {\n    //how to get this string?\n    return \"user.Class.Name\"\n}\nreflectCallArgs(user.Class.Name)\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1531703252, "post_id": 51353415, "comment_id": 89679424, "body": "They also have the fields in the wrong order when initializing <code>urls</code>, <code>&amp;U{&quot;example&quot;, &quot;http:&#47;&#47;www.example.com&quot;, nil}</code> should be <code>&amp;U{&quot;http:&#47;&#47;www.example.com&quot;, &quot;example&quot;, nil}</code> and so on."}, {"owner": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "edited": false, "score": 0, "creation_date": 1531709772, "post_id": 51353415, "comment_id": 89680543, "body": "fatal error: all goroutines are asleep - deadlock! <a href=\"https://play.golang.org/p/LLO6Rwuctr_i\" rel=\"nofollow noreferrer\">play.golang.org/p/LLO6Rwuctr_i</a>"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "edited": false, "score": 0, "creation_date": 1531710813, "post_id": 51353415, "comment_id": 89680714, "body": "@MarissaLevy you didn&#39;t include your function that reads from <code>ch</code>, so whichever <code>getResponse</code> hears back first sends blocking to <code>ch</code> and won&#39;t <code>Done</code> until something reads. However nothing is reading, and the main thread won&#39;t go on until it gets all its <code>Done</code>s, so we&#39;re hung."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "edited": false, "score": 0, "creation_date": 1531714116, "post_id": 51353415, "comment_id": 89681341, "body": "@MarissaLevy you&#39;re also ranging over the channel in <code>main</code> rather than the slice. Since nothing is sending to the channel anymore it hangs waiting for work. See <a href=\"https://repl.it/repls/ColorlessReadyPredictions\" rel=\"nofollow noreferrer\">this working example</a>"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "edited": false, "score": 0, "creation_date": 1531714170, "post_id": 51353415, "comment_id": 89681352, "body": "@MarissaLevy (This&#39;ll throw errors in the playground since it&#39;s making http calls)"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 3, "last_activity_date": 1531703006, "creation_date": 1531703006, "answer_id": 51353415, "question_id": 51353354, "link": "https://stackoverflow.com/questions/51353354/how-do-i-close-a-channel-and-wait-for-multiple-http-responses/51353415#51353415", "title": "How do I close a channel and wait for multiple http responses?", "body": "<p>You're not waiting for the responses to return. This is equivalent to:</p>\n\n<pre><code>urls := []*U{\n    &amp;U{\"example\", \"http://www.example.com\", nil},\n    &amp;U{\"yahoo\", \"http://www.yahoo.com\", nil},\n    &amp;U{\"google\", \"http://www.google.com\", nil},\n}\n\nfor i, u := range urls {\n    fmt.Println(i, u.resp) // all nil\n}\n</code></pre>\n\n<p>Instead you could use a <code>sync.WaitGroup</code> to make sure all the work is done before you display responses:</p>\n\n<pre><code>var wg sync.WaitGroup\n\nfor _, u := range urls {\n    wg.Add(1)  // Add job to the waitgroup\n    go func(u *U) {\n        var err error\n        u, err = getResponse(u)\n        if err != nil {\n            fmt.Println(err)\n        }\n        ch &lt;- u\n        wg.Done()  // Note when the job is done\n    }(u)\n}\n\nwg.Wait()  // wait until all the Add'd jobs are Done'd\nfor i, u := range urls {\n    fmt.Println(i, u.resp) // all nil\n}\n</code></pre>\n\n<p>Or you could handle printing responses in the same chain as <code>getResponse</code>:</p>\n\n<pre><code>for _, u := range urls {\n    go func(u *U) {\n        var err error\n        u, err = getResponse(u)\n        if err != nil {\n            fmt.Println(err)\n        }\n        printResponse(u)  // implement printResponse however\n        ch &lt;- u\n    }(u)\n}\n</code></pre>\n"}], "owner": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "accepted_answer_id": 51353415, "answer_count": 1, "score": 0, "last_activity_date": 1531703006, "creation_date": 1531702098, "question_id": 51353354, "link": "https://stackoverflow.com/questions/51353354/how-do-i-close-a-channel-and-wait-for-multiple-http-responses", "title": "How do I close a channel and wait for multiple http responses?", "body": "<p>I have the following and am trying to make some concurrent http calls so that I can speed up the entire program rather than doing each call 1 by one:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"time\"\n)\n\ntype U struct {\n    u    string\n    name string\n    resp *http.Response\n}\n\nfunc main() {\n    urls := []*U{\n        &amp;U{\"example\", \"http://www.example.com\", nil},\n        &amp;U{\"yahoo\", \"http://www.yahoo.com\", nil},\n        &amp;U{\"google\", \"http://www.google.com\", nil},\n    }\n\n    ch := make(chan *U)\n\n    // read from the channel\n    go func() {\n        for c := range ch {\n            for i, u := range urls {\n                if c.name == u.name {\n                    urls[i] = c\n                }\n            }\n        }\n    }()\n\n    // fetch the stuff\n    for _, u := range urls {\n        go func(u *U) {\n            var err error\n            u, err = getResponse(u)\n            if err != nil {\n                fmt.Println(err)\n            }\n            ch &lt;- u\n        }(u)\n    }\n\n    for i, u := range urls {\n        fmt.Println(i, u.resp) // all nil\n    }\n}\n\nfunc getResponse(u *U) (*U, error) {\n    c := &amp;http.Client{\n        Timeout: 10 * time.Second,\n    }\n\n    var err error\n    u.resp, err = c.Get(u.u)\n\n    return u, err\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Zko8xkEqDMB\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Zko8xkEqDMB</a></p>\n\n<p>I am ovbiously not doing something right as it prints</p>\n\n<pre><code>0 &lt;nil&gt;\n1 &lt;nil&gt;\n2 &lt;nil&gt;\n</code></pre>\n\n<p>whereas it should print the response as well. </p>\n\n<p>How do I make sure I wait until everything is done so that I can move forward? ok. thanks.</p>\n"}, {"tags": ["http", "oop", "go", "routing", "overriding"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1531695785, "post_id": 51352734, "comment_id": 89678241, "body": "In Go there is no inheritance, it&#39;s not your Classical OO language like Java is, and it should be of benefit to you to stop thinking in those terms when programming in Go. With that out of the way, what you can do with composition (Go&#39;s answer to inheritance), is something like this: <a href=\"https://play.golang.org/p/-_stPhpygW5\" rel=\"nofollow noreferrer\">play.golang.org/p/-_stPhpygW5</a>"}, {"owner": {"reputation": 574, "user_id": 7412495, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh5.googleusercontent.com/-rinrYIDw7LQ/AAAAAAAAAAI/AAAAAAAAAbc/py7wyd09gLs/photo.jpg?sz=128", "display_name": "Isaac Krementsov", "link": "https://stackoverflow.com/users/7412495/isaac-krementsov"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1531696548, "post_id": 51352734, "comment_id": 89678354, "body": "Right, but I don&#39;t want to write the ServeHTTP method for each new Handler."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1531696593, "post_id": 51352734, "comment_id": 89678360, "body": "Here&#39;s another approach: <a href=\"https://play.golang.org/p/U7v19vE8rt1\" rel=\"nofollow noreferrer\">play.golang.org/p/U7v19vE8rt1</a>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1531696629, "post_id": 51352734, "comment_id": 89678367, "body": "@IsaacKrementsov You shouldn&#39;t have to, you only need to wrap each new controller value into a Handler value."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1531696797, "post_id": 51352734, "comment_id": 89678397, "body": "@IsaacKrementsov In case you haven&#39;t noticed, Controller is an interface and can be substituted in the Handler struct by anything that implements all its methods. Index does, and so this <code>Handler{Index{}}</code> is valid, you can replace <code>Index{}</code>... with anything that implements the Controller interface."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1531696983, "post_id": 51352734, "comment_id": 89678419, "body": "@IsaacKrementsov E.g. <a href=\"https://play.golang.org/p/1-LEOjTo0AX\" rel=\"nofollow noreferrer\">play.golang.org/p/1-LEOjTo0AX</a>"}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531753541, "post_id": 51353922, "comment_id": 89702066, "body": "Methods will not be overridden at all. Overriding requires inheritance, which does not exist in Go."}, {"owner": {"reputation": 574, "user_id": 7412495, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh5.googleusercontent.com/-rinrYIDw7LQ/AAAAAAAAAAI/AAAAAAAAAbc/py7wyd09gLs/photo.jpg?sz=128", "display_name": "Isaac Krementsov", "link": "https://stackoverflow.com/users/7412495/isaac-krementsov"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531788343, "post_id": 51353922, "comment_id": 89715493, "body": "Right, but the methods of naController are basically being overriden by those of new controllers."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531788570, "post_id": 51353922, "comment_id": 89715525, "body": "They&#39;re really not being overridden though, and thinking of it that way will lead to serious confusion in certain scenarios (eg when a method calls another method on its receiver)."}], "tags": [], "owner": {"reputation": 574, "user_id": 7412495, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh5.googleusercontent.com/-rinrYIDw7LQ/AAAAAAAAAAI/AAAAAAAAAbc/py7wyd09gLs/photo.jpg?sz=128", "display_name": "Isaac Krementsov", "link": "https://stackoverflow.com/users/7412495/isaac-krementsov"}, "is_accepted": false, "score": 1, "last_activity_date": 1531725049, "last_edit_date": 1531725049, "creation_date": 1531708907, "answer_id": 51353922, "question_id": 51352734, "link": "https://stackoverflow.com/questions/51352734/how-to-override-composed-struct-methods-in-golang/51353922#51353922", "title": "How to override composed struct methods in GoLang", "body": "<p>Thank you to @mkopriva; here is the answer he put in the comments:\n<a href=\"https://play.golang.org/p/1-LEOjTo0AX\" rel=\"nofollow noreferrer\">https://play.golang.org/p/1-LEOjTo0AX</a></p>\n\n<p>Apparently methods will only be overriden with reverse composition.</p>\n"}], "owner": {"reputation": 574, "user_id": 7412495, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh5.googleusercontent.com/-rinrYIDw7LQ/AAAAAAAAAAI/AAAAAAAAAbc/py7wyd09gLs/photo.jpg?sz=128", "display_name": "Isaac Krementsov", "link": "https://stackoverflow.com/users/7412495/isaac-krementsov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531873966, "creation_date": 1531694422, "last_edit_date": 1531873966, "question_id": 51352734, "link": "https://stackoverflow.com/questions/51352734/how-to-override-composed-struct-methods-in-golang", "title": "How to override composed struct methods in GoLang", "body": "<p>I want to make a controller <code>struct</code> in GoLang that has a <code>ServeHTTP</code> method which calls its own methods (which responds with a <code>405</code> status code) based on that of the HTTP request. New controllers should be able to inherit <code>ServeHTTP</code> while also being able to override methods like <code>Get(w http.ResponseWriter, r *http.Request)</code> and have the new ones being triggered by <code>ServeHTTP</code>. Then, controllers can be assigned as route handlers with the http module. I know how to do this in Java (have a controller superclass with all basic methods), but the method overriding part fails in Go. Here is my code:</p>\n\n<pre><code>package main\n\nimport \"net/http\"\n\ntype Controller struct { }\n\nfunc notAllowed(w http.ResponseWriter){\n    w.WriteHeader(http.StatusMethodNotAllowed)\n    w.Write([]byte(\"405- Method Not Allowed\"))\n}\nfunc(c Controller)  Get(w http.ResponseWriter, r *http.Request){\n    notAllowed(w)\n}\nfunc(c Controller)  Post(w http.ResponseWriter, r *http.Request){\n    notAllowed(w)   \n}\nfunc(c Controller)  Put(w http.ResponseWriter, r *http.Request){\n    notAllowed(w)   \n}\nfunc(c Controller)  Patch(w http.ResponseWriter, r *http.Request){\n    notAllowed(w)   \n}\nfunc(c Controller)  Delete(w http.ResponseWriter, r *http.Request){\n    notAllowed(w)   \n}\nfunc(c Controller)  ServeHTTP(w http.ResponseWriter, r *http.Request){\n    switch r.Method {\n        case \"GET\":\n            c.Get(w, r)\n        case \"POST\":\n            c.Post(w, r)\n        case \"PUT\":\n            c.Put(w, r)\n        case \"PATCH\":\n            c.Patch(w, r)\n        case \"DELETE\":\n            c.Delete(w, r)\n    }\n}\ntype Index struct {\n  Controller  \n}\nfunc(I Index) Get(w http.ResponseWriter, r http.Request){\n  w.Write([]byte(\"hello\"))\n}\nfunc main(){\n  http.Handle(\"/\", Index{})\n  http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1531737121, "post_id": 51352346, "comment_id": 89691617, "body": "There is no such thing as nested values in application/x-www-form-urlencoded; that&#39;s why <a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\">Request.Form</a> is of type <code>map[string][]string</code>. The <code>menu[0][name]</code> stuff is an invention by PHP and you have to decode the form yourself if you want equivalent semantics. Or use an encoding that does support complex values, such as JSON."}], "answers": [{"comments": [{"owner": {"reputation": 28441, "user_id": 27305, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/174ac998689321daaa7cfecf910522e4?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/27305/john"}, "edited": false, "score": 0, "creation_date": 1531763518, "post_id": 51353252, "comment_id": 89707374, "body": "I ended up passing complex data structures as a JSON string that I later unmarshal"}], "tags": [], "owner": {"reputation": 1357, "user_id": 949284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f46e229e40589bd26994cc491747a6?s=128&d=identicon&r=PG", "display_name": "tul", "link": "https://stackoverflow.com/users/949284/tul"}, "is_accepted": true, "score": 2, "last_activity_date": 1531700732, "creation_date": 1531700732, "answer_id": 51353252, "question_id": 51352346, "link": "https://stackoverflow.com/questions/51352346/nested-values-of-form-vars-from-an-http-request-in-golang/51353252#51353252", "title": "nested values of form vars from an http request in golang", "body": "<p>It looks like go's <code>ParseForm</code> doesn't cater for the format you use to encode hierarchical structure. I think you're faced with either reading the body as raw, then parsing it yourself, or, if you have the option to change the post format, simply sending the body as JSON instead of a form.</p>\n"}], "owner": {"reputation": 28441, "user_id": 27305, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/174ac998689321daaa7cfecf910522e4?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/27305/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "accepted_answer_id": 51353252, "answer_count": 1, "score": 1, "last_activity_date": 1592843866, "creation_date": 1531689791, "last_edit_date": 1592843866, "question_id": 51352346, "link": "https://stackoverflow.com/questions/51352346/nested-values-of-form-vars-from-an-http-request-in-golang", "title": "nested values of form vars from an http request in golang", "body": "<p>I come from a PHP background and I'm trying to learn Go.</p>\n<p>In the past, I can run this command from bash:</p>\n<pre><code>curl -X POST http://192.168.12.107/restfulendpoint.php \\\n-H &quot;Content-Type: application/x-www-form-urlencoded&quot; \\\n-d \\\n&quot;menu[0][name]=pizza&amp;menu[0][price]=12.00&amp;menu[1][name]=orange juice&amp;menu[1][price]=1.00&quot;\n</code></pre>\n<p>My <code>restfulendpoint.php</code> will naturally receive a <code>POST</code> array that is structured in a nested format like so</p>\n<pre><code>Array\n(\n    [menu] =&gt; Array\n        (\n            [0] =&gt; Array\n                (\n                    [name] =&gt; pizza\n                    [price] =&gt; 12.00\n                )\n\n            [1] =&gt; Array\n                (\n                    [name] =&gt; orange juice\n                    [price] =&gt; 1.00\n                )\n\n        )\n\n)\n</code></pre>\n<p>I then created a go script that I hope would produce a similar behaviour.  I wrote this <code>restfulendpoint.go</code></p>\n<pre><code>func Post(w http.ResponseWriter, r *http.Request) {\n  url := mux.Vars(r)\n  r.ParseForm()\n  qs := r.Form\n  log.Println(qs)\n}\n</code></pre>\n<p>But when I receive the POST content, I get a structure like this:</p>\n<pre><code>map[menu[0][price]:[12.00] menu[1][name]:[orange juice] menu[1][price]:[1.00] menu[0][name]:[pizza]]\n</code></pre>\n<p>Go is treating each <code>map[&lt;int&gt;][price|name]</code> as a separate key in a map.   What I really want is an output like this:</p>\n<pre><code>map[menu:[map[name:pizza price:12.00] map[name:pizza price:12.00]]]\n</code></pre>\n<p>Is there a convention I should follow in my <code>curl</code> call to my <code>restfulendpoint.go</code> so that I can naturally receive the data in a schema were each menu item has a name and price property? Or is there something I should do in my go script to preserve the data schema?</p>\n"}, {"tags": ["go", "go-reflect"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 1, "creation_date": 1531679594, "post_id": 51350916, "comment_id": 89674692, "body": "Compiler do this"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1531681684, "post_id": 51350916, "comment_id": 89675277, "body": "Go does not maintain a directory of functions runtime.  What is the higher-level problem that you are trying to solve?"}, {"owner": {"reputation": 77, "user_id": 9738307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f05380da6300ef30e5e3206f712105?s=128&d=identicon&r=PG&f=1", "display_name": "pretty08", "link": "https://stackoverflow.com/users/9738307/pretty08"}, "edited": false, "score": 0, "creation_date": 1531682068, "post_id": 51350916, "comment_id": 89675369, "body": "Im trying to parse and flatten a json file, based on the type of flattening method passed as an argument to the main method, I need to check if the flatten method exists in my go package and then call it if it exists."}, {"owner": {"reputation": 77, "user_id": 9738307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f05380da6300ef30e5e3206f712105?s=128&d=identicon&r=PG&f=1", "display_name": "pretty08", "link": "https://stackoverflow.com/users/9738307/pretty08"}, "edited": false, "score": 0, "creation_date": 1531683061, "post_id": 51350916, "comment_id": 89675600, "body": "Im trying to parse and flatten a json file, based on the argument passed in my main method, I need to check if a function exists as of the argument passed, in my go package and then call it if it exists."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1531683580, "post_id": 51350916, "comment_id": 89675724, "body": "Typical approach is to specify the function using a function value (so there&#39;s no need to look it up, just call it) or to look up the function in an application maintained map.  It will help if you show the Go code you have attempted so far."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531753603, "post_id": 51350952, "comment_id": 89702107, "body": "But that requires access to the source code at runtime, which is not the usual case."}, {"owner": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531756670, "post_id": 51350952, "comment_id": 89703920, "body": "@Adrian True, but the same would need to be the case using Python. I am [probably incorrectly] assuming we have access to the source code and not just a compiled package."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1531758506, "post_id": 51350952, "comment_id": 89704886, "body": "That is always the case in python, it&#39;s an interpreted language. The source is what gets executed. That&#39;s not true of Go."}], "tags": [], "owner": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "is_accepted": false, "score": 1, "last_activity_date": 1531678627, "creation_date": 1531678627, "answer_id": 51350952, "question_id": 51350916, "link": "https://stackoverflow.com/questions/51350916/how-to-check-if-a-function-exists-in-go-file/51350952#51350952", "title": "How to check if a function exists in go file", "body": "<p>It looks like from <a href=\"https://stackoverflow.com/questions/41629293/how-do-i-list-the-public-methods-of-a-package-in-golang\">this</a> post that it is not directly possible.</p>\n\n<p>You could always create your own package to search package files and check if the method exists, as explained in the above <a href=\"https://stackoverflow.com/a/41630530/7253829\">post's first answer</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 17856, "user_id": 1439168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd72ad672b055a7d59cfb1c30d1c724f?s=128&d=identicon&r=PG", "display_name": "Miguel Mota", "link": "https://stackoverflow.com/users/1439168/miguel-mota"}, "is_accepted": false, "score": 1, "last_activity_date": 1531765583, "creation_date": 1531765583, "answer_id": 51368023, "question_id": 51350916, "link": "https://stackoverflow.com/questions/51350916/how-to-check-if-a-function-exists-in-go-file/51368023#51368023", "title": "How to check if a function exists in go file", "body": "<p>Based on your comments, it sounds like you may simply use a map the contains available functions. Here's a complete example:</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    var option string\n    var data string\n\n    flag.StringVar(&amp;option, \"option\", \"default\", \"The option to choose from\")\n    flag.StringVar(&amp;data, \"data\", \"\", \"The data to use\")\n\n    flag.Parse()\n\n    options := map[string]func(string) string{\n        \"foo\": func(data string) string {\n            fmt.Println(\"do something with data using option foo\")\n            return data\n        },\n        \"bar\": func(data string) string {\n            fmt.Println(\"do something with data using option bar\")\n            return data\n        },\n        \"default\": func(data string) string {\n            fmt.Println(\"do something with data using default option\")\n            return data\n        },\n    }\n\n    method, found := options[option]\n    if !found {\n        fmt.Println(\"option is not available\")\n        os.Exit(1)\n    }\n\n    result := method(data)\n    fmt.Println(result)\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>$ go run main.go -data hello -option foo\ndo something with data using option foo\nhello\n\n$ go run main.go -data hello -option whatever\noption is not available\n\n$ go run main.go -data hello\ndo something with data using default option\nhello\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 9738307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f05380da6300ef30e5e3206f712105?s=128&d=identicon&r=PG&f=1", "display_name": "pretty08", "link": "https://stackoverflow.com/users/9738307/pretty08"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 821, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1531765583, "creation_date": 1531678357, "last_edit_date": 1531678874, "question_id": 51350916, "link": "https://stackoverflow.com/questions/51350916/how-to-check-if-a-function-exists-in-go-file", "title": "How to check if a function exists in go file", "body": "<p>Is there an equivalent in golang to check if a function exists in a package/ go file like it is done in python.</p>\n\n<pre><code>mymethod in dir(package)\n</code></pre>\n"}, {"tags": ["string", "go", "int"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531674790, "post_id": 51350432, "comment_id": 89673429, "body": "Try <code>fmt.Println(block.Number().Uint64())</code>. It seems <code>block.Number</code> is a func that returns a <code>*big.Int</code> instead of <code>*big.Int</code> itself."}, {"owner": {"reputation": 2066, "user_id": 6363050, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f9db389fc3801b8ecef05ed3074e2f03?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Dare", "link": "https://stackoverflow.com/users/6363050/samuel-dare"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531674856, "post_id": 51350432, "comment_id": 89673445, "body": "Worked! Can you please add it with an explanation so I can accept it, and others can learn from it"}], "answers": [{"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": true, "score": 1, "last_activity_date": 1531675240, "creation_date": 1531675240, "answer_id": 51350504, "question_id": 51350432, "link": "https://stackoverflow.com/questions/51350432/type-casting-error/51350504#51350504", "title": "Type casting Error", "body": "<p>After getting the block by number through <code>client.BlockByNumber</code>, block is of type <code>Block</code> from <code>/github.com/ethereum/go-ethereum/core/types</code>.</p>\n\n<p><code>Number</code> of <code>Block</code> is a <a href=\"https://godoc.org/github.com/ethereum/go-ethereum/core/types#Block.Number\" rel=\"nofollow noreferrer\">method</a>, which returns a <code>*big.Int</code> instead of being a field of that type. So To retrieve the number, you should call the method, i.e, <code>block.Number()</code>.</p>\n"}], "owner": {"reputation": 2066, "user_id": 6363050, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f9db389fc3801b8ecef05ed3074e2f03?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Dare", "link": "https://stackoverflow.com/users/6363050/samuel-dare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 51350504, "answer_count": 1, "score": 0, "last_activity_date": 1531675240, "creation_date": 1531674485, "question_id": 51350432, "link": "https://stackoverflow.com/questions/51350432/type-casting-error", "title": "Type casting Error", "body": "<p>I am trying to follow the tutorial here : <a href=\"https://goethereumbook.org/block-query/\" rel=\"nofollow noreferrer\">https://goethereumbook.org/block-query/</a></p>\n\n<p>In his code , he calls the <code>header</code> and then hard codes it into <code>blockNumber</code>.</p>\n\n<pre><code> header, err := client.HeaderByNumber(context.Background(), nil)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(header.Number.String()) // 5671744\n\n    blockNumber := big.NewInt(5671744)\n</code></pre>\n\n<p>I have attempted to improve on this and converted the string to int64. </p>\n\n<pre><code>header, err := client.HeaderByNumber(context.Background(), nil)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(header.Number.String())\n\n    var stringBlockNumber = header.Number.String()\n\n    int64BlockNumber, err := strconv.ParseInt(stringBlockNumber, 10, 64)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    blockNumber := big.NewInt(int64BlockNumber)\n\n    block, err := client.BlockByNumber(context.Background(), blockNumber)\n    if err != nil {\n        log.Fatal(err)\n    }\n</code></pre>\n\n<p>This works until in try to add the following line: </p>\n\n<pre><code>fmt.Println(block.Number.Uint64())\n</code></pre>\n\n<p>I get the following error in the terminal :</p>\n\n<blockquote>\n  <p>./queryBlock.go:41:26: block.Number.Uint64 undefined (type func()\n  *big.Int has no field or method Uint64)</p>\n</blockquote>\n\n<p>I would appreciate any pointers on this. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 247, "user_id": 8310085, "user_type": "registered", "profile_image": "https://graph.facebook.com/1789907944358222/picture?type=large", "display_name": "Alex Erling", "link": "https://stackoverflow.com/users/8310085/alex-erling"}, "edited": false, "score": 0, "creation_date": 1531670260, "post_id": 51349830, "comment_id": 89672431, "body": "Thank! I need to be able to store a list of messages with a timestamp, and then be able to access the 100 most recent messages using another REST API call. Any suggestions?"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 247, "user_id": 8310085, "user_type": "registered", "profile_image": "https://graph.facebook.com/1789907944358222/picture?type=large", "display_name": "Alex Erling", "link": "https://stackoverflow.com/users/8310085/alex-erling"}, "edited": false, "score": 2, "creation_date": 1531670482, "post_id": 51349830, "comment_id": 89672484, "body": "@AlexErling The <i>right</i> solution is a database. Persist the messages in a database, then have your handler for the other API call query the database sorting by timestamp LIMIT 100"}, {"owner": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "edited": false, "score": 0, "creation_date": 1531673473, "post_id": 51349830, "comment_id": 89673168, "body": "A db is the way to go, the way the answer is written suggests otherwise is poi"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1531674958, "last_edit_date": 1531674958, "creation_date": 1531669208, "answer_id": 51349830, "question_id": 51349785, "link": "https://stackoverflow.com/questions/51349785/how-do-i-properly-post-a-message-to-a-simple-go-chatserver-using-rest-api/51349830#51349830", "title": "How do I properly post a message to a simple Go Chatserver using REST API", "body": "<p>Use a mutex to make the program threadsafe.</p>\n\n<pre><code>var Messages = []Message{}\nvar messageMu sync.Mutex\n\n...\n\nmessageMu.Lock()\nMessages = append(Messages, m)\nmessageMu.Unlock()\n</code></pre>\n\n<p>There's no need to use channels and goroutines to make the program threadsafe. </p>\n\n<p>A database is probably a better choice for storing messages than the in memory slice used in the question. Asking how to use a database to implement a chat program is too broad a question for SO.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 1854347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c818c59c72a0f78b55d5a83544a92c29?s=128&d=identicon&r=PG", "display_name": "teejays", "link": "https://stackoverflow.com/users/1854347/teejays"}, "is_accepted": true, "score": 2, "last_activity_date": 1531694541, "creation_date": 1531694541, "answer_id": 51352736, "question_id": 51349785, "link": "https://stackoverflow.com/questions/51349785/how-do-i-properly-post-a-message-to-a-simple-go-chatserver-using-rest-api/51352736#51352736", "title": "How do I properly post a message to a simple Go Chatserver using REST API", "body": "<p>It could be made thread safe using mutex, as @ThunderCat suggested but I think this does not add concurrency. If two or more requests are made simultaneously, one will have to wait for the other to complete first, slowing the server down. </p>\n\n<p><strong>Adding Concurrency</strong>: You make it faster and handle more concurrent request by using a queue (which is a Go channel) and a worker that listens on that channel - it'll be a simple implementation. Every time a message comes in through a Post request, you add to the queue (this is instantaneous and the HTTP response can be sent immediately). In another goroutine, you detect that a message has been added to the queue, you take it out append it to your Messages slice. While you're appending to Messages, the HTTP requests don't have to wait. </p>\n\n<p>Note: You can make it even better by having multiple goroutines listen on the queue, but we can leave that for later.</p>\n\n<p>This is how the code will somewhat look like:</p>\n\n<pre><code>type Message struct {\n    Text string\n    User string\n    Timestamp time.Time\n}\n\nvar Messages = []Message{}\n\n// messageQueue is the queue that holds new messages until they are processed\nvar messageQueue chan Message\n\nfunc init() { // need the init function to initialize the channel, and the listeners\n    // initialize the queue, choosing the buffer size as 8 (number of messages the channel can hold at once)\n    messageQueue = make(chan Message, 8) \n\n    // start a goroutine that listens on the queue/channel for new messages\n    go listenForMessages()\n}\n\nfunc listenForMessages() {\n    // whenever we detect a message in the queue, append it to Messages\n    for m := range messageQueue {\n        Messages = append(Messages, m)\n    }\n}\n\nfunc messagePost(c http.ResponseWriter, req *http.Request){\n    decoder := json.NewDecoder(req.Body)\n    var m Message\n    err := decoder.Decode(&amp;m)\n    if err != nil {\n        panic(err)\n    }\n    if m.Timestamp == (time.Time{}) {\n        m.Timestamp = time.Now()\n    }\n    addUser(m.User)\n\n    // add the message to the channel, it'll only wait if the channel is full\n    messageQueue &lt;- m \n}\n</code></pre>\n\n<p><strong>Storing Messages</strong>: As other users have suggested, storing messages in memory may not be the right choice since the messages won't persist if the application is restarted. If you're working on a small, proof-of-concept type project and don't want to figure out the DB, you could save the Messages variable as a flat file on the server and then read from it every time the application starts (*Note: this should not be done on a production system, of course, for that you should set up a Database). But yeah, database should be the way to go.</p>\n"}], "owner": {"reputation": 247, "user_id": 8310085, "user_type": "registered", "profile_image": "https://graph.facebook.com/1789907944358222/picture?type=large", "display_name": "Alex Erling", "link": "https://stackoverflow.com/users/8310085/alex-erling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 51352736, "answer_count": 2, "score": 3, "last_activity_date": 1531694541, "creation_date": 1531668722, "question_id": 51349785, "link": "https://stackoverflow.com/questions/51349785/how-do-i-properly-post-a-message-to-a-simple-go-chatserver-using-rest-api", "title": "How do I properly post a message to a simple Go Chatserver using REST API", "body": "<p>I am currently building a simple chat server that supports posting messages through a REST API.</p>\n\n<pre><code> example:\n ========\n\n ```\n curl -X POST -H \"Content-Type: application/json\" --data '{\"user\":\"alex\", \"text\":\"this is a message\"}' http://localhost:8081/message\n\n {\n   \"ok\": true\n }\n</code></pre>\n\n<p>Right now, I'm just currently storing the messages in an array of messages. I'm pretty sure this is an inefficient way. So is there a simple, better way to get and store the messages using goroutines and channels that will make it thread-safe.</p>\n\n<p>Here is what I currently have:</p>\n\n<pre><code>type Message struct {\n    Text string\n    User string\n    Timestamp time.Time\n}\n\nvar Messages = []Message{}\n\n\nfunc messagePost(c http.ResponseWriter, req *http.Request){\n    decoder := json.NewDecoder(req.Body)\n    var m Message\n    err := decoder.Decode(&amp;m)\n    if err != nil {\n        panic(err)\n    }\n    if m.Timestamp == (time.Time{}) {\n        m.Timestamp = time.Now()\n    }\n    addUser(m.User)\n    Messages = append(Messages, m)\n}\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1531666053, "post_id": 51349422, "comment_id": 89671457, "body": "The runtime and the reflect package do not provide a way to get a reflect.Type given the package and type names. Typical solution is for app to maintain map of name to reflect.Type.  Possible duplicate of <a href=\"https://stackoverflow.com/questions/23030884/is-there-a-way-to-create-an-instance-of-a-struct-from-a-string\" title=\"is there a way to create an instance of a struct from a string\">stackoverflow.com/questions/23030884/&hellip;</a>"}, {"owner": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1531666251, "post_id": 51349422, "comment_id": 89671503, "body": "I was hoping to accept the package name / type name as user input so maintaining a map would not be possible. Do you have any other ideas how to solve this problem, so do the types, build, and importer packages not provide anyway to make this possible?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1531666848, "post_id": 51349422, "comment_id": 89671653, "body": "It&#39;s not possible to get a reflect.Type from the go/types or related packages because the runtime does not have a registry of types.  Describe the higher-level problem you are trying to solve."}, {"owner": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1531670615, "post_id": 51349422, "comment_id": 89672511, "body": "I would like to accept a type from the user via a configuration file and then be able to instantiate that type."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1531670730, "post_id": 51349422, "comment_id": 89672548, "body": "@Max and how are you using the model that the type relies in? Do you import it in your code or do you use <code>plugin</code> or other loading techniques?"}, {"owner": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531671008, "post_id": 51349422, "comment_id": 89672626, "body": "@leafbebop right now I write a CLI that runs inside a Go environment, i.e. inside a <code>src</code> directory in the <code>GOPATH</code>. I&#39;m getting the type information from the <code>go&#47;importer</code> package using the type information supplied by the user. I don&#39;t directly import the type at compile time of the CLI"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531671409, "post_id": 51349422, "comment_id": 89672733, "body": "@Max You have three options to use a type of external packages: 1. import it at compile time 2. use <code>plugin</code> or other loading mechenism (requires to compile the other library in certain mood) 3. Interept that package and then use the interepted result. The 3rd option is extremely compllicated."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1531671643, "post_id": 51349422, "comment_id": 89672780, "body": "How are you planning to use that type? If it just stores data, 3rd option can be much simpler. If you are going to use its methods, and you are really willing to try 3rd option, you can dig into <a href=\"https://github.com/go-interpreter/wagon\" rel=\"nofollow noreferrer\">github.com/go-interpreter/wagon</a>."}, {"owner": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1531673783, "post_id": 51349422, "comment_id": 89673232, "body": "@leafbebop thanks for the info. I would like to call the methods as well as access the fields in the struct via reflection. I will look into those options. Do you have any information on the <code>plugin</code> loading mechanism?"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1531674280, "post_id": 51349422, "comment_id": 89673313, "body": "<a href=\"https://golang.org/pkg/plugin/\" rel=\"nofollow noreferrer\">Official approach</a> and <a href=\"https://github.com/dearplain/goloader\" rel=\"nofollow noreferrer\">third party loader</a>"}], "owner": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1531665589, "creation_date": 1531665589, "question_id": 51349422, "link": "https://stackoverflow.com/questions/51349422/convert-go-types-to-reflect-type", "title": "Convert go/types to reflect.Type?", "body": "<p>I am using the <a href=\"https://golang.org/pkg/go/importer/\" rel=\"nofollow noreferrer\">go/importer</a> package to get an instance of <a href=\"https://golang.org/pkg/go/types/#Struct\" rel=\"nofollow noreferrer\">go/types.Struct</a>:</p>\n\n<pre><code>pkg, _ := importer.Default().Import(\"some/package\")\nstructType := pkg.Scope().Lookup(\"StructName\").Type()\n</code></pre>\n\n<p>I would like to convert this type into a <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"nofollow noreferrer\">reflect.Type</a> so that I can instantiate a new instance. Is this possible to do? Is there a way to go from a package name / struct name into a new instance (assuming the code executes in a Go environment with source and GOPATH set properly)? </p>\n"}, {"tags": ["go", "naming-conventions", "variable-names", "mixed-case"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6216224"}, "edited": false, "score": 0, "creation_date": 1531650586, "post_id": 51347472, "comment_id": 89667622, "body": "Why is <code>fmt.Fprintf</code> than not named <code>fmt.FPrintF</code>?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1531651511, "post_id": 51347472, "comment_id": 89667794, "body": "@R3turnz: <code>fmt.Fprintf</code> is from the C language function name <code>fprintf</code>."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1531650468, "creation_date": 1531650468, "answer_id": 51347472, "question_id": 51347416, "link": "https://stackoverflow.com/questions/51347416/capitalization-after-upper-case-abbrevation-in-go-variable-name/51347472#51347472", "title": "Capitalization after upper-case abbrevation in Go variable name", "body": "<p>You have HTTP and Client so HTTPClient, and, for lower case, httpClient.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6216224"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 1, "accepted_answer_id": 51347472, "answer_count": 1, "score": 2, "last_activity_date": 1531650468, "creation_date": 1531649933, "question_id": 51347416, "link": "https://stackoverflow.com/questions/51347416/capitalization-after-upper-case-abbrevation-in-go-variable-name", "title": "Capitalization after upper-case abbrevation in Go variable name", "body": "<p>Should a struct field be named <code>HTTPClient</code> or <code>HTTPclient</code>?</p>\n"}, {"tags": ["datetime", "go", "timezone", "country-codes"], "comments": [{"owner": {"reputation": 105, "user_id": 3418135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb417d9d77a3abb70a1b3196f9de2e1?s=128&d=identicon&r=PG&f=1", "display_name": "user3418135", "link": "https://stackoverflow.com/users/3418135/user3418135"}, "reply_to_user": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1531645911, "post_id": 51346476, "comment_id": 89666585, "body": "@danicheeta no, I only want get timezone from country code, not get current timestamp from timezones."}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 3, "creation_date": 1531650412, "post_id": 51346476, "comment_id": 89667589, "body": "Russia has 8 time zones or so, which one would you expect to get by \u201cru\u201d code? USA has I think 3."}, {"owner": {"reputation": 105, "user_id": 3418135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb417d9d77a3abb70a1b3196f9de2e1?s=128&d=identicon&r=PG&f=1", "display_name": "user3418135", "link": "https://stackoverflow.com/users/3418135/user3418135"}, "reply_to_user": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 0, "creation_date": 1531651323, "post_id": 51346476, "comment_id": 89667763, "body": "@AlexanderTrakhimenok, I want get first timezone in that list."}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 2, "creation_date": 1531659477, "post_id": 51346476, "comment_id": 89669716, "body": "First means the one is getting sun earlier or a capital one, or the one that has the least deviation from other time zones from the same country? You better get capital of country and use it time zone."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1531668626, "post_id": 51346476, "comment_id": 89672082, "body": "USA has at least 5 geographic timezones. More if you count the oddball states that change DST at different times of the year, or not at all. And almost every country in the world has at least two, if you count DST (and you should for most purposes)."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1531676882, "post_id": 51346476, "comment_id": 89673939, "body": "@Flimzy: For this purpose, we do not count DST. Almost every country in the world does not have DST: <a href=\"https://en.wikipedia.org/wiki/Daylight_saving_time_by_country\" rel=\"nofollow noreferrer\">Daylight saving time by country - Wikipedia</a>. Most of the world&#39;s population doesn&#39;t have DST."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1531724978, "post_id": 51346476, "comment_id": 89684871, "body": "@peterSO: I should have said that most geographic time zones also use DST, which is true. Due to DST, and based on the map you referenced, DST nearly doubles the number of expected timezones (although in practice, it more than doubles that number, since not all political regions follow the same DST rules)."}, {"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1531812630, "post_id": 51346476, "comment_id": 89722647, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/27991671/how-to-get-the-current-timestamp-in-other-timezones-in-golang\">How to get the current timestamp in other timezones in Golang?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 3418135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb417d9d77a3abb70a1b3196f9de2e1?s=128&d=identicon&r=PG&f=1", "display_name": "user3418135", "link": "https://stackoverflow.com/users/3418135/user3418135"}, "edited": false, "score": 1, "creation_date": 1531649962, "post_id": 51347110, "comment_id": 89667482, "body": "hi @VonC, I only want get timezone from country code, not from timezone."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": -1, "last_activity_date": 1531647230, "creation_date": 1531647230, "answer_id": 51347110, "question_id": 51346476, "link": "https://stackoverflow.com/questions/51346476/how-to-get-timezone-from-country/51347110#51347110", "title": "How to get timezone from country", "body": "<p>The timezone is accessible from <a href=\"https://golang.org/pkg/time/#LoadLocation\" rel=\"nofollow noreferrer\">time.LoadLocation()</a>: <a href=\"https://play.golang.org/p/VuJ3ofkdk8\" rel=\"nofollow noreferrer\">example</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"log\"\n)\n\nfunc main() {\n    var ParisLocation, err = time.LoadLocation(\"Europe/Paris\")\n    if(err != nil) {\n        log.Fatal(err)\n    }\n\n    fmt.Println(ParisLocation)\n}\n</code></pre>\n\n<p>As seen in <a href=\"https://github.com/golang/go/issues/21881\" rel=\"nofollow noreferrer\">golang/go issue 21881</a>, it won't work on Windows because <code>$GOROOT/lib/time/zoneinfo.zip</code> is not included by default, hence the need for projects like <a href=\"https://4d63.com/tz/index.html\" rel=\"nofollow noreferrer\">4d63.com/tz</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1531665110, "post_id": 51349008, "comment_id": 89671205, "body": "That seems more complete than my own answer. +1"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 3, "last_activity_date": 1531684551, "last_edit_date": 1531684551, "creation_date": 1531662398, "answer_id": 51349008, "question_id": 51346476, "link": "https://stackoverflow.com/questions/51346476/how-to-get-timezone-from-country/51349008#51349008", "title": "How to get timezone from country", "body": "<p>The Go standard library does not have a function for this. Look for an open-source Go package that does this for you. Or, since this is Go, write a simple Go function yourself. You will have to download the IANA tzdata zone cross-reference file.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"path/filepath\"\n    \"strings\"\n    \"time\"\n)\n\n// Download IANA tzdata zone file:\n// $ wget https://raw.githubusercontent.com/eggert/tz/master/zone1970.tab -O zone1970.tab\n\n// countryZones returns a map of IANA Time Zone Database (tzdata) zone names\n// by ISO 3166 2-character country code: map[country][]zone.\nfunc countryZones(dir string) (map[string][]string, error) {\n    fname := filepath.Join(dir, `zone1970.tab`)\n    f, err := os.Open(fname)\n    if err != nil {\n        return nil, err\n    }\n    defer f.Close()\n\n    countries := make(map[string][]string)\n    s := bufio.NewScanner(f)\n    for s.Scan() {\n        line := s.Text()\n        if strings.HasPrefix(line, \"#\") {\n            continue\n        }\n        n := 3\n        fields := strings.SplitN(line, \"\\t\", n+1)\n        if len(fields) &lt; n {\n            continue\n        }\n        zone := fields[2]\n        for _, country := range strings.Split(fields[0], \",\") {\n            country = strings.ToUpper(country)\n            zones := countries[country]\n            zones = append(zones, zone)\n            countries[country] = zones\n        }\n    }\n    if err = s.Err(); err != nil {\n        return nil, err\n    }\n    return countries, nil\n}\n\nfunc main() {\n    zones, err := countryZones(\"\")\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        return\n    }\n\n    utc := time.Now().UTC()\n    for _, country := range []string{\"RU\", \"CA\"} {\n        fmt.Println(\"Country:\", country)\n        zones := zones[country]\n        fmt.Println(utc, \"UTC\")\n        for _, zone := range zones {\n            loc, err := time.LoadLocation(zone)\n            if err != nil {\n                fmt.Fprintln(os.Stderr, err)\n                continue\n            }\n            fmt.Println(utc.In(loc), zone)\n        }\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ wget https://raw.githubusercontent.com/eggert/tz/master/zone1970.tab -O zone1970.tab\n--2018-07-15 09:44:02--  https://raw.githubusercontent.com/eggert/tz/master/zone1970.tab\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.184.133\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.184.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 17810 (17K) [text/plain]\nSaving to: \u2018zone1970.tab\u2019\n\nzone1970.tab             100%[==================================&gt;]  17.39K  --.-KB/s    in 0.03s   \n\n2018-07-15 09:44:02 (582 KB/s) - \u2018zone1970.tab\u2019 saved [17810/17810]\n\n$ go run zones.go\nCountry: RU\n2018-07-15 17:40:03.09524872 +0000 UTC UTC\n2018-07-15 19:40:03.09524872 +0200 EET Europe/Kaliningrad\n2018-07-15 20:40:03.09524872 +0300 MSK Europe/Moscow\n2018-07-15 20:40:03.09524872 +0300 MSK Europe/Simferopol\n2018-07-15 20:40:03.09524872 +0300 +03 Europe/Volgograd\n2018-07-15 20:40:03.09524872 +0300 +03 Europe/Kirov\n2018-07-15 21:40:03.09524872 +0400 +04 Europe/Astrakhan\n2018-07-15 21:40:03.09524872 +0400 +04 Europe/Saratov\n2018-07-15 21:40:03.09524872 +0400 +04 Europe/Ulyanovsk\n2018-07-15 21:40:03.09524872 +0400 +04 Europe/Samara\n2018-07-15 22:40:03.09524872 +0500 +05 Asia/Yekaterinburg\n2018-07-15 23:40:03.09524872 +0600 +06 Asia/Omsk\n2018-07-16 00:40:03.09524872 +0700 +07 Asia/Novosibirsk\n2018-07-16 00:40:03.09524872 +0700 +07 Asia/Barnaul\n2018-07-16 00:40:03.09524872 +0700 +07 Asia/Tomsk\n2018-07-16 00:40:03.09524872 +0700 +07 Asia/Novokuznetsk\n2018-07-16 00:40:03.09524872 +0700 +07 Asia/Krasnoyarsk\n2018-07-16 01:40:03.09524872 +0800 +08 Asia/Irkutsk\n2018-07-16 02:40:03.09524872 +0900 +09 Asia/Chita\n2018-07-16 02:40:03.09524872 +0900 +09 Asia/Yakutsk\n2018-07-16 02:40:03.09524872 +0900 +09 Asia/Khandyga\n2018-07-16 03:40:03.09524872 +1000 +10 Asia/Vladivostok\n2018-07-16 03:40:03.09524872 +1000 +10 Asia/Ust-Nera\n2018-07-16 04:40:03.09524872 +1100 +11 Asia/Magadan\n2018-07-16 04:40:03.09524872 +1100 +11 Asia/Sakhalin\n2018-07-16 04:40:03.09524872 +1100 +11 Asia/Srednekolymsk\n2018-07-16 05:40:03.09524872 +1200 +12 Asia/Kamchatka\n2018-07-16 05:40:03.09524872 +1200 +12 Asia/Anadyr\nCountry: CA\n2018-07-15 17:40:03.09524872 +0000 UTC UTC\n2018-07-15 15:10:03.09524872 -0230 NDT America/St_Johns\n2018-07-15 14:40:03.09524872 -0300 ADT America/Halifax\n2018-07-15 14:40:03.09524872 -0300 ADT America/Glace_Bay\n2018-07-15 14:40:03.09524872 -0300 ADT America/Moncton\n2018-07-15 14:40:03.09524872 -0300 ADT America/Goose_Bay\n2018-07-15 13:40:03.09524872 -0400 AST America/Blanc-Sablon\n2018-07-15 13:40:03.09524872 -0400 EDT America/Toronto\n2018-07-15 13:40:03.09524872 -0400 EDT America/Nipigon\n2018-07-15 13:40:03.09524872 -0400 EDT America/Thunder_Bay\n2018-07-15 13:40:03.09524872 -0400 EDT America/Iqaluit\n2018-07-15 13:40:03.09524872 -0400 EDT America/Pangnirtung\n2018-07-15 12:40:03.09524872 -0500 EST America/Atikokan\n2018-07-15 12:40:03.09524872 -0500 CDT America/Winnipeg\n2018-07-15 12:40:03.09524872 -0500 CDT America/Rainy_River\n2018-07-15 12:40:03.09524872 -0500 CDT America/Resolute\n2018-07-15 12:40:03.09524872 -0500 CDT America/Rankin_Inlet\n2018-07-15 11:40:03.09524872 -0600 CST America/Regina\n2018-07-15 11:40:03.09524872 -0600 CST America/Swift_Current\n2018-07-15 11:40:03.09524872 -0600 MDT America/Edmonton\n2018-07-15 11:40:03.09524872 -0600 MDT America/Cambridge_Bay\n2018-07-15 11:40:03.09524872 -0600 MDT America/Yellowknife\n2018-07-15 11:40:03.09524872 -0600 MDT America/Inuvik\n2018-07-15 10:40:03.09524872 -0700 MST America/Creston\n2018-07-15 10:40:03.09524872 -0700 MST America/Dawson_Creek\n2018-07-15 10:40:03.09524872 -0700 MST America/Fort_Nelson\n2018-07-15 10:40:03.09524872 -0700 PDT America/Vancouver\n2018-07-15 10:40:03.09524872 -0700 PDT America/Whitehorse\n2018-07-15 10:40:03.09524872 -0700 PDT America/Dawson\n$ \n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 3418135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb417d9d77a3abb70a1b3196f9de2e1?s=128&d=identicon&r=PG&f=1", "display_name": "user3418135", "link": "https://stackoverflow.com/users/3418135/user3418135"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3094, "favorite_count": 2, "answer_count": 2, "score": -1, "last_activity_date": 1574154385, "creation_date": 1531641714, "last_edit_date": 1574154385, "question_id": 51346476, "link": "https://stackoverflow.com/questions/51346476/how-to-get-timezone-from-country", "title": "How to get timezone from country", "body": "<p>I am converting a function from PHP to Go.</p>\n\n<p>I want to get timezone from country code in Go. It is similar this function in PHP</p>\n\n<pre><code>public static array DateTimeZone::listIdentifiers ([ int $what = DateTimeZone::ALL [, string $country = NULL ]] )\n</code></pre>\n\n<p>Which function have similar feature in Go?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 151, "user_id": 9645296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70c61185ff4996696aa15a892776779e?s=128&d=identicon&r=PG", "display_name": "TomX01", "link": "https://stackoverflow.com/users/9645296/tomx01"}, "edited": false, "score": 0, "creation_date": 1531639395, "post_id": 51346167, "comment_id": 89665347, "body": "Im currentlu using. But I don&#39;t know is it correct: func EncodeUint16(d []byte) []uint16 { \treturn *(*[]uint16)(unsafe.Pointer(&amp;d)) }  func EncodeToByteSl(d []uint16) []byte { \treturn *(*[]byte)(unsafe.Pointer(&amp;d)) }"}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1531640124, "last_edit_date": 1592644375, "creation_date": 1531640124, "answer_id": 51346272, "question_id": 51346167, "link": "https://stackoverflow.com/questions/51346167/convert-byte-of-slice-without-copy/51346272#51346272", "title": "Convert byte of slice without copy", "body": "<p>Consider that <a href=\"https://twitter.com/beyang/status/502287884942991360?lang=en\" rel=\"nofollow noreferrer\">converting = copying</a>, except for two special cases: <code>m:=map[string]int{};m[string(bytes))</code> has no allocation, similarly with append.</p>\n<p><a href=\"https://stackoverflow.com/a/25409018/6309\">Using unsafe.Pointer</a> seems the current workaround (as its name suggests, &quot;unsafe&quot;)</p>\n<pre><code>u16 := *(*uint16)(unsafe.Pointer(&amp;byte_array[4]))\n</code></pre>\n<p>There is a <a href=\"https://github.com/golang/go/issues/19367\" rel=\"nofollow noreferrer\">proposal to use <code>unsafe.Slice</code> instead</a>.<br />\nThere is also the (rejected for now) <a href=\"https://github.com/golang/go/issues/13656#issuecomment-301829361\" rel=\"nofollow noreferrer\">proposal golang/go issue 13656</a></p>\n<blockquote>\n<p>The problem is having to write <code>(*[C]T)(unsafe.Pointer(v))[:n:n]</code>, for some C, T, v, and n.</p>\n<p>A simpler way to write that entire expression would be ideal.</p>\n<pre><code>var s []byte = C.AsSlice((*byte)(ptr), n)\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 151, "user_id": 9645296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70c61185ff4996696aa15a892776779e?s=128&d=identicon&r=PG", "display_name": "TomX01", "link": "https://stackoverflow.com/users/9645296/tomx01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 214, "favorite_count": 2, "closed_date": 1531665228, "answer_count": 1, "score": 0, "last_activity_date": 1531640475, "creation_date": 1531639060, "last_edit_date": 1531640475, "question_id": 51346167, "link": "https://stackoverflow.com/questions/51346167/convert-byte-of-slice-without-copy", "closed_reason": "Duplicate", "title": "Convert byte of slice without copy", "body": "<p>How to convert a slice of bytes to <code>[]uint16</code> and reverse without allocation new <code>uint16</code> slice. This question focused on performance and memory consumption</p>\n"}, {"tags": ["go", "process", "status"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1531637647, "post_id": 51345919, "comment_id": 89665014, "body": "The posted code does not compile. Perhaps you meant to use / instead of \\ in the string literals."}, {"owner": {"reputation": 172, "user_id": 1280240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZXCFe.jpg?s=128&g=1", "display_name": "Eddy Yuansheng Wu", "link": "https://stackoverflow.com/users/1280240/eddy-yuansheng-wu"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1531662717, "post_id": 51345919, "comment_id": 89670506, "body": "\\\\ actually, it&#39;s on Windows."}], "answers": [{"comments": [{"owner": {"reputation": 172, "user_id": 1280240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZXCFe.jpg?s=128&g=1", "display_name": "Eddy Yuansheng Wu", "link": "https://stackoverflow.com/users/1280240/eddy-yuansheng-wu"}, "edited": false, "score": 0, "creation_date": 1531709338, "post_id": 51345979, "comment_id": 89680473, "body": "Thanks, that is explanatory. If I understand correctly, ProcessState is populated only after the processs has Exited? Wouldn&#39;t Exited() evaluate to true all the time?                I have a Gin webserver app (<a href=\"https://github.com/wys35/GoAPIserver\" rel=\"nofollow noreferrer\">github.com/wys35/GoAPIserver</a>) that is listening on 8080 and thus would not return. What I intend to do is to make the process run as a service (<a href=\"https://github.com/kardianos/service/blob/master/example/runner/runner.go\" rel=\"nofollow noreferrer\">github.com/kardianos/service/blob/master/example/runner/&hellip;</a>), what is strange is on line 98, it evaluates to true even when I can see my exe running in task manager. Do you have idea about this?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 172, "user_id": 1280240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZXCFe.jpg?s=128&g=1", "display_name": "Eddy Yuansheng Wu", "link": "https://stackoverflow.com/users/1280240/eddy-yuansheng-wu"}, "edited": false, "score": 0, "creation_date": 1531716512, "post_id": 51345979, "comment_id": 89681883, "body": "On some operating systems, Exited() returns true only if the process exited normally.  Exited() returns false if the process was terminated by a signal and other condition. I cannot help with the Windows specific questions as I have not used Windows in many years."}, {"owner": {"reputation": 172, "user_id": 1280240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZXCFe.jpg?s=128&g=1", "display_name": "Eddy Yuansheng Wu", "link": "https://stackoverflow.com/users/1280240/eddy-yuansheng-wu"}, "edited": false, "score": 0, "creation_date": 1531717334, "post_id": 51345979, "comment_id": 89682092, "body": "Thanks all the same."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1531637567, "last_edit_date": 1531637567, "creation_date": 1531637261, "answer_id": 51345979, "question_id": 51345919, "link": "https://stackoverflow.com/questions/51345919/querying-processstate/51345979#51345979", "title": "Querying ProcessState", "body": "<p>The <a href=\"https://godoc.org/os/exec#Cmd.ProcessState\" rel=\"nofollow noreferrer\">documentation says</a>:</p>\n\n<blockquote>\n  <p>ProcessState contains information about an exited process available after a call to Wait or Run.</p>\n</blockquote>\n\n<p>The main goroutine accesses the ProcessState field before the field is set to a non-nil value by the call to Run() in the goroutine.  The call to Exited() panics as a result.</p>\n\n<p>A simple fix is to call Run() from the main goroutine.</p>\n"}], "owner": {"reputation": 172, "user_id": 1280240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZXCFe.jpg?s=128&g=1", "display_name": "Eddy Yuansheng Wu", "link": "https://stackoverflow.com/users/1280240/eddy-yuansheng-wu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 51345979, "answer_count": 1, "score": 1, "last_activity_date": 1531637567, "creation_date": 1531636577, "question_id": 51345919, "link": "https://stackoverflow.com/questions/51345919/querying-processstate", "title": "Querying ProcessState", "body": "<p>I have a simple program and runs an exe and checks the Exited value afterwards, but it is giving me an \"panic: runtime error: invalid memory address or nil pointer dereference\" error, any idea why?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n    \"time\"\n)\n\nfunc main() {\n    prog:= exec.Command(\"path\\to\\exe\")\n    prog.Dir = \"path\\to\"\n    go prog.Run()\n    fmt.Println(prog.ProcessState.Exited())\n    time.Sleep(500 * time.Second)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1531631182, "post_id": 51345394, "comment_id": 89663969, "body": "You need to close the connection whenever you don&#39;t need it anymore. In other languages there is a notion of destructors, in Go you must truck it yourself manually."}, {"owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1531631380, "post_id": 51345394, "comment_id": 89663987, "body": "@zerkms If I understand correctly, the <code>defer</code> give us guarantee that the connection will be closed. In this case we don&#39;t have such guarantee...."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1531632346, "post_id": 51345394, "comment_id": 89664146, "body": "<code>defer</code> is just a language construction that runs an arbitrary function after the current function returns. Everything else is the semantics you put yourself. As I already mentioned - you need to close it as soon as you don&#39;t need it anymore, and you must track it manually since the language does not provide any other tool for that."}, {"owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1531632565, "post_id": 51345394, "comment_id": 89664175, "body": "@zerkms, If I understand correctly I need to write <code>Close()</code> function for my struct and use <code>defer</code> with my struct variable, right ?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1531634214, "post_id": 51345394, "comment_id": 89664458, "body": "You use <code>defer</code> to run an arbitrary function. Do you have any appropriate place where you could have used <code>defer</code> for this particular problem?"}, {"owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1531634344, "post_id": 51345394, "comment_id": 89664478, "body": "I have created instance of my struct in the other function. And it will be fine to release all resources when this function returns."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1531634564, "post_id": 51345394, "comment_id": 89664523, "body": "&quot;And it will be fine to release all resources when this function returns.&quot; --- so do it."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1531634499, "creation_date": 1531634499, "answer_id": 51345702, "question_id": 51345394, "link": "https://stackoverflow.com/questions/51345394/when-and-how-to-close-resources-if-they-are-members-of-the-struct/51345702#51345702", "title": "When and how to close resources if they are members of the struct", "body": "<p>As you can see i <a href=\"https://github.com/streadway/amqp/blob/7039654952f68968b17922b8dd15a6c0e2b41b7d/integration_test.go#L989-L991\" rel=\"nofollow noreferrer\"><code>streadway/amqp/integration_test.go</code></a>, the function using a connexion is responsible for closing it:</p>\n\n<pre><code>if c := integrationConnection(t, \"txcommit\"); c != nil {\n    defer c.Close()\n    ...\n}\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>// Returns a connection to the AMQP if the AMQP_URL environment\n// variable is set and a connection can be established.\nfunc integrationConnection(t *testing.T, name string) *Connection {\n    conn, err := Dial(integrationURLFromEnv())\n    if err != nil {\n        t.Errorf(\"dial integration server: %s\", err)\n        return nil\n    }\n    return loggedConnection(t, conn, name)\n}\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>func loggedConnection(t *testing.T, conn *Connection, name string) *Connection {\n    if name != \"\" {\n        conn.conn = &amp;logIO{t, name, conn.conn}\n    }\n    return conn\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 2, "last_activity_date": 1531648878, "creation_date": 1531648878, "answer_id": 51347296, "question_id": 51345394, "link": "https://stackoverflow.com/questions/51345394/when-and-how-to-close-resources-if-they-are-members-of-the-struct/51347296#51347296", "title": "When and how to close resources if they are members of the struct", "body": "<pre><code>func (s *MyServer) Stop() {\n    //Some teardown\n   s.conn.Close()\n}\nfunc main(){\n    var s *MyServer\n    ...\n    s.Run()\n    defer s.Stop()\n    s.DoSomethingWithConnection()\n}\n</code></pre>\n"}], "owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 2, "accepted_answer_id": 51347296, "answer_count": 2, "score": 2, "last_activity_date": 1531648878, "creation_date": 1531630797, "question_id": 51345394, "link": "https://stackoverflow.com/questions/51345394/when-and-how-to-close-resources-if-they-are-members-of-the-struct", "title": "When and how to close resources if they are members of the struct", "body": "<p>Here is classical example of using defer:</p>\n\n<pre><code>conn, err = amqp.Dial(rabbitMqConnectionString)\nif err != nil {\n    panic(err)\n}\ndefer conn.Close()\n</code></pre>\n\n<p>In my case the connection is the member of struct and I am using this connnection in the different functions:</p>\n\n<pre><code>type MyServer {\n  conn *Connection\n}\n\nfunc (s *MyServer) Run() {\n  s.conn, err = amqp.Dial(rabbitMqConnectionString)\n  if err != nil {\n    panic(err)\n  }\n}\n\nfunc (s *MyServer) DoSomethingWithConnection() {\n  // ...do something with connection\n}\n</code></pre>\n\n<p>In this case I cannot use defer in the <code>Run()</code> method. But where and how do I need to close connection in this case ?</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3", "aws-sdk-go"], "comments": [{"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 1, "creation_date": 1531615071, "post_id": 51343729, "comment_id": 89662092, "body": "Go SDK is unfamiliar to me, but take a look at <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/s3/#GetObjectInput\" rel=\"nofollow noreferrer\"><code>GetObjectInput</code></a> for the <code>Range</code> parameter, which is a string specifying the byte range you want to fetch in a <code>GetObject</code> request.  The first 1024 bytes would be specified as <code>bytes=0-1023</code> or just <code>0-1023</code> (docs are unclear).  What you&#39;re doing with the download manager is downloading the entire file, in 64K chunks, 1 at a time."}], "owner": {"reputation": 314, "user_id": 4263135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94a1a85d7e1acf56563d75fafb301fd9?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Hayward", "link": "https://stackoverflow.com/users/4263135/mark-hayward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 335, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1531605797, "creation_date": 1531605797, "question_id": 51343729, "link": "https://stackoverflow.com/questions/51343729/can-i-get-the-first-x-bytes-from-aws-s3-using-go-sdk-2", "title": "Can I get the first X bytes from AWS S3 using Go SDK 2", "body": "<p>I would like to get the first X Bytes from a very large CSV file. I basically just want to get the first two rows so I get the column names and an example of the data in each. However, I know that this isn't going to be possible so I would like to just download enough bytes to reasonably have enough data to be able to look at the first two rows. I am therefore trying to download the first 64kB.</p>\n\n<p>I am trying to do this using the s3 manager ( <a href=\"https://github.com/aws/aws-sdk-go/blob/master/service/s3/s3manager/download.go\" rel=\"nofollow noreferrer\">https://github.com/aws/aws-sdk-go/blob/master/service/s3/s3manager/download.go</a> )</p>\n\n<p>I tried using something like :</p>\n\n<pre><code>downloader := s3manager.NewDownloaderWithClient(svc, func(d *s3manager.Downloader) {\n    d.PartSize = 1024 * 64\n    d.Concurrency = 1\n})\n</code></pre>\n\n<p>`\nThis hangs though. I'd imagine I am just telling it to download the file with a small part size and it stops there and never returns anything.</p>\n\n<p>Can anybody cleverer than me tell me how I can download just the first X bytes of an S3 file in go?\nThanks!</p>\n"}]