[{"tags": ["arrays", "math", "go", "matrix"], "answers": [{"tags": [], "owner": {"reputation": 22814, "user_id": 182660, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/75e48a7020624657e5da6033590030ee?s=128&d=identicon&r=PG", "display_name": "SergGr", "link": "https://stackoverflow.com/users/182660/serggr"}, "is_accepted": true, "score": 4, "last_activity_date": 1519858516, "last_edit_date": 1519858516, "creation_date": 1519858204, "answer_id": 49039971, "question_id": 49039897, "link": "https://stackoverflow.com/questions/49039897/matrix-dotproduct-with-diffrent-result-from-python/49039971#49039971", "title": "Matrix dotProduct with diffrent result from python", "body": "<p>Well, actually the results are pretty much the same. The thing that might confuse you is that formatting is different but still Python's <code>-1.01345901e-02</code> = <code>-0.0101345901</code> (see <a href=\"https://en.wikipedia.org/wiki/Scientific_notation\" rel=\"nofollow noreferrer\">Scientific notation</a> and particularly its E-notation\" section) which is pretty close to Go's <code>-0.010134590118173147</code> and just to make it clear let's align them</p>\n\n<pre><code>Python -1.01345901e-02\nGo   -0.010134590118173147\n</code></pre>\n\n<p>So if you have any problems in your code, they probably come from some other source than matrix multiplication.</p>\n"}], "owner": {"reputation": 1160, "user_id": 4794648, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/100002194205501/picture?type=large", "display_name": "Italo Jos&#233;", "link": "https://stackoverflow.com/users/4794648/italo-jos%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 49039971, "answer_count": 1, "score": 0, "last_activity_date": 1519858516, "creation_date": 1519857841, "last_edit_date": 1519858353, "question_id": 49039897, "link": "https://stackoverflow.com/questions/49039897/matrix-dotproduct-with-diffrent-result-from-python", "title": "Matrix dotProduct with diffrent result from python", "body": "<p>I'm studying the multi-layer perceptron algorithm and I'm translating python code to golang. </p>\n\n<p>I have 2 matrices. Let's call this matrix M1:</p>\n\n<pre><code>[[0 0 1 1]\n [0 1 0 1]]\n</code></pre>\n\n<p>Let's call this matrix M2:</p>\n\n<pre><code>[[ 0.00041597  0.02185088 -0.00362142]\n [-0.00057384 -0.02866677  0.00488404]\n [-0.00056316 -0.02705587  0.00410378]\n [ 0.00048268  0.01692128 -0.00262183]]\n</code></pre>\n\n<p>I'm implementing the dotProduct(M1,M2) in python and it gives me this result</p>\n\n<pre><code>[[ -8.04778516e-05  -1.01345901e-02   1.48194623e-03]\n [ -9.11603819e-05  -1.17454886e-02   2.26221011e-03]]\n</code></pre>\n\n<p>I'm doing it in golang with the same inputs matrix(M1,M2) \nbut the golang code returns this matrix: </p>\n\n<pre><code>[[-8.047785157755936e-05 -0.010134590118173147 0.0014819462317188985]\n [-9.116038191682538e-05 -0.011745488603430228 0.0022622101145935328]]\n</code></pre>\n\n<p>In python I'm using numpy's dot operation:</p>\n\n<pre><code>resultMatrix = M1.dot(M2)\n</code></pre>\n\n<p>In go, I'm using this <a href=\"https://github.com/oelmekki/matrix\" rel=\"nofollow noreferrer\">package</a> to work with matrix in go <br>\nThe problem here is because I calculate others dotProcut calculos with golang and it are all ok</p>\n\n<p>I make N tests with other values, i'm using this package(the same dotProduct method) in others parts of this my code and all has been ok</p>\n\n<p><a href=\"https://github.com/italojs/multilayer-perceptron/blob/7c61e626b03686fe70aed6a483d4b26bdb83e1bc/main.go#L128\" rel=\"nofollow noreferrer\">My Go code at line 128</a><br>\n<a href=\"https://github.com/italojs/multilayer-perceptron/blob/7c61e626b03686fe70aed6a483d4b26bdb83e1bc/mlp-xor.py#L61\" rel=\"nofollow noreferrer\">Tutorial Python code at line 61</a><br>\n<a href=\"https://github.com/oelmekki/matrix/blob/068382df9967c331988b86ec6c287fb8c85270b1/operations.go#L30\" rel=\"nofollow noreferrer\">Matrix golang package method</a> that implemets the golang dotProduct at line 30 <br></p>\n\n<p>The code in python is not mine, and because this, the code it's written in Portuguese, but my go code is written in English</p>\n\n<p>In python i know that's right because all the neural network works well, but in go I'm not sure</p>\n\n<p>i read the matrix go package method many times and dont get the \"bug code implementation\", some one know where I'm wrong?</p>\n"}, {"tags": ["go", "casting", "thread-safety", "singleton"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1519858027, "post_id": 49039707, "comment_id": 85085150, "body": "<code>cache is not a type</code> because its a return parameter of the function <code>...eton() (cache *Cache)...</code>, meaning in the scope of the <code>Singleton</code> function you don&#39;t have access to the type <code>cache</code> but to the variable <code>cache</code> of type <code>*Cache</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1519858160, "post_id": 49039707, "comment_id": 85085203, "body": "Another problem, your logic is wrong, if singleton is <i>not nil</i> you return it, if it <i>is nil</i> you attempt type assertion on it, which will panic because it&#39;s nil. The type assertion itself doesn&#39;t have to panic, but the .lock.. part certainly will if singleton is nil."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1519858410, "post_id": 49039707, "comment_id": 85085311, "body": "Tip: It&#39;s not recommended to work with pointers to interface types, unless you have some peculiar requirements which make the pointer necessary. i.e. I would change <code>Singleton() *Cache</code> to <code>Singleton() Cache</code>."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 7, "last_activity_date": 1519859209, "creation_date": 1519859209, "answer_id": 49040155, "question_id": 49039707, "link": "https://stackoverflow.com/questions/49039707/singleton-implementation-in-go/49040155#49040155", "title": "Singleton implementation in Go", "body": "<p>Use <a href=\"https://godoc.org/sync#Once\" rel=\"noreferrer\">sync.Once</a> to lazily initialize singleton values:</p>\n\n<pre><code>var (\n    singleton Cache\n    once      sync.Once\n)\n\nfunc Singleton() Cache {\n    once.Do(func() {\n        singleton = New(10000, WithTTL(10000*100))\n    })\n    return singleton\n}\n</code></pre>\n\n<p>If it's OK to initialize at program startup, then do that:</p>\n\n<pre><code>var singleton Cache = New(10000, WithTTL(10000*100))\n\nfunc Singleton() Cache {\n    return singleton\n}\n</code></pre>\n"}], "owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 760, "favorite_count": 0, "accepted_answer_id": 49040155, "answer_count": 1, "score": 1, "last_activity_date": 1519859209, "creation_date": 1519857046, "last_edit_date": 1519858002, "question_id": 49039707, "link": "https://stackoverflow.com/questions/49039707/singleton-implementation-in-go", "title": "Singleton implementation in Go", "body": "<p>I have a struct:</p>\n\n<pre><code>type cache struct {\n    cap     int\n    ttl     time.Duration\n    items   map[interface{}]*entry\n    heap    *ttlHeap\n    lock    sync.RWMutex\n    NoReset bool\n}\n</code></pre>\n\n<p>Interface implemented by it:</p>\n\n<pre><code>type Cache interface {\n    Set(key, value interface{}) bool\n    Get(key interface{}) (interface{}, bool)\n    Keys() []interface{}\n    Len() int\n    Cap() int\n    Purge()\n    Del(key interface{}) bool\n}\n</code></pre>\n\n<p>And function returning singleton:</p>\n\n<pre><code>func Singleton() (cache *Cache) {\n    if singleton != nil {\n        return &amp;singleton\n    }\n    //default\n    singleton.(cache).lock.Lock()\n    defer singleton.(cache).lock.Unlock()\n    c := New(10000, WithTTL(10000 * 100))\n    return &amp;c\n}\n</code></pre>\n\n<p>I am not sure which type should be my <code>singleton</code>:</p>\n\n<ol>\n<li><p>When <code>var singleton cache</code> I cannot check for nil</p></li>\n<li><p>If <code>var singleton Cache</code> I cannot cast to <code>singleton.(cache).lock.Lock()</code> O get error: <code>cache is not a type</code></p></li>\n</ol>\n\n<p>How to write goroutine-safe Singleton in Go in a correct way?</p>\n"}, {"tags": ["firebase", "go", "google-cloud-firestore"], "comments": [{"owner": {"reputation": 299, "user_id": 8703483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290da4be3d6762921c9b4501ea4f123c?s=128&d=identicon&r=PG&f=1", "display_name": "Stacking For Heap", "link": "https://stackoverflow.com/users/8703483/stacking-for-heap"}, "edited": false, "score": 0, "creation_date": 1519858040, "post_id": 49039661, "comment_id": 85085158, "body": "You should test against null (without quotation marks) if they are actually null in the database, not nil, as in .where(&quot;foo&quot;, &quot;==&quot;, null);"}, {"owner": {"reputation": 233128, "user_id": 807126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpNqK.jpg?s=128&g=1", "display_name": "Doug Stevenson", "link": "https://stackoverflow.com/users/807126/doug-stevenson"}, "edited": false, "score": 1, "creation_date": 1519858591, "post_id": 49039661, "comment_id": 85085405, "body": "I&#39;m not too familiar with go, but I would expect this to work, as it does similarly in other languages.  There might be a bug in the client library.  Please feel free to file a bug.  <a href=\"https://firebase.google.com/support/contact/bugs-features/\" rel=\"nofollow noreferrer\">firebase.google.com/support/contact/bugs-features</a>"}, {"owner": {"reputation": 16583, "user_id": 913867, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/hUicX.jpg?s=128&g=1", "display_name": "Daniele B", "link": "https://stackoverflow.com/users/913867/daniele-b"}, "reply_to_user": {"reputation": 233128, "user_id": 807126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpNqK.jpg?s=128&g=1", "display_name": "Doug Stevenson", "link": "https://stackoverflow.com/users/807126/doug-stevenson"}, "edited": false, "score": 0, "creation_date": 1519858856, "post_id": 49039661, "comment_id": 85085490, "body": "@DougStevenson thanks, I just filed a bug report"}, {"owner": {"reputation": 411025, "user_id": 209103, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/12d378e6a9788ab9c94bbafe242b82b4?s=128&d=identicon&r=PG", "display_name": "Frank van Puffelen", "link": "https://stackoverflow.com/users/209103/frank-van-puffelen"}, "edited": false, "score": 0, "creation_date": 1519860528, "post_id": 49039661, "comment_id": 85086028, "body": "Can you actually show a screenshot with a document where the field is <code>null</code>? I want to make sure the field is present-but-null, and not missing altogether."}, {"owner": {"reputation": 16583, "user_id": 913867, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/hUicX.jpg?s=128&g=1", "display_name": "Daniele B", "link": "https://stackoverflow.com/users/913867/daniele-b"}, "reply_to_user": {"reputation": 411025, "user_id": 209103, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/12d378e6a9788ab9c94bbafe242b82b4?s=128&d=identicon&r=PG", "display_name": "Frank van Puffelen", "link": "https://stackoverflow.com/users/209103/frank-van-puffelen"}, "edited": false, "score": 0, "creation_date": 1519905370, "post_id": 49039661, "comment_id": 85102522, "body": "@FrankvanPuffelen, how can you fetch with a query both missing and present-but-null ? Or in case they are two different queries, can you please provide both?"}, {"owner": {"reputation": 524, "user_id": 4218640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fc0bd3ea04b68a4f8b4e46873af5252?s=128&d=identicon&r=PG&f=1", "display_name": "ElectroBuddha", "link": "https://stackoverflow.com/users/4218640/electrobuddha"}, "edited": false, "score": 0, "creation_date": 1520163059, "post_id": 49039661, "comment_id": 85194841, "body": "Firestore doesn&#39;t support &#39;isNotEqual&#39; operator so you can&#39;t check for null value directly, but there is a workaround <a href=\"https://stackoverflow.com/a/48481812/4218640\">explained here</a>."}, {"owner": {"reputation": 16583, "user_id": 913867, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/hUicX.jpg?s=128&g=1", "display_name": "Daniele B", "link": "https://stackoverflow.com/users/913867/daniele-b"}, "reply_to_user": {"reputation": 524, "user_id": 4218640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fc0bd3ea04b68a4f8b4e46873af5252?s=128&d=identicon&r=PG&f=1", "display_name": "ElectroBuddha", "link": "https://stackoverflow.com/users/4218640/electrobuddha"}, "edited": false, "score": 0, "creation_date": 1520254547, "post_id": 49039661, "comment_id": 85226990, "body": "@ElectroBuddha that workaround is to detect &quot;not null&quot;, by operating on a String domain. Unfortunately it doesn&#39;t solve the problem of detecting &quot;null&quot;"}, {"owner": {"reputation": 524, "user_id": 4218640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fc0bd3ea04b68a4f8b4e46873af5252?s=128&d=identicon&r=PG&f=1", "display_name": "ElectroBuddha", "link": "https://stackoverflow.com/users/4218640/electrobuddha"}, "edited": false, "score": 0, "creation_date": 1520322741, "post_id": 49039661, "comment_id": 85256304, "body": "@DanieleB In that case check <a href=\"https://stackoverflow.com/a/46813032/4218640\">this answer</a>. I&#39;m not sure for Go language, but in Swift it also doesn&#39;t work when using <code>nil</code> value in &#39;where&#39; statement, but it works if you instead use instance of null object <code>NSNull()</code>. Could you check if there is an equivalent representation of null object in Go lang?"}, {"owner": {"reputation": 16583, "user_id": 913867, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/hUicX.jpg?s=128&g=1", "display_name": "Daniele B", "link": "https://stackoverflow.com/users/913867/daniele-b"}, "reply_to_user": {"reputation": 411025, "user_id": 209103, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/12d378e6a9788ab9c94bbafe242b82b4?s=128&d=identicon&r=PG", "display_name": "Frank van Puffelen", "link": "https://stackoverflow.com/users/209103/frank-van-puffelen"}, "edited": false, "score": 0, "creation_date": 1520341543, "post_id": 49039661, "comment_id": 85267692, "body": "@FrankvanPuffelen is there a NSNull() equivalent for Go?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9459301, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qYwNnQCpolU/AAAAAAAAAAI/AAAAAAAAAD4/kyzm7nuTfhY/photo.jpg?sz=128", "display_name": "Jonathan Amsterdam", "link": "https://stackoverflow.com/users/9459301/jonathan-amsterdam"}, "is_accepted": false, "score": 1, "last_activity_date": 1520462206, "creation_date": 1520462206, "answer_id": 49162371, "question_id": 49039661, "link": "https://stackoverflow.com/questions/49039661/firestore-how-to-make-query-where-field-is-null/49162371#49162371", "title": "Firestore: how to make query where field is null", "body": "<p>Currently a bug in the Go client. Track at <a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go/issues/922\" rel=\"nofollow noreferrer\">https://github.com/GoogleCloudPlatform/google-cloud-go/issues/922</a>.</p>\n"}], "owner": {"reputation": 16583, "user_id": 913867, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/hUicX.jpg?s=128&g=1", "display_name": "Daniele B", "link": "https://stackoverflow.com/users/913867/daniele-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3124, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1520462206, "creation_date": 1519856774, "question_id": 49039661, "link": "https://stackoverflow.com/questions/49039661/firestore-how-to-make-query-where-field-is-null", "title": "Firestore: how to make query where field is null", "body": "<p>In my collection I have several documents where the \"token\" field is null.</p>\n\n<p><code>query := client.Collection(\"records\").Where(\"token\", \"==\", nil)</code></p>\n\n<p>In Go, the query above returns zero documents.</p>\n\n<p>What is the correct query to fetch all documents where the \"token\" field is null or missing?</p>\n"}, {"tags": ["go", "garbage-collection"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1519848943, "post_id": 49037784, "comment_id": 85080719, "body": "The gctrace output should show you when and why the GC is running. Is the number of goroutines increasing? This also looks like there could be a resource leak of some sort."}, {"owner": {"reputation": 1006, "user_id": 1840304, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2a5492335264f0d38608fcce610bec65?s=128&d=identicon&r=PG", "display_name": "Sathya", "link": "https://stackoverflow.com/users/1840304/sathya"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1519849710, "post_id": 49037784, "comment_id": 85081127, "body": "we track number of go routines, and that is not increasing."}], "answers": [{"tags": [], "owner": {"reputation": 990, "user_id": 2681335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa5c2b4a388746403da36ebc31acdda5?s=128&d=identicon&r=PG", "display_name": "menghan", "link": "https://stackoverflow.com/users/2681335/menghan"}, "is_accepted": false, "score": 0, "last_activity_date": 1539945376, "creation_date": 1539945376, "answer_id": 52890669, "question_id": 49037784, "link": "https://stackoverflow.com/questions/49037784/go-gc-strange-behavior/52890669#52890669", "title": "Go GC strange behavior", "body": "<p>Never guess bad performance reasons before profiling.  Here are instruments <a href=\"https://golang.org/doc/diagnostics.html#profiling\" rel=\"nofollow noreferrer\">https://golang.org/doc/diagnostics.html#profiling</a></p>\n"}], "owner": {"reputation": 1006, "user_id": 1840304, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2a5492335264f0d38608fcce610bec65?s=128&d=identicon&r=PG", "display_name": "Sathya", "link": "https://stackoverflow.com/users/1840304/sathya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1539945376, "creation_date": 1519848766, "question_id": 49037784, "link": "https://stackoverflow.com/questions/49037784/go-gc-strange-behavior", "title": "Go GC strange behavior", "body": "<p>We have several services written in Go. After running for several weeks we find that occasionally the heap size keeps increasing.  We added some instrumentation to find out that this is due to a reduction is GC frequency. </p>\n\n<p>We are using Go 1.8. I am not sure if this is a bug in Go GC or something that we have written is triggering this behavior. Any pointers, tips would be helpful.</p>\n\n<p><a href=\"https://i.stack.imgur.com/kUePU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kUePU.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/GKAjY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GKAjY.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-dynamodb"], "comments": [{"owner": {"reputation": 2059, "user_id": 2107667, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4CDmh.png?s=128&g=1", "display_name": "Costin", "link": "https://stackoverflow.com/users/2107667/costin"}, "edited": false, "score": 0, "creation_date": 1519862477, "post_id": 49036888, "comment_id": 85086592, "body": "What are the keys of your DynamoDB table? The Partition Key is mandatory in your item and it is case-sensitive."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8497169"}, "reply_to_user": {"reputation": 2059, "user_id": 2107667, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4CDmh.png?s=128&g=1", "display_name": "Costin", "link": "https://stackoverflow.com/users/2107667/costin"}, "edited": false, "score": 0, "creation_date": 1519863807, "post_id": 49036888, "comment_id": 85086921, "body": "@Costin I have only two keys: id and url."}, {"owner": {"reputation": 2059, "user_id": 2107667, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4CDmh.png?s=128&g=1", "display_name": "Costin", "link": "https://stackoverflow.com/users/2107667/costin"}, "edited": false, "score": 0, "creation_date": 1519864128, "post_id": 49036888, "comment_id": 85086993, "body": "So use <code>id</code> instead of <code>ID</code> everywhere. Should you use <code>URLs</code> as a sorting key, call it <code>url</code> and change it&#39;s type, if I remember well it can only be <code>String</code>, <code>Number</code> or <code>Binary</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8497169"}, "reply_to_user": {"reputation": 2059, "user_id": 2107667, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4CDmh.png?s=128&g=1", "display_name": "Costin", "link": "https://stackoverflow.com/users/2107667/costin"}, "edited": false, "score": 0, "creation_date": 1519864255, "post_id": 49036888, "comment_id": 85087020, "body": "I made the updates, and I still see: panic: ValidationException: One or more parameter values were invalid: Missing the key id in the item. Maybe this is happening because I&#39;m using the aws-sdk-go-v2?"}, {"owner": {"reputation": 2059, "user_id": 2107667, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4CDmh.png?s=128&g=1", "display_name": "Costin", "link": "https://stackoverflow.com/users/2107667/costin"}, "edited": false, "score": 0, "creation_date": 1519864279, "post_id": 49036888, "comment_id": 85087026, "body": "Can you print the <code>item</code> that is sent, the one generated here: <code>item, err := dynamodbattribute.MarshalMap(r)</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8497169"}, "reply_to_user": {"reputation": 2059, "user_id": 2107667, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4CDmh.png?s=128&g=1", "display_name": "Costin", "link": "https://stackoverflow.com/users/2107667/costin"}, "edited": false, "score": 0, "creation_date": 1519864404, "post_id": 49036888, "comment_id": 85087051, "body": "Yes! It&#39;s printing <code>map[]</code>. Weird, hm.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8497169"}, "reply_to_user": {"reputation": 2059, "user_id": 2107667, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4CDmh.png?s=128&g=1", "display_name": "Costin", "link": "https://stackoverflow.com/users/2107667/costin"}, "edited": false, "score": 0, "creation_date": 1519864777, "post_id": 49036888, "comment_id": 85087140, "body": "If I use uppercase attributes in my struct, it works the MarshalMap: <code>map[ID:{   S: &quot;ABC123&quot; } URLs:{   L: [{       S: &quot;https:&#47;&#47;example.com&#47;first&#47;link&quot;     },{       S: &quot;https:&#47;&#47;example.com&#47;second&#47;url&quot;     }] }]</code>"}, {"owner": {"reputation": 2059, "user_id": 2107667, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4CDmh.png?s=128&g=1", "display_name": "Costin", "link": "https://stackoverflow.com/users/2107667/costin"}, "edited": false, "score": 0, "creation_date": 1519864910, "post_id": 49036888, "comment_id": 85087191, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/166007/discussion-between-costin-and-driele-reis\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1310, "user_id": 1424867, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/QUWQu.jpg?s=128&g=1", "display_name": "Oswaldo Ferreira", "link": "https://stackoverflow.com/users/1424867/oswaldo-ferreira"}, "edited": false, "score": 0, "creation_date": 1605650151, "post_id": 49040941, "comment_id": 114715438, "body": "Well well, I guess there should be a note about this at <a href=\"https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/dynamo-example-create-table-item.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/sdk-for-go/v1/developer-guide/&hellip;</a>. It&#39;s fairly misleading once DynamoDB expects a pattern that&#39;s a &quot;private&quot; to golang&#39;s struct."}], "tags": [], "owner": {"reputation": 2059, "user_id": 2107667, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4CDmh.png?s=128&g=1", "display_name": "Costin", "link": "https://stackoverflow.com/users/2107667/costin"}, "is_accepted": true, "score": 5, "last_activity_date": 1519866077, "last_edit_date": 1519866077, "creation_date": 1519864869, "answer_id": 49040941, "question_id": 49036888, "link": "https://stackoverflow.com/questions/49036888/create-item-in-dynamodb-using-go/49040941#49040941", "title": "Create item in dynamodb using go", "body": "<p>I do not know <code>golang</code>, but I had similar problems in <code>nodejs</code>.</p>\n\n<p>Make sure the <code>item</code> you put in the table contains the 'partition key' and the <code>sorting key</code>, case-sensitive.</p>\n\n<p>EDIT: </p>\n\n<p>\u2022 It is a <code>golang</code> issue, the <code>item</code> is not built properly when the DynamoDB column names are lowercase. </p>\n\n<p>\u2022 Consider redefining the <code>Record</code> structure (see <a href=\"https://stackoverflow.com/questions/21825322/why-golang-cannot-generate-json-from-struct-with-front-lowercase-character\">this link</a> for details):</p>\n\n<pre><code>type Record struct{\n    ID     string `json:\"id\"`\n    URLs   []string `json:\"url\"`\n}\n</code></pre>\n\n<p>where <code>id</code> and <code>url</code> are column names in DynamoDB table.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8497169"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2454, "favorite_count": 0, "accepted_answer_id": 49040941, "answer_count": 1, "score": 3, "last_activity_date": 1519866077, "creation_date": 1519845038, "last_edit_date": 1519845977, "question_id": 49036888, "link": "https://stackoverflow.com/questions/49036888/create-item-in-dynamodb-using-go", "title": "Create item in dynamodb using go", "body": "<p>I'm using the follow code to create a item in my dynamodb table:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/aws/aws-sdk-go-v2/aws\"\n    \"github.com/aws/aws-sdk-go-v2/aws/endpoints\"\n    \"github.com/aws/aws-sdk-go-v2/aws/external\"\n    \"github.com/aws/aws-sdk-go-v2/service/dynamodb\"\n    \"github.com/aws/aws-sdk-go-v2/service/dynamodb/dynamodbattribute\"\n)\n\ntype Record struct {\n    ID     string\n    URLs   []string\n}\n\n\n// Using the SDK's default configuration, loading additional config\n// and credentials values from the environment variables, shared\n// credentials, and shared configuration files\nvar cfg, err = external.LoadDefaultAWSConfig()\n\nfunc createNewExtraction() error {\n    svc := dynamodb.New(cfg)\n\n    r := Record{\n        ID:   \"ABC123\",\n        URLs: []string{\n            \"https://example.com/first/link\",\n            \"https://example.com/second/url\",\n        },\n    }\n    item, err := dynamodbattribute.MarshalMap(r)\n    if err != nil {\n        panic(fmt.Sprintf(\"failed to DynamoDB marshal Record, %v\", err))\n    }\n\n    req := svc.PutItemRequest(&amp;dynamodb.PutItemInput{\n        TableName: aws.String(\"test\"), Item: item })\n\n    _, err = req.Send(); if err != nil {\n        return err\n    }\n    return nil\n}\n\nfunc main() {\n    if len(cfg.Region) &gt; 0 {\n        // Set Region to us-east-1 as default.\n        cfg.Region = endpoints.UsEast1RegionID\n    }\n\n    err = createNewExtraction(); if err != nil {\n        panic(err.Error())\n    }\n}\n</code></pre>\n\n<p>But it's returning the error:</p>\n\n<pre><code>panic: ValidationException: One or more parameter values were invalid: Missing the key id in the item\n    status code: 400, request id: F3VCQSGRIG5GM5PEJE7T5M4CEVVV4KQNSO5AEMVJF66Q9ASUAAJG\n\ngoroutine 1 [running]:\nmain.main()\n    /Users/user/go/src/Test2/test.go:56 +0x102\nexit status 2\n</code></pre>\n\n<p>I already tried to declare Id, id and ID in my Record struct, but it doesn't work.</p>\n\n<p>The stranger is: I got this code in the official documentation (I'm updating to work with the aws-sdk-go-v2).</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["go", "mux"], "answers": [{"comments": [{"owner": {"reputation": 2656, "user_id": 1733043, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d663194dc8a3e9f9fb127f66cfc9a068?s=128&d=identicon&r=PG", "display_name": "ArunKolhapur", "link": "https://stackoverflow.com/users/1733043/arunkolhapur"}, "edited": false, "score": 0, "creation_date": 1519843061, "post_id": 49036333, "comment_id": 85077662, "body": "Whoops!! Very silly mistake. As you pointed out, it needs to be <code>*http.Request</code>. So they say, sometimes it is better-off not using code hinting :). Thanks a lot."}, {"owner": {"reputation": 2656, "user_id": 1733043, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d663194dc8a3e9f9fb127f66cfc9a068?s=128&d=identicon&r=PG", "display_name": "ArunKolhapur", "link": "https://stackoverflow.com/users/1733043/arunkolhapur"}, "edited": false, "score": 0, "creation_date": 1519843422, "post_id": 49036333, "comment_id": 85077820, "body": "And, Thank you for such a quick response."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 2656, "user_id": 1733043, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d663194dc8a3e9f9fb127f66cfc9a068?s=128&d=identicon&r=PG", "display_name": "ArunKolhapur", "link": "https://stackoverflow.com/users/1733043/arunkolhapur"}, "edited": false, "score": 1, "creation_date": 1519843646, "post_id": 49036333, "comment_id": 85077911, "body": "Actually <code>HandleFunc</code> type of functions always have inbuilt <code>handlers</code> which you can create using ServeHttp too"}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 3, "last_activity_date": 1519842923, "creation_date": 1519842923, "answer_id": 49036333, "question_id": 49036269, "link": "https://stackoverflow.com/questions/49036269/golang-mux-router-handler-function-arguments/49036333#49036333", "title": "Golang mux router handler function arguments", "body": "<p>HanldeFunc type of function takes two paramters you are passing it wrong. </p>\n\n<pre><code>// Get all books\nfunc getBooks(w http.ResponseWriter, r *http.Response) {\n\n}\n</code></pre>\n\n<p>It should be <code>*http.Request</code> not <code>*http.Response</code></p>\n\n<pre><code>// Get all books\nfunc getBooks(w http.ResponseWriter, r *http.Request) {\n\n}\n</code></pre>\n\n<p>Checkout on <a href=\"https://play.golang.org/p/dLZqICbjC54\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}], "owner": {"reputation": 2656, "user_id": 1733043, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d663194dc8a3e9f9fb127f66cfc9a068?s=128&d=identicon&r=PG", "display_name": "ArunKolhapur", "link": "https://stackoverflow.com/users/1733043/arunkolhapur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1069, "favorite_count": 0, "accepted_answer_id": 49036333, "answer_count": 1, "score": 0, "last_activity_date": 1519847267, "creation_date": 1519842652, "last_edit_date": 1519847267, "question_id": 49036269, "link": "https://stackoverflow.com/questions/49036269/golang-mux-router-handler-function-arguments", "title": "Golang mux router handler function arguments", "body": "<p>I was trying to set up a CRUD http API using gorilla-mux library.</p>\n\n<p>I followed a youtube tutorial \nImplementation is below: - \n</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/gorilla/mux\"\n    \"net/http\"\n    \"log\"\n)\n\ntype Book struct {\n    Id     string  `json:\"id\"`\n    Isbn   string  `json:\"isbn\"`\n    Title  string  `json:\"title\"`\n    Author *Author `json:\"author\"`\n}\n\ntype Author struct {\n    Firstname string `json:\"firstname\"`\n    Lastname  string `json:\"lastname\"`\n}\n\n// Get all books\nfunc getBooks(w http.ResponseWriter, r *http.Response) {\n\n}\n\n// Get single book\nfunc getBook(w http.ResponseWriter, r *http.Response) {\n\n}\n\n// Create a book\nfunc createBook(w http.ResponseWriter, r *http.Response) {\n\n}\n\n// Update a book\nfunc updateBook(w http.ResponseWriter, r *http.Response) {\n\n}\n\n// Delete a book\nfunc deleteBook(w http.ResponseWriter, r *http.Response) {\n\n}\n\nfunc main() {\n    r := mux.NewRouter()\n\n    r.HandleFunc(\"/api/books\", getBooks).Methods(\"GET\")\n    r.HandleFunc(\"/api/book/{id}\", getBook).Methods(\"GET\")\n    r.HandleFunc(\"/api/book\", createBook).Methods(\"POST\")\n    r.HandleFunc(\"/api/book/{id}\", updateBook).Methods(\"PUT\")\n    r.HandleFunc(\"/api/book/{id}\", deleteBook).Methods(\"DELETE\")\n\n    r.Path(\"/api/books\").Methods(\"GET\").HandlerFunc(getBooks)\n\n    log.Fatal(http.ListenAndServe(\":8000\", r))\n}\n</code></pre>\n\n<p>When I do go build on this file, I get below compilation errors - </p>\n\n<blockquote>\n  <p>./main.go:49:15: cannot use getBooks (type func(http.ResponseWriter,\n  *http.Response)) as type func(http.ResponseWriter, *http.Request) in argument to r.HandleFunc ./main.go:50:15: cannot use getBook (type\n  func(http.ResponseWriter, *http.Response)) as type\n  func(http.ResponseWriter, *http.Request) in argument to r.HandleFunc\n  ./main.go:51:15: cannot use createBook (type func(http.ResponseWriter,\n  *http.Response)) as type func(http.ResponseWriter, *http.Request) in argument to r.HandleFunc ./main.go:52:15: cannot use updateBook (type\n  func(http.ResponseWriter, *http.Response)) as type\n  func(http.ResponseWriter, *http.Request) in argument to r.HandleFunc\n  ./main.go:53:15: cannot use deleteBook (type func(http.ResponseWriter,\n  *http.Response)) as type func(http.ResponseWriter, *http.Request) in argument to r.HandleFunc</p>\n</blockquote>\n\n<p>What did I do wrong? What did I miss here? In the tutorial, he was able to build and run the file.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1519838218, "post_id": 49034014, "comment_id": 85075086, "body": "Don&#39;t use Wrap call your middleware directly which contains (next(res, req)). So If error comes dont run next middleware"}], "answers": [{"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 0, "last_activity_date": 1519855194, "last_edit_date": 1519855194, "creation_date": 1519840516, "answer_id": 49035765, "question_id": 49034014, "link": "https://stackoverflow.com/questions/49034014/how-to-use-multiple-negroni-wrap/49035765#49035765", "title": "how to use multiple negroni.Wrap()", "body": "<p>Use a middleware having ServeHttp Method which will be called using userDetailHandler as receiver inside middleware. And pass your db struct in middleware as an argument . You should use single wrap.</p>\n\n<pre><code>r.Handle(\"/users/{userID}\", negroni.New(\n        negroni.HandlerFunc(validateTokenMiddleware),\n        negroni.Wrap(userDetailHandler.Middleware(&amp;userLocation)),\n    )).Methods(\"GET\")\n\nfunc (userDetailHandler *UserDetailHandler)Middleware(res http.ResponseWriter, req *http.Request, userLocation *userLocation){\n   // use your serve Http inside this\n   userDetailHandler.ServeHttp(res, req)\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9169015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2d3254fb0f3abd40a4b9e203f45e792?s=128&d=identicon&r=PG&f=1", "display_name": "saket", "link": "https://stackoverflow.com/users/9169015/saket"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519855194, "creation_date": 1519834599, "question_id": 49034014, "link": "https://stackoverflow.com/questions/49034014/how-to-use-multiple-negroni-wrap", "title": "how to use multiple negroni.Wrap()", "body": "<p>I have an issue to implement middleware i want to use <code>negroni.Wrap</code> function for validate user location and one for calling handler below is my route:</p>\n\n<pre><code>r.Handle(\"/users/{userID}\", negroni.New(\n        negroni.HandlerFunc(validateTokenMiddleware),\n        negroni.Wrap(&amp;userLocation),\n        negroni.Wrap(&amp;userDetailHandler),\n    )).Methods(\"GET\")\n</code></pre>\n\n<p>and <code>&amp;userLocation</code> is object of an struct which contain db information, here when i request for handler then that time both <code>wrap</code> execute together. But i want execute <code>&amp;userlocation</code> first and if any errors occur so <code>next wrap</code> should not be execute , how to resolve this issue.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "yaml"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1519834123, "post_id": 49033730, "comment_id": 85072418, "body": "YAML uses a native integer data type, not <code>uint32</code>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1519836250, "post_id": 49033730, "comment_id": 85073792, "body": "It doesn&#39;t matter if it fits in <code>uint32</code>, because you&#39;re not doing a type conversion, you&#39;re doing a type assertion. You can assert it to the true underlying type, then coerce it to <code>uint32</code> if it fits."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1519838532, "post_id": 49033730, "comment_id": 85075277, "body": "I concur with the answer by @hbejgel but the real question is: is it possible that your real YAML documents may contain non-integer values at that &quot;foo&quot; key? The reason I&#39;m asking is that the way to go may be implementing a custom type which implements the <code>encoding.TextUnmarshaler</code> interface, accepts the raw value&#39;s data in the form of <code>[]byte</code> and is then free to interpret it in whatever the way it wants and produce the value of the concrete type(s) you want."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1519838575, "post_id": 49033730, "comment_id": 85075298, "body": "Look <a href=\"https://golang.org/pkg/encoding/#TextUnmarshaler\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://github.com/go-yaml/yaml/blob/3e6d767784b037b90a14701b6c9f0643f05db963/decode.go#L394\" rel=\"nofollow noreferrer\">here</a>. Oh, and if the answer to my question is &quot;no&quot; then just declare your <code>Foo</code> field as <code>uint32</code> rather than <code>interface{}</code>."}, {"owner": {"reputation": 135, "user_id": 8495751, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gLl3O0o0uJ0/AAAAAAAAAAI/AAAAAAAAAAw/0n2sQZzaW1Q/photo.jpg?sz=128", "display_name": "Sa Oh", "link": "https://stackoverflow.com/users/8495751/sa-oh"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1519869031, "post_id": 49033730, "comment_id": 85088115, "body": "@kostix Yes, my real YAML data may contain values except <code>uint32</code>. It can be a boolean, it can be a string, etc. <code>encoding.TextUnmarshaler</code> sounds promising. Thanks!"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1519902759, "post_id": 49033730, "comment_id": 85101074, "body": "@SaOh, oh, by the way I meant creating a custom type to unmarshal the <code>Foo</code> field, not the enclosing field."}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1519838790, "post_id": 49035149, "comment_id": 85075438, "body": "One minor nitpick in that in a real production code it might worth complicating the approach a bit by 1) using two-argument type assertion and returning an error if it fails, and 2) checking whether the range of the obtained <code>int</code>-typed value is within the range of <code>uint32</code> before type-converting it, and returning an error if it&#39;s not. In the demonstrated approach, a panic and a silent reinterpretation of data are both possible."}, {"owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1519853666, "post_id": 49035149, "comment_id": 85083214, "body": "Agreed, this example was just to demonstrate how to do it in the simplest way possible. (with no intention of guarding against invalid data)"}, {"owner": {"reputation": 135, "user_id": 8495751, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gLl3O0o0uJ0/AAAAAAAAAAI/AAAAAAAAAAw/0n2sQZzaW1Q/photo.jpg?sz=128", "display_name": "Sa Oh", "link": "https://stackoverflow.com/users/8495751/sa-oh"}, "edited": false, "score": 0, "creation_date": 1519869326, "post_id": 49035149, "comment_id": 85088197, "body": "Thanks @hbejgel ! I have another question then. Why does Go compiler think that the dynamic type of <code>v</code> as <code>int</code> instead of <code>uint32</code>? Is there an priority order or something to determine the type of <code>v</code>?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 135, "user_id": 8495751, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gLl3O0o0uJ0/AAAAAAAAAAI/AAAAAAAAAAw/0n2sQZzaW1Q/photo.jpg?sz=128", "display_name": "Sa Oh", "link": "https://stackoverflow.com/users/8495751/sa-oh"}, "edited": false, "score": 0, "creation_date": 1519903327, "post_id": 49035149, "comment_id": 85101347, "body": "@SaOh, 1) I don&#39;t think that&#39;s Go compiler; I&#39;d fathom it&#39;s the implementation of that YAML codec package; 2) I&#39;d speculate <code>int</code> is picked as the &quot;default sane/safe choice&quot;. Let&#39;s suppose the author(s) decided to implement more &quot;strict&quot; typing. That would mean looking at the raw value and seeing it does not start with <code>-</code>, so it has to be an <code>uint</code>. Then what size to pick? Why 32? There are <code>uint8</code> and <code>uint16</code> and <code>uint64</code> types as well. So what do we do then? Count the digits and pick the &quot;narrowest&quot; suitable type? So <code>32</code> would be unmarshaled to <code>uint8</code> and <code>65537</code> to <code>uint32</code> etc."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 135, "user_id": 8495751, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gLl3O0o0uJ0/AAAAAAAAAAI/AAAAAAAAAAw/0n2sQZzaW1Q/photo.jpg?sz=128", "display_name": "Sa Oh", "link": "https://stackoverflow.com/users/8495751/sa-oh"}, "edited": false, "score": 0, "creation_date": 1519903613, "post_id": 49035149, "comment_id": 85101503, "body": "@SaOh, Do you find it convenient? ;-) Also consider that should the raw value start with <code>-</code>, it would have been classified as belonging to one of the four signed integer types. Now, to &quot;decapsulate&quot; a value of a concrete type at runtime you&#39;d have to deal with a <a href=\"https://golang.org/ref/spec#Type_switches\" rel=\"nofollow noreferrer\">type switch</a> with 8 branches. That&#39;s not convenient, too. OTOH, <code>int</code> is a &quot;jack-of-all-trades&quot; here: it may not be the &quot;best&quot; (in whatever sense) type but it makes many things way more straightforward."}, {"owner": {"reputation": 135, "user_id": 8495751, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gLl3O0o0uJ0/AAAAAAAAAAI/AAAAAAAAAAw/0n2sQZzaW1Q/photo.jpg?sz=128", "display_name": "Sa Oh", "link": "https://stackoverflow.com/users/8495751/sa-oh"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1519906072, "post_id": 49035149, "comment_id": 85102924, "body": "@kostix Thanks for the clarification! It got much more clearer now :)"}], "tags": [], "owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "is_accepted": true, "score": 0, "last_activity_date": 1519838185, "creation_date": 1519838185, "answer_id": 49035149, "question_id": 49033730, "link": "https://stackoverflow.com/questions/49033730/why-converting-interface-to-uint32-doesnt-work-even-when-the-actual-value-is/49035149#49035149", "title": "Why converting interface{} to uint32 doesn&#39;t work even when the actual value is in the range of uint32", "body": "<p>From the spec:</p>\n\n<blockquote>\n  <p>If T from v.(T) is not an interface type then such assertion checks if dynamic type of v is identical to T</p>\n</blockquote>\n\n<p>When you do type assertion the dynamic type of v has to be identical to T, according to your error message the dynamic type is <code>int</code> and you're trying to assert it to <code>uint32</code> that won't work since they are not identical.</p>\n\n<p>You probably want to do something like this:</p>\n\n<pre><code>uint32Val = uint32(sampleYaml.Foo.(int))\n</code></pre>\n\n<p>You first use type assertion to get an <code>int</code> from your <code>interface{}</code> and then you use type coercion to have your <code>uint32</code></p>\n"}], "owner": {"reputation": 135, "user_id": 8495751, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gLl3O0o0uJ0/AAAAAAAAAAI/AAAAAAAAAAw/0n2sQZzaW1Q/photo.jpg?sz=128", "display_name": "Sa Oh", "link": "https://stackoverflow.com/users/8495751/sa-oh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1070, "favorite_count": 0, "accepted_answer_id": 49035149, "answer_count": 1, "score": -5, "last_activity_date": 1519838185, "creation_date": 1519833698, "question_id": 49033730, "link": "https://stackoverflow.com/questions/49033730/why-converting-interface-to-uint32-doesnt-work-even-when-the-actual-value-is", "title": "Why converting interface{} to uint32 doesn&#39;t work even when the actual value is in the range of uint32", "body": "<p>I'm trying to retrieve a value from a YAML string and store it as <code>uint32</code> using <a href=\"https://gopkg.in/yaml.v2\" rel=\"nofollow noreferrer\">gopkg.in/yaml.v2</a>.</p>\n\n<p>When I try to convert a value <code>foo</code> as follows, I get an error message that says: <code>panic: interface conversion: interface {} is int, not uint32</code>. I can't understand the reason why I see the error message, because the value <code>foo</code> is actually <code>3</code> and it's in the range of <code>uint32</code>.</p>\n\n<pre><code>var myYaml = `\nfoo: 3\n`\n\ntype SampleYaml struct {\n        Foo interface{}\n}\n\nfunc main() {\n        var sampleYaml SampleYaml\n        var uint32Val uint32\n\n        yaml.Unmarshal([]byte(myYaml), &amp;sampleYaml)\n\n        uint32Val = sampleYaml.Foo.(uint32)\n        fmt.Println(uint32Val)\n}\n</code></pre>\n\n<p>Here's the <a href=\"https://play.golang.org/p/LzfsofiMatq\" rel=\"nofollow noreferrer\">actual code</a> that I'm struggling with.</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1519833494, "post_id": 49033653, "comment_id": 85071984, "body": "Regex101 playground link is <a href=\"https://regex101.com/r/gvYA5N/1\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 658033, "user_id": 548225, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dab08478b226280d4a30894c9a7ed719?s=128&d=identicon&r=PG", "display_name": "anubhava", "link": "https://stackoverflow.com/users/548225/anubhava"}, "edited": false, "score": 1, "creation_date": 1519833811, "post_id": 49033653, "comment_id": 85072209, "body": "What is your regex flavor?"}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "reply_to_user": {"reputation": 658033, "user_id": 548225, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dab08478b226280d4a30894c9a7ed719?s=128&d=identicon&r=PG", "display_name": "anubhava", "link": "https://stackoverflow.com/users/548225/anubhava"}, "edited": false, "score": 0, "creation_date": 1519833849, "post_id": 49033653, "comment_id": 85072246, "body": "@anubhava Golang"}], "answers": [{"comments": [{"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1519834389, "post_id": 49033867, "comment_id": 85072582, "body": "Thanks, but this doesn&#39;t work for: <code>model:in:[test1,test2],price:gte:5.99,price:lte:10.00</code>"}], "tags": [], "owner": {"reputation": 658033, "user_id": 548225, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dab08478b226280d4a30894c9a7ed719?s=128&d=identicon&r=PG", "display_name": "anubhava", "link": "https://stackoverflow.com/users/548225/anubhava"}, "is_accepted": false, "score": 1, "last_activity_date": 1519835818, "last_edit_date": 1519835818, "creation_date": 1519834127, "answer_id": 49033867, "question_id": 49033653, "link": "https://stackoverflow.com/questions/49033653/tokenize-by-comma-outside-the-brackets/49033867#49033867", "title": "Tokenize by comma outside the brackets", "body": "<p>golang regex doesn't support lookaheads assertion that makes this task bit more difficult.</p>\n\n<p>You may use this regex using alternation:</p>\n\n<pre><code>[^][,]*(?:\\[[^][]*\\])+|[^,]+\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/gvYA5N/5\" rel=\"nofollow noreferrer\">RegEx Demo</a></p>\n\n<p><strong>Details:</strong></p>\n\n<ul>\n<li><code>[^][,]+</code>: Match 1+ characters that are not <code>,</code> and <code>[</code> and <code>]</code></li>\n<li><code>(?:\\[[^][]*\\])+</code>: Match text between <code>[</code> or <code>]</code>. Match 1 or more of this group</li>\n<li><code>|</code>: OR</li>\n<li><code>[^,]+</code>: Match 1+ characters that are not comma</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1519836061, "post_id": 49034301, "comment_id": 85073669, "body": "Thanks, I will mark your answer as accepted since you were first with a working solution. Otherwise, @anubhava regex pattern works for me too."}, {"owner": {"reputation": 658033, "user_id": 548225, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dab08478b226280d4a30894c9a7ed719?s=128&d=identicon&r=PG", "display_name": "anubhava", "link": "https://stackoverflow.com/users/548225/anubhava"}, "reply_to_user": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1519836409, "post_id": 49034301, "comment_id": 85073899, "body": "@AndrejsCainikovs: Please don&#39;t take this comment as offensive but just a minor correction my working edit was 8 seconds before this answer :) But of course it should be OP&#39;s prerogative to accept any answer."}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "reply_to_user": {"reputation": 658033, "user_id": 548225, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dab08478b226280d4a30894c9a7ed719?s=128&d=identicon&r=PG", "display_name": "anubhava", "link": "https://stackoverflow.com/users/548225/anubhava"}, "edited": false, "score": 1, "creation_date": 1519837512, "post_id": 49034301, "comment_id": 85074666, "body": "@anubhava: I was expecting this kind of comment. What can I say? I really was hesitating, but unfortunately SO is not designed in such a way so I can accept both answers. I gave <i>The fourth bird</i> a preference for two reasons: he first posted a working solution, and at this moment he has 6.7k of reputation vs 472k yours. I&#39;m not thinking that you have too much reputation, no. You totally earned it, and I highly respect that. But since I&#39;m a huge SO fan, motivating people with small or average reputation is my personal prerogative."}, {"owner": {"reputation": 658033, "user_id": 548225, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dab08478b226280d4a30894c9a7ed719?s=128&d=identicon&r=PG", "display_name": "anubhava", "link": "https://stackoverflow.com/users/548225/anubhava"}, "reply_to_user": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1519837747, "post_id": 49034301, "comment_id": 85074800, "body": "@AndrejsCainikovs: Totally respect your thought process. I wasn&#39;t questioning your selection at all."}, {"owner": {"reputation": 658033, "user_id": 548225, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dab08478b226280d4a30894c9a7ed719?s=128&d=identicon&r=PG", "display_name": "anubhava", "link": "https://stackoverflow.com/users/548225/anubhava"}, "edited": false, "score": 1, "creation_date": 1519838030, "post_id": 49034301, "comment_id": 85074964, "body": "Also if I may suggest, please use <code>(?:[^][,\\n]+\\[[^]]+\\]|[^,\\n]+)</code> in your code as <code>[^,]+</code> at the start will cause lot of backtracking in larger text."}, {"owner": {"reputation": 91458, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "reply_to_user": {"reputation": 658033, "user_id": 548225, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dab08478b226280d4a30894c9a7ed719?s=128&d=identicon&r=PG", "display_name": "anubhava", "link": "https://stackoverflow.com/users/548225/anubhava"}, "edited": false, "score": 1, "creation_date": 1519841211, "post_id": 49034301, "comment_id": 85076718, "body": "@anubhava The comment about the backtracking was very valuable. Thank you for that!"}], "tags": [], "owner": {"reputation": 91458, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "is_accepted": true, "score": 1, "last_activity_date": 1519841212, "last_edit_date": 1519841212, "creation_date": 1519835480, "answer_id": 49034301, "question_id": 49033653, "link": "https://stackoverflow.com/questions/49033653/tokenize-by-comma-outside-the-brackets/49034301#49034301", "title": "Tokenize by comma outside the brackets", "body": "<p>This might be an option:</p>\n\n<p><a href=\"https://regex101.com/r/RC9TCe/2\" rel=\"nofollow noreferrer\"><code>(?:[^][,\\n]+\\[[^]]+\\]|[^,\\n]+)</code></a></p>\n\n<p><strong>Explanation</strong></p>\n\n<pre>\n(?:                  # Non capturing group\n  [^][,\\n]+\\[[^]]+\\] # Match not a comma newline ] or [, then match between []\n  |                  # Or\n  [^,\\n]+            # Match not a comma or a newline\n)                    # Close non capturing group\n</pre>\n\n<p><strong>Edit:</strong>\nAs suggested by @anubhava added <code>][</code> to the character class so that this becomes <code>[^][,\\n]</code> to prevent unnecessary backtracking.</p>\n"}], "owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 49034301, "answer_count": 2, "score": 0, "last_activity_date": 1519845019, "creation_date": 1519833464, "last_edit_date": 1519845019, "question_id": 49033653, "link": "https://stackoverflow.com/questions/49033653/tokenize-by-comma-outside-the-brackets", "title": "Tokenize by comma outside the brackets", "body": "<p>I'm desperately trying to tokenize a filter string which has following format:</p>\n\n<pre><code>price:gte:5.99,price:lte:10.00,model:in:[test1,test2]\n</code></pre>\n\n<p>The pitfall is that comma is used not only to separate filter options, but also as a separator for option lists: <code>[test1,test2]</code></p>\n\n<p>Applying standard regex tokenizer expression <code>[^,]+</code> gives me:</p>\n\n<pre><code>price:gte:5.99\nprice:lte:10.00\nmodel:in:[test1\ntest2]\n</code></pre>\n\n<p>But, obviously, I want:</p>\n\n<pre><code>price:gte:5.99\nprice:lte:10.00\nmodel:in:[test1,test2]\n</code></pre>\n\n<p>How can I achieve that?</p>\n"}, {"tags": ["go", "oauth-2.0", "google-oauth"], "comments": [{"owner": {"reputation": 6658, "user_id": 731178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/du44q.jpg?s=128&g=1", "display_name": "J&#225;n Hala\u0161a", "link": "https://stackoverflow.com/users/731178/j%c3%a1n-hala%c5%a1a"}, "edited": false, "score": 0, "creation_date": 1519834367, "post_id": 49033216, "comment_id": 85072573, "body": "What is your reason for using OAuth2 and for getting tokens? What tokens do you want to get (access token, refresh token, ID token)?"}, {"owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "reply_to_user": {"reputation": 6658, "user_id": 731178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/du44q.jpg?s=128&g=1", "display_name": "J&#225;n Hala\u0161a", "link": "https://stackoverflow.com/users/731178/j%c3%a1n-hala%c5%a1a"}, "edited": false, "score": 0, "creation_date": 1519834573, "post_id": 49033216, "comment_id": 85072681, "body": "the reason is for the provider API access and streamlining of the signup process. I am getting access, refresh, and ID"}, {"owner": {"reputation": 6658, "user_id": 731178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/du44q.jpg?s=128&g=1", "display_name": "J&#225;n Hala\u0161a", "link": "https://stackoverflow.com/users/731178/j%c3%a1n-hala%c5%a1a"}, "edited": false, "score": 0, "creation_date": 1519836627, "post_id": 49033216, "comment_id": 85074060, "body": "So you want to access Google services from your backend. And what is your frontend? Is it a single page application or some more traditional HTML+JavaScript? Do you need a token there just for the session identification?"}, {"owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "reply_to_user": {"reputation": 6658, "user_id": 731178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/du44q.jpg?s=128&g=1", "display_name": "J&#225;n Hala\u0161a", "link": "https://stackoverflow.com/users/731178/j%c3%a1n-hala%c5%a1a"}, "edited": false, "score": 0, "creation_date": 1519836714, "post_id": 49033216, "comment_id": 85074117, "body": "its a react single page app. Would be nice to have some basic user info that is in the token as well"}], "answers": [{"comments": [{"owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "edited": false, "score": 0, "creation_date": 1519843350, "post_id": 49036116, "comment_id": 85077790, "body": "this makes sense, but if I am going to need API access, I don&#39;t see the point in creating my own authentication scheme and then coming back to the token for the API. I would like to use the google ID token, but they are only good for one hour...How would the frontend flow look like when getting another token? use JS to check expiry time and redirect the user around again? what if there is a bad/expired token sent to the server? How should the frontend handle that without automatically failing?"}, {"owner": {"reputation": 6658, "user_id": 731178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/du44q.jpg?s=128&g=1", "display_name": "J&#225;n Hala\u0161a", "link": "https://stackoverflow.com/users/731178/j%c3%a1n-hala%c5%a1a"}, "reply_to_user": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "edited": false, "score": 0, "creation_date": 1519844524, "post_id": 49036116, "comment_id": 85078404, "body": "if you need a new ID token at the frontend, you can use the <code>prompt=none</code> request parameter for the <code>&#47;auth</code> endpoint. This way, you can get a new token without the user interaction - in an iframe, without the user noticing the token change. As long as the SSO session is valid at Google. So when the frontend receives a token, it schedules a task for getting a new one before the token expires."}, {"owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "edited": false, "score": 0, "creation_date": 1519845685, "post_id": 49036116, "comment_id": 85079049, "body": "ok thanks for the help. I will need other providers too...This provider looks like they only offer the implicit flow, but I can&#39;t be sure because they are so similar. Can you verify if this is the implicit flow... (<a href=\"http://open.wechat.com/cgi-bin/newreadtemplate?t=overseas_open/docs/web/login/login#login_login\" rel=\"nofollow noreferrer\">open.wechat.com/cgi-bin/newreadtemplate?t=overseas_open/doc&zwnj;&#8203;s/&hellip;</a>)"}, {"owner": {"reputation": 6658, "user_id": 731178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/du44q.jpg?s=128&g=1", "display_name": "J&#225;n Hala\u0161a", "link": "https://stackoverflow.com/users/731178/j%c3%a1n-hala%c5%a1a"}, "reply_to_user": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "edited": false, "score": 0, "creation_date": 1519847898, "post_id": 49036116, "comment_id": 85080167, "body": "No, it&#39;s the Auth code grant. The Implicit flow doesn&#39;t require a client secret and the <code>response_type</code> auth URL param has a value of either<code>token</code> or <code>id_token token</code> or <code>id_token</code> (depending on what token you want to get)."}], "tags": [], "owner": {"reputation": 6658, "user_id": 731178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/du44q.jpg?s=128&g=1", "display_name": "J&#225;n Hala\u0161a", "link": "https://stackoverflow.com/users/731178/j%c3%a1n-hala%c5%a1a"}, "is_accepted": false, "score": 1, "last_activity_date": 1519842032, "creation_date": 1519842032, "answer_id": 49036116, "question_id": 49033216, "link": "https://stackoverflow.com/questions/49033216/server-side-oauth-what-to-do-with-the-tokens-received/49036116#49036116", "title": "server side oauth: What to do with the tokens received", "body": "<p>First, you should decide which part of your application will have a role of the OAuth2 client. If you have a React SPA as a frontend, I would suggest you to make it the client and use the <a href=\"https://tools.ietf.org/html/rfc6749#section-4.2\" rel=\"nofollow noreferrer\">Implicit grant</a> OAuth2 flow (designed for browser apps) instead of the <a href=\"https://tools.ietf.org/html/rfc6749#section-4.1\" rel=\"nofollow noreferrer\">Auth code grant</a>. This way, the SPA initiates the authentication and it receives an ID token (to identify the user) and an access token to call <a href=\"https://developers.google.com/identity/protocols/OAuth2UserAgent\" rel=\"nofollow noreferrer\">Google services</a>. </p>\n\n<p>Then there is a question how to identify a user at the backend. I would use the ID token for that - the backend will have to check the Google signature and that the audience of the token is the client ID of your application. Based on this ID token, you can either issue your own token (just for the identification of your frontend user), create a backend session or to keep sending the Google ID token with each request.</p>\n"}, {"tags": [], "owner": {"reputation": 218, "user_id": 7031561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb6085d517d1693ad6cac4f6ccdcb05?s=128&d=identicon&r=PG&f=1", "display_name": "channel", "link": "https://stackoverflow.com/users/7031561/channel"}, "is_accepted": false, "score": 0, "last_activity_date": 1520004946, "creation_date": 1520004946, "answer_id": 49072357, "question_id": 49033216, "link": "https://stackoverflow.com/questions/49033216/server-side-oauth-what-to-do-with-the-tokens-received/49072357#49072357", "title": "server side oauth: What to do with the tokens received", "body": "<p>The first question I think you need to answer is what are you using the OAuth tokens for. Before we look at that question, let's understand what tokens the server side OAuth flow or Authorization Code OAuth flow generally give you (based on the scopes you specify). </p>\n\n<ol>\n<li><p>Access Token: This is a bearer token (meaning if you have the token, you have access) and that's the token you use when querying that provider's APIs or trying to access that provider's resources. Depending on the flow that is used to obtain the token, the token can have different expiration times. </p></li>\n<li><p>Identity Token: This is a signed JWT token that you can introspect and obtain <em>identity</em> information about the user, such as their username, email, etc. </p></li>\n<li><p>Refresh Token: Used to renew the Access token</p></li>\n</ol>\n\n<p>Access to these tokens can allow you to do many things:</p>\n\n<ul>\n<li>access the provider's resources on behalf of the user</li>\n<li>identify the user</li>\n<li>get more info on the user by querying provider's APIs</li>\n<li>establish a session between the user and backend\netc.</li>\n</ul>\n\n<p>But you need to understand the value of the tokens when you use them. \nFor example, a server side flow OAuth gives long terms access tokens that should only exist on a <code>trusted</code> client (such as the backend and not the frontend). If your use case requires access to provider's resources from the frontend (considered <code>low trust</code> client) you should use an implicit OAuth flow.</p>\n\n<p>Regarding session management, again you should understand that the OAuth access token gives the bearer certain privileges (depending on the scope specified) that you are giving away in case of session compromise. So unless you have to for other reasons, in general it's a good idea not to use the access token as a session management cookie.</p>\n\n<p>Regarding the user identity, that's generally a pretty short term token, so once the token has been verified (signature, state and expiry) then you should cache the user identity somewhere backend or in a signed cookie etc.</p>\n"}], "owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1520004946, "creation_date": 1519832128, "question_id": 49033216, "link": "https://stackoverflow.com/questions/49033216/server-side-oauth-what-to-do-with-the-tokens-received", "title": "server side oauth: What to do with the tokens received", "body": "<p>This is my first time doing a full implementation of server side OAuth (as described here <a href=\"https://developers.google.com/identity/protocols/OAuth2WebServer\" rel=\"nofollow noreferrer\">https://developers.google.com/identity/protocols/OAuth2WebServer</a>) and I am getting a bit confused as to what to do with the tokens after receiving them from the auth provider. I can see a few options</p>\n\n<ol>\n<li><p>Send it to the user for local storage and send it to the db. have the frontend send it in http headers on every request and compare it with the one in the db to authenticate. </p></li>\n<li><p>Send it to the database and work out some other form of authentication through a jwt or cookie.</p></li>\n<li><p>something else?</p></li>\n</ol>\n\n<p>1 would be my preferred way, but something feels wrong about it...IDK what, while 2 feels a little wasteful because I will have to come up with an entirely different auth mechanism and then just pull the token from the db and refresh and use it as normal anyway...</p>\n\n<p>What is an acceptable flow for this part of the application? </p>\n"}, {"tags": ["linux", "go", "x11", "xrandr"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1519834045, "post_id": 49033135, "comment_id": 85072374, "body": "The language is called Go, not golang ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6475413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7cf430028e80f2b998bb6542d5c98e2?s=128&d=identicon&r=PG&f=1", "display_name": "plazmakeks", "link": "https://stackoverflow.com/users/6475413/plazmakeks"}, "edited": false, "score": 0, "creation_date": 1520335895, "post_id": 49033805, "comment_id": 85263932, "body": "thanks for your response. xgb seems valuable to me. unfortunately there is a bug in the lib respectivly in X. check out <a href=\"https://github.com/BurntSushi/xgb/issues/20\" rel=\"nofollow noreferrer\">this</a> which make it impossible to retrieve the refresh rate. so, any further recommendation?"}, {"owner": {"reputation": 21, "user_id": 6475413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7cf430028e80f2b998bb6542d5c98e2?s=128&d=identicon&r=PG&f=1", "display_name": "plazmakeks", "link": "https://stackoverflow.com/users/6475413/plazmakeks"}, "edited": false, "score": 0, "creation_date": 1520341826, "post_id": 49033805, "comment_id": 85267885, "body": "got it. one can calculate the refresh rate via the ModeInfo."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 21, "user_id": 6475413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7cf430028e80f2b998bb6542d5c98e2?s=128&d=identicon&r=PG&f=1", "display_name": "plazmakeks", "link": "https://stackoverflow.com/users/6475413/plazmakeks"}, "edited": false, "score": 0, "creation_date": 1520350340, "post_id": 49033805, "comment_id": 85273523, "body": "Hm, from the onlooks of the bug, it appears that the server does not send the information which <code>xgb</code> expects to locate in the <code>randr</code> request. Unfortunately, my knowledge of X internals is clearly lacking to suggest what component is really at fault here."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 0, "last_activity_date": 1519833951, "creation_date": 1519833951, "answer_id": 49033805, "question_id": 49033135, "link": "https://stackoverflow.com/questions/49033135/avoid-parsing-xrandr-output/49033805#49033805", "title": "Avoid parsing Xrandr output", "body": "<p>You might want to look at the <a href=\"https://github.com/BurntSushi/xgb/\" rel=\"nofollow noreferrer\"><code>github.com/BurntSushi/xgb</code></a> package\nwhich is a pure Go implementation of <a href=\"http://xcb.freedesktop.org/\" rel=\"nofollow noreferrer\">XCB</a>,\nand <a href=\"https://github.com/BurntSushi/xgb/blob/master/examples/randr/main.go\" rel=\"nofollow noreferrer\">it has access to the <code>randr</code> facility</a>.</p>\n"}], "owner": {"reputation": 21, "user_id": 6475413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7cf430028e80f2b998bb6542d5c98e2?s=128&d=identicon&r=PG&f=1", "display_name": "plazmakeks", "link": "https://stackoverflow.com/users/6475413/plazmakeks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 469, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519834030, "creation_date": 1519831882, "last_edit_date": 1519834030, "question_id": 49033135, "link": "https://stackoverflow.com/questions/49033135/avoid-parsing-xrandr-output", "title": "Avoid parsing Xrandr output", "body": "<p>i need to get information from xrandr into my software. Suppose thats my output from <code>xrandr -q</code>:</p>\n\n<pre><code>Screen 0: minimum 8 x 8, current 1920 x 1968, maximum 32767 x 32767\nLVDS1 connected primary 1366x768+309+1200 (normal left inverted right x axis y axis) 277mm x 156mm\n   1366x768      60.02*+\n   1360x768      59.80    59.96 \n   1280x720      60.00 \n   1024x768      60.00 \n   1024x576      60.00 \n   960x540       60.00 \n   800x600       60.32    56.25 \n   864x486       60.00 \n   640x480       59.94 \n   720x405       60.00 \n   680x384       60.00 \n   640x360       60.00 \nDP1 connected 1920x1200+0+0 (normal left inverted right x axis y axis) 518mm x 324mm\n   1920x1200     59.95*+\n   1920x1080     60.00 \n   1600x1200     60.00 \n   1680x1050     59.95 \n   1280x1024     60.02 \n   1280x960      60.00 \n   1024x768      60.00 \n   800x600       60.32\n   640x480       60.00 \n   720x400       70.08\n</code></pre>\n\n<p>The data I want is the possible solutions together with the possible refresh rates. So far my software reads the capabilities from <code>/sys/class/drm/card0-DP-1</code> and so forth but I can't find any information about the possible refresh rates for any solution. Any hint on that?</p>\n\n<p>I'd also like to know if and how the monitors are arranged in respect to each other, meaning when setting things up if commands like <code>--above</code>, <code>--below</code>, <code>--left-of</code>, <code>--right-of</code> have been used. Is there any way to determine that? </p>\n\n<p>What I really don't want to do is to parse the xrandr output from terminal. So the question is if anyone has any idea how to do this in a nice way. I'm working in a Go environment but did not find any package which solves my problems so far.</p>\n\n<p>Any help welcome.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1519830089, "post_id": 49032532, "comment_id": 85069679, "body": "No, you need to map the strings to the functions you want"}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1519830190, "post_id": 49032532, "comment_id": 85069759, "body": "cool, thanks for confirming, I shall waste no more time on this - happy to close as duplicate"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1519830216, "post_id": 49032532, "comment_id": 85069782, "body": "Note that you can call <i>methods</i> by name, just not <i>functions</i>. See details in the accepted answer of the marked duplicate."}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1519830287, "post_id": 49032532, "comment_id": 85069832, "body": "@icza thats interesting - i will have a look into that, see if that makes life any easier"}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 0, "creation_date": 1519830460, "post_id": 49032532, "comment_id": 85069940, "body": "^^ i think calling methods by name will work for me - if any reader interested in that approach google &quot;golang reflect MethodByName&quot;"}], "owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "closed_date": 1519830090, "answer_count": 0, "score": 0, "last_activity_date": 1519829998, "creation_date": 1519829998, "question_id": 49032532, "link": "https://stackoverflow.com/questions/49032532/resolve-a-string-to-a-function", "closed_reason": "Duplicate", "title": "Resolve a string to a function", "body": "<p>Is it possible to resolve a string to function in golang without doing a manual match?</p>\n\n<p>My use case is that I have a series of commands/requests represented as structs. I use reflection to present the values on the request struct to the user so that they can provide input parameters before I use the populate struct to run a query.</p>\n\n<p>Some of the required values are uuids, where this is the case i would like to add a struct tag to define a function to call to populate a list of values e.g where my struct appears as follows:</p>\n\n<pre><code>type MyRequest struct{\n    RecordID string `uuid:\"RecordIDs\"`\n}\n</code></pre>\n\n<p>I would like to reflect over the struct, read the tag so that I now have a string containing \"RecordIDs\" (fine up to this point) and convert this to a function call - this is the bit I'm missing.</p>\n\n<p>The only way I can think of to resolve the string to a function call is to provide a map lookup, e.g</p>\n\n<pre><code>funcLookup := map[string]func() ([]string, error){}\n</code></pre>\n\n<p>Is there another way of doing this without providing such a map</p>\n"}, {"tags": ["docker", "go", "docker-swarm", "grpc"], "comments": [{"owner": {"reputation": 6893, "user_id": 749924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b88885327486213bf122579d697793?s=128&d=identicon&r=PG", "display_name": "Bret Fisher", "link": "https://stackoverflow.com/users/749924/bret-fisher"}, "edited": false, "score": 0, "creation_date": 1519929836, "post_id": 49032222, "comment_id": 85117752, "body": "When you do a service update it will delete each task (container) in that service and replace with a new container. Wouldn&#39;t you see the connection close as each task stops?"}, {"owner": {"reputation": 6893, "user_id": 749924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b88885327486213bf122579d697793?s=128&d=identicon&r=PG", "display_name": "Bret Fisher", "link": "https://stackoverflow.com/users/749924/bret-fisher"}, "edited": false, "score": 0, "creation_date": 1519929913, "post_id": 49032222, "comment_id": 85117795, "body": "On connection timeouts, I&#39;m not sure by your description which connection you are talking about.  Is it the go-to-mysql connection?"}, {"owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "reply_to_user": {"reputation": 6893, "user_id": 749924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b88885327486213bf122579d697793?s=128&d=identicon&r=PG", "display_name": "Bret Fisher", "link": "https://stackoverflow.com/users/749924/bret-fisher"}, "edited": false, "score": 0, "creation_date": 1519934700, "post_id": 49032222, "comment_id": 85120305, "body": "I have a close DB and other connections before leaving from a signal interrupt function. It does close properly on my dev computer. When swarm deletes the task does it stop without sending the interupt?"}, {"owner": {"reputation": 6893, "user_id": 749924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b88885327486213bf122579d697793?s=128&d=identicon&r=PG", "display_name": "Bret Fisher", "link": "https://stackoverflow.com/users/749924/bret-fisher"}, "edited": false, "score": 0, "creation_date": 1519942563, "post_id": 49032222, "comment_id": 85124115, "body": "Swarm treats container startup/shutdown the same as docker run. It sends <code>SIGTERM</code> to the container and if the container takes longer than 10s to shutdown, it will then send <code>SIGKILL</code>. You can have it wait longer  with <code>--stop-grace-period</code> option on service create."}, {"owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "reply_to_user": {"reputation": 6893, "user_id": 749924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b88885327486213bf122579d697793?s=128&d=identicon&r=PG", "display_name": "Bret Fisher", "link": "https://stackoverflow.com/users/749924/bret-fisher"}, "edited": false, "score": 0, "creation_date": 1519971593, "post_id": 49032222, "comment_id": 85132532, "body": "I did confirm that the close connections do work before shutdown but I still have the same issue on idol."}, {"owner": {"reputation": 6893, "user_id": 749924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b88885327486213bf122579d697793?s=128&d=identicon&r=PG", "display_name": "Bret Fisher", "link": "https://stackoverflow.com/users/749924/bret-fisher"}, "edited": false, "score": 0, "creation_date": 1520006894, "post_id": 49032222, "comment_id": 85151524, "body": "Could it be the IPVS feature in Linux default timeout on idle connections of 15min be the issue? <a href=\"https://github.com/moby/moby/issues/32195#issuecomment-315143802\" rel=\"nofollow noreferrer\">github.com/moby/moby/issues/32195#issuecomment-315143802</a>"}, {"owner": {"reputation": 1577, "user_id": 163216, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4771bf3defdb7c7eb3893f01a6864954?s=128&d=identicon&r=PG", "display_name": "noomz", "link": "https://stackoverflow.com/users/163216/noomz"}, "edited": false, "score": 0, "creation_date": 1526395869, "post_id": 49032222, "comment_id": 87722583, "body": "I confirm this problem. There is no problem on docker for mac. But I have 2 linux machines and just 1 machine has this problem. Still looking for the solution."}, {"owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "reply_to_user": {"reputation": 1577, "user_id": 163216, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4771bf3defdb7c7eb3893f01a6864954?s=128&d=identicon&r=PG", "display_name": "noomz", "link": "https://stackoverflow.com/users/163216/noomz"}, "edited": false, "score": 0, "creation_date": 1526396126, "post_id": 49032222, "comment_id": 87722800, "body": "@noomz What is did is have the client dial the service on the app startup and then create a new client on each api request from the dial connection. That seamed to work."}, {"owner": {"reputation": 1577, "user_id": 163216, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4771bf3defdb7c7eb3893f01a6864954?s=128&d=identicon&r=PG", "display_name": "noomz", "link": "https://stackoverflow.com/users/163216/noomz"}, "edited": false, "score": 0, "creation_date": 1527249574, "post_id": 49032222, "comment_id": 88068966, "body": "@TrevorVarwig Create new connection every request make my req/s drop. So in this case I create new connection only once when service started."}, {"owner": {"reputation": 1577, "user_id": 163216, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4771bf3defdb7c7eb3893f01a6864954?s=128&d=identicon&r=PG", "display_name": "noomz", "link": "https://stackoverflow.com/users/163216/noomz"}, "edited": false, "score": 0, "creation_date": 1527495192, "post_id": 49032222, "comment_id": 88134097, "body": "@TrevorVarwig Ah, sorry, I misunderstood your text. Yes, I do the same as what you do, but mine is unstable."}], "owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 493, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519829107, "creation_date": 1519829107, "question_id": 49032222, "link": "https://stackoverflow.com/questions/49032222/golang-grpc-update-image-in-docker-swarm-having-to-reconnect-clients-each-time", "title": "golang gRPC update image in docker swarm having to reconnect clients each time", "body": "<p>I have a docker swarm on three nodes plus an external mysql service (outside of the swarm). I am programming micro-services with an API Gateway in golang and gRPC. I have two problems. </p>\n\n<p>The first problem is when I push an update a service with <code>docker swarm update --image ... myservice</code> I get the error on my API Gateway from each micro-service <code>transport is closing</code> for three requests to the gateway. (I am assuming each task needs to reconnect on each service?) How can I fix this?  Each service has <code>update-delay</code> set to <code>30s</code> and <code>update-parallelism</code> set to <code>1</code>. Shouldn't the api gateway stay connected to each service if there are rolling updates? </p>\n\n<p>The second problem is after an idol time (not sure how long) I am getting the same issue from above that the services are closing and I have to do three requests to the api gateway for it to work. Any help appreciated.\nI am running Ubuntu 16.04 with Docker version 17.12.0-ce, build c97c6d6 and am building go version go1.9.4 darwin/amd64</p>\n\n<p>A service example:</p>\n\n<pre><code>  // listen on address\n    lis, err := net.Listen(network, address)\n    if err != nil {\n        log.Fatalf(\"failed to listen: %v\", err)\n    }\n    defer lis.Close()\n\n    // create users server\n    s := grpc.NewServer()\n    pb.RegisterUsersServer(s, &amp;server{})\n\n    // register reflection service on gRPC server.\n    reflection.Register(s)\n\n    // message will run after serve if err == nil\n    go func() {\n        time.Sleep(time.Second)\n        log.Printf(\"started users service on %s\", address)\n    }()\n    if err := s.Serve(lis); err != nil {\n        log.Fatalf(\"failed to serve: %v\", err)\n    }\n</code></pre>\n\n<p>My api gateway connection</p>\n\n<pre><code>// connect to users\nusersConnection, err := grpc.Dial(usersAddress, grpc.WithInsecure())\nif err != nil {\n    log.Fatalf(\"did not connect: %v\", err)\n}\nusers = userspb.NewUsersClient(usersConnection)\nlog.Println(\"connected to users\")\n</code></pre>\n"}, {"tags": ["go", "docopt"], "answers": [{"comments": [{"owner": {"reputation": 4452, "user_id": 2354099, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7f136983231a6281fcb14761ef972fa0?s=128&d=identicon&r=PG", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/2354099/pinkpanther"}, "edited": false, "score": 0, "creation_date": 1519887284, "post_id": 49041747, "comment_id": 85093045, "body": "But is it possible to make the options repeatable if we specify them in Options section? That is, I need to be able to &quot;ship -b firstb -b secondb -e firste -e seconde. Thank you."}, {"owner": {"reputation": 6357, "user_id": 6086311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb99289473f6393b89474785f2d294d1?s=128&d=identicon&r=PG", "display_name": "dtolnay", "link": "https://stackoverflow.com/users/6086311/dtolnay"}, "reply_to_user": {"reputation": 4452, "user_id": 2354099, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7f136983231a6281fcb14761ef972fa0?s=128&d=identicon&r=PG", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/2354099/pinkpanther"}, "edited": false, "score": 0, "creation_date": 1519887496, "post_id": 49041747, "comment_id": 85093122, "body": "I believe it is not. This is being tracked in <a href=\"https://github.com/docopt/docopt/issues/275\" rel=\"nofollow noreferrer\">docopt/docopt#275</a>."}], "tags": [], "owner": {"reputation": 6357, "user_id": 6086311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb99289473f6393b89474785f2d294d1?s=128&d=identicon&r=PG", "display_name": "dtolnay", "link": "https://stackoverflow.com/users/6086311/dtolnay"}, "is_accepted": false, "score": 0, "last_activity_date": 1519871579, "creation_date": 1519871579, "answer_id": 49041747, "question_id": 49031029, "link": "https://stackoverflow.com/questions/49031029/how-to-frame-unordered-arguments-in-docopt/49041747#49041747", "title": "How to frame unordered arguments in docopt?", "body": "<blockquote>\n<pre><code>naval_fate.py ship\n[-b &lt;b_command&gt;]\n[-e &lt;e_command&gt;]\n</code></pre>\n</blockquote>\n\n<p>The interpretation of the docopt you wrote is as follows:</p>\n\n<ul>\n<li>The subcommand <code>ship</code>,</li>\n<li>Followed by zero or more of the following in any order:\n\n<ul>\n<li>The boolean flag <code>-b</code>,</li>\n<li>A positional argument <code>&lt;b_command&gt;</code>,</li>\n<li>The boolean flag <code>-e</code>,</li>\n<li>A positional argument <code>&lt;e_command&gt;</code>.</li>\n</ul></li>\n</ul>\n\n<p>So all of the following would be considered legal input commands:</p>\n\n<pre><code>naval_fate.py ship -e\nnaval_fate.py ship BB -e\nnaval_fate.py ship -eb\nnaval_fate.py ship BB EE\n</code></pre>\n\n<p>The correct way to express flags like <code>-b &lt;b_command&gt;</code> and <code>-e &lt;e_command&gt;</code> is through a section called <code>Options</code>.</p>\n\n<pre><code>Naval Fate.\n\nUsage:\n  naval_fate.py ship [options]\n\nOptions:\n  -b &lt;b_command&gt;   Description of -b\n  -e &lt;e_command&gt;   Description of -e\n</code></pre>\n"}], "owner": {"reputation": 4452, "user_id": 2354099, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7f136983231a6281fcb14761ef972fa0?s=128&d=identicon&r=PG", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/2354099/pinkpanther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519871579, "creation_date": 1519825492, "question_id": 49031029, "link": "https://stackoverflow.com/questions/49031029/how-to-frame-unordered-arguments-in-docopt", "title": "How to frame unordered arguments in docopt?", "body": "<p>I'm trying to frame a docopt usage which accepts set of options.</p>\n\n<pre><code>Naval Fate.\n\nUsage:\n  naval_fate.py ship\n  [-b &lt;b_command&gt;]\n  [-e &lt;e_command&gt;]\n</code></pre>\n\n<p>Runnable example: \n<a href=\"http://try.docopt.org/?doc=Naval+Fate.%0D%0A%0D%0AUsage%3A%0D%0A++naval_fate.py+ship%0D%0A++%5B-b+%3Cb_command%3E%5D%0D%0A++%5B-e+%3Ce_command%3E%5D&amp;argv=ship+-e+c+\" rel=\"nofollow noreferrer\">http://try.docopt.org/?doc=Naval+Fate.%0D%0A%0D%0AUsage%3A%0D%0A++naval_fate.py+ship%0D%0A++%5B-b+%3Cb_command%3E%5D%0D%0A++%5B-e+%3Ce_command%3E%5D&amp;argv=ship+-e+c+</a></p>\n\n<p>If I use this, it works fine:</p>\n\n<p><code>ship -b barg -e earg</code></p>\n\n<p>The output is:</p>\n\n<pre><code>{\n  \"-b\": true, \n  \"-e\": true, \n  \"&lt;b_command&gt;\": \"barg\", \n  \"&lt;e_command&gt;\": \"earg\", \n  \"ship\": true\n}\n</code></pre>\n\n<p>But if use this, it still gives the same values to the respective arguments:</p>\n\n<pre><code>ship -e earg -b barg \n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{\n  \"-b\": true, \n  \"-e\": true, \n  \"&lt;b_command&gt;\": \"earg\", \n  \"&lt;e_command&gt;\": \"barg\", \n  \"ship\": true\n}\n</code></pre>\n\n<p>Note that I passed earg to -e but it is assigned to b_command in the output.</p>\n\n<p>I saw the same behavior with golang's <code>docopt-go</code> package. Is my usage string wrong? If so, how should I frame the docopt usage string such that it assigns the correct values correct arguments and honors the specified arguments?</p>\n"}, {"tags": ["go", "amazon-s3", "amazon-dynamodb"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1519830794, "post_id": 49030794, "comment_id": 85070173, "body": "The two cfg types are inconsistent because their package path isn&#39;t the same, one is imported from the vendor folder, the other isn&#39;t. Try re-vendoring all your deps: delete the Test2/vendor folder and rerun then your dependency manager."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8497169"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1519838814, "post_id": 49030794, "comment_id": 85075449, "body": "How do you know that?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1519838868, "post_id": 49030794, "comment_id": 85075491, "body": "How do I know what exactly?"}], "owner": {"user_type": "does_not_exist", "display_name": "user8497169"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 217, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519824727, "creation_date": 1519824727, "question_id": 49030794, "link": "https://stackoverflow.com/questions/49030794/cant-use-cfg-type-aws-aws-sdk-go-v2-aws-config-as-type-type-in-ar", "title": "Can&#39;t use cfg (type &quot;...aws/aws-sdk-go-v2/aws&quot;.Config&quot;) as type (type ...) in argument to dynamodb.New", "body": "<p>I'm trying to create a Go program that creates a Put Pre-signed URL and saves into DynamoDB, using the SDK V2. I was able to figure it out only how to create the pre-signed url, but not how to save into DynamoDB, because the following error is happening:</p>\n\n<pre><code>./main.go:67:24: cannot use cfg (type \"Test2/vendor/github.com/aws/aws-sdk-go-v2/aws\".Config) as type \"github.com/aws/aws-sdk-go-v2/aws\".Config in argument to dynamodb.New\n</code></pre>\n\n<p>And this is the code:</p>\n\n<pre><code>package main\n\nimport (\n  \"time\"\n  // \"fmt\"\n\n  \"github.com/aws/aws-sdk-go-v2/aws\"\n  \"github.com/aws/aws-sdk-go-v2/aws/endpoints\"\n  \"github.com/aws/aws-sdk-go-v2/aws/external\"\n  \"github.com/aws/aws-sdk-go-v2/service/dynamodb\"\n  \"github.com/aws/aws-sdk-go-v2/service/s3\"\n  \"github.com/kelseyhightower/envconfig\"\n\n)\n\n\ntype Bucket struct {\n  Name string\n}\n\n// Using the SDK's default configuration, loading additional config\n// and credentials values from the environment variables, shared\n// credentials, and shared configuration files\nvar cfg, err = external.LoadDefaultAWSConfig()\n\n// Description\nvar bucket Bucket\n\nfunc main() {\n    err = envconfig.Process(\"bucket\", &amp;bucket)\n    if err != nil {\n        panic(err.Error())\n    } else if len(cfg.Region) &gt; 0 {\n        // Set Region to us-east-1 as default.\n        cfg.Region = endpoints.UsEast1RegionID\n    }\n\n    url, err := createPresignedPutURL()\n    if err != nil {\n        panic(err.Error())\n    }\n\n    _, err = createNewExtraction(url)\n    if err != nil {\n        panic(err.Error())\n    }\n}\n\nfunc createPresignedPutURL() (string, error) {\n    svc := s3.New(cfg)\n    req := svc.PutObjectRequest(&amp;s3.PutObjectInput{\n        Bucket: aws.String(\"garimpo-extractions\"),\n        Key: aws.String(\"uuid\"),\n    })\n\n    url, _, err := req.PresignRequest(15 * time.Minute)\n    if err != nil {\n        panic(err)\n    }\n    return url, nil\n}\n\nfunc createNewExtraction(url string) (string, error) {\n    svc := dynamodb.New(cfg) // ERROR IS HERE\n    return \"\", nil\n    // req := svc.ScanRequest(&amp;dynamodb.ScanInput{\n    //     TableName: aws.String(\"extractions-development\"),\n    // })\n\n    // // // Fire request with req.Send().\n    // res, err := req.Send(); if err != nil {\n    //     return \"\", err\n    // }\n    // return res, nil\n}\n</code></pre>\n\n<p>I'm not really understanding what is going on. I'm using the <code>cfg</code> to create a connection to s3, and is working, but when I try to create a connection with DynamoDB, it fails.</p>\n"}, {"tags": ["go", "compilation", "g++"], "answers": [{"tags": [], "owner": {"reputation": 1721, "user_id": 3625217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e04c2f250002971ff233b86a0e25354?s=128&d=identicon&r=PG", "display_name": "Jess&#233; Catrinck", "link": "https://stackoverflow.com/users/3625217/jess%c3%a9-catrinck"}, "is_accepted": false, "score": 2, "last_activity_date": 1519818619, "creation_date": 1519818619, "answer_id": 49028898, "question_id": 49028743, "link": "https://stackoverflow.com/questions/49028743/use-shell-variable-value-in-compile-time-with-go-build-command/49028898#49028898", "title": "Use shell variable value in compile-time with &quot;go build&quot; command", "body": "<p>main.go</p>\n\n<pre><code>package main\n\nvar YOUR_VARIABLE = \"\"\n\nfunc main() {}\n</code></pre>\n\n<p>Shell command: <code>go build -ldflags \"-X main.YOUR_VARIABLE=$your_variable\" main.go</code></p>\n"}], "owner": {"reputation": 2193, "user_id": 5512095, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/58e730dd5510436d080bb145d452a2e6?s=128&d=identicon&r=PG&f=1", "display_name": "Denis Sheremet", "link": "https://stackoverflow.com/users/5512095/denis-sheremet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "closed_date": 1519821749, "answer_count": 1, "score": 1, "last_activity_date": 1519818619, "creation_date": 1519818091, "question_id": 49028743, "link": "https://stackoverflow.com/questions/49028743/use-shell-variable-value-in-compile-time-with-go-build-command", "closed_reason": "Duplicate", "title": "Use shell variable value in compile-time with &quot;go build&quot; command", "body": "<p>I'm building Golang project on gitlab CI and I'd like to pass <code>$CI_COMMIT_TAG</code> value to compiler. With <code>g++</code> it would be something like <code>g++ -DCI_COMMIT_TAG=$CI_COMMIT_TAG ...</code>. Is there anything simillar for <code>go build</code> command?</p>\n"}, {"tags": ["go", "constants"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1519819012, "last_edit_date": 1519819012, "creation_date": 1519817992, "answer_id": 49028713, "question_id": 49028654, "link": "https://stackoverflow.com/questions/49028654/initialize-const-variable/49028713#49028713", "title": "Initialize const variable", "body": "<p>Constant declarations cannot contain function calls (with some exceptions, see below), they must be evaluated at compile time while a function call is carried out at runtime.</p>\n\n<p>Quoting from <a href=\"https://golang.org/ref/spec#Constants\" rel=\"noreferrer\">Spec: Constants:</a></p>\n\n<blockquote>\n  <p>A constant value is represented by a <a href=\"https://golang.org/ref/spec#Rune_literals\" rel=\"noreferrer\">rune</a>, <a href=\"https://golang.org/ref/spec#Integer_literals\" rel=\"noreferrer\">integer</a>, <a href=\"https://golang.org/ref/spec#Floating-point_literals\" rel=\"noreferrer\">floating-point</a>, <a href=\"https://golang.org/ref/spec#Imaginary_literals\" rel=\"noreferrer\">imaginary</a>, or <a href=\"https://golang.org/ref/spec#String_literals\" rel=\"noreferrer\">string</a> literal, an identifier denoting a constant, a <a href=\"https://golang.org/ref/spec#Constant_expressions\" rel=\"noreferrer\">constant expression</a>, a <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">conversion</a> with a result that is a constant, or the result value of some built-in functions such as <code>unsafe.Sizeof</code> applied to any value, <code>cap</code> or <code>len</code> applied to <a href=\"https://golang.org/ref/spec#Length_and_capacity\" rel=\"noreferrer\">some expressions</a>, <code>real</code> and <code>imag</code> applied to a <code>complex</code> constant and complex applied to numeric constants.</p>\n</blockquote>\n\n<p>And quoting from <a href=\"http://Constant%20expressions%20may%20contain%20only%20constant%20operands%20and%20are%20evaluated%20at%20compile%20time.\" rel=\"noreferrer\">Spec: Constant expressions:</a></p>\n\n<blockquote>\n  <p>Constant expressions may contain only <a href=\"https://golang.org/ref/spec#Constants\" rel=\"noreferrer\">constant</a> operands and are <strong>evaluated at compile time</strong>.</p>\n</blockquote>\n\n<p>Note that there is a small set of (builtin) functions that may be called in constant declarations such as <code>unsafe.Sizeof()</code>, but generally you can't do that.</p>\n\n<p>So just use</p>\n\n<pre><code>const Kilo = 1000  // Integer literal\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>const Kilo = 1e3   // Floating-point literal\n</code></pre>\n\n<p>For an extensive introduction to Go constants, read blog post: <a href=\"https://blog.golang.org/constants\" rel=\"noreferrer\">Constants</a></p>\n\n<p>If for some reason you do need to call a function, you cannot store it in a constant, it must be a <a href=\"https://golang.org/ref/spec#Variables\" rel=\"noreferrer\">variable</a>, e.g.:</p>\n\n<pre><code>var Kilo = math.Pow10(3)\n</code></pre>\n\n<p>Also see related <a href=\"https://stackoverflow.com/questions/34124294/writing-powers-of-10-as-constants-compactly/34145667#34145667\">Writing powers of 10 as constants compactly</a>.</p>\n"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6324, "favorite_count": 0, "accepted_answer_id": 49028713, "answer_count": 1, "score": 8, "last_activity_date": 1519819012, "creation_date": 1519817770, "last_edit_date": 1519818916, "question_id": 49028654, "link": "https://stackoverflow.com/questions/49028654/initialize-const-variable", "title": "Initialize const variable", "body": "<p>How can I initialize <code>KILO</code> variable with <code>const</code> type?</p>\n\n<pre><code>const KILO = math.Pow10(3)\n</code></pre>\n\n<p>Because I have an errror</p>\n\n<pre><code>const initializer math.Pow10(3) is not a constant\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 178, "user_id": 1367644, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f13449555c3fbc245cda582fe0464f5?s=128&d=identicon&r=PG", "display_name": "lesovsky", "link": "https://stackoverflow.com/users/1367644/lesovsky"}, "edited": false, "score": 0, "creation_date": 1519817138, "post_id": 49028407, "comment_id": 85061086, "body": "Pager can be invoked with space shortcut."}, {"owner": {"reputation": 178, "user_id": 1367644, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f13449555c3fbc245cda582fe0464f5?s=128&d=identicon&r=PG", "display_name": "lesovsky", "link": "https://stackoverflow.com/users/1367644/lesovsky"}, "edited": false, "score": 0, "creation_date": 1520743125, "post_id": 49028407, "comment_id": 85437407, "body": "I&#39;ve solved it with wrapping gui creating functions into loop. Before executing 3rd party program I stop gui with g.Close(). When 3rd party program ends, gui loop new iteration starts and gui is restored. The similar <a href=\"https://github.com/rivo/tview/issues/70\" rel=\"nofollow noreferrer\">behavior</a> can be achieved with <a href=\"https://github.com/rivo/tview\" rel=\"nofollow noreferrer\">rivo/tview</a> package."}], "answers": [{"tags": [], "owner": {"reputation": 178, "user_id": 1367644, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f13449555c3fbc245cda582fe0464f5?s=128&d=identicon&r=PG", "display_name": "lesovsky", "link": "https://stackoverflow.com/users/1367644/lesovsky"}, "is_accepted": true, "score": 0, "last_activity_date": 1520743535, "creation_date": 1520743535, "answer_id": 49216714, "question_id": 49028407, "link": "https://stackoverflow.com/questions/49028407/gocui-breaks-after-pager-program/49216714#49216714", "title": "Gocui breaks after pager program", "body": "<p>Final example is below, it has additional things and in some places looks dirty, but it works in general.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os/exec\"\n    \"os\"\n    \"github.com/jroimartin/gocui\"\n    \"time\"\n    \"sync\"\n)\n\nvar (\n    do_quit = make(chan int)\n    do_pause = make(chan int)\n    show_aux = false\n    wg  sync.WaitGroup\n)\n\nfunc main() {\n    for {\n        // DEBUG: fmt.Println(\"start gui\")\n\n        g, err := gocui.NewGui(gocui.OutputNormal)\n        if err != nil {\n            log.Panicln(err)\n        }\n        defer g.Close()\n\n        g.SetManagerFunc(layout)\n        setKeys(g)\n\n        wg.Add(1)\n        go showTime(g)\n\n        if err := g.MainLoop(); err != nil &amp;&amp; err != gocui.ErrQuit {\n            continue        // restart gui if something goes wrong\n        }\n        wg.Wait()\n    }\n}\n\n\nfunc layout(g *gocui.Gui) error {\n    maxX, _ := g.Size()\n\n    if v, err := g.SetView(\"main\", -1, -1, maxX/2-1, 4); err != nil {\n        if err != gocui.ErrUnknownView {\n            return err\n        }\n        fmt.Fprintf(v, \"sys: %s\\n\", time.Now().Format(\"2006-01-02 15:04:05.000\"))\n        v.Frame = false\n    }\n\n    return nil\n}\n\nfunc runPager(g *gocui.Gui, v *gocui.View) error {\n    do_quit &lt;-1\n    g.Close()\n    cmd := exec.Command(\"less\", \"/etc/sysctl.conf\")\n    cmd.Stdout = os.Stdout\n    err := cmd.Run()\n\n    return err\n}\n\nfunc runEditor(g *gocui.Gui, v *gocui.View) error {\n    do_quit &lt;-1\n    g.Close()\n    cmd := exec.Command(\"vi\", \"/tmp/strace.out\")\n    cmd.Stdin = os.Stdin\n    cmd.Stdout = os.Stdout\n    err := cmd.Run()\n\n    return err\n}\n\nfunc runPsql(g *gocui.Gui, v *gocui.View) error {\n    do_quit &lt;-1\n    g.Close()\n    cmd := exec.Command(\"psql\", \"-U\", \"postgres\")\n    cmd.Stdin = os.Stdin\n    cmd.Stdout = os.Stdout\n    err := cmd.Run()\n\n    return err\n}\n\nfunc showAux(g *gocui.Gui, _ *gocui.View) error {\n    if !show_aux {\n        maxX, maxY := g.Size()\n        if v, err := g.SetView(\"aux\", -1, 3*maxY/5-1, maxX-1, maxY-1); err != nil {\n            if err != gocui.ErrUnknownView {\n                return err\n            }\n            fmt.Fprintln(v, \"\")\n            v.Frame = false\n        }\n    } else {\n        g.DeleteView(\"aux\")\n    }\n    show_aux = !show_aux\n    return nil\n}\n\nfunc showTime(g *gocui.Gui) {\n    var pause = false\n    defer wg.Done()\n\n    for {\n        select {\n        case &lt;-do_pause:\n            pause = !pause\n        case &lt;-do_quit:\n            return\n        case &lt;-time.After(1 * time.Second):\n            if pause { continue }\n\n            g.Update(func(g *gocui.Gui) error {\n                v, err := g.View(\"main\")\n                if err != nil {\n                    return err\n                }\n                v.Clear()\n                fmt.Fprintf(v, \"sys: %s\\n\", time.Now().Format(\"2006-01-02 15:04:05.000\"))\n\n                if show_aux {\n                    v, err := g.View(\"aux\")\n                    if err != nil {\n                        return err\n                    }\n                    v.Clear()\n                    fmt.Fprintf(v, \"aux: %s\\n\", time.Now().Format(\"2006-01-02 15:04:05.000\"))\n                }\n                return nil\n            })\n        }\n    }\n}\n\nfunc doQuit(g *gocui.Gui, v *gocui.View) error {\n    do_quit &lt;- 1\n    g.Close()\n    os.Exit(0)\n    return gocui.ErrQuit\n}\n\nfunc setKeys(g *gocui.Gui) {\n    if err := g.SetKeybinding(\"\", gocui.KeyCtrlQ, gocui.ModNone, doQuit); err != nil {\n        log.Panicln(err)\n    }\n    if err := g.SetKeybinding(\"\", 'c', gocui.ModNone, runPager); err != nil {\n        log.Panicln(err)\n    }\n    if err := g.SetKeybinding(\"\", 'e', gocui.ModNone, runEditor); err != nil {\n        log.Panicln(err)\n    }\n    if err := g.SetKeybinding(\"\", 'p', gocui.ModNone, runPsql); err != nil {\n        log.Panicln(err)\n    }\n    if err := g.SetKeybinding(\"\", 'b', gocui.ModNone, showAux); err != nil {\n        log.Panicln(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 178, "user_id": 1367644, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f13449555c3fbc245cda582fe0464f5?s=128&d=identicon&r=PG", "display_name": "lesovsky", "link": "https://stackoverflow.com/users/1367644/lesovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 1, "accepted_answer_id": 49216714, "answer_count": 1, "score": 1, "last_activity_date": 1520743535, "creation_date": 1519816966, "last_edit_date": 1519821734, "question_id": 49028407, "link": "https://stackoverflow.com/questions/49028407/gocui-breaks-after-pager-program", "title": "Gocui breaks after pager program", "body": "<p>I have a program based on the <a href=\"https://github.com/jroimartin/gocui\" rel=\"nofollow noreferrer\">gocui</a> library, which has a keybinding with a function which generates text and sends it to the pager's stdin. But after closing the pager, all previous gocui interface becomes broken, but program is still working.</p>\n\n<p>So how can I safely return from pager to the gocui mode and continue the program?</p>\n\n<p>Simplified example, <a href=\"https://gist.github.com/lesovsky/84fc926b779f6533d15b0988e287df64\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os/exec\"\n    \"os\"\n    \"strings\"\n    \"github.com/jroimartin/gocui\"\n    \"time\"\n    \"sync\"\n    \"bytes\"\n)\n\nvar (\n    done = make(chan struct{})\n    wg  sync.WaitGroup\n)\n\nfunc main() {\n    g, err := gocui.NewGui(gocui.OutputNormal)\n    if err != nil {\n        log.Panicln(err)\n    }\n    defer g.Close()\n\n    g.SetManagerFunc(layout)\n\n    if err := g.SetKeybinding(\"\", gocui.KeyCtrlC, gocui.ModNone, quit); err != nil {\n        log.Panicln(err)\n    }\n    if err := g.SetKeybinding(\"\", gocui.KeySpace, gocui.ModNone, pager); err != nil {\n        log.Panicln(err)\n    }\n\n    wg.Add(1)\n    go showTime(g)\n\n    if err := g.MainLoop(); err != nil &amp;&amp; err != gocui.ErrQuit {\n        log.Panicln(err)\n    }\n\n    wg.Wait()\n}\n\nfunc layout(g *gocui.Gui) error {\n    maxX, _ := g.Size()\n        if v, err := g.SetView(\"main\", -1, -1, maxX/2-1, 4); err != nil {\n        if err != gocui.ErrUnknownView {\n            return err\n        }\n        fmt.Fprintln(v, time.Now().Format(\"2006-01-02 15:04:05.000\"))\n        v.Frame = false\n    }\n\n    return nil\n}\n\nfunc pager(g *gocui.Gui, v *gocui.View) error {\n    var buf bytes.Buffer\n    for i:=0; i &lt; 10; i++ {\n        buf.WriteString(fmt.Sprintf(\"%d -- %s %s\\n\", i, \"example\", \"text\"))\n    }\n\n    cmd := exec.Command(\"less\")\n    cmd.Stdin = strings.NewReader(buf.String())\n    cmd.Stdout = os.Stdout\n    err := cmd.Run()\n\n    return err\n}\n\nfunc showTime(g *gocui.Gui) {\n    defer wg.Done()\n\n    for {\n        select {\n        case &lt;-done:\n            return\n        case &lt;-time.After(1 * time.Second):\n            t := time.Now()\n\n            g.Update(func(g *gocui.Gui) error {\n                v, err := g.View(\"main\")\n                if err != nil {\n                    return err\n                }\n                v.Clear()\n                fmt.Fprintln(v, t.Format(\"2006-01-02 15:04:05.000\"))\n                return nil\n            })\n        }\n    }\n}\n\nfunc quit(g *gocui.Gui, v *gocui.View) error {\n    return gocui.ErrQuit\n}\n</code></pre>\n"}, {"tags": ["go", "httphandler"], "comments": [{"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 1, "creation_date": 1519838023, "post_id": 49025811, "comment_id": 85074957, "body": "Read <a href=\"https://golang.org/doc/articles/wiki/#tmp_12\" rel=\"nofollow noreferrer\">Writing Web Applications: Introducing Function Literals and Closures</a> on the official Go blog, if you haven&#39;t yet"}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 7, "last_activity_date": 1519809581, "creation_date": 1519809581, "answer_id": 49025911, "question_id": 49025811, "link": "https://stackoverflow.com/questions/49025811/http-handler-function/49025911#49025911", "title": "HTTP handler function", "body": "<p>Returning an anonymous function is the only way to work with handlers that require additional arguments, by returning a closure. Example:</p>\n\n<pre><code>func fooHandler(db *someDatabase) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        // do something with `db` variable\n    }\n}\n</code></pre>\n\n<p>Otherwise, there's typically no practical difference between the approaches.  One may choose to use the anonymous function universally for consistency.</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 10, "last_activity_date": 1519826888, "creation_date": 1519826888, "answer_id": 49031472, "question_id": 49025811, "link": "https://stackoverflow.com/questions/49025811/http-handler-function/49031472#49031472", "title": "HTTP handler function", "body": "<p>Pattern</p>\n\n<pre><code>func Middleware(next http.Handler) http.Handler{\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    // Do something\n    next.ServeHTTP(w, r)\n  })\n}\n</code></pre>\n\n<p>often used to construct middleware chain like</p>\n\n<pre><code>http.Handle(\"/\", middlewareOne(middlewareTwo(finalHandler)))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 484, "user_id": 8628159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0635a91a7a6d2320001909da60e657f?s=128&d=identicon&r=PG&f=1", "display_name": "Olegs", "link": "https://stackoverflow.com/users/8628159/olegs"}, "is_accepted": false, "score": 2, "last_activity_date": 1589020121, "last_edit_date": 1589020121, "creation_date": 1589019788, "answer_id": 61695178, "question_id": 49025811, "link": "https://stackoverflow.com/questions/49025811/http-handler-function/61695178#61695178", "title": "HTTP handler function", "body": "<p>One of the most popular source of information about structure returning anonymous functions is a blog post from Mat Ryer <a href=\"https://pace.dev/blog/2018/05/09/how-I-write-http-services-after-eight-years.html\" rel=\"nofollow noreferrer\">How I write HTTP services after eight years</a></p>\n\n<p>I sure it will be good to provide some quotes from his article here:</p>\n\n<blockquote>\n  <p>... handler functions don\u2019t actually handle the requests, they return a function that does. This gives us a closure environment in which our handler can operate:</p>\n</blockquote>\n\n<pre><code>func (s *server) handleSomething() http.HandlerFunc {\n    thing := prepareThing()\n    return func(w http.ResponseWriter, r *http.Request) {\n        // use thing        \n    }\n}\n</code></pre>\n\n<blockquote>\n  <p>The prepareThing is called only once, so you can use it to do one-time\n  per-handler initialisation, and then use the thing in the handler.</p>\n</blockquote>\n\n<p>Also, </p>\n\n<blockquote>\n  <p>If an endpoint has its own request and response types, usually they\u2019re only useful for that particular handler. If that\u2019s the case, you can define them inside the function.</p>\n</blockquote>\n\n<pre><code>func (s *server) handleSomething() http.HandlerFunc {\n\n  // you have these handy structs always visible to your handler and eyes \n  // and invisible to code that don't use them\n\n  type request struct {\n    Name string\n  }\n\n  type response struct {\n    Greeting string `json:\"greeting\"`\n  }\n\n  return func(w http.ResponseWriter, r *http.Request) {\n    // decode into request struct\n    // validate\n    // call business-logic \n    // encode response from business-logic into response struct \n\n  }\n</code></pre>\n\n<p>}</p>\n\n<p>In practice, writing RESTy APIs you have handler named after resource, e.g. you have /maps resource and appropriate handler struct mapsHandler with injected dependencies (repositories, services containing some business-logic, loggers) into it. But sometimes you will also need to pass an additional dependency exclusively per one handle and suddenly realized that handler has strict signature, so you should wrap it. Then you have something like this </p>\n\n<pre><code>// RESTy routes for \"maps\" resource\nrouter.Route(\"/maps\", func(r chi.Router) {\n    adHocDependency := newAdHocDependency(options)\n    r.Post(\"/\", mapsHandler.handleCreateMap(adHocDependency))\n})\n</code></pre>\n\n<p>making your ad hoc dependency visible to your handler.</p>\n\n<p>Hope it helps!</p>\n"}], "owner": {"reputation": 233, "user_id": 7893198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91639ade70c5fc21ded9450808e3c97c?s=128&d=identicon&r=PG&f=1", "display_name": "blue panther", "link": "https://stackoverflow.com/users/7893198/blue-panther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5700, "favorite_count": 3, "answer_count": 3, "score": 4, "last_activity_date": 1598689954, "creation_date": 1519809222, "last_edit_date": 1598689954, "question_id": 49025811, "link": "https://stackoverflow.com/questions/49025811/http-handler-function", "title": "HTTP handler function", "body": "<p>I saw some http handler function declarations are varied.\nTwo of them I found are the standard function and the one returning anonymous function inside the handler. \nFor example:</p>\n\n<p>Using standard way:</p>\n\n<pre><code>func helloworld(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintln(w, \"Hello World\")\n}\n</code></pre>\n\n<p>This the most straight way to declare a handler for an http api.</p>\n\n<p>Another way is using anonym/closure function inside the handler function:</p>\n\n<pre><code>func helloworld2() http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request){\n        fmt.Fprintln(w, \"Hello World\")\n    })\n}\n</code></pre>\n\n<p>What are the differences and the benefit? When to use one of them? What's the best practice?</p>\n"}, {"tags": ["go", "ginkgo"], "answers": [{"tags": [], "owner": {"reputation": 4354, "user_id": 1806005, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ee889ac6797f1f23ebb955164162bd39?s=128&d=identicon&r=PG", "display_name": "freakman", "link": "https://stackoverflow.com/users/1806005/freakman"}, "is_accepted": false, "score": 0, "last_activity_date": 1519822096, "creation_date": 1519822096, "answer_id": 49029973, "question_id": 49024373, "link": "https://stackoverflow.com/questions/49024373/how-to-write-test-case-in-multiple-test-file-using-ginkgo/49029973#49029973", "title": "How to write test case in multiple test file using ginkgo?", "body": "<p>run</p>\n\n<pre><code>go test ./...\n</code></pre>\n\n<p>from root of your project, it will run all your tests. With ginkgo you need this suite file, but go test command will grab it and run it.</p>\n"}], "owner": {"reputation": 865, "user_id": 6531048, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/84f0d4d7f17634a8c71d98a9953bd95a?s=128&d=identicon&r=PG&f=1", "display_name": "lext", "link": "https://stackoverflow.com/users/6531048/lext"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 637, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519822096, "creation_date": 1519803957, "question_id": 49024373, "link": "https://stackoverflow.com/questions/49024373/how-to-write-test-case-in-multiple-test-file-using-ginkgo", "title": "How to write test case in multiple test file using ginkgo?", "body": "<p>How to write test case in multiple test file using ginkgo?</p>\n\n<p>a_suite_test.go file:</p>\n\n<pre><code>func TestA(t *testing.T) {\n    RegisterFailHandler(Fail)\n    RunSpecs(t, \"A Suite\")\n}\n</code></pre>\n\n<p>a_test.go:</p>\n\n<pre><code>var _ = Describe(\"A\", func() {\n    Context(\"A\", func() {\n        It(\"A\", func() {\n            Expect(1).To(Equal(1))\n        })\n    })\n})\n</code></pre>\n\n<p>I run <code>ginkgo</code>, but error is throwed:  </p>\n\n<pre><code>Failed to compile A:\n\ngo build xxx: no non-test Go files in xxx\n</code></pre>\n\n<p>Can I write test case in other test files rather than writing in suite test file ?</p>\n"}, {"tags": ["go", "alexa", "alexa-skills-kit", "alexa-slot"], "answers": [{"comments": [{"owner": {"reputation": 2580, "user_id": 7004388, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/DCCVJ.png?s=128&g=1", "display_name": "coderpc", "link": "https://stackoverflow.com/users/7004388/coderpc"}, "edited": false, "score": 1, "creation_date": 1530647090, "post_id": 51160604, "comment_id": 89307099, "body": "This is not an answer and it is unclear. Please read <a href=\"https://stackoverflow.com/help/how-to-answer\">How do I write a good answer?</a>"}], "tags": [], "owner": {"reputation": 1, "user_id": 9426813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54405a360e464c5fc2486dc86002d2e2?s=128&d=identicon&r=PG&f=1", "display_name": "gopi", "link": "https://stackoverflow.com/users/9426813/gopi"}, "is_accepted": false, "score": 0, "last_activity_date": 1530641082, "creation_date": 1530641082, "answer_id": 51160604, "question_id": 49022585, "link": "https://stackoverflow.com/questions/49022585/in-alexa-how-do-i-define-slot-defaults-in-my-intent-code/51160604#51160604", "title": "In Alexa, how do I define slot defaults in my Intent code?", "body": "<p>As per my knowledge in response, u need to include all slots. As here the intent name and slots match then only you'll get the correct response</p>\n"}], "owner": {"reputation": 310, "user_id": 4317190, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/91ead7da4d55ff9f56f05a9a8a27bf85?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cheek", "link": "https://stackoverflow.com/users/4317190/tyler-cheek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 391, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530641082, "creation_date": 1519796019, "question_id": 49022585, "link": "https://stackoverflow.com/questions/49022585/in-alexa-how-do-i-define-slot-defaults-in-my-intent-code", "title": "In Alexa, how do I define slot defaults in my Intent code?", "body": "<p>I have one intent in my lambda function. I am trying to fill 4 slots, 3 of which are required. In my tests it seems like I have to set the Assignee field to a default or something fails in my actual handler which happens after the else statement below. Here's how I'm currently defining the defaults:</p>\n\n<p>if strings.ToUpper(request.DialogState) == \"STARTED\" {</p>\n\n<pre><code>        log.Println(\"DialogState == STARTED\")\n        // Pre-fill slots: update the intent object with slot values for which\n        // you have defaults, then return Dialog.Delegate with this updated intent\n        // in the updatedIntent property.\n        slots := make(map[string]alexa.IntentSlot)\n        slots[\"Summary\"] = alexa.IntentSlot{\n            Name:               \"Summary\",\n            Value:              \"\",\n            ConfirmationStatus: \"NONE\",\n        }\n        slots[\"TicketType\"] = alexa.IntentSlot{\n            Name:               \"TicketType\",\n            Value:              \"\",\n            ConfirmationStatus: \"NONE\",\n        }\n        slots[\"Project\"] = alexa.IntentSlot{\n            Name:               \"Project\",\n            Value:              \"\",\n            ConfirmationStatus: \"NONE\",\n        }\n        slots[\"Assignee\"] = alexa.IntentSlot{\n            Name:               \"Assignee\",\n            Value:              \"tcheek\",\n            ConfirmationStatus: \"NONE\",\n        }\n        i := &amp;alexa.Intent{\n            Name:               \"OpenTicketIntent\",\n            ConfirmationStatus: \"NONE\",\n            Slots:              slots,\n        }\n        response.AddDialogDirective(\"Dialog.Delegate\", \"\", \"\", i)\n        response.ShouldSessionEnd = false\n        log.Println(\"DialogState has exited STARTED\")\n\n    } else if strings.ToUpper(request.DialogState) != \"COMPLETED\" {\n\n        log.Println(\"DialogState == IN PROGRESS\")\n        // return a Dialog.Delegate directive with no updatedIntent property.\n        response.ShouldSessionEnd = false\n        response.AddDialogDirective(\"Dialog.Delegate\", \"\", \"\", nil)\n        log.Println(\"DialogState has exited IN PROGRESS\")\n\n    } else {\n</code></pre>\n\n<p>I have also tried setting just the Assignee field as a default, like this:</p>\n\n<pre><code>    slots := make(map[string]alexa.IntentSlot)\n\n        slots[\"Assignee\"] = alexa.IntentSlot{\n            Name:               \"Assignee\",\n            Value:              \"tcheek\",\n            ConfirmationStatus: \"NONE\",\n        }\n        i := &amp;alexa.Intent{\n            Name:               \"OpenTicketIntent\",\n            ConfirmationStatus: \"NONE\",\n            Slots:              slots,\n        }\n        response.AddDialogDirective(\"Dialog.Delegate\", \"\", \"\", i)\n</code></pre>\n\n<p>In this scenario I get the following lambda function response in the simulator:</p>\n\n<pre><code>{\n    \"body\": {\n        \"version\": \"1.0\",\n        \"response\": {\n            \"directives\": [\n                {\n                    \"type\": \"Dialog.Delegate\",\n                    \"updatedIntent\": {\n                        \"name\": \"OpenTicketIntent\",\n                        \"confirmationStatus\": \"NONE\",\n                        \"slots\": {\n                            \"Assignee\": {\n                                \"name\": \"Assignee\",\n                                \"value\": \"tcheek\",\n                                \"confirmationStatus\": \"NONE\"\n                            }\n                        }\n                    }\n                }\n            ],\n            \"shouldEndSession\": false\n        }\n    }\n}\n</code></pre>\n\n<p>The problem is that once I ask it to open a bug ticket (which maps to the intent with the \"Open a {ticketType} ticket\" utterance), it gives the response that \"There was a problem with the requested skill's response\".</p>\n\n<p>Am I wrong to think that setting defaults is necessary? Am I setting defaults incorrectly?</p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 911, "user_id": 3563197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/563e4185281840ef1792eda5d6391440?s=128&d=identicon&r=PG", "display_name": "vedhavyas", "link": "https://stackoverflow.com/users/3563197/vedhavyas"}, "edited": false, "score": 1, "creation_date": 1519794420, "post_id": 49022255, "comment_id": 85049689, "body": "<code>&lt;-done</code> in the <code>job</code> will cause deadlock because there is no sender for that channel."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 1, "creation_date": 1519794748, "post_id": 49022255, "comment_id": 85049775, "body": "For one thing, there is no child process."}, {"owner": {"reputation": 665, "user_id": 3766815, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9ca78b10df995ce958ab4b2993b732c6?s=128&d=identicon&r=PG&f=1", "display_name": "ironhyde", "link": "https://stackoverflow.com/users/3766815/ironhyde"}, "reply_to_user": {"reputation": 911, "user_id": 3563197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/563e4185281840ef1792eda5d6391440?s=128&d=identicon&r=PG", "display_name": "vedhavyas", "link": "https://stackoverflow.com/users/3563197/vedhavyas"}, "edited": false, "score": 0, "creation_date": 1519844689, "post_id": 49022255, "comment_id": 85078488, "body": "@vedhavyas Yup, I agree. My bad, I hastily summarized my code into the above code."}], "answers": [{"tags": [], "owner": {"reputation": 911, "user_id": 3563197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/563e4185281840ef1792eda5d6391440?s=128&d=identicon&r=PG", "display_name": "vedhavyas", "link": "https://stackoverflow.com/users/3563197/vedhavyas"}, "is_accepted": false, "score": 2, "last_activity_date": 1519811737, "last_edit_date": 1519811737, "creation_date": 1519794618, "answer_id": 49022368, "question_id": 49022255, "link": "https://stackoverflow.com/questions/49022255/return-after-channel-ends-parent-routine/49022368#49022368", "title": "Return after channel ends parent routine", "body": "<p>With these changes, your main will exit after the done channel</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var jobDone = make(chan bool)\n    go job(jobDone)\n    &lt;-jobDone\n}\n\nfunc job(done chan bool) {\n    for {\n        select {\n        case &lt;-someOtherGlobalChannel:\n            //Please ignore this case/channel\n            fmt.Println(\"SOmeOtherChannel received\")\n        default:\n            if check_somthing_expression {\n                done &lt;- true\n                return\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 665, "user_id": 3766815, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9ca78b10df995ce958ab4b2993b732c6?s=128&d=identicon&r=PG&f=1", "display_name": "ironhyde", "link": "https://stackoverflow.com/users/3766815/ironhyde"}, "edited": false, "score": 0, "creation_date": 1519844770, "post_id": 49024381, "comment_id": 85078527, "body": "Yup, I agree. My bad, I hastily summarized my code into the above code."}], "tags": [], "owner": {"reputation": 31, "user_id": 4679006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t8jDwg3ohCg/AAAAAAAAAAI/AAAAAAAAABE/Wc7gYOREiV4/photo.jpg?sz=128", "display_name": "Blues Melody", "link": "https://stackoverflow.com/users/4679006/blues-melody"}, "is_accepted": false, "score": 0, "last_activity_date": 1519803985, "creation_date": 1519803985, "answer_id": 49024381, "question_id": 49022255, "link": "https://stackoverflow.com/questions/49022255/return-after-channel-ends-parent-routine/49024381#49024381", "title": "Return after channel ends parent routine", "body": "<p>you need to put some bool message to your done channel,then the <code>&lt;-jobDone\n}</code> can get some message to finish the block</p>\n"}, {"tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": true, "score": 1, "last_activity_date": 1519841206, "last_edit_date": 1519841206, "creation_date": 1519830492, "answer_id": 49032705, "question_id": 49022255, "link": "https://stackoverflow.com/questions/49022255/return-after-channel-ends-parent-routine/49032705#49032705", "title": "Return after channel ends parent routine", "body": "<h1>Zombie Process</h1>\n\n<blockquote>\n  <p>\"...which would make the child process zombie\"</p>\n</blockquote>\n\n<p><code>go job()</code> does not start a separate process, it starts another goroutine.  You have a <code>main</code> goroutine, and a <code>job</code> goroutine in this program.  <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">Language spec</a>:</p>\n\n<blockquote>\n  <p>A \"go\" statement starts the execution of a function call as an independent concurrent thread of control, or goroutine, within the same address space. </p>\n</blockquote>\n\n<p>Therefore you will not be creating a Unix zombie process.</p>\n\n<h1>Main Not Exiting Before Job</h1>\n\n<blockquote>\n  <p>\"Why does this NOT happen: the main exits after it receives the done and before job return...?\"</p>\n</blockquote>\n\n<h2>Reason #1: The Receive Operations are Blocking Both Goroutines</h2>\n\n<p>(1) Because there's no send statement on channel <code>done</code> in <code>job</code>.</p>\n\n<pre><code>&lt;-done\n</code></pre>\n\n<p>is a receive operation.  See <a href=\"https://golang.org/ref/spec#Receive_operator\" rel=\"nofollow noreferrer\">\"Receive operator\" in Go spec</a>:</p>\n\n<blockquote>\n  <p>For an operand <code>ch</code> of channel type, the value of the receive operation <code>&lt;-ch</code> is the value received from the channel <code>ch</code>.</p>\n</blockquote>\n\n<p>See also <a href=\"https://golang.org/ref/spec#Send_statements\" rel=\"nofollow noreferrer\">\"Send statements\" in Go spec</a>:</p>\n\n<blockquote>\n  <p><code>ch &lt;- 3  // send value 3 to channel ch</code></p>\n</blockquote>\n\n<p>You need a send statement.  E.g.:</p>\n\n<pre><code>done &lt;- true\n</code></pre>\n\n<p>More explanatory text and examples are available in <a href=\"https://tour.golang.org/concurrency/2\" rel=\"nofollow noreferrer\">the Go Tour</a> and <a href=\"https://golang.org/doc/effective_go.html#channels\" rel=\"nofollow noreferrer\">Effective Go</a>.</p>\n\n<p>...And there's a second reason:</p>\n\n<h2>Reason #2: There's Nothing To Do Between Send and Return</h2>\n\n<p>(2) Because, even if you change the receive operation to a send statement, there's nothing to do in the job goroutine between when it sends on the channel and it returns, so it's not likely for any time to pass from one to the next.  If you want that to happen, add a sleep in job using the <a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\"><code>time</code> package</a>:</p>\n\n<pre><code>done &lt;- true\ntime.Sleep(time.Second * 30)\nreturn\n</code></pre>\n"}], "owner": {"reputation": 665, "user_id": 3766815, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9ca78b10df995ce958ab4b2993b732c6?s=128&d=identicon&r=PG&f=1", "display_name": "ironhyde", "link": "https://stackoverflow.com/users/3766815/ironhyde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 49032705, "answer_count": 3, "score": 0, "last_activity_date": 1519854102, "creation_date": 1519793977, "last_edit_date": 1519854102, "question_id": 49022255, "link": "https://stackoverflow.com/questions/49022255/return-after-channel-ends-parent-routine", "title": "Return after channel ends parent routine", "body": "<p>I have a code excerpt of a main running a go routine below. Why does this NOT happen: the main exits after it receives the done and before job return, which would make the child process zombie. Any reference to golang docs would be helpful.</p>\n\n<pre><code>func main() {\n    var jobDone = make(chan bool)\n    go job(jobDone)\n    &lt;-jobDone\n}\n\nfunc job(done chan bool) {\n    for {\n        select {\n        case &lt;-someOtherGlobalChannel:\n            //Please ignore this case/channel\n            fmt.Println(\"SOmeOtherChannel received\")\n        default:\n            if check_somthing_expression {\n                done &lt;- true\n                return\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "ldap", "openldap"], "answers": [{"tags": [], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "is_accepted": true, "score": 1, "last_activity_date": 1519912086, "last_edit_date": 1519912086, "creation_date": 1519804053, "answer_id": 49024398, "question_id": 49020540, "link": "https://stackoverflow.com/questions/49020540/go-ldap-search-for-contextcsn/49024398#49024398", "title": "Go LDAP search for ContextCSN", "body": "<p>(contextCSN) is not a filter, it should be something like (sn=%s) which you want to query</p>\n\n<p>Leave it empty or change your filter as it suits you</p>\n"}], "owner": {"reputation": 115, "user_id": 4375998, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0e2c58d2028fd7225db45f260ea908c5?s=128&d=identicon&r=PG&f=1", "display_name": "Tamwyn", "link": "https://stackoverflow.com/users/4375998/tamwyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 686, "favorite_count": 0, "accepted_answer_id": 49024398, "answer_count": 1, "score": 0, "last_activity_date": 1519912086, "creation_date": 1519780659, "last_edit_date": 1519861542, "question_id": 49020540, "link": "https://stackoverflow.com/questions/49020540/go-ldap-search-for-contextcsn", "title": "Go LDAP search for ContextCSN", "body": "<p>Good evening,\nI'm relatively new to go and try to write a function exporting the contextCSN variable from an openldap directory (analogous to <code>ldapsearch -x -s base contextCSN</code>)\nFrom the documentation <a href=\"https://godoc.org/gopkg.in/ldap.v2#Conn.Search\" rel=\"nofollow noreferrer\">of ldap.v2</a> I came up with this:</p>\n\n<pre><code>searchRequest := ldap.NewSearchRequest(\n  baseDN, // The base dn to search\n  ldap.ScopeBaseObject, ldap.NeverDerefAliases, 0, 0, false,\n  \"(contextCSN)\", // The filter to apply\n  []string{\"contextCSN\"},     // A list attributes to retrieve\n  nil,\n)\n</code></pre>\n\n<p>But it doesn't accept contextCSN as search term</p>\n\n<pre><code>LDAP Result Code 201 \"Filter Compile Error\": ldap: error parsing filter\nexit status 1\n</code></pre>\n\n<p>Is there a way to query for this value without invoking ldapsearch?</p>\n\n<p><strong>Update</strong>:\nAfter staring at the output of ldapsearch for a while I came up with this, which did solve the problem. The data is a bit ugly structured but otherwise provides what I needed:</p>\n\n<pre><code>l, err := ldap.DialTLS(\"tcp\", ldapHost, conf)\nif err != nil {\n    log.Fatal(err)\n}\ndefer l.Close()\n\nsearchRequest := ldap.NewSearchRequest(\n    baseDN, // The base dn to search\n    ldap.ScopeBaseObject, ldap.NeverDerefAliases, 0, 0, false,\n    \"(objectClass=*)\",      // The filter to apply\n    []string{\"contextCSN\"}, // A list attributes to retrieve\n    nil,\n)\n\nsr, err := l.Search(searchRequest)\nif err != nil {\n    log.Fatal(err)\n}\n\nfor _, entry := range sr.Entries {\n    for _, csn := range entry.GetAttributeValues(\"contextCSN\") {\n        ...\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "mkfifo"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1519765591, "post_id": 49017769, "comment_id": 85041003, "body": "Relevant code should be quoted in the body of the question, not linked to."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1519770085, "post_id": 49017769, "comment_id": 85043020, "body": "This could very well be a bug related to the new file poller. A POSIX fifo with no writable open FDs is supposed to return from a read immediately."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1519770490, "post_id": 49017769, "comment_id": 85043183, "body": "Yes, this is probably related to the file poller. I would submit this as a go issue, rather than here on SO."}, {"owner": {"reputation": 6332, "user_id": 76734, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/97fbce86a5bbc520450168603172cd9e?s=128&d=identicon&r=PG", "display_name": "St. John Johnson", "link": "https://stackoverflow.com/users/76734/st-john-johnson"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1519770968, "post_id": 49017769, "comment_id": 85043367, "body": "Sorry @Adrian.  Code added (made it simpler) and example output."}, {"owner": {"reputation": 6332, "user_id": 76734, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/97fbce86a5bbc520450168603172cd9e?s=128&d=identicon&r=PG", "display_name": "St. John Johnson", "link": "https://stackoverflow.com/users/76734/st-john-johnson"}, "edited": false, "score": 0, "creation_date": 1519775282, "post_id": 49017769, "comment_id": 85044759, "body": "Filed issue with <a href=\"https://github.com/golang/go/issues/24164\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/24164</a>  Will close."}], "owner": {"reputation": 6332, "user_id": 76734, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/97fbce86a5bbc520450168603172cd9e?s=128&d=identicon&r=PG", "display_name": "St. John Johnson", "link": "https://stackoverflow.com/users/76734/st-john-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519770944, "creation_date": 1519764792, "last_edit_date": 1519770944, "question_id": 49017769, "link": "https://stackoverflow.com/questions/49017769/bufio-reader-not-getting-eof-on-darwin-fifo", "title": "bufio.Reader not getting EOF on Darwin FIFO", "body": "<p>I have a GoLang package that is reading and writing from a fifo using <code>os.OpenFile</code> and <code>bufio.Reader</code>.  On Linux the reader is informed that the writer has closed the file.  However, on Darwin it never receives the EOF.</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"time\"\n)\n\n// @note This is used to get around bufio.Scanner erroring at large lines\nfunc readln(r *bufio.Reader) (string, error) {\n    var (\n        isPrefix = true\n        err      error\n        line, ln []byte\n    )\n\n    for isPrefix &amp;&amp; err == nil {\n        line, isPrefix, err = r.ReadLine()\n        ln = append(ln, line...)\n    }\n\n    return string(ln), err\n}\n\nfunc reader(filePath string) {\n    f, err := os.Open(filePath)\n    if err != nil {\n        panic(err)\n    }\n\n    reader := bufio.NewReader(f)\n    fmt.Print(\"READER &gt;&gt; created\\n\")\n\n    line, readErr := readln(reader)\n\n    for readErr == nil {\n        fmt.Printf(\"READER &gt;&gt; read 1 line: %+v\\n\", line)\n        line, readErr = readln(reader)\n    }\n\n    fmt.Printf(\"READER &gt;&gt; read finished: %+v\\n\", readErr)\n}\n\nfunc writer(filePath string) {\n    f, err := os.OpenFile(filePath, os.O_WRONLY, 0600)\n\n    fmt.Printf(\"WRITER &lt;&lt; opened: %+v|%+v\\n\", f, err)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Printf(\"WRITER &lt;&lt; encoder created\\n\")\n\n    for i := 0; i &lt; 3; i++ {\n        time.Sleep(1 * time.Second)\n        _, err = f.WriteString(fmt.Sprint(\"line\", i, \"\\n\"))\n        fmt.Printf(\"WRITER &lt;&lt; written line%d, %+v\\n\", i, err)\n    }\n\n    time.Sleep(1 * time.Second)\n    err = f.Close()\n    fmt.Printf(\"WRITER &lt;&lt; closed: %+v\\n\", err)\n}\n\nfunc main() {\n    fifo := os.Args[1]\n\n    fmt.Printf(\"STARTED %s\\n\", fifo)\n\n    go writer(fifo)\n    reader(fifo)\n\n    fmt.Print(\"ALL DONE\\n\")\n}\n</code></pre>\n\n<p><a href=\"https://github.com/stjohnjohnson/golang-eof-fifo\" rel=\"nofollow noreferrer\">Here is a repository</a> that reproduces this case.</p>\n\n<p><strong>OSX</strong></p>\n\n<pre><code>go version go1.10 darwin/amd64\nSTARTED /var/folders/k_/zdt3jb2j7gx1rnf379k_51gh0000gn/T/tmp.ksHGLSvs/fifo\nREADER &gt;&gt; created\nWRITER &lt;&lt; opened: &amp;{file:0xc42009e000}|&lt;nil&gt;\nWRITER &lt;&lt; encoder created\nWRITER &lt;&lt; written line0, &lt;nil&gt;\nREADER &gt;&gt; read 1 line: line0\nWRITER &lt;&lt; written line1, &lt;nil&gt;\nREADER &gt;&gt; read 1 line: line1\nWRITER &lt;&lt; written line2, &lt;nil&gt;\nREADER &gt;&gt; read 1 line: line2\nWRITER &lt;&lt; closed: &lt;nil&gt;\n^C\nsignal: interrupt\n</code></pre>\n\n<p><strong>Linux</strong></p>\n\n<pre><code>go version go1.10 linux/amd64\nSTARTED /tmp/tmp.6if4ZSWnZ8/fifo\nREADER &gt;&gt; created\nWRITER &lt;&lt; opened: &amp;{file:0xc42008c000}|&lt;nil&gt;\nWRITER &lt;&lt; encoder created\nWRITER &lt;&lt; written line0, &lt;nil&gt;\nREADER &gt;&gt; read 1 line: line0\nWRITER &lt;&lt; written line1, &lt;nil&gt;\nREADER &gt;&gt; read 1 line: line1\nWRITER &lt;&lt; written line2, &lt;nil&gt;\nREADER &gt;&gt; read 1 line: line2\nWRITER &lt;&lt; closed: &lt;nil&gt;\nREADER &gt;&gt; read finished: EOF\nALL DONE\n</code></pre>\n\n<p>Is this the right way to indicate to the reader that writer has finished?</p>\n"}, {"tags": ["go", "imap"], "comments": [{"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1519767558, "post_id": 49017250, "comment_id": 85041880, "body": "I don&#39;t have access to test it but I see in documentation that <a href=\"https://github.com/emersion/go-imap/blob/db2527e3b3931fbb4b4e650165816f3570f73875/client/cmd_selected.go#L179\" rel=\"nofollow noreferrer\">github.com/emersion/go-imap/blob/&hellip;</a> that they say, flags works only when <code>item</code> equal <code>FLAGS</code>."}, {"owner": {"reputation": 191, "user_id": 3566647, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wVj86.jpg?s=128&g=1", "display_name": "freitas", "link": "https://stackoverflow.com/users/3566647/freitas"}, "reply_to_user": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1519819645, "post_id": 49017250, "comment_id": 85062541, "body": "@ttomalak I didn&#39;t understand what can be wrong.  I also edited the post to have the complete code"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8770837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d677f9aef5c433d805d69b9d7b832f4a?s=128&d=identicon&r=PG&f=1", "display_name": "je123c", "link": "https://stackoverflow.com/users/8770837/je123c"}, "is_accepted": false, "score": 0, "last_activity_date": 1528778075, "last_edit_date": 1528778075, "creation_date": 1528777729, "answer_id": 50809260, "question_id": 49017250, "link": "https://stackoverflow.com/questions/49017250/emersion-go-imap-mark-message-as-seen/50809260#50809260", "title": "emersion/go-imap - Mark message as seen", "body": "<p>modify the following line by changing true to false</p>\n\n<p>mailbox, erro := serverGmail.cliente.Select(label, true)</p>\n\n<p>once you've done this, when the message is fetched (using the UidFetch), it will be automatically marked to \"Seen\"</p>\n"}], "owner": {"reputation": 191, "user_id": 3566647, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wVj86.jpg?s=128&g=1", "display_name": "freitas", "link": "https://stackoverflow.com/users/3566647/freitas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528778075, "creation_date": 1519762707, "last_edit_date": 1519818734, "question_id": 49017250, "link": "https://stackoverflow.com/questions/49017250/emersion-go-imap-mark-message-as-seen", "title": "emersion/go-imap - Mark message as seen", "body": "<p>I'm trying to mark messages as seen using this IMAP protocol implementation but It's not working as intended.</p>\n\n<p>I have a function that prints unseen messages and my intention is that by the end, it mark each message as seen.</p>\n\n<pre><code>package main\n\nimport (\n    \"emailmonitor/util\"\n    \"fmt\"\n)\n\nfunc main() {\n\n    serverGmail := util.NewServerGmail()\n\n    serverGmail.Connect()\n    serverGmail.Login()\n    serverGmail.ListUnseenMessages()\n\n}\n\n//-----------------------------------------\n\npackage util\n\nimport (\n    \"io/ioutil\"\n    \"log\"\n    \"net/mail\"\n    \"net/smtp\"\n\n    imap \"github.com/emersion/go-imap\"\n    \"github.com/emersion/go-imap/client\"\n)\n\ntype ServerGmail struct {\n    user    string\n    pass    string\n    erro    string\n    cliente *client.Client\n}\n\nfunc NewServerGmail() *ServerGmail {\n    serverGmail := &amp;ServerGmail{}\n    serverGmail.user = \"xxxxxx@gmail.com\"\n    serverGmail.pass = \"xxxxx\"\n    serverGmail.erro = \"\"\n\n    return serverGmail\n}\n\nfunc (serverGmail *ServerGmail) Connect() {\n    // Connect to server\n    cliente, erro := client.DialTLS(\"smtp.gmail.com:993\", nil)\n    if erro != nil {\n        serverGmail.erro = erro.Error()\n    }\n    log.Println(\"Connected\")\n\n    serverGmail.cliente = cliente\n\n}\n\nfunc (serverGmail *ServerGmail) Login() {\n    // Login\n    if erro := serverGmail.cliente.Login(serverGmail.user, serverGmail.pass); erro != nil {\n        serverGmail.erro = erro.Error()\n    }\n    log.Println(\"Logged\")\n\n}\n\nfunc (serverGmail *ServerGmail) setLabelBox(label string) *imap.MailboxStatus {\n    mailbox, erro := serverGmail.cliente.Select(label, true)\n    if erro != nil {\n        serverGmail.erro = erro.Error()\n    }\n    return mailbox\n}\n\nfunc (serverGmail *ServerGmail) ListUnseenMessages() {\n    // set mailbox to INBOX\n    serverGmail.setLabelBox(\"INBOX\")\n    // criteria to search for unseen messages\n    criteria := imap.NewSearchCriteria()\n    criteria.WithoutFlags = []string{\"\\\\Seen\"}\n\n    uids, err := serverGmail.cliente.UidSearch(criteria)\n    if err != nil {\n        log.Println(err)\n    }\n    seqSet := new(imap.SeqSet)\n    seqSet.AddNum(uids...)\n    section := &amp;imap.BodySectionName{}\n    items := []imap.FetchItem{imap.FetchEnvelope, imap.FetchFlags, imap.FetchInternalDate, section.FetchItem()}\n    messages := make(chan *imap.Message)\n    go func() {\n        if err := serverGmail.cliente.UidFetch(seqSet, items, messages); err != nil {\n            log.Fatal(err)\n        }\n    }()\n\n    for message := range messages {\n\n        log.Println(message.Uid)\n\n        if message == nil {\n            log.Fatal(\"Server didn't returned message\")\n        }\n\n        r := message.GetBody(section)\n        if r == nil {\n            log.Fatal(\"Server didn't returned message body\")\n        }\n\n        // Create a new mail reader\n        mr, err := mail.CreateReader(r)\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        // Print some info about the message\n        header := mr.Header\n\n        if date, err := header.Date(); err == nil {\n            log.Println(\"Date:\", date)\n        }\n        if from, err := header.AddressList(\"From\"); err == nil {\n            log.Println(\"From:\", from)\n        }\n        if to, err := header.AddressList(\"To\"); err == nil {\n            log.Println(\"To:\", to)\n        }\n        if subject, err := header.Subject(); err == nil {\n            log.Println(\"Subject:\", subject)\n        }\n\n// MARK \"SEEN\" ------- STARTS HERE  ---------\n\n        seqSet.Clear()\n        seqSet.AddNum(message.Uid)\n        item := imap.FormatFlagsOp(imap.AddFlags, true)\n        flags := []interface{}{imap.SeenFlag}\n        erro := serverGmail.cliente.UidStore(seqSet, item, flags, nil)\n        if erro != nil {\n            panic(\"error!\")\n        }\n\n    }\n\n}\n</code></pre>\n\n<p>Link from Documentation: <a href=\"https://godoc.org/github.com/emersion/go-imap/client#Client.UidStore\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/emersion/go-imap/client#Client.UidStore</a>\nTried to do something similar to Store example.</p>\n\n<p>What can be done to fix it?</p>\n"}, {"tags": ["go", "pipe"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1519762719, "post_id": 49017173, "comment_id": 85039488, "body": "What exactly is the problem with your code and in what way do you want to improve it?"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1519763415, "post_id": 49017173, "comment_id": 85039834, "body": "If <code>fmt.Sprintf</code> results in the desired output, there is no problem!"}, {"owner": {"reputation": 178, "user_id": 1367644, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f13449555c3fbc245cda582fe0464f5?s=128&d=identicon&r=PG", "display_name": "lesovsky", "link": "https://stackoverflow.com/users/1367644/lesovsky"}, "edited": false, "score": 0, "creation_date": 1519792389, "post_id": 49017173, "comment_id": 85049113, "body": "I think used way is not performance-wise and Golang must have something better than that ))))"}], "answers": [{"comments": [{"owner": {"reputation": 178, "user_id": 1367644, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f13449555c3fbc245cda582fe0464f5?s=128&d=identicon&r=PG", "display_name": "lesovsky", "link": "https://stackoverflow.com/users/1367644/lesovsky"}, "edited": false, "score": 0, "creation_date": 1519792286, "post_id": 49017524, "comment_id": 85049094, "body": "Interesting how fast is string builder work relatively to other concatenations ways? Anyway bytes.Buffer and strings.Builder look preferred."}, {"owner": {"reputation": 178, "user_id": 1367644, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f13449555c3fbc245cda582fe0464f5?s=128&d=identicon&r=PG", "display_name": "lesovsky", "link": "https://stackoverflow.com/users/1367644/lesovsky"}, "edited": false, "score": 0, "creation_date": 1519800532, "post_id": 49017524, "comment_id": 85051714, "body": "&quot;cmd.Stdin = buf&quot; is wrong, because of cannot use buf (type bytes.Buffer) as type io.Reader in assignment:         bytes.Buffer does not implement io.Reader (Read method has pointer receiver)"}, {"owner": {"reputation": 178, "user_id": 1367644, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f13449555c3fbc245cda582fe0464f5?s=128&d=identicon&r=PG", "display_name": "lesovsky", "link": "https://stackoverflow.com/users/1367644/lesovsky"}, "edited": false, "score": 0, "creation_date": 1519801571, "post_id": 49017524, "comment_id": 85052194, "body": "everything ok with <code>cmd.Stdin = strings.NewReader(buf.String())</code> and strings.Builder"}], "tags": [], "owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "is_accepted": true, "score": 0, "last_activity_date": 1519811781, "last_edit_date": 1519811781, "creation_date": 1519763842, "answer_id": 49017524, "question_id": 49017173, "link": "https://stackoverflow.com/questions/49017173/is-there-a-more-efficient-way-to-concatenate-strings/49017524#49017524", "title": "Is there a more efficient way to concatenate strings?", "body": "<p>Strings in Go are immutable and every time when you assign a new value to a variable it must create a new string and copy contents of existing one to it.</p>\n\n<p>You can use <code>bytes.Buffer</code> instead of <code>string</code> to avoid recreation on each iteration.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"database/sql\"\n    _ \"github.com/lib/pq\"\n    \"log\"\n    \"os/exec\"\n    \"strings\"\n    \"os\"\n    \"bytes\"\n)\n\nfunc main() {\n    connstr := \"user=postgres dbname=postgres sslmode=disable\"\n    db, err := sql.Open(\"postgres\", connstr)\n    if err != nil { log.Fatal(err) }\n\n    rows, err := db.Query(\"SELECT schemaname, relname, seq_scan FROM pg_stat_all_tables ORDER BY 1 LIMIT 10\")\n    if err != nil { log.Fatal(err) }\n    defer rows.Close()\n\n    var buf = new(bytes.Buffer)\n    for rows.Next() {\n        var s, r string\n        var ss int\n        if err := rows.Scan(&amp;s, &amp;r, &amp;ss); err != nil { log.Fatal(err) }\n        buf.WriteString(fmt.Sprintf(\"%s %s %d\\n\", s, r, ss))\n    }\n\n    cmd := exec.Command(\"less\")\n    cmd.Stdin = buf\n    cmd.Stdout = os.Stdout\n\n    err = cmd.Run()\n    if err != nil { log.Fatal(err) }\n}\n</code></pre>\n\n<p>Btw, the string builder was added in Go 1.10 <a href=\"https://godoc.org/strings#Builder\" rel=\"nofollow noreferrer\">https://godoc.org/strings#Builder</a></p>\n\n<p>Read more about string concatenation benchmarks: <a href=\"http://herman.asia/efficient-string-concatenation-in-go\" rel=\"nofollow noreferrer\">http://herman.asia/efficient-string-concatenation-in-go</a></p>\n"}, {"comments": [{"owner": {"reputation": 178, "user_id": 1367644, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f13449555c3fbc245cda582fe0464f5?s=128&d=identicon&r=PG", "display_name": "lesovsky", "link": "https://stackoverflow.com/users/1367644/lesovsky"}, "edited": false, "score": 0, "creation_date": 1519792077, "post_id": 49017711, "comment_id": 85049034, "body": "yes, that is why I wrote here... concatenation with &quot;+&quot; looks suspicious, and due to I&#39;m newbie I simply don&#39;t know language details and thought Golang should have more beautiful ways to concatenate strings."}], "tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": false, "score": 0, "last_activity_date": 1519766059, "last_edit_date": 1519766059, "creation_date": 1519764535, "answer_id": 49017711, "question_id": 49017173, "link": "https://stackoverflow.com/questions/49017173/is-there-a-more-efficient-way-to-concatenate-strings/49017711#49017711", "title": "Is there a more efficient way to concatenate strings?", "body": "<p>The only problem with what you're doing now is that the concatenation operator <code>+</code> is an extremely inefficient way to combine a lot of strings into one bigger string.</p>\n\n<p>How inefficient?  Well <a href=\"https://johnrefior.com/gobits/read?post=10\" rel=\"nofollow noreferrer\">here's a benchmark I did</a> testing three approaches:</p>\n\n<pre><code>BenchmarkMultiplyBasic                    300000              4240 ns/op\nBenchmarkMultiplyJoinBasic                200000              9942 ns/op\nBenchmarkMultiplyConcatenationsBasic       10000            170523 ns/op\n</code></pre>\n\n<p>The last one is the concatenate operator <code>+</code> and shows truly miserable performance compared to a couple alternatives.</p>\n\n<p>Here's one approach that will be more efficient, in a simplified runnable example:</p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n    \"strconv\"\n    \"strings\"\n)\n\ntype result struct {\n    s, r        string\n    ss          int\n}\n\nfunc main() {\n    a := []result{\n        {\"twas\", \"brillig\", 1},\n        {\"and\", \"the\", 2},\n        {\"slithy\", \"toves\", 3},\n    }\n    outstrings := make([]string, 0)\n    for _, part := range a {\n        outstrings = append(outstrings, part.s, part.r, strconv.Itoa(part.ss))\n    }\n    out := strings.Join(outstrings, ` `)\n    fmt.Printf(\"%s\\n\", out)\n}\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>twas brillig 1 and the 2 slithy toves 3\n</code></pre>\n\n<p>How to most efficiently combine strings is a common question on StackOverflow and has been answered many times.  See this top-voted question/answer for Go: <a href=\"https://stackoverflow.com/questions/1760757/how-to-efficiently-concatenate-strings-in-go\">How to efficiently concatenate strings in Go?</a>.</p>\n"}], "owner": {"reputation": 178, "user_id": 1367644, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f13449555c3fbc245cda582fe0464f5?s=128&d=identicon&r=PG", "display_name": "lesovsky", "link": "https://stackoverflow.com/users/1367644/lesovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 0, "closed_date": 1607456671, "accepted_answer_id": 49017524, "answer_count": 2, "score": -1, "last_activity_date": 1617527435, "creation_date": 1519762409, "last_edit_date": 1617527435, "question_id": 49017173, "link": "https://stackoverflow.com/questions/49017173/is-there-a-more-efficient-way-to-concatenate-strings", "closed_reason": "Opinion-based", "title": "Is there a more efficient way to concatenate strings?", "body": "<p>I have written an example of Go code which is sends query to postgres and send result to the pager:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;database/sql&quot;\n    _ &quot;github.com/lib/pq&quot;\n    &quot;log&quot;\n    &quot;os/exec&quot;\n    &quot;strings&quot;\n    &quot;os&quot;\n)\n\nfunc main() {\n    connstr := &quot;user=postgres dbname=postgres sslmode=disable&quot;\n    db, err := sql.Open(&quot;postgres&quot;, connstr)\n    if err != nil { log.Fatal(err) }\n\n    rows, err := db.Query(&quot;SELECT schemaname, relname, seq_scan FROM pg_stat_all_tables ORDER BY 1 LIMIT 10&quot;)\n    if err != nil { log.Fatal(err) }\n    defer rows.Close()\n\n    var buf string\n    for rows.Next() {\n        var s, r string\n        var ss int\n        if err := rows.Scan(&amp;s, &amp;r, &amp;ss); err != nil { log.Fatal(err) }\n        buf = fmt.Sprintf(&quot;%s %s %d\\n&quot;, buf + s, r, ss)\n    }\n    \n    cmd := exec.Command(&quot;less&quot;)\n    cmd.Stdin = strings.NewReader(buf)\n    cmd.Stdout = os.Stdout\n    \n    err = cmd.Run()\n    if err != nil { log.Fatal(err) }\n}\n</code></pre>\n<p>But the following line:</p>\n<pre><code>buf = fmt.Sprintf(&quot;%s %s %d\\n&quot;, buf + s, r, ss)\n</code></pre>\n<p>looks rude for me and I'm not sure this is a right way. Is there way to achieve result in more elegant way? May be it's possible with some kind of buffers and io.Readers?</p>\n<p>UPD. When I asked this question a few year ago, I was a Golang newbie. Now, with current experience I see no problems with this code and the question should be closed.</p>\n"}, {"tags": ["elasticsearch", "go", "elasticsearch-plugin", "elasticsearch-5", "elasticsearch-nested"], "comments": [{"owner": {"reputation": 18344, "user_id": 119326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b29825e83c1da695da0e22b4198a0105?s=128&d=identicon&r=PG", "display_name": "Cfreak", "link": "https://stackoverflow.com/users/119326/cfreak"}, "edited": false, "score": 0, "creation_date": 1519752532, "post_id": 49014544, "comment_id": 85033908, "body": "What does your index mapping look like? Are you sure <code>List_CounterData</code> has what you expect?  Where are <code>KpiIndex</code> and <code>KpiDocType</code> defined?"}, {"owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "reply_to_user": {"reputation": 18344, "user_id": 119326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b29825e83c1da695da0e22b4198a0105?s=128&d=identicon&r=PG", "display_name": "Cfreak", "link": "https://stackoverflow.com/users/119326/cfreak"}, "edited": false, "score": 0, "creation_date": 1519752882, "post_id": 49014544, "comment_id": 85034105, "body": "Hi Please find the declaration    const RegisterIndex = &quot;register&quot; const KpiIndex = &quot;kpi&quot;  // Register &amp; Kpi Index doc type const RegisterDocType = &quot;register&quot; const KpiDocType = &quot;kpi&quot;  const KpiMapping = ` { \t&quot;mappings&quot;: { \t\t&quot;kpi&quot;: { \t\t\t&quot;properties&quot;: { \t\t\t\t&quot;kpi&quot;: { \t\t\t\t\t&quot;type&quot;: &quot;nested&quot;  \t\t\t\t} \t\t\t} \t\t} \t} }`"}, {"owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "reply_to_user": {"reputation": 18344, "user_id": 119326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b29825e83c1da695da0e22b4198a0105?s=128&d=identicon&r=PG", "display_name": "Cfreak", "link": "https://stackoverflow.com/users/119326/cfreak"}, "edited": false, "score": 0, "creation_date": 1519800816, "post_id": 49014544, "comment_id": 85051843, "body": "@Cfreak above is the data type declarations"}], "owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519798870, "creation_date": 1519752337, "last_edit_date": 1519798870, "question_id": 49014544, "link": "https://stackoverflow.com/questions/49014544/failed-to-save-list-of-maps-content-to-elasticsearch", "title": "Failed to save list of maps content to elasticsearch", "body": "<p>i am trying to save list of maps contents to elastic search(as nested type)and it is failing. sample code is below \nimport (\n    \"fmt\"\n)</p>\n\n<pre><code>func main() {\n    fmt.Println(\"Hello, playground\")\n    var List_CounterData []interface{}\n    List_Counterdata = map[string]interface{}{}\n    err := savekpi(List_Counterdata)\n    if err != nil {\n    fmt.Println(\"error in save\")\n    }   \n}\n\nfunc saveKpi(kpi interface{}) error {\n    put1, err := elasticSearchClient.Index().\n        Index(KpiIndex).\n        Type(KpiDocType).\n        Id(\"1001\").\n        BodyJson(kpi).\n        Do(elasticSearchContext)\n    if err != nil {\n        fmt.Println(\"Failed to store Kpi , %v\", err.Error())\n        return err\n    }\n    fmt.Println(\"Indexed  %s to index %s, type %s\\n\", put1.Id, put1.Index, put1.Type)\n    return err\n}\n</code></pre>\n\n<p>My List_Counterdata sample is below</p>\n\n<blockquote>\n  <p>List_Counterdata = [map[name: kisha] map[name: kish age: 29]]</p>\n</blockquote>\n\n<p>When trying to create index, following the error </p>\n\n<pre><code>elastic: Error 400 (Bad Request): failed to parse [type=mapper_parsing_exception]\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1519743141, "post_id": 49011376, "comment_id": 85027497, "body": "Have you tried <code>go build .</code> (or <code>go build *.go</code>)?  The syntax <code>go build &lt;name&gt;</code> means &quot;build the package at path <code>&lt;name&gt;</code> from GOROOT.  Also, your reference to a bash executable is confusing.  Were you trying to <i>run</i> the executable you produced in the first command?  If so, <code>go build</code> isn&#39;t how you do it.  Also, syntax errors fired by <code>go build</code> note the file and line number they occur at."}, {"owner": {"reputation": 3095, "user_id": 178597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13148e76e55c7429e663480dc900bf77?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/178597/christian"}, "edited": false, "score": 2, "creation_date": 1519743569, "post_id": 49011376, "comment_id": 85027830, "body": "<code>Syntax error: newline unexpected</code> is very likely a bash error. After which command does this message pop up?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1519743572, "post_id": 49011376, "comment_id": 85027833, "body": "Please read through <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>. Go build is meant to work on &quot;packages&quot;, not a list of files."}, {"owner": {"reputation": 3250, "user_id": 4801289, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/I0puU.jpg?s=128&g=1", "display_name": "Ismail H", "link": "https://stackoverflow.com/users/4801289/ismail-h"}, "edited": false, "score": 0, "creation_date": 1519743822, "post_id": 49011376, "comment_id": 85028005, "body": "I&#39;ve tried using <code>go build .</code> and <code>go build *.go</code> from inside <code>cmd&#47;application</code> and when trying to launch the executable I get the bash error <code>Syntax error: newline unexpected</code>  I&#39;m still learning golang, trying to find a way to build go app and package them. Already read How to Write Go Code btw. Thank you all btw2"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1519744861, "post_id": 49011376, "comment_id": 85028780, "body": "All close votes require their motives--no need to ask for that in your question."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1519745814, "post_id": 49011376, "comment_id": 85029455, "body": "It is neither <code>go build .</code> nor <code>go build *.go</code>, it is either <code>go build</code> or <code>go build full&#47;import&#47;path&#47;of&#47;package&#47;to&#47;build</code> and add -v and -x flags to see whats going on."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1519746956, "post_id": 49011376, "comment_id": 85030272, "body": "Except that <code>go build .</code> and <code>go build *.go</code> both work perfectly fine, Volker.  <code>go build</code> is specifically designed to be able to take a file or list of files as an alternative to the recommended package syntax."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1519753119, "post_id": 49011376, "comment_id": 85034253, "body": "@Kaedys: except that&#39;s not the intended usage. &quot;How to Write Go Code&quot; makes no mention of that pattern, and even the help output for <code>go build</code> is only <code>usage: build [-o output] [-i] [build flags] [packages]</code>, as opposed to <code>go run</code> which is <code>usage: run [build flags] [-exec xprog] gofiles...</code>"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1519758855, "post_id": 49011376, "comment_id": 85037449, "body": "Except it does mention it, literally two paragraphs later: <code>If the arguments to build are a list of .go files, build treats them as a list of source files specifying a single package.</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1519760342, "post_id": 49011376, "comment_id": 85038229, "body": "@Kaedys: fair point, I thought that was in a different doc. I still think the primary behavior is what we should focus on, rather than telling beginners that are already confused they can use the exception to the rule, except with caveats. If they start by using packages correctly, then there is far less confusion moving forward."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1519762636, "post_id": 49011376, "comment_id": 85039444, "body": "That&#39;s fair, and I&#39;ve commented on other questions out here in the past that we <i>should</i> focus on the <i>recommended</i> style.  I just <i>do</i> actually use the file name style fairly regularly personally, hence why I noted it (though part of that is that my workplace has this nasty habit of putting multiple mutually-uncompilable files with <code>main()</code> functions in the same dir, and just compiling them by file name &gt;.&gt;)"}], "answers": [{"tags": [], "owner": {"reputation": 3250, "user_id": 4801289, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/I0puU.jpg?s=128&g=1", "display_name": "Ismail H", "link": "https://stackoverflow.com/users/4801289/ismail-h"}, "is_accepted": false, "score": 5, "last_activity_date": 1519809234, "last_edit_date": 1519809234, "creation_date": 1519751088, "answer_id": 49014153, "question_id": 49011376, "link": "https://stackoverflow.com/questions/49011376/golang-build-get-syntax-error-newline-unexpected-when-executing-executable-f/49014153#49014153", "title": "Golang build: get &#39;Syntax error: newline unexpected&#39; when executing executable from specific path", "body": "<p>With the help of the indication @Volker  after using the flags -v and -x I figured out that I was naming the package \"myapp\" and not \"main\" as it should be. Now it works just fine. </p>\n\n<p>As said by @Kaedys and @JimB, it is preferable to use the standard form for building apps : </p>\n\n<pre><code>go build // Method one from inside directory with go files\ngo build full/import/path/of/package/to/build // second method\n</code></pre>\n\n<p>Note that this is the recommended way in <a href=\"https://golang.org/doc/code.html#Library\" rel=\"nofollow noreferrer\">How to write Go code</a></p>\n\n<p>The other way to build is using <code>go build .</code> and <code>go build *.go</code> in the directory where you go package is.</p>\n"}], "owner": {"reputation": 3250, "user_id": 4801289, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/I0puU.jpg?s=128&g=1", "display_name": "Ismail H", "link": "https://stackoverflow.com/users/4801289/ismail-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2371, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1519809234, "creation_date": 1519742735, "last_edit_date": 1519751074, "question_id": 49011376, "link": "https://stackoverflow.com/questions/49011376/golang-build-get-syntax-error-newline-unexpected-when-executing-executable-f", "title": "Golang build: get &#39;Syntax error: newline unexpected&#39; when executing executable from specific path", "body": "<p>My app is packaged as the following: </p>\n\n<pre><code>|-cmd/\n|-cmd/application/ &lt;- this contains the main.go and other files\n|-internal/ &lt;- contains internal dependencies\n|-vendor/ &lt;- contains third party libraries\n</code></pre>\n\n<p>And when running the following command from the root <code>/</code>:</p>\n\n<pre><code>go build cmd/application/*.go\n</code></pre>\n\n<p>It produces an executable that works fine. But when typing the following command from inside <code>/cmd/application</code>:</p>\n\n<pre><code>go build my_app_custom_name\n</code></pre>\n\n<p>I get the <code>Syntax error: newline unexpected</code> error, as if it wasn't a bash executable anymore.</p>\n"}, {"tags": ["go", "imap"], "answers": [{"comments": [{"owner": {"reputation": 979, "user_id": 348686, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/5ba1538f8ecc619081b013f023d6cc48?s=128&d=identicon&r=PG", "display_name": "Shrikanth Kalluraya", "link": "https://stackoverflow.com/users/348686/shrikanth-kalluraya"}, "edited": false, "score": 0, "creation_date": 1528998154, "post_id": 49009755, "comment_id": 88728706, "body": "WHen I try to use this search api freezes"}, {"owner": {"reputation": 331, "user_id": 4735682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y_AaWqGFosM/AAAAAAAAAAI/AAAAAAAACBM/9V-CWpcT1ok/photo.jpg?sz=128", "display_name": "L. Alberto Gim&#233;nez", "link": "https://stackoverflow.com/users/4735682/l-alberto-gim%c3%a9nez"}, "edited": false, "score": 1, "creation_date": 1531570345, "post_id": 49009755, "comment_id": 89651206, "body": "I guess you message channel blocks. Check out the examples (<a href=\"https://github.com/emersion/go-imap/wiki/Fetching-messages\" rel=\"nofollow noreferrer\">github.com/emersion/go-imap/wiki/Fetching-messages</a>), as you will usually call <code>c.Fetch</code> asynchronously in a goroutine, and from the main function, you will be extracting the actual messages from the channel (using a range or similar)."}], "tags": [], "owner": {"reputation": 101, "user_id": 9418865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d777f9bdf0185992c2ffb8cdd5892685?s=128&d=identicon&r=PG", "display_name": "Philippe D.", "link": "https://stackoverflow.com/users/9418865/philippe-d"}, "is_accepted": true, "score": 5, "last_activity_date": 1519737881, "creation_date": 1519737881, "answer_id": 49009755, "question_id": 49009432, "link": "https://stackoverflow.com/questions/49009432/emersion-go-imap-how-to-retrieve-and-list-unseen-messages/49009755#49009755", "title": "emersion/go-imap - How to retrieve and list unseen messages", "body": "<p>I've done this before, here an extract of my code :</p>\n\n<pre><code>criteria := imap.NewSearchCriteria()\ncriteria.WithoutFlags = []string{\"\\\\Seen\"}\nuids, err := c.Search(criteria)\nif err != nil {\n    log.Println(err)\n}\nseqset := new(imap.SeqSet)\nseqset.AddNum(uids...)\nsection := &amp;imap.BodySectionName{}\nitems := []imap.FetchItem{imap.FetchEnvelope, imap.FetchFlags, imap.FetchInternalDate, section.FetchItem()}\nmessages := make(chan *imap.Message)\nerr = c.Fetch(seqset, items, messages)\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 3566647, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wVj86.jpg?s=128&g=1", "display_name": "freitas", "link": "https://stackoverflow.com/users/3566647/freitas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3058, "favorite_count": 0, "accepted_answer_id": 49009755, "answer_count": 1, "score": 1, "last_activity_date": 1519740048, "creation_date": 1519736692, "last_edit_date": 1519740048, "question_id": 49009432, "link": "https://stackoverflow.com/questions/49009432/emersion-go-imap-how-to-retrieve-and-list-unseen-messages", "title": "emersion/go-imap - How to retrieve and list unseen messages", "body": "<p>I'm trying to use this implementation of IMAP protocol but it seems to be impossible to retrieve unseen messages from the mailbox.</p>\n\n<p>Here's my code.</p>\n\n<pre><code>package main\n\nimport (\n    \"emailmonitor/util\"\n    \"fmt\"\n)\n\nfunc main() {\n\n    serverGmail := util.NewServerGmail()\n\n    serverGmail.Connect()\n    serverGmail.Login()\n    serverGmail.ListUnseenMessages()\n\n}\n\n//-----------------------------------------\n\npackage util\n\nimport (\n    \"io/ioutil\"\n    \"log\"\n    \"net/mail\"\n    \"net/smtp\"\n\n    imap \"github.com/emersion/go-imap\"\n    \"github.com/emersion/go-imap/client\"\n)\n\ntype ServerGmail struct {\n    user    string\n    pass    string\n    erro    string\n    cliente *client.Client\n}\n\nfunc NewServerGmail() *ServerGmail {\n    serverGmail := &amp;ServerGmail{}\n    serverGmail.user = \"xxxxxx@gmail.com\"\n    serverGmail.pass = \"xxxxx\"\n    serverGmail.erro = \"\"\n\n    return serverGmail\n}\n\nfunc (serverGmail *ServerGmail) Connect() {\n    // Connect to server\n    cliente, erro := client.DialTLS(\"smtp.gmail.com:993\", nil)\n    if erro != nil {\n        serverGmail.erro = erro.Error()\n    }\n    log.Println(\"Connected\")\n\n    serverGmail.cliente = cliente\n\n}\n\nfunc (serverGmail *ServerGmail) Login() {\n    // Login\n    if erro := serverGmail.cliente.Login(serverGmail.user, serverGmail.pass); erro != nil {\n        serverGmail.erro = erro.Error()\n    }\n    log.Println(\"Logged\")\n\n}\n\nfunc (serverGmail *ServerGmail) setLabelBox(label string) *imap.MailboxStatus {\n    mailbox, erro := serverGmail.cliente.Select(label, true)\n    if erro != nil {\n        serverGmail.erro = erro.Error()\n    }\n    return mailbox\n}\n\nfunc (serverGmail *ServerGmail) ListUnseenMessages() {\n    mailbox := serverGmail.setLabelBox(\"INBOX\")\n    log.Println(mailbox.Unseen)\n}\n</code></pre>\n\n<p>This line <code>log.Println(mailbox.Unseen)</code> prints <code>0 (zero) messages</code> and as described in the docs should be \"The number of unread messages\". I tried with UnseenSeqNum \"The sequence number of the first unseen message in the mailbox\" property and also prints 0 (zero).</p>\n\n<p>Its just a start but I wonder from there, how could I retrieve the unseen messages.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 4242, "user_id": 367180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e356e3a921bedb73efd7594ff7f37b73?s=128&d=identicon&r=PG", "display_name": "matthias krull", "link": "https://stackoverflow.com/users/367180/matthias-krull"}, "edited": false, "score": 3, "creation_date": 1519728636, "post_id": 49006594, "comment_id": 85018155, "body": "<a href=\"https://play.golang.org/p/4UzKazRVYBE\" rel=\"nofollow noreferrer\">play.golang.org/p/4UzKazRVYBE</a>"}, {"owner": {"reputation": 754, "user_id": 3476897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/57E2l.png?s=128&g=1", "display_name": "Kugel", "link": "https://stackoverflow.com/users/3476897/kugel"}, "reply_to_user": {"reputation": 4242, "user_id": 367180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e356e3a921bedb73efd7594ff7f37b73?s=128&d=identicon&r=PG", "display_name": "matthias krull", "link": "https://stackoverflow.com/users/367180/matthias-krull"}, "edited": false, "score": 0, "creation_date": 1519728805, "post_id": 49006594, "comment_id": 85018278, "body": "@matthiaskrull you solved it, suggest it as an answer."}], "answers": [{"comments": [{"owner": {"reputation": 754, "user_id": 3476897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/57E2l.png?s=128&g=1", "display_name": "Kugel", "link": "https://stackoverflow.com/users/3476897/kugel"}, "edited": false, "score": 0, "creation_date": 1519728858, "post_id": 49006864, "comment_id": 85018318, "body": "Way too complicated. matthias krull solved it above."}, {"owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "edited": false, "score": 0, "creation_date": 1519732416, "post_id": 49006864, "comment_id": 85020550, "body": "we get panic error    code:     err := json.Unmarshal([]byte(kpi.(string)), &amp;a) &quot; panic: interface conversion: interface is map[string]interface {}, not string &quot;"}, {"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "reply_to_user": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "edited": false, "score": 1, "creation_date": 1519735248, "post_id": 49006864, "comment_id": 85022191, "body": "@kish do you have <code>map[string]interface {}</code> type and need to <code>Marshal</code>? note: <code>Unmarshal</code> needs <code>[]byte</code> of <code>string</code> as input not  <code>map[string]interface {}</code> . so for better help provide minimum <a href=\"https://play.golang.org\" rel=\"nofollow noreferrer\">The Go Playground</a> sample code."}, {"owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "edited": false, "score": 0, "creation_date": 1519740162, "post_id": 49006864, "comment_id": 85025418, "body": "I am unable to provide the code sample as it is huge source code. but i will try to explain it. I will get exactly as below in interface format(as we dont know the exact amount data and type of data so we use interface) map[name: kish age:28 work: engine hobbies:[art football]] and some times as map[name: kish age:28 work: engine hobbies: art]. Once i receive it, i need to unmarshall it . So i need to convert it to []byte style for unmarshal function."}, {"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "edited": false, "score": 0, "creation_date": 1519743008, "post_id": 49006864, "comment_id": 85027411, "body": "See new edit. <a href=\"https://play.golang.org/p/j-cjmoFpden\" rel=\"nofollow noreferrer\">I hope this helps.</a>"}, {"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "edited": false, "score": 1, "creation_date": 1519743845, "post_id": 49006864, "comment_id": 85028025, "body": "<code>data</code> should be <b>JSON-encoded</b> (in simple word <b><a href=\"https://play.golang.org/p/uQPwJrwJO-3\" rel=\"nofollow noreferrer\">String</a></b>) so you are using <code>Unmarshal</code> in a wrong way"}, {"owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "edited": false, "score": 0, "creation_date": 1519817985, "post_id": 49006864, "comment_id": 85061590, "body": "@A.R i understood your point. But even in your link when we try to print it we are getting as map[* : *]. How to prevent the map? this map is trying to create problem when i use the data for dynamic mapping in elasticsearch."}, {"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "edited": false, "score": 1, "creation_date": 1519824099, "post_id": 49006864, "comment_id": 85065478, "body": "What do you mean by &quot;How to prevent the map?&quot;. what problem it creates? you should elaborate. and I think it is new question so <a href=\"https://stackoverflow.com/help/mcve\">create a Minimal, Complete, and Verifiable example</a> and ask in new Question clearly, so someone could help."}], "tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": false, "score": 12, "last_activity_date": 1519743785, "last_edit_date": 1519743785, "creation_date": 1519728604, "answer_id": 49006864, "question_id": 49006594, "link": "https://stackoverflow.com/questions/49006594/interface-to-byte-conversion-in-golang/49006864#49006864", "title": "interface{} to []byte conversion in golang", "body": "<p>In your <a href=\"https://play.golang.org/p/H-YeAcik-Xu\" rel=\"noreferrer\">sample</a> code <code>data</code> should be <strong>JSON-encoded</strong> (in simple word <strong><a href=\"https://play.golang.org/p/uQPwJrwJO-3\" rel=\"noreferrer\">String</a></strong>) so you are using <code>Unmarshal</code> in a wrong way:</p>\n\n<blockquote>\n<pre><code>// Unmarshal parses the JSON-encoded data and stores the result\n// in the value pointed to by v. If v is nil or not a pointer,\n// Unmarshal returns an InvalidUnmarshalError.\nfunc Unmarshal(data []byte, v interface{}) error\n</code></pre>\n</blockquote>\n\n<p>Try it on <a href=\"https://play.golang.org/p/j-cjmoFpden\" rel=\"noreferrer\">The Go Playground</a> and <a href=\"https://play.golang.org/p/alucDPcVZwU\" rel=\"noreferrer\">this: <code>[]string{\"art\", \"football\"}</code></a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    // ********************* Marshal *********************\n    u := map[string]interface{}{}\n    u[\"name\"] = \"kish\"\n    u[\"age\"] = 28\n    u[\"work\"] = \"engine\"\n    //u[\"hobbies\"] = []string{\"art\", \"football\"}\n    u[\"hobbies\"] = \"art\"\n\n    b, err := json.Marshal(u)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(b))\n\n    // ********************* Unmarshal *********************\n    var a interface{}\n    err = json.Unmarshal(b, &amp;a)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    fmt.Println(a)\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>{\"age\":28,\"hobbies\":\"art\",\"name\":\"kish\",\"work\":\"engine\"}\nmap[name:kish work:engine age:28 hobbies:art]\n</code></pre>\n\n<hr>\n\n<p>You want to <strong>Unmarshal</strong> it, so try <a href=\"https://play.golang.org/p/C2nhrdG3gN8\" rel=\"noreferrer\">this</a> simple working example (<code>[]byte(kpi.(string)</code>):</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    var kpi interface{} = st\n    var a []Animal\n    err := json.Unmarshal([]byte(kpi.(string)), &amp;a)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    fmt.Println(a)\n}\n\ntype Animal struct {\n    Name  string\n    Order string\n}\n\nvar st = `[\n    {\"Name\": \"Platypus\", \"Order\": \"Monotremata\"},\n    {\"Name\": \"Quoll\",    \"Order\": \"Dasyuromorphia\"}\n]`\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>[{Platypus Monotremata} {Quoll Dasyuromorphia}]\n</code></pre>\n\n<hr>\n\n<p>Working <a href=\"https://play.golang.org/p/CykdkWtXklN\" rel=\"noreferrer\">example</a> using (<code>[]byte(*kpi.(*string))</code>):</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    var kpi interface{} = &amp;st\n    var a []Animal\n    err := json.Unmarshal([]byte(*kpi.(*string)), &amp;a)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    fmt.Println(a)\n}\n\ntype Animal struct {\n    Name  string\n    Order string\n}\n\nvar st = `[\n    {\"Name\": \"Platypus\", \"Order\": \"Monotremata\"},\n    {\"Name\": \"Quoll\",    \"Order\": \"Dasyuromorphia\"}\n]`\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://play.golang.org/p/tKkMrY5G5RS\" rel=\"noreferrer\">Marshal</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    u := map[string]interface{}{}\n    u[\"1\"] = \"one\"\n    b, err := json.Marshal(u)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(b))\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>{\"1\":\"one\"}\n</code></pre>\n\n<p>I hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "edited": false, "score": 0, "creation_date": 1519732239, "post_id": 49007587, "comment_id": 85020452, "body": "1. we get the compilation error,     code: passInterface(&amp;kpi) \terr := json.Unmarshal(kpi, &amp;a)          your function      2. error : cannot use kpi (type interface {}) as type []byte in argument to json.Unmarshal: need type assertion"}, {"owner": {"reputation": 4242, "user_id": 367180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e356e3a921bedb73efd7594ff7f37b73?s=128&d=identicon&r=PG", "display_name": "matthias krull", "link": "https://stackoverflow.com/users/367180/matthias-krull"}, "reply_to_user": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "edited": false, "score": 2, "creation_date": 1519740859, "post_id": 49007587, "comment_id": 85025909, "body": "It is pretty hard to debug your issues without the actual code, really. Even a boiled down version for the go playground would do."}, {"owner": {"reputation": 4242, "user_id": 367180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e356e3a921bedb73efd7594ff7f37b73?s=128&d=identicon&r=PG", "display_name": "matthias krull", "link": "https://stackoverflow.com/users/367180/matthias-krull"}, "reply_to_user": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "edited": false, "score": 0, "creation_date": 1519756943, "post_id": 49007587, "comment_id": 85036364, "body": "I am not sure what you are trying to do. If you have a map already it seems you either have to unmarshal certain members: <a href=\"https://play.golang.org/p/M8-sDQV-HCL\" rel=\"nofollow noreferrer\">like this</a> or <a href=\"https://play.golang.org/p/fDF8Br2ub1K\" rel=\"nofollow noreferrer\">like this</a> or you do not need to unmarshal anything and only need the correct type assertion in case the value of the <code>{}interface</code> is structured data already."}], "tags": [], "owner": {"reputation": 4242, "user_id": 367180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e356e3a921bedb73efd7594ff7f37b73?s=128&d=identicon&r=PG", "display_name": "matthias krull", "link": "https://stackoverflow.com/users/367180/matthias-krull"}, "is_accepted": false, "score": 10, "last_activity_date": 1519730791, "creation_date": 1519730791, "answer_id": 49007587, "question_id": 49006594, "link": "https://stackoverflow.com/questions/49006594/interface-to-byte-conversion-in-golang/49007587#49007587", "title": "interface{} to []byte conversion in golang", "body": "<p>Working example based on the one provided by Kugel:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc passInterface(v interface{}) {\n    b, ok := v.(*[]byte)\n    fmt.Println(ok)\n    fmt.Println(b)\n}\n\nfunc main() {\n    passInterface(&amp;[]byte{0x00, 0x01, 0x02})\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/4UzKazRVYBE\" rel=\"noreferrer\">Play</a></p>\n\n<p>If you do not pass references, it will work basically the same:</p>\n\n<p><a href=\"https://play.golang.org/p/GSd7LeFRB_y\" rel=\"noreferrer\">Play</a></p>\n"}], "owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47011, "favorite_count": 4, "answer_count": 2, "score": 21, "last_activity_date": 1572077773, "creation_date": 1519727772, "last_edit_date": 1519728594, "question_id": 49006594, "link": "https://stackoverflow.com/questions/49006594/interface-to-byte-conversion-in-golang", "title": "interface{} to []byte conversion in golang", "body": "<p>I am trying to unmarshal a data which is of type interface. So I need to convert the interface type to []byte and pass it to unmarshall.\ni tried</p>\n\n<ol>\n<li><code>err := json.Unmarshal([]byte(kpi), &amp;a)</code> => failed</li>\n<li>i tired to convert the interface to byte by using\n <code>kpidata, res := kpi.([]byte)</code> => failed, kpidata is nil</li>\n</ol>\n\n<p>So is there any way we can convert it?</p>\n\n<p>Example: <a href=\"https://play.golang.org/p/5pqQ0DQ94Dp\" rel=\"noreferrer\">https://play.golang.org/p/5pqQ0DQ94Dp</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 4, "creation_date": 1519726789, "post_id": 49006205, "comment_id": 85016943, "body": "<code>err :=</code> -&gt; <code>err =</code>. &quot; or have I completely misunderstood something?&quot; Yes, you seem to not understand the difference between <code>:=</code> and <code>=</code>"}, {"owner": {"reputation": 59, "user_id": 9395733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a369b7ebaf486b65d834821e0f11c8?s=128&d=identicon&r=PG&f=1", "display_name": "Coder99", "link": "https://stackoverflow.com/users/9395733/coder99"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1519727133, "post_id": 49006205, "comment_id": 85017181, "body": "I just tryed using err = and I got the following -&gt; main.go:70:2: undefined: err"}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "edited": false, "score": 0, "creation_date": 1519727187, "post_id": 49006205, "comment_id": 85017223, "body": "Second one would simply be =. err is already declared in the first one. If say there would be a new variable on that line then it would be like newVar, err := (now there is a new variable on the left side)."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1519730188, "post_id": 49006205, "comment_id": 85019175, "body": "Look at the <i>entire</i> error, including the line number, and it should become more apparent what&#39;s wrong."}, {"owner": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 0, "creation_date": 1519730347, "post_id": 49006205, "comment_id": 85019266, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/13329154/golang-no-new-variables-on-left-side-of\">Golang: no new variables on left side of :=</a>"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9395733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a369b7ebaf486b65d834821e0f11c8?s=128&d=identicon&r=PG&f=1", "display_name": "Coder99", "link": "https://stackoverflow.com/users/9395733/coder99"}, "edited": false, "score": 1, "creation_date": 1519730185, "post_id": 49006473, "comment_id": 85019173, "body": "Thank you - I dont know why my question got marked down. I am not very good at reading docs, and a simple answer with a detail that you have given me helps a lot."}, {"owner": {"reputation": 754, "user_id": 3476897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/57E2l.png?s=128&g=1", "display_name": "Kugel", "link": "https://stackoverflow.com/users/3476897/kugel"}, "reply_to_user": {"reputation": 59, "user_id": 9395733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a369b7ebaf486b65d834821e0f11c8?s=128&d=identicon&r=PG&f=1", "display_name": "Coder99", "link": "https://stackoverflow.com/users/9395733/coder99"}, "edited": false, "score": 0, "creation_date": 1519731392, "post_id": 49006473, "comment_id": 85019931, "body": "Consider accepting my answer if it helped you :)"}, {"owner": {"reputation": 59, "user_id": 9395733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a369b7ebaf486b65d834821e0f11c8?s=128&d=identicon&r=PG&f=1", "display_name": "Coder99", "link": "https://stackoverflow.com/users/9395733/coder99"}, "edited": false, "score": 0, "creation_date": 1519731984, "post_id": 49006473, "comment_id": 85020296, "body": "sorry forgot you had to do that"}], "tags": [], "owner": {"reputation": 754, "user_id": 3476897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/57E2l.png?s=128&g=1", "display_name": "Kugel", "link": "https://stackoverflow.com/users/3476897/kugel"}, "is_accepted": true, "score": 1, "last_activity_date": 1519727417, "creation_date": 1519727417, "answer_id": 49006473, "question_id": 49006205, "link": "https://stackoverflow.com/questions/49006205/go-lang-error-handling-issue-misunderstanding/49006473#49006473", "title": "Go Lang Error Handling Issue / Misunderstanding?", "body": "<p>You redeclared the variable <code>err</code>. What you often see is the shorter error handling syntax:</p>\n\n<pre><code>if err := DoSomething(); err != nil {\n    // handle\n}\n</code></pre>\n\n<p>Variables declared in control structures and for loops are only visible to that block. So the <code>err</code> declared above can only be seen within the if block.</p>\n"}, {"tags": [], "owner": {"reputation": 1714, "user_id": 4201748, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/77085485ce9b7c0ba971998b928048c0?s=128&d=identicon&r=PG", "display_name": "manigandand", "link": "https://stackoverflow.com/users/4201748/manigandand"}, "is_accepted": false, "score": 2, "last_activity_date": 1519727817, "creation_date": 1519727817, "answer_id": 49006611, "question_id": 49006205, "link": "https://stackoverflow.com/questions/49006205/go-lang-error-handling-issue-misunderstanding/49006611#49006611", "title": "Go Lang Error Handling Issue / Misunderstanding?", "body": "<p>You can treat your error has like this.  </p>\n\n<pre><code>if err := r.ParseForm(); err != nil {\n    log.Panic(err)\n}\n\nvar user User\nif err := decoder.Decode(&amp;user, r.PostForm); err != nil {\n    log.Panic(err)\n}\n</code></pre>\n\n<p>Or define your <code>error</code> globally.</p>\n\n<pre><code>var err error\nerr = r.ParseForm()\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9395733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a369b7ebaf486b65d834821e0f11c8?s=128&d=identicon&r=PG&f=1", "display_name": "Coder99", "link": "https://stackoverflow.com/users/9395733/coder99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "closed_date": 1519730347, "accepted_answer_id": 49006473, "answer_count": 2, "score": -4, "last_activity_date": 1519727817, "creation_date": 1519726613, "question_id": 49006205, "link": "https://stackoverflow.com/questions/49006205/go-lang-error-handling-issue-misunderstanding", "closed_reason": "Not suitable for this site", "title": "Go Lang Error Handling Issue / Misunderstanding?", "body": "<p>Ok so I am using the following code, </p>\n\n<pre><code>err := r.ParseForm()\nif err != nil {\n    log.Panic(err)\n}\n\nvar user User\n\nerr := decoder.Decode(&amp;user, r.PostForm)\nif err != nil {\n    log.Panic(err)\n}\n</code></pre>\n\n<p>Now when I try to run this code, I get the following error, </p>\n\n<pre><code>no new variables on left side of :=\n</code></pre>\n\n<p>Now I know that this is due to using the same variable, in this case <code>err</code> but I have seen lots of examples where this is how other developers deal with error handling?</p>\n\n<p>The way that I have been using is just to use <code>err1</code> and <code>err2</code> so I can build the code.</p>\n\n<p>I have been over the docs but there is a lot to take in and must have missed how the <code>err</code> variable is being able to be re-used, or have I completely misunderstood something? </p>\n\n<p>Thanks, </p>\n"}, {"tags": ["go", "type-conversion", "slice", "bit"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1519727375, "post_id": 49006145, "comment_id": 85017351, "body": "So what is the question? If you are looking for some magical feature or syntactic sugar: Stop looking, there is none. Write loops and shifts. If you are looking for a package doing this for you: Stop looking at SO."}, {"owner": {"reputation": 254, "user_id": 1728591, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76118bbc7c0d876cb625f9f430227d19?s=128&d=identicon&r=PG", "display_name": "mgm", "link": "https://stackoverflow.com/users/1728591/mgm"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1519727829, "post_id": 49006145, "comment_id": 85017650, "body": "What a nice comment.... Since I am rather new to the language and I am aware of <code>strconv.FormatInt( a []byte turned into int , 2)</code> that returns me a string with the binary representation as a string, I was just looking for a similar, more compact, approach. Thank you, @Volker, take care."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1519728995, "post_id": 49006145, "comment_id": 85018413, "body": "What&#39;s the purpose of converting <code>[]byte</code> to <code>[]bool</code>? You want to be able to test for individual bits?"}, {"owner": {"reputation": 254, "user_id": 1728591, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76118bbc7c0d876cb625f9f430227d19?s=128&d=identicon&r=PG", "display_name": "mgm", "link": "https://stackoverflow.com/users/1728591/mgm"}, "edited": false, "score": 0, "creation_date": 1519730963, "post_id": 49006145, "comment_id": 85019656, "body": "The []byte is the output of a modbus read of a bunch of coils (that is: individual bits). By representing them as a []int or []bool I get to &quot;explain&quot; better what I am doing to those bits, instead of doing shifts all the time. In a sense: it&#39;s clearer as a representation to both the end user and the developer."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 8, "last_activity_date": 1519741306, "last_edit_date": 1519741306, "creation_date": 1519731973, "answer_id": 49007934, "question_id": 49006145, "link": "https://stackoverflow.com/questions/49006145/byte-to-int-or-bool/49007934#49007934", "title": "[]byte to []int or []bool", "body": "<p>There is no ready function in the standard lib that would do that. Here's a possible solution using a loop:</p>\n\n<pre><code>func convert(data []byte) []bool {\n    res := make([]bool, len(data)*8)\n    for i := range res {\n        res[i] = data[i/8]&amp;(0x80&gt;&gt;byte(i&amp;0x7)) != 0\n    }\n    return res\n}\n</code></pre>\n\n<p>You explained you want to convert <code>[]byte</code> to <code>[]bool</code> because you treat the input as a set of individual bits.</p>\n\n<p>In that case just use <a href=\"https://golang.org/pkg/math/big/#Int\" rel=\"nofollow noreferrer\"><code>big.Int</code></a>. It has <a href=\"https://golang.org/pkg/math/big/#Int.Bit\" rel=\"nofollow noreferrer\"><code>Int.Bit()</code></a> and <a href=\"https://golang.org/pkg/math/big/#Int.SetBit\" rel=\"nofollow noreferrer\"><code>Int.SetBit()</code></a> methods to get and set a bit at a given position. To \"initialize\" a <code>big.Int</code> value with the raw <code>[]byte</code>, use <a href=\"https://golang.org/pkg/math/big/#Int.SetBytes\" rel=\"nofollow noreferrer\"><code>Int.SetBytes()</code></a>. If you modify / manipulate the <code>big.Int</code>, you may get back the raw bytes using <a href=\"https://golang.org/pkg/math/big/#Int.Bytes\" rel=\"nofollow noreferrer\"><code>Int.Bytes()</code></a>.</p>\n\n<p>See this example:</p>\n\n<pre><code>data := []byte{0x41, 0x01}\nfmt.Println(\"intput bytes:\", data)\n\nbi := big.NewInt(0)\nbi.SetBytes(data)\nfmt.Println(\"data:\", bi.Text(2))\n\nfmt.Println(\"7. bit before:\", bi.Bit(7))\nbi.SetBit(bi, 7, 1)\nfmt.Println(\"7. bit after:\", bi.Bit(7))\nfmt.Println(\"data:\", bi.Text(2))\nfmt.Println(\"output bytes:\", bi.Bytes())\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/Ybi3RCExbwM\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>intput bytes: [65 1]\ndata: 100000100000001\n7. bit before: 0\n7. bit after: 1\ndata: 100000110000001\noutput bytes: [65 129]\n</code></pre>\n"}], "owner": {"reputation": 254, "user_id": 1728591, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76118bbc7c0d876cb625f9f430227d19?s=128&d=identicon&r=PG", "display_name": "mgm", "link": "https://stackoverflow.com/users/1728591/mgm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 976, "favorite_count": 0, "answer_count": 1, "score": 8, "last_activity_date": 1519741306, "creation_date": 1519726406, "last_edit_date": 1519740137, "question_id": 49006145, "link": "https://stackoverflow.com/questions/49006145/byte-to-int-or-bool", "title": "[]byte to []int or []bool", "body": "<p>Let's say I have a <code>[]byte</code> and for the sake of making my life easier I want to convert it in a <code>[]int</code> or <code>[]bool</code> in the following way: </p>\n\n<p>Let's say I start with <code>[]byte{0x41}</code>, that is <code>0b01000001</code>. Now, what I would like to obtain is something like:</p>\n\n<pre><code>[]int{0,1,0,0,0,0,0,1}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>[]bool{f,t,f,f,f,f,f,t}\n</code></pre>\n\n<p>I guess I could cycle with something like this:</p>\n\n<pre><code>mybyte &amp; (1 &lt;&lt; pos)\n</code></pre>\n\n<p>but I was looking for a more compact approach.</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 501, "user_id": 1205077, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a6decbed7685eac78e41bc8b40327e55?s=128&d=identicon&r=PG", "display_name": "O\u011fuzhan Top&#231;u", "link": "https://stackoverflow.com/users/1205077/o%c4%9fuzhan-top%c3%a7u"}, "edited": false, "score": 1, "creation_date": 1519728378, "post_id": 49006073, "comment_id": 85017986, "body": "forking and editing decode.go to prevent case insensitive matching is an option, too."}], "answers": [{"tags": [], "owner": {"reputation": 1437, "user_id": 4038702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/364QK.jpg?s=128&g=1", "display_name": "Pandelis", "link": "https://stackoverflow.com/users/4038702/pandelis"}, "is_accepted": true, "score": 16, "last_activity_date": 1519727799, "creation_date": 1519727799, "answer_id": 49006601, "question_id": 49006073, "link": "https://stackoverflow.com/questions/49006073/json-unmarshal-struct-case-sensitively/49006601#49006601", "title": "JSON Unmarshal struct case-sensitively", "body": "<p>Unfortunately this is not something currently supported by the standard json library.</p>\n\n<p>According to <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"noreferrer\">https://golang.org/pkg/encoding/json/#Unmarshal</a></p>\n\n<blockquote>\n  <p>Unmarshal matches incoming object keys to the keys used by Marshal (either the struct field name or its tag), preferring an exact match but also accepting a case-insensitive match</p>\n</blockquote>\n\n<p>There is no way to turn this behaviour off.</p>\n"}], "owner": {"reputation": 161, "user_id": 9417980, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Principled", "link": "https://stackoverflow.com/users/9417980/principled"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3509, "favorite_count": 0, "accepted_answer_id": 49006601, "answer_count": 1, "score": 15, "last_activity_date": 1519730211, "creation_date": 1519726170, "last_edit_date": 1519730211, "question_id": 49006073, "link": "https://stackoverflow.com/questions/49006073/json-unmarshal-struct-case-sensitively", "title": "JSON Unmarshal struct case-sensitively", "body": "<p>Is there any way to make json.Unmarshal <em>not</em> accept a case-insensitive match? I receive a JSON with tags such as \"e\" and \"E\" and would like to unmarshal the object with tag \"e\" but ignore the one with \"E\". Right now the only solution I found was to define a struct containing both tags and then to simply ignore tag \"E\",  but I'm looking for a cleaner solution.</p>\n\n<p>From the official doc:</p>\n\n<blockquote>\n  <p>To unmarshal JSON into a struct, Unmarshal matches incoming object keys to the keys used by Marshal (either the struct field name or its tag), preferring an exact match but also accepting a case-insensitive match.</p>\n</blockquote>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1519724387, "post_id": 49005416, "comment_id": 85015379, "body": "That&#39;s because you are using a lookahead that is not supported by Go regexp. Are you after <a href=\"https://play.golang.org/p/ddjDje0IDig\" rel=\"nofollow noreferrer\">play.golang.org/p/ddjDje0IDig</a>?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1519725854, "post_id": 49005416, "comment_id": 85016350, "body": "Always handle all your errors."}], "answers": [{"comments": [{"owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "reply_to_user": {"reputation": 352, "user_id": 6399638, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b42f7db8b942eb921ffa62930ef1979?s=128&d=identicon&r=PG&f=1", "display_name": "Yang MingHui", "link": "https://stackoverflow.com/users/6399638/yang-minghui"}, "edited": false, "score": 0, "creation_date": 1519724789, "post_id": 49005514, "comment_id": 85015671, "body": "what are you trying to do?"}, {"owner": {"reputation": 352, "user_id": 6399638, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b42f7db8b942eb921ffa62930ef1979?s=128&d=identicon&r=PG&f=1", "display_name": "Yang MingHui", "link": "https://stackoverflow.com/users/6399638/yang-minghui"}, "edited": false, "score": 0, "creation_date": 1519724969, "post_id": 49005514, "comment_id": 85015780, "body": "Distinguish single slash or double slash."}, {"owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "reply_to_user": {"reputation": 352, "user_id": 6399638, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b42f7db8b942eb921ffa62930ef1979?s=128&d=identicon&r=PG&f=1", "display_name": "Yang MingHui", "link": "https://stackoverflow.com/users/6399638/yang-minghui"}, "edited": false, "score": 0, "creation_date": 1519725553, "post_id": 49005514, "comment_id": 85016160, "body": "See Wiktors answer"}], "tags": [], "owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "is_accepted": false, "score": 2, "last_activity_date": 1519724505, "creation_date": 1519724505, "answer_id": 49005514, "question_id": 49005416, "link": "https://stackoverflow.com/questions/49005416/golang-regex-error-when-match-single-slash/49005514#49005514", "title": "golang regex error when match single slash", "body": "<p>Go regex does not support lookarounds.</p>\n\n<p>This will return an error, but you ignore it:</p>\n\n<pre><code>reSlash, _ := regexp.Compile(`^\\/(?!\\/)(.*?)`)\n</code></pre>\n\n<blockquote>\n  <p>error parsing regexp: invalid or unsupported Perl syntax: <code>(?!</code></p>\n</blockquote>\n\n<p>Use this service to test Golang your regular expressions: <a href=\"https://regex-golang.appspot.com/assets/html/index.html\" rel=\"nofollow noreferrer\">https://regex-golang.appspot.com/assets/html/index.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 4, "last_activity_date": 1519725148, "creation_date": 1519725148, "answer_id": 49005730, "question_id": 49005416, "link": "https://stackoverflow.com/questions/49005416/golang-regex-error-when-match-single-slash/49005730#49005730", "title": "golang regex error when match single slash", "body": "<p>Go regexp does not support lookarounds. You may use a negated character class with an alternation group here to fix the issue:</p>\n\n<pre><code>package main\n\nimport (\n    \"regexp\"\n    \"fmt\"\n)\n\nfunc ReHaveSlash(s string) bool {\n    var reSlash = regexp.MustCompile(`^/([^/].*|$)`)\n    return reSlash.MatchString(s)\n}\n\nfunc ReHaveSlashdouble(s string) bool {\n    var reSlash = regexp.MustCompile(`^//([^/].*|$)`)\n    return reSlash.MatchString(s)\n}\n\nfunc main() {\n    test_url := \"/xmars-assets.qiniu.com/archives/1369\"\n    fmt.Println(ReHaveSlashdouble(test_url))\n    fmt.Println(ReHaveSlash(test_url))\n}\n</code></pre>\n\n<p>See the <a href=\"https://play.golang.org/p/nd1bbuKqzDX\" rel=\"nofollow noreferrer\">Go lang demo</a></p>\n\n<p>The <code>^/([^/].*|$)</code> pattern matches a <code>/</code> at the start of the string, and then matches a char other than <code>/</code> followed with any 0+ chars or end of string. The <code>^//([^/].*|$)</code> matches  <code>//</code> followed with any 0+ chars or end of string</p>\n\n<p>If you want to make sure you only match strings on the same line, replace <code>[^/]</code> with <code>[^/\\r\\n]</code> since <code>[^/]</code> also matches line breaks.</p>\n"}], "owner": {"reputation": 352, "user_id": 6399638, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b42f7db8b942eb921ffa62930ef1979?s=128&d=identicon&r=PG&f=1", "display_name": "Yang MingHui", "link": "https://stackoverflow.com/users/6399638/yang-minghui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2954, "favorite_count": 0, "accepted_answer_id": 49005730, "answer_count": 2, "score": 2, "last_activity_date": 1519736257, "creation_date": 1519724208, "last_edit_date": 1519736257, "question_id": 49005416, "link": "https://stackoverflow.com/questions/49005416/golang-regex-error-when-match-single-slash", "title": "golang regex error when match single slash", "body": "<p>I write a pattern and it works in Python, but when I run in Go 1.9.2, it panics:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n</code></pre>\n\n<p>The code as follows:</p>\n\n<pre><code>package main\n\nimport (\n    \"regexp\"\n    \"fmt\"\n)\n\n\n\nfunc ReHaveSlash(s string) bool {\n    reSlash, _ := regexp.Compile(`^\\/(?!\\/)(.*?)`)\n    a := reSlash.MatchString(s)\n\n    return a\n\n}\n\nfunc ReHaveSlashdouble(s string) bool {\n    reSlash, _ := regexp.Compile(`^\\/\\/(.*?)`)\n    a := reSlash.MatchString(s)\n\n    return a\n\n}\n\nfunc main() {\n    test_url := \"/xmars-assets.qiniu.com/archives/1369\"\n    fmt.Println(ReHaveSlashdouble(test_url))\n    fmt.Println(ReHaveSlash(test_url))\n\n}\n</code></pre>\n\n<p>And the result in Console is as following</p>\n\n<pre><code>false\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x1095e56]\n\ngoroutine 1 [running]:\nregexp.(*Regexp).get(0x0, 0x0)\n    /usr/local/Cellar/go/1.9.2/libexec/src/regexp/regexp.go:211 +0x26\nregexp.(*Regexp).doExecute(0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10ee1f5, 0x25, 0x0, 0x0, ...)\n    /usr/local/Cellar/go/1.9.2/libexec/src/regexp/exec.go:420 +0x40\nregexp.(*Regexp).doMatch(0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10ee1f5, 0x25, 0xc42000a0c0)\n    /usr/local/Cellar/go/1.9.2/libexec/src/regexp/exec.go:412 +0xc8\nregexp.(*Regexp).MatchString(0x0, 0x10ee1f5, 0x25, 0x115f400)\n    /usr/local/Cellar/go/1.9.2/libexec/src/regexp/regexp.go:435 +0x6c\nmain.ReHaveSlash(0x10ee1f5, 0x25, 0x1)\n    /Users/l2017006/Documents/work/check-link/test_re.go:12 +0x58\nmain.main()\n    /Users/l2017006/Documents/work/check-link/test_re.go:29 +0xa5\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1519721688, "post_id": 49004608, "comment_id": 85013730, "body": "Create a file containing separate struct for different functions and import it according to requirement in your main.go file"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1519721815, "post_id": 49004608, "comment_id": 85013820, "body": "@Himanshu - yes for course I can do it but my question is if there is better approach ?"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1519721878, "post_id": 49004608, "comment_id": 85013869, "body": "Post some code that you have tried so far to get an idea. What and how you actually want"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1519722129, "post_id": 49004608, "comment_id": 85014011, "body": "Each function will use a single struct or same struct can be used for different functions ?"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1519722657, "post_id": 49004608, "comment_id": 85014314, "body": "@Himanshu - each struct can be used in different function , but its not mandatory . there is option that one struct can be used in one function..."}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1519722691, "post_id": 49004608, "comment_id": 85014336, "body": "@Himanshu - are you familiar with this concept Functional options instead of config struct <a href=\"https://dave.cheney.net/2014/10/17/functional-options-for-friendly-apis\" rel=\"nofollow noreferrer\">dave.cheney.net/2014/10/17/functional-options-for-friendly-a&zwnj;&#8203;pis</a>"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519723108, "post_id": 49004608, "comment_id": 85014596, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/165879/discussion-between-himanshu-and-jenny-hilton\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1520420566, "post_id": 49005335, "comment_id": 85304821, "body": "Thanks , I want to use the functional option, it will be great if you can provide example for my context..."}], "tags": [], "owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "is_accepted": false, "score": 3, "last_activity_date": 1519723993, "creation_date": 1519723993, "answer_id": 49005335, "question_id": 49004608, "link": "https://stackoverflow.com/questions/49004608/different-packages-with-different-config-props-functional-option/49005335#49005335", "title": "Different packages with different config props - Functional option", "body": "<p>I use this to define per package Config Structs which are easier to manage and are loaded at the app start.</p>\n\n<p>Define your config struct like this</p>\n\n<pre><code>type Config struct {\n    Conf1               package1.Configuration        `group:\"conf1\"           namespace:\"conf1\"`\n    Conf2               package2.Configuration        `group:\"conf2\"           namespace:\"conf2\"`\n    Conf3               Config3                       `group:\"conf3\"           namespace:\"conf3\"`\n    GeneralSetting      string                        `long:\"Setting\"          description:\"setting\"        env:\"SETTING\"      required:\"true\"`\n}\n\ntype Config3 struct {\n    setting string\n}\n</code></pre>\n\n<p>And use \"github.com/jessevdk/go-flags\" to pass either <code>--config3.setting=stringValue</code> cmd arguments, or ENV variables <code>export CONFIG3_SETTING=stringValue</code>:</p>\n\n<pre><code>type Configuration interface {}\n\nconst DefaultFlags flags.Options = flags.HelpFlag | flags.PassDoubleDash\n\nfunc Parse(cfg Configuration) []string {\n    args, _ := flags.NewParser(cfg, DefaultFlags).Parse()\n\n    return args\n}\n</code></pre>\n\n<p>And your main should look something like this:</p>\n\n<pre><code>func main() {\n    // Parse the configuration.\n    var cfg Config\n    Parse(&amp;cfg)\n    service := NewService(cfg.Conf3.Setting)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1520322298, "post_id": 49057598, "comment_id": 85256112, "body": "Thanks you very much 1+, can you please provide some working example which I can test and use? like your second code snippet ?<a href=\"https://play.golang.org/\" rel=\"nofollow noreferrer\">play.golang.org</a>"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1520323430, "post_id": 49057598, "comment_id": 85256604, "body": "I try this code and it&#39;s not working...can you help please with dummy running example?"}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1520362082, "post_id": 49057598, "comment_id": 85280924, "body": "The Go Playground is not a great place to write/test/run solutions to your question, because it does not support defining multiple files or multiple packages: everything has to be in <code>package main</code> or imported from the standard library (<a href=\"https://stackoverflow.com/questions/36409302/which-packages-may-be-imported-in-the-go-playground\">list here</a>).  You could update your question to append the code that isn&#39;t working so I could help, or you could post it as a new question.  If I get a chance later I can also try to write a runnable example but it probably won&#39;t be in the Go Playground."}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1520420613, "post_id": 49057598, "comment_id": 85304868, "body": "thanks, if you can share your <code>working</code> code it will be great"}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1520439351, "post_id": 49057598, "comment_id": 85317773, "body": "@JennyHilton Added a runnable example"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1520500304, "post_id": 49057598, "comment_id": 85343752, "body": "It&#39;s looks ok but I couldnt check it. I give you the point you deserve it...but I&#39;ve some question after I check it ...Thanks!"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1523790246, "post_id": 49057598, "comment_id": 86696941, "body": "I&#39;ve opend another question with bounty please see if you can assit <a href=\"https://stackoverflow.com/questions/46511312/golang-template-with-switch-on-objcts\" title=\"golang template with switch on objcts\">stackoverflow.com/questions/46511312/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": true, "score": 3, "last_activity_date": 1520439231, "last_edit_date": 1520439231, "creation_date": 1519933772, "answer_id": 49057598, "question_id": 49004608, "link": "https://stackoverflow.com/questions/49004608/different-packages-with-different-config-props-functional-option/49057598#49057598", "title": "Different packages with different config props - Functional option", "body": "<p>It sounds like you're looking for an alternative to passing around the same configuration monolith structure to every package and every function.  There are many solutions to this problem (more than I'm going to list here), and which one is right for you requires more knowledge of your code and your goals than we have, so it's probably best if you decide.  And it sounds like you're wondering whether Dave Cheney's post on functional options provides a solution and how to apply it.</p>\n\n<p>If your application's configuration is static in that it's not likely to change (mutate) through different threads of execution, and you don't need to create multiple instances with different configurations in the same <code>main</code>, then one option is package level variables and package initialization.  If you object to exported package variables, you can use unexported package variables and control access via exported functions.  Say <code>run</code> and <code>build</code> are two different packages:</p>\n\n<pre><code>// package main\nimport(\n    \"github.com/profilename/appname/build\"\n    \"github.com/profilename/appname/run\"\n)\nfunc main() {\n    // do something to get configuration values\n    build.Initialize(buildFlavor, buildType)\n    // any post-build-initialize-pre-run-initialize stuff\n    run.Initialize(logLevel, port, host)\n    // other processing\n    build.PreBuild(\"title\") // other build functions may rely on configuration\n    build.Build()\n    // other stuff\n    run.ReadFiles(f1, f2)\n    run.Validate(preferredBackupPort) // port availability, chance to log.Fatal out\n    run.Run()\n    // cleanup\n}\n\n// package run\nvar Host string\nvar LogLevel, Port int\ninit() {\n    Host = `localhost`\n    Port = 8888\n    Loglevel = 1\n}\nfunc Initialize(logLevel, port int, host string) {\n    // validation, panic on failure\n    LogLevel = logLevel\n    Host = host\n    Port = port\n}\nfunc Run() {\n    // do something with LogLevel, Host, Port\n}\n</code></pre>\n\n<p>But that doesn't solve the problem addressed in Dave Cheney's post.  What if the user is running this without host, port, or buildType (or other configuration variables), because he doesn't need those features?  What if the user wants to run multiple instances with different configurations?</p>\n\n<p>Dave's approach is primarily intended for situations where you will not use package-level variables for configuration.  Indeed, it is meant to enable several instances of a thing where each instance can have a different configuration.  Your optional configuration parameters become a single variadic parameter where the type is a function that modifies a pointer to the thing being configured.  For you, that could be</p>\n\n<pre><code>// package run\ntype Runner struct {\n    Port        int\n    // rest of runner configuration\n}\nfunc NewRunner(options ...func(*Runner)) (runner *Runner, err error) {\n    // any setup\n    for _, option := range options {\n        err = option(runner)\n        if err != nil {\n            // do something\n        }\n    }\n    return runner, err\n}\n\n// package main\nfunc main() {\n    // do something to get configuration values\n    port := func(runner *Runner) {\n        runner.Port = configuredPort\n    }\n    // other configuration if applicable\n    runner := run.NewRunner(port)\n    // ...\n</code></pre>\n\n<p>In a way, Dave's approach appears targeted at packages that will be used as very flexible libraries, and will provide application interfaces that users might wish to create several instances of.  It allows for <code>main</code> definitions that launch multiple instances with different configurations.  In that post he doesn't go into detail on how to process configuration input in the <code>main</code> or on a configuration package.</p>\n\n<p>Note that the way the port is set in the resulting code above is not very different from this:</p>\n\n<pre><code>// package run\ntype Runner struct {\n    Port        int\n    // rest of runner configuration\n}\n\n// package main, func main()\n    runner := new(run.Runner)\n    runner.Port = configuredPort\n</code></pre>\n\n<p>which is more traditional, probably easier for most developers to read and understand, and a perfectly fine approach if it suits your needs.  (And you could make <code>runner.port</code> unexported and add a <code>func (r *Runner) SetPort(p int) { r.port = p }</code> method if you wanted.)  It is also a design that has the potential, depending on implementation, to deal with mutating configuration, multiple threads of execution (you'll need channels or the <code>sync</code> package to deal with mutation there), and multiple instances.</p>\n\n<p>Where the function options design Dave proposed becomes much more powerful than that approach is when you have many more statements related to the setting of the option that you want to place in <code>main</code> rather than in <code>run</code> -- those will make up the function body.</p>\n\n<hr>\n\n<p><strong>UPDATE</strong> Here's a runnable example using Dave's functional options approach, in two files.  Be sure to update the import path to match wherever you put the <code>run</code> package.</p>\n\n<p>Package <code>run</code>:</p>\n\n<pre><code>package run\n\nimport(\n    \"fmt\"\n    \"log\"\n)\n\nconst(\n    DefaultPort = 8888\n    DefaultHost = `localhost`\n    DefaultLogLevel = 1\n)\n\ntype Runner struct {\n    Port        int\n    Host        string\n    LogLevel    int\n}\n\nfunc NewRunner(options ...func(*Runner) error) (runner *Runner) {\n    // any setup\n\n    // set defaults\n    runner = &amp;Runner{DefaultPort, DefaultHost, DefaultLogLevel}\n\n    for _, option := range options {\n        err := option(runner)\n        if err != nil {\n            log.Fatalf(\"Failed to set NewRunner option: %s\\n\", err)\n        }\n    }\n    return runner\n}\n\nfunc (r *Runner) Run() {\n    fmt.Println(r)\n}\n\nfunc (r *Runner) String() string {\n    return fmt.Sprintf(\"Runner Configuration:\\n%16s %22d\\n%16s %22s\\n%16s %22d\",\n        `Port`, r.Port, `Host`, r.Host, `LogLevel`, r.LogLevel)\n}\n</code></pre>\n\n<p>Package <code>main</code>:</p>\n\n<pre><code>package main\n\nimport(\n    \"errors\"\n    \"flag\"\n    \"github.com/jrefior/run\" // update this path for your filesystem\n)\n\nfunc main() {\n    // do something to get configuration values\n    portFlag := flag.Int(\"p\", 0, \"Override default listen port\")\n    logLevelFlag := flag.Int(\"l\", 0, \"Override default log level\")\n    flag.Parse()\n\n    // put your runner options here\n    runnerOpts := make([]func(*run.Runner) error, 0)\n\n    // with flags, we're not sure if port was set by flag, so test\n    if *portFlag &gt; 0 {\n        runnerOpts = append(runnerOpts, func(runner *run.Runner) error {\n            if *portFlag &lt; 1024 {\n                return errors.New(\"Ports below 1024 are privileged\")\n            }\n            runner.Port = *portFlag\n            return nil\n        })\n    }\n    if *logLevelFlag &gt; 0 {\n        runnerOpts = append(runnerOpts, func(runner *run.Runner) error {\n            if *logLevelFlag &gt; 8 {\n                return errors.New(\"The maximum log level is 8\")\n            }\n            runner.LogLevel = *logLevelFlag\n            return nil\n        })\n    }\n    // other configuration if applicable\n    runner := run.NewRunner(runnerOpts...)\n    runner.Run()\n}\n</code></pre>\n\n<p>Example usage:</p>\n\n<pre><code>$ ./program -p 8987\nRunner Configuration:\n            Port                   8987\n            Host              localhost\n        LogLevel                      1\n</code></pre>\n"}], "owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 3, "accepted_answer_id": 49057598, "answer_count": 2, "score": 9, "last_activity_date": 1520439231, "creation_date": 1519721531, "last_edit_date": 1520338363, "question_id": 49004608, "link": "https://stackoverflow.com/questions/49004608/different-packages-with-different-config-props-functional-option", "title": "Different packages with different config props - Functional option", "body": "<p>I have an application which needs configuration and I\u2019ve created a configuration struct and I\u2019m entering the configuration as a parameter to the function. The problem is that the configuration struct becomes bigger (like monolith) and bigger and I move the config to different functions in my app and which doesn\u2019t need all the fields, just few of them. My question is if there is better approach to implement it in Go.</p>\n\n<p>After struggling to find good way I\u2019ve found this article (which a bit old but hopefully still relevant) and I wonder how and if I can use it to solve my problem.</p>\n\n<p>Functional options instead of config struct\n<a href=\"https://dave.cheney.net/2014/10/17/functional-options-for-friendly-apis\" rel=\"noreferrer\">https://dave.cheney.net/2014/10/17/functional-options-for-friendly-apis</a></p>\n\n<p>I need to inject some configuration properties to my application in </p>\n\n<p>For example for function <code>run</code> (which is entry point ) I need to inject the <code>log level</code> and some other env variable like <code>port</code> <code>host</code> </p>\n\n<p>For function <code>build</code> I need to  \u201cinject\u201d the <code>build flavor</code> and <code>build type</code> etc.</p>\n\n<p>Any example for my content will be very helpful</p>\n\n<ol>\n<li>How to structure it in the code ?</li>\n<li>How to implement it? </li>\n</ol>\n\n<p>update</p>\n\n<p>I need some E2E example how can I use the <strong>functional approach</strong>  for different configs in the same package and other packages</p>\n"}, {"tags": ["python", "go", "protocol-buffers"], "comments": [{"owner": {"reputation": 8597, "user_id": 1039481, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a10ec3de7bec751e1633eba0ef28d4cb?s=128&d=identicon&r=PG", "display_name": "Akhil Thayyil", "link": "https://stackoverflow.com/users/1039481/akhil-thayyil"}, "edited": false, "score": 0, "creation_date": 1519721954, "post_id": 49002056, "comment_id": 85013922, "body": "Please show us your proto file"}], "answers": [{"tags": [], "owner": {"reputation": 1714, "user_id": 4201748, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/77085485ce9b7c0ba971998b928048c0?s=128&d=identicon&r=PG", "display_name": "manigandand", "link": "https://stackoverflow.com/users/4201748/manigandand"}, "is_accepted": false, "score": 1, "last_activity_date": 1519726287, "creation_date": 1519726287, "answer_id": 49006108, "question_id": 49002056, "link": "https://stackoverflow.com/questions/49002056/protobuff-message-from-go-client-to-python-server/49006108#49006108", "title": "Protobuff message from go client to python server", "body": "<p>If I understood your question correctly, there is no problem with rpc message transfer. Instead, you are receiving the wrong message type. \nPlease make sure you are preparing the protobuf message in the correct format.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n)\n\ntype CreateProductInfo struct {\n    Name   string    `protobuf:\"bytes,1,opt,name=name\" json:\"name,omitempty\"`\n    Fruits []*Fruits `protobuf:\"bytes,2,opt,name=fruits\" json:\"fruits,omitempty\"`\n}\n\ntype Fruits struct {\n    Name string `protobuf:\"bytes,1,opt,name=name\" json:\"name,omitempty\"`\n}\n\nfunc main() {\n    productInfo := &amp;CreateProductInfo{\n        Name: \"product_info\",\n        Fruits: []*Fruits{\n            &amp;Fruits{\n                Name: \"apple\",\n            },\n            &amp;Fruits{\n                Name: \"orange\",\n            },\n            &amp;Fruits{\n                Name: \"mango\",\n            },\n        },\n    }\n\n    b, err := json.MarshalIndent(&amp;productInfo, \"\", \"\\t\")\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    os.Stdout.Write(b)\n}\n</code></pre>\n\n<p>This returns like this.</p>\n\n<pre><code>{\n    \"name\": \"product_info\",\n    \"fruits\": [\n        {\n            \"name\": \"apple\"\n        },\n        {\n            \"name\": \"orange\"\n        },\n        {\n            \"name\": \"mango\"\n        }\n    ]\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Kd66eJa1e8r\" rel=\"nofollow noreferrer\">Go-Playground link</a></p>\n"}], "owner": {"reputation": 2208, "user_id": 4408364, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/100003785465637/picture?type=large", "display_name": "Prakash Pandey", "link": "https://stackoverflow.com/users/4408364/prakash-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519726287, "creation_date": 1519711076, "last_edit_date": 1519718556, "question_id": 49002056, "link": "https://stackoverflow.com/questions/49002056/protobuff-message-from-go-client-to-python-server", "title": "Protobuff message from go client to python server", "body": "<p>I want to send a message from go client to python server.\nI am using protobuff for the same.</p>\n\n<p><strong>Go side message structure</strong></p>\n\n<pre><code>type CreateProductInfo struct  {\n  name string\n  fruits []*Fruits\n}\n\ntype Fruits struct  {\n name string\n}\n</code></pre>\n\n<p>I am expecting the below response in my python server.</p>\n\n<pre><code>{\n   name : \"product_info\"\n   fruits : [\n              {\n                name : \"Apple\"\n              }\n            ]\n }\n</code></pre>\n\n<p>Instead, I'm getting this. </p>\n\n<pre><code> {\n   name : \"product_info\"\n   fruits : [\n\n                name : \"Apple\"\n\n            ]\n }\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1519713355, "post_id": 49001820, "comment_id": 85009628, "body": "Which approaches have you tried? What problems did you encounter or do you anticipate?"}, {"owner": {"reputation": 194, "user_id": 3917195, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b8ad0b585812c3df7d5fbbf751c1926d?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhi Agarwal", "link": "https://stackoverflow.com/users/3917195/nidhi-agarwal"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1519717237, "post_id": 49001820, "comment_id": 85011345, "body": "I have made a separate package for db and have a global variable for connection pool. Then import it in both packages. But is it the right way to handle it? And one more thing again in future if i come across same situation again.. i will have to add a new package each time ?"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1519722412, "post_id": 49001820, "comment_id": 85014172, "body": "Create a global package containing the configurations and import it in your packages."}], "answers": [{"comments": [{"owner": {"reputation": 194, "user_id": 3917195, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b8ad0b585812c3df7d5fbbf751c1926d?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhi Agarwal", "link": "https://stackoverflow.com/users/3917195/nidhi-agarwal"}, "edited": false, "score": 0, "creation_date": 1519717137, "post_id": 49003132, "comment_id": 85011291, "body": "I like to make a different package all together and import in both the packages. But the problem is i have read that keeping global variables is not a good practice. One more thing it was just db.. same thing will have to do with auth also as my both packages requires auth. Again i will have to make a new package for auth and keep auth it as a global variable. This approach will end up so many packages in this project."}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "reply_to_user": {"reputation": 194, "user_id": 3917195, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b8ad0b585812c3df7d5fbbf751c1926d?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhi Agarwal", "link": "https://stackoverflow.com/users/3917195/nidhi-agarwal"}, "edited": false, "score": 0, "creation_date": 1519718184, "post_id": 49003132, "comment_id": 85011805, "body": "@NidhiAgarwal Please see the edit on my answer. Also, what type of variable is auth and what do you do with it? If you write from different goroutines you will need to make it thread safe"}, {"owner": {"reputation": 194, "user_id": 3917195, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b8ad0b585812c3df7d5fbbf751c1926d?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhi Agarwal", "link": "https://stackoverflow.com/users/3917195/nidhi-agarwal"}, "edited": false, "score": 0, "creation_date": 1520339848, "post_id": 49003132, "comment_id": 85266539, "body": "Thank you for your help. I am one more doubt. So i am moving all my common packages to a global package. But for example i export my conn from sql package (global -&gt; sql -&gt; sql.go) and use it in some other package. I may need some struct type also from actual sql package to define variables here. How do i export them from global?"}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "reply_to_user": {"reputation": 194, "user_id": 3917195, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b8ad0b585812c3df7d5fbbf751c1926d?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhi Agarwal", "link": "https://stackoverflow.com/users/3917195/nidhi-agarwal"}, "edited": false, "score": 0, "creation_date": 1520377978, "post_id": 49003132, "comment_id": 85288523, "body": "@NidhiAgarwal I don&#39;t think it&#39;s wrong if you just use those structs directly from the sql package, and just leave in global the DB connection, but if you want to have it all on the same package you need to create a new exported type type in your global package, and then convert them to the sql type when you use them in a function that needs them. You can do this by creating a new type using the sql struct as the base: <code>type MyStruct sql.StructName</code> and read this to learn about type conversions: <code>type MyStruct sql.StructName</code>"}], "tags": [], "owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "is_accepted": true, "score": 2, "last_activity_date": 1519718044, "last_edit_date": 1519718044, "creation_date": 1519715719, "answer_id": 49003132, "question_id": 49001820, "link": "https://stackoverflow.com/questions/49001820/how-to-share-single-database-connection-between-multiple-packages/49003132#49003132", "title": "How to share single database connection between multiple packages", "body": "<p>There's lots of ways to do this and each approach has pros and cons and it really depends on what you are doing. One easy way to do this is to have a third package with the DB connection and import it from the other two packages and from the main package.</p>\n\n<pre><code>app\n  -&gt; client pkg // import \"app/global\"\n  -&gt; worker pkg // import \"app/global\"\n  -&gt; global pkg // Contains ssdb and auth as global variables\n  main.go\n</code></pre>\n\n<p>Another approach that might be better depending on what you are doing is to have the functions on the <code>client</code> and <code>worker</code> packages accept a db connection as a parameter and from <code>main.go</code> initialize the db and pass it as a parameter when you call a function that needs it.</p>\n\n<p>It depends on what you are doing but for big projects it's easier to maintain if you just have one package doing all your db operations and you access it from all the places you need to do something. That way you don't have to worry about this issue because only one package has to worry about the db connection even if several packages use it.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>The problem with global variables is that they can be modified at the same time from everywhere in your project and it can introduce race conditions, but there is nothing wrong in using them when this is not an issue. </p>\n\n<p>In this case, you are just setting the value once, when you connect to the DB and then just use the object.</p>\n\n<p>You mentioned you want to have another package for the auth, I recommend just having one package and having in it everything you need to access from more than one package, in this case ssdb and auth.</p>\n"}, {"comments": [{"owner": {"reputation": 321, "user_id": 917946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JvXJ7.jpg?s=128&g=1", "display_name": "JulienTant", "link": "https://stackoverflow.com/users/917946/julientant"}, "edited": false, "score": 1, "creation_date": 1524729077, "post_id": 49014343, "comment_id": 87091317, "body": "Jeeennnkiiinnnsssss"}], "tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": false, "score": 1, "last_activity_date": 1539433469, "last_edit_date": 1539433469, "creation_date": 1519751622, "answer_id": 49014343, "question_id": 49001820, "link": "https://stackoverflow.com/questions/49001820/how-to-share-single-database-connection-between-multiple-packages/49014343#49014343", "title": "How to share single database connection between multiple packages", "body": "<p>Here's one approach that is not always obvious to new Go developers, is a little elbow grease to implement but not terribly\ncomplex, and usually works fine in beginner apps:</p>\n\n<pre><code>app\n    client // imports storage\n    worker // imports storage\n    config // all environment-related config goes here\n    storage   // storage-engine-generic interface to the packages below it\n        ssdb  // all ssdb-specific code here\n        mysql // all mysql-specific code here\n        redis // ditto\n</code></pre>\n\n<p>It uses package variables.  If you're paranoid about an accidental write to an exported package variable, you can avoid the problem by using unexported package variables.  Take advantage of the\nlimited definition of Exported Identifiers in Go (see <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">language\nspecification</a>).</p>\n\n<p>In <code>main</code>, call</p>\n\n<pre><code>config.Init(configfile)\nstorage.Init()\n</code></pre>\n\n<p>Define your <code>config.Init</code> function to read the config file and set package variables to the connection information for your\ndatabases.  If you're using enexported package variables, then allow public read-only access through exported functions.  Otherwise you may be able to skip the functions, depending on what other features you want.</p>\n\n<p>In <code>storage</code>, your <code>Init</code> function calls</p>\n\n<pre><code>ssdb.Init()\nmysql.Init()\nredis.Init()\n</code></pre>\n\n<p>Then also in <code>storage</code> you'll have public functions that <code>client</code> and <code>server</code> use that aren't specific to a storage engine, such as</p>\n\n<pre><code>func GetImage(id string) ([]byte) {\n    return mysql.GetImage(id)\n}\n</code></pre>\n\n<p>or whatever is appropriate for your application.  The <code>storage</code> level of abstraction may or may not be worth it for you depending on how you change your app in the future.  You decide whether it's worth investing in it.</p>\n\n<p>In <code>mysql</code> package, you import <code>config</code>, and you have something like</p>\n\n<pre><code>var db *sql.DB\nfunc Init() {\n    getDb()\n}\nfunc getDb() (*sql.DB) {\n    if db == nil {  // or something\n        config.Log.Println(\"Opening db connection to mysql\")\n        db, err := sql.Open(\"mysql\", config.MysqlConnectionString())\n        // do something with err, possibly have a retry loop\n    }\n    return db\n}\nfunc GetImage(id string) ([]byte)\n     db := getDb()\n     // ...\n</code></pre>\n\n<p>The functions in the mysql package can use the <code>db</code> unexported package variable, but other packages cannot.</p>\n\n<p>Using an unexported package variable with exported-function read-only access is not a terrible practice or particularly complex.  That said, it's usually unecessary.  If <code>db</code> were the exported package variable <code>Db</code>, would you suddenly type</p>\n\n<pre><code>mysql.Db, _ = sql.Open(\"mysql\", \"LEEERRROOYYYYY!!!!\")\n</code></pre>\n\n<p>in your <code>client</code> code (and also decide to import <code>mysql</code> and <code>sql</code> to do it) and then deploy to production?  Why would you be more likely to do that than to intentionally break any other part of your code?</p>\n\n<p>Note that if you just typed</p>\n\n<pre><code>mysql.Db = \"LEEERRROOYYYYYY!!!!\"\n</code></pre>\n\n<p>Your application would fail to compile because of a type mismatch.</p>\n"}], "owner": {"reputation": 194, "user_id": 3917195, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b8ad0b585812c3df7d5fbbf751c1926d?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhi Agarwal", "link": "https://stackoverflow.com/users/3917195/nidhi-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1166, "favorite_count": 1, "accepted_answer_id": 49003132, "answer_count": 2, "score": 1, "last_activity_date": 1539433469, "creation_date": 1519709872, "last_edit_date": 1519712712, "question_id": 49001820, "link": "https://stackoverflow.com/questions/49001820/how-to-share-single-database-connection-between-multiple-packages", "title": "How to share single database connection between multiple packages", "body": "<p>I have two packages named client and worker. I want to share same ssdb, mysql and redis connection with both the packages.\nOne more similar problem that i am facing to share auth between these two packages.</p>\n\n<pre><code>app\n  -&gt; client pkg\n  -&gt; worker pkg\n  main.go (contains auth as global variable)\n</code></pre>\n\n<p>Can anyone please suggest me the best way to implement these two things ?</p>\n"}, {"tags": ["shell", "go", "command-substitution"], "answers": [{"tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": true, "score": 3, "last_activity_date": 1519708178, "creation_date": 1519708178, "answer_id": 49001528, "question_id": 49001114, "link": "https://stackoverflow.com/questions/49001114/shell-expansion-command-substitution-in-golang/49001528#49001528", "title": "Shell Expansion (Command substitution) in Golang", "body": "<p>There's no built in function for this, but you can write a function and pass it to <code>os.Expand()</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"os/exec\"\n    \"strings\"\n)\n\nfunc RunProgram(program string) string {\n    a := strings.Split(program, \" \")\n    out, err := exec.Command(a[0], a[1:]...).Output()\n    if err != nil {\n        panic(err)\n    }\n    return string(out)\n}\n</code></pre>\n\n<p>// You then call it as:</p>\n\n<pre><code>func main() {\n    s := os.Expand(\"test-${date +%H:%M}\", RunProgram)\n    fmt.Print(s)\n}\n</code></pre>\n\n<p>This outputs:</p>\n\n<pre><code>test-13:09\n</code></pre>\n\n<p>Note that <code>os.Expand()</code> expects curly braces, i.e. <code>${command args args args}</code>.</p>\n"}], "owner": {"reputation": 318, "user_id": 3949193, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ixPGq.jpg?s=128&g=1", "display_name": "jwong", "link": "https://stackoverflow.com/users/3949193/jwong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 913, "favorite_count": 1, "accepted_answer_id": 49001528, "answer_count": 1, "score": 3, "last_activity_date": 1519708178, "creation_date": 1519705373, "question_id": 49001114, "link": "https://stackoverflow.com/questions/49001114/shell-expansion-command-substitution-in-golang", "title": "Shell Expansion (Command substitution) in Golang", "body": "<p>Go has the support for <strong>variable expansion</strong>, for example:</p>\n\n<blockquote>\n  <p>os.ExpandEnv(\"test-<strong>${USER}</strong>\")`</p>\n  \n  <p>>> \"test-MyName\"</p>\n</blockquote>\n\n<p>But is there a way of expanding <strong>executables</strong>, as the way the shell behaves?</p>\n\n<p>Something like </p>\n\n<blockquote>\n  <p>os.ExpandExecutable(\"test-<strong>$(date +%H:%M)</strong>\")</p>\n  \n  <p>>> \"test-18:20\"</p>\n</blockquote>\n\n<p>I cannot find an equivalent method for this, is there an elegant way of doing this instead of manually extracting the placeholders out, executing and then replacing them?</p>\n"}, {"tags": ["go", "aws-lambda"], "comments": [{"owner": {"reputation": 559, "user_id": 3539609, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/qKHK3.jpg?s=128&g=1", "display_name": "Sudip", "link": "https://stackoverflow.com/users/3539609/sudip"}, "edited": false, "score": 2, "creation_date": 1519707418, "post_id": 49000980, "comment_id": 85007698, "body": "Can you please check while extracting the zip, if it creates an additional folder? something like var/task/hello/hello&quot;. This can be possible cause. But you said that while downloading it locally, it creates the same exact path. Just a hunch maybe."}, {"owner": {"reputation": 663, "user_id": 1043636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926a7e9d35a01745fc3e1cfeed30349e?s=128&d=identicon&r=PG", "display_name": "Arien Malec", "link": "https://stackoverflow.com/users/1043636/arien-malec"}, "reply_to_user": {"reputation": 559, "user_id": 3539609, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/qKHK3.jpg?s=128&g=1", "display_name": "Sudip", "link": "https://stackoverflow.com/users/3539609/sudip"}, "edited": false, "score": 0, "creation_date": 1519712471, "post_id": 49000980, "comment_id": 85009289, "body": "well, that was an issue with one of the zip files, but the one I&#39;m uploading now only contains the <code>hello</code> executable. Weird."}, {"owner": {"reputation": 663, "user_id": 1043636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926a7e9d35a01745fc3e1cfeed30349e?s=128&d=identicon&r=PG", "display_name": "Arien Malec", "link": "https://stackoverflow.com/users/1043636/arien-malec"}, "reply_to_user": {"reputation": 559, "user_id": 3539609, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/qKHK3.jpg?s=128&g=1", "display_name": "Sudip", "link": "https://stackoverflow.com/users/3539609/sudip"}, "edited": false, "score": 0, "creation_date": 1519713038, "post_id": 49000980, "comment_id": 85009510, "body": "Nope, that was exactly the issue - was looking at the wrong zip"}, {"owner": {"reputation": 559, "user_id": 3539609, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/qKHK3.jpg?s=128&g=1", "display_name": "Sudip", "link": "https://stackoverflow.com/users/3539609/sudip"}, "edited": false, "score": 0, "creation_date": 1519717551, "post_id": 49000980, "comment_id": 85011510, "body": "been there.. :P"}], "answers": [{"comments": [{"owner": {"reputation": 245, "user_id": 9225868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2497890025d8398ea46d9f785810ca2a?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Salzman", "link": "https://stackoverflow.com/users/9225868/matt-salzman"}, "edited": false, "score": 0, "creation_date": 1603042782, "post_id": 56309115, "comment_id": 113904546, "body": "2020: To change the Handler name go to the &#39;Basic settings&#39; pane"}], "tags": [], "owner": {"reputation": 1563, "user_id": 1619003, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wKhdR.png?s=128&g=1", "display_name": "GraphicalDot", "link": "https://stackoverflow.com/users/1619003/graphicaldot"}, "is_accepted": false, "score": 7, "last_activity_date": 1558822175, "creation_date": 1558822175, "answer_id": 56309115, "question_id": 49000980, "link": "https://stackoverflow.com/questions/49000980/deploying-aws-lambda-with-go-cloudformation/56309115#56309115", "title": "Deploying AWS Lambda with Go &amp; Cloudformation", "body": "<pre><code>{\n  \"errorMessage\": \"fork/exec /var/task/hello: no such file or directory\",\n  \"errorType\": \"PathError\"\n}\n</code></pre>\n\n<p>This will look for the hello function in your zipfile as an starting point of the Application. If you want to continue with the main function or some other function</p>\n\n<pre><code>func main() {\n    lambda.Start(HandleLambdaEvent)\n}\n</code></pre>\n\n<p>You need to change the handler Name on AWS Lambda function template (By default it is hello).\n<a href=\"https://i.stack.imgur.com/XWXjX.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/XWXjX.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 663, "user_id": 1043636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926a7e9d35a01745fc3e1cfeed30349e?s=128&d=identicon&r=PG", "display_name": "Arien Malec", "link": "https://stackoverflow.com/users/1043636/arien-malec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4341, "favorite_count": 1, "answer_count": 1, "score": 11, "last_activity_date": 1558822175, "creation_date": 1519704658, "last_edit_date": 1519745512, "question_id": 49000980, "link": "https://stackoverflow.com/questions/49000980/deploying-aws-lambda-with-go-cloudformation", "title": "Deploying AWS Lambda with Go &amp; Cloudformation", "body": "<p>I'm working through an automated deployment of a Go-based AWS Lambda, and having issues.</p>\n\n<p>My AWS Serverless template is:</p>\n\n<pre><code>AWSTemplateFormatVersion: '2010-09-09'\nTransform: AWS::Serverless-2016-10-31\nResources:\n  HelloLambda:\n    Type: AWS::Serverless::Function\n    Properties:\n      Handler: hello\n      Runtime: go1.x\n      CodeUri: ./deploy/hello.zip\n      Environment:\n        Variables: \n          S3_BUCKET: hello_lambda\n</code></pre>\n\n<p>I deploy this via:</p>\n\n<pre><code>GOOS=linux GOARCH=amd64 go build -o ./deploy/hello\nzip ./deploy/hello.zip ./deploy/hello\naws cloudformation package \\\n   --template-file hello.yaml \\\n   --output-template-file serverless-deploy_hello.yaml \\\n   --s3-bucket hello_deploy\naws cloudformation deploy\\\n --template-file serverless-deploy_hello.yaml\\\n  --stack-name hello-lambda\\\n  --capabilities CAPABILITY_IAM\n</code></pre>\n\n<p>When Cloudformation does its thing, <code>serverless-deploy_hello.yaml</code> has <code>CodeUri: s3://hello_deploy/17ab86653aab79eee51fc6f77d7a152e</code> and that s3 bucket contains the zip file (when I download it locally &amp; use <code>cmp</code> it's bit-identical).</p>\n\n<p>BUT when I test the resulting Lambda, it gives me:</p>\n\n<pre><code>{\n  \"errorMessage\": \"fork/exec /var/task/hello: no such file or directory\",\n  \"errorType\": \"PathError\"\n}\n</code></pre>\n\n<p>Not quite sure what I'm doing wrong here....</p>\n\n<p>==== RESOLVED ====</p>\n\n<p>The zip command above zips the directory path as well, so the executable unzips to <code>deploy/hello</code> rather than <code>./hello</code>.</p>\n\n<p>Accordingly, the Lambda runtime can't connect to the process.</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 31533, "user_id": 2813224, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/602e78d7da7bd6353c8ee51a17826037?s=128&d=identicon&r=PG", "display_name": "zer00ne", "link": "https://stackoverflow.com/users/2813224/zer00ne"}, "edited": false, "score": 0, "creation_date": 1519705604, "post_id": 49000832, "comment_id": 85007217, "body": "I believe regex is declarative and direct use of string patterns limits it&#39;s capabilities. You need simple <code>if&#47;if else</code> conditions, not regex."}, {"owner": {"reputation": 3034, "user_id": 6101071, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b1da77c00202a8477bee1a68950824f?s=128&d=identicon&r=PG&f=1", "display_name": "Srdjan M.", "link": "https://stackoverflow.com/users/6101071/srdjan-m"}, "edited": false, "score": 0, "creation_date": 1519705764, "post_id": 49000832, "comment_id": 85007270, "body": "What are you using? python, php...?"}, {"owner": {"reputation": 106, "user_id": 1617440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvsVz.jpg?s=128&g=1", "display_name": "Sudarshan Reddy", "link": "https://stackoverflow.com/users/1617440/sudarshan-reddy"}, "reply_to_user": {"reputation": 3034, "user_id": 6101071, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b1da77c00202a8477bee1a68950824f?s=128&d=identicon&r=PG&f=1", "display_name": "Srdjan M.", "link": "https://stackoverflow.com/users/6101071/srdjan-m"}, "edited": false, "score": 0, "creation_date": 1519715068, "post_id": 49000832, "comment_id": 85010286, "body": "@S.Jovan I&#39;m using Go."}, {"owner": {"reputation": 106, "user_id": 1617440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvsVz.jpg?s=128&g=1", "display_name": "Sudarshan Reddy", "link": "https://stackoverflow.com/users/1617440/sudarshan-reddy"}, "reply_to_user": {"reputation": 31533, "user_id": 2813224, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/602e78d7da7bd6353c8ee51a17826037?s=128&d=identicon&r=PG", "display_name": "zer00ne", "link": "https://stackoverflow.com/users/2813224/zer00ne"}, "edited": false, "score": 0, "creation_date": 1519715157, "post_id": 49000832, "comment_id": 85010316, "body": "@zer00ne, I am able to handle it programmatically with conditions. I however would like to know if it could be done with regex too / if it&#39;s more efficient/ readable/ idiomatic."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1519721956, "post_id": 49000832, "comment_id": 85013924, "body": "No, this cannot be done with a regular expression."}], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1519716345, "post_id": 49003190, "comment_id": 85010874, "body": "But is alternation specified to behave the way you want it to? Referencing <a href=\"https://golang.org/pkg/regexp/syntax/\" rel=\"nofollow noreferrer\">golang.org/pkg/regexp/syntax</a> or the spec would be a good idea."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 1, "creation_date": 1519716999, "post_id": 49003190, "comment_id": 85011220, "body": "Regex generally prefers longest leftmost, so yes, order of alternatives matters and indicates an order of precedence."}, {"owner": {"reputation": 855, "user_id": 1700976, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/yPo6J.jpg?s=128&g=1", "display_name": "Divisadero", "link": "https://stackoverflow.com/users/1700976/divisadero"}, "edited": false, "score": 0, "creation_date": 1519717947, "post_id": 49003190, "comment_id": 85011692, "body": "Can be written easier: (\\d+)\\s+{.*(success|processing|failed).*}"}], "tags": [], "owner": {"reputation": 3034, "user_id": 6101071, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b1da77c00202a8477bee1a68950824f?s=128&d=identicon&r=PG&f=1", "display_name": "Srdjan M.", "link": "https://stackoverflow.com/users/6101071/srdjan-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1519716785, "last_edit_date": 1519716785, "creation_date": 1519715947, "answer_id": 49003190, "question_id": 49000832, "link": "https://stackoverflow.com/questions/49000832/how-does-one-give-priority-to-one-word-over-others-while-matching/49003190#49003190", "title": "How does one give priority to one word over others while matching?", "body": "<p><strong>Regex</strong>: <a href=\"https://regex101.com/r/nCJyGe/2\" rel=\"nofollow noreferrer\"><code>\\{.*(success).*|\\{.*(processing).*|\\{.*(failed).*</code></a> Substitution: <code>$1$2$3</code></p>\n\n<p><a href=\"http://golang.org/pkg/regexp/syntax\" rel=\"nofollow noreferrer\">Details</a>:</p>\n\n<ul>\n<li><code>.*</code> matches any character zero or more times</li>\n<li><code>()</code> Capturing group</li>\n<li><code>|</code> Or</li>\n</ul>\n\n<p><strong>Go code</strong>:</p>\n\n<pre><code>var re = regexp.MustCompile(`\\{.*(success).*|\\{.*(processing).*|\\{.*(failed).*`)\ns := re.ReplaceAllString(sample, `$1$2$3`)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>ID    AllStatuses\n1001  success\n1002  failed\n1003  success\n1004  success\n1005  processing\n</code></pre>\n\n<p><a href=\"https://ideone.com/x54K8G\" rel=\"nofollow noreferrer\">Code demo</a></p>\n"}, {"tags": [], "owner": {"reputation": 855, "user_id": 1700976, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/yPo6J.jpg?s=128&g=1", "display_name": "Divisadero", "link": "https://stackoverflow.com/users/1700976/divisadero"}, "is_accepted": false, "score": 1, "last_activity_date": 1519718003, "creation_date": 1519718003, "answer_id": 49003699, "question_id": 49000832, "link": "https://stackoverflow.com/questions/49000832/how-does-one-give-priority-to-one-word-over-others-while-matching/49003699#49003699", "title": "How does one give priority to one word over others while matching?", "body": "<pre><code>(\\d+)\\s+{.*(success|processing|failed).*}\n</code></pre>\n\n<p>Then take the match from \ngroup 1: ID \ngroup 2: status</p>\n"}, {"tags": [], "owner": {"reputation": 506, "user_id": 9369297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/788ec58ba9fd88e4a9789fdf8ea7350c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Denis", "link": "https://stackoverflow.com/users/9369297/a-denis"}, "is_accepted": false, "score": 0, "last_activity_date": 1519718962, "creation_date": 1519718962, "answer_id": 49003943, "question_id": 49000832, "link": "https://stackoverflow.com/questions/49000832/how-does-one-give-priority-to-one-word-over-others-while-matching/49003943#49003943", "title": "How does one give priority to one word over others while matching?", "body": "<p>You can make it with <strong>one regex</strong>, but with additional checks of needed elements at the end in order you need this time. </p>\n\n<p>It is not so short, but I am sure that this is more stable, especially if there will be some changes in algorithm.</p>\n\n<p>Example in javascript, but I am sure, you can easily implement idea in your code</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var obResults = {};\r\nvar obStrings = {\r\n  1001:  \"{failed|processing|success}\",\r\n  1002:  \"{failed}\",\r\n  1003:  \"{success|failed}\",\r\n  1004:  \"{processing|success}\",\r\n  1005:  \"{failed|processing}\",\r\n};\r\n\r\nfor (var key in obStrings) {\r\n  var stringToCheck = obStrings[key];\r\n  var resultString = \"\";\r\n  var arMathces = stringToCheck.match( /(failed|processing|success)/ig );\r\n  \r\n  if (arMathces.indexOf(\"success\") != -1) {  \r\n    resultString = \"success\";\r\n  } else if (arMathces.indexOf(\"processing\") != -1) {  \r\n    resultString = \"processing\";\r\n  } else if (arMathces.indexOf(\"failed\") != -1) {  \r\n    resultString = \"failed\";\r\n  }\r\n  \r\n  obResults[key] = { result:resultString, check:stringToCheck };\r\n}\r\nconsole.log(obResults);</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 106, "user_id": 1617440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvsVz.jpg?s=128&g=1", "display_name": "Sudarshan Reddy", "link": "https://stackoverflow.com/users/1617440/sudarshan-reddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 49003190, "answer_count": 3, "score": 1, "last_activity_date": 1519721572, "creation_date": 1519703560, "last_edit_date": 1519721572, "question_id": 49000832, "link": "https://stackoverflow.com/questions/49000832/how-does-one-give-priority-to-one-word-over-others-while-matching", "title": "How does one give priority to one word over others while matching?", "body": "<p>I have the following list.</p>\n\n<pre><code>ID    AllStatuses\n1001  {failed|processing|success}\n1002  {failed}\n1003  {success|failed}\n1004  {processing|success}\n1005  {failed|processing}\n</code></pre>\n\n<p>My requirement is to display the most optimistic status alone. Like so</p>\n\n<pre><code>ID    Best Status\n1001  success\n1002  failed\n1003  success\n1004  success\n1005  processing\n</code></pre>\n\n<p>Is there a way I can do this with one regex query rather than say check for each one in order and return where i'd have a worst case scenario of three regex checks for statuses with the most optimistic status in the end? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1519715457, "post_id": 49000797, "comment_id": 85010443, "body": "Create a bat file running first <code>setup_env.bat</code> and then <code>some_binary.exe</code> and call that one from Go."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1519719829, "post_id": 49000797, "comment_id": 85012618, "body": "The whole concept of an environment makes it impossible to do what you want. Use something along what md2perpe suggested."}], "answers": [{"tags": [], "owner": {"reputation": 1605, "user_id": 1339615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6MHBM.png?s=128&g=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/1339615/julian"}, "is_accepted": true, "score": 0, "last_activity_date": 1519782590, "creation_date": 1519782590, "answer_id": 49020769, "question_id": 49000797, "link": "https://stackoverflow.com/questions/49000797/is-it-possible-to-capture-environment-variables-set-by-an-external-command/49020769#49020769", "title": "Is it possible to capture environment variables set by an external command?", "body": "<p>I managed to produce the desired result with the following code:</p>\n\n<pre><code>cmd := exec.Command(\"setup_env.bat\", \"&amp;&amp;\", \"some_binary.exe\")\ncmd.Run()\n</code></pre>\n\n<p>I also discovered it's possible to manually parse the environment variables by capturing <code>stdout</code> after printing the environment with <code>SET</code>. For example:</p>\n\n<pre><code>func getEnv(command string) ([]string, error) {\n    cmd := exec.Command(command, \"&amp;&amp;\", \"SET\")\n    out, _ := cmd.StdoutPipe()\n\n    err := cmd.Start()\n    if err != nil {\n        return nil, err\n    }\n\n    rawEnv, _ := ioutil.ReadAll(out)\n\n    err = cmd.Wait()\n    if err != nil {\n        return nil, err\n    }\n\n    env := strings.Split(string(rawEnv), \"\\r\\n\")\n    return env[:len(env)-1], nil\n}\n\n// ...\n\ncmd := exec.Command(\"some_binary.exe\")\nenv, err := getEnv(\"setup_env.bat\")\nif err != nil {\n    log.Fatal(err)\n}\ncmd.Env = env // or os.Setenv(...) if you need it in current context\ncmd.Run()\n</code></pre>\n"}], "owner": {"reputation": 1605, "user_id": 1339615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6MHBM.png?s=128&g=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/1339615/julian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 49020769, "answer_count": 1, "score": 0, "last_activity_date": 1519782590, "creation_date": 1519703319, "question_id": 49000797, "link": "https://stackoverflow.com/questions/49000797/is-it-possible-to-capture-environment-variables-set-by-an-external-command", "title": "Is it possible to capture environment variables set by an external command?", "body": "<p>I have a script (on Windows) that sets a number of environment variables. I would like to execute this script in Go to set up environment variables for subsequent calls to a binary.</p>\n\n<p>Something like this:</p>\n\n<pre><code>cmd1 := exec.Command(\"setup_env.bat\")\ncmd.Run()\n\n// other_command.exe relies on environment variables\n// set by setup_env.bat\ncmd2 := exec.Command(\"some_binary.exe\")\ncmd2.Env = cmd1.Env\ncmd2.Run()\n</code></pre>\n\n<p>However this doesn't work, as <code>cmd1.Env</code> is empty after calling <code>cmd1.Run()</code> (environment variables set in <code>cmd1</code> don't seem to propagate to <code>cmd1.Env</code>). <code>os.Environ()</code> also seems unaffected after calling <code>cmd1.Run()</code>.</p>\n\n<p>If you're curious as to why I'm doing this, I'm trying to automate a task that normally requires the user to call <code>setup_env.bat</code> followed by <code>other_command.exe</code> in a command prompt. I do not own <code>setup_env.bat</code>, and it may change frequently, so I can't just set the environment variables myself in Go.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1519697563, "post_id": 48999952, "comment_id": 85005320, "body": "You can&#39;t return values if your function doesn&#39;t declare any return values. Try starting with the <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">Tour of Go</a>."}, {"owner": {"reputation": 55, "user_id": 8431001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23396f07b186686733ca6899622e5a26?s=128&d=identicon&r=PG&f=1", "display_name": "920smmsmsms", "link": "https://stackoverflow.com/users/8431001/920smmsmsms"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1519698343, "post_id": 48999952, "comment_id": 85005504, "body": "Yeah, I figure it out before you comment, but still, isn&#39;t clear what to put as the first value of the generatePresignedPutUrl. Could you check my updates?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1519698872, "post_id": 48999952, "comment_id": 85005618, "body": "It says in the error message: <code>cannot assign *url.URL to url (type string)</code> -- you have a <code>*url.URL</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1988, "user_id": 6716410, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbA3G.png?s=128&g=1", "display_name": "sf9v", "link": "https://stackoverflow.com/users/6716410/sf9v"}, "is_accepted": false, "score": 0, "last_activity_date": 1519702912, "last_edit_date": 1519702912, "creation_date": 1519701661, "answer_id": 49000576, "question_id": 48999952, "link": "https://stackoverflow.com/questions/48999952/too-many-arguments-to-return-in-go-program/49000576#49000576", "title": "Too many arguments to return in Go program", "body": "<p>From the godoc of <a href=\"https://godoc.org/github.com/minio/minio-go\" rel=\"nofollow noreferrer\">github.com/minio-go</a>, <a href=\"https://godoc.org/github.com/minio/minio-go#Client.PresignedPutObject\" rel=\"nofollow noreferrer\">Client.PresignedPutObject</a>. returns a <a href=\"https://godoc.org/net/url#URL\" rel=\"nofollow noreferrer\">*url.URL</a> and an <code>error</code> </p>\n\n<p>(i.e. <code>url, err := svc.PresignedPutObject(aws.BucketHost, aws.BucketKey, time.Second * 24 * 60 * 60)</code> )</p>\n\n<p>From your code, you probably want the url string right? </p>\n\n<p>If that's what you want, you can refer to this example from the godoc of <a href=\"https://godoc.org/net/url#URL\" rel=\"nofollow noreferrer\">*url.URL</a>:</p>\n\n<p>Also, you can't just return an error from your function, <code>you have to return a string and an error</code>.</p>\n\n<p>Modifying your code to return a url string, you can probably do something like this:</p>\n\n<pre><code>func generatePresignedPutUrl() (url string, err error) {\n    var aws AWS\n    if err := envconfig.Process(\"aws\", &amp;aws); err != nil {\n        return \"\", err\n    }\n\n    svc, err := minio.New(aws.Endpoint, aws.AccessKeyId, aws.SecretAccessKey, aws.SSL)\n    if err != nil {\n        return \"\", err\n    }\n\n    u, err := svc.PresignedPutObject(aws.BucketHost, aws.BucketKey, time.Second * 24 * 60 * 60)\n    if err != nil {\n        return \"\", err\n    }\n    url = u.String()\n    return url, err\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "is_accepted": true, "score": 0, "last_activity_date": 1519701926, "creation_date": 1519701926, "answer_id": 49000612, "question_id": 48999952, "link": "https://stackoverflow.com/questions/48999952/too-many-arguments-to-return-in-go-program/49000612#49000612", "title": "Too many arguments to return in Go program", "body": "<p>First things first, you should really do the <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">tour of go</a> as JimB said. It takes less than an hour and you would know the answer to this questions.</p>\n\n<p>Notice that you are declaring <code>url</code> and <code>err</code> on the return declaration of <code>generatePresignedPutUrl()</code> and it doesn't look like that was what you wanted to do. You should change the function declaration from:</p>\n\n<pre><code>func generatePresignedPutUrl() (url string, err error) {\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>func generatePresignedPutUrl() (string, error) { // Without the variable names\n</code></pre>\n\n<p>Now lets address your errors in order:</p>\n\n<p><strong>Error 1: not enough arguments to return</strong></p>\n\n<p>Error is Go are not really cryptic. <code>not enough arguments to return</code> means literally what it says. You are trying to return less arguments than the ones you should. </p>\n\n<p>In Go you can return more than one value from a function but no matter how much values you return, you always need to return all the values. Your function <code>func generatePresignedPutUrl() (url string, err error)</code> expects a <code>string</code> and an <code>error</code> but in <code>return err</code> you are just returning <code>err</code> which is of type <code>error</code> so you are missing a <code>string</code>, in this case because there was an error in the function return an empty string. To fix it just do: <code>return \"\", err</code> instead.</p>\n\n<p><strong>Error 2: no new variables on left side of :=</strong></p>\n\n<p>Again not really cryptic. It means none of the variables on the left of <code>:=</code> are new. The <code>:=</code> declares a new variable and then assigns the value to that variable, so if the variable isn't new you get an error when trying to declare it. In this case you declared <code>url</code> on the function declaration and <code>err</code> on the second line of the function. To fix it replace:</p>\n\n<pre><code>url, err := svc.PresignedPutObject(aws.BucketHost, aws.BucketKey, time.Second * 24 * 60 * 60)\n</code></pre>\n\n<p>For:</p>\n\n<pre><code>url, err = svc.PresignedPutObject(aws.BucketHost, aws.BucketKey, time.Second * 24 * 60 * 60)\n</code></pre>\n\n<p><strong>Error 3: cannot assign *url.URL to url (type string) in multiple assignment</strong></p>\n\n<p>You are trying to assign a type <code>*url.URL</code> to the variable <code>url</code> which is a <code>string</code>. In Go you can only assign something to a variable if they are from the same type. <a href=\"https://godoc.org/net/url#URL\" rel=\"nofollow noreferrer\">Here</a> are the docs for the url.URL type. To fix it do:</p>\n\n<pre><code>rawUrl, err := svc.PresignedPutObject(aws.BucketHost, aws.BucketKey, time.Second * 24 * 60 * 60)\nif err != nil {\n    return \"\", err\n}\n\nreturn rawUrl.String() // rawUrl is of type *url.URL, so get it's string representation\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 8431001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23396f07b186686733ca6899622e5a26?s=128&d=identicon&r=PG&f=1", "display_name": "920smmsmsms", "link": "https://stackoverflow.com/users/8431001/920smmsmsms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3306, "favorite_count": 0, "accepted_answer_id": 49000612, "answer_count": 2, "score": -4, "last_activity_date": 1519730344, "creation_date": 1519696758, "last_edit_date": 1519730344, "question_id": 48999952, "link": "https://stackoverflow.com/questions/48999952/too-many-arguments-to-return-in-go-program", "title": "Too many arguments to return in Go program", "body": "<p>I have made this simple software to connect to AWS and generate a presigned put url:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"time\"\n\n    \"github.com/minio/minio-go\"\n    \"github.com/kelseyhightower/envconfig\"\n)\n\n// AWS contains the configuration to connect and create a presigned url on AWS.\ntype AWS struct {\n  Endpoint        string\n  AccessKeyId     string\n  SecretAccessKey string\n  SSL             bool\n  BucketHost      string\n  BucketKey       string\n}\n\nfunc main() {\n    url, err = generatePresignedPutUrl()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(url)\n}\n\nfunc generatePresignedPutUrl() {\n    var aws AWS\n    if err := envconfig.Process(\"aws\", &amp;aws); err != nil {\n        return err\n    }\n\n    svc, err := minio.New(aws.Endpoint, aws.AccessKeyId, aws.SecretAccessKey, aws.SSL)\n    if err != nil {\n        return err\n    }\n\n    url, err := svc.PresignedPutObject(aws.BucketHost, aws.BucketKey, time.Second * 24 * 60 * 60)\n    if err != nil {\n        return url, err\n    }\n}\n</code></pre>\n\n<p>But when I try to run <code>go run main.go</code>, the following errors show in my terminal:</p>\n\n<pre><code># command-line-arguments\n./main.go:23:5: undefined: url\n./main.go:23:10: undefined: err\n./main.go:23:39: generatePresignedPutUrl() used as value\n./main.go:24:8: undefined: err\n./main.go:25:19: undefined: err\n./main.go:27:17: undefined: url\n./main.go:33:9: too many arguments to return\n    have (error)\n    want ()\n./main.go:38:9: too many arguments to return\n    have (error)\n    want ()\n./main.go:43:9: too many arguments to return\n    have (*url.URL, error)\n    want ()\n</code></pre>\n\n<p>What exactly am I doing wrong here? I started to learn go a few days ago. I'm sorry if this is to much obvious.</p>\n\n<hr>\n\n<p>Update:</p>\n\n<p>I was able to figure it out that I should declare what I'm returning from <code>generatePresignedPutUrl</code>, but still:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"time\"\n\n    \"github.com/minio/minio-go\"\n    \"github.com/kelseyhightower/envconfig\"\n)\n\n// AWS contains the configuration to connect and create a pre-signed url on AWS.\ntype AWS struct {\n  Endpoint        string\n  AccessKeyId     string\n  SecretAccessKey string\n  SSL             bool\n  BucketHost      string\n  BucketKey       string\n}\n\nfunc main() {\n    url, err := generatePresignedPutUrl()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(url)\n}\n\n// generatePresignedPutUrl connects to S3 and generates a pre-signed put url\n// using configurations from environemnt variables.\nfunc generatePresignedPutUrl() (url string, err error) {\n    var aws AWS\n    if err := envconfig.Process(\"aws\", &amp;aws); err != nil {\n        return err\n    }\n\n    svc, err := minio.New(aws.Endpoint, aws.AccessKeyId, aws.SecretAccessKey, aws.SSL)\n    if err != nil {\n        return err\n    }\n\n    url, err := svc.PresignedPutObject(aws.BucketHost, aws.BucketKey, time.Second * 24 * 60 * 60)\n    if err != nil {\n        return url, err\n    }\n\n    return url\n}\n</code></pre>\n\n<p>Errors:</p>\n\n<pre><code># command-line-arguments\n./main.go:36:9: not enough arguments to return\n    have (error)\n    want (string, error)\n./main.go:41:9: not enough arguments to return\n    have (error)\n    want (string, error)\n./main.go:44:14: no new variables on left side of :=\n./main.go:44:14: cannot assign *url.URL to url (type string) in multiple assignment\n./main.go:49:5: not enough arguments to return\n    have (string)\n    want (string, error)\n</code></pre>\n"}, {"tags": ["go", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 2776, "user_id": 1987437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/508e14a7e9414311eff04b2fd8d20ed6?s=128&d=identicon&r=PG", "display_name": "Liam Kelly", "link": "https://stackoverflow.com/users/1987437/liam-kelly"}, "is_accepted": false, "score": 0, "last_activity_date": 1521724150, "creation_date": 1521724150, "answer_id": 49429573, "question_id": 48999361, "link": "https://stackoverflow.com/questions/48999361/properly-including-c-library-by-source-in-golang-project/49429573#49429573", "title": "Properly Including C library (by source) in Golang project", "body": "<p>From the cgo Godocs:</p>\n\n<blockquote>\n  <p>When the cgo directives are parsed, any occurrence of the string\n  ${SRCDIR} will be replaced by the absolute path to the directory\n  containing the source file.</p>\n</blockquote>\n\n<p>So for <code>client_test</code> the <code>SRCDIR</code> is a directory level higher and therefor its CGO directives should look like this:</p>\n\n<pre><code>/*\n#cgo CFLAGS: -I. -I${SRCDIR}/cryptlib -L${SRCDIR}/cryptlib -lcryptlib -Ofast \n#cgo LDFLAGS: -L${SRCDIR}/cryptlib -lcryptlib\n*/\n</code></pre>\n\n<p>As far as another approach, what I normally do is install the C library in the system library directory <code>/usr/lib/</code>. That way i do not need to worry about relative references and can just use <code>-lcryptlib</code>.</p>\n"}], "owner": {"reputation": 2959, "user_id": 1761555, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ca57c78ac2a76255a79004bb1d1529d?s=128&d=identicon&r=PG", "display_name": "Guru Prasad", "link": "https://stackoverflow.com/users/1761555/guru-prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 365, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521724150, "creation_date": 1519691873, "last_edit_date": 1519832104, "question_id": 48999361, "link": "https://stackoverflow.com/questions/48999361/properly-including-c-library-by-source-in-golang-project", "title": "Properly Including C library (by source) in Golang project", "body": "<p>Currently, I have the following source tree:</p>\n\n<pre><code>client\n|\n|--cryptlib\n|  |\n|  |--cryptlib.so\n|  |--cryptlib.a\n|  |--&lt;C sources&gt;\n|  |--Makefile\n|\n|--impl1\n|  |--&lt;C sources&gt;\n|  |--impl1.go\n|  |--impl1_test.go\n|\n|--impl2\n|  |--&lt;C sources&gt;\n|  |--impl2.go\n|  |--impl1_test.go\n|\n|--client.go\n|--client_test.go\n</code></pre>\n\n<p>The <code>cryptlib</code> library is used by both <code>impl1</code> and <code>impl2</code> and thus, both <code>impl1.go</code> and <code>impl2.go</code> start with the following <code>cgo</code> block:</p>\n\n<pre><code>/*\n#cgo CFLAGS: -I. -I${SRCDIR}/../cryptlib -L${SRCDIR}/../cryptlib -lcryptlib -Ofast \n#cgo LDFLAGS: -L${SRCDIR}/../cryptlib -lcryptlib\n*/\nimport \"C\"\n</code></pre>\n\n<p>And this works while trying to test <code>impl1_test.go</code> and <code>impl2_test.go</code>. </p>\n\n<p>However, when trying to run the tests situated in <code>client_test.go</code>, I keep getting errors claiming that the <code>cryptlib</code> library could not be found. I think this may have to do with the fact that <code>${SRCDIR}</code> in this case is <code>./client</code> which makes the rest of the <code>CFLAGS</code> and <code>LDFLAGS</code> paths incorrect (<code>./client/../cryptolib</code>).</p>\n\n<p>Although it leads to repetition, I have also tried including <code>cryptlib</code> into <code>impl1</code> and <code>impl2</code>. This approach again causes issues when trying to test <code>client_test.go</code> since the combined binary now sees multiple instances of the same functions defined in <code>cryptlib</code>.</p>\n\n<p>How should I properly structure my source tree and <code>cgo</code> flags such that all my <code>.go</code> source files can find my <code>cryptlib</code> library and compile?</p>\n"}, {"tags": ["json", "api", "http", "go", "http-headers"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1519690886, "post_id": 48999116, "comment_id": 85003766, "body": "The nil fields in the request struct aren&#39;t breaking anything, the error response says &quot;Cannot decode json string&quot; -- I assume the request body needs to be valid json."}, {"owner": {"reputation": 4395, "user_id": 442219, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TKAbI.jpg?s=128&g=1", "display_name": "tothemario", "link": "https://stackoverflow.com/users/442219/tothemario"}, "edited": false, "score": 0, "creation_date": 1519692827, "post_id": 48999116, "comment_id": 85004205, "body": "body should be JSON? []byte(&quot;{\\&quot;keyword\\&quot;: \\&quot;web\\&quot;}&quot;)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9416026, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--Lx6RlOtJLg/AAAAAAAAAAI/AAAAAAAA3tI/fd5DshhXeEo/photo.jpg?sz=128", "display_name": "Sean Ottey", "link": "https://stackoverflow.com/users/9416026/sean-ottey"}, "edited": false, "score": 1, "creation_date": 1519788072, "post_id": 49002616, "comment_id": 85048098, "body": "This was exactly it. Thanks so much!"}], "tags": [], "owner": {"reputation": 6357, "user_id": 6086311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb99289473f6393b89474785f2d294d1?s=128&d=identicon&r=PG", "display_name": "dtolnay", "link": "https://stackoverflow.com/users/6086311/dtolnay"}, "is_accepted": false, "score": 0, "last_activity_date": 1519713576, "creation_date": 1519713576, "answer_id": 49002616, "question_id": 48999116, "link": "https://stackoverflow.com/questions/48999116/nil-chan-in-http-request-using-golang-breaking-call/49002616#49002616", "title": "nil chan in http request using golang, breaking call", "body": "<p>According to <a href=\"https://www.name.com/api-docs/Domains#Search\" rel=\"nofollow noreferrer\">Name.com API Documentation</a> the body of a <code>POST /v4/domains:search</code> request needs to be represented as JSON. They show an example JSON body in the sidebar.</p>\n\n<pre><code>{\"keyword\":\"example\"}\n</code></pre>\n\n<p>To produce the JSON body and be sure that all escaping has happened correctly, let's define the following JSON formattable struct.</p>\n\n<pre><code>type DomainSearch struct {\n    Keyword string `json:\"keyword\"`\n}\n</code></pre>\n\n<p>Then replace your <code>body := []byte(\"keyword=web\")</code> with a JSON body:</p>\n\n<pre><code>body, err := json.Marshal(DomainSearch{\"web\"})\n</code></pre>\n\n<p>Assuming you have a valid Name.com API token you should see a 200 response come back with a JSON response body, something like:</p>\n\n<pre><code>{\n  \"results\": [\n    {\n      \"domainName\": \"web.blog\",\n      \"sld\": \"web\",\n      \"tld\": \"blog\"\n    },\n    {\n      \"domainName\": \"web.cam\",\n      \"sld\": \"web\",\n      \"tld\": \"cam\"\n    },\n    {\n      \"domainName\": \"web.camera\",\n      \"sld\": \"web\",\n      \"tld\": \"camera\",\n      \"purchasable\": true,\n      \"premium\": true,\n      \"purchasePrice\": 500,\n      \"purchaseType\": \"registration\",\n      \"renewalPrice\": 500\n    },\n    {\n      \"domainName\": \"web.cloud\",\n      \"sld\": \"web\",\n      \"tld\": \"cloud\"\n    },\n    ...\n  ]\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9416026, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--Lx6RlOtJLg/AAAAAAAAAAI/AAAAAAAA3tI/fd5DshhXeEo/photo.jpg?sz=128", "display_name": "Sean Ottey", "link": "https://stackoverflow.com/users/9416026/sean-ottey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519713576, "creation_date": 1519690193, "last_edit_date": 1519690671, "question_id": 48999116, "link": "https://stackoverflow.com/questions/48999116/nil-chan-in-http-request-using-golang-breaking-call", "title": "nil chan in http request using golang, breaking call", "body": "<p>I am attempting to call the name.com API (and am successful, except for one call... When I attempt to call their Search() method, I am getting an error.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>func TestExecute() string{\n    client := &amp;http.Client{}\n    body := []byte(\"keyword=web\")\n    req, newReqErr := http.NewRequest(\"POST\", \"https://api.name.com/v4/domains:search\", bytes.NewBuffer(body))\n    check(\"new Request Error: \", newReqErr)\n\n    req.SetBasicAuth(\"username\", \"[TOKEN ]\")\n\n    fmt.Println(req)\n\n    resp, doErr := client.Do(req)\n    check(\"client Do Error: \", doErr)\n\n    bodyText, readErr := ioutil.ReadAll(resp.Body)\n    check(\"Read error: \", readErr)\n\n    fmt.Printf(\"Result: %s\\n\", bodyText)\n\n    return fmt.Sprintf(\"StatusCode: %d\\n%s\", resp.StatusCode, bodyText)\n\n}\n</code></pre>\n\n<p>Here is the request text:</p>\n\n<pre><code>&amp;{POST https://api.name.com/v4/domains:search HTTP/1.1 1 1 map[Authorization:[Basic cldokleodjjAzMWNlODY2MjRlYmI5xxkxjdkfOWI4ZjNhMWQ5NmVmOGIA5YTA=]] {keyword=web} 11 [] false api.name.com map[] map[] &lt;nil&gt; map[]   &lt;nil&gt; &lt;nil&gt;}\n</code></pre>\n\n<p>and here is the response:</p>\n\n<pre><code>{\"message\":\"Invalid Argument\",\"details\":\"Error occurred during parsing: Cannot decode json string.\"}\n</code></pre>\n\n<p>It appears that some empty structs (internals, not mine) are being introduced into the header. OR name.com is parsing incorrectly.</p>\n\n<p>Thoughts?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 1713665, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/893980237aa0c5c3687a67a403a51877?s=128&d=identicon&r=PG", "display_name": "sumit", "link": "https://stackoverflow.com/users/1713665/sumit"}, "edited": false, "score": 0, "creation_date": 1519685813, "post_id": 48998394, "comment_id": 85002322, "body": "It gives following error <code>panic: send on closed channel</code>"}, {"owner": {"reputation": 35, "user_id": 1713665, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/893980237aa0c5c3687a67a403a51877?s=128&d=identicon&r=PG", "display_name": "sumit", "link": "https://stackoverflow.com/users/1713665/sumit"}, "edited": false, "score": 0, "creation_date": 1519758326, "post_id": 48998394, "comment_id": 85037162, "body": "Somehow using channels with this approach is taking more time than without channels."}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "reply_to_user": {"reputation": 35, "user_id": 1713665, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/893980237aa0c5c3687a67a403a51877?s=128&d=identicon&r=PG", "display_name": "sumit", "link": "https://stackoverflow.com/users/1713665/sumit"}, "edited": false, "score": 0, "creation_date": 1519763502, "post_id": 48998394, "comment_id": 85039891, "body": "Goroutines offer concurrency.  Only certain designs will offer parallelism.  Channels require coordination, which always has a cost.  But if it&#39;s a lot slower then there may be a bug."}], "tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": false, "score": 1, "last_activity_date": 1519712356, "last_edit_date": 1519712356, "creation_date": 1519685518, "answer_id": 48998394, "question_id": 48998218, "link": "https://stackoverflow.com/questions/48998218/is-this-the-correct-way-of-using-channels-in-go/48998394#48998394", "title": "Is this the correct way of using channels in go?", "body": "<p>Move your <code>close(c)</code> and <code>close(ch)</code> to before the <code>for ... range</code> loops.</p>\n\n<p>Once a buffered, not-closed channel reaches <code>len(ch) == 0</code>, a <code>for e := range ch { ... }</code> will block forever -- waiting for another goroutine to execute a send statement to the channel.  Closing indicates that there will be no more elements sent to the channel (and any sends to a closed channel will cause a panic), and will cause the <code>for e := range ch {...}</code> loop to end when the channel is empty.</p>\n\n<blockquote>\n  <p>It gives following error panic: send on closed channel</p>\n</blockquote>\n\n<p>Sending to a closed channel causes a panic.  You're receiving this error because your <code>main</code> goroutine reached the close statement prior to a send in another goroutine.</p>\n\n<p>You have multiple options for how to deal with this.  One is to use <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\"><code>sync.WaitGroup</code></a> to wait for all goroutines that will send to a channel to finish before closing the channel.  Something like:</p>\n\n<pre><code>go mapSubmission(&amp;sub, val, c)\ngo mapUser(&amp;sub, val, c)\ngo mapFiles(&amp;sub, val, c)\n// ...\nwg.Wait()\nclose(c)\nfor element := range c {\n    // ...\n</code></pre>\n\n<p>Another is to track the number of sends you expect on the channel, remove the <code>for e := range ch {...}</code> loops and replace them with a loop that will execute the receive operator on the channel the correct number of times.  In this case you could also use unbuffered channels instead of a buffered channel if you wanted to.  If you know how many times to call the receive operator, you don't need a <code>for e := range ch {...}</code>, and there's no need to close the channel.</p>\n\n<p>Another approach is to not use a channel at all.  Since all you're doing is printing to stdout, you could just move the prints to inside the goroutines, and use a <code>sync.WaitGroup</code> to ensure your <code>main</code> goroutine does not exit until your function goroutines have printed their output.</p>\n"}], "owner": {"reputation": 35, "user_id": 1713665, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/893980237aa0c5c3687a67a403a51877?s=128&d=identicon&r=PG", "display_name": "sumit", "link": "https://stackoverflow.com/users/1713665/sumit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519712356, "creation_date": 1519684622, "last_edit_date": 1519685256, "question_id": 48998218, "link": "https://stackoverflow.com/questions/48998218/is-this-the-correct-way-of-using-channels-in-go", "title": "Is this the correct way of using channels in go?", "body": "<p>Here I am trying to iterate over <code>res</code> and launch a goroutine for every item. Inside every goroutine, again I am launching 3 goroutines in a buffered channel.</p>\n\n<p>Running this code blocks the completion and does not allow the programme to complete. </p>\n\n<pre><code>func (aui *AssignmentUtilImpl) MapAssignmentSubmissionData(res []AssignmentSubmissionNode) []AssignmentSubmission {\n\n    if res == nil {\n        return nil\n    }\n\n    submissions := []AssignmentSubmission{}\n\n    ch := make(chan string, len(res))\n\n    // map data\n    for _, val := range res {\n\n        go func(val AssignmentSubmissionNode) {\n            sub := AssignmentSubmission{}\n            c := make(chan string, 3)\n\n            go mapSubmission(&amp;sub, val, c)\n            go mapUser(&amp;sub, val, c)\n            go mapFiles(&amp;sub, val, c)\n\n            sub.AssignmentId = val.AssignmentId\n            sub.ClassroomId = val.ClassroomId\n\n            for l := range c {\n                fmt.Println(l)\n            }\n\n            close(c)\n\n            submissions = append(submissions, sub)\n\n            ch &lt;- \"submission2: \" + sub.Id\n        }(val)\n    }\n\n    for l := range ch {\n        fmt.Println(l)\n    }\n\n    close(ch)\n\n    return submissions\n}\n\nfunc mapFiles(sub *AssignmentSubmission, val AssignmentSubmissionNode, c chan string) {\n    for _, f := range val.Files {\n        file := resourceModule.File{}\n        mapstructure.Decode(f.Data, &amp;file)\n\n        sub.Files = append(sub.Files, file)\n    }\n    c &lt;- fmt.Sprintf(\"files: %d\", len(sub.Files))\n}\n\nfunc mapUser(sub *AssignmentSubmission, val AssignmentSubmissionNode, c chan string) {\n    user := userModule.User{}\n    mapstructure.Decode(val.User.Data, &amp;user)\n    sub.User = user\n\n    c &lt;- \"user: \" + user.Id\n}\n\nfunc mapSubmission(sub *AssignmentSubmission, val AssignmentSubmissionNode, c chan string) {\n    mapstructure.Decode(val.Submission.Data, &amp;sub)\n\n    c &lt;- \"submission1: \" + sub.Id\n}\n</code></pre>\n"}, {"tags": ["pointers", "go", "null"], "answers": [{"comments": [{"owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "edited": false, "score": 0, "creation_date": 1519683183, "post_id": 48997934, "comment_id": 85001361, "body": "You should <code>fmt.Println(&amp;x)</code> not <code>fmt.Println(&amp;xp)</code>."}, {"owner": {"reputation": 14367, "user_id": 130427, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/6gMyw.jpg?s=128&g=1", "display_name": "Chris Redford", "link": "https://stackoverflow.com/users/130427/chris-redford"}, "reply_to_user": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "edited": false, "score": 0, "creation_date": 1591552003, "post_id": 48997934, "comment_id": 110093349, "body": "@KenenbekArzymatov Refer to the answer from @maksadbek. Changing the value of <code>&amp;x</code> is impossible in Go."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 2, "last_activity_date": 1519683020, "creation_date": 1519683020, "answer_id": 48997934, "question_id": 48997856, "link": "https://stackoverflow.com/questions/48997856/set-pointer-to-nil-via-function/48997934#48997934", "title": "Set pointer to nil via function", "body": "<p>The only way to achieve that is with a pointer to a pointer. And it's pretty clunky so it's probably not what you want:</p>\n\n<pre><code>func nilSetter(x **int) {\n    *x = nil\n}\n\nfunc main() {\n    x := 2\n    xp := &amp;x\n\n    fmt.Println(xp)\n    nilSetter(&amp;xp)\n    fmt.Println(xp)\n\n}\n\n// Output:\n// 0x10414020\n// &lt;nil&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "is_accepted": false, "score": 2, "last_activity_date": 1519690325, "last_edit_date": 1519690325, "creation_date": 1519685808, "answer_id": 48998451, "question_id": 48997856, "link": "https://stackoverflow.com/questions/48997856/set-pointer-to-nil-via-function/48998451#48998451", "title": "Set pointer to nil via function", "body": "<p>The reason of such behaviour is because there is no pass by reference in Go.</p>\n\n<p>Two variables can have contents that point to the same storage location. But, it is not possible to have them share the same storage location.\nExample:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n        var a int\n        var b, c = &amp;a, &amp;a\n        fmt.Println(b, c)   // 0x1040a124 0x1040a124\n        fmt.Println(&amp;b, &amp;c) // 0x1040c108 0x1040c110\n}\n</code></pre>\n\n<p>From your code, the argument <code>x</code> of <code>nilSetter</code> is pointing to some location but it have its own address and when you are setting a <code>nil</code> to it, you are changing its address not the address of what it is pointing to.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc nilSetter(x *int) {\n    x = nil\n    fmt.Println(x, &amp;x) // &lt;nil&gt; 0x1040c140\n}\n\nfunc main() {\n    i := 42\n    fmt.Println(&amp;i) // 0x10414020\n    nilSetter(&amp;i)\n    fmt.Println(&amp;i) // 0x10414020\n}\n</code></pre>\n\n<p>That is why pointers always have an exact address even its value is <code>nil</code></p>\n\n<p>Referencing to a blog post by Dave Cheney: <a href=\"https://dave.cheney.net/2017/04/29/there-is-no-pass-by-reference-in-go\" rel=\"nofollow noreferrer\">https://dave.cheney.net/2017/04/29/there-is-no-pass-by-reference-in-go</a></p>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 7986742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AkhwK.jpg?s=128&g=1", "display_name": "F566", "link": "https://stackoverflow.com/users/7986742/f566"}, "is_accepted": false, "score": 0, "last_activity_date": 1563080791, "creation_date": 1563080791, "answer_id": 57024758, "question_id": 48997856, "link": "https://stackoverflow.com/questions/48997856/set-pointer-to-nil-via-function/57024758#57024758", "title": "Set pointer to nil via function", "body": "<p>Just use return value and assign.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func nilSetter(x *int) *int {\n    x = nil\n    return x\n}\n\nx = nilSetter(x)\n</code></pre>\n"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2053, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1563080791, "creation_date": 1519682666, "question_id": 48997856, "link": "https://stackoverflow.com/questions/48997856/set-pointer-to-nil-via-function", "title": "Set pointer to nil via function", "body": "<p>There is a function that sets a pointer to a <code>nil</code> value:</p>\n\n<pre><code>func nilSetter(x *int) {\n    x = nil\n}\n</code></pre>\n\n<p>I have such snippet of code:</p>\n\n<pre><code>i := 42\nfmt.Println(&amp;i)\nnilSetter(&amp;i)\nfmt.Println(&amp;i)\n</code></pre>\n\n<p>Which prints:</p>\n\n<pre><code>0xc42008a000\n0xc42008a000\n</code></pre>\n\n<p>While I expect:</p>\n\n<pre><code>0xc42008a000\nnil\n</code></pre>\n\n<p>I know that it happens because function <code>nilSetter</code> just copy address and sets to nil that copy. </p>\n\n<p>But how can I do it correctly? </p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9415688, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--oHvA8WXWN8/AAAAAAAAAAI/AAAAAAAAAW8/iB6oX5F0lGY/photo.jpg?sz=128", "display_name": "HelpHunter", "link": "https://stackoverflow.com/users/9415688/helphunter"}, "edited": false, "score": 0, "creation_date": 1519711705, "post_id": 48999026, "comment_id": 85009005, "body": "Thanks! This achieved my main goal. I am going to accept your answer because it ultimately got me what I needed. If anyone else wants to answer the secondary question and/or show how this can be done via the interface method I was originally trying, I always appreciate learning!"}], "tags": [], "owner": {"reputation": 51, "user_id": 3955969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xIY1I.png?s=128&g=1", "display_name": "fitzy101", "link": "https://stackoverflow.com/users/3955969/fitzy101"}, "is_accepted": true, "score": 0, "last_activity_date": 1519689616, "creation_date": 1519689616, "answer_id": 48999026, "question_id": 48997822, "link": "https://stackoverflow.com/questions/48997822/extracting-value-from-json-array-in-json-and-why-dont-reflect-and-compile-erro/48999026#48999026", "title": "Extracting value from JSON array in JSON (and why don&#39;t reflect and compile errors report the same type)", "body": "<p>Instead of attempting to unmarshal the json into an interface, you can create specific types to model what the data will be. See the example code below.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    data := []byte(\"{ \\\"a\\\" : { \\\"b\\\" : [ { \\\"n\\\" : 100, \\\"c\\\" : \\\"Apple\\\", \\\"m\\\" : 1, \\\"bool\\\" : false }, { \\\"n\\\" : 101, \\\"c\\\" : \\\"Berry\\\", \\\"m\\\" : 2, \\\"bool\\\" : false } ] }, \\\"foo\\\" : false, \\\"bar\\\" : \\\"foobar\\\" }\")\n\n    type c struct {\n        N int    `json:\"n\"`\n        C string `json:\"c\"`\n        M int    `json:\"m\"`\n        B bool   `json:\"bool\"`\n    }\n    type b struct {\n        C   []c    `json:\"b\"`\n        Foo bool   `json:\"foo\"`\n        Bar string `json:\"bar\"`\n    }\n    type a struct {\n        A b `json:\"a\"`\n    }\n\n\n    var result a\n    if err := json.Unmarshal(data, &amp;result); err != nil {\n        panic(err.Error())\n    }\n\n    fmt.Printf(\"%+v\", result)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/QA0y-Z-YHCF\" rel=\"nofollow noreferrer\">Link to playground</a>.</p>\n\n<p>output: <code>{A:{C:[{N:100 C:Apple M:1 B:false} {N:101 C:Berry M:2 B:false}] Foo:false Bar:}}</code></p>\n\n<p>Note that the type members are capitalised - this is required for the json unmarshaling to work correctly.</p>\n\n<p>Once the json is unmarshaled into your types, you can refer to the members as you'd expect:</p>\n\n<pre><code>    for _, v := range result.A.C {\n        fmt.Println(v)\n    }\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>{100 Apple 1 false}\n{101 Berry 2 false}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9415688, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--oHvA8WXWN8/AAAAAAAAAAI/AAAAAAAAAW8/iB6oX5F0lGY/photo.jpg?sz=128", "display_name": "HelpHunter", "link": "https://stackoverflow.com/users/9415688/helphunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 48999026, "answer_count": 1, "score": 0, "last_activity_date": 1519713293, "creation_date": 1519682489, "last_edit_date": 1519713293, "question_id": 48997822, "link": "https://stackoverflow.com/questions/48997822/extracting-value-from-json-array-in-json-and-why-dont-reflect-and-compile-erro", "title": "Extracting value from JSON array in JSON (and why don&#39;t reflect and compile errors report the same type)", "body": "<p>I am having trouble unmarshalling some JSON in Go. In the below code, I want to be able to extract the value of \"c\" (\"Apple\", \"Berry\") from the JSON (&lt;- main goal/question). What has me particularly confused is when I tried to index into the <code>v</code> array(?), I get the error: <code>invalid operation: v[0] (type interface {} does not support indexing)</code>.</p>\n\n<p>This is what brought me to using <code>reflect</code> and looking at the type of the variable, which as you can see below is \"[]interface {}\", even if I assert it to be \"interface {}\". Of note, if I make the line <code>q := interface{}(v)</code> into <code>q := []interface{}(v)</code>, I get: <code>cannot convert v (type interface {}) to type []interface {}: need type assertion</code>. What am I missing? Why does <code>reflect</code> say it is \"[]interface {}\" but errors say it is \"interface {}\"? (&lt;- secondary question / help me understand)</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    data := []byte(\"{ \\\"a\\\" : { \\\"b\\\" : [ { \\\"n\\\" : 100, \\\"c\\\" : \\\"Apple\\\", \\\"m\\\" : 1, \\\"bool\\\" : false }, { \\\"n\\\" : 101, \\\"c\\\" : \\\"Berry\\\", \\\"m\\\" : 2, \\\"bool\\\" : false } ] }, \\\"foo\\\" : false, \\\"bar\\\" : \\\"foobar\\\" }\")\n    var a map[string]interface{}\n\n    _ = json.Unmarshal(data, &amp;a)\n\n    b := a[\"a\"].(map[string]interface{})\n    for i, v := range b {\n        fmt.Println(i, reflect.TypeOf(v))\n        q := interface{}(v)\n        fmt.Println(q, reflect.TypeOf(q))\n    }\n\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>b []interface {}\n[map[m:1 bool:false n:100 c:Apple] map[c:Berry m:2 bool:false n:101]] []interface {}\n</code></pre>\n"}, {"tags": ["go", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 127, "user_id": 4784357, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0iRvR.jpg?s=128&g=1", "display_name": "Arturo Aviles", "link": "https://stackoverflow.com/users/4784357/arturo-aviles"}, "is_accepted": true, "score": 0, "last_activity_date": 1519677913, "creation_date": 1519677913, "answer_id": 48996800, "question_id": 48996548, "link": "https://stackoverflow.com/questions/48996548/how-to-click-on-a-button-using-golang-for-web-scraping/48996800#48996800", "title": "How to click on a button using Golang for Web Scraping", "body": "<p>As found in: <a href=\"https://stackoverflow.com/a/26823658/4784357\">https://stackoverflow.com/a/26823658/4784357</a></p>\n\n<p>Open the <code>Network tab</code> in the web browser developer tools and <strong>check what is happening when clicking the button</strong> to continue using a package like goquery, surf, etc.</p>\n\n<p>In other cases, a web browser needs to be automated to do such task.</p>\n"}], "owner": {"reputation": 127, "user_id": 4784357, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0iRvR.jpg?s=128&g=1", "display_name": "Arturo Aviles", "link": "https://stackoverflow.com/users/4784357/arturo-aviles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2838, "favorite_count": 0, "closed_date": 1520925105, "accepted_answer_id": 48996800, "answer_count": 1, "score": 0, "last_activity_date": 1520278933, "creation_date": 1519676814, "last_edit_date": 1520278933, "question_id": 48996548, "link": "https://stackoverflow.com/questions/48996548/how-to-click-on-a-button-using-golang-for-web-scraping", "closed_reason": "Not suitable for this site", "title": "How to click on a button using Golang for Web Scraping", "body": "<p>I'm trying to scrape a site using <strong>Golang</strong> and in order to get more content I need to click on a <code>&lt;button&gt;</code> and wait some seconds. (Notice: There is no Pagination in the site) </p>\n\n<p>I found some cool packages to do web scraping like:</p>\n\n<ul>\n<li><strong>surf</strong> (gopkg.in/headzoo/surf.v1)</li>\n<li><strong>goquery</strong> (github.com/PuerkitoBio/goquery)</li>\n</ul>\n\n<p>But I can't find how to click on a button. </p>\n\n<p>Is there a <strong>package</strong> that can do that? Or do I need to use <strong>ChromeDriver/Headless Chrome/etc.</strong>?</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1519671429, "post_id": 48995147, "comment_id": 84995865, "body": "Someone downvote. please explain for me why. Because I am a newbie of Go, and I have tried as many as solutions I can before asking this."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1519671929, "post_id": 48995147, "comment_id": 84996135, "body": "Can&#39;t speak for the initial votes, but I find the question unclear. What is <code>ProductCommand</code>? What is <code>class</code>? Why not unmarshal directly into <code>class</code> if that&#39;s what you want? The type you&#39;re unmarshaling into in the second example is <code>*interface{}</code>, so the documented default type that&#39;s used for the <code>interface{}</code> is <code>map[string]interface{}</code>."}, {"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1519672211, "post_id": 48995147, "comment_id": 84996268, "body": "@JimB I have added <code>UserCommand</code> and <code>ProductCommand</code> to my code. Thanks for your point. Because I am newbie of Go, so I just use all the ways around :( So as you pointed out, it really doesn&#39;t make sense. Can you do this in general way ?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1519673668, "post_id": 48995147, "comment_id": 84996924, "body": "@Tr\u1ea7nKimD\u1ef1 how do you decide which type to unmarshal into?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1519674132, "post_id": 48995147, "comment_id": 84997153, "body": "<a href=\"https://play.golang.org/p/8X5FB32kDKd\" rel=\"nofollow noreferrer\">one way</a> and <a href=\"https://play.golang.org/p/nkEFDsSNSXi\" rel=\"nofollow noreferrer\">another way</a>"}, {"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1519704466, "post_id": 48995147, "comment_id": 85006950, "body": "@mkopriva I tried second solution. and then after finishing method, I try to typecast again to original command. i.e: <code>migration.(CreateUserCommand).UserName</code>. But I meet followed exception: &quot;*main.UserCommand, not main.UserCommand&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 6357, "user_id": 6086311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb99289473f6393b89474785f2d294d1?s=128&d=identicon&r=PG", "display_name": "dtolnay", "link": "https://stackoverflow.com/users/6086311/dtolnay"}, "is_accepted": true, "score": 2, "last_activity_date": 1519714970, "creation_date": 1519714970, "answer_id": 49002939, "question_id": 48995147, "link": "https://stackoverflow.com/questions/48995147/how-to-make-parameter-of-function-is-a-generic-struct/49002939#49002939", "title": "How to make parameter of function is a &quot;generic&quot; struct", "body": "<blockquote>\n<pre><code>// I want to be able to call this method\nparseData(data, UserCommand{})\n</code></pre>\n</blockquote>\n\n<p>It is possible to support this style of \"generic\" signature by using Go's <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\"><code>reflect</code></a> package.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"reflect\"\n)\n\ntype UserCommand struct {\n    User string\n    Info string\n}\n\ntype ProductCommand struct {\n    Name     string\n    Quantity int\n}\n\nfunc parseData(rawData []json.RawMessage, class interface{}) []interface{} {\n    var parsed []interface{}\n    for _, elem := range rawData {\n        // Create a pointer to a new zero value of the same type as `class`.\n        command := reflect.New(reflect.TypeOf(class))\n        // Pass a pointer to the new value to `json.Unmarshal`.\n        json.Unmarshal(elem, command.Interface())\n        // Insert the pointed-to new value into the output slice.\n        parsed = append(parsed, command.Elem().Interface())\n    }\n    return parsed\n}\n\nfunc main() {\n    data := []json.RawMessage{\n        json.RawMessage(`{\"User\":\"u1\",\"Info\":\"i1\"}`),\n        json.RawMessage(`{\"User\":\"u2\",\"Info\":\"i2\"}`),\n    }\n    parsed := parseData(data, UserCommand{})\n    fmt.Printf(\"%#v\\n\", parsed)\n\n    data = []json.RawMessage{\n        json.RawMessage(`{\"Name\":\"n1\",\"Quantity\":1}`),\n        json.RawMessage(`{\"Name\":\"n2\",\"Quantity\":2}`),\n    }\n    parsed = parseData(data, ProductCommand{})\n    fmt.Printf(\"%#v\\n\", parsed)\n}\n</code></pre>\n\n<p>The output shows that the first <code>parseData</code> call has parsed two <code>UserCommand</code> structs and the second call has parsed two <code>ProductCommand</code> structs.</p>\n\n<pre><code>[]interface {}{main.UserCommand{User:\"u1\", Info:\"i1\"}, main.UserCommand{User:\"u2\", Info:\"i2\"}}\n[]interface {}{main.ProductCommand{Name:\"n1\", Quantity:1}, main.ProductCommand{Name:\"n2\", Quantity:2}}\n</code></pre>\n"}], "owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "accepted_answer_id": 49002939, "answer_count": 1, "score": 0, "last_activity_date": 1519714970, "creation_date": 1519671090, "last_edit_date": 1519713239, "question_id": 48995147, "link": "https://stackoverflow.com/questions/48995147/how-to-make-parameter-of-function-is-a-generic-struct", "title": "How to make parameter of function is a &quot;generic&quot; struct", "body": "<p>For example, I want to write a method like this:</p>\n\n<pre><code>func parseData(rawData []json.RawMessage) []interface{} {\n    var migrations []interface{}\n    for _, migration := range rawData {\n        // this is an custom struct\n        command := UserCommand{}\n        json.Unmarshal(migration, &amp;command)\n        migrations = append(migrations, command)\n    }\n\n    return migrations\n}\n</code></pre>\n\n<p>The problem of this code is: If I don't want to parse <code>UserCommand</code> but any other such as <code>ProductCommand</code>, I must write the same code, only different at line: <code>command := UserCommand{}</code>. So my question is: how can I generic this code.</p>\n\n<p>I have tried this solution but it doesn't work:</p>\n\n<pre><code>func parseData(rawData []json.RawMessage, class interface{}) []interface{} {\n    var migrations []interface{}\n    for _, migration := range rawData {\n        command := class\n        json.Unmarshal(migration, &amp;command)\n        migrations = append(migrations, command)\n    }\n\n    return migrations\n}\n// then I call this method\nparseData(data, UserCommand{})\n</code></pre>\n\n<p>But it doesn't work. It return array of <code>map[string]interface{}</code> How can I fix this.</p>\n\n<p>Edit:</p>\n\n<p>Here is some my defined struct</p>\n\n<pre><code>type UserCommand struct {\n    User string\n    Info string\n}\ntype ProductCommand struct {\n    Name      string\n    Quanlity  int\n}\n</code></pre>\n"}, {"tags": ["go", "variable-assignment", "slice"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1519669652, "last_edit_date": 1519669652, "creation_date": 1519668007, "answer_id": 48994412, "question_id": 48994153, "link": "https://stackoverflow.com/questions/48994153/slices-and-multiple-assignment-in-the-go-programming-language/48994412#48994412", "title": "Slices and multiple assignment in the Go Programming Language", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow noreferrer\">Assignments</a></p>\n  \n  <p>The assignment proceeds in two phases. First, the operands of index\n  expressions and pointer indirections (including implicit pointer\n  indirections in selectors) on the left and the expressions on the\n  right are all <a href=\"https://golang.org/ref/spec#Order_of_evaluation\" rel=\"nofollow noreferrer\">evaluated in the usual order</a>. Second, the\n  assignments are carried out in left-to-right order.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Order_of_evaluation\" rel=\"nofollow noreferrer\">Order of evaluation</a></p>\n  \n  <p>At package level, initialization dependencies determine the evaluation\n  order of individual initialization expressions in variable\n  declarations. Otherwise, when evaluating the operands of an\n  expression, assignment, or return statement, all function calls,\n  method calls, and communication operations are evaluated in lexical\n  left-to-right order.</p>\n  \n  <p>For example, in the (function-local) assignment</p>\n\n<pre><code>y[f()], ok = g(h(), i()+x[j()], &lt;-c), k()\n</code></pre>\n  \n  <p>the function calls and communication happen in the order f(), h(),\n  i(), j(), &lt;-c, g(), and k(). However, the order of those events\n  compared to the evaluation and indexing of x and the evaluation of y\n  is not specified.</p>\n</blockquote>\n\n<hr>\n\n<p>Follow the link (<a href=\"https://golang.org/ref/spec#Order_of_evaluation\" rel=\"nofollow noreferrer\">evaluated in the usual order</a>), that you should have included in your quote, to the <a href=\"https://golang.org/ref/spec#Order_of_evaluation\" rel=\"nofollow noreferrer\">Order of Evaluation</a> section. </p>\n\n<p>For your example, evaluate the <code>append</code> function first:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    xs := []int{1, 2, 3, 4, 5}\n    x := xs[2]\n    xs = append(xs[:2], xs[3:]...)\n    fmt.Printf(\"OK: x=%d, xs=%#v\\n\", x, xs)\n\n    ys := []int{1, 2, 3, 4, 5}\n    y, ys := ys[2], append(ys[:2], ys[3:]...)\n    fmt.Printf(\"OK: y=%d, ys=%#v\\n\", y, ys)\n\n    {\n        ys := []int{1, 2, 3, 4, 5}\n\n        // phase 1\n        t1 := append(ys[:2], ys[3:]...)\n        t2 := ys[2]\n\n        // phase 2\n        y = t2\n        ys = t1\n\n        fmt.Printf(\"OK: y=%d, ys=%#v\\n\", y, ys)\n    }\n\n    // OK: x=3, xs=[]int{1, 2, 4, 5}\n    // OK: y=4, ys=[]int{1, 2, 4, 5}\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/n9f0qhZadUr\" rel=\"nofollow noreferrer\">https://play.golang.org/p/n9f0qhZadUr</a></p>\n\n<p>Output:</p>\n\n<pre><code>OK: x=3, xs=[]int{1, 2, 4, 5}\nOK: y=4, ys=[]int{1, 2, 4, 5}\nOK: y=4, ys=[]int{1, 2, 4, 5}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 0, "last_activity_date": 1519759013, "last_edit_date": 1519759013, "creation_date": 1519752663, "answer_id": 49014635, "question_id": 48994153, "link": "https://stackoverflow.com/questions/48994153/slices-and-multiple-assignment-in-the-go-programming-language/49014635#49014635", "title": "Slices and multiple assignment in the Go Programming Language", "body": "<p>As <a href=\"https://stackoverflow.com/a/48994412/244128\">noted by @peterSO</a>, according to the <a href=\"https://golang.org/ref/spec#Order_of_evaluation\" rel=\"nofollow noreferrer\">\"Order of evaluation\" section of the spec</a>:</p>\n\n<blockquote>\n  <p>... the order of <strong>[function calls]</strong> compared to the evaluation and indexing of <strong>[index expressions]</strong> is not specified.</p>\n</blockquote>\n\n<p>Which means that, for the example code above, the <code>append(...)</code> function call happens to occur before the index expression, since the relative order of those operations is not specified.</p>\n\n<p>If you wrap the index expression in a function call then the operations occur in the expected order:</p>\n\n<pre><code>idint := func(x int) int { return x }\n\nzs := []int{1, 2, 3, 4, 5}\nz, zs := idint(zs[2]), append(zs[:2], zs[3:]...)\n\nfmt.Printf(\"OK: z=%d, zs=%#v\\n\", z, zs)\n// OK: z=3, zs=[]int{1, 2, 4, 5}\n</code></pre>\n"}], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 674, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1519759013, "creation_date": 1519667012, "last_edit_date": 1519680360, "question_id": 48994153, "link": "https://stackoverflow.com/questions/48994153/slices-and-multiple-assignment-in-the-go-programming-language", "title": "Slices and multiple assignment in the Go Programming Language", "body": "<p>According to the <a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow noreferrer\">\"Assignments\" section</a> of the Go Language Spec:</p>\n\n<blockquote>\n  <p>The assignment proceeds in two phases. First, the operands of index expressions and pointer indirections (including implicit pointer indirections in selectors) on the left and the expressions on the right are all evaluated in the usual order. Second, the assignments are carried out in left-to-right order.</p>\n</blockquote>\n\n<p>While playing with slices and attempting to implement a simple \"delete\" (or \"splice\") operation I see the following <a href=\"https://play.golang.org/p/112z6dVT4EP\" rel=\"nofollow noreferrer\">confusing behavior (Go Playground)</a>:</p>\n\n<pre><code>xs := []int{1, 2, 3, 4, 5}\nx := xs[2]\nxs = append(xs[:2], xs[3:]...)\nfmt.Printf(\"OK: x=%d, xs=%#v\\n\", x, xs)\n\nys := []int{1, 2, 3, 4, 5}\ny, ys := ys[2], append(ys[:2], ys[3:]...)\nfmt.Printf(\"??: y=%d, ys=%#v\\n\", y, ys)\n\n// OK: x=3, xs=[]int{1, 2, 4, 5}\n// ??: y=4, ys=[]int{1, 2, 4, 5}\n</code></pre>\n\n<p>Why do the separate assignments to \"x\" and \"xs\" work as expected in the first example but the multi-assignment to \"y\" and \"ys\" appears to evaluate out of order? Is it related to the implicit define-and-assign combination?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "edited": false, "score": 4, "creation_date": 1519666536, "post_id": 48994008, "comment_id": 84993322, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26744873/converting-map-to-struct\">Converting map to struct</a>"}, {"owner": {"reputation": 131, "user_id": 9414726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AbA", "link": "https://stackoverflow.com/users/9414726/aba"}, "reply_to_user": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "edited": false, "score": 0, "creation_date": 1519666628, "post_id": 48994008, "comment_id": 84993363, "body": "@robbrit Thanks for the link. I did try that solution, but that requires the keys of the map to be same as the field names of the struct"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1519666705, "post_id": 48994008, "comment_id": 84993396, "body": "@AbA You can adjust it to fit your needs."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1519666766, "post_id": 48994008, "comment_id": 84993427, "body": "@Aba Answer linked in earlier comment has most of what you need. Iterate through fields creating map of JSON name to field.  Use that map instead of FieldByName."}, {"owner": {"reputation": 131, "user_id": 9414726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AbA", "link": "https://stackoverflow.com/users/9414726/aba"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1519666795, "post_id": 48994008, "comment_id": 84993440, "body": "@Flimzy can you elaborate on how? i did try to modify the code but i wasnt able to get it working for my requirement"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1519666809, "post_id": 48994008, "comment_id": 84993448, "body": "@Aba show that modified code."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1519666882, "post_id": 48994008, "comment_id": 84993487, "body": "@AbA: If you&#39;re not sure how to read struct tags, that would make for a good question (but first make sure it hasn&#39;t already been asked). But in any case, that question doesn&#39;t belong in comments."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1519667054, "post_id": 48994008, "comment_id": 84993571, "body": "Do you have the map, or do you have the JSON representation thereof. Do you know how to use reflection, or can you either do manual mapping, or can you afford to marshal the map, and unmarshal onto the struct?"}], "answers": [{"comments": [{"owner": {"reputation": 693, "user_id": 3297761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xGv4e.jpg?s=128&g=1", "display_name": "EduLopez", "link": "https://stackoverflow.com/users/3297761/edulopez"}, "edited": false, "score": 0, "creation_date": 1575907576, "post_id": 53289976, "comment_id": 104714895, "body": "I know for sure this method will work, but what if this component is been used a lot. What performance implications does this will have? Is it faster than Decode?"}], "tags": [], "owner": {"reputation": 1236, "user_id": 2729461, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/nq1S2.jpg?s=128&g=1", "display_name": "irmorteza", "link": "https://stackoverflow.com/users/2729461/irmorteza"}, "is_accepted": false, "score": 19, "last_activity_date": 1542145490, "creation_date": 1542145490, "answer_id": 53289976, "question_id": 48994008, "link": "https://stackoverflow.com/questions/48994008/mapstringinterface-to-struct-with-json-tags/53289976#53289976", "title": "map[string]interface{} to struct with json tags", "body": "<p>If I understood well, you have a map and want to fill struct by. If it's first change it to jsonString and then Unmarshal it to struct</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype MyStruct struct {\n    Id           string `json:\"id\"`\n    Name         string `json:\"name\"`\n    UserId       string `json:\"user_id\"`\n    CreatedAt    int64  `json:\"created_at\"`\n}\n\nfunc main() {\n    m := make(map[string]interface{})\n    m[\"id\"] = \"2\"\n    m[\"name\"] = \"jack\"\n    m[\"user_id\"] = \"123\"\n    m[\"created_at\"] = 5\n    fmt.Println(m)\n\n    // convert map to json\n    jsonString, _ := json.Marshal(m)\n    fmt.Println(string(jsonString))\n\n    // convert json to struct\n    s := MyStruct{}\n    json.Unmarshal(jsonString, &amp;s)\n    fmt.Println(s)\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4021, "user_id": 1421222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f267ea12030fd85ddac221e285f4997?s=128&d=identicon&r=PG", "display_name": "Bless", "link": "https://stackoverflow.com/users/1421222/bless"}, "is_accepted": false, "score": 10, "last_activity_date": 1542145948, "creation_date": 1542145948, "answer_id": 53290063, "question_id": 48994008, "link": "https://stackoverflow.com/questions/48994008/mapstringinterface-to-struct-with-json-tags/53290063#53290063", "title": "map[string]interface{} to struct with json tags", "body": "<p>You can use <a href=\"https://github.com/mitchellh/mapstructure\" rel=\"noreferrer\">https://github.com/mitchellh/mapstructure</a> for this. By default, it looks for the tag <code>mapstructure</code>; so, it's important to specify <code>TagName</code> as <code>json</code> if you want to use json tags.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/mitchellh/mapstructure\"\n)\n\ntype MyStruct struct {\n    Id        string `json:\"id\"`\n    Name      string `json:\"name\"`\n    UserId    string `json:\"user_id\"`\n    CreatedAt int64  `json:\"created_at\"`\n}\n\nfunc main() {\n    input := map[string]interface{} {\n        \"id\": \"1\",\n        \"name\": \"Hello\",\n        \"user_id\": \"123\",\n        \"created_at\": 123,\n    }\n    var output MyStruct\n    cfg := &amp;mapstructure.DecoderConfig{\n        Metadata: nil,\n        Result:   &amp;output,\n        TagName:  \"json\",\n    }\n    decoder, _ := mapstructure.NewDecoder(cfg)\n    decoder.Decode(input)\n\n    fmt.Printf(\"%#v\\n\", output)\n    // main.MyStruct{Id:\"1\", Name:\"Hello\", UserId:\"123\", CreatedAt:123}\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7, "user_id": 4976554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc223c23919fa110aae00c62d1e4a9d?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub", "link": "https://stackoverflow.com/users/4976554/jakub"}, "is_accepted": false, "score": 0, "last_activity_date": 1613569772, "creation_date": 1613569772, "answer_id": 66243240, "question_id": 48994008, "link": "https://stackoverflow.com/questions/48994008/mapstringinterface-to-struct-with-json-tags/66243240#66243240", "title": "map[string]interface{} to struct with json tags", "body": "<p>If you consider the speed then Mapstructure is 40 percent slower then jsoniter.ConfigFastest where you test on similar struct</p>\n<pre><code>type Message struct {\n    ID        string      `json:&quot;id,omitempty&quot;`\n    Type      string      `json:&quot;type&quot;`\n    Timestamp uint64      `json:&quot;timestamp,omitempty&quot;`\n    Data      interface{} `json:&quot;data&quot;`\n}\n</code></pre>\n<p>And you want to check message type by <code>Type == &quot;myType&quot;</code> and then marshal/unmarshal only Data field (which will be map[string]interface{} after first unmarshal)\nQuite similar scenario as you mentioned and the reason why the <a href=\"https://github.com/mitchellh/mapstructure\" rel=\"nofollow noreferrer\">https://github.com/mitchellh/mapstructure</a> is used for...</p>\n<pre><code>goos: windows\ngoarch: amd64\ncpu: AMD Ryzen Threadripper 3960X 24-Core Processor \nBenchmarkMarshalUnmarshal\nBenchmarkMarshalUnmarshal-48                      521784          2049 ns/op         871 B/op         20 allocs/op\nBenchmarkMarshalUnmarshalConfigFastest\nBenchmarkMarshalUnmarshalConfigFastest-48         750022          1591 ns/op         705 B/op         15 allocs/op\nBenchmarkMapstructure\nBenchmarkMapstructure-48                          480001          2546 ns/op        1225 B/op         25 allocs/op\nBenchmarkDirectStruct\nBenchmarkDirectStruct-48                         3096033           391.7 ns/op        88 B/op          3 allocs/op\nPASS\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 9414726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AbA", "link": "https://stackoverflow.com/users/9414726/aba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17511, "favorite_count": 6, "answer_count": 3, "score": 13, "last_activity_date": 1613569772, "creation_date": 1519666399, "last_edit_date": 1542173641, "question_id": 48994008, "link": "https://stackoverflow.com/questions/48994008/mapstringinterface-to-struct-with-json-tags", "title": "map[string]interface{} to struct with json tags", "body": "<p>I need to convert a <code>map[string]interface{}</code> whose keys are json tag names to <code>struct</code> </p>\n\n<pre><code>type MyStruct struct {\n    Id           string `json:\"id\"`\n    Name         string `json:\"name\"`\n    UserId       string `json:\"user_id\"`\n    CreatedAt    int64  `json:\"created_at\"`\n}\n</code></pre>\n\n<p>The <code>map[string]interface{}</code> has keys <code>id</code>, <code>name</code>, <code>user_id</code>, <code>created_at</code>. I need to convert this into <code>struct</code>.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "is_accepted": false, "score": 0, "last_activity_date": 1519665078, "creation_date": 1519665078, "answer_id": 48993651, "question_id": 48993153, "link": "https://stackoverflow.com/questions/48993153/json-decoding-into-struct-using-different-request-type-depending-on-path/48993651#48993651", "title": "Json decoding into struct, using different request type depending on path", "body": "<p>Unfortunately what you are trying to do is not really how Go works, since Go does not have polymorphism - createRequest and cancelRequest do not inherit from baseRequest, they <em>contain</em> a baseRequest. So when you have baseRequest in your message struct, it can't be anything other than a baseRequest.</p>\n\n<p>You may need to use separate types for each message. One for the cancel request, and a different one for the create request.</p>\n\n<p>Here is <a href=\"http://hackthology.com/object-oriented-inheritance-in-go.html\" rel=\"nofollow noreferrer\">an article</a> discussing inheritance and composition in Go, and contrasts it with Java. It should help you grok how struct embedding works in Go.</p>\n"}, {"tags": [], "owner": {"reputation": 303, "user_id": 1819455, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2cbd3418f87a820190f8a5af32468ace?s=128&d=identicon&r=PG&f=1", "display_name": "zerozero7", "link": "https://stackoverflow.com/users/1819455/zerozero7"}, "is_accepted": false, "score": 0, "last_activity_date": 1519721453, "creation_date": 1519721453, "answer_id": 49004584, "question_id": 48993153, "link": "https://stackoverflow.com/questions/48993153/json-decoding-into-struct-using-different-request-type-depending-on-path/49004584#49004584", "title": "Json decoding into struct, using different request type depending on path", "body": "<p>Actually, I found the way. You could implement message like this:</p>\n\n<pre><code>type message struct {\n  Request request `json:\"request\"`  //actually there should be other type here, but I can't think of what it could be\n  Auth auth           `json:\"auth\"`\n}\n</code></pre>\n\n<p>Where <code>request</code> is an interface, which has <code>serialize()</code></p>\n\n<pre><code>type request interface {\n    serialize() ([]byte, error)\n}\n</code></pre>\n\n<p>Then you can implement <code>serialize()</code> for every request type, and initialize <code>message</code> like this:</p>\n\n<pre><code>func (factory *HandlerFactory) Cancel() http.Handler {\n    create := func() *message { return &amp;message{&amp;cancelRequest{}, auth{}} }\n    return factory.defaultChain(createNewMessage, nil)\n}\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 1819455, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2cbd3418f87a820190f8a5af32468ace?s=128&d=identicon&r=PG&f=1", "display_name": "zerozero7", "link": "https://stackoverflow.com/users/1819455/zerozero7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519721453, "creation_date": 1519663396, "question_id": 48993153, "link": "https://stackoverflow.com/questions/48993153/json-decoding-into-struct-using-different-request-type-depending-on-path", "title": "Json decoding into struct, using different request type depending on path", "body": "<p>I want to decode json to struct. My structs look like that:</p>\n\n<pre><code>type message struct {\n Request baseRequest `json:\"request\"`  //actually there should be other type here, but I can't think of what it could be\n Auth auth           `json:\"auth\"`\n}\n\ntype baseRequest struct {\n  Foo string `json:\"foo\" validate:\"required\"`\n}\n\ntype createRequest struct {\n  baseRequest\n  Bar string `json:\"bar\" validate:\"required\"`\n}\n\ntype cancelRequest struct{\n  baseRequest\n  FooBar string `json:\"foo_bar\" validate:\"required\"`\n}\n</code></pre>\n\n<p>I want to compose <code>createRequest</code> with <code>baseRequest</code>. All my code is revolving around passing <code>message</code> type in chain of responsibility pattern. I have implemented a handler, that creates a pointer to empty <code>message</code> struct, that is used by <code>jsonReader()</code> function. For <code>/create</code> path I want to use <code>createRequest</code> instead of <code>baseRequest</code>, and for <code>/cancel</code> path I want to use <code>cancelRequest</code>. So for example in:</p>\n\n<pre><code>func (factory *HandlerFactory) Create() http.Handler {\n    create := func() *message { return &amp;message{} }\n    return factory.defaultChain(createNewMessage, nil)\n}\n</code></pre>\n\n<p>I want to change the type of message.Request() to <code>createRequest</code>.\nAnd in:</p>\n\n<pre><code>func (factory *HandlerFactory) Cancel() http.Handler {\n    create := func() *message { return &amp;message{} }\n    return factory.defaultChain(createNewMessage, nil)\n}\n</code></pre>\n\n<p>I want to change the type of message.Request to <code>cancelRequest</code>. How can I achieve something like that in Go?</p>\n"}, {"tags": ["rest", "go"], "answers": [{"comments": [{"owner": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "edited": false, "score": 0, "creation_date": 1519660745, "post_id": 48991946, "comment_id": 84989635, "body": "Where is the dynamic part? To hardcode 1000 paths is &quot;simple&quot; but lots of typing :-)"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "edited": false, "score": 0, "creation_date": 1519661230, "post_id": 48991946, "comment_id": 84989931, "body": "Ah your question was slightly vague, by dynamically I thought you meant like a specific path can be routed to a specific SQL function (which is exactly what my example does). To achieve this I think you will have to create some kind of custom pattern within your app to map a path to a specific SQL file by prefix or something like that. Ex: <code>&#47;user&#47;:id</code> -&gt; <code>&#47;database&#47;user&#47;by-id.sql</code>"}, {"owner": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "edited": false, "score": 0, "creation_date": 1519661988, "post_id": 48991946, "comment_id": 84990426, "body": "Yes, I was vague, because I do not know how to ask. Dynamic for me is that you save a lot of typing by using parameters created by the url and pointing to a document with same name as the parameter. Any idea how to save typing?"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "edited": false, "score": 0, "creation_date": 1519662521, "post_id": 48991946, "comment_id": 84990809, "body": "I would recommend against this. The only conceivable trivial way to get this done is by either implementing some kind of hash table, or using regexp. Regexp to find files within your system is probably a very bad idea and vulnerable to security issues. Hash table might be a solution, but still requires hardcoding some mappings, which strays from the whole &quot;completely dynamic&quot; philosophy. Nonetheless I will think of something and get back to you."}], "tags": [], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "is_accepted": false, "score": 0, "last_activity_date": 1519660320, "last_edit_date": 1519660320, "creation_date": 1519659417, "answer_id": 48991946, "question_id": 48991771, "link": "https://stackoverflow.com/questions/48991771/get-dynamic-sql-in-golang/48991946#48991946", "title": "Get dynamic sql in Golang", "body": "<p>I would recommend finding a design pattern that you like and building around that. For example, you can use <code>MVC</code>, or <code>Clean Architecture</code>, etc.</p>\n\n<p>A simple way to do what you want in <code>MVC</code> is to create controllers that map to each path, and the controller can access a specific database repository function, and that specific database repository function can have your SQL in it.</p>\n\n<p>This will give you a nice separation of concerns. You don't want to end up having 1000 different SQL queries and 1000 request handlers in the same file, that won't be maintainable. With <code>MVC</code> you can abstract this logic away to decouple things.</p>\n\n<p>But even <code>MVC</code> will have its limitations after a while once you start having directories with 1000 files, etc. However, I think it's a really good start for your use case since you just want REST endpoints mapped to a request handler, which then queries the database.</p>\n\n<p>Here is an example (note that I left a bunch of links for your reference at the bottom).</p>\n\n<p><strong>main.go:</strong></p>\n\n<pre><code>package main\n\nimport (\n   \"log\"\n    \"net/http\"\n\n    \"controllers\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/\", controllers.Index)\n    http.HandleFunc(\"/users\", controllers.AllUsers)\n    http.HandleFunc(\"/users/:id\", controllers.OneUser)\n\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n\n<p><strong>controllers.go:</strong></p>\n\n<pre><code>import \"repository\"\n\nfunc Index(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"Home page\")\n}\n\nfunc AllUsers(w http.ResponseWriter, r *http.Request) {\n    users := repository.AllUsers()\n\n    h.Write([]byte(users))\n}\n\nfunc OneUser(w http.ResponseWriter, r *http.Request) {\n    user := repository.OneUser(r.Param(\"id\"))\n\n    h.Write([]byte(user))\n}\n</code></pre>\n\n<p><strong>repository.go:</strong></p>\n\n<pre><code>func AllUsers() []User {\n    var users []User\n    db.Select(&amp;users, `SELECT * FROM user`)\n    return users\n}\n\nfunc OneUser(userId int) *User {\n    user := new(User)\n    db.Get(user, `SELECT * FROM user WHERE id = ?`, userId)\n    return user\n}\n</code></pre>\n\n<p>Bear in mind that this is a very simplistic answer that uses code that won't compile, doesn't handle errors, etc. But it should give you a general idea of how you can build an architecture to achieve what you want. </p>\n\n<p>Hope that helps!</p>\n\n<p>Here are some resources you might find helpful in building a RESTful API in Golang:</p>\n\n<ul>\n<li><a href=\"https://www.codementor.io/codehakase/building-a-restful-api-with-golang-a6yivzqdo\" rel=\"nofollow noreferrer\">https://www.codementor.io/codehakase/building-a-restful-api-with-golang-a6yivzqdo</a></li>\n<li><a href=\"https://thenewstack.io/make-a-restful-json-api-go/\" rel=\"nofollow noreferrer\">https://thenewstack.io/make-a-restful-json-api-go/</a></li>\n<li><a href=\"https://hackernoon.com/build-restful-api-in-go-and-mongodb-5e7f2ec4be94\" rel=\"nofollow noreferrer\">https://hackernoon.com/build-restful-api-in-go-and-mongodb-5e7f2ec4be94</a></li>\n</ul>\n\n<p>Here are some routers for REST API's:</p>\n\n<ul>\n<li><a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow noreferrer\">https://github.com/gin-gonic/gin</a></li>\n<li><a href=\"https://github.com/go-chi/chi\" rel=\"nofollow noreferrer\">https://github.com/go-chi/chi</a></li>\n<li><a href=\"https://github.com/julienschmidt/httprouter\" rel=\"nofollow noreferrer\">https://github.com/julienschmidt/httprouter</a></li>\n</ul>\n\n<p>Here are some database packages to help make your SQL queries simple:</p>\n\n<ul>\n<li><a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">https://github.com/jmoiron/sqlx</a></li>\n</ul>\n"}], "owner": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 739, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1519717733, "creation_date": 1519658712, "last_edit_date": 1519717733, "question_id": 48991771, "link": "https://stackoverflow.com/questions/48991771/get-dynamic-sql-in-golang", "title": "Get dynamic sql in Golang", "body": "<p>I am trying to create a REST API in Golang. The problem is that I have more than 1000 complex SQL script that should be executed and fetched from the database.</p>\n\n<p>Is it possible to take the web address <em><code>/get/job/23</code></em> and dynamically grab the sql from a package, template or text document that basically contain text only = sql script? And then fire the prepare and execute in the <strong><em>main.go</em></strong>?</p>\n\n<p>It seems that importing 1000 packages and storing 1000 complex SQL statements in the <strong><em>main.go</em></strong> is sort of impossible.</p>\n\n<p>Here is a newbie pseudo code that shows what I am looking for:</p>\n\n<pre><code>package main\n\nimport (\n   \"encoding/json\"\n   \"log\"\n    \"net/http\"\n    \"database/sql\"\n    \"github.com/gorilla/mux\"\n    _ \"github.com/lib/pq\"\n)\n\nfunc Getsql (dynamic path to script with parameter) returns (string)      \n\n/* The url /get/job/id is stored as a document/package/template       \nas \"getjobid\" = dynamic path based on url passed */\n\nfunc (db *DB) Conn(ctx context.Context) (*Conn, error)\nfunc (db *DB) Prepare(query string) (*Stmt, error)\nfunc (db *DB) Query(query string, args ...interface{}) (*Rows, err)\n\nfunc main() {\nhttp.HandleFunc(\"/\", handler)\nlog.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n\n<p>Of course, I do not know if this is even possible, but I am thankful for pointing me in the right direction.</p>\n\n<p><strong>Added</strong></p>\n\n<p>I think of this as 4 problem to solve:</p>\n\n<ol>\n<li>How to store the plain sql in a document (template?) within Golang </li>\n<li>How to dynamically set the path to this document based on url.</li>\n<li>How to send parameters to a document (id)</li>\n<li>How to read the content and execute the sql</li>\n</ol>\n"}, {"tags": ["go", "reflection"], "answers": [{"comments": [{"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 0, "creation_date": 1519659461, "post_id": 48991844, "comment_id": 84988788, "body": "thanks, that solves part of my issue but I need a handle on the original request type to run the validation as well, how can I actually perform the type assertion using the reflect.Type"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 0, "creation_date": 1519659611, "post_id": 48991844, "comment_id": 84988874, "body": "@WebweaverD: what do you mean by &quot;actually perform the type assertion&quot;? What exactly do you want to do with the <code>ccReq</code> value?"}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 0, "creation_date": 1519659729, "post_id": 48991844, "comment_id": 84988950, "body": "I need to validate it - I&#39;m using struct annotations on the original type to define validation rules so need the concrete type for the govalidator package - see line &#39;result, err := govalidator.ValidateStruct(ccReq)&#39;, validation of the type was just for good measure really"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 0, "creation_date": 1519660004, "post_id": 48991844, "comment_id": 84989148, "body": "<code>ValidateStruct</code> takes an <code>interface{}</code>, you don&#39;t need to assert or convert anything to pass <code>command.Request</code> to it."}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 0, "creation_date": 1519660694, "post_id": 48991844, "comment_id": 84989600, "body": "ah, good spot, thanks - so I dont actually need it for that purpose but as my current code stands I will still need it for the response handler further down (sorry not included in question as I presumed irrelevant) - it may be that I can avoid this with a code rethink but do you know if what I ask is possible - making a concrete type from reflect.Type and an interface"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 0, "creation_date": 1519661102, "post_id": 48991844, "comment_id": 84989856, "body": "@WebweaverD: you&#39;re going to have to show an example of what you mean. You can of course initialize <code>reflect.Value</code> from a <code>reflect.Type</code>, or you convert from a <code>reflect.Value</code> to a &quot;Convertible&quot; <code>reflect.Type</code>, or simply call a method on the <code>reflect.Value</code>, but I don&#39;t know what it is you want to do."}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 0, "creation_date": 1519661321, "post_id": 48991844, "comment_id": 84989998, "body": "thanks for your help - I&#39;m going to accept and close for now whilst I clarify in my own mind exactly what i need to do and if required I shall return with something more concise"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1519660601, "last_edit_date": 1519660601, "creation_date": 1519659040, "answer_id": 48991844, "question_id": 48991710, "link": "https://stackoverflow.com/questions/48991710/how-to-use-a-reflect-type-to-perform-a-type-assertion/48991844#48991844", "title": "How to use a reflect.Type to perform a type assertion", "body": "<p>From the <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"nofollow noreferrer\"><code>reflect.Type</code> docs</a>:</p>\n\n<blockquote>\n  <p>Type values are comparable, such as with the == operator, so they can be used as map keys. Two Type values are equal if they represent identical types.</p>\n</blockquote>\n\n<p>If you want to compare underlying types, compare the <code>reflect.Type</code> values directly:</p>\n\n<pre><code>if reflect.TypeOf(command.Request) != command.RequestType {\n    log.Fatal(errors.New(\"invalid request type\"))\n}\n</code></pre>\n"}], "owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "accepted_answer_id": 48991844, "answer_count": 1, "score": 0, "last_activity_date": 1519660740, "creation_date": 1519658503, "last_edit_date": 1519660740, "question_id": 48991710, "link": "https://stackoverflow.com/questions/48991710/how-to-use-a-reflect-type-to-perform-a-type-assertion", "title": "How to use a reflect.Type to perform a type assertion", "body": "<p>I know reflection is generally frowned upon in go but for my current purposes Im pretty sure it is the best solution.</p>\n\n<p>Essentially my project is cli tool which will output an xml query based on incoming commands and return the corresponding result.</p>\n\n<p>There is some boiler plate code for each command request where default values are populated and supplied values validated.</p>\n\n<p>So I have a series of Command objects based on a Command struct as follows:</p>\n\n<pre><code>type Command struct {\n    Name        string\n    Request     interface{}\n    RequestType reflect.Type\n    Response    interface{}\n\n    RegisterFunc func(parentCmd *cobra.Command, cmd *Command) error\n}\n</code></pre>\n\n<p>For the most part I really don't care about the types of the request/response (just xml encode/decode). However I need to briefly cast it to a concrete type to validate with struct annotations\nSo for example I might do something like this:</p>\n\n<pre><code>    var ccReq *CreateCredentialRequest\n    var set bool\n    if ccReq, set = command.Request.(*CreateCredentialRequest); !set {\n        log.Fatal(errors.New(\"invalid request type\"))\n    }\n\n    result, err := govalidator.ValidateStruct(ccReq)\n    if err != nil {\n        println(\"error: \" + err.Error())\n        os.Exit(1)\n    }\n</code></pre>\n\n<p>However in an ideal would I would like to handle this generically for all commands, something like this:</p>\n\n<pre><code>    var ccReq *CreateCredentialRequest\n    var set bool\n    if ccReq, set = command.Request.(command.RequestType); !set {\n        log.Fatal(errors.New(\"invalid request type\"))\n    }\n</code></pre>\n\n<p>However this results in the error:</p>\n\n<blockquote>\n  <p>command.RequestType is not a type</p>\n</blockquote>\n\n<p>So, how can I store the value of a type for a later type assertion</p>\n\n<p>Note: Following discussion in comments with JimB it seems that i do not actually need the concrete type for validation purposes (interface is fine) but I still need further down to assert the response type to provide a custom response handler</p>\n"}, {"tags": ["go", "sqlx", "pq"], "comments": [{"owner": {"reputation": 754, "user_id": 3476897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/57E2l.png?s=128&g=1", "display_name": "Kugel", "link": "https://stackoverflow.com/users/3476897/kugel"}, "edited": false, "score": 0, "creation_date": 1519660469, "post_id": 48991564, "comment_id": 84989464, "body": "Maybe it doesn&#39;t like the brackets?"}, {"owner": {"reputation": 81, "user_id": 9397271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HzzbE.jpg?s=128&g=1", "display_name": "Luis Serra", "link": "https://stackoverflow.com/users/9397271/luis-serra"}, "reply_to_user": {"reputation": 754, "user_id": 3476897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/57E2l.png?s=128&g=1", "display_name": "Kugel", "link": "https://stackoverflow.com/users/3476897/kugel"}, "edited": false, "score": 0, "creation_date": 1519661429, "post_id": 48991564, "comment_id": 84990057, "body": "I&#39;ve tried with <code>enterprise_id=$1</code> but same outcome"}, {"owner": {"reputation": 81, "user_id": 9397271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HzzbE.jpg?s=128&g=1", "display_name": "Luis Serra", "link": "https://stackoverflow.com/users/9397271/luis-serra"}, "reply_to_user": {"reputation": 754, "user_id": 3476897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/57E2l.png?s=128&g=1", "display_name": "Kugel", "link": "https://stackoverflow.com/users/3476897/kugel"}, "edited": false, "score": 1, "creation_date": 1519917061, "post_id": 48991564, "comment_id": 85109854, "body": "Apparently this was a an issue with the pq driver and it&#39;s interaction with crate (the db I&#39;m using). Using the go-crate driver for golang fixes the issue but go-crate doesn&#39;t look that is being maintained"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 9397271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HzzbE.jpg?s=128&g=1", "display_name": "Luis Serra", "link": "https://stackoverflow.com/users/9397271/luis-serra"}, "is_accepted": false, "score": 1, "last_activity_date": 1525863580, "creation_date": 1525863580, "answer_id": 50251753, "question_id": 48991564, "link": "https://stackoverflow.com/questions/48991564/bindvars-in-golangs-sqlx-db-select-statement-requires-0-parameters/50251753#50251753", "title": "Bindvars in golangs sqlx.DB.Select() statement requires 0 parameters", "body": "<p>If anyone gets to here, I found out the answer by digging a bit on the pq source code. \nTo use prepared parameters with Crate, it requires driver to send the parameters as binary before preparing the statement; answering with the types of the parameters.</p>\n\n<p>To accomplish this, add 'binary_parameters=yes' to your connection string. Like:</p>\n\n<blockquote>\n  <p>\"user=crate dbname=test binary_parameters=yes\"</p>\n</blockquote>\n"}], "owner": {"reputation": 81, "user_id": 9397271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HzzbE.jpg?s=128&g=1", "display_name": "Luis Serra", "link": "https://stackoverflow.com/users/9397271/luis-serra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1525863580, "creation_date": 1519657955, "last_edit_date": 1519658794, "question_id": 48991564, "link": "https://stackoverflow.com/questions/48991564/bindvars-in-golangs-sqlx-db-select-statement-requires-0-parameters", "title": "Bindvars in golangs sqlx.DB.Select() statement requires 0 parameters", "body": "<p>I'm using SQLX and PQ to query an SQL database with PostGress. I'm using the function Select from SQLX with bindvars but PQ panics with </p>\n\n<blockquote>\n  <p>pq: got 1 parameters but the statement requires 0.</p>\n</blockquote>\n\n<pre><code> query = `\n    SELECT \n        count(*) AS count \n    FROM \n        ledger \n    WHERE \n        enterprise_id=($1)\n `\n var stat singleStat\n\n err = db.Select(&amp;stat, query, enterpriseID)\n</code></pre>\n"}, {"tags": ["go", "jpeg", "libjpeg", "mozjpeg"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1519658472, "post_id": 48991531, "comment_id": 84988156, "body": "So the difference is likely in how the library is used by the <code>github.com&#47;subuk&#47;go-mozjpeg</code> package compared to the cli. Debugging that package for you seems a bit broad for a StackOverflow question."}, {"owner": {"reputation": 191, "user_id": 2870681, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/21264df3baa23f3231ee6d8bee1dea46?s=128&d=identicon&r=PG&f=1", "display_name": "borellini", "link": "https://stackoverflow.com/users/2870681/borellini"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1519726576, "post_id": 48991531, "comment_id": 85016797, "body": "You&#39;re correct, although I was getting a bit hopeless having dumped all the scalar fields in libjpeg&#39;s configuration struct, and they had not difference. I was hoping there&#39;s some kind of weird trick cjpeg is doing..."}], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 2870681, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/21264df3baa23f3231ee6d8bee1dea46?s=128&d=identicon&r=PG&f=1", "display_name": "borellini", "link": "https://stackoverflow.com/users/2870681/borellini"}, "is_accepted": false, "score": 2, "last_activity_date": 1519726835, "creation_date": 1519726835, "answer_id": 49006286, "question_id": 48991531, "link": "https://stackoverflow.com/questions/48991531/using-mozjpeg-with-its-cjpeg-has-superior-quality-to-using-it-as-a-library/49006286#49006286", "title": "Using mozjpeg with its cjpeg has superior quality to using it as a library", "body": "<p>Got to answer my own question, since I found a fix to the issue by going through mozjpeg's commit history. cjpeg has an implicit default for chroma subsampling on JPEG quality ratings above 80 in its argument parsing code, and boundaries of solid areas of certain colour look quite bad with the library default for chroma subsampling.</p>\n\n<pre><code>/*\n    Disable chroma subsampling for good quality ratings, that's what cjpeg command does as well.\n    That seems to cause some issues with red color.\n*/\nif opt.Quality &gt;= 80 {\n    compInfo := (*[3]C.jpeg_component_info)(unsafe.Pointer(cinfo.comp_info))\n    compInfo[Y].h_samp_factor, compInfo[Y].v_samp_factor = 1, 1\n    compInfo[Cb].h_samp_factor, compInfo[Cb].v_samp_factor = 1, 1\n    compInfo[Cr].h_samp_factor, compInfo[Cr].v_samp_factor = 1, 1\n}\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 2870681, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/21264df3baa23f3231ee6d8bee1dea46?s=128&d=identicon&r=PG&f=1", "display_name": "borellini", "link": "https://stackoverflow.com/users/2870681/borellini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 831, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519726835, "creation_date": 1519657807, "question_id": 48991531, "link": "https://stackoverflow.com/questions/48991531/using-mozjpeg-with-its-cjpeg-has-superior-quality-to-using-it-as-a-library", "title": "Using mozjpeg with its cjpeg has superior quality to using it as a library", "body": "<p>I have been trying to use mozjpeg in my Go application for JPEG compression, since it seems to have very good quality when used through the cjpeg command-line utility it provides.</p>\n\n<p>However, pictures compressed with my application have inferior quality - a lot more JPEG artefacts with the same quality level.</p>\n\n<p>I am using go bindings for libjpeg-turbo / mozjpeg from <a href=\"https://github.com/subuk/go-mozjpeg/blob/master/jpeg/compress.go\" rel=\"nofollow noreferrer\">https://github.com/subuk/go-mozjpeg/blob/master/jpeg/compress.go</a></p>\n\n<p>My own code does not seem to be too complex:</p>\n\n<pre><code>    libjpegOptions := jpeg.EncoderOptions{\n        Quality:         92,\n        OptimizeCoding:  true,\n        ProgressiveMode: true,\n    }\n\n    err = jpeg.Encode(buf, m, &amp;libjpegOptions)\n    if err != nil {\n        return nil, err\n    }\n</code></pre>\n\n<p>Both applications seem to link to the same version of mozjpeg library, installed with Homebrew:</p>\n\n<pre><code>$ otool -L /opt/mozjpeg/bin/cjpeg\n/opt/mozjpeg/bin/cjpeg:\n    /opt/mozjpeg/lib/libjpeg.62.dylib (compatibility version 65.0.0, current version 65.0.0)\n    /usr/local/opt/libpng/lib/libpng16.16.dylib (compatibility version 51.0.0, current version 51.0.0)\n    /usr/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.11)\n    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1252.0.0)\n\n$ otool -L /Users/fabio/Code/go/bin/imageproxy\n/Users/fabio/Code/go/bin/imageproxy:\n    /opt/mozjpeg/lib/libjpeg.62.dylib (compatibility version 65.0.0, current version 65.0.0)\n    /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation (compatibility version 150.0.0, current version 1451.0.0)\n    /System/Library/Frameworks/Security.framework/Versions/A/Security (compatibility version 1.0.0, current version 58286.41.2)\n    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1252.0.0)\n</code></pre>\n\n<p>What could I try next to ensure that my application is using the same settings as cjpeg?</p>\n"}, {"tags": ["elasticsearch", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1519657266, "post_id": 48991297, "comment_id": 84987466, "body": "You&#39;re comparing different types of clients and confusing &quot;connection&quot; with &quot;client&quot;. The <a href=\"https://godoc.org/github.com/olivere/elastic#NewClient\" rel=\"nofollow noreferrer\">docs</a> specifically say <code>NewClient, by default, is meant to be long-lived and shared across your application</code>"}], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 1044396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MOGGP.jpg?s=128&g=1", "display_name": "Kalyan Chakravarthi", "link": "https://stackoverflow.com/users/1044396/kalyan-chakravarthi"}, "edited": false, "score": 0, "creation_date": 1525008654, "post_id": 50076518, "comment_id": 87189955, "body": "I went with a single client object across the application(long running)... and also performed a load test and didn&#39;t notice any issues also the explanation given here perfectly makes sense..."}], "tags": [], "owner": {"reputation": 106, "user_id": 9708906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0685e6aa5a7985d4d569938c92a8ece6?s=128&d=identicon&r=PG", "display_name": "Oliver Eilhard", "link": "https://stackoverflow.com/users/9708906/oliver-eilhard"}, "is_accepted": true, "score": 3, "last_activity_date": 1524919590, "last_edit_date": 1524919590, "creation_date": 1524918292, "answer_id": 50076518, "question_id": 48991297, "link": "https://stackoverflow.com/questions/48991297/how-many-elasticsearch-client-connection-should-we-create-in-the-application/50076518#50076518", "title": "How many elasticsearch client connection should we create in the application", "body": "<p>That depends on the application.</p>\n\n<p>In 99% of the use cases you have a normal, long-running application. Then you should create just one client with <a href=\"https://godoc.org/github.com/olivere/elastic#NewClient\" rel=\"nofollow noreferrer\"><code>elastic.NewClient</code></a>. You can pass it around in your code and it should always work, even in different goroutines. This will create a long-running client which has several benefits. E.g. it will run health checks in the background that will prevent Elastic from sending requests to unhealthy or dead nodes.</p>\n\n<p>However, if you have a short-running application (something like AWS Lambda oder Cloud Functions) you might need a \"connection\" on a request level. In that specific case you can use <a href=\"https://godoc.org/github.com/olivere/elastic#NewSimpleClient\" rel=\"nofollow noreferrer\"><code>elastic.NewSimpleClient</code></a>. It has a bit more overhead though as you're creating a new client every time. And it won't do any health checks and other things.</p>\n\n<p>DO NOT create a new client with <code>elastic.NewClient</code> for every request, as any call to <code>NewClient</code> will create a set of goroutines and you'll quickly run out of resources if you do that.</p>\n\n<p>Please read the <a href=\"https://godoc.org/github.com/olivere/elastic#NewClient\" rel=\"nofollow noreferrer\">documentation</a> and the <a href=\"https://github.com/olivere/elastic/wiki\" rel=\"nofollow noreferrer\">wiki</a> for further details.</p>\n"}], "owner": {"reputation": 199, "user_id": 1044396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MOGGP.jpg?s=128&g=1", "display_name": "Kalyan Chakravarthi", "link": "https://stackoverflow.com/users/1044396/kalyan-chakravarthi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1651, "favorite_count": 0, "accepted_answer_id": 50076518, "answer_count": 1, "score": 3, "last_activity_date": 1524919590, "creation_date": 1519657047, "last_edit_date": 1519661099, "question_id": 48991297, "link": "https://stackoverflow.com/questions/48991297/how-many-elasticsearch-client-connection-should-we-create-in-the-application", "title": "How many elasticsearch client connection should we create in the application", "body": "<p>I'm using Golang &amp; <a href=\"https://github.com/olivere/elastic\" rel=\"nofollow noreferrer\">elastic client</a>.</p>\n\n<p>Bellow is my client creation logic:</p>\n\n<pre><code>if client, err := elastic.NewClient(elastic.SetURL(ElasticsearchURL)); err != nil {\n    // Handle error\n    logger.Error.Println(err)\n    return nil\n} else {\n    return client\n}\n</code></pre>\n\n<p>Whats the correct approach to:</p>\n\n<ul>\n<li>keep the client object singleton across the application?</li>\n<li>create and close the clients for each request?</li>\n</ul>\n\n<p>I am kind of confused between counterintuitive answers in below links:</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/15713159/where-to-close-an-elasticsearch-client-connection\">where-to-close-an-elasticsearch-client-connection</a>- suggests one connection per app</li>\n<li><a href=\"https://discuss.elastic.co/t/how-many-transport-clients-can-a-elasticsearch-cluster-have/60252\" rel=\"nofollow noreferrer\">how-many-transport-clients-can-a-elasticsearch-cluster-have</a> - suggests one connection per app</li>\n<li><a href=\"https://stackoverflow.com/questions/38212327/elasticsearch-how-to-query-for-number-of-connections\">elasticsearch-how-to-query-for-number-of-connections</a> -- kind of indicates connections quickly die after serving a request</li>\n</ol>\n"}, {"tags": ["pointers", "go", "reference", "slice"], "answers": [{"comments": [{"owner": {"reputation": 1445, "user_id": 2672698, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9a0e47bf5cac8940c9d520421b22adc2?s=128&d=identicon&r=PG", "display_name": "Sam Holmes", "link": "https://stackoverflow.com/users/2672698/sam-holmes"}, "edited": false, "score": 0, "creation_date": 1519652454, "post_id": 48989893, "comment_id": 84984308, "body": "Ah knew it&#39;d be something like that. Thank you so much for explaining! Will accept the answer when it lets me :)"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1519652365, "creation_date": 1519652365, "answer_id": 48989893, "question_id": 48989713, "link": "https://stackoverflow.com/questions/48989713/go-slice-pointer-in-variable-changes-behaviour-during-append/48989893#48989893", "title": "Go slice pointer in variable changes behaviour during append", "body": "<p>The slice expressions in <code>*p = append(*p[:i], *p[i+1:]...)</code> take precedence over the <code>*</code> operator. You need to enclose those in parentheses.</p>\n\n<pre><code>func (p *People) Remove(name string) {\n    for i, person := range *p {\n        if person.Name == name {\n            // Doesn't work\n            *p = append((*p)[:i], (*p)[i+1:]...)\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/cbT65mCzA4h\" rel=\"nofollow noreferrer\">https://play.golang.org/p/cbT65mCzA4h</a></p>\n"}], "owner": {"reputation": 1445, "user_id": 2672698, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9a0e47bf5cac8940c9d520421b22adc2?s=128&d=identicon&r=PG", "display_name": "Sam Holmes", "link": "https://stackoverflow.com/users/2672698/sam-holmes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 48989893, "answer_count": 1, "score": 1, "last_activity_date": 1519652365, "creation_date": 1519651749, "last_edit_date": 1519652103, "question_id": 48989713, "link": "https://stackoverflow.com/questions/48989713/go-slice-pointer-in-variable-changes-behaviour-during-append", "title": "Go slice pointer in variable changes behaviour during append", "body": "<p>I'm a bit confused as to why this happens when attempting to remove an element from a slice in Go.</p>\n\n<p>As a simplified example, I have the following data structures:</p>\n\n<pre><code>type Person struct {\n    Name string\n}\n\ntype People []Person\n</code></pre>\n\n<p>I want to add a method to remove a person with a certain name from the list of people with <code>people.Remove(\"Sam\")</code>:</p>\n\n<pre><code>func (p *People) Remove(name string) {\n    for i, person := range *p {\n        if person.Name == name {\n            // Doesn't work\n            *p = append(*p[:i], *p[i+1:]...)\n        }\n    }\n}\n</code></pre>\n\n<p>I thought this would work, but referencing the slice elements in this manner returns a compile error: <code>cannot slice p (type *People)</code>.</p>\n\n<p>So, fair enough. But when I set <code>*p</code> to another variable (<code>a</code>), it works exactly as expected:</p>\n\n<pre><code>func (p *People) Remove(name string) {\n    for i, person := range *p {\n        if person.Name == name {\n            // Does work\n            a := *p\n            *p = append(a[:i], a[i+1:]...)\n        }\n    }\n}\n</code></pre>\n\n<p>Why do I need to set the slice to a difference variable before this method works? Shouldn't the behaviour be exactly the same?</p>\n\n<p>I'm probably misunderstanding something fundamental here so if anyone can explain why this is required I'd love to know. Thank you!</p>\n"}, {"tags": ["go", "interface", "go-map"], "answers": [{"comments": [{"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1519649981, "post_id": 48988914, "comment_id": 84982781, "body": "Can I asked a question. If an object have similar field with one struct, can we cast that object to that struct. thanks."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1519650215, "post_id": 48988914, "comment_id": 84982911, "body": "yes we can Unmarshal the data into struct having tags for json. Checkout this <a href=\"https://gobyexample.com/json\" rel=\"nofollow noreferrer\">link</a>"}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 10, "last_activity_date": 1519662343, "last_edit_date": 1519662343, "creation_date": 1519649369, "answer_id": 48988914, "question_id": 48988823, "link": "https://stackoverflow.com/questions/48988823/difference-between-mapstringinterface-and-interface/48988914#48988914", "title": "Difference between map[string]interface{} and interface{}", "body": "<p>It is because by default you need to type assert interface{} to get the underlying value of map[string]interface{}.</p>\n\n<p>As per <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"noreferrer\">GoLang</a> Specification </p>\n\n<blockquote>\n  <p>For an expression x of interface type and a type T, the primary\n  expression</p>\n</blockquote>\n\n<pre><code>x.(T)\n</code></pre>\n\n<blockquote>\n  <p>asserts that x is not nil and that the value stored in x is of type T.\n  The notation x.(T) is called a type assertion.</p>\n</blockquote>\n\n<p>Also <code>Unmarshal</code> function requires pointer to <code>migration</code> of type interface{} or map[string]interface{}</p>\n\n<pre><code>var migrations interface{}\njson.Unmarshal(raw, &amp;migrations)\n\nfmt.Println(migrations.(interface{}).(map[string]interface{})[\"create_user\"])\n</code></pre>\n\n<p>Since <code>migrations</code> is not a map. So you cannot use its key to get the value. Interface{} don't have keys</p>\n"}, {"comments": [{"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1519671283, "post_id": 48993282, "comment_id": 84995774, "body": "thanks. The problem I meet is: I have an array of &quot;object&quot;: each object is on different type,  so different struct, depend on field &quot;type&quot;. So I must get each block separate before parsing."}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 29, "last_activity_date": 1519663738, "creation_date": 1519663738, "answer_id": 48993282, "question_id": 48988823, "link": "https://stackoverflow.com/questions/48988823/difference-between-mapstringinterface-and-interface/48993282#48993282", "title": "Difference between map[string]interface{} and interface{}", "body": "<p>The difference between those two types is just what it seems:</p>\n\n<ol>\n<li><p><code>interface{}</code> is the \"any\" type, since <em>all</em> types implement the interface with no functions.</p></li>\n<li><p><code>map[string]interface{}</code> is a map whose keys are strings and values are any type.</p></li>\n</ol>\n\n<p>When unmarshaling a byte array from JSON into memory it's easiest to use the <code>interface{}</code> type, since it can store any type of JSON document (objects, arrays, primitives, etc.); however, it may require more reflection to handle the underlying data.  Using a <code>map[string]interface{}</code> is common when you know the JSON document is an object and <code>[]interface{}</code> is common when you know the document is an array.</p>\n\n<p>However, the best approach for unmarshaling JSON - especially when you know the structure of the documents ahead of time - is to define and use custom struct types that describe the data exactly. This way you can avoid any reflection and improve the legibility of your code.</p>\n"}], "owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27615, "favorite_count": 6, "accepted_answer_id": 48988914, "answer_count": 2, "score": 8, "last_activity_date": 1531550774, "creation_date": 1519649092, "last_edit_date": 1531550774, "question_id": 48988823, "link": "https://stackoverflow.com/questions/48988823/difference-between-mapstringinterface-and-interface", "title": "Difference between map[string]interface{} and interface{}", "body": "<p>I want to parse a JSON file to a <code>map[string]interface{}</code>:</p>\n\n<pre><code>var migrations map[string]interface{}\njson.Unmarshal(raw, &amp;migrations)\n\nfmt.Println(migrations[\"create_user\"])\n</code></pre>\n\n<p>But I modified my code to point data to <code>interface{}</code>:</p>\n\n<pre><code>var migrations interface{}\njson.Unmarshal(raw, &amp;migrations)\n\n// compile wrong here\nfmt.Println(migrations[\"create_user\"])\n</code></pre>\n\n<p>I don't understand much about difference between <code>map[string]interface{}</code> and <code>interface{}</code> in above case.</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1519643311, "post_id": 48986954, "comment_id": 84978564, "body": "Each go routine processes the whole queue. Is that what you want?"}, {"owner": {"reputation": 6096, "user_id": 1804251, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XVhq3.jpg?s=128&g=1", "display_name": "BennX", "link": "https://stackoverflow.com/users/1804251/bennx"}, "reply_to_user": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1519643520, "post_id": 48986954, "comment_id": 84978714, "body": "No every file should be processed by one routine. They don\u2019t write to the channel. The files are processed with a shell command."}], "answers": [{"comments": [{"owner": {"reputation": 6096, "user_id": 1804251, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XVhq3.jpg?s=128&g=1", "display_name": "BennX", "link": "https://stackoverflow.com/users/1804251/bennx"}, "edited": false, "score": 0, "creation_date": 1519645586, "post_id": 48987278, "comment_id": 84979992, "body": "Don\u2019t I have to do <code>&lt;- sync</code> as much as threads? The range shouldn\u2019t have the right count."}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "reply_to_user": {"reputation": 6096, "user_id": 1804251, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XVhq3.jpg?s=128&g=1", "display_name": "BennX", "link": "https://stackoverflow.com/users/1804251/bennx"}, "edited": false, "score": 0, "creation_date": 1519647876, "post_id": 48987278, "comment_id": 84981476, "body": "No. You want to know when all files have been processed. So you do that for each file once."}], "tags": [], "owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "is_accepted": false, "score": 1, "last_activity_date": 1519644987, "last_edit_date": 1519644987, "creation_date": 1519643943, "answer_id": 48987278, "question_id": 48986954, "link": "https://stackoverflow.com/questions/48986954/go-routine-end-before-done/48987278#48987278", "title": "go routine end before done", "body": "<p>You are using the channel to publish work to be done. As soon as the last item is taken from the queue (not finished processing), your program exits.</p>\n\n<p>You could use a channel to write to at the end of <code>renderGoRoutine</code> to signal the end of processing.</p>\n\n<p>At the top:</p>\n\n<pre><code>sync := make(chan bool)\n</code></pre>\n\n<p>In <code>renderGoRoutine</code> at the end (Assuming it is in the same file):</p>\n\n<pre><code>sync &lt;- true\n</code></pre>\n\n<p>At the bottom:</p>\n\n<pre><code>for f := range sync {\n    &lt;- sync\n}\n</code></pre>\n\n<p>Now your program waits until the number of files are processed.</p>\n\n<p>Or to have a complete example:</p>\n\n<pre><code>queue := make(chan string)\nsync := make(chan bool)\n\nthreadCount := c.Int(\"threads\")\n\nif c.Int(\"threads\") &lt; len(files) {\n    threadCount = len(files)\n} \n\nlog.Infof(\"Starting %i processes\", c.Int(\"threads\"))\n\nfor i := 0; i &lt; threadCount; i++ {\n    go renderGoRoutine(queue)\n}\n\nfor _, f := range files {\n    queue &lt;- f\n}\nclose(queue)\n\nfor f := range sync {\n    &lt;- sync\n}\n</code></pre>\n\n<p>And the routine should be changed like this:</p>\n\n<pre><code>func renderGoRoutine(queue chan string) {\n    for file := range queue { \n        // do some heavy lifting stuff with the file\n        sync &lt;- true\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6096, "user_id": 1804251, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XVhq3.jpg?s=128&g=1", "display_name": "BennX", "link": "https://stackoverflow.com/users/1804251/bennx"}, "edited": false, "score": 0, "creation_date": 1519646428, "post_id": 48988021, "comment_id": 84980549, "body": "Thats an excellent way. I found a simple solution too which is similar to this approach. You could create a wait group with the number of threads and decrement it whenever a thread leaves it&#39;s iteration"}, {"owner": {"reputation": 6096, "user_id": 1804251, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XVhq3.jpg?s=128&g=1", "display_name": "BennX", "link": "https://stackoverflow.com/users/1804251/bennx"}, "edited": false, "score": 0, "creation_date": 1519646839, "post_id": 48988021, "comment_id": 84980814, "body": "I prefer this way. I had to pass the WaitGroup by pointer to the render go routine. Works like a charm. Thanks"}], "tags": [], "owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "is_accepted": true, "score": 2, "last_activity_date": 1519646319, "creation_date": 1519646319, "answer_id": 48988021, "question_id": 48986954, "link": "https://stackoverflow.com/questions/48986954/go-routine-end-before-done/48988021#48988021", "title": "go routine end before done", "body": "<p>Using WaitGroups is an option.</p>\n\n<p>At the beginning, you add number tasks into WaitGroup and after each task is done decrement counter in the WaitGroup. Wait until all tasks are finished at the end of your code flow. </p>\n\n<p>See the example: <a href=\"https://godoc.org/sync#WaitGroup\" rel=\"nofollow noreferrer\">https://godoc.org/sync#WaitGroup</a></p>\n\n<p>Your code will look like this:</p>\n\n<pre><code>queue := make(chan string)\n\nwg := sync.WaitGroup{}\nwg.Add(len(files))\n\nthreadCount := c.Int(\"threads\")\n\nif c.Int(\"threads\") &lt; len(files) {\n    threadCount = len(files)\n}\n\nlog.Infof(\"Starting %i processes\", c.Int(\"threads\"))\n\nfor i := 0; i &lt; threadCount; i++ {\n    go renderGoRoutine(queue)\n}\n\n\nfor _, f := range files {\n    queue &lt;- f\n}\n\nclose(queue)\nwg.Wait()\n</code></pre>\n\n<p>renderGoRoutine:</p>\n\n<pre><code>func renderGoRoutine(queue chan string) {\n    for file := range queue {\n        // do some heavy lifting stuff with the file\n        // decrement the waitGroup counter\n        wg.Done()\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6096, "user_id": 1804251, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XVhq3.jpg?s=128&g=1", "display_name": "BennX", "link": "https://stackoverflow.com/users/1804251/bennx"}, "is_accepted": false, "score": 1, "last_activity_date": 1519646446, "creation_date": 1519646446, "answer_id": 48988055, "question_id": 48986954, "link": "https://stackoverflow.com/questions/48986954/go-routine-end-before-done/48988055#48988055", "title": "go routine end before done", "body": "<p>I did forget to wait for all tasks to finish. This can simply be done by waiting for all loops to end. Since <code>close(channel)</code> does end the <code>for range channel</code> a simple sync with a channel can be used like so:</p>\n\n<pre><code>sync := make(chan bool)\nqueue := make(chan string)\n\nthreadCount := c.Int(\"threads\")\n\nif c.Int(\"threads\") &lt; len(files) {\n    threadCount = len(files)\n} \n\nlog.Infof(\"Starting %i processes\", c.Int(\"threads\"))\n\nfor i := 0; i &lt; threadCount; i++ {\n    go renderGoRoutine(queue)\n}\n\nfor _, f := range files {\n    queue &lt;- f\n}\nclose(queue)\n\nfor i := 0; i &lt; threadCount; i++ {\n    &lt;- sync\n}\n</code></pre>\n\n<p>And last but not least write to the channel whenever a iteration is stopped.</p>\n\n<pre><code>func renderGoRoutine(queue chan string) {\n    for file := range queue { //whatever is done here\n    }\n    sync &lt;- true\n}\n</code></pre>\n"}], "owner": {"reputation": 6096, "user_id": 1804251, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XVhq3.jpg?s=128&g=1", "display_name": "BennX", "link": "https://stackoverflow.com/users/1804251/bennx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 48988021, "answer_count": 3, "score": 0, "last_activity_date": 1519646446, "creation_date": 1519642913, "question_id": 48986954, "link": "https://stackoverflow.com/questions/48986954/go-routine-end-before-done", "title": "go routine end before done", "body": "<p>I'm tying to execute things async with multiple go routines. I pass in the number of \"threads\" to use to process the files async. The files is an array of Strings to process. </p>\n\n<pre><code>queue := make(chan string)\n\nthreadCount := c.Int(\"threads\")\n\nif c.Int(\"threads\") &lt; len(files) {\n    threadCount = len(files)\n} \n\nlog.Infof(\"Starting %i processes\", c.Int(\"threads\"))\n\nfor i := 0; i &lt; threadCount; i++ {\n    go renderGoRoutine(queue)\n}\n\nfor _, f := range files {\n    queue &lt;- f\n}\nclose(queue)\n</code></pre>\n\n<p>And the routine itself looks like this:</p>\n\n<pre><code>func renderGoRoutine(queue chan string) {\n    for file := range queue { \n        // do some heavy lifting stuff with the file\n    }\n}\n</code></pre>\n\n<p>This does work fine whenever i use just one thread. As soon as i take more then one it does exit/leave the scope before it is done with all the go routines. </p>\n\n<p>How do I make it process everything?</p>\n\n<p>Previous question: <a href=\"https://stackoverflow.com/questions/48734453/using-a-channel-for-dispatching-tasks-to-go-routine\">Using a channel for dispatching tasks to go routine</a></p>\n"}, {"tags": ["http", "go"], "answers": [{"tags": [], "owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "is_accepted": true, "score": 2, "last_activity_date": 1519643347, "last_edit_date": 1519643347, "creation_date": 1519642848, "answer_id": 48986931, "question_id": 48986310, "link": "https://stackoverflow.com/questions/48986310/http-server-and-client-to-download-multiple-files/48986931#48986931", "title": "HTTP server and client to download multiple files", "body": "<p>The problem can be in the file path you are requesting. It is prefixed with <code>/dlpath/</code>. You must strip this prefix and pass the rest of the text as a path. See: <a href=\"https://godoc.org/net/http#FileServer\" rel=\"nofollow noreferrer\">https://godoc.org/net/http#FileServer</a></p>\n\n<p>Could you try this code snippet:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n        dirName := \"C:\\\\Users\\\\aarvi\\\\GolandProjects\\\\src\\\\Practice\\\\download\\\\serve\"\n\n        http.Handle(\"/dlpath/\", http.StripPrefix(\"/dlpath\", http.FileServer(http.Dir(dirName))))\n\n        err := http.ListenAndServe(\":8001\", nil)\n        if err != nil {\n                log.Fatal(\"ListenAndServe: \", err)\n        }\n}\n</code></pre>\n\n<p>Hope this helps.</p>\n\n<p>P.S.\nThis is from the case when you are serving the directory in the handler function.</p>\n"}, {"tags": [], "owner": {"reputation": 337, "user_id": 5772695, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/pSKby.jpg?s=128&g=1", "display_name": "Aarvi", "link": "https://stackoverflow.com/users/5772695/aarvi"}, "is_accepted": false, "score": 0, "last_activity_date": 1519807635, "creation_date": 1519807635, "answer_id": 49025338, "question_id": 48986310, "link": "https://stackoverflow.com/questions/48986310/http-server-and-client-to-download-multiple-files/49025338#49025338", "title": "HTTP server and client to download multiple files", "body": "<p>The accepted answer and some amount of googling helped me write FileServer with a different handler (http.HandleFunc). Using HandleFunc allowed me to set up other things like authentication etc.,</p>\n\n<p>The key was to call ServeHTTP()</p>\n\n<p>So, the handler function can be modified in the following manner to serve all the files in a directory:</p>\n\n<pre><code>func handle(writer http.ResponseWriter, r *http.Request) {\n    {\n        dirName := \"C:\\\\Users\\\\aarvi\\\\GolandProjects\\\\src\\\\Practice\\\\download\\\\serve\"\n        http.StripPrefix(\"/dlpath\", http.FileServer(http.Dir(dirName))).ServeHTTP(writer, r)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 337, "user_id": 5772695, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/pSKby.jpg?s=128&g=1", "display_name": "Aarvi", "link": "https://stackoverflow.com/users/5772695/aarvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1256, "favorite_count": 0, "accepted_answer_id": 48986931, "answer_count": 2, "score": 0, "last_activity_date": 1519807635, "creation_date": 1519640979, "last_edit_date": 1519802239, "question_id": 48986310, "link": "https://stackoverflow.com/questions/48986310/http-server-and-client-to-download-multiple-files", "title": "HTTP server and client to download multiple files", "body": "<p>I have tried setting up a download server and a download client for individual files. How can I modify them to serve/download all the files from a directory?</p>\n\n<p>Following are my server and client codes:</p>\n\n<pre><code>//server.go\nfunc main() {\n        http.HandleFunc(\"/dlpath\", handle)\n        err := http.ListenAndServe(\":10001\", nil)\n        if err != nil {\n            log.Fatal(\"ListenAndServe: \", err)\n        }\n    }\n\nfunc handle(writer http.ResponseWriter, r *http.Request) {\n    filename := \"C:\\\\Users\\\\aarvi\\\\GolandProjects\\\\src\\\\Practice\\\\download\\\\serve\\\\send.txt\"\n    http.ServeFile(writer, r, filename)\n}\n\n//client.go\nfunc main() {\n    downloadFile(\"res_out.txt\", \"http://localhost:10001/dlpath\")\n}\n\nfunc downloadFile(dirname string, url string) error {\n\n    // Create the file\n    out, err := os.OpenFile(dirname, os.O_WRONLY | os.O_CREATE | os.O_APPEND, 0666)\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer out.Close()\n\n    // get data\n    request, err := http.NewRequest(\"GET\", url, nil)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    client := http.Client{}\n    resp, err := client.Do(request)\n    if err != nil {\n        return err\n    }\n    defer resp.Body.Close()\n\n    // Write the body to file\n    _, err = io.Copy(out, resp.Body)\n    if err != nil {\n        return err\n    }\n    return nil\n}\n</code></pre>\n\n<p>I tried serving the directory in the handle function like so:</p>\n\n<pre><code>dirname := \"C:\\\\Users\\\\aarvi\\\\GolandProjects\\\\src\\\\Practice\\\\download\\\\serve\"\nhttp.FileServer(http.Dir(dirname))\n</code></pre>\n\n<p>and tried to print out the response on the client side, but I got nothing. How can I serve all the files from the /serve directory, and download them in the client?</p>\n\n<p>EDIT:\nFollowing are the contents of the serve directory:</p>\n\n<p><code>serve\n---sample.txt\n---send.txt\n---dir2\n------abc.txt</code></p>\n\n<p>How can I download all these files on the client side as separate files, with the directory structure intact?</p>\n\n<p><strong>Update:</strong> When I call the http.Handle function (as mentioned in the answer) directly in the main function, I am able to serve all the files, and the file within the inner directory too.</p>\n\n<p>However, when I call the same within the handle function, it doesn't serve anything. I am guessing this has something to do with the path? </p>\n"}, {"tags": ["json", "pointers", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1519640410, "post_id": 48985627, "comment_id": 84976618, "body": "Rule of thumb: Read the package documentation. Always, even when following some random tutorial."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1519639374, "last_edit_date": 1519639374, "creation_date": 1519639005, "answer_id": 48985686, "question_id": 48985627, "link": "https://stackoverflow.com/questions/48985627/how-does-json-unmarshal-work-and-how-is-it-stored-in-a-variable/48985686#48985686", "title": "How does json.Unmarshal() work and how is it stored in a variable?", "body": "<blockquote>\n  <p>my doubt here is: <code>err = json.Unmarshal(body, &amp;p)</code> why are we assigning the encoded body to <code>err</code></p>\n</blockquote>\n\n<p>You don't. You pass the <code>body</code> to the <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\"><code>json.Unmarshal()</code></a> function, and you assign its <em>return value</em> to the <code>err</code> variable, which tells you if unmarshaling failed (or succeeded if <code>err</code> is <code>nil</code>).</p>\n\n<blockquote>\n  <p>how is <code>p.Stuff.Fruit</code> getting the value when I can't see anything assigned to <code>p</code></p>\n</blockquote>\n\n<p>You pass the address of <code>p</code> to <code>json.Unmarshal()</code>, so it has a pointer to your variable, and so if it modifies the <em>pointed</em> value (pointed by the pointer), it modifies the same value you have (<code>p</code>).</p>\n\n<p>See this simple example:</p>\n\n<pre><code>func change(p *int) {\n    *p = 3\n}\n\nfunc main() {\n    var i int\n    fmt.Println(\"Before\", i)\n    change(&amp;i)\n    fmt.Println(\"After\", i)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/HNiq7kJkkX7\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Before 0\nAfter 3\n</code></pre>\n\n<p>In the <code>main()</code> function we don't assign anything to the local variable <code>i</code>, but we pass its address to the <code>change()</code> function, which modifies the <em>pointed</em> value, and so if we print the value of <code>i</code> after the <code>change()</code> call, we see its value changed.</p>\n\n<p>You pass the address of <code>p</code> to <code>json.Unmarshal()</code>, so it will be capable of modifying the value stored in <code>p</code>. Under the hood, the <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\"><code>json</code></a> package uses reflection (package <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\"><code>reflect</code></a>) to discover the runtime type of <code>p</code> and modify it according to the JSON document you pass to it to parse.</p>\n"}, {"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 1, "last_activity_date": 1519642844, "last_edit_date": 1519642844, "creation_date": 1519639049, "answer_id": 48985695, "question_id": 48985627, "link": "https://stackoverflow.com/questions/48985627/how-does-json-unmarshal-work-and-how-is-it-stored-in-a-variable/48985695#48985695", "title": "How does json.Unmarshal() work and how is it stored in a variable?", "body": "<p>You have created a pointer to payload using <code>&amp;p</code> address operator. Now It saves the value at an address pointed by p. According to Golang spec <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\">Unmarshal</a> takes data in bytes format and interface{} to wrap the variable storing the data at an address.</p>\n\n<blockquote>\n  <p>Unmarshal parses the JSON-encoded data and stores the result in the\n  value pointed to by v. If v is nil or not a pointer, Unmarshal returns\n  an InvalidUnmarshalError.</p>\n</blockquote>\n\n<p>Unmarshal function returns an error </p>\n\n<pre><code>func Unmarshal(data []byte, v interface{}) error\n\nvar m Message\nerr := json.Unmarshal(b, &amp;m)\n</code></pre>\n\n<p>which is why it is assigned to a variable. You can surpass it using <code>_</code> operator but it is not a good approach</p>\n\n<pre><code>_ := json.Unmarshal(b, &amp;m)\n</code></pre>\n"}], "owner": {"reputation": 1001, "user_id": 5571728, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/be1f1adae604fc38676bf73e5fcd3513?s=128&d=identicon&r=PG&f=1", "display_name": "sac Dahal", "link": "https://stackoverflow.com/users/5571728/sac-dahal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 696, "favorite_count": 0, "accepted_answer_id": 48985686, "answer_count": 2, "score": -2, "last_activity_date": 1519654833, "creation_date": 1519638848, "last_edit_date": 1519654833, "question_id": 48985627, "link": "https://stackoverflow.com/questions/48985627/how-does-json-unmarshal-work-and-how-is-it-stored-in-a-variable", "title": "How does json.Unmarshal() work and how is it stored in a variable?", "body": "<p>Just started with Go and I have a small doubt from a tutorial I am following. I read that <code>Unmarshall</code> is some kind of JSON encoding, my doubt here is: <code>err = json.Unmarshal(body, &amp;p)</code> why are we assigning the encoded body to <code>err</code> and how is <code>p.Stuff.Fruit</code> getting the value when I can't see anything assigned to <code>p</code>.</p>\n\n<p><strong>Note : produce is different package which contains some type and arrays.*</strong></p>\n\n<pre><code>func main() {\n  url := \"http://localhost:12337\"\n  res, err := http.Get(url)\n  if err != nil {\n    panic(err)\n  }\n  defer res.Body.Close()\n\n  body, err := ioutil.ReadAll(res.Body)\n  if err != nil {\n    panic(err)\n  }\n\n  var p produce.Payload\n\n  err = json.Unmarshal(body, &amp;p)  // I cant get this\n  if err != nil {\n    panic(err)\n  }\n\n  // how are these getting the values assigned to them\n\n  fmt.Println(p.Stuff.Fruit)\n  fmt.Println(p.Stuff.Veggies)\n}\n</code></pre>\n"}, {"tags": ["go", "systemd"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1519640111, "post_id": 48985184, "comment_id": 84976432, "body": "what is the output of <code>journalctl -xfe -u sman</code> while launch? Also are you sure you have right permission for user <code>steam</code> for directory <code>&#47;var&#47;gameserver&#47;steam&#47;</code> ?"}, {"owner": {"reputation": 93, "user_id": 3913137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24a524b597a781cf9619a674967ad350?s=128&d=identicon&r=PG", "display_name": "Toasterson", "link": "https://stackoverflow.com/users/3913137/toasterson"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1519651300, "post_id": 48985184, "comment_id": 84983563, "body": "Hi Yes User steam has full permisions to /var/gameserver/steam ls -alh /var/gameserver/steam/ total 12M drwxr-xr-x 28 steam steam 4.0K Feb 25 13:40 ."}, {"owner": {"reputation": 93, "user_id": 3913137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24a524b597a781cf9619a674967ad350?s=128&d=identicon&r=PG", "display_name": "Toasterson", "link": "https://stackoverflow.com/users/3913137/toasterson"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1519651327, "post_id": 48985184, "comment_id": 84983584, "body": "Appended the output of journalctl -xfe -u sman"}, {"owner": {"reputation": 9712, "user_id": 66907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f45da391d77044534895e4dd3770ffd2?s=128&d=identicon&r=PG", "display_name": "Sascha", "link": "https://stackoverflow.com/users/66907/sascha"}, "edited": false, "score": 0, "creation_date": 1519654216, "post_id": 48985184, "comment_id": 84985426, "body": "I had once the problem that I have not bundled static web files correctly and did not recover well, maybe some dependencies are missing? Just a wild guess from inspired by my own mistakes"}, {"owner": {"reputation": 93, "user_id": 3913137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24a524b597a781cf9619a674967ad350?s=128&d=identicon&r=PG", "display_name": "Toasterson", "link": "https://stackoverflow.com/users/3913137/toasterson"}, "edited": false, "score": 0, "creation_date": 1519657897, "post_id": 48985184, "comment_id": 84987846, "body": "Yeah I also thought I had a problem with my Program but I can run it fine Manually. If I do &#39;su - steam -c &quot;/var/gameserver/steam/sman&quot;&#39; manually it works but not via systemd. Code is here btw. if interested: <a href=\"https://git.wegmueller.it/Toasterson/sman\" rel=\"nofollow noreferrer\">git.wegmueller.it/Toasterson/sman</a> but the only thing I can imagine is that systemd somehow does not like what I have done in func main. Which would be insane but hey you never know."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1519664146, "post_id": 48985184, "comment_id": 84991919, "body": "Somewhere your code has reached <code>os.Exit(2)</code> Whether that&#39;s in your code or somewhere in the standard library (e.g. unrecovered <code>panic</code>) I can&#39;t tell. But you may want to review your code carefully and add error checking anywhere that it is currently missing."}, {"owner": {"reputation": 93, "user_id": 3913137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24a524b597a781cf9619a674967ad350?s=128&d=identicon&r=PG", "display_name": "Toasterson", "link": "https://stackoverflow.com/users/3913137/toasterson"}, "edited": false, "score": 0, "creation_date": 1519674413, "post_id": 48985184, "comment_id": 84997284, "body": "Is there a way to emulate the specific environment of systemd to help debugging? I am unable to recreate any os.Exit(2) or panic() when running manually"}], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 3913137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24a524b597a781cf9619a674967ad350?s=128&d=identicon&r=PG", "display_name": "Toasterson", "link": "https://stackoverflow.com/users/3913137/toasterson"}, "is_accepted": true, "score": 2, "last_activity_date": 1524211738, "creation_date": 1524211738, "answer_id": 49937017, "question_id": 48985184, "link": "https://stackoverflow.com/questions/48985184/what-is-wrong-with-my-systemd-service/49937017#49937017", "title": "What is wrong with my systemd service", "body": "<p>I finally managed to find out what was wrong. Systemd needs all Env Variables explicitly mentioned. However it looks like I had loads of troubles reloading systemd services. This is what i've ended up doing. the service needs to be stoped, the .service file moved to a location systemd does not read, after that reload systemd with <code>systemctl daemon-reload</code> and wait until <code>systemctl status $SERVICE</code> claims there is no such service. (Systemd might still reread the cache if status claims anything else) After that add the .service file again to the appropriate location and voila it finaly worked.</p>\n"}], "owner": {"reputation": 93, "user_id": 3913137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24a524b597a781cf9619a674967ad350?s=128&d=identicon&r=PG", "display_name": "Toasterson", "link": "https://stackoverflow.com/users/3913137/toasterson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7435, "favorite_count": 0, "accepted_answer_id": 49937017, "answer_count": 1, "score": 3, "last_activity_date": 1524211738, "creation_date": 1519637416, "last_edit_date": 1524171083, "question_id": 48985184, "link": "https://stackoverflow.com/questions/48985184/what-is-wrong-with-my-systemd-service", "title": "What is wrong with my systemd service", "body": "<p>I have written a golang RestAPI based on labstack/echo and vuejs and have a working version compiled and everything runs nicely when I start it. So far so good.</p>\n\n<p>However when trying to integrate it with systemd to start the process at boot I am stuck. I have a service file.</p>\n\n<pre><code>[Unit]\nDescription=Server Software Manager\nAfter=network.target\n\n[Service]\nType=simple\nExecStart=/var/gameserver/steam/sman\nKillMode=process\nUser=steam\nGroup=steam\nRestart=on-failure\nSuccessExitStatus=2\n\n[Install]\nWantedBy=multi-user.target\nAlias=sman.service\n</code></pre>\n\n<p>But everytime I want to start the service I get the following error.</p>\n\n<pre><code>Feb 25 14:17:49 &lt;SERVERNAME&gt; systemd[1]: Stopped Server Software Manager.\nFeb 25 14:17:49 &lt;SERVERNAME&gt; systemd[1]: Started Server Software Manager.\nFeb 25 14:17:49 &lt;SERVERNAME&gt; systemd[1]: sman.service: Main process exited, code=exited, status=2/INVALIDARGUMENT\nFeb 25 14:17:49 &lt;SERVERNAME&gt; systemd[1]: sman.service: Unit entered failed state.\nFeb 25 14:17:49 &lt;SERVERNAME&gt; systemd[1]: sman.service: Failed with result 'exit-code'.\nFeb 25 14:17:50 &lt;SERVERNAME&gt; systemd[1]: sman.service: Service hold-off time over, scheduling restart.\nFeb 25 14:17:50 &lt;SERVERNAME&gt; systemd[1]: Stopped Server Software Manager.\nFeb 25 14:17:50 &lt;SERVERNAME&gt; systemd[1]: sman.service: Start request repeated too quickly.\nFeb 25 14:17:50 &lt;SERVERNAME&gt; systemd[1]: Failed to start Server Software Manager.\nFeb 25 14:19:59 &lt;SERVERNAME&gt; systemd[1]: Started Server Software Manager.\n</code></pre>\n\n<p>According to google that error is when the Service exits with error code but when I run the Service manually as the steam user it does not do that.</p>\n\n<p>My assumption is that something is wrong with that unit file but I don't know what. And Systemd-analyze has also not complained.\nI am completely lost and thankful for any leads you might have help debug this.</p>\n\n<p>The output of jounarlctl -xfe -u sman:</p>\n\n<pre><code>Feb 26 14:18:23 &lt;SERVERNAME&gt; systemd[1]: Started Server Software Manager.\n-- Subject: Unit sman.service has finished start-up\n-- Defined-By: systemd\n-- Support: http://lists.freedesktop.org/mailman/listinfo/systemd-devel\n-- \n-- Unit sman.service has finished starting up.\n-- \n-- The start-up result is done.\n</code></pre>\n\n<p>Notes:\nOS: Ubuntu 16.04 LTS</p>\n"}, {"tags": ["go", "revel"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1519635576, "post_id": 48984348, "comment_id": 84973893, "body": "<code>service</code> seems to be global, make it instead a field on <code>MyController</code> and define it as an interface with one method <code>HealthService</code>. Then in your test file implement a service mock type that satisfies that interface and inside your test initialize that mock and set it as the service field on the <code>myController</code> instance."}, {"owner": {"reputation": 163, "user_id": 4970944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5115d1b7f1e4b600f4b21462fce45db5?s=128&d=identicon&r=PG", "display_name": "abhijit gupta", "link": "https://stackoverflow.com/users/4970944/abhijit-gupta"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1519643703, "post_id": 48984348, "comment_id": 84978826, "body": "This will be able to mock the service. But how will routes will initialize the service ? As routes.go and main.go files are self generated."}], "answers": [{"comments": [{"owner": {"reputation": 6900, "user_id": 259562, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/648b40ee271355e605029dd38cf60cef?s=128&d=identicon&r=PG", "display_name": "dierre", "link": "https://stackoverflow.com/users/259562/dierre"}, "edited": false, "score": 0, "creation_date": 1612875612, "post_id": 60185759, "comment_id": 116897942, "body": "You said it as well, this looks less than ideal. I&#39;m scared there is no way to do proper DI."}], "tags": [], "owner": {"reputation": 735, "user_id": 3956263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sR0Im.jpg?s=128&g=1", "display_name": "Jean-Jacques MOIROUX", "link": "https://stackoverflow.com/users/3956263/jean-jacques-moiroux"}, "is_accepted": false, "score": 0, "last_activity_date": 1581501952, "creation_date": 1581501952, "answer_id": 60185759, "question_id": 48984348, "link": "https://stackoverflow.com/questions/48984348/how-to-mock-service-from-controller-using-revel-framework-in-golang/60185759#60185759", "title": "How to mock service from controller using revel framework in golang?", "body": "<p>You should really consider using the revel test framework it's working fine.</p>\n\n<p>for your issue try this, inject your service on the structure, instead of calling it directly, that will allow you to mock it in a test.</p>\n\n<p>Not beautifull but will do the trick.</p>\n\n<pre><code>type MyController struct {\n    *revel.Controller\n    Initialized   bool\n    HealthService func() ([]byte, int)\n}\n\nfunc (t *MyController) init() {\n    if !t.Initialized {\n        t.Initialized = true\n        t.HealthService = func() ([]byte, int) {\n            return service.HealthService()\n        }\n    }\n}\n\nfunc (c MyController) HealthCheckHandler() revel.Result {\n    c.init()\n\n    responseBody, status := c.HealthService()\n    c.Response.Status = status\n    return c.RenderJSON(responseBody)\n}\n\nfunc TestHealth(t *testing.T) {\n    mockFunction := func() ([]byte, int) {\n        return []byte(`\"message\":\"you custom body here\"`), http.StatusOK\n    }\n\n    myController := &amp;MyController{\n        &amp;revel.Controller{\n            Response: &amp;revel.Response{\n                Status: 200,\n            },\n        },\n        HealthService: mockFunction,\n        Initialized:   true,\n    }\n\n    res := myController.HealthCheckHandler()\n}\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 4970944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5115d1b7f1e4b600f4b21462fce45db5?s=128&d=identicon&r=PG", "display_name": "abhijit gupta", "link": "https://stackoverflow.com/users/4970944/abhijit-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 369, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1581501952, "creation_date": 1519634232, "question_id": 48984348, "link": "https://stackoverflow.com/questions/48984348/how-to-mock-service-from-controller-using-revel-framework-in-golang", "title": "How to mock service from controller using revel framework in golang?", "body": "<p>I am writing unit test for project written in revel framework. Revel itself  provides testing framework but its more towards BDD test type. So I started with go test. \nThe MyController.go file looks like below</p>\n\n<pre><code>type MyController struct {\n    *revel.Controller\n}\n\nfunc (c MyController) HealthCheckHandler() revel.Result {\n   responseBody, status := service.HealthService()\n   c.Response.Status = status\n   return c.RenderJSON(responseBody)\n }\n</code></pre>\n\n<p>MyController_test.go file </p>\n\n<pre><code>func TestHealth(t *testing.T ){\n\nmyController := &amp;MyController{\n    &amp;revel.Controller{\n        Response:&amp;revel.Response{\n            Status:200,\n        },\n    }   ,\n    }\n res := myController.HealthCheckHandler()\n\n}\n</code></pre>\n\n<p>How can I mock HealthService() method ? If I use Interface-Composition way for mocking then how routes will inject the interface? As routes.go is self generated file.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1124, "user_id": 3805062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nIUyW.jpg?s=128&g=1", "display_name": "bayrinat", "link": "https://stackoverflow.com/users/3805062/bayrinat"}, "is_accepted": false, "score": 12, "last_activity_date": 1519630776, "creation_date": 1519630776, "answer_id": 48983575, "question_id": 48983303, "link": "https://stackoverflow.com/questions/48983303/how-to-change-cache-directory-during-the-go-build-process/48983575#48983575", "title": "How to change ~/.cache directory during the Go build process", "body": "<blockquote>\n  <p>The cache defaults to the operating system-defined user cache\n  directory but can be moved by setting $GOCACHE.</p>\n</blockquote>\n\n<p>Source: <a href=\"https://groups.google.com/forum/#!topic/golang-dev/qfa3mHN4ZPA\" rel=\"noreferrer\">article from rsc</a></p>\n"}], "owner": {"reputation": 139, "user_id": 7827768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5568963bcbf3457c4a10ac0ca72ce7eb?s=128&d=identicon&r=PG&f=1", "display_name": "Flying Jay", "link": "https://stackoverflow.com/users/7827768/flying-jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5271, "favorite_count": 0, "answer_count": 1, "score": 8, "last_activity_date": 1519630776, "creation_date": 1519629629, "question_id": 48983303, "link": "https://stackoverflow.com/questions/48983303/how-to-change-cache-directory-during-the-go-build-process", "title": "How to change ~/.cache directory during the Go build process", "body": "<p>Go build touches ~/.cache which is undesirable.</p>\n\n<p>How can I change the location of this directory?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4976, "user_id": 99189, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e85341a6b300fd04dc33b1baa28b7fd8?s=128&d=identicon&r=PG", "display_name": "Jeremy Huiskamp", "link": "https://stackoverflow.com/users/99189/jeremy-huiskamp"}, "edited": false, "score": 0, "creation_date": 1519632211, "post_id": 48983247, "comment_id": 84972354, "body": "Are you trying to test code that\u2019s in the <code>main</code> package?"}, {"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 0, "creation_date": 1519633078, "post_id": 48983247, "comment_id": 84972731, "body": "It&#39;s possible that you are not including all the packages required to build base.go. Have you seen this question about testing specific files? <a href=\"https://stackoverflow.com/questions/16935965/how-to-run-test-cases-in-a-specified-file\" title=\"how to run test cases in a specified file\">stackoverflow.com/questions/16935965/&hellip;</a>"}, {"owner": {"reputation": 27, "user_id": 7169790, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2ef49341568076eaa9ede9901d6192d?s=128&d=identicon&r=PG&f=1", "display_name": "NHa", "link": "https://stackoverflow.com/users/7169790/nha"}, "reply_to_user": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 0, "creation_date": 1519724889, "post_id": 48983247, "comment_id": 85015733, "body": "@Zak. I updated the problem."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7169790, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2ef49341568076eaa9ede9901d6192d?s=128&d=identicon&r=PG&f=1", "display_name": "NHa", "link": "https://stackoverflow.com/users/7169790/nha"}, "edited": false, "score": 0, "creation_date": 1519719199, "post_id": 48984353, "comment_id": 85012325, "body": "First, Thank you for your. BUt I n=know How to let the files pass. I want to know why it can not pass. Not change file name and the other things let them pass. I also said in my post know how to let them pass."}], "tags": [], "owner": {"reputation": 750, "user_id": 2947756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qpCxL.png?s=128&g=1", "display_name": "xReprisal", "link": "https://stackoverflow.com/users/2947756/xreprisal"}, "is_accepted": false, "score": 2, "last_activity_date": 1519634255, "creation_date": 1519634255, "answer_id": 48984353, "question_id": 48983247, "link": "https://stackoverflow.com/questions/48983247/go-test-can-not-load-package-with-command-go-test-file1-test-go-file2-go/48984353#48984353", "title": "go test can not load package with command: go test file1_test.go file2.go", "body": "<p>You should follow go's best practices. </p>\n\n<p>That is: </p>\n\n<ol>\n<li><p>Package names should contain only letters with no underscores.</p></li>\n<li><p>Test file should be name of original file + test like: <code>base.go</code> - <code>base_test.go</code>. </p></li>\n<li><p>Run test by going to packages directory and running <code>go test</code>. </p></li>\n</ol>\n\n<p>If you make those changes, your tests should run without any problems.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 7169790, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2ef49341568076eaa9ede9901d6192d?s=128&d=identicon&r=PG&f=1", "display_name": "NHa", "link": "https://stackoverflow.com/users/7169790/nha"}, "edited": false, "score": 0, "creation_date": 1519788688, "post_id": 49010416, "comment_id": 85048222, "body": "Thanks for your answer"}], "tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": false, "score": 0, "last_activity_date": 1519739774, "creation_date": 1519739774, "answer_id": 49010416, "question_id": 48983247, "link": "https://stackoverflow.com/questions/48983247/go-test-can-not-load-package-with-command-go-test-file1-test-go-file2-go/49010416#49010416", "title": "go test can not load package with command: go test file1_test.go file2.go", "body": "<p>If you checkout the <code>go help test</code> command there is this:</p>\n\n<blockquote>\n  <p>Test files that declare a package with the suffix \"_test\" will be\n  compiled as a separate package, and then linked and run with the main\n  test binary.</p>\n</blockquote>\n\n<p>What is happening is that your file <code>yyy_test.go</code> is recognised as a test file because of its <code>_test.go</code> ending. The package defined in that file <code>package xxx_test</code> is considered to be the test version of the <code>xxx</code> package.</p>\n\n<p>See this stack answer for desc: <a href=\"https://stackoverflow.com/a/31443271/6376471\">https://stackoverflow.com/a/31443271/6376471</a></p>\n\n<p>Then, along comes <code>zzz.go</code> which is not recognised as a test file, because it's missing the <code>_test.go</code> suffix, it has a packge <code>xxx_test</code> which is <em>not</em> considered to be a test package. </p>\n\n<p>This means that essentially you are defining the packages <code>xxx_test</code> from <code>zzz.go</code> and <code>xxx</code> from <code>yyy_test.go</code>, even though <code>yyy_test.go</code> actually defines <code>xxx_test</code>, but it's in a test file so handled differently.</p>\n\n<p>Solutions:</p>\n\n<ul>\n<li>Identify <code>zzz.go</code> as a test file by making it <code>zzz_test.go</code>.</li>\n<li>Set <code>zzz.go</code> to have the non test package name <code>package xxx</code> instead of <code>package xxx_test</code>.</li>\n</ul>\n"}], "owner": {"reputation": 27, "user_id": 7169790, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2ef49341568076eaa9ede9901d6192d?s=128&d=identicon&r=PG&f=1", "display_name": "NHa", "link": "https://stackoverflow.com/users/7169790/nha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5237, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519739774, "creation_date": 1519629418, "last_edit_date": 1519725333, "question_id": 48983247, "link": "https://stackoverflow.com/questions/48983247/go-test-can-not-load-package-with-command-go-test-file1-test-go-file2-go", "title": "go test can not load package with command: go test file1_test.go file2.go", "body": "<p>I am writing units test. I put all of the test files in other directory. Let's say the folder mypack.</p>\n\n<p>There two files in the folder fun1_test.go and base.go. </p>\n\n<p>The base.go has same common basic functions which are called by fun1_test.go. The base.go looks like:</p>\n\n<pre><code>package mypack_test\nimport (\n.....\n)\n\nfunc Base1() {\n    // some code\n}\n</code></pre>\n\n<p>The func1_test.go has functions which test func1. The func1_test.go looks like:</p>\n\n<pre><code>package mypack_test\nimport (\n.....\n)\n\nfunc TestFunc1() {\n    // some code\n    Base1()\n    // some code\n}\n</code></pre>\n\n<p>When I use command</p>\n\n<pre><code>go test func1_test.go base.go\n</code></pre>\n\n<p>There will be an error: </p>\n\n<p>can't load package: package main: found packages mypack (func1_test.go) and mypack_test (base.go)</p>\n\n<p>Can any one tell me why this happend. I know If the change the file base.go to base_test.go. The command will work ok. But I want to know why.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I notice some of you guys misunderstanding the problem. The problem is not about if the two file need the other packages or one can call one.  </p>\n\n<p>The problem is that: If you have <strong>two file</strong> with <strong>same package</strong>, the package name looks like <code>xxx_test</code>.  But the two files' name are <strong>yyy_test.go</strong> and <strong>zzz.go</strong>. When using <code>go test yyy_test.go zzz.go</code> command, there will be an error said they two file not in same packages. </p>\n\n<p>The error are: can't load package: package main: found packages xxx (yyy_test.go) and xxx_test (zzz.go)</p>\n"}, {"tags": ["go", "exec"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9411683, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "BrainGamez", "link": "https://stackoverflow.com/users/9411683/braingamez"}, "edited": false, "score": 0, "creation_date": 1519713711, "post_id": 48984585, "comment_id": 85009765, "body": "I found out that the code is running fine by itself. I think the problem is in my code which is calling the function with this part."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1519635699, "last_edit_date": 1519635699, "creation_date": 1519635190, "answer_id": 48984585, "question_id": 48982903, "link": "https://stackoverflow.com/questions/48982903/using-exec-only-starts-program-in-background/48984585#48984585", "title": "Using exec only starts program in background", "body": "<p>You don't need that empty <code>\"\"</code> parameter, simply use:</p>\n\n<pre><code>cmd := exec.Command(\"cmd.exe\", \"/C\", \"start\", \"notepad.exe\")\n</code></pre>\n\n<p>Also <code>notepad.exe</code> won't write anything to its standard output, so you don't need to set it. Simply run it like:</p>\n\n<pre><code>s := []string{\"cmd.exe\", \"/C\", \"start\", \"notepad.exe\"}\nlog.Println(\"Starting\", s)\n\ncmd := exec.Command(s[0], s[1:]...)\nif err := cmd.Run(); err != nil {\n    log.Println(\"Error:\", err)\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9411683, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "BrainGamez", "link": "https://stackoverflow.com/users/9411683/braingamez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 320, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1519635699, "creation_date": 1519627896, "last_edit_date": 1519631485, "question_id": 48982903, "link": "https://stackoverflow.com/questions/48982903/using-exec-only-starts-program-in-background", "title": "Using exec only starts program in background", "body": "<p>I am trying to make a go program that calls another program (with a GUI) by command line.</p>\n\n<p>Using os/exec package. The external program starts, but it always runs in the background. (Even if I try to start \"Notepad.exe\" or a .bat file which then calls the actual program.) </p>\n\n<p>In the task manager you can see the process but there no way to interact with it.</p>\n\n<p>Here's an example of code I've been experimenting with:</p>\n\n<pre><code>cmd := exec.Command(\"cmd.exe\", \"/C\", \"start\", \"\\\"\\\"\", `Notepad.exe`)\n\nlog.Println(\"cmd.exe\", \"/C\", \"start\", \"\\\"\\\"\", `Notepad.exe`)\n\ncmd.Stdout = os.Stdout\nif err := cmd.Start(); err != nil {\n    log.Println(\"Error: \", err)\n}\n</code></pre>\n\n<p>Is there a way to alter the code so it starts \"Notepad.exe\" in a way it can be interacted with via the UI?</p>\n\n<p>I am trying this with a program on Windows compiled on Mac.</p>\n"}, {"tags": ["go", "mux", "gorilla"], "comments": [{"owner": {"reputation": 1124, "user_id": 3805062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nIUyW.jpg?s=128&g=1", "display_name": "bayrinat", "link": "https://stackoverflow.com/users/3805062/bayrinat"}, "edited": false, "score": 0, "creation_date": 1519630281, "post_id": 48982724, "comment_id": 84971597, "body": "<code>mux</code> allows you control priorities of handlers just by their order. If you have several suitable patterns, the earliest defined handler will be called."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 4394954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4604fcb6843da829e6b969fb0225846?s=128&d=identicon&r=PG&f=1", "display_name": "No_20", "link": "https://stackoverflow.com/users/4394954/no-20"}, "is_accepted": false, "score": 0, "last_activity_date": 1519628146, "creation_date": 1519628146, "answer_id": 48982965, "question_id": 48982724, "link": "https://stackoverflow.com/questions/48982724/how-to-ignore-a-word-and-match-all-other-words-when-using-gorilla-mux-router/48982965#48982965", "title": "How to ignore a word and match all other words when using gorilla mux router?", "body": "<p>like this.</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n)\n\nfunc main() {\n    r := mux.NewRouter()\n    r.HandleFunc(\"/items/request-task\", func(w http.ResponseWriter, r *http.Request) {\n        w.Write([]byte(\"task.\"))\n    }) // task HandleFunc before other\n    r.HandleFunc(\"/items/{item-id}\", func(w http.ResponseWriter, r *http.Request) {\n        w.Write([]byte(\"other.\"))\n    })\n    http.Handle(\"/\", r)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2675516"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519628146, "creation_date": 1519627019, "question_id": 48982724, "link": "https://stackoverflow.com/questions/48982724/how-to-ignore-a-word-and-match-all-other-words-when-using-gorilla-mux-router", "title": "How to ignore a word and match all other words when using gorilla mux router?", "body": "<p>For example, I have a func that handles \"/items/{item-id}\" and another func that handles \"/items/request-task\". How to make the first func ignores \"/items/request-task\" and match the rest?</p>\n"}, {"tags": ["go", "error-handling", "concurrency"], "comments": [{"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 0, "creation_date": 1519665658, "post_id": 48981528, "comment_id": 84992847, "body": "So what&#39;s your goal here?  Are you trying to get very accurate display of the order things happen via printing to stdout?  Are you trying to get nicely formatted output that ignores the fact that concurrency doesn&#39;t guarantee the order of events across different goroutines without setting up some sort of scheduling scheme?  Depending on what you want, you may not need channels at all, you could just print to stdout from the goroutine and go back to using a waitgroup so you can print your final message from main after all runCommands complete."}, {"owner": {"reputation": 267, "user_id": 8020595, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e03b1dff3295eab007f791de5f787f60?s=128&d=identicon&r=PG&f=1", "display_name": "mwalto7", "link": "https://stackoverflow.com/users/8020595/mwalto7"}, "reply_to_user": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 0, "creation_date": 1519665801, "post_id": 48981528, "comment_id": 84992934, "body": "@jrefior The ladder: getting nicely formatted output that ignores the order of events."}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 0, "creation_date": 1519666078, "post_id": 48981528, "comment_id": 84993096, "body": "And what order are you looking for?  The original order of the hosts list?  Alphabetical by host name?  Something else?"}, {"owner": {"reputation": 267, "user_id": 8020595, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e03b1dff3295eab007f791de5f787f60?s=128&d=identicon&r=PG&f=1", "display_name": "mwalto7", "link": "https://stackoverflow.com/users/8020595/mwalto7"}, "reply_to_user": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 0, "creation_date": 1519666395, "post_id": 48981528, "comment_id": 84993256, "body": "@jrefior Basically, just need to match the correct hostname with its output/error, regardless of the order the hosts are processed. So if <code>host3</code> is processed first, <code>host7</code> second, etc., I want to print the hostname followed by its output/error followed by a closing message including the hostname. If you look at the flow of <code>runCommand</code>, I want to print the hostname before <code>ssh.Dial()</code> and print <code>Connection to &lt;hostname&gt; closed</code> after sending <code>session.Output()</code> to <code>ch</code>."}], "answers": [{"comments": [{"owner": {"reputation": 267, "user_id": 8020595, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e03b1dff3295eab007f791de5f787f60?s=128&d=identicon&r=PG&f=1", "display_name": "mwalto7", "link": "https://stackoverflow.com/users/8020595/mwalto7"}, "edited": false, "score": 0, "creation_date": 1519625629, "post_id": 48982190, "comment_id": 84969827, "body": "So if there is an error during, say, creating the session, i would put <code>ch &lt;- CommandResult{\u201c\u201d, err}</code> and a return statement in the <code>if err != nil {}</code> block?"}, {"owner": {"reputation": 267, "user_id": 8020595, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e03b1dff3295eab007f791de5f787f60?s=128&d=identicon&r=PG&f=1", "display_name": "mwalto7", "link": "https://stackoverflow.com/users/8020595/mwalto7"}, "edited": false, "score": 0, "creation_date": 1519625792, "post_id": 48982190, "comment_id": 84969885, "body": "Also, when/where would I close the channel? Does it need to be closed explicitly in this case?"}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "reply_to_user": {"reputation": 267, "user_id": 8020595, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e03b1dff3295eab007f791de5f787f60?s=128&d=identicon&r=PG&f=1", "display_name": "mwalto7", "link": "https://stackoverflow.com/users/8020595/mwalto7"}, "edited": false, "score": 0, "creation_date": 1519626000, "post_id": 48982190, "comment_id": 84969940, "body": "No the channel does not need to be closed in this case.  A close is typically intended as a flag to indicate that no more sends will occur on a buffered channel (though it can be used in other ways as well).  In particular, it stops <code>for e := range ch {...}</code> loops from being infinite loops."}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "reply_to_user": {"reputation": 267, "user_id": 8020595, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e03b1dff3295eab007f791de5f787f60?s=128&d=identicon&r=PG&f=1", "display_name": "mwalto7", "link": "https://stackoverflow.com/users/8020595/mwalto7"}, "edited": false, "score": 0, "creation_date": 1519626636, "post_id": 48982190, "comment_id": 84970155, "body": "@mwalto7 you could either add a send to each block containing a return, or you could take out the returns and use if-else and just send at the end with the values of output and err. It&#39;s up to you."}, {"owner": {"reputation": 267, "user_id": 8020595, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e03b1dff3295eab007f791de5f787f60?s=128&d=identicon&r=PG&f=1", "display_name": "mwalto7", "link": "https://stackoverflow.com/users/8020595/mwalto7"}, "edited": false, "score": 0, "creation_date": 1519664595, "post_id": 48982190, "comment_id": 84992204, "body": "Thanks! I added my updated code implementing your suggestions above. Having trouble printing things in order, though."}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "reply_to_user": {"reputation": 267, "user_id": 8020595, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e03b1dff3295eab007f791de5f787f60?s=128&d=identicon&r=PG&f=1", "display_name": "mwalto7", "link": "https://stackoverflow.com/users/8020595/mwalto7"}, "edited": false, "score": 0, "creation_date": 1519665051, "post_id": 48982190, "comment_id": 84992475, "body": "@mwalto7 With the mulltiple runCommand goroutines, you&#39;re doing concurrent processing without any guarantee as to which runCommand will be ready to send first, second, ..., last.  Where does your desired order come from?  You might consider adding an ordinal int to <code>CommandResult</code>, putting the received values into a slice, and then sorting them.  Or maybe you have some other sort criteria?  Try to figure it out, and if you can&#39;t, then you could post it as a new question....Ah, I see your edit now, I&#39;ll take a closer look."}, {"owner": {"reputation": 267, "user_id": 8020595, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e03b1dff3295eab007f791de5f787f60?s=128&d=identicon&r=PG&f=1", "display_name": "mwalto7", "link": "https://stackoverflow.com/users/8020595/mwalto7"}, "edited": false, "score": 0, "creation_date": 1519668374, "post_id": 48982190, "comment_id": 84994330, "body": "Thanks for all the help! Got it working as expected."}], "tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": true, "score": 3, "last_activity_date": 1519666879, "last_edit_date": 1519666879, "creation_date": 1519624147, "answer_id": 48982190, "question_id": 48981528, "link": "https://stackoverflow.com/questions/48981528/capture-output-and-errors-of-goroutine-using-channels/48982190#48982190", "title": "Capture Output and Errors of Goroutine Using Channels", "body": "<p>If you use an unbuffered channel, you actually don't need the <code>sync.WaitGroup</code>, because you can call the receive operator on the channel once for every goroutine that will send on the channel.  Each receive operation will block until a send statement is ready, resulting in the same behavior as a WaitGroup.</p>\n\n<p>To make this happen, change runCommand to execute a send statement exactly once before the function exits, under all conditions.</p>\n\n<p>First, create a type to send over the channel:</p>\n\n<pre><code>type CommandResult struct {\n    Output      string\n    Err         error\n}\n</code></pre>\n\n<p>And edit your <code>main() {...}</code> to execute a receive operation on the channel the same number of times as the number of goroutines that will send to the channel:</p>\n\n<pre><code>func main() {\n    ch := make(chan CommandResult) // initialize an unbuffered channel\n    // rest of your setup\n    for _, host := range hosts {\n        go runCommand(host, &amp;clientConf, ch) // pass in the channel\n    }\n    for x := 0; x &lt; len(hosts); x++ {\n        fmt.Println(&lt;-ch) // this will block until one is ready to send\n    }\n</code></pre>\n\n<p>And edit your runCommand function to accept the channel, remove references to WaitGroup, and execute the send exactly once under all conditions:</p>\n\n<pre><code>func runCommand(host string, config *ssh.ClientConfig, ch chan CommandResult) {\n    // do stuff that generates output, err; then when ready to exit function:\n    ch &lt;- CommandResult{output, err}\n}\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT:</strong> Question updated with stdout message order requirements</p>\n\n<blockquote>\n  <p>I'd like to get nicely formatted output that ignores the order of events</p>\n</blockquote>\n\n<p>In this case, remove all print messages from runCommand, you're going to put all output into the element you're passing on the channel so it can be grouped together.  Edit the <code>CommandResult</code> type to contain additional fields you want to organize, such as:</p>\n\n<pre><code>type CommandResult struct {\n    Host        string\n    Output      string\n    Err         error\n}\n</code></pre>\n\n<p>If you don't need to sort your results, you can just move on to printing the data received, e.g.</p>\n\n<pre><code>for x := 0; x &lt; len(hosts); x++ {\n    r := &lt;-ch\n    fmt.Printf(\"Host: %s----\\nOutput: %s\\n\", r.Host, r.Output)\n    if r.Err != nil {\n        fmt.Printf(\"Error: %s\\n\", r.Err)\n    }\n}\n</code></pre>\n\n<p>If you do need to sort your results, then in your <code>main</code> goroutine, add the elements received on the channel to a slice:</p>\n\n<pre><code>    ...\n    results := make([]CommandResult, 0, len(hosts))\n    for x := 0; x &lt; len(hosts); x++ {\n        results = append(results, &lt;-ch) // this will block until one is ready to send\n    }\n</code></pre>\n\n<p>Then you can use <a href=\"https://golang.org/pkg/sort/\" rel=\"nofollow noreferrer\">the <code>sort</code> package</a> in the Go standard library to sort your results for printing.  For example, you could sort them alphabetically by host.  Or you could put the results into a map with host string as the key instead of a slice to allow you to print in the order of the original host list.</p>\n"}], "owner": {"reputation": 267, "user_id": 8020595, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e03b1dff3295eab007f791de5f787f60?s=128&d=identicon&r=PG&f=1", "display_name": "mwalto7", "link": "https://stackoverflow.com/users/8020595/mwalto7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3445, "favorite_count": 1, "accepted_answer_id": 48982190, "answer_count": 1, "score": 0, "last_activity_date": 1519666879, "creation_date": 1519619786, "last_edit_date": 1519664883, "question_id": 48981528, "link": "https://stackoverflow.com/questions/48981528/capture-output-and-errors-of-goroutine-using-channels", "title": "Capture Output and Errors of Goroutine Using Channels", "body": "<p>I have a for-loop that calls a function <code>runCommand()</code> which runs a remote command on a switch and prints the output. The function is called in a goroutine on each iteration and I am using a <code>sync.Waitgroup</code> to synchronize the goroutines. Now, I need a way to capture the output and any errors of my <code>runCommand()</code> function into a channel. I have read many articles and watched a lot of videos on using channels with goroutines, but this is the first time I have ever written a concurrent application and I can't seem to wrap my head around the idea.</p>\n\n<p>Basically, my program takes in a list of hostnames from the command line then asynchronously connects to each host, runs a configuration command on it, and prints the output. It is ok for my program to continue configuring the remaining hosts if one has an error. </p>\n\n<p>How would I idiomatically send the output or error(s) of each call to <code>runCommand()</code> to a channel then receive the output or error(s) for printing?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"golang.org/x/crypto/ssh\"\n    \"os\"\n    \"time\"\n    \"sync\"\n)\n\nfunc main() {\n    hosts := os.Args[1:]\n    clientConf := configureClient(\"user\", \"password\")\n\n    var wg sync.WaitGroup\n    for _, host := range hosts {\n        wg.Add(1)\n        go runCommand(host, &amp;clientConf, &amp;wg)\n    }\n    wg.Wait()\n\n    fmt.Println(\"Configuration complete!\")\n}\n\n// Run a remote command\nfunc runCommand(host string, config *ssh.ClientConfig, wg *sync.WaitGroup) {\n    defer wg.Done()\n    // Connect to the client\n    client, err := ssh.Dial(\"tcp\", host+\":22\", config)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    defer client.Close()\n    // Create a session\n    session, err := client.NewSession()\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    defer session.Close()\n    // Get the session output\n    output, err := session.Output(\"show lldp ne\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Print(string(output))\n    fmt.Printf(\"Connection to %s closed.\\n\", host)\n}\n\n// Set up client configuration\nfunc configureClient(user, password string) ssh.ClientConfig {\n    var sshConf ssh.Config\n    sshConf.SetDefaults()\n    // Append supported ciphers\n    sshConf.Ciphers = append(sshConf.Ciphers, \"aes128-cbc\", \"aes256-cbc\", \"3des-cbc\", \"des-cbc\", \"aes192-cbc\")\n    // Create client config\n    clientConf := &amp;ssh.ClientConfig{\n        Config:          sshConf,\n        User:            user,\n        Auth:            []ssh.AuthMethod{ssh.Password(password)},\n        HostKeyCallback: ssh.InsecureIgnoreHostKey(),\n        Timeout:         time.Second * 5,\n    }\n    return *clientConf\n}\n</code></pre>\n\n<p><strong>EDIT:</strong> I got rid of the Waitgroup, as suggested, and now I need to keep track of which output belongs to which host by printing the hostname before printing its output and printing a <code>Connection to &lt;host&gt; closed.</code> message when the gorouttine completes. For example:</p>\n\n<pre><code>$ go run main.go host1[,host2[,...]]\nConnecting to &lt;host1&gt;\n[Output]\n...\n[Error]\nConnection to &lt;host1&gt; closed.\n\nConnecting to &lt;host2&gt;\n...\nConnection to &lt;host2&gt; closed.\n\nConfiguration complete!\n</code></pre>\n\n<p>I know the above won't necessarily process <code>host1</code> and <code>host2</code> in order, But I need to print the correct host value for the connecting and closing messages before and after the output/error(s), respectively. I tried defering printing the closing message in the <code>runCommand()</code> function, but the message is printed out before the output/error(s). And printing the closing message in the for-loop after each goroutine call doesn't work as expected either.</p>\n\n<p>Updated code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"golang.org/x/crypto/ssh\"\n    \"os\"\n    \"time\"\n)\n\ntype CmdResult struct {\n    Host string\n    Output string\n    Err error\n}\n\nfunc main() {\n    start := time.Now()\n\n    hosts := os.Args[1:]\n    clientConf := configureClient(\"user\", \"password\")\n    results := make(chan CmdResult)\n\n    for _, host := range hosts {\n        go runCommand(host, &amp;clientConf, results)\n    }\n    for i := 0; i &lt; len(hosts); i++ {\n        output := &lt;- results\n        fmt.Println(output.Host)\n        if output.Output != \"\" {\n            fmt.Printf(\"%s\\n\", output.Output)\n        }\n        if output.Err != nil {\n            fmt.Printf(\"Error: %v\\n\", output.Err)\n        }\n    }\n    fmt.Printf(\"Configuration complete! [%s]\\n\", time.Since(start).String())\n}\n\n// Run a remote command\nfunc runCommand(host string, config *ssh.ClientConfig, ch chan CmdResult) {\n    // This is printing before the output/error(s).\n    // Does the same when moved to the bottom of this function.\n    defer fmt.Printf(\"Connection to %s closed.\\n\", host)\n\n    // Connect to the client\n    client, err := ssh.Dial(\"tcp\", host+\":22\", config)\n    if err != nil {\n        ch &lt;- CmdResult{host, \"\", err}\n        return\n    }\n    defer client.Close()\n    // Create a session\n    session, err := client.NewSession()\n    if err != nil {\n        ch &lt;- CmdResult{host, \"\", err}\n        return\n    }\n    defer session.Close()\n    // Get the session output\n    output, err := session.Output(\"show lldp ne\")\n    if err != nil {\n        ch &lt;- CmdResult{host, \"\", err}\n        return\n    }\n    ch &lt;- CmdResult{host, string(output), nil}\n}\n\n// Set up client configuration\nfunc configureClient(user, password string) ssh.ClientConfig {\n    var sshConf ssh.Config\n    sshConf.SetDefaults()\n    // Append supported ciphers\n    sshConf.Ciphers = append(sshConf.Ciphers, \"aes128-cbc\", \"aes256-cbc\", \"3des-cbc\", \"des-cbc\", \"aes192-cbc\")\n    // Create client config\n    clientConf := &amp;ssh.ClientConfig{\n        Config:          sshConf,\n        User:            user,\n        Auth:            []ssh.AuthMethod{ssh.Password(password)},\n        HostKeyCallback: ssh.InsecureIgnoreHostKey(),\n        Timeout:         time.Second * 5,\n    }\n    return *clientConf\n}\n</code></pre>\n"}, {"tags": ["json", "go", "alexa", "alexa-skills-kit", "alexa-skill"], "comments": [{"owner": {"reputation": 32100, "user_id": 1033581, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/e8891617e36b8d1254eb3ce1a5662da4?s=128&d=identicon&r=PG", "display_name": "C\u0153ur", "link": "https://stackoverflow.com/users/1033581/c%c5%93ur"}, "edited": false, "score": 0, "creation_date": 1522122747, "post_id": 48981265, "comment_id": 86012272, "body": "Please never post ephemeral content like paste.ofcode.org on Stack Overflow."}, {"owner": {"reputation": 373, "user_id": 4548510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mForJGavCAM/AAAAAAAAAAI/AAAAAAAAARU/lDh9I6lq1mI/photo.jpg?sz=128", "display_name": "Maurice van Cooten", "link": "https://stackoverflow.com/users/4548510/maurice-van-cooten"}, "edited": false, "score": 0, "creation_date": 1546984538, "post_id": 48981265, "comment_id": 95033440, "body": "Did you ever figure out the answer to this? I&#39;m having the same problem."}], "owner": {"reputation": 310, "user_id": 4317190, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/91ead7da4d55ff9f56f05a9a8a27bf85?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cheek", "link": "https://stackoverflow.com/users/4317190/tyler-cheek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1546984489, "creation_date": 1519617723, "last_edit_date": 1522122734, "question_id": 48981265, "link": "https://stackoverflow.com/questions/48981265/interaction-model-isnt-picking-up-extraneous-slot-values-within-input", "title": "Interaction Model isn&#39;t picking up extraneous slot values within input", "body": "<p>I'm trying to build an Alexa skill that connects to Jira. A while back when I started The interaction model in the Alexa Skills Kit was working fine and picked up multiple slot values in one statement, even if it wasn't asked for. For example, \"Open a user story in the BLAH project and assign it to Blah\" would work and pick up the {ticketType}, {project}, and {assignee} slot values flawlessly. Now I've started using the Dialog.Delegate directive in ASK to allow the interaction model to figure out what it doesn't yet have and keep asking questions until all required slots are filled. Some time after I implemented this, the interaction model stopped recognizing other slot values in utterances that were intended for just one slot value to be filled. If I open the skill with a request like the above, it then asks me what the ticket type is, like I didn't already give it. I have defined sample utterances for my intent in the interaction model and all start with \"Open a {TicketType}\", so the fact that it still asks me for the ticket type when it's given in the input makes no sense to me. </p>\n\n<p>My suspicion is that it has something to do with the way I'm returning the Dialog.Delegate directive. In my code linked below, I'm calling a function AddDialogDirective func(dialogType string, intent *Intent) which is in an open source framework I am using called alexa-skills-kit-golang. I can confirm that the Dialog.Delegate directive is actually called correctly because in the response from my lambda function I am seeing the Dialog.Delegate directive set. </p>\n\n<pre><code>{\n    \"body\": {\n        \"version\": \"1.0\",\n        \"response\": {\n            \"directives\": [\n                {\n                    \"type\": \"Dialog.Delegate\"\n                }\n            ],\n            \"shouldEndSession\": false\n        }\n    }\n}\n</code></pre>\n\n<p>I've tried modifying the AddDialogDirective function to be func(dialogType string, slotToIllicit *string, slotToConfirm *string, intent *Intent) instead, thinking that the framework was somehow returning empty strings in the SlotToIllicit and SlotToConfirm JSON fields instead of not returning those fields, but no luck. I was thinking that returning empty strings here might be making the interaction model that it should be illiciting only one slot at a time and ignoring the dialog model. Do you think this is the issue or could it be something completely different?</p>\n"}, {"tags": ["postgresql", "go"], "answers": [{"tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": true, "score": 3, "last_activity_date": 1519618489, "last_edit_date": 1519618489, "creation_date": 1519617836, "answer_id": 48981278, "question_id": 48980685, "link": "https://stackoverflow.com/questions/48980685/how-do-i-scan-a-jsonb-column-to-a-slice-of-struct-pointer/48981278#48981278", "title": "How do I scan a jsonb column to a slice of struct/pointer?", "body": "<p>You skipped the JSON decoding step.</p>\n\n<p>You'll be getting the jsonb field back from postgres as a string.  Then you'll have to <code>json.Unmarshal</code> it into <code>&amp;p.Children</code>:</p>\n\n<pre><code>func selectChildrenAndJob(db *sql.DB) {\n    p := &amp;Person{}\n    var children string\n    err := db.QueryRow(\"SELECT children, job FROM mytable LIMIT 1\").Scan(&amp;children, &amp;p.Job)\n    switch {\n    case err == sql.ErrNoRows:\n        fmt.Println(\"No rows.\")\n    case err != nil:\n        fmt.Println(\"cannot retrieve child + job rows\", err)\n    default:\n        err = json.Unmarshal([]byte(children), &amp;p.Children)\n        if err != nil {\n            fmt.Printf(\"Failed to unmarshal children: %s\\n\", err)\n            return\n        }\n        childlist := make([]Child, 0)\n        for _, c := range p.Children {\n            childlist = append(childlist, *c)\n        }\n        fmt.Printf(\"children %v; job %v\\n\", childlist, p.Job)\n    }\n}\n</code></pre>\n\n<p>You would have noticed this on your other fields as well if they hadn't been string types.</p>\n\n<p>You can think of it as reversing the steps you took when you were inserting data:</p>\n\n<pre><code>c, e := json.Marshal(person.Children)\n... \"VALUES ($1,$2,$3)\", person.Name, string(c), // ...\n</code></pre>\n\n<p><code>childlist</code> and the corresponding loop at the end are just to satisfy your print format and print the values instead of the pointers.  If you don't mind printing pointers instead, another alternative is to skip that and just</p>\n\n<pre><code>fmt.Printf(\"Person with children and job: %v\\n\", p)\n</code></pre>\n"}], "owner": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1236, "favorite_count": 2, "accepted_answer_id": 48981278, "answer_count": 1, "score": 3, "last_activity_date": 1519618489, "creation_date": 1519612433, "question_id": 48980685, "link": "https://stackoverflow.com/questions/48980685/how-do-i-scan-a-jsonb-column-to-a-slice-of-struct-pointer", "title": "How do I scan a jsonb column to a slice of struct/pointer?", "body": "<p>I have a Postgresql jsonb column I am trying to retrieve in my app. I am able to retrieve a plain old struct/pointer from a jsonb column but am unable to retrieve a slice of structs/pointers. I have:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n\n    _ \"github.com/lib/pq\"\n)\n\n// Person is an employee\ntype Person struct {\n    Name     string\n    Children []*Child\n    Job\n}\n\n// Child is a child of an employee\ntype Child struct {\n    Name string\n    // other fields\n}\n\n// Job is the employment of a person\ntype Job struct {\n    Position string\n    // other fields\n}\n\nfunc main() {\n    db, err := sql.Open(\"postgres\",\n        fmt.Sprintf(\n            \"user=%s password=%s host=%s database=%s sslmode=require\",\n            os.Getenv(\"user\"), os.Getenv(\"pword\"), os.Getenv(\"h\"), os.Getenv(\"db\"),\n        ),\n    )\n    if err != nil {\n        panic(err)\n    }\n\n    defer db.Close()\n    db.SetMaxIdleConns(0)\n\n    // create table\n    if _, err = db.Exec(\"DROP table mytable\"); err != nil {\n        fmt.Printf(\"cannot delete table %v\", err)\n    }\n\n    if _, err = db.Exec(\"CREATE TABLE mytable (name text, children jsonb, job jsonb)\"); err != nil {\n        fmt.Printf(\"cannot create table %v\", err)\n    }\n\n    // insert some rows\n    for _, person := range []Person{\n        Person{\"Bob\", []*Child{&amp;Child{\"Fred\"}, &amp;Child{\"Mary\"}}, Job{\"welder\"}},\n        Person{\"Jane\", []*Child{&amp;Child{\"Ben\"}, &amp;Child{\"Emily\"}}, Job{\"machinist\"}},\n    } {\n        c, e := json.Marshal(person.Children)\n        if e != nil {\n            fmt.Printf(\"cannot marshal children %v\", err)\n        }\n\n        j, e := json.Marshal(person.Job)\n        if e != nil {\n            fmt.Printf(\"cannot marshal job %v\", err)\n        }\n\n        if _, err = db.Exec(\"INSERT INTO mytable (name, children, job) VALUES ($1,$2,$3)\", person.Name, string(c), string(j)); err != nil {\n            fmt.Printf(\"cannot insert value %v\", err)\n        }\n    }\n\n    //selectJob(db)\n    selectChildrenAndJob(db)\n\n}\n\nfunc selectJob(db *sql.DB) {\n    p := &amp;Person{}\n\n    err := db.QueryRow(\"SELECT job FROM mytable LIMIT 1\").Scan(&amp;p.Job)\n    switch {\n    case err == sql.ErrNoRows:\n        fmt.Println(\"No rows.\")\n    case err != nil:\n        fmt.Println(\"cannot retrieve rows\", err)\n    default:\n        fmt.Printf(\"job %v\\n\", p.Job)\n    }\n}\n\nfunc selectChildrenAndJob(db *sql.DB) {\n    p := &amp;Person{}\n\n    err := db.QueryRow(\"SELECT children, job FROM mytable LIMIT 1\").Scan(&amp;p.Children, &amp;p.Job)\n    switch {\n    case err == sql.ErrNoRows:\n        fmt.Println(\"No rows.\")\n    case err != nil:\n        fmt.Println(\"cannot retrieve rows\", err)\n    default:\n        fmt.Printf(\"children %v; job %v\\n\", p.Children, p.Job)\n    }\n}\n\n// Scan scans for Child\nfunc (c *Child) Scan(value interface{}) error {\n    return json.Unmarshal(value.([]byte), c)\n}\n\n// Scan scans for Job\nfunc (j *Job) Scan(value interface{}) error {\n    return json.Unmarshal(value.([]byte), j)\n}\n</code></pre>\n\n<p>The error I get:</p>\n\n<pre><code>Scan error on column index 0: unsupported Scan, storing driver.Value type []uint8 into type *[]*main.Child\n</code></pre>\n\n<p>If I uncomment \"selectJob(db)\" and run that it works. So I cannot figure out how to Scan into a slice of structs/pointers. Any suggestions?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 3, "creation_date": 1519608117, "post_id": 48980159, "comment_id": 84965534, "body": "It dereferences the pointer."}], "answers": [{"tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": true, "score": 5, "last_activity_date": 1519609741, "last_edit_date": 1519609741, "creation_date": 1519608191, "answer_id": 48980233, "question_id": 48980159, "link": "https://stackoverflow.com/questions/48980159/enclosing-a-variable-in-brackets-in-go/48980233#48980233", "title": "Enclosing a variable in brackets in Go", "body": "<p><code>s</code> is a pointer.  <code>*s</code> is the thing it points to.  The parentheses are to make clear -- both to the parser in the compiler, and to the human reader -- which one is being specified for array-style indexing.  That is, it's to disambiguate between:</p>\n\n<pre><code>(*s)[i-1]\n</code></pre>\n\n<p>and</p>\n\n<pre><code>*(s[i-1])\n</code></pre>\n"}], "owner": {"reputation": 660, "user_id": 150305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad0d03aec03eb09398cb09cea2bcb6cd?s=128&d=identicon&r=PG", "display_name": "yannis", "link": "https://stackoverflow.com/users/150305/yannis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 48980233, "answer_count": 1, "score": 0, "last_activity_date": 1519609741, "creation_date": 1519607378, "question_id": 48980159, "link": "https://stackoverflow.com/questions/48980159/enclosing-a-variable-in-brackets-in-go", "title": "Enclosing a variable in brackets in Go", "body": "<p>I am battling to understand what the <code>(*s)</code> does and I would appreciate an explanation.</p>\n\n<pre><code>// pop pops the stack. It will panic if s is empty.\nfunc (s *nodeStack) pop() *Node {\n    i := len(*s)\n    n := (*s)[i-1]\n    *s = (*s)[:i-1]\n    return n\n}\n</code></pre>\n"}, {"tags": ["go", "dns"], "comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 2, "creation_date": 1519619643, "post_id": 48980108, "comment_id": 84968051, "body": "Hmm. Looks like the TTL is available, but only in an unexported struct dnsRR_Header. I don&#39;t see any point where this is made available externally. Maybe in go1.11..."}], "answers": [{"tags": [], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "is_accepted": true, "score": 1, "last_activity_date": 1519680359, "creation_date": 1519680359, "answer_id": 48997354, "question_id": 48980108, "link": "https://stackoverflow.com/questions/48980108/hostname-ip-ttl/48997354#48997354", "title": "Hostname -&gt; IP TTL?", "body": "<p>Just in case, this is a basic example using <a href=\"https://github.com/miekg/dns\" rel=\"nofollow noreferrer\">miekg/dns</a> library</p>\n\n<p><a href=\"https://play.golang.org/p/65hFuth1s_2\" rel=\"nofollow noreferrer\">https://play.golang.org/p/65hFuth1s_2</a></p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"os\"\n\n    \"github.com/miekg/dns\"\n)\n\nfunc main() {\n    domain := flag.String(\"domain\", \"stackoverflow.com\", \"domain name\")\n    flag.Parse()\n    fmt.Printf(\"domain %s\\n\", *domain)\n\n    server := \"8.8.4.4\"\n\n    c := dns.Client{}\n    m := dns.Msg{}\n    m.SetQuestion(*domain+\".\", dns.TypeA)\n    r, _, err := c.Exchange(&amp;m, server+\":53\")\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        os.Exit(1)\n    }\n    if len(r.Answer) == 0 {\n        fmt.Fprintln(os.Stderr, \"Could not found NS records\")\n        os.Exit(1)\n    }\n\n    for _, ans := range r.Answer {\n        if a, ok := ans.(*dns.A); ok {\n            fmt.Printf(\"%s. %d IN A %s\\n\", *domain, ans.Header().Ttl, a.A.String())\n        }\n    }\n}\n</code></pre>\n\n<p>The <code>TTL</code> is obtained by using <code>ans.Header().Ttl</code>.</p>\n\n<p>By default will use the domain <code>stackoverflow.com</code>, and output something like:</p>\n\n<pre><code>domain stackoverflow.com\nstackoverflow.com. 32 IN A 151.101.1.69\nstackoverflow.com. 32 IN A 151.101.65.69\nstackoverflow.com. 32 IN A 151.101.129.69\nstackoverflow.com. 32 IN A 151.101.193.69\n</code></pre>\n\n<p>You can pass any domain by using the domain flag:</p>\n\n<pre><code>go run main.go -domain google.com\n</code></pre>\n\n<p>It is also using Google public DNS server <code>8.8.4.4</code> for resolving.</p>\n"}], "owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "accepted_answer_id": 48997354, "answer_count": 1, "score": 1, "last_activity_date": 1519680359, "creation_date": 1519606743, "question_id": 48980108, "link": "https://stackoverflow.com/questions/48980108/hostname-ip-ttl", "title": "Hostname -&gt; IP TTL?", "body": "<p>Does the go standard library expose the TTL for a hostname -> ip lookup? </p>\n\n<p>For example: <code>dig stackoverflow.com</code> gives 291s:</p>\n\n<pre><code>stackoverflow.com.  291 IN  A   151.101.129.69\nstackoverflow.com.  291 IN  A   151.101.193.69\nstackoverflow.com.  291 IN  A   151.101.1.69\nstackoverflow.com.  291 IN  A   151.101.65.69\n</code></pre>\n\n<p>I've looked through <a href=\"https://golang.org/pkg/net/\" rel=\"nofollow noreferrer\">net</a> but I can't find anything.</p>\n"}, {"tags": ["go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9410385, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zSWT-ejJm58/AAAAAAAAAAI/AAAAAAAAAB8/C2z5fizFLJ8/photo.jpg?sz=128", "display_name": "Martin Gilles", "link": "https://stackoverflow.com/users/9410385/martin-gilles"}, "edited": false, "score": 0, "creation_date": 1519667207, "post_id": 48978798, "comment_id": 84993646, "body": "I have an idea of how this works internally. I just didn&#39;t expect the side-effects of append. Now I do."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 7, "last_activity_date": 1519595205, "creation_date": 1519595205, "answer_id": 48978798, "question_id": 48978667, "link": "https://stackoverflow.com/questions/48978667/deleting-element-of-slice-modifies-original-value/48978798#48978798", "title": "Deleting element of slice modifies original value", "body": "<p>A slice consists of a reference to an underlying array, a length, and a capacity (maximum length). <code>sl1[:idx]</code> is a different slice than <code>sl1</code> (the length is 3 instead of 6), but the underlying array is the same. The <code>append</code> places elements 4 and 5 of <code>sl1</code> into the array at positions 3 and 4. <code>sl2</code> is then a slice of length 5, but the underlying array is still the original one referenced by <code>sl1</code>, so when you print <code>sl1</code>, you see that the elements have changed. See <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"noreferrer\">https://blog.golang.org/go-slices-usage-and-internals</a> for an explanation of how slices work.</p>\n"}], "owner": {"reputation": 27, "user_id": 9410385, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zSWT-ejJm58/AAAAAAAAAAI/AAAAAAAAAB8/C2z5fizFLJ8/photo.jpg?sz=128", "display_name": "Martin Gilles", "link": "https://stackoverflow.com/users/9410385/martin-gilles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1519631498, "creation_date": 1519594246, "last_edit_date": 1519631498, "question_id": 48978667, "link": "https://stackoverflow.com/questions/48978667/deleting-element-of-slice-modifies-original-value", "title": "Deleting element of slice modifies original value", "body": "<p>I'm wondering about the following behavior:</p>\n\n<pre><code>sl1 := []int{0, 1, 2, 3, 4, 5}\nfmt.Printf(\"sl1: %v\\n\", sl1)\n//Prints sl1: [0 1 2 3 4 5]\n\nidx := 3\nsl2 := append(sl1[:idx], sl1[idx+1:]...)\nfmt.Printf(\"sl1: %v\\n\", sl1)\n//Prints sl1: [0 1 2 4 5 5] -&gt; strange!\nfmt.Printf(\"sl2: %v\\n\", sl2)\n//Prints sl2: [0 1 2 4 5] -&gt; expected!\n</code></pre>\n\n<p>Looks like append is doing something weird on the original slice pointer.\nIs this a bug or intended behavior? See also <a href=\"https://play.golang.org/p/EX3eqJz5Q8K\" rel=\"nofollow noreferrer\">https://play.golang.org/p/EX3eqJz5Q8K</a> </p>\n"}, {"tags": ["mongodb", "date", "go", "isodate"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1519596218, "post_id": 48978652, "comment_id": 84962922, "body": "What was the error, if you print it out?"}, {"owner": {"reputation": 801, "user_id": 1954034, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5VjQT.png?s=128&g=1", "display_name": "Nikhil Joshi", "link": "https://stackoverflow.com/users/1954034/nikhil-joshi"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1519596975, "post_id": 48978652, "comment_id": 84963164, "body": "Hello @Mark, added error &quot;invalid character &#39;I&#39; looking for beginning of value&quot; in the main question, thanks for looking into it."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 1, "creation_date": 1519597652, "post_id": 48978652, "comment_id": 84963351, "body": "That error suggests the request body couldn&#39;t be decoded because it&#39;s not valid json. Look closely at the request body itself, and check it&#39;s valid json, according to the <a href=\"https://www.json.org\" rel=\"nofollow noreferrer\">json specification</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "is_accepted": false, "score": 0, "last_activity_date": 1519598898, "creation_date": 1519598898, "answer_id": 48979321, "question_id": 48978652, "link": "https://stackoverflow.com/questions/48978652/rest-api-mongodb-isodate/48979321#48979321", "title": "REST API + MongoDb ISODate", "body": "<p>The </p>\n\n<pre><code>ISODate(\"2013...\")\n</code></pre>\n\n<p>value is not valid JSON. That looks like a symbol or function call, neither of which are allowed in JSON. And there is no date type in JSON:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10286204/the-right-json-date-format\">The &quot;right&quot; JSON date format</a> </p>\n"}], "owner": {"reputation": 801, "user_id": 1954034, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5VjQT.png?s=128&g=1", "display_name": "Nikhil Joshi", "link": "https://stackoverflow.com/users/1954034/nikhil-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 407, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519631517, "creation_date": 1519594115, "last_edit_date": 1519631517, "question_id": 48978652, "link": "https://stackoverflow.com/questions/48978652/rest-api-mongodb-isodate", "title": "REST API + MongoDb ISODate", "body": "<p>My GoLang struct:</p>\n\n<pre><code>type myPojo struct {\n    ID                bson.ObjectId                 `json:\"id\" bson:\"_id,omitempty\"`\n    Start             time.Time                     `json:\"start\"`\n}\n</code></pre>\n\n<p>POST API JSON input request:</p>\n\n<pre><code>{\n    \"Start\":ISODate(\"2013-10-01T00:00:00.000Z\")\n}\n</code></pre>\n\n<p>My code to convert input JSON request to Golang Struct:</p>\n\n<pre><code>func myPostApi(w http.ResponseWriter, r *http.Request, db mongoDB) {\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    decoder := json.NewDecoder(r.Body)\n    var inputObj myPojo\n    err := decoder.Decode(&amp;inputObj)\n\n    if err != nil {\n        //This gets executed\n        log.Println(\"Error occurred converting POST input json to myPojo data.\")\n        log.Println(err)\n    }\n}\n</code></pre>\n\n<p>Above code is not able to convert, and it goes inside error if block and prints below, please help.</p>\n\n<pre><code>2018/02/25 22:12:44 Error occurred converting POST input json to myPojo data.\n2018/02/25 22:12:44 invalid character 'I' looking for beginning of value\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 31, "last_activity_date": 1519593813, "creation_date": 1519593813, "answer_id": 48978611, "question_id": 48978414, "link": "https://stackoverflow.com/questions/48978414/golang-strings-builder-type-undefined/48978611#48978611", "title": "golang strings.Builder type undefined", "body": "<p><code>strings.Builder</code> was added in Go 1.10 (released 2018-02-16, 9 days ago at the time of writing). If you are building using an older version of Go, it won't be available.</p>\n"}, {"tags": [], "owner": {"reputation": 17097, "user_id": 672689, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IPnRU.png?s=128&g=1", "display_name": "Roee Gavirel", "link": "https://stackoverflow.com/users/672689/roee-gavirel"}, "is_accepted": false, "score": 2, "last_activity_date": 1541951491, "creation_date": 1541951491, "answer_id": 53250438, "question_id": 48978414, "link": "https://stackoverflow.com/questions/48978414/golang-strings-builder-type-undefined/53250438#53250438", "title": "golang strings.Builder type undefined", "body": "<p>If must working with older Go version, you can use <code>bytes.Buffer</code> instead.</p>\n"}], "owner": {"reputation": 171, "user_id": 3757217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ecbf452e4de02dfe82979ae3e9911f5?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/3757217/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10180, "favorite_count": 1, "accepted_answer_id": 48978611, "answer_count": 2, "score": 16, "last_activity_date": 1541951491, "creation_date": 1519592445, "last_edit_date": 1519593380, "question_id": 48978414, "link": "https://stackoverflow.com/questions/48978414/golang-strings-builder-type-undefined", "title": "golang strings.Builder type undefined", "body": "<p>I was having a problem with the strings.Builder type in GO.</p>\n\n<p>Attempted to run the example code verbatim and GO still responds with:</p>\n\n<blockquote>\n  <p>undefined: strings.Builder</p>\n</blockquote>\n\n<p>Any clues as to what the problem can be, there's been not other problems at all.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n\n    var b strings.Builder\n    for i := 3; i &gt;=1; i-- {\n        fmt.Fprintf(&amp;b, \"%x...\", i)\n    }\n    b.WriteString(\"ignition\")\n    fmt.Println(b.String())\n}\n</code></pre>\n"}, {"tags": ["go", "terminal", "visual-studio-code", "delve"], "comments": [{"owner": {"reputation": 1783, "user_id": 171733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c5a46115322ba7acbb5f7a357d79676?s=128&d=identicon&r=PG", "display_name": "Stuart Thompson", "link": "https://stackoverflow.com/users/171733/stuart-thompson"}, "edited": false, "score": 0, "creation_date": 1523463463, "post_id": 48978393, "comment_id": 86575358, "body": "Were you able to find a solution? I&#39;m running into the exact same scenario."}, {"owner": {"reputation": 1519, "user_id": 1726428, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cd4979ebad11e7266a4348e2ecfb47de?s=128&d=identicon&r=PG", "display_name": "InvisiblePanda", "link": "https://stackoverflow.com/users/1726428/invisiblepanda"}, "reply_to_user": {"reputation": 1783, "user_id": 171733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c5a46115322ba7acbb5f7a357d79676?s=128&d=identicon&r=PG", "display_name": "Stuart Thompson", "link": "https://stackoverflow.com/users/171733/stuart-thompson"}, "edited": false, "score": 1, "creation_date": 1523643837, "post_id": 48978393, "comment_id": 86661743, "body": "@StuartThompson Unfortunately not. I did find an open issue on the termbox-go github though. The developer doesn&#39;t seem to be using delve."}], "owner": {"reputation": 1519, "user_id": 1726428, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cd4979ebad11e7266a4348e2ecfb47de?s=128&d=identicon&r=PG", "display_name": "InvisiblePanda", "link": "https://stackoverflow.com/users/1726428/invisiblepanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1519592301, "creation_date": 1519592301, "question_id": 48978393, "link": "https://stackoverflow.com/questions/48978393/is-debugging-a-termbox-go-using-program-with-vscode-and-delve-possible", "title": "Is debugging a termbox-go using program with VSCode and Delve possible?", "body": "<p>I'm trying to create a console application using <a href=\"https://github.com/nsf/termbox-go/\" rel=\"nofollow noreferrer\">https://github.com/nsf/termbox-go/</a>. As editor, I'm using VSCode with the Go plugin and Delve for debugging.</p>\n\n<p>Now the issue is that when I start debugging, I don't see the termbox output in the integrated console window. But I'm looking for quite a bit now and still couldn't find a way to start the program in an external terminal window yet. Is there one?</p>\n\n<p>Are there alternatives I'm overlooking (maybe a <code>launch.json</code> setting I didn't find)? How can I debug this application that will depend on user input and interaction with VSCode as my editor, if at all possible?</p>\n\n<p>Here is a small example file:</p>\n\n<pre><code>package main\n\nimport \"github.com/nsf/termbox-go\"\n\nfunc main() {\n    initTermbox()\n    defer termbox.Close()\n\n    eventQueue := make(chan termbox.Event)\n    go func() {\n        for {\n            eventQueue &lt;- termbox.PollEvent()\n        }\n    }()\n\n    mainLoop(eventQueue)\n}\n\nfunc mainLoop(eventQueue chan termbox.Event) {\nloop:\n    for {\n        select {\n        case ev := &lt;-eventQueue:\n            if ev.Type == termbox.EventKey &amp;&amp; ev.Key == termbox.KeyEsc {\n                break loop\n            }\n            if ev.Key == termbox.KeyArrowDown {\n                termbox.SetCell(1, 3, 'X', termbox.ColorRed, termbox.ColorDefault)\n                termbox.Flush()\n            }\n        }\n    }\n}\n\nfunc initTermbox() {\n    err := termbox.Init()\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "channels", "routines"], "answers": [{"tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": false, "score": 0, "last_activity_date": 1519590108, "last_edit_date": 1519590108, "creation_date": 1519589801, "answer_id": 48978013, "question_id": 48977835, "link": "https://stackoverflow.com/questions/48977835/how-to-recover-the-input-of-multiple-go-routines-called-in-a-loop/48978013#48978013", "title": "How to recover the input of multiple go routines called in a loop", "body": "<pre><code>c := make(chan result)\n</code></pre>\n\n<p>Creates an unbuffered channel.  Therefore send statements, such as</p>\n\n<pre><code>c &lt;- res\n</code></pre>\n\n<p>cannot proceed until another goroutine is attempting a receive operation.  </p>\n\n<p>In other words, execute the number of receive operations in your main goroutine matching the number of sends that will be attempted from other goroutines.  Like this:</p>\n\n<pre><code>for _, product := range pairs {\n    go getScore(product.Symbol, 1, c)\n}\nfor x := 0; x &lt; len(pairs); x++ {\n    fmt.Println(&lt;-c)\n}\n</code></pre>\n\n<p>See <a href=\"https://tour.golang.org/concurrency/2\" rel=\"nofollow noreferrer\">the Go Tour section on channels</a>, and <a href=\"https://golang.org/doc/effective_go.html#channels\" rel=\"nofollow noreferrer\">the Effective Go section on channels</a> for more information.</p>\n"}, {"tags": [], "owner": {"reputation": 196, "user_id": 9318001, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zqIyjOOecao/AAAAAAAAAAI/AAAAAAAAAv4/QLqiX-BzjTk/photo.jpg?sz=128", "display_name": "alexey_p", "link": "https://stackoverflow.com/users/9318001/alexey-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1519590098, "creation_date": 1519590098, "answer_id": 48978059, "question_id": 48977835, "link": "https://stackoverflow.com/questions/48977835/how-to-recover-the-input-of-multiple-go-routines-called-in-a-loop/48978059#48978059", "title": "How to recover the input of multiple go routines called in a loop", "body": "<p>A channel is a synchronization prototype against a shared memory (in simple point of view). A buffered channel has a length but not a regular channel. Buffered channel is useful in little bit cases but not as a general approaches.</p>\n\n<p>The simplest way to Just add a loop by range of pair or len of pairs:</p>\n\n<pre><code>// start processing\nfor _, product := range pairs {\n    go getScore(product.Symbol, 1, c)\n}\n// getting a result\nfor i:=0; i&lt;len(pairs); i ++ {\n    result := &lt;-c\n    // process a result value\n}\n</code></pre>\n\n<p>Or another way is collecting result in another grouting:</p>\n\n<pre><code>// result and sync variable\nvar (\n   wait sync.WaitGroup\n   result int32\n) \n// start processing\nfor _, product := range pairs {\n    wait.Add(1)\n    go getScore(product.Symbol, 1, c)\n    go func() {\n        defer wait.Done()\n        // simple accumulate or maybe more complicated actions\n        atomic.AddInt32(&amp;result, &lt;-c)\n    }()\n}\n// wait finishing\nwait.Wait()\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 5501816, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-CdXutmncoDg/AAAAAAAAAAI/AAAAAAAAM10/fp51YCvbbSI/photo.jpg?sz=128", "display_name": "Enrique Alcazar", "link": "https://stackoverflow.com/users/5501816/enrique-alcazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519590108, "creation_date": 1519588731, "question_id": 48977835, "link": "https://stackoverflow.com/questions/48977835/how-to-recover-the-input-of-multiple-go-routines-called-in-a-loop", "title": "How to recover the input of multiple go routines called in a loop", "body": "<p>I have a loop throwing multiple go routines, they call a function that makes a http get petition and calculate and object.</p>\n\n<p>I want to recover the result of all those routines.\nI tried using channels, but hey are empty, even if I force wait for all the routines to be done.</p>\n\n<p>This is the code that starts the routines:</p>\n\n<pre><code>func main() {\n    pairs := getPairs() //Returns an array of strings\n    c := make(chan result)\n    for _, product := range pairs {\n        go getScore(product.Symbol, 1, c)\n    }\n    fmt.Println(len(c))\n    time.Sleep(5000 * time.Millisecond)\n    fmt.Println(len(c))\n}\n</code></pre>\n\n<p>And at the end of getScore() I do this, c being the name of the channel in the function and res the result of the function</p>\n\n<pre><code>c &lt;- res\n</code></pre>\n\n<p>The length of the channel is 0 in both prints. </p>\n\n<p>What's the best way to get the result of the functions?</p>\n"}, {"tags": ["http", "go", "http-headers"], "comments": [{"owner": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 1, "creation_date": 1519583499, "post_id": 48976837, "comment_id": 84958833, "body": "Looks like they&#39;re still <a href=\"https://github.com/golang/go/issues/16479\" rel=\"nofollow noreferrer\">discussing this</a>. I&#39;m not sure there&#39;s a good reason, beyond being header methods."}], "answers": [{"tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": false, "score": 1, "last_activity_date": 1519591783, "creation_date": 1519591783, "answer_id": 48978313, "question_id": 48976837, "link": "https://stackoverflow.com/questions/48976837/what-is-an-idiomatic-usage-of-header-write-writesubset/48978313#48978313", "title": "What is an idiomatic usage of header.Write/WriteSubset?", "body": "<p>In general, you would want to export anything that some other package needs to call. Sometimes this can get fairly low-level.</p>\n\n<p><code>Header.WriteSubset()</code> would be useful in writing an HTTP proxy. The HTTP specifications say that certain headers are hop-by-hop headers, so that proxies that receive them must not pass them on to the next hop. By contrast, end-to-end headers are always passed on.</p>\n\n<p>There are probably other uses. <code>httputil.DumpRequest()</code> uses <code>WriteSubset()</code> to exclude some irrelevant headers from its output.</p>\n\n<p>Exporting <code>Header.Write()</code> is less obvious. Though the Go standard library uses it to implement its CGI and FastCGI servers.</p>\n"}], "owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1519591783, "creation_date": 1519582668, "last_edit_date": 1519588094, "question_id": 48976837, "link": "https://stackoverflow.com/questions/48976837/what-is-an-idiomatic-usage-of-header-write-writesubset", "title": "What is an idiomatic usage of header.Write/WriteSubset?", "body": "<p>Go's <code>http.Header</code> has these two methods:</p>\n\n<ul>\n<li><a href=\"https://golang.org/pkg/net/http/#Header.Write\" rel=\"nofollow noreferrer\"><code>Header.Write(io.Writer)</code></a></li>\n<li><a href=\"https://golang.org/pkg/net/http/#Header.WriteSubset\" rel=\"nofollow noreferrer\"><code>Header.WriteSubset(io.Writer, exclude map[string]bool)</code></a></li>\n</ul>\n\n<p>I see that the standard library uses these methods for example when writing request headers, but why are they public/what is a standard use case?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 1, "creation_date": 1519575149, "post_id": 48975412, "comment_id": 84956023, "body": "I could almost swear I tried passing in a buffer before instead of <code>os.Stdout</code>, but it only gave the error message and not the entire stack trace.... nonetheless, thanks this works."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1519647202, "post_id": 48975412, "comment_id": 84981051, "body": "Any idea how to make the string keep its formatting? I want all the <code>\\n</code>&#39;s to stay intact so the email can be formatted, it&#39;s just one big glob of a string in the email, but the stack trace is formatted."}, {"owner": {"reputation": 2960, "user_id": 3521243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EJDD8.jpg?s=128&g=1", "display_name": "Emile Pels", "link": "https://stackoverflow.com/users/3521243/emile-pels"}, "reply_to_user": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1519661243, "post_id": 48975412, "comment_id": 84989942, "body": "@Lansana What&#39;s your email&#39;s content type? If it&#39;s <code>text&#47;html</code>, you should use <code>&lt;br&gt;</code> instead of <code>\\n</code>. If it&#39;s <code>text&#47;plain</code>, <code>\\n</code> should work."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1519679183, "post_id": 48975412, "comment_id": 84999501, "body": "Beautiful, thanks. Mailer was sending <code>text&#47;html</code> by default."}], "tags": [], "owner": {"reputation": 2960, "user_id": 3521243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EJDD8.jpg?s=128&g=1", "display_name": "Emile Pels", "link": "https://stackoverflow.com/users/3521243/emile-pels"}, "is_accepted": true, "score": 1, "last_activity_date": 1519574118, "creation_date": 1519574118, "answer_id": 48975412, "question_id": 48974934, "link": "https://stackoverflow.com/questions/48974934/log-to-stdout-and-get-string-value-of-the-stack-trace/48975412#48975412", "title": "Log to stdout and get string value of the stack trace", "body": "<p><code>withStack</code> doesn't log to stdout: it logs to whatever implementation of <code>io.Writer</code> you provide it with. To easily get a string, consider passing it a <code>bytes.Buffer</code>.</p>\n\n<p>Your <code>Error</code> func could look like this:</p>\n\n<pre><code>func sendErrorMail(s string) error {\n    // Send the stack trace `s` by email\n}\n\nfunc (l *Logger) Error(err error) {\n    // Get the stack trace as a string\n    buf := new(bytes.Buffer)\n    l.withStack(buf, err)\n\n    sendErrorMail(buf.String())\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/T8tkyLCu2Ko\" rel=\"nofollow noreferrer\">Simple demonstration of this idea as a playground</a>.</p>\n"}], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 48975412, "answer_count": 1, "score": 0, "last_activity_date": 1519588083, "creation_date": 1519571101, "last_edit_date": 1519588083, "question_id": 48974934, "link": "https://stackoverflow.com/questions/48974934/log-to-stdout-and-get-string-value-of-the-stack-trace", "title": "Log to stdout and get string value of the stack trace", "body": "<p>I have a logger that logs stack traces to <code>stdout</code>. I want to get the stack trace that was logged into a string value so I can send it as a debug email.</p>\n\n<p>Here is my current code:</p>\n\n<pre><code>func (l *Logger) withStack(writer io.Writer, err error) error {\n    err = errors.WithStack(err)\n    fmt.Fprintf(writer, \"%+v\\n\", err)\n    return err\n}\n\nfunc (l *Logger) Error(err error) error {\n    // Logs stack trace to `stdout`...\n    l.withStack(os.Stdout, err)\n\n    // Here I want to get the string value of what was logged to `stdout`.\n}\n</code></pre>\n\n<p>But if the <code>stdout</code> stack trace looks like this:</p>\n\n<pre><code>foo\ninfrastructure/logger.(*Logger).withStack\n    /Users/lansana/Projects/Go/src/app/src/infrastructure/logger/logger.go:40\ninfrastructure/logger.(*Logger).Error\n    /Users/lansana/Projects/Go/src/app/src/infrastructure/logger/logger.go:50\nmain.main\n    /Users/lansana/Projects/Go/src/app/src/microservices/api/main.go:44\nruntime.main\n    /usr/local/Cellar/go/1.9/libexec/src/runtime/proc.go:185\nruntime.goexit\n    /usr/local/Cellar/go/1.9/libexec/src/runtime/asm_amd64.s:2337\n</code></pre>\n\n<p>...then the result of <code>err.Error()</code> in the email is just <code>foo</code>.</p>\n\n<p>I guess that makes sense, because the error itself only contains <code>foo</code> and not the stack trace itself, but how can I get the exact stack trace as a string value?</p>\n"}, {"tags": ["function", "go", "matrix", "interface"], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 5501816, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-CdXutmncoDg/AAAAAAAAAAI/AAAAAAAAM10/fp51YCvbbSI/photo.jpg?sz=128", "display_name": "Enrique Alcazar", "link": "https://stackoverflow.com/users/5501816/enrique-alcazar"}, "edited": false, "score": 0, "creation_date": 1519563921, "post_id": 48973730, "comment_id": 84952367, "body": "That is correct, thank you very much, can you link any resource that will explain why does it need it?"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "reply_to_user": {"reputation": 321, "user_id": 5501816, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-CdXutmncoDg/AAAAAAAAAAI/AAAAAAAAM10/fp51YCvbbSI/photo.jpg?sz=128", "display_name": "Enrique Alcazar", "link": "https://stackoverflow.com/users/5501816/enrique-alcazar"}, "edited": false, "score": 0, "creation_date": 1519564132, "post_id": 48973730, "comment_id": 84952429, "body": "I don&#39;t think its there any resource about that, but to explain why you need that it&#39;s beacuse interface are reserved words so golang compiler needs to know that you expecting interface type instead of declaring one and you always need to make it by that for example when declaring <code>var someInterface interface{}</code> you also need to initialize with brackets, thats how I understand that"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 321, "user_id": 5501816, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-CdXutmncoDg/AAAAAAAAAAI/AAAAAAAAM10/fp51YCvbbSI/photo.jpg?sz=128", "display_name": "Enrique Alcazar", "link": "https://stackoverflow.com/users/5501816/enrique-alcazar"}, "edited": false, "score": 1, "creation_date": 1519565298, "post_id": 48973730, "comment_id": 84952788, "body": "@EnriqueAlcazar <code>interface</code> without <code>{ ... }</code> is not a type, just as <code>struct</code> without <code>{ ... }</code> is not a type, those are just keywords. In both instances <code>{}</code> means <i>empty</i>, that is: <code>interface{}</code> is an empty interface which means an interface with no methods; and <code>struct{}</code> is an empty struct which means a struct with no fields... Those are valid types, but the keywords themselves are not types."}], "tags": [], "owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "is_accepted": true, "score": 2, "last_activity_date": 1519563807, "creation_date": 1519563807, "answer_id": 48973730, "question_id": 48973663, "link": "https://stackoverflow.com/questions/48973663/go-function-with-matrix-interface-as-parameter/48973730#48973730", "title": "Go function with matrix interface as parameter", "body": "<p>The error comes from <code>func getWall(array [][]interface, wallSize float64){</code> because your parameter need to look like this <code>[][]interface{}</code></p>\n"}], "owner": {"reputation": 321, "user_id": 5501816, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-CdXutmncoDg/AAAAAAAAAAI/AAAAAAAAM10/fp51YCvbbSI/photo.jpg?sz=128", "display_name": "Enrique Alcazar", "link": "https://stackoverflow.com/users/5501816/enrique-alcazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 48973730, "answer_count": 1, "score": -1, "last_activity_date": 1519563807, "creation_date": 1519563330, "question_id": 48973663, "link": "https://stackoverflow.com/questions/48973663/go-function-with-matrix-interface-as-parameter", "title": "Go function with matrix interface as parameter", "body": "<p>I don't know how to use an interface as a parameter for a function, I keep getting a syntax error: </p>\n\n<pre><code>syntax error: unexpected comma, expecting {\n</code></pre>\n\n<p>But it looks the same as any other function:</p>\n\n<pre><code>func getWall(array [][]interface, wallSize float64){\n  var currentWall, highWallPrice float64 = 0, 0;\n  err := false\n  i := 0\n  for highWall &lt; wallSize {\n    if i &gt;= (len(array)) {\n      fmt.Println(\"Not enough offers for pair \" + pair)\n      currentWall = wallSize\n      err = true\n    }else{\n      price = getFloat(array[i][0].(string))\n      amount = getFloat(array[i][1].(string))\n      currentWall = currentWall + price * amount\n       i++\n    }\n  }\n  if !fail {\n    wallPrice = getFloat(array[i][0].(string))\n  }\n  return wallPrice, err\n}\n</code></pre>\n\n<p>I'm starting to learn golang any help is appreciated.</p>\n"}, {"tags": ["http", "go", "viper-go"], "answers": [{"tags": [], "owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "is_accepted": true, "score": 1, "last_activity_date": 1519562874, "creation_date": 1519562874, "answer_id": 48973593, "question_id": 48973336, "link": "https://stackoverflow.com/questions/48973336/go-routine-with-net-http-dynamically-created-using-viper-config/48973593#48973593", "title": "go routine with net/http dynamically created using viper config", "body": "<p>It's probably because your port is changing in loop before it starts the safest way to done it is to pass argument to goroutine and move all of call to <code>h</code> parameter to goroutine. Something like that should work</p>\n\n<pre><code>for _, h := range configuration.Servers {\n        counter = counter + 1\n        log.Println(counter)\n        go func(h ServerConfiguration) {\n            server := http.NewServeMux()\n            server.HandleFunc(\"/\"+h.ProjectName, foo8001)\n            http.ListenAndServe(\":\"+h.Port, server)\n        }(h)\n}\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 8493648, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GW3DKqIwDHk/AAAAAAAAAAI/AAAAAAAAABg/a1pBr2c-PqA/photo.jpg?sz=128", "display_name": "TheeCodeDragon", "link": "https://stackoverflow.com/users/8493648/theecodedragon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 48973593, "answer_count": 1, "score": 0, "last_activity_date": 1519562874, "creation_date": 1519561155, "question_id": 48973336, "link": "https://stackoverflow.com/questions/48973336/go-routine-with-net-http-dynamically-created-using-viper-config", "title": "go routine with net/http dynamically created using viper config", "body": "<p>I have viper providing the following values in config.yml &amp; attached the rest of the configs here:</p>\n\n<pre><code>servers:\n  - projectname: test\n    directory: D:\\playgroud\\test\n    port: 1029\n  - projectname: test1\n    directory: D:\\playground\\test1\n    port: 1030\n</code></pre>\n\n<p>Coniguration.go contains </p>\n\n<pre><code>package config\n\nimport ()\n\ntype Configuration struct {\n    Servers []ServerConfiguration\n}\n\n\n\npackage main\n\n    import (\n        \"config\"\n        \"github.com/spf13/viper\"\n        \"log\"\n        \"net/http\"\n    )\n</code></pre>\n\n<p>Server.go</p>\n\n<pre><code>package config\n\ntype ServerConfiguration struct {\n    ProjectName string\n    Directory string\n    Port string\n}\n</code></pre>\n\n<p>Main.go</p>\n\n<pre><code>    func main() {\n\n        viper.SetConfigName(\"config\")\n        viper.AddConfigPath(\".\")\n        var configuration config.Configuration\n\n        if err := viper.ReadInConfig(); err != nil {\n            log.Fatalf(\"Error reading config file, %s\", err)\n        }\n        err := viper.Unmarshal(&amp;configuration)\n        if err != nil {\n            log.Fatalf(\"unable to decode into struct, %v\", err)\n        }\n        counter := 0\n        finish := make(chan bool)\n        for _, h := range configuration.Servers {\n\n            counter = counter +1\n            log.Println(counter)\n            counter :=  http.NewServeMux()\n            counter.HandleFunc(\"/\"+h.ProjectName, foo8001 )\n            go func() {\n                http.ListenAndServe(\":\"+h.Port, counter)\n            }()\n\n        }\n        &lt;-finish\n    }\n\n    func foo8001(w http.ResponseWriter, r *http.Request) {\n        w.Write([]byte(\"Listening on 8001: foo \"))\n    }\n</code></pre>\n\n<p>But when i run the server i only see one serving at 1030 and 1029 seems like the process has ended.</p>\n\n<p>Here is the output:</p>\n\n<pre><code>2018/02/25 03:53:30 1\n2018/02/25 03:53:30 2\n</code></pre>\n\n<p>What am i doing wrong here, Would appreciate any insight to understand it better, Also would appreciate any thought or advice.</p>\n\n<p>Thanks in Advance!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519557314, "post_id": 48972299, "comment_id": 84950557, "body": "Thanks when using the code you provided it change the format of the message but not as I need, the [info] is missing, how it can be added ?"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519557461, "post_id": 48972299, "comment_id": 84950593, "body": "It prints <code>[2018-02-25 13:16:27] ERROR Starting Process</code> and I need it like <code>[ERROR]:2018-02-25 10:42:20 - Starting Process</code>"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519557594, "post_id": 48972299, "comment_id": 84950631, "body": "That what i said it&#39;s close to yours but if you need exact one you need to change it according to your need. Best way would be coping whole <code>formater.go</code> file and then you can change function which I added to my answer"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519558132, "post_id": 48972299, "comment_id": 84950761, "body": "I try to copy the function to my program after the <code>newlogger</code> function and I got lot of errors, any idea? like unresolved <code>*TextFormatter</code> etc and I import both `\t&quot;github.com/sirupsen/logrus&quot; \t&quot;fmt&quot;  \t&quot;github.com/x-cray/logrus-prefixed-formatter&quot;` any idea?"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519558273, "post_id": 48972299, "comment_id": 84950796, "body": "You can ommit <code>logrus-prefixed-formatter</code> import and only copy whole <code>formater.go</code> file from this lib and put it somewhere in your project, and then replace in that file that function, and use it as new formater in your logrus initialization"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519558450, "post_id": 48972299, "comment_id": 84950846, "body": "Ok 1+, something that I miss if I copy the forammater to my project, how should I use it in my new object logger := &amp;logrus.Logger{  ...."}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519558524, "post_id": 48972299, "comment_id": 84950869, "body": "It should be something like this <code>Formatter: &amp;TextFormatter{</code> if its in the same <code>package</code> directory"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519558769, "post_id": 48972299, "comment_id": 84950936, "body": "I put it in new file in the package of loggers that i&#39;ve and add to it \t&quot;bytes&quot; \t&quot;strings&quot; \t&quot;fmt&quot; \t&quot;github.com/sirupsen/logrus&quot; and got the same errors...did you try it ?"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519558991, "post_id": 48972299, "comment_id": 84950995, "body": "yes, and this works <a href=\"https://gist.github.com/t-tomalak/146e4269460fc63d6938264bb5aaa1db\" rel=\"nofollow noreferrer\">gist.github.com/t-tomalak/146e4269460fc63d6938264bb5aaa1db</a> what kind of error did you get?"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519559420, "post_id": 48972299, "comment_id": 84951096, "body": "To achieve what I need I need to copy all the <code>formatter.go </code>function ? this is crazy, are you sure there is no simple way to do it ?"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519559656, "post_id": 48972299, "comment_id": 84951152, "body": "Why it&#39;s crazy? If u wanna make your own formatter it&#39;s no other way arround then build your own from scratch or like I tell you copy some existing one and change according to your needs. And yeah you only need satisfy simply interface which is <a href=\"https://github.com/sirupsen/logrus/blob/8c0189d9f6bbf301e5d055d34268156b317016af/formatter.go#L17\" rel=\"nofollow noreferrer\">github.com/sirupsen/logrus/blob/&hellip;</a> but then you probably need to make another methods that will be compatible with options like Timestamp format etc."}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519564752, "post_id": 48972299, "comment_id": 84952611, "body": "Im a bit confused :( , Can you provide step by step what should I do to use the formatter ?  thanks!"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519570147, "post_id": 48972299, "comment_id": 84954354, "body": "OK, there is other OS in go that can provide simply what I need ?"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519759781, "post_id": 48972299, "comment_id": 85037906, "body": "@JennyHilton check please if my solutiuon satisfy your needs"}, {"owner": {"reputation": 2111, "user_id": 2159730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QLdPH.jpg?s=128&g=1", "display_name": "Randy Howard", "link": "https://stackoverflow.com/users/2159730/randy-howard"}, "edited": false, "score": 0, "creation_date": 1519844281, "post_id": 48972299, "comment_id": 85078269, "body": "This should have been accepted by now. How far do you have to go?"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519895318, "post_id": 48972299, "comment_id": 85096772, "body": "Thanks, i&#39;ve checked it but there is two issue, 1. There are missing colors 2. the messages are concatenated and the second message is not in the next line ..."}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519940577, "post_id": 48972299, "comment_id": 85123286, "body": "Added option with fork of logrus-prefixed-formatter library @JennyHilton"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1520175034, "post_id": 48972299, "comment_id": 85198260, "body": "@ttomalak - sorry but fork is not an option in our case :( , any other direction /idea?"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1520240480, "post_id": 48972299, "comment_id": 85218304, "body": "@ttomalak - can you assist please ?"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1520241380, "post_id": 48972299, "comment_id": 85218797, "body": "@JennyHilton I gave you all posiblle solution. I don&#39;t understand why u can&#39;t use fork. If there is problem that is my fork you can make your own. Also copying this formater into the project is ideal solution in your situation. Other way would be build own whole logger"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1520247012, "post_id": 48972299, "comment_id": 85222199, "body": "@ttomalak - what do you mean by &quot;opying this formater into the project is ideal solution&quot; which of your suggestion is it ?"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1520265185, "post_id": 48972299, "comment_id": 85233729, "body": "@JennyHilton second one"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1520319324, "post_id": 48972299, "comment_id": 85254733, "body": "@ttomalak sorry for the delay, do you mean Custom formatter or the giant :) gist which you have created?"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1520319695, "post_id": 48972299, "comment_id": 85254889, "body": "can you confirm ?"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1520323526, "post_id": 48972299, "comment_id": 85256653, "body": "@JennyHilton I mean that huge gist which is the copy of logrus-prefixed-formatter with changed output"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1523790197, "post_id": 48972299, "comment_id": 86696929, "body": "@ttomalak - I&#39;ve opend new message with bounty, please see if you can assist <a href=\"https://stackoverflow.com/questions/46511312/golang-template-with-switch-on-objcts\" title=\"golang template with switch on objcts\">stackoverflow.com/questions/46511312/&hellip;</a> thanks"}], "tags": [], "owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "is_accepted": true, "score": 28, "last_activity_date": 1519940501, "last_edit_date": 1519940501, "creation_date": 1519553059, "answer_id": 48972299, "question_id": 48971780, "link": "https://stackoverflow.com/questions/48971780/change-format-of-log-output-logrus/48972299#48972299", "title": "Change format of log output logrus", "body": "<h3>Standard logrus-prefixed-formater usage</h3>\n\n<p>To achieve this you need to make your own <code>TextFormater</code> which will satisfy logrus <code>Formatter</code> interface. Then when you create your own formater you pass it on logrus struct initialization. Other way arround and close to what you wanna achieve is this formater <a href=\"https://github.com/x-cray/logrus-prefixed-formatter\" rel=\"noreferrer\">https://github.com/x-cray/logrus-prefixed-formatter</a> . Based on this formater you can create your own.</p>\n\n<p>In your case you need to use like that</p>\n\n<pre><code>logger := &amp;logrus.Logger{\n        Out:   os.Stderr,\n        Level: logrus.DebugLevel,\n        Formatter: &amp;prefixed.TextFormatter{\n            DisableColors: true,\n            TimestampFormat : \"2006-01-02 15:04:05\",\n            FullTimestamp:true,\n            ForceFormatting: true,\n        },\n    }\n</code></pre>\n\n<hr>\n\n<h3>Customized output of logrus-prefixed-formater</h3>\n\n<p>Link to gist to use copy of <code>logrus-prefixed-formatter</code> with changed format\n<a href=\"https://gist.github.com/t-tomalak/146e4269460fc63d6938264bb5aaa1db\" rel=\"noreferrer\">https://gist.github.com/t-tomalak/146e4269460fc63d6938264bb5aaa1db</a></p>\n\n<p>I leave this option if u in the end wanna use it, as in this version you have exact format you want, coloring, and other features available in standard formatter</p>\n\n<hr>\n\n<h3>Custom formatter</h3>\n\n<p>Third option is to use package create by me <a href=\"https://github.com/t-tomalak/logrus-easy-formatter\" rel=\"noreferrer\">https://github.com/t-tomalak/logrus-easy-formatter</a>. It provide simple option to format output as you want and is it only purpose. I removed not necessary options which probably you wouldn't use. </p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n\n    \"github.com/sirupsen/logrus\"\n    \"github.com/t-tomalak/logrus-easy-formatter\"\n)\n\nfunc main() {\n    logger := &amp;logrus.Logger{\n        Out:   os.Stderr,\n        Level: logrus.DebugLevel,\n        Formatter: &amp;easy.Formatter{\n            TimestampFormat: \"2006-01-02 15:04:05\",\n            LogFormat:       \"[%lvl%]: %time% - %msg%\",\n        },\n    }\n\n    logger.Printf(\"Log message\")\n}\n</code></pre>\n\n<p>This sample code will produce:</p>\n\n<pre><code>[INFO]: 2018-02-27 19:16:55 - Log message\n</code></pre>\n\n<p>Also I wanna point out that if in the future wanna change formatter there shouldn't be any problems to use i.e. default Logrus <code>TextFormatter/JSONFormatter</code>.</p>\n\n<hr>\n\n<h3>Customized output of logrus-prefixed-formater</h3>\n\n<p>If you really don't wanna copy this formatter to your project you can use my fork logrus-prefixed-formater with copy/pasted this code\n<a href=\"https://github.com/t-tomalak/logrus-prefixed-formatter\" rel=\"noreferrer\">https://github.com/t-tomalak/logrus-prefixed-formatter</a></p>\n\n<p>You can use it like standard option but remember to change import to my repository in you go file</p>\n\n<pre><code>logger := &amp;logrus.Logger{\n        Out:   os.Stderr,\n        Level: logrus.DebugLevel,\n        Formatter: &amp;prefixed.TextFormatter{\n            DisableColors: true,\n            TimestampFormat : \"2006-01-02 15:04:05\",\n            FullTimestamp:true,\n            ForceFormatting: true,\n        },\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519723075, "post_id": 49004757, "comment_id": 85014580, "body": "I want to test it and I&#39;ve errors in formatter := format.LogFormat{} \tformatter.TimestampFormat = &quot;2006-01-02 15:04:05&quot;"}, {"owner": {"reputation": 129, "user_id": 6754440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d51bd569624fe650f85a3ec3fdcdd478?s=128&d=identicon&r=PG&f=1", "display_name": "Iceflower S", "link": "https://stackoverflow.com/users/6754440/iceflower-s"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519724257, "post_id": 49004757, "comment_id": 85015294, "body": "Oh, yeah my bad, i had the formatter in an own package, thats why i mixed it up. Should be fixed now."}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519816369, "post_id": 49004757, "comment_id": 85060624, "body": "I use the new logger object like this, can you adopt your code to it please? ` logger := &amp;logrus.Logger{         Out:   os.Stderr,         Level: level,         Formatter: &amp;logrus.TextFormatter{             DisableColors: true,             TimestampFormat : &quot;2006-01-02 15:04:05&quot;,             FullTimestamp:true,          },     }`"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519816727, "post_id": 49004757, "comment_id": 85060842, "body": "Ok, I was able to make it work 1+ ...but the problem is that all the colors and functionality is missing, can you adopt it ?"}, {"owner": {"reputation": 129, "user_id": 6754440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d51bd569624fe650f85a3ec3fdcdd478?s=128&d=identicon&r=PG&f=1", "display_name": "Iceflower S", "link": "https://stackoverflow.com/users/6754440/iceflower-s"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519820946, "post_id": 49004757, "comment_id": 85063392, "body": "<a href=\"https://github.com/x-cray/logrus-prefixed-formatter/blob/master/formatter.go\" rel=\"nofollow noreferrer\">github.com/x-cray/logrus-prefixed-formatter/blob/master/&hellip;</a> You should take a look at this and change the Format function."}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1519895439, "post_id": 49004757, "comment_id": 85096849, "body": "can you assist to achieve the full capabilities ? I just want to change the format message and not change the default provided options... therefore I put bounty for this ... thanks"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1520174547, "post_id": 49004757, "comment_id": 85198116, "body": "HI, any idea how to add the missing functionality ?"}], "tags": [], "owner": {"reputation": 129, "user_id": 6754440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d51bd569624fe650f85a3ec3fdcdd478?s=128&d=identicon&r=PG&f=1", "display_name": "Iceflower S", "link": "https://stackoverflow.com/users/6754440/iceflower-s"}, "is_accepted": false, "score": 4, "last_activity_date": 1519724222, "last_edit_date": 1519724222, "creation_date": 1519722039, "answer_id": 49004757, "question_id": 48971780, "link": "https://stackoverflow.com/questions/48971780/change-format-of-log-output-logrus/49004757#49004757", "title": "Change format of log output logrus", "body": "<p>I adopted this code from <a href=\"https://github.com/x-cray/logrus-prefixed-formatter/blob/master/formatter.go\" rel=\"nofollow noreferrer\">https://github.com/x-cray/logrus-prefixed-formatter/blob/master/formatter.go</a>.\nI created an own formatter struct and implementend an own Format function of the logrus formatter interface.\nI you only need a text output without color, this might be a simple solution.</p>\n\n<pre><code>// adopted from https://github.com/x-cray/logrus-prefixed-formatter/blob/master/formatter.go\npackage main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"strings\"\n\n    \"github.com/sirupsen/logrus\"\n)\n\ntype LogFormat struct {\n    TimestampFormat string\n}\n\nfunc (f *LogFormat) Format(entry *logrus.Entry) ([]byte, error) {\n    var b *bytes.Buffer\n\n    if entry.Buffer != nil {\n        b = entry.Buffer\n    } else {\n        b = &amp;bytes.Buffer{}\n    }\n\n    b.WriteByte('[')\n    b.WriteString(strings.ToUpper(entry.Level.String()))\n    b.WriteString(\"]:\")\n    b.WriteString(entry.Time.Format(f.TimestampFormat))\n\n    if entry.Message != \"\" {\n        b.WriteString(\" - \")\n        b.WriteString(entry.Message)\n    }\n\n    if len(entry.Data) &gt; 0 {\n        b.WriteString(\" || \")\n    }\n    for key, value := range entry.Data {\n        b.WriteString(key)\n        b.WriteByte('=')\n        b.WriteByte('{')\n        fmt.Fprint(b, value)\n        b.WriteString(\"}, \")\n    }\n\n    b.WriteByte('\\n')\n    return b.Bytes(), nil\n}\n\nfunc main() {\n    formatter := LogFormat{}\n    formatter.TimestampFormat = \"2006-01-02 15:04:05\"\n\n    logrus.SetFormatter(&amp;formatter)\n    log.SetOutput(os.Stderr)\n\n    logrus.WithFields(logrus.Fields{\n        \"animal\": \"walrus\",\n        \"size\":   10,\n    }).Info(\"A group of walrus emerges from the ocean\")\n    logrus.Info(\"ugh ugh ugh ugh\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 426, "user_id": 1638582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mU32G.jpg?s=128&g=1", "display_name": "afschr", "link": "https://stackoverflow.com/users/1638582/afschr"}, "is_accepted": false, "score": 0, "last_activity_date": 1541456727, "creation_date": 1541456727, "answer_id": 53163132, "question_id": 48971780, "link": "https://stackoverflow.com/questions/48971780/change-format-of-log-output-logrus/53163132#53163132", "title": "Change format of log output logrus", "body": "<p>As the previous responders said the answer here is to use a custom formatter.\nWhen I was looking for a quick solution with a more human-readable format than default logrus' format, I came up with this formatter:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cn6B1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cn6B1.png\" alt=\"nested logrus formatter\"></a></p>\n\n<p>Code and instructions are there: <a href=\"https://github.com/antonfisher/nested-logrus-formatter\" rel=\"nofollow noreferrer\">https://github.com/antonfisher/nested-logrus-formatter</a></p>\n"}, {"tags": [], "owner": {"reputation": 2088, "user_id": 6695608, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0b62e0f8fc1e5c922623133e2414ce46?s=128&d=identicon&r=PG", "display_name": "Rohit", "link": "https://stackoverflow.com/users/6695608/rohit"}, "is_accepted": false, "score": 2, "last_activity_date": 1557751439, "creation_date": 1557751439, "answer_id": 56112641, "question_id": 48971780, "link": "https://stackoverflow.com/questions/48971780/change-format-of-log-output-logrus/56112641#56112641", "title": "Change format of log output logrus", "body": "<p>I guess I am quite late to this, but recently I was also struggling to get this logging message format customized and I was hoping to get this done preferably in a simpler way. Coming from Python, this wasn't really as straight forward as I though it to be and logrus documentation also isn't very clear on this.</p>\n\n<p>So I had to go through their source code to actually get this done. Here is my code for the same.</p>\n\n<pre><code>type myFormatter struct {\n    log.TextFormatter\n}\n\nfunc (f *myFormatter) Format(entry *log.Entry) ([]byte, error) {\n// this whole mess of dealing with ansi color codes is required if you want the colored output otherwise you will lose colors in the log levels\n    var levelColor int\n    switch entry.Level {\n    case log.DebugLevel, log.TraceLevel:\n        levelColor = 31 // gray\n    case log.WarnLevel:\n        levelColor = 33 // yellow\n    case log.ErrorLevel, log.FatalLevel, log.PanicLevel:\n        levelColor = 31 // red\n    default:\n        levelColor = 36 // blue\n    }\n    return []byte(fmt.Sprintf(\"[%s] - \\x1b[%dm%s\\x1b[0m - %s\\n\", entry.Time.Format(f.TimestampFormat), levelColor, strings.ToUpper(entry.Level.String()), entry.Message)), nil\n}\n\nfunc main() {\n    f, _ := os.OpenFile(\"log.txt\", os.O_CREATE|os.O_WRONLY, 0777)\n    logger := &amp;log.Logger{\n        Out:   io.MultiWriter(os.Stderr, f),\n        Level: log.InfoLevel,\n        Formatter: &amp;myFormatter{log.TextFormatter{\n            FullTimestamp:          true,\n            TimestampFormat:        \"2006-01-02 15:04:05\",\n            ForceColors:            true,\n            DisableLevelTruncation: true,\n        },\n        },\n    }\n    logger.Info(\"Info message\")\n    logger.Warning(\"Warning message\")\n</code></pre>\n\n<p>Here is the output</p>\n\n<pre><code>\u00b1 go run main.go                                                                                                                                                                                                                    &lt;&lt;&lt;\n[2019-05-13 18:10:34] - INFO - Info message\n[2019-05-13 18:10:34] - WARNING - Warning message\n</code></pre>\n\n<p>PS:  I am very new to this, so if you guys there can be a better neat way of doing this, please do share.</p>\n"}], "owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21382, "favorite_count": 5, "accepted_answer_id": 48972299, "answer_count": 4, "score": 17, "last_activity_date": 1557751439, "creation_date": 1519548331, "last_edit_date": 1519822185, "question_id": 48971780, "link": "https://stackoverflow.com/questions/48971780/change-format-of-log-output-logrus", "title": "Change format of log output logrus", "body": "<p>I use go logrus and I need to change the format of the output message,\nI try several of things without success</p>\n\n<p>what I need is format like this with formatter  of logrus </p>\n\n<p><code>[error]: datetime -  message</code>  </p>\n\n<p>What I've tried without success is this</p>\n\n<pre><code> logger := &amp;logrus.Logger{\n        Out:   os.Stderr,\n        Level: level,\n        Formatter: &amp;logrus.TextFormatter{\n            DisableColors: true,\n            TimestampFormat : \"2006-01-02 15:04:05\",\n            FullTimestamp:true,\n\n        },\n    }\n</code></pre>\n\n<p>This produce the following </p>\n\n<pre><code>time=\"2018-02-25 10:42:20\" level=error msg=\"Starting Process\"\n</code></pre>\n\n<p>And I want it to be</p>\n\n<pre><code>[INFO]:2018-02-25 10:42:20 - Starting Process\n</code></pre>\n\n<p><strong>update</strong>\nIn case zap is better to customize \n<a href=\"https://github.com/uber-go/zap\" rel=\"noreferrer\">https://github.com/uber-go/zap</a>\nit could also be a solution </p>\n"}, {"tags": ["go", "exec"], "comments": [{"owner": {"reputation": 17, "user_id": 9407586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tech Desk", "link": "https://stackoverflow.com/users/9407586/tech-desk"}, "edited": false, "score": 0, "creation_date": 1519533810, "post_id": 48970170, "comment_id": 84946019, "body": "Please can anyone help me? I am kinda of stuck!"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1519534191, "post_id": 48970170, "comment_id": 84946079, "body": "Any reason that you&#39;re calling <code>cmd</code> rather than executing the editor directly? Not a Windows guy so maybe I&#39;m missing something obvious but running  shell to run something else tends to be a recipe for a confusing mess of quotes and escaped quotes."}, {"owner": {"reputation": 17, "user_id": 9407586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tech Desk", "link": "https://stackoverflow.com/users/9407586/tech-desk"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1519534498, "post_id": 48970170, "comment_id": 84946132, "body": "If I don&#39;t call in cmd then I cannot run built in commands like &quot;mkdir&quot; &quot;dir&quot; etc.."}, {"owner": {"reputation": 17, "user_id": 9407586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tech Desk", "link": "https://stackoverflow.com/users/9407586/tech-desk"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1519534620, "post_id": 48970170, "comment_id": 84946145, "body": "I am trying to create like my own program that executes system commands! Using the package &quot;bufio&quot; I want to create a reader that takes in user input and executes it. I would like one syntax that would work for all kinds of possibilities! --jrefior-- showed me code that would solve one trouble but not the rest!"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9407586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tech Desk", "link": "https://stackoverflow.com/users/9407586/tech-desk"}, "edited": false, "score": 0, "creation_date": 1519534429, "post_id": 48970311, "comment_id": 84946120, "body": "This Works! Yes! How would I run this command then &quot;mkdir test&quot; and built in cmd commands?. I will appreciate any help!"}, {"owner": {"reputation": 17, "user_id": 9407586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tech Desk", "link": "https://stackoverflow.com/users/9407586/tech-desk"}, "edited": false, "score": 0, "creation_date": 1519534876, "post_id": 48970311, "comment_id": 84946180, "body": "Isn&#39;t there one syntax that will work on all sorts of problem?"}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "reply_to_user": {"reputation": 17, "user_id": 9407586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tech Desk", "link": "https://stackoverflow.com/users/9407586/tech-desk"}, "edited": false, "score": 0, "creation_date": 1519540396, "post_id": 48970311, "comment_id": 84947084, "body": "The os package contains Mkdir and MkdirAll functions <a href=\"https://golang.org/pkg/os/#MkdirAll\" rel=\"nofollow noreferrer\">golang.org/pkg/os/#MkdirAll</a>"}, {"owner": {"reputation": 17, "user_id": 9407586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tech Desk", "link": "https://stackoverflow.com/users/9407586/tech-desk"}, "edited": false, "score": 0, "creation_date": 1519540548, "post_id": 48970311, "comment_id": 84947118, "body": "I appreciate all your efforts! What about tasklist and taskill? I am speaking about all cmd built in commands."}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "reply_to_user": {"reputation": 17, "user_id": 9407586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tech Desk", "link": "https://stackoverflow.com/users/9407586/tech-desk"}, "edited": false, "score": 0, "creation_date": 1519541316, "post_id": 48970311, "comment_id": 84947273, "body": "That&#39;s more complicated.  There&#39;s a lot you can do with Go standard library and other Go packages.  And then there&#39;s windows-specific commands and scripting, which I&#39;m not an expert on and I prefer Linux.  I suggest researching your question and if you can&#39;t find the answer, then ask it as a new question, as it is outside the scope of this question."}, {"owner": {"reputation": 17, "user_id": 9407586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tech Desk", "link": "https://stackoverflow.com/users/9407586/tech-desk"}, "edited": false, "score": 0, "creation_date": 1519542441, "post_id": 48970311, "comment_id": 84947472, "body": "Thanks for your help! I appreciate it!"}], "tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": false, "score": 1, "last_activity_date": 1519534098, "creation_date": 1519534098, "answer_id": 48970311, "question_id": 48970170, "link": "https://stackoverflow.com/questions/48970170/golang-package-exec-issues/48970311#48970311", "title": "golang package exec issues", "body": "<p>You're passing two executables (\"cmd\" and \"...sublime_text.exe\") when you probably only want one.  The <code>exec</code> package doesn't use the shell, so take out all your quotes and escapes.  Pass each argument as a separate argument in exec.Command.</p>\n\n<p>In other words, this:</p>\n\n<pre><code> exe := `C:\\Program Files\\Sublime Text 3\\sublime_text.exe`\n file := `C:\\Users\\User\\Desktop\\Guess.py`\n ExecCMD := exec.Command(exe, file)\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9407586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tech Desk", "link": "https://stackoverflow.com/users/9407586/tech-desk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1519534098, "creation_date": 1519532313, "last_edit_date": 1519533976, "question_id": 48970170, "link": "https://stackoverflow.com/questions/48970170/golang-package-exec-issues", "title": "golang package exec issues", "body": "<p>I am having trouble using the go exec package.</p>\n\n<p>I am receiving this error : </p>\n\n<pre><code>'\\\"C:\\Program Files\\Sublime Text 3\\sublime_text.exe\\\"' is not recognized as an internal or external command,\noperable program or batch file.\n</code></pre>\n\n<p>When I try to run this code in golang on a Windows machine: </p>\n\n<pre><code>package main\n\nimport (\n\"os/exec\"\n\"fmt\"\n)\n\nfunc main() {\n var CMD string = \"\\\"C:\\\\Program Files\\\\Sublime Text 3\\\\sublime_text.exe\\\" C:\\\\Users\\\\User\\\\Desktop\\\\Guess.py\"\n //var CMD string = `\"C:\\Program Files\\Sublime Text 3\\sublime_text.exe\" C:\\Users\\User\\Desktop\\Guess.py`\n ExecCMD := exec.Command(\"cmd\", \"/C\", CMD)\n out, _ := ExecCMD.CombinedOutput()\n fmt.Println(string(out))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/xBqjSMHFu5Z\" rel=\"nofollow noreferrer\">https://play.golang.org/p/xBqjSMHFu5Z</a></p>\n"}, {"tags": ["go", "import", "export", "rsa", "x509"], "comments": [{"owner": {"reputation": 15, "user_id": 6121581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jDBqm.png?s=128&g=1", "display_name": "luguhe", "link": "https://stackoverflow.com/users/6121581/luguhe"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1519560972, "post_id": 48969790, "comment_id": 84951495, "body": "@MichaelHampton line 19: public, err := x509.ParsePKIXPublicKey(pub)"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6121581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jDBqm.png?s=128&g=1", "display_name": "luguhe", "link": "https://stackoverflow.com/users/6121581/luguhe"}, "edited": false, "score": 0, "creation_date": 1519590121, "post_id": 48976405, "comment_id": 84961130, "body": "I love you man! Thank you so much. I was working on this for months (I\u2019m a going to school and this is for a school project)."}, {"owner": {"reputation": 4976, "user_id": 99189, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e85341a6b300fd04dc33b1baa28b7fd8?s=128&d=identicon&r=PG", "display_name": "Jeremy Huiskamp", "link": "https://stackoverflow.com/users/99189/jeremy-huiskamp"}, "reply_to_user": {"reputation": 15, "user_id": 6121581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jDBqm.png?s=128&g=1", "display_name": "luguhe", "link": "https://stackoverflow.com/users/6121581/luguhe"}, "edited": false, "score": 0, "creation_date": 1519631973, "post_id": 48976405, "comment_id": 84972251, "body": "The key to figuring this out was to read the source code. Quite simple once you see the method that constructs the error and compare it to what you\u2019re passing in :-)."}], "tags": [], "owner": {"reputation": 4976, "user_id": 99189, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e85341a6b300fd04dc33b1baa28b7fd8?s=128&d=identicon&r=PG", "display_name": "Jeremy Huiskamp", "link": "https://stackoverflow.com/users/99189/jeremy-huiskamp"}, "is_accepted": true, "score": 1, "last_activity_date": 1519585176, "last_edit_date": 1519585176, "creation_date": 1519579934, "answer_id": 48976405, "question_id": 48969790, "link": "https://stackoverflow.com/questions/48969790/rsa-key-export-and-import/48976405#48976405", "title": "RSA Key Export and Import", "body": "<p>When I run this, I get the panic on <code>MarshalPKIXPublicKey</code> (not <code>ParsePKIXPublicKey</code> as you were suggesting in comment above).</p>\n\n<p>The problem is that the function accepts a <code>*rsa.PublicKey</code> and you're passing a plain <code>rsa.PublicKey</code>.</p>\n\n<p>This works for me: <code>pub, err := x509.MarshalPKIXPublicKey(&amp;key.PublicKey)</code>.</p>\n"}], "owner": {"reputation": 15, "user_id": 6121581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jDBqm.png?s=128&g=1", "display_name": "luguhe", "link": "https://stackoverflow.com/users/6121581/luguhe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "accepted_answer_id": 48976405, "answer_count": 1, "score": 0, "last_activity_date": 1519588193, "creation_date": 1519527483, "last_edit_date": 1519588193, "question_id": 48969790, "link": "https://stackoverflow.com/questions/48969790/rsa-key-export-and-import", "title": "RSA Key Export and Import", "body": "<p>I'm currently trying to export my created keys and than importing them to use them.</p>\n\n<p>But if I run my code I get the following error:</p>\n\n<pre><code>panic: x509: only RSA and ECDSA public keys supported\n\ngoroutine 1 [running]:\nmain.main()\n    /path/to/project/src/main.go:19 +0x3bd\n</code></pre>\n\n<p>This is my current code:</p>\n\n<pre><code>// Create key\nkey, _ := rsa.GenerateKey(rand.Reader, 2048)\n\n// Message to encrypt\nmessage := \"hi stackoverflow\"\n\npriv := x509.MarshalPKCS1PrivateKey(key)\npub, err := x509.MarshalPKIXPublicKey(key.PublicKey)\nif err != nil {\n    panic(err)\n}\n\nprivate, err := x509.ParsePKCS1PrivateKey(priv)\nif err != nil {\n    panic(err)\n    return\n}\n\npublic, err := x509.ParsePKIXPublicKey(pub)\nif err != nil {\n    return\n}\n\nencrypted, err := rsa.EncryptPKCS1v15(rand.Reader, public.(*rsa.PublicKey), []byte(message))\nif err != nil {\n    panic(err)\n}\ndencrypted, err := rsa.DecryptPKCS1v15(rand.Reader, private, encrypted)\nif err != nil {\n    panic(err)\n}\nfmt.Println(string(dencrypted))\n</code></pre>\n\n<p>(I researched like the hole internet but didn't found something, maybe I used a wrong search term.)</p>\n"}, {"tags": ["string", "go", "escaping"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1519525898, "post_id": 48969683, "comment_id": 84944828, "body": "You can escape quote characters or use backticks <code>`</code> for string literals"}, {"owner": {"reputation": 17, "user_id": 9407586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tech Desk", "link": "https://stackoverflow.com/users/9407586/tech-desk"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1519526346, "post_id": 48969683, "comment_id": 84944907, "body": "Please can you show me an example since I am new to golang? I understand the backticks. An example for escape quote characters would be appreciated!"}, {"owner": {"reputation": 17, "user_id": 9407586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tech Desk", "link": "https://stackoverflow.com/users/9407586/tech-desk"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1519526854, "post_id": 48969683, "comment_id": 84944971, "body": "Escaping quote char not working... <a href=\"https://play.golang.org/p/b_MwzoR2gR5\" rel=\"nofollow noreferrer\">play.golang.org/p/b_MwzoR2gR5</a>"}, {"owner": {"reputation": 6967, "user_id": 7803650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WH7uu.png?s=128&g=1", "display_name": "Oswin Noetzelmann", "link": "https://stackoverflow.com/users/7803650/oswin-noetzelmann"}, "edited": false, "score": 0, "creation_date": 1519527255, "post_id": 48969683, "comment_id": 84945045, "body": "Here is the correctly escaped version <a href=\"https://play.golang.org/p/CMS78oWTyet\" rel=\"nofollow noreferrer\">play.golang.org/p/CMS78oWTyet</a>"}, {"owner": {"reputation": 17, "user_id": 9407586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tech Desk", "link": "https://stackoverflow.com/users/9407586/tech-desk"}, "edited": false, "score": 0, "creation_date": 1519528359, "post_id": 48969683, "comment_id": 84945181, "body": "Thanks Oswin! I really appreciate it!"}], "answers": [{"tags": [], "owner": {"reputation": 6967, "user_id": 7803650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WH7uu.png?s=128&g=1", "display_name": "Oswin Noetzelmann", "link": "https://stackoverflow.com/users/7803650/oswin-noetzelmann"}, "is_accepted": false, "score": 7, "last_activity_date": 1519528563, "last_edit_date": 1519528563, "creation_date": 1519528061, "answer_id": 48969838, "question_id": 48969683, "link": "https://stackoverflow.com/questions/48969683/create-a-string-in-golang-with-characters-that-require-escaping/48969838#48969838", "title": "Create a string in golang with characters that require escaping", "body": "<p>In your example string you have characters that need escaping: <code>\"</code> and <code>\\</code></p>\n\n<pre><code>fmt.Println(\"\\\"C:\\\\Program Files\\\\Sublime Text 3\\\\sublime_text.exe\\\" C:\\\\Users\\\\User\\\\Desktop\\\\Guess.py\") \n</code></pre>\n\n<p>You can also use back quotes to create what is called a raw string which doesn't require escaping those characters. </p>\n\n<pre><code>fmt.Println(`\"C:\\Program Files\\Sublime Text 3\\sublime_text.exe\" C:\\Users\\User\\Desktop\\Guess.py`) \n</code></pre>\n\n<p>List of escapes:</p>\n\n<blockquote>\n<pre><code>\\a   U+0007 alert or bell\n\\b   U+0008 backspace\n\\f   U+000C form feed\n\\n   U+000A line feed or newline\n\\r   U+000D carriage return\n\\t   U+0009 horizontal tab\n\\v   U+000b vertical tab\n\\\\   U+005c backslash\n\\'   U+0027 single quote  (valid escape only within rune literals)\n\\\"   U+0022 double quote  (valid escape only within string literals)\n</code></pre>\n</blockquote>\n\n<p>See the <a href=\"https://golang.org/ref/spec#Rune_literals\" rel=\"noreferrer\">official docs.</a></p>\n"}], "owner": {"reputation": 17, "user_id": 9407586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tech Desk", "link": "https://stackoverflow.com/users/9407586/tech-desk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3835, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519528563, "creation_date": 1519525785, "last_edit_date": 1519528229, "question_id": 48969683, "link": "https://stackoverflow.com/questions/48969683/create-a-string-in-golang-with-characters-that-require-escaping", "title": "Create a string in golang with characters that require escaping", "body": "<p>I am trying to make a string variable containing :</p>\n\n<p>\"C:\\Program Files\\Sublime Text 3\\sublime_text.exe\" C:\\Users\\User\\Desktop\\Guess.py</p>\n\n<p>Unfortunately I am not succeeding in doing so. Is there a way to put the text about as is into a variable, double quotes and all?</p>\n"}, {"tags": ["loops", "pointers", "go", "null", "slice"], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 7, "last_activity_date": 1519510872, "creation_date": 1519510872, "answer_id": 48968226, "question_id": 48968177, "link": "https://stackoverflow.com/questions/48968177/pointers-became-nil-after-leaving-the-loop/48968226#48968226", "title": "pointers became nil after leaving the loop", "body": "<p>You create a list of 100 pointers, all are nil, then append to it <strong>at position 101</strong>. you print the last element, and it's indeed not nil - but it's also not the first one. It's 101, 102, ... and so on. Then you print the first two elements and they are indeed nil. You basically appended a bunch of pointers to a list of 100 nils. </p>\n\n<p>Just change the first line to:</p>\n\n<pre><code>candles := make([]*base.OHLCVItem, 0, 100)\n</code></pre>\n\n<p>Which will create an empty slice, but with a capacity of 100. </p>\n"}], "owner": {"reputation": 35, "user_id": 7438086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cd12c06f35c70659f4c95bdaecfd83e?s=128&d=identicon&r=PG&f=1", "display_name": "Vitaliy Franchook", "link": "https://stackoverflow.com/users/7438086/vitaliy-franchook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 48968226, "answer_count": 1, "score": 3, "last_activity_date": 1519510903, "creation_date": 1519510513, "question_id": 48968177, "link": "https://stackoverflow.com/questions/48968177/pointers-became-nil-after-leaving-the-loop", "title": "pointers became nil after leaving the loop", "body": "<p>Here is a peace of my code:</p>\n\n<pre><code>candles := make([]*base.OHLCVItem, 100)\n\nfor i, item := range msgStrSl {\n    newCandle, err := parseCandleFromString(item)\n    newCandle.Pair = pair\n    newCandle.Timeframe = timeframe\n\n    if err != nil {\n        bWsLog.WithError(err).Errorf(\"Failed to parse candle %d.\", i)\n        continue\n    }\n\n    if newCandle == nil {\n        panic(\"nil candle\")\n    }\n\n    candles = append(candles, newCandle)\n\n    bWsLog.Infof(\"Sn candle: %d\", candles[len(candles)-1].Timestamp)\n}\n\nbWsLog.Info(candles[0])\nbWsLog.Info(candles[1])\nsort.SliceStable(candles, func(i, j int) bool {\n    bWsLog.Infof(\"%d %+v %+v\", len(candles), candles[i], candles[j])\n    return candles[i].Timestamp &lt; candles[j].Timestamp\n}\n</code></pre>\n\n<p>Logs after the loop say that value is nil.\nBut log inside the loop prints the object (so it is not a nil at that point)\nI'm new to Go and I can figure out why all the elements in slice became nil after the loop finishes.\nCould you help me with this issue please?</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1519505452, "post_id": 48967382, "comment_id": 84940536, "body": "This seems like a good place to use an interface. Yes, you would have a separate type for each animal. If you want to keep your current implementation, you can write a test that ensures that <code>activity</code> is defined for each animal. (You then have to make sure to run the test, of course.) See <a href=\"https://golang.org/pkg/testing\" rel=\"nofollow noreferrer\">golang.org/pkg/testing</a>,"}], "answers": [{"comments": [{"owner": {"reputation": 4670, "user_id": 1204312, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/27761f40eab7ee7ee015ccd60ad2ab88?s=128&d=identicon&r=PG", "display_name": "shriek", "link": "https://stackoverflow.com/users/1204312/shriek"}, "edited": false, "score": 0, "creation_date": 1519515686, "post_id": 48967513, "comment_id": 84943096, "body": "The second way isn&#39;t that bad actually even though it&#39;s can&#39;t be statically checked. Thank you for confirming my doubt."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1519506101, "last_edit_date": 1519506101, "creation_date": 1519505716, "answer_id": 48967513, "question_id": 48967382, "link": "https://stackoverflow.com/questions/48967382/how-do-i-ensure-a-field-is-defined-in-struct/48967513#48967513", "title": "How do I ensure a field is defined in struct?", "body": "<p>The only way to statically ensure that the function is set for each value is to use methods and an interface.  This requires a type for each kind of animal as you noted.  </p>\n\n<p>One approach to ensure that function is set a runtime is to use a factory function for creating animal values. This function can check that activity is not nil.</p>\n\n<pre><code>func newAnimal(name string, activity func()) animal {\n   if activity == nil {\n      panic(\"missing activity for \" + name)\n   }\n   return animal{name, activity}\n}\n\nvar elephant = newAnimal(\"elephant\", func() {\n    fmt.Println(\"Eat grass\")\n    fmt.Println(\"Stampede\")\n})\n\nvar lemur = newAnimal(\"lemur\", func() {\n    fmt.Println(\"Eat fruits\")\n    fmt.Println(\"Climb trees\")\n})\n</code></pre>\n\n<p>A variation is to build the zoo using function calls:</p>\n\n<pre><code>type zoo []animal\n\nfunc addAnimal(name string, activity func()) {\n   if activity == nil {\n      panic(\"missing activity for \" + name)\n   }\n   zoo = append(zoo, animal{name, activity})\n}\n\nfunc init() {\n  addAnimal(\"elephant\", func() {\n    fmt.Println(\"Eat grass\")\n    fmt.Println(\"Stampede\")\n  })\n  addAnimal(\"lemur\", func() {\n    fmt.Println(\"Eat fruits\")\n    fmt.Println(\"Climb trees\")\n  })\n}\n</code></pre>\n"}], "owner": {"reputation": 4670, "user_id": 1204312, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/27761f40eab7ee7ee015ccd60ad2ab88?s=128&d=identicon&r=PG", "display_name": "shriek", "link": "https://stackoverflow.com/users/1204312/shriek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 48967513, "answer_count": 1, "score": -1, "last_activity_date": 1519506101, "creation_date": 1519504823, "question_id": 48967382, "link": "https://stackoverflow.com/questions/48967382/how-do-i-ensure-a-field-is-defined-in-struct", "title": "How do I ensure a field is defined in struct?", "body": "<p>This might be a bit silly and I apologize if it is but how do I guarantee that a field is defined in a struct before I can use it?</p>\n\n<p>Let me explain this with example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype animal struct {\n    name     string\n    activity func()\n}\n\nvar elephant = animal{\n    name: \"elephant\",\n    activity: func() {\n        fmt.Println(\"Eat grass\")\n        fmt.Println(\"Stampede\")\n    },\n}\n\nvar lemur = animal{\n    name: \"lemur\",\n    activity: func() {\n        fmt.Println(\"Eat fruits\")\n        fmt.Println(\"Climb trees\")\n    },\n}\n\nfunc main() {\n    zoo := []animal{\n        elephant,\n        lemur,\n        // more goes here\n    }\n\n    for _, cage := range zoo {\n        cage.activity()\n    }\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/0nXNk0DMuVd\" rel=\"nofollow noreferrer\">https://play.golang.org/p/0nXNk0DMuVd</a></p>\n\n<p>Let's say there can be more <code>animal</code> structs in <code>zoo</code> array. Is there a better way to make sure that every animal must define <code>activity</code> function other than doing the following:</p>\n\n<pre><code>for _, cage := range zoo {\n    if cage.activity != nil {\n      cage.activity()\n    }\n}\n</code></pre>\n\n<p>Using <code>method</code> doesn't look feasible here as implementation of <code>activity</code> is quite different for each animal. I was also thinking of using <code>interface</code> but then wouldn't I have to create a type of every animal?<br>\nThe reason I'm not happy with the above <code>if</code> solution is that the check is done in runtime only. However, if that's the only way to approach this problem then I'm okay with that too. </p>\n"}, {"tags": ["go", "interface", "switch-statement"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 7, "last_activity_date": 1519504287, "creation_date": 1519504287, "answer_id": 48967307, "question_id": 48967199, "link": "https://stackoverflow.com/questions/48967199/impossible-type-switch-case-cannot-have-dynamic-type/48967307#48967307", "title": "impossible type switch case: cannot have dynamic type", "body": "<p>The error message is saying that a dto.Responder value cannot contain a dto.CapacityResponse because dto.CapacityResponse is missing one of the dto.Responder methods (GetError).</p>\n\n<p>The pointer type implements the interface. Change the case to:</p>\n\n<pre><code> case *dto.CapacityResponse:\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "is_accepted": false, "score": 3, "last_activity_date": 1519504453, "creation_date": 1519504453, "answer_id": 48967332, "question_id": 48967199, "link": "https://stackoverflow.com/questions/48967199/impossible-type-switch-case-cannot-have-dynamic-type/48967332#48967332", "title": "impossible type switch case: cannot have dynamic type", "body": "<p>You have this error because <code>dto.CapacityResponse</code> type is different from <code>*dto.CapacityResponse</code> type.<br>\nBecause you are using local variable <code>r</code> of interface type <code>dto.Responder</code> the only concrete types you can use in <code>case</code> statements are those that implement this interface and <code>dto.CapacityResponse</code> isn't one of them, because it is not a pointer type and you have declared receivers as pointers for <code>dto.CapacityResponse</code>. Please take a look on <a href=\"https://play.golang.org/p/1K2Rkl7Hxsb\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2186, "favorite_count": 0, "accepted_answer_id": 48967307, "answer_count": 2, "score": 4, "last_activity_date": 1519504453, "creation_date": 1519503633, "question_id": 48967199, "link": "https://stackoverflow.com/questions/48967199/impossible-type-switch-case-cannot-have-dynamic-type", "title": "impossible type switch case: cannot have dynamic type", "body": "<p>Have following struct:</p>\n\n<pre><code>package dto\n\ntype CapacityResponse struct{\n    Val int\n    Err error\n    TransactionID string\n}\n\nfunc (r *CapacityResponse) GetError() (error) {\n    return r.Err\n}\n\nfunc (r *CapacityResponse) SetError(err error)  {\n    r.Err = err\n}\n\nfunc (r *CapacityResponse) Read() interface{}  {\n    return r.Val\n}\n\nfunc (r *CapacityResponse) GetTransactionId() string  {\n    return r.TransactionID\n}\n</code></pre>\n\n<p>It's interface:</p>\n\n<pre><code>package dto\n\ntype Responder interface {\n    Read() (interface{})\n    GetError() (error)\n    SetError(error)\n    GetTransactionId() (string)\n}\n</code></pre>\n\n<p>And following logic:</p>\n\n<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n    cr := request2CacheRequest(r)\n    responseChan := make(chan dto.Responder)\n\n    go func() {\n        responder := processReq(cr)\n        responseChan &lt;- responder\n    }()\n\n    go func() {\n        for r := range responseChan {\n            if (r.GetTransactionId() == cr.TransactionID) {\n                switch r.(type) {\n                //case dto.KeysResponse:\n                //case dto.GetResponse:\n                //case dto.RemoveResponse:\n                //case dto.SetResponse:\n                case dto.CapacityResponse:\n                    if i, ok := r.Read().(int); ok {\n                        fmt.Fprintf(w, fmt.Sprintf(\"{'capasity': %d, 'err': %s}\", i, r.GetError()))\n                    }\n\n                }\n            }\n        }\n    }()\n}\n</code></pre>\n\n<p>I am getting exception:</p>\n\n<pre><code>impossible type switch case: r (type dto.Responder) cannot have dynamic type dto.CapacityResponse (missing GetError method)\n</code></pre>\n\n<p>Could you, please, help me to understand what is wrong here?</p>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1519496775, "post_id": 48966192, "comment_id": 84938019, "body": "Pro tip: Use gofmt for readable code."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1519496868, "post_id": 48966192, "comment_id": 84938048, "body": "It would also help to include the entire error message. When a type doesn&#39;t satisfy an interface, the error usually tells why."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1519496993, "post_id": 48966192, "comment_id": 84938099, "body": "The read method is different."}, {"owner": {"reputation": 196, "user_id": 9318001, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zqIyjOOecao/AAAAAAAAAAI/AAAAAAAAAv4/QLqiX-BzjTk/photo.jpg?sz=128", "display_name": "alexey_p", "link": "https://stackoverflow.com/users/9318001/alexey-p"}, "edited": false, "score": 1, "creation_date": 1519498069, "post_id": 48966192, "comment_id": 84938440, "body": "func (r *CapacityResponse) read() int32 should same interface definition: read() interface{} , interface{} but not as int32"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1519499133, "post_id": 48966192, "comment_id": 84938737, "body": "yes read method has interface{} as return type not int32"}], "answers": [{"tags": [], "owner": {"reputation": 2476, "user_id": 5788720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tkE-8jM--HE/AAAAAAAAAAI/AAAAAAAAAEw/g51C7_m9JWU/photo.jpg?sz=128", "display_name": "Iain Duncan", "link": "https://stackoverflow.com/users/5788720/iain-duncan"}, "is_accepted": true, "score": 1, "last_activity_date": 1519500147, "creation_date": 1519500147, "answer_id": 48966706, "question_id": 48966192, "link": "https://stackoverflow.com/questions/48966192/implementation-doesnt-match-interface/48966706#48966706", "title": "Implementation doesn&#39;t match interface", "body": "<p>In the interface the <code>read</code> method returns an <code>interface{}</code> whereas the CapacityResponse returns an <code>int32</code>.  Go's interface matching is done strictly on the signature of the function and does not take into consideration that an <code>int32</code> does implement the <code>interface{}</code>.  You can work around this by having two methods:</p>\n\n<pre><code>// This does the work\nfunc (r *CapacityResponse) readInt32() int32  {\n    return r.val\n}\n// This implements the interface signature\nfunc (r *CapacityResponse) read() interface{} {\n    // No type assertion necessary as int32 is an interface{}\n    return r.readInt32()\n}\n</code></pre>\n\n<p>There was a proposal to do what you wanted to a while ago but it got closed due to it's complexity and issues with the semantics which you can read about here:</p>\n\n<p><a href=\"https://github.com/golang/go/issues/12754\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/12754</a></p>\n"}], "owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 48966706, "answer_count": 1, "score": -4, "last_activity_date": 1519500147, "creation_date": 1519496639, "last_edit_date": 1519496755, "question_id": 48966192, "link": "https://stackoverflow.com/questions/48966192/implementation-doesnt-match-interface", "title": "Implementation doesn&#39;t match interface", "body": "<p>I have an interface:</p>\n\n<pre><code>type Responder interface{\n    read()(interface{})\n    getError()(error)\n    setError(error)\n    getTransactionId()(string)\n}\n</code></pre>\n\n<p>And implementation:</p>\n\n<pre><code>type CapacityResponse struct{\n    val int32\n    err error\n    transactionId string\n}\n\nfunc (r *CapacityResponse) getError() error {\n    return r.err\n}\n\nfunc (r *CapacityResponse) setError(err error)  {\n    r.err = err\n}\n\nfunc (r *CapacityResponse) read() int32  {\n    return r.val\n}\n\nfunc (r *CapacityResponse) getTransactionId() string  {\n    return r.transactionId\n}\n</code></pre>\n\n<p>But seems <code>CapacityResponse</code> doesn't implement <code>Responder</code> interface. What is mismatched here?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "edited": false, "score": 0, "creation_date": 1519543991, "post_id": 48965097, "comment_id": 84947744, "body": "How important is the GOARCG=amd64 in the build process?"}, {"owner": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "edited": false, "score": 0, "creation_date": 1519545729, "post_id": 48965097, "comment_id": 84948117, "body": "Hi there, I love hello! GOOS=linux and chmode 755 did the trick. Thank you!"}, {"owner": {"reputation": 279, "user_id": 4965457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e688c6ad1efdac07f307d0767a5d9ab?s=128&d=identicon&r=PG", "display_name": "alexandrevilain", "link": "https://stackoverflow.com/users/4965457/alexandrevilain"}, "reply_to_user": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "edited": false, "score": 0, "creation_date": 1519580443, "post_id": 48965097, "comment_id": 84957878, "body": "Hi, GOARCH is for the architecture of your computer. For instance you can set GOARCH=amd64 in order to compile for an x64 computer.  I&#39;m glad to see that it solves your problem."}], "tags": [], "owner": {"reputation": 279, "user_id": 4965457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e688c6ad1efdac07f307d0767a5d9ab?s=128&d=identicon&r=PG", "display_name": "alexandrevilain", "link": "https://stackoverflow.com/users/4965457/alexandrevilain"}, "is_accepted": true, "score": 4, "last_activity_date": 1519491020, "last_edit_date": 1519491020, "creation_date": 1519490269, "answer_id": 48965097, "question_id": 48965040, "link": "https://stackoverflow.com/questions/48965040/start-golang-on-the-server/48965097#48965097", "title": "Start golang on the server", "body": "<p>I think that you'll need to use cross-compiling.</p>\n\n<p>When you launch <code>go build -o hello .</code> on the mac, it's building a binary for you Mac. </p>\n\n<p>But for running it on linux, you need to use cross-compilation: <code>GOOS=linux go build -o hello .</code>. It will build the binary for your server.</p>\n\n<p>You can read this article from Dave Cheney: <a href=\"https://dave.cheney.net/2015/08/22/cross-compilation-with-go-1-5\" rel=\"nofollow noreferrer\">https://dave.cheney.net/2015/08/22/cross-compilation-with-go-1-5</a> </p>\n"}, {"tags": [], "owner": {"reputation": 698, "user_id": 2656413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74d01ca2fb0a9c99ee5a2981b3780bc8?s=128&d=identicon&r=PG", "display_name": "grandchild", "link": "https://stackoverflow.com/users/2656413/grandchild"}, "is_accepted": false, "score": 1, "last_activity_date": 1519492111, "creation_date": 1519492111, "answer_id": 48965412, "question_id": 48965040, "link": "https://stackoverflow.com/questions/48965040/start-golang-on-the-server/48965412#48965412", "title": "Start golang on the server", "body": "<p><code>Permission denied</code> usually points to a missing executable permission on the file.</p>\n\n<p>The hello binary should have <code>755</code> or <code>700</code> on it (the former making it executable for everyone, the latter only for your user).</p>\n\n<p>Run</p>\n\n<pre><code>chmod 755 ~/go/hello\n</code></pre>\n\n<p>or alternatively</p>\n\n<pre><code>chmod -R +x ~/go\n</code></pre>\n\n<p>The first sets explicit permission bits on just the server executable file, the second adds just the executable permission bit on the whole directory, as well as all contained files (and subdirectories). (Directories usually also have the <code>x</code>-Bit set, otherwise you wouldn't be able to list it's contents)</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9406536"}, "is_accepted": false, "score": 2, "last_activity_date": 1519497068, "creation_date": 1519497068, "answer_id": 48966262, "question_id": 48965040, "link": "https://stackoverflow.com/questions/48965040/start-golang-on-the-server/48966262#48966262", "title": "Start golang on the server", "body": "<p>Go to folder where your code located, and type in terminal <code>GOOS=linux GOARCG=amd64 go build</code> after it golang wiil create file for you, upload it on server and type <code>chmod +x your_file_name</code> after it run it using <code>./your_file_name</code></p>\n"}], "owner": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 2, "accepted_answer_id": 48965097, "answer_count": 3, "score": 1, "last_activity_date": 1519497068, "creation_date": 1519489913, "last_edit_date": 1519496082, "question_id": 48965040, "link": "https://stackoverflow.com/questions/48965040/start-golang-on-the-server", "title": "Start golang on the server", "body": "<p>I created a tiny Go program on my computer:</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"log\"\n\"net/http\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hi there, I love %s!\", r.URL.Path[1:])\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n\n<p>Using the Terminal on Mac:</p>\n\n<pre><code>$ cd $HOME/go/src/hello\n$ ./hello\n</code></pre>\n\n<p>The server is starting. And using Safari:</p>\n\n<pre><code>http://localhost:8080/hello\n</code></pre>\n\n<p>I get \"Hi there, I love hello!\"</p>\n\n<p>So far so good. But my challenge is to put this binary on the server and run the same.</p>\n\n<p><strong>On the server</strong></p>\n\n<p>Debian 8 using webmin creating a folder in root Go and put the binary in this folder</p>\n\n<pre><code>[root@server ~]# cd /go/\n[root@server go]# ./hello\nsh: 1: ./hello: Permission denied\n[root@server go]# \n</code></pre>\n\n<p>The permissions for the Go folder and hello binary are 0644. AFAIK, the same as most files.</p>\n\n<p>How do I deploy the Golang to the server and start the golang on the server? Lots of documentations on previous step, but I found none on the server side.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 1, "creation_date": 1519492779, "post_id": 48965012, "comment_id": 84936814, "body": "That&#39;s not an awfully roundabout way to go about it. That <i>is</i> the straightforward time-honored way to go about it."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1519494278, "post_id": 48965012, "comment_id": 84937271, "body": "My only suggestion is not to use base64. That will just bloat your binary. Use hex literals. This will make your source code larger, but who cares, since it&#39;s generated sources you shouldn&#39;t be reading anyway. And then the compiled version will be smaller, as well as faster to execute (as no base64-decoding will be necessary)."}, {"owner": {"reputation": 4565, "user_id": 206479, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/72562d2e1fb45be3e000db0b5a81dc59?s=128&d=identicon&r=PG", "display_name": "carillonator", "link": "https://stackoverflow.com/users/206479/carillonator"}, "edited": false, "score": 0, "creation_date": 1519569246, "post_id": 48965012, "comment_id": 84954065, "body": "it may be time-honored and the best option, but it is definitely not straightforward. The part that bothers me the most is that though gobs are &quot;self-describing,&quot; the receiving types still need to be defined, so I will have to maintain two separate copies. I suppose I could symlink across packages."}, {"owner": {"reputation": 4976, "user_id": 99189, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e85341a6b300fd04dc33b1baa28b7fd8?s=128&d=identicon&r=PG", "display_name": "Jeremy Huiskamp", "link": "https://stackoverflow.com/users/99189/jeremy-huiskamp"}, "edited": false, "score": 0, "creation_date": 1519580560, "post_id": 48965012, "comment_id": 84957914, "body": "I don&#39;t think the time-honored way includes gobbing.  If you do that, you may as well just embed the original csv as a string in the source code.  The common thing to do would be to just generate struct literals."}, {"owner": {"reputation": 4565, "user_id": 206479, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/72562d2e1fb45be3e000db0b5a81dc59?s=128&d=identicon&r=PG", "display_name": "carillonator", "link": "https://stackoverflow.com/users/206479/carillonator"}, "edited": false, "score": 0, "creation_date": 1519585644, "post_id": 48965012, "comment_id": 84959624, "body": "The csv requires some processing, and it rarely changes, so no sense in having to do that on every run when you can do it once (at least in this case)."}, {"owner": {"reputation": 4976, "user_id": 99189, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e85341a6b300fd04dc33b1baa28b7fd8?s=128&d=identicon&r=PG", "display_name": "Jeremy Huiskamp", "link": "https://stackoverflow.com/users/99189/jeremy-huiskamp"}, "edited": false, "score": 0, "creation_date": 1519937975, "post_id": 48965012, "comment_id": 85122019, "body": "Can you not just represent the processed data as struct literals in go source code?"}, {"owner": {"reputation": 4565, "user_id": 206479, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/72562d2e1fb45be3e000db0b5a81dc59?s=128&d=identicon&r=PG", "display_name": "carillonator", "link": "https://stackoverflow.com/users/206479/carillonator"}, "edited": false, "score": 0, "creation_date": 1521807699, "post_id": 48965012, "comment_id": 85900960, "body": "not really: there are several layers of struct values being other structs"}], "answers": [{"comments": [{"owner": {"reputation": 4565, "user_id": 206479, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/72562d2e1fb45be3e000db0b5a81dc59?s=128&d=identicon&r=PG", "display_name": "carillonator", "link": "https://stackoverflow.com/users/206479/carillonator"}, "edited": false, "score": 0, "creation_date": 1519569429, "post_id": 48966351, "comment_id": 84954110, "body": "these could all be <i>part</i> of an answer, but they all deal with arbitrary data, not native Go types, which is what I would like to preserve."}, {"owner": {"reputation": 4565, "user_id": 206479, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/72562d2e1fb45be3e000db0b5a81dc59?s=128&d=identicon&r=PG", "display_name": "carillonator", "link": "https://stackoverflow.com/users/206479/carillonator"}, "edited": false, "score": 0, "creation_date": 1519569570, "post_id": 48966351, "comment_id": 84954150, "body": "the part about rice appending zipped data to an executable is interesting, but almost all info about it out there is about windows."}, {"owner": {"reputation": 196, "user_id": 9318001, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zqIyjOOecao/AAAAAAAAAAI/AAAAAAAAAv4/QLqiX-BzjTk/photo.jpg?sz=128", "display_name": "alexey_p", "link": "https://stackoverflow.com/users/9318001/alexey-p"}, "reply_to_user": {"reputation": 4565, "user_id": 206479, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/72562d2e1fb45be3e000db0b5a81dc59?s=128&d=identicon&r=PG", "display_name": "carillonator", "link": "https://stackoverflow.com/users/206479/carillonator"}, "edited": false, "score": 0, "creation_date": 1519574852, "post_id": 48966351, "comment_id": 84955940, "body": "@carilonator You was trying to use gobs to un/serialize data. It is a good way to load data from an external file stored on local disk. Golang has no one way to load data as ready to work raw data like as C/C++ make possible to do."}, {"owner": {"reputation": 196, "user_id": 9318001, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zqIyjOOecao/AAAAAAAAAAI/AAAAAAAAAv4/QLqiX-BzjTk/photo.jpg?sz=128", "display_name": "alexey_p", "link": "https://stackoverflow.com/users/9318001/alexey-p"}, "reply_to_user": {"reputation": 4565, "user_id": 206479, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/72562d2e1fb45be3e000db0b5a81dc59?s=128&d=identicon&r=PG", "display_name": "carillonator", "link": "https://stackoverflow.com/users/206479/carillonator"}, "edited": false, "score": 0, "creation_date": 1519575158, "post_id": 48966351, "comment_id": 84956027, "body": "You can use following steps: prepare your data in gobs format, then use a development time file marked, for example, the negative tag &quot;embed&quot; // +build !embed to load your data from a local disk in a development process, then using go-resources to generate a go file marked tag &quot;embed&quot; and load your data using method is the same as you load your data from a disk."}], "tags": [], "owner": {"reputation": 196, "user_id": 9318001, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zqIyjOOecao/AAAAAAAAAAI/AAAAAAAAAv4/QLqiX-BzjTk/photo.jpg?sz=128", "display_name": "alexey_p", "link": "https://stackoverflow.com/users/9318001/alexey-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1519497719, "creation_date": 1519497719, "answer_id": 48966351, "question_id": 48965012, "link": "https://stackoverflow.com/questions/48965012/embed-go-struct-data-into-binary/48966351#48966351", "title": "Embed Go struct data into binary", "body": "<p>There are a little bit packages which make possible to embed resource (binaries) into your app.</p>\n\n<p>I was using the following:</p>\n\n<ul>\n<li>I choose <a href=\"https://github.com/omeid/go-resources\" rel=\"nofollow noreferrer\">go-resources</a> to use in production. It generates go source code file contained your data as  hex encoded;</li>\n<li>another useful package: <a href=\"https://github.com/GeertJohan/go.rice\" rel=\"nofollow noreferrer\">go.rice</a> - is real embed your data as a resource into an executable file. But I got some issue for cross-platform building;</li>\n</ul>\n\n<p>I find packages wich doing the same task, but I didn't use it in production:</p>\n\n<ul>\n<li><a href=\"https://github.com/pyros2097/go-embed\" rel=\"nofollow noreferrer\">https://github.com/pyros2097/go-embed</a></li>\n<li><a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow noreferrer\">https://github.com/jteeuwen/go-bindata</a></li>\n</ul>\n"}], "owner": {"reputation": 4565, "user_id": 206479, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/72562d2e1fb45be3e000db0b5a81dc59?s=128&d=identicon&r=PG", "display_name": "carillonator", "link": "https://stackoverflow.com/users/206479/carillonator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519497719, "creation_date": 1519489796, "last_edit_date": 1519490196, "question_id": 48965012, "link": "https://stackoverflow.com/questions/48965012/embed-go-struct-data-into-binary", "title": "Embed Go struct data into binary", "body": "<p>I have several hundred records of metadata I need available to my Go program. I would like the data to be compiled into the binary so it just works, avoiding dependencies on additional files to run.</p>\n\n<p>The metadata starts as csv, and I have a another package that processes the csv into structs. The main program uses these structs by importing that package. The csv only changes occasionally.</p>\n\n<p>I learned how to import and export the structs as <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow noreferrer\">gobs</a>, but I would need to store those gobs in a file (etc) and load them in at runtime.</p>\n\n<p>I looked at making shared libraries, but those are in ELF format and don't seem to support the native Go structs I need.</p>\n\n<p>I could have the csv-processing package literally print out go code to recreate these struct instances (with say a base64-encoded gob of it), to be built with the main program, but that seems like an awfully roundabout way to go about this.</p>\n\n<p>Is there a simple way to embed this prepared struct data into my binary? </p>\n"}, {"tags": ["go", "hugo", "delve"], "comments": [{"owner": {"reputation": 10414, "user_id": 308851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/lWWID.jpg?s=128&g=1", "display_name": "chx", "link": "https://stackoverflow.com/users/308851/chx"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1519467018, "post_id": 48961399, "comment_id": 84929353, "body": "Because I want to learn and become a developer of hugo (maybe). Best way to learn a new framework is to step through it."}], "answers": [{"comments": [{"owner": {"reputation": 10414, "user_id": 308851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/lWWID.jpg?s=128&g=1", "display_name": "chx", "link": "https://stackoverflow.com/users/308851/chx"}, "edited": false, "score": 0, "creation_date": 1519480426, "post_id": 48961913, "comment_id": 84932942, "body": "This is not what I see. This is not what strace shows either: dlv spawns six processes, I went over them with strace -p, half of them are not doing anything, half of them are in a futex wait loop."}], "tags": [], "owner": {"reputation": 9, "user_id": 9386305, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ngTMuN5XsqY/AAAAAAAAAAI/AAAAAAAADMo/H-wcLBrlrGs/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/9386305/frank"}, "is_accepted": false, "score": 0, "last_activity_date": 1519468984, "creation_date": 1519468984, "answer_id": 48961913, "question_id": 48961399, "link": "https://stackoverflow.com/questions/48961399/dlv-hugo-just-hangs/48961913#48961913", "title": "dlv hugo just hangs", "body": "<p>Same experience here. However it doesn't hang, it just takes a significant time to reach the dlv prompt.</p>\n\n<p>Check the usage of your memory (for instance with mpstat or vmstat if you are on Linux). I have 16G main mem and 16G of swap. Until the dlv prompt is reached, nearly all my memory and a significant amount of swap is consumed. During the startup time any playing video or music stutters and the PC is practically unusable until dlv is ready.</p>\n\n<p>Hugo is pretty large app in that respect.</p>\n"}, {"tags": [], "owner": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "is_accepted": true, "score": 2, "last_activity_date": 1519487893, "creation_date": 1519487893, "answer_id": 48964695, "question_id": 48961399, "link": "https://stackoverflow.com/questions/48961399/dlv-hugo-just-hangs/48964695#48964695", "title": "dlv hugo just hangs", "body": "<p>Hmm, doesn't happen for me. dlv prompt appears right away. I am on fedora, have been using hugo regularly over the past week or so. </p>\n\n<pre><code>$ dlv exec ./hugo -- --cleanDestinationDir -s /path/to/blog/root/\nType 'help' for list of commands.\n(dlv) c\n\n                   | EN  \n+------------------+----+\n  Pages            | 25  \n  Paginator pages  |  0  \n  Non-page files   |  0  \n  Static files     | 11  \n  Processed images |  0  \n  Aliases          |  0  \n  Sitemaps         |  1  \n  Cleaned          |  0  \n\nTotal in 46 ms\nProcess 41032 has exited with status 0\n$\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "edited": false, "score": 0, "creation_date": 1519527521, "post_id": 48969685, "comment_id": 84945076, "body": "Great report. I have not heard of many of these kinds of regressions on WSL, great to learn of this."}], "tags": [], "owner": {"reputation": 10414, "user_id": 308851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/lWWID.jpg?s=128&g=1", "display_name": "chx", "link": "https://stackoverflow.com/users/308851/chx"}, "is_accepted": false, "score": 3, "last_activity_date": 1519526149, "last_edit_date": 1519526149, "creation_date": 1519525790, "answer_id": 48969685, "question_id": 48961399, "link": "https://stackoverflow.com/questions/48961399/dlv-hugo-just-hangs/48969685#48969685", "title": "dlv hugo just hangs", "body": "<p>Aaaaand it's Linux subsystem for Windows! I never thought that'd make a difference but following Jonah B's answer \" I am on fedora\" I tried it on a Debian box and it worked. I am surprised because strace works fine on WSL (actually the github instructions on filing a report includes strace). I filed this <a href=\"https://github.com/Microsoft/WSL/issues/2977\" rel=\"nofollow noreferrer\">bug</a>.</p>\n"}], "owner": {"reputation": 10414, "user_id": 308851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/lWWID.jpg?s=128&g=1", "display_name": "chx", "link": "https://stackoverflow.com/users/308851/chx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 0, "accepted_answer_id": 48964695, "answer_count": 3, "score": 1, "last_activity_date": 1519526149, "creation_date": 1519465086, "last_edit_date": 1519480957, "question_id": 48961399, "link": "https://stackoverflow.com/questions/48961399/dlv-hugo-just-hangs", "title": "dlv hugo just hangs", "body": "<p>I am trying to learn Hugo using a Go debugger called <code>dlv</code>. And I am pretty stuck. After:</p>\n\n<pre><code>go get -v github.com/gohugoio/hugo\ncd $GOPATH/src/github.com/gohugoio/hugo\ngo  build -gcflags=\"-N -l\"\ndlv exec ./hugo -- -s /path/to/the/projectdir\n</code></pre>\n\n<p>This hangs. Pressing Ctrl+C runs <code>hugo</code> as normal. As far as I can see <code>dlv debug</code> not only produces the same behavior but it's the exact same: the produced binary called <code>debug</code> is the exact same as the <code>hugo</code> I built with <code>go  build -gcflags=\"-N -l\"</code>.</p>\n\n<p>dlv launches a number of child processes, these disappear after a while. The <code>hugo</code> process is visible via <code>ps</code> and <code>pidof hugo</code> but <code>strace -p</code>pidof hugo`` reports <code>strace: attach: ptrace(PTRACE_ATTACH, ...): No such proce</code>. Checking after, it's still in the ps list, the same pid. I would guess because it's in <code>t</code> state as it is being traced.</p>\n\n<p>How could I then watch Hugo running?</p>\n"}, {"tags": ["go", "yaml"], "answers": [{"tags": [], "owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "is_accepted": true, "score": 1, "last_activity_date": 1519486218, "last_edit_date": 1519486218, "creation_date": 1519464828, "answer_id": 48961368, "question_id": 48960969, "link": "https://stackoverflow.com/questions/48960969/parse-a-dynamic-yaml-file/48961368#48961368", "title": "Parse a dynamic yaml file", "body": "<p>If you don't now exact struct you should probably make your struct looking like this</p>\n\n<pre><code>type Secrets struct {\n    Keys []struct {\n        Key    string `json:\"key\"`\n        Values []map[string]string `json:\"values\"`\n    } `json:\"keys\"`\n}\n</code></pre>\n\n<p>It will parse your whole yaml and get all values, but it will be an array so you loosing type hinting on object. Other way arround would be advance endoding <a href=\"https://blog.gopheracademy.com/advent-2016/advanced-encoding-decoding/\" rel=\"nofollow noreferrer\">https://blog.gopheracademy.com/advent-2016/advanced-encoding-decoding/</a> but you will need to add new object every time new key/value pair will appear.   </p>\n"}], "owner": {"reputation": 127, "user_id": 3330601, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/83d6836ee4a553228230113387e2b810?s=128&d=identicon&r=PG&f=1", "display_name": "popopanda", "link": "https://stackoverflow.com/users/3330601/popopanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1652, "favorite_count": 0, "accepted_answer_id": 48961368, "answer_count": 1, "score": 2, "last_activity_date": 1519486218, "creation_date": 1519461601, "last_edit_date": 1519462334, "question_id": 48960969, "link": "https://stackoverflow.com/questions/48960969/parse-a-dynamic-yaml-file", "title": "Parse a dynamic yaml file", "body": "<p>I have a yaml file that is currently written as:</p>\n\n<pre><code>    keys:\n        - key: secret/dog\n          values:\n            - username: shiba\n            - password: inu\n        - key: secret/cat\n          values:\n            - dbhost: localhost\n            - words: meow\n</code></pre>\n\n<p>However, this yaml file often changes, so new entries could be added with different values each time:</p>\n\n<pre><code>    keys:\n        - key: secret/dog\n          values:\n            - username: shiba\n            - password: inu\n        - key: secret/cat\n          values:\n            - dbhost: localhost\n            - words: meow\n        - key: secret/mouse\n          values:\n            - color: white\n        - key: secret/clouds\n          values:\n            - type: fluffy\n</code></pre>\n\n<p>I know from go using the gopkg.in/yaml.v2 package, i can parse through the yaml file, if all the values are the same, for example:</p>\n\n<pre><code>            type Secrets struct {\n                Keys []struct {\n                    Key    string `json:\"key\"`\n                    Values []struct {\n                        Username string `json:\"username\"`\n                        Password string `json:\"password\"`\n                    } `json:\"values\"`\n                } `json:\"keys\"`\n            }\n\n            func main() {\n\n                var secret Secrets\n                reader, err := os.Open(\"demo.yml\")\n                if err != nil {\n                    log.Fatal(err)\n                }\n                buf, _ := ioutil.ReadAll(reader)\n                yaml.Unmarshal(buf, &amp;secret)\n\n                fmt.Printf(\"%+v\\n\", secret.Keys[1].Key)\n\n            }\n</code></pre>\n\n<p>In the example above, it would only work for the secret/dog key, but not the others.</p>\n\n<p>How can I do this in Go, when new values are added to my yaml file often?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "random", "dependency-injection"], "answers": [{"tags": [], "owner": {"reputation": 622, "user_id": 1224002, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4dcddce38402fb5ef2c2cf390ee82a4?s=128&d=identicon&r=PG", "display_name": "Ted Pudlik", "link": "https://stackoverflow.com/users/1224002/ted-pudlik"}, "is_accepted": false, "score": 0, "last_activity_date": 1519440879, "creation_date": 1519440879, "answer_id": 48958887, "question_id": 48958886, "link": "https://stackoverflow.com/questions/48958886/how-to-create-a-thread-safe-rand-source/48958887#48958887", "title": "How to create a thread-safe rand.Source?", "body": "<p>After some sleuthing, I learned that the way to go is to protect the Source with a mutex.  The standard library even <a href=\"https://golang.org/src/math/rand/rand.go\" rel=\"nofollow noreferrer\">contains an implementation</a>, <code>lockedSource</code>, but the relevant type <a href=\"https://groups.google.com/forum/#!topic/golang-dev/I6OyzJneuew\" rel=\"nofollow noreferrer\">is not exported</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 4, "last_activity_date": 1519454868, "last_edit_date": 1519454868, "creation_date": 1519453142, "answer_id": 48959983, "question_id": 48958886, "link": "https://stackoverflow.com/questions/48958886/how-to-create-a-thread-safe-rand-source/48959983#48959983", "title": "How to create a thread-safe rand.Source?", "body": "<p>It's typical to use a  <a href=\"https://godoc.org/sync#Mutex\" rel=\"nofollow noreferrer\">sync.Mutex</a> to ensure that a value or values are not accessed concurrently.  Here's how to use a sync.Mutex to protect a rand.Source:</p>\n\n<pre><code> var s = rand.NewSource(seed)\n var mu sync.Mutex\n\n// lock/unlock when accessing source from a goroutine\nmu.Lock()\ni := s.Int63()\nmu.Unlock(\n</code></pre>\n\n<p>The <a href=\"https://godoc.org/math/rand#Rand\" rel=\"nofollow noreferrer\">rand.Rand</a> does not support concurrent use.  If the application is using the rand.Source to create a rand.Rand, then protect the rand.Rand instead:</p>\n\n<pre><code> var r = rand.New(rand.NewSource(seed))\n var mu sync.Mutex\n\n// lock/unlock when accessing the rand from a goroutine\nmu.Lock()\ni := r.Int()\nmu.Unlock()\n</code></pre>\n\n<p>The mutex used to protect the rand.Rand will also protect the rand.Source.</p>\n"}], "owner": {"reputation": 622, "user_id": 1224002, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4dcddce38402fb5ef2c2cf390ee82a4?s=128&d=identicon&r=PG", "display_name": "Ted Pudlik", "link": "https://stackoverflow.com/users/1224002/ted-pudlik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2405, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1519454868, "creation_date": 1519440879, "question_id": 48958886, "link": "https://stackoverflow.com/questions/48958886/how-to-create-a-thread-safe-rand-source", "title": "How to create a thread-safe rand.Source?", "body": "<p>The <a href=\"https://golang.org/pkg/math/rand/#NewSource\" rel=\"nofollow noreferrer\">documentation</a> for the standard-library <code>rand.NewSource</code> function states that,</p>\n\n<blockquote>\n  <p>Unlike the default Source used by top-level functions, this source is\n  not safe for concurrent use by multiple goroutines.</p>\n</blockquote>\n\n<p>Is there a way to create a thread-safe <code>rand.Source</code>?</p>\n\n<p>Context: I have a type with a method that may be called by multiple go-routines, and this method uses random numbers.  I want to support dependency injection for testing, so I can't use the default Source.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1519441663, "post_id": 48958669, "comment_id": 84924630, "body": "No, because, as you noted, you can&#39;t have a field and method with the same name, and you have to implement the <code>Age</code> method to satisfy the interface."}], "answers": [{"tags": [], "owner": {"reputation": 29582, "user_id": 1427098, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Bvdm0.jpg?s=128&g=1", "display_name": "Darshan Rivka Whittle", "link": "https://stackoverflow.com/users/1427098/darshan-rivka-whittle"}, "is_accepted": true, "score": 7, "last_activity_date": 1519442728, "last_edit_date": 1519442728, "creation_date": 1519442296, "answer_id": 48959016, "question_id": 48958669, "link": "https://stackoverflow.com/questions/48958669/go-struct-field-has-same-name-as-interface-method/48959016#48959016", "title": "Go struct field has same name as interface method", "body": "<p>Well, not directly, of course, for the reasons already stated.  But you could create a wrapper around Person, and pass that in:</p>\n\n<pre><code>type BarPerson struct {\n    *Person\n}\n\nfunc (bp *BarPerson) Age() int {\n    return bp.Person.Age\n}\n\nfunc main() {\n    p := Person{37}\n    lib.Foo(&amp;BarPerson{&amp;p})\n}\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 864438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qaBA3.jpg?s=128&g=1", "display_name": "Dave Pascua", "link": "https://stackoverflow.com/users/864438/dave-pascua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3412, "favorite_count": 0, "accepted_answer_id": 48959016, "answer_count": 1, "score": 1, "last_activity_date": 1519442728, "creation_date": 1519438517, "last_edit_date": 1519442155, "question_id": 48958669, "link": "https://stackoverflow.com/questions/48958669/go-struct-field-has-same-name-as-interface-method", "title": "Go struct field has same name as interface method", "body": "<p>From a 3rd party:</p>\n\n<pre><code>package lib\n\ntype Bar interface{\n  Age() int\n}\n\nFoo(b Bar) int\n</code></pre>\n\n<p>This doesn't compile because <code>Age</code> is both a method name and field name:</p>\n\n<pre><code>package main\n\nimport \"lib\"\n\ntype Person struct {\n  Age int\n}\n\nfunc (p *Person)Age() int {\n  return p.Age\n}\n\nfunc main() {\n  p := Person()\n  lib.Foo(p)\n}\n</code></pre>\n\n<p><strong>Without</strong> renaming <code>Person.Age</code>, is there a way to call <code>lib.Foo()</code> on an instance of <code>Person</code>?  </p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 1961, "user_id": 7754093, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/VoAj5.png?s=128&g=1", "display_name": "Francesco Meli", "link": "https://stackoverflow.com/users/7754093/francesco-meli"}, "edited": false, "score": 0, "creation_date": 1519434793, "post_id": 48958241, "comment_id": 84923563, "body": "Not giving the answer here, but are you sure it wouldn&#39;t be better to do the counting on the application layer?"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 1961, "user_id": 7754093, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/VoAj5.png?s=128&g=1", "display_name": "Francesco Meli", "link": "https://stackoverflow.com/users/7754093/francesco-meli"}, "edited": false, "score": 0, "creation_date": 1519434869, "post_id": 48958241, "comment_id": 84923579, "body": "I want to get a count of <i>all</i> items for the given query, not just the count of the results returned with the <code>LIMIT</code> contraints. Look at the second query in the first code example and you will see what I mean; it doesn&#39;t use <code>LIMIT</code>."}, {"owner": {"reputation": 27828, "user_id": 5563083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab25f269dc3fd3b4a657ddd27cf8f349?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Spiegel", "link": "https://stackoverflow.com/users/5563083/paul-spiegel"}, "edited": false, "score": 1, "creation_date": 1519449004, "post_id": 48958241, "comment_id": 84925818, "body": "What&#39;s wrong in running two queries?"}, {"owner": {"reputation": 32469, "user_id": 1529673, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/O6MQS.jpg?s=128&g=1", "display_name": "Strawberry", "link": "https://stackoverflow.com/users/1529673/strawberry"}, "edited": false, "score": 0, "creation_date": 1519458279, "post_id": 48958241, "comment_id": 84927415, "body": "Take a look at the information functions - specifically FOUND_ROWS"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 27828, "user_id": 5563083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab25f269dc3fd3b4a657ddd27cf8f349?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Spiegel", "link": "https://stackoverflow.com/users/5563083/paul-spiegel"}, "edited": false, "score": 0, "creation_date": 1519479664, "post_id": 48958241, "comment_id": 84932742, "body": "@PaulSpiegel Nothing, necessarily. I just figured if I could make it one instead of two, that&#39;d be better."}, {"owner": {"reputation": 27828, "user_id": 5563083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab25f269dc3fd3b4a657ddd27cf8f349?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Spiegel", "link": "https://stackoverflow.com/users/5563083/paul-spiegel"}, "edited": false, "score": 1, "creation_date": 1519488014, "post_id": 48958241, "comment_id": 84935346, "body": "<code>FOUND_ROWS()</code> is an option, but (from my experience) two queries are usually faster. At least for low offsets when supported by indexes. Note that for the COUNT query you don&#39;t need to join the <code>item</code> table. You only need  to count the rows in the <code>user_item</code> table."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 27828, "user_id": 5563083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab25f269dc3fd3b4a657ddd27cf8f349?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Spiegel", "link": "https://stackoverflow.com/users/5563083/paul-spiegel"}, "edited": false, "score": 0, "creation_date": 1519498537, "post_id": 48958241, "comment_id": 84938560, "body": "@PaulSpiegel Ah great point, hadn&#39;t thought of that. That will at least reduce the second query. Thanks!"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 27828, "user_id": 5563083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab25f269dc3fd3b4a657ddd27cf8f349?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Spiegel", "link": "https://stackoverflow.com/users/5563083/paul-spiegel"}, "edited": false, "score": 0, "creation_date": 1519500479, "post_id": 48958241, "comment_id": 84939197, "body": "@PaulSpiegel . Actually on second thought, there will indeed need to be a join on some of the <code>COUNT</code> queries. In some cases, I don&#39;t just want to know how many <code>user_item</code> rows there are, I want to know how many <code>user_item</code> rows there are while other conditions are true (such as where the <code>username</code> equals something). That is why I do the join, so I can only select the <code>user_item</code> rows by a given user. The business logic is &quot;Get an item feed by username&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 6812, "user_id": 7371893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ris3Z.png?s=128&g=1", "display_name": "&#226;\u0144\u014d\u014b\u0177Xmo\u016f\u015c", "link": "https://stackoverflow.com/users/7371893/%c3%a2%c5%84%c5%8d%c5%8b%c5%b7xmo%c5%af%c5%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1519435353, "creation_date": 1519435353, "answer_id": 48958414, "question_id": 48958241, "link": "https://stackoverflow.com/questions/48958241/get-a-list-of-results-and-get-the-total-in-one-query/48958414#48958414", "title": "Get a list of results and get the total in one query", "body": "<p>Ensure to add 'group by' in the query. Hope this helps. Thanks.</p>\n\n<pre><code>SELECT item.*, COUNT(*) AS _count\nFROM item\nJOIN user\n    ON user.username = ?\nJOIN user_item\n    ON user_item.item_id = item.id\n    AND user_item.user_id = user.id\nGROUP BY item.id        \nORDER BY item.id DESC\nLIMIT ?, ?\n</code></pre>\n"}], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 1, "accepted_answer_id": 48958414, "answer_count": 1, "score": 0, "last_activity_date": 1519462470, "creation_date": 1519433651, "last_edit_date": 1519462470, "question_id": 48958241, "link": "https://stackoverflow.com/questions/48958241/get-a-list-of-results-and-get-the-total-in-one-query", "title": "Get a list of results and get the total in one query", "body": "<p>I have logic that is meant for pagination, and it works perfectly fine as is. This question is meant for optimization/improvement in regards to how I'm doing something.</p>\n\n<p>I am running two queries to get a result set. The first query gets all items by limit and offset, the second query gets the total count. I need this total to do math for pagination links in the presentation layer.</p>\n\n<p>I want to avoid running two queries, and combine them into one if possible. </p>\n\n<p>For example, if there is 100 items in the database and I run the query below with the <code>LimitStartIndex</code> at 1 and <code>LimitStopIndex</code> at 20, then the query should return 20 results and a count of 100. I currently achieve this in two separate queries just fine, but again I want to do it in one query.</p>\n\n<p>Here is my current setup (using Golang):</p>\n\n<pre><code>var items []*Item\nerr := r.db.Select(&amp;items, `\n    SELECT item.*\n    FROM item\n    JOIN user\n        ON user.username = ?\n    JOIN user_item\n        ON user_item.item_id = item.id\n        AND user_item.user_id = user.id\n    ORDER BY item.id DESC\n    LIMIT ?,?\n`, username, pagination.LimitStartIndex, pagination.LimitStopIndex)\nif err != nil {\n    // ...\n}\n\nvar total int\nerr = r.db.Get(&amp;total, `\n    SELECT COUNT(*)\n    FROM item\n    JOIN user\n        ON user.username = ?\n    JOIN user_item\n        ON user_item.item_id = item.id\n        AND user_item.user_id = user.id\n`, username)\nif err != nil {\n    // ...\n}\n\nresult := &amp;domain.PaginationResult{\n    Items: items,\n    Total: total,\n}\n</code></pre>\n\n<p>I tried something like this:</p>\n\n<pre><code>SELECT item.*, COUNT(DISTINCT item.id) AS _count\nFROM item\nJOIN user\n    ON user.username = ?\nJOIN user_item\n    ON user_item.item_id = item.id\n    AND user_item.user_id = user.id\nORDER BY item.id DESC\nLIMIT ?,?\n</code></pre>\n\n<p>However I receive this error: </p>\n\n<blockquote>\n  <p>Error 1140: In aggregated query without GROUP BY, expression #1 of\n  SELECT list contains nonaggregated column 'mytable.item.id'; this is\n  incompatible with sql_mode=only_full_group_by</p>\n</blockquote>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 2293, "user_id": 526189, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/bccb4c5ba735fd1a1c1c4908a058ad43?s=128&d=identicon&r=PG", "display_name": "rendon", "link": "https://stackoverflow.com/users/526189/rendon"}, "edited": false, "score": 0, "creation_date": 1519434800, "post_id": 48958051, "comment_id": 84923567, "body": "I don&#39;t think what you want is possible. Iterating through all the items seems to be the only option, which you are already doing during the unmarshaling (though implicitly), going from X to 2X is not too bad, also 8k records every few minutes is not a lot, I would be worried if it was per second."}, {"owner": {"reputation": 15, "user_id": 2138298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa3ea27bec592dc86ad0762eee377e4?s=128&d=identicon&r=PG", "display_name": "t0dbld", "link": "https://stackoverflow.com/users/2138298/t0dbld"}, "reply_to_user": {"reputation": 2293, "user_id": 526189, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/bccb4c5ba735fd1a1c1c4908a058ad43?s=128&d=identicon&r=PG", "display_name": "rendon", "link": "https://stackoverflow.com/users/526189/rendon"}, "edited": false, "score": 0, "creation_date": 1519436409, "post_id": 48958051, "comment_id": 84923825, "body": "Well it\u2019s unmarshaling than iterating while appending back x 15 go routines all for bulk inserts of about 8k every 5 minutes"}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 0, "creation_date": 1519450478, "post_id": 48958051, "comment_id": 84926057, "body": "I think I get your question, but I still think it would be easier to understand if you added some sample array input of the kind you want to be able to process, and if possible some code you&#39;ve tried to use to process it, even if it&#39;s broken or unfinished or doesn&#39;t perform the way you want."}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 0, "creation_date": 1519450646, "post_id": 48958051, "comment_id": 84926087, "body": "It sounds like you have a solution in mind but you are concerned about its performance, but you haven&#39;t actually tested its performance.  I have often heard the advice that performance problems are difficult to predict accurately, so just get it to work, and then worry about performance if performance turns out to be a problem..."}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 0, "creation_date": 1519462234, "post_id": 48958051, "comment_id": 84928309, "body": "So your ultimate goal is to output normalized JSON, right?  That is, you&#39;re not using the JSON as an intermediary step on the way to Go logic, you&#39;re using Go as an intermediary step from JSON to JSON -- yes?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 2138298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa3ea27bec592dc86ad0762eee377e4?s=128&d=identicon&r=PG", "display_name": "t0dbld", "link": "https://stackoverflow.com/users/2138298/t0dbld"}, "edited": false, "score": 0, "creation_date": 1519498216, "post_id": 48961444, "comment_id": 84938469, "body": "you get the check as this was exactly how I was handling other normalization issues and preparing for bulk inserts with time stamps. but as expected(missing something easy) it never occurred to me to append to a second struct. while waiting for a someone to figure out how silly i was i came up with a dirty hack method, but I think your solution is the obvious way to deal with this. Thanks for your time and help, and sorry I didin&#39;t answer your comments first above , was sleeping :-)"}], "tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": true, "score": 1, "last_activity_date": 1519465436, "creation_date": 1519465436, "answer_id": 48961444, "question_id": 48958051, "link": "https://stackoverflow.com/questions/48958051/how-to-change-field-names-of-json-object-arrays/48961444#48961444", "title": "How to Change Field names of json object arrays", "body": "<p>It appears your desired output is JSON.  You can accomplish the conversion by unmarshaling into a slice of structs, and then iterating through each of those to convert them to the second struct type (your anonymous struct above), append them into a slice and then marshal the slice back to JSON:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\ntype omit bool\n\ntype Value interface{}\n\ntype CacheItem struct {\n    Key    string `json:\"key\"`\n    MaxAge int    `json:\"cacheAge\"`\n    Value  Value  `json:\"cacheValue\"`\n}\n\ntype OutGoing struct {\n    // Omit bad keys\n    OmitMaxAge omit `json:\"cacheAge,omitempty\"`\n    OmitValue  omit `json:\"cacheValue,omitempty\"`\n\n    // Add nice keys\n    Key    string `json:\"key\"`\n    MaxAge int    `json:\"max_age\"`\n    Value  *Value `json:\"value\"`\n}\n\nfunc main() {\n    objects := make([]CacheItem, 0)\n    sample := []byte(`[\n    {\n      \"key\": \"foo\",\n      \"cacheAge\": 1234,\n      \"cacheValue\": {\n        \"nested\": true\n      }},\n    {\n      \"key\": \"baz\",\n      \"cacheAge\": 123,\n      \"cacheValue\": {\n        \"nested\": true\n    }}]`)\n\n    json.Unmarshal(sample, &amp;objects)\n\n    out := make([]OutGoing, 0, len(objects))\n    for _, o := range objects {\n        out = append(out, OutGoing{Key:o.Key, MaxAge:o.MaxAge, Value:&amp;o.Value})\n    }\n    s, _ := json.Marshal(out)\n    fmt.Println(string(s))\n}\n</code></pre>\n\n<p>This outputs</p>\n\n<pre><code>[{\"key\":\"foo\",\"max_age\":1234,\"value\":{\"nested\":true}},{\"key\":\"baz\",\"max_age\":123,\"value\":{\"nested\":true}}]\n</code></pre>\n\n<p>You could probably skip this iteration and conversion code if you wrote custom MarshalJSON and UnmarshalJSON methods for your CacheItem type, instead of relying on struct field tags.  Then you could pass the same slice to both Unmarshal and Marshal.</p>\n\n<p>To me there's no obvious performance mistake with these approaches -- contrast with building a string in a loop using the <code>+</code> operator -- and when that's the case it's often best to just get the software to work and then test for performance rather than ruling out a solution based on fears of performance issues without actually testing.</p>\n\n<p>If there's a performance problem with the above approaches, and you really want to avoid marshal and unmarshal completely, you could look into byte replacement in the JSON data (e.g. regexp).  I'm not recommending this approach, but if your changes are very simple and the inputs are very consistent it could work, and it would give another approach you could performance test, and then you could compare performance test results.</p>\n"}], "owner": {"reputation": 15, "user_id": 2138298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa3ea27bec592dc86ad0762eee377e4?s=128&d=identicon&r=PG", "display_name": "t0dbld", "link": "https://stackoverflow.com/users/2138298/t0dbld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 48961444, "answer_count": 1, "score": 0, "last_activity_date": 1519465436, "creation_date": 1519431893, "question_id": 48958051, "link": "https://stackoverflow.com/questions/48958051/how-to-change-field-names-of-json-object-arrays", "title": "How to Change Field names of json object arrays", "body": "<p>So I have a project with lots of incoming data about 15 sources in total, of course there are inconsistencies in how each label there data available in their rest api's. I need to Change some of their field names to be consistent with the others, but I am at a loss on how to do this when the data sources are json object arrays. A working example of what I am trying to do is found here <a href=\"https://play.golang.org/p/GWKO7u53WL\" rel=\"nofollow noreferrer\">playground</a> and below</p>\n\n<p>however I seem to lack the knowledge as to how to make this work when the data is not a single json object , but instead and array of objects that I am unmarshaling.</p>\n\n<p>Another approach is using Maps like in this <a href=\"https://play.golang.org/p/TabSga4i17\" rel=\"nofollow noreferrer\">example</a> but the result is the same, works great as is for single objects, but I can not seem to get it to work with json object arrays. Iteration through arrays is not a possibility as I am collecting about 8,000 records every few minutes.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"os\"\n)\n\ntype omit bool\n\ntype Value interface{}\n\ntype CacheItem struct {\n    Key    string `json:\"key\"`\n    MaxAge int    `json:\"cacheAge\"`\n    Value  Value  `json:\"cacheValue\"`\n}\n\nfunc NewCacheItem() (*CacheItem, error) {\n    i := &amp;CacheItem{}\n    return i, json.Unmarshal([]byte(`{\n      \"key\": \"foo\",\n      \"cacheAge\": 1234,\n      \"cacheValue\": {\n        \"nested\": true\n      }\n    }`), i)\n}\n\nfunc main() {\n    item, _ := NewCacheItem()\n\n    json.NewEncoder(os.Stdout).Encode(struct {\n        *CacheItem\n\n        // Omit bad keys\n        OmitMaxAge omit `json:\"cacheAge,omitempty\"`\n        OmitValue  omit `json:\"cacheValue,omitempty\"`\n\n        // Add nice keys\n        MaxAge int    `json:\"max_age\"`\n        Value  *Value `json:\"value\"`\n    }{\n        CacheItem: item,\n\n        // Set the int by value:\n        MaxAge: item.MaxAge,\n\n        // Set the nested struct by reference, avoid making a copy:\n        Value: &amp;item.Value,\n    })\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1519431205, "post_id": 48957926, "comment_id": 84922889, "body": "You&#39;re not just creating a struct, you have a composite literal of a slice <i>containing</i> a struct."}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1519432612, "post_id": 48957926, "comment_id": 84923172, "body": "@JimB ok, but I am still not getting it, according to your logic, what object the first <code>{</code> create and what object does the second <code>{</code> create?"}, {"owner": {"reputation": 159, "user_id": 3573024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d560ff0aeb4ce52219a166547fdb09?s=128&d=identicon&r=PG&f=1", "display_name": "mgagnon", "link": "https://stackoverflow.com/users/3573024/mgagnon"}, "edited": false, "score": 0, "creation_date": 1519433957, "post_id": 48957926, "comment_id": 84923440, "body": "The first one is the slice, the second the structure. If you had 2 element on the slice, you would have something like this; {{...},{...}}"}], "answers": [{"tags": [], "owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "is_accepted": false, "score": 2, "last_activity_date": 1519433823, "creation_date": 1519433823, "answer_id": 48958266, "question_id": 48957926, "link": "https://stackoverflow.com/questions/48957926/what-do-double-curly-brackets-mean-in-struct-declaration/48958266#48958266", "title": "What do double curly brackets mean in struct declaration?", "body": "<p><code>[]rpc.API{ }</code> defines an empty slice of <code>rpc.API</code>'s.  You can put any number of <code>rpc.API</code>'s inside those curly brackets to make them elements of the slice.</p>\n\n<p>The code you have is the same as:</p>\n\n<pre><code>a := rpc.API{ Namespace: \"test\", ... }\nreturn []rpc.API{ a }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 4, "last_activity_date": 1519504178, "last_edit_date": 1519504178, "creation_date": 1519436807, "answer_id": 48958547, "question_id": 48957926, "link": "https://stackoverflow.com/questions/48957926/what-do-double-curly-brackets-mean-in-struct-declaration/48958547#48958547", "title": "What do double curly brackets mean in struct declaration?", "body": "<p>It's a slightly shorter version of this (fewer lines and less indenting):</p>\n\n<pre><code>return []rpc.API{\n    {\n        Namespace: \"test\",\n        Version:   \"1.0\",\n        Service: &amp;TestAPI{\n            state:     &amp;t.state,\n            peerCount: &amp;t.peerCount,\n        },\n    },\n}\n</code></pre>\n\n<p>It's a slice of structs with one element in it.</p>\n"}], "owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 907, "favorite_count": 0, "accepted_answer_id": 48958547, "answer_count": 2, "score": -1, "last_activity_date": 1519504178, "creation_date": 1519430787, "question_id": 48957926, "link": "https://stackoverflow.com/questions/48957926/what-do-double-curly-brackets-mean-in-struct-declaration", "title": "What do double curly brackets mean in struct declaration?", "body": "<p>Can someone please explain me what do double curly brackets <code>{{</code> mean in this code ?  :</p>\n\n<pre><code>func (t *testService) APIs() []rpc.API {\n    return []rpc.API{{\n        Namespace: \"test\",\n        Version:   \"1.0\",\n        Service: &amp;TestAPI{\n            state:     &amp;t.state,\n            peerCount: &amp;t.peerCount,\n        },\n    }}\n}\n</code></pre>\n\n<p>AFIK single curly bracket is enough to create a struct, so why to double it?</p>\n\n<p>the API struct is defined like this:</p>\n\n<pre><code>package rpc\n\n// API describes the set of methods offered over the RPC interface\ntype API struct {\n    Namespace string      // namespace under which the rpc methods of Service are exposed\n    Version   string      // api version for DApp's\n    Service   interface{} // receiver instance which holds the methods\n    Public    bool        // indication if the methods must be considered safe for public use\n}\n</code></pre>\n"}, {"tags": ["go", "concurrency", "channels"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1519421614, "post_id": 48956306, "comment_id": 84919892, "body": "If you want them all pushing to the same channel, why not have them all push to the same channel as in the play link?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1519422479, "post_id": 48956306, "comment_id": 84920249, "body": "Your problem in your second example is that you&#39;re only receiving from the channel once, which means only the <i>first</i> sender to the channel (in this case, A, though it&#39;s technically non-deterministic) gets received.  If you need output from all 3, you need to receive from the channel 3 times to get all of the output (sending to a channel doesn&#39;t just magically concatenate all of those values!)"}, {"owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "edited": false, "score": 0, "creation_date": 1519429473, "post_id": 48956306, "comment_id": 84922479, "body": "Do you want to wait till all the routines are done before printing the results?"}, {"owner": {"reputation": 11, "user_id": 9403556, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "OneSockThief", "link": "https://stackoverflow.com/users/9403556/onesockthief"}, "edited": false, "score": 0, "creation_date": 1519475573, "post_id": 48956306, "comment_id": 84931612, "body": "Awesome, I think I might have misunderstood the concept of blocking/sending, according to my brain, by sending to the channel it would all get pulled after the go routines have finished, almost like popping onto a stack and then pulling the whole stack.  But I do understand now that I have to &quot;pull for each push&quot;. Thank you very much all :)"}, {"owner": {"reputation": 11, "user_id": 9403556, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "OneSockThief", "link": "https://stackoverflow.com/users/9403556/onesockthief"}, "edited": false, "score": 0, "creation_date": 1519556963, "post_id": 48956306, "comment_id": 84950488, "body": "play.golang.org/p/_v1r_cQ5gAS It seems that Body.Close() does not close the go routine."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9403556, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "OneSockThief", "link": "https://stackoverflow.com/users/9403556/onesockthief"}, "edited": false, "score": 0, "creation_date": 1519475674, "post_id": 48959302, "comment_id": 84931636, "body": "Thank you for the answer, I understand the concept/design you have given...  My understanding of the blocking/sending was a bit skew, I thought it&#39;s almost like popping onto a stack and then pulling the whole stack."}, {"owner": {"reputation": 11, "user_id": 9403556, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "OneSockThief", "link": "https://stackoverflow.com/users/9403556/onesockthief"}, "edited": false, "score": 0, "creation_date": 1519552404, "post_id": 48959302, "comment_id": 84949520, "body": "This method is 100% valid, but once applied to an HTTP related function it seems to be hanging, here is a sample of what I&#39;m talking about: <a href=\"https://play.golang.org/p/_v1r_cQ5gAS\" rel=\"nofollow noreferrer\">play.golang.org/p/_v1r_cQ5gAS</a>   It seems that Body.Close() does not close the go routine."}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "reply_to_user": {"reputation": 11, "user_id": 9403556, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "OneSockThief", "link": "https://stackoverflow.com/users/9403556/onesockthief"}, "edited": false, "score": 0, "creation_date": 1519587933, "post_id": 48959302, "comment_id": 84960512, "body": "Why would response.Body.Close() close the goroutine?"}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "reply_to_user": {"reputation": 11, "user_id": 9403556, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "OneSockThief", "link": "https://stackoverflow.com/users/9403556/onesockthief"}, "edited": false, "score": 0, "creation_date": 1519587953, "post_id": 48959302, "comment_id": 84960522, "body": "The code you linked in your comment contains an infinite for { ... } loop.  It looks like you only call <code>os.Exit</code> on error.  So I don&#39;t see why your program wouldn&#39;t run forever."}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "reply_to_user": {"reputation": 11, "user_id": 9403556, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "OneSockThief", "link": "https://stackoverflow.com/users/9403556/onesockthief"}, "edited": false, "score": 0, "creation_date": 1519588066, "post_id": 48959302, "comment_id": 84960553, "body": "The code you linked is different code with different issues.  If you want more help with it I suggest you post it as a new question."}], "tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": false, "score": 1, "last_activity_date": 1519491888, "last_edit_date": 1519491888, "creation_date": 1519445721, "answer_id": 48959302, "question_id": 48956306, "link": "https://stackoverflow.com/questions/48956306/multiple-senders-to-single-channel-in-golang/48959302#48959302", "title": "Multiple senders to single channel in Golang", "body": "<blockquote>\n  <p>I would like to achieve something like this</p>\n</blockquote>\n\n<pre><code>channelA := make(chan []intTest)\ngo modify1(\"A\", channelA)\ngo modify2(\"B\", channelA)\ngo modify3(\"C\", channelA)\n</code></pre>\n\n<blockquote>\n  <p>Is this possible, or is the top sample more feasible?</p>\n</blockquote>\n\n<p>Yes: you can use a single channel across multiple goroutines -- that's what channels are designed for.</p>\n\n<blockquote>\n  <p>but as shown the functions modify2 &amp; modify3 visually seems like they never get added.</p>\n</blockquote>\n\n<p>The problem you have there is that you only called the receive operator once:  </p>\n\n<pre><code>b := append(&lt;-channelA)\nfmt.Println(b)\n</code></pre>\n\n<p>The other two goroutines were either blocked waiting to send their result, or still building their result, when your <code>main</code> goroutine exited.</p>\n\n<p>If you change your <code>main()</code> function to this, you can see that all three workers will send their results over the channel if another routine is ready to receive (because you used an unbuffered channel, sends will block until a receiver is ready):</p>\n\n<pre><code>func main() {\n    ch := make(chan []intTest)\n\n    go modify1(\"A\", ch)\n    go modify2(\"B\", ch)\n    go modify3(\"C\", ch)\n    fmt.Println(&lt;-ch)\n    fmt.Println(&lt;-ch)\n    fmt.Println(&lt;-ch)\n}\n</code></pre>\n\n<p>Which outputs:</p>\n\n<pre><code>Adding inside: C\nAdding inside: A\nAdding inside: B\nAdding inside: A\nAdding inside: A\nAdding inside: B\nAdding inside: C\nAdding inside: A\nAdding inside: B\nAdding inside: A\nAdding inside: A\nAdding inside: B\nAdding inside: C\nAdding inside: A\nAdding inside: A\nAdding inside: B\nAdding inside: A\nAdding inside: C\nAdding inside: A\nAdding inside: B\n[{0 0} {1 0} {2 0} {3 0} {4 0} {5 0} {6 0} {7 0} {8 0} {9 0}]\nAdding inside: C\nAdding inside: B\nAdding inside: B\nAdding inside: C\nAdding inside: B\nAdding inside: C\nAdding inside: B\n[{10 0} {11 0} {12 0} {13 0} {14 0} {15 0} {16 0} {17 0} {18 0} {19 0}]\nAdding inside: C\nAdding inside: C\nAdding inside: C\n[{20 0} {21 0} {22 0} {23 0} {24 0} {25 0} {26 0} {27 0} {28 0} {29 0}]\n</code></pre>\n\n<p>You can then change that code to append received elements to a single list prior to output, or otherwise format the received elements in whatever way you like.</p>\n\n<blockquote>\n  <p>I thought it's almost like popping onto a stack and then pulling the whole stack</p>\n</blockquote>\n\n<p>With an initialized, not-closed, buffered channel, a send statement puts one element onto a queue, and a receive operation pops one element off the queue and returns it.  It's first in first out (FIFO) order, so it's a queue rather than a stack.  In the examples above the channel is unbuffered, so a send has to wait for a goroutine ready to receive, and a receive has to wait for a goroutine ready to send.  Main is a goroutine as well.</p>\n"}], "owner": {"reputation": 11, "user_id": 9403556, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "OneSockThief", "link": "https://stackoverflow.com/users/9403556/onesockthief"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1794, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519491888, "creation_date": 1519420447, "last_edit_date": 1519462660, "question_id": 48956306, "link": "https://stackoverflow.com/questions/48956306/multiple-senders-to-single-channel-in-golang", "title": "Multiple senders to single channel in Golang", "body": "<p>The concept seems simple to explain, but a tad harder to implement (\"correctly\").</p>\n\n<p>The tl;dr is I want to run multiple functions that push output into a single channel.</p>\n\n<p>As a sample working test (with multiple channels), to elaborate on my question <a href=\"https://play.golang.org/p/1ztCvPFLXKv\" rel=\"nofollow noreferrer\">https://play.golang.org/p/1ztCvPFLXKv</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype intTest struct {\n    ID     int\n    Number int\n}\n\nfunc modify1(channelID string, res chan []intTest) {\n    s := []intTest{}\n    for i := 0; i &lt; 10; i++ {\n        fmt.Printf(\"Adding inside: %s\\n\", channelID)\n        s = append(s, intTest{i, 0})\n        time.Sleep(100 * time.Millisecond)\n    }\n    res &lt;- s\n}\nfunc modify2(channelID string, res chan []intTest) {\n    s := []intTest{}\n    for i := 10; i &lt; 20; i++ {\n        fmt.Printf(\"Adding inside: %s\\n\", channelID)\n        s = append(s, intTest{i, 0})\n        time.Sleep(200 * time.Millisecond)\n    }\n    res &lt;- s\n}\nfunc modify3(channelID string, res chan []intTest) {\n    s := []intTest{}\n    for i := 20; i &lt; 30; i++ {\n        fmt.Printf(\"Adding inside: %s\\n\", channelID)\n        s = append(s, intTest{i, 0})\n        time.Sleep(300 * time.Millisecond)\n    }\n    res &lt;- s\n}\n\nfunc main() {\n    channelA := make(chan []intTest)\n    channelB := make(chan []intTest)\n    channelC := make(chan []intTest)\n\n    go modify1(\"A\", channelA)\n    go modify2(\"B\", channelB)\n    go modify3(\"C\", channelC)\n\n    b := append(&lt;-channelA, &lt;-channelB...)\n    b = append(b, &lt;-channelC...)\n    fmt.Println(b)\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>Adding inside: C\nAdding inside: A\nAdding inside: B\n..snip..\nAdding inside: C\nAdding inside: C\nAdding inside: C\n[{0 0} {1 0} {2 0} {3 0} {4 0} {5 0} {6 0} {7 0} {8 0} {9 0} {10 0} {11 0} {12 0} {13 0} {14 0} {15 0} {16 0} {17 0} {18 0} {19 0} {20 0} {21 0} {22 0} {23 0} {24 0} {25 0} {26 0} {27 0} {28 0} {29 0}]\n</code></pre>\n\n<p>However, I would like to achieve something like this: <a href=\"https://play.golang.org/p/qvC88LwkanY\" rel=\"nofollow noreferrer\">https://play.golang.org/p/qvC88LwkanY</a>\n<strong>Output:</strong></p>\n\n<pre><code>Adding inside: C\nAdding inside: A\nAdding inside: B\n..snip\nAdding inside: B\nAdding inside: A\nAdding inside: C\n[{0 0} {1 0} {2 0} {3 0} {4 0} {5 0} {6 0} {7 0} {8 0} {9 0}]\n</code></pre>\n\n<p>but as shown the functions modify2 &amp; modify3 visually seems like they never get added.</p>\n\n<p>Is this possible, or is the top sample more feasible?</p>\n"}]