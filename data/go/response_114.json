[{"tags": ["unit-testing", "testing", "go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1489617722, "post_id": 42822036, "comment_id": 72755760, "body": "For that reason one of the practices is to put mocks in a separate package <a href=\"https://medium.com/@benbjohnson/standard-package-layout-7cdbc8391fc1#f68c\" rel=\"nofollow noreferrer\">medium.com/@benbjohnson/&hellip;</a> (see #3)"}, {"owner": {"reputation": 5142, "user_id": 169252, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f87a0e2badc0703de4d0a171a9bb4fa5?s=128&d=identicon&r=PG&f=1", "display_name": "transient_loop", "link": "https://stackoverflow.com/users/169252/transient-loop"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489618715, "post_id": 42822036, "comment_id": 72756185, "body": "thanks @zerkms, basically same answer as MahlerFive...."}], "answers": [{"tags": [], "owner": {"reputation": 4669, "user_id": 63814, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/607eab54ab44ecd7ebefa443e1925596?s=128&d=identicon&r=PG", "display_name": "MahlerFive", "link": "https://stackoverflow.com/users/63814/mahlerfive"}, "is_accepted": true, "score": 3, "last_activity_date": 1489618294, "creation_date": 1489618294, "answer_id": 42822208, "question_id": 42822036, "link": "https://stackoverflow.com/questions/42822036/define-a-struct-for-test-go-files-only/42822208#42822208", "title": "Define a struct for _test.go files only", "body": "<p>If you need the mock in two different packages, the mock can't exist in a test file (a file ending in <code>_test.go</code>).</p>\n\n<p>If you don't care where the mocks are used, then just create a <code>mock</code> package and put there.</p>\n\n<pre><code>-app/\n---tool/\n-----mock/\n-------/dummyretriever.go\n-------/othermock.go\n-----/tool_test.go\n-----/tool.go\n-----/proto/proto.go\n-----/proto/proto_test.go\n</code></pre>\n\n<p>If you only want the mocks to be used from that package or its descendants, then put it in the <code>internal</code> package.</p>\n\n<pre><code>-app/\n---tool/\n-----internal/\n-------/dummyretriever.go\n-------/othermock.go\n-----/tool_test.go\n-----/tool.go\n-----/proto/proto.go\n-----/proto/proto_test.go\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "is_accepted": false, "score": -1, "last_activity_date": 1490700891, "last_edit_date": 1490700891, "creation_date": 1489626030, "answer_id": 42823473, "question_id": 42822036, "link": "https://stackoverflow.com/questions/42822036/define-a-struct-for-test-go-files-only/42823473#42823473", "title": "Define a struct for _test.go files only", "body": "<p>If you don't need to test unexposed functions, you can use the <code>&lt;package&gt;_test</code> package in all of your tests.</p>\n\n<p>Edit: I don't understand these downvotes. <a href=\"https://golang.org/src/strings/strings_test.go\" rel=\"nofollow noreferrer\">You can find the practice in the standard library.</a></p>\n"}], "owner": {"reputation": 5142, "user_id": 169252, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f87a0e2badc0703de4d0a171a9bb4fa5?s=128&d=identicon&r=PG&f=1", "display_name": "transient_loop", "link": "https://stackoverflow.com/users/169252/transient-loop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 42822208, "answer_count": 2, "score": 2, "last_activity_date": 1490700891, "creation_date": 1489617476, "last_edit_date": 1489660960, "question_id": 42822036, "link": "https://stackoverflow.com/questions/42822036/define-a-struct-for-test-go-files-only", "title": "Define a struct for _test.go files only", "body": "<p>I have the following tree structure of files:</p>\n\n<pre><code>-app/\n---tool/\n-----/tool_test.go\n-----/tool.go\n-----/proto/proto.go\n-----/proto/proto_test.go\n</code></pre>\n\n<p>I need to use a (dummy) struct implementing an interface in both <code>tool_test.go</code> and <code>proto_test.go</code>:</p>\n\n<pre><code>type DummyRetriever struct{}\n\nfunc (dummy *DummyRetriever) Retrieve(name string) (string, error) {\n  return \"\", nil \n}\n</code></pre>\n\n<p>If I define it in <code>tool_test.go</code> only, I can't see and use it in <code>proto_test.go</code>, as _test.go files don't export names.</p>\n\n<p>Where do I define the <code>DummyRetriever</code> so that it is available in both packages? \nI want to avoid having it to define in a file so that the name is then also visible in core (non-test) packages.</p>\n"}, {"tags": ["design-patterns", "go", "dispatcher", "goroutine"], "comments": [{"owner": {"reputation": 1642, "user_id": 1509169, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/8MgOC.jpg?s=128&g=1", "display_name": "Alexander R.", "link": "https://stackoverflow.com/users/1509169/alexander-r"}, "edited": false, "score": 1, "creation_date": 1489622877, "post_id": 42821994, "comment_id": 72757567, "body": "Do you really need channel to be used like &quot;workers pool&quot;? Why simply not to use a single channel with messages, and as many as you need workers that will receive messages, and will send it to related &quot;processor function&quot; by extracted message type?"}, {"owner": {"reputation": 7330, "user_id": 857130, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/14587548e8d7d57ea1557af4583715b2?s=128&d=identicon&r=PG", "display_name": "perigee", "link": "https://stackoverflow.com/users/857130/perigee"}, "reply_to_user": {"reputation": 1642, "user_id": 1509169, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/8MgOC.jpg?s=128&g=1", "display_name": "Alexander R.", "link": "https://stackoverflow.com/users/1509169/alexander-r"}, "edited": false, "score": 1, "creation_date": 1489643672, "post_id": 42821994, "comment_id": 72763269, "body": "maybe the worker pool part is little bit over-engineering :("}, {"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 2, "creation_date": 1489668273, "post_id": 42821994, "comment_id": 72778156, "body": "Why don&#39;t you just launch a new groutine each time you get a message of that they? Whats the advantage of having a dedicated worker which waits around to do work?"}], "owner": {"reputation": 7330, "user_id": 857130, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/14587548e8d7d57ea1557af4583715b2?s=128&d=identicon&r=PG", "display_name": "perigee", "link": "https://stackoverflow.com/users/857130/perigee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 856, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489619752, "creation_date": 1489617322, "last_edit_date": 1489619752, "question_id": 42821994, "link": "https://stackoverflow.com/questions/42821994/golang-dispatcher-using-map-and-channels", "title": "golang dispatcher using map and channels", "body": "<p>I try design a dispatcher using go in a concurrency situation, the dispatcher needs to dispatch the message to its dedicated worker which only treat one kind of messages (or workers), ex:</p>\n\n<ul>\n<li>worker type A only processes the message type A</li>\n<li>worker type B only processes the message type B</li>\n<li>etc.,</li>\n</ul>\n\n<p>As I can add/remove dynamically the dedicated worker treating different types of messages. Now I need a message pattern to do so with only goroutine and channel. I plan to have a channel -- a pool of same type workers, and put the channels in a map, so I can distribute message by type according to the keys in map, if the worker for treating message C is not exist, it will just dispatch the message to garbage channel for non-treating, and the same type of workers can process the same type of messages concurrently.  I am not sure if it is a better design or not, any suggestion? </p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 3670618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5163df95a8d12d89630ea8798acf1e?s=128&d=identicon&r=PG&f=1", "display_name": "user3670618", "link": "https://stackoverflow.com/users/3670618/user3670618"}, "edited": false, "score": 0, "creation_date": 1489621027, "post_id": 42821986, "comment_id": 72757008, "body": "Hi Ben, Thanks for the response. Yes, directly use &amp;publish.Book{...} works. But I&#39;m wondering why I cannot make a local instance: var reading publish.Book, and then &amp;reading{...} ??"}, {"owner": {"reputation": 711, "user_id": 809102, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/062b1d54e88e8b951cc73e47eb12c601?s=128&d=identicon&r=PG", "display_name": "Treesrule14", "link": "https://stackoverflow.com/users/809102/treesrule14"}, "edited": false, "score": 1, "creation_date": 1489628119, "post_id": 42821986, "comment_id": 72758841, "body": "var reading publish.Book declares a variable of Book, it doesn&#39;t create an alias of that type. If you want you can assign to the elements of reading using reading.Name = &quot;Learn Go Lang&quot; etc..."}, {"owner": {"reputation": 51, "user_id": 3670618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5163df95a8d12d89630ea8798acf1e?s=128&d=identicon&r=PG&f=1", "display_name": "user3670618", "link": "https://stackoverflow.com/users/3670618/user3670618"}, "edited": false, "score": 0, "creation_date": 1491328398, "post_id": 42821986, "comment_id": 73500186, "body": "what does &quot;a variable of Book&quot; mean? if it does not equivalent to alias or instance of that type?"}, {"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1491332847, "post_id": 42821986, "comment_id": 73502778, "body": "alias and instance are not equivalent. An Alias is a renaming of a type. You can have multiple instances of the same type. (I meant a variable of type book)."}], "tags": [], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "is_accepted": false, "score": 4, "last_activity_date": 1489617289, "creation_date": 1489617289, "answer_id": 42821986, "question_id": 42821934, "link": "https://stackoverflow.com/questions/42821934/import-struct-in-go-get-not-a-type-error/42821986#42821986", "title": "import struct in go, get &quot;not a type&quot; error", "body": "<p>Here you try to make a struct of Type \"reading\"</p>\n\n<pre><code>b := &amp;reading {\n       Name: \"Learn Go Lang\",\n       Author: \"Rob\",\n       Published: true\n    }\n</code></pre>\n\n<p>What you want is a struct of type publish.Book</p>\n\n<pre><code>b := &amp; publish.Book {\n       Name: \"Learn Go Lang\",\n       Author: \"Rob\",\n       Published: true,\n    }\n</code></pre>\n\n<p>plus you also need a comma at the end of the last in a multi-line struct declaration.  </p>\n"}], "owner": {"reputation": 51, "user_id": 3670618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5163df95a8d12d89630ea8798acf1e?s=128&d=identicon&r=PG&f=1", "display_name": "user3670618", "link": "https://stackoverflow.com/users/3670618/user3670618"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7305, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1489617289, "creation_date": 1489617051, "question_id": 42821934, "link": "https://stackoverflow.com/questions/42821934/import-struct-in-go-get-not-a-type-error", "title": "import struct in go, get &quot;not a type&quot; error", "body": "<p>I import a struct defined in another package, when try to use it to construct a literal, get a \"not a type\" error.</p>\n\n<p>In publish.go</p>\n\n<pre><code>type Book struct {\n    Name string\n    Author string\n    Published bool\n}\n</code></pre>\n\n<p>In store.go</p>\n\n<pre><code>import \"publish\"\n\nfunc Init() {\n    var reading publish.Book\n\n    b := &amp;reading {\n        Name: \"Learn Go Lang\",\n        Author: \"Rob\",\n        Published: true\n    }\n}\n</code></pre>\n\n<p>Error: reading is not a type</p>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1598317889, "post_id": 42821792, "comment_id": 112413090, "body": "It may be worth noting that APIs that take in a one-method <code>interface</code> could be re-written as taking a function type. See <a href=\"https://stackoverflow.com/a/63557675/12817546\">stackoverflow.com/a/63557675/12817546</a>."}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 1, "last_activity_date": 1489616606, "creation_date": 1489616606, "answer_id": 42821834, "question_id": 42821792, "link": "https://stackoverflow.com/questions/42821792/combining-or-extending-interfaces/42821834#42821834", "title": "Combining or extending interfaces?", "body": "<p>Interface embedding is allowed, as documented in the <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow noreferrer\">spec</a>:</p>\n\n<blockquote>\n  <p>An interface <code>T</code> may use a (possibly qualified) interface type name <code>E</code> in place of a method specification. This is called <em>embedding</em> interface <code>E</code> in <code>T</code>; it adds all (exported and non-exported) methods of <code>E</code> to the interface <code>T</code>.</p>\n</blockquote>\n\n<p>This is done throughout Go's standard library (one example is <a href=\"https://godoc.org/io#ReadCloser\" rel=\"nofollow noreferrer\"><code>io.ReadCloser</code></a>).</p>\n\n<p>In your question, <code>RequestResponder</code> would be constructed as:</p>\n\n<pre><code>type RequestResponder interface {\n    Request\n    Responder\n}\n</code></pre>\n"}], "owner": {"reputation": 4700, "user_id": 1470961, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/28216f158ce772dd67fcee384406b2c9?s=128&d=identicon&r=PG", "display_name": "Elliot Chance", "link": "https://stackoverflow.com/users/1470961/elliot-chance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 42821834, "answer_count": 1, "score": 2, "last_activity_date": 1489616815, "creation_date": 1489616440, "last_edit_date": 1489616815, "question_id": 42821792, "link": "https://stackoverflow.com/questions/42821792/combining-or-extending-interfaces", "title": "Combining or extending interfaces?", "body": "<p>I have two interfaces:</p>\n\n<pre><code>type Request interface {\n    Version() string\n    Method() string\n    Params() interface{}\n    Id() interface{}\n}\n\ntype Responder interface {\n    NewSuccessResponse() Response\n    NewErrorResponse() Response\n}\n</code></pre>\n\n<p>I would like to make a <code>RequestResponder</code> interface which combines both of these. Is this possible, or do I have to create a third interface with all 6 functions?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1489612935, "post_id": 42820880, "comment_id": 72753596, "body": "Don&#39;t set GOROOT."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1489646155, "post_id": 42820880, "comment_id": 72764252, "body": "What does your <code>go env</code> show with regard to <code>GOROOT</code> variable? Judging from your setting of the <code>PATH</code> env. variable you messed with the <code>GOROOT</code>--supposedly setting it to the same value your <code>GOPATH</code> has. That&#39;s plain wrong: since aeons ago, the <code>go</code> tool has the correct idea about the value of <code>GOROOT</code> automagically."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1489646267, "post_id": 42820880, "comment_id": 72764297, "body": "By the way, you don&#39;t need <code>$GOROOT&#47;bin</code> in your <code>PATH</code> either: if you want to call any Go&#39;s inernal binary directly, the way to do that is to use <code>go tool &lt;toolname&gt;</code>: run <code>go tool</code> w/o arguments to see the list of what&#39;s available."}], "answers": [{"tags": [], "owner": {"reputation": 1464, "user_id": 520516, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/KaRoZ.png?s=128&g=1", "display_name": "David Dias", "link": "https://stackoverflow.com/users/520516/david-dias"}, "is_accepted": false, "score": 1, "last_activity_date": 1491431129, "creation_date": 1491431129, "answer_id": 43242652, "question_id": 42820880, "link": "https://stackoverflow.com/questions/42820880/unable-to-install-ipfs/43242652#43242652", "title": "Unable to install ipfs", "body": "<p>Install instructions can be found at the README.md <a href=\"https://github.com/ipfs/go-ipfs#install\" rel=\"nofollow noreferrer\">https://github.com/ipfs/go-ipfs#install</a> </p>\n\n<p>To compile from source, do:</p>\n\n<pre><code>  $ go get -u -d github.com/ipfs/go-ipfs\n\n  $ cd $GOPATH/src/github.com/ipfs/go-ipfs\n  $ make install\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 156, "user_id": 5156780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0131768a658dd8dba57844e84d2d9839?s=128&d=identicon&r=PG&f=1", "display_name": "Preet", "link": "https://stackoverflow.com/users/5156780/preet"}, "is_accepted": false, "score": 1, "last_activity_date": 1519021315, "creation_date": 1519021315, "answer_id": 48860524, "question_id": 42820880, "link": "https://stackoverflow.com/questions/42820880/unable-to-install-ipfs/48860524#48860524", "title": "Unable to install ipfs", "body": "<p>Just to make everything clear. Following are the only things you need to do( don't set GOROOT)</p>\n\n<ol>\n<li>Set environment</li>\n</ol>\n\n<blockquote>\n  <p>export PATH=$PATH:/usr/local/go/bin<br> export PATH=$PATH:$GOPATH/bin</p>\n</blockquote>\n\n<ol start=\"2\">\n<li>Install IPFS from source</li>\n</ol>\n\n<blockquote>\n<pre><code>$ go get -u -d github.com/ipfs/go-ipfs\n\n$ cd $GOPATH/src/github.com/ipfs/go-ipfs&lt;br&gt;\n$ make install\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 15223, "user_id": 364312, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a9d9ccf351e01162fbe6fc962b5e79db?s=128&d=identicon&r=PG", "display_name": "oshirowanen", "link": "https://stackoverflow.com/users/364312/oshirowanen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 621, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519021315, "creation_date": 1489612805, "last_edit_date": 1489646314, "question_id": 42820880, "link": "https://stackoverflow.com/questions/42820880/unable-to-install-ipfs", "title": "Unable to install ipfs", "body": "<p>I'm trying to download ipfs on ubuntu so I can use it with golang.</p>\n\n<p>I'm using the following command:</p>\n\n<pre><code>go get -d github.com/ipfs/go-ipfs\n</code></pre>\n\n<p>But that gives me the following error message:</p>\n\n<pre><code>package github.com/ipfs/go-ipfs\n    imports runtime: cannot find package \"runtime\" in any of:\n    /home/userone/go/src/runtime (from $GOROOT)\n    /home/userone/gostuff/src/runtime (from $GOPATH)\n</code></pre>\n\n<p>I have added the following lines at the end of the file <code>~/.bashrc</code></p>\n\n<pre><code>export GOPATH=$HOME/go\nexport PATH=$PATH:$GOROOT/bin:$GOPATH/bin\n</code></pre>\n\n<p>I am using Ubuntu 16.04 and I installed golang using the following command</p>\n\n<pre><code>sudo aptitude install golang-go git\n</code></pre>\n\n<p>Why am I getting that error message?</p>\n"}, {"tags": ["go", "error-handling"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489612580, "post_id": 42820702, "comment_id": 72753415, "body": "I think what that site is getting at is keeping the errors local to the call. Using <code>err1</code>, <code>err2</code>, <code>err3</code>, implies that you have a reason to initialize a new error value each time for comparison later, which leads to confusing error handling."}, {"owner": {"reputation": 1642, "user_id": 1509169, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/8MgOC.jpg?s=128&g=1", "display_name": "Alexander R.", "link": "https://stackoverflow.com/users/1509169/alexander-r"}, "edited": false, "score": 1, "creation_date": 1489622430, "post_id": 42820702, "comment_id": 72757449, "body": "Yes, it looks painful when you write such code in GO. But, if you want to build a stable software instead of spending lot of time for debugging and finding errors after some programmers wrote tons of code ignoring any errors. It something may fail, it&#39;ll fail. My suggest is to check every error and log it. Later you will say thanks to yourself for doing this."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1489642918, "post_id": 42820702, "comment_id": 72763029, "body": "&quot;However, it&#39;s obvious this gets VERY unruly very quickly for a large number of these calls&quot; No it does not. You have 3 different &quot;failure&quot; path and need to handle them. Doing this is not &quot;very unruly&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "is_accepted": true, "score": 1, "last_activity_date": 1489616513, "creation_date": 1489616513, "answer_id": 42821812, "question_id": 42820702, "link": "https://stackoverflow.com/questions/42820702/properly-handling-errors/42821812#42821812", "title": "Properly handling errors", "body": "<p>Unfortunately there's sometimes no way around these patterns. You <em>could</em> use panic/defer as a makeshift try/catch system but the community looks down upon it.</p>\n\n<p>If statements in Go can be combined with assignments so </p>\n\n<pre><code>err := thing.Do()\nif err != nil {\n   return err\n}\n</code></pre>\n\n<p>can become</p>\n\n<pre><code>if err := thing.Do(); err != nil {\n   return err\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6467981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 42821812, "answer_count": 1, "score": 1, "last_activity_date": 1489616513, "creation_date": 1489612122, "question_id": 42820702, "link": "https://stackoverflow.com/questions/42820702/properly-handling-errors", "title": "Properly handling errors", "body": "<p>Typically in Go you find the following convention:</p>\n\n<pre><code>res, err := thingThatCanError(arg)\n\nif err != nil {\n        // handle it\n}\n</code></pre>\n\n<p>However, it's obvious this gets VERY unruly very quickly for a large number of these calls:</p>\n\n<pre><code>res, err := thingThatCanError(arg)\n\nif err != nil {\n        // handle it\n}\n\nres, err2 := thingThatCanError(arg)\n\nif err2 != nil {\n        // handle it\n}\n\nres, err3 := thingThatCanError(arg)\n\nif err3 != nil {\n        // handle it\n}\n</code></pre>\n\n<p>There's more lines of boilerplate error handling than code! <a href=\"http://www.golangpatterns.info/error-handling\" rel=\"nofollow noreferrer\">This website</a> says to <em>avoid</em> this but does not give an example on how to clean up this smell. A useful example comes straight from the <a href=\"https://blog.golang.org/error-handling-and-go\" rel=\"nofollow noreferrer\">Go blog</a> that shows us how to clean up a homogenous HTTP app with an error handler that makes sense.</p>\n\n<p>But imagine each of these calls aren't homogenous, as in with the same \"central idea\", so a single \"error handler struct\" wouldn't make a lot of sense.</p>\n\n<p>Is there a way to clean up this type of code smell with functions that don't \"mesh together\" nicely in terms of errors?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 473, "user_id": 3273138, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/mFU9l.jpg?s=128&g=1", "display_name": "Conner", "link": "https://stackoverflow.com/users/3273138/conner"}, "edited": false, "score": 1, "creation_date": 1489628129, "post_id": 42820620, "comment_id": 72758844, "body": "I tried some of the answers below and it seems that maps formed within structs are not recognized/lost by json.Marshal - <a href=\"https://play.golang.org/p/5-yQvqi14Q\" rel=\"nofollow noreferrer\">playground</a>"}, {"owner": {"reputation": 711, "user_id": 809102, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/062b1d54e88e8b951cc73e47eb12c601?s=128&d=identicon&r=PG", "display_name": "Treesrule14", "link": "https://stackoverflow.com/users/809102/treesrule14"}, "edited": false, "score": 1, "creation_date": 1489636036, "post_id": 42820620, "comment_id": 72760904, "body": "Make those fields exportable <a href=\"https://play.golang.org/p/x8TOcjcj7T\" rel=\"nofollow noreferrer\">play.golang.org/p/x8TOcjcj7T</a>"}], "answers": [{"comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1489623978, "post_id": 42820861, "comment_id": 72757857, "body": "since 1.7 <code>encoding&#47;json</code> supports map keys with integer types or keys that implement the <code>encoding.TextMarhsaler&#47;TextUnmarshaler</code> interface. <a href=\"https://golang.org/doc/go1.7#encoding_json\" rel=\"nofollow noreferrer\">release notes</a>, <a href=\"https://github.com/golang/go/commit/f05c3aa24d815cd3869153750c9875e35fc48a6e\" rel=\"nofollow noreferrer\">commit</a>"}], "tags": [], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "is_accepted": false, "score": 1, "last_activity_date": 1489665583, "last_edit_date": 1489665583, "creation_date": 1489612716, "answer_id": 42820861, "question_id": 42820620, "link": "https://stackoverflow.com/questions/42820620/map-of-struct-from-json-in-golang/42820861#42820861", "title": "Map of Struct from json in Golang", "body": "<p>Edit: Yes you can. (an earlier version of this answer stated keys can only be strings, but as of 1.7 this is not true) </p>\n\n<p>You can see this in action <a href=\"https://play.golang.org/p/Hq4LDBpmVH\" rel=\"nofollow noreferrer\">with this playground</a> </p>\n\n<p>Also as conner points out in the comments your field names will have to be exportable for encoding/json to work</p>\n\n<pre><code>type Station struct {\n    ID       int64            `json:\"id,string\"`\n    ArrTrain map[string]train `json:\"arr\"`\n    DepTrain map[string]train `json:\"dep\"`\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1107, "user_id": 2356861, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f4dbcbb819e6e60fdc78b2a6b9d9f46?s=128&d=identicon&r=PG", "display_name": "RexFuzzle", "link": "https://stackoverflow.com/users/2356861/rexfuzzle"}, "edited": false, "score": 0, "creation_date": 1489635992, "post_id": 42821265, "comment_id": 72760895, "body": "Ah, I see, thank you. Unfortunately, my json has the form &quot;arr&quot;:[{},{}], i.e. the key is not outside the individual item."}, {"owner": {"reputation": 86, "user_id": 2986516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2828643fe010f7f8296666af00d075c6?s=128&d=identicon&r=PG&f=1", "display_name": "netdigger", "link": "https://stackoverflow.com/users/2986516/netdigger"}, "reply_to_user": {"reputation": 1107, "user_id": 2356861, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f4dbcbb819e6e60fdc78b2a6b9d9f46?s=128&d=identicon&r=PG", "display_name": "RexFuzzle", "link": "https://stackoverflow.com/users/2356861/rexfuzzle"}, "edited": false, "score": 0, "creation_date": 1489660218, "post_id": 42821265, "comment_id": 72772502, "body": "@RexFuzzle Base on this information, I think the best way is defining UnmarshalJSON function for Station struct."}, {"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1489669599, "post_id": 42821265, "comment_id": 72779129, "body": "@netdigger see my answer but make the field names capitalized."}], "tags": [], "owner": {"reputation": 86, "user_id": 2986516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2828643fe010f7f8296666af00d075c6?s=128&d=identicon&r=PG&f=1", "display_name": "netdigger", "link": "https://stackoverflow.com/users/2986516/netdigger"}, "is_accepted": true, "score": 2, "last_activity_date": 1489614289, "creation_date": 1489614289, "answer_id": 42821265, "question_id": 42820620, "link": "https://stackoverflow.com/questions/42820620/map-of-struct-from-json-in-golang/42821265#42821265", "title": "Map of Struct from json in Golang", "body": "<p>Yes, you can define station like this:</p>\n\n<pre><code>type Station struct {\n    ID       int64            `json:\"id,string\"`\n    arrTrain map[string]train `json:\"arr\"`\n    depTrain map[string]train `json:\"dep\"`\n}\n</code></pre>\n\n<p>And your JSON should like this</p>\n\n<pre><code>{\n  \"id\":1, \n  \"arr\": {\n    \"one\":{\"id\":\"one\",\"price\":\"$10.1\",\"Distance\":\"100km\"},\n    \"two\":...\n  },\n  \"dep\":{\n    \"one\":{\"id\":\"one\",\"price\":\"$10.1\",\"Distance\":\"100km\"},\n    \"two\":...\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 1107, "user_id": 2356861, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f4dbcbb819e6e60fdc78b2a6b9d9f46?s=128&d=identicon&r=PG", "display_name": "RexFuzzle", "link": "https://stackoverflow.com/users/2356861/rexfuzzle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5061, "favorite_count": 2, "accepted_answer_id": 42821265, "answer_count": 2, "score": 2, "last_activity_date": 1489665583, "creation_date": 1489611765, "last_edit_date": 1489637228, "question_id": 42820620, "link": "https://stackoverflow.com/questions/42820620/map-of-struct-from-json-in-golang", "title": "Map of Struct from json in Golang", "body": "<p>So I am trying to parse a json into some structs and that works ok with the following:</p>\n\n<pre><code>type train struct {\n ID     string  `json:\"id\"`\n Price  float64 `json:\"price,string\"`\n Distance float64 `json:\"Distance,string\"`\n}\n\ntype Station struct {\n ID       int64  `json:\"id,string\"`\n arrTrain []train`json:\"arr\"`\n depTrain []train`json:\"dep\"`\n}\n</code></pre>\n\n<p>The problem, however, is that I would like to easily be able to reference the items in arrTrain and depTrain using their ID, so I think I need to change the Station struct to have arrTrain and depTrain as maps with the ID as the key. Is this possible when parsing the json or does it have to be 'post-processed'?</p>\n\n<p>EDIT:\nAs stated in one of the comments, unfortunately my json is in the following form:</p>\n\n<pre><code>{\n  \"id\":1, \n  \"arr\": [\n     {\"id\":\"one\",\"price\":\"$10.1\",\"Distance\":\"100km\"},\n     {...}\n  ],\n  \"dep\":[\n    {\"id\":\"one\",\"price\":\"$10.1\",\"Distance\":\"100km\"},\n    {...}\n  ]\n}\n</code></pre>\n\n<p>In other words the ID is not on the outside of the json object and arrTrain is list.</p>\n"}, {"tags": ["go", "redis"], "comments": [{"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1489611884, "post_id": 42820547, "comment_id": 72753052, "body": "Can you also show the command to run the data?"}, {"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1489612312, "post_id": 42820547, "comment_id": 72753260, "body": "@CeriseLim&#243;n I updated <code>DialURL</code> with the explicit value."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1489612716, "post_id": 42820547, "comment_id": 72753482, "body": "The URL does not match <a href=\"https://www.iana.org/assignments/uri-schemes/prov/redis\" rel=\"nofollow noreferrer\">the redis URI scheme specification</a>. The userinfo field should be in the format  &quot;user:password&quot;."}, {"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "reply_to_user": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 1, "creation_date": 1489612740, "post_id": 42820547, "comment_id": 72753501, "body": "@BenjaminKadish I added the code that retrieves the data, I commented on top of the line where the error occurs."}, {"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1489619266, "post_id": 42820547, "comment_id": 72756400, "body": "@CeriseLim&#243;n you are right. I saw the URI scheme before posting here. But the URI I used worked with Java&#39;s lettuce so I figured it would work everywhere. I was wrong. Please post an answer and I&#39;ll accept it."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1489620630, "creation_date": 1489620630, "answer_id": 42822672, "question_id": 42820547, "link": "https://stackoverflow.com/questions/42820547/go-and-redisgo-dialurl-error-noauth-authentication-required/42822672#42822672", "title": "Go and Redisgo: DialURL error: NOAUTH Authentication required", "body": "<p>The URL does not match the <a href=\"https://www.iana.org/assignments/uri-schemes/prov/redis\" rel=\"nofollow noreferrer\">redis URI scheme specification</a>. The userinfo field should be in the format \"user:password\"</p>\n"}], "owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1293, "favorite_count": 0, "accepted_answer_id": 42822672, "answer_count": 1, "score": 0, "last_activity_date": 1489620630, "creation_date": 1489611462, "last_edit_date": 1489612709, "question_id": 42820547, "link": "https://stackoverflow.com/questions/42820547/go-and-redisgo-dialurl-error-noauth-authentication-required", "title": "Go and Redisgo: DialURL error: NOAUTH Authentication required", "body": "<p>I'm trying to connect to my Redis server using Go and <a href=\"https://github.com/garyburd/redigo\" rel=\"nofollow noreferrer\">redigo</a> with a URI that works on another application, written in Java with <a href=\"https://github.com/mp911de/lettuce\" rel=\"nofollow noreferrer\">lettuce</a>. On the Go project, I'm getting the error</p>\n\n<blockquote>\n  <p>NOAUTH Authentication required.</p>\n</blockquote>\n\n<p>My <code>redis.conf</code> has <code>requirepass true</code>, and I pass the password in the URI. Here's how I connect:</p>\n\n<pre><code>conn, err := redis.DialURL(\"redis://MySecurePassword@localhost:6666/0\")\n    if err != nil {\n        log.Fatal(\"Not able to connect to Redis\")\n    }\n</code></pre>\n\n<p>No errors there. The error shows when I try to run a command to retrieve data.</p>\n\n<pre><code>writeOrErr(&amp;b, conn, \"HGETALL\", \"mykey\")\n\n// Wrapper for redis.Conn.Do that writes the result to a buffer or reports the error\nfunc writeOrErr(b *bytes.Buffer, conn redis.Conn, cmd string, key string) string {\n    result, err := conn.Do(cmd, key)\n    if err != nil {\n        // !!! THE ERROR HAPPENS HERE !!!\n        log.Fatalf(\"Couldn't run %s \\\"%s\\\" | Error: %s\", cmd, key, err.Error())\n    }\n\n    // Retrieve data\n    _, err = b.WriteString(result.(string))\n    if err != nil {\n        log.Fatal(\"Couldn't write result to string for \" + key)\n    }\n\n    return result.(string)\n}\n</code></pre>\n\n<p>Am I using <em>redigo</em>'s API improperly? How can I make it connect?</p>\n"}, {"tags": ["go", "reverse-engineering"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1489607332, "post_id": 42819318, "comment_id": 72750479, "body": "To confirm: at runtime, you would like to generate the Go source code representation of some type, recursively expanding the struct types. Is that correct?"}, {"owner": {"reputation": 265968, "user_id": 116, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f6flX.jpg?s=128&g=1", "display_name": "Mark Harrison", "link": "https://stackoverflow.com/users/116/mark-harrison"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1489607488, "post_id": 42819318, "comment_id": 72750556, "body": "Not necessarily at runtime, although that would be fine.  I&#39;ve got some high level containers, and I just want to understand all the things that are getting put into them."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1489607798, "post_id": 42819318, "comment_id": 72750760, "body": "If you want to display the value, I often use <a href=\"https://godoc.org/github.com/davecgh/go-spew/spew\" rel=\"nofollow noreferrer\">spew</a>. If you want to walk through the values in the source, I just jump to the definition of each type in my editor as I come to it."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1489609115, "post_id": 42819318, "comment_id": 72751456, "body": "Wait are you asking how to achieve this as output during runtime or how to modify the syntax of your source such that <code>Bar</code> is defined within <code>Foo</code> but not independently?"}, {"owner": {"reputation": 265968, "user_id": 116, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f6flX.jpg?s=128&g=1", "display_name": "Mark Harrison", "link": "https://stackoverflow.com/users/116/mark-harrison"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1489618166, "post_id": 42819318, "comment_id": 72755940, "body": "@evanmcdonnal No, I&#39;m just interested in seeing all of the data in the container data structure in order to understand what the program is doing."}], "answers": [{"comments": [{"owner": {"reputation": 265968, "user_id": 116, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f6flX.jpg?s=128&g=1", "display_name": "Mark Harrison", "link": "https://stackoverflow.com/users/116/mark-harrison"}, "edited": false, "score": 0, "creation_date": 1489638656, "post_id": 42824848, "comment_id": 72761600, "body": "This is just what I was looking for.  Much appreciated!"}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 2, "last_activity_date": 1489636184, "last_edit_date": 1489636184, "creation_date": 1489635382, "answer_id": 42824848, "question_id": 42819318, "link": "https://stackoverflow.com/questions/42819318/recursively-expanding-struct-definition/42824848#42824848", "title": "Recursively expanding struct definition?", "body": "<p>You can try something along these lines to list all fields defined in a struct, recursively listing structs found in the way.</p>\n\n<p>It does not produce exactly the output you asked for but it's pretty close and can probably be adapted to do so.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main \n\nimport (\n    \"reflect\"\n    \"fmt\"\n)\n\ntype Foo struct {\n  x int\n  y []string\n  z Bar\n}\ntype Bar struct {\n  a int\n  b string\n}\n\nfunc printFields(prefix string, t reflect.Type) {\n    for i := 0; i &lt; t.NumField(); i++ {\n        f := t.Field(i)\n        fmt.Printf(\"%v%v %v\\n\", prefix, f.Name, f.Type)\n        if f.Type.Kind() == reflect.Struct {\n            printFields(fmt.Sprintf(\"  %v\", prefix), f.Type)\n        }\n    }    \n}\n\nfunc printExpandedStruct(s interface{}) {\n    printFields(\"\", reflect.ValueOf(s).Type())\n}\n\nfunc main() {\n    printExpandedStruct(Foo{})\n}\n</code></pre>\n\n<p>I get this output as a result of the above:</p>\n\n<pre><code>x int\ny []string\nz main.Bar\n  a int\n  b string\n</code></pre>\n"}], "owner": {"reputation": 265968, "user_id": 116, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f6flX.jpg?s=128&g=1", "display_name": "Mark Harrison", "link": "https://stackoverflow.com/users/116/mark-harrison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 42824848, "answer_count": 1, "score": 2, "last_activity_date": 1489636184, "creation_date": 1489607147, "last_edit_date": 1489607827, "question_id": 42819318, "link": "https://stackoverflow.com/questions/42819318/recursively-expanding-struct-definition", "title": "Recursively expanding struct definition?", "body": "<p>How can expand a structure definition to show nested types?  For example, I would like to expand this</p>\n\n<pre><code>type Foo struct {\n  x int\n  y []string\n  z Bar\n}\ntype Bar struct {\n  a int\n  b string\n}\n</code></pre>\n\n<p>to something like this:</p>\n\n<pre><code>type Foo struct {\n  x int\n  y []string\n  z Bar\n    struct {\n      a int\n      b string\n    }\n}\n</code></pre>\n\n<p>context: reverse engineering existing code.</p>\n"}, {"tags": ["go", "command-line-interface", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 7287171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4016b6b10294ce9a446d7d74e0c77991?s=128&d=identicon&r=PG&f=1", "display_name": "Liz Furlan", "link": "https://stackoverflow.com/users/7287171/liz-furlan"}, "edited": false, "score": 0, "creation_date": 1489606541, "post_id": 42818952, "comment_id": 72749967, "body": "Thanks for the quick response! But doesn&#39;t that just end the goroutine? I&#39;ve tried that before and I get the same command line output."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 73, "user_id": 7287171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4016b6b10294ce9a446d7d74e0c77991?s=128&d=identicon&r=PG&f=1", "display_name": "Liz Furlan", "link": "https://stackoverflow.com/users/7287171/liz-furlan"}, "edited": false, "score": 0, "creation_date": 1489606676, "post_id": 42818952, "comment_id": 72750072, "body": "@LizFurlan: from the docs: <code>The program terminates immediately;</code>. Nothing else will run after that point."}, {"owner": {"reputation": 73, "user_id": 7287171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4016b6b10294ce9a446d7d74e0c77991?s=128&d=identicon&r=PG&f=1", "display_name": "Liz Furlan", "link": "https://stackoverflow.com/users/7287171/liz-furlan"}, "edited": false, "score": 0, "creation_date": 1489609688, "post_id": 42818952, "comment_id": 72751778, "body": "oh, I see the issue now. <code>os.Exit(2)</code> does work (thank you!) but it isn&#39;t happening until after everything else gets executed (i.e. &quot;the end&quot; is printed) - do you know if there is a way I can force <code>cleanup()</code> and <code>os.Exit(2)</code> to happen together?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 73, "user_id": 7287171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4016b6b10294ce9a446d7d74e0c77991?s=128&d=identicon&r=PG&f=1", "display_name": "Liz Furlan", "link": "https://stackoverflow.com/users/7287171/liz-furlan"}, "edited": false, "score": 0, "creation_date": 1489610340, "post_id": 42818952, "comment_id": 72752189, "body": "@LizFurlan: what would &quot;together&quot; mean in this case? Either you&#39;ve exited, or you haven&#39;t. You could call <code>os.Exit</code> from <code>cleanup</code>, but if it&#39;s the last thing called it&#39;s not going to make any difference. <code>longRunningFunction</code> simply reaches &quot;the end&quot; before <code>os.Exit</code> is called, if you don&#39;t want that to happen, you need to stop that yourself somehow."}, {"owner": {"reputation": 73, "user_id": 7287171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4016b6b10294ce9a446d7d74e0c77991?s=128&d=identicon&r=PG&f=1", "display_name": "Liz Furlan", "link": "https://stackoverflow.com/users/7287171/liz-furlan"}, "edited": false, "score": 0, "creation_date": 1489610536, "post_id": 42818952, "comment_id": 72752310, "body": "sorry, I was unclear. &quot;Together&quot; meaning that <code>os.Exit(2)</code> is the first thing that happens after <code>cleanup()</code> (as opposed to <code>fmt.Println(&quot;the end&quot;)</code> being executed in between them)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 73, "user_id": 7287171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4016b6b10294ce9a446d7d74e0c77991?s=128&d=identicon&r=PG&f=1", "display_name": "Liz Furlan", "link": "https://stackoverflow.com/users/7287171/liz-furlan"}, "edited": false, "score": 0, "creation_date": 1489610884, "post_id": 42818952, "comment_id": 72752517, "body": "@LizFurlan: that&#39;s what I mean by you having to stop that yourself. You can&#39;t count on any execution order of goroutines without synchronization points. Unless you setup some synchronization, e.g. an <code>isExiting</code> mutex, there could always be other things happening between <code>os.Exit</code> and whatever directly preceded it."}, {"owner": {"reputation": 73, "user_id": 7287171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4016b6b10294ce9a446d7d74e0c77991?s=128&d=identicon&r=PG&f=1", "display_name": "Liz Furlan", "link": "https://stackoverflow.com/users/7287171/liz-furlan"}, "edited": false, "score": 0, "creation_date": 1489611070, "post_id": 42818952, "comment_id": 72752608, "body": "Oh, I understand now. Thanks!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1489605981, "creation_date": 1489605981, "answer_id": 42818952, "question_id": 42818887, "link": "https://stackoverflow.com/questions/42818887/how-to-end-a-go-program-from-a-goroutine/42818952#42818952", "title": "How to end a go program from a goroutine", "body": "<p>You're continuing execution after your signal handler. If you want to exit the process, call <a href=\"https://golang.org/pkg/os/#Exit\" rel=\"nofollow noreferrer\"><code>os.Exit</code></a>:</p>\n\n<pre><code>go func() {\n    &lt;-sigs\n    fmt.Println(\"Got an interrupt\")\n    cleanup()\n    os.Exit(2)\n}()\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7287171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4016b6b10294ce9a446d7d74e0c77991?s=128&d=identicon&r=PG&f=1", "display_name": "Liz Furlan", "link": "https://stackoverflow.com/users/7287171/liz-furlan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1975, "favorite_count": 1, "accepted_answer_id": 42818952, "answer_count": 1, "score": 3, "last_activity_date": 1489605981, "creation_date": 1489605707, "question_id": 42818887, "link": "https://stackoverflow.com/questions/42818887/how-to-end-a-go-program-from-a-goroutine", "title": "How to end a go program from a goroutine", "body": "<p>I'm trying to implement some non-typical behavior in a command line interface written in go.</p>\n\n<p>I have a function that runs for a long time, and I want to have a cleanup function that runs when someone ctrl-c's out of that function. </p>\n\n<p>Here's a mock-up of the code:</p>\n\n<pre><code>func longRunningFunction() {\n    //some set up stuff\n    sigs := make(chan os.Signal, 1)\n    signal.Notify(sigs, os.Interrupt, syscall.SIGINT, syscall.SIGTERM)\n\n    go func() {\n        &lt;-sigs\n        fmt.Println(\"Got an interrupt\")\n        cleanup()\n    }()\n    //the long-running command\n    fmt.Println(\"the end\")\n}\n</code></pre>\n\n<p>In the normal case, using ctrl-c will not be necessary and the function will finish normally. (Because of this, I can't have something (like a channel) in the main thread that blocks until the cleanup goroutine has finished.) However, in the case that a user does press ctrl-c, I would like to end the program immediately, not printing \"the end\" (and ideally not finishing the long-running command). </p>\n\n<p>That's not happening right now. Currently, the command line output looks like this:</p>\n\n<pre><code>...\n//long-running-command's output\n^CGot an interrupt\n//cleanup code's output\n$\n//more of long-running-command's output\nthe end\n</code></pre>\n\n<p>I'm confused on a few fronts - why is the program still printing after the prompt returns, and why is \"the end\" still being printed? How can I avoid this behavior? Is this scenario even possible in go? Thanks!</p>\n"}, {"tags": ["go", "neo4j"], "answers": [{"tags": [], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "is_accepted": true, "score": 6, "last_activity_date": 1489611149, "creation_date": 1489611149, "answer_id": 42820469, "question_id": 42818747, "link": "https://stackoverflow.com/questions/42818747/golang-and-neo4j-using-golang-neo4j-bolt-driver/42820469#42820469", "title": "golang and neo4j using golang-neo4j-bolt-driver", "body": "<p>You will want to alias the name of the library </p>\n\n<pre><code>bolt \"github.com/johnnadratowski/golang-neo4j-bolt-driver\"\n</code></pre>\n\n<p>You can see this in their <a href=\"https://github.com/johnnadratowski/golang-neo4j-bolt-driver/blob/master/examples/quick_n_dirty/quick_n_dirty.go#L6\" rel=\"noreferrer\">code examples </a></p>\n"}], "owner": {"reputation": 2104, "user_id": 2109596, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/9f1a6f14c76abbb3ef336b76dfb84039?s=128&d=identicon&r=PG", "display_name": "Albert s", "link": "https://stackoverflow.com/users/2109596/albert-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1146, "favorite_count": 1, "accepted_answer_id": 42820469, "answer_count": 1, "score": 10, "last_activity_date": 1489611149, "creation_date": 1489605211, "question_id": 42818747, "link": "https://stackoverflow.com/questions/42818747/golang-and-neo4j-using-golang-neo4j-bolt-driver", "title": "golang and neo4j using golang-neo4j-bolt-driver", "body": "<p>I'm trying out the golang-neo4j-bolt-driver package<br>\n<a href=\"http://github.com/johnnadratowski/golang-neo4j-bolt-driver\" rel=\"noreferrer\">github.com/johnnadratowski/golang-neo4j-bolt-driver</a>    </p>\n\n<p>I have imported the package and am using the example way of creating a new driver:</p>\n\n<pre><code>driver := bolt.NewDriver()\n</code></pre>\n\n<p>i get the following:</p>\n\n<pre><code>./neo.go:5: imported and not used: \"github.com/johnnadratowski/golang-neo4j-bolt-driver\" as golangNeo4jBoltDriver\n./neo.go:34: undefined: bolt in bolt.NewDriver\n</code></pre>\n\n<p>any pointers would be appreciated</p>\n"}, {"tags": ["linux", "bash", "go", "raspbian", "autostart"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 3882511, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d7df657643684153ad9918e05f3057e?s=128&d=identicon&r=PG&f=1", "display_name": "user3882511", "link": "https://stackoverflow.com/users/3882511/user3882511"}, "edited": false, "score": 0, "creation_date": 1489605485, "post_id": 42818535, "comment_id": 72749390, "body": "you mean /home/pi/Documents/... i thought i had tried this before...i will give it a try again"}, {"owner": {"reputation": 125, "user_id": 3882511, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d7df657643684153ad9918e05f3057e?s=128&d=identicon&r=PG&f=1", "display_name": "user3882511", "link": "https://stackoverflow.com/users/3882511/user3882511"}, "edited": false, "score": 0, "creation_date": 1489610957, "post_id": 42818535, "comment_id": 72752560, "body": "no does also not work. maybe i have to say that each python scripts works with absolute path to the same directory but go won&#39;t - &gt; maybe go script specific problem?"}], "tags": [], "owner": {"reputation": 381, "user_id": 7670844, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X62J7gRKCOc/AAAAAAAAAAI/AAAAAAAAAFk/JwE0PFAJr9s/photo.jpg?sz=128", "display_name": "Mario Keller", "link": "https://stackoverflow.com/users/7670844/mario-keller"}, "is_accepted": false, "score": 0, "last_activity_date": 1489604498, "creation_date": 1489604498, "answer_id": 42818535, "question_id": 42818224, "link": "https://stackoverflow.com/questions/42818224/golang-webserver-local-rc-on-raspbian-how-to-autostart/42818535#42818535", "title": "Golang webserver local.rc on raspbian how to autostart?", "body": "<p>You are using the '~' character in your path. That means that the path is relativ to the home-directory of the user that is running the script. \nCalling the script as a user, everything works fine, but calling the script as root user, it will try to use <em>/root/Documents/myfolder/sub...</em> as path and this will not work. Try to do run the script with an absolute path, or even better try to deploy your service on a more common place.</p>\n"}, {"tags": [], "owner": {"reputation": 125, "user_id": 3882511, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d7df657643684153ad9918e05f3057e?s=128&d=identicon&r=PG&f=1", "display_name": "user3882511", "link": "https://stackoverflow.com/users/3882511/user3882511"}, "is_accepted": false, "score": 0, "last_activity_date": 1489663757, "creation_date": 1489663757, "answer_id": 42832843, "question_id": 42818224, "link": "https://stackoverflow.com/questions/42818224/golang-webserver-local-rc-on-raspbian-how-to-autostart/42832843#42832843", "title": "Golang webserver local.rc on raspbian how to autostart?", "body": "<p>It seems that i had to install a service within /etc/init.d -> now i works without any problems (with the same script &amp; absolute path)</p>\n"}], "owner": {"reputation": 125, "user_id": 3882511, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d7df657643684153ad9918e05f3057e?s=128&d=identicon&r=PG&f=1", "display_name": "user3882511", "link": "https://stackoverflow.com/users/3882511/user3882511"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1489663757, "creation_date": 1489603550, "question_id": 42818224, "link": "https://stackoverflow.com/questions/42818224/golang-webserver-local-rc-on-raspbian-how-to-autostart", "title": "Golang webserver local.rc on raspbian how to autostart?", "body": "<p>i can run this everywhere <strong>on my shell</strong>:</p>\n\n<pre><code>bash ~/Documents/myfolder/subfolder/service/autorun.sh\n</code></pre>\n\n<p>this is my autorun.sh this should start the builded go webservice:</p>\n\n<p><code>#!/bin/bash\ncd ./bin/\nsudo ./client-service</code></p>\n\n<p><strong>this works</strong> if i run it on my shell.\n<strong>But</strong> if i want to use it <strong>in my rc.local</strong> for autostart on raspbian with this code:</p>\n\n<pre><code>bash ~/Documents/myfolder/subfolder/service/autorun.sh\n</code></pre>\n\n<p>The bash script should start the go webserver. </p>\n\n<pre><code>~/Documents/myfolder/subfolder/service/bin/client-service\n</code></pre>\n\n<p>But it won't start </p>\n\n<p>I hope someone can help me with this problem!\nthx</p>\n"}, {"tags": ["json", "rest", "go", "annotations", "response"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1489610064, "post_id": 42818156, "comment_id": 72752014, "body": "You could certainly implement something that uses tags that way to adjust what&#39;s rendered to the user. Creating multiple structs is unnecessary. Unfortunately the question &quot;how to implement&quot; something is too broad to answer effectively on StackOverflow; can you explain what you&#39;ve tried, what result was expected, and what result you got?"}, {"owner": {"reputation": 473, "user_id": 3273138, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/mFU9l.jpg?s=128&g=1", "display_name": "Conner", "link": "https://stackoverflow.com/users/3273138/conner"}, "edited": false, "score": 3, "creation_date": 1489613180, "post_id": 42818156, "comment_id": 72753735, "body": "I recommend you look into the reflect package (<a href=\"https://godoc.org/reflect\" rel=\"nofollow noreferrer\">godoc.org/reflect</a>), specifically the StructField and StructTag types. If you have the Go Programming Language book, check out chapter 12.7 - Accessing Struct Field Tags."}, {"owner": {"reputation": 646, "user_id": 4335622, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-OeTdPDQRltk/AAAAAAAAAAI/AAAAAAAAAE4/KXT0pHbxg9s/photo.jpg?sz=128", "display_name": "i.van", "link": "https://stackoverflow.com/users/4335622/i-van"}, "reply_to_user": {"reputation": 473, "user_id": 3273138, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/mFU9l.jpg?s=128&g=1", "display_name": "Conner", "link": "https://stackoverflow.com/users/3273138/conner"}, "edited": false, "score": 0, "creation_date": 1489613851, "post_id": 42818156, "comment_id": 72754047, "body": "Thanks @Conner! I&#39;ll take a look"}], "answers": [{"comments": [{"owner": {"reputation": 646, "user_id": 4335622, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-OeTdPDQRltk/AAAAAAAAAAI/AAAAAAAAAE4/KXT0pHbxg9s/photo.jpg?sz=128", "display_name": "i.van", "link": "https://stackoverflow.com/users/4335622/i-van"}, "edited": false, "score": 0, "creation_date": 1489613190, "post_id": 42820577, "comment_id": 72753740, "body": "That&#39;s a pretty interesting approach but we will have to abuse the &quot;omitempty&quot; tag. I&#39;ll try it anyway. Thank you"}], "tags": [], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "is_accepted": false, "score": 1, "last_activity_date": 1489611574, "creation_date": 1489611574, "answer_id": 42820577, "question_id": 42818156, "link": "https://stackoverflow.com/questions/42818156/control-field-visibility-depending-on-user-role/42820577#42820577", "title": "Control field visibility depending on User role", "body": "<p>Use \"omit empty\"</p>\n\n<pre><code>type Employee struct {\n    ID string `json:\",omitempty\"`\n    Name string `json:\",omitempty\"`\n    Salary int `json:\",omitempty\"`\n}\n</code></pre>\n\n<p>Your function can look like </p>\n\n<pre><code>func MarshallEmployee(e Employee, permission string) {\n    if permission == \"user\"{\n        e.Salary = 0\n    }\n    ....marshall it\n}\n</code></pre>\n\n<p>or you could also just not add the value to the struct in the first place. See <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\">the docs</a> for more detail.</p>\n"}, {"comments": [{"owner": {"reputation": 646, "user_id": 4335622, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-OeTdPDQRltk/AAAAAAAAAAI/AAAAAAAAAE4/KXT0pHbxg9s/photo.jpg?sz=128", "display_name": "i.van", "link": "https://stackoverflow.com/users/4335622/i-van"}, "edited": false, "score": 0, "creation_date": 1489744248, "post_id": 42850832, "comment_id": 72814830, "body": "Thanks for the complete implementation! But could you please help me with how this solution should be updated to handle inner maps and inner structs? <a href=\"https://play.golang.org/p/Lo8Lx7YzBW\" rel=\"nofollow noreferrer\">play.golang.org/p/Lo8Lx7YzBW</a>"}, {"owner": {"reputation": 473, "user_id": 3273138, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/mFU9l.jpg?s=128&g=1", "display_name": "Conner", "link": "https://stackoverflow.com/users/3273138/conner"}, "reply_to_user": {"reputation": 646, "user_id": 4335622, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-OeTdPDQRltk/AAAAAAAAAAI/AAAAAAAAAE4/KXT0pHbxg9s/photo.jpg?sz=128", "display_name": "i.van", "link": "https://stackoverflow.com/users/4335622/i-van"}, "edited": false, "score": 1, "creation_date": 1489993387, "post_id": 42850832, "comment_id": 72895236, "body": "I changed my answer for you. I think this is what you are looking for and is much cleaner than my previous answer."}], "tags": [], "owner": {"reputation": 473, "user_id": 3273138, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/mFU9l.jpg?s=128&g=1", "display_name": "Conner", "link": "https://stackoverflow.com/users/3273138/conner"}, "is_accepted": true, "score": 2, "last_activity_date": 1489986019, "last_edit_date": 1489986019, "creation_date": 1489732793, "answer_id": 42850832, "question_id": 42818156, "link": "https://stackoverflow.com/questions/42818156/control-field-visibility-depending-on-user-role/42850832#42850832", "title": "Control field visibility depending on User role", "body": "<ol>\n<li>Create an empty struct of your type (Employee in this problem) that will hold the filtered data.</li>\n<li>Use the <a href=\"https://godoc.org/reflect\" rel=\"nofollow noreferrer\">reflect</a> package to compare if the field tag contains the desired tag value (visibility role).</li>\n<li>Copy values of base struct to our filter struct when we find a tag match and <a href=\"https://godoc.org/encoding/json#Marshal\" rel=\"nofollow noreferrer\">json marshal</a> the output struct:</li>\n</ol>\n\n<hr>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"reflect\"\n    \"strings\"\n)\n\ntype Employee struct {\n    ID       string          `visibility:\"admin, hr, user\" json:\"id,omitempty\"`\n    Name     string          `visibility:\"admin, hr, user\" json:\"name,omitempty\"`\n    Salary   int             `visibility:\"admin, hr\" json:\"salary,omitempty\"`\n    Password string          `visibility:\"admin\" json:\"password,omitempty\"`\n    Rights   map[string]bool `visibility:\"admin\" json:\"rights,omitempty\"`\n    Boss     *Employee       `visibility:\"admin, hr\" json:\"boss,omitempty\"`\n}\n\nfunc filterEmployee(emp Employee, role string) Employee {\n    var fEmployee Employee\n    ev := reflect.ValueOf(emp)\n    et := reflect.TypeOf(emp)\n\n    // Iterate through each field within the struct\n    for i := 0; i &lt; ev.NumField(); i++ {\n        v := ev.Field(i)\n        t := et.Field(i)\n        roles := t.Tag.Get(\"visibility\")\n\n        if strings.Contains(roles, role) {\n            switch i {\n            case 0: // ID\n                fEmployee.ID = v.String()\n            case 1: // Name\n                fEmployee.Name = v.String()\n            case 2: // Salary\n                fEmployee.Salary = int(v.Int())\n            case 3: // Password\n                fEmployee.Password = v.String()\n            case 4: // Rights\n                fEmployee.Rights = v.Interface().(map[string]bool)\n            case 5: // Boss\n                fEmployee.Boss = v.Interface().(*Employee)\n            }\n        }\n    }\n    return fEmployee\n}\n\nfunc main() {\n\n    e := Employee{\n        \"1\",\n        \"Jack\",\n        100000,\n        \"password321\",\n        map[string]bool{\"create\": false, \"update\": false},\n        &amp;Employee{\n            \"2\",\n            \"John\",\n            120000,\n            \"pwd\",\n            map[string]bool{\"create\": true, \"update\": true},\n            nil,\n        },\n    }\n\n    fuser := filterEmployee(e, \"user\")\n    fhr := filterEmployee(e, \"hr\")\n    fadmin := filterEmployee(e, \"admin\")\n\n    buser, err := json.MarshalIndent(fuser, \"\", \"  \")\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(\"Filtering with role user: \")\n    fmt.Println(string(buser))\n\n    bhr, err := json.MarshalIndent(fhr, \"\", \"  \")\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(\"\\nFiltering with role hr: \")\n    fmt.Println(string(bhr))\n\n    badmin, err := json.MarshalIndent(fadmin, \"\", \"  \")\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(\"\\nFiltering with role admin: \")\n    fmt.Println(string(badmin))\n}\n</code></pre>\n\n<hr>\n\n<p>Output:\n</p>\n\n<pre><code>Filtering with role user: \n{\n  \"id\": \"1\",\n  \"name\": \"Jack\"\n}\n\nFiltering with role hr: \n{\n  \"id\": \"1\",\n  \"name\": \"Jack\",\n  \"salary\": 100000,\n  \"boss\": {\n    \"id\": \"2\",\n    \"name\": \"John\",\n    \"salary\": 120000,\n    \"password\": \"pwd\",\n    \"rights\": {\n      \"create\": true,\n      \"update\": true\n    }\n  }\n}\n\nFiltering with role admin: \n{\n  \"id\": \"1\",\n  \"name\": \"Jack\",\n  \"salary\": 100000,\n  \"password\": \"password321\",\n  \"rights\": {\n    \"create\": false,\n    \"update\": false\n  },\n  \"boss\": {\n    \"id\": \"2\",\n    \"name\": \"John\",\n    \"salary\": 120000,\n    \"password\": \"pwd\",\n    \"rights\": {\n      \"create\": true,\n      \"update\": true\n    }\n  }\n}\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://play.golang.org/p/nc54-4trrQ\" rel=\"nofollow noreferrer\">Playground</a> </p>\n\n<p><strong>EDIT:</strong> Updated answer for asker's request.</p>\n\n<p>View the old playground for previous answer that ran into issues.</p>\n\n<p><a href=\"https://play.golang.org/p/8653vVokyV\" rel=\"nofollow noreferrer\">Old Playground</a> </p>\n"}], "owner": {"reputation": 646, "user_id": 4335622, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-OeTdPDQRltk/AAAAAAAAAAI/AAAAAAAAAE4/KXT0pHbxg9s/photo.jpg?sz=128", "display_name": "i.van", "link": "https://stackoverflow.com/users/4335622/i-van"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 1, "accepted_answer_id": 42850832, "answer_count": 2, "score": 0, "last_activity_date": 1489986019, "creation_date": 1489603307, "last_edit_date": 1489613813, "question_id": 42818156, "link": "https://stackoverflow.com/questions/42818156/control-field-visibility-depending-on-user-role", "title": "Control field visibility depending on User role", "body": "<p>I'd like to hide/show some fields of a model depending on User role. </p>\n\n<p>What would be the most idiomatic way to implement it? </p>\n\n<p>I don't really want to create N different types of the same model (where N is amount of User roles). Like: \nUserEmployee, AdminEmployee, WhateverEmployee.</p>\n\n<p>It would be perfect if there is some solution that uses the tags for it:</p>\n\n<pre><code>type Employee struct {\n   ID string `visibility:\"admin,user\"`\n   Name string `visibility:\"admin,user\"`\n   Salary int `visibility:\"admin\"`\n}\n\njsonBytes, _ := someLib.Marshal(Employee{\"1\", \"John\", 5000}, \"user\")\n\nfmt.Println(string(jsonBytes)) // {\"id\":\"1\",\"name\":\"John\"}\n</code></pre>\n\n<p>The question is really pretty broad. I just wanted to know how you handle this situation or what is the most common way to do it in the Go community. I want clean and centralized (same for all models) solution that won't require to produce tons of duplicated code. </p>\n\n<p>What have I tried before: I've just tried to use separate models for all cases and cast between them. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1489601564, "post_id": 42817191, "comment_id": 72746994, "body": "What do you actually want to accomplish? Go doesn&#39;t use various extra constructions just for the sake of syntax. You can call <code>fnC(fnB(fnA()))</code> if you want, or simply collect each result and call the next. If you want other pipeline patterns the first 2 results in google are <a href=\"https://blog.golang.org/pipelines\" rel=\"nofollow noreferrer\">blog.golang.org/pipelines</a> and <a href=\"https://blog.gopheracademy.com/composable-pipelines-pattern/\" rel=\"nofollow noreferrer\">blog.gopheracademy.com/composable-pipelines-pattern</a>"}, {"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1489602403, "post_id": 42817191, "comment_id": 72747497, "body": "Golang is not NodeJS buddy. As @JimB said you can simply achieve what you need just executing this functions in order <code>fnC(fnB(fnA()))</code>."}, {"owner": {"reputation": 63, "user_id": 7716757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/551cfd893de8ff88cb5154c51459fab4?s=128&d=identicon&r=PG", "display_name": "Devyiweid", "link": "https://stackoverflow.com/users/7716757/devyiweid"}, "edited": false, "score": 0, "creation_date": 1489602626, "post_id": 42817191, "comment_id": 72747628, "body": "Jim, is the second link uses channels? can you please help with some code using my example, i&#39;m new to go"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489603523, "post_id": 42817191, "comment_id": 72748168, "body": "@Devyiweid: if you&#39;re not dealing with concurrency, just start by calling the functions one after the other. I don&#39;t know what your actual problem is, so I have no idea how that would adapt to another pattern."}, {"owner": {"reputation": 63, "user_id": 7716757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/551cfd893de8ff88cb5154c51459fab4?s=128&d=identicon&r=PG", "display_name": "Devyiweid", "link": "https://stackoverflow.com/users/7716757/devyiweid"}, "edited": false, "score": 2, "creation_date": 1489603686, "post_id": 42817191, "comment_id": 72748250, "body": "there&#39;s no actual problem, it&#39;s something i need to implement for my projects, and last resort i&#39;ll use your suggestion i.e. to nest calls but if you can write something based on the links you suggested, i can build something on it. it&#39;s research trying to find out a way and the link you mentioned looks promising. the attempt is to find a more readable ways to do this, for instance <code>.then</code> based constructs are more readable then deeply nested functions."}, {"owner": {"reputation": 63, "user_id": 7716757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/551cfd893de8ff88cb5154c51459fab4?s=128&d=identicon&r=PG", "display_name": "Devyiweid", "link": "https://stackoverflow.com/users/7716757/devyiweid"}, "edited": false, "score": 0, "creation_date": 1489604005, "post_id": 42817191, "comment_id": 72748445, "body": "maybe if there&#39;s library for that?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1489604455, "post_id": 42817191, "comment_id": 72748762, "body": "@Devyiweid: I&#39;ve never needed a library to call a series of functions, and you don&#39;t need to nest functions to call them serially. Trying to translate patterns directly between different languages is often a waste of time. Don&#39;t try to write javascript or C# in Go, learn how to write Go first."}, {"owner": {"reputation": 63, "user_id": 7716757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/551cfd893de8ff88cb5154c51459fab4?s=128&d=identicon&r=PG", "display_name": "Devyiweid", "link": "https://stackoverflow.com/users/7716757/devyiweid"}, "edited": false, "score": 0, "creation_date": 1489604703, "post_id": 42817191, "comment_id": 72748916, "body": "can you please write a channel based solution for above"}, {"owner": {"reputation": 63, "user_id": 7716757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/551cfd893de8ff88cb5154c51459fab4?s=128&d=identicon&r=PG", "display_name": "Devyiweid", "link": "https://stackoverflow.com/users/7716757/devyiweid"}, "edited": false, "score": 0, "creation_date": 1493757745, "post_id": 42817191, "comment_id": 74536820, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go\">What are the use(s) for tags in Go?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11294, "user_id": 1239122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/8cf239e31df87733c835e53851283548?s=128&d=identicon&r=PG", "display_name": "Gravy", "link": "https://stackoverflow.com/users/1239122/gravy"}, "is_accepted": false, "score": 0, "last_activity_date": 1489617894, "last_edit_date": 1489617894, "creation_date": 1489616927, "answer_id": 42821907, "question_id": 42817191, "link": "https://stackoverflow.com/questions/42817191/func-pipe-in-go-language/42821907#42821907", "title": "Func pipe in go Language", "body": "<p>I am also not exactly sure what you want to do, however here is an example of a linked list implementation in Go.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype LinkedList struct {\n    value interface{}\n    next  *LinkedList\n}\n\nfunc (oldNode *LinkedList) prepend(value interface{}) *LinkedList {\n    return &amp;LinkedList{value, oldNode}\n}\n\nfunc tail(value interface{}) *LinkedList {\n    return &amp;LinkedList{value, nil}\n}\n\nfunc traverse(ll *LinkedList) {\n    if ll == nil {\n        return\n    }\n    fmt.Println(ll.value)\n    traverse(ll.next)\n}\n\nfunc main() {\n    node := tail(5).prepend(6).prepend(7)\n    traverse(node)\n}\n</code></pre>\n\n<p>So, as you can see, it is possible to <code>chain</code> methods using what is known as the <code>fluent</code> or <code>builder</code> interface. IMO above example is an appropriate place to do so. <a href=\"https://www.martinfowler.com/bliki/FluentInterface.html\" rel=\"nofollow noreferrer\">https://www.martinfowler.com/bliki/FluentInterface.html</a></p>\n\n<p>Now if you want to do an async / non blocking request, then I would use channels / goroutines. It's not really a promise, but you can certainly handle on success/error if you wanted.</p>\n\n<pre><code>func NonBlockingGet(url string) &lt;-chan []byte {\n    c := make(chan []byte, 1)\n\n    go func() {\n        var body []byte\n        defer func() {\n            c &lt;- body\n        }()\n\n        res, err := http.Get(url)\n        if err != nil {\n            return\n        }\n        defer res.Body.Close()\n\n        body, _ = ioutil.ReadAll(res.Body)\n    }()\n\n    return c\n}\n\nfunc main() {\n    promise := NonBlockingGet(\"http://example.com\")\n\n    // can do other stuff here - because doing a non-blocking get request.\n    log.Println(\"This will output before the response length\")\n\n    body := &lt;- promise // Will wait here till promise is resolved.\n    log.Printf(\"response length: %d\", len(body))\n}\n</code></pre>\n\n<p>I hope that this helps. As said in comments above, this is not javascript and we shouldnt try to be. However, instead of assigning <code>&lt;- promise</code> to <code>body</code>, you could always pass <code>&lt;- promise</code> as an argument into a function.</p>\n"}, {"tags": [], "owner": {"reputation": 386, "user_id": 10477320, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-c24RuEdo6p8/AAAAAAAAAAI/AAAAAAAAABY/l8FENpi8wM4/photo.jpg?sz=128", "display_name": "irzhy", "link": "https://stackoverflow.com/users/10477320/irzhy"}, "is_accepted": false, "score": 2, "last_activity_date": 1559677795, "creation_date": 1559677795, "answer_id": 56450434, "question_id": 42817191, "link": "https://stackoverflow.com/questions/42817191/func-pipe-in-go-language/56450434#56450434", "title": "Func pipe in go Language", "body": "<p>I was seeking for this kind of pattern as well without any luck. It's very common to other language but not in golang</p>\n\n<p>Anyway, you may find this usefull <a href=\"https://github.com/open-zhy/fn-pipe\" rel=\"nofollow noreferrer\">https://github.com/open-zhy/fn-pipe</a></p>\n\n<p>It basically uses <a href=\"https://blog.golang.org/laws-of-reflection\" rel=\"nofollow noreferrer\">reflection</a> in order to map all your inputs and outputs through your functions</p>\n"}], "owner": {"reputation": 63, "user_id": 7716757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/551cfd893de8ff88cb5154c51459fab4?s=128&d=identicon&r=PG", "display_name": "Devyiweid", "link": "https://stackoverflow.com/users/7716757/devyiweid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 942, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559677795, "creation_date": 1489600343, "last_edit_date": 1489602316, "question_id": 42817191, "link": "https://stackoverflow.com/questions/42817191/func-pipe-in-go-language", "title": "Func pipe in go Language", "body": "<p>is it possible to create function pipelines in go language, where output of one function is directly conventionality into input of another function. </p>\n\n<p>Please discuss it in the comments if it's not clear and you need more info. </p>\n\n<p>Other functional languages provide some constructs, for instance it's <code>then</code> in javascript with <code>promises</code>, in java they use <code>andThen</code> with <code>lambdas</code>, and with <code>c#</code> it's <code>FunctionExtensions</code>. Shell programs like unix also provides buitin method called pipes <code>|</code></p>\n\n<pre><code>func processA(test TestObj) {\n    // do something\n    return test\n}\n\nfunc process B(test TestObj) {\n    //do something\n    return test\n}\n\nfunc processC(test TestObj) {\n    //do something\n    return test\n}\n</code></pre>\n\n<p>so can we do something similar like</p>\n\n<pre><code>var obj = TestObj{}\n\nprocessA(obj)\n   .then(processB)\n    .then(processC)\n</code></pre>\n\n<p>jim, the second example uses the channels? can you please provide a code example using my code.</p>\n"}, {"tags": ["json", "http", "go", "http-post"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1551105510, "last_edit_date": 1551105510, "creation_date": 1489599067, "answer_id": 42816783, "question_id": 42816632, "link": "https://stackoverflow.com/questions/42816632/golang-json-decode-with-empty-request-body/42816783#42816783", "title": "golang json decode with empty request body", "body": "<p>Read the body first, to check its content, then unmarshal it:</p>\n\n<pre><code>body, err := ioutil.ReadAll(r.Body)\nif err != nil {\n    return err\n}\n\nif len(body) &gt; 0 {\n    err = json.Unmarshal(body, &amp;opts)\n    if err != nil {\n        return fmt.Errorf(\"Could not get advanced options: %s\", err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 16093, "user_id": 534298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4ba32c06ed067564a6c6512de5217657?s=128&d=identicon&r=PG", "display_name": "nos", "link": "https://stackoverflow.com/users/534298/nos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3343, "favorite_count": 1, "accepted_answer_id": 42816783, "answer_count": 1, "score": 1, "last_activity_date": 1551105510, "creation_date": 1489598593, "question_id": 42816632, "link": "https://stackoverflow.com/questions/42816632/golang-json-decode-with-empty-request-body", "title": "golang json decode with empty request body", "body": "<p>In the following http handler, I try to distinguish whether the request body is empty</p>\n\n<pre><code>    type Request struct {                                                       \n        A    bool  `json:\"lala\"`                               \n        B    bool  `json:\"kaka\"`                               \n        C    int32 `json:\"cc\"`                           \n        D    int32 `json:\"dd\"`                             \n    }                                                                           \n    var (                                                                       \n        opts    Request                                                         \n        hasOpts bool = true                                                     \n    )                                                                           \n    err = json.NewDecoder(r.Body).Decode(&amp;opts)                                 \n    switch {                                                                    \n    case err == io.EOF:                                                         \n        hasOpts = false                                                         \n    case err != nil:                                                            \n        return errors.New(\"Could not get advanced options: \" + err.Error()) \n    }          \n</code></pre>\n\n<p>However, even with <code>r.Body</code> equals <code>'{}'</code>, <code>hasOpts</code> is still <code>true</code>. Is this to be expected? In that case, how should I detect empty request body?                                                                 </p>\n"}, {"tags": ["http", "go", "ntlm"], "answers": [{"tags": [], "owner": {"reputation": 14311, "user_id": 5085211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eEZjd.png?s=128&g=1", "display_name": "fuglede", "link": "https://stackoverflow.com/users/5085211/fuglede"}, "is_accepted": true, "score": 3, "last_activity_date": 1489673481, "creation_date": 1489673481, "answer_id": 42836487, "question_id": 42816600, "link": "https://stackoverflow.com/questions/42816600/windows-system-credentials-in-go-http-ntlm-requests/42836487#42836487", "title": "Windows system credentials in Go HTTP NTLM requests", "body": "<p>After digging into it a bit further, it looks like <code>go-ole</code> can be utilized to make use of <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa384106(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>WinHTTPRequest</code></a> in the same way as the Python example in the question. Ignoring all error catching,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    ole \"github.com/go-ole/go-ole\"\n    \"github.com/go-ole/go-ole/oleutil\"\n)\n\nfunc main() {\n    ole.CoInitialize(0)\n    defer ole.CoUninitialize()\n    unknown, _ := oleutil.CreateObject(\"WinHTTP.WinHTTPRequest.5.1\")\n    request, _ := unknown.QueryInterface(ole.IID_IDispatch)\n    oleutil.CallMethod(request, \"SetAutoLogonPolicy\", 0)\n    oleutil.CallMethod(request, \"Open\", \"GET\", \"http://example.com\", false)\n    oleutil.CallMethod(request, \"Send\")\n    resp := oleutil.MustGetProperty(request, \"ResponseText\")\n    fmt.Println(resp.ToString())\n}\n</code></pre>\n"}], "owner": {"reputation": 14311, "user_id": 5085211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eEZjd.png?s=128&g=1", "display_name": "fuglede", "link": "https://stackoverflow.com/users/5085211/fuglede"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1159, "favorite_count": 0, "accepted_answer_id": 42836487, "answer_count": 1, "score": 3, "last_activity_date": 1489673481, "creation_date": 1489598446, "question_id": 42816600, "link": "https://stackoverflow.com/questions/42816600/windows-system-credentials-in-go-http-ntlm-requests", "title": "Windows system credentials in Go HTTP NTLM requests", "body": "<p>I am looking for the path of least resistance for doing NTLM authentication in a Go HTTP request using the system credentials of the Windows user calling the application.</p>\n\n<p>In C#/.NET, I would be able to achieve this through</p>\n\n<pre><code>WebRequest request = WebRequest.Create(url);\nrequest.Credentials = CredentialCache.DefaultCredentials;\nWebResponse response = request.GetResponse();\nStream receiveStream = response.GetResponseStream();\n</code></pre>\n\n<p>and in Python, the equivalent result can be obtained through</p>\n\n<pre><code>import win32com.client\nh = win32com.client.Dispatch('WinHTTP.WinHTTPRequest.5.1')\nh.SetAutoLogonPolicy(0)\nh.Open('GET', url, False)\nh.Send()\n</code></pre>\n\n<p>but I have not been able to find any resources on how to do the same thing in Go. I could of course use a library for NTLM authentication and manually provide a username/password, but the goal here is to avoid ever putting those in.</p>\n"}, {"tags": ["go", "glide-golang"], "answers": [{"comments": [{"owner": {"reputation": 619, "user_id": 442952, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/adcdd4080503216e19cee81f413e6eb3?s=128&d=identicon&r=PG", "display_name": "George Antoniadis", "link": "https://stackoverflow.com/users/442952/george-antoniadis"}, "edited": false, "score": 0, "creation_date": 1496017567, "post_id": 42836632, "comment_id": 75476350, "body": "Thanks, this was very annoying to debug! :D"}], "tags": [], "owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "is_accepted": false, "score": 1, "last_activity_date": 1489673846, "creation_date": 1489673846, "answer_id": 42836632, "question_id": 42816235, "link": "https://stackoverflow.com/questions/42816235/remote-does-match-the-vcs-endpoint-for-logrus-package/42836632#42836632", "title": "Remote does match the VCS endpoint for logrus package", "body": "<p>This was really stupid in the end.</p>\n\n<p>The sirupsen package expects your import to have an upper case s at the beginning of Sirupse in the import.</p>\n\n<p>I changed this:</p>\n\n<pre><code>import \"github.com/sirupsen/logrus\"\n</code></pre>\n\n<p>to this</p>\n\n<pre><code>import \"github.com/Sirupsen/logrus\"\n</code></pre>\n\n<p>And it worked!</p>\n"}, {"tags": [], "owner": {"reputation": 1708, "user_id": 930038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf689dfa15e780233b534a5fdfd2284?s=128&d=identicon&r=PG&f=1", "display_name": "pungoyal", "link": "https://stackoverflow.com/users/930038/pungoyal"}, "is_accepted": false, "score": 2, "last_activity_date": 1504947484, "creation_date": 1504947484, "answer_id": 46128919, "question_id": 42816235, "link": "https://stackoverflow.com/questions/42816235/remote-does-match-the-vcs-endpoint-for-logrus-package/46128919#46128919", "title": "Remote does match the VCS endpoint for logrus package", "body": "<p><code>import \"github.com/sirupsen/logrus\"</code> is correct. To bust the glide cache, do <code>glide install --force</code></p>\n"}], "owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1553446740, "creation_date": 1489597340, "last_edit_date": 1553446740, "question_id": 42816235, "link": "https://stackoverflow.com/questions/42816235/remote-does-match-the-vcs-endpoint-for-logrus-package", "title": "Remote does match the VCS endpoint for logrus package", "body": "<p>Something weird is happening here, and I can't figure it out.</p>\n\n<p>I'm using glide for my dependencies, and there's one package giving me grief. I added the github.com/sirupsen/logrus package for logging, and then ran <code>glide up</code>. This happened:</p>\n\n<pre><code>[INFO]  Downloading dependencies. Please wait...\n[INFO]  --&gt; Fetching updates for github.com/bgentry/speakeasy.\n[INFO]  --&gt; Fetching updates for github.com/sirupsen/logrus.\n[ERROR] Update failed for github.com/sirupsen/logrus: The Remote does not match the VCS endpoint\n[ERROR] Could not update packages: The Remote does not match the VCS endpoint\n</code></pre>\n\n<p>Now I did a bunch of googling, and this is usually related to repos changing names or destination, but this didn't happen in this case. So what might be causing it?</p>\n\n<p>Here's my <code>glide.lock</code>:</p>\n\n<pre><code>hash: fb99f00e96f2316b9acbe5892497bbc46e936bd2822dba68e5bf1aef553d63cc\nupdated: 2017-03-12T18:55:33.370219633Z\nimports:\n- name: github.com/fatih/structs\n  version: a720dfa8df582c51dee1b36feabb906bde1588bd\n- name: github.com/fsnotify/fsnotify\n  version: a904159b9206978bb6d53fcc7a769e5cd726c737\n- name: github.com/hashicorp/errwrap\n  version: 7554cd9344cec97297fa6649b055a8c98c2a1e55\n- name: github.com/hashicorp/go-cleanhttp\n  version: 3573b8b52aa7b37b9358d966a898feb387f62437\n- name: github.com/hashicorp/go-multierror\n  version: ed905158d87462226a13fe39ddf685ea65f1c11f\n- name: github.com/hashicorp/go-rootcerts\n  version: 6bb64b370b90e7ef1fa532be9e591a81c3493e00\n- name: github.com/hashicorp/hcl\n  version: 372e8ddaa16fd67e371e9323807d056b799360af\n  subpackages:\n  - hcl/ast\n  - hcl/parser\n  - hcl/scanner\n  - hcl/strconv\n  - hcl/token\n  - json/parser\n  - json/scanner\n  - json/token\n- name: github.com/hashicorp/vault\n  version: ebb798ec1b2c93a4607d44438c6f56438a17b4cc\n  subpackages:\n  - api\n  - helper/compressutil\n  - helper/jsonutil\n- name: github.com/inconshreveable/mousetrap\n  version: 76626ae9c91c4f2a10f34cad8ce83ea42c93bb75\n- name: github.com/magiconair/properties\n  version: b3b15ef068fd0b17ddf408a23669f20811d194d2\n- name: github.com/mitchellh/go-homedir\n  version: b8bc1bf767474819792c23f32d8286a45736f1c6\n- name: github.com/mitchellh/mapstructure\n  version: db1efb556f84b25a0a13a04aad883943538ad2e0\n- name: github.com/pelletier/go-buffruneio\n  version: df1e16fde7fc330a0ca68167c23bf7ed6ac31d6d\n- name: github.com/pelletier/go-toml\n  version: d1fa2118c12c44e4f5004da216d1efad10cb4924\n- name: github.com/sethgrid/pester\n  version: 2c5fb962da6113d0968907fd81dba3ca35151d1c\n- name: github.com/spf13/afero\n  version: 72b31426848c6ef12a7a8e216708cb0d1530f074\n  subpackages:\n  - mem\n- name: github.com/spf13/cast\n  version: d1139bab1c07d5ad390a65e7305876b3c1a8370b\n- name: github.com/spf13/cobra\n  version: fcd0c5a1df88f5d6784cb4feead962c3f3d0b66c\n- name: github.com/spf13/jwalterweatherman\n  version: fa7ca7e836cf3a8bb4ebf799f472c12d7e903d66\n- name: github.com/spf13/pflag\n  version: 5ccb023bc27df288a957c5e994cd44fd19619465\n- name: github.com/spf13/viper\n  version: 5ed0fc31f7f453625df314d8e66b9791e8d13003\n- name: golang.org/x/net\n  version: e90d6d0afc4c315a0d87a568ae68577cc15149a0\n  subpackages:\n  - http2\n  - http2/hpack\n  - lex/httplex\n- name: golang.org/x/sys\n  version: 8f0908ab3b2457e2e15403d3697c9ef5cb4b57a9\n  subpackages:\n  - unix\n- name: golang.org/x/text\n  version: 2910a502d2bf9e43193af9d68ca516529614eed3\n  subpackages:\n  - transform\n  - unicode/norm\n- name: gopkg.in/yaml.v2\n  version: 53feefa2559fb8dfa8d81baad31be332c97d6c77\ntestImports: []\n</code></pre>\n\n<p>I've tried deleting the <code>glide.lock</code> and <code>glide.yaml</code> and starting from scratch, with no relief. Any ideas? </p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "edited": false, "score": 0, "creation_date": 1489600799, "post_id": 42816132, "comment_id": 72746590, "body": "Link to tutorial?"}, {"owner": {"reputation": 115, "user_id": 377185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1616eddbf3dd25cdac91fc60df6cfd57?s=128&d=identicon&r=PG", "display_name": "tw1stud", "link": "https://stackoverflow.com/users/377185/tw1stud"}, "reply_to_user": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "edited": false, "score": 0, "creation_date": 1489610980, "post_id": 42816132, "comment_id": 72752574, "body": "My bad! should have added this! Updated my question with the docs!"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 377185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1616eddbf3dd25cdac91fc60df6cfd57?s=128&d=identicon&r=PG", "display_name": "tw1stud", "link": "https://stackoverflow.com/users/377185/tw1stud"}, "edited": false, "score": 0, "creation_date": 1489618377, "post_id": 42817725, "comment_id": 72756040, "body": "Can you point out on what specific tweaks would i need to do for &quot;create&quot; function? I tried appending &quot;latest&quot; string, but it was of no help"}, {"owner": {"reputation": 115, "user_id": 377185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1616eddbf3dd25cdac91fc60df6cfd57?s=128&d=identicon&r=PG", "display_name": "tw1stud", "link": "https://stackoverflow.com/users/377185/tw1stud"}, "edited": false, "score": 0, "creation_date": 1489618478, "post_id": 42817725, "comment_id": 72756093, "body": "The problem is that &#39;docker run&#39;s CLI equivalent in Golang is not working (at least from what Docker has in its site). Not entirely sure if its really the go code or something with my native docker configurations. If you can see above the equivalent docker run command works just fine"}, {"owner": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "reply_to_user": {"reputation": 115, "user_id": 377185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1616eddbf3dd25cdac91fc60df6cfd57?s=128&d=identicon&r=PG", "display_name": "tw1stud", "link": "https://stackoverflow.com/users/377185/tw1stud"}, "edited": false, "score": 0, "creation_date": 1489622007, "post_id": 42817725, "comment_id": 72757322, "body": "I&#39;m not sure where your code is having issues and haven&#39;t had time to try the tutorial myself. The above was more to answer what docker is doing in their code to implement this."}], "tags": [], "owner": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1489602001, "creation_date": 1489602001, "answer_id": 42817725, "question_id": 42816132, "link": "https://stackoverflow.com/questions/42816132/docker-run-using-golang-api-docker-docs/42817725#42817725", "title": "`docker run` using Golang API (Docker docs)", "body": "<p>The docker client is open source and written in Go, so you can see exactly how they've implemented their version. I believe the relevant code is in the <a href=\"https://github.com/docker/docker/blob/master/cli/command/container/create.go#L73\" rel=\"nofollow noreferrer\">container/create.go</a> pullImage function. </p>\n"}, {"tags": [], "owner": {"reputation": 1096, "user_id": 15495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01357143fb88a3095a47794624b4eb30?s=128&d=identicon&r=PG", "display_name": "Justin Cormack", "link": "https://stackoverflow.com/users/15495/justin-cormack"}, "is_accepted": false, "score": 1, "last_activity_date": 1494590770, "creation_date": 1494590770, "answer_id": 43937375, "question_id": 42816132, "link": "https://stackoverflow.com/questions/42816132/docker-run-using-golang-api-docker-docs/43937375#43937375", "title": "`docker run` using Golang API (Docker docs)", "body": "<p>Image.Pull returns an io.Reader which you must read and close; if you do not the connection will be closed before the image is pulled.</p>\n\n<p>You can just discard the contents of it and close it, then the pull will work.</p>\n"}, {"comments": [{"owner": {"reputation": 208, "user_id": 209105, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/02226793a5c96c29ddc2851f696a4a29?s=128&d=identicon&r=PG", "display_name": "PGP_Protector", "link": "https://stackoverflow.com/users/209105/pgp-protector"}, "edited": false, "score": 0, "creation_date": 1496763660, "post_id": 44394081, "comment_id": 75788435, "body": "Just finished testing, io.copy(nil,pullstat) Will not work."}], "tags": [], "owner": {"reputation": 208, "user_id": 209105, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/02226793a5c96c29ddc2851f696a4a29?s=128&d=identicon&r=PG", "display_name": "PGP_Protector", "link": "https://stackoverflow.com/users/209105/pgp-protector"}, "is_accepted": true, "score": 1, "last_activity_date": 1496762899, "creation_date": 1496762899, "answer_id": 44394081, "question_id": 42816132, "link": "https://stackoverflow.com/questions/42816132/docker-run-using-golang-api-docker-docs/44394081#44394081", "title": "`docker run` using Golang API (Docker docs)", "body": "<p>Was having the same issue, the \"Pull\" didn't seem to be working. Found a Fix though.</p>\n\n<p>1) Modify your pull line to </p>\n\n<pre><code>pullstat, err = cli.ImagePull(ctx, \"alpine\", types.ImagePullOptions{})\n</code></pre>\n\n<p>and add </p>\n\n<pre><code>io.Copy(os.StdOut,pullstat) \n</code></pre>\n\n<p>after the ImagePull</p>\n\n<p>I haven't tried doing an </p>\n\n<pre><code>io.Copy(nil,pullstat) \n</code></pre>\n\n<p>but that's on my list of things to try next.</p>\n"}], "owner": {"reputation": 115, "user_id": 377185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1616eddbf3dd25cdac91fc60df6cfd57?s=128&d=identicon&r=PG", "display_name": "tw1stud", "link": "https://stackoverflow.com/users/377185/tw1stud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1410, "favorite_count": 0, "accepted_answer_id": 44394081, "answer_count": 3, "score": 3, "last_activity_date": 1496762899, "creation_date": 1489597022, "last_edit_date": 1491935167, "question_id": 42816132, "link": "https://stackoverflow.com/questions/42816132/docker-run-using-golang-api-docker-docs", "title": "`docker run` using Golang API (Docker docs)", "body": "<p>I am trying to use Docker's tutorial in recreating a <code>docker run</code>. Here is the following code from online tutorial</p>\n\n<pre><code> package main\n\n import (\n \"io\"\n \"os\"\n\n\"github.com/docker/docker/client\"\n\"github.com/docker/docker/api/types\"\n\"github.com/docker/docker/api/types/container\"\n\"golang.org/x/net/context\"\n )\n\n func main() {\nctx := context.Background()\ncli, err := client.NewEnvClient()\nif err != nil {\n    panic(err)\n}\n\n_, err = cli.ImagePull(ctx, \"alpine\", types.ImagePullOptions{})\nif err != nil {\n    panic(err)\n}\n\nresp, err := cli.ContainerCreate(ctx, &amp;container.Config{\n    Image: \"alpine\",\n    Cmd:   []string{\"echo\", \"hello world\"},\n}, nil, nil, \"\")\nif err != nil {\n    panic(err)\n}\n\nif err := cli.ContainerStart(ctx, resp.ID, types.ContainerStartOptions{});     err != nil {\n    panic(err)\n}\n\nif _, err = cli.ContainerWait(ctx, resp.ID); err != nil {\n    panic(err)\n}\n\nout, err := cli.ContainerLogs(ctx, resp.ID, types.ContainerLogsOptions{ShowStdout: true})\nif err != nil {\n    panic(err)\n}\n\nio.Copy(os.Stdout, out)\n}\n</code></pre>\n\n<p>The problem I see with this is, if 'alpine' docker, is not available locally, it doesn't pull the latest and ends up throwing an error. \n  e.g\n        XXXXX$ go run go_docker.go\n        panic: Error: No such image: alpine</p>\n\n<pre><code>    goroutine 1 [running]:\n      panic(0x27ffa0, 0xc4202afa50)\n    /usr/local/go/src/runtime/panic.go:500 +0x1a1\n    main.main()\n    /Users/rvenkatesh/go_coding/raghu_test_code/go_docker.go:30 +0x592\n    exit status 2\n</code></pre>\n\n<p>But when I run the commandline equivalent, I see</p>\n\n<pre><code>    XXXX$ docker run alpine echo hello world\n    Unable to find image 'alpine:latest' locally\n    latest: Pulling from library/alpine \n    627beaf3eaaf: Pull complete\n\n        Digest:sha256:58e1a1bb75db1b5a24a462dd5e2915277ea06438c3f105138f97eb53149673c4\n    Status: Downloaded newer image for alpine:latest\n    hello world\n</code></pre>\n\n<p>I tried looking through Go client, do I need to tweak anything with ImagePull function? Any help here would be appreciated! </p>\n\n<p>Here is the link to the docs <a href=\"https://docs.docker.com/engine/api/getting-started/\" rel=\"nofollow noreferrer\">https://docs.docker.com/engine/api/getting-started/</a></p>\n\n<p>Update: I had tested the same tutorial for python version, and it worked just fine. I wonder if the Golang page needs update.  </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3358, "user_id": 852385, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c0eac51aaa99541fb966854b5dcb131?s=128&d=identicon&r=PG", "display_name": "Helin Wang", "link": "https://stackoverflow.com/users/852385/helin-wang"}, "edited": false, "score": 0, "creation_date": 1489601089, "post_id": 42815827, "comment_id": 72746744, "body": "Thank you! Can you explain why they must be exported? If it prints out something, fmt.Println is already using reflection to inspect the unexported fields, so why it don&#39;t just print out the String() version? json.Marshal is similar, but un-exported field will not be serialized."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 3358, "user_id": 852385, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c0eac51aaa99541fb966854b5dcb131?s=128&d=identicon&r=PG", "display_name": "Helin Wang", "link": "https://stackoverflow.com/users/852385/helin-wang"}, "edited": false, "score": 0, "creation_date": 1489607768, "post_id": 42815827, "comment_id": 72750742, "body": "@HelinWang If it prints <code>{}</code>, then it doesn&#39;t access the unexported fields, it just knows that it&#39;s a struct. In fact, I don&#39;t think you can access unexported fields with <code>reflect</code>. That is the reason packages that work with your data, like <code>fmt</code> and <code>encoding&#47;json</code> need exported fields."}, {"owner": {"reputation": 3358, "user_id": 852385, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c0eac51aaa99541fb966854b5dcb131?s=128&d=identicon&r=PG", "display_name": "Helin Wang", "link": "https://stackoverflow.com/users/852385/helin-wang"}, "edited": false, "score": 0, "creation_date": 1489699261, "post_id": 42815827, "comment_id": 72798674, "body": "It prints <code>{[0x176f44] 0x176f44}</code>. I think reflect can access unexported field: <a href=\"http://stackoverflow.com/questions/17981651/in-go-is-there-any-way-to-access-private-fields-of-a-struct-from-another-packag\" title=\"in go is there any way to access private fields of a struct from another packag\">stackoverflow.com/questions/17981651/&hellip;</a>"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 3358, "user_id": 852385, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c0eac51aaa99541fb966854b5dcb131?s=128&d=identicon&r=PG", "display_name": "Helin Wang", "link": "https://stackoverflow.com/users/852385/helin-wang"}, "edited": false, "score": 0, "creation_date": 1489735672, "post_id": 42815827, "comment_id": 72810180, "body": "I guess I was wrong about reading unexported fields. So I don&#39;t really know why it doesn&#39;t use <code>String()</code>."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 4, "last_activity_date": 1489596181, "creation_date": 1489596181, "answer_id": 42815827, "question_id": 42815637, "link": "https://stackoverflow.com/questions/42815637/why-fmt-println-a-struct-does-not-use-string-method-of-its-members/42815827#42815827", "title": "Why fmt.Println a struct does not use String() method of it&#39;s members", "body": "<p>You have several problems in your code. You define <code>Stirng</code> on <code>bar</code> which is unexported, your fields are unexported as well. This works:</p>\n\n<pre><code>type Bar struct {\n}\n\nfunc (b Bar) String() string {\n    return \"bar\"\n}\n\ntype foo struct {\n    B  []Bar\n    BB Bar\n}\n\nfunc main() {\n    f := foo{B: []Bar{Bar{}}, BB: Bar{}}\n    fmt.Println(f)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/OhoIcB7cA3\" rel=\"nofollow noreferrer\">https://play.golang.org/p/OhoIcB7cA3</a>.</p>\n\n<p>This would also work with <code>*Bar</code>.</p>\n"}], "owner": {"reputation": 3358, "user_id": 852385, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c0eac51aaa99541fb966854b5dcb131?s=128&d=identicon&r=PG", "display_name": "Helin Wang", "link": "https://stackoverflow.com/users/852385/helin-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1489596181, "creation_date": 1489595612, "question_id": 42815637, "link": "https://stackoverflow.com/questions/42815637/why-fmt-println-a-struct-does-not-use-string-method-of-its-members", "title": "Why fmt.Println a struct does not use String() method of it&#39;s members", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype bar struct {\n}\n\nfunc (b bar) String() string {\n    return \"bar\"\n}\n\ntype foo struct {\n    b []*bar\n    bb *bar\n}\n\nfunc main() {\n    f := foo{b: []*bar{&amp;bar{}}, bb:&amp;bar{}}\n    fmt.Println(f, f.b, f.bb)\n}\n</code></pre>\n\n<p>Why the result is</p>\n\n<blockquote>\n  <p>{[0x176f44] 0x176f44} [bar] bar</p>\n</blockquote>\n\n<p>Not</p>\n\n<blockquote>\n  <p>{[bar] bar} [bar] bar</p>\n</blockquote>\n\n<p>Are there any reasons behind it? It seems easy to implement and good for readability.</p>\n"}, {"tags": ["go", "go-gorm", "sqlx"], "comments": [{"owner": {"reputation": 1642, "user_id": 1509169, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/8MgOC.jpg?s=128&g=1", "display_name": "Alexander R.", "link": "https://stackoverflow.com/users/1509169/alexander-r"}, "edited": false, "score": 0, "creation_date": 1489621710, "post_id": 42815331, "comment_id": 72757231, "body": "There is no magic. Just do first request to mysql for sites, then extract IDs using simple loop. Then do second request for posts with WHERE id IN(). Finally, build new data structures using two datasets using simple loops. Just use plain SQL with SQLx API that is pretty well documented."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "reply_to_user": {"reputation": 1642, "user_id": 1509169, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/8MgOC.jpg?s=128&g=1", "display_name": "Alexander R.", "link": "https://stackoverflow.com/users/1509169/alexander-r"}, "edited": false, "score": 0, "creation_date": 1489675002, "post_id": 42815331, "comment_id": 72783177, "body": "I am not expecting magic. I can write a function that will use my single SQL statement and create and fill out Site structures and Post structures. And I assume that I will have to write one. But I want to hide it inside the row scanning process, so at the surface I can use native SQLx APIs."}], "answers": [{"tags": [], "owner": {"reputation": 1041, "user_id": 7730968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kCdXw.png?s=128&g=1", "display_name": "kenfire", "link": "https://stackoverflow.com/users/7730968/kenfire"}, "is_accepted": false, "score": 0, "last_activity_date": 1506606553, "creation_date": 1506606553, "answer_id": 46470858, "question_id": 42815331, "link": "https://stackoverflow.com/questions/42815331/optimizing-sql-data-access-in-go/46470858#46470858", "title": "Optimizing SQL data access in go", "body": "<p><em>This might not be an answer but too long for a comment.</em></p>\n\n<p>If you are still using GORM you could have created a custom SQL.\nSee documentation: <a href=\"http://jinzhu.me/gorm/advanced.html#sql-builder\" rel=\"nofollow noreferrer\">http://jinzhu.me/gorm/advanced.html#sql-builder</a></p>\n\n<p>For you it could be something like this:\n</p>\n\n<pre><code>// Scan\n\ntype struct Post {\n    Id        uint      `json:\"-\"`\n    Title     string\n    SiteId    uint      `json:\"-\"`\n    Site      Site      `json:\"-\"`\n}\n\nvar result Post\n\ndb.Raw(\"\nSELECT s.id, s.name, p.title, p.published \nFROM sites as s, posts as p \nWHERE p.site_id = s.id\").Scan(&amp;result)\n</code></pre>\n"}], "owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 883, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1506606553, "creation_date": 1489594761, "last_edit_date": 1489601999, "question_id": 42815331, "link": "https://stackoverflow.com/questions/42815331/optimizing-sql-data-access-in-go", "title": "Optimizing SQL data access in go", "body": "<p>I am trying to switch an API implementation I have been working on from GORM ORM library to SQLx to make data access more efficient. In particular, I am trying to get rid of some SELECT N+1 problems. So, I have a one to many relationship where a site has posts. The API I am implementing returns a list of sites as a JSON object and each site has a nested <code>posts</code> list. The structure looks somewhat like this</p>\n\n<pre>\n{\n    \"sites\": [\n        {\n            \"id\": 1,\n            \"name\": \"Site #1\",\n            \"posts\" [\n                {\"title\": \"Post #1\", \"published\": \"1/2/2000\", ... },\n                {\"title\": \"Post #2\", \"published\": \"1/3/2000\", ... },\n                ... more posts ...\n            ]\n        },\n        {\n            \"id\": 2,\n            \"name\": \"Site #2\",\n            \"posts\": [\n                 ... post list for site #2 ...\n            ]\n        }\n        ... more sites ...\n   ]\n}\n</pre>\n\n<p>This was easy to implement in GORM, but once I looked at the SQL GORM was running to implement this, I realized that it was doing a SELECT from posts for every site in the list. So I am trying to use SQL like this to avoid the N+1 problem.</p>\n\n<pre>\nSELECT s.id, s.name, p.title, p.published \nFROM sites as s, posts as p \nWHERE p.site_id = s.id\n</pre>\n\n<p>This gets me all the data I need in a single query. But I am somewhat stuck on how to scan all of this into a list of site structs. In GORM, I had following structs defined (simplified for brevity)</p>\n\n<pre>\ntype struct Post {\n    Id        uint      `json:\"-\"`\n    Title     string\n    Published time.Time\n    SiteId    uint      `json:\"-\"`\n    Site      Site      `json:\"-\"`\n}\n\ntype struct Site {\n    Id   uint\n    Name string\n}\n</pre>\n\n<p>And then I would do something like</p>\n\n<pre>\nvar sites []Site\nresult := db.Preload('Posts').Find(&sites)\nif result.Error != nil {\n    ... error handling ...\n} else {\n   operate on sites here\n}\n</pre>\n\n<p>So the question is, how do I scan my new SQL using SQLx into a slice of structs in a way that results in a similar data structure that GORM produced? I don't mind writing my own scanner, but I still want to be able to use SQLx <code>Select()</code> and <code>Get()</code> methods. What do I need to do to make this work?</p>\n\n<pre>\nvar sites []Site\nerr := db.Select(query, &sites) // where query is SQL from above\n</pre>\n\n<p><strong>Edit:</strong> it seems that if I do the exact code I present in this question, GORM doesn't actually do N+1 selects, it runs two queries, one simple SELECT for sites and one SELECT ... WHERE ... IN ... for posts and then collates the two result sets. I still want to know how to do this in SQLx though.</p>\n"}, {"tags": ["go", "concurrency", "locking", "mutex", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1489591916, "last_edit_date": 1489591916, "creation_date": 1489590176, "answer_id": 42813487, "question_id": 42813322, "link": "https://stackoverflow.com/questions/42813322/go-maps-fails-the-concurency-test/42813487#42813487", "title": "Go maps fails the concurency test", "body": "<p>If you look at the error presented by the race detector, you would see that it reported concurrent writes on the <code>value = dictionary[\"Key\"]</code> line, meaning the race being detected is on <code>value</code>, not <code>dictionary</code>.</p>\n\n<p>You are concurrently accessing 2 variables, <code>dictionary</code> and <code>value</code>. You can't use the read lock to protect reads on the map, and writes to the <code>value</code> variable. You either need a second mutex, or you need to always use <code>mutex.Lock</code> to serialize access to both variables. </p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 7959546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c59a28109aaa304db6b086dd9dba39?s=128&d=identicon&r=PG&f=1", "display_name": "David S", "link": "https://stackoverflow.com/users/7959546/david-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1493843370, "creation_date": 1493843370, "answer_id": 43769438, "question_id": 42813322, "link": "https://stackoverflow.com/questions/42813322/go-maps-fails-the-concurency-test/43769438#43769438", "title": "Go maps fails the concurency test", "body": "<p>This code will work correctly:</p>\n\n<pre><code>    go func() {\n        mutex.Lock()\n        value = dictionary[\"Key\"]\n        mutex.Unlock()\n    }()\n</code></pre>\n\n<p>It protects the variable <em>value</em> from concurrent write. </p>\n"}], "owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 42813487, "answer_count": 2, "score": 0, "last_activity_date": 1493843370, "creation_date": 1489589776, "last_edit_date": 1489590134, "question_id": 42813322, "link": "https://stackoverflow.com/questions/42813322/go-maps-fails-the-concurency-test", "title": "Go maps fails the concurency test", "body": "<p>When I run the following code:</p>\n\n<pre><code>import (\n\"log\"\n\"sync\"\n\"testing\"\n\"time\"\n)\nfunc TestConcurrency(t *testing.T) {\nvar mutex sync.RWMutex\ndictionary := make(map[interface{}]interface{})\ngo func() {\n    var value interface{}\n    for {\n        go func() {\n            mutex.Lock()\n            dictionary[\"Key\"] = \"\"\n            mutex.Unlock()\n        }()\n\n        go func() {\n            mutex.RLock()\n            value = dictionary[\"Key\"]\n            mutex.RUnlock()\n        }()\n\n    }\n    log.Println(value)\n}()\n}\n</code></pre>\n\n<p>using :</p>\n\n<pre><code>go test -race fileName.go\n</code></pre>\n\n<p>It results in:</p>\n\n<pre><code>Found 1 data race(s)\n</code></pre>\n\n<p>How can I solve this? </p>\n\n<p>I have many concurrent writes and reads.</p>\n"}, {"tags": ["windows", "go"], "owner": {"reputation": 43, "user_id": 1353474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bc7e095d3a1bf1d16be82666508cfbf?s=128&d=identicon&r=PG", "display_name": "Spirit of Stallman", "link": "https://stackoverflow.com/users/1353474/spirit-of-stallman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1489588085, "creation_date": 1489588085, "question_id": 42812615, "link": "https://stackoverflow.com/questions/42812615/write-a-disk-image-with-golang-direct-drive-access", "title": "write a disk image with golang (direct drive access)", "body": "<p>Whether someone had experience with use of windows <a href=\"https://support.microsoft.com/uk-ua/help/100027/info-direct-drive-access-under-win32\" rel=\"nofollow noreferrer\">direct drive access</a> (raw device i/o) with Go?</p>\n\n<p>My purpose to write down an image (raw dd copy) to the flash drive.\nBut all my attempts to make it by means of stdlib or <a href=\"https://github.com/ncw/directio\" rel=\"nofollow noreferrer\">third-party</a> libs have failed with <code>Access is denied</code> error (even with admin rights). </p>\n\n<p>Maybe someone already has a recipe for right combinations of <code>os.FileMode</code>'s and file rights (for full access to <code>\\\\.\\PhysicalDrive{N}</code>), or some alternative solution? I would be very grateful.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1489581805, "post_id": 42809990, "comment_id": 72732328, "body": "Seems like your <code>GOPATH</code> should be your <code>GOROOT</code> and vice versa."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489582383, "post_id": 42809990, "comment_id": 72732753, "body": "what is the output of <code>go env</code>?"}, {"owner": {"reputation": 71, "user_id": 1085116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a258d72aa51fc564fda9fe3794c2e21?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Zhukov", "link": "https://stackoverflow.com/users/1085116/anton-zhukov"}, "edited": false, "score": 0, "creation_date": 1489582537, "post_id": 42809990, "comment_id": 72732883, "body": "updated my post"}, {"owner": {"reputation": 241, "user_id": 5427367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e56416b1e446e56c0c715732c918191c?s=128&d=identicon&r=PG&f=1", "display_name": "M-AbdalRahman", "link": "https://stackoverflow.com/users/5427367/m-abdalrahman"}, "edited": false, "score": 0, "creation_date": 1489583265, "post_id": 42809990, "comment_id": 72733468, "body": "try this: <code>export GOPATH=&quot;&#47;home&#47;azhukov&#47;go&quot;</code>  <code>export GOROOT=&quot;&#47;usr&#47;local&#47;go&quot;</code>  <code>go get -v github.com&#47;constabulary&#47;gb&#47;...</code>"}, {"owner": {"reputation": 241, "user_id": 5427367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e56416b1e446e56c0c715732c918191c?s=128&d=identicon&r=PG&f=1", "display_name": "M-AbdalRahman", "link": "https://stackoverflow.com/users/5427367/m-abdalrahman"}, "edited": false, "score": 2, "creation_date": 1489583420, "post_id": 42809990, "comment_id": 72733596, "body": "I think GOROOT not required"}, {"owner": {"reputation": 71, "user_id": 1085116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a258d72aa51fc564fda9fe3794c2e21?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Zhukov", "link": "https://stackoverflow.com/users/1085116/anton-zhukov"}, "edited": false, "score": 0, "creation_date": 1489583437, "post_id": 42809990, "comment_id": 72733611, "body": "didn&#39;t work, the same error message :("}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 1085116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a258d72aa51fc564fda9fe3794c2e21?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Zhukov", "link": "https://stackoverflow.com/users/1085116/anton-zhukov"}, "edited": false, "score": 0, "creation_date": 1489589053, "post_id": 42810929, "comment_id": 72738188, "body": "Thank you! Cleaning my GOPATH fixed the problem! I have no idea, how go might be installed in my home directory"}, {"owner": {"reputation": 738, "user_id": 1683651, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9cddc254f74976d30e6c812f76108e28?s=128&d=identicon&r=PG", "display_name": "Manas Paldhe", "link": "https://stackoverflow.com/users/1683651/manas-paldhe"}, "edited": false, "score": 9, "creation_date": 1495156170, "post_id": 42810929, "comment_id": 75144832, "body": "What do you mean by cleaning GOPATH?"}, {"owner": {"reputation": 576, "user_id": 1272013, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/769b3ccb233f1144eccad8c6038e8cf4?s=128&d=identicon&r=PG", "display_name": "cyc115", "link": "https://stackoverflow.com/users/1272013/cyc115"}, "edited": false, "score": 1, "creation_date": 1503332419, "post_id": 42810929, "comment_id": 78561359, "body": "I did <code>rm -rf $GOPATH</code> and that did the trick. make sure you don&#39;t have anything important in there though"}, {"owner": {"reputation": 992, "user_id": 1076887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a62932c4f50bc65c09d8d10d18056a2f?s=128&d=identicon&r=PG", "display_name": "mt.uulu", "link": "https://stackoverflow.com/users/1076887/mt-uulu"}, "edited": false, "score": 1, "creation_date": 1523633177, "post_id": 42810929, "comment_id": 86655844, "body": "he means removing from env variable: <code>unset GOPATH</code>"}, {"owner": {"reputation": 1092, "user_id": 5715599, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/10208320270154576/picture?type=large", "display_name": "Aidan Rosswood", "link": "https://stackoverflow.com/users/5715599/aidan-rosswood"}, "edited": false, "score": 0, "creation_date": 1560706960, "post_id": 42810929, "comment_id": 99815321, "body": "What does &quot;Cleaning out your GOPATH&quot; mean?"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 13, "last_activity_date": 1489583760, "creation_date": 1489583760, "answer_id": 42810929, "question_id": 42809990, "link": "https://stackoverflow.com/questions/42809990/go-get-cannot-download-home-azhukov-go-is-a-goroot-not-a-gopath/42810929#42810929", "title": "go get -&gt; cannot download, /home/azhukov/go is a GOROOT, not a GOPATH", "body": "<p>This error is caused by the <code>go</code> tool detecting a Go installation in your GOPATH. It's not telling you that your GOPATH is <em>the</em> GOROOT (that's a different message), it's telling your GOPATH looks like <em>a</em> GOROOT.</p>\n\n<p>Cleaning out your GOPATH and running <code>go get</code> again will fix the error. </p>\n"}, {"tags": [], "owner": {"reputation": 432, "user_id": 3398743, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1151161767/picture?type=large", "display_name": "Adesh Shah", "link": "https://stackoverflow.com/users/3398743/adesh-shah"}, "is_accepted": false, "score": -2, "last_activity_date": 1513145589, "creation_date": 1513145589, "answer_id": 47786661, "question_id": 42809990, "link": "https://stackoverflow.com/questions/42809990/go-get-cannot-download-home-azhukov-go-is-a-goroot-not-a-gopath/47786661#47786661", "title": "go get -&gt; cannot download, /home/azhukov/go is a GOROOT, not a GOPATH", "body": "<p>For mac,</p>\n\n<ol>\n<li><p>run <code>export GOPATH=$HOME/go</code> in terminal</p></li>\n<li><p>then run the <code>go get -u [url]</code></p></li>\n</ol>\n"}], "owner": {"reputation": 71, "user_id": 1085116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a258d72aa51fc564fda9fe3794c2e21?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Zhukov", "link": "https://stackoverflow.com/users/1085116/anton-zhukov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14167, "favorite_count": 0, "accepted_answer_id": 42810929, "answer_count": 2, "score": 6, "last_activity_date": 1619161547, "creation_date": 1489581478, "last_edit_date": 1489582523, "question_id": 42809990, "link": "https://stackoverflow.com/questions/42809990/go-get-cannot-download-home-azhukov-go-is-a-goroot-not-a-gopath", "title": "go get -&gt; cannot download, /home/azhukov/go is a GOROOT, not a GOPATH", "body": "<p>Good day! I am trying to install gb (vendoring tool for go) in Google Cloud.\nI try <code>go get</code> and it fails:</p>\n\n<pre><code>azhukov@gce-machine:~$ go get -v github.com/constabulary/gb/...\npackage github.com/pkg/errors: cannot download, /home/azhukov/go is a GOROOT, not a GOPATH. For more details see: 'go help gopath'\n</code></pre>\n\n<p>here is env:</p>\n\n<pre><code>azhukov@gce-machine:~$ echo $GOPATH, $GOROOT, $PATH\n/home/azhukov/go, , /usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/usr/local/go/bin:/home/azhukov/go/bin\n</code></pre>\n\n<p>go version:</p>\n\n<pre><code>azhukov@gce-machine:~$ go version\ngo version go1.8 linux/amd64\n</code></pre>\n\n<p>go env:</p>\n\n<pre><code>azhukov@gce-machine:~$ go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/azhukov/go\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\"\nGCCGO=\"gccgo\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build477416510=/tmp/go-build -gno-record-gcc-switches\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nPKG_CONFIG=\"pkg-config\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\n</code></pre>\n\n<p>To me everything looks fine, I don't get why would go get return such error. It is counter-logical.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 677, "user_id": 3761308, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e67dce3dde174a526dd403e299c25de?s=128&d=identicon&r=PG&f=1", "display_name": "user3761308", "link": "https://stackoverflow.com/users/3761308/user3761308"}, "edited": false, "score": 0, "creation_date": 1489571366, "post_id": 42805691, "comment_id": 72724952, "body": "Is there no way to use these methods for &#39;invalid&#39; URLS? Long explanation buy mt URL has to be &quot;/Foo/Bar&quot; format."}, {"owner": {"reputation": 677, "user_id": 3761308, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e67dce3dde174a526dd403e299c25de?s=128&d=identicon&r=PG&f=1", "display_name": "user3761308", "link": "https://stackoverflow.com/users/3761308/user3761308"}, "edited": false, "score": 0, "creation_date": 1489572022, "post_id": 42805691, "comment_id": 72725426, "body": "I just replaced all &quot;_&quot;-s with err and <code>if err != nil { \t\tfmt.Println(err) \t}</code> and none of them returned an error."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 677, "user_id": 3761308, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e67dce3dde174a526dd403e299c25de?s=128&d=identicon&r=PG&f=1", "display_name": "user3761308", "link": "https://stackoverflow.com/users/3761308/user3761308"}, "edited": false, "score": 0, "creation_date": 1489574201, "post_id": 42805691, "comment_id": 72727012, "body": "How could a HTTP request to an invalid URL succeed? Which host to contact when none is in the URL? So No."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 677, "user_id": 3761308, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e67dce3dde174a526dd403e299c25de?s=128&d=identicon&r=PG&f=1", "display_name": "user3761308", "link": "https://stackoverflow.com/users/3761308/user3761308"}, "edited": false, "score": 0, "creation_date": 1489574239, "post_id": 42805691, "comment_id": 72727035, "body": "<code>http.NewRequest(http.MethodPost, &quot;&#47;Bar&quot;, strings.NewReader(&quot;Foo&quot;))</code> fails."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 4, "last_activity_date": 1489570074, "creation_date": 1489570074, "answer_id": 42805691, "question_id": 42805424, "link": "https://stackoverflow.com/questions/42805424/golang-dumprequest-not-creating-correct-output-for-readrequest/42805691#42805691", "title": "Golang - DumpRequest() not creating correct output for ReadRequest()?", "body": "<p>Two things are wrong in your code: </p>\n\n<ol>\n<li><p>You must handle the errors. This would have helpesd you see that you never construct a valid request (\"/Bar\" is not a valid URL).</p></li>\n<li><p>Use <code>httputil.DumpRequestOut</code> for outgoing request.</p></li>\n</ol>\n\n<p>Takeaways: <strong>Always</strong> handle all errors and always read the whole <strong>whole</strong> package doc.</p>\n"}], "owner": {"reputation": 677, "user_id": 3761308, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e67dce3dde174a526dd403e299c25de?s=128&d=identicon&r=PG&f=1", "display_name": "user3761308", "link": "https://stackoverflow.com/users/3761308/user3761308"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1489571251, "creation_date": 1489569294, "last_edit_date": 1489571251, "question_id": 42805424, "link": "https://stackoverflow.com/questions/42805424/golang-dumprequest-not-creating-correct-output-for-readrequest", "title": "Golang - DumpRequest() not creating correct output for ReadRequest()?", "body": "<p>Creating a byte array of a http request and then trying to read it into a http.request doesn't seem to work when the request includes a body.</p>\n\n<pre><code>req, _ := http.NewRequest(http.MethodPost, \"/Bar\", strings.NewReader(\"Foo\"))\nrReq, _ := httputil.DumpRequest(req, true)\n\nreq2, _ := http.ReadRequest(bufio.NewReader(bytes.NewReader(rReq)))\nb, _ := ioutil.ReadAll(req2.Body)\nfmt.Println(b)\n</code></pre>\n\n<p>b is an empty array.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 424, "user_id": 1459578, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f0618fbfe872614be8f5fa14ee152d65?s=128&d=identicon&r=PG", "display_name": "Javad M. Amiri", "link": "https://stackoverflow.com/users/1459578/javad-m-amiri"}, "edited": false, "score": 0, "creation_date": 1489572654, "post_id": 42805033, "comment_id": 72725889, "body": "Thanks. My question was indeed what you answered in bullet No. 2."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 5, "last_activity_date": 1489568149, "creation_date": 1489568149, "answer_id": 42805033, "question_id": 42804766, "link": "https://stackoverflow.com/questions/42804766/whats-the-point-in-wrapping-a-function-in-a-function-type/42805033#42805033", "title": "What&#39;s the point in wrapping a function in a function type?", "body": "<p>Two main reasons:</p>\n\n<ol>\n<li><p>Convenience when receiving functions as arguments:</p>\n\n<pre><code>type LongFuncSig func(a int, b *int, c string, d *SomeWeirdThing, f map[string]*Foo, g ...interface{}) (*Result, error)\n\nfunc DoSomething(fn LongFuncSig) { ... }\nfunc DoSomethingElse(fn LongFuncSig) { ... }\nfunc DoYetAnotherThing(fn LongFuncSig) { ... }\n</code></pre>\n\n<p>Is much more readable, and less error-prone than:</p>\n\n<pre><code>func DoSomething(fn func(a int, b *int, c string, d *SomeWeirdThing, f map[string]*Foo, g ...interface{}) (*Result, error)) { ... }\nfunc DoSomethingElse(fn func(a int, b *int, c string, d *SomeWeirdThing, f map[string]*Foo, g ...interface{}) (*Result, error)) { ... }\nfunc DoYetAnotherThing(fn func(a int, b *int, c string, d *SomeWeirdThing, f map[string]*Foo, g ...interface{}) (*Result, error)) { ... }\n</code></pre></li>\n<li><p>When you want to attach methods to the type.</p>\n\n<p>In your example, <code>http.HandlerFunc</code> has an attached method, <a href=\"https://golang.org/pkg/net/http/#HandlerFunc.ServeHTTP\" rel=\"noreferrer\"><code>ServeHTTP</code></a>. This causes the function to satisfy the <a href=\"https://golang.org/pkg/net/http/#Handler\" rel=\"noreferrer\"><code>http.Handler</code></a> interface. It's only possible to attach methods to named types.</p>\n\n<p>And to answer your related question:</p>\n\n<blockquote>\n  <p>If we want to have a type that exposes a method why don't we create a struct type and add the method to it?</p>\n</blockquote>\n\n<p>Because there's no reason to do do that. The standard library <em>could</em> have chosen to take your suggestion with:</p>\n\n<pre><code>type HandlerFunc struct {\n    Func: func(ResponseWriter, *Request)\n}\n</code></pre>\n\n<p>But that's far more verbose, and harder to use and read. To use that, you'd then have to call:</p>\n\n<pre><code>http.HandlerFunc{Func: fn}\n</code></pre>\n\n<p>instead of the much simpler:</p>\n\n<pre><code>http.HandlerFunc(fn)\n</code></pre>\n\n<p>So there's no reason to add unnecessary complexity.</p></li>\n</ol>\n"}], "owner": {"reputation": 424, "user_id": 1459578, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f0618fbfe872614be8f5fa14ee152d65?s=128&d=identicon&r=PG", "display_name": "Javad M. Amiri", "link": "https://stackoverflow.com/users/1459578/javad-m-amiri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 1, "accepted_answer_id": 42805033, "answer_count": 1, "score": 7, "last_activity_date": 1489570775, "creation_date": 1489567308, "last_edit_date": 1489570775, "question_id": 42804766, "link": "https://stackoverflow.com/questions/42804766/whats-the-point-in-wrapping-a-function-in-a-function-type", "title": "What&#39;s the point in wrapping a function in a function type?", "body": "<p>I am new to golang and I've seen occasionally some code that wraps a function inside a function type. In http package we have this as well:</p>\n\n<pre><code>type HandlerFunc func(ResponseWriter, *Request)\n\nfunc (f HandlerFunc) ServeHTTP(w ResponseWriter, r *Request) {\n    f(w, r)\n}\n</code></pre>\n\n<p>I'm curious to know the reason behind. If we want to have a type that exposes a method why don't we create a struct type and add the method to it? </p>\n"}, {"tags": ["go", "network-protocols", "ntp", "gopacket"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1489593984, "post_id": 42802969, "comment_id": 72742243, "body": "I notice that you&#39;re ignoring the potential error returned from ReadPCAP. Please rethink that. So many problems could be avoided if people would handle their error returns."}, {"owner": {"reputation": 31, "user_id": 7713157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf42cac3fd4cf13c52f0838d65eb60b?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Singh", "link": "https://stackoverflow.com/users/7713157/anirudh-singh"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1489594363, "post_id": 42802969, "comment_id": 72742526, "body": "@ZanLynx Yeah, I need to do that. This was just for testing purposes. Thanks for the tip!"}, {"owner": {"reputation": 752, "user_id": 7496656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zMGuk.jpg?s=128&g=1", "display_name": "Jan Zerebecki", "link": "https://stackoverflow.com/users/7496656/jan-zerebecki"}, "edited": false, "score": 0, "creation_date": 1499688582, "post_id": 42802969, "comment_id": 76996737, "body": "Please include text output as text instead of an image (I assume that is why you got a downvote)."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 7713157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf42cac3fd4cf13c52f0838d65eb60b?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Singh", "link": "https://stackoverflow.com/users/7713157/anirudh-singh"}, "is_accepted": false, "score": 1, "last_activity_date": 1489591758, "creation_date": 1489591758, "answer_id": 42814128, "question_id": 42802969, "link": "https://stackoverflow.com/questions/42802969/ntp-detection-using-golang-payload-coming-up-empty/42814128#42814128", "title": "NTP detection using golang, payload coming up empty", "body": "<p>Reading through the golang soure code, I came across this :</p>\n\n<pre><code>// NTP packets do not carry any data payload, so the empty byte slice is retured.\n// In Go, a nil slice is functionally identical to an empty slice, so we\n// return nil to avoid a heap allocation.\nfunc (d *NTP) Payload() []byte {\n    return nil\n}\n</code></pre>\n\n<p>So, apparently it's not supposed to carry a Payload. I've managed to perform the detection using layers. </p>\n"}], "owner": {"reputation": 31, "user_id": 7713157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf42cac3fd4cf13c52f0838d65eb60b?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Singh", "link": "https://stackoverflow.com/users/7713157/anirudh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489591758, "creation_date": 1489560993, "question_id": 42802969, "link": "https://stackoverflow.com/questions/42802969/ntp-detection-using-golang-payload-coming-up-empty", "title": "NTP detection using golang, payload coming up empty", "body": "<p>I'm working on detecting NTP using golang and the gopacket package. I'm using a pcap I downloaded from wireshark. I've got the following code for opening PCAPs and handling them :</p>\n\n<pre><code>func (d *DPI) readPCAP(pcapFile string) (*pcap.Handle, error) {\n    // Open file instead of device\n    handle, err := pcap.OpenOffline(pcapFile)\n    if err != nil {\n        return nil, err\n    }\n    return handle, nil\n}\n</code></pre>\n\n<p>And this is the code I'm writing to perform the actual detection</p>\n\n<pre><code>func TestNTP(t *testing.T) {\n\n\n\n    dpi := newDPI()\n    handle, _ := dpi.readPCAP(\"data/pcap/NTP_sync.pcap\")\n\n    var filter = \"udp and port 123\"\n    dpi.setFilter(handle,filter)\n    ntpPackets := 0\n\n    for packet := range dpi.getPacketChan(handle) {\n        fmt.Println(\"stuff: \",packet.ApplicationLayer().Payload())\n        if dpi.detectNTP(packet) == 1 {\n            ntpPackets++\n        } else {\n            fmt.Println(\" Output : \", dpi.detectNTP(packet))\n        }\n    }\n    fmt.Println(\" Total ntp packets \", ntpPackets)\n\n\n}\n</code></pre>\n\n<p>The Payload content in the ApplicationLayer is coming up empty and I'm unable to figure out why this is happening.</p>\n\n<p>Example screenshot when I print out the ApplicationLayer itself : </p>\n\n<p><a href=\"https://i.gyazo.com/6257f298a09e7403bbc0be5b8ac84ccc.png\" rel=\"nofollow noreferrer\">https://i.gyazo.com/6257f298a09e7403bbc0be5b8ac84ccc.png</a></p>\n\n<p>Example screenshot when I print out the Payload :\n<a href=\"https://i.gyazo.com/7f4abd449025f5d65160fdbecffa8181.png\" rel=\"nofollow noreferrer\">https://i.gyazo.com/7f4abd449025f5d65160fdbecffa8181.png</a></p>\n\n<p>Could use some help figuring out what I'm doing wrong.\nThanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3848, "user_id": 6112401, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/dUCnB.jpg?s=128&g=1", "display_name": "vanloc", "link": "https://stackoverflow.com/users/6112401/vanloc"}, "edited": false, "score": 0, "creation_date": 1489560204, "post_id": 42802278, "comment_id": 72718730, "body": "Follow the link: <a href=\"https://github.com/grpc/grpc-go/issues/711\" rel=\"nofollow noreferrer\">github.com/grpc/grpc-go/issues/711</a>."}], "answers": [{"comments": [{"owner": {"reputation": 7990, "user_id": 4806357, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/KlW5A.jpg?s=128&g=1", "display_name": "Jarvis", "link": "https://stackoverflow.com/users/4806357/jarvis"}, "edited": false, "score": 0, "creation_date": 1489575597, "post_id": 42802790, "comment_id": 72728042, "body": "I did it, but it still doesn&#39;t work. I get an error in declaring an object like this : <code>r.Context undefined (type *http.Request has no field or method Context)</code>, where <code>r</code> is a pointer to an object of type <code>http.Request</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 7990, "user_id": 4806357, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/KlW5A.jpg?s=128&g=1", "display_name": "Jarvis", "link": "https://stackoverflow.com/users/4806357/jarvis"}, "edited": false, "score": 1, "creation_date": 1489580561, "post_id": 42802790, "comment_id": 72731414, "body": "@Jarvis I believe  <code>http.Request.Context</code> is available only since 1.7. If you want to use <code>r.Context</code> you need to upgrade from 1.6.2 to 1.7+, then you&#39;ll also be able to use <code>import &quot;context&quot;</code>. Here are the 1.7 <a href=\"https://golang.org/doc/go1.7#net_http\" rel=\"nofollow noreferrer\">net/http release notes</a>."}], "tags": [], "owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "is_accepted": true, "score": 22, "last_activity_date": 1489560357, "creation_date": 1489560357, "answer_id": 42802790, "question_id": 42802278, "link": "https://stackoverflow.com/questions/42802278/install-context-package-in-golang/42802790#42802790", "title": "Install &quot;context&quot; package in golang?", "body": "<p>change <code>import \"context\"</code> to <code>import \"golang.org/x/net/context\"</code>.</p>\n\n<p>but after go 1.7 you can use <code>import \"context\"</code>, as it had become a standard library.</p>\n\n<blockquote>\n  <p>Go 1.7 moves the golang.org/x/net/context package into the standard library as context. </p>\n</blockquote>\n\n<p>see 1.7 release notes: <a href=\"https://golang.org/doc/go1.7#context\" rel=\"noreferrer\">https://golang.org/doc/go1.7#context</a></p>\n"}, {"tags": [], "owner": {"reputation": 908, "user_id": 3649496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c95010d46812ccabe7eea947a090ab?s=128&d=identicon&r=PG&f=1", "display_name": "infiniteLearner", "link": "https://stackoverflow.com/users/3649496/infinitelearner"}, "is_accepted": false, "score": 1, "last_activity_date": 1586855738, "creation_date": 1586855738, "answer_id": 61204315, "question_id": 42802278, "link": "https://stackoverflow.com/questions/42802278/install-context-package-in-golang/61204315#61204315", "title": "Install &quot;context&quot; package in golang?", "body": "<p>I faced similar issue , below are the steps to fix:</p>\n\n<ol>\n<li><p>Download the latest version  <a href=\"https://golang.org/doc/install?download=go1.9.2.linux-arm64.tar.gz\" rel=\"nofollow noreferrer\">https://golang.org/doc/install?download=go1.9.2.linux-arm64.tar.gz</a></p></li>\n<li><p>Extract the tar to /usr/local/ .</p></li>\n</ol>\n\n<p>Use Command ->\n<strong>tar -xzvf go1.9.2.linux-arm64.tar.gz -C /usr/local</strong></p>\n\n<ol start=\"3\">\n<li>Replace the symlink pointing to go:</li>\n</ol>\n\n<p><strong>sudo rm /usr/bin/go<br>\nsudo ln -s /usr/local/go/bin/go /usr/bin/go</strong></p>\n\n<p><em>Reference: <a href=\"https://github.com/DieterReuter/arm64-docker-builder/issues/7\" rel=\"nofollow noreferrer\">https://github.com/DieterReuter/arm64-docker-builder/issues/7</a></em></p>\n"}], "owner": {"reputation": 7990, "user_id": 4806357, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/KlW5A.jpg?s=128&g=1", "display_name": "Jarvis", "link": "https://stackoverflow.com/users/4806357/jarvis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29459, "favorite_count": 5, "accepted_answer_id": 42802790, "answer_count": 2, "score": 19, "last_activity_date": 1586855738, "creation_date": 1489558350, "last_edit_date": 1489559677, "question_id": 42802278, "link": "https://stackoverflow.com/questions/42802278/install-context-package-in-golang", "title": "Install &quot;context&quot; package in golang?", "body": "<p>I'm trying to install the <code>context</code> package in golang, which I did like this :</p>\n\n<pre><code>go get golang.org/x/net/context\n</code></pre>\n\n<p>But when I do an <code>import \"context\"</code>, I still get the following error :</p>\n\n<pre><code>cannot find package \"context\" in any of:\n/usr/lib/go-1.6/src/context (from $GOROOT)\n/home/saurabh/work/src/context (from $GOPATH)\n</code></pre>\n\n<p>Can anyone suggest how to install this package ? I'm currently using version <code>go1.6.2</code>.</p>\n"}, {"tags": ["go", "struct", "types", "interface"], "comments": [{"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1598317466, "post_id": 42802229, "comment_id": 112413022, "body": "It may be worth noting that APIs that take in a one-method <code>interface</code> could be re-written as taking a function type. See <a href=\"https://stackoverflow.com/a/63557675/12817546\">stackoverflow.com/a/63557675/12817546</a>."}], "answers": [{"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 3, "last_activity_date": 1489562512, "last_edit_date": 1489562512, "creation_date": 1489561112, "answer_id": 42802998, "question_id": 42802229, "link": "https://stackoverflow.com/questions/42802229/inheritance-and-interfaces/42802998#42802998", "title": "Inheritance and interfaces", "body": "<p>Base implies you want inheritance in Go, Go deliberately eschews inheritance, don't try to recreate it. You can embed types but think of this as embedding behaviour, not just data (as you might be tempted to in an inheriting language). </p>\n\n<p>You're on the right lines with your solution but need public methods and yes interfaces are defined in terms of methods. Just define the interface where you call it as:</p>\n\n<pre><code>type Doer interface {\nDoSomething()\n}\n\n...\nfunc doit(d Doer) {\n   d.DoSomething()\n}\n</code></pre>\n\n<p>doit doesn't care what its argument is as long as it has a DoSomething method. Obviously this is a trivial example and there's no point in it, but if you need to override something in all extenders, ask yourself why Base exists, if it is just to add some fields, that's probably not enough reason for a separate type, just add the fields where you need them. </p>\n\n<p>Try to avoid the vast taxonomies of types that you might construct in other languages.</p>\n"}, {"tags": [], "owner": {"reputation": 5461, "user_id": 307881, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/bfc59549c88454a426040bb7abaab3d1?s=128&d=identicon&r=PG", "display_name": "Vervious", "link": "https://stackoverflow.com/users/307881/vervious"}, "is_accepted": false, "score": 0, "last_activity_date": 1489587072, "creation_date": 1489587072, "answer_id": 42812224, "question_id": 42802229, "link": "https://stackoverflow.com/questions/42802229/inheritance-and-interfaces/42812224#42812224", "title": "Inheritance and interfaces", "body": "<p>To add on, a common pattern I use is:</p>\n\n<pre><code>type Base interface {\n    SomeFunction() int\n}\n\ntype SimpleBaseImpl struct {\n    // Unique fields\n}\n\nfunc (s SimpleBaseImpl) SomeFunction() int {\n    return 0\n}\n\ntype SomethingMoreComplicated struct {\n    SimpleBaseImpl\n    // Unique fields\n}\n</code></pre>\n\n<p>Then you could treat <code>SomethingMoreComplicated</code> as \"type\" <code>Base</code> \u2013 but again, its important to note the golang preference for composition (shown here) over inheritance.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6467981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 42802998, "answer_count": 2, "score": 2, "last_activity_date": 1489587072, "creation_date": 1489558196, "question_id": 42802229, "link": "https://stackoverflow.com/questions/42802229/inheritance-and-interfaces", "title": "Inheritance and interfaces", "body": "<p>I want to express the <code>extends</code> behavior many languages possess.</p>\n\n<p>In my Go Code I have a few structs that look like so:</p>\n\n<pre><code>type Base struct {\n        // Some fields\n}\n\ntype BaseExtender struct {\n        Base\n        // Unique fields\n}\n\ntype AnotherBaseExtender struct {\n        Base\n        // Unique fields\n}\n</code></pre>\n\n<p>Now, I want to write a function that takes any <code>Base</code> since I only need it's \"similar fields\".</p>\n\n<pre><code>func UseTheBase(b Base) {\n        testVal := b.thingICareAbout\n}\n</code></pre>\n\n<p>However, this doesn't work. I've done some digging into <code>interface</code> and thought I could do something like:</p>\n\n<pre><code>type Base interface {\n        // Some fields\n}\n</code></pre>\n\n<p>Except it appears that Go automatically infers interfaces by <em>method implementation</em>. Is there a way to mimic this behavior so I can pass any <code>Base</code> into my function, and not have to implement some nop method on the <code>Base</code> struct and all of it's extenders?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 4291, "user_id": 304215, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/cVby7.jpg?s=128&g=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/304215/suresh"}, "edited": false, "score": 0, "creation_date": 1489560538, "post_id": 42802536, "comment_id": 72718869, "body": "It&#39;s working now. Thanks for the help. I&#39;m a bit new to golang. I&#39;ve just gone through a course from codeschool.com &amp; jumped into this. That&#39;s why not aware of all these deep criticalities. Can you refer me some more links for golang which will help me understand such tricky things?"}, {"owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "reply_to_user": {"reputation": 4291, "user_id": 304215, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/cVby7.jpg?s=128&g=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/304215/suresh"}, "edited": false, "score": 0, "creation_date": 1489562233, "post_id": 42802536, "comment_id": 72719680, "body": "It&#39;s very worthy to spend some time on <a href=\"https://golang.org/doc/\" rel=\"nofollow noreferrer\">golang.org/doc</a>, <code>Language Specification</code>/ <code>Effective Go</code>/<code>FAQ</code> are imperative."}, {"owner": {"reputation": 4291, "user_id": 304215, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/cVby7.jpg?s=128&g=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/304215/suresh"}, "edited": false, "score": 0, "creation_date": 1489562338, "post_id": 42802536, "comment_id": 72719739, "body": "Got it. Thank you again."}], "tags": [], "owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "is_accepted": true, "score": 3, "last_activity_date": 1489559680, "last_edit_date": 1489559680, "creation_date": 1489559346, "answer_id": 42802536, "question_id": 42802136, "link": "https://stackoverflow.com/questions/42802136/golang-error-missing-type-in-composite-literal/42802536#42802536", "title": "Golang error - missing type in composite literal", "body": "<p>you should use <code>named type</code> for <code>ProductSpec</code>/<code>DisplaySpec</code>/<code>FilterSpec</code>.</p>\n\n<p>try this:</p>\n\n<pre><code> type DisplaySpecType struct {\n        SpecID string `json:\"spec_id\"`\n        Sdv    string `json:\"sdv\"`\n        Snv    string `json:\"snv\"`\n}\n\ntype FilterSpecType struct {\n        SpecID string `json:\"spec_id\"`\n        Sdv    string `json:\"sdv\"`\n        Snv    string `json:\"snv\"`\n}\ntype ProductSpecType struct {\n        DisplaySpec []DisplaySpecType `json:\"display_spec\"`\n        FilterSpec  []FilterSpecType  `json:\"filter_spec\"`\n}\n\ntype Product struct {\n        ProductDisplayname string          `json:\"product_displayname\"`\n        ProductPrice       string          `json:\"product_price\"`\n        Popularity         string          `json:\"popularity\"`\n        Barcode            string          `json:\"barcode\"`\n        ExclusiveFlag      string          `json:\"exclusive_flag\"`\n        ProductID          string          `json:\"product_id\"`\n        ProductName        string          `json:\"product_name\"`\n        BrandName          string          `json:\"brand_name\"`\n        BrandID            string          `json:\"brand_id\"`\n        ProductSpec        ProductSpecType `json:\"product_spec\"`\n}\n\nvar productData = Product{ProductDisplayname: \"LG Stylus 2 Plus K535D (16 GB, Brown)\", ProductPrice: \"24000.00\", Popularity: \"0.00\", Barcode: \"\", ExclusiveFlag: \"0\", ProductID: \"17698276\", ProductName: \"Stylus 2 Plus K535D (Brown)\", BrandName: \"LG\", BrandID: \"1\", ProductSpec: ProductSpecType{DisplaySpec: []DisplaySpecType{DisplaySpecType{SpecID: \"103\", Sdv: \"24000\", Snv: \"24000.0000\"}, DisplaySpecType{SpecID: \"104\", Sdv: \"GSM\", Snv: \"0.0000\"}}, FilterSpec: []FilterSpecType{FilterSpecType{SpecID: \"103\", Sdv: \"24000\", Snv: \"24000.0000\"}, FilterSpecType{SpecID: \"105\", Sdv: \"Touch Screen\", Snv: \"0.0000\"}}}}\n</code></pre>\n\n<p>see <a href=\"https://golang.org/ref/spec#Types\" rel=\"nofollow noreferrer\">here</a> for <code>named/unamed type</code>.</p>\n"}], "owner": {"reputation": 4291, "user_id": 304215, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/cVby7.jpg?s=128&g=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/304215/suresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9573, "favorite_count": 0, "closed_date": 1559571414, "accepted_answer_id": 42802536, "answer_count": 1, "score": 1, "last_activity_date": 1548445275, "creation_date": 1489557711, "last_edit_date": 1489558935, "question_id": 42802136, "link": "https://stackoverflow.com/questions/42802136/golang-error-missing-type-in-composite-literal", "closed_reason": "Duplicate", "title": "Golang error - missing type in composite literal", "body": "<p>I'm new to Golang &amp; trying to build bulk upload script to Elasticsearch. Wrote one sample code to do the thing but getting one simple error <code>\"missing type in composite literal\"</code>. </p>\n\n<p>I google about this. Got some reference post but I really can't able to fig. out what I'm missing.</p>\n\n<p><strong>My main.go file</strong> -</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"golang.org/x/net/context\"\n    \"gopkg.in/olivere/elastic.v5\"\n    \"strconv\"\n)\n\ntype Product struct {\n    ProductDisplayname string `json:\"product_displayname\"`\n    ProductPrice       string `json:\"product_price\"`\n    Popularity         string `json:\"popularity\"`\n    Barcode            string `json:\"barcode\"`\n    ExclusiveFlag      string `json:\"exclusive_flag\"`\n    ProductID          string `json:\"product_id\"`\n    ProductName        string `json:\"product_name\"`\n    BrandName          string `json:\"brand_name\"`\n    BrandID            string `json:\"brand_id\"`\n    ProductSpec        struct {\n        DisplaySpec []struct {\n            SpecID string `json:\"spec_id\"`\n            Sdv    string `json:\"sdv\"`\n            Snv    string `json:\"snv\"`\n        } `json:\"display_spec\"`\n        FilterSpec []struct {\n            SpecID string `json:\"spec_id\"`\n            Sdv    string `json:\"sdv\"`\n            Snv    string `json:\"snv\"`\n        } `json:\"filter_spec\"`\n    } `json:\"product_spec\"`\n}\n\nfunc main() {\n    // Create a context\n    ctx := context.Background()\n\n    client, err := elastic.NewClient()\n    if err != nil {\n        fmt.Println(\"%v\", err)\n    }\n\n    // Bulk upload code\n    n := 0\n    for i := 0; i &lt; 1000; i++ {\n        bulkRequest := client.Bulk()\n        for j := 0; j &lt; 10000; j++ {\n            n++\n            productData := Product{ProductDisplayname: \"LG Stylus 2 Plus K535D (16 GB, Brown)\", ProductPrice: \"24000.00\", Popularity: \"0.00\", Barcode: \"\", ExclusiveFlag: \"0\", ProductID: \"17698276\", ProductName: \"Stylus 2 Plus K535D (Brown)\", BrandName: \"LG\", BrandID: \"1\", ProductSpec: {DisplaySpec: {SpecID: \"103\", Sdv: \"24000\", Snv: \"24000.0000\"}, {SpecID: \"104\", Sdv: \"GSM\", Snv: \"0.0000\"}, FilterSpec: {SpecID: \"103\", Sdv: \"24000\", Snv: \"24000.0000\"}, {SpecID: \"105\", Sdv: \"Touch Screen\", Snv: \"0.0000\"}}}\n            req := elastic.NewBulkIndexRequest().Index(\"shopfront\").Type(\"products\").Id(strconv.Itoa(n)).Doc(productData)\n            bulkRequest = bulkRequest.Add(req)\n        }\n\n        bulkResponse, err := bulkRequest.Do(ctx)\n        if err != nil {\n            fmt.Println(err)\n        }\n        if bulkResponse != nil {\n            fmt.Println(bulkResponse)\n        }\n        fmt.Println(i)\n    }\n}\n</code></pre>\n\n<p>Need some help.</p>\n"}, {"tags": ["cookies", "go", "session-cookies", "csrf", "csrf-protection"], "answers": [{"tags": [], "owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "is_accepted": true, "score": 4, "last_activity_date": 1489556911, "creation_date": 1489556911, "answer_id": 42801963, "question_id": 42801631, "link": "https://stackoverflow.com/questions/42801631/can-i-use-session-cookie-instead-of-csrf/42801963#42801963", "title": "can I use session cookie instead of csrf?", "body": "<p>Suppose a user has logged into your site, and has continued to browse the Internet in the same session. They stumble across another site which is maliciously targeting yours, with HTML or JS that causes the user's browser to make a request to an endpoint on your site. This will contain the user's session cookie for your domain, and succeed unless protected by a CSRF token.</p>\n"}], "owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 42801963, "answer_count": 1, "score": 0, "last_activity_date": 1489556911, "creation_date": 1489555160, "question_id": 42801631, "link": "https://stackoverflow.com/questions/42801631/can-i-use-session-cookie-instead-of-csrf", "title": "can I use session cookie instead of csrf?", "body": "<p>I have been reading about csrf and fiddliN around with implementing it using go and gorilla toolkit. I am also using gorilla sessions which i have implemented to store a user id in an encrypted cookie.</p>\n\n<p>the cookie is decrypted and i fetch the user from the db with the now unencrypted key-value store using a middleware I wrote...</p>\n\n<p>if the user is creating the session cookie from authentication through an oauth2 provider, do i have any need to implement csrf protection if all the views that need such protection are only allowed to authed users anyway?</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3", "aws-sdk-go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489584518, "post_id": 42799213, "comment_id": 72734423, "body": "Active connections are normal for an HTTP client, and you may have multiple connections to each remote host you&#39;ve contacted. Do these grow unbounded?"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 7711880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4746cb210c29c30a3f46ac054f75dc51?s=128&d=identicon&r=PG&f=1", "display_name": "jessesuen", "link": "https://stackoverflow.com/users/7711880/jessesuen"}, "is_accepted": false, "score": 0, "last_activity_date": 1489604670, "creation_date": 1489604670, "answer_id": 42818594, "question_id": 42799213, "link": "https://stackoverflow.com/questions/42799213/goroutine-leak-in-aws-sdk-go/42818594#42818594", "title": "Goroutine leak in aws-sdk-go?", "body": "<p>It turns out I was incorrect in stating that the routines do not disappear over time. If I add a 10 second sleep after the call to GetBucketLocation, before printing out the stack of the goroutines, then the extra routines do indeed disappear.</p>\n\n<p>I believe the reason for this, is that golang's net/http package maintains some kind of connection pool that can be reused. See the following discussion:\n<a href=\"https://groups.google.com/forum/#!topic/golang-nuts/QckzdZmzlk0\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/golang-nuts/QckzdZmzlk0</a></p>\n\n<p>Waiting long enough seems to eventually close the connections and stop the goroutines.</p>\n"}], "owner": {"reputation": 36, "user_id": 7711880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4746cb210c29c30a3f46ac054f75dc51?s=128&d=identicon&r=PG&f=1", "display_name": "jessesuen", "link": "https://stackoverflow.com/users/7711880/jessesuen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 688, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1489604670, "creation_date": 1489538611, "last_edit_date": 1489539209, "question_id": 42799213, "link": "https://stackoverflow.com/questions/42799213/goroutine-leak-in-aws-sdk-go", "title": "Goroutine leak in aws-sdk-go?", "body": "<p>I have the following snippit of code using current aws-sdk-go release v1.7.9.</p>\n\n<pre><code>sess, _ := session.NewSession()\ns3client := s3.New(sess)\nlocation, err := s3client.GetBucketLocation(&amp;s3.GetBucketLocationInput{Bucket: &amp;bucket})\n</code></pre>\n\n<p>I log the callstack before and after the call to GetBucketLocation(). I see the total number of goroutines increase by two, with these two extra goroutines running afterwards:</p>\n\n<pre><code>goroutine 45 [IO wait]:\nnet.runtime_pollWait(0x2029008, 0x72, 0x8)\n        /usr/local/Cellar/go/1.7.4_2/libexec/src/runtime/netpoll.go:160 +0x59\nnet.(*pollDesc).wait(0xc420262610, 0x72, 0xc42003e6f0, 0xc4200121b0)\n        /usr/local/Cellar/go/1.7.4_2/libexec/src/net/fd_poll_runtime.go:73 +0x38\nnet.(*pollDesc).waitRead(0xc420262610, 0xbcb200, 0xc4200121b0)\n        /usr/local/Cellar/go/1.7.4_2/libexec/src/net/fd_poll_runtime.go:78 +0x34\nnet.(*netFD).Read(0xc4202625b0, 0xc42022fc00, 0x400, 0x400, 0x0, 0xbcb200, 0xc4200121b0)\n        /usr/local/Cellar/go/1.7.4_2/libexec/src/net/fd_unix.go:243 +0x1a1\nnet.(*conn).Read(0xc42023c068, 0xc42022fc00, 0x400, 0x400, 0x0, 0x0, 0x0)\n        /usr/local/Cellar/go/1.7.4_2/libexec/src/net/net.go:173 +0x70\ncrypto/tls.(*block).readFromUntil(0xc42017c060, 0x2029248, 0xc42023c068, 0x5, 0xc42023c068, 0xc400000000)\n        /usr/local/Cellar/go/1.7.4_2/libexec/src/crypto/tls/conn.go:476 +0x91\ncrypto/tls.(*Conn).readRecord(0xc42029a000, 0x840917, 0xc42029a108, 0xc420116ea0)\n        /usr/local/Cellar/go/1.7.4_2/libexec/src/crypto/tls/conn.go:578 +0xc4\ncrypto/tls.(*Conn).Read(0xc42029a000, 0xc420196000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n        /usr/local/Cellar/go/1.7.4_2/libexec/src/crypto/tls/conn.go:1113 +0x116\nnet/http.(*persistConn).Read(0xc42000ba00, 0xc420196000, 0x1000, 0x1000, 0x23d3b0, 0xc42003eb58, 0x7a8d)\n        /usr/local/Cellar/go/1.7.4_2/libexec/src/net/http/transport.go:1261 +0x154\nbufio.(*Reader).fill(0xc42000cba0)\n        /usr/local/Cellar/go/1.7.4_2/libexec/src/bufio/bufio.go:97 +0x10c\nbufio.(*Reader).Peek(0xc42000cba0, 0x1, 0xc42003ebbd, 0x1, 0x0, 0xc42000cc00, 0x0)\n        /usr/local/Cellar/go/1.7.4_2/libexec/src/bufio/bufio.go:129 +0x62\nnet/http.(*persistConn).readLoop(0xc42000ba00)\n        /usr/local/Cellar/go/1.7.4_2/libexec/src/net/http/transport.go:1418 +0x1a1\ncreated by net/http.(*Transport).dialConn\n        /usr/local/Cellar/go/1.7.4_2/libexec/src/net/http/transport.go:1062 +0x4e9\n\ngoroutine 46 [select]:\nnet/http.(*persistConn).writeLoop(0xc42000ba00)\n        /usr/local/Cellar/go/1.7.4_2/libexec/src/net/http/transport.go:1646 +0x3bd\ncreated by net/http.(*Transport).dialConn\n        /usr/local/Cellar/go/1.7.4_2/libexec/src/net/http/transport.go:1063 +0x50e\n</code></pre>\n\n<p>These routines do not disappear over time and they continue to accumulate as more calls are made to GetBucketLocation().</p>\n\n<p>Am I doing something wrong (neglecting to close some resource) or is there a goroutine leak happening in aws-sdk-go?</p>\n\n<p>Note the same behavior is observed with the <code>s3manager.Downloader::Download()</code> function.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7711754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75a980591135d233e727658a8866c281?s=128&d=identicon&r=PG&f=1", "display_name": "Tom S.", "link": "https://stackoverflow.com/users/7711754/tom-s"}, "edited": false, "score": 1, "creation_date": 1489582213, "post_id": 42802191, "comment_id": 72732647, "body": "Nice, thanks!  I was thinking in the wrong direction, trying to add the receiver to the array declaration like this:     var updaters = [2](*Stock)func(int) {..."}], "tags": [], "owner": {"reputation": 86, "user_id": 2986516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2828643fe010f7f8296666af00d075c6?s=128&d=identicon&r=PG&f=1", "display_name": "netdigger", "link": "https://stackoverflow.com/users/2986516/netdigger"}, "is_accepted": true, "score": 0, "last_activity_date": 1489557993, "creation_date": 1489557993, "answer_id": 42802191, "question_id": 42798507, "link": "https://stackoverflow.com/questions/42798507/declaring-array-of-receiver-methods/42802191#42802191", "title": "Declaring array of receiver methods", "body": "<p>You can do like these:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Stock struct {\n    qty int\n}\n\nvar updaters = [2]func(*Stock, int){\n    func(s *Stock, i int){s.add(i)},\n    func(s *Stock, i int){s.remove(i)},\n}\n\nfunc main() {\n    s := Stock{10}\n\n    fmt.Println(\"Stock count =\", s.qty)\n\n    updaters[0](&amp;s, 2)\n\n    fmt.Println(\"Stock count =\", s.qty)\n\n    updaters[1](&amp;s, 5)\n\n    fmt.Println(\"Stock count =\", s.qty)\n}\n\nfunc (s *Stock)add(add int) {\n    s.qty += add\n}\n\nfunc (s *Stock)remove(sub int) {\n    s.qty -= sub\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7711754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75a980591135d233e727658a8866c281?s=128&d=identicon&r=PG&f=1", "display_name": "Tom S.", "link": "https://stackoverflow.com/users/7711754/tom-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 42802191, "answer_count": 1, "score": 0, "last_activity_date": 1489557993, "creation_date": 1489534545, "question_id": 42798507, "link": "https://stackoverflow.com/questions/42798507/declaring-array-of-receiver-methods", "title": "Declaring array of receiver methods", "body": "<p>Here's a small example using an array of functions.  I want to convert this to an array of receiver methods.  What would be the proper declaration for the array on line 11?  <a href=\"https://play.golang.org/p/G62Cxm-OG2\" rel=\"nofollow noreferrer\">https://play.golang.org/p/G62Cxm-OG2</a><br /><br />\nThe function declarations would change from:<br />\nfunc addToStock(s *Stock, add int)<br /><br />\nTo:<br />\nfunc (s *Stock) addToStock(add int)</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1489534572, "post_id": 42798467, "comment_id": 72711636, "body": "If I set up a TLS connection as I would normally do, then http2 is automatically added?"}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1489534810, "post_id": 42798467, "comment_id": 72711717, "body": "Btw will this change the procedure to upgrading to Websocket connections in any way? Would I still be able to the gorilla/websocket for example?"}, {"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "reply_to_user": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 1, "creation_date": 1489534919, "post_id": 42798467, "comment_id": 72711756, "body": "It should automatically do http2, yes.  And no, it shouldn&#39;t change the procedure for upgrading to websocket."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1489535442, "post_id": 42798467, "comment_id": 72711897, "body": "Thanks for the help!"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 3, "last_activity_date": 1489534343, "last_edit_date": 1592644375, "creation_date": 1489534343, "answer_id": 42798467, "question_id": 42798419, "link": "https://stackoverflow.com/questions/42798419/how-can-i-set-up-a-http2-server-in-go-1-8-without-third-party-libraries/42798467#42798467", "title": "How can I set up a http2 server in Go 1.8 without third party libraries?", "body": "<p>You just use <code>net/http</code> in most instances:</p>\n<blockquote>\n<p>Starting with Go 1.6, the http package has transparent support for the HTTP/2 protocol when using HTTPS.</p>\n<p>The http package's Transport and Server both automatically enable HTTP/2 support for simple configurations. To enable HTTP/2 for more complex configurations, to use lower-level HTTP/2 features, or to use a newer version of Go's http2 package, import &quot;golang.org/x/net/http2&quot; directly and use its ConfigureTransport and/or ConfigureServer functions. Manually configuring HTTP/2 via the golang.org/x/net/http2 package takes precedence over the net/http package's built-in HTTP/2 support.</p>\n</blockquote>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 843, "favorite_count": 0, "accepted_answer_id": 42798467, "answer_count": 1, "score": 2, "last_activity_date": 1489534343, "creation_date": 1489534102, "question_id": 42798419, "link": "https://stackoverflow.com/questions/42798419/how-can-i-set-up-a-http2-server-in-go-1-8-without-third-party-libraries", "title": "How can I set up a http2 server in Go 1.8 without third party libraries?", "body": "<p>I heard that http2 would be supported in the latest Go versions. How can I put up a http2 server without using <code>golang.org/x/net/http2</code>?</p>\n\n<p>In previous versions you could do something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"os\"\n\n    \"golang.org/x/net/http2\"\n)\n\nfunc main() {\n    cwd, err := os.Getwd()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    srv := &amp;http.Server{\n        Addr:    \":443\",\n        Handler: http.FileServer(http.Dir(cwd)),\n    }\n    http2.ConfigureServer(srv, &amp;http2.Server{})\n    log.Fatal(srv.ListenAndServeTLS(\"server.crt\", \"server.key\"))\n}\n</code></pre>\n"}, {"tags": ["xml", "go", "xml-parsing"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": false, "score": 1, "last_activity_date": 1489529580, "creation_date": 1489529580, "answer_id": 42797557, "question_id": 42797465, "link": "https://stackoverflow.com/questions/42797465/xml-parsing-with-a-root-level-element/42797557#42797557", "title": "XML parsing with a root level element", "body": "<p>Yes, you can do this. Simply remove the wrapping <code>Xml</code> element and unmarshal <code>Message</code> directly:</p>\n\n<pre><code>type Message struct {\n    Att string `xml:\"att,attr\"`\n}\n</code></pre>\n\n\n\n<pre><code>var x = Message{}\nerr := xml.Unmarshal([]byte(`&lt;message att='Hello'/&gt;`), &amp;x)\nif err != nil {\n    panic(err)\n}\nfmt.Println(x)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/EdtaWLm6Cl\" rel=\"nofollow noreferrer\">https://play.golang.org/p/EdtaWLm6Cl</a></p>\n"}], "owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489529583, "creation_date": 1489529198, "last_edit_date": 1489529583, "question_id": 42797465, "link": "https://stackoverflow.com/questions/42797465/xml-parsing-with-a-root-level-element", "title": "XML parsing with a root level element", "body": "<p>Is it possible to parse root level XML elements?</p>\n\n<p>This XML is without any wrapper <code>&lt;message att='Hello'/&gt;</code></p>\n\n<pre><code>var x = Xml{}\nxml.Unmarshal([]byte(`&lt;message att='Hello'/&gt;`), &amp;x)\nfmt.Println(x)\n</code></pre>\n\n<p>Xml Struct</p>\n\n<pre><code>type Xml struct {\n    Message struct {\n        Att string `xml:\"att,attr\"`\n    } `xml:\"message\"`\n}\n</code></pre>\n"}, {"tags": ["go", "docker", "cross-compiling", "cgo", "lsusb"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489525233, "post_id": 42796310, "comment_id": 72707583, "body": "Have you tried using <code>CC_FOR_TARGET</code> and <code>CXX_FOR_TARGET</code>?"}, {"owner": {"reputation": 569, "user_id": 1286132, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8aD2x.jpg?s=128&g=1", "display_name": "Joseph Roberts", "link": "https://stackoverflow.com/users/1286132/joseph-roberts"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489526037, "post_id": 42796310, "comment_id": 72707962, "body": "@JimB Same error"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489526183, "post_id": 42796310, "comment_id": 72708046, "body": "You could try using <code>-x</code> to make sure the compiler invocations are all as expected."}, {"owner": {"reputation": 569, "user_id": 1286132, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8aD2x.jpg?s=128&g=1", "display_name": "Joseph Roberts", "link": "https://stackoverflow.com/users/1286132/joseph-roberts"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489526511, "post_id": 42796310, "comment_id": 72708204, "body": "I have posted an update, the linked files are not being included properly @JimB"}], "answers": [{"comments": [{"owner": {"reputation": 569, "user_id": 1286132, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8aD2x.jpg?s=128&g=1", "display_name": "Joseph Roberts", "link": "https://stackoverflow.com/users/1286132/joseph-roberts"}, "edited": false, "score": 2, "creation_date": 1489568954, "post_id": 42800103, "comment_id": 72723305, "body": "Yeah, it didn&#39;t seem to help. Thanks"}], "tags": [], "owner": {"reputation": 86, "user_id": 2986516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2828643fe010f7f8296666af00d075c6?s=128&d=identicon&r=PG&f=1", "display_name": "netdigger", "link": "https://stackoverflow.com/users/2986516/netdigger"}, "is_accepted": false, "score": 0, "last_activity_date": 1489545241, "creation_date": 1489545241, "answer_id": 42800103, "question_id": 42796310, "link": "https://stackoverflow.com/questions/42796310/cross-compile-using-go-build-cgo-enabled-warning-libudev-so-1-not-found/42800103#42800103", "title": "Cross-compile using go build CGO_ENABLED - warning: libudev.so.1 not found", "body": "<p>The path of <i>libudev.so.1</i> is error.</p>\n\n<p>It should be in one of these directories:</p>\n\n<pre><code>./arm-linux-gnueabihf/lib\n./arm-linux-gnueabihf/libc/lib\n./arm-linux-gnueabihf/libc/usr/lib\n</code></pre>\n\n<p>But I am sorry that I forget which directory is right. So you can try to copy <i>libudev.so.1</i> to all of these directories.</p>\n"}, {"tags": [], "owner": {"reputation": 115, "user_id": 1273406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2be992d8a8cd8b523ca0b1467e165376?s=128&d=identicon&r=PG", "display_name": "\u039blisue", "link": "https://stackoverflow.com/users/1273406/%ce%9blisue"}, "is_accepted": false, "score": 0, "last_activity_date": 1615920629, "creation_date": 1615920629, "answer_id": 66661594, "question_id": 42796310, "link": "https://stackoverflow.com/questions/42796310/cross-compile-using-go-build-cgo-enabled-warning-libudev-so-1-not-found/66661594#66661594", "title": "Cross-compile using go build CGO_ENABLED - warning: libudev.so.1 not found", "body": "<p>I know that this is an old post but I've faced a similar issue on Rust thus I decided to post my workaround as a memo.</p>\n<h3>tl;dr</h3>\n<p>Use <code>-rpath-link</code> to tell <code>ld</code> a correct path. With Rust, use <code>RUSTFLAGS</code> like:</p>\n<pre><code>RUSTFLAGS=&quot;-C link-arg=-Wl,-rpath-link,/lib/arm-linux-gnueabihf&quot;\n</code></pre>\n<h3>speculation</h3>\n<p>It seems that the <code>/usr/lib/arm-linux-gnueabihf</code> is specified through <code>libdir</code> in <code>libusb-1.0.pc</code> like:</p>\n<pre><code>prefix=/usr\nexec_prefix=${prefix}\nlibdir=${prefix}/lib/arm-linux-gnueabihf\nincludedir=${prefix}/include\n\nName: libusb-1.0\nDescription: C API for USB device access from Linux, Mac OS X, Windows, OpenBSD/NetBSD and Solaris userspace\nVersion: 1.0.21\nLibs: -L${libdir} -lusb-1.0\nLibs.private: -ludev  -pthread\nCflags: -I${includedir}/libusb-1.0\n</code></pre>\n<p>but <code>/lib/arm-linux-gnueabihf</code> is specified through <code>libdir</code> in <code>libudev.pc</code> like:</p>\n<pre><code>#  SPDX-License-Identifier: LGPL-2.1+\n#\n#  This file is part of systemd.\n#\n#  systemd is free software; you can redistribute it and/or modify it\n#  under the terms of the GNU Lesser General Public License as published by\n#  the Free Software Foundation; either version 2.1 of the License, or\n#  (at your option) any later version.\n\nprefix=/usr\nexec_prefix=/usr\nlibdir=/lib/arm-linux-gnueabihf\nincludedir=/usr/include\n\nName: libudev\nDescription: Library to access udev device information\nVersion: 237\nLibs: -L${libdir} -ludev\nCflags: -I${includedir}\n</code></pre>\n<p>So I've tried</p>\n<ul>\n<li>Create a symlink from <code>/lib/arm-linux-gnueabihf/libudev.so.1</code> to <code>/usr/lib/arm-linux-gnueabihf/libudev.so.1</code></li>\n<li>Add <code>/lib/arm-linux-gnueabihf</code> to <code>LD_LIBRARY_PATH</code></li>\n</ul>\n<p>But only <code>-rpath-link</code> worked.</p>\n"}], "owner": {"reputation": 569, "user_id": 1286132, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8aD2x.jpg?s=128&g=1", "display_name": "Joseph Roberts", "link": "https://stackoverflow.com/users/1286132/joseph-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1188, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1615920629, "creation_date": 1489524683, "last_edit_date": 1489592272, "question_id": 42796310, "link": "https://stackoverflow.com/questions/42796310/cross-compile-using-go-build-cgo-enabled-warning-libudev-so-1-not-found", "title": "Cross-compile using go build CGO_ENABLED - warning: libudev.so.1 not found", "body": "<p>I am trying to cross-compile a Golang application for a Raspberry Pi with <code>CGO_ENABLED=1</code> due to a <code>libusb</code> dependency</p>\n\n<p>During compilation I get the error:</p>\n\n<pre><code>arm-linux-gnueabihf/bin/ld: warning: libudev.so.1, needed by /usr/lib/arm-linux-gnueabihf/libusb-1.0.so, not found (try using -rpath or -rpath-link)\n</code></pre>\n\n<p>I have tried multiple variations of the command below with no luck:</p>\n\n<pre><code>CGO_ENABLED=1 GOARCH=arm GOARM=7 PKG_CONFIG_LIBDIR=/usr/lib/arm-linux-gnueabihf/pkgconfig:/usr/lib/pkgconfig:/usr/share/pkgconfig CC=arm-linux-gnueabihf-gcc CXX=arm-linux-gnueabihf-g++ go build -x -ldflags '-extld=arm-linux-gnueabihf-gcc -rpath=/usr/lib/arm-linux-gnueabihf -L/usr/lib/arm-linux-gnueabihf -ludev'\n</code></pre>\n\n<p>When I run the build with the <code>-x</code> flag I get the verbose output, and it kinda looks like its failing whilst building the <code>src/net</code> package:</p>\n\n<pre><code>cd /usr/local/go/src/net\n/usr/local/go/pkg/tool/linux_amd64/cgo -dynpackage net -dynimport $WORK/net/_obj/_cgo_.o -dynout $WORK/net/_obj/_cgo_import.go\narm-linux-gnueabihf-gcc -I . -fPIC -marm -pthread -fmessage-length=0 -fdebug-prefix-map=$WORK=/tmp/go-build -gno-record-gcc-switches -o $WORK/net/_obj/_all.o $WORK/net/_obj/_cgo_export.o $WORK/net/_obj/cgo_linux.cgo2.o $WORK/net/_obj/cgo_resnew.cgo2.o $WORK/net/_obj/cgo_socknew.cgo2.o $WORK/net/_obj/cgo_unix.cgo2.o -g -O2 -Wl,-r -nostdlib -Wl,--build-id=none\n/usr/local/go/pkg/tool/linux_amd64/compile -o $WORK/net.a -trimpath $WORK -p net -buildid 9e58c94d1ddeba63666a35ecee9409056baf5d3c -D _/usr/local/go/src/net -I $WORK -pack ./addrselect.go ./conf.go ./dial.go ./dnsclient.go ./dnsclient_unix.go ./dnsconfig_unix.go ./dnsmsg.go ./fd_mutex.go ./fd_poll_runtime.go ./fd_posix.go ./fd_unix.go ./file.go ./file_unix.go ./hook.go ./hook_cloexec.go ./hook_unix.go ./hosts.go ./interface.go ./interface_linux.go ./ip.go ./iprawsock.go ./iprawsock_posix.go ./ipsock.go ./ipsock_posix.go ./lookup.go ./lookup_unix.go ./mac.go ./net.go ./nss.go ./parse.go ./pipe.go ./port.go ./port_unix.go ./sendfile_linux.go ./sock_cloexec.go ./sock_linux.go ./sock_posix.go ./sockopt_linux.go ./sockopt_posix.go ./sockoptip_linux.go ./sockoptip_posix.go ./tcpsock.go ./tcpsock_posix.go ./tcpsockopt_posix.go ./tcpsockopt_unix.go ./udpsock.go ./udpsock_posix.go ./unixsock.go ./unixsock_posix.go ./writev_unix.go $WORK/net/_obj/_cgo_gotypes.go $WORK/net/_obj/cgo_linux.cgo1.go $WORK/net/_obj/cgo_resnew.cgo1.go $WORK/net/_obj/cgo_socknew.cgo1.go $WORK/net/_obj/cgo_unix.cgo1.go $WORK/net/_obj/_cgo_import.go\n# github.com/resin-io/edge-node-manager/vendor/github.com/kylelemons/gousb/usb\n/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian-x64/bin/../lib/gcc/arm-linux-gnueabihf/4.8.3/../../../../arm-linux-gnueabihf/bin/ld: warning: libudev.so.1, needed by /usr/lib/arm-linux-gnueabihf/libusb-1.0.so, not found (try using -rpath or -rpath-link)\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_monitor_filter_add_match_subsystem_devtype@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_monitor_enable_receiving@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_enumerate_scan_devices@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_new@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_device_get_devnode@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_enumerate_new@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_list_entry_get_name@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_enumerate_add_match_subsystem@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_device_get_sysname@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_enumerate_get_list_entry@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_device_new_from_syspath@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_monitor_new_from_netlink@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_monitor_receive_device@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_device_unref@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_enumerate_unref@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_monitor_get_fd@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_list_entry_get_next@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_monitor_unref@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `clock_gettime@GLIBC_2.17'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_unref@LIBUDEV_183'\n/usr/lib/arm-linux-gnueabihf/libusb-1.0.so: undefined reference to `udev_device_get_action@LIBUDEV_183'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>The strange thing is that the compiler can find <code>/usr/lib/arm-linux-gnueabihf/libusb-1.0.so</code> and if I do <code>ls -al</code> in that directory <code>libudev.so</code> is also present. Both files linking back to <code>/lib/arm-linux-gnueabihf/</code></p>\n\n<pre><code>lrwxrwxrwx 1 root root     41 Jan  7 04:14 libudev.so -&gt; /lib/arm-linux-gnueabihf/libudev.so.1.5.0\n-rw-r--r-- 1 root root 105464 Jun 16  2014 libusb-1.0.a\nlrwxrwxrwx 1 root root     44 Jun 16  2014 libusb-1.0.so -&gt; /lib/arm-linux-gnueabihf/libusb-1.0.so.0.1.0\ndrwxr-xr-x 2 root root   4096 Mar 15 14:48 pkgconfig\n</code></pre>\n\n<p><code>/usr/lib/arm-linux-gnueabihf/pkgconfig</code> contains:</p>\n\n<pre><code>-rw-r--r-- 1 root root  513 Jan  7 04:13 libudev.pc\n-rw-r--r-- 1 root root  332 Jun 16  2014 libusb-1.0.pc\n</code></pre>\n\n<p>Finally, running <code>file</code> shows both <code>libusb</code> and <code>libudev</code> to be the correct architecture:</p>\n\n<pre><code>/lib/arm-linux-gnueabihf/libusb-1.0.so.0.1.0: ELF 32-bit LSB shared object, ARM, EABI5 version 1 (SYSV), dynamically linked, BuildID[sha1]=7d7b487c91042c1f254b39516b4aeabedfb828fc, stripped\n/lib/arm-linux-gnueabihf/libudev.so.1.5.0: ELF 32-bit LSB shared object, ARM, EABI5 version 1 (SYSV), dynamically linked, BuildID[sha1]=334f4f0d8b1222a324ccd0827c1613fdd1e2ec15, stripped\n</code></pre>\n"}, {"tags": ["database", "go", "time-series"], "answers": [{"comments": [{"owner": {"reputation": 284, "user_id": 1462824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd4c938a7a8405fdda269552e4eceac6?s=128&d=identicon&r=PG", "display_name": "Keith Nordstrom", "link": "https://stackoverflow.com/users/1462824/keith-nordstrom"}, "edited": false, "score": 0, "creation_date": 1489527151, "post_id": 42796655, "comment_id": 72708541, "body": "I wondered if something that might be the case. And yes, the docs on your github did make it seem like the go bindings would work with the 3.4 distro. Thanks for updating.  I just looked over your docs on smart grid. Is there a way to install a single node container without ceph, kubernetes, etc.? Our stack takes up a lot of room on my local VM and right now I\u2019m more interested in testing software integrations with your API in as simple an environment as possible."}], "tags": [], "owner": {"reputation": 16, "user_id": 7711325, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VroEFfk0BB8/AAAAAAAAAAI/AAAAAAAAG7g/0cawvOZNOH0/photo.jpg?sz=128", "display_name": "Michael Andersen", "link": "https://stackoverflow.com/users/7711325/michael-andersen"}, "is_accepted": true, "score": 0, "last_activity_date": 1489525983, "creation_date": 1489525983, "answer_id": 42796655, "question_id": 42795775, "link": "https://stackoverflow.com/questions/42795775/btrdb-failure-to-connect/42796655#42796655", "title": "BTrDB Failure to connect", "body": "<p>It seems like you are using the v3 server container with the v4 binding libraries.</p>\n\n<p>It is definitely recommended to use v4, so you can try setting up the v4 stack by following the guide at <a href=\"https://docs.smartgrid.store\" rel=\"nofollow noreferrer\">smartgrid.store</a></p>\n\n<p>That stack assumes you are using kubernetes and ceph, but you can also set up a development deployment using minikube and no ceph, although the documentation is a little thinner there.</p>\n\n<p>To get faster responses, you can also email btrdb@googlegroups.com</p>\n\n<p>EDIT: it does seem like the out of date readme led you astray. I'll update that now. Thanks</p>\n"}], "owner": {"reputation": 284, "user_id": 1462824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd4c938a7a8405fdda269552e4eceac6?s=128&d=identicon&r=PG", "display_name": "Keith Nordstrom", "link": "https://stackoverflow.com/users/1462824/keith-nordstrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 42796655, "answer_count": 1, "score": 0, "last_activity_date": 1489525983, "creation_date": 1489522757, "question_id": 42795775, "link": "https://stackoverflow.com/questions/42795775/btrdb-failure-to-connect", "title": "BTrDB Failure to connect", "body": "<p>I have a copy of the BTrDB container running on my VM and a Go program that's trying to test it by taking data from a CSV and inserting it. Unfortunately, I get errors when trying to connect</p>\n\n<pre><code>ctx, _ := context.WithDeadline(context.TODO(), time.Now().Add(time.Duration(30)*time.Second))\n_, err := btrdb.Connect(ctx, \"192.168.99.100:4410\")\nif err != nil {\n    log.Fatal(\"Unexpected connection error: %v\", err)\n}\n</code></pre>\n\n<p>yields</p>\n\n<blockquote>\n  <p>2017/03/14 14:09:17 transport: http2Client.notifyError got notified that the client transport was broken read tcp 192.168.99.1:54212->192.168.99.100:4410: read: connection reset by peer.<br>\n  2017/03/14 14:09:17 Unexpected connection error: %vCould not connect to cluster via provided endpoints<br>\n  attempt to obtain MASH from 192.168.99.100:4410 yielded rpc error: code = Internal desc = transport is closing</p>\n</blockquote>\n\n<p>I have the container installed per the instructions on the GitHub page, with a few modifications</p>\n\n<pre><code>docker network create mynet\ndocker run -d --net mynet --name btrmongo mongo:3.2\ndocker run -it --net mynet -v /Users/keithnordstrom/btrdata:/srv -e BTRDB_MONGO_SERVER=btrmongo.mynet btrdb/release:3.4 makedb\ndocker run -d --name btrdb --net mynet -v /Users/keithnordstrom/btrdata:/srv -p 4410:4410 -e BTRDB_MONGO_SERVER=btrmongo.mynet btrdb/release:3.4\n</code></pre>\n\n<p>Here's a concurrent sample of the log from the BTrDB side</p>\n\n<blockquote>\n  <p>2017/03/14 20:08:28 main.go:114 \u25b6 Still alive<br>\n  2017/03/14 20:08:28 blockcache.go:20 \u25b6 Cachestats: 0 misses, 0 hits, NaN %<br>\n  2017/03/14 20:08:28 main.go:47 \u25b6 Num goroutines: 16<br>\n  2017/03/14 20:08:29 main.go:47 \u25b6 Num goroutines: 16<br>\n  2017/03/14 20:08:30 main.go:47 \u25b6 Num goroutines: 16<br>\n  2017/03/14 20:08:31 main.go:47 \u25b6 Num goroutines: 16<br>\n  2017/03/14 20:08:32 cpinterface.go:59 \u25b6 cpnp connection<br>\n  2017/03/14 20:08:32 cpinterface.go:64 \u25b6 ERR (%v) :: %v 192.168.99.1:54212 capn: too much data in stream<br>\n  2017/03/14 20:08:32 cpinterface.go:59 \u25b6 cpnp connection<br>\n  2017/03/14 20:08:32 cpinterface.go:64 \u25b6 ERR (%v) :: %v 192.168.99.1:54213 EOF<br>\n  2017/03/14 20:08:32 main.go:47 \u25b6 Num goroutines: 16<br>\n  2017/03/14 20:08:33 main.go:114 \u25b6 Still alive      </p>\n</blockquote>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1489542377, "post_id": 42795382, "comment_id": 72713699, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/28052933/how-should-i-define-an-empty-slice-in-go/28053182\" title=\"how should i define an empty slice in go\">stackoverflow.com/questions/28052933/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1489597021, "post_id": 42795438, "comment_id": 72744333, "body": "The last bit isn&#39;t right. Per the spec: &quot;The built-in function new takes a type T, allocates storage for a variable of that type at run time, and returns a value of type *T pointing to it. The variable is initialized as described in the section on initial values.&quot; So *new([]int) should be equivalent to []int{}."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1489597632, "post_id": 42795438, "comment_id": 72744687, "body": "@Adrian: <code>new</code> can&#39;t initialize a slice. The zero value for a slice is nil, so you get an initialized pointer to a nil slice. <a href=\"https://play.golang.org/p/lVL9Tkxk_D\" rel=\"nofollow noreferrer\">play.golang.org/p/lVL9Tkxk_D</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1489598036, "post_id": 42795438, "comment_id": 72744949, "body": "Ahh, fair point. It&#39;s way too easy to confuse the mechanics of slices and arrays sometimes."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 7, "last_activity_date": 1489527049, "last_edit_date": 1489527049, "creation_date": 1489521539, "answer_id": 42795438, "question_id": 42795382, "link": "https://stackoverflow.com/questions/42795382/whats-the-difference-between-makeint-0-int-and-newint/42795438#42795438", "title": "What&#39;s the difference between make([]int, 0), []int{}, and *new([]int)?", "body": "<p>This initializes a 0 length slice. </p>\n\n<pre><code>make([]int, 0)\n</code></pre>\n\n<p>Using <code>make</code> is the only way to initialize a slice with a specific capacity different than the length. This allocates a slice with 0 length, but a capacity of 1024. </p>\n\n<pre><code>make([]int, 0, 1024)\n</code></pre>\n\n<p>This is a slice literal, which also initializes a 0 length slice. Using this or <code>make([]int, 0)</code> is solely preference. </p>\n\n<pre><code>[]int{}\n</code></pre>\n\n<p>This initializes a <em>pointer</em> to a slice, which is immediately dereferenced. The slice itself has not been initialized and will still be nil, so this essentially does nothing, and is equivalent to <code>[]int(nil)</code></p>\n\n<pre><code>*new([]int)\n</code></pre>\n"}], "owner": {"reputation": 86, "user_id": 597260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a734b57900a075b08538714f183a201a?s=128&d=identicon&r=PG", "display_name": "yefim", "link": "https://stackoverflow.com/users/597260/yefim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1014, "favorite_count": 1, "accepted_answer_id": 42795438, "answer_count": 1, "score": 4, "last_activity_date": 1489527049, "creation_date": 1489521346, "question_id": 42795382, "link": "https://stackoverflow.com/questions/42795382/whats-the-difference-between-makeint-0-int-and-newint", "title": "What&#39;s the difference between make([]int, 0), []int{}, and *new([]int)?", "body": "<p>According to <a href=\"https://play.golang.org/p/7RPExbwOEU\" rel=\"nofollow noreferrer\">https://play.golang.org/p/7RPExbwOEU</a> they all print the same and have the same length and capacity. Is there a difference between the three ways to initialize a slice? Is there a preferred way? I find myself using both <code>make([]int, 0)</code> and <code>[]int{}</code> with the same frequency.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489521165, "post_id": 42795286, "comment_id": 72705160, "body": "&quot;firefox cant find the server &quot; --- is it in the DNS? What IP does it resolve to? What exactly &quot;cant find&quot; means?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1489521363, "post_id": 42795286, "comment_id": 72705283, "body": "How do you intend to resolve &quot;www.blog.localhost&quot;? Are you running  local DNS server, or have you entered all the possible subdomains in your hosts file?"}, {"owner": {"reputation": 473, "user_id": 3273138, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/mFU9l.jpg?s=128&g=1", "display_name": "Conner", "link": "https://stackoverflow.com/users/3273138/conner"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489522300, "post_id": 42795286, "comment_id": 72705790, "body": "@zerkms I am running on a local vm machine with firefox. 127.0.0.1:8080/ works. blog.127.0.0.1:8080 does not. Firefox gives no status code. The response is blank when I inspect the network."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1489522810, "post_id": 42795286, "comment_id": 72706133, "body": "@Conner: that&#39;s not how DNS works, you can&#39;t just prepend text to an IP address and have that resolve to something, <code>blog.127.0.0.1:8080</code> isn&#39;t a valid host. You also can&#39;t prepend subdomains to <code>localhost</code> without first defining them somewhere."}, {"owner": {"reputation": 473, "user_id": 3273138, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/mFU9l.jpg?s=128&g=1", "display_name": "Conner", "link": "https://stackoverflow.com/users/3273138/conner"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489523782, "post_id": 42795286, "comment_id": 72706700, "body": "@JimB Thank you for the information! I updated the hosts to point to the local host but still run into the same issue. I am guessing that pointing them all to the same host does nothing though. I&#39;ll be working on it."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489528008, "post_id": 42795286, "comment_id": 72708945, "body": "What &quot;the same issue&quot; is? You have not explained what &quot;cannot reach them&quot; is."}], "answers": [{"comments": [{"owner": {"reputation": 473, "user_id": 3273138, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/mFU9l.jpg?s=128&g=1", "display_name": "Conner", "link": "https://stackoverflow.com/users/3273138/conner"}, "edited": false, "score": 0, "creation_date": 1489552464, "post_id": 42798072, "comment_id": 72716068, "body": "I implemented your first solution and it works perfectly! I will have to read more into the ServeMux and Virtual Hosting. Thank you!"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 3, "last_activity_date": 1489532145, "creation_date": 1489532145, "answer_id": 42798072, "question_id": 42795286, "link": "https://stackoverflow.com/questions/42795286/golang-how-to-handle-and-serve-subdomains/42798072#42798072", "title": "Golang: How to handle and serve subdomains?", "body": "<p>Given the hosts file in your second edit, you can point firefox to, for example, <code>blog.localhost.com:8080</code> but then you also have to handle that domain pattern, i.e. <code>http.HandleFunc(blogDomain+\":8080/\", blogIndex)</code>.</p>\n\n<p>If that's not what you want you can instead listen on port <code>80</code> i.e. <code>http.ListenAndServe(\":80\", nil)</code>, you might need to run your app in sudo so that it has permission to use that port, then your <code>blog.localhost.com</code> should work.</p>\n"}], "owner": {"reputation": 473, "user_id": 3273138, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/mFU9l.jpg?s=128&g=1", "display_name": "Conner", "link": "https://stackoverflow.com/users/3273138/conner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3047, "favorite_count": 1, "accepted_answer_id": 42798072, "answer_count": 1, "score": 1, "last_activity_date": 1489532145, "creation_date": 1489521010, "last_edit_date": 1489525245, "question_id": 42795286, "link": "https://stackoverflow.com/questions/42795286/golang-how-to-handle-and-serve-subdomains", "title": "Golang: How to handle and serve subdomains?", "body": "<p>The problem is serving the domain as well as subdomains x,y,z (or in this example blog, admin, and design). When running the following and requesting blog.localhost:8080/ firefox cant find the server www.blog.localhost:8080.</p>\n\n<pre><code>package main\n\nimport (\n    \"html/template\"\n    \"log\"\n    \"net/http\"\n)\n\nvar tpl *template.Template\n\nconst (\n    domain = \"localhost\"\n    blogDomain = \"blog.\" + domain\n    adminDomain = \"admin.\" + domain\n    designDomain = \"design.\" + domain\n)\n\n\nfunc init() {\n     tpl = template.Must(template.ParseGlob(\"templates/*.gohtml\"))\n}\n\nfunc main() {\n\n\n    // Default Handlers\n    http.HandleFunc(\"/\", index)\n\n    // Blog Handlers\n    http.HandleFunc(blogDomain+\"/\", blogIndex)\n\n    // Admin Handlers\n    http.HandleFunc(adminDomain+\"/\", adminIndex)\n\n    // Design Handlers\n    http.HandleFunc(designDomain+\"/\", designIndex)\n\n    http.Handle(\"/static/\", http.StripPrefix(\"/static\", http.FileServer(http.Dir(\"static\"))))\n    http.ListenAndServe(\":8080\", nil) \n\n}\n\nfunc index(res http.ResponseWriter, req *http.Request) {\n    err := tpl.ExecuteTemplate(res, \"index.gohtml\", nil)\n    if err != nil {\n        log.Fatalln(\"template didn't execute: \", err)\n    }\n}\n\n// Blog Handlers\nfunc blogIndex(res http.ResponseWriter, req *http.Request) {\n    err := tpl.ExecuteTemplate(res, \"index.gohtml\", nil)\n    if err != nil {\n        log.Fatalln(\"template didn't execute: \", err)\n    }\n}\n\n// Admin Handlers\nfunc adminIndex(res http.ResponseWriter, req *http.Request) {\n    err := tpl.ExecuteTemplate(res, \"index.gohtml\", nil)\n    if err != nil {\n        log.Fatalln(\"template didn't execute: \", err)\n    }\n}\n\n// Design Handlers\nfunc designIndex(res http.ResponseWriter, req *http.Request) {\n    err := tpl.ExecuteTemplate(res, \"index.gohtml\", nil)\n    if err != nil {\n        log.Fatalln(\"template didn't execute: \", err)\n    }\n}\n</code></pre>\n\n<p>Is it possible to serve subdomains using the standard library? If so how?</p>\n\n<p><strong>EDIT:</strong> Requesting localhost:8080/ works fine</p>\n\n<p><strong>EDIT2:</strong> I edited /etc/hosts to include the subdomains:</p>\n\n<pre><code>127.0.0.1 blog.localhost.com\n127.0.0.1 admin.localhost.com\n127.0.0.1 design.localhost.com\n</code></pre>\n\n<p>Pinging them works correctly but firefox cannot reach them.</p>\n"}, {"tags": ["c++", "go", "swig"], "answers": [{"comments": [{"owner": {"reputation": 10607, "user_id": 5666087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0eeb62bd4c02b40a8751ab3368368d02?s=128&d=identicon&r=PG&f=1", "display_name": "jakub", "link": "https://stackoverflow.com/users/5666087/jakub"}, "edited": false, "score": 0, "creation_date": 1489588339, "post_id": 42804011, "comment_id": 72737557, "body": "Thanks, this clears up how to use <code>go build</code> without <code>swig</code>. However, I get a similar error as I got when using <code>swig</code>: <code>linker command failed</code> (and many symbols were not found). The linker cannot find <code>LSL&#47;liblsl&#47;bin&#47;liblsl.dylib</code>. I tried running <code>go build -ldflags &quot;-L ..&#47;liblsl&#47;bin -l lsl&quot; app.go</code> but got the same linker error."}, {"owner": {"reputation": 14732, "user_id": 1026572, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a74388494ea3475fe5a99a04d6120bcc?s=128&d=identicon&r=PG", "display_name": "dragonx", "link": "https://stackoverflow.com/users/1026572/dragonx"}, "reply_to_user": {"reputation": 10607, "user_id": 5666087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0eeb62bd4c02b40a8751ab3368368d02?s=128&d=identicon&r=PG&f=1", "display_name": "jakub", "link": "https://stackoverflow.com/users/5666087/jakub"}, "edited": false, "score": 1, "creation_date": 1489619666, "post_id": 42804011, "comment_id": 72756546, "body": "Have you tried specifying the dylib to link as a cgo comment?  <a href=\"http://stackoverflow.com/questions/16747021/how-do-you-statically-link-a-c-library-in-go-using-cgo\" title=\"how do you statically link a c library in go using cgo\">stackoverflow.com/questions/16747021/&hellip;</a>"}], "tags": [], "owner": {"reputation": 14732, "user_id": 1026572, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a74388494ea3475fe5a99a04d6120bcc?s=128&d=identicon&r=PG", "display_name": "dragonx", "link": "https://stackoverflow.com/users/1026572/dragonx"}, "is_accepted": true, "score": 3, "last_activity_date": 1489677430, "last_edit_date": 1489677430, "creation_date": 1489564839, "answer_id": 42804011, "question_id": 42794318, "link": "https://stackoverflow.com/questions/42794318/wrapping-c-with-go-build/42804011#42804011", "title": "Wrapping C++ with Go build", "body": "<p>I ran into this a few months ago, took longer to figure out than I would have liked, but I don't remember exactly what I did to fix it, but I think it was along these lines:</p>\n\n<ol>\n<li>Don't call swig manually, it actually makes things a bit more difficult.  Clean out the files generate by swig.</li>\n<li><p>Create a file a.go in libsl-Generic with the contents:</p>\n\n<pre><code>package libsls-Generic\n</code></pre></li>\n<li>In theory you have some other file, say <code>app.go</code> that will use <code>libsls-Generic</code>.  Write <code>app.go</code> and <code>import libsls-Generic</code> appropriately.</li>\n<li>Use <code>go build app.go</code>.  This should build the dependency as well.</li>\n</ol>\n\n<p>I eventually figured out how to get <code>go</code> to incorporate the files manually generated by swig, but I forget the details now.  I do remember that when generating files manually with swig, I would have to manually delete certain files when rebuilding.  When running with just go, the build step was much simpler.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11529360, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zr_aVF3in8k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddUOJPuXvPbX3swiV4xpZYqpSZ0Q/mo/photo.jpg?sz=128", "display_name": "Konstantin Alexandrov", "link": "https://stackoverflow.com/users/11529360/konstantin-alexandrov"}, "is_accepted": false, "score": 0, "last_activity_date": 1558375931, "last_edit_date": 1558375931, "creation_date": 1558370683, "answer_id": 56225085, "question_id": 42794318, "link": "https://stackoverflow.com/questions/42794318/wrapping-c-with-go-build/56225085#56225085", "title": "Wrapping C++ with Go build", "body": "<ol>\n<li>Unzip liblsl release tarball and clone liblsl-Generic to a folder under Go home directory</li>\n<li>Fix liblsl_cpp.i so that it points to the correct header file path</li>\n<li>Run <code>swig -go -c++ -cgo -intgosize 32 -package liblsl liblsl_cpp.i</code></li>\n<li>Add <code>// #cgo LDFLAGS: -Wl,-rpath,/usr/local/lib -llsl64</code> (assuming liblsl64.dylib is at <code>/usr/local/lib</code>) after <code>package liblsl</code> on the preceding line before the next comment in your liblsl.go</li>\n<li>Run <code>go install</code></li>\n</ol>\n\n<p>That will make it, <code>liblsl.a</code> will be under Go home dir's <code>pkg</code> folder and you will be able to import it from Go programs.</p>\n"}], "owner": {"reputation": 10607, "user_id": 5666087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0eeb62bd4c02b40a8751ab3368368d02?s=128&d=identicon&r=PG&f=1", "display_name": "jakub", "link": "https://stackoverflow.com/users/5666087/jakub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1030, "favorite_count": 0, "accepted_answer_id": 42804011, "answer_count": 2, "score": 4, "last_activity_date": 1558375931, "creation_date": 1489517773, "last_edit_date": 1489588996, "question_id": 42794318, "link": "https://stackoverflow.com/questions/42794318/wrapping-c-with-go-build", "title": "Wrapping C++ with Go build", "body": "<p>I am trying to wrap C++ code (<a href=\"https://github.com/sccn/labstreaminglayer/\" rel=\"nofollow noreferrer\">LabStreamingLayer</a>) in Go.</p>\n\n<p><strong>Update</strong>: @dragonx explained how to use <code>go build</code> without <code>swig</code>. But I am still running into a linker issue. The build depends on <code>LSL/liblsl/bin/liblsl.dylib</code>. How do I tell <code>go build</code> to use that file? I tried <code>go build -ldflags \"-L ../liblsl/bin -l lsl\" app.go</code> with no success.</p>\n\n<p>The <a href=\"https://golang.org/cmd/go/#hdr-Calling_between_Go_and_C\" rel=\"nofollow noreferrer\">Go documentation</a> says that <code>go build</code> will invoke Swig with the <code>c++</code> option for files with the <code>.swigcxx</code> extension, but <code>go build</code> complains that there are no buildable Go source files in the directory.</p>\n\n<ul>\n<li>Platform: Darwin</li>\n<li>Go version: 1.8</li>\n<li>Swig version:  3.0.12</li>\n<li>clang version: 8.0.0</li>\n</ul>\n\n<p>Here are the steps I took to arrive at that error:</p>\n\n<ol>\n<li>Clone the labstreaminglayer repo.</li>\n<li>Rename the file <a href=\"https://github.com/sccn/labstreaminglayer/blob/master/LSL/liblsl-Generic/liblsl_cpp.i\" rel=\"nofollow noreferrer\"><code>liblsl_cpp.i</code></a> to <code>liblsl.swigcxx</code> (I thought this would tell <code>go build</code> that the file should be used with swig).</li>\n<li><code>cd</code> into <code>LSL/liblsl-Generic</code> and run <code>go build</code>. Go complains that there are no buildable Go source files in this directory.</li>\n</ol>\n\n<p>After that failed, I tried using Swig. I ran <code>swig -c++ -go -cgo -intgosize 64 liblsl_cpp.i</code>, which created a <code>.go</code> file. I then ran <code>go build</code> in that directory, but it raised the error: </p>\n\n<pre><code>ld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1\n</code></pre>\n\n<p>I am not familiar with C++, so I am not sure how to resolve the linker issue. I do know that this C++ code requires the file <code>LSL/liblsl/bin/liblsl64.dylib</code>. I assume that is the file that must be linked?</p>\n\n<p>How can I wrap this C++ code in Go?</p>\n\n<p>Here is the file structure:</p>\n\n<pre><code>LSL\n\u251c\u2500\u2500 liblsl\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 bin\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 distros\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 examples\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 external\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 include\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 project\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 src\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 testing\n\u2514\u2500\u2500 liblsl-Generic\n \u00a0\u00a0 \u251c\u2500\u2500 AUTOGENERATE\\ HOWTO.txt\n \u00a0\u00a0 \u251c\u2500\u2500 examples\n \u00a0\u00a0 \u251c\u2500\u2500 liblsl.swigcxx\n \u00a0\u00a0 \u251c\u2500\u2500 liblsl_c.i\n \u00a0\u00a0 \u251c\u2500\u2500 liblsl_cpp.i\n    \u251c\u2500\u2500 liblsl_wrap.cxx  # created by Swig\n    \u2514\u2500\u2500 liblsl.go        # created by Swig\n</code></pre>\n"}, {"tags": ["go", "int32", "rune", "type-switch"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1489517910, "post_id": 42794228, "comment_id": 72703252, "body": "You can&#39;t. They are the same type."}], "answers": [{"comments": [{"owner": {"reputation": 1451, "user_id": 1795125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/074209c5cd0c3ce13669ae5c0f594e1c?s=128&d=identicon&r=PG", "display_name": "Chaim Leib Halbert", "link": "https://stackoverflow.com/users/1795125/chaim-leib-halbert"}, "edited": false, "score": 0, "creation_date": 1508370260, "post_id": 42795232, "comment_id": 80589112, "body": "I want to differentiate so that I can debug things more easily. When I debug, I want <code>int32</code> to appear as a number and <code>rune</code> to appear as a quoted character. But, because I can&#39;t distinguish them, both <code>rune</code>s and <code>int32</code>s have to be displayed in the same way. Either both get displayed as numbers (the default for <code>fmt.Sprintf(&quot;%#v&quot;, val)</code>), or both will be displayed as a quoted characters (using <code>&quot;%q&quot;</code>). These choices are just weird, and I wish <code>rune</code> and <code>int32</code> were really separate types."}], "tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 5, "last_activity_date": 1489520849, "creation_date": 1489520849, "answer_id": 42795232, "question_id": 42794228, "link": "https://stackoverflow.com/questions/42794228/how-do-i-distinguish-a-rune-and-int32-values-in-a-typeswitch/42795232#42795232", "title": "How do I distinguish a rune and int32 values in a typeswitch?", "body": "<p>It's an alias for int32, apparently you can't distinguish them. If you really needed to, defining your own type to wrap one of them would be the way to go, why did you need to do so?</p>\n\n<blockquote>\n  <p>No, you can't differentiate them. rune is an alias for int32, and byte\n  is an alias for uint8.</p>\n</blockquote>\n\n<p><a href=\"https://groups.google.com/forum/m/#!searchin/golang-nuts/Rune/golang-nuts/jbWUrsQ-Uws\" rel=\"noreferrer\">https://groups.google.com/forum/m/#!searchin/golang-nuts/Rune/golang-nuts/jbWUrsQ-Uws</a></p>\n"}], "owner": {"reputation": 16928, "user_id": 1047788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xA1rW.png?s=128&g=1", "display_name": "user7610", "link": "https://stackoverflow.com/users/1047788/user7610"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 42795232, "answer_count": 1, "score": 1, "last_activity_date": 1489520849, "creation_date": 1489517492, "question_id": 42794228, "link": "https://stackoverflow.com/questions/42794228/how-do-i-distinguish-a-rune-and-int32-values-in-a-typeswitch", "title": "How do I distinguish a rune and int32 values in a typeswitch?", "body": "<p>Having the following code</p>\n\n<pre><code>var v interface{}\nv = rune(1)\n\nswitch v.(type) {\n    case int32:\n        fmt.Println(\"int32\")\n    case rune:\n        fmt.Println(\"rune\")\n}\n</code></pre>\n\n<p>I get a compilation error</p>\n\n<pre><code>tmp/sandbox193184648/main.go:14: duplicate case rune in type switch\n    previous case at tmp/sandbox193184648/main.go:12\n</code></pre>\n\n<p>If I instead wrap the rune in my own type, the type-switch compiles and works</p>\n\n<pre><code>type myrune rune\n\nvar v interface{}\nv = myrune(1)\n\nswitch v.(type) {\ncase int32:\n    fmt.Println(\"int32\")\ncase myrune:\n    fmt.Println(\"rune\")\n}\n</code></pre>\n\n<p>see <a href=\"https://play.golang.org/p/2lMRlpCLzX\" rel=\"nofollow noreferrer\">https://play.golang.org/p/2lMRlpCLzX</a></p>\n\n<p>Why is that? How can I distinguish a rune and int32 in a type-switch?</p>\n"}, {"tags": ["go", "ibm-cloud-infrastructure"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 510465, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0a26251d80b546e0cf5a7b5b50956d6f?s=128&d=identicon&r=PG", "display_name": "Sanket ", "link": "https://stackoverflow.com/users/510465/sanket"}, "edited": false, "score": 0, "creation_date": 1489517704, "post_id": 42793864, "comment_id": 72703117, "body": "yes, your understanding is correct, I used Python SL package for my earlier development.  And about using the official go package, yes I did read about it but I am having hard time to identify the service/method name for create snapshot and also for datatypes which needs to be provided as input to create snapshot method/service  btw, thank you Mayank for your inputs so far!"}], "tags": [], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "is_accepted": false, "score": 3, "last_activity_date": 1489516298, "creation_date": 1489516298, "answer_id": 42793864, "question_id": 42793054, "link": "https://stackoverflow.com/questions/42793054/how-to-write-a-client-code-in-golang-to-call-createsnapshot-softlayer-api/42793864#42793864", "title": "how to write a client code in Golang to call createSnapshot softlayer API", "body": "<p>If i am not misunderstanding, you are using Softlayer package for python to do what you are doing in your given code.</p>\n\n<p>Softlayer has official go package as well <a href=\"https://github.com/softlayer/softlayer-go\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Download the package in your go environment by</p>\n\n<blockquote>\n  <p>go get github.com/softlayer/softlayer-go/...</p>\n</blockquote>\n\n<p>Then import he package in your application and use it.</p>\n\n<p>basic Example:</p>\n\n<pre><code>// 1. Create a session\nsess := session.New(username, apikey)\n\n// 2. Get a service\naccountService := services.GetAccountService(sess)\n\n// 3. Invoke a method:\naccount, err := accountService.GetObject()\n</code></pre>\n\n<p>You need to find methods that does the job for you.</p>\n"}, {"comments": [{"owner": {"reputation": 149, "user_id": 510465, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0a26251d80b546e0cf5a7b5b50956d6f?s=128&d=identicon&r=PG", "display_name": "Sanket ", "link": "https://stackoverflow.com/users/510465/sanket"}, "edited": false, "score": 0, "creation_date": 1489523333, "post_id": 42795278, "comment_id": 72706434, "body": "thank you ! that helps. One more question, do we need to terminate the session once we are done with it ? Or will the underlying SL GO SDK will take care of its termination ?"}, {"owner": {"reputation": 2732, "user_id": 5094287, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152965294186720/picture?type=large", "display_name": "Ruber Cuellar Valenzuela", "link": "https://stackoverflow.com/users/5094287/ruber-cuellar-valenzuela"}, "reply_to_user": {"reputation": 149, "user_id": 510465, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0a26251d80b546e0cf5a7b5b50956d6f?s=128&d=identicon&r=PG", "display_name": "Sanket ", "link": "https://stackoverflow.com/users/510465/sanket"}, "edited": false, "score": 0, "creation_date": 1489524545, "post_id": 42795278, "comment_id": 72707177, "body": "As soon as the script finish, the session will finish with it"}], "tags": [], "owner": {"reputation": 2732, "user_id": 5094287, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152965294186720/picture?type=large", "display_name": "Ruber Cuellar Valenzuela", "link": "https://stackoverflow.com/users/5094287/ruber-cuellar-valenzuela"}, "is_accepted": false, "score": 1, "last_activity_date": 1489520994, "creation_date": 1489520994, "answer_id": 42795278, "question_id": 42793054, "link": "https://stackoverflow.com/questions/42793054/how-to-write-a-client-code-in-golang-to-call-createsnapshot-softlayer-api/42795278#42795278", "title": "how to write a client code in Golang to call createSnapshot softlayer API", "body": "<p>Try the following script please:</p>\n\n<pre><code>// Create Snapshot\n//\n// This script creates a snapshot for storage\n//\n// See below references for more details.\n// important manual pages:\n// http://sldn.softlayer.com/reference/services/SoftLayer_Network_Storage/createSnapshot\n// @License: http://sldn.softlayer.com/article/License\n// @Author: SoftLayer Technologies, Inc. &lt;sldn@softlayer.com&gt;\n\npackage main\n\nimport (\n    \"fmt\"\n    \"github.com/softlayer/softlayer-go/services\"\n    \"github.com/softlayer/softlayer-go/session\"\n    \"encoding/json\"\n)\n\nfunc main() {\n  username    := \"set me\"\n  apikey      := \"set me\"\n\n  storageId   := 21015123\n  notes       := \"test\"\n\n  // 1. Create a session\n  sess := session.New(username, apikey)\n\n  // 2. Get a service\n  service := services.GetNetworkStorageService(sess)\n\n  result, err := service.Id(storageId).CreateSnapshot(&amp;notes)\n    if err != nil {\n        fmt.Printf(\"%s\\n\", err)\n        return\n    } \n\n  res, errMarsh := json.Marshal(result)\n  if errMarsh != nil {\n    fmt.Println(errMarsh)\n    return\n  }\n\n  fmt.Println(string(res))\n\n}\n</code></pre>\n\n<p><strong>Replace:</strong>: username, apikey, storageId and notes with your own information.</p>\n\n<p><strong>References:</strong></p>\n\n<ul>\n<li><a href=\"http://sldn.softlayer.com/reference/services/SoftLayer_Network_Storage/createSnapshot\" rel=\"nofollow noreferrer\">SoftLayer_Network_Storage::createSnapshot</a></li>\n</ul>\n"}], "owner": {"reputation": 149, "user_id": 510465, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0a26251d80b546e0cf5a7b5b50956d6f?s=128&d=identicon&r=PG", "display_name": "Sanket ", "link": "https://stackoverflow.com/users/510465/sanket"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1489520994, "creation_date": 1489513546, "last_edit_date": 1489516557, "question_id": 42793054, "link": "https://stackoverflow.com/questions/42793054/how-to-write-a-client-code-in-golang-to-call-createsnapshot-softlayer-api", "title": "how to write a client code in Golang to call createSnapshot softlayer API", "body": "<p>Being new to Golang (in fact started learning it just a couple of days back) I have a very basic question on creating a client code for consuming the SL APIs. </p>\n\n<p>So my requirement is to call a createsnapshot SL API using Golang which will take snapshot of my endurance volume, provided that volume id is a input parameter to it. Can you please help me with a sample code for writing this client ? </p>\n\n<p>I know how to do it in python, here is how I did it python, but now I want it in golang (change in req. you know ;) )</p>\n\n<p>python code snippet:</p>\n\n<pre><code>    client = SoftLayer.create_client_from_env(\"softlayer username\", \"softlayer apikey\")\n    result = client['SoftLayer_Network_Storage'].createSnapshot(\"snapshot_name\", \"volume id\")\n</code></pre>\n\n<p>thank you !</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 269, "user_id": 2670142, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c5c8208167662d9ec9c782e21fc13784?s=128&d=identicon&r=PG", "display_name": "kabiev", "link": "https://stackoverflow.com/users/2670142/kabiev"}, "edited": false, "score": 0, "creation_date": 1489510671, "post_id": 42791005, "comment_id": 72698656, "body": "thank apxp! that&#39;s work!"}], "answers": [{"comments": [{"owner": {"reputation": 14205, "user_id": 968244, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/I9DXX.jpg?s=128&g=1", "display_name": "isapir", "link": "https://stackoverflow.com/users/968244/isapir"}, "edited": false, "score": 0, "creation_date": 1545375120, "post_id": 42791146, "comment_id": 94607570, "body": "But how do you provide one, not as a fallback?"}], "tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": true, "score": 6, "last_activity_date": 1489508164, "creation_date": 1489508164, "answer_id": 42791146, "question_id": 42791005, "link": "https://stackoverflow.com/questions/42791005/how-to-set-application-name-in-golang-lib-pq-postgresql-driver/42791146#42791146", "title": "How to set application name in golang lib/pq postgresql driver?", "body": "<p>If you look to the <a href=\"https://godoc.org/github.com/lib/pq\" rel=\"noreferrer\">documentation</a> a application_name option is not suuported. Maybe you could use: </p>\n\n<blockquote>\n  <p>fallback_application_name - An application_name to fall back to if\n  one isn't provided.</p>\n</blockquote>\n\n<pre><code>name:pass@host:port/dbname?fallback_application_name=myapp\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86, "user_id": 98110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/779683c692e9f30385f5f493f3f3cf17?s=128&d=identicon&r=PG", "display_name": "Nugget", "link": "https://stackoverflow.com/users/98110/nugget"}, "is_accepted": false, "score": 5, "last_activity_date": 1556853911, "creation_date": 1556853911, "answer_id": 55962904, "question_id": 42791005, "link": "https://stackoverflow.com/questions/42791005/how-to-set-application-name-in-golang-lib-pq-postgresql-driver/55962904#55962904", "title": "How to set application name in golang lib/pq postgresql driver?", "body": "<p>Even though it's not mentioned in the documentation, if you look at the <code>lib/pq</code> source code you will find that <code>application_name</code> is supported.</p>\n\n<p>This style connection works as desired:</p>\n\n<pre><code>connstring := fmt.Sprintf(\"user='%s' password='%s' dbname='%s' host='%s' application_name='%s'\", user, password, dbname, host, application_name)\ndb, err := sql.Open(\"postgres\", connstring)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "is_accepted": false, "score": 1, "last_activity_date": 1585177977, "creation_date": 1585177977, "answer_id": 60858731, "question_id": 42791005, "link": "https://stackoverflow.com/questions/42791005/how-to-set-application-name-in-golang-lib-pq-postgresql-driver/60858731#60858731", "title": "How to set application name in golang lib/pq postgresql driver?", "body": "<p>You can set the application name one of two ways.</p>\n\n<pre><code>// Application name as space-separated list of options.\nsql.Open(\"postgres\", \"user=myuser password=mypass host=localhost port=5432 dbname=mydb sslmode=disable application_name=myapp\")\n</code></pre>\n\n<p>or</p>\n\n<pre><code>// Application name as query param.\nsql.Open(\"postgres\", \"postgres://myuser:mypass@localhost:5432/mydb?sslmode=disable&amp;application_name=myapp\")\n</code></pre>\n"}], "owner": {"reputation": 269, "user_id": 2670142, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c5c8208167662d9ec9c782e21fc13784?s=128&d=identicon&r=PG", "display_name": "kabiev", "link": "https://stackoverflow.com/users/2670142/kabiev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1574, "favorite_count": 1, "accepted_answer_id": 42791146, "answer_count": 3, "score": 4, "last_activity_date": 1585177977, "creation_date": 1489507751, "last_edit_date": 1489520038, "question_id": 42791005, "link": "https://stackoverflow.com/questions/42791005/how-to-set-application-name-in-golang-lib-pq-postgresql-driver", "title": "How to set application name in golang lib/pq postgresql driver?", "body": "<p>I'm writing a golang application and using the golang postgres driver - <a href=\"https://github.com/lib/pq/\" rel=\"nofollow noreferrer\">https://github.com/lib/pq/</a></p>\n\n<p>I use a connection string like this </p>\n\n<pre><code>'name:pass@host:port/dbname'\n</code></pre>\n\n<p>I try to add aplication_name param in conn string, but this doesn't work</p>\n\n<pre><code>'name:pass@host:port/dbname?application_name=myapp'\n</code></pre>\n\n<p>Is it possible to set the application name from golang? (standard way)</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 2, "creation_date": 1489503706, "post_id": 42789361, "comment_id": 72693298, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/42070023/how-do-i-get-postgresql-procedure-warning-messages-in-golang\">How do I get Postgresql procedure warning messages in Golang</a>"}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 1, "last_activity_date": 1489539300, "creation_date": 1489539300, "answer_id": 42799308, "question_id": 42789361, "link": "https://stackoverflow.com/questions/42789361/how-to-view-postgresql-raise-notice-from-go-app/42799308#42799308", "title": "how to view postgresql &quot;raise notice&quot; from go app", "body": "<p>If you're using <code>lib/pq</code> you can use its <code>LISTEN/NOTIFY</code> support to achieve what you want.</p>\n\n<p>On the Go side you can use something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"time\"\n\n    \"github.com/lib/pq\"\n)\n\nfunc main() {\n    dburl := \"postgres:///?sslmode=disable\"\n    li := pq.NewListener(dburl, 10*time.Second, time.Minute, func(event pq.ListenerEventType, err error) {\n        if err != nil {\n            log.Fatal(err)\n        }\n    })\n\n    if err := li.Listen(\"raise_notice\"); err != nil {\n        panic(err)\n    }\n\n    for {\n        select {\n        case n := &lt;-li.Notify:\n            // n.Extra contains the payload from the notification\n            log.Println(\"notification:\", n.Extra)\n        case &lt;-time.After(5 * time.Minute):\n            if err := li.Ping(); err != nil {\n                panic(err)\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Then your postgres function would look like this:</p>\n\n<pre><code>CREATE FUNCTION show_mes() RETURNS int AS $$\nBEGIN\n     PERFORM pg_notify('raise_notice', 'test message from pg');\n     RETURN 1;\nEND\n$$ LANGUAGE plpgsql;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87, "user_id": 1742320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51f6c5ed3867da9738b6297293439b45?s=128&d=identicon&r=PG", "display_name": "Vladimir", "link": "https://stackoverflow.com/users/1742320/vladimir"}, "is_accepted": false, "score": 0, "last_activity_date": 1601552279, "creation_date": 1601552279, "answer_id": 64154610, "question_id": 42789361, "link": "https://stackoverflow.com/questions/42789361/how-to-view-postgresql-raise-notice-from-go-app/64154610#64154610", "title": "how to view postgresql &quot;raise notice&quot; from go app", "body": "<p>I have created example:</p>\n<pre><code>https://github.com/jackc/pgx/issues/838\n</code></pre>\n<p>with pgx driver</p>\n<p>Call back function in connection for postgres messages</p>\n"}], "owner": {"reputation": 269, "user_id": 2670142, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c5c8208167662d9ec9c782e21fc13784?s=128&d=identicon&r=PG", "display_name": "kabiev", "link": "https://stackoverflow.com/users/2670142/kabiev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1601552279, "creation_date": 1489503349, "last_edit_date": 1489507785, "question_id": 42789361, "link": "https://stackoverflow.com/questions/42789361/how-to-view-postgresql-raise-notice-from-go-app", "title": "how to view postgresql &quot;raise notice&quot; from go app", "body": "<p>I'm writting small app in go. And now I need to log postgres \"raise notice\" message in app console.</p>\n\n<p>I was not found where postgresql raised messages stored in *sql.Conn  (I'm use go/sql with lib/pq driver)</p>\n\n<p>example, </p>\n\n<pre><code>create function show_mes() returns int as $$\nbegin\n     raise notice 'test message from pg';\n     return 1;\nend\n$$ language plpgsql;\n</code></pre>\n\n<p>from go app I call this function and can get the result.</p>\n\n<p>But how can i access to that messages \"test message from pg\" from go app?</p>\n\n<p>In current version written in Node we log messages in console for debbugging:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PzElN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PzElN.png\" alt=\"enter image description here\"></a></p>\n\n<p>thank you!</p>\n"}, {"tags": ["json", "go", "jq"], "comments": [{"owner": {"reputation": 1169, "user_id": 498109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/100036fbeed75b1abf5bf0161d1fb560?s=128&d=identicon&r=PG", "display_name": "Vadyus", "link": "https://stackoverflow.com/users/498109/vadyus"}, "edited": false, "score": 0, "creation_date": 1489500145, "post_id": 42788045, "comment_id": 72690335, "body": "Are you looking for this? <a href=\"http://stackoverflow.com/questions/19038598/how-can-i-pretty-print-json-using-go\" title=\"how can i pretty print json using go\">stackoverflow.com/questions/19038598/&hellip;</a>"}, {"owner": {"reputation": 873, "user_id": 2820419, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100000721485668/picture?type=large", "display_name": "Siddharth Shukla", "link": "https://stackoverflow.com/users/2820419/siddharth-shukla"}, "reply_to_user": {"reputation": 1169, "user_id": 498109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/100036fbeed75b1abf5bf0161d1fb560?s=128&d=identicon&r=PG", "display_name": "Vadyus", "link": "https://stackoverflow.com/users/498109/vadyus"}, "edited": false, "score": 0, "creation_date": 1489500705, "post_id": 42788045, "comment_id": 72690797, "body": "So, the thing is I have the JSON response in a byte array and the schema of the JSON can vary arbitrarily so I can&#39;t necessarily unmarshal it without unnecessary hacks. I just need to print this JSON byte array in a pretty manner."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1489501375, "post_id": 42788045, "comment_id": 72691367, "body": "@SiddharthShukla The <code>json</code> package has support for that too: <code>json.Indent()</code>. See my edited answer."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1489501715, "last_edit_date": 1489501715, "creation_date": 1489500502, "answer_id": 42788236, "question_id": 42788045, "link": "https://stackoverflow.com/questions/42788045/is-there-a-jq-wrapper-for-golang-that-can-produce-human-readable-json-output/42788236#42788236", "title": "Is there a jq wrapper for golang that can produce human readable JSON output?", "body": "<p>The <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\"><code>encoding/json</code></a> package supports pretty output out-of-the-box. You may use <a href=\"https://golang.org/pkg/encoding/json/#MarshalIndent\" rel=\"nofollow noreferrer\"><code>json.MarshalIndent()</code></a>. Or if you're using <a href=\"https://golang.org/pkg/encoding/json/#Encoder\" rel=\"nofollow noreferrer\"><code>json.Encoder</code></a>, then call its <a href=\"https://golang.org/pkg/encoding/json/#Encoder.SetIndent\" rel=\"nofollow noreferrer\"><code>Encoder.SetIndent()</code></a> (new since <a href=\"https://golang.org/doc/go1.7#encoding_json\" rel=\"nofollow noreferrer\">Go 1.7</a>) method prior to calling <a href=\"https://golang.org/pkg/encoding/json/#Encoder.Encode\" rel=\"nofollow noreferrer\"><code>Encoder.Encode()</code></a>.</p>\n\n<p>Examples:</p>\n\n<pre><code>m := map[string]interface{}{\"id\": \"uuid1\", \"name\": \"John Smith\"}\n\ndata, err := json.MarshalIndent(m, \"\", \"  \")\nif err != nil {\n    panic(err)\n}\nfmt.Println(string(data))\n\nenc := json.NewEncoder(os.Stdout)\nenc.SetIndent(\"\", \"  \")\nif err := enc.Encode(m); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/WjLLth_BWk\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{\n  \"id\": \"uuid1\",\n  \"name\": \"John Smith\"\n}\n{\n  \"id\": \"uuid1\",\n  \"name\": \"John Smith\"\n}\n</code></pre>\n\n<p>If you just want to format a \"ready\" JSON text, you may use the <a href=\"https://golang.org/pkg/encoding/json/#Indent\" rel=\"nofollow noreferrer\"><code>json.Indent()</code></a> function:</p>\n\n<pre><code>src := `{\"id\":\"uuid1\",\"name\":\"John Smith\"}`\n\ndst := &amp;bytes.Buffer{}\nif err := json.Indent(dst, []byte(src), \"\", \"  \"); err != nil {\n    panic(err)\n}\nfmt.Println(dst.String())\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/wYMWmXPMSX\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{\n  \"id\": \"uuid1\",\n  \"name\": \"John Smith\"\n}\n</code></pre>\n\n<p>The 2 <code>string</code> parameters to these <code>indent</code> functions are:</p>\n\n<pre><code>prefix, indent string\n</code></pre>\n\n<p>Explanation is in the docs:</p>\n\n<blockquote>\n  <p>Each element in a JSON object or array begins on a new, indented line beginning with prefix followed by one or more copies of indent according to the indentation nesting.</p>\n</blockquote>\n\n<p>So each newline will be started with <code>prefix</code>, which will be followed by 0 or more copies of <code>indent</code>, depending on the nesting level.</p>\n\n<p>It becomes clear and obvious if you specify values for them like this:</p>\n\n<pre><code>json.Indent(dst, []byte(src), \"+\", \"-\")\n</code></pre>\n\n<p>Testing it with embedded objects:</p>\n\n<pre><code>src := `{\"id\":\"uuid1\",\"name\":\"John Smith\",\"embedded:\":{\"fieldx\":\"y\"}}`\n\ndst := &amp;bytes.Buffer{}\nif err := json.Indent(dst, []byte(src), \"+\", \"-\"); err != nil {\n    panic(err)\n}\nfmt.Println(dst.String())\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/s4rpASv0AO\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{\n+-\"id\": \"uuid1\",\n+-\"name\": \"John Smith\",\n+-\"embedded:\": {\n+--\"fieldx\": \"y\"\n+-}\n+}\n</code></pre>\n"}], "owner": {"reputation": 873, "user_id": 2820419, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100000721485668/picture?type=large", "display_name": "Siddharth Shukla", "link": "https://stackoverflow.com/users/2820419/siddharth-shukla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1904, "favorite_count": 1, "accepted_answer_id": 42788236, "answer_count": 1, "score": 4, "last_activity_date": 1556401469, "creation_date": 1489500012, "question_id": 42788045, "link": "https://stackoverflow.com/questions/42788045/is-there-a-jq-wrapper-for-golang-that-can-produce-human-readable-json-output", "title": "Is there a jq wrapper for golang that can produce human readable JSON output?", "body": "<p>I'm writing a go program (let's call it foo) that outputs JSON on the Standard Out. </p>\n\n<pre><code>$ ./foo\n{\"id\":\"uuid1\",\"name\":\"John Smith\"}{\"id\":\"uuid2\",\"name\":\"Jane Smith\"}\n</code></pre>\n\n<p>In order to make the output human readable, I have to pipe it into jq like:</p>\n\n<pre><code>$ ./foo | jq .\n\n{\n\"id\":\"uuid1\",\n\"name\": \"John Smith\"\n}\n{\n\"id\":\"uuid2\"\n\"name\": \"Jane Smith\"\n}\n</code></pre>\n\n<p>Is there a way to achieve the same result using a jq wrapper that is open sourced? I tried finding some but they are usually wrapping the functionality for filtering JSON input not prettifying JSON output.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489499211, "post_id": 42787701, "comment_id": 72689616, "body": "The json package doesn&#39;t use a &quot;binding&quot; tag, where are you getting this?"}, {"owner": {"reputation": 273, "user_id": 3559801, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7b8996e43ec87f7e1fab8d548c7d2a58?s=128&d=identicon&r=PG&f=1", "display_name": "Mert Serin", "link": "https://stackoverflow.com/users/3559801/mert-serin"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489499272, "post_id": 42787701, "comment_id": 72689650, "body": "So how can check if json doesn&#39;t have required keys? Manually?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1489501798, "post_id": 42787701, "comment_id": 72691694, "body": "You&#39;ll either have to do the validation manually or use a 3rd party package to do it for you, for example this one: <a href=\"https://github.com/go-playground/validator\" rel=\"nofollow noreferrer\">github.com/go-playground/validator</a>. <a href=\"https://github.com/go-playground/validator/blob/v9/examples/simple/main.go\" rel=\"nofollow noreferrer\">Here</a> is a simple example on how to use it."}], "owner": {"reputation": 273, "user_id": 3559801, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7b8996e43ec87f7e1fab8d548c7d2a58?s=128&d=identicon&r=PG&f=1", "display_name": "Mert Serin", "link": "https://stackoverflow.com/users/3559801/mert-serin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1516, "favorite_count": 0, "closed_date": 1489499709, "answer_count": 0, "score": 0, "last_activity_date": 1489499600, "creation_date": 1489499069, "last_edit_date": 1489499600, "question_id": 42787701, "link": "https://stackoverflow.com/questions/42787701/golang-json-decoding-check-field-exist-or-not-automatically", "closed_reason": "Duplicate", "title": "Golang - Json decoding, check field exist or not automatically", "body": "<p>I've been using </p>\n\n<pre><code>json.NewDecoder() \nerr = decoder.Decode(&amp;m)\n</code></pre>\n\n<p>to decode JSON and map into a custom struct. When I made a request with another JSON, decoder doesn't return an error. I used required for binding but It didn't change anything.</p>\n\n<p>My custom struct looks like this</p>\n\n<pre><code>type UpdateUserInformationModel struct {\n    Token                      string `json:\"Token\" binding:\"required\"`\n    Name                       string `json:\"Name\" binding:\"required\"`\n    Lastname                   string `json:\"Lastname\" binding:\"required\"`\n    PhoneNumber                string\n    ProfilePhotoInBase64String string\n    AdditionalInformation      string\n}\n</code></pre>\n\n<p>I made a request with this JSON</p>\n\n<pre><code>{\n    \"Token\":\"CHlBciGyuTsJ1B5JYLjT\",\n    \"Name\":\"Mert\"\n}\n</code></pre>\n\n<p>and decoder doesn't return an error. Can anyone help me?</p>\n\n<p>When I searched the net for the answer doing it manually. Do we have another option for checking if field exist on JSON automatically.</p>\n"}, {"tags": ["java", "sockets", "go"], "comments": [{"owner": {"reputation": 3270, "user_id": 3059385, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dc876278926d67b3da29594601fdc82a?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Schneider", "link": "https://stackoverflow.com/users/3059385/christopher-schneider"}, "edited": false, "score": 0, "creation_date": 1489498386, "post_id": 42787374, "comment_id": 72688939, "body": "What does rspMsg look like when you run the debugger? This is a perfect case to use one :-)"}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 9, "creation_date": 1489498430, "post_id": 42787374, "comment_id": 72688974, "body": "1, 2, 3: Because you print <code>rspMsg</code>, not <code>retStr</code>. What is <code>YES</code>, <code>NO</code> and <code>FAIL</code>?"}, {"owner": {"reputation": 121, "user_id": 6079494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f557a6b747afce2ed6213843bb6d829?s=128&d=identicon&r=PG&f=1", "display_name": "TealSeed", "link": "https://stackoverflow.com/users/6079494/tealseed"}, "reply_to_user": {"reputation": 3270, "user_id": 3059385, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dc876278926d67b3da29594601fdc82a?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Schneider", "link": "https://stackoverflow.com/users/3059385/christopher-schneider"}, "edited": false, "score": 0, "creation_date": 1489501026, "post_id": 42787374, "comment_id": 72691051, "body": "@ChristopherSchneider - alas, I don&#39;t run Go on my machine so I don&#39;t know... I requested the code for the client to figure out what&#39;s going on. Installing and running the Go client would be my next step."}, {"owner": {"reputation": 121, "user_id": 6079494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f557a6b747afce2ed6213843bb6d829?s=128&d=identicon&r=PG&f=1", "display_name": "TealSeed", "link": "https://stackoverflow.com/users/6079494/tealseed"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1489501603, "post_id": 42787374, "comment_id": 72691541, "body": "@tkausl - great point. I will clarify the question.  I assumed the [link]<a href=\"https://golang.org/pkg/strings/#TrimRight\" rel=\"nofollow noreferrer\">golang.org/pkg/strings/#TrimRight</a> trimRight function works as advertised so I&#39;m really trying to figure out why retStr seems to be incorrect.  <code>YES</code>, <code>NO</code> and <code>FAIL</code> are the results from the sever. They specify whether the string was in the correct format or not. For now, <code>YES</code> is hard-coded while I debug the client-side issue"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1489503469, "post_id": 42787374, "comment_id": 72693083, "body": "In your code, <code>YES</code>, <code>NO</code>, and <code>FAIL</code> are variable references. That&#39;s why tkausl was asking what they are - what are their values? They aren&#39;t defined in your snippet. Your output message includes the newline because you&#39;re printing rspMsg, which is the original un-trimmed value. What do you get if you instead output retStr, which is your trimmed value?"}, {"owner": {"reputation": 121, "user_id": 6079494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f557a6b747afce2ed6213843bb6d829?s=128&d=identicon&r=PG&f=1", "display_name": "TealSeed", "link": "https://stackoverflow.com/users/6079494/tealseed"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1489514519, "post_id": 42787374, "comment_id": 72701219, "body": "@Adrian Ahhh! Thanks for clarifying. Yes, they are defined variables. See below. I&#39;ve just installed go and I&#39;m refactoring the code to make it work. I&#39;ll let you know as soon as I get it running locally  <code>const ( \t&#47;&#47;YES code \tYES = &quot;YES&quot;  \t&#47;&#47;FAIL code \tFAIL = &quot;FAIL&quot;  \t&#47;&#47;NO code \tNO = &quot;NO&quot;  \t&#47;&#47;UNKNOWN code \tUNKNOWN = &quot;UNKNOWN&quot; )</code>"}, {"owner": {"reputation": 121, "user_id": 6079494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f557a6b747afce2ed6213843bb6d829?s=128&d=identicon&r=PG&f=1", "display_name": "TealSeed", "link": "https://stackoverflow.com/users/6079494/tealseed"}, "edited": false, "score": 0, "creation_date": 1489599502, "post_id": 42787374, "comment_id": 72745809, "body": "Issues on both sides but the root cause was in the Java server. See my answer below."}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 6079494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f557a6b747afce2ed6213843bb6d829?s=128&d=identicon&r=PG&f=1", "display_name": "TealSeed", "link": "https://stackoverflow.com/users/6079494/tealseed"}, "is_accepted": true, "score": 0, "last_activity_date": 1489599436, "creation_date": 1489599436, "answer_id": 42816911, "question_id": 42787374, "link": "https://stackoverflow.com/questions/42787374/socket-programming-is-extra-n-added-in-the-golang-client-or-the-java-server/42816911#42816911", "title": "Socket programming: Is extra &#39;\\n&#39; added in the golang client or the Java server?", "body": "<ol>\n<li><p>Since there are nil errors shouldn't '\\n' and (any characters following it) have been stripped leaving us with \"YES\"?\n<strong>YES</strong></p></li>\n<li><p>Am I missing some quirk on the Java side? I've recreated the client using Java and the output is what I expect.\n<strong>YES</strong></p></li>\n</ol>\n\n<p>This was resolved with a few steps:</p>\n\n<ul>\n<li>Using java.io.PrintWriter introduced some unexpected characters throughout the output. </li>\n<li>strings.TrimRight(rspMsg, \"\\n\") masked the point above but it was confirmed after installing Golang and debugging the script (using strings.TrimSpace for the operation above is a more robust approach)</li>\n<li>Switching to java.io.OutputStream.write() simplified the output sent to the client</li>\n</ul>\n"}], "owner": {"reputation": 121, "user_id": 6079494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f557a6b747afce2ed6213843bb6d829?s=128&d=identicon&r=PG&f=1", "display_name": "TealSeed", "link": "https://stackoverflow.com/users/6079494/tealseed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 42816911, "answer_count": 1, "score": -3, "last_activity_date": 1489599436, "creation_date": 1489498199, "last_edit_date": 1489502025, "question_id": 42787374, "link": "https://stackoverflow.com/questions/42787374/socket-programming-is-extra-n-added-in-the-golang-client-or-the-java-server", "title": "Socket programming: Is extra &#39;\\n&#39; added in the golang client or the Java server?", "body": "<p>I've written a Java TCP socket service and this service is used by a golang client.</p>\n\n<p>Things get weird when the server socket response gets parsed on the golang side. </p>\n\n<p>Specifically, this Java server code:</p>\n\n<pre><code>BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(output));\nbw.append('Y');        \nbw.append('E');\nbw.append('S');\nbw.append('\\n');\nbw.flush();\n</code></pre>\n\n<p>And this golang client code:</p>\n\n<pre><code>extendTimoutFor(client.conn)\n    rspMsg, fault := bufio.NewReader(client.conn).ReadString('\\n')\n    if fault != nil {\n        return UNKNOWN, fmt.Errorf(\"Ers reading response: %v\", fault)\n    }\n\n    retStr := strings.TrimRight(rspMsg, \"\\n\")\n\n    if retStr == YES {\n        return YES, nil\n    }\n\n    if retStr == NO {\n        return NO, nil\n    }\n\n    if retStr == FAIL {\n        return FAIL, nil\n    }\n\n    return UNKNOWN, fmt.Errorf(\"Ers parsing msg [%s]: %v\", rspMsg, fault)\n</code></pre>\n\n<p>Produce this result in the client:</p>\n\n<pre><code>[UNDO|test|]: Ers parsing msg [YES\n]: &lt;nil&gt;\n</code></pre>\n\n<p>My problem with the result is that the client doesn't recognize retStr as a valid response. Since rspMsg is what we expect (i.e. 'YES\\n') then if we're in the <em>UNKNOWN</em> block it means that something went wrong during this line: <em>retStr := strings.TrimRight(rspMsg, \"\\n\")</em>?</p>\n\n<p><strong>My specific questions are:</strong></p>\n\n<ol>\n<li>Since there are nil errors shouldn't '\\n' and (any characters following it) have been stripped leaving us with \"YES\"?</li>\n<li>Am I missing some quirk on the Java side? I've recreated the client using  Java and the output is what I expect.</li>\n</ol>\n"}, {"tags": ["go", "yaml"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1489497505, "post_id": 42786815, "comment_id": 72688220, "body": "<a href=\"https://play.golang.org/p/NX5qQhHZFu\" rel=\"nofollow noreferrer\">play.golang.org/p/NX5qQhHZFu</a> - this works for me. Make sure your YAML is well-formed."}, {"owner": {"reputation": 815, "user_id": 3503302, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4f3eed323aa9c246a208f1736148fc3c?s=128&d=identicon&r=PG", "display_name": "brujoand", "link": "https://stackoverflow.com/users/3503302/brujoand"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1489500946, "post_id": 42786815, "comment_id": 72690988, "body": "Thanks! I copied your version of the yaml over mine. And now it works. I tried to diff them but couldn&#39;t find any difference. Very weird, but problem solved."}], "answers": [{"tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 0, "last_activity_date": 1489588399, "last_edit_date": 1489588399, "creation_date": 1489588012, "answer_id": 42812589, "question_id": 42786815, "link": "https://stackoverflow.com/questions/42786815/parsing-a-yaml-object-in-go-which-contains-a-struct/42812589#42812589", "title": "Parsing a yaml object in Go which contains a struct", "body": "<p>This yaml can get unmarshaled into this perfectly (since you do not want to use a map):</p>\n\n<pre><code>type Config struct {\n    SegmentForward  string\n    SegmentBackward string\n    ListForward     string\n    PromptReady     string\n    EnabledHooks    []string\n    EnabledSegments []string\n\n    HostSegment, PathSegment, PythonEnvSegment, AWSSegment, GitSegment  segment\n    FillerSegment, CommandSegment, TimestampSegment, PromptReadySegment segment\n}\n\ntype segment struct {\n    FgColor int\n    BgColor int\n}\n</code></pre>\n"}], "owner": {"reputation": 815, "user_id": 3503302, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4f3eed323aa9c246a208f1736148fc3c?s=128&d=identicon&r=PG", "display_name": "brujoand", "link": "https://stackoverflow.com/users/3503302/brujoand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1489588399, "creation_date": 1489496652, "question_id": 42786815, "link": "https://stackoverflow.com/questions/42786815/parsing-a-yaml-object-in-go-which-contains-a-struct", "title": "Parsing a yaml object in Go which contains a struct", "body": "<p>I have the following yaml:</p>\n\n<pre><code>segmentforward: \"\ue0b0\"\nsegmentbackward: \"\ue0b2\"\nlistforward: \"\ue0b1\"\npromptready: \"\u279c\"\n\nenabledhooks: [\"alert\"]\n\nenabledsegments: [\"host\", \"path\", \"python_env\", \"aws\", \"git\", \"filler\", \"command\", \"timestamp\", \"newline\", \"prompt_ready\"]\n\nhostsegment: { fgcolor: 250, bgcolor: 238 }\npathsegment: { fgcolor: 15, bgcolor: 31 }\npythonenvsegment: { fgcolor: 15, bgcolor: 22 }\nawssegment: { fgcolor: 172, bgcolor: 238 }\ngitsegment: { fgcolor: 238, bgcolor: 148 }\nfillersegment: { fgcolor: 251, bgcolor: 251 }\ncommandsegment: { fgcolor: 238, bgcolor: 250 }\ntimestampsegment: { fgcolor: 250, bgcolor: 238 }\npromptreadysegment: { fgcolor: 238, bgcolor: 251 }\n</code></pre>\n\n<p>I'm trying to parse this yaml with the following go code:</p>\n\n<pre><code>package config\n\nimport (\n    \"gopkg.in/yaml.v2\"\n    \"io/ioutil\"\n)\n\ntype Config struct {\n    SegmentForward string\n    SegmentBackward string\n    ListForward string\n    PromptReady string\n    EnabledHooks []string\n    EnabledSegments []string\n    HostSegment struct {\n      FgColor int\n      BgColor int\n    }\n}\n\nfunc LoadConfig(path string) (config Config) {\n\n    data, err := ioutil.ReadFile(path)\n    if err != nil {\n      panic(err)\n    }\n\n    err = yaml.Unmarshal(data, &amp;config)\n    if err != nil {\n      panic(err)\n    }\n\n    return config\n}\n</code></pre>\n\n<p>But this gives me the error:</p>\n\n<pre><code>panic: yaml: unmarshal errors:\n  line 18: cannot unmarshal !!map into string\n\ngoroutine 1 [running]:\npanic(0x3364c0, 0xc42014a9c0)\n    /usr/local/Cellar/go/1.7.4/libexec/src/runtime/panic.go:500 +0x1a1\ngithub.com/brujoand/sbp/config.LoadConfig(0x3b7138, 0x23, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n    /opt/go/src/github.com/brujoand/sbp/config/config.go:30 +0x12d\nmain.main()\n    /opt/go/src/github.com/brujoand/sbp/main.go:18 +0x50\n</code></pre>\n\n<p>What I want here is to be able to reference these segments directly without looking up a map. And then have the same kind of fields within each segment. I'm aware that my namings in the Yaml isn't great (sorry about that), but right now I'm trying to understand how to access the fields in a simple way. </p>\n"}, {"tags": ["rest", "go", "webserver"], "comments": [{"owner": {"reputation": 1642, "user_id": 1509169, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/8MgOC.jpg?s=128&g=1", "display_name": "Alexander R.", "link": "https://stackoverflow.com/users/1509169/alexander-r"}, "edited": false, "score": 1, "creation_date": 1489493568, "post_id": 42784515, "comment_id": 72685412, "body": "It&#39;s hard to understand what your problem is..."}, {"owner": {"reputation": 101, "user_id": 5711571, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-NXogzROk9Qc/AAAAAAAAAAI/AAAAAAAAEK0/zto59EqRCow/photo.jpg?sz=128", "display_name": "up duan", "link": "https://stackoverflow.com/users/5711571/up-duan"}, "reply_to_user": {"reputation": 1642, "user_id": 1509169, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/8MgOC.jpg?s=128&g=1", "display_name": "Alexander R.", "link": "https://stackoverflow.com/users/1509169/alexander-r"}, "edited": false, "score": 0, "creation_date": 1489502850, "post_id": 42784515, "comment_id": 72692555, "body": "@AlexanderR.  I append response example for clear the problem"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489509734, "post_id": 42784515, "comment_id": 72697960, "body": "fcgi is a relic from the 90s, and there&#39;s really no good reason to be using it now. It&#39;s only adding more unknowns to this already incomplete example."}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 5711571, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-NXogzROk9Qc/AAAAAAAAAAI/AAAAAAAAEK0/zto59EqRCow/photo.jpg?sz=128", "display_name": "up duan", "link": "https://stackoverflow.com/users/5711571/up-duan"}, "is_accepted": false, "score": 0, "last_activity_date": 1491915240, "creation_date": 1491915240, "answer_id": 43346517, "question_id": 42784515, "link": "https://stackoverflow.com/questions/42784515/http-requests-are-tampered-by-other-http-requests-with-golang-and-standard-libr/43346517#43346517", "title": "HTTP requests are tampered by other HTTP requests, with golang and standard library", "body": "<p>problem resolved\u3002</p>\n\n<p>the basic reason is this case:</p>\n\n<pre><code>var x = &amp;{...} //init value\nfillX(..., x) //fill the fields of x pointer \n//here the fields of x pointer is not same to inner of fillX func\n</code></pre>\n\n<p>so, change to</p>\n\n<pre><code>var x = &amp;{...}\nx = fullX(..., x)\nthe problem resolved.\n</code></pre>\n\n<p>but why go pointer is the behavior?</p>\n"}, {"comments": [{"owner": {"reputation": 9229, "user_id": 2571021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87cbb4445df2a3318c04b951bf1d8148?s=128&d=identicon&r=PG", "display_name": "Dijkgraaf", "link": "https://stackoverflow.com/users/2571021/dijkgraaf"}, "edited": false, "score": 2, "creation_date": 1566275584, "post_id": 57566632, "comment_id": 101594566, "body": "Shouldn&#39;t this be an update to your existing answer?"}], "tags": [], "owner": {"reputation": 101, "user_id": 5711571, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-NXogzROk9Qc/AAAAAAAAAAI/AAAAAAAAEK0/zto59EqRCow/photo.jpg?sz=128", "display_name": "up duan", "link": "https://stackoverflow.com/users/5711571/up-duan"}, "is_accepted": false, "score": 0, "last_activity_date": 1566274383, "creation_date": 1566274383, "answer_id": 57566632, "question_id": 42784515, "link": "https://stackoverflow.com/questions/42784515/http-requests-are-tampered-by-other-http-requests-with-golang-and-standard-libr/57566632#57566632", "title": "HTTP requests are tampered by other HTTP requests, with golang and standard library", "body": "<p>Finally, this problem resolved.</p>\n\n<p>Because the http.Handle register path-pattern and handler pair, the handler is construct by register time only-once, not for any request of path-pattern.</p>\n\n<p>if record info within handler, It will been change by after request.</p>\n"}], "owner": {"reputation": 101, "user_id": 5711571, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-NXogzROk9Qc/AAAAAAAAAAI/AAAAAAAAEK0/zto59EqRCow/photo.jpg?sz=128", "display_name": "up duan", "link": "https://stackoverflow.com/users/5711571/up-duan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1566274383, "creation_date": 1489490174, "last_edit_date": 1489503142, "question_id": 42784515, "link": "https://stackoverflow.com/questions/42784515/http-requests-are-tampered-by-other-http-requests-with-golang-and-standard-libr", "title": "HTTP requests are tampered by other HTTP requests, with golang and standard library", "body": "<p>cat main.go:</p>\n\n<p>```</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"log\"\n    \"net\"\n    \"net/http\"\n    \"net/http/fcgi\"\n    \"os\"\n)\n\nfunc main() {\n    //setup the config\n    configFile := \"config.json\"\n    fd, err := os.Open(configFile)\n    if err != nil {\n        log.Fatalf(\"Can't open config file: %v\", configFile)\n    }\n    CFG := config{}\n    err = json.NewDecoder(fd).Decode(&amp;CFG)\n    if err != nil {\n        log.Fatalf(\"parse config error: %v\", err)\n    }\n\n    //init DB connection\n    db.InitConnectionInfo(CFG.Database.Host, CFG.Database.Port, CFG.Database.Database, CFG.Database.Username, CFG.Database.Password)\n\n    //register HTTP handler\n    sessionHandler := &amp;handlers.SessionHandler{}\n    http.Handle(\"/sessions\", sessionHandler)\n    http.Handle(\"/sessions/\", sessionHandler)\n\n    userHandler := &amp;handlers.UserHandler{\n        Facebook:      &amp;oa.OAuth{AppId: CFG.Facebook.Key, Secret: CFG.Facebook.Secret},\n        Sina:          &amp;oa.OAuth{AppId: CFG.Sina.Key, Secret: CFG.Sina.Secret},\n        Google:        &amp;oa.OAuth{AppId: CFG.Google.Key, Secret: CFG.Google.Secret},\n        Tencent:       &amp;oa.OAuth{AppId: CFG.Tencent.Key, Secret: CFG.Tencent.Secret},\n        Mixpanel:      &amp;hu.Share{Token: CFG.Mixpanel.Token},\n        FacebookShare: &amp;hu.Share{Token: CFG.Facebook.Token},\n        SinaShare:     &amp;hu.Share{Token: CFG.Sina.Token},\n        GoogleShare:   &amp;hu.Share{Token: CFG.Google.Token},\n        TencentShare:  &amp;hu.Share{Token: CFG.Tencent.Token},\n    }\n    http.Handle(\"/users\", userHandler)\n    http.Handle(\"/users/\", userHandler)\n\n    //and so on ...\n\n    //run server\n    log.Println(\"start listen: \", CFG.FcgiAddr)\n    l, _ := net.Listen(\"tcp\", CFG.FcgiAddr)\n    log.Fatalf(\"server error is %v\", fcgi.Serve(l, nil))\n    //@@select {}\n    log.Println(\"end listen\")\n}\n</code></pre>\n\n<p>```</p>\n\n<p>build it and deploy behind nginx.</p>\n\n<p>then client query <code>/users/1234567/places</code>, <code>/users/1234567</code>, and so on...</p>\n\n<p>get the response is <code>{blank data}</code>, <code>{normal user(1234567) data}</code> or <code>{normal user(1234567) data}</code>, <code>{normal user(1234567) data}</code>. </p>\n\n<p>same prefix of query, and same handler, looks like it is overload the response by subsequent HTTP request.</p>\n\n<p>How can I do it?</p>\n\n<p>May need me to give an example of a response:</p>\n\n<p>correct response is :</p>\n\n<p><code>\n{\n    \"meta\": {\n        \"code\": 200,\n        \"text\": \"OK\"\n    },\n    \"data\": {\n        \"count\": 21,\n        \"place-tag-maps\": [{\n            \"id\": \"95842310160384\",\n            \"place-id\": \"95551731663150\",\n            \"tag-id\": \"95551579750669\",\n            \"ct\": \"2014-07-01T09:07:28Z\"\n        }, {\n            \"id\": \"95842310160385\",\n            \"place-id\": \"95551731663150\",\n            \"tag-id\": \"95551579750694\",\n            \"ct\": \"2015-01-15T17:41:23Z\"\n        }, {\n            \"id\": \"96262389694470\",\n            \"place-id\": \"95551731663150\",\n            \"tag-id\": \"95910120456455\",\n            \"ct\": \"2016-07-18T13:11:39Z\"\n        }, ...],\n        \"places\": [{\n            \"id\": \"95551731663150\",\n            \"name\": \"Kam Fung Restaurant\",\n            \"address\": \"G/F, 41 Spring Garden Ln\",\n            \"coordinate\": {\n                \"latitude\": 22.275576,\n                \"longitude\": 114.172582\n            },\n            \"telephone\": \"+852 2572 0526\",\n            \"city-id\": \"95530516807703\",\n            \"city\": \"Hong Kong\",\n            \"country\": \"Hong Kong\",\n            \"type\": \"4sq\",\n            \"ref-id\": \"4b1613f8f964a520cdb623e3\",\n            \"ct\": \"2016-02-23T07:42:43.565489Z\",\n            \"mt\": \"2017-02-22T09:35:48.302929Z\",\n            \"rating\": 7.5,\n            \"stats\": {\n                \"foursquare\": {\n                    \"count\": 111,\n                    \"value\": 7.5\n                },\n                \"spottly\": {\n                    \"save-count\": 12\n                }\n            },\n            \"permanent-close\": false,\n            \"price\": \"\"\n        }, ...],\n        \"posts\": [{\n            \"collection-id\": \"95551746474003\",\n            \"coordinate\": {\n                \"latitude\": 22.275576,\n                \"longitude\": 114.172582\n            },\n            \"ct\": \"2017-02-22T09:35:47Z\",\n            \"facebook-tag-users\": [],\n            \"id\": \"97501586849795\",\n            \"medias\": [],\n            \"message\": \"\",\n            \"mt\": \"2017-02-22T09:35:47Z\",\n            \"owner-id\": \"96527264645120\",\n            \"place-id\": \"95551731663150\",\n            \"share-to\": [],\n            \"star\": 5,\n            \"status\": \"Done\",\n            \"tags\": []\n        }, ...],\n        \"users\": [{\n            \"id\": \"95551581323446\",\n            \"uid\": \"hk_epicurus\",\n            \"uid-ignore-case\": \"hk_epicurus\",\n            \"name\": \"Hk Epicurus\",\n            \"head\": \"https://d278wa0j9nq2mp.cloudfront.net/uploader/54aa335ddf4e63450002919a.jpeg\",\n            \"site\": \"www.hkepicurus.com\",\n            \"location\": \"Hong Kong\",\n            \"description\": \"Hong Kong Food \\u0026 Travel Bear.\\nGrew up in Aust, Malaysia, Tokyo \\u0026 HK. \\nInstagram: EpicurusHongKong\\nFacebook, Spottly \\u0026 Twitter: HK Epicurus \\n\u5fae\u535a: \u9999\u6e2f\u7f8e\u98df-\u4f0a\u6bd4\\nFacebook Fans Page:  http://on.fb.me/1qDyiIk\",\n            \"ct\": \"2013-10-13T19:12:41Z\",\n            \"mt\": \"2015-11-08T15:22:45Z\"\n        }, ...]\n    }\n}\n</code>\nand\n<code>\n{\n    \"meta\": {\n        \"code\": 200,\n        \"text\": \"OK\"\n    },\n    \"data\": {\n        \"friends\": [{\n            \"id\": \"97331335725056\",\n            \"from-id\": \"97273770803200\",\n            \"to-id\": \"96527264645120\",\n            \"ct\": \"2017-01-23T07:58:41Z\"\n        }],\n        \"user\": {\n            \"ct\": \"2013-04-30T23:30:05Z\",\n            \"description\": \"Founder and Chief Everything Officer of Spottly. Loves to eat. Have a really bad memory. Wants to remember the best places and make travel research better\",\n            \"followers\": {\n                \"count\": 41291\n            },\n            \"followings\": {\n                \"count\": 322\n            },\n            \"head\": \"https://d278wa0j9nq2mp.cloudfront.net/uploader/525ffac8df4e6347870145ef.jpeg\",\n            \"id\": \"96527264645120\",\n            \"location\": \"Vancouver | Hong Kong | Beijing \",\n            \"mt\": \"2015-10-27T09:47:12Z\",\n            \"name\": \"Edwyn Chan\",\n            \"site\": \"http://spottly.com/edwyn\",\n            \"uid\": \"edwyn\",\n            \"uid-ignore-case\": \"edwyn\"\n        }\n    }\n}\n</code></p>\n\n<p>but mistake response is </p>\n\n<p><code>\n{\n    \"meta\": {\n        \"code\": 200,\n        \"text\": \"OK\"\n    }\n}\n</code>\nand\n<code>\n{\n    \"meta\": {\n        \"code\": 200,\n        \"text\": \"OK\"\n    },\n    \"data\": {\n        \"friends\": [{\n            \"id\": \"97331335725056\",\n            \"from-id\": \"97273770803200\",\n            \"to-id\": \"96527264645120\",\n            \"ct\": \"2017-01-23T07:58:41Z\"\n        }],\n        \"user\": {\n            \"ct\": \"2013-04-30T23:30:05Z\",\n            \"description\": \"Founder and Chief Everything Officer of Spottly. Loves to eat. Have a really bad memory. Wants to remember the best places and make travel research better\",\n            \"followers\": {\n                \"count\": 41291\n            },\n            \"followings\": {\n                \"count\": 322\n            },\n            \"head\": \"https://d278wa0j9nq2mp.cloudfront.net/uploader/525ffac8df4e6347870145ef.jpeg\",\n            \"id\": \"96527264645120\",\n            \"location\": \"Vancouver | Hong Kong | Beijing \",\n            \"mt\": \"2015-10-27T09:47:12Z\",\n            \"name\": \"Edwyn Chan\",\n            \"site\": \"http://spottly.com/edwyn\",\n            \"uid\": \"edwyn\",\n            \"uid-ignore-case\": \"edwyn\"\n        }\n    }\n}\n</code></p>\n\n<p>the first response is error. or it's same as the second response.</p>\n\n<p>sequence request is correct response, parallel request is incorrect response.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "edited": false, "score": 0, "creation_date": 1489487167, "post_id": 42783238, "comment_id": 72680845, "body": "In addition, he performs the common Go beginner&#39;s mistake of not exporting the struct fields by capitalizing the initial letter. But that <i>is</i> a nice tool!"}, {"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "edited": false, "score": 0, "creation_date": 1489487351, "post_id": 42783238, "comment_id": 72680981, "body": "Any yet another thing: If that is the &quot;json&quot; he is using, it is invalid. JSON objects keys must be wrapped in quotes: <code>&quot;barcode&quot;</code> instead of <code>barcode</code>"}, {"owner": {"reputation": 12672, "user_id": 1200821, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Cm117.jpg?s=128&g=1", "display_name": "Juan Diego Godoy Robles", "link": "https://stackoverflow.com/users/1200821/juan-diego-godoy-robles"}, "reply_to_user": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "edited": false, "score": 0, "creation_date": 1489487679, "post_id": 42783238, "comment_id": 72681215, "body": "Thanks again @ANisus  incorporated to the answer."}, {"owner": {"reputation": 4291, "user_id": 304215, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/cVby7.jpg?s=128&g=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/304215/suresh"}, "reply_to_user": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "edited": false, "score": 1, "creation_date": 1489488673, "post_id": 42783238, "comment_id": 72681950, "body": "@ANisus : Actually, I&#39;m using  <code>https:&#47;&#47;github.com&#47;olivere&#47;elastic</code> for communicating with Elasticsearch &amp; where one example at there given like this <code>tweet := Tweet{User: &quot;olivere&quot;, Message: &quot;Package strconv implements conversions to and from string representations of basic data types. &quot; + strconv.Itoa(n)}</code> . That&#39;s why I&#39;ve just strip down those quotes from my JSON string."}, {"owner": {"reputation": 4291, "user_id": 304215, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/cVby7.jpg?s=128&g=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/304215/suresh"}, "edited": false, "score": 0, "creation_date": 1489489134, "post_id": 42783238, "comment_id": 72682297, "body": "@klashxx I&#39;ve posted my main go file <code>main.go</code>. Can you please look at it &amp; tell me what could be the problem."}], "tags": [], "owner": {"reputation": 12672, "user_id": 1200821, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Cm117.jpg?s=128&g=1", "display_name": "Juan Diego Godoy Robles", "link": "https://stackoverflow.com/users/1200821/juan-diego-godoy-robles"}, "is_accepted": false, "score": 0, "last_activity_date": 1489489410, "last_edit_date": 1489489410, "creation_date": 1489486705, "answer_id": 42783238, "question_id": 42782901, "link": "https://stackoverflow.com/questions/42782901/how-to-create-structure-for-nested-data-set-in-golang/42783238#42783238", "title": "How to create structure for nested data set in golang?", "body": "<p><strong>Workflow</strong></p>\n\n<p>1.- Validate your <a href=\"http://jsonlint.com/\" rel=\"nofollow noreferrer\">json</a> (the one you posted is invalid).</p>\n\n<p>2.- Build a proper <code>struct</code>, you can help yourself using this nice <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">tool</a>.</p>\n\n<p><strong>For your case</strong></p>\n\n<p>The <code>structs</code> appears to be fine except you're not exporting the struct fields by capitalizing the initial letter (Thanks @ANisus).</p>\n\n<p>This (shorted) seems more <em>natural</em>.</p>\n\n<pre><code>type Product struct {\n    ProductDisplayname string `json:\"product_displayname\"`\n    ProductSpec struct {\n        DisplaySpec []struct {\n            SpecID string `json:\"spec_id\"`\n            Sdv string `json:\"sdv\"`\n            Snv string `json:\"snv\"`\n        } `json:\"display_spec\"`\n        FilterSpec []struct {\n            SpecID string `json:\"spec_id\"`\n            Sdv string `json:\"sdv\"`\n            Snv string `json:\"snv\"`\n        } `json:\"filter_spec\"`\n    } `json:\"product_spec\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 4291, "user_id": 304215, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/cVby7.jpg?s=128&g=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/304215/suresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 503, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1489489410, "creation_date": 1489485841, "last_edit_date": 1489489034, "question_id": 42782901, "link": "https://stackoverflow.com/questions/42782901/how-to-create-structure-for-nested-data-set-in-golang", "title": "How to create structure for nested data set in golang?", "body": "<p>New to golang &amp; trying to make a script for making bulk upload to Elasticsearch server. My json data set is something like this...</p>\n\n<pre><code>{\n    product_displayname: \"LG Stylus 2 Plus K535D (16 GB, Brown)\",\n    product_price: \"24000.00\",\n    popularity: \"0.00\",\n    barcode: \"\",\n    exclusive_flag: \"0\",\n    product_id: \"176982\",\n    product_name: \"Stylus 2 Plus K535D (Brown)\",\n    brand_name: \"LG\",\n    brand_id: \"1\",\n    product_spec : {\n        display_spec: [{\n            spec_id: \"103\",\n            sdv: \"24000\",\n            snv: \"24000.0000\"\n        }, {\n            spec_id: \"104\",\n            sdv: \"GSM\",\n            snv: \"0.0000\"\n        }],\n        filter_spec: [{\n            spec_id: \"103\",\n            sdv: \"24000\",\n            snv: \"24000.0000\"\n        }, {\n            spec_id: \"105\",\n            sdv: \"Touch Screen\",\n            snv: \"0.0000\"\n        }]\n    }\n}\n</code></pre>\n\n<p>Golang Structure I made(by refering google &amp; other online info) for the above dataset is like this...</p>\n\n<pre><code>type Product struct {\n    product_displayname string `json:\"product_displayname\"`\n    product_price       string `json:\"product_price\"`\n    popularity          string `json:\"popularity\"`\n    barcode             string `json:\"barcode\"`\n    exclusive_flag      string `json:\"exclusive_flag\"`\n    product_id          string `json:\"product_id\"`\n    product_name        string `json:\"product_name\"`\n    brand_name          string `json:\"brand_name\"`\n    brand_id            string `json:\"brand_id\"`\n    product_spec\n}\n\ntype product_spec struct {\n    display_spec []display_speclist\n    filter_spec []filter_speclist\n}\n\ntype display_speclist struct {\n    spec_id string `json:\"spec_id\"`\n    sdv     string `json:\"sdv\"`\n    snv     string `json:\"snv\"`\n}\n\ntype filter_speclist struct {\n    spec_id string `json:\"spec_id\"`\n    sdv     string `json:\"sdv\"`\n    snv     string `json:\"snv\"`\n}\n</code></pre>\n\n<p>But, whenever I'm trying to use above Structure with sample data in my bulk upload script I'm getting following error</p>\n\n<pre><code>github.com/crazyheart/elastic-bulk-upload/main.go:70: syntax error: missing operand\ngithub.com/crazyheart/elastic-bulk-upload/main.go:70: unknown escape sequence\ngithub.com/crazyheart/elastic-bulk-upload/main.go:71: syntax error: non-declaration statement outside function body\n</code></pre>\n\n<p>I feel like I'm making some mistake in mapping that nested field <code>display_spec &amp; filter_spec</code> in golang structure. But can't able to figure out what it is.</p>\n\n<p><strong>main.go</strong> </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"golang.org/x/net/context\"\n    \"gopkg.in/olivere/elastic.v5\"\n    \"strconv\"\n)\n\ntype Product struct {\n    ProductDisplayname string `json:\"product_displayname\"`\n    ProductPrice string `json:\"product_price\"`\n    Popularity string `json:\"popularity\"`\n    Barcode string `json:\"barcode\"`\n    ExclusiveFlag string `json:\"exclusive_flag\"`\n    ProductID string `json:\"product_id\"`\n    ProductName string `json:\"product_name\"`\n    BrandName string `json:\"brand_name\"`\n    BrandID string `json:\"brand_id\"`\n    ProductSpec struct {\n        DisplaySpec []struct {\n            SpecID string `json:\"spec_id\"`\n            Sdv string `json:\"sdv\"`\n            Snv string `json:\"snv\"`\n        } `json:\"display_spec\"`\n        FilterSpec []struct {\n            SpecID string `json:\"spec_id\"`\n            Sdv string `json:\"sdv\"`\n            Snv string `json:\"snv\"`\n        } `json:\"filter_spec\"`\n    } `json:\"product_spec\"`\n}\n\nfunc main() {\n    // Create a context\n    ctx := context.Background()\n\n    client, err := elastic.NewClient()\n    if err != nil {\n        fmt.Println(\"%v\", err)\n    }\n\n    // Bulk upload code\n    n := 0\n    for i := 0; i &lt; 1000; i++ {\n        bulkRequest := client.Bulk()\n        for j := 0; j &lt; 10000; j++ {\n            n++\n            product_data := Product{product_displayname:\"LG Stylus 2 Plus K535D (16 GB, Brown)\",product_price:\"24000.00\",popularity:\"0.00\",barcode:\"\",exclusive_flag:\"0\",product_id:\"17698276\",product_name:\"Stylus 2 Plus K535D (Brown)\",brand_name:\"LG\",brand_id:\"1\",product_spec:{display_spec:[{spec_id:\"103\",sdv:\"24000\",snv:\"24000.0000\"},{spec_id:\"104\",sdv:\"GSM\",snv:\"0.0000\"}],filter_spec:[{spec_id:\"103\",sdv:\"24000\",snv:\"24000.0000\"},{spec_id:\"105\",sdv:\"Touch Screen\",snv:\"0.0000\"}]} }\n            req := elastic.NewBulkIndexRequest().Index(\"shopfront\").Type(\"products\").Id(strconv.Itoa(n)).Doc(product_data)\n            bulkRequest = bulkRequest.Add(req)\n        }\n\n        bulkResponse, err := bulkRequest.Do(ctx)\n        if err != nil {\n            fmt.Println(err)\n        }\n        if bulkResponse != nil {\n            fmt.Println(bulkResponse)\n        }\n        fmt.Println(i)\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1489486861, "post_id": 42782735, "comment_id": 72680618, "body": "As literally nothing can be accessed at compile time you must have something non-obvious in mind. Please explain what you are trying to to and elaborate on your question."}], "answers": [{"comments": [{"owner": {"reputation": 11210, "user_id": 725937, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/32cba7500e49d4c491289f9e101c693b?s=128&d=identicon&r=PG", "display_name": "abergmeier", "link": "https://stackoverflow.com/users/725937/abergmeier"}, "edited": false, "score": 0, "creation_date": 1489695694, "post_id": 42784181, "comment_id": 72796957, "body": "While compiling you can access constant object code just fine."}], "tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 0, "last_activity_date": 1489489244, "creation_date": 1489489244, "answer_id": 42784181, "question_id": 42782735, "link": "https://stackoverflow.com/questions/42782735/check-go-expression-availability-at-compile-time/42784181#42784181", "title": "Check go expression availability at compile time", "body": "<p>Object code is result of compilation process.</p>\n\n<blockquote>\n  <p>In a general sense object code is a sequence of statements or instructions in a computer language, usually a machine code language (i.e., binary).</p>\n</blockquote>\n\n<p>Before compilation finished nothing can be accessed.</p>\n"}], "owner": {"reputation": 11210, "user_id": 725937, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/32cba7500e49d4c491289f9e101c693b?s=128&d=identicon&r=PG", "display_name": "abergmeier", "link": "https://stackoverflow.com/users/725937/abergmeier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489695921, "creation_date": 1489485417, "last_edit_date": 1489695921, "question_id": 42782735, "link": "https://stackoverflow.com/questions/42782735/check-go-expression-availability-at-compile-time", "title": "Check go expression availability at compile time", "body": "<p>I am writing a (hobby) compiler for Go.</p>\n\n<p>Now for optimizing I am wondering: Is there a way yet to check whether data inside <code>ast.Expr</code> can be accessed at compile time?</p>\n\n<p>I know that I can parse through to <code>ast.*Lit</code>.</p>\n"}, {"tags": ["sql", "go"], "comments": [{"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 1, "creation_date": 1489487260, "post_id": 42782193, "comment_id": 72680921, "body": "For that what you want to do maybe a SQL DB is not the optimal DB-type. So I would select tablea and select tableb and range over the results to build my result struc"}, {"owner": {"reputation": 121, "user_id": 4453398, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/STU1F.png?s=128&g=1", "display_name": "lean der", "link": "https://stackoverflow.com/users/4453398/lean-der"}, "reply_to_user": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1489488760, "post_id": 42782193, "comment_id": 72682015, "body": "That&#39;s what I suspected. Thanks for your reply!"}], "owner": {"reputation": 121, "user_id": 4453398, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/STU1F.png?s=128&g=1", "display_name": "lean der", "link": "https://stackoverflow.com/users/4453398/lean-der"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 902, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489483862, "creation_date": 1489483862, "question_id": 42782193, "link": "https://stackoverflow.com/questions/42782193/mapping-sql-rows-to-nested-structs-slices-in-go", "title": "Mapping SQL rows to nested structs/slices in Go", "body": "<p>I'm having a hard time mapping the returned rows with a one-to-many relationship to a nested struct in Go. </p>\n\n<p>The struct looks like:</p>\n\n<pre><code>type Result struct {\n    ID         string      `db:\"id\" json:\"id\"`\n    Title      string      `db:\"title\" json:\"title\"`\n    Content    string      `db:\"content\" json:\"content\"`\n    TableA    []TableA   `json:\"tablea\"`\n}\n\ntype TableA struct {\n    foo       string `db:\"foo\" json:\"foo\"`\n    bar       string `db:\"bar\" json:\"bar\"`\n    TableAId  string `db:\"tablea_id\" json:\"tablea_id\"`\n}\n</code></pre>\n\n<p>The corresponding tables:</p>\n\n<pre><code>CREATE TABLE tablea (\n  id INT (10) UNSIGNED PRIMARY KEY AUTO_INCREMENT,\n  title VARCHAR (20) NOT NULL,\n  content VARCHAR (55) NOT NULL\n);\n\n\nCREATE TABLE tableb (\n  id INT (10) PRIMARY KEY AUTO_INCREMENT,\n  foo VARCHAR (255) NOT NULL,\n  bar VARCHAR (255) NOT NULL,\n  tablea_id INT (10) UNSIGNED,\n  INDEX par_ind (tablea_id),\n  FOREIGN KEY (tablea_id) REFERENCES tablea(id) ON DELETE CASCADE\n\n);\n</code></pre>\n\n<p>I can't figure out how to map the rows of</p>\n\n<pre><code>SELECT\n         tablea.id, tablea.title, tablea.content,\n         tableb.foo, tableb.bar\n       FROM gowebapp.tablea\n       LEFT OUTER JOIN gowebapp.tableb On tableb.tablea_id = tablea.id;\n</code></pre>\n\n<p>with the return</p>\n\n<pre><code>+----+-------+---------+------+------+\n| id | title | content | foo  | bar  |\n+----+-------+---------+------+------+\n|  1 | lorem | ipsum   | foo1 | bar1 |\n|  1 | lorem | ipsum   | foo2 | bar2 |\n|  1 | lorem | ipsum   | foo3 | bar3 |\n+----+-------+---------+------+------+\n</code></pre>\n\n<p>to my Result struct. I'm new to Go and tried to make the examples above as generic as possible as I haven't found any resources on how to do this. </p>\n\n<p>Any help is greatly appreciated.</p>\n"}, {"tags": ["go", "visual-studio-code"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1489487629, "post_id": 42780659, "comment_id": 72681176, "body": "AFAIK no, and it&#39;s very annoying in other languages as well. Long function names mean you cannot see the the entire function signature."}, {"owner": {"reputation": 73, "user_id": 2879510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6038a92a06555024fb44e2daf241cab?s=128&d=identicon&r=PG&f=1", "display_name": "Raizul", "link": "https://stackoverflow.com/users/2879510/raizul"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1489493851, "post_id": 42780659, "comment_id": 72685597, "body": "Thanks for the reply."}], "answers": [{"tags": [], "owner": {"reputation": 678, "user_id": 1392364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d83424400568ec29f61758e65502d27?s=128&d=identicon&r=PG", "display_name": "sheppe", "link": "https://stackoverflow.com/users/1392364/sheppe"}, "is_accepted": false, "score": 0, "last_activity_date": 1489506504, "creation_date": 1489506504, "answer_id": 42790558, "question_id": 42780659, "link": "https://stackoverflow.com/questions/42780659/vs-code-how-to-enable-documentation-when-scrolling-intellisense-suggestions/42790558#42790558", "title": "VS Code how to enable documentation when scrolling intelliSense suggestions?", "body": "<p>Try installing the Go extension. Here's the source: <a href=\"https://github.com/Microsoft/vscode-go\" rel=\"nofollow noreferrer\">https://github.com/Microsoft/vscode-go</a></p>\n\n<p>It offers Intellisense/completion lists, though the completion lists feature is not working too well right now (I'm sure it will improve over time). The extension is able to get function signatures and documentation by mousing over their names once you've typed them in, even if they don't show up in Intellisense, however. </p>\n\n<p>Be sure to read the extension documentation on how to get everything installed, as it makes use of a number of tools to offer all of its functionality.</p>\n"}], "owner": {"reputation": 73, "user_id": 2879510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6038a92a06555024fb44e2daf241cab?s=128&d=identicon&r=PG&f=1", "display_name": "Raizul", "link": "https://stackoverflow.com/users/2879510/raizul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1489506504, "creation_date": 1489478632, "question_id": 42780659, "link": "https://stackoverflow.com/questions/42780659/vs-code-how-to-enable-documentation-when-scrolling-intellisense-suggestions", "title": "VS Code how to enable documentation when scrolling intelliSense suggestions?", "body": "<p>In Intellij Idea I can see documentation on intelliSense options:\n<a href=\"https://i.stack.imgur.com/GqDDf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GqDDf.png\" alt=\"enter image description here\"></a></p>\n\n<p>Can I enable something like this in vs code for golang ?\nCan I control the width and height of the two rectangles ?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 7707260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94da7fdd7499687623cc0c2335d98bd8?s=128&d=identicon&r=PG&f=1", "display_name": "J. Gorey", "link": "https://stackoverflow.com/users/7707260/j-gorey"}, "edited": false, "score": 0, "creation_date": 1489478837, "post_id": 42780598, "comment_id": 72675497, "body": "I edited my question to be more clear. I eventually must use := because in real life situation I need to hold f as well"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 39, "user_id": 7707260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94da7fdd7499687623cc0c2335d98bd8?s=128&d=identicon&r=PG&f=1", "display_name": "J. Gorey", "link": "https://stackoverflow.com/users/7707260/j-gorey"}, "edited": false, "score": 1, "creation_date": 1489478958, "post_id": 42780598, "comment_id": 72675560, "body": "@J.Gorey so what is your question? You&#39;re creating a local variable that shadows the global one."}], "tags": [], "owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "is_accepted": false, "score": 7, "last_activity_date": 1489479119, "last_edit_date": 1489479119, "creation_date": 1489478425, "answer_id": 42780598, "question_id": 42780555, "link": "https://stackoverflow.com/questions/42780555/global-error-variable-remains-nil-after-initialization/42780598#42780598", "title": "global error variable remains nil after initialization", "body": "<pre><code>func main() {\n    _, loadErr := os.Open(\"asdasd\")\n</code></pre>\n\n<p>You create a <strong>new, local</strong> variable <code>loadErr</code>, the global one is never set. Use just <code>=</code>, not <code>:=</code>, to use the global one.</p>\n\n<p>Edit: To hold the second value too, you have to predeclare the second variable:</p>\n\n<pre><code>var f *os.File\nf, loadErr = os.Open(\"asdasd\")\n</code></pre>\n\n<p>Unfortunately, you can't use <code>:=</code> here, as <code>:=</code> will not consider non-local variables and just create a local variable in this case.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1489482815, "last_edit_date": 1495539988, "creation_date": 1489482815, "answer_id": 42781860, "question_id": 42780555, "link": "https://stackoverflow.com/questions/42780555/global-error-variable-remains-nil-after-initialization/42781860#42781860", "title": "global error variable remains nil after initialization", "body": "<p>The <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">short variable declaration</a> creates new variables if the variables on the left side have been declared in an outer <a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow noreferrer\">scope</a>. <strong>This is also true if not all variables are new on the left side</strong>, which otherwise would be <em>redeclaration</em> (which does not introduce a new variable; it just assigns a new value to the original).</p>\n\n<p>So if you want to assign value to the global variable, don't use short variable declaration but simple <a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow noreferrer\">assignment</a>. Of course, for a tuple assignment where one variable has been declared earlier, you must declare the other one too prior:</p>\n\n<pre><code>var f *os.File\nf, loadErr = os.Open(\"asdasd\")\nif loadErr != nil {\n    // Handle error\n}\n</code></pre>\n\n<p>You can write it more compact:</p>\n\n<pre><code>var f *os.File\nif f, loadErr = os.Open(\"asdasd\"); loadErr != nil {\n    // Handle error\n}\n</code></pre>\n\n<p>There is also another option using short variable declaration, but then you must \"manually\" assign the error value to the global <code>loadErr</code> variable:</p>\n\n<pre><code>f, err := os.Open(\"asdasd\")\nloadErr = err\nif err != nil {\n    // Handle error\n}\n</code></pre>\n\n<p>Or more compact:</p>\n\n<pre><code>f, err := os.Open(\"asdasd\")\nif loadErr = err; err != nil {\n    // Handle error\n}\n</code></pre>\n\n<p>See related / possible duplicate question: <a href=\"https://stackoverflow.com/questions/34195360/golang-how-to-use-global-var-across-files-in-a-package/34195389#34195389\">How to use global var across files in a package?</a></p>\n"}], "owner": {"reputation": 39, "user_id": 7707260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94da7fdd7499687623cc0c2335d98bd8?s=128&d=identicon&r=PG&f=1", "display_name": "J. Gorey", "link": "https://stackoverflow.com/users/7707260/j-gorey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2941, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1551548096, "creation_date": 1489478265, "last_edit_date": 1551548096, "question_id": 42780555, "link": "https://stackoverflow.com/questions/42780555/global-error-variable-remains-nil-after-initialization", "title": "global error variable remains nil after initialization", "body": "<p>When I initialize an error variable globally it seems that it's nil to another function in the same package.<br>\nI don't understand why is this code not panicing?  </p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"fmt\"\n)\n\nvar loadErr error\n\nfunc main() {\n    f, loadErr := os.Open(\"asdasd\")\n    if loadErr != nil {\n        checkErr()\n    }\n    if f != nil {\n        fmt.Println(f.Name())\n    }\n}\n\n// panic won't be called because loadErr is nil\nfunc checkErr() {\n    if loadErr != nil {\n        panic(loadErr)\n    }\n}\n</code></pre>\n\n<p>But when I do this, it seems to work as expected?  </p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n)\n\nvar loadErr error\n\nfunc main() {\n    _, err := os.Open(\"asdasd\")\n    loadErr = err\n    if loadErr != nil {\n        checkErr()\n    }\n}\n\n// panic will be called as expected\nfunc checkErr() {\n    if loadErr != nil {\n        panic(loadErr)\n    }\n}\n</code></pre>\n"}, {"tags": ["linux", "go", "buffer", "stdin"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1489476482, "post_id": 42779856, "comment_id": 72674233, "body": "Before addressing the question of how to read &gt; 4095 bytes, what is the goal you are trying to achieve? Slurping &quot;large amounts&quot; of data into a byte array is usually a bad idea. For most use cases, you should operate on streams, for better performance, and lower memory consumption."}, {"owner": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1489477275, "post_id": 42779856, "comment_id": 72674638, "body": "@Flimzy That&#39;s a good point, and I&#39;ll keep it in mind. I later plan on using files for input and so it would be in chunks (i.e. a stream). I&#39;m just wondering if there&#39;s an idiomatic way of reading more than 4095 bytes from stdin."}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1489486787, "post_id": 42779856, "comment_id": 72680553, "body": "Why do you use <a href=\"https://golang.org/pkg/bufio/#Reader.ReadLine\" rel=\"nofollow noreferrer\">ReadLine</a>? When <code>stdin</code> has no <code>\\n</code> it will stop, because you break, when isPrefix. How about using <code>Read()</code>?"}, {"owner": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "reply_to_user": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1489491653, "post_id": 42779856, "comment_id": 72684046, "body": "@apxp Read() isn&#39;t suitable since it isn&#39;t known in advance how much data the user will input."}], "answers": [{"comments": [{"owner": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "edited": false, "score": 0, "creation_date": 1489497697, "post_id": 42785983, "comment_id": 72688384, "body": "Yeah, I know the size of the buffer can be changed but that&#39;s not a very nice solution."}, {"owner": {"reputation": 1642, "user_id": 1509169, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/8MgOC.jpg?s=128&g=1", "display_name": "Alexander R.", "link": "https://stackoverflow.com/users/1509169/alexander-r"}, "reply_to_user": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "edited": false, "score": 1, "creation_date": 1489499818, "post_id": 42785983, "comment_id": 72690099, "body": "It&#39;s very good solution. You must use limits every time. You don&#39;t have infinity resources. Just set it to reasonable size for you. It&#39;s a best practice."}, {"owner": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "edited": false, "score": 0, "creation_date": 1489522556, "post_id": 42785983, "comment_id": 72705959, "body": "Also, just tried this solution, changing the size of the buffer, and it still truncated the input. At this point I&#39;m thinking the problem isn&#39;t to do with the buffering."}, {"owner": {"reputation": 1642, "user_id": 1509169, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/8MgOC.jpg?s=128&g=1", "display_name": "Alexander R.", "link": "https://stackoverflow.com/users/1509169/alexander-r"}, "reply_to_user": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "edited": false, "score": 0, "creation_date": 1489530798, "post_id": 42785983, "comment_id": 72710267, "body": "What is a system that you try to run your code on it? There exists some  systems that its stdin size is defined by kernel and its size are 4k like the page size. So, if it doesn&#39;t work with increased buffer size in go, try to find what your kernel&#39;s stdin buffer is."}, {"owner": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "edited": false, "score": 0, "creation_date": 1489562531, "post_id": 42785983, "comment_id": 72719838, "body": "Arch Linux. I&#39;ve heard that running the system in raw mode would fix this issue, but I can&#39;t find a pure-go solution other than either use termbox and implement getch-type behaviour, or use ssh/terminal (didn&#39;t work as far as I tested."}], "tags": [], "owner": {"reputation": 1642, "user_id": 1509169, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/8MgOC.jpg?s=128&g=1", "display_name": "Alexander R.", "link": "https://stackoverflow.com/users/1509169/alexander-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1489494368, "creation_date": 1489494368, "answer_id": 42785983, "question_id": 42779856, "link": "https://stackoverflow.com/questions/42779856/read-large-amount-of-data-from-standard-input/42785983#42785983", "title": "Read large amount of data from standard input", "body": "<p>If you'll look at Go sources, you will see that it uses default buffer size:</p>\n\n<pre><code>func NewReader(rd io.Reader) *Reader {\n    return NewReaderSize(rd, defaultBufSize)\n}\n</code></pre>\n\n<p>So you can use in your code as:</p>\n\n<pre><code>var stdinReader = bufio.NewReaderSize(os.Stdin, 10000)\n</code></pre>\n\n<p>P.S.\nGo is open source, so you can learn a lot just from looking inside internals.</p>\n"}, {"tags": [], "owner": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "is_accepted": false, "score": 0, "last_activity_date": 1553268524, "creation_date": 1553268524, "answer_id": 55302983, "question_id": 42779856, "link": "https://stackoverflow.com/questions/42779856/read-large-amount-of-data-from-standard-input/55302983#55302983", "title": "Read large amount of data from standard input", "body": "<p>I believe this has to do with terminals having a fixed sized buffer for stdin input. I'm not sure that there's any way around this other than piping data in or reading it from a file or a network location.</p>\n"}], "owner": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 885, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1557597551, "creation_date": 1489475836, "last_edit_date": 1489522429, "question_id": 42779856, "link": "https://stackoverflow.com/questions/42779856/read-large-amount-of-data-from-standard-input", "title": "Read large amount of data from standard input", "body": "<p>How do you read lots of data from stdin in Golang? All of my reads currently stop at 4095 bytes. I've tried lots of things but my current code looks like:</p>\n\n<pre><code>var stdinReader = bufio.NewReader(os.stdin)\n\n// Input reads from stdin while echoing back.\nfunc Input(prompt string) []byte {\n    var data []byte\n\n    // Output prompt.\n    fmt.Print(prompt)\n\n    // Read until newline.\n    for {\n        bytes, isPrefix, _ := stdinReader.ReadLine()\n        data = append(data, bytes...)\n\n        if !isPrefix {\n            break\n        }\n    }\n\n    // Everything went well. Return the data.\n    return data\n}\n</code></pre>\n\n<p>I've also tried using a scanner but couldn't figure out how to exit</p>\n\n<pre><code>for scanner.Scan() {\n    data = append(data, scanner.Bytes()...)\n}\n</code></pre>\n\n<p>when a newline occurred (i.e. when the user pressed return).</p>\n\n<p>I also tried ReadBytes('\\n') but even that stopped at 4095 bytes. Short of increasing the size of the buffer (which is just an ugly hack) I'm not sure what to do at this point.</p>\n"}, {"tags": ["opencv", "go", "memory-leaks"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1489498656, "post_id": 42779200, "comment_id": 72689173, "body": "You can&#39;t really leak memory in Go, and I don&#39;t see any goroutines being called that could be left running, so the memory most likely is being used by OpenCV. Does the Go runtime show the memory being allocated? Are you ever releasing the memory used by OpenCV?"}, {"owner": {"reputation": 362, "user_id": 2544044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e4021f92a8fe5f2a4620ef45bfebc6?s=128&d=identicon&r=PG", "display_name": "Chris B.", "link": "https://stackoverflow.com/users/2544044/chris-b"}, "edited": false, "score": 1, "creation_date": 1489503693, "post_id": 42779200, "comment_id": 72693289, "body": "As JimB said, memory probably isn&#39;t released. Check out <a href=\"https://blog.golang.org/c-go-cgo\" rel=\"nofollow noreferrer\">blog.golang.org/c-go-cgo</a>, perhaps the C.free(unsafe.Pointer(..)) can help you."}, {"owner": {"reputation": 1172, "user_id": 4621508, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7edbd50ad77354c926f108838b77b938?s=128&d=identicon&r=PG&f=1", "display_name": "rumdrums", "link": "https://stackoverflow.com/users/4621508/rumdrums"}, "edited": false, "score": 0, "creation_date": 1489509775, "post_id": 42779200, "comment_id": 72697992, "body": "Thanks. I&#39;ll take a look at trying to free the C resources directly. I&#39;ll post an update when I get it working."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489510056, "post_id": 42779200, "comment_id": 72698205, "body": "You can&#39;t just arbitrarily free pointers to try and close the leak, you need to follow the API for the library you&#39;re using. OpenCV has documented functions to free specific data structures which the user is expected to call."}, {"owner": {"reputation": 1172, "user_id": 4621508, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7edbd50ad77354c926f108838b77b938?s=128&d=identicon&r=PG&f=1", "display_name": "rumdrums", "link": "https://stackoverflow.com/users/4621508/rumdrums"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489558956, "post_id": 42779200, "comment_id": 72718191, "body": "@JimB Thanks. The library I&#39;m using for the go bindings indeed has a Release method for images. Using it fixes the problem."}], "answers": [{"tags": [], "owner": {"reputation": 1172, "user_id": 4621508, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7edbd50ad77354c926f108838b77b938?s=128&d=identicon&r=PG&f=1", "display_name": "rumdrums", "link": "https://stackoverflow.com/users/4621508/rumdrums"}, "is_accepted": true, "score": 0, "last_activity_date": 1489559031, "creation_date": 1489559031, "answer_id": 42802452, "question_id": 42779200, "link": "https://stackoverflow.com/questions/42779200/finding-memory-leak-in-go-application/42802452#42802452", "title": "Finding Memory Leak in Go Application", "body": "<p>The <a href=\"https://github.com/lazywei/go-opencv\" rel=\"nofollow noreferrer\">go library I'm using for the OpenCV bindings</a> provides a <code>Release</code> method on images to deallocate memory when done with an image. This fixes the problem. </p>\n"}], "owner": {"reputation": 1172, "user_id": 4621508, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7edbd50ad77354c926f108838b77b938?s=128&d=identicon&r=PG&f=1", "display_name": "rumdrums", "link": "https://stackoverflow.com/users/4621508/rumdrums"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 1, "accepted_answer_id": 42802452, "answer_count": 1, "score": 0, "last_activity_date": 1489559031, "creation_date": 1489473261, "last_edit_date": 1489548864, "question_id": 42779200, "link": "https://stackoverflow.com/questions/42779200/finding-memory-leak-in-go-application", "title": "Finding Memory Leak in Go Application", "body": "<p>I've got a simple program that reads frames off a webcam and puts pointers to them on a channel in a goroutine. Another portion reads the frame pointers from the channel and pops them onto another queue. This other queue then does some additional processing to them, and when this additional processing is done, a bunch of memory gets allocated that apparently never gets garbage collected. I'm in over my head trying to figure out why:</p>\n\n<p>This function reads the frames off the channel in a loop:</p>\n\n<pre><code>func (mr *OpenCVMotionRunner) Run() error {\nlog.Println(\"Starting motion detection... \")\n\n// inMotion := false\nwin := opencv.NewWindow(\"GoOpenCV: VideoPlayer\")\ndefer win.Destroy()\n\ntest := mr.md.(*CV2FrameDiffMotionDetector)\nfor {\n    f := mr.imageChan.PopFrame()\n    mr.frame = nil\n    switch f := f.(type) {\n    default:\n        return fmt.Errorf(\"Unknown frame type\")\n    case *BSFrame:\n        mr.frame = f.ToOpenCVFrame()\n    case *OpenCVFrame:\n        mr.frame = f\n    }\n    f = nil\n    test.SetCurrent(mr.frame)\n    delta := test.Delta()\n    // win.ShowImage(mr.frame.image)\n    if delta != nil {\n        win.ShowImage(delta)\n        opencv.WaitKey(1)\n    } else {\n        fmt.Println(\"wtf\")\n    }\n}\n\nreturn nil\n</code></pre>\n\n<p>}</p>\n\n<p>It appears that the problematic part is this specifically:</p>\n\n<pre><code>mr.frame = f.ToOpenCVFrame()\n</code></pre>\n\n<p>This is the type and the method:</p>\n\n<pre><code>// Frame with byte slice image\ntype BSFrame struct {\n    image  []byte\n    Time   time.Time\n    Width  uint32\n    Height uint32\n}\n\nfunc (f *BSFrame) ToOpenCVFrame() *OpenCVFrame {\n    img := opencv.DecodeImageMem(f.image)\n    return &amp;OpenCVFrame{\n        image:  img,\n        Time:   f.Time,\n        Width:  f.Width,\n        Height: f.Height,\n    }\n}\n</code></pre>\n\n<p>This is the destination type:</p>\n\n<pre><code>type OpenCVFrame struct {\n    image  *opencv.IplImage\n    Time   time.Time\n    Width  uint32\n    Height uint32\n}\n</code></pre>\n\n<p>PopFrame, FYI, is just a method on an type that aliases a channel:</p>\n\n<pre><code>type BSFrameChan chan *BSFrame\n\nfunc (fc BSFrameChan) PopFrame() (frame Frame) {\n    frame = &lt;-fc\n    return\n}\n</code></pre>\n\n<p>Hopefully this is enough code for the problem to present itself. The rest is <a href=\"https://github.com/jaymell/gosmartcam\" rel=\"nofollow noreferrer\">here</a> if needed.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 8269, "user_id": 588734, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/o3CVI.jpg?s=128&g=1", "display_name": "Eamonn McEvoy", "link": "https://stackoverflow.com/users/588734/eamonn-mcevoy"}, "edited": false, "score": 0, "creation_date": 1489472510, "post_id": 42778388, "comment_id": 72672330, "body": "Why doesn&#39;t <code>eventualSession = session </code> use <code>.Copy()</code>?"}, {"owner": {"reputation": 11, "user_id": 6240850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03519b60802d366ea43311cf2a14f266?s=128&d=identicon&r=PG&f=1", "display_name": "Jacky", "link": "https://stackoverflow.com/users/6240850/jacky"}, "reply_to_user": {"reputation": 8269, "user_id": 588734, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/o3CVI.jpg?s=128&g=1", "display_name": "Eamonn McEvoy", "link": "https://stackoverflow.com/users/588734/eamonn-mcevoy"}, "edited": false, "score": 0, "creation_date": 1489476207, "post_id": 42778388, "comment_id": 72674067, "body": "Any difference?  <code>eventualSession </code> and <code>session</code> points to the same object, while my code only use <code>eventualSession</code> or <code>strongSession </code> to read/write mongodb."}, {"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1493876356, "post_id": 42778388, "comment_id": 74590138, "body": "How many times do you create <code>session</code> in your application ? i.e. how many times <code>init()</code> is being called. Every <code>session</code> created must have its Close method called at the end of its life time, so its resources may be put back in the pool or collected, depending on the case. You&#39;re meant to treat it like a connection pool."}], "owner": {"reputation": 11, "user_id": 6240850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03519b60802d366ea43311cf2a14f266?s=128&d=identicon&r=PG&f=1", "display_name": "Jacky", "link": "https://stackoverflow.com/users/6240850/jacky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 690, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1489469458, "creation_date": 1489469458, "question_id": 42778388, "link": "https://stackoverflow.com/questions/42778388/golang-app-server-with-mgo-driven-and-mongodb-replica-set-slave-nodes-too-many", "title": "Golang app server with mgo driven, and mongodb replica set slave nodes: Too many connections", "body": "<p>While using mongodb replica set to serve my app server, I encountered a problem that TCP connections between 4 app servers and 2 mongo slave nodes continued increase until 2 mongo slave nodes stop service.  </p>\n\n<h1>Environment</h1>\n\n<ul>\n<li>operating system: Ubuntu 14.04 64bit, both for mongodb servers and app servers</li>\n<li>mongodb: v3.0.9, replica set with 1 master, 2 slave and 1 arbiter</li>\n<li>app: 4 servers cluster, written by golang, with mongodb driver gopkg.in/mgo.v2</li>\n</ul>\n\n<h1>Details</h1>\n\n<h2> 1. Normally we have about 55 connections on each slave node.</h2>\n\n<p>Here is the normal logs from one of slave nodes:  </p>\n\n<blockquote>\n  <p>2017-03-12T03:01:41.165+0800 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:43775 #1537161 (55 connections now open)<br>\n  2017-03-12T03:01:41.188+0800 I ACCESS   [conn1537161] Successfully authenticated as principal admin on admin<br>\n  2017-03-12T03:01:41.193+0800 I NETWORK  [conn1537161] end connection 127.0.0.1:43775 (54 connections now open)<br>\n  2017-03-12T03:01:41.938+0800 I NETWORK  [conn1537152] end connection 10.162.xxx.xxx:49334 (53 connections now open)<br>\n  2017-03-12T03:01:41.938+0800 I NETWORK  [initandlisten] connection accepted from 10.162.xxx.xxx:49345 #1537162 (54 connections now open)<br>\n  2017-03-12T03:01:41.958+0800 I ACCESS   [conn1537162] Successfully authenticated as principal __system on local<br>\n  2017-03-12T03:01:42.256+0800 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:43776 #1537163 (55 connections now open)<br>\n  2017-03-12T03:01:42.279+0800 I ACCESS   [conn1537163] Successfully authenticated as principal admin on admin<br>\n  2017-03-12T03:01:42.284+0800 I NETWORK  [conn1537163] end connection 127.0.0.1:43776 (54 connections now open)<br>\n  2017-03-12T03:01:42.721+0800 I ACCESS   [conn1401659] Successfully authenticated as principal online on online<br>\n  2017-03-12T03:01:47.243+0800 I NETWORK  [conn1537154] end connection 10.251.xxx.xxx:34844 (53 connections now open)  </p>\n</blockquote>\n\n<h2> 2. At around 3:02 in the morning one day, 2 slave nodes' connections began increase, likely 5-15 connections per node per minute.</h2>\n\n<p>But nothing unusual with mongo master node). Please note that our app servers during this time period have fewer access than daylight. Abnormal logs from the same slave node above:  </p>\n\n<blockquote>\n  <p>2017-03-12T03:05:59.301+0800 I NETWORK  [initandlisten] connection accepted from 10.171.xxx.xxx:33377 #1537221 (86 connections now open)<br>\n  2017-03-12T03:06:01.484+0800 I NETWORK  [conn1537215] end connection 120.26.xxx.xxx:48190 (85 connections now open)<br>\n  2017-03-12T03:06:01.487+0800 I NETWORK  [initandlisten] connection accepted from 120.26.xxx.xxx:48203 #1537222 (86 connections now open)<br>\n  2017-03-12T03:06:01.508+0800 I ACCESS   [conn1537222] Successfully authenticated as principal __system on local<br>\n  2017-03-12T03:06:05.464+0800 I NETWORK  [initandlisten] connection accepted from 10.168.xxx.xxx:51008 #1537223 (87 connections now open)<br>\n  2017-03-12T03:06:11.231+0800 I ACCESS   [conn1537213] Successfully authenticated as principal online on online<br>\n  2017-03-12T03:06:12.289+0800 I NETWORK  [conn1537216] end connection 10.162.xxx.xxx:49427 (86 connections now open)  </p>\n</blockquote>\n\n<h2> 3. Until 8:37 in the morning, slave nodes finally stopped service.</h2>\n\n<blockquote>\n  <p>2017-03-12T08:37:44.764+0800 I NETWORK  [initandlisten] connection accepted from 10.171.xxx.xxx:37444 #1571431 (32306 connections now open)<br>\n  2017-03-12T08:37:44.773+0800 I ACCESS   [conn1571430] Successfully authenticated as principal online on online<br>\n  2017-03-12T08:37:44.786+0800 I NETWORK  [initandlisten] pthread_create failed: errno:11 Resource temporarily unavailable<br>\n  2017-03-12T08:37:44.786+0800 I NETWORK  [initandlisten] can't create new thread, closing connection<br>\n  2017-03-12T08:37:45.290+0800 I NETWORK  [initandlisten] connection accepted from 10.171.xxx.xxx:37445 #1571432 (32306 connections now open)<br>\n  2017-03-12T08:37:45.290+0800 I NETWORK  [initandlisten] pthread_create failed: errno:11 Resource temporarily unavailable<br>\n  2017-03-12T08:37:45.290+0800 I NETWORK  [initandlisten] can't create new thread, closing connection  </p>\n</blockquote>\n\n<h2> 4. Even heartbeat between mongo nodes crashes.</h2>\n\n<blockquote>\n  <p>2017-03-12T08:37:57.000+0800 I REPL     [ReplicationExecutor] Error in heartbeat request to xxx.xxx.xxx.xxx:27017; UnknownError Sending command { replSetHeartbeat: \"rs1\", pv: 1, v: 5, from: \"xxx.xxx.xxx.xxx:27018\", fromId: 1, checkEmpty: false } on database admin over network to xxx.xxx.xxx.xxx:27017 received exception boost::thread_resource_error  </p>\n</blockquote>\n\n<h2> 5. Finally I restarted the 2 mongo slave nodes, and everything goes all right.</h2>\n\n<h2> 6. To recover app service in time, no more on site status with mongo nodes or app servers. Only two more clues as below.</h2>\n\n<ul>\n<li>TCP connections on mongo slave nodes increase rapidly(but again, master node is normal).</li>\n<li>While read operation from app server to mongo slave nodes got i/o timeout(from the beginning 3:02).</li>\n</ul>\n\n<h1>My surmise and investigation</h1>\n\n<h2>- Something wrong with mongodb slave node</h2>\n\n<p>Suppose any bug from mongodb slave nodes stops read operation, which result in app servers' i/o timeout; and app servers consider no connection in pool to slave node is unavailable, so trying to open new connection with slave nodes. But unfortunately connections cannot be established normally, so new connections continued being opened.</p>\n\n<h2>- App servers' mgo driver connection pool leaks.</h2>\n\n<p>But only two sessions are used in each app server. In detail I get the sessions during init() and use them for db read/write operations. I cannot figure out the leak. Here is the code I get the sessions:  </p>\n\n<pre><code>        func init() {  \n          ...some code... \n\n          session, err := mgo.Dial(url)  \n          if err != nil {...handle error...}  \n\n          strongSession = session.Copy()  \n          strongSession.SetMode(mgo.Strong, true)  \n          strongSession.SetSafe(&amp;mgo.Safe{})  \n\n          eventualSession = session  \n          eventualSession.SetMode(mgo.Eventual, true)  \n          eventualSession.SetSafe(&amp;mgo.Safe{})  \n\n          ...some code...  \n        }  \n</code></pre>\n\n<p>If problem is caused by mgo driver's connection pool leak, can I assume some pool management bugs with driver gopkg.in/mgo.v2?</p>\n\n<h1>My confusion</h1>\n\n<p>This problem occurs two times in my live environment, several days ago and two months ago, with the same time period from around 3:00 to 8:30 in the morning.  </p>\n\n<p>I really thought if any tasks at this time on both mongo server and app server, but found nothing.  </p>\n\n<p>I have dug the logs, searched google and stackoverflow for several days by keywords like 'mgo connection pool', 'mongo can't create new thread', 'mongo connection increase' and so on, but unfortunately have no idea on how to investigate this problem further.  </p>\n\n<p>Really appreciate anyone could give some advise~~  </p>\n\n<p>Thanks so much~~  </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 1, "creation_date": 1489462086, "post_id": 42776885, "comment_id": 72669354, "body": "<a href=\"http://stackoverflow.com/questions/41625363/go-constructor-type/41626014#41626014\">This question</a> might be relevant (particularly the additional links)"}], "answers": [{"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1489470312, "post_id": 42777503, "comment_id": 72671545, "body": "See <a href=\"https://commandcenter.blogspot.com/2014/01/self-referential-functions-and-design.html\" rel=\"nofollow noreferrer\">Self-referential functions and the design of options</a> for a fleshed out example of this approach."}, {"owner": {"reputation": 11421, "user_id": 7650, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/052338b3d753f00bb7724f2d2ca060a4?s=128&d=identicon&r=PG", "display_name": "lazy1", "link": "https://stackoverflow.com/users/7650/lazy1"}, "edited": false, "score": 0, "creation_date": 1489477740, "post_id": 42777503, "comment_id": 72674899, "body": "See also &quot;Do not fear first class functions&quot; by Dave Cheney (<a href=\"https://www.youtube.com/watch?v=5buaPyJ0XeQ\" rel=\"nofollow noreferrer\">youtube.com/watch?v=5buaPyJ0XeQ</a>)"}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 1, "last_activity_date": 1489463636, "creation_date": 1489463636, "answer_id": 42777503, "question_id": 42776885, "link": "https://stackoverflow.com/questions/42776885/is-there-a-canonical-way-of-passing-options-to-a-go-function/42777503#42777503", "title": "Is there a canonical way of passing options to a Go function?", "body": "<p>One common way of doing that is to declare the function as variadic so that it accepts zero or more options. Assuming <code>Option</code> is your option type, you would declare it like this:</p>\n\n<pre><code>func Marshal(input interface{}, options ...Option) ([]byte, error)\n</code></pre>\n\n<p>Then, within the function, <code>options</code> has the type <code>[]Option</code>.</p>\n\n<p>The function would then be called with zero or more <code>Option</code> arguments:</p>\n\n<pre><code>bytes, err := Marshal(input, Option1, Option2)\n</code></pre>\n\n<p>Or, if you have your options in a slice, you would call it like this:</p>\n\n<pre><code>bytes, err := Marshal(input, options...)\n</code></pre>\n\n<p>There are several references to this in the <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">language spec</a> (look for \"variadic\").</p>\n"}, {"comments": [{"owner": {"reputation": 4700, "user_id": 1470961, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/28216f158ce772dd67fcee384406b2c9?s=128&d=identicon&r=PG", "display_name": "Elliot Chance", "link": "https://stackoverflow.com/users/1470961/elliot-chance"}, "edited": false, "score": 0, "creation_date": 1489471060, "post_id": 42778034, "comment_id": 72671777, "body": "I think there is a few valid answer (which is why I asked the question in the first place) but I personally prefer this the most. I have posted an answer quite similar which I have settled on."}], "tags": [], "owner": {"reputation": 4669, "user_id": 63814, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/607eab54ab44ecd7ebefa443e1925596?s=128&d=identicon&r=PG", "display_name": "MahlerFive", "link": "https://stackoverflow.com/users/63814/mahlerfive"}, "is_accepted": true, "score": 0, "last_activity_date": 1489467521, "creation_date": 1489467521, "answer_id": 42778034, "question_id": 42776885, "link": "https://stackoverflow.com/questions/42776885/is-there-a-canonical-way-of-passing-options-to-a-go-function/42778034#42778034", "title": "Is there a canonical way of passing options to a Go function?", "body": "<p>You can take a <code>*MarshalOptions</code>. The caller can then pass <code>nil</code> if they want the default behavior.</p>\n\n<p>eg. \n<code>func Marshal(input interface{}, options *MarshalOptions) ([]byte, error)</code></p>\n"}, {"tags": [], "owner": {"reputation": 4700, "user_id": 1470961, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/28216f158ce772dd67fcee384406b2c9?s=128&d=identicon&r=PG", "display_name": "Elliot Chance", "link": "https://stackoverflow.com/users/1470961/elliot-chance"}, "is_accepted": false, "score": 0, "last_activity_date": 1489471331, "creation_date": 1489471331, "answer_id": 42778761, "question_id": 42776885, "link": "https://stackoverflow.com/questions/42776885/is-there-a-canonical-way-of-passing-options-to-a-go-function/42778761#42778761", "title": "Is there a canonical way of passing options to a Go function?", "body": "<p>I found this to the be the best balance between explicit and simplicity:</p>\n\n<pre><code>type MarshalOptions struct {\n    OnlyStdClass bool\n}\n\n// DefaultMarshalOptions will create a new instance of MarshalOptions with\n// sensible defaults. See MarshalOptions for a full description of options.\nfunc DefaultMarshalOptions() *MarshalOptions {\n    options := new(MarshalOptions)\n    options.OnlyStdClass = false\n\n    return options\n}\n\nfunc Marshal(input interface{}, options *MarshalOptions) ([]byte, error) {\n    // ...\n}\n</code></pre>\n\n<p>Using the constructor pattern I can set reasonable defaults, without requiring that every option (especially if they may change) are explicitly set.</p>\n\n<p>It's true that I could accept <code>nil</code>, but I don't because it makes it more explicit to read:</p>\n\n<pre><code>result := Marshal(123, DefaultMarshalOptions())\n</code></pre>\n"}], "owner": {"reputation": 4700, "user_id": 1470961, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/28216f158ce772dd67fcee384406b2c9?s=128&d=identicon&r=PG", "display_name": "Elliot Chance", "link": "https://stackoverflow.com/users/1470961/elliot-chance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 42778034, "answer_count": 3, "score": 1, "last_activity_date": 1489476575, "creation_date": 1489459520, "last_edit_date": 1489476575, "question_id": 42776885, "link": "https://stackoverflow.com/questions/42776885/is-there-a-canonical-way-of-passing-options-to-a-go-function", "title": "Is there a canonical way of passing options to a Go function?", "body": "<p>I am writing a package that exposes this function:</p>\n\n<pre><code>func Marshal(input interface{}) ([]byte, error)\n</code></pre>\n\n<p>This is fine for the majority of situations, but I also want to prove another function if there are extra options:</p>\n\n<pre><code>type MarshalOptions struct {\n    OnlyStdClass bool\n}\n</code></pre>\n\n<p>My first thought is to create another function:</p>\n\n<pre><code>func MarshalWithOptions(input interface{}, options MarshalOptions) ([]byte, error)\n</code></pre>\n\n<p>Is this the recommended way of doing this? Is there a standard naming convention for function that also provide a more specific version with options?</p>\n"}, {"tags": ["json", "go", "encoding", "interface", "set"], "comments": [{"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1489448859, "post_id": 42775388, "comment_id": 72666055, "body": "It looks like you are trying to json serialize a <code>set</code>, but <code>set</code>s are not json serializable."}, {"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "reply_to_user": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1489448950, "post_id": 42775388, "comment_id": 72666088, "body": "Well set is just a map [interface{}]struct{}, I wonder if I can write my own marhsalling/unmarhalling logic to override the standard json serialization."}], "answers": [{"comments": [{"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "edited": false, "score": 0, "creation_date": 1489452119, "post_id": 42775796, "comment_id": 72666984, "body": "Ah, that makes sense. Thanks @mkopriva. I&#39;ll change the key to <code>string</code> from <code>interface{}</code>. Also, thanks for the example."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "edited": false, "score": 0, "creation_date": 1489452832, "post_id": 42775796, "comment_id": 72667170, "body": "If you don&#39;t need the key to be <code>interface{}</code>, and the json you&#39;re receiving is of a format like this <code>{&quot;foo&quot;:{}, &quot;123&quot;:{}}</code>, that is, the values are objects (or <code>null</code>s), then you don&#39;t even have to write your own <code>UnmarhsalJSON</code>/<code>MarshalJSON</code> methods. <a href=\"https://play.golang.org/p/hgJI6curQu\" rel=\"nofollow noreferrer\">play.golang.org/p/hgJI6curQu</a>"}, {"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "edited": false, "score": 0, "creation_date": 1489453880, "post_id": 42775796, "comment_id": 72667420, "body": "Makes sense. I converted the key to be of type <code>string</code> and it works like a charm. Thanks again @mkopriva."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1489451045, "creation_date": 1489451045, "answer_id": 42775796, "question_id": 42775388, "link": "https://stackoverflow.com/questions/42775388/encode-set-data-structure-in-golang/42775796#42775796", "title": "Encode Set data structure in Golang", "body": "<p>You could write your own <code>UnmarshalJSON</code> method on the <code>*Set</code> type which would then be used by the <code>json.Encoder</code> to encode the json data into the <code>Set</code>. Here's a simple example <a href=\"https://play.golang.org/p/kx1E-jDu5e\" rel=\"nofollow noreferrer\">https://play.golang.org/p/kx1E-jDu5e</a>.</p>\n\n<p>By the way, the reason you're getting the error is because a map key of type <code>interface{}</code> is not supported by the <code>encoding/json</code> package. (<a href=\"https://github.com/golang/go/blob/master/src/encoding/json/encode.go#L697-L699\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/master/src/encoding/json/encode.go#L697-L699</a>)</p>\n"}], "owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "accepted_answer_id": 42775796, "answer_count": 1, "score": 1, "last_activity_date": 1489451045, "creation_date": 1489448490, "question_id": 42775388, "link": "https://stackoverflow.com/questions/42775388/encode-set-data-structure-in-golang", "title": "Encode Set data structure in Golang", "body": "<p>I have a Set data structure implemented in Go with the basic operations like Add, Remove, Difference, Union. I am trying to send a http request using the json encoder to encode the request body which contains the object of the form <code>map[string]Set</code>. The Set data structure is defined below:</p>\n\n<pre><code>type Set map[interface{}]struct{}\n\nfunc NewSet() Set {\n    set := make(Set)\n    return set\n}\n</code></pre>\n\n<p>The encoder looks like this:</p>\n\n<pre><code>func (req *Request) BodyContentInJson (val interface{}) error {\n    buf := bytes.NewBuffer(nil)\n    enc := json.NewEncoder(buf)\n\n    if err := enc.Encode(val); err != nil {\n        return err\n    }\n\n    req.Obj = val\n    req.Body = buf\n    req.BodySize = int64(buf.Len())\n    return nil\n}\n</code></pre>\n\n<p>This code fails at </p>\n\n<pre><code>if err := enc.Encode(val); err != nil {\n            return err\n        }\n</code></pre>\n\n<p>giving an error:<code>{\"errors\":[\"json: unsupported type: Set\"]}</code>. Also, the type of <code>val</code> is <code>map[string]interface{}</code>when I debugged it. </p>\n\n<p>How could I possibly encode and marshal/unmarshal JSON content here using the Go's encoder ?</p>\n"}, {"tags": ["testing", "go", "mocking"], "answers": [{"tags": [], "owner": {"reputation": 8269, "user_id": 588734, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/o3CVI.jpg?s=128&g=1", "display_name": "Eamonn McEvoy", "link": "https://stackoverflow.com/users/588734/eamonn-mcevoy"}, "is_accepted": true, "score": 1, "last_activity_date": 1489462011, "creation_date": 1489462011, "answer_id": 42777261, "question_id": 42775292, "link": "https://stackoverflow.com/questions/42775292/methods-for-interface-mocking-in-go/42777261#42777261", "title": "methods for interface mocking in go", "body": "<p>I would call my handlers from a struct like so:</p>\n\n<pre><code>type Handlers struct {\n    mailer *Mailer\n}\n\nfunc(h *Handlers) GetOrCreateUser(w http.ResponseWriter, r *http.Request) {\n    user := GetUserFromContext(r.Context())\n    if created :=user.GetOrCreate(); created {\n        h.mailer.SendEmail(...)\n        return\n    } else {\n        w.Write([]byte(\"Hello User!\"))\n    }\n}\n</code></pre>\n\n<p>This way you can instansiate the struct with the implementation of <code>Mailer</code> you want to use.</p>\n\n<pre><code>m := mailer.New() // assuming this returns a new mailer\nh := Handlers{&amp;m}\n\nr := httprouter.New()\nr.GET(\"/mailer\", h.HandlerWithMailer)\n</code></pre>\n\n<p>and in your tests</p>\n\n<pre><code>m := mockMailer.New() // assuming this returns a new mailer\nh := Handlers{&amp;m}\n\nr := httprouter.New()\nr.GET(\"/mailer\", h.HandlerWithMailer)\n</code></pre>\n"}], "owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 42777261, "answer_count": 1, "score": 0, "last_activity_date": 1489527309, "creation_date": 1489448011, "last_edit_date": 1489527309, "question_id": 42775292, "link": "https://stackoverflow.com/questions/42775292/methods-for-interface-mocking-in-go", "title": "methods for interface mocking in go", "body": "<p>If I have a handlerfunc like the one below. What is the best way to \"mock\" or inject a interface that wraps some object for testing?</p>\n\n<pre><code>func GetOrCreateUser(w http.ResponseWriter, r *http.Request) {\n    user := GetUserFromContext(r.Context())\n    if created :=user.GetOrCreate(); created {\n        smtp.SendEmail(...)\n        return\n    } else {\n        w.Write([]byte(\"Hello User!\"))\n    }\n}\n</code></pre>\n\n<p>The only way that I have come by seems to be to do this:</p>\n\n<pre><code>type Mailer interface { SendMail() }\n\nfunc HandlerWithMailer(m Mailer) http.handlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        user := GetUserFromContext(r.Context())\n        if created := user.GetOrCreate(); created {\n            m.SendEmail(...)\n            return\n        } else {                \n            w.Write([]byte(\"Hello User!\"))\n        }\n    }\n}\n</code></pre>\n\n<p>Then calling the mailer like this in the router (using httprouter):</p>\n\n<pre><code>m := mailer.New() // assuming this returns a new mailer\nr := httprouter.New()\nr.GET(\"/mailer\", HandlerWithMailer(m))\n</code></pre>\n\n<p>Which could then be tested by making a struct that implements the interface and returns whatever I want, which can be called in the tests. I know this works, but I am wondering if this is the preferred method of testing in Go and if there is any other way to go about accomplishing this.</p>\n"}, {"tags": ["sql", "json", "go", "web-applications", "struct"], "comments": [{"owner": {"reputation": 459, "user_id": 832169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4796962174e609c97d50ad2f705b394?s=128&d=identicon&r=PG", "display_name": "Steve101", "link": "https://stackoverflow.com/users/832169/steve101"}, "edited": false, "score": 1, "creation_date": 1489444547, "post_id": 42774467, "comment_id": 72664651, "body": "To confirm; you want to build the struct from the query response, automatically turn it into JSON and return it to the client?"}, {"owner": {"reputation": 341, "user_id": 5534440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6y7O1.jpg?s=128&g=1", "display_name": "Jadefox10200", "link": "https://stackoverflow.com/users/5534440/jadefox10200"}, "reply_to_user": {"reputation": 459, "user_id": 832169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4796962174e609c97d50ad2f705b394?s=128&d=identicon&r=PG", "display_name": "Steve101", "link": "https://stackoverflow.com/users/832169/steve101"}, "edited": false, "score": 0, "creation_date": 1489455173, "post_id": 42774467, "comment_id": 72667718, "body": "Yes. I was thinking I could use the rows.ColumnTypes and rows.Columns but didn&#39;t know how to create this into a struct dynamically that would then also do the type checking for type assertion."}], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 5534440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6y7O1.jpg?s=128&g=1", "display_name": "Jadefox10200", "link": "https://stackoverflow.com/users/5534440/jadefox10200"}, "edited": false, "score": 0, "creation_date": 1489514623, "post_id": 42774776, "comment_id": 72701279, "body": "I appreciate your input. This doesn&#39;t really solve my problem but I will check into the link you gave on code generation."}], "tags": [], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "is_accepted": false, "score": 0, "last_activity_date": 1489445720, "last_edit_date": 1489445720, "creation_date": 1489444981, "answer_id": 42774776, "question_id": 42774467, "link": "https://stackoverflow.com/questions/42774467/how-to-convert-sql-rows-to-typed-json-in-golang/42774776#42774776", "title": "How to convert *sql.Rows to typed JSON in Golang", "body": "<p>I think the best option you have is to use <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\">json</a> library from golang</p>\n\n<pre><code>import \"encoding/json\"\n\ntype JSONData struct {\n  Values []float64 `json:\"Values\"`\n  Dates []string `json:\"Dates\"`\n}\n</code></pre>\n\n<p>I don't think there is a good way to do this dynamically, since golang has no way of matching up the database column name and the output'd json Also as a side note I usually write the db querying code by sending the type directly to the db library </p>\n\n<pre><code>var tempDate string \nvar tempValue float64\nerr := rows.Scan(&amp;tempDate, &amp;tempValue)\nif err != nil {\n       return err\n}\n</code></pre>\n\n<p>If you really want to do this automatically you can look into golang <a href=\"https://blog.golang.org/generate\" rel=\"nofollow noreferrer\">code generation</a>.  </p>\n"}, {"comments": [{"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 1, "creation_date": 1538251798, "post_id": 42798904, "comment_id": 92080756, "body": "This isn&#39;t really a good solution because it converts everything to a string, and then opportunistically converts things back to JSON types. It will trick you into thinking everything works but as soon as a user puts in their name as &quot;true&quot; or their house name as &quot;32&quot; it will break."}, {"owner": {"user_type": "does_not_exist", "display_name": "user12849275"}, "edited": false, "score": 0, "creation_date": 1582596285, "post_id": 42798904, "comment_id": 106823498, "body": "this seems like a safer solution: <a href=\"https://stackoverflow.com/a/60386531/12849275\">stackoverflow.com/a/60386531/12849275</a>"}], "tags": [], "owner": {"reputation": 341, "user_id": 5534440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6y7O1.jpg?s=128&g=1", "display_name": "Jadefox10200", "link": "https://stackoverflow.com/users/5534440/jadefox10200"}, "is_accepted": true, "score": 14, "last_activity_date": 1489536815, "creation_date": 1489536815, "answer_id": 42798904, "question_id": 42774467, "link": "https://stackoverflow.com/questions/42774467/how-to-convert-sql-rows-to-typed-json-in-golang/42798904#42798904", "title": "How to convert *sql.Rows to typed JSON in Golang", "body": "<p>This is the best implementation that I was able to come up with that would make it dynamic. It is also significantly shorter than my original. As I've seen this type of question quite a bit, I hope this helps others. I am open to other answers that have a better implementation of this: </p>\n\n<pre><code>func (d *DbDao) makeStructJSON(queryText string, w http.ResponseWriter) error {\n\n    // returns rows *sql.Rows\n    rows, err := d.db.Query(queryText)\n    if err != nil {\n        return err\n    }\n    columns, err := rows.Columns()\n    if err != nil {\n        return err\n    }\n\n    count := len(columns)\n    values := make([]interface{}, count)\n    scanArgs := make([]interface{}, count)\n    for i := range values {\n        scanArgs[i] = &amp;values[i]\n    }\n\n    masterData := make(map[string][]interface{})\n\n    for rows.Next() {\n        err := rows.Scan(scanArgs...)\n        if err != nil {\n            return err\n        }\n        for i, v := range values {\n\n            x := v.([]byte)\n\n            //NOTE: FROM THE GO BLOG: JSON and GO - 25 Jan 2011:\n            // The json package uses map[string]interface{} and []interface{} values to store arbitrary JSON objects and arrays; it will happily unmarshal any valid JSON blob into a plain interface{} value. The default concrete Go types are:\n            //\n            // bool for JSON booleans,\n            // float64 for JSON numbers,\n            // string for JSON strings, and\n            // nil for JSON null.\n\n            if nx, ok := strconv.ParseFloat(string(x), 64); ok == nil {\n                masterData[columns[i]] = append(masterData[columns[i]], nx)\n            } else if b, ok := strconv.ParseBool(string(x)); ok == nil {\n                masterData[columns[i]] = append(masterData[columns[i]], b)\n            } else if \"string\" == fmt.Sprintf(\"%T\", string(x)) {\n                masterData[columns[i]] = append(masterData[columns[i]], string(x))\n            } else {\n                fmt.Printf(\"Failed on if for type %T of %v\\n\", x, x)\n            }\n\n        }\n    }\n\n    w.Header().Set(\"Content-Type\", \"application/json\")\n\n    err = json.NewEncoder(w).Encode(masterData)\n\n    if err != nil {\n        return err\n    }\n    return err\n}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12849275"}, "edited": false, "score": 0, "creation_date": 1582596270, "post_id": 52572145, "comment_id": 106823490, "body": "what about this way? <a href=\"https://stackoverflow.com/a/60386531/12849275\">stackoverflow.com/a/60386531/12849275</a>"}], "tags": [], "owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "is_accepted": false, "score": 10, "last_activity_date": 1540990852, "last_edit_date": 1540990852, "creation_date": 1538251717, "answer_id": 52572145, "question_id": 42774467, "link": "https://stackoverflow.com/questions/42774467/how-to-convert-sql-rows-to-typed-json-in-golang/52572145#52572145", "title": "How to convert *sql.Rows to typed JSON in Golang", "body": "<p>Here is a better solution, using reflection. It handles types correctly (e.g. a string value of <code>true</code> won't erroneously be turned into a bool and so on.</p>\n\n<p>It also handles possibly-null types (only tested with MySQL - you will probably need to modify it for other drivers).</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"encoding/json\"\n    \"fmt\"\n    \"reflect\"\n\n    \"github.com/go-sql-driver/mysql\"\n)\n\n// Additional scan types returned by the MySQL driver. I haven't looked at\n// what PostgreSQL does.\n\ntype jsonNullInt64 struct {\n    sql.NullInt64\n}\n\nfunc (v jsonNullInt64) MarshalJSON() ([]byte, error) {\n    if !v.Valid {\n        return json.Marshal(nil)\n    }\n    return json.Marshal(v.Int64)\n}\n\ntype jsonNullFloat64 struct {\n    sql.NullFloat64\n}\n\nfunc (v jsonNullFloat64) MarshalJSON() ([]byte, error) {\n    if !v.Valid {\n        return json.Marshal(nil)\n    }\n    return json.Marshal(v.Float64)\n}\n\ntype jsonNullTime struct {\n    mysql.NullTime\n}\n\nfunc (v jsonNullTime) MarshalJSON() ([]byte, error) {\n    if !v.Valid {\n        return json.Marshal(nil)\n    }\n    return json.Marshal(v.Time)\n}\n\nvar jsonNullInt64Type = reflect.TypeOf(jsonNullInt64{})\nvar jsonNullFloat64Type = reflect.TypeOf(jsonNullFloat64{})\nvar jsonNullTimeType = reflect.TypeOf(jsonNullTime{})\nvar nullInt64Type = reflect.TypeOf(sql.NullInt64{})\nvar nullFloat64Type = reflect.TypeOf(sql.NullFloat64{})\nvar nullTimeType = reflect.TypeOf(mysql.NullTime{})\n\n// SQLToJSON takes an SQL result and converts it to a nice JSON form. It also\n// handles possibly-null values nicely. See https://stackoverflow.com/a/52572145/265521\nfunc SQLToJSON(rows *sql.Rows) ([]byte, error) {\n    columns, err := rows.Columns()\n    if err != nil {\n        return nil, fmt.Errorf(\"Column error: %v\", err)\n    }\n\n    tt, err := rows.ColumnTypes()\n    if err != nil {\n        return nil, fmt.Errorf(\"Column type error: %v\", err)\n    }\n\n    types := make([]reflect.Type, len(tt))\n    for i, tp := range tt {\n        st := tp.ScanType()\n        if st == nil {\n            return nil, fmt.Errorf(\"Scantype is null for column: %v\", err)\n        }\n        switch st {\n        case nullInt64Type:\n            types[i] = jsonNullInt64Type\n        case nullFloat64Type:\n            types[i] = jsonNullFloat64Type\n        case nullTimeType:\n            types[i] = jsonNullTimeType\n        default:\n            types[i] = st\n        }\n    }\n\n    values := make([]interface{}, len(tt))\n    data := make(map[string][]interface{})\n\n    for rows.Next() {\n        for i := range values {\n            values[i] = reflect.New(types[i]).Interface()\n        }\n        err = rows.Scan(values...)\n        if err != nil {\n            return nil, fmt.Errorf(\"Failed to scan values: %v\", err)\n        }\n        for i, v := range values {\n            data[columns[i]] = append(data[columns[i]], v)\n        }\n    }\n\n    return json.Marshal(data)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 341, "user_id": 5534440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6y7O1.jpg?s=128&g=1", "display_name": "Jadefox10200", "link": "https://stackoverflow.com/users/5534440/jadefox10200"}, "edited": false, "score": 0, "creation_date": 1582695996, "post_id": 60386531, "comment_id": 106861774, "body": "I agree. Thanks for the post. In 2017 the ColumnTypes() wasn&#39;t in the golang library so this makes it much cleaner."}, {"owner": {"user_type": "does_not_exist", "display_name": "user12834955"}, "edited": false, "score": 0, "creation_date": 1582703451, "post_id": 60386531, "comment_id": 106864310, "body": "for sure, this isn&#39;t 100% complete it terms of all the case statements since there are lot more column types not covered, but it&#39;s 80% of the way there."}, {"owner": {"reputation": 1735, "user_id": 4903843, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9o6SR.jpg?s=128&g=1", "display_name": "Nilay Singh", "link": "https://stackoverflow.com/users/4903843/nilay-singh"}, "edited": false, "score": 0, "creation_date": 1604338200, "post_id": 60386531, "comment_id": 114311362, "body": "This solution is much better almost perfect"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user12849275"}, "is_accepted": false, "score": 7, "last_activity_date": 1582654398, "last_edit_date": 1582654398, "creation_date": 1582596252, "answer_id": 60386531, "question_id": 42774467, "link": "https://stackoverflow.com/questions/42774467/how-to-convert-sql-rows-to-typed-json-in-golang/60386531#60386531", "title": "How to convert *sql.Rows to typed JSON in Golang", "body": "<p>This is a much better way to do it (Tested with Postgres). No reflect/reflection needed:</p>\n\n<pre><code>    columnTypes, err := rows.ColumnTypes()\n\n    if err != nil {\n        return err\n    }\n\n    count := len(columnTypes)\n    finalRows := []interface{}{};\n\n    for rows.Next() {\n\n        scanArgs := make([]interface{}, count)\n\n        for i, v := range columnTypes {\n\n            switch v.DatabaseTypeName() {\n            case \"VARCHAR\", \"TEXT\", \"UUID\", \"TIMESTAMP\":\n                scanArgs[i] = new(sql.NullString)\n                break;\n            case \"BOOL\":\n                scanArgs[i] = new(sql.NullBool)\n                break;\n            case \"INT4\":\n                scanArgs[i] = new(sql.NullInt64)\n                break;\n            default:\n                scanArgs[i] = new(sql.NullString)\n            }\n        }\n\n        err := rows.Scan(scanArgs...)\n\n        if err != nil {\n            return err\n        }\n\n        masterData := map[string]interface{}{}\n\n        for i, v := range columnTypes {\n\n            if z, ok := (scanArgs[i]).(*sql.NullBool); ok  {\n                masterData[v.Name()] = z.Bool\n                continue;\n            }\n\n            if z, ok := (scanArgs[i]).(*sql.NullString); ok  {\n                masterData[v.Name()] = z.String\n                continue;\n            }\n\n            if z, ok := (scanArgs[i]).(*sql.NullInt64); ok  {\n                masterData[v.Name()] = z.Int64\n                continue;\n            }\n\n            if z, ok := (scanArgs[i]).(*sql.NullFloat64); ok  {\n                masterData[v.Name()] = z.Float64\n                continue;\n            }\n\n            if z, ok := (scanArgs[i]).(*sql.NullInt32); ok  {\n                masterData[v.Name()] = z.Int32\n                continue;\n            }\n\n            masterData[v.Name()] = scanArgs[i]\n        }\n\n        finalRows = append(finalRows, masterData)\n    }\n\n\n    z, err := json.Marshal(finalRows)\n</code></pre>\n"}], "owner": {"reputation": 341, "user_id": 5534440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6y7O1.jpg?s=128&g=1", "display_name": "Jadefox10200", "link": "https://stackoverflow.com/users/5534440/jadefox10200"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15507, "favorite_count": 5, "accepted_answer_id": 42798904, "answer_count": 4, "score": 7, "last_activity_date": 1582654398, "creation_date": 1489443566, "last_edit_date": 1568196956, "question_id": 42774467, "link": "https://stackoverflow.com/questions/42774467/how-to-convert-sql-rows-to-typed-json-in-golang", "title": "How to convert *sql.Rows to typed JSON in Golang", "body": "<p>Essentially, I am trying to run a query on a MySQL database, get the data made converted into JSON and sent back to the client. I have tried several methods and all of the \"easy\" ones result in sending back all of the JSON as a string. I need this to be send back as a key (<code>string</code>) with <code>[]float64</code> value. This way I have an array of data associated with a key. Also, this needs to have a type. The best method I've found so far to accomplish this was to build put all of the data into a struct, encode it and send that back to the <code>ResponseWriter</code>.</p>\n\n<p>I have seen several questions on making JSON from a database but I haven't found anything utilizing the struct method. I wrote the below code into a single function to illustrate my question. This is VERY limited in that it will only handle two fields and it MUST be a <code>float64</code>. </p>\n\n<p>Therefore, my question is: How do I create this JSON from a query response that has the correct type before sending this back to the client and is there a way to do this dynamically (ie, can accept a variable number of columns and unknown types)?:</p>\n\n<pre><code>{ \"Values\":[12.54, 76.98, 34.90], \"Dates\": [\"2017-02-03\", \"2017-02-04:, \"2017-02-05\"]}\n</code></pre>\n\n<pre><code>\n\n    type DbDao struct{\n      db *sql.DB\n    }\n\n    type JSONData struct {\n      Values []float64\n      Dates []string\n    }\n\n\n    func (d *DbDao) SendJSON(sqlString string, w http.ResponseWriter) (error) {\n\n      stmt, err := d.db.Prepare(sqlString)\n      if err != nil {\n        return err\n      }\n      defer stmt.Close()\n\n      rows, err := stmt.Query()\n      if err != nil {\n        return err\n      }\n      defer rows.Close()\n\n      values := make([]interface{}, 2)\n      scanArgs := make([]interface{}, 2)\n      for i := range values {\n        scanArgs[i] = &values[i]\n      }\n\n      for rows.Next() {\n        err := rows.Scan(scanArgs...)\n        if err != nil {\n          return err\n        }\n\n        var tempDate string \n        var tempValue float64\n        var myjson JSONData\n\n        d, dok := values[0].([]byte)\n        v, vok := values[1].(float64)\n\n        if dok {\n          tempDate = string(d)\n          if err != nil {\n            return err\n          }\n          myjson.Dates = append(myjson.Dates, tempDate)\n        }\n\n        if vok {      \n          tempValue = v \n          myjson.Values = append(myjson.Values, tempValue)\n          fmt.Println(v)\n          fmt.Println(tempValue)\n\n        }    \n\n        err = json.NewEncoder(w).Encode(&myjson)\n        if err != nil {\n          return err\n        }\n      }\n\n      return nil \n    }\n\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1489441675, "post_id": 42773933, "comment_id": 72663434, "body": "thanks. for error 2 I instead change the method signature, removed pointer from speak. <a href=\"https://play.golang.org/p/1fQNj6rrsd\" rel=\"nofollow noreferrer\">play.golang.org/p/1fQNj6rrsd</a> is it possible to have the method this way"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1489441707, "post_id": 42773933, "comment_id": 72663450, "body": "Sure, there&#39;s no reason that can&#39;t work just as well.:)"}, {"owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1489441863, "post_id": 42773933, "comment_id": 72663525, "body": "sorry didn&#39;t get you, it didn&#39;t work, <a href=\"https://play.golang.org/p/1fQNj6rrsd\" rel=\"nofollow noreferrer\">play.golang.org/p/1fQNj6rrsd</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 2, "creation_date": 1489441985, "post_id": 42773933, "comment_id": 72663579, "body": "<code>var cat IAnimal = &amp;Cat{}</code> &lt;-- You&#39;re still setting <code>IAnimal</code> to a pointer, then trying to assert it as a non-pointer. You need to be consistent throughout."}, {"owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1489442329, "post_id": 42773933, "comment_id": 72663746, "body": "i see, so if i save pointer, i can only get back pointer, i can&#39;t get back actual object?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1489475326, "post_id": 42773933, "comment_id": 72673584, "body": "You can, but you have to dereference it with <code>*</code>. <code>Cat = *CatPtr</code>"}, {"owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1489476866, "post_id": 42773933, "comment_id": 72674435, "body": "hmmm possible to see some playground code from my example, I still didn&#39;t get this last part."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 19, "last_activity_date": 1489441286, "creation_date": 1489441286, "answer_id": 42773933, "question_id": 42773848, "link": "https://stackoverflow.com/questions/42773848/impossible-type-assertions-with-casting-from-interface-type-to-the-actual-type/42773933#42773933", "title": "Impossible type assertions with casting from interface type to the actual type", "body": "<ol>\n<li><p>The error message pretty much says it all:</p>\n\n<pre><code>tmp/sandbox129360726/main.go:42: impossible type assertion:\n    Cat does not implement IAnimal (Speak method has pointer receiver)\n</code></pre>\n\n<p><code>Cat</code> does not implement <code>IAnimal</code>, because <code>Speak</code> (part of the <code>IAnimal</code> interface) has a pointer receiver, and <code>Cat</code> is not a pointer.</p>\n\n<p>If you change <code>Cat</code> to <code>*Cat</code>, it works:</p>\n\n<pre><code>var same_cat *Cat = zoo.GetAnimal().(*Cat)\n</code></pre></li>\n<li><p>The error pretty much says it all, too.</p>\n\n<pre><code> append(zoo.animals, cat)\n</code></pre>\n\n<p>You're appending <code>cat</code> to <code>zoo.animals</code> (evaluating), then throwing away the result, because there's nothing on the left side.  You probably want to do this instead:</p>\n\n<pre><code>zoo.animals = append(zoo.animals, cat)\n</code></pre></li>\n</ol>\n\n<p>One other side note: When you're assigning to a variable directly, there's no need to specify the type, because Go can determine it for you.  Therefore</p>\n\n<pre><code>var same_cat Cat = zoo.GetAnimal().(Cat)\n</code></pre>\n\n<p>would be better expressed as:</p>\n\n<pre><code>var same_cat = zoo.GetAnimal().(Cat)\n</code></pre>\n\n<p>or also:</p>\n\n<pre><code>same_cat := zoo.GetAnimal().(Cat)\n</code></pre>\n"}], "owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5022, "favorite_count": 1, "accepted_answer_id": 42773933, "answer_count": 1, "score": 11, "last_activity_date": 1489441286, "creation_date": 1489440948, "question_id": 42773848, "link": "https://stackoverflow.com/questions/42773848/impossible-type-assertions-with-casting-from-interface-type-to-the-actual-type", "title": "Impossible type assertions with casting from interface type to the actual type", "body": "<p>I'm getting two errors, </p>\n\n<p>a. Impossible Type assertion. Can we cast from interface type to the actual type object </p>\n\n<p>b. not sure what's the meaning of evaluated but not used</p>\n\n<pre><code>type IAnimal interface {\n    Speak()\n}\ntype Cat struct{}\n\nfunc (c *Cat) Speak() {\n    fmt.Println(\"meow\")\n}\n\n\n\ntype IZoo interface {\n    GetAnimal() IAnimal\n}\ntype Zoo struct {\n    animals []IAnimal\n}\nfunc (z *Zoo) GetAnimal() IAnimal {\n    return z.animals[0]\n}\n</code></pre>\n\n<p>Testing</p>\n\n<pre><code>var zoo Zoo = Zoo{}\n\n// add a cat\nvar cat IAnimal = &amp;Cat{}\nappend(zoo.animals, cat) // error 1: append(zoo.animals, cat) evaluated but not used\n\n// get the cat\n\nvar same_cat Cat = zoo.GetAnimal().(Cat) // error 2: impossible type assertions\n\nfmt.Println(same_cat)\n</code></pre>\n\n<p>go <a href=\"https://play.golang.org/p/qhJ49pf1sU\" rel=\"noreferrer\">Playground</a></p>\n"}, {"tags": ["macos", "qt", "go", "qml", "static-libraries"], "comments": [{"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "edited": false, "score": 0, "creation_date": 1489457740, "post_id": 42773416, "comment_id": 72668323, "body": "You need a static Qt build. Get the source, configure and build."}, {"owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "reply_to_user": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "edited": false, "score": 0, "creation_date": 1489511915, "post_id": 42773416, "comment_id": 72699485, "body": "Isn&#39;t that what I&#39;ve done with: <code>&#47;Users&#47;$USER&#47;Qt&#47;5.7.0_static_osx&#47;lib</code> described above? I thought that was the static Qt build (that I then followed the build instructions for)"}], "owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489439134, "creation_date": 1489439134, "question_id": 42773416, "link": "https://stackoverflow.com/questions/42773416/osx-go-lang-qml-static-compile-failing-due-to-version-difference", "title": "OSX go (lang) QML static compile failing due to version difference", "body": "<p>I am trying to statically compile a go application using Qt and run it on a computer without Go or Qt installed.</p>\n\n<p>At the top of my main.go I have:</p>\n\n<pre><code>// #cgo LDFLAGS: -static -L/Users/$USER/Qt/5.7.0_static_osx/lib -lgb\n//go:generate genqrc ui\n</code></pre>\n\n<p>I have static compiled my application using:</p>\n\n<pre><code>go generate &amp;&amp; go build -a -installsuffix cgo\n</code></pre>\n\n<p>The <code>go generate</code> compiles the .qml files into the binary while as I understand it <code>go build -a -installsuffix cgo</code> statically compiles all the <code>.go</code> and <code>.a</code> files from Qt.</p>\n\n<p>I am using <code>go version go1.8 darwin/amd64</code> and I have <code>5.7.0_static_osx</code> Qt in my <code>/Users/$USER/Qt</code> folder and in the <code>/lib</code> folder I have all the <code>.a</code> files</p>\n\n<p>I am using OSX 10.11.6 (El Capitan)</p>\n\n<p>Now the issue is when I move it to another mac I get the error: </p>\n\n<pre><code>\u200b/Users/$USER/Downloads/PACKAGED.app/Contents/Resources\nAppSettings.plist\nMainMenu.nib\nappIcon.icns\nPACKAGEDAPP\nscript\ndyld: Library not loaded: /usr/local/opt/qt5/lib/QtWidgets.framework/Versions/5/QtWidgets\n  Referenced from: /Users/$USER/Downloads/PACKAGED.app/Contents/Resources/./encryptoclient\n  Reason: Incompatible library version: encryptoclient requires version 5.7.0 or later, but QtWidgets provides version 5.4.0\n/Users/$USER/Downloads/PACKAGED.app/Contents/Resources/script: line 5:  9987 Trace/BPT trap: 5       ./encryptoclient\n</code></pre>\n\n<p>Which makes me think that Qt wasn't statically compiled, is this so? And if so, what do I need to do to compile properly?</p>\n\n<p>P.S (FYI) Its in a <code>.app</code> because I have wrapped it in a <a href=\"http://sveinbjorn.org/platypus\" rel=\"nofollow noreferrer\">Platypus</a> app to make moving and running on other computer an easy 'double-click' off the USB stick</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 0, "creation_date": 1489435735, "post_id": 42772371, "comment_id": 72660484, "body": "Just a thought from a different angle:  Are you sure there is no way to control or force the port that the aetest framework uses?    That seems like it would be easiest approach in my mind."}, {"owner": {"reputation": 71, "user_id": 7705046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f6e1961a908ca40336de8d8cd8a837?s=128&d=identicon&r=PG&f=1", "display_name": "Shaunak Godbole", "link": "https://stackoverflow.com/users/7705046/shaunak-godbole"}, "reply_to_user": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 0, "creation_date": 1489525053, "post_id": 42772371, "comment_id": 72707491, "body": "Yes, that approach came to mind.  The problem is that I would be repeating a lot of what aetest already does like: figuring out unused-ips, starting up server as a subprocess, rerouting and capturing logs to figure out server startup.  I was hoping to avoid all of this if possible.   It is silly that aetest does not expose this externally for people to reuse. :-("}, {"owner": {"reputation": 559, "user_id": 265767, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/4cc3470aa2b9554612ea406ae169be2c?s=128&d=identicon&r=PG", "display_name": "user265767", "link": "https://stackoverflow.com/users/265767/user265767"}, "edited": false, "score": 1, "creation_date": 1503342635, "post_id": 42772371, "comment_id": 78565965, "body": "Any solution to this problem?"}], "owner": {"reputation": 71, "user_id": 7705046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f6e1961a908ca40336de8d8cd8a837?s=128&d=identicon&r=PG&f=1", "display_name": "Shaunak Godbole", "link": "https://stackoverflow.com/users/7705046/shaunak-godbole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1489435144, "creation_date": 1489435144, "question_id": 42772371, "link": "https://stackoverflow.com/questions/42772371/accessing-app-engine-dev-server-through-unit-tests", "title": "Accessing App Engine Dev server through unit tests", "body": "<p>I'm trying to write a simple integration test that spins up a dev appengine server and an HTTP Client that queries the spun up server.  Here is the code snippet:</p>\n\n<pre><code>inst, err := aetest.NewInstance(nil)\ncheck(err)\ndefer inst.Close()\n\nvar req http.Request \nreq, err = inst.NewRequest(\"GET\", \"/my/endpoint\", nil)\ncheck(err)\n\nctx := appengine.NewContex(req)\nclient := urlfetch.Client(ctx)\n_, err = client.Do(req)\ncheck(err)\n</code></pre>\n\n<p>This code snippet returns an error on the line client.Do.  From what I've debugged, this is because the request's URL only contains \"/my/endpoint\" and not the entire localhost:port information.  In this particular case I cannot use the hardcoded port 8080 because the aetest framework starts the test on the first ununsed port it can find.</p>\n\n<p>Is there a way to programmatically determine the host:port information of the appengine server that was started by aetest framework?</p>\n"}, {"tags": ["encryption", "go"], "comments": [{"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 0, "creation_date": 1489435034, "post_id": 42772215, "comment_id": 72660108, "body": "Where did you find this example?"}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1489435071, "post_id": 42772215, "comment_id": 72660138, "body": "Add the code to the question."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1489435111, "post_id": 42772215, "comment_id": 72660158, "body": "You literally wrote in your code that it&#39;s common to include the IV in the ciphertext, but you don&#39;t include it in the ciphertext. The As are base64 encoded 0s"}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1489435317, "post_id": 42772215, "comment_id": 72660260, "body": "This is a good example of where when dealing with bytes, not strings, a hexadecimal encoding is much more useful: <code>0000000000000000000000000000000026E0941B5D807DDA8D7D6382439A&zwnj;&#8203;540B056320F14512</code>"}], "answers": [{"comments": [{"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 1, "creation_date": 1489435420, "post_id": 42772430, "comment_id": 72660298, "body": "Yes, the IV should be random for each encryption. Also CFB mode is not a frequent mode choice."}, {"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 0, "creation_date": 1489435505, "post_id": 42772430, "comment_id": 72660350, "body": "In some Ciphers IV is IV : {0,1}^m of a fixed length defines blocks length where x = x1 || x2 || .. || xm and |xi| = m. In some ciphers IV has just value 0, so,  {0}^m."}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1489435525, "post_id": 42772430, "comment_id": 72660366, "body": "The only issue with GCM mode is that is is still not common across platforms, other than that is is a great choice."}], "tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": 3, "last_activity_date": 1489521148, "last_edit_date": 1489521148, "creation_date": 1489435331, "answer_id": 42772430, "question_id": 42772215, "link": "https://stackoverflow.com/questions/42772215/golang-encryption-ciphertext-has-padding-of-as-in-the-beginning/42772430#42772430", "title": "Golang encryption ciphertext has padding of As in the beginning", "body": "<p>See this example for golang aes encryption, if you don't need to use AES CFB specifically you could just swap out your encrypt function and use GCM instead. <strong><em>TL;DR- Copy &amp; paste your crypto code from this link instead of Stack Overflow.</em></strong></p>\n\n<p><a href=\"https://github.com/gtank/cryptopasta/blob/master/encrypt.go\" rel=\"nofollow noreferrer\">https://github.com/gtank/cryptopasta/blob/master/encrypt.go</a></p>\n\n<p>If you're just learning watch the associated talk and read the code linked, if you're actually encrypting with this, use the linked code.</p>\n\n<ul>\n<li><a href=\"https://golangnews.com/stories/1469-video-crypto-for-go-developers-gophercon-crypto\" rel=\"nofollow noreferrer\">Video on Go crypto</a></li>\n<li><a href=\"https://github.com/gtank/cryptopasta\" rel=\"nofollow noreferrer\">Repo with vetted crypto examples</a></li>\n</ul>\n\n<p>PS I'm no expert but your iv should be random each time shouldn't it? To fix your code above you need to copy the iv/nonce in with something like:</p>\n\n<p>copy(ciphertext[:aes.BlockSize], iv[:])</p>\n\n<p>the idea is the unique random nonce is at the start of ciphertext, and used to decrypt (so commonIV shouldn't exist) this stops it producing the same output for the same cleartext. Note how your code when fixed produces the same output each time - that's bad.</p>\n\n<p>But <strong>please</strong>, don't use advice from people on stack overflow for crypto, and certainly not from me, see the links here instead, and heed the instructions. This stuff is too hard to work out by trial and error.</p>\n"}], "owner": {"reputation": 1197, "user_id": 2572703, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ea9bb5d1f7a8a598ebc867c3b88e7aaa?s=128&d=identicon&r=PG", "display_name": "Sakib", "link": "https://stackoverflow.com/users/2572703/sakib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 833, "favorite_count": 0, "closed_date": 1489437551, "answer_count": 1, "score": -6, "last_activity_date": 1489521148, "creation_date": 1489434577, "last_edit_date": 1489445182, "question_id": 42772215, "link": "https://stackoverflow.com/questions/42772215/golang-encryption-ciphertext-has-padding-of-as-in-the-beginning", "closed_reason": "Not suitable for this site", "title": "Golang encryption ciphertext has padding of As in the beginning", "body": "<p>I'm trying to use a custom IV for encryption but it results in a ciphertext with padding of As in the beginning like</p>\n\n<p><code>AAAAAAAAAAAAAAAAAAAAACbglBtdgH3ajX1jgkOaVAsFYyDxRRI=</code></p>\n\n<p>I followed the sample implementation at <a href=\"https://gist.github.com/manishtpatel/8222606\" rel=\"nofollow noreferrer\">https://gist.github.com/manishtpatel/8222606</a> with a few changes. The go playground to run and test <a href=\"https://play.golang.org/p/2rS6zBwbnF\" rel=\"nofollow noreferrer\">https://play.golang.org/p/2rS6zBwbnF</a></p>\n\n<p>My code is at<br>\n<a href=\"https://play.golang.org/p/qlx_cU0VPQ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/qlx_cU0VPQ</a></p>\n\n<p>Here is the encrypt function for references as well</p>\n\n<pre><code>func Encrypt(key []byte, text string) string {\n    // key := []byte(keyText)\n    plaintext := []byte(text)\n\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n\n    // The IV needs to be unique, but not secure. Therefore it's common to\n    // include it at the beginning of the ciphertext.\n    ciphertext := make([]byte, aes.BlockSize+len(plaintext))\n    iv := commonIV\n\n    stream := cipher.NewCFBEncrypter(block, iv)\n    stream.XORKeyStream(ciphertext[aes.BlockSize:], plaintext)\n\n    // convert to base64\n    return base64.URLEncoding.EncodeToString(ciphertext)\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 1183, "user_id": 1816631, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/29ced07f3e8c91fca396d867bda0b7da?s=128&d=identicon&r=PG", "display_name": "Gorm Casper", "link": "https://stackoverflow.com/users/1816631/gorm-casper"}, "edited": false, "score": 0, "creation_date": 1489438399, "post_id": 42773160, "comment_id": 72661830, "body": "Thanks! \u2013 <code>Pattern: title</code> ? You mean <code>Pattern: q</code> right? And do you know how to do if <code>q</code> consists of more than one word?"}, {"owner": {"reputation": 459, "user_id": 832169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4796962174e609c97d50ad2f705b394?s=128&d=identicon&r=PG", "display_name": "Steve101", "link": "https://stackoverflow.com/users/832169/steve101"}, "reply_to_user": {"reputation": 1183, "user_id": 1816631, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/29ced07f3e8c91fca396d867bda0b7da?s=128&d=identicon&r=PG", "display_name": "Gorm Casper", "link": "https://stackoverflow.com/users/1816631/gorm-casper"}, "edited": false, "score": 0, "creation_date": 1489438703, "post_id": 42773160, "comment_id": 72661984, "body": "Yes, but you need to add the relevant regex and I would suggest escaping/validating the input to ensure you are not exposed to a NoSql injection style attack."}, {"owner": {"reputation": 459, "user_id": 832169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4796962174e609c97d50ad2f705b394?s=128&d=identicon&r=PG", "display_name": "Steve101", "link": "https://stackoverflow.com/users/832169/steve101"}, "reply_to_user": {"reputation": 1183, "user_id": 1816631, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/29ced07f3e8c91fca396d867bda0b7da?s=128&d=identicon&r=PG", "display_name": "Gorm Casper", "link": "https://stackoverflow.com/users/1816631/gorm-casper"}, "edited": false, "score": 0, "creation_date": 1489438774, "post_id": 42773160, "comment_id": 72662022, "body": "Regarding the multiple words. I would imagine you can do some sort of string split and then use the $and keyword to chain the regex. (<a href=\"https://docs.mongodb.com/manual/reference/operator/query/and/\" rel=\"nofollow noreferrer\">docs.mongodb.com/manual/reference/operator/query/and</a>)"}, {"owner": {"reputation": 1183, "user_id": 1816631, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/29ced07f3e8c91fca396d867bda0b7da?s=128&d=identicon&r=PG", "display_name": "Gorm Casper", "link": "https://stackoverflow.com/users/1816631/gorm-casper"}, "edited": false, "score": 0, "creation_date": 1489439922, "post_id": 42773160, "comment_id": 72662644, "body": "I feel I should be able to, but even that won&#39;t work for me. The googling continues.."}, {"owner": {"reputation": 1183, "user_id": 1816631, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/29ced07f3e8c91fca396d867bda0b7da?s=128&d=identicon&r=PG", "display_name": "Gorm Casper", "link": "https://stackoverflow.com/users/1816631/gorm-casper"}, "edited": false, "score": 0, "creation_date": 1489479198, "post_id": 42773160, "comment_id": 72675683, "body": "I&#39;ll accept your answer since it was the answer that helped me the most, and so the question is considered to have a solution. :)"}], "tags": [], "owner": {"reputation": 459, "user_id": 832169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4796962174e609c97d50ad2f705b394?s=128&d=identicon&r=PG", "display_name": "Steve101", "link": "https://stackoverflow.com/users/832169/steve101"}, "is_accepted": true, "score": 2, "last_activity_date": 1489438599, "last_edit_date": 1489438599, "creation_date": 1489438190, "answer_id": 42773160, "question_id": 42771398, "link": "https://stackoverflow.com/questions/42771398/user-search-with-golang-mgo/42773160#42773160", "title": "User search with Golang mgo", "body": "<p>The mongo filter can take regex, for example;</p>\n\n<pre><code>        bson.M{\"title\": bson.M{\"$regex\": bson.RegEx{Pattern: title, Options: \"i\"}}}\n</code></pre>\n\n<p>So in this case the title variable would be something like; <code>.*abc*.</code>. The Options: \"i\" enables case insensitivity.</p>\n\n<p>As for matching the substring (scenario 2) I am not sure how to achieve within regex. </p>\n"}, {"tags": [], "owner": {"reputation": 594, "user_id": 2303808, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/cNIwW.jpg?s=128&g=1", "display_name": "Sandun Priyanka", "link": "https://stackoverflow.com/users/2303808/sandun-priyanka"}, "is_accepted": false, "score": 0, "last_activity_date": 1520881819, "creation_date": 1520881819, "answer_id": 49242826, "question_id": 42771398, "link": "https://stackoverflow.com/questions/42771398/user-search-with-golang-mgo/49242826#49242826", "title": "User search with Golang mgo", "body": "<p>Simple use this,</p>\n\n<pre><code>wordOffset := q\n\nselector:= bson.M{\"title\": bson.M{\"$regex\": wordOffset}}\n</code></pre>\n"}], "owner": {"reputation": 1183, "user_id": 1816631, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/29ced07f3e8c91fca396d867bda0b7da?s=128&d=identicon&r=PG", "display_name": "Gorm Casper", "link": "https://stackoverflow.com/users/1816631/gorm-casper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1460, "favorite_count": 0, "accepted_answer_id": 42773160, "answer_count": 2, "score": 1, "last_activity_date": 1520881819, "creation_date": 1489431495, "last_edit_date": 1495542321, "question_id": 42771398, "link": "https://stackoverflow.com/questions/42771398/user-search-with-golang-mgo", "title": "User search with Golang mgo", "body": "<p>Getting a string as input (from a user search), I am trying to construct a <code>bson.M</code> object for <code>mgo</code> to search through the mongo database and find x number of items.</p>\n\n<p>Something like this</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func Search (w http.ResponseWriter, r *http.Request) {\n\n    q := r.FormValue(\"q\")\n    filter := bson.M{}\n    // magic happens here \n\n    // do db connection stuff\n    things := []*thing{}\n    err := db.Find(&amp;filter).Limit(10).All(&amp;things)\n    // check error, send things, etc\n}\n</code></pre>\n\n<p>What I need the search to be based on is</p>\n\n<ul>\n<li>ignore case (I found <a href=\"https://stackoverflow.com/questions/37340539/case-insensitive-mongodb-query-from-go\">this answer</a> which takes me part of the way)</li>\n<li>the <code>title</code> in the stored data must, somewhere, include each of the words in the <code>q</code>.</li>\n</ul>\n\n<p>So for instance if the stored data looks like <code>{title: \"abcde\"}</code>, then</p>\n\n<ul>\n<li><code>Abc</code> will match</li>\n<li><code>de Bc</code> will match</li>\n<li><code>ac</code> will not match</li>\n</ul>\n\n<h1>Edit: Solution</h1>\n\n<p>I finally figured it out. The magic part looks like this:</p>\n\n<pre><code>q := r.FormValue(\"q\")\nqs := strings.Split(q, \" \")\nand := make([]bson.M, len(qs))\nfor i, q := range qs {\n    and[i] = bson.M{\"title\": bson.M{\n        \"$regex\": bson.RegEx{Pattern: \".*\" + q + \".*\", Options: \"i\"},\n    }}\n}\nfilter := bson.M{\"$and\": and}\n</code></pre>\n"}, {"tags": ["go", "methods", "types", "export", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489431455, "post_id": 42771289, "comment_id": 72658144, "body": "You created a new <code>Columns</code> type with no methods. Why did you create the new type if you want the methods from the original?"}, {"owner": {"reputation": 4545, "user_id": 3901400, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/gvB8O.jpg?s=128&g=1", "display_name": "Marcus Ruddick", "link": "https://stackoverflow.com/users/3901400/marcus-ruddick"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489431583, "post_id": 42771289, "comment_id": 72658216, "body": "I just thought it was more readable.. so I gather from what you are saying when I make the new type from the old it doesn&#39;t carry the methods with it?"}, {"owner": {"reputation": 4545, "user_id": 3901400, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/gvB8O.jpg?s=128&g=1", "display_name": "Marcus Ruddick", "link": "https://stackoverflow.com/users/3901400/marcus-ruddick"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489431896, "post_id": 42771289, "comment_id": 72658405, "body": "thank you, if you put that as an answer ill accept it."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 0, "last_activity_date": 1489432192, "creation_date": 1489432192, "answer_id": 42771604, "question_id": 42771289, "link": "https://stackoverflow.com/questions/42771289/col-tostrings-undefined-type-columns-has-no-field-or-method-tostrings/42771604#42771604", "title": "col.ToStrings undefined (type Columns has no field or method ToStrings)", "body": "<p><code>type Columns c.Columns</code> creates an entirely new type, with a new method set. The only reason to do this is to specifically remove the methods of the exiting type.</p>\n"}], "owner": {"reputation": 4545, "user_id": 3901400, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/gvB8O.jpg?s=128&g=1", "display_name": "Marcus Ruddick", "link": "https://stackoverflow.com/users/3901400/marcus-ruddick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 0, "accepted_answer_id": 42771604, "answer_count": 1, "score": 0, "last_activity_date": 1489456404, "creation_date": 1489431150, "last_edit_date": 1489456404, "question_id": 42771289, "link": "https://stackoverflow.com/questions/42771289/col-tostrings-undefined-type-columns-has-no-field-or-method-tostrings", "title": "col.ToStrings undefined (type Columns has no field or method ToStrings)", "body": "<p>I am attempting to create a type that represents a slice of pointers to another type and define a method for it, my code looks similar to this, albeit a bit simplified for the example:</p>\n\n<pre><code>package column\n\ntype Column struct {\n\n    name string\n}\n\ntype Columns []*Column\n\nfunc (c Column) ToString() string {\n\n    return c.name\n}\n\nfunc (c Columns) ToStrings() []string {\n\n    var strSlice []string\n\n    for _, v := range c {\n\n        strSlice = append(strSlice, v.ToString())\n    }\n\n    return strSlice\n}\n</code></pre>\n\n<p>It is then called in a separate file like this:</p>\n\n<pre><code>import (\n    c \"main/column\"\n    \"strings\"\n)\n\ntype Columns c.Columns\n\nfunc ToString(col Columns) string {\n\n    return strings.Join(col.ToStrings(), \",\\n\")\n}\n</code></pre>\n\n<p>However when I try to call the method <code>ToStrings()</code> on the exported \"Columns\" type I get this error:</p>\n\n<blockquote>\n  <p>columns.ToStrings undefined (type Columns has no field or method\n  ToStrings)</p>\n</blockquote>\n\n<p>It seems the compiler can't find the method <code>ToStrings()</code>. Is there a way around this? Why can't the compiler find the exported method defined for the \"Columns\" type?</p>\n"}, {"tags": ["go", "error-handling", "string-formatting"], "answers": [{"tags": [], "owner": {"reputation": 1657, "user_id": 2864464, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c606da71fcfa488180a8d81c8fdcc7b4?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kohler", "link": "https://stackoverflow.com/users/2864464/alexander-kohler"}, "is_accepted": false, "score": 1, "last_activity_date": 1489427783, "creation_date": 1489427783, "answer_id": 42770327, "question_id": 42770022, "link": "https://stackoverflow.com/questions/42770022/should-err-error-be-used-in-string-formatting/42770327#42770327", "title": "Should err.Error() be used in string formatting?", "body": "<p>If <code>err</code> implements the <code>Error</code> interface, then the Error() method will be invoked implicitly when using a valid format verb such as <code>%s</code>. The documentation for <a href=\"https://golang.org/pkg/fmt/#hdr-Printing\" rel=\"nofollow noreferrer\">fmt</a> has more on this.</p>\n"}, {"tags": [], "owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "is_accepted": true, "score": 3, "last_activity_date": 1489512221, "last_edit_date": 1489512221, "creation_date": 1489427818, "answer_id": 42770341, "question_id": 42770022, "link": "https://stackoverflow.com/questions/42770022/should-err-error-be-used-in-string-formatting/42770341#42770341", "title": "Should err.Error() be used in string formatting?", "body": "<p>Both versions are completely fine.</p>\n\n<p>The fmt package has special support for the error interface (scroll down a couple screens from <a href=\"https://golang.org/pkg/fmt/#hdr-Printing\" rel=\"nofollow noreferrer\">this link</a>):</p>\n\n<blockquote>\n  <ol start=\"4\">\n  <li>If an operand implements the error interface, the Error method will be invoked to convert the object to a string, which will then be formatted as required by the verb (if any).</li>\n  </ol>\n</blockquote>\n\n<p>Your second version will probably run faster as it can avoid most of the special assertions the fmt package does, but the difference shouldn't be noticeable in most cases.</p>\n\n<p>In general you should probably prefer the first version, which is more readable, especially with more arguments.</p>\n"}], "owner": {"reputation": 24556, "user_id": 110358, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/13c7ad63eb27047a7ff869d27e40c1ad?s=128&d=identicon&r=PG", "display_name": "Jacob Marble", "link": "https://stackoverflow.com/users/110358/jacob-marble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 0, "accepted_answer_id": 42770341, "answer_count": 2, "score": 3, "last_activity_date": 1489512221, "creation_date": 1489426834, "question_id": 42770022, "link": "https://stackoverflow.com/questions/42770022/should-err-error-be-used-in-string-formatting", "title": "Should err.Error() be used in string formatting?", "body": "<p>This string formatting works just fine:</p>\n\n<pre><code>err := foo()\nif err != nil {\n  fmt.Printf(\"foo returned '%s' when called\\n\", err)\n}\n</code></pre>\n\n<p>Is there any merit do calling <code>err.Error()</code> in this context?</p>\n\n<pre><code>fmt.Printf(\"foo returned '%s\" when called\\n\", err.Error())\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 9289, "user_id": 17175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9a89d4cf026c5eb3af2b3fdea1925723?s=128&d=identicon&r=PG", "display_name": "technomage", "link": "https://stackoverflow.com/users/17175/technomage"}, "edited": false, "score": 1, "creation_date": 1489465631, "post_id": 42769969, "comment_id": 72670163, "body": "Check the versions of the instances that are running, and use <code>curl</code> or similar client to ensure you have no caching in play.  Also ensure that your DNS lookups are returning the results you expect."}], "answers": [{"comments": [{"owner": {"reputation": 656, "user_id": 5810492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc4cc0722dda33b630257561e0f49a04?s=128&d=identicon&r=PG", "display_name": "Jonas Hungershausen", "link": "https://stackoverflow.com/users/5810492/jonas-hungershausen"}, "edited": false, "score": 0, "creation_date": 1489500986, "post_id": 42778410, "comment_id": 72691027, "body": "Since I need the <code>go</code> backend to fetch new data from a database and put these onto the page, the <code>index</code> html file is a go htmltemplate. I think I ruled out caching on the localmachine &amp; browser, since I tried to use different devices (phone, tablet, laptop, etc..) and different browsers on these devices and all gave me random older html template files from the project."}, {"owner": {"reputation": 21495, "user_id": 62288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01239dcaa443502ce71059f5308bca74?s=128&d=identicon&r=PG", "display_name": "Dave W. Smith", "link": "https://stackoverflow.com/users/62288/dave-w-smith"}, "reply_to_user": {"reputation": 656, "user_id": 5810492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc4cc0722dda33b630257561e0f49a04?s=128&d=identicon&r=PG", "display_name": "Jonas Hungershausen", "link": "https://stackoverflow.com/users/5810492/jonas-hungershausen"}, "edited": false, "score": 1, "creation_date": 1489507552, "post_id": 42778410, "comment_id": 72696308, "body": "The next bigger stick is to update the <code>version:</code> in <code>app.yaml</code>. If you don&#39;t, there&#39;s a small possibility that you have instances with the old code serving requests."}, {"owner": {"reputation": 656, "user_id": 5810492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc4cc0722dda33b630257561e0f49a04?s=128&d=identicon&r=PG", "display_name": "Jonas Hungershausen", "link": "https://stackoverflow.com/users/5810492/jonas-hungershausen"}, "edited": false, "score": 1, "creation_date": 1489508216, "post_id": 42778410, "comment_id": 72696817, "body": "I think i resolved the error to being some kind of server side caching thing. As the <code>expires</code> date in the header says that it expires in 5 days and the return status code is either 204 or 304. So I think its a caching thing on googles server. Do you know any fix to this by chance? Otherwise I&#39;ll just wait the five days and hope that its resolved by then. Thanks for your help sofar :)"}], "tags": [], "owner": {"reputation": 21495, "user_id": 62288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01239dcaa443502ce71059f5308bca74?s=128&d=identicon&r=PG", "display_name": "Dave W. Smith", "link": "https://stackoverflow.com/users/62288/dave-w-smith"}, "is_accepted": true, "score": 2, "last_activity_date": 1489469553, "creation_date": 1489469553, "answer_id": 42778410, "question_id": 42769969, "link": "https://stackoverflow.com/questions/42769969/appengine-randomly-serves-old-files/42778410#42778410", "title": "appengine randomly serves old files", "body": "<p>Have you ruled out your browser cache as the source of the problem? If after getting a stale version, shift-reload (assuming Chrome or Firefox) brings up the desired version, then look into how to do \"cache busting\" for css and js, and check the <code>app.yaml</code> doc for how to set expiration times on static assets (assuming your <code>index.html</code> is static).</p>\n"}], "owner": {"reputation": 656, "user_id": 5810492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc4cc0722dda33b630257561e0f49a04?s=128&d=identicon&r=PG", "display_name": "Jonas Hungershausen", "link": "https://stackoverflow.com/users/5810492/jonas-hungershausen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 42778410, "answer_count": 1, "score": 2, "last_activity_date": 1489469553, "creation_date": 1489426676, "question_id": 42769969, "link": "https://stackoverflow.com/questions/42769969/appengine-randomly-serves-old-files", "title": "appengine randomly serves old files", "body": "<p>I'm currently using Google Appengine to host a website with <code>Golang</code> as the backend. I have a custom domain setup and (sometimes) it works perfectly fine. My website requires some css and js files from the server. These were served perfectly in the past but now it randomly stops working. Both on the \"mydomain.de\" and on the \"myapp.appspot.com\" domains. Sometimes it works on the normal domain and then it works on the other and sometimes even on both. But if I reload the site after a couple of minutes it just shows me an old index.html file (that I have removed days ago). </p>\n\n<p>Did someone experience this problem in the past and does anyone know a fix for this?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["node.js", "go", "websocket", "http2", "server-push"], "comments": [{"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 2, "creation_date": 1489452267, "post_id": 42768309, "comment_id": 72667023, "body": "You&#39;re showing only a third of the relevant code (only the Websocket server, not the HTTP/2 push or the client side implementations) and asking about results you didn&#39;t paste (but you did summarize)... how are we expected to react to this?"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1489452499, "post_id": 42768309, "comment_id": 72667082, "body": "On another note: HTTP/2 push has both the advantage of HTTP caching on the browser as well as the advantage that HTTP/2 is a persistent TCP/IP connection across all requests (no new connections are opened), while new Websocket connections are opened every time you refresh the page. I&#39;m not sure what your requirements are, but the test might be a little biased towards HTTP/2 (these speeds aren&#39;t correct when it comes to first time clients / connections)."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1489955924, "creation_date": 1489955924, "answer_id": 42891980, "question_id": 42768309, "link": "https://stackoverflow.com/questions/42768309/why-is-websocket-implementation-slower-than-http-2-push-at-transferring-multiple/42891980#42891980", "title": "Why is WebSocket implementation slower than HTTP/2 Push at transferring multiple files? (Node.js / Go)", "body": "<p>See <a href=\"https://github.com/gorilla/websocket/issues/228\" rel=\"nofollow noreferrer\">https://github.com/gorilla/websocket/issues/228</a>. The OP was measuring the time to open the streams with HTTP/2 Push, not the time to transfer all of the data over the streams.  The OP found that Websockets are faster than HTTP/2 push.</p>\n"}], "owner": {"reputation": 1, "user_id": 5741331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/005fa9fd837811479e6241f349a71063?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Smith", "link": "https://stackoverflow.com/users/5741331/robert-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1489955924, "creation_date": 1489421323, "last_edit_date": 1489423706, "question_id": 42768309, "link": "https://stackoverflow.com/questions/42768309/why-is-websocket-implementation-slower-than-http-2-push-at-transferring-multiple", "title": "Why is WebSocket implementation slower than HTTP/2 Push at transferring multiple files? (Node.js / Go)", "body": "<p>I've been experiment with WebSockets and HTTP/2 libraries in Node and Go.  My basic setup is to create a client and server, repeatedly send a file from the server and measure the time until each file is available at the client.</p>\n\n<p>To my surprise, the HTTP/2 Push implementation performs significantly better than WebSocket (more than 5x faster in total time). Am I doing something wrong?</p>\n\n<p>My <a href=\"https://github.com/gorilla/websocket\" rel=\"nofollow noreferrer\">Gorilla WebSocket</a> and <a href=\"https://github.com/websockets/ws\" rel=\"nofollow noreferrer\">node-ws</a> servers below:</p>\n\n<p><strong>Go</strong></p>\n\n<pre><code>package main\n\nimport (\n  \"net/http\"\n  \"io/ioutil\"\n  \"log\"\n  \"github.com/gorilla/websocket\"\n)\n\nvar file []byte\n\nvar upgrader = websocket.Upgrader{\n    ReadBufferSize:  1024,\n    WriteBufferSize: 1024,\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    conn, err := upgrader.Upgrade(w, r, nil)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    for i := 0; i &lt; 100; i++ {\n      conn.WriteMessage(2, file)\n    }\n}\n\nfunc main() {\n  file, _ = ioutil.ReadFile(\"&lt;path-to-file&gt;\")\n\n  http.HandleFunc(\"/\", handler)\n  err := http.ListenAndServeTLS(\":443\", \"&lt;path-to-cert&gt;\", \"&lt;path-to-key&gt;\", nil)\n  if err != nil {\n    panic(\"ListenAndServe: \" + err.Error())\n  }\n}\n</code></pre>\n\n<p><strong>Node</strong></p>\n\n<pre><code>const WebSocket = require('ws');\nconst https = require('https');\nconst fs = require('fs');\n\nconst options = {\n  key: fs.readFileSync('&lt;path-to-key&gt;'),\n  cert: fs.readFileSync('&lt;path-to-cert&gt;')\n};\n\nvar file = fs.readFileSync('&lt;path-to-file&gt;')\n\nvar httpServer = new https.createServer(options).listen(443);\n\nvar wss = new WebSocket.Server({\n  server: httpServer,\n  perMessageDeflate: false\n});\n\nwss.on('connection', function(ws) {\n  for (let i = 0; i &lt; repetition; i++) {\n    ws.send(file);\n  }\n});\n</code></pre>\n"}, {"tags": ["go", "synchronization", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489419377, "post_id": 42767523, "comment_id": 72650536, "body": "In the first one you&#39;re adding 10 to the WaitGroup, in the second you&#39;re adding 9. One goroutine isn&#39;t returning. (you should also defer at the start of the function, not under a conditional in a for loop.)"}, {"owner": {"reputation": 119, "user_id": 7371406, "user_type": "registered", "profile_image": "https://graph.facebook.com/1083156655111572/picture?type=large", "display_name": "Augusto Dias", "link": "https://stackoverflow.com/users/7371406/augusto-dias"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489419767, "post_id": 42767523, "comment_id": 72650843, "body": "i got all the hellos in the first, what routine could be the non-returned?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1489420045, "post_id": 42767523, "comment_id": 72651071, "body": "You can probably guess it&#39;s number <code>0</code> since you haven&#39;t seen that printed, and the stack trace shows you it&#39;s blocked on the chan send on line 13."}, {"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1489420141, "post_id": 42767523, "comment_id": 72651148, "body": "@jimB I think its says &#39;zero&#39; here main.hello(0xc0420380c0, 0x0, 0xc04203a200)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 1, "creation_date": 1489420577, "post_id": 42767523, "comment_id": 72651486, "body": "@BenjaminKadish: yup, that works in this case, though interpreting the actual arguments is often more complicated since they are values on the stack, so things like slices, strings, maps, will show the internal pointers, and the receiver and return values are included as well."}], "answers": [{"tags": [], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "is_accepted": true, "score": 3, "last_activity_date": 1489419523, "creation_date": 1489419523, "answer_id": 42767661, "question_id": 42767523, "link": "https://stackoverflow.com/questions/42767523/deadlock-error-when-trying-to-sync-goroutines/42767661#42767661", "title": "Deadlock error when trying to sync goroutines", "body": "<p>Channel 0 (the call <code>go hello(ch, 0, &amp;wg)</code>) since it is the last channel alive gets stuck on this line  </p>\n\n<pre><code>ch &lt;- (num - 1)\n</code></pre>\n\n<p>It is attempting to send to a channel but no one is there to receive it. Thus the function will wait indefinitely and never be done.</p>\n\n<p>Some suggestions for how to remove this problem</p>\n\n<ul>\n<li>create a consumer in the main loop </li>\n<li>make the channel <code>ch</code> non blocking</li>\n</ul>\n"}], "owner": {"reputation": 119, "user_id": 7371406, "user_type": "registered", "profile_image": "https://graph.facebook.com/1083156655111572/picture?type=large", "display_name": "Augusto Dias", "link": "https://stackoverflow.com/users/7371406/augusto-dias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 0, "accepted_answer_id": 42767661, "answer_count": 1, "score": 1, "last_activity_date": 1489421520, "creation_date": 1489419160, "last_edit_date": 1489421520, "question_id": 42767523, "link": "https://stackoverflow.com/questions/42767523/deadlock-error-when-trying-to-sync-goroutines", "title": "Deadlock error when trying to sync goroutines", "body": "<p>I'm facing an annoying problem. When I try to use <code>wg.Add()</code> to sync my routines, a deadlock error is raised.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc hello(ch chan int, num int, wg *sync.WaitGroup) {\n    for {\n        i := &lt;-ch\n        if i == num {\n            fmt.Println(\"Hello number:\", i)\n            ch &lt;- (num - 1)\n            defer wg.Done() // Same happens without defer\n            return\n        }\n        ch &lt;- i\n    }\n}\n\nfunc main() {\n    fmt.Println(\"Start\")\n\n    var wg sync.WaitGroup\n    ch := make(chan int)\n\n    for i := 0; i &lt; 10; i++ {\n        wg.Add(1)\n        go hello(ch, i, &amp;wg)\n    }\n\n    ch &lt;- 9\n\n    wg.Wait()\n\n    fmt.Println(\"End\")\n}\n</code></pre>\n\n<p>Outputs: </p>\n\n<pre><code>Start\nHello number: 9\nHello number: 8\nHello number: 7\nHello number: 6\nHello number: 5\nHello number: 4\nHello number: 3\nHello number: 2\nHello number: 1\nHello number: 0\nfatal error: all goroutines are asleep - deadlock!\n\ngoroutine 1 [semacquire]:\nsync.runtime_Semacquire(0xc04203a20c)\n        C:/Go/src/runtime/sema.go:47 +0x3b\nsync.(*WaitGroup).Wait(0xc04203a200)\n        C:/Go/src/sync/waitgroup.go:131 +0x81\nmain.main()\n        C:/Users/Augusto Dias/Documents/GoLang/MT.go:34 +0x1a0\n\ngoroutine 18 [chan send]:\nmain.hello(0xc0420380c0, 0x0, 0xc04203a200)\n        C:/Users/Augusto Dias/Documents/GoLang/MT.go:13 +0x197\ncreated by main.main\n        C:/Users/Augusto Dias/Documents/GoLang/MT.go:29 +0x151\nexit status 2\n</code></pre>\n\n<p>When I use <code>wg.Add(9)</code> outside the for block, I got no error.</p>\n\n<pre><code>func main() {\n    fmt.Println(\"Start\")\n\n    var wg sync.WaitGroup\n    ch := make(chan int)\n\n    wg.Add(9) // Use wg.Add(10) will raise deadlock too\n\n    for i := 0; i &lt; 10; i++ {\n        go hello(ch, i, &amp;wg)\n    }\n\n    ch &lt;- 9\n\n    wg.Wait()\n    fmt.Println(\"End\")\n}\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>Start\nHello number: 9\nHello number: 8\nHello number: 7\nHello number: 6\nHello number: 5\nHello number: 4\nHello number: 3\nHello number: 2\nHello number: 1\nEnd\n</code></pre>\n\n<p>Why is this happening, I mean, why routines goes asleep when I wait for them all? Use the same channel for send and receive can be the source of this problem?</p>\n"}, {"tags": ["go", "swagger", "go-gin"], "answers": [{"tags": [], "owner": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "is_accepted": false, "score": 0, "last_activity_date": 1489420567, "creation_date": 1489420567, "answer_id": 42768038, "question_id": 42766501, "link": "https://stackoverflow.com/questions/42766501/how-to-create-swagger-json-in-go-gin-gonic/42768038#42768038", "title": "How to create swagger.json in go gin-gonic", "body": "<p>Gin uses goswagger as a base. You could try using <a href=\"https://goswagger.io/use/schemas.html\" rel=\"nofollow noreferrer\">goswagger directly</a></p>\n\n<p>Follow the instructions and the prescribed godoc commenting rules and you should get similar behavior to gin.</p>\n\n<p>FYI, I have not used goswagger myself.</p>\n"}], "owner": {"reputation": 1334, "user_id": 792564, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dddd64bc74c3dcdb882d96d2a84cce07?s=128&d=identicon&r=PG", "display_name": "Akamad007", "link": "https://stackoverflow.com/users/792564/akamad007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2175, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1489458007, "creation_date": 1489416350, "last_edit_date": 1489458007, "question_id": 42766501, "link": "https://stackoverflow.com/questions/42766501/how-to-create-swagger-json-in-go-gin-gonic", "title": "How to create swagger.json in go gin-gonic", "body": "<p>I am trying to add documentation to my golang project which has been created using gin-gonic. The problem I am facing currently is that gin-gonic's stable version does not support swagger. </p>\n\n<p><a href=\"https://www.google.com/webhp?sourceid=chrome-instant&amp;ion=1&amp;espv=2&amp;ie=UTF-8#q=gin-gonic%20swagger&amp;*\" rel=\"nofollow noreferrer\">Issue in gin-gonic</a></p>\n\n<p>Currently when I try to generate the swagger.json its paths are empty. Is there a way in golang to tell it to add end points manually? </p>\n\n<pre><code>go generate\ncat swagger.json \n{\n  \"swagger\": \"2.0\",\n  \"paths\": {},\n  \"definitions\": {}\n}\n</code></pre>\n\n<p>If this is not an option, should I look into a different framework for the same? </p>\n"}, {"tags": ["logging", "go", "callstack"], "answers": [{"tags": [], "owner": {"reputation": 48302, "user_id": 388916, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f9d967832644f9faa431e4e50b69bb0?s=128&d=identicon&r=PG", "display_name": "Hubro", "link": "https://stackoverflow.com/users/388916/hubro"}, "is_accepted": false, "score": 0, "last_activity_date": 1489404254, "creation_date": 1489404254, "answer_id": 42762458, "question_id": 42762391, "link": "https://stackoverflow.com/questions/42762391/is-it-possible-to-wrap-log-logger-functions-without-losing-the-line-number-prefi/42762458#42762458", "title": "Is it possible to wrap log.Logger functions without losing the line number prefix?", "body": "<p>I was going to include this in the question as my current workaround, but I suppose it is a valid answer. I'm hoping somebody can tell me of a logger config option I've missed that lets me adjust the depth the logger uses when it calls <code>runtime.Caller</code>.</p>\n\n<p>A workaround is to remove the <code>log.Lshortfile</code> flag and implement the behavior manually:</p>\n\n<pre><code>func info(format string, args ...interface{}) {\n    _, file, line, _ := runtime.Caller(1)\n\n    prefix := fmt.Sprintf(\"%v:%v: \", path.Base(file), line)\n\n    if logger != nil {\n        logger.Printf(prefix+format+\"\\n\", args...)\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 48302, "user_id": 388916, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f9d967832644f9faa431e4e50b69bb0?s=128&d=identicon&r=PG", "display_name": "Hubro", "link": "https://stackoverflow.com/users/388916/hubro"}, "edited": false, "score": 2, "creation_date": 1489405937, "post_id": 42762815, "comment_id": 72640983, "body": "That&#39;s what I&#39;m talking about :D Great answer"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 11, "last_activity_date": 1489406234, "last_edit_date": 1489406234, "creation_date": 1489405407, "answer_id": 42762815, "question_id": 42762391, "link": "https://stackoverflow.com/questions/42762391/is-it-possible-to-wrap-log-logger-functions-without-losing-the-line-number-prefi/42762815#42762815", "title": "Is it possible to wrap log.Logger functions without losing the line number prefix?", "body": "<p>Methods of <a href=\"https://golang.org/pkg/log/#Logger\" rel=\"noreferrer\"><code>log.Logger</code></a> call the <a href=\"https://golang.org/pkg/log/#Logger.Output\" rel=\"noreferrer\"><code>Logger.Output()</code></a> method to send the message to the appropriate output. <code>Logger.Output()</code> allows you to pass the <code>calldepth</code> (the number of frames to skip).</p>\n\n<p>Unfortunately methods of <code>log.Logger</code> contain the <code>calldepth</code> \"wired in\", so you can't provide an offset to skip the wrapper function's frame.</p>\n\n<p>But a much better alternative is to call this <code>Logger.Output()</code> from your wrapper, so you don't have to bother with frames and lines yourself. Also note that you don't need to append a newline <code>\"\\n\"</code>, as the <code>log.Logger</code> type already does that if the message to be logged does not end with a newline.</p>\n\n<p>So a better and shorter alternative:</p>\n\n<pre><code>var myLogger = log.New(os.Stdout, \"[my]\", log.Lshortfile)\n\nfunc info(pattern string, args ...interface{}) {\n    myLogger.Output(2, fmt.Sprintf(pattern, args...))\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>func main() {\n    log.SetFlags(log.Lshortfile)\n    log.Println(\"hello\")\n    info(\"world\")\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/WKgcgzEbtV\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>main.go:11: hello\n[my]main.go:12: world\n</code></pre>\n\n<p>As you can see, <code>info()</code> prints the proper line number (+1 compared to the line number printed by <code>log.Println()</code> in the previous line).</p>\n"}], "owner": {"reputation": 48302, "user_id": 388916, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f9d967832644f9faa431e4e50b69bb0?s=128&d=identicon&r=PG", "display_name": "Hubro", "link": "https://stackoverflow.com/users/388916/hubro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2739, "favorite_count": 2, "accepted_answer_id": 42762815, "answer_count": 2, "score": 9, "last_activity_date": 1489416132, "creation_date": 1489404076, "last_edit_date": 1489416132, "question_id": 42762391, "link": "https://stackoverflow.com/questions/42762391/is-it-possible-to-wrap-log-logger-functions-without-losing-the-line-number-prefi", "title": "Is it possible to wrap log.Logger functions without losing the line number prefix?", "body": "<p>When using the <code>log.Lshortfile</code> flag, the logger prefixes all log lines with the file name and line number of the logger function call, for example:</p>\n\n<pre>myfile.go:14: Hello, world!</pre>\n\n<p>If I wrap the log function like this, for instance:</p>\n\n<pre><code>func info(pattern string, args ...interface{}) {\n    myLogger.Printf(pattern + \"\\n\", args...)\n}\n</code></pre>\n\n<p>Every line emitted by this function is going to be prefixed with the line number of the <code>Printf</code> call. That is as expected, but the desired behavior is for each line to be prefixed with the line number of the line where <code>info</code> is called.</p>\n\n<p>Is there any way around it?</p>\n"}, {"tags": ["go", "openssl", "mqtt", "mosquitto", "paho"], "answers": [{"comments": [{"owner": {"reputation": 573, "user_id": 1739342, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/e73718790050f4bc26c0b089f80df7a4?s=128&d=identicon&r=PG", "display_name": "ender.an27", "link": "https://stackoverflow.com/users/1739342/ender-an27"}, "edited": false, "score": 0, "creation_date": 1489655365, "post_id": 42764787, "comment_id": 72769065, "body": "Thanks. If you write how to create the correct cert I give you the cookie"}], "tags": [], "owner": {"reputation": 48, "user_id": 7035267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ced2184380b348e245f77051d5c85ee1?s=128&d=identicon&r=PG&f=1", "display_name": "Al S-M", "link": "https://stackoverflow.com/users/7035267/al-s-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1489411515, "creation_date": 1489411515, "answer_id": 42764787, "question_id": 42761866, "link": "https://stackoverflow.com/questions/42761866/paho-go-client-unable-to-connect-to-broker/42764787#42764787", "title": "Paho GO client unable to connect to Broker", "body": "<p>Certificates that start <code>BEGIN TRUSTED CERTIFICATE</code> is an OpenSSL \"trusted certificate\" file which is a format not understood/parsable by the Go crypto libraries. When you generated the cert did you use any of the options under \"TRUST SETTINGS\" on the <a href=\"https://www.openssl.org/docs/man1.0.1/apps/x509.html\" rel=\"nofollow noreferrer\">x509 man page</a>?\nThe Go TLS library is just <a href=\"https://golang.org/src/crypto/tls/tls.go?s=6279:6292#L204\" rel=\"nofollow noreferrer\">looking</a> for <code>-----BEGIN CERTIFICATE-----</code> at the start of the file, anything else will throw an error.</p>\n"}], "owner": {"reputation": 573, "user_id": 1739342, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/e73718790050f4bc26c0b089f80df7a4?s=128&d=identicon&r=PG", "display_name": "ender.an27", "link": "https://stackoverflow.com/users/1739342/ender-an27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 865, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489411515, "creation_date": 1489402548, "question_id": 42761866, "link": "https://stackoverflow.com/questions/42761866/paho-go-client-unable-to-connect-to-broker", "title": "Paho GO client unable to connect to Broker", "body": "<p>I'm trying to connect to a mosquitto broker which is using certificate based authentication.</p>\n\n<p>The mosquitto snipped configuration below:</p>\n\n<pre><code>listener 8883\ncafile /etc/mosquitto/ca_certificates/ca.crt\ncertfile /etc/mosquitto/certs/server.crt\nkeyfile /etc/mosquitto/certs/server.key\n\nrequire_certificate true\n</code></pre>\n\n<p>The configuration it works because I'm able to make a pub/sub in a remote machine using following commands:</p>\n\n<pre><code>mosquitto_pub -t \"/test\" -m \"test\" --cafile ca/ca.crt --cert certs/client.crt --key certs/client.key -p 8883 -h server.com\n\nmosquitto_sub -t \"/test\" --cafile ca/ca.crt --cert certs/client.crt --key certs/client.key -p 8883 -h server.com\n</code></pre>\n\n<p>or open a SSL socket by:</p>\n\n<pre><code>openssl s_client -connect server.com:8883 -CAfile ca/ca.crt -cert certs/client.crt -key certs/client.key\n</code></pre>\n\n<p>but when I trying to use GO Paho client doesn't work:</p>\n\n<p>The the configuration loading doesn't work because in <code>configureMqttConnection()</code> is unable to load the Certificates (this line <code>tls.LoadX509KeyPair(c.config.CertFile, c.config.KeyFile)</code>) and in <code>connect(backOff int)</code> fails because the client is unable to send the certificate in the handshake.</p>\n\n<p>I think maybe the problem is that the certificates that LoadX509KeyPair is expecting are not the ones I'm generating. My certificates says 'BEGIN TRUSTED CERTIFICATE' and not being trusted and certificated or something like this. If this is I not sure how I can create the correct certificate. </p>\n\n<p>I'm using this GO code below (the code starts with <code>GO start()</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/tls\"\n    \"crypto/x509\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"strings\"\n    \"time\"\n\n    MQTT \"git.eclipse.org/gitroot/paho/org.eclipse.paho.mqtt.golang.git\"\n    \"linksmart.eu/lc/core/catalog\"\n    \"linksmart.eu/lc/core/catalog/service\"\n)\n\n// MQTTConnector provides MQTT protocol connectivity\ntype MQTTConnector struct {\n    config        *MqttProtocol\n    clientID      string\n    client        *MQTT.Client\n    pubCh         chan AgentResponse\n    subCh         chan&lt;- DataRequest\n    pubTopics     map[string]string\n    subTopicsRvsd map[string]string // store SUB topics \"reversed\" to optimize lookup in messageHandler\n}\n\nconst defaultQoS = 1\n\nfunc (c *MQTTConnector) start() {\n    logger.Println(\"MQTTConnector.start()\")\n\n    if c.config.Discover &amp;&amp; c.config.URL == \"\" {\n        err := c.discoverBrokerEndpoint()\n        if err != nil {\n            logger.Println(\"MQTTConnector.start() failed to start publisher:\", err.Error())\n            return\n        }\n    }\n\n    // configure the mqtt client\n    c.configureMqttConnection()\n\n    // start the connection routine\n    logger.Printf(\"MQTTConnector.start() Will connect to the broker %v\\n\", c.config.URL)\n    go c.connect(0)\n\n    // start the publisher routine\n    go c.publisher()\n}\n\n// reads outgoing messages from the pubCh und publishes them to the broker\nfunc (c *MQTTConnector) publisher() {\n    for resp := range c.pubCh {\n        if !c.client.IsConnected() {\n            logger.Println(\"MQTTConnector.publisher() got data while not connected to the broker. **discarded**\")\n            continue\n        }\n        if resp.IsError {\n            logger.Println(\"MQTTConnector.publisher() data ERROR from agent manager:\", string(resp.Payload))\n            continue\n        }\n        topic := c.pubTopics[resp.ResourceId]\n        c.client.Publish(topic, byte(defaultQoS), false, resp.Payload)\n        // We dont' wait for confirmation from broker (avoid blocking here!)\n        //&lt;-r\n        logger.Println(\"MQTTConnector.publisher() published to\", topic)\n    }\n}\n\n\nfunc (c *MQTTConnector) stop() {\n    logger.Println(\"MQTTConnector.stop()\")\n    if c.client != nil &amp;&amp; c.client.IsConnected() {\n        c.client.Disconnect(500)\n    }\n}\n\nfunc (c *MQTTConnector) connect(backOff int) {\n    if c.client == nil {\n        logger.Printf(\"MQTTConnector.connect() client is not configured\")\n        return\n    }\n    for {\n        logger.Printf(\"MQTTConnector.connect() connecting to the broker %v, backOff: %v sec\\n\", c.config.URL, backOff)\n        time.Sleep(time.Duration(backOff) * time.Second)\n        if c.client.IsConnected() {\n            break\n        }\n        token := c.client.Connect()\n        token.Wait()\n        if token.Error() == nil {\n            break\n        }\n        logger.Printf(\"MQTTConnector.connect() failed to connect: %v\\n\", token.Error().Error())\n        if backOff == 0 {\n            backOff = 10\n        } else if backOff &lt;= 600 {\n            backOff *= 2\n        }\n    }\n\n    logger.Printf(\"MQTTConnector.connect() connected to the broker %v\", c.config.URL)\n    return\n}\n\nfunc (c *MQTTConnector) onConnected(client *MQTT.Client) {\n    // subscribe if there is at least one resource with SUB in MQTT protocol is configured\n    if len(c.subTopicsRvsd) &gt; 0 {\n        logger.Println(\"MQTTPulbisher.onConnected() will (re-)subscribe to all configured SUB topics\")\n\n        topicFilters := make(map[string]byte)\n        for topic, _ := range c.subTopicsRvsd {\n            logger.Printf(\"MQTTPulbisher.onConnected() will subscribe to topic %s\", topic)\n            topicFilters[topic] = defaultQoS\n        }\n        client.SubscribeMultiple(topicFilters, c.messageHandler)\n    } else {\n        logger.Println(\"MQTTPulbisher.onConnected() no resources with SUB configured\")\n    }\n}\n\nfunc (c *MQTTConnector) onConnectionLost(client *MQTT.Client, reason error) {\n    logger.Println(\"MQTTPulbisher.onConnectionLost() lost connection to the broker: \", reason.Error())\n\n    // Initialize a new client and reconnect\n    c.configureMqttConnection()\n    go c.connect(0)\n}\n\nfunc (c *MQTTConnector) configureMqttConnection() {\n    connOpts := MQTT.NewClientOptions().\n        AddBroker(c.config.URL).\n        SetClientID(c.clientID).\n        SetCleanSession(true).\n        SetConnectionLostHandler(c.onConnectionLost).\n        SetOnConnectHandler(c.onConnected).\n        SetAutoReconnect(false) // we take care of re-connect ourselves\n\n    // Username/password authentication\n    if c.config.Username != \"\" &amp;&amp; c.config.Password != \"\" {\n        connOpts.SetUsername(c.config.Username)\n        connOpts.SetPassword(c.config.Password)\n    }\n\n    // SSL/TLS\n    if strings.HasPrefix(c.config.URL, \"ssl\") {\n        tlsConfig := &amp;tls.Config{}\n        // Custom CA to auth broker with a self-signed certificate\n        if c.config.CaFile != \"\" {\n            caFile, err := ioutil.ReadFile(c.config.CaFile)\n            if err != nil {\n                logger.Printf(\"MQTTConnector.configureMqttConnection() ERROR: failed to read CA file %s:%s\\n\", c.config.CaFile, err.Error())\n            } else {\n                tlsConfig.RootCAs = x509.NewCertPool()\n                ok := tlsConfig.RootCAs.AppendCertsFromPEM(caFile)\n                if !ok {\n                    logger.Printf(\"MQTTConnector.configureMqttConnection() ERROR: failed to parse CA certificate %s\\n\", c.config.CaFile)\n                }\n            }\n        }\n        // Certificate-based client authentication\n        if c.config.CertFile != \"\" &amp;&amp; c.config.KeyFile != \"\" {\n            cert, err := tls.LoadX509KeyPair(c.config.CertFile, c.config.KeyFile)\n            if err != nil {\n                logger.Printf(\"MQTTConnector.configureMqttConnection() ERROR: failed to load client TLS credentials: %s\\n\",\n                    err.Error())\n            } else {\n                tlsConfig.Certificates = []tls.Certificate{cert}\n            }\n        }\n\n        connOpts.SetTLSConfig(tlsConfig)\n    }\n\n    c.client = MQTT.NewClient(connOpts)\n}\n</code></pre>\n\n<p>I think the problem i</p>\n"}, {"tags": ["git", "github", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1489431973, "post_id": 42761820, "comment_id": 72658436, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/24855081/how-do-i-import-a-specific-version-of-a-package-using-go-get\">How do I import a specific version of a package using go get?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 698, "user_id": 210827, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/da0d68721d1a1c02dcebebd6a5c35887?s=128&d=identicon&r=PG", "display_name": "getWeberForStackExchange", "link": "https://stackoverflow.com/users/210827/getweberforstackexchange"}, "edited": false, "score": 0, "creation_date": 1489446670, "post_id": 42761887, "comment_id": 72665474, "body": "In response to &quot;most of them support tags and revisions, not branches,&quot; one that does seem to support branches is Glide, according to <a href=\"https://glide.readthedocs.io/en/latest/versions/\" rel=\"nofollow noreferrer\">their versioning doc</a>."}], "tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 18, "last_activity_date": 1489405601, "last_edit_date": 1489405601, "creation_date": 1489402617, "answer_id": 42761887, "question_id": 42761820, "link": "https://stackoverflow.com/questions/42761820/how-to-get-another-branch-instead-of-default-branch-with-go-get/42761887#42761887", "title": "How to get another branch instead of default branch with go get", "body": "<h3>Stable HEAD philosophy</h3>\n\n<p><strong>It is not possible with pure <code>go get</code>.</strong> </p>\n\n<blockquote>\n  <p>Go takes the most minimal and pragmatic approach of any package manager. There is no such thing as multiple versions of a Go package.</p>\n</blockquote>\n\n<p>But this is not as bad as it seems at the first view because there exists a philosophy behind this behavior.</p>\n\n<blockquote>\n  <p>As a package author, you must adhere to the stable HEAD philosophy. Your default branch must always be the stable, released version of your package. You must do work in feature branches and only merge when ready to release.</p>\n</blockquote>\n\n<p>This approach is forced by <code>go get</code> limitations and it should be treated like Python indentations - it is kind of philosophy forced by language design.</p>\n\n<h3>Development approaches</h3>\n\n<p>If you want to fork something or try new features you can clone repo then switch to a desired branch and do <code>go build</code>. This way shouldn't go to production.</p>\n\n<pre><code>git clone &lt;repo name&gt;\ncd &lt;repo name&gt;\ngit checkout &lt;branch name&gt;\ngo build\n</code></pre>\n\n<p>Also you can use third party package management tools. But most of them support tags and revisions, not branches (since it is implied that you don't need to install feature branch).</p>\n\n<p><a href=\"https://github.com/pote/gpm\" rel=\"noreferrer\">gpm</a>:</p>\n\n<blockquote>\n  <p>You can specify packages with the   format, where version can be a revision number (a git/bazaar/mercurial/svn revision hash) or a tag.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "is_accepted": false, "score": 13, "last_activity_date": 1489417401, "creation_date": 1489417401, "answer_id": 42766877, "question_id": 42761820, "link": "https://stackoverflow.com/questions/42761820/how-to-get-another-branch-instead-of-default-branch-with-go-get/42766877#42766877", "title": "How to get another branch instead of default branch with go get", "body": "<p>you can use <code>gopkg.in</code>, it will redirect to github.</p>\n\n<p>There are two URL patterns supported:</p>\n\n<pre><code>gopkg.in/pkg.v3      \u2192 github.com/go-pkg/pkg (branch/tag v3, v3.N, or v3.N.M)\ngopkg.in/user/pkg.v3 \u2192 github.com/user/pkg   (branch/tag v3, v3.N, or v3.N.M)\n</code></pre>\n\n<p><code>go get gopkg.in/pkg.v3</code> means <code>go get github.com/go-pkg/pkg</code>, but is branch or tag <code>v3.*</code>. </p>\n\n<p>for more details, see <a href=\"http://labix.org/gopkg.in\" rel=\"noreferrer\">here</a></p>\n"}, {"comments": [{"owner": {"reputation": 358, "user_id": 227225, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a92a68a7eacbbfd94603e60fa07426f3?s=128&d=identicon&r=PG", "display_name": "Nimrod Yonatan Ben-Nes", "link": "https://stackoverflow.com/users/227225/nimrod-yonatan-ben-nes"}, "edited": false, "score": 9, "creation_date": 1570792974, "post_id": 55302537, "comment_id": 103035701, "body": "With go 1.13 u can encounter an error when trying to get a branch, the error end with &quot;invalid version: unknown revision XXX&quot;.  You can workaround that by using the commit hash instead of the branch name."}, {"owner": {"reputation": 603, "user_id": 2904179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XMgKy.png?s=128&g=1", "display_name": "SteveCoffman", "link": "https://stackoverflow.com/users/2904179/stevecoffman"}, "edited": false, "score": 4, "creation_date": 1592172049, "post_id": 55302537, "comment_id": 110322411, "body": "<a href=\"https://github.com/golang/go/issues/32955\" rel=\"nofollow noreferrer\">Only if your branch name contains a slash</a>, then you will get an error on Go 1.13. The workaround is you to use the commit SHA1 instead of the branch name."}], "tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": true, "score": 50, "last_activity_date": 1553267100, "creation_date": 1553267100, "answer_id": 55302537, "question_id": 42761820, "link": "https://stackoverflow.com/questions/42761820/how-to-get-another-branch-instead-of-default-branch-with-go-get/55302537#55302537", "title": "How to get another branch instead of default branch with go get", "body": "<p>Starting with Go 1.11, this is possible when using <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"noreferrer\">Go modules</a>. When installing a dependency for a Go module, you can specify a <a href=\"https://tip.golang.org/cmd/go/#hdr-Module_queries\" rel=\"noreferrer\">module query</a> which may contain a branch or tag name:</p>\n\n<pre><code>$ go get &lt;path-to-repo&gt;@&lt;branch&gt;\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 3528220, "user_type": "registered", "profile_image": "https://graph.facebook.com/1649066076/picture?type=large", "display_name": "MouseWanted", "link": "https://stackoverflow.com/users/3528220/mousewanted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42265, "favorite_count": 7, "accepted_answer_id": 55302537, "answer_count": 3, "score": 28, "last_activity_date": 1553267100, "creation_date": 1489402370, "question_id": 42761820, "link": "https://stackoverflow.com/questions/42761820/how-to-get-another-branch-instead-of-default-branch-with-go-get", "title": "How to get another branch instead of default branch with go get", "body": "<p>I have 2 repositories. Let say them repo_a and repo_b. I imported repo_a in repo_b</p>\n\n<p>When I ran go get, it will get repo_a master branch.\nIs there any way to get develop branch using go get or another command from repo_b?</p>\n\n<p>I do not want to git pull on each specific package (in this case repo_a)</p>\n"}, {"tags": ["elasticsearch", "go"], "comments": [{"owner": {"reputation": 163519, "user_id": 4604579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/reC2t.jpg?s=128&g=1", "display_name": "Val", "link": "https://stackoverflow.com/users/4604579/val"}, "edited": false, "score": 1, "creation_date": 1489390518, "post_id": 42758392, "comment_id": 72632545, "body": "This answer might help: <a href=\"http://stackoverflow.com/a/40610924/4604579\">stackoverflow.com/a/40610924/4604579</a>"}, {"owner": {"reputation": 4291, "user_id": 304215, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/cVby7.jpg?s=128&g=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/304215/suresh"}, "reply_to_user": {"reputation": 163519, "user_id": 4604579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/reC2t.jpg?s=128&g=1", "display_name": "Val", "link": "https://stackoverflow.com/users/4604579/val"}, "edited": false, "score": 0, "creation_date": 1489398150, "post_id": 42758392, "comment_id": 72636481, "body": "@Val - Thanks for helping me out."}, {"owner": {"reputation": 163519, "user_id": 4604579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/reC2t.jpg?s=128&g=1", "display_name": "Val", "link": "https://stackoverflow.com/users/4604579/val"}, "edited": false, "score": 0, "creation_date": 1489398869, "post_id": 42758392, "comment_id": 72636916, "body": "No prob, glad to help!"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1489400330, "post_id": 42758392, "comment_id": 72637711, "body": "The error message tells you exactly what&#39;s wrong. What is your question?"}, {"owner": {"reputation": 4291, "user_id": 304215, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/cVby7.jpg?s=128&g=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/304215/suresh"}, "edited": false, "score": 0, "creation_date": 1489400959, "post_id": 42758392, "comment_id": 72638063, "body": "My question is about golang error message &quot;not enough arguments in call&quot;? As I&#39;m new to golang I couldn&#39;t able to understand what it&#39;s exactly. Anyway, It&#39;s fixed now."}, {"owner": {"reputation": 4291, "user_id": 304215, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/cVby7.jpg?s=128&g=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/304215/suresh"}, "edited": false, "score": 0, "creation_date": 1489401109, "post_id": 42758392, "comment_id": 72638146, "body": "@DownVoters - It&#39;ll be great to mention the reason of making down votes. So that, If I made anything wrong in question than I can fix that."}, {"owner": {"reputation": 4291, "user_id": 304215, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/cVby7.jpg?s=128&g=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/304215/suresh"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1489406586, "post_id": 42758392, "comment_id": 72641394, "body": "@Flimzy It&#39;s just 5 days I&#39;ve started with golang. I&#39;ve no idea about  golang&#39;s &#39;context&#39; &amp; error displaying technique. So, when I saw error message like this <code>have () want (&quot;golang.org&#47;x&#47;net&#47;context&quot;.Context)</code> I got confused. Don&#39;t you think, fig. out the solution from error message require some short of prior information about the programming language &amp; which can be achieved in a certain level of experience."}], "answers": [{"comments": [{"owner": {"reputation": 4291, "user_id": 304215, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/cVby7.jpg?s=128&g=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/304215/suresh"}, "edited": false, "score": 0, "creation_date": 1489398109, "post_id": 42758492, "comment_id": 72636452, "body": "Thanks. Exactly, I made mistake at here. It&#39;s working now."}], "tags": [], "owner": {"reputation": 459, "user_id": 832169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4796962174e609c97d50ad2f705b394?s=128&d=identicon&r=PG", "display_name": "Steve101", "link": "https://stackoverflow.com/users/832169/steve101"}, "is_accepted": true, "score": 3, "last_activity_date": 1489390601, "creation_date": 1489390601, "answer_id": 42758492, "question_id": 42758392, "link": "https://stackoverflow.com/questions/42758392/golang-error-not-enough-arguments-in-call/42758492#42758492", "title": "Golang error &quot;not enough arguments in call&quot;", "body": "<p>You need to pass a context to bulkRequest.Do().</p>\n\n<p>From the olivere/elastic Github page (abbreviated);</p>\n\n<p><code>// Create a context\n     ctx := context.Background()\n     bulkRequest.Do(ctx)\n</code></p>\n"}], "owner": {"reputation": 4291, "user_id": 304215, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/cVby7.jpg?s=128&g=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/304215/suresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3758, "favorite_count": 0, "accepted_answer_id": 42758492, "answer_count": 1, "score": -4, "last_activity_date": 1489406667, "creation_date": 1489390210, "last_edit_date": 1489406667, "question_id": 42758392, "link": "https://stackoverflow.com/questions/42758392/golang-error-not-enough-arguments-in-call", "title": "Golang error &quot;not enough arguments in call&quot;", "body": "<p>I'm new to golang. Trying to implement a bulk upload to Elasticsearch by golang. I'm using golang library -> <a href=\"https://github.com/olivere/elastic\" rel=\"nofollow noreferrer\">https://github.com/olivere/elastic</a> for communication with Elasticsearch.</p>\n\n<p>Also, a piece of sample code which I'm trying but getting following error...</p>\n\n<pre><code>suresh@BLR-245:~/Desktop/tools/golang/src$ go install github.com/crazyheart/elastic-bulk-upload\n# github.com/crazyheart/elastic-bulk-upload\ngithub.com/crazyheart/elastic-bulk-upload/main.go:29: not enough arguments in call to bulkRequest.Do\n    have ()\n    want (\"golang.org/x/net/context\".Context)\nsuresh@BLR-245:~/Desktop/tools/golang/src$ \n</code></pre>\n\n<p>My Golang Code(main.go)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"gopkg.in/olivere/elastic.v5\"\n    \"strconv\"\n)\n\ntype Tweet struct {\n    User    string `json:\"user\"`\n    Message string `json:\"message\"`\n}\n\nfunc main() {\n    client, err := elastic.NewClient()\n    if err != nil {\n        fmt.Println(\"%v\", err)\n    }\n\n    n := 0\n    for i := 0; i &lt; 1000; i++ {\n        bulkRequest := client.Bulk()\n        for j := 0; j &lt; 10000; j++ {\n            n++\n            tweet := Tweet{User: \"olivere\", Message: \"Package strconv implements conversions to and from string representations of basic data types. \" + strconv.Itoa(n)}\n            req := elastic.NewBulkIndexRequest().Index(\"twitter\").Type(\"tweet\").Id(strconv.Itoa(n)).Doc(tweet)\n            bulkRequest = bulkRequest.Add(req)\n        }\n        bulkResponse, err := bulkRequest.Do()\n        if err != nil {\n            fmt.Println(err)\n        }\n        if bulkResponse != nil {\n\n        }\n        fmt.Println(i)\n    }\n}\n</code></pre>\n\n<p>Anybody, help me to understand what that error means &amp; how to solve those?</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1489412486, "post_id": 42758064, "comment_id": 72645278, "body": "Your overall GOPATH and GOROOT and Go installation is very wrong. Too much to list to fix.  Instead, read up on exactly how to setup GoLang Workspaces and don&#39;t deviate regardless of how much u disagree with the pathnames: <a href=\"https://golang.org/doc/code.html#Workspaces\" rel=\"nofollow noreferrer\">golang.org/doc/code.html#Workspaces</a> - it only works if you follow exactly this directory structure."}, {"owner": {"reputation": 23, "user_id": 1829125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b7bcb54b0a59283f4d21017ce3136f7?s=128&d=identicon&r=PG", "display_name": "Luis Ortega", "link": "https://stackoverflow.com/users/1829125/luis-ortega"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1489416133, "post_id": 42758064, "comment_id": 72647996, "body": "I believe that was the installation one... and by then I got the **bad import &quot;syscall&quot; **, but because a lot has changed since, I&#39;m going to give it a try....  brb"}, {"owner": {"reputation": 23, "user_id": 1829125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b7bcb54b0a59283f4d21017ce3136f7?s=128&d=identicon&r=PG", "display_name": "Luis Ortega", "link": "https://stackoverflow.com/users/1829125/luis-ortega"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1489416533, "post_id": 42758064, "comment_id": 72648303, "body": "New setup (based on the recommended directory structure... echo $GOPATH <b>/Users/luisortega/goLibs</b>  ls  <b>alecthomas\taural9\t\tgo-sql-driver\tgofpdf-master\tgolang\t\tgoogl&zwnj;&#8203;e-cloud-go\tnsf\t\trogp&zwnj;&#8203;eppe\tsqs\t\tzmb3</b>  new project folder <b>pwd /Users/luisortega/goLibs/src/github.com/aural9</b>  Same result..."}, {"owner": {"reputation": 23, "user_id": 1829125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b7bcb54b0a59283f4d21017ce3136f7?s=128&d=identicon&r=PG", "display_name": "Luis Ortega", "link": "https://stackoverflow.com/users/1829125/luis-ortega"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1489448087, "post_id": 42758064, "comment_id": 72665866, "body": "Sooooooooo the solution of the problem was not to get the cloud engine by &quot;go get&quot;.... but instead use &quot;goapp get&quot;... I don&#39;t really know what is processed differently... but that hit the spot!"}, {"owner": {"reputation": 23, "user_id": 1829125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b7bcb54b0a59283f4d21017ce3136f7?s=128&d=identicon&r=PG", "display_name": "Luis Ortega", "link": "https://stackoverflow.com/users/1829125/luis-ortega"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1489448140, "post_id": 42758064, "comment_id": 72665877, "body": "By the way, I&#39;m a bit worry about the lack of support... even on stack overflow only one good soul got to help me a bit!  no bueno!"}], "owner": {"reputation": 23, "user_id": 1829125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b7bcb54b0a59283f4d21017ce3136f7?s=128&d=identicon&r=PG", "display_name": "Luis Ortega", "link": "https://stackoverflow.com/users/1829125/luis-ortega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1295, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558151820, "creation_date": 1489388595, "last_edit_date": 1558151820, "question_id": 42758064, "link": "https://stackoverflow.com/questions/42758064/cant-find-import-cloud-google-com-go-storage", "title": "can&#39;t find import: &quot;cloud.google.com/go/storage&quot;", "body": "<p>Trying to implement storage api from app engine... I've changed the location of projects and packages a number of times trying to find logic on other answers (from other post), however nothing seems to work.</p>\n\n<p>project folder\n<strong>/Users/luisortega/goLibs/aural9</strong></p>\n\n<p>command for appengine\n<strong>goapp deploy --version=core</strong></p>\n\n<p>echo $GOPATH\n<strong>/Users/luisortega/goLibs</strong></p>\n\n<p>echo $GOROOT\n<strong>/Users/luisortega/go</strong></p>\n\n<p>go env</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/luisortega/goLibs\"\nGORACE=\"\"\nGOROOT=\"/Users/luisortega/go\"\nGOTOOLDIR=\"/Users/luisortega/go/pkg/tool/darwin_amd64\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/var/folders/d3/vjs7zbb91dq160clq9f7pzgr0000gp/T/go-build130074555=/tmp/go-build -gno-record-gcc-switches -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>ls -la $GOPATH/src</p>\n\n<pre><code>total 24\ndrwxr-xr-x   9 luisortega  staff   306 Mar 13 02:28 .\ndrwxr-xr-x   4 luisortega  staff   136 Mar 13 01:42 ..\n-rw-r--r--@  1 luisortega  staff  8196 Mar 13 02:16 .DS_Store\ndrwxr-xr-x   8 luisortega  staff   272 Mar 13 02:45 aural9\ndrwxr-xr-x  11 luisortega  staff   374 Mar 13 01:38 github.com\ndrwxr-xr-x   3 luisortega  staff   102 Feb 13 21:33 golang.org\ndrwxr-xr-x  40 luisortega  staff  1360 Mar 13 02:37 google-cloud-go\ndrwxr-xr-x   3 luisortega  staff   102 Feb 13 21:33 google.golang.org\ndrwxr-xr-x   4 luisortega  staff   136 Mar 13 02:16 sourcegraph.com\n</code></pre>\n\n<p>one important note is that when I imported cloud engine\ngit clone <a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go.git\" rel=\"nofollow noreferrer\">https://github.com/GoogleCloudPlatform/google-cloud-go.git</a></p>\n\n<p>I originally imported while on my project folder (and created the 'google-cloud-go' folder... if I try to compile that way, I end up with the following error.</p>\n\n<p><strong>Failed parsing input: parser: bad import \"syscall\" in google-cloud-go/internal/pretty/diff.go</strong></p>\n\n<p>actual full message...</p>\n\n<pre><code>Traceback (most recent call last):   File \"/Users/luisortega/go_appengine/appcfg.py\", line 133, in &lt;module&gt;\n    run_file(__file__, globals())   File \"/Users/luisortega/go_appengine/appcfg.py\", line 129, in run_file\n    execfile(_PATHS.script_file(script_name), globals_)   File \"/Users/luisortega/go_appengine/google/appengine/tools/appcfg.py\", line 5510, in &lt;module&gt;\n    main(sys.argv)   File \"/Users/luisortega/go_appengine/google/appengine/tools/appcfg.py\", line 5501, in main\n    result = AppCfgApp(argv).Run()   File \"/Users/luisortega/go_appengine/google/appengine/tools/appcfg.py\", line 2975, in Run\n    self.action(self)   File \"/Users/luisortega/go_appengine/google/appengine/tools/appcfg.py\", line 5157, in __call__\n    return method()   File \"/Users/luisortega/go_appengine/google/appengine/tools/appcfg.py\", line 3889, in Update\n    self._UpdateWithParsedAppYaml(appyaml, self.basepath)   File \"/Users/luisortega/go_appengine/google/appengine/tools/appcfg.py\", line 3942, in _UpdateWithParsedAppYaml\n    self.UpdateVersion(rpcserver, basepath, appyaml, APP_YAML_FILENAME)   File \"/Users/luisortega/go_appengine/google/appengine/tools/appcfg.py\", line 3799, in UpdateVersion\n    raise RuntimeError(stderr) RuntimeError: 2017/03/13 02:53:53 go-app-builder: Failed parsing input: parser: bad import \"syscall\" in google-cloud-go/internal/pretty/diff.go\n\nerror while running appcfg.py: exit status 1\n</code></pre>\n\n<p>So I moved the folder to my $GOPATH/src folder...</p>\n\n<p>And then the \n<strong>can't find import: \"cloud.google.com/go/storage\"</strong></p>\n"}, {"tags": ["go", "file-upload", "blob", "go-gorm"], "comments": [{"owner": {"reputation": 589, "user_id": 343747, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/33863eea0f495b84fc01884901df0d74?s=128&d=identicon&r=PG", "display_name": "jiveTurkey", "link": "https://stackoverflow.com/users/343747/jiveturkey"}, "edited": false, "score": 2, "creation_date": 1510624058, "post_id": 42758054, "comment_id": 81503936, "body": "Who was the douche that did a drive-by down vote on this? Its a clear question, with an obvious attempt via the code sample. Question helped me"}], "answers": [{"tags": [], "owner": {"reputation": 824, "user_id": 4412661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aXJT6.jpg?s=128&g=1", "display_name": "Steve C", "link": "https://stackoverflow.com/users/4412661/steve-c"}, "is_accepted": true, "score": 16, "last_activity_date": 1489389549, "creation_date": 1489389549, "answer_id": 42758241, "question_id": 42758054, "link": "https://stackoverflow.com/questions/42758054/read-multipart-form-data-as-byte-in-go/42758241#42758241", "title": "Read multipart-form data as []byte in GO", "body": "<p>multipart.File implements io.Reader interface so you could copy its content into a bytes.Buffer like this:</p>\n\n<pre><code>file, header, err := ctx.Request.FormFile(\"file\")    \ndefer file.Close()\nif err != nil {\n    return nil, err\n}\n\nbuf := bytes.NewBuffer(nil)\nif _, err := io.Copy(buf, file); err != nil {\n    return nil, err\n}\n</code></pre>\n\n<p>and then add to your app</p>\n\n<pre><code>app.SetFile(buf.Bytes())\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 5307464, "user_type": "registered", "profile_image": "https://graph.facebook.com/1680511615519429/picture?type=large", "display_name": "Aji Tirta", "link": "https://stackoverflow.com/users/5307464/aji-tirta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14440, "favorite_count": 2, "accepted_answer_id": 42758241, "answer_count": 1, "score": 8, "last_activity_date": 1527757134, "creation_date": 1489388541, "last_edit_date": 1527757134, "question_id": 42758054, "link": "https://stackoverflow.com/questions/42758054/read-multipart-form-data-as-byte-in-go", "title": "Read multipart-form data as []byte in GO", "body": "<p>I'm using <a href=\"https://github.com/gin-gonic/gin\" rel=\"noreferrer\">GIN</a> as GO framework,  im having an issue when uploading file and directly convert image as byte so i can store it in my BLOB field inside db table, so i have my piece of code like this :</p>\n\n<pre><code>func (a *AppHandler) Upload(ctx *gin.Context) {\n\nform := &amp;struct {\n    Name    string `form:\"name\" validate:\"required\"`\n    Token   string `form:\"token\" validate:\"required\"`\n    AppCode string `form:\"app_code\" validate:\"required\"`\n}{}\nctx.Bind(form)\nif validationErrors := a.ValidationService.ValidateForm(form); validationErrors != nil {\n    httpValidationErrorResponse(ctx, validationErrors)\n    return\n}\n\nfile, header, err := ctx.Request.FormFile(\"file\")\n</code></pre>\n\n<p>and im trying to store it in db like this</p>\n\n<pre><code>app.SetFile(file)\na.AppStore.Save(app)\n</code></pre>\n\n<p>and it returns this kind of error:</p>\n\n<pre><code>cannot use file (type multipart.File) as type []byte \n</code></pre>\n\n<p>so how to fix this? im pretty new with Go language<br>\n NOTE: i'm using <a href=\"https://github.com/jinzhu/gorm\" rel=\"noreferrer\">GORM</a> as well for my db ORM</p>\n"}, {"tags": ["sql-server", "go", "sql-server-2008-r2"], "answers": [{"comments": [{"owner": {"reputation": 608, "user_id": 1368561, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fHj5Q.png?s=128&g=1", "display_name": "mnemotronic", "link": "https://stackoverflow.com/users/1368561/mnemotronic"}, "edited": false, "score": 0, "creation_date": 1489422291, "post_id": 42760391, "comment_id": 72652692, "body": "I edited post with additional server config info.  SQL Browser is running.  Specifying the port doesn&#39;t seem to matter.  I don&#39;t know why NMAP says 1434 is filtered: ` PORT     STATE    SERVICE      VERSION 1433/tcp open     ms-sql-s     Microsoft SQL Server 2008 R2 10.50.1600; RTM 1434/tcp filtered ms-sql-m `"}, {"owner": {"reputation": 25296, "user_id": 2975396, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/33a5374a3c2e22b8895b38f14ef9b845?s=128&d=identicon&r=PG&f=1", "display_name": "TheGameiswar", "link": "https://stackoverflow.com/users/2975396/thegameiswar"}, "reply_to_user": {"reputation": 608, "user_id": 1368561, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fHj5Q.png?s=128&g=1", "display_name": "mnemotronic", "link": "https://stackoverflow.com/users/1368561/mnemotronic"}, "edited": false, "score": 0, "creation_date": 1489422509, "post_id": 42760391, "comment_id": 72652832, "body": "<code>read udp 192.168.91.1:49155-&gt;192.168.91.135:1434</code> why the connection is <code>udp</code>"}, {"owner": {"reputation": 25296, "user_id": 2975396, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/33a5374a3c2e22b8895b38f14ef9b845?s=128&d=identicon&r=PG&f=1", "display_name": "TheGameiswar", "link": "https://stackoverflow.com/users/2975396/thegameiswar"}, "reply_to_user": {"reputation": 608, "user_id": 1368561, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fHj5Q.png?s=128&g=1", "display_name": "mnemotronic", "link": "https://stackoverflow.com/users/1368561/mnemotronic"}, "edited": false, "score": 0, "creation_date": 1489422528, "post_id": 42760391, "comment_id": 72652849, "body": "did you enabled tcp ,are you able to ping the server from outside"}, {"owner": {"reputation": 608, "user_id": 1368561, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fHj5Q.png?s=128&g=1", "display_name": "mnemotronic", "link": "https://stackoverflow.com/users/1368561/mnemotronic"}, "edited": false, "score": 0, "creation_date": 1489423263, "post_id": 42760391, "comment_id": 72653328, "body": "TCP and UDP are enabled on both ports.  npcap doesn&#39;t work on my system so I can&#39;t do an nmap UDP scan.  I don&#39;t allow access to the VM from &quot;outside&quot; my laptop."}], "tags": [], "owner": {"reputation": 25296, "user_id": 2975396, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/33a5374a3c2e22b8895b38f14ef9b845?s=128&d=identicon&r=PG&f=1", "display_name": "TheGameiswar", "link": "https://stackoverflow.com/users/2975396/thegameiswar"}, "is_accepted": false, "score": 0, "last_activity_date": 1489397858, "creation_date": 1489397858, "answer_id": 42760391, "question_id": 42757477, "link": "https://stackoverflow.com/questions/42757477/golang-sql-server-query-via-go-mssqldb/42760391#42760391", "title": "golang SQL Server query via go-mssqldb", "body": "<p>The github repo says below</p>\n\n<blockquote>\n  <p>Ensure that the SQL Server Browser windows service is running and there is no firewall blocking UDP port 1434. This service is used by the driver to get the TCP port of the SQL Server instance</p>\n</blockquote>\n\n<p>Ensure your SQLbrowser service is running on your host..</p>\n\n<p>also you can specify your connection string along with port number(this negates the need of starting SQLBrowser service,if your port is static)</p>\n"}, {"tags": [], "owner": {"reputation": 608, "user_id": 1368561, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fHj5Q.png?s=128&g=1", "display_name": "mnemotronic", "link": "https://stackoverflow.com/users/1368561/mnemotronic"}, "is_accepted": true, "score": 1, "last_activity_date": 1489551157, "creation_date": 1489551157, "answer_id": 42800987, "question_id": 42757477, "link": "https://stackoverflow.com/questions/42757477/golang-sql-server-query-via-go-mssqldb/42800987#42800987", "title": "golang SQL Server query via go-mssqldb", "body": "<p>I found the answer in <a href=\"https://github.com/denisenkom/go-mssqldb/issues/42#issuecomment-45337963\" rel=\"nofollow noreferrer\">a comment by the library author on Github</a>.</p>\n\n<p>Adding the \"encrypt=disable\" to the connection string did it.  I'm downloading the SP3 update for SQL Server 2008 R2 x64 <a href=\"https://github.com/denisenkom/go-mssqldb/issues/42#issuecomment-45217680\" rel=\"nofollow noreferrer\">as suggested here</a> and will install it when I get some time.  As for now though the query works.</p>\n"}], "owner": {"reputation": 608, "user_id": 1368561, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fHj5Q.png?s=128&g=1", "display_name": "mnemotronic", "link": "https://stackoverflow.com/users/1368561/mnemotronic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6071, "favorite_count": 0, "accepted_answer_id": 42800987, "answer_count": 2, "score": 2, "last_activity_date": 1490201292, "creation_date": 1489385212, "last_edit_date": 1489543018, "question_id": 42757477, "link": "https://stackoverflow.com/questions/42757477/golang-sql-server-query-via-go-mssqldb", "title": "golang SQL Server query via go-mssqldb", "body": "<p>I'm trying to query <code>SQL Server 2008 R2</code> using go </p>\n\n<p><a href=\"https://github.com/denisenkom/go-mssqldb\" rel=\"nofollow noreferrer\">https://github.com/denisenkom/go-mssqldb</a>. </p>\n\n<p>The SQL Server 2008 R2 instance is on a VM under Windows Server 2008 R2; I'm doing the development under the Win 7 VMWare host and running the program from there to query the DB on the VM.  The DB has been up and running an app hosted on the server VM.  Code is below.  </p>\n\n<p>The error I'm getting is :</p>\n\n<p>[EDIT 2017-03-14 : new error when I specify port]</p>\n\n<blockquote>\n  <p>Login error: read tcp 192.168.91.1:15222->192.168.91.135:1433: \n  wsarecv: An existing connection was forcibly closed by the remote host.</p>\n</blockquote>\n\n<p>This error is returned when the SQL Server port (1433) is specified.  Including or not including the instance doesn't change it.</p>\n\n<p>SQL Server is configured to allow remote connections, SQL Server Auth, Connection not encrypted, TCP/IP enabled, IPALL port=1433.  Firewall is open for TCP on 80, 443, 1433, 1434; UDP on 1433, 1434.  I was getting a different error until I added the db instance into the connection string.  </p>\n\n<p>The SQL server logs <strong>seem</strong> to indicate that the machines are talking.  The IP addresses are for the VMWare host and the VM.  <strong>The SQL Server Browser service is running</strong> (acct \"Local Service\").  SQL Server Agent is <strong>not</strong> running.  I've tried using ODBC and ADO connection strings and seem to get the same error.  Any help would be appreciated.</p>\n\n<pre><code>package main\nimport (\n   // Import go-mssqldb strictly for side-effects\n   _ \"github.com/denisenkom/go-mssqldb\"\n   \"database/sql\"\n   \"log\"\n)\n\nfunc main() {\n   var n_tables int\n\n   println (sql.Drivers())\n\n   // URL connection string formats\n   //    sqlserver://sa:mypass@localhost?database=master&amp;connection+timeout=30         // username=sa, password=mypass.\n   //    sqlserver://sa:my%7Bpass@somehost?connection+timeout=30                       // password is \"my{pass\"\n   // note: pwd is \"myP@55w0rd\"\n   connectString := \"sqlserver://SBM:myP%4055w0rd@VM17:1433?database=AE&amp;connection+timeout=30\"\n   println(\"Connection string=\" , connectString )\n\n   println(\"open connection\")\n   db, err := sql.Open(\"mssql\", connectString)\n   defer db.Close()\n   println (\"Open Error:\" , err)\n   if err != nil {\n      log.Fatal(err)\n   }\n\n   println(\"count records in TS_TABLES &amp; scan\")\n   err = db.QueryRow(\"Select count(*) from ts_tables\").Scan(&amp;n_tables)\n   if err != nil {\n      log.Fatal(err)\n   }\n   println (\"count of tables\" , n_tables)\n\n   println(\"closing connection\")\n   db.Close()\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>[2/2]0xc042002c20\nConnection string= sqlserver://VM17_SBM:P%4055word@VM17:1433?database=VM17_SBM_AE_OE_REPO_CL&amp;connection+timeout=30\nopen connection\nOpen Error: (0x0,0x0)\ncount records in TS_TABLES &amp; scan\n2017/03/14 19:48:01 Login error: read tcp 192.168.91.1:15222-&gt;192.168.91.135:1433: wsarecv: An existing connection was forcibly closed by the remote host.\nexit status 1\n</code></pre>\n"}, {"tags": ["go", "visual-studio-code", "lint"], "comments": [{"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1489420700, "post_id": 42756142, "comment_id": 72651578, "body": "Try running go imports (For whatever reason some of the go &quot;linters&quot; get fussy about the order of your import statements)"}], "owner": {"reputation": 74019, "user_id": 292291, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e31d9d39e9fb0ec4cc5573a5e5b01ce7?s=128&d=identicon&r=PG", "display_name": "Jiew Meng", "link": "https://stackoverflow.com/users/292291/jiew-meng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 436, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489375264, "creation_date": 1489375264, "question_id": 42756142, "link": "https://stackoverflow.com/questions/42756142/vscode-golint-error-for-glide-vendor-packages", "title": "VSCode/GoLint: Error for glide/vendor packages", "body": "<p>I am using VS Code and its giving me linter errors when importing pacakges from vendor folder (glide installed packages). How can I resolve this? <code>go run</code> works, so theres nothing wrong with the import</p>\n\n<p><a href=\"https://i.stack.imgur.com/LbjjL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LbjjL.png\" alt=\"enter image description here\"></a></p>\n\n<p><em>Notice error importing chi</em></p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 1, "creation_date": 1489377727, "post_id": 42755310, "comment_id": 72628791, "body": "I never expect <code>go</code> to be a typing friendly programming language. Someone call it a <code>if err!=nil</code> language."}], "answers": [{"comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1489409239, "post_id": 42763906, "comment_id": 72643103, "body": "Im aware, so then my second try is optimal in terms logic?  Switching over to a map string wouldn&#39;t change the logic or remove the if statements. What i want to know is if there is a way to match better. Lets say i have 20 toggles. Would i really have to write 20 if statements?"}, {"owner": {"reputation": 1642, "user_id": 1509169, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/8MgOC.jpg?s=128&g=1", "display_name": "Alexander R.", "link": "https://stackoverflow.com/users/1509169/alexander-r"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 1, "creation_date": 1489409768, "post_id": 42763906, "comment_id": 72643465, "body": "You can&#39;t  avoid business logic, so you must use if/switch statement. But you still can write less code to minimize future pain of understanding for you and your colleagues. Moreover, you need to have similar code in an SearchModel structure in an Validate() method to validate data received from user. Next level of optimizing code readability, maintenance and security, instead passing search parameters as function arguments, create structure with this fields, and then pass it to function:   func GetAllHourly(dbsession *mgo.Session, SearchModel search) (items []MassAggregation, err error) {"}], "tags": [], "owner": {"reputation": 1642, "user_id": 1509169, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/8MgOC.jpg?s=128&g=1", "display_name": "Alexander R.", "link": "https://stackoverflow.com/users/1509169/alexander-r"}, "is_accepted": true, "score": 6, "last_activity_date": 1489408900, "creation_date": 1489408900, "answer_id": 42763906, "question_id": 42755310, "link": "https://stackoverflow.com/questions/42755310/is-there-a-better-way-to-create-a-dynamic-match-on-mongo/42763906#42763906", "title": "Is there a better way to create a dynamic match on mongo?", "body": "<p><code>bson.M{}</code> is just named type for <code>map[string]interface{}</code> as you can see in docs: <a href=\"http://godoc.org/labix.org/v2/mgo/bson#M\" rel=\"noreferrer\">http://godoc.org/labix.org/v2/mgo/bson#M</a></p>\n\n<p>So, why don't you just use it as dictionary to build custom query? You'll have much less code:</p>\n\n<pre><code>query := bson.M{}\n\nif site != \"\" {\n       query[\"site\"] = site\n    }\n    if size != \"\" {\n       query[\"size\"] = size\n    }\n\n}\n\n// Then use query variable for querying mongodb\n</code></pre>\n"}], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 989, "favorite_count": 0, "accepted_answer_id": 42763906, "answer_count": 1, "score": 0, "last_activity_date": 1498395787, "creation_date": 1489368481, "last_edit_date": 1498395787, "question_id": 42755310, "link": "https://stackoverflow.com/questions/42755310/is-there-a-better-way-to-create-a-dynamic-match-on-mongo", "title": "Is there a better way to create a dynamic match on mongo?", "body": "<p>I'm in the process of creating a view which shows all types of data.  Currently I'm using tons of if statements to true and create a match parameter for all the different type of request.  I really don't think writing out 120 possible if statements is the best way.. plus its getting hard to keep off.  I'm hoping someone can point in the right direction.  This is what I have so far.</p>\n\n<pre><code>func GetAllHourly(dbsession *mgo.Session, year, month, day, site, size, network, region string, code int) (items []MassAggregation, err error) {\n    defer dbsession.Close()\n    var match bson.M\n    if network == \"openx3\" {\n        network = \"openx\"\n    }\n\n    group := bson.M{\"$group\": bson.M{\"_id\": bson.M{\"aws_region\": \"$aws_region\", \"http_request_status\": \"$http_request_status\", \"hour\": \"$hour\", \"network\": \"$network\", \"site\": \"$site\", \"size\": \"$size\", \"zone\": \"$zone\", \"extra\": \"$extra\"}, \"total\": bson.M{\"$sum\": \"$count\"}}}\n    if site == \"\" &amp;&amp; size == \"\" &amp;&amp; network == \"\" &amp;&amp; region == \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day}}\n    } else if site != \"\" &amp;&amp; size == \"\" &amp;&amp; network == \"\" &amp;&amp; region == \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"site\": site}}\n    } else if site != \"\" &amp;&amp; size != \"\" &amp;&amp; network == \"\" &amp;&amp; region == \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"site\": site, \"size\": size}}\n    } else if site != \"\" &amp;&amp; size != \"\" &amp;&amp; network != \"\" &amp;&amp; region == \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"site\": site, \"size\": size, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}}}\n    } else if site != \"\" &amp;&amp; size != \"\" &amp;&amp; network != \"\" &amp;&amp; region != \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"site\": site, \"size\": size, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}, \"aws_region\": region}}\n    } else if site != \"\" &amp;&amp; size != \"\" &amp;&amp; network != \"\" &amp;&amp; region != \"\" &amp;&amp; code != -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"site\": site, \"size\": size, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}, \"aws_region\": region, \"http_request_status\": code}}\n    } else if site == \"\" &amp;&amp; size != \"\" &amp;&amp; network == \"\" &amp;&amp; region == \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"site\": site, \"size\": size}}\n    } else if site == \"\" &amp;&amp; size != \"\" &amp;&amp; network != \"\" &amp;&amp; region == \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"size\": size, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}}}\n    } else if site == \"\" &amp;&amp; size != \"\" &amp;&amp; network != \"\" &amp;&amp; region != \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"site\": site, \"size\": size, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}, \"aws_region\": region}}\n    } else if site == \"\" &amp;&amp; size == \"\" &amp;&amp; network != \"\" &amp;&amp; region == \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}}}\n    } else if site == \"\" &amp;&amp; size == \"\" &amp;&amp; network != \"\" &amp;&amp; region != \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}, \"aws_region\": region}}\n    } else if site == \"\" &amp;&amp; size == \"\" &amp;&amp; network != \"\" &amp;&amp; region != \"\" &amp;&amp; code != -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}, \"aws_region\": region, \"http_request_status\": code}}\n    } else if site == \"\" &amp;&amp; size == \"\" &amp;&amp; network == \"\" &amp;&amp; region != \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"aws_region\": region}}\n    } else if site == \"\" &amp;&amp; size == \"\" &amp;&amp; network == \"\" &amp;&amp; region != \"\" &amp;&amp; code != -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"aws_region\": region, \"http_request_status\": code}}\n    } else if site == \"\" &amp;&amp; size == \"\" &amp;&amp; network == \"\" &amp;&amp; region == \"\" &amp;&amp; code != -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"http_request_status\": code}}\n    } else if site != \"\" &amp;&amp; size == \"\" &amp;&amp; network == \"\" &amp;&amp; region == \"\" &amp;&amp; code != -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"site\": site, \"http_request_status\": code}}\n    } else if site != \"\" &amp;&amp; size == \"\" &amp;&amp; network == \"\" &amp;&amp; region != \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"site\": site, \"aws_region\": region}}\n    } else if site != \"\" &amp;&amp; size == \"\" &amp;&amp; network != \"\" &amp;&amp; region == \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"site\": site, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}}}\n    } else if site == \"\" &amp;&amp; size != \"\" &amp;&amp; network == \"\" &amp;&amp; region == \"\" &amp;&amp; code != -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"size\": size, \"http_request_status\": code}}\n    } else if site == \"\" &amp;&amp; size != \"\" &amp;&amp; network == \"\" &amp;&amp; region != \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"size\": size, \"aws_region\": region}}\n    } else if site == \"\" &amp;&amp; size != \"\" &amp;&amp; network != \"\" &amp;&amp; region == \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"size\": size, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}}}\n    } else if site == \"\" &amp;&amp; size == \"\" &amp;&amp; network != \"\" &amp;&amp; region == \"\" &amp;&amp; code != -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}, \"http_request_status\": code}}\n    } else if site == \"\" &amp;&amp; size == \"\" &amp;&amp; network != \"\" &amp;&amp; region != \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}, \"aws_region\": region}}\n    } else if site != \"\" &amp;&amp; size != \"\" &amp;&amp; network != \"\" &amp;&amp; region == \"\" &amp;&amp; code != -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}, \"size\": size, \"http_request_status\": code}}\n    } else if site != \"\" &amp;&amp; size != \"\" &amp;&amp; network == \"\" &amp;&amp; region == \"\" &amp;&amp; code != -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"site\": site, \"size\": size, \"http_request_status\": code}}\n    } else if site == \"\" &amp;&amp; size != \"\" &amp;&amp; network != \"\" &amp;&amp; region == \"\" &amp;&amp; code != -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}, \"size\": size, \"http_request_status\": code}}\n    } else if site != \"\" &amp;&amp; size == \"\" &amp;&amp; network != \"\" &amp;&amp; region != \"\" &amp;&amp; code == -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}, \"aws_region\": region, \"site\": site}}\n    } else if site != \"\" &amp;&amp; size == \"\" &amp;&amp; network != \"\" &amp;&amp; region != \"\" &amp;&amp; code != -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}, \"aws_region\": region, \"site\": site, \"http_request_status\": code}}\n    } else if site != \"\" &amp;&amp; size == \"\" &amp;&amp; network == \"\" &amp;&amp; region != \"\" &amp;&amp; code != -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"aws_region\": region, \"site\": site, \"http_request_status\": code}}\n    } else if site == \"\" &amp;&amp; size != \"\" &amp;&amp; network != \"\" &amp;&amp; region != \"\" &amp;&amp; code != -1 {\n        match = bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day, \"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}, \"aws_region\": region, \"size\": size, \"http_request_status\": code}}\n    }\n\n    operations := []bson.M{match, group}\n    err = dbsession.DB(\"logs\").C(\"prod\").Pipe(operations).All(&amp;items)\n    return\n}\n</code></pre>\n\n<p>As you can see it's unruly.. but i haven't found an alternative yet.  I'm hoping I just haven't found the answer.</p>\n\n<p><strong>UPDATE:</strong>  I've changed my approach a bit.  I'm still curious if this is the best way.</p>\n\n<pre><code>func GetAllHourly(dbsession *mgo.Session, year, month, day, site, size, network, region string, code int) (items []MassAggregation, err error) {\n    defer dbsession.Close()\n    matches := []bson.M{bson.M{\"$match\": bson.M{\"year\": year, \"month\": month, \"day\": day}}}\n    if network == \"openx3\" {\n        network = \"openx\"\n    }\n\n    if site != \"\" {\n        matches = append(matches, bson.M{\"$match\": bson.M{\"site\": site}})\n    }\n    if size != \"\" {\n        matches = append(matches, bson.M{\"$match\": bson.M{\"size\": size}})\n    }\n    if region != \"\" {\n        matches = append(matches, bson.M{\"$match\": bson.M{\"aws_region\": region}})\n    }\n    if code != -1 {\n        matches = append(matches, bson.M{\"$match\": bson.M{\"http_request_status\": code}})\n    }\n    if network != \"\" {\n        matches = append(matches, bson.M{\"$match\": bson.M{\"network\": &amp;bson.RegEx{Pattern: network, Options: \"i\"}}})\n    }\n    group := bson.M{\"$group\": bson.M{\"_id\": bson.M{\"aws_region\": \"$aws_region\", \"http_request_status\": \"$http_request_status\", \"hour\": \"$hour\", \"network\": \"$network\", \"site\": \"$site\", \"size\": \"$size\", \"zone\": \"$zone\", \"extra\": \"$extra\"}, \"total\": bson.M{\"$sum\": \"$count\"}}}\n    var operations []bson.M\n    for _, match := range matches {\n        operations = append(operations, match)\n    }\n    operations = append(operations, group)\n    err = dbsession.DB(\"logs\").C(\"prod\").Pipe(operations).All(&amp;items)\n    return\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2103, "user_id": 3162553, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5a4b9cec47f016074898f79d29293d9b?s=128&d=identicon&r=PG&f=1", "display_name": "user3162553", "link": "https://stackoverflow.com/users/3162553/user3162553"}, "edited": false, "score": 2, "creation_date": 1489368124, "post_id": 42755236, "comment_id": 72626682, "body": "Thank you!  I know it might seem simple but coming from dynamic, duck-typed languages hasn&#39;t helped in this regard. This makes a ton of sense. And re-reading the docs again after your explanation makes it seem straightforward."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 10, "last_activity_date": 1489367821, "creation_date": 1489367821, "answer_id": 42755236, "question_id": 42755174, "link": "https://stackoverflow.com/questions/42755174/structuring-local-imports-without-github-in-golang/42755236#42755236", "title": "Structuring local imports without github in golang", "body": "<p>See <a href=\"https://golang.org/doc/code.html\" rel=\"noreferrer\">How to Write Go Code</a>.</p>\n\n<p>Create your directory structure under $GOPATH/src.</p>\n\n<ul>\n<li>$GOPATH\n\n<ul>\n<li>src\n\n<ul>\n<li>practice\n\n<ul>\n<li>models </li>\n<li>routers </li>\n</ul></li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>Import the packages as follows:</p>\n\n<pre><code>import (\n  \"practice/routers\"\n  \"practice/models\"\n  ...\n)\n</code></pre>\n\n<p>Use the imported packages like this:</p>\n\n<pre><code>func main() {\n  http.HandleFunc(\"/a\", models.AHandler)\n  http.HandleFunc(\"/b\", models.BHandler)\n  http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>You do not need to push to github.com, even if you use 'github.com' in the file path.</p>\n\n<p>The main function in the main package is the entry point for the application.  Do not define main functions in packages other than main.</p>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 1, "last_activity_date": 1612636656, "creation_date": 1612636656, "answer_id": 66080524, "question_id": 42755174, "link": "https://stackoverflow.com/questions/42755174/structuring-local-imports-without-github-in-golang/66080524#66080524", "title": "Structuring local imports without github in golang", "body": "<p>I think the other answer is out of date, you dont need to use <code>GOPATH</code> anymore.\nRun:</p>\n<pre><code>go mod init yellow\n</code></pre>\n<p>Then create a file <code>yellow.go</code>:</p>\n<pre><code>package yellow\n\nfunc Mix(s string) string {\n   return s + &quot;Yellow&quot;\n}\n</code></pre>\n<p>Then create a file <code>orange/orange.go</code>:</p>\n<pre><code>package main\nimport &quot;yellow&quot;\n\nfunc main() {\n   s := yellow.Mix(&quot;Red&quot;)\n   println(s)\n}\n</code></pre>\n<p>Then build:</p>\n<pre><code>go build\n</code></pre>\n<p><a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">https://golang.org/doc/code.html</a></p>\n"}], "owner": {"reputation": 2103, "user_id": 3162553, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5a4b9cec47f016074898f79d29293d9b?s=128&d=identicon&r=PG&f=1", "display_name": "user3162553", "link": "https://stackoverflow.com/users/3162553/user3162553"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4117, "favorite_count": 1, "accepted_answer_id": 42755236, "answer_count": 2, "score": 7, "last_activity_date": 1612636656, "creation_date": 1489367276, "last_edit_date": 1489416648, "question_id": 42755174, "link": "https://stackoverflow.com/questions/42755174/structuring-local-imports-without-github-in-golang", "title": "Structuring local imports without github in golang", "body": "<p>I'm building a simple app and after reading the doc on structuring go applications, I'm still confused.</p>\n\n<p>I want this structure:</p>\n\n<ul>\n<li>practice\n\n<ul>\n<li>models (packaged as models)\n\n<ul>\n<li>a</li>\n<li>b</li>\n</ul></li>\n<li>routers (packaged as routers)\n\n<ul>\n<li>a</li>\n<li>b</li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>app.go</p>\n\n<p>Inside of <code>app.go</code>, I have the following:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n\n    // I have tried the following:\n    \"practice/models/a\"\n    \"practice/models/b\"\n    \"practice/models\"\n    \"$GOPATH/practice/models/a\"\n    \"$GOPATH/practice/models/b\"\n    \"$GOPATH/practice/models\"\n    ...\n)\n\nfunc main() {\n    http.HandleFunc(\"/a\", AHandler)\n    http.HandleFunc(\"/b\", BHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>The A and B models look like this:</p>\n\n<pre><code>package models\n\nimport \"net/http\"\n\nfunc AHandler(w http.ResponseWriter, r *http.Request) {\n   // code\n}\n</code></pre>\n\n<p>Two questions:</p>\n\n<ol>\n<li><p>What in the world is the right way to import these files? Do I really have to push them to github in order to be able to reference them? I understand the $GOPATH is the namespace for the entire go workspace on a local machine. My $GOPATH is set to include this directory.</p></li>\n<li><p>Do I need to define a main method inside of these files? Can I just export a single function and have that be the handling function?</p></li>\n</ol>\n\n<p>Thanks.</p>\n\n<p>I have consulted the <a href=\"https://golang.org/doc/articles/wiki/\" rel=\"noreferrer\">docs</a></p>\n"}, {"tags": ["go", "redis", "connection-pooling", "redigo"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1489368394, "post_id": 42754823, "comment_id": 72626744, "body": "I think your guess is correct.  Closing a connection can take an unknown amount of time. It seems unwise to lock all use of the pool for this time."}], "answers": [{"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489375157, "post_id": 42755703, "comment_id": 72628232, "body": "&quot;Close a connection may cost quite a lot time&quot; --- this needs some elaboration. Under the hood it&#39;s implemented as <code>err := c.fd.Close()</code>. Under what circumstances can this be slow?"}, {"owner": {"reputation": 232, "user_id": 7596362, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NjI5T.jpg?s=128&g=1", "display_name": "lorneli", "link": "https://stackoverflow.com/users/7596362/lorneli"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489398588, "post_id": 42755703, "comment_id": 72636749, "body": "@zerkms To be honest, I can&#39;t understand the underlying <code>netFD.Close</code> in net/fd_unix.go. In theory, when tcp terminating normally, each side (client and server) would send FIN and receive ACK from the other. During this time, network latency and packet loss could exist."}], "tags": [], "owner": {"reputation": 232, "user_id": 7596362, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NjI5T.jpg?s=128&g=1", "display_name": "lorneli", "link": "https://stackoverflow.com/users/7596362/lorneli"}, "is_accepted": true, "score": 0, "last_activity_date": 1489411281, "last_edit_date": 1489411281, "creation_date": 1489371761, "answer_id": 42755703, "question_id": 42754823, "link": "https://stackoverflow.com/questions/42754823/redigo-connection-pool-why-release-lock-when-removing-stale-connection/42755703#42755703", "title": "redigo connection pool - Why release lock when removing stale connection", "body": "<p>Close a connection may cost quite a lot time, which will slow down other goroutine waiting on this mutex. As what @Cerise Lim\u00f3n said - It seems unwise to lock all use of the pool for this time.</p>\n\n<p>After unlocking the mutex, one of the waiting goroutines gets the mutex. Although goroutine for <code>get</code> method still needs to remove stale connections, the one for <code>put</code> method can put connection to pool and continue to do other work as soon as possible.</p>\n"}], "owner": {"reputation": 232, "user_id": 7596362, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NjI5T.jpg?s=128&g=1", "display_name": "lorneli", "link": "https://stackoverflow.com/users/7596362/lorneli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1049, "favorite_count": 0, "accepted_answer_id": 42755703, "answer_count": 1, "score": 0, "last_activity_date": 1489411281, "creation_date": 1489364177, "last_edit_date": 1489366535, "question_id": 42754823, "link": "https://stackoverflow.com/questions/42754823/redigo-connection-pool-why-release-lock-when-removing-stale-connection", "title": "redigo connection pool - Why release lock when removing stale connection", "body": "<p>Redigo is a golang client for the redis database. It uses struct <code>Pool</code> to maintain a pool of connections. This struct holds a mutex lock for application putting and getting connection parallelly.</p>\n\n<pre><code>type Pool struct {\n    // ...\n    IdleTimeout time.Duration\n    mu     sync.Mutex\n    // Stack of idleConn with most recently used at the front.\n    idle list.List\n}\n</code></pre>\n\n<p>In its <code>get</code> method, connection pool removes stale (idle timeout) connections firstly. When finding a stale connection, the pool pops it, releases lock, then closes connection, tries to acquire lock again.</p>\n\n<pre><code>func (p *Pool) get() (Conn, error) {\n    p.mu.Lock()\n\n    // Prune stale connections.\n\n    if timeout := p.IdleTimeout; timeout &gt; 0 {\n        for i, n := 0, p.idle.Len(); i &lt; n; i++ {\n            e := p.idle.Back()\n            if e == nil {\n                break\n            }\n            ic := e.Value.(idleConn)\n                if ic.t.Add(timeout).After(nowFunc()) {\n                    break\n                }\n            p.idle.Remove(e)\n            p.release()\n            // Why does pool unlock and try to acquire lock again?\n            p.mu.Unlock()\n            // Close this stale connection.\n            ic.c.Close()\n            p.mu.Lock()\n        }\n    }\n</code></pre>\n\n<p>Why does pool unlock and try to acquire lock again, instead of just unlocking before function returns? I guess closing a connection may cost quite a lot time, which will slow down other goroutine waiting on this mutex. </p>\n\n<p>Here is the whole <a href=\"https://github.com/garyburd/redigo/blob/master/redis/pool.go#L220\" rel=\"nofollow noreferrer\">Pool get method</a></p>\n"}, {"tags": ["string", "go", "escaping"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1489361027, "post_id": 42754307, "comment_id": 72625127, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/34126749/convert-unicode-code-point-to-literal-character-in-go/34127730#34127730\">Convert unicode code point to literal character in Go</a>; and <a href=\"http://stackoverflow.com/questions/36528575/how-to-convert-escape-characters-in-html-tags/36529158#36529158\">How to convert escape characters in HTML tags?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 30317, "user_id": 279776, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9c368b605cfa34be3390a983b6bce441?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/279776/alex"}, "is_accepted": true, "score": 2, "last_activity_date": 1489360733, "creation_date": 1489360733, "answer_id": 42754366, "question_id": 42754307, "link": "https://stackoverflow.com/questions/42754307/how-to-unescape-quoted-octal-strings-in-golang/42754366#42754366", "title": "How to unescape quoted octal strings in Golang?", "body": "<p>Ok I got it</p>\n\n<pre><code> a := `\"\\303\\250\\303\\252\\303\\256\\303\\264\\303\\247\"`\n b, err := strconv.Unquote(a)\n</code></pre>\n"}], "owner": {"reputation": 30317, "user_id": 279776, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9c368b605cfa34be3390a983b6bce441?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/279776/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1354, "favorite_count": 0, "accepted_answer_id": 42754366, "answer_count": 1, "score": -1, "last_activity_date": 1489360733, "creation_date": 1489360253, "question_id": 42754307, "link": "https://stackoverflow.com/questions/42754307/how-to-unescape-quoted-octal-strings-in-golang", "title": "How to unescape quoted octal strings in Golang?", "body": "<p>I have the following string:</p>\n\n<pre><code>`\\303\\250\\303\\252\\303\\256\\303\\264\\303\\247`\n</code></pre>\n\n<p>I need to convert it to</p>\n\n<pre><code>\"\u00e8\u00ea\u00ee\u00f4\u00e7\"\n</code></pre>\n\n<p>How can I do that?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "goroutine", "channels"], "answers": [{"tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": false, "score": 1, "last_activity_date": 1489352830, "creation_date": 1489352830, "answer_id": 42753167, "question_id": 42753067, "link": "https://stackoverflow.com/questions/42753067/goroutine-parallel-execution-confirmation/42753167#42753167", "title": "Goroutine parallel execution confirmation", "body": "<p>Generally speaking, if you want to know whether goroutines are operating in parallel, you should <a href=\"https://www.goinggo.net/2015/02/scheduler-tracing-in-go.html\" rel=\"nofollow noreferrer\">trace the scheduler</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 0, "creation_date": 1489353951, "post_id": 42753341, "comment_id": 72622887, "body": "I can certainly pass it as an argument to the goroutine, I&#39;ll definitely change the code.  I added the channels because the main function was exiting before the goroutines had time to finish. What <i>should</i> I be doing here? A playground link would be great, I only understand the concepts when I see them live visualized :("}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "reply_to_user": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 0, "creation_date": 1489354171, "post_id": 42753341, "comment_id": 72622957, "body": "How about if you print the status within the goroutine function? To wait for the goroutines to finish, you can use <code>sync.WaitGroup</code>. I&#39;ll put this in my answer."}, {"owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 0, "creation_date": 1489354744, "post_id": 42753341, "comment_id": 72623136, "body": "Brilliant, exactly what I was looking for! I&#39;m going to accept the answer, but, it would be great to get an explanation of your comment: &quot;Instead, you should wait for the results on the channel outside the for loop after all the goroutines have been started&quot; and how do it that way as well!"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "reply_to_user": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 1, "creation_date": 1489355933, "post_id": 42753341, "comment_id": 72623517, "body": "If you wait for results on the channel inside the loop, you will run in lockstep with the goroutines you create. In other words, you&#39;ll start one goroutine and wait for it to send the result on the channel before starting the next goroutine, so they will run one at a time. After the for loop, you can read the channel in a for loop that executes once for each host."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 3, "last_activity_date": 1489354453, "last_edit_date": 1489354453, "creation_date": 1489353802, "answer_id": 42753341, "question_id": 42753067, "link": "https://stackoverflow.com/questions/42753067/goroutine-parallel-execution-confirmation/42753341#42753341", "title": "Goroutine parallel execution confirmation", "body": "<p>You are only running one goroutine at a time, because the main goroutine is waiting on the channel before continuing with the next iteration of the loop. Instead, you should wait for the results on the channel outside the for loop after all the goroutines have been started. By the way, you'll need to send something identifying the host on the channel as well.</p>\n\n<p>By the way, you have a potential problem in your goroutine function. You're using the variable <code>h</code>, which is being changed by the main goroutine each time through the loop, so you don't really know what you're getting in the other goroutines (assuming you take care of the problem I mentioned above so that the goroutines do run in parallel). Instead of referencing that variable directly, you should pass it as an argument to the goroutine function (or you can create a different variable inside the for loop and assign it the value of <code>h</code>and use that variable inside the function).</p>\n\n<p>Try doing it like this:</p>\n\n<pre><code>var wg sync.WaitGroup\nfor _, h := range hosts {\n    h := h // create local copy of loop var\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n        httpClient := cleanhttp.DefaultPooledClient()\n\n        // format the URL with the passed host and por\n        url := fmt.Sprintf(\"https://%s:%v\", h.Name, h.Port)\n        // create a vault client\n        client, err := api.NewClient(&amp;api.Config{Address: url, HttpClient: httpClient})\n        if err != nil {\n            panic(err)\n        }\n        // get the current status\n        status := v.VaultStatus(client)\n\n        // print it\n        fmt.Printf(\"Host: %s Status:  %v\\n\", h.Name, status.Ready)\n\n    }()\n}\nwg.Wait()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": false, "score": 1, "last_activity_date": 1489356950, "creation_date": 1489356950, "answer_id": 42753850, "question_id": 42753067, "link": "https://stackoverflow.com/questions/42753067/goroutine-parallel-execution-confirmation/42753850#42753850", "title": "Goroutine parallel execution confirmation", "body": "<p>Assuming you have a:</p>\n\n<pre><code>type Status struct {\n  URL   string\n  Ready bool\n}\n</code></pre>\n\n<p>And <code>s</code> initialized as:</p>\n\n<pre><code>s := make(chan Status)\n</code></pre>\n\n<p>Then you could write:</p>\n\n<pre><code>var wg sync.WaitGroup\nfor _, h := range hosts {\n  h := h\n  wg.Add(1)\n  go func() {\n    defer wg.Done()\n    httpClient := cleanhttp.DefaultPooledClient()\n\n    // format the URL with the passed host and por\n    url := fmt.Sprintf(\"https://%s:%v\", h.Name, h.Port)\n    // create a vault client\n    client, err := api.NewClient(&amp;api.Config{Address: url, HttpClient: httpClient})\n    if err != nil {\n      panic(err)\n    }\n    // get the current status\n    status := v.VaultStatus(client)\n\n    // send the status to the channel\n    s &lt;- Status{url, status.Ready}\n\n  }()\n}\n// this goroutine's job is closing s after all above goroutines have finished\ngo func() {\n  wg.Wait()\n  close(s) // so the following loop does not block after reading all statuses\n}()\nfor st := range s {\n    // here you could collect all statuses in a []Status or something\n    // for simplicity, just print them as you did\n    fmt.Printf(\"Host: %s Status: %v\\n\", st.URL, st.Ready)\n}\n</code></pre>\n"}], "owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 0, "accepted_answer_id": 42753341, "answer_count": 3, "score": 0, "last_activity_date": 1489398760, "creation_date": 1489352173, "last_edit_date": 1489398760, "question_id": 42753067, "link": "https://stackoverflow.com/questions/42753067/goroutine-parallel-execution-confirmation", "title": "Goroutine parallel execution confirmation", "body": "<p>I'm new to goroutines, channels and the likes so apologies if this seems trivial.</p>\n\n<p>I've written the following code:</p>\n\n<pre><code>for _, h := range hosts {\n\n      go func() {\n        httpClient := cleanhttp.DefaultPooledClient()\n\n        // format the URL with the passed host and por\n        url := fmt.Sprintf(\"https://%s:%v\", h.Name, h.Port)\n        // create a vault client\n        client, err := api.NewClient(&amp;api.Config{Address: url, HttpClient: httpClient})\n        if err != nil {\n          panic(err)\n        }\n        // get the current status\n        status := v.VaultStatus(client)\n\n        // send the status to a channel\n        s &lt;- strconv.FormatBool(status.Ready)\n\n      }()\n\n      // assign the value of channel to a var\n      cs := &lt;-s\n\n      // print it\n      fmt.Printf(\"Host: %s Status:  %s\\n\", h.Name, cs)\n\n    }\n  }, \n</code></pre>\n\n<p>The idea is simple, it takes a list of hosts and then uses the Golang Vault API to go and determine the current status. I'm happy enough that it works.</p>\n\n<p>What'd I'd like to do is ensure these operations happen in parallel. When I run the following code, I get the results as follows:</p>\n\n<pre><code>host: Host1: status: true\nhost: Host2: status: false\nhost: Host3: status: true\nhost: Host4: status: true\n</code></pre>\n\n<p>The issue here is that these hosts are <em>always</em> returned in the same order. I don't think the goroutines are executing in parallel at all, as they appear to operate one after the other and then get printed in the same order every time.</p>\n\n<p>Is the code doing what I think it should? How can I <em>know</em> this goroutine is operating in parallel?</p>\n"}, {"tags": ["go", "concurrency", "main", "goroutine"], "comments": [{"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 1, "creation_date": 1489350783, "post_id": 42752705, "comment_id": 72621781, "body": "<a href=\"https://nathanleclaire.com/blog/2014/02/15/how-to-wait-for-all-goroutines-to-finish-executing-before-continuing/\" rel=\"nofollow noreferrer\">this blogpost</a> captures different approaches. 1. using a channel that goroutines write to and main reads from, 2. using <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\">sync.WaitGroup</a>. There&#39;s also <a href=\"http://stackoverflow.com/a/18601301/1520594\">this s/o answer</a> for reference."}, {"owner": {"reputation": 6566, "user_id": 3785777, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/pGH0T.jpg?s=128&g=1", "display_name": "luqo33", "link": "https://stackoverflow.com/users/3785777/luqo33"}, "reply_to_user": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 0, "creation_date": 1489351526, "post_id": 42752705, "comment_id": 72622077, "body": "@algrebe As noted by the article&#39;s reviewer and seconded by the author himself - both approaches described in the article originally are &quot;dangerously inaccurate&quot; so they cannot really constitute an answer to this question."}], "answers": [{"comments": [{"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 0, "creation_date": 1489352237, "post_id": 42753005, "comment_id": 72622347, "body": "Do you think it&#39;s a better approach using <code>var wg = &amp;sync.WaitGroup{}</code> like you did or passing <code>wg</code> as a reference as I made in my snippet? If the first one, can you explain? Pretty curious about that."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 2, "creation_date": 1489352326, "post_id": 42753005, "comment_id": 72622380, "body": "@AndreaM16 I used a global var here for simplicity. If complexity of your code / package increases, or you use multiple waitgroups concurrently, then the global variable might not be viable or might make things more complicated than it should be. See edited answer."}, {"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 0, "creation_date": 1489352750, "post_id": 42753005, "comment_id": 72622525, "body": "Thanks @icza also for sc2gears, used it a lot back in the days. Sorry if off topic."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 21, "last_activity_date": 1607505777, "last_edit_date": 1607505777, "creation_date": 1489351914, "answer_id": 42753005, "question_id": 42752705, "link": "https://stackoverflow.com/questions/42752705/prevent-the-main-function-from-terminating-before-goroutines-finish-in-golang/42753005#42753005", "title": "Prevent the main() function from terminating before goroutines finish in Golang", "body": "<p>Simplest, cleanest and &quot;scalable&quot; way to do it is to use a <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\"><code>sync.WaitGroup</code></a>:</p>\n<pre><code>var wg = &amp;sync.WaitGroup{}\n\nfunc printElo() {\n    defer wg.Done()\n    fmt.Printf(&quot;Elo\\n&quot;)\n}\n\nfunc printHello() {\n    defer wg.Done()\n    fmt.Printf(&quot;Hello\\n&quot;)\n}\n\nfunc main() {\n    fmt.Printf(&quot;This will print.&quot;)\n    i := 0\n    for i &lt; 10 {\n        wg.Add(1)\n        go printElo()\n        wg.Add(1)\n        go printHello()\n        i++\n    }\n    wg.Wait()\n}\n</code></pre>\n<p>Output (try it on the <a href=\"https://play.golang.org/p/6L64RRPEW1\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n<pre><code>This will print.Hello\nElo\nHello\nElo\nHello\nElo\nHello\nElo\nHello\nElo\nHello\nElo\nHello\nElo\nHello\nElo\nHello\nElo\nHello\nElo\n</code></pre>\n<p>Simple &quot;rules&quot; to follow when doing it with <code>sync.WaitGroup</code>:</p>\n<ul>\n<li>call <a href=\"https://golang.org/pkg/sync/#WaitGroup.Add\" rel=\"nofollow noreferrer\"><code>WaitGroup.Add()</code></a> in the &quot;original&quot; goroutine (that starts a new) before the <a href=\"https://golang.org/ref/spec#Go_statements\" rel=\"nofollow noreferrer\"><code>go</code></a> statement</li>\n<li>recommended to call <a href=\"https://golang.org/pkg/sync/#WaitGroup.Done\" rel=\"nofollow noreferrer\"><code>WaitGroup.Done()</code></a> deferred, so it gets called even if the goroutine panics</li>\n<li>if you want to pass <code>WaitGroup</code> to other functions (and not use a package level variable), you must pass a pointer to it, else the <code>WaitGroup</code> (which is a struct) would be copied, and the <code>Done()</code> method called on the copy wouldn't be observed on the original</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1642, "user_id": 1509169, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/8MgOC.jpg?s=128&g=1", "display_name": "Alexander R.", "link": "https://stackoverflow.com/users/1509169/alexander-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1489352044, "creation_date": 1489352044, "answer_id": 42753037, "question_id": 42752705, "link": "https://stackoverflow.com/questions/42752705/prevent-the-main-function-from-terminating-before-goroutines-finish-in-golang/42753037#42753037", "title": "Prevent the main() function from terminating before goroutines finish in Golang", "body": "<p>If you want just to play with results you can use \"hack\" with waiting for input:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"bufio\"\n    \"os\"\n)\n\nfunc printElo() {\n    fmt.Printf(\"Elo\\n\")\n}\n\nfunc printHello() {\n    fmt.Printf(\"Hello\\n\")\n}\n\nfunc main() {\n    fmt.Printf(\"This will print.\")\n    i := 0\n    for i &lt; 10 {\n        go printElo()\n        go printHello()\n        i++\n    }\n\n    reader := bufio.NewReader(os.Stdin)\n    reader.ReadString('\\n')\n}\n</code></pre>\n\n<p>If want to learn how to do synchronization read about sync package:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nvar wg sync.WaitGroup\n\nfunc printElo() {\n    fmt.Printf(\"Elo\\n\")\n    wg.Done()\n}\n\nfunc printHello() {\n    fmt.Printf(\"Hello\\n\")\n    wg.Done()\n}\n\nfunc main() {\n\n    fmt.Printf(\"This will print.\")\n    i := 0\n    for i &lt; 10 {\n        wg.Add(2)\n        go printElo()\n        go printHello()\n        i++\n    }\n\n    wg.Wait()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "is_accepted": false, "score": 2, "last_activity_date": 1489352050, "creation_date": 1489352050, "answer_id": 42753039, "question_id": 42752705, "link": "https://stackoverflow.com/questions/42752705/prevent-the-main-function-from-terminating-before-goroutines-finish-in-golang/42753039#42753039", "title": "Prevent the main() function from terminating before goroutines finish in Golang", "body": "<p>You can use <a href=\"https://golang.org/pkg/sync/\" rel=\"nofollow noreferrer\">sync package</a> and take a look at <code>waitgroups</code>. You can take a look at a working <a href=\"https://play.golang.org/p/du2Pv04HKz\" rel=\"nofollow noreferrer\">Goplayground I set up.</a></p>\n\n<p>Essentially</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    )\n\n//Takes a reference to the wg and sleeps when work is done\nfunc printElo(wg *sync.WaitGroup) {\n    fmt.Printf(\"Elo\\n\")\n    defer wg.Done()\n}\n\n//Takes a reference to the wg and sleeps when work is done\nfunc printHello(wg *sync.WaitGroup) {\n    fmt.Printf(\"Hello\\n\")\n    defer wg.Done()\n}\n\nfunc main() {\n    //Create a new WaitGroup\n    var wg sync.WaitGroup\n    fmt.Println(\"This will print.\")\n\n    for  i := 0; i &lt; 10; i++ {\n        //Add a new entry to the waitgroup\n        wg.Add(1)\n        //New Goroutine which takes a reference to the wg\n        go printHello(&amp;wg)\n        //Add a new entry to the waitgroup\n        wg.Add(1)\n        //New Goroutine which takes a reference to the wg\n        go printElo(&amp;wg)\n    }\n    //Wait until everything is done\n    wg.Wait()\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 402, "user_id": 5999876, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh6.googleusercontent.com/-dvp3atWOjTQ/AAAAAAAAAAI/AAAAAAAAAaE/ri-ebmLz1dA/photo.jpg?sz=128", "display_name": "Dowland Aiello", "link": "https://stackoverflow.com/users/5999876/dowland-aiello"}, "edited": false, "score": 5, "creation_date": 1546912897, "post_id": 42761813, "comment_id": 95001883, "body": "For the love of god, never EVER do this. Just spent the last 4 days trying to debug a program that was using over 200% CPU. This was it."}, {"owner": {"reputation": 3156, "user_id": 1881299, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/15aa1fe0f3f66d32d933a1151d92b70c?s=128&d=identicon&r=PG", "display_name": "nicky_zs", "link": "https://stackoverflow.com/users/1881299/nicky-zs"}, "reply_to_user": {"reputation": 402, "user_id": 5999876, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh6.googleusercontent.com/-dvp3atWOjTQ/AAAAAAAAAAI/AAAAAAAAAaE/ri-ebmLz1dA/photo.jpg?sz=128", "display_name": "Dowland Aiello", "link": "https://stackoverflow.com/users/5999876/dowland-aiello"}, "edited": false, "score": 0, "creation_date": 1577760713, "post_id": 42761813, "comment_id": 105247968, "body": "@DowlandAiello Why?"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 3, "last_activity_date": 1489402350, "creation_date": 1489402350, "answer_id": 42761813, "question_id": 42752705, "link": "https://stackoverflow.com/questions/42752705/prevent-the-main-function-from-terminating-before-goroutines-finish-in-golang/42761813#42761813", "title": "Prevent the main() function from terminating before goroutines finish in Golang", "body": "<p>As already mentioned <code>sync.WaitGroup</code> is a right way in production code. But when developing for test and debug purposes you can just add <code>select{}</code> statement at the end or the <code>main()</code>.</p>\n\n<pre><code>func main(){\n    go routine()\n    ...\n    select{}\n}\n</code></pre>\n\n<p><code>main()</code> then never returns and you would kill it with for example <code>Ctrl-C</code>. It isn't idiomatic, never used in production, but just very quick easy hack when developing.</p>\n"}], "owner": {"reputation": 6566, "user_id": 3785777, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/pGH0T.jpg?s=128&g=1", "display_name": "luqo33", "link": "https://stackoverflow.com/users/3785777/luqo33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6683, "favorite_count": 1, "accepted_answer_id": 42753005, "answer_count": 4, "score": 14, "last_activity_date": 1607505777, "creation_date": 1489350518, "last_edit_date": 1489352579, "question_id": 42752705, "link": "https://stackoverflow.com/questions/42752705/prevent-the-main-function-from-terminating-before-goroutines-finish-in-golang", "title": "Prevent the main() function from terminating before goroutines finish in Golang", "body": "<p>Have  loook at this contrived example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc printElo() {\n    fmt.Printf(\"Elo\\n\")\n}\n\nfunc printHello() {\n    fmt.Printf(\"Hello\\n\")\n}\n\nfunc main() {\n    fmt.Printf(\"This will print.\")\n    i := 0\n    for i &lt; 10 {\n        go printElo()\n        go printHello()\n        i++\n    }\n}\n</code></pre>\n\n<p>The output of this program would be just \"This will print\". Output of goroutines <code>printElo()</code> and <code>printHello</code> will not be emitted because, I guess, the <code>main()</code> function thread will finish before the goroutines have a chance to even start executing.</p>\n\n<p>What is the idiomatic way to make similar code work in Golang and not terminate prematurely?</p>\n"}, {"tags": ["for-loop", "go", "slice"], "comments": [{"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1489349781, "post_id": 42752500, "comment_id": 72621375, "body": "And what is your question ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7014993"}, "reply_to_user": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1489349829, "post_id": 42752500, "comment_id": 72621393, "body": "what&#39;s the best way to pluck an element from slice"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1489350695, "post_id": 42752500, "comment_id": 72621741, "body": "Are you attempting to remove a single element? The one being at index <code>index</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7014993"}, "edited": false, "score": 0, "creation_date": 1489350960, "post_id": 42752500, "comment_id": 72621853, "body": "yes single element only and breaking after that"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1489351566, "last_edit_date": 1489351566, "creation_date": 1489351225, "answer_id": 42752871, "question_id": 42752500, "link": "https://stackoverflow.com/questions/42752500/idiomatic-splice-in-go/42752871#42752871", "title": "Idiomatic Splice in Go", "body": "<p>The high index in a <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow noreferrer\">slice expression</a> is <strong>exclusive</strong>.</p>\n\n<p>This means your example is flawed, and also that no special treatment is required.</p>\n\n<p>The correct slicing expression is:</p>\n\n<pre><code>elements = append(elements[:index], elements[index+1:]...)\n</code></pre>\n\n<p>If <code>index</code> is the first element (<code>0</code>), then <code>elements[:0]</code> will be an empty slice.</p>\n\n<p>If <code>index</code> is the last element (<code>len-1</code>), then <code>elements[index+1:]</code> will also be an empty slice, as <code>index+1</code> will be equal to the lenght of the slice. So the solution is simply:</p>\n\n<pre><code>for index, element := range elements {\n    if element.Compare() {\n        elements = append(elements[:index], elements[index+1:]...)\n        break\n    }\n}\n</code></pre>\n\n<p>To demonstrate it on the Go Playground, let's substitute the <code>Compare()</code> method with a simple index check:</p>\n\n<pre><code>for _, idxToRemove := range []int{0, 2, 4} {\n    s := []int{0, 1, 2, 3, 4}\n    for i := range s {\n        if i == idxToRemove {\n            s = append(s[:i], s[i+1:]...)\n            break\n        }\n    }\n    fmt.Println(idxToRemove, \":\", s)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/hA8J-cTsVg\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>0 : [1 2 3 4]\n2 : [0 1 3 4]\n4 : [0 1 2 3]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1489355122, "creation_date": 1489355122, "answer_id": 42753578, "question_id": 42752500, "link": "https://stackoverflow.com/questions/42752500/idiomatic-splice-in-go/42753578#42753578", "title": "Idiomatic Splice in Go", "body": "<p>If the slice <code>s</code> is sorted and <code>len(s)</code> is large, find <code>x</code> using a binary search. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n)\n\nfunc pluck(s []string, x string) []string {\n    i := sort.SearchStrings(s, x)\n    if i &gt;= 0 &amp;&amp; i &lt; len(s) &amp;&amp; s[i] == x {\n        s = append(s[:i], s[i+1:]...)\n    }\n    return s\n}\n\nfunc main() {\n    s := []string{\"a\", \"b\", \"c\", \"d\"}\n    fmt.Println(s)\n    s = pluck(s, \"b\")\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[a b c d]\n[a c d]\n</code></pre>\n\n<p>If the order of slice <code>s</code> does not need to be preserved, switch elements. For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc pluck(s []string, x string) []string {\n    for i, v := range s {\n        if v == x {\n            s[i] = s[len(s)-1]\n            s = s[:len(s)-1]\n            break\n        }\n    }\n    return s\n}\n\nfunc main() {\n    s := []string{\"a\", \"b\", \"c\", \"d\"}\n    fmt.Println(s)\n    s = pluck(s, \"b\")\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[a b c d]\n[a d c]\n</code></pre>\n\n<p>Otherwise, splice slice <code>s</code> elements. For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc pluck(s []string, x string) []string {\n    for i, v := range s {\n        if v == x {\n            s = append(s[:i], s[i+1:]...)\n            break\n        }\n    }\n    return s\n}\n\nfunc main() {\n    s := []string{\"a\", \"b\", \"c\", \"d\"}\n    fmt.Println(s)\n    s = pluck(s, \"b\")\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[a b c d]\n[a c d]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7014993"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1559, "favorite_count": 2, "accepted_answer_id": 42752871, "answer_count": 2, "score": 1, "last_activity_date": 1489355122, "creation_date": 1489349385, "last_edit_date": 1495542317, "question_id": 42752500, "link": "https://stackoverflow.com/questions/42752500/idiomatic-splice-in-go", "title": "Idiomatic Splice in Go", "body": "<p>I checked an existing <a href=\"https://stackoverflow.com/questions/13544374/idiomatic-slice-splice-in-go\">answer</a> but it's not similar to my case.</p>\n\n<p>I need to pluck an element at the index and break out of the <code>for</code> loop at runtime based on <code>Compare</code> function.</p>\n\n<p>Issues:\nIf element to pluck is found at <code>0</code> <code>index</code>, <code>index-1</code> will throw slice bounds of range error and similarly if <code>index+1</code> is greater than <code>len(elements)</code>.</p>\n\n<p>Question: What's the best concise way to achieve the above?</p>\n\n<pre><code>for index, element := range elements {\n    if element.Compare() == true {\n        elements = append(elements[:index-1], elements[index+1:]...)\n        break\n    }\n}\n</code></pre>\n\n<p><strong>Attempt</strong></p>\n\n<pre><code>for index, element := range elements {\n    if element.Compare() == true {\n        if len(elements) &gt; 1 {\n            elements = append(elements[:index-1], elements[index+1:]...)\n        } else if len(elements) == 1 {\n            delete(elements, 0)\n        }\n        break\n    }\n}\n</code></pre>\n\n<p><strong>Attempt 2</strong>  <a href=\"https://play.golang.org/p/XzMircxnKP\" rel=\"nofollow noreferrer\">Playground</a> any improvements/suggestions?</p>\n\n<p>The idea is to copy the remaining elements from beginning to index and then any elements after.</p>\n\n<pre><code>var elements = []string {\"a\", \"b\", \"c\", \"d\"}\nfmt.Println(elements)\nfor index, element := range elements {\n    if element == \"c\" {\n        var temp = elements[:index]\n        for i := index + 1; i&lt;len(elements); i++ {\n            temp = append(temp, elements[i])\n        }\n        elements = temp\n        break\n    }\n}\nfmt.Println(elements)\n</code></pre>\n"}, {"tags": ["debugging", "go", "goland"], "comments": [{"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1489691362, "post_id": 42752485, "comment_id": 72794596, "body": "Do you have an existing run configuration active when you are trying this?"}, {"owner": {"reputation": 3749, "user_id": 145347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81a6e246a4414b2962767fe644ce2316?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/145347/stefan"}, "reply_to_user": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1489732604, "post_id": 42752485, "comment_id": 72808854, "body": "Not sure what you mean by &quot;active&quot;. One is selected."}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1489760848, "post_id": 42752485, "comment_id": 72826241, "body": "Yes, that&#39;s it. What type of configuration is that? Go Single File? Go Application? Another? A screenshot or anything more detailed out help a lot to reproduce / help with this. Thank you."}, {"owner": {"reputation": 3749, "user_id": 145347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81a6e246a4414b2962767fe644ce2316?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/145347/stefan"}, "reply_to_user": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1489806257, "post_id": 42752485, "comment_id": 72845850, "body": "I&#39;ve added the screenshots. I was using &quot;Go Single File&quot;. It seems to be working with &quot;Go Application&quot;. If you add an answer, I&#39;ll accept. Thanks for poining me in the right direction."}], "answers": [{"tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 3, "last_activity_date": 1489871158, "creation_date": 1489871158, "answer_id": 42879880, "question_id": 42752485, "link": "https://stackoverflow.com/questions/42752485/gogland-debugging-is-grayed-out/42879880#42879880", "title": "Gogland: debugging is grayed out", "body": "<p>Go Single File does not currently support debugging. If such a Run Configuration is active then a new one must be created. The type for the new one must be Go Application.</p>\n\n<p>To create a Go Application Run Configuration you can also choose: Build and run ... from the menu when presented with the option.</p>\n\n<p>Also changing the current active Run Configuration from a Go Single File to a Go Application one will fix the problem.</p>\n"}], "owner": {"reputation": 3749, "user_id": 145347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81a6e246a4414b2962767fe644ce2316?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/145347/stefan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 921, "favorite_count": 2, "accepted_answer_id": 42879880, "answer_count": 1, "score": 2, "last_activity_date": 1489871158, "creation_date": 1489349319, "last_edit_date": 1489806152, "question_id": 42752485, "link": "https://stackoverflow.com/questions/42752485/gogland-debugging-is-grayed-out", "title": "Gogland: debugging is grayed out", "body": "<p>I can't seem to get the debugger to run. The debugging run icon is grayed out and the menu options are missing.</p>\n\n<p><a href=\"https://i.stack.imgur.com/M7ebe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M7ebe.png\" alt=\"Toolbar\"></a></p>\n\n<p>This is only the case for <code>main</code>, I can debug unit tests just fine.</p>\n\n<p>Similar questions mention the project structure, but I can't see anything wrong:</p>\n\n<pre><code>$GOPATH/src/foo.bar.com/some/more/dirs/\n      project/    &lt;-- this directory is opened in Gogland\n         app1/\n            main.go\n         app2/\n            main.go\n         mylib/\n            abc.go\n            abc_test.go\n</code></pre>\n\n<p>I can right click on <code>abc_test.go</code> and run it with or without debugging, but if I right click on one of the <code>main.go</code> files, I can only run it.</p>\n\n<p>Run configuration:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vcFxd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vcFxd.png\" alt=\"run configuration\"></a></p>\n\n<p>Gogland build 162.12024.32</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1489346145, "post_id": 42751814, "comment_id": 72620020, "body": "I don&#39;t understand your code, but I would guess that the channel is blocking go routine. If you put something in a unbuffered channel the goroutine waits until the receiver gets the data from the channel. In your case your routine blocks at <code>register &lt;- worker</code> and defer wg.Done() is never called."}, {"owner": {"reputation": 69, "user_id": 3605702, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aa8c1edb2bec51a8a955887240f0be58?s=128&d=identicon&r=PG&f=1", "display_name": "miro", "link": "https://stackoverflow.com/users/3605702/miro"}, "reply_to_user": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1489346764, "post_id": 42751814, "comment_id": 72620244, "body": "thanks  a lot the problem solved when i add register &lt;- worker in go routine"}, {"owner": {"reputation": 32876, "user_id": 2943403, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RDzQY.jpg?s=128&g=1", "display_name": "mickmackusa", "link": "https://stackoverflow.com/users/2943403/mickmackusa"}, "reply_to_user": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1489384523, "post_id": 42751814, "comment_id": 72630383, "body": "@apxp please post your comment as an answer so it can be accepted and the question will be deemed answered."}], "answers": [{"tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": true, "score": 3, "last_activity_date": 1489386386, "creation_date": 1489386386, "answer_id": 42757675, "question_id": 42751814, "link": "https://stackoverflow.com/questions/42751814/golang-sync-waitgroup-never-finishes/42757675#42757675", "title": "golang sync.WaitGroup never finishes", "body": "<p>The channel is blocking your goroutine. If you put some data into a unbuffered channel the goroutine waits until the receiver gets the the data from the channel. In your case your routine blocks at <code>register &lt;- worker</code> and <code>defer wg.Done()</code> is never called, because the function is waiting.</p>\n"}], "owner": {"reputation": 69, "user_id": 3605702, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aa8c1edb2bec51a8a955887240f0be58?s=128&d=identicon&r=PG&f=1", "display_name": "miro", "link": "https://stackoverflow.com/users/3605702/miro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1292, "favorite_count": 0, "accepted_answer_id": 42757675, "answer_count": 1, "score": 1, "last_activity_date": 1489393616, "creation_date": 1489345584, "last_edit_date": 1489393616, "question_id": 42751814, "link": "https://stackoverflow.com/questions/42751814/golang-sync-waitgroup-never-finishes", "title": "golang sync.WaitGroup never finishes", "body": "<p>the below code that get worker from channel and execute function \"call\", all routines finish and print that they are done but wait never finishes,\ni traced the counter of WaitGroup by making varible counter incresing when add to wg and decresing when done and it was zero at the end of for loop\nany help please</p>\n\n<pre><code>package mapreduce\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc schedule(jobName string, mapFiles []string, nReduce int, phase jobPhase, registerChan chan string) {\n    var ntasks int\n    var n_other int // number of inputs (for reduce) or outputs (for map)\n    switch phase {\n    case mapPhase:\n        ntasks = len(mapFiles)\n        n_other = nReduce\n    case reducePhase:\n        ntasks = nReduce\n        n_other = len(mapFiles)\n\n    }\n\n    fmt.Printf(\"Schedule: %v %v tasks (%d I/Os)\\n\", ntasks, phase, n_other)\n    var wg sync.WaitGroup\n    for i := 0; i &lt; ntasks; i++ {\n        worker := &lt;-registerChan\n        doTaskArg := DoTaskArgs{jobName, mapFiles[i], phase, i, n_other}\n        wg.Add(1)\n        go func() {\n            defer wg.Done()\n\n            done := call(worker, \"Worker.DoTask\", doTaskArg, nil)\n            if done {\n                registerChan &lt;- worker\n            } else {\n                i = i - 1\n            }\n\n        }()\n    }\n\n    wg.Wait()\n\n    fmt.Printf(\"Schedule: %v phase done\\n\", phase)\n}\n</code></pre>\n"}, {"tags": ["pointers", "go", "getter-setter"], "comments": [{"owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1489343810, "post_id": 42751274, "comment_id": 72619172, "body": "so I guess it&#39;s better to use pointer types all across both for getting and setting in order to be efficient and consistent, do you agree?"}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1489343867, "post_id": 42751274, "comment_id": 72619194, "body": "Accessing the non-pointer value, thereby creating a copy, makes it safe for concurrent access. E.g. channels."}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1489343939, "post_id": 42751274, "comment_id": 72619214, "body": "Also, FYI, Golang convention is to NOT prefix getters with Get. Just call it <code>Foo.Body()</code> with <code>Foo.SetBody()</code>.  Setup your go environment with metalinter which will point you to better conventions."}, {"owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1489343985, "post_id": 42751274, "comment_id": 72619230, "body": "@eduncan911 ok, so is this a deep copy? let&#39;s say foo has an array field, will that be copied too?"}, {"owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1489344353, "post_id": 42751274, "comment_id": 72619366, "body": "@eduncan911 regarding convention I agree but here&#39;s the dilemma, <a href=\"http://stackoverflow.com/questions/42739877/getter-and-setter-conventions-in-go-lang\" title=\"getter and setter conventions in go lang\">stackoverflow.com/questions/42739877/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1489344176, "post_id": 42751515, "comment_id": 72619291, "body": "I can&#39;t remember, somewhere non official but thanks for posting this, now I can use it."}], "tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": true, "score": 1, "last_activity_date": 1489344437, "last_edit_date": 1489344437, "creation_date": 1489343956, "answer_id": 42751515, "question_id": 42751274, "link": "https://stackoverflow.com/questions/42751274/copying-or-passing-the-pointer/42751515#42751515", "title": "Copying or passing the pointer", "body": "<p>Where did you see a recommendation to use a non-pointer receiver for getters ? I don\u2019t think this is done in the official packages; e.g., the <a href=\"https://golang.org/pkg/archive/zip/\" rel=\"nofollow noreferrer\">zip package</a> definitely uses pointer receivers for both getters and setters.</p>\n\n<pre><code>func (h *FileHeader) ModTime() time.Time\nfunc (h *FileHeader) Mode() (mode os.FileMode)\nfunc (h *FileHeader) SetModTime(t time.Time)\nfunc (h *FileHeader) SetMode(mode os.FileMode)\n</code></pre>\n\n<p>See also :</p>\n\n<ul>\n<li><a href=\"https://golang.org/doc/faq#methods_on_values_or_pointers\" rel=\"nofollow noreferrer\">Should I define methods on values or pointers?</a></li>\n<li><a href=\"https://github.com/golang/go/wiki/CodeReviewComments#receiver-type\" rel=\"nofollow noreferrer\">How to select a receiver type</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1362, "user_id": 6486607, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e6c5ef2e01327de3ee7c2913832c15c1?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan Alex", "link": "https://stackoverflow.com/users/6486607/razvan-alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1489343991, "creation_date": 1489343991, "answer_id": 42751522, "question_id": 42751274, "link": "https://stackoverflow.com/questions/42751274/copying-or-passing-the-pointer/42751522#42751522", "title": "Copying or passing the pointer", "body": "<p>When working with struct (like the above example), use pointers whenever as possible. I don't see anything wrong passing a struct as a pointer especially when you're not modifying its value. There's cases when u don't want to do mutation on your struct so to make sure you're not modifying anything, you're not gonna pass it as a value, but when performing read only it's more prefered to use pointers in this case ;)</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1489344747, "creation_date": 1489344747, "answer_id": 42751664, "question_id": 42751274, "link": "https://stackoverflow.com/questions/42751274/copying-or-passing-the-pointer/42751664#42751664", "title": "Copying or passing the pointer", "body": "<p>Did you read the <a href=\"https://golang.org/doc/faq\" rel=\"nofollow noreferrer\">Go Frequently Asked Questions (FAQ)</a>?</p>\n\n<blockquote>\n  <p><a href=\"https://golang.org/doc/faq#methods_on_values_or_pointers\" rel=\"nofollow noreferrer\">Should I define methods on values or pointers?</a> </p>\n\n<pre><code>func (s *MyStruct) pointerMethod() { } // method on pointer\nfunc (s MyStruct)  valueMethod()   { } // method on value\n</code></pre>\n  \n  <p>For programmers unaccustomed to pointers, the distinction between\n  these two examples can be confusing, but the situation is actually\n  very simple. When defining a method on a type, the receiver (s in the\n  above examples) behaves exactly as if it were an argument to the\n  method. Whether to define the receiver as a value or as a pointer is\n  the same question, then, as whether a function argument should be a\n  value or a pointer. There are several considerations.</p>\n  \n  <p>First, and most important, does the method need to modify the\n  receiver? If it does, the receiver must be a pointer. (Slices and maps\n  act as references, so their story is a little more subtle, but for\n  instance to change the length of a slice in a method the receiver must\n  still be a pointer.) In the examples above, if pointerMethod modifies\n  the fields of s, the caller will see those changes, but valueMethod is\n  called with a copy of the caller's argument (that's the definition of\n  passing a value), so changes it makes will be invisible to the caller.</p>\n  \n  <p>By the way, pointer receivers are identical to the situation in Java,\n  although in Java the pointers are hidden under the covers; it's Go's\n  value receivers that are unusual.</p>\n  \n  <p>Second is the consideration of efficiency. If the receiver is large, a\n  big struct for instance, it will be much cheaper to use a pointer\n  receiver.</p>\n  \n  <p>Next is consistency. If some of the methods of the type must have\n  pointer receivers, the rest should too, so the method set is\n  consistent regardless of how the type is used. See the section on\n  method sets for details.</p>\n  \n  <p>For types such as basic types, slices, and small structs, a value\n  receiver is very cheap so unless the semantics of the method requires\n  a pointer, a value receiver is efficient and clear.</p>\n</blockquote>\n"}], "owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 42751515, "answer_count": 3, "score": -1, "last_activity_date": 1489387356, "creation_date": 1489342686, "last_edit_date": 1489387356, "question_id": 42751274, "link": "https://stackoverflow.com/questions/42751274/copying-or-passing-the-pointer", "title": "Copying or passing the pointer", "body": "<p>I've seen recommendations to use the following in getters and setters, i.e. pass a pointer when you are setting the value in order to change the original data, but it's not required when getting the value.</p>\n\n<p>In the case of a getter, without a pointer, the value is copied. My question is, isn't it inefficient to copy the object to get value out of it, could we not use a pointer as well?</p>\n\n<pre><code>type Foo struct {\n     Body string\n}\n\nfunc (foo Foo) GetBody() interface{} {\n    return foo.Body\n}\n\nfunc (foo * Foo) SetBody(body string) {\n    foo.Body = body\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-platform", "google-cloud-endpoints", "google-app-engine-go"], "answers": [{"comments": [{"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "reply_to_user": {"reputation": 9855, "user_id": 400836, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/a5k8b.png?s=128&g=1", "display_name": "Quang Van", "link": "https://stackoverflow.com/users/400836/quang-van"}, "edited": false, "score": 1, "creation_date": 1489334551, "post_id": 42749589, "comment_id": 72615746, "body": "Extensible Server Proxy (see e.g. <a href=\"https://cloud.google.com/endpoints/docs/running-esp-localdev\" rel=\"nofollow noreferrer\">cloud.google.com/endpoints/docs/running-esp-localdev</a>)"}, {"owner": {"reputation": 2724, "user_id": 354007, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6c577241666b544e9fa19d9a013f964c?s=128&d=identicon&r=PG", "display_name": "IrishGringo", "link": "https://stackoverflow.com/users/354007/irishgringo"}, "edited": false, "score": 1, "creation_date": 1508375431, "post_id": 42749589, "comment_id": 80590316, "body": "Hey Dan. Any status update with golang, standard app engine and cloud endpoints?   I sincerely hope so."}], "tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": true, "score": 8, "last_activity_date": 1489334133, "creation_date": 1489334133, "answer_id": 42749589, "question_id": 42749402, "link": "https://stackoverflow.com/questions/42749402/why-isnt-cloud-endpoints-for-golang-in-gae-standard-environment/42749589#42749589", "title": "Why isn&#39;t Cloud Endpoints for Golang in GAE Standard Environment?", "body": "<p>Product manager Dan Ciruli <a href=\"https://groups.google.com/forum/#!topic/google-appengine-go/ojw2i6dqCpg\" rel=\"noreferrer\">answered this</a> on the google-appengine-go mailing list :</p>\n\n<blockquote>\n  <p>There are two primary reasons, and the second is a byproduct of the\n  first. We've had much less uptake on the Endpoints Go framework --\n  perhaps because, in the words of a developer I spoke to, \"Go just\n  isn't a 'framework' language.\" Unlike, Java, Python (and, say, Node),\n  most developers using Go don't use a framework for writing an API\n  backend.</p>\n  \n  <p>And, at least partially because of that, we aren't staffed on the\n  Endpoints team to build and support a framework in Go.</p>\n</blockquote>\n\n<p>He added:</p>\n\n<blockquote>\n  <p>All hope is not lost. You can put a Go API behind Endpoints today on\n  GAE Flex or Container Engine (without framework) using the Extensible\n  Server Proxy. And later this year, we should be able to get the ESP\n  deployed in GAE standard environment, you'll get the full power there,\n  too.</p>\n</blockquote>\n"}], "owner": {"reputation": 9855, "user_id": 400836, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/a5k8b.png?s=128&g=1", "display_name": "Quang Van", "link": "https://stackoverflow.com/users/400836/quang-van"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 2, "accepted_answer_id": 42749589, "answer_count": 1, "score": 6, "last_activity_date": 1489387560, "creation_date": 1489333266, "last_edit_date": 1489387560, "question_id": 42749402, "link": "https://stackoverflow.com/questions/42749402/why-isnt-cloud-endpoints-for-golang-in-gae-standard-environment", "title": "Why isn&#39;t Cloud Endpoints for Golang in GAE Standard Environment?", "body": "<p>Hey does anyone know why <a href=\"https://cloud.google.com/appengine/docs/standard/python/endpoints/\" rel=\"noreferrer\">Google Cloud Endpoints</a> for Go-lang isn't in the standard environment on Google App Engine? It's only seemed to be officially supported/documented for Python / Java.</p>\n\n<p>Is it because</p>\n\n<p>A) Cloud Endpoints is coming to Golang soon / someday.</p>\n\n<p>B) Cloud Endpoints isn't so great, so it's not going to be implemented in Golang.</p>\n\n<p>C) Something else.</p>\n\n<p>There's this \"non-standard\" lib <a href=\"https://github.com/GoogleCloudPlatform/go-endpoints\" rel=\"noreferrer\">https://github.com/GoogleCloudPlatform/go-endpoints</a> but it hasn't been updated in 9 months.</p>\n\n<p>I'm trying to choose between Python and Golang for a GAE project, and this lack of support for Cloud Endpoints is giving me pause.</p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 0, "creation_date": 1489384363, "post_id": 42747183, "comment_id": 72630344, "body": "What do your templates look like?"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 4568542, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fjLXj.jpg?s=128&g=1", "display_name": "emurmotol", "link": "https://stackoverflow.com/users/4568542/emurmotol"}, "edited": false, "score": 0, "creation_date": 1489671036, "post_id": 42772969, "comment_id": 72780116, "body": "I tried this but, I get a empty response. Kindly recheck my post, I added the contents of my templates Sir. Thanks"}, {"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "reply_to_user": {"reputation": 121, "user_id": 4568542, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fjLXj.jpg?s=128&g=1", "display_name": "emurmotol", "link": "https://stackoverflow.com/users/4568542/emurmotol"}, "edited": false, "score": 0, "creation_date": 1489673285, "post_id": 42772969, "comment_id": 72781848, "body": "Remove all the {{define &quot;xxx&quot;}}{{end}}, and leave the content, you don&#39;t need to define templates if you load them all in the template set with distinct names, you can use those names to refer to them. If you only define, and never <i>use</i> blocks, you&#39;ll render a blank template, it&#39;s unfortunate they introduced this blocks feature IMO as it just makes templates more confusing. I&#39;ve added an example template."}, {"owner": {"reputation": 121, "user_id": 4568542, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fjLXj.jpg?s=128&g=1", "display_name": "emurmotol", "link": "https://stackoverflow.com/users/4568542/emurmotol"}, "edited": false, "score": 0, "creation_date": 1489674835, "post_id": 42772969, "comment_id": 72783017, "body": "It works now. Thank you for making me understand how it works @Kenny Grant."}], "tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 0, "last_activity_date": 1489673271, "last_edit_date": 1489673271, "creation_date": 1489437446, "answer_id": 42772969, "question_id": 42747183, "link": "https://stackoverflow.com/questions/42747183/how-to-render-templates-to-multiple-layouts-in-go/42772969#42772969", "title": "How to render templates to multiple layouts in Go?", "body": "<p>I normally take the approach of rendering twice, once for content, once for layout, this lets you use any content in any layout and defer that decision till runtime. Would be interested in other approaches if other people do it differently, but this is working for me at present. </p>\n\n<p>So using the code you have posted, something like this in handler: </p>\n\n<pre><code>data := map[string]interface{}{\n            \"title\": \"hello world\",\n        }\nrenderTemplate(w, \"base1.tmpl\", \"page1.tmpl\", data)\n</code></pre>\n\n<p>...</p>\n\n<p>in renderTemplate pass in a layout as well as a template and:</p>\n\n<pre><code>// Render the template 'name' with data\nbuf := bufpool.Get()\nerr := tmpl.ExecuteTemplate(buf, name, data)\nif err != nil {\n    return err\n}\n\n// Set the content as a key on data (set as html as it is rendered)\ndata[\"content\"] = template.HTML(buf.Bytes())\nbufpool.Put(buf)\n\n// Render the layout 'layout' with data, using template as content key\nbuf = bufpool.Get()\ndefer bufpool.Put(buf)  \nerr = tmpl.ExecuteTemplate(buf, layout, data)\nif err != nil {\n    return err\n}\n</code></pre>\n\n<p>Layout:</p>\n\n<pre><code>&lt;html&gt;\n&lt;body&gt;\n   &lt;h1&gt;Base 1&lt;/h1&gt;\n   {{.content}}\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Page:</p>\n\n<pre><code>&lt;h2&gt;{{.title}}&lt;/h2&gt;\n&lt;h3&gt;Page 1&lt;/h3&gt;\n</code></pre>\n\n<p>Here is a link to full code:</p>\n\n<p><a href=\"https://play.golang.org/p/R2vr4keZec\" rel=\"nofollow noreferrer\">https://play.golang.org/p/R2vr4keZec</a></p>\n"}], "owner": {"reputation": 121, "user_id": 4568542, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fjLXj.jpg?s=128&g=1", "display_name": "emurmotol", "link": "https://stackoverflow.com/users/4568542/emurmotol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 995, "favorite_count": 0, "accepted_answer_id": 42772969, "answer_count": 1, "score": 0, "last_activity_date": 1489673271, "creation_date": 1489320503, "last_edit_date": 1489670886, "question_id": 42747183, "link": "https://stackoverflow.com/questions/42747183/how-to-render-templates-to-multiple-layouts-in-go", "title": "How to render templates to multiple layouts in Go?", "body": "<p>I need to render templates into different kinds of layout. Here's my directory structure.</p>\n\n<pre><code>myapp\n|\n\u2502   main.go\n\u2502\n\u251c\u2500\u2500\u2500static\n\u2502       script.js\n\u2502       style.css\n\u2502\n\u2514\u2500\u2500\u2500templates\n    \u2502   page1.tmpl\n    \u2502   page2.tmpl\n    \u2502   page3.tmpl\n    \u2502   page4.tmpl\n    \u2502   page5.tmpl\n    \u2502\n    \u2514\u2500\u2500\u2500layouts\n            base1.tmpl\n            base2.tmpl\n            base3.tmpl\n</code></pre>\n\n<p>I have done rendering templates to a single layout template but, I can't make it work on multiple layouts. Here's what I got so far:</p>\n\n<pre><code>package main\n\nimport (\n    \"html/template\"\n    \"net/http\"\n    \"fmt\"\n    \"github.com/urfave/negroni\"\n    \"github.com/oxtoacart/bpool\"\n    \"path/filepath\"\n    \"log\"\n)\n\nvar (\n    templates        map[string]*template.Template\n    bufpool          *bpool.BufferPool\n)\n\nfunc main() {\n    loadTemplates()\n    mux := http.NewServeMux()\n    mux.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        renderTemplate(w, \"page1.tmpl\",nil)\n    })\n    n := negroni.New()\n    n.Use(negroni.NewLogger())\n    n.UseHandler(mux)\n    http.ListenAndServe(\":8080\", n)\n}\n\nfunc renderTemplate(w http.ResponseWriter, name string, data map[string]interface{}) error {\n    tmpl, ok := templates[name]\n    if !ok {\n        return fmt.Errorf(\"The template %s does not exist.\", name)\n    }\n\n    buf := bufpool.Get()\n    defer bufpool.Put(buf)\n\n    err := tmpl.ExecuteTemplate(buf, \"base1.tmpl\", data)\n    if err != nil {\n        return err\n    }\n\n    w.Header().Set(\"Content-Type\", \"text/html; charset=utf-8\")\n    buf.WriteTo(w)\n    return nil\n}\n\nfunc loadTemplates() {\n    if templates == nil {\n        templates = make(map[string]*template.Template)\n    }\n\n    tmplDir := \"templates/\"\n\n    layouts, err := filepath.Glob(tmplDir + \"layouts/*.tmpl\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    includes, err := filepath.Glob(tmplDir + \"*.tmpl\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    for _, include := range includes {\n        files := append(layouts, include)\n        templates[filepath.Base(include)] = template.Must(template.ParseFiles(files...))\n    }\n    fmt.Print(includes)\n    bufpool = bpool.NewBufferPool(64)\n}\n</code></pre>\n\n<p>Here's how <code>base1.tmpl</code> looks like:</p>\n\n<pre><code>{{define \"base1\"}}\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;\n    &lt;title&gt;{{block \"title\" .}}{{end}}&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n{{template \"content\" .}}\n&lt;/body&gt;\n&lt;/html&gt;\n{{end}}\n</code></pre>\n\n<p>And here's how <code>page1.tmpl</code> looks like:</p>\n\n<pre><code>{{define \"title\"}}Page 1{{end}}\n\n{{define \"content\"}}\n&lt;p&gt;Page 1 contents&lt;/p&gt;\n{{end}}\n</code></pre>\n"}, {"tags": ["go", "viper-go"], "answers": [{"tags": [], "owner": {"reputation": 2907, "user_id": 7357841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RJs6M9j2t9Q/AAAAAAAAAAI/AAAAAAAAAAA/f77YfS3xpcs/photo.jpg?sz=128", "display_name": "minamijoyo", "link": "https://stackoverflow.com/users/7357841/minamijoyo"}, "is_accepted": true, "score": 9, "last_activity_date": 1489329295, "creation_date": 1489329295, "answer_id": 42748666, "question_id": 42747085, "link": "https://stackoverflow.com/questions/42747085/working-with-interfaces-using-viper-language/42748666#42748666", "title": "Working with interfaces using Viper language", "body": "<p>By defining the configuration file type and using <code>viper.Unmarshal</code> you can cast the interface to specific type you need. Here is an example:</p>\n\n<p><code>main.go</code></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/spf13/viper\"\n)\n\ntype Host struct {\n    Name string\n    Port int\n    Key  string\n}\n\ntype Config struct {\n    Hosts []Host\n}\n\nfunc main() {\n    viper.AddConfigPath(\"./\")\n    viper.SetConfigName(\"test\")\n    viper.ReadInConfig()\n    var config Config\n    err := viper.Unmarshal(&amp;config)\n    if err != nil {\n        panic(\"Unable to unmarshal config\")\n    }\n    for _, h := range config.Hosts {\n        fmt.Printf(\"Name: %s, Port: %d, Key: %s\\n\", h.Name, h.Port, h.Key)\n    }\n}\n</code></pre>\n\n<p><code>test.yml</code></p>\n\n<pre><code>hosts:\n  - name: host1\n    port: 90\n    key: my_key\n  - name: host2\n    port: 90\n    key: prompt\n</code></pre>\n\n<p>Run:</p>\n\n<pre><code>$ go run main.go\nName: host1, Port: 90, Key: my_key\nName: host2, Port: 90, Key: prompt\n</code></pre>\n\n<p>If you want to decode only some keys, not the entire configuration file, use <code>viper.UnmarshalKey</code>.</p>\n\n<p><code>main.go</code></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/spf13/viper\"\n)\n\ntype Host struct {\n    Name string\n    Port int\n    Key  string\n}\n\nfunc main() {\n    viper.AddConfigPath(\"./\")\n    viper.SetConfigName(\"test\")\n    viper.ReadInConfig()\n    var hosts []Host\n    err := viper.UnmarshalKey(\"hosts\", &amp;hosts)\n    if err != nil {\n        panic(\"Unable to unmarshal hosts\")\n    }\n    for _, h := range hosts {\n        fmt.Printf(\"Name: %s, Port: %d, Key: %s\\n\", h.Name, h.Port, h.Key)\n    }\n}\n</code></pre>\n\n<p>Run:</p>\n\n<pre><code>$ go run main.go\nName: host1, Port: 90, Key: my_key\nName: host2, Port: 90, Key: prompt\n</code></pre>\n"}], "owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3947, "favorite_count": 2, "accepted_answer_id": 42748666, "answer_count": 1, "score": 6, "last_activity_date": 1489329295, "creation_date": 1489319791, "question_id": 42747085, "link": "https://stackoverflow.com/questions/42747085/working-with-interfaces-using-viper-language", "title": "Working with interfaces using Viper language", "body": "<p>I am building a little app using <a href=\"https://github.com/spf13/viper\" rel=\"noreferrer\">Viper</a> and <a href=\"https://github.com/spf13/cobra\" rel=\"noreferrer\">Cobra</a>. At the moment, I have a yaml file like this:</p>\n\n<pre><code>hosts:\n  - name: host1\n    port: 90\n    key: my_key\n  - name: host2\n    port: 90\n    key: prompt\n</code></pre>\n\n<p>And I've read in the config file using Viper.</p>\n\n<p>When I run <code>viper.Get(\"hosts\")</code> it returns an interface (or a slice of interfaces?). This is the data structure I end up with:</p>\n\n<pre><code>([]interface {}) (len=2 cap=2) {\n (map[interface {}]interface {}) (len=3) {\n  (string) (len=4) \"name\": (string) (len=20) \"host1\",\n  (string) (len=4) \"port\": (int) 90,\n  (string) (len=3) \"key\": (string) (len=6) \"my_key\"\n },\n (map[interface {}]interface {}) (len=3) {\n  (string) (len=3) \"key\": (string) (len=6) \"prompt\",\n  (string) (len=4) \"name\": (string) (len=20) \"host2\",\n  (string) (len=4) \"port\": (int) 90\n }\n}\n</code></pre>\n\n<p>What I'd like to do here is loop over each of the array elements and perform an operation using the values of name, port and key. </p>\n\n<p>I'm completely new to interfaces in Golang, so this isn't very clear, and the literature on this is extremely confusing :(</p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1489345384, "post_id": 42746972, "comment_id": 72619776, "body": "Insertion into <code>slice</code> (or <code>Dynamic Array</code>) is <code>O(n)</code>. You might want to look into <code>Binary Search Tree</code> where insertion time on average is <code>O(log(n))</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1489369826, "post_id": 42746972, "comment_id": 72627037, "body": "I&#39;m not sure why you think it requires 2 appends to add a single element to a slice. You could do it in a single line with nested appends, but there&#39;s no need for that. Extend the slice, shift the elements, insert the new element."}], "answers": [{"tags": [], "owner": {"reputation": 109227, "user_id": 641955, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/Hg2nO.jpg?s=128&g=1", "display_name": "janos", "link": "https://stackoverflow.com/users/641955/janos"}, "is_accepted": false, "score": 8, "last_activity_date": 1489319428, "creation_date": 1489319428, "answer_id": 42747030, "question_id": 42746972, "link": "https://stackoverflow.com/questions/42746972/golang-insert-to-a-sorted-slice/42747030#42747030", "title": "golang: Insert to a sorted slice", "body": "<p>If the slice has enough capacity then there's no need for a new copy.\nThe elements after the insert position can be shifted to the right.\nOnly when the slice doesn't have enough capacity,\na new slice and copying all values will be necessary.</p>\n\n<p>Keep in mind that slices are not designed for fast insertion.\nSo there won't be a miracle solution here using slices.\nYou could create a custom data structure to make this more efficient,\nbut obviously there will be other trade-offs.</p>\n\n<p>One point that can be optimized in the process is finding the insertion point quickly. If the slice is sorted, then you can use binary search to perform this in <code>O(log n)</code> time.\nHowever, this might not matter much,\nconsidering the expensive operation of copying the end of the slice,\nor reallocating when necessary.</p>\n"}, {"comments": [{"owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "edited": false, "score": 0, "creation_date": 1575480121, "post_id": 55460931, "comment_id": 104583916, "body": "This is a good answer. Seems to be the method the golang sort package is expecting, given their Search functions."}], "tags": [], "owner": {"reputation": 772, "user_id": 2177445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70a2a5ad356c78484d79a3ad4b99209f?s=128&d=identicon&r=PG", "display_name": "likebike", "link": "https://stackoverflow.com/users/2177445/likebike"}, "is_accepted": false, "score": 5, "last_activity_date": 1554141148, "creation_date": 1554141148, "answer_id": 55460931, "question_id": 42746972, "link": "https://stackoverflow.com/questions/42746972/golang-insert-to-a-sorted-slice/55460931#55460931", "title": "golang: Insert to a sorted slice", "body": "<p>Here is how to insert into a sorted slice of strings:</p>\n\n<p>Go Playground Link to full example: <a href=\"https://play.golang.org/p/4RkVgEpKsWq\" rel=\"noreferrer\">https://play.golang.org/p/4RkVgEpKsWq</a></p>\n\n<pre><code>func Insert(ss []string, s string) []string {\n    i := sort.SearchStrings(ss, s)\n    ss = append(ss, \"\")\n    copy(ss[i+1:], ss[i:])\n    ss[i] = s\n    return ss\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5450, "user_id": 942317, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/SY5ID.jpg?s=128&g=1", "display_name": "STEEL", "link": "https://stackoverflow.com/users/942317/steel"}, "is_accepted": false, "score": 0, "last_activity_date": 1580381568, "last_edit_date": 1580381568, "creation_date": 1580380394, "answer_id": 59983981, "question_id": 42746972, "link": "https://stackoverflow.com/questions/42746972/golang-insert-to-a-sorted-slice/59983981#59983981", "title": "golang: Insert to a sorted slice", "body": "<p>play : <a href=\"https://play.golang.org/p/dUGmPurouxA\" rel=\"nofollow noreferrer\">https://play.golang.org/p/dUGmPurouxA</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>array1 := []int{1, 3, 4, 5}\n\n    //want to insert at index 1\n    insertAtIndex := 1\n    temp := append([]int{}, array1[insertAtIndex:]...)\n    array1 = append(array1[0:insertAtIndex], 2)\n    array1 = append(array1, temp...)\n\n    fmt.Println(array1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1619102650, "creation_date": 1619102650, "answer_id": 67215516, "question_id": 42746972, "link": "https://stackoverflow.com/questions/42746972/golang-insert-to-a-sorted-slice/67215516#67215516", "title": "golang: Insert to a sorted slice", "body": "<p>You could use a heap:</p>\n<pre><code>package main\n\nimport (\n   &quot;container/heap&quot;\n   &quot;sort&quot;\n)\n\ntype slice struct { sort.IntSlice }\nfunc (s slice) Pop() interface{} { return 0 }\n\nfunc (s *slice) Push(x interface{}) {\n   (*s).IntSlice = append((*s).IntSlice, x.(int))\n}\n\nfunc main() {\n   s := &amp;slice{\n      sort.IntSlice{11, 10, 14, 13},\n   }\n   heap.Init(s)\n   heap.Push(s, 12)\n   println(s.IntSlice[0] == 10)\n}\n</code></pre>\n<p>Note that a heap is not strictly sorted, but the &quot;minimum element&quot; is guaranteed\nto be the first element. Also I did not implement the <code>Pop</code> function in my\nexample, you would want to do that.</p>\n<p><a href=\"https://golang.org/pkg/container/heap\" rel=\"nofollow noreferrer\">https://golang.org/pkg/container/heap</a></p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1619107823, "last_edit_date": 1619107823, "creation_date": 1619107287, "answer_id": 67216833, "question_id": 42746972, "link": "https://stackoverflow.com/questions/42746972/golang-insert-to-a-sorted-slice/67216833#67216833", "title": "golang: Insert to a sorted slice", "body": "<p>There are two parts to the problem: finding where to insert the value and inserting the value.</p>\n<p>Use the <a href=\"https://pkg.go.dev/sort\" rel=\"nofollow noreferrer\">sort package</a> search functions to efficiently find the insertion index using binary search.</p>\n<p>Use a single call to <code>append</code> to efficiently insert a value into a slice:</p>\n<pre><code>// insertAt inserts v into s at index i and returns the new slice.\nfunc insertAt(data []int, i int, v int) []int {\n    if i == len(data) {\n        // Insert at end is the easy case.\n        return append(data, v)\n    }\n\n    // Make space for the inserted element by shifting\n    // values at the insertion index up one index. The call\n    // to append does not allocate memory when cap(data) is\n    // greater \u200bthan len(data).\n    data = append(data[:i+1], data[i:]...)\n\n    // Insert the new element.\n    data[i] = v\n\n    // Return the updated slice.\n    return data\n}\n</code></pre>\n<p>Here's the code for inserting a value a sorted slice:</p>\n<pre><code>func insertSorted(data []int, v int) []int {\n    i := sort.Search(len(data), func(i int) bool { return data[i] &gt;= v })\n    return insertAt(data, i, v)\n}\n</code></pre>\n<p>The code in this answer uses a slice of <code>int</code>.  Adjust the type to match your actual data.</p>\n<p>The call to sort.Search in this answer can be replaced with a call to the helper function <a href=\"https://pkg.go.dev/sort#SearchInts\" rel=\"nofollow noreferrer\">sort.SearchInts</a>.  I show sort.Search in this answer because the function applies to a slice of any type.</p>\n<p>If you do not want to add duplicate values, check the value at the search index before inserting:</p>\n<pre><code>func insertSortedNoDups(data []int, v int) []int {\n    i := sort.Search(len(data), func(i int) bool { return data[i] &gt;= v })\n    if i &lt; len(data) &amp;&amp; data[i] == v {\n        return data\n    }\n    return insertAt(data, i, v)\n}\n</code></pre>\n"}], "owner": {"reputation": 427, "user_id": 6295160, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/28ddf42297c37b26edb73d36e39bb1cb?s=128&d=identicon&r=PG&f=1", "display_name": "Berry Jones", "link": "https://stackoverflow.com/users/6295160/berry-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9848, "favorite_count": 1, "answer_count": 5, "score": 8, "last_activity_date": 1619107823, "creation_date": 1489319005, "question_id": 42746972, "link": "https://stackoverflow.com/questions/42746972/golang-insert-to-a-sorted-slice", "title": "golang: Insert to a sorted slice", "body": "<p>What's the most efficient way of inserting an element to a sorted slice?</p>\n\n<p>I tried a couple of things but all ended up using at least 2 appends which as I understand makes a new copy of the slice</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 83, "user_id": 1007729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6865706a9bb92768dcdc5b4ff6fe9b?s=128&d=identicon&r=PG", "display_name": "djvdorp", "link": "https://stackoverflow.com/users/1007729/djvdorp"}, "edited": false, "score": 0, "creation_date": 1513262670, "post_id": 42744844, "comment_id": 82593498, "body": "Did you ever solve this issue? We are having the same issue with aws-sdk-go v1.4.4 giving us status code 400 with message &quot;MalformedXML: The XML you provided was not well-formed or did not validate against our published schema&quot; on the REST.POST.UPLOAD action, and we are kinda clueless here. Any help would be appreciated!"}, {"owner": {"reputation": 83, "user_id": 1007729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6865706a9bb92768dcdc5b4ff6fe9b?s=128&d=identicon&r=PG", "display_name": "djvdorp", "link": "https://stackoverflow.com/users/1007729/djvdorp"}, "edited": false, "score": 0, "creation_date": 1514972140, "post_id": 42744844, "comment_id": 83122846, "body": "Turns out this was likely caused by us trying to upload a 0-byte multipart part to s3. ERROR: The content that we try to upload is 0 bytes."}], "owner": {"reputation": 11, "user_id": 7692105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ecee90f9ac9dc7762d195c4c8bbe0b4?s=128&d=identicon&r=PG&f=1", "display_name": "skumar", "link": "https://stackoverflow.com/users/7692105/skumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1489303279, "creation_date": 1489303279, "question_id": 42744844, "link": "https://stackoverflow.com/questions/42744844/after-upgrading-aws-sdk-go-package-to-v1-7-7-from-v1-4-x-asws-sdk-go-s3-client", "title": "After upgrading aws-sdk-go package to v1.7.7 from v1.4.x. asws-sdk-go s3 client, upload file to blobstore failing with MalformedXML status code: 400", "body": "<p>I upgraded my aws-sdk-go package to v1.7.7 from v1.4.x.\nI am using aws-sdk-go s3 client to connect to a blobstore.\nAfter upgrading, upload multipart file(i.e POST) to blobstore is not working.\nI am getting following error message:\nMalformedXML: The XML you provided was not well-formed or did not validate against our published schema.\nstatus code: 400\nFollowing is the code snippet which was working in aws-sdk-go v1.4.x and is not working in v1.7.7.</p>\n\n<pre><code>uploader := s3manager.NewUploader(s.s)\nsvc := uploader.S3.(*s3.S3) \nsvc.Handlers.Sign.Clear()\nsvc.Handlers.Sign.PushBack(SignV2)\nresult, err := uploader.Upload(&amp;s3manager.UploadInput{\n                Body:   file,\n                Bucket: &amp;s.bucketName,\n                Key:    &amp;fileName,\n                ContentType: &amp;contentType,\n            })\n</code></pre>\n"}, {"tags": ["json", "pointers", "go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489308363, "post_id": 42744784, "comment_id": 72607796, "body": "What happens if you do <code>c.BindJSON(json)</code> in the first case?"}, {"owner": {"reputation": 25, "user_id": 2779502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02578e2103e7500cd2a2b975d8a9deb?s=128&d=identicon&r=PG&f=1", "display_name": "Wisnu Wardoyo", "link": "https://stackoverflow.com/users/2779502/wisnu-wardoyo"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489323923, "post_id": 42744784, "comment_id": 72612165, "body": "you can&#39;t do it, it will cause unmarshall error"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489349488, "post_id": 42744784, "comment_id": 72621284, "body": "Could you please elaborate? How passing a pointer would &quot;cause unmarshall error&quot;, if it does not do so in the second case? What if you initialise the pointer <code>var json *foos = &amp;foos{}</code> or <code>json := &amp;foos{}</code> and simply pass <code>json</code>?"}, {"owner": {"reputation": 25, "user_id": 2779502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02578e2103e7500cd2a2b975d8a9deb?s=128&d=identicon&r=PG&f=1", "display_name": "Wisnu Wardoyo", "link": "https://stackoverflow.com/users/2779502/wisnu-wardoyo"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489371384, "post_id": 42744784, "comment_id": 72627381, "body": "the all endpoint I mentioned is not causing any error. When you initialize <code>var json *foos</code> and you just use <code>c.BindJSON(json)</code> it&#39;s return unmarshal error because json is the value of *foos which is nil, and &amp;json will pass the pointer address which will initialized in json.decode."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1489372971, "post_id": 42744784, "comment_id": 72627787, "body": "When you do <code>&amp;json</code> for a variable of <code>*foos</code> type you get a pointer to a pointer. It correctly tells you about it being <code>null</code> since you did not initialise it, like <code>json := &amp;foos{}</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": true, "score": 5, "last_activity_date": 1489309777, "creation_date": 1489309777, "answer_id": 42745638, "question_id": 42744784, "link": "https://stackoverflow.com/questions/42744784/golang-gin-gonic-json-binding/42745638#42745638", "title": "Golang gin-gonic JSON binding", "body": "<p>It is documented in <a href=\"https://github.com/gin-gonic/gin/blob/master/binding/binding.go\" rel=\"noreferrer\">binding.go</a>, lines 25-32 :</p>\n\n<pre><code>type StructValidator interface {\n    // ValidateStruct can receive any kind of type and it should never panic, even if the configuration is not right.\n    // If the received type is not a struct, any validation should be skipped and nil must be returned.\n    // If the received type is a struct or pointer to a struct, the validation should be performed.\n    // If the struct is not valid or the validation itself fails, a descriptive error should be returned.\n    // Otherwise nil must be returned.\n    ValidateStruct(interface{}) error\n}\n</code></pre>\n\n<p>In your case, ValidateStruct receives a pointer to a pointer to a struct, and no checking takes place, as documented.</p>\n"}], "owner": {"reputation": 25, "user_id": 2779502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02578e2103e7500cd2a2b975d8a9deb?s=128&d=identicon&r=PG&f=1", "display_name": "Wisnu Wardoyo", "link": "https://stackoverflow.com/users/2779502/wisnu-wardoyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8586, "favorite_count": 0, "accepted_answer_id": 42745638, "answer_count": 1, "score": 1, "last_activity_date": 1489364842, "creation_date": 1489302828, "last_edit_date": 1489364842, "question_id": 42744784, "link": "https://stackoverflow.com/questions/42744784/golang-gin-gonic-json-binding", "title": "Golang gin-gonic JSON binding", "body": "<p>I have the struct below</p>\n\n<pre><code>type foos struct { Foo string `json:\"foo\" binding:\"required\"`}\n</code></pre>\n\n<p>and I have the following endpoint </p>\n\n<pre><code>  func sendFoo(c *gin.Context) {\n      var json *foos\n\n      if err := c.BindJSON(&amp;json); err != nil {\n          c.AbortWithStatus(400)\n          return\n      }\n\n      // Do something about json\n   }\n</code></pre>\n\n<p>when I post this JSON </p>\n\n<pre><code>{\"bar\":\"bar bar\"}\n</code></pre>\n\n<p>the err is always nil. I write binding required and it doesn't work. But when I change the endpoint like below,</p>\n\n<pre><code>func sendFoo(c *gin.Context) {\n    var json foos //remove pointer\n\n    if err := c.BindJSON(&amp;json); err != nil {\n          c.AbortWithStatus(400)\n          return\n    }\n\n    // Do something about json\n}\n</code></pre>\n\n<p>binding works and the err is not nil. Why?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 29080, "user_id": 1242778, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AKoAV.jpg?s=128&g=1", "display_name": "Agis", "link": "https://stackoverflow.com/users/1242778/agis"}, "edited": false, "score": 0, "creation_date": 1489308387, "post_id": 42744291, "comment_id": 72607802, "body": "Be sure to check the official blog post regarding constants: <a href=\"https://blog.golang.org/constants\" rel=\"nofollow noreferrer\">blog.golang.org/constants</a>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1489308629, "last_edit_date": 1495540439, "creation_date": 1489308235, "answer_id": 42745429, "question_id": 42744291, "link": "https://stackoverflow.com/questions/42744291/how-does-an-untyped-constant-n-get-converted-into-a-byte-when-passed-as-metho/42745429#42745429", "title": "How does an untyped constant &#39;\\n&#39; get converted into a byte when passed as method arg?", "body": "<p>Yes, your reading is correct. <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">Spec: Assignability</a> section applies here as the value you want to pass must be assignable to the type of the parameter.</p>\n\n<p>When you pass the value <code>'\\n'</code>, that is an untyped <a href=\"https://golang.org/ref/spec#Constants\" rel=\"nofollow noreferrer\">constant</a> specified by a <a href=\"https://golang.org/ref/spec#Rune_literals\" rel=\"nofollow noreferrer\">rune literal</a>. It represents a number equal to the Unicode code of the <code>'\\n'</code> character (which is 10 by the way). The rule you quoted applies here:</p>\n\n<blockquote>\n  <p><code>x</code> is an untyped <a href=\"https://golang.org/ref/spec#Constants\" rel=\"nofollow noreferrer\">constant</a> representable by a value of type <code>T</code>.</p>\n</blockquote>\n\n<p>Constants have a default type, which will be used when a type is \"missing\" from the context where the value is used. Such an example is the <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">short variable declaration</a>:</p>\n\n<pre><code>r := '\\n'\nfmt.Printf(\"%T\", r)\n</code></pre>\n\n<p>The default type of a rune literal is that: <code>rune</code>. The above code prints <code>int32</code> because the <code>rune</code> type is an alias for <code>int32</code> (they are \"identical\", interchangable). Try it on the <a href=\"https://play.golang.org/p/U4wDu3Z1t5\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>Now if you try to pass the variable <code>r</code> to a function which expects a value of type <code>byte</code>, it is a compile time error, because this case matches none of the assignability rules. You need explicit type <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">conversion</a> to make such a case work:</p>\n\n<pre><code>r := '\\n'\nline, err := reader.ReadString(byte(r))\n</code></pre>\n\n<p>See related blog posts and questions:</p>\n\n<p><a href=\"https://golang.org/ref/spec#Constants\" rel=\"nofollow noreferrer\">Spec: Constants</a></p>\n\n<p><a href=\"https://blog.golang.org/constants\" rel=\"nofollow noreferrer\">The Go Blog: Constants</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/36278121/defining-a-variable-in-go-programming-language/36278207#36278207\">Defining a variable in Go programming language</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/41501596/custom-type-passed-to-function-as-a-parameter/41501756#41501756\">Custom type passed to function as a parameter</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/27819137/why-do-these-two-float64s-have-different-values/27819409#27819409\">Why do these two float64s have different values?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/39444852/does-go-compilers-evaluation-differ-for-constant-expression-and-other-expressio/39445372#39445372\">Does go compiler&#39;s evaluation differ for constant expression and other expression</a></p>\n"}, {"tags": [], "owner": {"reputation": 29080, "user_id": 1242778, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AKoAV.jpg?s=128&g=1", "display_name": "Agis", "link": "https://stackoverflow.com/users/1242778/agis"}, "is_accepted": true, "score": 4, "last_activity_date": 1489323119, "last_edit_date": 1489323119, "creation_date": 1489308630, "answer_id": 42745487, "question_id": 42744291, "link": "https://stackoverflow.com/questions/42744291/how-does-an-untyped-constant-n-get-converted-into-a-byte-when-passed-as-metho/42745487#42745487", "title": "How does an untyped constant &#39;\\n&#39; get converted into a byte when passed as method arg?", "body": "<p>TL;DR <em>Yes</em> you are correct but there's something more.</p>\n\n<p><code>'\\n'</code> is an <em>untyped rune constant</em>. It doesn't have a type but a <em>default type</em> which is <code>int32</code> (<code>rune</code> is an alias for <code>int32</code>). It holds a single byte representing the literal \"\\n\", which is the numeric value <code>10</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Printf(\"%T %v %c\\n\", '\\n', '\\n', '\\n') // int32 10 (newline)\n}\n</code></pre>\n\n<p><em><a href=\"https://play.golang.org/p/lMjrTFDZUM\" rel=\"nofollow noreferrer\">https://play.golang.org/p/lMjrTFDZUM</a></em></p>\n\n<p>The part of the spec that answers your question lies in the <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\"><em>\u00a7 Calls</em></a> (emphasis mine):</p>\n\n<blockquote>\n  <p>Given an expression f of function type F,</p>\n\n<pre><code>f(a1, a2, \u2026 an)\n</code></pre>\n  \n  <p>calls f with arguments a1, a2, \u2026 an. Except for one\n  special case, <strong>arguments must be single-valued expressions <em>assignable</em>\n  to the parameter types of F</strong> and are evaluated before the function is\n  called.</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\"><em>\"assignable\"</em></a> is the key term here and the part of the spec you quoted explains what it means. As you correctly guessed, among the various rules of <em>assignability</em>, the one that applies here is the following:</p>\n\n<blockquote>\n  <p>x is an untyped constant representable by a value of type T.</p>\n</blockquote>\n\n<p>In our case this translates to:</p>\n\n<blockquote>\n  <p>'\\n' is an untyped (rune) constant representable by a value of type <code>byte</code></p>\n</blockquote>\n\n<p>The fact that <code>'\\n'</code> is actually converted to a byte when calling <code>ReadString()</code> is more apparent if we try passing an untyped rune constant wider than 1 byte, to a function that expects a <code>byte</code>:</p>\n\n<pre><code>package main\n\nfunc main() {\n    foo('\u03b1')\n}\n\nfunc foo(b byte) {}\n</code></pre>\n\n<p><em><a href=\"https://play.golang.org/p/W0EUZppWHH\" rel=\"nofollow noreferrer\">https://play.golang.org/p/W0EUZppWHH</a></em></p>\n\n<p>The code above fails with:</p>\n\n<blockquote>\n  <p>tmp/sandbox120896917/main.go:9: constant 945 overflows byte</p>\n</blockquote>\n\n<p>That's because <code>'\u03b1'</code> is actually 2 bytes, which means it cannot be converted to a value of type <code>byte</code> (the maximum integer a <code>byte</code> can hold is 255 while <code>'\u03b1'</code> is actually 945).</p>\n\n<p>All this is explained in the official blog post, <a href=\"https://blog.golang.org/constants\" rel=\"nofollow noreferrer\"><em>Constants</em></a>.</p>\n"}], "owner": {"reputation": 1191, "user_id": 2627137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rb5FY.jpg?s=128&g=1", "display_name": "kkaosninja", "link": "https://stackoverflow.com/users/2627137/kkaosninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2021, "favorite_count": 0, "accepted_answer_id": 42745487, "answer_count": 2, "score": 3, "last_activity_date": 1489323119, "creation_date": 1489298387, "last_edit_date": 1489298868, "question_id": 42744291, "link": "https://stackoverflow.com/questions/42744291/how-does-an-untyped-constant-n-get-converted-into-a-byte-when-passed-as-metho", "title": "How does an untyped constant &#39;\\n&#39; get converted into a byte when passed as method arg?", "body": "<p>I was watching this talk given at FOSDEM '17 about implementing \"tail -f\" in Go => <a href=\"https://youtu.be/lLDWF59aZAo\" rel=\"nofollow noreferrer\">https://youtu.be/lLDWF59aZAo</a></p>\n\n<p>In the author's initial example program, he creates a <code>Reader</code> using a file handle, and then uses the <code>ReadString</code> method with delimiter '\\n' to read the file line by line and print its contents. I usually use <code>Scanner</code>, so this was new to me.</p>\n\n<p>Program below | <a href=\"https://play.golang.org/p/JaTHYAoeBb\" rel=\"nofollow noreferrer\">Go Playground Link</a></p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    fileHandle, err := os.Open(\"someFile.log\")\n    if err != nil {\n        log.Fatalln(err)\n        return\n    }\n    defer fileHandle.Close()\n\n    reader := bufio.NewReader(fileHandle)\n\n    for {\n        line, err := reader.ReadString('\\n')\n        if err != nil {\n            log.Fatalln(err)\n            break\n        }\n        fmt.Print(line)\n    }\n\n}\n</code></pre>\n\n<p>Now, <code>ReadString</code> takes a byte as its delimiter argument[<a href=\"https://golang.org/pkg/bufio/#Reader.ReadString]\" rel=\"nofollow noreferrer\">https://golang.org/pkg/bufio/#Reader.ReadString]</a></p>\n\n<p>So my question is, how in the world did '\\n', which is a <code>rune</code>, get converted into a <code>byte</code>? I am not able to get my head around this. Especially since <code>byte</code> is an alias for <code>uint8</code>, and <code>rune</code> is an alias for <code>int32</code>.</p>\n\n<p>I asked the same question in Gophers slack, and was told that '\\n' is not a <code>rune</code>, but an untyped constant. If we actually created a <code>rune</code> using '\\n' and passed it in, the compilation would fail. This actually confused me a bit more.</p>\n\n<p>I was also given a link to a section of the Go spec regarding Type Identity => <a href=\"https://golang.org/ref/spec#Type_identity\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Type_identity</a></p>\n\n<p>If the program is not supposed to compile if it were an actual <code>rune</code>, why does the compiler allow an untyped constant to go through? Isn't this unsafe behaviour?</p>\n\n<p>My guess is that this works due to a rule in the <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">Assignability section in the Go spec</a>, which says</p>\n\n<blockquote>\n  <p>x is an untyped constant representable by a value of type T.</p>\n</blockquote>\n\n<p>Since '\\n' can indeed be assigned to a variable of type <code>byte</code>, it is therefore converted. </p>\n\n<p>Is my reasoning correct?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1489288847, "post_id": 42743322, "comment_id": 72604183, "body": "Assuming <code>bucketCntBits</code> and <code>bucketCnt</code> have to match, yes, it\u2019s better to set <code>bucketCnt</code> based on <code>bucketCntBits</code> than to rely on their separately-assigned values matching."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1489288951, "post_id": 42743322, "comment_id": 72604202, "body": "it seems like bucketCnt is supposed to be a multiple of 8"}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 3015101, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000322925739/picture?type=large", "display_name": "cafed00d", "link": "https://stackoverflow.com/users/3015101/cafed00d"}, "edited": false, "score": 0, "creation_date": 1489293016, "post_id": 42743466, "comment_id": 72604910, "body": "Could you please elaborate on why number of key/value pairs depends on the number of bits?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 165, "user_id": 3015101, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000322925739/picture?type=large", "display_name": "cafed00d", "link": "https://stackoverflow.com/users/3015101/cafed00d"}, "edited": false, "score": 0, "creation_date": 1489295483, "post_id": 42743466, "comment_id": 72605345, "body": "@cafed00d: See my revised answer."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1489295329, "last_edit_date": 1489295329, "creation_date": 1489289921, "answer_id": 42743466, "question_id": 42743322, "link": "https://stackoverflow.com/questions/42743322/why-dont-they-use-ints-to-define-constants-instead-of-using-bit-shift-operators/42743466#42743466", "title": "Why don&#39;t they use ints to define constants instead of using bit shift operators?", "body": "<blockquote>\n<pre><code>const (\n  // Maximum number of key/value pairs a bucket can hold.\n  bucketCntBits = 3\n  bucketCnt     = 1 &lt;&lt; bucketCntBits\n)\n</code></pre>\n</blockquote>\n\n<p>The number of key/value pairs a bucket can hold depends on the number of bits used (<code>bucketCntBits = 3</code>). That translates to a bucket count (<code>bucketCnt</code>) of <code>1 &lt;&lt; bucketCntBits</code> or 8. If we change the number of bits to 4 (<code>bucketCntBits = 4</code>) or 2 (<code>bucketCntBits</code> = 2) then <code>bucketCnt</code> is still <code>1 &lt;&lt; bucketCntBits</code> or 16 or 4. </p>\n\n<blockquote>\n<pre><code>// A map is just a hash table. The data is arranged\n// into an array of buckets. Each bucket contains up to\n// 8 key/value pairs. The low-order bits of the hash are\n// used to select a bucket. Each bucket contains a few\n// high-order bits of each hash to distinguish the entries\n// within a single bucket.\n</code></pre>\n</blockquote>\n\n<p>\"The low-order bits of the hash are used to select a bucket.\"</p>\n\n<p>References:</p>\n\n<p><a href=\"https://golang.org/src/runtime/hashmap.go?h=map\" rel=\"nofollow noreferrer\">src/runtime/hashmap.go</a></p>\n\n<p><a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow noreferrer\">Go maps in action</a></p>\n\n<p><a href=\"https://www.youtube.com/watch?v=Tl7mi9QmLns\" rel=\"nofollow noreferrer\">GopherCon 2016: Keith Randall - Inside the Map Implementation</a></p>\n\n<p><a href=\"https://www.goinggo.net/2013/12/macro-view-of-map-internals-in-go.html\" rel=\"nofollow noreferrer\">Macro View of Map Internals In Go (2013)</a></p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 7186929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b566f357c4e3395a284fc4f3de7831f9?s=128&d=identicon&r=PG&f=1", "display_name": "Enderperson1010", "link": "https://stackoverflow.com/users/7186929/enderperson1010"}, "is_accepted": false, "score": 1, "last_activity_date": 1489290217, "creation_date": 1489290217, "answer_id": 42743496, "question_id": 42743322, "link": "https://stackoverflow.com/questions/42743322/why-dont-they-use-ints-to-define-constants-instead-of-using-bit-shift-operators/42743496#42743496", "title": "Why don&#39;t they use ints to define constants instead of using bit shift operators?", "body": "<p>Using bit shift operators sets <code>bucketCnt</code> to be defined according to the value in <code>bucketCntBits</code>, so if <code>bucketCntBits</code> is changed, <code>bucketCnt</code> will change accordingly. Also, it more clearly expresses how <code>bucketCntBits</code> is related to <code>bucketCnt</code>.</p>\n"}], "owner": {"reputation": 165, "user_id": 3015101, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000322925739/picture?type=large", "display_name": "cafed00d", "link": "https://stackoverflow.com/users/3015101/cafed00d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 1, "accepted_answer_id": 42743466, "answer_count": 2, "score": 0, "last_activity_date": 1489295329, "creation_date": 1489288674, "question_id": 42743322, "link": "https://stackoverflow.com/questions/42743322/why-dont-they-use-ints-to-define-constants-instead-of-using-bit-shift-operators", "title": "Why don&#39;t they use ints to define constants instead of using bit shift operators?", "body": "<p>In the <a href=\"https://golang.org/src/runtime/hashmap.go?h=map\" rel=\"nofollow noreferrer\">go source code</a>, the constant <code>bucketCnt</code> is 8. Why is defined in terms of right-shifting 3 times instead of just defining it as 8.\nI understand that <code>1 &lt;&lt; x</code> implies <code>2^x</code>.</p>\n\n<p>But, my question is...</p>\n\n<p>Is</p>\n\n<pre><code>// Maximum number of key/value pairs a bucket can hold.\nbucketCntBits = 3\nbucketCnt     = 1 &lt;&lt; bucketCntBits\n</code></pre>\n\n<p>better than</p>\n\n<pre><code>// Maximum number of key/value pairs a bucket can hold.\nbucketCnt     = 8\n</code></pre>\n"}, {"tags": ["python", "go"], "comments": [{"owner": {"reputation": 320805, "user_id": 14343, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/75e9a11371cbe1566607180863efdf4c?s=128&d=identicon&r=PG", "display_name": "Ned Batchelder", "link": "https://stackoverflow.com/users/14343/ned-batchelder"}, "edited": false, "score": 3, "creation_date": 1489288486, "post_id": 42743269, "comment_id": 72604125, "body": "99 factorial doesn&#39;t fit in a 64-bit integer."}, {"owner": {"reputation": 383, "user_id": 4634669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-RCOr91QgPvQ/AAAAAAAAAAI/AAAAAAAAAIk/X1Aka8XIDgw/photo.jpg?sz=128", "display_name": "athavan kanapuli", "link": "https://stackoverflow.com/users/4634669/athavan-kanapuli"}, "reply_to_user": {"reputation": 320805, "user_id": 14343, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/75e9a11371cbe1566607180863efdf4c?s=128&d=identicon&r=PG", "display_name": "Ned Batchelder", "link": "https://stackoverflow.com/users/14343/ned-batchelder"}, "edited": false, "score": 0, "creation_date": 1489288687, "post_id": 42743269, "comment_id": 72604154, "body": "Which Golang data type greater than int64 will fit in this category. Should I use float then?"}, {"owner": {"reputation": 5135, "user_id": 5506894, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9jSK1.jpg?s=128&g=1", "display_name": "Denziloe", "link": "https://stackoverflow.com/users/5506894/denziloe"}, "edited": false, "score": 0, "creation_date": 1489288930, "post_id": 42743269, "comment_id": 72604197, "body": "That depends on what you want to do with the output, doesn&#39;t it?"}, {"owner": {"reputation": 383, "user_id": 4634669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-RCOr91QgPvQ/AAAAAAAAAAI/AAAAAAAAAIk/X1Aka8XIDgw/photo.jpg?sz=128", "display_name": "athavan kanapuli", "link": "https://stackoverflow.com/users/4634669/athavan-kanapuli"}, "edited": false, "score": 0, "creation_date": 1489289126, "post_id": 42743269, "comment_id": 72604230, "body": "The goal is just to print the factorial result.So even if use float or decimal , then comes a problem like how do I remove the decimal part.because casting back to int won&#39;t work then since the results will be huge."}, {"owner": {"reputation": 320805, "user_id": 14343, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/75e9a11371cbe1566607180863efdf4c?s=128&d=identicon&r=PG", "display_name": "Ned Batchelder", "link": "https://stackoverflow.com/users/14343/ned-batchelder"}, "edited": false, "score": 2, "creation_date": 1489316885, "post_id": 42743269, "comment_id": 72610122, "body": "I&#39;ve never used Go before, but I&#39;ve used Google: <a href=\"https://golang.org/pkg/math/big/\" rel=\"nofollow noreferrer\">golang.org/pkg/math/big</a>"}], "answers": [{"tags": [], "owner": {"reputation": 63648, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "is_accepted": true, "score": 4, "last_activity_date": 1489288916, "last_edit_date": 1489288916, "creation_date": 1489288517, "answer_id": 42743307, "question_id": 42743269, "link": "https://stackoverflow.com/questions/42743269/golang-factorial-shows-wrong-result/42743307#42743307", "title": "Golang Factorial Shows Wrong Result", "body": "<p>This is the result of overflow. Vanilla Python <code>int</code>s are arbitrarily sized. But if you use a sized int, e.g. 64 bit-ints using <code>numpy</code> for example, you get the same problem:</p>\n\n<pre><code>&gt;&gt;&gt; import numpy as np\n&gt;&gt;&gt; def factorial(n):\n...   if n == 0:\n...     return np.int64(1)\n...   else:\n...     return n * factorial(n - np.int64(1))\n...\n&gt;&gt;&gt; factorial(99)\n__main__:5: RuntimeWarning: overflow encountered in long_scalars\n0\n</code></pre>\n\n<p>I am not a golang programmer, but a quick search yielded the following from the standard library:</p>\n\n<p><a href=\"https://golang.org/pkg/math/big/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/math/big/</a></p>\n"}], "owner": {"reputation": 383, "user_id": 4634669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-RCOr91QgPvQ/AAAAAAAAAAI/AAAAAAAAAIk/X1Aka8XIDgw/photo.jpg?sz=128", "display_name": "athavan kanapuli", "link": "https://stackoverflow.com/users/4634669/athavan-kanapuli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 42743307, "answer_count": 1, "score": 0, "last_activity_date": 1489288916, "creation_date": 1489288008, "question_id": 42743269, "link": "https://stackoverflow.com/questions/42743269/golang-factorial-shows-wrong-result", "title": "Golang Factorial Shows Wrong Result", "body": "<p>I have converted a Python factorial function into a golang program . The Python code is as follows</p>\n\n<pre><code>def  main():\n    n = input('Enter a number')\n    result = factorial(n)\n    print(result)\n\ndef factorial(n):\n    if n == 0:\n        return 1\n    else:\n        return n * factorial(n-1)\n</code></pre>\n\n<p>And the Golang problem is as follows ,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"Enter a Number \")\n    var n int64\n    var result int64\n    fmt.Scan(&amp;n)\n    result = factorial(n)\n    fmt.Println(result)\n}\n\nfunc factorial(n int64) int64 {\n    //fmt.Println(n)\n    if n == 0 {\n        return int64(1)\n    }\n    //fmt.Println(n * factorial(n-1))\n    return int64(n * factorial(n-1))\n\n}\n</code></pre>\n\n<p>The results of both the programs are same for small numbers.But for bigger numbers The Go output is zero.  The Terminal output is as follows ,</p>\n\n<pre><code>enKats-MacBook-Air:Factorials venkat$ python factorial.py\nEnter a number5\n120\nVenKats-MacBook-Air:Factorials venkat$ go run factorial.go\nEnter a Number \n5\n120\nVenKats-MacBook-Air:Factorials venkat$ python factorial.py\nEnter a number99\n933262154439441526816992388562667004907159682643816214685929638952175999932299156089414639761565182862536979208272237582511852109168640000000000000000000000\nVenKats-MacBook-Air:Factorials venkat$ go run factorial.go\nEnter a Number \n99\n0\nVenKats-MacBook-Air:Factorials venkat$ \n</code></pre>\n\n<p>What's wrong with the Go Program for larger numbers? Any help would be appreciated.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "is_accepted": true, "score": 13, "last_activity_date": 1489285675, "creation_date": 1489285675, "answer_id": 42743038, "question_id": 42742766, "link": "https://stackoverflow.com/questions/42742766/how-to-create-a-map-of-strings-from-mapstringinterface/42743038#42743038", "title": "How to create a map of strings from map[string]interface{}?", "body": "<p>Thanks good guys on <a href=\"https://gophers.slack.com/\" rel=\"noreferrer\">gopher slack</a>, I realized what was wrong. \nBasically I just missed {} of the interface, like this:</p>\n\n<pre><code>ud := map[string]interface{}{\"userName\": \"noob\"}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "is_accepted": false, "score": 1, "last_activity_date": 1489378458, "creation_date": 1489378458, "answer_id": 42756529, "question_id": 42742766, "link": "https://stackoverflow.com/questions/42742766/how-to-create-a-map-of-strings-from-mapstringinterface/42756529#42756529", "title": "How to create a map of strings from map[string]interface{}?", "body": "<p>Also you can do like this</p>\n\n<pre><code>ud := make(map[string]interface{})\nud[\"userName\"] = \"noob\"\n</code></pre>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9253, "favorite_count": 2, "accepted_answer_id": 42743038, "answer_count": 2, "score": 5, "last_activity_date": 1489378458, "creation_date": 1489282812, "last_edit_date": 1489285736, "question_id": 42742766, "link": "https://stackoverflow.com/questions/42742766/how-to-create-a-map-of-strings-from-mapstringinterface", "title": "How to create a map of strings from map[string]interface{}?", "body": "<p>Noob gopher here. \nI'd like to fill data into this struct field:</p>\n\n<pre><code>userData map[string]interface{}\n</code></pre>\n\n<p>The data is like: </p>\n\n<pre><code>ud := map[string]string{\"userName\": \"noob\"}\n</code></pre>\n\n<p>but I get this comple time error:</p>\n\n<blockquote>\n  <p>cannot use ud (type map[string]string) as type map[string]interface {}\n  in field value</p>\n</blockquote>\n\n<p>I also tried:</p>\n\n<pre><code>ud := map[string]interface{\"userName\": \"noob\".(string)}\n</code></pre>\n\n<p>but this gives:</p>\n\n<blockquote>\n  <p>syntax error: unexpected string literal</p>\n</blockquote>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["go", "type-assertion"], "answers": [{"comments": [{"owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1489276299, "post_id": 42741984, "comment_id": 72601877, "body": "couldn&#39;t you do it in one line, do we need separate declaration and assignment"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1489276853, "post_id": 42741984, "comment_id": 72602001, "body": "@user2727195 <code>z.(Zoo).animals =</code> what do you think this expression should do? What it does - it creates a temporary object that is to be thrown away after this statement. Hence, a question: what does it mean to assign a value to an object&#39;s field that you would not be able to access? You basically can remove that line and the observed behaviour of a program would not change."}, {"owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489277069, "post_id": 42741984, "comment_id": 72602044, "body": "@zerkms is there an explanation on the docs about this temporary object"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1489277307, "post_id": 42741984, "comment_id": 72602097, "body": "I&#39;m not sure. It&#39;s a generic knowledge - structs in Go copy on assignment."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1489277720, "post_id": 42741984, "comment_id": 72602186, "body": "to clarify, <i>everything</i> in Go is a copy on assignment."}], "tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": false, "score": 1, "last_activity_date": 1489275460, "creation_date": 1489275460, "answer_id": 42741984, "question_id": 42741920, "link": "https://stackoverflow.com/questions/42741920/type-assertion-errors-when-casting-from-interface-to-actual-object/42741984#42741984", "title": "Type assertion errors when casting from interface to actual object", "body": "<p>The error message says it all: you need a <a href=\"https://tour.golang.org/methods/15\" rel=\"nofollow noreferrer\">type assertion</a>.</p>\n\n<pre><code>y := z.(Zoo)\ny.animals = map[string]IAnimal{}\n</code></pre>\n"}], "owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489297161, "creation_date": 1489274989, "last_edit_date": 1592644375, "question_id": 42741920, "link": "https://stackoverflow.com/questions/42741920/type-assertion-errors-when-casting-from-interface-to-actual-object", "title": "Type assertion errors when casting from interface to actual object", "body": "<p>Encountering type assertion errors in the example below.</p>\n<p>Errors:</p>\n<blockquote>\n<p>49: cannot convert z (type IZoo) to type Zoo: need type assertion</p>\n<p>49: cannot assign to Zoo(z).animals</p>\n</blockquote>\n<pre><code>type IAnimal interface {}\n\ntype IZoo interface {}\n\ntype Zoo struct {\n    animals map[string]IAnimal\n}\n\nfunc NewZoo() *Zoo {\n    var z IZoo = &amp;Zoo{}\n\n    Zoo(z).animals = map[string]IAnimal{} // cannot convert z (type IZoo) to type Zoo: need type assertion\n    \n    return z // cannot use z (type IZoo) as type *Zoo in return argument: need type assertion\n}\n</code></pre>\n"}]