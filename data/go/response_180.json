[{"tags": ["go", "process", "sleep", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 4316, "user_id": 486035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1654e9816b6e407e1daced17ac4fcf3b?s=128&d=identicon&r=PG", "display_name": "phemmer", "link": "https://stackoverflow.com/users/486035/phemmer"}, "is_accepted": false, "score": 3, "last_activity_date": 1529541580, "last_edit_date": 1529541580, "creation_date": 1529540540, "answer_id": 50958742, "question_id": 50958579, "link": "https://stackoverflow.com/questions/50958579/change-the-time-of-goroutine-sleeping/50958742#50958742", "title": "Change the time of goroutine sleeping", "body": "<p>One method is to use a <a href=\"https://golang.org/pkg/context/#Context\" rel=\"nofollow noreferrer\"><code>context</code></a> object. Specifically one created with <a href=\"https://golang.org/pkg/context/#WithTimeout\" rel=\"nofollow noreferrer\"><code>WithTimeout</code></a>.</p>\n\n<p>The context object provides a way of sending a \"cancel\" signal to a worker. In this case your worker is not really doing anything, but still fits the paradigm.</p>\n\n<p>Example would be:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nfunc sleep(ctx context.Context, wg *sync.WaitGroup) {\n    sctx, _ := context.WithTimeout(ctx, 5*time.Second)\n    tStart := time.Now()\n    &lt;-sctx.Done() // will sit here until the timeout or cancelled\n    tStop := time.Now()\n    fmt.Printf(\"Slept for %s\\n\", tStop.Sub(tStart))\n    wg.Done()\n}\n\nfunc main() {\n    ctx, cancelFunc := context.WithCancel(context.Background())\n    wg := sync.WaitGroup{}\n    wg.Add(1)\n    go sleep(ctx, &amp;wg)\n\n    if true {\n        time.Sleep(3 * time.Second)\n        cancelFunc()\n    }\n    wg.Wait()\n}\n</code></pre>\n\n<p><sup><a href=\"https://play.golang.org/p/2Krx4PsxFKL\" rel=\"nofollow noreferrer\">https://play.golang.org/p/2Krx4PsxFKL</a></sup></p>\n\n<p>Change the <code>if true {</code> to <code>if false {</code> and you can see the <code>Slept for ...</code> change.</p>\n"}, {"comments": [{"owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "edited": false, "score": 0, "creation_date": 1529593491, "post_id": 50958767, "comment_id": 88940069, "body": "Do you create several goroutines?  Yes. It&#39;s not what I ment. Because I wanted something whereby I can manage that unique goroutine.  Like giving commands to it  &quot;Sleep 50 sec&quot;, after 1 sec another command &quot;sleep 30 sec&quot; and after 5 sec &quot;sleep 0.5 sec&quot;."}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 3, "last_activity_date": 1529540926, "creation_date": 1529540926, "answer_id": 50958767, "question_id": 50958579, "link": "https://stackoverflow.com/questions/50958579/change-the-time-of-goroutine-sleeping/50958767#50958767", "title": "Change the time of goroutine sleeping", "body": "<p>If you just need a way to \"wakeup\" a sleeping goroutine, you could use <code>sync.Once</code> to ensure your function only gets called once, and then return a channel so you can set a sooner \"trigger time\", so something this:</p>\n\n<pre><code>func sleep(callback func(), seconds int) chan int {\n    once := sync.Once{}\n    wakeup := make(chan int)\n    go func() {\n        for sleep := range wakeup {\n            go func() {\n                time.Sleep(time.Duration(sleep) * time.Second)\n                once.Do(callback)\n            }()\n        }\n    }()\n    wakeup &lt;- seconds\n    return wakeup\n}\n\n\nfunc main() {\n        wg := sync.WaitGroup{}\n        wg.Add(1)\n        t := time.Now()\n        wakeup := sleep(func() {\n            fmt.Println(\"Hello, playground\")\n            wg.Done()\n        }, 5)\n        wakeup &lt;- 2\n        wg.Wait()\n        fmt.Println(time.Since(t))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/BRNtaBPKpLW\" rel=\"nofollow noreferrer\">https://play.golang.org/p/BRNtaBPKpLW</a></p>\n"}, {"tags": [], "owner": {"reputation": 4316, "user_id": 486035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1654e9816b6e407e1daced17ac4fcf3b?s=128&d=identicon&r=PG", "display_name": "phemmer", "link": "https://stackoverflow.com/users/486035/phemmer"}, "is_accepted": false, "score": 2, "last_activity_date": 1529541622, "last_edit_date": 1529541622, "creation_date": 1529541270, "answer_id": 50958803, "question_id": 50958579, "link": "https://stackoverflow.com/questions/50958579/change-the-time-of-goroutine-sleeping/50958803#50958803", "title": "Change the time of goroutine sleeping", "body": "<p>One method is to use a <a href=\"https://golang.org/pkg/time/#Timer\" rel=\"nofollow noreferrer\"><code>timer</code></a>. You can call <a href=\"https://golang.org/pkg/time/#Timer.Stop\" rel=\"nofollow noreferrer\"><code>Stop()</code></a> on a timer, but this stops it without waking up whatever is waiting on it. So you then use <a href=\"https://golang.org/pkg/time/#Timer.Reset\" rel=\"nofollow noreferrer\"><code>Reset()</code></a> to set it to a new value, specifically <code>0</code>, which triggers it immediately.</p>\n\n<p>Example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nfunc sleep(wg *sync.WaitGroup) *time.Timer {\n    timer := time.NewTimer(5 * time.Second)\n    go func() {\n        tStart := time.Now()\n        &lt;-timer.C\n        tStop := time.Now()\n        fmt.Printf(\"Slept for %s\\n\", tStop.Sub(tStart))\n        wg.Done()\n    }()\n    return timer\n}\n\nfunc main() {\n    wg := sync.WaitGroup{}\n    wg.Add(1)\n    timer := sleep(&amp;wg)\n    if true {\n        time.Sleep(3 * time.Second)\n        if timer.Stop() {\n            timer.Reset(0)\n        }\n    }\n    wg.Wait()\n}\n</code></pre>\n\n<p><sup><a href=\"https://play.golang.org/p/b3I65kAujR4\" rel=\"nofollow noreferrer\">https://play.golang.org/p/b3I65kAujR4</a></sup></p>\n\n<p>Change the <code>if true {</code> to <code>if false {</code> and you can see the <code>Slept for ...</code> change.</p>\n"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1129, "favorite_count": 0, "accepted_answer_id": 50958767, "answer_count": 3, "score": 2, "last_activity_date": 1529595339, "creation_date": 1529538840, "last_edit_date": 1529595339, "question_id": 50958579, "link": "https://stackoverflow.com/questions/50958579/change-the-time-of-goroutine-sleeping", "title": "Change the time of goroutine sleeping", "body": "<p>In <code>Go</code> I can write such code for creating a gorouting that sleeps <code>5</code> sec.</p>\n\n<pre><code>func sleep(link chan interface{}){\n    time.Sleep(5 * time.Second)\n    fmt.Println(\"I've slept for 5 sec\")\n    link &lt;- struct {}{}\n}\n\nfunc main() {\n    var link = make(chan interface{})\n    go sleep(link)\n    time.Sleep(1 * time.Second)\n    // here I want to change the remaining sleeping time of `sleep` goroutine to 0.5 sec\n    &lt;- link\n}\n</code></pre>\n\n<p>What if in <code>main</code> function I change my mind and decide that the sleeper should sleep not <code>5</code> sec but <code>3</code>. How can it done if goroutine already started to sleep (and sleeping, for example, for <code>1</code> sec)?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I mean is there <em>something</em> whereby I can manage that unique goroutine while it sleeps. Like giving commands to it about decreasing or increasing time of sleep:</p>\n\n<pre><code>func main() {\n    // ...\n    time.Sleep(1)\n    something.ManageRemainingTime(10)\n    time.Sleep(5)\n    something.ManageRemainingTime(100)\n    time.Sleep(8)\n    something.ManageRemainingTime(0.5)\n    // ...\n}\n</code></pre>\n"}, {"tags": ["go", "parameter-passing", "variadic-functions", "optional-parameters"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1529537148, "post_id": 50958365, "comment_id": 88913991, "body": "I&#39;m not sure what a &quot;parametric function&quot; is, but your signatures don&#39;t match -- <code>&quot;func(*Server)&quot; != &quot;func(*Server) error&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 6582277, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ANI5NB97LwI/AAAAAAAAAAI/AAAAAAAAAzM/IP7Xk8-3Ow4/photo.jpg?sz=128", "display_name": "Reza MT", "link": "https://stackoverflow.com/users/6582277/reza-mt"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1529537476, "post_id": 50958365, "comment_id": 88914067, "body": "Thanks JimB. I have functions with optional parameters - I found the article on web and it was a good approach. I have added the link to my post."}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 6447904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28134871a7c3d72a8031ff1b74fd57e7?s=128&d=identicon&r=PG&f=1", "display_name": "renaissanceGeek", "link": "https://stackoverflow.com/users/6447904/renaissancegeek"}, "is_accepted": false, "score": 0, "last_activity_date": 1529545677, "creation_date": 1529545677, "answer_id": 50959237, "question_id": 50958365, "link": "https://stackoverflow.com/questions/50958365/golang-parametric-functions/50959237#50959237", "title": "Golang Parametric Functions", "body": "<p>As JimB pointed out, the signatures need to match entirely, including the return value. In your sample code, either have port return error, e.g.:</p>\n\n<pre><code>port := func(srv *Server) error {\n    srv.Port = 8080\n    return nil\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/LYb846jBD-m\" rel=\"nofollow noreferrer\">https://play.golang.org/p/LYb846jBD-m</a></p>\n\n<p>Or remove error from the definition of NewServer:</p>\n\n<pre><code>func NewServer(name string, options ...func(srv *Server)) *Server\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/4PGN3TRkBpq\" rel=\"nofollow noreferrer\">https://play.golang.org/p/4PGN3TRkBpq</a></p>\n"}], "owner": {"reputation": 1, "user_id": 6582277, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ANI5NB97LwI/AAAAAAAAAAI/AAAAAAAAAzM/IP7Xk8-3Ow4/photo.jpg?sz=128", "display_name": "Reza MT", "link": "https://stackoverflow.com/users/6582277/reza-mt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529545677, "creation_date": 1529536982, "question_id": 50958365, "link": "https://stackoverflow.com/questions/50958365/golang-parametric-functions", "title": "Golang Parametric Functions", "body": "<p>I am trying to use Go parametric functions as its described in the following link \n<a href=\"https://dave.cheney.net/2014/10/17/functional-options-for-friendly-apis\" rel=\"nofollow noreferrer\">Functional options for friendly APIs</a> - however I am getting a type error which I am not sure why. </p>\n\n<p>I am adding my code here for your review:</p>\n\n<p><a href=\"https://play.golang.org/p/xJX_mrGJO8a\" rel=\"nofollow noreferrer\">Sample Code Here</a></p>\n\n<p>The error message is:</p>\n\n<blockquote>\n  <p>prog.go:35:18: cannot use port (type func(*Server)) as type func(*Server) error in argument to NewServer</p>\n</blockquote>\n"}, {"tags": ["go", "linked-list"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1529536260, "post_id": 50958063, "comment_id": 88913816, "body": "You seem to understand that the pointers end up being shared; are you just asking how to copy a <code>*list.List</code>?"}, {"owner": {"reputation": 96, "user_id": 6447904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28134871a7c3d72a8031ff1b74fd57e7?s=128&d=identicon&r=PG&f=1", "display_name": "renaissanceGeek", "link": "https://stackoverflow.com/users/6447904/renaissancegeek"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1529544432, "post_id": 50958063, "comment_id": 88915474, "body": "Yes, perhaps that&#39;s the real crux of the question.  I was thinking that dereferencing the pointer would make it behave like an object; I still have my C++ mentality and haven&#39;t internalized value-semantics vs pointer-semantics in go. Undoubtedly, the idiomatic way would be to use slices instead. :-) But is there an elegant way to copy *list.List?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1529589193, "post_id": 50958063, "comment_id": 88936817, "body": "Slices would have the same problem, since they contain a pointer to the backing array. You copy a list by copying the elements of one list to another, which is the simple for loop shown in the documentation for iterating over a List."}], "answers": [{"tags": [], "owner": {"reputation": 480, "user_id": 9448870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ckK5P.jpg?s=128&g=1", "display_name": "Daniel Sch&#252;tte", "link": "https://stackoverflow.com/users/9448870/daniel-sch%c3%bctte"}, "is_accepted": false, "score": 1, "last_activity_date": 1529873752, "creation_date": 1529873752, "answer_id": 51013895, "question_id": 50958063, "link": "https://stackoverflow.com/questions/50958063/how-can-i-create-a-golang-struct-wrapping-a-container-list-list/51013895#51013895", "title": "How can I create a golang struct wrapping a container/list.List?", "body": "<p>I think @JimB's suggestion to make a local copy of your list whenever you're pushing a value to <code>listHolder.mylist</code> could be a good solution to your problem (given, that I understand the underlying issue correctly). I tried to come up with an implementation that looks like the following:</p>\n\n<pre><code>package main\n\nimport (\n    \"container/list\"\n    \"fmt\"\n)\n\ntype listHolder struct {\n    id     int\n    mylist list.List\n}\n\nfunc newListHolder(id int) listHolder { // don't push back when constructing a new listHolder\n    var newLH listHolder\n    newLH.mylist = *list.New()\n    newLH.id = id\n    return newLH\n}\n\nfunc (l *listHolder) pushBack(text string) {\n    // create a temporary list to copy all old and the new value to\n    tmpList := list.New()\n\n    // copy all existing values from l.mylist\n    for e := l.mylist.Front(); e != nil; e = e.Next() {\n        fmt.Printf(\"pushing back '%v' from old list\\n\", e.Value)\n        tmpList.PushBack(e.Value)\n    }\n\n    // push back the new value\n    tmpList.PushBack(text)\n\n    // print the new tmpList for debugging purposes\n    for ele := tmpList.Front(); ele != nil; ele = ele.Next() {\n        fmt.Printf(\"creating new list element: %v\\n\", ele.Value)\n    }\n\n    // replace l.mylist with tmpList\n    l.mylist = *tmpList\n    // another version of this solution could be to return a new (i.e. copied) \n    // *listHolder with all the old values and the new 'text' value\n}\n\nfunc (l *listHolder) printAll() {\n    for temp := l.mylist.Front(); temp != nil; temp = temp.Next() {\n        fmt.Println(temp.Value)\n    }\n}\n\nfunc main() {\n    a := newListHolder(1)\n    a.pushBack(\"first\")  // push a value to a\n    a.pushBack(\"second\") // push another value to a\n    fmt.Printf(\"listHolder %d length %d Front()=%v, Back()=%v\\n\",\n        a.id, a.mylist.Len(), a.mylist.Front().Value, a.mylist.Back().Value)\n    a.printAll()\n}\n</code></pre>\n\n<p>This code outputs:</p>\n\n<pre><code>creating new list element: first                         // nothing to copy, only creating a new list element\npushing back 'first' from old list                       // copy element ...\ncreating new list element: first                         // ... from old list\ncreating new list element: second                        // and push new element to 'tmpList'\nlistHolder 1 length 2 Front()=first, Back()=second       // print a summary\nfirst                                                    // of the\nsecond                                                   // new list\n</code></pre>\n\n<p>If I had some mock data, I could do some more testing/debugging. At least this code works without a <code>*list.List</code>.</p>\n"}], "owner": {"reputation": 96, "user_id": 6447904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28134871a7c3d72a8031ff1b74fd57e7?s=128&d=identicon&r=PG&f=1", "display_name": "renaissanceGeek", "link": "https://stackoverflow.com/users/6447904/renaissancegeek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1481, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1529873752, "creation_date": 1529534667, "question_id": 50958063, "link": "https://stackoverflow.com/questions/50958063/how-can-i-create-a-golang-struct-wrapping-a-container-list-list", "title": "How can I create a golang struct wrapping a container/list.List?", "body": "<p>I am scratching my head over an unexpected difference between having my struct contain list.List vs *list.List.  Why doesn't the following work?</p>\n\n<pre><code>type listHolder struct {\n    id     int\n    mylist list.List\n}\n\nfunc newListHolder(id int, text string) listHolder {\n    var newLH listHolder\n    newLH.mylist = *list.New()\n    newLH.id = id\n    newLH.mylist.PushBack(text)\n    return newLH\n}\n\nfunc (l *listHolder) pushBack(text string) {\n    l.mylist.PushBack(text)\n}\n\nfunc (l *listHolder) printAll() {\n    for temp := l.mylist.Front(); temp != nil; temp = temp.Next() {\n        fmt.Println(temp.Value)\n    }\n}\n\n\nfunc main() {\n    a := newListHolder(1, \"first\") \n    a.pushBack(\"second\")\n    fmt.Printf(\"listHolder %d length %d Front()= %v, Back()=%v\\n\",\n         a.id, a.mylist.Len(), a.mylist.Front().Value, a.mylist.Back().Value)\n    a.printAll()\n}\n</code></pre>\n\n<p>This outputs the following, showing that the length is as expected but the Front() and Back() methods don't work.</p>\n\n<pre><code>listHolder 1 length 2 Front()= `&lt;nil&gt;`, Back()=&lt;nil&gt;\n&lt;nil&gt;\n</code></pre>\n\n<p>If I define the struct as </p>\n\n<pre><code>// Same thing with a pointer\ntype listHolderPtr struct {\n    id     int\n    mylist *list.List\n}\n\nfunc newListHolderPtr(id int, text string) listHolderPtr {\n    var newLH listHolderPtr\n    newLH.mylist = list.New()\n    newLH.id = id\n    newLH.mylist.PushBack(text)\n    return newLH\n}\n</code></pre>\n\n<p>that works as expected, but of course, any copies of the listHolder struct share a reference to the same list, which is not what I want.  I need to be able to copy the surrounding object and get a new copy of the internal list. Is that possible?</p>\n\n<p>See <a href=\"https://play.golang.org/p/KCtTwuvaS1R\" rel=\"nofollow noreferrer\">https://play.golang.org/p/KCtTwuvaS1R</a> for a simplified example of what I'm trying to do. In the real use case, I'll be pushing onto the back and popping off the front of each listHolder in a slice of listHolder in a complicated nested loop.</p>\n"}, {"tags": ["inheritance", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1529531399, "post_id": 50957518, "comment_id": 88912490, "body": "There is no &quot;inheritance&quot; in go, simply composition with some syntactic sugar on top."}], "answers": [{"tags": [], "owner": {"reputation": 2208, "user_id": 5328069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21DZ0.jpg?s=128&g=1", "display_name": "morganbaz", "link": "https://stackoverflow.com/users/5328069/morganbaz"}, "is_accepted": true, "score": 1, "last_activity_date": 1529532185, "creation_date": 1529532185, "answer_id": 50957702, "question_id": 50957518, "link": "https://stackoverflow.com/questions/50957518/executing-actual-object-method-from-inherited-struct-without-cast-type-to-inheri/50957702#50957702", "title": "Executing actual object method from inherited struct without cast type to inherited type", "body": "<p>As JimB said, there is no proper inheritance in Go as in other languages. To help visualize this, let's take your code in <code>main()</code>:</p>\n\n<pre><code>a := &amp;A{}\nb := &amp;B{}\n\na.Parse()\nb.Parse()\n</code></pre>\n\n<p>When <code>a.Parse()</code> is called, the Go compiler checks if <code>a</code> has a method <code>Parse()</code>, and it does. So it calls the method <code>a.Parse</code>.</p>\n\n<p>When <code>b.Parse()</code> is called, the Go compiler checks if <code>b</code> has a method <code>Parse()</code>, and it does not - but an embedded field inside the struct does! So it simply uses the method from that field, and thus <code>b.A.Parse()</code> is called. In fact, you could change B to this:</p>\n\n<pre><code>type B struct {\n    A A\n}\n</code></pre>\n\n<p>And the only difference would be that <code>b.Parse()</code> wouldn't work and that you'd have to specify <code>.A</code> manually (thus <code>b.A.Parse()</code>), but it remains functionally the same.</p>\n\n<hr>\n\n<p>Further reading:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/32188653/5328069\">Golang and inheritance</a></li>\n<li><a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">Effective Go - Embedding</a></li>\n</ul>\n"}], "owner": {"reputation": 9, "user_id": 9969873, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-U7oTds5Jajw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1VzHz6bTBktBmIA1rbrSyMXPjsMQ/mo/photo.jpg?sz=128", "display_name": "Dawid Bia\u0142y", "link": "https://stackoverflow.com/users/9969873/dawid-bia%c5%82y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 50957702, "answer_count": 1, "score": -1, "last_activity_date": 1529534102, "creation_date": 1529531130, "last_edit_date": 1529534102, "question_id": 50957518, "link": "https://stackoverflow.com/questions/50957518/executing-actual-object-method-from-inherited-struct-without-cast-type-to-inheri", "title": "Executing actual object method from inherited struct without cast type to inherited type", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype IA interface {\n    Parse()\n    Name() string\n}\n\ntype A struct {\n    IA\n}\n\nfunc (a *A) Name() string {\n    return \"AName\"\n}\n\nfunc (a *A) Parse() {\n    fmt.Println(\"A-\" + a.Name())\n}\n\ntype B struct {\n    A\n}\n\nfunc (b *B) Name() string {\n    return \"BName\"\n}\n\n\nfunc main() {\n    a := &amp;A{}\n    b := &amp;B{}\n\n    a.Parse()\n    b.Parse() // I would like to see \"A-BName\"\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Z2hSBoakKHy\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<p>When I execute method from inherited struct with execute another struct method in it - is executed method from inherited struct, not actual object type.</p>\n"}, {"tags": ["go", "devops", "alpine", "hashicorp-vault"], "answers": [{"tags": [], "owner": {"reputation": 1973, "user_id": 2056426, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Ge8I5.png?s=128&g=1", "display_name": "delos", "link": "https://stackoverflow.com/users/2056426/delos"}, "is_accepted": true, "score": 1, "last_activity_date": 1529679576, "creation_date": 1529679576, "answer_id": 50990716, "question_id": 50956982, "link": "https://stackoverflow.com/questions/50956982/vault-token-helper-not-being-detected/50990716#50990716", "title": "Vault Token Helper not being detected?", "body": "<p>Figured this out, it was because the <code>os.exec(\"vault\", \"operator\", \"init\")</code> line did not inherit the <code>VAULT_CONFIG_PATH</code> variable setting from the host, and so it was empty.</p>\n\n<p>The following shows how to give <code>os.Exec</code> environment variables during it's run:</p>\n\n<pre><code>    vaultInitCmd := exec.Command(\"vault\", \"operator\", \"init\")\n    vaultInitCmd.Env = []string{\n    fmt.Sprintf(`VAULT_ADDR=%s`, addr),\n    fmt.Sprintf(`VAULT_CONFIG_PATH=%s`, `/home/myuser/.vault`)}\n</code></pre>\n"}], "owner": {"reputation": 1973, "user_id": 2056426, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Ge8I5.png?s=128&g=1", "display_name": "delos", "link": "https://stackoverflow.com/users/2056426/delos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 998, "favorite_count": 0, "accepted_answer_id": 50990716, "answer_count": 1, "score": 4, "last_activity_date": 1529679576, "creation_date": 1529528592, "last_edit_date": 1529529169, "question_id": 50956982, "link": "https://stackoverflow.com/questions/50956982/vault-token-helper-not-being-detected", "title": "Vault Token Helper not being detected?", "body": "<p><strong>Problem:</strong></p>\n\n<p>I have three files in a <code>vault:0.10.2</code> docker image at the following locations:</p>\n\n<p><code>/home/myuser/token_helper</code>: A token helper binary in Go that implements the token helper interface according to <a href=\"https://www.hashicorp.com/blog/building-a-vault-token-helper\" rel=\"nofollow noreferrer\">this documentation</a></p>\n\n<p><code>/home/myuser/vault_start</code>: A Go script that runs <code>os.exec(\"vault\", \"operator\", \"init\")</code> and <code>os.exec(\"vault\", \"server\", \"-config=myconfig.hcl\")</code></p>\n\n<p><code>/home/myuser/.vault</code>: The token helper config file specifying the token helper binary location, and I've exported <code>VAULT_CONFIG_PATH</code> to point to this path. The file reads <code>token_helper = \"/home/myuser/token_helper\"</code>. </p>\n\n<p>The problem I'm seeing is while running the <code>vault_start</code> script, I get the following error:</p>\n\n<pre><code>failed to get token helper: error expanding config path \"\": exec: \"getent\": executable file not found in $PATH\n</code></pre>\n\n<p><strong>Debugging Done So Far</strong>:</p>\n\n<p>This error doesn't seem to be correct. <code>which getent</code> returns <code>/usr/bin/getent</code>, and the image <code>$PATH</code> contains it, proving that both exist. In addition, the config path is not <code>\"\"</code>, it's set as <code>/home/myuser/.vault</code> but Vault detects it as empty apparently.</p>\n\n<p>I've traced that error output to <a href=\"https://github.com/ebekker/hashicorp-vault/blob/master/command/config.go#L59\" rel=\"nofollow noreferrer\">this file</a> in Vault's <code>command</code> directory: . According to that block of code, it only errors out when <code>$HOME</code> is not set, but I've confirmed that <code>$HOME</code> is set in the shell. </p>\n\n<p>In addition, I've specified everything that Vault has asked in order to implement the token helper according to <a href=\"https://www.hashicorp.com/blog/building-a-vault-token-helper\" rel=\"nofollow noreferrer\">this document</a>, but it doesn't seem to be detecting the config file to run it. This seems to be an error with Vault, or am I missing something?</p>\n"}, {"tags": ["go", "webp"], "comments": [{"owner": {"reputation": 630, "user_id": 4484994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-3u-HviiJiKY/AAAAAAAAAAI/AAAAAAAAAFM/h4Nq7C48_Pg/photo.jpg?sz=128", "display_name": "Ali Padida", "link": "https://stackoverflow.com/users/4484994/ali-padida"}, "edited": false, "score": 0, "creation_date": 1532175641, "post_id": 50956664, "comment_id": 89881414, "body": "did you solve your problem? how, if you did?"}, {"owner": {"reputation": 11, "user_id": 6759806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d08e46430b8ac1c4f98d9e0c6512a0b?s=128&d=identicon&r=PG&f=1", "display_name": "rbxb", "link": "https://stackoverflow.com/users/6759806/rbxb"}, "reply_to_user": {"reputation": 630, "user_id": 4484994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-3u-HviiJiKY/AAAAAAAAAAI/AAAAAAAAAFM/h4Nq7C48_Pg/photo.jpg?sz=128", "display_name": "Ali Padida", "link": "https://stackoverflow.com/users/4484994/ali-padida"}, "edited": false, "score": 0, "creation_date": 1533861667, "post_id": 50956664, "comment_id": 90513114, "body": "Hi. Sorry for the late reply. The issue was solved here: <a href=\"https://github.com/golang/go/issues/26001\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/26001</a>."}], "owner": {"reputation": 11, "user_id": 6759806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d08e46430b8ac1c4f98d9e0c6512a0b?s=128&d=identicon&r=PG&f=1", "display_name": "rbxb", "link": "https://stackoverflow.com/users/6759806/rbxb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 434, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1533862499, "creation_date": 1529527029, "last_edit_date": 1533862499, "question_id": 50956664, "link": "https://stackoverflow.com/questions/50956664/decode-webp-with-non-alpha-premultiplied-colors", "title": "Decode WebP with non-alpha-premultiplied colors", "body": "<p>I am trying to convert WebP images to PNGs but I am having some difficulties with the WebP, Image, and Color packages.<br>\nThe <a href=\"https://godoc.org/golang.org/x/image/webp\" rel=\"nofollow noreferrer\">WebP decoding package</a> returns an <a href=\"https://godoc.org/image#Image\" rel=\"nofollow noreferrer\"><code>image.Image</code></a>, which uses alpha-premultiplied colors.  </p>\n\n<p><a href=\"https://golang.org/pkg/image/color/#Color\" rel=\"nofollow noreferrer\">https://golang.org/pkg/image/color/#Color</a></p>\n\n<pre><code>type Color interface {\n        // An alpha-premultiplied color component c has been scaled by alpha (a),\n        // so has valid values 0 &lt;= c &lt;= a.\n        RGBA() (r, g, b, a uint32)\n}\n</code></pre>\n\n<p>The problem is the WebP textures that I am trying to convert use the alpha channel as a <a href=\"https://en.wikipedia.org/wiki/Specularity\" rel=\"nofollow noreferrer\">specular map</a> rather than for transparency. So even if the alpha on a particular pixel is 0, the color value is still important.<br>\nBut with alpha-premultiplication, that pixel's color data would be irreversibly lost because <code>anything * 0 = 0</code>.  </p>\n\n<p>Here is my code to convert WebP to PNG:</p>\n\n<pre><code>if extension == \".webp\" {\n\n    //open the WebP file\n    webpFile, err := os.OpenFile(fp, os.O_RDWR, 0777)\n    defer webpFile.Close()\n    if err != nil {\n        return\n    }\n\n    //create reader\n    reader := bufio.NewReader(webpFile)\n\n    //decode the WebP into an image.Image\n    img, err := webp.Decode(reader)\n    if err != nil {\n        return\n    }\n    webpFile.Close()\n\n    //create the new PNG file\n    os.MkdirAll(destination + parentDirs, 0755)\n    pngFile, err := os.Create(destination + parentDirs + baseName + \".png\")\n    defer pngFile.Close()\n    if err != nil {\n        return\n    }\n\n    //write to the PNG file\n    err = png.Encode(pngFile,img)\n    if err != nil {\n        return\n    }\n\n}\n</code></pre>\n\n<p><strong>What I want is to output a PNG that is fully opaque and retains all of the color data that was in the original WebP, even if a given pixel in the WebP was partially or fully transparent.</strong><br>\ni.e. if I could just take the original texture and set every pixel's alpha value to 1 without disturbing the RGB values.  </p>\n\n<p>I have tried converting the <a href=\"https://golang.org/pkg/image/color/#Model\" rel=\"nofollow noreferrer\">color model</a> for the <code>img</code>, but I am still confused on how the model system works. I don't think this would solve the problem anyway because, as I understand, the conversion would still convert from the already alpha-premultiplied colors.<br>\nI have also tried undoing the alpha-premultplication for each pixel in <code>img</code> by dividing each RGB value by the alpha. This works except for when the alpha was 0 because then all of the RGB data was lost when it was multiplied by 0.  </p>\n\n<p>So is there any way to convert from WebP to an <code>image.Image</code> and then to a PNG without alpha-premultiplied colors?  </p>\n\n<p><strong>Edit:</strong><br>\nThis was solved here: <a href=\"https://github.com/golang/go/issues/26001\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/26001</a><br>\nI used separate functions to handle transparent WebPs.  </p>\n\n<pre><code>func ConvertNYCbCrA(Color color.NYCbCrA) color.RGBA {\n    r,g,b := color.YCbCrToRGB(Color.Y,Color.Cb,Color.Cr)\n    return color.RGBA{r,g,b,255}\n}\n\nfunc ConvertNRGBA(Color color.NRGBA) color.RGBA {\n    return color.RGBA{\n        Color.R,\n        Color.G,\n        Color.B,\n        255,\n    }\n}\n\n/************************/\n\nif extension == \".webp\" {\n\n    //open the WebP file\n    webpFile, _ := os.OpenFile(filepath, os.O_RDWR, 0777)\n    defer webpFile.Close()\n\n    //create a reader\n    reader := bufio.NewReader(webpFile)\n\n    //decode the WebP\n    imageData, _ := webp.Decode(reader)\n    webpFile.Close()\n\n    //create new image\n    newImage := image.NewRGBA(imageData.Bounds())\n\n    //fill new image with pixels\n    for y := imageData.Bounds().Min.Y; y &lt; imageData.Bounds().Max.Y; y++ {\n        for x := imageData.Bounds().Min.X; x &lt; imageData.Bounds().Max.X; x++ {\n\n            //get pixel from imageData\n            pixel := imageData.At(x,y)\n\n            //convert pixel to RGBA\n            var RGBApixel color.RGBA\n            switch imageData.ColorModel() {\n\n                case color.NYCbCrAModel:\n                    RGBApixel = ConvertNYCbCrA(pixel.(color.NYCbCrA))\n\n                case color.NRGBAModel:\n                    RGBApixel = ConvertNRGBA(pixel.(color.NRGBA))\n\n                default:\n                    RGBApixel = color.RGBAModel.Convert(pixel).(color.RGBA)\n                    RGBApixel.A = 255\n\n            }\n\n            //set new pixel in new image\n            newImage.Set(x,y,RGBApixel)\n\n        }\n    }\n\n    //create the new PNG file\n    pngFile, _ := os.Create(newFilePath + \".png\")\n    defer pngFile.Close()\n\n    //write to the PNG file\n    png.Encode(pngFile, newImage)\n\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1529522420, "post_id": 50955532, "comment_id": 88908760, "body": "The standard library <code>flag</code> package is case-sensitive."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1529522842, "post_id": 50955532, "comment_id": 88908942, "body": "@Adrian: And since that&#39;s the case (I seriously didn&#39;t intend that as a pun), I presume that most Go programs have case-sensitive flag names, as do most programs that are intended for use under Unix-like systems. I&#39;d question the user-friendliness of violating that convention. (I wonder about the convention for Windows programs, but I&#39;m not curious enough to do any research.)"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1529523186, "post_id": 50955532, "comment_id": 88909095, "body": "Typical classical windows command line is case-insensitive, but customarily uppercase. Flags are single-character and denoted by forward slashes rather than dashes. Modern powershell scripts use more unix-like flags, but are still case-insensitive."}], "answers": [{"tags": [], "owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "is_accepted": true, "score": 6, "last_activity_date": 1529527629, "creation_date": 1529527629, "answer_id": 50956799, "question_id": 50955532, "link": "https://stackoverflow.com/questions/50955532/ignore-flag-case/50956799#50956799", "title": "Ignore flag case", "body": "<p>Go flags are case-sensitive, so you can't do what you want by default.\nBut you can set the values you allow the user enter, and let them point to the same variable, ie:</p>\n\n<pre><code>const dbTypeUsage = \"The `dbType` to deploy.\"\n\nvar dbType string\nflag.StringVar(&amp;dbType, \"dbType\", \"\", dbTypeUsage)\nflag.StringVar(&amp;dbType, \"DBTYPE\", \"\", dbTypeUsage)\nflag.StringVar(&amp;dbType, \"DBType\", \"\", dbTypeUsage)\nflag.StringVar(&amp;dbType, \"dbtype\", \"\", dbTypeUsage)\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5448042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa679e1ba2eae812987294d7563fca1e?s=128&d=identicon&r=PG", "display_name": "Radic", "link": "https://stackoverflow.com/users/5448042/radic"}, "is_accepted": false, "score": 0, "last_activity_date": 1604616795, "creation_date": 1604616795, "answer_id": 64706481, "question_id": 50955532, "link": "https://stackoverflow.com/questions/50955532/ignore-flag-case/64706481#64706481", "title": "Ignore flag case", "body": "<p>Define your flag in lower case</p>\n<pre><code>dbType := flags.String( &quot;dbtype&quot;, &quot;&quot;, &quot;The `dbType` to deploy. )\n</code></pre>\n<p>and then just make your flag strings.ToLower() (assuming that your flag is the second argument):</p>\n<pre><code>args[1] = strings.ToLower(args[1])\nerr := flagSet.Parse(args[1:])\n</code></pre>\n"}], "owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 1, "accepted_answer_id": 50956799, "answer_count": 2, "score": 2, "last_activity_date": 1604616795, "creation_date": 1529522254, "last_edit_date": 1529522471, "question_id": 50955532, "link": "https://stackoverflow.com/questions/50955532/ignore-flag-case", "title": "Ignore flag case", "body": "<p>Is there anyway to ignore case (case insensitive) of Go flags?</p>\n\n<p>I'd like to make my program forgiving and user friendly as possible.</p>\n\n<pre><code> dbType := flags.String( \"dbType\", \"\", \"The `dbType` to deploy. )\n</code></pre>\n\n<p>I'd like this flag's value to be initialized if the user enters any of the following:</p>\n\n<pre><code> -dbtype\n -dbType\n -DBTYPE\n</code></pre>\n\n<p>Unfortunately, for this project I am limited to using the <code>flag</code> library.</p>\n"}, {"tags": ["json", "api", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1529523248, "post_id": 50955115, "comment_id": 88909115, "body": "Note that you aren&#39;t unmarshalling into a &quot;JSON object&quot;. The original string is a JSON object, you&#39;re unmarshalling it into a Go struct."}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 4574160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a4a34c5cb26fa6a98d86f67770b2da5?s=128&d=identicon&r=PG&f=1", "display_name": "zeellos", "link": "https://stackoverflow.com/users/4574160/zeellos"}, "edited": false, "score": 0, "creation_date": 1529531600, "post_id": 50955322, "comment_id": 88912557, "body": "Why do you put an asterisk (*) in []*SinglePredictions? it seems to work fine without it, what&#39;s the difference?"}, {"owner": {"reputation": 2208, "user_id": 5328069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21DZ0.jpg?s=128&g=1", "display_name": "morganbaz", "link": "https://stackoverflow.com/users/5328069/morganbaz"}, "reply_to_user": {"reputation": 119, "user_id": 4574160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a4a34c5cb26fa6a98d86f67770b2da5?s=128&d=identicon&r=PG&f=1", "display_name": "zeellos", "link": "https://stackoverflow.com/users/4574160/zeellos"}, "edited": false, "score": 0, "creation_date": 1529531795, "post_id": 50955322, "comment_id": 88912626, "body": "There is a difference, but in this context it does not really matter and you can leave it out. I just copied it from the code of your question."}], "tags": [], "owner": {"reputation": 2208, "user_id": 5328069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21DZ0.jpg?s=128&g=1", "display_name": "morganbaz", "link": "https://stackoverflow.com/users/5328069/morganbaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1529521342, "creation_date": 1529521342, "answer_id": 50955322, "question_id": 50955115, "link": "https://stackoverflow.com/questions/50955115/how-can-i-convert-a-string-array-of-maps-into-a-struct-in-golang/50955322#50955322", "title": "How can I convert a string (array of maps) into a struct in GOLANG?", "body": "<p>There are basically two mistakes. The first is that you didn't define SinglePredictions as a slice, which is why you got the error in the first place, and then you used the map when you simply needed to pass down <code>[]float64</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype dataPredictions struct {\n    SinglePredictions []*SinglePredictions `json:\"predictions\"`\n}\n\ntype SinglePredictions struct {\n    Predictions []float64 `json:\"predictions\"`\n}\n\nfunc main() {\n    s := `{\"predictions\": [{\"predictions\": [4492.0]}, {\"predictions\": [4515.84716796875]}, {\"predictions\": [4464.86083984375]}]}`\n    // Note that you don't need to assign values manually - json.Unmarshal\n    // will do that for you.\n    data := &amp;dataPredictions{}\n    err := json.Unmarshal([]byte(s), data)\n    s2, _ := json.Marshal(data)\n    fmt.Println(err)\n    fmt.Println(data.SinglePredictions)\n    fmt.Println(string(s2))\n\n}\n</code></pre>\n\n<p>The mistake you made seems that to have been thinking that Go would have unmarshalled the first array into <code>dataPredictions.SinglePredictions.Predictions</code>. But in <code>dataPredictions</code> you have a field which selects the <code>\"predictions\"</code> key in the topmost object, and its value is then passed to unmarshal into a <code>*SinglePredictions</code></p>\n"}, {"tags": [], "owner": {"reputation": 159, "user_id": 1183632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qs8EG.jpg?s=128&g=1", "display_name": "Danilo", "link": "https://stackoverflow.com/users/1183632/danilo"}, "is_accepted": false, "score": 1, "last_activity_date": 1529521369, "creation_date": 1529521369, "answer_id": 50955329, "question_id": 50955115, "link": "https://stackoverflow.com/questions/50955115/how-can-i-convert-a-string-array-of-maps-into-a-struct-in-golang/50955329#50955329", "title": "How can I convert a string (array of maps) into a struct in GOLANG?", "body": "<p>Try this:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\n\ntype dataPredictions struct {\n    SinglePredictions []SinglePredictions `json:\"predictions\"`\n}\n\ntype SinglePredictions struct {\n    Predictions []float64 `json:\"predictions\"`\n}\n\nfunc main() {\n    s := []byte(`{\"predictions\": [{\"predictions\": [4492.0]}, {\"predictions\": [4515.84716796875]}, {\"predictions\": [4464.86083984375]}]}`)\n\n    data := dataPredictions{}\n    err := json.Unmarshal(s, &amp;data)\n    s2, _ := json.Marshal(data)\n    fmt.Println(err)\n    fmt.Println(data.SinglePredictions)\n    fmt.Println(string(s2))\n}\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 4574160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a4a34c5cb26fa6a98d86f67770b2da5?s=128&d=identicon&r=PG&f=1", "display_name": "zeellos", "link": "https://stackoverflow.com/users/4574160/zeellos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1583392670, "creation_date": 1529520467, "last_edit_date": 1583392670, "question_id": 50955115, "link": "https://stackoverflow.com/questions/50955115/how-can-i-convert-a-string-array-of-maps-into-a-struct-in-golang", "title": "How can I convert a string (array of maps) into a struct in GOLANG?", "body": "<p>I am trying to convert this json-format string into an actual json object in GOLANG. </p>\n\n<p><code>{\"predictions\": [{\"predictions\": [4492.0]}, {\"predictions\": [4515.84716796875]}, {\"predictions\": [4464.86083984375]}]}</code></p>\n\n<p>Basically, it is a dictionary with a key \"predictions\" and the value es an array of dictionaries (each dictionary is has as a key \"predictions\" and a value an 1-element float array. I created two structure (one for the first dictionary and the other one for the array of dictionaries), but I can't fit the string json to my structure. I am not sure what I am missing </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\n\ntype dataPredictions struct {\n    SinglePredictions *SinglePredictions `json:\"predictions\"`\n}\n\ntype SinglePredictions struct {\n    Predictions []map[string]int `json:predictions`\n}\n\nfunc main() {\n\n    s := `{\"predictions\": [{\"predictions\": [4492.0]}, {\"predictions\": [4515.84716796875]}, {\"predictions\": [4464.86083984375]}]}`\n\n    data := &amp;dataPredictions{\n        SinglePredictions: &amp;SinglePredictions{},\n    }\n    err := json.Unmarshal([]byte(s), data)\n  s2, _ := json.Marshal(data)\n    fmt.Println(err)\n    fmt.Println(data.SinglePredictions)\n    fmt.Println(string(s2))\n\n}\n</code></pre>\n\n<p>The error I get is below. </p>\n\n<pre><code>json: cannot unmarshal array into Go struct field dataPredictions.predictions of type main.SinglePredictions\n</code></pre>\n"}, {"tags": ["go", "mux"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1529511636, "post_id": 50952793, "comment_id": 88903344, "body": "You haven&#39;t defined <code>handler</code> and you&#39;re not using your <code>Mux</code> type at all in this example."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1529511805, "post_id": 50952793, "comment_id": 88903444, "body": "You are on the right track.  Define http.Handler for each kind of domain and call those handlers from the if / else statement in Mux.ServeHTTP.  Also, use a Mux as the root handler. It&#39;s not used at all now."}, {"owner": {"reputation": 3074, "user_id": 462047, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/d9a595344c86c49a0749736b108051d0?s=128&d=identicon&r=PG", "display_name": "Cornwell", "link": "https://stackoverflow.com/users/462047/cornwell"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1529512270, "post_id": 50952793, "comment_id": 88903714, "body": "@JimB I&#39;ve added the handler now. It just outputs an html file for now.  @ThunderCat do you mean something like this: <code>mux.HandleFunc(&quot;&#47;&quot;, AdminHandler)</code> for the &quot;admin&quot; domain for instance? But I don&#39;t think it&#39;s even calling <code>ServeHTTP </code>   Regarding mux not being used in the root, isn&#39;t it handling the main domain&#39;s index request?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1529512547, "post_id": 50952793, "comment_id": 88903867, "body": "@Cornwell: you still never use <code>Mux</code> in your code, so it&#39;s unclear why you think it should produce any output if it&#39;s never used."}], "answers": [{"comments": [{"owner": {"reputation": 3074, "user_id": 462047, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/d9a595344c86c49a0749736b108051d0?s=128&d=identicon&r=PG", "display_name": "Cornwell", "link": "https://stackoverflow.com/users/462047/cornwell"}, "edited": false, "score": 0, "creation_date": 1529518154, "post_id": 50953513, "comment_id": 88906743, "body": "Thanks! I was messing up the <code>mux</code>. Quick question, how do I handle the main domain&#39;s routes? ie. requests to <code>soccer.com</code> (without any subdomain). Where do I add the handler?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 3074, "user_id": 462047, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/d9a595344c86c49a0749736b108051d0?s=128&d=identicon&r=PG", "display_name": "Cornwell", "link": "https://stackoverflow.com/users/462047/cornwell"}, "edited": false, "score": 1, "creation_date": 1529518647, "post_id": 50953513, "comment_id": 88906970, "body": "Use another http.ServeMux and hook into if / else statement using whatever logic you need for separating domain from sub-domain."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1529518591, "last_edit_date": 1529518591, "creation_date": 1529514153, "answer_id": 50953513, "question_id": 50952793, "link": "https://stackoverflow.com/questions/50952793/handling-dynamic-sub-domains/50953513#50953513", "title": "Handling dynamic sub-domains", "body": "<p>You are on the right track. Create a http.ServeMux for each kind of domain and call those muxes from  the if / else statement in Mux.ServeHTTP. Also, use a Mux as the root handler.</p>\n\n<pre><code>type Mux struct {\n    help, admin, sub, main *http.ServeMux\n}\n\nfunc (mux *Mux) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    if isMainDomain(r.Host) {\n        mux.main.ServeHTTP(w, r)\n        return\n    }\n    domainParts := strings.Split(r.Host, \".\")\n    if domainParts[0] == \"admin\" {\n        mux.admin.ServeHTTP(w, r)\n    } else if domainParts[0] == \"help\" {\n        mux.help.ServeHTTP(w, r)\n    } else if isSubDomainValid(domainParts[0]) {\n        mux.sub.ServeHTTP(w, r)\n    } else {\n        http.Error(w, \"Not found\", 404)\n    }\n}\n\nfunc main() {\n    mux := &amp;Mux{\n        help:  http.NewServeMux(),\n        admin: http.NewServeMux(),\n        sub:   http.NewServeMux(),\n        main:  http.NewServeMux(),\n    }\n\n    mux.help.HandleFunc(\"/\", helpHomeHandler)\n    mux.admin.HandleFunc(\"/\", adminHomeHandler)\n    mux.sub.HandleFunc(\"/\", defaultSubdomainHomeHandler)\n    mux.main.HandleFunc(\"/\", mainHomeHandler)\n\n    http.ListenAndServe(\":8080\", mux) // &lt;-- use Mux value as root handler\n}\n</code></pre>\n"}], "owner": {"reputation": 3074, "user_id": 462047, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/d9a595344c86c49a0749736b108051d0?s=128&d=identicon&r=PG", "display_name": "Cornwell", "link": "https://stackoverflow.com/users/462047/cornwell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 1, "accepted_answer_id": 50953513, "answer_count": 1, "score": 2, "last_activity_date": 1529518591, "creation_date": 1529511292, "last_edit_date": 1529511933, "question_id": 50952793, "link": "https://stackoverflow.com/questions/50952793/handling-dynamic-sub-domains", "title": "Handling dynamic sub-domains", "body": "<p>Let's say my website is <code>http://soccer.com</code> and I want to support an unlimited amount of subdomains, eg.:</p>\n\n<ul>\n<li><code>http://cronaldo.soccer.com</code></li>\n<li><code>http://messi.soccer.com</code></li>\n<li><code>http://neymar.soccer.com</code></li>\n<li><code>http://muller.soccer.com</code></li>\n<li>...</li>\n</ul>\n\n<p>I also want to have a few reserved sub-domains, eg.:</p>\n\n<ul>\n<li><code>http://admin.soccer.com</code></li>\n<li><code>http://help.soccer.com</code></li>\n<li>...</li>\n</ul>\n\n<p>While the player's subdomains will be handled by the same logic, the reserved ones won't. So I'll need 2 routes or 2 routers?</p>\n\n<p>Here's what I have:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"log\"\n    \"html/template\"\n    \"strings\"\n)\n\ntype Mux struct {\n    http.Handler\n}\n\nfunc (mux Mux) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    domainParts := strings.Split(r.Host, \".\")\n    fmt.Println(\"Here: \" + domainParts[0])\n    if domainParts[0] == \"admin\" {\n        // assign route?\n        mux.ServeHTTP(w, r)\n    } else if domainParts[0] == \"help\" {\n        // assign route?\n        mux.ServeHTTP(w, r)\n    } else if isSubDomainValid(domainParts[0]) {\n        // assign route for player page?\n        mux.ServeHTTP(w, r)\n    } else {\n        // Handle 404\n        http.Error(w, \"Not found\", 404)\n    }\n}\n\nfunc main() {\n  mux := http.NewServeMux()\n  mux.HandleFunc(\"/\", HomeHandler)\n\n  http.ListenAndServe(\":8080\", mux)\n}\n\nfunc HomeHandler(w http.ResponseWriter, r *http.Request) {\n  t, err := template.ParseFiles(\"index.html\")\n  if err != nil {\n    log.Print(\"template parsing error: \", err)\n  }\n\n  err = t.Execute(w, nil)\n  if err != nil {\n    log.Print(\"template executing error: \", err)\n  }\n</code></pre>\n\n<p>}</p>\n\n<p>But I don't think I'm doing this right.</p>\n\n<p><code>fmt.Println(\"Here: \" + domainParts[0])</code> never shows up, leading me to believe that <code>ServeHTTP()</code> is never called. </p>\n\n<p>I'm just a beginner in Go, so I might be missing some concept</p>\n\n<p>Thank you</p>\n"}, {"tags": ["go", "e2e-testing", "endly"], "answers": [{"tags": [], "owner": {"reputation": 2208, "user_id": 5328069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21DZ0.jpg?s=128&g=1", "display_name": "morganbaz", "link": "https://stackoverflow.com/users/5328069/morganbaz"}, "is_accepted": false, "score": 2, "last_activity_date": 1529515177, "creation_date": 1529515177, "answer_id": 50953784, "question_id": 50952210, "link": "https://stackoverflow.com/questions/50952210/platform-independent-go-build-for-engineer-testing/50953784#50953784", "title": "Platform independent go build for engineer testing", "body": "<p>While there are definitely ways of doing this manually, I'd recommend you to use <a href=\"https://github.com/karalabe/xgo\" rel=\"nofollow noreferrer\">xgo</a>. I've successfully used it in a project which involved using <a href=\"https://github.com/zserge/webview\" rel=\"nofollow noreferrer\">zserge/webview</a>, and <a href=\"https://github.com/go-gitea/gitea\" rel=\"nofollow noreferrer\">the gitea project</a> uses it for cross-compiling release binaries (which involve using SQLite, which requires cgo).</p>\n\n<p>Keep in mind it requires Docker, and it needs to download a very large image, but there is a good wrapper around all the commands that you need to run.</p>\n\n<pre><code># installing the wrapper\ngo get github.com/karalabe/xgo\n# go into your repo, and then run this to crosscompile!\nxgo --targets=windows/*,darwin/*,linux/amd64\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9706983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55bd551c8d53298c0cc98fc0de6f3697?s=128&d=identicon&r=PG&f=1", "display_name": "terry.zhao", "link": "https://stackoverflow.com/users/9706983/terry-zhao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529515177, "creation_date": 1529509469, "question_id": 50952210, "link": "https://stackoverflow.com/questions/50952210/platform-independent-go-build-for-engineer-testing", "title": "Platform independent go build for engineer testing", "body": "<p>My typical <a href=\"http://github.com/viant/endly/\" rel=\"nofollow noreferrer\">endly</a> test automation is parametrized to takes place either on my localhost(osx) or on staging box (linux), ideally I want to build separately cross platform app binary.</p>\n\n<p>All that said when I build my app binary on OSX for linux, I am seeing the following</p>\n\n<pre><code>export GOOS=linux\ngo build\n# github.com/alexbrainman/odbc/api\n\n\n../../../../github.com/alexbrainman/odbc/api/api.go:17:9: undefined: SQLSMALLINT\n../../../../github.com/alexbrainman/odbc/api/api.go:18:9: undefined: SQLUSMALLINT\n../../../../github.com/alexbrainman/odbc/api/api.go:19:9: undefined: SQLUSMALLINT\n</code></pre>\n\n<p>My application uses odbc to connect to vertica, and at the moment the only available Vertica driver in go uses CGO, \n<strong>Is there a way to build cross platform CGO independent, statically compiled app?</strong></p>\n"}, {"tags": ["go", "duration"], "comments": [{"owner": {"reputation": 14921, "user_id": 211327, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f50ea766b73c2f3e168daad07286a10b?s=128&d=identicon&r=PG", "display_name": "Alan H.", "link": "https://stackoverflow.com/users/211327/alan-h"}, "edited": false, "score": 0, "creation_date": 1529559565, "post_id": 50950889, "comment_id": 88918966, "body": "You\u2019re looking for a Go equivalent of sleep()?"}], "answers": [{"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1529509586, "post_id": 50951524, "comment_id": 88902061, "body": "Your example could show that the exit is taken: <a href=\"https://play.golang.org/p/it1kmQViavN\" rel=\"nofollow noreferrer\">play.golang.org/p/it1kmQViavN</a>"}], "tags": [], "owner": {"reputation": 66, "user_id": 9968267, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/a08afca1e7289431fc1c6fb35bccccf5?s=128&d=identicon&r=PG", "display_name": "user9968267", "link": "https://stackoverflow.com/users/9968267/user9968267"}, "is_accepted": true, "score": 5, "last_activity_date": 1529508224, "last_edit_date": 1529508224, "creation_date": 1529507404, "answer_id": 50951524, "question_id": 50950889, "link": "https://stackoverflow.com/questions/50950889/run-program-with-an-expiration-time-duration/50951524#50951524", "title": "Run program with an expiration time/duration", "body": "<p>Add this line of code to the beginning of the <code>main()</code> function:</p>\n\n<pre><code>time.AfterFunc(5*time.Minute, func() { os.Exit(0) })\n</code></pre>\n\n<p>This causes <code>os.Exit(0)</code> to be called after 5 minutes.</p>\n\n<p>Here it is on the Go playground (minutes convert to seconds for example): <a href=\"https://play.golang.org/p/wybKWM2BEep\" rel=\"nofollow noreferrer\">https://play.golang.org/p/wybKWM2BEep</a></p>\n"}], "owner": {"reputation": 794, "user_id": 2375280, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02d3febb9db6da8ae3c83fb6c10b5199?s=128&d=identicon&r=PG", "display_name": "xmarston", "link": "https://stackoverflow.com/users/2375280/xmarston"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 3, "closed_date": 1529541074, "accepted_answer_id": 50951524, "answer_count": 1, "score": 1, "last_activity_date": 1529511710, "creation_date": 1529505635, "last_edit_date": 1529511710, "question_id": 50950889, "link": "https://stackoverflow.com/questions/50950889/run-program-with-an-expiration-time-duration", "closed_reason": "Needs more focus", "title": "Run program with an expiration time/duration", "body": "<p>I've been searching on the internet but I did not find the right answer, so, my question is, how can I run a Go program during 5 minutes and after this 5 minutes exit the script?</p>\n"}, {"tags": ["rest", "go", "mux", "goa"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 2, "creation_date": 1529498084, "post_id": 50948176, "comment_id": 88894262, "body": "It seems like an struct. Please provide <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable</a> example to produce a problem you are facing."}, {"owner": {"reputation": 5979, "user_id": 1009669, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef0d4c06ad2d9ae5fdfdc934f7d49e4f?s=128&d=identicon&r=PG&f=1", "display_name": "BigBug", "link": "https://stackoverflow.com/users/1009669/bigbug"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1529498422, "post_id": 50948176, "comment_id": 88894498, "body": "@Himanshu what other minimal, complete and verifiable information do I need to add? As mentioned service comes from a library called Goa: <a href=\"https://goa.design/implement/mux/\" rel=\"nofollow noreferrer\">goa.design/implement/mux</a>"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 1, "creation_date": 1529498515, "post_id": 50948176, "comment_id": 88894555, "body": "just post the code you have tried and proper output of log and the struct of <code>service.Mux</code>"}, {"owner": {"reputation": 5979, "user_id": 1009669, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef0d4c06ad2d9ae5fdfdc934f7d49e4f?s=128&d=identicon&r=PG&f=1", "display_name": "BigBug", "link": "https://stackoverflow.com/users/1009669/bigbug"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1529499510, "post_id": 50948176, "comment_id": 88895135, "body": "@Himanshu i have printed how to create a new service, i have printed the println for printing the service and i have printed the output above.... not too sure what i am missing?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1529504253, "post_id": 50948176, "comment_id": 88898437, "body": "Just look up the documentation of Mux and use whatever suitable fileds or methods or functions it offers."}, {"owner": {"reputation": 5979, "user_id": 1009669, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef0d4c06ad2d9ae5fdfdc934f7d49e4f?s=128&d=identicon&r=PG&f=1", "display_name": "BigBug", "link": "https://stackoverflow.com/users/1009669/bigbug"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1529506332, "post_id": 50948176, "comment_id": 88899877, "body": "@Volker i did, and it&#39;s not supported i guess :-("}], "answers": [{"comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1529508032, "post_id": 50951096, "comment_id": 88901064, "body": "You can use the <code>reflect</code> package to get to the <a href=\"https://github.com/goadesign/goa/blob/master/mux.go#L48\" rel=\"nofollow noreferrer\">map</a>. E.g. <a href=\"https://play.golang.org/p/KiLSqDDTWVA\" rel=\"nofollow noreferrer\">play.golang.org/p/KiLSqDDTWVA</a>"}, {"owner": {"reputation": 5979, "user_id": 1009669, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef0d4c06ad2d9ae5fdfdc934f7d49e4f?s=128&d=identicon&r=PG&f=1", "display_name": "BigBug", "link": "https://stackoverflow.com/users/1009669/bigbug"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1529525354, "post_id": 50951096, "comment_id": 88910009, "body": "@mkopriva can you make this an answer so i can select it?"}], "tags": [], "owner": {"reputation": 5979, "user_id": 1009669, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef0d4c06ad2d9ae5fdfdc934f7d49e4f?s=128&d=identicon&r=PG&f=1", "display_name": "BigBug", "link": "https://stackoverflow.com/users/1009669/bigbug"}, "is_accepted": false, "score": 0, "last_activity_date": 1529506284, "creation_date": 1529506284, "answer_id": 50951096, "question_id": 50948176, "link": "https://stackoverflow.com/questions/50948176/object-containing-a-map/50951096#50951096", "title": "Object containing a map?", "body": "<p>Goa library currently does not support this. Mux is an interface that has very few options available. Among the options available there is not one for retrieving that map unfortunately :-(</p>\n"}, {"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1529525875, "creation_date": 1529525875, "answer_id": 50956394, "question_id": 50948176, "link": "https://stackoverflow.com/questions/50948176/object-containing-a-map/50956394#50956394", "title": "Object containing a map?", "body": "<p>You could use the <code>reflect</code> and <code>unsafe</code> packages to get to the underlying and unexported map value, which is defined here (<a href=\"https://github.com/goadesign/goa/blob/master/mux.go#L48\" rel=\"nofollow noreferrer\">https://github.com/goadesign/goa/blob/master/mux.go#L48</a>).</p>\n\n<p>Something like this:</p>\n\n<pre><code>rv := reflect.ValueOf(service.Mux).Elem()\nrf := rv.FieldByName(\"handles\")\nrf = reflect.NewAt(rf.Type(), unsafe.Pointer(rf.UnsafeAddr())).Elem()\n\nhandles := rf.Interface().(map[string]goa.MuxHandler)\nfor k, h := range handles {\n    fmt.Println(k, h)\n}\n</code></pre>\n\n<p>But do note, that with this approach your code depends on an implementation detail as opposed to a public API, and therefore you cannot rely on its stability.</p>\n"}], "owner": {"reputation": 5979, "user_id": 1009669, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef0d4c06ad2d9ae5fdfdc934f7d49e4f?s=128&d=identicon&r=PG&f=1", "display_name": "BigBug", "link": "https://stackoverflow.com/users/1009669/bigbug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 50956394, "answer_count": 2, "score": -3, "last_activity_date": 1529525875, "creation_date": 1529497349, "last_edit_date": 1529497770, "question_id": 50948176, "link": "https://stackoverflow.com/questions/50948176/object-containing-a-map", "title": "Object containing a map?", "body": "<p>I'm trying to get a list of all of our endpoints.</p>\n\n<p>We use Goa.</p>\n\n<p>I noticed that we add all of our endpoints to a service (<code>goa.New(\"service_name\")</code>). I also realized that if I print service.Mux I can see all the endpoints. However, the endpoints look like they are in a Map, which is contained by an object. When printing service.Mux, I see memory addresses as well. How do I get just the endpoints alone?</p>\n\n<pre><code>fmt.Println(\"Service Mux: \", service.Mux)\n\n&amp;{0xc42092c640 map[OPTIONS/api/my/endpoint/:endpointID/relationships/links:0x77d370 ...]}\n</code></pre>\n"}, {"tags": ["sql-server", "go"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1529495763, "post_id": 50947586, "comment_id": 88892613, "body": "So what is the issue here . Please explain in your post by posting an error you have faced."}, {"owner": {"reputation": 33, "user_id": 9963364, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uxL_-UHkgpY/AAAAAAAAAAI/AAAAAAAAAAw/SKL1UAEGf_M/photo.jpg?sz=128", "display_name": "Dipikanta Dutta", "link": "https://stackoverflow.com/users/9963364/dipikanta-dutta"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1529496079, "post_id": 50947586, "comment_id": 88892850, "body": "There are no errors but from the webpage when I&#39;m trying to select a star and submit, it is not getting saved in the database"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1529496387, "post_id": 50947586, "comment_id": 88893053, "body": "It&#39;s hardly possible to test your code (as it&#39;s uncompilable as present) but I&#39;d say there are two points to look at: 1) add debug printouts around the actual call to <code>db.Exec</code> to make sure it has really was executed. 2) Use the SQL Server&#39;s query tracer tool to see what&#39;s happening in the connection made by your server-side."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1529496458, "post_id": 50947586, "comment_id": 88893096, "body": "just Print the error in log when you are executing the statement to check if an error returns from database."}, {"owner": {"reputation": 33, "user_id": 9963364, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uxL_-UHkgpY/AAAAAAAAAAI/AAAAAAAAAAw/SKL1UAEGf_M/photo.jpg?sz=128", "display_name": "Dipikanta Dutta", "link": "https://stackoverflow.com/users/9963364/dipikanta-dutta"}, "edited": false, "score": 0, "creation_date": 1529501880, "post_id": 50947586, "comment_id": 88896746, "body": "I am facing the following error after printing the error  after executing:                                                  2018/06/20 18:51:58 http: panic serving 127.0.0.1:57652: runtime error: invalid memory address or nil pointer dereference goroutine 26 [running]: net/http.(*conn).serve.func1(0xc042051220)         C:/Go/src/net/http/server.go:1726 +0xd7 panic(0x7a7140, 0xad9f20)                  C:/Go/src/net/http/server.go:2795 +0x282"}], "answers": [{"tags": [], "owner": {"reputation": 159, "user_id": 1183632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qs8EG.jpg?s=128&g=1", "display_name": "Danilo", "link": "https://stackoverflow.com/users/1183632/danilo"}, "is_accepted": false, "score": 1, "last_activity_date": 1529514174, "creation_date": 1529514174, "answer_id": 50953519, "question_id": 50947586, "link": "https://stackoverflow.com/questions/50947586/how-to-save-star-rating-from-feedback-section-in-sql-database-using-golang/50953519#50953519", "title": "how to save star rating from feedback section in sql database using Golang", "body": "<p>If I get right your star rating values are string eg.: \"1\", \"2\"...\"5\"(not \"one\", \"two\"..etc due to <code>input class=\"star star-5\" id=\"star_5\" type=\"radio\" value=\"5\"</code>), so you need to convert your <code>isRate</code> value:</p>\n\n<pre><code>rate, _ := strconv.Atoi(isRate)\n</code></pre>\n\n<p>and get the int value in <code>rate</code> to pass in the SQL statement.</p>\n"}], "owner": {"reputation": 33, "user_id": 9963364, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uxL_-UHkgpY/AAAAAAAAAAI/AAAAAAAAAAw/SKL1UAEGf_M/photo.jpg?sz=128", "display_name": "Dipikanta Dutta", "link": "https://stackoverflow.com/users/9963364/dipikanta-dutta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529514174, "creation_date": 1529495491, "last_edit_date": 1529495593, "question_id": 50947586, "link": "https://stackoverflow.com/questions/50947586/how-to-save-star-rating-from-feedback-section-in-sql-database-using-golang", "title": "how to save star rating from feedback section in sql database using Golang", "body": "<p>I am trying to store the star rating from feedback section in webpage to database using golang.</p>\n\n<p>In Home.html I have the html code written for star rating.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div class=\"stars\"&gt;\r\n  &lt;form  action=\"/feedback\" method=\"POST\"&gt;\r\n    &lt;input class=\"star star-5\" id=\"star_5\" type=\"radio\" value=\"5\" name=\"star\"/&gt;\r\n    &lt;label class=\"star star-5\" for=\"star_5\"&gt;&lt;/label&gt;\r\n    &lt;input class=\"star star-4\" id=\"star_4\" type=\"radio\" value=\"4\" name=\"star\"/&gt;\r\n    &lt;label class=\"star star-4\" for=\"star_4\"&gt;&lt;/label&gt;\r\n    &lt;input class=\"star star-3\" id=\"star_3\" type=\"radio\" value=\"3\" name=\"star\"/&gt;\r\n    &lt;label class=\"star star-3\" for=\"star_3\"&gt;&lt;/label&gt;\r\n    &lt;input class=\"star star-2\" id=\"star_2\" type=\"radio\" value=\"2\" name=\"star\"/&gt;\r\n    &lt;label class=\"star star-2\" for=\"star_2\"&gt;&lt;/label&gt;\r\n    &lt;input class=\"star star-1\" id=\"star_1\" type=\"radio\" value=\"1\" name=\"star\"/&gt;\r\n    &lt;label class=\"star star-1\" for=\"star_1\"&gt;&lt;/label&gt;\r\n\t&lt;label for=\"isRate\"&gt;&lt;span&gt;&lt;/span&gt;&lt;/label&gt;\r\n  &lt;/form&gt;\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>And in main.go I have the functions written</p>\n\n<pre><code>    var CDSID     string \n    var Rating int\n    var CreateDate string\n    var rate int\n\nfunc createUser(w http.ResponseWriter, r *http.Request)  {\n    //stmt, err := db.Query(\"INSERT tbl_fdback SET CDSID='DDUTTA3', CreateDate=getdate(), Rating=?\")\n    stmt :=\"INSERT INTO tbl_fdback VALUES($1,$2,$3)\"\n    if err != nil {\n        log.Fatal(\"there was an error:\", err.Error())\n    return\n    }\n    isRate   := r.FormValue(\"star\")\n    if (isRate == \"one\") {\n    rate = 1\n    }else if (isRate == \"two\"){\n    rate = 2\n    }else if (isRate == \"three\") {\n    rate = 3\n    }else if (isRate == \"four\") {\n    rate = 4\n    }else if (isRate == \"five\") {\n    rate = 5\n    }else {\n     fmt.Println(\"Work harder\")\n    }\n    _, err := db.Exec(stmt,\"DDUTTA3\",CreateDate,rate)\n    if err != nil {\n    log.Println(err)\n    return\n    }\n    }\n\nfunc main() {\nflag.Parse() \n\n    dsn := \"server=fcdb1198;user id=prxqamydb;password=dbnms#666\"\n    db, err := sql.Open(\"mssql\", dsn) \n    if err != nil {\n        fmt.Println(\"Cannot connect: \", err.Error())\n        return\n    }\n    err = db.Ping()\n    if err != nil {\n        fmt.Println(\"Cannot connect1: \", err.Error())\n        return\n    }\n    defer db.Close()\n     http.HandleFunc(\"/feedback\", createUser)\n    http.HandleFunc(STATIC_URL, StaticHandler)\n    if err := http.ListenAndServe(\"localhost:8080\", nil); err != nil {\n        log.Fatalf(\"Error starting HTTP server: %v\", err)\n    }\n\n}\n</code></pre>\n"}, {"tags": ["csv", "go", "encoding", "character"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1529496129, "last_edit_date": 1529496129, "creation_date": 1529495800, "answer_id": 50947680, "question_id": 50947233, "link": "https://stackoverflow.com/questions/50947233/chinese-characters-encoding-issue-golang/50947680#50947680", "title": "Chinese characters encoding issue golang", "body": "<p>You have a Go UTF-8 encoded <code>string</code> and you are incorrectly interpreting it as extended ASCII bytes.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    utf8 := \"\u6c49\u5b57 \u6f22\u5b57\"\n    fmt.Println(utf8)\n    var ascii string\n    for i := 0; i &lt; len(utf8); i++ {\n        ascii += string(utf8[i])\n    }\n    fmt.Println(ascii)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/HTPWhPO7OVS\" rel=\"nofollow noreferrer\">https://play.golang.org/p/HTPWhPO7OVS</a></p>\n\n<p>Output:</p>\n\n<pre><code>\u6c49\u5b57 \u6f22\u5b57\n\u00e6\u00b1\u00e5\u00ad \u00e6\u00bc\u00a2\u00e5\u00ad\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9648837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111d508f0a77325187426e78589313fb?s=128&d=identicon&r=PG&f=1", "display_name": "UIJoker", "link": "https://stackoverflow.com/users/9648837/uijoker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1195, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1529496129, "creation_date": 1529494359, "last_edit_date": 1529495015, "question_id": 50947233, "link": "https://stackoverflow.com/questions/50947233/chinese-characters-encoding-issue-golang", "title": "Chinese characters encoding issue golang", "body": "<p>I am trying to write to a file a string that contains chinese characters but I have an encoding issue (getting something like that 10 \u00c2\u03c0\u00a5\u2030\u00aa\u2022\u2030\u220f\u00e4\u00c1\u00aa\u00e8\u00c8\u2122\u00e5)</p>\n\n<p>Here is what I have.</p>\n\n<pre><code>csvContent, err := gocsv.MarshalString(&amp;csvTranslation) // Get all clients as CSV string\n    if err != nil {\n        panic(err)\n    }\n    d1 := []byte(string(csvContent))\n    ioutil.WriteFile(\"result.csv\", d1, 0644)\n</code></pre>\n\n<p>Could you point me to what I am missing</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1320, "user_id": 1600612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab513043b9b486138701a4b2a98648c8?s=128&d=identicon&r=PG", "display_name": "dvk", "link": "https://stackoverflow.com/users/1600612/dvk"}, "edited": false, "score": 6, "creation_date": 1529493853, "post_id": 50946972, "comment_id": 88891391, "body": "Are you sure you do not get a <code>false</code> somewhere at the top of the output? I certainly do (go1.10.3 linux/amd64). It&#39;s just there is only one false, the very first one. Maybe you just miss it given all the <code>true</code>&#39;s printed below it in huge quantities? And having a deadlock helps - since it stops printing after the first iteration"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1529494179, "post_id": 50946972, "comment_id": 88891579, "body": "Why you are having a deadlock, is because your <code>break</code>. so <code>mutex.Unlock()</code> is never execuated. Also note that <code>break</code> breaks the <code>select</code>, not the <code>for</code> loop."}], "answers": [{"comments": [{"owner": {"reputation": 22099, "user_id": 828366, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/V8V1N.jpg?s=128&g=1", "display_name": "Francesco Casula", "link": "https://stackoverflow.com/users/828366/francesco-casula"}, "edited": false, "score": 0, "creation_date": 1529502243, "post_id": 50948185, "comment_id": 88897012, "body": "As dvk said I missed the first <code>false</code> because <code>true</code> gets printed a lot and my console does not allow infinite scrolling so I was missing it! Thanks for your answer."}, {"owner": {"reputation": 151, "user_id": 4956493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a90dbe17f160d757d4c7eae2cf68ccc3?s=128&d=identicon&r=PG", "display_name": "yosher lutski", "link": "https://stackoverflow.com/users/4956493/yosher-lutski"}, "reply_to_user": {"reputation": 22099, "user_id": 828366, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/V8V1N.jpg?s=128&g=1", "display_name": "Francesco Casula", "link": "https://stackoverflow.com/users/828366/francesco-casula"}, "edited": false, "score": 0, "creation_date": 1529581285, "post_id": 50948185, "comment_id": 88931621, "body": "No problem. Limiting the output to only 10 results like to playground code in my answer can help you produce more readable output next time. (Or even writing logs to files.) easy as <code>go run main.go &gt; out.txt</code>"}], "tags": [], "owner": {"reputation": 151, "user_id": 4956493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a90dbe17f160d757d4c7eae2cf68ccc3?s=128&d=identicon&r=PG", "display_name": "yosher lutski", "link": "https://stackoverflow.com/users/4956493/yosher-lutski"}, "is_accepted": true, "score": 0, "last_activity_date": 1529497383, "creation_date": 1529497383, "answer_id": 50948185, "question_id": 50946972, "link": "https://stackoverflow.com/questions/50946972/golang-select-and-locks/50948185#50948185", "title": "Golang select and locks", "body": "<p>There's no reason to warp <code>flag</code> with a Mutex since the code around it is not concurrent.</p>\n\n<p>you can check your code here <a href=\"https://play.golang.org/p/OJue5lcIZlw\" rel=\"nofollow noreferrer\">https://play.golang.org/p/OJue5lcIZlw</a> it does print the first <code>false</code>.</p>\n\n<p>as for why you're getting that error as <a href=\"https://stackoverflow.com/users/9143962/leaf-bebop\">leaf bebop</a> said because your breaking the code you run into a deadlock for trying to lock on a locked mutex.</p>\n\n<p>you could use <code>defer mutex.Unlock()</code>\nor unlock before <code>break</code> to solve that.</p>\n"}], "owner": {"reputation": 22099, "user_id": 828366, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/V8V1N.jpg?s=128&g=1", "display_name": "Francesco Casula", "link": "https://stackoverflow.com/users/828366/francesco-casula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1206, "favorite_count": 1, "accepted_answer_id": 50948185, "answer_count": 1, "score": 1, "last_activity_date": 1529497383, "creation_date": 1529493459, "question_id": 50946972, "link": "https://stackoverflow.com/questions/50946972/golang-select-and-locks", "title": "Golang select and locks", "body": "<p>Here's some code I've been playing with:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    channel := make(chan int)\n\n    flag := false\n\n    go func() {\n        for {\n            channel &lt;- 1\n        }\n    }()\n\n    for {\n        select {\n        case &lt;-channel:\n            fmt.Println(flag)\n\n            if !flag {\n                flag = true\n                break\n            }\n\n            fmt.Println(flag)\n        }\n    }\n}\n</code></pre>\n\n<p>I would expect at least one <code>false</code> in there but when I execute the code I only get <code>true</code>s. Can someone explain why please?</p>\n\n<p>I'm sure it has something to do with locks but when I try to wrap the <code>case</code> content around a lock I get a <code>false</code> (finally!) but then <code>fatal error: all goroutines are asleep - deadlock!</code>:</p>\n\n<pre><code>for {\n    select {\n    case &lt;-channel:\n        mutex.Lock()\n        fmt.Println(flag)\n\n        if !flag {\n            flag = true\n            break\n        }\n\n        fmt.Println(flag)\n        mutex.Unlock()\n    default:\n        // no communication\n    }\n}\n</code></pre>\n"}, {"tags": ["linux", "go"], "comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 1, "creation_date": 1529495134, "post_id": 50946246, "comment_id": 88892168, "body": "I&#39;m pretty confident that there&#39;s a bigger problem. This is not related to Go or to C or any other language. There&#39;s definitely something else going on in your system. Both your programs work fine on my machine giving <code>real: 1000, effective: 0</code>. With that said, since this has not much to do with Go or C, but with your system, you should probably ask on <a href=\"https://unix.stackexchange.com/\">Unix &amp; Linux SE</a>."}, {"owner": {"reputation": 146, "user_id": 4420958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/212cadd0a6448c307c19ac240248efd7?s=128&d=identicon&r=PG", "display_name": "Denis Volin", "link": "https://stackoverflow.com/users/4420958/denis-volin"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 1, "creation_date": 1529497261, "post_id": 50946246, "comment_id": 88893695, "body": "@MarcoBonelli, I&#39;ve figured out the whole issue, just answered my own question so far. The issue indeed was with the <code>nosuid</code> option, yet, to fight it I had to compile on a <code>nosuid</code> disabled partition."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1529500350, "post_id": 50946246, "comment_id": 88895712, "body": "I read it, that&#39;s nice to know, good job :)"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1529501424, "post_id": 50946246, "comment_id": 88896406, "body": "Also see Chen, Dean and Wagner&#39;s <a href=\"https://people.eecs.berkeley.edu/~daw/papers/setuid-usenix02.pdf\" rel=\"nofollow noreferrer\">Setuid Demystified</a>."}, {"owner": {"reputation": 146, "user_id": 4420958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/212cadd0a6448c307c19ac240248efd7?s=128&d=identicon&r=PG", "display_name": "Denis Volin", "link": "https://stackoverflow.com/users/4420958/denis-volin"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1529504361, "post_id": 50946246, "comment_id": 88898513, "body": "@jww, thank you, I&#39;ll dig into it."}], "answers": [{"tags": [], "owner": {"reputation": 146, "user_id": 4420958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/212cadd0a6448c307c19ac240248efd7?s=128&d=identicon&r=PG", "display_name": "Denis Volin", "link": "https://stackoverflow.com/users/4420958/denis-volin"}, "is_accepted": true, "score": 2, "last_activity_date": 1529497158, "creation_date": 1529497158, "answer_id": 50948113, "question_id": 50946246, "link": "https://stackoverflow.com/questions/50946246/getuid-geteuid-strange-behaviour/50948113#50948113", "title": "getuid/geteuid strange behaviour", "body": "<p>More deep research of the <code>nosuid</code> option showed that the whole process, including the <strong>compilation</strong> has to happen on the drive mounted <strong>without</strong> <code>nosuid</code> option.</p>\n\n<p>So, basically speaking, the steps to fight the issue are:</p>\n\n<ol>\n<li>Create a directory on a <code>nosuid</code> disabled drive;</li>\n<li>Ensure directory group is your group;</li>\n<li>Ensure directory group permissions have <code>w</code> option;</li>\n<li>Copy the source to this directory;</li>\n<li><code>go build</code> within the directory;</li>\n<li>Apply <code>chown root:root</code> to the result;</li>\n<li>Apply <code>chmod 4755</code> to the result;</li>\n<li>Enjoy the result from /nonosuid/directory/</li>\n</ol>\n\n<p>And to detect environment you need to search for a destination without <code>nosuid</code> parameter during the installation.</p>\n"}], "owner": {"reputation": 146, "user_id": 4420958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/212cadd0a6448c307c19ac240248efd7?s=128&d=identicon&r=PG", "display_name": "Denis Volin", "link": "https://stackoverflow.com/users/4420958/denis-volin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 435, "favorite_count": 0, "accepted_answer_id": 50948113, "answer_count": 1, "score": 1, "last_activity_date": 1529497158, "creation_date": 1529491137, "last_edit_date": 1529494674, "question_id": 50946246, "link": "https://stackoverflow.com/questions/50946246/getuid-geteuid-strange-behaviour", "title": "getuid/geteuid strange behaviour", "body": "<p>I've got a simple code, which basically looks like:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"golang.org/x/sys/unix\"\n)\n\nfunc main() {\n    fmt.Printf(\"real: %d, effective: %d\\n\", unix.Getuid(), unix.Geteuid())\n}\n</code></pre>\n\n<p>Which basically outputs the real and effective user id. Now, once build with: <code>go build main.go</code>; I also call <code>sudo chown root:root main &amp;&amp; sudo chmod 4755 main</code> to get <code>-rwsr-xr-x</code> permissions on the file.</p>\n\n<p>If I understand the concept of the setuid bit (the <code>s</code> part), it allows me later to use setuid in the source file (noting, that I'll have to use either <code>unix.Setreuid</code> or <code>unix.RawSyscall</code> in conjunction with <code>runtime.LockOSThread</code>). Yet, the current compiled code no matter what always returns <code>real: 1000, effective: 1000</code>.</p>\n\n<p>At first I thought that maybe it is the case with some Go code, double and tripple checked it, yet, result is still the same. Then I went further and made a mock up in c:</p>\n\n<pre><code>int main(int argc, char* argv){\n   printf(\"real: %d, effective: %d\\n\", getuid(), geteuid());\n   fflush(stdout);\n}\n</code></pre>\n\n<p>Compiled, chown'ed to <code>root:root</code>, chmod'ed to <code>4755</code>, and guess what? It still does the very same thing, it outputs <code>real: 1000, effective: 1000</code>.</p>\n\n<p>So, if both: Go and C versions once compiled, properly changed in terms of permissions, return the same result: ignoring the setting, this is might to do something with system settings otherwise.</p>\n\n<p><strong>Update[0]:</strong> I've figured out that such a situation can be caused by a <code>nosuid</code> option for the mounted drive; so I've copied the executable to another drive, which doesn't have such an option. Still no effect.</p>\n\n<p>So, what should I do:</p>\n\n<ol>\n<li>To fight that behavior?</li>\n<li>To detect such an environment in future?</li>\n</ol>\n\n<p>Looking forward to see your suggestions.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1529493677, "post_id": 50945740, "comment_id": 88891279, "body": "Awesome ! I did not know about the <b>$replaceRoot</b>, your answer is very complete, thanks a lot. Additional question please if I may : is there anything to observe regarding the indexes to prevent slow requests ? (Because of the $lookup and $match)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 1, "creation_date": 1529496990, "post_id": 50945740, "comment_id": 88893476, "body": "@Elwyn Performance should be good, just make sure you have the proper indices (for <code>$match</code>). The <code>$lookup</code> just looks up by the <code>_id</code> which is always indexed."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1529490043, "last_edit_date": 1529490043, "creation_date": 1529489650, "answer_id": 50945740, "question_id": 50944814, "link": "https://stackoverflow.com/questions/50944814/only-return-the-looked-up-document-with-mongo-and-golang/50945740#50945740", "title": "Only return the looked up document with Mongo and Golang", "body": "<p>You may use <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/unwind/\" rel=\"nofollow noreferrer\"><code>$unwind</code></a> to \"transform\" the <code>event</code> array field to a single embedded document, then <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/replaceRoot/\" rel=\"nofollow noreferrer\"><code>$replaceRoot</code></a> to \"promote\" this <code>event</code> field to be the new \"root\":</p>\n\n<pre><code>pipe := session.DB(shared.DatabaseNamespace).C(dao.collection).Pipe([]bson.M{\n    {\n        \"$match\": bson.M{\n            \"is_published\": true,               // Boost is active\n            \"start_date\":   bson.M{\"$lt\": now}, // now is between start and end\n            \"end_date\":     bson.M{\"$gt\": now}, // now is between start and end\n        },\n    },\n    {\n        \"$lookup\": bson.M{\n            \"from\":         \"events\",\n            \"localField\":   \"_event_id\",\n            \"foreignField\": \"_id\",\n            \"as\":           \"event\",\n        },\n    },\n    {\"$unwind\": \"$event\"},\n    {\"$replaceRoot\": bson.M{ \"newRoot\": \"$event\" }},\n})\n</code></pre>\n\n<p>This solution handles properly if there are multiple events for a given <code>EventBoost</code>.</p>\n"}], "owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 1, "accepted_answer_id": 50945740, "answer_count": 1, "score": 1, "last_activity_date": 1529496401, "creation_date": 1529487029, "last_edit_date": 1529496401, "question_id": 50944814, "link": "https://stackoverflow.com/questions/50944814/only-return-the-looked-up-document-with-mongo-and-golang", "title": "Only return the looked up document with Mongo and Golang", "body": "<p>I have these two models :</p>\n\n<pre><code>// EventBoost describes the model of a EventBoost\ntype EventBoost struct {\n    ID          string    `bson:\"_id\" json:\"_id\" valid:\"alphanum,printableascii\"`\n    Name        string    `bson:\"name\" json:\"name\"`\n    Description string    `bson:\"description\" json:\"description\"`\n    Level       string    `bson:\"level\" json:\"level\"`\n    EventID     string    `bson:\"_event_id\" json:\"_event_id\" valid:\"alphanum,printableascii\"`\n    StartDate   time.Time `bson:\"start_date\" json:\"start_date\"`\n    EndDate     time.Time `bson:\"end_date\" json:\"end_date\"`\n    IsPublished bool      `bson:\"is_published\" json:\"is_published\"`\n    CreatedBy   string    `bson:\"created_by\" json:\"created_by\"`\n    CreatedAt   time.Time `bson:\"created_at\" json:\"created_at\"`\n    ModifiedAt  time.Time `bson:\"modified_at\" json:\"modified_at\"`\n}\n\n// Event describes the model of an Event\ntype Event struct {\n    ID            string      `bson:\"_id\" json:\"_id\" valid:\"alphanum,printableascii\"`\n    OldID         string      `bson:\"old_id\" json:\"old_id\" valid:\"alphanum,printableascii\"`\n    ParentID      string      `bson:\"_parent_id\" json:\"_parent_id\" valid:\"alphanum,printableascii\"`\n    Name          string      `bson:\"name\" json:\"name\"`\n    Content       string      `bson:\"content\" json:\"content\"`\n    Slug          string      `bson:\"slug\" json:\"slug\"`\n    LocationID    string      `bson:\"_location_id\" json:\"_location_id\"`\n    Price         string      `bson:\"price\" json:\"price\"`\n    Categories    []string    `bson:\"categories\" json:\"categories\"`\n    Tags          []string    `bson:\"tags\" json:\"tags\"`\n    Organisers    []string    `bson:\"organisers\" json:\"organisers\"`\n    Artists       []string    `bson:\"artists\" json:\"artists\"`\n    Image         string      `bson:\"image\" json:\"image\"`\n    IsPublished   bool        `bson:\"is_published\" json:\"is_published\"`\n    IsProposed    bool        `bson:\"is_proposed\" json:\"is_proposed\"`\n    CreatedBy     string      `bson:\"created_by\" json:\"created_by\"`\n    CreatedAt     time.Time   `bson:\"created_at\" json:\"created_at\"`\n    ModifiedAt    time.Time   `bson:\"modified_at\" json:\"modified_at\"`\n}\n</code></pre>\n\n<p>I want, when I lookup an <strong>EventBoost</strong>, to return only an <strong>Event</strong> without having to perform the cleaning with Golang logic. Because actually, the documents that are return have a property named <strong>event</strong>. I directly want have an <strong>Event</strong> document.</p>\n\n<p>Here is my method that needs to return <strong>[]*models.Event</strong> :</p>\n\n<pre><code>// Boosted returns the boosted events\nfunc (dao *eventBoostDAO) Boosted() ([]*models.Event, error) {\n    // Clone the session\n    session := dao.session.Clone()\n    defer session.Close()\n\n    // Get the time\n    now := time.Now()\n\n    // Create the pipe\n    pipe := session.DB(shared.DatabaseNamespace).C(dao.collection).Pipe([]bson.M{\n        {\n            \"$match\": bson.M{\n                \"is_published\": true,               // Boost is active\n                \"start_date\":   bson.M{\"$lt\": now}, // now is between start and end\n                \"end_date\":     bson.M{\"$gt\": now}, // now is between start and end\n            },\n        },\n        {\n            \"$lookup\": bson.M{\n                \"from\":         \"events\",\n                \"localField\":   \"_event_id\",\n                \"foreignField\": \"_id\",\n                \"as\":           \"event\",\n            },\n        },\n    })\n\n    var result []*models.Event\n    err := pipe.All(&amp;result)\n    if err != nil {\n        return nil, err\n    }\n\n    return result, nil\n}\n</code></pre>\n\n<p>Looking at the Mongo documentation, I found that <strong>$project</strong> should help me doing what I want, but I did not find how to transform a nested document to the final document.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 792, "user_id": 4330521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a5ac7663c2dc4b56e5e4f8723c3ca6b?s=128&d=identicon&r=PG", "display_name": "monofone", "link": "https://stackoverflow.com/users/4330521/monofone"}, "is_accepted": false, "score": 0, "last_activity_date": 1556638125, "creation_date": 1556638125, "answer_id": 55924248, "question_id": 50944700, "link": "https://stackoverflow.com/questions/50944700/how-to-write-join-query-using-kallax/55924248#55924248", "title": "How to write join query using Kallax", "body": "<p>A little late, but ...</p>\n\n<p>Assuming that the models lie in the module <code>persistence</code></p>\n\n<pre><code>q := persistence.NewSmsGatewayQuery().WithStatus()\ns := persistence.NewSmsGatewayStore(db)\nsmsGateway, _ := s.FindOne(q)\n</code></pre>\n\n<p>Now you can access the Name of the Status <code>smsGateway.Status.Name</code>.</p>\n\n<p><strong>WithStatus()</strong> tells kallax to also fetch the related model</p>\n"}], "owner": {"reputation": 1, "user_id": 9900966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd2c11527bee118b15b08a9420aaf7da?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Jadav", "link": "https://stackoverflow.com/users/9900966/mahesh-jadav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556638125, "creation_date": 1529486637, "last_edit_date": 1529887877, "question_id": 50944700, "link": "https://stackoverflow.com/questions/50944700/how-to-write-join-query-using-kallax", "title": "How to write join query using Kallax", "body": "<p>I have this struct as a <a href=\"https://github.com/src-d/go-kallax\" rel=\"nofollow noreferrer\">go-kallax</a> model:</p>\n\n<pre><code>type Smsgateway struct {\n    kallax.Model `table:\"sms_gateway\" pk:\"id,autoincr\"`\n    ID         int64\n    Status     int\n    Branch     int   \n    Name       string\n    Created_at string \n    Created_by string\n    Updated_at string\n    Updated_by string\n    Statusname *Status `fk:\"ID\"`\n    /*Name1 string\n    Statusname string\n    Createdby string*/\n}\n</code></pre>\n\n<p>where status store id of status table and my <code>Status</code> struct is</p>\n\n<pre><code>type Status struct {    \n    kallax.Model `table:\"status\" pk:\"id,autoincr\"`\n    ID         int64\n    Active     int\n    Updated_by int    \n    Name       string\n    Updated_at string\n}\n</code></pre>\n\n<p>Now if I use go to generate the tables, I can only get Smsgateway table list but not the value of the <code>Name</code> field from status table. How can I do this? </p>\n"}, {"tags": ["go", "concurrency", "memory-barriers"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1529483437, "post_id": 50943304, "comment_id": 88884825, "body": "Accessing unsynchronized memory is <b>undefined</b> behavior. You should expect nothing. Use proper synchronization. See possible duplicate: <a href=\"https://stackoverflow.com/questions/41406501/is-it-safe-to-read-a-function-pointer-concurrently-without-a-lock/41407827#41407827\">Is it safe to read a function pointer concurrently without a lock?</a>"}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1529484912, "post_id": 50943304, "comment_id": 88885624, "body": "interesting thing is it changes if you put another sleep in second for loop. my guess is it&#39;s cached in cpu and changes whenever its free to read (saying so cuz both i has the same address in memory)"}, {"owner": {"reputation": 340, "user_id": 5159891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a718f7cb4a6342a2a9709eeeac2b04b8?s=128&d=identicon&r=PG&f=1", "display_name": "pete lin", "link": "https://stackoverflow.com/users/5159891/pete-lin"}, "reply_to_user": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1529487025, "post_id": 50943304, "comment_id": 88886992, "body": "@danicheeta yes, i found it too, even a ns sleep will work. what do you mean free to read?"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1529487331, "post_id": 50943304, "comment_id": 88887190, "body": "I suggest reading about the <a href=\"https://golang.org/ref/mem\" rel=\"nofollow noreferrer\">Go Memory Model</a>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1529503698, "post_id": 50943304, "comment_id": 88898005, "body": "@petelin: Synchronization can be very expensive. Therefore, when it may be expensive, you must explicitly request it."}], "answers": [{"comments": [{"owner": {"reputation": 340, "user_id": 5159891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a718f7cb4a6342a2a9709eeeac2b04b8?s=128&d=identicon&r=PG&f=1", "display_name": "pete lin", "link": "https://stackoverflow.com/users/5159891/pete-lin"}, "edited": false, "score": 0, "creation_date": 1529488837, "post_id": 50945293, "comment_id": 88888256, "body": "thanks for you answer, it is undefined by go or cpu system? and could i know why it is undefined? i mean i write i in one thread, couldn&#39;t i assume read the modify from memory after a long time?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 340, "user_id": 5159891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a718f7cb4a6342a2a9709eeeac2b04b8?s=128&d=identicon&r=PG&f=1", "display_name": "pete lin", "link": "https://stackoverflow.com/users/5159891/pete-lin"}, "edited": false, "score": 2, "creation_date": 1529498636, "post_id": 50945293, "comment_id": 88894633, "body": "&quot;Undefined&quot; means everything is undefined. Undefined behaviour offers <b>absolutely ** **no</b> guarantees whatsoever. Anything is (formally) possible. Your code <b>must</b> <b>not</b> have <b>any</b> undefined behaviour at all."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 1, "last_activity_date": 1529488371, "creation_date": 1529488371, "answer_id": 50945293, "question_id": 50943304, "link": "https://stackoverflow.com/questions/50943304/concurrent-access-to-variable-without-lock/50945293#50945293", "title": "Concurrent access to variable without lock", "body": "<blockquote>\n  <p>should we add lock if only one thread write variable, and other thread just read variable?</p>\n</blockquote>\n\n<p>Yes. Always. No arguing here.</p>\n\n<p>Your test code proves and disproves nothing as its behaviour is undefined. </p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1529491798, "creation_date": 1529491798, "answer_id": 50946454, "question_id": 50943304, "link": "https://stackoverflow.com/questions/50943304/concurrent-access-to-variable-without-lock/50946454#50946454", "title": "Concurrent access to variable without lock", "body": "<p>You have a data race. Therefore, the results are undefined.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n    \"sync\"\n    \"time\"\n)\n\nvar lock sync.RWMutex\nvar i = 0\n\nfunc main() {\n    runtime.GOMAXPROCS(2)\n    go func() {\n        for {\n            fmt.Println(\"i am here\", i)\n            time.Sleep(time.Second)\n        }\n    }()\n    for {\n        i += 1\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go run -race racer.go\n==================\nWARNING: DATA RACE\nRead at 0x0000005e3600 by goroutine 6:\n  main.main.func1()\n      /home/peter/gopath/src/racer.go:17 +0x63\n\nPrevious write at 0x0000005e3600 by main goroutine:\n  main.main()\n      /home/peter/gopath/src/racer.go:22 +0x7b\n\nGoroutine 6 (running) created at:\n  main.main()\n      /home/peter/gopath/src/racer.go:15 +0x4f\n==================\ni am here 3622\ni am here 43165250\ni am here 86147697\n^Csignal: interrupt\n$\n</code></pre>\n\n<p>References:</p>\n\n<p><a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow noreferrer\">Data Race Detector</a></p>\n\n<p><a href=\"https://software.intel.com/en-us/blogs/2013/01/06/benign-data-races-what-could-possibly-go-wrong\" rel=\"nofollow noreferrer\">Benign Data Races: What Could Possibly Go Wrong?</a></p>\n"}, {"tags": [], "owner": {"reputation": 340, "user_id": 5159891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a718f7cb4a6342a2a9709eeeac2b04b8?s=128&d=identicon&r=PG&f=1", "display_name": "pete lin", "link": "https://stackoverflow.com/users/5159891/pete-lin"}, "is_accepted": true, "score": -1, "last_activity_date": 1530244792, "creation_date": 1530244792, "answer_id": 51094067, "question_id": 50943304, "link": "https://stackoverflow.com/questions/50943304/concurrent-access-to-variable-without-lock/51094067#51094067", "title": "Concurrent access to variable without lock", "body": "<p>finally, i find this answers, i know with a data race you will get a undefined behave, but i want to know why it behave like that currently. </p>\n\n<p>this snap code is because complier just remove Add function, it never add.</p>\n\n<p>so we have lesson, if you write a undefined behave, you may got a moon - -</p>\n\n<p>complier will treat you code as rubbish, it does not have any value.</p>\n"}], "owner": {"reputation": 340, "user_id": 5159891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a718f7cb4a6342a2a9709eeeac2b04b8?s=128&d=identicon&r=PG&f=1", "display_name": "pete lin", "link": "https://stackoverflow.com/users/5159891/pete-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 678, "favorite_count": 2, "accepted_answer_id": 51094067, "answer_count": 3, "score": -3, "last_activity_date": 1530244792, "creation_date": 1529482004, "last_edit_date": 1529502292, "question_id": 50943304, "link": "https://stackoverflow.com/questions/50943304/concurrent-access-to-variable-without-lock", "title": "Concurrent access to variable without lock", "body": "<p>I was disturbed by a question, </p>\n\n<blockquote>\n  <p>should we add lock if only one thread write variable, and other thread just read variable?</p>\n</blockquote>\n\n<p>so I write such code to test it </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n    \"sync\"\n    \"time\"\n)\n\nvar lock sync.RWMutex\nvar i = 0\n\nfunc main() {\n    runtime.GOMAXPROCS(2)\n    go func() {\n        for {\n            fmt.Println(\"i am here\", i)\n            time.Sleep(time.Second)\n        }\n    }()\n    for {\n        i += 1\n    }\n}\n</code></pre>\n\n<p>The result is keep print <code>i am here 0</code> even after second of time. I know a little about Memory barrier or cpu cache. but how could it be cache for such a long time? I think after a few time, it should read variable I already changed.</p>\n\n<p>Can anyone who is master go or computer system could help answer, please? </p>\n\n<hr>\n\n<p><strong>Update</strong>: i know it is a wrong way to update variable like this, i want to know why it is undefined in cpu/memory view. </p>\n"}, {"tags": ["go", "advanced-queuing"], "comments": [{"owner": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1529523327, "post_id": 50943153, "comment_id": 88909150, "body": "I have a library for this, I&#39;m asking now about open sourcing it"}, {"owner": {"reputation": 21, "user_id": 1921070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab870e17a679bd7d6ccfa121ffebfc9a?s=128&d=identicon&r=PG", "display_name": "Arnaud Opalvens", "link": "https://stackoverflow.com/users/1921070/arnaud-opalvens"}, "reply_to_user": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1529594028, "post_id": 50943153, "comment_id": 88940387, "body": "Hi @jwells131313, do you have already a public repository for this library?"}, {"owner": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1529678646, "post_id": 50943153, "comment_id": 88975445, "body": "Sorry it&#39;s not public yet.  I&#39;m trying to get legal to ok it being made public.  There is also this, but it&#39;s pretty difficult to use: <a href=\"https://github.com/rana/ora\" rel=\"nofollow noreferrer\">github.com/rana/ora</a>"}, {"owner": {"reputation": 21, "user_id": 1921070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab870e17a679bd7d6ccfa121ffebfc9a?s=128&d=identicon&r=PG", "display_name": "Arnaud Opalvens", "link": "https://stackoverflow.com/users/1921070/arnaud-opalvens"}, "reply_to_user": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1529906810, "post_id": 50943153, "comment_id": 89026822, "body": "github.com/rana/ora is an oracle driver but there is nothing regarding Advanced Oracle Queues processing with this driver."}, {"owner": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1530192275, "post_id": 50943153, "comment_id": 89156467, "body": "Yes, that&#39;s true.  But it can be used with OracleAQ, you just have to do the queries yourself.  I&#39;m very sorry it&#39;s taking so long to get through the legal red tape"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10185368, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qSbzRFZKZmM/AAAAAAAAAAI/AAAAAAAAAR8/Kg3OxOvzBRk/photo.jpg?sz=128", "display_name": "M1k3", "link": "https://stackoverflow.com/users/10185368/m1k3"}, "is_accepted": false, "score": 1, "last_activity_date": 1533540161, "creation_date": 1533540161, "answer_id": 51702465, "question_id": 50943153, "link": "https://stackoverflow.com/questions/50943153/listen-to-advanced-oracle-queue-aq/51702465#51702465", "title": "Listen to Advanced Oracle Queue (AQ)", "body": "<p>I have an implementation whereby I'm using the \"gopkg.in/goracle.v2\" package to connect to Oracle, along with the generic Go library \"database/sql\".\nThe way I did it, I have the code to read from the AQ in a PL/SQL procedure which I'm calling from my Go code. Although this is not the best approach - and I'm actually going to change it so that it doesn't rely on a stored oracle procedure - it works. The code looks something like the following:</p>\n\n<p><strong>Oracle PL/SQL proc:</strong></p>\n\n<pre><code>PROCEDURE GetAQMessage ( out_content    OUT VARCHAR2, in_acknowledge IN  VARCHAR2 DEFAULT 'N' )\nIS \n   dyn_sql   VARCHAR2(32000);\n   l_content VARCHAR2(4000);\nBEGIN\n\n   dyn_sql := '\n      DECLARE \n         l_payload MESSAGE_TYPE := MESSAGE_TYPE (NULL);\n         l_msg_id             RAW(16);\n         l_dequeue_options    DBMS_AQ.DEQUEUE_OPTIONS_T;\n         l_message_properties DBMS_AQ.MESSAGE_PROPERTIES_T; \n      BEGIN\n         DBMS_AQ.DEQUEUE(\n            queue_name =&gt; '''|| v_queue_name ||''',\n            dequeue_options =&gt; l_dequeue_options,\n            message_properties =&gt; l_message_properties,\n            payload =&gt; l_payload,\n            msgid =&gt; l_msg_id\n        );\n        :b_output := l_payload.message;\n      END;';\n\n   EXECUTE IMMEDIATE dyn_sql USING OUT l_content;\n   -- Return the content to the OUT parameter\n   out_content := l_content;\n\n   -- Permanently removes the message from the Queue\n   IF in_acknowledge = 'Y' THEN\n      COMMIT;\n   END IF;\n\nEND GetAQMessage;\n</code></pre>\n\n<p><strong>Go code:</strong></p>\n\n<pre><code>func GetAQMessage(transaction *sql.Tx) (string, error) {\n    var outResult string\n    var resErr error\n    var debug int\n\n    configuration = conf.Read()\n\n    //Run the command\n    _, resErr = transaction.Exec(`BEGIN CONSENT.GETAQMESSAGE(:1,:2) ; END;`, sql.Out{Dest: &amp;outResult}, \"N\")\n\n    return outResult, resErr\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 1921070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab870e17a679bd7d6ccfa121ffebfc9a?s=128&d=identicon&r=PG", "display_name": "Arnaud Opalvens", "link": "https://stackoverflow.com/users/1921070/arnaud-opalvens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1016, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1533540161, "creation_date": 1529481498, "last_edit_date": 1529483866, "question_id": 50943153, "link": "https://stackoverflow.com/questions/50943153/listen-to-advanced-oracle-queue-aq", "title": "Listen to Advanced Oracle Queue (AQ)", "body": "<p>I'm checking Go ability to migrate an existing C++ application.\nOne of the main task is to listen actively (no polling) an Advanced Oracle Queue.\nIn Java and C++ there are existing libraries supporting it since a long time.</p>\n\n<p>I could not find anything similar in Go (libraries &amp; examples). \nCould you help me with that?</p>\n"}, {"tags": ["go", "hyperledger-fabric", "hyperledger"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 8561236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17a274ade9a8a37ccd4addc990514d8b?s=128&d=identicon&r=PG&f=1", "display_name": "jiaxyan", "link": "https://stackoverflow.com/users/8561236/jiaxyan"}, "is_accepted": true, "score": 0, "last_activity_date": 1529681300, "creation_date": 1529681300, "answer_id": 50991226, "question_id": 50942671, "link": "https://stackoverflow.com/questions/50942671/how-to-pass-byte-array-to-chaincode-in-hyperledger-fabric/50991226#50991226", "title": "how to pass byte array to chaincode in HyperLedger Fabric", "body": "<p>Turns out to be that all args are passed in type of [][]byte to chaincode. In the definition is </p>\n\n<pre><code>args           [][]byte\n</code></pre>\n\n<p>in </p>\n\n<pre><code>type ChaincodeStub struct {\n    TxID           string\n    ChannelId      string\n    chaincodeEvent *pb.ChaincodeEvent\n    args           [][]byte\n    handler        *Handler\n    signedProposal *pb.SignedProposal\n    proposal       *pb.Proposal\n\n    // Additional fields extracted from the signedProposal\n    creator   []byte\n    transient map[string][]byte\n    binding   []byte\n\n    decorations map[string][]byte\n}\n</code></pre>\n\n<p>It's just the function <em>GetFunctionAndParameters()</em> wrapper those bytes to string.</p>\n\n<pre><code>// GetFunctionAndParameters documentation can be found in interfaces.go\nfunc (stub *ChaincodeStub) GetFunctionAndParameters() (function string, params []string) {\n    allargs := stub.GetStringArgs()\n    function = \"\"\n    params = []string{}\n    if len(allargs) &gt;= 1 {\n        function = allargs[0]\n        params = allargs[1:]\n    }\n    return\n}\n</code></pre>\n\n<p>the returned value 'function' is actually string(allargs[0]), and the rest of the args will be in allargs[1:].</p>\n"}], "owner": {"reputation": 31, "user_id": 8561236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17a274ade9a8a37ccd4addc990514d8b?s=128&d=identicon&r=PG&f=1", "display_name": "jiaxyan", "link": "https://stackoverflow.com/users/8561236/jiaxyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1193, "favorite_count": 1, "accepted_answer_id": 50991226, "answer_count": 1, "score": 1, "last_activity_date": 1529681300, "creation_date": 1529479924, "last_edit_date": 1529593064, "question_id": 50942671, "link": "https://stackoverflow.com/questions/50942671/how-to-pass-byte-array-to-chaincode-in-hyperledger-fabric", "title": "how to pass byte array to chaincode in HyperLedger Fabric", "body": "<p>I am writing a chaincode to run on fabric, and this is code piece of 'fabcar.go', the sample of fabric chaincode. </p>\n\n<p>I notice that I can pass a []string parameters from my java application using fabric-java-sdk, but I have problems when I try to pass some []byte parameters form my application. </p>\n\n<p>I ve tried other funcs like</p>\n\n<pre><code>func (stub *ChaincodeStub) GetArgs() [][]byte\nfunc (stub *ChaincodeStub) GetArgsSlice() ([]byte, error)\nfunc (stub *ChaincodeStub) GetBinding() ([]byte, error)\n</code></pre>\n\n<p>but still do not know how to do it. </p>\n\n<pre><code>func (s *SmartContract) Invoke(APIstub shim.ChaincodeStubInterface) sc.Response {\n        // Retrieve the requested Smart Contract function and arguments\n        function, args := APIstub.GetFunctionAndParameters()\n        // Route to the appropriate handler function to interact with the ledger appropriately\n        if function == \"queryCar\" {\n            return s.queryCar(APIstub, args)\n        ...\n</code></pre>\n\n<p>Did I miss anything or it's not supported now? help me Please!</p>\n"}, {"tags": ["go", "types", "constants"], "comments": [{"owner": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "edited": false, "score": 2, "creation_date": 1529475033, "post_id": 50941314, "comment_id": 88880338, "body": "Go is really good at catching errors before ever running the code, and that&#39;s what&#39;s happening here. Until you fix it, it wont compile"}, {"owner": {"reputation": 7044, "user_id": 7670262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3zdDY.jpg?s=128&g=1", "display_name": "Azeem", "link": "https://stackoverflow.com/users/7670262/azeem"}, "reply_to_user": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "edited": false, "score": 1, "creation_date": 1529476153, "post_id": 50941314, "comment_id": 88880790, "body": "@Derek: The type <code>int64</code> cannot accommodate a number that big."}, {"owner": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "edited": false, "score": 1, "creation_date": 1529476363, "post_id": 50941314, "comment_id": 88880913, "body": "Yikes I didn&#39;t see the rest of the number (on mobile)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1529476806, "post_id": 50941314, "comment_id": 88881112, "body": "See related / possible duplicate <a href=\"https://stackoverflow.com/questions/38982278/how-does-go-perform-arithmetic-on-constants/38982889#38982889\">How does Go perform arithmetic on constants?</a>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1529477697, "post_id": 50941314, "comment_id": 88881523, "body": "@icza: It&#39;s not about arithmetic. It is about default types during assignment."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1529488564, "post_id": 50941314, "comment_id": 88888063, "body": "Read about constants in Go here: <a href=\"https://blog.golang.org/constants\" rel=\"nofollow noreferrer\">blog.golang.org/constants</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4227, "user_id": 437506, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1f81d6e639fd42098d15302f098f0531?s=128&d=identicon&r=PG&f=1", "display_name": "Kedar Mhaswade", "link": "https://stackoverflow.com/users/437506/kedar-mhaswade"}, "edited": false, "score": 0, "creation_date": 1531960723, "post_id": 50941953, "comment_id": 89797147, "body": "Thank you for including the reference!"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 5, "last_activity_date": 1529510972, "last_edit_date": 1529510972, "creation_date": 1529477451, "answer_id": 50941953, "question_id": 50941314, "link": "https://stackoverflow.com/questions/50941314/why-does-t-not-print-the-type-of-my-constant/50941953#50941953", "title": "Why does %T not print the type of my constant?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/fmt/#Printf\" rel=\"nofollow noreferrer\">func Printf</a></p>\n\n<pre><code>func Printf(format string, a ...interface{}) (n int, err error)\n</code></pre>\n  \n  <p>Printf formats according to a format specifier and writes to standard\n  output. It returns the number of bytes written and any write error\n  encountered.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language\n  Specification</a></p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec#Variable_declarations\" rel=\"nofollow noreferrer\">Variable\n  declarations</a></p>\n  \n  <p>A variable declaration creates one or more variables, binds\n  corresponding identifiers to them, and gives each a type and an\n  initial value.</p>\n  \n  <p>If a list of expressions is given, the variables are initialized with\n  the expressions following the rules for assignments. Otherwise, each\n  variable is initialized to its zero value.</p>\n  \n  <p>If a type is present, each variable is given that type. Otherwise,\n  each variable is given the type of the corresponding initialization\n  value in the assignment. If that value is an untyped constant, it is\n  first converted to its default type; if it is an untyped boolean\n  value, it is first converted to type bool. The predeclared value nil\n  cannot be used to initialize a variable with no explicit type. </p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec#Constants\" rel=\"nofollow noreferrer\">Constants</a></p>\n  \n  <p>Constants may be typed or untyped. Literal constants, true, false,\n  iota, and certain constant expressions containing only untyped\n  constant operands are untyped.</p>\n  \n  <p>A constant may be given a type explicitly by a constant declaration or\n  conversion, or implicitly when used in a variable declaration or an\n  assignment or as an operand in an expression. It is an error if the\n  constant value cannot be represented as a value of the respective\n  type.</p>\n  \n  <p>An untyped constant has a default type which is the type to which the\n  constant is implicitly converted in contexts where a typed value is\n  required, for instance, in a short variable declaration such as i := 0\n  where there is no explicit type. The default type of an untyped\n  constant is bool, rune, int, float64, complex128 or string\n  respectively, depending on whether it is a boolean, rune, integer,\n  floating-point, complex, or string constant.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec#Numeric_types\" rel=\"nofollow noreferrer\">Numeric types</a></p>\n  \n  <p>A numeric type represents sets of integer or floating-point values.\n  Some predeclared architecture-independent numeric types:</p>\n\n<pre><code>int32       the set of all signed 32-bit integers (-2147483648 to 2147483647)\nint64       the set of all signed 64-bit integers (-9223372036854775808 to 9223372036854775807)\n</code></pre>\n  \n  <p>The value of an n-bit integer is n bits wide and represented using\n  two's complement arithmetic.</p>\n  \n  <p>There are also some predeclared numeric types with\n  implementation-specific sizes:</p>\n\n<pre><code>uint     either 32 or 64 bits\nint      same size as uint\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p><code>Big</code> is an untyped constant. There is no type to discover. It is given a type when used in a variable or assignment. The default type for the untyped constant <code>Big</code> is <code>int</code>.</p>\n\n<pre><code>const Big = 1 &lt;&lt; 100\n</code></pre>\n\n<p>In Go, all arguments are passed by value as if by assignment. For <code>fmt.Printf</code>, the second argument is of type <code>interface{}</code>. Therefore, equivalently,</p>\n\n<pre><code>var arg2 interface{} = Big  // constant 1267650600228229401496703205376 overflows int\nfmt.Printf(\"Big is of type %T\\n\", arg2)\n</code></pre>\n\n<p>The default type for an untyped integer constant is <code>int</code>. Overflow is a compile-time error.</p>\n\n<hr>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nconst (\n    // Create a huge number by shifting a 1 bit left 100 places.\n    // In other words, the binary number that is 1 followed by 100 zeroes.\n    Big = 1 &lt;&lt; 100\n)\n\nfunc main() {\n    var arg2 interface{} = Big\n    fmt.Printf(\"Big is of type %T\\n\", arg2)\n\n    fmt.Printf(\"Big is of type %T\\n\", Big)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/9tynPTek3wN\" rel=\"nofollow noreferrer\">https://play.golang.org/p/9tynPTek3wN</a></p>\n\n<p>Output:</p>\n\n<pre><code>prog.go:12:6: constant 1267650600228229401496703205376 overflows int\nprog.go:15:13: constant 1267650600228229401496703205376 overflows int\n</code></pre>\n\n<hr>\n\n<p>Reference: <a href=\"https://blog.golang.org/constants\" rel=\"nofollow noreferrer\">The Go Blog: Constants</a></p>\n"}, {"tags": [], "owner": {"reputation": 2208, "user_id": 5328069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21DZ0.jpg?s=128&g=1", "display_name": "morganbaz", "link": "https://stackoverflow.com/users/5328069/morganbaz"}, "is_accepted": false, "score": 4, "last_activity_date": 1529485760, "creation_date": 1529485760, "answer_id": 50944419, "question_id": 50941314, "link": "https://stackoverflow.com/questions/50941314/why-does-t-not-print-the-type-of-my-constant/50944419#50944419", "title": "Why does %T not print the type of my constant?", "body": "<p>While it is true that an untyped constant takes the type needed by its context, the type it can assume is limited by the primitives of the language, so a constant that big is not actually usable anywhere in the code, due to the fact that it does not fit even in an uint64. The only use it could have would be that of using it in another constant expression, because otherwise that error will always be thrown.</p>\n\n<p>Note that in <code>Printf</code> (and similar functions), the constant is converted to an <code>interface{}</code>, and thus it takes a type of <code>int</code> by default. For 32-bit machines, you need to do a type conversion first if you have a constant expression which overflows int32.</p>\n\n<pre><code>const i = 1 &lt;&lt; 50\nfmt.Println(i) // =&gt; constant 1125899906842624 overflows int\nfmt.Println(int64(i)) // =&gt; 1125899906842624\n</code></pre>\n\n<hr>\n\n<p>If you want to do proper arithmetic on arbitrarily big numbers, there is a handy package: <a href=\"https://golang.org/pkg/math/big/\" rel=\"nofollow noreferrer\"><code>math/big</code></a>.</p>\n\n<pre><code>i := big.NewInt(1)\ni.Lsh(i, 100)\nfmt.Println(i.String())\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ziOor220Fks\" rel=\"nofollow noreferrer\">Playground</a></p>\n"}], "owner": {"reputation": 5142, "user_id": 562139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/p2jbh.jpg?s=128&g=1", "display_name": "scorpiodawg", "link": "https://stackoverflow.com/users/562139/scorpiodawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 835, "favorite_count": 3, "answer_count": 2, "score": 4, "last_activity_date": 1529510972, "creation_date": 1529474801, "last_edit_date": 1529479479, "question_id": 50941314, "link": "https://stackoverflow.com/questions/50941314/why-does-t-not-print-the-type-of-my-constant", "title": "Why does %T not print the type of my constant?", "body": "<p>I'm just learning golang using the official tour/tutorial. In one of the examples, I see a note that says <code>An untyped constant takes the type needed by its context.</code></p>\n\n<p>I'm trying this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nconst (\n    // Create a huge number by shifting a 1 bit left 100 places.\n    // In other words, the binary number that is 1 followed by 100 zeroes.\n    Big = 1 &lt;&lt; 100\n)\n\nfunc main() {\n    fmt.Printf(\"Big is of type %T\\n\", Big)\n}\n</code></pre>\n\n<p>But this fails when I run it, with:</p>\n\n<pre><code># command-line-arguments\n./compile63.go:12:13: constant 1267650600228229401496703205376 overflows int\n</code></pre>\n\n<p>Why am I unable to discover the type of the constant this way? (Please note I'm a total noob and quite possibly haven't yet discovered enough about the language to be able to solve this myself).</p>\n"}, {"tags": ["go", "vendor", "dep"], "comments": [{"owner": {"reputation": 399, "user_id": 8264607, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WQKpnhD7pmQ/AAAAAAAAAAI/AAAAAAAAABM/vjTCAvnmiD0/photo.jpg?sz=128", "display_name": "scriptonist", "link": "https://stackoverflow.com/users/8264607/scriptonist"}, "edited": false, "score": 1, "creation_date": 1529472411, "post_id": 50940517, "comment_id": 88879314, "body": "You can add a dependency by using <code>dep ensure -add github.com&#47;xxx&#47;xxx</code>."}, {"owner": {"reputation": 25, "user_id": 8342904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a808c04674a23436c3136bc441e8322?s=128&d=identicon&r=PG", "display_name": "seanchann zhou", "link": "https://stackoverflow.com/users/8342904/seanchann-zhou"}, "reply_to_user": {"reputation": 399, "user_id": 8264607, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WQKpnhD7pmQ/AAAAAAAAAAI/AAAAAAAAABM/vjTCAvnmiD0/photo.jpg?sz=128", "display_name": "scriptonist", "link": "https://stackoverflow.com/users/8264607/scriptonist"}, "edited": false, "score": 0, "creation_date": 1529473627, "post_id": 50940517, "comment_id": 88879779, "body": "sorry.  I make a mistake. <code>dep ensure -update</code> work fine when I add source line with exist pkg in <code>Gopkg.toml</code>. it will not broken current path, but it put new code in   that dir. it&#39;s good!"}, {"owner": {"reputation": 2259, "user_id": 2101525, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04455ce77bcdb356791c40fa4de10cc4?s=128&d=identicon&r=PG", "display_name": "L.T", "link": "https://stackoverflow.com/users/2101525/l-t"}, "edited": false, "score": 0, "creation_date": 1529485145, "post_id": 50940517, "comment_id": 88885758, "body": "try delele Gopkg.lock file"}], "owner": {"reputation": 25, "user_id": 8342904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a808c04674a23436c3136bc441e8322?s=128&d=identicon&r=PG", "display_name": "seanchann zhou", "link": "https://stackoverflow.com/users/8342904/seanchann-zhou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 875, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529470948, "creation_date": 1529470948, "question_id": 50940517, "link": "https://stackoverflow.com/questions/50940517/golang-dep-update-source-field-in-gopkg-toml", "title": "golang dep update source field in Gopkg.toml", "body": "<p>I add a line into <code>Gopkg.toml</code> that is <code>source=\"github.com/xxxx/xxxx\"</code>. then call <code>dep ensure -update</code>. but the old dir still in vendor, it not work by add source into <code>Gopkg.toml</code>.</p>\n\n<p>how to do it?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "is_accepted": false, "score": 0, "last_activity_date": 1529470010, "creation_date": 1529470010, "answer_id": 50940385, "question_id": 50940348, "link": "https://stackoverflow.com/questions/50940348/switch-case-on-interface-type/50940385#50940385", "title": "Switch case on interface type", "body": "<p>The problem is that Vertex isn't an Abser, only *Vertex is, if you change your Abs() impl to</p>\n\n<pre><code>func (v Vertex) Abs() float64 {\n    return float64(v.X)\n}\n</code></pre>\n\n<p>then Vertex itself is an Abser and your code will print <code>theres an Abser</code></p>\n"}, {"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": true, "score": 2, "last_activity_date": 1529472157, "last_edit_date": 1529472157, "creation_date": 1529470613, "answer_id": 50940470, "question_id": 50940348, "link": "https://stackoverflow.com/questions/50940348/switch-case-on-interface-type/50940470#50940470", "title": "Switch case on interface type", "body": "<p>It is not about the switch command, but about pointer receivers.</p>\n\n<p>If you change <code>func (v *Vertex) Abs() float64</code> to <code>func (v Vertex) Abs() float64</code>, it will give the output <code>theres an Abser</code>.</p>\n\n<p>In general code, a type can use its pointer method - you can call <code>Vertex{1,2}.Abs()</code>, but what happened behind it is that the Go compiler rewrites it as <code>(&amp;Vertex{1,2}).Abs()</code> for you. So <code>Vertex</code> does not implement <code>Abser</code>.</p>\n\n<p>But on the contrary, a pointer type has all the methods its underlying type has. So even if the API is defined as <code>func (v Vertex) Abs() float64</code>, <code>&amp;Vertex{1,2}</code> is still an <code>Abser</code>. See: <a href=\"https://play.golang.org/p/ONnsjApMywO\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ONnsjApMywO</a></p>\n\n<p>See Also:</p>\n\n<p>Method set: <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Method_sets</a></p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 50940470, "answer_count": 2, "score": 1, "last_activity_date": 1529472157, "creation_date": 1529469777, "question_id": 50940348, "link": "https://stackoverflow.com/questions/50940348/switch-case-on-interface-type", "title": "Switch case on interface type", "body": "<p>I'm trying to identify a type that implements an interface using a <code>switch</code>:</p>\n\n<pre><code>package main    \n\nimport \"fmt\"\n\n\ntype Abser interface {\n    Abs() float64\n}\n\ntype Vertex struct {\n    X, Y int\n}\n\nfunc (v *Vertex) Abs() float64 {\n    return float64(v.X)\n}\n\nfunc do(i interface{}) {\n    switch v := i.(type) {\n    case Abser:\n        fmt.Println(\"theres an Abser\")\n    case Vertex:\n        fmt.Println(\"theres a Vertex\")\n    default:\n        fmt.Printf(\"I don't know about type %T!\\n\", v)\n    }\n}\n\nfunc main() {\n    do(Vertex{1,2})\n}\n</code></pre>\n\n<p>This code outputs the value for <code>Vertex</code> instead of <code>Abser</code>. Ideally it should have output <code>theres an Abser</code> since Vertex implements the <code>Abs()</code> method. Is it possible to use a switch-case to do this?</p>\n"}, {"tags": ["go", "hyperledger-fabric"], "comments": [{"owner": {"reputation": 168, "user_id": 2924361, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LPtj9.jpg?s=128&g=1", "display_name": "Nhat Duy", "link": "https://stackoverflow.com/users/2924361/nhat-duy"}, "edited": false, "score": 0, "creation_date": 1529550883, "post_id": 50939512, "comment_id": 88916729, "body": "For anyone got this issue, switch to release 1.1 branch in hyperledger fabric github, it will solve the problem. In master branch, pkg/archive/archive.go seems like for old version, release 1.1 they upgraded pkg/archive/archive.go. It will work for fabric 1.1"}], "answers": [{"comments": [{"owner": {"reputation": 168, "user_id": 2924361, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LPtj9.jpg?s=128&g=1", "display_name": "Nhat Duy", "link": "https://stackoverflow.com/users/2924361/nhat-duy"}, "edited": false, "score": 0, "creation_date": 1529637153, "post_id": 50975967, "comment_id": 88955896, "body": "I solved the issue, just check out release 1.1 not master. Anyway, thank you!"}], "tags": [], "owner": {"reputation": 1, "user_id": 9299096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c335cf62444f59c0486494ff8e1851d?s=128&d=identicon&r=PG&f=1", "display_name": "oqf", "link": "https://stackoverflow.com/users/9299096/oqf"}, "is_accepted": false, "score": 0, "last_activity_date": 1529608206, "creation_date": 1529608206, "answer_id": 50975967, "question_id": 50939512, "link": "https://stackoverflow.com/questions/50939512/error-when-instantiate-chaincode/50975967#50975967", "title": "Error when instantiate chaincode", "body": "<p>That can be because you have old version in some files inside your hyperledger/fabric folder.</p>\n\n<p>If you are following the chaincode tutorial, you can just remove your hyperledger/fabric folder.</p>\n\n<p>Regards</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5611865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0265e7df06b7a9d67005b5f7ff026350?s=128&d=identicon&r=PG&f=1", "display_name": "user5611865", "link": "https://stackoverflow.com/users/5611865/user5611865"}, "is_accepted": false, "score": 0, "last_activity_date": 1529660200, "last_edit_date": 1529660200, "creation_date": 1529651422, "answer_id": 50982540, "question_id": 50939512, "link": "https://stackoverflow.com/questions/50939512/error-when-instantiate-chaincode/50982540#50982540", "title": "Error when instantiate chaincode", "body": "<p>I had the same issue by following the documentation.\nSwitching to branch 'release-1.1' solves the issue.</p>\n\n<p>After cloning the repository proceed with:</p>\n\n<pre><code>hyperleger$ cd fabric\nhyperledger/fabric$ git fetch\nhyperledger/fabric$ git checkout release-1.1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10132285, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cSA0C5k-KSc/AAAAAAAAAAI/AAAAAAAAAAA/G-fEuFljSfQ/photo.jpg?sz=128", "display_name": "Alok Gupta", "link": "https://stackoverflow.com/users/10132285/alok-gupta"}, "is_accepted": false, "score": 1, "last_activity_date": 1532508165, "creation_date": 1532508165, "answer_id": 51514505, "question_id": 50939512, "link": "https://stackoverflow.com/questions/50939512/error-when-instantiate-chaincode/51514505#51514505", "title": "Error when instantiate chaincode", "body": "<p>I faced the same problem after upgrading fabric to 1.2.0. Fabric 1.2.0 requires go 1.10.x. So I upgraded go lang to 1.10.3 and it worked like a charm. </p>\n"}], "owner": {"reputation": 168, "user_id": 2924361, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LPtj9.jpg?s=128&g=1", "display_name": "Nhat Duy", "link": "https://stackoverflow.com/users/2924361/nhat-duy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 794, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1532508165, "creation_date": 1529463163, "question_id": 50939512, "link": "https://stackoverflow.com/questions/50939512/error-when-instantiate-chaincode", "title": "Error when instantiate chaincode", "body": "<p>Please help me this issue, error happened when I instantiate my chaincode:</p>\n\n<p>Currently, I guess the issue related to shim package, because I remove it in my utils package, instantiate successfully.</p>\n\n<h1>MyChainCode:</h1>\n\n<pre><code>import (\n    \"bytes\"\n    \"encoding/hex\"\n    \"encoding/json\"\n    \"fmt\"\n    \"strconv\"\n\n    \"github.com/golang/protobuf/proto\"\n    \"github.com/hyperledger/fabric/core/chaincode/shim\"\n    \"github.com/hyperledger/fabric/protos/msp\"\n    pb \"github.com/hyperledger/fabric/protos/peer\"\n    \"github.com/myproj/models\"\n    \"github.com/myproj/packages/utils\"\n)\n\nAPIstub shim.ChaincodeStubInterface\n...\nusername, _ = utils.GetCurrentUser(APIstub)\n...\n</code></pre>\n\n<h1>My packages</h1>\n\n<pre><code>package utils\n\nimport (\n    \"github.com/hyperledger/fabric/core/chaincode/shim\"\n    \"golang.org/x/crypto/bcrypt\"\n)\n\nfunc GetCurrentUser(stub shim.ChaincodeStubInterface) (string, error) {\n    cert, err := GetCreatorCert(stub)\n\n    return cert.Subject.CommonName, err\n}\n</code></pre>\n\n<h1>Issue:</h1>\n\n<blockquote>\n  <p>Error: Error endorsing chaincode: rpc error: code = Unknown desc =\n  error starting container: Failed to generate platform-specific docker\n  build: Error returned from build: 2 \"#\n  ~vendor/github.com/hyperledger/fabric/vendor/github.com/docker/docker/pkg/archive\n  ~vendor/github.com/hyperledger/fabric/vendor/github.com/docker/docker/pkg/archive/archive.go:364:5:\n  hdr.Format undefined (type *tar.Header has no field or method Format)\n  ~vendor/github.com/hyperledger/fabric/vendor/github.com/docker/docker/pkg/archive/archive.go:364:15:\n  undefined: tar.FormatPAX\n  ~/vendor/github.com/hyperledger/fabric/vendor/github.com/docker/docker/pkg/archive/archive.go:1166:7:\n  hdr.Format undefined (type *tar.Header has no field or method Format)\n  ~/vendor/github.com/hyperledger/fabric/vendor/github.com/docker/docker/pkg/archive/archive.go:1166:17:\n  undefined: tar.FormatPAX</p>\n</blockquote>\n\n<p>Fabric ver 1.1.0</p>\n\n<p>Go ver 1.9.2</p>\n"}, {"tags": ["go", "redis"], "comments": [{"owner": {"reputation": 39563, "user_id": 3160475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd8989da0a2c491338617b07df53e60c?s=128&d=identicon&r=PG", "display_name": "Itamar Haber", "link": "https://stackoverflow.com/users/3160475/itamar-haber"}, "edited": false, "score": 0, "creation_date": 1529511610, "post_id": 50939497, "comment_id": 88903325, "body": "GetValue returns an interface. Use redis.String() to cast it to string"}], "answers": [{"comments": [{"owner": {"reputation": 1928, "user_id": 4364847, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/pcepW.png?s=128&g=1", "display_name": "MadzQuestioning", "link": "https://stackoverflow.com/users/4364847/madzquestioning"}, "edited": false, "score": 0, "creation_date": 1529472438, "post_id": 50940258, "comment_id": 88879331, "body": "Yeah I figured that will be the case. But it doesn&#39;t make sense that the Connection interface will have a GetValue method. So I was thinking of having a separate interface with a GetValue function in it. How will I go about that?"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 1928, "user_id": 4364847, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/pcepW.png?s=128&g=1", "display_name": "MadzQuestioning", "link": "https://stackoverflow.com/users/4364847/madzquestioning"}, "edited": false, "score": 0, "creation_date": 1529511933, "post_id": 50940258, "comment_id": 88903527, "body": "That depends on how far down the rabbit hole you want to go. Do you really need your <code>Connection</code> interface? Maybe you only need some sort of <code>type Valuer interface { GetValue(string) (string, error) }</code> then just wrap your redis connection in a struct that implements that interface."}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 4, "last_activity_date": 1529469148, "creation_date": 1529469148, "answer_id": 50940258, "question_id": 50939497, "link": "https://stackoverflow.com/questions/50939497/golang-cast-interface-to-struct/50940258#50940258", "title": "Golang Cast interface to struct", "body": "<p>Your <code>Connection</code> interface:</p>\n\n<pre><code>type Connection interface {\n    GetClient() (*redis.Client, error)\n}\n</code></pre>\n\n<p>only says that there is a <code>GetClient</code> method, it says nothing about supporting <code>GetValue</code>.</p>\n\n<p>If you want to call <code>GetValue</code> on a <code>Connection</code> like this:</p>\n\n<pre><code>func GetRedisValue(c Connection, key string) (string, error) {\n    value, err := c.GetValue(key)\n    return value, err\n}\n</code></pre>\n\n<p>then you should include <code>GetValue</code> in the interface:</p>\n\n<pre><code>type Connection interface {\n    GetClient() (*redis.Client, error)\n    GetValue(string) (string, error) // &lt;-------------------\n}\n</code></pre>\n\n<p>Now you're saying that all <code>Connection</code>s will support the <code>GetValue</code> method that you want to use.</p>\n"}, {"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": false, "score": 93, "last_activity_date": 1563187833, "last_edit_date": 1563187833, "creation_date": 1529469764, "answer_id": 50940347, "question_id": 50939497, "link": "https://stackoverflow.com/questions/50939497/golang-cast-interface-to-struct/50940347#50940347", "title": "Golang Cast interface to struct", "body": "<p>To answer the question directly, i.e., to cast an <code>interface</code> into a concrete type, you do:</p>\n\n<pre><code>v = i.(T)\n</code></pre>\n\n<p>where <code>i</code> is the interface and <code>T</code> is the concrete type. It will panic if the underlying type is not T. To have a safe cast, you use:</p>\n\n<pre><code>v, ok = i.(T)\n</code></pre>\n\n<p>and if the underlying type is not <code>T</code>, ok is set to <code>false</code>, otherwise <code>true</code>. Note that <code>T</code> can also be an interface type and if it is, the code cast <code>i</code> into a new interface instead of a concrete type.</p>\n\n<p>And please be noted, casting an interface is likely a symbol of bad design. As in your code, you should ask yourself, does your custom interface <code>Connection</code> solely requires <code>GetClient</code> or does it always requires a <code>GetValue</code>? Does your <code>GetRedisValue</code> function requires a <code>Connection</code> or does it always wants a concrete struct?</p>\n\n<p>Change your code accordingly.</p>\n"}], "owner": {"reputation": 1928, "user_id": 4364847, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/pcepW.png?s=128&g=1", "display_name": "MadzQuestioning", "link": "https://stackoverflow.com/users/4364847/madzquestioning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45532, "favorite_count": 4, "accepted_answer_id": 50940258, "answer_count": 2, "score": 29, "last_activity_date": 1563187833, "creation_date": 1529463036, "question_id": 50939497, "link": "https://stackoverflow.com/questions/50939497/golang-cast-interface-to-struct", "title": "Golang Cast interface to struct", "body": "<p>Hi I'm trying to retrieve the function/method of one struct but I'm using an interface as parameter and using this interface I'm trying to access the function of the struct. To demonstrate what I want below is my code</p>\n\n<pre><code>// Here I'm trying to use \"GetValue\" a function of RedisConnection but since \"c\" is an interface it doesn't know that I'm trying to access the RedisConnection function. How Do I fix this?\nfunc GetRedisValue(c Connection, key string) (string, error) {\n    value, err := c.GetValue(key)\n\n    return value, err\n}\n\n// Connection ...\ntype Connection interface {\n    GetClient() (*redis.Client, error)\n}\n\n// RedisConnection ...\ntype RedisConnection struct {}\n\n// NewRedisConnection ...\nfunc NewRedisConnection() Connection {\n    return RedisConnection{}\n}\n\n// GetClient ...\nfunc (r RedisConnection) GetClient() (*redis.Client, error) {\n    redisHost := \"localhost\"\n    redisPort := \"6379\"\n\n    if os.Getenv(\"REDIS_HOST\") != \"\" {\n        redisHost = os.Getenv(\"REDIS_HOST\")\n    }\n\n    if os.Getenv(\"REDIS_PORT\") != \"\" {\n        redisPort = os.Getenv(\"REDIS_PORT\")\n    }\n\n    client := redis.NewClient(&amp;redis.Options{\n        Addr:     redisHost + \":\" + redisPort,\n        Password: \"\", // no password set\n        DB:       0,  // use default DB\n    })\n\n    return client, nil\n}\n\n// GetValue ...\nfunc (r RedisConnection) GetValue(key string) (string, error) {\n    client, e := r.GetClient()\n    result, err := client.Ping().Result()\n    return result, nil\n}\n</code></pre>\n"}, {"tags": ["regex", "go"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9964965, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-p3UN_8KNRlY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3K0gFt-0VNV8Wg0JovGmkt2_tSJA/mo/photo.jpg?sz=128", "display_name": "asdfasdfasdf", "link": "https://stackoverflow.com/users/9964965/asdfasdfasdf"}, "edited": false, "score": 0, "creation_date": 1529460960, "post_id": 50939230, "comment_id": 88876669, "body": "Thanks but only the top one works. Will accept answer in mandatory 8 minutes."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 3, "user_id": 9964965, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-p3UN_8KNRlY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3K0gFt-0VNV8Wg0JovGmkt2_tSJA/mo/photo.jpg?sz=128", "display_name": "asdfasdfasdf", "link": "https://stackoverflow.com/users/9964965/asdfasdfasdf"}, "edited": false, "score": 0, "creation_date": 1529461253, "post_id": 50939230, "comment_id": 88876720, "body": "@asdf Second one fixed."}], "tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": true, "score": 5, "last_activity_date": 1529461241, "last_edit_date": 1529461241, "creation_date": 1529460747, "answer_id": 50939230, "question_id": 50939194, "link": "https://stackoverflow.com/questions/50939194/golang-regex-match/50939230#50939230", "title": "Golang regex match +-/*", "body": "<p>Escape RegEx meta characters:</p>\n\n<pre><code>MustCompile(\"^(\\\\+|-|\\\\*|/)\")\n</code></pre>\n\n<p>Or better yet, use a bracket expression:</p>\n\n<pre><code>MustCompile(\"^[-+*/]\")\n</code></pre>\n\n<p>Note in bracket expressions you must put the hyphen at first or at last.</p>\n"}], "owner": {"reputation": 3, "user_id": 9964965, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-p3UN_8KNRlY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3K0gFt-0VNV8Wg0JovGmkt2_tSJA/mo/photo.jpg?sz=128", "display_name": "asdfasdfasdf", "link": "https://stackoverflow.com/users/9964965/asdfasdfasdf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 795, "favorite_count": 0, "accepted_answer_id": 50939230, "answer_count": 1, "score": 0, "last_activity_date": 1529467608, "creation_date": 1529460549, "last_edit_date": 1529467608, "question_id": 50939194, "link": "https://stackoverflow.com/questions/50939194/golang-regex-match", "title": "Golang regex match +-/*", "body": "<p>I tried this:</p>\n\n<p><code>re_operator := regexp.MustCompile(\"^(+|-|*|/)\")</code></p>\n\n<p>I get this:</p>\n\n<pre><code>panic: regexp: Compile(`^(+|-|*|/)`): error parsing regexp: missing argument to repetition operator: `+`\n</code></pre>\n\n<p>It's literally impossible to Google an answer to this question, not to mention it varies for every language and version. I'm about to use an if else. Escape sequences are also a pain. Should I try escaping my escape sequence?</p>\n\n<p>Unhelpful answer:\n<a href=\"https://stackoverflow.com/questions/1631820/regular-expression-to-match-digits-and-basic-math-operators\">Regular expression to match digits and basic math operators</a></p>\n"}, {"tags": ["go", "naming-conventions"], "comments": [{"owner": {"reputation": 234, "user_id": 2849149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o3uGA.png?s=128&g=1", "display_name": "Snehal Dangroshiya", "link": "https://stackoverflow.com/users/2849149/snehal-dangroshiya"}, "edited": false, "score": 0, "creation_date": 1529462778, "post_id": 50939125, "comment_id": 88877016, "body": "hope it will help u <a href=\"https://stackoverflow.com/questions/38616687/which-way-to-name-a-function-in-go-camelcase-or-semi-camelcase\" title=\"which way to name a function in go camelcase or semi camelcase\">stackoverflow.com/questions/38616687/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 1031058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f0a16af9a62c5c7b236daa3cafe284f?s=128&d=identicon&r=PG", "display_name": "Junhee Woo", "link": "https://stackoverflow.com/users/1031058/junhee-woo"}, "edited": false, "score": 0, "creation_date": 1529470214, "post_id": 50939563, "comment_id": 88878625, "body": "Thanks for your answer @chuckx, but I know that the first character determines exportability, but it still seems confusing. What I want to ask is whether this kind of naming is normal and usual in golang. You can find the differences between them if you take a look. Wouldn&#39;t it be better if they have distinctive names like accountSomething1 and AccountSomething2."}, {"owner": {"reputation": 5105, "user_id": 373815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vBPZK.png?s=128&g=1", "display_name": "chuckx", "link": "https://stackoverflow.com/users/373815/chuckx"}, "reply_to_user": {"reputation": 39, "user_id": 1031058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f0a16af9a62c5c7b236daa3cafe284f?s=128&d=identicon&r=PG", "display_name": "Junhee Woo", "link": "https://stackoverflow.com/users/1031058/junhee-woo"}, "edited": false, "score": 0, "creation_date": 1529471657, "post_id": 50939563, "comment_id": 88879033, "body": "Updated the answer with some observations about the codebase."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1529503013, "post_id": 50939563, "comment_id": 88897580, "body": "&quot;Wouldn&#39;t it be better&quot; is a question of opinion (OT for SO) and a question for the project maintainers, not the community at large. If you have questions about the design decisions made by a particular project, ask the people that made those decisions."}], "tags": [], "owner": {"reputation": 5105, "user_id": 373815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vBPZK.png?s=128&g=1", "display_name": "chuckx", "link": "https://stackoverflow.com/users/373815/chuckx"}, "is_accepted": false, "score": 2, "last_activity_date": 1529471642, "last_edit_date": 1529471642, "creation_date": 1529463726, "answer_id": 50939563, "question_id": 50939125, "link": "https://stackoverflow.com/questions/50939125/golang-variable-naming-convention-across-packages/50939563#50939563", "title": "golang variable naming convention across packages", "body": "<blockquote>\n  <p>There are both \"account\" and \"Account\" types in state package, which seems weird.</p>\n</blockquote>\n\n<p>There is a meaningful difference between these two names in the language specification.</p>\n\n<p>From the <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">Go Language Specification</a>:</p>\n\n<blockquote>\n  <p>An identifier may be exported to permit access to it from another\n  package. An identifier is exported if both:</p>\n  \n  <ol>\n  <li>the first character of the identifier's name is a Unicode upper case\n  letter (Unicode class \"Lu\"); and </li>\n  <li>the identifier is declared in the\n  package block or it is a field name or method name.</li>\n  </ol>\n  \n  <p>All other identifiers are not exported.</p>\n</blockquote>\n\n<p>So, taking a closer look at the go-ethereum codebase, here are my observations:</p>\n\n<ul>\n<li><a href=\"https://github.com/ethereumproject/go-ethereum/blob/5291a2863d27e68310722e2ab9facff438e23cd8/core/state/managed_state.go#L25\" rel=\"nofollow noreferrer\">type account in managed_state.go</a> is an internal implementation detail, providing a type for <a href=\"https://github.com/ethereumproject/go-ethereum/blob/5291a2863d27e68310722e2ab9facff438e23cd8/core/state/managed_state.go#L36\" rel=\"nofollow noreferrer\">the accounts field in the exported ManageState struct</a></li>\n<li><a href=\"https://github.com/ethereumproject/go-ethereum/blob/5291a2863d27e68310722e2ab9facff438e23cd8/core/state/state_object.go#L103\" rel=\"nofollow noreferrer\">type Account in state_object.go</a> is an exported identifier</li>\n</ul>\n\n<p>I think the implementation choice make more sense when you look at <a href=\"https://godoc.org/github.com/ethereum/go-ethereum/core/state\" rel=\"nofollow noreferrer\">the generated documentation</a>.</p>\n\n<p>In particular, the <a href=\"https://godoc.org/github.com/ethereum/go-ethereum/core/state#Account\" rel=\"nofollow noreferrer\">Account type is front and center</a>, detailing a data structure that's of interest to consumers of the package.</p>\n\n<p>When you look at <a href=\"https://godoc.org/github.com/ethereum/go-ethereum/core/state#ManagedState\" rel=\"nofollow noreferrer\">the documentation for the ManageState struct</a>, the unexported fields are purposely not documented. This is because they're internal details that don't impact the exported interface and could easily be changed without impacting users of the package.</p>\n\n<hr>\n\n<p>In regards to naming recommendations, see the <a href=\"https://golang.org/doc/effective_go.html?#names\" rel=\"nofollow noreferrer\"><strong>Names</strong> section in <em>Effective Go</em></a>.</p>\n"}], "owner": {"reputation": 39, "user_id": 1031058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f0a16af9a62c5c7b236daa3cafe284f?s=128&d=identicon&r=PG", "display_name": "Junhee Woo", "link": "https://stackoverflow.com/users/1031058/junhee-woo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 786, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529471642, "creation_date": 1529459835, "question_id": 50939125, "link": "https://stackoverflow.com/questions/50939125/golang-variable-naming-convention-across-packages", "title": "golang variable naming convention across packages", "body": "<p>Recently I started studying go-ethereum and this was my first time using golang. C++ is my main language and I'm a bit puzzled due to variable names in go-ethereum project.</p>\n\n<p>core/state/managed_state.go:25:type account struct {</p>\n\n<p>core/state/state_object.go:98:type Account struct {</p>\n\n<p>There are both \"account\" and \"Account\" types in state package, which seems weird.</p>\n\n<p>I've checked <a href=\"https://stackoverflow.com/questions/40881994/naming-convention-for-similar-golang-variables\">Naming convention for similar Golang variables</a>, and it still looks terrible.</p>\n\n<p>And what I've found is that they use a lot of \"Node\" struct in different packages. Definitely they do have different purposes and structures. </p>\n\n<p>Are these kinds of naming is convention and popular in golang? \nIf you have any good references for naming convention in golang (e.g. open source projects or books), could you please name some of them? It would be really appreciated.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 7, "creation_date": 1529448291, "post_id": 50937900, "comment_id": 88874118, "body": "No, not possible. You could, however, define a new type (<code>type State [][]bool</code>) and define the String method on that."}, {"owner": {"reputation": 81, "user_id": 2820730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d2151224ba11084a3001757056cc00c?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2820730/kevin"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1529449010, "post_id": 50937900, "comment_id": 88874284, "body": "If you define a new type, then how would I be able to get access to the parent&#39;s <code>Width</code> and <code>Height</code> fields?"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 6, "creation_date": 1529449100, "post_id": 50937900, "comment_id": 88874307, "body": "You can&#39;t without an explicit reference.  If that&#39;s what you need, define a new method on your Panel type."}, {"owner": {"reputation": 4316, "user_id": 486035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1654e9816b6e407e1daced17ac4fcf3b?s=128&d=identicon&r=PG", "display_name": "phemmer", "link": "https://stackoverflow.com/users/486035/phemmer"}, "edited": false, "score": 2, "creation_date": 1529463811, "post_id": 50937900, "comment_id": 88877237, "body": "Perhaps you can update your question. Your example shows no usage of the <code>Width</code> or <code>Height</code> fields. The recommended solution of a <code>type State [][]bool</code> meets the conditions of your example"}, {"owner": {"reputation": 81, "user_id": 2820730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d2151224ba11084a3001757056cc00c?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2820730/kevin"}, "reply_to_user": {"reputation": 4316, "user_id": 486035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1654e9816b6e407e1daced17ac4fcf3b?s=128&d=identicon&r=PG", "display_name": "phemmer", "link": "https://stackoverflow.com/users/486035/phemmer"}, "edited": false, "score": 0, "creation_date": 1529721877, "post_id": 50937900, "comment_id": 88989157, "body": "Updated @Patrick, thanks!"}], "owner": {"reputation": 81, "user_id": 2820730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d2151224ba11084a3001757056cc00c?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2820730/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529521413, "creation_date": 1529448140, "last_edit_date": 1529521413, "question_id": 50937900, "link": "https://stackoverflow.com/questions/50937900/can-a-nested-method-access-parents-values", "title": "Can a nested method access parent&#39;s values?", "body": "<p>I'm trying to create a string view of state, so when called:</p>\n\n<pre><code>fmt.Printf(\"%s\", panel.State)\n</code></pre>\n\n<p>It'll will print out something like:</p>\n\n<pre><code>Hi\n\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\n\u26aa\ufe0f\u26ab\ufe0f\u26aa\ufe0f\u26ab\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26ab\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\n\u26aa\ufe0f\u26ab\ufe0f\u26aa\ufe0f\u26ab\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\n\u26aa\ufe0f\u26ab\ufe0f\u26ab\ufe0f\u26ab\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26ab\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\n\u26aa\ufe0f\u26ab\ufe0f\u26aa\ufe0f\u26ab\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26ab\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\n\u26aa\ufe0f\u26ab\ufe0f\u26aa\ufe0f\u26ab\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26ab\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\n\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\u26aa\ufe0f\n</code></pre>\n\n<p>Is it possible to add a method on a nested field, then have access to it's parent struct, something like:</p>\n\n<pre><code>type Panel struct {\n  Width  int\n  Height int\n  Message string\n\n  State [][]bool\n}\n\nfunc (state Panel.State) String() string {\n  line := state.parent.Message + \"\\n\"\n  for x := 0; x &lt; state.parent.Width; x++ {\n    for y := 0; y &lt; state.parent.Height; y++ {\n      cell = state[x][y]\n      if cell {\n        line += \"\u26ab\ufe0f\"\n      } else {\n        line += \"\u26aa\ufe0f\"\n      }\n    }\n    line += \"\\n\"\n  }\n\n  return line\n}\n</code></pre>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1529445091, "post_id": 50937379, "comment_id": 88873292, "body": "You are ignoring errors and have a data race around <code>loop_break</code>. Try fixing those issues first."}, {"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 3, "creation_date": 1529445579, "post_id": 50937379, "comment_id": 88873413, "body": "What you&#39;re describing sounds like you might be leaking variables into your closure that you don&#39;t think should be. You haven&#39;t given us all your code so there may be a problem we can&#39;t see. My guess is that <code>final_url</code> is defined outside the go routine and you&#39;re creating a race condition where 1 or 2 of your go routines think they&#39;ve set <code>final_url</code> to the URL they&#39;re supposed to request but before they make the request another go routines sets it again. Then you have multiple go routines requesting the same URL and producing duplicates. It&#39;s just a guess since we don&#39;t have all the code."}, {"owner": {"reputation": 2341, "user_id": 8391703, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JS46C.png?s=128&g=1", "display_name": "Zachscs", "link": "https://stackoverflow.com/users/8391703/zachscs"}, "edited": false, "score": 0, "creation_date": 1529450614, "post_id": 50937379, "comment_id": 88874640, "body": "Read about concurrency in go: <a href=\"https://www.golang-book.com/books/intro/10\" rel=\"nofollow noreferrer\">golang-book.com/books/intro/10</a>"}, {"owner": {"reputation": 103, "user_id": 9964362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7604db20ee5beada6e23ab01a5d97dfe?s=128&d=identicon&r=PG&f=1", "display_name": "Alex M", "link": "https://stackoverflow.com/users/9964362/alex-m"}, "reply_to_user": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 0, "creation_date": 1529488741, "post_id": 50937379, "comment_id": 88888186, "body": "@CoreyOgburn this is the correct guess. I changed the logic where final_url is being declared inside goroutines and now i get predictable and correct results. Appreciate your help! If you post an answer i&#39;ll mark it as a correct one"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 9964362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7604db20ee5beada6e23ab01a5d97dfe?s=128&d=identicon&r=PG&f=1", "display_name": "Alex M", "link": "https://stackoverflow.com/users/9964362/alex-m"}, "edited": false, "score": 0, "creation_date": 1529608364, "post_id": 50956028, "comment_id": 88947958, "body": "Thank you for more detailed answer. I&#39;ll try to rewrite the logic considering channels"}], "tags": [], "owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "is_accepted": true, "score": 0, "last_activity_date": 1529524923, "last_edit_date": 1529524923, "creation_date": 1529524199, "answer_id": 50956028, "question_id": 50937379, "link": "https://stackoverflow.com/questions/50937379/unpredictable-results-with-http-client-and-goroutines/50956028#50956028", "title": "Unpredictable results with http.Client and goroutines", "body": "<p>You're creating a closure by using an anonymous go routine function. I notice your <code>final_url</code> isn't <code>:=</code> but <code>=</code> which means it's defined outside the closure. All go routines will have access to the same value of <code>final_url</code> and there's a race condition going on. Some go routines are overwriting <code>final_url</code> before other go routines are making their requests and this will result in duplicates.</p>\n\n<p>If you define <code>final_url</code> inside the go routine then they won't be stepping on each other's toes and it should work as you expect.</p>\n\n<p>That's the simple fix for what you have. A more idiomatically Go way to do this would be to create an input channel (containing the URLs to request) and an output channel (eventually containing whatever you're pulling out of the response) and instead of trying to manage the life and death of dozens of go routines you would keep alive a constant amount of go routines that try to empty out the input channel.</p>\n"}], "owner": {"reputation": 103, "user_id": 9964362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7604db20ee5beada6e23ab01a5d97dfe?s=128&d=identicon&r=PG&f=1", "display_name": "Alex M", "link": "https://stackoverflow.com/users/9964362/alex-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "accepted_answer_id": 50956028, "answer_count": 1, "score": -2, "last_activity_date": 1529524923, "creation_date": 1529444887, "last_edit_date": 1529445287, "question_id": 50937379, "link": "https://stackoverflow.com/questions/50937379/unpredictable-results-with-http-client-and-goroutines", "title": "Unpredictable results with http.Client and goroutines", "body": "<p>I'm new to Golang, trying to build a system that fetches content from a set of urls and extract specific lines with regex. The problems start when i wrap the code with goroutines. I'm getting a different number of regex results and many of fetched lines are duplicates.</p>\n\n<pre><code>max_routines := 3\n\nsem := make(chan int, max_routines) // to control the number of working routines \nvar wg sync.WaitGroup\nch_content := make(chan string)\n\nclient := http.Client{}\n\nfor i:=2; ; i++ { \n\n    // for testing\n    if i&gt;5 {\n        break\n    }\n\n    // loop should be broken if feebbacks_checstr is found in content\n    if loop_break {\n        break\n    }\n\n    wg.Add(1)\n    go func(i int) {\n\n        defer wg.Done()\n\n        sem &lt;- 1 // will block if &gt; max_routines\n\n        final_url = url+a.tm_id+\"/page=\"+strconv.Itoa(i)\n\n        resp, _ := client.Get(final_url)\n\n        var bodyString string \n\n        if resp.StatusCode == http.StatusOK {\n            bodyBytes, _ := ioutil.ReadAll(resp.Body)\n            bodyString = string(bodyBytes)\n        }\n\n        // checking for stop word in content\n        if false == strings.Contains(bodyString, feebbacks_checstr) {\n\n            res2 = regex.FindAllStringSubmatch(bodyString,-1)\n            for _,v := range res2 {\n                ch_content &lt;- v[1]\n            }\n\n        } else {\n            loop_break = true\n        }\n\n        resp.Body.Close()\n\n        &lt;-sem\n\n    }(i)\n}\n\n\nfor {\n    select {\n        case r := &lt;-ch_content:\n            a.feedbacks = append(a.feedbacks, r) // collecting the data \n        case &lt;-time.After(500 * time.Millisecond):\n            show(len(a.feedbacks)) // &lt; always different result, many entries in a.feedbacks are duplicates\n            fmt.Printf(\".\")\n    }\n}\n</code></pre>\n\n<p>As a result len(a.feedbacks) gives sometimes 130, sometimes 139 and a.feedbacks contains duplicates. If i clean the duplicates the number of results is about half of what i'm expecting (109 without duplicates)</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1529437124, "post_id": 50935760, "comment_id": 88870135, "body": "Why would you expect it to deadlock?"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1529437218, "post_id": 50935760, "comment_id": 88870170, "body": "Why would you expect a deadlock? What part of the logic don&#39;t you understand?"}, {"owner": {"reputation": 101, "user_id": 8580601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48d1f722aa37e73e3e91872b3936c56d?s=128&d=identicon&r=PG&f=1", "display_name": "lmln", "link": "https://stackoverflow.com/users/8580601/lmln"}, "edited": false, "score": 0, "creation_date": 1529438495, "post_id": 50935760, "comment_id": 88870755, "body": "I expected a deadlock because s is locked in start() and it&#39;s trying to lock again in processing() and s hasn&#39;t unlocked."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1529438533, "post_id": 50935760, "comment_id": 88870774, "body": "But it will unlock. <code>start</code> isn&#39;t blocked on anything, the other calls are concurrent, so it will release the lock."}], "answers": [{"comments": [{"owner": {"reputation": 2267, "user_id": 2639647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc746964582ffff4760c1e7493c13189?s=128&d=identicon&r=PG", "display_name": "Travis Hegner", "link": "https://stackoverflow.com/users/2639647/travis-hegner"}, "edited": false, "score": 0, "creation_date": 1529437928, "post_id": 50935902, "comment_id": 88870520, "body": "More of an infinite recursion than an infinite loop, but similar in effect. It should be noted that this process may actually leak go routines, however."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 2267, "user_id": 2639647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc746964582ffff4760c1e7493c13189?s=128&d=identicon&r=PG", "display_name": "Travis Hegner", "link": "https://stackoverflow.com/users/2639647/travis-hegner"}, "edited": false, "score": 0, "creation_date": 1529438413, "post_id": 50935902, "comment_id": 88870715, "body": "In code, yes, it <i>looks</i> like recursion. However, because the inner call is concurrent and the outer call returns before the inner, it behaves like an infinite loop, not like recursion."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 0, "last_activity_date": 1529437679, "creation_date": 1529437679, "answer_id": 50935902, "question_id": 50935760, "link": "https://stackoverflow.com/questions/50935760/goroutines-and-mutex/50935902#50935902", "title": "Goroutines and mutex", "body": "<p>We'll call the initial goroutine that's running when <code>start</code> is entered G1.</p>\n\n<ol>\n<li><code>start</code> (in G1) locks the mutex and defers the unlock until <code>start</code> returns.</li>\n<li><code>start</code> calls <code>s.processing</code> in a new goroutine (G2)</li>\n<li><code>start</code> calls itself in a new goroutine (G3)</li>\n<li><code>start</code> (G1) unlocks the mutex and returns.</li>\n</ol>\n\n<p>None of those calls except the lock at Step 1 is a blocking call. <em>Concurrently</em>, in G2, <code>s.processing</code> waits for <code>start</code> to unlock the mutex (which will happen pretty quickly because all <code>start</code> does is start a couple goroutines before unlocking the mutex). Also concurrently, in G3, the above 4 steps are performed all over again (on an apparently infinite loop).</p>\n\n<p>There is no point in that logic that could cause a deadlock.</p>\n"}], "owner": {"reputation": 101, "user_id": 8580601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48d1f722aa37e73e3e91872b3936c56d?s=128&d=identicon&r=PG&f=1", "display_name": "lmln", "link": "https://stackoverflow.com/users/8580601/lmln"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "closed_date": 1529441020, "accepted_answer_id": 50935902, "answer_count": 1, "score": -3, "last_activity_date": 1529437679, "creation_date": 1529437001, "question_id": 50935760, "link": "https://stackoverflow.com/questions/50935760/goroutines-and-mutex", "closed_reason": "Needs details or clarity", "title": "Goroutines and mutex", "body": "<pre><code>func (s *Server) start() {\n         s.Lock()\n         defer s.Unlock()\n        if !s.isClosed{\n           go s.processing()\n        }\n        go s.start()\n }\n\nfunc (s *Server) processing() {\n  s.Lock()\n  // do stuff\n  s.Unlock()\n}\n</code></pre>\n\n<p>I have a working Golang project that has a block of code following the logic shown above. </p>\n\n<p>I don't understand why this logic works as I would've expected a deadlock. </p>\n"}, {"tags": ["go", "prometheus"], "answers": [{"comments": [{"owner": {"reputation": 4567, "user_id": 1318734, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/S3JJ2.gif?s=128&g=1", "display_name": "rofls", "link": "https://stackoverflow.com/users/1318734/rofls"}, "edited": false, "score": 1, "creation_date": 1529986098, "post_id": 50946559, "comment_id": 89061443, "body": "This turned out to be simply an inconsistency with the UI. The labels were there, I just had to click on the metric, whereas previously and with other metrics/labels, they were displayed next to the metric without having to drill down :facepalm: not sure why they require drilling down now."}], "tags": [], "owner": {"reputation": 556, "user_id": 3581874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2073bb9adeaf4226234f85ff4c1b69?s=128&d=identicon&r=PG&f=1", "display_name": "MichalG", "link": "https://stackoverflow.com/users/3581874/michalg"}, "is_accepted": false, "score": 5, "last_activity_date": 1583209777, "last_edit_date": 1583209777, "creation_date": 1529492104, "answer_id": 50946559, "question_id": 50935264, "link": "https://stackoverflow.com/questions/50935264/why-dont-my-prometheus-labels-show-up/50946559#50946559", "title": "Why don&#39;t my prometheus labels show up?", "body": "<p>Could you share your prometheus scrape configuration?</p>\n\n<p>I made a minimal example based on yours and labels seem to be correctly updated on the prometheus side.</p>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/prometheus/client_golang/prometheus\"\n    \"github.com/prometheus/client_golang/prometheus/push\"\n)\n\nconst (\n    pushgatewayIngress = \"http://localhost:9091\"\n    cluster            = \"testCluster\"\n)\n\nfunc main() {\n    completionTime := prometheus.NewGaugeVec(\n        prometheus.GaugeOpts{\n            Name: \"completion_timestamp_seconds\",\n            Help: \"The timestamp of the last successful completion.\",\n        },\n        []string{\"cluster\"},\n    )\n    completionTime.With(prometheus.Labels{\"cluster\": cluster}).SetToCurrentTime()\n    if err := push.New(pushgatewayIngress, \"job_completion_time\").\n        Collector(completionTime).\n        Push(); err != nil {\n        fmt.Println(\"Could not push completion time to Pushgateway:\", err)\n    }\n\n    fmt.Println(\"done\")\n}\n</code></pre>\n\n<p><strong>prometheus.yml</strong> - (configuration file)</p>\n\n<pre><code>global:\n  scrape_interval: 15s\n  scrape_timeout: 10s\n  evaluation_interval: 15s\n\nscrape_configs:\n- job_name: pushgateway\n  scrape_interval: 5s\n  static_configs:\n    - targets: ['pushgateway:9091']\n</code></pre>\n\n<p><strong>docker-compose.yml</strong> - sets up containers for pushgateway and prometheus in containers</p>\n\n<pre><code>pushgateway:\n  image: prom/pushgateway\n  ports:\n    - 9091:9091\n\nprometheus:\n  image: prom/prometheus\n  ports:\n    - 9090:9090\n  links:\n    - pushgateway:pushgateway\n  volumes:\n    - ./prometheus.yml:/etc/prometheus/prometheus.yml\n</code></pre>\n\n<p>You run <code>docker-compose up</code> from the folder with docker-compose.yml and prometheus.yml, and this should work (it works on my side). Do you see any differences between this and your configuration?</p>\n\n<p>Note, that you may want to use <code>honor_labels: true</code> in your scrape config for correct label collection, as described <a href=\"https://github.com/prometheus/pushgateway#about-the-job-and-instance-labels\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 4567, "user_id": 1318734, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/S3JJ2.gif?s=128&g=1", "display_name": "rofls", "link": "https://stackoverflow.com/users/1318734/rofls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 952, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1583209777, "creation_date": 1529434680, "question_id": 50935264, "link": "https://stackoverflow.com/questions/50935264/why-dont-my-prometheus-labels-show-up", "title": "Why don&#39;t my prometheus labels show up?", "body": "<p>I'm trying to add labels to a metric in a push gateway. Here is the code I'm using:</p>\n\n<pre><code>completionTime := prometheus.NewGaugeVec(\n        prometheus.GaugeOpts{\n                Name: \"completion_timestamp_seconds\",\n                Help: \"The timestamp of the last successful completion.\",\n        },  \n        []string{\"cluster\"},\n)   \ncompletionTime.With(prometheus.Labels{\"cluster\": cluster}).SetToCurrentTime()\nif err := push.New(fmt.Sprintf(pushgatewayIngress, cluster), \"job_completion_time\").\n        Collector(completionTime).\n        Push(); err != nil {\n        fmt.Println(\"Could not push completion time to Pushgateway:\", err)\n}\n</code></pre>\n\n<p>The metric is being updated, but it's not including the label. Do I need to add something to the <code>Collector</code>?</p>\n"}, {"tags": ["go", "cookies"], "comments": [{"owner": {"reputation": 234, "user_id": 2849149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o3uGA.png?s=128&g=1", "display_name": "Snehal Dangroshiya", "link": "https://stackoverflow.com/users/2849149/snehal-dangroshiya"}, "edited": false, "score": 1, "creation_date": 1529431690, "post_id": 50934241, "comment_id": 88867565, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12130582/setting-cookies-in-golang-net-http\">Setting Cookies in Golang (net/http)</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2756, "user_id": 1375316, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/62627013dd03b525ba5954cff57b0f9b?s=128&d=identicon&r=PG", "display_name": "threeve", "link": "https://stackoverflow.com/users/1375316/threeve"}, "edited": false, "score": 3, "creation_date": 1529431991, "post_id": 50934594, "comment_id": 88867684, "body": "From the docs for <code>SetCookie</code>: &quot;Changing the header map after a call to WriteHeader (or Write) has no effect unless the modified headers are trailers.&quot;"}], "tags": [], "owner": {"reputation": 112, "user_id": 836309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1471825d38eef598838e0cb69b4803?s=128&d=identicon&r=PG&f=1", "display_name": "billf", "link": "https://stackoverflow.com/users/836309/billf"}, "is_accepted": true, "score": 4, "last_activity_date": 1529431871, "creation_date": 1529431871, "answer_id": 50934594, "question_id": 50934241, "link": "https://stackoverflow.com/questions/50934241/cookie-cant-be-set/50934594#50934594", "title": "Cookie can&#39;t be set.", "body": "<p>Your debugging statement...</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>fmt.Fprintln(w, \"setCookie called\")\n</code></pre>\n\n<p>... occurs before your <code>http.SetCookie</code> call.</p>\n\n<p>Cookies are set in headers but by writing to the <code>http.ReponseWriter</code> you've triggered the completion of setting any headers. If you move the debug statement to the last line of <code>setCookie</code>, it will work as expected.</p>\n\n<p>You can trivially test this by running:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>curl -v -c \"cookie.jar\" \"http://localhost:8080/set_cookie\"\n</code></pre>\n\n<p>before and after such a change.</p>\n"}], "owner": {"reputation": 3, "user_id": 9963451, "user_type": "registered", "profile_image": "https://graph.facebook.com/1912552735707661/picture?type=large", "display_name": "Takeshi Yamada", "link": "https://stackoverflow.com/users/9963451/takeshi-yamada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 849, "favorite_count": 0, "accepted_answer_id": 50934594, "answer_count": 1, "score": 0, "last_activity_date": 1529431871, "creation_date": 1529430476, "question_id": 50934241, "link": "https://stackoverflow.com/questions/50934241/cookie-cant-be-set", "title": "Cookie can&#39;t be set.", "body": "<p>I defined two handler functions, setCookie and getCookie.\nThe first function, setCookie, is called by getting access to localhost:8080/set_cookie, and then sends a HTTP response including two cookies.\nThe other function, getCookie, is called by accessing to localhost:8080/get_cookie, and then gets Cookie object.\nI expect getCookie function to show information about two cookies, but a message, \"first_cookie is not set successfully\", is shown on a web browser.</p>\n\n<p>Do you have any idea solving this problem?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc setCookie(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintln(w, \"setCookie called\")\n    c1 := http.Cookie{\n        Name:     \"first_cookie\",\n        Value:    \"Go Web App\",\n        HttpOnly: true,\n    }\n    c2 := http.Cookie{\n        Name:     \"second_cookie\",\n        Value:    \"Another service\",\n        HttpOnly: true,\n    }\n    http.SetCookie(w, &amp;c1)\n    http.SetCookie(w, &amp;c2)\n}\n\nfunc getCookie(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintln(w, \"getCookie called\")\n    c1, err := r.Cookie(\"first_cookie\")\n    if err != nil {\n        fmt.Fprintln(w, \"first_cookie is not set successfully.\")\n    }\n    ca := r.Cookies()\n    fmt.Fprintln(w, c1)\n    fmt.Fprintln(w, ca)\n}\n\nfunc main() {\n    server := http.Server{\n        Addr: \"127.0.0.1:8080\",\n    }\n    http.HandleFunc(\"/set_cookie\", setCookie)\n    http.HandleFunc(\"/get_cookie\", getCookie)\n    server.ListenAndServe()\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1529430540, "post_id": 50934231, "comment_id": 88867001, "body": "It&#39;s not a bug, it&#39;s a combination of insufficient precision and int overflow (causing the sign change)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1529430633, "post_id": 50934231, "comment_id": 88867050, "body": "You can see that the conversion to <code>float32</code> has made <code>f</code> larger than <code>MaxInt32</code>, what else would you expect? You also said you expect to see it off by one, and <code>MaxInt32 + 1</code> rolls over to <code>-2147483648</code>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1529431019, "post_id": 50934231, "comment_id": 88867237, "body": "<code>MaxFloat32 &gt; MaxInt32</code> and<code>MinFloat32 &lt; MinInt32</code> and <code>int32 != NaN</code> and so on. See <a href=\"https://en.wikipedia.org/wiki/IEEE_754\" rel=\"nofollow noreferrer\">IEEE 754</a>"}, {"owner": {"reputation": 71, "user_id": 3175316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15531b4690de423c79bc442f6e8885e2?s=128&d=identicon&r=PG", "display_name": "cdunham", "link": "https://stackoverflow.com/users/3175316/cdunham"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1529440460, "post_id": 50934231, "comment_id": 88871619, "body": "@JimB I would expect an overflow error"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1529441048, "post_id": 50934231, "comment_id": 88871841, "body": "From the first rule of numeric conversions: &quot; The conversion always yields a valid value; there is no indication of overflow&quot;"}, {"owner": {"reputation": 71, "user_id": 3175316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15531b4690de423c79bc442f6e8885e2?s=128&d=identicon&r=PG", "display_name": "cdunham", "link": "https://stackoverflow.com/users/3175316/cdunham"}, "edited": false, "score": 0, "creation_date": 1529441349, "post_id": 50934231, "comment_id": 88871931, "body": "I see. So to do a rational conversion from float32 to int32 requires several lines of boundary condition checks and whatnot. Got it."}], "owner": {"reputation": 71, "user_id": 3175316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15531b4690de423c79bc442f6e8885e2?s=128&d=identicon&r=PG", "display_name": "cdunham", "link": "https://stackoverflow.com/users/3175316/cdunham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 584, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1529430427, "creation_date": 1529430427, "question_id": 50934231, "link": "https://stackoverflow.com/questions/50934231/converting-float32-to-int32", "title": "Converting float32 to int32", "body": "<p>I am seeing some strange behavior converting float32 to int32:</p>\n\n<pre><code>var f float32 = math.MaxInt32\n\nfmt.Printf(\"%d %0.1f %d\\n\", math.MaxInt32, f, int32(f))\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>2147483647 2147483648.0 -2147483648\n</code></pre>\n\n<p>(At Go Playground: <a href=\"https://play.golang.org/p/SI0RtpZFkwa\" rel=\"nofollow noreferrer\">https://play.golang.org/p/SI0RtpZFkwa</a>)</p>\n\n<p>My guess is that there are a few things going on here, like general IEEE floating point imprecision and untamed automatic conversions. I would almost expect the \"off by one\" type of error, but why the sign conversion?</p>\n\n<p>Seems like a bug, but at the very least, it's surprising. This cropped up in a larger system that started behaving strangely at the edges.</p>\n\n<p>Ultimately, I just want to be able to convert <code>float32</code> values to <code>int32</code> in some reasonable way.</p>\n"}, {"tags": ["postgresql", "go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 9535995, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-epRCtFWb2Xo/AAAAAAAAAAI/AAAAAAAAAAg/f_d23tOMDiI/photo.jpg?sz=128", "display_name": "Lyubomyr Mykhalchyshyn", "link": "https://stackoverflow.com/users/9535995/lyubomyr-mykhalchyshyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1581004262, "last_edit_date": 1581004262, "creation_date": 1580988562, "answer_id": 60093958, "question_id": 50933953, "link": "https://stackoverflow.com/questions/50933953/postgres-foreign-key-on-delete-constraint/60093958#60093958", "title": "Postgres foreign key on delete constraint", "body": "<p>I have the same issue too.\nThe good idea is set a foreign keys when declare struct in your case is:</p>\n\n<pre><code>type Note struct {\n  NoteId              int       `gorm:\"primary_key;AUTO_INCREMENT\"`\n  RecipientId         int       `gorm:\"recipient_id\"`// your variant `gorm:\"index\"`\n  Content             string    `gorm:\"not null\"`\n  CreatedAt           time.Time `gorm:\"not null\"`\n  UpdatedAt           time.Time `gorm:\"not null\"`\n}\n\ntype User struct {\n  UserId              int       `gorm:\"primary_key;AUTO_INCREMENT\"`\n  Username            string    `gorm:\"not null;unique\"`\n  Email               string    `gorm:\"not null;unique\"`\n  Notes               []Note    `gorm:\"foreignkey:recipient_id\"`\n  CreatedAt           time.Time `gorm:\"not null\"`\n  UpdatedAt           time.Time `gorm:\"not null\"`\n}\n</code></pre>\n\n<p>Also in the future, if you will delete or update  related records folow this <a href=\"https://stackoverflow.com/questions/38270156/golang-gorm-is-it-possible-to-delete-a-record-via-a-many2many-relationship\">Golang Gorm: Is it possible to delete a record via a many2many relationship?</a></p>\n"}], "owner": {"reputation": 748, "user_id": 5289157, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh3.googleusercontent.com/-KVN5tChB2OQ/AAAAAAAAAAI/AAAAAAAABRk/FEKK6XOtwnI/photo.jpg?sz=128", "display_name": "Greg Miller", "link": "https://stackoverflow.com/users/5289157/greg-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1581004262, "creation_date": 1529429435, "last_edit_date": 1539070593, "question_id": 50933953, "link": "https://stackoverflow.com/questions/50933953/postgres-foreign-key-on-delete-constraint", "title": "Postgres foreign key on delete constraint", "body": "<p>Been following the guide on <a href=\"http://gorm.io/docs/belongs_to.html\" rel=\"nofollow noreferrer\">http://gorm.io/docs/belongs_to.html</a> trying to get simple foreign keys setup, however, I can't find any info on using <code>ON CASCADE</code> or <code>ON DELETE</code>. </p>\n\n<p>On <a href=\"http://doc.gorm.io/database.html#migration\" rel=\"nofollow noreferrer\">http://doc.gorm.io/database.html#migration</a> under the <code>Add Foreign Key</code> section it does make use of <code>ON DELETE</code> and <code>ON CASCADE</code>, however when I use this method when inserting I get a fk constraint error. </p>\n\n<p>I'm looking for advice on using the first method ,<code>gorm:\"foreignkey:UserRefer\"</code>, to also specify <code>ON DELETE</code> or <code>ON CASCADE</code>. Any suggestions?</p>\n\n<p>EDIT #1:\nTo show what I mean by error, I'll use this as an example:</p>\n\n<p><strong>Note.go:</strong></p>\n\n<pre><code>type Note struct {\n  NoteId              int       `gorm:\"primary_key;AUTO_INCREMENT\"`\n  RecipientId         int       `gorm:\"index\"`\n  Content             string    `gorm:\"not null\"`\n  CreatedAt           time.Time `gorm:\"not null\"`\n  UpdatedAt           time.Time `gorm:\"not null\"`\n}\n</code></pre>\n\n<p><strong>User.go</strong></p>\n\n<pre><code>type User struct {\n  UserId              int       `gorm:\"primary_key;AUTO_INCREMENT\"`\n  Username            string    `gorm:\"not null;unique\"`\n  Email               string    `gorm:\"not null;unique\"`\n  Notes               []Note\n  CreatedAt           time.Time `gorm:\"not null\"`\n  UpdatedAt           time.Time `gorm:\"not null\"`\n}\n</code></pre>\n\n<p><strong>database.go</strong></p>\n\n<pre><code>db.AutoMigrate(&amp;models.User{}, &amp;models.Note{})\ndb.Model(&amp;models.Note{}).AddForeignKey(\"recipient_id\", \"users(user_id)\", \"RESTRICT\", \"RESTRICT\")\n\nuser := models.User{Username:\"test\", Email:\"test@gmail.com\"}\nnote := models.Note{RecipientId:user.UserId, Content:\"test\"}\n\ndb.Create(&amp;user)\ndb.Create(&amp;note)\n</code></pre>\n\n<p>When the above code is placed in its proper functions, this error is thrown:</p>\n\n<pre><code>(pq: insert or update on table \"notes\" violates foreign key constraint \"notes_recipient_id_users_user_id_foreign\") \n</code></pre>\n"}, {"tags": ["go", "logging"], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 5001230, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nqo0Ar8nIUg/AAAAAAAAAAI/AAAAAAAABdI/6cpDBkb_ypE/photo.jpg?sz=128", "display_name": "Nidhi Sharma", "link": "https://stackoverflow.com/users/5001230/nidhi-sharma"}, "is_accepted": false, "score": 2, "last_activity_date": 1529439654, "creation_date": 1529439654, "answer_id": 50936341, "question_id": 50933936, "link": "https://stackoverflow.com/questions/50933936/zap-logger-does-not-print-on-console-rather-print-in-the-log-file/50936341#50936341", "title": "Zap logger does not print on console rather print in the log file", "body": "<p>Figured out that zapcore has NewMultiWriteSyncer which can write the logs in file and also on console using zapcore.addSync(os.stdout). For ex:</p>\n\n<pre><code>swSugar := zapcore.NewMultiWriteSyncer(zapcore.AddSync(os.Stdout), \n           getWriteSyncer(logfileName))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 471, "user_id": 4897593, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155566542875634/picture?type=large", "display_name": "Richard", "link": "https://stackoverflow.com/users/4897593/richard"}, "is_accepted": false, "score": 2, "last_activity_date": 1551779457, "creation_date": 1551779457, "answer_id": 54999899, "question_id": 50933936, "link": "https://stackoverflow.com/questions/50933936/zap-logger-does-not-print-on-console-rather-print-in-the-log-file/54999899#54999899", "title": "Zap logger does not print on console rather print in the log file", "body": "<p>Since this is one of the first things that appears after looking for this on Google, here's a simple example of how to make logs show on the Console and a log file, which can be any io.Writer as the one used by lumberjack:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func logInit(d bool, f *os.File) *zap.SugaredLogger {\n\n    pe := zap.NewProductionEncoderConfig()\n\n    fileEncoder := zapcore.NewJSONEncoder(pe)\n\n    pe.EncodeTime = zapcore.ISO8601TimeEncoder # The encoder can be customized for each output\n    consoleEncoder := zapcore.NewConsoleEncoder(pe)\n\n    level := zap.InfoLevel\n    if d {\n        level = zap.DebugLevel\n    }\n\n    core := zapcore.NewTee(\n        zapcore.NewCore(fileEncoder, zapcore.AddSync(f), level),\n        zapcore.NewCore(consoleEncoder, zapcore.AddSync(os.Stdout), level),\n    )\n\n    l := zap.New(core) # Creating the logger\n\n    return l.Sugar()\n}\n</code></pre>\n\n<p>I used the default ProductionEncoderConfig but it could be a custom one like the one on OP's code.</p>\n"}], "owner": {"reputation": 131, "user_id": 5001230, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nqo0Ar8nIUg/AAAAAAAAAAI/AAAAAAAABdI/6cpDBkb_ypE/photo.jpg?sz=128", "display_name": "Nidhi Sharma", "link": "https://stackoverflow.com/users/5001230/nidhi-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2824, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1551779457, "creation_date": 1529429371, "last_edit_date": 1529433929, "question_id": 50933936, "link": "https://stackoverflow.com/questions/50933936/zap-logger-does-not-print-on-console-rather-print-in-the-log-file", "title": "Zap logger does not print on console rather print in the log file", "body": "<p>I have integrated Zap with my go application, we have logs getting printed in two log files and i am also using Lumberjack for log rotation. But i am trying to display the logs in console as well, but no luck for this case. \nFollowing is my code in logger.go</p>\n\n<pre><code>var (\n    Logger *zap.Logger\n    N2n    *zap.Logger\n)\n\ntype WriteSyncer struct {\n    io.Writer\n}\n\nfunc (ws WriteSyncer) Sync() error {\n    return nil\n}\n\nfunc InitLogging(mode string) {\n    var cfg zap.Config\n    var logName = \"abc.log\"\n    var slogName = \"n2n.log\"\n\n    if mode == \"production\" {\n        cfg = zap.NewProductionConfig()\n        cfg.DisableCaller = true\n    } else {\n        cfg = zap.NewDevelopmentConfig()\n        cfg.EncoderConfig.LevelKey = \"level\"\n        cfg.EncoderConfig.NameKey = \"name\"\n        cfg.EncoderConfig.MessageKey = \"msg\"\n        cfg.EncoderConfig.CallerKey = \"caller\"\n        cfg.EncoderConfig.StacktraceKey = \"stacktrace\"\n    }\n\n    cfg.Encoding = \"json\"\n    cfg.EncoderConfig.TimeKey = \"timestamp\"\n    cfg.EncoderConfig.EncodeTime = zapcore.ISO8601TimeEncoder\n    cfg.OutputPaths = []string{logName}\n    sw := getWriteSyncer(logName)\n    swSugar := getWriteSyncer(slogName)\n\n    l, err := cfg.Build(SetOutput(sw, cfg))\n    if err != nil {\n        panic(err)\n    }\n    defer l.Sync()\n\n    ls, err := cfg.Build(SetOutput(swSugar, cfg))\n    if err != nil {\n        panic(err)\n    }\n    defer ls.Sync()\n\n    Logger = l\n    N2n = ls\n}\n\n// SetOutput replaces existing Core with new, that writes to passed WriteSyncer.\nfunc SetOutput(ws zapcore.WriteSyncer, conf zap.Config) zap.Option {\n    var enc zapcore.Encoder\n    switch conf.Encoding {\n    case \"json\":\n        enc = zapcore.NewJSONEncoder(conf.EncoderConfig)\n    case \"console\":\n        enc = zapcore.NewConsoleEncoder(conf.EncoderConfig)\n    default:\n        panic(\"unknown encoding\")\n    }\n\n    return zap.WrapCore(func(core zapcore.Core) zapcore.Core {\n        return zapcore.NewCore(enc, ws, conf.Level)\n    })\n}\n\nfunc getWriteSyncer(logName string) zapcore.WriteSyncer {\n    var ioWriter = &amp;lumberjack.Logger{\n        Filename:   logName,\n        MaxSize:    10, // MB\n        MaxBackups: 3,  // number of backups\n        MaxAge:     28, //days\n        LocalTime:  true,\n        Compress:   false, // disabled by default\n    }\n    var sw = WriteSyncer{\n        ioWriter,\n    }\n    return sw\n}\n</code></pre>\n\n<p>I have tried appending the output paths but it is not working.</p>\n"}, {"tags": ["go", "vmware", "vsphere"], "comments": [{"owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "edited": false, "score": 0, "creation_date": 1529438448, "post_id": 50933510, "comment_id": 88870733, "body": "This is not an appropriate question for stackoverflow because it is not about programming. You should ask in a different stackexchange forum."}, {"owner": {"reputation": 1, "user_id": 7865258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0644af4c7754b93ca504fbc6330eaa1b?s=128&d=identicon&r=PG&f=1", "display_name": "HalJ", "link": "https://stackoverflow.com/users/7865258/halj"}, "reply_to_user": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "edited": false, "score": 0, "creation_date": 1529527322, "post_id": 50933510, "comment_id": 88910834, "body": "If I specify asking how to do it using the govmomi Go package is it ok?"}], "owner": {"reputation": 1, "user_id": 7865258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0644af4c7754b93ca504fbc6330eaa1b?s=128&d=identicon&r=PG&f=1", "display_name": "HalJ", "link": "https://stackoverflow.com/users/7865258/halj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529527387, "creation_date": 1529427664, "last_edit_date": 1529527387, "question_id": 50933510, "link": "https://stackoverflow.com/questions/50933510/vsphere-api-to-create-a-vapp-vm-with-sdrs", "title": "vSphere API to create a vApp VM with SDRS", "body": "<p>I'm trying to create a VM within a vApp and use SDRS in Go using the govmomi package, but haven't been able to figure out a way to do it in one step. </p>\n\n<p>Based on the tasks in vCenter (when I do it through the vCenter web client), it seems to be possible. Using the API, if I use SDRS recommendations, I get an error about the resource pool not being valid (because its actually a vApp), but if I use the VM creation process with the vApp, I don't get the SDRS benefits (and can't actually use a datastore cluster at all since a datastore is required). </p>\n\n<p>To work around it, I could either get a recommendation for SDRS and just pull the datastore info out if it instead of applying and then creating the VM through the vApp, or I could create the VM outside of the vApp using SDRS and move it into the vApp afterward, but these both seem hacky.</p>\n\n<p>I'm looking to see if there is a way to do what appears to be happening in vCenter, and avoid one of the hacky workarounds.</p>\n"}, {"tags": ["go", "proxy", "dns"], "comments": [{"owner": {"reputation": 1, "user_id": 9963186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0335703723a2c0540ae5f78ab082902e?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Green", "link": "https://stackoverflow.com/users/9963186/bob-green"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1529426596, "post_id": 50933102, "comment_id": 88865069, "body": "I am trying to use TCP for dns request."}, {"owner": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "edited": false, "score": 2, "creation_date": 1529429786, "post_id": 50933102, "comment_id": 88866611, "body": "It would be simpler to use DNS over TLS or DNS over HTTPS. Various public resolvers offers these. Also when you obfuscate IP addresses please use guidance from RFC5737 instead of whatever you imagine."}, {"owner": {"reputation": 1, "user_id": 9963186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0335703723a2c0540ae5f78ab082902e?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Green", "link": "https://stackoverflow.com/users/9963186/bob-green"}, "reply_to_user": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "edited": false, "score": 0, "creation_date": 1529486779, "post_id": 50933102, "comment_id": 88886818, "body": "@PatrickMevzek, thank you for good idea. The problem resolved."}], "owner": {"reputation": 1, "user_id": 9963186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0335703723a2c0540ae5f78ab082902e?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Green", "link": "https://stackoverflow.com/users/9963186/bob-green"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529427617, "creation_date": 1529426016, "last_edit_date": 1529427617, "question_id": 50933102, "link": "https://stackoverflow.com/questions/50933102/how-to-use-proxy-for-get-dns-records", "title": "How to use proxy for get dns records", "body": "<p>I have some problem.</p>\n\n<p>I need to use proxy for get dns records via 8.8.8.8</p>\n\n<p>But I had some error in my code.</p>\n\n<p>Cannot use &amp;dialer (type *proxy.Dialer) as type *net.Dialer in field value</p>\n\n<p>My code is:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"github.com/miekg/dns\"\n    \"golang.org/x/net/proxy\"\n)\n\nfunc checkErr(err error) {\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n\nfunc main() {\n    dialer, err := proxy.SOCKS5(\"tcp\", \"12.34.56.78:8085\", nil, proxy.Direct)\n    checkErr(err)\n    dnsServer := \"8.8.8.8:53\"\n    c := dns.Client{\n        Net: \"tcp\",\n        Dialer: &amp;dialer,\n    }\n    m := dns.Msg{}\n    m.SetQuestion(\"google.com.\", dns.TypeA)\n    a, _, err := c.Exchange(&amp;m, dnsServer)\n    checkErr(err)\n    for _, ans := range a.Answer {\n        log.Println(ans.(*dns.A).A)\n    }\n}\n</code></pre>\n\n<p>Thanks for any ideas.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "edited": false, "score": 1, "creation_date": 1529426228, "post_id": 50933094, "comment_id": 88864890, "body": "See <a href=\"https://stackoverflow.com/a/28831138/230340\">this answer</a>."}, {"owner": {"reputation": 1353, "user_id": 3250984, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e361b04391eca1bb10b4113dee776479?s=128&d=identicon&r=PG", "display_name": "bordeltabernacle", "link": "https://stackoverflow.com/users/3250984/bordeltabernacle"}, "reply_to_user": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "edited": false, "score": 0, "creation_date": 1529426950, "post_id": 50933094, "comment_id": 88865239, "body": "Thanks. Can&#39;t believe I didn&#39;t find that in my searching."}], "owner": {"reputation": 1353, "user_id": 3250984, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e361b04391eca1bb10b4113dee776479?s=128&d=identicon&r=PG", "display_name": "bordeltabernacle", "link": "https://stackoverflow.com/users/3250984/bordeltabernacle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "closed_date": 1529427802, "answer_count": 0, "score": 0, "last_activity_date": 1529480902, "creation_date": 1529426002, "last_edit_date": 1529480902, "question_id": 50933094, "link": "https://stackoverflow.com/questions/50933094/dynamic-template-names", "closed_reason": "Duplicate", "title": "Dynamic template names", "body": "<p>I'm passing a struct to a nested template and trying to render a different template based on a field in that struct.</p>\n\n<pre><code>func myHandler(w http.ResponseWriter, r *http.Request) {\n\n    allContent := getContent()\n\n    response := []struct {\n        Title   string\n        Content []Content\n        Form    string\n    }{\n        {\"BIG TITLE, allContent.bigContent, \"big_form\"},\n        {\"SMALL TITLE, allContent.smallContent, \"small_form\"},\n    }\n\n    t, err := template.ParseFiles(\"content.html\", \"big_form.html\", \"small_form.html\")\n    if err != nil {\n        log.Printf(\"Failed to parse template: %v\", err)\n    }\n    if err := t.Execute(w, response); err != nil {\n        log.Printf(\"Failed to execute template: %v\", err)\n    }\n}\n</code></pre>\n\n<p>and the template:</p>\n\n<pre><code>{{range .}} {{$form := .Form}}\n&lt;h1 class=\"blocks-header inlined\"&gt;{{.Title}}&lt;/h1&gt;\n{{range .Content}}\n&lt;p&gt;{{.Something}}&lt;/p&gt;\n{{template $form .}}\n{{end}} {{end}}\n</code></pre>\n\n<p>The <code>$form</code> variable renders as a string when used on it's own (<code>&lt;p&gt;{{$form}}&lt;/p&gt;</code>) but when used as the template name I get the error:  <code>unexpected \"$form\" in template clause</code></p>\n\n<p>How can I pass the template name in a way the template clause will understand?</p>\n"}, {"tags": ["go", "go-reflect"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 0, "last_activity_date": 1529425401, "creation_date": 1529425401, "answer_id": 50932945, "question_id": 50932799, "link": "https://stackoverflow.com/questions/50932799/reflect-call-of-reflect-value-field-on-ptr-value/50932945#50932945", "title": "reflect: call of reflect.Value.Field on ptr Value", "body": "<p>The code dereferences the field's type, but not the field's value.  Change</p>\n\n<pre><code>if isPointer(ft.Type) &amp;&amp; !isSimpleType(ft.Type) {\n    processNode(&amp;f, ft.Type.Elem(), val)\n    ...\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>if isPointer(ft.Type) &amp;&amp; !isSimpleType(ft.Type) {\n    fv := f.Elem()\n    processNode(&amp;fv, ft.Type.Elem(), val)\n    ...\n</code></pre>\n"}], "owner": {"reputation": 371, "user_id": 4051774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b982c02454a9d3e76fa62730f6239681?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/4051774/pavel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2134, "favorite_count": 0, "accepted_answer_id": 50932945, "answer_count": 1, "score": 1, "last_activity_date": 1529584091, "creation_date": 1529424819, "last_edit_date": 1529584091, "question_id": 50932799, "link": "https://stackoverflow.com/questions/50932799/reflect-call-of-reflect-value-field-on-ptr-value", "title": "reflect: call of reflect.Value.Field on ptr Value", "body": "<p>Im trying to map map[string]interface{} to structure.\nMy structure contains pointer types:</p>\n\n<pre><code>type A struct{\n  f1 string\n  f2 *B\n}\n\ntype B {\n  f1 string\n  f2 string\n}\n</code></pre>\n\n<p>when I am trying to iterate through *B, I've got: </p>\n\n<pre><code>\"reflect: call of reflect.Value.Field on ptr Value\"\n</code></pre>\n\n<p>val from output is following: </p>\n\n<pre><code>&lt;*B Value&gt;\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>func processNode(v *reflect.Value, t reflect.Type, data interface{}) error {\n        for i := 0; i &lt; t.NumField(); i++ {\n            var f reflect.Value\n\n            if isPointer(v.Type()) {\n                fmt.Printf(\"val: %s\\n\", v)\n                f = v.Field(i)              //Fails here!\n            } else {\n                f = v.Field(i)\n            }\n\n            ft := t.Field(i)\n            m := data.(map[string]interface{})\n\n            val, ok := findFieldValue(m, ft.Name)\n            if ok {\n                if isPointer(ft.Type) &amp;&amp; !isSimpleType(ft.Type) {\n                    processNode(&amp;f, ft.Type.Elem(), val)\n                } else if !isSimpleType(ft.Type) {\n                    processNode(&amp;f, ft.Type, val)\n                } else {\n\n                    err := setTyped(&amp;f, val)\n                    if err != nil {\n                        return err\n                    }\n                }\n            }\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>I wondering, how to iterate through reference value? (iteration works fine on A) </p>\n"}, {"tags": ["docker", "go", "jetbrains-ide", "delve", "goland"], "answers": [{"tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 5, "last_activity_date": 1529422881, "creation_date": 1529422881, "answer_id": 50932255, "question_id": 50931798, "link": "https://stackoverflow.com/questions/50931798/remote-debugging-http-requests-using-go-and-goland-ide/50932255#50932255", "title": "Remote Debugging HTTP requests using Go and GoLand IDE", "body": "<p>This command <code>dlv debug --headless --listen=:2345 --api-version 2 your/package/name</code> allows delve to compile the package then launch itself and the compiled binary.</p>\n\n<p>On the other hand, these commands\n<code>\ngo build -gcflags='-N -l' github.com/myproject\ndlv --listen=:2345 --headless=true --api version=2 exec ./myproject\n</code>\nshow you that you can compile the binary separately, in case you need more flexibility and then launch the debugger. Keep in mind that it's really important to add <code>-gcflags='-N -l'</code> or <code>-gcflags='all=-N -l'</code>, depending on which Go version you have, in order for the debugger to be able to have more data available about your application.</p>\n\n<p>As for the:</p>\n\n<blockquote>\n  <p>Is there a way for me to attach to my project once it's running on localhost:8080? How will these commands differ if that is the case?</p>\n</blockquote>\n\n<p>It depends on where you are running the process. If it's on your machine directly, without a VM or a container, then the IDE has the option in <code>Run|Attach to Process</code>. If the process is running on a different machine then you need to login into that machine and use <code>dlv --headless --listen=:2345 --api-version 2 attach &lt;pid&gt;</code>.</p>\n\n<p>We published <a href=\"https://blog.jetbrains.com/go/2018/04/30/debugging-containerized-go-applications/\" rel=\"noreferrer\">an article</a> dedicated to this problem a couple of months ago, please have a look at it for a more detailed reply.</p>\n"}], "owner": {"reputation": 5979, "user_id": 1009669, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef0d4c06ad2d9ae5fdfdc934f7d49e4f?s=128&d=identicon&r=PG&f=1", "display_name": "BigBug", "link": "https://stackoverflow.com/users/1009669/bigbug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 938, "favorite_count": 0, "accepted_answer_id": 50932255, "answer_count": 1, "score": 1, "last_activity_date": 1529422881, "creation_date": 1529421388, "question_id": 50931798, "link": "https://stackoverflow.com/questions/50931798/remote-debugging-http-requests-using-go-and-goland-ide", "title": "Remote Debugging HTTP requests using Go and GoLand IDE", "body": "<p>I am new to go, delve and GoLand IDE. I would like to remote debug some REST endpoints that are deployed using <code>make</code> and run in a docker (using docker + docker-compose). </p>\n\n<p>The command I use to bring up my environment is <code>make myproject</code></p>\n\n<p>My endpoints get hosted at: <code>localhost:8080</code></p>\n\n<p>When creating a debug configuration in GoLand it specifies that before running\n<code>dlv debug --headless --listen=:2345 --api-version 2</code>, do the following: </p>\n\n<pre><code>go build -gcflags='-N -l' github.com/myproject\ndlv --listen=:2345 --headless=true --api version=2 exec ./myproject\n</code></pre>\n\n<p>Is there a way for me to attach to my project once it's running on localhost:8080? How will these commands differ if that is the case? </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["windows", "go"], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 2, "last_activity_date": 1529426183, "last_edit_date": 1529426183, "creation_date": 1529425849, "answer_id": 50933057, "question_id": 50931294, "link": "https://stackoverflow.com/questions/50931294/logged-in-user-windows-in-golang/50933057#50933057", "title": "Logged in user, Windows, in Golang", "body": "<p>As usually with such kind of questions,\nthe solution is to proceed like this:</p>\n\n<ol>\n<li>Research (using MSDN and other sources) on how to achieve the\nstated goal using Win32 API.</li>\n<li>Use the built-in <code>syscall</code> package (or, if available/desirable,\nhelper 3rd-party packages) to make those calls from Go.</li>\n</ol>\n\n<p>The first step can be <a href=\"https://www.google.com/search?q=msdn+enumerate+login+sessions\" rel=\"nofollow noreferrer\">this</a>\nwhich yields <a href=\"https://stackoverflow.com/a/14326359/720999\">the solution</a>\nwhich basically is \"use WTS\".</p>\n\n<p>The way to go is to</p>\n\n<ol>\n<li>Connect to the WTS subsystem\u00b9.</li>\n<li>Enumerate the currently active sessions.</li>\n<li>Query each one for the information about the\nidentity of the user associated with it.</li>\n</ol>\n\n<p>The second step is trickier but basically you'd need to research\nhow others do that.\nSee <a href=\"https://github.com/alexbrainman/odbc/blob/master/api/zapi_windows.go\" rel=\"nofollow noreferrer\">this</a>\nand <a href=\"https://github.com/go-ole/go-ole\" rel=\"nofollow noreferrer\">this</a>\nand <a href=\"https://github.com/StackExchange/wmi\" rel=\"nofollow noreferrer\">this</a> for a few examples.</p>\n\n<p>You might also look at files named <code>_windows*.go</code> in\n<a href=\"https://github.com/golang/go/tree/master/src/syscall\" rel=\"nofollow noreferrer\">the Go source of the <code>syscall</code> package</a>.</p>\n\n<hr>\n\n<p>\u00b9 Note that even on a single-user machine, everything\nrelated to seat/session management comes through WTS\n(however castrated it is depending on a particular flavor of Windows). This is true since at least XP/W2k3.</p>\n"}], "owner": {"reputation": 178, "user_id": 3165353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e092a82487f028c427a76e8f4712279f?s=128&d=identicon&r=PG&f=1", "display_name": "bcvery1", "link": "https://stackoverflow.com/users/3165353/bcvery1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1019, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1606311606, "creation_date": 1529419805, "question_id": 50931294, "link": "https://stackoverflow.com/questions/50931294/logged-in-user-windows-in-golang", "title": "Logged in user, Windows, in Golang", "body": "<p>I need to get the currently logged in user(s) on the local Windows machine, using Golang.  I'm not looking for the user currently running the application, which can be got from the built-in function <code>user.Current()</code>.</p>\n\n<p>I can call <code>query user</code> from cmd and this gives me the list (string manipulation required, but that is not a problem) of users I need.</p>\n\n<p>The code I have tried is:</p>\n\n<pre><code>out, err := exec.Command(\"query\", \"user\")\nif err != nil {\n  panic(err)\n}\n// ...do something with 'out'\n</code></pre>\n\n<p>This produces the error <code>panic: exit status 1</code>.  The same occurs if I do:</p>\n\n<pre><code>out, err := exec.Command(\"cmd\", \"/C\", \"query\", \"user\")\n...\n</code></pre>\n"}, {"tags": ["json", "pointers", "go"], "comments": [{"owner": {"reputation": 8219, "user_id": 135605, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7c56ff86a79852b167d84b3838756fba?s=128&d=identicon&r=PG", "display_name": "somejkuser", "link": "https://stackoverflow.com/users/135605/somejkuser"}, "edited": false, "score": 0, "creation_date": 1529426196, "post_id": 50931181, "comment_id": 88864875, "body": "Not sure what the issue is here with the downvotes"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1529428949, "post_id": 50931181, "comment_id": 88866193, "body": "You seem to be asking a lot of basic questions about the language. You might want to go through the <a href=\"https://tour.golang.org/\" rel=\"nofollow noreferrer\">Tour of Go</a>, which coincidentally has a section demonstrating how to use pointers."}, {"owner": {"reputation": 8219, "user_id": 135605, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7c56ff86a79852b167d84b3838756fba?s=128&d=identicon&r=PG", "display_name": "somejkuser", "link": "https://stackoverflow.com/users/135605/somejkuser"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1529429403, "post_id": 50931181, "comment_id": 88866437, "body": "Ok Ill read throguh that first."}], "answers": [{"comments": [{"owner": {"reputation": 8219, "user_id": 135605, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7c56ff86a79852b167d84b3838756fba?s=128&d=identicon&r=PG", "display_name": "somejkuser", "link": "https://stackoverflow.com/users/135605/somejkuser"}, "edited": false, "score": 0, "creation_date": 1529419710, "post_id": 50931220, "comment_id": 88861384, "body": "cannot use strValue (type *string) as type string in argument to strings.NewReader"}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 1, "last_activity_date": 1529429562, "last_edit_date": 1529429562, "creation_date": 1529419580, "answer_id": 50931220, "question_id": 50931181, "link": "https://stackoverflow.com/questions/50931181/convert-pointer-to-its-primary-value-in-json-decoder/50931220#50931220", "title": "Convert pointer to its primary value in json decoder", "body": "<p>Dereference the pointer to get the value of <code>string</code> from <code>*string</code> and then use it in <code>strings.NewReader</code> function. For eg:-</p>\n\n<pre><code>strValue := *m.Body\ndec := json.NewDecoder(strings.NewReader(strValue))\n</code></pre>\n\n<p>For working example check <a href=\"https://play.golang.org/p/4JIFa5oQxvx\" rel=\"nofollow noreferrer\">Go playground</a></p>\n"}], "owner": {"reputation": 8219, "user_id": 135605, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7c56ff86a79852b167d84b3838756fba?s=128&d=identicon&r=PG", "display_name": "somejkuser", "link": "https://stackoverflow.com/users/135605/somejkuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 50931220, "answer_count": 1, "score": -3, "last_activity_date": 1529429562, "creation_date": 1529419421, "last_edit_date": 1529426362, "question_id": 50931181, "link": "https://stackoverflow.com/questions/50931181/convert-pointer-to-its-primary-value-in-json-decoder", "title": "Convert pointer to its primary value in json decoder", "body": "<p>How can I convert <code>*string</code> to <code>string</code>?</p>\n\n<p>Heres my error code:</p>\n\n<blockquote>\n  <p>cannot use m.Body (type *string) as type string in argument to\n  strings.NewReader</p>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre><code>dec := json.NewDecoder(strings.NewReader(m.Body))\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 9279, "user_id": 6440033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f070f5eb58ce80fa0b975a805e712362?s=128&d=identicon&r=PG&f=1", "display_name": "dnickless", "link": "https://stackoverflow.com/users/6440033/dnickless"}, "edited": false, "score": 0, "creation_date": 1529419714, "post_id": 50930906, "comment_id": 88861386, "body": "If you are using MongoDB v3.6 you can move the match stages into the <code>pipeline</code> array that the $lookup operator supports. This should allow MongoDB to use its indexes."}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "reply_to_user": {"reputation": 9279, "user_id": 6440033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f070f5eb58ce80fa0b975a805e712362?s=128&d=identicon&r=PG&f=1", "display_name": "dnickless", "link": "https://stackoverflow.com/users/6440033/dnickless"}, "edited": false, "score": 0, "creation_date": 1529420123, "post_id": 50930906, "comment_id": 88861667, "body": "@dnickless : I added the version. I am using <b>v3.4.6</b>. But as it is with Docker, I could update... But I do not see the improvement you mention. Thanks a lot."}], "answers": [{"comments": [{"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1529424595, "post_id": 50931851, "comment_id": 88864125, "body": "Thanks for your help ! To be honest, I do not really know how to &quot;translate&quot; it in MGO/Golang syntax, it is a heavy stuff"}, {"owner": {"reputation": 9279, "user_id": 6440033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f070f5eb58ce80fa0b975a805e712362?s=128&d=identicon&r=PG&f=1", "display_name": "dnickless", "link": "https://stackoverflow.com/users/6440033/dnickless"}, "reply_to_user": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1529469376, "post_id": 50931851, "comment_id": 88878388, "body": "This might help. I&#39;ll give it a go - pun intended - later, too. <a href=\"https://stackoverflow.com/questions/42833731/golang-mongodb-aggregation\" title=\"golang mongodb aggregation\">stackoverflow.com/questions/42833731/golang-mongodb-aggregat&zwnj;&#8203;ion</a>"}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1529485288, "post_id": 50931851, "comment_id": 88885845, "body": "Thanks a lot ! I will test it but as far as I can see, it is the solution I need"}, {"owner": {"reputation": 9279, "user_id": 6440033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f070f5eb58ce80fa0b975a805e712362?s=128&d=identicon&r=PG&f=1", "display_name": "dnickless", "link": "https://stackoverflow.com/users/6440033/dnickless"}, "reply_to_user": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1529486292, "post_id": 50931851, "comment_id": 88886486, "body": "You&#39;re welcome. I would be interested in the results."}], "tags": [], "owner": {"reputation": 9279, "user_id": 6440033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f070f5eb58ce80fa0b975a805e712362?s=128&d=identicon&r=PG&f=1", "display_name": "dnickless", "link": "https://stackoverflow.com/users/6440033/dnickless"}, "is_accepted": true, "score": 0, "last_activity_date": 1529473184, "last_edit_date": 1529473184, "creation_date": 1529421567, "answer_id": 50931851, "question_id": 50930906, "link": "https://stackoverflow.com/questions/50930906/slow-request-with-lookup-and-unwind-in-golang-and-mongodb/50931851#50931851", "title": "Slow request with $lookup and $unwind in Golang and MongoDB", "body": "<p>This is roughly what I'm thinking should help. It's untested since I have no sample data. Plus its Go syntax might be a little wonky since I don't know Go. ;) However, I am relatively sure that the <code>$match</code> statements inside the <code>$lookup</code> <code>pipeline</code>s will leverage the available indexes whereas in your query you have the <code>$unwind</code>s before the <code>$match</code>es which effectively render the indexes useless.</p>\n\n<pre><code>pipe := session.DB(shared.DatabaseNamespace).C(\"events\").Pipe([]bson.M{\n    {\n        \"$lookup\": bson.M{\n            \"from\": \"event_boosts\",\n            \"let\": bson.M{ \"e_id\": \"$_id\" },\n            \"pipeline\": []bson.M{\n                \"$match\": bson.M{\n                    \"$expr\": bson.M{\n                       \"$and\": []interface{}{\n                            bson.M{ \"$eq\": []string{ \"$_event_id\", \"$$e_id\" } },\n                            bson.M{ \"$eq\": []string{ \"$is_published\", true } }, // Boost is active\n                            bson.M{ \"$lt\": []string{ \"$start_date\", now } }, // now is between start and end\n                            bson.M{ \"$gt\": []string{ \"$end_date\", now } },  // now is between start and end\n                        },\n                    },\n                },\n            },\n            \"as\": \"boost\",\n        },\n    },\n    { \"$unwind\": \"$boost\" },\n    {\n        \"$lookup\": bson.M{\n            \"from\":         \"campaigns\",\n            \"let\": bson.M{ \"c_id\": \"$boost._campaign_id\" },\n            \"pipeline\": []bson.M{\n                \"$match\": bson.M{\n                    \"$expr\": bson.M{\n                       \"$and\": []interface{}{\n                            bson.M{ \"$eq\": []string{ \"$id\", \"$$c_id\" } },\n                            bson.M{ \"$eq\": []string{ \"$is_published\", true } }, // Attached campaign is active\n                        },\n                    },\n                },\n            },\n            \"as\": \"campaign\",\n        },\n    },\n    { \"$unwind\": \"$campaign\" },\n})\n</code></pre>\n"}], "owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 695, "favorite_count": 1, "accepted_answer_id": 50931851, "answer_count": 1, "score": 0, "last_activity_date": 1529473184, "creation_date": 1529418631, "last_edit_date": 1529420058, "question_id": 50930906, "link": "https://stackoverflow.com/questions/50930906/slow-request-with-lookup-and-unwind-in-golang-and-mongodb", "title": "Slow request with $lookup and $unwind in Golang and MongoDB", "body": "<p>My model : An <strong>Event</strong> can be boosted by a <strong>Campaign</strong> that has one or multiple <strong>Boost</strong>.</p>\n\n<p>I am trying to get all the <strong>Event</strong> that are <em>boosted</em> with this request below.</p>\n\n<pre><code>// Boosted ...\nfunc (dao *campaignDAO) Boosted() ([]*models.Event, error) {\n    // Clone the session\n    session := dao.session.Clone()\n    defer session.Close()\n\n    // Get the time\n    now := time.Now()\n\n    // Create the pipe\n    pipe := session.DB(shared.DatabaseNamespace).C(\"events\").Pipe([]bson.M{\n        {\n            \"$lookup\": bson.M{\n                \"from\":         \"event_boosts\",\n                \"localField\":   \"_id\",\n                \"foreignField\": \"_event_id\",\n                \"as\":           \"boost\",\n            },\n        },\n        {\"$unwind\": \"$boost\"},\n        {\n            \"$match\": bson.M{\n                \"boost.is_published\": true,               // Boost is active\n                \"boost.start_date\":   bson.M{\"$lt\": now}, // now is between start and end\n                \"boost.end_date\":     bson.M{\"$gt\": now}, // now is between start and end\n            },\n        },\n        {\n            \"$lookup\": bson.M{\n                \"from\":         \"campaigns\",\n                \"localField\":   \"boost._campaign_id\",\n                \"foreignField\": \"_id\",\n                \"as\":           \"campaign\",\n            },\n        },\n        {\"$unwind\": \"$campaign\"},\n        {\n            \"$match\": bson.M{\n                \"campaign.is_published\": true, // Attached campaign is active\n            },\n        },\n    })\n\n    var result []*models.Event\n    err := pipe.All(&amp;result)\n    if err != nil {\n        return nil, err\n    }\n\n    return result, nil\n}\n</code></pre>\n\n<p>But this request takes 3 seconds.\nHere are the indexes I have in the campaigns :</p>\n\n<pre><code>// NewCampaignDAO returns a new CampaignDAO\nfunc NewCampaignDAO(session *mgo.Session) dao.CampaignDAO {\n    // Set the collection\n    col := session.DB(shared.DatabaseNamespace).C(\"campaigns\")\n\n    // Set the indexes\n    col.EnsureIndexKey(\"start_date\")\n    col.EnsureIndexKey(\"end_date\")\n    col.EnsureIndexKey(\"created_by\")\n    col.EnsureIndexKey(\"is_published\")\n\n    return &amp;campaignDAO{\n        session:    session,\n        collection: \"campaigns\",\n    }\n}\n</code></pre>\n\n<p>The indexes on the events :</p>\n\n<pre><code>// NewEventDAO returns a new EventDAO\nfunc NewEventDAO(session *mgo.Session) dao.EventDAO {\n    // Set the collection\n    col := session.DB(shared.DatabaseNamespace).C(\"events\")\n\n    // Set the indexes\n    col.EnsureIndexKey(\"old_id\")\n    col.EnsureIndexKey(\"_parent_id\")\n    col.EnsureIndexKey(\"_location_id\")\n    col.EnsureIndexKey(\"price\")\n    col.EnsureIndexKey(\"name\")\n    col.EnsureIndexKey(\"category\")\n    col.EnsureIndexKey(\"start_date\")\n    col.EnsureIndexKey(\"end_date\")\n    col.EnsureIndexKey(\"is_recurrent\")\n    col.EnsureIndexKey(\"is_published\")\n    col.EnsureIndexKey(\"is_proposed\")\n    col.EnsureIndexKey(\"tags\")\n    col.EnsureIndexKey(\"price\", \"date\", \"name\")\n\n    return &amp;eventDAO{\n        session:    session,\n        collection: \"events\",\n    }\n}\n</code></pre>\n\n<p>And the logs of the MongoDB :</p>\n\n<pre><code>2018-06-19T13:22:53.465+0000 I COMMAND  [conn506] command clutch.event_boosts command: aggregate { aggregate: \"events\", pipeline: [ { $lookup: { as: \"boost\", from: \"event_boosts\", localField: \"_id\", foreignField: \"_event_id\" } }, { $unwind: \"$boost\" }, { $match: { boost.is_published: true, boost.start_date: { $lt: new Date(1529414570196) }, boost.end_date: { $gt: new Date(1529414570196) } } }, { $lookup: { from: \"campaigns\", localField: \"boost._campaign_id\", foreignField: \"_id\", as: \"campaign\" } }, { $unwind: \"$campaign\" }, { $match: { campaign.is_published: true } } ], cursor: {} } planSummary: COLLSCAN keysExamined:0 docsExamined:12936 cursorExhausted:1 numYields:121 nreturned:1 reslen:1149 locks:{ Global: { acquireCount: { r: 52018 } }, Database: { acquireCount: { r: 26009 } }, Collection: { acquireCount: { r: 26008 } } } protocol:op_query 3268ms\n</code></pre>\n\n<p>I do not get where I could improve.</p>\n\n<p>EDIT : Also, I an wondering if I could improve the request by starting the request on the <strong>event_boosts</strong> collection, and then lookup in Events.</p>\n\n<p>EDIT2 : Adding the Mongo version.</p>\n\n<pre><code>MongoDB shell version v3.4.6\ngit version: c55eb86ef46ee7aede3b1e2a5d184a7df4bfb5b5\nOpenSSL version: OpenSSL 1.0.1t  3 May 2016\nallocator: tcmalloc\nmodules: none\nbuild environment:\n    distmod: debian81\n    distarch: x86_64\n    target_arch: x86_64\n</code></pre>\n"}, {"tags": ["file", "go", "zip"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 2, "creation_date": 1529416570, "post_id": 50930189, "comment_id": 88859318, "body": "Once <code>r.Close</code> is called, any of the <code>*zip.File</code> structs are invalid. You need to either  (a) keep <code>r</code> open as long as you want to read the ZIP entries, or (b) make an in-memory/temporary file copy of all of the zip file contents."}, {"owner": {"reputation": 56, "user_id": 9577873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/924d654746cca73ca231a4f2e2dcb0dc?s=128&d=identicon&r=PG&f=1", "display_name": "Prostoi Chelovek", "link": "https://stackoverflow.com/users/9577873/prostoi-chelovek"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1529417594, "post_id": 50930189, "comment_id": 88860007, "body": "Thanks! Please write that as a answer. @TimCooper"}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1529418182, "creation_date": 1529418182, "answer_id": 50930765, "question_id": 50930189, "link": "https://stackoverflow.com/questions/50930189/archive-zip-read-file-zip-bad-file-descriptor/50930765#50930765", "title": "Archive/zip read file.zip: bad file descriptor", "body": "<p>Once <a href=\"https://golang.org/pkg/archive/zip/#ReadCloser.Close\" rel=\"nofollow noreferrer\"><code>ReadCloser.Close</code></a> is called, any of the <code>*zip.File</code> structs are invalid:</p>\n\n<blockquote>\n  <p>Close closes the Zip file, rendering it unusable for I/O.</p>\n</blockquote>\n\n<p>You need to either:</p>\n\n<ol>\n<li>Keep <code>r</code> open as long as you want to read the ZIP entries, or</li>\n<li>make an in-memory/temporary file copy of all of the zip file contents</li>\n</ol>\n\n<p>An example of the latter option:</p>\n\n<pre><code>func ReadZip(file string) (map[string][]byte, error) {\n    r, err := zip.OpenReader(file)\n    if err != nil {\n        return nil, err\n    }\n    defer r.Close()\n    files := make(map[string][]byte)\n    for _, f := range r.File {\n        fc, err := f.Open()\n        if err != nil {\n            return nil, err\n        }\n        contents, err := ioutil.ReadAll(fc)\n        fc.Close()\n        if err != nil {\n            return nil, err\n        }\n        files[f.Name] = contents\n    }\n    return files, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 56, "user_id": 9577873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/924d654746cca73ca231a4f2e2dcb0dc?s=128&d=identicon&r=PG&f=1", "display_name": "Prostoi Chelovek", "link": "https://stackoverflow.com/users/9577873/prostoi-chelovek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 562, "favorite_count": 0, "accepted_answer_id": 50930765, "answer_count": 1, "score": 0, "last_activity_date": 1529418182, "creation_date": 1529416373, "last_edit_date": 1529416871, "question_id": 50930189, "link": "https://stackoverflow.com/questions/50930189/archive-zip-read-file-zip-bad-file-descriptor", "title": "Archive/zip read file.zip: bad file descriptor", "body": "<p>I have written a function to read zip archive to<code>map[string]*zip.File</code>.</p>\n\n<pre><code>func ReadZip(file string) (map[string]*zip.File, error) {\n    r, err := zip.OpenReader(file)\n    if err != nil {\n        return nil, err\n    }\n    defer r.Close()\n    files := make(map[string]*zip.File)\n    for _, f := range r.File {\n        files[f.Name] = f\n    }\n    return files, nil\n}\n</code></pre>\n\n<p>But when i try to open file <code>infoRC, err := f[\"info.json\"].Open()</code> arises error </p>\n\n<blockquote>\n  <p>read file.zip: bad file descriptor.</p>\n</blockquote>\n\n<p>Is there better way to read zip archive?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "is_accepted": false, "score": 1, "last_activity_date": 1529405397, "creation_date": 1529405397, "answer_id": 50926582, "question_id": 50926546, "link": "https://stackoverflow.com/questions/50926546/get-missing-imports-in-batches/50926582#50926582", "title": "Get missing imports in batches", "body": "<p>try using <code>go get ./...</code> in root of your project</p>\n"}, {"comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 3, "creation_date": 1529407832, "post_id": 50926798, "comment_id": 88853604, "body": "To clarify: <code>go get github.com&#47;somebody&#47;somepackage</code> will get a package <b>and</b> its dependencies, but only of that package. If there are sub-packages that have dependencies that are not imported by <code>somepackage</code>, that&#39;s where <code>somepackage&#47;...</code> is required."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1529408496, "post_id": 50926798, "comment_id": 88853968, "body": "@TimCooper You&#39;re right, thanks, it wasn&#39;t very clear. Edited."}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 0, "creation_date": 1529417399, "post_id": 50926798, "comment_id": 88859882, "body": "This is a good explanation of go get command but op should check for dependency management first, I believe &#39;go get&#39; just pulls master for everything which may not be what the author intended"}, {"owner": {"reputation": 43, "user_id": 5925384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3946738c46ef4bd7a46c13cba913c4e1?s=128&d=identicon&r=PG&f=1", "display_name": "lujiwen", "link": "https://stackoverflow.com/users/5925384/lujiwen"}, "edited": false, "score": 0, "creation_date": 1529420085, "post_id": 50926798, "comment_id": 88861628, "body": "Thank you so much ! @icza"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1529412892, "last_edit_date": 1529412892, "creation_date": 1529406033, "answer_id": 50926798, "question_id": 50926546, "link": "https://stackoverflow.com/questions/50926546/get-missing-imports-in-batches/50926798#50926798", "title": "Get missing imports in batches", "body": "<p>You should use <code>go get</code> to get \"remote\" packages. Quoting from <a href=\"https://golang.org/cmd/go/#hdr-Download_and_install_packages_and_dependencies\" rel=\"nofollow noreferrer\">Command go: Download and install packages and dependencies</a></p>\n\n<blockquote>\n  <p>Get downloads the packages named by the import paths, along with their dependencies. It then installs the named packages, like 'go install'.</p>\n</blockquote>\n\n<p>You may use the <code>-v</code> flag in all of the following commands, and so you will see what <code>go get</code> is doing under the hood.</p>\n\n<p>You may use the <code>-d</code> flag if you just want to download the packages but you do not want to install them.</p>\n\n<p>The examples use the example remote package <code>github.com/somebody/somepackage</code>, but obviously it works for other packages hosted outside of github.com.</p>\n\n<p>For more information, see the official doc: <a href=\"https://golang.org/cmd/go/\" rel=\"nofollow noreferrer\">Command go</a>, or type <code>go help get</code>.</p>\n\n<hr>\n\n<p>To get a single package with all the dependencies of that package and install them, use </p>\n\n<pre><code>go get github.com/somebody/somepackage\n</code></pre>\n\n<p>To get a package with all its dependencies, and all other packages rooted at that path (along with their dependencies), and install all of them, use:</p>\n\n<pre><code>go get github.com/somebody/somepackage/...\n</code></pre>\n\n<p>Quoting from Command go:</p>\n\n<blockquote>\n  <p>An import path is a pattern if it includes one or more \"...\" wildcards, each of which can match any string, including the empty string and strings containing slashes. Such a pattern expands to all package directories found in the GOPATH trees with names matching the patterns.</p>\n</blockquote>\n\n<p>To get a package with all its dependencies (and \"subpackages\") <strong>including dependencies of tests</strong>, and install all of them, use:</p>\n\n<pre><code>go get -t github.com/somebody/somepackage/...\n</code></pre>\n\n<p>To update a package you already have, use:</p>\n\n<pre><code>go get -u github.com/somebody/somepackage/...\n</code></pre>\n\n<p>To fetch dependencies of a package you already have (which is not necessarily from a remote location):</p>\n\n<pre><code>go get path/to/package/name/...\n</code></pre>\n\n<p>Or go to its folder and then you may use a relative path:</p>\n\n<pre><code>go get ./...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "is_accepted": true, "score": 1, "last_activity_date": 1529416913, "creation_date": 1529416913, "answer_id": 50930367, "question_id": 50926546, "link": "https://stackoverflow.com/questions/50926546/get-missing-imports-in-batches/50930367#50930367", "title": "Get missing imports in batches", "body": "<p>A lot of golang projects now use dependency management so you should look for that first. e.g a Glide.lock (glide) or Gopkg.lock (dep - the way people are moving now) file present in the root of the project.</p>\n\n<p><a href=\"https://github.com/golang/dep\" rel=\"nofollow noreferrer\">https://github.com/golang/dep</a></p>\n\n<p><a href=\"https://golang.github.io/dep\" rel=\"nofollow noreferrer\">https://golang.github.io/dep</a></p>\n\n<p>if dep is used and you have it installed then <code>dep ensure</code> will set the dependencies up for you and make sure you get the versions the author intended</p>\n\n<p>if a project is not using dependency management you can just get the packages with  <code>go get ./...</code> but I don't think you will be guaranteed the correct versions (e.g if the author was pinned to a version tag for a dep)</p>\n\n<p>If you run <code>dep init</code> it sets up dep on a project and will attempt to resolve the correct versions, however this doesnt always work if the stars dont align (e.g I have seen issues with dependencies using gopkg.in)</p>\n"}], "owner": {"reputation": 43, "user_id": 5925384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3946738c46ef4bd7a46c13cba913c4e1?s=128&d=identicon&r=PG&f=1", "display_name": "lujiwen", "link": "https://stackoverflow.com/users/5925384/lujiwen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 1, "accepted_answer_id": 50930367, "answer_count": 3, "score": 1, "last_activity_date": 1529480923, "creation_date": 1529405258, "last_edit_date": 1529480923, "question_id": 50926546, "link": "https://stackoverflow.com/questions/50926546/get-missing-imports-in-batches", "title": "Get missing imports in batches", "body": "<p>When I clone a project written in golang, it is normal that a lot of imports like \n'github.com/XXXX' are missing. Is there any way to get these imports in batches by a command? or I am suppose to get them one by one.</p>\n"}, {"tags": ["go", "interface", "type-conversion", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1529420096, "post_id": 50925632, "comment_id": 88861635, "body": "Also read in the Go FAQ: <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">golang.org/doc/faq#convert_slice_of_interface</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": true, "score": 0, "last_activity_date": 1529412090, "creation_date": 1529412090, "answer_id": 50928735, "question_id": 50925632, "link": "https://stackoverflow.com/questions/50925632/interface-conversion-in-slice-of-slice/50928735#50928735", "title": "Interface conversion in slice of slice", "body": "<p>No, ultimately you'll have to loop over the two slices!</p>\n\n<p>You can read here why you can't just use one as the other:</p>\n\n<p><a href=\"https://research.swtch.com/interfaces\" rel=\"nofollow noreferrer\">https://research.swtch.com/interfaces</a></p>\n\n<p>This answer might also be useful:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/44319906/why-golang-struct-array-cannot-be-assigned-to-an-interface-array/44323999#44323999\">Why golang struct array cannot be assigned to an interface array</a></p>\n\n<p>Essentially it's because the interface is stored as a 2 word pair, one defining the type and one the values.</p>\n\n<p>You have to manually convert to the required type by visiting all the values in for-range loops.</p>\n"}], "owner": {"reputation": 13, "user_id": 8856025, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Zk-kMALgW9s/AAAAAAAAAAI/AAAAAAAABHk/dFDj9nP0gFU/photo.jpg?sz=128", "display_name": "Agostino", "link": "https://stackoverflow.com/users/8856025/agostino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 50928735, "answer_count": 1, "score": -1, "last_activity_date": 1529412090, "creation_date": 1529402510, "last_edit_date": 1529409907, "question_id": 50925632, "link": "https://stackoverflow.com/questions/50925632/interface-conversion-in-slice-of-slice", "title": "Interface conversion in slice of slice", "body": "<p>I wrote this example code (<a href=\"https://play.golang.org/p/u_oz5X4aU07\" rel=\"nofollow noreferrer\">https://play.golang.org/p/u_oz5X4aU07</a>):</p>\n\n<pre><code>func main() {\n    var obj interface{}\n    json.Unmarshal([]byte(\"[[1,2],[3,4]]\"), &amp;obj)\n    val := obj.([][]int)\n    fmt.Println(val)\n}\n</code></pre>\n\n<p>Why I get the error:</p>\n\n<blockquote>\n  <p>interface conversion: interface {} is []interface {}, not [][]int</p>\n</blockquote>\n\n<p>Is there a simple way to transform obj in a slice of slice?</p>\n\n<p>This code works, but I'd like something more compact and efficient.</p>\n\n<pre><code>    var val [][]float64\n    for r, v := range obj.([]interface{}) {\n        val = append(val,nil)\n        for _, w := range v.([]interface{}) {\n            val[r] = append(val[r], w.(float64))\n        }\n    }\n</code></pre>\n"}, {"tags": ["go", "redis"], "comments": [{"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1529401096, "post_id": 50925048, "comment_id": 88849382, "body": "with <code>json.Unmarshal</code>"}, {"owner": {"reputation": 418, "user_id": 6545189, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-MV4nmggkVbw/AAAAAAAAAAI/AAAAAAAADc4/nKkbVL-rg9g/photo.jpg?sz=128", "display_name": "sudharsan tk", "link": "https://stackoverflow.com/users/6545189/sudharsan-tk"}, "reply_to_user": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1529401200, "post_id": 50925048, "comment_id": 88849455, "body": "It throws invalid character 0 if I used json.Unmarshal(v, &amp;t) where v is as stated above  t is of type Person"}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1529402189, "post_id": 50925048, "comment_id": 88850094, "body": "can you printout Person ?"}, {"owner": {"reputation": 418, "user_id": 6545189, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-MV4nmggkVbw/AAAAAAAAAAI/AAAAAAAADc4/nKkbVL-rg9g/photo.jpg?sz=128", "display_name": "sudharsan tk", "link": "https://stackoverflow.com/users/6545189/sudharsan-tk"}, "reply_to_user": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1529402217, "post_id": 50925048, "comment_id": 88850110, "body": "Yes its succesfully prints the data for eg"}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1529402251, "post_id": 50925048, "comment_id": 88850135, "body": "i meant write person struct here :))"}, {"owner": {"reputation": 418, "user_id": 6545189, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-MV4nmggkVbw/AAAAAAAAAAI/AAAAAAAADc4/nKkbVL-rg9g/photo.jpg?sz=128", "display_name": "sudharsan tk", "link": "https://stackoverflow.com/users/6545189/sudharsan-tk"}, "reply_to_user": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1529402501, "post_id": 50925048, "comment_id": 88850285, "body": "I Updated the code  in the question section could you check?"}, {"owner": {"reputation": 7374, "user_id": 593425, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ad54f71e8e63bf711680cf8f5f1e53c1?s=128&d=identicon&r=PG", "display_name": "Guy Korland", "link": "https://stackoverflow.com/users/593425/guy-korland"}, "edited": false, "score": 0, "creation_date": 1529425947, "post_id": 50925048, "comment_id": 88864759, "body": "Did you consider using rejson module? <a href=\"https://oss.redislabs.com/rejson/\" rel=\"nofollow noreferrer\">oss.redislabs.com/rejson</a>"}], "answers": [{"comments": [{"owner": {"reputation": 418, "user_id": 6545189, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-MV4nmggkVbw/AAAAAAAAAAI/AAAAAAAADc4/nKkbVL-rg9g/photo.jpg?sz=128", "display_name": "sudharsan tk", "link": "https://stackoverflow.com/users/6545189/sudharsan-tk"}, "edited": false, "score": 0, "creation_date": 1529403634, "post_id": 50925761, "comment_id": 88851040, "body": "Actually I want to avoid marshalling the struct ,because I have like 10000 records, and when i tried marshalling(using json) it was taking more time.so i tried to AddFlat and directly whole map to redis"}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "reply_to_user": {"reputation": 418, "user_id": 6545189, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-MV4nmggkVbw/AAAAAAAAAAI/AAAAAAAADc4/nKkbVL-rg9g/photo.jpg?sz=128", "display_name": "sudharsan tk", "link": "https://stackoverflow.com/users/6545189/sudharsan-tk"}, "edited": false, "score": 0, "creation_date": 1529404141, "post_id": 50925761, "comment_id": 88851367, "body": "does your person fields contain struct tags ?"}, {"owner": {"reputation": 418, "user_id": 6545189, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-MV4nmggkVbw/AAAAAAAAAAI/AAAAAAAADc4/nKkbVL-rg9g/photo.jpg?sz=128", "display_name": "sudharsan tk", "link": "https://stackoverflow.com/users/6545189/sudharsan-tk"}, "edited": false, "score": 0, "creation_date": 1529405314, "post_id": 50925761, "comment_id": 88852106, "body": "Nope , let me try with tags. But how can still Marshall it if I have tags"}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "reply_to_user": {"reputation": 418, "user_id": 6545189, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-MV4nmggkVbw/AAAAAAAAAAI/AAAAAAAADc4/nKkbVL-rg9g/photo.jpg?sz=128", "display_name": "sudharsan tk", "link": "https://stackoverflow.com/users/6545189/sudharsan-tk"}, "edited": false, "score": 0, "creation_date": 1529405350, "post_id": 50925761, "comment_id": 88852127, "body": "wouldnt give you zero if it does"}, {"owner": {"reputation": 418, "user_id": 6545189, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-MV4nmggkVbw/AAAAAAAAAAI/AAAAAAAADc4/nKkbVL-rg9g/photo.jpg?sz=128", "display_name": "sudharsan tk", "link": "https://stackoverflow.com/users/6545189/sudharsan-tk"}, "edited": false, "score": 0, "creation_date": 1529405697, "post_id": 50925761, "comment_id": 88852344, "body": "Sure let me try"}, {"owner": {"reputation": 418, "user_id": 6545189, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-MV4nmggkVbw/AAAAAAAAAAI/AAAAAAAADc4/nKkbVL-rg9g/photo.jpg?sz=128", "display_name": "sudharsan tk", "link": "https://stackoverflow.com/users/6545189/sudharsan-tk"}, "edited": false, "score": 0, "creation_date": 1529415152, "post_id": 50925761, "comment_id": 88858297, "body": "Still the same when i Print am getting this {   0 0} , I updated my struct under my question"}], "tags": [], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "is_accepted": false, "score": 0, "last_activity_date": 1529402876, "creation_date": 1529402876, "answer_id": 50925761, "question_id": 50925048, "link": "https://stackoverflow.com/questions/50925048/addflat-map-of-struct/50925761#50925761", "title": "AddFlat map of struct", "body": "<pre><code>func marshal(in interface{}) []byte {\n    var buf bytes.Buffer\n    encoder := gob.NewEncoder(&amp;buf)\n\n    err := encoder.Encode(in)\n    assert.Nil(err)\n\n    return buf.Bytes()\n}\n\nfunc unmarshal(data []byte) Person {\n    buffer := bytes.NewBuffer(data)\n    decoder := gob.NewDecoder(buffer)\n\n    var p Person\n    err := decoder.Decode(p)\n    assert.Nil(err)\n\n    return p\n}\n</code></pre>\n\n<p>you can use these to marshal your structs, swap person with your map, also make sure your struct has struct tags and capitalized first character of each field</p>\n"}], "owner": {"reputation": 418, "user_id": 6545189, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-MV4nmggkVbw/AAAAAAAAAAI/AAAAAAAADc4/nKkbVL-rg9g/photo.jpg?sz=128", "display_name": "sudharsan tk", "link": "https://stackoverflow.com/users/6545189/sudharsan-tk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544180884, "creation_date": 1529400873, "last_edit_date": 1544180884, "question_id": 50925048, "link": "https://stackoverflow.com/questions/50925048/addflat-map-of-struct", "title": "AddFlat map of struct", "body": "<p>How to unmarshal map of struct?</p>\n\n<p>added a  <code>map[string]</code> of <code>Person</code> type to redis using</p>\n\n<pre><code>conn.Do(\"HMSET\", redis.Args{\"Teams\"}.AddFlat(values)...);\n</code></pre>\n\n<p>I am able to print a value </p>\n\n<pre><code>v, err := redis.String(conn.Do(\"HGET\", key, field))\n</code></pre>\n\n<p><code>log.Print(v)</code> succesfully prints the value, but how can I unmarshal it back to struct of type <code>Person</code>?</p>\n\n<p>How I added</p>\n\n<pre><code>m:= make(map[string]Person)\nm['E21']=Person{\"FirstName\",\"LastName\"}\nHMSet(\"Team\", m)\n</code></pre>\n\n<p>How I added to redis</p>\n\n<pre><code>func HMSet(key string, values map[string]dataobjects.Person) error {\n    conn := Pool.Get()\n    defer conn.Close()\n    if _, err := conn.Do(\"HMSET\", redis.Args{key}.AddFlat(values)...); err != nil {\n        log.Fatal(err)\n    }\n    return nil\n}\n</code></pre>\n\n<p>How I got it back</p>\n\n<pre><code>func HGet(key, field string) error {\n    conn := Pool.Get()\n    defer conn.Close()\n\n    v, err := redis.Bytes(conn.Do(\"HGET\", key, field))\n    if err != nil {\n        fmt.Println(err)\n        return err\n    }\n    // I am able to print v succesfully,but how to return Person object from v\n\n\n    return nil\n}\n</code></pre>\n\n<p>My struct</p>\n\n<pre><code>type Person struct {\n    FirstName string  `FirstName `\n    LastName string  `LastName `     \n}\n</code></pre>\n"}, {"tags": ["go", "transactions", "apache-kafka", "confluent-platform"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5928023, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b4ce1c20303a86bfdc981454b29fdaea?s=128&d=identicon&r=PG&f=1", "display_name": "sumit jha", "link": "https://stackoverflow.com/users/5928023/sumit-jha"}, "edited": false, "score": 0, "creation_date": 1529563087, "post_id": 50927236, "comment_id": 88920495, "body": "Robin , Thanks for your time . What will be your input whether should i use c client for kafka or java client ."}, {"owner": {"reputation": 21865, "user_id": 350613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bded62396ea66c84bd10e91c718dea9?s=128&d=identicon&r=PG", "display_name": "Robin Moffatt", "link": "https://stackoverflow.com/users/350613/robin-moffatt"}, "reply_to_user": {"reputation": 71, "user_id": 5928023, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b4ce1c20303a86bfdc981454b29fdaea?s=128&d=identicon&r=PG&f=1", "display_name": "sumit jha", "link": "https://stackoverflow.com/users/5928023/sumit-jha"}, "edited": false, "score": 0, "creation_date": 1529571124, "post_id": 50927236, "comment_id": 88925108, "body": "The C client is also based on <code>librdkafka</code>. If you need transactions now, you will need to use the Java client. Support for others, via <code>librdkafka</code>, is coming though."}, {"owner": {"reputation": 76, "user_id": 2750442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66e5c5b9cd42ac1464b2a18edb5c5db9?s=128&d=identicon&r=PG&f=1", "display_name": "sahil mohindroo", "link": "https://stackoverflow.com/users/2750442/sahil-mohindroo"}, "edited": false, "score": 0, "creation_date": 1560235845, "post_id": 50927236, "comment_id": 99658020, "body": "Is there any update on this. Has any go library implemented transactions support yet for consumers?"}], "tags": [], "owner": {"reputation": 21865, "user_id": 350613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bded62396ea66c84bd10e91c718dea9?s=128&d=identicon&r=PG", "display_name": "Robin Moffatt", "link": "https://stackoverflow.com/users/350613/robin-moffatt"}, "is_accepted": false, "score": 2, "last_activity_date": 1529407447, "creation_date": 1529407447, "answer_id": 50927236, "question_id": 50923636, "link": "https://stackoverflow.com/questions/50923636/is-there-any-kafka-go-client-which-support-transactions/50927236#50927236", "title": "Is there any Kafka Go client which support transactions?", "body": "<p>I don't believe this is currently available. The <code>librdkafka</code> library is being updated currently to support it, and then from there the golang client will too.</p>\n"}], "owner": {"reputation": 71, "user_id": 5928023, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b4ce1c20303a86bfdc981454b29fdaea?s=128&d=identicon&r=PG&f=1", "display_name": "sumit jha", "link": "https://stackoverflow.com/users/5928023/sumit-jha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529407588, "creation_date": 1529396095, "last_edit_date": 1529407588, "question_id": 50923636, "link": "https://stackoverflow.com/questions/50923636/is-there-any-kafka-go-client-which-support-transactions", "title": "Is there any Kafka Go client which support transactions?", "body": "<p>I need to use a client library which support transaction in Kafka. I know that Java has transaction APIs to support transaction but I will prefer if these APIs would be available in Go. Please let me know if we have any stable library which I can use to write into multiple partition atomically.</p>\n"}, {"tags": ["go", "bytebuffer"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1529395501, "post_id": 50923059, "comment_id": 88846105, "body": "Your title mentioned byte buffers, but your question doesn&#39;t mention buffers at all, and the actual question isn&#39;t even about bytes. So I updated your title to match the question."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1529399881, "post_id": 50923059, "comment_id": 88848648, "body": "<a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">The Go Blog: Strings, bytes, runes and characters in Go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1529400938, "post_id": 50923230, "comment_id": 88849280, "body": "Wait a second, where is that date in the output coming from?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1529404350, "post_id": 50923230, "comment_id": 88851520, "body": "@MarcoBonelli: <a href=\"https://play.golang.org/\" rel=\"nofollow noreferrer\">The Go Playground</a>: About the Playground: In the playground the time begins at 2009-11-10 23:00:00 UTC. This makes it easier to cache programs by giving them deterministic output."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1529396130, "last_edit_date": 1529396130, "creation_date": 1529394699, "answer_id": 50923230, "question_id": 50923059, "link": "https://stackoverflow.com/questions/50923059/understanding-string-escape-sequences/50923230#50923230", "title": "Understanding string escape sequences", "body": "<p><code>[]byte(\"\\xd2\\xfd\\x88g\\xd5\\r-\\xfe\")</code> is an interpreted string literal converted to  type <code>[]byte</code>, a <code>byte</code> slice. Here it is separated into byte values:</p>\n\n<pre><code>[\\xd2, \\xfd, \\x88, g, \\xd5, \\r, -, \\xfe]\n</code></pre>\n\n<p>or, expressed as hexadecimal bytes,</p>\n\n<pre><code>[d2, fd, 88, 67, d5, 0d, 2d, fe]\n</code></pre>\n\n<hr>\n\n<p>One way to log the value,</p>\n\n<pre><code>package main\n\nimport \"log\"\n\nfunc main() {\n    b := []byte(\"\\xd2\\xfd\\x88g\\xd5\\r-\\xfe\")\n    log.Printf(\"%q\\n\", b)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/BIh_EuvoxU-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/BIh_EuvoxU-</a></p>\n\n<p>Output:</p>\n\n<pre><code>2009/11/10 23:00:00 \"\\xd2\\xfd\\x88g\\xd5\\r-\\xfe\"\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec#String_literals\" rel=\"nofollow noreferrer\">String literals</a></p>\n  \n  <p>A string literal represents a string constant obtained from\n  concatenating a sequence of characters. There are two forms: raw\n  string literals and interpreted string literals.</p>\n  \n  <p>Raw string literals are character sequences between back quotes, as in\n  <code>foo</code>. Within the quotes, any character may appear except back quote.\n  The value of a raw string literal is the string composed of the\n  uninterpreted (implicitly UTF-8-encoded) characters between the\n  quotes; in particular, backslashes have no special meaning and the\n  string may contain newlines. Carriage return characters ('\\r') inside\n  raw string literals are discarded from the raw string value.</p>\n  \n  <p>Interpreted string literals are character sequences between double\n  quotes, as in \"bar\". Within the quotes, any character may appear\n  except newline and unescaped double quote. The text between the quotes\n  forms the value of the literal, with backslash escapes interpreted as\n  they are in rune literals (except that \\' is illegal and \\\" is legal),\n  with the same restrictions. The three-digit octal (\\nnn) and two-digit\n  hexadecimal (\\xnn) escapes represent individual bytes of the resulting\n  string; all other escapes represent the (possibly multi-byte) UTF-8\n  encoding of individual characters. Thus inside a string literal \\377\n  and \\xFF represent a single byte of value 0xFF=255, while \u00ff, \\u00FF,\n  \\U000000FF and \\xc3\\xbf represent the two bytes 0xc3 0xbf of the UTF-8\n  encoding of character U+00FF.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>After a backslash, certain single-character escapes represent special\n  values:</p>\n\n<pre><code>\\a   U+0007 alert or bell\n\\b   U+0008 backspace\n\\f   U+000C form feed\n\\n   U+000A line feed or newline\n\\r   U+000D carriage return\n\\t   U+0009 horizontal tab\n\\v   U+000b vertical tab\n\\\\   U+005c backslash\n\\'   U+0027 single quote  (valid escape only within rune literals)\n\\\"   U+0022 double quote  (valid escape only within string literals)\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 744, "user_id": 6819874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ic7D9.jpg?s=128&g=1", "display_name": "lokanadham100", "link": "https://stackoverflow.com/users/6819874/lokanadham100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 349, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1529396130, "creation_date": 1529394075, "last_edit_date": 1529395475, "question_id": 50923059, "link": "https://stackoverflow.com/questions/50923059/understanding-string-escape-sequences", "title": "Understanding string escape sequences", "body": "<p>I am new to go, so lot of confusion regarding bytes concept.</p>\n\n<p>While going through some go code, I came across some thing like</p>\n\n<pre><code>[]byte(\"\\xd2\\xfd\\x88g\\xd5\\r-\\xfe\")\n</code></pre>\n\n<p>was it in hexa decimal or bytes format?</p>\n\n<p>what are some chars in above like <code>g,r-,e</code> signifies?</p>\n\n<p>And how to print it in log? </p>\n"}, {"tags": ["go", "spdy", "libchan"], "answers": [{"comments": [{"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1529600919, "post_id": 50973712, "comment_id": 88944376, "body": "hmm... interesting. i figured the exit packet would be the culprit. I&#39;m curious about how to diagnose this within the code itself, without the use of a tool like tcpdump?"}, {"owner": {"reputation": 556, "user_id": 3581874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2073bb9adeaf4226234f85ff4c1b69?s=128&d=identicon&r=PG&f=1", "display_name": "MichalG", "link": "https://stackoverflow.com/users/3581874/michalg"}, "reply_to_user": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1529663189, "post_id": 50973712, "comment_id": 88966526, "body": "You can use env variable DEBUG=true and then run server. This will give you some additional output on what&#39;s happening in libchan behind the scenes. You can see then that when the TCP connection is closed, EOF error is received, then the channel is being closed, and since the receive channel is closed, we get error on another call to receive. I edited my response with details."}], "tags": [], "owner": {"reputation": 556, "user_id": 3581874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2073bb9adeaf4226234f85ff4c1b69?s=128&d=identicon&r=PG&f=1", "display_name": "MichalG", "link": "https://stackoverflow.com/users/3581874/michalg"}, "is_accepted": true, "score": 2, "last_activity_date": 1529664129, "last_edit_date": 1592644375, "creation_date": 1529599519, "answer_id": 50973712, "question_id": 50921995, "link": "https://stackoverflow.com/questions/50921995/spdy-stream-receiver-is-receiving-nil-object/50973712#50973712", "title": "Spdy stream receiver is receiving nil object", "body": "<p>It seems it is an attempted try to decode FIN ACK TCP packet coming from the client on exiting. The TCP connection is being closed, and at the server side we try to read this. We get EOF error because there is no more input to read. It seems to be a behaviour as specified in  <a href=\"https://golang.org/pkg/io/#pkg-variables\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n<blockquote>\n<p>EOF is the error returned by Read when no more input is available. Functions should return EOF only to signal a graceful end of input. If the EOF occurs unexpectedly in a structured data stream, the appropriate error is either ErrUnexpectedEOF or some other error giving more detail.</p>\n</blockquote>\n<p>Under the hood, libchan spdy uses msgpack encoder and decoder (<a href=\"https://github.com/docker/libchan/blob/master/spdy/session.go#L49\" rel=\"nofollow noreferrer\">source code</a>) that, in order to read this TCP packet will call bufio ReadByte() function (<a href=\"https://github.com/dmcgowan/msgpack/blob/master/map.go#L78\" rel=\"nofollow noreferrer\">source code</a>), that returns error when no more data is there to be read (and that's the case when TCP connection was closed).</p>\n<pre><code>// ReadByte reads and returns a single byte.\n// If no byte is available, returns an error.\nfunc (b *Reader) ReadByte() (byte, error) {\n...\n</code></pre>\n<p>You can see the TCP packet exchange running <code>sudo tcpdump -i lo dst port 9323</code>. The FIN ACK TCP packet that is causing this EOF error:</p>\n<pre><code>18:28:23.782337 IP localhost.47574 &gt; localhost.9323: Flags [F.], seq 272, ack 166, win 342, options [nop,nop,TS val 73397258 ecr 73397258], length 0\n</code></pre>\n<p>I think that this behaviour is normal and EOF error should be handled in the code. The command is blank, because client is not sending any specific command, just the stream is being closed.</p>\n<p>Also - from the io.Reader <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n<blockquote>\n<p>When Read encounters an error or end-of-file condition after successfully reading n &gt; 0 bytes, it returns the number of bytes read. It may return the (non-nil) error from the same call or return the error (and n == 0) from a subsequent call. An instance of this general case is that a Reader returning a non-zero number of bytes at the end of the input stream may return either err == EOF or err == nil. The next Read should return 0, EOF.</p>\n<p>Callers should always process the n &gt; 0 bytes returned before considering the error err. Doing so correctly handles I/O errors that happen after reading some bytes and also both of the allowed EOF behaviors.</p>\n</blockquote>\n<p><strong>[EDIT]</strong> To answer more specifically what's happening behind the scenes with libchan:</p>\n<p>If you look in the code, you'll see that <code>spdy.NewSpdyStreamProvider(c, true)</code> creates new spdystream connection and then <a href=\"https://github.com/docker/libchan/blob/master/spdy/streams.go#L65\" rel=\"nofollow noreferrer\">runs Serve</a> on that connection in a separate goroutine. Serve function of spdstream tries to read received FIN ACK packet and <a href=\"https://github.com/docker/spdystream/blob/master/connection.go#L325\" rel=\"nofollow noreferrer\">receives EOF</a> (as specified in go documentation cited above). Then, it exits the main Loop of the function and <a href=\"https://github.com/docker/spdystream/blob/master/connection.go#L389\" rel=\"nofollow noreferrer\">closes channels</a>. Then, we get our EOF error on Receive <a href=\"https://github.com/docker/spdystream/blob/master/stream.go#L81\" rel=\"nofollow noreferrer\">here</a>.</p>\n<p>In order to see in more detail what's happening, you can set env variable DEBUG=true</p>\n<pre><code>$ export DEBUG=true\n$ ./server \n</code></pre>\n<p>The output:</p>\n<pre><code>127.0.0.1:57652\n2018/06/22 12:24:12 (0xc4200a42c0) Add stream frame: 1 \n2018/06/22 12:24:12 (0xc4200a42c0) (0xc42016c000) Stream added, broadcasting: 1\n2018/06/22 12:24:12 (0xc4200a42c0) Add stream frame: 3 \n2018/06/22 12:24:12 (0xc4200a42c0) (0xc42016c0a0) Stream added, broadcasting: 3\n2018/06/22 12:24:12 (0xc4200a42c0) Add stream frame: 5 \n2018/06/22 12:24:12 (0xc4200a42c0) (0xc42016c140) Stream added, broadcasting: 5\n2018/06/22 12:24:12 (0xc4200a42c0) Add stream frame: 7 \n2018/06/22 12:24:12 (0xc4200a42c0) (0xc42016c1e0) Stream added, broadcasting: 7\n2018/06/22 12:24:12 about to spawn receive proc\n2018/06/22 12:24:12 trying to receive\n2018/06/22 12:24:12 (0xc4200a42c0) Add stream frame: 9 \n2018/06/22 12:24:12 (0xc4200a42c0) (0xc42016c280) Stream added, broadcasting: 9\n2018/06/22 12:24:12 (0xc4200a42c0) Data frame received for 1\n2018/06/22 12:24:12 (0xc42016c000) (1) Data frame handling\n2018/06/22 12:24:12 (0xc42016c000) (1) Data frame sent\n2018/06/22 12:24:12 received command\n2018/06/22 12:24:12 &amp;{/bin/echo [hello] 0xc420156570 0xc4201565a0 0xc420156120 0xc42013c4a0}\n2018/06/22 12:24:12 about to run the command\n2018/06/22 12:24:12 (0xc42016c140) (5) Writing data frame\n2018/06/22 12:24:12 (0xc42016c140) (5) Writing data frame\n2018/06/22 12:24:12 (0xc42016c1e0) (7) Writing data frame\n2018/06/22 12:24:12 (0xc42016c280) (9) Writing data frame\n2018/06/22 12:24:12 trying to receive\n2018/06/22 12:24:12 (0xc4200a42c0) EOF received\n2018/06/22 12:24:12 (0xc4200a42c0) (0xc42016c000) Stream removed, broadcasting: 1\n2018/06/22 12:24:12 (0xc42016c000) (1) Writing data frame\n2018/06/22 12:24:12 received command\n2018/06/22 12:24:12 &amp;{ [] &lt;nil&gt; &lt;nil&gt; &lt;nil&gt; &lt;nil&gt;}\n2018/06/22 12:24:12 command error\n2018/06/22 12:24:12 EOF\n</code></pre>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "accepted_answer_id": 50973712, "answer_count": 1, "score": 1, "last_activity_date": 1529664129, "creation_date": 1529390164, "last_edit_date": 1529391551, "question_id": 50921995, "link": "https://stackoverflow.com/questions/50921995/spdy-stream-receiver-is-receiving-nil-object", "title": "Spdy stream receiver is receiving nil object", "body": "<p>I'm using the <a href=\"https://github.com/docker/libchan\" rel=\"nofollow noreferrer\"><code>libchan</code></a> library by docker. Their example goes like this:</p>\n\n<pre><code>// client.go\npackage main\n\nimport (\n    \"log\"\n    \"io\"\n    \"net\"\n    \"os\"\n    \"github.com/docker/libchan\"\n    \"github.com/docker/libchan/spdy\"\n)\n\ntype RemoteCommand struct {\n    Cmd        string\n    Args       []string\n    Stdin      io.Writer\n    Stdout     io.Reader\n    Stderr     io.Reader\n    StatusChan libchan.Sender\n}\n\ntype CommandResponse struct {\n    Status int\n}\n\nfunc main() {\n    var client net.Conn\n    client, err := net.Dial(\"tcp\", \"127.0.0.1:9323\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    p, err := spdy.NewSpdyStreamProvider(client, false)\n    transport := spdy.NewTransport(p)\n    sender, err := transport.NewSendChannel()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    receiver, remoteSender := libchan.Pipe()\n\n    command := &amp;RemoteCommand{\n        Cmd:        os.Args[1],\n        Args:       os.Args[2:],\n        Stdin:      os.Stdin,\n        Stdout:     os.Stdout,\n        Stderr:     os.Stderr,\n        StatusChan: remoteSender,\n    }\n\n    err = sender.Send(command)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    response := &amp;CommandResponse{}\n    err = receiver.Receive(response)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    os.Exit(response.Status)\n}\n</code></pre>\n\n<p>And this is the server:</p>\n\n<pre><code>// server.go\npackage main\n\nimport (\n    \"log\"\n    \"net\"\n    \"io\"\n    \"os/exec\"\n    \"syscall\"\n    \"github.com/docker/libchan\"\n    \"github.com/docker/libchan/spdy\"\n)\n\ntype RemoteReceivedCommand struct {\n    Cmd        string\n    Args       []string\n    Stdin      io.Reader\n    Stdout     io.WriteCloser\n    Stderr     io.WriteCloser\n    StatusChan libchan.Sender\n}\n\ntype CommandResponse struct {\n    Status int\n}\n\nfunc main() {\n    var listener net.Listener\n    var err error\n    listener, err = net.Listen(\"tcp\", \"localhost:9323\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    for {\n        c, err := listener.Accept()\n        if err != nil {\n            log.Print(\"listener accept error\")\n            log.Print(err)\n            break\n        }\n\n        p, err := spdy.NewSpdyStreamProvider(c, true)\n        if err != nil {\n            log.Print(\"spdy stream error\")\n            log.Print(err)\n            break\n        }\n        t := spdy.NewTransport(p)\n\n        go func() {\n            for {\n                receiver, err := t.WaitReceiveChannel()\n                if err != nil {\n                    log.Print(\"receiver error\")\n                    log.Print(err)\n                    break\n                }\n                log.Print(\"about to spawn receive proc\")\n                go func() {\n                    for {\n                        command := &amp;RemoteReceivedCommand{}\n                        err := receiver.Receive(command)\n                        log.Print(\"received command\")\n                        log.Print(command)\n                        if err != nil {\n                            log.Print(\"command error\")\n                            log.Print(err)\n                            break\n                        }\n\n                        cmd := exec.Command(command.Cmd, command.Args...)\n                        cmd.Stdout = command.Stdout\n                        cmd.Stderr = command.Stderr\n\n                        stdin, err := cmd.StdinPipe()\n                        if err != nil {\n                            log.Print(\"stdin error\")\n                            log.Print(err)\n                            break\n                        }\n                        go func() {\n                            io.Copy(stdin, command.Stdin)\n                            stdin.Close()\n                        }()\n\n                        log.Print(\"about to run the command\")\n                        res := cmd.Run()\n                        command.Stdout.Close()\n                        command.Stderr.Close()\n                        returnResult := &amp;CommandResponse{}\n                        if res != nil {\n                            if exiterr, ok := res.(*exec.ExitError); ok {\n                                returnResult.Status = exiterr.Sys().(syscall.WaitStatus).ExitStatus()\n                            } else {\n                                log.Print(\"res\")\n                                log.Print(res)\n                                returnResult.Status = 10\n                            }\n                        }\n                        err = command.StatusChan.Send(returnResult)\n                        if err != nil {\n                            log.Print(err)\n                        }\n                    }\n                }()\n            }\n        }()\n\n\n    }\n}\n</code></pre>\n\n<p>When I run the server and send a message with the client:</p>\n\n<pre><code>$ ./client /bin/echo \"hello\"\n</code></pre>\n\n<p>I see this output in the server logs:</p>\n\n<pre><code>2018/06/18 23:13:56 about to spawn receive proc\n2018/06/18 23:13:56 received command\n2018/06/18 23:13:56 &amp;{/bin/echo [hello] 0xc4201201b0 0xc42023c030 0xc42023c090 0xc420186080}\n2018/06/18 23:13:56 about to run the command\n2018/06/18 23:13:56 received command\n2018/06/18 23:13:56 &amp;{ [] &lt;nil&gt; &lt;nil&gt; &lt;nil&gt; &lt;nil&gt;}\n2018/06/18 23:13:56 command error\n2018/06/18 23:13:56 EOF\n</code></pre>\n\n<p>My server receives the message with the <code>echo</code> command and executes it successfully. However, it also receives an empty command and then throws an EOF: </p>\n\n<pre><code>2018/06/18 23:13:56 &amp;{ [] &lt;nil&gt; &lt;nil&gt; &lt;nil&gt; &lt;nil&gt;}\n2018/06/18 23:13:56 command error\n2018/06/18 23:13:56 EOF\n</code></pre>\n\n<p>Why is the command an empty string?</p>\n\n<p>My suspicion is that the client exits and then sends an <code>exit</code> signal. But if that was the case, why would the command be blank? Please help me understand what's going on.</p>\n"}, {"tags": ["go", "visual-studio-code", "delve"], "answers": [{"comments": [{"owner": {"reputation": 5979, "user_id": 1009669, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef0d4c06ad2d9ae5fdfdc934f7d49e4f?s=128&d=identicon&r=PG&f=1", "display_name": "BigBug", "link": "https://stackoverflow.com/users/1009669/bigbug"}, "edited": false, "score": 0, "creation_date": 1529420960, "post_id": 50920864, "comment_id": 88862156, "body": "still no luck :( i am also now seeing problems in the laucnh.json file saying type go definition cannot be found"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 5979, "user_id": 1009669, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef0d4c06ad2d9ae5fdfdc934f7d49e4f?s=128&d=identicon&r=PG&f=1", "display_name": "BigBug", "link": "https://stackoverflow.com/users/1009669/bigbug"}, "edited": false, "score": 0, "creation_date": 1529425243, "post_id": 50920864, "comment_id": 88864459, "body": "@BigBug Do you have the go plugin installed in your VSCode instance?"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1529383997, "creation_date": 1529383997, "answer_id": 50920864, "question_id": 50920569, "link": "https://stackoverflow.com/questions/50920569/remote-debugging-go-rest-endpoints/50920864#50920864", "title": "Remote Debugging Go REST Endpoints", "body": "<p><a href=\"https://blog.gobuffalo.io/debugging-a-buffalo-app-in-gogland-b9a00e8076b8\" rel=\"nofollow noreferrer\">This article</a> mentioned:</p>\n\n<p>Unfortunately, you won\u2019t be able to debug an application when running with buffalo dev. You\u2019ll need to build an executable that skips compiler optimizations like function invocation inlining.<br>\n<strong>If you skip these build flags Gogland won\u2019t stop on your break points</strong>.</p>\n\n<p>More on that on \"<a href=\"https://golang.org/doc/gdb#Introduction\" rel=\"nofollow noreferrer\">Debugging Go Code with GDB </a>\".  </p>\n\n<blockquote>\n  <p>The code generated by the gc compiler includes inlining of function invocations and registerization of variables. These optimizations can sometimes make debugging with gdb harder.</p>\n</blockquote>\n\n<p>After that, you can follow \"<a href=\"https://github.com/Microsoft/vscode-go/wiki/Debugging-Go-code-using-VS-Code#remote-debugging\" rel=\"nofollow noreferrer\">Remote Debugging</a>\"</p>\n\n<blockquote>\n  <p>To remote debug using VS Code, you must first run a headless Delve server on the target machine. For example:</p>\n</blockquote>\n\n<pre><code>$ dlv debug --headless --listen=:2345 --log\n</code></pre>\n\n<p><em>Then</em> your launcher can apply.</p>\n"}], "owner": {"reputation": 5979, "user_id": 1009669, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef0d4c06ad2d9ae5fdfdc934f7d49e4f?s=128&d=identicon&r=PG&f=1", "display_name": "BigBug", "link": "https://stackoverflow.com/users/1009669/bigbug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1025, "favorite_count": 1, "accepted_answer_id": 50920864, "answer_count": 1, "score": 1, "last_activity_date": 1529383997, "creation_date": 1529381688, "question_id": 50920569, "link": "https://stackoverflow.com/questions/50920569/remote-debugging-go-rest-endpoints", "title": "Remote Debugging Go REST Endpoints", "body": "<p>I am new to Go and new to VSCode. I have also never used Delve before. I am trying to set up remote debugging but i can't seem to hit breakpoints. </p>\n\n<p>My project hosts REST endpoints on localhost:8080. What should the launch.json file look like in order to have delve attach and listen so that I can put breakpoints on my REST endpoints? Currently, this is what i have: </p>\n\n<pre><code>\"configurations\": [\n    {\n        \"name\": \"Launch\",\n        \"type\": \"go\",\n        \"request\": \"launch\",\n        \"mode\": \"remote\",\n        \"remotePath\": \"\",\n        \"port\": 8080,\n        \"host\": \"127.0.0.1\",\n        \"program\": \"${workspaceRoot}\",\n        \"env\": {},\n        \"args\": [],\n        \"showLog\": true\n    }\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1529382284, "post_id": 50919260, "comment_id": 88840741, "body": "No. 3 or no. 2. 1 Is impossible."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 8833915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d3f1a0f0991e962bf5739c074b0577?s=128&d=identicon&r=PG&f=1", "display_name": "Diane Looney", "link": "https://stackoverflow.com/users/8833915/diane-looney"}, "is_accepted": false, "score": 2, "last_activity_date": 1529374148, "last_edit_date": 1529374148, "creation_date": 1529373605, "answer_id": 50919663, "question_id": 50919260, "link": "https://stackoverflow.com/questions/50919260/golang-unit-testing-error-conditions/50919663#50919663", "title": "Golang Unit Testing: error conditions", "body": "<p>Like you, I've never seen a solution to this problem that's totally satisfied me.</p>\n\n<p>In regards to your example 3, remember that you can <code>defer</code> the reset of the cryptoB. This, combined with good naming of the mock functions, would make it clear what you are trying to accomplish. There are obviously still code-style issues with this approach, with having all of your references listed line by line, twice, at the start of your file.</p>\n\n<pre><code>func TestSomething(t *testing.T) {\n    cryptoB = mockedFunc\n    defer func() {\n        cryptoB = crypto.B\n    }\n    // Testing goes on here\n}\n</code></pre>\n\n<p><strong>Option 4</strong></p>\n\n<p>The other approach (which I would favor) would be to turn the functions you export into methods of a CryptoA struct. The struct would store whatever dependencies and state it requires.  Something like this:</p>\n\n<pre><code>type CryptoA struct {\n    cryptoB func() error\n}\nfunc (a *CryptoA) CryptoA() error {\n    return a.cryptoB()\n}\nfunc NewCryptoA() *CryptoA {\n    return &amp;CryptoA{\n        cryptoB: func() error {\n            return nil\n        },\n    }\n}\n</code></pre>\n\n<p>and mocking would be very similar:</p>\n\n<pre><code>func TestSomething(t *testing.T) {\n    a := NewCryptoA()\n    a.cryptoB = mockedFunc\n\n    // Testing goes on here\n}\n</code></pre>\n\n<p>With this approach you lose some by your API having an extra step for invocation, <code>a := NewCryptoA()</code>, and you still have to name all of your dependencies, but you make gains by having the state of your API specific to each client.</p>\n\n<p>Maybe there is a flaw in your API, and you leak data somewhere unexpected, or there is some state modifications that you don't expect. If you create a new CryptoA for each caller, then maybe the amount of data you leak, or the number of clients with a corrupted state, is limited, and therefore the impact less severe/abusable. I'm obviously spitballing at how this applies to your codebase, but hopefully you can get the idea of how this is a win.</p>\n\n<p>Also, if you want to give the ability for users to specify their own hash algorithm, you can swap it out internally, and since it's private you maintain confidence that the function is up to the standards of your API. Again, I'm obviously spitballing.</p>\n\n<p>I'll be skimming the answers to see if there's an idiomatic way to do this that I'm unaware of.</p>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 2, "last_activity_date": 1529394502, "creation_date": 1529394502, "answer_id": 50923171, "question_id": 50919260, "link": "https://stackoverflow.com/questions/50919260/golang-unit-testing-error-conditions/50923171#50923171", "title": "Golang Unit Testing: error conditions", "body": "<p>My preferred approach is usually to make <code>A</code> a method, and store the dependencies in the receiver object. Example:</p>\n\n<pre><code>import crypto;\n\ntype CryptoIface interface {\n    B() (string, error)\n}\n\ntype standardCrypto struct {}\n\nvar _ CryptoIface = &amp;standardCrypto{}\n\nfunc (c *standardCrypto) B() (string, error) {\n    return crypto.B()\n}\n\nfunc main() {\n    crypto = &amp;standardCrypto{}\n    err = A(crypto, ...)\n    // stuff\n}\n\nfunc A(crypto CryptoIface, args ...string) error {\n    result, err := crypto.B()\n    if err != nil {\n        return err\n    }\n    // do something with result\n    return nil\n}\n</code></pre>\n\n<p>Then for your tests, you can easily create a mock version of the <code>CryptoIface</code>:</p>\n\n<pre><code>type mockCrypto struct {\n    Bfunc func(args ...string) error\n}\n\nfunc (c *mockCrypto) B(args ...string) error {\n    return c.Bfunc(args...)\n}\n\nfunc TestA(t *testing.T) {\n    c := &amp;mockCrypto{\n        Bfunc: func(_ ...string) error {\n            return errors.New(\"test error\")\n        }\n    }\n    err := A(c)\n    if err.String() != \"test error\" {\n        t.Errorf(\"Unexpected error: %s\", err)\n    }\n}\n</code></pre>\n\n<p>This approach is usually most useful for large projects or APIs where it makes sense to include a number of methods on a single object.  Use your discretion. For smaller cases, this will be overkill.</p>\n"}], "owner": {"reputation": 427, "user_id": 1797466, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c5039ea72a1a51ebf53b098c171da65e?s=128&d=identicon&r=PG", "display_name": "user1797466", "link": "https://stackoverflow.com/users/1797466/user1797466"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1910, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1529394502, "creation_date": 1529369772, "question_id": 50919260, "link": "https://stackoverflow.com/questions/50919260/golang-unit-testing-error-conditions", "title": "Golang Unit Testing: error conditions", "body": "<p>How do I test error conditions, &amp; other unexpected code flow, in Golang?</p>\n\n<p>Suppose I have code as follows:</p>\n\n<pre><code>import crypto\nfunc A(args) error {\n    x, err := crypto.B()\n    if err != nil {\n        return err\n    }\n    return nil\n}\n</code></pre>\n\n<p><code>B</code> is some function. I believe that the only way for me to test this failure scenario is to change the value of <code>B</code> for my test (mock it so it returns an error). Things I have tried:</p>\n\n<p>1) monkeypatch the function just before the test and unpatch afterwards.\nThis was a horrible idea. Caused all sorts of weird issues as the\ntests were running.</p>\n\n<p>2) Pass <code>B</code> as an argument to <code>A</code>. This is all well and good but it also\nmeans that I have to change the definition for <code>A</code> and then update\nevery use of it every time the implementation changes. Furthermore,\n<code>A</code> may be using many imported functions and putting them all in the\ntype definition for <code>A</code> just seems ugly and not idiomatic.</p>\n\n<p>3) Change the value of <code>B</code> for my test, then change it back.</p>\n\n<pre><code>import crypto.B\ncryptoB = crypto.B\nfunc A(args) error {\n    x, err := cryptoB()\n    if err != nil {\n        return err\n    }\n    ...\n }\n\n func Test_A(t *testing.T) {\n     oldB := cryptoB\n     cryptoB = mockB\n     // run test\n     cryptoB = oldB\n     ...\n }\n</code></pre>\n\n<p>I've been using method #3 as it allows me fine grained unit testing control while not creating too much overhead. That said, it's ugly and causes confusion e.g. \"Why are we renaming all of the imported functions?\".</p>\n\n<p>What should I be doing? Please help me so my codes can be more better :)</p>\n"}, {"tags": ["http", "go", "oauth-2.0", "jwt", "box-api"], "comments": [{"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1529391549, "post_id": 50919009, "comment_id": 88843952, "body": "First, I think you do not need to add Content-Type header ( maybe it should be <code>application&#47;json</code>) . Second thing you losing <code>error response body</code> when decodeing, where validation information should be attached. In box documentation I see that as grant_type you should send just <code>authorization_code</code> <a href=\"https://developer.box.com/reference#token\" rel=\"nofollow noreferrer\">developer.box.com/reference#token</a>"}], "owner": {"reputation": 11, "user_id": 9959173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ee4fa4394ec06bcb475830bc31752f?s=128&d=identicon&r=PG&f=1", "display_name": "The Duke", "link": "https://stackoverflow.com/users/9959173/the-duke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 476, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1529395270, "creation_date": 1529367222, "last_edit_date": 1529395270, "question_id": 50919009, "link": "https://stackoverflow.com/questions/50919009/oauth-using-jwt-for-box-api", "title": "OAuth using JWT for Box API", "body": "<p>I am attempting to make calls to the Box API in order to upload files remotely without any user interaction other than running a script. I am trying to implement this in Go, and I am using the method of JWT to avoid the need for any login authorization with normal 3-legged oAuth. I am able to generate a JWT but when I use this JWT to try to obtain an access token, my HTTP request is returning an empty body as a response with a 400 (Bad Request) error. I am not sure why it is a bad request as I think I have all the necessary information in my request. Is there anything important that I might have missed in constructing my HTTP request?</p>\n\n<p>The following is my code used for generating the JWT and attempting to use that JWT to get an access token. Calling the CreateJWTAssertion function returns a working JWT, but calling SendOAuthRequest is not returning the intended access token.  </p>\n\n<pre><code>// APPUSERNAME - used to name the user when creating an App User\nconst APPUSERNAME string = \"box-reporter\"\n\n// JWTAUTHURL - URL for oAUTH for Box\nconst JWTAUTHURL string = \"https://api.box.com/oauth2/token\"\n\n// JWTUSERURL - URL for creating an App User\nconst JWTUSERURL string = \"https://api.box.com/2.0/users\"\n\n// JWTGRANTTYPE - mandatory parameter for box oAuth\nconst JWTGRANTTYPE string = \"urn:ietf:params:oauth:grant-type:jwt-bearer\"\n\n// oAuthResponse holds decoded JSON response from Box\ntype oAuthResponse struct {\n    AccessToken  string   `json:\"access_token\"`\n    Expires      int      `json:\"expires_in\"`\n    RestrictedTo []string `json:\"restricted_to\"`\n    TokenType    string   `json:\"token_type\"`\n}\n\n// AppUserRequest holds  JSON request to create an AppUser\ntype AppUserRequest struct {\n    IsPlatformAccess bool   `json:\"is_platform_access_only,bool\"`\n    Name             string `json:\"name\"`\n}\n\n// AppUser holds the newly created AppUser\ntype AppUserResponse struct {\n    Usertype      string  `json:\"type\"`\n    ID            string  `json:\"id\"`\n    Name          string  `json:\"name\"`\n    Login         string  `json:\"login\"`\n    CreatedAt     string  `json:\"created_at\"`\n    ModifiedAt    string  `json:\"modified_at\"`\n    Language      string  `json:\"language\"`\n    Timezone      string  `json:\"timezone\"`\n    SpaceAmount   float32 `json:\"space_amount\"`\n    SpaceUsed     float32 `json:\"space_used\"`\n    MaxUploadSize float32 `json:\"max_upload_size\"`\n    Status        string  `json:\"status\"`\n    JobTitle      string  `json:\"job_title\"`\n    Phone         string  `json:\"phone\"`\n    Address       string  `json:\"address\"`\n    AvatarURL     string  `json:\"avatar_url\"`\n}\n\n// Client - holds main client details\ntype Client struct {\n    _PublicKeyID  string\n    _ClientID     string\n    _ClaimSub     string\n    _ClientSecret string\n}\n\n\n// CreateJWTAssertion - build up the JSON Web Token for oAuth\nfunc CreateJWTAssertion(PublicKeyID string, ClientID string, Sub string, user *AppUserResponse, keyPath string) (string, error) {\n\n    var signingKey []byte\n    var err error\n    var msg, tokenString string\n\n    signingKey, err = ioutil.ReadFile(keyPath)\n\n    if err != nil {\n        msg = \"Unable to read signing key. Please ensure your private signing key is in the ./keys/ directory\"\n        return msg, err\n    }\n\n    // Generate JTI Value\n    jti, err := exec.Command(\"uuidgen\").Output()\n    if err != nil {\n        msg = \"Unable to generate JTI value\"\n        return msg, err\n    }   \n\n    token := jwt.New(jwt.SigningMethodHS256)\n    claims := make(jwt.MapClaims)\n    token.Header[\"alg\"] = \"HS256\"\n    token.Header[\"typ\"] = \"JWT\"\n    token.Header[\"kid\"] = PublicKeyID\n    claims[\"iss\"] = ClientID\n    claims[\"aud\"] = JWTAUTHURL\n    claims[\"jti\"] = jti\n    claims[\"exp\"] = time.Now().Add(time.Second * 45).Unix()\n\n    // Create the JWT either for the enterprise or for a specific user.\n    if user.ID != \"\" {\n        claims[\"box_sub_type\"] = \"user\"\n        claims[\"sub\"] = user.ID\n    } else {\n        claims[\"box_sub_type\"] = \"enterprise\"\n        claims[\"sub\"] = Sub\n    }\n    token.Claims = claims\n\n    // Sign the JWT\n    tokenString, err = token.SignedString(signingKey)\n\n    if err != nil {\n        msg = \"Unable to sign token, please check that you have a signing key in ./keys/\"\n        return msg, err\n    }\n\n    return tokenString, err\n}\n\n// SendOAuthRequest - Sends a POST to authenticate against Box using JWT Assertion\nfunc SendOAuthRequest(ClientID string, ClientSecret string, JWToken string) (string, error) {\n\n    var err error\n    var msg string\n    var decodedResponse *oAuthResponse\n\n    hc := http.Client{}\n    form := url.Values{}\n\n    // Build form to POST\n    form.Add(\"grant_type\", JWTGRANTTYPE)\n    form.Add(\"client_id\", ClientID)\n    form.Add(\"client_secret\", ClientSecret)\n    form.Add(\"assertion\", JWToken)\n\n    // Here is where the code stops working, returns an empty body\n    // The request looks like it should be working\n    req, err := http.NewRequest(\"POST\", JWTAUTHURL, strings.NewReader(form.Encode()))\n\n    //\n    req.Close = true\n    //\n\n    req.PostForm = form\n    req.Header.Add(\"Content-Type\", \"application/x-www-form-urlencoded\")\n    if err != nil {\n        return msg, err\n    }\n\n    //\n    fmt.Println(req)\n    //\n\n    resp, err := hc.Do(req)\n    if err != nil {\n        msg = \"Error submitting request to Box API\"\n        return msg, err\n    }\n    defer resp.Body.Close()\n\n    // Debugging the HTTP requests and responses here\n    //fmt.Println(resp)\n    fmt.Println(resp.Status)\n    fmt.Println(resp.Body)\n    //\n\n    err = json.NewDecoder(resp.Body).Decode(&amp;decodedResponse)\n\n    if err != nil {\n        msg = \"Error decoding OAuthResponse\"\n    } else {\n        // We only need the Access Token\n        msg = decodedResponse.AccessToken\n    }\n\n    return msg, err\n}\n</code></pre>\n\n<p>The HTTP response and response body look as follows: </p>\n\n<pre><code>400 Bad Request\n&amp;{0xc4202be0c0 {0 0} false &lt;nil&gt; 0x5f48b0 0x5f4840}\n</code></pre>\n\n<p>My HTTP request is as follows:</p>\n\n<pre><code>&amp;{POST https://api.box.com/oauth2/token HTTP/1.1 1 1 \nmap[Content-Type:[application/x-www-form-urlencoded]] \n{0xc4200f06c0} 0x5f3e90 1125 [] true api.box.com map[] \nmap[client_id:[***Client ID Here***] client_secret:[***Client Secret Here***] \nassertion:[***JWT Here***] \ngrant_type:[urn:ietf:params:oauth:grant-type:jwt-bearer]] \n&lt;nil&gt; map[]   &lt;nil&gt; &lt;nil&gt; &lt;nil&gt; &lt;nil&gt;}\n</code></pre>\n"}, {"tags": ["javascript", "go", "webpack", "vue.js", "mux"], "comments": [{"owner": {"reputation": 946, "user_id": 2867168, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/87931c389a65679729f2a9a153d3e111?s=128&d=identicon&r=PG&f=1", "display_name": "MisutoWolf", "link": "https://stackoverflow.com/users/2867168/misutowolf"}, "edited": false, "score": 0, "creation_date": 1529350185, "post_id": 50916117, "comment_id": 88832533, "body": "It feels as if this is due to Webpack assuming there&#39;s an ExpressJS server with middleware set up to handle this, and that I would need something like that for the Go server to deal with the <code>__webpack_hmr</code> request, but there isn&#39;t a handler, so maybe that&#39;s the problem?  If so, I have zero idea how to fix it, unless it&#39;s something I would need a Go package for."}], "answers": [{"comments": [{"owner": {"reputation": 946, "user_id": 2867168, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/87931c389a65679729f2a9a153d3e111?s=128&d=identicon&r=PG&f=1", "display_name": "MisutoWolf", "link": "https://stackoverflow.com/users/2867168/misutowolf"}, "edited": false, "score": 0, "creation_date": 1529354972, "post_id": 50917210, "comment_id": 88834535, "body": "The thing is, I want hot-reloading, I&#39;m wanting HMR functionality while I work on this stuff in dev mode, so I would think that&#39;d be the opposite of what I want to do."}, {"owner": {"reputation": 4567, "user_id": 1318734, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/S3JJ2.gif?s=128&g=1", "display_name": "rofls", "link": "https://stackoverflow.com/users/1318734/rofls"}, "reply_to_user": {"reputation": 946, "user_id": 2867168, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/87931c389a65679729f2a9a153d3e111?s=128&d=identicon&r=PG&f=1", "display_name": "MisutoWolf", "link": "https://stackoverflow.com/users/2867168/misutowolf"}, "edited": false, "score": 0, "creation_date": 1529357265, "post_id": 50917210, "comment_id": 88835444, "body": "OK, I thought it was working to your satisfaction based on: <code>Maybe this is more complicated to set up than I thought it was, or since it seems to be &quot;working&quot;, I can safely ignore this error? I dunno.</code>"}], "tags": [], "owner": {"reputation": 4567, "user_id": 1318734, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/S3JJ2.gif?s=128&g=1", "display_name": "rofls", "link": "https://stackoverflow.com/users/1318734/rofls"}, "is_accepted": false, "score": 0, "last_activity_date": 1529357531, "last_edit_date": 1529357531, "creation_date": 1529354715, "answer_id": 50917210, "question_id": 50916117, "link": "https://stackoverflow.com/questions/50916117/failure-to-connect-to-localhost3000-from-web-application/50917210#50917210", "title": "Failure to connect to localhost:3000 from web application", "body": "<p>Remove <code>'webpack-hot-middleware/client'</code> from your webpack config and any references in your codebase. This is only used for hot reloading, so it's safe to remove it.</p>\n\n<p>Since you need hot reloading, you should use: <a href=\"https://github.com/go-webpack/webpack\" rel=\"nofollow noreferrer\">https://github.com/go-webpack/webpack</a></p>\n\n<blockquote>\n  <p>This module allows proper integration with webpack, with support for proper assets reloading in development and asset hashes for production caching.</p>\n</blockquote>\n\n<p>However they only show examples using <code>Gin</code> and <code>Iris</code>, so you may need to open an issue with them for an example based on purely <code>net/http</code> (assuming that's what you're using).</p>\n"}, {"tags": [], "owner": {"reputation": 234, "user_id": 2849149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o3uGA.png?s=128&g=1", "display_name": "Snehal Dangroshiya", "link": "https://stackoverflow.com/users/2849149/snehal-dangroshiya"}, "is_accepted": false, "score": 0, "last_activity_date": 1529405178, "last_edit_date": 1529405178, "creation_date": 1529390339, "answer_id": 50922045, "question_id": 50916117, "link": "https://stackoverflow.com/questions/50916117/failure-to-connect-to-localhost3000-from-web-application/50922045#50922045", "title": "Failure to connect to localhost:3000 from web application", "body": "<p>if I understand your issue correctly. your client and server use a different port and if it is the case then you're using CORS(Cross-Origin Resource Sharing) request to communicate with client-server. \nsee the following links hope it will help you to fix CORS issue(It helps me a lot)</p>\n\n<ul>\n<li><a href=\"https://github.com/gorilla/handlers\" rel=\"nofollow noreferrer\">https://github.com/gorilla/handlers</a></li>\n<li><a href=\"https://github.com/rs/cors\" rel=\"nofollow noreferrer\">https://github.com/rs/cors</a></li>\n</ul>\n"}], "owner": {"reputation": 946, "user_id": 2867168, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/87931c389a65679729f2a9a153d3e111?s=128&d=identicon&r=PG&f=1", "display_name": "MisutoWolf", "link": "https://stackoverflow.com/users/2867168/misutowolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 972, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1529405178, "creation_date": 1529349409, "last_edit_date": 1529405165, "question_id": 50916117, "link": "https://stackoverflow.com/questions/50916117/failure-to-connect-to-localhost3000-from-web-application", "title": "Failure to connect to localhost:3000 from web application", "body": "<p>I'm working on some boilerplate code to get a VueJS frontend working with a Go-powered backend (using <code>gorilla/mux</code> for a router):</p>\n\n<p>Currently, I seem to have everything working for the most part. I'm serving a static HTML file via Go and rendering Vue stuff with it that's being bundled with webpack (webpack-dev-server currently, not a physical bundle), and I'm having a weird issue:</p>\n\n<p>In my browser, Firefox keeps telling me the following:</p>\n\n<p><code>Firefox can\u2019t establish a connection to the server at http://localhost:3000/__webpack_hmr.</code></p>\n\n<p>Yet, when I change Vue components and save them, they're auto-refreshing in the browser as I would expect.  I'm really confused, I guess, I don't know why this is happening.</p>\n\n<p>I've tried changing the port that my Go server operates on, and it always seems to fail connection at <code>http://localhost:&lt;Go Server Port&gt;/__webpack_hmr</code>.</p>\n\n<p>Any thoughts?  Maybe there's a step I'm missing or the setup is more complicated than I thought it was.</p>\n\n<p>Do I need to be running an Express server and using the webpack-based Middleware to fix this error?  If so, that sounds silly if I'm using Go for the backend (why would I run two servers?).  Am I doing something wrong?</p>\n\n<p>As for the Go side of things, I've tried both running the Go server on a different port and having the webpack server run on different ports and such, but it always fails to connect at <code>http://localhost:&lt;Go Server Port&gt;/__webpack_hmr</code>.  </p>\n\n<p>Maybe this is more complicated to set up than I thought it was, or since it seems to be \"working\", I can safely ignore this error?  I dunno.</p>\n"}, {"tags": ["go", "reflection"], "answers": [{"comments": [{"owner": {"reputation": 3680, "user_id": 7723882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6aUwy.png?s=128&g=1", "display_name": "Matias Barrios", "link": "https://stackoverflow.com/users/7723882/matias-barrios"}, "edited": false, "score": 0, "creation_date": 1529348075, "post_id": 50915640, "comment_id": 88831566, "body": "Hey im trying to do the same for Null now, and its not working. Is not workign with nil either."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 3680, "user_id": 7723882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6aUwy.png?s=128&g=1", "display_name": "Matias Barrios", "link": "https://stackoverflow.com/users/7723882/matias-barrios"}, "edited": false, "score": 3, "creation_date": 1529355216, "post_id": 50915640, "comment_id": 88834633, "body": "@MatiasBarrios: You need to compare <code>Result.Type</code> with <code>gjson.Null</code>. It&#39;s possible, however, that what you believe is <code>null</code> might be some other value. Print the entire object to confirm."}, {"owner": {"reputation": 3680, "user_id": 7723882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6aUwy.png?s=128&g=1", "display_name": "Matias Barrios", "link": "https://stackoverflow.com/users/7723882/matias-barrios"}, "edited": false, "score": 0, "creation_date": 1529377069, "post_id": 50915640, "comment_id": 88839682, "body": "you were right. It was a string with the literal text &quot;null&quot;"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 5, "last_activity_date": 1529347279, "creation_date": 1529347279, "answer_id": 50915640, "question_id": 50915572, "link": "https://stackoverflow.com/questions/50915572/reflect-to-test-if-a-value-is-a-string/50915640#50915640", "title": "Reflect to test if a value is a string", "body": "<p><code>gjson.Get</code> returns a <a href=\"https://godoc.org/github.com/tidwall/gjson#Result\" rel=\"noreferrer\"><code>Result</code></a>, so you can simply check its <code>Type</code> field:</p>\n\n<pre><code>if gjson.Get(input, \"name\").Type != gjson.String {\n    return \"Not a string!\"  \n}\n</code></pre>\n"}], "owner": {"reputation": 3680, "user_id": 7723882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6aUwy.png?s=128&g=1", "display_name": "Matias Barrios", "link": "https://stackoverflow.com/users/7723882/matias-barrios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 50915640, "answer_count": 1, "score": 1, "last_activity_date": 1529366238, "creation_date": 1529347011, "last_edit_date": 1529366238, "question_id": 50915572, "link": "https://stackoverflow.com/questions/50915572/reflect-to-test-if-a-value-is-a-string", "title": "Reflect to test if a value is a string", "body": "<p>I'm trying to test if a value coming from the gjson library is a string in the quickest and simplest way possible. I don't want to use a switch type assertion.</p>\n\n<pre><code>if reflect.TypeOf(gjson.Get(input, \"name\").Value()) != \"string\" {\n    return \"Not a string!\"  \n}\n</code></pre>\n\n<p>What's wrong with my code? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 7, "creation_date": 1529345981, "post_id": 50915310, "comment_id": 88830640, "body": "No, because you need to check and handle the error before you attempt to use the value returned."}], "answers": [{"tags": [], "owner": {"reputation": 2208, "user_id": 5328069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21DZ0.jpg?s=128&g=1", "display_name": "morganbaz", "link": "https://stackoverflow.com/users/5328069/morganbaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1529400793, "creation_date": 1529400793, "answer_id": 50925024, "question_id": 50915310, "link": "https://stackoverflow.com/questions/50915310/pass-two-return-values-to-function-with-one-argument/50925024#50925024", "title": "Pass two return values to function with one argument", "body": "<p>The idiomatic way to do it in Go is to handle the error gracefully with the usual <code>if err != nil</code>. Use it.</p>\n\n<pre><code>reader := bufio.NewReader(strings.NewReader(\"93 31 11 11\"))\nnumRaw, err := reader.ReadString(' ')\nif err != nil {\n    log.Fatal(err)\n}\n// We need to substring numRaw because it contains also the trailing space (this is how ReadString works in bufio.Reader)\nnum, err := strconv.Atoi(numRaw[:len(numRaw)-1])\nif err != nil {\n    log.Fatal(err)\n}\nlog.Print(num)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/sHvM89dCKv5\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<p>If you want to make the code \"cleaner\", split it into functions.</p>\n\n<pre><code>func main() {\n    reader := bufio.NewReader(strings.NewReader(\"93 31 11 11\"))\n    n, err := readInt(reader)\n    if err != nil {\n        log.Fatal(err)\n    }\n    log.Print(n)\n}\n\nfunc readInt(r *bufio.Reader) (int, error) {\n    numRaw, err := r.ReadString(' ')\n    if err != nil {\n        return 0, err\n    }\n    return strconv.Atoi(numRaw[:len(numRaw)-1])\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/CRDRbinhidm\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<hr>\n\n<p>For sake of completeness, there are some cases where it is useful to ignore the error because you know there won't be any. Such cases include parser which are always given the same input, ie. regexes and templates. These provide the useful idiom \"Must\": for instance, <a href=\"https://golang.org/pkg/regexp/#MustCompile\" rel=\"nofollow noreferrer\"><code>regexp.MustCompile</code></a> is a very simple wrapper around <code>regexp.Compile</code>, which checks the error and panics if it's not nil.</p>\n\n<pre><code>func MustCompile(str string) *Regexp {\n    regexp, error := Compile(str)\n    if error != nil {\n        panic(`regexp: Compile(` + quote(str) + `): ` + error.Error())\n    }\n    return regexp\n}\n</code></pre>\n\n<p>This is most often seen in Go programs when there is a regex which is used as a singleton and is declared in the global scope.</p>\n\n<pre><code>var usernameRegex = regexp.MustCompile(\"^[0-9A-Za-z-]+$\")\n\nfunc main() {\n    fmt.Println(usernameRegex.MatchString(\"Hello\"))\n    fmt.Println(usernameRegex.MatchString(\"\"))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/huJn-phYxCP\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<p>To help think about when it is useful to use or add a \"Must\" function, I think of it as \"If there was a way in Go to add a compile-time check, this would be a good place to use it\".</p>\n\n<p>As I said, this is also provided in the template packages of the Go standard library, such as <code>html/template</code>. These don't provide a Must- function for everything, but they have a simple <a href=\"https://golang.org/pkg/html/template/#Must\" rel=\"nofollow noreferrer\"><code>template.Must</code></a> function (which is closer to what you were trying to do in the OP). This way you can \"chain\" functions which would normally return a template and an error, so that they only return the template (and panic if there is any error).</p>\n\n<pre><code>var t = template.Must(template.New(\"hi\").Parse(`{{ if .Bool }}Hello{{ else }}Goodbye{{ end }} world!`))\n\nfunc main() {\n    t.ExecuteTemplate(os.Stdout, \"hi\", struct{Bool bool}{Bool: false})\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/4gSKTbTqXUJ\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<p>This works, because <code>template.Must</code> has a signature <code>func(*Template, error)</code>, and <code>Parse</code> returns <code>(*Template, error)</code>, so return values and function arguments match. For instance, your example could have worked if <code>strconv.Atoi</code> had the signature <code>func(string, error)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2208, "user_id": 5328069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21DZ0.jpg?s=128&g=1", "display_name": "morganbaz", "link": "https://stackoverflow.com/users/5328069/morganbaz"}, "edited": false, "score": 0, "creation_date": 1529443535, "post_id": 50929648, "comment_id": 88872746, "body": "(as a side note, I made up the example string to demonstrate reading the first number. we don&#39;t know how the original data is formatted, not even if it is a sequence of numbers, so while your objection holds, I would argue it&#39;s out of scope for the question)"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 0, "last_activity_date": 1529415380, "last_edit_date": 1529415380, "creation_date": 1529414707, "answer_id": 50929648, "question_id": 50915310, "link": "https://stackoverflow.com/questions/50915310/pass-two-return-values-to-function-with-one-argument/50929648#50929648", "title": "Pass two return values to function with one argument", "body": "<p>In Go, write a <code>readInt</code> function to hide the complexity and always check for errors. Other answers have bugs: <a href=\"https://stackoverflow.com/a/50925024/221700\">Howl</a> (drops last number) and <a href=\"https://stackoverflow.com/a/50915468/221700\">Raduan Santos</a> (doesn't compile).</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc readInt(r *bufio.Reader) (int, error) {\n    const delim = ' '\n    str, err := r.ReadString(delim)\n    if err != nil &amp;&amp; len(str) == 0 {\n        return 0, err\n    }\n    str = strings.TrimSuffix(str, string(delim))\n    return strconv.Atoi(str)\n}\n\nfunc main() {\n    input := \"93 31 11 11\"\n    fmt.Println(input)\n    rdr := bufio.NewReader(strings.NewReader(input))\n    for {\n        n, err := readInt(rdr)\n        if err != nil {\n            if err == io.EOF {\n                break\n            }\n            log.Fatal(err)\n        }\n        fmt.Println(n)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>93 31 11 11\n93\n31\n11\n11\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6894692, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nK9sw3vxjAI/AAAAAAAAAAI/AAAAAAAAAMo/IJQr5q-X5Fw/photo.jpg?sz=128", "display_name": "Honza Nijak&#253;", "link": "https://stackoverflow.com/users/6894692/honza-nijak%c3%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 1, "accepted_answer_id": 50929648, "answer_count": 2, "score": -2, "last_activity_date": 1529415380, "creation_date": 1529345879, "last_edit_date": 1529406050, "question_id": 50915310, "link": "https://stackoverflow.com/questions/50915310/pass-two-return-values-to-function-with-one-argument", "title": "Pass two return values to function with one argument", "body": "<p>I want to do this:</p>\n\n<pre><code>R, _ := strconv.Atoi(reader.ReadString(\" \")) // reader = bufio.NewReader()\n</code></pre>\n\n<p>and the problem is, that strconv.Atoi expects one argument, but reader.ReadString() returns not only the string, but also the \"err\". Is there a way to solve this without creating variables or generally on just one line?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1529339896, "post_id": 50913924, "comment_id": 88828000, "body": "infinetly (infinitely?) or for a few seconds ? can&#39;t be both."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1529340103, "post_id": 50913924, "comment_id": 88828094, "body": "There is never a reason to use a busy loop in your code."}, {"owner": {"reputation": 3, "user_id": 9957793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b92c92a3f4f10b11e0da7f991f1645fa?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/9957793/john-doe"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1529340232, "post_id": 50913924, "comment_id": 88828158, "body": "@JimB I know, that is only for testing purposes as otherwise the program exits before goroutines are executed"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1529340353, "post_id": 50913924, "comment_id": 88828203, "body": "@JohnDoe: incorrect code for testing purposes is still incorrect code."}], "answers": [{"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": true, "score": 3, "last_activity_date": 1529340075, "creation_date": 1529340075, "answer_id": 50914016, "question_id": 50913924, "link": "https://stackoverflow.com/questions/50913924/goroutine-executes-a-few-seconds-but-stops/50914016#50914016", "title": "Goroutine executes a few seconds but stops", "body": "<p>This is because for now (go 1.10) Go's scheduler is not preemptive, and there is no plans to make it so.</p>\n\n<p>What this means is that Go's scheduler can stuck in some rare cases, where that there is an infinte loop doing nothing Go's schedule feels like to interupt. And that includes an empty infinite loop.</p>\n\n<p>To block the goroutine for test, use <code>select{}</code> instead of <code>for {}</code>.</p>\n\n<p>References: </p>\n\n<p><a href=\"https://github.com/golang/go/issues/11462\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/11462</a></p>\n\n<p><a href=\"https://github.com/golang/go/issues/10958\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/10958</a></p>\n"}, {"comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1529340246, "post_id": 50914024, "comment_id": 88828161, "body": "Nope. The only thing that fixes the problem is the <code>select{}</code> in the main func. No <code>time.Sleep</code> is ok."}, {"owner": {"reputation": 3, "user_id": 9957793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b92c92a3f4f10b11e0da7f991f1645fa?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/9957793/john-doe"}, "edited": false, "score": 0, "creation_date": 1529340306, "post_id": 50914024, "comment_id": 88828180, "body": "I see, why did you add a Sleep() function on the goroutines?"}, {"owner": {"reputation": 476, "user_id": 5065312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f77cad3f3081a18d4645f5579a9f1e?s=128&d=identicon&r=PG&f=1", "display_name": "VasileM", "link": "https://stackoverflow.com/users/5065312/vasilem"}, "edited": false, "score": 0, "creation_date": 1529341761, "post_id": 50914024, "comment_id": 88828856, "body": "To avoid CPU burning and see and understand better what happens."}], "tags": [], "owner": {"reputation": 476, "user_id": 5065312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f77cad3f3081a18d4645f5579a9f1e?s=128&d=identicon&r=PG&f=1", "display_name": "VasileM", "link": "https://stackoverflow.com/users/5065312/vasilem"}, "is_accepted": false, "score": 0, "last_activity_date": 1529340089, "creation_date": 1529340089, "answer_id": 50914024, "question_id": 50913924, "link": "https://stackoverflow.com/questions/50913924/goroutine-executes-a-few-seconds-but-stops/50914024#50914024", "title": "Goroutine executes a few seconds but stops", "body": "<p>You are burning CPU with the empty <code>for</code> loop\nUse <code>select</code> instead <code>for</code></p>\n\n<pre><code>import (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    go routine()\n    go routine2()\n\n    fmt.Println(\"I am not interrupted by Go routine :)\")\n    select{}\n}\n\nfunc routine() {\n    for {\n        fmt.Println(\"hello, world!\")\n        time.Sleep(time.Second)\n    }\n}\n\nfunc routine2() {\n    for {\n        fmt.Println(\"hello, world222\")\n        time.Sleep(time.Second)\n    }\n}\n</code></pre>\n\n<p>Your code is okay, never stops but it's correct.</p>\n"}], "owner": {"reputation": 3, "user_id": 9957793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b92c92a3f4f10b11e0da7f991f1645fa?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/9957793/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "closed_date": 1529360039, "accepted_answer_id": 50914016, "answer_count": 2, "score": 0, "last_activity_date": 1529360050, "creation_date": 1529339675, "last_edit_date": 1529340161, "question_id": 50913924, "link": "https://stackoverflow.com/questions/50913924/goroutine-executes-a-few-seconds-but-stops", "closed_reason": "Duplicate", "title": "Goroutine executes a few seconds but stops", "body": "<p>I'm currently learning golang and I've tried the following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    go routine()\n    go routine2()\n\n    fmt.Println(\"I am not interrupted by Go routine :)\")\n\n    for {\n\n    }\n}\n\nfunc routine() {\n    for {\n        fmt.Println(\"hello, world!\")\n    }\n}\n\nfunc routine2() {\n    for {\n        fmt.Println(\"hello, world222\")\n    }\n}\n</code></pre>\n\n<p>When I run this program, I get as output: <code>\"hello, world\"</code> and <code>\"hello, world222\"</code> for a few seconds. However, after a few seconds, I don't get anything anymore however the program is still running. </p>\n\n<p>What's wrong? Why does the program stop displaying <code>hello, world</code> and <code>hello, world222</code> ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1529338221, "post_id": 50913527, "comment_id": 88827215, "body": "You cannot override the tag as you already noted, so I&#39;m not sure what you&#39;re actually asking here."}], "answers": [{"comments": [{"owner": {"reputation": 1306, "user_id": 5705686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jYuOhkTQVgQ/AAAAAAAAAAI/AAAAAAAAA1A/v5x1CDU6W4s/photo.jpg?sz=128", "display_name": "dolan", "link": "https://stackoverflow.com/users/5705686/dolan"}, "edited": false, "score": 0, "creation_date": 1529346636, "post_id": 50913943, "comment_id": 88830947, "body": "Good to know.  I didn&#39;t know about <code>MarshalYAML()</code>. This does have the same problem as above though because I can&#39;t define a method on a struct that is defined in another package."}], "tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": true, "score": 1, "last_activity_date": 1529339724, "creation_date": 1529339724, "answer_id": 50913943, "question_id": 50913527, "link": "https://stackoverflow.com/questions/50913527/override-struct-field-tags-on-imported-structs/50913943#50913943", "title": "Override struct field tags on imported structs", "body": "<p>I have always had problems with <code>go-yaml</code>. The library is not in a good design. However it is the most effective tool at hand, at least for now.</p>\n\n<p>There is some way to hide from <code>encoding/json</code> but I tested it does not work for <code>go-yaml</code>. However, <code>go-yaml</code> does provide a way to extend its capacity (though it is very awkward).</p>\n\n<p>As I see in your code, that <code>Partitioner</code> is of type <code>PartitionerConstructor</code>, a custom type, so you can make <code>PartitionerConstructor</code> implents <code>yaml.Marshaler</code> interface:</p>\n\n<pre><code>func (PartitionerConstructor) MarshalYAML() (interface{},error) {\n        return nil,nil\n}\n</code></pre>\n\n<p>Note that it will generate a <code>Partitioner: null</code> line, but it will get around from panic.</p>\n"}], "owner": {"reputation": 1306, "user_id": 5705686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jYuOhkTQVgQ/AAAAAAAAAAI/AAAAAAAAA1A/v5x1CDU6W4s/photo.jpg?sz=128", "display_name": "dolan", "link": "https://stackoverflow.com/users/5705686/dolan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 0, "accepted_answer_id": 50913943, "answer_count": 1, "score": 0, "last_activity_date": 1529339724, "creation_date": 1529338114, "question_id": 50913527, "link": "https://stackoverflow.com/questions/50913527/override-struct-field-tags-on-imported-structs", "title": "Override struct field tags on imported structs", "body": "<p>I have a third party client library (<a href=\"https://github.com/Shopify/sarama\" rel=\"nofollow noreferrer\">Sarama</a>) that exposes <a href=\"https://github.com/Shopify/sarama/blob/e42dc76/config.go\" rel=\"nofollow noreferrer\">a configuration struct</a>.</p>\n\n<p>I want to reference that struct directly from my configuration struct:</p>\n\n<pre><code>type MyConfig struct {\n  Sarama sarama.Config\n}\n</code></pre>\n\n<p>I am using <a href=\"https://github.com/go-yaml/yaml\" rel=\"nofollow noreferrer\">go-yaml</a> to marshal my configuration. Marshalling <code>MyConfig</code> with go-yaml panics because <code>sarama.Config</code> contains a field (<code>Partitioner</code>) that is of type <code>func</code> and the yaml parser doesn't know how to <code>Marshal</code> a <code>func</code>.</p>\n\n<p>A way of preventing this panic would be to tell go-yaml to ignore this field (using the tag <code>yaml:\"-\"</code> on the field) but I am unable to set tags on a struct that isn't defined in my code.</p>\n\n<p>Is there an elegant go way to include this configuration in my own configuration and not cause the go-yaml marshaller to panic? Should I try and override the tag or should I copy the struct into my own code and write a converter?  </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1385, "user_id": 4464551, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10206253300199979/picture?type=large", "display_name": "Felix Ros&#233;n", "link": "https://stackoverflow.com/users/4464551/felix-ros%c3%a9n"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1529337269, "post_id": 50913260, "comment_id": 88826684, "body": "@tkausl String are immutable?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1529337315, "post_id": 50913260, "comment_id": 88826704, "body": "With syntax fixed, the code replaces the byte at <code>randPos</code> with <code>randLetter</code>.  Does the code have unexpected results when you run it?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1529337769, "post_id": 50913260, "comment_id": 88826982, "body": "I assume the example is a typo since it can&#39;t compile at all -- please show the actual code and explain what isn&#39;t working as expected."}, {"owner": {"reputation": 808, "user_id": 9918920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22d5c341f8bc02011a0e36bdf3d46082?s=128&d=identicon&r=PG&f=1", "display_name": "manan5439", "link": "https://stackoverflow.com/users/9918920/manan5439"}, "edited": false, "score": 0, "creation_date": 1529337888, "post_id": 50913260, "comment_id": 88827040, "body": "right i didnt under sand what you want"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 4, "creation_date": 1529337911, "post_id": 50913260, "comment_id": 88827052, "body": "Note that indexing a string may give unexpected behavior when dealing with multi-byte characters, as strings are indexed by byte, not by rune."}], "answers": [{"comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1529340561, "post_id": 50913744, "comment_id": 88828300, "body": "well, what your code does is replace a rune, so why do you name the func as <code>insertChar</code>?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1529345309, "post_id": 50913744, "comment_id": 88830367, "body": "@leafbebop: A Go <code>rune</code> is a Unicode codepoint, often called a character. See <a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">The Go Blog: Strings, bytes, runes and characters in Go</a> and <a href=\"http://unicode.org/\" rel=\"nofollow noreferrer\">The Unicode Consortium</a>."}, {"owner": {"reputation": 2195, "user_id": 2739334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5b6ca1ae0bd6f90024369c7d6c6800aa?s=128&d=identicon&r=PG&f=1", "display_name": "Spektakulatius", "link": "https://stackoverflow.com/users/2739334/spektakulatius"}, "edited": false, "score": 0, "creation_date": 1529417470, "post_id": 50913744, "comment_id": 88859927, "body": "Please stop using just a single character as variable name."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 2195, "user_id": 2739334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5b6ca1ae0bd6f90024369c7d6c6800aa?s=128&d=identicon&r=PG&f=1", "display_name": "Spektakulatius", "link": "https://stackoverflow.com/users/2739334/spektakulatius"}, "edited": false, "score": 0, "creation_date": 1529418420, "post_id": 50913744, "comment_id": 88860559, "body": "@Code.IT: No. Read the Go standard library for idiomatic Go. From a Go Tech Lead: <a href=\"https://research.swtch.com/names\" rel=\"nofollow noreferrer\">Names</a>."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 2195, "user_id": 2739334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5b6ca1ae0bd6f90024369c7d6c6800aa?s=128&d=identicon&r=PG&f=1", "display_name": "Spektakulatius", "link": "https://stackoverflow.com/users/2739334/spektakulatius"}, "edited": false, "score": 0, "creation_date": 1529420017, "post_id": 50913744, "comment_id": 88861585, "body": "@Code.IT: That&#39;s an opinion. Primarily opinion-based questions are not permitted on Stack Overflow. They are closed."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1529338992, "creation_date": 1529338992, "answer_id": 50913744, "question_id": 50913260, "link": "https://stackoverflow.com/questions/50913260/replace-a-character-at-a-specific-location-in-a-string/50913744#50913744", "title": "Replace a character at a specific location in a string", "body": "<p>UTF-8 is a variable-length encoding. For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc insertChar(s string, c rune, i int) string {\n    if i &gt;= 0 {\n        r := []rune(s)\n        if i &lt; len(r) {\n            r[i] = c\n            s = string(r)\n        }\n    }\n    return s\n}\n\nfunc main() {\n    s := \"Hello, \u4e16\u754c\"\n    fmt.Println(s)\n    s = insertChar(s, 'X', len([]rune(s))-1)\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Hello, \u4e16\u754c\nHello, \u4e16X\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16298, "user_id": 308679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GCNYS.jpg?s=128&g=1", "display_name": "J&#252;rgen H&#246;tzel", "link": "https://stackoverflow.com/users/308679/j%c3%bcrgen-h%c3%b6tzel"}, "is_accepted": false, "score": 0, "last_activity_date": 1529342167, "creation_date": 1529342167, "answer_id": 50914525, "question_id": 50913260, "link": "https://stackoverflow.com/questions/50913260/replace-a-character-at-a-specific-location-in-a-string/50914525#50914525", "title": "Replace a character at a specific location in a string", "body": "<p>A <code>string</code> is a read-only slice of bytes. You can't replace anything.</p>\n\n<p>A single <code>Rune</code> can consist of multiple bytes. So you should convert the <code>string</code> to a (intermediate) mutable slice of <code>Runes</code> anyway:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>myText := []rune(\"This is my text\")\nrandPos := rand.Intn(len(myText) - 1)\nmyText[randPos] = randLetter\nfmt.Println(string(myText))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2195, "user_id": 2739334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5b6ca1ae0bd6f90024369c7d6c6800aa?s=128&d=identicon&r=PG&f=1", "display_name": "Spektakulatius", "link": "https://stackoverflow.com/users/2739334/spektakulatius"}, "is_accepted": false, "score": 1, "last_activity_date": 1529417989, "creation_date": 1529417989, "answer_id": 50930705, "question_id": 50913260, "link": "https://stackoverflow.com/questions/50913260/replace-a-character-at-a-specific-location-in-a-string/50930705#50930705", "title": "Replace a character at a specific location in a string", "body": "<p>I've written some code to replace the character found at <code>indexofcharacter</code> with the <code>replacement</code>. I may not be the best method, but it works fine. </p>\n\n<p><a href=\"https://play.golang.org/p/9CTgHRm6icK\" rel=\"nofollow noreferrer\">https://play.golang.org/p/9CTgHRm6icK</a></p>\n\n<pre><code>func replaceAtPosition(originaltext string, indexofcharacter int, replacement string) string {\n    runes := []rune(originaltext )\n    partOne := string(runes[0:indexofcharacter-1])\n    partTwo := string(runes[indexofcharacter:len(runes)])\n    return partOne + replacement + partTwo\n}\n</code></pre>\n"}], "owner": {"reputation": 1385, "user_id": 4464551, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10206253300199979/picture?type=large", "display_name": "Felix Ros&#233;n", "link": "https://stackoverflow.com/users/4464551/felix-ros%c3%a9n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1529417989, "creation_date": 1529337165, "question_id": 50913260, "link": "https://stackoverflow.com/questions/50913260/replace-a-character-at-a-specific-location-in-a-string", "title": "Replace a character at a specific location in a string", "body": "<p>I know about the method <code>string.Replace()</code>. And it works if you know exactly what to replace and its occurrences. But what can I do if I want to replace a char at only a known position? I'm thinking of something like this:</p>\n\n<pre><code>randLetter := getRandomChar()\n\nmyText := \"This is my text\"\n\nrandPos :=  rand.Intn(len(myText) - 1)\n\nnewText := [:randPos] + randLetter + [randPos + 1:]\n</code></pre>\n\n<p>But this does not replace the char at <code>randPos</code>, just inserts the <code>randLetter</code> at that position. Right?</p>\n"}, {"tags": ["go", "stack-overflow"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1529334587, "post_id": 50912505, "comment_id": 88825112, "body": "If <code>ReportElement</code> has pointers to child nodes and to the parent, it means that the data structure has cycles."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1529334743, "creation_date": 1529334743, "answer_id": 50912598, "question_id": 50912505, "link": "https://stackoverflow.com/questions/50912505/struct-json-marshaling-causing-stack-overflow/50912598#50912598", "title": "Struct Json Marshaling Causing stack overflow", "body": "<p>You have multiple infinite loops due to the parent/child pointers. Each parent points to its children, which point back to their parent. Note that when deserialized, multiple pointers to the same object will end up being multiple separate objects, which likely is not what you want.</p>\n"}], "owner": {"reputation": 1322, "user_id": 7533177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YtNtF.jpg?s=128&g=1", "display_name": "Simon Frey", "link": "https://stackoverflow.com/users/7533177/simon-frey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 50912598, "answer_count": 1, "score": 0, "last_activity_date": 1529334743, "creation_date": 1529334419, "question_id": 50912505, "link": "https://stackoverflow.com/questions/50912505/struct-json-marshaling-causing-stack-overflow", "title": "Struct Json Marshaling Causing stack overflow", "body": "<p><strong>Problem</strong></p>\n\n<p>When I use the NewChild() function in my code and than afterwards marshal the \"Report\" Struct to JSON I get a Stack Overflow (goroutine stack exceeds 1000000000-byte limit)</p>\n\n<p>After researching I found out that it should have to do something with infinite recursion, but I don't have a clue why my code should have that.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>type Report struct{\n    TestSuites []ReportElement\n    Tests int\n    Success int\n    Failed int\n    Root *ReportElement\n    CurrentElement *ReportElement `json:\"-\"`\n}\n\ntype ReportElement struct{\n    Success bool\n    Time bool\n    LogStorage []string\n    Childs []ReportElement\n    Parent *ReportElement\n}\n\nfunc (r *Report) NewChild(){\n    newElem := ReportElement{}\n    newElem.Parent = r.CurrentElement\n    newElem.Childs = make([]ReportElement,0)\n\n    newChilds := append(r.CurrentElement.Childs,newElem)\n    r.CurrentElement.Childs = newChilds\n\n    r.CurrentElement = &amp;newElem\n}\n\n\nfunc TestReporterStackOverflow(t *testing.T) {\n    report := NewReport()\n    report.NewChild()\n\n    jsonReport,err := json.MarshalIndent(report,\"\",\" \")\n    if err != nil{\n        t.Fatal(err)\n    }\n\n    t.Log(jsonReport)\n}\n</code></pre>\n\n<p><strong>Ideas</strong></p>\n\n<p>Actually I am not sure if it has to do something with my code as the stacktrace leads to \"/usr/local/go/src/encoding/json/encode.go\". </p>\n\n<p>Thanks a lot for your help!</p>\n"}, {"tags": ["go", "kubernetes", "kubernetes-go-client"], "answers": [{"tags": [], "owner": {"reputation": 22353, "user_id": 225016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77d3c3ab5ddcf93a8ca1bfe1b481be1c?s=128&d=identicon&r=PG", "display_name": "mdaniel", "link": "https://stackoverflow.com/users/225016/mdaniel"}, "is_accepted": true, "score": 1, "last_activity_date": 1529383993, "creation_date": 1529383993, "answer_id": 50920862, "question_id": 50911590, "link": "https://stackoverflow.com/questions/50911590/how-can-i-get-the-pods-resource-usage-via-kubernetes-go-client/50920862#50920862", "title": "How can I get the pods resource usage via kubernetes go-client?", "body": "<ol>\n<li><p>I'm pretty sure the kuberetes-dashboard uses XHR to obtain that data, so you can make the same requests your browser does, provided your <code>serviceAccount</code> has the correct credentials to interrogate the kubernetes-dashboard API</p></li>\n<li><p>either way, that timeseries data surfaced by kubernetes-dashboard actually comes from heapster, not from the kubernetes API itself, so the kubernetes go-client wouldn't be involved but rather would be a query to the heapster <code>Service</code> (which IIRC does not require authentication, although it <em>would</em> require constructing the correct heapster query syntax, which kubernetes-dashboard is doing on your behalf)</p></li>\n</ol>\n"}], "owner": {"reputation": 63, "user_id": 9298150, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T8kDD8nM_0M/AAAAAAAAAAI/AAAAAAAAACs/mSv9RXsnXOE/photo.jpg?sz=128", "display_name": "Shibu", "link": "https://stackoverflow.com/users/9298150/shibu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 50920862, "answer_count": 1, "score": 2, "last_activity_date": 1529383993, "creation_date": 1529331666, "last_edit_date": 1529336458, "question_id": 50911590, "link": "https://stackoverflow.com/questions/50911590/how-can-i-get-the-pods-resource-usage-via-kubernetes-go-client", "title": "How can I get the pods resource usage via kubernetes go-client?", "body": "<p>I am trying to build an API, which can send back my pods' resource usage.\nLooking at the <a href=\"https://i.stack.imgur.com/9wPbP.png\" rel=\"nofollow noreferrer\">resources being used by the pods</a>, I am not able to figure out the go-client API to send the request to. Any help will be very appreciated.</p>\n"}, {"tags": ["windows", "powershell", "go", "cross-compiling"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1529330851, "post_id": 50911153, "comment_id": 88822633, "body": "What do you mean by &quot;not able to set <code>GOOS</code>&quot;? You get an error? <code>GOOS</code> not changing? Or?"}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1529344815, "post_id": 50911153, "comment_id": 88830174, "body": "The cmd does not change anything"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 15, "last_activity_date": 1529340936, "last_edit_date": 1529340936, "creation_date": 1529334159, "answer_id": 50912419, "question_id": 50911153, "link": "https://stackoverflow.com/questions/50911153/how-to-crosscompile-go-programs-on-windows-10/50912419#50912419", "title": "How to CrossCompile Go programs on Windows 10", "body": "<p><code>set</code> is an internal command of the Windows command line interpreter (<code>cmd.exe</code>).</p>\n\n<p>If you're using PowerShell, then changing values of environment variables should be done like:</p>\n\n<pre><code>$Env:&lt;variable-name&gt; = \"&lt;new-value&gt;\"\n</code></pre>\n\n<p>For more details, see <a href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_environment_variables?view=powershell-6\" rel=\"noreferrer\">PowerShell documentation: About Environment Variables</a></p>\n\n<p>So to change <code>GOOS</code>, use:</p>\n\n<pre><code>$Env:GOOS = \"linux\"\n</code></pre>\n\n<p>To do a cross-compilation:</p>\n\n<ol>\n<li><p>Navigate to the folder where the <code>main</code> package is.</p></li>\n<li><p>Run <code>$Env:GOOS = \"linux\"</code></p></li>\n<li><p>Optionally run <code>$Env:GOARCH = \"amd64\"</code></p></li>\n<li><p>Run <code>go build</code></p></li>\n</ol>\n\n<p>Or you can do it in a single line:</p>\n\n<pre><code>$Env:GOOS = \"linux\"; $Env:GOARCH = \"amd64\"; go build\n</code></pre>\n\n<p>To specify the output file name:</p>\n\n<pre><code>$Env:GOOS = \"linux\"; $Env:GOARCH = \"amd64\"; go build -o hello\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1333, "user_id": 5947166, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7faa701ebd6753aa3cbd84252ee8f33c?s=128&d=identicon&r=PG&f=1", "display_name": "Nane", "link": "https://stackoverflow.com/users/5947166/nane"}, "is_accepted": false, "score": -1, "last_activity_date": 1596321981, "creation_date": 1596321981, "answer_id": 63210757, "question_id": 50911153, "link": "https://stackoverflow.com/questions/50911153/how-to-crosscompile-go-programs-on-windows-10/63210757#63210757", "title": "How to CrossCompile Go programs on Windows 10", "body": "<p>I faced the same problem</p>\n<p>Install this package</p>\n<p><a href=\"https://www.npmjs.com/package/cross-env\" rel=\"nofollow noreferrer\">https://www.npmjs.com/package/cross-env</a></p>\n<p>and run</p>\n<pre><code>cross-env GOOS=linux go build -o hello\n</code></pre>\n"}], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3236, "favorite_count": 6, "accepted_answer_id": 50912419, "answer_count": 2, "score": 9, "last_activity_date": 1596321981, "creation_date": 1529330195, "last_edit_date": 1529341460, "question_id": 50911153, "link": "https://stackoverflow.com/questions/50911153/how-to-crosscompile-go-programs-on-windows-10", "title": "How to CrossCompile Go programs on Windows 10", "body": "<p>I want to compile a Go programm for a linux machine. I always used that way which is described here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/20829155/how-to-cross-compile-from-windows-to-linux#20830892\">How to cross compile from Windows to Linux?</a></p>\n\n<p>That worked pretty well until the last big update from Windows 10. Now I am not able to set the <code>GOOS</code> with</p>\n\n<pre><code>set GOOS=linux\n</code></pre>\n\n<p>I also tried to start the PowerShell as administrator, but even that is not working.\nAre there any tools which can do that? Or is there another way to crosscompile Go program on Windows 10?</p>\n"}, {"tags": ["loops", "go", "error-handling", "slice"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1529330446, "creation_date": 1529330446, "answer_id": 50911223, "question_id": 50911020, "link": "https://stackoverflow.com/questions/50911020/one-line-to-loop-over-results-of-a-function-call-with-tuple-results-err/50911223#50911223", "title": "One line to loop over results of a function call with tuple (results, err)", "body": "<p>If a function returns an error too, you should always check that first, and only proceed to use other results if the returned error allows so (most often if it's equal to <code>nil</code>).</p>\n\n<p>So do it like this:</p>\n\n<pre><code>s, err := getSlice()\nif err != nil {\n    // Handle error and optionally return\n    log.Printf(\"getSlice error: %v\", err)\n    return\n\n}\nfor _, letter := range s {\n    // Use letter\n}\n</code></pre>\n\n<p>If you don't need to return in case of errors, and you only need to use the result once, you may also do it like this:</p>\n\n<pre><code>if s, err := getSlice(); err == nil {\n    for _, letter := range s {\n        // Use letter\n    }\n} else {\n    log.Printf(\"getSlice error: %v\", err)\n}\n</code></pre>\n"}], "owner": {"reputation": 2105, "user_id": 1814774, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/82c42c6b79dfb7c911655d1f1e6110d2?s=128&d=identicon&r=PG", "display_name": "Pobe", "link": "https://stackoverflow.com/users/1814774/pobe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529330608, "creation_date": 1529329754, "last_edit_date": 1529330608, "question_id": 50911020, "link": "https://stackoverflow.com/questions/50911020/one-line-to-loop-over-results-of-a-function-call-with-tuple-results-err", "title": "One line to loop over results of a function call with tuple (results, err)", "body": "<p>What's the best / standard way to iterate results from a function call where it returns the tuple <code>(result, err)</code>.</p>\n\n<p>Example :</p>\n\n<pre><code>func getSlice() ([]string, error) {\n  return []string{\"a\", \"b\", \"c\"}, nil\n}\n\nfor _, letter := range getSlice() {} //how should it be done here?\n</code></pre>\n\n<p>Is that even a good thing to consider?</p>\n"}, {"tags": ["go", "sqlite"], "comments": [{"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 1, "creation_date": 1529322655, "post_id": 50908710, "comment_id": 88817505, "body": "I think you should move the <i>defer</i> stuff just under the query call, and handle the transaction too. The difference with the other question is that you have an <i>insert</i> command, and you don&#39;t take care of the transaction there."}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1529324270, "post_id": 50908710, "comment_id": 88818589, "body": "can you query through cli ?"}], "answers": [{"comments": [{"owner": {"reputation": 595, "user_id": 8447389, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cfd0136eaadadee6140932e796939f69?s=128&d=identicon&r=PG&f=1", "display_name": "xaos_xv", "link": "https://stackoverflow.com/users/8447389/xaos-xv"}, "edited": false, "score": 0, "creation_date": 1529334605, "post_id": 50912300, "comment_id": 88825119, "body": "Thanks for the solution and great explanation!"}], "tags": [], "owner": {"reputation": 966, "user_id": 2166750, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7a98a414302c4331caa45d56a522202?s=128&d=identicon&r=PG", "display_name": "Bert Verhees", "link": "https://stackoverflow.com/users/2166750/bert-verhees"}, "is_accepted": true, "score": 6, "last_activity_date": 1529333776, "creation_date": 1529333776, "answer_id": 50912300, "question_id": 50908710, "link": "https://stackoverflow.com/questions/50908710/database-is-locked-defering-rows-didnt-work/50912300#50912300", "title": "Database is locked (defering rows didn&#39;t work)", "body": "<p>You must place defer rows.Close() directly below the row where your Rows are created.\nBecause, in your case when there is a panic while doing something, the defer is never reached and the rows are never closed, and then such an error situation can occur. In your code, you throw away the great advantage the defer-construct in go has above other programming environments.</p>\n"}], "owner": {"reputation": 595, "user_id": 8447389, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cfd0136eaadadee6140932e796939f69?s=128&d=identicon&r=PG&f=1", "display_name": "xaos_xv", "link": "https://stackoverflow.com/users/8447389/xaos-xv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 727, "favorite_count": 1, "accepted_answer_id": 50912300, "answer_count": 1, "score": 5, "last_activity_date": 1529333776, "creation_date": 1529322072, "last_edit_date": 1529322996, "question_id": 50908710, "link": "https://stackoverflow.com/questions/50908710/database-is-locked-defering-rows-didnt-work", "title": "Database is locked (defering rows didn&#39;t work)", "body": "<p>I have a problem with SQLite3 in my Golang project. I want to insert data into my database but It gives me error <code>database is locked</code>. I know that it was here the same question (<a href=\"https://stackoverflow.com/questions/32479071/sqlite3-error-database-is-locked-in-golang\">Sqlite3 error: database is locked in golang</a>) but answer from there didn't work. I don't know what I'm doing wrong. Here is my code:</p>\n\n<pre><code>var (\n    tpl   *template.Template\n    db, _ = sql.Open(\"sqlite3\", \"database/pastozbior.db\")\n)\nfunc main() {\n    http.HandleFunc(\"/\", addCopypasta)\n    http.ListenAndServe(\":8000\", nil)\n} \nfunc getCopypasta() []Copypasta {\n    copypastaList := []Copypasta{}\n    var title, body string\n\n    rows, _ := db.Query(\"select title, body from copypasta\")\n    for rows.Next() {\n        rows.Scan(&amp;title, &amp;body)\n        copypastaList = append(copypastaList, Copypasta{title, body})\n    }\n    defer rows.Close()\n    return copypastaList\n}\n\nfunc addCopypasta(w http.ResponseWriter, r *http.Request) {\n    tpl.ExecuteTemplate(w, \"main.html\", nil)\n\n    if r.Method == \"POST\" {\n        r.ParseForm()\n        // add copypasta to database\n        stmt, err := db.Prepare(\"INSERT INTO copypasta(title, body, approved) values(?,?,0)\")\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        res, err := stmt.Exec(\"testTitle\", \"TestBody\")\n        if err != nil {\n            log.Fatal(err)\n        }\n        id, err := res.LastInsertId()\n        if err != nil {\n            log.Fatal(err)\n        }\n        fmt.Println(id)\n\n    }\n}\n</code></pre>\n\n<p>Thanks in advance for the help!</p>\n"}, {"tags": ["postgresql", "go", "aws-lambda", "amazon-rds"], "answers": [{"tags": [], "owner": {"reputation": 16298, "user_id": 308679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GCNYS.jpg?s=128&g=1", "display_name": "J&#252;rgen H&#246;tzel", "link": "https://stackoverflow.com/users/308679/j%c3%bcrgen-h%c3%b6tzel"}, "is_accepted": false, "score": 3, "last_activity_date": 1529333427, "creation_date": 1529333427, "answer_id": 50912177, "question_id": 50908101, "link": "https://stackoverflow.com/questions/50908101/connect-to-aws-rds-postgresql-with-aws-lambda-and-golang/50912177#50912177", "title": "Connect to AWS RDS PostgreSQL with AWS Lambda and Golang", "body": "<p>You need to escape path-special variables when your create connection URLs by hand:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>dnsStr := fmt.Sprintf(\"postgres://%s:%s@%s/testdb\",\n    \"rdsadmin\", url.PathEscape(authToken), \"something.eu-west-3.rds.amazonaws.com\")\n</code></pre>\n\n<p>Also it might be useful to print the connection-ping error:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>fmt.Printf(\"Cannot ping db: %s\\n\", err)\n</code></pre>\n"}], "owner": {"reputation": 865, "user_id": 7065110, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/j7huq.jpg?s=128&g=1", "display_name": "Ludonope", "link": "https://stackoverflow.com/users/7065110/ludonope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3093, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1529333427, "creation_date": 1529320062, "question_id": 50908101, "link": "https://stackoverflow.com/questions/50908101/connect-to-aws-rds-postgresql-with-aws-lambda-and-golang", "title": "Connect to AWS RDS PostgreSQL with AWS Lambda and Golang", "body": "<p>I am trying to connect to a AWS RDS PosgreSQL database from a lambda in Go.</p>\n\n<p>The <code>authToken</code> seems good in the logs.</p>\n\n<pre><code>creds := credentials.NewEnvCredentials()\nauthToken, err := rdsutils.BuildAuthToken(\"something.eu-west-3.rds.amazonaws.com\", \"eu-west-3\", \"Username\", creds)\n\nif err != nil {\n    fmt.Println(\"Cannot create db auth token\")\n    return response.Status(500), err\n}\n\n// Create the DNS string for the DB connection\n// // user:password@protocol(endpoint:port)/dbname?&lt;params&gt;\ndnsStr := fmt.Sprintf(\"postgres://%s:%s@%s/%s?sslmode=verify-full\",\n    \"Username\", authToken, \"something.eu-west-3.rds.amazonaws.com\", \"table_name\",\n)\ndb, err := sql.Open(\"postgres\", dnsStr)\n\nif err != nil {\n    fmt.Println(\"Cannot open db\")\n    return response.Status(500), err\n}\n\nerr = db.Ping()\n\nif err != nil {\n    fmt.Println(\"Cannot ping db\")\n    return response.Status(500), err\n}\n\nfmt.Println(\"Connection established\")\n</code></pre>\n\n<p>I have an error on the <code>db.Ping()</code>, and in the logs I got</p>\n\n<pre><code>Cannot ping db\ndial tcp: address tcp/something.eu-west-3.rds.amazonaws.com: unknown port: OpError\nnull\n</code></pre>\n\n<p>I use the <code>pq</code> library, imported as <code>_ \"github.com/lib/pq\"\n</code></p>\n\n<p>I have tried adding the default port <code>5432</code> in the url after the host, but with no results.</p>\n\n<p>I'm sure I'm missing a stupid key point, plz halp</p>\n"}, {"tags": ["function", "go", "interface"], "answers": [{"comments": [{"owner": {"reputation": 517, "user_id": 9956279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iStX1.jpg?s=128&g=1", "display_name": "Sushilinux", "link": "https://stackoverflow.com/users/9956279/sushilinux"}, "edited": false, "score": 0, "creation_date": 1529319358, "post_id": 50907891, "comment_id": 88815559, "body": "Thanks Filip :) ! I should have studied Slice in advance."}], "tags": [], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "is_accepted": true, "score": 1, "last_activity_date": 1529319372, "last_edit_date": 1529319372, "creation_date": 1529319289, "answer_id": 50907891, "question_id": 50907858, "link": "https://stackoverflow.com/questions/50907858/what-do-a-and-before-interface-in-the-golang-doc-mean/50907891#50907891", "title": "What do &quot;a&quot; and &quot;...&quot; before &quot;interface{}&quot; in the Golang doc mean?", "body": "<p><code>a</code> is a variable, like any other. <code>...</code> is a way to grab many arguments into a slice.</p>\n\n<p>It could be written as:</p>\n\n<pre><code>func Printf(format string, a []interface{}) (n int, err error)\n</code></pre>\n\n<p>but then you'd have to call it like this:</p>\n\n<pre><code>Printf(\"\", []interface{1,2,3})\n</code></pre>\n\n<p>rather than like this</p>\n\n<pre><code>Printf(\"\", 1, 2, 3)\n</code></pre>\n"}], "owner": {"reputation": 517, "user_id": 9956279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iStX1.jpg?s=128&g=1", "display_name": "Sushilinux", "link": "https://stackoverflow.com/users/9956279/sushilinux"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1529319975, "accepted_answer_id": 50907891, "answer_count": 1, "score": -4, "last_activity_date": 1535301456, "creation_date": 1529319176, "last_edit_date": 1535301456, "question_id": 50907858, "link": "https://stackoverflow.com/questions/50907858/what-do-a-and-before-interface-in-the-golang-doc-mean", "closed_reason": "Duplicate", "title": "What do &quot;a&quot; and &quot;...&quot; before &quot;interface{}&quot; in the Golang doc mean?", "body": "<p>In the official documentation, codes like the following appear often.</p>\n\n<pre><code>func Printf(format string, a ...interface{}) (n int, err error)\n</code></pre>\n\n<p>what are <code>a</code> and <code>...</code> mean respectively?</p>\n"}, {"tags": ["json", "pointers", "go", "struct", "reflection"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1529307720, "post_id": 50904716, "comment_id": 88809236, "body": "What is the <code>err</code>?"}, {"owner": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1529307783, "post_id": 50904716, "comment_id": 88809264, "body": "@leafbebop no error, the value still be its zero value. json data didn&#39;t fill in."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1529324078, "post_id": 50904716, "comment_id": 88818468, "body": "What is the reason for passing a slice of the type when the JSON is a single object?  Did you intend to use the JSON <code>[{&quot;name&quot;: &quot;go&quot;}]</code> or the value <code>l := Test{}</code>?  Both of these changes align the code and JSON."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1529308445, "last_edit_date": 1529308445, "creation_date": 1529308137, "answer_id": 50904851, "question_id": 50904716, "link": "https://stackoverflow.com/questions/50904716/dynamically-create-struct-of-some-type-and-unmarshal-json-into-that-instance/50904851#50904851", "title": "Dynamically create struct of some type and unmarshal JSON into that instance", "body": "<p><a href=\"https://golang.org/pkg/reflect/#Indirect\" rel=\"nofollow noreferrer\"><code>reflect.Indirect()</code></a> returns you a value of type <a href=\"https://golang.org/pkg/reflect/#Value\" rel=\"nofollow noreferrer\"><code>reflect.Value</code></a>, and you should pass a pointer to <code>Test</code> (which is of type <code>*Test</code>) to <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\"><code>json.Unmarshal()</code></a>.</p>\n\n<p>Simply use the <a href=\"https://golang.org/pkg/reflect/#Value.Interface\" rel=\"nofollow noreferrer\"><code>Value.Interface()</code></a> method to obtain the pointer to your <code>Test</code> struct returned by <a href=\"https://golang.org/pkg/reflect/#New\" rel=\"nofollow noreferrer\"><code>reflect.New()</code></a>, like this:</p>\n\n<pre><code>f := reflect.New(elType).Interface()\nb := []byte(`{\"name\": \"go\"}`)\nerr := json.Unmarshal(b, f)\n</code></pre>\n\n<p>With this it works, and output will be:</p>\n\n<pre><code>&lt;nil&gt; &amp;{go}\n</code></pre>\n\n<p>Note that <code>f</code> will be of <code>interface{}</code> type, holding the <code>*Test</code> pointer value. If you need the struct value, you may use type assertion, like this:</p>\n\n<pre><code>t := *f.(*Test)\nfmt.Println(t)\n</code></pre>\n\n<p>This prints:</p>\n\n<pre><code>{go}\n</code></pre>\n\n<p>Try the examples on the <a href=\"https://play.golang.org/p/k6CK8t6bWw6\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "edited": false, "score": 0, "creation_date": 1529309015, "post_id": 50904872, "comment_id": 88809818, "body": "l should be slice"}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "reply_to_user": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "edited": false, "score": 0, "creation_date": 1529310727, "post_id": 50904872, "comment_id": 88810661, "body": "edited, it errors with slice and that hardcoded json"}, {"owner": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "edited": false, "score": 0, "creation_date": 1529324146, "post_id": 50904872, "comment_id": 88818515, "body": "you changed the <code>b</code> defination... so this is not what I need"}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "reply_to_user": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "edited": false, "score": 0, "creation_date": 1529324463, "post_id": 50904872, "comment_id": 88818696, "body": "what you want is encoding an object into an array, code works fine in that case too but returns not nil error"}], "tags": [], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "is_accepted": false, "score": 3, "last_activity_date": 1529391867, "last_edit_date": 1529391867, "creation_date": 1529308215, "answer_id": 50904872, "question_id": 50904716, "link": "https://stackoverflow.com/questions/50904716/dynamically-create-struct-of-some-type-and-unmarshal-json-into-that-instance/50904872#50904872", "title": "Dynamically create struct of some type and unmarshal JSON into that instance", "body": "<p>I don't think you need to use reflect, instead you can do the following: </p>\n\n<pre><code>type Test struct {\n    Name string `json:\"name,omitempty\"`\n}\n\nfunc create(a interface{}) {\n    b := []byte(`[{\"name\": \"go\"}]`)\n\n    err := json.Unmarshal(b, &amp;a)\n    fmt.Println(err, a)\n}\n\nfunc main() {\n    l := []Test{}\n    create(&amp;l)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": false, "score": 2, "last_activity_date": 1529308358, "creation_date": 1529308358, "answer_id": 50904894, "question_id": 50904716, "link": "https://stackoverflow.com/questions/50904716/dynamically-create-struct-of-some-type-and-unmarshal-json-into-that-instance/50904894#50904894", "title": "Dynamically create struct of some type and unmarshal JSON into that instance", "body": "<p>The code  <code>reflect.Indirect(reflect.New(elType))</code>\nreturns a <code>reflect.Value</code> instead of a concrete value of <code>elType</code>. And when you unmarshal it, the json package looks into the <code>reflect.Value</code> struct which has no field <code>Name</code>, so it does nothing.</p>\n\n<p>Instead, you should use <code>reflect.Value.Interface()</code> to turn it into an <code>interface{}</code> holding the concrete type.</p>\n\n<p>Playground: <a href=\"https://play.golang.org/p/sW9mJd8fKMb\" rel=\"nofollow noreferrer\">https://play.golang.org/p/sW9mJd8fKMb</a></p>\n"}], "owner": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2681, "favorite_count": 2, "accepted_answer_id": 50904851, "answer_count": 3, "score": 3, "last_activity_date": 1529391867, "creation_date": 1529307600, "last_edit_date": 1529310552, "question_id": 50904716, "link": "https://stackoverflow.com/questions/50904716/dynamically-create-struct-of-some-type-and-unmarshal-json-into-that-instance", "title": "Dynamically create struct of some type and unmarshal JSON into that instance", "body": "<p>I am creating a struct instance at runtime. The instance has been created successfully, but I can't unmarshal JSON into it.</p>\n\n<pre><code>type Test struct {\n    Name string `json:\"name,omitempty\"`\n}\n\nfunc create(a interface{}) {\n    aType := reflect.TypeOf(a).Elem()\n    elType := aType.Elem()\n\n    f := reflect.Indirect(reflect.New(elType))\n\n    b := []byte(`{\"name\": \"go\"}`)\n\n    err := json.Unmarshal(b, &amp;f)\n    fmt.Println(err, f)\n}\n\nfunc main() {\n    l := []Test{}\n    create(&amp;l)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1988, "user_id": 6716410, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbA3G.png?s=128&g=1", "display_name": "sf9v", "link": "https://stackoverflow.com/users/6716410/sf9v"}, "edited": false, "score": 0, "creation_date": 1529317332, "post_id": 50904560, "comment_id": 88814407, "body": "<a href=\"https://medium.com/@benbjohnson/structuring-applications-in-go-3b04be4ff091\" rel=\"nofollow noreferrer\">medium.com/@benbjohnson/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 11, "last_activity_date": 1529311389, "last_edit_date": 1529311389, "creation_date": 1529307169, "answer_id": 50904611, "question_id": 50904560, "link": "https://stackoverflow.com/questions/50904560/how-to-structure-go-application-to-produce-multiple-binaries/50904611#50904611", "title": "How to structure Go application to produce multiple binaries?", "body": "<p>Usual directory structure for such projects look like that:</p>\n\n<pre><code>cmd/\n    a/\n        main.go\n    b/\n        main.go\n</code></pre>\n\n<p>To build executables run</p>\n\n<pre><code>go build ./cmd/a\ngo build ./cmd/b\n</code></pre>\n\n<p>Examples</p>\n\n<ul>\n<li><a href=\"https://github.com/prometheus/prometheus/tree/master/cmd\" rel=\"noreferrer\">https://github.com/prometheus/prometheus/tree/master/cmd</a></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1529334553, "post_id": 50904959, "comment_id": 88825087, "body": "A project-local <code>bin</code> directory is a pretty unusual pattern, and calling the makefile &quot;highly recommended&quot; is purely your opinion."}, {"owner": {"reputation": 3690, "user_id": 3960852, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FhcvT.png?s=128&g=1", "display_name": "Kenny Worden", "link": "https://stackoverflow.com/users/3960852/kenny-worden"}, "edited": false, "score": 1, "creation_date": 1570803054, "post_id": 50904959, "comment_id": 103041198, "body": "It&#39;s a pretty common convention esp. in larger projects. Best to instill good practices for any newbies that come along."}, {"owner": {"reputation": 209, "user_id": 437171, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0d49e7227b5ced939291f9228167b7df?s=128&d=identicon&r=PG", "display_name": "refro", "link": "https://stackoverflow.com/users/437171/refro"}, "edited": false, "score": 0, "creation_date": 1575636914, "post_id": 50904959, "comment_id": 104643290, "body": "@scriptonist When using such a structure in Git or Svn and only release one of the binaries how do you handle tag names etc (do you delete the bin2 folder for the tag, if not doesn&#39;t this become confusing?)"}], "tags": [], "owner": {"reputation": 399, "user_id": 8264607, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WQKpnhD7pmQ/AAAAAAAAAAI/AAAAAAAAABM/vjTCAvnmiD0/photo.jpg?sz=128", "display_name": "scriptonist", "link": "https://stackoverflow.com/users/8264607/scriptonist"}, "is_accepted": false, "score": 18, "last_activity_date": 1529381027, "last_edit_date": 1529381027, "creation_date": 1529308606, "answer_id": 50904959, "question_id": 50904560, "link": "https://stackoverflow.com/questions/50904560/how-to-structure-go-application-to-produce-multiple-binaries/50904959#50904959", "title": "How to structure Go application to produce multiple binaries?", "body": "<p>The following folder structure is used in many popular <code>go</code> projects such as <a href=\"https://github.com/kubernetes/helm\" rel=\"noreferrer\">helm</a>,<a href=\"https://github.com/kubicorn/kubicorn\" rel=\"noreferrer\">kubicorn</a> etc.</p>\n\n<pre><code>goproject/\n\u251c\u2500\u2500 bin\n\u251c\u2500\u2500 cmd\n\u251c\u2500\u2500 pkg\n\u2514\u2500\u2500 Makefile\n</code></pre>\n\n<p>The <code>cmd</code> directory will contain the different binaries, separated in directories.</p>\n\n<pre><code>cmd/\n\u251c\u2500\u2500 bin1\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 main.go\n\u251c\u2500\u2500 bin2\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 main.go\n\u2514\u2500\u2500 bin3\n    \u2514\u2500\u2500 main.go\n</code></pre>\n\n<p><code>pkg</code> directory will contain all your reusable packages. In your case the common code used by the different binaries. This directory can also be named <code>internal</code> , learn more about it <a href=\"https://stackoverflow.com/questions/33351387/how-to-use-internal-packages\">here</a>.</p>\n\n<pre><code>pkg\n\u251c\u2500\u2500 reusablepackage1\n\u2514\u2500\u2500 reusablepackage2\n</code></pre>\n\n<p>The <code>bin</code> directory is optional, It can be used to store the generated binaries. In case you are generating binaries to <code>$GOBIN</code> this can be omitted.</p>\n\n<pre><code>bin/\n\u251c\u2500\u2500 bin1\n\u251c\u2500\u2500 bin2\n\u2514\u2500\u2500 bin3\n</code></pre>\n\n<p>The <code>Makefile</code> can be used for writing helpful scripts, such as generating binaries running test suite etc. You can have commands such as \n<code>make bin1</code>,<code>make bin2</code> etc.This is optional but I highly recommend this. because it saves me from writing long build commands over and over again.</p>\n"}], "owner": {"reputation": 171, "user_id": 9955369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e73b5b5509a161132de7fe5b0db4693?s=128&d=identicon&r=PG&f=1", "display_name": "Harrison", "link": "https://stackoverflow.com/users/9955369/harrison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7441, "favorite_count": 5, "answer_count": 2, "score": 17, "last_activity_date": 1529381027, "creation_date": 1529306953, "question_id": 50904560, "link": "https://stackoverflow.com/questions/50904560/how-to-structure-go-application-to-produce-multiple-binaries", "title": "How to structure Go application to produce multiple binaries?", "body": "<p>I am creating three applications which are very similar to each other but each will apply different logic. I am not sure how to best structure it to avoid repeating code. </p>\n\n<p>All applications have the following in common:\n- read and parse config\n- setup SQL database connection\n- gather stats\n- read from STDIN</p>\n\n<p>Each application will apply different logic to the data read from STDIN. </p>\n\n<p>Would this be considered acceptable? Put all common code in main.go then build as \"go build -o bin/app1 main.go app1.go\" and so on - pulling in only the app specific logic for each binary to build?</p>\n\n<p>main.go:</p>\n\n<pre><code>func main() {\n    // db connection\n    // stats worker\n    // read from stdin\n\n    proccessLine(line)\n}\n</code></pre>\n\n<p>app1.go:</p>\n\n<pre><code>func processLine(line string) {\n    // logic for app 1\n}\n</code></pre>\n\n<p>app2.go:</p>\n\n<pre><code>func processLine(line string) {\n    // logic for app 2\n}\n</code></pre>\n\n<p>etc.</p>\n"}, {"tags": ["go", "hyperledger-fabric", "hyperledger"], "comments": [{"owner": {"reputation": 691, "user_id": 4353189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b678b320eeb1d2feb507a13f9446b14e?s=128&d=identicon&r=PG", "display_name": "nilakantha singh deo", "link": "https://stackoverflow.com/users/4353189/nilakantha-singh-deo"}, "edited": false, "score": 0, "creation_date": 1529322106, "post_id": 50904290, "comment_id": 88817157, "body": "Is it version 1.0 or 0.6?"}, {"owner": {"reputation": 175, "user_id": 9890922, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Venkatesh Muthyala", "link": "https://stackoverflow.com/users/9890922/venkatesh-muthyala"}, "reply_to_user": {"reputation": 691, "user_id": 4353189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b678b320eeb1d2feb507a13f9446b14e?s=128&d=identicon&r=PG", "display_name": "nilakantha singh deo", "link": "https://stackoverflow.com/users/4353189/nilakantha-singh-deo"}, "edited": false, "score": 0, "creation_date": 1529322312, "post_id": 50904290, "comment_id": 88817287, "body": "my version is 0.6"}, {"owner": {"reputation": 691, "user_id": 4353189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b678b320eeb1d2feb507a13f9446b14e?s=128&d=identicon&r=PG", "display_name": "nilakantha singh deo", "link": "https://stackoverflow.com/users/4353189/nilakantha-singh-deo"}, "edited": false, "score": 0, "creation_date": 1529322587, "post_id": 50904290, "comment_id": 88817470, "body": "Then you should return error too.Like below"}], "answers": [{"comments": [{"owner": {"reputation": 691, "user_id": 4353189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b678b320eeb1d2feb507a13f9446b14e?s=128&d=identicon&r=PG", "display_name": "nilakantha singh deo", "link": "https://stackoverflow.com/users/4353189/nilakantha-singh-deo"}, "edited": false, "score": 0, "creation_date": 1529322977, "post_id": 50908967, "comment_id": 88817712, "body": "type ObjectGet struct { Variable1 string <code>json:&quot;variable1&quot;</code>}  this you have to declare as a structure on the top of the chaincode file.I would suggest ,go for version 1.0 chaincode fabcar example.Its more intuitive and easier to follow."}, {"owner": {"reputation": 175, "user_id": 9890922, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Venkatesh Muthyala", "link": "https://stackoverflow.com/users/9890922/venkatesh-muthyala"}, "edited": false, "score": 0, "creation_date": 1529323759, "post_id": 50908967, "comment_id": 88818271, "body": "Thanks a lot can we chat in stack exchange  i have update my code  can you plese see it"}, {"owner": {"reputation": 691, "user_id": 4353189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b678b320eeb1d2feb507a13f9446b14e?s=128&d=identicon&r=PG", "display_name": "nilakantha singh deo", "link": "https://stackoverflow.com/users/4353189/nilakantha-singh-deo"}, "reply_to_user": {"reputation": 175, "user_id": 9890922, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Venkatesh Muthyala", "link": "https://stackoverflow.com/users/9890922/venkatesh-muthyala"}, "edited": false, "score": 0, "creation_date": 1529324104, "post_id": 50908967, "comment_id": 88818490, "body": "I am in office now .Could you please ping post 7 at nsinghdeo005@gmail.com?"}, {"owner": {"reputation": 691, "user_id": 4353189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b678b320eeb1d2feb507a13f9446b14e?s=128&d=identicon&r=PG", "display_name": "nilakantha singh deo", "link": "https://stackoverflow.com/users/4353189/nilakantha-singh-deo"}, "reply_to_user": {"reputation": 175, "user_id": 9890922, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Venkatesh Muthyala", "link": "https://stackoverflow.com/users/9890922/venkatesh-muthyala"}, "edited": false, "score": 0, "creation_date": 1529325097, "post_id": 50908967, "comment_id": 88819061, "body": "Your company allows that?"}, {"owner": {"reputation": 691, "user_id": 4353189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b678b320eeb1d2feb507a13f9446b14e?s=128&d=identicon&r=PG", "display_name": "nilakantha singh deo", "link": "https://stackoverflow.com/users/4353189/nilakantha-singh-deo"}, "reply_to_user": {"reputation": 175, "user_id": 9890922, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Venkatesh Muthyala", "link": "https://stackoverflow.com/users/9890922/venkatesh-muthyala"}, "edited": false, "score": 0, "creation_date": 1529325157, "post_id": 50908967, "comment_id": 88819094, "body": "Ping me at around 7 pm"}], "tags": [], "owner": {"reputation": 691, "user_id": 4353189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b678b320eeb1d2feb507a13f9446b14e?s=128&d=identicon&r=PG", "display_name": "nilakantha singh deo", "link": "https://stackoverflow.com/users/4353189/nilakantha-singh-deo"}, "is_accepted": false, "score": 1, "last_activity_date": 1529322887, "creation_date": 1529322887, "answer_id": 50908967, "question_id": 50904290, "link": "https://stackoverflow.com/questions/50904290/how-get-the-data-from-hyperledgerfabric-ledger-and-update/50908967#50908967", "title": "how get the data from hyperledgerfabric ledger and update", "body": "<p>You should retun error with version 0.6 fabric chaincode.</p>\n\n<pre><code>func (t *SimpleChaincode) write(stub shim.ChaincodeStubInterface, args []string) ([]byte, error) {\nlogger.Debug(\"Entering chaincode\")\n\nif len(args) &lt; 2 {\n    logger.Error(\"Invalid number of args\")\n    return nil, errors.New(\"Expected atleast two arguments\")\n}\nsomeObj := ObjectGet{}\nerr = json.Unmarshal([]byte(Input1), &amp;someObj)\ns1, _ := json.Marshal(someObj)\nerr = stub.PutState(variable1, []byte(s1))\nif err != nil {\n    logger.Error(\"Could not save record to ledger\", err)\n    return nil, err\n}\n\n\nreturn nil, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 9890922, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Venkatesh Muthyala", "link": "https://stackoverflow.com/users/9890922/venkatesh-muthyala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1529322887, "creation_date": 1529305967, "last_edit_date": 1529321711, "question_id": 50904290, "link": "https://stackoverflow.com/questions/50904290/how-get-the-data-from-hyperledgerfabric-ledger-and-update", "title": "how get the data from hyperledgerfabric ledger and update", "body": "<pre><code>package main\n\nimport (\n\n    \"fmt\"\n    \"encoding/json\"\n    \"strconv\"\n    \"github.com/hyperledger/fabric/core/chaincode/shim\"\n    pb \"github.com/hyperledger/fabric/protos/peer\"\n)\n\n// ============================================================================================================================\n// write() - genric write variable into ledger\n//\n// Shows Off PutState() - writting a key/value into the ledger\n//\n// Inputs - Array of strings\n//    0   ,    1\n//   key  ,  value\n//  \"abc\" , \"test\"\n// ============================================================================================================================\nfunc write(stub shim.ChaincodeStubInterface, args []string) pb.Response {\n    var value,key string\n    var err error\n    var keys  = 1\n</code></pre>\n\n<p>The following is my write method in hyperledger fabric i have assigned the keys = 1 </p>\n\n<p>2) Always  my method is making the keys = 1 so i should get the key from fabric and assign it to keys variable can anyone help me with this ISSUE or  provide any documention how to do that </p>\n"}, {"tags": ["go", "google-cloud-platform", "google-cloud-storage"], "comments": [{"owner": {"reputation": 353, "user_id": 9741885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e572fe78f8d25ce4ec252d63f0768f?s=128&d=identicon&r=PG&f=1", "display_name": "J.L Valtue&#241;a", "link": "https://stackoverflow.com/users/9741885/j-l-valtue%c3%b1a"}, "edited": false, "score": 1, "creation_date": 1529312911, "post_id": 50902961, "comment_id": 88811888, "body": "I see some differences between your code and the one here: <a href=\"https://cloud.google.com/appengine/docs/standard/go/googlecloudstorageclient/read-write-to-cloud-storage#writing_to_cloud_storage\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/standard/go/&hellip;</a>.  Can you provide your full code?"}, {"owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "reply_to_user": {"reputation": 353, "user_id": 9741885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e572fe78f8d25ce4ec252d63f0768f?s=128&d=identicon&r=PG&f=1", "display_name": "J.L Valtue&#241;a", "link": "https://stackoverflow.com/users/9741885/j-l-valtue%c3%b1a"}, "edited": false, "score": 0, "creation_date": 1529314181, "post_id": 50902961, "comment_id": 88812621, "body": "I just saw the problem, it was just that I didn&#39;t close the client"}], "answers": [{"tags": [], "owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "is_accepted": true, "score": 1, "last_activity_date": 1529314435, "creation_date": 1529314435, "answer_id": 50906472, "question_id": 50902961, "link": "https://stackoverflow.com/questions/50902961/cloud-storage-unable-to-upload-any-content-while-local-with-golang/50906472#50906472", "title": "cloud storage: unable to upload any content while local with golang", "body": "<p>I just forgot about closing the client, <a href=\"https://cloud.google.com/appengine/docs/standard/go/googlecloudstorageclient/read-write-to-cloud-storage#writing_to_cloud_storage\" rel=\"nofollow noreferrer\">this page</a> alert this problem, always must close the client or the file won't be send, so just need to add some lines:</p>\n\n<pre><code>if err := w.Close(); err != nil {\n            log.Fatal(err)\n            return\n        }\n</code></pre>\n"}], "owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 50906472, "answer_count": 1, "score": 0, "last_activity_date": 1529314435, "creation_date": 1529298474, "question_id": 50902961, "link": "https://stackoverflow.com/questions/50902961/cloud-storage-unable-to-upload-any-content-while-local-with-golang", "title": "cloud storage: unable to upload any content while local with golang", "body": "<p>I have this piece of code:</p>\n\n<pre><code>ctx:=context.Background()\n    cliente, err := storage.NewClient(ctx)\n    if err != nil {\n        log.Fatal(err)\n    }\n    clienteCS := cliente.Bucket(\"prueba123456789\")\n    w:=clienteCS.Object(\"prueba\").NewWriter(ctx)\n    w.ContentType = \"text/plain\"\n    if _, err := w.Write([]byte(\"abcde\\n\")); err != nil {\n           log.Fatal(err)\n    }\n    attrs, err := clienteCS.Attrs(ctx)\n    fmt.Printf(\"atrr: %+v   err:%v\\n\",attrs,err)\n</code></pre>\n\n<p>When I run this program, in the console I can see the attributes printed from my bucket, that would mean for me that there is nothing wrong with the configuration\n<a href=\"https://i.stack.imgur.com/RAm2m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RAm2m.png\" alt=\"console\"></a>\n, but the problem is that when I see on <a href=\"http://console.cloud.google.com\" rel=\"nofollow noreferrer\">console.cloud.google.com</a> I see no file on my bucket <a href=\"https://i.stack.imgur.com/g042c.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g042c.png\" alt=\"my bucket\"></a> even on api dashboard does not seem like any api has been called(that peak before the red line is other api I was using) <a href=\"https://i.stack.imgur.com/n0rQV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n0rQV.png\" alt=\"api dashboard\"></a>, even though no error is showing on my console that could indicate something went wrong</p>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1529296192, "post_id": 50902502, "comment_id": 88805116, "body": "Did you compile the .proto to a .go file?"}], "answers": [{"comments": [{"owner": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "edited": false, "score": 0, "creation_date": 1529295807, "post_id": 50902649, "comment_id": 88805036, "body": "I did &quot;import ./customer/customer&quot; and it did not work"}, {"owner": {"reputation": 1129, "user_id": 2623144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P66Kw.png?s=128&g=1", "display_name": "XaxD", "link": "https://stackoverflow.com/users/2623144/xaxd"}, "reply_to_user": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "edited": false, "score": 0, "creation_date": 1529295922, "post_id": 50902649, "comment_id": 88805056, "body": "you have to include the directory of the current project. Your base directory is $GOROOT."}, {"owner": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "edited": false, "score": 0, "creation_date": 1529295974, "post_id": 50902649, "comment_id": 88805065, "body": "i am totally not getting what you mean. Can you be little more clear please"}, {"owner": {"reputation": 1129, "user_id": 2623144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P66Kw.png?s=128&g=1", "display_name": "XaxD", "link": "https://stackoverflow.com/users/2623144/xaxd"}, "reply_to_user": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "edited": false, "score": 0, "creation_date": 1529296090, "post_id": 50902649, "comment_id": 88805082, "body": "The base root that you are importing from is actually wherever your go/src/ directory is, which is your $GOPATH. Say your main package is hello (~/go/src/hello) and you have a customer package (~go/src/hello/customer).  Your import statement would be <code>import &quot;hello&#47;customer&quot;</code>"}, {"owner": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "edited": false, "score": 0, "creation_date": 1529296169, "post_id": 50902649, "comment_id": 88805111, "body": "I am still not getting it, Why is GOPATH relevant. Both my files(my hello.go and .proto file) are at /Users/mydir/Documents/golanglearn/shijuvar/proto/customer"}, {"owner": {"reputation": 1369, "user_id": 1632556, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ErjRS.jpg?s=128&g=1", "display_name": "Soumya Kanti", "link": "https://stackoverflow.com/users/1632556/soumya-kanti"}, "edited": false, "score": 2, "creation_date": 1529307466, "post_id": 50902649, "comment_id": 88809094, "body": "To answer your question that why GOPATH relevant, please read the Golang documentation: <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a>"}], "tags": [], "owner": {"reputation": 1129, "user_id": 2623144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P66Kw.png?s=128&g=1", "display_name": "XaxD", "link": "https://stackoverflow.com/users/2623144/xaxd"}, "is_accepted": true, "score": 1, "last_activity_date": 1529295736, "creation_date": 1529295736, "answer_id": 50902649, "question_id": 50902502, "link": "https://stackoverflow.com/questions/50902502/cannot-import-proto-file/50902649#50902649", "title": "cannot import proto file", "body": "<p>Just put the Customer code in a directory and import it like you would a package</p>\n\n<pre><code>package main\nimport \"$SOME_DIR/customer\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 480, "user_id": 9448870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ckK5P.jpg?s=128&g=1", "display_name": "Daniel Sch&#252;tte", "link": "https://stackoverflow.com/users/9448870/daniel-sch%c3%bctte"}, "is_accepted": false, "score": 1, "last_activity_date": 1529443500, "creation_date": 1529443500, "answer_id": 50937164, "question_id": 50902502, "link": "https://stackoverflow.com/questions/50902502/cannot-import-proto-file/50937164#50937164", "title": "cannot import proto file", "body": "<p>As some of the comments already mentioned, you have to import your <code>customer</code> file like any other go import - with its full url-like path. That is true even if your <code>main.go</code> is in the same directory as your dependency. \nThere is a specific way in which everyone should manage go code dependencies and you can read about it here: </p>\n\n<p><a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to write go code</a></p>\n\n<p>It does feel weird to follow a common standard of how to organize your workspace (at least to me it did when I first started with go) - but since you run into errors like yours if you don't follow them; just try to do it.</p>\n\n<p>A pretty good place to start (after you've read 'how to write go code') is actually the error message you got. It will change if you change your import statement/directory structure and it will help you to specify the full path to your dependency in your <code>import ...</code> statement.</p>\n"}], "owner": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3120, "favorite_count": 1, "accepted_answer_id": 50902649, "answer_count": 2, "score": 1, "last_activity_date": 1529443500, "creation_date": 1529294220, "question_id": 50902502, "link": "https://stackoverflow.com/questions/50902502/cannot-import-proto-file", "title": "cannot import proto file", "body": "<p>I have spent hours trying to read blogs on how to use simple proto file in Golang. I generated the .pb.go files. All internet examples are littered with doing import from some random <code>\"github...</code> urls for proto import. I am not able to find any example on how to import a simple proto file that exists in same dir as my .go file or diff directory. How do I use proto files from local file systems.</p>\n\n<pre><code>go build hello.go\nhello.go:5:2: cannot find package \"customer\" in any of:\n    /usr/local/go/src/customer (from $GOROOT)\n    /Users/myhomedir/go/src/customer (from $GOPATH)\n</code></pre>\n\n<p>Contentes of <code>hello.go</code>in $SOME_DIR/customer</p>\n\n<pre><code>package main\n\nimport  (\n    \"fmt\"\n    pb \"customer\"\n)\n\nfunc main() {\n    fmt.Println(\"hello test message\\n\")\n}\n</code></pre>\n\n<p>Contents of <code>customer.proto</code></p>\n\n<pre><code>syntax = \"proto3\";\npackage customer;\n\n\n// The Customer service definition.\nservice Customer {\n  // Get all Customers with filter - A server-to-client streaming RPC.\n  rpc GetCustomers(CustomerFilter) returns (stream CustomerRequest) {}\n  // Create a new Customer - A simple RPC\n  rpc CreateCustomer (CustomerRequest) returns (CustomerResponse) {}\n}\n\n// Request message for creating a new customer\nmessage CustomerRequest {\n  int32 id = 1;  // Unique ID number for a Customer.\n  string name = 2;\n  string email = 3;\n  string phone= 4;\n\n  message Address {\n    string street = 1;\n    string city = 2;\n    string state = 3;\n    string zip = 4;\n    bool isShippingAddress = 5;\n  }\n\n  repeated Address addresses = 5;\n}\n\nmessage CustomerResponse {\n  int32 id = 1;\n  bool success = 2;\n}\nmessage CustomerFilter {\n  string keyword = 1;\n}\n</code></pre>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 6316, "user_id": 226145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b713823a49df6d9c2f9a24d0728add5?s=128&d=identicon&r=PG", "display_name": "ThanhHH", "link": "https://stackoverflow.com/users/226145/thanhhh"}, "edited": false, "score": 0, "creation_date": 1529290491, "post_id": 50902074, "comment_id": 88804141, "body": "What do you do with count variable in this case? You mean count is the counter of people records, isn&#39;t it?"}, {"owner": {"reputation": 383, "user_id": 9684016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef1b3774f79c2b02b77c344c82aae71?s=128&d=identicon&r=PG&f=1", "display_name": "v v", "link": "https://stackoverflow.com/users/9684016/v-v"}, "reply_to_user": {"reputation": 6316, "user_id": 226145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b713823a49df6d9c2f9a24d0728add5?s=128&d=identicon&r=PG", "display_name": "ThanhHH", "link": "https://stackoverflow.com/users/226145/thanhhh"}, "edited": false, "score": 0, "creation_date": 1529290957, "post_id": 50902074, "comment_id": 88804224, "body": "@ThanhHH Yes. I have updated the question. Sorry for one line mistake."}], "answers": [{"comments": [{"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 2, "creation_date": 1529292948, "post_id": 50902185, "comment_id": 88804589, "body": "Can also use <code>fmt.Sprintf(&quot;%v&quot;, count)</code> but I believe the above is faster."}], "tags": [], "owner": {"reputation": 5105, "user_id": 373815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vBPZK.png?s=128&g=1", "display_name": "chuckx", "link": "https://stackoverflow.com/users/373815/chuckx"}, "is_accepted": true, "score": 2, "last_activity_date": 1529293519, "last_edit_date": 1529293519, "creation_date": 1529290711, "answer_id": 50902185, "question_id": 50902074, "link": "https://stackoverflow.com/questions/50902074/how-to-change-integer-to-string-with-go-in-this-case/50902185#50902185", "title": "How to change integer to string with go in this case?", "body": "<p>In the <code>c.Header()</code> call pass the value of the variable instead of a pointer.</p>\n\n<pre><code>c.Header(\"X-Total-Count\", strconv.Itoa(count))\n</code></pre>\n\n<p>For reference, <a href=\"https://github.com/gin-gonic/gin/blob/caf3e350a548af1add9def68087ac53d1d000caa/context.go#L612\" rel=\"nofollow noreferrer\">the method signature</a> is:</p>\n\n<pre><code>func (c *Context) Header(key, value string) {\n</code></pre>\n"}], "owner": {"reputation": 383, "user_id": 9684016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef1b3774f79c2b02b77c344c82aae71?s=128&d=identicon&r=PG&f=1", "display_name": "v v", "link": "https://stackoverflow.com/users/9684016/v-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 50902185, "answer_count": 1, "score": 0, "last_activity_date": 1529293519, "creation_date": 1529289440, "last_edit_date": 1529290477, "question_id": 50902074, "link": "https://stackoverflow.com/questions/50902074/how-to-change-integer-to-string-with-go-in-this-case", "title": "How to change integer to string with go in this case?", "body": "<p>Using <code>gorm</code> to connect db. Here get all the records:</p>\n\n<pre><code>  func GetPeople(c *gin.Context) {\n         var people []Person\n         var count int\n\n         find_people := db.Find(&amp;people)\n         find_people.Count(&amp;count)\n         if err := find_people.Error; err != nil {\n                 c.AbortWithStatus(404)\n                 fmt.Println(err)\n         } else {\n                 c.Header(\"X-Total-Count\", &amp;count)\n                 c.JSON(200, people)\n         }\n  }\n</code></pre>\n\n<p>About <code>count</code>, the <code>c.Header(\"X-Total-Count\", &amp;count)</code> can't passed since this error:</p>\n\n<pre><code>cannot use &amp;count (type *int) as type string in argument to c.Header\n</code></pre>\n\n<p>Have tried <code>strconv.Itoa(&amp;count)</code>, got another error:</p>\n\n<pre><code>cannot use &amp;count (type *int) as type int in argument to strconv.Itoa\n</code></pre>\n\n<p>So how to convert integer to string in this case?</p>\n"}, {"tags": ["rest", "go"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1529261721, "post_id": 50898622, "comment_id": 88798939, "body": "If it is an http error then return the same using <code>http.Error</code> if it is compilation error then return it using custom http status"}], "answers": [{"comments": [{"owner": {"reputation": 17424, "user_id": 278842, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/df6877d3f05e542ca5975b4670600f2e?s=128&d=identicon&r=PG", "display_name": "Christopher Oezbek", "link": "https://stackoverflow.com/users/278842/christopher-oezbek"}, "edited": false, "score": 0, "creation_date": 1537907003, "post_id": 50899967, "comment_id": 91952738, "body": "One thing missing is how to figure out what kind/type of error was returned by a func. Reflection?"}, {"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "reply_to_user": {"reputation": 17424, "user_id": 278842, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/df6877d3f05e542ca5975b4670600f2e?s=128&d=identicon&r=PG", "display_name": "Christopher Oezbek", "link": "https://stackoverflow.com/users/278842/christopher-oezbek"}, "edited": false, "score": 0, "creation_date": 1538048858, "post_id": 50899967, "comment_id": 92011886, "body": "I am not sure what the usecase for this is that&#39;s not already covered.  Depending on the style of errors that the code you are consuming returns, there&#39;s different ways of checking.  As an example, the <code>io</code> package returns sentinel errors which are tested with equality, and the <code>os</code> package returns <code>os.PathError</code> which are tested with type assertion"}, {"owner": {"reputation": 17424, "user_id": 278842, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/df6877d3f05e542ca5975b4670600f2e?s=128&d=identicon&r=PG", "display_name": "Christopher Oezbek", "link": "https://stackoverflow.com/users/278842/christopher-oezbek"}, "edited": false, "score": 0, "creation_date": 1538081634, "post_id": 50899967, "comment_id": 92029840, "body": "But how do you know what type of error a function returns? Looking at the source?"}, {"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "reply_to_user": {"reputation": 17424, "user_id": 278842, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/df6877d3f05e542ca5975b4670600f2e?s=128&d=identicon&r=PG", "display_name": "Christopher Oezbek", "link": "https://stackoverflow.com/users/278842/christopher-oezbek"}, "edited": false, "score": 0, "creation_date": 1538126332, "post_id": 50899967, "comment_id": 92043028, "body": "Docs or source, there&#39;s no nice way to achieve that programatically"}], "tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": true, "score": 8, "last_activity_date": 1537907035, "last_edit_date": 1537907035, "creation_date": 1529265071, "answer_id": 50899967, "question_id": 50898622, "link": "https://stackoverflow.com/questions/50898622/how-to-determine-what-kind-of-error-message-i-should-return-from-golang-api/50899967#50899967", "title": "How to determine what kind of error message I should return from golang API?", "body": "<p>The first thing to say about errors is that just because there's an error interface</p>\n\n<pre><code>type error interface {\n    Error() string\n}\n</code></pre>\n\n<p>Does not mean that the <code>error</code> returned from any given method can <em>only</em> have that method / information attached to it.</p>\n\n<p>One common method is to define your own error interface:</p>\n\n<pre><code>type myError interface {\n    error // embeds the standard error interface\n    OtherMethod() string // can define own methods here\n}\n</code></pre>\n\n<p>When writing methods and functions it's <strong>really important</strong> to return an <code>error</code> and not <code>myError</code>, else you couple that method to your error implementation and cause dependency nightmares for yourself later.</p>\n\n<p>Now that we've decided we can return extra information from error, using our own error interfaces you've got 3 main choices.</p>\n\n<ol>\n<li>Sentinel errors </li>\n<li>Error Failure types</li>\n<li>Errors with Behaviour</li>\n</ol>\n\n<h2>Sentinel errors</h2>\n\n<p>Sentinel errors are error values that are defined as package level variables, are exported and allow comparison to check for errors.</p>\n\n<pre><code>package myPackage\n\nvar ErrConnectionFailed = errors.New(\"connection failed\")\n\nfunc Connect() error {\n    // trimmed ...\n    return ErrConnectionFailed\n}\n</code></pre>\n\n<p>A consumer of this example could use the connect function:</p>\n\n<pre><code>if err := myPackage.Connect(); err == myPackage.ErrConnectionFailed {\n    // handle connection failed state\n}\n</code></pre>\n\n<p>You can do a comparison to check if the error returned is equal to the sentinel error of the package. The drawback is that any error created with <code>errors.New(\"connection failed\")</code> will be equal, and <strong>not just</strong> the error from <code>myPackage</code>.</p>\n\n<h2>Error failure types</h2>\n\n<p>Slightly better than sentinel errors are error failure types.\nWe've already seen that you can define your own error interface, and if we say ours is now:</p>\n\n<pre><code>type MyError interface {\n    error\n    Failure() string\n} \n\ntype Err struct {\n    failure string\n}\n\nfunc (e *Err) Error() string {\n    // implement standard error\n}\n\nfunc (e *Err) Failure() string {\n    return e.failure\n}\n\nconst ConnFailed = \"connection failed\"\n\nerr := &amp;Err{failure: ConnFailed}\n</code></pre>\n\n<p>In the consumer code you can get an error, check if it implements <code>MyError</code> and then do things with it.</p>\n\n<pre><code>err := myPackage.Connect()\n\nif myErr, ok := err.(myPackage.MyError); ok {\n    // here you know err is a MyError\n    if myErr.Failure() == myPackage.ConnFailed {\n        // handle connection failed, could also use a switch instead of if\n    }\n}\n</code></pre>\n\n<p>Now you have an idea of what caused the error which is nice. But do you really care what the cause was? Or do you only really care what you want to do to <strong>handle</strong> that error. </p>\n\n<p>This is where errors with behaviour are nice.</p>\n\n<h2>Errors with behaviour</h2>\n\n<p>This is similar to defining your own error type, but instead you define methods that report information about that error. Given the example above, do you really care that the connection failed, or do you really only care if you can retry or if you need to error up the call stack again?</p>\n\n<pre><code>package myPackage\n\n// this interface could report if the error\n// is temporary and if you could retry it\ntype tempErr interface {\n    Temporary() bool\n}\n\nfunc (e *Err) Temporary() bool {\n    // return if the error is temporary or not\n}\n</code></pre>\n\n<p>Now in the consumer (note you don't need to use the <code>myPackage.tempErr</code>), you can test using type assertions if the error is temporary and handle the retry case:</p>\n\n<pre><code>err := myPackage.Connect()\n\nif tmp, ok := err.(interface { Temporary() bool }); ok &amp;&amp; tmp.Temporary() {\n    // the error is temporary and you can retry the connection\n}\n</code></pre>\n\n<p><strong>To answer the question</strong>, it's very hard to say without the specifics of the service that you are trying to implement. But as broad advice, I would try and use the last of the 3 examples as much as possible.</p>\n\n<p>If the consumer of your service sends you some input that's not valid:</p>\n\n<pre><code>err := doThing(...)\n\nif inv, ok := err.(interface { Invalid() bool }); ok &amp;&amp; inv.Invalid() {\n    // input is invalid, return 400 bad request status code etc.\n}\n</code></pre>\n\n<p>If you want to return a specific message to a consumer, you could make that a method of your error type. Warning: this would give your packages knowledge that they are being used in a web service, etc.</p>\n\n<pre><code>err := doThing(...)\n\nif msg, ok := err.(interface { ResponseMsg() string }); ok {\n    // write the message to the http response\n    io.WriteString(response, msg.ResponseMsg())\n}\n</code></pre>\n\n<p><strong>TL;DR</strong> you would need to handle all the cases, but you can create error types that make the code much easier to work with!</p>\n"}], "owner": {"reputation": 305, "user_id": 8406346, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3805482de243084ae3898bd42f413496?s=128&d=identicon&r=PG&f=1", "display_name": "JohnStephen.19", "link": "https://stackoverflow.com/users/8406346/johnstephen-19"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 956, "favorite_count": 0, "accepted_answer_id": 50899967, "answer_count": 1, "score": 4, "last_activity_date": 1537907035, "creation_date": 1529253938, "last_edit_date": 1529273179, "question_id": 50898622, "link": "https://stackoverflow.com/questions/50898622/how-to-determine-what-kind-of-error-message-i-should-return-from-golang-api", "title": "How to determine what kind of error message I should return from golang API?", "body": "<p>I have a GoLang API with an SPA to consume it. What I do to errors in my API is return them until the handler where I test if an error from previous functions exist. If there is an error, I put it inside the response body, set status code to either 400 or 500 then return the response</p>\n\n<p>in the handler function, to be able to create a clear message to the client side, I need to know what kind of error was returned, how do I do it?</p>\n\n<p>I know about error types but I read about Dave Cheney's recommendation to just return an error along with a message (or wrap them in other words).</p>\n\n<p>But if there are so many kinds of errors which might occur in the API call, then does it mean before returning the response, I need to check them all just to know what message I should return?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 9699047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803630c30c8c916a86c9b2db119ea06a?s=128&d=identicon&r=PG&f=1", "display_name": "TalkingJson", "link": "https://stackoverflow.com/users/9699047/talkingjson"}, "edited": false, "score": 0, "creation_date": 1529252164, "post_id": 50898293, "comment_id": 88796520, "body": "Thanks, this what i want!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1529251322, "creation_date": 1529251322, "answer_id": 50898293, "question_id": 50898267, "link": "https://stackoverflow.com/questions/50898267/go-add-gzip-compression-to-all-handlers/50898293#50898293", "title": "Go add gzip compression to all handlers", "body": "<p>Change the gzip middleware to work with http.Handler instead of http.HandlerFunc:</p>\n\n<pre><code>func gzipHandler(h http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        if !strings.Contains(r.Header.Get(\"Accept-Encoding\"), \"gzip\") {\n            h.ServeHTTP(w, r)\n            return\n        }\n        w.Header().Set(\"Content-Encoding\", \"gzip\")\n        gz := gzip.NewWriter(w)\n        defer gz.Close()\n        h.ServeHTTP(gzipResponseWriter{Writer: gz, ResponseWriter: w}, r)\n    })\n}\n</code></pre>\n\n<p>Wrap the root handler:</p>\n\n<pre><code>http.ListenAndServe(\":80\", gzipHandler(cacheHandler(http.DefaultServeMux)))\n</code></pre>\n\n<p>If <a href=\"https://stackoverflow.com/questions/50889810/go-set-header-for-all-handlers\">cacheHandler is also middleware that you are writing</a>, then you might want to combine the middleware:</p>\n\n<pre><code>func wrap(h http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n         w.Header().Set(\"Cache-Control\", \"max-age=1800\")  // &lt;--- add code from cache handler\n        if !strings.Contains(r.Header.Get(\"Accept-Encoding\"), \"gzip\") {\n            h.ServeHTTP(w, r)\n            return\n        }\n        w.Header().Set(\"Content-Encoding\", \"gzip\")\n        gz := gzip.NewWriter(w)\n        defer gz.Close()\n        h.ServeHTTP(gzipResponseWriter{Writer: gz, ResponseWriter: w}, r)\n    })\n}\n\n...\n\nhttp.ListenAndServe(\":80\", wrap(http.DefaultServeMux))\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 9699047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803630c30c8c916a86c9b2db119ea06a?s=128&d=identicon&r=PG&f=1", "display_name": "TalkingJson", "link": "https://stackoverflow.com/users/9699047/talkingjson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1718, "favorite_count": 0, "accepted_answer_id": 50898293, "answer_count": 1, "score": 3, "last_activity_date": 1529251322, "creation_date": 1529251102, "question_id": 50898267, "link": "https://stackoverflow.com/questions/50898267/go-add-gzip-compression-to-all-handlers", "title": "Go add gzip compression to all handlers", "body": "<p>I'm want to add gzip compression to all handlers. Here how it looks now </p>\n\n<pre><code>func gzipHandler(fn http.HandlerFunc) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        if !strings.Contains(r.Header.Get(\"Accept-Encoding\"), \"gzip\") {\n            fn(w, r)\n            return\n        }\n        w.Header().Set(\"Content-Encoding\", \"gzip\")\n        gz := gzip.NewWriter(w)\n        defer gz.Close()\n        fn(gzipResponseWriter{Writer: gz, ResponseWriter: w}, r)\n    }\n}\n\nhttp.Handle(\"/\", http.FileServer(http.Dir(\"./index\")))\nhttp.HandleFunc(\"/json\", gzipHandler(sendJSONHandler))\nhttp.HandleFunc(\"/contact\", gzipHandler(contactHandler))\nhttp.Handle(\"/static/\", http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"./static\"))))\nhttp.ListenAndServe(\":80\", cacheHandler(http.DefaultServeMux))\n</code></pre>\n\n<p>I want to do something like in last line with <code>cacheHandler</code></p>\n"}, {"tags": ["pointers", "go"], "answers": [{"tags": [], "owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "is_accepted": false, "score": 1, "last_activity_date": 1529250661, "creation_date": 1529250661, "answer_id": 50898202, "question_id": 50898117, "link": "https://stackoverflow.com/questions/50898117/how-to-use-pointers/50898202#50898202", "title": "How to use pointers", "body": "<p><code>http.Client</code> has a Get method with a pointer receiver (<a href=\"https://golang.org/pkg/net/http/#Client.Get\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#Client.Get</a>), having the same signature as required by your <code>HTTPCLient</code> interface, so it works !</p>\n"}, {"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 1, "last_activity_date": 1529262330, "last_edit_date": 1529262330, "creation_date": 1529250920, "answer_id": 50898241, "question_id": 50898117, "link": "https://stackoverflow.com/questions/50898117/how-to-use-pointers/50898241#50898241", "title": "How to use pointers", "body": "<p>You are implementing a <code>HTTPClient</code> interface which takes a function <code>Get</code>. In go lang spec it is defined as </p>\n\n<pre><code>func (c *Client) Get(url string) (resp *Response, err error) {\n    req, err := NewRequest(\"GET\", url, nil)\n    if err != nil {\n        return nil, err\n    }\n    return c.Do(req)\n}\n</code></pre>\n\n<p>In above function <code>*Client</code> is a pointer receiver to method <code>GET</code>. Client is a struct declared in <a href=\"https://golang.org/src/net/http/client.go?s=12847:12907#L381\" rel=\"nofollow noreferrer\">Go source</a>. For more information on <code>http.Client</code> struct defined in <code>net/http</code> package Check out <a href=\"https://golang.org/pkg/net/http/#Client\" rel=\"nofollow noreferrer\">Golang Spec</a>.</p>\n\n<p>In your first example code you are passing a pointer to <code>Change</code> function.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype A interface{\n    Change(n *int)\n} \n\nfunc main() {\n    x := 10\n    Change(&amp;x)\n}\n\nfunc Change(n *int) {\n    fmt.Println(*n+1)\n}\n</code></pre>\n\n<p>Check working example on <a href=\"https://play.golang.org/p/vATrnj3TJ5f\" rel=\"nofollow noreferrer\">Go playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": true, "score": 3, "last_activity_date": 1529251197, "creation_date": 1529251197, "answer_id": 50898277, "question_id": 50898117, "link": "https://stackoverflow.com/questions/50898117/how-to-use-pointers/50898277#50898277", "title": "How to use pointers", "body": "<p><code>HTTPClient</code> is an interface, it defines a single method <code>Get(...)</code></p>\n\n<p>The client struct, from <code>http.Client</code> also has a get method, <a href=\"https://golang.org/pkg/net/http/#Client.Get\" rel=\"nofollow noreferrer\">docs here.</a></p>\n\n<pre><code>func (c *Client) Get(url string) (resp *Response, err error) {\n    // trimmed ...\n}\n</code></pre>\n\n<p><a href=\"https://github.com/golang/go/blob/05f8b44d5edc2960eff106e5e780cf83535d0533/src/net/http/client.go#L391-L397\" rel=\"nofollow noreferrer\">Source code</a></p>\n\n<p>You can see from the definition above that <code>Get(url)</code> has a \"pointer receiver\". This means that <code>*http.Client</code> defines the <code>Get(url)</code> method and <strong>not</strong> <code>http.Client</code>.  This means that <code>*httpClient</code> implements the <code>HTTPClient</code> interface and not <code>http.Client</code>.</p>\n\n<p>The last thing worth pointing out is that the go runtime will automatically dereference pointers if, the an interface is implemented by a \"value receiver\" and not a \"pointer receiver\". </p>\n\n<p>An example of this could be:</p>\n\n<pre><code>type Valuer interface {\n    Value() string\n}\n\ntype V struct {}\n\ntype (valueReceiver V) Value() string {\n    // trimmed ...\n}\n\n// Here given a *V not V, go will dereference *V to call the Value() method on V not *V\nvPtr := &amp;V{}\nvPtr.Value()\n</code></pre>\n"}], "owner": {"reputation": 5807, "user_id": 463061, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a80a3e7f6133a86bb0069448b2a02f08?s=128&d=identicon&r=PG", "display_name": "govin", "link": "https://stackoverflow.com/users/463061/govin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 50898277, "answer_count": 3, "score": 0, "last_activity_date": 1531473747, "creation_date": 1529249848, "last_edit_date": 1531473747, "question_id": 50898117, "link": "https://stackoverflow.com/questions/50898117/how-to-use-pointers", "title": "How to use pointers", "body": "<p>Let's say I have this function</p>\n\n<pre><code>func main() {\n    x := 10\n    change(&amp;x)\n}\n\nfunc change(n *int) {\n\n}\n</code></pre>\n\n<p>If I don't use in <code>n *int</code> the signature, the above function gives an error - </p>\n\n<blockquote>\n  <p>*cannot use &amp;x (type <em>int) as type int in argument to change</em></p>\n</blockquote>\n\n<p>But why does the below example run fine without requiring a client *HTTPClient in the argument of send method though I'm passing a pointer in this case? </p>\n\n<pre><code>import (\n  \"net/http\"\n)\n\n// HTTPClient interface for making http requests\ntype HTTPClient interface {\n    Get(url string) (*http.Response, error)\n}\n\n\nfunc main() {\n    client := &amp;http.Client{}\n    err := send(client, url)\n}\n\nfunc send(client HTTPClient, url string) error {\n}\n</code></pre>\n"}, {"tags": ["go", "bigtable", "google-cloud-bigtable"], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 6097285, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caed10d0c712a106142e2bb79a8cd665?s=128&d=identicon&r=PG&f=1", "display_name": "yogesh_desai", "link": "https://stackoverflow.com/users/6097285/yogesh-desai"}, "edited": false, "score": 1, "creation_date": 1529315516, "post_id": 50901602, "comment_id": 88813412, "body": "Thank you, It worked. I am using Mac, so just the Go installation steps are different for me. :)"}, {"owner": {"reputation": 650, "user_id": 3316842, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/27a97d409966980c6c4799dbf12d1903?s=128&d=identicon&r=PG&f=1", "display_name": "baskInEminence", "link": "https://stackoverflow.com/users/3316842/baskineminence"}, "edited": false, "score": 0, "creation_date": 1580712420, "post_id": 50901602, "comment_id": 106172836, "body": "The example works for me as well; however, I cannot seem to get it working in a docker compose environment. I have the bigtable container running within docker compose but my service container cannot connect to it. I made sure to set the environment variable in my service container for BIGTABLE_EMULATOR_HOST but no luck. Any ideas?"}, {"owner": {"reputation": 5105, "user_id": 373815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vBPZK.png?s=128&g=1", "display_name": "chuckx", "link": "https://stackoverflow.com/users/373815/chuckx"}, "edited": false, "score": 0, "creation_date": 1581094482, "post_id": 50901602, "comment_id": 106327508, "body": "I&#39;m not familiar with the Docker Compose environment, but you may need to set <code>BIGTABLE_EMULATOR_HOST</code> to a value other than <code>localhost:8006</code> in order to target an emulator instance running on a different container. If you continue to have issues, it would be best to ask a new question."}], "tags": [], "owner": {"reputation": 5105, "user_id": 373815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vBPZK.png?s=128&g=1", "display_name": "chuckx", "link": "https://stackoverflow.com/users/373815/chuckx"}, "is_accepted": true, "score": 14, "last_activity_date": 1529874883, "last_edit_date": 1529874883, "creation_date": 1529283786, "answer_id": 50901602, "question_id": 50897883, "link": "https://stackoverflow.com/questions/50897883/how-to-connect-to-bigtable-emulator-from-a-golang-application-how-to-use-it/50901602#50901602", "title": "How to connect to Bigtable Emulator from a GoLang application? How to use it?", "body": "<p><a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go/blob/ae1e370c02c69f7fdf74e2aec865e8f7ae8f89b0/bigtable/internal/option/option.go#L34\" rel=\"noreferrer\">The <code>BIGTABLE_EMULATOR_HOST</code> environment variable overrides the normal connection logic</a>. Having it set causes a client to connect to the emulator without any special changes needed in the code (i.e. the project/instance values passed to <code>NewAdminClient()</code>/<code>NewClient()</code> are ignored).</p>\n\n<p>The command provided in <a href=\"https://cloud.google.com/bigtable/docs/emulator?authuser=2#using_the_emulator\" rel=\"noreferrer\">step 2 of the <strong>Using the emulator</strong> instructions</a> sets the environment variable for you.</p>\n\n<p>See the implementation of <a href=\"https://github.com/GoogleCloudPlatform/golang-samples/blob/master/bigtable/helloworld/main.go\" rel=\"noreferrer\"><code>GoogleCloudPlatform/golang-samples/bigtable/helloworld/main.go</code></a> for a simple, concrete example of interacting with a BigTable instance.</p>\n\n<hr>\n\n<h3>Walkthrough</h3>\n\n<p>To demonstrate using the Bigtable Emulator from go, I'm using a <a href=\"https://cloud.google.com/free/\" rel=\"noreferrer\">free tier, f1-micro Compute Engine instance</a>. It's an instance where I hadn't used go before, so it's basically a clean slate.</p>\n\n<p>First things first, I setup my go environment:</p>\n\n<pre><code>$ sudo apt install golang\n&lt;... SNIP apt output ...&gt;\n$ mkdir ~/go\n$ export GOPATH=$HOME/go\n</code></pre>\n\n<p>Then I updated the <code>google-cloud-sdk</code> package and installed the <code>google-cloud-sdk-bigtable-emulator</code> package:</p>\n\n<pre><code>$ sudo apt install google-cloud-sdk\n&lt;... SNIP apt output ...&gt;\n$ sudo apt install google-cloud-sdk-bigtable-emulator\n&lt;... SNIP apt output ...&gt;\n</code></pre>\n\n<p>At this point the emulator is ready to run, so I started it using the documented command:</p>\n\n<pre><code>$ gcloud beta emulators bigtable start\nExecuting: /usr/lib/google-cloud-sdk/platform/bigtable-emulator/cbtemulator --host=localhost --port=8086\n[bigtable] Cloud Bigtable emulator running on 127.0.0.1:8086\n</code></pre>\n\n<p>After starting it, it runs in the foreground, so I left that terminal alone and started a new one.</p>\n\n<p>In the new terminal, the first thing is setting the <code>BIGTABLE_EMULATOR_HOST</code> environment variable. This step is documented in the emulator instructions.  The following command generates the shell command for setting the variable. To see the command it generates it, run it directly:</p>\n\n<pre><code>$ gcloud beta emulators bigtable env-init\nexport BIGTABLE_EMULATOR_HOST=localhost:8086\n</code></pre>\n\n<p>Running the command enclosed in <code>$(...)</code> as documented tells the shell to execute the output of the command, thereby setting the variable:</p>\n\n<pre><code>$ $(gcloud beta emulators bigtable env-init)\n</code></pre>\n\n<p>Now that the emulator is running and the environment is ready, I need a client application to to connect to it. I chose to use the <code>helloworld</code> application from the <a href=\"https://github.com/GoogleCloudPlatform/golang-samples\" rel=\"noreferrer\">GoogleCloudPlatform/golang-samples repository</a>.</p>\n\n<pre><code>$ git clone https://github.com/GoogleCloudPlatform/golang-samples.git\n$ cd golang-samples/bigtable/helloworld\n</code></pre>\n\n<p>In the main.go file in the above directory, the <code>cloud.google.com/go/bigtable</code> and <code>golang.org/x/net/context</code> packages are imported, so I ran <code>go get</code> to fetch both of them.</p>\n\n<pre><code>$ go get cloud.google.com/go/bigtable\n$ go get golang.org/x/net/context\n</code></pre>\n\n<p>Then I ran the example application, using dummy values for the <code>-project</code> and <code>-instance</code> flags, since it's going to be connecting to the locally running emulator.</p>\n\n<pre><code>$ go run main.go -project foo -instance bar\n2018/06/18 00:39:27 Creating table Hello-Bigtable\n2018/06/18 00:39:27 Writing greeting rows to table\n2018/06/18 00:39:27 Getting a single greeting by row key:\n2018/06/18 00:39:27     greeting0 = Hello World!\n2018/06/18 00:39:27 Reading all greeting rows:\n2018/06/18 00:39:27     greeting0 = Hello World!\n2018/06/18 00:39:27     greeting1 = Hello Cloud Bigtable!\n2018/06/18 00:39:27     greeting2 = Hello golang!\n2018/06/18 00:39:27 Deleting the table\n</code></pre>\n\n<p>Nothing really happens in the emulator terminal to indicate it's being used. So, to demonstrate that it's actually interacting with the emulator, I stopped the emulator process (by pressing Ctrl-C in it's terminal) and tried executing the client application again:</p>\n\n<pre><code>$ go run main.go -project foo -instance bar\n2018/06/18 00:40:03 Retryable error: rpc error: code = Unavailable desc = all SubConns are in TransientFailure, latest connection error: connection error: desc = \"transport: Error while dialing dial tcp [::1]:8086: getsockopt: connection refused\", retrying in 47.77941ms\n2018/06/18 00:40:03 Retryable error: rpc error: code = Unavailable desc = all SubConns are in TransientFailure, latest connection error: connection error: desc = \"transport: Error while dialing dial tcp [::1]:8086: getsockopt: connection refused\", retrying in 2.153551ms\n2018/06/18 00:40:03 Retryable error: rpc error: code = Unavailable desc = all SubConns are in TransientFailure, latest connection error: connection error: desc = \"transport: Error while dialing dial tcp [::1]:8086: getsockopt: connection refused\", retrying in 114.145821ms\n&lt;... SNIP repeated errors ...&gt;\n^Csignal: interrupt\n$\n</code></pre>\n\n<p>So, using an unmodified client application interacts with the emulator just by having the proper environment variable set.</p>\n"}], "owner": {"reputation": 379, "user_id": 6097285, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caed10d0c712a106142e2bb79a8cd665?s=128&d=identicon&r=PG&f=1", "display_name": "yogesh_desai", "link": "https://stackoverflow.com/users/6097285/yogesh-desai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1458, "favorite_count": 1, "accepted_answer_id": 50901602, "answer_count": 1, "score": 7, "last_activity_date": 1529874883, "creation_date": 1529248002, "last_edit_date": 1529332861, "question_id": 50897883, "link": "https://stackoverflow.com/questions/50897883/how-to-connect-to-bigtable-emulator-from-a-golang-application-how-to-use-it", "title": "How to connect to Bigtable Emulator from a GoLang application? How to use it?", "body": "<p>I am trying to use BigTable Emulator. I have never used it before. I followed the <a href=\"https://cloud.google.com/bigtable/docs/emulator?authuser=2\" rel=\"noreferrer\">documentation</a> but not able to understand,</p>\n\n<ol>\n<li>How to connect an application to Emulator.</li>\n<li>How to set <code>BIGTABLE_EMULATOR_HOST</code> environment variable.</li>\n</ol>\n\n<p>Please help by explaining it or pointing me to any examples or links.\nThank you.</p>\n"}, {"tags": ["go", "rabbitmq", "amqp"], "answers": [{"comments": [{"owner": {"reputation": 1132, "user_id": 758667, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/32362f67f7ed51a95ad502da44426600?s=128&d=identicon&r=PG", "display_name": "sheshkovsky", "link": "https://stackoverflow.com/users/758667/sheshkovsky"}, "edited": false, "score": 1, "creation_date": 1529245940, "post_id": 50897107, "comment_id": 88794869, "body": "Thanks for the hint. I resolved passing args by defining it like this: <code>headers[&quot;argsrepr&quot;] = []interface{}{&quot;agr1&quot;, &quot;arg2&quot;}</code>"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1529241948, "creation_date": 1529241948, "answer_id": 50897107, "question_id": 50897001, "link": "https://stackoverflow.com/questions/50897001/how-to-publish-task-by-name-to-a-rabbitmq-queue-in-go/50897107#50897107", "title": "How to publish task by name to a RabbitMQ queue in Go?", "body": "<p>Here is an illustration of the symptoms. The <code>fmt</code> format string is apparently  expecting boolean values.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    s := fmt.Sprintf(\"%t %t\", \"arg1\", \"arg2\")\n    fmt.Println(s)\n    t := fmt.Sprintf(\"%t %t\", true, false)\n    fmt.Println(t)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>%!t(string=arg1) %!t(string=arg2)\ntrue false\n</code></pre>\n"}], "owner": {"reputation": 1132, "user_id": 758667, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/32362f67f7ed51a95ad502da44426600?s=128&d=identicon&r=PG", "display_name": "sheshkovsky", "link": "https://stackoverflow.com/users/758667/sheshkovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 1, "accepted_answer_id": 50897107, "answer_count": 1, "score": 1, "last_activity_date": 1529248736, "creation_date": 1529241141, "last_edit_date": 1529248736, "question_id": 50897001, "link": "https://stackoverflow.com/questions/50897001/how-to-publish-task-by-name-to-a-rabbitmq-queue-in-go", "title": "How to publish task by name to a RabbitMQ queue in Go?", "body": "<p>I need to publish a task by name (creating a message on a queue with task name passed in headers, passing some args).</p>\n\n<p>I've done this in Celery (Python) like this:</p>\n\n<pre><code>celery_app.send_task(\"task_name\", args=(\"arg1\", \"arg2\",))\n</code></pre>\n\n<p>Here's my code in Go to do the same thing:</p>\n\n<pre><code>headers := make(amqp.Table)\nheaders[\"argsrepr\"] = []string{\"arg1\", \"arg2\"}\nheaders[\"task\"] = \"task_name\"\n\nbody := \"\"\njsonBody, _ := json.Marshal(body)\n\nerr = ch.Publish(\n  \"\",     // exchange\n  \"queue_name\", // routing key\n  false,  // mandatory\n  false,  // immediate\n  amqp.Publishing {\n    DeliveryMode: amqp.Persistent,\n    ContentType:  \"application/json\",\n    Body:         jsonBody,\n    Headers:      headers,\n  })\n</code></pre>\n\n<p>But I get this error:</p>\n\n<pre><code>Failed to publish a message: table field \"argsrepr\" value [%!t(string=arg1) %!t(string=arg2)] not supported\n</code></pre>\n\n<p>I'm using <code>\"github.com/streadway/amqp\"</code> library to talk with my rabbitmq node. It seems that \"send task by name\" is not implemented in this library.</p>\n"}, {"tags": ["function", "sqlite", "go", "web"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "edited": false, "score": 0, "creation_date": 1529241412, "post_id": 50896947, "comment_id": 88793734, "body": "Changed my post. Now i got following error message: undefined CartList"}, {"owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "edited": false, "score": 0, "creation_date": 1529242332, "post_id": 50896947, "comment_id": 88793941, "body": "This is where the error is located: Cart[i] = equipment"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "edited": false, "score": 0, "creation_date": 1529244430, "post_id": 50896947, "comment_id": 88794520, "body": "@ChristopherG1994: <code>CartList[i] = equipment</code>: error <code>undefined CartList</code>: <code>data.CartList[i] = equipment</code>."}, {"owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "edited": false, "score": 0, "creation_date": 1529246513, "post_id": 50896947, "comment_id": 88795022, "body": "This give me following error: for i:= range result { equipment, err := model.GetEquipmentByID(result[i]) if err != nil {     // handle error } fmt.Println(equipment) data.CartList[i] = equipment }           panic serving [::1]:60965: runtime error: index out of range"}, {"owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "edited": false, "score": 0, "creation_date": 1529247619, "post_id": 50896947, "comment_id": 88795275, "body": "maybe it&#39;s because of Cart: nil, in CartData but what do I have to use else?"}, {"owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "edited": false, "score": 0, "creation_date": 1529255764, "post_id": 50896947, "comment_id": 88797402, "body": "Did this:  List = append(List,equipment)  Now it works"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1529240678, "creation_date": 1529240678, "answer_id": 50896947, "question_id": 50896725, "link": "https://stackoverflow.com/questions/50896725/how-to-change-sqlite-get-function/50896947#50896947", "title": "How to change sqlite get function?", "body": "<p>In Go, never ignore errors. For example,</p>\n\n<pre><code>equipment, err := model.GetEquipment(model.Db)\nif err != nil {\n    // handle error\n}\ndata := CartData{ \n    Name: \"Cart\",\n    Equipment: equipment,\n    // ...\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3857, "user_id": 6395388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1211707342181814/picture?type=large", "display_name": "Derek Brown", "link": "https://stackoverflow.com/users/6395388/derek-brown"}, "edited": false, "score": 1, "creation_date": 1529265466, "post_id": 50898840, "comment_id": 88799912, "body": "While this code snippet may solve the question, <a href=\"http://meta.stackexchange.com/questions/114762/explaining-entirely-code-based-answers\">including an explanation</a> really helps to improve the quality of your post. Remember that you are answering the question for readers in the future, and those people might not know the reasons for your code suggestion."}, {"owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "reply_to_user": {"reputation": 3857, "user_id": 6395388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1211707342181814/picture?type=large", "display_name": "Derek Brown", "link": "https://stackoverflow.com/users/6395388/derek-brown"}, "edited": false, "score": 0, "creation_date": 1529324932, "post_id": 50898840, "comment_id": 88818958, "body": "Thanks for the advice. In the future I will try to improve the quality of my posts."}], "tags": [], "owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "is_accepted": true, "score": 0, "last_activity_date": 1529324882, "last_edit_date": 1529324882, "creation_date": 1529255825, "answer_id": 50898840, "question_id": 50896725, "link": "https://stackoverflow.com/questions/50896725/how-to-change-sqlite-get-function/50898840#50898840", "title": "How to change sqlite get function?", "body": "<p>The append-method solved my problem.</p>\n\n<pre><code>    session, _ := store.Get(r, \"cookie-name\")\n    list := session.Values[\"EquipmentIDs\"].(string)\n\n      result := strings.Split(list, \",\")\n      for i := range result {\n            fmt.Print(i)\n            fmt.Println(result[i])\n        }\n\nvar List[]model.Equipment\n\n        for i := range result {\n        equipment, err := model.GetEquipmentByID(result[i])\n        if err != nil {\n            // handle error\n        }\n        fmt.Println(i)\n        fmt.Println(equipment)\n        List = append(List,equipment)\n    //  List[i] = equipment\n    //  data.CartList[i] = equipment\n        }\n\n\nfmt.Println(List)\n    data := CartData{ \n    Name: \"Cart\",\n    Equipment: model.GetEquipment(model.Db),\n    CartList: List,\n    Pages: []Page{\n        {\n            Title: \"Meine Ger\u00e4te\", \n            Active: false,\n            Link: \"/my-equipment\",\n        },\n        {\n            Title: \"Equipment\", \n            Active: false,\n            Link: \"/equipment\",\n        },\n        {\n            Title: \"Logout\",\n            Active: false,\n            Link: \"/logout\",\n        },\n    },\n\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 1, "accepted_answer_id": 50898840, "answer_count": 2, "score": 0, "last_activity_date": 1529324882, "creation_date": 1529238941, "last_edit_date": 1529247037, "question_id": 50896725, "link": "https://stackoverflow.com/questions/50896725/how-to-change-sqlite-get-function", "title": "How to change sqlite get function?", "body": "<p>how can I change my Get function so that it just returns one Equipment-Objekt?</p>\n\n<pre><code>func GetEquipmentByID(Id string) (equipment Equipment, err error) {\n    equipment = Equipment{}\n    err = Db.QueryRow(\"select ID, Name, Description, ImgPath, Category, Availability, Amount, Storage from Equipment where Id = $1\", Id).Scan(&amp;equipment.ID, &amp;equipment.Name, &amp;equipment.Description, &amp;equipment.ImgPath, &amp;equipment.Category, &amp;equipment.Availability, &amp;equipment.Amount, &amp;equipment.Storage)\n    return \n}\n</code></pre>\n\n<p>I want to use this function to fill an Equipment Array in my Controller. But now it doesnt work, because my function returns 2 objects (Equipment and Error) </p>\n\n<p>I want to use it here: </p>\n\n<pre><code>    func Cart(w http.ResponseWriter,    r   *http.Request)  {\n        data := CartData{ \n        Name: \"Cart\",\n        Equipment: model.GetEquipment(model.Db),\n        CartList: nil,  \n        Pages: []Page{\n            {\n                Title: \"Meine Ger\u00e4te\", \n                Active: false,\n                Link: \"/my-equipment\",\n            },\n            {\n                Title: \"Equipment\", \n                Active: false,\n                Link: \"/equipment\",\n            },\n            {\n                Title: \"Logout\",\n                Active: false,\n                Link: \"/logout\",\n            },\n        },\n\n    }\n\n        session, _ := store.Get(r, \"cookie-name\")\n\n\n      list := session.Values[\"EquipmentIDs\"].(string)\n\n      result := strings.Split(list, \",\")\n      for i := range result {\n            fmt.Print(i)\n            fmt.Println(result[i])\n        }\n\n\n\n     for i:= range result {\nequipment, err := model.GetEquipmentByID(result[i])\nif err != nil {\n    // handle error\n}\ndata.CartList[i] = equipment // ERROR BECAUSE OF THIS LINE\n}\n\n\n\n        tmpl:= template.Must(template.ParseFiles(\"template/base_user.html\", \"template/cart.html\"))\n        tmpl.ExecuteTemplate(w, \"base\", data)\n        }\n    }\n</code></pre>\n\n<p>So my second question is, how can I pass the array in my cart function as data</p>\n"}, {"tags": ["go", "vnc", "vnc-server"], "owner": {"reputation": 33, "user_id": 9952873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/332034dd6a3629a2a170f962ec0829c7?s=128&d=identicon&r=PG&f=1", "display_name": "Bello Daniel", "link": "https://stackoverflow.com/users/9952873/bello-daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1529425018, "creation_date": 1529238119, "last_edit_date": 1529425018, "question_id": 50896588, "link": "https://stackoverflow.com/questions/50896588/vnc-take-screen-print-of-machine", "title": "vnc take screen print of machine", "body": "<p>i looking to take screen print of vnc machine with golang, \nmy actual function is :</p>\n\n<p>.....</p>\n\n<p>code working, problem is when function connect to vnc server  not wait to load vnc image and image black:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nDoNI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nDoNI.png\" alt=\"enter image description here\"></a></p>\n\n<p>.. take print first to finish loading. my neeed is take print screen only after complete loaded.</p>\n\n<p>example code :</p>\n\n<pre><code>VncPrint(\"1.176.68.198\",\"123456\")\n</code></pre>\n\n<p>how i can fix this problem ?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": true, "score": 0, "last_activity_date": 1529251273, "last_edit_date": 1529251273, "creation_date": 1529241413, "answer_id": 50897039, "question_id": 50896285, "link": "https://stackoverflow.com/questions/50896285/mapping-between-the-domain-and-the-database/50897039#50897039", "title": "Mapping between the domain and the database", "body": "<p>You could look for, and use a library; the problem with libs is that they are trying to cater to unknown problems. The author of the library doesn't know how it will be used. This can, in some situations, make them much slower, less flexible, and more complicated that just writing the code yourself.</p>\n\n<p>To start you should extract the duplicate logic from the <code>DataStore</code>:</p>\n\n<pre><code>// extract the logic of copying across the fields to a function\nfunc setFields(u Unit, unit models.Unit) Unit {\n    u.Name = unit.Name\n    u.Description = unit.Description\n    return u\n}\n\nfunc (ds *DataStore) AddUnit(_unit models.Unit) {\n    // trimmed ...\n    unit := setFields(Unit{}, _unit)\n    // trimmed ...\n}\n\nfunc (ds *DataStore) UpdateUnit(id int, _unit models.Unit) models.Unit {\n    unit := Unit{}\n    db.First(&amp;unit, id)\n\n    unit = setFields(unit, _unit)\n\n    // trimmed ...\n}\n</code></pre>\n\n<p>You may then also consider extracting the function call of <code>setFields</code> to a new interface:</p>\n\n<pre><code>type unitSetter interface {\n   setFields(u Unit, unit models.Unit) Unit\n}\n</code></pre>\n\n<p>And add this to the <code>DataStore</code> to make the code more extensible, reusable, and testable.</p>\n\n<pre><code>type DataStore struct {\n    // trimmed ...\n    units unitSetter\n}\n\nfunc (ds *DataStore) AddUnit(_unit models.Unit) {\n    // trimmed ...\n    unit := ds.units.setFields(Unit{}, _unit)\n    // trimmed ...\n}\n</code></pre>\n"}], "owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 50897039, "answer_count": 1, "score": 0, "last_activity_date": 1529251273, "creation_date": 1529235741, "question_id": 50896285, "link": "https://stackoverflow.com/questions/50896285/mapping-between-the-domain-and-the-database", "title": "Mapping between the domain and the database", "body": "<p>I am creating application which get the data from the database and pass them to frontend as JSON.</p>\n\n<p>I think it can be a good idea to create separate <code>structs</code> for the data which I get from the database and the data which I pass to REST services. I am right or it is my mistake ?</p>\n\n<p>In this case I need to map the structs from one layer to another. I do it in the database layer now:</p>\n\n<pre><code>func (ds *DataStore) AddUnit(_unit models.Unit) {\n\n    unit := Unit{}\n    unit.Name = _unit.Name\n    unit.Description = _unit.Description\n    db.Create(&amp;unit)\n}\n\nfunc (ds *DataStore) UpdateUnit(id int, _unit models.Unit) models.Unit {\n\n    unit := Unit{}\n    db.First(&amp;unit, id)\n    unit.Name = _unit.Name\n    unit.Description = _unit.Description\n    db.Save(&amp;unit)\n\n    return _unit\n}\n</code></pre>\n\n<p>Now I have this code in each method for each entity in my code. May be there is some way or library to extract this mapping functionality and describe it using declarative way in the separate file ?</p>\n"}, {"tags": ["go", "io"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 7, "last_activity_date": 1529234806, "creation_date": 1529234806, "answer_id": 50896173, "question_id": 50896032, "link": "https://stackoverflow.com/questions/50896032/understanding-gometalinters-warning-conn-can-be-io-reader-io-writer/50896173#50896173", "title": "Understanding gometalinter&#39;s warning: conn can be io.Reader/io.Writer", "body": "<p>That means that the <code>ListenerButton</code> function is only only using the <code>Write</code> method of <code>conn</code>. By changing the type from <code>net.Conn</code> to <code>io.Writer</code>, that allows your function to use a much larger number of <code>io.Writer</code> implementations. Having as small of interfaces as possible should be a goal when implementing your API.</p>\n\n<p>With that change, for example, you could use an <code>io.MultiWriter</code> to write debug information to stderr, as well as the network connection:</p>\n\n<pre><code>func ListenerButton(number int, button *ui.Button, conn io.Writer) string {\n    // ...\n}\n\nListenerButton(number, button, io.MultiWriter(os.Stderr, networkConn))\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 9076478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FrXue.jpg?s=128&g=1", "display_name": "Mykhailo Tkachenko", "link": "https://stackoverflow.com/users/9076478/mykhailo-tkachenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 50896173, "answer_count": 1, "score": 5, "last_activity_date": 1529234806, "creation_date": 1529233604, "question_id": 50896032, "link": "https://stackoverflow.com/questions/50896032/understanding-gometalinters-warning-conn-can-be-io-reader-io-writer", "title": "Understanding gometalinter&#39;s warning: conn can be io.Reader/io.Writer", "body": "<p>After checking with gometalinter this part of code:</p>\n\n<pre><code>//ListenerButton is hanging listeners for contact button\nfunc ListenerButton(number int, button *ui.Button, conn net.Conn) string {\n    button.OnClicked(func(*ui.Button) {\n        sliceMembers := []string{login, button.Text()}\n        groupName = login + button.Text()\n        _, err := conn.Write([]byte(JSONencode(login, \"\", \"\",\n            0, groupName, 1,\n            login, sliceMembers, \" \", \" \", \"\",\n            \" \", \" \", \" \", true, \" \", \"CreateGroup\")))\n        if err != nil {\n            log.Println(err)\n        }\n        fmt.Println(login, groupName, number, \"graphic 131\")\n    })\n    return groupName\n}\n</code></pre>\n\n<p>I've got this warning:</p>\n\n<pre><code>warning: conn can be io.Writer (interfacer)\n</code></pre>\n\n<p>What does it mean and how i have to resolve it?</p>\n"}, {"tags": ["go", "service", "cmd", "exec", "sc"], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 23, "user_id": 9938123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e118dd8ec2036e617ffa87c7bd9eff92?s=128&d=identicon&r=PG&f=1", "display_name": "tramway", "link": "https://stackoverflow.com/users/9938123/tramway"}, "edited": false, "score": 1, "creation_date": 1529239718, "post_id": 50896097, "comment_id": 88793357, "body": "Note that you don&#39;t need <code>cmd.exe</code> at all in your case."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 2, "last_activity_date": 1529234025, "creation_date": 1529234025, "answer_id": 50896097, "question_id": 50895380, "link": "https://stackoverflow.com/questions/50895380/how-can-i-execute-sc-create-command-through-exec-os-exec/50896097#50896097", "title": "How can i execute sc create command through exec os/exec?", "body": "<p>Well, the immediate problem is that what you do is not how <code>cmd.exe</code> should be told to execute an external command\u2014in order to make it execute one, you should pass <code>cmd.exe</code> either the <code>/C</code> or <code>/K</code> command-line option,\nlike in</p>\n\n<pre><code>C:\\&gt;cmd.exe /C sc whatever sc_arg1 sc_arg2 ...\n</code></pre>\n\n<p>What you observe with your call is that <code>cmd.exe</code> ignores\nthe rest of the arguments you pass to it and just runs\u2014that's\nexactly what you're observing.</p>\n\n<p>Start with studying the output of <code>cmd.exe /?</code> and the\nbuilt-in Windows help system to get better idea of how it works.</p>\n\n<p>The next problem is that there is absolutely no reason to make <code>cmd.exe</code> involved in running <code>sc</code>\u2014just run <code>sc</code> directly rather than jumping around <code>cmd.exe</code> to make it execute <code>sc</code>.</p>\n\n<p>The next problem is that you're ignoring the error value returned\nby the call to <code>os/exec.Cmd.Output</code>. Since Go (luckily) does not\nhave exceptions, handing all error values is of paramount\nimportance\u2014it's better to ignore everything else but not\nerrors.\nIf you're writing highly-experimental code, you might\n<em>start</em> with a dumb helper like</p>\n\n<pre><code>func check(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>and then roll like</p>\n\n<pre><code>out, err := cmd.Output()\ncheck(err)\n</code></pre>\n\n<p>This approach is not for production-grade code, but allows\nfor faster code churn when experimenting.</p>\n\n<p>You might also consider calling directly into Win32 API to\nmanage services as it will make error handling substantially\neasier.</p>\n"}, {"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": false, "score": 2, "last_activity_date": 1529337981, "creation_date": 1529337981, "answer_id": 50913493, "question_id": 50895380, "link": "https://stackoverflow.com/questions/50895380/how-can-i-execute-sc-create-command-through-exec-os-exec/50913493#50913493", "title": "How can i execute sc create command through exec os/exec?", "body": "<p>A little bit late and not really about running sc.exe. While the problem of using SC.exe is solved in the answer @kostix provides, I see that you are trying to create a service of a Go application and consider this an XY problem.</p>\n\n<p>It is not likely that a single call of <code>sc.exe</code> would successfully create a windows service. However, there is a lib to help: <code>golang.org/x/sys/windows/svc</code>. </p>\n\n<p>There is also an example on github: <a href=\"https://github.com/golang/sys/tree/master/windows/svc/example\" rel=\"nofollow noreferrer\">https://github.com/golang/sys/tree/master/windows/svc/example</a></p>\n"}], "owner": {"reputation": 23, "user_id": 9938123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e118dd8ec2036e617ffa87c7bd9eff92?s=128&d=identicon&r=PG&f=1", "display_name": "tramway", "link": "https://stackoverflow.com/users/9938123/tramway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 0, "accepted_answer_id": 50896097, "answer_count": 2, "score": 0, "last_activity_date": 1529337981, "creation_date": 1529227933, "last_edit_date": 1529232647, "question_id": 50895380, "link": "https://stackoverflow.com/questions/50895380/how-can-i-execute-sc-create-command-through-exec-os-exec", "title": "How can i execute sc create command through exec os/exec?", "body": "<p>How can i execute my <code>sc</code> command through <code>exec.Command</code>? </p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>cmd := exec.Command(\"cmd.exe\", \"sc\", \"create\", \"Simpler\", \"binpath=\"+os.Getenv(\"APPDATA\")+\"\\\\Simpler\\\\cc.exe\", \"displayname=MY SERVICE\");\ncmd.SysProcAttr = &amp;syscall.SysProcAttr{HideWindow: true};\nout, _ := cmd.Output(); fmt.Println(string(out))\n</code></pre>\n\n<p>This i get in command prompt (open command prompt in current command prompt -_-): </p>\n\n<pre><code>Microsoft Windows [Version 6.3.9600]\n(c) 2013 Microsoft Corporation. All rights reserved.\n\nC:\\WINDOWS\\system32&gt;cd c:\\prog\\logs\n\nc:\\prog\\logs&gt;go build test.go\n\nc:\\prog\\logs&gt;test.exe\nMicrosoft Windows [Version 6.3.9600]\n(c) 2013 Microsoft Corporation. All rights reserved.\n\nc:\\prog\\logs&gt;\n\nc:\\prog\\logs&gt;\n</code></pre>\n\n<p>Followed command cannot be executed. I do not get anything! Where is the problem?</p>\n\n<p>Command been started if i execute <code>sc.exe</code> in current command prompt but not started if i execute in new command prompt. </p>\n\n<p>That is if i remove first argument <code>\"cmd.exe\"</code> my program succesfully execute with excepted result. But how to execute in a new window?</p>\n"}, {"tags": ["go", "data-structures"], "comments": [{"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 1, "creation_date": 1529202887, "post_id": 50892768, "comment_id": 88786848, "body": "Can you please elaborate on what you have tried and didn&#39;t work? This question is fairly broad and will likely be hard to answer without some more specific details."}, {"owner": {"reputation": 424, "user_id": 6417527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b8872b39c0da12993c80aece9a672a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Smith", "link": "https://stackoverflow.com/users/6417527/michael-smith"}, "reply_to_user": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 0, "creation_date": 1529207724, "post_id": 50892768, "comment_id": 88787367, "body": "&quot;Is there some sort of pretty way to do this in Go&quot; I think is the question here.  An isomorphism of a graph means that it retains the same connection structure as the source graph.  In trying to put together a way of doing this, I stopped short after making a deep copy and realizing the edge connections are to the source graph rather than the new one.  If that&#39;s still not clear please let me know, I feel the question is fairly direct."}, {"owner": {"reputation": 424, "user_id": 6417527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b8872b39c0da12993c80aece9a672a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Smith", "link": "https://stackoverflow.com/users/6417527/michael-smith"}, "reply_to_user": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 0, "creation_date": 1529207810, "post_id": 50892768, "comment_id": 88787376, "body": "If there&#39;s not a direct and concise way of doing it, that&#39;s a perfectly fine answer."}, {"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 0, "creation_date": 1529210442, "post_id": 50892768, "comment_id": 88787723, "body": "There very likely may not be a very concise method if implementing this. In general go does not prioritize clever solutions. I suspect to achieve this you will just have to write several loops that reconstruct the graph in its modified form."}], "answers": [{"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": true, "score": 2, "last_activity_date": 1529211215, "creation_date": 1529211215, "answer_id": 50893821, "question_id": 50892768, "link": "https://stackoverflow.com/questions/50892768/deep-copy-a-graph-structure-in-go/50893821#50893821", "title": "Deep copy a graph structure in Go", "body": "<p>No. There is not a magic way to create an isomorphism of a graph in Go.</p>\n\n<p>One of the principle Go builtin functions and language features follows is that they do not hide complexity, in terms of both time and space. Creating an isomorphism is beyond that scope.</p>\n\n<p>The idea of using a map is the right approach, and I wouldn't call it a pain. A few lines of code can get it done.</p>\n"}], "owner": {"reputation": 424, "user_id": 6417527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b8872b39c0da12993c80aece9a672a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Smith", "link": "https://stackoverflow.com/users/6417527/michael-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 50893821, "answer_count": 1, "score": 0, "last_activity_date": 1529211215, "creation_date": 1529195585, "question_id": 50892768, "link": "https://stackoverflow.com/questions/50892768/deep-copy-a-graph-structure-in-go", "title": "Deep copy a graph structure in Go", "body": "<p>I have some pretty classic looking nodes:  </p>\n\n<pre><code>type MyNode struct {\n    value string\n    edges []*MyNode\n}\n</code></pre>\n\n<p>I use these nodes to build a graph.  When I build this graph, I make connections both ways between nodes with a function:</p>\n\n<pre><code>func (node *MyNode) ConnectTo(otherNode *MyNode) *MyNode {\n    node.edges = append(node.edges, othernode)\n    otherNode.edges = append(otherNode.edges, node)\n    return otherNode\n}\n</code></pre>\n\n<p>I want to make an isomorphism of the graph, so I can perform operations on it and return it as it's own set of nodes.  A simple copy constructor, or a copy() or even normal deep copy methods won't retain the connection structure.</p>\n\n<p>Do I have to go through the pains of making a map between the new structure and the old?  Or is there some sort of pretty Go way to do this?</p>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 4513, "user_id": 3416272, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/xL2ZJ.jpg?s=128&g=1", "display_name": "Md Johirul Islam", "link": "https://stackoverflow.com/users/3416272/md-johirul-islam"}, "edited": false, "score": 2, "creation_date": 1529185855, "post_id": 50891989, "comment_id": 88784724, "body": "<a href=\"https://stackoverflow.com/questions/39011295/when-does-reflect-isvalid-return-false\" title=\"when does reflect isvalid return false\">stackoverflow.com/questions/39011295/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1529194929, "last_edit_date": 1529194929, "creation_date": 1529193467, "answer_id": 50892631, "question_id": 50891989, "link": "https://stackoverflow.com/questions/50891989/why-is-isvalid-returning-true-for-the-zero-value-of-an-int/50892631#50892631", "title": "Why is IsValid() returning true for the zero value of an int?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">Package reflect</a></p>\n\n<pre><code>import \"reflect\" \n</code></pre>\n  \n  <p><a href=\"https://golang.org/pkg/reflect/#Value\" rel=\"nofollow noreferrer\">type Value</a></p>\n  \n  <p>Value is the reflection interface to a Go value.</p>\n  \n  <p>The zero Value represents no value. Its IsValid method returns false,\n  its Kind method returns Invalid, its String method returns \"\", and all other methods panic.</p>\n  \n  <p><a href=\"https://golang.org/pkg/reflect/#ValueOf\" rel=\"nofollow noreferrer\">func ValueOf</a></p>\n\n<pre><code>func ValueOf(i interface{}) Value\n</code></pre>\n  \n  <p>ValueOf returns a new Value initialized to the concrete value stored\n  in the interface i. ValueOf(nil) returns the zero Value.</p>\n  \n  <p><a href=\"https://golang.org/pkg/reflect/#Value.IsValid\" rel=\"nofollow noreferrer\">func (Value) IsValid</a></p>\n\n<pre><code>func (v Value) IsValid() bool\n</code></pre>\n  \n  <p>IsValid reports whether v represents a value. It returns false if v is\n  the zero Value. If IsValid returns false, all other methods except\n  String panic. Most functions and methods never return an invalid\n  value. If one does, its documentation states the conditions\n  explicitly.</p>\n</blockquote>\n\n<hr>\n\n<p><code>int(0)</code> is a concrete value. <code>ValueOf</code> returns a new <code>Value</code> initialized to the concrete value stored in the interface <code>i</code>. <code>ValueOf(nil)</code> returns the zero <code>Value</code>. <code>IsValid</code> reports whether <code>v</code> represents a concrete value. It returns <code>false</code> if <code>v</code> is the zero <code>Value</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    fmt.Printf(\"IsValid(nil) %v\\n\", reflect.ValueOf(nil).IsValid())\n    fmt.Printf(\"IsValid(int(0)) %v\\n\", reflect.ValueOf(int(0)).IsValid())\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>IsValid(nil) false\nIsValid(int(0)) true\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow noreferrer\">The zero value</a></p>\n  \n  <p>When storage is allocated for a variable, either through a declaration\n  or a call of new, or when a new value is created, either through a\n  composite literal or a call of make, and no explicit initialization is\n  provided, the variable or value is given a default value. Each element\n  of such a variable or value is set to the zero value for its type:\n  false for booleans, 0 for numeric types, \"\" for strings, and nil for\n  pointers, functions, interfaces, slices, channels, and maps.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">Package reflect</a></p>\n\n<pre><code>import \"reflect\" \n</code></pre>\n  \n  <p><a href=\"https://golang.org/pkg/reflect/#Zero\" rel=\"nofollow noreferrer\">func Zero</a></p>\n\n<pre><code>func Zero(typ Type) Value\n</code></pre>\n  \n  <p>Zero returns a Value representing the zero value for the specified\n  type. The result is different from the zero value of the Value struct,\n  which represents no value at all. For example, Zero(TypeOf(42))\n  returns a Value with Kind Int and value 0. The returned value is\n  neither addressable nor settable.</p>\n</blockquote>\n\n<hr>\n\n<p>The Go programming language zero value is not the same as the zero Value in the <code>reflect</code> package. Note the difference in the capitalization of the words Value and value. For example, <code>reflect.Zero</code> returns a <code>Value</code> representing the zero value for the specified type. The result is different from the zero value of the <code>Value</code> <code>struct</code>, which represents no value at all.</p>\n"}], "owner": {"reputation": 63413, "user_id": 193619, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/11e74c6cb64be4d24fdee076ddb374b0?s=128&d=identicon&r=PG", "display_name": "Nathan Osman", "link": "https://stackoverflow.com/users/193619/nathan-osman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 2, "accepted_answer_id": 50892631, "answer_count": 1, "score": 2, "last_activity_date": 1529194929, "creation_date": 1529185289, "question_id": 50891989, "link": "https://stackoverflow.com/questions/50891989/why-is-isvalid-returning-true-for-the-zero-value-of-an-int", "title": "Why is IsValid() returning true for the zero value of an int?", "body": "<p>Consider the following Go program:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    v := reflect.ValueOf(int(0))\n    fmt.Printf(\"IsValid()? %v\\n\", v.IsValid())\n}\n</code></pre>\n\n<p>Given that <a href=\"https://golang.org/pkg/reflect/#Value.IsValid\" rel=\"nofollow noreferrer\">the documentation for <code>Value.IsValid</code></a> states:</p>\n\n<blockquote>\n  <p>IsValid reports whether v represents a value. <strong>It returns false if v is the zero Value</strong>.</p>\n</blockquote>\n\n<p>...and given that the zero value for <code>int</code> is <code>0</code>, I would expect the program to report that <code>IsValid()</code> returned <code>false</code>. Unfortunately, this is not the case:</p>\n\n<pre>IsValid()? true</pre>\n\n<p>Why is this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 3, "creation_date": 1529193172, "post_id": 50891697, "comment_id": 88785769, "body": "How do you expect both writing JavaScript to the response and serving a file to work? You can&#39;t do both."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5157307, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0W8WvVRrvqA/AAAAAAAAAAI/AAAAAAAAAN8/KzUvZv09aFs/photo.jpg?sz=128", "display_name": "Steven Lee", "link": "https://stackoverflow.com/users/5157307/steven-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1529215709, "creation_date": 1529215709, "answer_id": 50894162, "question_id": 50891697, "link": "https://stackoverflow.com/questions/50891697/go-http-response-few-headers/50894162#50894162", "title": "Go http response few headers", "body": "<p>You cannot write to the http.ResponseWriter more than once depending on the HTTP spec.</p>\n\n<p>from the go docs <a href=\"https://golang.org/pkg/net/http/#ResponseWriter\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#ResponseWriter</a></p>\n\n<p>To solve your issue, you could have the script tags inside the template file, or make a new template. You could also tailor the response by adding the alert script before you send it. Maybe with template files.</p>\n\n<p>However a proper solution to this problem might be to have more logic in the actual html served, the front end should display a response based on the status code or response body.</p>\n"}], "owner": {"reputation": 43, "user_id": 9715839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eccd68c9aafc059372780cdb26c737ec?s=128&d=identicon&r=PG&f=1", "display_name": "H.Denison", "link": "https://stackoverflow.com/users/9715839/h-denison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529215709, "creation_date": 1529182735, "question_id": 50891697, "link": "https://stackoverflow.com/questions/50891697/go-http-response-few-headers", "title": "Go http response few headers", "body": "<p>I'm want send to user alert if he type wrong password and return it to page were he type password. I'm making it like this</p>\n\n<pre><code>func sendJSONHandler(w http.ResponseWriter, r *http.Request) {\n    if r.Method == \"GET\" {\n        http.ServeFile(w, r, \"template/api/api.html\")\n    } else if r.Method == \"POST\" {\n        r.ParseForm()\n        if r.Form[\"password\"][0] == \"apiPassword\" {\n            j := struct {\n                Proxies []string\n            }{Proxies: code.UP.Proxy}\n            w.Header().Set(\"Access-Control-Allow-Origin\", corsAddrSite)\n            json.NewEncoder(w).Encode(j)\n        } else {\n\n            // here is a problem\n            fmt.Fprintln(w, \"&lt;script&gt;alert('Wrong Password')&lt;/script&gt;\")\n            http.ServeFile(w, r, \"template/api/api.html\")\n\n        }\n    }\n}\n</code></pre>\n\n<p>But i'v get <code>http: multiple response.WriteHeader calls</code> error.\nHow to do it right?</p>\n"}, {"tags": ["go", "microservices", "go-gin", "go-toolchain"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1529227375, "post_id": 50891382, "comment_id": 88790654, "body": "There are no &quot;locally imported packages&quot; in Go. There are imported packages and packages which are not imported."}, {"owner": {"reputation": 331, "user_id": 1707312, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5962c2b4ec7b9cc45c7b4ab38ec65561?s=128&d=identicon&r=PG", "display_name": "user1707312", "link": "https://stackoverflow.com/users/1707312/user1707312"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1529325466, "post_id": 50891382, "comment_id": 88819296, "body": "@Volker what would you call calculator in the above example?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1529339853, "post_id": 50891382, "comment_id": 88827984, "body": "@user1707312: <code>calculator</code> is a package just like any other. The fact that it doesn&#39;t have a hostname in the path only prevents you from using <code>go get</code> on it directly."}, {"owner": {"reputation": 331, "user_id": 1707312, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5962c2b4ec7b9cc45c7b4ab38ec65561?s=128&d=identicon&r=PG", "display_name": "user1707312", "link": "https://stackoverflow.com/users/1707312/user1707312"}, "edited": false, "score": 0, "creation_date": 1529446426, "post_id": 50891382, "comment_id": 88873635, "body": "Agree! Thats what i meant by \u201clocally\u201d imported (because you have to import them before use).And there is a real usecase for having such packages. Not every package you want to host separately from the application as it may make no sense outside of the app. In this case unit test doesnt calculate the coverage of these packages if run form outside of it. The link below has the answer"}], "answers": [{"tags": [], "owner": {"reputation": 331, "user_id": 1707312, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5962c2b4ec7b9cc45c7b4ab38ec65561?s=128&d=identicon&r=PG", "display_name": "user1707312", "link": "https://stackoverflow.com/users/1707312/user1707312"}, "is_accepted": false, "score": 0, "last_activity_date": 1529203070, "creation_date": 1529203070, "answer_id": 50893240, "question_id": 50891382, "link": "https://stackoverflow.com/questions/50891382/unit-test-does-not-cover-locally-imported-packages/50893240#50893240", "title": "Unit test does not cover locally imported packages", "body": "<p>Finally found response here. looks like go has a test binary that can be used \n<a href=\"https://www.elastic.co/blog/code-coverage-for-your-golang-system-tests\" rel=\"nofollow noreferrer\">https://www.elastic.co/blog/code-coverage-for-your-golang-system-tests</a></p>\n"}], "owner": {"reputation": 331, "user_id": 1707312, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5962c2b4ec7b9cc45c7b4ab38ec65561?s=128&d=identicon&r=PG", "display_name": "user1707312", "link": "https://stackoverflow.com/users/1707312/user1707312"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1529321805, "creation_date": 1529179681, "last_edit_date": 1529321805, "question_id": 50891382, "link": "https://stackoverflow.com/questions/50891382/unit-test-does-not-cover-locally-imported-packages", "title": "Unit test does not cover locally imported packages", "body": "<p>I am new to golang and trying to understand how i can make this scenario work?</p>\n\n<p>Here is my structure\nGOPATH set to /Users/xyz/project</p>\n\n<pre><code>/Users/xyz/project/src/main.go // import calculator and call SUM with two integeres\n/Users/xyz/project/src/main_test.go // test function\n/Users/xyz/project/src/calculator/sum.go // SUM function (add two integers)\n</code></pre>\n\n<p>i have a main go file that imports \"calculator\" which is a local packages. When i run </p>\n\n<pre><code>go test -cover\n</code></pre>\n\n<p>it only gives the coverage of main but not for the package \"calculator\" imported by main. i know i can write a test inside calculator and that would do the trick but is there any way possible to get the coverage of locally imported package from main?</p>\n\n<p>Bigger Context - The reason i want to do this is because i have a micro service written in go using gin framework and i want to spin it up as a service and make http calls and further see how the coverage looks like (like component test). I can easily spin it up by writing a main_test go file which starts the service but i am not getting the coverage of the imported packages.</p>\n"}, {"tags": ["xml", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 4609, "user_id": 4636715, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ebd8c54bb287f99b94373429b588e21?s=128&d=identicon&r=PG&f=1", "display_name": "vahdet", "link": "https://stackoverflow.com/users/4636715/vahdet"}, "edited": false, "score": 0, "creation_date": 1529173419, "post_id": 50890557, "comment_id": 88782142, "body": "It is not directly playable through Go-playgrund. So, is <code>decBytes</code> also empty when you run your code?"}, {"owner": {"reputation": 794, "user_id": 1312791, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c9dc2d2585c375a9049748fd0b1b26e6?s=128&d=identicon&r=PG", "display_name": "telex-wap", "link": "https://stackoverflow.com/users/1312791/telex-wap"}, "reply_to_user": {"reputation": 4609, "user_id": 4636715, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ebd8c54bb287f99b94373429b588e21?s=128&d=identicon&r=PG&f=1", "display_name": "vahdet", "link": "https://stackoverflow.com/users/4636715/vahdet"}, "edited": false, "score": 0, "creation_date": 1529173471, "post_id": 50890557, "comment_id": 88782151, "body": "No, decBytes prints out the full xml file with correct encoding. Sorry, edit, the file is printed if I transform it to string, but yes, decBytes is the correct byte representation of the file."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1529175668, "post_id": 50890557, "comment_id": 88782661, "body": "<code>xml.Unmarshal</code> returns an error. Please check the error and paste it here."}, {"owner": {"reputation": 794, "user_id": 1312791, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c9dc2d2585c375a9049748fd0b1b26e6?s=128&d=identicon&r=PG", "display_name": "telex-wap", "link": "https://stackoverflow.com/users/1312791/telex-wap"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1529177318, "post_id": 50890557, "comment_id": 88782978, "body": "Thanks for the tip @leafbebop , I have edited to add the error message. I think that thanks to your suggestion, this is going in the right direction..."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1529179141, "post_id": 50890557, "comment_id": 88783379, "body": "I think that somewhere in your xml file there is a declaration saying the file is in <code>win-1251</code> encoding. Though you transform it into utf-8, the declaration is not removed thus making the parser think you shall provide a <code>CharsetReader</code>. And I would suggest instead of the transform, do provide a <code>CharsetReader</code> like the code @ain provide."}], "answers": [{"comments": [{"owner": {"reputation": 794, "user_id": 1312791, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c9dc2d2585c375a9049748fd0b1b26e6?s=128&d=identicon&r=PG", "display_name": "telex-wap", "link": "https://stackoverflow.com/users/1312791/telex-wap"}, "edited": false, "score": 1, "creation_date": 1529182739, "post_id": 50891130, "comment_id": 88784124, "body": "This did the trick. I&#39;ve got another UTF8 file of same size, and sure, the speed was overall much slower and the process much clunkier than the streaming option you suggest here.  However, I am still wondering if the &quot;all at once&quot; approach with unmarshalling could still work for a non UTF8 file. I tried to create  a <code>CharsetReader</code>, but <code>Unmarshall</code> expects a byte slice, so I am not sure how to proceed. Anyways, at least I&#39;ve got your streaming solution. Thanks!"}], "tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": true, "score": 2, "last_activity_date": 1529179026, "last_edit_date": 1529179026, "creation_date": 1529177805, "answer_id": 50891130, "question_id": 50890557, "link": "https://stackoverflow.com/questions/50890557/xml-unmarshalling-in-go-gives-empty-result-with-exported-fields/50891130#50891130", "title": "XML Unmarshalling in Go gives empty result with exported fields", "body": "<p>You mention that you have \"nearly 1.000.000 ROW tags\" and in your code you use <code>ioutil.ReadAll(xmlFile)</code> to read it all into memory (twice!) - thats totally unnessesary and you might run out of memory. Instead of reading it into memory you should use \"streaming\" decoder, something like</p>\n\n<pre><code>import \"golang.org/x/net/html/charset\"\n\nfunc main() {\n    xmlFile, err := os.Open(\"FOP_1.xml\")\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer xmlFile.Close()\n\n    parser := xml.NewDecoder(xmlFile)\n    parser.CharsetReader = charset.NewReaderLabel\n\n    for {\n        t, _ := parser.Token()\n        if t == nil {\n            break\n        }\n\n        switch se := t.(type) {\n        case xml.StartElement:\n            if se.Name.Local == \"ROW\" {\n                var item Row\n                parser.DecodeElement(&amp;item, &amp;se)\n                fmt.Println(\"Name: \" + item.Director)\n            }\n       }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 794, "user_id": 1312791, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c9dc2d2585c375a9049748fd0b1b26e6?s=128&d=identicon&r=PG", "display_name": "telex-wap", "link": "https://stackoverflow.com/users/1312791/telex-wap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 50891130, "answer_count": 1, "score": 1, "last_activity_date": 1529875299, "creation_date": 1529173126, "last_edit_date": 1529875299, "question_id": 50890557, "link": "https://stackoverflow.com/questions/50890557/xml-unmarshalling-in-go-gives-empty-result-with-exported-fields", "title": "XML Unmarshalling in Go gives empty result with exported fields", "body": "<p>I am getting an empty result when doing XML unmarshall in Go. I have researched other SO questions and I have noticed that the most common reason for this seems to be that the fields are not exported. This is not true in my case, since all the names begin with an uppercase letter. </p>\n\n<p>The xml looks like this (with nearly 1.000.000 <code>ROW</code> tags inside one single <code>ROWDATA</code>): </p>\n\n<pre><code>&lt;ROWDATA&gt;\n&lt;ROW&gt;\n  &lt;\u041f\u0406\u0411&gt;    \u041f\u041e\u041f\u041a\u041e    \u0420\u0423\u0421\u041b\u0410\u041d \u0412\u0410\u0421\u0418\u041b\u042c\u041e\u0412\u0418\u0427&lt;/\u041f\u0406\u0411&gt;\n  &lt;\u041c\u0456\u0441\u0446\u0435_\u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u043d\u044f&gt;61112, \u0425\u0430\u0440\u043a\u0456\u0432\u0441\u044c\u043a\u0430 \u043e\u0431\u043b., \u043c\u0456\u0441\u0442\u043e \u0425\u0430\u0440\u043a\u0456\u0432, \u041c\u043e\u0441\u043a\u043e\u0432\u0441\u044c\u043a\u0438\u0439 \u0440\u0430\u0439\u043e\u043d, \u041f\u0420\u041e\u0421\u041f\u0415\u041a\u0422 \u041f'\u042f\u0422\u0414\u0415\u0421\u042f\u0422\u0418\u0420\u0406\u0427\u0427\u042f \u0412\u041b\u041a\u0421\u041c, \u0431\u0443\u0434\u0438\u043d\u043e\u043a 86, \u043a\u0432\u0430\u0440\u0442\u0438\u0440\u0430 65&lt;/\u041c\u0456\u0441\u0446\u0435_\u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u043d\u044f&gt;\n  &lt;\u041e\u0441\u043d\u043e\u0432\u043d\u0438\u0439_\u0432\u0438\u0434_\u0434\u0456\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0456&gt;45.32 \u0420\u043e\u0437\u0434\u0440\u0456\u0431\u043d\u0430 \u0442\u043e\u0440\u0433\u0456\u0432\u043b\u044f \u0434\u0435\u0442\u0430\u043b\u044f\u043c\u0438 \u0442\u0430 \u043f\u0440\u0438\u043b\u0430\u0434\u0434\u044f\u043c \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442\u043d\u0438\u0445 \u0437\u0430\u0441\u043e\u0431\u0456\u0432&lt;/\u041e\u0441\u043d\u043e\u0432\u043d\u0438\u0439_\u0432\u0438\u0434_\u0434\u0456\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0456&gt;\n  &lt;\u0421\u0442\u0430\u043d&gt;\u0437\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u043e\u0432\u0430\u043d\u043e&lt;/\u0421\u0442\u0430\u043d&gt;\n&lt;/ROW&gt;\n&lt;/ROWDATA&gt;\n</code></pre>\n\n<p>And this is what I have done: </p>\n\n<pre><code>package main\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"golang.org/x/text/encoding/charmap\"\n    \"golang.org/x/text/transform\"\n    \"io/ioutil\"\n    \"os\"\n    \"strings\"\n)\n\ntype Rowdata struct {\n    XMLName xml.Name `xml:\"ROWDATA\"`\n    Rowdata []Row    `xml:\"ROW\"`\n}\n\ntype Row struct {\n    XMLName  xml.Name `xml:\"ROW\"`\n    Location string   `xml:\"\u041c\u0456\u0441\u0446\u0435_\u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u043d\u044f\"`\n    Director string   `xml:\"\u041f\u0406\u0411\"`\n    Activity string   `xml:\"\u041e\u0441\u043d\u043e\u0432\u043d\u0438\u0439_\u0432\u0438\u0434_\u0434\u0456\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0456\"`\n    City     string   `xml:\"\u0421\u0442\u0430\u043d\"`\n}\n\nfunc main() {\n\n    xmlFile, err := os.Open(\"FOP_1.xml\")\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    defer xmlFile.Close()\n\n    byteValue, _ := ioutil.ReadAll(xmlFile)\n\n    koi8rString := transform.NewReader(strings.NewReader(string(byteValue)), charmap.Windows1251.NewDecoder())\n\n    decBytes, _ := ioutil.ReadAll(koi8rString)\n\n    var entries Rowdata\n\n    xml.Unmarshal(decBytes, &amp;entries)\n\n    for i := 0; i &lt; len(entries.Rowdata); i++ {\n        fmt.Println(\"Name: \" + entries.Rowdata[i].Director)\n    }\n}\n</code></pre>\n\n<p>And the last for loop never runs, because the length is zero. However, I have a similar example where the file was already UTF8, so no encoding transformation was needed, and it went well. I wonder if I messed up something while decoding?</p>\n\n<p>UPDATE: I tested a simpler version with a string rather than a file in the <a href=\"https://goplay.space/#6RDPB8S6a4l\" rel=\"nofollow noreferrer\">Go Play Space</a>, and it works fine! However, my local version with the file still doesn't work, so I suspect it might have something to do with the actual reading of the file... </p>\n\n<p>UPDATE2: I just realized that <code>xml.Unmarshall</code> returns: </p>\n\n<p><code>xml: encoding \"windows-1251\" declared but Decoder.CharsetReader is nil%</code></p>\n\n<p>That might be the cause of this... but what does it mean?</p>\n"}, {"tags": ["go", "http-headers"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1529168947, "creation_date": 1529168947, "answer_id": 50889983, "question_id": 50889810, "link": "https://stackoverflow.com/questions/50889810/go-set-header-for-all-handlers/50889983#50889983", "title": "Go set header for all handlers", "body": "<p>Wrap the mux</p>\n\n<pre><code>  http.ListenAndServe(\":80\", cacheHandler(http.DefaultServeMux))\n</code></pre>\n\n<p>instead of the individual handlers.</p>\n\n<p>Note that <code>ListendAndServe</code> uses <code>http.DefaultServeMux</code> as the handler when the handler argument is <code>nil</code>.  Also, the <code>http.Handle</code> and <code>http.HandleFunc</code> add handlers to <code>http.DefaultServeMux</code>.</p>\n"}], "owner": {"reputation": 137, "user_id": 9570173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce78d21ab2fa81fc9092db58c25b9af3?s=128&d=identicon&r=PG&f=1", "display_name": "ChunkCoder", "link": "https://stackoverflow.com/users/9570173/chunkcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 50889983, "answer_count": 1, "score": 1, "last_activity_date": 1529168947, "creation_date": 1529167533, "last_edit_date": 1529167946, "question_id": 50889810, "link": "https://stackoverflow.com/questions/50889810/go-set-header-for-all-handlers", "title": "Go set header for all handlers", "body": "<p>For now it looks like this</p>\n\n<pre><code>func cacheHandler(h http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Cache-Control\", \"max-age=1800\")\n        h.ServeHTTP(w, r)\n    })\n}\nhttp.Handle(\"/\", cacheHandler(http.FileServer(http.Dir(\"./template/index\"))))\nhttp.HandleFunc(\"/json\", sendJSONHandler)\nhttp.HandleFunc(\"/contact\", contactHandler)\nhttp.Handle(\"/static/\", http.StripPrefix(\"/static/\", cacheHandler(http.FileServer(http.Dir(\"./template/static\")))))\nhttp.ListenAndServe(\":80\", nil)\n</code></pre>\n\n<p>Is there way to set cache header to all handlers at one time?</p>\n"}, {"tags": ["mongodb", "go", "uuid", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 1132, "user_id": 758667, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/32362f67f7ed51a95ad502da44426600?s=128&d=identicon&r=PG", "display_name": "sheshkovsky", "link": "https://stackoverflow.com/users/758667/sheshkovsky"}, "edited": false, "score": 0, "creation_date": 1529173037, "post_id": 50889974, "comment_id": 88782061, "body": "Thanks Thomas. Your snippets works well but when I change my struct element type to <code>MyUUID</code> and print <code>job.Key</code> I still get <code>00000000-0000-0000-0000-000000000000</code> I&#39;m not sure if it&#39;s help or not, but the <code>bson.Raw.Kind</code> I receive from mongo is <code>5</code> ..."}, {"owner": {"reputation": 1132, "user_id": 758667, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/32362f67f7ed51a95ad502da44426600?s=128&d=identicon&r=PG", "display_name": "sheshkovsky", "link": "https://stackoverflow.com/users/758667/sheshkovsky"}, "edited": false, "score": 0, "creation_date": 1529173487, "post_id": 50889974, "comment_id": 88782155, "body": "I&#39;ve changed <code>return nil</code> to <code>fmt.Println(err)</code> and I get: <code>uuid: incorrect UUID length: 00000000-0000-0000-0000-000000000000 BSON kind 0x05 isn&#39;t compatible with type string</code>"}, {"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "reply_to_user": {"reputation": 1132, "user_id": 758667, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/32362f67f7ed51a95ad502da44426600?s=128&d=identicon&r=PG", "display_name": "sheshkovsky", "link": "https://stackoverflow.com/users/758667/sheshkovsky"}, "edited": false, "score": 0, "creation_date": 1529174144, "post_id": 50889974, "comment_id": 88782291, "body": "That&#39;s because your document structure is defining the uuid string value as being in key <code>j</code> but it is actually in key <code>uuid</code> nested in key <code>j</code>."}, {"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "reply_to_user": {"reputation": 1132, "user_id": 758667, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/32362f67f7ed51a95ad502da44426600?s=128&d=identicon&r=PG", "display_name": "sheshkovsky", "link": "https://stackoverflow.com/users/758667/sheshkovsky"}, "edited": false, "score": 0, "creation_date": 1529174794, "post_id": 50889974, "comment_id": 88782442, "body": "@sheshkovsky I updated the answer to more specifically match your data format."}, {"owner": {"reputation": 1132, "user_id": 758667, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/32362f67f7ed51a95ad502da44426600?s=128&d=identicon&r=PG", "display_name": "sheshkovsky", "link": "https://stackoverflow.com/users/758667/sheshkovsky"}, "edited": false, "score": 0, "creation_date": 1529220209, "post_id": 50889974, "comment_id": 88789177, "body": "I still have the problem. Because in your snippet <code>raw.Kind</code> is 0x03 (embedded document) but when I run my code I see that <code>raw.Kind</code> is 0x05 (which is binary I guess). Is there a way to convert binary to embedded doc kind?"}, {"owner": {"reputation": 1132, "user_id": 758667, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/32362f67f7ed51a95ad502da44426600?s=128&d=identicon&r=PG", "display_name": "sheshkovsky", "link": "https://stackoverflow.com/users/758667/sheshkovsky"}, "edited": false, "score": 0, "creation_date": 1529225305, "post_id": 50889974, "comment_id": 88790171, "body": "it seems to be a <code>md5</code> instead of uuid: <a href=\"https://github.com/go-mgo/mgo/blob/3f83fa5005286a7fe593b055f0d7771a7dce4655/bson/bson.go#L416\" rel=\"nofollow noreferrer\">github.com/go-mgo/mgo/blob/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "is_accepted": false, "score": 3, "last_activity_date": 1529175103, "last_edit_date": 1529175103, "creation_date": 1529168851, "answer_id": 50889974, "question_id": 50889485, "link": "https://stackoverflow.com/questions/50889485/how-should-i-handle-uuid-fields-using-mgo/50889974#50889974", "title": "How should I handle UUID fields using mgo?", "body": "<p>Using the <code>satori/go.uuid</code> lib you mentioned, you can accomplish this by implementing the \n<a href=\"https://github.com/go-mgo/mgo/blob/v2/bson/bson.go#L94\" rel=\"nofollow noreferrer\">bson.Setter</a> interface on the type you use for the UUID field.</p>\n\n<pre><code>type Setter interface {\n    SetBSON(raw Raw) error\n}\n</code></pre>\n\n<p>A minimal example could look like the following. First I define my struct, but instead of the UUID type from satori/go.uuid I instead embed that type into my own type. This allows us to define a method on it. You could also accomplish this with different type declaration such as <code>type MyUUID uuid.UUID</code> but then you would need to perform a type conversion <code>uuid.UUID(record.UUID)</code> to gain access to the fields and methods on the underlying <code>uuid.UUID</code> type.</p>\n\n<pre><code>// MyUUID is a struct embedding the actual real UUID type\n// so that we can implement bson.Setter\ntype MyUUID struct{ uuid.UUID }\n\n// Record is a simplified version of what you're reading in\ntype Record struct {\n    ID   int\n    Name string\n    UUID MyUUID `bson:\"j\"`\n}\n</code></pre>\n\n<p>Next we implement the <code>bson.Setter</code> method on <code>MyUUID</code></p>\n\n<pre><code>// SetBSON lets us perform custom deserialization\nfunc (m *MyUUID) SetBSON(raw bson.Raw) error {\n    // First we decode the BSON data as a anonymous J struct\n    var j struct {\n        UUID string `bson:\"$uuid\"`\n    }\n    err := raw.Unmarshal(&amp;j)\n    if err != nil {\n        return err\n    }\n\n    // Then we use the parse the string UUID\n    uu, err := uuid.FromString(j.UUID)\n    if err != nil {\n        return err\n    }\n\n    // Finally build the result type and set it into the pointer to our record's field.\n    *m = MyUUID{uu}\n\n    return nil\n}\n</code></pre>\n\n<p>It won't on the playground run due to the absence of packages, but fully functioning source that demonstrates this is available <a href=\"https://play.golang.org/p/l8_0QhkrBMs\" rel=\"nofollow noreferrer\">here</a>. The example output when I run it locally:</p>\n\n<pre><code>&gt; go run main.go\n2018/06/16 14:49:49 {1 George {fdcfa79c-6b83-444e-9a91-a02f0aeaa260}}\n2018/06/16 14:49:49 {1 George fdcfa79c-6b83-444e-9a91-a02f0aeaa260}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1132, "user_id": 758667, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/32362f67f7ed51a95ad502da44426600?s=128&d=identicon&r=PG", "display_name": "sheshkovsky", "link": "https://stackoverflow.com/users/758667/sheshkovsky"}, "is_accepted": true, "score": 3, "last_activity_date": 1529228576, "creation_date": 1529228576, "answer_id": 50895446, "question_id": 50889485, "link": "https://stackoverflow.com/questions/50889485/how-should-i-handle-uuid-fields-using-mgo/50895446#50895446", "title": "How should I handle UUID fields using mgo?", "body": "<p>Thanks to @Thomas I've figured out that I'm getting bin data with <code>0x05</code> Kind.</p>\n\n<p>So I changed <code>Job</code> struct to:</p>\n\n<pre><code>Key             bson.Binary         `bson:\"j\"`\n</code></pre>\n\n<p>and after doing query, I unmarshal that binary data like this:</p>\n\n<pre><code>import \"github.com/satori/go.uuid\"\n\nvar Ids []uuid.UUID\n\nfor _, job := range results {\n    u, err := uuid.FromBytes(job.Key.Data)\n    if err != nil {\n        panic(err)\n    }\n    Ids = append(Ids, u)\n}\n</code></pre>\n\n<p>So now in <code>Job.Key.Data</code> I have binary version of UUID according to <a href=\"https://github.com/go-mgo/mgo/blob/3f83fa5005286a7fe593b055f0d7771a7dce4655/bson/bson.go#L416\" rel=\"nofollow noreferrer\">this</a> documentation.</p>\n"}, {"tags": [], "owner": {"reputation": 391, "user_id": 2349872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79ca62ad8d8e26c9b541c1f236c373c1?s=128&d=identicon&r=PG", "display_name": "saniales", "link": "https://stackoverflow.com/users/2349872/saniales"}, "is_accepted": false, "score": 2, "last_activity_date": 1546960613, "creation_date": 1546960613, "answer_id": 54094766, "question_id": 50889485, "link": "https://stackoverflow.com/questions/50889485/how-should-i-handle-uuid-fields-using-mgo/54094766#54094766", "title": "How should I handle UUID fields using mgo?", "body": "<p>I read @sheshkovsky and @Thomas ideas and I actually came out with a copy paste solution which in my case worked.</p>\n\n<pre><code>// MongoUUID represents a UUID as saved in MongoDB\ntype MongoUUID struct{ uuid.UUID }\n\n// SetBSON implements the bson.Setter interface\nfunc (id *MongoUUID) SetBSON(raw bson.Raw) error {\n    // First we decode the BSON data as a UUID Binary\n    // Optionally we can check here if the Kind is correct\n    var j bson.Binary\n    err := raw.Unmarshal(&amp;j)\n    if err != nil {\n        return err\n    }\n\n    // Then we use the parse the string UUID\n    uu, err := uuid.FromBytes(j.Data)\n    if err != nil {\n        return err\n    }\n\n    // Finally build the result type and set it into the pointer to our record's field.\n    *id = MongoUUID{uu}\n\n    return nil\n}\n\n// GetBSON implements the bson.Getter interface\nfunc (id *MongoUUID) GetBSON() (interface{}, error) {\n    // we create an empty UUID Binary Mongo Object\n    ret := bson.Binary{\n        Kind: bson.BinaryUUID,\n        Data: nil,\n    }\n\n    // And we pass the UUID data to it\n    if id == nil {\n        ret.Data = uuid.Nil.Bytes()\n    } else {\n        ret.Data = id.Bytes()\n    }\n\n    // finally we return ;)\n    return ret, nil\n}\n</code></pre>\n\n<p>With this solution you can directly pass a MongoUUID wrapping an uuid.UUID value like a charm :)</p>\n"}], "owner": {"reputation": 1132, "user_id": 758667, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/32362f67f7ed51a95ad502da44426600?s=128&d=identicon&r=PG", "display_name": "sheshkovsky", "link": "https://stackoverflow.com/users/758667/sheshkovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2824, "favorite_count": 0, "accepted_answer_id": 50895446, "answer_count": 3, "score": 4, "last_activity_date": 1546960613, "creation_date": 1529164839, "last_edit_date": 1529167653, "question_id": 50889485, "link": "https://stackoverflow.com/questions/50889485/how-should-i-handle-uuid-fields-using-mgo", "title": "How should I handle UUID fields using mgo?", "body": "<p>I have this Document in MongoDB:</p>\n\n<pre><code>{\n    \"_id\": {\n        \"$oid\": \"5ad0873b169ade0001345d34\"\n    },\n    \"j\": {\n        \"$uuid\": \"94482b86-1005-e3a0-5235-55fb7c1d648a\"\n    },\n    \"v\": \"sign\",\n    \"d\": \"a\",\n    \"s\": \"init\",\n    \"response\": {},\n    \"creation_date\": {\n        \"$date\": \"2018-04-13T10:32:27.140Z\"\n    }\n}\n</code></pre>\n\n<p>I want to filter &amp; fetch some documents in Golang using mgo, and here's my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"time\"\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n)\n\ntype JOB struct {\n   ID               bson.ObjectId       `bson:\"_id,omitempty\"`\n   Key          string              `bson:\"j\"`\n   Svc              string              `bson:\"v\"`\n   DocType          string              `bson:\"d\"`\n   Status           string              `bson:\"s\"`\n   CreationDate     time.Time           `bson:\"creation_date\"`\n}\n\nfunc main() {\n    session, err := mgo.Dial(\"mongodb://...\")\n    if err != nil {\n            log.Fatal(err)\n    }\n    defer session.Close()\n    c := session.DB(\"main\").C(\"job\")\n\n    var results []JOB\n    e := c.Find(bson.M{\"v\": \"sign\"}).All(&amp;results)\n    if e != nil {\n        log.Fatal(e)\n    }\n    for _, job := range results[:5] {\n        fmt.Println(job.ID, job.Key, job.Svc, job.DocType, job.Status, job.CreationDate)\n\n    }\n\n}\n</code></pre>\n\n<p>Here's the output when I run my program:</p>\n\n<pre><code>ObjectIdHex(\"5acf91e0269c650001a82683\")  sign a ok 2018-04-12 19:05:36.294 +0200 CEST\nObjectIdHex(\"5ad0873b169ade0001345d34\")  sign a init 2018-04-13 12:32:27.14 +0200 CEST\nObjectIdHex(\"5ad0873e169ade0001345d36\")  sign a init 2018-04-13 12:32:30.852 +0200 CEST\nObjectIdHex(\"5ad08742169ade0001345d38\")  sign a init 2018-04-13 12:32:34.478 +0200 CEST\nObjectIdHex(\"5ad087492e083b00013a862a\")  sign a init 2018-04-13 12:32:41.577 +0200 CEST\n</code></pre>\n\n<p><strong>Problem</strong>:</p>\n\n<p><code>job.Key</code> (<code>j</code> field in MongoDB Document which is a uuid) remains empty. I've tried also <code>\"github.com/satori/go.uuid\"</code> but I couldn't figure it out.</p>\n\n<p>So I would like to know how to handle that uuid field, and more generally how to debug this problem. Complete newbie in Go.</p>\n\n<p>For example in python I could get a Document and using <code>doc._data</code> I could see all fields of that document, is there a equivalent way of doing this in Go?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I tried to set Key as <code>bson.Raw</code>, I see some bytes, but cannot convert them to uuid:</p>\n\n<pre><code>fmt.Println(job.Key)\nu := uuid.FromBytesOrNil(job.Key.Data)\nfmt.Println(u)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{5 [16 0 0 0 3 160 227 5 16 134 43 72 148 138 100 29 124 251 85 53 82]}\n00000000-0000-0000-0000-000000000000\n</code></pre>\n"}, {"tags": ["database", "postgresql", "go", "go-gorm"], "comments": [{"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1529161477, "post_id": 50888931, "comment_id": 88779308, "body": "I have used github.com/shopspring/decimal for money values."}, {"owner": {"reputation": 1988, "user_id": 6716410, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbA3G.png?s=128&g=1", "display_name": "sf9v", "link": "https://stackoverflow.com/users/6716410/sf9v"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1529163036, "post_id": 50888931, "comment_id": 88779674, "body": "can you please show an example of how you used it? gorm is throwing an error when i do automigrate"}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1529163975, "post_id": 50888931, "comment_id": 88779954, "body": "Sorry, I don&#39;t use grom myself and thus don&#39;t have any experience using shopspring/decimal with it..."}, {"owner": {"reputation": 1988, "user_id": 6716410, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbA3G.png?s=128&g=1", "display_name": "sf9v", "link": "https://stackoverflow.com/users/6716410/sf9v"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1529164077, "post_id": 50888931, "comment_id": 88779973, "body": "@ain, oh, btw thanks for suggesting the package. greatly appreciated!"}, {"owner": {"reputation": 2666, "user_id": 1421957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8e742c4a05e312502c828847c455ad?s=128&d=identicon&r=PG", "display_name": "Tico", "link": "https://stackoverflow.com/users/1421957/tico"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1529164609, "post_id": 50888931, "comment_id": 88780096, "body": "@ain, nice package! Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 1988, "user_id": 6716410, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbA3G.png?s=128&g=1", "display_name": "sf9v", "link": "https://stackoverflow.com/users/6716410/sf9v"}, "is_accepted": true, "score": 4, "last_activity_date": 1529289925, "last_edit_date": 1529289925, "creation_date": 1529164583, "answer_id": 50889450, "question_id": 50888931, "link": "https://stackoverflow.com/questions/50888931/decimal-type-in-go-and-postgresql-with-gorm/50889450#50889450", "title": "Decimal type in Go and Postgresql with gorm", "body": "<p>So, based on the suggestion of @ain, I used shopspring/decimal. But it's giving me an error when I do automigrate.</p>\n\n<p>It turns out that I only needed to set the type to <code>numeric</code> using a gorm tag to make it work:</p>\n\n<pre><code>type MyStruct struct {\n    Name        string `json:\"name\" gorm:\"not null\"`\n    Description string `json:\"description\" gorm:\"null\"`\n    Price decimal.Decimal `json:\"price\" gorm:\"type:numeric\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 1988, "user_id": 6716410, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbA3G.png?s=128&g=1", "display_name": "sf9v", "link": "https://stackoverflow.com/users/6716410/sf9v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1269, "favorite_count": 0, "accepted_answer_id": 50889450, "answer_count": 1, "score": 1, "last_activity_date": 1539070481, "creation_date": 1529160549, "last_edit_date": 1539070481, "question_id": 50888931, "link": "https://stackoverflow.com/questions/50888931/decimal-type-in-go-and-postgresql-with-gorm", "title": "Decimal type in Go and Postgresql with gorm", "body": "<p>So i'm creating an API and I needed to store the price of something.</p>\n\n<p>I'm using gorm and gormigrate for my database migration. \nI'm just wondering what proper type should I use for storing decimals. I've red somewhere that I shouldn't use floats when storing currencies.</p>\n\n<pre><code>type MyStruct struct {\n    Name        string `json:\"name\" gorm:\"not null\"`\n    Description string `json:\"description\" gorm:\"null\"`\n    Price &lt;what type should be here&gt; `json:\"price\"`\n}\n</code></pre>\n"}, {"tags": ["session", "go", "web", "cookies", "gorilla"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1529170313, "post_id": 50888875, "comment_id": 88781410, "body": "It might seem dumb but where is the <code>session.Save(r,w)</code> line?"}, {"owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1529233251, "post_id": 50888875, "comment_id": 88791883, "body": "yes thats right. it wasnt the only fault"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "edited": false, "score": 0, "creation_date": 1529228895, "post_id": 50894066, "comment_id": 88790960, "body": "invalid operation: original + &quot;,&quot; (mismatched types interface () and string) in line 410. ( equipmentIdsStr = original + &quot;,&quot; + equipmentIdsStr )"}, {"owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "edited": false, "score": 0, "creation_date": 1529231624, "post_id": 50894066, "comment_id": 88791549, "body": "changed it to equipmentIdsStr = original.(string) + &quot;,&quot; + equipmentIdsStr. Now it works, thank you very much"}, {"owner": {"reputation": 6316, "user_id": 226145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b713823a49df6d9c2f9a24d0728add5?s=128&d=identicon&r=PG", "display_name": "ThanhHH", "link": "https://stackoverflow.com/users/226145/thanhhh"}, "reply_to_user": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "edited": false, "score": 0, "creation_date": 1529241747, "post_id": 50894066, "comment_id": 88793817, "body": "@ChristopherG1994 Thanks. I&#39;ve just updated to use <code>fmt.Sprintf</code> for better conversion from <code>interface</code> to <code>string</code>."}], "tags": [], "owner": {"reputation": 6316, "user_id": 226145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b713823a49df6d9c2f9a24d0728add5?s=128&d=identicon&r=PG", "display_name": "ThanhHH", "link": "https://stackoverflow.com/users/226145/thanhhh"}, "is_accepted": true, "score": 0, "last_activity_date": 1529241674, "last_edit_date": 1529241674, "creation_date": 1529214712, "answer_id": 50894066, "question_id": 50888875, "link": "https://stackoverflow.com/questions/50888875/how-to-expand-session-value-with-string/50894066#50894066", "title": "How to expand session.Value with String", "body": "<p>I thought that you should get original equipment value from the session, combine the equipment ID that user clicks on and save into session for the next request.</p>\n\n<p>I update your code as following:</p>\n\n<pre><code>// ...\nequipment, _ := model.GetEquipmentByID(r.FormValue(\"id\"))\nsession, _ := store.Get(r, \"cookie-name\")\n\nequipmentIdsStr := strconv.Itoa(equipment.ID)\n\nif original, exist := session.Values[\"EquipmentIDs\"]; exist {\n    equipmentIdsStr = fmt.Sprintf(\"%v,%v\", original, equipmentIdsStr)\n}\n\nsession.Values[\"EquipmentIDs\"] = equipmentIdsStr\n\n//You have to save your updated session value\nsession.Save(r, w)\n// ...\n</code></pre>\n\n<p>Hope this help.</p>\n"}], "owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 50894066, "answer_count": 1, "score": 0, "last_activity_date": 1529241674, "creation_date": 1529160113, "last_edit_date": 1529165644, "question_id": 50888875, "link": "https://stackoverflow.com/questions/50888875/how-to-expand-session-value-with-string", "title": "How to expand session.Value with String", "body": "<p>Iam using Gorilla/Sessions.</p>\n\n<p>I got a template page, where the user can choose between different devices. \nIf he uses one of the submit buttons under each device my controller function should add the id value to my existing session value.</p>\n\n<pre><code>  func Cart(w   http.ResponseWriter,    r   *http.Request)  {   \n\ndata := CartData{ \n    Name: \"Cart\",\n    Equipment: model.GetEquipment(model.Db),\n    Pages: []Page{\n        {\n            Title: \"Meine Ger\u00e4te\", \n            Active: false,\n            Link: \"/my-equipment\",\n        },\n        {\n            Title: \"Equipment\", \n            Active: false,\n            Link: \"/equipment\",\n        },\n        {\n            Title: \"Logout\",\n            Active: false,\n            Link: \"/logout\",\n        },\n    },\n\n}\n\n    equipment,_ := model.GetEquipmentByID(r.FormValue(\"id\"))\n    session, _ := store.Get(r, \"cookie-name\")\n\n    Strings := strconv.Itoa(equipment.ID)\n    fmt.Println(Strings)\n    StringsWithComma := Strings + \",\"\n    session.Values[\"EquipmentIDs\"] = session.Values[\"EquipmentIDs\"] + StringsWithComma // THIS CODE LINE DOES NOT WORK, I want to expand \"EquipmentIDs\" with the new ID\n\ntmpl:= template.Must(template.ParseFiles(\"template/base_user.html\", \"template/cart.html\"))\ntmpl.ExecuteTemplate(w, \"base\", data)\n}\n}\n</code></pre>\n\n<p>Example: User is visiting my Device page. He uses the submit button with id=2 \nSessionValue[\"EquipmentIDs\"] should be = \"2\" right now. \nAfter that the User is visiting the Device Page again an uses the submit button with id=6.\nNow the SessionValue should be = \"2,6\"</p>\n\n<p>I am attached to the problem all day and can not get any further\nIf you have Questions or want to see other parts of my code feel free to ask \nThanks in advance</p>\n"}, {"tags": ["pointers", "go", "casting", "type-conversion", "duck-typing"], "comments": [{"owner": {"reputation": 918, "user_id": 429828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2028f8517e3123ca997938df3acd4fc5?s=128&d=identicon&r=PG", "display_name": "Allen Hamilton", "link": "https://stackoverflow.com/users/429828/allen-hamilton"}, "edited": false, "score": 3, "creation_date": 1529157824, "post_id": 50888451, "comment_id": 88778462, "body": "<code>db *store.Datastore</code> - store.Datastore is an interface, so remove the pointer symbol *, you don&#39;t need it - interfaces can take values and pointers, <a href=\"https://medium.com/@saiyerram/go-interfaces-pointers-4d1d98d5c9c6\" rel=\"nofollow noreferrer\">medium.com/@saiyerram/go-interfaces-pointers-4d1d98d5c9c6</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1383, "user_id": 4167563, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/90cc579fcc609be0144e24cdd6e056fa?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4167563/max"}, "edited": false, "score": 0, "creation_date": 1529158034, "post_id": 50888591, "comment_id": 88778504, "body": "Oh, I did not know about it. It seems. that it is not obvious thing. I have read <a href=\"https://stackoverflow.com/a/27178682/4167563\">stackoverflow.com/a/27178682/4167563</a> it for now. Thank you!"}], "tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": true, "score": 3, "last_activity_date": 1529157769, "creation_date": 1529157769, "answer_id": 50888591, "question_id": 50888451, "link": "https://stackoverflow.com/questions/50888451/how-to-cast-interface-implementation-pointer-to-interface-pointer/50888591#50888591", "title": "How to cast interface implementation pointer to interface pointer?", "body": "<p>Using</p>\n\n<pre><code>type Env struct {\n    db store.Datastore\n}\n</code></pre>\n\n<p>is the correct solution. Because <code>store.Datastore</code> is interface type, it is already pointer and youre not coping any data.</p>\n"}], "owner": {"reputation": 1383, "user_id": 4167563, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/90cc579fcc609be0144e24cdd6e056fa?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4167563/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 50888591, "answer_count": 1, "score": 0, "last_activity_date": 1529172349, "creation_date": 1529156650, "last_edit_date": 1529172349, "question_id": 50888451, "link": "https://stackoverflow.com/questions/50888451/how-to-cast-interface-implementation-pointer-to-interface-pointer", "title": "How to cast interface implementation pointer to interface pointer?", "body": "<p>I have a interface:</p>\n\n<pre><code>type Datastore interface {\n    InsertString(str string) error\n}\n</code></pre>\n\n<p>I have PostgreSql implementation of this interface:</p>\n\n<pre><code>type DB struct {\n    session *sql.DB\n}\n\n func (db *DB) InsertString(str string) error {\n    return nil\n}\n\nfunc NewDB(user, password, dbName string) (*DB, error) {\n    dbinfo := fmt.Sprintf(\"user=%s password=%s dbname=%s sslmode=disable\",\n        user, password, dbName)\n\n    db, err := sql.Open(\"postgres\", dbinfo)\n    if err != nil {\n        log.Println(err)\n        return nil, err\n    }\n\n    err = db.Ping()\n    if err != nil {\n        log.Println(\"Cannot ping database\")\n        return nil, err\n    }\n\n    return &amp;DB{db}, nil\n}\n</code></pre>\n\n<p>Now I want to get store and use it in my API handlers. </p>\n\n<p>So, I create Environment structure and try to use it:</p>\n\n<pre><code>type Env struct {\n    db *store.Datastore\n}\n\nfunc (env *Env) HealthCheckHandler(w http.ResponseWriter, r *http.Request) {\n    // A very simple health check.\n}\n\nfunc main() {\n    log.Println(\"Server staring...\")\n\n    db, _ := store.NewDB(USER, PASSWORD, DB_NAME)\n\n    env := Env {\n        db: db,\n    }\n\n    r := mux.NewRouter()\n    r.HandleFunc(\"/health\", env.HealthCheckHandler)\n\n    log.Fatal(http.ListenAndServe(\"localhost:\"+PORT, r))\n}\n</code></pre>\n\n<p>But I have a error: </p>\n\n<blockquote>\n  <p>cannot use db (type *store.DB) as type *store.Datastore in field\n  value:    *store.Datastore is pointer to interface, not interface</p>\n</blockquote>\n\n<p>I know, how to fix this. I can use this structure instead of initial:</p>\n\n<pre><code>type Env struct {\n    db store.Datastore\n}\n</code></pre>\n\n<p>But I don't want to copy the data. </p>\n"}, {"tags": ["database", "go", "web"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "edited": false, "score": 0, "creation_date": 1529147386, "post_id": 50887338, "comment_id": 88776049, "body": "ok thank you, but how can I use the variable in my controller function? for example if i wanted to save it in /cart."}, {"owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "edited": false, "score": 0, "creation_date": 1529149933, "post_id": 50887338, "comment_id": 88776620, "body": "i tried it your way, but it show me /cart/Equipment and not /cart/name of choosen equipment"}, {"owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "edited": false, "score": 0, "creation_date": 1529150470, "post_id": 50887338, "comment_id": 88776764, "body": "I also can imagine to pass the id of a clicked submit button, but i dont know how to save or use it in my controller."}, {"owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "edited": false, "score": 0, "creation_date": 1529158187, "post_id": 50887338, "comment_id": 88778543, "body": "iam using net/http"}, {"owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "edited": false, "score": 0, "creation_date": 1529158318, "post_id": 50887338, "comment_id": 88778566, "body": "Edit my Post, got the Solution"}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "reply_to_user": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "edited": false, "score": 0, "creation_date": 1529160963, "post_id": 50887338, "comment_id": 88779182, "body": "glad could help"}], "tags": [], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "is_accepted": true, "score": 0, "last_activity_date": 1529147115, "creation_date": 1529147115, "answer_id": 50887338, "question_id": 50887026, "link": "https://stackoverflow.com/questions/50887026/how-to-find-the-id-of-the-selected-submit-button/50887338#50887338", "title": "How to find the ID of the selected submit button", "body": "<p>there are many ways but one of them is <code>&lt;form method=\"POST\" action=\"/cart/{{.Name}}\"&gt;</code></p>\n"}], "owner": {"reputation": 9, "user_id": 7874405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afae1ad5fbbf8bd9cdebb6605e3fd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChristopherG1994", "link": "https://stackoverflow.com/users/7874405/christopherg1994"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 50887338, "answer_count": 1, "score": 0, "last_activity_date": 1529165793, "creation_date": 1529144297, "last_edit_date": 1529165793, "question_id": 50887026, "link": "https://stackoverflow.com/questions/50887026/how-to-find-the-id-of-the-selected-submit-button", "title": "How to find the ID of the selected submit button", "body": "<p>I have a page that is dynamically generated from my database. It basically reflects all the contents of a table.</p>\n\n<pre><code> {{range .EquipmentList}}\n\n&lt;form method=\"POST\" action=\"/cart\"&gt;\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"col-1\"&gt;&lt;/div&gt;\n  &lt;div class=\"col-5\"&gt;\n     &lt;p name=\"test\"&gt; {{.Name}} &lt;/p&gt;\n     &lt;br&gt;\n     {{.Description}}\n     &lt;br&gt;\n     &lt;button id=\"{{.Name}}\" type=\"submit\" class=\"btn btn-main btn-margin\" &gt;&lt;b&gt;Ausleihen&lt;/b&gt;&lt;/button&gt; \n     {{if .Availability}}\n      &lt;input type=\"number\" class=\"form-control main-input2 feld2\" id=\"amount\" name=\"amount\" placeholder=\"Anzahl\"&gt;\n     &lt;em class=\"status-text\" style=\"color:green\"&gt; verf\u00fcgbar &lt;/em&gt;\n     {{else}}\n      &lt;input type=\"number\" class=\"form-control main-input2 feld2\" id=\"amount\" name=\"amount\" placeholder=\"Anzahl\"&gt;\n     &lt;em class=\"status-text\"&gt; entliehen &lt;/em&gt;\n     {{end}}\n  &lt;/div&gt;\n  &lt;div class=\"col-2\"&gt;&lt;/div&gt;\n  &lt;div class=\"col-2\" style=\"margin-top: 30px\"&gt;\n     &lt;img class=\"float-right img-responsive bild\" src=\"{{.ImgPath}}\" alt=\"Kann nicht gezeigt werden\"&gt;\n  &lt;/div&gt;\n  &lt;/div&gt;\n\n&lt;div class=\"placeholder\" style=\"height:50px\"&gt;&lt;/div&gt;\n\n&lt;/form&gt;\n{{end}}\n</code></pre>\n\n<p>In the template, all devices from the DB are listed and provided with their own Submit button.</p>\n\n<p>How can I find the fitting .Name entry to the triggered submit button?</p>\n\n<p>I want to pass this value to my / cart located in the controller.</p>\n\n<pre><code>    func Cart(w http.ResponseWriter,    r   *http.Request)  {   \n\ndata := Data{ \n    Name: \"Cart\",\n    Pages: []Page{\n        {\n            Title: \"Meine Ger\u00e4te\", \n            Active: false,\n            Link: \"/my-equipment\",\n        },\n        {\n            Title: \"Equipment\", \n            Active: false,\n            Link: \"/equipment\",\n        },\n        {\n            Title: \"Logout\",\n            Active: false,\n            Link: \"/logout\",\n        },\n    },\n}\n\nif r.Method==\"POST\"{\n // SAVE .Name here\n    tmpl:= template.Must(template.ParseFiles(\"template/base_user.html\", \"template/cart.html\"))\n    tmpl.ExecuteTemplate(w, \"base\", data)\n    }else{\n\n\n        tmpl:= template.Must(template.ParseFiles(\"template/base_user.html\", \"template/cart.html\"))\n    tmpl.ExecuteTemplate(w, \"base\", data)\n    }\n}\n</code></pre>\n\n<p>Now I got it: </p>\n\n<pre><code>{{range .EquipmentList}}\n&lt;form action=\"/cart?id={{.ID}}\" method=\"POST\"&gt;\n&lt;a href=\"/cart?id={{.ID}}\"&gt;{{.Name}}&lt;/a&gt;\n&lt;button type=\"submit\"&gt;\n&lt;/button&gt;&lt;/form&gt;\n{{end}}\n</code></pre>\n\n<p>if iam using this code, i can use the id value with r.formValue(\"id\") in my controller.</p>\n"}, {"tags": ["json", "go", "base64"], "comments": [{"owner": {"reputation": 1509, "user_id": 1093694, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4hdHu.jpg?s=128&g=1", "display_name": "Lupus", "link": "https://stackoverflow.com/users/1093694/lupus"}, "edited": false, "score": 0, "creation_date": 1529143736, "post_id": 50886884, "comment_id": 88775313, "body": "Don&#39;t get it. It seems same. <a href=\"https://play.golang.org/p/s5twKzSrTUK\" rel=\"nofollow noreferrer\">play.golang.org/p/s5twKzSrTUK</a>  output from base64encode.org: { \t&quot;signature&quot; = &quot;ZwXG56AezlHRTBhL8cTqA==&quot;; \t&quot;purchase-info&quot; = &quot;RXRjL0dNVCI7Cn0=&quot;; \t&quot;environment&quot; = &quot;Sandbox&quot;; \t&quot;pod&quot; = &quot;100&quot;; \t&quot;signing-status&quot; = &quot;0&quot;; }"}, {"owner": {"reputation": 1509, "user_id": 1093694, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4hdHu.jpg?s=128&g=1", "display_name": "Lupus", "link": "https://stackoverflow.com/users/1093694/lupus"}, "edited": false, "score": 0, "creation_date": 1529143876, "post_id": 50886884, "comment_id": 88775325, "body": "By the way your JSON is not valid. There should not be  semicolons <code>;</code> at the line endings."}, {"owner": {"reputation": 33451, "user_id": 3011380, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/oN76M.jpg?s=128&g=1", "display_name": "zangw", "link": "https://stackoverflow.com/users/3011380/zangw"}, "reply_to_user": {"reputation": 1509, "user_id": 1093694, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4hdHu.jpg?s=128&g=1", "display_name": "Lupus", "link": "https://stackoverflow.com/users/1093694/lupus"}, "edited": false, "score": 0, "creation_date": 1529149820, "post_id": 50886884, "comment_id": 88776592, "body": "@Lupus, actually, the result is different with <a href=\"https://www.base64encode.org/\" rel=\"nofollow noreferrer\">base64encode.org</a>, please view my question, I have updated my question."}, {"owner": {"reputation": 33451, "user_id": 3011380, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/oN76M.jpg?s=128&g=1", "display_name": "zangw", "link": "https://stackoverflow.com/users/3011380/zangw"}, "reply_to_user": {"reputation": 1509, "user_id": 1093694, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4hdHu.jpg?s=128&g=1", "display_name": "Lupus", "link": "https://stackoverflow.com/users/1093694/lupus"}, "edited": false, "score": 0, "creation_date": 1529150017, "post_id": 50886884, "comment_id": 88776651, "body": "@ThunderCat, the json string is returned from apple store in-app-purchase logic. Which confused me is why <code>[]byte(&quot;....&quot;)</code> and <code>[]byte(</code>...<code>)</code> given the different result after <code>base64.StdEncoding.EncodeToString</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 5, "last_activity_date": 1529153503, "last_edit_date": 1529153503, "creation_date": 1529152979, "answer_id": 50888005, "question_id": 50886884, "link": "https://stackoverflow.com/questions/50886884/how-to-base64-encode-special-json-string-in-golang/50888005#50888005", "title": "How to base64 encode special json string in golang?", "body": "<p>Double quotes and backticks denote different string literals in Go: <a href=\"https://play.golang.org/p/wfIPUJtxT9n\" rel=\"noreferrer\">https://play.golang.org/p/wfIPUJtxT9n</a></p>\n\n<p>In particular, backslashes are not escape characters when used with backticks; they are preserved. For instance, <code>len(\"\\\"\") == 1</code> (byte 0x22), but <code>len(`\\\"`) == 2</code> (bytes 0x5C and 0x22).</p>\n\n<p>This is defined <a href=\"https://golang.org/ref/spec#String_literals\" rel=\"noreferrer\">in the spec</a>:</p>\n\n<blockquote>\n  <p>Raw string literals are character sequences between back quotes, as in <code>foo</code>. Within the quotes, any character may appear except back quote. The value of a raw string literal is the string composed of the uninterpreted (implicitly UTF-8-encoded) characters between the quotes; in particular, backslashes have no special meaning and the string may contain newlines. Carriage return characters ('\\r') inside raw string literals are discarded from the raw string value.</p>\n</blockquote>\n"}], "owner": {"reputation": 33451, "user_id": 3011380, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/oN76M.jpg?s=128&g=1", "display_name": "zangw", "link": "https://stackoverflow.com/users/3011380/zangw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1389, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529153503, "creation_date": 1529143211, "last_edit_date": 1529150144, "question_id": 50886884, "link": "https://stackoverflow.com/questions/50886884/how-to-base64-encode-special-json-string-in-golang", "title": "How to base64 encode special json string in golang?", "body": "<p>I need to encode the following string through base64 in golang</p>\n\n<p><code>\"{\\n\\t\\\"signature\\\" = \\\"ZwXG56AezlHRTBhL8cTqA==\\\";\\n\\t\\\"purchase-info\\\" = \\\"RXRjL0dNVCI7Cn0=\\\";\\n\\t\\\"environment\\\" = \\\"Sandbox\\\";\\n\\t\\\"pod\\\" = \\\"100\\\";\\n\\t\\\"signing-status\\\" = \\\"0\\\";\\n}\"</code></p>\n\n<p>I try to do it as below</p>\n\n<pre><code>rec = []byte(\"{\\n\\t\\\"signature\\\" = \\\"ZwXG56AezlHRTBhL8cTqA==\\\";\\n\\t\\\"purchase-info\\\" = \\\"RXRjL0dNVCI7Cn0=\\\";\\n\\t\\\"environment\\\" = \\\"Sandbox\\\";\\n\\t\\\"pod\\\" = \\\"100\\\";\\n\\t\\\"signing-status\\\" = \\\"0\\\";\\n}\")\nstr := base64.StdEncoding.EncodeToString(rec)\nfmt.Println(str)\n</code></pre>\n\n<p>Output</p>\n\n<p><code>ewoJInNpZ25hdHVyZSIgPSAiWndYRzU2QWV6bEhSVEJoTDhjVHFBPT0iOwoJInB1cmNoYXNlLWluZm8iID0gIlJYUmpMMGROVkNJN0NuMD0iOwoJImVudmlyb25tZW50IiA9ICJTYW5kYm94IjsKCSJwb2QiID0gIjEwMCI7Cgkic2lnbmluZy1zdGF0dXMiID0gIjAiOwp9</code></p>\n\n<p>However, it failed. Because the result is different with the base64 result through <a href=\"https://www.base64encode.org/\" rel=\"nofollow noreferrer\">https://www.base64encode.org/</a>, which is </p>\n\n<p><code>e1xuXHRcInNpZ25hdHVyZVwiID0gXCJad1hHNTZBZXpsSFJUQmhMOGNUcUE9PVwiO1xuXHRcInB1cmNoYXNlLWluZm9cIiA9IFwiUlhSakwwZE5WQ0k3Q24wPVwiO1xuXHRcImVudmlyb25tZW50XCIgPSBcIlNhbmRib3hcIjtcblx0XCJwb2RcIiA9IFwiMTAwXCI7XG5cdFwic2lnbmluZy1zdGF0dXNcIiA9IFwiMFwiO1xufQ==</code></p>\n\n<p>Then I try it in this way</p>\n\n<pre><code>data1 := []byte(`{\\n\\t\\\"signature\\\" = \\\"ZwXG56AezlHRTBhL8cTqA==\\\";\\n\\t\\\"purchase-info\\\" = \\\"RXRjL0dNVCI7Cn0=\\\";\\n\\t\\\"environment\\\" = \\\"Sandbox\\\";\\n\\t\\\"pod\\\" = \\\"100\\\";\\n\\t\\\"signing-status\\\" = \\\"0\\\";\\n}`)\nstr1 := base64.StdEncoding.EncodeToString(data1)\nfmt.Println(str1)\n</code></pre>\n\n<p>Output:</p>\n\n<p><code>e1xuXHRcInNpZ25hdHVyZVwiID0gXCJad1hHNTZBZXpsSFJUQmhMOGNUcUE9PVwiO1xuXHRcInB1cmNoYXNlLWluZm9cIiA9IFwiUlhSakwwZE5WQ0k3Q24wPVwiO1xuXHRcImVudmlyb25tZW50XCIgPSBcIlNhbmRib3hcIjtcblx0XCJwb2RcIiA9IFwiMTAwXCI7XG5cdFwic2lnbmluZy1zdGF0dXNcIiA9IFwiMFwiO1xufQ==</code></p>\n\n<p>Now the result is correct.</p>\n\n<p>How to convert the original string from </p>\n\n<pre><code>[]byte(\"{\\n\\t\\\"signature\\\" = \\\"ZwXG56AezlHRTBhL8cTqA==\\\";\\n\\t\\\"purchase-info\\\" = \\\"RXRjL0dNVCI7Cn0=\\\";\\n\\t\\\"environment\\\" = \\\"Sandbox\\\";\\n\\t\\\"pod\\\" = \\\"100\\\";\\n\\t\\\"signing-status\\\" = \\\"0\\\";\\n}\")\n</code></pre>\n\n<p>to </p>\n\n<pre><code>[]byte(`{\\n\\t\\\"signature\\\" = \\\"ZwXG56AezlHRTBhL8cTqA==\\\";\\n\\t\\\"purchase-info\\\" = \\\"RXRjL0dNVCI7Cn0=\\\";\\n\\t\\\"environment\\\" = \\\"Sandbox\\\";\\n\\t\\\"pod\\\" = \\\"100\\\";\\n\\t\\\"signing-status\\\" = \\\"0\\\";\\n}`) \n</code></pre>\n\n<p>in golang? or is there any better way to do that?</p>\n"}, {"tags": ["go", "https", "get"], "comments": [{"owner": {"reputation": 15, "user_id": 9165063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acb4709cbb49499e549d5dfd440a73c4?s=128&d=identicon&r=PG&f=1", "display_name": "bot test", "link": "https://stackoverflow.com/users/9165063/bot-test"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1529143166, "post_id": 50886787, "comment_id": 88775169, "body": "I am getting access denied, server not allowed to send requet"}, {"owner": {"reputation": 15, "user_id": 9165063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acb4709cbb49499e549d5dfd440a73c4?s=128&d=identicon&r=PG&f=1", "display_name": "bot test", "link": "https://stackoverflow.com/users/9165063/bot-test"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1529143318, "post_id": 50886787, "comment_id": 88775212, "body": "@ThunderCat please try on new url you will see"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1529146868, "post_id": 50886787, "comment_id": 88775957, "body": "Other than the ignored errors, the application correctly requests a resource from the server.  Perhaps the service provider can provide assistance."}], "answers": [{"tags": [], "owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "is_accepted": true, "score": 0, "last_activity_date": 1529171170, "creation_date": 1529171170, "answer_id": 50890272, "question_id": 50886787, "link": "https://stackoverflow.com/questions/50886787/sending-requests-to-https-site/50890272#50890272", "title": "Sending Requests to Https site", "body": "<p>After testing a little bit, it looks like that specific website is using Akamai Ghost and has been configured to block the default go http package user agent.</p>\n\n<p>The default user agent appears to be <code>Go-http-client/1.1</code></p>\n\n<p>If you change your user agent</p>\n\n<pre><code>req.Header.Set(\"User-Agent\", \"my-client-app\")\n</code></pre>\n\n<p>The request will work. However, the website in question appears to not want to be programatically crawled. Perhaps you should respect their wishes.</p>\n"}], "owner": {"reputation": 15, "user_id": 9165063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acb4709cbb49499e549d5dfd440a73c4?s=128&d=identicon&r=PG&f=1", "display_name": "bot test", "link": "https://stackoverflow.com/users/9165063/bot-test"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 50890272, "answer_count": 1, "score": -5, "last_activity_date": 1529171170, "creation_date": 1529142480, "last_edit_date": 1529149323, "question_id": 50886787, "link": "https://stackoverflow.com/questions/50886787/sending-requests-to-https-site", "title": "Sending Requests to Https site", "body": "<p>Essentially, through goLang I'm trying to send a request on a https site to check if an item is on the site.\nI have tried to attempt a request to the main site, but keep getting access denied and need a way to tackle this, I'm trying to get the info from the body to separate it and find the correct ids to check if something is on the site.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"io/ioutil\"\n)\n\nfunc main() {\n\n   url := \"https://www.jdsports.co.uk/\"\n\n   req, _ := http.NewRequest(\"GET\", url, nil)\n\n   res, _ := http.DefaultClient.Do(req)\n\n   defer res.Body.Close()\n\n   body, _ := ioutil.ReadAll(res.Body)\n\n   fmt.Println(string(body)) \n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": true, "score": 4, "last_activity_date": 1529141985, "creation_date": 1529141985, "answer_id": 50886728, "question_id": 50886292, "link": "https://stackoverflow.com/questions/50886292/scanf-value-is-executed-as-command-in-terminal/50886728#50886728", "title": "Scanf value is executed as command in terminal", "body": "<p>When using \"plain fmt.Scanf\" the input must match the expected format, ie in your case it must be valid float. If it isn't then the scanning is aborted and rest of the input remains in console's input buffer where it is executed as next command after your program exits.</p>\n\n<p>To fix this you wrap the stdin into an <code>bufio.Reader</code> or <code>bufio.Scanner</code>:</p>\n\n<pre><code>func main() {\n    var miles float64\n\n    fmt.Print(\"Enter miles: \")\n    //\n    reader := bufio.NewReader(os.Stdin)\n    val, err := reader.ReadString('\\n')\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    if _, err = fmt.Sscanf(val, \"%f\", &amp;miles); err != nil {\n        fmt.Println(val, err)\n        return\n    }\n\n    fmt.Println(miles)\n\n    km := kmInMile * miles\n\n    fmt.Println(miles, \"miles =\", km, \"km\")\n}\n</code></pre>\n\n<p>This way you consume whole line from input and process it separately.</p>\n"}], "owner": {"reputation": 63, "user_id": 6831682, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba07ea3d6b83d2f6cd5add6d74e1d30c?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandr Krivosheev", "link": "https://stackoverflow.com/users/6831682/alexandr-krivosheev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 1, "accepted_answer_id": 50886728, "answer_count": 1, "score": 1, "last_activity_date": 1529141985, "creation_date": 1529137961, "last_edit_date": 1529138355, "question_id": 50886292, "link": "https://stackoverflow.com/questions/50886292/scanf-value-is-executed-as-command-in-terminal", "title": "Scanf value is executed as command in terminal", "body": "<p>I have simple go program that converts miles to kilometers:</p>\n\n<pre><code>const kmInMile = 1.609344\n\nfunc main() {\n    var miles float64\n\n    fmt.Print(\"Enter miles: \")\n    fmt.Scanf(\"%f\", &amp;miles)\n\n    fmt.Println(miles)\n\n    km := kmInMile * miles\n\n    fmt.Println(miles, \"miles =\", km, \"km\")\n}\n</code></pre>\n\n<p>If I pass \"lls\" as input to scanf:</p>\n\n<pre><code>Enter miles: lls\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>0\n0 miles = 0 km\nalexandrkrivosheev$ ls\nhello   main.go\n</code></pre>\n\n<p>so the first char of input was taken and all other were <strong>executed as command</strong>.\nWhy does it happened and how can i prevent this?</p>\n\n<p>Full terminal session:</p>\n\n<pre><code>alexandrkrivosheev$ ./hello \nEnter miles: lls\n0\n0 miles = 0 km\nalexandrkrivosheev$ ls\nhello   main.go\nalexandrkrivosheev$ \n</code></pre>\n"}, {"tags": ["arrays", "loops", "go", "recursion"], "answers": [{"comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1529162772, "post_id": 50885707, "comment_id": 88779601, "body": "This code will not work. <code>return null</code> is an error since there is no <code>null</code> in Go. <code>fmt.Scan(&amp;a[i])</code> is a runtime error because <code>a</code> is always a slice of <code>len=1 cap=1</code>, and <code>a[i]</code> will panic due to out of range when i&gt;1."}], "tags": [], "owner": {"reputation": 11, "user_id": 9707463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02bac302b16833de3ca328ac870fe5ce?s=128&d=identicon&r=PG&f=1", "display_name": "sjette", "link": "https://stackoverflow.com/users/9707463/sjette"}, "is_accepted": false, "score": 0, "last_activity_date": 1529174342, "last_edit_date": 1529174342, "creation_date": 1529132346, "answer_id": 50885707, "question_id": 50885174, "link": "https://stackoverflow.com/questions/50885174/recursion-instead-of-looping/50885707#50885707", "title": "Recursion instead of looping", "body": "<p>My syntax may be a little off, so I commented what each line does. Essentially, you would get one item of the array each time, and attach an array of one smaller in front of it, which you get by getting a value and attaching an array of one smaller in front of that, until that value is 1 and you're just getting a value.</p>\n\n<pre><code>func set(n int) []int {    // declare a function that takes an int as a parameter\n                           // and returns an int array\n    var recRet = []int{}       // need a temporary array to store return value\n    a := make([]int, 1)        // make an array of one to get the value this iteration\n    if n &lt; 1 {                   //should never be here but prevents looping\n       return nil              // escape\n    }\n    if n &gt; 1 {                  // if we're not in the base case\n        recRet = set(n-1)      // recurse on a list one smaller and store it\n    }\n\n    fmt.Scan(&amp;a[1])            // get the value for this iteration\n    fmt.Println(a)             // print it\n    return append(a, recRet...)// send this value plus the values gotten from recursion\n                               // back up\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": true, "score": 1, "last_activity_date": 1529165200, "creation_date": 1529165200, "answer_id": 50889520, "question_id": 50885174, "link": "https://stackoverflow.com/questions/50885174/recursion-instead-of-looping/50889520#50889520", "title": "Recursion instead of looping", "body": "<p>I am not sure what you want to be recursive. But as I understand your question as changing a for-loop into a recursion, I made it into a tail recursion in a closure, in a functional programing style.</p>\n\n<pre><code>func set(n int) {\n    a := make([]int, n)\n    var setRecursive func(int) // declare a function variable, which take an int as param.\n    setRecursive = func(i int) { // set the function in closure, so a and n is available to it.\n        if i == 0 { // end point of the recursion, return.\n            return\n        }\n        Scan(&amp;a[n-i]) // Use fmt.Scan out of playground\n        setRecursive(i - 1) // tail recursion.\n    }\n    setRecursive(n) // call the function, start the recursion.\n    fmt.Println(a)\n}\n</code></pre>\n\n<p>If you want the matter simpler, you can remove the closure part and move the line <code>Scan(&amp;a[n-i])</code> behind the line <code>setRecursive(n)</code>, Like below:</p>\n\n<pre><code>func SetRecursive(a []int, n int) {\n    if n==0 {\n        return\n    }\n\n    SetRecursive(a,n-1) // recurse first, so we can scan in the right order.\n    Scan(&amp;a[n-1])\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/0io190tyviE\" rel=\"nofollow noreferrer\">https://play.golang.org/p/0io190tyviE</a></p>\n"}], "owner": {"reputation": 91, "user_id": 8991341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf8c027a208a81f148116a0e8086d58?s=128&d=identicon&r=PG&f=1", "display_name": "mel lu", "link": "https://stackoverflow.com/users/8991341/mel-lu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 2, "closed_date": 1529176856, "accepted_answer_id": 50889520, "answer_count": 2, "score": 2, "last_activity_date": 1529174342, "creation_date": 1529126259, "last_edit_date": 1529127442, "question_id": 50885174, "link": "https://stackoverflow.com/questions/50885174/recursion-instead-of-looping", "closed_reason": "Not suitable for this site", "title": "Recursion instead of looping", "body": "<p>I'm new in Go programming, so how to implement recursion instead of a for loop in this code?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var n int\n    fmt.Scan(&amp;n)\n    set(n)\n}\n\nfunc set(n int) {\n    a := make([]int, n)\n    for i := 0; i &lt; n; i++ {\n        fmt.Scan(&amp;a[i])\n    }\n    fmt.Println(a)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1529133577, "post_id": 50884144, "comment_id": 88773343, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/48943178/read-numbers-from-os-stdin-into-array-or-slice-in-go/48944099#48944099\">Read numbers from os.Stdin into array or slice in Go</a>."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1529156752, "post_id": 50884144, "comment_id": 88778196, "body": "@icza: The question says &quot;I can&#39;t use a for loop.&quot;"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1529157114, "post_id": 50884144, "comment_id": 88778281, "body": "@peterSO You&#39;re right, in which case your solution should be accepted."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6759575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881fef408bffb1466f25a9996f39c14e?s=128&d=identicon&r=PG&f=1", "display_name": "user57501", "link": "https://stackoverflow.com/users/6759575/user57501"}, "edited": false, "score": 0, "creation_date": 1529123270, "post_id": 50884398, "comment_id": 88771776, "body": "Thanks, this looks perfect! Would you mind explaining the purpose of saying &quot;[]int(nil)&quot;, specifically the (nil) portion? I understand every other part of your snippet."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 13, "user_id": 6759575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881fef408bffb1466f25a9996f39c14e?s=128&d=identicon&r=PG&f=1", "display_name": "user57501", "link": "https://stackoverflow.com/users/6759575/user57501"}, "edited": false, "score": 0, "creation_date": 1529126458, "post_id": 50884398, "comment_id": 88772199, "body": "@user57501: See the addendum to my answer."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1529126864, "last_edit_date": 1529126864, "creation_date": 1529114623, "answer_id": 50884398, "question_id": 50884144, "link": "https://stackoverflow.com/questions/50884144/how-to-fill-a-slice-with-scan-values/50884398#50884398", "title": "How to fill a slice with scan values", "body": "<blockquote>\n  <p>[Get] <code>fmt.Scan()</code> to fill a slice. The number of input values is dynamic and I can't use a for loop.</p>\n</blockquote>\n\n<hr>\n\n<p>Perhaps, something like this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc input(x []int, err error) []int {\n    if err != nil {\n        return x\n    }\n    var d int\n    n, err := fmt.Scanf(\"%d\", &amp;d)\n    if n == 1 {\n        x = append(x, d)\n    }\n    return input(x, err)\n}\n\nfunc main() {\n    fmt.Println(\"Enter input:\")\n    x := input([]int{}, nil)\n    fmt.Println(\"Input:\", x)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Enter input:\n 1\n2 3\n4\n 5  6  7\n\nInput: [1 2 3 4 5 6 7]\n</code></pre>\n\n<hr>\n\n<p>ADDENDUM:</p>\n\n<p>When storage is allocated for a variable or a new value is created, and no explicit initialization is provided, the variable or value is given a default value, <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow noreferrer\">the zero value</a> for its type: <code>nil</code> for slices. <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">Conversions</a> are expressions of the form <code>T(x)</code> where <code>T</code> is a type and <code>x</code> is an expression that can be converted to type <code>T</code>. <code>[]int(nil)</code> is a conversion to the zero value for the slice value <code>[]int</code>. </p>\n\n<pre><code>x := input([]int(nil), nil)\n</code></pre>\n\n<p>is equivalent to </p>\n\n<pre><code>x := input([]int{}, nil)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var x []int\nx = input(x, nil)\n</code></pre>\n\n<p>I have revised my answer to use:</p>\n\n<pre><code>x := input([]int{}, nil)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 11684700, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pB0sr4kUJJM/AAAAAAAAAAI/AAAAAAAALJY/Q1JWsN3ScU8/photo.jpg?sz=128", "display_name": "Danny Joel Devarapalli", "link": "https://stackoverflow.com/users/11684700/danny-joel-devarapalli"}, "is_accepted": false, "score": 0, "last_activity_date": 1596117305, "creation_date": 1596117305, "answer_id": 63174724, "question_id": 50884144, "link": "https://stackoverflow.com/questions/50884144/how-to-fill-a-slice-with-scan-values/63174724#63174724", "title": "How to fill a slice with scan values", "body": "<p>Using simple packages and more logic, you could try this,</p>\n<pre><code>package main\n\nimport &quot;fmt&quot;\n\nfunc main() {\n    var ele rune\n    var size int\n    var sli = make([]int,0,1)\n    size = cap(sli)\n    for i:=0; i&lt;=size; i++{\n        if i&gt;=len(sli){\n            size=size+1\n        }\n        ele = 0\n        fmt.Println(&quot;Enter a number to add: &quot;)\n        fmt.Scan(&amp;ele)\n        if ele==0 {\n            fmt.Println(&quot;Stopping!&quot;)\n            break\n        }\n        sli = append(sli, int(ele))\n    }\n    fmt.Println(sli)\n}\n</code></pre>\n<p>The code would stop and print the slice when you enter anything other than an integer.</p>\n"}], "owner": {"reputation": 13, "user_id": 6759575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881fef408bffb1466f25a9996f39c14e?s=128&d=identicon&r=PG&f=1", "display_name": "user57501", "link": "https://stackoverflow.com/users/6759575/user57501"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1520, "favorite_count": 2, "accepted_answer_id": 50884398, "answer_count": 2, "score": 1, "last_activity_date": 1596117305, "creation_date": 1529109802, "last_edit_date": 1529165810, "question_id": 50884144, "link": "https://stackoverflow.com/questions/50884144/how-to-fill-a-slice-with-scan-values", "title": "How to fill a slice with scan values", "body": "<p>I'm brand new to Go and having trouble getting fmt.scan() to fill a slice. The number of input values is dynamic and I can't use a for loop. My initial thought was to try this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var x []int\n    fmt.Println(\"Enter input\")\n    fmt.Scanf(\"%v\", append(x))\n    fmt.Println(x)\n}\n</code></pre>\n\n<p>Which obviously doesn't work. Can someone point me in the right direction?</p>\n"}, {"tags": ["mysql", "database", "go"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1529118440, "post_id": 50883513, "comment_id": 88771176, "body": "See <a href=\"https://github.com/go-xorm/xorm/issues/1006\" rel=\"nofollow noreferrer\">github.com/go-xorm/xorm/issues/1006</a>"}, {"owner": {"reputation": 12150, "user_id": 1143724, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/47fa5f1bc077c8158fe5ad1287105381?s=128&d=identicon&r=PG", "display_name": "MrDuk", "link": "https://stackoverflow.com/users/1143724/mrduk"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1529121576, "post_id": 50883513, "comment_id": 88771568, "body": "That&#39;s my issue that I posted to the repo \ud83d\ude0a"}, {"owner": {"reputation": 1114, "user_id": 8190553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6OTwb.png?s=128&g=1", "display_name": "will7200", "link": "https://stackoverflow.com/users/8190553/will7200"}, "edited": false, "score": 0, "creation_date": 1529176525, "post_id": 50883513, "comment_id": 88782839, "body": "You should format the time yourself. When exactly is it going through this code and why?"}], "owner": {"reputation": 12150, "user_id": 1143724, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/47fa5f1bc077c8158fe5ad1287105381?s=128&d=identicon&r=PG", "display_name": "MrDuk", "link": "https://stackoverflow.com/users/1143724/mrduk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529102748, "creation_date": 1529102748, "question_id": 50883513, "link": "https://stackoverflow.com/questions/50883513/is-it-possible-for-go-xorm-to-detect-datetime3-types", "title": "Is it possible for go-xorm to detect DATETIME(3) types?", "body": "<p>My code ultimately ends up in this section of <code>go-xorm</code>:</p>\n\n<pre><code>// formatTime format time as column type\nfunc (engine *Engine) formatTime(sqlTypeName string, t time.Time) (v interface{}) {\n    switch sqlTypeName {\n    case core.Time:\n        s := t.Format(\"2006-01-02 15:04:05\") //time.RFC3339\n        v = s[11:19]\n    case core.Date:\n        v = t.Format(\"2006-01-02\")\n    case core.DateTime, core.TimeStamp:\n        v = t.Format(\"2006-01-02 15:04:05\")\n    case core.TimeStampz:\n        if engine.dialect.DBType() == core.MSSQL {\n            v = t.Format(\"2006-01-02T15:04:05.9999999Z07:00\")\n        } else {\n            v = t.Format(time.RFC3339Nano)\n        }\n    case core.BigInt, core.Int:\n        v = t.Unix()\n    default:\n        v = t\n    }\n    return\n}\n</code></pre>\n\n<p>The problem is, my actual type in the DB is <code>datetime(3)</code> -- xorm recognizes this as just <code>datetime</code> though, effectively truncating my ms precision. Is there a way around this?</p>\n\n<p>This is a fundamental dependency in a project I'm working on, so not using xorm isn't an option at this time unfortunately.</p>\n"}]