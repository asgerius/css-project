[{"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1499929527, "post_id": 45068666, "comment_id": 77119690, "body": "Related: <a href=\"https://stackoverflow.com/questions/37384473/call-all-functions-with-special-prefix-or-suffix-in-golang/37384665#37384665\">Call all functions with special prefix or suffix in Golang</a>."}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1499990071, "post_id": 45068666, "comment_id": 77157825, "body": "Thank you @icza, that is useful."}], "answers": [{"comments": [{"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "edited": false, "score": 0, "creation_date": 1499901760, "post_id": 45068974, "comment_id": 77111236, "body": "Thanks for your response, but my sliceOfCollector is slice of string name. Is there any way to do from name?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "edited": false, "score": 0, "creation_date": 1499901996, "post_id": 45068974, "comment_id": 77111299, "body": "It is not possible to create from string name, you need a <code>type</code>.  Otherwise as an alternative, you may have to follow factory pattern sort of; supply string to function and have <code>switch&#47;if</code> then create a instance normally <code>package1.NewRule{}</code> then return it."}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "edited": false, "score": 0, "creation_date": 1499902464, "post_id": 45068974, "comment_id": 77111410, "body": "Okk. let me try"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "edited": false, "score": 0, "creation_date": 1499902498, "post_id": 45068974, "comment_id": 77111418, "body": "Shall I add the example of that in the answer? let me know."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 3, "last_activity_date": 1499906423, "last_edit_date": 1499906423, "creation_date": 1499901393, "answer_id": 45068974, "question_id": 45068666, "link": "https://stackoverflow.com/questions/45068666/package-selector-with-string-name/45068974#45068974", "title": "Package selector with string name", "body": "<p>Use <a href=\"https://golang.org/pkg/reflect/#New\" rel=\"nofollow noreferrer\">reflect.New</a> with <code>struct</code> type. In Go you have to use type to create a new instance dynamically not string.</p>\n\n<p>Example: To create struct instance dynamically, you can do</p>\n\n<pre><code>package main\n\nimport \"reflect\"\n\nimport (\n   \"github.com/collector/package1\"\n   \"github.com/collector/package2\"\n)\n\nfunc main() {\n    sliceOfCollector := make([]reflect.Type, 0)\n    sliceOfCollector = append(sliceOfCollector, reflect.TypeOf((*package1.NewRule)(nil)).Elem()})\n    sliceOfCollector = append(sliceOfCollector, reflect.TypeOf((*package2.OldRule)(nil)).Elem()})\n\n    for _, collectorType := range slice sliceOfCollector {\n        col := reflect.New(collectorType)\n        fmt.Printf(\"%#v\\n\", col)\n    }\n}\n</code></pre>\n\n<p>You can use <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertions</a> after that <code>col.Interface().(*package1.NewRule)</code></p>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>After comment interaction, added following.</p>\n\n<p>Creating a instance using factory method. Just an idea.</p>\n\n<pre><code>func main() {\n    sliceOfCollector := []string{\"NewRule\", \"OldRule\"}\n\n    for _, col := range sliceOfCollector {\n        rule := CreateRuleByName(col)\n        fmt.Printf(\"%#v\\n\", rule)\n    }\n}\n\nfunc CreateRuleByName(name string) interface{} {\n    switch name {\n    case \"NewRule\":\n       return &amp;package1.NewRule{}\n    case \"OldRule\":\n       return &amp;package2.OldRule{}\n    default:\n       return nil\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 45068974, "answer_count": 1, "score": 0, "last_activity_date": 1499906423, "creation_date": 1499899361, "question_id": 45068666, "link": "https://stackoverflow.com/questions/45068666/package-selector-with-string-name", "title": "Package selector with string name", "body": "<p>I am trying to figure out a way to access struct from multiple packages with name.</p>\n\n<p>Here is my structure:</p>\n\n<pre><code>collector/package1\ncollector/package2\n</code></pre>\n\n<p>..\npackage1 contains:</p>\n\n<pre><code>package collector\n\ntype NewRule struct {\n}\n</code></pre>\n\n<p>..\npackage2 contains:</p>\n\n<pre><code>package collector\n\ntype OldRule struct {\n}\n</code></pre>\n\n<p>....</p>\n\n<p>In my main.go:</p>\n\n<pre><code> import \"github.com/mypackage/collector\"\n\n sliceOfCollector := []string{\"NewRule\", \"OldRule\"}\n\n for _, col := range sliceOfCollector{\n      // How to use the above collector name `col` to create struct instance.\n }\n</code></pre>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1499893506, "post_id": 45067382, "comment_id": 77108244, "body": "What is the motivation for this? Are you able to use a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 3396, "user_id": 1103734, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/87a5e4ab78c197e14ca8cbe22e84b53c?s=128&d=identicon&r=PG", "display_name": "ollien", "link": "https://stackoverflow.com/users/1103734/ollien"}, "edited": false, "score": 0, "creation_date": 1499901717, "post_id": 45067544, "comment_id": 77111219, "body": "Why does this work, but not something like <code>_, ok := t.(Test)</code>? That gives the error <code>invalid type assertion: t.(Test) (non-interface type Test on left)</code>"}, {"owner": {"reputation": 3396, "user_id": 1103734, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/87a5e4ab78c197e14ca8cbe22e84b53c?s=128&d=identicon&r=PG", "display_name": "ollien", "link": "https://stackoverflow.com/users/1103734/ollien"}, "edited": false, "score": 1, "creation_date": 1499903200, "post_id": 45067544, "comment_id": 77111609, "body": "Ah, I figured it out. The important bit here is not the type switch, but rather the implicit conversion to interface{} in the function argument. Thank you!"}], "tags": [], "owner": {"reputation": 2960, "user_id": 3521243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EJDD8.jpg?s=128&g=1", "display_name": "Emile Pels", "link": "https://stackoverflow.com/users/3521243/emile-pels"}, "is_accepted": true, "score": 14, "last_activity_date": 1594754003, "last_edit_date": 1594754003, "creation_date": 1499893689, "answer_id": 45067544, "question_id": 45067382, "link": "https://stackoverflow.com/questions/45067382/check-type-of-struct-in-go/45067544#45067544", "title": "Check type of struct in Go", "body": "<p>Type assertions:</p>\n<pre><code>package main\n\nimport &quot;fmt&quot;\n\ntype Test struct {\n    foo int\n}\n\nfunc isTest(t interface{}) bool {\n    switch t.(type) {\n    case Test:\n        return true\n    default:\n        return false\n    }\n}\n\nfunc main() {\n    t := Test{5}\n    fmt.Println(isTest(t))\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/dotXc8BTcU\" rel=\"nofollow noreferrer\">Playground</a></p>\n<hr />\n<p>And, more simplified:</p>\n<pre><code>_, isTest := v.(Test)\n</code></pre>\n<p><a href=\"https://play.golang.org/p/-7-DnVF5Y76\" rel=\"nofollow noreferrer\">Playground</a></p>\n<hr />\n<p>You can refer to the <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">language specification</a> for a technical explanation.</p>\n"}, {"comments": [{"owner": {"reputation": 3396, "user_id": 1103734, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/87a5e4ab78c197e14ca8cbe22e84b53c?s=128&d=identicon&r=PG", "display_name": "ollien", "link": "https://stackoverflow.com/users/1103734/ollien"}, "edited": false, "score": 0, "creation_date": 1499900937, "post_id": 45067605, "comment_id": 77111008, "body": "Sorry if this is a duplicate. I couldn&#39;t find the original myself."}, {"owner": {"reputation": 3396, "user_id": 1103734, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/87a5e4ab78c197e14ca8cbe22e84b53c?s=128&d=identicon&r=PG", "display_name": "ollien", "link": "https://stackoverflow.com/users/1103734/ollien"}, "edited": false, "score": 0, "creation_date": 1499903437, "post_id": 45067605, "comment_id": 77111659, "body": "Looking at this, this is certainly clever, but less idiomatic IMO than what Emile provided. Thank you so much for the answer, though :)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3396, "user_id": 1103734, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/87a5e4ab78c197e14ca8cbe22e84b53c?s=128&d=identicon&r=PG", "display_name": "ollien", "link": "https://stackoverflow.com/users/1103734/ollien"}, "edited": false, "score": 1, "creation_date": 1499903637, "post_id": 45067605, "comment_id": 77111703, "body": "@ollien Yes, type assertion is easier and faster, but you tagged the quesiton with <a href=\"https://stackoverflow.com/questions/tagged/reflection\">reflection</a>."}, {"owner": {"reputation": 3396, "user_id": 1103734, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/87a5e4ab78c197e14ca8cbe22e84b53c?s=128&d=identicon&r=PG", "display_name": "ollien", "link": "https://stackoverflow.com/users/1103734/ollien"}, "edited": false, "score": 0, "creation_date": 1499903705, "post_id": 45067605, "comment_id": 77111725, "body": "Perhaps I shouldn&#39;t have. I tagged it as that because everything I found regarding checking types used it. Should I remove the tag?   FWIW, I&#39;m not the one who downvoted you."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3396, "user_id": 1103734, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/87a5e4ab78c197e14ca8cbe22e84b53c?s=128&d=identicon&r=PG", "display_name": "ollien", "link": "https://stackoverflow.com/users/1103734/ollien"}, "edited": false, "score": 0, "creation_date": 1499903837, "post_id": 45067605, "comment_id": 77111753, "body": "@ollien Don&#39;t think you should, your solution uses reflection."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1499893966, "creation_date": 1499893966, "answer_id": 45067605, "question_id": 45067382, "link": "https://stackoverflow.com/questions/45067382/check-type-of-struct-in-go/45067605#45067605", "title": "Check type of struct in Go", "body": "<p>You may pass a \"typed\" <code>nil</code> pointer value to <a href=\"https://golang.org/pkg/reflect/#TypeOf\" rel=\"nofollow noreferrer\"><code>reflect.TypeOf()</code></a>, and call <code>Type.Elem()</code> to get the type of the pointed value. This does not allocate or initialize a value of the type (in question), as only a <code>nil</code> pointer value is used:</p>\n\n<pre><code>fmt.Println(reflect.TypeOf(t) == reflect.TypeOf((*Test)(nil)).Elem())\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/IdWGRxoqqQ\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>P.S. This is an exact duplicate, but can't find the original.</p>\n"}], "owner": {"reputation": 3396, "user_id": 1103734, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/87a5e4ab78c197e14ca8cbe22e84b53c?s=128&d=identicon&r=PG", "display_name": "ollien", "link": "https://stackoverflow.com/users/1103734/ollien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11885, "favorite_count": 0, "accepted_answer_id": 45067544, "answer_count": 2, "score": 3, "last_activity_date": 1594754003, "creation_date": 1499893030, "question_id": 45067382, "link": "https://stackoverflow.com/questions/45067382/check-type-of-struct-in-go", "title": "Check type of struct in Go", "body": "<p>I'm trying to check the type of a struct in Go. This was the best way I could come up with. Is there a better way to do it, preferably without initializing a struct?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Test struct{\n    foo int\n}\n\nfunc main() {\n    t := Test{5}\n    fmt.Println(reflect.TypeOf(t) == reflect.TypeOf(Test{}))\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 5695670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd079a335a1ef8e7b26cab86b88a6a63?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/5695670/unknown"}, "edited": false, "score": 0, "creation_date": 1499958082, "post_id": 45067198, "comment_id": 77141309, "body": "thank you very much for your answer, but my problem is <b>mapping</b>, as you know golang strongly typed, because that many problems happen to me, I&#39;m trying to find a solution for this or golang package to help me to mapping json."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 125, "user_id": 5695670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd079a335a1ef8e7b26cab86b88a6a63?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/5695670/unknown"}, "edited": false, "score": 0, "creation_date": 1499961862, "post_id": 45067198, "comment_id": 77144166, "body": "Thanks, can you please describe your issues you faced with mapping? So that I can provide my inputs."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 125, "user_id": 5695670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd079a335a1ef8e7b26cab86b88a6a63?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/5695670/unknown"}, "edited": false, "score": 0, "creation_date": 1500056109, "post_id": 45067198, "comment_id": 77190067, "body": "I have updated the answer, have a look. I believe it gives you an idea to start then you can accept the answer."}, {"owner": {"reputation": 125, "user_id": 5695670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd079a335a1ef8e7b26cab86b88a6a63?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/5695670/unknown"}, "edited": false, "score": 0, "creation_date": 1500119093, "post_id": 45067198, "comment_id": 77206726, "body": "Thank you very much for your help and for your times."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 2, "last_activity_date": 1500056016, "last_edit_date": 1500056016, "creation_date": 1499892236, "answer_id": 45067198, "question_id": 45065678, "link": "https://stackoverflow.com/questions/45065678/how-i-can-mapping-complex-json-to-other-json/45067198#45067198", "title": "how I can mapping complex JSON to other JSON", "body": "<p><strong>EDIT:</strong></p>\n\n<p>After comment interaction and with updated question. Before we move forward, I would like to mention.</p>\n\n<blockquote>\n  <p>I just looked at your <code>example-2</code> Remember one thing. Mapping is from one form to another form. Basically <code>one known format to targeted format</code>. Each data type have to handled. You cannot do <code>generic</code> to <code>generic</code> mapping logically (technically feasible though, would take more time &amp; efforts, you can play around on this).</p>\n</blockquote>\n\n<p>I have created sample working program of one approach; it does a mapping of source to targeted format. Refer this program as a start point and use your creativity to implement yours.</p>\n\n<p>Playground link: <a href=\"https://play.golang.org/p/MEk_nGcPjZ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/MEk_nGcPjZ</a></p>\n\n<p><strong>Explanation:</strong> Sample program achieves two different source format to one target format. The program consist of -</p>\n\n<ul>\n<li>Targeted Mapping definition of Provider 1</li>\n<li>Targeted Mapping definition of Provider 2</li>\n<li>Provider 1 JSON</li>\n<li>Provider 2 JSON</li>\n<li>Mapping function</li>\n<li>Targeted JSON marshal</li>\n</ul>\n\n<p><strong>Key elements from program:</strong> refer play link for complete program.</p>\n\n<pre><code>type MappingInfo struct {\n    TargetKey     string\n    SourceKeyPath string\n    DataType      string\n}\n</code></pre>\n\n<p><strong>Map function:</strong></p>\n\n<pre><code>func mapIt(mapping []*MappingInfo, parsedResult gjson.Result) map[string]interface{} {\n    mappedData := make(map[string]interface{})\n    for _, m := range mapping {\n        switch m.DataType {\n        case \"time\":\n            mappedData[m.TargetKey] = parsedResult.Get(m.SourceKeyPath).Time()\n        case \"string\":\n            mappedData[m.TargetKey] = parsedResult.Get(m.SourceKeyPath).String()\n        }\n    }\n    return mappedData\n}\n</code></pre>\n\n<p><strong>Output:</strong> </p>\n\n<pre><code>Provider 1 Result: map[date:2017-05-17 08:52:36.024 +0000 UTC clientName:provider1 username]\nProvider 1 JSON: {\n  \"clientName\": \"provider1 username\",\n  \"date\": \"2017-05-17T08:52:36.024Z\"\n}\n\nProvider 2 Result: map[date:2017-05-12 06:32:46.014 +0000 UTC clientName:provider2 username]\nProvider 2 JSON: {\n  \"clientName\": \"provider2 username\",\n  \"date\": \"2017-05-12T06:32:46.014Z\"\n}\n</code></pre>\n\n<p>Good luck, happy coding!</p>\n\n<hr>\n\n<p>Typically Converting/Transforming one structure to another structure, you will have to handle this with application logic.</p>\n\n<p>As you mentioned in the question:</p>\n\n<blockquote>\n  <p>my problem is I have different apis, every api have own json schema</p>\n</blockquote>\n\n<p>This is true for every <code>aggregation</code> system.</p>\n\n<hr>\n\n<p>One approach to handle this requirement effectively; is to keep mapping of keys for each provider JSON structure and targeted JSON structure.</p>\n\n<p><strong>For example:</strong> This is an approach, please go with your design as you see fit.</p>\n\n<p><strong>JSON structures from various provider:</strong></p>\n\n<pre><code>// Provider 1 : JSON structrure\n{\n  \"createdAt\": \"2017-05-17T08:52:36.024Z\",\n  \"data\": {\n    \"user\": {\n      \"name\": \"xxx\"\n    }\n  }\n}\n\n// Provider 2 : JSON structrure\n{\n  \"username\": \"yyy\"\n  \"since\": \"2017-05-17T08:52:36.024Z\",\n}\n</code></pre>\n\n<p><strong>Mapping for target JSON structure:</strong></p>\n\n<pre><code>jsonMappingByProvider := make(map[string]string)\n\n// Targeted Mapping for Provider 1\njsonMappingByProvider[\"provider1\"] = `\n{\n    \"date\": \"createdAt\",\n    \"clientName\": \"data.user.name\"\n}\n`\n\n// Targeted Mapping for Provider 2\njsonMappingByProvider[\"provider2\"] = `\n{\n    \"date\": \"since\",\n    \"clientName\": \"username\"\n}\n`\n</code></pre>\n\n<p>Now, based the on the provider you're handling, get the mapping and map the response JSON into targeted structure.</p>\n\n<pre><code>// get the mapping info by provider\nmapping := jsonMappingByProvider[\"provider1\"]\n\n// Parse the response JSON \n// Do the mapping\n</code></pre>\n\n<p>This way you can control each provider and it's mapping effectively.</p>\n"}], "owner": {"reputation": 125, "user_id": 5695670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd079a335a1ef8e7b26cab86b88a6a63?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/5695670/unknown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3176, "favorite_count": 0, "accepted_answer_id": 45067198, "answer_count": 1, "score": 1, "last_activity_date": 1500056016, "creation_date": 1499886278, "last_edit_date": 1592644375, "question_id": 45065678, "link": "https://stackoverflow.com/questions/45065678/how-i-can-mapping-complex-json-to-other-json", "title": "how I can mapping complex JSON to other JSON", "body": "<p>I am trying to build <em>aggregation services</em>, to all third party APIs that's I used,\nthis <em>aggregation services</em> taking json values coming from my main system and it will put this value to key equivalent to third party api key then, <em>aggregation services</em> it will send request to third party api with new json format.</p>\n<p>example-1:</p>\n<pre><code>package main\n\nimport (\n    &quot;encoding/json&quot;\n    &quot;fmt&quot;\n    &quot;log&quot;\n\n    &quot;github.com/tidwall/gjson&quot;\n)\n\nfunc main() {\n    // mapping JSON\n    mapB := []byte(`\n    {\n        &quot;date&quot;: &quot;createdAt&quot;,\n        &quot;clientName&quot;: &quot;data.user.name&quot;\n    }\n    `)\n\n    // from my main system\n    dataB := []byte(`\n    {\n        &quot;createdAt&quot;: &quot;2017-05-17T08:52:36.024Z&quot;,\n        &quot;data&quot;: {\n            &quot;user&quot;: {\n                &quot;name&quot;: &quot;xxx&quot;\n            }\n        }\n    }\n    `)\n\n    mapJSON := make(map[string]interface{})\n    dataJSON := make(map[string]interface{})\n    newJSON := make(map[string]interface{})\n\n    err := json.Unmarshal(mapB, &amp;mapJSON)\n    if err != nil {\n        log.Panic(err)\n    }\n\n    err = json.Unmarshal(dataB, &amp;dataJSON)\n    if err != nil {\n        log.Panic(err)\n    }\n\n    for i := range mapJSON {\n        r := gjson.GetBytes(dataB, mapJSON[i].(string))\n        newJSON[i] = r.Value()\n    }\n\n    newB, err := json.MarshalIndent(newJSON, &quot;&quot;, &quot;  &quot;)\n    if err != nil {\n        log.Println(err)\n    }\n\n    fmt.Println(string(newB))\n}\n</code></pre>\n<p>output:</p>\n<pre><code>{\n  &quot;clientName&quot;: &quot;xxx&quot;,\n  &quot;date&quot;: &quot;2017-05-17T08:52:36.024Z&quot;\n}\n</code></pre>\n<p>I use <a href=\"https://github.com/tidwall/gjson\" rel=\"nofollow noreferrer\">gjson</a> package to get values form my main system request in simple way from a json document.</p>\n<p>example-2:</p>\n<pre><code>import (\n    &quot;encoding/json&quot;\n    &quot;fmt&quot;\n    &quot;log&quot;\n\n    &quot;github.com/tidwall/gjson&quot;\n)\n\nfunc main() {\n    // mapping JSON\n    mapB := []byte(`\n    {\n        &quot;date&quot;: &quot;createdAt&quot;,\n        &quot;clientName&quot;: &quot;data.user.name&quot;,\n        &quot;server&quot;:{\n            &quot;google&quot;:{\n                &quot;date&quot; :&quot;createdAt&quot;\n            }\n        }\n    }\n    `)\n\n    // from my main system\n    dataB := []byte(`\n    {\n        &quot;createdAt&quot;: &quot;2017-05-17T08:52:36.024Z&quot;,\n        &quot;data&quot;: {\n            &quot;user&quot;: {\n                &quot;name&quot;: &quot;xxx&quot;\n            }\n        }\n    }\n    `)\n\n    mapJSON := make(map[string]interface{})\n    dataJSON := make(map[string]interface{})\n    newJSON := make(map[string]interface{})\n\n    err := json.Unmarshal(mapB, &amp;mapJSON)\n    if err != nil {\n        log.Panic(err)\n    }\n\n    err = json.Unmarshal(dataB, &amp;dataJSON)\n    if err != nil {\n        log.Panic(err)\n    }\n\n    for i := range mapJSON {\n        r := gjson.GetBytes(dataB, mapJSON[i].(string))\n        newJSON[i] = r.Value()\n    }\n\n    newB, err := json.MarshalIndent(newJSON, &quot;&quot;, &quot;  &quot;)\n    if err != nil {\n        log.Println(err)\n    }\n\n    fmt.Println(string(newB))\n}\n</code></pre>\n<p>output:</p>\n<pre><code>panic: interface conversion: interface {} is map[string]interface {}, not string\n</code></pre>\n<p><em>I can handle this error by using  <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Type_assertions</a>, but what if this json object have array and inside this array have json object ....</em></p>\n<p><strong>my problem is I have different apis, every api have own json schema, <em>and my way for mapping json only work if\nthird party api have json key value only, without nested json or array inside this array json object.</em></strong></p>\n<p>is there a way to mapping complex json schema, or golang package to help me to do that?</p>\n"}, {"tags": ["go", "schema", "terraform"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1499885914, "post_id": 45064827, "comment_id": 77104467, "body": "The <code>schema.Schema</code> type has no <code>Range</code> field, and I&#39;m not sure what <code>-4</code> should mean for a &quot;range&quot; on a string value. Are you possibly looking for <code>Schema.ValidateFunc </code>?"}], "answers": [{"tags": [], "owner": {"reputation": 13257, "user_id": 335717, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66fc33d259df37b17198d0d76e0ac169?s=128&d=identicon&r=PG", "display_name": "Radek Simko", "link": "https://stackoverflow.com/users/335717/radek-simko"}, "is_accepted": true, "score": 0, "last_activity_date": 1500152918, "creation_date": 1500152918, "answer_id": 45122748, "question_id": 45064827, "link": "https://stackoverflow.com/questions/45064827/how-to-set-range-to-terraform-schema-schema-field/45122748#45122748", "title": "How to set range to terraform schema.schema field?", "body": "<p>Generally speaking validation functions are meant to validate any configs (possibly combined with variables). These run as part of <code>terraform plan</code>, <code>terraform apply</code> and <code>terraform destroy</code>. The user can also trigger explicit validation via <code>terraform validate</code> which is commonly used in CI.</p>\n\n<p>Assuming that \"Range\" is meant to limit minimum &amp; maximum number of characters in a given string you can use <a href=\"https://github.com/hashicorp/terraform/blob/master/helper/validation/validation.go#L93\" rel=\"nofollow noreferrer\"><code>StringLenBetween</code> from the validation package</a>.</p>\n\n<pre><code>Schema: map[string]*schema.Schema{\n    \"number_of_servers\": {\n        Type:     schema.TypeString,\n        Required: true,\n        ValidateFunc: validation.StringLenBetween(1, 5),\n    },\n</code></pre>\n\n<p>You can see it being used in practice here:\n<a href=\"https://github.com/terraform-providers/terraform-provider-aws/blob/46bff11/aws/resource_aws_cloudwatch_event_target.go#L71-L75\" rel=\"nofollow noreferrer\">https://github.com/terraform-providers/terraform-provider-aws/blob/46bff11/aws/resource_aws_cloudwatch_event_target.go#L71-L75</a></p>\n"}], "owner": {"reputation": 27, "user_id": 4235004, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ccd7f91dc5782dcf8e8bc613ac7cc375?s=128&d=identicon&r=PG&f=1", "display_name": "Viraj Indasrao", "link": "https://stackoverflow.com/users/4235004/viraj-indasrao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 45122748, "answer_count": 1, "score": 0, "last_activity_date": 1500152918, "creation_date": 1499883073, "question_id": 45064827, "link": "https://stackoverflow.com/questions/45064827/how-to-set-range-to-terraform-schema-schema-field", "title": "How to set range to terraform schema.schema field?", "body": "<p>I have a number_of_servers field in schema.schema and I need to set a range to it. Is there any way to do it?</p>\n\n<pre><code>Schema: map[string]*schema.Schema{\n        \"number_of_servers\": {\n            Type:     schema.TypeString,\n            Required: true,\n            Range: 1-5,\n        },\n</code></pre>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1499874377, "post_id": 45062222, "comment_id": 77097886, "body": "A custom function is required to pass multiple parameters to a template.   See <a href=\"https://stackoverflow.com/questions/18276173/calling-a-template-with-several-pipeline-parameters\" title=\"calling a template with several pipeline parameters\">stackoverflow.com/questions/18276173/&hellip;</a>"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1499925526, "post_id": 45062222, "comment_id": 77117444, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18276173/calling-a-template-with-several-pipeline-parameters\">Calling a template with several pipeline parameters</a>"}], "owner": {"reputation": 37, "user_id": 4979790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c232032fc10fafda7039863d99150b33?s=128&d=identicon&r=PG&f=1", "display_name": "Aderon", "link": "https://stackoverflow.com/users/4979790/aderon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1499946545, "creation_date": 1499874114, "last_edit_date": 1499946545, "question_id": 45062222, "link": "https://stackoverflow.com/questions/45062222/go-template-calling-another-template-with-multiple-parameters", "title": "Go Template - calling another template with multiple parameters", "body": "<p>I'm using an application that is getting me some data, and then renders a config file based on a given Go Template. You basically pass a template you've made as a parameter, and app does it's job with it. The template is getting bigger and bigger, so I wanted to wrap some common stuff into sub-templates (I mean, {{ define x }}). The problem I'm occuring is that the sub-template should be passed serveral parameters, which are not a part of my 'dot', and I can't really find a way to do this in Go.</p>\n\n<p>The best answer I've found is to write some 'dict' function myself, and then use it inside the template, but that would mean I basically need to fork the whole application I'm using to render the template, do like 10-15 line changes, and then use this modified versions, which is a nonsense.</p>\n\n<p>I'm wondering if there's any real solution for my problem without having to do some crazy forking and writing custom methods on application side?</p>\n\n<p>Edit:\nI've already checked <a href=\"https://stackoverflow.com/questions/18276173/calling-a-template-with-several-pipeline-parameters\">Calling a template with several pipeline parameters</a> before, although it's not answering my question, since I need a way to do this using only template file.</p>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1499873567, "post_id": 45061819, "comment_id": 77097338, "body": "Do you have to define the <code>Status</code> twice, or can you just define it outside the <code>message</code>s?"}, {"owner": {"reputation": 16165, "user_id": 547820, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/29c81a4724590af17510dcd846eea411?s=128&d=identicon&r=PG", "display_name": "Sait", "link": "https://stackoverflow.com/users/547820/sait"}, "reply_to_user": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1499873729, "post_id": 45061819, "comment_id": 77097448, "body": "@Thomas, I do not have control to modify the defined protos."}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1499873908, "post_id": 45061819, "comment_id": 77097585, "body": "Have a look at the generated code. There&#39;s probably a way to turn enums into ints and back again. Otherwise, you can always serialize the field using one type, then deserialize using the other: the wire format will be the same for both."}], "owner": {"reputation": 16165, "user_id": 547820, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/29c81a4724590af17510dcd846eea411?s=128&d=identicon&r=PG", "display_name": "Sait", "link": "https://stackoverflow.com/users/547820/sait"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 299, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499873004, "creation_date": 1499873004, "question_id": 45061819, "link": "https://stackoverflow.com/questions/45061819/converting-protobufs-enums-in-go", "title": "Converting protobufs enums in go", "body": "<p>I have two protocol buffers, X and Y as defined below:</p>\n\n<pre><code>message X {\n   string value1 = 1;\n\n   enum Status {\n      STATUS_UNSPECIFIED = 0;\n      ACTIVE = 1;\n      DELETED = 2;\n   }\n   Status status = 2;\n}\n</code></pre>\n\n<hr>\n\n<pre><code>message Y {\n   string value2 = 1;\n\n   enum Status {\n      STATUS_UNSPECIFIED = 0;\n      ACTIVE = 1;\n      DELETED = 2;\n   }\n   Status status = 2;\n}\n</code></pre>\n\n<p>I have an instance of <code>X</code>, say <code>x</code>. How can I assign <code>x.status</code> to a new <code>y.status</code> of type <code>Y</code> easily in Go?</p>\n"}, {"tags": ["go", "channel"], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1499872859, "post_id": 45061738, "comment_id": 77096811, "body": "This would be resolvable using a mutex to synchronize access to both channels, but that would largely defeat the purpose of channels."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1499876780, "last_edit_date": 1499876780, "creation_date": 1499872797, "answer_id": 45061738, "question_id": 45061595, "link": "https://stackoverflow.com/questions/45061595/how-to-wait-on-2-channels-and-continue-when-they-are-both-ready-for-read/45061738#45061738", "title": "how to wait on 2 channels and continue when they are both ready for read", "body": "<p>Receiving from 2 channels is not atomic. You can check the number of elements queued in a channel's buffer using the builtin <a href=\"https://golang.org/pkg/builtin/#len\" rel=\"nofollow noreferrer\"><code>len()</code></a> function, but you can't do a 2-channel atomic receive.</p>\n\n<p>Meaning by the time you receive a value from one channel, the other channel might not be ready to receive from (e.g. another goroutine might already have received from it).</p>\n\n<p>If there is only one goroutine that consumes and processes these values, simply receive a value from both channels, it will block if a value is not ready (if channel is not ready to receive from):</p>\n\n<pre><code>v1 := &lt;- ch1\nv2 := &lt;- ch2\n\n// process v1 and v2\n</code></pre>\n\n<p>Also note that receiving also succeeds if the channel is closed.</p>\n"}, {"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1499876553, "creation_date": 1499876553, "answer_id": 45063028, "question_id": 45061595, "link": "https://stackoverflow.com/questions/45061595/how-to-wait-on-2-channels-and-continue-when-they-are-both-ready-for-read/45063028#45063028", "title": "how to wait on 2 channels and continue when they are both ready for read", "body": "<p>How about something like this:</p>\n\n<pre><code>type Foo1 struct {}\ntype Foo2 struct {}\n\ntype Combination struct {\n    foo1 *Foo1\n    foo2 *Foo2\n}\n\nfunc mergeChan(chIn chan *Foo1, chIn2 chan *Foo2, chOut chan *Combination) {\n    for foo1 := range chIn {\n        chOut &lt;- &amp;Combination{\n            foo1: foo1,\n            foo2: &lt;-chIn2,\n        }\n    }\n}\n</code></pre>\n\n<p>Listening to chOut you would always receive combinations from both channels.</p>\n"}], "owner": {"reputation": 395, "user_id": 7197834, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2860b131f48ded5f6f8075f398b2ab82?s=128&d=identicon&r=PG&f=1", "display_name": "Myrfy", "link": "https://stackoverflow.com/users/7197834/myrfy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 45061738, "answer_count": 2, "score": 2, "last_activity_date": 1499876780, "creation_date": 1499872411, "question_id": 45061595, "link": "https://stackoverflow.com/questions/45061595/how-to-wait-on-2-channels-and-continue-when-they-are-both-ready-for-read", "title": "how to wait on 2 channels and continue when they are both ready for read", "body": "<p>Suppose I have 2 buffered channels, How can I wait for both of them, and only continue when both of the channel have at least one item in it?</p>\n\n<p>It looks like assemble a machine with two parts, only when both part are at hand can I continue my work.</p>\n\n<pre><code>Both queue are empty, wait.\n-------------------\n|     |     |     |   QUEUE A\n-------------------\n\n-------------------\n|     |     |     |   QUEUE B\n-------------------\n\n\nQueue A has one element but Queue B empty, wait\n-------------------\n|     |     |  X  |   QUEUE A\n-------------------\n\n-------------------\n|     |     |     |   QUEUE B\n-------------------\n\n\nQueue A has two elements but Queue B empty, still wait\n-------------------\n|     |  Y  |  X  |   QUEUE A\n-------------------\n\n-------------------\n|     |     |     |   QUEUE B\n-------------------\n\n\nBoth queue has item in it, consume one from each queue.\n-------------------\n|     |  Y  |  X  |   QUEUE A\n-------------------\n\n-------------------\n|     |     |  Z  |   QUEUE B\n-------------------\n\n\nNow, Queue B empty again, wait ...\n-------------------\n|     |     |  Y  |   QUEUE A\n-------------------\n\n-------------------\n|     |     |     |   QUEUE B\n-------------------\n</code></pre>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1499873688, "post_id": 45061568, "comment_id": 77097412, "body": "Using a loop implies that there may be arbitrarily many layers, but there are only three: the interface type of the variable, the pointer to the value, and the value itself."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1499873723, "post_id": 45061568, "comment_id": 77097443, "body": "@Adrian: In production,there may be an arbitrary number of layers. But here, clearly there aren&#39;t. I&#39;ve removed the loop."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1499873840, "post_id": 45061568, "comment_id": 77097524, "body": "How would you end up with an arbitrary number of layers?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1499874079, "post_id": 45061568, "comment_id": 77097711, "body": "@Adrian: <code>SomeUnmarshalWrapper(&amp;result)</code> followed by <code>func SomeUnmarshalWrapper(i interface{}) { json.Unmarshal(&amp;i) ...</code> or similar."}], "answers": [{"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 1, "last_activity_date": 1499875723, "last_edit_date": 1499875723, "creation_date": 1499874363, "answer_id": 45062310, "question_id": 45061568, "link": "https://stackoverflow.com/questions/45061568/how-to-initialize-struct-pointer-via-reflection/45062310#45062310", "title": "How to initialize struct pointer via reflection", "body": "<p>In your example <code>rv.CanAddr()</code> is <code>false</code> and consequently you cannot set it (<code>rv.CanSet()</code> is <code>false</code>).</p>\n\n<p>Problem: if you have a pointer to nil it is not addressable. A pointer to a pointer to nil (or a pointer to an interface) however is addressable.</p>\n\n<p>You can get your example to work in different ways:</p>\n\n<ul>\n<li>initialize x to be non-nil (probably not the point here)</li>\n<li><p>set y to a new Value with <code>reflect.New(..)</code></p>\n\n<pre><code>func main() {\n    var x *Foo\n    var y interface{} = x\n    fmt.Printf(\"Before: %#v\\n\", y)\n    fmt.Printf(\"Goal: %#v\\n\", interface{}(&amp;Foo{}))\n\n    rv := reflect.ValueOf(y)\n    y = reflect.New(rv.Type().Elem()).Interface()\n\n    fmt.Printf(\"After: %#v\\n\", y)\n}\n</code></pre></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1499874501, "creation_date": 1499874501, "answer_id": 45062365, "question_id": 45061568, "link": "https://stackoverflow.com/questions/45061568/how-to-initialize-struct-pointer-via-reflection/45062365#45062365", "title": "How to initialize struct pointer via reflection", "body": "<p>Without knowing your actual use case, it's hard to say what solution you require, however <a href=\"https://play.golang.org/p/Fere9XyDck\" rel=\"nofollow noreferrer\">this works</a> for your example:</p>\n\n<pre><code>var x *Foo\nvar y interface{} = x\nrv := reflect.ValueOf(y)\ny = reflect.New(rv.Type().Elem()).Interface()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1499875764, "post_id": 45062472, "comment_id": 77098840, "body": "I second this answer. Learned something new :)"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1499877194, "last_edit_date": 1499877194, "creation_date": 1499874775, "answer_id": 45062472, "question_id": 45061568, "link": "https://stackoverflow.com/questions/45061568/how-to-initialize-struct-pointer-via-reflection/45062472#45062472", "title": "How to initialize struct pointer via reflection", "body": "<p>Try this:</p>\n\n<pre><code>var x *Foo\nvar y interface{} = x\nfmt.Printf(\"Before: %#v\\n\", y)\nfmt.Printf(\"Goal: %#v\\n\", interface{}(&amp;Foo{}))\n\n// Must take address of y to set it. Dereference with Elem() to get value for y\nrv := reflect.ValueOf(&amp;y).Elem()\n\n// Interface element type is *main.Foo, dereference with Elem() to get main.Foo\nt := rv.Elem().Type().Elem()\nrv.Set(reflect.New(t))\nfmt.Printf(\"After: %#v\\n\", y)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/n39yPzJVpe\" rel=\"nofollow noreferrer\">playground example</a></p>\n\n<p>You can also assign <code>y</code> instead of setting it via reflection:</p>\n\n<pre><code>var x *Foo\nvar y interface{} = x\nfmt.Printf(\"Before: %#v\\n\", y)\nfmt.Printf(\"Goal: %#v\\n\", interface{}(&amp;Foo{}))\nrv := reflect.ValueOf(y)\nt := rv.Type().Elem()\ny = reflect.New(t).Interface()\nfmt.Printf(\"After: %#v\\n\", y)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/qDlmg32z4c\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1009, "favorite_count": 1, "accepted_answer_id": 45062472, "answer_count": 3, "score": 0, "last_activity_date": 1499877194, "creation_date": 1499872334, "last_edit_date": 1499874323, "question_id": 45061568, "link": "https://stackoverflow.com/questions/45061568/how-to-initialize-struct-pointer-via-reflection", "title": "How to initialize struct pointer via reflection", "body": "<p>My goal is to take a <code>nil</code> pointer to a struct (but could be any type), passed as an <code>interface{}</code>, and initialize a struct in its place.</p>\n\n<p>My test code (<a href=\"https://play.golang.org/p/VIqQyc5s8I\" rel=\"nofollow noreferrer\">playground link</a>) is:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Foo struct {\n    Foo string\n}\n\nfunc main() {\n    var x *Foo\n    var y interface{} = x\n    fmt.Printf(\"Before: %#v\\n\", y)\n    fmt.Printf(\"Goal: %#v\\n\", interface{}(&amp;Foo{}))\n\n    rv := reflect.ValueOf(y)\n    rv.Set(reflect.New(rv.Type().Elem()))\n\n    fmt.Printf(\"After: %#v\\n\", y)\n}\n</code></pre>\n\n<p>I hope the code is self-documenting.  But the goal is essentially to convert <code>y</code> which begins as an uninitialized pointer to <code>Foo</code>, (<code>(*main.Foo)(nil)</code>) into a pointer to an initialized (zero-value) instance of<code>Foo</code>: <code>&amp;main.Foo{Foo:\"\"}</code>.  But I'm getting <code>reflect.Value.Set using unaddressable value</code>.  I don't understand why the value I'm attempting to set is unaddressable.  I've spent the day reading through the source code to the standard library JSON unmarshaler, and other SO posts, but am still clearly overlooking something.</p>\n\n<p>If I peel away the outer <code>interface{}</code>:</p>\n\n<pre><code>rv := reflect.ValueOf(y).Elem() // Remove the outer interface{}\nrv.Set(reflect.New(rv.Type().Elem()))\n</code></pre>\n\n<p>the error becomes <code>reflect: call of reflect.Value.Type on zero Value</code>.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "edited": false, "score": 0, "creation_date": 1499871965, "post_id": 45061125, "comment_id": 77096078, "body": "ok, then what can i use to print just the error without a call to os.Exit(1) ?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "edited": false, "score": 0, "creation_date": 1499872098, "post_id": 45061125, "comment_id": 77096191, "body": "As the documentation says, <code>Fatal</code> calls <code>Print</code> followed by <code>os.Exit(1)</code>. So, if you want it without the exit... call <code>log.Print()</code>. Or try <a href=\"https://golang.org/pkg/log/\" rel=\"nofollow noreferrer\">reading the documentation of the log package</a>."}, {"owner": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "edited": false, "score": 0, "creation_date": 1499872264, "post_id": 45061125, "comment_id": 77096322, "body": "ok, tried removing <code>log.Fatal</code> but still the program stops automatically ."}, {"owner": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "edited": false, "score": 0, "creation_date": 1499872409, "post_id": 45061125, "comment_id": 77096446, "body": "one more thing, as you must have noticed in my code i mentioned <code>&#47;&#47; Using err := gives error no new variables on left side of := during compilation</code> does using just <code>=</code> rather than <code>:=</code> cause a problem to the program anywhere?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "edited": false, "score": 0, "creation_date": 1499872440, "post_id": 45061125, "comment_id": 77096473, "body": "Yes. The error is correct. Did you have a question about it?"}, {"owner": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "edited": false, "score": 0, "creation_date": 1499872485, "post_id": 45061125, "comment_id": 77096512, "body": "does using just <code>=</code> rather than <code>:=</code> cause a problem to the program anywhere?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "edited": false, "score": 0, "creation_date": 1499872598, "post_id": 45061125, "comment_id": 77096605, "body": "I don&#39;t know, does it? <code>=</code> assigns a value to an existing variable, <code>=:</code> assigns a value to a new variable. Consider reading the <a href=\"https://golang.org/doc/\" rel=\"nofollow noreferrer\">Go documentation</a> to get a handle on the basic Go syntax."}, {"owner": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "edited": false, "score": 0, "creation_date": 1499873329, "post_id": 45061125, "comment_id": 77097161, "body": "i don&#39;t think it should cause a problem, so i thought to ask to be on safe side  .."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 3, "last_activity_date": 1499871215, "creation_date": 1499871215, "answer_id": 45061125, "question_id": 45061019, "link": "https://stackoverflow.com/questions/45061019/while-parsing-json-avoid-go-program-from-being-stopped-in-case-of-any-errors/45061125#45061125", "title": "While parsing JSON avoid Go program from being stopped in case of any errors", "body": "<p>Don't use <a href=\"https://golang.org/pkg/log/#Fatal\" rel=\"nofollow noreferrer\"><code>log.Fatal</code></a> - by using that function you're explicitly telling it to crash when it encounters an error:</p>\n\n<blockquote>\n  <p>Fatal is equivalent to Print() followed by a call to os.Exit(1).</p>\n</blockquote>\n\n<p>\"Fatal\" means what it says, it kills the process.</p>\n"}], "owner": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 45061125, "answer_count": 1, "score": 0, "last_activity_date": 1499871215, "creation_date": 1499870944, "question_id": 45061019, "link": "https://stackoverflow.com/questions/45061019/while-parsing-json-avoid-go-program-from-being-stopped-in-case-of-any-errors", "title": "While parsing JSON avoid Go program from being stopped in case of any errors", "body": "<p>How could I Ignore errors while parsing below JSON</p>\n\n<p>Here is the sample JSON response</p>\n\n<pre><code>{\"success\":true,\"endpoint\":\"https://api.abcxyz.com\",\"info\":\n{\"Guestconnected\":134,\"Guestratio\":100000.06963,\"symbol1\":\n{\"code\":\"NY\",\"symbol\":\"*\",\"name\":\"newyear\",\"codev\":391.78161,\"symbolAppearsAfter\n\":false,\"local\":true},\"symbol2\":\n{\"code\":\"HNY\",\"symbol\":\"@\",\"name\":\"HappyNewYear\",\"codev\":1000000.0960,\"symbolApp\nearsAfter\":true,\"local\":false},\"latest\":\n{\"value\":1597509,\"autovalue\":\"00099cf8da58a36c08f2ef98650ff6043ddfb\",\"height\":47\n4696,\"time\":1499527696}},\"Allguest\":\n{\"all\":4,\"filtered\":4,\"total_invitations\":15430,\"sent_invitations\":15430,\"final_\ninvitations\":0},\"Guestlist\":\n[{\"GuestCode\":\"369AR\",\"all\":2,\"total_invitations\":5430,\"sent_invitations\":5430,\"\nfinal_invitations\":0,\"change\":0,\"accounts\":0},\n{\"GuestCode\":\"6POIA96TY\",\"all\":2,\"total_invitations\":10000,\"sent_invitations\":10\n000,\"final_invitations\":0,\"change\":0,\"accounts\":0}]}\n</code></pre>\n\n<p>My Code is :</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n)\n\n\ntype object struct {\n    Success bool `json:\"success\"`\n    Endpoint string `json:\"endpoint\"`\n    Allguest struct {\n        All int `json:\"all\"`\n        Filtered int `json:\"filtered\"`\n        TotalInvitations int `json:\"total_invitations\"`\n        SentInvitations int `json:\"sent_invitations\"`\n        FinalInvitations int `json:\"final_invitations\"`\n    } `json:\"Allguest\"`\n    Guestlist []struct {\n        GuestCode string `json:\"GuestCode\"`\n        All int `json:\"all\"`\n        TotalInvitations int `json:\"total_invitations\"`\n        SentInvitations int `json:\"sent_invitations\"`\n        FinalInvitations int `json:\"final_invitations\"`\n        Change int `json:\"change\"`\n        Accounts int `json:\"accounts\"`\n    } `json:\"Guestlist\"`\n}\n\nfunc Newreq(w http.ResponseWriter, r *http.Request) {\n\nuri := \"https://siteurl.com/api?lists=1\"\nres, err := http.Get(uri)\nfmt.Println(uri)\nif err != nil {\nfmt.Println(\"Error:\", err)\n    log.Fatal(err)\n}\ndefer res.Body.Close()\n\nvar s object\n// Using err := gives error no new variables on left side of := during compilation ?\nerr = json.NewDecoder(res.Body).Decode(&amp;s) \nif err != nil {\n    log.Fatal(err)\n    fmt.Println(\"Error:\", err)\n}\nfmt.Println(s.Success)\nfmt.Println(s.Allguest.TotalInvitations)\nfor i := range s.Guestlist {\nfmt.Println(s.Guestlist[i].TotalInvitations)\n}\n}\n\nfunc main() {\n\nhttp.HandleFunc(\"/\", Newreq)\n\nlog.Println(\"Listening\")\nlog.Fatal(http.ListenAndServe(\":8080\", nil))\n\n}\n</code></pre>\n\n<p>The Program has been compiled and is running successfully if there is no errors in the JSON response supplied by the server .</p>\n\n<p>I am testing this locally at localhost:8080</p>\n\n<p>The problem is how can we ignore any error and avoid the program from stopping automatically, for example :</p>\n\n<ol>\n<li><p>There are instances when the server at <code>https://siteurl.com/api?lists=1</code> can be down then in that case it will give error \"No such host\" and the program exits, how can we ignore the error and keep the program running?</p></li>\n<li><p>There are instances when the server at <code>https://siteurl.com/api?lists=1</code> gives a HTML 404 NOT found error instead of a JSON response, in that case it gives error \"invalid character '&lt;' looking for beginning of value\" and the program exits, how can we ignore the error and keep the program running?</p></li>\n</ol>\n"}, {"tags": ["angularjs", "go", "swagger", "go-swagger"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1499868316, "post_id": 45059647, "comment_id": 77093200, "body": "Why not just move your entire project as-is into your GOPATH? You shouldn&#39;t have to break things up."}, {"owner": {"reputation": 572, "user_id": 2461476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a46kg.gif?s=128&g=1", "display_name": "iamtheddrman", "link": "https://stackoverflow.com/users/2461476/iamtheddrman"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1499869306, "post_id": 45059647, "comment_id": 77093987, "body": "When I first tried it, I got an error about not using local imports in GOPATH, so I removed the &quot;./&quot; and got a different error. Perhaps it would work if I used the complete path starting from the GOPATH root, but then it would require that everyone use the exact same folder name for their UI checkouts. That would also mean a single UI checkout at a time, when we sometimes have to work in multiple branches."}, {"owner": {"reputation": 572, "user_id": 2461476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a46kg.gif?s=128&g=1", "display_name": "iamtheddrman", "link": "https://stackoverflow.com/users/2461476/iamtheddrman"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1499870274, "post_id": 45059647, "comment_id": 77094743, "body": "I tried checking out just a subfolder from git (where the folder name would rarely, if ever, change) and that seems to work for both our existing build and running ffjson and go-swagger. So that&#39;s a potential solution, but I would prefer a solution that doesn&#39;t require me to enforce the checkout of a subfolder of a repo into GOPATH, and the associated import changes. This is a local project that will never be hosted, so there is no requirement to be in GOPATH except for the tools we&#39;re using."}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 3, "creation_date": 1499870768, "post_id": 45059647, "comment_id": 77095138, "body": "In Go development everything assumes your project is in GOPATH. If you find a solution this time, you might end up with another problem tomorrow."}, {"owner": {"reputation": 239, "user_id": 4015178, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100003976369429/picture?type=large", "display_name": "Raimondas Kazlauskas", "link": "https://stackoverflow.com/users/4015178/raimondas-kazlauskas"}, "reply_to_user": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 1, "creation_date": 1499871432, "post_id": 45059647, "comment_id": 77095664, "body": "I totally agree with @TehSphinX you should move your project within GOPATH . If you have issues with dependecies, I suggest you to use dependency managment tool like <code>golang&#47;dep</code> <a href=\"https://github.com/golang/dep\" rel=\"nofollow noreferrer\">github.com/golang/dep</a>"}, {"owner": {"reputation": 12311, "user_id": 2095090, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3vmqn.jpg?s=128&g=1", "display_name": "Vincent van der Weele", "link": "https://stackoverflow.com/users/2095090/vincent-van-der-weele"}, "edited": false, "score": 0, "creation_date": 1499871586, "post_id": 45059647, "comment_id": 77095790, "body": "You could have the restful service built in Go (and have that code in your Go path) and maybe just bundle the Angular app elsewhere and serve it with for instance nginx. That way you could have a folder <code>X</code> for your project with <code>X&#47;frontend</code> the actual frontend code and <code>X&#47;backend</code> a symlink to your backend in the GOPATH. That way your code stays organised and you&#39;re not fighting against the Go conventions."}, {"owner": {"reputation": 572, "user_id": 2461476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a46kg.gif?s=128&g=1", "display_name": "iamtheddrman", "link": "https://stackoverflow.com/users/2461476/iamtheddrman"}, "edited": false, "score": 0, "creation_date": 1499871915, "post_id": 45059647, "comment_id": 77096040, "body": "So when developing a web server using Go (which seems to be a common use case), do developers typically just have all of their HTML/CSS/JS code also in GOPATH? That seems really odd, but I suppose that&#39;s better than Vincent&#39;s alternative of symlinks and tons of build infrastructure that&#39;s bound to be fragile. How do people cope with builds for different branches of Go code on something like Jenkins? We normally have workspaces for that, so perhaps we could set GOPATH to point to our workspace?"}, {"owner": {"reputation": 5734, "user_id": 415628, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84d8280499418f22f42778cc40c20a12?s=128&d=identicon&r=PG", "display_name": "Ezequiel Muns", "link": "https://stackoverflow.com/users/415628/ezequiel-muns"}, "edited": false, "score": 0, "creation_date": 1610122098, "post_id": 45059647, "comment_id": 116040828, "body": "As of Go 1.11 you can use modules and escape the GOPATH \ud83c\udf7e"}], "owner": {"reputation": 572, "user_id": 2461476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a46kg.gif?s=128&g=1", "display_name": "iamtheddrman", "link": "https://stackoverflow.com/users/2461476/iamtheddrman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 441, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499869520, "creation_date": 1499867562, "last_edit_date": 1499869520, "question_id": 45059647, "link": "https://stackoverflow.com/questions/45059647/golang-and-angularjs-project-structure-with-go-swagger", "title": "Golang and AngularJS project structure with go-swagger", "body": "<p>I'm relatively new to Golang, having used Node.JS with AngularJS on a previous project, and am having trouble with Golang being very opinionated about project structure. Our Go code exists in a repository that also contains our HTML, CSS, and JS code, so that our \"web UI\" is a single checkout. The Go server serves up static pages to let AngularJS do the heavy lifting client-side, and provides a fairly complex RESTful API for interacting with a piece of embedded hardware. We use local includes in the Go server code to workaround the fact that the code isn't actually in GOPATH. The folder structure is roughly (subfolders not shown):</p>\n\n<p><code>/           &lt;-- repo root, checked out wherever you want (not in GOPATH)\n  fonts/\n  scripts/   &lt;-- all the AngularJS code\n  server/    &lt;-- all the Go code\n  styles/\n  views/     &lt;-- all the HTML code</code></p>\n\n<p>I'm now working with the go-swagger library to generate a Swagger spec from comments in our Go server code, since the Swagger UI provides a convenient UI for interacting with our server API. However, I've found that a significant portion of the go-swagger parser can't be used if your code is not within GOPATH. I can get go-swagger to work if I copy the server folder into the GOPATH src directory and run it there, but I obviously don't want to do that every time I update the API or add new routes.</p>\n\n<p>I imagine that I will have to make some changes either to our folder structure or our build process, but I'd like to understand the most logical way forward. Ideally, we would add a new task to our Gruntfile to generate the swagger spec by calling into go-swagger, and that spec would be copied into the default location for Swagger UI so that we can serve up the correct API spec with each build. I understand how the task should operate, but it doesn't work with our current project structure. So:</p>\n\n<ul>\n<li>Should we break the Go server code into its own repo that we check out in GOPATH? We have other tools (like ffjson) that are also unhappy with our Go code existing outside of GOPATH, so perhaps this is worth the effort to update our build process to handle.</li>\n<li>Is there a way to modify GOPATH (or add to it like PATH) such that go-swagger (and ffjson) can work in our existing repo structure? This seems like the easiest path, if it's possible. I've tried checking out our \"UI\" repo in GOPATH, but that didn't work initially (perhaps it would work if I updated our imports to use the arbitrary paths from the repo root to the server folders).</li>\n<li>Something else entirely? As I said, I'm pretty new to Go, and this project already existed for a few years when I came on board, so I'm not familiar with the ins and outs of Go just yet.</li>\n</ul>\n"}, {"tags": ["javascript", "regex", "go"], "comments": [{"owner": {"reputation": 1191, "user_id": 2627137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rb5FY.jpg?s=128&g=1", "display_name": "kkaosninja", "link": "https://stackoverflow.com/users/2627137/kkaosninja"}, "edited": false, "score": 0, "creation_date": 1499866874, "post_id": 45059243, "comment_id": 77092083, "body": "You could try using <code>regexp.FindAllString</code>. Link =&gt; <a href=\"https://golang.org/pkg/regexp/#Regexp.FindAllString\" rel=\"nofollow noreferrer\">golang.org/pkg/regexp/#Regexp.FindAllString</a>. This way, you could find the indexes where the regexp match occurs, and based on that split your string. Won&#39;t be straightforward like strings.Split() though :-)"}], "answers": [{"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 4, "last_activity_date": 1499867099, "last_edit_date": 1499867099, "creation_date": 1499866765, "answer_id": 45059339, "question_id": 45059243, "link": "https://stackoverflow.com/questions/45059243/regex-before-text-matching-in-golang/45059339#45059339", "title": "Regex &quot;before text matching&quot; in GoLang", "body": "<p>You may \"reverse\" the regex to <em>match</em> the strings you need. You want to match any 1+ chars other than <code>;</code> followed with <code>;</code> that are not followed with <code>I</code> or <code>D</code>.</p>\n\n<p>Use</p>\n\n<pre><code>[^;]+(?:;[^ID;][^;]*)*\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/w7zf2w/1\" rel=\"nofollow noreferrer\">regex demo</a></p>\n\n<p><strong>Details</strong>:</p>\n\n<ul>\n<li><code>[^;]+</code> - 1 or more chars other than <code>;</code></li>\n<li><code>(?:;[^ID;][^;]*)*</code> - zero or more sequences of:\n\n<ul>\n<li><code>;</code> - a <code>;</code></li>\n<li><code>[^ID;]</code> - a char other than <code>I</code>, <code>D</code> or <code>;</code> (that is in order not to match empty values)</li>\n<li><code>[^;]*</code> - zero or more chars other than <code>;</code></li>\n</ul></li>\n</ul>\n\n<p>See a <a href=\"https://play.golang.org/p/ccd52O_rus\" rel=\"nofollow noreferrer\">Go demo</a>.</p>\n\n<pre><code>package main\n\nimport (\n    \"regexp\"\n    \"fmt\"\n)\n\nfunc main() {\n    var re = regexp.MustCompile(`[^;]+(?:;[^ID;][^;]*)*`)\n    var str = `I.E.viewability:-2;D.ua:Mozilla/5.0 (Linux; Android 7.0; SM-G920W8 Build/NRD90M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.125 Mobile Safari/537.36;D.G.city:Burnaby;D.G.zip:V5C;D.G.region:BC;D.G.E.country_code2:CA;`\n\n    for _, match := range re.FindAllString(str, -1) {\n        fmt.Println(match)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>I.E.viewability:-2\nD.ua:Mozilla/5.0 (Linux; Android 7.0; SM-G920W8 Build/NRD90M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.125 Mobile Safari/537.36\nD.G.city:Burnaby\nD.G.zip:V5C\nD.G.region:BC\nD.G.E.country_code2:CA\n</code></pre>\n"}], "owner": {"reputation": 942, "user_id": 1906344, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/86ee6387bc0f52bb4c7b1f7ec944aaec?s=128&d=identicon&r=PG", "display_name": "Tomasz Rakowski", "link": "https://stackoverflow.com/users/1906344/tomasz-rakowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 695, "favorite_count": 2, "accepted_answer_id": 45059339, "answer_count": 1, "score": 3, "last_activity_date": 1592394995, "creation_date": 1499866509, "last_edit_date": 1592394995, "question_id": 45059243, "link": "https://stackoverflow.com/questions/45059243/regex-before-text-matching-in-golang", "title": "Regex &quot;before text matching&quot; in GoLang", "body": "<p>I have a piece of JavaScript code that I'm trying to replace with GoLang. The logic requires me to split the following string on \";\" only when followed by \"I\" or \"D\":</p>\n\n<pre><code>I.E.viewability:-2;D.ua:Mozilla/5.0 (Linux; Android 7.0; SM-G920W8 Build/NRD90M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.125 Mobile Safari/537.36;D.G.city:Burnaby;D.G.zip:V5C;D.G.region:BC;D.G.E.country_code2:CA;\n</code></pre>\n\n<p>In JavaScript I accomplish this using:</p>\n\n<pre><code>/;(?=[ID]|$)/\n</code></pre>\n\n<p>My understanding is that GoLang uses this regex lib</p>\n\n<p><a href=\"https://github.com/google/re2/wiki/Syntax\" rel=\"nofollow noreferrer\">https://github.com/google/re2/wiki/Syntax</a></p>\n\n<p>which clearly shows the above syntax (called <code>before text matching re</code>) as not supported.</p>\n\n<p>What would be the correct way of achieving the same result in GoLang?</p>\n"}, {"tags": ["go", "websocket", "server", "backend"], "comments": [{"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1499860696, "post_id": 45056395, "comment_id": 77087172, "body": "seems to me like the websocket is closed (or lost) when the error occurs. where do you open it?"}, {"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 2, "creation_date": 1499862043, "post_id": 45056395, "comment_id": 77088269, "body": "Minimal, Complete, and Verifiable example     <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>   If you want us to help you"}], "owner": {"reputation": 677, "user_id": 2827098, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/510107273/picture?type=large", "display_name": "Ayman Elmubark", "link": "https://stackoverflow.com/users/2827098/ayman-elmubark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499906455, "creation_date": 1499858823, "last_edit_date": 1499906455, "question_id": 45056395, "link": "https://stackoverflow.com/questions/45056395/having-trouble-with-web-sockets-in-golang", "title": "Having trouble with web sockets in golang", "body": "<p>The following function works as follows. The send channel receives a new msg of type Message (a struct defined else where) write to the websocket. It seems that client.socket.WriteJSON(msg) returns an error. It print \"websocket: close sent\" . I attempted to debug things and I realized a few things. msg is generated properly, the error will occur if I try to use writeJSON on an object, and the error only occurs if the writeJSON occurs after the  msg := range client.send . Sorry if this was confusing. I'm happy to clarify.</p>\n\n<pre><code>  func (client *Client) Write(){\n        for msg := range client.send {\n            if err := client.socket.WriteJSON(msg); err != nil {\n                fmt.Println(err)\n                break\n            }\n        }\n        client.socket.Close();\n    }\n</code></pre>\n"}, {"tags": ["object", "go", "interface"], "comments": [{"owner": {"reputation": 12311, "user_id": 2095090, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3vmqn.jpg?s=128&g=1", "display_name": "Vincent van der Weele", "link": "https://stackoverflow.com/users/2095090/vincent-van-der-weele"}, "edited": false, "score": 1, "creation_date": 1499863549, "post_id": 45055953, "comment_id": 77089418, "body": "What are you trying to achieve? How would you do the same in Java? What use is an interface that can return different stuff depending on its implementation? That doesn&#39;t sound like the right job for an interface to me (neither in Go nor in Java)."}, {"owner": {"reputation": 7779, "user_id": 6858274, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/323d5de87d97a689b73a663375e079eb?s=128&d=identicon&r=PG&f=1", "display_name": "felix", "link": "https://stackoverflow.com/users/6858274/felix"}, "reply_to_user": {"reputation": 12311, "user_id": 2095090, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3vmqn.jpg?s=128&g=1", "display_name": "Vincent van der Weele", "link": "https://stackoverflow.com/users/2095090/vincent-van-der-weele"}, "edited": false, "score": 0, "creation_date": 1499872023, "post_id": 45055953, "comment_id": 77096134, "body": "@VincentvanderWeele I have submitted my code on stackreview here : <a href=\"https://codereview.stackexchange.com/questions/168955/generate-thousands-of-json-documents-in-go\" title=\"generate thousands of json documents in go\">codereview.stackexchange.com/questions/168955/&hellip;</a>. The question explains the goal of the project and why I need interface to solve my problem!"}, {"owner": {"reputation": 12311, "user_id": 2095090, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3vmqn.jpg?s=128&g=1", "display_name": "Vincent van der Weele", "link": "https://stackoverflow.com/users/2095090/vincent-van-der-weele"}, "edited": false, "score": 0, "creation_date": 1499872272, "post_id": 45055953, "comment_id": 77096331, "body": "Ah, everything is dynamic, that explains! Go&#39;s main strength is in staticly typed problems, so I would say this problem is not the best match for the language. Of course it&#39;s possible and just as in Java <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">reflection</a> is most likely the solution."}], "answers": [{"tags": [], "owner": {"reputation": 13739, "user_id": 38333, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2ea7c27233a9019a1f91a821726a4d4?s=128&d=identicon&r=PG", "display_name": "cd1", "link": "https://stackoverflow.com/users/38333/cd1"}, "is_accepted": false, "score": 0, "last_activity_date": 1499861503, "creation_date": 1499861503, "answer_id": 45057375, "question_id": 45055953, "link": "https://stackoverflow.com/questions/45055953/interface-method-with-multiple-return-types/45057375#45057375", "title": "Interface method with multiple return types", "body": "<p>You can't achieve this the way you want to. You can, however, declare the function as</p>\n\n<pre><code>type Generatorer interface {\n    getValue() interface{}\n}\n</code></pre>\n\n<p>if you want it to return different types in different implementations.</p>\n"}, {"comments": [{"owner": {"reputation": 1634, "user_id": 1734785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda4a051ab231487e0517599ff9bc07f?s=128&d=identicon&r=PG", "display_name": "Christophe Vidal", "link": "https://stackoverflow.com/users/1734785/christophe-vidal"}, "edited": false, "score": 0, "creation_date": 1583601468, "post_id": 45057403, "comment_id": 107175408, "body": "I am in a similar situation, albeit slightly different. In my case getValue would return a (different) struct, but these two different structs return at the end the very same struct. So it&#39;s pretty deterministic but it seems I can&#39;t do that easily either."}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 1634, "user_id": 1734785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda4a051ab231487e0517599ff9bc07f?s=128&d=identicon&r=PG", "display_name": "Christophe Vidal", "link": "https://stackoverflow.com/users/1734785/christophe-vidal"}, "edited": false, "score": 0, "creation_date": 1583606554, "post_id": 45057403, "comment_id": 107176894, "body": "What do those structs do? What do they have in common that you want them to be returned from the same function? If you can answer that, create an interface with exactly those functions they have in common and implement those functions on both structs. Then <code>getValue</code> can return that interface (not the empty interface) and you don&#39;t need reflection."}, {"owner": {"reputation": 1634, "user_id": 1734785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda4a051ab231487e0517599ff9bc07f?s=128&d=identicon&r=PG", "display_name": "Christophe Vidal", "link": "https://stackoverflow.com/users/1734785/christophe-vidal"}, "edited": false, "score": 0, "creation_date": 1583752647, "post_id": 45057403, "comment_id": 107209903, "body": "Ok so here the background. These two structs are slightly different, we are in financial, one is about a trade struct, the other about a transfer struct, the goal is to calculate the quantity at the end. Also the trade struct shall implement some specific function not common to the transfer struct and the other way around. Anyway at the end they return a quantity. So this concept of interface is good, but I can&#39;t come to do something like that <code>qty(trade{}).calculateForX().get()</code> where qty() and get() can be called from both struct, but calculateForX() is a method only for trade struct..."}, {"owner": {"reputation": 1634, "user_id": 1734785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda4a051ab231487e0517599ff9bc07f?s=128&d=identicon&r=PG", "display_name": "Christophe Vidal", "link": "https://stackoverflow.com/users/1734785/christophe-vidal"}, "edited": false, "score": 0, "creation_date": 1583753092, "post_id": 45057403, "comment_id": 107210122, "body": "So my case is exactly like the OP where each struct shall return a different type at the end, it&#39;s just the a more advanced use case. My current workaround is to do it without interface simply like that <code>qtyGetForTrade(trade{}).calculateForX().get()</code>, and have another function for transfer, it&#39;s just less beautiful..."}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 1634, "user_id": 1734785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda4a051ab231487e0517599ff9bc07f?s=128&d=identicon&r=PG", "display_name": "Christophe Vidal", "link": "https://stackoverflow.com/users/1734785/christophe-vidal"}, "edited": false, "score": 0, "creation_date": 1583924500, "post_id": 45057403, "comment_id": 107273413, "body": "@ChristopheVidal: can you create a new question here so I can properly answer? That is easier since I would like to make a code proposal. Best link the question here."}, {"owner": {"reputation": 1634, "user_id": 1734785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda4a051ab231487e0517599ff9bc07f?s=128&d=identicon&r=PG", "display_name": "Christophe Vidal", "link": "https://stackoverflow.com/users/1734785/christophe-vidal"}, "edited": false, "score": 0, "creation_date": 1583932945, "post_id": 45057403, "comment_id": 107278067, "body": "sure. Here is the link to the question: <a href=\"https://stackoverflow.com/questions/60637078/go-interface-method-with-multiple-return-types\" title=\"go interface method with multiple return types\">stackoverflow.com/questions/60637078/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 5, "last_activity_date": 1499869975, "last_edit_date": 1499869975, "creation_date": 1499861577, "answer_id": 45057403, "question_id": 45055953, "link": "https://stackoverflow.com/questions/45055953/interface-method-with-multiple-return-types/45057403#45057403", "title": "Interface method with multiple return types", "body": "<p>You <em>could</em> achieve it in this way:</p>\n\n<pre><code>type Generatorer interface {\n    getValue() interface{}\n}\n\ntype StringGenerator struct {\n    length         int\n}\n\ntype IntGenerator struct {\n    min            int\n    max            int\n}\n\nfunc (g StringGenerator) getValue() interface{} {\n    return \"randomString\"\n}\n\nfunc (g IntGenerator) getValue() interface{} {\n    return 1\n}\n</code></pre>\n\n<p>The empty interface allows every value. This allows for generic code but basically stops you from using the very powerful type system of Go.</p>\n\n<p>In your example if you use the <code>getValue</code> function, you will get a variable of type <code>interface{}</code> and if you want to work with it, you need to know if it actually is a string or an int: you will need a lot of <code>reflect</code> making your code slow.</p>\n\n<p>Coming from Python I was used to code very generic. When learning Go I had to stop thinking that way.</p>\n\n<p>What that means in your specific case I can't say because I don't know what <code>StringGenerator</code> and <code>IntGenerator</code> are being used for.</p>\n"}], "owner": {"reputation": 7779, "user_id": 6858274, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/323d5de87d97a689b73a663375e079eb?s=128&d=identicon&r=PG&f=1", "display_name": "felix", "link": "https://stackoverflow.com/users/6858274/felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2260, "favorite_count": 1, "accepted_answer_id": 45057403, "answer_count": 2, "score": 2, "last_activity_date": 1583933027, "creation_date": 1499857605, "last_edit_date": 1583933027, "question_id": 45055953, "link": "https://stackoverflow.com/questions/45055953/interface-method-with-multiple-return-types", "title": "Interface method with multiple return types", "body": "<p>I'm struggling with interfaces. Consider this:</p>\n\n<pre><code>type Generatorer interface {\n    getValue() // which type should I put here ? \n}\n\ntype StringGenerator struct {\n    length         int\n}\n\ntype IntGenerator struct {\n    min            int\n    max            int\n}\n\nfunc (g StringGenerator) getValue() string {\n    return \"randomString\"\n}\n\nfunc (g IntGenerator) getValue() int {\n    return 1\n}\n</code></pre>\n\n<p>I want the <code>getValue()</code> function to return a <strong><code>string</code></strong> or an <strong><code>int</code></strong>, depending on if it's called from <code>StringGenerator</code> or <code>IntGenerator</code></p>\n\n<p>When I try to compile this, I get following error:</p>\n\n<blockquote>\n  <p>cannot use s (type *StringGenerator) as type Generatorer in array or\n  slice literal: \n    *StringGenerator does not implement Generatorer (wrong type for getValue method) </p>\n  \n  <p>have getValue() string<br>\n    want getValue()</p>\n</blockquote>\n\n<p>How can I achieve this?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 1191, "user_id": 2627137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rb5FY.jpg?s=128&g=1", "display_name": "kkaosninja", "link": "https://stackoverflow.com/users/2627137/kkaosninja"}, "edited": false, "score": 0, "creation_date": 1499857474, "post_id": 45055327, "comment_id": 77084877, "body": "So you are saying you want to throw an error when fields like <code>&quot;hey&quot;</code> in your example are sent as part of the payload?"}, {"owner": {"reputation": 109, "user_id": 8295098, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b5277859c9c2b2c5a50594024c56c663?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8295098/jeff"}, "reply_to_user": {"reputation": 1191, "user_id": 2627137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rb5FY.jpg?s=128&g=1", "display_name": "kkaosninja", "link": "https://stackoverflow.com/users/2627137/kkaosninja"}, "edited": false, "score": 0, "creation_date": 1499859252, "post_id": 45055327, "comment_id": 77086050, "body": "@kkaosninja, yes"}, {"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 0, "creation_date": 1499869678, "post_id": 45055327, "comment_id": 77094271, "body": "FYI while in java we &quot;throw&quot; errors, in golang we just &quot;return&quot; them :)"}], "answers": [{"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 5, "last_activity_date": 1529219495, "last_edit_date": 1529219495, "creation_date": 1499860126, "answer_id": 45056888, "question_id": 45055327, "link": "https://stackoverflow.com/questions/45055327/how-to-detect-if-received-json-has-unknown-fields/45056888#45056888", "title": "How to detect if received JSON has unknown fields", "body": "<h2>Update:</h2>\n\n<p>you might want to use <a href=\"https://golang.org/pkg/encoding/json/#Decoder.DisallowUnknownFields\" rel=\"nofollow noreferrer\"><code>DisallowUnknownFields()</code> read for more info</a></p>\n\n<hr>\n\n<h2>old answer:</h2>\n\n<p>There is a proposal for golang 1.9 on this: <a href=\"https://github.com/golang/go/issues/15314\" rel=\"nofollow noreferrer\">proposal: some way to reject unknown fields in encoding/json.Decoder</a></p>\n\n<p>Till then you could try something like this <a href=\"https://play.golang.org/p/Ia_zOMdlXT\" rel=\"nofollow noreferrer\">playground</a> (code also below).\nThe key idea is to parse the json into a map[string]interface{} and then work with the keys. This will of course get much more complicated if you have nested structs.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Foo struct {\n    Bar int `json:\"id,omitempty\"`\n}\nvar allowedFooKeys = []string{\"id\"}\n\nfunc main() {\n    b := []byte(`{\n      \"id\": 12,\n      \"hey\": \"hey\"\n    }`)\n    m := map[string]interface{}{}\n\n    if err := json.Unmarshal(b, &amp;m); err != nil {\n        panic(err)\n    }\n\n    for k, _ := range m {\n        if !keyExists(k, allowedFooKeys) {\n            fmt.Println(\"Disallowed key in JSON:\", k)\n        }\n    }\n}\n\nfunc keyExists(key string, keys []string) bool {\n    for _, k := range keys {\n        if k == key {\n            return true\n        }\n    }\n    return false\n}\n</code></pre>\n\n<p>You can even get rid of the variable <code>allowedFooKeys</code> by getting the allowed keys directly from the <code>Foo</code> struct using reflect. For more info on that see here: <a href=\"https://stackoverflow.com/questions/23840362/how-to-read-struct-field-decorators\">How to read struct field ` ` decorators?</a></p>\n"}], "owner": {"reputation": 109, "user_id": 8295098, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b5277859c9c2b2c5a50594024c56c663?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8295098/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2169, "favorite_count": 1, "accepted_answer_id": 45056888, "answer_count": 1, "score": 3, "last_activity_date": 1565438402, "creation_date": 1499855812, "last_edit_date": 1565438402, "question_id": 45055327, "link": "https://stackoverflow.com/questions/45055327/how-to-detect-if-received-json-has-unknown-fields", "title": "How to detect if received JSON has unknown fields", "body": "<p>I'm trying to find some way to prohibit arbitrary JSON keys and fields in Go. For now, if I send payload with undeclared fields in struct, the service will work normally and will map the entity described fields (like<code>json:\"id,omitempty\"</code>).\nFor example:</p>\n\n<pre><code>type Foo struct {\n    Bar         int        `json:\"id,omitempty\"`\n}\n</code></pre>\n\n<p>Received JSON:</p>\n\n<pre><code>{\n  \"id\": 12,\n  \"hey\": \"hey\"\n}\n</code></pre>\n\n<p>Can anybody help me to find the way of tracking unknown field in payload? I need to return an error in that case.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 726, "user_id": 387670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de92c7f1d6b452b9e2b3f38c11967cb8?s=128&d=identicon&r=PG", "display_name": "sahaj", "link": "https://stackoverflow.com/users/387670/sahaj"}, "is_accepted": true, "score": 2, "last_activity_date": 1499854660, "last_edit_date": 1499854660, "creation_date": 1499854298, "answer_id": 45054765, "question_id": 45054533, "link": "https://stackoverflow.com/questions/45054533/how-to-understand-golang-document/45054765#45054765", "title": "How to understand golang document?", "body": "<p><code>pattern</code> and <code>handler</code> are parameter/variable names. Unlike C, the declaration of types in Go is left to right. i.e. name of variable comes first and then its type. Read more at <a href=\"https://blog.golang.org/gos-declaration-syntax\" rel=\"nofollow noreferrer\">Go's declaration syntax</a> </p>\n\n<p>Yes, the <code>handler</code> is like JavaScript callback function. Read more at \"<a href=\"https://blog.golang.org/first-class-functions-in-go-and-new-go\" rel=\"nofollow noreferrer\">First class functions in Go</a>\"</p>\n"}], "owner": {"reputation": 6882, "user_id": 2567859, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/kJ7FA.jpg?s=128&g=1", "display_name": "Dreams", "link": "https://stackoverflow.com/users/2567859/dreams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 45054765, "answer_count": 1, "score": 0, "last_activity_date": 1499865557, "creation_date": 1499853710, "last_edit_date": 1499865557, "question_id": 45054533, "link": "https://stackoverflow.com/questions/45054533/how-to-understand-golang-document", "title": "How to understand golang document?", "body": "<p>I am new to Go and would like know how to understand this Go code:</p>\n\n<pre><code>func HandleFunc(pattern string, handler func(ResponseWriter, *Request))\n</code></pre>\n\n<p>What do <code>pattern</code> and <code>handler</code> mean?</p>\n\n<p>Is <code>handler</code> just like callback function in javascript?</p>\n"}, {"tags": ["html", "go", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 2388914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5911dcd5e171886c756cb9e3f7dbe6f?s=128&d=identicon&r=PG", "display_name": "Ragnar", "link": "https://stackoverflow.com/users/2388914/ragnar"}, "edited": false, "score": 0, "creation_date": 1500276988, "post_id": 45055225, "comment_id": 77245949, "body": "Yes, I can. But it seems to be not simple way. I thought that can be one-two line way to do such simple thing."}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 2, "last_activity_date": 1499855897, "last_edit_date": 1499855897, "creation_date": 1499855523, "answer_id": 45055225, "question_id": 45054471, "link": "https://stackoverflow.com/questions/45054471/golang-serving-html-files/45055225#45055225", "title": "Golang serving html files", "body": "<p>You could additionally add a <code>HandlerFunc</code> to handle that:</p>\n\n<pre><code>r := mux.NewRouter()\nr.HandleFunc(\"/\", homeHandler)\nr.PathPrefix(\"/\").Handler(http.StripPrefix(\"/\", http.FileServer(http.Dir(htmlDir))))\n</code></pre>\n\n<p>In the homeHandler you serve the file you want to serve:</p>\n\n<pre><code>func homeHandler(w http.ResponseWriter, r *http.Request) {\n    http.ServeFile(w, r, fmt.Sprintf(\"./%s/index.htm\", htmlDir))\n}\n</code></pre>\n\n<p>There might be other options...</p>\n"}], "owner": {"reputation": 91, "user_id": 2388914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5911dcd5e171886c756cb9e3f7dbe6f?s=128&d=identicon&r=PG", "display_name": "Ragnar", "link": "https://stackoverflow.com/users/2388914/ragnar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2016, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499855897, "creation_date": 1499853559, "question_id": 45054471, "link": "https://stackoverflow.com/questions/45054471/golang-serving-html-files", "title": "Golang serving html files", "body": "<p>I have some html files in folder /html (for example main.html,page1.html, page2.html,etc ). And I serve it, using next Go code</p>\n\n<pre><code>r := mux.NewRouter()\nr.PathPrefix(\"/\").Handler(http.StripPrefix(\"/\", http.FileServer(http.Dir(htmlDir))))\n</code></pre>\n\n<p>So if I open address <a href=\"http://127.0.0.1/page1.html\" rel=\"nofollow noreferrer\">http://127.0.0.1/page1.html</a>, then page1.html will be shown( it is what I need).\nBut I also want to bind address <a href=\"http://127.0.0.1/\" rel=\"nofollow noreferrer\">http://127.0.0.1/</a> to main.html. How can I do it?</p>\n\n<p>I can rename main.html to index.html, but I think it is not true way. </p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 0, "last_activity_date": 1499856319, "creation_date": 1499856319, "answer_id": 45055502, "question_id": 45053785, "link": "https://stackoverflow.com/questions/45053785/intermediate-model-with-two-foreign-keys-file-structure/45055502#45055502", "title": "Intermediate model with two foreign keys: file structure?", "body": "<p>All files in one folder belong to the same package (must have the same package name at the top of the file!).</p>\n\n<p>You do not need to import other files that belong to the same package (the same folder).</p>\n\n<p>Just remove the import and you should still have access to product in user_product and vice versa.</p>\n"}], "owner": {"reputation": 658, "user_id": 1973205, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/awstX.jpg?s=128&g=1", "display_name": "Theraloss", "link": "https://stackoverflow.com/users/1973205/theraloss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 45055502, "answer_count": 1, "score": 0, "last_activity_date": 1499856319, "creation_date": 1499851770, "question_id": 45053785, "link": "https://stackoverflow.com/questions/45053785/intermediate-model-with-two-foreign-keys-file-structure", "title": "Intermediate model with two foreign keys: file structure?", "body": "<p>The goal is to create an intermediate model (<em>user_product</em>) which has two foreign keys: <strong>user</strong> and <strong>product</strong>.</p>\n\n<p>Can we achieve this with user and product structs in <strong>external files</strong> (somehow) or have we to put them in the same file with UserProduct one, like in the docs?</p>\n\n<p>At this time, putting them externally and importing them in UserProduct will throw an <strong>import cycle error</strong>, of course.</p>\n\n<p>The structure:</p>\n\n<pre><code>app/\n   models/\n      product.go\n      user.go\n      user_product.go\n</code></pre>\n\n<p>The problem is that if I import <code>product.go</code> in <code>user_product</code> with <code>import \"github.com/somehow/somehow/models\"</code>, obviously it imports also <code>user_product</code> which imports <code>models</code> and so on.</p>\n"}, {"tags": ["json", "unit-testing", "go", "goconvey"], "answers": [{"tags": [], "owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "is_accepted": true, "score": 3, "last_activity_date": 1499851119, "creation_date": 1499851119, "answer_id": 45053535, "question_id": 45052597, "link": "https://stackoverflow.com/questions/45052597/how-to-test-a-panic-in-golang/45053535#45053535", "title": "How to test a panic in Golang?", "body": "<p>Use recover().</p>\n\n<pre><code>func Testgood_PanicStatement(t *testing.T) {\n  Convey(\"And Invalid Json return error\",t, func() {\n    defer func() {\n      if r := recover(); r != nil {\n        So(func() {},shouldPanic)\n        So(actual ,ShouldEqual,\"\")\n      }\n    }()\n    actual := good(\"garbage json\")\n  }\n}\n</code></pre>\n\n<p>Lear more about:</p>\n\n<ol>\n<li><a href=\"https://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow noreferrer\">Golang blog</a></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 2, "last_activity_date": 1499857092, "creation_date": 1499857092, "answer_id": 45055763, "question_id": 45052597, "link": "https://stackoverflow.com/questions/45052597/how-to-test-a-panic-in-golang/45055763#45055763", "title": "How to test a panic in Golang?", "body": "<p>Upvoting the answer of <a href=\"https://stackoverflow.com/users/3476121/sadlil\">sadlil</a> as correct I want to point out, that panicking functions are not good practice. Rather convert the panic into an error INSIDE the function and test the error instead.</p>\n\n<pre><code>func good(json) (s string, err error) {\n  defer func() {\n    if r := recover(); r != nil {\n      err = fmt.Errorf(\"Error in good: %v\", r)\n    }\n  }()\n\n  \\\\do something\n  err = json.Unmarshal(body, &amp;list)\n  if err != nil {\n    # leaving the panic statement for demonstration. In this case\n    # you could just: return \"\", err\n    panic(fmt.Sprintf(\"Unable to parse json %s\",err))\n  }\n\n  return\n}\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 4979070, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2b174fcee2d4adcddfb2dc9496bf7875?s=128&d=identicon&r=PG&f=1", "display_name": "techno", "link": "https://stackoverflow.com/users/4979070/techno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1828, "favorite_count": 0, "accepted_answer_id": 45053535, "answer_count": 2, "score": 2, "last_activity_date": 1499857092, "creation_date": 1499848781, "question_id": 45052597, "link": "https://stackoverflow.com/questions/45052597/how-to-test-a-panic-in-golang", "title": "How to test a panic in Golang?", "body": "<pre><code>func good(json) string {\n\n  \\\\do something\n err = json.Unmarshal(body, &amp;list)\n if err != nil {\n    panic(fmt.Sprintf(\"Unable to parse json %s\",err))\n }\n\n}\n\nfunc Testgood_PanicStatement(t *testing.T) {\n  Convey(\"And Invalid Json return error\",t, func() {\n    actual := good(\"garbage json\")\n    So(func() {},shoulPanic)\n    So(actual ,ShouldEqual,\"\")\n  }\n}\n</code></pre>\n\n<p>Outcome</p>\n\n<p>Line 34: - Unable to parse json ,{%!e(string=invalid character '{' looking for beginning of object key string) %!e(int64=50)}</p>\n\n<p>goroutine 8 [running]:</p>\n\n<p><strong>Question</strong>:It seems like when I am passing garbage json file.It is panicking and doesn't execute any of the So statements?How to fix it?</p>\n"}, {"tags": ["go", "ssh", "terminal", "kubernetes", "cluster-computing"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1499847690, "post_id": 45051875, "comment_id": 77077840, "body": "Which part are you struggling with?"}, {"owner": {"reputation": 1, "user_id": 6942447, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3485870d3285dad6702a3aee079ad6b5?s=128&d=identicon&r=PG&f=1", "display_name": "user6942447", "link": "https://stackoverflow.com/users/6942447/user6942447"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1499848122, "post_id": 45051875, "comment_id": 77078152, "body": "I do not know how to write the function that randomly selects pods."}, {"owner": {"reputation": 1, "user_id": 6942447, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3485870d3285dad6702a3aee079ad6b5?s=128&d=identicon&r=PG&f=1", "display_name": "user6942447", "link": "https://stackoverflow.com/users/6942447/user6942447"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1499848153, "post_id": 45051875, "comment_id": 77078175, "body": "Because I would have to read them first and then randomly select them"}, {"owner": {"reputation": 14375, "user_id": 344669, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8JOSf.gif?s=128&g=1", "display_name": "sfgroups", "link": "https://stackoverflow.com/users/344669/sfgroups"}, "edited": false, "score": 0, "creation_date": 1499911764, "post_id": 45051875, "comment_id": 77113606, "body": "try to connect list this. <a href=\"https://github.com/kubernetes/client-go/blob/master/examples/create-update-delete-deployment/main.go\" rel=\"nofollow noreferrer\">github.com/kubernetes/client-go/blob/master/examples/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "is_accepted": false, "score": 1, "last_activity_date": 1499851425, "creation_date": 1499851425, "answer_id": 45053649, "question_id": 45051875, "link": "https://stackoverflow.com/questions/45051875/go-randomly-terminate-pods-in-kubernetes-cluster/45053649#45053649", "title": "go: randomly terminate pods in kubernetes cluster", "body": "<p>Use <code>k8s.io/client-go</code> (<a href=\"https://github.com/kubernetes/client-go\" rel=\"nofollow noreferrer\">Github Link</a>) client package to list kubernetes pods, and then delete them randomly.</p>\n\n<p>Use <a href=\"https://github.com/kubernetes/client-go/blob/master/kubernetes/typed/core/v1/pod.go#L35\" rel=\"nofollow noreferrer\">client.CoreV1().Pods()</a> methods to list and delete pods.</p>\n"}], "owner": {"reputation": 1, "user_id": 6942447, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3485870d3285dad6702a3aee079ad6b5?s=128&d=identicon&r=PG&f=1", "display_name": "user6942447", "link": "https://stackoverflow.com/users/6942447/user6942447"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1499851425, "creation_date": 1499846683, "question_id": 45051875, "link": "https://stackoverflow.com/questions/45051875/go-randomly-terminate-pods-in-kubernetes-cluster", "title": "go: randomly terminate pods in kubernetes cluster", "body": "<p>I would like to randomly shut down pods in a kubernetes cluster with go. I already wrote code, which enables to login to the server and run code. </p>\n\n<p>Now I would need to read all the available pods in the cluster, choose some randomly and terminate them. <em>(I am new to go)</em></p>\n\n<p>Could you please help me doing this? </p>\n\n<p>This is how I am running commands on the cluster/server\n  <code>cli.ExecuteCmd(\"kubectl get pods\")</code></p>\n\n<pre><code>// Use one connection per command.\n// Catch in the client when required.\nfunc (cli *SSHClient)ExecuteCmd(command string){\n  conn, err := ssh.Dial(\"tcp\", cli.Hostname+\":22\", cli.Config)\n  if err!=nil {\n    logrus.Infof(\"%s@%s\", cli.Config.User, cli.Hostname)\n    logrus.Info(\"Hint: Add you key to the ssh agent: 'ssh-add ~/.ssh/id_rsa'\")\n    logrus.Fatal(err)\n  }\n  session, _ := conn.NewSession()\n  defer session.Close()\n  var stdoutBuf bytes.Buffer\n  session.Stdout = &amp;stdoutBuf\n  err = session.Run(command)\n  if err != nil {\n    logrus.Fatalf(\"Run failed:%v\", err)\n  }\n  logrus.Infof(\"&gt;%s\", stdoutBuf.Bytes())\n}\n</code></pre>\n"}, {"tags": ["unit-testing", "go", "net-http"], "comments": [{"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1499842586, "post_id": 45050191, "comment_id": 77074464, "body": "Not clear on what you mean by &quot;but not sure how to pass that mock value inside the good() function&quot; ?"}, {"owner": {"reputation": 81, "user_id": 4979070, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2b174fcee2d4adcddfb2dc9496bf7875?s=128&d=identicon&r=PG&f=1", "display_name": "techno", "link": "https://stackoverflow.com/users/4979070/techno"}, "reply_to_user": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1499844687, "post_id": 45050191, "comment_id": 77075776, "body": "@JohnSPerayil I edited the question.Hope it is clear now"}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1499945630, "post_id": 45050191, "comment_id": 77131068, "body": "I think <code>sahaj</code>&#39;s answer gives you some guidance, if you need more specific help let me know and I&#39;ll try to work out an answer for you."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1500476734, "post_id": 45050191, "comment_id": 77356268, "body": "None of this code is valid - can you provide an example that will at least compile?"}], "answers": [{"tags": [], "owner": {"reputation": 726, "user_id": 387670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de92c7f1d6b452b9e2b3f38c11967cb8?s=128&d=identicon&r=PG", "display_name": "sahaj", "link": "https://stackoverflow.com/users/387670/sahaj"}, "is_accepted": true, "score": 2, "last_activity_date": 1501847411, "last_edit_date": 1501847411, "creation_date": 1499938409, "answer_id": 45076738, "question_id": 45050191, "link": "https://stackoverflow.com/questions/45050191/how-to-mock-unittest-nested-function/45076738#45076738", "title": "How to mock/unittest nested function", "body": "<p>Assuming you are facing difficulty to mock http.Client, I would like to suggest following options.</p>\n\n<p><strong>1. Refactor the code</strong></p>\n\n<p>You need to refactor the code in such a way that you can pass the mockable dependencies to function that you would like to test. </p>\n\n<p>For example,</p>\n\n<p>Refactor <code>func send_api(client *http.Client,url string) map[string]string,error</code> so that it does api request and getting/parsing data, but call another function from it, which does the further processing (that actually you would like to test and not the http.Client part).</p>\n\n<p>But, with this approach, you may not be able to test end to end flow. But you can test those functions separately.</p>\n\n<p><strong>2. Mock http.Client</strong></p>\n\n<p>Again, you may need to refactor your code. Some related article can be found <a href=\"http://webiphany.com/2014/06/23/mocking-out-client-http-requests-with-go.html\" rel=\"nofollow noreferrer\">here</a>   </p>\n\n<p>Update: Recommending to watch <a href=\"https://www.youtube.com/watch?v=hVFEV-ieeew\" rel=\"nofollow noreferrer\">justforfunc #16: unit testing HTTP servers</a></p>\n"}], "owner": {"reputation": 81, "user_id": 4979070, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2b174fcee2d4adcddfb2dc9496bf7875?s=128&d=identicon&r=PG&f=1", "display_name": "techno", "link": "https://stackoverflow.com/users/4979070/techno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1756, "favorite_count": 0, "accepted_answer_id": 45076738, "answer_count": 1, "score": 0, "last_activity_date": 1568127548, "creation_date": 1499841535, "last_edit_date": 1568127548, "question_id": 45050191, "link": "https://stackoverflow.com/questions/45050191/how-to-mock-unittest-nested-function", "title": "How to mock/unittest nested function", "body": "<p>I have a function which is getting called inside other function.</p>\n\n<p><strong>send_api.go</strong></p>\n\n<pre><code> function *send_api*(client *http.Client,url string) map[string]string,error {\n    //send api request and parse the response and return the dict \n\n    return dictmap\n    for eg:{apple fruit}       \n}\n</code></pre>\n\n<p>Then this function is getting called in <strong>main()</strong> function</p>\n\n<pre><code>func *main()*{\n\n  getmap :=send_api(client *http.Client,\"test.com\")\n }\n</code></pre>\n\n<p><strong>good.go</strong>    </p>\n\n<pre><code>func *get_dict_key*(key string) string,error {\n   value,ok := get_map[key]\n   if !ok {\n          return fmt.Errorf(\"value is nil\")\n   }\n   return value ,nil    \n }\n\nfunction *good*(client *http.client, key string) {\n //get a dictionary value\n dcmap,err := get_dict_key(\"apple\")\n if err != nil {\n  panic(err)\n  }\n value := dcmap[key]\n\n //use the value to do other processing\n }\n</code></pre>\n\n<p><strong>unit_test</strong></p>\n\n<pre><code>  func Test_good(t *testing.T) {\n      Convey(\"AND quadra and conusl dcs are mapped\",t, func() {\n          mockResponses := send mock GET request to the URL and receive a response{\"apple\":\"fruit\"}\n        }\n        server, client := tools.TestClientServer(&amp;mockResponses)\n        defer server.Close()\n        getMap := send_api(client.HTTPClient, \"http://test\")\n        //At this point getMAP has value {'apple' 'fruit'}\n        **q1.How to pass getMap value inside this get_dict_fkey function during testing?**\n        value := get_dict_key(\"apple\")\n        good(client,\"apple\") #error:(value is nil)\n</code></pre>\n\n<p>Q1.  **q1.How to pass getMap value inside this get_dict_function during testing?*</p>\n\n<p>Any pointer would be helpful?</p>\n"}, {"tags": ["memory", "go", "struct", "padding", "sizeof"], "comments": [{"owner": {"reputation": 8686, "user_id": 268025, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/eb39f8801f5c6b47bab7d5e91bf513f4?s=128&d=identicon&r=PG", "display_name": "tangrs", "link": "https://stackoverflow.com/users/268025/tangrs"}, "edited": false, "score": 0, "creation_date": 1499831278, "post_id": 45048049, "comment_id": 77069967, "body": "What are the sizes?"}, {"owner": {"reputation": 4656, "user_id": 1787388, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pSr04.png?s=128&g=1", "display_name": "shusson", "link": "https://stackoverflow.com/users/1787388/shusson"}, "edited": false, "score": 0, "creation_date": 1499832302, "post_id": 45048049, "comment_id": 77070210, "body": "size of bar2:8, size of bar3:4"}], "answers": [{"comments": [{"owner": {"reputation": 148, "user_id": 256392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d816ead5750185e64ee359f76f0f4ca?s=128&d=identicon&r=PG", "display_name": "Rader", "link": "https://stackoverflow.com/users/256392/rader"}, "edited": false, "score": 1, "creation_date": 1499834301, "post_id": 45048321, "comment_id": 77070794, "body": "<code>bool</code> use memory space, which is different from <code>[0]byte</code>. If you replace <code>[0]byte</code> with <code>bool</code> in bar2 and bar3, both structs will have same size. There is a full example here: <a href=\"https://play.golang.org/p/hNcG9gRlQx\" rel=\"nofollow noreferrer\">play.golang.org/p/hNcG9gRlQx</a>"}, {"owner": {"reputation": 4656, "user_id": 1787388, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pSr04.png?s=128&g=1", "display_name": "shusson", "link": "https://stackoverflow.com/users/1787388/shusson"}, "reply_to_user": {"reputation": 148, "user_id": 256392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d816ead5750185e64ee359f76f0f4ca?s=128&d=identicon&r=PG", "display_name": "Rader", "link": "https://stackoverflow.com/users/256392/rader"}, "edited": false, "score": 0, "creation_date": 1499835461, "post_id": 45048321, "comment_id": 77071197, "body": "Yes but the required alignment of [0]byte is 1. You can check the required alignment with <code>unsafe.Alignof</code> and compute the offset of a field using <code>unsafe.Offsetof</code>. See <a href=\"https://play.golang.org/p/aEEqDBdBZW\" rel=\"nofollow noreferrer\">play.golang.org/p/aEEqDBdBZW</a>"}, {"owner": {"reputation": 148, "user_id": 256392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d816ead5750185e64ee359f76f0f4ca?s=128&d=identicon&r=PG", "display_name": "Rader", "link": "https://stackoverflow.com/users/256392/rader"}, "edited": false, "score": 1, "creation_date": 1499841835, "post_id": 45048321, "comment_id": 77074025, "body": "If you print <code>alignof</code> and <code>offset</code> of the <code>bool</code> and <code>[0]byte</code> members, you will find that they are the same to two different types. So, that can&#39;t explain the struct size difference. See <a href=\"https://play.golang.org/p/oAnH2XodPa\" rel=\"nofollow noreferrer\">play.golang.org/p/oAnH2XodPa</a>"}], "tags": [], "owner": {"reputation": 4656, "user_id": 1787388, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pSr04.png?s=128&g=1", "display_name": "shusson", "link": "https://stackoverflow.com/users/1787388/shusson"}, "is_accepted": false, "score": 1, "last_activity_date": 1499836014, "last_edit_date": 1499836014, "creation_date": 1499832911, "answer_id": 45048321, "question_id": 45048049, "link": "https://stackoverflow.com/questions/45048049/why-position-of-0byte-in-the-struct-matters/45048321#45048321", "title": "Why position of `[0]byte` in the struct matters?", "body": "<p>The reason is \"holes\":</p>\n\n<blockquote>\n  <p>Holes are the unused spaces added by the compiler to ensure that the\n  following field or element is properly aligned relative to the start\n  of the struct or array [1]</p>\n</blockquote>\n\n<p>For example (numbers based on whatever hardware the go playground is using):</p>\n\n<pre><code>struct {bool; float64; int16} // 24 bytes\nstruct {float64; bool; int16} // 16 bytes\n</code></pre>\n\n<p>You can verify the layout of a struct using:</p>\n\n<ul>\n<li><a href=\"https://golang.org/pkg/unsafe/#Alignof\" rel=\"nofollow noreferrer\">unsafe.Alignof</a> returns the required alignment</li>\n<li><a href=\"https://golang.org/pkg/unsafe/#Offsetof\" rel=\"nofollow noreferrer\">unsafe.Offsetof</a> computes the offset of a field relative to the start of it's enclosing struct including holes</li>\n</ul>\n\n<p>[1] p354 Donovan, Kernighan, AD, BK, 2016. The GO Programming Language. 1st ed. New York: Addison-Wesley.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1500109910, "last_edit_date": 1500109910, "creation_date": 1499852879, "answer_id": 45054213, "question_id": 45048049, "link": "https://stackoverflow.com/questions/45048049/why-position-of-0byte-in-the-struct-matters/45054213#45054213", "title": "Why position of `[0]byte` in the struct matters?", "body": "<p>This is due to a <em>tricky</em> padding.</p>\n\n<p>First please allow me to slightly rename the structs and fields so it'll be easier to talk about them:</p>\n\n<pre><code>type bar1 struct {\n    A [0]byte\n    I int\n}\n\ntype bar2 struct {\n    I int\n    A [0]byte\n}\n</code></pre>\n\n<p>This of course doesn't change the size and offsets as can be verified on the <a href=\"https://play.golang.org/p/NcTeFpDrJi\" rel=\"nofollow noreferrer\">Go Playground</a>:</p>\n\n<pre><code>bar1 size:     4\nbar1.A offset: 0\nbar1.I offset: 0\n\nbar2 size:     8\nbar2.I offset: 0\nbar2.A offset: 4\n</code></pre>\n\n<p>The size of a value of type <code>[0]byte</code> is zero, so it is perfectly valid in  <code>bar1</code> to not reserve any space for the first field (<code>bar1.A</code>), and lay out the <code>bar1.I</code> field with 0 offset.</p>\n\n<p>The question is: why can't the compiler do the same in the 2nd case (with <code>bar2</code>)?</p>\n\n<p>A field must have an address that must be after the memory area reserved for the previous field. In the first case the first field <code>bar1.A</code> has 0 size, so the 2nd field may have 0 offset, it will not \"overlap\" with the first field.</p>\n\n<p>In case of <code>bar2</code>, the second field cannot have an address (and therefore an offset) that overlaps with the first field, so its offset cannot be less than the size of <code>int</code> which is 4 bytes in case of 32-bit architectures (and 8 bytes in case of 64-bit arch).</p>\n\n<p>This still seems ok. But since <code>bar2.A</code> has zero size, why can't the size of the struct <code>bar2</code> be just that: 4 bytes (or 8 in 64-bit arch)?</p>\n\n<p>This is because it is perfectly <strong>valid to take the address of fields (and variables) that have 0 size</strong>. Ok, so what?</p>\n\n<p>In case of <code>bar2</code>, the compiler has to insert a 4 (or 8) byte padding, else taking the address of a <code>bar2.A</code> field would point <strong>outside of the memory area</strong> reserved for a value of type <code>bar2</code>.</p>\n\n<p>As an example, <strong>without padding</strong> a value of <code>bar2</code> may have an address of <code>0x100</code>, size 4, so memory reserved for the struct value has address range <code>0x100 .. 0x103</code>. Address of <code>bar2.A</code> would be <code>0x104</code>, that is outside of the struct's memory. In case of an array of this struct (e.g. <code>x [5]bar2</code>), if the array starts at <code>0x100</code>, address of <code>x[0]</code> would be <code>0x100</code>, address of <code>x[0].A</code> would be <code>0x104</code>, and address of the subsequent element <code>x[1]</code> would also be <code>0x104</code> but that's the address of another struct value! Not cool.</p>\n\n<p>To avoid this, the compiler inserts a padding (which will be 4 or 8 bytes depending on the arch), so that taking the address of <code>bar2.A</code> will not result in an address being outside of the struct's memory, which otherwise could raise questions and cause problems regarding garbage collection (e.g. if only address of <code>bar2.A</code> is kept but not the struct or another pointer to it or its other fields, the whole struct should not be garbage collected, but since no pointer points to its memory area, it would seem to be valid to do so). The inserted padding will be 4 (or 8) bytes, because <a href=\"https://golang.org/ref/spec#Size_and_alignment_guarantees\" rel=\"nofollow noreferrer\">Spec: Size and alignment guarantees:</a></p>\n\n<blockquote>\n  <p>For a variable <code>x</code> of struct type: <code>unsafe.Alignof(x)</code> is the largest of all the values <code>unsafe.Alignof(x.f)</code> for each field <code>f</code> of <code>x</code>, but at least <code>1</code>.</p>\n</blockquote>\n\n<p>If this is so, adding an additional <code>int</code> field would make the size of both structs equal:</p>\n\n<pre><code>type bar1 struct {\n    I int\n    A [0]byte\n    X int\n}\n\ntype bar2 struct {\n    A [0]byte\n    I int\n    X int\n}\n</code></pre>\n\n<p>And truly they both have 8 bytes on 32-bit arch (and 16 bytes on 64-bit arch) (try it on the <a href=\"https://play.golang.org/p/SBweaAzE2b\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>bar1 size:     8\nbar1.I offset: 0\nbar1.A offset: 4\nbar1.X offset: 4\n\nbar2 size:     8\nbar2.A offset: 0\nbar2.I offset: 0\nbar2.X offset: 4\n</code></pre>\n\n<p>See related question: <a href=\"https://stackoverflow.com/questions/34219232/struct-has-different-size-if-the-field-order-is-different/34219916#34219916\">Struct has different size if the field order is different</a></p>\n"}], "owner": {"reputation": 148, "user_id": 256392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d816ead5750185e64ee359f76f0f4ca?s=128&d=identicon&r=PG", "display_name": "Rader", "link": "https://stackoverflow.com/users/256392/rader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 45054213, "answer_count": 2, "score": 3, "last_activity_date": 1500109910, "creation_date": 1499831173, "last_edit_date": 1499854546, "question_id": 45048049, "link": "https://stackoverflow.com/questions/45048049/why-position-of-0byte-in-the-struct-matters", "title": "Why position of `[0]byte` in the struct matters?", "body": "<p><code>[0]byte</code> in golang should not take any memory space. But these two structs have different sizes.</p>\n\n<pre><code>type bar2 struct {\n    A int\n    _ [0]byte\n}\n\ntype bar3 struct {\n    _ [0]byte\n    A int   \n}\n</code></pre>\n\n<p>So why the position of <code>[0]byte</code> matters here?</p>\n\n<p>By the way, I use <code>unsafe.Sizeof()</code> method to check the struct size. See the <a href=\"https://play.golang.org/p/oAnH2XodPa\" rel=\"nofollow noreferrer\">full example</a> .</p>\n"}, {"tags": ["go", "nfs"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1499877550, "post_id": 45047426, "comment_id": 77099804, "body": "Why are you using <code>O_APPEND</code> if you want to write at a specific offset? <code>O_APPEND</code> means that the offset is set to the the current end of the file just before any <code>write</code>, while <code>WriteAt</code> uses <code>pwrite</code> (which may be implemented as an <code>lseek</code> + <code>write</code>) to write at a specific offset. There&#39;s a logical conflict here that is resolved differently depending on the system."}, {"owner": {"reputation": 786, "user_id": 866473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a8d0c6fd0e53e55f4b46b120dc4b75a9?s=128&d=identicon&r=PG", "display_name": "Bas Kuis", "link": "https://stackoverflow.com/users/866473/bas-kuis"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1499882991, "post_id": 45047426, "comment_id": 77102837, "body": "Thank you for this comment Jim. I&#39;ll experiment with different modes."}, {"owner": {"reputation": 786, "user_id": 866473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a8d0c6fd0e53e55f4b46b120dc4b75a9?s=128&d=identicon&r=PG", "display_name": "Bas Kuis", "link": "https://stackoverflow.com/users/866473/bas-kuis"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1499884852, "post_id": 45047426, "comment_id": 77103864, "body": "Ok! You are right Jim. Feel free to submit an answer which I can select."}, {"owner": {"reputation": 786, "user_id": 866473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a8d0c6fd0e53e55f4b46b120dc4b75a9?s=128&d=identicon&r=PG", "display_name": "Bas Kuis", "link": "https://stackoverflow.com/users/866473/bas-kuis"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1499884877, "post_id": 45047426, "comment_id": 77103876, "body": "I&#39;m able to correctly write at &#39;offset&#39; when using: fd, err := os.OpenFile(path, os.O_WRONLY, 0660)"}], "owner": {"reputation": 786, "user_id": 866473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a8d0c6fd0e53e55f4b46b120dc4b75a9?s=128&d=identicon&r=PG", "display_name": "Bas Kuis", "link": "https://stackoverflow.com/users/866473/bas-kuis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 341, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499827138, "creation_date": 1499827138, "question_id": 45047426, "link": "https://stackoverflow.com/questions/45047426/append-to-file-using-golang-where-file-is-on-a-nfs-attached-volume", "title": "Append to file using golang where file is on a NFS attached volume", "body": "<p>As part of a large file upload feature.</p>\n\n<p>We're using the following to write a 'chunk' of bytes to a file at 'path'. This works fine on local filesystems. Each chunk is correctly written at 'offset'.</p>\n\n<pre><code>f, err := os.OpenFile(path, os.O_APPEND|os.O_WRONLY, os.ModeAppend)\nn, err := f.WriteAt(bytes, offset)\n</code></pre>\n\n<p>On NFS attached storage however the bytes are written at the beginning of the file and not at the requested 'offset'.</p>\n\n<p>Even though it doesn't appear that the process will be able to obtain a lock on the file over NFS. Is there a technique of workaround we could follow to append to a file at 'offset'?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "edited": false, "score": 0, "creation_date": 1499822017, "post_id": 45046680, "comment_id": 77067614, "body": "It doesn&#39;t pull the providers form anywhere, if you are using go build it&#39;s using the local files. I&#39;m not familiar with the code you are using but try doing <code>go build .&#47;...</code>. If your provider is in a subpackage it might be using the latest compiled version of the package but the command with the <code>.&#47;...</code> will rebuild the entire project and the dependencies."}, {"owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "reply_to_user": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "edited": false, "score": 0, "creation_date": 1499822157, "post_id": 45046680, "comment_id": 77067652, "body": "I don&#39;t recall how I got it to even pull in dependancies.  If I simply do go <code>build .&#47;...</code>  it prints out dependancy errors.  e.g.  oauthproxy.go:17:2: cannot find package &quot;github.com/18F/hmacauth&quot; in any of: ..."}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "edited": false, "score": 0, "creation_date": 1499822271, "post_id": 45046680, "comment_id": 77067692, "body": "Do <code>go get .&#47;...</code> and then <code>go build .&#47;...</code>. Go get will fetch the dependencies from github. Not sure how you compiled it the first time without them."}, {"owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "reply_to_user": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "edited": false, "score": 0, "creation_date": 1499822326, "post_id": 45046680, "comment_id": 77067705, "body": "What does ./... after build and get mean compared to . ?  it gives different results"}, {"owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "reply_to_user": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "edited": false, "score": 0, "creation_date": 1499822743, "post_id": 45046680, "comment_id": 77067814, "body": "@Topo - I followed your go get and go build suggestion after first cleaning up the existing src directory.  Unfortunately, there are lots of errors.  Any ideas?"}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "edited": false, "score": 0, "creation_date": 1499823632, "post_id": 45046680, "comment_id": 77068022, "body": "Do as @jeevatkm said. The go tool only works as expected if you have it configured correctly. Take a look at <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 0, "creation_date": 1499823839, "post_id": 45046927, "comment_id": 77068084, "body": "I originally used git clone.    <code>go get github.com&#47;bitly&#47;oauth2_proxy</code> fails to produce a folder.  And so nothing happens.  Go install then fails silently.  I&#39;ll try the manual step"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 1, "creation_date": 1499823909, "post_id": 45046927, "comment_id": 77068105, "body": "Did you setup GOPATH correctly? Also you can added <code>-v</code> to see what&#39;s going on with <code>go get -v github.com&#47;bitly&#47;oauth2_proxy</code>."}, {"owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 0, "creation_date": 1499824049, "post_id": 45046927, "comment_id": 77068135, "body": "Yep, I copied your instructions exactly.  I tried it again in a different path and it now seems to do something.   Can you tell me what is this src/github.com biz about?   why does your code need to be there?  why I can&#39;t I git clone the thing, then edit the files and build.  When I tried to build with first a go get and go build it would grab the files from github.  Hense loose all my local changes.  What backward design is this?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 0, "creation_date": 1499824240, "post_id": 45046927, "comment_id": 77068182, "body": "<code>github.com&#47;bitly&#47;oauth2_proxy</code> is called package import path. Good read <a href=\"https://golang.org/doc/code.html#ImportPaths\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 0, "creation_date": 1499825145, "post_id": 45046927, "comment_id": 77068388, "body": "I updated answer with further info, please have a look."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 0, "creation_date": 1499867381, "post_id": 45046927, "comment_id": 77092477, "body": "@Matt just because you don&#39;t understand it doesn&#39;t mean it&#39;s a &quot;backward design&quot;. Familiarize yourself with the basics of the Go toolchain, it might help."}, {"owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 0, "creation_date": 1499888880, "post_id": 45046927, "comment_id": 77105955, "body": "I got it working.  It&#39;s backward because it&#39;s not intuitive.  It appeared to be building the code but was silently grabbing stuff in the background and building that instead. It goes against the grain of every other system out there.  You might say it&#39;s forward, it&#39;s annoying that&#39;s what it is.  Now that I know, at least I can work with it.  I just found it an irritation to get going quickly."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 1, "last_activity_date": 1499825121, "last_edit_date": 1499825121, "creation_date": 1499823471, "answer_id": 45046927, "question_id": 45046680, "link": "https://stackoverflow.com/questions/45046680/my-changes-are-not-ending-up-in-the-go-app-whats-going-on-with-go/45046927#45046927", "title": "My changes are not ending up in the go app. What&#39;s going on with go?", "body": "<p><strong>EDIT:</strong></p>\n\n<p>I just did <code>go get -v github.com/bitly/oauth2_proxy</code> on my machine. </p>\n\n<p>Verbose Details: <a href=\"http://pasted.co/60e2b56d\" rel=\"nofollow noreferrer\">http://pasted.co/60e2b56d</a></p>\n\n<p>Binary is produced under <code>$GOPATH/bin/oauth2_proxy</code>.</p>\n\n<pre><code>-rwxr-xr-x  1 jeeva  staff    10M Jul 11 19:02 oauth2_proxy\n</code></pre>\n\n<hr>\n\n<p>Let's start from basis. First setup your Go workspace (<a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>) pick a directory for GOPATH. </p>\n\n<p>For example: /Users/matt/dev</p>\n\n<pre><code>export GOPATH=/Users/matt/dev\n</code></pre>\n\n<p>Then do <code>go get</code> to get the <code>oauth2_proxy</code>. Typically go get is git clone of that repository.</p>\n\n<pre><code>go get github.com/bitly/oauth2_proxy\n</code></pre>\n\n<p>It will get the source code and runs <code>go install</code>. After successful execution of this command. You will see binary file in <code>$GOPATH/bin</code>.</p>\n\n<p>Now modified the source code as you need and run go install to build the binary.</p>\n\n<pre><code>go install github.com/bitly/oauth2_proxy\n\nOR\ncd $GOPATH/src/github.com/bitly/oauth2_proxy\ngo install\n</code></pre>\n\n<hr>\n\n<p>If you would like to manually instead of <code>go get</code>. Then pick a directory for <code>GOPATH</code> and export it (as mentioned above) then</p>\n\n<pre><code>mkdir -p $GOPATH/src/github.com/bitly\ncd $GOPATH/src/github.com/bitly\ngit clone https://github.com/bitly/oauth2_proxy.git\ncd oauth2_proxy\ngo get ./...\ngo install \n</code></pre>\n\n<p>Now binary will be in <code>$GOPATH/bin</code>.</p>\n"}], "owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 45046927, "answer_count": 1, "score": 1, "last_activity_date": 1499825121, "creation_date": 1499821490, "last_edit_date": 1499822703, "question_id": 45046680, "link": "https://stackoverflow.com/questions/45046680/my-changes-are-not-ending-up-in-the-go-app-whats-going-on-with-go", "title": "My changes are not ending up in the go app. What&#39;s going on with go?", "body": "<p>I'm new to go.</p>\n\n<p>I have cloned this project: [oauth2_proxy][1]\nI'm wanting to add another provider.  So I created the provider file in providers.  Added the provider name to the providers switch statement.\nHowever, when I build the resulting binary, the provider keeps falling back to google.</p>\n\n<p>It seems my provider has not been added.  I suspect that go build might be pulling the providers from github and ignoring my local changes.  Would that be right?  How do you build this thing? </p>\n\n<p>I'm building with <code>go build</code> because ./dist.sh script didn't work for me.  I'm managing to produce a binary.  But it doesn't appear my code file ended up in it.  I know this because when I grep for \"google\" or \"linkedin\" or any of the provider names on the resulting binary it says: <code>Binary file oauth2_proxy matches</code>.  But for my own provider, there is no match. </p>\n\n<p>It's probably got something to do with the way I'm compiling the app.  How do I do that? no instructions on the github page for doing that are provided.  Sorry for my ignorance.  I'm coming from a c++ background which is more logical.  Go seems to pick up dependancies automagically!?</p>\n\n<hr>\n\n<p>Following suggestions from @Topo</p>\n\n<pre><code>matthewh@xen:~/dev/oauth2_proxy$ export GOPATH=`pwd`\nmatthewh@xen:~/dev/oauth2_proxy$ rm -rf src\nmatthewh@xen:~/dev/oauth2_proxy$ go get ./...\ngo install: no install location for directory /home/matthewh/dev/oauth2_proxy outside GOPATH\n    For more details see: 'go help gopath'\ngo install: no install location for directory /home/matthewh/dev/oauth2_proxy/api outside GOPATH\n    For more details see: 'go help gopath'\ngo install: no install location for directory /home/matthewh/dev/oauth2_proxy/cookie outside GOPATH\n    For more details see: 'go help gopath'\ngo install: no install location for directory /home/matthewh/dev/oauth2_proxy/providers outside GOPATH\n    For more details see: 'go help gopath'\n\nsrc/cloud.google.com/go/internal/retry.go:21:2: cannot find package \"github.com/googleapis/gax-go\" in any of:\n    /usr/local/go/src/github.com/googleapis/gax-go (from $GOROOT)\n    /home/matthewh/dev/oauth2_proxy/src/github.com/googleapis/gax-go (from $GOPATH)\nsrc/google.golang.org/api/internal/settings.go:22:2: cannot find package \"google.golang.org/grpc\" in any of:\n    /usr/local/go/src/google.golang.org/grpc (from $GOROOT)\n    /home/matthewh/dev/oauth2_proxy/src/google.golang.org/grpc (from $GOPATH)\nsrc/google.golang.org/api/transport/dial.go:30:2: cannot find package \"google.golang.org/grpc/credentials\" in any of:\n    /usr/local/go/src/google.golang.org/grpc/credentials (from $GOROOT)\n\n ...\n\n  [1]: https://github.com/bitly/oauth2_proxy\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "edited": false, "score": 0, "creation_date": 1499825289, "post_id": 45046353, "comment_id": 77068429, "body": "May I know if scanner has the information about op (from os.Open)? In other words, is the defer op.Close() triggered inside function read() or inside function dowork() ? Thanks!"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1499867546, "post_id": 45046353, "comment_id": 77092616, "body": "This has nothing to do with the scanner - you call <code>Close</code> in <code>read</code>, so <code>Close</code> is called in <code>read</code>."}], "tags": [], "owner": {"reputation": 4456, "user_id": 4127569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b728c7d6c1dce81f5a82249b7617756?s=128&d=identicon&r=PG&f=1", "display_name": "jch", "link": "https://stackoverflow.com/users/4127569/jch"}, "is_accepted": true, "score": 1, "last_activity_date": 1499818568, "creation_date": 1499818568, "answer_id": 45046353, "question_id": 45046093, "link": "https://stackoverflow.com/questions/45046093/is-it-a-good-idea-to-use-a-list-of-bufio-scanner-for-files-to-be-read-later-in/45046353#45046353", "title": "Is it a good idea to use a list of *bufio.Scanner for files to be read later in golang?", "body": "<p>A <code>Scanner</code> is a complicated structure, and one that embeds a buffer.  The buffer can grow dynamically (depending on what the <code>scan</code> function requests) up to 64kB (<code>MaxScanTokenSize</code>).</p>\n\n<p>So in general it is not a good idea to keep redundant <code>Scanner</code>s around, as the buffers cannot be released until the <code>Scanner</code>s are discarded.  But perhaps a few extra kilobytes of memory don't matter much in your case.</p>\n"}], "owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 45046353, "answer_count": 1, "score": 0, "last_activity_date": 1499818568, "creation_date": 1499816349, "question_id": 45046093, "link": "https://stackoverflow.com/questions/45046093/is-it-a-good-idea-to-use-a-list-of-bufio-scanner-for-files-to-be-read-later-in", "title": "Is it a good idea to use a list of *bufio.Scanner for files to be read later in golang?", "body": "<p>I have a list of delimited files to be read after I obtained their path. Instead of saving path as a string, I'm wondering can I simply store a list of *bufio.Scanner so those will be much easier to be read later (and code will be cleaner too)? Here is a quick example:</p>\n\n<pre><code>func main(){\n    scannerList := read(filenameList)\n    dowork(scannerList)\n}\n\nfunc read(filenameList []string) (scannerList []*bufio.Scanner){\n    for _, filename := range filenameList{\n        op, _ := os.Open(filename)\n        defer op.Close()\n        scanner := bufio.NewScanner(op)\n        scannerList = append(scannerList, scanner)\n    }\n    return\n}\n\nfunc dowork(scannerList []*bufio.Scanner){\n    for _, scanner := range scannerList{\n        for scanner.Scan(){\n            //read stuff\n        }\n        //do stuff\n    }\n}\n</code></pre>\n\n<p>My code similar to above example compiles, but I don't know if this is recommended (or works). Any comments? Thanks!</p>\n"}, {"tags": ["go", "boltdb"], "comments": [{"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "edited": false, "score": 1, "creation_date": 1499814797, "post_id": 45045839, "comment_id": 77065975, "body": "Just a thought for a workaround: <code>err = db.Find(&quot;Name&quot;, name, &amp;components, storm.Limit(1))</code>"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 1, "creation_date": 1499815085, "post_id": 45045839, "comment_id": 77066060, "body": "If you would like to keep <code>Name</code> as primary key, can you please remove the field <code>ID</code> from struct <code>Component</code> and try method <code>db.One</code>."}, {"owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "reply_to_user": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "edited": false, "score": 0, "creation_date": 1499817036, "post_id": 45045839, "comment_id": 77066512, "body": "@dave thank you, its a nice workaround!"}, {"owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1499817059, "post_id": 45045839, "comment_id": 77066519, "body": "@jeevatkm you were correct! I fixed in this way thank you!"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1499821435, "post_id": 45045839, "comment_id": 77067483, "body": "You&#39;re welcome."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1499978667, "post_id": 45045839, "comment_id": 77153671, "body": "@jeevatkm you should make this an answer so that the OP can accept to remove this question from the unanswered section."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1499980149, "post_id": 45045839, "comment_id": 77154424, "body": "@reticentroot Thanks, it&#39;s done. Now OP can accept the answer."}], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 2, "last_activity_date": 1499980083, "creation_date": 1499980083, "answer_id": 45090923, "question_id": 45045839, "link": "https://stackoverflow.com/questions/45045839/find-one-in-bolt/45090923#45090923", "title": "Find one in Bolt", "body": "<p>Drafting answer from my comment. </p>\n\n<p>Per library codebase, <code>ID</code> is getting in your way even though <code>Name</code> is defined as primary key.</p>\n\n<p>If you would like to keep <code>Name</code> as primary key, can you please remove the field <code>ID</code> from struct <code>Component</code> and then try method <code>db.One</code>.</p>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 45090923, "answer_count": 1, "score": 0, "last_activity_date": 1499980083, "creation_date": 1499814458, "question_id": 45045839, "link": "https://stackoverflow.com/questions/45045839/find-one-in-bolt", "title": "Find one in Bolt", "body": "<p>I have a Golang project and I am using Bolt as my Database. I found and started to use <a href=\"https://github.com/asdine/storm\" rel=\"nofollow noreferrer\">This project</a> to handle the connection and operations over the database. My current problem is that I cannot make a search by one field and get one result.</p>\n\n<p>My struct definition in Golang is:</p>\n\n<pre><code>type Component struct {\n    ID          int      `storm:\"increment\"`\n    Name        string   `storm:\"id,unique\"` // primary key\n    Cars        []string `storm:\"index\"`  // this field will be indexed\n    Houses      []string `storm:\"index\"`  // this field will be indexed\n    Pets        []string `storm:\"index\"`  // this field will be indexed\n    Children    []string `storm:\"index\"`  // this field will be indexed\n    Level       int\n}\n</code></pre>\n\n<p>At first, I know is strange to have one field ID and a field Name with the tag <em>id</em>, the thing is that I want the name as the id and possibly as the key. I made some inserts and everything is ok, I even retrieved all the values and it worked perfectly.\nNow, I want to get one element by his name, I have this:</p>\n\n<pre><code>name := \"someComponent\"\nvar component models.Component\nerr := db.One(\"Name\", name, &amp;component)\n</code></pre>\n\n<p>But it returns <code>not found</code> but I know that a component is stored with that name. In other hand, if I make the search with <code>Find</code> I get the element, but that command is to return many results, and I want only one, I have this:</p>\n\n<pre><code>var components []models.Component\nerr := db.Find(\"Name\", name, &amp;components)\n</code></pre>\n"}, {"tags": ["docker", "go", "hyperledger-fabric", "hyperledger"], "comments": [{"owner": {"reputation": 38497, "user_id": 104014, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3d186f3c6ad2de59b356c1cfad9af404?s=128&d=identicon&r=PG", "display_name": "Artem Barger", "link": "https://stackoverflow.com/users/104014/artem-barger"}, "edited": false, "score": 1, "creation_date": 1499814367, "post_id": 45045152, "comment_id": 77065854, "body": "Well, I&#39;d suggest to report such issues into bug tracker: <a href=\"https://jira.hyperledger.org/secure/Dashboard.jspa\" rel=\"nofollow noreferrer\">jira.hyperledger.org/secure/Dashboard.jspa</a>, for now opened a JIRA tickets: <a href=\"https://jira.hyperledger.org/browse/FAB-5282\" rel=\"nofollow noreferrer\">jira.hyperledger.org/browse/FAB-5282</a>"}], "answers": [{"tags": [], "owner": {"reputation": 38497, "user_id": 104014, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3d186f3c6ad2de59b356c1cfad9af404?s=128&d=identicon&r=PG", "display_name": "Artem Barger", "link": "https://stackoverflow.com/users/104014/artem-barger"}, "is_accepted": false, "score": 5, "last_activity_date": 1499814660, "creation_date": 1499814660, "answer_id": 45045866, "question_id": 45045152, "link": "https://stackoverflow.com/questions/45045152/hyperledger-fabric-build-error/45045866#45045866", "title": "Hyperledger fabric build error", "body": "<p>Try to run: </p>\n\n<p><code>make peer orderer peer-docker orderer-docker tools-docker configtxgen cryptogen</code>, </p>\n\n<p>instead. This will skip license validation part and will allow you to build necessary building blocks.</p>\n\n<p>PS. Meanwhile I've opened a <a href=\"https://jira.hyperledger.org/browse/FAB-5282\" rel=\"noreferrer\">JIRA</a>  to get it fixed and <a href=\"https://gerrit.hyperledger.org/r/#/c/11577/\" rel=\"noreferrer\">change request</a>: with actual fix.</p>\n"}, {"tags": [], "owner": {"reputation": 983, "user_id": 6499004, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I0fHv3jbsbs/AAAAAAAAAAI/AAAAAAAADUo/bejrpeXzWwg/photo.jpg?sz=128", "display_name": "mahima", "link": "https://stackoverflow.com/users/6499004/mahima"}, "is_accepted": false, "score": 2, "last_activity_date": 1527835116, "creation_date": 1527835116, "answer_id": 50637458, "question_id": 45045152, "link": "https://stackoverflow.com/questions/45045152/hyperledger-fabric-build-error/50637458#50637458", "title": "Hyperledger fabric build error", "body": "<p>Go to the following files</p>\n\n<pre><code>orderer/multichain/manager.go\norderer/multichain/manager_test.go\n</code></pre>\n\n<p>Add the following lines in the beginning</p>\n\n<pre><code>/*\nCopyright IBM Corp. All Rights Reserved.\n\nSPDX-License-Identifier: Apache-2.0\n*/\n</code></pre>\n\n<p>You can also check if the error is resolved by running following command from fabric</p>\n\n<pre><code>make license\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 10879445, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-30MIMfenZvE/AAAAAAAAAAI/AAAAAAAAiGI/hFmKy3-saXM/photo.jpg?sz=128", "display_name": "Nguy\u1ec5n Ti\u1ebfn B\u1ed9", "link": "https://stackoverflow.com/users/10879445/nguy%e1%bb%85n-ti%e1%ba%bfn-b%e1%bb%99"}, "is_accepted": false, "score": 0, "last_activity_date": 1548661508, "creation_date": 1548661508, "answer_id": 54397511, "question_id": 45045152, "link": "https://stackoverflow.com/questions/45045152/hyperledger-fabric-build-error/54397511#54397511", "title": "Hyperledger fabric build error", "body": "<p>You should use \n <code>make release</code>\n and then <code>make docker</code></p>\n"}], "owner": {"reputation": 21, "user_id": 6715778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d2aa2fb2537053371ff597080decdb0?s=128&d=identicon&r=PG&f=1", "display_name": "Balaji", "link": "https://stackoverflow.com/users/6715778/balaji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1154, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1548661508, "creation_date": 1499810427, "last_edit_date": 1523964114, "question_id": 45045152, "link": "https://stackoverflow.com/questions/45045152/hyperledger-fabric-build-error", "title": "Hyperledger fabric build error", "body": "<p>I have followed the installation &amp; configuration of hyperledger fabric from <a href=\"http://hyperledger-fabric.readthedocs.io\" rel=\"nofollow noreferrer\">http://hyperledger-fabric.readthedocs.io</a> and completed the installation. When I tried to build it I am getting error. Could you let me know the resolution. </p>\n\n<p>To build Hyperledger Fabric:</p>\n\n<pre><code>cd $GOPATH/src/github.com/hyperledger/fabric\nmake dist-clean all\n</code></pre>\n\n<p>Error output:</p>\n\n<pre><code>docker tag hyperledger/fabric-tools hyperledger/fabric-tools:x86_64-1.0.0-rc2-snapshot-4709b33\nChecking committed files for SPDX-License-Identifier headers ...\nThe following files are missing SPDX-License-Identifier headers:\norderer/multichain/manager.go\norderer/multichain/manager_test.go\n\nPlease replace the Apache license header comment text with:\nSPDX-License-Identifier: Apache-2.0\nMakefile:111: recipe for target 'license' failed\nmake: *** [license] Error 1\n</code></pre>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 5142, "user_id": 169252, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f87a0e2badc0703de4d0a171a9bb4fa5?s=128&d=identicon&r=PG&f=1", "display_name": "transient_loop", "link": "https://stackoverflow.com/users/169252/transient-loop"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1499807674, "post_id": 45044434, "comment_id": 77063535, "body": "ok @CeriseLim&#243;n but otherwise keep the function asIs?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1499807944, "post_id": 45044434, "comment_id": 77063657, "body": "Technically this is a little off-topic for SO being more of a code review request than a specific question, but... I answered it anyway."}], "answers": [{"comments": [{"owner": {"reputation": 5142, "user_id": 169252, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f87a0e2badc0703de4d0a171a9bb4fa5?s=128&d=identicon&r=PG&f=1", "display_name": "transient_loop", "link": "https://stackoverflow.com/users/169252/transient-loop"}, "edited": false, "score": 0, "creation_date": 1499807983, "post_id": 45044580, "comment_id": 77063674, "body": "aaaaah this looks quite more <code>go</code>-ian! Thanks, I&#39;ll work through this"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1499807705, "creation_date": 1499807705, "answer_id": 45044580, "question_id": 45044434, "link": "https://stackoverflow.com/questions/45044434/go-filter-events-in-select-and-break/45044580#45044580", "title": "go: filter events in select and break", "body": "<p>If <code>activeFilters</code> is a <code>map</code>, you don't need to iterate it to find a key - that's the whole point of a <code>map</code>. You can just:</p>\n\n<pre><code>if v,ok := activeFilters[event.Msg.Namepace]; ok {\n    // range over v as you are now\n} else {\n    // event.Msg.Namepace does not exist in the map\n}\n</code></pre>\n\n<p>This eliminates one loop, and thus one <code>break</code>. The last <code>break</code> (BREAK 3) works but isn't particularly clear what it's doing; I'd make it a conditional to make it more readable:</p>\n\n<pre><code>if matches {\n    if err := sendEvent(event); err != nil {\n        sendErr(err)\n        return\n    }\n}\n</code></pre>\n\n<p><code>return</code> would not close the channel (assuming there's another reference to it somewhere else, which there would have to be for this to work at all), but it would exit your loop, so no further messages would be processed. I'd also double-check that the return in the error case is really what you want; typically in these situations you'd log the error but keep handling future messages that come over the channel.</p>\n"}], "owner": {"reputation": 5142, "user_id": 169252, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f87a0e2badc0703de4d0a171a9bb4fa5?s=128&d=identicon&r=PG&f=1", "display_name": "transient_loop", "link": "https://stackoverflow.com/users/169252/transient-loop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499807705, "creation_date": 1499807095, "question_id": 45044434, "link": "https://stackoverflow.com/questions/45044434/go-filter-events-in-select-and-break", "title": "go: filter events in select and break", "body": "<p>This is the code I have so far:</p>\n\n<pre><code>for {\n    select {\n    case event := &lt;-events:\n        if event.Msg != nil &amp;&amp; len(activeFilters) &gt; 0 {\n            //filter for messages\n            matches := false\n            for k, v := range activeFilters {\n                if k == event.Msg.Namepace {                        \n                  for _, code := range v {\n                    if code != event.Msg.Code {\n                        matches = true    \n                        break //BREAK1\n                    }\n                  }\n                  if matches {\n                    break //BREAK2\n                  }\n                }\n            }\n            if !matches {\n              break //BREAK3\n            }\n        }\n        if err := sendEvent(event); err != nil {\n            sendErr(err)\n            return\n        }\n    case &lt;-closed:\n        return\n    }\n}\n</code></pre>\n\n<p>First, I am a beginner in Go. The above code generally looks too complex for me, I guess it can be optimized.</p>\n\n<p>What I want to do: when an event arrives, I want to check if a given Code is inside a list of filters. The filters have two \"dimensions\": a namespace and a list of codes. <code>activeFilters</code> is a <code>map[string][]uint64</code>.\n(Note: I am allowed to redesign <code>activeFilters</code> to some other structure).</p>\n\n<p>So I just want to prevent the code to execute <code>sendEvent</code> if the filter doesn't match, while <code>sendEvent</code> should be executed if the protocol matches any key in <code>activeFilters</code> AND the message code is contained in the value array for that key.</p>\n\n<p>So can the above code be simplified? Is the usage of <code>break</code> (BREAK1 and BREAK2) correct? BREAK2 seems to be needed for me because the inner <code>for</code> loop may already find a match, in which case there's no need to continue iterating on <code>activeFilters</code>.</p>\n\n<p>And finally, am I correct in using BREAK3? My thinking there is that if there is no match, I do not want to execute <code>sendEvent</code>, so I want to jump out of the <code>case</code>. In my limited <code>Go</code> understanding, using <code>return</code> there would close the channel or something like that....</p>\n\n<p>:blush</p>\n"}, {"tags": ["mysql", "go", "sqlx"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1499794974, "post_id": 45040319, "comment_id": 77056713, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/29341590/go-parse-time-from-database\">Go Parse Time From Database</a>"}], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 2989208, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0wOpq.jpg?s=128&g=1", "display_name": "VapoRizer", "link": "https://stackoverflow.com/users/2989208/vaporizer"}, "edited": false, "score": 0, "creation_date": 1549495725, "post_id": 45040724, "comment_id": 95927115, "body": "It is also possible to add a custom time type with a custom scanner if your driver does not support time parsing or for other reasons: <a href=\"https://github.com/mattn/go-sqlite3/issues/190#issuecomment-343341834\" rel=\"nofollow noreferrer\">github.com/mattn/go-sqlite3/issues/190#issuecomment-34334183&zwnj;&#8203;4</a>"}, {"owner": {"reputation": 147, "user_id": 9837017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TU1Rw.jpg?s=128&g=1", "display_name": "Austin B", "link": "https://stackoverflow.com/users/9837017/austin-b"}, "edited": false, "score": 2, "creation_date": 1589909759, "post_id": 45040724, "comment_id": 109478664, "body": "Fantastic! @Karlom, this saved me a ton of time!"}], "tags": [], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "is_accepted": true, "score": 122, "last_activity_date": 1499792831, "creation_date": 1499792831, "answer_id": 45040724, "question_id": 45040319, "link": "https://stackoverflow.com/questions/45040319/unsupported-scan-storing-driver-value-type-uint8-into-type-time-time/45040724#45040724", "title": "unsupported Scan, storing driver.Value type []uint8 into type *time.Time", "body": "<p>Alright, I found the solution, thanks <a href=\"https://stackoverflow.com/a/29343013/5774375\">this</a> answer.\nThe problem goes by adding <code>?parseTime=true</code> to the db mapper. Like this:</p>\n\n<pre><code>db, err := sqlx.Connect(\"mysql\", \"myuser:mypass@tcp(127.0.0.1:3306)/mydb?parseTime=true\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 571, "user_id": 9143443, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9gW9jeOAO2M/AAAAAAAAAAI/AAAAAAAADaE/SucnYmqUrfI/photo.jpg?sz=128", "display_name": "superup", "link": "https://stackoverflow.com/users/9143443/superup"}, "is_accepted": false, "score": 3, "last_activity_date": 1587089707, "last_edit_date": 1587089707, "creation_date": 1578567228, "answer_id": 59662351, "question_id": 45040319, "link": "https://stackoverflow.com/questions/45040319/unsupported-scan-storing-driver-value-type-uint8-into-type-time-time/59662351#59662351", "title": "unsupported Scan, storing driver.Value type []uint8 into type *time.Time", "body": "<p>In my case, I'm change </p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"root:@/?parseTime=true\")\n</code></pre>\n\n<p>Is resolve problem.</p>\n"}, {"tags": [], "owner": {"reputation": 1693, "user_id": 5731861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKaMT.png?s=128&g=1", "display_name": "Felipe Valdes", "link": "https://stackoverflow.com/users/5731861/felipe-valdes"}, "is_accepted": false, "score": 1, "last_activity_date": 1597403685, "creation_date": 1597403685, "answer_id": 63411698, "question_id": 45040319, "link": "https://stackoverflow.com/questions/45040319/unsupported-scan-storing-driver-value-type-uint8-into-type-time-time/63411698#63411698", "title": "unsupported Scan, storing driver.Value type []uint8 into type *time.Time", "body": "<p>In my case, I had a similar problem but for my particular usecase, it was a struct with a select which didn't work, since I only needed to select data, then I proceeded to simply:</p>\n<p>change the data type from <code>time.Time</code> to <code>string</code></p>\n<p>This solved my problem, and I was able to get the data from the database.\nSo perhaps it is not the best solution, but this is what worked for me.</p>\n<p>Mr Karlom's solution also worked for me, this is just an alternative method.</p>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20148, "favorite_count": 11, "accepted_answer_id": 45040724, "answer_count": 3, "score": 45, "last_activity_date": 1597403685, "creation_date": 1499791531, "last_edit_date": 1499799568, "question_id": 45040319, "link": "https://stackoverflow.com/questions/45040319/unsupported-scan-storing-driver-value-type-uint8-into-type-time-time", "title": "unsupported Scan, storing driver.Value type []uint8 into type *time.Time", "body": "<p>I have difficulty querieing for users, which is defined as:</p>\n\n<pre><code>type User struct {\n    ID           int       `db:\"id\" json:\"id\"`            \n    UserName     string    `db:\"username\" json:\"username\"` \n    Email        string    `db:\"email\" json:\"email\"`\n    CreatedAt    time.Time `db:\"created_at\" json:\"created_at\"`\n    StatusID     uint8     `db:\"status_id\" json:\"status_id\"`\n    Deleted      uint8     `db:\"deleted\" json:\"deleted\"`\n... \n}\n</code></pre>\n\n<p>And the table in MariaDB is defined as:</p>\n\n<pre><code>+--------------+------------------+------+-----+-------------------+----------------+\n| Field        | Type             | Null | Key | Default           | Extra          |\n+--------------+------------------+------+-----+-------------------+----------------+\n| id           | int(10) unsigned | NO   | PRI | NULL              | auto_increment |\n| username     | varchar(50)      | NO   |     | NA                |                |\n| email        | varchar(255)     | NO   |     | NULL              |                |\n| created_at   | datetime         | NO   |     | CURRENT_TIMESTAMP |                |\n| status_id    | tinyint(1)       | NO   |     | 0                 |                |\n| deleted      | tinyint(1)       | NO   |     | 0                 |                |\n...              |\n</code></pre>\n\n<p>However when I query it like:</p>\n\n<pre><code>func GetUsers(c *gin.Context) {\n    var users []model.User\n    err := shared.Dbmap.Select(&amp;users, \"SELECT * FROM user\")\n\n    if err == nil {\n        c.JSON(200, users)\n    } else {\n        fmt.Println(\"%v \\n\", err)\n        c.JSON(http.StatusInternalServerError, gin.H{\"error\": \"no user(s) in the table or problem in the query\"})\n    }\n\n    // curl -i http://127.0.0.1:8080/api/v1/users\n}\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>sql: Scan error on column index 3: unsupported Scan, storing driver.Value type []uint8 into type *time.Time\n</code></pre>\n\n<p>while there are some rows in the table. </p>\n\n<p>I have also tried <code>created_at</code> as  <code>timestamp</code> but still get the same error.</p>\n\n<p>So I'm left clueless as what wrong here? How can I fix it? </p>\n\n<p><strong>P.S.</strong> Though my question turned out to have the same answer as <a href=\"https://stackoverflow.com/questions/29341590/go-parse-time-from-database\">this</a> but here the context is different (<code>sqlx</code> instead of <code>go-sql-driver/mysql</code>). Also since here the error is the subject it probably more searchable for people who google the same error. So perhaps this worth keeping as a separate question. </p>\n"}, {"tags": ["mysql", "go", "sqlx"], "comments": [{"owner": {"reputation": 364, "user_id": 1347798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GF6yJ.jpg?s=128&g=1", "display_name": "ipaul", "link": "https://stackoverflow.com/users/1347798/ipaul"}, "edited": false, "score": 1, "creation_date": 1499787541, "post_id": 45038968, "comment_id": 77052078, "body": "Have you tried replacing fmt.Println with fmt.Printf(&quot;%v&quot;, err) to make sure you&#39;re getting the error you think you&#39;re getting?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1499787552, "post_id": 45038968, "comment_id": 77052090, "body": "Check the number of rows in the result."}, {"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "reply_to_user": {"reputation": 364, "user_id": 1347798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GF6yJ.jpg?s=128&g=1", "display_name": "ipaul", "link": "https://stackoverflow.com/users/1347798/ipaul"}, "edited": false, "score": 0, "creation_date": 1499788147, "post_id": 45038968, "comment_id": 77052533, "body": "@ipaul I get this error: <code>sql: Scan error on column index 4: unsupported Scan, storing driver.Value type []uint8 into type *time.Time </code>"}, {"owner": {"reputation": 1853, "user_id": 6232665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41eeea507e28cddc2bc1efc3b2b73c45?s=128&d=identicon&r=PG&f=1", "display_name": "zenwraight", "link": "https://stackoverflow.com/users/6232665/zenwraight"}, "edited": false, "score": 0, "creation_date": 1499797822, "post_id": 45038968, "comment_id": 77058366, "body": "@Karlom what is the variable name that reference to the DB object, is it shared ?"}, {"owner": {"reputation": 364, "user_id": 1347798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GF6yJ.jpg?s=128&g=1", "display_name": "ipaul", "link": "https://stackoverflow.com/users/1347798/ipaul"}, "edited": false, "score": 0, "creation_date": 1499798819, "post_id": 45038968, "comment_id": 77058984, "body": "@Karlom that looks like an issue between how your database encodes timestamps and how the timestamp is defined in your model.  Maybe related to <a href=\"https://github.com/go-sql-driver/mysql/issues/29\" rel=\"nofollow noreferrer\">github.com/go-sql-driver/mysql/issues/29</a>?"}, {"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "reply_to_user": {"reputation": 364, "user_id": 1347798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GF6yJ.jpg?s=128&g=1", "display_name": "ipaul", "link": "https://stackoverflow.com/users/1347798/ipaul"}, "edited": false, "score": 0, "creation_date": 1499799362, "post_id": 45038968, "comment_id": 77059289, "body": "@ipaul, yes, actually I resolved it here: <a href=\"https://stackoverflow.com/questions/45040319/unsupported-scan-storing-driver-value-type-uint8-into-type-time-time\" title=\"unsupported scan storing driver value type uint8 into type time time\">stackoverflow.com/questions/45040319/&hellip;</a>. You can answer and I&#39;ll accept. Thanks for your tip."}, {"owner": {"reputation": 653, "user_id": 1714914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1b5720b00d962dfc0aad936e2f3d6fd0?s=128&d=identicon&r=PG", "display_name": "ralixyle", "link": "https://stackoverflow.com/users/1714914/ralixyle"}, "edited": false, "score": 0, "creation_date": 1532436950, "post_id": 45038968, "comment_id": 89966294, "body": "To check if it returns no rows this would help  <code>err == sql.ErrNoRows</code>"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 689, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499787425, "creation_date": 1499787425, "question_id": 45038968, "link": "https://stackoverflow.com/questions/45038968/how-to-check-whether-a-row-exists-using-sqlx", "title": "How to check whether a row exists using sqlx?", "body": "<p>I want this fuction to return true of a row containing the <code>email</code> is found in the database. Here is the code</p>\n\n<pre><code>func UserExists(email string) bool {\n    var err error\n    user := model.User{}\n    err = shared.Dbmap.Get(&amp;user, \"SELECT * FROM user WHERE email=? LIMIT 1\", email)\n    if err == nil {\n        fmt.Println(\"User is already in DB\")\n        return true\n    } else {\n        fmt.Println(\"No rows returned\")\n        return false\n    }\n}\n</code></pre>\n\n<p>However, it always returns <code>false</code> even if there is such email in the db, so clearly the query is not up to the job. How can I fix this?</p>\n"}, {"tags": ["function", "unit-testing", "go", "methods", "newrelic"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1499787162, "post_id": 45038621, "comment_id": 77051768, "body": "There is no &quot;right way&quot; to test. A one-second visual inspection proves they&#39;re being called in <code>main()</code>, which is sufficient to me, but YMMV."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 8291837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ae9db78e0ffcc280d27ca76927f0e1?s=128&d=identicon&r=PG&f=1", "display_name": "Justin McCarthy", "link": "https://stackoverflow.com/users/8291837/justin-mccarthy"}, "is_accepted": false, "score": 2, "last_activity_date": 1499804647, "creation_date": 1499804647, "answer_id": 45043859, "question_id": 45038621, "link": "https://stackoverflow.com/questions/45038621/how-do-i-test-that-specific-methods-are-being-called-in-the-main-function/45043859#45043859", "title": "How do I test that specific methods are being called in the main() function", "body": "<p>Are you hoping to test this from an automated test, or as a runtime assertion of some type?</p>\n\n<p>Assuming you're looking to add an automated test to your suite:</p>\n\n<p>You need to find a way to mock the functions exported by the NewRelic package. </p>\n\n<p>A very cheap way to do this is described here (\"Monkey Patching in Golang\"):</p>\n\n<p><a href=\"https://husobee.github.io/golang/testing/unit-test/2015/06/08/golang-unit-testing.html\" rel=\"nofollow noreferrer\">https://husobee.github.io/golang/testing/unit-test/2015/06/08/golang-unit-testing.html</a></p>\n\n<p>A more comprehensive approach requires you to add these function calls to a struct that can be swapped by your test suite. See dependency injection, as described here:</p>\n\n<p><a href=\"https://medium.com/@zach_4342/dependency-injection-in-golang-e587c69478a8\" rel=\"nofollow noreferrer\">https://medium.com/@zach_4342/dependency-injection-in-golang-e587c69478a8</a></p>\n\n<p>Finally, look into using a mocking framework. I've had great luck with the mocking in stretchr's testify project.</p>\n"}], "owner": {"reputation": 456, "user_id": 3338418, "user_type": "registered", "accept_rate": 10, "profile_image": "https://i.stack.imgur.com/uoCMC.jpg?s=128&g=1", "display_name": "Adi Sivasankaran", "link": "https://stackoverflow.com/users/3338418/adi-sivasankaran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1566, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1499804647, "creation_date": 1499786526, "question_id": 45038621, "link": "https://stackoverflow.com/questions/45038621/how-do-i-test-that-specific-methods-are-being-called-in-the-main-function", "title": "How do I test that specific methods are being called in the main() function", "body": "<p>I want to test whether <code>newrelic.NewConfig</code> and <code>newrelic.NewApplication</code> are being called in the <code>main()</code> function.</p>\n\n<pre><code>import (\n    \"github.com/newrelic/go-agent\"  \n)\n\nfunc main() {\n    /* NewRelic configuration */\n    newRelicConfig := newrelic.NewConfig(\"my-app-name\", \n    os.Getenv(\"NEW_RELIC_LICENSE_KEY\"))\n    app, err := newrelic.NewApplication(newRelicConfig)\n\n    // followed by other code\n}\n</code></pre>\n\n<p>Should I move that code into a separate function within the <code>main</code> package, like:</p>\n\n<pre><code>func SetupNewRelicConfig() Application {\n    newRelicConfig := newrelic.NewConfig(\"my-app-name\", \n    os.Getenv(\"NEW_RELIC_LICENSE_KEY\"))\n    app, err := newrelic.NewApplication(newRelicConfig)\n\n    if err != nil {\n      log.Fatal(err)\n    }\n\n    return app\n}\n</code></pre>\n\n<p>This way I can just check if the <code>SetupNewRelicConfig</code> is called or not.</p>\n\n<p><strong>What is the right way to test this?</strong></p>\n"}, {"tags": ["python", "ssl", "go", "https", "proxy"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1499784624, "post_id": 45037328, "comment_id": 77049795, "body": "Looks like the Go version will always issue &quot;CONNECT&quot; for HTTPS (<a href=\"https://golang.org/src/net/http/transport.go?s=10819:10884#L1030\" rel=\"nofollow noreferrer\">see source</a>) - I don&#39;t know much about HTTPS but if this is not standards-compliant behavior your might <a href=\"https://github.com/golang/go/issues\" rel=\"nofollow noreferrer\">submit a bug report</a>."}, {"owner": {"reputation": 615, "user_id": 1263968, "user_type": "registered", "accept_rate": 13, "profile_image": "https://www.gravatar.com/avatar/9df72d3e2f53016dea6bb563359483ed?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Soulier", "link": "https://stackoverflow.com/users/1263968/michael-soulier"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1499786141, "post_id": 45037328, "comment_id": 77050971, "body": "I think it used to be standards compliant but we&#39;re in the middle of a transition to pure SSL on proxies for HTTPS. Browser&#39;s support it, but I&#39;m not finding anything but the very latest libcurl that supports it."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1499786954, "post_id": 45037328, "comment_id": 77051593, "body": "If it&#39;s not standards-compliant then support will be spotty at best, unfortunately."}], "answers": [{"comments": [{"owner": {"reputation": 615, "user_id": 1263968, "user_type": "registered", "accept_rate": 13, "profile_image": "https://www.gravatar.com/avatar/9df72d3e2f53016dea6bb563359483ed?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Soulier", "link": "https://stackoverflow.com/users/1263968/michael-soulier"}, "edited": false, "score": 0, "creation_date": 1499786075, "post_id": 45037779, "comment_id": 77050921, "body": "Seems to display the same problem."}, {"owner": {"reputation": 53, "user_id": 4062575, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ptShtzE9L1s/AAAAAAAAAAI/AAAAAAAAABU/ded20ZwVJ4A/photo.jpg?sz=128", "display_name": "Jeffrey J", "link": "https://stackoverflow.com/users/4062575/jeffrey-j"}, "reply_to_user": {"reputation": 615, "user_id": 1263968, "user_type": "registered", "accept_rate": 13, "profile_image": "https://www.gravatar.com/avatar/9df72d3e2f53016dea6bb563359483ed?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Soulier", "link": "https://stackoverflow.com/users/1263968/michael-soulier"}, "edited": false, "score": 0, "creation_date": 1499786129, "post_id": 45037779, "comment_id": 77050962, "body": "For this line:  proxy = urllib2.ProxyHandler({&#39;https&#39;:&#39;&lt;https proxy host&gt;:443&#39;, &#39;http&#39;:&#39;&lt;http proxy host&gt;:8080&#39;})  Did you replace &lt;https proxy host&gt; and &lt;http proxy host&gt; with your own proxy implementation?"}, {"owner": {"reputation": 615, "user_id": 1263968, "user_type": "registered", "accept_rate": 13, "profile_image": "https://www.gravatar.com/avatar/9df72d3e2f53016dea6bb563359483ed?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Soulier", "link": "https://stackoverflow.com/users/1263968/michael-soulier"}, "edited": false, "score": 0, "creation_date": 1499789872, "post_id": 45037779, "comment_id": 77053652, "body": "Yes. I&#39;ll double-check with a packet trace but I think it&#39;s still connecting in the clear."}, {"owner": {"reputation": 615, "user_id": 1263968, "user_type": "registered", "accept_rate": 13, "profile_image": "https://www.gravatar.com/avatar/9df72d3e2f53016dea6bb563359483ed?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Soulier", "link": "https://stackoverflow.com/users/1263968/michael-soulier"}, "edited": false, "score": 0, "creation_date": 1499790223, "post_id": 45037779, "comment_id": 77053862, "body": "Yes, the server isn&#39;t even seeing an SSL handshake, it immediately attempts an SSL CONNECT in the clear."}, {"owner": {"reputation": 615, "user_id": 1263968, "user_type": "registered", "accept_rate": 13, "profile_image": "https://www.gravatar.com/avatar/9df72d3e2f53016dea6bb563359483ed?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Soulier", "link": "https://stackoverflow.com/users/1263968/michael-soulier"}, "edited": false, "score": 0, "creation_date": 1499820110, "post_id": 45037779, "comment_id": 77067168, "body": "Yes, connection reset. In the end, I had to use sockets directly to make this work. It seems that the http libraries won&#39;t establish an SSL proxy connection immediately."}], "tags": [], "owner": {"reputation": 53, "user_id": 4062575, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ptShtzE9L1s/AAAAAAAAAAI/AAAAAAAAABU/ded20ZwVJ4A/photo.jpg?sz=128", "display_name": "Jeffrey J", "link": "https://stackoverflow.com/users/4062575/jeffrey-j"}, "is_accepted": false, "score": 0, "last_activity_date": 1499784179, "creation_date": 1499784179, "answer_id": 45037779, "question_id": 45037328, "link": "https://stackoverflow.com/questions/45037328/https-through-proxy-completely-encrypted-including-ssl-connect/45037779#45037779", "title": "HTTPS through proxy completely encrypted, including SSL CONNECT", "body": "<p>A possible resolution to this issue using Python standard libraries in addition to the ProxyHandler you have:</p>\n\n<pre><code>import ssl, urllib2\n\n# Set ciphers and ssl settings\nctx = ssl.create_default_context()\nctx.check_hostname = False\nctx.verify_mode = ssl.CERT_NONE\nctx.set_ciphers('HIGH:!DH:!aNULL')\n\n# Set proxy settings\nproxy = urllib2.ProxyHandler({'https':'&lt;https proxy host&gt;:443', 'http':'&lt;http proxy host&gt;:8080'})\nopener = urllib2.build_opener(urllib2.HTTPSHandler(context=ctx), proxy)\nurllib2.install_opener(opener)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 615, "user_id": 1263968, "user_type": "registered", "accept_rate": 13, "profile_image": "https://www.gravatar.com/avatar/9df72d3e2f53016dea6bb563359483ed?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Soulier", "link": "https://stackoverflow.com/users/1263968/michael-soulier"}, "is_accepted": false, "score": 0, "last_activity_date": 1503936170, "creation_date": 1503936170, "answer_id": 45923086, "question_id": 45037328, "link": "https://stackoverflow.com/questions/45037328/https-through-proxy-completely-encrypted-including-ssl-connect/45923086#45923086", "title": "HTTPS through proxy completely encrypted, including SSL CONNECT", "body": "<p>In the end I had to do my own client, essentially.</p>\n\n<pre><code>func http_fetch(req_host string) {\n    buf := make([]byte, 1024)\n    conf := &amp;tls.Config {\n        InsecureSkipVerify: true,\n    }   \n\n    conn, err := tls.Dial(\"tcp\", proxy_host, conf)\n    if err != nil {\n        //panic(err)\n        failure()\n        return\n    }   \n    defer conn.Close()\n\n    // SSL CONNECT\n    if _, err = conn.Write([]byte(\"CONNECT \" + req_host + \" HTTP/1.0\\r\\n\\r\\n\")); err != nil {\n        // FIXME: need debug logger?\n        //panic(err)\n        failure()\n        return\n    }   \n\n    // Read response\n    if _, err = conn.Read(buf); err != nil {\n        //panic(err)\n        failure()\n        return\n    }   \n\n    // Send http GET\n    if _, err = conn.Write([]byte(\"GET / HTTP/1.0\\r\\n\")); err != nil {\n        //panic(err)\n        failure()\n        return\n    }   \n    if _, err = conn.Write([]byte(\"User-Agent: golang\\r\\n\\r\\n\")); err != nil {\n        //panic(err)\n        failure()\n        return\n    }   \n\n    // Read response\n    if _, err = conn.Read(buf); err != nil {\n        //panic(err)\n        failure()\n        return\n    }   \n    success()\n}   \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4456, "user_id": 4127569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b728c7d6c1dce81f5a82249b7617756?s=128&d=identicon&r=PG&f=1", "display_name": "jch", "link": "https://stackoverflow.com/users/4127569/jch"}, "is_accepted": false, "score": 1, "last_activity_date": 1517007582, "creation_date": 1517007582, "answer_id": 48470771, "question_id": 45037328, "link": "https://stackoverflow.com/questions/45037328/https-through-proxy-completely-encrypted-including-ssl-connect/48470771#48470771", "title": "HTTPS through proxy completely encrypted, including SSL CONNECT", "body": "<p>Using https proxies is only supported starting with Go 1.10.  From the <a href=\"https://tip.golang.org/doc/go1.10#net/http\" rel=\"nofollow noreferrer\">draft release notes</a>:</p>\n\n<blockquote>\n  <p>On the client side, an HTTP proxy (most commonly configured by\n  ProxyFromEnvironment) can now be specified as an https:// URL, meaning\n  that the client connects to the proxy over HTTPS before issuing a\n  standard, proxied HTTP request. (Previously, HTTP proxy URLs were\n  required to begin with http:// or socks5://.)</p>\n</blockquote>\n"}], "owner": {"reputation": 615, "user_id": 1263968, "user_type": "registered", "accept_rate": 13, "profile_image": "https://www.gravatar.com/avatar/9df72d3e2f53016dea6bb563359483ed?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Soulier", "link": "https://stackoverflow.com/users/1263968/michael-soulier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "answer_count": 3, "score": 7, "last_activity_date": 1517007582, "creation_date": 1499783123, "question_id": 45037328, "link": "https://stackoverflow.com/questions/45037328/https-through-proxy-completely-encrypted-including-ssl-connect", "title": "HTTPS through proxy completely encrypted, including SSL CONNECT", "body": "<p>I am trying to test a proxy that is expecting an SSL handshake immediately, even if the client is going to use an SSL CONNECT method. The problem is that my Golang and Python test code both seem to have the same flaw. They connect to the proxy in the clear, and then issue a CONNECT, but the proxy rejects this because it is expecting an SSL handshake.</p>\n\n<p>Does anyone know how to force either technology to use SSL to the proxy using available standard libraries?</p>\n\n<p>Thanks. </p>\n\n<p>Sample code follows:</p>\n\n<pre><code>#!/usr/bin/python\n\ntry:\n    import urllib2\n\n    proxy = urllib2.ProxyHandler({'https': \"myproxyip:6881\"})\n    opener = urllib2.build_opener(proxy)\n    urllib2.install_opener(opener)\n    print urllib2.urlopen('https://www.google.ca').read()\n\nexcept Exception as err:\n    print err\n\n\ntry:\n    import httplib\n\n    c = httplib.HTTPSConnection('myproxyip', 6881)\n    c.set_tunnel('google.ca', 443)\n    c.request('GET', '/')\n    res = c.getresponse()\n    print res.status, res.reason\n\nexcept Exception as err:\n    print err\n</code></pre>\n\n<p>and golang</p>\n\n<pre><code>// vim: ft=go ts=4 sw=4 et ai:\npackage main\n\nimport (\n    \"net/http\"\n    \"log\"\n    \"io/ioutil\"\n    \"time\"\n    \"crypto/tls\"\n    \"net/url\"\n    )\n\nvar use_proxy = true\nvar proxy = \"https://myproxyip:6881\"\nvar req_url = \"https://google.ca\"\nvar n_seconds time.Duration = 15\nvar period = time.Second * n_seconds\nvar n_threads = 50\nvar thread_start_delay time.Duration = 1\n\nfunc http_fetch(req_url string) {\n    tr := http.Transport {\n        TLSClientConfig: &amp;tls.Config {\n            InsecureSkipVerify: true,\n        },\n    }\n    proxy_url, err := url.Parse(proxy)\n    if err != nil {\n        log.Fatal(err)\n    }\n    if use_proxy {\n        tr.Proxy = http.ProxyURL(proxy_url)\n    }\n    client := &amp;http.Client{}\n    client.Transport = &amp;tr\n\n    req, err := http.NewRequest(\"GET\", req_url, nil)\n    if err != nil {\n        log.Fatal(err)\n    }\n    req.Header.Set(\"User-Agent\", \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36\")\n\n    res, err := client.Do(req)\n    if err != nil {\n        log.Fatal(err)\n    }\n    body, err := ioutil.ReadAll(res.Body)\n    defer res.Body.Close()\n    document := string(body)\n    print(document)\n}\n\n\nfunc main() {\n    println(\"main: Starting\", n_threads, \"threads to hammer\", req_url, \"every\", n_seconds, \"seconds, ctrl-c to quit...\")\n    done := make(&lt;-chan bool)\n    for i:= 0; i &lt; n_threads; i++ {\n        go func(thread_id int) {\n            println(\"thread\", thread_id, \": starting periodic_hammer\")\n            for {\n                println(\"thread\", thread_id, \": fetching\", req_url)\n                http_fetch(req_url)\n                println(\"thread\", thread_id, \": done, sleeping for\", n_seconds, \"seconds\")\n                time.Sleep(period)\n            }\n        }(i+1)\n        println(\"main: delaying\", thread_start_delay, \"seconds before starting next thread\")\n        time.Sleep(thread_start_delay * time.Second)\n    }\n    &lt;-done\n}\n</code></pre>\n"}, {"tags": ["python", "sockets", "networking", "go", "tcp"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 3897594, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ed0f6d7d01b9344b67a3b77796d64e14?s=128&d=identicon&r=PG&f=1", "display_name": "Skull1234567", "link": "https://stackoverflow.com/users/3897594/skull1234567"}, "edited": false, "score": 0, "creation_date": 1499793599, "post_id": 45039592, "comment_id": 77055944, "body": "Like I said in the description - I understand that it is not typical TCP, or even &#39;TCP&#39; at all technically, but it is a legitimate method of exfiltration if a network has UDP &amp; ICMP locked down with firewall rules, and monitoring established TCP connections. I need to know if it is possible to just send a packet if I manually craft the hex, without opening a raw socket (which requires admin)"}, {"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "reply_to_user": {"reputation": 75, "user_id": 3897594, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ed0f6d7d01b9344b67a3b77796d64e14?s=128&d=identicon&r=PG&f=1", "display_name": "Skull1234567", "link": "https://stackoverflow.com/users/3897594/skull1234567"}, "edited": false, "score": 0, "creation_date": 1499797909, "post_id": 45039592, "comment_id": 77058420, "body": "As I wrote, &quot;<i>The TCP module in your OS will not send data until a connection is established</i>&quot;"}, {"owner": {"reputation": 75, "user_id": 3897594, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ed0f6d7d01b9344b67a3b77796d64e14?s=128&d=identicon&r=PG&f=1", "display_name": "Skull1234567", "link": "https://stackoverflow.com/users/3897594/skull1234567"}, "edited": false, "score": 1, "creation_date": 1499800651, "post_id": 45039592, "comment_id": 77060019, "body": "I do not want a TCP module, I want to send a packet without a raw socket. With scapy, I can do it with: <code>scapy.send(scapy.IP(dst=&quot;x.x.x.x&quot;) &#47; scapy.TCP(dport=n) &#47; scapy.Raw(load=data)</code> This command gives me exactly what I need, however, this uses a raw socket for everything - which requires sudo. It does not require a connection to be established to send the packet with the payload."}], "tags": [], "owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "is_accepted": false, "score": 0, "last_activity_date": 1499789203, "creation_date": 1499789203, "answer_id": 45039592, "question_id": 45036882, "link": "https://stackoverflow.com/questions/45036882/how-to-send-a-custom-tcp-packet-without-sudo-without-three-way-handshake/45039592#45039592", "title": "How to send a custom &#39;TCP&#39; packet, without sudo - without three-way handshake", "body": "<p>TCP is a connection-oriented protocol. In order to establish a TCP connection, you <em>must</em> perform a three-way handshake. The TCP module in you OS will not send data until a connection is established, and any device receiving a TCP segment for a non-existent connection will ignore it.</p>\n\n<p>TCP without the connection is not TCP, but neither is it UDP. TCP and UDP have different protocol headers. You will notice that the TCP header has more fields than the UDP header, and many of those fields will be populated by information from the handshake.</p>\n\n<p><a href=\"https://tools.ietf.org/html/rfc793\" rel=\"nofollow noreferrer\"><em>RFC 793, Transmission Control Protocol</em></a>:</p>\n\n<blockquote>\n  <p>TCP Header Format</p>\n\n<pre><code> 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|          Source Port          |       Destination Port        |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                        Sequence Number                        |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                    Acknowledgment Number                      |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|  Data |           |U|A|P|R|S|F|                               |\n| Offset| Reserved  |R|C|S|S|Y|I|            Window             |\n|       |           |G|K|H|T|N|N|                               |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|           Checksum            |         Urgent Pointer        |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                    Options                    |    Padding    |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                             data                              |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                        TCP Header Format\n</code></pre>\n</blockquote>\n\n<p><a href=\"https://tools.ietf.org/html/rfc768\" rel=\"nofollow noreferrer\"><em>RFC 768, User Datagram Protocol</em></a>:</p>\n\n<blockquote>\n  <p>Format</p>\n\n<pre><code>              0      7 8     15 16    23 24    31\n             +--------+--------+--------+--------+\n             |     Source      |   Destination   |\n             |      Port       |      Port       |\n             +--------+--------+--------+--------+\n             |                 |                 |\n             |     Length      |    Checksum     |\n             +--------+--------+--------+--------+\n             |\n             |          data octets ...\n             +---------------- ...\n\n                  User Datagram Header Format\n</code></pre>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 3897594, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ed0f6d7d01b9344b67a3b77796d64e14?s=128&d=identicon&r=PG&f=1", "display_name": "Skull1234567", "link": "https://stackoverflow.com/users/3897594/skull1234567"}, "edited": false, "score": 0, "creation_date": 1499867560, "post_id": 45046394, "comment_id": 77092626, "body": "So to be clear, to the best of your knowledge, there is no way to send out a custom hex crafted packet without admin/sudo privileges? No function call that just says &#39;do not open a raw socket waiting for a response, just send this hex packet one way out&#39;?"}], "tags": [], "owner": {"reputation": 4456, "user_id": 4127569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b728c7d6c1dce81f5a82249b7617756?s=128&d=identicon&r=PG&f=1", "display_name": "jch", "link": "https://stackoverflow.com/users/4127569/jch"}, "is_accepted": false, "score": 4, "last_activity_date": 1499818878, "creation_date": 1499818878, "answer_id": 45046394, "question_id": 45036882, "link": "https://stackoverflow.com/questions/45036882/how-to-send-a-custom-tcp-packet-without-sudo-without-three-way-handshake/45046394#45046394", "title": "How to send a custom &#39;TCP&#39; packet, without sudo - without three-way handshake", "body": "<p>In short \u2014 you cannot, at least not under Linux.</p>\n\n<p>You are trying to send a packet without obeying TCP's state machine.  The kernel will not allow you to do that without using a packet socket (either directly or through a library such as <code>pcap</code> or <code>scapy</code>), and raw sockets require the <code>CAP_NET_RAW</code> capability, which is normally only granted to the superuser.</p>\n"}], "owner": {"reputation": 75, "user_id": 3897594, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ed0f6d7d01b9344b67a3b77796d64e14?s=128&d=identicon&r=PG&f=1", "display_name": "Skull1234567", "link": "https://stackoverflow.com/users/3897594/skull1234567"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1193, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499818878, "creation_date": 1499782048, "last_edit_date": 1499792502, "question_id": 45036882, "link": "https://stackoverflow.com/questions/45036882/how-to-send-a-custom-tcp-packet-without-sudo-without-three-way-handshake", "title": "How to send a custom &#39;TCP&#39; packet, without sudo - without three-way handshake", "body": "<p>I am trying to send a TCP (and later an ICMP) packet that does not use raw sockets, does not go through the three-way handshake, and does not use sudo. I have tried various methods in python's scapy module, and in python's socket module, without success.  </p>\n\n<p>I understand that without the three-way handshake, TCP isn't necessarily TCP - it is basically UDP, but I am testing various ways to exfiltrate data from a network, that may go undetected.  </p>\n\n<p>Basically this is the working UDP version, I need working ICMP and TCP versions that do not use a raw socket, and therefore do not require admin/root privileges. </p>\n\n<p>A solution in GO or Python is preferable, ideally I need to run on MacOS, Linux, and (mainly) Windows.</p>\n\n<pre><code>UDP_IP = \"127.0.0.1\"\nUDP_PORT = 5005\nMESSAGE = \"Data to exfiltrate\"\n\nsock = socket.socket(socket.AF_INET, # Internet\n             socket.SOCK_DGRAM) # UDP\nsock.sendto(MESSAGE, (UDP_IP, UDP_PORT))\n</code></pre>\n"}, {"tags": ["mysql", "go", "go-gorm"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1499822787, "post_id": 45035290, "comment_id": 77067830, "body": "My advice not to use Timestamp as primary key in MySQL. It cannot be guaranteed to be unique, it could cause <a href=\"https://bugs.mysql.com/bug.php?id=8523\" rel=\"nofollow noreferrer\">trouble</a> for you in MySQL; because timestamps are stored with only 1-second precision.   Use BIGINT for primary key and add index to Timestamp column."}, {"owner": {"reputation": 1236, "user_id": 1221253, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c05edd2a49079a60ee18c6609dc44e10?s=128&d=identicon&r=PG&f=1", "display_name": "Dina", "link": "https://stackoverflow.com/users/1221253/dina"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1499939924, "post_id": 45035290, "comment_id": 77126999, "body": "I know, and I wrote that in my question. But my focus is understanding how to use gorm. If I know how to create such a schema using SQL I want to understand how to do it using gorm."}], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": false, "score": 0, "last_activity_date": 1499970871, "creation_date": 1499970871, "answer_id": 45088553, "question_id": 45035290, "link": "https://stackoverflow.com/questions/45035290/inserting-field-which-is-both-primarykey-and-default-using-gorm-to-mysql/45088553#45088553", "title": "Inserting field which is both PrimaryKey and DEFAULT using gorm to MySQL", "body": "<p>After comment interaction, drafting this answer.</p>\n\n<blockquote>\n  <p>I'm guessing that it has a problem with the default time ('0001-01-01 00:00:00 +0000 UTC') which is created when I don't specify it exactly.</p>\n</blockquote>\n\n<p>The reason is, in Go data type has zero value, <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow noreferrer\">spec</a> and good read <a href=\"https://dave.cheney.net/2013/01/19/what-is-the-zero-value-and-why-is-it-useful\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>For you, possible way is to use appropriate <a href=\"http://jinzhu.me/gorm/callbacks.html\" rel=\"nofollow noreferrer\">gorm callbacks</a> to set or modify struct fields on before or after database interactions.</p>\n"}], "owner": {"reputation": 1236, "user_id": 1221253, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c05edd2a49079a60ee18c6609dc44e10?s=128&d=identicon&r=PG&f=1", "display_name": "Dina", "link": "https://stackoverflow.com/users/1221253/dina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 626, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527757198, "creation_date": 1499777876, "last_edit_date": 1527757198, "question_id": 45035290, "link": "https://stackoverflow.com/questions/45035290/inserting-field-which-is-both-primarykey-and-default-using-gorm-to-mysql", "title": "Inserting field which is both PrimaryKey and DEFAULT using gorm to MySQL", "body": "<p>I want to have a table whose primary key is an auto-generated timestamp (I know it's generally not the best idea, but in my case it's OK) and it has another string field. This is the data structure that I use:</p>\n\n<pre><code>type GlobalDefault struct {\n    Timestamp       time.Time           `gorm:\"primary_key\" sql:\"DEFAULT:current_timestamp\"`\n    Version         string              `sql:\"not null\"`\n}\n</code></pre>\n\n<p>When I use this data structure with AutoMigrate I indeed get a table with the timestamp as primary key, and I can even run <code>insert into global_defaults (version) VALUES ('1.5.3');</code> and a new row would get inserted with an auto-generated timestamp.</p>\n\n<p>My problem is that I can't insert records into this table using gorm. I use the following function:</p>\n\n<pre><code>func (repository *AgentRepository)SetGlobalDefault(version string) error {\n    gd := GlobalDefault{ Version:version }\n    return repository.connection.Create(&amp;gd).Error\n}\n</code></pre>\n\n<p>And when I call it I get the following error:</p>\n\n<blockquote>\n  <p>Received unexpected error could not convert argument of field Timestamp from int64 to time.Time</p>\n</blockquote>\n\n<p>If I provide the timestamp explicitly, it works. I'm guessing that it has a problem with the default time ('0001-01-01 00:00:00 +0000 UTC') which is created when I don't specify it exactly.</p>\n\n<p>Is there a way around this?</p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 26792, "user_id": 734040, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/p1dqF.jpg?s=128&g=1", "display_name": "Decade Moon", "link": "https://stackoverflow.com/users/734040/decade-moon"}, "is_accepted": false, "score": 2, "last_activity_date": 1499777392, "creation_date": 1499777392, "answer_id": 45035128, "question_id": 45032773, "link": "https://stackoverflow.com/questions/45032773/best-practices-working-with-json-in-go/45035128#45035128", "title": "Best practices working with JSON in Go", "body": "<p>Go is a strongly typed programming language. There are no loose types like in JavaScript.</p>\n\n<p>If you want a strong data type for each message, then you'll need to write a struct for each type. Otherwise you can unmarshal the message into a <code>map[string]interface{}</code> (for \"generic\" JSON objects) and work with that instead (which will require type assertions to convert the <code>interface</code> values into strong types).</p>\n"}], "owner": {"reputation": 44, "user_id": 6045002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e648e36a62349560a7cdd136bc81e8a7?s=128&d=identicon&r=PG&f=1", "display_name": "woop", "link": "https://stackoverflow.com/users/6045002/woop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "closed_date": 1499778292, "answer_count": 1, "score": 0, "last_activity_date": 1499777392, "creation_date": 1499771129, "question_id": 45032773, "link": "https://stackoverflow.com/questions/45032773/best-practices-working-with-json-in-go", "closed_reason": "Opinion-based", "title": "Best practices working with JSON in Go", "body": "<p>I'm in the beginning of writing a chat app in Go and started wondering what is the best way working with JSON. I've read different articles and it seems like I have to create a different type for every action the client sends.</p>\n\n<p>Lets say there are three actions:</p>\n\n<pre><code>NewMessage\nDeleteMessage\nEditMessage\n</code></pre>\n\n<p>To my understanding I have to create three types that match these actions. Something like this:</p>\n\n<pre><code>type Message struct {\n    Action string `json:\"action\"`\n    Data map[string]*json.RawMessage `json:\"data\"`\n}\n\ntype MessageMeta struct {\n    UserId int `json:\"user_id\"`\n    ChannelID int `json:\"channel_id\"`\n}\n\ntype NewMessageAction struct {\n    MessageMeta\n    Message string `json:\"message\"`\n}\n\ntype EditMessageAction struct {\n    MessageMeta\n    MessageId int `json:\"message_id\"`\n    Message string `json:\"message\"`\n}\n\ntype DeleteMessageAction struct {\n    MessageMeta\n    MessageId int `json:\"message_id\"`\n}\n</code></pre>\n\n<p>I come from Node.js world (although I don't want to compare the two) and to me it seems a bit too verbose to create and maintain a type for every action there is. What if there are hundreds of actions?</p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "is_accepted": false, "score": 4, "last_activity_date": 1499770992, "creation_date": 1499770992, "answer_id": 45032720, "question_id": 45032514, "link": "https://stackoverflow.com/questions/45032514/override-golang-json-tag-values-at-runtime/45032720#45032720", "title": "Override Golang JSON tag values at runtime", "body": "<p>You can <strong>read/get</strong> struct tag values using <code>StructTag</code> from <code>reflect</code> package:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype CourseAssignment struct {\n    Semester int `json:\"semester\"  xml:\"semester\"`\n}\n\nfunc main() {\n    ca := CourseAssignment{}\n    st := reflect.TypeOf(ca)\n    field := st.Field(0)\n    fmt.Println(field.Tag.Get(\"json\"))\n}\n</code></pre>\n\n<p>There is no method to <strong>change</strong> a struct tag field in the standard library.</p>\n\n<p>However, there are open-source libraries that do exactly that, like <a href=\"https://github.com/sevlyar/retag\" rel=\"nofollow noreferrer\">Retag</a>. </p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 5118756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/162ccea64f3f52f70e5891b4ef91417f?s=128&d=identicon&r=PG&f=1", "display_name": "Blob31", "link": "https://stackoverflow.com/users/5118756/blob31"}, "edited": false, "score": 0, "creation_date": 1499781064, "post_id": 45036146, "comment_id": 77046876, "body": "Thanks for the tip, i ended up doing something similar:"}, {"owner": {"reputation": 4452, "user_id": 2354099, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7f136983231a6281fcb14761ef972fa0?s=128&d=identicon&r=PG", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/2354099/pinkpanther"}, "edited": false, "score": 0, "creation_date": 1534180619, "post_id": 45036146, "comment_id": 90609255, "body": "This isn&#39;t useful when we want to avoid having the field names in the result."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 4452, "user_id": 2354099, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7f136983231a6281fcb14761ef972fa0?s=128&d=identicon&r=PG", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/2354099/pinkpanther"}, "edited": false, "score": 0, "creation_date": 1534180979, "post_id": 45036146, "comment_id": 90609441, "body": "@pinkpanther how do you figure? The point of <code>omitempty</code> is the field is omitted if the field is empty."}, {"owner": {"reputation": 16764, "user_id": 1161743, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/18aebb65726f793706e6bba28e921420?s=128&d=identicon&r=PG", "display_name": "Jonathan Lin", "link": "https://stackoverflow.com/users/1161743/jonathan-lin"}, "edited": false, "score": 0, "creation_date": 1590841844, "post_id": 45036146, "comment_id": 109836694, "body": "You should try to nest the core model in another wrapper model like described in this blog post: <a href=\"https://attilaolah.eu/2014/09/10/json-and-struct-composition-in-go/\" rel=\"nofollow noreferrer\">attilaolah.eu/2014/09/10/json-and-struct-composition-in-go</a> instead of this hack"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1499780247, "creation_date": 1499780247, "answer_id": 45036146, "question_id": 45032514, "link": "https://stackoverflow.com/questions/45032514/override-golang-json-tag-values-at-runtime/45036146#45036146", "title": "Override Golang JSON tag values at runtime", "body": "<p>What I've done in similar cases is to set these kinds of fields to <code>omitempty</code>, and then empty them before serializing in the cases where I don't want them included in JSON:</p>\n\n<pre><code>type CourseAssignment struct {\n    Semester int `json:\"semester\"  xml:\"semester\"`\n    Lecture *Lecture `json:\"lecture,omitempty\"  xml:\"-\"`\n    Cos *Cos `json:\"cos,omitempty\"  xml:\"-\"`\n    Links map[string][]Link `json:\"links,omitempty\" xml:\"links,omitempty\"`\n}\n\n// Want to serialize without including Lecture/Cos:\naCourseAssignment.Lecture = nil\naCourseAssignment.Cos = nil\nthing,err := json.Marshal(aCourseAssignment)\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5118756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/162ccea64f3f52f70e5891b4ef91417f?s=128&d=identicon&r=PG&f=1", "display_name": "Blob31", "link": "https://stackoverflow.com/users/5118756/blob31"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2810, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1499781272, "creation_date": 1499770416, "last_edit_date": 1499781272, "question_id": 45032514, "link": "https://stackoverflow.com/questions/45032514/override-golang-json-tag-values-at-runtime", "title": "Override Golang JSON tag values at runtime", "body": "<p>I have the following struct in in my Web Application using \"encoding/json\"</p>\n\n<pre><code>type CourseAssignment struct {\n    Semester int `json:\"semester\"  xml:\"semester\"`\n    Lecture Lecture `json:\"-\"  xml:\"-\"`\n    Cos Cos `json:\"-\"  xml:\"-\"`\n    Links map[string][]Link `json:\"links,omitempty\" xml:\"links,omitempty\"`\n}\n</code></pre>\n\n<p>Lecture and Cos are complex structs themselves that i dont want to be included in my serialized json which i indicate by setting json:\"-\"</p>\n\n<p>This works perfectly.</p>\n\n<p>I want to override that behavior on demand during runtime, how do i do that without writing my own Serialization code ?</p>\n\n<p>Edit: My Own Solution:</p>\n\n<pre><code>func (r *CourseAssignment) Expand(depth int) CourseAssignment {\n\n    if depth &lt;= 0 {\n        return *r\n    }\n\n    tmp := *r\n    tmp.LectureEx = tmp.Lecture\n    tmp.CosEx = tmp.Cos\n    tmp.Links = nil \n    return tmp\n}\n\ntype CourseAssignment struct {\n    Semester int `json:\"semester\"  xml:\"semester\"`\n    Lecture *Lecture `json:\"-\"  xml:\"-\"`\n    Cos *Cos `json:\"-\"  xml:\"-\"`\n    Links map[string][]Link `json:\"links,omitempty\" xml:\"links,omitempty\"`\n    LectureEx  *Lecture   `json:\"lecture,omitempty\"  xml:\"lecture,omitempty\"`\n    CosEx *Cos `json:\"course_of_study,omitempty\" xml:\"course_of_study,omitempty\"`   \n}\n</code></pre>\n\n<p>When i want to include the fields i create a Copy of the Object using expand that fills fields that contain the same references but show up in the serialization.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 726, "user_id": 387670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de92c7f1d6b452b9e2b3f38c11967cb8?s=128&d=identicon&r=PG", "display_name": "sahaj", "link": "https://stackoverflow.com/users/387670/sahaj"}, "edited": false, "score": 0, "creation_date": 1499768256, "post_id": 45030933, "comment_id": 77037019, "body": "It does change. You many not be noticing it as the text on those pages is almost same. Try adding more text on about page and you will notice the change. Tried your code on MacOS with go version 1.7.3."}, {"owner": {"reputation": 31, "user_id": 4010390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a47c8c3140298139da54044c7e31e7?s=128&d=identicon&r=PG&f=1", "display_name": "gim", "link": "https://stackoverflow.com/users/4010390/gim"}, "reply_to_user": {"reputation": 726, "user_id": 387670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de92c7f1d6b452b9e2b3f38c11967cb8?s=128&d=identicon&r=PG", "display_name": "sahaj", "link": "https://stackoverflow.com/users/387670/sahaj"}, "edited": false, "score": 0, "creation_date": 1499797991, "post_id": 45030933, "comment_id": 77058471, "body": "@sahaj8 I&#39;ve added a YouTube screen capture to show the problem I&#39;m having. Could it be a bug with Windows, if it&#39;s working fine on your Mac?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1499798725, "post_id": 45030933, "comment_id": 77058928, "body": "Note the difference in going to /about/ vs /about , sahaj is probably going to /about while the video of gim is going to /about/  - consider doing <code>http.HandleFunc(&quot;&#47;about&#47;&quot;, about) </code> and read <a href=\"https://golang.org/pkg/net/http/#ServeMux\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#ServeMux</a> carefully"}, {"owner": {"reputation": 726, "user_id": 387670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de92c7f1d6b452b9e2b3f38c11967cb8?s=128&d=identicon&r=PG", "display_name": "sahaj", "link": "https://stackoverflow.com/users/387670/sahaj"}, "edited": false, "score": 0, "creation_date": 1499837178, "post_id": 45030933, "comment_id": 77071799, "body": "On Mac, on clicking on about the URL appears as &quot;<a href=\"http://localhost:8080/about\" rel=\"nofollow noreferrer\">localhost:8080/about</a>&quot; and not with trailing &#39;/&#39;."}, {"owner": {"reputation": 726, "user_id": 387670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de92c7f1d6b452b9e2b3f38c11967cb8?s=128&d=identicon&r=PG", "display_name": "sahaj", "link": "https://stackoverflow.com/users/387670/sahaj"}, "edited": false, "score": 0, "creation_date": 1499837765, "post_id": 45030933, "comment_id": 77072030, "body": "Looks like some issue in Go. Check here: <a href=\"https://github.com/golang/go/issues/11757\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/11757</a>"}, {"owner": {"reputation": 31, "user_id": 4010390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a47c8c3140298139da54044c7e31e7?s=128&d=identicon&r=PG&f=1", "display_name": "gim", "link": "https://stackoverflow.com/users/4010390/gim"}, "edited": false, "score": 0, "creation_date": 1499852630, "post_id": 45030933, "comment_id": 77081439, "body": "Today I ran the code with http.HandleFunc(&quot;/&quot;, index);http.HandleFunc(&quot;/about&quot;, about);http.HandleFunc(&quot;/form&quot;, form) again - all routes without any trailing slash. And it&#39;s now working in Chrome, Opera, Internet Explorer and Edge. In all cases no trailing slash is added to the URLs by the browser."}, {"owner": {"reputation": 31, "user_id": 4010390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a47c8c3140298139da54044c7e31e7?s=128&d=identicon&r=PG&f=1", "display_name": "gim", "link": "https://stackoverflow.com/users/4010390/gim"}, "edited": false, "score": 0, "creation_date": 1499852664, "post_id": 45030933, "comment_id": 77081471, "body": "However, Firefox seems to still be adding a trailing slash to the &quot;about&quot; URL and thus causing the problem that the html for the about page does not load into the browser. I came across this Firefox bug (but it&#39;s for iOS and has been resolved for iOS) &quot;Stop appending a forward slash to every URL&quot; <a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1201079\" rel=\"nofollow noreferrer\">bugzilla.mozilla.org/show_bug.cgi?id=1201079</a>."}, {"owner": {"reputation": 31, "user_id": 4010390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a47c8c3140298139da54044c7e31e7?s=128&d=identicon&r=PG&f=1", "display_name": "gim", "link": "https://stackoverflow.com/users/4010390/gim"}, "edited": false, "score": 0, "creation_date": 1500300560, "post_id": 45030933, "comment_id": 77261806, "body": "It looks like this was a browser caching problem."}], "owner": {"reputation": 31, "user_id": 4010390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a47c8c3140298139da54044c7e31e7?s=128&d=identicon&r=PG&f=1", "display_name": "gim", "link": "https://stackoverflow.com/users/4010390/gim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499798266, "creation_date": 1499766275, "last_edit_date": 1499798266, "question_id": 45030933, "link": "https://stackoverflow.com/questions/45030933/understanding-route-matching-in-standard-go-servemux", "title": "Understanding route matching in standard go ServeMux", "body": "<p>I'm having some problems understanding routing rules from the standard GO library <a href=\"http://godoc.org/net/http#ServeMux\" rel=\"nofollow noreferrer\">http://godoc.org/net/http#ServeMux</a>. Matching pattern \"/about\" does \"GET /about\" but does not update the browser with the new html. The html remains the same as for \"GET /\". I have tried changing the patterns to \"/about/\" but has the unexpected effect of the submitted form generating a \"GET /form\" instead of a \"POST /form\". The code below should make this question clearer. Is this normal behaviour?</p>\n\n<p>Here is a screen capture [<a href=\"https://www.youtube.com/watch?v=ucu5pIm3NL4]\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=ucu5pIm3NL4]</a> showing this behaviour.</p>\n\n<p>I'm using Go 1.8.3 on Windows 10. The behaviour is the same in Google Chrome and Firefox.</p>\n\n<p>I also tried Go 1.7.6, but the behaviour was the same.</p>\n\n<p>Thanks for your help.</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"io\"\n    \"fmt\"\n)\n\nfunc main() {\n\n    // These 3 lines are what I expect to work, but it has a problem\n    http.HandleFunc(\"/\", index)         // does GET /\n    http.HandleFunc(\"/about\", about)    // does GET /about. URL in address\n                                        // bar changes to\n                                        // http://localhost:8080/about/,\n                                        // but html does not change.\n                                        // The html code for INDEX remains\n                                        // in browser\n    http.HandleFunc(\"/form\", form)      // does GET /form and included form\n                                        // does POST /form\n\n    //http.HandleFunc(\"/\", index)       // does GET /\n    //http.HandleFunc(\"/about/\", about) // does GET /about\n    //http.HandleFunc(\"/form/\", form)   // does GET /form and included form\n                                        // also does GET /form. Does not\n                                        // do POST /form\n\n    // This code works as expected\n    //http.HandleFunc(\"/\", index)       // does GET /\n    //http.HandleFunc(\"/about/\", about) // does GET /about\n    //http.HandleFunc(\"/form\", form)    // does GET /form and included form\n                                        // does /POST form as expected\n\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc index(w http.ResponseWriter, req *http.Request) {\n    fmt.Println(req.Method + req.URL.Path)\n    io.WriteString(w, `&lt;html&gt;&lt;head&gt;&lt;/head&gt;\n                        &lt;body&gt;INDEX\n                        &lt;a href=\"/\"&gt;INDEX&lt;/a&gt;\n                        &lt;a href=\"/about\"&gt;ABOUT&lt;/a&gt;\n                        &lt;a href=\"/form\"&gt;FORM&lt;/a&gt;\n                        &lt;/body&gt;&lt;/html&gt;\n                        `)\n}\n\nfunc about(w http.ResponseWriter, req *http.Request) {\n    fmt.Println(req.Method + req.URL.Path)\n    io.WriteString(w, `&lt;html&gt;&lt;head&gt;&lt;/head&gt;\n                        &lt;body&gt;ABOUT\n                        &lt;a href=\"/\"&gt;INDEX&lt;/a&gt;\n                        &lt;a href=\"/about\"&gt;ABOUT&lt;/a&gt;\n                        &lt;a href=\"/form\"&gt;FORM&lt;/a&gt;\n                        &lt;/body&gt;&lt;/html&gt;\n                        `)\n}\n\nfunc form(w http.ResponseWriter, req *http.Request) {\n\n    if req.Method == http.MethodPost {\n        fmt.Println(req.Method + req.URL.Path)\n        io.WriteString(w, `&lt;html&gt;&lt;head&gt;&lt;/head&gt;\n                        &lt;body&gt;PROCESS FORM\n                        &lt;a href=\"/\"&gt;INDEX&lt;/a&gt;\n                        &lt;a href=\"/about\"&gt;ABOUT&lt;/a&gt;\n                        &lt;a href=\"/form\"&gt;FORM&lt;/a&gt;\n                        &lt;/body&gt;&lt;/html&gt;\n                        `)\n        return\n    }\n    fmt.Println(req.Method + req.URL.Path)\n    io.WriteString(w, `&lt;html&gt;&lt;head&gt;&lt;/head&gt;\n                        &lt;body&gt;FORM\n                        &lt;a href=\"/\"&gt;INDEX&lt;/a&gt;\n                        &lt;a href=\"/about\"&gt;ABOUT&lt;/a&gt;\n                        &lt;a href=\"/form\"&gt;FORM&lt;/a&gt;\n                        &lt;form method=\"POST\" action=\"/form\"&gt;&lt;input type=\"submit\"&gt;&lt;/form&gt;\n                        &lt;/body&gt;&lt;/html&gt;\n                        `)\n\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 289, "user_id": 4202942, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/30ADO.png?s=128&g=1", "display_name": "DarkLighting", "link": "https://stackoverflow.com/users/4202942/darklighting"}, "edited": false, "score": 0, "creation_date": 1516285568, "post_id": 45031316, "comment_id": 83632316, "body": "No, the slice had its capacity extended by the 3 statements right above it. The only thing it did was reassigning the original values and &quot;0&quot; to the extra positions, but it was also a waste, as Go had already filled them.  It was also a second waste, as the loop right after it redefined all those values too.  So, the line has no use at all."}, {"owner": {"reputation": 289, "user_id": 4202942, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/30ADO.png?s=128&g=1", "display_name": "DarkLighting", "link": "https://stackoverflow.com/users/4202942/darklighting"}, "edited": false, "score": 0, "creation_date": 1516287050, "post_id": 45031316, "comment_id": 83633354, "body": "Please, take a look at my answer for a detailed explanation."}], "tags": [], "owner": {"reputation": 1219, "user_id": 4390959, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/wTtAV.jpg?s=128&g=1", "display_name": "gorros", "link": "https://stackoverflow.com/users/4390959/gorros"}, "is_accepted": true, "score": 1, "last_activity_date": 1499767229, "creation_date": 1499767229, "answer_id": 45031316, "question_id": 45030884, "link": "https://stackoverflow.com/questions/45030884/understanding-slice-assignment-in-go/45031316#45031316", "title": "Understanding slice assignment in Go", "body": "<p>I guess</p>\n\n<pre><code>slice = slice[0:l+len(data)] \n</code></pre>\n\n<p>changes <code>slice</code> length, so you can add new elements.</p>\n\n<blockquote>\n  <p>You can extend a slice's length by re-slicing it, provided it has sufficient capacity.</p>\n</blockquote>\n\n<p><a href=\"https://tour.golang.org/moretypes/11\" rel=\"nofollow noreferrer\">reference</a> </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4477323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fb63bfb358b21146b6e79acd92420ad?s=128&d=identicon&r=PG&f=1", "display_name": "chen peng", "link": "https://stackoverflow.com/users/4477323/chen-peng"}, "is_accepted": false, "score": 0, "last_activity_date": 1499769037, "creation_date": 1499769037, "answer_id": 45031997, "question_id": 45030884, "link": "https://stackoverflow.com/questions/45030884/understanding-slice-assignment-in-go/45031997#45031997", "title": "Understanding slice assignment in Go", "body": "<p>just expand the len(slice) ,so can append data, remove this this statement,  slice out of index occurs...In addition\uff0ccopy return the min len(src) and len(dst), so when execute <code>if l + len(data) &gt; cap(slice)</code>,the len(slice) would be 0</p>\n"}, {"tags": [], "owner": {"reputation": 289, "user_id": 4202942, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/30ADO.png?s=128&g=1", "display_name": "DarkLighting", "link": "https://stackoverflow.com/users/4202942/darklighting"}, "is_accepted": false, "score": 0, "last_activity_date": 1516286970, "creation_date": 1516286970, "answer_id": 48324020, "question_id": 45030884, "link": "https://stackoverflow.com/questions/45030884/understanding-slice-assignment-in-go/48324020#48324020", "title": "Understanding slice assignment in Go", "body": "<p>Just posting this answer for future reference.</p>\n\n<p>That line has no use. The slice's capacity was extended by the statements right above it. </p>\n\n<pre><code>        // Allocate double what's needed, for future growth.\n        newSlice := make([]byte, (l+len(data))*2)\n        // The copy function is predeclared and works for any slice type.\n        copy(newSlice, slice)\n        slice = newSlice\n</code></pre>\n\n<p>The first line created a bigger slice called \"newSlice\".\n<br>In the second one \"slice\" had its content copied to \"newSlice\".\n<br>And then, \"newSlice\" was kind of cloned back to \"slice\".</p>\n\n<p>Yeah, Go does feel strange about this thing, as not also the content is copied, but \"slice\" now has the same capacity as \"newSlice\". But it is not like a \"pointer assignment\" in C, as we still have two different slice instances and what happens to one doesn't affect the other. Please note the usage of the assignment operator \"=\" instead of the short variable declaration operator \":=\", as noted in <a href=\"https://stackoverflow.com/questions/16521472/assignment-operator-in-go-language\">this answer in SO</a></p>\n\n<p>What was actually done was the assignment of the original \"slice\" values and \"0\" to the \"newSlice\" extra positions, but it was also a waste, as Go had already initialized them as \"0\" in the <code>make()</code> statement.</p>\n\n<p>It was also a second waste, as the loop right after it redefined all those positions along with the rest of the content in \"data\". This <a href=\"https://tour.golang.org/moretypes/16\" rel=\"nofollow noreferrer\">link</a> may help with the loop meaning.</p>\n\n<p>So, the line has no use at all and you should remove it.</p>\n"}], "owner": {"reputation": 726, "user_id": 387670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de92c7f1d6b452b9e2b3f38c11967cb8?s=128&d=identicon&r=PG", "display_name": "sahaj", "link": "https://stackoverflow.com/users/387670/sahaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3259, "favorite_count": 1, "accepted_answer_id": 45031316, "answer_count": 3, "score": 1, "last_activity_date": 1516286970, "creation_date": 1499766148, "last_edit_date": 1499791421, "question_id": 45030884, "link": "https://stackoverflow.com/questions/45030884/understanding-slice-assignment-in-go", "title": "Understanding slice assignment in Go", "body": "<p>In the below code snippet, what exactly is the line after the <code>if</code> block doing</p>\n\n<p><code>slice = slice[0:l+len(data)]</code>? </p>\n\n<p>\n</p>\n\n<pre><code>func Append(slice, data []byte) []byte {\n    l := len(slice)\n    if l + len(data) &gt; cap(slice) {  // reallocate\n        // Allocate double what's needed, for future growth.\n        newSlice := make([]byte, (l+len(data))*2)\n        // The copy function is predeclared and works for any slice type.\n        copy(newSlice, slice)\n        slice = newSlice\n    }\n    slice = slice[0:l+len(data)]  // &lt;-- What is this doing ?\n    for i, c := range data {\n        slice[l+i] = c\n    }\n    return slice\n}\n</code></pre>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 726, "user_id": 387670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de92c7f1d6b452b9e2b3f38c11967cb8?s=128&d=identicon&r=PG", "display_name": "sahaj", "link": "https://stackoverflow.com/users/387670/sahaj"}, "edited": false, "score": 1, "creation_date": 1499767000, "post_id": 45030652, "comment_id": 77036121, "body": "reg_worker := &lt;- registerChan is a blocking call. So trying to read from the channel registerChan in the same go routine will not work. are you sure it works for 50 tasks?"}, {"owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "reply_to_user": {"reputation": 726, "user_id": 387670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de92c7f1d6b452b9e2b3f38c11967cb8?s=128&d=identicon&r=PG", "display_name": "sahaj", "link": "https://stackoverflow.com/users/387670/sahaj"}, "edited": false, "score": 0, "creation_date": 1499767242, "post_id": 45030652, "comment_id": 77036296, "body": "@sahaj I&#39;m sure there are more than 50 tasks done."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1499774733, "post_id": 45030652, "comment_id": 77041604, "body": "Nothing in the included code suggests why it should complete 50+ tasks and get stuck before completing all 100. The reason should be in the rest of the code, which makes this off-topic."}, {"owner": {"reputation": 325, "user_id": 136926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491881dc0136c7ca0d5376e1679ae103?s=128&d=identicon&r=PG", "display_name": "britt", "link": "https://stackoverflow.com/users/136926/britt"}, "edited": false, "score": 0, "creation_date": 1499803699, "post_id": 45030652, "comment_id": 77061588, "body": "Is registerChan buffered?"}, {"owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "reply_to_user": {"reputation": 325, "user_id": 136926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491881dc0136c7ca0d5376e1679ae103?s=128&d=identicon&r=PG", "display_name": "britt", "link": "https://stackoverflow.com/users/136926/britt"}, "edited": false, "score": 0, "creation_date": 1499820435, "post_id": 45030652, "comment_id": 77067239, "body": "@britt No it&#39;s not. Just add some explain."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7708919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qUsDR.png?s=128&g=1", "display_name": "Hac", "link": "https://stackoverflow.com/users/7708919/hac"}, "edited": false, "score": 0, "creation_date": 1499830077, "post_id": 45047789, "comment_id": 77069641, "body": "I&#39;m working on 6.824 as well, I would suggest you put <code>wg.Done()</code> before <code>registerChan &lt;- new_worker</code> rather than using inner goroutine."}], "tags": [], "owner": {"reputation": 3, "user_id": 7708919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qUsDR.png?s=128&g=1", "display_name": "Hac", "link": "https://stackoverflow.com/users/7708919/hac"}, "is_accepted": false, "score": 0, "last_activity_date": 1499840111, "last_edit_date": 1499840111, "creation_date": 1499829403, "answer_id": 45047789, "question_id": 45030652, "link": "https://stackoverflow.com/questions/45030652/why-is-nested-goroutine-necessary/45047789#45047789", "title": "Why is nested goroutine necessary?", "body": "<p>the inner goroutine is quite nessesary since the registerChan is not buffered!</p>\n\n<p>Sending to unbuffered channel is blocked unless it's been received. In your case, you got 100 tasks, which means that both <code>reg_worker := &lt;- registerChan</code> and <code>registerChan &lt;- reg_worker</code> will be called 100 times. Seems that sending/receiving is balanced, right? </p>\n\n<p>However, you still got 2 workers! There must be something like <code>registerChan &lt;- new_worker</code> somewhere in your code(most likely <code>mr.forwardRegistrations(ch)</code>), and it should be called 2 times!</p>\n\n<p>Therefore, you have two more sending than receiving on a unbuffered channel, so the last 2 <code>registerChan &lt;- reg_worker</code> are blocked, then <code>defer wg.Done()</code> and <code>wg.Wait()</code> are blocked as well!</p>\n\n<p>To verify it, you could debug like this:</p>\n\n<pre><code>        defer wg.Done()\n        reg_worker := &lt;-registerChan\n        call(reg_worker, \"Worker.DoTask\", task_arg, nil)\n        fmt.Println(\"### start sending to registerChan\")\n        registerChan &lt;- reg_worker\n        fmt.Println(\"### send done\")\n</code></pre>\n\n<p>just count the occurrence number of these two sentences. It should be 100 and 98!</p>\n"}], "owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1027, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1499840111, "creation_date": 1499765523, "last_edit_date": 1499823603, "question_id": 45030652, "link": "https://stackoverflow.com/questions/45030652/why-is-nested-goroutine-necessary", "title": "Why is nested goroutine necessary?", "body": "<p>I'm working on MIT 6.824 - <a href=\"https://pdos.csail.mit.edu/6.824/labs/lab-1.html\" rel=\"nofollow noreferrer\">lab1</a>(part III) and get confused at a piece of scheduling program of a (mini) mapreduce:</p>\n\n<pre><code>var wg sync.WaitGroup\nfor i := 0; i &lt; ntasks; i++ {\n    task_arg := DoTaskArgs{ JobName: jobName, File: mapFiles[i], Phase: phase, TaskNumber: i, NumOtherPhase: n_other }\n    //not so relevant\n\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n        reg_worker := &lt;- registerChan\n        call(reg_worker, \"Worker.DoTask\", task_arg, nil)\n        go func() { registerChan &lt;- reg_worker }()\n        //registerChan &lt;- reg_worker\n    }()\n}\nwg.Wait()\n</code></pre>\n\n<p>This program</p>\n\n<ol>\n<li>deploy 100 tasks to 2 worker (with <code>call</code>) from channel <code>registerChan</code></li>\n<li>put worker back to channel when task finished</li>\n<li><code>wg.Add()</code>, <code>wg.Done</code>, <code>wg.Wait()</code> to sync</li>\n</ol>\n\n<p>how <code>schedule</code> is called (<a href=\"https://github.com/WentaoZero/mini-mapreduce/blob/master/master.go#L84\" rel=\"nofollow noreferrer\">https://github.com/WentaoZero/mini-mapreduce/blob/master/master.go#L84</a>):</p>\n\n<pre><code>ch := make(chan string)\ngo mr.forwardRegistrations(ch)\nschedule(mr.jobName, mr.files, mr.nReduce, phase, ch)\n</code></pre>\n\n<p><code>registerChan</code> is not buffered.</p>\n\n<p>I try removing <code>goroutine</code> at line <code>go func() { registerChan &lt;- reg_worker }()</code> to make it: <code>registerChan &lt;- reg_worker</code></p>\n\n<p>the program gets stuck after more than 50 tasks are done. I suppose it proves that the goroutine is working but I don't see why it gets stuck.</p>\n\n<p><code>registerChan &lt;- reg_worker</code> has been written in a goroutine, why is it necessary to wrap it with another goroutine?</p>\n\n<p>I don't think the rest of the system is relevant so I won't post it here. You may check <a href=\"https://github.com/WentaoZero/mini-mapreduce\" rel=\"nofollow noreferrer\">https://github.com/WentaoZero/mini-mapreduce</a> if needed. This scheduling program is picked from <a href=\"https://github.com/WentaoZero/mini-mapreduce/blob/master/schedule.go\" rel=\"nofollow noreferrer\">https://github.com/WentaoZero/mini-mapreduce/blob/master/schedule.go</a></p>\n"}, {"tags": ["go", "random", "boolean"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1499765526, "post_id": 45030618, "comment_id": 77034969, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/44719156/how-can-i-let-a-function-randomly-return-either-a-true-or-a-false-in-go/44719269#44719269\">How can I let a function randomly return either a true or a false in go</a>."}, {"owner": {"reputation": 726, "user_id": 387670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de92c7f1d6b452b9e2b3f38c11967cb8?s=128&d=identicon&r=PG", "display_name": "sahaj", "link": "https://stackoverflow.com/users/387670/sahaj"}, "edited": false, "score": 0, "creation_date": 1499767297, "post_id": 45030618, "comment_id": 77036338, "body": "Why src and r are global variables? Try to refrain using global variables. It becomes habit and then you continue with it."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 11, "last_activity_date": 1562238237, "last_edit_date": 1562238237, "creation_date": 1499767446, "answer_id": 45031417, "question_id": 45030618, "link": "https://stackoverflow.com/questions/45030618/generate-a-random-bool-in-go/45031417#45031417", "title": "generate a random bool in go", "body": "<p>Examples of how to generate a random <code>bool</code> value can be found here (not necessarily the fastest solutions, as that wasn't a requirement there):</p>\n\n<p><a href=\"https://stackoverflow.com/questions/44719156/how-can-i-let-a-function-randomly-return-either-a-true-or-a-false-in-go/44719269#44719269\">How can I let a function randomly return either a true or a false in go</a></p>\n\n<p>The slowest part of such algorithms is always getting the random data (random information). For example a <a href=\"https://golang.org/pkg/math/rand/#Int31\" rel=\"noreferrer\"><code>rand.Int31()</code></a> call returns 31 random bits, but if we only use it to \"generate\" a random <code>bool</code> value (which is 1 bit of information), we waste 30 bits (which could be 30 additional random <code>bool</code> values!).</p>\n\n<p>Using <a href=\"https://golang.org/pkg/math/rand/#Source\" rel=\"noreferrer\"><code>rand.Source</code></a> is a good choice, as we don't need all the \"code kung-fu\" that <a href=\"https://golang.org/pkg/math/rand/#Rand\" rel=\"noreferrer\"><code>rand.Rand</code></a> does on the random data. We just need a source of random information.</p>\n\n<p><code>rand.Source</code> defines one method to obtain random information:</p>\n\n<pre><code>Int63() int64\n</code></pre>\n\n<p>This <code>Source.Int63()</code> method returns 63 random bits; to be fast(est), we should use all. Of course generating a single <code>bool</code> value requires only 1 of its bits, but we should store the remaining and use them when subsequent random <code>bool</code>s are asked from us.</p>\n\n<p>This is how it can be done:</p>\n\n<pre><code>type boolgen struct {\n    src       rand.Source\n    cache     int64\n    remaining int\n}\n\nfunc (b *boolgen) Bool() bool {\n    if b.remaining == 0 {\n        b.cache, b.remaining = b.src.Int63(), 63\n    }\n\n    result := b.cache&amp;0x01 == 1\n    b.cache &gt;&gt;= 1\n    b.remaining--\n\n    return result\n}\n</code></pre>\n\n<p>Creating such a <code>boolgen</code> is like this:</p>\n\n<pre><code>func New() *boolgen {\n    return &amp;boolgen{src: rand.NewSource(time.Now().UnixNano())}\n}\n</code></pre>\n\n<p>Example usage:</p>\n\n<pre><code>r := New()\nfor i := 0; i &lt; 100; i++ {\n    if i%10 == 0 {\n        fmt.Println()\n    }\n    fmt.Print(r.Bool(), \" \")\n}\n</code></pre>\n\n<p>Example output (try it on the <a href=\"https://play.golang.org/p/oucs3zxcr_\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>false false true true false false false false false false \nfalse false false true false false true false true true \nfalse false true false true false false true true true \nfalse false false false false false false true true false \ntrue true true true false false false false true false \ntrue true true false true true true true true true \ntrue true false true true false false true false true \ntrue true false false false true true true true false \ntrue false false true true true true false false true \ntrue false false false false false false false true false \n</code></pre>\n\n<p><strong>Some notes:</strong></p>\n\n<p>The <code>Source</code> returned by <a href=\"https://golang.org/pkg/math/rand/#NewSource\" rel=\"noreferrer\"><code>rand.NewSource()</code></a> is not safe for concurrent use by multiple goroutines, so our <code>boolgen</code> is also not safe for concurrent use. On one hand this is <em>good</em>, as it will be faster (as no synchronization takes place) than using the default source of the <code>rand</code> package which is safe in this manner (which is by the way unexported, so can only be \"reached\" indirectly through functions of the <code>rand</code> package).</p>\n\n<p>If you need to use this from multiple goroutines, <em>fastest</em> (as in spirit of the question) would be for all goroutines to create their own <code>boolgen</code>, so no synchronization is needed.</p>\n\n<p>If <code>boolgen</code> itself must be made safe for concurrent use, simply its <code>Bool()</code> method should be protected with a <a href=\"https://golang.org/pkg/sync/#Mutex\" rel=\"noreferrer\"><code>sync.Mutex</code></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 2842, "user_id": 648741, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/47813cc59b0edb414b88601f1defe02a?s=128&d=identicon&r=PG", "display_name": "jochen", "link": "https://stackoverflow.com/users/648741/jochen"}, "reply_to_user": {"reputation": 7779, "user_id": 6858274, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/323d5de87d97a689b73a663375e079eb?s=128&d=identicon&r=PG&f=1", "display_name": "felix", "link": "https://stackoverflow.com/users/6858274/felix"}, "edited": false, "score": 0, "creation_date": 1559213691, "post_id": 51327810, "comment_id": 99354406, "body": "@felix I have to say that I liked my answer better before the edit, when it compared only methods available via the standard library.  If adding external packages, why only the obscure <code>github.com&#47;MichaelTJones&#47;pcg</code> and no others?"}, {"owner": {"reputation": 7779, "user_id": 6858274, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/323d5de87d97a689b73a663375e079eb?s=128&d=identicon&r=PG&f=1", "display_name": "felix", "link": "https://stackoverflow.com/users/6858274/felix"}, "edited": false, "score": 1, "creation_date": 1559348221, "post_id": 51327810, "comment_id": 99404186, "body": "Sorry to hear that ! I included the <code>pcg</code> package because it&#39;s the solution that will likely be used in go2 ( see <a href=\"https://github.com/golang/go/issues/21835\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/21835</a> for details ), and the solution I ended up using in my project. Feel free to rollback my changes ( if you can&#39;t just let me know, I&#39;ll do it for you)"}, {"owner": {"reputation": 2842, "user_id": 648741, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/47813cc59b0edb414b88601f1defe02a?s=128&d=identicon&r=PG", "display_name": "jochen", "link": "https://stackoverflow.com/users/648741/jochen"}, "reply_to_user": {"reputation": 7779, "user_id": 6858274, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/323d5de87d97a689b73a663375e079eb?s=128&d=identicon&r=PG&f=1", "display_name": "felix", "link": "https://stackoverflow.com/users/6858274/felix"}, "edited": false, "score": 0, "creation_date": 1559376339, "post_id": 51327810, "comment_id": 99407677, "body": "@felix Ah, thanks!  If <code>pcg</code> is on its way into the standard library, its inclusion here looks much less random."}], "tags": [], "owner": {"reputation": 2842, "user_id": 648741, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/47813cc59b0edb414b88601f1defe02a?s=128&d=identicon&r=PG", "display_name": "jochen", "link": "https://stackoverflow.com/users/648741/jochen"}, "is_accepted": false, "score": 2, "last_activity_date": 1533545639, "last_edit_date": 1533545639, "creation_date": 1531493434, "answer_id": 51327810, "question_id": 45030618, "link": "https://stackoverflow.com/questions/45030618/generate-a-random-bool-in-go/51327810#51327810", "title": "generate a random bool in go", "body": "<p>I did a speed comparison of different methods using <code>math/rand</code> package from stdlib and <a href=\"https://github.com/MichaelTJones/pcg\" rel=\"nofollow noreferrer\"><code>github.com/MichaelTJones/pcg</code></a>, another pseudorandom number generator in go</p>\n\n<p>Here is the code I used for timing the different variants:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"testing\"\n\n    \"github.com/MichaelTJones/pcg\"\n)\n\nfunc BenchmarkBool(b *testing.B) {\n\n    pcg32 := pcg.NewPCG32()\n\n    ff := []func() bool{\n        func() bool { return rand.Intn(2) == 0 },          // 1\n        func() bool { return rand.Int31n(2) == 0 },        // 2\n        func() bool { return rand.Int63n(2) == 0 },        // 3\n        func() bool { return rand.Float32() &lt; .5 },        // 4\n        func() bool { return rand.Float64() &lt; .5 },        // 5\n        func() bool { return rand.Int31()&amp;(1&lt;&lt;30) == 0 },  // 6\n        func() bool { return rand.Uint32()&amp;(1&lt;&lt;31) == 0 }, // 7\n        func() bool { return rand.Int63()&amp;(1&lt;&lt;62) == 0 },  // 8\n        func() bool { return rand.Uint64()&amp;(1&lt;&lt;63) == 0 }, // 9\n        func() bool { return pcg32.Random()&amp;0x01 == 0 },   // 10\n    }\n    for i, f := range ff {\n        b.Run(fmt.Sprintf(\"method%v\", i+1), func(b *testing.B) {\n            for n := 0; n &lt; b.N; n++ {\n                _ = f()\n            }\n        })\n    }\n}\n</code></pre>\n\n<p>On my machine, the output of this program is</p>\n\n<pre><code>BenchmarkBool/method1-4             50000000            36.8 ns/op\nBenchmarkBool/method2-4             50000000            34.7 ns/op\nBenchmarkBool/method3-4             50000000            31.5 ns/op\nBenchmarkBool/method4-4             50000000            33.3 ns/op\nBenchmarkBool/method5-4             50000000            30.1 ns/op\nBenchmarkBool/method6-4             50000000            29.4 ns/op\nBenchmarkBool/method7-4             50000000            31.0 ns/op\nBenchmarkBool/method8-4             50000000            28.7 ns/op\nBenchmarkBool/method9-4             50000000            29.5 ns/op\nBenchmarkBool/method10-4            300000000            4.86 ns/op\n</code></pre>\n\n<p><em>i.e.</em> method number 10 is fastest, and number 1 is slowest.</p>\n"}, {"tags": [], "owner": {"reputation": 343, "user_id": 8411263, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nLuEd7kVkpA/AAAAAAAAAAI/AAAAAAAAACI/XGfe0AyH8n8/photo.jpg?sz=128", "display_name": "Manouchehr Rasouli", "link": "https://stackoverflow.com/users/8411263/manouchehr-rasouli"}, "is_accepted": false, "score": 0, "last_activity_date": 1572501438, "creation_date": 1572501438, "answer_id": 58637589, "question_id": 45030618, "link": "https://stackoverflow.com/questions/45030618/generate-a-random-bool-in-go/58637589#58637589", "title": "generate a random bool in go", "body": "<p>hi i use this approach and it's working well</p>\n\n<p>random_bool.go</p>\n\n<pre><code>import (\n      \"math/rand\"\n      \"time\"\n)\n\nconst (\n    Agree = 1\n    Disagree = 0\n)\n\nfunc AreYouAgree() bool {\n    rand.Seed(time.Now().UnixNano())\n    ran := rand.Intn(Agree + 1)\n    if ran == Agree {\n        return true\n    }\n    return false\n}\n</code></pre>\n\n<p>thanks for reading answer. ;)</p>\n"}, {"comments": [{"owner": {"reputation": 371, "user_id": 4420482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gpXFg.png?s=128&g=1", "display_name": "Kashkashio", "link": "https://stackoverflow.com/users/4420482/kashkashio"}, "edited": false, "score": 1, "creation_date": 1603052013, "post_id": 61164288, "comment_id": 113907221, "body": "nice solution tough you could always just return rand.Intn(2) == 1 without the else :D"}, {"owner": {"reputation": 483, "user_id": 6382401, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/04af1d0fba0ddb83761466ffcf4e9336?s=128&d=identicon&r=PG&f=1", "display_name": "Robert J", "link": "https://stackoverflow.com/users/6382401/robert-j"}, "reply_to_user": {"reputation": 371, "user_id": 4420482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gpXFg.png?s=128&g=1", "display_name": "Kashkashio", "link": "https://stackoverflow.com/users/4420482/kashkashio"}, "edited": false, "score": 0, "creation_date": 1611506208, "post_id": 61164288, "comment_id": 116467897, "body": "@Kashkashio thanks for the edit.  I end up making that mistake more than I intend to."}], "tags": [], "owner": {"reputation": 483, "user_id": 6382401, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/04af1d0fba0ddb83761466ffcf4e9336?s=128&d=identicon&r=PG&f=1", "display_name": "Robert J", "link": "https://stackoverflow.com/users/6382401/robert-j"}, "is_accepted": false, "score": 7, "last_activity_date": 1611506337, "last_edit_date": 1611506337, "creation_date": 1586642662, "answer_id": 61164288, "question_id": 45030618, "link": "https://stackoverflow.com/questions/45030618/generate-a-random-bool-in-go/61164288#61164288", "title": "generate a random bool in go", "body": "<p>I am just a rookie, but this makes more sense to me than other solutions provided:</p>\n<pre><code>package randbool\n\nimport (\n    &quot;math/rand&quot;\n    &quot;time&quot;\n)\n\n/*\nRandBool\n    This function returns a random boolean value based on the current time\n*/\nfunc RandBool() bool {\n    rand.Seed(time.Now().UnixNano())\n    return rand.Intn(2) == 1\n}\n</code></pre>\n<p>I am not too familiar with go though, so please forgive my formating.</p>\n"}], "owner": {"reputation": 7779, "user_id": 6858274, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/323d5de87d97a689b73a663375e079eb?s=128&d=identicon&r=PG&f=1", "display_name": "felix", "link": "https://stackoverflow.com/users/6858274/felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7809, "favorite_count": 0, "accepted_answer_id": 45031417, "answer_count": 4, "score": 10, "last_activity_date": 1611506337, "creation_date": 1499765452, "question_id": 45030618, "link": "https://stackoverflow.com/questions/45030618/generate-a-random-bool-in-go", "title": "generate a random bool in go", "body": "<p>What's the fastest way to generate a random bool in go ? </p>\n\n<p>currently I'm doing like this : </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\n// random generator\nvar src = rand.NewSource(time.Now().UnixNano())\nvar r = rand.New(src)\n\nfunc main() {\n    for i := 0; i &lt; 100; i++ {\n        // generate a random boolean and print it \n        fmt.Printf(\"bool: %s\\n\", r.Intn(2) != 0)\n    }\n}\n</code></pre>\n\n<p>How can I improve this ? </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8287519, "user_type": "registered", "profile_image": "https://graph.facebook.com/1437802166280975/picture?type=large", "display_name": "Sultan Maidanov", "link": "https://stackoverflow.com/users/8287519/sultan-maidanov"}, "edited": false, "score": 0, "creation_date": 1499836668, "post_id": 45032040, "comment_id": 77071599, "body": "Thank you a lot for help, but I still wanted to have Menu in main function, and then work with it in other functions. Still do not understand how to do it. Anyway thank you"}], "tags": [], "owner": {"reputation": 726, "user_id": 387670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de92c7f1d6b452b9e2b3f38c11967cb8?s=128&d=identicon&r=PG", "display_name": "sahaj", "link": "https://stackoverflow.com/users/387670/sahaj"}, "is_accepted": true, "score": 0, "last_activity_date": 1499771424, "last_edit_date": 1499771424, "creation_date": 1499769176, "answer_id": 45032040, "question_id": 45029816, "link": "https://stackoverflow.com/questions/45029816/good-day-in-this-program-i-make-the-menu-for-restaurant-including-handle-funct/45032040#45032040", "title": "Good day! In this program, I make the menu for restaurant including Handle function.I can&#39;t connect array: Name, Price with functions getall and get", "body": "<p>I would like to help you as it seems you are genuinely trying to learn go. I've made few changes in your code. I've moved the menu listing in each handler. You may keep it global. Find the changed code below.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"net/http\"\n    \"net/url\"\n    \"strconv\"\n)\n\ntype Menu struct {\n    Name        string\n    Price       int\n    description string\n}\n\nfunc (m Menu) String() string {\n    return fmt.Sprintf(\"%s: %s\", m.Name, m.Price)\n}\n\nfunc main() {\n    fmt.Println(x)\n\n    http.HandleFunc(\"/getall\", getall)\n    http.HandleFunc(\"/get\", get)\n    http.ListenAndServe(\":8080\", nil)\n\n}\n\nfunc getall(w http.ResponseWriter, r *http.Request) {\n\n    x := []Menu{\n        {Name: \"Crispy\", Price: 31},\n        {Name: \"Burger\", Price: 42},\n        {Name: \"Superstar\", Price: 17},\n    }\n\n    for _, m := range x {\n\n        io.WriteString(w, \"&lt;p&gt;\"+m.Name+\" Price \"+strconv.Itoa(m.Price)+\"&lt;/p&gt;\")\n    }\n\n}\n\nfunc get(w http.ResponseWriter, r *http.Request) {\n\n    x := []Menu{\n        {Name: \"Crispy\", Price: 31},\n        {Name: \"Burger\", Price: 42},\n        {Name: \"Superstar\", Price: 17},\n    }\n\n    url := url.URL{}\n    println(url.String())\n    attr := r.URL.Query()\n    fmt.Println(attr)\n    id := attr[\"id\"][0]\n    fmt.Println(\"id of request \" + id)\n    v := id\n    if a, err := strconv.Atoi(v); err == nil {\n        io.WriteString(w, \"&lt;p&gt; \"+x[a-1].Name+\" price \"+strconv.Itoa(x[a-1].Price)+\"&lt;/p&gt;\")\n    }\n\n}\n</code></pre>\n\n<p>Try visiting: <a href=\"http://localhost:8080/getall\" rel=\"nofollow noreferrer\">http://localhost:8080/getall</a> OR <a href=\"http://localhost:8080/get?id=1\" rel=\"nofollow noreferrer\">http://localhost:8080/get?id=1</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4477323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fb63bfb358b21146b6e79acd92420ad?s=128&d=identicon&r=PG&f=1", "display_name": "chen peng", "link": "https://stackoverflow.com/users/4477323/chen-peng"}, "is_accepted": false, "score": 0, "last_activity_date": 1499772044, "creation_date": 1499772044, "answer_id": 45033123, "question_id": 45029816, "link": "https://stackoverflow.com/questions/45029816/good-day-in-this-program-i-make-the-menu-for-restaurant-including-handle-funct/45033123#45033123", "title": "Good day! In this program, I make the menu for restaurant including Handle function.I can&#39;t connect array: Name, Price with functions getall and get", "body": "<p>user <code>for m :=range menu{...}</code>to implement getall(), use <code>for i,_ := range menu{ if i == espect {...}}</code> to implement get()</p>\n"}], "owner": {"reputation": 5, "user_id": 8287519, "user_type": "registered", "profile_image": "https://graph.facebook.com/1437802166280975/picture?type=large", "display_name": "Sultan Maidanov", "link": "https://stackoverflow.com/users/8287519/sultan-maidanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 45032040, "answer_count": 2, "score": -1, "last_activity_date": 1499835899, "creation_date": 1499763333, "last_edit_date": 1499835899, "question_id": 45029816, "link": "https://stackoverflow.com/questions/45029816/good-day-in-this-program-i-make-the-menu-for-restaurant-including-handle-funct", "title": "Good day! In this program, I make the menu for restaurant including Handle function.I can&#39;t connect array: Name, Price with functions getall and get", "body": "<p>Good day! In this program, I make the menu for restaurant including Handle function.   </p>\n\n<p><strong>Problem Statement</strong>:<br>\nI can't connect array: <code>Name, Price</code> with functions <code>getall</code> and <code>get</code>. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"io\"\n    \"strconv\"\n    \"net/url\"\n)\n\ntype Menu struct {\n    Name string\n    Price  int\n    description string\n}\n\nfunc  (m Menu) String() string {\n    return fmt.Sprintf(\"%s: %s\", m.Name, m.Price, )\n}\n\nfunc main() {\n    x :=[]Menu{\n        {Name:\"Crispy\", Price:31},\n        {Name:\"Burger\", Price:42},\n        {Name:\"Superstar\",Price:17},\n        /*{\"Cola\", 26},\n        {Name:\"Superstar\", Price:40},\n        {Name:\"Nuggets\", Price:19},*/\n    }\n    //getall(&amp;x)\n    fmt.Println(x)\n\n    http.HandleFunc(\"/getall\", getall)\n    http.HandleFunc(\"/get\", get)\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc getall(w http.ResponseWriter, r *http.Request) {\n    for _,num := range []Menu{}{\n        io.WriteString(w, \"&lt;p&gt;\"+m.Name+\" Price \"+strconv.Itoa(num)+\"&lt;/p&gt;\")\n    }\n}\n\nfunc get(w http.ResponseWriter, r *http.Request) {\n    url := url.URL{}\n    println(url.String())\n    attr := r.URL.Query()\n    fmt.Println(attr)\n    id := attr[\"id\"][0]\n    fmt.Println(\"id of request \" + id)\n    v := id\n    d:= []Menu{}\n    if a, err := strconv.Atoi(v);\n    err == nil {\n        io.WriteString(w, \"&lt;p&gt; \"+Name[a-1]+\" price \"+strconv.Itoa(d[a-1])+\"&lt;/p&gt;\")\n    }\n}\n</code></pre>\n\n<p>Help me to implement array in <code>getall</code> and <code>get</code> function.</p>\n"}, {"tags": ["mysql", "testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 1991, "user_id": 1173351, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dc717fb8a7638b9e5513ecc0b82a1b5b?s=128&d=identicon&r=PG", "display_name": "Tony Han", "link": "https://stackoverflow.com/users/1173351/tony-han"}, "edited": false, "score": 0, "creation_date": 1499842307, "post_id": 45035947, "comment_id": 77074287, "body": "I added some example code. The problem is transaction doesn&#39;t work if I use transaction in the tested code(like <code>foo</code> function)."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1499779680, "creation_date": 1499779680, "answer_id": 45035947, "question_id": 45029545, "link": "https://stackoverflow.com/questions/45029545/how-to-test-go-code-which-uses-databasesmysql/45035947#45035947", "title": "How to test Go code which uses databases(mysql)?", "body": "<p>It's hard to say without seeing code, but based on the error it sounds like you're sharing a connection between multiple tests, and each one is trying to start a transaction. Make sure that each test open its own connection, starts its own transaction, and when it is finished, commits or rolls back and closes the connection.</p>\n"}, {"comments": [{"owner": {"reputation": 1991, "user_id": 1173351, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dc717fb8a7638b9e5513ecc0b82a1b5b?s=128&d=identicon&r=PG", "display_name": "Tony Han", "link": "https://stackoverflow.com/users/1173351/tony-han"}, "edited": false, "score": 0, "creation_date": 1499842412, "post_id": 45049934, "comment_id": 77074361, "body": "I have a mysql to use for testing. But it doesn&#39;t work. btw, I added some example code to explain my problem."}, {"owner": {"reputation": 1991, "user_id": 1173351, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dc717fb8a7638b9e5513ecc0b82a1b5b?s=128&d=identicon&r=PG", "display_name": "Tony Han", "link": "https://stackoverflow.com/users/1173351/tony-han"}, "edited": false, "score": 0, "creation_date": 1499843245, "post_id": 45049934, "comment_id": 77074872, "body": "I see. Your solution is starting a new docker container for every test case. Right?"}, {"owner": {"reputation": 121, "user_id": 4075313, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/01e3584fe39eb72335f13243c3a814a2?s=128&d=identicon&r=PG", "display_name": "Iman Tumorang", "link": "https://stackoverflow.com/users/4075313/iman-tumorang"}, "reply_to_user": {"reputation": 1991, "user_id": 1173351, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dc717fb8a7638b9e5513ecc0b82a1b5b?s=128&d=identicon&r=PG", "display_name": "Tony Han", "link": "https://stackoverflow.com/users/1173351/tony-han"}, "edited": false, "score": 0, "creation_date": 1499843687, "post_id": 45049934, "comment_id": 77075137, "body": "Yes... It will test directly with a live mysql"}, {"owner": {"reputation": 1991, "user_id": 1173351, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dc717fb8a7638b9e5513ecc0b82a1b5b?s=128&d=identicon&r=PG", "display_name": "Tony Han", "link": "https://stackoverflow.com/users/1173351/tony-han"}, "edited": false, "score": 0, "creation_date": 1499843775, "post_id": 45049934, "comment_id": 77075192, "body": "It should work, though I&#39;m not sure wether there&#39;s a better way. I&#39;ll try it."}, {"owner": {"reputation": 121, "user_id": 4075313, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/01e3584fe39eb72335f13243c3a814a2?s=128&d=identicon&r=PG", "display_name": "Iman Tumorang", "link": "https://stackoverflow.com/users/4075313/iman-tumorang"}, "reply_to_user": {"reputation": 1991, "user_id": 1173351, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dc717fb8a7638b9e5513ecc0b82a1b5b?s=128&d=identicon&r=PG", "display_name": "Tony Han", "link": "https://stackoverflow.com/users/1173351/tony-han"}, "edited": false, "score": 0, "creation_date": 1499843872, "post_id": 45049934, "comment_id": 77075261, "body": "With Test suite of testify, you can just starting a single container for all test, no need starting new test for each test case"}, {"owner": {"reputation": 1991, "user_id": 1173351, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dc717fb8a7638b9e5513ecc0b82a1b5b?s=128&d=identicon&r=PG", "display_name": "Tony Han", "link": "https://stackoverflow.com/users/1173351/tony-han"}, "edited": false, "score": 0, "creation_date": 1499844236, "post_id": 45049934, "comment_id": 77075517, "body": "If I use just a single container for all tests, perhaps there&#39;ll be the problem described in my question: how to do cleanup rightly after every test case?"}, {"owner": {"reputation": 121, "user_id": 4075313, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/01e3584fe39eb72335f13243c3a814a2?s=128&d=identicon&r=PG", "display_name": "Iman Tumorang", "link": "https://stackoverflow.com/users/4075313/iman-tumorang"}, "reply_to_user": {"reputation": 1991, "user_id": 1173351, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dc717fb8a7638b9e5513ecc0b82a1b5b?s=128&d=identicon&r=PG", "display_name": "Tony Han", "link": "https://stackoverflow.com/users/1173351/tony-han"}, "edited": false, "score": 0, "creation_date": 1499845493, "post_id": 45049934, "comment_id": 77076317, "body": "You can use DB migrations,  drop the db , each one test case passed, and migrate new Data for a new test case. Or you can reuse the existing data before.    You can use <a href=\"https://github.com/mattes/migrate\" rel=\"nofollow noreferrer\">github.com/mattes/migrate</a> for helping DB migrate in your tests  the drawback is, it might not so fast as a simple test. Because you test directly into a live mysql."}], "tags": [], "owner": {"reputation": 121, "user_id": 4075313, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/01e3584fe39eb72335f13243c3a814a2?s=128&d=identicon&r=PG", "display_name": "Iman Tumorang", "link": "https://stackoverflow.com/users/4075313/iman-tumorang"}, "is_accepted": false, "score": 0, "last_activity_date": 1499840735, "creation_date": 1499840735, "answer_id": 45049934, "question_id": 45029545, "link": "https://stackoverflow.com/questions/45029545/how-to-test-go-code-which-uses-databasesmysql/45049934#45049934", "title": "How to test Go code which uses databases(mysql)?", "body": "<p>Maybe you can doing integration testing using docker. Test directly to spawned container that has a active mysql.</p>\n\n<p>You can use Test suite from testify.\nEvery time you test, run the docker container, and test it with a live mysql.</p>\n"}], "owner": {"reputation": 1991, "user_id": 1173351, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dc717fb8a7638b9e5513ecc0b82a1b5b?s=128&d=identicon&r=PG", "display_name": "Tony Han", "link": "https://stackoverflow.com/users/1173351/tony-han"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 360, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499842200, "creation_date": 1499762533, "last_edit_date": 1499842200, "question_id": 45029545, "link": "https://stackoverflow.com/questions/45029545/how-to-test-go-code-which-uses-databasesmysql", "title": "How to test Go code which uses databases(mysql)?", "body": "<p>I have a gRPC service using MySQL and need to clear records after every test case. I try to wrap every test case with a transaction. It works if there's no transaction in my rpc code but fails if there are. And there'll be errors like:</p>\n\n<pre><code>can't start transaction\n...\nsql: Transaction has already been committed or rolled back\n</code></pre>\n\n<p>Then I try to use truncate to clear the records but some of the test cases fails randomly.</p>\n\n<p>My code is like(I use gorm):</p>\n\n<pre><code>func foo(db *gorm.DB) {\n    tx := db.Begin()\n    // query and insert\n    tx.Commit()\n}\n// Use transaction to do database cleanup\nfunc TestFooVersion1() {\n    testDB := initDB()\n    tx = testDB.Begin() // setup\n    foo(testDB)\n    tx.Rollback() // teardown\n}\n// Use truncate to do database cleanup\nfunc TestFooVersion2() {\n    testDB := initDB()\n    foo(testDB)\n    truncateTables(testDB) // teardown\n}\nfunc truncateTables(db *gorm.DB) {\n    // exec \"TRUNCATE TABLE table;\" for every table\n}\n</code></pre>\n\n<p>What's a proper way to test the code using DB(MySQL)? (I don't like mock like go-sqlmock)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1917, "user_id": 4039768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWQUf.jpg?s=128&g=1", "display_name": "Mohsin", "link": "https://stackoverflow.com/users/4039768/mohsin"}, "edited": false, "score": 0, "creation_date": 1499794906, "post_id": 45027606, "comment_id": 77056672, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/25318154/convert-utc-to-local-time-go\">Convert UTC to &quot;local&quot; time - Go</a>"}, {"owner": {"reputation": 462, "user_id": 5457306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vw1zh.jpg?s=128&g=1", "display_name": "Vallie", "link": "https://stackoverflow.com/users/5457306/vallie"}, "edited": false, "score": 0, "creation_date": 1574962678, "post_id": 45027606, "comment_id": 104421961, "body": "Replace <code>Asia&#47;Delhi</code> with <code>Asia&#47;Calcutta</code>. Refer <a href=\"https://golang.org/src/time/zoneinfo_abbrs_windows.go\" rel=\"nofollow noreferrer\">this</a>"}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 7255164, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh4.googleusercontent.com/-cE2wBWM4mOQ/AAAAAAAAAAI/AAAAAAAAAD0/zi0sUFSB6ug/photo.jpg?sz=128", "display_name": "farsana p b", "link": "https://stackoverflow.com/users/7255164/farsana-p-b"}, "edited": false, "score": 0, "creation_date": 1499758416, "post_id": 45027924, "comment_id": 77030299, "body": "i got expected result when i using  location &quot;Asia/Calcutta&quot;.Is there is any other method for this by providing latitude and longitude of a location @Gov"}, {"owner": {"reputation": 376, "user_id": 953837, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e809f1b811d369a2ff190f45115ed893?s=128&d=identicon&r=PG", "display_name": "Gov", "link": "https://stackoverflow.com/users/953837/gov"}, "reply_to_user": {"reputation": 145, "user_id": 7255164, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh4.googleusercontent.com/-cE2wBWM4mOQ/AAAAAAAAAAI/AAAAAAAAAD0/zi0sUFSB6ug/photo.jpg?sz=128", "display_name": "farsana p b", "link": "https://stackoverflow.com/users/7255164/farsana-p-b"}, "edited": false, "score": 0, "creation_date": 1499758701, "post_id": 45027924, "comment_id": 77030496, "body": "There are a number of ways to find the data from lat/long: <a href=\"https://stackoverflow.com/questions/16086962/how-to-get-a-time-zone-from-a-location-using-latitude-and-longitude-coordinates\" title=\"how to get a time zone from a location using latitude and longitude coordinates\">stackoverflow.com/questions/16086962/&hellip;</a>"}], "tags": [], "owner": {"reputation": 376, "user_id": 953837, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e809f1b811d369a2ff190f45115ed893?s=128&d=identicon&r=PG", "display_name": "Gov", "link": "https://stackoverflow.com/users/953837/gov"}, "is_accepted": false, "score": 3, "last_activity_date": 1499757684, "creation_date": 1499757684, "answer_id": 45027924, "question_id": 45027606, "link": "https://stackoverflow.com/questions/45027606/i-want-to-convert-a-utc-time-into-local-time-by-giving-specific-location-using-g/45027924#45027924", "title": "I want to Convert a UTC Time into local time by giving specific location using golang", "body": "<p>You're getting an error on line 3, you just can't see it because it avoids the <code>if</code> block and so never updates the <code>local</code> variable on line 5.</p>\n\n<p>The reason it fails is because 'Asia/Delhi' is not a valid olsen format.</p>\n\n<p>Add an <code>else</code> block and print out the <code>err.Error()</code> value</p>\n\n<p>See the following link for a list of valid formats:</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/List_of_tz_database_time_zones\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/List_of_tz_database_time_zones</a></p>\n"}, {"tags": [], "owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "is_accepted": false, "score": 4, "last_activity_date": 1550046954, "last_edit_date": 1550046954, "creation_date": 1499759599, "answer_id": 45028551, "question_id": 45027606, "link": "https://stackoverflow.com/questions/45027606/i-want-to-convert-a-utc-time-into-local-time-by-giving-specific-location-using-g/45028551#45028551", "title": "I want to Convert a UTC Time into local time by giving specific location using golang", "body": "<p>You should rewrite your code to handle errors when they occur. The default execution path should be error free. So, after <code>time.LoadLocation</code> check if there is an error:</p>\n\n<pre><code>utc := time.Now().UTC()\nlocal := utc\nlocation, err := time.LoadLocation(\"Asia/Delhi\")\nif err != nil {\n   // execution would stop, you could also print the error and continue with default values\n   log.Fatal(err)\n}\nlocal = local.In(location)\nlog.Println(\"UTC\", utc.Format(\"15:04\"), local.Location(), local.Format(\"15:04\"))\n</code></pre>\n\n<p>Now you'll get something like this error message:</p>\n\n<pre><code>cannot find Asia/Delhi in zip file /usr/local/go/lib/time/zoneinfo.zip\npanic: time: missing Location in call to Time.In\n</code></pre>\n\n<p>You have to find a valid time zome for your location, as others said check Wikipedia for <a href=\"https://en.wikipedia.org/wiki/List_of_tz_database_time_zones\" rel=\"nofollow noreferrer\">time zones</a></p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 7658154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1YQ3p.jpg?s=128&g=1", "display_name": "lisprez", "link": "https://stackoverflow.com/users/7658154/lisprez"}, "is_accepted": false, "score": 0, "last_activity_date": 1550728035, "creation_date": 1550728035, "answer_id": 54800051, "question_id": 45027606, "link": "https://stackoverflow.com/questions/45027606/i-want-to-convert-a-utc-time-into-local-time-by-giving-specific-location-using-g/54800051#54800051", "title": "I want to Convert a UTC Time into local time by giving specific location using golang", "body": "<p>This is just converting UTC time string to your local time string according to your specified layout.</p>\n\n<pre><code>func UTCTimeStr2LocalTimeStr(ts, layout string) (string, error) {                                                                  \n    timeObject, err := time.Parse(time.RFC3339, ts)\n    if err != nil {\n        return \"\", err\n    }\n\n    return time.Unix(timeObject.Unix(), 0).Format(layout), nil\n}\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 7255164, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh4.googleusercontent.com/-cE2wBWM4mOQ/AAAAAAAAAAI/AAAAAAAAAD0/zi0sUFSB6ug/photo.jpg?sz=128", "display_name": "farsana p b", "link": "https://stackoverflow.com/users/7255164/farsana-p-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2799, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1612850461, "creation_date": 1499756666, "question_id": 45027606, "link": "https://stackoverflow.com/questions/45027606/i-want-to-convert-a-utc-time-into-local-time-by-giving-specific-location-using-g", "title": "I want to Convert a UTC Time into local time by giving specific location using golang", "body": "<p>I am a golang developer and i am trying to convert a UTC time into local  time  but my code not working.Here is my code     </p>\n\n<pre><code>utc := time.Now().UTC()\nlocal := utc\nlocation, err := time.LoadLocation(\"Asia/Delhi\")\nif err == nil {\n   local = local.In(location)\n}\nlog.Println(\"UTC\", utc.Format(\"15:04\"), local.Location(), local.Format(\"15:04\"))\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1499779331, "post_id": 45026520, "comment_id": 77045452, "body": "Can you print <code>len(chartList)</code> immediately before you call <code>termui.Render</code> to make sure it&#39;s the expected length?"}], "answers": [{"comments": [{"owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "edited": false, "score": 0, "creation_date": 1499754687, "post_id": 45026651, "comment_id": 77027914, "body": "still getting one value only as an output."}, {"owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "edited": false, "score": 0, "creation_date": 1499755322, "post_id": 45026651, "comment_id": 77028276, "body": "what I am getting is the output for only last element of list. Is there something wrong I am doing while appending elements to list?   I am adding the code in my question, please have a look."}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 1, "last_activity_date": 1499780878, "last_edit_date": 1499780878, "creation_date": 1499753366, "answer_id": 45026651, "question_id": 45026520, "link": "https://stackoverflow.com/questions/45026520/terminal-dashboard-in-golang-using-termui/45026651#45026651", "title": "Terminal dashboard in golang using &quot;termui&quot;", "body": "<p>Here is a good read on <a href=\"https://medium.com/golangspec/variadic-functions-in-go-13c33182b851\" rel=\"nofollow noreferrer\">Variadic Functions</a></p>\n\n<p>Take a look at the function signature of Render, <a href=\"https://github.com/gizak/termui/blob/master/render.go#L161\" rel=\"nofollow noreferrer\">https://github.com/gizak/termui/blob/master/render.go#L161</a></p>\n\n<pre><code>func Render(bs ...Bufferer) {\n</code></pre>\n\n<p>All you need to do is</p>\n\n<pre><code>termui.Render(chatList...)\n</code></pre>\n\n<p>assuming <code>chartList</code> is a <code>[]Bufferer</code></p>\n\n<p><strong>Edit</strong><br>\nYou are only seeing one because they are stacking on top of one-another.  To see this add</p>\n\n<pre><code>g0.Height = 3\ng0.Y = i * g0.Height            // &lt;-- add this line\ng0.BorderLabel = \"Slim Gauge\" \n</code></pre>\n\n<p>From a quick review of the project, it appears there are ways for auto-arranging that have to do with creating rows (and probably columns).  So you might want to explore that, or you will need to manually position your elements.</p>\n\n<p><a href=\"https://i.stack.imgur.com/daGvd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/daGvd.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 902, "favorite_count": 0, "accepted_answer_id": 45026651, "answer_count": 1, "score": 1, "last_activity_date": 1499780878, "creation_date": 1499752839, "last_edit_date": 1499755679, "question_id": 45026520, "link": "https://stackoverflow.com/questions/45026520/terminal-dashboard-in-golang-using-termui", "title": "Terminal dashboard in golang using &quot;termui&quot;", "body": "<p>I am working on drawing graphs on the terminal itself from inside a go code.I found this (<a href=\"https://github.com/gizak/termui\" rel=\"nofollow noreferrer\">https://github.com/gizak/termui</a>) in golang. And used this(<a href=\"https://github.com/gizak/termui/blob/master/_example/gauge.go\" rel=\"nofollow noreferrer\">https://github.com/gizak/termui/blob/master/_example/gauge.go</a>) to draw graph in my code.</p>\n\n<p>Problem is this , as we can see in the code( <a href=\"https://github.com/gizak/termui/blob/master/_example/gauge.go\" rel=\"nofollow noreferrer\">https://github.com/gizak/termui/blob/master/_example/gauge.go</a> ), they are passing g0,g1,g2,g3 all together in the end \"termui.Render(g0, g1, g2, g3, g4)\".\nIn my case I don't know how many gauges to draw before hand so I used a list to store gauge objects and then tried to pass list to render.</p>\n\n<pre><code>    termui.Render(chartList...)\n</code></pre>\n\n<p>But it creates only one gauge.</p>\n\n<p>This is how I am appending elements in the list.</p>\n\n<pre><code>   for i := 0; i &lt; 5; i++ {\n        g0 := termui.NewGauge()\n        g0.Percent = i\n        g0.Width = 50\n        g0.Height = 3\n        g0.BorderLabel = \"Slim Gauge\"\n        chartList = append(chartList, g0)\n    }\n</code></pre>\n\n<p>what I am getting is a gauge for i=4 only. when I am doing termui.Render(chartList...)\nAm I doing something wrong?\nPS - I have modified question based on the answer I got in this question.</p>\n"}, {"tags": ["go", "struct", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": false, "score": 2, "last_activity_date": 1499751827, "creation_date": 1499751827, "answer_id": 45026260, "question_id": 45025850, "link": "https://stackoverflow.com/questions/45025850/how-to-implement-setter-for-exported-field-in-golang/45026260#45026260", "title": "How to implement setter for exported field in Golang?", "body": "<p>Your understanding is correct about unexported field with method.</p>\n\n<p>Your <code>struct</code> Fields have to be exported then only <code>gorm</code> will have access to it. That is Go way.</p>\n\n<p>So you have 2 options.</p>\n\n<p>Option 1: taking advantage of gorm callback <a href=\"http://jinzhu.me/gorm/callbacks.html#querying-an-object\" rel=\"nofollow noreferrer\">AfterFind</a>. Basically your struct have to implement this callback. After find you have to update the field <code>Name</code>.</p>\n\n<p>Option 2: Implement as part of your data fetch method. Update the field <code>Name</code> before returning to the caller.</p>\n"}], "owner": {"reputation": 101, "user_id": 5623764, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/3f86dd02deab4f3e583862028aaf4177?s=128&d=identicon&r=PG&f=1", "display_name": "maryj", "link": "https://stackoverflow.com/users/5623764/maryj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527757188, "creation_date": 1499749740, "last_edit_date": 1527757188, "question_id": 45025850, "link": "https://stackoverflow.com/questions/45025850/how-to-implement-setter-for-exported-field-in-golang", "title": "How to implement setter for exported field in Golang?", "body": "<p>I'm using <code>gorm</code> lib and to use that lib, I have to export all column fields. Something like this</p>\n\n<pre><code>type myType struct {\n  Id int\n  Name string\n}\n</code></pre>\n\n<p>But with that, how to I deal with addition logics for struct fields. Let's say, what if I want to prefix <code>Mr</code> to the <code>Name</code> field? The client can always do <code>myType.Name = \"whatever\"</code>. If I make <code>Name</code> to be unexported and have setter for it, that field will never work with <code>gorm</code>. Any golang-way to deal with this?</p>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1499749405, "post_id": 45025456, "comment_id": 77025637, "body": "Please show content of result.html and also .go file which is calling this template."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1499749577, "creation_date": 1499749577, "answer_id": 45025820, "question_id": 45025456, "link": "https://stackoverflow.com/questions/45025456/cant-find-templatefile/45025820#45025820", "title": "Can&#39;t find templatefile", "body": "<p>You can see the code producing this error in <a href=\"https://github.com/astaxie/beego/blob/7452151beec2f43c42122fd91b7523bcbccf05be/template.go#L52-L76\" rel=\"nofollow noreferrer\"><code>template.go</code></a></p>\n\n<p><a href=\"https://github.com/astaxie/beego/issues/1989\" rel=\"nofollow noreferrer\">This issue</a> mentions:</p>\n\n<blockquote>\n  <p>Please use the <code>bee run</code>, as <code>go get</code> install the binary into the <code>gopath/bin</code>, while the static file still in the <code>gopath/src/myproject</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 123, "user_id": 7817561, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/51b425bc125646b414d4400f96200fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Yi Luo", "link": "https://stackoverflow.com/users/7817561/yi-luo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 700, "favorite_count": 1, "accepted_answer_id": 45025820, "answer_count": 1, "score": 1, "last_activity_date": 1499749577, "creation_date": 1499747543, "last_edit_date": 1499748016, "question_id": 45025456, "link": "https://stackoverflow.com/questions/45025456/cant-find-templatefile", "title": "Can&#39;t find templatefile", "body": "<p>I have a beego project in IdeaProject. The structure is like this:</p>\n\n<pre><code>MathApp\n\u251c\u2500\u2500 conf\n\u2502   \u2514\u2500\u2500 app.conf\n\u251c\u2500\u2500 main.go\n\u251c\u2500\u2500 main_test.go\n\u2514\u2500\u2500 views\n    \u251c\u2500\u2500 invalid-route.html\n    \u2514\u2500\u2500 result.html\n</code></pre>\n\n<p>However, it shows the error <code>can't find templatefile in the path:views/result.html</code>. I have set the <code>gopath</code> as <code>C:/gopath</code>.</p>\n\n<p>Any suggestion?</p>\n"}, {"tags": ["firebase", "go", "firebase-realtime-database"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 6265099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1cf4ab5937cbde28db073128ff3968?s=128&d=identicon&r=PG&f=1", "display_name": "Rikcat Kristian Lumban Gaol", "link": "https://stackoverflow.com/users/6265099/rikcat-kristian-lumban-gaol"}, "edited": false, "score": 0, "creation_date": 1499751499, "post_id": 45026053, "comment_id": 77026356, "body": "if i don&#39;t know this child (Koja8GuFpIEN3kjbfPO) how i can update in data IDAgent = 7 ?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 85, "user_id": 6265099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1cf4ab5937cbde28db073128ff3968?s=128&d=identicon&r=PG&f=1", "display_name": "Rikcat Kristian Lumban Gaol", "link": "https://stackoverflow.com/users/6265099/rikcat-kristian-lumban-gaol"}, "edited": false, "score": 0, "creation_date": 1499752049, "post_id": 45026053, "comment_id": 77026598, "body": "It is not possible to update, you need to know the key path of the child object you&#39;re updating. Refer to the firebase doc I mentioned in the answer.  firego client internally sends the HTTP PATCH request with json for updating the value."}, {"owner": {"reputation": 85, "user_id": 6265099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1cf4ab5937cbde28db073128ff3968?s=128&d=identicon&r=PG&f=1", "display_name": "Rikcat Kristian Lumban Gaol", "link": "https://stackoverflow.com/users/6265099/rikcat-kristian-lumban-gaol"}, "edited": false, "score": 0, "creation_date": 1499754460, "post_id": 45026053, "comment_id": 77027776, "body": "can i get key path where ID Agent = 7? or it is impossible?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 85, "user_id": 6265099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1cf4ab5937cbde28db073128ff3968?s=128&d=identicon&r=PG&f=1", "display_name": "Rikcat Kristian Lumban Gaol", "link": "https://stackoverflow.com/users/6265099/rikcat-kristian-lumban-gaol"}, "edited": false, "score": 0, "creation_date": 1499754749, "post_id": 45026053, "comment_id": 77027949, "body": "Firebase data structure is typically JSON data. Via HTTP request you&#39;re accessing and manipulating. The URL Path you&#39;re using for this <code>ref.OrderBy(&quot;IDAgent&quot;)</code> object is your key path."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 1, "last_activity_date": 1499750950, "creation_date": 1499750950, "answer_id": 45026053, "question_id": 45025447, "link": "https://stackoverflow.com/questions/45025447/how-i-can-update-data-firebase-with-specific-key-in-golang/45026053#45026053", "title": "How i can update data firebase with specific key in golang?", "body": "<p>In two ways you can do, as per <a href=\"https://www.firebase.com/docs/rest/guide/saving-data.html#section-update\" rel=\"nofollow noreferrer\">Firebase doc</a> with firego client library. Drafted answer based on from firego <a href=\"https://github.com/zabawaba99/firego/blob/v1/README.md\" rel=\"nofollow noreferrer\">README.md</a>. </p>\n\n<p><em>Note: You have not provided the complete path of the structure, I have drafted the answer based on screenshot. So update your JSON path accordingly.</em> </p>\n\n<p>Approach 1:</p>\n\n<pre><code>f := firego.New(\"https://my-firebase-app.firebaseIO.com/active-chat/Koja8GuFpIEN3kjbfPO.json\", nil)\n\nx := map[string]string{\n   \"Status\": \"OFF\",\n}\nif err := f.Update(x); err != nil {\n  log.Fatal(err)\n}\n</code></pre>\n\n<p>Approach 2:</p>\n\n<pre><code>f := firego.New(\"https://my-firebase-app.firebaseIO.com\", nil)\nf = f.Ref(\"/active-chat/Koja8GuFpIEN3kjbfPO.json\")\n\nx := map[string]string{\n   \"Status\": \"OFF\",\n}\nif err := f.Update(x); err != nil {\n  log.Fatal(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 6265099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1cf4ab5937cbde28db073128ff3968?s=128&d=identicon&r=PG&f=1", "display_name": "Rikcat Kristian Lumban Gaol", "link": "https://stackoverflow.com/users/6265099/rikcat-kristian-lumban-gaol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "accepted_answer_id": 45026053, "answer_count": 1, "score": 1, "last_activity_date": 1499752138, "creation_date": 1499747476, "last_edit_date": 1499752138, "question_id": 45025447, "link": "https://stackoverflow.com/questions/45025447/how-i-can-update-data-firebase-with-specific-key-in-golang", "title": "How i can update data firebase with specific key in golang?", "body": "<p>I am using golang and <a href=\"https://github.com/zabawaba99/firego\" rel=\"nofollow noreferrer\">firego</a> for connecting to Firebase. I want to update my data <code>Status</code>from ON to OFF with key <code>IDAgent: 7</code>. This is my Database Structure</p>\n\n<p><a href=\"https://i.stack.imgur.com/VWM4J.png\" rel=\"nofollow noreferrer\">Image</a></p>\n\n<p><em>Assumption : I don't know child active_chat. How can i update data in active_chat/-Koja8GuFplEN3kjbfPO where IDAgent = 7</em></p>\n\n<p>I have tried this code </p>\n\n<pre><code>x := map[string]string{\"Status\": \"OFF\"}\nref.OrderBy(\"IDAgent\").EqualTo(\"7\").Update(x)\n</code></pre>\n\n<p>but this code wrong query. </p>\n"}, {"tags": ["date", "go"], "comments": [{"owner": {"reputation": 4946, "user_id": 2656614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/rJz0Z.png?s=128&g=1", "display_name": "Addison", "link": "https://stackoverflow.com/users/2656614/addison"}, "edited": false, "score": 0, "creation_date": 1499745671, "post_id": 45024526, "comment_id": 77024364, "body": "Do you still want to factor in the timezone? For example, <code>2017-01-01T22:00:00+00:00</code> and <code>2017-01-02T02:00:00+04:00</code> are the same moment in time - But are described with different time zones."}, {"owner": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "reply_to_user": {"reputation": 4946, "user_id": 2656614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/rJz0Z.png?s=128&g=1", "display_name": "Addison", "link": "https://stackoverflow.com/users/2656614/addison"}, "edited": false, "score": 0, "creation_date": 1499745810, "post_id": 45024526, "comment_id": 77024419, "body": "That&#39;s a good question, the dates I work with are assumed UTC, so it doesn&#39;&#39;t matter that much. But if they had different time zones, I would need to take that into account."}, {"owner": {"reputation": 4946, "user_id": 2656614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/rJz0Z.png?s=128&g=1", "display_name": "Addison", "link": "https://stackoverflow.com/users/2656614/addison"}, "edited": false, "score": 0, "creation_date": 1499745949, "post_id": 45024526, "comment_id": 77024461, "body": "Well, in that case, eugenioy&#39;s answer seems to cover it. FYI - their answer does take the timezones into account, so those two dates I mentioned would be considered the same day, and thus 0 hours apart."}], "answers": [{"comments": [{"owner": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "edited": false, "score": 0, "creation_date": 1499745555, "post_id": 45024588, "comment_id": 77024334, "body": "Ok, I see. I read through the API docs before but wasn&#39;t sure what to make out of the <code>Truncate</code> method. I will give this a try, thank you."}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 4, "last_activity_date": 1499741578, "creation_date": 1499741578, "answer_id": 45024588, "question_id": 45024526, "link": "https://stackoverflow.com/questions/45024526/comparing-two-dates-without-taking-time-into-account/45024588#45024588", "title": "Comparing two dates without taking time into account", "body": "<p>You could <a href=\"https://golang.org/pkg/time/#Time.Truncate\" rel=\"nofollow noreferrer\"><code>Truncate</code></a> the times to make them round to a multiple of a day.</p>\n\n<p>In your example:</p>\n\n<pre><code>oneDay := 24 * time.Hour\na = a.Truncate(oneDay)\nb = b.Truncate(oneDay)\n</code></pre>\n\n<p>Find a playground with the adapted code here: <a href=\"https://play.golang.org/p/yWIYt3UkiT\" rel=\"nofollow noreferrer\">https://play.golang.org/p/yWIYt3UkiT</a></p>\n"}, {"tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 0, "last_activity_date": 1499875290, "creation_date": 1499875290, "answer_id": 45062651, "question_id": 45024526, "link": "https://stackoverflow.com/questions/45024526/comparing-two-dates-without-taking-time-into-account/45062651#45062651", "title": "Comparing two dates without taking time into account", "body": "<p>You have to be rather careful handling dates if using time.Time because there can be edge cases around the beginning and ending of daylight savings.</p>\n\n<p>Shameless plug: I wrote a Date package (actually it was derived from someone else's earlier work) to deal with dates without incurring the DST issues.</p>\n\n<p><a href=\"https://github.com/rickb777/date\" rel=\"nofollow noreferrer\">https://github.com/rickb777/date</a></p>\n\n<p>You can do, for example,</p>\n\n<pre><code>a := date.New(2017, 2, 1)\nb := date.New(2017, 2, 11)\ndaysDifference := b.Sub(a)\nfmt.Println(daysDifference)\n</code></pre>\n\n<hr>\n\n<p>There are other sub-packages to handle date ranges, timespans, ISO8601 periods and clock-face time.</p>\n"}], "owner": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1764, "favorite_count": 0, "accepted_answer_id": 45024588, "answer_count": 2, "score": 3, "last_activity_date": 1499875290, "creation_date": 1499741122, "question_id": 45024526, "link": "https://stackoverflow.com/questions/45024526/comparing-two-dates-without-taking-time-into-account", "title": "Comparing two dates without taking time into account", "body": "<p>I have two dates like this, I would like to compare only the dates, ignoring the time. Currently I have this:</p>\n\n<pre><code>package main\n\nimport (\n    \"time\"\n    //\"fmt\"\n)\n\nfunc main() {\n    a, _ := time.Parse(time.RFC3339, \"2017-02-01T12:00:00+00:00\")\n    b, _ := time.Parse(time.RFC3339, \"2017-02-11T14:30:00+00:00\")\n\n    x := b.Sub(a)\n\n    println(int(x.Hours()))\n}\n</code></pre>\n\n<p>Which prints <code>242</code>. That is correct, but what I actually want to do is compare the dates like this:</p>\n\n<pre><code>    a, _ := time.Parse(time.RFC3339, \"2017-02-01T00:00:00+00:00\")\n    b, _ := time.Parse(time.RFC3339, \"2017-02-11T00:00:00+00:00\")\n</code></pre>\n\n<p>Notice: minutes/hours/seconds have been set to zero - the diff will now be 240 hours. </p>\n\n<p>I couldn't really figure out how to do this, is there a <code>time.SetTime(0, 0, 0)</code> function in Go that I missed or what's the canonical way to reset the time for a date? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1499738967, "post_id": 45024152, "comment_id": 77022793, "body": "use <code>DockerClient</code> instead of <code>*DockerClient</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "reply_to_user": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1499739067, "post_id": 45024152, "comment_id": 77022813, "body": "@Motakjuq I&#39;ve tried this but you get the same error"}, {"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1499739508, "post_id": 45024152, "comment_id": 77022894, "body": "I didn&#39;t see it before, but <code>&amp;DockerUtil{....</code> is using <code>client</code> instead of <code>dockerClient</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "reply_to_user": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1499739606, "post_id": 45024152, "comment_id": 77022913, "body": "@Motakjuq that&#39;s a copy/paste mistake I&#39;ll fix it, the compiler error in question occurs on the commented line"}, {"owner": {"reputation": 3287, "user_id": 2898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/ancqg.jpg?s=128&g=1", "display_name": "Krzysztof Kowalczyk", "link": "https://stackoverflow.com/users/2898/krzysztof-kowalczyk"}, "edited": false, "score": 0, "creation_date": 1499740706, "post_id": 45024152, "comment_id": 77023144, "body": "Please post the whole, exact error message. It probably has the necessary information for us to figure out the issue."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "edited": false, "score": 0, "creation_date": 1499742233, "post_id": 45024418, "comment_id": 77023501, "body": "the error I get now is <code>non-interface type *Client on the left</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "edited": false, "score": 0, "creation_date": 1499742542, "post_id": 45024418, "comment_id": 77023568, "body": "I figured it out, I was using the wrong <code>context</code> pkg"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1499743981, "post_id": 45024418, "comment_id": 77023900, "body": "Does it help you?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "edited": false, "score": 0, "creation_date": 1499801451, "post_id": 45024418, "comment_id": 77060410, "body": "Well, not really, the solution was to make sure i was using the correct <code>context</code> package, I didn&#39;t know that Docker was using <code>golang.org&#47;x&#47;net&#47;context</code> as opposed to the stdlib <code>context</code>"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1499801665, "post_id": 45024418, "comment_id": 77060510, "body": "Okay, I believe answer gives an information for interface implementation. Happy coding."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "edited": false, "score": 0, "creation_date": 1499806354, "post_id": 45024418, "comment_id": 77062915, "body": "Yeah not using pointers for interface was helpful I&#39;ll give you the answer"}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": -1, "last_activity_date": 1499740374, "creation_date": 1499740374, "answer_id": 45024418, "question_id": 45024152, "link": "https://stackoverflow.com/questions/45024152/error-when-trying-to-inject-dependency/45024418#45024418", "title": "Error when trying to inject dependency", "body": "<p>Let's start with using <code>interface{}</code>, when you define interface don't use pointer definition, <a href=\"https://medium.com/@agileseeker/go-interfaces-pointers-4d1d98d5c9c6\" rel=\"nofollow noreferrer\">good read here</a>.</p>\n\n<pre><code>type DockerUtil struct{\n    Client        DockerClient\n}\n</code></pre>\n\n<p>And moby <a href=\"https://godoc.org/github.com/moby/moby/client#Client\" rel=\"nofollow noreferrer\">Client</a> implements lot of methods and you would like to do <code>interface</code> for selective methods.</p>\n\n<blockquote>\n  <p>Right way to do is via Type assertion. Good read <a href=\"https://golang.org/doc/effective_go.html#interface_conversions\" rel=\"nofollow noreferrer\">Effective Go - Type assertions</a> and <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">Spec - Type assertion</a>.</p>\n</blockquote>\n\n<p><strong><em>Note:</strong> try this code, I don't have docker env in my machine to test.</em></p>\n\n<pre><code>func NewDockerUtil() (*DockerUtil, error) {\n    dockerClient, err := client.NewEnvClient()\n    if err != nil {\n        return nil, err\n    }\n    return &amp;DockerUtil{\n        Client:        dockerClient.(DockerClient),\n    }, nil\n}\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>Using <code>DockerUtil.Client</code>, you can call only <code>Ping</code> method since your interface <code>DockerClient</code> has definition of <code>Ping</code> method.</p>\n\n<hr>\n\n<p>If you would like to call all the methods supported by <code>client.Client</code> later on then you have to do type assertion-</p>\n\n<pre><code>dockerClient := DockerUtil.Client.(*client.Client)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1757, "favorite_count": 0, "accepted_answer_id": 45024418, "answer_count": 1, "score": 1, "last_activity_date": 1499740374, "creation_date": 1499738102, "last_edit_date": 1499739656, "question_id": 45024152, "link": "https://stackoverflow.com/questions/45024152/error-when-trying-to-inject-dependency", "title": "Error when trying to inject dependency", "body": "<p>I'm trying refactor some code to use dependency injection for the <a href=\"https://godoc.org/github.com/moby/moby/client#Client.Ping\" rel=\"nofollow noreferrer\">Docker client library</a> I use in my code. I created an interface with the method I want to be able to mock\n</p>\n\n<pre><code>type DockerClient interface {\n    Ping(context.Context) (types.Ping, error)\n}\n\nfunc NewDockerUtil() (*DockerUtil, error) {\n    var dockerClient *DockerClient\n    var err error\n    dockerClient, err = client.NewEnvClient() //Reports incompatible types in binary and unary expressions.\n    if err != nil {\n        return nil, err\n    }\n    return &amp;DockerUtil{\n        Client:        dockerClient,\n    }, nil\n}\n\ntype DockerUtil struct{\n    Client        *DockerClient\n}\n</code></pre>\n\n<p>But when I try to assign it I get <code>Reports incompatible types in binary and unary expressions.</code> What exactly do I need to change?</p>\n"}, {"tags": ["go", "google-cloud-platform", "kubernetes", "google-kubernetes-engine", "stackdriver"], "answers": [{"comments": [{"owner": {"reputation": 7628, "user_id": 4885784, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9b10fe019f6c7800bef029835802cb38?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Kobe", "link": "https://stackoverflow.com/users/4885784/daniel-kobe"}, "edited": false, "score": 0, "creation_date": 1595050787, "post_id": 45085569, "comment_id": 111346742, "body": "how did you fix this?"}, {"owner": {"reputation": 2982, "user_id": 101969, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/48654d1f98a490b18d91d85945d65a93?s=128&d=identicon&r=PG", "display_name": "Sylvain", "link": "https://stackoverflow.com/users/101969/sylvain"}, "reply_to_user": {"reputation": 7628, "user_id": 4885784, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9b10fe019f6c7800bef029835802cb38?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Kobe", "link": "https://stackoverflow.com/users/4885784/daniel-kobe"}, "edited": false, "score": 0, "creation_date": 1595068804, "post_id": 45085569, "comment_id": 111350890, "body": "what is there to fix ? I was just not looking at the right place."}, {"owner": {"reputation": 7628, "user_id": 4885784, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9b10fe019f6c7800bef029835802cb38?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Kobe", "link": "https://stackoverflow.com/users/4885784/daniel-kobe"}, "edited": false, "score": 0, "creation_date": 1595089212, "post_id": 45085569, "comment_id": 111356797, "body": "How can you get labels to match the labels of the logs that are emitted from stdout?"}], "tags": [], "owner": {"reputation": 2982, "user_id": 101969, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/48654d1f98a490b18d91d85945d65a93?s=128&d=identicon&r=PG", "display_name": "Sylvain", "link": "https://stackoverflow.com/users/101969/sylvain"}, "is_accepted": true, "score": 4, "last_activity_date": 1499960858, "creation_date": 1499960858, "answer_id": 45085569, "question_id": 45022651, "link": "https://stackoverflow.com/questions/45022651/logging-using-stackdriver-api-on-kubernetes-google-container-engine-gke/45085569#45085569", "title": "Logging using Stackdriver API on Kubernetes / Google Container Engine (GKE)", "body": "<p>So turns out the log were there but not where I'd expect them.</p>\n\n<p>Using the gcloud CLI I could see those logs got the resource type <code>gce_instance</code> and therefore appears in the <code>GCE VM Instance</code> category</p>\n\n<p>To figure this out:</p>\n\n<pre><code>  $ gcloud beta logging logs list\n  projects/&lt;PROJECT&gt;/logs/&lt;LOG_NAME&gt;\n  ...\n</code></pre>\n\n<p>then</p>\n\n<pre><code>$ gcloud beta logging read projects/&lt;PROJECT&gt;/logs/&lt;LOG_NAME&gt;\n---\ninsertId: ...\njsonPayload:\n   ...\nlogName: ...\nreceiveTimestamp: ...\nresource:\n  labels:\n    instance_id: ...\n    project_id: ...\n    zone: ...\n  type: gce_instance\ntimestamp: ...\n</code></pre>\n\n<p>Note <code>type</code> being <code>gce_instance</code></p>\n"}], "owner": {"reputation": 2982, "user_id": 101969, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/48654d1f98a490b18d91d85945d65a93?s=128&d=identicon&r=PG", "display_name": "Sylvain", "link": "https://stackoverflow.com/users/101969/sylvain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 0, "accepted_answer_id": 45085569, "answer_count": 1, "score": 0, "last_activity_date": 1499960858, "creation_date": 1499725972, "last_edit_date": 1499811491, "question_id": 45022651, "link": "https://stackoverflow.com/questions/45022651/logging-using-stackdriver-api-on-kubernetes-google-container-engine-gke", "title": "Logging using Stackdriver API on Kubernetes / Google Container Engine (GKE)", "body": "<p>I have a go application that leverages Google Cloud Logging API.</p>\n\n<p>The relevant code is the same as this sample from their documentation: <a href=\"https://github.com/GoogleCloudPlatform/golang-samples/blob/master/logging/logging_quickstart/main.go\" rel=\"nofollow noreferrer\">https://github.com/GoogleCloudPlatform/golang-samples/blob/master/logging/logging_quickstart/main.go</a></p>\n\n<p>After checking it works with minikube (my payload appears in the <code>Global</code> category of my logs viewer), I deploy the app on Google Container Engine (GKE). </p>\n\n<p>Once deployed there, I can no longer see the logs the app sends through the logging API.\nThe logs written to std appears in the <code>GKE container</code> category, but no trace of the entries I send using the API.</p>\n\n<p>My cluster has Stackdriver logging API enabled / write only, the default service account is Editor (even tried with Owner), I also tried with a dedicated service account (using the env <code>GOOGLE_APPLICATION_CREDENTIALS</code>) with log writer or even owner access, I can\u2019t see the logs and no error are reported from the client library.</p>\n\n<p>What could be the cause or where could I start debugging such issue?</p>\n\n<p>Thank you,</p>\n"}, {"tags": ["linux", "file", "go", "symlink"], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 5225081, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/88eacba7df7f23affd7a197753f2696b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/5225081/j-doe"}, "edited": false, "score": 0, "creation_date": 1499798575, "post_id": 45024137, "comment_id": 77058842, "body": "If /Users/jeeva/test1 is symlink that&#39;s pointing to path that does not actually exist on the file system (ie &quot;/Users/jeeva/does_not_exist&quot; ), would it still return &quot;Actual Path: &quot;/Users/jeeva/does_not_exist&quot;&quot;?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 293, "user_id": 5225081, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/88eacba7df7f23affd7a197753f2696b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/5225081/j-doe"}, "edited": false, "score": 0, "creation_date": 1499799414, "post_id": 45024137, "comment_id": 77059313, "body": "When actual path is not exists then you will get an error while evaluating symlink <code>filepath.EvalSymlinks(*path)</code>. Error format would be like this <code>lstat &#47;Users&#47;jeeva&#47;does_not_exist: no such file or directory</code>. So you can do simple string manipulate to extract the actual path. Shall I update the answer for this string manipulation or will you take care?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 293, "user_id": 5225081, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/88eacba7df7f23affd7a197753f2696b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/5225081/j-doe"}, "edited": false, "score": 0, "creation_date": 1499800027, "post_id": 45024137, "comment_id": 77059662, "body": "@J.Doe I have just updated the answer for you, have fun. Now you can accept the answer."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": false, "score": 0, "last_activity_date": 1499799973, "last_edit_date": 1499799973, "creation_date": 1499738008, "answer_id": 45024137, "question_id": 45022633, "link": "https://stackoverflow.com/questions/45022633/resolving-broken-symbolic-links/45024137#45024137", "title": "Resolving broken symbolic links", "body": "<p>Use <a href=\"http://golang.org/pkg/os/#Lstat\" rel=\"nofollow noreferrer\">os.Lstat</a> func:</p>\n\n<blockquote>\n  <p>Lstat returns a FileInfo describing the named file. If the file is a symbolic link, the returned FileInfo describes the symbolic link. Lstat makes no attempt to follow the link. If there is an error, it will be of type *PathError.</p>\n</blockquote>\n\n<p>So you can use returned <code>os.FileInfo</code> value to check whether it's a symlink or not.</p>\n\n<pre><code>fileInfo.Mode()&amp;os.ModeSymlink != 0\n</code></pre>\n\n<p>At this point you know that given path is symlink.</p>\n\n<hr>\n\n<p>If you would like to get the actual path of symlink that is pointing to, use</p>\n\n<pre><code>filepath.EvalSymlinks(path)\n</code></pre>\n\n<hr>\n\n<p><strong>Your updated code:</strong></p>\n\n<pre><code>func handleSymlink(path *string) (bool, error) {\n    fileInfo, err := os.Lstat(*path)\n    if os.IsNotExist(err) || err != nil {\n        return false, err\n    }\n\n    // Check path is symlink or not\n    if fileInfo.Mode()&amp;os.ModeSymlink != 0 {\n        actualPath, err := filepath.EvalSymlinks(*path)\n        if err != nil {\n            // Extract actual path from error msg\n            apath := strings.Split(err.Error(), \":\")[0]\n            *path = strings.Split(apath, \" \")[1]\n            return false, err\n        }\n        *path = actualPath\n        return true, nil\n    }\n\n    return false, nil\n}\n\nfunc main() {\n    path := \"/Users/jeeva/test1\"\n    result, err := handleSymlink(&amp;path)\n    fmt.Println(\"Error:\", err)\n    fmt.Println(\"Result:\", result)\n    fmt.Println(\"Actual Path:\", path)\n}\n</code></pre>\n\n<hr>\n\n<p>Let's say we have following paths:</p>\n\n<pre><code>/Users/jeeva/test1 (symlink, pointing to /Users/jeeva/actualpath)\n/Users/jeeva/actualpath\n/Users/jeeva/actualpath2\n</code></pre>\n\n<p>If given path exists and it's a symlink:</p>\n\n<pre><code>#Input:\n/Users/jeeva/test1\n\n#Output:\nError: &lt;nil&gt;\nResult: true\nActual Path: /Users/jeeva/actualpath\n</code></pre>\n\n<p>If given path is not exists:</p>\n\n<pre><code>#Input:\n/Users/jeeva/test1\n\n#Output:\nError lstat /Users/jeeva/notexists: no such file or directory\nResult: false\nActual Path: /Users/jeeva/notexists\n</code></pre>\n\n<p>If given path is exists and it's not a symlink:</p>\n\n<pre><code>#Input:\n/Users/jeeva/actualpath2\n\n#Output:\nError &lt;nil&gt;\nResult: false\nActual Path: /Users/jeeva/actualpath2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4456, "user_id": 4127569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b728c7d6c1dce81f5a82249b7617756?s=128&d=identicon&r=PG&f=1", "display_name": "jch", "link": "https://stackoverflow.com/users/4127569/jch"}, "is_accepted": false, "score": 0, "last_activity_date": 1499826608, "creation_date": 1499826608, "answer_id": 45047361, "question_id": 45022633, "link": "https://stackoverflow.com/questions/45022633/resolving-broken-symbolic-links/45047361#45047361", "title": "Resolving broken symbolic links", "body": "<p>You want the Unix system call <code>readlink</code>, which is exported in Go as <code>os.Readlink</code>.  It reads the content of a symlink and does no further processing \u2014 no checking for existence or recursive processing.</p>\n\n<pre><code>target, err := os.Readlink(\"test1\")\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 5225081, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/88eacba7df7f23affd7a197753f2696b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/5225081/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1796, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1499826608, "creation_date": 1499725862, "last_edit_date": 1499734193, "question_id": 45022633, "link": "https://stackoverflow.com/questions/45022633/resolving-broken-symbolic-links", "title": "Resolving broken symbolic links", "body": "<p>I want my Go program to resolve the targets of a few symlinks. The only trouble is these symlinks will be pointing to destinations that do not actually exist, which is fine because I do some filepath manipulations afterwards. Is this even possible? If I do a \"readlink -f \", I do get a nil result with exit code 1.</p>\n\n<pre><code>// path is the filepath of a symlink\n// this symlink will most likely be pointing to a non-existent file/location\n// this is fine and is handled elsewhere\nfunc handleSymlink(path *string) (bool, error) {\n    f, err := os.Lstat(*path)\n    if err != nil {\n        return false, err\n    }\n\n    // if f is nil, then this is not a symlink\n    if f == nil {\n        return false, nil\n    }\n\n    ln, err := os.Readlink(*path)\n    //ln, err := filepath.EvalSymlinks(*path)\n\n    // ignore IsNotExist errors...this is expected\n    if !os.IsNotExist(err) {\n        return false, err\n    }\n\n    path = &amp;ln\n    return true, nil \n} \n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 1, "creation_date": 1499977546, "post_id": 45021734, "comment_id": 77153073, "body": "Further confirmation your working example is appropriate  <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">golang.org/doc/faq#convert_slice_of_interface</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13651, "user_id": 1509733, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b999a449f3dcbf15ff4278738bdbd47a?s=128&d=identicon&r=PG&f=1", "display_name": "ave", "link": "https://stackoverflow.com/users/1509733/ave"}, "edited": false, "score": 0, "creation_date": 1499724889, "post_id": 45022422, "comment_id": 77019214, "body": "Ah, that&#39;s because I&#39;m getting those records from a database and the database library returns the records in such form."}, {"owner": {"reputation": 886, "user_id": 8170773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61b971ec934427a008d8b263ad4142b9?s=128&d=identicon&r=PG&f=1", "display_name": "hedgar2017", "link": "https://stackoverflow.com/users/8170773/hedgar2017"}, "reply_to_user": {"reputation": 13651, "user_id": 1509733, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b999a449f3dcbf15ff4278738bdbd47a?s=128&d=identicon&r=PG&f=1", "display_name": "ave", "link": "https://stackoverflow.com/users/1509733/ave"}, "edited": false, "score": 0, "creation_date": 1499724995, "post_id": 45022422, "comment_id": 77019269, "body": "Why not that way either?"}, {"owner": {"reputation": 13651, "user_id": 1509733, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b999a449f3dcbf15ff4278738bdbd47a?s=128&d=identicon&r=PG&f=1", "display_name": "ave", "link": "https://stackoverflow.com/users/1509733/ave"}, "edited": false, "score": 0, "creation_date": 1499725217, "post_id": 45022422, "comment_id": 77019374, "body": "I tried it, but in this case MarshalPayload simply doesn&#39;t write anything to Stdout. No errors though."}, {"owner": {"reputation": 886, "user_id": 8170773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61b971ec934427a008d8b263ad4142b9?s=128&d=identicon&r=PG&f=1", "display_name": "hedgar2017", "link": "https://stackoverflow.com/users/8170773/hedgar2017"}, "reply_to_user": {"reputation": 13651, "user_id": 1509733, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b999a449f3dcbf15ff4278738bdbd47a?s=128&d=identicon&r=PG&f=1", "display_name": "ave", "link": "https://stackoverflow.com/users/1509733/ave"}, "edited": false, "score": 0, "creation_date": 1499725444, "post_id": 45022422, "comment_id": 77019443, "body": "What (which type) does the database return?"}, {"owner": {"reputation": 13651, "user_id": 1509733, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b999a449f3dcbf15ff4278738bdbd47a?s=128&d=identicon&r=PG&f=1", "display_name": "ave", "link": "https://stackoverflow.com/users/1509733/ave"}, "edited": false, "score": 0, "creation_date": 1499725671, "post_id": 45022422, "comment_id": 77019502, "body": "I use go-pg. So first I define a slice like so <code>var spiders []Spider</code> then invoke the library function that writes to it like so <code>db.Model(&amp;spiders).Select()</code>."}, {"owner": {"reputation": 13651, "user_id": 1509733, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b999a449f3dcbf15ff4278738bdbd47a?s=128&d=identicon&r=PG&f=1", "display_name": "ave", "link": "https://stackoverflow.com/users/1509733/ave"}, "edited": false, "score": 0, "creation_date": 1499725738, "post_id": 45022422, "comment_id": 77019523, "body": "in other words, <code>[]Spider</code> is the type I&#39;m trying to work with."}, {"owner": {"reputation": 886, "user_id": 8170773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61b971ec934427a008d8b263ad4142b9?s=128&d=identicon&r=PG&f=1", "display_name": "hedgar2017", "link": "https://stackoverflow.com/users/8170773/hedgar2017"}, "reply_to_user": {"reputation": 13651, "user_id": 1509733, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b999a449f3dcbf15ff4278738bdbd47a?s=128&d=identicon&r=PG&f=1", "display_name": "ave", "link": "https://stackoverflow.com/users/1509733/ave"}, "edited": false, "score": 0, "creation_date": 1499726026, "post_id": 45022422, "comment_id": 77019615, "body": "Why not that [either2]?"}, {"owner": {"reputation": 13651, "user_id": 1509733, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b999a449f3dcbf15ff4278738bdbd47a?s=128&d=identicon&r=PG&f=1", "display_name": "ave", "link": "https://stackoverflow.com/users/1509733/ave"}, "edited": false, "score": 0, "creation_date": 1499726371, "post_id": 45022422, "comment_id": 77019704, "body": "It compiles but it makes <code>db.Model</code> return the <code>pg: Model(nil)</code> error."}, {"owner": {"reputation": 13651, "user_id": 1509733, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b999a449f3dcbf15ff4278738bdbd47a?s=128&d=identicon&r=PG&f=1", "display_name": "ave", "link": "https://stackoverflow.com/users/1509733/ave"}, "edited": false, "score": 0, "creation_date": 1499726395, "post_id": 45022422, "comment_id": 77019715, "body": "I guess because <a href=\"https://godoc.org/github.com/go-pg/pg#Model\" rel=\"nofollow noreferrer\">godoc.org/github.com/go-pg/pg#Model</a> (or some of the functions that it calls internally) doesn&#39;t expect a pointer."}, {"owner": {"reputation": 886, "user_id": 8170773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61b971ec934427a008d8b263ad4142b9?s=128&d=identicon&r=PG&f=1", "display_name": "hedgar2017", "link": "https://stackoverflow.com/users/8170773/hedgar2017"}, "reply_to_user": {"reputation": 13651, "user_id": 1509733, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b999a449f3dcbf15ff4278738bdbd47a?s=128&d=identicon&r=PG&f=1", "display_name": "ave", "link": "https://stackoverflow.com/users/1509733/ave"}, "edited": false, "score": 0, "creation_date": 1499726626, "post_id": 45022422, "comment_id": 77019795, "body": "Do you really need that typing? Maybe just use interface{} and cast only if you need to change or read particular fields. [either3]"}, {"owner": {"reputation": 13651, "user_id": 1509733, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b999a449f3dcbf15ff4278738bdbd47a?s=128&d=identicon&r=PG&f=1", "display_name": "ave", "link": "https://stackoverflow.com/users/1509733/ave"}, "edited": false, "score": 0, "creation_date": 1499726826, "post_id": 45022422, "comment_id": 77019852, "body": "The way I understand it, the type allows the library to deduce the table name and fields when talking to the database. So if I pass interface{} to db.Model, it doesn&#39;t know what to look for."}], "tags": [], "owner": {"reputation": 886, "user_id": 8170773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61b971ec934427a008d8b263ad4142b9?s=128&d=identicon&r=PG&f=1", "display_name": "hedgar2017", "link": "https://stackoverflow.com/users/8170773/hedgar2017"}, "is_accepted": false, "score": 0, "last_activity_date": 1499726639, "last_edit_date": 1499726639, "creation_date": 1499724550, "answer_id": 45022422, "question_id": 45021734, "link": "https://stackoverflow.com/questions/45021734/marshal-slice-with-jsonapi/45022422#45022422", "title": "Marshal slice with jsonapi", "body": "<p>Why not that way [either3]?</p>\n\n<pre><code>var spiders interface{}\ndb.Model(spiders).Select()\njsonapi.MarshalPayload(os.Stdout, spiders)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13651, "user_id": 1509733, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b999a449f3dcbf15ff4278738bdbd47a?s=128&d=identicon&r=PG&f=1", "display_name": "ave", "link": "https://stackoverflow.com/users/1509733/ave"}, "edited": false, "score": 0, "creation_date": 1499974363, "post_id": 45088658, "comment_id": 77151433, "body": "&gt;&quot;spiders is a slice of interfaces..&quot;   Sorry, I think I should have phrased it better. The original slice that I get from the db is <code>spiders := []Spider{Spider{ID: 1, EyeCount: 8}, Spider{ID: 2, EyeCount: 12}}</code>. It&#39;s not a slice of interfaces but a slice of Spiders. That&#39;s why I convert it to a slice of interfaces using a for loop in the question."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 13651, "user_id": 1509733, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b999a449f3dcbf15ff4278738bdbd47a?s=128&d=identicon&r=PG&f=1", "display_name": "ave", "link": "https://stackoverflow.com/users/1509733/ave"}, "edited": false, "score": 1, "creation_date": 1499974735, "post_id": 45088658, "comment_id": 77151636, "body": "Since jsonapi requires a slice of interfaces.. Then perhaps you are already doing the best thing. The only cleaner option in my mind is not to use. jsonapi and to create your own costume marshaller. Given jsonapi also relies heavily on interfaces and reflection is already going to be super slow by comparison."}, {"owner": {"reputation": 13651, "user_id": 1509733, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b999a449f3dcbf15ff4278738bdbd47a?s=128&d=identicon&r=PG&f=1", "display_name": "ave", "link": "https://stackoverflow.com/users/1509733/ave"}, "edited": false, "score": 0, "creation_date": 1499974994, "post_id": 45088658, "comment_id": 77151775, "body": "I think you&#39;re right, I just looked at <a href=\"https://github.com/manyminds/api2go\" rel=\"nofollow noreferrer\">github.com/manyminds/api2go</a> and it seems to be better suited for this case (it doesn&#39;t require performing such conversion <a href=\"https://github.com/manyminds/api2go#manual-marshalling--unmarshalling\" rel=\"nofollow noreferrer\">github.com/manyminds/api2go#manual-marshalling--unmarshallin&zwnj;&#8203;g</a>)"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 13651, "user_id": 1509733, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b999a449f3dcbf15ff4278738bdbd47a?s=128&d=identicon&r=PG&f=1", "display_name": "ave", "link": "https://stackoverflow.com/users/1509733/ave"}, "edited": false, "score": 0, "creation_date": 1499975106, "post_id": 45088658, "comment_id": 77151837, "body": "I just checked it out I also think you&#39;ll have a better time with api2go"}], "tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": false, "score": 1, "last_activity_date": 1499971608, "last_edit_date": 1499971608, "creation_date": 1499971264, "answer_id": 45088658, "question_id": 45021734, "link": "https://stackoverflow.com/questions/45021734/marshal-slice-with-jsonapi/45088658#45088658", "title": "Marshal slice with jsonapi", "body": "<p>Curious would you be able to use something like this??</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n\n    \"github.com/google/jsonapi\"\n)\n\ntype Spider struct {\n    ID       int `jsonapi:\"primary,spiders\"`\n    EyeCount int `jsonapi:\"attr,eye_count\"`\n}\n\nfunc main() {\n    // spiders is a slice of interfaces.. they can be unmarshalled back to spiders later if the need arises\n    // you don't need a loop to create pointers either... so better in memory usage and a bit cleaner to read.. you can in theory load the []interface{} with a for loop as well since you mentioned getting this data from a db\n    var spiders []interface{}\n    spiders = append(spiders, &amp;Spider{ID: 1, EyeCount: 8}, &amp;Spider{ID: 2, EyeCount: 12})\n    fmt.Println(\"jsonapi, MarshalPayload\")\n    jsonapi.MarshalPayload(os.Stdout, spiders)\n\n    // test against marshall indent for sanity checking\n    b, _ := json.MarshalIndent(spiders, \"\", \" \")\n    fmt.Println(\"marshall indent\")\n    fmt.Println(string(b))\n}\n</code></pre>\n"}], "owner": {"reputation": 13651, "user_id": 1509733, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b999a449f3dcbf15ff4278738bdbd47a?s=128&d=identicon&r=PG&f=1", "display_name": "ave", "link": "https://stackoverflow.com/users/1509733/ave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1499971608, "creation_date": 1499721450, "last_edit_date": 1499734602, "question_id": 45021734, "link": "https://stackoverflow.com/questions/45021734/marshal-slice-with-jsonapi", "title": "Marshal slice with jsonapi", "body": "<p>I have a slice of structs and I want to marshal it using <a href=\"https://github.com/google/jsonapi\" rel=\"nofollow noreferrer\">https://github.com/google/jsonapi</a>.</p>\n\n<p>With a single struct, everything works fine. I simply pass a pointer as a second argument.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n\n    \"github.com/google/jsonapi\"\n)\n\ntype Spider struct {\n    ID       int `jsonapi:\"primary,spiders\"`\n    EyeCount int `jsonapi:\"attr,eye_count\"`\n}\n\nfunc main() {\n    jsonapi.MarshalPayload(os.Stdout, &amp;Spider{ID: 2, EyeCount: 12})\n    // {\"data\":{\"type\":\"spiders\",\"id\":\"2\",\"attributes\":{\"eye_count\":12}}}\n}\n</code></pre>\n\n<hr>\n\n<p>However, when I'm trying to do the same with a slice, things are quite different.</p>\n\n<p>First of all, I'm converting my slice to a slice of pointers to those structs (don't know what else to do here, passing pointer to the slice didn't work).</p>\n\n<pre><code>spiders := []Spider{Spider{ID: 1, EyeCount: 8}, Spider{ID: 2, EyeCount: 12}}\n\nvar spiderPointers []*Spider\nfor _, x := range spiders {\n    spiderPointers = append(spiderPointers, &amp;x)\n}\njsonapi.MarshalPayload(os.Stdout, spiderPointers)\n</code></pre>\n\n<p>It works. Sort of. Here is the issue:</p>\n\n<pre><code>{\"data\":[\n  {\"type\":\"spiders\",\"id\":\"2\",\"attributes\":{\"eye_count\":12}},\n  {\"type\":\"spiders\",\"id\":\"2\",\"attributes\":{\"eye_count\":12}}]}\n</code></pre>\n\n<p>The last element is repeated and it replaces other elements.</p>\n\n<p>In the end, I came up with a somewhat working solution:</p>\n\n<pre><code>spiders := []Spider{Spider{ID: 1, EyeCount: 8}, Spider{ID: 2, EyeCount: 12}}\nvar spiderPointers []interface{}\nfor _, x := range spiders {\n    var spider Spider\n    spider = x\n    spiderPointers = append(spiderPointers, &amp;spider)\n}\n\njsonapi.MarshalPayload(os.Stdout, spiderPointers)\n// {\"data\":[{\"type\":\"spiders\",\"id\":\"1\",\"attributes\":{\"eye_count\":8}},\n//          {\"type\":\"spiders\",\"id\":\"2\",\"attributes\":{\"eye_count\":12}}]}\n</code></pre>\n\n<p>But I'm sure there must be a better way, hence this question.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7548, "user_id": 844005, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c5940c4ff6837313a7142576d0e7f84e?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/844005/null"}, "edited": false, "score": 0, "creation_date": 1499720093, "post_id": 45021090, "comment_id": 77017148, "body": "Is it because of <a href=\"https://golang.org/src/os/file.go?s=7374:7411#L97\" rel=\"nofollow noreferrer\">this line</a> (line 97) ? which is telling <code>*File</code> has implemented <code>Read(b []byte) (n int, err error)</code> method ?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 7548, "user_id": 844005, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c5940c4ff6837313a7142576d0e7f84e?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/844005/null"}, "edited": false, "score": 0, "creation_date": 1499720143, "post_id": 45021090, "comment_id": 77017180, "body": "Yes, that method fulfills the requirements of <code>io.Reader</code>."}, {"owner": {"reputation": 7548, "user_id": 844005, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c5940c4ff6837313a7142576d0e7f84e?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/844005/null"}, "edited": false, "score": 0, "creation_date": 1499722187, "post_id": 45021090, "comment_id": 77018127, "body": "Hmm ok, that&#39;s interesting, as someone who is coming from Java, I found the syntax design of the interface implementation in Go is a bit strange. I was expecting they are to be put in same place as the type definition."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 7548, "user_id": 844005, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c5940c4ff6837313a7142576d0e7f84e?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/844005/null"}, "edited": false, "score": 1, "creation_date": 1499723353, "post_id": 45021090, "comment_id": 77018621, "body": "I would definitely suggest reading the documentation and going through the tour. It will explain all the basic stuff without needing to ask on SO."}, {"owner": {"reputation": 7548, "user_id": 844005, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c5940c4ff6837313a7142576d0e7f84e?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/844005/null"}, "edited": false, "score": 0, "creation_date": 1499723588, "post_id": 45021090, "comment_id": 77018717, "body": "I would like to, but I was too curious that I want get the answer promptly. Thanks anyway."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 2, "last_activity_date": 1499718716, "creation_date": 1499718716, "answer_id": 45021090, "question_id": 45021045, "link": "https://stackoverflow.com/questions/45021045/how-file-type-can-be-passed-as-reader-type/45021090#45021090", "title": "How *File type can be passed as Reader type?", "body": "<p><a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\"><code>io.Reader</code></a> is an <code>interface</code>, and <a href=\"https://golang.org/pkg/os/#File\" rel=\"nofollow noreferrer\"><code>*os.File</code></a> implements the interface. It's explained <a href=\"https://tour.golang.org/methods/9\" rel=\"nofollow noreferrer\">in the Go Tour</a> which I would highly recommend going through.</p>\n"}], "owner": {"reputation": 7548, "user_id": 844005, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c5940c4ff6837313a7142576d0e7f84e?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/844005/null"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1499718716, "creation_date": 1499718537, "question_id": 45021045, "link": "https://stackoverflow.com/questions/45021045/how-file-type-can-be-passed-as-reader-type", "title": "How *File type can be passed as Reader type?", "body": "<p>I'm new to golang. I saw a golang code like this:</p>\n\n<pre><code>file, err := os.Open(\"input.txt\")\nif err != nil {\n    log.Fatal(err)\n}\ndefer file.Close()\n\nscanner := bufio.NewScanner(file)\n...\n</code></pre>\n\n<p>According to the documentation, <code>os.Open</code> returns <code>(*File, error)</code> type, and <code>bufio.NewScanner(r)</code>'s argument <code>r</code> is having <code>io.Reader</code> type.</p>\n\n<p>On the code example above, variable <code>file</code> which is having type of <code>*File</code> (pointer to <code>File</code> type) can be passed to <code>bufio.NewScanner</code> method which the argument is expecting<code>io.Reader</code> type. How could that possible?</p>\n\n<p>I checked the source code, the <code>File</code> type (<a href=\"https://golang.org/src/os/types.go?s=369:411#L6\" rel=\"nofollow noreferrer\">https://golang.org/src/os/types.go?s=369:411#L6</a>), and <code>io.Reader</code> type (<a href=\"https://golang.org/src/io/io.go?s=3303:3363#L67\" rel=\"nofollow noreferrer\">https://golang.org/src/io/io.go?s=3303:3363#L67</a>) seems are unrelated. So how could the parameter passing is possible?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 8, "last_activity_date": 1499716645, "creation_date": 1499716645, "answer_id": 45020558, "question_id": 45020481, "link": "https://stackoverflow.com/questions/45020481/range-a-channel-finishes-with-deadlock/45020558#45020558", "title": "Range a channel finishes with deadlock", "body": "<p>Range only stops when the channel is closed. You're hitting a deadlock because nothing is writing to the channel, but you're sitting waiting for something to be written. You could add a <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"noreferrer\"><code>sync.WaitGroup</code></a> and close the channel after all of the goroutines writing to it have finished.</p>\n\n<p>You should probably also change the loop as there is potential for the wrong values to be passed because you're closing over the loop variable which can change concurrently; this will be more reliable:</p>\n\n<pre><code>for _, s := range l {\n    go func(s rune) {\n        ch &lt;- Frequency(s)\n    }(s)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 1087053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce81f968743d5411739a1eb75ba39fc1?s=128&d=identicon&r=PG", "display_name": "Kevin Wong", "link": "https://stackoverflow.com/users/1087053/kevin-wong"}, "is_accepted": false, "score": 1, "last_activity_date": 1542666861, "creation_date": 1542666861, "answer_id": 53383618, "question_id": 45020481, "link": "https://stackoverflow.com/questions/45020481/range-a-channel-finishes-with-deadlock/53383618#53383618", "title": "Range a channel finishes with deadlock", "body": "<p>I would prefer to use for...select to receive the message in channel.</p>\n\n<pre><code>func main() {\n\n    in := State{[]What{A,B,C,D},[]What{},nil}\n    out := make(chan State)\n    go in.think(out)\n\n    life:=5\n    for {\n        select {\n        case s:=&lt;-out:\n            fmt.Printf(\"out : %+v\\n\", s)\n        default:\n            time.Sleep(50 * time.Millisecond)\n            if life--;life==0 {\n                return\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 8285681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/844f0ff5bf01d2c5de791c88ac369085?s=128&d=identicon&r=PG&f=1", "display_name": "user8285681", "link": "https://stackoverflow.com/users/8285681/user8285681"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1861, "favorite_count": 1, "accepted_answer_id": 45020558, "answer_count": 2, "score": 4, "last_activity_date": 1542666861, "creation_date": 1499716360, "question_id": 45020481, "link": "https://stackoverflow.com/questions/45020481/range-a-channel-finishes-with-deadlock", "title": "Range a channel finishes with deadlock", "body": "<p>The following code ends with a fatal error: all goroutines are asleep - deadlock!</p>\n\n<pre><code>// Package letter returns the frequency of letters in texts using parallel computation.\npackage letter\n\nimport \"fmt\"\n\nconst testVersion = 1\n\ntype FreqMap map[rune]int\n\nfunc Frequency(s string) FreqMap {\n    m := FreqMap{}\n    for _, r := range s {\n        m[r]++\n    }\n    return m\n}\n\nfunc ConcurrentFrequency(l []string) FreqMap {\n    ch := make(chan FreqMap)\n    for _, s := range l {\n        go func() {\n            ch &lt;- Frequency(s)\n        }()\n    }\n    m := FreqMap{}\n    for c := range ch {\n        fmt.Println(\"channel:\", c)\n        for k, v := range c {\n            m[k] += v\n        }\n    }\n    return m\n}\n</code></pre>\n\n<p>This is output:</p>\n\n<pre><code>channel: map[121:8 101:42 98:8 104:28 102:6 71:1 59:1 97:33 110:15 103:15 112:6 109:5 116:38 10:7 87:2 107:1 108:17 99:3 117:7 39:5 79:4 114:27 105:15 44:7 119:8 100:12 63:2 65:1 118:3 45:1 32:72 111:18 115:24]\nchannel: map[97:33 110:15 111:18 117:7 108:17 45:1 115:24 10:7 79:4 32:72 121:8 100:12 105:15 63:2 107:1 71:1 119:8 114:27 103:15 102:6 65:1 44:7 87:2 118:3 101:42 98:8 116:38 39:5 112:6 104:28 109:5 99:3 59:1]\nchannel: map[99:3 116:38 104:28 108:17 44:7 117:7 119:8 114:27 10:7 87:2 110:15 100:12 103:15 107:1 32:72 111:18 102:6 59:1 45:1 101:42 109:5 63:2 115:24 97:33 105:15 112:6 65:1 71:1 79:4 121:8 98:8 39:5 118:3]\nfatal error: all goroutines are asleep - deadlock!\n</code></pre>\n\n<p>My understanding is that range waits for data from channel until the channel is closed, but adding close(ch) inside the for loop, or inside the func() or after those, make things worse (the fmt.Println does not get anything) - tried also with defer (same problem)</p>\n\n<p>What would be the correct approach? Isn't range the right solution in this case ?</p>\n\n<p>Thanks a lot !</p>\n"}, {"tags": ["go", "themes", "hugo", "go-html-template"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1499714560, "post_id": 45019997, "comment_id": 77014143, "body": "As this doesn&#39;t seem to be a software development question, you might have better luck asking this of the <a href=\"https://discourse.gohugo.io/\" rel=\"nofollow noreferrer\">Hugo community</a>."}, {"owner": {"reputation": 105, "user_id": 4809575, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c72329f445630e8fae179221608685fe?s=128&d=identicon&r=PG", "display_name": "fant0me", "link": "https://stackoverflow.com/users/4809575/fant0me"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1499783900, "post_id": 45019997, "comment_id": 77049178, "body": "Sure, thanks @Adrian!"}], "owner": {"reputation": 105, "user_id": 4809575, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c72329f445630e8fae179221608685fe?s=128&d=identicon&r=PG", "display_name": "fant0me", "link": "https://stackoverflow.com/users/4809575/fant0me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499714251, "creation_date": 1499714180, "last_edit_date": 1499714251, "question_id": 45019997, "link": "https://stackoverflow.com/questions/45019997/implement-theme-as-layout", "title": "Implement theme as layout", "body": "<p>I'm looking for implementing <a href=\"https://themes.gohugo.io/theme/hugrid/\" rel=\"nofollow noreferrer\">Hugo's HUGRID theme</a> as an additional layout for my blog (currently using <a href=\"https://themes.gohugo.io/theme/hugo-theme-cactus-plus/\" rel=\"nofollow noreferrer\">Cactus-plus theme</a>), but I know almost nothing about Hugo templating. Should I try to code it as a layout or can I use the <code>HUGRID</code> theme inside <code>cactus-plus</code> theme for specific pages?</p>\n"}, {"tags": ["c++", "visual-c++", "go", "swig"], "comments": [{"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1499772346, "post_id": 45018561, "comment_id": 77039854, "body": "Yes and no. If the compiled <code>DLL</code> is linking to a run-time different than what is used in the context of the program calling the <code>DLL</code>, you will get in trouble. You should be able to compile and link the object using MSVC. <code>SWIG</code> generates all the necessary export declarations, so no need for manually inserting <code>__declspec(dlllexport)</code>"}, {"owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "reply_to_user": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1499792291, "post_id": 45018561, "comment_id": 77055137, "body": "As far as I know, msvc cannot link a golang program; it is required to be in gcc format."}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1499802834, "post_id": 45018561, "comment_id": 77061084, "body": "You should be able to use the <code>dlltool</code> on your <code>dll</code> and <code>.def</code> file as described here <a href=\"http://grokbase.com/t/gg/golang-nuts/154m672a6t/go-nuts-linking-cgo-with-visual-studio-x64-release-libraries-on-windows\" rel=\"nofollow noreferrer\">grokbase.com/t/gg/golang-nuts/154m672a6t/&hellip;</a>. I have used plenty of DLL&#39;s created using MSVC on a project created using gcc. It should be the same story"}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1499802953, "post_id": 45018561, "comment_id": 77061150, "body": "With respect to the SWIG&#39;ing - create a small wrapper and generate the shared object for <code>go</code> in the usual way."}], "owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499708765, "creation_date": 1499708765, "question_id": 45018561, "link": "https://stackoverflow.com/questions/45018561/calling-msvc-c-dll-with-swig-go", "title": "calling msvc c++ dll with swig/go", "body": "<p>I have an msvc dll that has some functions that I want to call with go. I understand that it's not going to be reasonable to wrap all of the functionality of a large project, but I only need a subset of functionality and the time spent on wrapping the c++ with SWIG is reasonable for me. </p>\n\n<p>The potential issue that I've discovered is that the c++ ABI is not compatible between mingw/gcc and msvc, so if I compile the generated wrapper with gcc as specified in the SWIG documentation, it probably won't be able to call the functions in the DLL. </p>\n\n<p>The first question is whether this understanding is correct.</p>\n\n<p>The second question is that assuming the above is true, my plan is to \"cdecl(dllexport)\" all of the \"externs\" in the swig wrapper and then \"cdecl(dllimport)\" all of the \"externs\" in the cgo section in the generated go file, then compile the DLL with msvc. </p>\n\n<p>My preference, however, would be to compile the object file with msvc and then rename it to .syso so that the go linker will automatically pick it up.</p>\n\n<p>The second question is whether either of these two options are reasonable and/or likely to be successful. </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1499708161, "post_id": 45018199, "comment_id": 77010599, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19325496/nested-struct-initialization-literals\">nested struct initialization literals</a>"}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 1, "creation_date": 1499708434, "post_id": 45018199, "comment_id": 77010757, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/29979056/composite-literal-and-fields-from-an-embedded-type\">Composite literal and fields from an embedded type</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7660, "user_id": 2350684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yuQa5.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/2350684/oliver"}, "is_accepted": false, "score": 1, "last_activity_date": 1499709941, "creation_date": 1499709941, "answer_id": 45018908, "question_id": 45018199, "link": "https://stackoverflow.com/questions/45018199/embedded-structs-opposed-situation/45018908#45018908", "title": "Embedded structs opposed situation", "body": "<p>You need to explicitly use <code>B</code> (and <code>C</code>) when initializing <code>A</code>:</p>\n\n<p><code>a = A{B{x: 2}, C{}}</code></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8285181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab613d29b5c6fb01a26afb98cbe106f5?s=128&d=identicon&r=PG", "display_name": "Omid", "link": "https://stackoverflow.com/users/8285181/omid"}, "edited": false, "score": 0, "creation_date": 1499761815, "post_id": 45019776, "comment_id": 77032351, "body": "thanks for answer. but I explain in question why we can use a.x = 0 !!? if it is safely choose, why this model(a.x = 0) work? we must think differently in same thing!!"}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "reply_to_user": {"reputation": 1, "user_id": 8285181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab613d29b5c6fb01a26afb98cbe106f5?s=128&d=identicon&r=PG", "display_name": "Omid", "link": "https://stackoverflow.com/users/8285181/omid"}, "edited": false, "score": 0, "creation_date": 1499769524, "post_id": 45019776, "comment_id": 77037888, "body": "I expanded my answer."}], "tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": false, "score": 2, "last_activity_date": 1499769514, "last_edit_date": 1499769514, "creation_date": 1499713289, "answer_id": 45019776, "question_id": 45018199, "link": "https://stackoverflow.com/questions/45018199/embedded-structs-opposed-situation/45019776#45019776", "title": "Embedded structs opposed situation", "body": "<p>Rob 'Commander' Pike explained it <a href=\"https://groups.google.com/d/msg/golang-nuts/LUF4LpXVU8g/likbOsXTXvwJ\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>He wrote there:</p>\n\n<blockquote>\n  <p>It might one day, but as it stands the requirement to provide more \n  information is more robust against changes in the data types.</p>\n</blockquote>\n\n<p>If I understand and interpret that correctly, it is basically a safety measure for you. The compiler will yell at you, if the struct definition doesn't match the composite literal.</p>\n\n<p>In your example, the definition of <code>A</code> might change -- in a later change (as in much later, like years) -- to:</p>\n\n<pre><code>    type A struct {\n        x int\n        y string\n        z string\n    }\n</code></pre>\n\n<p>later, but <code>x</code>, <code>y</code> and <code>z</code> might represent different things than before and therefore it is better, that you have to change all your literals to\nnot get silently corrupt data of some kind.</p>\n\n<p>That is a deliberate choice. The wording in the language specification is:</p>\n\n<blockquote>\n  <p>Promoted fields act like ordinary fields of a struct except that they cannot be used as field names in composite literals of the struct.</p>\n</blockquote>\n\n<p>So you can use the field <code>x</code> of the field <code>B</code> as if it was a field of <code>A</code> except for composite literals.</p>\n\n<p>And the types</p>\n\n<pre><code>type A struct {\n    B\n    C\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>type A struct {\n    x int\n    y string\n    z string\n}\n</code></pre>\n\n<p>really are two different things. The former contains two fields <code>B</code> and <code>C</code>, and the latter three fields <code>x</code>, <code>y</code> and <code>z</code>. The former just has some syntactic sugar to access the field <code>x</code> of the field <code>B</code> with a shorthand. So if <code>a</code> is a variable of the former type <code>A</code>, <code>a.x</code> is syntactic sugar for <code>a.B.x</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8285181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab613d29b5c6fb01a26afb98cbe106f5?s=128&d=identicon&r=PG", "display_name": "Omid", "link": "https://stackoverflow.com/users/8285181/omid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1499770131, "creation_date": 1499707490, "last_edit_date": 1499770131, "question_id": 45018199, "link": "https://stackoverflow.com/questions/45018199/embedded-structs-opposed-situation", "title": "Embedded structs opposed situation", "body": "<p>We have 3 types:</p>\n\n<pre><code>type A struct {\n    B\n    C\n}\ntype B struct {\n    x int\n    y string\n}\ntype C struct {\n    z string\n}\n</code></pre>\n\n<p>because of how fields and methods of an anonymous field are <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">promoted</a>, we can access fields of the anonymous field <code>B</code> in <code>A</code> like</p>\n\n<pre><code>var a A\na.x = 0\n</code></pre>\n\n<p>It is very obvious that type <code>B</code> &amp; <code>C</code> embed in <code>A</code>, so we expect <code>A</code> to be equivalent to:</p>\n\n<pre><code>type D struct {\n    x int\n    y string\n    z string\n}\n</code></pre>\n\n<h3>What did you expect to see?</h3>\n\n<p>We expect that we can write composite literals of type <code>A</code> like that:</p>\n\n<pre><code>a := A{x: 2}\n</code></pre>\n\n<h3>What did you see instead?</h3>\n\n<p>This compile error:</p>\n\n<pre><code>unknown field 'x' in struct literal of type A\n</code></pre>\n\n<h3>Our Question</h3>\n\n<p>Why isn't it possible to write composite literals for <code>A</code> in that way, as it would for the type <code>D</code>?</p>\n\n<p><a href=\"https://play.golang.org/p/uM5JkO5EvE\" rel=\"nofollow noreferrer\">https://play.golang.org/p/uM5JkO5EvE</a></p>\n"}, {"tags": ["go", "types"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1499710826, "post_id": 45016646, "comment_id": 77012162, "body": "If they have no methods in common, why do you want to treat them as the same type? Perhaps you need an <a href=\"https://en.wikipedia.org/wiki/Adapter_pattern\" rel=\"nofollow noreferrer\">adapter</a> instead."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1499702735, "creation_date": 1499702735, "answer_id": 45016810, "question_id": 45016646, "link": "https://stackoverflow.com/questions/45016646/combine-multiple-types-into-one-without-interfacing/45016810#45016810", "title": "Combine multiple types into one without interfacing", "body": "<p>If you can't build a specific interface for them, your only real option is the empty interface <code>interface{}</code>, which can hold any value. You'll then have to use <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertions</a> or <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">reflection</a> to do anything useful with the values. This is an unusual case from a design perspective as you're holding an arbitrary value that you cannot make any assumptions about.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 7811496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77cd6cee139625d77e02d807a2ae0d03?s=128&d=identicon&r=PG&f=1", "display_name": "Rukinom", "link": "https://stackoverflow.com/users/7811496/rukinom"}, "edited": false, "score": 0, "creation_date": 1499806654, "post_id": 45019509, "comment_id": 77063051, "body": "I&#39;ve got to use external lib functions (same library as the shapes themselves) that specifically take <code>Circle</code> and <code>Square</code> arguments. Could this adapted type be cast back to what it&#39;s adapting? Even if it did, it&#39;s still unsafe. Any value in that?"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 23, "user_id": 7811496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77cd6cee139625d77e02d807a2ae0d03?s=128&d=identicon&r=PG&f=1", "display_name": "Rukinom", "link": "https://stackoverflow.com/users/7811496/rukinom"}, "edited": false, "score": 0, "creation_date": 1499806989, "post_id": 45019509, "comment_id": 77063217, "body": "@Rukinom Since <code>Circle</code> and <code>ShapeCircle</code> have the same struct definition, you can <i>copy</i> both ways. <code>ExternalFunction( Circle(shape) )</code> will work. AFAIK there&#39;s nothing unsafe about it, why do you say that?"}, {"owner": {"reputation": 23, "user_id": 7811496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77cd6cee139625d77e02d807a2ae0d03?s=128&d=identicon&r=PG&f=1", "display_name": "Rukinom", "link": "https://stackoverflow.com/users/7811496/rukinom"}, "edited": false, "score": 0, "creation_date": 1499808055, "post_id": 45019509, "comment_id": 77063706, "body": "Awesome, that works great. I retract statement about safety, since it casts directly."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 23, "user_id": 7811496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77cd6cee139625d77e02d807a2ae0d03?s=128&d=identicon&r=PG&f=1", "display_name": "Rukinom", "link": "https://stackoverflow.com/users/7811496/rukinom"}, "edited": false, "score": 0, "creation_date": 1499808253, "post_id": 45019509, "comment_id": 77063797, "body": "@Rukinom Note it&#39;s not casting, it&#39;s copying. There might be a way to cast, but I don&#39;t know it."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 23, "user_id": 7811496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77cd6cee139625d77e02d807a2ae0d03?s=128&d=identicon&r=PG&f=1", "display_name": "Rukinom", "link": "https://stackoverflow.com/users/7811496/rukinom"}, "edited": false, "score": 0, "creation_date": 1499808761, "post_id": 45019509, "comment_id": 77064062, "body": "@Rukinom I added a version that does not copy."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 2, "last_activity_date": 1499808696, "last_edit_date": 1499808696, "creation_date": 1499712188, "answer_id": 45019509, "question_id": 45016646, "link": "https://stackoverflow.com/questions/45016646/combine-multiple-types-into-one-without-interfacing/45019509#45019509", "title": "Combine multiple types into one without interfacing", "body": "<p><a href=\"https://stackoverflow.com/a/45016810/14660\">@Adrian already explained what's wrong with using <code>interface{}</code> here</a>.</p>\n\n<p>Instead, use the <a href=\"https://en.wikipedia.org/wiki/Adapter_pattern\" rel=\"nofollow noreferrer\">Adapter Pattern</a>. Create your own Shape interface and make adapters for the pre-made shapes.</p>\n\n<p>The Shape interface (it should probably be called Shape2D because 3D shapes behave differently) might look like this. This gives you the advantages of the type system, and having a unified shape interface.</p>\n\n<pre><code>type Shape interface {\n    Area() float32\n    Perimeter() float32\n    X() int\n    Y() int\n}\n</code></pre>\n\n<p>Then create adapters around the existing objects. No wrapper is necessary, you can define an alias for the type. (<code>external</code> here represents that Circle and Square come from some other package).</p>\n\n<pre><code>type ShapeCircle external.Circle\n\nfunc (self ShapeCircle) Area() float32 {\n    return math.Pi * float32(self.Radius) * float32(self.Radius)\n}\n\n...and so on...\n\ntype ShapeSquare external.Square\n\nfunc (self ShapeSquare) Area() float32 {\n    return float32(self.W) * float32(self.H)\n}\n\n...and so on...\n</code></pre>\n\n<p>Now you can <em>copy</em> Circle and Square objects to their Shape adapters and use them as Shape.</p>\n\n<pre><code>c := external.Circle{ Radius: 10, X: 0, Y: 0 }\n\nshape := ShapeCircle(c)\n\nfmt.Println(shape.Area())\n</code></pre>\n\n<p>You can also go the other way.</p>\n\n<pre><code>external.Function( external.Circle(shape) )\n</code></pre>\n\n<p>Again, this creates a copy.</p>\n\n<hr>\n\n<p>Alternatively, if you don't like the copying, you can embed Circle inside ShapeCircle and Square inside ShapeSquare.</p>\n\n<pre><code>type ShapeCircle struct {\n    external.Circle\n}\ntype ShapeSquare struct {\n    external.Square\n}\n</code></pre>\n\n<p>Then you can use ShapeCircle as before, but you have to give it a Circle. Might want to make New function to take care of that.</p>\n\n<pre><code>c := ShapeCircle{\n    Circle: external.Circle{ Radius: 10, X: 0, Y: 0 }\n}\n</code></pre>\n\n<p>It can be used as a Shape.</p>\n\n<pre><code>fmt.Println(c.Area())\n</code></pre>\n\n<p>And <code>c.Circle</code> can be used as a Circle. No copying necessary.</p>\n\n<pre><code>external.Function( c.Circle )\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7811496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77cd6cee139625d77e02d807a2ae0d03?s=128&d=identicon&r=PG&f=1", "display_name": "Rukinom", "link": "https://stackoverflow.com/users/7811496/rukinom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 45019509, "answer_count": 2, "score": 1, "last_activity_date": 1499808696, "creation_date": 1499702260, "last_edit_date": 1499715856, "question_id": 45016646, "link": "https://stackoverflow.com/questions/45016646/combine-multiple-types-into-one-without-interfacing", "title": "Combine multiple types into one without interfacing", "body": "<p>In a Go project, I've got to define two different kinds of \"shapes\" to types that implement an interface called MyObject. The shapes themselves are types defined in an external library, and do not implement any shared interface.</p>\n\n<p>MyObject looks like</p>\n\n<pre><code>type MyObject interface {\n    GetShape() *Shape //some unified return value\n}\n</code></pre>\n\n<p>Shapes look like</p>\n\n<pre><code>type Circle struct {\n    Radius int\n    X int\n    Y int\n}\n\ntype Square struct {\n   X int\n   Y int\n   W int\n   H int\n}\n\nfunc NewCircle(x int, y int, radius int) Circle\nfunc NewSquare(x int, y int, w int, h int) Square\n</code></pre>\n\n<p>I've got a ball and a box that implement MyObject:</p>\n\n<pre><code>type Ball struct {\n    shape *Circle\n}\n\ntype Box struct {\n    shape *Square\n}\n\nfunc (b *Ball) GetShape() *Shape {\n    return b.shape\n}\n\nfunc (s *Square) GetShape() *Shape {\n    return s.shape\n}\n</code></pre>\n\n<p>This seems straightforward enough with interfacing - but we can't use one in this situation since there are no methods implemented by Circle and Square that are identical, plus they are outside of the package we're working in.</p>\n\n<p>For methods using the circle and the square, I need to use methods like</p>\n\n<pre><code>testCircleSquare(circle *Circle, square *Square) bool {}\ntestSquareSquare(square1 *Square, square2 *Square) bool {}\n</code></pre>\n\n<p>How can I distinguish or make these two objects more generic? The only idea I had so far was to containerize them into a type like</p>\n\n<pre><code>type Shape struct {\n    circle *Circle\n    square *Square\n}\n</code></pre>\n\n<p>and check for nil circle or square values to determine which to use, but this seems hacky and difficult to maintain if I add more shapes.</p>\n"}, {"tags": ["python", "go", "stream", "buffer", "transfer"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6638915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e895d9f74abf49e329e6cc4afe4a1b1f?s=128&d=identicon&r=PG&f=1", "display_name": "stucklen", "link": "https://stackoverflow.com/users/6638915/stucklen"}, "edited": false, "score": 0, "creation_date": 1499764698, "post_id": 45017089, "comment_id": 77034301, "body": "Ah yes the robot and server are on the same network, here&#39;s my Go script: <a href=\"https://play.golang.org/p/l_1E-TYSbB\" rel=\"nofollow noreferrer\">link</a> and my python script is basically the answer to this Q <a href=\"https://stackoverflow.com/questions/24243757/nao-robot-remote-audio-problems\">link</a>. So you&#39;re saying I need to create UDP packets in my Python script out of the binary data (saved as a .raw) and listen for them in my Go script. Do I convert the data into HEX? How would I then convert this data into a .WAV or some other playable music format? Thanks."}, {"owner": {"reputation": 364, "user_id": 1347798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GF6yJ.jpg?s=128&g=1", "display_name": "ipaul", "link": "https://stackoverflow.com/users/1347798/ipaul"}, "reply_to_user": {"reputation": 33, "user_id": 6638915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e895d9f74abf49e329e6cc4afe4a1b1f?s=128&d=identicon&r=PG&f=1", "display_name": "stucklen", "link": "https://stackoverflow.com/users/6638915/stucklen"}, "edited": false, "score": 0, "creation_date": 1499784031, "post_id": 45017089, "comment_id": 77049290, "body": "Normally audio is 8-bit PCM.  Numpy looks like it&#39;s taking the data an translating it to numbers (they should be between 0 and 255) with one column for each channel.  You should be able to base64 1000 bytes at a time (why 1000?  because ethernet is 1500 bytes by default).  Encode that as base64, which should be about 1300 bytes.  Send that as a UDP packet to your Go server, then maybe something like <a href=\"https://github.com/cryptix/wav\" rel=\"nofollow noreferrer\">github.com/cryptix/wav</a> to re-encode that as a WAV file.  Hopefully you can just write that WAV file to your mixer or audio device.  But I&#39;ve never tried that last part."}, {"owner": {"reputation": 33, "user_id": 6638915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e895d9f74abf49e329e6cc4afe4a1b1f?s=128&d=identicon&r=PG&f=1", "display_name": "stucklen", "link": "https://stackoverflow.com/users/6638915/stucklen"}, "edited": false, "score": 0, "creation_date": 1499786106, "post_id": 45017089, "comment_id": 77050947, "body": "Thanks but still having difficulties.Here&#39;s the processRemote method of my Python code <a href=\"https://trinket.io/python/ca15d63ae6\" rel=\"nofollow noreferrer\">link</a> I managed to send test data (PACKETDATA) over UDP and managed to get Go to receive it. However my skill level is beginner and I am unsure what exactly I need to be sending. I have a variable called &#39;aSoundData&#39; which could be the audio but when I print it, it shows numbers beyond 255, so what kind of data could this be and how do I convert it to hex? It looks like this: [[ 408 -283 -962 ..., 1546 1784 1946] (there are 3 rows like this)"}, {"owner": {"reputation": 364, "user_id": 1347798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GF6yJ.jpg?s=128&g=1", "display_name": "ipaul", "link": "https://stackoverflow.com/users/1347798/ipaul"}, "reply_to_user": {"reputation": 33, "user_id": 6638915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e895d9f74abf49e329e6cc4afe4a1b1f?s=128&d=identicon&r=PG&f=1", "display_name": "stucklen", "link": "https://stackoverflow.com/users/6638915/stucklen"}, "edited": false, "score": 0, "creation_date": 1499787371, "post_id": 45017089, "comment_id": 77051936, "body": "It looks like naoqi does not send data as PCM, but something related to the Linux ALSA sound driver.  It&#39;s using a 16 bit audio signal.  (I suspect it&#39;s actually intended to be unsigned).  I&#39;m afraid I don&#39;t know much about that specific sound protocol.  You could still encode it as base64 and ship 500 samples at a time across the network.  Then decode it and send it to your sound device and see what happens.  If it&#39;s ALSA encoded something and you are sending it to an ALSA device - maybe it just works?"}], "tags": [], "owner": {"reputation": 364, "user_id": 1347798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GF6yJ.jpg?s=128&g=1", "display_name": "ipaul", "link": "https://stackoverflow.com/users/1347798/ipaul"}, "is_accepted": false, "score": 0, "last_activity_date": 1499703608, "creation_date": 1499703608, "answer_id": 45017089, "question_id": 45014245, "link": "https://stackoverflow.com/questions/45014245/transfer-audio-buffers-from-a-python-script-to-a-go-server/45017089#45017089", "title": "Transfer audio buffers from a Python script to a Go server?", "body": "<p>There is no single \"Best\" way.  If the protocol has to go over ports 80/443 on the open internet, you could use web-sockets.  You could also POST base64 encoded chunks of data from python back to your server.  </p>\n\n<p>If the robot and server are on the same network, you could send UDP packets from the robot to your server.  (Usually a missing packet or two on audio is not a problem).  Even if you have a web based Go server, you can still fire off a go routine to listen on UDP for incoming packets.  </p>\n\n<p>If you could be more specific, maybe I or someone else could give a better answer?</p>\n"}], "owner": {"reputation": 33, "user_id": 6638915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e895d9f74abf49e329e6cc4afe4a1b1f?s=128&d=identicon&r=PG&f=1", "display_name": "stucklen", "link": "https://stackoverflow.com/users/6638915/stucklen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499703608, "creation_date": 1499695688, "question_id": 45014245, "link": "https://stackoverflow.com/questions/45014245/transfer-audio-buffers-from-a-python-script-to-a-go-server", "title": "Transfer audio buffers from a Python script to a Go server?", "body": "<p>I am a beginner trying to find a way to stream audio on a local server. I have a Python script that creates some binary data from a robot's microphone, and I want to send this data to be displayed on a local Go server I created.</p>\n\n<p>I read somewhere that web sockets could be a solution.\nBut what's the simplest way to upload the audio buffers from the Python script? And how would I retrieve this raw binary data so that it can be streamed from the web app?</p>\n\n<p>Many many thanks.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 635, "user_id": 1334796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X2VNf.jpg?s=128&g=1", "display_name": "Gustav Westling", "link": "https://stackoverflow.com/users/1334796/gustav-westling"}, "is_accepted": true, "score": 0, "last_activity_date": 1499686082, "creation_date": 1499686082, "answer_id": 45010850, "question_id": 45010627, "link": "https://stackoverflow.com/questions/45010627/how-to-go-get-files-in-a-different-branch-in-github-repo-other-than-master/45010850#45010850", "title": "how to &#39;go get&#39; files in a different branch in github repo other than master", "body": "<p>This is not supported by <code>go get</code>, you need to download the files manually to your <code>GOPATH</code> or to your <code>vendor/</code> folder.</p>\n\n<p>A vendor solution:</p>\n\n<pre><code>git clone git@github.com:mattes/migrate.git\n    vendor/github.com/mattes/migrate;\ncd vendor/github.com/mattes/migrate;\ngit checkout BRANCH_NAME;\n</code></pre>\n"}], "owner": {"reputation": 2261, "user_id": 2809530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/f7E46.jpg?s=128&g=1", "display_name": "Channa", "link": "https://stackoverflow.com/users/2809530/channa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 746, "favorite_count": 0, "accepted_answer_id": 45010850, "answer_count": 1, "score": 0, "last_activity_date": 1499686082, "creation_date": 1499685431, "question_id": 45010627, "link": "https://stackoverflow.com/questions/45010627/how-to-go-get-files-in-a-different-branch-in-github-repo-other-than-master", "title": "how to &#39;go get&#39; files in a different branch in github repo other than master", "body": "<p>I need to <code>go get</code> following files from <a href=\"https://github.com/mattes/migrate\" rel=\"nofollow noreferrer\">this repo</a></p>\n\n<pre><code>go get github.com/mattes/migrate/driver/mysql\n</code></pre>\n\n<p>but those files are in a different branch, not in <code>master</code>. How can I <code>go get</code> those files? I tried following way but it didn't get those files that I need. </p>\n\n<pre><code>go get gopkg.in/mattes/migrate.v1\n</code></pre>\n\n<p>Appreciate any help.</p>\n"}, {"tags": ["go", "govendor"], "answers": [{"comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1499714780, "post_id": 45019234, "comment_id": 77014250, "body": "Yes, use <code>godep</code>."}, {"owner": {"reputation": 2895, "user_id": 348719, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb180bc6dd7e72a35a27319fcd7e6fda?s=128&d=identicon&r=PG&f=1", "display_name": "sgon00", "link": "https://stackoverflow.com/users/348719/sgon00"}, "edited": false, "score": 0, "creation_date": 1499744224, "post_id": 45019234, "comment_id": 77023972, "body": "(1) Why will it update $GOPATH dependencies when I run <code>go install &lt;myproject&gt;</code> if my govendor project has nothing to do with $GOPATH?   (2) will <code>go install</code> and <code>govendor install +vendor,^program</code> build the project? You didn&#39;t mention it. (3) if <code>govendor install +vendor,^program</code> and <code>govendor install +local</code> will build the project, what dir will it build to? what directory will <code>go install &lt;govendor project&gt;</code> build to?  (4) I am using <code>gin</code> which switches from godep to govendor. That&#39;s why I am using govendor. If godep will become standard in golang 1.10, why does gin drop it? thanks"}, {"owner": {"reputation": 2895, "user_id": 348719, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb180bc6dd7e72a35a27319fcd7e6fda?s=128&d=identicon&r=PG&f=1", "display_name": "sgon00", "link": "https://stackoverflow.com/users/348719/sgon00"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1499744498, "post_id": 45019234, "comment_id": 77024049, "body": "@eduncan911 I am using <code>gin</code> which switches from <code>godep</code> to <code>govendor</code>. That&#39;s why I am using <code>govendor</code>. If <code>godep</code> will become standard in golang 1.10, why does <code>gin</code> drop it and use <code>govendor</code> instead? thanks."}, {"owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "edited": false, "score": 0, "creation_date": 1499751513, "post_id": 45019234, "comment_id": 77026359, "body": "<code>go install</code> simply installs and updates dependencies in your <code>$GOPATH</code>. It is simply a global cache of the latest versions available."}, {"owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "edited": false, "score": 0, "creation_date": 1499751844, "post_id": 45019234, "comment_id": 77026494, "body": "You can still use godep with your own project. Just run go get x &amp;&amp; cd proj_dir &amp;&amp; godep save"}, {"owner": {"reputation": 2895, "user_id": 348719, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb180bc6dd7e72a35a27319fcd7e6fda?s=128&d=identicon&r=PG&f=1", "display_name": "sgon00", "link": "https://stackoverflow.com/users/348719/sgon00"}, "edited": false, "score": 0, "creation_date": 1499754453, "post_id": 45019234, "comment_id": 77027771, "body": "@xaav just one more question. You said &quot;godep will be standard in golang 1.10&quot;. Is this true? Where can I find such announcement/news? I thought govender would become standard in the future. thanks a lot."}, {"owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "edited": false, "score": 0, "creation_date": 1499791379, "post_id": 45019234, "comment_id": 77054571, "body": "It&#39;s pretty obvious considering that govendor has 439 commits and godep has 2024, and in addition, godep is under the official &quot;golang&quot; organization, and the wiki page on github states that fact."}], "tags": [], "owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "is_accepted": false, "score": 0, "last_activity_date": 1499711108, "creation_date": 1499711108, "answer_id": 45019234, "question_id": 45008976, "link": "https://stackoverflow.com/questions/45008976/what-is-the-difference-between-go-install-govendor-install-local-and-gove/45019234#45019234", "title": "What is the difference between `go install`, `govendor install +local` and `govendor install +vendor,^program`?", "body": "<p>Go first came into the world with a brand new idea for dependency management and workspace folder structure. There was a strict hierarchy where projects would be located (in <code>$gopath/src/site.com/user/project</code>) and other projects would simply import the latest version of all other projects. The problem with this is that if some upstream project changes the API, then your project will break inexplicably. This is where vendor comes in.</p>\n\n<p>Vendor is a subdirectory in your project that contains everything under <code>$gopath/src</code> that your project imports. The difference is that vendor isn't updated when upstream projects introduce new features and/or fixes. Therefore, you must update it yourself. When go looks for an import (as of the latest version), it will check vendor first and then look for the latest version in your <code>$gopath</code>, preventing builds from inexplicably breaking for no apparent reason.</p>\n\n<p><code>go install</code> updates your <code>$gopath</code> dependencies to the latest version; the version that all new projects and those without vendor will use.</p>\n\n<p><code>govendor install +vendor,^program</code> updates your specific project vendor dependencies. This should be done in a separate commit; you should <code>go test; govendor; git commit; go test</code> so that you can check whether updates break your project.</p>\n\n<p><code>govendor install +local</code> apparently just builds the project.</p>\n\n<p>Also, you should IMHO use godep rather than govendor. It IHMO has better workflow; your <code>$gopath</code> has the latest versions and then you can update your project with <code>godep update</code>. It is also supposed to be standard in golang 1.10.</p>\n"}], "owner": {"reputation": 2895, "user_id": 348719, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb180bc6dd7e72a35a27319fcd7e6fda?s=128&d=identicon&r=PG&f=1", "display_name": "sgon00", "link": "https://stackoverflow.com/users/348719/sgon00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3240, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499716243, "creation_date": 1499680502, "last_edit_date": 1499716243, "question_id": 45008976, "link": "https://stackoverflow.com/questions/45008976/what-is-the-difference-between-go-install-govendor-install-local-and-gove", "title": "What is the difference between `go install`, `govendor install +local` and `govendor install +vendor,^program`?", "body": "<p>When using govendor, what is the difference between <code>go install</code>, <code>govendor install +local</code> and <code>govendor install +vendor,^program</code>?</p>\n\n<p><code>govendor install +vendor,^program</code> says to build and install all my vendor packages. but what and where will it install to? Will it install my project and vendor's command executables to <code>$GOPATH/bin</code> and my project and vendor's package objects to <code>$GOPATH/pkg</code>? </p>\n\n<p><code>govendor install +local</code> says to build everything in your repository only. So what does it really mean? Will it create <code>vendor/bin</code> and <code>vendor/pkg</code>? </p>\n\n<p>what about if I run <code>go install</code> in my project? What will this be different to the above two commands? </p>\n"}, {"tags": ["java", "go", "maven-plugin"], "comments": [{"owner": {"reputation": 31754, "user_id": 2194470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b22c1842c6e8f7f2b9b3ed8c0d4efb4d?s=128&d=identicon&r=PG", "display_name": "Szymon Stepniak", "link": "https://stackoverflow.com/users/2194470/szymon-stepniak"}, "edited": false, "score": 0, "creation_date": 1499680102, "post_id": 45008773, "comment_id": 76991033, "body": "Maybe using maven docker container is an option in your case - <a href=\"https://hub.docker.com/_/maven/\" rel=\"nofollow noreferrer\">hub.docker.com/_/maven</a>"}, {"owner": {"reputation": 6453, "user_id": 916225, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ba66e25b90b0c202ef0770f81391be97?s=128&d=identicon&r=PG", "display_name": "Karthikeyan Vaithilingam", "link": "https://stackoverflow.com/users/916225/karthikeyan-vaithilingam"}, "edited": false, "score": 1, "creation_date": 1499680224, "post_id": 45008773, "comment_id": 76991120, "body": "AFAIK you need maven and java to run a maven plugin."}, {"owner": {"reputation": 2855, "user_id": 5105305, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-i8lMihc1yYc/AAAAAAAAAAI/AAAAAAAAAJE/ooPD4M12q8I/photo.jpg?sz=128", "display_name": "Kasun Siyambalapitiya", "link": "https://stackoverflow.com/users/5105305/kasun-siyambalapitiya"}, "reply_to_user": {"reputation": 31754, "user_id": 2194470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b22c1842c6e8f7f2b9b3ed8c0d4efb4d?s=128&d=identicon&r=PG", "display_name": "Szymon Stepniak", "link": "https://stackoverflow.com/users/2194470/szymon-stepniak"}, "edited": false, "score": 0, "creation_date": 1499682515, "post_id": 45008773, "comment_id": 76992619, "body": "@SzymonStepniak does maven docker needs <code>java</code> to be installed priorly"}, {"owner": {"reputation": 31754, "user_id": 2194470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b22c1842c6e8f7f2b9b3ed8c0d4efb4d?s=128&d=identicon&r=PG", "display_name": "Szymon Stepniak", "link": "https://stackoverflow.com/users/2194470/szymon-stepniak"}, "edited": false, "score": 0, "creation_date": 1499682725, "post_id": 45008773, "comment_id": 76992749, "body": "No, this container is shipped with JDK (you can choose form JDK7 to JDK9). Take a look at paragraph called &quot;Run a single Maven command&quot; on this docker page. It describes how to run single maven goal with this container. Ofc it requires docker daemon to be installed and running."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1499702960, "creation_date": 1499702960, "answer_id": 45016875, "question_id": 45008773, "link": "https://stackoverflow.com/questions/45008773/how-to-run-maven-plugins-via-go-lang/45016875#45016875", "title": "How to run maven plugins via go lang", "body": "<p>Java applications require Java, Ruby applications require Ruby, and .NET applications require .NET. You can't run a Java application with Go any more than you can run a Ruby application with gcc or a .NET application with Erlang. These things are not interchangeable.</p>\n"}], "owner": {"reputation": 2855, "user_id": 5105305, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-i8lMihc1yYc/AAAAAAAAAAI/AAAAAAAAAJE/ooPD4M12q8I/photo.jpg?sz=128", "display_name": "Kasun Siyambalapitiya", "link": "https://stackoverflow.com/users/5105305/kasun-siyambalapitiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1499702960, "creation_date": 1499679990, "question_id": 45008773, "link": "https://stackoverflow.com/questions/45008773/how-to-run-maven-plugins-via-go-lang", "title": "How to run maven plugins via go lang", "body": "<p>I am currently researching on a way to run maven goals ( in particular the <code>maven tycho plugin</code>) on a system without having both <code>java</code> and <code>maven</code> preinstalled and installing them is not an option. Is there anyway of doing that using <code>Go lang</code>?. Thanks in advance.</p>\n"}, {"tags": ["go", "ldap", "open-source", "redhat", "freeipa"], "comments": [{"owner": {"reputation": 9067, "user_id": 88122, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/U0pg3.png?s=128&g=1", "display_name": "jwilleke", "link": "https://stackoverflow.com/users/88122/jwilleke"}, "edited": false, "score": 0, "creation_date": 1499702745, "post_id": 45008714, "comment_id": 77007406, "body": "Are you binding as &quot;cn=directory manager&quot; as you are for the command line? Might be a rights issue."}, {"owner": {"reputation": 1, "user_id": 5950169, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VYma6BSrV6Q/AAAAAAAAAAI/AAAAAAAAAz4/cooSF8tqn48/photo.jpg?sz=128", "display_name": "Gowrishankar Pandurangan", "link": "https://stackoverflow.com/users/5950169/gowrishankar-pandurangan"}, "reply_to_user": {"reputation": 9067, "user_id": 88122, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/U0pg3.png?s=128&g=1", "display_name": "jwilleke", "link": "https://stackoverflow.com/users/88122/jwilleke"}, "edited": false, "score": 0, "creation_date": 1499859490, "post_id": 45008714, "comment_id": 77086241, "body": "@jwilleke, thanks for your reply, Actually we are using go ldap sdk as I mentioned above in that using function to search users &quot;ldap.NewSearchRequest&quot; it is not allowing to pass extra parameters(cn=directory manager)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5950169, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VYma6BSrV6Q/AAAAAAAAAAI/AAAAAAAAAz4/cooSF8tqn48/photo.jpg?sz=128", "display_name": "Gowrishankar Pandurangan", "link": "https://stackoverflow.com/users/5950169/gowrishankar-pandurangan"}, "edited": false, "score": 0, "creation_date": 1499936662, "post_id": 45059534, "comment_id": 77124586, "body": "Thanks, But already I done this because once we bind authentication only can communicate ldap to search. May I know any REST API available for freeipa?"}], "tags": [], "owner": {"reputation": 9067, "user_id": 88122, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/U0pg3.png?s=128&g=1", "display_name": "jwilleke", "link": "https://stackoverflow.com/users/88122/jwilleke"}, "is_accepted": false, "score": 0, "last_activity_date": 1499867257, "creation_date": 1499867257, "answer_id": 45059534, "question_id": 45008714, "link": "https://stackoverflow.com/questions/45008714/free-ipa-ldap-intergration-with-go/45059534#45059534", "title": "Free-IPA Ldap Intergration with GO", "body": "<p>You \"probably\" need to bind before you start the search using something <a href=\"https://github.com/go-ldap/ldap/blob/master/example_test.go\" rel=\"nofollow noreferrer\">like</a>:</p>\n\n<pre><code>// The username and password we want to check\n    username := \"someuser\"\n    password := \"userpassword\"\n\n    bindusername := \"readonly\"\n    bindpassword := \"password\"\n\n    l, err := ldap.Dial(\"tcp\", fmt.Sprintf(\"%s:%d\", \"ldap.example.com\", 389))\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer l.Close()\n\n    // Reconnect with TLS\n    err = l.StartTLS(&amp;tls.Config{InsecureSkipVerify: true})\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // First bind with a read only user\n    err = l.Bind(bindusername, bindpassword)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // Search for the given username\n    searchRequest := ldap.NewSearchRequest(\n        \"dc=example,dc=com\",\n        ldap.ScopeWholeSubtree, ldap.NeverDerefAliases, 0, 0, false,\n        fmt.Sprintf(\"(&amp;(objectClass=organizationalPerson)(uid=%s))\", username),\n        []string{\"dn\"},\n        nil,\n    )\n</code></pre>\n\n<p>Let me know how I can help.</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 6505143, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gFmFHpDKnHw/AAAAAAAAAAI/AAAAAAAAEGU/6kdrUbgJJVA/photo.jpg?sz=128", "display_name": "Martin Gignac", "link": "https://stackoverflow.com/users/6505143/martin-gignac"}, "is_accepted": false, "score": 0, "last_activity_date": 1539985218, "creation_date": 1539985218, "answer_id": 52900244, "question_id": 45008714, "link": "https://stackoverflow.com/questions/45008714/free-ipa-ldap-intergration-with-go/52900244#52900244", "title": "Free-IPA Ldap Intergration with GO", "body": "<p>A little late, perhaps, but if you're looking for an HTTP-based API (as you seem to do in one of the answer's comment), you could look at the following article:</p>\n\n<p><a href=\"http://www.admin-magazine.com/Archive/2016/34/A-REST-interface-for-FreeIPA\" rel=\"nofollow noreferrer\">http://www.admin-magazine.com/Archive/2016/34/A-REST-interface-for-FreeIPA</a></p>\n\n<p>There is actually a very complete JSON-RPC API that is accessible via HTTP. The article linked above gives an example of how to use it. Armed with the API browser included in the FreeIPA GUI you should be able to use the HTTP client in Go to code your own functions.</p>\n\n<p>Barring that GitHub has two potential libraries for you:</p>\n\n<ul>\n<li><a href=\"https://github.com/ubccr/goipa\" rel=\"nofollow noreferrer\">https://github.com/ubccr/goipa</a></li>\n<li><a href=\"https://github.com/tehwalris/go-freeipa\" rel=\"nofollow noreferrer\">https://github.com/tehwalris/go-freeipa</a></li>\n</ul>\n\n<p>The first implements only a few functions, but these could be enough for your needs. The other one is automatically generated but I don't know how good the result is.</p>\n\n<p>Note that I have used neither, so I cannot command on their usability.</p>\n"}], "owner": {"reputation": 1, "user_id": 5950169, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VYma6BSrV6Q/AAAAAAAAAAI/AAAAAAAAAz4/cooSF8tqn48/photo.jpg?sz=128", "display_name": "Gowrishankar Pandurangan", "link": "https://stackoverflow.com/users/5950169/gowrishankar-pandurangan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 687, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1539985218, "creation_date": 1499679815, "last_edit_date": 1499838757, "question_id": 45008714, "link": "https://stackoverflow.com/questions/45008714/free-ipa-ldap-intergration-with-go", "title": "Free-IPA Ldap Intergration with GO", "body": "<p>I am trying FreeIPA integration with golang using package \"gopkg.in/ldap.v2\", I created one role with name of \"test\" in FreeIPA UI and tried to search that role</p>\n\n<p><strong>via command line:</strong></p>\n\n<blockquote>\n  <p>ldapsearch -D \"cn=directory manager\" -w \"*****\" -p 389 -h \"ec2-test.eu-west-1.compute. amazonaws.com\" -b \"dc=ec2-test,dc=eu-west-1,dc=compute,dc=amazonaws,dc=com\" -v -s sub \"(&amp;(objectclass=*)(cn=test))\"</p>\n</blockquote>\n\n<p>Output:</p>\n\n<pre><code>ldap_initialize( ldap://ec2-test.eu-west-1.compute.amazonaws.com:389 ) filter: (&amp;(objectclass=*)(cn=test)) requesting: All userApplication attributes\n# extended LDIF\n#\n# LDAPv3\n# base &lt;dc=ec2-test,dc=eu-west-1,dc=compute,dc=amazonaws,dc=com&gt; with scope subtree\n# filter: (&amp;(objectclass=*)(cn=test))\n# requesting: ALL\n#\n\n# test, roles, accounts, ec2-test.eu-west-1.compute.amazonaws.com\ndn: cn=test,cn=roles,cn=accounts,dc=ec2-test,dc=eu-west-1,dc=compute,dc=amazonaws,dc=com\nobjectClass: groupofnames\nobjectClass: nestedgroup\nobjectClass: top\ncn: test\nmember: uid=gow,cn=users,cn=accounts,dc=ec2-test,dc=eu-west-1,dc=comp  ute,dc=amazonaws,dc=com\nmember: cn=trov,cn=groups,cn=accounts,dc=ec2-test,dc=eu-west-1,dc=com  pute,dc=amazonaws,dc=com\n\n# search result search: 2 result: 0 Success\n\n# numResponses: 2\n# numEntries: 1\n</code></pre>\n\n<p>I am trying to integrate this with my go code.\n<strong>My go code is:</strong></p>\n\n<pre><code>filterValue := \"(&amp;(objectclass=\"*\")(cn=\"test\"))\"\nsearchRequest := ldap.NewSearchRequest(\n    baseDN, // The base dn to search\n    ldap.ScopeWholeSubtree, ldap.NeverDerefAliases, 0, 0, false,\n    filterValue, // The filter to apply\n    []string{\"givenName\", \"sn\", \"mail\", \"uid\", \"ou\", \"cn\", \"dc\", \"dn\"}, // A list attributes to retrieve\n    nil,\n)\nsr, err := ldap.Search(searchRequest)\nif err!=nil {\n    fmt.Println(\"Error: , err)\n} else {\n    fmt.Println(\"Result: , sr.Entries)\n}\n</code></pre>\n\n<p>Unfortunately I am getting empty entries in <strong>sr.Entries</strong></p>\n\n<p>Can someone help me to get this with golang.</p>\n\n<blockquote>\n  <p>Note: Its working fine for <strong>users</strong> and <strong>groups</strong>.</p>\n</blockquote>\n"}, {"tags": ["dictionary", "go", "key"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1499716460, "post_id": 45008274, "comment_id": 77015228, "body": "Can you use <code>[3]float64</code>, and set the 3rd value to 0 (or some other unused value) when it&#39;s not used?  Or use <code>[4]float64</code> with the first value being the (integer) length?  These are logically the same as using a struct, but possibly more performant, at the expense of being harder to read."}, {"owner": {"reputation": 196, "user_id": 3178094, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f6791749fbab91811ea3a8bff38dbb86?s=128&d=identicon&r=PG&f=1", "display_name": "mik", "link": "https://stackoverflow.com/users/3178094/mik"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1499720278, "post_id": 45008274, "comment_id": 77017242, "body": "I actually have the [3]float64 case done also.   I have a switch to navigate through dimensions.   Because I wanted to generalize I also have an alternate method, though not so fast. I converted the input data to string, and proceeded to concatenate it. it doubles the processing time. however, for some applications its valid :) thanks for the input!"}], "answers": [{"comments": [{"owner": {"reputation": 196, "user_id": 3178094, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f6791749fbab91811ea3a8bff38dbb86?s=128&d=identicon&r=PG&f=1", "display_name": "mik", "link": "https://stackoverflow.com/users/3178094/mik"}, "edited": false, "score": 1, "creation_date": 1499700285, "post_id": 45010246, "comment_id": 77005684, "body": "Maybe I&#39;m missing the implementation of this. I intend to create a counter for the values in the slice. If I create a pointer to the slice, it will be a new value all the time, and the counter will be 1 for all entries. Is there an easy way to do this that I&#39;m not seeing?"}, {"owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "reply_to_user": {"reputation": 196, "user_id": 3178094, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f6791749fbab91811ea3a8bff38dbb86?s=128&d=identicon&r=PG&f=1", "display_name": "mik", "link": "https://stackoverflow.com/users/3178094/mik"}, "edited": false, "score": 1, "creation_date": 1499757553, "post_id": 45010246, "comment_id": 77029702, "body": "You could create a slice with make with a big enough capacity, while you do not surpass it&#39;s capacity, the pointer will remain the same."}, {"owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "reply_to_user": {"reputation": 196, "user_id": 3178094, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f6791749fbab91811ea3a8bff38dbb86?s=128&d=identicon&r=PG&f=1", "display_name": "mik", "link": "https://stackoverflow.com/users/3178094/mik"}, "edited": false, "score": 1, "creation_date": 1499762533, "post_id": 45010246, "comment_id": 77032798, "body": "Take a look here <a href=\"https://play.golang.org/p/333tRMpBLv\" rel=\"nofollow noreferrer\">play.golang.org/p/333tRMpBLv</a> , it exemplifies my suggestion. see that while len &lt; cap the pointer of the slice is not changed, append only creates a new slice when len exceeds cap."}, {"owner": {"reputation": 196, "user_id": 3178094, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f6791749fbab91811ea3a8bff38dbb86?s=128&d=identicon&r=PG&f=1", "display_name": "mik", "link": "https://stackoverflow.com/users/3178094/mik"}, "edited": false, "score": 0, "creation_date": 1499931183, "post_id": 45010246, "comment_id": 77120850, "body": "Thanks for the suggestion. It seems the pointer remains the same - at least that&#39;s what it seems from my own machine and the sandbox you provided. maybe it was possible in an older go version..."}, {"owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "reply_to_user": {"reputation": 196, "user_id": 3178094, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f6791749fbab91811ea3a8bff38dbb86?s=128&d=identicon&r=PG&f=1", "display_name": "mik", "link": "https://stackoverflow.com/users/3178094/mik"}, "edited": false, "score": 0, "creation_date": 1500029848, "post_id": 45010246, "comment_id": 77173556, "body": "Append will change the pointer if you add more elements to the array that it&#39;s capacity and there is no more memory in that block. If it can expand in the same memory block it will and will not change the pointer. So you cannot be sure that it will not change when expanding array beyond its cap. So to be sure this does not happen I would recommend setting a high enough cap."}], "tags": [], "owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "is_accepted": true, "score": 1, "last_activity_date": 1499762548, "last_edit_date": 1499762548, "creation_date": 1499684217, "answer_id": 45010246, "question_id": 45008274, "link": "https://stackoverflow.com/questions/45008274/define-map-with-keys-with-arbitrary-dimension/45010246#45010246", "title": "Define map with keys with arbitrary dimension", "body": "<p>Why not use the pointer to a slice as key?</p>\n\n<p>You could create a slice with make with a big enough capacity, while you do not surpass it's capacity, the pointer will remain the same.</p>\n\n<p>Take a look here <a href=\"https://play.golang.org/p/333tRMpBLv\" rel=\"nofollow noreferrer\">https://play.golang.org/p/333tRMpBLv</a> , it exemplifies my suggestion. see that while len &lt; cap the pointer of the slice is not changed, append only creates a new slice when len exceeds cap. </p>\n"}], "owner": {"reputation": 196, "user_id": 3178094, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f6791749fbab91811ea3a8bff38dbb86?s=128&d=identicon&r=PG&f=1", "display_name": "mik", "link": "https://stackoverflow.com/users/3178094/mik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 45010246, "answer_count": 1, "score": 1, "last_activity_date": 1499762548, "creation_date": 1499678571, "last_edit_date": 1499716288, "question_id": 45008274, "link": "https://stackoverflow.com/questions/45008274/define-map-with-keys-with-arbitrary-dimension", "title": "Define map with keys with arbitrary dimension", "body": "<p>The following code serves to create a counter for each pair of float64.<br>\nBecause the keys of a map cannot be a <a href=\"https://stackoverflow.com/questions/20297503/slice-as-a-key-in-map\">slice</a>, I have to use arrays as keys, which forces me to to define a dimension with a constant.</p>\n\n<pre><code>counter := make( map[ [2]float64 ] int )\nfor _, comb := range combinations{ //combinations is a [n][2]float64\n    for _, row := range data{  \n        counter[ [...]float64{ row[comb[0]] , row[comb[1]] } ]++\n    }\n}\n</code></pre>\n\n<p>Having said that, is there a way to make this map dependent on the length of the keys (dependent on the dimensions of combinations?<br>\nI tried using a struct as key, but as far as I remember (I might be wrong), it was a bit slower... For my purposes (to apply this for all combinations ~n!) this is not the ideal solution.</p>\n\n<p>Right now I'm only considering combinations of size 2 and 3, and I had to split this in two separate functions, which makes my code very verbose and harder to maintain.\nCan you find a way to simplify this, so I can scale it to more dimensions? </p>\n\n<p>Thanks for any input</p>\n"}, {"tags": ["oop", "go", "types"], "answers": [{"tags": [], "owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "is_accepted": true, "score": 4, "last_activity_date": 1499676043, "last_edit_date": 1499676043, "creation_date": 1499675560, "answer_id": 45007271, "question_id": 45007100, "link": "https://stackoverflow.com/questions/45007100/are-methods-instead-of-functions-preferred-in-this-case/45007271#45007271", "title": "Are methods instead of functions preferred in this case", "body": "<p>You could do something like this to avoid having to explicitly pass <code>frob</code> over and over, while still being able to avoid making those functions methods on <code>frob</code>.</p>\n\n<pre><code>type frobChecker struct {\n    frob some.Frob\n}\n\nfunc (fc frobChecker) discountLimit(maxDiscount float64) (RuleStatus, string) \nfunc (fc frobChecker) discountPercentageLimit(maxDiscountPercentage float64) (RuleStatus, string) \nfunc (fc frobChecker) usageLimit(interval valueInterval) (RuleStatus, string) \nfunc (fc frobChecker) permanentExpiryLimit() (RuleStatus, string) \nfunc (fc frobChecker) voucherValidity(maxValidityDays uint) (RuleStatus, string) \n\nfunc doChecks(frob some.Frob) {\n    fc := frobChcker{frob}\n\n    status, message := fc.discountLimit(100)\n\n    if status != PASSED {\n       ....\n    }\n\n    ... evaluate all remaining rules here ...\n}\n</code></pre>\n"}], "owner": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 1, "accepted_answer_id": 45007271, "answer_count": 1, "score": 0, "last_activity_date": 1499676043, "creation_date": 1499674976, "question_id": 45007100, "link": "https://stackoverflow.com/questions/45007100/are-methods-instead-of-functions-preferred-in-this-case", "title": "Are methods instead of functions preferred in this case", "body": "<p>I have a whole set of functions that look like this:</p>\n\n<pre><code>package rules;\n\nimport \"project/some\"\n\nfunc frobDiscountLimit(frob some.Frob, maxDiscount float64) (RuleStatus, string) \nfunc frobDiscountPercentageLimit(frob some.Frob, maxDiscountPercentage float64) (RuleStatus, string) \nfunc frobUsageLimit(frob some.Frob, interval valueInterval) (RuleStatus, string) \nfunc frobPermanentExpiryLimit(frob some.Frob) (RuleStatus, string) \nfunc frobVoucherValidity(frob some.Frob, maxValidityDays uint) (RuleStatus, string) \n</code></pre>\n\n<p>Usage example:</p>\n\n<pre><code>package rules\n\nimport \"project/some\"\n\nfunc doChecks(frob some.Frob) {\n    status, message := frobDiscountLimit(frob, 100)\n\n    if status != PASSED {\n       ....\n    }\n\n    ... evaluate all remaining rules here ...\n}\n</code></pre>\n\n<p>I wonder is there any advantage writing it like:</p>\n\n<pre><code>func (f someFrob) discountLimit(maxDiscount float64) (RuleStatus, string) \n...\n</code></pre>\n\n<p>It seems shorter to write, but I'm unsure which is the correct style. Because I don't think of these validation methods as \"part of the object\", they are not part of the behaviour of the <code>some.Frob</code> object (unlike, say, a getter or a setter for property of <code>some.Frob</code>). </p>\n"}, {"tags": ["go", "mgo"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1499673870, "post_id": 45006415, "comment_id": 76986877, "body": "Generally you pass a pointer to <code>Query.One()</code>. What is your <code>result</code>? Please provide a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete and Verifiable example</a>."}, {"owner": {"reputation": 117, "user_id": 5413452, "user_type": "registered", "profile_image": "https://graph.facebook.com/1593540604/picture?type=large", "display_name": "Gaurav Garg", "link": "https://stackoverflow.com/users/5413452/gaurav-garg"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1499674726, "post_id": 45006415, "comment_id": 76987388, "body": "I got this result :                                                           <b>595f2c1a6edcba0619073263          {ObjectIdHex(&quot;&quot;) 0   0  0    0 {         0    false 0    } 0 0 0  0 0 0 0}          ObjectIDs must be exactly 12 bytes long (got 24) not found</b>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1499675248, "post_id": 45006415, "comment_id": 76987721, "body": "Ok, then it&#39;s an exact duplicate of your previous question."}], "owner": {"reputation": 117, "user_id": 5413452, "user_type": "registered", "profile_image": "https://graph.facebook.com/1593540604/picture?type=large", "display_name": "Gaurav Garg", "link": "https://stackoverflow.com/users/5413452/gaurav-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "closed_date": 1499675263, "answer_count": 0, "score": 0, "last_activity_date": 1499675958, "creation_date": 1499672788, "last_edit_date": 1499675958, "question_id": 45006415, "link": "https://stackoverflow.com/questions/45006415/mgo-library-for-golang-not-searching-by-id", "closed_reason": "Duplicate", "title": "Mgo library for Golang not searching by ID?", "body": "<p>I am using mgo \"gopkg.in/mgo.v2\" Package and stuck on very first step, I am not able to find by ObjectID, I have a string message.ID, and \nis not being searched no matter what ,</p>\n\n<pre><code>session, err := mgo.Dial(\"localhost\")\nif err != nil {\n    panic(err)\n}\ndefer session.Close()\nsession.SetMode(mgo.Monotonic, true)\ncoll := session.DB(\"aaaw_web\").C(\"cron_emails\")\n\nerr = coll.FindId(bson.ObjectIdHex(message.ID)).One(result)\n</code></pre>\n\n<p>However, the document I am looking for exists in Mongo.</p>\n"}, {"tags": ["mysql", "go", "sqlx"], "answers": [{"tags": [], "owner": {"reputation": 1169, "user_id": 498109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/100036fbeed75b1abf5bf0161d1fb560?s=128&d=identicon&r=PG", "display_name": "Vadyus", "link": "https://stackoverflow.com/users/498109/vadyus"}, "is_accepted": true, "score": 2, "last_activity_date": 1499672769, "creation_date": 1499672769, "answer_id": 45006409, "question_id": 45006269, "link": "https://stackoverflow.com/questions/45006269/how-to-share-mysql-connection-using-sqlx/45006409#45006409", "title": "How to share mysql connection using sqlx?", "body": "<p>Error message says pretty much everything :). Get() method is not intended to scan into slice, use Select() instead</p>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 960, "favorite_count": 0, "accepted_answer_id": 45006409, "answer_count": 1, "score": 0, "last_activity_date": 1499672769, "creation_date": 1499672342, "last_edit_date": 1499672710, "question_id": 45006269, "link": "https://stackoverflow.com/questions/45006269/how-to-share-mysql-connection-using-sqlx", "title": "How to share mysql connection using sqlx?", "body": "<p>I'd like to share sqlx connection to be used in other functions. Here is what I came up  with:</p>\n\n<pre><code> var dbmap = initDb()\n\n func initDb() *sqlx.DB {         \n        db, err := sqlx.Connect(\"mysql\", \"myuser:mypasswd@tcp(127.0.0.1:3306)/mydb\")        \n        if err != nil {\n            log.Fatalln(err)\n        }        \n        // defer db.Close()        \n        return db\n    }\n</code></pre>\n\n<p>And then in functions I'd like to make queries like:</p>\n\n<pre><code>var users []User\nerr := dbmap.Get(&amp;users, \"SELECT * FROM user\")\n</code></pre>\n\n<p>However I get panic:</p>\n\n<pre><code>scannable dest type slice with &gt;1 columns (3) in result\n\n\n2017/07/10 09:32:59 [Recovery] panic recovered:\nGET /api/v1/users HTTP/1.1\nHost: 127.0.0.1:8080\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en-US,en;q=0.8\nCache-Control: max-age=0\nConnection: keep-alive\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36\nscannable dest type slice with &gt;1 columns (3) in result\n/usr/lib/go-1.6/src/runtime/panic.go:443 (0x436179)\n    gopanic: reflectcall(nil, unsafe.Pointer(d.fn), deferArgs(d), uint32(d.siz), uint32(d.siz))\n/usr/lib/go-1.6/src/log/log.go:320 (0x46a551)\n    Panic: panic(s)\n/home/me/go/src/myapp/main.go:84 (0x4098bd)\n    GetUsers: log.Panic(err)\n/home/me/go/src/github.com/gin-gonic/gin/context.go:97 (0x47773a)\n    (*Context).Next: c.handlers[c.index](c)\n/home/me/go/src/myapp/main.go:54 (0x40b170)\n    Cors.func1: c.Next()\n/home/me/go/src/github.com/gin-gonic/gin/context.go:97 (0x47773a)\n    (*Context).Next: c.handlers[c.index](c)\n/home/me/go/src/github.com/gin-gonic/gin/recovery.go:45 (0x489fd1)\n    RecoveryWithWriter.func1: c.Next()\n/home/me/go/src/github.com/gin-gonic/gin/context.go:97 (0x47773a)\n    (*Context).Next: c.handlers[c.index](c)\n/home/me/go/src/github.com/gin-gonic/gin/logger.go:63 (0x48926a)\n    LoggerWithWriter.func1: c.Next()\n/home/me/go/src/github.com/gin-gonic/gin/context.go:97 (0x47773a)\n    (*Context).Next: c.handlers[c.index](c)\n/home/me/go/src/github.com/gin-gonic/gin/gin.go:284 (0x47e592)\n    (*Engine).handleHTTPRequest: context.Next()\n/home/me/go/src/github.com/gin-gonic/gin/gin.go:265 (0x47e1c7)\n    (*Engine).ServeHTTP: engine.handleHTTPRequest(c)\n/usr/lib/go-1.6/src/net/http/server.go:2081 (0x60372e)\n    serverHandler.ServeHTTP: handler.ServeHTTP(rw, req)\n/usr/lib/go-1.6/src/net/http/server.go:1472 (0x5fffde)\n    (*conn).serve: serverHandler{c.server}.ServeHTTP(w, w.req)\n/usr/lib/go-1.6/src/runtime/asm_amd64.s:1998 (0x467171)\n    goexit: BYTE    $0x90   // NOP\n</code></pre>\n\n<p>What's wrong here? How can I fix it?</p>\n"}, {"tags": ["go", "return", "variable-assignment", "specifications"], "answers": [{"tags": [], "owner": {"reputation": 3568, "user_id": 883073, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8c89afe401e100d1271d5402dc25b856?s=128&d=identicon&r=PG", "display_name": "Halle Knast", "link": "https://stackoverflow.com/users/883073/halle-knast"}, "is_accepted": true, "score": 1, "last_activity_date": 1499671705, "last_edit_date": 1592644375, "creation_date": 1499671705, "answer_id": 45006090, "question_id": 45006089, "link": "https://stackoverflow.com/questions/45006089/in-go-when-are-values-copied-in-multivalue-assignments/45006090#45006090", "title": "In Go, when are values copied in multivalue assignments?", "body": "<p>According to the spec section on <a href=\"https://golang.org/ref/spec#Order_of_evaluation\" rel=\"nofollow noreferrer\">order of evaluation</a>, functions and receive operations in a statement like this are evaluated from left to right:</p>\n<blockquote>\n<p>For example, in the (function-local) assignment</p>\n<pre><code>y[f()], ok = g(h(), i()+x[j()], &lt;-c), k()\n</code></pre>\n<p>the function calls and communication happen in the order <code>f()</code>, <code>h()</code>, <code>i()</code>, <code>j()</code>, <code>&lt;-c</code>, <code>g()</code>, and <code>k()</code>. <em>However, the order of those events compared to the evaluation and indexing of <code>x</code> and the evaluation of <code>y</code> is not specified.</em></p>\n</blockquote>\n<p>But as stated in the emphasized sentence, the order of variable evaluation is not specified.</p>\n<p>The section gives another example that makes this even clearer:</p>\n<pre><code>a := 1\nf := func() int { a++; return a }\nx := []int{a, f()}\n// x may be [1, 2] or [2, 2]: evaluation order between a and f() is not specified\n</code></pre>\n<p>So while the behavior is as desired, it is unfortunately not specified and cannot be relied on.</p>\n"}], "owner": {"reputation": 3568, "user_id": 883073, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8c89afe401e100d1271d5402dc25b856?s=128&d=identicon&r=PG", "display_name": "Halle Knast", "link": "https://stackoverflow.com/users/883073/halle-knast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 45006090, "answer_count": 1, "score": 0, "last_activity_date": 1499755593, "creation_date": 1499671705, "last_edit_date": 1499755593, "question_id": 45006089, "link": "https://stackoverflow.com/questions/45006089/in-go-when-are-values-copied-in-multivalue-assignments", "title": "In Go, when are values copied in multivalue assignments?", "body": "<p>Consider the following Go function (<a href=\"https://play.golang.org/p/w_qhsSTTJi\" rel=\"nofollow noreferrer\">playground</a>), which was evaluated with Go 1.8:</p>\n\n<pre><code>func f() (int, bool) {\n  i := 0\n  c := make(chan bool)\n  go func() {\n    time.Sleep(1 * time.Second)\n    i = 1\n    c &lt;- true\n  }()\n\n  // In practice, `i` will always be 0 here.\n  return i, &lt;-c // returns 1, true\n}\n</code></pre>\n\n<p>As stated in the comments, the function seem to always copy <code>i</code> <em>after</em> <code>c</code> has yielded a value. As this happens ~1s after encountering the return statement, this is not what I expected.</p>\n\n<p>The behavior is the same if the value order is reversed in the return and also if the return is replaced by assignment.</p>\n\n<p>Note that I'm not claiming this behavior to be wrong - just unexpected. In fact, this will almost always be what you want to happen.</p>\n\n<p>The question therefore is if this intended/specified behavior that can be relied on?</p>\n\n<p>The spec section on the <a href=\"https://golang.org/ref/spec#Receive_operator\" rel=\"nofollow noreferrer\">receive operator</a> doesn't state exactly when it blocks the thread in cases like this.</p>\n"}, {"tags": ["arrays", "go", "var"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 4, "creation_date": 1499668223, "post_id": 45004854, "comment_id": 76983822, "body": "Because <code>append</code> returns result, and you don&#39;t use it."}], "answers": [{"tags": [], "owner": {"reputation": 1917, "user_id": 4039768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWQUf.jpg?s=128&g=1", "display_name": "Mohsin", "link": "https://stackoverflow.com/users/4039768/mohsin"}, "is_accepted": true, "score": 99, "last_activity_date": 1499668907, "creation_date": 1499668907, "answer_id": 45005304, "question_id": 45004854, "link": "https://stackoverflow.com/questions/45004854/golang-append-evaluated-but-not-used/45005304#45005304", "title": "golang append() evaluated but not used", "body": "<p>Refer: <a href=\"https://golang.org/ref/spec#Appending_and_copying_slices\" rel=\"noreferrer\">Appending to and copying slices</a></p>\n\n<p>In Go, arguments are passed by value.</p>\n\n<p>Typical <code>append</code> usage is:  </p>\n\n<pre><code>a = append(a, x)\n</code></pre>\n\n<p>You need to write:</p>\n\n<pre><code>func main(){\n    var array [10]int\n    sliceA := array[0:5]\n    // append(sliceA, 4)  // discard\n    sliceA = append(sliceA, 4)  // keep\n    fmt.Println(sliceA)\n}\n</code></pre>\n\n<p><strong>Output</strong>:  </p>\n\n<pre><code>[0 0 0 0 0 4]\n</code></pre>\n\n<p>I hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 7035391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77f34b0579b54539b9428e4be955c58c?s=128&d=identicon&r=PG&f=1", "display_name": "\u69b4\u83b2\u69b4\u83b2", "link": "https://stackoverflow.com/users/7035391/%e6%a6%b4%e8%8e%b2%e6%a6%b4%e8%8e%b2"}, "is_accepted": false, "score": 5, "last_activity_date": 1613193496, "last_edit_date": 1613193496, "creation_date": 1499669093, "answer_id": 45005364, "question_id": 45004854, "link": "https://stackoverflow.com/questions/45004854/golang-append-evaluated-but-not-used/45005364#45005364", "title": "golang append() evaluated but not used", "body": "<pre class=\"lang-golang prettyprint-override\"><code>sliceA = append(sliceA, 4)\n</code></pre>\n<p><code>append()</code>  returns a slice containing one or more new values.<br />\nNote that we need to accept a return value from append as we may get a new slice value.</p>\n"}, {"tags": [], "owner": {"reputation": 6347, "user_id": 613703, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7a530ba90b271e192e6bc9dbcce3e16e?s=128&d=identicon&r=PG", "display_name": "djt", "link": "https://stackoverflow.com/users/613703/djt"}, "is_accepted": false, "score": 1, "last_activity_date": 1499669373, "creation_date": 1499669373, "answer_id": 45005422, "question_id": 45004854, "link": "https://stackoverflow.com/questions/45004854/golang-append-evaluated-but-not-used/45005422#45005422", "title": "golang append() evaluated but not used", "body": "<p>Per the Go docs:</p>\n\n<blockquote>\n  <p>The resulting value of append is a slice containing all the elements of the original slice plus the provided values.</p>\n</blockquote>\n\n<p>So the return value of 'append', will contain your original slice with the appended portion.   </p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 8096201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lTPId.png?s=128&g=1", "display_name": "Nevercare", "link": "https://stackoverflow.com/users/8096201/nevercare"}, "is_accepted": false, "score": 4, "last_activity_date": 1499683754, "creation_date": 1499683754, "answer_id": 45010098, "question_id": 45004854, "link": "https://stackoverflow.com/questions/45004854/golang-append-evaluated-but-not-used/45010098#45010098", "title": "golang append() evaluated but not used", "body": "<p>you may try this:</p>\n\n<pre><code>sliceA = append(sliceA, 4)\n</code></pre>\n\n<p>built-in function <code>append([]type, ...type)</code> returns an array/slice of type, which should be assigned to the value you wanted, while the input array/slice is just a source. Simply, <code>outputSlice = append(sourceSlice, appendedValue)</code></p>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 2755464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Awjv.jpg?s=128&g=1", "display_name": "xwang", "link": "https://stackoverflow.com/users/2755464/xwang"}, "is_accepted": false, "score": 1, "last_activity_date": 1575403028, "creation_date": 1575403028, "answer_id": 59164445, "question_id": 45004854, "link": "https://stackoverflow.com/questions/45004854/golang-append-evaluated-but-not-used/59164445#59164445", "title": "golang append() evaluated but not used", "body": "<p>The key to understand is that slice is just a \"view\" of the underling array.\nYou pass that view to the append function <strong>by value</strong>, the underling array gets modified, at the end the return value of append function gives you the different view of the underling array. i.e. the slice has more items in it</p>\n\n<pre><code>your code\nsliceA := array[0:5]  // sliceA is pointing to [0,5)\nappend(sliceA, 4) // sliceA is still the original view [0,5) until you do the following\n\nsliceA = append(sliceA, 4)\n</code></pre>\n\n<p>reference: <a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">https://blog.golang.org/slices</a></p>\n"}], "owner": {"reputation": 733, "user_id": 8034425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/915850af032ad987ca36df220fe72a95?s=128&d=identicon&r=PG&f=1", "display_name": "L.jerson", "link": "https://stackoverflow.com/users/8034425/l-jerson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34161, "favorite_count": 8, "accepted_answer_id": 45005304, "answer_count": 5, "score": 73, "last_activity_date": 1613193496, "creation_date": 1499667138, "last_edit_date": 1499668815, "question_id": 45004854, "link": "https://stackoverflow.com/questions/45004854/golang-append-evaluated-but-not-used", "title": "golang append() evaluated but not used", "body": "<pre><code>func main(){\n     var array [10]int\n     sliceA := array[0:5]\n     append(sliceA, 4)\n     fmt.Println(sliceA)\n}\n</code></pre>\n\n<blockquote>\n  <p>Error : append(sliceA, 4) evaluated but not used</p>\n</blockquote>\n\n<p>I don't Know why? The slice append operation is not run...</p>\n"}, {"tags": ["http", "go", "concurrency"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1499667455, "post_id": 45004791, "comment_id": 76983495, "body": "Concurrent. Possible duplicate of <a href=\"https://stackoverflow.com/questions/37782073/webhook-process-run-on-another-goroutine/37783535#37783535\">Webhook process run on another goroutine</a>; and <a href=\"https://stackoverflow.com/questions/44070323/server-instances-with-multiple-users/44070394#44070394\">Server instances with multiple users</a>; and <a href=\"https://stackoverflow.com/questions/37529511/process-management-for-the-go-webserver/37531953#37531953\">Process Management for the Go Webserver</a>."}, {"owner": {"reputation": 873, "user_id": 4509355, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/31648f80ef66006febaecde7c76b7319?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Roy", "link": "https://stackoverflow.com/users/4509355/nishant-roy"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1499672323, "post_id": 45004791, "comment_id": 76986035, "body": "Gotcha! And how about calling the python script? Will the concurrent goroutines be blocked?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1499672407, "post_id": 45004791, "comment_id": 76986072, "body": "I don&#39;t know how you call them and what they do, but in general you could say that the calling goroutine (request) will be blocked, but you can call the script from multiple requests, concurrently."}, {"owner": {"reputation": 873, "user_id": 4509355, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/31648f80ef66006febaecde7c76b7319?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Roy", "link": "https://stackoverflow.com/users/4509355/nishant-roy"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1499677336, "post_id": 45004791, "comment_id": 76989040, "body": "<code>exec.Command(&quot;python&quot;, pythonFile, args)</code> is how I call it"}, {"owner": {"reputation": 54248, "user_id": 95190, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a58c0b44762885ca46ecee7f5b379f3d?s=128&d=identicon&r=PG", "display_name": "WiredPrairie", "link": "https://stackoverflow.com/users/95190/wiredprairie"}, "edited": false, "score": 0, "creation_date": 1499682932, "post_id": 45004791, "comment_id": 76992879, "body": "I would suggest you test it by adding code in python that sleeps for several seconds."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 54248, "user_id": 95190, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a58c0b44762885ca46ecee7f5b379f3d?s=128&d=identicon&r=PG", "display_name": "WiredPrairie", "link": "https://stackoverflow.com/users/95190/wiredprairie"}, "edited": false, "score": 1, "creation_date": 1499690943, "post_id": 45004791, "comment_id": 76998569, "body": "@WiredPrairie That&#39;s just the way you create an <code>exec.Cmd</code>. <code>Cmd.Run()</code> runs it and waits for it to complete (blocks). <code>Cmd.Start()</code> starts it but does not wait (does not block). If you use <code>Cmd.Start()</code>, you may use <code>Cmd.Wait()</code> to wait for it to complete."}, {"owner": {"reputation": 54248, "user_id": 95190, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a58c0b44762885ca46ecee7f5b379f3d?s=128&d=identicon&r=PG", "display_name": "WiredPrairie", "link": "https://stackoverflow.com/users/95190/wiredprairie"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1499695445, "post_id": 45004791, "comment_id": 77001988, "body": "@icza -- I understand that -- I&#39;m suggesting that a little bit of testing could resolve these questions easily."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 54248, "user_id": 95190, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a58c0b44762885ca46ecee7f5b379f3d?s=128&d=identicon&r=PG", "display_name": "WiredPrairie", "link": "https://stackoverflow.com/users/95190/wiredprairie"}, "edited": false, "score": 0, "creation_date": 1499695561, "post_id": 45004791, "comment_id": 77002085, "body": "@WiredPrairie Actually I meant to address that comment to the asker NishantRoy..."}, {"owner": {"reputation": 54248, "user_id": 95190, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a58c0b44762885ca46ecee7f5b379f3d?s=128&d=identicon&r=PG", "display_name": "WiredPrairie", "link": "https://stackoverflow.com/users/95190/wiredprairie"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1499702710, "post_id": 45004791, "comment_id": 77007380, "body": "@icza - :) gotcha"}], "answers": [{"tags": [], "owner": {"reputation": 1326, "user_id": 326736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/603df98abd0bf6d97478464fdf1f4de4?s=128&d=identicon&r=PG", "display_name": "Kalyan02", "link": "https://stackoverflow.com/users/326736/kalyan02"}, "is_accepted": true, "score": 3, "last_activity_date": 1499943953, "creation_date": 1499943953, "answer_id": 45078797, "question_id": 45004791, "link": "https://stackoverflow.com/questions/45004791/golang-http-server-requests-async-or-sync/45078797#45078797", "title": "Golang HTTP server requests async or sync?", "body": "<p>Yes, by default all http requests can be executed concurrently. </p>\n\n<p>If you are executing a python script, then indeed a separate process will be spawned and they will execute concurrently. </p>\n\n<p>Please note that this carries the potential risk of spawning too many processes and running out of resources.</p>\n"}], "owner": {"reputation": 873, "user_id": 4509355, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/31648f80ef66006febaecde7c76b7319?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Roy", "link": "https://stackoverflow.com/users/4509355/nishant-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4411, "favorite_count": 0, "accepted_answer_id": 45078797, "answer_count": 1, "score": 7, "last_activity_date": 1499943953, "creation_date": 1499666830, "question_id": 45004791, "link": "https://stackoverflow.com/questions/45004791/golang-http-server-requests-async-or-sync", "title": "Golang HTTP server requests async or sync?", "body": "<p>I have a RESTful API in Golang that my Angular website calls. </p>\n\n<p>Does the Go http module by default handle requests in sequence or concurrently? </p>\n\n<p>Also, if my HandlerFunc in Go calls a python script, would concurrent calls to this HandlerFunc spawn multiple python processes, or would they be blocked till one is complete?</p>\n"}, {"tags": ["json", "http", "go", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": false, "score": 1, "last_activity_date": 1499658781, "creation_date": 1499658781, "answer_id": 45003544, "question_id": 45003457, "link": "https://stackoverflow.com/questions/45003457/no-json-returned/45003544#45003544", "title": "No Json returned", "body": "<p>As per your code flow, I do not see a point of using goroutine. May you have some reason.</p>\n\n<p>Let's get to your question. Currently your request gets completed before the goroutine that was started by <code>viewdata</code> handler. So, you have to use <code>sync.WaitGroup</code> to wait for goroutine <code>test1</code> to complete the execution. </p>\n\n<p>Your update code:</p>\n\n<pre><code>func viewdata(w http.ResponseWriter, r *http.Request) {\n    var wg sync.WaitGroup\n    wg.Add(1)\n    go test1(w, r, &amp;wg)\n    wg.Wait()\n}\n\nfunc test1(w http.ResponseWriter, r *http.Request, wg *sync.WaitGroup) {\n    defer wg.Done()\n\n    ll := sample{\n        \"city\",\n        12,\n    }\n\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    json, _ := json.Marshal(ll)\n    w.Write(json)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "is_accepted": false, "score": 0, "last_activity_date": 1499660407, "creation_date": 1499660407, "answer_id": 45003717, "question_id": 45003457, "link": "https://stackoverflow.com/questions/45003457/no-json-returned/45003717#45003717", "title": "No Json returned", "body": "<p>http handler is already spawned as goroutine. So you don't need to spawn your goroutine.</p>\n\n<pre><code>func viewdata(w http.ResponseWriter, r *http.Request) {\n    ll := sample{\n        \"city\",\n        12,\n    }\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    w.NewEncoder(w).Encode(ll)\n}\n</code></pre>\n"}], "owner": {"reputation": 415, "user_id": 6021348, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/ddc2ecdf76091c717de352c775ee9e55?s=128&d=identicon&r=PG&f=1", "display_name": "amanda45", "link": "https://stackoverflow.com/users/6021348/amanda45"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499660407, "creation_date": 1499657943, "question_id": 45003457, "link": "https://stackoverflow.com/questions/45003457/no-json-returned", "title": "No Json returned", "body": "<p>I am trying to use a Go routine to return back Json data to a request. When I test1(w,r) without the \"go\" my code works. When I use test1() as a go routine I dont get any json data back. Why is this happening?</p>\n\n<pre><code>func main() {\n\n    http.HandleFunc(\"/test\", viewdata)\n\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc viewdata(w http.ResponseWriter, r *http.Request) {\n\n    go test1(w, r)\n\n}\n\nfunc test1(w http.ResponseWriter, r *http.Request) {\n\n   // example struct\n    ll := sample{\n        \"city\",\n        12,\n    }\n\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    json, _ := json.Marshal(ll)\n    w.Write(json)\n\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4222, "user_id": 2072269, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/xNPjb.png?s=128&g=1", "display_name": "muru", "link": "https://stackoverflow.com/users/2072269/muru"}, "edited": false, "score": 3, "creation_date": 1499657319, "post_id": 45003259, "comment_id": 76980744, "body": "<a href=\"https://golang.org/cmd/compile/\" rel=\"nofollow noreferrer\">golang.org/cmd/compile</a> has an option to <i>disable</i> optimizations."}], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": false, "score": 13, "last_activity_date": 1524544175, "last_edit_date": 1524544175, "creation_date": 1499657227, "answer_id": 45003378, "question_id": 45003259, "link": "https://stackoverflow.com/questions/45003259/passing-an-optimization-flag-to-a-go-compiler/45003378#45003378", "title": "Passing an optimization flag to a Go compiler?", "body": "<p>Actually no explicit flags, this Go wiki <a href=\"https://github.com/golang/go/wiki/CompilerOptimizations\" rel=\"noreferrer\">page</a> lists optimizations done by the Go compiler and there was a discussion around this topic in <a href=\"https://groups.google.com/forum/#!msg/golang-nuts/rwpP0iF1AKE/5ZvWLNjSIJkJ\" rel=\"noreferrer\">golang-nuts</a> groups.</p>\n\n<p>You can turn off optimization and inlining in Go gc compilers for debugging.</p>\n\n<pre><code>-gcflags '-N -l'\n</code></pre>\n\n<ul>\n<li><code>-N</code> : Disable optimizations</li>\n<li><code>-l</code> :   Disable inlining</li>\n</ul>\n"}], "owner": {"reputation": 27031, "user_id": 1968972, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bfdd4ec8dff5c7635520fe98348524ec?s=128&d=identicon&r=PG", "display_name": "exebook", "link": "https://stackoverflow.com/users/1968972/exebook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15704, "favorite_count": 1, "answer_count": 1, "score": 13, "last_activity_date": 1524544175, "creation_date": 1499656014, "question_id": 45003259, "link": "https://stackoverflow.com/questions/45003259/passing-an-optimization-flag-to-a-go-compiler", "title": "Passing an optimization flag to a Go compiler?", "body": "<p>To compile a Go program you type <code>go build myprogram.go</code>, can you pass an optimization flags along or the code is always compiled in the same way? I am talking about speed optimizations, code size optimizations or other optimizations.</p>\n\n<p>I know if you use <code>gccgo</code> you just pass <code>-O2</code> or <code>-O0</code> but my question is about an official Go compiler <code>go</code>.</p>\n"}, {"tags": ["matrix", "go", "methods"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1499656199, "post_id": 45002436, "comment_id": 76980482, "body": "Could you possibly use <a href=\"http://godoc.org/robpike.io/ivy\" rel=\"nofollow noreferrer\">ivy</a>? <a href=\"https://www.youtube.com/watch?v=PXoG0WX0r_E\" rel=\"nofollow noreferrer\">(see video)</a>"}, {"owner": {"reputation": 76, "user_id": 6939342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e0c1ce31128b4b244c24d729dece39?s=128&d=identicon&r=PG&f=1", "display_name": "ngc5194", "link": "https://stackoverflow.com/users/6939342/ngc5194"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1499730568, "post_id": 45002436, "comment_id": 77020827, "body": "I hadn&#39;t heard of ivy, so I&#39;m glad you let me know about it, thanks.  However,  I think I&#39;d probably be better off with the &quot;ugly way&quot; than going with ivy, if for no other reason than it&#39;s probably easier for someone else to come up to speed on and maintain the code going forward."}], "owner": {"reputation": 76, "user_id": 6939342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e0c1ce31128b4b244c24d729dece39?s=128&d=identicon&r=PG&f=1", "display_name": "ngc5194", "link": "https://stackoverflow.com/users/6939342/ngc5194"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 290, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1499648129, "creation_date": 1499648129, "question_id": 45002436, "link": "https://stackoverflow.com/questions/45002436/how-to-solve-complex-matrix-equations-in-go-using-mat64", "title": "How to solve complex matrix equations in Go using mat64", "body": "<p>I'm doing matrix math in Go using mat64.  I have a matrix equation I want to solve, something like: (a * b + c) / (d - e) where a, b, c, d, and e are all matrices with real numbers as elements.</p>\n\n<p>mat64 implements matrix math functions as methods.  So, if you wanted to multiply matrix a by b, you'd do something like:</p>\n\n<pre><code>// Multiply a by b:\nnew := mat64.NewDense(x, y, nil)\nnew.Mul(a, b)\n</code></pre>\n\n<p>However, this method becomes unwieldy when you're looking at more complex equations with a whole bunch of steps such as my example above.</p>\n\n<p>So, is there any way to invoke these routines (or methods in Go in general) without using receivers, forcing me to create a boatload of temporary matrices in order to solve a more complex equation, or am I stuck doing this the ugly way?</p>\n"}, {"tags": ["go", "undeclared-identifier"], "comments": [{"owner": {"reputation": 14830, "user_id": 3757232, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/kLzML.jpg?s=128&g=1", "display_name": "Jared Smith", "link": "https://stackoverflow.com/users/3757232/jared-smith"}, "edited": false, "score": 0, "creation_date": 1499645142, "post_id": 45002130, "comment_id": 76978371, "body": "Why do you want to declare it at the top of the function? Generally most style guides for every c-ish language except JavaScript suggest declaring variables as close as possible to their point of use. Just say <code>var totalResults int = len(lines)</code>."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1499645220, "post_id": 45002130, "comment_id": 76978385, "body": "I can&#39;t reproduce this error."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1499645349, "post_id": 45002130, "comment_id": 76978409, "body": "In fact, the error I get with this code is that <code>totalResults</code> is declared and not used. Are you sure you&#39;re not misreading your error messages?"}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 8096201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lTPId.png?s=128&g=1", "display_name": "Nevercare", "link": "https://stackoverflow.com/users/8096201/nevercare"}, "is_accepted": true, "score": 0, "last_activity_date": 1499685277, "last_edit_date": 1499685277, "creation_date": 1499684421, "answer_id": 45010309, "question_id": 45002130, "link": "https://stackoverflow.com/questions/45002130/simple-integer-declaration-in-golang/45010309#45010309", "title": "Simple integer declaration in Golang", "body": "<p>change your code:</p>\n\n<pre><code>lines, err := reader.ReadAll()\nif err == io.EOF {\n    fmt.Println(\"Error:\", err)\n    return\n} else {\n\n}\n\n    totalResults=len(lines)\n\n}\n</code></pre>\n\n<p>to: </p>\n\n<pre><code>    lines, err := reader.ReadAll()\nif err == io.EOF {\n    totalResults=len(lines)\n} else {\n    fmt.Println(\"Error:\", err)\n    return\n}\n    fmt.Println(\"total results:\", totalResults)\n}\n</code></pre>\n"}], "owner": {"reputation": 1745, "user_id": 3888307, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65d6a22ea2fb9fb7a3d78bd57b9d71ea?s=128&d=identicon&r=PG&f=1", "display_name": "user3888307", "link": "https://stackoverflow.com/users/3888307/user3888307"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 45010309, "answer_count": 1, "score": -2, "last_activity_date": 1499685277, "creation_date": 1499644337, "last_edit_date": 1499645104, "question_id": 45002130, "link": "https://stackoverflow.com/questions/45002130/simple-integer-declaration-in-golang", "title": "Simple integer declaration in Golang", "body": "<p>I didn't consider myself to be a newbie, but I can't figure out why this very simple code snippet fails to declare my integer.</p>\n\n<pre><code>func main () {\n\n    var totalResults int\n\n    rFile, err := os.Open(\"users.csv\") //3 columns\n    if err != nil {\n        fmt.Println(\"Error:\", err)\n        return\n    }\n    defer rFile.Close()\n\n    // Creating csv reader\n    reader := csv.NewReader(rFile)\n\n    lines, err := reader.ReadAll()\n    if err == io.EOF {\n        fmt.Println(\"Error:\", err)\n        return\n    } else {\n\n    }\n\n    totalResults=len(lines)\n\n}\n</code></pre>\n\n<p>It always says the value is not declared, this seems too simple.</p>\n\n<p>I'm pretty sure it would work if I declared it using <code>:=</code>, but I wanted to declare everything at the top of the function.</p>\n"}, {"tags": ["c++", "google-app-engine", "caching", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1499645163, "post_id": 45002024, "comment_id": 76978378, "body": "The difference in compilation time for the two literals is negligible compared to everything else the compiler is doing. Write the code that&#39;s easiest to understand."}, {"owner": {"reputation": 3588, "user_id": 157541, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f71466071ebc4f8f582a0bb5c3efc1bf?s=128&d=identicon&r=PG", "display_name": "sissonb", "link": "https://stackoverflow.com/users/157541/sissonb"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1499645641, "post_id": 45002024, "comment_id": 76978465, "body": "@CeriseLim&#243;n The example is just to illustrate the question. Basically I want to know if the code is compiled every boot or if it&#39;s only compiled on the initial boot."}], "answers": [{"tags": [], "owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "is_accepted": true, "score": 1, "last_activity_date": 1499676584, "creation_date": 1499676584, "answer_id": 45007571, "question_id": 45002024, "link": "https://stackoverflow.com/questions/45002024/does-google-app-engine-cache-compiled-go-code-after-instance-sleeps/45007571#45007571", "title": "Does Google App Engine cache compiled go code after instance sleeps?", "body": "<p>The code is compiled only once, when you deploy the app. </p>\n\n<p>Quote from the The App Engine Standard Environment <a href=\"https://cloud.google.com/appengine/docs/standard/\" rel=\"nofollow noreferrer\">doc</a>:</p>\n\n<blockquote>\n  <p>Your app is automatically re-built on the server side whenever you upload new code, and if you are running the local development server the SDK automatically recompiles sources on-the-fly when you change them.</p>\n</blockquote>\n\n<p>Also, the Go Runtime Environment <a href=\"https://cloud.google.com/appengine/docs/standard/go/runtime\" rel=\"nofollow noreferrer\">doc</a> states:</p>\n\n<blockquote>\n  <p>And\u2014as with the Python SDK\u2014your app will be automatically re-built whenever you change the source.</p>\n</blockquote>\n\n<p>When an instance is started, app engine only loads and runs the executable binary. This fact doesn't seem to be mentioned in the documentation, but it's indicated by the following known <a href=\"https://issuetracker.google.com/issues/35892182\" rel=\"nofollow noreferrer\">issue</a>:</p>\n\n<blockquote>\n  <p>Request failed because the app binary was missing</p>\n</blockquote>\n"}], "owner": {"reputation": 3588, "user_id": 157541, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f71466071ebc4f8f582a0bb5c3efc1bf?s=128&d=identicon&r=PG", "display_name": "sissonb", "link": "https://stackoverflow.com/users/157541/sissonb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 45007571, "answer_count": 1, "score": 0, "last_activity_date": 1499676584, "creation_date": 1499643257, "last_edit_date": 1499643650, "question_id": 45002024, "link": "https://stackoverflow.com/questions/45002024/does-google-app-engine-cache-compiled-go-code-after-instance-sleeps", "title": "Does Google App Engine cache compiled go code after instance sleeps?", "body": "<p>Google App Engine will put <a href=\"https://cloud.google.com/appengine/docs/standard/go/how-instances-are-managed#scaling_dynamic_instances\" rel=\"nofollow noreferrer\">instances to sleep</a> in the Standard Environment, and boot them back up once a new request comes in. I am wondering if my Go code will be compiled again once the instance wakes up or if the compiled code is cached.</p>\n\n<p>If the compiled code is cached, then using the compiler to count the size of an array shouldn't have any impact on the boot time for an instance right?</p>\n\n<p>For instance, would </p>\n\n<pre><code>myCompilerCountedArray := [...]string{\"1\",\"2\",\"3\"}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>myUserCountedArray := [3]string{\"1\",\"2\",\"3\"}\n</code></pre>\n\n<p>have the same performance when an instance is started after going to sleep?</p>\n"}, {"tags": ["go", "go-templates", "go-gin"], "answers": [{"comments": [{"owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "edited": false, "score": 0, "creation_date": 1499673174, "post_id": 45002038, "comment_id": 76986491, "body": "On my server.go I have   <code>eng := gin.Default()</code>  <code>eng.LoadHTMLGlob(&quot;tmpl&#47;*&quot;) </code>   If I move the template from the project root directory to inside of server folder, it passes the test but fails when I try to run the program. No matter if I change the <code>eng.LoadHTMLGlob(&quot;tmpl&#47;*&quot;) </code> to <code>server&#47;tmpl&#47;*</code>"}, {"owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "edited": false, "score": 0, "creation_date": 1499673433, "post_id": 45002038, "comment_id": 76986623, "body": "Similar problem here: <a href=\"https://stackoverflow.com/questions/23847003/golang-tests-and-working-directory\" title=\"golang tests and working directory\">stackoverflow.com/questions/23847003/&hellip;</a>"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "edited": false, "score": 0, "creation_date": 1499673699, "post_id": 45002038, "comment_id": 76986781, "body": "Can you please update your directory structure in the question? Typically Go source file and test file resides in same directory. When you pass <code>tmpl&#47;*</code> this pattern, it means relative to current directory. I cannot say the SO post you shared related with your problem."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "edited": false, "score": 0, "creation_date": 1499674317, "post_id": 45002038, "comment_id": 76987141, "body": "As per your directory structure test will run correctly. I&#39;m updating answer further details."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "edited": false, "score": 0, "creation_date": 1499708107, "post_id": 45002038, "comment_id": 77010564, "body": "@AlessandroResta Did you get a chance to look at answer updates?"}, {"owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "edited": false, "score": 0, "creation_date": 1501510227, "post_id": 45002038, "comment_id": 77797152, "body": "didn&#39;t work =/  but I&#39;ve found a solution @ <a href=\"https://stackoverflow.com/questions/38320920/how-to-specify-path-of-template-for-app-engine-with-go-for-unit-testing\" title=\"how to specify path of template for app engine with go for unit testing\">stackoverflow.com/questions/38320920/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": false, "score": 0, "last_activity_date": 1499674832, "last_edit_date": 1499674832, "creation_date": 1499643354, "answer_id": 45002038, "question_id": 45001750, "link": "https://stackoverflow.com/questions/45001750/how-to-include-go-templates-when-unit-testing/45002038#45002038", "title": "How to include go templates when unit testing", "body": "<p><strong>EDIT:</strong> </p>\n\n<p>After comment interaction, updating answer match directory structure.</p>\n\n<pre><code>gin-test/\n\u251c\u2500\u2500 main.go\n\u2514\u2500\u2500 server\n    \u251c\u2500\u2500 server.go\n    \u251c\u2500\u2500 server_test.go\n    \u2514\u2500\u2500 tmpl\n        \u2514\u2500\u2500 index.tmpl\n</code></pre>\n\n<p>And your server.go file on function <code>serverEngine()</code> has-</p>\n\n<p><code>eng.LoadHTMLGlob(\"tmpl/*\")</code></p>\n\n<p><strong>First you're in root directory: i.e. <code>gin-test</code>, run-</strong></p>\n\n<pre><code># Output:\njeeva@mb-pro:~/go-home/src/gin-test$ go test ./...\n?       gin-test    [no test files]\nok      gin-test/server 0.046s\n</code></pre>\n\n<p><strong>Second you're in <code>gin-test/server</code> directory/package:</strong></p>\n\n<pre><code>jeeva@mb-pro:~/go-home/src/gin-test/server$ go test \n\n#Output:\nIt would produce the same output as below answer.\n</code></pre>\n\n<hr>\n\n<p>My best guess is 'problem could be your directory structure and files' and bit of test case code improvements.</p>\n\n<p><strong>I have just tried your code at my local with following directory structure:</strong></p>\n\n<pre><code>$GOPATH/src/gin-test/\n\u251c\u2500\u2500 server.go\n\u251c\u2500\u2500 server_test.go\n\u2514\u2500\u2500 tmpl\n    \u2514\u2500\u2500 index.tmpl\n</code></pre>\n\n<p><strong>Then, I have updated your <code>TestServe</code> method to following:</strong> </p>\n\n<p><em>Note: your test case works too, I just updated to demo the GET request and response.</em></p>\n\n<pre><code>func TestServe(t *testing.T) {\n    server := httptest.NewServer(serverEngine())\n    defer server.Close()\n\n    fmt.Println(\"Server URL:\", server.URL)\n\n    resp, err := http.Get(server.URL)\n    body, _ := ioutil.ReadAll(resp.Body)\n\n    fmt.Println(\"Error:\", err)\n    fmt.Println(\"Response:\", string(body))\n}\n</code></pre>\n\n<p><strong>Unit test output:</strong></p>\n\n<pre><code>jeeva@mb-pro:~/go-home/src/gin-test$ go test\n[GIN-debug] [WARNING] Running in \"debug\" mode. Switch to \"release\" mode in production.\n - using env:   export GIN_MODE=release\n - using code:  gin.SetMode(gin.ReleaseMode)\n\n[GIN-debug] Loaded HTML Templates (1):\n    - index.tmpl\n\n[GIN-debug] GET    /                         --&gt; gin-test.indexHandler (3 handlers)\nServer URL: http://127.0.0.1:56989\n[GIN] 2017/07/09 - 16:31:16 | 200 |     432.107\u00b5s | 127.0.0.1 |   GET     /\nError: &lt;nil&gt;\nResponse: &lt;b&gt;I'm here&lt;/b&gt;\nPASS\nok      gin-test    0.104s\njeeva@mb-pro:~/go-home/src/gin-test$\n</code></pre>\n\n<p>Happy coding! </p>\n"}], "owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1022, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499674832, "creation_date": 1499640366, "last_edit_date": 1499673795, "question_id": 45001750, "link": "https://stackoverflow.com/questions/45001750/how-to-include-go-templates-when-unit-testing", "title": "How to include go templates when unit testing", "body": "<p>I'm trying to test an implementation of a simple web server in Go using the <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow noreferrer\">Gin</a>.</p>\n\n<p>The service has a single endpoint rendering HTML.</p>\n\n<p><code>server.go</code></p>\n\n<pre><code>// Serve triggers the server initialization\nfunc Serve(addr string) {\n    if err := serverEngine().Run(addr); err != nil {\n        log.Fatalf(\"could not serve on %s: %s\", addr, err)\n    }\n}\n\nfunc serverEngine() *gin.Engine {\n    eng := gin.Default()\n\n    // Register resource handlers\n    eng.LoadHTMLGlob(\"tmpl/*\")\n    eng.GET(\"/\", indexHandler)\n    return eng\n}\n\nfunc indexHandler(c *gin.Context) {\n    c.HTML(http.StatusOK, \"index.tmpl\", gin.H{\n        \"title\": \"foo\",\n    })\n}\n</code></pre>\n\n<p><code>server_test.go</code></p>\n\n<pre><code>func TestServe(t *testing.T) {\n    timeOut := time.Duration(3) * time.Second\n    server := httptest.NewServer(serverEngine())\n    defer server.Close()\n\n    // fixes weird double ':' problem\n    port := server.URL[len(server.URL)-5:]\n\n    _, err := net.DialTimeout(\"tcp\", \"localhost:\"+port, timeOut)\n    if err != nil {\n        t.Errorf(\"failed to dial server: %s\", err)\n    }\n}\n</code></pre>\n\n<p>When I run the code everything works fine. But when running the unit tests it panics with the following message:</p>\n\n<pre><code>--- FAIL: TestServe (0.00s)\npanic: html/template: pattern matches no files: `tmpl/*` [recovered]\n    panic: html/template: pattern matches no files: `tmpl/*`\n</code></pre>\n\n<p>Project structure:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 main.go\n\u2514\u2500\u2500 server\n    \u251c\u2500\u2500 server.go\n    \u251c\u2500\u2500 server_test.go\n    \u2514\u2500\u2500 tmpl\n        \u2514\u2500\u2500 index.tmpl\n</code></pre>\n\n<p>How can I ensure that the <code>go test</code> know about the template location at runtime so I can perform this test?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 1, "creation_date": 1499643332, "post_id": 45001221, "comment_id": 76978079, "body": "You could simplify the checking if a file exists then opening logic by just using <code>os.OpenFile(name, O_RDWR|O_CREATE, 0666)</code> ( the file will be created if it doesn&#39;t exist implicitly)"}, {"owner": {"reputation": 7217, "user_id": 441923, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/aq9Ax.jpg?s=128&g=1", "display_name": "Belmin Fernandez", "link": "https://stackoverflow.com/users/441923/belmin-fernandez"}, "reply_to_user": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 0, "creation_date": 1499646499, "post_id": 45001221, "comment_id": 76978636, "body": "For ref, <a href=\"https://golang.org/pkg/os/#OpenFile\" rel=\"nofollow noreferrer\">documentation here</a>. +1 @AmmarBandukwala."}], "answers": [{"comments": [{"owner": {"reputation": 7217, "user_id": 441923, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/aq9Ax.jpg?s=128&g=1", "display_name": "Belmin Fernandez", "link": "https://stackoverflow.com/users/441923/belmin-fernandez"}, "edited": false, "score": 0, "creation_date": 1499639503, "post_id": 45001256, "comment_id": 76977367, "body": "I tried <code>var file *File</code> but needed to define that it came from the <code>os</code> package. Thanks; this makes total sense."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 2, "last_activity_date": 1499636484, "last_edit_date": 1499636484, "creation_date": 1499636149, "answer_id": 45001256, "question_id": 45001221, "link": "https://stackoverflow.com/questions/45001221/how-do-you-define-an-empty-variable-to-store-the-value-of-a-file-struct/45001256#45001256", "title": "How do you define an empty variable to store the value of a File struct?", "body": "<p>Defining variable is <code>var &lt;variable-name&gt; &lt;type&gt;</code>, learn more <a href=\"https://www.golang-book.com/books/intro/4\" rel=\"nofollow noreferrer\">about variables</a>.</p>\n\n<pre><code>var file *os.File\nvar err error\n</code></pre>\n\n<p>Your updated code:</p>\n\n<pre><code>func main() {\n  path := \"list.txt\"\n\n  var file *os.File\n  var err error\n\n  // Check if file exists\n  if err = os.Stat(path); os.IsNotExist(err) {\n    file, err = os.Create(path)\n  } else { // If file exists, open it\n    file, err = os.Open(path)\n  }\n\n  // Check errors opening and creating file\n  if err != nil {\n    log.Fatal(err)\n    return\n  }\n\n  // Defer closing file\n  defer file.Close()\n}\n</code></pre>\n"}], "owner": {"reputation": 7217, "user_id": 441923, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/aq9Ax.jpg?s=128&g=1", "display_name": "Belmin Fernandez", "link": "https://stackoverflow.com/users/441923/belmin-fernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1489, "favorite_count": 1, "accepted_answer_id": 45001256, "answer_count": 1, "score": 0, "last_activity_date": 1499639463, "creation_date": 1499635904, "last_edit_date": 1499639463, "question_id": 45001221, "link": "https://stackoverflow.com/questions/45001221/how-do-you-define-an-empty-variable-to-store-the-value-of-a-file-struct", "title": "How do you define an empty variable to store the value of a File struct?", "body": "<p>I am trying to figure out a way to declare an empty variable to store the return  values of <code>os.Create</code> and <code>os.Open</code>. Code:</p>\n\n<pre><code>func main() {\n\n  var path = \"list.txt\"\n  // Some attempts:\n  // var file File{}\n  // var file *File\n\n  // Check if file exists\n  var _, err = os.Stat(path)\n\n  // If new file, create it\n  if os.IsNotExist(err) {\n    var file, err = os.Create(path)\n\n    // If file exists, open it\n  } else {\n    var file, err = os.Open(path)\n  }\n\n  // Check errors opening and creating file\n  if err != nil {\n    log.Fatal(err)\n    return\n  }\n\n  // Defer closing file\n  defer file.Close()\n\n}\n</code></pre>\n\n<p>Both attempts result in the following error:</p>\n\n<blockquote>\n  <p>./main.go:13: undefined: File</p>\n</blockquote>\n\n<p>I'm sure this is one of those things that I don't know I don't know. What I do know:</p>\n\n<ul>\n<li>Per <code>os/file.go</code>, type of the return value I'm looking for is <code>*File</code></li>\n<li>That type is defined in <code>os/file_unix.go</code> as a struct</li>\n</ul>\n\n<p>Can someone explain to me:</p>\n\n<ol>\n<li>How do I create an empty variable that can then be used to store the first variable in the results of <code>os.Create</code> and <code>os.Open</code>.</li>\n<li>Why were my two attempts wrong?</li>\n<li>Anything else that I'm misunderstanding.</li>\n</ol>\n"}, {"tags": ["go", "type-conversion", "byte"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 7, "last_activity_date": 1499634971, "creation_date": 1499634971, "answer_id": 45001093, "question_id": 45000982, "link": "https://stackoverflow.com/questions/45000982/convert-3-bytes-to-int-in-go/45001093#45001093", "title": "Convert 3 bytes to int in go?", "body": "<p>Little endian:</p>\n\n<pre><code>n := int(uint(b[0]) | uint(b[1])&lt;&lt;8 | uint(b[2])&lt;&lt;16))\n</code></pre>\n\n<p>Big endian:</p>\n\n<pre><code>n := int(uint(b[2]) | uint(b[1])&lt;&lt;8 | uint(b[0])&lt;&lt;16))\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 2288107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1155e21866249b2b30acc9cf04e1dd12?s=128&d=identicon&r=PG", "display_name": "user2288107", "link": "https://stackoverflow.com/users/2288107/user2288107"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2095, "favorite_count": 0, "accepted_answer_id": 45001093, "answer_count": 1, "score": 0, "last_activity_date": 1499634971, "creation_date": 1499634084, "question_id": 45000982, "link": "https://stackoverflow.com/questions/45000982/convert-3-bytes-to-int-in-go", "title": "Convert 3 bytes to int in go?", "body": "<p>I know how to use \"encoding/binary\" to convert 4 bytes to an int, etc.</p>\n\n<p>What is the most efficient way to convert just 3 bytes to an int?</p>\n"}, {"tags": ["string", "go", "slice"], "comments": [{"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1499627747, "post_id": 44999853, "comment_id": 76974028, "body": "(Note the <code>%q</code> in the screen dump, and refer to the reference <a href=\"https://godoc.org/fmt\" rel=\"nofollow noreferrer\">(godoc.org?)</a> for <code>fmt.Printf()</code>.)"}, {"owner": {"reputation": 13, "user_id": 8280221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f77510eb8012f4bd3413c1b0b578ff?s=128&d=identicon&r=PG&f=1", "display_name": "gotosystem", "link": "https://stackoverflow.com/users/8280221/gotosystem"}, "reply_to_user": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1499628019, "post_id": 44999853, "comment_id": 76974110, "body": "@greybeard Yes, I saw these characters, but in my code they are missing"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1499628275, "post_id": 44999853, "comment_id": 76974209, "body": "Can you please clarify your question? what do you mean by <code>I do not understand how to apply append here</code>. <code>Split</code> func returns the slice."}, {"owner": {"reputation": 13, "user_id": 8280221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f77510eb8012f4bd3413c1b0b578ff?s=128&d=identicon&r=PG&f=1", "display_name": "gotosystem", "link": "https://stackoverflow.com/users/8280221/gotosystem"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1499628579, "post_id": 44999853, "comment_id": 76974323, "body": "@jeevatkm  Thank you! I edited my question"}], "answers": [{"tags": [], "owner": {"reputation": 3158, "user_id": 7925197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M21lU.png?s=128&g=1", "display_name": "papey", "link": "https://stackoverflow.com/users/7925197/papey"}, "is_accepted": true, "score": 0, "last_activity_date": 1499628605, "creation_date": 1499628605, "answer_id": 45000214, "question_id": 44999853, "link": "https://stackoverflow.com/questions/44999853/how-to-write-the-result-of-a-function-in-a-slice/45000214#45000214", "title": "How to write the result of a function in a slice", "body": "<p>Give to printf the expected format, in most cases, <code>%v</code> is fine.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    str := \"fulltext\"\n    var slice []string\n    slice = strings.Split(str, \"\")\n\n    fmt.Printf(\"anwer: %v\", slice)\n}\n</code></pre>\n\n<p>see <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/fmt/</a> for more info.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1499629145, "last_edit_date": 1499629145, "creation_date": 1499628617, "answer_id": 45000216, "question_id": 44999853, "link": "https://stackoverflow.com/questions/44999853/how-to-write-the-result-of-a-function-in-a-slice/45000216#45000216", "title": "How to write the result of a function in a slice", "body": "<p>The problem is not with the assignment of the return value of <code>strings.Split()</code> to the local variable <code>slice</code>, which is totally fine.</p>\n\n<p>The problem is that you used <a href=\"https://golang.org/pkg/fmt/#Printf\" rel=\"nofollow noreferrer\"><code>fmt.Printf()</code></a> which expects a format string, and based on that format string it formats / substitutes expected parameters. Since your format string does not contain any verbs, that <code>fmt.Printf()</code> call expects no parameters, yet you pass it one, so it signals this with those extra characters (kind of error string).</p>\n\n<p>Provide a valid format string where you indicate you will supply 1 parameter, a slice:</p>\n\n<pre><code>fmt.Printf(\"answer: %v\", slice)\n</code></pre>\n\n<p>With this, the output is:</p>\n\n<pre><code>answer: [f u l l t e x t]\n</code></pre>\n\n<p>Or alternatively use <a href=\"https://golang.org/pkg/fmt/#Println\" rel=\"nofollow noreferrer\"><code>fmt.Println()</code></a>, which does not expect a format string:</p>\n\n<pre><code>fmt.Println(\"answer:\", slice)\n</code></pre>\n\n<p>(Note that there is no space after the colon, as <code>fmt.Println()</code> adds a space between 2 values if one of them is of type <code>string</code>).</p>\n\n<p>Output is the same. Try the examples on the <a href=\"https://play.golang.org/p/CoetMQfDpE\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>Staying with <code>fmt.Printf()</code>, when the parameter involves <code>string</code> values, the <code>%q</code> verb is often more useful, as that will print quoted string values, much easier to spot certain mistakes (e.g. invisible characters, or if a <code>string</code> contains spaces, it will become obvious):</p>\n\n<pre><code>fmt.Printf(\"answer: %q\\n\", slice)\n</code></pre>\n\n<p>Output of this (try it on the <a href=\"https://play.golang.org/p/EoFIjCPMfm\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>answer: [\"f\" \"u\" \"l\" \"l\" \"t\" \"e\" \"x\" \"t\"]\n</code></pre>\n\n<p>If you'd wanted to append the result of a function call, this is how it could look like:</p>\n\n<pre><code>slice := []string{\"initial\", \"content\"}\nslice = append(slice, strings.Split(str, \"\")...)\n\nfmt.Printf(\"answer: %q\\n\", slice)\n</code></pre>\n\n<p>And now the output (try it on the <a href=\"https://play.golang.org/p/mul1SfLuLY\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>answer: [\"initial\" \"content\" \"f\" \"u\" \"l\" \"l\" \"t\" \"e\" \"x\" \"t\"]\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8280221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f77510eb8012f4bd3413c1b0b578ff?s=128&d=identicon&r=PG&f=1", "display_name": "gotosystem", "link": "https://stackoverflow.com/users/8280221/gotosystem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 45000214, "answer_count": 2, "score": 1, "last_activity_date": 1499629217, "creation_date": 1499626205, "last_edit_date": 1499629217, "question_id": 44999853, "link": "https://stackoverflow.com/questions/44999853/how-to-write-the-result-of-a-function-in-a-slice", "title": "How to write the result of a function in a slice", "body": "<p>In the example, everything works fine. But they do not use the variable a and immediately display it <a href=\"https://play.golang.org/p/O0XwtQJRej\" rel=\"nofollow noreferrer\">https://play.golang.org/p/O0XwtQJRej</a></p>\n\n<p>But I have a problem:</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    str := \"fulltext\"\n    var slice []string\n    slice = strings.Split(str , \"\")\n\n    fmt.Printf(\"anwer: \", slice)\n}\n</code></pre>\n\n<p>Whence in the answer there are superfluous characters, for example </p>\n\n<blockquote>\n  <p>%! (EXTRA [] string =</p>\n</blockquote>\n\n<p>P.S. I know that I need to use append to add elements to the slice, but now I do not understand how to apply append here.</p>\n\n<p>UP:\nNow I have the answer:</p>\n\n<blockquote>\n  <p>anwer: %!(EXTRA []string=[f u l l t e x t])</p>\n</blockquote>\n\n<p>But I need just:</p>\n\n<blockquote>\n  <p>[f u l l t e x t]</p>\n</blockquote>\n\n<p>But I do not understand how I should change my code?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 71, "user_id": 8216026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d266a2300393caae799c8436495e2f0b?s=128&d=identicon&r=PG&f=1", "display_name": "goflow", "link": "https://stackoverflow.com/users/8216026/goflow"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1499621257, "post_id": 44998942, "comment_id": 76972155, "body": "@icza It seems, but no. He says how to print all the characters and their positions, I do not understand how to enter a position and get a symbol."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1499621621, "post_id": 44998942, "comment_id": 76972282, "body": "Based on the other answer you have all position-symbol pairs.  You can&#39;t choose a specific pair from this given the position?"}, {"owner": {"reputation": 71, "user_id": 8216026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d266a2300393caae799c8436495e2f0b?s=128&d=identicon&r=PG&f=1", "display_name": "goflow", "link": "https://stackoverflow.com/users/8216026/goflow"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1499622072, "post_id": 44998942, "comment_id": 76972419, "body": "@icza Can I do this task without a loop?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1499622266, "post_id": 44998942, "comment_id": 76972480, "body": "You can, if  you convert it to a <code>[]rune</code> first and index that. But a <code>for</code> loop is more efficient."}, {"owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "edited": false, "score": 0, "creation_date": 1500455125, "post_id": 44998942, "comment_id": 77339239, "body": "This question is not an exact duplicate."}], "owner": {"reputation": 71, "user_id": 8216026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d266a2300393caae799c8436495e2f0b?s=128&d=identicon&r=PG&f=1", "display_name": "goflow", "link": "https://stackoverflow.com/users/8216026/goflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "closed_date": 1499622138, "answer_count": 0, "score": 0, "last_activity_date": 1499622215, "creation_date": 1499620062, "question_id": 44998942, "link": "https://stackoverflow.com/questions/44998942/get-letter-by-position", "closed_reason": "Duplicate", "title": "Get letter by position", "body": "<p>I read the article <a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">https://blog.golang.org/strings</a> and realized that you can only determine the letter by position number using package \"unicode/utf8\" (maybe I'm wrong). I looked at all the functions of the package, but I did not understand how to do it?\nI need (pseudocode):</p>\n\n<pre><code>var word := \"golang\"\nvar letter := word[3] // letter a\n</code></pre>\n"}, {"tags": ["string", "go", "type-conversion", "slice"], "answers": [{"comments": [{"owner": {"reputation": 2895, "user_id": 348719, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb180bc6dd7e72a35a27319fcd7e6fda?s=128&d=identicon&r=PG&f=1", "display_name": "sgon00", "link": "https://stackoverflow.com/users/348719/sgon00"}, "edited": false, "score": 0, "creation_date": 1499614244, "post_id": 44997821, "comment_id": 76969977, "body": "Got it. Thanks a lot. So it&#39;s all due to the spec."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1499616549, "last_edit_date": 1499616549, "creation_date": 1499612699, "answer_id": 44997821, "question_id": 44997314, "link": "https://stackoverflow.com/questions/44997314/in-golang-why-does-a-int32hello-work-but-not-a-inthello/44997821#44997821", "title": "In golang, why does `a := []int32(&quot;hello&quot;)` work but not `a := []int(&quot;hello&quot;)`?", "body": "<p>Because the spec allows converting a <code>string</code> value to a <code>rune</code> slice (<code>[]rune</code>), and <code>rune</code> is an <a href=\"https://golang.org/ref/spec#Numeric_types\" rel=\"nofollow noreferrer\">alias</a> to <code>int32</code> (they are one and the same). This is what the first <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">conversion</a>\n does:</p>\n\n<blockquote>\n  <p>Converting a value of a string type to a slice of runes type yields a slice containing the individual Unicode code points of the string.</p>\n</blockquote>\n\n<p>Basically a <code>string</code> => <code>[]rune</code> conversion decodes the UTF-8 bytes of the text (this is how Go stores strings in memory) to Unicode code points (<code>rune</code>s).</p>\n\n<p>And the spec does not allow converting a <code>string</code> to an <code>int</code> slice, so the second is a compile-time error.</p>\n"}], "owner": {"reputation": 2895, "user_id": 348719, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb180bc6dd7e72a35a27319fcd7e6fda?s=128&d=identicon&r=PG&f=1", "display_name": "sgon00", "link": "https://stackoverflow.com/users/348719/sgon00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 44997821, "answer_count": 1, "score": 2, "last_activity_date": 1499629775, "creation_date": 1499609684, "last_edit_date": 1499629775, "question_id": 44997314, "link": "https://stackoverflow.com/questions/44997314/in-golang-why-does-a-int32hello-work-but-not-a-inthello", "title": "In golang, why does `a := []int32(&quot;hello&quot;)` work but not `a := []int(&quot;hello&quot;)`?", "body": "<p>The tile is my question. In Go, why does <code>a := []int32(\"hello\")</code> work but not <code>a := []int(\"hello\")</code>?</p>\n"}, {"tags": ["go", "lora", "lorawan"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6692618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a668f008f1c068b314ed9a5e18ceb06b?s=128&d=identicon&r=PG&f=1", "display_name": "Ignacio G&#243;mez", "link": "https://stackoverflow.com/users/6692618/ignacio-g%c3%b3mez"}, "is_accepted": false, "score": 1, "last_activity_date": 1499781153, "creation_date": 1499781153, "answer_id": 45036525, "question_id": 44997059, "link": "https://stackoverflow.com/questions/44997059/how-to-receive-data-from-lora-app-server/45036525#45036525", "title": "How to receive data from LoRa App server?", "body": "<p>You need to implement a MQTT client (or user a command-line one, like mosquitto_sub, as suggested in <a href=\"https://docs.loraserver.io/lora-app-server/integrate/data/\" rel=\"nofollow noreferrer\">https://docs.loraserver.io/lora-app-server/integrate/data/</a>) and then subscribe to the receiving topic for the specified node. The image you posted is not an interface but an example message a node will send through the topic. For the case given, appID is \"123\" and devEUI is \"0202020202020202\", so you need to subscribe to the following topic to get messages from the node:</p>\n\n<p>application/123/node/0202020202020202/rx</p>\n\n<p>As said, you may consume the messages through a MQTT client (there are plenty of clients for different languages), or from the command line.</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 7043623, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TZnQeHbM17Q/AAAAAAAAAAI/AAAAAAAAABQ/ogKt5c2Te2Q/photo.jpg?sz=128", "display_name": "Alexandre Pelagaggi", "link": "https://stackoverflow.com/users/7043623/alexandre-pelagaggi"}, "is_accepted": false, "score": 0, "last_activity_date": 1559577343, "creation_date": 1559577343, "answer_id": 56430767, "question_id": 44997059, "link": "https://stackoverflow.com/questions/44997059/how-to-receive-data-from-lora-app-server/56430767#56430767", "title": "How to receive data from LoRa App server?", "body": "<p>Just updating from current versions.</p>\n\n<p>Global integrations\nGlobal integrations are configured through the lora-app-server.toml configuration file and are globally enabled. This means that for every application configured, the application will be published using this / these integration(s).</p>\n\n<p>The following integrations are available:</p>\n\n<p>MQTT\nAWS Simple Notification Service\nAzure Service Bus\nGoogle Cloud Platform Pub/Sub\nApplication integrations\nAdditional to the globally enabled integrations, it is also possible to set up integrations per application.</p>\n\n<p>The following integrations are available:</p>\n\n<p>HTTP\nInfluxDB</p>\n\n<p>From: <a href=\"https://www.loraserver.io/lora-app-server/integrate/sending-receiving/\" rel=\"nofollow noreferrer\">loraserver.io</a></p>\n"}], "owner": {"reputation": 11, "user_id": 6940320, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E0K78Ls27FY/AAAAAAAAAAI/AAAAAAAAABs/B3RieRJioek/photo.jpg?sz=128", "display_name": "\u8463\u67cf\u987a", "link": "https://stackoverflow.com/users/6940320/%e8%91%a3%e6%9f%8f%e9%a1%ba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1147, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1559577343, "creation_date": 1499607811, "question_id": 44997059, "link": "https://stackoverflow.com/questions/44997059/how-to-receive-data-from-lora-app-server", "title": "How to receive data from LoRa App server?", "body": "<p>I collect data from the LoRa node, and then gateway forward to lora server, at last, the data to the lora app server. but i cannot find the following interface.\n(<a href=\"https://docs.loraserver.io/lora-app-server/integrate/data/\" rel=\"nofollow noreferrer\">https://docs.loraserver.io/lora-app-server/integrate/data/</a>)\n<a href=\"https://i.stack.imgur.com/tAQMf.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 7660, "user_id": 2350684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yuQa5.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/2350684/oliver"}, "is_accepted": false, "score": 1, "last_activity_date": 1499607919, "creation_date": 1499607919, "answer_id": 44997073, "question_id": 44997022, "link": "https://stackoverflow.com/questions/44997022/how-to-convert-timestamp-locally-according-to-our-location/44997073#44997073", "title": "How to convert timestamp locally according to our location", "body": "<p>You can use <code>(t Time) In()</code> (<a href=\"https://golang.org/pkg/time/#Time.In\" rel=\"nofollow noreferrer\">Golang documentation</a>) to convert <code>startTime</code> to use your local timezone.</p>\n"}, {"tags": [], "owner": {"reputation": 2339, "user_id": 3081558, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9ritS.jpg?s=128&g=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/3081558/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1500005865, "creation_date": 1500005865, "answer_id": 45094527, "question_id": 44997022, "link": "https://stackoverflow.com/questions/44997022/how-to-convert-timestamp-locally-according-to-our-location/45094527#45094527", "title": "How to convert timestamp locally according to our location", "body": "<p>Please check the Local function for time structs: <a href=\"https://golang.org/pkg/time/#Time.Local\" rel=\"nofollow noreferrer\">https://golang.org/pkg/time/#Time.Local</a></p>\n\n<pre><code>package main\nimport (\n\"fmt\"\n\"time\"\n)\nfunc main() {\n    startTime := time.Now()\n    fmt.Println(startTime.Local())\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 6817108, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1dc3af3e550437628d0a83b662895461?s=128&d=identicon&r=PG&f=1", "display_name": "ASWATHY", "link": "https://stackoverflow.com/users/6817108/aswathy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1500005865, "creation_date": 1499607545, "last_edit_date": 1499629863, "question_id": 44997022, "link": "https://stackoverflow.com/questions/44997022/how-to-convert-timestamp-locally-according-to-our-location", "title": "How to convert timestamp locally according to our location", "body": "<pre><code>startTime := time.Unix(logUserDetail[k].LogTime, 0)\nstartTimeOfLog := startTime.String()[11:16]\n</code></pre>\n\n<p>I have time in timestamp format and it is in UTC time zone. I want to convert this time to the local timezone according to our location.</p>\n\n<p>logUserDetail[k].LogTime is in timestamp(1499335473)</p>\n"}, {"tags": ["go", "biginteger", "bigint"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1499612304, "creation_date": 1499612304, "answer_id": 44997747, "question_id": 44996955, "link": "https://stackoverflow.com/questions/44996955/working-with-bitstrings-and-big-int-in-go/44997747#44997747", "title": "Working with bitstrings and big.Int in Go", "body": "<p>Yes, you may use the <a href=\"https://golang.org/pkg/math/big/#Int\" rel=\"nofollow noreferrer\"><code>big.Int</code></a> type, and its <a href=\"https://golang.org/pkg/math/big/#Int.SetString\" rel=\"nofollow noreferrer\"><code>Int.SetString()</code></a> method, passing 2 as the base.</p>\n\n<p>Example:</p>\n\n<pre><code>i := big.NewInt(0)\nif _, ok := i.SetString(\"10101010101010101010101010101010101010101010101010101010101010101010101010\", 2); !ok {\n    fmt.Println(\"Invalid number!\")\n} else {\n    fmt.Println(i)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/c1HWMQl7fx\" rel=\"nofollow noreferrer\">Go playground</a>):</p>\n\n<pre><code>12592977287652387236522\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user277465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1499612304, "creation_date": 1499607086, "question_id": 44996955, "link": "https://stackoverflow.com/questions/44996955/working-with-bitstrings-and-big-int-in-go", "title": "Working with bitstrings and big.Int in Go", "body": "<p>I'm new to Go and I'm working on a few exercises to get up to speed. How can I convert a string representing a sequence of bits to the appropriate datatype in Go?</p>\n\n<p>For eg, I see that if its a bitstring representing a 64-bit number, I can do :-</p>\n\n<pre><code>val, err := strconv.ParseInt(bitstring, 2, 64)\n</code></pre>\n\n<p>However, if the bitstring represents a larger number(say 1024 or 2048 bits), how can I go about converting that number to the appropriate type in Go? I believe the type for managing big integers in Go is big.Int.</p>\n"}, {"tags": ["google-app-engine", "go", "glide-golang"], "comments": [{"owner": {"reputation": 1763, "user_id": 764307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f5625275c22d373b7fc41c6d4d6af8f?s=128&d=identicon&r=PG", "display_name": "Jonathan B.", "link": "https://stackoverflow.com/users/764307/jonathan-b"}, "edited": false, "score": 0, "creation_date": 1517709497, "post_id": 44996818, "comment_id": 84204580, "body": "Matt, did you ever get a sane solution to this problem?"}], "answers": [{"tags": [], "owner": {"reputation": 924, "user_id": 4199833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9tBnh.png?s=128&g=1", "display_name": "rudolph1024", "link": "https://stackoverflow.com/users/4199833/rudolph1024"}, "is_accepted": false, "score": 0, "last_activity_date": 1522983407, "last_edit_date": 1522983407, "creation_date": 1518463822, "answer_id": 48754119, "question_id": 44996818, "link": "https://stackoverflow.com/questions/44996818/is-it-possible-to-use-go-vendor-libraries-with-google-app-engine/48754119#48754119", "title": "Is it possible to use Go vendor libraries with Google App Engine?", "body": "<p>You can address this by using your <code>$GOPATH</code> variable. Note that your <code>$GOPATH</code> environment variable can actually be a list of multiple places (see <a href=\"https://golang.org/cmd/go/#hdr-GOPATH_environment_variable\" rel=\"nofollow noreferrer\">https://golang.org/cmd/go/#hdr-GOPATH_environment_variable</a> for more):</p>\n\n<blockquote>\n  <p>The GOPATH environment variable lists places to look for Go code. On\n  Unix, the value is a colon-separated string. On Windows, the value is\n  a semicolon-separated string. On Plan 9, the value is a list.</p>\n</blockquote>\n\n<p>Rather than moving the github.com directory from vendor to src, you could write a script which temporarily adds the <code>vendor/github.com</code> directory to your <code>$GOPATH</code> environment variable, performs the deployment, and then removes it from the environment variable. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5157307, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0W8WvVRrvqA/AAAAAAAAAAI/AAAAAAAAAN8/KzUvZv09aFs/photo.jpg?sz=128", "display_name": "Steven Lee", "link": "https://stackoverflow.com/users/5157307/steven-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1534421959, "creation_date": 1534421959, "answer_id": 51876925, "question_id": 44996818, "link": "https://stackoverflow.com/questions/44996818/is-it-possible-to-use-go-vendor-libraries-with-google-app-engine/51876925#51876925", "title": "Is it possible to use Go vendor libraries with Google App Engine?", "body": "<p>Following from the answer by rudolph1024 one method I use to push projects to app engine standard is to add a few lines in the make file. The most simple example being:</p>\n\n<pre><code>GOPATH=./vendor gcloud app deploy\n</code></pre>\n\n<p>This has the bonus of allowing you to use the go community standard repo layout from <a href=\"https://github.com/golang-standards/project-layout\" rel=\"nofollow noreferrer\">here</a> instead of the google one <a href=\"https://cloud.google.com/appengine/docs/standard/go/runtime#Go_Organizing_Go_apps\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>app engine standard likes the app.yaml to be in the root directory and all go files under it will be used. So you can do something like</p>\n\n<pre><code>cp -r cmd/ ../../cmd  &amp;&amp; cd ../../cmd &amp;&amp; GOPATH=./vendor gcloud app deploy \n</code></pre>\n\n<p>There are many ways to clean this up but this works and gives a general idea on the methodology.</p>\n"}], "owner": {"reputation": 81, "user_id": 5239251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d6109e7e69fff0010668fdfe109f75?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5239251/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 692, "favorite_count": 3, "answer_count": 2, "score": 8, "last_activity_date": 1534421959, "creation_date": 1499606126, "question_id": 44996818, "link": "https://stackoverflow.com/questions/44996818/is-it-possible-to-use-go-vendor-libraries-with-google-app-engine", "title": "Is it possible to use Go vendor libraries with Google App Engine?", "body": "<p>I'm trying to deploy a small test app to Google App Engine (standard). I get an error if I include any vendor libraries.</p>\n\n<p>This is the error I get when trying to deploy</p>\n\n<pre><code>% gcloud app deploy\nServices to deploy:\n\ndescriptor:      [/Users/matt/work/appenginetest1/src/hello/default/app.yaml]\nsource:          [/Users/matt/work/appenginetest1/src/hello/default]\ntarget project:  REDACTED\ntarget service:  [default]\ntarget version:  [20170709t220721]\ntarget url:      REDACTED\n\n\nDo you want to continue (Y/n)?  y\n\nBeginning deployment of service [default]...\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2560\u2550 Uploading 0 files to Google Cloud Storage                \u2550\u2563\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\nFile upload done.\nUpdating service [default]...failed.\nERROR: (gcloud.app.deploy) Error Response: [9] Deployment contains files that cannot be compiled: Compile failed:\ngo-app-builder: build timing: 2\u00d7compile (210ms total), 0\u00d7link (0s total)\ngo-app-builder: failed running compile: exit status 2\n\nmain.go:6: can't find import: \"github.com/julienschmidt/httprouter\"\n</code></pre>\n\n<p>For some context, this is the tree of $GOPATH</p>\n\n<pre><code>% tree $GOPATH\n/Users/matt/work/appenginetest1\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 hello\n        \u251c\u2500\u2500 default\n        \u2502\u00a0\u00a0 \u251c\u2500\u2500 app.yaml\n        \u2502\u00a0\u00a0 \u2514\u2500\u2500 main.go\n        \u251c\u2500\u2500 glide.lock\n        \u251c\u2500\u2500 glide.yaml\n        \u2514\u2500\u2500 vendor\n            \u2514\u2500\u2500 github.com\n                \u2514\u2500\u2500 julienschmidt\n                    \u2514\u2500\u2500 httprouter\n                        \u251c\u2500\u2500 path.go\n                        \u251c\u2500\u2500 router.go\n                        \u2514\u2500\u2500 tree.go\n</code></pre>\n\n<p>Running the local server via dev_appserver.py works fine. It doesn't look like a case of app engine not finding the vendor directory as after running</p>\n\n<pre><code>% rm -rf ~/work/appenginetest1/src/hello/vendor/github.com\n</code></pre>\n\n<p>It errors before even pushing to the cloud</p>\n\n<pre><code>% gcloud app deploy\nERROR: (gcloud.app.deploy) Staging command [/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/platform/google_appengine/goroot-1.6/bin/go-app-stager /Users/matt/work/appenginetest1/src/hello/default/app.yaml /var/folders/nx/8w2_6q551cl50h3ff6lmy9s40000gn/T/tmp97Kiis/tmpe0MHQ0] failed with return code [1].\n\n------------------------------------ STDOUT ------------------------------------\n------------------------------------ STDERR ------------------------------------\n2017/07/09 22:12:52 failed analyzing /Users/matt/work/appenginetest1/src/hello/default: cannot find package \"github.com/julienschmidt/httprouter\" in any of:\n    /Users/matt/work/appenginetest1/src/hello/vendor/github.com/julienschmidt/httprouter (vendor tree)\n    ($GOROOT not set)\n    /Users/matt/work/appenginetest1/src/github.com/julienschmidt/httprouter (from $GOPATH)\nGOPATH: /Users/matt/work/appenginetest1\n--------------------------------------------------------------------------------\n</code></pre>\n\n<p>If I move the github.com directory from vendor to src, the deploy works without an issue.</p>\n\n<p>app.yaml</p>\n\n<pre><code>service: default\nruntime: go\napi_version: go1\n\n\nhandlers:\n- url: /.*\n  script: _go_app\n</code></pre>\n\n<p>main.go</p>\n\n<pre><code>package hello\n\nimport (\n  \"fmt\"\n  \"net/http\"\n  \"github.com/julienschmidt/httprouter\"\n)\n\nfunc init() {\n  router := httprouter.New()\n  router.GET(\"/hello/:name\", Hello)\n  http.Handle(\"/\", router)\n}\n\nfunc Hello(w http.ResponseWriter, r *http.Request, ps httprouter.Params) {\n  fmt.Fprintf(w, \"Hello, %s!\", ps.ByName(\"name\"))\n}\n</code></pre>\n\n<p>I can get this project to deploy if I move the github.com directory from vendor to src after running glide install.</p>\n"}, {"tags": ["curl", "docker", "go", "gorilla"], "comments": [{"owner": {"reputation": 23608, "user_id": 2915097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91318014af3b3d389901d50d5f9276d5?s=128&d=identicon&r=PG&f=1", "display_name": "user2915097", "link": "https://stackoverflow.com/users/2915097/user2915097"}, "edited": false, "score": 0, "creation_date": 1499602365, "post_id": 44996153, "comment_id": 76966445, "body": "alpine does not come with a SSH server installed and configured, you should use <code>docker exec</code> see the doc <a href=\"https://docs.docker.com/engine/reference/commandline/exec/\" rel=\"nofollow noreferrer\">docs.docker.com/engine/reference/commandline/exec</a>"}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 1482115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qsYlV.jpg?s=128&g=1", "display_name": "Chaitanya Munukutla", "link": "https://stackoverflow.com/users/1482115/chaitanya-munukutla"}, "is_accepted": false, "score": 1, "last_activity_date": 1499602167, "creation_date": 1499602167, "answer_id": 44996242, "question_id": 44996153, "link": "https://stackoverflow.com/questions/44996153/golang-webserver-cant-be-accessed-from-docker/44996242#44996242", "title": "Golang Webserver can&#39;t be accessed from Docker", "body": "<p>I solved it by exposing the server at <code>0.0.0.0</code> instead of <code>localhost</code></p>\n\n<p>The problem is that I've told my webserver to only serve requests sent to localhost. Because of the network mangling that Docker does, none of the traffic showing up to your webserver look to the webserver as though they were sent to <code>localhost</code>. By telling the webserver to listen on <code>0.0.0.0</code>, I'm effectively telling it that it doesn't care where the traffic was originally sent and it will accept it all.</p>\n"}], "owner": {"reputation": 73, "user_id": 1482115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qsYlV.jpg?s=128&g=1", "display_name": "Chaitanya Munukutla", "link": "https://stackoverflow.com/users/1482115/chaitanya-munukutla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499602167, "creation_date": 1499601498, "question_id": 44996153, "link": "https://stackoverflow.com/questions/44996153/golang-webserver-cant-be-accessed-from-docker", "title": "Golang Webserver can&#39;t be accessed from Docker", "body": "<p>I am using the Gorilla framework in Go to expose a webservice. I have a \"Hello World\" endpoint at <code>/hello</code> which works fine when hit from Postman, browser or <code>curl</code>.</p>\n\n<p>The problem arises when I bundle it with Docker. My Dockerfile is as below</p>\n\n<pre><code>FROM alpine\nCOPY ./target/himer-users-go /app\nENV PORT 9000\nRUN echo $PORT\nENTRYPOINT /app\nEXPOSE ${PORT}\n</code></pre>\n\n<p>Now I can <code>ssh</code> into the container and ping the server using <code>wget</code> (since <code>alpine</code> doesn't come bundled with <code>curl</code>)</p>\n\n<p>But when I run the image like</p>\n\n<pre><code>docker run -d -p 9000:9000 namespace/image\n</code></pre>\n\n<p>I can't access the server in any way from my host system. </p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 4, "last_activity_date": 1499594872, "creation_date": 1499594872, "answer_id": 44995253, "question_id": 44995221, "link": "https://stackoverflow.com/questions/44995221/how-to-include-cc-and-bcc-in-email-using-go/44995253#44995253", "title": "how to include CC and BCC in email using Go", "body": "<p>That depends on which mail library you're using.  But the short version is:  Just add the <code>Cc:</code> and <code>Bcc:</code> headers as usual, same as you do for any other header, such as <code>Subject:</code> or <code>To:</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 7107207, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-NmTvRpQ5e6Q/AAAAAAAAAAI/AAAAAAAACdU/vfThANl1xFI/photo.jpg?sz=128", "display_name": "carlo suarez", "link": "https://stackoverflow.com/users/7107207/carlo-suarez"}, "is_accepted": false, "score": 1, "last_activity_date": 1499642727, "creation_date": 1499642727, "answer_id": 45001970, "question_id": 44995221, "link": "https://stackoverflow.com/questions/44995221/how-to-include-cc-and-bcc-in-email-using-go/45001970#45001970", "title": "how to include CC and BCC in email using Go", "body": "<p>I used this library for cc, bcc. It has more features too.</p>\n\n<p>Here's the link</p>\n\n<p><a href=\"https://github.com/jordan-wright/email\" rel=\"nofollow noreferrer\">https://github.com/jordan-wright/email</a></p>\n"}], "owner": {"reputation": 55, "user_id": 7107207, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-NmTvRpQ5e6Q/AAAAAAAAAAI/AAAAAAAACdU/vfThANl1xFI/photo.jpg?sz=128", "display_name": "carlo suarez", "link": "https://stackoverflow.com/users/7107207/carlo-suarez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1422, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499642727, "creation_date": 1499594651, "question_id": 44995221, "link": "https://stackoverflow.com/questions/44995221/how-to-include-cc-and-bcc-in-email-using-go", "title": "how to include CC and BCC in email using Go", "body": "<p>How to add CC and BCC on my email function in Go.</p>\n\n<p>Here is my code</p>\n\n<pre><code>err := smtp.SendMail(\n \"smtp.zoho.com\",\n 587,\n config.Email_id,\n config.Email_password,\n []string{email_to},\n</code></pre>\n"}, {"tags": ["go", "bson"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1499585982, "post_id": 44992835, "comment_id": 76962543, "body": "According to your answer, this question is wrong: You&#39;re not decoding JSON at all, rather BSON."}], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": false, "score": 1, "last_activity_date": 1499573479, "creation_date": 1499573479, "answer_id": 44992896, "question_id": 44992835, "link": "https://stackoverflow.com/questions/44992835/golang-decode-a-bson-with-special-character-keys-to-a-struct/44992896#44992896", "title": "Golang Decode a BSON with special character Keys to a struct", "body": "<p>Define your struct with <code>json</code> tag-</p>\n\n<pre><code>type Person struct {\n    Id         string   `json:\"_id\"`\n    Name       string  // this field match with json, so mapping not need\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1499585961, "post_id": 44992964, "comment_id": 76962540, "body": "If the <code>bson</code> tag works, it&#39;s because you&#39;re not decoding JSON at all."}], "tags": [], "owner": {"reputation": 383, "user_id": 4634669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-RCOr91QgPvQ/AAAAAAAAAAI/AAAAAAAAAIk/X1Aka8XIDgw/photo.jpg?sz=128", "display_name": "athavan kanapuli", "link": "https://stackoverflow.com/users/4634669/athavan-kanapuli"}, "is_accepted": false, "score": 1, "last_activity_date": 1499574390, "creation_date": 1499574390, "answer_id": 44992964, "question_id": 44992835, "link": "https://stackoverflow.com/questions/44992835/golang-decode-a-bson-with-special-character-keys-to-a-struct/44992964#44992964", "title": "Golang Decode a BSON with special character Keys to a struct", "body": "<p>I tried to put a json tag like ,  </p>\n\n<pre><code>type Person struct {\n    Id         string   `json:\"_id\"`\n    Name       string  // this field match with json, so mapping not need\n}\n</code></pre>\n\n<p>But still it didn't work.  Because the Mongodb returns '_id' which is of type bson.ObjectId  .  Hence changing the Struct tag to   <code>bson:\"_id\"</code> and the type of the Person struct has been changed from string to bson.ObjectId. The changes done are as follows ,</p>\n\n<pre><code>type Person struct {\n    Id         bson.ObjectId `bson:\"_id\"`\n    Name       string\n    UserName   string\n    IsAdmin    bool\n    IsApprover bool\n}\n</code></pre>\n\n<p>And It works!</p>\n"}], "owner": {"reputation": 383, "user_id": 4634669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-RCOr91QgPvQ/AAAAAAAAAAI/AAAAAAAAAIk/X1Aka8XIDgw/photo.jpg?sz=128", "display_name": "athavan kanapuli", "link": "https://stackoverflow.com/users/4634669/athavan-kanapuli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 765, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1499591626, "creation_date": 1499572757, "last_edit_date": 1499591626, "question_id": 44992835, "link": "https://stackoverflow.com/questions/44992835/golang-decode-a-bson-with-special-character-keys-to-a-struct", "title": "Golang Decode a BSON with special character Keys to a struct", "body": "<p>I have a Golang struct called <code>Person</code> where all the properties have to be exported:</p>\n\n<pre><code>type Person struct {\n    Id         string\n    Name       string \n}\n</code></pre>\n\n<p>Now I need to encode my MongoDB BSON response to this <code>Person</code> struct.  The BSON looks like:</p>\n\n<pre><code>{\n  \"_id\": \"ajshJSH78N\",\n  \"Name\": \"Athavan Kanapuli\"\n}\n</code></pre>\n\n<p>The Golang code to encode the BSON is:</p>\n\n<pre><code>    mongoRecord := Person{}\n    c := response.session.DB(\"mydb\").C(\"users\")\n    err := c.Find(bson.M{\"username\": Credentials.Username, \"password\": Credentials.Password}).One(&amp;mongoRecord)\n</code></pre>\n\n<p><strong>The Problem:</strong></p>\n\n<ol>\n<li><code>_id</code> is not getting encoded into <code>Id</code></li>\n<li>If I change the <code>Person</code> property into <code>_Id</code>, then it won't be exported.</li>\n</ol>\n\n<p>How can I solve this problem?</p>\n"}, {"tags": ["go", "static-methods"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1499560110, "post_id": 44991854, "comment_id": 76958780, "body": "In the absence of a selector expression, the called function is either a function variable in scope or a function in the current package. Usually, that&#39;s sufficient context.   Note that Go does not have global functions or variables."}, {"owner": {"reputation": 315, "user_id": 1191556, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/uuwRl.jpg?s=128&g=1", "display_name": "Thanh Bui", "link": "https://stackoverflow.com/users/1191556/thanh-bui"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1499560648, "post_id": 44991854, "comment_id": 76958848, "body": "You&#39;re right. I edited the question."}, {"owner": {"reputation": 315, "user_id": 1191556, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/uuwRl.jpg?s=128&g=1", "display_name": "Thanh Bui", "link": "https://stackoverflow.com/users/1191556/thanh-bui"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1499560808, "post_id": 44991854, "comment_id": 76958878, "body": "Knowing that the called function is either a function variable in scope or in the current package might be ok in a small package. When the package grows, I think a specific context is necessary."}], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 1191556, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/uuwRl.jpg?s=128&g=1", "display_name": "Thanh Bui", "link": "https://stackoverflow.com/users/1191556/thanh-bui"}, "edited": false, "score": 0, "creation_date": 1499561280, "post_id": 44991933, "comment_id": 76958937, "body": "With option 1, I would have several sub-packages in my package and these packages would contain only one file. Is that common with Go?"}, {"owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "reply_to_user": {"reputation": 315, "user_id": 1191556, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/uuwRl.jpg?s=128&g=1", "display_name": "Thanh Bui", "link": "https://stackoverflow.com/users/1191556/thanh-bui"}, "edited": false, "score": 1, "creation_date": 1499566956, "post_id": 44991933, "comment_id": 76959648, "body": "You would typically try to group functions and types related to the same functionality and put them in the same package, so that you don&#39;t end up with just one function per package. If they are really simple and unrelated, each package can end up being small, I don&#39;t think that&#39;d be unusual either."}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 4, "last_activity_date": 1499560582, "creation_date": 1499560582, "answer_id": 44991933, "question_id": 44991854, "link": "https://stackoverflow.com/questions/44991854/equivalence-of-static-methods-in-go/44991933#44991933", "title": "Equivalence of static methods in Go", "body": "<p>I would say option 1 you mention is the more idiomatic way to define such functions, if they don't need any state that would warrant to tie them to an underlying struct.</p>\n\n<p>If there is some state you'd like to have as context for the function, then option 2 would be the way to go.</p>\n\n<p>Note that in Go, functions are \"first class citizens\", so you don't have Java's constraints of needing to define a class for static methods.</p>\n\n<p>And yes, if you want a separate namespace you'd need to define separate packages (just as in Java you'd need to define separate classes and/or packages).</p>\n\n<p>If you want your implementation to be idiomatic, I'd suggest you take a look at Go's standard libraries (pick a few packages and explore how they implement their functions) to get a better feeling of the usual ways to structure this.</p>\n"}, {"comments": [{"owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "edited": false, "score": 3, "creation_date": 1499565460, "post_id": 44992236, "comment_id": 76959464, "body": "And while you&#39;re at it, you could probably drop the <code>Get</code> off the front."}], "tags": [], "owner": {"reputation": 26092, "user_id": 824377, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e600bd229c588891a7616f303e30efd9?s=128&d=identicon&r=PG", "display_name": "AJcodez", "link": "https://stackoverflow.com/users/824377/ajcodez"}, "is_accepted": false, "score": 2, "last_activity_date": 1499564652, "creation_date": 1499564652, "answer_id": 44992236, "question_id": 44991854, "link": "https://stackoverflow.com/questions/44991854/equivalence-of-static-methods-in-go/44992236#44992236", "title": "Equivalence of static methods in Go", "body": "<blockquote>\n  <p>whenever I need the method, I just call GetLegacyFormat(), which doesn't contain the context where the method comes from.</p>\n</blockquote>\n\n<p>So add context to the function name.</p>\n\n<pre><code>GetLegacyCryptoFormat()\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 1191556, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/uuwRl.jpg?s=128&g=1", "display_name": "Thanh Bui", "link": "https://stackoverflow.com/users/1191556/thanh-bui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5845, "favorite_count": 0, "accepted_answer_id": 44991933, "answer_count": 2, "score": 3, "last_activity_date": 1499586102, "creation_date": 1499559143, "last_edit_date": 1499586102, "question_id": 44991854, "link": "https://stackoverflow.com/questions/44991854/equivalence-of-static-methods-in-go", "title": "Equivalence of static methods in Go", "body": "<p>Let's say in Java, I have class <em>CryptoFormat</em>, which has a static method named <em>getLegacyFormat()</em>. When I want to use the method, I just need to call <em>CryptoFormat.getLegacyFormat()</em>. This is clear because I know where the method comes from.  </p>\n\n<p>In Go, there is no static method. I don't really want to just make a file called <em>crypto_format.go</em> and define the method there. The reason is that whenever I need the method, I just call <em>GetLegacyFormat()</em>, which doesn't contain the context where the method comes from. </p>\n\n<p>I could think of two ways to solve the problem:</p>\n\n<ol>\n<li>Make a separate package named <em>cryptoformat</em>, and define the method as a global function in the package. This way, I need to make a new package for just few methods. Also, whenever I need static methods like this, I have to define new packages.</li>\n<li>Define a struct named <em>cryptoFormat</em> containing method <em>GetLegacyFormat()</em>. Also, define a <s>global</s> public variable named <em>CryptoFormat</em>, which points to an instance of struct <em>cryptoFormat</em>. This way, I can call CryptoFormat.GetLegacyFormat() when I need the method.</li>\n</ol>\n\n<p>I am not sure which one is better, or whether there is better way.</p>\n"}, {"tags": ["json", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 7934984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b973af1f51e994b67e4e076458b9815?s=128&d=identicon&r=PG", "display_name": "putitonmytab", "link": "https://stackoverflow.com/users/7934984/putitonmytab"}, "edited": false, "score": 0, "creation_date": 1499588781, "post_id": 44990051, "comment_id": 76963098, "body": "Makes perfect sense. Thanks very much for the great explanation!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 18, "last_activity_date": 1499583259, "last_edit_date": 1499583259, "creation_date": 1499542300, "answer_id": 44990051, "question_id": 44989924, "link": "https://stackoverflow.com/questions/44989924/golang-error-types-are-empty-when-encoded-to-json/44990051#44990051", "title": "Golang Error Types are empty when encoded to JSON", "body": "<p>Because <a href=\"https://golang.org/pkg/builtin/#error\" rel=\"noreferrer\"><code>error</code></a> is just an interface. It may hold a value of any concrete type that implements it.</p>\n\n<p>In your example you used <a href=\"https://golang.org/pkg/fmt/#Errorf\" rel=\"noreferrer\"><code>fmt.Errorf()</code></a> to create an <code>error</code> value. That calls <a href=\"https://golang.org/pkg/errors/#example_New\" rel=\"noreferrer\"><code>errors.New()</code></a> which returns a pointer to a value of the unexported <code>errors.errorString</code> struct. Its definition is:</p>\n\n<pre><code>type errorString struct {\n    s string\n}\n</code></pre>\n\n<p>This struct value will be marshaled, but since it has no exported fields (only exported fields are marshaled), it will be an empty JSON object: <code>{}</code>.</p>\n\n<p>The \"fix\" is: don't marshal values of \"general\" interfaces, relying on that the dynamic values can be marshaled into JSON meaningfully. Instead you should add a field that stores the error string (the result of <code>error.Error()</code>), and omit the <code>Error error</code> field from marshaling, e.g.:</p>\n\n<pre><code>type TemplateResponse struct {\n    Message  string\n    Error    error `json:\"-\"`\n    ErrorMsg string\n    Template Template\n}\n</code></pre>\n\n<p>Of course then you also need to set / fill the <code>ErrorMsg</code> field before marshaling.</p>\n\n<p>Or if you don't need to store the <code>error</code> value in the struct, remove that field completely:</p>\n\n<pre><code>type TemplateResponse struct {\n    Message  string\n    ErrorMsg string\n    Template Template\n}\n</code></pre>\n\n<p>If you still want to keep the <code>Error error</code> field (and not the <code>ErrorMsg</code> field), then you need to implement a custom marshaling logic by implementing the <a href=\"https://golang.org/pkg/encoding/json/#Marshaler\" rel=\"noreferrer\"><code>json.Marshaler</code></a> interface where you can \"convert\" the <code>error</code> value to a meaningful <code>string</code> for example (or into another value that can be marshaled properly).</p>\n"}], "owner": {"reputation": 143, "user_id": 7934984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b973af1f51e994b67e4e076458b9815?s=128&d=identicon&r=PG", "display_name": "putitonmytab", "link": "https://stackoverflow.com/users/7934984/putitonmytab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4009, "favorite_count": 0, "accepted_answer_id": 44990051, "answer_count": 1, "score": 11, "last_activity_date": 1529506070, "creation_date": 1499541475, "last_edit_date": 1529506070, "question_id": 44989924, "link": "https://stackoverflow.com/questions/44989924/golang-error-types-are-empty-when-encoded-to-json", "title": "Golang Error Types are empty when encoded to JSON", "body": "<p>I'm trying to encode some JSON for a REST api, everything is working fine except for some errors. For example, with this struct:</p>\n\n<pre><code>type TemplateResponse struct {\n    Message string\n    Error   error\n    Template Template\n}\n</code></pre>\n\n<p>Encoded with this data:</p>\n\n<pre><code>res := TemplateResponse{\"Template not found.\", fmt.Errorf(\"There is no template on this host with the name \" + vars[\"name\"]), Template{}}\njson.NewEncoder(w).Encode(res)\n</code></pre>\n\n<p>Returns:</p>\n\n<pre><code>{\n  \"Message\": \"Template not found.\",\n  \"Error\": {},\n  \"Template\": {\n    \"Name\": \"\",\n    \"Disabled\": false,\n    \"Path\": \"\",\n    \"Version\": \"\"\n  }\n}\n</code></pre>\n\n<p>I'm getting this seemingly randomly across my application, where 'error' types are being returned as empty. Any ideas?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["algorithm", "go", "logic", "progress-bar"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 2, "creation_date": 1499559092, "post_id": 44989533, "comment_id": 76958611, "body": "Just incase you didn&#39;t want to spend the time building a robust progress bar.. its been done pretty nicely already  <a href=\"https://github.com/cheggaaa/pb\" rel=\"nofollow noreferrer\">github.com/cheggaaa/pb</a>"}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1499842815, "post_id": 44989533, "comment_id": 77074604, "body": "I would recommend using an existing library as well. No reason to reinvent the wheel."}], "answers": [{"tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": false, "score": 1, "last_activity_date": 1499558120, "creation_date": 1499558120, "answer_id": 44991779, "question_id": 44989533, "link": "https://stackoverflow.com/questions/44989533/how-to-design-a-progress-bar-logic-when-inputs-are-less-than-10/44991779#44991779", "title": "How to design a progress bar logic when inputs are less than 10?", "body": "<p>I understand that you need to floor all the percentages to a multiple of 10.</p>\n\n<p>You could try something like the following.</p>\n\n<pre><code>lineLen := 4\nprogress := 0\nfor i := 0; i &lt; lineLen; i++ {\n    // Rounding down to the nearest multiple of 10.\n    actualProgress := (100 * (i+1) / lineLen)\n    if actualProgress &gt;= progress {\n        roundedProgress := (actualProgress / 10) * 10\n        // Condition to make sure the previous progress percentage is not repeated.\n        if roundedProgress != progress{\n            progress = roundedProgress\n            fmt.Printf(\"--%d%s--\", progress, \"%\")\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/rwrp2CEeuy\" rel=\"nofollow noreferrer\">Link</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": false, "score": 1, "last_activity_date": 1499576524, "creation_date": 1499576524, "answer_id": 44993149, "question_id": 44989533, "link": "https://stackoverflow.com/questions/44989533/how-to-design-a-progress-bar-logic-when-inputs-are-less-than-10/44993149#44993149", "title": "How to design a progress bar logic when inputs are less than 10?", "body": "<p>Have a look at <a href=\"https://play.golang.org/p/xtRtk1T_ZW\" rel=\"nofollow noreferrer\">https://play.golang.org/p/xtRtk1T_ZW</a> (code reproduced below):</p>\n\n<pre><code>func main() {\n    // outputMax is the number of progress items to print, excluding the 100% completion item.\n    // There will always be at least 2 items output: 0% and 100%.\n    outputMax := 10\n\n    for lineLen := 1; lineLen &lt; 200; lineLen++ {\n        fmt.Printf(\"lineLen=%-3d    \", lineLen)\n        printProgress(lineLen, outputMax)\n    }\n}\n\n// Calculate the current progress.\nfunc progress(current, max int) int {\n    return 100 * current / max\n}\n\n// Calculate the number of items in a group.\nfunc groupItems(total, limit int) int {\n    v := total / limit\n    if total%limit != 0 {\n        v++\n    }\n    return v\n}\n\n// Print the progress bar.\nfunc printProgress(lineLen, outputMax int) {\n    itemsPerGroup := groupItems(lineLen, outputMax)\n    for i := 0; i &lt; lineLen; i++ {\n        if i%itemsPerGroup == 0 {\n            fmt.Printf(\"--%d%%--\", progress(i, lineLen))\n        }\n    }\n    fmt.Println(\"--100%--\")\n}\n</code></pre>\n\n<p>If you want, you can execute a loop over various values of <code>outputMax</code> and <code>lineLen</code> using <a href=\"https://play.golang.org/p/aR6coeLhAk\" rel=\"nofollow noreferrer\">https://play.golang.org/p/aR6coeLhAk</a> to see which value for <code>outputMax</code> you like (<code>8 &lt;= outputMax &lt; 13</code> looks best to me).  Output of the progress bar is disabled by default, but you can easily enable it in <code>main</code>.</p>\n"}], "owner": {"reputation": 147, "user_id": 3990284, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/445062347ee640974e57693c7ce31ef4?s=128&d=identicon&r=PG&f=1", "display_name": "ds459", "link": "https://stackoverflow.com/users/3990284/ds459"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499576524, "creation_date": 1499538773, "question_id": 44989533, "link": "https://stackoverflow.com/questions/44989533/how-to-design-a-progress-bar-logic-when-inputs-are-less-than-10", "title": "How to design a progress bar logic when inputs are less than 10?", "body": "<p>I am parsing strings from an array and showing progress as the strings are parsed. This is my logic but it doesn't scale for inputs less than 10.</p>\n\n<p>Divide by zero is already taken care of during the initial part of the function for 100*i/(lineLen-1)</p>\n\n<pre><code>progress := 0\nfor i:= 0; i&lt;lineLen;i++ {\n //.. lineLen = array length\n//.....String processing...\nif (100*i/(lineLen-1)) &gt;= progress {\n     fmt.Printf(\"--%d%s--\", progress, \"%\")\n     progress += 10\n}\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 637, "user_id": 1532791, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5ec90903d94b483528e5f0caa63603d1?s=128&d=identicon&r=PG&f=1", "display_name": "Dewey", "link": "https://stackoverflow.com/users/1532791/dewey"}, "edited": false, "score": 0, "creation_date": 1499570519, "post_id": 44989457, "comment_id": 76960090, "body": "I&#39;m not even intending to use managed VM&#39;s and I don&#39;t have anything (that I can see in my app.yaml file that would make GAE think that either....I&#39;d like to use Flex or Std (whichever supports endpoints)"}, {"owner": {"reputation": 637, "user_id": 1532791, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5ec90903d94b483528e5f0caa63603d1?s=128&d=identicon&r=PG&f=1", "display_name": "Dewey", "link": "https://stackoverflow.com/users/1532791/dewey"}, "edited": false, "score": 0, "creation_date": 1499570917, "post_id": 44989457, "comment_id": 76960130, "body": "runtime: go       api_version: go1       service: default              env: flex       threadsafe: yes              instance_class: F1       automatic_scaling:        beta_settings:         # Enable Google Cloud Endpoints API management.         use_endpoints_api_management: true         # Specify the Swagger API specification.         endpoints_swagger_spec_file: swagger/swagger.yaml"}, {"owner": {"reputation": 637, "user_id": 1532791, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5ec90903d94b483528e5f0caa63603d1?s=128&d=identicon&r=PG&f=1", "display_name": "Dewey", "link": "https://stackoverflow.com/users/1532791/dewey"}, "edited": false, "score": 0, "creation_date": 1499572961, "post_id": 44989457, "comment_id": 76960405, "body": "thats my app.yaml above.....I couldn&#39;t figure out how to make it line-break  but I don&#39;t see anything in there about vm perhaps some of the beta commands are confusing appengine I want to use task-queues so it seems I need to go with GAE standard (not flex)  will that prohibit my use of endpoints?"}, {"owner": {"reputation": 40621, "user_id": 380757, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/895b803ca490f08e45cf548f35d0b5b5?s=128&d=identicon&r=PG", "display_name": "Tuxdude", "link": "https://stackoverflow.com/users/380757/tuxdude"}, "reply_to_user": {"reputation": 637, "user_id": 1532791, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5ec90903d94b483528e5f0caa63603d1?s=128&d=identicon&r=PG&f=1", "display_name": "Dewey", "link": "https://stackoverflow.com/users/1532791/dewey"}, "edited": false, "score": 0, "creation_date": 1499573510, "post_id": 44989457, "comment_id": 76960468, "body": "@Dewey - I&#39;m not too familiar with Cloud Endpoints integration with App Engine. On a quick search I found <a href=\"https://cloud.google.com/endpoints/docs/frameworks/java/get-started-frameworks-java\" rel=\"nofollow noreferrer\">this tutorial</a> which mentions support for Java 8 and Python runtimes with App Engine standard. In theory, I don&#39;t see a direct reason why Go runtime will not be supported since the endpoints are just plain HTTP, but there might be some limitations. Can you give that a shot - using GAE standard with Cloud Endpoints (using the tutorial as a reference) ?"}, {"owner": {"reputation": 637, "user_id": 1532791, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5ec90903d94b483528e5f0caa63603d1?s=128&d=identicon&r=PG&f=1", "display_name": "Dewey", "link": "https://stackoverflow.com/users/1532791/dewey"}, "edited": false, "score": 0, "creation_date": 1499656311, "post_id": 44989457, "comment_id": 76980509, "body": "yes...that&#39;s a good tutorial and I have looked at it but until I can figure out why appengine thinks I&#39;m trying to use managed VM&#39;s and get around that deploy problem, I&#39;m not clear how that tutorial will help me.  Do you see anything in my app.yaml that implies VM &amp; should be causing this &quot;maybe_build() takes exactly 2 arguments (1 given)&quot; crash?  In other words, how do I get back to Standard or Flex so I don&#39;t have to patch Googles code or deploy to the wrong GAE infrastructure?"}], "tags": [], "owner": {"reputation": 40621, "user_id": 380757, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/895b803ca490f08e45cf548f35d0b5b5?s=128&d=identicon&r=PG", "display_name": "Tuxdude", "link": "https://stackoverflow.com/users/380757/tuxdude"}, "is_accepted": true, "score": 1, "last_activity_date": 1499538311, "creation_date": 1499538311, "answer_id": 44989457, "question_id": 44988903, "link": "https://stackoverflow.com/questions/44988903/starting-go-server-on-app-engine-localhost-throws-error/44989457#44989457", "title": "Starting Go server on App Engine localhost throws error", "body": "<p>This appears to be a bug in Cloud SDK which is affecting <code>dev_appserver.py</code> when using with <code>App Engine Managed VMs</code>. It does not seem to be affecting App Engine Standard or App Engine Flex environments.</p>\n\n<p>Until Google releases a new Cloud SDK with the fix, you can modify the <code>CLOUD_SDK_INSTALL_DIR//platform/google_appengine/google/appengine/tools/devappserver2/go_managedvm.py</code> file locally as shown below (added both the patchable unified diff as well as before/after just for convenience).</p>\n\n<p>Also consider moving to App Engine Flex since <a href=\"https://cloud.google.com/appengine/docs/flexible/go/upgrading\" rel=\"nofollow noreferrer\">Managed VMs are deprecated and will not be supported after October 27, 2017</a>.</p>\n\n<blockquote>\n  <p><strong>Warning</strong>: The Managed VMs beta environment (applications deployed with\n  <code>vm:true</code>) is deprecated and will be decommissioned. This page is for\n  users who are already using the flexible environment with <code>vm:true</code> in\n  their <code>app.yaml</code> and want to upgrade to the latest release. If you are\n  updating your application from the standard environment, see the\n  <a href=\"https://cloud.google.com/appengine/docs/flexible/go/migrating\" rel=\"nofollow noreferrer\">Migrating Services from the Standard Environment to the Flexible\n  Environment instead</a>.</p>\n</blockquote>\n\n<h2>Diff in patchable format</h2>\n\n<pre><code>--- /Users/tuxdude/google-cloud-sdk-orig/platform/google_appengine/google/appengine/tools/devappserver2go_managedvm.py     2017-07-08 11:11:11.000000000 -0700\n+++ /Users/tuxdude/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/go_managedvm.py      2017-07-08 11:11:11.000000000 -0700\n@@ -152,15 +152,9 @@\n     logging.debug('Build succeeded:\\n%s\\n%s', stdout, stderr)\n     self._go_executable = exe_name\n\n-  def maybe_build(self, maybe_modified_since_last_build):\n+  def maybe_build(self):\n     \"\"\"Builds an executable for the application if necessary.\n\n-    Args:\n-      maybe_modified_since_last_build: True if any files in the application root\n-          or the GOPATH have changed since the last call to maybe_build, False\n-          otherwise. This argument is used to decide whether a build is Required\n-          or not.\n-\n     Returns:\n       True if compilation was successfully performed (will raise\n         an exception if compilation was attempted but failed).\n@@ -173,9 +167,6 @@\n       self._work_dir = tempfile.mkdtemp('appengine-go-bin')\n       atexit.register(_rmtree, self._work_dir)\n\n-    if self._go_executable and not maybe_modified_since_last_build:\n-      return False\n-\n     if self._go_executable:\n       logging.debug('Rebuilding Go application due to source modification')\n     else:\n</code></pre>\n\n<h2>Before:</h2>\n\n<pre><code>  def maybe_build(self, maybe_modified_since_last_build):\n    \"\"\"Builds an executable for the application if necessary.\n\n    Args:\n      maybe_modified_since_last_build: True if any files in the application root\n          or the GOPATH have changed since the last call to maybe_build, False\n          otherwise. This argument is used to decide whether a build is Required\n          or not.\n\n    Returns:\n      True if compilation was successfully performed (will raise\n        an exception if compilation was attempted but failed).\n      False if compilation was not attempted.\n\n    Raises:\n      BuildError: if building the executable fails for any reason.\n    \"\"\"\n    if not self._work_dir:\n      self._work_dir = tempfile.mkdtemp('appengine-go-bin')\n      atexit.register(_rmtree, self._work_dir)\n\n    if self._go_executable and not maybe_modified_since_last_build:\n      return False\n\n    if self._go_executable:\n      logging.debug('Rebuilding Go application due to source modification')\n    else:\n      logging.debug('Building Go application')\n    self._build()\n    return True\n</code></pre>\n\n<h2>After:</h2>\n\n<pre><code>  def maybe_build(self):\n    \"\"\"Builds an executable for the application if necessary.\n\n    Returns:\n      True if compilation was successfully performed (will raise\n        an exception if compilation was attempted but failed).\n      False if compilation was not attempted.\n\n    Raises:\n      BuildError: if building the executable fails for any reason.\n    \"\"\"\n    if not self._work_dir:\n      self._work_dir = tempfile.mkdtemp('appengine-go-bin')\n      atexit.register(_rmtree, self._work_dir)\n\n    if self._go_executable:\n      logging.debug('Rebuilding Go application due to source modification')\n    else:\n      logging.debug('Building Go application')\n    self._build()\n    return True\n</code></pre>\n"}], "owner": {"reputation": 637, "user_id": 1532791, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5ec90903d94b483528e5f0caa63603d1?s=128&d=identicon&r=PG&f=1", "display_name": "Dewey", "link": "https://stackoverflow.com/users/1532791/dewey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 44989457, "answer_count": 1, "score": 3, "last_activity_date": 1499538311, "creation_date": 1499534618, "last_edit_date": 1499538199, "question_id": 44988903, "link": "https://stackoverflow.com/questions/44988903/starting-go-server-on-app-engine-localhost-throws-error", "title": "Starting Go server on App Engine localhost throws error", "body": "<p>Can anyone tell me why this is happening:</p>\n\n<pre><code>$ dev_appserver.py nmg_server\nINFO     2017-07-08 17:15:37,369 application_configuration.py:461] No version specified. Generated version id: 20170708t171537\nWARNING  2017-07-08 17:15:37,369 application_configuration.py:166] The Managed VMs runtime is deprecated, please consider migrating your application to use the Flexible runtime. See https://cloud.google.com/appengine/docs/flexible/python/migrating for more details.\nINFO     2017-07-08 17:15:37,472 devappserver2.py:116] Skipping SDK update check.\nINFO     2017-07-08 17:15:37,513 api_server.py:312] Starting API server at: http://localhost:54096\nINFO     2017-07-08 17:15:37,517 api_server.py:938] Applying all pending transactions and saving the datastore\nINFO     2017-07-08 17:15:37,517 api_server.py:941] Saving search indexes\nTraceback (most recent call last):\n  File \"/Users/dgaedcke/gcloud_tools/google-cloud-sdk/platform/google_appengine/dev_appserver.py\", line 103, in &lt;module&gt;\n    _run_file(__file__, globals())\n  File \"/Users/dgaedcke/gcloud_tools/google-cloud-sdk/platform/google_appengine/dev_appserver.py\", line 97, in _run_file\n    execfile(_PATHS.script_file(script_name), globals_)\n  File \"/Users/dgaedcke/gcloud_tools/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/devappserver2.py\", line 381, in &lt;module&gt;\n    main()\n  File \"/Users/dgaedcke/gcloud_tools/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/devappserver2.py\", line 369, in main\n    dev_server.start(options)\n  File \"/Users/dgaedcke/gcloud_tools/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/devappserver2.py\", line 196, in start\n    options.api_host, apiserver.port, wsgi_request_info_, options.grpc_apis)\n  File \"/Users/dgaedcke/gcloud_tools/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/dispatcher.py\", line 223, in start\n    _module.start()\n  File \"/Users/dgaedcke/gcloud_tools/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/module.py\", line 1647, in start\n    self._add_instance()\n  File \"/Users/dgaedcke/gcloud_tools/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/module.py\", line 1799, in _add_instance\n    expect_ready_request=True)\n  File \"/Users/dgaedcke/gcloud_tools/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/go_runtime.py\", line 189, in new_instance\n    self._go_application.maybe_build()):\nTypeError: maybe_build() takes exactly 2 arguments (1 given)\n</code></pre>\n\n<p>I'm trying to run my server for testing on localhost and it keeps exiting with this error</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 4546, "user_id": 1170686, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/12481de846966844777303898e3b9dda?s=128&d=identicon&r=PG", "display_name": "ankush981", "link": "https://stackoverflow.com/users/1170686/ankush981"}, "edited": false, "score": 0, "creation_date": 1499570931, "post_id": 44990195, "comment_id": 76960133, "body": "But the same pattern should be observed without Sleep, because of the order of reading and writing should be the same, only that the delay will be much smaller. Without delay, the output is like &quot;ping ping pong ping ping ping&quot;. Why is that?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 4546, "user_id": 1170686, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/12481de846966844777303898e3b9dda?s=128&d=identicon&r=PG", "display_name": "ankush981", "link": "https://stackoverflow.com/users/1170686/ankush981"}, "edited": false, "score": 0, "creation_date": 1499572937, "post_id": 44990195, "comment_id": 76960403, "body": "When multiple goroutine sends value to channel order is not guaranteed. It might vary depends on reading value from channel. For e.g: I executed your program, output is <code>ping ping ping ping ping ping ping pong pong pong pong pong pong pong</code>.  Typically using <code>Sleep</code> in routine does yields allowing the other routine to resume. <code>main()</code> goroutine also executed concurrently."}, {"owner": {"reputation": 4546, "user_id": 1170686, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/12481de846966844777303898e3b9dda?s=128&d=identicon&r=PG", "display_name": "ankush981", "link": "https://stackoverflow.com/users/1170686/ankush981"}, "edited": false, "score": 0, "creation_date": 1499585117, "post_id": 44990195, "comment_id": 76962367, "body": "You mean, you executed my program with <code>Sleep</code> and got the pattern you mentioned? If not, this is my source of confusion. With <code>Sleep</code>, &quot;ping&quot; and &quot;pong&quot; alternate (at least on my machine), and without sleep, they seem to appear in random order."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 4546, "user_id": 1170686, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/12481de846966844777303898e3b9dda?s=128&d=identicon&r=PG", "display_name": "ankush981", "link": "https://stackoverflow.com/users/1170686/ankush981"}, "edited": false, "score": 0, "creation_date": 1499585400, "post_id": 44990195, "comment_id": 76962412, "body": "That output is without <code>Sleep</code>. That&#39;s why output comes in random, basically order is not guaranteed in routine."}, {"owner": {"reputation": 4546, "user_id": 1170686, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/12481de846966844777303898e3b9dda?s=128&d=identicon&r=PG", "display_name": "ankush981", "link": "https://stackoverflow.com/users/1170686/ankush981"}, "edited": false, "score": 0, "creation_date": 1499585596, "post_id": 44990195, "comment_id": 76962460, "body": "I&#39;m sorry if I&#39;m being a total idiot, but I still don&#39;t understand. If order is not guaranteed, why does using <code>Sleep</code> seem to produce an order?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 4546, "user_id": 1170686, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/12481de846966844777303898e3b9dda?s=128&d=identicon&r=PG", "display_name": "ankush981", "link": "https://stackoverflow.com/users/1170686/ankush981"}, "edited": false, "score": 1, "creation_date": 1499586706, "post_id": 44990195, "comment_id": 76962690, "body": "We all are helping each other in the Go community. Don&#39;t worry. When using <code>Sleep</code> it will block the goroutine from executing (you know this already). When particular routine goes to sleep, other routine gets executed in pseudo random. Try this <a href=\"https://play.golang.org/p/OuoyxRaCXb\" rel=\"nofollow noreferrer\">play.golang.org/p/OuoyxRaCXb</a> at your end. Order will change with sleep. As I mentioned before Sleep &#39;does yield, allowing the other routine to resume&#39;."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 1, "last_activity_date": 1499554258, "last_edit_date": 1592644375, "creation_date": 1499543510, "answer_id": 44990195, "question_id": 44988530, "link": "https://stackoverflow.com/questions/44988530/is-there-a-relation-between-sleep-and-synchronization/44990195#44990195", "title": "Is there a relation between Sleep() and synchronization?", "body": "<blockquote>\n<p>Is there a relation between Sleep() and synchronization?</p>\n<p>NO</p>\n</blockquote>\n<p>Synchronization happens between value sent to channel and retrieve from channel.</p>\n<pre><code>var c = make(chan string)\n</code></pre>\n<p>Channel <code>c</code> can hold one value of type string at a time. Until the value is retrieve from channel <code>&lt;- c</code>; function <code>pinger</code>, <code>ponger</code> cannot send value to channel <code>c</code> (i.e. pinger and ponger is waiting to send value to channel till the time you read from printer function).</p>\n<p>So in your example, you introduced the time delay via <code>Sleep</code> func to read the value from channel <code>c</code> on printer function.</p>\n<p>That's why you get nice and slow read with the help of <code>Sleep</code> func :)</p>\n"}], "owner": {"reputation": 4546, "user_id": 1170686, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/12481de846966844777303898e3b9dda?s=128&d=identicon&r=PG", "display_name": "ankush981", "link": "https://stackoverflow.com/users/1170686/ankush981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 44990195, "answer_count": 1, "score": 0, "last_activity_date": 1499554258, "creation_date": 1499532437, "question_id": 44988530, "link": "https://stackoverflow.com/questions/44988530/is-there-a-relation-between-sleep-and-synchronization", "title": "Is there a relation between Sleep() and synchronization?", "body": "<p>Consider the following program demonstrating channels:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc pinger(c chan string) {\n    for i := 0; ; i++ {\n        c &lt;- \"ping\"\n    }\n}\n\nfunc ponger(c chan string) {\n    for i := 0; ; i++ {\n        c &lt;- \"pong\"\n    }\n}\n\nfunc printer(c chan string) {\n    for {\n        msg := &lt;-c\n        fmt.Println(msg)\n        //time.Sleep(time.Second * 1)\n    }\n}\n\nfunc main() {\n    var c = make(chan string)\n\n    go pinger(c)\n    go ponger(c)\n    go printer(c)\n\n    var input string\n    fmt.Scanln(&amp;input)\n}\n</code></pre>\n\n<p>If I uncomment the <code>time.Sleep</code> call, the output is \"ping\" and \"pong\" taking turns in a nice, predictable manner. However, adding the comment makes the order unpredictable. I'm a Go novice and wondering what enabled this synchronization. Why does adding a wait time make the rest of the channel feeder tow the line?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 241, "user_id": 5427367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e56416b1e446e56c0c715732c918191c?s=128&d=identicon&r=PG&f=1", "display_name": "M-AbdalRahman", "link": "https://stackoverflow.com/users/5427367/m-abdalrahman"}, "is_accepted": false, "score": 0, "last_activity_date": 1499534639, "creation_date": 1499534639, "answer_id": 44988906, "question_id": 44988335, "link": "https://stackoverflow.com/questions/44988335/parsing-nested-json-in-go-language/44988906#44988906", "title": "Parsing nested JSON in go language", "body": "<p>use <a href=\"https://github.com/tidwall/gjson\" rel=\"nofollow noreferrer\">gjson</a> pkg to get value from json document an simple way</p>\n\n<p>example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/tidwall/gjson\"\n)\n\nfunc main() {\n    data := []byte(`{\n   \"success\": true,\n   \"endpoint\": \"https://api.abcxyz.com\",\n   \"info\": {\n      \"Guestconnected\": 134,\n      \"Guestratio\": 100000.06963,\n      \"symbol1\": {\n         \"code\": \"NY\",\n         \"symbol\": \"*\",\n         \"name\": \"newyear\",\n         \"codev\": 391.78161,\n         \"symbolAppearsAfter\": false,\n         \"local\": true\n      },\n      \"symbol2\": {\n         \"code\": \"HNY\",\n         \"symbol\": \"@\",\n         \"name\": \"HappyNewYear\",\n         \"codev\": 1000000.096,\n         \"symbolAppearsAfter\": true,\n         \"local\": false\n      },\n      \"latest\": {\n         \"value\": 1597509,\n         \"autovalue\": \"00099cf8da58a36c08f2ef98650ff6043ddfb\",\n         \"height\": 474696,\n         \"time\": 1499527696\n      }\n   },\n   \"Allguest\": {\n      \"all\": 4,\n      \"filtered\": 4,\n      \"total_invitations\": 15430,\n      \"sent_invitations\": 15430,\n      \"final_invitations\": 0\n   },\n   \"Guestlist\": [\n      {\n         \"GuestCode\": \"369AR\",\n         \"all\": 2,\n         \"total_invitations\": 5430,\n         \"sent_invitations\": 5430,\n         \"final_invitations\": 0,\n         \"change\": 0,\n         \"accounts\": 0\n      },\n      {\n         \"GuestCode\": \"6POIA96TY\",\n         \"all\": 2,\n         \"total_invitations\": 10000,\n         \"sent_invitations\": 10000,\n         \"final_invitations\": 0,\n         \"change\": 0,\n         \"accounts\": 0\n      }\n   ]\n    }\n    `)\n\n    r := gjson.GetBytes(data, \"Allguest.total_invitations\")\n    fmt.Println(r.Value()) // output 15430\n\n    r = gjson.GetBytes(data, \"Guestlist.#.total_invitations\")\n    fmt.Println(r.Value()) // output [5430 10000]\n}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "reply_to_user": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "edited": false, "score": 0, "creation_date": 1499546326, "post_id": 44989392, "comment_id": 76955952, "body": "@Nancyme You should consider taking a look at the <a href=\"https://golang.org/doc/#learning\" rel=\"nofollow noreferrer\">Learning section of the documentation</a> and also <a href=\"https://golang.org/pkg/\" rel=\"nofollow noreferrer\">explore the core packages</a>. You seem to not understand that the <code>Write</code> method of <code>*csv.Writer</code> only accepts <code>[]string</code>, not <code>int</code>. You had the right idea, but you need to determine what data to write to the file and how to convert that data to a slice of strings to do it."}, {"owner": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "edited": false, "score": 0, "creation_date": 1499590442, "post_id": 44989392, "comment_id": 76963440, "body": "like this  <code>TotalInvites := [][]string{{s.Guestlist[i].TotalInvitations}}</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "reply_to_user": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "edited": false, "score": 0, "creation_date": 1499595877, "post_id": 44989392, "comment_id": 76964731, "body": "@Nancyme You&#39;re not converting the integer to a <code>[][]string</code> object by doing that; you&#39;re creating a new <code>[][]string</code> object with an integer as the only value, which won&#39;t work because <code>int</code> is not a type that is compatible with <code>string</code>. Learn, don&#39;t just guess. We&#39;re here to help if you encounter trouble and need to ask a question, not to teach you the entire language; I linked resources for learning in my last comment on this answer."}, {"owner": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "edited": false, "score": 0, "creation_date": 1499602151, "post_id": 44989392, "comment_id": 76966384, "body": "Thanks for the advise, I am trying hard to learn the things but i can&#39;t learn the whole language in a single day and i want this ASAP so need some support, I have successfully able to compile &amp; its working as desired with the edited answer, but i am still not sure if its just a workaround or we can modify it to something more professional, I will appreciate if you can take a look and modify accordingly, thanks and i appreciate your support"}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "reply_to_user": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "edited": false, "score": 0, "creation_date": 1499608054, "post_id": 44989392, "comment_id": 76968099, "body": "It&#39;s on the right track, but you&#39;re going beyond the scope of your original question. Please ask a new question if you need more help and good luck. :)"}, {"owner": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "edited": false, "score": 0, "creation_date": 1499608628, "post_id": 44989392, "comment_id": 76968247, "body": "was the code perfect or we can write it more professionally?"}, {"owner": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "edited": false, "score": 0, "creation_date": 1499608683, "post_id": 44989392, "comment_id": 76968266, "body": "its problem#2 i mentioned in the question"}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "edited": false, "score": 0, "creation_date": 1556131622, "post_id": 44989392, "comment_id": 98337626, "body": "@Nancyme Do you agree Pavlo&#39;s solution as good one? In my opinion, you should follow that answer"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": false, "score": 0, "last_activity_date": 1499537860, "creation_date": 1499537860, "answer_id": 44989392, "question_id": 44988335, "link": "https://stackoverflow.com/questions/44988335/parsing-nested-json-in-go-language/44989392#44989392", "title": "Parsing nested JSON in go language", "body": "<ol>\n<li><blockquote>\n  <p>If the response is null it is giving index out of range error how can\n  we avoid this?</p>\n</blockquote>\n\n<p>Unless I'm misunderstanding you, the response being null shouldn't matter.  If you receive 2 Guestlist items, you can only loop over those 2, meaning <code>for i := 0; i &lt; 6; i++</code> is wrong.  Change it to <code>for i := 0; i &lt; len(s.Guestlist); i++</code> or <code>for i := range s.Guestlist</code>.</p></li>\n<li><blockquote>\n  <p>Applying condition if TotalInvitations value is greater than 100 then\n  save in 100.csv else save in others.csv</p>\n</blockquote>\n\n<p>You will probably want the <code>os</code> package's <a href=\"https://golang.org/pkg/os/#Create\" rel=\"nofollow noreferrer\"><code>Create</code></a> function to create a new file for writing or the <a href=\"https://golang.org/pkg/os/#OpenFile\" rel=\"nofollow noreferrer\"><code>OpenFile</code></a> function, the <a href=\"https://golang.org/pkg/os/#O_WRONLY\" rel=\"nofollow noreferrer\"><code>O_CREATE</code>, <code>O_WRONLY</code>, and <code>O_APPEND</code></a> file-open flags, and you can pass <code>0755</code> as the permission mode (or another set of octal permissions if you want to change access of a file).</p>\n\n<p>You can then use <code>csvWriter := csv.NewWriter(csvFile)</code> to wrap the resulting <code>io.Writer</code> (assuming there is no error opening the file).  From there, you can just write whatever information you require to the file as CSV records.  Don't forget to call <code>csvWriter.Flush</code> to flush the output buffer and <code>csvWriter.Error</code> to check whether there was an error flushing the output buffer.  Also don't forget to close the file you opened.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "is_accepted": false, "score": 1, "last_activity_date": 1499622854, "last_edit_date": 1499622854, "creation_date": 1499611719, "answer_id": 44997663, "question_id": 44988335, "link": "https://stackoverflow.com/questions/44988335/parsing-nested-json-in-go-language/44997663#44997663", "title": "Parsing nested JSON in go language", "body": "<p>If you need only certain entries from JSON you can define a structure with only those fields you are interested in. And if value can be null it is better to declare a pointer in the structure. Please take a look at an example at go playground: <a href=\"https://play.golang.org/p/mEwSXvPg3D\" rel=\"nofollow noreferrer\">https://play.golang.org/p/mEwSXvPg3D</a> </p>\n"}], "owner": {"reputation": 43, "user_id": 8271564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BTtap.jpg?s=128&g=1", "display_name": "Nancyme", "link": "https://stackoverflow.com/users/8271564/nancyme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1535038975, "creation_date": 1499531129, "last_edit_date": 1535038975, "question_id": 44988335, "link": "https://stackoverflow.com/questions/44988335/parsing-nested-json-in-go-language", "title": "Parsing nested JSON in go language", "body": "<p>How could I parse and extract certain values from below JSON</p>\n\n<p>Here is the sample JSON response</p>\n\n<pre><code>{\n   \"success\":true,\n   \"endpoint\":\"https://api.abcxyz.com\",\n   \"info\":{\n      \"Guestconnected\":134,\n      \"Guestratio\":100000.06963,\n      \"symbol1\":{\n         \"code\":\"NY\",\n         \"symbol\":\"*\",\n         \"name\":\"newyear\",\n         \"codev\":391.78161,\n         \"symbolAppearsAfter\":false,\n         \"local\":true\n      },\n      \"symbol2\":{\n         \"code\":\"HNY\",\n         \"symbol\":\"@\",\n         \"name\":\"HappyNewYear\",\n         \"codev\":1000000.0960,\n         \"symbolAppearsAfter\":true,\n         \"local\":false\n      },\n      \"latest\":{\n         \"value\":1597509,\n         \"autovalue\":\"00099cf8da58a36c08f2ef98650ff6043ddfb\",\n         \"height\":474696,\n         \"time\":1499527696\n      }\n   },\n   \"Allguest\":{\n      \"all\":4,\n      \"filtered\":4,\n      \"total_invitations\":15430,\n      \"sent_invitations\":15430,\n      \"final_invitations\":0\n   },\n   \"Guestlist\":[\n      {\n         \"GuestCode\":\"369AR\",\n         \"all\":2,\n         \"total_invitations\":5430,\n         \"sent_invitations\":5430,\n         \"final_invitations\":0,\n         \"change\":0,\n         \"accounts\":0\n      },\n      {\n         \"GuestCode\":\"6POIA96TY\",\n         \"all\":2,\n         \"total_invitations\":10000,\n         \"sent_invitations\":10000,\n         \"final_invitations\":0,\n         \"change\":0,\n         \"accounts\":0\n      }\n   ]\n}\n</code></pre>\n\n<p>My Code is :</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n)\n\n\ntype object struct {\n    Success bool `json:\"success\"`\n    Endpoint string `json:\"endpoint\"`\n    Allguest struct {\n        All int `json:\"all\"`\n        Filtered int `json:\"filtered\"`\n        TotalInvitations int `json:\"total_invitations\"`\n        SentInvitations int `json:\"sent_invitations\"`\n        FinalInvitations int `json:\"final_invitations\"`\n    } `json:\"Allguest\"`\n    Guestlist []struct {\n        GuestCode string `json:\"GuestCode\"`\n        All int `json:\"all\"`\n        TotalInvitations int `json:\"total_invitations\"`\n        SentInvitations int `json:\"sent_invitations\"`\n        FinalInvitations int `json:\"final_invitations\"`\n        Change int `json:\"change\"`\n        Accounts int `json:\"accounts\"`\n    } `json:\"Guestlist\"`\n}\n\nfunc main() {\n\nuri := \"https://siteurl.com/api?lists=1\"\nres, err := http.Get(uri)\nfmt.Println(uri)\nif err != nil {\nfmt.Println(\"Error:\", err)\n    log.Fatal(err)\n}\ndefer res.Body.Close()\n\n var s object\nerr := json.NewDecoder(res.Body).Decode(&amp;s)\nif err != nil {\n    log.Fatal(err)\n    fmt.Println(\"Error:\", err)\n}\nfmt.Println(s.Success)\nfmt.Println(s.Allguest.TotalInvitations)\nfor i := 0; i &lt; 6; i++ {\nfmt.Println(s.Guestlist[i].TotalInvitations)\n)\n\n}\n</code></pre>\n\n<p>The problem is :</p>\n\n<ol>\n<li><p>If the response is null it is giving <code>index out of range error</code> how can we avoid this ?</p></li>\n<li><p>Applying condition if <code>TotalInvitations</code> value is greater than <code>100</code> then save in <code>100.csv</code> else save in <code>others.csv</code></p></li>\n</ol>\n"}, {"tags": ["go", "singleton"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1499533330, "post_id": 44987214, "comment_id": 76952117, "body": "Isn&#39;t <code>sync.Once</code> an unnecessary dependency? Couldn&#39;t <code>data</code> simply be <code>nil</code> when not loaded and not <code>nil</code> when loaded?"}, {"owner": {"reputation": 307, "user_id": 392092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98cecc32a5d18ccad187ef2f3c0e277d?s=128&d=identicon&r=PG", "display_name": "terinjokes", "link": "https://stackoverflow.com/users/392092/terinjokes"}, "edited": false, "score": 0, "creation_date": 1499540368, "post_id": 44987214, "comment_id": 76954185, "body": "@ChronoKitsune A quick glance suggests there&#39;s 1.75 million UK postcodes. In the time it takes to load this data, multiple goroutines might have called <code>LookupPostCode</code>. Without the <code>sync.Once</code>, they&#39;ll each start loading the CSV. With it, they&#39;ll all block on the first call the finish."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "reply_to_user": {"reputation": 307, "user_id": 392092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98cecc32a5d18ccad187ef2f3c0e277d?s=128&d=identicon&r=PG", "display_name": "terinjokes", "link": "https://stackoverflow.com/users/392092/terinjokes"}, "edited": false, "score": 0, "creation_date": 1499543054, "post_id": 44987214, "comment_id": 76955035, "body": "@terinjokes Makes sense, except then I wonder why a lookup function loads data when the volume is that large. A possibly more reasonable idea along the lines of option 1 is to generate the map outside of the package and have it loaded with the rest of the package. Potentially slow import, but it&#39;d likely be faster than importing it from a file every time the package is imported. Of course, this assumes that a map literal of that magnitude is supported by the implementation\u2026 I&#39;m unaware of any limitations, so AFAIK it&#39;s a viable solution."}, {"owner": {"reputation": 307, "user_id": 392092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98cecc32a5d18ccad187ef2f3c0e277d?s=128&d=identicon&r=PG", "display_name": "terinjokes", "link": "https://stackoverflow.com/users/392092/terinjokes"}, "edited": false, "score": 1, "creation_date": 1499544090, "post_id": 44987214, "comment_id": 76955317, "body": "@ChronoKitsune True. For this use case, if it was my application I&#39;d either load the data at application startup and pass to the object that would be doing the lookups or, if the data changes very infrequently, like Unicode CLDRs, a generated package that gets imported. This doesn&#39;t make option 2 any less valid for other use cases"}], "tags": [], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "is_accepted": false, "score": 0, "last_activity_date": 1499533252, "last_edit_date": 1499533252, "creation_date": 1499523538, "answer_id": 44987214, "question_id": 44986977, "link": "https://stackoverflow.com/questions/44986977/go-package-with-a-loaded-once-set-of-data/44987214#44987214", "title": "Go package with a loaded once set of data", "body": "<p>You've got two options:</p>\n\n<ol>\n<li><p>The simplest is load the data in main before any other processing starts. If probability that you will read the data is very high and there is no other reason to avoid doing it immediately, why not?</p></li>\n<li><p>Load the data with sync.Once. Something like:</p>\n\n<pre><code>var dataLoaded sync.Once\nvar data DataType = nil\n\nfunc LookupPostCode(some_args) {\n    once.Do(func() {\n        data = LoadData(some_subset_of_some_args)\n    })\n    // and here I know, that data are loaded\n}\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 256, "user_id": 8247959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fef982df359995ae04d20a971787ec41?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Novgorodov", "link": "https://stackoverflow.com/users/8247959/igor-novgorodov"}, "is_accepted": false, "score": 0, "last_activity_date": 1499579731, "creation_date": 1499579731, "answer_id": 44993440, "question_id": 44986977, "link": "https://stackoverflow.com/questions/44986977/go-package-with-a-loaded-once-set-of-data/44993440#44993440", "title": "Go package with a loaded once set of data", "body": "<p>You can use init() function in your package to do this.</p>\n\n<p>Or, if it does not change frequently, you can convert your CSV into a Go Map definition in a separate .go file and it will be 'loaded' at the compile time.</p>\n"}], "owner": {"reputation": 835, "user_id": 1105727, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/Ys5Bh.jpg?s=128&g=1", "display_name": "Charles Bryant", "link": "https://stackoverflow.com/users/1105727/charles-bryant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499600998, "creation_date": 1499521871, "last_edit_date": 1499600998, "question_id": 44986977, "link": "https://stackoverflow.com/questions/44986977/go-package-with-a-loaded-once-set-of-data", "title": "Go package with a loaded once set of data", "body": "<p>I am writing a post code location lookup package, it loads in all uk postcodes from a csv, I would like to only load the data once I would like to know what is the best pattern to achieve this with Go.</p>\n\n<pre><code>type Location struct {\n    Latitude float64\n    Longitude float64\n}\n\nvar postCodeCache = make(map[string]Location)\n</code></pre>\n\n<p>These are my data types, currently I have a function called LoadData and LookupPostCode(). Ideally I would want to import my package and it would automatically load the data if it was not already loaded.</p>\n"}, {"tags": ["go", "synchronization", "goroutine"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 1, "creation_date": 1499559757, "post_id": 44986340, "comment_id": 76958722, "body": "There are many things wrong with the code in the playground.... For one check the documentation you should be using log with goroutines.. they are concurrently safe.. you shouldn&#39;t need more then one waitgroup.. I think your code needs to be reorganized...and perhaps controlled with a channel.  Don&#39;t create a waitgroup inside of a goroutine either. Attached is a slightly modified version of your code that doesn&#39;t panic. <a href=\"https://play.golang.org/p/gBQPUGNvNb\" rel=\"nofollow noreferrer\">play.golang.org/p/gBQPUGNvNb</a>  It won&#39;t have the print order you seek because goroutines are async.. So you&#39;ll likely want to create a buffered queue"}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 7331997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVktJ.png?s=128&g=1", "display_name": "nuuls", "link": "https://stackoverflow.com/users/7331997/nuuls"}, "is_accepted": true, "score": 1, "last_activity_date": 1499525777, "creation_date": 1499525777, "answer_id": 44987471, "question_id": 44986340, "link": "https://stackoverflow.com/questions/44986340/goroutine-and-workgroup-issue/44987471#44987471", "title": "Goroutine and Workgroup Issue", "body": "<p><code>jobWG.Wait()</code> is inside the <code>for _, job := range jobs</code> loop when it should be outside.\nHere is a fixed version <a href=\"https://play.golang.org/p/KNLS0y8xLg\" rel=\"nofollow noreferrer\">https://play.golang.org/p/KNLS0y8xLg</a></p>\n"}], "owner": {"reputation": 1370, "user_id": 7824245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-0l2xVxKv9gc/AAAAAAAAAAI/AAAAAAAAABo/GSjROchHomI/photo.jpg?sz=128", "display_name": "Floating Sunfish", "link": "https://stackoverflow.com/users/7824245/floating-sunfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 44987471, "answer_count": 1, "score": 0, "last_activity_date": 1499525777, "creation_date": 1499517733, "last_edit_date": 1499520747, "question_id": 44986340, "link": "https://stackoverflow.com/questions/44986340/goroutine-and-workgroup-issue", "title": "Goroutine and Workgroup Issue", "body": "<p>I'm trying to print a set of Big Jobs (\"1,2\", \"3,4\", \"5\") in combination with Extra Jobs (\"one\", \"two\", \"three\") and using Goroutines and Workgroups to do so.</p>\n\n<p>I am expecting the following output (not exactly in this order, but the internal Workgroups should finish first before the outer ones):</p>\n\n<pre><code>Big Job being done: 1,2\n1_one\n1_two\n1_three\n2_one\n2_two\n2_three\nBig Job 1,2 is Done!\nBig Job being done: 3,4\n3_one\n3_two\n3_three\n4_one\n4_two\n4_three\nBig Job 3,4 is Done!\nBig Job being done: 5\n5_one\n5_two\n5_three\nBig Job 5 is Done!\nAll Big Jobs are done!\n</code></pre>\n\n<p>Go Playground Link: <a href=\"https://play.golang.org/p/Hvbcmw06WY\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Hvbcmw06WY</a></p>\n\n<p>However, when I run my code, I get the following output instead:</p>\n\n<pre><code>Big job  1,2  is Done!\nBig job  3,4  is Done!\nBig job  5  is Done!\nBig Job being done: 5\n5_three\nBig Job being done: 1,2\n1_three\nBig Job being done: 3,4\n3_three\n5_one\n5_two\n1_one\n1_two\n3_one\n3_two\nfatal error: all goroutines are asleep - deadlock!\n</code></pre>\n\n<p>As you can see, the second portion of the Big Jobs (<code>2</code> and <code>4</code>) were somehow \"lost\" inside the goroutines.</p>\n\n<p>Also, the <code>All Big Jobs are done!</code> message is never reached because all goroutines fall asleep somehow, even though each Waitgroup should have finished already (though the missing <code>2</code> and <code>4</code> portions might have something to do with it).</p>\n\n<p>I also noticed that for some reason the <code>Done</code> messages are being printed first (although I'm assuming that the Print functions are simply having trouble catching up with the Goroutines).</p>\n\n<p>Here is the non-Goroutine version of what I want to accomplish: <a href=\"https://play.golang.org/p/zZpfyIbbn8\" rel=\"nofollow noreferrer\">https://play.golang.org/p/zZpfyIbbn8</a></p>\n\n<p>Any idea what I might be doing wrong?</p>\n"}, {"tags": ["templates", "go", "go-html-template"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1499523939, "post_id": 44985509, "comment_id": 76948586, "body": "Support for <code>{{ template .SubTemplate . }}</code> was removed <a href=\"https://github.com/golang/go/commit/7aa1a1a64d8f43a33b41f67a5c9366b3d8b67328\" rel=\"nofollow noreferrer\">in this commit</a>.  It&#39;s unclear from the comment why support for the feature was removed, but it may be because work was already underway on the contextual escaper where supporting this feature is difficult or impossible."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1499531977, "post_id": 44985509, "comment_id": 76951643, "body": "This is not possible, as contex may vary on the including template. See more explanation in the marked duplicate. Multiple solutions (workarounds) are listed there, I suggest template refactoring; e.g. have different templates for different pages, and have them include header and footer, instead of a &quot;master&quot; template including various page content based on the page name."}, {"owner": {"reputation": 526, "user_id": 1035977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310abc9d873d41cede1258891d6bcaf3?s=128&d=identicon&r=PG", "display_name": "Gwyneth Llewelyn", "link": "https://stackoverflow.com/users/1035977/gwyneth-llewelyn"}, "edited": false, "score": 0, "creation_date": 1499767733, "post_id": 44985509, "comment_id": 77036654, "body": "Thank you for your answers. It seems that I have missed this very same question before: <a href=\"https://stackoverflow.com/questions/28830543/how-to-use-a-field-of-struct-or-variable-value-as-template-name\" title=\"how to use a field of struct or variable value as template name\">stackoverflow.com/questions/28830543/&hellip;</a> where the answer, as you both said, is negative \u2014 this is simply something that cannot be done."}], "owner": {"reputation": 526, "user_id": 1035977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310abc9d873d41cede1258891d6bcaf3?s=128&d=identicon&r=PG", "display_name": "Gwyneth Llewelyn", "link": "https://stackoverflow.com/users/1035977/gwyneth-llewelyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1499532020, "answer_count": 0, "score": 1, "last_activity_date": 1499512064, "creation_date": 1499512064, "question_id": 44985509, "link": "https://stackoverflow.com/questions/44985509/selecting-among-multiple-go-subtemplates-based-on-one-value-in-a-template", "closed_reason": "Duplicate", "title": "Selecting among multiple Go subtemplates based on one value in a template", "body": "<p>I'm a newbie Go (and Go templates) amateur programmer, and I have seen variants of this question being asked, but never quite in the same way, so here it goes again...</p>\n\n<p>I'm attempting to do the following <em>without registering any additional functions</em> (so, limiting myself strictly to what the limited template syntax allows):</p>\n\n<p>Suppose I have several different snippets of HTML, each on its own template: <code>A.tpl</code>, <code>B.tpl</code>, <code>C.tpl</code> and so forth (the number is not fixed, and it will grow over time as the application grows; also, there is no implicit numbering/sequential naming in the subtemplates as the example may imply).</p>\n\n<p>Then I have a main template which sets the common headers, footers, menus and so forth, as well as the necessary HTML wrapping around each, in <code>main.tpl</code>, something very simple like this:</p>\n\n<pre><code>{{ if .A }}\n{{ template \"A.tpl\" . }}\n{{ end }}\n{{ if .B }}\n{{ template \"B.tpl\" . }}\n{{ end }}\n{{ if .C }}\n{{ template \"C.tpl\" . }}\n{{ end }}\n...\n</code></pre>\n\n<p>or, depending on how the calling code has been done, this could also be written as (assuming we're passing the name of the subtemplate as a value to <code>main.tpl</code>):</p>\n\n<pre><code>{{ if eq .SubTemplate \"A.tpl\" }}\n{{ template \"A.tpl\" . }}\n{{ end }}\n{{ if eq .SubTemplate \"B.tpl\" }}\n{{ template \"B.tpl\" . }}\n{{ end }}\n{{ if eq .SubTemplate \"C.tpl\" }}\n{{ template \"C.tpl\" . }}\n{{ end }}\n...\n</code></pre>\n\n<p>Clearly, what would be obvious to write (at the template level) would be:</p>\n\n<pre><code>{{ template .SubTemplate . }}\n</code></pre>\n\n<p>but of course that is syntactically invalid, because <code>template</code> can only use a string constant, not a value/variable, as a parameter (right?)</p>\n\n<p>The reasoning behind forcing a long list of <code>if</code> statements on the templates seems to be that this kind of programming style is deemed to be 'logic' which ought to be taken out of templates, at least at a 'standard' level of the language; Go programmers are supposed not to think on the template engine (= presentation layer) as having any intrinsic 'logic' in it. Of course, it's not up to me to discuss what is considered logic and what isn't (an <code>if</code> statement that is allowed to test for equality on specific values and executes different blocks depending on those values is most certainly 'logic' for me, but apparently not for the Go developers).</p>\n\n<p><a href=\"https://stackoverflow.com/questions/16985469/switch-or-if-elseif-else-inside-golang-html-templates\">Similar questions were asked a few years ago</a> and the answer was never very satisfactory for the OP. Basically, as far as I understood it, there are a few choices:</p>\n\n<ol>\n<li>Define a new function, extending the template code, that eventually creates the equivalent a switch statement; this would allow at least saving a few <code>{{ if ... end }}</code> constructs, but, for me, it would still lack the simplicity and readability of a one-liner.</li>\n<li>Hacking (or, rather, extending...) the whole <code>html/template</code> package to change the template syntax, <a href=\"https://stackoverflow.com/questions/16985469/switch-or-if-elseif-else-inside-golang-html-templates#comment24601149_16995521\">something which allegedly has been done</a> by @Intermernet four years ago. It's a valid exercise, of course, but it means getting away from a standard Go library. If that's the choice, then there are plenty of template engines for Go around there; I'm just reluctant in starting to use one of them and find out after a couple of years that it became obsolete because the authors have abandoned the project. With standard libraries that will not happen (at least while Google is around and <a href=\"https://en.wikipedia.org/wiki/Ken_Thompson\" rel=\"nofollow noreferrer\">Ken Thompson</a> is still alive).</li>\n<li>Doing all the processing of what subtemplate to use on the Go side. This is naturally feasible, but (IMHO) it leads to much less readable code. Of course, I'm aware of the ideological battles among Go programmers, between those who are keen on writing 'idiomatic' (but hard-to-follow) code, and the many other factions who have different ways of writing Go code. Personally, I adhere to the <a href=\"https://en.wikipedia.org/wiki/Principle_of_least_astonishment\" rel=\"nofollow noreferrer\">Principle of Least Surprise</a> and <a href=\"https://en.wikipedia.org/wiki/KISS_principle\" rel=\"nofollow noreferrer\">KISS</a> \u2014 I want my own code to be understandable even ten years after I have written it :)</li>\n</ol>\n\n<p>Has the template syntax evolved towards allowing what I've described (and I was just unfortunate enough not to have found any working example), or am I still stuck to complexify the Go code, or use a different, non-standard Go templating engine to accomplish this simple task?</p>\n\n<p>Thank you all in advance for any insights you might have. I'm still crossing my fingers hoping that I'm just too much of a newbie with the Go template syntax and that it actually allows what I want, I just need to add a few more awkward symbols to allow the <code>template</code> keyword to accept a variable instead of a string constant, something which, so far, has eluded me :-)</p>\n"}, {"tags": ["go", "sqlx"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 1301604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04bbf2a1f17d743df5d8fe96d149e22?s=128&d=identicon&r=PG", "display_name": "evocatus", "link": "https://stackoverflow.com/users/1301604/evocatus"}, "edited": false, "score": 0, "creation_date": 1499512422, "post_id": 44985399, "comment_id": 76945585, "body": "You don&#39;t need to tag every field in order to use it with sqlx as long as there is no ambiguity. I still don&#39;t understand why my code (in the question) doesn&#39;t work. Sqlx can&#39;t read struct tags through pointers? Sqlx can&#39;t scan values to structs through pointers?"}, {"owner": {"reputation": 824, "user_id": 733100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/954f89b0decc75e8355cf87699ab0e60?s=128&d=identicon&r=PG", "display_name": "64bit_twitchyliquid", "link": "https://stackoverflow.com/users/733100/64bit-twitchyliquid"}, "edited": false, "score": 0, "creation_date": 1499513727, "post_id": 44985399, "comment_id": 76945884, "body": "Do you need to tag the struct Course itself (as opposed to just the Names field)? ie: <code>db:&quot;courses&quot;</code> after the <code>}</code> of your Course struct?"}, {"owner": {"reputation": 26792, "user_id": 734040, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/p1dqF.jpg?s=128&g=1", "display_name": "Decade Moon", "link": "https://stackoverflow.com/users/734040/decade-moon"}, "edited": false, "score": 0, "creation_date": 1499513799, "post_id": 44985399, "comment_id": 76945902, "body": "The error message explains exactly what the issue is: the <code>Group</code> struct has no field tagged <code>course_name</code>, therefore you can&#39;t scan into it. Either tag an appropriate field in the <code>Group</code> struct as <code>course_name</code>, or scan directly into a <code>Course</code> struct instead."}, {"owner": {"reputation": 53, "user_id": 1301604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04bbf2a1f17d743df5d8fe96d149e22?s=128&d=identicon&r=PG", "display_name": "evocatus", "link": "https://stackoverflow.com/users/1301604/evocatus"}, "edited": false, "score": 0, "creation_date": 1499514100, "post_id": 44985399, "comment_id": 76945967, "body": "If i have to scan directly than i don&#39;t need sqlx because it&#39;s like plain database/sql works."}], "tags": [], "owner": {"reputation": 26792, "user_id": 734040, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/p1dqF.jpg?s=128&g=1", "display_name": "Decade Moon", "link": "https://stackoverflow.com/users/734040/decade-moon"}, "is_accepted": false, "score": 0, "last_activity_date": 1499511363, "creation_date": 1499511363, "answer_id": 44985399, "question_id": 44985354, "link": "https://stackoverflow.com/questions/44985354/sqlx-missing-destination-name-for-struct-tag-through-pointer/44985399#44985399", "title": "Sqlx &quot;missing destination name&quot; for struct tag through pointer", "body": "<p>You need to use <code>sqlx.Select</code> when you are selecting multiple rows and you want to scan the result into a slice, as is the case for your query, otherwise use <code>sqlx.Get</code> for a single row.</p>\n\n<p>In addition, you can't scan directly into a <code>Group</code> struct because none of its fields are tagged (unlike the <code>Course</code> struct), and the <code>Course</code> field isn't embedded.</p>\n\n<p>Try:</p>\n\n<pre><code>course := Course{}\ncourses := []Course{}\n\ndb.Get(&amp;course, \"SELECT name AS course_name FROM courses LIMIT 1\")\ndb.Select(&amp;courses, \"SELECT name AS course_name FROM courses\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 1301604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04bbf2a1f17d743df5d8fe96d149e22?s=128&d=identicon&r=PG", "display_name": "evocatus", "link": "https://stackoverflow.com/users/1301604/evocatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1499513894, "creation_date": 1499513894, "answer_id": 44985803, "question_id": 44985354, "link": "https://stackoverflow.com/questions/44985354/sqlx-missing-destination-name-for-struct-tag-through-pointer/44985803#44985803", "title": "Sqlx &quot;missing destination name&quot; for struct tag through pointer", "body": "<p>I changed <code>Course *Course</code> to <code>Course Course</code> - no effect.\nWhen i made it embedded like this:</p>\n\n<pre><code>type Group struct {\n    Course\n}\n</code></pre>\n\n<p>it worked.</p>\n\n<p>This is also valid:</p>\n\n<pre><code>type Group struct {\n    *Course\n}\n</code></pre>\n\n<p>Looks like sqlx doesn't understand anything except embedded fields.</p>\n"}, {"tags": [], "owner": {"reputation": 703, "user_id": 3521313, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/MqjzI.jpg?s=128&g=1", "display_name": "transistor", "link": "https://stackoverflow.com/users/3521313/transistor"}, "is_accepted": false, "score": 0, "last_activity_date": 1524673611, "creation_date": 1524673611, "answer_id": 50027116, "question_id": 44985354, "link": "https://stackoverflow.com/questions/44985354/sqlx-missing-destination-name-for-struct-tag-through-pointer/50027116#50027116", "title": "Sqlx &quot;missing destination name&quot; for struct tag through pointer", "body": "<p>Ok, so when you are using an embbeded struct with Sqlx, capitalization is important, at least in my case.</p>\n\n<p>You need to refer to the embedded struct in your sql, like so:</p>\n\n<p><code>select name as \"course.name\" from courses...</code> </p>\n\n<p>Notice that <code>course</code> is lower case and the naming involves a dot/period between table and column.</p>\n\n<p>Then your <code>Get</code> or <code>Select</code> should work just fine.</p>\n"}], "owner": {"reputation": 53, "user_id": 1301604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04bbf2a1f17d743df5d8fe96d149e22?s=128&d=identicon&r=PG", "display_name": "evocatus", "link": "https://stackoverflow.com/users/1301604/evocatus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5216, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1524673611, "creation_date": 1499510992, "last_edit_date": 1499512043, "question_id": 44985354, "link": "https://stackoverflow.com/questions/44985354/sqlx-missing-destination-name-for-struct-tag-through-pointer", "title": "Sqlx &quot;missing destination name&quot; for struct tag through pointer", "body": "<p>I have a model like this:</p>\n\n<pre><code>type Course struct {\n    Name string `db:\"course_name\"`\n}\n\ntype Group struct {\n    Course *Course\n}\ntype Groups []Group\n</code></pre>\n\n<p>And when i try to do sqlx.Select for Groups with a query like this:</p>\n\n<pre><code>SELECT c.name as course_name FROM courses as c;\n</code></pre>\n\n<p>I get </p>\n\n<blockquote>\n  <p>missing destination name course_name in *main.Groups</p>\n</blockquote>\n\n<p>error.</p>\n\n<p>What is the issue with this code?</p>\n"}, {"tags": ["multithreading", "go", "language-agnostic", "erlang", "programming-languages"], "comments": [{"owner": {"reputation": 1545, "user_id": 7224387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa13974745b28e1b639150f0808c6689?s=128&d=identicon&r=PG", "display_name": "Pouriya", "link": "https://stackoverflow.com/users/7224387/pouriya"}, "edited": false, "score": 0, "creation_date": 1499498274, "post_id": 44982392, "comment_id": 76942035, "body": "Rust uses the actor model of Erlang and Rust is faster than Go. <a href=\"https://doc.rust-lang.org/book/second-edition/ch16-00-concurrency.html\" rel=\"nofollow noreferrer\">doc.rust-lang.org/book/second-edition/ch16-00-concurrency.ht&zwnj;&#8203;ml</a>"}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1499770911, "post_id": 44982392, "comment_id": 77038849, "body": "Other related languages include Occam and Limbo."}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1499771443, "post_id": 44982392, "comment_id": 77039206, "body": "There are performance issues and there are abstraction &amp; correctness issues. Different people will have different views on this. IMO, the use of coroutines / goroutines / occam processes etc is an easier abstraction to use when writing code that describes concurrent behaviour than the mainstream reactive / callback-driven alternative. Often, the performance of lightweight threads is less good than the mainstream (which might be bluntly described as hand-rolled approach using OS threads). But sometimes the reverse is true if parallel execution occurs efficiently. /Just my opinion/."}, {"owner": {"reputation": 12283, "user_id": 200783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6b938dc4205cd0cea4e4e68451c42a21?s=128&d=identicon&r=PG", "display_name": "user200783", "link": "https://stackoverflow.com/users/200783/user200783"}, "edited": false, "score": 0, "creation_date": 1499858409, "post_id": 44982392, "comment_id": 77085500, "body": "Because this question was closed on Stack Overflow, I have asked it again <a href=\"https://www.reddit.com/r/ProgrammingLanguages/comments/6mm4v1/what_are_the_disadvantages_of_an_mn_threading/?ref=share&amp;ref_source=link\" rel=\"nofollow noreferrer\">here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3287, "user_id": 2898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/ancqg.jpg?s=128&g=1", "display_name": "Krzysztof Kowalczyk", "link": "https://stackoverflow.com/users/2898/krzysztof-kowalczyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1499494853, "creation_date": 1499494853, "answer_id": 44983191, "question_id": 44982392, "link": "https://stackoverflow.com/questions/44982392/what-are-the-disadvantages-of-an-mn-threading-model-e-g-goroutines/44983191#44983191", "title": "What are the disadvantages of an M:N threading model (e.g. goroutines)?", "body": "<p>Partly it's because \"it's what everyone else is doing\". While M:N threading did exist before Go, all mainstream languages (C, C++, Perl, Java, C#, Python, Ruby, PHP) used threads, and many of them (Python, Ruby) did that poorly. Go is the first popular language that shows M:N threading can work well.</p>\n\n<p>Partly it's because threads are the native primitive of the OS. </p>\n\n<p>Implementing M:N threading makes interop with OS code/C libraries harder and a bit slower. When calling C/OS code, Go has to switch from small goroutine stack to regular OS stack.</p>\n\n<p>Many other popular languages (Python, Ruby) rely more heavily on ability to call C code than Go so it's more important for them to optimize for that.</p>\n\n<p>Good M:N threading interop with OS/C code is not impossible (Go does that decently) but it's easier to do if you do what OS does.</p>\n"}], "owner": {"reputation": 12283, "user_id": 200783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6b938dc4205cd0cea4e4e68451c42a21?s=128&d=identicon&r=PG", "display_name": "user200783", "link": "https://stackoverflow.com/users/200783/user200783"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 932, "favorite_count": 4, "closed_date": 1499510537, "answer_count": 1, "score": 9, "last_activity_date": 1499494853, "creation_date": 1499486853, "question_id": 44982392, "link": "https://stackoverflow.com/questions/44982392/what-are-the-disadvantages-of-an-mn-threading-model-e-g-goroutines", "closed_reason": "Opinion-based", "title": "What are the disadvantages of an M:N threading model (e.g. goroutines)?", "body": "<p><a href=\"https://en.wikipedia.org/wiki/Thread_(computing)#M:N_.28hybrid_threading.29\" rel=\"noreferrer\">M:N threading</a> is a model which maps M user threads onto N kernel threads. This enables a large number (M) of user threads to be created, due to their light weight, which still allowing (N-way) parallelism.</p>\n\n<p>This seems like a win-win to me, so why do so few languages/implementations use this threading model? The only examples I am aware of are Go's \"goroutines\" and Erlang's processes.</p>\n\n<p>What are the disadvantages of M:N threading? Why do other languages not use this threading model that, on the surface, seems so promising?</p>\n"}, {"tags": ["json", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1499470912, "post_id": 44980953, "comment_id": 76937462, "body": "Did you try <a href=\"https://golang.org/pkg/builtin/#append\" rel=\"nofollow noreferrer\">append</a>?"}, {"owner": {"reputation": 873, "user_id": 4509355, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/31648f80ef66006febaecde7c76b7319?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Roy", "link": "https://stackoverflow.com/users/4509355/nishant-roy"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1499471130, "post_id": 44980953, "comment_id": 76937512, "body": "Do I need to make a temp slice to append though? B/c <code>Unmarshal</code> doesn&#39;t return anything, so can&#39;t append that."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1499471283, "post_id": 44980953, "comment_id": 76937539, "body": "You unmarshal the file into you struct value, then append the struct to the slice, after the loop is done you return the slice."}, {"owner": {"reputation": 873, "user_id": 4509355, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/31648f80ef66006febaecde7c76b7319?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Roy", "link": "https://stackoverflow.com/users/4509355/nishant-roy"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1499471430, "post_id": 44980953, "comment_id": 76937573, "body": "The file gets unmarshalled to a struct slice. I guess I need to just create a temp slice and append that to the main slice"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1499471667, "post_id": 44980953, "comment_id": 76937627, "body": "Can you show some code? Why are you unmarshaling directly into a slice? Is the content of the file in <code>[{ ... }]</code> format? Or is there some other reason?"}, {"owner": {"reputation": 873, "user_id": 4509355, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/31648f80ef66006febaecde7c76b7319?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Roy", "link": "https://stackoverflow.com/users/4509355/nishant-roy"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1499471718, "post_id": 44980953, "comment_id": 76937636, "body": "Yes the content of the file is in <code>[{....}]</code> format, which is why I&#39;m unmarshaling into a slice"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1499472091, "post_id": 44980953, "comment_id": 76937722, "body": "Then either append that slice <i>into</i> the final array which would result in a two dimensional array <code>[][]T</code>, or append only the 0th element of the unmarshaled slice if you know that only one element was unmarshaled, or &quot;unpack&quot; the unmarshaled slice... like so: <a href=\"https://play.golang.org/p/6SSLqD4-LF\" rel=\"nofollow noreferrer\">play.golang.org/p/6SSLqD4-LF</a>"}], "answers": [{"comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1499472648, "post_id": 44981225, "comment_id": 76937816, "body": "Please note there&#39;s no point in looping over <code>tmpRecords</code> as this <code>slice = append(slice, anotherSlice...)</code> does the same."}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 1, "last_activity_date": 1499473007, "last_edit_date": 1499473007, "creation_date": 1499472488, "answer_id": 44981225, "question_id": 44980953, "link": "https://stackoverflow.com/questions/44980953/unmarshal-and-append-to-array-go/44981225#44981225", "title": "Unmarshal and append to array go", "body": "<p>Yes, you should create a temporary array to Unmarshal the contents of each JSON, then append the items to your final result array in order to return the whole collection as one item.</p>\n\n<p>See here an example of doing that.</p>\n\n<p>In your case <code>input</code> would come from each of the S3 files you mention. Also, you would probably put that unmarshal logic in its own function to be able to call it for each input JSON.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n)\n\ntype Record struct {\n    Author string `json:\"author\"`\n    Title  string `json:\"title\"`\n}\n\nfunc main() {\n    var allRecords []Record\n\n    input := []byte(`[{\n      \"author\": \"Nirvana\",\n      \"title\":  \"Smells like teen spirit\"\n    }, {\n      \"author\": \"The Beatles\",\n      \"title\":  \"Help\"\n    }]`)\n\n    var tmpRecords []Record\n    err := json.Unmarshal(input, &amp;tmpRecords)\n    if (err != nil) {\n        log.Fatal(err)\n    }\n\n    allRecords = append(allRecords, tmpRecords...)  \n\n    fmt.Println(\"RECORDS:\", allRecords)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ZZGhy4UNhP\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ZZGhy4UNhP</a></p>\n"}], "owner": {"reputation": 873, "user_id": 4509355, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/31648f80ef66006febaecde7c76b7319?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Roy", "link": "https://stackoverflow.com/users/4509355/nishant-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4794, "favorite_count": 0, "accepted_answer_id": 44981225, "answer_count": 1, "score": 2, "last_activity_date": 1499473007, "creation_date": 1499469810, "question_id": 44980953, "link": "https://stackoverflow.com/questions/44980953/unmarshal-and-append-to-array-go", "title": "Unmarshal and append to array go", "body": "<p>I'm reading a number of JSON files from S3, and want to return them all as one large JSON array. I have a struct matching my JSON data, and a for loop iterating over all objects in my s3 bucket. Each time I read, I unmarshal to my struct array. I want to append to my struct array so that I can get all the JSON data rather than just one file's data. Is there anyway to do this in Golang?</p>\n"}, {"tags": ["go", "amazon-s3"], "answers": [{"comments": [{"owner": {"reputation": 913, "user_id": 5551912, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4ed9452605a562b6865a5527f92173a0?s=128&d=identicon&r=PG&f=1", "display_name": "Rome Torres", "link": "https://stackoverflow.com/users/5551912/rome-torres"}, "edited": false, "score": 0, "creation_date": 1499532115, "post_id": 44981208, "comment_id": 76951691, "body": "Thanks a lot for the tips very helpful will implement your suggestions."}, {"owner": {"reputation": 913, "user_id": 5551912, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4ed9452605a562b6865a5527f92173a0?s=128&d=identicon&r=PG&f=1", "display_name": "Rome Torres", "link": "https://stackoverflow.com/users/5551912/rome-torres"}, "edited": false, "score": 0, "creation_date": 1499539889, "post_id": 44981208, "comment_id": 76954054, "body": "Hey I have as question, that code above is used on a backend but assuming I had 1,000 users all uploading different images wouldn&#39;t Goroutines with wait.Sync improve performance ? I am still quite new to Golang."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 913, "user_id": 5551912, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4ed9452605a562b6865a5527f92173a0?s=128&d=identicon&r=PG&f=1", "display_name": "Rome Torres", "link": "https://stackoverflow.com/users/5551912/rome-torres"}, "edited": false, "score": 0, "creation_date": 1499541823, "post_id": 44981208, "comment_id": 76954658, "body": "In Go <code>http.Server</code> executes each request in goroutine, you do not need wait.sync currently. Let&#39;s say you have more then one activity to perform independently for each request, then use goroutine with sync.waitgroup."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 4, "last_activity_date": 1499472308, "creation_date": 1499472308, "answer_id": 44981208, "question_id": 44980906, "link": "https://stackoverflow.com/questions/44980906/golang-amazon-s3-how-can-i-upload-images-faster/44981208#44981208", "title": "Golang amazon s3 how can I upload images faster", "body": "<p><code>Improving speed?</code> this is subjective one; depends on many factors such as server uplink, client uplink, etc.</p>\n\n<p><strong>Instead, I will provide my inputs to improve your code snippets:</strong></p>\n\n<ul>\n<li>Let's start with <code>sync.WaitGroup</code> - I do not see a benefit as per your code flow, you just create and wait for goroutine to complete. Instead use without WaitGroup. <code>Tip:</code> Do not use feature for sake/buzz; use it when needed.</li>\n<li>Do not create multiple <code>bytes.Buffer</code> and <code>Reader</code>, when you can accomplish without it. For e.g. getting fileSize after the resize, just do <code>buf.Len()</code>.</li>\n<li>If you want to offload the AWS upload then extract upload code part into separate <code>func</code> and call it as goroutine.</li>\n</ul>\n\n<p><strong>I have updated your code snippet (I have not tested your code, so please fix/improve it as required):</strong></p>\n\n<pre><code>func UploadStreamImage(w http.ResponseWriter, r *http.Request) {\n    file, handler, err := r.FormFile(\"file\")\n    if err != nil {\n        log_errors(\" error on upload\", err.Error(), w)\n        fmt.Println(\"Error Uploading Image\")\n        return\n    }\n    defer file.Close()\n\n    // Suggestion: You can calculate the file size from bytes.\n    // instead getting it from form; since after resize image will change\n    imgSize, err := strconv.Atoi(r.FormValue(\"imgsize\"))\n    if err != nil {\n        println(\"Error converting to integer\")\n        log_errors(\"Error converting to integer\", err.Error(), w)\n        return\n    }\n\n    img, err := imaging.Decode(file)\n    if err != nil {\n        print(\"Imaging Open error\")\n        log_errors(\"Error decoding\", err.Error(), w)\n        return\n    }\n\n    b := img.Bounds()\n    heightImg := b.Max.Y\n    widthImg := b.Max.X\n\n    // resize image\n    height := int(float64(heightImg) * .23)\n    width := int(float64(widthImg) * .23)\n\n    if imgSize &lt; 401 {\n        height = int(float64(heightImg) * 1)\n        width = int(float64(widthImg) * 1)\n\n    } else if imgSize &gt;= 401 &amp;&amp; imgSize &lt; 900 {\n        height = int(float64(heightImg) * .68)\n        width = int(float64(widthImg) * .68)\n        println(\"Middle Image\")\n    } else if imgSize &gt;= 900 &amp;&amp; imgSize &lt; 1300 {\n        height = int(float64(heightImg) * .45)\n        width = int(float64(widthImg) * .45)\n    } else if imgSize &gt;= 1301 &amp;&amp; imgSize &lt; 1700 {\n        height = int(float64(heightImg) * .40)\n        width = int(float64(widthImg) * .40)\n    }\n\n    new_img := imaging.Resize(img, width, height, imaging.Lanczos)\n    // end resize\n\n    var buf bytes.Buffer\n    err = imaging.Encode(&amp;buf, new_img, imaging.JPEG)\n    if err != nil {\n        log.Println(err)\n        log_errors(\" error encoding file\", err.Error(), w)\n        return\n    }\n\n    fileType := http.DetectContentType(buf.Bytes())\n    fileSize := buf.Len()\n    path := handler.Filename\n    params := &amp;s3.PutObjectInput{\n        Bucket: aws.String(\"bucket name\"),\n        Key:    aws.String(path),\n        Body:   bytes.NewReader(buf.Bytes()),\n\n        ContentLength: aws.Int64(fileSize),\n        ContentType:   aws.String(fileType),\n    }\n\n    resp, err := svc.PutObject(params)\n    if err != nil {\n        fmt.Printf(\"bad response: %s\", err)\n        log_errors(\"error in putObject\", err.Error(), w)\n        return\n    }\n\n    fmt.Println(\"Done\", resp)\n}\n</code></pre>\n"}], "owner": {"reputation": 913, "user_id": 5551912, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4ed9452605a562b6865a5527f92173a0?s=128&d=identicon&r=PG&f=1", "display_name": "Rome Torres", "link": "https://stackoverflow.com/users/5551912/rome-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1603, "favorite_count": 1, "accepted_answer_id": 44981208, "answer_count": 1, "score": 2, "last_activity_date": 1499472308, "creation_date": 1499469246, "question_id": 44980906, "link": "https://stackoverflow.com/questions/44980906/golang-amazon-s3-how-can-i-upload-images-faster", "title": "Golang amazon s3 how can I upload images faster", "body": "<p>I have some images that I am uploading to my s3 account using the official amazon s3 package . My images are typically around 250 - 350 KB so small images, however they take around 8 or 9 seconds to upload which seems excessive any suggestions on improving speed would be great. This is my code and if I take the resizing image code off it still takes a good 8 or 9 seconds still .</p>\n\n<pre><code>      func UploadStreamImage(w http.ResponseWriter, r *http.Request) {\n\n\n          r.ParseForm()\n    var buff bytes.Buffer\n\n\n    wg := sync.WaitGroup{}\n\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n\n        var buf bytes.Buffer\n        sess, _ := session.NewSession(&amp;aws.Config{\n            Region:      aws.String(\"us-west-2\"),\n            Credentials: credentials.NewStaticCredentials(aws_access_key_id, aws_secret_access_key, \"\"),\n\n        })\n\n        svc := s3.New(sess)\n\n        file, handler, err := r.FormFile(\"file\")\n        if err != nil {\n            log_errors(\" error on upload\",err.Error(),w)\n            fmt.Println(\"Error Uploading Image\")\n            return\n        }\n        defer file.Close()\n\n        img,err := imaging.Decode(file)\n        if err != nil {\n            print(\"Imaging Open error\")\n            log_errors(\"Error decoding\",err.Error(),w)\n            return\n        }\n\n                imgSize,err := strconv.Atoi(r.FormValue(\"imgsize\"))\n\n        if err != nil {\n            println(\"Error converting to integer\")\n            log_errors(\"Error converting to integer\",err.Error(),w)\n            return\n        }\n\n        b := img.Bounds()\n        heightImg := b.Max.Y\n        widthImg := b.Max.X\n\n\n        // resize image\n        height := int(float64(heightImg) * .23)\n        width := int(float64(widthImg) * .23)\n\n\n        if imgSize &lt; 401 {\n            height = int(float64(heightImg) * 1)\n            width = int(float64(widthImg) * 1)\n\n        } else if imgSize  &gt;= 401 &amp;&amp; imgSize &lt; 900 {\n               height = int(float64(heightImg) * .68)\n               width = int(float64(widthImg) * .68)\n               println(\"Middle Image\")\n                  } else if  imgSize  &gt;= 900 &amp;&amp; imgSize &lt; 1300 {\n            height = int(float64(heightImg) * .45)\n            width = int(float64(widthImg) * .45)\n           } else if  imgSize  &gt;= 1301 &amp;&amp; imgSize &lt; 1700 {\n            height = int(float64(heightImg) * .40)\n            width = int(float64(widthImg) * .40)\n        } \n\n\n        new_img := imaging.Resize(img,width,height, imaging.Lanczos)\n       // end resize\n\n        err = imaging.Encode(&amp;buf,new_img, imaging.JPEG)\n        if err != nil {\n            log.Println(err)\n            log_errors(\" error encoding file\",err.Error(),w)\n                        return\n        }\n\n\n        r := bytes.NewReader(buf.Bytes())\n\n\n\n        read_file,err := ioutil.ReadAll(r)\n        if err != nil {\n            fmt.Println(\"Error Reading file\")\n            log_errors(\" error reading file\",err.Error(),w)\n            return\n\n        }\n\n\n\n\n        file.Read(read_file)\n        fileBytes := bytes.NewReader(read_file)\n        fileSize, err := buff.ReadFrom(fileBytes)\n        if err != nil {\n            log_errors(\" error fileSize\",err.Error(),w)\n            return\n        }\n        fileType := http.DetectContentType(read_file)\n        path := handler.Filename\n        params := &amp;s3.PutObjectInput{\n            Bucket: aws.String(\"bucket name\"),\n            Key: aws.String(path),\n            Body: fileBytes,\n\n            ContentLength: aws.Int64(fileSize),\n            ContentType: aws.String(fileType),\n        }\n\n        resp, err := svc.PutObject(params)\n        if err != nil {\n            fmt.Printf(\"bad response: %s\", err)\n            log_errors(\"error in putObject\",err.Error(),w)\n            return\n        }\n\n        fmt.Println(w,\"Done\")\n\n\n    }()\n    wg.Wait()\n\n}\n</code></pre>\n"}]