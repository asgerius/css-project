[{"tags": ["database", "go", "nosql", "iot", "in-memory"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1544051878, "post_id": 53642122, "comment_id": 94143875, "body": "That project doesn&#39;t work like a normal Go package, and requires adding another directory to <code>GOPATH</code>, which it doesn&#39;t look like you&#39;ve done. Also, I would tend to avoid packages that require <code>cgocheck=0</code> in production."}, {"owner": {"reputation": 50, "user_id": 10565600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52f8ba065fdcf16cb1405d565bef78c?s=128&d=identicon&r=PG&f=1", "display_name": "Gopheritis", "link": "https://stackoverflow.com/users/10565600/gopheritis"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1544711220, "post_id": 53642122, "comment_id": 94379686, "body": "@JimB Thank you. This was it. I was able to work around it by putting the Go Client in another directory and adding that directory into my Go PATH"}], "owner": {"reputation": 50, "user_id": 10565600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52f8ba065fdcf16cb1405d565bef78c?s=128&d=identicon&r=PG&f=1", "display_name": "Gopheritis", "link": "https://stackoverflow.com/users/10565600/gopheritis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1544079567, "creation_date": 1544050984, "last_edit_date": 1544079567, "question_id": 53642122, "link": "https://stackoverflow.com/questions/53642122/the-griddb-go-client-is-not-letting-me-build-my-project", "title": "The GridDB Go client is not letting me build my project", "body": "<p>I'm trying to test the GridDB Go client with just a simple creation of a users container on my test website. My issue is I keep getting the following error:</p>\n\n<pre><code>main.go:28:2: no Go files in /home/gopheritis/go/src/github.com/griddb/go_client\n</code></pre>\n\n<p>Here's my Go env... everything is normal and works:</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"/home/gopheritis/go/bin\"\nGOCACHE=\"/home/gopheritis/.cache/go-build\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/gopheritis/go\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTMPDIR=\"\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\"\nGCCGO=\"gccgo\"\nCC=\"gcc\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\nPKG_CONFIG=\"pkg-config\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build238154447=/tmp/go-build -gno-record-gcc-switches\"\n</code></pre>\n\n<p>I was following along with the instructions and they mentioned running </p>\n\n<pre><code>export GODEBUG=cgocheck=0 \n</code></pre>\n\n<p>which I already did. I'm obviously missing something else, but what can it be?</p>\n"}, {"tags": ["dictionary", "go"], "answers": [{"tags": [], "owner": {"reputation": 9542, "user_id": 8068625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4spqa.png?s=128&g=1", "display_name": "Henry Woody", "link": "https://stackoverflow.com/users/8068625/henry-woody"}, "is_accepted": true, "score": 0, "last_activity_date": 1544050512, "creation_date": 1544050512, "answer_id": 53642036, "question_id": 53641914, "link": "https://stackoverflow.com/questions/53641914/how-to-find-out-if-mapstringint-has-a-value/53642036#53642036", "title": "How to find out if &#39;map[string][][]int&#39; has a value", "body": "<p>You'll have to iterate over the contents of your map to check whether an element is contained in that map or not.</p>\n\n<p>For example:</p>\n\n<pre><code>target := []int{30, 30}\n\nfor _, v := range myMap {\n    for _, sub := range v {\n        if len(sub) == len(target) &amp;&amp; sub[0] == target[0] &amp;&amp; sub[1] == target[1] {\n            fmt.Println(\"yeah\")\n        }\n    }\n}\n</code></pre>\n\n<p>With <code>myMap</code> as <code>aa</code> you'll get no output, and with <code>myMap</code> as <code>bb</code> you'll get \"Yeah\" printed.</p>\n\n<p>If your inner-most slices get longer, you should do the check step as a loop as well instead of hard-coded like that.</p>\n"}, {"tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 0, "last_activity_date": 1544050580, "creation_date": 1544050580, "answer_id": 53642047, "question_id": 53641914, "link": "https://stackoverflow.com/questions/53641914/how-to-find-out-if-mapstringint-has-a-value/53642047#53642047", "title": "How to find out if &#39;map[string][][]int&#39; has a value", "body": "<p>Maps are only indexed by key. This means its cheap and easy (ideally constant time complexity) to find <code>a</code> or <code>b</code>, but its harder to look for a value (linear time complexity).</p>\n\n<p>Therefore, it's a few for loops:</p>\n\n<pre><code>func find(searchFor [][]int, m map[string][][]int) bool {\n  for _, v := range m {\n    if sliceEq(v, searchFor) {\n      return true\n    }\n  }\n\n  return false\n}\n\nfunc sliceEq(a, b [][]int) bool {\n  if len(a) != len(b) {\n    return false\n  }\n\n  for i := range a {\n    if a[i] != b[i] {\n      return false\n    }\n  }\n\n  return true\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9319777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26a22815bdb60d74afe306b7ab3232f?s=128&d=identicon&r=PG&f=1", "display_name": "gdk", "link": "https://stackoverflow.com/users/9319777/gdk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 2, "accepted_answer_id": 53642036, "answer_count": 2, "score": -2, "last_activity_date": 1544079656, "creation_date": 1544049898, "last_edit_date": 1544079656, "question_id": 53641914, "link": "https://stackoverflow.com/questions/53641914/how-to-find-out-if-mapstringint-has-a-value", "title": "How to find out if &#39;map[string][][]int&#39; has a value", "body": "<p>Given this code:</p>\n\n<pre><code>var a map[string][][]int\n\nvar aa map[string][][]int = map[string][][]int{\"a\": [][]int{{10, 10}, {20, 20}}}\nvar bb map[string][][]int = map[string][][]int{\"b\": [][]int{{30, 30}, {40, 40}}}\n\nfmt.Println(aa) // &gt;&gt; map[a:[[10 10] [20 20]] b:[[30 30] [40 40]]]\n</code></pre>\n\n<p>how do I know if '[30, 30]' is in 'aa'?</p>\n\n<p>I want to check, whether 'aa' has '[30 30]'.</p>\n"}, {"tags": ["go", "kubernetes"], "comments": [{"owner": {"reputation": 130, "user_id": 4198317, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Rc0Ik1yNrzA/AAAAAAAAAAI/AAAAAAAACIE/eIlf5bdUeIQ/photo.jpg?sz=128", "display_name": "St&#233;phane Jeandeaux", "link": "https://stackoverflow.com/users/4198317/st%c3%a9phane-jeandeaux"}, "edited": false, "score": 2, "creation_date": 1544045847, "post_id": 53638778, "comment_id": 94141808, "body": "Hi, have you tried to get the error? <code>jobEvents, myWonderfulError :</code>"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1544084754, "post_id": 53638778, "comment_id": 94152854, "body": "no, this is not the right way. You silence the error. <code>jobEvents, _ := clientset.Evente...</code> -&gt; <code>jobEvents, err := clientset.Event... \\n if err != nil{&#47;&#47;handle}</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "edited": false, "score": 0, "creation_date": 1544090796, "post_id": 53647055, "comment_id": 94156109, "body": "any particular reason for down vote? It will help to improve answer."}, {"owner": {"reputation": 362, "user_id": 3437018, "user_type": "registered", "profile_image": "https://graph.facebook.com/514701902/picture?type=large", "display_name": "lawrencegripper", "link": "https://stackoverflow.com/users/3437018/lawrencegripper"}, "edited": false, "score": 1, "creation_date": 1580158662, "post_id": 53647055, "comment_id": 105998933, "body": "Thanks for the pointer that did the trick for me, moving to corev1  <code>events, err := clientset.CoreV1().Events(namespace).List(metav1.ListOptions&zwnj;&#8203;{ \t\t\t   FieldSelector: fmt.Sprintf(&quot;involvedObject.name=%s,involvedObject.namespace&zwnj;&#8203;=%s&quot;, item.Name, item.Namespace), \t\t\t})</code>"}], "tags": [], "owner": {"reputation": 2165, "user_id": 3427852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1390962419/picture?type=large", "display_name": "Abu Hanifa", "link": "https://stackoverflow.com/users/3427852/abu-hanifa"}, "is_accepted": false, "score": 1, "last_activity_date": 1544088895, "last_edit_date": 1544088895, "creation_date": 1544083786, "answer_id": 53647055, "question_id": 53638778, "link": "https://stackoverflow.com/questions/53638778/kubernetes-go-client-list-events/53647055#53647055", "title": "Kubernetes go client: list events", "body": "<p>If you print error return by <code>List</code>, you should get error something like <code>\"involvedObject.name\" is not a known field selector: only \"metadata.name\", \"metadata.namespace\"</code></p>\n\n<p>use <code>CoreV1</code> instead of <code>EventsV1beta1</code></p>\n\n<p>The line will be something like below:</p>\n\n<p><code>jobEvents, _ := clientset.CoreV1().Events(GetNamespace()).List(eventListOptions)</code></p>\n\n<hr>\n\n<p><code>\"involvedObject.name\", job.Name</code> isn't supported by <code>EventsV1beta1</code></p>\n\n<p>Hope it'll help.</p>\n"}], "owner": {"reputation": 470, "user_id": 2331089, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/758cee5a720d8e644a7a047386e4b998?s=128&d=identicon&r=PG&f=1", "display_name": "bianchi", "link": "https://stackoverflow.com/users/2331089/bianchi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 541, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544088895, "creation_date": 1544035295, "question_id": 53638778, "link": "https://stackoverflow.com/questions/53638778/kubernetes-go-client-list-events", "title": "Kubernetes go client: list events", "body": "<p>I am trying to get a list of events in the namespace, but with or without FieldSelector I get an empty list. Is this the right way to do it?</p>\n\n<pre><code>            eventListOptions := metav1.ListOptions{FieldSelector: fields.OneTermEqualSelector(\"involvedObject.name\", job.Name).String()}\n            jobEvents, _ := clientset.EventsV1beta1().Events(GetNamespace()).List(eventListOptions)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1544035728, "post_id": 53638636, "comment_id": 94137344, "body": "Normally you know what you want to call, so you don&#39;t need to &quot;expose all functions that are set on the given struct&quot;. You&#39;re not calling any methods in your example, but the <code>plugin</code> docs show how to assert various types in the examples there."}, {"owner": {"reputation": 3068, "user_id": 999017, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/05ae53ec79c0a066cf21cea1a8e2a8c8?s=128&d=identicon&r=PG", "display_name": "eithed", "link": "https://stackoverflow.com/users/999017/eithed"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1544090466, "post_id": 53638636, "comment_id": 94155930, "body": "@JimB - I don&#39;t understand what do you mean. How can I call the <code>GetId</code> function that is created within this plugin? I don&#39;t see that within the <code>plugin</code> docs."}], "answers": [{"comments": [{"owner": {"reputation": 3068, "user_id": 999017, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/05ae53ec79c0a066cf21cea1a8e2a8c8?s=128&d=identicon&r=PG", "display_name": "eithed", "link": "https://stackoverflow.com/users/999017/eithed"}, "edited": false, "score": 0, "creation_date": 1544106755, "post_id": 53652744, "comment_id": 94165711, "body": "So, in my main program I&#39;ll still have to create an interface that is a reflection of the struct defined within the plugin (or at least the part that I&#39;ll be using) and then cast given looked-up variable to a type defined within my main program. I&#39;ve read <code>export</code> in the docs to mean that I&#39;ll have access to all methods defined for given struct, which is sadly not the case. Thank you very much - your example did help"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3068, "user_id": 999017, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/05ae53ec79c0a066cf21cea1a8e2a8c8?s=128&d=identicon&r=PG", "display_name": "eithed", "link": "https://stackoverflow.com/users/999017/eithed"}, "edited": false, "score": 0, "creation_date": 1544106911, "post_id": 53652744, "comment_id": 94165821, "body": "@eithed, you do have access to the methods, otherwise this type assertion wouldn&#39;t work at all. <code>Lookup</code> however has no way of knowing what you expect it to return, so you need to put the type assertion in there in order to use the value."}, {"owner": {"reputation": 3068, "user_id": 999017, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/05ae53ec79c0a066cf21cea1a8e2a8c8?s=128&d=identicon&r=PG", "display_name": "eithed", "link": "https://stackoverflow.com/users/999017/eithed"}, "edited": false, "score": 0, "creation_date": 1544109234, "post_id": 53652744, "comment_id": 94167309, "body": "I think of it the other way round - I don&#39;t have access to the methods until I cast given object to a type defined within my main app that exposes them; still there&#39;s a knowledge about what the given type given thing is, as when I do <code>reflect.TypeOf(s)</code> I do indeed get correct type (<code>*main.Test</code>); I simply would like to have access to that type, rather than doing a cast"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1544103650, "creation_date": 1544103650, "answer_id": 53652744, "question_id": 53638636, "link": "https://stackoverflow.com/questions/53638636/calling-function-of-a-struct-imported-via-plugin/53652744#53652744", "title": "Calling function of a struct imported via plugin", "body": "<p><a href=\"https://golang.org/pkg/plugin/#Plugin.Lookup\" rel=\"nofollow noreferrer\"><code>Lookup</code></a> returns a <a href=\"https://golang.org/pkg/plugin/#Symbol\" rel=\"nofollow noreferrer\"><code>Symbol</code></a>, which is just an empty interface. In order to use this you need to assert the type you want. The documentation for <code>Symbol</code> example shows both symbols asserted to the expected types:</p>\n\n<pre><code>v, err := p.Lookup(\"V\")\nif err != nil {\n    panic(err)\n}\nf, err := p.Lookup(\"F\")\nif err != nil {\n    panic(err)\n}\n*v.(*int) = 7\nf.(func())() // prints \"Hello, number 7\"\n</code></pre>\n\n<p>To do that in your program, create the type you want, which in this case is an interface because you're looking for a particular method set (see the <a href=\"https://tour.golang.org/methods/9\" rel=\"nofollow noreferrer\">\"Tour of Go\" section on interfaces</a>, esp implicit implementation and type assertion)</p>\n\n<p>Here we create the <code>V</code> interface in the main program to define the method we want, than use a type assertion on the symbol returned from <code>Lookup</code>:</p>\n\n<pre><code>type V interface {\n    GetId() string\n}\n\nfunc main() {\n    p, err := plugin.Open(\"plugin.so\")\n    if err != nil {\n        panic(err)\n    }\n\n    s, err := p.Lookup(\"V\")\n    if err != nil {\n        panic(err)\n    }\n\n    v := s.(V)\n\n    fmt.Println(v.GetId())\n}\n</code></pre>\n"}], "owner": {"reputation": 3068, "user_id": 999017, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/05ae53ec79c0a066cf21cea1a8e2a8c8?s=128&d=identicon&r=PG", "display_name": "eithed", "link": "https://stackoverflow.com/users/999017/eithed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 53652744, "answer_count": 1, "score": -1, "last_activity_date": 1544103650, "creation_date": 1544034743, "question_id": 53638636, "link": "https://stackoverflow.com/questions/53638636/calling-function-of-a-struct-imported-via-plugin", "title": "Calling function of a struct imported via plugin", "body": "<p>I've a following plugin:</p>\n\n<pre><code>package main\n\ntype Test struct {\n    Id string\n}\n\nfunc (test *Test) GetId() string {\n    return test.Id\n}\n\nvar V Test\n</code></pre>\n\n<p>I'm importing it within my app:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"plugin\"\n)\n\nfunc main() {\n    p, err := plugin.Open(\"test.so\")\n    if err != nil {\n        panic(err)\n    }\n    v, err := p.Lookup(\"V\")\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(v)\n}\n</code></pre>\n\n<p>Unfortunately I'm not able to call <code>v.getId()</code> on it - is there a way to expose all functions that are set on the given struct?</p>\n"}, {"tags": ["go", "glide-golang"], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 0, "last_activity_date": 1544046291, "creation_date": 1544046291, "answer_id": 53641203, "question_id": 53638619, "link": "https://stackoverflow.com/questions/53638619/can-we-parameterize-a-glide-yaml-file/53641203#53641203", "title": "Can we parameterize a glide.yaml file?", "body": "<p>No. This is not supported. You can see everything that <em>is</em> supported in the glide.yaml file in the <a href=\"https://glide.readthedocs.io/en/latest/glide.yaml/\" rel=\"nofollow noreferrer\">official documentation</a>.</p>\n"}], "owner": {"reputation": 93, "user_id": 6176095, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10206258878174930/picture?type=large", "display_name": "Hemant Pandey", "link": "https://stackoverflow.com/users/6176095/hemant-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553435771, "creation_date": 1544034673, "last_edit_date": 1553435771, "question_id": 53638619, "link": "https://stackoverflow.com/questions/53638619/can-we-parameterize-a-glide-yaml-file", "title": "Can we parameterize a glide.yaml file?", "body": "<p>This is the glide.yaml file from the official documentation</p>\n\n<pre><code>package: github.com/Masterminds/glide\nhomepage: https://masterminds.github.io/glide\nlicense: MIT\nowners:\n- name: Matt Butcher\n  email: technosophos@gmail.com\nhomepage: http://technosophos.com\n- name: Matt Farina\nemail: matt@mattfarina.com\nhomepage: https://www.mattfarina.com\nignore:\n- appengine\nexcludeDirs:\n- node_modules\nimport:\n- package: gopkg.in/yaml.v2\n- package: github.com/Masterminds/vcs\n  version: ^1.2.0\n  repo:    git@github.com:Masterminds/vcs\n  vcs:     git\n- package: github.com/codegangsta/cli\n  version: f89effe81c1ece9c5b0fda359ebd9cf65f169a51\n- package: github.com/Masterminds/semver\n  version: ^1.0.0\ntestImport:\n- package: github.com/arschles/assert\n</code></pre>\n\n<p>If I want to parameterize repo, like store it in a variable in a util file or in an environment variable and fetch it from there in the glide.yaml file ? Is it possible to do so ?</p>\n"}, {"tags": ["docker", "go", "docker-api"], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 5198411, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/54aed645aca50a8f117a0aff4ff45ce0?s=128&d=identicon&r=PG&f=1", "display_name": "derich", "link": "https://stackoverflow.com/users/5198411/derich"}, "edited": false, "score": 0, "creation_date": 1544095214, "post_id": 53641214, "comment_id": 94158717, "body": "Thanks for your answer, I just had to remove the <code>&lt;-</code>  right before <code>cli.Events(ctx, types.EventsOptions{})</code>"}], "tags": [], "owner": {"reputation": 130, "user_id": 4198317, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Rc0Ik1yNrzA/AAAAAAAAAAI/AAAAAAAACIE/eIlf5bdUeIQ/photo.jpg?sz=128", "display_name": "St&#233;phane Jeandeaux", "link": "https://stackoverflow.com/users/4198317/st%c3%a9phane-jeandeaux"}, "is_accepted": true, "score": 2, "last_activity_date": 1544105104, "last_edit_date": 1544105104, "creation_date": 1544046356, "answer_id": 53641214, "question_id": 53638185, "link": "https://stackoverflow.com/questions/53638185/golang-docker-api-get-events/53641214#53641214", "title": "Golang Docker API: get events", "body": "<p>There are many solutions. A solution could be:</p>\n\n<pre><code>msgs, errs := cli.Events(ctx, types.EventsOptions{})\n\nfor {\n        select {\n          case err := &lt;-errs:print(err)\n          case msg := &lt;-msgs:print(msg)\n        }\n }\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 5198411, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/54aed645aca50a8f117a0aff4ff45ce0?s=128&d=identicon&r=PG&f=1", "display_name": "derich", "link": "https://stackoverflow.com/users/5198411/derich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 718, "favorite_count": 0, "accepted_answer_id": 53641214, "answer_count": 1, "score": 0, "last_activity_date": 1544105104, "creation_date": 1544032862, "question_id": 53638185, "link": "https://stackoverflow.com/questions/53638185/golang-docker-api-get-events", "title": "Golang Docker API: get events", "body": "<p>I want to get all new events from docker via the golang integration.\nThe problem is that it returns two channels and I couldn't figure out how to subscribe to them.</p>\n\n<pre><code>cli, err := client.NewClientWithOpts(client.WithVersion(\"1.37\"))\nif err != nil {\n    panic(err)\n}\n\nctx, _ := context.WithCancel(context.Background())\n\nmsg, err := &lt;- cli.Events(ctx, types.EventsOptions{})\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 1, "creation_date": 1544020280, "post_id": 53634506, "comment_id": 94128557, "body": "This is not a good check: the difference between \u0100 (U+0100) and \u0101 (U+0101) is only 1.  Consider using, say, <a href=\"https://godoc.org/unicode#ToLower\" rel=\"nofollow noreferrer\"><code>unicode.ToLower</code></a> instead."}, {"owner": {"reputation": 32690, "user_id": 3266847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U0oyt.png?s=128&g=1", "display_name": "Benjamin W.", "link": "https://stackoverflow.com/users/3266847/benjamin-w"}, "edited": false, "score": 1, "creation_date": 1544020401, "post_id": 53634506, "comment_id": 94128661, "body": "Advent of Code, eh ;)"}, {"owner": {"reputation": 463, "user_id": 2426635, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/90350e6379ff5cda8c004a264bd6c4a5?s=128&d=identicon&r=PG", "display_name": "pwwolff", "link": "https://stackoverflow.com/users/2426635/pwwolff"}, "edited": false, "score": 0, "creation_date": 1544020457, "post_id": 53634506, "comment_id": 94128711, "body": "Yes, I am aware that this case will fail with more exotic characters. For this particular problem I know that the input will only ever be consist of ASCII (a-zA-Z) and wanted to try solving the problem like this"}, {"owner": {"reputation": 463, "user_id": 2426635, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/90350e6379ff5cda8c004a264bd6c4a5?s=128&d=identicon&r=PG", "display_name": "pwwolff", "link": "https://stackoverflow.com/users/2426635/pwwolff"}, "reply_to_user": {"reputation": 32690, "user_id": 3266847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U0oyt.png?s=128&g=1", "display_name": "Benjamin W.", "link": "https://stackoverflow.com/users/3266847/benjamin-w"}, "edited": false, "score": 0, "creation_date": 1544020469, "post_id": 53634506, "comment_id": 94128716, "body": "@BenjaminW. yes :)"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 32690, "user_id": 3266847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U0oyt.png?s=128&g=1", "display_name": "Benjamin W.", "link": "https://stackoverflow.com/users/3266847/benjamin-w"}, "edited": false, "score": 0, "creation_date": 1544020551, "post_id": 53634506, "comment_id": 94128775, "body": "@BenjaminW. AoC input is 7bit ASCII, no need to worry."}], "answers": [{"tags": [], "owner": {"reputation": 463, "user_id": 2426635, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/90350e6379ff5cda8c004a264bd6c4a5?s=128&d=identicon&r=PG", "display_name": "pwwolff", "link": "https://stackoverflow.com/users/2426635/pwwolff"}, "is_accepted": false, "score": 0, "last_activity_date": 1544021577, "creation_date": 1544021577, "answer_id": 53634988, "question_id": 53634506, "link": "https://stackoverflow.com/questions/53634506/how-to-find-the-distance-between-two-runes/53634988#53634988", "title": "How to find the distance between two runes", "body": "<p>Figured it out: the data type returned was a byte.</p>\n\n<p>Explicitly converted to int and everything works as expected.</p>\n\n<pre><code>func main() {\n    fullFile, _ := ioutil.ReadFile(\"input/input.txt\")\n    previous := 0\n    current := 0\n    for i := 1; i &lt; len(fullFile); i++ {\n        previous = int(fullFile[i-1])\n        current = int(fullFile[i])\n        println(current, previous, current-previous)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 463, "user_id": 2426635, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/90350e6379ff5cda8c004a264bd6c4a5?s=128&d=identicon&r=PG", "display_name": "pwwolff", "link": "https://stackoverflow.com/users/2426635/pwwolff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544025672, "creation_date": 1544020013, "last_edit_date": 1544025672, "question_id": 53634506, "link": "https://stackoverflow.com/questions/53634506/how-to-find-the-distance-between-two-runes", "title": "How to find the distance between two runes", "body": "<p>I'm trying to solve a couple of example programming problems to familiarize myself with the language.</p>\n\n<p>I am iterating over a string as follows:</p>\n\n<pre><code>func main() {\n    fullFile := \"abcdDefF\"\n\n    for i := 1; i &lt; len(fullFile); i++ {\n        println(fullFile[i-1], fullFile[i], fullFile[i-1]-fullFile[i])\n    }\n}\n</code></pre>\n\n<p>In the loop I want to get the difference between the current rune and the previous rune (trying to identify lower-case - upper-case pairs by finding any pairs where the difference is == 32.</p>\n\n<p>Strangely, the subtraction doesn't work properly (in fact seems to yield addition in cases where I would expect a negative number) although I would expect it to since runes are represented by int32.</p>\n"}, {"tags": ["go", "yaml", "configuration-files"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1544019205, "post_id": 53634170, "comment_id": 94127825, "body": "First of all: can you show your code and indicate what YAML library you&#39;re using? There&#39;s no YAML parser in the stdlib so I assume you have some 3rd party lib. That said, most work the same as <code>encoding&#47;json</code>, so you can define a type that only has the section you want, unmarshal into it, and you&#39;ll only have that section; rinse and repeat for as many sections as you need."}], "answers": [{"tags": [], "owner": {"reputation": 153, "user_id": 9712352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RjuEp.png?s=128&g=1", "display_name": "jxpp", "link": "https://stackoverflow.com/users/9712352/jxpp"}, "is_accepted": true, "score": 1, "last_activity_date": 1544020201, "creation_date": 1544020201, "answer_id": 53634568, "question_id": 53634170, "link": "https://stackoverflow.com/questions/53634170/load-only-one-section-from-a-yaml-config-file/53634568#53634568", "title": "Load only one section from a YAML config file", "body": "<p>The YAML specification allows to have multiple YAML documents in one file by delimiting them with <code>---</code>: <a href=\"http://yaml.org/spec/1.2/spec.html#id2760395\" rel=\"nofollow noreferrer\">http://yaml.org/spec/1.2/spec.html#id2760395</a></p>\n\n<p>You would have to check how the library you're utilizing handles this.</p>\n"}], "owner": {"reputation": 1564, "user_id": 3655841, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/b0qz3.jpg?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/3655841/ron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 0, "accepted_answer_id": 53634568, "answer_count": 1, "score": 0, "last_activity_date": 1544027345, "creation_date": 1544018813, "last_edit_date": 1544027345, "question_id": 53634170, "link": "https://stackoverflow.com/questions/53634170/load-only-one-section-from-a-yaml-config-file", "title": "Load only one section from a YAML config file", "body": "<p>I have multiple components that each of them needs to load specific definitions for it to run, I want to make one big YAML file divided into sections, that each section will belong to a different component.</p>\n\n<p>So instead of having 4 config files for 4 components I'll have one big config file that divided into sections.</p>\n\n<p>Now I want to load on each component just the relvant section from the yaml config file.</p>\n\n<p>Can I do it? and how?</p>\n\n<p>Update:</p>\n\n<p>Both answers have satisfied me (embedded YAML files in one YAML file and the other answer was to unmarshal the JSON to an object that contains only the relevant section I'm interstring in).</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1544014866, "post_id": 53632883, "comment_id": 94125233, "body": "(1) Perform the HTTP download and parsing in the <code>TestMain</code> function, then (2) write a function that calls <code>t.Skip()</code>if the test should be skipped, and invoke that from each <code>Test*</code> function. This function can get the current call stack to figure out whether the current test should be skipped."}, {"owner": {"reputation": 91, "user_id": 2917346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e6ac9f0a20380ac60576685c4eddc5?s=128&d=identicon&r=PG&f=1", "display_name": "user2917346", "link": "https://stackoverflow.com/users/2917346/user2917346"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1544055215, "post_id": 53632883, "comment_id": 94144765, "body": "@TimCooper There are thousands of test files in my case. Can I do this globally like you can in Python or PHP once? Your answer suggests I have to apply this to all of the files with no ability to implement a single solution for all of the test suite."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 2917346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e6ac9f0a20380ac60576685c4eddc5?s=128&d=identicon&r=PG&f=1", "display_name": "user2917346", "link": "https://stackoverflow.com/users/2917346/user2917346"}, "edited": false, "score": 0, "creation_date": 1544081338, "post_id": 53634371, "comment_id": 94151352, "body": "Though the above is technically correct, I won&#39;t mark this one as accepted because the spirit of my problem is that I have thousands of test files. It is not viable to add this if condition to each test. Is there some way that this can be applied to the entire test suite just once and have it apply to all of the tests? (I do very much appreciate the responses)"}, {"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "reply_to_user": {"reputation": 91, "user_id": 2917346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e6ac9f0a20380ac60576685c4eddc5?s=128&d=identicon&r=PG&f=1", "display_name": "user2917346", "link": "https://stackoverflow.com/users/2917346/user2917346"}, "edited": false, "score": 2, "creation_date": 1544100883, "post_id": 53634371, "comment_id": 94161900, "body": "You can also try &quot;-run regexp&quot; flag for go test command. You can use naming convention to group your test cases and pass regex while running the test case to execute test cases matching specific pattern. But none of these solutions will work without changing you existing test cases."}], "tags": [], "owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "is_accepted": false, "score": 5, "last_activity_date": 1544019505, "creation_date": 1544019505, "answer_id": 53634371, "question_id": 53632883, "link": "https://stackoverflow.com/questions/53632883/how-do-i-dynamically-skip-tests-in-golang/53634371#53634371", "title": "How do I dynamically skip tests in golang?", "body": "<p>You can skip test cases with (*testing.T).Skip() function. You can download the test file in the init function of go's test file. Then parse and load the function names in map or array. Before running each case, check if the test case is included in the skip list and skip if required.</p>\n\n<pre><code>// Psuedo code -&gt; foo_test.go\nvar skipCases map[string]bool\n\nfunc init() {\n    // download and parse test file.\n    // add test case names which needs skipped into skipCases map\n}\n\nfunc TestFoo(t *testing.T) {\n    if skipCases[\"TestFoo\"] {\n        t.Skip()\n    }\n    // else continue testing\n}\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 2917346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e6ac9f0a20380ac60576685c4eddc5?s=128&d=identicon&r=PG&f=1", "display_name": "user2917346", "link": "https://stackoverflow.com/users/2917346/user2917346"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2046, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1544019505, "creation_date": 1544014628, "question_id": 53632883, "link": "https://stackoverflow.com/questions/53632883/how-do-i-dynamically-skip-tests-in-golang", "title": "How do I dynamically skip tests in golang?", "body": "<p>We have a special text file on an HTTP server that contains the filenames and test functions we want to skip when our golang tests run.</p>\n\n<p>I must build something which downloads that test file, parses the file names and test functions that should be skipped, and then finally runs our go tests and properly skips the test functions found in the input file.</p>\n\n<p>What's the right way to make this work in golang?</p>\n\n<p>(I realize this sounds like an unusual way to skip, but we really want to make this work as I have described for reasons which are out of context to this question.)</p>\n"}, {"tags": ["go", "slice", "var", "literals"], "answers": [{"comments": [{"owner": {"reputation": 144, "user_id": 2370297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43fff4244328b0d0a12dcd4a7ffd73b2?s=128&d=identicon&r=PG", "display_name": "Amitabh", "link": "https://stackoverflow.com/users/2370297/amitabh"}, "edited": false, "score": 0, "creation_date": 1544012625, "post_id": 53632169, "comment_id": 94123856, "body": "Thanks. Appreciate the links to elaborate on the subject."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1544012271, "creation_date": 1544012271, "answer_id": 53632169, "question_id": 53632004, "link": "https://stackoverflow.com/questions/53632004/golang-var-and-literal-usage/53632169#53632169", "title": "Golang var and literal usage", "body": "<p>Your first version assigns the value of the <code>employees</code> variable to <code>session.Employees</code>. It will be the <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow noreferrer\">zero value</a> of the type <code>[]Employee</code>, which is <code>nil</code>. You could simply write this as:</p>\n\n<pre><code>session.Employees = nil\n</code></pre>\n\n<p>Your second version assigns the value of a <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">composite literal</a>, which will be an empty (length=0, capacity=0) but non-<code>nil</code> slice.</p>\n\n<p>See related questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/44305170/nil-slices-vs-non-nil-slices-vs-empty-slices-in-go-language/44305910#44305910\">nil slices vs non-nil slices vs empty slices in Go language</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/49104157/what-is-the-point-of-having-nil-slice-and-empty-slice-in-golang/49106111#49106111\">What is the point of having nil slice and empty slice in golang?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/29164375/correct-way-to-initialize-empty-slice/29164546#29164546\">Correct way to initialize empty slice</a></p>\n"}], "owner": {"reputation": 144, "user_id": 2370297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43fff4244328b0d0a12dcd4a7ffd73b2?s=128&d=identicon&r=PG", "display_name": "Amitabh", "link": "https://stackoverflow.com/users/2370297/amitabh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1544012394, "creation_date": 1544011764, "last_edit_date": 1544012394, "question_id": 53632004, "link": "https://stackoverflow.com/questions/53632004/golang-var-and-literal-usage", "title": "Golang var and literal usage", "body": "<p>Option 1</p>\n\n<pre><code>var employees []Employee\nsession.Employees = employees\n</code></pre>\n\n<p>Option 2</p>\n\n<pre><code>session.Employees = []Employee{}\n</code></pre>\n\n<p>What, if any, is the difference in the two Golang code options, with respect to session.Employees after execution?</p>\n"}, {"tags": ["mysql", "go", "go-gorm"], "comments": [{"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1544462487, "post_id": 53630860, "comment_id": 94275692, "body": "I am confused by the syntax here:  <code>..., shop_id ( ...</code> -- This implies that <code>shop_id</code> is some kind of function.  Yet <code>( ... ) as distanct</code> makes sense.  Perhaps a comma is missing after <code>shop_id</code>?"}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1544462652, "post_id": 53630860, "comment_id": 94275765, "body": "<code>Order(&quot;locations.id DESC&quot;).Limit(1)</code> talks about <code>id</code>, yet two other things talk about <code>distance</code>."}, {"owner": {"reputation": 732, "user_id": 1442435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01c2824c79133dd9014ed6c5652ebfe4?s=128&d=identicon&r=PG", "display_name": "eclaude", "link": "https://stackoverflow.com/users/1442435/eclaude"}, "reply_to_user": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1544503683, "post_id": 53630860, "comment_id": 94288833, "body": "hi, thanks for your message, if you look at the structure of the tables, the stores have locations, they are stores that regularly change locations."}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1544547266, "post_id": 53630860, "comment_id": 94311377, "body": "And my question about the <code>shop_id</code>?"}, {"owner": {"reputation": 732, "user_id": 1442435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01c2824c79133dd9014ed6c5652ebfe4?s=128&d=identicon&r=PG", "display_name": "eclaude", "link": "https://stackoverflow.com/users/1442435/eclaude"}, "reply_to_user": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1544549254, "post_id": 53630860, "comment_id": 94312371, "body": "To define a belongs to relationship, the foreign key must exists, default foreign key uses owner\u2019s type name plus its primary key.  For a above example, to define a model that belongs to Shop, the foreign key should be ShopID (<code>shop_id</code>)."}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1544550319, "post_id": 53630860, "comment_id": 94312922, "body": "Don&#39;t you get a syntax error?"}, {"owner": {"reputation": 732, "user_id": 1442435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01c2824c79133dd9014ed6c5652ebfe4?s=128&d=identicon&r=PG", "display_name": "eclaude", "link": "https://stackoverflow.com/users/1442435/eclaude"}, "reply_to_user": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1544551831, "post_id": 53630860, "comment_id": 94313615, "body": "I do not have any errors, I just got the right result from the <code>Go</code> code, indeed I wish to have the list of stores sort by last locations around a lat / lng"}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1544560734, "post_id": 53630860, "comment_id": 94317770, "body": "Are you asking how to write a <code>JOIN</code> in SQL?"}, {"owner": {"reputation": 732, "user_id": 1442435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01c2824c79133dd9014ed6c5652ebfe4?s=128&d=identicon&r=PG", "display_name": "eclaude", "link": "https://stackoverflow.com/users/1442435/eclaude"}, "reply_to_user": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1544583562, "post_id": 53630860, "comment_id": 94324125, "body": "Absolutely not, I ask how to do the query with <code>go-gorm</code> it&#39;s not a SQL problem but a <code>go-gorm</code> knowledge."}, {"owner": {"reputation": 732, "user_id": 1442435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01c2824c79133dd9014ed6c5652ebfe4?s=128&d=identicon&r=PG", "display_name": "eclaude", "link": "https://stackoverflow.com/users/1442435/eclaude"}, "reply_to_user": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1544618528, "post_id": 53630860, "comment_id": 94339069, "body": "I asked your help to make this request with the ORM, to improve my knowledge."}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 1, "creation_date": 1544629968, "post_id": 53630860, "comment_id": 94345863, "body": "<code>&lt;opinion&gt;</code>Alas, I know nothing about ORMs.  Unfortunately, with most 3rd party packages that <i>try</i> to insulate the programmer from SQL, the programmer still needs to learn SQL in order to achieve anything other than trivial queries.<code>&lt;&#47;opinion&gt;</code>  So, I was approaching your question from &quot;here&#39;s the SQL, now figure out how to reverse engineer it to ORM."}], "answers": [{"tags": [], "owner": {"reputation": 1114, "user_id": 8190553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6OTwb.png?s=128&g=1", "display_name": "will7200", "link": "https://stackoverflow.com/users/8190553/will7200"}, "is_accepted": true, "score": 2, "last_activity_date": 1572561525, "creation_date": 1572561525, "answer_id": 58652009, "question_id": 53630860, "link": "https://stackoverflow.com/questions/53630860/golang-gorm-query-locations-around-a-position-with-lat-and-lng/58652009#58652009", "title": "Golang GORM query locations around a position with Lat and Lng", "body": "<p>Looking at the query I would definitely hand craft this one and not rely on any ORM to execute the query. Refer to using the Exec method on a gorm database instance <a href=\"http://gorm.io/docs/sql_builder.html\" rel=\"nofollow noreferrer\">ref</a>.</p>\n\n<p>But...\nTo use an ORM like gorm, using gorm's SQL-Builder is a possibility. Here is an example that should be of guidance. Please note that this is for SQLite Database, and not for MYSQL so the functions in use do not exist. We are mainly concerned with building the query.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/jinzhu/gorm/dialects/sqlite\"\n)\n\nconst (\n    layoutISO = \"2006-01-02\"\n)\n\ntype Shop struct {\n    gorm.Model\n    Name      string     `json:\"name\" gorm:\"type:varchar(180);unique_index\"`\n    Active    int        `json:\"active\" gorm:\"type:tinyint(1);default:1\"`\n    Tags      []Tag      `json:\"tags\" gorm:\"many2many:shops_tags;\"`\n    Locations []Location `json:\"locations\" gorm:\"locations\"`\n}\n\ntype Tag struct {\n    gorm.Model\n    Name  string `json:\"name\" gorm:\"type:varchar(180)\"`\n    Shops []Shop `json:\"shops\" gorm:\"many2many:shops_tags;\"`\n}\n\ntype Location struct {\n    gorm.Model\n    ShopID int64\n    Shop   Shop\n    Lat    float64 `gorm:\"type:decimal(10,8)\"`\n    Lng    float64 `gorm:\"type:decimal(11,8)\"`\n}\n\n// Get POST data (name lat and lng)\ntype geo struct {\n    Lat float64 `json:\"lat\" form:\"lat\" query:\"lat\"`\n    Lng float64 `json:\"lng\" form:\"lng\" query:\"lng\"`\n}\n\nvar distance_calculation = `\n       (\n           (\n                   6371.04 * ACOS(((COS(((PI() / 2) - RADIANS((90 - locations.lat)))) *\n                                    COS(PI() / 2 - RADIANS(90 - ?)) *\n                                    COS((RADIANS(locations.lng) - RADIANS(?))))\n                   + (SIN(((PI() / 2) - RADIANS((90 - locations.lat)))) *\n                      SIN(((PI() / 2) - RADIANS(90 - ?))))))\n               )\n           )`\n\nfunc main() {\n    db, err := gorm.Open(\"sqlite3\", \"test.db\")\n    if err != nil {\n        panic(\"failed to connect database\")\n    }\n    defer db.Close()\n    // Enable Logger, show detailed log\n    db.LogMode(true)\n\n    // Migrate the schema\n    db.AutoMigrate(&amp;Shop{})\n    db.AutoMigrate(&amp;Tag{})\n    db.AutoMigrate(&amp;Location{})\n\n\n    g := new(geo)\n    g.Lat = -33.73788500\n    g.Lng = 151.23526000\n    type Result struct {\n        ID         uint\n        Name       string\n        Distance   int\n        LocationID uint\n        ShopID     uint\n        Lat        float64\n        Lng        float64\n        CreatedAt  time.Time\n    }\n\n    date, _ := time.Parse(layoutISO, \"2017-12-13\")\n    var t []Result\n    err = db.Table(\"Shops\").\n        Select(\"shops.id, shops.name, locations.id AS 'location_id', locations.shop_id, locations.lat, locations.lng, locations.created_at, \"+\n            distance_calculation+\" as distance\\n\", g.Lat, g.Lng, g.Lat).\n        Joins(\"inner join locations on shops.id = locations.shop_id\\n\").\n        Where(&amp;Shop{Active: 1}).\n        Where(\"locations.created_at &gt;= CAST(strftime('%s', ?) AS INT) * 1000\", date).\n        Where(distance_calculation + \" &lt; ?\", g.Lat, g.Lng, g.Lat, 500).\n        Group(\"\\nshops.id\\n\").\n        Order(\"locations.id DESC\\n\").\n        Limit(100).Scan(&amp;t).Error\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"%+v\\n\", t)\n}\n</code></pre>\n\n<p>Query Built with SQL Builder</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>(C:/Users/fakename/source/stackoverflow/go/geo-go-gorm/main.go:97)\n[2019-10-31 15:36:37]  [1.00ms]  SELECT shops.id, shops.name, locations.id AS 'location_id', locations.shop_id, locations.lat, locations.lng, locations.created_at,\n       (\n           (\n                   6371.04 * ACOS(((COS(((PI() / 2) - RADIANS((90 - locations.lat)))) *\n                                    COS(PI() / 2 - RADIANS(90 - -33.737885)) *\n                                    COS((RADIANS(locations.lng) - RADIANS(151.23526))))\n                   + (SIN(((PI() / 2) - RADIANS((90 - locations.lat)))) *\n                      SIN(((PI() / 2) - RADIANS(90 - -33.737885))))))\n               )\n           ) as distance\n FROM \"Shops\" inner join locations on shops.id = locations.shop_id\n WHERE (\"shops\".\"active\" = 1) AND (locations.created_at &gt;= CAST(strftime('%s', '2017-12-13 00:00:00') AS INT) * 1000) AND (\n       (\n           (\n                   6371.04 * ACOS(((COS(((PI() / 2) - RADIANS((90 - locations.lat)))) *\n                                    COS(PI() / 2 - RADIANS(90 - -33.737885)) *\n                                    COS((RADIANS(locations.lng) - RADIANS(151.23526))))\n                   + (SIN(((PI() / 2) - RADIANS((90 - locations.lat)))) *\n                      SIN(((PI() / 2) - RADIANS(90 - -33.737885))))))\n               )\n           ) &lt; 500\n) GROUP BY shops.id\n ORDER BY locations.id DESC\n LIMIT 100\n\n</code></pre>\n"}], "owner": {"reputation": 732, "user_id": 1442435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01c2824c79133dd9014ed6c5652ebfe4?s=128&d=identicon&r=PG", "display_name": "eclaude", "link": "https://stackoverflow.com/users/1442435/eclaude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1484, "favorite_count": 2, "accepted_answer_id": 58652009, "answer_count": 1, "score": 9, "last_activity_date": 1572561525, "creation_date": 1544007995, "last_edit_date": 1544695689, "question_id": 53630860, "link": "https://stackoverflow.com/questions/53630860/golang-gorm-query-locations-around-a-position-with-lat-and-lng", "title": "Golang GORM query locations around a position with Lat and Lng", "body": "<p>I'm trying to make a specific request with <a href=\"http://gorm.io\" rel=\"noreferrer\">GORM</a>.</p>\n\n<p>Here are the tables I use:</p>\n\n<pre><code>+-------------------+\n| Tables            |\n+-------------------+\n| locations         |\n| shops             |\n| shops_tags        |\n| tags              |\n+-------------------+\n</code></pre>\n\n<p><em>Locations table</em></p>\n\n<pre><code>+------------+------------------+------+-----+---------+----------------+\n| Field      | Type             | Null | Key | Default | Extra          |\n+------------+------------------+------+-----+---------+----------------+\n| id         | int(10) unsigned | NO   | PRI | NULL    | auto_increment |\n| shop_id    | bigint(20)       | YES  |     | NULL    |                |\n| lat        | decimal(10,8)    | YES  |     | NULL    |                |\n| lng        | decimal(11,8)    | YES  |     | NULL    |                |\n+------------+------------------+------+-----+---------+----------------+\n</code></pre>\n\n<p><em>Location model</em></p>\n\n<pre><code>type Location struct {\n    gorm.Model\n    ShopID int64\n    Shop   Shop\n    Lat    float64 `gorm:\"type:decimal(10,8)\"`\n    Lng    float64 `gorm:\"type:decimal(11,8)\"`\n}\n</code></pre>\n\n<p><em>Shops table</em></p>\n\n<pre><code>+-------------+------------------+------+-----+---------+----------------+\n| Field       | Type             | Null | Key | Default | Extra          |\n+-------------+------------------+------+-----+---------+----------------+\n| id          | int(10) unsigned | NO   | PRI | NULL    | auto_increment |\n| name        | varchar(180)     | YES  | UNI | NULL    |                |\n| active      | tinyint(1)       | YES  |     | 1       |                |\n+-------------+------------------+------+-----+---------+----------------+\n</code></pre>\n\n<p><em>Shop model</em></p>\n\n<pre><code>type Shop struct {\n    gorm.Model\n    Name        string      `json:\"name\" gorm:\"type:varchar(180);unique_index\"`\n    Active      int         `json:\"active\" gorm:\"type:tinyint(1);default:1\"`\n    Tags        []*Tag      `json:\"tags\" gorm:\"many2many:shops_tags;\"`\n    Locations   []Location  `json:\"locations\" gorm:\"locations\"`\n}\n</code></pre>\n\n<p><em>Tag model</em></p>\n\n<pre><code>type Tag struct {\n    gorm.Model\n    Name  string  `json:\"name\" gorm:\"type:varchar(180)\"`    \n    Shops []*Shop `json:\"shops\" gorm:\"many2many:shops_tags;\"`\n}\n</code></pre>\n\n<p><em>Handler to return query in JSON</em></p>\n\n<pre><code>func GetShops(c echo.Context) error {\n    db := db.DbManager()\n\n    // Get POST data (name lat and lng)\n    type geo struct {\n        Lat string `json:\"lat\" form:\"lat\" query:\"lat\"`\n        Lng string `json:\"lng\" form:\"lng\" query:\"lng\"`\n    }\n\n    // Bind request body\n    g := new(geo)\n    if err := c.Bind(g); err != nil {\n        return c.JSON(http.StatusForbidden, err)\n    }\n\n    shops := []model.Shop{}\n\n    // Totally disordered attempt of a query with `go-gorm` to display the list of nearby shops, sorted by the distance between us.\n\n    db.Preload(\"Locations\", func(db *gorm.DB) *gorm.DB {\n\n        // How here use  g.Lat and g.Lng for this request  \n\n        return db.Order(\"locations.id DESC\").Limit(1)\n    }).Preload(\"Tag\").Find(&amp;shops)\n\n    // Json\n    return c.JSON(http.StatusOK, echo.Map{\n        \"shops\": &amp;shops,\n    })\n}\n</code></pre>\n\n<p>So we have <strong>Stores</strong>, which have <strong>Locations</strong>, we want to display <strong>Stores</strong> within 15km of our <strong>Location</strong>. Only the <strong>last location</strong> is useful, that's why, we limited the results to 1 in decreasing order.</p>\n\n<p><em>Edit</em></p>\n\n<p>Thanks to <a href=\"https://stackoverflow.com/users/1766831/rick-james\">@Rick James</a> for suggesting me to rephrase my question, here is the query in <code>MYSQL</code>, how to adapt it to <code>go-gorm</code>:</p>\n\n<pre><code>SELECT\nshops.id,\n    shops.name, (\n        (\n            6371.04 * ACOS(\n                (\n                    (\n                        COS(\n                            (\n                                (\n                                    PI() / 2\n                                ) - RADIANS(\n                                    (90 - locations.lat)\n                                )\n                            )\n                        ) * COS(\n                            PI() / 2 - RADIANS(90 - -33.73788500)\n                        ) * COS(\n                            (\n                                RADIANS(locations.lng) - RADIANS('151.23526000')\n                            )\n                        )\n                    ) + (\n                        SIN(\n                            (\n                                (\n                                    PI() / 2\n                                ) - RADIANS(\n                                    (90 - locations.lat)\n                                )\n                            )\n                        ) * SIN(\n                            (\n                                (\n                                    PI() / 2\n                                ) - RADIANS(90 - -33.73788500)\n                            )\n                        )\n                    )\n                )\n            )\n        )\n    ) AS 'distance',\n    locations.id AS 'location_id',\n    locations.shop_id,\n    locations.lat,\n    locations.lng,\n    locations.created_at\nFROM\nshops\nINNER JOIN locations ON(\n    locations.created_at &gt;= '2017-12-13'\n    AND(\n        (\n            6371.04 * ACOS(\n                (\n                    (\n                        COS(\n                            (\n                                (\n                                    PI() / 2\n                                ) - RADIANS(\n                                    (90 - locations.lat)\n                                )\n                            )\n                        ) * COS(\n                            PI() / 2 - RADIANS(90 - -33.73788500)\n                        ) * COS(\n                            (\n                                RADIANS(locations.lng) - RADIANS('151.23526000')\n                            )\n                        )\n                    ) + (\n                        SIN(\n                            (\n                                (\n                                    PI() / 2\n                                ) - RADIANS(\n                                    (90 - locations.lat)\n                                )\n                            )\n                        ) * SIN(\n                            (\n                                (\n                                    PI() / 2\n                                ) - RADIANS(90 - -33.73788500)\n                            )\n                        )\n                    )\n                )\n            )\n        )\n    ) &lt; '500'\n    AND shops.id = (locations.shop_id)\n)\nWHERE\n  shops.active = 1\nGROUP BY\n  shops.id\nORDER BY\n  distance ASC\nLIMIT\n  100\n</code></pre>\n"}, {"tags": ["pointers", "go", "struct"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1544006117, "post_id": 53629857, "comment_id": 94119963, "body": "You are not changing p you are changing p.X."}], "answers": [{"comments": [{"owner": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "edited": false, "score": 0, "creation_date": 1544005178, "post_id": 53629938, "comment_id": 94119429, "body": "So <code>i</code> is a pointer of type <code>*int</code> and <code>p</code> is a pointer of type <code>*Point</code>. Shouldn&#39;t they behave the same?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "edited": false, "score": 0, "creation_date": 1544005268, "post_id": 53629938, "comment_id": 94119488, "body": "@ninesalt Modifying the <i>pointed</i> value, you should write <code>*p</code> always in the first place. But given a pointer to a struct, it&#39;s a frequent operation to modify fields of the pointed struct, so the spec allows you to use a <i>shortcut</i>, namely you can leave out the pointer indirection, yet it will mean the same. Readability, and no ambiguity."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1544005876, "last_edit_date": 1544005876, "creation_date": 1544005013, "answer_id": 53629938, "question_id": 53629857, "link": "https://stackoverflow.com/questions/53629857/why-do-pointer-types-behave-differently-than-struct-types/53629938#53629938", "title": "Why do pointer types behave differently than struct types?", "body": "<p>Because <code>i</code> is a pointer of type <code>*int</code>, and you want to modify the pointed object, so you have to write <code>*i</code>.</p>\n\n<p>The same syntax is valid for structs too, e.g. you can write <code>(*p).X</code>, but this is a frequent operation, so the spec allows to use <code>p.X</code> which will mean <code>(*p).X</code>, there is no ambiguity, and is a handy shortcut.</p>\n\n<p>It's in <a href=\"https://golang.org/ref/spec#Selectors\" rel=\"nofollow noreferrer\">Spec: Selectors:</a></p>\n\n<blockquote>\n  <p>As an exception, if the type of <code>x</code> is a <a href=\"https://golang.org/ref/spec#Type_definitions\" rel=\"nofollow noreferrer\">defined</a> pointer type and <code>(*x).f</code> is a valid selector expression denoting a field (but not a method), <code>x.f</code> is shorthand for <code>(*x).f</code>.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "edited": false, "score": 0, "creation_date": 1544007176, "post_id": 53630554, "comment_id": 94120631, "body": "So essentially if you&#39;re not changing the whole object then you can omit the <code>*</code>?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "edited": false, "score": 0, "creation_date": 1544007302, "post_id": 53630554, "comment_id": 94120695, "body": "@ninesalt: In golang, you can. Of course, if you define <code>type Point struct { X *int}</code>, you&#39;ll either have to assign a pointer to <code>X</code>, or write <code>*p.X</code> (which is equivalent to <code>*(*p).X</code>). Meaning, depending on the actual type of the field you&#39;re dealing with you can omit the <code>*</code>"}, {"owner": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "edited": false, "score": 0, "creation_date": 1544007449, "post_id": 53630554, "comment_id": 94120791, "body": "Thanks. I think I&#39;m starting to get it."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "edited": false, "score": 0, "creation_date": 1544007645, "post_id": 53630554, "comment_id": 94120916, "body": "@ninesalt No worries. If you&#39;re starting out with golang and are somewhat unsure about certain things (like how embedded types vs interfaces work, or iterating over slices whilst appending to them inside the loop), you do bookmark the specs icza links to. They&#39;re really good to help you understand some of golang&#39;s quirks"}], "tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": true, "score": 3, "last_activity_date": 1544007505, "last_edit_date": 1544007505, "creation_date": 1544006926, "answer_id": 53630554, "question_id": 53629857, "link": "https://stackoverflow.com/questions/53629857/why-do-pointer-types-behave-differently-than-struct-types/53630554#53630554", "title": "Why do pointer types behave differently than struct types?", "body": "<p>The easiest way to think about both functions is that in the <code>t2</code> function, you're changing a field of a struct, using a pointer to the underlying struct. In the <code>t</code> function, you're changing the entire underlying object (the int).</p>\n\n<p>In reality, the fact that you can write <code>p.X</code> is actually just a nicety. In languages like C, you could only use <code>p.X</code> if you were operating on a non-pointer variable. For pointers, you had to either use <code>p-&gt;X</code> denoting you were accessing a field using indirection, or indeed dereference the pointer (<code>(*p).X</code>).</p>\n\n<p>Internally, go still does the same thing, it just allows you to omit the explicit dereferencing, and it eliminates the need for an indirection operator.</p>\n\n<p>Both functions, however, are <em>not</em> equivalent. <code>Point</code> is a struct, with one or more fields. The other type is <code>*int</code>, an int is a single scalar value. To make <code>t2</code> equivalent (and reassign the entire underlying object), you'll have to change the code to be identical to what you have to do in case of <code>*int</code>:</p>\n\n<pre><code>func t2(p *Point) {\n    *p = Point{\n         X: 200,\n         Y: p.Y,\n     }\n}\n</code></pre>\n\n<hr>\n\n<p>As per comment below: the TL;DR version is that you don't have to explicitly dereference a pointer to  a struct type if you access one of its fields. You had to do that in C/C++, but the go compiler takes care of that for you. It works out you're using a variable that is a pointer type and compiles <code>p.X</code> in the same way that a C compiler would compile <code>p-&gt;X</code>. Therefore, you don't need to dereference <code>p</code> explicitly.</p>\n\n<p>You would still have to write <code>*p.X</code> if you declared <code>Point</code> as:</p>\n\n<pre><code>type Point struct {\n    X *int\n}\n</code></pre>\n\n<p>Because the expression <code>p.X</code> evaluates to an operand of type <code>*int</code>, which needs to be treated accordingly.</p>\n"}], "owner": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "accepted_answer_id": 53630554, "answer_count": 2, "score": 0, "last_activity_date": 1544007505, "creation_date": 1544004801, "last_edit_date": 1544005305, "question_id": 53629857, "link": "https://stackoverflow.com/questions/53629857/why-do-pointer-types-behave-differently-than-struct-types", "title": "Why do pointer types behave differently than struct types?", "body": "<p>I have this fragment of Go code where I'm trying to change the values of a regular int and an int in a struct using two functions <code>f</code> and <code>f2</code> respectively. I don't understand why I need to do <code>*i</code> to change the value of the int but I don't need to do that when I change the value of X in the struct. </p>\n\n<pre><code>type Point struct {\n    X int\n}\n\nfunc t(i *int) {\n    *i = 20\n}\n\nfunc t2(p *Point) {\n    p.X = 200\n}\n\nfunc main() {\n    g := 30\n    t(&amp;g)\n    fmt.Println(g)\n\n    p := Point{3}\n    t2(&amp;p)\n    fmt.Println(p)\n}\n</code></pre>\n"}, {"tags": ["go", "memory-leaks", "rpc"], "comments": [{"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 1, "creation_date": 1544020239, "post_id": 53629309, "comment_id": 94128519, "body": "With the memory increase that you have mentioned, we can&#39;t conclude that the code leaks memory. In the first version, you dial a connection for every iteration in the for statement in main() function. So you create many RPC connection object. Go may not collect these objects at the end of Dial() function call. GC is run periodically and free the memory which are not referenced in any alive scope. In the second version, you dial only one connection and use that for all RPC calls."}, {"owner": {"reputation": 29, "user_id": 10562146, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x9uLuLgNOYM/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDoOq6huGhWQ7Hm3tcWE-o-FRMxoQ/mo/photo.jpg?sz=128", "display_name": "Lee", "link": "https://stackoverflow.com/users/10562146/lee"}, "reply_to_user": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 0, "creation_date": 1544023626, "post_id": 53629309, "comment_id": 94130814, "body": "So the issue could/probably is  GC related, should therefore, if i let the code run for several hours the memory usage top out or even start to recover? @Spartan"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1544025331, "post_id": 53629309, "comment_id": 94131912, "body": "Probably not relevant to the question, but never <code>defer c.Close()</code> before checking the error, because if there&#39;s an error the value is probably nil and will just panic."}], "owner": {"reputation": 29, "user_id": 10562146, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x9uLuLgNOYM/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDoOq6huGhWQ7Hm3tcWE-o-FRMxoQ/mo/photo.jpg?sz=128", "display_name": "Lee", "link": "https://stackoverflow.com/users/10562146/lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544791620, "creation_date": 1544003076, "last_edit_date": 1544791620, "question_id": 53629309, "link": "https://stackoverflow.com/questions/53629309/go-rpc-memory-leak-or-lack-of-understanding", "title": "Go rpc memory leak or lack of understanding?", "body": "<p>I have been writing some rpc code in go, using the standard library.  </p>\n\n<p>My system is kubuntu 18.10 64 bit all updates applied in conjunction with golang 1.11.</p>\n\n<p>In an update to my initial assumptions about memory usage, they turned out to be incorrect so here is my updated question. The question still reates to a constant climb in memory consumption.</p>\n\n<p>Update:</p>\n\n<p>I have done some further investigation, and, I am probably still not understanding correctly.</p>\n\n<p>I wrote a simple test server and client as follows:</p>\n\n<p>Client:</p>\n\n<pre><code>package main\n\nimport (\n   \"net/rpc\"\n)\n\nimport (\n\"fmt\"\n\"log\"\n)\n\ntype Args struct {\n    ThrottleName string\n    BatchSize    int\n}\n\n\n\nfunc main() {\n\n\nthrottle, err := rpc.Dial(\"tcp\", \"127.0.0.1:1234\")\nif err != nil {\n    log.Fatal(\"dialing:\", err)\n}\nfmt.Println(\"done dial\")\nvar reply int\n\nvar tc = Args{ThrottleName: \"a\", BatchSize: 10}\nfor {\n    _ = throttle.Call(\"Task.Throttle\", tc, &amp;reply)\n    fmt.Println(reply)\n}\n\n}\n</code></pre>\n\n<p>Server:</p>\n\n<pre><code>package main\n\nimport (\n    \"net\"\n    \"net/rpc\"\n\n\n    \"time\"\n)\n\ntype Args struct {\n    ThrottleName string\n    BatchSize    int\n}\n\ntype Task int\n\nfunc (t *Task) Throttle(args *Args, reply *int) error {\n\n   time.Sleep(1 * time.Microsecond)\n   //reply = 0\n   return nil\n}\n\nfunc main() {\n\n    task := new(Task)\n    rpc.Register(task)\n    listener, _ := net.Listen(\"tcp\", \":1234\")\n    defer listener.Close()\n    rpc.Accept(listener)\n}\n</code></pre>\n\n<p>I then started the server. Checked the memory use using:</p>\n\n<pre><code>ps -eo size,command --sort -size | grep rpctest | awk '{ hr=$1/1024 ; sum +=hr} END {print sum}'\n</code></pre>\n\n<p>This registered about 140mb, I then started the client, the memory usage climbs over time, after 5.5hours it had reached 359mb. I cannot confirm that it had finished climbing.</p>\n\n<p>I then stopped the client and after 2 hours the memory usage was still at 359mb.</p>\n\n<p>I guess my updated question are: </p>\n\n<p>Am i do something wrong?</p>\n\n<p>Why does the memory use not at least drop back after the client exits?</p>\n\n<p>Why does memory keep rising through use?</p>\n\n<p>Excuse the appalling error checking.</p>\n\n<p>Final addendum I also tried:</p>\n\n<pre><code>stress --vm-bytes $(awk '/MemAvailable/{printf \"%d\\n\", $2}' &lt; /proc/meminfo)k --vm-keep -m 1\n</code></pre>\n\n<p>In case the system was not reclaiming the memory from go.</p>\n"}, {"tags": ["docker", "go", "docker-compose", "dockerfile", "grafana"], "comments": [{"owner": {"reputation": 1965, "user_id": 508214, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xKgdj.png?s=128&g=1", "display_name": "titogeo", "link": "https://stackoverflow.com/users/508214/titogeo"}, "edited": false, "score": 0, "creation_date": 1544005013, "post_id": 53629196, "comment_id": 94119327, "body": "can you try <code>$HOME&#47;gocode&#47;bin&#47;go</code> instead of <code>go</code>."}, {"owner": {"reputation": 1965, "user_id": 508214, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xKgdj.png?s=128&g=1", "display_name": "titogeo", "link": "https://stackoverflow.com/users/508214/titogeo"}, "edited": false, "score": 0, "creation_date": 1544005039, "post_id": 53629196, "comment_id": 94119343, "body": "you should also look at multi stage build - <a href=\"https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#use-multi-stage-builds\" rel=\"nofollow noreferrer\">docs.docker.com/develop/develop-images/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 10557053, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N2h_877wIFI/AAAAAAAAAAI/AAAAAAAAABo/e1a_iNLo74U/photo.jpg?sz=128", "display_name": "aditya gupta", "link": "https://stackoverflow.com/users/10557053/aditya-gupta"}, "reply_to_user": {"reputation": 1965, "user_id": 508214, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xKgdj.png?s=128&g=1", "display_name": "titogeo", "link": "https://stackoverflow.com/users/508214/titogeo"}, "edited": false, "score": 0, "creation_date": 1544005781, "post_id": 53629196, "comment_id": 94119787, "body": "not working same error"}, {"owner": {"reputation": 1965, "user_id": 508214, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xKgdj.png?s=128&g=1", "display_name": "titogeo", "link": "https://stackoverflow.com/users/508214/titogeo"}, "edited": false, "score": 0, "creation_date": 1544006236, "post_id": 53629196, "comment_id": 94120028, "body": "Why not use an image with go installed?"}, {"owner": {"reputation": 1, "user_id": 10557053, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N2h_877wIFI/AAAAAAAAAAI/AAAAAAAAABo/e1a_iNLo74U/photo.jpg?sz=128", "display_name": "aditya gupta", "link": "https://stackoverflow.com/users/10557053/aditya-gupta"}, "reply_to_user": {"reputation": 1965, "user_id": 508214, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xKgdj.png?s=128&g=1", "display_name": "titogeo", "link": "https://stackoverflow.com/users/508214/titogeo"}, "edited": false, "score": 0, "creation_date": 1544008499, "post_id": 53629196, "comment_id": 94121382, "body": "i am having different kind of setup thats why i am looking for this way"}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1544008534, "post_id": 53629196, "comment_id": 94121405, "body": "Please do not include screen shots of terminal windows; just paste the actual error message that&#39;s being produced into your question."}, {"owner": {"reputation": 1, "user_id": 10557053, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N2h_877wIFI/AAAAAAAAAAI/AAAAAAAAABo/e1a_iNLo74U/photo.jpg?sz=128", "display_name": "aditya gupta", "link": "https://stackoverflow.com/users/10557053/aditya-gupta"}, "edited": false, "score": 0, "creation_date": 1544009922, "post_id": 53629196, "comment_id": 94122285, "body": "go command not found is the error message i am getting"}, {"owner": {"reputation": 1, "user_id": 10557053, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N2h_877wIFI/AAAAAAAAAAI/AAAAAAAAABo/e1a_iNLo74U/photo.jpg?sz=128", "display_name": "aditya gupta", "link": "https://stackoverflow.com/users/10557053/aditya-gupta"}, "edited": false, "score": 0, "creation_date": 1544010351, "post_id": 53629196, "comment_id": 94122556, "body": "how can i set path in bash rc and make it run"}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1544038199, "post_id": 53629196, "comment_id": 94138380, "body": "Please read <a href=\"//meta.stackoverflow.com/q/326569\">Under what circumstances may I add \u201curgent\u201d or other similar phrases to my question, in order to obtain faster answers?</a> - the summary is that this is not an ideal way to address volunteers, and is probably counterproductive to obtaining answers. Please refrain from adding this to your questions."}], "owner": {"reputation": 1, "user_id": 10557053, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N2h_877wIFI/AAAAAAAAAAI/AAAAAAAAABo/e1a_iNLo74U/photo.jpg?sz=128", "display_name": "aditya gupta", "link": "https://stackoverflow.com/users/10557053/aditya-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 765, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544038162, "creation_date": 1544002712, "last_edit_date": 1544038162, "question_id": 53629196, "link": "https://stackoverflow.com/questions/53629196/grafana-build-from-source-with-docker-compose-yml-and-dockerfile-path-setup-err", "title": "Grafana build from source with docker-compose.yml and Dockerfile, path setup error, go command not found", "body": "<p>I am trying to install Grafana with docker-compose.yml and Dockerfile. This is giving me error of \"go command not found\"; I think this is because gopath is not setup properly. Same commands I have run one by one in host machine everything is working but same process I am trying with Docker and it is giving me error.</p>\n\n<p>NOTE for error checking please click on link in last.</p>\n\n<p>My docker-compose.yml file </p>\n\n<pre><code>version: '3'\nservices:\n   web:\n      build: .\n      container_name: grafana\n      ports:\n        - \"9000:3000\"\n      expose:\n        - 9000\n      volumes:\n        - .:/newvolebs\n      networks:\n        - overlay\n      environment:\n         MYSQL_HOST: mysql\n         MYSQL_DATABASE: grafana\n         MYSQL_USERNAME: root\n         MYSQL_PASSWORD: 12345\n   mysql:\n      image: mysql:5.6\n      ports:\n        - \"3306:3306\"\n      expose:\n        - 3306\n      volumes:\n        - newvolebs:/var/lib/mysql\n      networks:\n        - overlay\n      environment:\n          MYSQL_ROOT_PASSWORD: 12345\n          MYSQL_DATABASE: grafana\nvolumes:\n newvolebs:\n   driver: local\nnetworks:\n overlay:\n   driver: \"bridge\"\n</code></pre>\n\n<p>my DockerFile</p>\n\n<pre><code>FROM centos:centos7\nRUN     useradd centos &amp;&amp; \\\n        yum install -y sudo &amp;&amp; \\\n        echo \"centos ALL=(ALL) NOPASSWD: ALL\" &gt;&gt; /etc/sudoers\nUSER centos\nENV PATH=\"/home/centos/go:${PATH}\"\nRUN     sudo cd /home/centos &amp;&amp; \\\n        sudo yum -y update &amp;&amp; \\\n        sudo yum --setopt=tsflags=nodocs -y install \\\n        wget \\git \\\n        gcc-c++ make \\tar &amp;&amp; \\\n        sudo wget https://storage.googleapis.com/golang/go1.11.2.linux-amd64.tar.gz &amp;&amp; \\\n        sudo tar -xzvf go1.11.2.linux-amd64.tar.gz &amp;&amp; \\\n        sudo mv go gocode &amp;&amp; \\\n        curl --silent --location https://rpm.nodesource.com/setup_9.x | sudo bash &amp;&amp; \\\n        sudo yum -y install nodejs &amp;&amp; \\\n        yum clean all &amp;&amp; \\\n        sudo chmod 666 ~/.bashrc &amp;&amp; \\\n        sudo echo \"export GOROOT=$HOME/gocode\" &gt;&gt; ~/.bashrc \\\n        &amp;&amp; sudo echo \"export PATH=$PATH:$GOROOT/bin\" &gt;&gt; ~/.bashrc \\\n        &amp;&amp; sudo echo \"export GOPATH=$HOME/go\" &gt;&gt; ~/.bashrc \\\n        &amp;&amp; sudo echo \"export PATH=$PATH:$GOPATH/bin\" &gt;&gt; ~/.bashrc &amp;&amp; \\\n        PATH=\"${GOROOT}/bin:$PATH}\" &amp;&amp; \\\n        export GOPATH=/home/centos/go &amp;&amp; \\\n        export GOROOT=/home/centos/gocode &amp;&amp; \\\n        source /home/centos/.bashrc &amp;&amp; \\\n        sudo mkdir -p $HOME/go/{src,pkg,bin} &amp;&amp; \\\n        cd $GOPATH/src &amp;&amp; \\\n        go get github.com/grafana/grafana &amp;&amp; \\\n        cd $GOPATH/src/github.com/grafana/grafana &amp;&amp; \\\n        go run build.go setup \\\n        go run build.go build &amp;&amp; \\\n        npm install -g yarn &amp;&amp; \\\n        yarn install --pure-lockfile &amp;&amp; \\\n        yarn watch &amp;&amp; \\\n        cd go/src/github.com/grafana/grafana/bin/  &amp;&amp; \\\n        grafana-server \\\n        echo \"[main_settings]\" &gt; /var/www/html/config.ini \\\n        &amp;&amp; echo \"headerTitle='Dashboard'\" &gt;&gt; /var/www/html/config.ini \\\n        &amp;&amp; echo \"encryptKey='ffgfjhvjhvjcfgfjj'\" &gt;&gt; /var/www/html/config.ini \\\n        &amp;&amp; echo \";Timezone Setting. ex: 'America/New_York'\" &gt;&gt; /var/www/html/config.ini \\\n        &amp;&amp; echo \"defaultTimezone=''\" &gt;&gt; /var/www/html/config.ini \\\n        &amp;&amp; echo \";Database parameters for system usage (Should not be used by custom dashboard/charts)\" &gt;&gt; /var/www/html/config.ini \\\n        &amp;&amp; echo \"dashboardDatabaseServer=mysql\" &gt;&gt; /var/www/html/config.ini \\\n        &amp;&amp; echo \"dashboardDatabaseName=dashboard\" &gt;&gt; /var/www/html/config.ini \\\n        &amp;&amp; echo \"dashboardDatabaseUserName=root\" &gt;&gt; /var/www/html/config.ini \\\n        &amp;&amp; echo \"dashboardDatabasePassword=12345 &gt;&gt; /var/www/html/config.ini \\\n        &amp;&amp; echo \";grafana credentials\" &gt;&gt; /var/www/html/config.ini \\\n        &amp;&amp; echo \"grafanaDatabaseServer=mysql\" &gt;&gt; /var/www/html/config.ini \\\n        &amp;&amp; echo \"grafanaDatabaseName=grafana\" &gt;&gt; /var/www/html/config.ini \\\n        &amp;&amp; echo \"grafanaDatabaseUserName=root\" &gt;&gt; /var/www/html/config.ini \\\n        &amp;&amp; echo \"grafanaDatabasePassword=12345\" &gt;&gt; /var/www/html/config.ini &amp;&amp; \\\nEXPOSE  9000\nWORKDIR  /home/centos\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/FQ8AZ.png\" rel=\"nofollow noreferrer\">This is the error when I execute docker-compose build</a></p>\n"}, {"tags": ["qt", "go", "auto-update", "sparkle"], "answers": [{"tags": [], "owner": {"reputation": 2576, "user_id": 631612, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/b7d2a769fa193f9efa36668148deb9f5?s=128&d=identicon&r=PG", "display_name": "quanta", "link": "https://stackoverflow.com/users/631612/quanta"}, "is_accepted": true, "score": 1, "last_activity_date": 1544627832, "last_edit_date": 1544627832, "creation_date": 1544504574, "answer_id": 53717653, "question_id": 53628372, "link": "https://stackoverflow.com/questions/53628372/is-it-possible-to-use-sparkle-in-qt-golang-bindings-app/53717653#53717653", "title": "Is it possible to use Sparkle in Qt (Golang bindings) app?", "body": "<p><a href=\"https://github.com/therecipe/qt/issues/743#issuecomment-444689169\" rel=\"nofollow noreferrer\">https://github.com/therecipe/qt/issues/743#issuecomment-444689169</a></p>\n\n<p>sparkle.m:</p>\n\n<pre><code>#import &lt;Headers/SUUpdater.h&gt;\n\nstatic SUUpdater* updater = nil;\n\nvoid sparkle_checkUpdates()\n{\n    if (!updater) {\n        updater = [[SUUpdater sharedUpdater] retain];\n    }\n\n    [updater setUpdateCheckInterval:3600];\n    [updater checkForUpdatesInBackground];\n}\n</code></pre>\n\n<p>sparkle.go:</p>\n\n<pre><code>// +build darwin windows\n\npackage main\n\n/*\n#cgo CFLAGS: -I ${SRCDIR}/Sparkle.framework\n#cgo LDFLAGS: -F ${SRCDIR} -framework Sparkle\n\nvoid sparkle_checkUpdates();\n*/\nimport \"C\"\n\nfunc sparkle_checkUpdates() {\n    C.sparkle_checkUpdates()\n}\n</code></pre>\n\n<p>And in <code>main.go</code>, call that func:</p>\n\n<pre><code>action := widgets.NewQMenuBar(nil).AddMenu2(\"\").AddAction(\"Check for Updates...\")\n// http://doc.qt.io/qt-5/qaction.html#MenuRole-enum\naction.SetMenuRole(widgets.QAction__ApplicationSpecificRole)\naction.ConnectTriggered(func(bool) { sparkle_checkUpdates() })\n</code></pre>\n\n<p>appcast.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" standalone=\"yes\"?&gt;\n&lt;rss xmlns:sparkle=\"http://www.andymatuschak.org/xml-namespaces/sparkle\" version=\"2.0\"&gt;\n  &lt;channel&gt;\n    &lt;title&gt;Premium VPN&lt;/title&gt;\n    &lt;item&gt;\n      &lt;title&gt;1.0.0.2905&lt;/title&gt;\n      &lt;pubDate&gt;Tue, 11 Dec 2018 11:09:10 +0800&lt;/pubDate&gt;\n      &lt;sparkle:minimumSystemVersion&gt;10.7&lt;/sparkle:minimumSystemVersion&gt;\n      &lt;enclosure url=\"https://example.com/x.zip\" sparkle:version=\"1.0.0.2905\" sparkle:shortVersionString=\"1.0.0.2905\" sparkle:edSignature=\"$(/path/to/Sparkle/bin/sign_update)\" length=\"104408678\" type=\"application/octet-stream\"/&gt;\n    &lt;/item&gt;\n  &lt;/channel&gt;\n&lt;/rss&gt;\n</code></pre>\n\n<p>Info.plist:</p>\n\n<pre><code>&lt;key&gt;SUFeedURL&lt;/key&gt;\n&lt;string&gt;https://example.com/appcast.xml&lt;/string&gt;\n&lt;key&gt;SUPublicEDKey&lt;/key&gt;\n&lt;string&gt;$(/path/to/Sparkle/bin/generate_keys)&lt;/string&gt;\n</code></pre>\n"}], "owner": {"reputation": 2576, "user_id": 631612, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/b7d2a769fa193f9efa36668148deb9f5?s=128&d=identicon&r=PG", "display_name": "quanta", "link": "https://stackoverflow.com/users/631612/quanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 53717653, "answer_count": 1, "score": 0, "last_activity_date": 1544627832, "creation_date": 1543999846, "question_id": 53628372, "link": "https://stackoverflow.com/questions/53628372/is-it-possible-to-use-sparkle-in-qt-golang-bindings-app", "title": "Is it possible to use Sparkle in Qt (Golang bindings) app?", "body": "<p>We build a Qt app using: <a href=\"https://github.com/therecipe/qt\" rel=\"nofollow noreferrer\">https://github.com/therecipe/qt</a>.\nNow we need an auto updater and found this: <a href=\"https://sparkle-project.org\" rel=\"nofollow noreferrer\">https://sparkle-project.org</a></p>\n\n<p>Looks like it is being used by multiple apps on my machine:</p>\n\n<pre><code>/Applications/VLC.app/Contents/Frameworks/Sparkle.framework\n/Applications/Adium.app/Contents/Frameworks/Sparkle.framework\n/Applications/TeamViewer.app/Contents/Frameworks/Sparkle.framework\n/Applications/Docker.app/Contents/Frameworks/Sparkle.framework\n...\n</code></pre>\n\n<p>Some articles show me how to use it in Qt:</p>\n\n<ul>\n<li><a href=\"http://www.discoversdk.com/knowledge-base/using-sparkle-in-qt\" rel=\"nofollow noreferrer\">http://www.discoversdk.com/knowledge-base/using-sparkle-in-qt</a></li>\n<li><a href=\"https://github.com/sparkle-project/Sparkle/issues/1137#issuecomment-336667547\" rel=\"nofollow noreferrer\">https://github.com/sparkle-project/Sparkle/issues/1137#issuecomment-336667547</a></li>\n</ul>\n\n<p>but it's for C++/Objective C code.</p>\n\n<p>Is it possible to use with Golang? If so, how?</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1544000094, "post_id": 53628362, "comment_id": 94116525, "body": "You write code of the form <code>if field x is not empt: copy value</code> for each field. Don&#39;t go fancy here."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1544000325, "post_id": 53628362, "comment_id": 94116644, "body": "Bind directly to <code>User</code>, so any fields the client supplies will be written directly into <code>User</code>, the rest unchanged."}, {"owner": {"reputation": 23, "user_id": 778165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b888ed4d7c60ba9a99b215c2d2a7097?s=128&d=identicon&r=PG", "display_name": "Thorsten Scheckenbach", "link": "https://stackoverflow.com/users/778165/thorsten-scheckenbach"}, "edited": false, "score": 0, "creation_date": 1544000619, "post_id": 53628362, "comment_id": 94116772, "body": "But than the client can supply Id or created, too. What I want to forbid through the UpdateableUser struct. And the User struct might have values already (from DB)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1544001224, "post_id": 53628362, "comment_id": 94117080, "body": "The binding library you use most likely has some way to mark excluded fields from the process. But we don&#39;t know anything about what you use and how you do it..."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 778165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b888ed4d7c60ba9a99b215c2d2a7097?s=128&d=identicon&r=PG", "display_name": "Thorsten Scheckenbach", "link": "https://stackoverflow.com/users/778165/thorsten-scheckenbach"}, "edited": false, "score": 0, "creation_date": 1544006509, "post_id": 53628798, "comment_id": 94120205, "body": "Alright, not the nicest way for long structs but as you say, avoids reflection. THX"}], "tags": [], "owner": {"reputation": 159, "user_id": 2828242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ovpsM.jpg?s=128&g=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/2828242/vincent"}, "is_accepted": true, "score": 4, "last_activity_date": 1544001359, "creation_date": 1544001359, "answer_id": 53628798, "question_id": 53628362, "link": "https://stackoverflow.com/questions/53628362/copy-values-from-one-struct-to-another-in-golang/53628798#53628798", "title": "Copy values from one struct to another in Golang", "body": "<p>I would recommend embedding the Updateable struct into the larger struct:</p>\n\n<pre><code>type UpdateableUser struct {\n    FirstName string\n    LastName  string\n    Email     string\n    Tlm       float64\n    Dob       time.Time\n}\n\ntype User struct {\n    UpdateableUser\n    ID      string\n    created time.Time\n   updated time.Time\n}\n\nfunc (u *User) UpdateFrom(src *UpdateableUser) {\n    if src.FirstName != \"\" {\n        u.FirstName = src.FirstName\n    }\n    if src.LastName != \"\" {\n        u.LastName = src.LastName\n    }\n    // ... And other properties. Tedious, but simple and avoids Reflection\n}\n</code></pre>\n\n<p>This allows you to use <code>UpdateableUser</code> as an interface to make it explicit which properties can be updated.</p>\n"}], "owner": {"reputation": 23, "user_id": 778165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b888ed4d7c60ba9a99b215c2d2a7097?s=128&d=identicon&r=PG", "display_name": "Thorsten Scheckenbach", "link": "https://stackoverflow.com/users/778165/thorsten-scheckenbach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2114, "favorite_count": 0, "accepted_answer_id": 53628798, "answer_count": 1, "score": 1, "last_activity_date": 1544001359, "creation_date": 1543999824, "question_id": 53628362, "link": "https://stackoverflow.com/questions/53628362/copy-values-from-one-struct-to-another-in-golang", "title": "Copy values from one struct to another in Golang", "body": "<p>I've two structs:</p>\n\n<pre><code>type UpdateableUser struct {\n    FirstName string\n    LastName string\n    Email string\n    Tlm float64\n    Dob time.Time\n}\n\ntype User struct {\n    Id string\n    FirstName string\n    LastName string\n    Email string\n    DOB time.Time\n    Tlm float64\n    created time.Time\n    updated time.Time\n}\n</code></pre>\n\n<p>Through a binder I bind request data to the updateableUser struct, therefore I might have an updateableUser with only one \"real\" value, like uu here:</p>\n\n<pre><code>uu := UpdateableUser{Lastname: \"Smith\"}\n</code></pre>\n\n<p>Now I want to set only the not \"emtpy\" values from UpdateableUser to User. Can you please give me a hint or more?</p>\n"}, {"tags": ["git", "go", "github"], "comments": [{"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 1, "creation_date": 1543999724, "post_id": 53628305, "comment_id": 94116350, "body": "why don&#39;t you just try the &#39;go get&#39;, &#39;go install&#39; method you suggested? worst case scenario nothing happens."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "reply_to_user": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1543999794, "post_id": 53628305, "comment_id": 94116389, "body": "@Pizzalord one reason we ask SO questions is so that they eventually help others with the same problem, also I really hate guessing around, but I suppose I could spend an hour with the docs"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1544000029, "post_id": 53628305, "comment_id": 94116488, "body": "&quot;I assume normally Golang projects in Github are consumed by go install when there is a src folder in top level of the project.&quot; Your assumptions are wrong. Questions based on wrong assumptions are hard to answer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1544000060, "post_id": 53628305, "comment_id": 94116502, "body": "@Volker I took out the assume part, do you really not understand the question?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1544000151, "post_id": 53628305, "comment_id": 94116556, "body": "&quot;Normally Golang projects on Github are consumed by go install when there is a src folder at the root of the project.&quot; is plain wrong."}, {"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 1, "creation_date": 1544000167, "post_id": 53628305, "comment_id": 94116563, "body": "often  the answer to questions like yours is someone just trying what you suggested might work. but i googled it for you just now :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "reply_to_user": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1544000192, "post_id": 53628305, "comment_id": 94116577, "body": "@Pizzalord excellent, you get points by upvote, and someone else will have a quick answer, everyone wins"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "edited": false, "score": 0, "creation_date": 1544002468, "post_id": 53628305, "comment_id": 94117753, "body": "I assume one solution is to pacakge your go library into a zip or tar file, similar to this NPM solution: <a href=\"https://stackoverflow.com/questions/53628830/storing-multiple-npm-libraries-in-single-git-repo/53629105#53629105\" title=\"storing multiple npm libraries in single git repo\">stackoverflow.com/questions/53628830/&hellip;</a>, there is <code>go bundle</code> but I tried it and failed to figure out how to use it."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1544013311, "post_id": 53628305, "comment_id": 94124299, "body": "@MrCholo &quot;I assume one solution is to pacakge your go library into a zip or tar file, similar to this NPM solution [...] there is go bundle&quot; No, this is totally wrong. You are deliberately trying to deviate from the official, working, proven, stable and used almost exclusively solution. Why? This just will lead to failure and frustration."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "edited": false, "score": 0, "creation_date": 1544000491, "post_id": 53628510, "comment_id": 94116713, "body": "This assumes the <code>pkg</code> folder is in the root of the project/repo tho, doesn&#39;t it?"}, {"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1544002172, "post_id": 53628510, "comment_id": 94117598, "body": "no the pkg folder is a folder you get when you install go it resides next to go/src, on my machine it is C:/Go/pkg and C:/Go/src, while my projects are in C:/user/username/projects"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "edited": false, "score": 0, "creation_date": 1544002433, "post_id": 53628510, "comment_id": 94117733, "body": "Ok I upvoted, somebody else downvoted, I am not sure why. I assume one solution is to package your go library into a zip or tar file, similar to this NPM solution: <a href=\"https://stackoverflow.com/questions/53628830/storing-multiple-npm-libraries-in-single-git-repo/53629105#53629105\" title=\"storing multiple npm libraries in single git repo\">stackoverflow.com/questions/53628830/&hellip;</a>"}, {"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1544002571, "post_id": 53628510, "comment_id": 94117821, "body": "that should not be need for go, using go get should get the package and all of its dependencies"}], "tags": [], "owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "is_accepted": false, "score": -1, "last_activity_date": 1544000345, "creation_date": 1544000345, "answer_id": 53628510, "question_id": 53628305, "link": "https://stackoverflow.com/questions/53628305/install-golang-library-within-subdirectory-of-github-repo/53628510#53628510", "title": "Install golang library within subdirectory of Github repo", "body": "<p>from the go documentation <a href=\"https://golang.org/doc/articles/go_command.html\" rel=\"nofollow noreferrer\">go command</a></p>\n\n<p>after using</p>\n\n<blockquote>\n  <p>$ go get github.com/google/codesearch/index</p>\n  \n  <p>$ go get github.com/petar/GoLLRB/llrb</p>\n  \n  <p>Both of these projects are now downloaded and installed into $HOME/go, which contains the two directories src/github.com/google/codesearch/index/ and src/github.com/petar/GoLLRB/llrb/, along with the compiled packages (in pkg/) for those libraries and their dependencies.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "edited": false, "score": 0, "creation_date": 1544059217, "post_id": 53635194, "comment_id": 94145650, "body": "I don&#39;t think you understood the OP. My project X is local, I am trying to install <code>project&#47;lang&#47;golang</code> as a dependency of X."}, {"owner": {"reputation": 594, "user_id": 1054114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc175ba42a40a2cd3d3ba24910f9bfa1?s=128&d=identicon&r=PG", "display_name": "orirawlings", "link": "https://stackoverflow.com/users/1054114/orirawlings"}, "edited": false, "score": 0, "creation_date": 1544148307, "post_id": 53635194, "comment_id": 94182730, "body": "Then you would just install the dependency like any other go package. Do <code>go get github.com&#47;org&#47;project&#47;lang&#47;golang&#47;src&#47;thepackage</code>. You&#39;d basically run <code>go get</code> with an argument that matches how you&#39;d list the package in an <code>import</code> statement."}], "tags": [], "owner": {"reputation": 594, "user_id": 1054114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc175ba42a40a2cd3d3ba24910f9bfa1?s=128&d=identicon&r=PG", "display_name": "orirawlings", "link": "https://stackoverflow.com/users/1054114/orirawlings"}, "is_accepted": false, "score": 0, "last_activity_date": 1544022326, "creation_date": 1544022326, "answer_id": 53635194, "question_id": 53628305, "link": "https://stackoverflow.com/questions/53628305/install-golang-library-within-subdirectory-of-github-repo/53635194#53635194", "title": "Install golang library within subdirectory of Github repo", "body": "<p>Set <code>GOPATH</code> environment variable to the <code>project/lang/golang</code> directory and of your project (probably with a fully qualified path, i.e. one starting with <code>/</code> on unix-like systems). <code>go get</code> will install to the correct location. Other commands like <code>go build</code>/<code>go install</code> will also work properly.</p>\n\n<p>Information about GOPATH:\n<a href=\"https://golang.org/doc/code.html#GOPATH\" rel=\"nofollow noreferrer\">https://golang.org/doc/code.html#GOPATH</a></p>\n\n<p>How to set GOPATH:\n<a href=\"https://github.com/golang/go/wiki/SettingGOPATH\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/SettingGOPATH</a></p>\n\n<p>You can also run the <a href=\"https://golang.org/cmd/go/#hdr-GOPATH_environment_variable\" rel=\"nofollow noreferrer\"><code>go help gopath</code></a> command for more documentation.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 825, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1544022326, "creation_date": 1543999624, "last_edit_date": 1544002544, "question_id": 53628305, "link": "https://stackoverflow.com/questions/53628305/install-golang-library-within-subdirectory-of-github-repo", "title": "Install golang library within subdirectory of Github repo", "body": "<p>Normally Golang projects on Github are consumed by <code>go install</code> when there is a <code>src</code> folder at the root of the project. Right now I have a Git repo structured like so:</p>\n\n<pre><code>project/\n  lang/\n    typescript/\n    java/\n    golang/\n        src/\n        pkg/\n</code></pre>\n\n<p>is there a way to use <code>go install</code> against this git repo? Something like this:</p>\n\n<pre><code>go install 'github.com/org/project' --dir 'lang/golang'\n</code></pre>\n\n<p>anybody know if this is possible and how? Perhaps I can use <code>go get</code> first to get the right directory, and then <code>go install</code> after that?</p>\n\n<p><strong>Update</strong> - perhaps one solution is to use <code>go bundle</code> to package the library, and then install the go library with a url to the file?</p>\n"}, {"tags": ["ios", "objective-c", "go", "networkextension", "gomobile"], "answers": [{"tags": [], "owner": {"reputation": 2471, "user_id": 5662893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5wAey.jpg?s=128&g=1", "display_name": "Imran", "link": "https://stackoverflow.com/users/5662893/imran"}, "is_accepted": false, "score": 0, "last_activity_date": 1574140292, "creation_date": 1574140292, "answer_id": 58927040, "question_id": 53628100, "link": "https://stackoverflow.com/questions/53628100/network-extension-log/58927040#58927040", "title": "Network extension log", "body": "<p>The logs from Network extensions do not go to Xcode console.\nto see the logs from Network extension you have to follow the bellow steps.</p>\n\n<p><strong>1.</strong> Open the console application.</p>\n\n<p><strong>2.</strong> Select your iOS device running the network extension you will see all the logs from your device.</p>\n\n<p><strong>3.</strong> Filter the logs by Network extension target name now you will see\n    the logs only from your network extension.</p>\n"}], "owner": {"reputation": 1, "user_id": 10748268, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-d2FsenT6p0M/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hfzMtJOCyCyPCNg54iQ19enRJK2g/mo/photo.jpg?sz=128", "display_name": "user10748268", "link": "https://stackoverflow.com/users/10748268/user10748268"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574140292, "creation_date": 1543998832, "last_edit_date": 1544000795, "question_id": 53628100, "link": "https://stackoverflow.com/questions/53628100/network-extension-log", "title": "Network extension log", "body": "<p>I have sample Go example like this: </p>\n\n<pre><code>import \"github.com/jedisct1/dlog\"\n\nfunc Hi() {\n    dlog.Init(\"HI\", dlog.SeverityNotice, \"DAEMON\")\n    dlog.Noticef(\"Hi \")\n}\n</code></pre>\n\n<p>I build this project to with Go mobile, and call it from an iOS app, and everything is OK. I can see log in debug panel of Xcode.  But when I link it with network extension and call the 'hi' function, I can't see any thing in console or xcode debug panel. </p>\n\n<p>How can I show logs when build Go framework to iOS and run in network extension?</p>\n"}, {"tags": ["file", "http", "go", "writefile"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1543999756, "post_id": 53626396, "comment_id": 94116368, "body": "Aside: the bound check should be <code>endByte &gt;= length</code>."}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 1428174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cBcRG.jpg?s=128&g=1", "display_name": "savidude", "link": "https://stackoverflow.com/users/1428174/savidude"}, "is_accepted": false, "score": 0, "last_activity_date": 1543993405, "creation_date": 1543993405, "answer_id": 53626880, "question_id": 53626396, "link": "https://stackoverflow.com/questions/53626396/writing-to-byte-range-within-a-file-in-go/53626880#53626880", "title": "Writing to byte range within a file in Go", "body": "<p>Figured out how to do this. Change the addToFile function as shown below.</p>\n\n<pre><code>func addToFile(filepath string, startByte int, data []byte) {\n    f, err := os.OpenFile(filepath, os.O_CREATE | os.O_WRONLY, os.ModeAppend)\n    if err != nil {\n        panic(\"File not found\")\n    }\n    whence := io.SeekStart\n    _, err = f.Seek(int64(startByte), whence)\n    f.Write(data)\n    f.Sync() //flush to disk\n    f.Close()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1543993889, "creation_date": 1543993889, "answer_id": 53626988, "question_id": 53626396, "link": "https://stackoverflow.com/questions/53626396/writing-to-byte-range-within-a-file-in-go/53626988#53626988", "title": "Writing to byte range within a file in Go", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"io/ioutil\"\n    \"os\"\n)\n\nfunc write(ws io.WriteSeeker, offset int64, p []byte) (n int, err error) {\n    _, err = ws.Seek(offset, io.SeekStart)\n    if err != nil {\n        return 0, err\n    }\n    n, err = ws.Write(p)\n    if err != nil {\n        return 0, err\n    }\n    return n, nil\n}\n\nfunc main() {\n    filename := `test.file`\n    f, err := os.Create(filename)\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        return\n    }\n    defer f.Close()\n    buf := make([]byte, 16)\n    for i := range buf {\n        buf[i] = byte('A' + i)\n    }\n    _, err = write(f, 16, buf)\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        return\n    }\n    for i := range buf {\n        buf[i] = byte('a' + i)\n    }\n    _, err = write(f, 0, buf)\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        return\n    }\n    err = f.Close()\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        return\n    }\n    data, err := ioutil.ReadFile(filename)\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        return\n    }\n    fmt.Printf(\"%q\\n\", data)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>\"abcdefghijklmnopABCDEFGHIJKLMNOP\"\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 1428174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cBcRG.jpg?s=128&g=1", "display_name": "savidude", "link": "https://stackoverflow.com/users/1428174/savidude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 393, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1543993889, "creation_date": 1543991357, "question_id": 53626396, "link": "https://stackoverflow.com/questions/53626396/writing-to-byte-range-within-a-file-in-go", "title": "Writing to byte range within a file in Go", "body": "<p>I am downloading a large file in concurrent Chunks of 10MB using GO as shown below.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"strconv\"\n)\n\nfunc main() {\n    chunkSize := 1024 * 1024 * 10 // 10MB\n    url := \"http://path/to/large/zip/file/zipfile.zip\"\n    filepath := \"zipfile.zip\"\n    res, _ := http.Head(url)\n    maps := res.Header\n    length, _ := strconv.Atoi(maps[\"Content-Length\"][0]) // Get the content length from the header request\n\n    // startByte and endByte determines the positions of the chunk that should be downloaded\n    var startByte = 0\n    var endByte = chunkSize - 1\n\n    for startByte &lt; length {\n        if endByte &gt; length {\n            endByte = length - 1\n        }\n        go func(startByte, endByte int) {\n            client := &amp;http.Client {}\n            req, _ := http.NewRequest(\"GET\", url, nil)\n\n            rangeHeader := fmt.Sprintf(\"bytes=%d-%d\", startByte, endByte)\n            req.Header.Add(\"Range\", rangeHeader)\n            resp,_ := client.Do(req)\n            defer resp.Body.Close()\n\n            data, _ := ioutil.ReadAll(resp.Body)\n            addToFile(filepath, startByte, endByte, data)\n        }(startByte, endByte)\n\n        startByte = endByte + 1\n        endByte += chunkSize\n    }\n}\n\nfunc addToFile(filepath string, startByte, endByte int, data []byte) {\n    // TODO: write to byte range in file\n}\n</code></pre>\n\n<p>How should I go about creating the file, and writing to a specified byte range within the file corresponding to the byte range of the chunk?</p>\n\n<p>For example, if I get the data from the bytes 262144000-272629759, the addToFile function should write to 262144000-272629759 within the zipfile.zip. Then, if data from another range is obtained, that should be written to the respective range in zipfile.zip.</p>\n"}, {"tags": ["database", "go", "row", "ref"], "comments": [{"owner": {"reputation": 353, "user_id": 3593762, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cF6wa1FSnfQ/AAAAAAAAAAI/AAAAAAAAAAU/hbSKP7G8_s8/photo.jpg?sz=128", "display_name": "Ali Zohrevand", "link": "https://stackoverflow.com/users/3593762/ali-zohrevand"}, "edited": false, "score": 0, "creation_date": 1543991257, "post_id": 53625938, "comment_id": 94112599, "body": "have you properly create db object?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1543993340, "post_id": 53625938, "comment_id": 94113400, "body": "What do you mean &quot;I get nothing&quot;? Your output is obviously something, <i>not</i> nothing."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1544019906, "post_id": 53625938, "comment_id": 94128285, "body": "<a href=\"https://golang.org/pkg/database/sql/#Rows\" rel=\"nofollow noreferrer\"><code>sql.Rows</code></a> exposes an interface for iterating the result set. Printing the <code>sql.Rows</code> itself will get you nothing of value (the same as e.g. printing an <code>io.Reader</code> instead of actually reading from it)."}], "answers": [{"comments": [{"owner": {"reputation": 575, "user_id": 7098465, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/1208630015850926/picture?type=large", "display_name": "Vasilij Altunin", "link": "https://stackoverflow.com/users/7098465/vasilij-altunin"}, "edited": false, "score": 0, "creation_date": 1544047601, "post_id": 53626897, "comment_id": 94142435, "body": "Yes, thanks, i forgot to remove it, so it just close conenction, after return :)"}], "tags": [], "owner": {"reputation": 140, "user_id": 5115007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3667e565469ab7020a2a4b6c0aeb4392?s=128&d=identicon&r=PG&f=1", "display_name": "Prabesh P", "link": "https://stackoverflow.com/users/5115007/prabesh-p"}, "is_accepted": true, "score": 3, "last_activity_date": 1543993475, "creation_date": 1543993475, "answer_id": 53626897, "question_id": 53625938, "link": "https://stackoverflow.com/questions/53625938/how-return-ref-var-from-function/53626897#53626897", "title": "How return ref var from function", "body": "<p>defer rows.Close() gets executed when function returns</p>\n\n<pre><code>  func getData(query string, db *sql.DB) *sql.Rows {\n    rows, err := db.Query(query)\n    if err != nil {\n        fmt.Println(\"SQL select error: \")\n        log.Fatal(err)\n    }\n    defer rows.Close()\n\n    return rows\n}\n</code></pre>\n\n<p>That's why you're not able to read data</p>\n"}], "owner": {"reputation": 575, "user_id": 7098465, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/1208630015850926/picture?type=large", "display_name": "Vasilij Altunin", "link": "https://stackoverflow.com/users/7098465/vasilij-altunin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 53626897, "answer_count": 1, "score": -2, "last_activity_date": 1543993475, "creation_date": 1543989059, "last_edit_date": 1543993324, "question_id": 53625938, "link": "https://stackoverflow.com/questions/53625938/how-return-ref-var-from-function", "title": "How return ref var from function", "body": "<p>I just begin to learn Go, and have a problem with returning ref vars from function</p>\n\n<p>I have a function to get rows from a DB table:</p>\n\n<pre><code>func getData(query string, db *sql.DB) *sql.Rows {\n    rows, err := db.Query(query)\n    if err != nil {\n        fmt.Println(\"SQL select error: \")\n        log.Fatal(err)\n    }\n    defer rows.Close()\n\n    return rows\n}\n</code></pre>\n\n<p>now I try to get data from db</p>\n\n<pre><code>rows := getData(\"select * from all_obrash\", db)\nfmt.Println(rows)\n</code></pre>\n\n<p>I expect it just returns <code>*sql.Rows</code> but I get nothing </p>\n\n<pre><code>&amp;{0xc00025e100 0x4cf270 0xc0002743c0 &lt;nil&gt; 0xc000248180 {{0 0} 0 0 0 0} true &lt;nil&gt; []}\n</code></pre>\n\n<p>When I call from <code>main()</code> it works just fine, but when I move code to <code>func</code> it stop get rows, I think I miss something here.</p>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1543991587, "post_id": 53625439, "comment_id": 94112702, "body": "Make <code>Format</code> a method of <code>Money</code> instead of <code>*Money</code>."}, {"owner": {"reputation": 3322, "user_id": 966798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b52a10544df0260f8eab84b3bbea4bb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/966798/matt"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1544052755, "post_id": 53625439, "comment_id": 94144120, "body": "Thanks @Volker, that was the problem. If you want to put this in an answer I&#39;ll accept it."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1544021425, "post_id": 53629163, "comment_id": 94129397, "body": "It doesn&#39;t need to be exported as long as its fields/methods are (and they are)."}, {"owner": {"reputation": 3322, "user_id": 966798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b52a10544df0260f8eab84b3bbea4bb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/966798/matt"}, "edited": false, "score": 0, "creation_date": 1544046745, "post_id": 53629163, "comment_id": 94142146, "body": "The struct is local to the method it&#39;s used in, and I can already access the fields in the template."}], "tags": [], "owner": {"reputation": 73, "user_id": 6004683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b889f8adbb1169a263d40632ac908b8e?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Patel", "link": "https://stackoverflow.com/users/6004683/himanshu-patel"}, "is_accepted": false, "score": -1, "last_activity_date": 1544002568, "creation_date": 1544002568, "answer_id": 53629163, "question_id": 53625439, "link": "https://stackoverflow.com/questions/53625439/how-to-call-a-function-on-a-custom-type/53629163#53629163", "title": "How to call a function on a custom type", "body": "<p>It looks like your <code>data</code> struct is unexported.\nDo this:</p>\n\n<pre><code>type Data struct { \n\n}\n</code></pre>\n"}], "owner": {"reputation": 3322, "user_id": 966798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b52a10544df0260f8eab84b3bbea4bb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/966798/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1544002568, "creation_date": 1543986037, "last_edit_date": 1543993613, "question_id": 53625439, "link": "https://stackoverflow.com/questions/53625439/how-to-call-a-function-on-a-custom-type", "title": "How to call a function on a custom type", "body": "<p>I've seen some similar questions but I can't find one that solves my problem.</p>\n\n<p>I have a custom <code>Money</code> type that aliases int64 with a function that formats the value as a string:</p>\n\n<pre><code>type Money int64\n\nfunc (m *Money) Format() string {\n    abs := math.Abs(int64(*m))\n\n    dollars := int64(abs) / 100\n    cents := int64(abs) % 100\n\n    sign := \"\"\n    if *m &lt; 0 {\n        sign = \"-\"\n    }\n\n    return fmt.Sprintf(\"%s$%d.%0.2d\", sign, dollars, cents)\n}\n</code></pre>\n\n<p>I have a HTML template that I pass a data struct. The struct has a list of invoice items on it that each have a Money field, and another Money field that holds the total.</p>\n\n<pre><code>type InvoiceItem {\n    // ...\n    Cost money.Money\n}\n\ntype data struct {\n    Name      string\n    Items     []*model.InvoiceItem\n    StartDate time.Time\n    EndDate   time.Time\n    Total     money.Money\n}\n</code></pre>\n\n<p>I pass the <code>data</code> to my template and execute it:</p>\n\n<pre><code>t := template.Must(template.New(title).Parse(templateString))\nt.Execute(&amp;buf, data)\n</code></pre>\n\n<p>In my template I range over the invoice items and call the <code>Format</code> function on the <code>Money</code> object. This works:</p>\n\n<pre><code>{{range .Items}}\n&lt;tr&gt;\n    &lt;td&gt;{{.Description}}&lt;/td&gt;\n    &lt;td&gt;{{.Cost.Format}}&lt;/td&gt;\n&lt;/tr&gt;\n{{end}}\n</code></pre>\n\n<p>Later on I attempt to print the total field:</p>\n\n<pre><code>&lt;td&gt;&lt;strong&gt;{{ .Total.Format }}&lt;/strong&gt;&lt;/td&gt;\n</code></pre>\n\n<p>My templates throws an error:</p>\n\n<pre><code> ... executing \"Invoice Items\" at &lt;.Total.Format&gt;: can't evaluate field Format in type money.Money\n</code></pre>\n\n<p>Why is it that I can call <code>Format</code> on the <code>Money</code> field when I range over the list of invoice items, but I can't call it on the <code>data.Total</code> object? From the error message it seems that the template knows that the type of <code>Total</code> is <code>Money</code>, so what's the problem?</p>\n"}, {"tags": ["go", "post", "request", "postman"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 10579479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04dcf977649e5fdf638914172fe91c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Jond", "link": "https://stackoverflow.com/users/10579479/jond"}, "edited": false, "score": 0, "creation_date": 1543984421, "post_id": 53625220, "comment_id": 94110517, "body": "I don&#39;t want to change the code. Does it mean that I should move the body request to form data  in POSTMAN? Check my code above, I have added more details."}, {"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "reply_to_user": {"reputation": 47, "user_id": 10579479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04dcf977649e5fdf638914172fe91c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Jond", "link": "https://stackoverflow.com/users/10579479/jond"}, "edited": false, "score": 0, "creation_date": 1543984781, "post_id": 53625220, "comment_id": 94110633, "body": "Yes, check my edit for how you can parse the form request."}], "tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": true, "score": 1, "last_activity_date": 1543984763, "last_edit_date": 1543984763, "creation_date": 1543984325, "answer_id": 53625220, "question_id": 53625035, "link": "https://stackoverflow.com/questions/53625035/access-post-request-value-in-formvalue-golang-using-postman/53625220#53625220", "title": "Access POST Request Value in FormValue Golang using POSTMAN", "body": "<p>What you have there is not a <code>FormValue</code> but a <code>JSON</code> body. If your JSON object is just a simple map of string to string, then you can do something like this:</p>\n\n<pre><code>func search(w http.ResponseWriter, r *http.Request) {\n\n    body, _ := ioutil.ReadAll(r.Body) // check for errors\n\n    keyVal := make(map[string]string)\n    json.Unmarshal(body, &amp;keyVal) // check for errors\n\n    name := keyVal[\"name\"]\n\n    // do whatever with name\n\n}\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>If you need to parse a form value you need to call <code>ParseForm()</code></p>\n\n<pre><code>func search(w http.ResponseWriter, r *http.Request) {\n\n    err := r.ParseForm()\n    if err != nil {\n        // handle err\n    }\n\n    name := r.FormValue(\"name\")\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 659, "user_id": 1155514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjZMX.jpg?s=128&g=1", "display_name": "Muhammad Tariq", "link": "https://stackoverflow.com/users/1155514/muhammad-tariq"}, "is_accepted": false, "score": 0, "last_activity_date": 1607101231, "creation_date": 1607101231, "answer_id": 65147630, "question_id": 53625035, "link": "https://stackoverflow.com/questions/53625035/access-post-request-value-in-formvalue-golang-using-postman/65147630#65147630", "title": "Access POST Request Value in FormValue Golang using POSTMAN", "body": "<p>Just want to share additional information here.</p>\n<p>Please check the Content-Type in Header section of Postman if you are facing any problem in sending your request to the server.</p>\n<ul>\n<li>Set <code>Content-Type</code> to <code>application/json</code> for sending raw JSON in request.</li>\n<li>Set <code>Content-Type</code> to <code>application/x-www-form-urlencoded</code> if you are sending form values in request. Also select <code>x-www-form-urlencoded</code> in postman's Body section</li>\n</ul>\n"}], "owner": {"reputation": 47, "user_id": 10579479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04dcf977649e5fdf638914172fe91c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Jond", "link": "https://stackoverflow.com/users/10579479/jond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1368, "favorite_count": 0, "accepted_answer_id": 53625220, "answer_count": 2, "score": 0, "last_activity_date": 1607101231, "creation_date": 1543982859, "last_edit_date": 1543984598, "question_id": 53625035, "link": "https://stackoverflow.com/questions/53625035/access-post-request-value-in-formvalue-golang-using-postman", "title": "Access POST Request Value in FormValue Golang using POSTMAN", "body": "<p>I have no idea why I always receive an empty string when sending values in POSTMAN </p>\n\n<pre><code>func main(){\n     rtr := mux.NewRouter()\n     rtr.HandleFunc(\"/search\", search).Methods(\"POST\")\n}\nfunc search(w http.ResponseWriter, r *http.Request) {\n     name := r.FormValue(\"name\") //returns empty \n\n}\n</code></pre>\n\n<p>This is the body request in POSTMAN </p>\n\n<p><a href=\"https://i.stack.imgur.com/k4O36.png\" rel=\"nofollow noreferrer\">screenshot for the body request</a></p>\n\n<pre><code>{\n   \"name\": \"markus\"\n\n\n}\n</code></pre>\n\n<p>I tried to change the body request to form data </p>\n\n<p><a href=\"https://i.stack.imgur.com/2lAI0.png\" rel=\"nofollow noreferrer\">Screenshot for form data in post request</a></p>\n\n<p>But it still didn't work. </p>\n\n<p>Does anyone have a solution? </p>\n\n<p>Thanks </p>\n"}, {"tags": ["reactjs", "go", "gcloud"], "comments": [{"owner": {"reputation": 1255, "user_id": 4982148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X52Wq.jpg?s=128&g=1", "display_name": "atakanyenel", "link": "https://stackoverflow.com/users/4982148/atakanyenel"}, "edited": false, "score": 0, "creation_date": 1543971668, "post_id": 53623541, "comment_id": 94107603, "body": "Is moving <code>reactUI</code> component outside the project directory an option ? React has its own runtime so, it doesn&#39;t need go code on the same directory."}, {"owner": {"reputation": 2185, "user_id": 5167919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d8f16bd4f99de76ca51badf149eb641?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5167919/josh"}, "reply_to_user": {"reputation": 1255, "user_id": 4982148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X52Wq.jpg?s=128&g=1", "display_name": "atakanyenel", "link": "https://stackoverflow.com/users/4982148/atakanyenel"}, "edited": false, "score": 0, "creation_date": 1544043491, "post_id": 53623541, "comment_id": 94140725, "body": "For most of the reactUI contents, yes. However the &#39;build&#39; directory inside the &#39;reactUI&#39; directory must stay in place. I am using go to serve the index.html file and the css and js files created by react native. Maybe there is a way to set this up in the React build settings? I will have to look into it."}], "answers": [{"comments": [{"owner": {"reputation": 2185, "user_id": 5167919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d8f16bd4f99de76ca51badf149eb641?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5167919/josh"}, "edited": false, "score": 0, "creation_date": 1544126744, "post_id": 53641850, "comment_id": 94175974, "body": "To help anyone with this specific issue, simply add the following to your app.yaml file: skip_files: - ^node_modules(/.*)?  - .*node_modules"}], "tags": [], "owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "is_accepted": true, "score": 1, "last_activity_date": 1544049539, "creation_date": 1544049539, "answer_id": 53641850, "question_id": 53623541, "link": "https://stackoverflow.com/questions/53623541/how-can-i-force-gcloud-cli-to-not-monitor-certain-directories-when-running-dev-a/53641850#53641850", "title": "How can I force gcloud cli to not monitor certain directories when running dev_appserver.py?", "body": "<p>With <a href=\"https://issuetracker.google.com/issues/35895450\" rel=\"nofollow noreferrer\">https://issuetracker.google.com/issues/35895450</a> fixed the development server is supposed to not monitor changes in the files/directories matching the patterns specified in the <a href=\"https://cloud.google.com/appengine/docs/standard/go/config/appref#skip_files\" rel=\"nofollow noreferrer\"><code>skip_files</code></a> section of the app/service's <code>.yaml</code> file.</p>\n\n<p>So you can try to add a <code>skip_files</code> section to the go app's <code>.yaml</code> file specifying  the patterns for the files/directories you want ignored. Be careful to also add the default patterns (otherwise you'd lose them).</p>\n"}], "owner": {"reputation": 2185, "user_id": 5167919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d8f16bd4f99de76ca51badf149eb641?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5167919/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 53641850, "answer_count": 1, "score": 0, "last_activity_date": 1589677167, "creation_date": 1543970560, "last_edit_date": 1589677167, "question_id": 53623541, "link": "https://stackoverflow.com/questions/53623541/how-can-i-force-gcloud-cli-to-not-monitor-certain-directories-when-running-dev-a", "title": "How can I force gcloud cli to not monitor certain directories when running dev_appserver.py?", "body": "<p>I'm developing an app locally using Go and React with a project structure that looks somewhat like this: </p>\n\n<pre><code>/reactApp \n   /main.go\n   /api \n   /reactUI \n</code></pre>\n\n<p>While I am developing locally I am using the gcloud cli tool to run the Go code, and I'm using Node to run the UI. I need to handle CORS of course, but otherwise this works fairly well. The problem is there are too many files in the /reactUI directory for the gcloud cli tool to monitor them all. This means I need to manually start and stop the server every time I make a change to the Go source code. </p>\n\n<p>The reactUI directory was created using the 'npx create-react-app' command. Since I'm running the react part of this app locally using node (and that handles file monitoring and auto-updating just fine), how can I get the gcloud tool to ignore the reactUI directory?</p>\n\n<p>Basically I just want the gcloud tool to monitor the API part of the app, and not the UI part. If I make a change to the API part of the app the gcloud local server should automatically recompile and restart.  </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 482, "user_id": 4760674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tMvVK.jpg?s=128&g=1", "display_name": "Major", "link": "https://stackoverflow.com/users/4760674/major"}, "edited": false, "score": 0, "creation_date": 1543963691, "post_id": 53622400, "comment_id": 94105615, "body": "What OS are you trying to run on?"}, {"owner": {"reputation": 1463, "user_id": 1892775, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/a05d3ed9866b27ffd474053d3884394e?s=128&d=identicon&r=PG", "display_name": "user1892775", "link": "https://stackoverflow.com/users/1892775/user1892775"}, "reply_to_user": {"reputation": 482, "user_id": 4760674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tMvVK.jpg?s=128&g=1", "display_name": "Major", "link": "https://stackoverflow.com/users/4760674/major"}, "edited": false, "score": 0, "creation_date": 1543965693, "post_id": 53622400, "comment_id": 94106144, "body": "I use both Windows and Linux"}, {"owner": {"reputation": 1086, "user_id": 974992, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pVJbN.png?s=128&g=1", "display_name": "Dan Doe", "link": "https://stackoverflow.com/users/974992/dan-doe"}, "edited": false, "score": 2, "creation_date": 1543979816, "post_id": 53622400, "comment_id": 94109494, "body": "If you are dead set on using ANY key, check out this question <a href=\"https://stackoverflow.com/questions/40159137/golang-reading-from-stdin-how-to-detect-special-keys-enter-backspace-etc\" title=\"golang reading from stdin how to detect special keys enter backspace etc\">stackoverflow.com/questions/40159137/&hellip;</a>"}], "owner": {"reputation": 1463, "user_id": 1892775, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/a05d3ed9866b27ffd474053d3884394e?s=128&d=identicon&r=PG", "display_name": "user1892775", "link": "https://stackoverflow.com/users/1892775/user1892775"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1543993811, "creation_date": 1543962446, "last_edit_date": 1543993811, "question_id": 53622400, "link": "https://stackoverflow.com/questions/53622400/how-to-detect-if-a-key-was-pressed-by-user-and-continue", "title": "How to detect if a key was pressed by user and continue", "body": "<p>I am new to Go, and wanted to display a text to the user and wait for the user to press any key. As soon as the user presses a key, it should proceed to the next line of code else it should stay there. How do we achieve that in Go?</p>\n\n<p>Let's say the text is: \"Press any key to proceed...\"\nand I display as:</p>\n\n<pre><code>fmt.Printf(Press any key to proceed...\")\n</code></pre>\n\n<p>After this how do I detect whether a key was pressed in order to continue?</p>\n"}, {"tags": ["go", "amazon-dynamodb"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1544000814, "post_id": 53622236, "comment_id": 94116870, "body": "omitempty on a string pointer doesn&#39;t omit pointers to an empty string: <a href=\"https://play.golang.org/p/D4ijz4aVLok\" rel=\"nofollow noreferrer\">play.golang.org/p/D4ijz4aVLok</a> Any non-nil pointer isn&#39;t empty as far the JSON package is concerned."}, {"owner": {"reputation": 2586, "user_id": 3548468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/U5OZO.png?s=128&g=1", "display_name": "kkesley", "link": "https://stackoverflow.com/users/3548468/kkesley"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1544064703, "post_id": 53622236, "comment_id": 94146837, "body": "hmmm that&#39;s weird! I can&#39;t seem to update the dynamodb when I use <code>omitempty</code> on the struct. Maybe it&#39;s because of <code>dynamodbattribute</code>? I&#39;ll take a look!"}, {"owner": {"reputation": 2586, "user_id": 3548468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/U5OZO.png?s=128&g=1", "display_name": "kkesley", "link": "https://stackoverflow.com/users/3548468/kkesley"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1544066070, "post_id": 53622236, "comment_id": 94147149, "body": "hmmm the problem seems to be dynamodb does not allow empty string and it converts it to null. But because of omitempty, null values are ignored."}], "answers": [{"tags": [], "owner": {"reputation": 2586, "user_id": 3548468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/U5OZO.png?s=128&g=1", "display_name": "kkesley", "link": "https://stackoverflow.com/users/3548468/kkesley"}, "is_accepted": true, "score": 0, "last_activity_date": 1544067352, "creation_date": 1544067352, "answer_id": 53644266, "question_id": 53622236, "link": "https://stackoverflow.com/questions/53622236/using-struct-to-update-values/53644266#53644266", "title": "Using struct to update values", "body": "<p>After several trials, I finally got it. I didn't test it so I don't know whether it's buggy or not. But it seems to work for me right now.</p>\n\n<p>So what I did was encode the struct with <code>json.Marshal</code> first then use <code>json.Unmarshal</code> with a <code>map[string]interface{}</code>. Then, I use <code>dynamodbattribute.Marshal</code> to convert it to <code>map[string]*AttributeValue</code></p>\n\n<p>Here's the code:</p>\n\n<pre><code>var temp map[string]interface{}\njson.Unmarshal(tempStr, &amp;temp)\nvalAttr, err := dynamodbattribute.MarshalMap(temp)\nif err != nil {\n    return nil, err\n}\n</code></pre>\n"}], "owner": {"reputation": 2586, "user_id": 3548468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/U5OZO.png?s=128&g=1", "display_name": "kkesley", "link": "https://stackoverflow.com/users/3548468/kkesley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 53644266, "answer_count": 1, "score": 0, "last_activity_date": 1544067352, "creation_date": 1543961622, "last_edit_date": 1544065478, "question_id": 53622236, "link": "https://stackoverflow.com/questions/53622236/using-struct-to-update-values", "title": "Using struct to update values", "body": "<p>I'm stuck when I'm updating an empty string values in a struct for updating dynamodb table.</p>\n\n<p>Currently I have this struct</p>\n\n<pre><code>type Client struct {\n    ClientID       *string    `json:\"client_key,omitempty\"`\n    Name           *string    `json:\"client_name,omitempty\"`\n    Address        *string    `json:\"address,omitempty\"`\n    Country        *string    `json:\"country,omitempty\"`\n    City           *string    `json:\"city,omitempty\"`\n    State          *string    `json:\"state,omitempty\"`\n    PostCode       *string    `json:\"post_code,omitempty\"`\n    CreatedAt      *time.Time `json:\"created_at,omitempty\"`\n}\n</code></pre>\n\n<p>And this code when updating an item</p>\n\n<pre><code>keyAttr, err := dynamodbattribute.MarshalMap(key)\nif err != nil {\n    return nil, err\n}\nvalAttr, err := dynamodbattribute.MarshalMap(attributes)\nif err != nil {\n    return nil, err\n}\n</code></pre>\n\n<p><code>keyAttr</code> will be used for the <code>Key</code> field and <code>valAttr</code> will be used in <code>ExpressionAttributeValues</code> field. Note that I didn't include the complete updating fields function to save space. But I will do that if you ask for it.</p>\n\n<p>Currently the function is running fine except when I updated one of the field with empty string. E.g. <code>client.Address = aws.String(\"\")</code>. While I'm fine with dynamodb converting my empty string to <code>null</code>, I can't seem to find a way to update it because of the <code>omitempty</code> tag.</p>\n\n<p>I need the omitempty tag to ignore all <code>nil</code> values. However, I just researched that the <code>omitempty</code> tag also omits empty string values. Currently I have to make a struct in my function like this.</p>\n\n<pre><code>type client struct {\n    Name     *string `json:\"client_name\"`\n    Address  *string `json:\"address\"`\n    Country  *string `json:\"country\"`\n    City     *string `json:\"city\"`\n    State    *string `json:\"state\"`\n    PostCode *string `json:\"post_code\"`\n}\n</code></pre>\n\n<p>But i'm not a fan of repeating things. So, the question is: is there any better way of doing this? How do you guys use structs with dynamodb?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Based on @Peter's comment, it seems that <code>json.Encode()</code> does print the empty string if it's not nil.</p>\n\n<p><code>{\"client_key\":\"test\",\"username\":\"test\",\"email\":\"\",\"first_name\":\"test\",\"last_name\":\"\",\"phone\":\"\",\"title\":\"\",\"email_verified\":false,\"phone_verified\":false,\"updated_at\":\"2018-12-06T14:04:56.2743841+11:00\"}</code></p>\n\n<p>The problem seems to be in <code>dynamodbattribute.MarshalMap</code> function</p>\n"}, {"tags": ["amazon-web-services", "docker", "go", "aws-ecr"], "answers": [{"comments": [{"owner": {"reputation": 918, "user_id": 738963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cd3d018a2a2ce5de766500362b0d5eb?s=128&d=identicon&r=PG", "display_name": "A_Porcupine", "link": "https://stackoverflow.com/users/738963/a-porcupine"}, "edited": false, "score": 0, "creation_date": 1590355681, "post_id": 53621613, "comment_id": 109643559, "body": "Thanks, just ran into the same, documentation leaves a lot to be desired."}], "tags": [], "owner": {"reputation": 463, "user_id": 2512907, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pnQlH.jpg?s=128&g=1", "display_name": "noqcks", "link": "https://stackoverflow.com/users/2512907/noqcks"}, "is_accepted": false, "score": 2, "last_activity_date": 1543958646, "creation_date": 1543958646, "answer_id": 53621613, "question_id": 53621463, "link": "https://stackoverflow.com/questions/53621463/docker-imagepush-failing-with-no-basic-auth-credentials/53621613#53621613", "title": "Docker ImagePush failing with &quot;no basic auth credentials&quot;", "body": "<p>I found out in a GitHub comment that <code>RegistryAuth</code> actually needs to be a base64 JSON string with username and password fields. Ugh. This is undocumented in the Docker repository.</p>\n\n<pre><code>RegistryAuth = \"{ \\\"username\\\": \\\"myusername\\\", \\\"password\\\": \\\"mypassword\\\", \\\"email\\\": \\\"myemail\\\" }\n</code></pre>\n\n<p><a href=\"https://github.com/moby/moby/issues/34503#issuecomment-358253070\" rel=\"nofollow noreferrer\">Relevant GitHub comment</a>.</p>\n\n<p>It is working for me now. </p>\n"}], "owner": {"reputation": 463, "user_id": 2512907, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pnQlH.jpg?s=128&g=1", "display_name": "noqcks", "link": "https://stackoverflow.com/users/2512907/noqcks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1078, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543993776, "creation_date": 1543957864, "last_edit_date": 1543993776, "question_id": 53621463, "link": "https://stackoverflow.com/questions/53621463/docker-imagepush-failing-with-no-basic-auth-credentials", "title": "Docker ImagePush failing with &quot;no basic auth credentials&quot;", "body": "<p>I'm attempting to use the docker go-sdk to push an image to AWS ECR.</p>\n\n<p>This is the code I'm using to push the image.</p>\n\n<p>where tag = \".dkr.ecr.us-east-1.amazonaws.com/api:mytag\"</p>\n\n<pre><code>func Push(c context.Context, tag string, credentials string) error {\n    cli, err := client.NewClient(apiSocket, apiVersion, nil, apiHeaders)\n    if err != nil {\n        return err\n    }\n    fmt.Println(credentials)\n\n    resp, err := cli.ImagePush(c, tag, types.ImagePushOptions{\n        RegistryAuth: credentials,\n    })\n    if err != nil {\n        panic(err)\n    }\n\n    io.Copy(os.Stdout, resp)\n    resp.Close()\n\n    return nil\n}\n</code></pre>\n\n<p>But I keep getting this response:</p>\n\n<pre><code>{\"status\":\"The push refers to repository [&lt;id&gt;.dkr.ecr.us-east-1.amazonaws.com/api]\"}\n{\"status\":\"Preparing\",\"progressDetail\":{},\"id\":\"23432919a50a\"}\n{\"status\":\"Preparing\",\"progressDetail\":{},\"id\":\"9387ad10e44c\"}\n{\"status\":\"Preparing\",\"progressDetail\":{},\"id\":\"e2a4679276bf\"}\n{\"status\":\"Preparing\",\"progressDetail\":{},\"id\":\"31c5c8035e63\"}\n{\"status\":\"Preparing\",\"progressDetail\":{},\"id\":\"a73789d39a06\"}\n{\"status\":\"Preparing\",\"progressDetail\":{},\"id\":\"f36942254806\"}\n{\"status\":\"Preparing\",\"progressDetail\":{},\"id\":\"4a2596f9aa79\"}\n{\"status\":\"Preparing\",\"progressDetail\":{},\"id\":\"5cf3066ccdbc\"}\n{\"status\":\"Preparing\",\"progressDetail\":{},\"id\":\"76a1661c28fc\"}\n{\"status\":\"Preparing\",\"progressDetail\":{},\"id\":\"beefb6beb20f\"}\n{\"status\":\"Preparing\",\"progressDetail\":{},\"id\":\"df64d3292fd6\"}\n{\"status\":\"Waiting\",\"progressDetail\":{},\"id\":\"beefb6beb20f\"}\n{\"status\":\"Waiting\",\"progressDetail\":{},\"id\":\"df64d3292fd6\"}\n{\"errorDetail\":{\"message\":\"no basic auth credentials\"},\"error\":\"no basic auth credentials\"}\n</code></pre>\n\n<p>Any ideas? </p>\n\n<p>Notes: </p>\n\n<ul>\n<li>I've verified that the credentials string I'm passing in is a base64 encoded user:pass for the ECR registry. </li>\n<li>I've verified that the ECR credentials I'm getting are from the same AWS Region as where im attempting to push the image. </li>\n</ul>\n"}, {"tags": ["docker", "go", "dockerfile"], "comments": [{"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1543953346, "post_id": 53620118, "comment_id": 94101359, "body": "<code>docker exec -it --rm cli fzr version</code>"}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1543954408, "post_id": 53620118, "comment_id": 94101832, "body": "What\u2019s actually going wrong?  What\u2019s the actual <code>docker run</code> command and its actual output?"}], "answers": [{"comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1543954447, "post_id": 53620213, "comment_id": 94101848, "body": "Since it\u2019s a <code>FROM scratch</code> image, there\u2019s nothing else you can possibly set the entrypoint to.  You cannot, for example, get a shell in the container because there\u2019s no <code>&#47;bin&#47;sh</code>."}], "tags": [], "owner": {"reputation": 1686, "user_id": 2336125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46e3fdb318b8cf4062dd8a57ce9cf558?s=128&d=identicon&r=PG", "display_name": "odk", "link": "https://stackoverflow.com/users/2336125/odk"}, "is_accepted": true, "score": 1, "last_activity_date": 1543952095, "creation_date": 1543952095, "answer_id": 53620213, "question_id": 53620118, "link": "https://stackoverflow.com/questions/53620118/docker-with-go-cli-project/53620213#53620213", "title": "Docker with Go cli project", "body": "<p>TL;DR;\ndocker run -it cli version</p>\n\n<p>If you set ENTRYPOINT to your binary then everything that you pass after image name will be used as arg to that binary. If for some reason you need to overwrite entrypoint use --entrypoint flag to docker run.</p>\n"}], "owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 1, "accepted_answer_id": 53620213, "answer_count": 1, "score": 0, "last_activity_date": 1543952095, "creation_date": 1543951695, "question_id": 53620118, "link": "https://stackoverflow.com/questions/53620118/docker-with-go-cli-project", "title": "Docker with Go cli project", "body": "<p>I use the following docker file which works as expected \nThe project is a <code>cli</code> and when I run command <code>docker run -it cli</code> \nI got error from the cli (which is ok since  the entry point is just running fzr ENTRYPOINT [\"./fzr\u201d]) </p>\n\n<p>Typically I run in on my machine like <code>fzr -help</code> or <code>fzr version</code> etc</p>\n\n<p>I want that when I use command like <code>docker run -it cli</code> that I will be able to run commands inside the container</p>\n\n<p>like <code>fzr -help</code>  and  <code>fzr version</code>, how can I do that ?</p>\n\n<pre><code>FROM golang:1.10.5 AS build-env\n\n\nADD https://github.com/golang/dep/releases/download/v0.4.2/dep-linux-amd64 /usr/bin/dep\nRUN chmod +x /usr/bin/dep\n\nRUN mkdir -p $GOPATH/src/github.com/fzr\nWORKDIR  $GOPATH/src/github.com/fzr\n\n\nCOPY Gopkg.toml Gopkg.lock ./\n\n# install project dep\nRUN dep ensure \n\nCOPY . ./\n\nRUN  go build  -o /fzr\n\nFROM scratch\nCOPY --from=build-env /fzr ./\nENTRYPOINT [\"./fzr\"]\n</code></pre>\n"}, {"tags": ["go", "shared-libraries", "llvm", "fuzzing", "libfuzzer"], "comments": [{"owner": {"reputation": 133, "user_id": 8488000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c22b2b93a34820f8dde5eec9faae5f6?s=128&d=identicon&r=PG&f=1", "display_name": "reijin", "link": "https://stackoverflow.com/users/8488000/reijin"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1543958400, "post_id": 53619141, "comment_id": 94103592, "body": "@Flimzy Thanks for the grammar correction. :) One thing: I chose to write golang on purpose as searching for &quot;go&quot; via Google can lead to weird results. Whereas using the term &quot;golang&quot; is clear. And as it is tagged with &quot;go&quot; here, there is no need to use the &quot;Go&quot; term alone."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543961458, "post_id": 53619141, "comment_id": 94104824, "body": "Yes, googling for &quot;golang&quot; makes sense. But there&#39;s never a need for that here, as the [go] tag already has you covered."}, {"owner": {"reputation": 3889, "user_id": 561422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JwFD0.jpg?s=128&g=1", "display_name": "marco.m", "link": "https://stackoverflow.com/users/561422/marco-m"}, "edited": false, "score": 0, "creation_date": 1584878602, "post_id": 53619141, "comment_id": 107568868, "body": "Are you aware of <a href=\"https://github.com/dvyukov/go-fuzz\" rel=\"nofollow noreferrer\">github.com/dvyukov/go-fuzz</a> ? It can also generate a target for libfuzzer and should make your work a lot easier."}], "owner": {"reputation": 133, "user_id": 8488000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c22b2b93a34820f8dde5eec9faae5f6?s=128&d=identicon&r=PG&f=1", "display_name": "reijin", "link": "https://stackoverflow.com/users/8488000/reijin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 285, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1543993009, "creation_date": 1543947355, "last_edit_date": 1543993009, "question_id": 53619141, "link": "https://stackoverflow.com/questions/53619141/fuzzing-a-go-application-with-libfuzzer-wrong-coverage", "title": "Fuzzing a Go application with libfuzzer: wrong coverage", "body": "<p>I'm writing my thesis and would greatly appreciate some input on my current setup.\nI want to fuzz a target Go application with libfuzzer and therefore did the following:</p>\n\n<p>I wrote a main package that calls the go function to be tested. \nCode:</p>\n\n<pre><code>package main\nimport \"C\"\nimport \"$PACKAGE\"\nfunc main(){}\n//export Fuzz\nfunc Fuzz(data []byte){\n $PACKAGE.Fuzz(data) //actual Fuzzing function, which instruments the function under test  \n}\n</code></pre>\n\n<p>A main package is necessary for <code>llvm-go</code> to actually build the application as a shared library. The reason I have a double abstraction here is that I want my build pipeline to be compatible with go-fuzz, which uses the \"Fuzz\" function name as a fuzzing entry point. With my setup I can simply wrap around the code necessary to make use of libfuzzer.</p>\n\n<p>Then I compile the application with <code>llvm-go</code>.</p>\n\n<p>Now I have two ways to instrument the Go shared library: either load it dynamically or have it statically linked in my binary. I'll explain my issue using the statically linked code. For that I wrote some fuzzing stub that instruments the Go shared library. </p>\n\n<pre><code>// fuzz_target.cc\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;dlfcn.h&gt;\n#include \"golang-app.h\"\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *Data, size_t Size) {\n void *handle;\n char *error; \n GoSlice data = {(void*)Data, static_cast&lt;long long&gt;(Size), static_cast&lt;long long&gt;(Size)};\n Fuzz(data);\n return 0; // Non-zero return values are reserved for future use.\n}\n</code></pre>\n\n<p>Then compiled it with: </p>\n\n<pre><code>clang -g -O1 -fsanitize=fuzzer,address -o fuzz fuzzing-entry_static.cc ../golang-app.so\n</code></pre>\n\n<p>Now, when I run my code I see two issues:</p>\n\n<pre><code>master@thesis:~/go-libfuzz$ ./fuzz-static ./corpus/ -timeout=12\nINFO: Seed: 2260122321\nINFO: Loaded 1 modules   (1 inline 8-bit counters): 1 [0x787f60, 0x787f61),\nINFO: Loaded 1 PC tables (1 PCs): 1 [0x565bd0,0x565be0),\nINFO:       11 files found in ./corpus/\nINFO: -max_len is not provided; libFuzzer will not generate inputs larger than 18061 bytes\nINFO: seed corpus: files: 11 min: 450b max: 18061b total: 76971b rss: 51Mb\n#12     INITED cov: 1 ft: 1 corp: 1/450b exec/s: 0 rss: 53Mb\n#13     REDUCE cov: 1 ft: 1 corp: 1/282b exec/s: 0 rss: 53Mb L: 282/282 MS: 1 EraseBytes-\n[...]\n#193    REDUCE cov: 1 ft: 1 corp: 1/1b exec/s: 0 rss: 56Mb L: 1/1 MS: 1 EraseBytes-\n#65536  pulse  cov: 1 ft: 1 corp: 1/1b exec/s: 21845 rss: 63Mb\n#131072 pulse  cov: 1 ft: 1 corp: 1/1b exec/s: 26214 rss: 68Mb\n#262144 pulse  cov: 1 ft: 1 corp: 1/1b exec/s: 26214 rss: 79Mb\n#524288 pulse  cov: 1 ft: 1 corp: 1/1b exec/s: 27594 rss: 100Mb\n#1048576        pulse  cov: 1 ft: 1 corp: 1/1b exec/s: 27594 rss: 142Mb\n#2097152        pulse  cov: 1 ft: 1 corp: 1/1b exec/s: 27962 rss: 226Mb\n</code></pre>\n\n<p>The coverage and features do not seem to increase and the memory requirement increases every run. I was able to fix the memory increase thanks to another SO post by adding an environment variable to the fuzzer execution. <code>ASAN_OPTIONS=quarantine_size_mb=20 ./fuzz-target -timeout=12</code></p>\n\n<p>However, probably the main issue is that the actual target is \"buried\" under two levels of abstraction:\nLLVMFuzzerTestOneInput --calls--> shared Go library via main.go, which contains exported Fuzz function (exposed via CGo) which --calls--> Fuzzing function --calls--> target function. \nPlease note, however, that each of those functions just hands over the data directly to the next layer without making changes.\nWhat steps can I do to ensure this is working correctly? Am I doing something wrong?</p>\n"}, {"tags": ["loops", "for-loop", "go", "iteration"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 5, "creation_date": 1543931423, "post_id": 53614348, "comment_id": 94089487, "body": "Most likely you should only iterate until <code>i &lt; taglistlength</code> (not until <code>i &lt;= taglistlength</code>)."}, {"owner": {"reputation": 93, "user_id": 10209822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91868bc4cac62cb5aba3a0b67520bc08?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/10209822/priyanka"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543934276, "post_id": 53614348, "comment_id": 94091273, "body": "Thank you @icza for the response. I will edit my code accordingly."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1543936123, "post_id": 53614348, "comment_id": 94092383, "body": "I&#39;m voting to close this question as off-topic because it&#39;s too trivial to be considered a real question. Completion of even a basic introductory material such as <a href=\"https://tour.golang.org\" rel=\"nofollow noreferrer\">tour.golang.org</a> would have completely obviated the need to ask it."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 10209822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91868bc4cac62cb5aba3a0b67520bc08?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/10209822/priyanka"}, "edited": false, "score": 0, "creation_date": 1543934335, "post_id": 53615027, "comment_id": 94091301, "body": "Thank you @atayenel. I will do the changes u have suggested and run my code."}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 3, "creation_date": 1543937306, "post_id": 53615027, "comment_id": 94093153, "body": "<code>Many people are against using it</code> - who are these people and why are they against using <code>range</code>?"}, {"owner": {"reputation": 1255, "user_id": 4982148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X52Wq.jpg?s=128&g=1", "display_name": "atakanyenel", "link": "https://stackoverflow.com/users/4982148/atakanyenel"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1543937541, "post_id": 53615027, "comment_id": 94093309, "body": "@Gavin <a href=\"https://stackoverflow.com/questions/43031988/javascript-efficiency-for-vs-foreach\" title=\"javascript efficiency for vs foreach\">stackoverflow.com/questions/43031988/&hellip;</a> This question argues that <code>for</code> is more efficient in JS. I don&#39;t want to put this topic on the center of question though."}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 2, "creation_date": 1543937674, "post_id": 53615027, "comment_id": 94093415, "body": "@atayenel That questions is comparing <code>for</code> and <code>forEach</code> in JavaScript. You are talking about <code>for</code> and <code>for range</code> in Go. I don&#39;t see the similarities."}, {"owner": {"reputation": 93, "user_id": 10209822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91868bc4cac62cb5aba3a0b67520bc08?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/10209822/priyanka"}, "edited": false, "score": 0, "creation_date": 1543938895, "post_id": 53615027, "comment_id": 94094158, "body": "Thank you @atayenel. it worked for me."}], "tags": [], "owner": {"reputation": 1255, "user_id": 4982148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X52Wq.jpg?s=128&g=1", "display_name": "atakanyenel", "link": "https://stackoverflow.com/users/4982148/atakanyenel"}, "is_accepted": true, "score": 0, "last_activity_date": 1543933357, "creation_date": 1543933357, "answer_id": 53615027, "question_id": 53614348, "link": "https://stackoverflow.com/questions/53614348/index-out-of-range-in-for-loop-duplicate/53615027#53615027", "title": "index out of range in for loop (duplicate)", "body": "<p>There are couple of errors in this codeblock, so let's start:</p>\n\n<ul>\n<li><p>First you need to define your <code>taglistlength</code> <strong>again</strong> after this line <code>tagsList = [{ID00001 Band 9 B PERMANENT}{ID00002 Band 8 C PERMANENT}{ID00003 Band 7 C Temporary}]</code>. I believe that line is in the wrong place because you even define <code>tagList</code> after that line, if so , please edit your question.</p></li>\n<li><p>As @icza stated in the comment you have to do <code>i&lt;taglistLength</code>, not <code>&lt;=</code>. In Go, arrays are 0-indexed , so the index equals to the array length is out of bounds.</p></li>\n<li><p>If you want to be on the safe side you can do this <code>for _,tag:= range tagsList{\n...}</code> . This is a <code>foreach</code> block. Now you can use <code>tag</code> instead of <code>tagList[i]</code>.Many people are against using it , but it is still an option. It also prevents out of bound errors.</p></li>\n<li>You don't need to check <code>tagListLength&gt;0</code> in every <code>else if</code> block. First one is enough for your logic. <em>This is just a suggestion.</em></li>\n</ul>\n\n<p>So in the end, either use <code>foreach</code> version of golang, or fix your condition to <code>i&lt;taglistLength</code>, and make sure that you are initalizing <code>taglistLength</code> at the correct line.</p>\n"}], "owner": {"reputation": 93, "user_id": 10209822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91868bc4cac62cb5aba3a0b67520bc08?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/10209822/priyanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "closed_date": 1543937786, "accepted_answer_id": 53615027, "answer_count": 1, "score": -1, "last_activity_date": 1543935948, "creation_date": 1543931173, "last_edit_date": 1543935948, "question_id": 53614348, "link": "https://stackoverflow.com/questions/53614348/index-out-of-range-in-for-loop-duplicate", "closed_reason": "Not suitable for this site", "title": "index out of range in for loop (duplicate)", "body": "<p>I am trying to compare a string value with the value in a slice, in my case slice is <strong>tagsList</strong>. I have to do some functionality on this comparison. Please find my below code.</p>\n\n<pre><code>        var taglistlength = len(tagsList)\n        var tagFlag bool\n        var i int\n        var reEmplKey string\n        type saveDetails struct {\n            BankID           string  `json:\"bankID\"`    \n            LocalGradeDescr  string  `json:\"localGradeDescr\"`   \n            RegularTemporary string  `json:\"regularTemporary\"`\n        }\n        var tagsList = make([]saveDetails, 0) \n\n        reEmplKey = \"ID00001\"\n        tagsList = [{ID00001 Band 9 B PERMANENT}{ID00002 Band 8 C PERMANENT}{ID00003 Band 7 C Temporary}] \n\n        fmt.Println(\"taglistlength : \",taglistlength)\n        for i = 0; i &lt;= taglistlength; i++{ \n            fmt.Println(\"tagsList : \",tagsList)\n            if (taglistlength == 0){\n                tagFlag = true\n                fmt.Println(\"1st condition : \",tagFlag)\n            } else if (taglistlength &gt; 0 &amp;&amp; tagsList[i].BankID ==reEmplKey){\n                tagFlag = false\n                fmt.Println(\"2nd condition : \",tagFlag)\n            } else if (taglistlength &gt; 0 &amp;&amp; tagsList[i].BankID !=reEmplKey){\n                tagFlag = false\n                fmt.Println(\"3rd condition : \",tagFlag)\n            }else{\n                fmt.Println(\"error\")\n            }\n        }\n\n        if (tagFlag == true){\n         //do some operation\n        }\n</code></pre>\n\n<p>on executing this code i am getting the below error: </p>\n\n<pre><code>    panic: runtime error: index out of range\n    panic: runtime error: invalid memory address or nil pointer dereference\n    [signal SIGSEGV: segmentation violation code=0x1 addr=0x30 pc=0x8ca606]\n</code></pre>\n\n<p>It is executing properly for the 1st loop and showing error in the 2nd time loop.\nPlease find my output below:</p>\n\n<pre><code>      taglistlength :  0\n      tagsList : []\n      1st condition :  true\n\n      taglistlength :  1\n      tagsList :  [{1000000 Band 9 B PERMANENT }]\n      3rd condition :  false\n      tagsList :  [{1000000 Band 9 B PERMANENT }]\n      panic: runtime error: index out of range\n      panic: runtime error: invalid memory address or nil pointer dereference\n</code></pre>\n\n<p>Please help me in solving this issue. I know i am doing some silly logical mistake but i couldn't figure out the issue. It will be very much helpful if i could get the working code.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 4, "creation_date": 1543928428, "post_id": 53613556, "comment_id": 94087787, "body": "Go has benchmarking built-in, use it."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1543928671, "post_id": 53613556, "comment_id": 94087933, "body": "Yes, I can explain this: Your benchmark is flawed, it does not measure what sync.Pool is good for. Stop this kind of microoptimisations until a) your app hits a provable bottleneck here and b) you understand the bottleneck."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 4, "creation_date": 1543936147, "post_id": 53613556, "comment_id": 94092399, "body": "sync.Pool is not supposed to be faster than make. It&#39;s supposed to alleviate pressure on the garbage collector by reducing the amount of memory allocations. You are comparing apples and frozen pizza."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 10744177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fed159ba22dc1581fbe9aa2f87e63323?s=128&d=identicon&r=PG&f=1", "display_name": "dong", "link": "https://stackoverflow.com/users/10744177/dong"}, "edited": false, "score": 1, "creation_date": 1544064709, "post_id": 53614283, "comment_id": 94146839, "body": "Get. This case just solved my puzzle, thank you! Go benchmark is so good tool."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 10, "last_activity_date": 1543956871, "last_edit_date": 1543956871, "creation_date": 1543930959, "answer_id": 53614283, "question_id": 53613556, "link": "https://stackoverflow.com/questions/53613556/is-go-sync-pool-much-slower-than-make/53614283#53614283", "title": "Is Go sync.pool much slower than make?", "body": "<p>First Law of Benchmarks: Meaningless microbenchmarks produce meaningless results.</p>\n\n<p>Your unrealistic microbenchmarks are not meaningful.</p>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/pkg/sync/\" rel=\"nofollow noreferrer\">Package sync</a></p>\n\n<pre><code>import \"sync\"\n</code></pre>\n  \n  <p><a href=\"https://golang.org/pkg/sync/#Pool\" rel=\"nofollow noreferrer\">type Pool</a></p>\n  \n  <p>A Pool is a set of temporary objects that may be individually saved\n  and retrieved.</p>\n  \n  <p>Any item stored in the Pool may be removed automatically at any time\n  without notification. If the Pool holds the only reference when this\n  happens, the item might be deallocated.</p>\n  \n  <p>A Pool is safe for use by multiple goroutines simultaneously.</p>\n  \n  <p>Pool's purpose is to cache allocated but unused items for later reuse,\n  relieving pressure on the garbage collector. That is, it makes it easy\n  to build efficient, thread-safe free lists. However, it is not\n  suitable for all free lists.</p>\n  \n  <p>An appropriate use of a Pool is to manage a group of temporary items\n  silently shared among and potentially reused by concurrent independent\n  clients of a package. Pool provides a way to amortize allocation\n  overhead across many clients.</p>\n  \n  <p>An example of good use of a Pool is in the fmt package, which\n  maintains a dynamically-sized store of temporary output buffers. The\n  store scales under load (when many goroutines are actively printing)\n  and shrinks when quiescent.</p>\n  \n  <p>On the other hand, a free list maintained as part of a short-lived\n  object is not a suitable use for a Pool, since the overhead does not\n  amortize well in that scenario. It is more efficient to have such\n  objects implement their own free list.</p>\n</blockquote>\n\n<p>Is <code>sync.Pool</code> appropriate for your use case? Is <code>sync.Pool</code> appropriate for your benchmark? Are your use case and your benchmark the same? Is your use case a microbenchmark?</p>\n\n<hr>\n\n<p>Using the Go <code>testing</code> package for your artificial benchmarks, with separate benchmarks for <code>make</code> stack and heap allocations, <code>make</code> is both faster and slower than <code>sync.Pool</code>.</p>\n\n<p>Output:</p>\n\n<pre><code>$ go test pool_test.go -bench=. -benchmem\nBenchmarkMakeStack-4    2000000000      0.29 ns/op       0 B/op    0 allocs/op\nBenchmarkMakeHeap-4       10000000    136 ns/op       1024 B/op    1 allocs/op\nBenchmarkBytePool-4      100000000     17.2 ns/op        0 B/op    0 allocs/op\n$\n</code></pre>\n\n<p><code>pool_test.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"sync\"\n    \"testing\"\n)\n\nfunc BenchmarkMakeStack(b *testing.B) {\n    for N := 0; N &lt; b.N; N++ {\n        obj := make([]byte, 1024)\n        _ = obj\n    }\n}\n\nvar obj []byte\n\nfunc BenchmarkMakeHeap(b *testing.B) {\n    for N := 0; N &lt; b.N; N++ {\n        obj = make([]byte, 1024)\n        _ = obj\n    }\n}\n\nvar bytePool = sync.Pool{\n    New: func() interface{} {\n        b := make([]byte, 1024)\n        return &amp;b\n    },\n}\n\nfunc BenchmarkBytePool(b *testing.B) {\n    for N := 0; N &lt; b.N; N++ {\n        obj := bytePool.Get().(*[]byte)\n        _ = obj\n        bytePool.Put(obj)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10744177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fed159ba22dc1581fbe9aa2f87e63323?s=128&d=identicon&r=PG&f=1", "display_name": "dong", "link": "https://stackoverflow.com/users/10744177/dong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1219, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1544432989, "creation_date": 1543928333, "last_edit_date": 1544432989, "question_id": 53613556, "link": "https://stackoverflow.com/questions/53613556/is-go-sync-pool-much-slower-than-make", "title": "Is Go sync.pool much slower than make?", "body": "<p>I tried to use <code>sync.Pool</code> to reuse <code>[]byte</code>. But it turned out to be slower than just make. Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"sync\"\n    \"testing\"\n)\n\nfunc BenchmarkMakeStack(b *testing.B) {\n    for N := 0; N &lt; b.N; N++ {\n        obj := make([]byte, 1024)\n        _ = obj\n    }\n}\n\nvar bytePool = sync.Pool{\n    New: func() interface{} {\n        b := make([]byte, 1024)\n        return &amp;b\n    },\n}\n\nfunc BenchmarkBytePool(b *testing.B) {\n    for N := 0; N &lt; b.N; N++ {\n        obj := bytePool.Get().(*[]byte)\n        _ = obj\n        bytePool.Put(obj)\n    }\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>$ go test pool_test.go -bench=. -benchmem\nBenchmarkMakeStack-4    2000000000      0.29 ns/op       0 B/op    0 allocs/op\nBenchmarkBytePool-4      100000000     17.2 ns/op        0 B/op    0 allocs/op\n</code></pre>\n\n<p>According to the Go docs, <code>sync.Pool</code> should be faster, but my test showed otherwise. Can anybody help me explain this?</p>\n\n<p>Update:\n1. update code in question by using go benchmark.\n2. the answer laid in <strong>stack</strong> and <strong>heap</strong>, see peterSO's answer.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1543940010, "post_id": 53612734, "comment_id": 94094843, "body": "Use <code>map</code> instead of <code>slice</code>."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1543946459, "post_id": 53612734, "comment_id": 94098147, "body": "if you&#39;re in presence of multiple go-routines accessing the same slice we have to lock the moment (or lines) when you write on it (append), for your question we have to see more parts of your code"}, {"owner": {"reputation": 121, "user_id": 1432193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9104a5a7f9287866002276e15d50885?s=128&d=identicon&r=PG", "display_name": "user1432193", "link": "https://stackoverflow.com/users/1432193/user1432193"}, "reply_to_user": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1544539370, "post_id": 53612734, "comment_id": 94306311, "body": "@DmitryHarnitski can you please provide an example? I may give you best answer if it works well for me."}, {"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1544541601, "post_id": 53612734, "comment_id": 94307773, "body": "@user1432193 You can ignore my comment. I just learned that <code>Maps are not safe for concurrent use</code> :( Your problem as it is formulated cannot be solved without synchronization primitives. From other side, it is good point to check your design and see if you are moving into right direction. Do you really need to share list between several goroutines?"}, {"owner": {"reputation": 121, "user_id": 1432193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9104a5a7f9287866002276e15d50885?s=128&d=identicon&r=PG", "display_name": "user1432193", "link": "https://stackoverflow.com/users/1432193/user1432193"}, "reply_to_user": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1544692042, "post_id": 53612734, "comment_id": 94368770, "body": "@DmitryHarnitski Perhaps not. I asked to know if it was possible in general. Would be better if it were."}], "answers": [{"tags": [], "owner": {"reputation": 2842, "user_id": 648741, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/47813cc59b0edb414b88601f1defe02a?s=128&d=identicon&r=PG", "display_name": "jochen", "link": "https://stackoverflow.com/users/648741/jochen"}, "is_accepted": false, "score": 2, "last_activity_date": 1543927447, "creation_date": 1543927447, "answer_id": 53613306, "question_id": 53612734, "link": "https://stackoverflow.com/questions/53612734/golang-get-index-of-inserted-value-with-append/53613306#53613306", "title": "Golang get index of inserted value with append", "body": "<p>Yes, you need some synchronisation, <em>e.g.</em> using a Mutex.  This is already true for your <code>append</code> statement, since concurrent writes to a slice from different go-routines are not safe.  You can use the same protection for the <code>append</code> and for the <code>len</code>.  (Maybe you can redesign your code to use channels instead, and have only one go-routine access the actual slice?)</p>\n\n<p>The go race detector warns about problems like this.  If you put the following code into a file, say \"ex_test.go\":</p>\n\n<pre><code>package ex\n\nimport (\n    \"sync\"\n    \"testing\"\n)\n\ntype Item struct{}\n\nfunc TestAppend(t *testing.T) {\n    var list []Item\n\n    n := 2\n    wg := sync.WaitGroup{}\n    wg.Add(n)\n    for i := 0; i &lt; n; i++ {\n        go func() {\n            defer wg.Done()\n            list = append(list, Item{})\n        }()\n    }\n    wg.Wait()\n}\n</code></pre>\n\n<p>then a call to <code>go test -race</code> warns about a \"data race\":</p>\n\n<pre><code>WARNING: DATA RACE\nRead at 0x00c0000a4040 by goroutine 8:\n  _/Users/voss/Desktop.TestAppend.func1()\n      /Users/voss/Desktop/ex_test.go:19 +0x66\n\nPrevious write at 0x00c0000a4040 by goroutine 7:\n  _/Users/voss/Desktop.TestAppend.func1()\n      /Users/voss/Desktop/ex_test.go:19 +0xa7\n\nGoroutine 8 (running) created at:\n  _/Users/voss/Desktop.TestAppend()\n      /Users/voss/Desktop/ex_test.go:17 +0xfe\n  testing.tRunner()\n      /usr/local/go/src/testing/testing.go:827 +0x162\n\nGoroutine 7 (finished) created at:\n  _/Users/voss/Desktop.TestAppend()\n      /Users/voss/Desktop/ex_test.go:17 +0xfe\n  testing.tRunner()\n      /usr/local/go/src/testing/testing.go:827 +0x162\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 1432193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9104a5a7f9287866002276e15d50885?s=128&d=identicon&r=PG", "display_name": "user1432193", "link": "https://stackoverflow.com/users/1432193/user1432193"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543933010, "creation_date": 1543925600, "question_id": 53612734, "link": "https://stackoverflow.com/questions/53612734/golang-get-index-of-inserted-value-with-append", "title": "Golang get index of inserted value with append", "body": "<p>I have the following code:</p>\n\n<pre><code>list = append(list, Item{})\n</code></pre>\n\n<p>Now I wish to know what index the appended value takes in list. Using len() as following - I am not sure is reliable in case of async code:</p>\n\n<pre><code>appendedIndex := len(list) - 1\n</code></pre>\n\n<p>Because by the time the len() function executes, there might have been another value appended to the list.</p>\n\n<p>Must I use Mutex or is there another way?</p>\n"}, {"tags": ["go", "struct", "reflection", "types"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543924915, "post_id": 53611708, "comment_id": 94085838, "body": "Do you consider a complex128 as simple or a composition of its real and imaginary part?"}], "answers": [{"comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 4, "creation_date": 1543923045, "post_id": 53611820, "comment_id": 94084780, "body": "maybe you&#39;d want:  <code>for t.Kind() == reflect.Ptr {         t = t.Elem()     }</code> in case it&#39;s the rare case of pointer to a pointer"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1543922394, "creation_date": 1543922394, "answer_id": 53611820, "question_id": 53611708, "link": "https://stackoverflow.com/questions/53611708/how-to-determine-whether-object-is-composite-type-or-not/53611820#53611820", "title": "How to determine whether object is composite (type) or not", "body": "<p>You may use package <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\"><code>reflect</code></a>, obtain its type, and check its <a href=\"https://golang.org/pkg/reflect/#Kind\" rel=\"nofollow noreferrer\">kind</a>. If it's a pointer type, \"navigate\" to the pointed type:</p>\n\n<pre><code>func isStruct(i interface{}) bool {\n    t := reflect.TypeOf(i)\n    if t.Kind() == reflect.Ptr {\n        t = t.Elem()\n    }\n    return t.Kind() == reflect.Struct\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>fmt.Println(isStruct(\"text\"))\nfmt.Println(isStruct(1))\nfmt.Println(isStruct(image.Point{}))\nfmt.Println(isStruct(&amp;image.Point{}))\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/UqrMF7fTr15\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>false\nfalse\ntrue\ntrue\n</code></pre>\n"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 53611820, "answer_count": 1, "score": 4, "last_activity_date": 1543922786, "creation_date": 1543922059, "last_edit_date": 1543922786, "question_id": 53611708, "link": "https://stackoverflow.com/questions/53611708/how-to-determine-whether-object-is-composite-type-or-not", "title": "How to determine whether object is composite (type) or not", "body": "<p>For example,  <code>x interface{}</code> is given. How it can be determined (maybe using reflection) if it is a composite type (struct or pointer to struct) or \"simple\" type like <code>string</code>, <code>int</code>, <code>float</code>, etc?</p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 1562, "user_id": 4303758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nbL0i.jpg?s=128&g=1", "display_name": "Manjeet Thakur", "link": "https://stackoverflow.com/users/4303758/manjeet-thakur"}, "edited": false, "score": 0, "creation_date": 1543922336, "post_id": 53611325, "comment_id": 94084379, "body": "this question is belongs to mysql tag here you can read about it <a href=\"https://blog.sqlauthority.com/2007/04/26/sql-server-difference-between-unique-index-vs-unique-constraint/\" rel=\"nofollow noreferrer\">blog.sqlauthority.com/2007/04/26/&hellip;</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 1562, "user_id": 4303758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nbL0i.jpg?s=128&g=1", "display_name": "Manjeet Thakur", "link": "https://stackoverflow.com/users/4303758/manjeet-thakur"}, "edited": false, "score": 0, "creation_date": 1543924561, "post_id": 53611325, "comment_id": 94085626, "body": "@ManjeetThakur: I find it funny that you mention this needs a MySQL tag, then recommend an article about Microsoft SQL Server :)"}, {"owner": {"reputation": 1562, "user_id": 4303758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nbL0i.jpg?s=128&g=1", "display_name": "Manjeet Thakur", "link": "https://stackoverflow.com/users/4303758/manjeet-thakur"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543924850, "post_id": 53611325, "comment_id": 94085796, "body": "@Flimzy well you are right, the reason behind the concept is same"}], "answers": [{"tags": [], "owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "is_accepted": false, "score": 6, "last_activity_date": 1543922453, "creation_date": 1543922453, "answer_id": 53611845, "question_id": 53611325, "link": "https://stackoverflow.com/questions/53611325/what-is-the-difference-between-unique-index-and-unique/53611845#53611845", "title": "What is the difference between unique_index and unique?", "body": "<p><code>unique</code> is a database constraint that (in this case) prevents the multiple record have the same value for <code>MemberNumber</code>. If such an insert or update is made, the operation will not succeed and return an error.</p>\n\n<p><code>unique_index</code> will create a database index that also ensures that no two values can be the same. It will do the same, but create an index.</p>\n\n<p>In your case: MySQL will use a unique index behind the scenes when using a unique constraint. So when using MySQL, there is no difference when using <code>unique</code> and using <code>unique index</code>.</p>\n\n<p>If you use other database management systems there might be differences.</p>\n\n<p>The differences (if any) will be handled by the database management system internally. For practical purposes you can regard them as the same. The differences will be documented for each database management system.</p>\n"}], "owner": {"reputation": 3078, "user_id": 5305592, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/7e9b659dde6e528e0316572055db507f?s=128&d=identicon&r=PG&f=1", "display_name": "zwl1619", "link": "https://stackoverflow.com/users/5305592/zwl1619"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1787, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1543923485, "creation_date": 1543920834, "last_edit_date": 1592644375, "question_id": 53611325, "link": "https://stackoverflow.com/questions/53611325/what-is-the-difference-between-unique-index-and-unique", "title": "What is the difference between unique_index and unique?", "body": "<p>What is the difference  between unique_index and unique in GORM?<br />\nI am using MySQL 8.0, I cannot find the description about the difference between unique_index &amp; unique form manual.<br />\nFrom <a href=\"http://gorm.io/docs/models.html\" rel=\"nofollow noreferrer\">here</a>, see specifically the <code>Email</code> and <code>MemberNumber</code> fields:</p>\n<blockquote>\n<h1>Declaring Models</h1>\n<p>Models are usually just normal Golang structs, basic Go types, or pointers of them. sql.Scanner and driver.Valuer interfaces are also supported.</p>\n<p>Model Example:</p>\n<pre><code>type User struct {\n    gorm.Model\n    Name         string\n    Age          sql.NullInt64\n    Birthday     *time.Time\n    Email        string  `gorm:&quot;type:varchar(100);unique_index&quot;`\n    Role         string  `gorm:&quot;size:255&quot;` // set field size to 255\n    MemberNumber *string `gorm:&quot;unique;not null&quot;` // set member number to unique and not null\n    Num          int     `gorm:&quot;AUTO_INCREMENT&quot;` // set num to auto incrementable\n    Address      string  `gorm:&quot;index:addr&quot;` // create index with name `addr` for address\n    IgnoreMe     int     `gorm:&quot;-&quot;` // ignore this field\n}\n</code></pre>\n</blockquote>\n"}, {"tags": ["html", "file", "go"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10656008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca9c80c2375363b558aee27ea950871?s=128&d=identicon&r=PG&f=1", "display_name": "stack", "link": "https://stackoverflow.com/users/10656008/stack"}, "edited": false, "score": 0, "creation_date": 1543923030, "post_id": 53611876, "comment_id": 94084775, "body": "yes I do it Thanks for it. I&#39;m applying your code outside the click event"}], "tags": [], "owner": {"reputation": 793711, "user_id": 19068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2d3229ed1961d2bd81853242493247?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/19068/quentin"}, "is_accepted": true, "score": 1, "last_activity_date": 1543922571, "creation_date": 1543922571, "answer_id": 53611876, "question_id": 53611298, "link": "https://stackoverflow.com/questions/53611298/how-to-send-the-file-from-html-selector-to-the-golang-apis/53611876#53611876", "title": "How to send the file from html selector to the golang apis?", "body": "<p>You are passing <code>data</code> a plain object and telling jQuery not to process it.</p>\n\n<p>This means it just gets converted to the string <code>[object Object]</code> and jQuery sets the content-type to <code>text/plain;charset=UTF-8</code>.</p>\n\n<p>So it isn't multipart/form-data and it doesn't claim to be.</p>\n\n<hr>\n\n<p>Pass a <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/FormData\" rel=\"nofollow noreferrer\">FormData</a> object instead, and pass it a <em>file</em>, not just file name.</p>\n\n<pre><code>const data = new FormData();\ndata.append(\"file\", $(\"#imageSelector\")[0].files[0], inputFile);\n// ...\ncontentType: false,\nprocessData: false,\ndata: data,\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10656008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca9c80c2375363b558aee27ea950871?s=128&d=identicon&r=PG&f=1", "display_name": "stack", "link": "https://stackoverflow.com/users/10656008/stack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 53611876, "answer_count": 1, "score": 1, "last_activity_date": 1543922571, "creation_date": 1543920754, "last_edit_date": 1543922144, "question_id": 53611298, "link": "https://stackoverflow.com/questions/53611298/how-to-send-the-file-from-html-selector-to-the-golang-apis", "title": "How to send the file from html selector to the golang apis?", "body": "<p>I have an html file selector in my html code. I'm selecting an image from that selector and send it to the golang code via jquery. But the image file will not receiving by the golang code. I'm showing my html and golang code.</p>\n\n<p>html:-</p>\n\n<pre><code>&lt;input type=\"file\" name=\"myFile\" id=\"imageSelector\"&gt;&lt;br&gt;&lt;br&gt;\n&lt;button id=\"uploadImage\"&gt;Upload Image&lt;/button&gt;\n</code></pre>\n\n<p>jquery:-</p>\n\n<pre><code>$( document ).ready(function() {\n    var inputFile = $('#imageSelector').val().split('\\\\').pop(); // give you file name\n    $(\"#uploadImage\").on(\"click\", function(e){\n        $.ajax({\n            url: \"/api/v1/upload\",\n            type: \"POST\",\n            contentType: false,\n            processData: false,\n            data:{\"file\":inputFile},\n            success: function(response){\n                console.log(response);\n            }\n        });\n    });\n});\n</code></pre>\n\n<p>In golang code i'm receiving it by using gin package</p>\n\n<pre><code>func GetSelectedImage(c *gin.Context){\n  file, err := c.FormFile(\"file\")\n  fmt.Pritnln(file) //it will show nothing\n  fmt.Println(err) // request Content-Type isn't multipart/form-data\n} \n</code></pre>\n\n<p>Error:- </p>\n\n<blockquote>\n  <p>request Content-Type isn't multipart/form-data</p>\n</blockquote>\n\n<p>Where is the error I'm doing. I can't change my golang code but html code is editable. Can anybody tell me what thing I'm doing wrong.</p>\n"}, {"tags": ["ruby", "go", "ffi", "cgo"], "comments": [{"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 1, "creation_date": 1543921138, "post_id": 53608352, "comment_id": 94083734, "body": "<code>cstr</code> is already free&#39;d after <code>login()</code>. Try removing <code>defer C.free()</code> and manage the memory in Ruby."}], "answers": [{"tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": true, "score": 3, "last_activity_date": 1543938928, "creation_date": 1543938928, "answer_id": 53616785, "question_id": 53608352, "link": "https://stackoverflow.com/questions/53608352/how-to-return-string-from-function-to-ruby-with-cgo/53616785#53616785", "title": "How to return string from function to Ruby with CGO", "body": "<p>As stated in the comments, <code>cstr</code> gets free'd after control has been passed to Ruby. Here is a workaround where you explicitly manage the pointer in Ruby.</p>\n\n<pre><code>package main\n\n// #include &lt;stdlib.h&gt;\nimport \"C\"\nimport \"unsafe\"\n\n//export login\nfunc login(user *C.char) *C.char {\n    return C.CString(\"Hello from Go\")\n}\n\n//export logout\nfunc logout(c *C.char) {\n    C.free(unsafe.Pointer(c))\n}\n\nfunc main() {}\n</code></pre>\n\n<p>In Ruby:</p>\n\n<pre><code>require 'ffi'\n\nmodule GoLib\n  extend FFI::Library\n  ffi_lib './so.so'\n\n  attach_function :login, [:string], :strptr\n  attach_function :logout, [:pointer], :void\nend\n\ns, p = GoLib.login(\"User1\")\nputs s\np = FFI::AutoPointer.new(p, GoLib.method(:logout))\n</code></pre>\n\n<p>Note the use of <code>strptr</code> as demonstrated <a href=\"https://github.com/ffi/ffi/wiki/Pointers#fresh-strings\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 512, "user_id": 2875733, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/632666023/picture?type=large", "display_name": "Gavin Yap", "link": "https://stackoverflow.com/users/2875733/gavin-yap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 53616785, "answer_count": 1, "score": 0, "last_activity_date": 1543938928, "creation_date": 1543911042, "last_edit_date": 1543911529, "question_id": 53608352, "link": "https://stackoverflow.com/questions/53608352/how-to-return-string-from-function-to-ruby-with-cgo", "title": "How to return string from function to Ruby with CGO", "body": "<p>I have a function in Go:   </p>\n\n<pre><code>func login(user *C.char) *C.char {\n    cstr := C.CString(\"Hello World\")\n    defer C.free(unsafe.Pointer(cstr))\n    return cstr \n}\n</code></pre>\n\n<p>My ruby code as below</p>\n\n<pre><code>module GoLib\n  extend FFI::Library\n  ffi_lib './golib.so'\n\n  attach_function :login, [:string], :string\nend\n\nGoLib.login(\"User1\") #=&gt; \"p\\x9A\\xA0\\xDB\\x16V\"\n</code></pre>\n\n<p>it does not return as ruby string. How to I fix this? </p>\n"}, {"tags": ["go", "package", "dependency-management", "aws-sdk-go", "godeps"], "answers": [{"tags": [], "owner": {"reputation": 10410, "user_id": 2450507, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qNPPb.jpg?s=128&g=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/2450507/nicholas"}, "is_accepted": true, "score": 5, "last_activity_date": 1543915606, "last_edit_date": 1543915606, "creation_date": 1543903682, "answer_id": 53606668, "question_id": 53606667, "link": "https://stackoverflow.com/questions/53606667/how-to-get-dep-ensure-to-remove-unused-go-files-dependencies-or-packages/53606668#53606668", "title": "How to get dep ensure to remove unused Go files, dependencies or packages", "body": "<p>To resolve this you need to define <code>[prune]</code> settings which determine what files and directories can be deemed unnecessary, and thus automatically removed from vendor/.</p>\n\n<p>The following options are currently available:</p>\n\n<ul>\n<li><code>unused-packages</code> indicates that files from directories that do not appear in the package import graph should be pruned</li>\n<li><code>non-go</code> prunes files that are not used by Go</li>\n<li><code>go-tests</code> prunes Go test files</li>\n</ul>\n\n<p>Out of an abundance of caution, dep non-optionally preserves files that may have legal significance.</p>\n\n<p>Pruning options are disabled by default. However, generating a <code>Gopkg.toml</code> via <code>dep init</code> will add lines to enable <code>go-tests</code> and <code>unused-packages</code> prune options at the root level.</p>\n\n<pre><code>[prune]\n  go-tests = true\n  unused-packages = true\n</code></pre>\n\n<p>The same prune options can be defined per-project. An additional name field is required and, as with <code>[[constraint]]</code> and <code>[[override]]</code>, should be a <a href=\"https://golang.github.io/dep/docs/glossary.html#source-root\" rel=\"nofollow noreferrer\">source root</a>, not just any import path.</p>\n\n<pre><code>[prune]\n  non-go = true\n\n  [[prune.project]]\n    name = \"github.com/project/name\"\n    go-tests = true\n    non-go = false\n</code></pre>\n\n<p>Almost all projects will be fine without setting any project-specific rules, and enabling the following pruning rules globally:</p>\n\n<pre><code>[prune]\n  unused-packages = true\n  go-tests = true\n</code></pre>\n\n<p>It is usually safe to set <code>non-go = true</code>, as well. However, as <code>dep</code> only has a clear model for the role played by Go files, and non-Go files necessarily fall outside that model, there can be no comparable general definition of safety.</p>\n"}], "owner": {"reputation": 10410, "user_id": 2450507, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qNPPb.jpg?s=128&g=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/2450507/nicholas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2193, "favorite_count": 1, "accepted_answer_id": 53606668, "answer_count": 1, "score": 1, "last_activity_date": 1556447916, "creation_date": 1543903682, "last_edit_date": 1556447916, "question_id": 53606667, "link": "https://stackoverflow.com/questions/53606667/how-to-get-dep-ensure-to-remove-unused-go-files-dependencies-or-packages", "title": "How to get dep ensure to remove unused Go files, dependencies or packages", "body": "<p>When adding new dependencies using <code>dep ensure -add &lt;package&gt;</code> I see <code>dep</code> adding the complete repository of the package, instead of just the parts I require.</p>\n\n<p>For example I added <a href=\"https://github.com/aws/aws-sdk-go\" rel=\"nofollow noreferrer\">aws-sdk-go</a> and <code>dep ensure</code> put 87MB of files into my vendors folder, even though I only use the AWS Secrets Manager service.</p>\n"}, {"tags": ["go", "path", "directory"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1543898569, "post_id": 53605774, "comment_id": 94073665, "body": "Are you trying to create a directory with the specific path &quot;/home/iron/go/&quot; or are you trying to create a temporary directory with an arbitrary path? If the former, call os.MkdirAll as in the question. If the latter, call <a href=\"https://golang.org/pkg/io/ioutil/#TempDir\" rel=\"nofollow noreferrer\">ioutil.TempDir</a>."}, {"owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1543898722, "post_id": 53605774, "comment_id": 94073701, "body": "yeah I used it but it will create the folder <code>361911691</code> using this number but I don&#39;t need this numbers. Is there any way to solve this? @thunderCat trying to create the directory using specific path"}, {"owner": {"reputation": 2478, "user_id": 1586231, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/sRho9.jpg?s=128&g=1", "display_name": "Max von Hippel", "link": "https://stackoverflow.com/users/1586231/max-von-hippel"}, "edited": false, "score": 0, "creation_date": 1543898796, "post_id": 53605774, "comment_id": 94073722, "body": "What exactly is the problem?  Are you getting an error?  If so, what is it?"}, {"owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "edited": false, "score": 0, "creation_date": 1543898961, "post_id": 53605774, "comment_id": 94073768, "body": "the problem is that when the temporary folder is created then it will join this number with the given name. Is there any way that these will remove from the folder name?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1543899491, "post_id": 53605774, "comment_id": 94073883, "body": "The code in the question does not do what you are describing. Please post your actual code.  The goal of ioutil.TempDir is to create a new directory. The function appends text to the prefix to ensure that the directory is unique.  If you want to create a directory with a known name in <a href=\"https://golang.org/pkg/os/#TempDir\" rel=\"nofollow noreferrer\">os.TempDir</a>, then <code>os.Mkdirall(filelpath.Join(os.TempDir(), &quot;yourpath&quot;))</code>."}], "answers": [{"tags": [], "owner": {"reputation": 13411, "user_id": 2882051, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ckx9R.jpg?s=128&g=1", "display_name": "chengpohi", "link": "https://stackoverflow.com/users/2882051/chengpohi"}, "is_accepted": false, "score": 1, "last_activity_date": 1543901405, "creation_date": 1543901405, "answer_id": 53606233, "question_id": 53605774, "link": "https://stackoverflow.com/questions/53605774/how-to-create-the-temporary-directory-in-the-localhost-system-using-golang/53606233#53606233", "title": "How to create the temporary directory in the localhost system using golang", "body": "<p>You can just get the <strong>os temp</strong> directory and manually create a folder under this directory without <strong>random</strong> suffix(random is for solving conflict):</p>\n\n<pre><code>goPath := filepath.Join(os.TempDir(), \"/home/iron/go/\")\n&gt; /var/folders/m2/4clpt6wj62j6dt9kwpr4b5fh0000gn/T/home/iron/go\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1543901405, "creation_date": 1543898234, "question_id": 53605774, "link": "https://stackoverflow.com/questions/53605774/how-to-create-the-temporary-directory-in-the-localhost-system-using-golang", "title": "How to create the temporary directory in the localhost system using golang", "body": "<p>Here I'm trying to create a temporary directory in my local system using the below mentioned code </p>\n\n<p>Code</p>\n\n<pre><code>path := \"/home/iron/go/\"\nfmt.Println(os.Stat(path))\n// this statement prints the data showing numbers\nif _, err := os.Stat(path); os.IsNotExist(err) {\n    os.MkdirAll(path, 0755)\n}\n</code></pre>\n\n<p>I also searched for it but I want to do this from above code or add some lines to code.</p>\n\n<p>Links for making temporary directory:- <a href=\"https://gist.github.com/miguelmota/d065806656c81021527069f3877fa762\" rel=\"nofollow noreferrer\">link 1</a>, <a href=\"https://ispycode.com/GO/Files-And-Directories/Create-A-Temporary-Directory\" rel=\"nofollow noreferrer\">link 2</a></p>\n"}, {"tags": ["mysql", "go", "transactions"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1543896087, "post_id": 53605472, "comment_id": 94073154, "body": "<code>autocommit</code> is only taken into account if you have not started the transaction explicitly. As soon as you used <code>BEGIN</code> - then the only way it to be committed is after an explicit <code>COMMIT</code>. As soon as your transaction is in the progress and the connection has been closed - it would be rolled back automatically by the server."}, {"owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1543896187, "post_id": 53605472, "comment_id": 94073176, "body": "Ok, so once the COMMIT runs, the transaction runs including the 5.5s sleep. If it gets terminated after 3s, how does it rollback? Should it rollback ?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1543896237, "post_id": 53605472, "comment_id": 94073189, "body": "If <code>COMMIT</code> returned with no errors - it&#39;s committed."}, {"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "edited": false, "score": 3, "creation_date": 1543896246, "post_id": 53605472, "comment_id": 94073194, "body": "It will roll back, but not from go - the mysql server will see the connection was lost / exceeded a timeout, and roll it back automatically"}, {"owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "edited": false, "score": 0, "creation_date": 1543896339, "post_id": 53605472, "comment_id": 94073209, "body": "Even after a very short space of time? &lt;1s ?"}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543906793, "post_id": 53606821, "comment_id": 94076184, "body": "Note that there&#39;s still a chance the transaction will have been completed, if the Go program exits between sending &#39;COMMIT&#39;, and receiving/processing the response. There is never any way to avoid this, so it&#39;s still best to make the transactions as idempotent (or recoverable) as possible."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543907643, "post_id": 53606821, "comment_id": 94076551, "body": "@Flimzy However, the transaction should be committed independently by the RDBMS upon receipt of &#39;COMMIT&#39;, regardless whether the client is still connected or not, shouldn\u2019t it? If it is: Just as planned! ;)"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1543911387, "post_id": 53606821, "comment_id": 94078120, "body": "@MarkusWMahlberg: Yes, but you cannot rely on your client getting that message. That won&#39;t matter in some cases, in others it will."}], "tags": [], "owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "is_accepted": false, "score": 1, "last_activity_date": 1543904487, "creation_date": 1543904487, "answer_id": 53606821, "question_id": 53605472, "link": "https://stackoverflow.com/questions/53605472/when-a-golang-program-is-terminated-whilst-making-a-database-transaction-can-it/53606821#53606821", "title": "When a Golang program is terminated whilst making a database transaction, can it roll back?", "body": "<p>The transaction SQL does not commit. What I believe happens with a &lt;= 5s timeout:</p>\n\n<ol>\n<li>BEGINs transaction</li>\n<li>Executes the SQL synchronously</li>\n<li>MySQLd detects the client disconnected via a <strong>TCP FIN</strong></li>\n<li>MySQLd automatically rolls back since it doesn't see the Commit</li>\n</ol>\n\n<h2>A tweet reply from one of the <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"nofollow noreferrer\">Golang MySQL driver</a> maintainers:</h2>\n\nmysqld receives TCP FIN packet when Go client is terminated.<br>Even though Go client exits uncleanly, OS (Linux kernel, etc) sends TCP FIN or TCP RST.  So mysqld can know client is gone.</p>&mdash; INADA Naoki (@methane) <a href=\"https://twitter.com/methane/status/1069825283857952768?ref_src=twsrc%5Etfw\" rel=\"nofollow noreferrer\">December 4, 2018</a>\n\n\n"}, {"comments": [{"owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "edited": false, "score": 0, "creation_date": 1543906233, "post_id": 53607084, "comment_id": 94075942, "body": "Aurora does not support MyISAM, though interesting nonetheless ! <a href=\"https://aws.amazon.com/rds/aurora/faqs/\" rel=\"nofollow noreferrer\">aws.amazon.com/rds/aurora/faqs</a>"}, {"owner": {"reputation": 458695, "user_id": 20860, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iavmP.jpg?s=128&g=1", "display_name": "Bill Karwin", "link": "https://stackoverflow.com/users/20860/bill-karwin"}, "reply_to_user": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "edited": false, "score": 0, "creation_date": 1543953671, "post_id": 53607084, "comment_id": 94101522, "body": "That&#39;s good that Aurora doesn&#39;t support MyISAM. But that makes it not really MySQL/MariaDB compatible."}], "tags": [], "owner": {"reputation": 458695, "user_id": 20860, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iavmP.jpg?s=128&g=1", "display_name": "Bill Karwin", "link": "https://stackoverflow.com/users/20860/bill-karwin"}, "is_accepted": false, "score": 0, "last_activity_date": 1543905807, "creation_date": 1543905807, "answer_id": 53607084, "question_id": 53605472, "link": "https://stackoverflow.com/questions/53605472/when-a-golang-program-is-terminated-whilst-making-a-database-transaction-can-it/53607084#53607084", "title": "When a Golang program is terminated whilst making a database transaction, can it roll back?", "body": "<p>If you use InnoDB tables, read this from <a href=\"https://dev.mysql.com/doc/internals/en/transactions-life-cycle.html\" rel=\"nofollow noreferrer\">https://dev.mysql.com/doc/internals/en/transactions-life-cycle.html</a>:</p>\n\n<blockquote>\n  <p>When a connection is closed, the current normal transaction, if any, is rolled back.</p>\n</blockquote>\n\n<p>This works the same with the Go client, Java client, PHP client, or any other client.</p>\n\n<p>If you use MyISAM tables, there's no rollback. If you have a SQL update currently executing, it may update some subset of the rows, and leave the rest unchanged. You'll end up with a table in an inconsistent state. There is no ACID behavior with non-transactional tables. <strong>This is why you should not use MyISAM.</strong></p>\n"}], "owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1543905807, "creation_date": 1543895882, "question_id": 53605472, "link": "https://stackoverflow.com/questions/53605472/when-a-golang-program-is-terminated-whilst-making-a-database-transaction-can-it", "title": "When a Golang program is terminated whilst making a database transaction, can it roll back?", "body": "<p>Assuming a MariaDB compatible database (AWS Aurora RDS) with default settings, which includes <strong>autocommit enabled</strong>, if a Lambda function was terminated after <strong>three seconds</strong> doing a transaction that takes more than <strong>five seconds</strong>, e.g.</p>\n\n<pre><code>  tx, err := h.db.Begin()\n  if err != nil {\n      log.WithError(err).Error(\"failed to start transaction\")\n  }\n  res, execErr := tx.Exec(fmt.Sprintf(\"UPDATE testtable SET val = %d WHERE id = 1; SELECT SLEEP(5.5);\", time.Now().Unix()))\n  if execErr != nil {\n      log.WithError(err).Error(\"rolling back\")\n      err = tx.Rollback()\n      if err != nil {\n          log.WithError(err).Error(\"failed to roll back\")\n      }\n  }\n  if err := tx.Commit(); err != nil {\n      log.WithError(err).Error(\"failed to commit\")\n  }\n</code></pre>\n\n<p>What would one assume the result to be? The transaction would have not been committed?</p>\n\n<p>I am using Go MySQL Driver v1.3.0-84-g6be42e0 btw. I also made a <a href=\"https://media.dev.unee-t.com/2018-12-04/f58ae28.mp4\" rel=\"nofollow noreferrer\">video showing my results</a>, but I am wondering if it is right since I don't understand how the <a href=\"https://github.com/go-sql-driver/mysql/blob/master/transaction.go#L28\" rel=\"nofollow noreferrer\">driver could have executed rollback</a>.</p>\n"}, {"tags": ["http", "go", "goroutine", "appendfile", "range-header"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1543923905, "post_id": 53605400, "comment_id": 94085255, "body": "You are not accounting for the case where the file size is a multiple of 10MB; you&#39;d be requesting one extra chunk. Also, if the file size is not a multiple of 10MB, the last chunk will be shorter, and you are not accounting for that either. You should also get rid of that <code>body</code> slice. Holding on to closed ReadClosers isn&#39;t useful."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 1, "creation_date": 1543947448, "post_id": 53605400, "comment_id": 94098594, "body": "you&#39;re ignoring a ton of errors, you could use a helper like this: <code>func panicIfErr(err error) { if err != nil { panic(err) } }</code> and then just <code>panicIfErr(err)</code> only for main functions"}], "answers": [{"tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": true, "score": 4, "last_activity_date": 1543923888, "last_edit_date": 1543923888, "creation_date": 1543920597, "answer_id": 53611260, "question_id": 53605400, "link": "https://stackoverflow.com/questions/53605400/recombining-large-chunked-zip-download-in-go/53611260#53611260", "title": "Recombining large chunked zip download in GO", "body": "<p>The problem is with your range requests</p>\n\n<p>the lines</p>\n\n<pre><code>   resp,_ := client.Do(req)\n   defer resp.Body.Close()\n</code></pre>\n\n<p>are reported by <code>go vet</code> as the err isn't checked.  If you check the response code in the last chunk it is 416 - which is an incorrect range used, alter to this</p>\n\n<pre><code>resp, err := client.Do(req)\nif err != nil {\n    panic(err)\n}\nif resp.StatusCode == 416 {\n    fmt.Println(\"incorrect range\")\n}\ndefer resp.Body.Close()\n</code></pre>\n\n<p>I also altered the loop variable to <code>for i := 0; i &lt; chunks-1; i++ {</code>\nand altered the section after the go routine</p>\n\n<pre><code>startByte = endByte + 1\nendByte += 1024 * 1024 * 10\nif startByte &gt;= length {\n    break\n}\nfor endByte &gt;= length {\n    endByte = endByte - 1\n}\n</code></pre>\n\n<p>and altered the j loop variable in a similar way</p>\n\n<p>These changes seemed to work for me but I don't have suitable test data to really check</p>\n"}], "owner": {"reputation": 73, "user_id": 1428174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cBcRG.jpg?s=128&g=1", "display_name": "savidude", "link": "https://stackoverflow.com/users/1428174/savidude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 53611260, "answer_count": 1, "score": 2, "last_activity_date": 1543923888, "creation_date": 1543895234, "last_edit_date": 1543903084, "question_id": 53605400, "link": "https://stackoverflow.com/questions/53605400/recombining-large-chunked-zip-download-in-go", "title": "Recombining large chunked zip download in GO", "body": "<p>I am downloading a large .zip file in parallel with Accept-Ranges and Goroutines. The application sends multiple requests to download 10MB chunks of a zip file from a URL using its Range header.</p>\n\n<p>The requests get split up into different ranges as separate Goroutines and the data obtained is written into temp files. The files are named 1, 2, 3....</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"io\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n    \"strconv\"\n    \"sync\"\n)\n\nvar wg sync.WaitGroup\n\nfunc main() {\n    url := \"https://path/to/large/zip/file/zipfile.zip\"\n    res, _ := http.Head(url)\n    maps := res.Header\n    length, _ := strconv.Atoi(maps[\"Content-Length\"][0]) // Get the content length from the header request\n    chunks := (length / (1024 * 1024 * 10)) + 1\n\n    // startByte and endByte determines the positions of the chunk that should be downloaded\n    var startByte = 0\n    var endByte = (1024 * 1024 * 10) - 1\n    //body := make([][]byte, chunks)\n    body := make([]io.ReadCloser, chunks)\n\n    for i := 0; i &lt; chunks; i++ {\n        wg.Add(1)\n\n        go func(min int, max int, i int) {\n            client := &amp;http.Client {}\n            req, _ := http.NewRequest(\"GET\", url, nil)\n            rangeHeader := \"bytes=\" + strconv.Itoa(min) +\"-\" + strconv.Itoa(max)\n            fmt.Println(rangeHeader)\n            req.Header.Add(\"Range\", rangeHeader)\n\n            resp,_ := client.Do(req)\n            defer resp.Body.Close()\n\n            reader, _ := ioutil.ReadAll(resp.Body)\n            body[i] = resp.Body\n            ioutil.WriteFile(strconv.Itoa(i), reader, 777) // Write to the file i as a byte array\n\n            wg.Done()\n        }(startByte, endByte, i)\n\n        startByte = endByte + 1\n        endByte += 1024 * 1024 * 10\n    }\n    wg.Wait()\n\n    filepath := \"zipfile.zip\"\n    // Create the file\n    _, err := os.Create(filepath)\n    if err != nil {\n        return\n    }\n    file, _ := os.OpenFile(filepath, os.O_APPEND|os.O_WRONLY, os.ModeAppend)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n\n    for j := 0; j &lt; chunks; j++ {\n        newFileChunk, err := os.Open(strconv.Itoa(j))\n        if err != nil {\n            log.Fatal(err)\n        }\n        defer newFileChunk.Close()\n\n        chunkInfo, err := newFileChunk.Stat()\n        if err != nil {\n            log.Fatal(err)\n        }\n        var chunkSize int64 = chunkInfo.Size()\n        chunkBufferBytes := make([]byte, chunkSize)\n\n        // read into chunkBufferBytes\n        reader := bufio.NewReader(newFileChunk)\n        _, err = reader.Read(chunkBufferBytes)\n        file.Write(chunkBufferBytes)\n        file.Sync() //flush to disk\n        chunkBufferBytes = nil // reset or empty our buffer\n    }\n\n    //Verify file size\n    filestats, err := file.Stat()\n    if err != nil {\n        log.Fatal(err)\n        return\n    }\n    actualFilesize := filestats.Size()\n    if actualFilesize != int64(length) {\n        log.Fatal(\"Actual Size: \", actualFilesize, \" Expected: \", length)\n        return\n    }\n\n    file.Close()\n}\n</code></pre>\n\n<p>After all the files are downloaded, I try to recombine them into one .zip file. However, when the files are put together, I can't unzip the final file, as it appears to be corrupted.</p>\n\n<p>I would like to know what I am doing wrong, or if there's a better approach to this. Thanks in advance.</p>\n\n<p>EDIT: Below is what gets logged to the console</p>\n\n<pre><code>bytes=0-10485759\nbytes=10485760-20971519\n2018/12/04 11:21:28 Actual Size: 16877828 Expected: 16877827\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3049, "user_id": 774437, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/6fL8U.jpg?s=128&g=1", "display_name": "moorara", "link": "https://stackoverflow.com/users/774437/moorara"}, "edited": false, "score": 0, "creation_date": 1543895207, "post_id": 53604964, "comment_id": 94072951, "body": "You&#39;re right! Given a string, how can I programatically transform it into another string which follows the guidelines?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1543935431, "post_id": 53604964, "comment_id": 94091959, "body": "That first sentence is super important. Don&#39;t mistake &quot;best practice&quot; for &quot;valid&quot;."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 5, "last_activity_date": 1543897651, "last_edit_date": 1543897651, "creation_date": 1543891447, "answer_id": 53604964, "question_id": 53604915, "link": "https://stackoverflow.com/questions/53604915/how-to-build-valid-identifier-names-in-golang/53604964#53604964", "title": "How to build valid identifier names in golang?", "body": "<p>The names <code>GetId</code>, <code>getId</code> and <code>ServeURL</code> are all valid, they just don't follow style <a href=\"https://github.com/golang/go/wiki/CodeReviewComments\" rel=\"noreferrer\">guidelines</a>.  The name <code>getId</code> should be changed to <code>getID</code> to follow the guidelines.  See the <a href=\"https://github.com/golang/go/wiki/CodeReviewComments#initialisms\" rel=\"noreferrer\">initialisms</a> section of guidelines for more information about these names.</p>\n\n<p>The <a href=\"https://godoc.org/golang.org/x/lint\" rel=\"noreferrer\">lint package</a> does not provide an API to get the replacement text for an identifier. It is, however, possible to construct a source file with the identifier, feed it to the linter and parse the problem. Something like this:</p>\n\n<pre><code>import (\n    \"bytes\"\n    \"fmt\"\n    \"golang.org/x/lint\"\n    \"strings\"\n)\n\nfunc checkName(s string) (string, error) {\n    var buf bytes.Buffer\n    fmt.Fprintf(&amp;buf, \"// Package main is awesome\\npackage main\\n// %s is wonderful\\nvar %s int\\n\", s, s)\n    var l lint.Linter\n    problems, err := l.Lint(\"\", buf.Bytes())\n    if err != nil {\n        return \"\", err\n    }\n    if len(problems) &gt;= 1 {\n        t := problems[0].Text\n        if i := strings.Index(t, \" should be \"); i &gt;= 0 {\n            return t[i+len(\" should be \"):], nil\n        }\n    }\n    return \"\", nil\n}\n</code></pre>\n\n<p>The function call <code>checkName(\"getId\")</code> returns <code>\"getID\"</code>.</p>\n"}], "owner": {"reputation": 3049, "user_id": 774437, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/6fL8U.jpg?s=128&g=1", "display_name": "moorara", "link": "https://stackoverflow.com/users/774437/moorara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1543897651, "creation_date": 1543891064, "last_edit_date": 1543895223, "question_id": 53604915, "link": "https://stackoverflow.com/questions/53604915/how-to-build-valid-identifier-names-in-golang", "title": "How to build valid identifier names in golang?", "body": "<p>I am trying to use one the functionality provided by go linter in my code. If you use a name like <code>GetId</code> or <code>ServiceUrl</code> in go, the linter warns you that the name should be <code>GetID</code> or <code>ServiceURL</code>. How could I achieve the same thing in my code.\nFor example if in my I code I have a string <code>GetId</code>, how could I convert it to a golang compatible identifier (in this case <code>GetID</code>).</p>\n"}, {"tags": ["go", "module"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543908983, "post_id": 53604564, "comment_id": 94077125, "body": "A) As you found out the semver does <i>not</i> belong into the import path (only major versions like &quot;v2&quot; go there so please edit your question and remove the obvious wrong stuff. B) You did not show your go.mod. Always include all relevant information in the question. C) You said &quot;didn&#39;t let me set the version to v0.1&quot; which is correct if your project exists only in version v0.01 as you said earlier. D) WHat is the reason to play with <i>experimental</i> features of Go if you are super fresh to Go?"}, {"owner": {"reputation": 13, "user_id": 10741713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lgKLk.png?s=128&g=1", "display_name": "austink", "link": "https://stackoverflow.com/users/10741713/austink"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543944581, "post_id": 53604564, "comment_id": 94097237, "body": "@Volker A) Done. B) Added comment... as that one line was my go.mod C) Okay D) This doesn&#39;t help my problem.  I may be misinterpreting, but I was picking up a certain tone from your comment, one that sits on the side of not-so-nice. If I&#39;m wrong, then ignore. If I&#39;m right, can we stick to being courteous and helpful, or just not post anything at all?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543956738, "post_id": 53604564, "comment_id": 94102850, "body": "Okay. Now it seems as if there is no more error while building you project, or? So what is the question? All seems to be fine. For D) Modules are an experimental feature. It is dead unlikely that they will change much but nevertheless they are experimental and your IDE might not support them jet. So why play hard and use them? There is a reason why the official How to Write Go Code description does not mention modules."}, {"owner": {"reputation": 13, "user_id": 10741713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lgKLk.png?s=128&g=1", "display_name": "austink", "link": "https://stackoverflow.com/users/10741713/austink"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543960246, "post_id": 53604564, "comment_id": 94104374, "body": "@Volker You were 100% right... at least from what I found out a couple hours ago. After doing more research, the thought popped into my head (partly thanks to your previous comment) that since this is a new feature, maybe my IDE doesn&#39;t support, and if so I should check for the latest version to see if it does. My version of GoLand didn&#39;t support it, but the latest version does and the imports are just fine now.  Thanks for your help. Is there a way to close this out since I answered my own issue? Or is it proper to answer your own question on StackOverflow?"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 10741713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lgKLk.png?s=128&g=1", "display_name": "austink", "link": "https://stackoverflow.com/users/10741713/austink"}, "is_accepted": true, "score": 0, "last_activity_date": 1544049922, "creation_date": 1544049922, "answer_id": 53641918, "question_id": 53604564, "link": "https://stackoverflow.com/questions/53604564/go-modules-local-packages-not-accessible/53641918#53641918", "title": "Go Modules - Local package(s) not accessible?", "body": "<p>Simply and outdated IDE. Once updated to a version that supported Go 1.11, I no longer saw the red error text on import.</p>\n"}], "owner": {"reputation": 13, "user_id": 10741713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lgKLk.png?s=128&g=1", "display_name": "austink", "link": "https://stackoverflow.com/users/10741713/austink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "accepted_answer_id": 53641918, "answer_count": 1, "score": 0, "last_activity_date": 1544049922, "creation_date": 1543888239, "last_edit_date": 1543946634, "question_id": 53604564, "link": "https://stackoverflow.com/questions/53604564/go-modules-local-packages-not-accessible", "title": "Go Modules - Local package(s) not accessible?", "body": "<p>So, I'm new to Go. I've created a go.mod file</p>\n\n<p><code>module github.com/austin/test-project</code> &lt;--- This is all I've added to the go.mod</p>\n\n<p>I added a tag v0.0.1 to my commit latest git commit. </p>\n\n<p>Based on some examples I tried to understand, I added these imports to my go file(s), where <em>common</em> is one package, <em>dynamo</em> is another, and the import is from a third package called <em>main</em>.</p>\n\n<pre><code>import (\n\"github.com/austin/test-project/common\"\n\"github.com/austin/test-project/db/dynamo/playerstateddb\"\n\"github.com/austin/test-project/db/dynamo/characterstateddb\"\n\n\n\"context\"\n\"fmt\"\n\"encoding/json\"\n\n\"github.com/aws/aws-lambda-go/lambda\"\n\"github.com/aws/aws-lambda-go/events\"\n</code></pre>\n\n<p>And here is my output after running <code>go build ./handler/characterstate\n</code> where the <em>main</em> go file is:</p>\n\n<pre><code>go: finding github.com/aws/aws-lambda-go/events latest\ngo: finding github.com/aws/aws-lambda-go/lambda latest\ngo: finding github.com/aws/aws-sdk-go/service/dynamodb/dynamodbattribute latest\ngo: finding github.com/aws/aws-sdk-go/service/dynamodb latest\ngo: finding github.com/aws/aws-sdk-go/aws latest\ngo: finding github.com/aws/aws-sdk-go/aws/session latest\ngo: finding github.com/aws/aws-lambda-go v1.7.0\ngo: downloading github.com/aws/aws-lambda-go v1.7.0\ngo: finding github.com/aws/aws-sdk-go/service latest\ngo: finding github.com/aws/aws-sdk-go v1.15.89\ngo: downloading github.com/aws/aws-sdk-go v1.15.89\ngo: finding github.com/jmespath/go-jmespath v0.0.0-20160202185014-0b12d6b521d8\ngo: downloading github.com/jmespath/go-jmespath v0.0.0-20160202185014-0b12d6b521d8\n</code></pre>\n\n<p>The go.mod file is now this:</p>\n\n<pre><code>module github.com/carbonated-dev/madworld-backend\n\nrequire (\n    github.com/aws/aws-lambda-go v1.7.0\n    github.com/aws/aws-sdk-go v1.15.89\n)\n</code></pre>\n\n<p>... and I have a characterstate.exe at the root, and the expected go.sum</p>\n\n<p>In my IDE, GoLand, the import paths for my local <em>common</em> and <em>dynamo</em> packages are still highlighted red.</p>\n\n<p>I've been searching all day, and I've got no idea what's going on. Where am I going wrong? Could it be that the git repo is private that I'm trying to </p>\n\n<p>Thanks in advance. Hope to hear from someone soon :)</p>\n"}, {"tags": ["node.js", "postgresql", "go", "replication", "wal"], "answers": [{"comments": [{"owner": {"reputation": 130, "user_id": 5231353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Hi8H9QJz9c8/AAAAAAAAAAI/AAAAAAAAADg/4xOBsLCRlAE/photo.jpg?sz=128", "display_name": "Minh Nguyen", "link": "https://stackoverflow.com/users/5231353/minh-nguyen"}, "edited": false, "score": 0, "creation_date": 1543947344, "post_id": 53605796, "comment_id": 94098537, "body": "thanks Laurenz. I was looking for a way to connect to the stream of data using vanillajs or go."}, {"owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "reply_to_user": {"reputation": 130, "user_id": 5231353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Hi8H9QJz9c8/AAAAAAAAAAI/AAAAAAAAADg/4xOBsLCRlAE/photo.jpg?sz=128", "display_name": "Minh Nguyen", "link": "https://stackoverflow.com/users/5231353/minh-nguyen"}, "edited": false, "score": 0, "creation_date": 1543947530, "post_id": 53605796, "comment_id": 94098632, "body": "But unless you are using logical decoding, the stream will be of no value for you. It will contain information of the form <i>In file 12345, block 27, change bytes 42 to 99 to the following bytes: ...</i>."}, {"owner": {"reputation": 130, "user_id": 5231353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Hi8H9QJz9c8/AAAAAAAAAAI/AAAAAAAAADg/4xOBsLCRlAE/photo.jpg?sz=128", "display_name": "Minh Nguyen", "link": "https://stackoverflow.com/users/5231353/minh-nguyen"}, "edited": false, "score": 0, "creation_date": 1543951090, "post_id": 53605796, "comment_id": 94100298, "body": "Right because thats what the WAL log is. Once set up, is there a way to connect this to a nodejs stream? I have set up so that there are logical decoding."}, {"owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "reply_to_user": {"reputation": 130, "user_id": 5231353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Hi8H9QJz9c8/AAAAAAAAAAI/AAAAAAAAADg/4xOBsLCRlAE/photo.jpg?sz=128", "display_name": "Minh Nguyen", "link": "https://stackoverflow.com/users/5231353/minh-nguyen"}, "edited": false, "score": 0, "creation_date": 1543952798, "post_id": 53605796, "comment_id": 94101086, "body": "The first two sentences of your last comment contradict the third one. Logical or physical? Anyway, I have extended the answer in the hope that that clarifies something."}, {"owner": {"reputation": 130, "user_id": 5231353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Hi8H9QJz9c8/AAAAAAAAAAI/AAAAAAAAADg/4xOBsLCRlAE/photo.jpg?sz=128", "display_name": "Minh Nguyen", "link": "https://stackoverflow.com/users/5231353/minh-nguyen"}, "edited": false, "score": 0, "creation_date": 1543995527, "post_id": 53605796, "comment_id": 94114416, "body": "Sorry Im not getting the point across. I have been able to set up logical decoding of the WAL and been able to get data from it but only through postgres servers themselves. I was interested in the code for javascript/go to hook onto those streaming changes"}, {"owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "reply_to_user": {"reputation": 130, "user_id": 5231353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Hi8H9QJz9c8/AAAAAAAAAAI/AAAAAAAAADg/4xOBsLCRlAE/photo.jpg?sz=128", "display_name": "Minh Nguyen", "link": "https://stackoverflow.com/users/5231353/minh-nguyen"}, "edited": false, "score": 0, "creation_date": 1544000551, "post_id": 53605796, "comment_id": 94116738, "body": "I understand now. Did you look at the documentation of the plugin you are using? Is my answer useful at all or should I delete it?"}], "tags": [], "owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "is_accepted": false, "score": 1, "last_activity_date": 1543952733, "last_edit_date": 1543952733, "creation_date": 1543898425, "answer_id": 53605796, "question_id": 53604538, "link": "https://stackoverflow.com/questions/53604538/connecting-to-the-logical-replication-streaming-from-node-or-go/53605796#53605796", "title": "Connecting to the logical replication/streaming from node or go?", "body": "<p>I'm not certain what you want, but maybe you are looking for &ldquo;logical decoding&rdquo;.</p>\n\n<p>If you want to directly speak the <a href=\"https://www.postgresql.org/docs/current/protocol-logical-replication.html\" rel=\"nofollow noreferrer\">replication protocol</a> with the server, you'll have to implement it in your code, but that information is pretty useless, as it only contains the physical changes to the data files.</p>\n\n<p>If you want logical decoding, there is the <a href=\"https://www.postgresql.org/docs/current/test-decoding.html\" rel=\"nofollow noreferrer\"><code>test_decoding</code></a> module provided by PostgreSQL, and <a href=\"https://www.postgresql.org/docs/current/logicaldecoding-example.html\" rel=\"nofollow noreferrer\">here</a> are some examples how it can be used.</p>\n\n<p>Mind that <code>test_decoding</code> is for testing. For real-world use cases, you will want to use a logical decoding plugin that fits your needs, for example <a href=\"https://github.com/eulerto/wal2json\" rel=\"nofollow noreferrer\">wal2json</a>.</p>\n\n<p>If that's what you want to consume, you'll have to look up the documentation for the logical decoding plugin you want to use to learn the format in which it provides the information.</p>\n"}], "owner": {"reputation": 130, "user_id": 5231353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Hi8H9QJz9c8/AAAAAAAAAAI/AAAAAAAAADg/4xOBsLCRlAE/photo.jpg?sz=128", "display_name": "Minh Nguyen", "link": "https://stackoverflow.com/users/5231353/minh-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1543952733, "creation_date": 1543888026, "last_edit_date": 1543898488, "question_id": 53604538, "link": "https://stackoverflow.com/questions/53604538/connecting-to-the-logical-replication-streaming-from-node-or-go", "title": "Connecting to the logical replication/streaming from node or go?", "body": "<p>Is there a way to connect/subscribe to Postgres logical replication/streaming replication using node or go? I know its a TCP/IP connection but not exactly where to start. I also know there is a package for this, was wondering for more of a vanilla/understanding solution.</p>\n"}, {"tags": ["pointers", "go", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1543879603, "post_id": 53603454, "comment_id": 94069364, "body": "A pointer doesn&#39;t change anything, it&#39;s just a pointer. If you need to operate on data without knowing the type, you need to use reflection."}], "answers": [{"comments": [{"owner": {"reputation": 1035, "user_id": 8685016, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W693VKuEKv0/AAAAAAAAAAI/AAAAAAAAABM/v4pY2Z8NYB4/photo.jpg?sz=128", "display_name": "robbieperry22", "link": "https://stackoverflow.com/users/8685016/robbieperry22"}, "edited": false, "score": 0, "creation_date": 1543883227, "post_id": 53603498, "comment_id": 94070274, "body": "Might just have to use reflection, as I don&#39;t want the user to have to define too much.  If <code>items</code> is a pointer to a slice of interfaces, I can get the underlying slice with <code>i := reflect.ValueOf(items).Elem().Interface()</code>. However, <code>i</code> is still an interface at compile time. Do you know how I can have that interpreted as a slice? Would I just have to do a reflect <code>MakeSlice()</code> and copy the elements over?"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 1035, "user_id": 8685016, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W693VKuEKv0/AAAAAAAAAAI/AAAAAAAAABM/v4pY2Z8NYB4/photo.jpg?sz=128", "display_name": "robbieperry22", "link": "https://stackoverflow.com/users/8685016/robbieperry22"}, "edited": false, "score": 0, "creation_date": 1543946310, "post_id": 53603498, "comment_id": 94098076, "body": "I might be a bit confused by what you are asking. You can use reflect to inspect <code>i</code> and fetch each element via <a href=\"https://golang.org/pkg/reflect/#Value.Index\" rel=\"nofollow noreferrer\">golang.org/pkg/reflect/#Value.Index</a>"}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 2, "last_activity_date": 1543879668, "creation_date": 1543879668, "answer_id": 53603498, "question_id": 53603454, "link": "https://stackoverflow.com/questions/53603454/passing-arbitrary-slices-in-go/53603498#53603498", "title": "Passing arbitrary slices in Go", "body": "<p>You can't quite do this directly. </p>\n\n<p>You can use <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">reflection</a>, however this isn't a great solution. The normal way is to have an interface type defined that lets you interact with all the data in the same way. A good example of this is the <a href=\"https://golang.org/pkg/sort/#Interface\" rel=\"nofollow noreferrer\">sort</a> package.</p>\n"}], "owner": {"reputation": 1035, "user_id": 8685016, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W693VKuEKv0/AAAAAAAAAAI/AAAAAAAAABM/v4pY2Z8NYB4/photo.jpg?sz=128", "display_name": "robbieperry22", "link": "https://stackoverflow.com/users/8685016/robbieperry22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 53603498, "answer_count": 1, "score": -1, "last_activity_date": 1543879668, "creation_date": 1543879393, "question_id": 53603454, "link": "https://stackoverflow.com/questions/53603454/passing-arbitrary-slices-in-go", "title": "Passing arbitrary slices in Go", "body": "<p>I'm writing a function that retrieves arbitrary data from a database, and returns a slice of structs with the results. The data structure is defined by the user in an ItemFactory. The user then implements methods on the factory, that create empty structs:</p>\n\n<pre><code>func (t Example) GenerateEmptyItem() interface{} {\n    return &amp;Example{}\n}\n</code></pre>\n\n<p>I am trying to do the same for slices of <code>Example</code>. I need to be able to use whatever is returned, to call functions such as <code>len()</code>, while at the same time, keeping it generic as to allow it to be returned by \"generic\" functions.</p>\n\n<p>I can't simply have something like this, as the underlying data allocation for a slice of interfaces is different from a slice of Examples:</p>\n\n<pre><code>func (t Country) GenerateEmptyItems() []interface{} {\n    return []Country{} //Error\n}\n</code></pre>\n\n<p>Is it possible to use a pointer to a slice, such as <code>&amp;[]Example{}</code> and pass it as an <code>interface{}</code>, and then still be able to use it as a slice? Or am I going about this wrong?.Remember, I don't know the type of the data at compile-time, so I can't simply cast.</p>\n\n<p>I appreciate any help. Let me know if I can clarify anything.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "is_accepted": false, "score": 0, "last_activity_date": 1543880461, "creation_date": 1543880461, "answer_id": 53603624, "question_id": 53603286, "link": "https://stackoverflow.com/questions/53603286/ip-address-starting-from-a-maxaddress/53603624#53603624", "title": "IP address starting FROM a maxAddress", "body": "<p>If you print <code>\u00ecpMax</code>, you'll see its underlying representation is using 16 bytes. (see also the <a href=\"https://golang.org/pkg/net/#IP\" rel=\"nofollow noreferrer\">docs</a></p>\n\n<pre><code>fmt.Printf(\"'%#v'\\n\",ipMax)\n\n'net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0x3e, 0x4c, 0x2f, 0x9}'\n</code></pre>\n\n<p>You can convert <code>ipMax</code> to an IPv4 representation to have your desired results:</p>\n\n<pre><code>ipMax := net.ParseIP(\"62.76.47.9\").To4()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "is_accepted": false, "score": 0, "last_activity_date": 1543883983, "creation_date": 1543883983, "answer_id": 53604049, "question_id": 53603286, "link": "https://stackoverflow.com/questions/53603286/ip-address-starting-from-a-maxaddress/53604049#53604049", "title": "IP address starting FROM a maxAddress", "body": "<p>This example will print addresses starting from the first address of 62.76.47.12/28 up to 62.76.47.9.</p>\n\n<p>Playground: <a href=\"https://play.golang.org/p/MUtbiKaQ_3-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/MUtbiKaQ_3-</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n)\n\nfunc main() {\n    cidr := \"62.76.47.12/28\"\n    _, ipnet, _ := net.ParseCIDR(cidr)\n    ipFirst := ipnet.IP\n    ipFirstValue := toHost(ipFirst)\n\n    ipLast := net.ParseIP(\"62.76.47.9\")\n    ipLastValue := toHost(ipLast)\n\n    fmt.Println(\"cidr:  \", cidr)\n    fmt.Println(\"first: \", ipFirst)\n    fmt.Println(\"last:  \", ipLast)\n\n    if ipLastValue &lt; ipFirstValue {\n        fmt.Println(\"ugh\")\n        return\n    }\n\n    for i := ipFirstValue; i &lt; ipLastValue; i++ {\n        addr := toIP(i)\n        fmt.Println(addr)\n    }\n}\n\nfunc toHost(ip net.IP) uint32 {\n    i := ip.To4()\n    return uint32(i[0])&lt;&lt;24 + uint32(i[1])&lt;&lt;16 + uint32(i[2])&lt;&lt;8 + uint32(i[3])\n}\n\nfunc toIP(v uint32) net.IP {\n    v3 := byte(v &amp; 0xFF)\n    v2 := byte((v &gt;&gt; 8) &amp; 0xFF)\n    v1 := byte((v &gt;&gt; 16) &amp; 0xFF)\n    v0 := byte((v &gt;&gt; 24) &amp; 0xFF)\n    return net.IPv4(v0, v1, v2, v3)\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 2754691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d38d791f47588c18671daeae27124298?s=128&d=identicon&r=PG&f=1", "display_name": "user2754691", "link": "https://stackoverflow.com/users/2754691/user2754691"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1543883983, "creation_date": 1543878272, "question_id": 53603286, "link": "https://stackoverflow.com/questions/53603286/ip-address-starting-from-a-maxaddress", "title": "IP address starting FROM a maxAddress", "body": "<p>I've a need where I need to start generating IP addresses\ngiven a CIDR and some cached address.\nI've some code here where I'm doing bytes.Compare with stored\naddress and only select those that are greater.</p>\n\n<p><a href=\"https://play.golang.org/p/yT_Mj4fR_jK\" rel=\"nofollow noreferrer\">https://play.golang.org/p/yT_Mj4fR_jK</a></p>\n\n<p>What is going wrong here? Basically I need all the addresses\nfrom \"62.76.47.9\" in \"62.76.47.12/28\". Generating the IPs\nin the given CIDR range is wellknown.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["html", "go", "template-engine"], "comments": [{"owner": {"reputation": 39296, "user_id": 560299, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c38fe465734e8428048585e0acf6174f?s=128&d=identicon&r=PG", "display_name": "Ibu", "link": "https://stackoverflow.com/users/560299/ibu"}, "edited": false, "score": 0, "creation_date": 1543878665, "post_id": 53603280, "comment_id": 94069110, "body": "It may seem counter intuitive, but go html template removes these comments because it can&#39;t guarantee safe html with it. See <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/mriui-HG65A\" rel=\"nofollow noreferrer\">the discussion here</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543907257, "post_id": 53603280, "comment_id": 94076389, "body": "Asking for 3rd party libs or tools is off-topic. But the marked duplicate shows how you can do that with the standard lib&#39;s template engine."}], "owner": {"reputation": 63, "user_id": 10133952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87065839b9f75ebc1d7cfa046cb21f88?s=128&d=identicon&r=PG&f=1", "display_name": "bastisstackoverflow", "link": "https://stackoverflow.com/users/10133952/bastisstackoverflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "closed_date": 1543907227, "answer_count": 0, "score": 0, "last_activity_date": 1543878245, "creation_date": 1543878245, "question_id": 53603280, "link": "https://stackoverflow.com/questions/53603280/golang-template-engine", "closed_reason": "Duplicate", "title": "Golang template engine", "body": "<p>Im looking for a golang template engine/library that keeps HTML comments when rendering a template. Unfortunately the golang standard html/template excludes comments. Please tell me if you have a suggestion.</p>\n"}, {"tags": ["go", "production", "libpq"], "comments": [{"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1543878452, "post_id": 53602650, "comment_id": 94069049, "body": "It is preferable to use specific version"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1543890724, "last_edit_date": 1543890724, "creation_date": 1543889956, "answer_id": 53604801, "question_id": 53602650, "link": "https://stackoverflow.com/questions/53602650/can-i-use-master-libpq-in-production/53604801#53604801", "title": "can I use master libpq in production", "body": "<blockquote>\n  <p><a href=\"https://github.com/lib/pq\" rel=\"nofollow noreferrer\"><code>lib/pq</code></a></p>\n  \n  <p>Releases</p>\n  \n  <p><a href=\"https://github.com/lib/pq/releases\" rel=\"nofollow noreferrer\">v1.0.0</a></p>\n  \n  <p>Initial tagged release. No major recent changes.</p>\n  \n  <p><a href=\"https://github.com/lib/pq/commit/4ded0e9383f75c197b3a2aaa6d590ac52df6fd79\" rel=\"nofollow noreferrer\">Merge pull request #778 from lib/go-mod</a></p>\n  \n  <p>add a go.mod file in preparation for a tagged release</p>\n</blockquote>\n\n<hr>\n\n<p><code>lib/pq</code> v1.0.0 adds support for Go versioned modules.</p>\n\n<p>For Go1.12, consider upgrading your production code for Go versioned modules.</p>\n\n<p>The first beta release of Go 1.12  is scheduled for this week (Dec, 3, 2018).</p>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/doc/go1.11\" rel=\"nofollow noreferrer\">Go 1.11 Release Notes</a></p>\n  \n  <p><a href=\"https://golang.org/doc/go1.11#modules\" rel=\"nofollow noreferrer\">Modules, package versioning, and dependency management</a> </p>\n  \n  <p>Go 1.11 adds preliminary support for a new concept called \u201cmodules,\u201d\n  an alternative to GOPATH with integrated support for versioning and\n  package distribution. Using modules, developers are no longer confined\n  to working inside GOPATH, version dependency information is explicit\n  yet lightweight, and builds are more reliable and reproducible.</p>\n  \n  <p>Module support is considered experimental. Details are likely to\n  change in response to feedback from Go 1.11 users, and we have more\n  tools planned. Although the details of module support may change,\n  projects that convert to modules using Go 1.11 will continue to work\n  with Go 1.12 and later. If you encounter bugs using modules, please\n  file issues so we can fix them. For more information, see the go\n  command documentation.</p>\n</blockquote>\n\n<p><a href=\"https://go.googlesource.com/proposal/+/master/design/24301-versioned-go.md\" rel=\"nofollow noreferrer\">Proposal: Versioned Go Modules</a></p>\n\n<p><a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">Go 1.11 Modules</a>.</p>\n"}], "owner": {"reputation": 19, "user_id": 3240017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGQFj.png?s=128&g=1", "display_name": "Alessandro", "link": "https://stackoverflow.com/users/3240017/alessandro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1543890724, "creation_date": 1543874736, "question_id": 53602650, "link": "https://stackoverflow.com/questions/53602650/can-i-use-master-libpq-in-production", "title": "can I use master libpq in production", "body": "<p>Is it ok to use the master branch of lib/pq in production?\nWhen you execute go get gitlab.com/lib/pq you get the master branch, but there is a release v1.0.0.\nWould it be better to use releases instead of master branch?</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 2, "creation_date": 1543860807, "post_id": 53599265, "comment_id": 94061347, "body": "That does not seem possible as Go regex does not support <a href=\"https://www.regular-expressions.info/branchreset.html\" rel=\"nofollow noreferrer\">branch reset groups</a>. Use some PCRE library if you need it badly."}, {"owner": {"reputation": 1904, "user_id": 75577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zGPuh.png?s=128&g=1", "display_name": "KingOfCoders", "link": "https://stackoverflow.com/users/75577/kingofcoders"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1543918282, "post_id": 53599265, "comment_id": 94082119, "body": "Thanks, and thanks for the technical term."}, {"owner": {"reputation": 1904, "user_id": 75577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zGPuh.png?s=128&g=1", "display_name": "KingOfCoders", "link": "https://stackoverflow.com/users/75577/kingofcoders"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1543920925, "post_id": 53599265, "comment_id": 94083623, "body": "If you&#39;ll make it an answer I&#39;ll accept it."}], "answers": [{"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1543921293, "creation_date": 1543921293, "answer_id": 53611470, "question_id": 53599265, "link": "https://stackoverflow.com/questions/53599265/using-groups-in-go-regex-with-or/53611470#53611470", "title": "Using groups in Go Regex with Or |", "body": "<p>Go regex engine is <a href=\"https://github.com/google/re2/wiki/Syntax\" rel=\"nofollow noreferrer\">RE2</a>, and infortunately it does not support the feature you are looking for, namely, a <a href=\"https://www.regular-expressions.info/branchreset.html\" rel=\"nofollow noreferrer\">branch reset group</a>. </p>\n\n<p>There are PCRE library ports for Go if you need it by all means. Here is a <a href=\"https://godoc.org/github.com/glenn-brown/golang-pkg-pcre/src/pkg/pcre\" rel=\"nofollow noreferrer\"><code>package pcre</code> library</a>, for example. Once added, you can use</p>\n\n<pre><code>(?|&lt;(\\$)([a-zA-Z0-9]+):([a-zA-Z0-9]+):([a-zA-Z0-9]+)&gt;|{(@)([a-zA-Z0-9 ]+)})\n^^^                                                  ^                    ^\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/liXo9y/1\" rel=\"nofollow noreferrer\">regex demo</a>.</p>\n"}], "owner": {"reputation": 1904, "user_id": 75577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zGPuh.png?s=128&g=1", "display_name": "KingOfCoders", "link": "https://stackoverflow.com/users/75577/kingofcoders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 53611470, "answer_count": 1, "score": 2, "last_activity_date": 1543921293, "creation_date": 1543859869, "question_id": 53599265, "link": "https://stackoverflow.com/questions/53599265/using-groups-in-go-regex-with-or", "title": "Using groups in Go Regex with Or |", "body": "<p>Is there a way in Go Regex if I have (a)|(b) to start groups for b also with 0 ? how would I do that?</p>\n\n<pre><code>re := regexp.MustCompile(\n   `&lt;(\\$)([a-zA-Z0-9]+):([a-zA-Z0-9]+):([a-zA-Z0-9]+)&gt;|{(@)([a-zA-Z0-9 ]+)}`)\n</code></pre>\n\n<p>and iterate over with </p>\n\n<pre><code>for _, v := range re.FindAllSubmatchIndex([]byte(str), -1) {\n  ...\n}\n</code></pre>\n\n<p>How do I \"normalize\" groups (indexes)? so the (@) is also group 0?</p>\n\n<p>Can i use groupnames with the same names?</p>\n"}, {"tags": ["go", "select", "deadlock", "channel", "goroutine"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1543855284, "post_id": 53597605, "comment_id": 94058747, "body": "There is no way to exit the <code>Manager</code> for loop. You put a <code>break</code> in the default case, but <code>select</code> acts the same a <code>switch</code> so it is only breaking out of the default case, not the for loop."}, {"owner": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1543855491, "post_id": 53597605, "comment_id": 94058847, "body": "I thought about putting a label for the loop, f.e. <code>Loop : for { .. } </code> and then just put <code>break Loop</code> in the default case, but I&#39;m not sure that it is the proper way to fix this issue."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543857330, "post_id": 53597605, "comment_id": 94059725, "body": "@Dariuha: while there are still other issues here, breaking from nested blocks is usually easiest if you structure the code to use an early <code>return</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543855377, "post_id": 53598072, "comment_id": 94058797, "body": "Thanks for your input. But isn&#39;t <code>select</code> required to ensure that the program is working concurrently? That is the only reason why I figured I needed to implement <code>select</code> block."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543855451, "post_id": 53598072, "comment_id": 94058829, "body": "Not quite. The select lets you operate on multiple channels in a single place/go-routine. Go routines are what let you do things concurrently."}, {"owner": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543855696, "post_id": 53598072, "comment_id": 94058941, "body": "I would still like to figure out how to implement the <code>select</code> block in this case. So earlier I checked whether or not the <code>writerChan</code> is open, so I would know when to break the loop. What could be condition when using <code>select</code>, maybe you have any ideas how I could get it to work?"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543856113, "post_id": 53598072, "comment_id": 94059173, "body": "Take a look at the go tour on an example of when to use a select: <a href=\"https://tour.golang.org/concurrency/5\" rel=\"nofollow noreferrer\">tour.golang.org/concurrency/5</a>. For the select to know if the channel is closed, you would actually do the same thing as you did before: <code>case ageIn, writersOpen := &lt;- writerChan</code>"}, {"owner": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543856793, "post_id": 53598072, "comment_id": 94059499, "body": "So in <code>case ageIn, writersOpen := &lt;- writerChan</code>, I need an <code>if</code> statement <code>if writersOpen { ... doing my stuff... }</code> and in <code>else</code> of that <code>if</code> I should exit the <code>Manager</code>, how should that be done? I thought using break should work, but it only exits the <code>case</code> and not the <code>Manager</code> itself."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543857672, "post_id": 53598072, "comment_id": 94059887, "body": "Right, so ranging over the channel is the same as checking the second argument from a channel when reading from it. It is only ever false when the channel is closed. Are you closing the channel anywhere?"}, {"owner": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543857899, "post_id": 53598072, "comment_id": 94060012, "body": "Yes, I do close the channel in a function called <code>Writer</code>, I updated the original post with the included code for that function."}, {"owner": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543858216, "post_id": 53598072, "comment_id": 94060168, "body": "But it never reaches that part where the channel is closed, because the program locks up after 6 writers add 1 of their player to writerChan and that&#39;s it. I checked that by printing what is being sent to writerChan. I have 6 teams and every team has some players in it, each writer process is responsible for 1 team and adding that team&#39;s players to the writerChan. Program locks up after the first adding of each writer process."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543858317, "post_id": 53598072, "comment_id": 94060208, "body": "Probably because your channels have a buffer len of 6. If you made them bigger, would it get to the close?"}, {"owner": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543858572, "post_id": 53598072, "comment_id": 94060315, "body": "Yes. It does close if I make it bigger, but I still get that fatal error about goroutines asleep."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543858975, "post_id": 53598072, "comment_id": 94060491, "body": "If thats the case, it implies you are reading and writing from the same go routine. It also implies that you are writing one more than the buffer in the channel can hold, so it will block for ever. That is one problem. Does the panic from the deadlock show where everything is waiting?"}, {"owner": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543859047, "post_id": 53598072, "comment_id": 94060527, "body": "It points to line 31, which is in <code>main</code> at <code>waitGroup.Wait()</code>"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543859131, "post_id": 53598072, "comment_id": 94060565, "body": "This implies that some of the Done() methods are not being invoked. Any idea which one? Maybe put some print lines in"}, {"owner": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543859679, "post_id": 53598072, "comment_id": 94060836, "body": "I checked the <code>Writer</code> function, it does print out all of the players from the data file and that the channel is closed in the end. So I guess <code>Writer</code> function isn&#39;t the one. I also checked what <code>Manager</code> function takes from the <code>writerChan</code>, it takes all the 28 players from that channel. So it shouldn&#39;t be the <code>Manager</code> either, I have no idea what else to check? However I checked my function called <code>Add</code> which is used in the <code>Writer</code> function and noticed that I didn&#39;t put <code>defer waitGroup.Done()</code> there, should I?"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543859785, "post_id": 53598072, "comment_id": 94060889, "body": "The key is that Done needs to be called the same number of times that you gave WaitGroup.Add(). It doesn&#39;t look like your Add should have a Done()."}, {"owner": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543860011, "post_id": 53598072, "comment_id": 94060976, "body": "It seems that I added too many to waitGroup.Add.. I reduced it and now it doesn&#39;t show that goroutines are asleep anymore. I didn&#39;t know that waitGroup.Add(number) needed the same amount of waitGroup.Done() invokes.. Thank you."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "edited": false, "score": 0, "creation_date": 1543860040, "post_id": 53598072, "comment_id": 94060989, "body": "Good deal! Glad I could help."}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 2, "last_activity_date": 1543855201, "creation_date": 1543855201, "answer_id": 53598072, "question_id": 53597605, "link": "https://stackoverflow.com/questions/53597605/goroutine-deadlock-when-using-a-channel-with-select/53598072#53598072", "title": "Goroutine deadlock when using a channel with select", "body": "<p>It looks like your logic to exit the <code>Manager</code> func is now different. Before you waited for the channel to be closed, however now you don't check at all. In fact <code>Manager</code> will never exit. This also implies that the <code>WaitGroup</code> will never be done.</p>\n\n<p>I think the select in <code>Manager</code> it not necessary. If you are closing the channel, then just range over it:</p>\n\n<pre><code>for ageIn := range writerChan {\n  Add(list, Request{Value: ageIn, Count: 1}) // putting new object to list\n}\n</code></pre>\n\n<p>This will properly exit when the <code>writerChan</code> is closed.</p>\n"}], "owner": {"reputation": 1, "user_id": 10696280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829ec0b905b59122bee22e4fc7b613f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dariuha", "link": "https://stackoverflow.com/users/10696280/dariuha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 53598072, "answer_count": 1, "score": -3, "last_activity_date": 1543858464, "creation_date": 1543853573, "last_edit_date": 1543858464, "question_id": 53597605, "link": "https://stackoverflow.com/questions/53597605/goroutine-deadlock-when-using-a-channel-with-select", "title": "Goroutine deadlock when using a channel with select", "body": "<p>I've tried to rewrite a working program which didn't use <code>select</code> or <code>WaitGroup</code>, so that it would implement <code>select</code> and <code>WaitGroup</code>, but I've came upon an issue, which I can't find a solution to. It seems that goroutine deadlock occurs, because the <code>Manager</code> function is not taking the data from the writer channel, therefore the channel is blocked from sending/receiving and the program locks up.</p>\n\n<p>The original working <code>Manager</code> function, without <code>select</code> :</p>\n\n<pre><code>func Manager(list *[]Request, writerChan &lt;-chan int) {\n    ageIn, writersOpen := &lt;-writerChan\n    for {\n        if writersOpen { // if writers channel is open\n\n            Add(list, Request{Value: ageIn, Count: 1}) // putting new object to list\n            ageIn, writersOpen = &lt;-writerChan          // receiving new player from writer channe;\n\n        } else {\n            break\n        }\n    }\n}\n</code></pre>\n\n<p><strong>So I had a working program, but needed to implement <code>WaitGroup</code> and <code>select</code>, there are the updated codes :</strong></p>\n\n<p>The <strong>updated <code>Manager</code> function</strong> with <code>select</code> implemenation :</p>\n\n<pre><code>func Manager(list *[]Request, writerChan &lt;-chan int) {\n    defer waitGroup.Done()\n    for {\n        select {\n        case ageIn := &lt;-writerChan:\n            Add(list, Request{Value: ageIn, Count: 1}) // add player to list\n        default:\n            break\n        }\n    }\n}\n</code></pre>\n\n<p>The <strong>updated <code>Main</code> function</strong> with <code>WaitGroup</code> implementation :</p>\n\n<pre><code>var waitGroup sync.WaitGroup\n\nfunc main() {\n    list := ParallelList{List: make([]Request, 0)}\n    readers, teams, players := ReadData(\"data.txt\")\n    writerChan := make(chan int)          //any2one writers channel\n    writerFinishChan := make(chan int, 6) // channel to know when all writers are done writing\n\n    waitGroup.Add(6)\n\n    for i := 0; i &lt; len(teams); i++ {\n        go Writer(teams, teams[i], writerChan, writerFinishChan)\n    }\n\n    go Manager(&amp;list.List, writerChan)\n    waitGroup.Wait()\n}\n</code></pre>\n\n<p><strong>The <code>Writer</code> function which sends data to writerChan</strong></p>\n\n<pre><code>func Writer(teams [][]Player, team []Player, writerChan chan&lt;- int,\n    writerFinishChan chan int) {\n    defer waitGroup.Done()\n    count := len(team)\n    for i := 0; i &lt; count; i++ {\n        writerChan &lt;- team[i].Age\n    }\n    writerFinishChan &lt;- 1 // when writer finishes writing, he puts 1 to the \"writerFinishChan\"\n\n    if len(writerFinishChan) == len(teams) { // if all writers are done writing (the len should be equal to 6)\n        close(writerChan)\n    }\n}\n</code></pre>\n\n<p>So the problem now is that after implementing <code>select</code> and <code>WaitGroup</code> my program doesn't work properly anymore, it gives me a \"fatal error : goroutines asleep, deadlock\". </p>\n\n<p>Maybe someone can help me up with sorting out this issue? I'm quite sure that the issue lies within the <code>Manager</code> function and it's <code>select</code> block</p>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 1255, "user_id": 4982148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X52Wq.jpg?s=128&g=1", "display_name": "atakanyenel", "link": "https://stackoverflow.com/users/4982148/atakanyenel"}, "edited": false, "score": 0, "creation_date": 1543853301, "post_id": 53597322, "comment_id": 94057618, "body": "A non Go based solution would be to use git submodules to clone those <code>.proto</code> files to your project and update it regularly with git. This is the trivial sub-package approach."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1543853534, "post_id": 53597322, "comment_id": 94057752, "body": "Go does not restrict code to be in a single repository. You use import paths and <code>go get</code> to use code from any repositories. Putting proto files in a different repository is not special in this regard. Just commit the generated Go files into the proto&#39;s repository, and import that path in your Go project where you want to use it. There are tricks to make <code>go get</code> work with private repos (google it), or just manually clone the repository into your Go workspace."}], "answers": [{"tags": [], "owner": {"reputation": 32481, "user_id": 2270041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cn7rq.jpg?s=128&g=1", "display_name": "Matteo", "link": "https://stackoverflow.com/users/2270041/matteo"}, "is_accepted": false, "score": 0, "last_activity_date": 1543853941, "creation_date": 1543853941, "answer_id": 53597720, "question_id": 53597322, "link": "https://stackoverflow.com/questions/53597322/using-a-shared-external-package-for-proto-files/53597720#53597720", "title": "Using a shared external package for proto files?", "body": "<p>You can use the <code>protoc</code> and specify the include path, as example:</p>\n\n<pre><code>protoc -I/usr/local/include -I. \\\n-I${GOPATH}/src \\\n-I${GOPATH}/src/github.com/grpc-ecosystem/grpc-gateway/third_party/googleapis \\\n--go_out=$DST_DIR \\ \nmy-proto.proto\n</code></pre>\n\n<p>Hope this help</p>\n"}, {"tags": [], "owner": {"reputation": 8322, "user_id": 465738, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/tSedM.jpg?s=128&g=1", "display_name": "Edson Medina", "link": "https://stackoverflow.com/users/465738/edson-medina"}, "is_accepted": false, "score": 1, "last_activity_date": 1543855001, "creation_date": 1543855001, "answer_id": 53598024, "question_id": 53597322, "link": "https://stackoverflow.com/questions/53597322/using-a-shared-external-package-for-proto-files/53598024#53598024", "title": "Using a shared external package for proto files?", "body": "<p>Create a repository for your new package (auto generated from the <code>.proto</code> files). Ie:</p>\n\n<pre><code>protoc --go_out=$GOPATH/your/git/repo /path/to/your/schema.proto\n</code></pre>\n\n<p>Make sure you <code>git push</code> the repo.</p>\n\n<p>Then on the external projects that need to use it, just include:</p>\n\n<pre><code>import \"your/git/repo/schema/yourStruct\"\n</code></pre>\n"}], "owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2019, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1543855001, "creation_date": 1543852538, "question_id": 53597322, "link": "https://stackoverflow.com/questions/53597322/using-a-shared-external-package-for-proto-files", "title": "Using a shared external package for proto files?", "body": "<p>We have a few projects that depend on shared types to communicate. The teams have decided to use a shared package with those types, and would like to use protocol buffers for this implementation. If it matters, the language is Go, and all of these projects are not public.</p>\n\n<p>How can we use protocol buffer types not defined within our project? I can't seem to find a way to share completely external types amongst applications. Everything I read tends to explain how to use sub-package <code>.proto</code> files but not types defined by another developer/team in another project within your project.</p>\n"}, {"tags": ["go", "travis-ci"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1543850593, "post_id": 53596652, "comment_id": 94056003, "body": "No, there is not. I&#39;ve never used TravisCI, but surely any CI system would be useless if you couldn&#39;t pass parameters to a command as part of the build - there must be some way. I guess barring that maybe you could wrap it in a bash script or something?"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 2, "creation_date": 1543850689, "post_id": 53596652, "comment_id": 94056057, "body": "When I&#39;ve used TravisCI, used a Makefile.  It worked fine"}], "answers": [{"tags": [], "owner": {"reputation": 2491, "user_id": 136333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40e5e9fe36a1f85166493faac2c17499?s=128&d=identicon&r=PG", "display_name": "banzaiman", "link": "https://stackoverflow.com/users/136333/banzaiman"}, "is_accepted": false, "score": 1, "last_activity_date": 1543894126, "creation_date": 1543894126, "answer_id": 53605273, "question_id": 53596652, "link": "https://stackoverflow.com/questions/53596652/can-i-specify-go-build-filename-in-a-config-file/53605273#53605273", "title": "Can I specify GO build filename in a config file?", "body": "<p>Override <a href=\"https://docs.travis-ci.com/user/languages/go#default-build-script\" rel=\"nofollow noreferrer\"><code>script</code></a>. If you mean <code>gobuild_args</code> instead of <code>build_args</code>, it is only passed to the default command <code>go test ./...</code>, so I don't think it would work.</p>\n"}], "owner": {"reputation": 27, "user_id": 8156876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e666e6900a1955e6cafd58c61f0c2d?s=128&d=identicon&r=PG&f=1", "display_name": "Chatter-Gotta-Chat", "link": "https://stackoverflow.com/users/8156876/chatter-gotta-chat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1543894126, "creation_date": 1543850362, "question_id": 53596652, "link": "https://stackoverflow.com/questions/53596652/can-i-specify-go-build-filename-in-a-config-file", "title": "Can I specify GO build filename in a config file?", "body": "<p>I'm trying to build a multi-dist executable using Travis CI which will put the built executables on github.</p>\n\n<p>I want the name to be somename.os.arch.<br>\nWhen I build locally via command line, I use the <code>-o</code> param and the env vars <code>$GOOS</code> &amp; <code>$GOARCH</code> e.g.: <code>go build -o somename.$GOOS.$GOARCH</code></p>\n\n<p>However, I cannot specify this for TravisCI using their <code>build_args</code> as other steps fail (not understanding -o flag)</p>\n\n<p>Is there a Go build config file I can create to set the build output name?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 471, "user_id": 4897593, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155566542875634/picture?type=large", "display_name": "Richard", "link": "https://stackoverflow.com/users/4897593/richard"}, "is_accepted": false, "score": 2, "last_activity_date": 1551778922, "creation_date": 1551778922, "answer_id": 54999710, "question_id": 53595875, "link": "https://stackoverflow.com/questions/53595875/uber-zap-logging-having-custom-message-encoder/54999710#54999710", "title": "Uber zap logging having custom message encoder", "body": "<p>Based on your code, the following configuration worked for me:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func logInit(d bool, f *os.File) *zap.SugaredLogger {\n\n    pe := zap.NewProductionEncoderConfig()\n\n    fileEncoder := zapcore.NewJSONEncoder(pe)\n\n    pe.EncodeTime = zapcore.ISO8601TimeEncoder\n    consoleEncoder := zapcore.NewConsoleEncoder(pe)\n\n    level := zap.InfoLevel\n    if d {\n        level = zap.DebugLevel\n    }\n\n    core := zapcore.NewTee(\n        zapcore.NewCore(fileEncoder, zapcore.AddSync(f), level),\n        zapcore.NewCore(consoleEncoder, zapcore.AddSync(os.Stdout), level),\n    )\n\n    l := zap.New(core)\n\n    return l.Sugar()\n}\n</code></pre>\n"}], "owner": {"reputation": 825, "user_id": 570200, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c1f1eb2f77f0fc96d61e5d2252b179dc?s=128&d=identicon&r=PG", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/570200/abhinav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1933, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1551778922, "creation_date": 1543847508, "question_id": 53595875, "link": "https://stackoverflow.com/questions/53595875/uber-zap-logging-having-custom-message-encoder", "title": "Uber zap logging having custom message encoder", "body": "<p>I am using below code to dump logs on console and log file using Uber zap logger. I am looking how I can have a custom message encoder so that the output format for the message can be as below</p>\n\n<pre><code>{\"severity\":\"DEBUG\",\"message\":\"Dec 12, 2018  19:52:39 [log.go:77] Sample debug for log file and console\"}\n</code></pre>\n\n<p>Below is the code which I am using to dump the logs on the console. </p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"time\"\n\n    \"go.uber.org/zap\"\n    \"go.uber.org/zap/zapcore\"\n    \"gopkg.in/natefinch/lumberjack.v2\"\n    \"path/filepath\"\n)\n\nvar logLevelSeverity = map[zapcore.Level]string{\n    zapcore.DebugLevel:  \"DEBUG\",\n    zapcore.InfoLevel:   \"INFO\",\n    zapcore.WarnLevel:   \"WARNING\",\n    zapcore.ErrorLevel:  \"ERROR\",\n    zapcore.DPanicLevel: \"CRITICAL\",\n    zapcore.PanicLevel:  \"ALERT\",\n    zapcore.FatalLevel:  \"EMERGENCY\",\n}\n\nfunc SyslogTimeEncoder(t time.Time, enc zapcore.PrimitiveArrayEncoder) {\n    enc.AppendString(t.Format(\"Jan 01, 2006  15:04:05\"))\n}\n\nfunc CustomEncodeLevel(level zapcore.Level, enc zapcore.PrimitiveArrayEncoder) {\n    enc.AppendString(logLevelSeverity[level])\n}\n\nfunc CustomLevelFileEncoder(level zapcore.Level, enc zapcore.PrimitiveArrayEncoder) {\n    enc.AppendString(\"[\" + logLevelSeverity[level] + \"]\")\n}\nfunc funcCaller(caller zapcore.EntryCaller, enc zapcore.PrimitiveArrayEncoder) {\n    enc.AppendString(filepath.Base(caller.FullPath()))\n}\n\nfunc main() {\n\n    w := zapcore.AddSync(&amp;lumberjack.Logger{\n        Filename:   \"temp1.log\",\n        MaxSize:    1024,\n        MaxBackups: 20,\n        MaxAge:     28,\n        Compress:   true,\n    })\n\n    //Define config for the console output\n    cfgConsole := zapcore.EncoderConfig{\n        MessageKey:   \"message\",\n        LevelKey:     \"severity\",\n        EncodeLevel:  CustomEncodeLevel,\n        TimeKey:      \"time\",\n        EncodeTime:   SyslogTimeEncoder,\n        CallerKey:    \"caller\",\n        EncodeCaller: funcCaller,\n    }\n    cfgFile := zapcore.EncoderConfig{\n        MessageKey:   \"message\",\n        LevelKey:     \"severity\",\n        EncodeLevel:  CustomLevelFileEncoder,\n        TimeKey:      \"time\",\n        EncodeTime:   SyslogTimeEncoder,\n        CallerKey:    \"caller\",\n        EncodeCaller: funcCaller,\n    }\n\n    consoleDebugging := zapcore.Lock(os.Stdout)\n    //consoleError := zapcore.Lock(os.Stderr)\n    core := zapcore.NewTee(\n        zapcore.NewCore(zapcore.NewConsoleEncoder(cfgFile), w, zap.DebugLevel),\n        zapcore.NewCore(zapcore.NewJSONEncoder(cfgConsole), consoleDebugging, zap.DebugLevel),\n        //zapcore.NewCore(zapcore.NewJSONEncoder(zap.NewProductionEncoderConfig()), consoleError, zap.ErrorLevel),\n    )\n    //core := zapcore.NewCore(zapcore.NewConsoleEncoder(encConsole), w, zap.DebugLevel)\n    wlogger := zap.New(core, zap.AddCaller())\n    wlogger.Debug(\"Sample debug for log file and console\")\n    wlogger.Warn(\"An warning message example\")\n    wlogger.Info(\"An info level message\")\n    coreFile := zapcore.NewCore(zapcore.NewConsoleEncoder(cfgFile), w, zap.DebugLevel)\n    flogger := zap.New(coreFile, zap.AddCaller())\n    flogger.Debug(\"An exclusive message for file\")\n    //output\n    //{\"severity\":\"DEBUG\",\"time\":\"Dec 12, 2018  19:52:39\",\"caller\":\"log.go:77\",\"message\":\"Sample debug for log file and console\"}\n}\n</code></pre>\n\n<p>Any thoughts how to achieve the expected output as we have an requirement for putting the message on the console in above format.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1543850048, "post_id": 53595399, "comment_id": 94055703, "body": "There&#39;s nothing inherently wrong here, since you are getting a response. You have to inspect the server code to figure out why you are getting this response."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1543870228, "post_id": 53595399, "comment_id": 94065822, "body": "It looks like you might be ignoring potential errors. Is the error nil after <code>NewClient().Do(req)</code>?"}, {"owner": {"reputation": 825, "user_id": 570200, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c1f1eb2f77f0fc96d61e5d2252b179dc?s=128&d=identicon&r=PG", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/570200/abhinav"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1543924046, "post_id": 53595399, "comment_id": 94085320, "body": "@MadWombat I tried even checking error after making Do request. But no error is being reported."}], "owner": {"reputation": 825, "user_id": 570200, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c1f1eb2f77f0fc96d61e5d2252b179dc?s=128&d=identicon&r=PG", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/570200/abhinav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2710, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543923280, "creation_date": 1543845734, "last_edit_date": 1543923280, "question_id": 53595399, "link": "https://stackoverflow.com/questions/53595399/tls-mutual-authentication-return-error-as-combination-of-host-and-port-requires", "title": "TLS mutual authentication return error as combination of host and port requires TLS", "body": "<p>I am trying to have a TLS mutual auth setup but I am getting error from server as <code>This combination of host and port requires TLS.</code></p>\n\n<p>Below is the code I am trying to use.</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/tls\"\n    \"crypto/x509\"\n    \"io/ioutil\"\n    \"log\"\n    \"net\"\n    \"net/http\"\n    \"net/http/httputil\" //\"os\"\n    \"time\"\n)\n\n//HTTPClient will retrun an HTTP client back to user\ntype HTTPClient struct {\n    *http.Client\n}\n\n//NewClient will return an HTTP client with TLS mutual Auth set\n//Input: isSecure\n//Return: HTTPClient\nfunc NewClient() *HTTPClient {\n    log.Println(\"Setting up TLS configuration\")\n    cert, err := tls.LoadX509KeyPair(\"cert.pem\", \"key.pem\")\n    if err != nil {\n        log.Fatal(\"Unable to read certificates \", err)\n    }\n    //load CA certificate\n    caCert, err := ioutil.ReadFile(\"ca.pem\")\n    if err != nil {\n        log.Fatal(\"Unable to read CA certificate \", err)\n    }\n    caCertPool := x509.NewCertPool()\n    caCertPool.AppendCertsFromPEM(caCert)\n\n    tlsConfig := &amp;tls.Config{\n        RootCAs:            caCertPool,              //RootCAs\n        MinVersion:         tls.VersionTLS12,        //Support only TLS 1.2 or higher\n        Certificates:       []tls.Certificate{cert}, //Reject any TLS certificate that cannot be validated\n        InsecureSkipVerify: false,                   //Make sure we alway verify certificate\n    }\n    tlsConfig.BuildNameToCertificate()\n    transport := &amp;http.Transport{\n        TLSClientConfig: tlsConfig,\n        DialTLS: (&amp;net.Dialer{\n            Timeout: 30 * time.Second,\n        }).Dial,\n        TLSHandshakeTimeout: 30 * time.Second,\n        MaxIdleConns:        10,\n    }\n    return &amp;HTTPClient{\n        Client: &amp;http.Client{\n            Transport: transport,\n            Timeout:   time.Second * 10,\n        },\n    }\n}\n\nfunc main() {\n    url := \"https://35.184.226.101:443/test\"\n    req, err := http.NewRequest(\"GET\", url, nil)\n    if err != nil {\n        log.Println(\"Error while creating request for \", url)\n        return\n    }\n    resp, err := NewClient().Do(req)\n    response, err := httputil.DumpResponse(resp, true)\n    if err != nil {\n        log.Println(\"Error while dumping Request \", err)\n    }\n    log.Println(string(response))\n    /* Output\n        018/12/03 19:19:38 Setting up TLS configuration\n    2018/12/03 19:19:38 HTTP/1.1 400\n    Connection: close\n    Content-Type: text/plain;charset=ISO-8859-1\n\n    Bad Request\n    This combination of host and port requires TLS.\n    */\n\n}\n</code></pre>\n\n<p>Any thought where is the issue. Also how I can enable extra tracing so that we can get more information.</p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543842583, "post_id": 53594345, "comment_id": 94051460, "body": "There are o globals in the example code. Can you explain what exactly you do not understand about this code, especially the errgoup stuff (the rest is just for demonstration)."}, {"owner": {"reputation": 21, "user_id": 5487705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4f6bf13e2bf5c4bfb1046e79d032996?s=128&d=identicon&r=PG&f=1", "display_name": "user5487705", "link": "https://stackoverflow.com/users/5487705/user5487705"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543848324, "post_id": 53594345, "comment_id": 94054566, "body": "you mean the <b>results</b> is not a global variable? but it is manupulated in 3 routines created by  <b>g.Go</b>. I just wondering is there any thread safety problem here."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543849196, "post_id": 53594345, "comment_id": 94055131, "body": "Yes. The variable <code>results</code> is not global, it is local to the function <code>Google</code>. And it is  <b>not</b> manipulated by the goroutines. Really, it isn&#39;t. Because that <i>would</i> be a &quot;thread safety problem&quot;, i.e. it would be racy and thus wrong. The different goroutines each write to <b>their</b> <b>own</b> slice element <code>results[i]</code>. Each slice element is &quot;thing&quot; of it own and accessing different things concurrently is not racy (roughly)."}, {"owner": {"reputation": 21, "user_id": 5487705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4f6bf13e2bf5c4bfb1046e79d032996?s=128&d=identicon&r=PG&f=1", "display_name": "user5487705", "link": "https://stackoverflow.com/users/5487705/user5487705"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543850339, "post_id": 53594345, "comment_id": 94055850, "body": "Maybe each element in slice is not racy, but how to guarantees elements is visible in outer routine (or write in sub routines does not have a <i>happens before</i> relation with read in outer routine)? THX"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1543850687, "post_id": 53594345, "comment_id": 94056054, "body": "@user5487705, the main goroutine doesn&#39;t do anything with <code>results</code> before <code>g.Wait()</code> returns, and <code>g.Wait</code> doesn&#39;t return before all goroutines have finished executing (that&#39;s the whole point of the errgroup)."}, {"owner": {"reputation": 21, "user_id": 5487705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4f6bf13e2bf5c4bfb1046e79d032996?s=128&d=identicon&r=PG&f=1", "display_name": "user5487705", "link": "https://stackoverflow.com/users/5487705/user5487705"}, "edited": false, "score": 0, "creation_date": 1543851336, "post_id": 53594345, "comment_id": 94056459, "body": "Although <code>g.Wait()</code> returns until all goroutines finished, is there still any possiblity that the main routine does not get the correct result because of the existence of CPU cache or sth?  Thank you for your patience"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543852191, "post_id": 53594345, "comment_id": 94056981, "body": "No, absolutely not. The <i>whole</i> raison d&#39;&#234;tre of errgroup is to <i>prevent</i> such problems totally."}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1543850554, "creation_date": 1543850554, "answer_id": 53596716, "question_id": 53594345, "link": "https://stackoverflow.com/questions/53594345/golang-errgroup-example-without-channels/53596716#53596716", "title": "golang errgroup example without channels", "body": "<p>The intent here is to make <code>searches</code> and <code>results</code> congruent. The result for the <code>Web</code> search is always at <code>results[0]</code>, the result for the <code>Image</code> search always at <code>results[1]</code>, etc. It also makes for a simpler example, because there is no need for an additional goroutine that consumes a channel.</p>\n\n<p>If the goroutines would send their results into a channel, the result order would be unpredictable. If predictable result order is not a property you care about feel free to use a channel.</p>\n"}, {"tags": [], "owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "is_accepted": false, "score": 1, "last_activity_date": 1597611018, "creation_date": 1597611018, "answer_id": 63441807, "question_id": 53594345, "link": "https://stackoverflow.com/questions/53594345/golang-errgroup-example-without-channels/63441807#63441807", "title": "golang errgroup example without channels", "body": "<p>There is secret sauce in this code that creates siloing:</p>\n<pre><code>results := make([]Result, len(searches))\n           ^^^^           ^^^^^^^^^^^^^\n\nfor i, search := ... {\n    i, search := i, search\n          ^^^^^^^^^^\n    g.Go {\n        results[i] = result\n        ^^^^^^^^^^\n    }\n</code></pre>\n<p>We know how big the result set is going to be, so we pre-allocate all the slots before starting any goroutines. This eliminates any contention over the slice object itself</p>\n<pre><code>make(.., len(searches))\n^^^^     ^^^^^^^^^^^^^\n</code></pre>\n<p>We then promote the index number and search property to a closure for each iteration, so there is no contention over the variables being used by the loop/goroutines</p>\n<pre><code>    i, search := i, search\n</code></pre>\n<p>And finally, each worker operates on a singular slot in the pre-sized slice:</p>\n<pre><code>        results[i] = result\n</code></pre>\n<p>The workers are guaranteed to only perform read operations on the &quot;results&quot; slice to find out where their element is (<code>results[i]</code>).</p>\n<p>This particular pattern is limiting, you can't use the results until all the workers are completed. So ask yourself what you're going to do next when deciding whether to use this or a channels-based pipeline workflow.</p>\n<pre><code>results := getSearchResults(searches)\nstatistics := analyzeResults(results)\nfor stats := range statistics {\n    our.Write(&quot;{%s}\\n&quot;, stats.String())\n}\n</code></pre>\n<p>If the analysis of a given result is independent of any other, this is a good candidate for a channel-based workflow.</p>\n<p>But if the analysis depends on order, or has different results depending on each other then you may not have any choice but to serialize the flow.</p>\n"}], "owner": {"reputation": 21, "user_id": 5487705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4f6bf13e2bf5c4bfb1046e79d032996?s=128&d=identicon&r=PG&f=1", "display_name": "user5487705", "link": "https://stackoverflow.com/users/5487705/user5487705"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1321, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1597611018, "creation_date": 1543841844, "question_id": 53594345, "link": "https://stackoverflow.com/questions/53594345/golang-errgroup-example-without-channels", "title": "golang errgroup example without channels", "body": "<p>I saw the <a href=\"https://godoc.org/golang.org/x/sync/errgroup#example-Group--Parallel\" rel=\"nofollow noreferrer\">example</a> of errgroup in godoc, and it makes me confused that it simply assigns the result to global results instead of using channels in each search routines. Heres the code:</p>\n\n<pre><code>Google := func(ctx context.Context, query string) ([]Result, error) {\ng, ctx := errgroup.WithContext(ctx)\n\nsearches := []Search{Web, Image, Video}\nresults := make([]Result, len(searches))\nfor i, search := range searches {\n    i, search := i, search // https://golang.org/doc/faq#closures_and_goroutines\n    g.Go(func() error {\n        result, err := search(ctx, query)\n        if err == nil {\n            results[i] = result\n        }\n        return err\n    })\n}\nif err := g.Wait(); err != nil {\n    return nil, err\n}\nreturn results, nil\n</code></pre>\n\n<p>}</p>\n\n<p>I'm not sure is there any reason or implied rules guarantees it is correct? THX</p>\n"}, {"tags": ["go", "ssl", "tls1.2", "lets-encrypt"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543850940, "post_id": 53594106, "comment_id": 94056219, "body": "Looks like your clients don&#39;t support <a href=\"https://en.wikipedia.org/wiki/Server_Name_Indication\" rel=\"nofollow noreferrer\">SNI</a>. If you want to host multiple domains on the same IP:port pair, that&#39;s nothing you can fix on the server."}], "answers": [{"tags": [], "owner": {"reputation": 3906, "user_id": 624395, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/202bfd99f4900ed88a72e4c1721dbe95?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/624395/marco"}, "is_accepted": false, "score": 1, "last_activity_date": 1587475229, "last_edit_date": 1587475229, "creation_date": 1586936998, "answer_id": 61223820, "question_id": 53594106, "link": "https://stackoverflow.com/questions/53594106/golang-autocert-acme-autocert-missing-server-name/61223820#61223820", "title": "golang autocert acme/autocert: missing server name", "body": "<p>Maybe my blog will help you find a difference in your code vs the code I show in my blog.</p>\n\n<p><a href=\"https://marcofranssen.nl/build-a-go-webserver-on-http-2-using-letsencrypt/\" rel=\"nofollow noreferrer\">https://marcofranssen.nl/build-a-go-webserver-on-http-2-using-letsencrypt/</a></p>\n\n<p>Furthermore I figured out there is a much better library available to manage certificates via Letsencrypt.</p>\n\n<p><a href=\"https://marcofranssen.nl/use-the-acme-dns-challenge-to-get-a-tls-certificate/\" rel=\"nofollow noreferrer\">https://marcofranssen.nl/use-the-acme-dns-challenge-to-get-a-tls-certificate/</a></p>\n\n<p>In this second blog I utilize <a href=\"https://go-acme.github.io/lego/\" rel=\"nofollow noreferrer\">https://go-acme.github.io/lego/</a> which is supporting more of the ACME challenges. It ships with a cli, but can also be used as a lib in your webserver. In fact it is used in Traefik as well the Caddy webserver project.</p>\n\n<p>You also should <strong>NOT</strong> use the SNI challenge anymore as it is considered insecure. Instead use the ALPN challenge.</p>\n"}], "owner": {"reputation": 73, "user_id": 10557930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977752f5e6100750067425f288cade54?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo Boniot", "link": "https://stackoverflow.com/users/10557930/lorenzo-boniot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2021, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1587475229, "creation_date": 1543840988, "last_edit_date": 1586937097, "question_id": 53594106, "link": "https://stackoverflow.com/questions/53594106/golang-autocert-acme-autocert-missing-server-name", "title": "golang autocert acme/autocert: missing server name", "body": "<p>i use Library autocert in my application for generate ssl certificate, problem is 30% of users have problem with my application, my current code is :</p>\n\n<pre><code>fmt.Println(\"Starting server on \" + this.Params.Bind)\nif this.Params.SSL {\n    fmt.Println(\"SSL Enabled\")\n    m := autocert.Manager{\n        Prompt:     autocert.AcceptTOS,\n        HostPolicy: autocert.HostWhitelist(this.Params.HostsWhitelist...),\n        Cache:      autocert.DirCache(this.Params.CertCache),\n    }\n\n    log.Fatal(autotls.RunWithManager(r, &amp;m))\n} else {\n    r.Run(this.Params.Bind)\n}\n</code></pre>\n\n<p>the errors is :</p>\n\n<pre><code>2018/12/03 12:37:33 http: TLS handshake error from 68.71.48.249:55885: acme/autocert: missing server name\n2018/12/03 12:37:33 http: TLS handshake error from 209.213.121.223:38284: acme/autocert: missing server name\n2018/12/03 12:37:33 http: TLS handshake error from 209.213.121.223:38283: acme/autocert: missing server name\n2018/12/03 12:37:33 http: TLS handshake error from 68.71.48.249:55887: acme/autocert: missing server name\n2018/12/03 12:37:33 http: TLS handshake error from 68.71.48.249:55888: acme/autocert: missing server name\n2018/12/03 12:37:33 http: TLS handshake error from 209.237.150.145:56842: acme/autocert: missing server name\n</code></pre>\n\n<p>how i can fix error missing server name ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "edited": false, "score": 0, "creation_date": 1543839988, "post_id": 53593722, "comment_id": 94050080, "body": "It&#39;s a random number with constraints ... like the number of digit ... Not a random string in an array ... Ant no zero in the first post."}], "answers": [{"tags": [], "owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "is_accepted": false, "score": 1, "last_activity_date": 1543839854, "creation_date": 1543839854, "answer_id": 53593816, "question_id": 53593722, "link": "https://stackoverflow.com/questions/53593722/generate-string-number-for-invitation-code/53593816#53593816", "title": "Generate string number for invitation code", "body": "<p>You can do something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\nfunc init() {\n    rand.Seed(time.Now().UnixNano())\n}\n\nvar numbers = []rune(\"0123456789\")\n\nfunc GenerateNumberString(length int) string {\n    b := make([]rune, length)\n    for i := range b {\n        b[i] = numbers[rand.Intn(len(numbers))]\n    }\n    return string(b)\n}\n\nfunc main() {\n    fmt.Println(GenerateNumberString(2))\n    fmt.Println(GenerateNumberString(3))\n    fmt.Println(GenerateNumberString(4))\n}\n</code></pre>\n\n<p>Try it <a href=\"https://goplay.space/#8JCLzAHmxjm\" rel=\"nofollow noreferrer\">here</a> in the go playground.</p>\n"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "closed_date": 1543839849, "answer_count": 1, "score": -2, "last_activity_date": 1543839854, "creation_date": 1543839462, "question_id": 53593722, "link": "https://stackoverflow.com/questions/53593722/generate-string-number-for-invitation-code", "closed_reason": "Duplicate", "title": "Generate string number for invitation code", "body": "<p>I would like to generate number for invitation code.</p>\n\n<p>I get a number of digit for this and i need to generate a string number according to this digit.</p>\n\n<p>Example :\nFor 3 i need to generate a string number beetween 111 and 999\nfor 4 1111 to 9999\nfor 2 11 to 99\netc...</p>\n\n<p>What is the best way to do that ?</p>\n\n<p>I have some idea like making two empty string filling them with 1 for the first one according to x, with 9 for the second one according to X.</p>\n\n<p>Then converting them to int and make a random between these two number, but i don't thik it's the optimal way to do it.</p>\n\n<pre><code>package main\n\n    import (\n        \"fmt\"\n        \"math/rand\"\n        \"strconv\"\n        \"time\"\n    )\n\n    func randInt(min int, max int) int {\n        return min + rand.Intn(max-min)\n    }\n    func main() {\n        x := 3\n        first := \"\"\n        second := \"\"\n        i := 0\n\n        for i &lt; x {\n            first = first + \"1\"\n            i = i + 1\n        }\n        i = 0\n        for i &lt; x {\n            second = second + \"9\"\n            i = i + 1\n        }\n        rand.Seed(time.Now().UTC().UnixNano())\n        fmt.Println(first)\n        fmt.Println(second)\n        firstInt, _ := strconv.Atoi(first)\n        secondInt, _ := strconv.Atoi(second)\n        fmt.Println(randInt(firstInt, secondInt))\n    }\n</code></pre>\n\n<p>regards</p>\n"}, {"tags": ["go", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": true, "score": 5, "last_activity_date": 1543850541, "creation_date": 1543850541, "answer_id": 53596711, "question_id": 53593618, "link": "https://stackoverflow.com/questions/53593618/how-to-implement-case-insensitive-url-matching-using-gorilla-mux/53596711#53596711", "title": "How to implement case insensitive URL matching using gorilla mux", "body": "<p>Unfortunately, as of this writing, middleware functions are invoked <strong>after</strong> URL matching in <code>gorilla/mux</code>.</p>\n\n<blockquote>\n  <p>Mux supports the addition of middlewares to a Router, which are executed in the order they are added if a match is found, including its subrouters.</p>\n</blockquote>\n\n<p>I would suggest going with the example in the link you provided.</p>\n\n<p>e.g.</p>\n\n<pre><code>func CaselessMatcher(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        r.URL.Path = strings.ToLower(r.URL.Path)\n        next.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n\n<p>Then, just wrap your multiplexer.</p>\n\n<pre><code>r := mux.NewRouter()\n//...\nhandler := CaselessMatcher(r)\n</code></pre>\n\n<p>It's actually not bad IMO.</p>\n"}], "owner": {"reputation": 447, "user_id": 2487737, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d038802ec4b2dc32d1d674bff8474f78?s=128&d=identicon&r=PG", "display_name": "Prashanth", "link": "https://stackoverflow.com/users/2487737/prashanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 1, "accepted_answer_id": 53596711, "answer_count": 1, "score": 2, "last_activity_date": 1543850541, "creation_date": 1543839059, "last_edit_date": 1543840787, "question_id": 53593618, "link": "https://stackoverflow.com/questions/53593618/how-to-implement-case-insensitive-url-matching-using-gorilla-mux", "title": "How to implement case insensitive URL matching using gorilla mux", "body": "<p>I need to implement case insensitive URL matching in gorilla mux as <a href=\"https://grokbase.com/p/gg/golang-nuts/1337v1v6r7/go-nuts-http-handlefunc-case-insensitive-path-match-default-match\" rel=\"nofollow noreferrer\">it is done here for built in mux</a></p>\n\n<p>I tried to achieve the same using middle-ware like this</p>\n\n<pre><code>router := mux.NewRouter()\nrouter.Use(srv.GetCaseMiddleware())\n\n//GetCaseMiddleware middleware to make match URL case insensitive\nfunc (srv *Server) GetCaseMiddleware() (w mux.MiddlewareFunc) {\n    var middleware mux.MiddlewareFunc = func(next http.Handler) http.Handler {\n        return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n            r.URL.Path = strings.ToLower(r.URL.Path)\n            next.ServeHTTP(w, r)\n        })\n    }\n    return middleware\n}\n</code></pre>\n\n<p>but still it throws 404 if URL case is changed,is there any way to implement it using gorilla-mux</p>\n"}, {"tags": ["go", "belongs-to", "go-gorm"], "owner": {"reputation": 453, "user_id": 5223883, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/3893ce5dee9a28b6246c3b742fcd97d7?s=128&d=identicon&r=PG&f=1", "display_name": "Khorwin", "link": "https://stackoverflow.com/users/5223883/khorwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1543835371, "creation_date": 1543835371, "question_id": 53592574, "link": "https://stackoverflow.com/questions/53592574/belongto-self-in-gorm", "title": "belongTo self in gorm", "body": "<p>I'm trying to establish a belongsTo relationship on the same table. But I'm unable to succeed. I didn't find any easily understandable examples on the Internet.</p>\n\n<pre><code>type Role struct {\n    gorm.Model\n\n    Name string\n    Description string\n    Inclusive bool\n\n    Controller *Role `gorm:\"foreignkey:controller;association_foreignkey:id\"`\n    SupervisedRoles []*Role `gorm:\"foreignkey:Controller\"`\n    Permissions []*Permission\n}\n\nfunc (r *Role) GetController() (*Role, error) {\n    controller := &amp;Role{}\n    return controller, db.DB.Model(r).Related(controller).Error\n}\n\nfunc (r *Role) GetSupervisedRoles() ([]*Role, error) {\n    roles := []*Role{}\n\n    return roles, db.DB.Model(r).Related(roles).Error\n}\n</code></pre>\n\n<p>In my table, the \"controller\" field is a nullable foreign key that refers to another occurance of my \"roles\" table.</p>\n\n<p>How do I implement it using GORM ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1543831283, "post_id": 53590691, "comment_id": 94045631, "body": "Read Alias declaration under <a href=\"https://golang.org/ref/spec#Type_declarations\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Type_declarations</a>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "edited": false, "score": 0, "creation_date": 1543834049, "post_id": 53590759, "comment_id": 94046971, "body": "yeah it&#39;s a type alias, but weird that it would let you &quot;alias&quot; something that hasn&#39;t already been declared, if you follow."}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1543834215, "post_id": 53590759, "comment_id": 94047061, "body": "@OlegzandrDenman I think we can use this term: an alias of anonymous struct"}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 4, "last_activity_date": 1543843456, "last_edit_date": 1543843456, "creation_date": 1543829193, "answer_id": 53590759, "question_id": 53590691, "link": "https://stackoverflow.com/questions/53590691/syntactic-semantic-difference-between-struct-declaration-styles/53590759#53590759", "title": "Syntactic/semantic difference between struct declaration styles", "body": "<p>The 2nd one, it's an example of struct declaration.</p>\n\n<pre><code>type Foo struct {\n    F string `zoom:\"1\"`\n}\n</code></pre>\n\n<hr>\n\n<p>And the 1st one, it is usage example of go1.9 new feature: <a href=\"https://golang.org/doc/go1.9#language\" rel=\"nofollow noreferrer\">type aliases</a>. </p>\n\n<p>A new type <code>Foo</code> is created. It's an alias of an anonymous struct.</p>\n\n<pre><code>type Foo = struct {\n    F string `zoom:\"1\"`\n}\n</code></pre>\n\n<p>The type aliases syntax can be used to define a struct. In example above, it's generating an equivalent result like <code>type Foo struct</code>. </p>\n\n<p>But, the original purpose of type alias is to make an alias from defined type. </p>\n\n<p>In example below, a new type called <code>Bar</code> is created and it's an alias of <code>Foo</code> struct.</p>\n\n<pre><code>type Foo struct {\n    F string `zoom:\"1\"`\n}\ntype Bar = Foo\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 53590759, "answer_count": 1, "score": 0, "last_activity_date": 1543843456, "creation_date": 1543828912, "question_id": 53590691, "link": "https://stackoverflow.com/questions/53590691/syntactic-semantic-difference-between-struct-declaration-styles", "title": "Syntactic/semantic difference between struct declaration styles", "body": "<p>Any difference between these two declarations?</p>\n\n<pre><code>type Foo = struct {\n    F string `zoom:\"1\"`\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>type Foo struct {\n    F string `zoom:\"1\"`\n}\n</code></pre>\n\n<p>they both compile and seem to work the same.</p>\n"}, {"tags": ["php", "go", "thrift"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543824817, "post_id": 53589452, "comment_id": 94042632, "body": "<code>err.Error() != &quot;&quot;</code> is invalid if there is no error. Write <code>err != nil</code> instead."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543825343, "post_id": 53589452, "comment_id": 94042816, "body": "Also, don&#39;t use an empty Context. Instead of <code>new(context.Context)</code> use one of the constructors <code>context.Background</code> or <code>context.TODO</code>, or use the request context <code>c</code> directly."}, {"owner": {"reputation": 13, "user_id": 7602046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c09b5fcc188e13a4d25eb75f4d81930?s=128&d=identicon&r=PG&f=1", "display_name": "zhuocr", "link": "https://stackoverflow.com/users/7602046/zhuocr"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543826184, "post_id": 53589452, "comment_id": 94043207, "body": "ok, i change it , but result is still error"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543826485, "post_id": 53589452, "comment_id": 94043345, "body": "If you don&#39;t call <code>err.Error</code> anymore you can&#39;t possibly have the same stack trace."}, {"owner": {"reputation": 13, "user_id": 7602046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c09b5fcc188e13a4d25eb75f4d81930?s=128&d=identicon&r=PG&f=1", "display_name": "zhuocr", "link": "https://stackoverflow.com/users/7602046/zhuocr"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543826749, "post_id": 53589452, "comment_id": 94043453, "body": "ok , it is my mistake"}, {"owner": {"reputation": 13, "user_id": 7602046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c09b5fcc188e13a4d25eb75f4d81930?s=128&d=identicon&r=PG&f=1", "display_name": "zhuocr", "link": "https://stackoverflow.com/users/7602046/zhuocr"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543826917, "post_id": 53589452, "comment_id": 94043519, "body": "i have changed the question"}, {"owner": {"reputation": 12067, "user_id": 499466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc0612ec9a2b6af96500cc6e4bfdc7c?s=128&d=identicon&r=PG", "display_name": "JensG", "link": "https://stackoverflow.com/users/499466/jensg"}, "edited": false, "score": 0, "creation_date": 1544023174, "post_id": 53589452, "comment_id": 94130552, "body": "I would recommend to study the example under <a href=\"https://github.com/apache/thrift/tree/master/test/go\" rel=\"nofollow noreferrer\">/test/go</a> in the Thrift repo to get an idea, how it really works. I never used that gin framework, but I can hardly imagine that the call to <code>Process()</code> is correct."}], "owner": {"reputation": 13, "user_id": 7602046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c09b5fcc188e13a4d25eb75f4d81930?s=128&d=identicon&r=PG&f=1", "display_name": "zhuocr", "link": "https://stackoverflow.com/users/7602046/zhuocr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543826900, "creation_date": 1543823165, "last_edit_date": 1543826900, "question_id": 53589452, "link": "https://stackoverflow.com/questions/53589452/apache-thrift-err-in-php-client-and-golang-server", "title": "Apache thrift err in PHP Client and Golang Server", "body": "<p>when i use Apache Thrift PHP client and PHP server is OK, but When I use Golang as Server, is not OK, I find nothing in the internet that about Golang thrift use Http mode,The document only show the usage about socket mode in Golang,so i need help.</p>\n\n<p>php server code(use laravel5.2, thrift 0.11.0):</p>\n\n<pre><code>    try{\n\n       header('Content-Type', 'application/x-thrift');\n\n        $dokuHandler = new DokuService();\n\n        $multiplexedProcessor = new TMultiplexedProcessor();\n\n        // \u521b\u5efa\u591a\u4e2a\u670d\u52a1Processor\n        $dokuProcessor = new DokuServiceProcessor($dokuHandler);\n\n        // \u5c06\u670d\u52a1\u6ce8\u518c\u5230TMultiplexedProcessor\u4e2d\n        $multiplexedProcessor-&gt;registerProcessor(\"doku\", $dokuProcessor);\n\n        // \u521d\u59cb\u5316\u6570\u636e\u4f20\u8f93\u65b9\u5f0ftransport\n        $transport = new TBufferedTransport(new TPhpStream(TPhpStream::MODE_R | TPhpStream::MODE_W));\n        // \u5229\u7528\u8be5\u4f20\u8f93\u65b9\u5f0f\u521d\u59cb\u5316\u6570\u636e\u4f20\u8f93\u683c\u5f0fprotocol\n        $protocol = new TBinaryProtocol($transport, true, true);\n\n        // \u5f00\u59cb\u670d\u52a1\n        $transport-&gt;open();\n        $multiplexedProcessor-&gt;process($protocol, $protocol);\n    } catch (\\TException $exception) {\n        Log::error(\"DokuService handleRequest\", [\n            'request' =&gt; $request,\n            'exMsg' =&gt; $exception-&gt;getMessage(),\n            'exStack' =&gt; $exception-&gt;getTraceAsString(),\n        ]);\n    } finally {\n        if ($transport) {\n            $transport-&gt;close();\n        }\n    }\n</code></pre>\n\n<p>php client code:</p>\n\n<pre><code>public function __construct()\n{\n    $this-&gt;transport = null;\n    try {\n        $uri = '/rpc/outgo/server';\n        $serviceName = 'outgo';\n\n        $host = self::getHost();\n        $port = self::getPort();\n\n        $socket = new THttpClient($host, $port, $uri);\n        $this-&gt;transport = new TBufferedTransport($socket, 1024, 1024);\n        $protocol = new TBinaryProtocol($this-&gt;transport);\n        $this-&gt;multiplexedProtocol = new TMultiplexedProtocol($protocol, $serviceName);\n        parent::__construct($this-&gt;multiplexedProtocol);\n    } catch (\\Exception $e) {\n        Log::error('construct OutgoRpcClient error', [\n            'host' =&gt; $host,\n            'port' =&gt; $port,\n            'serviceName' =&gt; $serviceName,\n            'ex_msg' =&gt; $e-&gt;getMessage(),\n            'ex_trace' =&gt; $e-&gt;getTraceAsString(),\n        ]);\n    }\n}\n</code></pre>\n\n<p>golang server code(go1.10.3, gin framework,):</p>\n\n<pre><code>func RpcReceive(c *gin.Context) {\n//defer func() {\n//  if err := recover(); err != nil {\n//      config.LogRecord.WithFields(logrus.Fields{\"error\": \nerr}).Error(\"rpc worker error\")\n//  }\n//}()\n\nvar transport thrift.TTransport\n\nnewTransport, err := \nthrift.NewTBufferedTransportFactory(10).GetTransport(transport)\nif err != nil {\n    panic(\"new transport error\")\n}\n\nprotocol := \nthrift.NewTBinaryProtocolFactoryDefault().GetProtocol(newTransport)\n\norderProcessor := \norderservice.NewOrderServiceProcessor(new(orderService))\n\nOrderServiceName := \"outgo\"\nmultiProcessor := thrift.NewTMultiplexedProcessor()\nmultiProcessor.RegisterProcessor(OrderServiceName, orderProcessor)\n\nnewTransport.Open()\nmultiProcessor.Process(c, protocol, protocol)\n//newTransport.Close()\n\n}\n</code></pre>\n\n<p>golang err:</p>\n\n<pre><code>   runtime error: invalid memory address or nil pointer dereference\n/usr/local/opt/go/libexec/src/runtime/panic.go:502 (0x102ad08)\n        gopanic: reflectcall(nil, unsafe.Pointer(d.fn), deferArgs(d), uint32(d.siz), uint32(d.siz))\n/usr/local/opt/go/libexec/src/runtime/panic.go:63 (0x1029d7d)\n        panicmem: panic(memoryError)\n/usr/local/opt/go/libexec/src/runtime/signal_unix.go:388 (0x1040279)\n        sigpanic: panicmem()\n/usr/local/var/www/go/src/github.com/rule-engine/rule-engine/vendor/git.apache.org/thrift.git/lib/go/thrift/buffered_transport.go:58 (0x18c180a)\n        (*TBufferedTransport).Open: return p.tp.Open()\n/usr/local/var/www/go/src/github.com/rule-engine/rule-engine/app/http/controller/rpc/receiveBusiness.go:86 (0x18ce4cf)\n        RpcReceive: newTransport.Open()\n/usr/local/var/www/go/src/github.com/rule-engine/rule-engine/vendor/github.com/gin-gonic/gin/context.go:104 (0x1537b42)\n        (*Context).Next: c.handlers[c.index](c)\n/usr/local/var/www/go/src/github.com/rule-engine/rule-engine/app/http/middleware/catchPanic.go:41 (0x16b2e20)\n        RecoveryWithWriter.func1: c.Next()\n/usr/local/var/www/go/src/github.com/rule-engine/rule-engine/vendor/github.com/gin-gonic/gin/context.go:104 (0x1537b42)\n        (*Context).Next: c.handlers[c.index](c)\n/usr/local/var/www/go/src/github.com/rule-engine/rule-engine/app/http/middleware/commonMw.go:16 (0x16b40a4)\n        Logger.func1: c.Next()\n/usr/local/var/www/go/src/github.com/rule-engine/rule-engine/vendor/github.com/gin-gonic/gin/context.go:104 (0x1537b42)\n        (*Context).Next: c.handlers[c.index](c)\n/usr/local/var/www/go/src/github.com/rule-engine/rule-engine/vendor/github.com/gin-gonic/gin/gin.go:332 (0x153ebe4)\n        (*Engine).handleHTTPRequest: context.Next()\n/usr/local/var/www/go/src/github.com/rule-engine/rule-engine/vendor/github.com/gin-gonic/gin/gin.go:296 (0x153e432)\n        (*Engine).ServeHTTP: engine.handleHTTPRequest(c)\n/usr/local/opt/go/libexec/src/net/http/server.go:2694 (0x128093b)\n        serverHandler.ServeHTTP: handler.ServeHTTP(rw, req)\n/usr/local/opt/go/libexec/src/net/http/server.go:1830 (0x127caf0)\n        (*conn).serve: serverHandler{c.server}.ServeHTTP(w, w.req)\n/usr/local/opt/go/libexec/src/runtime/asm_amd64.s:2361 (0x1057030)\n        goexit: BYTE    $0x90   // NOP\n] &lt;nil&gt;}\ngoroutine 33 [running]:\nnet/http.(*conn).serve.func1(0xc4202da000)\n        /usr/local/opt/go/libexec/src/net/http/server.go:1726 +0xd0\npanic(0x1b06940, 0xc42033e5a0)\n        /usr/local/opt/go/libexec/src/runtime/panic.go:502 +0x229\ngithub.com/rule-engine/rule-engine/vendor/github.com/sirupsen/logrus.Entry.log(0xc4200d52c0, 0xc4202f4630, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n        /usr/local/var/www/go/src/github.com/rule-engine/rule-engine/vendor/github.com/sirupsen/logrus/entry.go:126 +0x2d2\ngithub.com/rule-engine/rule-engine/vendor/github.com/sirupsen/logrus.(*Entry).Panic(0xc42033e410, 0xc42056b640, 0x1, 0x1)\n        /usr/local/var/www/go/src/github.com/rule-engine/rule-engine/vendor/github.com/sirupsen/logrus/entry.go:194 +0xaa\ngithub.com/rule-engine/rule-engine/vendor/github.com/sirupsen/logrus.(*Logger).Panic(0xc4200d52c0, 0xc42056b640, 0x1, 0x1)\n        /usr/local/var/www/go/src/github.com/rule-engine/rule-engine/vendor/github.com/sirupsen/logrus/logger.go:244 +0x6d\ngithub.com/rule-engine/rule-engine/app/http/middleware.RecoveryWithWriter.func1.1(0xc42037e580)\n        /usr/local/var/www/go/src/github.com/rule-engine/rule-engine/app/http/middleware/catchPanic.go:35 +0x46b\npanic(0x19db200, 0x21320b0)\n        /usr/local/opt/go/libexec/src/runtime/panic.go:502 +0x229\ngithub.com/rule-engine/rule-engine/vendor/git.apache.org/thrift.git/lib/go/thrift.(*TBufferedTransport).Open(0xc420248080, 0xc4202f4510, 0x1b241cf)\n        /usr/local/var/www/go/src/github.com/rule-engine/rule-engine/vendor/git.apache.org/thrift.git/lib/go/thrift/buffered_transport.go:58 +0x2a\ngithub.com/rule-engine/rule-engine/app/http/controller/rpc.RpcReceive(0xc42037e580)\n        /usr/local/var/www/go/src/github.com/rule-engine/rule-engine/app/http/controller/rpc/receiveBusiness.go:86 +0x370\ngithub.com/rule-engine/rule-engine/vendor/github.com/gin-gonic/gin.(*Context).Next(0xc42037e580)\n        /usr/local/var/www/go/src/github.com/rule-engine/rule-engine/vendor/github.com/gin-gonic/gin/context.go:104 +0x43\ngithub.com/rule-engine/rule-engine/app/http/middleware.RecoveryWithWriter.func1(0xc42037e580)\n        /usr/local/var/www/go/src/github.com/rule-engine/rule-engine/app/http/middleware/catchPanic.go:41 +0x51\ngithub.com/rule-engine/rule-engine/vendor/github.com/gin-gonic/gin.(*Context).Next(0xc42037e580)\n        /usr/local/var/www/go/src/github.com/rule-engine/rule-engine/vendor/github.com/gin-gonic/gin/context.go:104 +0x43\ngithub.com/rule-engine/rule-engine/app/http/middleware.Logger.func1(0xc42037e580)\n        /usr/local/var/www/go/src/github.com/rule-engine/rule-engine/app/http/middleware/commonMw.go:16 +0x85\ngithub.com/rule-engine/rule-engine/vendor/github.com/gin-gonic/gin.(*Context).Next(0xc42037e580)\n        /usr/local/var/www/go/src/github.com/rule-engine/rule-engine/vendor/github.com/gin-gonic/gin/context.go:104 +0x43\ngithub.com/rule-engine/rule-engine/vendor/github.com/gin-gonic/gin.(*Engine).handleHTTPRequest(0xc4200dc6c0, 0xc42037e580)\n        /usr/local/var/www/go/src/github.com/rule-engine/rule-engine/vendor/github.com/gin-gonic/gin/gin.go:332 +0x585\ngithub.com/rule-engine/rule-engine/vendor/github.com/gin-gonic/gin.(*Engine).ServeHTTP(0xc4200dc6c0, 0x1c29ae0, 0xc42038c000, 0xc42015a000)\n        /usr/local/var/www/go/src/github.com/rule-engine/rule-engine/vendor/github.com/gin-gonic/gin/gin.go:296 +0x153\nnet/http.serverHandler.ServeHTTP(0xc4200dc7e0, 0x1c29ae0, 0xc42038c000, 0xc42015a000)\n        /usr/local/opt/go/libexec/src/net/http/server.go:2694 +0xbc\nnet/http.(*conn).serve(0xc4202da000, 0x1c2a860, 0xc4201da4c0)\n        /usr/local/opt/go/libexec/src/net/http/server.go:1830 +0x651\ncreated by net/http.(*Server).Serve\n        /usr/local/opt/go/libexec/src/net/http/server.go:2795 +0x27b\n</code></pre>\n\n<p>I refer php server to write golang server code.</p>\n"}, {"tags": ["go", "vendor", "go-modules"], "comments": [{"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1543823618, "post_id": 53588764, "comment_id": 94042184, "body": "Did you try <code>go mod vendor</code>?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543825934, "post_id": 53588764, "comment_id": 94043078, "body": "What is a &quot;local package&quot;? All packages are equal."}, {"owner": {"reputation": 51, "user_id": 3970390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BMkVz.gif?s=128&g=1", "display_name": "yanyandenuonuo", "link": "https://stackoverflow.com/users/3970390/yanyandenuonuo"}, "reply_to_user": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1543844806, "post_id": 53588764, "comment_id": 94052621, "body": "@ttomalak if i didn&#39;t execute <code>go mod vendor</code>, it wouldn&#39;t create the vendor folder."}, {"owner": {"reputation": 51, "user_id": 3970390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BMkVz.gif?s=128&g=1", "display_name": "yanyandenuonuo", "link": "https://stackoverflow.com/users/3970390/yanyandenuonuo"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543844963, "post_id": 53588764, "comment_id": 94052701, "body": "@Volker I means the package in my private repo which not support https both and need auth. So the only way is that i git clone use ssh than i copy the package to vendor. Such as vendor/xxx.com/xxx/xx."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543849956, "post_id": 53588764, "comment_id": 94055649, "body": "Okay, got that. But I still do not understand the problem. Can you describe the problem more clearly?"}, {"owner": {"reputation": 51, "user_id": 3970390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BMkVz.gif?s=128&g=1", "display_name": "yanyandenuonuo", "link": "https://stackoverflow.com/users/3970390/yanyandenuonuo"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543904113, "post_id": 53588764, "comment_id": 94075225, "body": "@Volker I had append my description."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 3970390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BMkVz.gif?s=128&g=1", "display_name": "yanyandenuonuo", "link": "https://stackoverflow.com/users/3970390/yanyandenuonuo"}, "edited": false, "score": 0, "creation_date": 1543906679, "post_id": 53606881, "comment_id": 94076140, "body": "I had read the modules wiki, and i known i can copy <b>privaterepo.com/bb/bb</b> to outside vendor folder, also if i do this i won&#39;t need to add <code>replace privaterepo.com&#47;bb&#47;bb =&gt; ..&#47;bb</code>  in the go.mod.  But what&#39;s the mean of <code>exclude</code>, when should i use <code>exclude</code>?  I prefer manager my private repo in vendor just like other public repo."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 51, "user_id": 3970390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BMkVz.gif?s=128&g=1", "display_name": "yanyandenuonuo", "link": "https://stackoverflow.com/users/3970390/yanyandenuonuo"}, "edited": false, "score": 0, "creation_date": 1543908492, "post_id": 53606881, "comment_id": 94076889, "body": "@yanyandenuonuo <code>exclude</code> is for excluding a specific <i>version</i> of a module if you know that this version is broken/doesn&#39;t work with our code. IN this case you can mark this version as excluded an go will not select this version during version selection. For the second part: If you manage your build with modules and <code>go mod</code> than you must adopt your workflow to go mod."}, {"owner": {"reputation": 51, "user_id": 3970390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BMkVz.gif?s=128&g=1", "display_name": "yanyandenuonuo", "link": "https://stackoverflow.com/users/3970390/yanyandenuonuo"}, "edited": false, "score": 0, "creation_date": 1543913371, "post_id": 53606881, "comment_id": 94079039, "body": "May be i should ask the question at golang issue. I don&#39;t think <code>exclude</code> is for excluding a specific version because <code>require</code> already declare the version. Anyway, thank you so much for your answer."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 51, "user_id": 3970390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BMkVz.gif?s=128&g=1", "display_name": "yanyandenuonuo", "link": "https://stackoverflow.com/users/3970390/yanyandenuonuo"}, "edited": false, "score": 0, "creation_date": 1543915312, "post_id": 53606881, "comment_id": 94080109, "body": "@yanyandenuonuo exclude is for excluding a single version from the set of possibles and require is to select a single fixed version. Have a second look at the documentation if unsure."}, {"owner": {"reputation": 51, "user_id": 3970390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BMkVz.gif?s=128&g=1", "display_name": "yanyandenuonuo", "link": "https://stackoverflow.com/users/3970390/yanyandenuonuo"}, "edited": false, "score": 0, "creation_date": 1544099403, "post_id": 53606881, "comment_id": 94161011, "body": "Got it, but i don&#39;t think this is right things about <code>exclude</code> and i had create a issue about this. Thank you once again."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 7, "last_activity_date": 1543904793, "last_edit_date": 1592644375, "creation_date": 1543904793, "answer_id": 53606881, "question_id": 53588764, "link": "https://stackoverflow.com/questions/53588764/how-to-add-local-dependency-to-vendor-when-using-go-mod/53606881#53606881", "title": "How to add local dependency to vendor when using go mod", "body": "<blockquote>\n<p>So, what should I do to add local package to vendor and avoid go mod remove it?</p>\n</blockquote>\n<p>Well, I think you cannot do this. This is not how it works. <code>go mod vendor</code> <em>manages</em> your vendor folder.</p>\n<p>Instead of <code>exclude</code>ing you package from go.mod you should add a <code>replace</code> directive to instruct the go tool to look up the package not from privaterepo.com but from the local filesystem. Quoting from <a href=\"https://github.com/golang/go/wiki/Modules#when-should-i-use-the-replace-directive\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/Modules#when-should-i-use-the-replace-directive</a></p>\n<blockquote>\n<p>replace also can be used to inform the go tooling of the relative or absolute on-disk location of modules in a multi-module project, such as:</p>\n<pre><code>   replace example.com/project/foo =&gt; ../foo\n</code></pre>\n</blockquote>\n<p>So in your case: Do not try to manually put privaterepo.com/bb/bb in vendor, but have it somewhere outside the current project and use</p>\n<pre><code>replace privaterepo.com/bb/bb =&gt; ../bb\n</code></pre>\n<p>And let <code>go mod</code> copy this stuff from the filesystem to your vendor.</p>\n"}], "owner": {"reputation": 51, "user_id": 3970390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BMkVz.gif?s=128&g=1", "display_name": "yanyandenuonuo", "link": "https://stackoverflow.com/users/3970390/yanyandenuonuo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13585, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1614087448, "creation_date": 1543819696, "last_edit_date": 1614087448, "question_id": 53588764, "link": "https://stackoverflow.com/questions/53588764/how-to-add-local-dependency-to-vendor-when-using-go-mod", "title": "How to add local dependency to vendor when using go mod", "body": "<p>Before I used <code>go dep</code>, but now office ensure the official tool is <code>go mod</code>.</p>\n\n<p>When I use <code>go dep</code>, I can add local dependency packages to vendor and <strong><code>ignored</code></strong> in <code>Gopkg.toml</code> to ignore search the package from repo. I can execute <code>go dep update</code> normally.</p>\n\n<p>Now I use <code>go mod</code>, I also add local dependence package to vendor and add it <code>exclude</code> in <code>go.mod</code>. But when i execute <code>go mod tidy</code>, it remove the package even though my project exist <code>import xxx</code>.</p>\n\n<p>What did i do:</p>\n\n<ol>\n<li>create new project</li>\n<li>execute go mod init</li>\n<li><p>modify go.mod <strong><code>exclude privaterepo.com/bb/bb</code></strong></p></li>\n<li><p>copy my local module to vendor because the local module is on a private repo which not support https.</p></li>\n<li>now the vendor just like:\n\n<blockquote>\n  <p><code>vendor\n  |-github.com/aa/aa\n  |-privaterepo.com/bb/bb</code></p>\n</blockquote></li>\n<li>import \"privaterepo.com/bb/bb\"</li>\n<li>execute go build -mod vendor</li>\n<li>than i got error <strong>\"cannot find module for path privaterepo.com/bb/bb\"</strong>\n9 always try with replace, but it also not work</li>\n</ol>\n\n<p>So, what should I do to add <strong>local package</strong> to vendor and avoid <code>go mod</code> remove it?</p>\n"}, {"tags": ["go", "cross-platform", "cross-compiling"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1543826113, "post_id": 53588470, "comment_id": 94043166, "body": "Running <code>go build</code> does not crosscompile. You should do a <code>GOARCH=amd64 go build ...</code> to cross compile. TO crosscompile plain Go code all you need is part of your Go installation. If a package needs special C libraries: Consult that package&#39;s documentation."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543827375, "post_id": 53588470, "comment_id": 94043709, "body": "As Volker said, the official Go SDK is capable to cross-compile to the supported OS and architecture combinations without the need of additional files and tools. Whether a 3rd-party package has everything it needs is another question."}, {"owner": {"reputation": 19, "user_id": 7534405, "user_type": "registered", "profile_image": "https://graph.facebook.com/672123036300792/picture?type=large", "display_name": "Mayur Wadekar", "link": "https://stackoverflow.com/users/7534405/mayur-wadekar"}, "edited": false, "score": 0, "creation_date": 1543830362, "post_id": 53588470, "comment_id": 94045185, "body": "command to compile cross environment that <code>env GOOS=linux GOARCH=arm64 go build</code> still it giving error as I&#39;ve mention. I&#39;m really not getting what error actually is :("}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7534405, "user_type": "registered", "profile_image": "https://graph.facebook.com/672123036300792/picture?type=large", "display_name": "Mayur Wadekar", "link": "https://stackoverflow.com/users/7534405/mayur-wadekar"}, "edited": false, "score": 0, "creation_date": 1543830153, "post_id": 53590089, "comment_id": 94045079, "body": "Already done it...Still got issue so that&#39;s why I posted question to get additional info about cross compilation"}], "tags": [], "owner": {"reputation": 506, "user_id": 7342859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A2yso.png?s=128&g=1", "display_name": "Shadowchaser", "link": "https://stackoverflow.com/users/7342859/shadowchaser"}, "is_accepted": false, "score": 0, "last_activity_date": 1543826256, "creation_date": 1543826256, "answer_id": 53590089, "question_id": 53588470, "link": "https://stackoverflow.com/questions/53588470/how-to-cross-compile/53590089#53590089", "title": "How to cross compile", "body": "<p>Try setting environmental variable as follows. You may need to go get your external dependencies first after that, before you'll go build.\n    GOARCH = \"arm64\"</p>\n"}], "owner": {"reputation": 19, "user_id": 7534405, "user_type": "registered", "profile_image": "https://graph.facebook.com/672123036300792/picture?type=large", "display_name": "Mayur Wadekar", "link": "https://stackoverflow.com/users/7534405/mayur-wadekar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 628, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1543826256, "creation_date": 1543818053, "last_edit_date": 1543820549, "question_id": 53588470, "link": "https://stackoverflow.com/questions/53588470/how-to-cross-compile", "title": "How to cross compile", "body": "<p>I'm just building simple application for <code>linux ARM64</code> bit architecture from <code>linux amd64</code> bit architecture but at time of building GOlang builder  giving error to binding some libraries as below</p>\n\n<p><code>go build github.com/DataDog/zstd: build constraints exclude all Go files in\n</code></p>\n\n<p>I just wanted to know that for building different cross compile architecture is any libraries of that particular architecture is needed?\nex. if I'm building for <code>ARM64</code> libraries then <code>ARM64</code> supported libraries installed on my system?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["pointers", "go", "slice", "go-map"], "comments": [{"owner": {"reputation": 354, "user_id": 8433996, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-G2k2aahkYjs/AAAAAAAAAAI/AAAAAAAAAFE/VA-qO6BCx1w/photo.jpg?sz=128", "display_name": "jmoney", "link": "https://stackoverflow.com/users/8433996/jmoney"}, "edited": false, "score": 0, "creation_date": 1543818057, "post_id": 53588435, "comment_id": 94040019, "body": "Check out <a href=\"https://stackoverflow.com/questions/46492318/go-append-directly-to-slice-found-in-a-map\" title=\"go append directly to slice found in a map\">stackoverflow.com/questions/46492318/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 14205, "user_id": 968244, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/I9DXX.jpg?s=128&g=1", "display_name": "isapir", "link": "https://stackoverflow.com/users/968244/isapir"}, "edited": false, "score": 0, "creation_date": 1543818929, "post_id": 53588460, "comment_id": 94040326, "body": "What if I know the maximum possible capacity and I create the slices to be large enough?  Or, is it possible to create a map with values of arrays instead of slices?  Would I be able to use pointers then?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 14205, "user_id": 968244, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/I9DXX.jpg?s=128&g=1", "display_name": "isapir", "link": "https://stackoverflow.com/users/968244/isapir"}, "edited": false, "score": 3, "creation_date": 1543826052, "post_id": 53588460, "comment_id": 94043137, "body": "@isapir, the capacity doesn&#39;t matter here. The length of the slice changes when you append a value, making it a different value, even if the underlying array wasn&#39;t relocated."}, {"owner": {"reputation": 14205, "user_id": 968244, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/I9DXX.jpg?s=128&g=1", "display_name": "isapir", "link": "https://stackoverflow.com/users/968244/isapir"}, "edited": false, "score": 0, "creation_date": 1574704155, "post_id": 53588460, "comment_id": 104317752, "body": "Should I delete this question?  There are 2 downvotes so unless it is voted up to at least 0 I think I will remove it.  Interestingly there are upvotes for the answer so that seems useful to some (including myself)."}], "tags": [], "owner": {"reputation": 78952, "user_id": 1069068, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vw9qZ.png?s=128&g=1", "display_name": "Raghav Sood", "link": "https://stackoverflow.com/users/1069068/raghav-sood"}, "is_accepted": false, "score": 3, "last_activity_date": 1543817984, "creation_date": 1543817984, "answer_id": 53588460, "question_id": 53588435, "link": "https://stackoverflow.com/questions/53588435/appending-to-a-slice-that-is-a-value-in-a-map/53588460#53588460", "title": "Appending to a slice that is a value in a map", "body": "<p>You cannot do that. </p>\n\n<p><code>append</code> returns a new slice, since a slice may have to be resized to complete the append. You must update your map to use the newly returned slice, which cannot be done without referencing by key.</p>\n"}], "owner": {"reputation": 14205, "user_id": 968244, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/I9DXX.jpg?s=128&g=1", "display_name": "isapir", "link": "https://stackoverflow.com/users/968244/isapir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "closed_date": 1543848782, "answer_count": 1, "score": -2, "last_activity_date": 1543817991, "creation_date": 1543817839, "last_edit_date": 1543817991, "question_id": 53588435, "link": "https://stackoverflow.com/questions/53588435/appending-to-a-slice-that-is-a-value-in-a-map", "closed_reason": "Duplicate", "title": "Appending to a slice that is a value in a map", "body": "<p>I want to append to a slice that is a value of a map, e.g. given m <code>map[string][]string</code>:</p>\n\n<pre><code>if values, exists := m[key]; exists {\n    values = append(values, v)\n//  I don't want to call: m[key] = values\n} else {\n    m[key] = []string{ v }\n}\n</code></pre>\n\n<p>That obviously doesn't work, so I tried instead of appending the value as is, to do something like:</p>\n\n<pre><code>valuesPtr := &amp;values\n*values = append(values, v)\n</code></pre>\n\n<p>But that doesn't work either.  How can I do that?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1543825136, "post_id": 53588326, "comment_id": 94042743, "body": "You need to deploy the source files with the binary."}, {"owner": {"reputation": 498, "user_id": 2857738, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/88d78bddc283c7ad9fbbe5396bfb220d?s=128&d=identicon&r=PG&f=1", "display_name": "Hendra Huang", "link": "https://stackoverflow.com/users/2857738/hendra-huang"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1543827099, "post_id": 53588326, "comment_id": 94043592, "body": "yeah that works.. is there any other package that can import the package from the binary itself instead of looking for the file ? actually i&#39;m thinking of using code generation to retrieve the vars and write it on my generated code. but if there is some package that can import the package from the binary itself, it will help"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1543827669, "post_id": 53588326, "comment_id": 94043844, "body": "Nothing like that in the std lib. Realize what you&#39;re asking for, you want a package that reverse engineers a binary to retrieve source information... you&#39;ll have an easier time just deploying the source. Alternatively <code>types.Importer</code> is an interface, you can implement your own version, one, that for example, would instead of looking for the source on the host machine download the source from your repository."}, {"owner": {"reputation": 498, "user_id": 2857738, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/88d78bddc283c7ad9fbbe5396bfb220d?s=128&d=identicon&r=PG&f=1", "display_name": "Hendra Huang", "link": "https://stackoverflow.com/users/2857738/hendra-huang"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1543829895, "post_id": 53588326, "comment_id": 94044943, "body": "okay.. thanks for the explanation @mkopriva"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1543850051, "post_id": 53588326, "comment_id": 94055705, "body": "This seems like a very likely XY Problem - you&#39;re doing source analysis but you don&#39;t want to deploy the source? What are you actually trying to accomplish with this?"}, {"owner": {"reputation": 498, "user_id": 2857738, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/88d78bddc283c7ad9fbbe5396bfb220d?s=128&d=identicon&r=PG&f=1", "display_name": "Hendra Huang", "link": "https://stackoverflow.com/users/2857738/hendra-huang"}, "edited": false, "score": 0, "creation_date": 1543933785, "post_id": 53588326, "comment_id": 94090975, "body": "I have list of enums define as a const inside a package. I would like to have an API to return list of enums which is define inside that package. Instead of writing all of the enums one by one inside my handler, i would like to have some code that can scrap all the const inside the package. that&#39;s why i try to use importer"}], "owner": {"reputation": 498, "user_id": 2857738, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/88d78bddc283c7ad9fbbe5396bfb220d?s=128&d=identicon&r=PG&f=1", "display_name": "Hendra Huang", "link": "https://stackoverflow.com/users/2857738/hendra-huang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 329, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543817189, "creation_date": 1543817189, "question_id": 53588326, "link": "https://stackoverflow.com/questions/53588326/go-importer-import-returns-error-cant-find-import-on-production", "title": "go/importer.Import returns error &quot;can&#39;t find import&quot; on production", "body": "<p>I want to build an API to return all of the global variables inside a package. I use <code>go/importer</code> to import the package. It works fine on my local machine, but when I deployed the binary, It is not working. It says <code>can't find import</code>. FYI, I only deployed the binary without the source code.</p>\n\n<p>Here is the sample code</p>\n\n<pre><code>defaultImporter := importer.For(\"gc\", nil)\nmodelsPkg, err := defaultImporter.Import(\"github.com/foo/bar/models\")\n</code></pre>\n\n<p>Is there any way to import a package inside the binary ?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1543820573, "post_id": 53587603, "comment_id": 94040977, "body": "Go doesn&#39;t support casting at all. Only type conversions."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1543820632, "post_id": 53587603, "comment_id": 94041010, "body": "If you read the compilation error, it will tell you why it doesn&#39;t work, and should provide sufficient information to find a working solution."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543906430, "post_id": 53587603, "comment_id": 94076034, "body": "I&#39;m not aware of any strictly typed language where the behavior you describe would work. Are you?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1543813261, "post_id": 53587696, "comment_id": 94038635, "body": "see my answer, there is a way to avoid have to do any more work - you have to continue to cast v to Foo  even after the assertion, my way you don&#39;t have to."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1543813463, "post_id": 53587696, "comment_id": 94038677, "body": "You&#39;re lucky I am cool, you got it, appreciate all upvotes ty"}], "tags": [], "owner": {"reputation": 799, "user_id": 2980967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ecQ8D.jpg?s=128&g=1", "display_name": "dustinevan", "link": "https://stackoverflow.com/users/2980967/dustinevan"}, "is_accepted": true, "score": 1, "last_activity_date": 1543813379, "last_edit_date": 1543813379, "creation_date": 1543813023, "answer_id": 53587696, "question_id": 53587603, "link": "https://stackoverflow.com/questions/53587603/cast-interface-to-a-type/53587696#53587696", "title": "Cast interface{} to a type", "body": "<pre><code>func main() {\n    f := Foo{\"test\"}\n    Exported(f)\n}\n\ntype Foo struct{\n    Bar string\n}\n\nfunc Exported (v interface{}){\n    t, ok := v.(Foo)\n    if !ok {\n        log.Fatal(\"boom\")\n    }\n    fmt.Println(t.Bar)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "is_accepted": false, "score": 0, "last_activity_date": 1543813228, "creation_date": 1543813228, "answer_id": 53587721, "question_id": 53587603, "link": "https://stackoverflow.com/questions/53587603/cast-interface-to-a-type/53587721#53587721", "title": "Cast interface{} to a type", "body": "<p><strong>I was making this mistake:</strong></p>\n\n<pre><code>func Exported (v interface{}){\n\n  v, ok := v.(Foo)\n\n  if !ok {\n    log.Fatal(\"oh fuk\")\n  }\n\n  // but v.Bar is not available here tho ??\n\n}\n</code></pre>\n\n<p>you need to use a different variable name:</p>\n\n<pre><code>func Exported (x interface{}){\n\n  v, ok := x.(Foo)\n\n  if !ok {\n    log.Fatal(\"oh fuk\")\n  }\n\n  // now v.Bar compiles without any further work\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 907, "user_id": 559210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363710960ea7e5fd46ffcae421502268?s=128&d=identicon&r=PG", "display_name": "Durgaprasad Budhwani", "link": "https://stackoverflow.com/users/559210/durgaprasad-budhwani"}, "is_accepted": false, "score": 3, "last_activity_date": 1543813429, "creation_date": 1543813429, "answer_id": 53587743, "question_id": 53587603, "link": "https://stackoverflow.com/questions/53587603/cast-interface-to-a-type/53587743#53587743", "title": "Cast interface{} to a type", "body": "<p>The problem is with the variable name <code>v</code>. Please refer below code</p>\n\n<pre><code>func Exported (v interface{}){\n\n  v, ok := v.(Foo)\n\n  if !ok {\n    log.Fatal(\"oh fuk\")\n  }\n\n  // but v.Bar is not available here tho ??\n\n}\n</code></pre>\n\n<p>here, interface name is <code>v</code> and after typecasting, it is assigning to variable <code>v</code>\nSince <code>v</code> is <code>interface</code> type, you are not able to retrieve value of <code>Foo</code> struct.</p>\n\n<p>To overcome this problem, use another name in typecasting like </p>\n\n<pre><code>b, ok := v.(Foo)\n</code></pre>\n\n<p>And you will be able to get <code>Bar</code> value using <code>b.Bar</code></p>\n\n<p>The working example is below:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"fmt\"\n)\n\nfunc main() {\n    foo := Foo{Bar: \"Test@123\"}\n    Exported(foo)\n}\n\n\ntype Foo struct{\n    Bar string\n}\n\nfunc Exported (v interface{}){\n    // cast v to Foo\n    b, ok := v.(Foo)\n\n    if !ok {\n        log.Fatal(\"oh fuk\")\n    }\n\n    fmt.Println(b.Bar)\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 53587696, "answer_count": 3, "score": -4, "last_activity_date": 1543813429, "creation_date": 1543812283, "last_edit_date": 1543812455, "question_id": 53587603, "link": "https://stackoverflow.com/questions/53587603/cast-interface-to-a-type", "title": "Cast interface{} to a type", "body": "<p>Say I have something like this:</p>\n\n<pre><code>type Foo struct{\n   Bar string\n}\n\nfunc Exported (v interface{}){\n // cast v to Foo\n}\n</code></pre>\n\n<p>is there a way to cast v to Foo in the Exported func?</p>\n\n<p>I tried a type assertion like so:</p>\n\n<pre><code>func Exported (v interface{}){\n\n  v, ok := v.(Foo)\n\n  if !ok {\n    log.Fatal(\"oh fuk\")\n  }\n\n  // but v.Bar is not available here tho ??\n\n}\n</code></pre>\n\n<p>The problem is that if I try to access v.Bar after the assertion, it doesn't compile.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "reply_to_user": {"reputation": 13757, "user_id": 1270003, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d5ed9123b92a6e4dffa75f9f6dd9e382?s=128&d=identicon&r=PG&f=1", "display_name": "texasbruce", "link": "https://stackoverflow.com/users/1270003/texasbruce"}, "edited": false, "score": 0, "creation_date": 1543808160, "post_id": 53587050, "comment_id": 94037590, "body": "Technically I don&#39;t think this is generics perse, it has to do with a type-hierarchy or interfaces"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1543808174, "post_id": 53587050, "comment_id": 94037594, "body": "In every other case when you tell yourself &quot;I need generics&quot; be prepared to copy-paste like a maniac (or code-generate, which effectively is the same terrible solution)"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1543808615, "post_id": 53587050, "comment_id": 94037682, "body": "For the types and <code>handleFoo</code> shown in the question, you can use  <code>func handleFoo(v struct{ Foo map[string]string })</code>  <a href=\"https://play.golang.org/p/9CkeYIqkLiz\" rel=\"nofollow noreferrer\">See it in the Playground</a>.  This approach has limitations. For example, <code>handleFoo</code> does not have access to any methods in types A, B or C."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1543808995, "post_id": 53587050, "comment_id": 94037751, "body": "@ThunderCat thanks I updated the OP, let me know if it looks good"}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1543809126, "post_id": 53587050, "comment_id": 94037782, "body": "I am pretty certain I already tried that technique you just mentioned @ThunderCat, and it didn&#39;t compile, my guess was it had to be the same exact type by name/reference, not a different type with the same signature if that makes sense."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1543809304, "post_id": 53587050, "comment_id": 94037809, "body": "Ok @ThunderCat your solution works, can you please add that as answer? I am going to remove generics from the OP title b/c technically this is not generics tmk, but what would call this feature?"}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1543810232, "post_id": 53587050, "comment_id": 94037985, "body": "@ThunderCat thanks, this is what I observe so far: <a href=\"https://gist.github.com/ORESoftware/7bd67883a3e0ff4846c1ef5489ef8b43\" rel=\"nofollow noreferrer\">gist.github.com/ORESoftware/7bd67883a3e0ff4846c1ef5489ef8b43</a>"}, {"owner": {"reputation": 799, "user_id": 2980967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ecQ8D.jpg?s=128&g=1", "display_name": "dustinevan", "link": "https://stackoverflow.com/users/2980967/dustinevan"}, "edited": false, "score": 0, "creation_date": 1543813741, "post_id": 53587050, "comment_id": 94038746, "body": "Make Bar() return the map."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1543814085, "post_id": 53587050, "comment_id": 94038836, "body": "at(dustinevan) yup that&#39;s what @James Shi said"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1543815367, "post_id": 53587050, "comment_id": 94039173, "body": "@AlexanderMills Unlike the question, the types in the gist do not share the same underlying type. If your intent is to use types that do not share the same underlying type, then update the question to show that."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1543816919, "post_id": 53587050, "comment_id": 94039684, "body": "@ThunderCat yeah for the OP it&#39;s too late to change that and would be unfair to the answers, but yeah I am curious how to do it when the structs are different, the only way I know how would be to program to <code>interface{}</code>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1543820776, "post_id": 53587050, "comment_id": 94041072, "body": "Go doesn&#39;t have generics. Trying to fake it is a silly idea. What is the goal of your code? Let&#39;s focus in your problem, rather than on your unsupported solution. As it is, this is an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY Problem</a>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1543906622, "post_id": 53587050, "comment_id": 94076116, "body": "Accepting different types is easy. That&#39;s what interfaces are for."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1543809499, "post_id": 53587258, "comment_id": 94037841, "body": "yeah this only works if all 3 structs have the exact same type, but unless something better comes along, will accept this answer soon"}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1543809563, "post_id": 53587258, "comment_id": 94037853, "body": "like I said, tecnically I don&#39;t think this is <i>generics</i> perse, but what language feature would you call this?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1543809571, "post_id": 53587258, "comment_id": 94037857, "body": "The types must be assignable to the same underlying type.  The types can be different as in the question and shown in the linked playground example.  The section of the spec on assignability is <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1543809605, "post_id": 53587258, "comment_id": 94037862, "body": "I don&#39;t follow, the 3 structs in the OP are the exact same type?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 1, "creation_date": 1543809769, "post_id": 53587258, "comment_id": 94037893, "body": "A, B and C are different types, but they have the same underlying type.  Go does not allow assignment of an <code>A</code> to a <code>B</code>, but <code>A</code> and <code>B</code> can both be assigned to <code>struct{ Foo map[string]string }</code>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 1, "creation_date": 1543810175, "post_id": 53587258, "comment_id": 94037970, "body": "The language feature is assignability."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1543809938, "last_edit_date": 1543809938, "creation_date": 1543809452, "answer_id": 53587258, "question_id": 53587050, "link": "https://stackoverflow.com/questions/53587050/golang-generics-simple-use-case/53587258#53587258", "title": "Golang generics - simple use case", "body": "<p>Because A, B, and C are are all <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">assignable</a> to the same underlying type, you can use a function with an argument of that underlying type: <code>func handleFoo(v struct{ Foo map[string]string })</code></p>\n\n<p><a href=\"https://play.golang.org/p/uggRvJ0kmxa\" rel=\"nofollow noreferrer\">Run it on the playground</a>.</p>\n\n<p>A limitation of this approach is that methods on A, B and C (even with the same name and signature), are not available in <code>handleFoo</code>.  </p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1543811647, "post_id": 53587416, "comment_id": 94038274, "body": "Yeah this works because all of them are basically the same. exact. type. lol..nice answer tho."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1543811802, "post_id": 53587416, "comment_id": 94038306, "body": "if one is <code>map[string]string</code> and another is <code>map[string]int</code> and another is <code>map[string]bool</code>, will it work? I don&#39;t think so"}, {"owner": {"reputation": 1384, "user_id": 4296218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xH28YeHMo9Q/AAAAAAAAAAI/AAAAAAAAABE/ad2T99eOL2s/photo.jpg?sz=128", "display_name": "James Shi", "link": "https://stackoverflow.com/users/4296218/james-shi"}, "reply_to_user": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1543819329, "post_id": 53587416, "comment_id": 94040488, "body": "the value are different types. the interface should change to <code>GetFoo() map[string]interface</code>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 2, "creation_date": 1543850265, "post_id": 53587416, "comment_id": 94055806, "body": "@AlexanderMills they&#39;re all the exact same type in your own example code in the question. If you need something different, edit the question to clarify that."}], "tags": [], "owner": {"reputation": 1384, "user_id": 4296218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xH28YeHMo9Q/AAAAAAAAAAI/AAAAAAAAABE/ad2T99eOL2s/photo.jpg?sz=128", "display_name": "James Shi", "link": "https://stackoverflow.com/users/4296218/james-shi"}, "is_accepted": false, "score": 3, "last_activity_date": 1543810670, "creation_date": 1543810670, "answer_id": 53587416, "question_id": 53587050, "link": "https://stackoverflow.com/questions/53587050/golang-generics-simple-use-case/53587416#53587416", "title": "Golang generics - simple use case", "body": "<p>You can use the interface in this way, add a method <code>GetFoo</code> to get foo of each struct.</p>\n\n<pre><code>type A struct{\n    Foo map[string]string\n}\n\nfunc(a *A) GetFoo() map[string]string {\n    return a.Foo\n}\n\ntype B struct{\n    Foo map[string]string\n}\n\nfunc(b *B) GetFoo() map[string]string {\n    return b.Foo\n}\n\ntype C struct{\n    Foo map[string]string\n}\n\nfunc(c *C) GetFoo() map[string]string {\n    return c.Foo\n}\n\ntype ABC interface {\n    GetFoo() map[string][string]\n}\n\nfunc handleFoo (v ABC){\n    foo := v.GetFoo()\n    x:=foo[\"barbie\"]\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 4669615, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mcDhCh1Jlv8/AAAAAAAAAAI/AAAAAAAAAH0/vUET1X7Du9w/photo.jpg?sz=128", "display_name": "goofool", "link": "https://stackoverflow.com/users/4669615/goofool"}, "is_accepted": false, "score": 1, "last_activity_date": 1543827405, "creation_date": 1543827405, "answer_id": 53590331, "question_id": 53587050, "link": "https://stackoverflow.com/questions/53587050/golang-generics-simple-use-case/53590331#53590331", "title": "Golang generics - simple use case", "body": "<p>you can try <code>reflect</code> and pass an <code>interface{}</code> to <code>handleFoo</code></p>\n\n<p><a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">https://play.golang.org/p/sLyjDvVrUjQ</a></p>\n\n<p><a href=\"https://play.golang.org/p/sLyjDvVrUjQ\" rel=\"nofollow noreferrer\">https://golang.org/pkg/reflect/</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    type A struct {\n        Foo map[string]string\n    }\n    type B struct {\n        Foo map[string]int\n    }\n    type C struct {\n        Foo map[string]uint\n    }\n    a := A{\n        Foo: map[string]string{\"a\":\"1\"},\n    }\n\n    b := B{\n        Foo: map[string]int{\"a\":2},\n    }\n\n    c := C {\n        Foo: map[string]uint{\"a\":3},\n    }\n\n\n    fmt.Println(a, b, c)\n\n    handleFoo(a)\n    handleFoo(b)\n    handleFoo(c)\n\n    fmt.Println(a, b, c)\n}\n\n\n\nfunc handleFoo(s interface{}) {\n    v := reflect.ValueOf(s)\n    foo := v.FieldByName(\"Foo\")\n    if !foo.IsValid(){\n        fmt.Println(\"not valid\")\n        return\n    }\n\n    switch foo.Type() {\n    case reflect.TypeOf(map[string]string{}):\n        fmt.Println(\"is a map[string]string\")\n        foo.Interface().(map[string]string)[\"a\"] = \"100\"\n    case reflect.TypeOf(map[string]int{}):\n        fmt.Println(\"is a map[string]int\")\n        foo.Interface().(map[string]int)[\"a\"] =  200\n    case reflect.TypeOf(map[string]uint{}):\n        fmt.Println(\"is a map[string]uint\")\n        foo.Interface().(map[string]uint)[\"a\"] =  300\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 1, "answer_count": 3, "score": -2, "last_activity_date": 1544214033, "creation_date": 1543807413, "last_edit_date": 1544214033, "question_id": 53587050, "link": "https://stackoverflow.com/questions/53587050/golang-generics-simple-use-case", "title": "Golang generics - simple use case", "body": "<p>Say I have 3 structs:</p>\n\n<pre><code>type A struct{\n   Foo map[string]string\n}\n\ntype B struct{\n   Foo map[string]string\n}\n\ntype C struct{\n   Foo map[string]string\n}\n</code></pre>\n\n<p>and then I want to create a function that can accept any of those structs:</p>\n\n<pre><code>func handleFoo (){\n\n}\n</code></pre>\n\n<p>Is there any way to do this with Golang? Something like:</p>\n\n<pre><code>type ABC = A | B | C\n\nfunc handleFoo(v ABC){\n   x: = v.Foo[\"barbie\"] // this would be nice!\n}\n</code></pre>\n\n<p>OK, so let's try an interface:</p>\n\n<pre><code>type FML interface {\n  Bar() string\n}\n\nfunc handleFoo(v FML){\n   z := v.Bar() // this will compile\n   x: = v.Foo[\"barbie\"] // this won't compile - can't access properties like Foo from v\n}\n</code></pre>\n\n<p>In a language which encourages/forces composition, I cannot understand why you can't access properties like Foo.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1543800130, "post_id": 53586210, "comment_id": 94035986, "body": "Is there a good reason putting them into separate packages in the first place? When using a single package, there&#39;s no problem."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543800254, "post_id": 53586210, "comment_id": 94036019, "body": "@icza yeah separate packages because there are more files involved, I just distilled it down as much as possible"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1543801471, "post_id": 53586372, "comment_id": 94036244, "body": "yeah I think I have to put everything in the same package, here comes 20+ files in the same folder lol, namespacing be damned, this sucks btw, not your fault, golangs fault"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 2, "creation_date": 1543804738, "post_id": 53586372, "comment_id": 94036875, "body": "@AlexanderMills I think disallowance of circular imports was laid down for fast compilation, but if applied correctly, it can result if cleaner / more logical structure. It also helps you to easier understand the dependencies of your packages / modules."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1543805110, "last_edit_date": 1592644375, "creation_date": 1543801004, "answer_id": 53586372, "question_id": 53586210, "link": "https://stackoverflow.com/questions/53586210/cyclic-imports-and-lack-of-generics-causing-headache/53586372#53586372", "title": "Cyclic imports and lack of generics causing headache", "body": "<p>If you want them to put into separate packages, you can't have <code>Model</code> and <code>zoom()</code> in the same package, as <code>zoom()</code> refers to <code>Injection</code> and <code>Injection</code> refers to <code>Model</code>.</p>\n<p>So a possible solution is to put <code>Model</code> into package <code>a</code>, <code>zoom()</code> into package <code>b</code>, and <code>Injection</code> into package <code>c</code>. <code>c.Injection</code> can refer to <code>a.Model</code>, <code>b.zoom()</code> can refer to <code>c.Injection</code>. There's no circle in this:</p>\n<pre><code>   b.zoom() --------&gt;   c.Injection ---------&gt; a.Model\n</code></pre>\n<p>I assume there are other references in your real code which are not in the question which may prevent this from working, but you can move &quot;stuff&quot; around between packages, or you can break it down into more.</p>\n<p>Also, if things are coupled this &quot;tight&quot;, you should really consider putting them into the same package, and then there is no problem to solve.</p>\n<p>Another way to solve circular import issue is to introduce interfaces. E.g. if your <code>zoom()</code> function would not refer to <code>Injection</code>, the package containing <code>Model</code> and <code>zoom()</code> would not need to refer to <code>Injection</code>'s package.</p>\n<p>Inspect what <code>zoom()</code> needs to do with <code>Injection</code>. If that is method calls, that's already good. If not, add methods to <code>Injection</code>. Then you may define an interface in <code>zoom()</code>'s package containing the methods <code>zoom()</code> needs to call, and change its parameter type to this interface. Implementing interfaces in Go is implicit, there is no declaration of intent. So you can remove the reference in the parameter type, still you will be able to pass <code>Injection</code> values to <code>zoom()</code>.</p>\n<p>Also related, check <a href=\"https://forum.golangbridge.org/t/organizing-go-code/1110/7?u=christophberger\" rel=\"nofollow noreferrer\">Dave Cheney's thoughts about organizing code</a>:</p>\n<blockquote>\n<p>I believe code should be organised into packages names for what the package provides, not what it contains. This can sometimes be subtle, but usually not.</p>\n<p>For example, http, provides http clients and servers.</p>\n<p>As a counter example, package utils is a poor name, yes it provides utilities, but you have no idea what from the name, in truth this package is named for what it contains.</p>\n<p>If your project is a library, it should contain one package (excluding examples and possibly utility commands), if it contains more packages, that is a sign that the library is trying to do too many things.</p>\n<p>Prefer to avoid multiple packages by default, only split code by package if there is a clear separation of concerns. In my experience many frustrations with complex and possibly circular package structures are the result of too many packages in a project.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1543805110, "creation_date": 1543799215, "last_edit_date": 1543800048, "question_id": 53586210, "link": "https://stackoverflow.com/questions/53586210/cyclic-imports-and-lack-of-generics-causing-headache", "title": "Cyclic imports and lack of generics causing headache", "body": "<p>Say I have these two files in golang:</p>\n\n<pre><code>// main/a/a.go\nimport \"main/b\"\n\ntype Model struct {\n    ID         int    `json:\"id\"`\n    Me         int    `json:\"me\"`\n    You        int    `json:\"you\"`\n}\n\nfunc zoom(v b.Injection){\n\n}\n\nfunc Start(){\n  // ...\n}\n</code></pre>\n\n<p>and then the second file looks like:</p>\n\n<pre><code>// main/b/b.go\nimport \"main/a\"\n\ntype Injection struct {\n    ModelA a.Model\n}\n\n\nfunc GetInjection() Injection {\n    return Injection{\n        ModelA: a.Start(),\n    }\n}\n</code></pre>\n\n<p>so as you can see, these are circular imports, each file imports the other.\nSo I need to use a 3rd file, and have these two files import the 3rd file.</p>\n\n<p>But I am really struggling how to get this functionality and avoid cyclic imports. </p>\n\n<p>My first step, is to move the <code>Injection</code> type into a 3rd file:</p>\n\n<pre><code>   // main/c/c.go\n\n    type Injection struct {\n        ModelA interface{} // formerly a.Model\n    }\n</code></pre>\n\n<p>so now this is what it looks like:</p>\n\n<pre><code>a imports c\nb imports a,c\n</code></pre>\n\n<p>so no more cycles, however the problem is that I don't know how to create an interface for <code>a.Model</code> in <code>c.go</code>? An empty <code>interface{}</code> like I used above doesn't work, for the normal reasons.</p>\n\n<p>How do I solve this cyclic import problem with these 2 original files?</p>\n"}, {"tags": ["go", "concurrency", "channel", "goroutine"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1543799675, "post_id": 53586139, "comment_id": 94035903, "body": "Your thing with <code>sem</code> is weird. If you wanted a limited number of readers on a channel, then only launch that many readers. Each reader would read <code>reqs</code>. Eh, whatever. Your <code>sem</code> thing is just not like other Go code I&#39;ve read."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1543800423, "post_id": 53586139, "comment_id": 94036059, "body": "Anyway this is how I would write it, not that you have to do it this way: <a href=\"https://play.golang.org/p/RB3sUoSaSxm\" rel=\"nofollow noreferrer\">play.golang.org/p/RB3sUoSaSxm</a>"}, {"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1543866048, "post_id": 53586139, "comment_id": 94063863, "body": "@ZanLynx Thanks for the additional suggestion!"}], "answers": [{"comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1543800794, "post_id": 53586230, "comment_id": 94036120, "body": "I noticed that yours (and the original code) doesn&#39;t do 9 because it doesn&#39;t wait long enough for the goroutines to complete."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1543801077, "post_id": 53586230, "comment_id": 94036165, "body": "@ZanLynx Yes, you&#39;re right, I was only focusing on the problem in question."}, {"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1543819148, "post_id": 53586230, "comment_id": 94040423, "body": "I realize these mistakes are also discussed in the &quot;effective go&quot; article. However, after reading the article, i still did not understand how the second suggestion work.  I.e., req is a pointer and the for loop is still changing it which is the same situation in my code. The only difference is the req is passed as an argument in the closure. Could you elaborate how it work?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1543827157, "post_id": 53586230, "comment_id": 94043621, "body": "@drdot Added 3 links to related questions where it is detailed."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1543827141, "last_edit_date": 1543827141, "creation_date": 1543799451, "answer_id": 53586230, "question_id": 53586139, "link": "https://stackoverflow.com/questions/53586139/missing-data-in-the-channel/53586230#53586230", "title": "Missing data in the channel", "body": "<p>Because in <code>serve()</code> your loop variable is used inside the function literal you execute on a separate goroutine, which is concurrently modified by the goroutine running the loop: data race. If you have data race, the behavior is undefined.</p>\n\n<p>If you make a copy of the variable, it will work:</p>\n\n<pre><code>for req := range reqs {\n    sem &lt;- 1\n    req2 := req\n    go func() {\n        process(req2)\n        &lt;-sem\n    }()\n}\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/Dv8IB-ir-cu\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>Another possibility is to pass this to the anonymous function as a parameter:</p>\n\n<pre><code>for req := range reqs {\n    sem &lt;- 1\n    go func(req *Request) {\n        process(req)\n        &lt;-sem\n    }(req)\n}\n</code></pre>\n\n<p>Try this one on the <a href=\"https://play.golang.org/p/0SrobatmbDm\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>This is detailed in several related questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/48826460/using-pointers-in-a-for-loop-golang/48826629#48826629\">Using Pointers in a for Loop - Golang</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/44044245/golang-register-multiple-routes-using-range-for-loop-slices-map/44045012#44045012\">Golang: Register multiple routes using range for loop slices/map</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/44715882/why-do-these-two-for-loop-variations-give-me-different-behavior/44716068#44716068\">Why do these two for loop variations give me different behavior?</a></p>\n\n<p>Also as Zan Lynx noted, your main goroutine does not wait for all launched goroutines to complete, so you may not see all the requests printed. See this question how you can wait started goroutines: <a href=\"https://stackoverflow.com/questions/42752705/prevent-the-main-function-from-terminating-before-goroutines-finish-in-golang/42753005#42753005\">Prevent the main() function from terminating before goroutines finish in Golang</a></p>\n"}, {"tags": [], "owner": {"reputation": 1384, "user_id": 4296218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xH28YeHMo9Q/AAAAAAAAAAI/AAAAAAAAABE/ad2T99eOL2s/photo.jpg?sz=128", "display_name": "James Shi", "link": "https://stackoverflow.com/users/4296218/james-shi"}, "is_accepted": false, "score": 1, "last_activity_date": 1543811616, "creation_date": 1543811616, "answer_id": 53587519, "question_id": 53586139, "link": "https://stackoverflow.com/questions/53586139/missing-data-in-the-channel/53587519#53587519", "title": "Missing data in the channel", "body": "<p>This is because of when the anonymous execuate, the req is alreay has move from <code>Request{0}</code> to <code>Request{1}</code>, so you print from <code>{start 1}</code>.</p>\n\n<pre><code>// method 1: add a parameter, pass it to anonymous function\nfunc serve(reqs chan *Request) {\n    for req := range reqs {\n        sem &lt;- 1\n\n        // You should make the req as parameter of this function\n        // or, when the function execute, the req point to Request{1}\n        go func(dup *Request) {\n            process(dup)\n            &lt;-sem\n        }(req)\n    }\n\n    // And you should wait for the Request{9} to be processed\n    time.Sleep(time.Second)\n}\n\n// method 2: make for wait anonymous function\nfunc serve(reqs chan *Request) {\n    for req := range reqs {\n        go func() {\n            process(req)\n            sem &lt;- 1\n        }()\n\n        // Or wait here\n        &lt;-sem\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 53586230, "answer_count": 2, "score": 1, "last_activity_date": 1543827141, "creation_date": 1543798472, "last_edit_date": 1543799823, "question_id": 53586139, "link": "https://stackoverflow.com/questions/53586139/missing-data-in-the-channel", "title": "Missing data in the channel", "body": "<p>I wrote a small program to practice go channel. </p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"strconv\"\n)\n\nvar MaxOutstanding int = 1\nvar channelSize int = 10\nvar sem = make(chan int, MaxOutstanding)\n\ntype Request struct {\n    command string\n    data    string\n}\n\nfunc process(req *Request) {\n    log.Println(req)\n}\n\nfunc serve(reqs chan *Request) {\n    for req := range reqs {\n        sem &lt;- 1\n        go func() {\n            process(req)\n            &lt;-sem\n        }()\n    }\n}\n\nfunc main() {\n    reqs := make(chan *Request, channelSize)\n    for i := 0; i &lt; channelSize; i++ {\n        req := &amp;Request{\"start\", strconv.Itoa(i)}\n        reqs &lt;- req\n    }\n    close(reqs)\n    serve(reqs)\n}\n</code></pre>\n\n<p>This prints</p>\n\n<pre><code>2018/12/02 16:52:30 &amp;{start 1}\n2018/12/02 16:52:30 &amp;{start 2}\n2018/12/02 16:52:30 &amp;{start 3}\n2018/12/02 16:52:30 &amp;{start 4}\n2018/12/02 16:52:30 &amp;{start 5}\n2018/12/02 16:52:30 &amp;{start 6}\n2018/12/02 16:52:30 &amp;{start 7}\n2018/12/02 16:52:30 &amp;{start 8}\n2018/12/02 16:52:30 &amp;{start 9}\n</code></pre>\n\n<p>Therefore, &amp;{start 0} is not printed. Why is this missing?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1543795357, "post_id": 53585803, "comment_id": 94035119, "body": "The way you&#39;re using <code>Map</code> is as a type, so yes, you should declare it as a type. You can&#39;t use <code>reflect</code> to get the type of some other object to use when declaring a variable (although if you assign the new variable to that other object in the declaration, it will be of the same type)."}], "answers": [{"tags": [], "owner": {"reputation": 1255, "user_id": 4982148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X52Wq.jpg?s=128&g=1", "display_name": "atakanyenel", "link": "https://stackoverflow.com/users/4982148/atakanyenel"}, "is_accepted": false, "score": -1, "last_activity_date": 1543795428, "creation_date": 1543795428, "answer_id": 53585844, "question_id": 53585803, "link": "https://stackoverflow.com/questions/53585803/reference-type-of-expression-with-golang/53585844#53585844", "title": "Reference type of expression with Golang", "body": "<p>I'm not sure I understood your problem but you can do something like this:</p>\n\n<pre><code> var Map = map[string]Model{}\n\n var (\n   mtx sync.Mutex\n   people = Map\n )\n</code></pre>\n\n<p>That way <code>people</code> is initialized as same as <code>Map</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "is_accepted": false, "score": 0, "last_activity_date": 1543796904, "last_edit_date": 1543796904, "creation_date": 1543795617, "answer_id": 53585865, "question_id": 53585803, "link": "https://stackoverflow.com/questions/53585803/reference-type-of-expression-with-golang/53585865#53585865", "title": "Reference type of expression with Golang", "body": "<p>You can use map literal to initialize map:</p>\n\n<pre><code>type Model struct {}\n\nvar people = map[string]Model{\n    \"Foo\": Model{},\n    \"Bar\":   Model{},\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "is_accepted": false, "score": 1, "last_activity_date": 1543797996, "last_edit_date": 1543797996, "creation_date": 1543797088, "answer_id": 53586010, "question_id": 53585803, "link": "https://stackoverflow.com/questions/53585803/reference-type-of-expression-with-golang/53586010#53586010", "title": "Reference type of expression with Golang", "body": "<p>I think you want to use something like</p>\n\n<pre><code>type Model struct{}\ntype ModelMap map[string]Model\n\nvar (\n    mtx sync.Mutex\n    people = ModelMap{}\n)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1543818434, "creation_date": 1543794927, "question_id": 53585803, "link": "https://stackoverflow.com/questions/53585803/reference-type-of-expression-with-golang", "title": "Reference type of expression with Golang", "body": "<p>I have this </p>\n\n<pre><code>var Map = map[string]Model{}\n\nvar (\n    mtx    sync.Mutex\n    people Map\n)\n</code></pre>\n\n<p>I am getting this error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/k9DMe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k9DMe.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is there any way of referencing the type of the Map, something like this:</p>\n\n<pre><code>var (\n    mtx    sync.Mutex\n    people reflect.Type(Map)  // &lt;&lt;&lt; ?\n)\n</code></pre>\n\n<p>or should I just resort to declare the type like so:</p>\n\n<pre><code>type Map map[string]Model\n</code></pre>\n\n<p>and the initializing the map like I do on line 54? I was just trying to initialize the map in the file without having to do it in the Init func.</p>\n"}, {"tags": ["mysql", "sqlite", "go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 4, "creation_date": 1543791929, "post_id": 53585476, "comment_id": 94034379, "body": "You&#39;ve mentioned <code>sqlite</code>, but then it&#39;s <code>mysql</code> in your code. Those are 2 distinct and not interchangeable technologies"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1543793992, "post_id": 53585476, "comment_id": 94034827, "body": "There&#39;s insufficient information in this question to determine why the target machine is refusing the connection."}], "answers": [{"tags": [], "owner": {"reputation": 916, "user_id": 8047506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KS6Eg.jpg?s=128&g=1", "display_name": "Evgeny A. Mamonov", "link": "https://stackoverflow.com/users/8047506/evgeny-a-mamonov"}, "is_accepted": false, "score": 1, "last_activity_date": 1543811609, "creation_date": 1543811609, "answer_id": 53587516, "question_id": 53585476, "link": "https://stackoverflow.com/questions/53585476/panic-when-trying-to-insert-into-table-using-golang/53587516#53587516", "title": "Panic when trying to insert into table using golang", "body": "<p>You should open connect to sqlite like this:\n<code>db, err := sql.Open(\"sqlite3\", \"my.db\")</code></p>\n\n<p>Here is working code:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n\n    _ \"github.com/mattn/go-sqlite3\"\n)\n\nfunc main() {\n    db, err := sql.Open(\"sqlite3\", \"my.db\")\n    if err != nil {\n        panic(err.Error())\n    }\n    defer db.Close()\n\n    _, err = db.Exec(`CREATE TABLE IF NOT EXISTS artists (`+\n         ` id INTEGER PRIMARY KEY AUTOINCREMENT,`+\n         ` name text,`+\n         ` album text,`+\n         ` hits text`+\n    `)`)\n    if err != nil {\n        panic(err.Error())\n    }\n\n    insert, err := db.Query(\"INSERT INTO artists (name,album,hits) VALUES('x','y','z')\")\n    if err != nil {\n        panic(err.Error())\n    }\n    defer insert.Close()\n    fmt.Println(\"connected\")\n}\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1543811609, "creation_date": 1543791824, "question_id": 53585476, "link": "https://stackoverflow.com/questions/53585476/panic-when-trying-to-insert-into-table-using-golang", "title": "Panic when trying to insert into table using golang", "body": "<p>I am trying to insert data to a database which I have created using <code>SQLite3</code>using go lang. The database has the name <code>mydb</code> and my table has the name artists and contains 3 cols</p>\n\n<p>Here is my code:</p>\n\n<pre><code>package main\n\n    import (\n        \"database/sql\"\n        \"fmt\"\n\n        _ \"github.com/go-sql-driver/mysql\"\n        sqlite \"github.com/mattn/go-sqlite3\"\n    )\n\n    func main() {\n        //create(\"testdb\")\n        db, err := sql.Open(\"mysql\", \"root:password@tcp(127.0.0.1:3306)/mydb\")\n        if err != nil {\n            panic(err.Error())\n        }\n        defer db.Close()\n\n        insert, err := db.Query(\"INSERT INTO artists (name,album,hits)values('x','y','z')\")\n        if err != nil {\n            panic(err.Error())\n        }\n        defer insert.Close()\n        fmt.Println(\"connected\")\n    }\n</code></pre>\n\n<p>and Here is the error Im getting when i run <code>main.go</code></p>\n\n<pre><code>  panic: dial tcp 127.0.0.1:3306: connectex: No connection could be made because the target machine actively refused it.\n\ngoroutine 1 [running]:\nmain.main()\n        C:/Users/HP/go/src/connectingToDb/main.go:20 +0x1e5\nexit status 2\n</code></pre>\n\n<p>Please note that i have created the database in the same file as the main.go</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 84923, "user_id": 1920232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iUA8y.jpg?s=128&g=1", "display_name": "peterm", "link": "https://stackoverflow.com/users/1920232/peterm"}, "is_accepted": true, "score": 1, "last_activity_date": 1543794756, "creation_date": 1543794756, "answer_id": 53585781, "question_id": 53585451, "link": "https://stackoverflow.com/questions/53585451/how-to-create-struct-which-is-composed-of-another/53585781#53585781", "title": "How to create struct which is composed of another", "body": "<p>You can do</p>\n\n<pre><code>d := DocsLocal{tc.Docs{[]string{\"foo\"}, \"biscuit\"}}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>d := DocsLocal{Docs: tc.Docs{[]string{\"foo\"}, \"biscuit\"}}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/b7gjx64waJP\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}], "owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1543797698, "accepted_answer_id": 53585781, "answer_count": 1, "score": -2, "last_activity_date": 1543797718, "creation_date": 1543791676, "question_id": 53585451, "link": "https://stackoverflow.com/questions/53585451/how-to-create-struct-which-is-composed-of-another", "closed_reason": "Duplicate", "title": "How to create struct which is composed of another", "body": "<p>I have a struct like so:</p>\n\n<pre><code>type Docs struct {\n    Methods []string\n    Route string\n}\n</code></pre>\n\n<p>and then I import that from another file like:</p>\n\n<pre><code>import tc \"huru/type-creator\"\n</code></pre>\n\n<p>and use it like so:</p>\n\n<pre><code>type DocsLocal struct {\n    tc.Docs\n}\n</code></pre>\n\n<p>I am pretty certain that tc.Docs is just a field in DocsLocal, so this would be a case of composition, right?</p>\n\n<p>if I want to create new instance of DocsLocal, I try this:</p>\n\n<pre><code>d:= DocsLocal{}\n</code></pre>\n\n<p>but how do I pass in the Methods and Route parameters? If I do this:</p>\n\n<pre><code>methods:= []string{\"foo\"}\nr:=\"biscuit\"\nd:= DocsLocal{methods, r}\n</code></pre>\n\n<p>I get an error:</p>\n\n<blockquote>\n  <p>Cannot use methods (type []string) as type tc.Docs more</p>\n</blockquote>\n\n<p>So what is the right syntax to use here?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 4, "creation_date": 1543790757, "post_id": 53585324, "comment_id": 94034136, "body": "just remove the make(), this is a struct declaration, you can&#39;t initialize values in it."}, {"owner": {"reputation": 15, "user_id": 10736415, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rgQuz7u-ZLQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gm0lDniJI8kV1_7HmpP2Wq1L7V_w/mo/photo.jpg?sz=128", "display_name": "Obreja Cristian", "link": "https://stackoverflow.com/users/10736415/obreja-cristian"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1543792052, "post_id": 53585324, "comment_id": 94034400, "body": "@Not_a_Golfer yes i did this, but application need to be channel this funnction, return this error after &quot;&quot;&quot;assignment to entry in nil map&quot;&quot;&quot;"}, {"owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "edited": false, "score": 1, "creation_date": 1543792476, "post_id": 53585324, "comment_id": 94034491, "body": "Initialize the map field in the constructor then ?"}], "answers": [{"tags": [], "owner": {"reputation": 550, "user_id": 5555392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J51B6.png?s=128&g=1", "display_name": "Mark White", "link": "https://stackoverflow.com/users/5555392/mark-white"}, "is_accepted": false, "score": 1, "last_activity_date": 1543805060, "creation_date": 1543805060, "answer_id": 53586780, "question_id": 53585324, "link": "https://stackoverflow.com/questions/53585324/golang-syntax-error-unexpected-in-struct/53586780#53586780", "title": "golang syntax error: unexpected in struct", "body": "<p>Replace</p>\n\n<p><code>\nTaskForIP        make(map[string]int)\n</code></p>\n\n<p>To </p>\n\n<p><code>\nTaskForIP        map[string]int\n</code></p>\n"}, {"tags": [], "owner": {"reputation": 892, "user_id": 4422527, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-vYXXPXAUbX8/AAAAAAAAAAI/AAAAAAAAACI/sCfRq5GIm78/photo.jpg?sz=128", "display_name": "M Gholami", "link": "https://stackoverflow.com/users/4422527/m-gholami"}, "is_accepted": false, "score": 1, "last_activity_date": 1543823181, "creation_date": 1543823181, "answer_id": 53589456, "question_id": 53585324, "link": "https://stackoverflow.com/questions/53585324/golang-syntax-error-unexpected-in-struct/53589456#53589456", "title": "golang syntax error: unexpected in struct", "body": "<p>Try something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n)\n\ntype WebServer struct {\n    TodoService      task.TodoService\n    UserService      usr.UserService\n    SessionService   session.Service\n    CategoryService  task.CategoryService\n    WorkerService    task.WorkerService\n    ApiWorkerService task.ApiWorkerService\n    BlacklistService task.BlacklistService\n    LabelService     *labels.Service\n    StatusService    *statuses.Service\n    InviteService    *invites.Service\n    Runner           *task.Runner\n    TaskForIP        map[string]int\n    Params           WebServerParams\n}\n\nfunc (ws WebServer) NewInstance() WebServer {\n    ws.TaskForIP = make(map[string]int)\n    return ws\n}\n\nfunc main() {\n    webServer := WebServer{}.NewInstance()\n    log.Println(webServer)\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10736415, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rgQuz7u-ZLQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gm0lDniJI8kV1_7HmpP2Wq1L7V_w/mo/photo.jpg?sz=128", "display_name": "Obreja Cristian", "link": "https://stackoverflow.com/users/10736415/obreja-cristian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1543823181, "creation_date": 1543790608, "question_id": 53585324, "link": "https://stackoverflow.com/questions/53585324/golang-syntax-error-unexpected-in-struct", "title": "golang syntax error: unexpected in struct", "body": "<pre><code>type WebServer struct {\n    TodoService      task.TodoService\n    UserService      usr.UserService\n    SessionService   session.Service\n    CategoryService  task.CategoryService\n    WorkerService    task.WorkerService\n    ApiWorkerService task.ApiWorkerService\n    BlacklistService task.BlacklistService\n    LabelService     *labels.Service\n    StatusService    *statuses.Service\n    InviteService    *invites.Service\n    Runner           *task.Runner\n    TaskForIP        make(map[string]int)\n    Params           WebServerParams\n}\n</code></pre>\n\n<p>this is my current code, is not my application, and return this error :</p>\n\n<pre><code>app\\infrastructure\\web\\webserver.go:41:23: syntax error: unexpected (, expecting\n semicolon or newline or }\n</code></pre>\n\n<p>the line 41 is the line TaskForIP, i can't remove make because is necesary in application, how i can fix ?</p>\n"}, {"tags": ["elasticsearch", "go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543784745, "post_id": 53584220, "comment_id": 94032681, "body": "What makes you think you have to delete the index first?"}, {"owner": {"reputation": 47, "user_id": 10579479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04dcf977649e5fdf638914172fe91c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Jond", "link": "https://stackoverflow.com/users/10579479/jond"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543785134, "post_id": 53584220, "comment_id": 94032787, "body": "Because it doesn&#39;t work. Do you know how to insert data into existing index in elasticsearch using olivere in golang? I tried to insert new data into existing data, but it doesn&#39;t work. I use ES 6.4.3, but it didn&#39;t work when inserting new data into existing index. There is no new data inserted."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543786379, "post_id": 53584220, "comment_id": 94033080, "body": "Presumably because you are using the same document IDs every time."}, {"owner": {"reputation": 47, "user_id": 10579479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04dcf977649e5fdf638914172fe91c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Jond", "link": "https://stackoverflow.com/users/10579479/jond"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543786703, "post_id": 53584220, "comment_id": 94033164, "body": "no, I change the id in the next insert, but it still didn&#39;t work"}], "owner": {"reputation": 47, "user_id": 10579479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04dcf977649e5fdf638914172fe91c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Jond", "link": "https://stackoverflow.com/users/10579479/jond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543782253, "creation_date": 1543781810, "last_edit_date": 1543782253, "question_id": 53584220, "link": "https://stackoverflow.com/questions/53584220/how-to-add-data-into-existing-index-in-elasticsearch-using-olivere-package", "title": "How to Add Data into Existing Index in Elasticsearch using Olivere Package", "body": "<p>I am not sure whether it is correct or not. But I think that if I want to add data into existing index in elasticsearch using olivere in golang, the only option available is to delete the index and re index the data. </p>\n\n<p>This is my code : </p>\n\n<pre><code>bulkRequest := client.Bulk()\n        for j := 0; j &lt; 20; j++ {\n\n            n++\n            tweet := Tweet{User: \"Rudi\", Message: \"This is the new from string representations of basic data types. \" + strconv.Itoa(n)}\n            req :=\n                elastic.NewBulkIndexRequest().Index(\"employee\").Type(\"tweet\").Id(strconv.Itoa(n)).Doc(tweet)\n            bulkRequest.Add(req)\n\n        }\n\n        bulkResponse, err := bulkRequest.Do(context.Background())\n</code></pre>\n\n<p>Does anyone know a better solution? </p>\n\n<p>Thanks </p>\n"}, {"tags": ["web-services", "http", "go"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1543788343, "post_id": 53584108, "comment_id": 94033609, "body": "It works for me. How are you determining that requests are not getting redirected properly?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1543788634, "post_id": 53584108, "comment_id": 94033677, "body": "This <a href=\"https://play.golang.org/p/Irh4rAJgJkr\" rel=\"nofollow noreferrer\">program</a> assigns ports using the same channel operations as in the question. It works as expected.  Something else is going on in your program.  I suggest logging <code>r.url.Path</code> and <code>channel</code> from the handler.  Random guess: the browser is requesting favicon.ico."}, {"owner": {"reputation": 3, "user_id": 6293767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5b712358447ef5ffec787b9db23a56?s=128&d=identicon&r=PG&f=1", "display_name": "Jicnon", "link": "https://stackoverflow.com/users/6293767/jicnon"}, "edited": false, "score": 0, "creation_date": 1544069553, "post_id": 53584108, "comment_id": 94147912, "body": "You two are right, my browser was caching and accessing the old page instead of requesting a new one and getting redirected again. Thank you."}], "owner": {"reputation": 3, "user_id": 6293767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5b712358447ef5ffec787b9db23a56?s=128&d=identicon&r=PG&f=1", "display_name": "Jicnon", "link": "https://stackoverflow.com/users/6293767/jicnon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543781035, "creation_date": 1543781035, "question_id": 53584108, "link": "https://stackoverflow.com/questions/53584108/redirect-using-channels-in-go", "title": "Redirect using Channels in Go", "body": "<p>I am attempting to make a master program that redirects to servers in a round robin fashion. The master listens at port 9090 in this case and then redirects to either port 9001 or 9000. The idea is to have ports 9000 and 9001 held in a channel that is pulled from and added to by the redirect function. However, in practice it always redirects to 9000 rather than 9001. Is the channel not being updated correctly by the redirect function? or is there something else I am missing. The channel definitely has the values stored as I am successfully redirected from 9090 to 9000 every time.</p>\n\n<p>Redirect function</p>\n\n<pre><code>func redirect(ports chan int) func(w http.ResponseWriter, r *http.Request) {\n    return func(w http.ResponseWriter, r *http.Request) {\n        channel := &lt;-ports\n        address := fmt.Sprintf(\"http://localhost:%d\", channel)\n        ports &lt;- channel\n        http.Redirect(w, r, address, 301)\n    }\n}\n</code></pre>\n\n<p>Master Main Function</p>\n\n<pre><code>func main() {\n    currentChannel := make(chan int, 2)\n    go startServer(\"C:/Users\", \"9000\")\n    go startServer(\"C:/Users\", \"9001\")\n    currentChannel &lt;- 9000\n    currentChannel &lt;- 9001\n    http.HandleFunc(\"/\", redirect(currentChannel))\n    err := http.ListenAndServe(\":9090\", nil)\n    if err != nil {\n        log.Fatal(\"ListenAndServe: \", err)\n    }\n}\n</code></pre>\n\n<p>go startServer just starts a generic file server. I have tested each of them individually and I am able to access both 9000 and 9001 without the redirect with no problems.</p>\n"}, {"tags": ["go", "interface", "channel"], "comments": [{"owner": {"reputation": 5287, "user_id": 1813169, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wTAkF.jpg?s=128&g=1", "display_name": "MTCoster", "link": "https://stackoverflow.com/users/1813169/mtcoster"}, "edited": false, "score": 0, "creation_date": 1543776320, "post_id": 53582985, "comment_id": 94030294, "body": "Is there a reason you can\u2019t just create <code>c2</code> as a <code>chan *Hashable</code>?"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "reply_to_user": {"reputation": 5287, "user_id": 1813169, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wTAkF.jpg?s=128&g=1", "display_name": "MTCoster", "link": "https://stackoverflow.com/users/1813169/mtcoster"}, "edited": false, "score": 1, "creation_date": 1543778421, "post_id": 53582985, "comment_id": 94030906, "body": "@MTCoster OP would likely want <code>chan Hashable</code> instead. You don&#39;t often need to use pointers to interfaces."}, {"owner": {"reputation": 4002, "user_id": 49561, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/67750c14e5134a187229d619d8a4342e?s=128&d=identicon&r=PG", "display_name": "cdecker", "link": "https://stackoverflow.com/users/49561/cdecker"}, "edited": false, "score": 0, "creation_date": 1543778504, "post_id": 53582985, "comment_id": 94030936, "body": "Good question, I was planning to reuse the <code>chan *Transaction</code> in another context as well, where I actually need the elements to be <code>*Transaction</code>. I can create a function that just converts by reading one channel and writing to the other, but that seems kind of wasteful (context switches, an extra gorouting, etc)."}, {"owner": {"reputation": 5287, "user_id": 1813169, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wTAkF.jpg?s=128&g=1", "display_name": "MTCoster", "link": "https://stackoverflow.com/users/1813169/mtcoster"}, "edited": false, "score": 0, "creation_date": 1543778586, "post_id": 53582985, "comment_id": 94030961, "body": "If you follow Gavin\u2019s advice and drop the pointer, you use either and cast in the other case."}, {"owner": {"reputation": 4002, "user_id": 49561, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/67750c14e5134a187229d619d8a4342e?s=128&d=identicon&r=PG", "display_name": "cdecker", "link": "https://stackoverflow.com/users/49561/cdecker"}, "edited": false, "score": 0, "creation_date": 1543779082, "post_id": 53582985, "comment_id": 94031113, "body": "Notice that <code>chan Hashable</code> has no pointer, and that&#39;s exactly the case I&#39;m trying to get working :-)"}], "answers": [{"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": true, "score": 1, "last_activity_date": 1543789646, "creation_date": 1543789646, "answer_id": 53585205, "question_id": 53582985, "link": "https://stackoverflow.com/questions/53582985/channels-with-interface-type-and-pointers-to-structs-as-concrete-types/53585205#53585205", "title": "Channels with interface type and pointers to structs as concrete types", "body": "<p>The problem is: <code>chan *Transaction</code> is not an interface - it's a specific type. So it cannot implement interface or <code>chan Hashable</code> by it's nature. You need to use specific channel.</p>\n\n<p>You can convert <code>Transaction</code> values to <code>Hashable</code> on the fly with a grouting like this:</p>\n\n<pre><code>func convertor(ct chan *Transaction) chan Hashable {\n    ch := make(chan Hashable)\n    go func() {\n        for t := range(ct) {\n            ch &lt;- Hashable(t)\n        }\n\n    }()\n    return ch\n}\n</code></pre>\n\n<p>and call </p>\n\n<pre><code>consume(convertor(c2))\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/pd2EfhCehYz\" rel=\"nofollow noreferrer\">https://play.golang.org/p/pd2EfhCehYz</a></p>\n"}], "owner": {"reputation": 4002, "user_id": 49561, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/67750c14e5134a187229d619d8a4342e?s=128&d=identicon&r=PG", "display_name": "cdecker", "link": "https://stackoverflow.com/users/49561/cdecker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "accepted_answer_id": 53585205, "answer_count": 1, "score": 0, "last_activity_date": 1543789646, "creation_date": 1543773042, "question_id": 53582985, "link": "https://stackoverflow.com/questions/53582985/channels-with-interface-type-and-pointers-to-structs-as-concrete-types", "title": "Channels with interface type and pointers to structs as concrete types", "body": "<p>I'm attempting to generalize some of my code and I thought I might be able to pull some common code together, but I'm hitting my head against a type-system problem.</p>\n\n<p>Let's assume I have an interface like this:</p>\n\n<pre><code>type Hashable interface {\n    GetHash() []byte\n}\n</code></pre>\n\n<p>and I have a couple of concrete types like this:</p>\n\n<pre><code>type Transaction struct {\n    Hash                 []byte    `protobuf:\"bytes,1,opt,name=hash,proto3\" json:\"hash,omitempty\"`\n}\n\nfunc (m *Transaction) GetHash() []byte {\n    if m != nil {\n        return m.Hash\n    }\n    return nil\n}\n</code></pre>\n\n<p>Notice that these are generated by <code>protoc</code>, and I can probably not change them easily. While the type itself does not implement <code>Hashable</code>, the pointer to the struct should if I'm not mistaken.</p>\n\n<p>The issue arises when I create a function that accepts a channel of type <code>chan Hashable</code> and try to pass in a <code>chan *Transaction</code>, like this:</p>\n\n<pre><code>func consume(c chan Hashable) {\n    // Do something with the elements from c\n}\n\nfunc main() {\n    var c2 chan *Transaction\n    consume(c2)\n}\n</code></pre>\n\n<p>(I created a small example to show this issue in the <a href=\"https://play.golang.org/p/I2C-Zkkam0W\" rel=\"nofollow noreferrer\">Playground</a>)</p>\n\n<p>I could of course create a new struct that repacks the fields that <code>consume</code> needs, but that seems like a much worse option.</p>\n\n<p>Is there a clean solution for this?</p>\n"}, {"tags": ["go", "dns"], "comments": [{"owner": {"reputation": 5548, "user_id": 4625526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6378aa788195a771461c5043057e2ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Norbert van Nobelen", "link": "https://stackoverflow.com/users/4625526/norbert-van-nobelen"}, "edited": false, "score": 0, "creation_date": 1543771856, "post_id": 53582637, "comment_id": 94028920, "body": "There is a different line in the first if statement. Look at <code>addrs = lookupStaticHost(name)</code> vs <code>addrs = goLookupIPFiles(name)</code>"}, {"owner": {"reputation": 347, "user_id": 3839186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d48a13cfa5e9e411f5493819eb03d81?s=128&d=identicon&r=PG", "display_name": "cherrot", "link": "https://stackoverflow.com/users/3839186/cherrot"}, "reply_to_user": {"reputation": 5548, "user_id": 4625526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6378aa788195a771461c5043057e2ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Norbert van Nobelen", "link": "https://stackoverflow.com/users/4625526/norbert-van-nobelen"}, "edited": false, "score": 0, "creation_date": 1543823870, "post_id": 53582637, "comment_id": 94042273, "body": "goLookupIPFiles invokes lookupStaticHost, it only adds some format converting stuff."}], "owner": {"reputation": 347, "user_id": 3839186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d48a13cfa5e9e411f5493819eb03d81?s=128&d=identicon&r=PG", "display_name": "cherrot", "link": "https://stackoverflow.com/users/3839186/cherrot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543843725, "creation_date": 1543770639, "last_edit_date": 1543843725, "question_id": 53582637, "link": "https://stackoverflow.com/questions/53582637/why-go-queries-etc-hosts-twice-in-a-name-resolution", "title": "Why Go queries /etc/hosts twice in a name resolution?", "body": "<p>Recently I am reading source code of <code>net</code> package of Go. When I was diving into the name resolution part, it looked like Go had queried <code>/etc/hosts</code> twice:</p>\n\n<p>First in <code>net/dnsclient_unix.go</code><a href=\"https://github.com/golang/go/blob/9e277f7d554455e16ba3762541c53e9bfc1d8188/src/net/dnsclient_unix.go#L518-L524\" rel=\"nofollow noreferrer\">goLookupHostOrder</a>:</p>\n\n<pre><code>func (r *Resolver) goLookupHostOrder(ctx context.Context, name string, order hostLookupOrder) (addrs []string, err error) {\n    if order == hostLookupFilesDNS || order == hostLookupFiles {\n        // Use entries from /etc/hosts if they match.\n        addrs = lookupStaticHost(name)\n        if len(addrs) &gt; 0 || order == hostLookupFiles {\n            return\n        }   \n    }   \n    ips, _, err := r.goLookupIPCNAMEOrder(ctx, name, order)\n</code></pre>\n\n<p>Then in <a href=\"https://github.com/golang/go/blob/9e277f7d554455e16ba3762541c53e9bfc1d8188/src/net/dnsclient_unix.go#L558-L563\" rel=\"nofollow noreferrer\">goLookupIPCNAMEOrder</a>:</p>\n\n<pre><code>func (r *Resolver) goLookupIPCNAMEOrder(ctx context.Context, name string, order hostLookupOrder) (addrs []IPAddr, cname dnsmessage.Name, err error) {\n    if order == hostLookupFilesDNS || order == hostLookupFiles {\n        // goLookupIPFiles invokes lookupStaticHost internally.\n        addrs = goLookupIPFiles(name)\n        if len(addrs) &gt; 0 || order == hostLookupFiles {\n            return addrs, dnsmessage.Name{}, nil\n        } \n    } \n</code></pre>\n\n<p>So is this a bug? Or It does have some reason but not documented?</p>\n"}, {"tags": ["json", "api", "go", "spotify"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1543760180, "post_id": 53580927, "comment_id": 94025502, "body": "Start by printing the error of <code>authorized, _ := spot.Authorize()</code> instead of throwing it away, it might tell you what&#39;s wrong."}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1543762015, "post_id": 53580927, "comment_id": 94026026, "body": "You are giving too much information in your URL. It is really supposed to be an endpoint. If you read the package&#39;s code, you&#39;ll see that they take the endpoint you give and prepend it with the <code>BASE_URL</code> and <code>API_VERSION</code>. Also, take the previous advice and stop ignoring errors. They are there for a reason."}, {"owner": {"reputation": 31, "user_id": 7801967, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QQrKWZ6xsog/AAAAAAAAAAI/AAAAAAAAAJw/xf_DTH7Q9Zw/photo.jpg?sz=128", "display_name": "Rana ", "link": "https://stackoverflow.com/users/7801967/rana"}, "edited": false, "score": 0, "creation_date": 1543762445, "post_id": 53580927, "comment_id": 94026151, "body": "Thanks a lot for the help I actually found out I&#39;m giving the http spotify api link to the string when I shouldn&#39;t. It now worked but the problem is it is returning a JSON file and it&#39;s my first time parsing JSON and it is not working do you know how can I print JSON as a first step before parsing it? I will update my code"}], "answers": [{"tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": true, "score": 3, "last_activity_date": 1543763501, "creation_date": 1543763501, "answer_id": 53581555, "question_id": 53580927, "link": "https://stackoverflow.com/questions/53580927/i-am-trying-to-print-json-in-go/53581555#53581555", "title": "I am trying to print JSON in go", "body": "<p>If you are getting a load of numbers as a JSON body instead of text then probably it's an array of byte instead of a string.  To fix this, convert to string</p>\n\n<pre><code>response, _ := spot.Get(s, nil)\n    fmt.Println(string(response))\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7801967, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QQrKWZ6xsog/AAAAAAAAAAI/AAAAAAAAAJw/xf_DTH7Q9Zw/photo.jpg?sz=128", "display_name": "Rana ", "link": "https://stackoverflow.com/users/7801967/rana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2609, "favorite_count": 1, "accepted_answer_id": 53581555, "answer_count": 1, "score": 0, "last_activity_date": 1543776124, "creation_date": 1543758858, "last_edit_date": 1543776124, "question_id": 53580927, "link": "https://stackoverflow.com/questions/53580927/i-am-trying-to-print-json-in-go", "title": "I am trying to print JSON in go", "body": "<p>How can I print JSON? when I print I keep on getting random numbers in an array is there a way to print JSON instead of parsing it?\nHere's the function in the main.go</p>\n\n<pre><code> func sendpostget(word string) {\n\n// Create a new spotify object\nspot := spotify.New(\"number\", \"number\")\n\n// Authorize against Spotify first\nauthorized, _ := spot.Authorize()\nif authorized {\n\n    // If we ere able to authorize then Get a simple album\n    //  s := join(\"artists/\", phone)\n    s := \"artists/xxxx/albums?market=ES&amp;limit=2\"\n    fmt.Println(s)\n    response, _ := spot.Get(s, nil)\n    fmt.Println(response)\n\n}\n\n// Parse response to a JSON Object and\n\n }\n</code></pre>\n\n<p>Here is the struct that I am using ( this get method will retrieve an artists' album from spotify API ) </p>\n\n<pre><code>type Albums struct {\n    Albums []Album `json:\"users\"`\n}\n\n    type Album struct {\n    AlbumType string `json:\"album_type\"`\n    Href      string `json:\"href\"`\n    ID        string `json:\"id\"`\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1543757611, "post_id": 53580523, "comment_id": 94024901, "body": "can you clarify how exactly you got these results?"}], "answers": [{"comments": [{"owner": {"reputation": 2194, "user_id": 1882337, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/1277fbda92daa0e7164912dcb1b8b50e?s=128&d=identicon&r=PG", "display_name": "Wessel van der Linden", "link": "https://stackoverflow.com/users/1882337/wessel-van-der-linden"}, "edited": false, "score": 0, "creation_date": 1543759095, "post_id": 53580783, "comment_id": 94025243, "body": "wow yeah you&#39;re right, I should have used a benchmark. I&#39;ve never done benchmarking before and I thought a simple time diff could do the job. So thanks for your answer! It&#39;s much better :)"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1543758516, "last_edit_date": 1543758516, "creation_date": 1543757821, "answer_id": 53580783, "question_id": 53580523, "link": "https://stackoverflow.com/questions/53580523/compiled-binary-slower-than-running-go-run/53580783#53580783", "title": "Compiled binary slower than running &quot;go run&quot;", "body": "<blockquote>\n  <p><strong>Stack Overflow</strong></p>\n  \n  <p>Questions seeking debugging help (\"why isn't this code working?\") must\n  include the desired behavior, a specific problem or error and the\n  shortest code necessary to reproduce it in the question itself.</p>\n</blockquote>\n\n<hr>\n\n<p>Your benchmark is invalid. It's incomplete. It's not reproducible.</p>\n\n<hr>\n\n<p>In Go, use the <code>testing</code> package to benchmark code. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"math/rand\"\n    \"testing\"\n)\n\nfunc findFirstDoubleFrequency(freqs []int) int {\n    seen := map[int]bool{0: true}\n    freq := 0\n\n    for {\n        for _, f := range freqs {\n            freq += f\n\n            if seen[freq] == true {\n                return freq\n            }\n\n            seen[freq] = true\n        }\n    }\n}\n\nfunc BenchmarkFirstFrequency(b *testing.B) {\n    freqs := make([]int, 1000)\n    for i := range freqs {\n        freqs[i] = rand.Intn(len(freqs)/10)\n    }\n    b.ReportAllocs()\n    b.ResetTimer()\n    for N := 0; N &lt; b.N; N++ {\n        findFirstDoubleFrequency(freqs)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go test t94_test.go -bench=.\ngoos: linux\ngoarch: amd64\nBenchmarkFirstFrequency-4        1000000    7206 ns/op    3342 B/op    16 allocs/op\n$ \n</code></pre>\n\n<hr>\n\n<p><strong>WARNING</strong>: You have a possibly infinite loop:</p>\n\n<pre><code>package main\n\nimport (\n    \"math/rand\"\n    \"testing\"\n)\n\nfunc findFirstDoubleFrequency(freqs []int) int {\n    seen := map[int]bool{0: true}\n    freq := 0\n\n    for {\n        for _, f := range freqs {\n            freq += f\n\n            if seen[freq] == true {\n                return freq\n            }\n\n            seen[freq] = true\n        }\n    }\n}\n\nfunc BenchmarkFirstFrequency(b *testing.B) {\n    freqs := make([]int, 1000)\n    for i := range freqs {\n        freqs[i] = rand.Intn(len(freqs))\n    }\n    b.ReportAllocs()\n    b.ResetTimer()\n    for N := 0; N &lt; b.N; N++ {\n        findFirstDoubleFrequency(freqs)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go test t94_test.go -bench=.\ngoos: linux\ngoarch: amd64\nBenchmarkFirstFrequency-4       fatal error: runtime: out of memory\n</code></pre>\n"}], "owner": {"reputation": 2194, "user_id": 1882337, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/1277fbda92daa0e7164912dcb1b8b50e?s=128&d=identicon&r=PG", "display_name": "Wessel van der Linden", "link": "https://stackoverflow.com/users/1882337/wessel-van-der-linden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 1, "accepted_answer_id": 53580783, "answer_count": 1, "score": -1, "last_activity_date": 1543758516, "creation_date": 1543756086, "question_id": 53580523, "link": "https://stackoverflow.com/questions/53580523/compiled-binary-slower-than-running-go-run", "title": "Compiled binary slower than running &quot;go run&quot;", "body": "<p>I'm trying to solve the advent of code puzzles (so spoiler alert for those of you who haven't completed day 1), and I encountered something which I can't wrap my head around. </p>\n\n<p>I have a function which generates a list of numbers based on some other list of numbers, and it returns the first number which is encountered for the second time:</p>\n\n<pre><code>func findFirstDoubleFrequency(freqs []int) int {\n    seen := map[int]bool{0: true}\n    freq := 0\n\n    for {\n        for _, f := range freqs {\n            freq += f\n\n            if seen[freq] == true {\n                return freq\n            }\n\n            seen[freq] = true\n        }\n    }\n}\n</code></pre>\n\n<p>When I run my code with <code>go run</code>, the function takes ~15ms to complete. But when I build an executable with <code>go build</code> and run that, it takes ~40ms to complete. I really would like to know why there is such a difference in execution time between those runs. Shouldn't they be the same? Or is something like GC slowing things down with the <code>go build</code> executable?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1543780547, "post_id": 53580656, "comment_id": 94031547, "body": "oh damn, i guess its not possible to change receivers then, but thats nbd"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1543781964, "post_id": 53580656, "comment_id": 94031927, "body": "@AlexanderMills, yes you can, using a <a href=\"https://golang.org/ref/spec#Method_expressions\" rel=\"nofollow noreferrer\">method expression</a>: <code>Handler.Mount</code> has type <code>func(Handler)</code>."}], "tags": [], "owner": {"reputation": 1834, "user_id": 743077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/559b5b7c0d20376d12d6019cf53d85f6?s=128&d=identicon&r=PG&f=1", "display_name": "gatkin", "link": "https://stackoverflow.com/users/743077/gatkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1543756963, "creation_date": 1543756963, "answer_id": 53580656, "question_id": 53580263, "link": "https://stackoverflow.com/questions/53580263/does-go-auto-bind-funcs-to-struct/53580656#53580656", "title": "Does go auto-bind funcs to struct?", "body": "<p>Yes. The Go book refers to this as a method value.</p>\n\n<blockquote>\n  <p>Usually we we select and call a method in the same expression, as in\n  p.Distance(), but it's possible to separate these two operations. The\n  selector p.Distance yields a method value, a function that binds a\n  method (Point.Distance) to a specific receiver value p. This function\n  can then be invoked without a receiver value; it needs only the\n  non-receiver arguments.</p>\n</blockquote>\n\n<p>(Source: The Go Programming Language, Donovan and Kernighan, page 164.)</p>\n"}], "owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 53580656, "answer_count": 1, "score": 0, "last_activity_date": 1543756963, "creation_date": 1543754068, "question_id": 53580263, "link": "https://stackoverflow.com/questions/53580263/does-go-auto-bind-funcs-to-struct", "title": "Does go auto-bind funcs to struct?", "body": "<p>Say I have this:</p>\n\n<pre><code>type Handler struct{}\n\nfunc helper(f func()){\n   f() // calls h.Mount() or just Mount() w/o reference to h?\n}\n\nfunc (h Handler) Mount() {}\n\nfunc init(){\n  h:=Handler{}\n  helper(h.Mount)\n}\n</code></pre>\n\n<p>when the helper func receives h.Mount (a func), can it call it directly, or does it need a reference to the handler h, to call it properly? This compiles and runs as is so idk.</p>\n"}, {"tags": ["json", "go", "go-iris"], "comments": [{"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1543756740, "post_id": 53580261, "comment_id": 94024663, "body": "<a href=\"https://gist.github.com/aodin/9493190\" rel=\"nofollow noreferrer\">gist.github.com/aodin/9493190</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "is_accepted": false, "score": 2, "last_activity_date": 1543757537, "creation_date": 1543757537, "answer_id": 53580738, "question_id": 53580261, "link": "https://stackoverflow.com/questions/53580261/how-to-parse-json-post-request/53580738#53580738", "title": "How to parse json post request", "body": "<p>GO is different from PHP and JS.\nInstead of being easy to use it is focused on being explicit and reliable.</p>\n\n<p>To parse JSON body in request we should have strong type struct definition to describe structure that receives payload. That is how we can control fields that should be supported. It is important as every filed has its own type and parsing fails if string from request does not match that type. </p>\n\n<pre><code>type RequestBody struct {\n    User   User  `json:\"user\"`\n    Profile Profile `json:\"profile\"`\n}\n\ntype User struct {\n    UserName   string  `json:\"username\"`\n    Password string `json:\"password\"`\n}\n\ntype Profile struct {\n    FirstName   string  `json:\"firstname\"`\n    LastName string `json:\"lastname\"`\n    Files []string `json:\"files\"`\n}\n\n\nfunc (h handler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    decoder := json.NewDecoder(r.Body)\n    var req RequestBody\n    err := decoder.Decode(&amp;req)\n    if err != nil {\n        // log error and return 400 to caller\n        return\n    }\n\n    // Use req\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 301, "user_id": 1636320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f33f92d2d79e17cbe82dc485437ab9?s=128&d=identicon&r=PG", "display_name": "morteza khadem", "link": "https://stackoverflow.com/users/1636320/morteza-khadem"}, "is_accepted": false, "score": -1, "last_activity_date": 1543847068, "creation_date": 1543847068, "answer_id": 53595755, "question_id": 53580261, "link": "https://stackoverflow.com/questions/53580261/how-to-parse-json-post-request/53595755#53595755", "title": "How to parse json post request", "body": "<p>If use iris framework,you can use ReadJSON function like this:</p>\n\n<pre><code>func serve(context context.Context){\n    var request map[string]interface{}\n    context.ReadJSON(request)\n    username:=request[\"user\"].(map[string]string)[\"username\"]\n    fmt.Println(username)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 301, "user_id": 1636320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f33f92d2d79e17cbe82dc485437ab9?s=128&d=identicon&r=PG", "display_name": "morteza khadem", "link": "https://stackoverflow.com/users/1636320/morteza-khadem"}, "is_accepted": true, "score": 0, "last_activity_date": 1544081249, "creation_date": 1544081249, "answer_id": 53646464, "question_id": 53580261, "link": "https://stackoverflow.com/questions/53580261/how-to-parse-json-post-request/53646464#53646464", "title": "How to parse json post request", "body": "<p>Now i use this code:</p>\n\n<pre><code>type Merchant struct{}\n\nfunc (*Merchant) Register(context context.Context){\n    type registerRequestData struct{\n        Merchant models.MrtMerchant `json:\"merchant\"`\n        User models2.UsrUser `json:\"user\"`\n        Profile models2.UsrUserProfile `json:\"profile\"`\n        Branch models.MrtMerchantBranch `json:\"branch\"`\n    }\n    var request registerRequestData\n    if err:=context.ReadJSON(&amp;request);err!=nil{\n        panic(err)\n    }\n\n    fmt.Printf(\"%+v\\n\",request)\n}\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 1636320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f33f92d2d79e17cbe82dc485437ab9?s=128&d=identicon&r=PG", "display_name": "morteza khadem", "link": "https://stackoverflow.com/users/1636320/morteza-khadem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1093, "favorite_count": 0, "accepted_answer_id": 53646464, "answer_count": 3, "score": -1, "last_activity_date": 1544081249, "creation_date": 1543754057, "question_id": 53580261, "link": "https://stackoverflow.com/questions/53580261/how-to-parse-json-post-request", "title": "How to parse json post request", "body": "<p>I want to post json data to Go api, But i can't parse json in Go</p>\n\n<p>javascript code:</p>\n\n<pre><code>data= {\"user\":{\"username\":\"admin\",\"password\":\"123\"},\"profile\":{\"firstname\":\"morteza\",\"lastname\":\"khadem\",\"files\":[\"/temp/a.jpg\",\"/temp/b.jpg\"]}}\n\n$.post('/parse-json', data, function () {\n    alert('success');\n});\n</code></pre>\n\n<p>in php get data very simple ($_REQUEST['user']['firstname']) but in Go different</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-lambda", "aws-sam-cli"], "comments": [{"owner": {"reputation": 1641, "user_id": 7452905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPuWs.jpg?s=128&g=1", "display_name": "varnit", "link": "https://stackoverflow.com/users/7452905/varnit"}, "edited": false, "score": 0, "creation_date": 1543749510, "post_id": 53579635, "comment_id": 94022853, "body": "can you share the code and explain your use case with more details ?"}, {"owner": {"reputation": 73, "user_id": 8357210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1546590962064463/picture?type=large", "display_name": "Traqn Raykovski", "link": "https://stackoverflow.com/users/8357210/traqn-raykovski"}, "reply_to_user": {"reputation": 1641, "user_id": 7452905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPuWs.jpg?s=128&g=1", "display_name": "varnit", "link": "https://stackoverflow.com/users/7452905/varnit"}, "edited": false, "score": 0, "creation_date": 1543752448, "post_id": 53579635, "comment_id": 94023587, "body": "Yes, I added a pastebin link since the code is too mush."}, {"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1543757915, "post_id": 53579635, "comment_id": 94024980, "body": "<code>still I have to run it multiple times, almost simultaneously</code> - these can cause <code>cold start</code> for new containers   <a href=\"https://medium.com/thundra/dealing-with-cold-starts-in-aws-lambda-a5e3aa8f532\" rel=\"nofollow noreferrer\">medium.com/thundra/&hellip;</a>"}, {"owner": {"reputation": 73, "user_id": 8357210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1546590962064463/picture?type=large", "display_name": "Traqn Raykovski", "link": "https://stackoverflow.com/users/8357210/traqn-raykovski"}, "reply_to_user": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1543762027, "post_id": 53579635, "comment_id": 94026029, "body": "@DmitryHarnitski The function is actually executed (yes with small delay), but it is not sent properly. Sometimes everything is OK but with larger payloads it takes much time and times out. Is there a configuration of the throughput? And thank you for the information about the cold start. Much appreciated."}, {"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 1, "creation_date": 1543763320, "post_id": 53579635, "comment_id": 94026428, "body": "it is hard to say because you have too many moving parts in your project. but try this -  1) check if you close all resources after use 2) Increase allocated ram and cpu for your lambda"}, {"owner": {"reputation": 73, "user_id": 8357210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1546590962064463/picture?type=large", "display_name": "Traqn Raykovski", "link": "https://stackoverflow.com/users/8357210/traqn-raykovski"}, "edited": false, "score": 0, "creation_date": 1543765706, "post_id": 53579635, "comment_id": 94027138, "body": "allocating more ram, thus more CPU power, doesn&#39;t affect it. And I am not so sure what &quot;close all resources&quot; means. Does it mean something like <code>defer file.Close()</code> or something about docker."}], "owner": {"reputation": 73, "user_id": 8357210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1546590962064463/picture?type=large", "display_name": "Traqn Raykovski", "link": "https://stackoverflow.com/users/8357210/traqn-raykovski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 714, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1544988161, "creation_date": 1543748928, "last_edit_date": 1544988161, "question_id": 53579635, "link": "https://stackoverflow.com/questions/53579635/aws-sam-cli-times-out", "title": "AWS SAM CLI times out", "body": "<p>I am creating a handler in AWS lambda that returns a file for my Single Page Application(SPA). The function runs fast (couple of ms).But still I have to run it multiple times, almost simultaneously, and then they timeout. My timeout is 60 seconds. I think that has something to do with docker but I am not so sure. Is there something I can do?</p>\n\n<p>Here is my code:<code>pastebin.com/TdqAu3Gx</code>! Even with other functions it takes mush more time to get the response, compared to the execution time.</p>\n\n<h1>EDIT:</h1>\n\n<p>After some time I published the front-end on Netlify. But after making some functions I encountered the same bug. The fowoling code works in aws sam local.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/aws/aws-lambda-go/events\"\n\n    \"github.com/aws/aws-lambda-go/lambda\"\n)\n\ntype MyReq struct {\n    Username string `json:\"username\"`\n}\n\nfunc handler(m events.APIGatewayProxyRequest) (events.APIGatewayProxyResponse, error) {\n    // log.Println(m.Username)\n\n    fmt.Println(\"\\n\\n\", m.Body, \"\\n\\n\")\n    return events.APIGatewayProxyResponse{\n        Body: m.Body,\n    }, nil\n}\nfunc main() {\n    lambda.Start(handler)\n}\n</code></pre>\n\n<p>But does not work in the real was lambda. (It works but I get the full json as text for exaple headers are not set on response, but i can see them as text in the body). If I change <code>events.APIGatewayProxyResponse</code> and <code>events.APIGatewayProxyRequest</code> to <code>MyRequest</code> and a string respectively it works in lambda but timeouts in sam local. In my <code>template.json</code> under <code>Resources</code> I have :</p>\n\n<pre><code>\"TestFunction\": {\n        \"Type\": \"AWS::Serverless::Function\",\n        \"Properties\": {\n            \"CodeUri\": \"MY_BUCKET\",\n            \"Handler\": \"testf\",\n            \"Role\": \"My Lambda role\",\n            \"Events\": {\n                \"RegisterEvent\": {\n                    \"Type\": \"Api\",\n                    \"Properties\": {\n                        \"Path\": \"/testf\",\n                        \"Method\": \"POST\"\n                    }\n                }\n            }\n        }\n    }\n</code></pre>\n\n<p>How can I make the code work both on AWS Lambda and SAM Local? If someone has a working template of a sam app that works both on SAM and AWS and can open source it, I would be very thankful.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 1, "creation_date": 1543996860, "post_id": 53579628, "comment_id": 94115034, "body": "Just to be clear, Go does not support &#39;casting&#39; in the way that other languages mean it (e.g. C++). The title implies something impossible. However, it <i>is</i> possible to achieve what you&#39;re seeking by other means."}], "answers": [{"comments": [{"owner": {"reputation": 7035, "user_id": 2945958, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/K4Ig3.jpg?s=128&g=1", "display_name": "Mostafa Talebi", "link": "https://stackoverflow.com/users/2945958/mostafa-talebi"}, "edited": false, "score": 0, "creation_date": 1543752888, "post_id": 53580007, "comment_id": 94023681, "body": "So it is useless to put anything inside JSON file. Because I wanted to have one single point of change for my routes. With you solution, I need to change two places when I want to add a new endpoint &amp; handler."}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "reply_to_user": {"reputation": 7035, "user_id": 2945958, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/K4Ig3.jpg?s=128&g=1", "display_name": "Mostafa Talebi", "link": "https://stackoverflow.com/users/2945958/mostafa-talebi"}, "edited": false, "score": 0, "creation_date": 1543754614, "post_id": 53580007, "comment_id": 94024100, "body": "You could write out the lookup table as JSON from the Go program instead of consuming it"}, {"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1543758120, "post_id": 53580007, "comment_id": 94025028, "body": "This sample contains hardcoded mapping. You can use reflection to map input to functions dynamically."}], "tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": false, "score": 2, "last_activity_date": 1543752362, "last_edit_date": 1543752362, "creation_date": 1543752035, "answer_id": 53580007, "question_id": 53579628, "link": "https://stackoverflow.com/questions/53579628/casting-a-string-to-a-func-type-in-golang/53580007#53580007", "title": "Casting a string to a func type in GoLang", "body": "<p>establish a mapping between the keys in the json file and the functions, then use that to call the functions as they appear in the json </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc AddStudents() {\n    fmt.Println(\"woo\")\n}\n\nfunc ShowStudents() {\n    fmt.Println(\"lots of students\")\n}\n\nfunc main() {\n    js := `{\n  \"students/show\" : \"ShowStudents\",\n  \"students/add\" : \"AddStudents\"\n}`\n\n    lookup := make(map[string]string)\n    json.Unmarshal([]byte(js), &amp;lookup)\n    dispatch := make(map[string]func())\n    dispatch[\"students/show\"] = ShowStudents\n    dispatch[\"students/add\"] = AddStudents\n\n    for v, _ := range lookup {\n        print(v)\n        dispatch[v]()\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 6004683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b889f8adbb1169a263d40632ac908b8e?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Patel", "link": "https://stackoverflow.com/users/6004683/himanshu-patel"}, "is_accepted": true, "score": 2, "last_activity_date": 1543759652, "creation_date": 1543759652, "answer_id": 53581031, "question_id": 53579628, "link": "https://stackoverflow.com/questions/53579628/casting-a-string-to-a-func-type-in-golang/53581031#53581031", "title": "Casting a string to a func type in GoLang", "body": "<p>Your task can be broken down into two steps:</p>\n\n<ol>\n<li>Extract function names</li>\n<li>Run those functions (assuming that they are defined somewhere)</li>\n</ol>\n\n<p>For step 1, I would unmarshal the JSON into a map[string]string, something like this:</p>\n\n<pre><code>b, err := ioutil.ReadFile(fname)\nmp := make(map[string]string)\njson.Unmarshal(b, &amp;mp)\n</code></pre>\n\n<p>Coming to Step 2. In Go, it's not possible to convert <code>string</code> directly to a function call, but it is possible to enumerate the methods of an object using <code>reflect</code> package. This can be used as a workaround in this case. Instead of writing those functions directly, bind them to a dummy type, something like this:</p>\n\n<pre><code>type T int\n\nfunc (t T) ShowStudents() {\n    fmt.Println(\"Showing Students\")\n}\n\nfunc (t T) AddStudents() {\n    fmt.Println(\"Adding Students\")\n}\n\nfunc main() {\n    var t T\n    reflect.ValueOf(t).MethodByName(\"ShowStudents\").Call(nil)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/utpswJP-ET0\" rel=\"nofollow noreferrer\">Run this example</a></p>\n"}], "owner": {"reputation": 7035, "user_id": 2945958, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/K4Ig3.jpg?s=128&g=1", "display_name": "Mostafa Talebi", "link": "https://stackoverflow.com/users/2945958/mostafa-talebi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 53581031, "answer_count": 2, "score": 1, "last_activity_date": 1543759652, "creation_date": 1543748873, "question_id": 53579628, "link": "https://stackoverflow.com/questions/53579628/casting-a-string-to-a-func-type-in-golang", "title": "Casting a string to a func type in GoLang", "body": "<p>I have a string which is the name of a function in GoLang.\nI want to treat them as function. How should I do this? I tried to achieve it through reflect.* but I didn't find a valid path for my purpose.</p>\n\n<p>I get the name fo handlers in a JSON file, and I want to execute those handlers. Something like this:</p>\n\n<pre><code>{\n  \"students/show\" : \"ShowStudents\",\n  \"students/add\" : \"AddStudents\"\n}\n</code></pre>\n\n<p>Then I want to execute <code>ShowStudents()</code>, but don't know how to treat it like a variable of type <code>func</code></p>\n"}, {"tags": ["elasticsearch", "go"], "answers": [{"tags": [], "owner": {"reputation": 6077, "user_id": 1136371, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6288e34200a8b3b7d8a5126aea916411?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant", "link": "https://stackoverflow.com/users/1136371/nishant"}, "is_accepted": true, "score": 2, "last_activity_date": 1543738376, "last_edit_date": 1543738376, "creation_date": 1543737696, "answer_id": 53578463, "question_id": 53578367, "link": "https://stackoverflow.com/questions/53578367/no-handler-for-type-keyword-declared-on-field-elasticsearch-6-4-3/53578463#53578463", "title": "No Handler for Type Keyword declared on Field ElasticSearch 6.4.3", "body": "<p>You have misspelled <code>\"keyword\"</code> as <code>\"keyowrd\"</code> for <code>\"message\"</code> field. Corrected below:</p>\n\n<pre><code>{\n        \"mappings\" : {\n            \"log\" : {\n                \"properties\" : {\n                    \"app\" : { \"type\" : \"keyword\" },\n                    \"message\" : { \"type\" : \"keyword\" },\n                    \"time\" : { \"type\" : \"date\" }\n                }\n            }\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10661518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58583209fdfa41f3bb07909abbabe9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Honddoe ", "link": "https://stackoverflow.com/users/10661518/honddoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 625, "favorite_count": 0, "accepted_answer_id": 53578463, "answer_count": 1, "score": -1, "last_activity_date": 1543738376, "creation_date": 1543736587, "question_id": 53578367, "link": "https://stackoverflow.com/questions/53578367/no-handler-for-type-keyword-declared-on-field-elasticsearch-6-4-3", "title": "No Handler for Type Keyword declared on Field ElasticSearch 6.4.3", "body": "<p>I wonder what the cause is. This is the code </p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"errors\"\n    \"fmt\"\n    \"time\"\n\n    \"github.com/olivere/elastic\"\n)\n\nconst (\n    indexName    = \"applications\"\n    docType      = \"log\"\n    appName      = \"myApp\"\n    indexMapping = `{\n        \"mappings\" : {\n            \"log\" : {\n                \"properties\" : {\n                    \"app\" : { \"type\" : \"keyword\" },\n                    \"message\" : { \"type\" : \"keyowrd\" },\n                    \"time\" : { \"type\" : \"date\" }\n                }\n            }\n        }\n    }`\n)\n\ntype Log struct {\n    App     string    `json:\"app\"`\n    Message string    `json:\"message\"`\n    Time    time.Time `json:\"time\"`\n}\n\nfunc main() {\n\n    client, err := elastic.NewClient(elastic.SetURL(\"http://localhost:9200\"))\n\n    if err != nil {\n        panic(err)\n    }\n\n    err = createIndexWithLogs(client)\n    if err != nil {\n        panic(err)\n    }\n\n    // err = findAndPrintAppLogs(client)\n    // if err != nil {\n    //  panic(err)\n    // }\n\n}\n</code></pre>\n\n<p>I received an error, No Handler for Type Keyword declared on Field ElasticSearch 6.4.3. Based on the information that I got, ES 6.4.3 should use type keyword. I have no idea that my code is not working. </p>\n\n<p>Does anyone know what the mistake is? </p>\n\n<p>Thanks </p>\n"}, {"tags": ["go", "syntax", "functional-programming"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1543732312, "post_id": 53577949, "comment_id": 94019704, "body": "When googling for punctuation, it helps to spell it out. I found the duplicate by searching &quot;go dot parentheses&quot;."}, {"owner": {"reputation": 3751, "user_id": 6792646, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/90c3356d59254bbb5b4464ee3524294e?s=128&d=identicon&r=PG", "display_name": "Daksh Miglani", "link": "https://stackoverflow.com/users/6792646/daksh-miglani"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1543732352, "post_id": 53577949, "comment_id": 94019709, "body": "@sepp2k oh okay. I&#39;ll use that next time. thanks for the tip!"}], "answers": [{"tags": [], "owner": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "is_accepted": false, "score": 2, "last_activity_date": 1543732189, "creation_date": 1543732189, "answer_id": 53577967, "question_id": 53577949, "link": "https://stackoverflow.com/questions/53577949/what-does-i-string-actually-mean-in-golang-syntax/53577967#53577967", "title": "What does &quot;i.(string)&quot; actually mean in golang syntax?", "body": "<p><code>i.(string)</code> means converting <code>i</code>(<code>interface{}</code> type) to <code>string</code> type.</p>\n"}, {"tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 9, "last_activity_date": 1543732199, "creation_date": 1543732199, "answer_id": 53577970, "question_id": 53577949, "link": "https://stackoverflow.com/questions/53577949/what-does-i-string-actually-mean-in-golang-syntax/53577970#53577970", "title": "What does &quot;i.(string)&quot; actually mean in golang syntax?", "body": "<p><code>i.(string)</code> casts (or attempts at least) <code>i</code> (type <code>interface{}</code>) to type <code>string</code>. I say attempts because say <code>i</code> is an <code>int</code> instead, this will panic. If that doesn't sound great to you, then you could change the syntax to</p>\n\n<pre><code>x, ok := i.(string)\n</code></pre>\n\n<p>In this case if <code>i</code> is not a <code>string</code>, then <code>ok</code> will be <code>false</code> and the code won't panic.</p>\n"}], "owner": {"reputation": 3751, "user_id": 6792646, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/90c3356d59254bbb5b4464ee3524294e?s=128&d=identicon&r=PG", "display_name": "Daksh Miglani", "link": "https://stackoverflow.com/users/6792646/daksh-miglani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 646, "favorite_count": 0, "closed_date": 1543738856, "accepted_answer_id": 53577970, "answer_count": 2, "score": 5, "last_activity_date": 1543732199, "creation_date": 1543731978, "question_id": 53577949, "link": "https://stackoverflow.com/questions/53577949/what-does-i-string-actually-mean-in-golang-syntax", "closed_reason": "Duplicate", "title": "What does &quot;i.(string)&quot; actually mean in golang syntax?", "body": "<p>I recently started looking for functional go examples and I found this function:</p>\n\n<pre><code>mapper := func (i interface{}) interface{} {\n    return strings.ToUpper(i.(string))\n}\nMap(mapper, New(\u201cmilu\u201d, \u201crantanplan\u201d))\n//[\u201cMILU\u201d, \u201cRANTANPLAN\u201d]\n</code></pre>\n\n<p>Now in this function, as you can see the <code>return</code> value of mapper is:\n<code>strings.ToUpper(i.(string))</code>.</p>\n\n<p>But, what does this <code>i.(string)</code> syntax mean? I tried searching, but didn't find anything particularly useful.</p>\n"}, {"tags": ["go", "go-http"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "edited": false, "score": 0, "creation_date": 1543727973, "post_id": 53577614, "comment_id": 94019150, "body": "my only guess is that the core http or gorilla/mux lib magically adds that utility method after <code>http.HandlerFunc</code> gets returned to <code>router.HandleFunc</code>"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1543733592, "post_id": 53577614, "comment_id": 94019886, "body": "I was not a fan of this adding function methods to a function pointer trick when I discovered it several years ago. Yes it is clever and all but I think it&#39;s confusing."}], "answers": [{"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 4, "last_activity_date": 1543913130, "last_edit_date": 1543913130, "creation_date": 1543728312, "answer_id": 53577664, "question_id": 53577614, "link": "https://stackoverflow.com/questions/53577614/where-does-the-servehttp-utility-come-from-on-supposedly-naked-func/53577664#53577664", "title": "Where does the serveHTTP utility come from on supposedly naked func", "body": "<p>The <a href=\"https://golang.org/pkg/net/http/#HandlerFunc\" rel=\"nofollow noreferrer\">http.HandlerFunc</a> is a type represent <code>func(ResponseWriter, *Request)</code>. </p>\n\n<p>The difference between <code>http.HandlerFunc</code> and <code>func(ResponseWriter, *Request)</code> is: <code>http.HandlerFunc</code> type has method called <code>ServeHTTP()</code>.</p>\n\n<p>From the <a href=\"https://golang.org/src/net/http/server.go?s=59707:59754#L1950\" rel=\"nofollow noreferrer\">source code</a>:</p>\n\n<pre><code>// The HandlerFunc type is an adapter to allow the use of\n// ordinary functions as HTTP handlers. If f is a function\n// with the appropriate signature, HandlerFunc(f) is a\n// Handler that calls f.\ntype HandlerFunc func(ResponseWriter, *Request)\n\n// ServeHTTP calls f(w, r).\nfunc (f HandlerFunc) ServeHTTP(w ResponseWriter, r *Request) {\n    f(w, r)\n}\n</code></pre>\n\n<hr>\n\n<p>The <code>http.HandlerFunc()</code> can be used to wrap handler function.</p>\n\n<pre><code>func Something(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        // do something\n\n        next.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n\n<p>The wrapped handler will have <code>http.HandlerFunc()</code> type, meaning we'll be able to access it's <code>.ServeHTTP()</code> method.</p>\n\n<hr>\n\n<p>There is also another type, an interface called <a href=\"https://golang.org/pkg/net/http/#Handler\" rel=\"nofollow noreferrer\">http.Handler</a>. It has <code>.ServeHTTP()</code> method signature, and it must be implemented on the struct where the interface is being embedded.</p>\n\n<pre><code>type Handler interface {\n    ServeHTTP(ResponseWriter, *Request)\n}\n</code></pre>\n\n<p>As you can see on <code>Something()</code> function above, a return value in <code>http.Handler</code> type is required, but we returned a handler wrapped in <code>http.HandlerFunc()</code>. It's fine, because the <code>http.HandlerFunc</code> has method <code>.ServeHTTP()</code> who fulfil the requirement of <code>http.Handler</code> interface.</p>\n\n<hr>\n\n<blockquote>\n  <p>In other words, why I am I calling <code>h.ServeHTTP(w,r)</code> instead of <code>h(w,r)</code>?</p>\n</blockquote>\n\n<p>Because to continue serve the incoming request, you need to call <code>.ServeHTTP()</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1543913130, "creation_date": 1543727758, "question_id": 53577614, "link": "https://stackoverflow.com/questions/53577614/where-does-the-servehttp-utility-come-from-on-supposedly-naked-func", "title": "Where does the serveHTTP utility come from on supposedly naked func", "body": "<p>I have this utility:</p>\n\n<pre><code>type Handler struct{}\n\nfunc (h Handler) Mount(router *mux.Router, v PeopleInjection) {\n    router.HandleFunc(\"/api/v1/people\", h.makeGetMany(v)).Methods(\"GET\")\n}\n</code></pre>\n\n<p>the above calls this:</p>\n\n<pre><code>func (h Handler) makeGetMany(v PeopleInjection) http.HandlerFunc {\n\n    type RespBody struct {}\n\n    type ReqBody struct {\n        Handle string\n    }\n\n    return tc.ExtractType(\n        tc.TypeList{ReqBody{},RespBody{}},\n        func(w http.ResponseWriter, r *http.Request) {\n         // ...\n    })\n}\n</code></pre>\n\n<p>and then <code>tc.ExtractType</code> is like so:</p>\n\n<pre><code>func ExtractType(s TypeList, h http.HandlerFunc) http.HandlerFunc {\n\n    return func(w http.ResponseWriter, r *http.Request) {\n\n        h.ServeHTTP(w, r)  // &lt;&lt;&lt; h is just a func right? so where does ServeHTTP come from?\n    }\n}\n</code></pre>\n\n<p>my question is - where does the serveHTTP method/func come from??</p>\n\n<p>isn't the <code>h</code> parameter just a func with this signature:</p>\n\n<pre><code>func(w http.ResponseWriter, r *http.Request) { ... }\n</code></pre>\n\n<p>so then how does that func have the <code>ServeHTTP</code> func attached to it?</p>\n\n<p>In other words, why I am I calling</p>\n\n<pre><code>h.ServeHTTP(w,r)\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>h(w,r)\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["go", "go-reflect", "go-structtag"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "is_accepted": true, "score": 0, "last_activity_date": 1543725018, "creation_date": 1543725018, "answer_id": 53577409, "question_id": 53577297, "link": "https://stackoverflow.com/questions/53577297/cannot-read-structtag-for-some-reason/53577409#53577409", "title": "Cannot read StructTag for some reason", "body": "<p>ughh I think it needs to be:</p>\n\n<pre><code>    TypeCreatorMeta string `type:\"bar\" tc_resp_body_type:\"true\"` // no comma\n</code></pre>\n\n<p>using a comma like this is not correct?</p>\n\n<pre><code>    TypeCreatorMeta string `type:\"bar\",tc_resp_body_type:\"true\"`\n</code></pre>\n\n<p>can someone confirm?</p>\n"}, {"tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": false, "score": 1, "last_activity_date": 1543725614, "creation_date": 1543725614, "answer_id": 53577453, "question_id": 53577297, "link": "https://stackoverflow.com/questions/53577297/cannot-read-structtag-for-some-reason/53577453#53577453", "title": "Cannot read StructTag for some reason", "body": "<p><code>reflect.StructTag</code> <code>Get()</code> and <code>LookUp()</code> parses using a tag convention defined in <a href=\"https://golang.org/pkg/reflect/#StructTag\" rel=\"nofollow noreferrer\">reflect.StructTag</a></p>\n\n<blockquote>\n  <p>By convention, tag strings are a concatenation of optionally space-separated key:\"value\" pairs. Each key is a non-empty string consisting of non-control characters other than space (U+0020 ' '), quote (U+0022 '\"'), and colon (U+003A ':'). Each value is quoted using U+0022 '\"' characters and Go string literal syntax.</p>\n</blockquote>\n\n<p>So just change your tags like this:</p>\n\n<pre><code>type RespBody struct {\n    TypeCreatorMeta string `type:\"bar\" tc_resp_body_type:\"true\"`\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 53577409, "answer_count": 2, "score": 1, "last_activity_date": 1543725614, "creation_date": 1543723506, "last_edit_date": 1543724210, "question_id": 53577297, "link": "https://stackoverflow.com/questions/53577297/cannot-read-structtag-for-some-reason", "title": "Cannot read StructTag for some reason", "body": "<p>I have this handler:</p>\n\n<pre><code>func (h Handler) makeGetMany(v PeopleInjection) http.HandlerFunc {\n\n    type RespBody struct {\n        TypeCreatorMeta string `type:\"bar\",tc_resp_body_type:\"true\"`\n    }\n\n    type ReqBody struct {\n        TypeCreatorMeta string `type:\"star\",tc_req_body_type:\"true\"`\n        Handle string\n    }\n\n    return tc.ExtractType(\n        tc.TypeList{ReqBody{},RespBody{}},\n        func(w http.ResponseWriter, r *http.Request) {\n        json.NewEncoder(w).Encode(v.People)\n    })\n}\n</code></pre>\n\n<p>the tc.ExtractType func looks like:</p>\n\n<pre><code>type TypeList = []interface{}\n\nfunc ExtractType(s TypeList, h http.HandlerFunc) http.HandlerFunc {\n\n    m := make(map[string]string)\n\n    for _, v := range s {\n        t := reflect.TypeOf(v)\n        f, _ := t.FieldByName(\"TypeCreatorMeta\")\n        fmt.Println(\"All tags?:\",f.Tag);\n        v, ok := f.Tag.Lookup(\"type\")\n        if !ok {\n            fmt.Println(\"no 'type' tag.\");\n            continue;\n        }\n        for _, key := range []string{\"tc_req_body_type\", \"tc_resp_body_type\"} {\n            _, ok := f.Tag.Lookup(key)\n            fmt.Println(ok,\"key:\",key)   // &lt;&lt;&lt;&lt; important\n            if ok {\n                m[key] = v\n            }\n        }\n    }\n\n    return func(w http.ResponseWriter, r *http.Request) {\n\n        fmt.Printf(\"Req: %s\\n\", r.URL.Path)\n        h.ServeHTTP(w, r)\n    }\n}\n</code></pre>\n\n<p>it's able to find the \"type\" tag, which points to \"star\", but for some reason it's not picking up the \"tc_resp_body_type\" tag which points to \"true\". Here is what I get logged out:</p>\n\n<pre><code>All tags?: type:\"star\",tc_req_body_type:\"true\"\nfalse key: tc_req_body_type\nfalse key: tc_resp_body_type\n</code></pre>\n\n<p>does anyone know why the \"type\" tag can be found, but the \"tc_req_body_type\" cannot be found?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "edited": false, "score": 0, "creation_date": 1543719771, "post_id": 53576943, "comment_id": 94018059, "body": "In Go you have to use imports, or not to declare them at all. It&#39;s not a dumb error, it&#39;s how Go as language behaves. Love it or leave it."}, {"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1543719775, "post_id": 53576943, "comment_id": 94018061, "body": "no. it is by design."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "edited": false, "score": 0, "creation_date": 1543720122, "post_id": 53576943, "comment_id": 94018108, "body": "Go is such a wonderful language lulz"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "edited": false, "score": 0, "creation_date": 1543720176, "post_id": 53576943, "comment_id": 94018120, "body": "Why on earth would it matter if there are unused imports, the compiler should just erase them then, who cares? Just add a warning and compile anyway."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1543721616, "post_id": 53576943, "comment_id": 94018323, "body": "@OlegzandrDenman: By design, the Go compiler doesn&#39;t have warnings."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1543740751, "post_id": 53576943, "comment_id": 94021075, "body": "The authors decided to make this an error to keep compile times small. It is actually really useful for large codebases. It&#39;s a lesson learned from C and C++. For the same reason circular imports are disallowed. Most IDEs and editors can manage imports automatically, either natively or by integrating <a href=\"https://godoc.org/golang.org/x/tools/cmd/goimports\" rel=\"nofollow noreferrer\">goimports</a>, do this really isn&#39;t a problem in practice."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1543741143, "post_id": 53576943, "comment_id": 94021157, "body": "<a href=\"https://golang.org/doc/faq#unused_variables_and_imports\" rel=\"nofollow noreferrer\">golang.org/doc/faq#unused_variables_and_imports</a>"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1543721516, "last_edit_date": 1543721516, "creation_date": 1543721022, "answer_id": 53577067, "question_id": 53576943, "link": "https://stackoverflow.com/questions/53576943/ignore-imported-and-not-used-compile-time-error/53577067#53577067", "title": "Ignore &quot;imported and not used&quot; compile-time error", "body": "<blockquote>\n  <p><a href=\"https://golang.org/doc/install/source#tools\" rel=\"nofollow noreferrer\">Install additional tools</a></p>\n  \n  <p>The source code for several Go tools (including goimports) is kept in the\n  go.tools repository. To install all of them, run the go get command:</p>\n\n<pre><code>$ go get golang.org/x/tools/cmd/...\n</code></pre>\n  \n  <p>Or if you just want to install a specific command (goimports in this\n  case):</p>\n\n<pre><code>$ go get golang.org/x/tools/cmd/goimports\n</code></pre>\n  \n  <p>To install these tools, the go get command requires that Git be\n  installed locally.</p>\n  \n  <p>You must also have a workspace (GOPATH) set up; see <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go\n  Code</a> for the details.</p>\n</blockquote>\n\n<hr>\n\n<pre><code>$ goimports -help\nusage: goimports [flags] [path ...]\n  -cpuprofile string\n        CPU profile output\n  -d    display diffs instead of rewriting files\n  -e    report all errors (not just the first 10 on different lines)\n  -l    list files whose formatting differs from goimport's\n  -local string\n        put imports beginning with this string after 3rd-party packages; comma-separated list\n  -memprofile string\n        memory profile output\n  -memrate int\n        if &gt; 0, sets runtime.MemProfileRate\n  -srcdir dir\n        choose imports as if source code is from dir. When operating on a single file, dir may instead be the complete file name.\n  -trace string\n        trace profile output\n  -v    verbose logging\n  -w    write result to (source) file instead of stdout\n$ \n</code></pre>\n\n<hr>\n\n<p>Run the <code>goimports</code> command with flag <code>-w</code> on your source code. It will fix your imports for you. It's how the Go Playground and IDEs fix imports.</p>\n\n<hr>\n\n<p>For example,</p>\n\n<pre><code>$ cat imports.go\npackage main\n\nimport (\n    \"net/http\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n}\n\n$ goimports -w imports.go\n$ cat imports.go\npackage main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n}\n$ \n</code></pre>\n\n<p>You can run it on an entire directory too.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 724, "favorite_count": 1, "answer_count": 1, "score": -4, "last_activity_date": 1543721516, "creation_date": 1543719572, "question_id": 53576943, "link": "https://stackoverflow.com/questions/53576943/ignore-imported-and-not-used-compile-time-error", "title": "Ignore &quot;imported and not used&quot; compile-time error", "body": "<p>I get this error:</p>\n\n<blockquote>\n  <p>src/huru/utils/utils.go:6:2: imported and not used: \"fmt\"</p>\n  \n  <p>src/huru/utils/utils.go:9:2: imported and not used: \"net/http\"</p>\n</blockquote>\n\n<p>when I have these unused imports:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"net/http\"\n)\n</code></pre>\n\n<blockquote>\n  <p><code>&lt;rant&gt;</code> it turns out this a rather seriously annoying \"feature\" because\n  some IDEs  like VSCode will automatically remove unused imports which\n  is f*cking annoying when you are about type the characters that will\n  use the imports but you hit save first or what not. <code>&lt;/rant&gt;</code></p>\n</blockquote>\n\n<p>Is there a way to ignore this compile error with a command line option?\nsomething like:</p>\n\n<pre><code>go install main --ignore-dumb-errors\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 1, "creation_date": 1543716661, "post_id": 53576718, "comment_id": 94017684, "body": "So if it doesn&#39;t compile, presumably there&#39;s an error message?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "reply_to_user": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1543717232, "post_id": 53576718, "comment_id": 94017755, "body": "syntax error: unexpected newline, expecting comma or )"}], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 937938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ixgsg.jpg?s=128&g=1", "display_name": "Dwayne Robinson", "link": "https://stackoverflow.com/users/937938/dwayne-robinson"}, "edited": false, "score": 0, "creation_date": 1616065828, "post_id": 53576744, "comment_id": 117889245, "body": "Python&#39;s rule for statement termination is simple and avoids dummy trailing commas - so long as the scope is open (that is, the opening parenthesis is not yet closed), then the statement is clearly not terminated yet."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1543720353, "last_edit_date": 1543720353, "creation_date": 1543716730, "answer_id": 53576744, "question_id": 53576718, "link": "https://stackoverflow.com/questions/53576718/closing-parenthesis-on-new-line-does-not-compile/53576744#53576744", "title": "Closing parenthesis on new-line does not compile", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Semicolons\" rel=\"nofollow noreferrer\">Semicolons</a></p>\n  \n  <p>The formal grammar uses semicolons \";\" as terminators in a number of\n  productions. Go programs may omit most of these semicolons using the\n  following two rules:</p>\n  \n  <ol>\n  <li><p>When the input is broken into tokens, a semicolon is automatically inserted into the token stream immediately after a line's final token\n  if that token is</p>\n  \n  <p>. an identifier</p>\n  \n  <p>. an integer, floating-point, imaginary, rune, or string literal</p>\n  \n  <p>. one of the keywords break, continue, fallthrough, or return</p>\n  \n  <p>. one of the operators and punctuation ++, --, ), ], or }</p></li>\n  <li><p>To allow complex statements to occupy a single line, a semicolon may be omitted before a closing \")\" or \"}\".</p></li>\n  </ol>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>syntax error: unexpected newline, expecting comma or )</p>\n</blockquote>\n\n<p>Add the commas at the end of the argument list lines to avoid the automatic insertion of semicolons. </p>\n\n<pre><code>r.Header.Get(\"tc_req_body_type\"), \"expected:\", m[\"request_body\"]}, \" \"),\n) \n\nr.Header.Get(\"tc_req_body_type\"), \" expected: \", m[\"request_body\"]}, \" \"),\n)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 1, "accepted_answer_id": 53576744, "answer_count": 1, "score": 6, "last_activity_date": 1543720353, "creation_date": 1543716367, "question_id": 53576718, "link": "https://stackoverflow.com/questions/53576718/closing-parenthesis-on-new-line-does-not-compile", "title": "Closing parenthesis on new-line does not compile", "body": "<p>This code compiles fine:</p>\n\n<pre><code>return func(w http.ResponseWriter, r *http.Request) {\n\n\n    if r.Header.Get(\"tc_req_body_type\") != m[\"request_body\"] {\n        fmt.Println(\n            strings.Join([]string{\"types are different\", \" actual:\",\n                r.Header.Get(\"tc_req_body_type\"), \"expected:\", m[\"request_body\"]},\" \"))\n    }\n\n    if r.Header.Get(\"tc_resp_body_type\") != m[\"response_body\"] {\n        fmt.Println(\n            strings.Join([]string{\"types are different\", \" actual: \",\n                r.Header.Get(\"tc_req_body_type\"), \" expected: \", m[\"request_body\"]},\" \"))\n    }\n\n\n    fmt.Printf(\"Req: %s\\n\", r.URL.Path)\n\n    h.ServeHTTP(w, r)\n}\n</code></pre>\n\n<p>but if I add a new-line after the last paren in the fmt.Println call:</p>\n\n<pre><code>return func(w http.ResponseWriter, r *http.Request) {\n\n\n    if r.Header.Get(\"tc_req_body_type\") != m[\"request_body\"] {\n        fmt.Println(\n            strings.Join([]string{\"types are different\", \" actual:\",\n                r.Header.Get(\"tc_req_body_type\"), \"expected:\", m[\"request_body\"]},\" \")\n        )  // &lt;&lt;&lt; here\n    }\n\n    if r.Header.Get(\"tc_resp_body_type\") != m[\"response_body\"] {\n        fmt.Println(\n            strings.Join([]string{\"types are different\", \" actual: \",\n                r.Header.Get(\"tc_req_body_type\"), \" expected: \", m[\"request_body\"]},\" \")\n        )  // &lt;&lt;&lt;  here\n    }\n\n\n    fmt.Printf(\"Req: %s\\n\", r.URL.Path)\n\n    h.ServeHTTP(w, r)\n}\n</code></pre>\n\n<p>now it won't compile, what's the reason for this? I added a comment next to difference in the second code sample, also just writing more b/c it said my question had too much code and not enough words thanks.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543739157, "post_id": 53576516, "comment_id": 94020770, "body": "Go doesn&#39;t have 2D arrays. The closest you can get is arrays of arrays."}], "answers": [{"tags": [], "owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "is_accepted": false, "score": 1, "last_activity_date": 1543715286, "last_edit_date": 1543715286, "creation_date": 1543714750, "answer_id": 53576584, "question_id": 53576516, "link": "https://stackoverflow.com/questions/53576516/how-to-create-a-2d-array-based-on-the-length-passed-to-an-array/53576584#53576584", "title": "How to create a 2D array based on the length passed to an array", "body": "<p>You have to allocate the further dimensions individually, like so:</p>\n\n<pre><code>func matrix(n int) {\n    var result = make([][]int, n)\n    for i := range result {\n        result[i] = make([]int, n)\n    }\n    fmt.Println(result)\n}\n</code></pre>\n\n<p>With an actual array with fixed dimensions known at compile-time, you can do something like:</p>\n\n<pre><code>var result [5][5]int\n</code></pre>\n\n<p>but this is not the case you have.</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1543756191, "last_edit_date": 1543756191, "creation_date": 1543715243, "answer_id": 53576626, "question_id": 53576516, "link": "https://stackoverflow.com/questions/53576516/how-to-create-a-2d-array-based-on-the-length-passed-to-an-array/53576626#53576626", "title": "How to create a 2D array based on the length passed to an array", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Array_types\" rel=\"nofollow noreferrer\">Array types</a></p>\n  \n  <p>An array is a numbered sequence of elements of a single type, called\n  the element type. The number of elements is called the length and is\n  never negative.</p>\n\n<pre><code>ArrayType   = \"[\" ArrayLength \"]\" ElementType .\nArrayLength = Expression .\nElementType = Type .\n</code></pre>\n  \n  <p>The length is part of the array's type; it must evaluate to a\n  non-negative constant representable by a value of type int. The length\n  of array a can be discovered using the built-in function len. The\n  elements can be addressed by integer indices 0 through len(a)-1. Array\n  types are always one-dimensional but may be composed to form\n  multi-dimensional types.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>The length is part of the array's type; it must evaluate to a\n  non-negative constant representable by a value of type int.</p>\n</blockquote>\n\n<p>The size of an array is fixed at compile-time.</p>\n\n<hr>\n\n<p>Use a slice instead.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc matrix(n int) [][]int {\n    m := make([][]int, n)\n    for i := range m {\n        m[i] = make([]int, n)\n    }\n    return m\n}\n\nfunc main() {\n    fmt.Println(matrix(3))\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/D1MHmm5KCht\" rel=\"nofollow noreferrer\">https://play.golang.org/p/D1MHmm5KCht</a></p>\n\n<p>Output: </p>\n\n<pre><code>[[0 0 0] [0 0 0] [0 0 0]]\n</code></pre>\n\n<hr>\n"}], "owner": {"reputation": 2244, "user_id": 1797057, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/89339651e138f8c169f4f1dd0fe6261a?s=128&d=identicon&r=PG", "display_name": "Jackal", "link": "https://stackoverflow.com/users/1797057/jackal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 1, "accepted_answer_id": 53576626, "answer_count": 2, "score": 0, "last_activity_date": 1543756191, "creation_date": 1543713696, "last_edit_date": 1543739146, "question_id": 53576516, "link": "https://stackoverflow.com/questions/53576516/how-to-create-a-2d-array-based-on-the-length-passed-to-an-array", "title": "How to create a 2D array based on the length passed to an array", "body": "<pre><code>func matrix(n int) {\n  var result [n][n]int //Does not work\n  fmt.Println(result)\n}\n</code></pre>\n\n<p>How to create a 2D array based on the length passed to an array; n is the length of the array.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "is_accepted": false, "score": 1, "last_activity_date": 1543711890, "last_edit_date": 1543711890, "creation_date": 1543711536, "answer_id": 53576368, "question_id": 53576324, "link": "https://stackoverflow.com/questions/53576324/add-struct-or-pointer-to-struct-to-slice/53576368#53576368", "title": "Add struct or pointer to struct to slice", "body": "<p>The only way I could figure out how to do this, is like so:</p>\n\n<pre><code>type Foo struct {\n    F string `zoom:\"1\"`\n}\n\ntype Bar struct {\n    F string `zoom:\"2\"`\n}\n\ntype Baz struct {\n    F string `zoom:\"3\"`\n}\n\n\nfunc extractField(s []interface{}){\n    for _, v := range s {\n        t := reflect.TypeOf(v)\n        f, _ := t.FieldByName(\"F\")\n        v, ok := f.Tag.Lookup(\"zoom\")\n        fmt.Println(v,ok)\n    }\n}\n\nfunc main(){\n\n    extractField([]interface{}{Foo{},Bar{},Baz{}})  // &lt;&lt;&lt;&lt; here\n\n}\n</code></pre>\n\n<p>not sure if there is a way to pass a struct without \"instantiating it\" first.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "edited": false, "score": 0, "creation_date": 1543713874, "post_id": 53576434, "comment_id": 94017298, "body": "yes, but how do they pass the type like here <code>decoder := json.NewDecoder(r.Body)</code>? how is <code>r.Body</code> passed? Is r.Body a struct or interface or?"}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1543714336, "post_id": 53576434, "comment_id": 94017375, "body": "<a href=\"https://godoc.org/encoding/json#NewDecoder\" rel=\"nofollow noreferrer\"><code>json.NewDecoder</code></a> takes a <b>value</b> of type <code>io.Reader</code>; that happens to be an interface type, but it is a thing from which you can read and not a type <i>per se</i>."}], "tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": false, "score": 0, "last_activity_date": 1543712530, "creation_date": 1543712530, "answer_id": 53576434, "question_id": 53576324, "link": "https://stackoverflow.com/questions/53576324/add-struct-or-pointer-to-struct-to-slice/53576434#53576434", "title": "Add struct or pointer to struct to slice", "body": "<p>The overall problem seems like a much better match for an interface type.</p>\n\n<pre><code>type HasF interface {\n    GetF() string\n}\n</code></pre>\n\n<p>It's easy enough to define these methods, <em>e.g.</em></p>\n\n<pre><code>func (foo Foo) GetF() string { return foo.F }\n</code></pre>\n\n<p>Your method to iterate over them becomes almost trivial</p>\n\n<pre><code>func extractField(s []HasF) {\n    for _, v := range s {\n        fmt.Printf(v.GetF())\n    }\n}\n\nfunc main() {\n    extractField([]HasF{Foo{},Bar{},Baz{}})\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/uw0T7TGVC0n\" rel=\"nofollow noreferrer\">https://play.golang.org/p/uw0T7TGVC0n</a> has a complete version of this.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1543745866, "post_id": 53578060, "comment_id": 94022034, "body": "upvoted but I think you missed the point of the OP - OP is trying to pass structs in a slice to another func. But I can&#39;t pass a struct{} itself, I can only pass a struct{}{} instance? I am trying to pass the struct type itself, not an value/expression."}, {"owner": {"reputation": 4216, "user_id": 720822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8a1284b0d0202c5866d40c04b8bd842?s=128&d=identicon&r=PG", "display_name": "Corey", "link": "https://stackoverflow.com/users/720822/corey"}, "reply_to_user": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 1, "creation_date": 1543780233, "post_id": 53578060, "comment_id": 94031466, "body": "My point was you can&#39;t pass in a dynamically instantiated struct/slice. Instantiation is required beforehand (as you already found out). Mentally, you have to separate the <i>definition</i> of a struct from an <i>instance</i> of the struct."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "edited": false, "score": 1, "creation_date": 1543829099, "post_id": 53578060, "comment_id": 94044524, "body": "@Corey ultimately just trying to reduce verbosity in the OP - I wanted to instantiate each class/struct after it had been passed, not before - unfortunately with Golang you cannot pass types around, only expressions, as tar as I can tell.  I would like to pass the definition of a struct in Golang, but I guess you can&#39;t. Shame."}, {"owner": {"reputation": 4216, "user_id": 720822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8a1284b0d0202c5866d40c04b8bd842?s=128&d=identicon&r=PG", "display_name": "Corey", "link": "https://stackoverflow.com/users/720822/corey"}, "edited": false, "score": 0, "creation_date": 1543854672, "post_id": 53578060, "comment_id": 94058404, "body": "@OlegzandrDenman - indeed, this was one of the biggest pills to swallow when shifting mindset from JS--&gt;Go (for me anyway)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "edited": false, "score": 1, "creation_date": 1543982615, "post_id": 53578060, "comment_id": 94110089, "body": "@Corey yeah the problem with not being able to pass types is that you have import things at the top of the file, and with cyclic imports being forbidden (unlike Java and Node.js) this is a huge constraint that I have hit a few times with a go project I am working on, maybe will get better at avoiding it but so far not so much. Now I know why so many go projects have all the files in one folder..."}], "tags": [], "owner": {"reputation": 4216, "user_id": 720822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8a1284b0d0202c5866d40c04b8bd842?s=128&d=identicon&r=PG", "display_name": "Corey", "link": "https://stackoverflow.com/users/720822/corey"}, "is_accepted": false, "score": 1, "last_activity_date": 1543780852, "last_edit_date": 1543780852, "creation_date": 1543733277, "answer_id": 53578060, "question_id": 53576324, "link": "https://stackoverflow.com/questions/53576324/add-struct-or-pointer-to-struct-to-slice/53578060#53578060", "title": "Add struct or pointer to struct to slice", "body": "<p>The original code looks like it follows a JavaScript approach, where a function would mutate an object. Go is a little bit different, where it's more common to self-mutate.</p>\n\n<p>For example:</p>\n\n<pre><code>type Generic struct {\n  field string\n}\n\nfunc (generic *Generic) Value () string {\n  return generic.field\n}\n\nsomeObject := &amp;Generic{\n  field: \"some value\",\n}\n\nlog.Print(someObject.Value()) // Outputs \"some value\"\n</code></pre>\n\n<p>If you're coming from the JavaScript world, think of structs a little bit like an object/class that can contain attributes and functions. Structs are merely a definition until an instance is instantiated. This differs from JavaScript where the definition of the object and the data are both defined at the same time.</p>\n\n<p>As the other answer points out, an interface is another similar approach to dealing with this.</p>\n\n<p><strong>Clarification</strong></p>\n\n<p>In JavaScript terms, the OP is attempting to do something akin to:</p>\n\n<pre><code>class Foo {...}\nclass Bar {...}\nclass Baz {...}\n\nextractField(Foo, Bar, Baz)\n</code></pre>\n\n<p>In JS-speak, this would pass a class definition to the extractField method. You would still have to instantiate an instance of a class if you want to manipulate/read from it, like:</p>\n\n<pre><code>extractField(new Foo(), new Bar(), new Baz())\n</code></pre>\n\n<p>This is basically what is being accomplished with</p>\n\n<pre><code>extractField([]interface{}{Foo{},Bar{},Baz{}})\n</code></pre>\n\n<p>I think the problem you're running into is the Foo/Bar/Baz structs are instantiated, but the nested F struct is not.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1543780852, "creation_date": 1543711003, "last_edit_date": 1543711875, "question_id": 53576324, "link": "https://stackoverflow.com/questions/53576324/add-struct-or-pointer-to-struct-to-slice", "title": "Add struct or pointer to struct to slice", "body": "<p>Say I have structs like so:</p>\n\n<pre><code>type Foo struct {\n  F string `zoom:\"1\"`\n}\n\ntype Bar struct {\n  F string `zoom:\"2\"`\n}\n\ntype Baz struct {\n  F string `zoom:\"3\"`\n}\n</code></pre>\n\n<p>Say I wanted to create a func that can extract the f field from each struct, it might look like:</p>\n\n<pre><code>func extractField(s []struct{}){\n  for _, v := range s {\n    t := reflect.TypeOf(v{})\n    f, _ := t.FieldByName(\"F\")\n    v, ok := f.Tag.Lookup(\"zoom\")\n  }\n}\n</code></pre>\n\n<p>is there a way to pass the structs to extractField? If I do this:</p>\n\n<pre><code>extractField([]struct{}{Foo, Bar, Baz})\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>Type Foo is not an expression\nType Bar is not an expression\nType Baz is not an expression\n</code></pre>\n\n<p>I just want to pass the 3 structs to the extractField func.</p>\n"}, {"tags": ["go", "gorilla"], "comments": [{"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1543710318, "post_id": 53576200, "comment_id": 94016817, "body": "Can you please update your question and explain why you need 3 functions for one route?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "reply_to_user": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1543710544, "post_id": 53576200, "comment_id": 94016850, "body": "@DmitryHarnitski so the the middleware funcs are associated - 1,2,3 are called in that order (serially) for the request. For example 1 and 2 could to write &quot;res.headers&quot; and 3 could write to &quot;res.body&quot;, etc."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "edited": false, "score": 0, "creation_date": 1543712658, "post_id": 53576332, "comment_id": 94017130, "body": "very nice, ty, will accept if nothing better shows up in the next day or two!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "edited": false, "score": 0, "creation_date": 1543715638, "post_id": 53576332, "comment_id": 94017533, "body": "toward the bottom in your example, is it <code>router.Handle()</code> or should it be <code>router.HandleFunc()</code>? Just want to be clear, I think it should be the latter, might be a typo, thanks."}, {"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 1, "creation_date": 1543717129, "post_id": 53576332, "comment_id": 94017738, "body": "in my sample it should be <code>router.Handle()</code> because we use struct that implements <code>http.Handler</code>. <code>router.HandleFunc()</code> requires <code>func()</code> as argument."}], "tags": [], "owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "is_accepted": false, "score": 0, "last_activity_date": 1543711115, "creation_date": 1543711115, "answer_id": 53576332, "question_id": 53576200, "link": "https://stackoverflow.com/questions/53576200/return-multiple-middleware-funcs-from-router-handlefunc-call/53576332#53576332", "title": "Return multiple middleware funcs from router.HandleFunc call", "body": "<p>You can chain multiple <code>http.Handler</code> using wrapper:</p>\n\n<pre><code>type Middleware struct {\n    next          http.Handler\n}\n\nfunc (m Middleware) Wrap(handler http.Handler) http.Handler {\n    m.next = handler\n    return m\n}\n\nfunc (m Middleware) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    // run your handler code here\n    // write error into w and return if you need to interrupt request execution\n\n    // call next handler \n    m.next.ServeHTTP(w, r)\n}\n</code></pre>\n\n<p>Register chained wrappers and main handler:</p>\n\n<pre><code>h1 := Middleware{}\nh2 := OtherMiddleware{}\nrouter.Handle(\"/some_route\", h1.Wrap(h2.Wrap(mainHandler))).Methods(http.MethodPost)\n</code></pre>\n\n<p>Request will execute <code>h1</code>, <code>h2</code> and finally <code>mainHandler</code>.</p>\n\n<p>For example, you can log request in <code>h1</code>, authorize in <code>h2</code> and keep business logic in <code>mainHandler</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 462, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1543711115, "creation_date": 1543709413, "question_id": 53576200, "link": "https://stackoverflow.com/questions/53576200/return-multiple-middleware-funcs-from-router-handlefunc-call", "title": "Return multiple middleware funcs from router.HandleFunc call", "body": "<p>I am using gorilla/mux I have this:</p>\n\n<pre><code>router.HandleFunc(\"/api/v1/register\",h.makeRegisterNewUser(v)).Methods(\"POST\")\n</code></pre>\n\n<p>and <code>h.makeRegisterNewUser</code> looks like:</p>\n\n<pre><code>func (h Handler) makeRegisterNewUser(v interface{}) http.HandlerFunc {\n\n    type RespBody = ...;\n    type ReqBody = ...\n\n\n    return func(w http.ResponseWriter, r *http.Request) {\n\n        decoder := json.NewDecoder(r.Body)\n        err := decoder.Decode(&amp;ReqBody)\n\n        // ...\n\n        json.NewEncoder(w).Encode(RespBody{});\n    }\n}\n</code></pre>\n\n<p>my question is - is there a way to return multiple http.HandlerFuncs from makeRegisterNewUser? Something like this:</p>\n\n<pre><code>router.HandleFunc(\"/api/v1/register\",h.makeRegisterNewUser(v)).Methods(\"POST\")\n\nfunc (h Handler) makeRegisterNewUser(v interface{}) (http.HandlerFunc...) {\n\n    type RespBody = ...;\n    type ReqBody = ...\n\n\n    return func(w http.ResponseWriter, r *http.Request) {\n       // 1\n\n    }, func(w http.ResponseWriter, r *http.Request) {\n       // 2\n\n    }, func(w http.ResponseWriter, r *http.Request) {\n        // 3\n    }\n}\n</code></pre>\n\n<p>I am not sure if middleware can be chained in Go like it does in Node.js Express. </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "is_accepted": false, "score": 3, "last_activity_date": 1543704784, "creation_date": 1543704784, "answer_id": 53575769, "question_id": 53575693, "link": "https://stackoverflow.com/questions/53575693/difference-between-makemap-and-map/53575769#53575769", "title": "Difference between make(map) and map{}", "body": "<p>Function <code>make()</code> and initializer of empty map are identical.</p>\n\n<blockquote>\n  <p>The same syntax may be used to initialize an empty map, which is\n  functionally identical to using the make function:</p>\n  \n  <p><code>m = map[string]int{}</code></p>\n</blockquote>\n\n<p>from <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow noreferrer\">https://blog.golang.org/go-maps-in-action</a></p>\n\n<p>Using pointer as map key is valid as pointer is <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"nofollow noreferrer\">comparable</a></p>\n\n<p>Although, remember that values these pointers point to are not checked:</p>\n\n<blockquote>\n  <p>Pointer values are comparable. Two pointer values are equal if they\n  point to the same variable or if both have value nil. Pointers to\n  distinct zero-size variables may or may not be equal.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 6, "last_activity_date": 1543707380, "last_edit_date": 1543707380, "creation_date": 1543706656, "answer_id": 53575947, "question_id": 53575693, "link": "https://stackoverflow.com/questions/53575693/difference-between-makemap-and-map/53575947#53575947", "title": "Difference between make(map) and map{}", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Making_slices_maps_and_channels\" rel=\"noreferrer\">Making slices, maps and channels</a></p>\n  \n  <p>The built-in function make takes a type T, which must be a slice, map\n  or channel type, optionally followed by a type-specific list of\n  expressions. It returns a value of type T (not *T). The memory is\n  initialized as described in the section on initial values.</p>\n\n<pre><code>Call         Type T  Result\nmake(T)      map     map of type T\nmake(T, n)   map     map of type T with initial space for approximately n elements\n</code></pre>\n  \n  <p><a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"noreferrer\">Composite literals</a></p>\n  \n  <p>Composite literals construct values for structs, arrays, slices, and\n  maps and create a new value each time they are evaluated. They consist\n  of the type of the literal followed by a brace-bound list of elements.\n  Each element may optionally be preceded by a corresponding key. </p>\n\n<pre><code>map[string]int{}\nmap[string]int{\"one\": 1}\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p><code>make</code> is the canonical form. Composite literals are a convenient, alternate form.</p>\n\n<pre><code>z := make(map[int]string)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>z := map[int]string{}\n</code></pre>\n\n<p>are equivalent.</p>\n"}], "owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 2, "accepted_answer_id": 53575947, "answer_count": 2, "score": 2, "last_activity_date": 1543707380, "creation_date": 1543704204, "question_id": 53575693, "link": "https://stackoverflow.com/questions/53575693/difference-between-makemap-and-map", "title": "Difference between make(map) and map{}", "body": "<p>Just wondering what the difference is between:</p>\n\n<pre><code>z := make(map[*test] string)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>z := map[*test] string{}\n</code></pre>\n\n<p>am I imagining things or are they both not valid? </p>\n"}, {"tags": ["json", "file", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 1, "creation_date": 1543701580, "post_id": 53575401, "comment_id": 94015104, "body": "The file contents isn&#39;t legal JSON. You probably need to read it, fix it, then parse it."}, {"owner": {"reputation": 1665, "user_id": 261083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AUAZb.jpg?s=128&g=1", "display_name": "tzim", "link": "https://stackoverflow.com/users/261083/tzim"}, "reply_to_user": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 0, "creation_date": 1543701944, "post_id": 53575401, "comment_id": 94015185, "body": "That was my guess as well - currently in testing - but I was hoping that someone smarter can find a way with <a href=\"https://golang.org/pkg/encoding/json/#Decoder.Decode\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/json/#Decoder.Decode</a> or some other trick I am not familiar with."}, {"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 1, "creation_date": 1543703479, "post_id": 53575401, "comment_id": 94015551, "body": "also your <code>date</code> cannot be mapped to <code>time.Time</code>"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1543741696, "post_id": 53575401, "comment_id": 94021252, "body": "Fix program1 so it doesn&#39;t write invalid/incomplete JSON to the file. Write to a temporary file in the same filesystem as the real file, then rename the temporary file. That&#39;s an atomic operation and program2 will never observe partially written data."}], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 1, "last_activity_date": 1543704603, "last_edit_date": 1543704603, "creation_date": 1543703629, "answer_id": 53575631, "question_id": 53575401, "link": "https://stackoverflow.com/questions/53575401/how-to-parse-json-file-that-is-being-worked-on/53575631#53575631", "title": "How to parse JSON file that is being worked on", "body": "<p>You just need to treat it as a <a href=\"https://golang.org/pkg/encoding/json/#example_Decoder_Decode_stream\" rel=\"nofollow noreferrer\">JSON stream</a>: </p>\n\n<p><a href=\"https://play.golang.org/p/6drcizYKrrJ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/6drcizYKrrJ</a></p>\n\n<pre><code>    type Message struct {\n      Id   string `json:\"id\"`\n      Lang string `json:\"lang\"`\n      Date string `json:\"date\"`\n      Text string `json:\"text\"`\n    }\n\n    jsonStream, err := os.Open(`/tmp/json`)\n    if err != nil {\n        panic(err)\n    }\n\n    dec := json.NewDecoder(jsonStream)\n\n    // read open bracket\n    _, err := dec.Token()\n    if err != nil {\n      log.Fatal(err)\n    }\n\n    // while the array contains values\n    for dec.More() {\n      var m Message\n      // decode an array value (Message)\n      err := dec.Decode(&amp;m)\n      if err == nil {\n        fmt.Printf(\"%v : %v : %v : %v\\n\", m.Id, m.Lang, m.Date, m.Text)\n      } else {\n        // wait for more contents - sleep?  use a channel and wait to be notified?\n      }\n\n    }\n</code></pre>\n"}], "owner": {"reputation": 1665, "user_id": 261083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AUAZb.jpg?s=128&g=1", "display_name": "tzim", "link": "https://stackoverflow.com/users/261083/tzim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 53575631, "answer_count": 1, "score": 1, "last_activity_date": 1611136900, "creation_date": 1543701397, "last_edit_date": 1611136900, "question_id": 53575401, "link": "https://stackoverflow.com/questions/53575401/how-to-parse-json-file-that-is-being-worked-on", "title": "How to parse JSON file that is being worked on", "body": "<p>I have a file with JSON in this format:</p>\n<pre><code>[{\n    &quot;id&quot;: &quot;1055972353245622272&quot;,\n    &quot;lang&quot;: &quot;und&quot;,\n    &quot;date&quot;: &quot;Sat Oct 27 00:00:02 +0000 2018&quot;,\n    &quot;text&quot;: &quot;#BTC 6474 346 0 08 #ETH 203 317 0 13 #XRP 0 459 0 04 #BCH 438 922 0 0 #EOS 5 388 0 12 #XLM 0 235 0 41 #LTC 52 106 0 03 #ADA 0 074 0 17 #USDT 0 99 0 07 #XMR 105 022 0 13 #TRX 0 024 0 21 &quot;\n},\n{\n    &quot;id&quot;: &quot;1055972355506401280&quot;,\n    &quot;lang&quot;: &quot;en&quot;,\n    &quot;date&quot;: &quot;Sat Oct 27 00:00:03 +0000 2018&quot;,\n    &quot;text&quot;: &quot;Don t want to miss any of our public #crypto trading #signals Want instant updates of our premium channel #performance Searching for #crypto news Get instantly notified on our public telegram channel Join now at https t co akfmLiArya #DGB #SC #MFT #EOS #XVG #BTC #TRX https t co HT2RAOIjfh&quot;\n},\n</code></pre>\n<p>This file is being worked on by <strong>program1</strong> in random intervals (when a tweet that match filter is found). I want to read this file by <strong>program2</strong> - in 5 minutes timesteps.\nBut I am unable to.</p>\n<p>The unmarshaling (<code>json.Unmarshal(file, &amp;data)</code>) is not allowing me to read it - as it throws an error as JSON is not correct.</p>\n<p>I do not want to redesign the architecture with the usage of DB, I want to be able to operate on files as intended.</p>\n<p>How can I access the files and have them parsed as JSON?</p>\n<p>Workaround with reading the file and closing the JSON</p>\n<pre><code>file, _ := ioutil.ReadFile(fileName)\nclosingJson := &quot;{}]&quot;\nfile = append(file, closingJson...)\njson.Unmarshal(file, &amp;data)\n</code></pre>\n"}, {"tags": ["json", "http", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1543700882, "post_id": 53575325, "comment_id": 94014950, "body": "Could you clarify? You get a JSON response then you parse it to a <code>money</code> struct then you want to convert to to string back? Could you send original JSON to the web page? If not try to <code>json.Marshal</code> it to string."}, {"owner": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "reply_to_user": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1543701139, "post_id": 53575325, "comment_id": 94015005, "body": "@EugeneLisitsky yes i can send the original json to the webpage normally thorugh ` fmt.Fprintln(w, string(answer))` . What i want to do is to display a certain value, say currency, and not the whole JSON"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543741947, "post_id": 53575325, "comment_id": 94021293, "body": "Don&#39;t ignore the error returned from json.Unmarshal."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "edited": false, "score": 0, "creation_date": 1543701960, "post_id": 53575433, "comment_id": 94015191, "body": "but isnt <code>str</code> hardcoded?  what if im getting the json from the api right away? How will i remove the double quotes"}, {"owner": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "edited": false, "score": 0, "creation_date": 1543702048, "post_id": 53575433, "comment_id": 94015216, "body": "I have also updated my code in the question to clarify the api part"}, {"owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "reply_to_user": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "edited": false, "score": 0, "creation_date": 1543702069, "post_id": 53575433, "comment_id": 94015221, "body": "If you have to parse with double quotes, change the type of Amount to string in your struct."}], "tags": [], "owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "is_accepted": false, "score": 3, "last_activity_date": 1543701707, "creation_date": 1543701707, "answer_id": 53575433, "question_id": 53575325, "link": "https://stackoverflow.com/questions/53575325/converting-json-to-string-in-golang/53575433#53575433", "title": "Converting Json to string in golang", "body": "<p>I had to remove the double quotes from the 'amount' value in order to allow the parsing into float32:</p>\n\n<pre><code> {\"data\":{\"base\":\"BTC\",\"currency\":\"USD\",\"amount\":4225.87}}\n</code></pre>\n\n<p>See on Playground: <a href=\"https://play.golang.org/p/4QVclgjrtyi\" rel=\"nofollow noreferrer\">https://play.golang.org/p/4QVclgjrtyi</a></p>\n\n<p>Full code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype money struct {\n    Base     string  `json:\"base\"`\n    Currency string  `json:\"currency\"`\n    Amount   float32 `json:\"amount\"`\n}\n\ntype info struct {\n    Data money\n}\n\nfunc main() {\n    str := `{\"data\":{\"base\":\"BTC\",\"currency\":\"USD\",\"amount\":4225.87}}`\n\n    var i info\n\n    if err := json.Unmarshal([]byte(str), &amp;i); err != nil {\n        fmt.Println(\"ugh: \", err)\n    }\n\n    fmt.Println(\"info: \", i)\n    fmt.Println(\"currency: \", i.Data.Currency)\n}\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18151, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1543702006, "creation_date": 1543700676, "last_edit_date": 1543702006, "question_id": 53575325, "link": "https://stackoverflow.com/questions/53575325/converting-json-to-string-in-golang", "title": "Converting Json to string in golang", "body": "<p>What I am trying to do is to convert the JSON response I got from a third party API  to string to be able to render it on the webpage. My attempt first was to create a struct called <code>money</code> which holds the 3 values which are being returned and then <code>Unmarshel</code> the bytes but I don't get anything displayed</p>\n\n<p>Here is the struct</p>\n\n<pre><code>type money struct {\nBase     string  `json:\"base\"`\nCurrency string  `json:\"currency\"`\nAmount   float32 `json:\"amount\"`}\n</code></pre>\n\n<p>and inside the <code>getCurrency()</code> func </p>\n\n<pre><code>    response, err := http.Get(\"https://api.coinbase.com/v2/prices/spot?currency=USD\")\n\nif err != nil {\n    fmt.Printf(\"The http requst failed with error %s \\n\", err)\n} else {\n    answer, _ := ioutil.ReadAll(response.Body)\n    response := money{}\n    json.Unmarshal([]byte(answer), &amp;response)\n    fmt.Fprintln(w, response)\n    fmt.Fprintln(w, response.Currency)\n\n\n}\n</code></pre>\n\n<p>Finally here is what i get from the json response</p>\n\n<pre><code> {\"data\":{\"base\":\"BTC\",\"currency\":\"USD\",\"amount\":\"4225.87\"}}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 1, "creation_date": 1543703187, "post_id": 53575188, "comment_id": 94015490, "body": "I think you want to use the package&#39;s init function."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1543703733, "post_id": 53575188, "comment_id": 94015604, "body": "@ain yeah I think you are right - see Dmitry&#39;s answer, but if there is a way to create self-invoking func I would love to see it thanks"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "edited": false, "score": 0, "creation_date": 1543701199, "post_id": 53575254, "comment_id": 94015015, "body": "who is going to call main? I am not..I need the selfInvoking func to be called right after it&#39;s declared, I don&#39;t think this accomplishes that? The reason I have the func in the first place is to populate the exported map TypeMap."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "edited": false, "score": 0, "creation_date": 1543703646, "post_id": 53575254, "comment_id": 94015593, "body": "I think instead of main, maybe init? Does init automatically get called in a file?"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 1, "creation_date": 1543747810, "post_id": 53575254, "comment_id": 94022461, "body": "yes, sorry I didn&#39;t understand what you ment in the question :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "edited": false, "score": 0, "creation_date": 1543748111, "post_id": 53575254, "comment_id": 94022536, "body": "no problem, in JS, self-invoking funcs are relatively common, to create isolated scope, or recursion, or what not"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1543748230, "post_id": 53575254, "comment_id": 94022561, "body": "ah, right.  JS is kinda different as it isn&#39;t compiled.   JS might be the worlds most popular language but personally I find it&#39;s semantics and syntax a bit quirky!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "edited": false, "score": 0, "creation_date": 1543748775, "post_id": 53575254, "comment_id": 94022695, "body": "Node.js is awesome - dynamic languages can be a lot of fun. Node.js + TypeScript is killer, <i>gradual typing</i> is a good paradigm. So far Golang is aight but a little restrictive. I started with Java, then moved to Node, now trying Golang."}], "tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": false, "score": 0, "last_activity_date": 1543699944, "creation_date": 1543699944, "answer_id": 53575254, "question_id": 53575188, "link": "https://stackoverflow.com/questions/53575188/self-invoking-function-with-golang/53575254#53575254", "title": "Self-invoking function with Golang", "body": "<p>not sure what you are trying to achieve but this compiles at least</p>\n\n<pre><code>import (\n    \"fmt\"\n)\ntype Foo struct {}\ntype Bar struct {}\n\nvar TypeMap map[interface{}]string;\n\nfunc selfInvoking(){\n\n  TypeMap = map[interface{}]string{\n    Foo{}: \"foo\",\n    Bar{}: \"bar\",\n   }\n\n\n}\n\n\nfunc main() {\nselfInvoking()\nfmt.Println(TypeMap)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "edited": false, "score": 0, "creation_date": 1543703623, "post_id": 53575596, "comment_id": 94015586, "body": "Ah ok, I don&#39;t realize you could create a variable outside a func like that"}], "tags": [], "owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "is_accepted": true, "score": 3, "last_activity_date": 1543742067, "last_edit_date": 1543742067, "creation_date": 1543703357, "answer_id": 53575596, "question_id": 53575188, "link": "https://stackoverflow.com/questions/53575188/self-invoking-function-with-golang/53575596#53575596", "title": "Self-invoking function with Golang", "body": "<p>There are 3 ways to execute initialization code in <code>GO</code>:</p>\n\n<ul>\n<li><a href=\"https://golang.org/doc/effective_go.html#constants\" rel=\"nofollow noreferrer\">Constants</a></li>\n<li><a href=\"https://golang.org/doc/effective_go.html#variables\" rel=\"nofollow noreferrer\">Variables</a>  </li>\n<li><a href=\"https://golang.org/doc/effective_go.html#init\" rel=\"nofollow noreferrer\">The init function</a></li>\n</ul>\n\n<p>In your case you can use last two.</p>\n\n<p>Variable:</p>\n\n<pre><code>var TypeMap = map[interface{}]string{\n    Foo{}: \"foo\",\n    Bar{}: \"bar\",\n   }\n</code></pre>\n\n<p>The init function:</p>\n\n<pre><code>var TypeMap map[interface{}]string\n\nfunc init(){\n  TypeMap = map[interface{}]string{\n    Foo: \"foo\",\n    Bar: \"bar\",\n   }\n}\n</code></pre>\n\n<p>In any case be careful with initializers and do not use them for any complex or <code>io</code> code.\nInitializer are not very good for unit testing and errors handling/logging.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1004, "favorite_count": 0, "accepted_answer_id": 53575596, "answer_count": 2, "score": 0, "last_activity_date": 1543742067, "creation_date": 1543699410, "last_edit_date": 1543699986, "question_id": 53575188, "link": "https://stackoverflow.com/questions/53575188/self-invoking-function-with-golang", "title": "Self-invoking function with Golang", "body": "<p>Could not easily find info on how to create a self-invoking func in Golang.</p>\n\n<p>My end-goal is to export a map from a file, something like this:</p>\n\n<pre><code>type Foo struct {}\ntype Bar struct {}\n\nvar TypeMap map[interface{}]string;\n\nfunc selfInvoking(){\n\n  TypeMap = map[interface{}]string{\n    Foo: \"foo\",\n    Bar: \"bar\"\n   }\n}()\n</code></pre>\n\n<p>how can I go about exporting a populated map like this from a file in Go? It's basically for one-time configuration.</p>\n\n<p>Using the pattern above, I will get </p>\n\n<blockquote>\n  <p>\"unused variable TypeMap\".</p>\n</blockquote>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 2, "creation_date": 1543697479, "post_id": 53574893, "comment_id": 94014090, "body": "What do you really want to do?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1543697669, "post_id": 53574893, "comment_id": 94014142, "body": "I want to store a string on a struct, static member, and make it hardcoded. So that struct is tagged with a string. Makes sense right? Metaprogramming stuff here."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1543697750, "post_id": 53574893, "comment_id": 94014160, "body": "The ultimate goal is so that I can have a string on a struct, which represents the path to the struct in the codebase."}, {"owner": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 0, "creation_date": 1543698198, "post_id": 53574893, "comment_id": 94014272, "body": "Sounds like you&#39;re trying to do dynamically typed programming with <code>Golang</code>. I doubt it&#39;s meant for that, but reflection might help. Not quite sure what you want to achieve exactly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "reply_to_user": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 0, "creation_date": 1543698284, "post_id": 53574893, "comment_id": 94014300, "body": "@ishaan no, not trying to do dynamically typed anything, I am just trying to store a static member on a struct. This seems to be a desired feature for metaprogramming, as you see here: <a href=\"https://github.com/golang/go/issues/7112\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/7112</a>"}, {"owner": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 1, "creation_date": 1543698483, "post_id": 53574893, "comment_id": 94014356, "body": "Ahh, so something similar to static in say Java. Well, i&#39;ve never done anything like this in my go code, only have initialised singleton structs with values on init, mostly from a JSON string :(  I do wish there was something like this, so I wouldn&#39;t have to. Would be a lot of help in base configs across the code base."}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1543699267, "post_id": 53574893, "comment_id": 94014562, "body": "I&#39;m not sure I understand your question, but you might like this example <a href=\"https://golang.org/pkg/reflect/#example_StructTag\" rel=\"nofollow noreferrer\">golang.org/pkg/reflect/#example_StructTag</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1543699670, "post_id": 53574893, "comment_id": 94014663, "body": "@Vorsprung that might work, only problem I might foresee is if the struct has more fields and I don&#39;t currently have the data to populate the other fields on hand."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1543701370, "post_id": 53574893, "comment_id": 94015056, "body": "@Vorsprung I tried out the StructTag idea and that seems to work, if you can add an answer showing how you unmarshal JSON with a StructTag and how certain fields might be ignored if they don&#39;t have the <code>json</code> struct tag?"}, {"owner": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 0, "creation_date": 1543701525, "post_id": 53574893, "comment_id": 94015091, "body": "Is <a href=\"https://stackoverflow.com/questions/37510763/go-static-member-variable-such-as-oop-langage\">this</a> what you&#39;re looking for?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "edited": false, "score": 0, "creation_date": 1543703829, "post_id": 53574893, "comment_id": 94015628, "body": "Well, I don&#39;t think you can store a struct in a map like that, maybe only an instance of the struct?"}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1543752098, "post_id": 53574893, "comment_id": 94023512, "body": "Would putting that value as a package-level constant, outside but next to the struct, meet your needs?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "reply_to_user": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1543794757, "post_id": 53574893, "comment_id": 94034999, "body": "@DavidMaze which value as a package-level constant?"}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1543797101, "post_id": 53574893, "comment_id": 94035454, "body": "<code>const TypePath string = &quot;...&quot;</code>, at the top level of some source file, outside of the struct definition."}], "answers": [{"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 3, "last_activity_date": 1543710571, "creation_date": 1543710571, "answer_id": 53576282, "question_id": 53574893, "link": "https://stackoverflow.com/questions/53574893/static-member-of-a-struct-in-golang/53576282#53576282", "title": "Static member of a struct in Golang", "body": "<p>You can define methods to give you those values:</p>\n\n<pre><code>type DriverData struct {\n}\n\nfunc (DriverData) Path() string {\n    return \"Foo.Bar.DriverData\"\n}\n\ntype PilotData struct {\n}\n\nfunc (PilotData) Path() string {\n    return \"Foo.Bar.PilotData\"\n}\n\ntype BoatmasterData struct {\n}\n\nfunc (BoatmasterData) Path() string {\n    return \"Foo.Bar.BoatmasterData\"\n}\n</code></pre>\n\n<p>Does that do what you want?</p>\n\n<p>See <a href=\"https://play.golang.org/p/zR7RZwMVEdf\" rel=\"nofollow noreferrer\">https://play.golang.org/p/zR7RZwMVEdf</a>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2447, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1543710571, "creation_date": 1543697165, "last_edit_date": 1543701302, "question_id": 53574893, "link": "https://stackoverflow.com/questions/53574893/static-member-of-a-struct-in-golang", "title": "Static member of a struct in Golang", "body": "<p>Say I have a struct:</p>\n\n<pre><code>type DriverData struct {\n    TypePath string = \"Foo.Bar.DriverData\"\n}\n</code></pre>\n\n<p>I want to be able to reference <code>TypePath</code> without having to create an instance of the struct, something like:</p>\n\n<pre><code>typePath := DriverData.TypePath\n</code></pre>\n\n<p>but that's not possible in Golang.</p>\n\n<p>So I was wondering - maybe there is a way to create a map, and associate the type with a string, something like:</p>\n\n<pre><code>type DriverData struct {\n\n}\n\ntype PilotData struct {\n\n}\n\ntype BoatmasterData struct {\n\n}\n\ntypeMap := map[struct]string{\n   DriverData: \"Foo.Bar.DriverData\",\n   PilotData:   \"Foo.Bar.PilotData\",\n   BoatmasterData: \"Foo.Bar.BoatmasterData\",\n}\n</code></pre>\n\n<p><strong>Question:</strong></p>\n\n<p>Is this the best approach to create static properties on a struct? Storing the static properties in a map like this?</p>\n"}, {"tags": ["go", "visual-studio-code"], "comments": [{"owner": {"reputation": 3697, "user_id": 5031787, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/7b796858b09cb0a960bc7b86e5b3d446?s=128&d=identicon&r=PG&f=1", "display_name": "Thom Kiesewetter", "link": "https://stackoverflow.com/users/5031787/thom-kiesewetter"}, "edited": false, "score": 0, "creation_date": 1543717790, "post_id": 53573385, "comment_id": 94017804, "body": "Can you execute this command <code>mkdir &#47;Documents&#47;go</code> to create the folder?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10732418, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156567931644597/picture?type=large", "display_name": "Daniel Mintz", "link": "https://stackoverflow.com/users/10732418/daniel-mintz"}, "edited": false, "score": 0, "creation_date": 1543772004, "post_id": 53573667, "comment_id": 94028970, "body": "Yes.. it was my GOPATH route which was set to a tree that started with icloud rather than let&#39;s say Users/... from the hard drive. in a more conventional setting. Once I moved it and reset my Go Path accordingly it seemed to work. thanks for getting back and everyone&#39;s help; Just ran my first golang program so dead pleased"}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 3, "user_id": 10732418, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156567931644597/picture?type=large", "display_name": "Daniel Mintz", "link": "https://stackoverflow.com/users/10732418/daniel-mintz"}, "edited": false, "score": 0, "creation_date": 1544720520, "post_id": 53573667, "comment_id": 94385362, "body": "glad you&#39;re sorted - for some reason i saw visual studio and jumped straight to windows despite the paths suggesting otherwise :)"}], "tags": [], "owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "is_accepted": true, "score": 0, "last_activity_date": 1543688618, "last_edit_date": 1543688618, "creation_date": 1543687893, "answer_id": 53573667, "question_id": 53573385, "link": "https://stackoverflow.com/questions/53573385/cant-download-analysis-tools-required-for-go-with-visual-studio/53573667#53573667", "title": "Can&#39;t download Analysis Tools required for Go with Visual Studio", "body": "<p>I don't use visual studio for golang so may be of limited use here if it is visual studio specific - but I've heard nothing but good things so its probably not...</p>\n\n<p>I suspect the issue is that your GOPATH is set to <code>/Documents/go</code> whereas you have placed your GOPATH in the Documents folder for your user. it should probably be something like <code>%My Documents%/go</code> or the full path to that location e.g something like <code>/c/Users/{your user}/Documents</code>.</p>\n\n<p><strong>Note: I have used nix style paths - as your output does, but when setting them via windows gui you should use windows conventions, e.g <code>C:\\Users\\...</code></strong></p>\n\n<p>To diagnose further I would first cut the ide out of the equation and jump to the command line.</p>\n\n<p>type <code>go env</code> to check your paths, look particularly at GOPATH which I suspect is your problem. If it is incorrect you should change it in environment variables (google change environment variables for you windows version) - as per note above follow the conventions of the other environment variables for setting the path (windows style specification, <code>e.g c:\\Users\\</code>)</p>\n\n<p>if <code>go env</code> doesn't work you have a bigger issue with your go install</p>\n\n<p>If you are still having issues, please update your question, providing the output of <code>go env</code> as well as an outline of how you installed go (Note: I think the MSI installer takes care of it all for you)</p>\n\n<p>if go env looks fine to you, another debug step would be to attempt to install one of your tools manually from the command line and see what happens, e.g:</p>\n\n<p><code>go get -u -v github.com/mdempsky/gocode</code></p>\n\n<p>but if go env doesn't work that wont either and the issue is likely that your main go binary is not in you systems <code>PATH</code> environment variable but it doesn't look like that</p>\n"}, {"comments": [{"owner": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 0, "creation_date": 1555161440, "post_id": 55665739, "comment_id": 98018409, "body": "Can you explain that further? How to do this? How does this solve the given problem?"}], "tags": [], "owner": {"reputation": 1, "user_id": 7503726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef1c6ed1f03e677fc039121704de45ec?s=128&d=identicon&r=PG&f=1", "display_name": "HSquared", "link": "https://stackoverflow.com/users/7503726/hsquared"}, "is_accepted": false, "score": 0, "last_activity_date": 1555160398, "creation_date": 1555160398, "answer_id": 55665739, "question_id": 53573385, "link": "https://stackoverflow.com/questions/53573385/cant-download-analysis-tools-required-for-go-with-visual-studio/55665739#55665739", "title": "Can&#39;t download Analysis Tools required for Go with Visual Studio", "body": "<p>Simply ensure the Git has been added to your PATH environment variable.</p>\n"}], "owner": {"reputation": 3, "user_id": 10732418, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156567931644597/picture?type=large", "display_name": "Daniel Mintz", "link": "https://stackoverflow.com/users/10732418/daniel-mintz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1115, "favorite_count": 0, "accepted_answer_id": 53573667, "answer_count": 2, "score": -2, "last_activity_date": 1555160398, "creation_date": 1543685887, "last_edit_date": 1543686271, "question_id": 53573385, "link": "https://stackoverflow.com/questions/53573385/cant-download-analysis-tools-required-for-go-with-visual-studio", "title": "Can&#39;t download Analysis Tools required for Go with Visual Studio", "body": "<p>I am a total newbie and only just kicked off a beginners course on Go and failing at first hurdle of installation of all the bits you need to make it work so sorry if this is a dumb question. I've installed Go, Git and Visual Studio... After first installing Visual Studio I am trying to install the 12 Analysis tools for Go but everytime i try this it fails. Generally related to a \"permission denied\" error. Error message below. Any ideas why? </p>\n\n<blockquote>\n  <p>Installing 12 tools at /Documents/go/bin   gocode   gopkgs<br>\n  go-outline   go-symbols   guru   gorename   dlv   gocode-gomod   godef\n  godef-gomod   goreturns   golint</p>\n  \n  <p>Installing github.com/mdempsky/gocode FAILED Installing\n  github.com/uudashr/gopkgs/cmd/gopkgs FAILED Installing\n  github.com/ramya-rao-a/go-outline FAILED Installing\n  github.com/acroca/go-symbols FAILED Installing\n  golang.org/x/tools/cmd/guru FAILED Installing\n  golang.org/x/tools/cmd/gorename FAILED Installing\n  github.com/derekparker/delve/cmd/dlv FAILED Installing\n  github.com/stamblerre/gocode FAILED Installing\n  github.com/rogpeppe/godef FAILED Installing github.com/ianthehat/godef\n  FAILED Installing github.com/sqs/goreturns FAILED Installing\n  golang.org/x/lint/golint FAILED</p>\n  \n  <p>12 tools failed to install.</p>\n  \n  <p>gocode: Error: Command failed: /usr/local/go/bin/go get -u -v\n  github.com/mdempsky/gocode github.com/mdempsky/gocode (download)\n  package github.com/mdempsky/gocode: mkdir /Documents/go: permission\n  denied github.com/mdempsky/gocode (download) package\n  github.com/mdempsky/gocode: mkdir /Documents/go: permission denied</p>\n  \n  <p>gopkgs: Error: Command failed: /usr/local/go/bin/go get -u -v\n  github.com/uudashr/gopkgs/cmd/gopkgs github.com/uudashr/gopkgs\n  (download) package github.com/uudashr/gopkgs/cmd/gopkgs: mkdir\n  /Documents/go: permission denied github.com/uudashr/gopkgs (download)\n  package github.com/uudashr/gopkgs/cmd/gopkgs: mkdir /Documents/go:\n  permission denied</p>\n</blockquote>\n"}, {"tags": ["html", "http", "go", "rendering"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543683779, "post_id": 53573062, "comment_id": 94010502, "body": "You have a Go template. Where / how are you executing it?"}, {"owner": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543683875, "post_id": 53573062, "comment_id": 94010534, "body": "@icza I use git bash inside the project folder and type <code>go run main.go</code>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1543683943, "post_id": 53573062, "comment_id": 94010557, "body": "You posted an HTML template, what&#39;s inside your <code>.gohtml</code> file. That is the source of an unprocessed template. You have to read it, parse it, and execute it to generate an actual HTML code. Where / how do you do it? The code you posted doesn&#39;t do that. Please try to come up with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543684247, "post_id": 53573062, "comment_id": 94010649, "body": "inside <code>main.go</code> I have the following function since my <code>.gohtml</code> file is inside a folder called templates <code>func init() { \ttpl = template.Must(template.ParseGlob(&quot;templates&#47;*.gohtml&quot;)) }</code>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543684660, "post_id": 53573062, "comment_id": 94010773, "body": "That&#39;s the reading and parsing part. Where do you execute it? Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543685007, "post_id": 53573062, "comment_id": 94010860, "body": "@icza Done, just edited my question"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543685157, "post_id": 53573062, "comment_id": 94010900, "body": "Your <code>getCurrency()</code> function doesn&#39;t write anything to its output (<code>w</code>), so you seeing a blank page seems about right. You have to send a response HTML document that will be displayed. If you want to embed the response, you can&#39;t use a form POST like that, you need to execute an AJAX call then."}, {"owner": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543685502, "post_id": 53573062, "comment_id": 94011001, "body": "@icza Alright, i figured out that i was missing the HTML execution part in the <code>getCurrency()</code> method. However, I am still not getting the response data displayed although I am rending <code>{{.Currency}}</code> after the form in the <code>.gohtml</code> file which means that below the form i should get the response"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543686281, "post_id": 53573062, "comment_id": 94011207, "body": "Please post how you execute now the template in <code>getCurrency()</code>."}, {"owner": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543686420, "post_id": 53573062, "comment_id": 94011253, "body": "@icza Done, updated my ques"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "edited": false, "score": 0, "creation_date": 1543686945, "post_id": 53573511, "comment_id": 94011415, "body": "What if i want to print a specific data inside the response reterived and not the whole response?"}, {"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "reply_to_user": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "edited": false, "score": 0, "creation_date": 1543687193, "post_id": 53573511, "comment_id": 94011478, "body": "@MarwaA. Did not get you question. Normally you write into <code>w</code> and return immediately for every code branch that assumes end of request due to error or successful execution."}, {"owner": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "edited": false, "score": 0, "creation_date": 1543687317, "post_id": 53573511, "comment_id": 94011501, "body": "i mean using <code>fmt.Fprintln(w, string(data))</code> i get the following  <code>{&quot;data&quot;:{&quot;base&quot;:&quot;BTC&quot;,&quot;currency&quot;:&quot;USD&quot;,&quot;amount&quot;:&quot;4225.87&quot;}}</code>. Now what if i want to get <code>USD</code> only"}, {"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "reply_to_user": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "edited": false, "score": 0, "creation_date": 1543687601, "post_id": 53573511, "comment_id": 94011563, "body": "<a href=\"https://gobyexample.com/json\" rel=\"nofollow noreferrer\">gobyexample.com/json</a> You need to create new struct type for your request and Unmarshal response bytes into it."}, {"owner": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "edited": false, "score": 0, "creation_date": 1543692978, "post_id": 53573511, "comment_id": 94012953, "body": "I have tried the following lines of code  <code>answer, _ := ioutil.ReadAll(response.Body) \t\tvar data map[string]interface{} \t\terr := json.Unmarshal([]byte(answer), &amp;data) \t\tif err != nil { \t\t\tpanic(err) \t\t} \t\tfmt.Fprintln(w, data[&quot;currency&quot;])</code>  but it doesnt show anything"}, {"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "reply_to_user": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "edited": false, "score": 0, "creation_date": 1543693446, "post_id": 53573511, "comment_id": 94013072, "body": "You cannot Unmarshal random JSON to <code>map</code>.  Create new struct type for your request. Link that I gave you contains sample."}, {"owner": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "edited": false, "score": 0, "creation_date": 1543694472, "post_id": 53573511, "comment_id": 94013303, "body": "I created the following struct <code>type money struct { \tBase     string  </code>json:&quot;base&quot;` \tCurrency string  <code>json:&quot;currency&quot;</code> \tAmount   float32 <code>json:&quot;amount&quot;</code> } `  and wrote the following code and  still It doesnt work (nothing gets displayed) <code>answer, _ := ioutil.ReadAll(response.Body)  \t\tres := money{} \t\tjson.Unmarshal([]byte(answer), &amp;res) \t\tfmt.Println(res) \t\tfmt.Println(res.Currency)</code>"}], "tags": [], "owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "is_accepted": true, "score": 1, "last_activity_date": 1543686784, "creation_date": 1543686784, "answer_id": 53573511, "question_id": 53573062, "link": "https://stackoverflow.com/questions/53573062/rendering-get-request-response-in-html-file/53573511#53573511", "title": "Rendering GET request response in HTML file", "body": "<p><code>fmt.Println(string(data))</code> from func getCurrency() prints into standard output. So you see resulting HTML in app console but it is not returned to browser.</p>\n\n<p><a href=\"https://golang.org/pkg/fmt/#Println\" rel=\"nofollow noreferrer\">https://golang.org/pkg/fmt/#Println</a>:</p>\n\n<blockquote>\n  <p>Println formats using the default formats for its operands and writes\n  to standard output.</p>\n</blockquote>\n\n<p>You need to send your bytes into <code>w http.ResponseWriter</code> handler argument:</p>\n\n<pre><code>fmt.Fprintln(w, string(data))\n</code></pre>\n\n<p><a href=\"https://golang.org/pkg/fmt/#Fprintln\" rel=\"nofollow noreferrer\">https://golang.org/pkg/fmt/#Fprintln</a></p>\n"}], "owner": {"reputation": 175, "user_id": 8255865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a85cb966bfff15d0efdc945340d328?s=128&d=identicon&r=PG&f=1", "display_name": "M.A.G", "link": "https://stackoverflow.com/users/8255865/m-a-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 53573511, "answer_count": 1, "score": 1, "last_activity_date": 1543686784, "creation_date": 1543683416, "last_edit_date": 1543686405, "question_id": 53573062, "link": "https://stackoverflow.com/questions/53573062/rendering-get-request-response-in-html-file", "title": "Rendering GET request response in HTML file", "body": "<p>I have just started learning REST APIs in Go and I cannot figure out how to display the response of the GET request in my HTML file.\nWhat I basically did is create a function <code>GetCurrency()</code> which gets data from a third-party API. Now I'm trying to render the response <code>Currency</code> in an HTML file but I don't seem to get it right as whenever the localhost loads <code>/getcurrency</code> I get a blank page although my <code>.gohtml</code> file contains a form.</p>\n\n<p>Here is my struct in the main.go file</p>\n\n<pre><code>type pageData struct {\n    Title    string\n    Currency string\n}\n</code></pre>\n\n<p>Here is my main function in the main.go file</p>\n\n<pre><code>func main() {\n    http.HandleFunc(\"/\", home)\n    http.HandleFunc(\"/home\", home)\n    http.HandleFunc(\"/getcurrency\", getCurrency)\n    http.ListenAndServe(\":5050\", nil)\n}\n</code></pre>\n\n<p>and here is my <code>home</code> function where the HTML is executed </p>\n\n<pre><code>func home(w http.ResponseWriter, req *http.Request) {\n\n    pd := pageData{\n        Title: \"Etmazec Home Page\",\n    }\n\n    err := tpl.ExecuteTemplate(w, \"homepage.gohtml\", pd)\n    if err != nil {\n        log.Println(err)\n        http.Error(w, \"Internal server error\", http.StatusInternalServerError)\n    }\n}\n</code></pre>\n\n<p>and here is my <code>getCurrency()</code> function in the <code>main.go</code> file</p>\n\n<pre><code>func getCurrency(w http.ResponseWriter, req *http.Request) {\n    pd := pageData{\n        Title: \"Welcome to the exchange rate website\",\n    }\n    err := tpl.ExecuteTemplate(w, \"currency.gohtml\", pd)\n    response, err := http.Get(\"https://api.coinbase.com/v2/prices/spot?currency=USD\")\n\n    if err != nil {\n        fmt.Printf(\"The http requst failed with error %s \\n\", err)\n    } else {\n        data, _ := ioutil.ReadAll(response.Body)\n        pd.Currency = string(data)\n        fmt.Println(string(data))\n    }\n}\n</code></pre>\n\n<p>Finally, here is my <code>currency.gohtml</code> body </p>\n\n<pre><code>&lt;body&gt;\n    &lt;h1&gt;TOP HITS&lt;/h1&gt;\n    &lt;nav&gt;\n        &lt;ul&gt;\n            &lt;li&gt;&lt;a href=\"/home\"&gt;HOME PAGE&lt;/a&gt;\n        &lt;/ul&gt;\n    &lt;/nav&gt;\n    &lt;form action=\"/getcurrency\" method=\"GET\"&gt;\n        &lt;label for=\"fname\"&gt;Your Name&lt;/label&gt;\n        &lt;input type=\"text\" name=\"fname\"&gt;\n        &lt;input type=\"submit\"&gt;\n    &lt;/form&gt;\n    {{.Currency}}\n      &lt;/body&gt;\n</code></pre>\n\n<p>and here is my <code>home.gohtml</code> file</p>\n\n<pre><code> &lt;!DOCTYPE html&gt;\n    &lt;html lang=\"en\"&gt;\n    &lt;head&gt;\n        &lt;meta charset=\"UTF-8\"&gt;\n        &lt;title&gt;Title&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;link rel=\"stylesheet\" href=\"/public/css/main.css\"&gt;\n    &lt;body&gt;\n\n    &lt;/body&gt;\n    &lt;/html&gt;\n\n    &lt;h1&gt;Currency HomePage&lt;/h1&gt;\n\n    &lt;nav&gt;\n        &lt;ul&gt;\n            &lt;li&gt;&lt;a href=\"/home\"&gt;HOME PAGE&lt;/a&gt;\n            &lt;li&gt;&lt;a href=\"/getcurrency\"&gt;The Currency&lt;/a&gt;\n        &lt;/ul&gt;\n    &lt;/nav&gt;\n</code></pre>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 3521, "user_id": 2304215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W708V.png?s=128&g=1", "display_name": "chrk", "link": "https://stackoverflow.com/users/2304215/chrk"}, "edited": false, "score": 4, "creation_date": 1543681257, "post_id": 53572736, "comment_id": 94009850, "body": "<a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">This</a> and <a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">this</a> should be very helpful."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1543681935, "post_id": 53572736, "comment_id": 94010026, "body": "See explanation in <a href=\"https://stackoverflow.com/questions/16248241/concatenate-two-slices-in-go/40036950#40036950\">this asnwer</a>."}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 1, "creation_date": 1543698735, "post_id": 53572736, "comment_id": 94014411, "body": "after messing about with this and reading all the docs referenced above I think I vaguely get it now.  The slice the append returns is somewhat like a pointer that references the memory that s1 holds."}, {"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1543702340, "post_id": 53572736, "comment_id": 94015277, "body": "@Vorsprung That&#39;s about right. But I wouldn&#39;t say it is memory that &quot;<code>s1</code> holds&quot; .  <code>s1</code>, <code>a</code> and <code>b</code> are slices that all reference the same underlying array. The memory is not &quot;held&quot; by one of the slices."}], "answers": [{"tags": [], "owner": {"reputation": 553, "user_id": 5594002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zz8CD.jpg?s=128&g=1", "display_name": "Ehsan.Saradar", "link": "https://stackoverflow.com/users/5594002/ehsan-saradar"}, "is_accepted": true, "score": 1, "last_activity_date": 1543729269, "creation_date": 1543729269, "answer_id": 53577737, "question_id": 53572736, "link": "https://stackoverflow.com/questions/53572736/append-to-a-new-slice-affect-original-slice/53577737#53577737", "title": "append to a new slice affect original slice", "body": "<p>Keep in mind that a slice is a structure of 3 fields.</p>\n\n<ul>\n<li>a pointer to the underlying array</li>\n<li>length of the slice</li>\n<li>capacity of the slice</li>\n</ul>\n\n<p>append() function may either modify its argument in-place or return a copy of its argument with an additional entry, depending on the size and capacity of its input. append() function creates a new slice, if the length the slice is greater than the length of the array pointed by the slice.</p>\n"}], "owner": {"reputation": 76, "user_id": 5020243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d89b4d1e68c76ad30313cd4effcf339?s=128&d=identicon&r=PG&f=1", "display_name": "lty", "link": "https://stackoverflow.com/users/5020243/lty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "accepted_answer_id": 53577737, "answer_count": 1, "score": 1, "last_activity_date": 1543729269, "creation_date": 1543681033, "last_edit_date": 1543681064, "question_id": 53572736, "link": "https://stackoverflow.com/questions/53572736/append-to-a-new-slice-affect-original-slice", "title": "append to a new slice affect original slice", "body": "<p>I have the following code which causes a weird result. I cannot understand why:</p>\n\n<pre><code>func main() {\n    var s = []int{2, 3}\n    var s1 = append(s, 4)\n    var a = append(s1, 5)\n    var b = append(s1, 6)\n    fmt.Println(s)\n    fmt.Println(s1)\n    fmt.Println(a)\n    fmt.Println(b)\n}\n</code></pre>\n\n<p>This then results in:</p>\n\n<pre><code>[2 3]\n[2 3 4]\n[2 3 4 6]\n[2 3 4 6]\n</code></pre>\n\n<p>My question is: why a is not [2 3 4 5] but [2 3 4 6]? I know append to b changes a, but how. Is this a bug because I never changed a directly and obviously I don't want this happen?</p>\n"}, {"tags": ["go", "grpc"], "comments": [{"owner": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 0, "creation_date": 1543697882, "post_id": 53572260, "comment_id": 94014193, "body": "Did you install proto-gen-go? If not, try running <code>go get github.com&#47;golang&#47;protobuf&#47;protoc-gen-go</code>"}], "answers": [{"tags": [], "owner": {"reputation": 137, "user_id": 2142558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73a0abbeea4cc96b427ff51350d3368c?s=128&d=identicon&r=PG", "display_name": "user2142558", "link": "https://stackoverflow.com/users/2142558/user2142558"}, "is_accepted": false, "score": 2, "last_activity_date": 1543851882, "creation_date": 1543851882, "answer_id": 53597151, "question_id": 53572260, "link": "https://stackoverflow.com/questions/53572260/go-out-protoc-gen-go-the-system-cannot-find-the-file-specified-windows-10/53597151#53597151", "title": "--go_out: protoc-gen-go: The system cannot find the file specified Windows 10", "body": "<p>I could solve that problem editing the environment variable PATH. I add %GOPATH%/bin and the command works. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7664194, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oW8gjiJmZ5M/AAAAAAAAAAI/AAAAAAAAAE0/JHZ6-W__Pbg/photo.jpg?sz=128", "display_name": "Abinash Patra", "link": "https://stackoverflow.com/users/7664194/abinash-patra"}, "is_accepted": false, "score": -2, "last_activity_date": 1566978629, "last_edit_date": 1566978629, "creation_date": 1566978446, "answer_id": 57687371, "question_id": 53572260, "link": "https://stackoverflow.com/questions/53572260/go-out-protoc-gen-go-the-system-cannot-find-the-file-specified-windows-10/57687371#57687371", "title": "--go_out: protoc-gen-go: The system cannot find the file specified Windows 10", "body": "<p>Make sure you have protobuf installed</p>\n\n<pre><code>brew install protobuf\ngo get -u github.com/golang/protobuf/protoc-gen-go\n</code></pre>\n\n<p>this should install protoc-gen-go into your $GOPATH/bin</p>\n\n<p>set your PATH environment variable to the above folder</p>\n\n<pre><code>PATH = :$GOPATH/bin:\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 2142558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73a0abbeea4cc96b427ff51350d3368c?s=128&d=identicon&r=PG", "display_name": "user2142558", "link": "https://stackoverflow.com/users/2142558/user2142558"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2594, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1566978629, "creation_date": 1543677957, "last_edit_date": 1566978597, "question_id": 53572260, "link": "https://stackoverflow.com/questions/53572260/go-out-protoc-gen-go-the-system-cannot-find-the-file-specified-windows-10", "title": "--go_out: protoc-gen-go: The system cannot find the file specified Windows 10", "body": "<p>I am trying to use this command <code>protoc greet\\greetpb\\greet.proto --go_out=plugins=grpc:</code>. I got that message </p>\n\n<blockquote>\n  <p>\"--go_out: protoc-gen-go: The system cannot find the file specified.\"</p>\n</blockquote>\n\n<p>My protoc version is libprotoc 3.6.1\nMy go version go version go1.11.2 windows/386\nAlso into my package list is this github.com/golang/protobuf/protoc-gen-go/grpc</p>\n\n<p>I am new using golang and I trying to learn grpc.\nCould someone helps me with that problem? I am using windows 10.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 0, "creation_date": 1543673789, "post_id": 53571646, "comment_id": 94007724, "body": "If it is not in your GOPATH, try running it using relative path e.g. <code>go test .&#47;fts&#47;command</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4445419"}, "edited": false, "score": 0, "creation_date": 1543675012, "post_id": 53571686, "comment_id": 94008072, "body": "I try it and it doestn work , maybe becouse i use ginkgo ? does it beave diffrently ?"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1543675422, "post_id": 53571686, "comment_id": 94008171, "body": "Ginkgo ties in to the testing framework, so that should be fine"}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 2, "last_activity_date": 1543673892, "creation_date": 1543673892, "answer_id": 53571686, "question_id": 53571646, "link": "https://stackoverflow.com/questions/53571646/run-go-test-for-specific-package/53571686#53571686", "title": "Run go test for specific package", "body": "<p>So you can run <code>go test</code> for a specific package by giving it the relative path:</p>\n\n<pre><code>go test ./fts/command\n</code></pre>\n\n<p>The <code>--run</code> flag takes a regular expression that helps dictates which tests will be ran within the package. </p>\n\n<p>For example if you had a test named <code>TestFoo(...)</code> and another <code>TestBar(...)</code>. <code>go test --run=TestFoo</code> will only run <code>TestFoo(...)</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4445419"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 805, "favorite_count": 0, "accepted_answer_id": 53571686, "answer_count": 1, "score": -1, "last_activity_date": 1543684502, "creation_date": 1543673589, "last_edit_date": 1543684502, "question_id": 53571646, "link": "https://stackoverflow.com/questions/53571646/run-go-test-for-specific-package", "title": "Run go test for specific package", "body": "<p>I used the following command to run test for specific package </p>\n\n<p><code>go test fts -run run_test.go</code></p>\n\n<blockquote>\n  <p>can't load package: package fts: cannot find package \"fts\" in any of:/usr/local/Cellar/go/1.11.1/libexec/src/integration (from $GOROOT)/Users/i055555/go/src/fts (from $GOPATH)</p>\n</blockquote>\n\n<p>And the package looks like </p>\n\n<pre><code>gitproj/\n    |---- fts\n      |---- -command\n        |---- -run.go\n         |---- -run_test.go\n    |---- internal\n        |---- -fs.go\n           |---- -tb.go\n           |---- -tb_test.go\n    main.go\n</code></pre>\n"}]