[{"tags": ["go", "concurrency", "pagination", "web-crawler", "screen-scraping"], "answers": [{"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": true, "score": 2, "last_activity_date": 1515648372, "creation_date": 1515648372, "answer_id": 48200286, "question_id": 48197821, "link": "https://stackoverflow.com/questions/48197821/golang-web-spider-with-pagination-processing/48200286#48200286", "title": "Golang web spider with pagination processing", "body": "<p>The problem is probably that <code>main</code> exits before all goroutine finished.</p>\n\n<p>First, there is a <code>break</code> after the <code>select</code> statement and it runs uncodintionally after first time a channel is read. That ensures the <code>main</code> func returns after the first time you send something over <code>channelBody</code>.</p>\n\n<p>Secondly, using <code>channelDone</code> is not the right way here. The most idomatic approach would be using a <code>sync.WaitGroup</code>. Before starting each goroutine, use <code>WG.Add(1)</code> and replace the <code>defer</code> with <code>defer WG.Done()</code>; In <code>main</code>, use <code>WG.Wait()</code>. Please be aware that you should use a pointer to refer to the <code>WaitGroup</code>. You can read more <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 13, "user_id": 9193562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uOhkm.jpg?s=128&g=1", "display_name": "himei", "link": "https://stackoverflow.com/users/9193562/himei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 612, "favorite_count": 0, "accepted_answer_id": 48200286, "answer_count": 1, "score": 1, "last_activity_date": 1515648372, "creation_date": 1515627543, "question_id": 48197821, "link": "https://stackoverflow.com/questions/48197821/golang-web-spider-with-pagination-processing", "title": "Golang web spider with pagination processing", "body": "<p>I'm working on a golang web crawler that should parse the search results on some specific search engine. The main difficulty - parsing with concurrency, or rather, in processing pagination such as \n<code>\u2190 Previous 1 2 3 4 5 ... 34 Next \u2192</code>.  All things work fine except recursive crawling of paginated results. Look at my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"errors\"\n    \"fmt\"\n    \"net\"\n    \"strings\"\n\n    \"github.com/antchfx/htmlquery\"\n    \"golang.org/x/net/html\"\n)\n\ntype Spider struct {\n    HandledUrls []string\n}\n\nfunc NewSpider(url string) *Spider {\n    // ...\n}\n\nfunc requestProvider(request string) string {\n    // Everything is good here\n}\n\nfunc connectProvider(url string) net.Conn {\n    // Also works\n}\n\n// getContents makes request to search engine and gets response body\nfunc getContents(request string) *html.Node {\n    // ...\n}\n\n// CheckResult controls empty search results\nfunc checkResult(node *html.Node) bool {\n    // ...\n}\n\nfunc (s *Spider) checkVisited(url string) bool {\n    // ...\n}\n\n// Here is the problems\nfunc (s *Spider) Crawl(url string, channelDone chan bool, channelBody chan *html.Node) {\n    body := getContents(url)\n\n    defer func() {\n        channelDone &lt;- true\n    }()\n\n    if checkResult(body) == false {\n        err := errors.New(\"Nothing found there\")\n        ErrFatal(err)\n    }\n\n    channelBody &lt;- body\n    s.HandledUrls = append(s.HandledUrls, url)\n    fmt.Println(\"Handled \", url)\n\n    newUrls := s.getPagination(body)\n\n    for _, u := range newUrls {\n        fmt.Println(u)\n    }\n\n    for i, newurl := range newUrls {\n        if s.checkVisited(newurl) == false {\n            fmt.Println(i)\n            go s.Crawl(newurl, channelDone, channelBody)\n        }\n    }\n}\n\nfunc (s *Spider) getPagination(node *html.Node) []string {\n    // ...\n}\n\nfunc main() {\n    request := requestProvider(*requestFlag)\n    channelBody := make(chan *html.Node, 120)\n    channelDone := make(chan bool)\n\n    var parsedHosts []*Host\n\n    s := NewSpider(request)\n\n    go s.Crawl(request, channelDone, channelBody)\n\n    for {\n        select {\n        case recievedNode := &lt;-channelBody:\n             // ...\n\n            for _, h := range newHosts {\n                 parsedHosts = append(parsedHosts, h)\n                 fmt.Println(\"added\", h.HostUrl)\n            }\n\n        case &lt;-channelDone:\n            fmt.Println(\"Jobs finished\")\n        }\n\n        break\n   }\n}\n</code></pre>\n\n<p>It always returns the <strong>first page only</strong>, no pagination. Same GetPagination(...) works good. Please tell me, where is my error(s).\nHope Google Translate was correct.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 2967920, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f5aa8bb3e35b31d8d34a9d2fcce48565?s=128&d=identicon&r=PG&f=1", "display_name": "user2967920", "link": "https://stackoverflow.com/users/2967920/user2967920"}, "edited": false, "score": 0, "creation_date": 1539770216, "post_id": 48197465, "comment_id": 92619527, "body": "Ping also creates a new connection everytime in my case :("}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "reply_to_user": {"reputation": 441, "user_id": 2967920, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f5aa8bb3e35b31d8d34a9d2fcce48565?s=128&d=identicon&r=PG&f=1", "display_name": "user2967920", "link": "https://stackoverflow.com/users/2967920/user2967920"}, "edited": false, "score": 1, "creation_date": 1539817893, "post_id": 48197465, "comment_id": 92643894, "body": "Ping, like other calls that reach the database, might create a new connection if no available connections exist. It depends on the implementation of your program and the driver. Go maintains a pool of connections and will reuse connections if possible. See <a href=\"http://go-database-sql.org/connection-pool.html\" rel=\"nofollow noreferrer\">connection pooling</a>."}], "tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": false, "score": 5, "last_activity_date": 1515625390, "last_edit_date": 1515625390, "creation_date": 1515625083, "answer_id": 48197465, "question_id": 48196746, "link": "https://stackoverflow.com/questions/48196746/using-ping-to-find-out-if-db-connection-is-alive-in-golang/48197465#48197465", "title": "Using Ping to find out if DB Connection is alive in Golang", "body": "<p>Probably better to execute a simple query and check the result. The Ping() method is safe to use, but is optional to implement by database drivers.</p>\n\n<p>See <a href=\"https://golang.org/pkg/database/sql/driver/#Pinger\" rel=\"noreferrer\">Ping()</a></p>\n"}, {"tags": [], "owner": {"reputation": 7629, "user_id": 2335820, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sLTHB.jpg?s=128&g=1", "display_name": "Kimmo Hintikka", "link": "https://stackoverflow.com/users/2335820/kimmo-hintikka"}, "is_accepted": true, "score": 12, "last_activity_date": 1515660925, "last_edit_date": 1515660925, "creation_date": 1515625305, "answer_id": 48197506, "question_id": 48196746, "link": "https://stackoverflow.com/questions/48196746/using-ping-to-find-out-if-db-connection-is-alive-in-golang/48197506#48197506", "title": "Using Ping to find out if DB Connection is alive in Golang", "body": "<p>I would say Ping() is the way to do it if you need to test the connection separate of running queries probably at program start only. </p>\n\n<p>Normally I just trust in the fact that database/sql will automatically try to reconnect in case if you are executing queries against DB and connection fails. So you could just use Open to check DB connection args are correct and trust query to return an error in case connection is lost. </p>\n\n<p>People say Ping() can cause race conditions but cannot demonstrate me how or provide a suitable alternative where connection test needed. </p>\n\n<p>This is how Gorm (widely used Golang ORM project) does it: </p>\n\n<pre><code>// Send a ping to make sure the database connection is alive.\n    if d, ok := dbSQL.(*sql.DB); ok {\n        if err = d.Ping(); err != nil {\n            d.Close()\n        }\n    }\n    return\n</code></pre>\n\n<p><a href=\"https://github.com/jinzhu/gorm\" rel=\"noreferrer\">https://github.com/jinzhu/gorm</a> </p>\n"}], "owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8076, "favorite_count": 1, "accepted_answer_id": 48197506, "answer_count": 2, "score": 11, "last_activity_date": 1515660925, "creation_date": 1515621402, "question_id": 48196746, "link": "https://stackoverflow.com/questions/48196746/using-ping-to-find-out-if-db-connection-is-alive-in-golang", "title": "Using Ping to find out if DB Connection is alive in Golang", "body": "<p>Is it safe to just ping the database to check if my golang app is still connected or is there a better solution than this? I've read somewhere that we should not use .ping() to determine a connection loss.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["node.js", "go", "npm"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1515616763, "post_id": 48195672, "comment_id": 83372321, "body": "<code>..&#47;app&#47;node&#47;</code> is a directory, not an executable."}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515616876, "post_id": 48195672, "comment_id": 83372375, "body": "@JimB - The <code>&#47;app&#47;node&#47;</code> is a directory with node program with package.json, how can I do it ?"}, {"owner": {"reputation": 2354, "user_id": 6540936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5365ef69ba8eeefddfaff5cc1750dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/6540936/julian"}, "edited": false, "score": 1, "creation_date": 1515617085, "post_id": 48195672, "comment_id": 83372466, "body": "Remove the first argument from <code>exec.Command</code> and set <code>command.Dir = &quot;..&#47;app&#47;node&#47;&quot;</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515617308, "post_id": 48195672, "comment_id": 83372580, "body": "It&#39;s also unlikely that the binary would always be located relative to your working directory as <code>..&#47;app&#47;node&#47;npm</code>. Are you looking to change the working directory of the command, which you can do with the <a href=\"https://golang.org/pkg/os/exec/#Cmd\" rel=\"nofollow noreferrer\"><code>Dir</code></a> field?"}], "answers": [{"comments": [{"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1515617293, "post_id": 48195772, "comment_id": 83372572, "body": "Thanks, i&#39;ll try it now. any idea if I can print the logs from the npm install?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1515617688, "post_id": 48195772, "comment_id": 83372789, "body": "Yes. There&#39;s <code>CombinedOutput</code>, <code>Output</code>, <code>StderrPipe</code>, and <code>StdoutPipe</code>, all covered in the documentation."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 4, "last_activity_date": 1515617100, "creation_date": 1515617100, "answer_id": 48195772, "question_id": 48195672, "link": "https://stackoverflow.com/questions/48195672/npm-install-from-golang-program/48195772#48195772", "title": "npm install from golang program", "body": "<p>You've got your arguments to <code>Command</code> in the wrong order. <a href=\"https://golang.org/pkg/os/exec/#Command\" rel=\"nofollow noreferrer\">Per the documentation</a>, the first argument is the program to be executed (i.e. <code>npm</code>), the following arguments are the parameters to pass, in the order that command should receive them, e.g.:</p>\n\n<pre><code>command := exec.Command(\"npm\", \"install\", \"../app/node/\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 399, "user_id": 8264607, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WQKpnhD7pmQ/AAAAAAAAAAI/AAAAAAAAABM/vjTCAvnmiD0/photo.jpg?sz=128", "display_name": "scriptonist", "link": "https://stackoverflow.com/users/8264607/scriptonist"}, "is_accepted": false, "score": 2, "last_activity_date": 1515752978, "creation_date": 1515752978, "answer_id": 48224307, "question_id": 48195672, "link": "https://stackoverflow.com/questions/48195672/npm-install-from-golang-program/48224307#48224307", "title": "npm install from golang program", "body": "<p>The format for executing a command using <code>Command</code> is as follows\n<code>\nc := exec.Command(&lt;command&gt;,&lt;args&gt;...)\n</code>\nIn your case the command is <code>npm</code>.\nTherefore the code should be like the following and you can bind <code>stdout</code> and <code>stderr</code> of the command to shell.So that you can view <code>npm</code> logs. </p>\n\n<pre><code>command := exec.Command(\"../app/node/npm\",\"install\")\ncommand.Stdout = os.Stdout\ncommand.Stderr = os.Stderr\n// Run the command\ncommand.Run()\n</code></pre>\n"}], "owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1209, "favorite_count": 1, "accepted_answer_id": 48195772, "answer_count": 2, "score": -2, "last_activity_date": 1515752978, "creation_date": 1515616663, "question_id": 48195672, "link": "https://stackoverflow.com/questions/48195672/npm-install-from-golang-program", "title": "npm install from golang program", "body": "<p>I need to run npm install on folder that I was created </p>\n\n<p>Im doing the following</p>\n\n<pre><code>command := exec.Command(\"../app/node/\", \"npm\", \"install\")\ncommand.Dir = \".\"\noutput, err := command.Output()\nif err != nil {\n    log.Println(err)\n}\nfmt.Printf(\"%s\", output)\n</code></pre>\n\n<p><strong>And I get error :</strong></p>\n\n<pre><code>fork/exec ../app/node/: permission denied\n</code></pre>\n\n<p>Any idea how to overcome this?</p>\n"}, {"tags": ["testing", "go", "mocking"], "comments": [{"owner": {"reputation": 996, "user_id": 3922521, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/OjOBy.png?s=128&g=1", "display_name": "Milliron X", "link": "https://stackoverflow.com/users/3922521/milliron-x"}, "edited": false, "score": 0, "creation_date": 1515611859, "post_id": 48193800, "comment_id": 83369834, "body": "Please explain what your code is trying to accomplish."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1515613443, "post_id": 48193800, "comment_id": 83370614, "body": "If you want to mock both <code>realX</code> and <code>realY</code> you can implement a thin wrapper around <code>realX</code> that returns <code>realY</code> as your type <code>myY</code> <a href=\"https://play.golang.org/p/0mW86sXziwF\" rel=\"nofollow noreferrer\">play.golang.org/p/0mW86sXziwF</a>."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1515617395, "post_id": 48193800, "comment_id": 83372632, "body": "That is explained in the FAQ in the golang website."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 6, "last_activity_date": 1515608453, "creation_date": 1515608453, "answer_id": 48193828, "question_id": 48193800, "link": "https://stackoverflow.com/questions/48193800/go-type-error-struct-does-not-implement-interface/48193828#48193828", "title": "Go type-error: struct does not implement interface", "body": "<p>No, it doesn't implement <code>myY</code>, as the error clearly states:</p>\n\n<pre><code>realX does not implement myX (wrong type for Do method)\n    have Do() realY\n    want Do() myY\n</code></pre>\n\n<p>The method signature <em>must match exactly</em> for the type to implement the interface. The method signatures do not match - the return types are different. It doesn't matter if <code>realY</code> implements <code>myY</code>; the signatures are not the same.</p>\n"}], "owner": {"reputation": 13, "user_id": 9200095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12a37bd4751d867ec4fd15bcb8a0eea2?s=128&d=identicon&r=PG&f=1", "display_name": "user9200095", "link": "https://stackoverflow.com/users/9200095/user9200095"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 0, "closed_date": 1570832434, "answer_count": 1, "score": -6, "last_activity_date": 1515608453, "creation_date": 1515608353, "question_id": 48193800, "link": "https://stackoverflow.com/questions/48193800/go-type-error-struct-does-not-implement-interface", "closed_reason": "Duplicate", "title": "Go type-error: struct does not implement interface", "body": "<pre><code>// BEGIN: external library\n\ntype realX struct {}\n\ntype realY struct {}\n\nfunc (realX) Do() realY {\n  return realY{}\n}\n\n// END\n\ntype A struct {\n  a myX\n}\n\ntype myY interface {}\n\ntype myX interface {\n  Do() myY\n}\n\nfunc foo (arg1 myY) {\n}\n\nfunc main() {\n    foo(realY{})\n    x := A{realX{}}\n    fmt.Println(\"Hello, playground\")\n}\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>cannot use realX literal (type realX) as type myX in field value:\n    realX does not implement myX (wrong type for Do method)\n        have Do() realY\n        want Do() myY\n</code></pre>\n\n<p>From the looks of it, realY implements myY, so why can't I do this? This is making it impossible to write mock unit tests cleanly.</p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1515600169, "post_id": 48191229, "comment_id": 83363143, "body": "Pass <code>object</code> instead of <code>&amp;object</code>."}, {"owner": {"reputation": 1, "user_id": 8889348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82e6a8e3d9a2155480744d204ff1460?s=128&d=identicon&r=PG&f=1", "display_name": "jh_", "link": "https://stackoverflow.com/users/8889348/jh"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515608188, "post_id": 48191229, "comment_id": 83367922, "body": "More coffee or more sleep, thanks. ;)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8889348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82e6a8e3d9a2155480744d204ff1460?s=128&d=identicon&r=PG&f=1", "display_name": "jh_", "link": "https://stackoverflow.com/users/8889348/jh"}, "is_accepted": false, "score": 0, "last_activity_date": 1516518220, "last_edit_date": 1516518220, "creation_date": 1515608340, "answer_id": 48193794, "question_id": 48191229, "link": "https://stackoverflow.com/questions/48191229/golang-gorm-wrap-function/48193794#48193794", "title": "golang gorm wrap function", "body": "<p>See comment from Adrian. Many thanks, open my tired eyes.</p>\n\n<blockquote>\n  <p>Pass <code>object</code> instead of <code>&amp;object</code></p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 8889348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82e6a8e3d9a2155480744d204ff1460?s=128&d=identicon&r=PG&f=1", "display_name": "jh_", "link": "https://stackoverflow.com/users/8889348/jh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 382, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1527756866, "creation_date": 1515599398, "last_edit_date": 1527756866, "question_id": 48191229, "link": "https://stackoverflow.com/questions/48191229/golang-gorm-wrap-function", "title": "golang gorm wrap function", "body": "<p>What I like to do is something like, wrap the gorm functionality behinde some functions without specific struct params.</p>\n\n<pre><code>func (e *Engine) Create(object interface{}) error {\n    tx := e.db.Begin()\n    if err := tx.Create(&amp;object).Error; err != nil {\n        tx.Rollback()\n        return err\n    }\n    tx.Commit()\n\n    return nil\n}\n</code></pre>\n\n<p>The specific table exists, created with <code>db.CreateTable(&amp;&lt;specific struct{})</code>.\nBut the it fails with the following error:</p>\n\n<pre><code>Can't create &lt;specific struct&gt;: no such table: \n</code></pre>\n\n<p>Is this a way to go with gorm/golang or not and if how this is to wrap?</p>\n"}, {"tags": ["go", "symbols", "erase"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1515596137, "post_id": 48190115, "comment_id": 83360253, "body": "What OS are you running this on?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1515596176, "post_id": 48190115, "comment_id": 83360284, "body": "How to do this depends on which OS you&#39;re using. If you&#39;re on a Unix-like OS, something like <a href=\"https://github.com/rthornton128/goncurses\" rel=\"nofollow noreferrer\">goncurses</a> may be what you need."}, {"owner": {"reputation": 427, "user_id": 6254868, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-coh80Kgp5wI/AAAAAAAAAAI/AAAAAAAAAEM/YAQYO15Emg0/photo.jpg?sz=128", "display_name": "\u041e\u043b\u0435\u0433 \u0421\u0438\u0434\u043e\u0440\u043e\u0432", "link": "https://stackoverflow.com/users/6254868/%d0%9e%d0%bb%d0%b5%d0%b3-%d0%a1%d0%b8%d0%b4%d0%be%d1%80%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1515597947, "post_id": 48190115, "comment_id": 83361507, "body": "Hello! My app is crossplatform, so I need to work with *nix and Windows too."}], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 5, "last_activity_date": 1543234362, "last_edit_date": 1543234362, "creation_date": 1515600215, "answer_id": 48191470, "question_id": 48190115, "link": "https://stackoverflow.com/questions/48190115/golang-erase-symbols-from-console/48191470#48191470", "title": "golang erase symbols from console", "body": "<p>All you need to do is print a space (0x20) when you are done and that will overwrite the spinner.</p>\n\n<p>ie: <code>fmt.Fprint(os.Stdout, \"\\r \\r\")</code> to put the cursor back to beginning of line after the space.</p>\n"}, {"tags": [], "owner": {"reputation": 2476, "user_id": 5788720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tkE-8jM--HE/AAAAAAAAAAI/AAAAAAAAAEw/g51C7_m9JWU/photo.jpg?sz=128", "display_name": "Iain Duncan", "link": "https://stackoverflow.com/users/5788720/iain-duncan"}, "is_accepted": false, "score": 2, "last_activity_date": 1515600700, "creation_date": 1515600700, "answer_id": 48191639, "question_id": 48190115, "link": "https://stackoverflow.com/questions/48190115/golang-erase-symbols-from-console/48191639#48191639", "title": "golang erase symbols from console", "body": "<pre><code>fmt.Print(\"\\033[H\\033[2J\")\n</code></pre>\n\n<p>This will put the cursor in the top left then clear the console as per this document of useful terminal commands:</p>\n\n<p><a href=\"https://www.student.cs.uwaterloo.ca/~cs452/terminal.html\" rel=\"nofollow noreferrer\">https://www.student.cs.uwaterloo.ca/~cs452/terminal.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 427, "user_id": 6254868, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-coh80Kgp5wI/AAAAAAAAAAI/AAAAAAAAAEM/YAQYO15Emg0/photo.jpg?sz=128", "display_name": "\u041e\u043b\u0435\u0433 \u0421\u0438\u0434\u043e\u0440\u043e\u0432", "link": "https://stackoverflow.com/users/6254868/%d0%9e%d0%bb%d0%b5%d0%b3-%d0%a1%d0%b8%d0%b4%d0%be%d1%80%d0%be%d0%b2"}, "is_accepted": false, "score": 3, "last_activity_date": 1516090223, "creation_date": 1516090223, "answer_id": 48276641, "question_id": 48190115, "link": "https://stackoverflow.com/questions/48190115/golang-erase-symbols-from-console/48276641#48276641", "title": "golang erase symbols from console", "body": "<blockquote>\n  <p>All you need to do is print a space (0x20) when you are done and that\n  will overwrite the spinner.</p>\n  \n  <p>ie: fmt.Fprint(\"\\r \\r\") to put the cursor back to beginning of line\n  after the space.</p>\n</blockquote>\n\n<p>This answer is helpful, thank you!\nBut, there is an important detail!\nBecause the spinner function has a delay, it cannot stop exactly when StopSpinner boolean flag is set to true. So, I have added a channel for synchronization.</p>\n\n<pre><code>func Spinner(delay time.Duration) {\n    for !StopSpinner {\n        for _, r := range `-\\|/` {\n            fmt.Printf(\"\\r%c\", r)\n            time.Sleep(delay)\n        }\n    }\n    fmt.Fprint(\"\\r \\r\")\n    c &lt;- struct{}{}\n}\n</code></pre>\n\n<p>Now, calling function waits, while my spinner stop.</p>\n\n<pre><code>var c chan struct{} = make(chan struct{}) // event marker\n\nfunc callingFunc(){\n  StopSpinner = false\n  go Spinner(100 * time.Millisecond)\n\n  // do something...\n   StopSpinner = true\n\n   &lt;-c // wait spinner stop\n\n   //do something else\n}\n</code></pre>\n\n<p>In my opinion, this is the complete solution!</p>\n"}], "owner": {"reputation": 427, "user_id": 6254868, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-coh80Kgp5wI/AAAAAAAAAAI/AAAAAAAAAEM/YAQYO15Emg0/photo.jpg?sz=128", "display_name": "\u041e\u043b\u0435\u0433 \u0421\u0438\u0434\u043e\u0440\u043e\u0432", "link": "https://stackoverflow.com/users/6254868/%d0%9e%d0%bb%d0%b5%d0%b3-%d0%a1%d0%b8%d0%b4%d0%be%d1%80%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2156, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1543234362, "creation_date": 1515596100, "question_id": 48190115, "link": "https://stackoverflow.com/questions/48190115/golang-erase-symbols-from-console", "title": "golang erase symbols from console", "body": "<p>I want to create animation in console, when program waits. There are a lot of simple ways to do this, usually, we just draw symbols in iterations of some cycle.\nLet our code be:</p>\n\n<pre><code>func Spinner(delay time.Duration) {\n    for !StopSpinner{\n        for _, r := range `-\\|/` {\n            fmt.Printf(\"\\r%c\", r)\n            time.Sleep(delay)\n        }\n    }\n}\n</code></pre>\n\n<p>The problem is - how to remove animation, when there is no need in it from the console screen.\nI tried escape sequences like fmt.Print(\"\\b\") or fmt.Printf(\"\\r%s\", \"\") but no result. I can not remove last symbol from screen and it concatenates with next text. How do you erase characters already printed to the console?</p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515591735, "post_id": 48188635, "comment_id": 83357238, "body": "You&#39;re intentionally bypassing any safety checks. You need to properly convert your <code>[]string</code> first. See the answer to <a href=\"https://stackoverflow.com/questions/45997786/passing-array-of-string-as-parameter-from-go-to-c-function\" title=\"passing array of string as parameter from go to c function\">stackoverflow.com/questions/45997786/&hellip;</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515591993, "post_id": 48188635, "comment_id": 83357393, "body": "The runtime panics because passing pointers to Go allocated memory is not allowed. While the GC doesn&#39;t move memory (yet), it&#39;s far too easy for it to collect a value that goes out of scope as it&#39;s being passed to a C function."}], "answers": [{"comments": [{"owner": {"reputation": 390, "user_id": 1579455, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ac2c7b0a11fc51568da8e66e5868b68f?s=128&d=identicon&r=PG", "display_name": "Jon Scobie", "link": "https://stackoverflow.com/users/1579455/jon-scobie"}, "edited": false, "score": 0, "creation_date": 1515594448, "post_id": 48188927, "comment_id": 83359035, "body": "The problem is when using swig, it deals with the raw go pointers by using the same underlying type in C. I don&#39;t really understand why it all works when just using s as in my given example and fails with ns. I understand your given solution but need to now work it into the swig bindings."}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": false, "score": 1, "last_activity_date": 1515592242, "creation_date": 1515592242, "answer_id": 48188927, "question_id": 48188635, "link": "https://stackoverflow.com/questions/48188635/runtime-error-with-cgo-and-certain-string-slices/48188927#48188927", "title": "Runtime error with cgo and certain string slices", "body": "<p>You're basically passing the raw Go pointers.\nInstead, you should build <code>C</code> arrays yourself.</p>\n\n<p>As a general rule, seeing <code>unsafe</code> pretty much anywhere should make you suspicious. It is rarely the right way around issues with cgo.</p>\n\n<p>Using the helpers from <a href=\"https://stackoverflow.com/questions/45997786/passing-array-of-string-as-parameter-from-go-to-c-function\">Passing array of string as parameter from go to C function</a> and using them in your code:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"reflect\"\n)\n\n/*\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid prtText(char * const *txt, int len)\n{\n    int i = 0;\n\n    for ( i=0; i&lt;len; i++ ) {\n        printf(\"Text %d is: %s\\n\", i, txt[i]);\n    }\n}\n\nstatic char**makeCharArray(int size) {\n        return calloc(sizeof(char*), size);\n}\n\nstatic void setArrayString(char **a, char *s, int n) {\n        a[n] = s;\n}\n\nstatic void freeCharArray(char **a, int size) {\n        int i;\n        for (i = 0; i &lt; size; i++)\n                free(a[i]);\n        free(a);\n}\n\n*/\nimport \"C\"\n\nfunc main() {\n  s := []string{}\n\n  s = append(s, \"blah\")\n  s = append(s, \"hello\")\n  s = append(s, \"again\")\n\n  ns := []string{}\n\n  ns = append(ns, \"ns: \"+s[0])\n  ns = append(ns, \"ns: \"+s[1])\n  ns = append(ns, \"ns: \"+s[2])\n\n  fmt.Println(\"type s:\", reflect.TypeOf(s))\n  fmt.Println(\"type ns:\", reflect.TypeOf(ns))\n  fmt.Println(\"s:\", s)\n  fmt.Println(\"ns:\", ns)\n\n  sargs := C.makeCharArray(C.int(len(s)))\n  defer C.freeCharArray(sargs, C.int(len(s)))\n  for i, p := range s {\n    C.setArrayString(sargs, C.CString(p), C.int(i))\n  }\n\n  nsargs := C.makeCharArray(C.int(len(ns)))\n  defer C.freeCharArray(nsargs, C.int(len(ns)))\n  for i, p := range ns {\n    C.setArrayString(nsargs, C.CString(p), C.int(i))\n  }\n\n  C.prtText(sargs, C.int(len(s)))\n  C.prtText(nsargs, C.int(len(ns)))\n}\n</code></pre>\n\n<p>The output is now as expected:</p>\n\n<pre><code>$ ./main \ntype s: []string\ntype ns: []string\ns: [blah hello again]\nns: [ns: blah ns: hello ns: again]\nText 0 is: blah\nText 1 is: hello\nText 2 is: again\nText 0 is: ns: blah\nText 1 is: ns: hello\nText 2 is: ns: again\n</code></pre>\n"}], "owner": {"reputation": 390, "user_id": 1579455, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ac2c7b0a11fc51568da8e66e5868b68f?s=128&d=identicon&r=PG", "display_name": "Jon Scobie", "link": "https://stackoverflow.com/users/1579455/jon-scobie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515592242, "creation_date": 1515591270, "last_edit_date": 1515591688, "question_id": 48188635, "link": "https://stackoverflow.com/questions/48188635/runtime-error-with-cgo-and-certain-string-slices", "title": "Runtime error with cgo and certain string slices", "body": "<p>I have stripped back a problem I have come across whilst wrapping some C code to work with golang using swig but the problem doesn't rest with swig.</p>\n\n<p>I can pass in a basic string slice but as soon as I construct the slice with anything other than basic strings, I get a panic: runtime error: cgo argument has Go pointer to Go pointer.</p>\n\n<pre><code>go version go1.8.5 linux/amd64\n</code></pre>\n\n<p>This is the sample code and its output</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n    \"unsafe\"\n)\n\n/*\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct { char *p; int n; } _gostring_;\ntypedef struct { void* array; int len; int cap; } _goslice_;\n\nvoid prtText(char * const *txt, int len)\n{\n    int i = 0;\n\n    for ( i=0; i&lt;len; i++ ) {\n        printf(\"Text %d is: %s\\n\", i, txt[i]);\n    }\n}\n\nvoid _wrap_printText(_goslice_ _swig_go_0) {\n\n  _gostring_ *p;\n\n  char **arg1 = (char **)calloc(_swig_go_0.len, sizeof(char*));\n  if (arg1) {\n    for (int i=0; i&lt;_swig_go_0.len; i++) {\n      p = &amp;(((_gostring_*)_swig_go_0.array)[i]);\n      arg1[i] = calloc(1,(p-&gt;n)+1);\n      strncpy(arg1[i], p-&gt;p, p-&gt;n);\n    }\n  }\n  int arg2 = _swig_go_0.len;\n\n  prtText((char *const *)arg1,arg2);\n}\n\n*/\nimport \"C\"\n\nfunc PrintText(arg1 []string) {\n    C._wrap_printText(*(*C._goslice_)(unsafe.Pointer(&amp;arg1)))\n}\n\nfunc main() {\n    s := []string{}\n\n    s = append(s, \"blah\")\n    s = append(s, \"hello\")\n    s = append(s, \"again\")\n\n    ns := []string{}\n\n    ns = append(ns, \"ns: \"+s[0])\n    ns = append(ns, \"ns: \"+s[1])\n    ns = append(ns, \"ns: \"+s[2])\n\n    fmt.Println(\"type s:\", reflect.TypeOf(s))\n    fmt.Println(\"type ns:\", reflect.TypeOf(ns))\n    fmt.Println(\"s:\", s)\n    fmt.Println(\"ns:\", ns)\n\n    PrintText(s)\n    PrintText(ns)\n}\n\n\ngo build -i -x -gcflags '-N -l' main.go\n\n./main\ntype s: []string\ntype ns: []string\ns: [blah hello again]\nns: [ns: blah ns: hello ns: again]\nText 0 is: blah\nText 1 is: hello\nText 2 is: again\npanic: runtime error: cgo argument has Go pointer to Go pointer\n</code></pre>\n\n<p>As you can see, the first string slice works fine but as soon as I do anything other than basic strings, it fails. I've tried making new strings first before appending them to the slice but the problem remains.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["for-loop", "go", "concurrency"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 3, "creation_date": 1515588791, "post_id": 48187901, "comment_id": 83355442, "body": "Please show the code around your main loop. It doesn&#39;t look like you&#39;re waiting for the goroutines to exit. I would expect to see something like a <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\">sync.WaitGroup</a>"}, {"owner": {"reputation": 379, "user_id": 5871675, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NhTJa.png?s=128&g=1", "display_name": "Milos Grujic", "link": "https://stackoverflow.com/users/5871675/milos-grujic"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515588868, "post_id": 48187901, "comment_id": 83355503, "body": "There is no code after for loop, it is the end of the func main()."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 6, "creation_date": 1515589025, "post_id": 48187901, "comment_id": 83355621, "body": "Then that is your problem. Your program exits before anything is written."}], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 15, "last_activity_date": 1515589181, "creation_date": 1515589181, "answer_id": 48188074, "question_id": 48187901, "link": "https://stackoverflow.com/questions/48187901/program-exits-before-done-concurrency-issue-in-for-loop-goroutine-not-workin/48188074#48188074", "title": "Program exits before done - concurrency issue in for loop - goroutine not working", "body": "<p>You're not waiting for your goroutines to finish. This means that as soon as your for loop is done launching all the goroutines, the program exits. Any goroutine still running is aborted.</p>\n\n<p>You can use a <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"noreferrer\">sync.WaitGroup</a> as a simple way to wait for execution to be finished:</p>\n\n<pre><code>var wg sync.WaitGroup\nfor key, val := range varValMap {\n    wg.Add(1)\n    go writeCsv(&amp;wg, key, val)\n}\nwg.Wait()\n</code></pre>\n\n<p>And change your <code>writeCsv</code> to notify the wait group:</p>\n\n<pre><code>func writeCsv(wg *sync.WaitGroup, variable string, values []string) {\n    defer wg.Done()\n    // do everything.\n}\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 5871675, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NhTJa.png?s=128&g=1", "display_name": "Milos Grujic", "link": "https://stackoverflow.com/users/5871675/milos-grujic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 48188074, "answer_count": 1, "score": 2, "last_activity_date": 1601296658, "creation_date": 1515588631, "last_edit_date": 1601296658, "question_id": 48187901, "link": "https://stackoverflow.com/questions/48187901/program-exits-before-done-concurrency-issue-in-for-loop-goroutine-not-workin", "title": "Program exits before done - concurrency issue in for loop - goroutine not working", "body": "<p><strong>My Go project breaks when I try to write concurrently.</strong></p>\n\n<p>I have a map <code>map[string][]strings</code>. I want to write files concurrently, which are named as <code>key + \".csv\"</code> and for each value of <code>[]strings</code> write another row to the file with the value in it.</p>\n\n<p><strong>What I've done:</strong></p>\n\n<pre><code>for key, val := range varValMap {\n        go writeCsv(key, val)\n    }\n</code></pre>\n\n<p><strong>And the func is:</strong></p>\n\n<pre><code>func writeCsv(variable string, values []string) {\n    fName := variable + \".csv\"\n    fPath := filepath.Join(xmlFolder, \"_varval\", fName)\n    file, err := os.Create(fPath)\n    check(err)\n    defer file.Close()\n    for _, value := range values {\n        fmt.Fprintf(file, value + \"\\n\")\n    }\n}\n</code></pre>\n\n<p>The program finishes with no problems detectable by me, yet with no complete result (some files are written but nothing in them), also when I remove <code>go</code> from <code>go writeCsv(key, val)</code> all is well in go land.</p>\n"}, {"tags": ["go", "structure"], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 113, "user_id": 6103729, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/829073687198218/picture?type=large", "display_name": "Utkarsh Mani Tripathi", "link": "https://stackoverflow.com/users/6103729/utkarsh-mani-tripathi"}, "edited": false, "score": 0, "creation_date": 1515590942, "post_id": 48186533, "comment_id": 83356752, "body": "@UtkarshManiTripathi: Don&#39;t forget to accept the answer if you found it helpful."}, {"owner": {"reputation": 113, "user_id": 6103729, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/829073687198218/picture?type=large", "display_name": "Utkarsh Mani Tripathi", "link": "https://stackoverflow.com/users/6103729/utkarsh-mani-tripathi"}, "edited": false, "score": 0, "creation_date": 1515680712, "post_id": 48186533, "comment_id": 83399454, "body": "@Filmzy i don&#39;t have 15 reputation yet to upvote your answer :("}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 6, "last_activity_date": 1515584683, "last_edit_date": 1515584683, "creation_date": 1515583994, "answer_id": 48186533, "question_id": 48186467, "link": "https://stackoverflow.com/questions/48186467/how-to-assign-value-to-the-slice-of-structure/48186533#48186533", "title": "How to assign value to the slice of structure", "body": "<p>You're using a named type (<code>ReplicaStatus</code>), but then trying to define your struct fields anyway:</p>\n\n<pre><code> status: []v1.ReplicaStatus {\n         IP              string\n         Status          string\n         DataUpdateIndex string\n}{\n</code></pre>\n\n<p>Don't do that. Instead, do this:</p>\n\n<pre><code> status: []v1.ReplicaStatus{\n   {\n       IP:              \"10.10.10.10\",\n       Status:          \"Online\",\n       DataUpdateIndex: \"1\",\n   },\n   {\n       IP:              \"10.10.10.11\",\n       Status:          \"Online\",\n       DataUpdateIndex: \"1\",\n   },\n }\n</code></pre>\n\n<p>You should only define field names in this context, if you are using an unnamed type, as in:</p>\n\n<pre><code>status := []struct { // Notice this is now an anonymous struct type\n         IP              string\n         Status          string\n         DataUpdateIndex string\n}{\n   {\n       IP:              \"10.10.10.10\",\n       Status:          \"Online\",\n       DataUpdateIndex: \"1\",\n   },\n   {\n       IP:              \"10.10.10.11\",\n       Status:          \"Online\",\n       DataUpdateIndex: \"1\",\n   },\n }\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 6103729, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/829073687198218/picture?type=large", "display_name": "Utkarsh Mani Tripathi", "link": "https://stackoverflow.com/users/6103729/utkarsh-mani-tripathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 937, "favorite_count": 0, "accepted_answer_id": 48186533, "answer_count": 1, "score": 0, "last_activity_date": 1573677092, "creation_date": 1515583804, "last_edit_date": 1573677092, "question_id": 48186467, "link": "https://stackoverflow.com/questions/48186467/how-to-assign-value-to-the-slice-of-structure", "title": "How to assign value to the slice of structure", "body": "<p>I am using table driven test for my method but getting error while assigning the value to the field which is the array of structure, situation is something like given below.</p>\n\n<pre><code>var validStats = []struct{\n    status       []v1.ReplicaStatus\n}{\n   {\n     status: []v1.ReplicaStatus {\n             IP              string\n             Status          string\n             DataUpdateIndex string\n    }{\n       {\n           IP:              \"10.10.10.10\",\n           Status:          \"Online\",\n           DataUpdateIndex: \"1\",\n       },\n       {\n           IP:              \"10.10.10.11\",\n           Status:          \"Online\",\n           DataUpdateIndex: \"1\",\n       },\n     },\n   }\n}\n</code></pre>\n\n<p>and I'm getting the error <code>missing ',' in composite literal</code> at line no 6 and at the end of the code.What is wrong with this?</p>\n"}, {"tags": ["go", "random"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 3, "creation_date": 1515569770, "post_id": 48182374, "comment_id": 83344302, "body": "Exactly the same way? Generate 16 digits and join them. Hint (if you actually need a number not a string): <code>v = v * 10 + randomDigit</code>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1515573318, "post_id": 48182374, "comment_id": 83346002, "body": "It&#39;s probably more efficient (in both Go and Ruby) to just generate a single random number between 0 and 1*10\u02c616-1."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1515573940, "post_id": 48182374, "comment_id": 83346381, "body": "Also for a fast general solution (when you need not just digits and / or you need longer than what fits into an <code>int64</code>), see <a href=\"https://stackoverflow.com/questions/22892120/how-to-generate-a-random-string-of-a-fixed-length-in-golang/31832326#31832326\">How to generate a random string of a fixed length in golang?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 24536, "user_id": 111124, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8215e290861f1c44a457d26c4f24af70?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/111124/andrew"}, "edited": false, "score": 0, "creation_date": 1515586914, "post_id": 48182497, "comment_id": 83354320, "body": "Wouldn&#39;t you want to seed that random in some form?"}, {"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "reply_to_user": {"reputation": 24536, "user_id": 111124, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8215e290861f1c44a457d26c4f24af70?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/111124/andrew"}, "edited": false, "score": 0, "creation_date": 1515657402, "post_id": 48182497, "comment_id": 83385267, "body": "@Andrew Yes, you surely need to <a href=\"https://golang.org/pkg/math/rand/#Seed\" rel=\"nofollow noreferrer\">seed</a>.  Check <a href=\"https://stackoverflow.com/questions/12321133/golang-random-number-generator-how-to-seed-properly\" title=\"golang random number generator how to seed properly\">stackoverflow.com/questions/12321133/&hellip;</a> for that."}], "tags": [], "owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "is_accepted": true, "score": 3, "last_activity_date": 1515572785, "last_edit_date": 1515572785, "creation_date": 1515570186, "answer_id": 48182497, "question_id": 48182374, "link": "https://stackoverflow.com/questions/48182374/generating-fixed-length-random-number-in-go-lang/48182497#48182497", "title": "Generating fixed length random number in Go lang", "body": "<p>One way is:</p>\n\n<pre><code>s := \"\"\nfor i := 0; i &lt; 16; i++ {\n    s += (string)(rand.Intn(10) + 48)\n}\n</code></pre>\n\n<p>48 is the ascii value for <code>0</code>.</p>\n\n<p>Or by using @Flimzy's more efficient suggestion:</p>\n\n<pre><code>s := fmt.Sprintf(\"%016d\", rand.Int63n(1e16))\n</code></pre>\n\n<p>where <code>\"%016d\"</code> will help pad the number with zeros.</p>\n"}], "owner": {"reputation": 298, "user_id": 2935870, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1652437319/picture?type=large", "display_name": "Agniswar Bakshi", "link": "https://stackoverflow.com/users/2935870/agniswar-bakshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1128, "favorite_count": 0, "accepted_answer_id": 48182497, "answer_count": 1, "score": -3, "last_activity_date": 1515572785, "creation_date": 1515569627, "last_edit_date": 1515569716, "question_id": 48182374, "link": "https://stackoverflow.com/questions/48182374/generating-fixed-length-random-number-in-go-lang", "title": "Generating fixed length random number in Go lang", "body": "<p>I need to generate an unique random number in Golang. I have a simple ruby code for it:</p>\n\n<pre><code>(0...16).map { rand(10).to_s }.join\n</code></pre>\n\n<p>So, effectively i need to generate a number of length 16 where each digit is randomly picked up from [0-9]. I did not understand how random.Intn(n) function can help me. Any idea how can I do this?</p>\n"}, {"tags": ["go", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 5060713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d30b11af0eb88c04a20eefc89738f1ec?s=128&d=identicon&r=PG&f=1", "display_name": "moneyzmey", "link": "https://stackoverflow.com/users/5060713/moneyzmey"}, "edited": false, "score": 1, "creation_date": 1515569453, "post_id": 48181794, "comment_id": 83344165, "body": "Thank you so much for your help and explanation"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1515567072, "last_edit_date": 1592644375, "creation_date": 1515567072, "answer_id": 48181794, "question_id": 48181255, "link": "https://stackoverflow.com/questions/48181255/websocket-control-message/48181794#48181794", "title": "Websocket Control Message", "body": "<p>The <a href=\"https://godoc.org/github.com/gorilla/websocket#hdr-Control_Messages\" rel=\"nofollow noreferrer\">documentation says</a>:</p>\n<blockquote>\n<p>Connections handle received close messages by calling the handler function set with the SetCloseHandler method and by returning a *CloseError from the NextReader, ReadMessage or the message Read method. The default close handler sends a close message to the peer.</p>\n<p>Connections handle received ping messages by calling the handler function set with the SetPingHandler method. The default ping handler sends a pong message to the peer.</p>\n<p>Connections handle received pong messages by calling the handler function set with the SetPongHandler method. The default pong handler does nothing. If an application sends ping messages, then the application should set a pong handler to receive the corresponding pong.</p>\n</blockquote>\n<p>Write the code above as:</p>\n<pre><code>ws.SetPingHandler(func(s string) error {\n   log.Warn(&quot;get ping!!!&quot;)\n   return nil\n})\n\nfor {\n    t, socketMsg, err := ws.ReadMessage()\n    switch {\n    case websocket.IsCloseError(websocket.CloseNormalClosure):\n        webSock.keepLive()\n    case websocket.IsUnexpectedCloseError(err):\n        webSock.keepLive()\n    case t == websocket.TextMessage:\n        SocketChannel &lt;- socketMsg\n    }\n}\n</code></pre>\n<p>Most applications break out of the receive loop on any error. A more typical approach is to write the code above as:</p>\n<pre><code>for {\n    t, socketMsg, err := ws.ReadMessage()\n    if err != nil {\n        break\n    }\n    SocketChannel &lt;- socketMsg\n}\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 5060713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d30b11af0eb88c04a20eefc89738f1ec?s=128&d=identicon&r=PG&f=1", "display_name": "moneyzmey", "link": "https://stackoverflow.com/users/5060713/moneyzmey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2451, "favorite_count": 3, "accepted_answer_id": 48181794, "answer_count": 1, "score": 2, "last_activity_date": 1515567072, "creation_date": 1515564455, "question_id": 48181255, "link": "https://stackoverflow.com/questions/48181255/websocket-control-message", "title": "Websocket Control Message", "body": "<p>I have two projects on Golang server and client.</p>\n\n<p>Problem is when I send controll message from server, i can't get it by type on client side.</p>\n\n<p>Few server code example:</p>\n\n<p>send PingMessage:</p>\n\n<pre><code>ws.SetWriteDeadline(time.Now().Add(10 * time.Second))\nws.WriteMessage(websocket.PingMessage, new_msg)\n</code></pre>\n\n<p>send CloseMessage:</p>\n\n<pre><code>ws.WriteControl(websocket.CloseMessage,\n    websocket.FormatCloseMessage(websocket.CloseNormalClosure, \"socket close\"),\n        time.Now().Add(3 * time.Second))\n</code></pre>\n\n<p>client side:</p>\n\n<pre><code>for{\n    t, socketMsg, err := ws.ReadMessage()\n\n\n    if websocket.IsUnexpectedCloseError(err) {\n        webSock.keepLive()\n    }\n\n    switch t {\n    case websocket.CloseNormalClosure:\n        webSock.keepLive()\n\n    case websocket.PingMessage:\n        log.Warn(\"get ping!!!\")\n\n    case websocket.TextMessage:\n        SocketChannel &lt;- socketMsg\n    }\n\n\n}\n</code></pre>\n\n<p>for example CloseNormalClosure message i can get only with:</p>\n\n<pre><code>    if websocket.IsCloseError(err, websocket.CloseNormalClosure){\n        log.Warn(\"CloseNormalClosure message\")\n    }\n</code></pre>\n\n<p>But PingMessage, I can't get by type:</p>\n\n<pre><code>case websocket.PingMessage:\n    log.Warn(\"get ping!!!\")\n</code></pre>\n\n<p>Could you help me, please, what Im doing wrong ?</p>\n"}, {"tags": ["go", "sqlx"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1515571124, "post_id": 48181124, "comment_id": 83344929, "body": "Why are you joining twice?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1515571237, "post_id": 48181124, "comment_id": 83344991, "body": "I&#39;m not understanding the goal here. This feels a bit like an XY problem; focusing more on a particular solution than the actual goal. Can you explain your objective more clearly?"}, {"owner": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1515615627, "post_id": 48181124, "comment_id": 83371734, "body": "Sure: the objective is to use a single SQL statement to create and populate a set of structs with parent-child relationships. The example is contrived, but suppose you store customers in one table, and representatives in another. Both of these tables represent people, and both have phone numbers, stored in a third table. If you want to get all customers for a given representative, and also phone numbers for both, you&#39;d need to join the phone numbers table twice."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1515656613, "post_id": 48181124, "comment_id": 83384908, "body": "In general, if you want to populate/update multiple tables, you need multiple statements. Or you can use a stored procedure, to make them appear as a single statement to the client. Some RDBMSs will allow indirect updates of multiple tables, with triggers or similar functionality. But that&#39;s entirely a function of your RDBMS, and doesn&#39;t relate to Go or sqlx at all."}], "owner": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 902, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1515563748, "creation_date": 1515563748, "question_id": 48181124, "link": "https://stackoverflow.com/questions/48181124/using-sqlx-to-populated-embedded-structs-from-a-table-joined-twice", "title": "Using sqlx, to populated embedded structs from a table joined twice", "body": "<p>My question in a nutshell: can I use sqlx's StructScan to populate two embedded structs with values sourced from the same SQL table joined twice?</p>\n\n<p>The <a href=\"http://jmoiron.github.io/sqlx/#advancedScanning\" rel=\"nofollow noreferrer\">help files</a> to the useful sqlx package state this:</p>\n\n<blockquote>\n  <p>A StructScan will set an id column result in Person.AutoIncr.ID, also accessible as Person.ID. To avoid confusion, it's suggested that you use AS to create column aliases in your SQL instead.</p>\n</blockquote>\n\n<p>Supposed I have this SQL query (parent-child, people to phones):</p>\n\n<pre><code>func getSQL() string {\n    return `SELECT * \n        FROM person\n        LEFT JOIN phones AS Phone1 ON Phone1.phone_id = person_phoneID1\n        LEFT JOIN phones AS Phone2 ON Phone2.phone_id = person_phoneID2\n        WHERE people_id = 1;`\n}\n</code></pre>\n\n<p>Using sqlx and StructScan, I'd like to populate a struct full of embedded structs, something like this:</p>\n\n<pre><code>//Struct with embedded structs\ntype personHelper struct{\n    Person\n    Phone1 //Should I use the same name as SQL table alias?\n    Phone2\n}\n\ntype Phone1 struct {\n    Phone //Underlying struct\n}\n\ntype Phone2 struct{\n    Phone\n}\n\n//Base structs, with tags to match up fields\ntype Person struct{\n     ID `db:\"person_id\"`\n     Name `db:\"person_name\"`\n     Phone1 `db:\"person_phoneID1\"`\n     Phone2 `db:\"person_phoneID2\"`\n}\n\ntype Phone struct{\n     ID int64 `db:\"phone_id\"`\n     Number string `db:\"phone_no\"`\n     //etc.\n}\n</code></pre>\n\n<p>I might have a function something like this:</p>\n\n<pre><code>func getPeople(){\n\n    parseRows := func(rows *sqlx.Rows) {\n        for rows.Next() {\n            var ph personHelper\n            err := rows.StructScan(&amp;ph)\n            if err != nil{\n                //etc.\n            }\n        }\n    } \n\n    sql := getSQL()\n\n    sqlutils.GetRows(parseRows, sql)//GetRows executes the SQL query and returns rows for processing     \n}\n</code></pre>\n\n<p>I can populate one phone number, but not both. I'm not sure whether I'm understanding the aliasing instructions correctly. </p>\n\n<p>I'd appreciate any insights.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["unit-testing", "go", "mocking"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 4, "creation_date": 1515552678, "post_id": 48179565, "comment_id": 83339299, "body": "You&#39;re using a struct, aws is using an interface."}, {"owner": {"reputation": 101, "user_id": 2180083, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/56d5c87eb6f87ebf38486b41d3e26e7e?s=128&d=identicon&r=PG", "display_name": "H-N", "link": "https://stackoverflow.com/users/2180083/h-n"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1515553878, "post_id": 48179565, "comment_id": 83339556, "body": "Follow-up: How can I mock ThirdPartyStruct&#39;s methods? Assume I&#39;m only allowed to touch the tests so I can&#39;t replace the current code by wrapping it inside of RealThirdPartyStruct."}], "answers": [{"tags": [], "owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "is_accepted": false, "score": 1, "last_activity_date": 1515557568, "creation_date": 1515557568, "answer_id": 48180192, "question_id": 48179565, "link": "https://stackoverflow.com/questions/48179565/how-to-mock-struct-methods-in-golang/48180192#48180192", "title": "How to mock struct methods in Golang", "body": "<p>The issue is not with mocking but with the fact that Queue structure includes ThirdPartyStruct by value (as a substructure), not as a pointer. And so does mockedReceiveMsgs. It just so happened that in Queue structure this substructure can be accessed by Client name and in mockedReceiveMsgs it is supposedly \"anonymous\" (but actually can be referred by ThirdPartyStruct name if required).</p>\n\n<p>So, <code>q := Queue{Client: mockedReceiveMsgs{}}</code> actually tries to copy over mockedReceiveMsgs into Client and it obviously fails as it has extra bits, which don't fit into ThirdPartyStruct. You can make it compile by changing it to <code>q := Queue{Client: mockedReceiveMsgs{}.ThirdPartyStruct}</code> though I doubt this is what you want.</p>\n\n<p>Note, that if you change <code>Client ThirdPartyStruct</code> to <code>Client interface{}</code> (in your original example) then it will compile as well. And this is most likely what you want. And it will also work with any interface type. Which is what @tkausl most likely was pointing out. The only tricky bit is pointer semantics vs value semantics when you're implementing your interface. It does back fire sometimes. See a quick example <a href=\"https://play.golang.org/p/ABaH95gbnOA\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 0, "last_activity_date": 1515561889, "creation_date": 1515561889, "answer_id": 48180798, "question_id": 48179565, "link": "https://stackoverflow.com/questions/48179565/how-to-mock-struct-methods-in-golang/48180798#48180798", "title": "How to mock struct methods in Golang", "body": "<p>If <code>ThirdPartyStruct</code> is, as it's name implies, a <code>struct</code> type as opposed to an <code>interface</code> type, then you cannot mock it, it is just not possible in Go. If you read your example article carefully and follow the <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/sqs/sqsiface/#SQSAPI\" rel=\"nofollow noreferrer\">link that shows the definition</a> of <code>SQSAPI</code> you'll see that it is an <code>interface</code> type.</p>\n\n<p><code>type SQSAPI</code><strong><code>interface</code></strong><code>{</code></p>\n\n<p>To make your code \"mockable\" you need to use an interface type for the <code>Client</code> field. Here's an example that is more true to the aws one: <a href=\"https://play.golang.org/p/puhhgmFCUC4\" rel=\"nofollow noreferrer\">https://play.golang.org/p/puhhgmFCUC4</a></p>\n"}], "owner": {"reputation": 101, "user_id": 2180083, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/56d5c87eb6f87ebf38486b41d3e26e7e?s=128&d=identicon&r=PG", "display_name": "H-N", "link": "https://stackoverflow.com/users/2180083/h-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2076, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1515561889, "creation_date": 1515552369, "question_id": 48179565, "link": "https://stackoverflow.com/questions/48179565/how-to-mock-struct-methods-in-golang", "title": "How to mock struct methods in Golang", "body": "<p>I'm reading this page (I'm not using Amazon, just reading for golang education)</p>\n\n<p><a href=\"https://aws.amazon.com/blogs/developer/mocking-out-then-aws-sdk-for-go-for-unit-testing/\" rel=\"nofollow noreferrer\">https://aws.amazon.com/blogs/developer/mocking-out-then-aws-sdk-for-go-for-unit-testing/</a></p>\n\n<p>When I try it for myself, I get type errors.</p>\n\n<pre><code>type Queue struct {\n    Client ThirdPartyStruct\n    URL    string\n}\n\ntype mockedReceiveMsgs struct {\n    ThirdPartyStruct\n    Resp ValueIWantToMock\n}\n\nq := Queue{Client: mockedReceiveMsgs{}}\n</code></pre>\n\n<p>When I try to do the exact same thing, I get</p>\n\n<pre><code>cannot use mocked literal (type mockedReceiveMsgs) as type ThirdPartyStruct in field value\n</code></pre>\n\n<p>I feel like I'm copying the Amazon tutorial exactly. How come in there code, mockedReceiveMsgs can be used in place of ThirdPartyStruct?</p>\n"}, {"tags": ["string", "algorithm", "go", "prefix"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1515561092, "post_id": 48179240, "comment_id": 83341251, "body": "It would help if you can specify your space/time requirement and data scale. At a scale of len(L)~1e3, there is no need to write any extra code."}, {"owner": {"reputation": 394, "user_id": 7433927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cedd4cabe5e21c0ba67c5bcf9954632?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Petrovic", "link": "https://stackoverflow.com/users/7433927/petar-petrovic"}, "edited": false, "score": 0, "creation_date": 1515567887, "post_id": 48179240, "comment_id": 83343481, "body": "do you mean &quot;common prefix of length at most N&quot; in the first sentence?"}, {"owner": {"reputation": 604, "user_id": 2265106, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IKHQK.png?s=128&g=1", "display_name": "xrfang", "link": "https://stackoverflow.com/users/2265106/xrfang"}, "reply_to_user": {"reputation": 394, "user_id": 7433927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cedd4cabe5e21c0ba67c5bcf9954632?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Petrovic", "link": "https://stackoverflow.com/users/7433927/petar-petrovic"}, "edited": false, "score": 0, "creation_date": 1515569271, "post_id": 48179240, "comment_id": 83344079, "body": "@Petar Petrovic, the &quot;at most N&quot; means at most N <b>groups</b>, not the prefix length."}, {"owner": {"reputation": 604, "user_id": 2265106, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IKHQK.png?s=128&g=1", "display_name": "xrfang", "link": "https://stackoverflow.com/users/2265106/xrfang"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1515569283, "post_id": 48179240, "comment_id": 83344085, "body": "@leaf bebop I will try brute force method first, and do some research on the answers provided here."}, {"owner": {"reputation": 394, "user_id": 7433927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cedd4cabe5e21c0ba67c5bcf9954632?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Petrovic", "link": "https://stackoverflow.com/users/7433927/petar-petrovic"}, "edited": false, "score": 0, "creation_date": 1515570359, "post_id": 48179240, "comment_id": 83344574, "body": "@xrfang so &quot;groups by common prefix of length N&quot;  means each prefix must have length N? Then why do you have this requirement &quot;the number of groups is as close as but not exceeding N&quot; ? if the length of prefix is fixed, shouldn&#39;t number of groups is also fixed?"}, {"owner": {"reputation": 604, "user_id": 2265106, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IKHQK.png?s=128&g=1", "display_name": "xrfang", "link": "https://stackoverflow.com/users/2265106/xrfang"}, "reply_to_user": {"reputation": 394, "user_id": 7433927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cedd4cabe5e21c0ba67c5bcf9954632?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Petrovic", "link": "https://stackoverflow.com/users/7433927/petar-petrovic"}, "edited": false, "score": 0, "creation_date": 1515574438, "post_id": 48179240, "comment_id": 83346718, "body": "@Petar Petrovic <b>no</b>.  N has nothing to do with prefix length, it is the maximum group to partition the list of strings.  Also note that the prefix is a fixed thing, initially &quot;&quot; (empty string). It is used to &quot;drill down&quot; the list, when it is set, all strings not prefixed by it is ignored. Let&#39;s forget about the prefix parameter, just say it is the empty string."}, {"owner": {"reputation": 394, "user_id": 7433927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cedd4cabe5e21c0ba67c5bcf9954632?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Petrovic", "link": "https://stackoverflow.com/users/7433927/petar-petrovic"}, "edited": false, "score": 0, "creation_date": 1515577383, "post_id": 48179240, "comment_id": 83348524, "body": "@xrfang thanks but I am not sure I get it. So the goal is dividing the set of strings into at most N groups, and every string in group g must have prefix g_p. And more groups is better. is that correct?"}, {"owner": {"reputation": 604, "user_id": 2265106, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IKHQK.png?s=128&g=1", "display_name": "xrfang", "link": "https://stackoverflow.com/users/2265106/xrfang"}, "reply_to_user": {"reputation": 394, "user_id": 7433927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cedd4cabe5e21c0ba67c5bcf9954632?s=128&d=identicon&r=PG&f=1", "display_name": "Petar Petrovic", "link": "https://stackoverflow.com/users/7433927/petar-petrovic"}, "edited": false, "score": 0, "creation_date": 1515636507, "post_id": 48179240, "comment_id": 83378900, "body": "@Petar Petrovic I am sorry that the &quot;prefix&quot; really confused you. Please forget about it. There is NO external given prefix to check, just say, you want to browse a dictionary, in lexical order.   you don&#39;t want to list all words on a page, because that will be too much. You list the letter A-Z, i.e. 26 groups, which the number of words in each group: A(123), B(456)... Z(98). Then if you click on A, you get a list of words starting with A, AA(12), AB(34), ..... that&#39;s it."}], "answers": [{"tags": [], "owner": {"reputation": 3405, "user_id": 7034183, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YcIEw.jpg?s=128&g=1", "display_name": "Remario", "link": "https://stackoverflow.com/users/7034183/remario"}, "is_accepted": false, "score": 1, "last_activity_date": 1515549998, "creation_date": 1515549998, "answer_id": 48179286, "question_id": 48179240, "link": "https://stackoverflow.com/questions/48179240/algorithm-to-partition-strings-by-prefix/48179286#48179286", "title": "algorithm to partition strings by prefix", "body": "<p>Well there are a few algorithms, but prefix tree is to way to go.</p>\n\n<blockquote>\n  <p>A prefix tree, or trie (often pronounced \"try\"), is a tree whose nodes don't hold keys, but rather, hold partial keys.  For example, if you have a prefix tree that stores strings, then each node would be a character of a string.  If you have a prefix tree that stores arrays, each node would be an element of that array.  The elements are ordered from the root.  So if you had a prefix tree with the word \"hello\" in it, then the root node would have a child \"h,\" and the \"h\" node would have a child, \"e,\" and the \"e\" node would have a child node \"l,\" etc.  The deepest node of a key would have some sort of boolean flag on it indicating that it is the terminal node of some key.  (This is important because the last node of a key isn't always a leaf node... consider a prefix tree with \"dog\" and \"doggy\" in it).  Prefix trees are good for looking up keys with a particular prefix.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 8533, "user_id": 11792, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/057dba7b6fe7b933e5ee23f7dc64dcb5?s=128&d=identicon&r=PG", "display_name": "Pavel Nikolov", "link": "https://stackoverflow.com/users/11792/pavel-nikolov"}, "is_accepted": true, "score": 1, "last_activity_date": 1515561063, "creation_date": 1515561063, "answer_id": 48180668, "question_id": 48179240, "link": "https://stackoverflow.com/questions/48179240/algorithm-to-partition-strings-by-prefix/48180668#48180668", "title": "algorithm to partition strings by prefix", "body": "<p>You need to use a <a href=\"https://en.wikipedia.org/wiki/Radix_tree\" rel=\"nofollow noreferrer\">Radix trie</a>.\nYou can read about <a href=\"https://stackoverflow.com/a/14708989/11792\">the difference between a trie and a Radix trie</a>.</p>\n"}], "owner": {"reputation": 604, "user_id": 2265106, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IKHQK.png?s=128&g=1", "display_name": "xrfang", "link": "https://stackoverflow.com/users/2265106/xrfang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 48180668, "answer_count": 2, "score": 3, "last_activity_date": 1515561063, "creation_date": 1515549417, "question_id": 48179240, "link": "https://stackoverflow.com/questions/48179240/algorithm-to-partition-strings-by-prefix", "title": "algorithm to partition strings by prefix", "body": "<p>Given a list of strings L (sorted), and a positive integer N (N &lt;= len(L)), how to efficiently partition L into no more than N groups by common prefix of length N?</p>\n\n<p>Example: define data structure and function as below:</p>\n\n<pre><code>type PrefixGroup struct {\n    Prefix string \n    Count  int\n}\nfunc partition(L []string, N int, prefix string) []PrefixGroup\n</code></pre>\n\n<p>The list L may contains thousands of strings, when called with</p>\n\n<pre><code>partition(L, 8, \"\")\n</code></pre>\n\n<p>the output may be:</p>\n\n<pre><code>[\n    {\"Prefix\":\"13\", \"Count\":1000},\n    {\"Prefix\":\"180\": \"Count\": 10},\n    {\"Prefix\":\"X\": \"Count\": 2},\n    ... ...\n]\n</code></pre>\n\n<p>which means in L, there are 1000 strings start with \"13\", 10 start with \"180\" and 2 start with \"X\".  Note that the length of prefix is <em>not</em> fixed. The key requirement of this algorithm is to partition strings with common prefix so that the number of groups is as close as but not exceeding N.</p>\n\n<p>With the result above, I can then call <code>partition(L, 8, \"13\")</code> to further drill down subset of L that start with \"13\":</p>\n\n<pre><code>[\n    {\"Prefix\":\"131\", \"Count\": 50},\n    {\"Prefix\":\"135\": \"Count\": 100},\n    {\"Prefix\":\"136\": \"Count\": 500},\n    ... ...\n]\n</code></pre>\n\n<p>This is <strong>not</strong> a homework question.  I need to write such an algorithm for a project at hand.  I can write it \"brute-force\"-ly, just wonder if there are any classic/well-known data structure and/or algorithm to achieve proven time/space efficiency.</p>\n\n<p>I have considered <code>trie</code>, but wonder if it may consume too much memory...</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1515539607, "post_id": 48178008, "comment_id": 83336186, "body": "The raw value of 0x01 isn&#39;t an ascii character. Please provide a complete example of the problem you&#39;re trying to solve."}, {"owner": {"reputation": 21, "user_id": 9195738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16eb468440bd6fdfc972e484018cdc45?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Upoli", "link": "https://stackoverflow.com/users/9195738/louis-upoli"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1515540713, "post_id": 48178008, "comment_id": 83336508, "body": "I get the same error if i put []byte{1}"}, {"owner": {"reputation": 21, "user_id": 9195738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16eb468440bd6fdfc972e484018cdc45?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Upoli", "link": "https://stackoverflow.com/users/9195738/louis-upoli"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1515540811, "post_id": 48178008, "comment_id": 83336539, "body": "as you can see there : <a href=\"https://play.golang.org/p/oByoIdY5D3G\" rel=\"nofollow noreferrer\">play.golang.org/p/oByoIdY5D3G</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515540813, "post_id": 48178008, "comment_id": 83336540, "body": "because <code>0x01</code> and <code>1</code> are just different ways of writing the same value 1."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515540889, "post_id": 48178008, "comment_id": 83336557, "body": "It makes no sense to take a single byte with the value of 1 and try to parse it as a decimal number in a string. Are you trying to parse a binary encoding of some sort?"}, {"owner": {"reputation": 21, "user_id": 9195738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16eb468440bd6fdfc972e484018cdc45?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Upoli", "link": "https://stackoverflow.com/users/9195738/louis-upoli"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515541090, "post_id": 48178008, "comment_id": 83336627, "body": "i&#39;m not trying to parse a binary encoding, i&#39;m just trying to put each value of an int array in a byte array and then to reconvert my byte array in an int array"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515541152, "post_id": 48178008, "comment_id": 83336643, "body": "Then just convert the bytes to ints, there&#39;s no need for parsing strings.\\"}, {"owner": {"reputation": 21, "user_id": 9195738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16eb468440bd6fdfc972e484018cdc45?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Upoli", "link": "https://stackoverflow.com/users/9195738/louis-upoli"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515541339, "post_id": 48178008, "comment_id": 83336700, "body": "And how should i do ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515541413, "post_id": 48178008, "comment_id": 83336717, "body": "The <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">Conversions spec</a>  -- <a href=\"https://golang.org/doc/effective_go.html#conversions\" rel=\"nofollow noreferrer\">Conversions in &quot;Effective Go&quot;</a> -- Is this what you want to do? <a href=\"https://play.golang.org/p/SyLZHggdK-N\" rel=\"nofollow noreferrer\">play.golang.org/p/SyLZHggdK-N</a>"}, {"owner": {"reputation": 21, "user_id": 9195738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16eb468440bd6fdfc972e484018cdc45?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Upoli", "link": "https://stackoverflow.com/users/9195738/louis-upoli"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515541505, "post_id": 48178008, "comment_id": 83336734, "body": "exactly what i wanted thank you a lot !"}, {"owner": {"reputation": 21, "user_id": 9195738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16eb468440bd6fdfc972e484018cdc45?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Upoli", "link": "https://stackoverflow.com/users/9195738/louis-upoli"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515541743, "post_id": 48178008, "comment_id": 83336814, "body": "@JimB i edited the post, you can put your answer for anyone looking to do the same thing."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1515542009, "creation_date": 1515542009, "answer_id": 48178379, "question_id": 48178008, "link": "https://stackoverflow.com/questions/48178008/convert-byte-slice-to-int-slice/48178379#48178379", "title": "Convert byte slice to int slice", "body": "<p>The slice already contains a byte value of <code>1</code>, not the ascii character <code>1</code>, so there is no need to try and convert it to a string.</p>\n\n<p>To convert a slice of <code>byte</code> to a slice of <code>int</code>, convert each value individually</p>\n\n<pre><code>byteSlice := []byte{1, 2, 3, 4}\nintSlice := make([]int, len(byteSlice))\nfor i, b := range byteSlice {\n    intSlice[i] = int(b)\n}\n</code></pre>\n\n<p>For reference, see the sections on Conversions in the <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">Go Language Specification</a>, and in <a href=\"https://golang.org/doc/effective_go.html#conversions\" rel=\"nofollow noreferrer\">Effective Go</a>.</p>\n"}], "owner": {"reputation": 21, "user_id": 9195738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16eb468440bd6fdfc972e484018cdc45?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Upoli", "link": "https://stackoverflow.com/users/9195738/louis-upoli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1929, "favorite_count": 0, "accepted_answer_id": 48178379, "answer_count": 1, "score": -2, "last_activity_date": 1610630651, "creation_date": 1515539492, "last_edit_date": 1610630651, "question_id": 48178008, "link": "https://stackoverflow.com/questions/48178008/convert-byte-slice-to-int-slice", "title": "Convert byte slice to int slice", "body": "<p>I'm currently trying to convert a <code>byte</code> to an <code>int</code> so I proceed like this:</p>\n<pre><code>var d = []byte{0x01}\nval, err := strconv.Atoi(string(d))\n</code></pre>\n<p>and I get this error:</p>\n<blockquote>\n<p>strconv.Atoi: parsing &quot;\\x01&quot;: invalid syntax</p>\n</blockquote>\n<p>I've tried a lot of way without success yet..</p>\n<p>Anyone got an idea?</p>\n"}, {"tags": ["go", "channel"], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "closed_date": 1515539049, "answer_count": 0, "score": 1, "last_activity_date": 1516621208, "creation_date": 1515538544, "last_edit_date": 1516621208, "question_id": 48177859, "link": "https://stackoverflow.com/questions/48177859/receive-on-multiple-channels", "closed_reason": "Duplicate", "title": "Receive on multiple channels", "body": "<p>In golang for receiving on multiple channels I should use following construction:</p>\n\n<pre><code>for {\n    select {\n    case chan1:\n    case chan2:\n    }\n}\n</code></pre>\n\n<p>Whant if I don't know the exact number of channel I will receive on? </p>\n\n<p>Is it possible somehow to listen from some object which contains arbitrary (runtime defined) number of <code>channel</code>s?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 807, "user_id": 2120293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/502PJ.png?s=128&g=1", "display_name": "Tulir", "link": "https://stackoverflow.com/users/2120293/tulir"}, "is_accepted": true, "score": 6, "last_activity_date": 1515533866, "creation_date": 1515533866, "answer_id": 48177021, "question_id": 48176971, "link": "https://stackoverflow.com/questions/48176971/log-fatal-with-go-command/48177021#48177021", "title": "log.Fatal with go command", "body": "<p>You can wrap it in an anonymous function:</p>\n\n<pre><code>go func() {\n    log.Fatal(http.ListenAndServe(\":7777\", router))\n}()\n</code></pre>\n"}], "owner": {"reputation": 17167, "user_id": 773263, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/e2581b53db32340d7e1b5be6b99c2bb1?s=128&d=identicon&r=PG", "display_name": "Philip Kirkbride", "link": "https://stackoverflow.com/users/773263/philip-kirkbride"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 0, "accepted_answer_id": 48177021, "answer_count": 1, "score": 0, "last_activity_date": 1515533866, "creation_date": 1515533611, "question_id": 48176971, "link": "https://stackoverflow.com/questions/48176971/log-fatal-with-go-command", "title": "log.Fatal with go command", "body": "<p>I'm running a script which opens an http port. I initially had it logging errors:</p>\n\n<pre><code>log.Fatal(http.ListenAndServe(\":7777\", router))\n</code></pre>\n\n<p>I have additional code so I want to run it on another thread:</p>\n\n<pre><code>go http.ListenAndServe(\":7777\", router)\n</code></pre>\n\n<p>I still want to log any information related to the http port failing, but neither work:</p>\n\n<pre><code>go log.Fatal(http.ListenAndServe(\":7777\", router))\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>log.Fatal(go http.ListenAndServe(\":7777\", router))\n</code></pre>\n\n<p>What is the correct syntax for this?</p>\n"}, {"tags": ["go", "ps", "psutil", "htop"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1515527244, "post_id": 48175264, "comment_id": 83330948, "body": "Please profile it so we can determine which part is the bottle-neck."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 2, "creation_date": 1515568191, "post_id": 48175264, "comment_id": 83343613, "body": "Just a thought: <code>top</code> is a venerable ancient (read: optimized over and over again, even with a complete rewrite, iirc) and written in C (no GC and alike). As always with programming languages: Go is awesome for <i>some</i> things, not for <i>everything</i>."}, {"owner": {"reputation": 3947, "user_id": 7443104, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/599eeedbaf5a966b46ef5b5784741b8c?s=128&d=identicon&r=PG", "display_name": "Patwie", "link": "https://stackoverflow.com/users/7443104/patwie"}, "edited": false, "score": 0, "creation_date": 1515757261, "post_id": 48175264, "comment_id": 83432614, "body": "I added the result from profiling. Is my conclusion correct? Further, I did not found the implementation of <code>top</code>."}, {"owner": {"reputation": 3947, "user_id": 7443104, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/599eeedbaf5a966b46ef5b5784741b8c?s=128&d=identicon&r=PG", "display_name": "Patwie", "link": "https://stackoverflow.com/users/7443104/patwie"}, "edited": false, "score": 0, "creation_date": 1515793684, "post_id": 48175264, "comment_id": 83451459, "body": "It seems, that golang is indeed very inefficient or at least the library <code>github.com&#47;shirou&#47;gopsutil&#47;process</code> <i>for my use case</i>. I ended up by implementing it directly in c and just calling it by cgo, see <a href=\"https://github.com/PatWie/cpuinfo\" rel=\"nofollow noreferrer\">github.com/PatWie/cpuinfo</a>"}], "owner": {"reputation": 3947, "user_id": 7443104, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/599eeedbaf5a966b46ef5b5784741b8c?s=128&d=identicon&r=PG", "display_name": "Patwie", "link": "https://stackoverflow.com/users/7443104/patwie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3419, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1515757228, "creation_date": 1515525635, "last_edit_date": 1515757228, "question_id": 48175264, "link": "https://stackoverflow.com/questions/48175264/golang-cpu-usage", "title": "golang CPU usage", "body": "<p>I am aware of <a href=\"https://stackoverflow.com/questions/11356330/getting-cpu-usage-with-golang\">[1]</a>. With a few lines of code, I just want to extract the current CPU usage from the top n processes with the most CPU usages. More or less the top 5 rows of <a href=\"http://manpages.ubuntu.com/manpages/xenial/man1/top.1.html\" rel=\"nofollow noreferrer\">top</a>. Using <em>github.com/shirou/gopsutil/process</em> this is straight-forward:</p>\n\n<pre><code>// file: gotop.go\npackage main\n\nimport (\n  \"log\"\n  \"time\"\n  \"sort\"\n\n  \"github.com/shirou/gopsutil/process\"\n)\n\n\ntype ProcInfo struct{\n  Name  string\n  Usage float64\n} \n\ntype ByUsage []ProcInfo\n\nfunc (a ByUsage) Len() int      { return len(a) }\nfunc (a ByUsage) Swap(i, j int) { a[i], a[j] = a[j], a[i] }\nfunc (a ByUsage) Less(i, j int) bool {\n  return a[i].Usage &gt; a[j].Usage\n}\n\n\nfunc main() {\n\n  for {\n    processes, _ := process.Processes()\n\n    var procinfos []ProcInfo\n    for _, p := range processes{\n      a, _ := p.CPUPercent()\n      n, _ := p.Name()\n      procinfos = append(procinfos, ProcInfo{n, a})\n    }\n    sort.Sort(ByUsage(procinfos))\n\n    for _, p := range procinfos[:5]{\n      log.Printf(\"   %s -&gt; %f\", p.Name, p.Usage)\n    }\n    time.Sleep(3 * time.Second)\n  }\n}\n</code></pre>\n\n<p>While the refresh rate in this implementation <em>gotop</em> is 3 seconds like <em>top</em> does, <em>gotop</em> has approx. 5-times higher demand on CPU usage to get these values like <em>top</em> does. Is there any trick to more efficiently read the 5 topmost consuming processes? I also tried to find the implementation of <em>top</em> to see how this is implemented there.</p>\n\n<p>Is <em>psutils</em> responsible for this slown-down? I found as <a href=\"https://github.com/uber-common/cpustat\" rel=\"nofollow noreferrer\">cpustat</a> implemented in GO as well. But even <code>sudo ./cpustat -i 3000 -s 1</code> seems to be not as efficient as <code>top</code>.</p>\n\n<p>The main motivation is to monitor the usage of the current machine with a fairly small amount of computational effort so that it can run as a service in the background.</p>\n\n<p>It seems, even <em>htop</em> is <a href=\"https://github.com/hishamhm/htop/blob/master/linux/LinuxProcessList.c#L96\" rel=\"nofollow noreferrer\">only reading</a> <em>/proc/stat</em>.</p>\n\n<p><strong>edit</strong>\nas proposed in the comments here is the result when profiling</p>\n\n<pre><code>Showing top 10 nodes out of 46 (cum &gt;= 70ms)\n      flat  flat%   sum%        cum   cum%\n      40ms 40.00% 40.00%       40ms 40.00%  syscall.Syscall\n      10ms 10.00% 50.00%       30ms 30.00%  github.com/shirou/gopsutil/process.(*Process).fillFromStatusWithContext\n      10ms 10.00% 60.00%       30ms 30.00%  io/ioutil.ReadFile\n      10ms 10.00% 70.00%       10ms 10.00%  runtime.slicebytetostring\n      10ms 10.00% 80.00%       20ms 20.00%  strings.FieldsFunc\n      10ms 10.00% 90.00%       10ms 10.00%  syscall.Syscall6\n      10ms 10.00%   100%       10ms 10.00%  unicode.IsSpace\n         0     0%   100%       10ms 10.00%  bytes.(*Buffer).ReadFrom\n         0     0%   100%       70ms 70.00%  github.com/shirou/gopsutil/process.(*Process).CPUPercent\n         0     0%   100%       70ms 70.00%  github.com/shirou/gopsutil/process.(*Process).CPUPercentWithContext\n</code></pre>\n\n<p>Seems like the syscall takes forever. A tree dump is here:\n<a href=\"https://gist.github.com/PatWie/4fa528b7d7b1d0b5c1b665c056671477\" rel=\"nofollow noreferrer\">https://gist.github.com/PatWie/4fa528b7d7b1d0b5c1b665c056671477</a></p>\n\n<p>This changes the question into:\n- Is the syscall the issue?\n- Are there any c-sources for the <code>top</code> program? I just found the implementation of htop\n- Is there an easy fix? I consider to write it in c and just wrap it for go.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1515523771, "post_id": 48174814, "comment_id": 83329309, "body": "You seem to have just supplied your own answers phrased as questions. What problem are you facing?"}, {"owner": {"reputation": 3699, "user_id": 4816175, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/697df6176ef55a7ea25f159e0fcdec38?s=128&d=identicon&r=PG", "display_name": "cool breeze", "link": "https://stackoverflow.com/users/4816175/cool-breeze"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515528293, "post_id": 48174814, "comment_id": 83331415, "body": "@JimB I know how scala actors work, and actors seem to be a unbounded queue and was curious how to get the same behavior with go channels."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515529504, "post_id": 48174814, "comment_id": 83332014, "body": "no, you cannot have an unbounded channel, but you already answered that, then put a question mark at the end. <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>"}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 2, "last_activity_date": 1515523758, "creation_date": 1515523758, "answer_id": 48174839, "question_id": 48174814, "link": "https://stackoverflow.com/questions/48174814/understand-how-a-buffered-channel-works/48174839#48174839", "title": "Understand how a buffered channel works", "body": "<ol>\n<li>Yes.</li>\n<li>Yes.</li>\n<li>No, you can't have an infinite-buffered channel.</li>\n</ol>\n\n<p>This is covered in detail <a href=\"https://tour.golang.org/concurrency/2\" rel=\"nofollow noreferrer\">in the Go tour</a>.</p>\n\n<p>Basically, whenever a routine sends on a channel, that routine blocks until <em>something</em> is available to receive it. That may be the channel buffer, or it may be something trying to receive from the channel. Likewise, whenever a routine receives on a channel, that routine blocks until there is something for it to receive.</p>\n"}], "owner": {"reputation": 3699, "user_id": 4816175, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/697df6176ef55a7ea25f159e0fcdec38?s=128&d=identicon&r=PG", "display_name": "cool breeze", "link": "https://stackoverflow.com/users/4816175/cool-breeze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1515523758, "creation_date": 1515523679, "question_id": 48174814, "link": "https://stackoverflow.com/questions/48174814/understand-how-a-buffered-channel-works", "title": "Understand how a buffered channel works", "body": "<p>Can someone explain to me how channels work in these scenerios:</p>\n\n<ol>\n<li><p>If a channel isn't buffered, if you send to a channel 2 messages when no message has been received yet, does it just block the app?</p></li>\n<li><p>If there is a buffer, it behaves like #1 once the bufferred amount is reached?  So if the buffer is 2, after 2 messages it will just block until you recieve at least 1 message?</p></li>\n</ol>\n\n<p>Since you have to set the bufferred amount, you can't just have a channel that stores an arbitrary amount of messages?</p>\n"}, {"tags": ["go", "arangodb"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515520356, "post_id": 48174019, "comment_id": 83327572, "body": "If your question is about the scalability of multi-tenancy in ArangoDB, that has nothing to do with Go or PHP."}, {"owner": {"reputation": 157, "user_id": 1655977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b665356b6a372aa2a78dba7a69065858?s=128&d=identicon&r=PG", "display_name": "Ivan Naumenko", "link": "https://stackoverflow.com/users/1655977/ivan-naumenko"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515521011, "post_id": 48174019, "comment_id": 83327934, "body": "@Adrian, I&#39;m asking to validate my idea of multi-tenant DB connection management. Also, it would be great to see some recommendations on how to do that, or how not to..."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515521237, "post_id": 48174019, "comment_id": 83328038, "body": "Which still has nothing to do with Go or PHP. As written, the question is so vague it&#39;s unanswerable. Yeah, you&#39;ll want to use some kind of connection pool; no, you can&#39;t open infinite connections. Hard to give any recommendation or say if you&#39;re &quot;thinking in the right direction&quot; since no real detail is given on what you&#39;re actually trying to accomplish or what direction you&#39;re thinking other than some kind of finite connection pool."}, {"owner": {"reputation": 157, "user_id": 1655977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b665356b6a372aa2a78dba7a69065858?s=128&d=identicon&r=PG", "display_name": "Ivan Naumenko", "link": "https://stackoverflow.com/users/1655977/ivan-naumenko"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515521391, "post_id": 48174019, "comment_id": 83328101, "body": "All right, I hear you @Adrian, let me try refine my explanation, and I&#39;ll update my original question once it makes sense to you."}, {"owner": {"reputation": 157, "user_id": 1655977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b665356b6a372aa2a78dba7a69065858?s=128&d=identicon&r=PG", "display_name": "Ivan Naumenko", "link": "https://stackoverflow.com/users/1655977/ivan-naumenko"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515523058, "post_id": 48174019, "comment_id": 83328950, "body": "@Adrian, does it make more sense now?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515523681, "post_id": 48174019, "comment_id": 83329262, "body": "If you&#39;re using HTTP as a transport, you don&#39;t need to worry about any of it. HTTP connections are generally not long-lived, and Go handles keepalive and pooling internally. Each request to the database is a distinct unit that may or may not re-use an open HTTP connection."}, {"owner": {"reputation": 157, "user_id": 1655977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b665356b6a372aa2a78dba7a69065858?s=128&d=identicon&r=PG", "display_name": "Ivan Naumenko", "link": "https://stackoverflow.com/users/1655977/ivan-naumenko"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515525109, "post_id": 48174019, "comment_id": 83329932, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/162840/discussion-between-ivan-naumenko-and-adrian\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2302, "user_id": 153083, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/47346856678398efad65eedaedf57206?s=128&d=identicon&r=PG", "display_name": "Andrew Grothe", "link": "https://stackoverflow.com/users/153083/andrew-grothe"}, "reply_to_user": {"reputation": 157, "user_id": 1655977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b665356b6a372aa2a78dba7a69065858?s=128&d=identicon&r=PG", "display_name": "Ivan Naumenko", "link": "https://stackoverflow.com/users/1655977/ivan-naumenko"}, "edited": false, "score": 0, "creation_date": 1515704082, "post_id": 48191153, "comment_id": 83413139, "body": "@ivannaumenko the Queue has at most one object per database. The database connection pool is managed via driver <a href=\"https://github.com/arangodb/arangodb-java-driver/blob/master/README.md#connection-pooling\" rel=\"nofollow noreferrer\">github.com/arangodb/arangodb-java-driver/blob/master/&hellip;</a>"}, {"owner": {"reputation": 157, "user_id": 1655977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b665356b6a372aa2a78dba7a69065858?s=128&d=identicon&r=PG", "display_name": "Ivan Naumenko", "link": "https://stackoverflow.com/users/1655977/ivan-naumenko"}, "edited": false, "score": 0, "creation_date": 1515717464, "post_id": 48191153, "comment_id": 83417873, "body": "I understand that, you said &quot;Create a Concurrent Queue to hold the Java Driver instances&quot;, right? where the Queue has at most one object per database like you also said. If you have hundreds of DB, are you going to keep all of them in the Queue, and it has no limit on the size?  if not, and Queue does have a size, you need to manage it. That&#39;s what I asked."}, {"owner": {"reputation": 2302, "user_id": 153083, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/47346856678398efad65eedaedf57206?s=128&d=identicon&r=PG", "display_name": "Andrew Grothe", "link": "https://stackoverflow.com/users/153083/andrew-grothe"}, "reply_to_user": {"reputation": 157, "user_id": 1655977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b665356b6a372aa2a78dba7a69065858?s=128&d=identicon&r=PG", "display_name": "Ivan Naumenko", "link": "https://stackoverflow.com/users/1655977/ivan-naumenko"}, "edited": false, "score": 0, "creation_date": 1515769079, "post_id": 48191153, "comment_id": 83439381, "body": "@IvanNaumenko hopefully my edit answers the question better. Ideally, the Queue has no size limit, but that depends on server resources of course."}, {"owner": {"reputation": 157, "user_id": 1655977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b665356b6a372aa2a78dba7a69065858?s=128&d=identicon&r=PG", "display_name": "Ivan Naumenko", "link": "https://stackoverflow.com/users/1655977/ivan-naumenko"}, "edited": false, "score": 0, "creation_date": 1515801674, "post_id": 48191153, "comment_id": 83453865, "body": "it totally makes sense, and this is exactly the way I did my implementation."}], "tags": [], "owner": {"reputation": 2302, "user_id": 153083, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/47346856678398efad65eedaedf57206?s=128&d=identicon&r=PG", "display_name": "Andrew Grothe", "link": "https://stackoverflow.com/users/153083/andrew-grothe"}, "is_accepted": false, "score": 2, "last_activity_date": 1515768966, "last_edit_date": 1515768966, "creation_date": 1515599163, "answer_id": 48191153, "question_id": 48174019, "link": "https://stackoverflow.com/questions/48174019/manage-multi-tenancy-arangodb-connection/48191153#48191153", "title": "Manage multi-tenancy ArangoDB connection", "body": "<p>I implemented this in a Java proof of concept SaaS application a few months ago.</p>\n\n<p>My approach can be described in a high level as:</p>\n\n<ol>\n<li>Create a Concurrent Queue to hold the Java Driver instances (Java driver has connection pooling build in)</li>\n<li>Use subdomain to determine which SaaS client is being used (can use URL param but I don't like that approach)</li>\n<li>Reference the correct Connection from Queue based on SaaS client or create a new one if not in the Queue.</li>\n<li>Continue with request.</li>\n</ol>\n\n<p>This was fairly trivial by naming each DB to match the subdomain, but a lookup from the _systemdb could also be used.</p>\n\n<p>*Edit\nThe Concurrent Queue holds at most one Driver object per database and hence the size at most will match the number of databases. In my testing I did not manage the size of this Queue at all.</p>\n\n<p>A good server should be able to hold hundreds of these or even thousands depending on memory, and a load balancing strategy can be used to split clients into different server clusters if scaling large enough. A worker thread could also be used to remove objects based on age but that might interfere with throughput. </p>\n"}], "owner": {"reputation": 157, "user_id": 1655977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b665356b6a372aa2a78dba7a69065858?s=128&d=identicon&r=PG", "display_name": "Ivan Naumenko", "link": "https://stackoverflow.com/users/1655977/ivan-naumenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 712, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1515768966, "creation_date": 1515520276, "last_edit_date": 1515522989, "question_id": 48174019, "link": "https://stackoverflow.com/questions/48174019/manage-multi-tenancy-arangodb-connection", "title": "Manage multi-tenancy ArangoDB connection", "body": "<p>I use ArangoDB/Go (using go-driver) and need to implement multi-tenancy, means every customer is going to have his data in a separate DB.</p>\n\n<p>What I'm trying to figure out is how to make this multi-tenancy work. I understand that it's not sustainable to create a new DB connection for each request, means I have to maintain a pool of connections (not a typical connection pool tho). Of course, I can't just assume that I can make limitless, there has to be a limit. However, the more I think about that the more I understand that I need some advice on it. I'm new to Go, coming from the PHP world, and obviously it's a completely different paradigm in PHP.</p>\n\n<p>Some details\nI have an API (written in Go) which talks to ArangoDb using arangodb/go-driver. A standard way of creating a DB connection is</p>\n\n<ul>\n<li><p>create a connection\nconn, err := graphHTTP.NewConnection(...)</p></li>\n<li><p>create client\nc, err := graphDriver.NewClient(...)</p></li>\n<li><p>create DB connection\ngraphDB, err := p.cl.Database(...)</p></li>\n</ul>\n\n<p>This works if one has only one DB, and DB connection is created on API's boot up.\nIn my case it's many, and, as previously suggested, I need to maintain a DB connections pool.</p>\n\n<p>Where it gets fuzzy for me is how to maintain this pool, keep in mind that pool has to have a limit.\nSay, my pool is of size 5, abd over time it's been filled up with the connections. A new request comes in, and it needs a connection to a DB which is not in the pool.\nThe way I see it, I have only 2 options:</p>\n\n<ol>\n<li>Kill one of the pooled connections, if it's not used</li>\n<li>Wait till #1 can be done, or throw an error if waiting time is too long.</li>\n</ol>\n\n<p>The biggest unknow, and this is mainly because I've never done anything like this, for me is how to track whether connection is being used or not.\nWhat makes thing even more complex is that DB connection has it's own pool, it's done on the transport level.</p>\n\n<p>Any recommendations on how to approach this task?</p>\n"}, {"tags": ["go", "hash", "sha256"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 3, "creation_date": 1515518867, "post_id": 48173628, "comment_id": 83326819, "body": "I don\u2019t really know Go, but is <code>%v</code> going to format the <code>*big.Int</code>s as pointers? You should look at the result of <code>fmt.Sprintf</code>, not the hash."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1515519335, "post_id": 48173628, "comment_id": 83327055, "body": "<code>*big.Int</code> is a Stringer, but the Curve is not and will print the internal pointers."}], "answers": [{"comments": [{"owner": {"reputation": 2264, "user_id": 1964489, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dced6d8951b4771cde68c08e372bbede?s=128&d=identicon&r=PG", "display_name": "Ziva", "link": "https://stackoverflow.com/users/1964489/ziva"}, "edited": false, "score": 0, "creation_date": 1515519688, "post_id": 48173708, "comment_id": 83327246, "body": "That&#39;s exactly what was the issue and the knowledge I was missing! Thanks a lot, great help!"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 7, "last_activity_date": 1515519617, "last_edit_date": 1515519617, "creation_date": 1515519048, "answer_id": 48173708, "question_id": 48173628, "link": "https://stackoverflow.com/questions/48173628/golang-sha256-returns-two-different-values-for-the-same-input/48173708#48173708", "title": "Golang: sha256 returns two different values for the same input", "body": "<p>When you call <code>fmt.Sprintf(\"%v\")</code> and pass pointers (including struct fields which are pointers, such as the <a href=\"https://golang.org/src/crypto/elliptic/p224.go#L18\" rel=\"noreferrer\">P224 Curve</a> contains), it prints the addresses, not the values. Because the addresses will be different every run, you'll get different hashes every run. Try using something deterministic, it will be better-suited to the purpose - maybe JSON or Gob, or write your own simple serializer.</p>\n"}], "owner": {"reputation": 2264, "user_id": 1964489, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dced6d8951b4771cde68c08e372bbede?s=128&d=identicon&r=PG", "display_name": "Ziva", "link": "https://stackoverflow.com/users/1964489/ziva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 839, "favorite_count": 0, "accepted_answer_id": 48173708, "answer_count": 1, "score": -1, "last_activity_date": 1535427639, "creation_date": 1515518742, "last_edit_date": 1535427639, "question_id": 48173628, "link": "https://stackoverflow.com/questions/48173628/golang-sha256-returns-two-different-values-for-the-same-input", "title": "Golang: sha256 returns two different values for the same input", "body": "<p>I'm working on implementing some crypto function which require among other things hash operations (I want to compute a hash of a custom struct) So I wanted to use the SHA256 hash function from the <code>crypto</code> golang package. However, I've noticed that when I run my hash function multiple times for the same input sometimes it returns different values. My understanding is that SHA function return the same hash outputs for a single input value. Below is my implementation of the hash function:</p>\n\n<pre><code>func myHash(s MyStruct) []byte{\n\n    bytes := []byte(fmt.Sprintf(\"%v\", s))\n\n    h := sha256.New()\n    h.Write(bytes)\n\n    return h.Sum(nil)\n}\n</code></pre>\n\n<p>And <code>myStruct</code> has the following fields:</p>\n\n<pre><code>type MyStruct struct {\n    elliptic.Curve // I use elliptic.P224() as my curve\n    X, Y, Z *big.Int\n}\n</code></pre>\n\n<p>The output of myHash function run multiple times for the same input value <code>SInput</code> is as follows:</p>\n\n<pre><code>[38 39 88 96 46 192 74 20 93 238 4 18 134 253 238 154 210 89 64 204 13 27 60 78 228 33 57 20 173 80 67 196]\n\n[38 39 88 96 46 192 74 20 93 238 4 18 134 253 238 154 210 89 64 204 13 27 60 78 228 33 57 20 173 80 67 196]\n\n[38 39 88 96 46 192 74 20 93 238 4 18 134 253 238 154 210 89 64 204 13 27 60 78 228 33 57 20 173 80 67 196]\n\n[172 219 215 153 250 30 31 136 175 47 25 178 231 84 90 173 31 130 136 131 169 23 98 198 198 109 255 76 228 134 100 191]\n\n[31 114 57 247 85 214 151 174 124 255 5 200 17 200 198 107 105 56 53 126 233 242 228 74 17 87 238 7 136 100 80 160]\n\n[38 39 88 96 46 192 74 20 93 238 4 18 134 253 238 154 210 89 64 204 13 27 60 78 228 33 57 20 173 80 67 196]\n\n[38 39 88 96 46 192 74 20 93 238 4 18 134 253 238 154 210 89 64 204 13 27 60 78 228 33 57 20 173 80 67 196]\n\n[38 39 88 96 46 192 74 20 93 238 4 18 134 253 238 154 210 89 64 204 13 27 60 78 228 33 57 20 173 80 67 196]\n\n[38 39 88 96 46 192 74 20 93 238 4 18 134 253 238 154 210 89 64 204 13 27 60 78 228 33 57 20 173 80 67 196]\n\n[172 219 215 153 250 30 31 136 175 47 25 178 231 84 90 173 31 130 136 131 169 23 98 198 198 109 255 76 228 134 100 191]\n\n[172 219 215 153 250 30 31 136 175 47 25 178 231 84 90 173 31 130 136 131 169 23 98 198 198 109 255 76 228 134 100 191]\n\n[38 39 88 96 46 192 74 20 93 238 4 18 134 253 238 154 210 89 64 204 13 27 60 78 228 33 57 20 173 80 67 196]\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["testing", "go", "operating-system"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1515518115, "post_id": 48173379, "comment_id": 83326390, "body": "As you can see by <a href=\"https://blog.golang.org/playground\" rel=\"nofollow noreferrer\">how it was done for the Go playground</a>, faking time in Go is no simple task. You might consider altering your design to be more testable, so that it accepts a <code>time.Time</code> rather than using <code>time.Now()</code> internally."}, {"owner": {"reputation": 33, "user_id": 5020473, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-n2Crhk3mEzQ/AAAAAAAAAAI/AAAAAAAAAA4/oMD7drBww9U/photo.jpg?sz=128", "display_name": "emma", "link": "https://stackoverflow.com/users/5020473/emma"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515520440, "post_id": 48173379, "comment_id": 83327613, "body": "This means I won&#39;t be able to call the program and manipulate the time externally? My test framework is written in Java, even if I change the source code to accept a <code>time.Time</code> I cannot test it from Java."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515521518, "post_id": 48173379, "comment_id": 83328154, "body": "Correct. If you&#39;re trying to black-box-test a binary that varies its output based on the system clock (in a way you can&#39;t just disregard entirely), it&#39;s going to be really, really difficult. Maybe you can run it in a VM where you can manipulate the virtual hardware clock somehow."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5020473, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-n2Crhk3mEzQ/AAAAAAAAAAI/AAAAAAAAAA4/oMD7drBww9U/photo.jpg?sz=128", "display_name": "emma", "link": "https://stackoverflow.com/users/5020473/emma"}, "edited": false, "score": 0, "creation_date": 1515520757, "post_id": 48173756, "comment_id": 83327801, "body": "What if I&#39;m writing end-to-end tests for the program? meaning that I will not be able to access the source code directly, but rather creating user scenarios?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 33, "user_id": 5020473, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-n2Crhk3mEzQ/AAAAAAAAAAI/AAAAAAAAAA4/oMD7drBww9U/photo.jpg?sz=128", "display_name": "emma", "link": "https://stackoverflow.com/users/5020473/emma"}, "edited": false, "score": 0, "creation_date": 1515528683, "post_id": 48173756, "comment_id": 83331611, "body": "@emma, no way (almost). The reason is that libfaketime does not intercept syscalls but rather subverts the functions of the standard C library which wrap syscalls. Contrary to C code, Go code on most platforms (except Solaris and Windows) calls the kernel directly. So the two remaining ways are: messing with the kernel somehow and testing your program having it built against a patched Go runtime. The latter is not as hard as it sounds but is still a major undertaking."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 33, "user_id": 5020473, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-n2Crhk3mEzQ/AAAAAAAAAAI/AAAAAAAAAA4/oMD7drBww9U/photo.jpg?sz=128", "display_name": "emma", "link": "https://stackoverflow.com/users/5020473/emma"}, "edited": false, "score": 0, "creation_date": 1614625379, "post_id": 48173756, "comment_id": 117436719, "body": "I would add that currently at my \\$dayjob we&#39;re using <code>github.com&#47;LopatkinEvgeniy&#47;clock</code> as it&#39;s the only package I know of which is able to mock <code>time.Ticker</code> and other timers."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 0, "last_activity_date": 1614625243, "last_edit_date": 1614625243, "creation_date": 1515519239, "answer_id": 48173756, "question_id": 48173379, "link": "https://stackoverflow.com/questions/48173379/is-there-a-libfaketime-alternative-for-golang/48173756#48173756", "title": "Is there a libfaketime alternative for Golang?", "body": "<p>No, there is none.</p>\n<p>You need to use something like <a href=\"https://github.com/jonboulle/clockwork\" rel=\"nofollow noreferrer\"><code>clockwork</code></a> (see <a href=\"https://godoc.org/?q=clock\" rel=\"nofollow noreferrer\">this</a> for more) and explicitly pass &quot;time&quot; implementation around your code.</p>\n<hr />\n<p><em>Update</em> from 2021-03-01 with a more up-to-date list of options:</p>\n<ul>\n<li><a href=\"https://github.com/LopatkinEvgeniy/clock\" rel=\"nofollow noreferrer\">https://github.com/LopatkinEvgeniy/clock</a></li>\n<li><a href=\"https://github.com/jonboulle/clockwork\" rel=\"nofollow noreferrer\">https://github.com/jonboulle/clockwork</a></li>\n<li><a href=\"https://github.com/benbjohnson/clock\" rel=\"nofollow noreferrer\">https://github.com/benbjohnson/clock</a></li>\n<li><a href=\"https://github.com/facebookgo/clock\" rel=\"nofollow noreferrer\">https://github.com/facebookgo/clock</a></li>\n<li><a href=\"https://github.com/tkuchiki/faketime\" rel=\"nofollow noreferrer\">https://github.com/tkuchiki/faketime</a></li>\n<li><a href=\"https://github.com/rzajac/clock\" rel=\"nofollow noreferrer\">https://github.com/rzajac/clock</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2657, "user_id": 1202500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9610771f63a2ef756784bb8736c693ab?s=128&d=identicon&r=PG", "display_name": "mozzbozz", "link": "https://stackoverflow.com/users/1202500/mozzbozz"}, "is_accepted": false, "score": -1, "last_activity_date": 1558431615, "creation_date": 1558431615, "answer_id": 56235458, "question_id": 48173379, "link": "https://stackoverflow.com/questions/48173379/is-there-a-libfaketime-alternative-for-golang/56235458#56235458", "title": "Is there a libfaketime alternative for Golang?", "body": "<p>There is <a href=\"https://github.com/tkuchiki/faketime\" rel=\"nofollow noreferrer\">this</a> repository (tkuchiki/faketime) which claims to be able to fake the <code>time.Now()</code>-function. I don't know how extensively this works and haven't tested it. But it sounds like it might be a solution to your problem.</p>\n"}], "owner": {"reputation": 33, "user_id": 5020473, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-n2Crhk3mEzQ/AAAAAAAAAAI/AAAAAAAAAA4/oMD7drBww9U/photo.jpg?sz=128", "display_name": "emma", "link": "https://stackoverflow.com/users/5020473/emma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "accepted_answer_id": 48173756, "answer_count": 2, "score": 2, "last_activity_date": 1614625243, "creation_date": 1515517858, "question_id": 48173379, "link": "https://stackoverflow.com/questions/48173379/is-there-a-libfaketime-alternative-for-golang", "title": "Is there a libfaketime alternative for Golang?", "body": "<p>I want to automate some tests where I have to manipulate the system time to check for authentication behaviours of a program that is written in golang. According to <a href=\"https://stackoverflow.com/questions/36024872/libfaketime-doesnt-work-with-golang/\">this post</a>, libfaketime does not work with golang. Is there another way that I can achieve what I want to do with libfaketime? </p>\n\n<p>Here's a description of what libfaketime does from github.</p>\n\n<blockquote>\n  <p>libfaketime intercepts various system calls that programs use to retrieve the\n  current date and time. It then reports modified (faked) dates and times (as\n  specified by you, the user) to these programs. This means you can modify the\n  system time a program sees without having to change the time system-wide.</p>\n</blockquote>\n"}, {"tags": ["go", "path", "directory", "filepath"], "answers": [{"comments": [{"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1515518160, "post_id": 48173403, "comment_id": 83326415, "body": "thanks but ..<code>otherdir</code> is constant in your solution, and it actually can be any name and I cannot predict it. something that I know that I should find the file.json in the <code>otherdirN</code> which in the same level of the <code>myproj</code>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1515518272, "post_id": 48173403, "comment_id": 83326486, "body": "That&#39;s fine, just use <code>Walk</code> with the root at e.g. <code>..&#47;</code>. However... what if there are json files in multiple sibling directories? Again, this seems like it should be solved with a config parameter to specify the exact path to be used, rather than trying to walk a directory structure based on current working directory. Doing it as you&#39;ve described will lead to more problems in the future."}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1515518628, "post_id": 48173403, "comment_id": 83326673, "body": "Can you please update your answer with the right <code>walk</code> solution ?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1515519716, "post_id": 48173403, "comment_id": 83327256, "body": "It&#39;s <i>exactly the same code you have</i> with a different root, as explained."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1515518665, "last_edit_date": 1515518665, "creation_date": 1515517967, "answer_id": 48173403, "question_id": 48173359, "link": "https://stackoverflow.com/questions/48173359/go-get-parent-directory/48173403#48173403", "title": "Go get parent directory", "body": "<p>It doesn't matter where the binary is, it matters what the working directory is (the directory you're in when you execute the program). All relative paths will be relative to the current working directory. So, if you're executing from <code>myproject</code>, you'd use something like <code>../</code> as the root path to <code>Walk</code>.</p>\n\n<p>That said, I would <strong>highly recommend</strong> you make the path configurable, rather than assuming the binary will always be executed from some particular location within the source tree.</p>\n"}], "owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2814, "favorite_count": 1, "accepted_answer_id": 48173403, "answer_count": 1, "score": 0, "last_activity_date": 1515518665, "creation_date": 1515517799, "last_edit_date": 1515518010, "question_id": 48173359, "link": "https://stackoverflow.com/questions/48173359/go-get-parent-directory", "title": "Go get parent directory", "body": "<p>I've some command line program which I need to read files from parent folder, I mean </p>\n\n<pre><code>-parentDir\n -- myproject\n --- cmd\n ----main.go \n\n --otherdir\n  -file.json \n</code></pre>\n\n<p>As you can see <code>otherdir</code> is like sibling to <code>myproject</code> and I need from my <code>main.go</code> read the <code>file.json</code></p>\n\n<p>what I've tried is like following</p>\n\n<pre><code>func visit(path string, f os.FileInfo, err error) error {\n  fmt.Printf(\"Visited: %s\\n\", path)\n  return nil\n} \n\n\nfunc main() {\n  flag.Parse()\n  root := flag.Arg(0)\n  err := filepath.Walk(root, visit)\n  fmt.Printf(\"filepath.Walk() returned %v\\n\", err)\n}\n</code></pre>\n\n<p>I've also try to provide args(-1) which doesnt help...\nAny idea how from <code>command line</code> program I can read some files that on level up from my executable ?</p>\n\n<p>I've also tried with </p>\n\n<pre><code>import \"github.com/mitchellh/go-homedir\"\n\n\nfunc Path(path string) (error, string) {\n    home, err := homedir.Dir()\n   }\n</code></pre>\n\n<p>this give the root directory which doesnt help either...</p>\n"}, {"tags": ["testing", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515517094, "post_id": 48173074, "comment_id": 83325839, "body": "What are you actually trying to accomplish with such a function?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1515520274, "post_id": 48173074, "comment_id": 83327531, "body": "<code>go test</code> only tests one package at a time. There is no such thing as &quot;before/after all the tests in subdirectories/subpackages&quot; in the context of <code>go test</code>."}, {"owner": {"reputation": 5486, "user_id": 7603, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/d067cbdcb281602ba20ed58b5759b81a?s=128&d=identicon&r=PG&f=1", "display_name": "Oin", "link": "https://stackoverflow.com/users/7603/oin"}, "edited": false, "score": 0, "creation_date": 1515520418, "post_id": 48173074, "comment_id": 83327603, "body": "thanks JimB. I&#39;m slowly figuring that out. I&#39;ll edit the question to mention that I&#39;m not limited to <code>go test</code> and welcome another test runner."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515520727, "post_id": 48173074, "comment_id": 83327775, "body": "Anything else would be scripted around the invocation of <code>go test</code> on multiple packages -- most projects probably just use a makefile or shell script. There&#39;s no way to do this directly in Go, and recommendations for tools are OT."}, {"owner": {"reputation": 796, "user_id": 1286423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/69924a17cad0b5bfc37e4d83dd848ee1?s=128&d=identicon&r=PG", "display_name": "Dolanor", "link": "https://stackoverflow.com/users/1286423/dolanor"}, "edited": false, "score": 0, "creation_date": 1515537276, "post_id": 48173074, "comment_id": 83335427, "body": "And what if you use TestMain for each package calling a shared function that would work for package a, c and d? It would reduce work to the minimum of calling 1 function by package. Is that too much?"}], "owner": {"reputation": 5486, "user_id": 7603, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/d067cbdcb281602ba20ed58b5759b81a?s=128&d=identicon&r=PG&f=1", "display_name": "Oin", "link": "https://stackoverflow.com/users/7603/oin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1134, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1568110393, "creation_date": 1515516887, "last_edit_date": 1515520477, "question_id": 48173074, "link": "https://stackoverflow.com/questions/48173074/golang-test-setup-for-entire-test-run-package", "title": "golang test setup for entire test run/package", "body": "<p>Is there a way to specify code to be run before all the tests in the current test run? Even when running tests across deeply nested directories? e.g.</p>\n\n<pre><code>a/\na/a_test.go\nb/c/\nb/c/c_test.go\nd_test.go\n</code></pre>\n\n<p>I want to write some code that runs <em>once</em> before and <em>once</em> after all the tests in files <code>a_test.go</code>, <code>c_test.go</code>, <code>d_test.go</code> have run.</p>\n\n<p>I know about <a href=\"https://golang.org/pkg/testing/#hdr-Main\" rel=\"nofollow noreferrer\">TestMain</a>, which sorta does what I want if I needed to do this at the package level, but this doesn't run before/after all the tests in subdirectories/subpackages. I want something that's one level above <code>TestMain</code>. </p>\n\n<p>I'm not limited to <code>go test</code>, so if there's a third-party test runner that would do this for go, that would be alright as well.</p>\n\n<p>I'm looking for something akin to nosetests's <code>SetUpPackage</code> or pytest's session scoped fixtures.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 4, "creation_date": 1515516811, "post_id": 48172952, "comment_id": 83325659, "body": "A code sample along with expected vs actual behavior could really help us help you."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1515517051, "post_id": 48172952, "comment_id": 83325810, "body": "It only changes when you change it. If you want a constant, <a href=\"https://tour.golang.org/basics/15\" rel=\"nofollow noreferrer\">use a constant</a>."}, {"owner": {"reputation": 51, "user_id": 9047033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06c38bc81c84a6ebafc064eba03aa81?s=128&d=identicon&r=PG&f=1", "display_name": "D13", "link": "https://stackoverflow.com/users/9047033/d13"}, "edited": false, "score": 0, "creation_date": 1515519521, "post_id": 48172952, "comment_id": 83327157, "body": "I don&#39;t need a constant. What I need is something equal to static."}, {"owner": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "edited": false, "score": 0, "creation_date": 1515519629, "post_id": 48172952, "comment_id": 83327220, "body": "You can use package-level variables that are similar to global static variables. &quot;static&quot; doesn&#39;t really exist in Go since it does not have classes."}, {"owner": {"reputation": 715, "user_id": 9172232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ed8ca4bd2c3adec049105413913bd4?s=128&d=identicon&r=PG&f=1", "display_name": "the4thamigo_uk", "link": "https://stackoverflow.com/users/9172232/the4thamigo-uk"}, "edited": false, "score": 0, "creation_date": 1515524184, "post_id": 48172952, "comment_id": 83329552, "body": "can you add the declaration of gID"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1515526759, "post_id": 48172952, "comment_id": 83330715, "body": "The calls to <code>NewLearner</code> would also be useful. Or even a runnable example at <a href=\"http://play.golang.org\" rel=\"nofollow noreferrer\">play.golang.org</a>"}, {"owner": {"reputation": 51, "user_id": 9047033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06c38bc81c84a6ebafc064eba03aa81?s=128&d=identicon&r=PG&f=1", "display_name": "D13", "link": "https://stackoverflow.com/users/9047033/d13"}, "reply_to_user": {"reputation": 715, "user_id": 9172232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ed8ca4bd2c3adec049105413913bd4?s=128&d=identicon&r=PG&f=1", "display_name": "the4thamigo_uk", "link": "https://stackoverflow.com/users/9172232/the4thamigo-uk"}, "edited": false, "score": 0, "creation_date": 1515527318, "post_id": 48172952, "comment_id": 83330985, "body": "@the4thamigo_uk , gID is declared on the top of the file as var gID types.ID ."}, {"owner": {"reputation": 715, "user_id": 9172232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ed8ca4bd2c3adec049105413913bd4?s=128&d=identicon&r=PG&f=1", "display_name": "the4thamigo_uk", "link": "https://stackoverflow.com/users/9172232/the4thamigo-uk"}, "edited": false, "score": 0, "creation_date": 1515528139, "post_id": 48172952, "comment_id": 83331338, "body": "Are you sure <code>gID</code> is being set in the if block? maybe try to output it after it has been set with <code>fmt.Printf(&quot;gID=%v&quot;, gID)</code>. where is <code>types.ID</code> defined?"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "edited": false, "score": 0, "creation_date": 1515538298, "post_id": 48172952, "comment_id": 83335769, "body": "@robbrit: You can do silly things with function closures to create a function-local variable much like a C static function variable. Set a variable equal to the result of a function that closes over a variable and returns a function."}, {"owner": {"reputation": 51, "user_id": 9047033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06c38bc81c84a6ebafc064eba03aa81?s=128&d=identicon&r=PG&f=1", "display_name": "D13", "link": "https://stackoverflow.com/users/9047033/d13"}, "reply_to_user": {"reputation": 715, "user_id": 9172232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ed8ca4bd2c3adec049105413913bd4?s=128&d=identicon&r=PG&f=1", "display_name": "the4thamigo_uk", "link": "https://stackoverflow.com/users/9172232/the4thamigo-uk"}, "edited": false, "score": 0, "creation_date": 1515587442, "post_id": 48172952, "comment_id": 83354679, "body": "@the4thamigo_uk I printed gID and it does take the value of l.ID. Problem is on else statement. I expect to print a hash and it gives me 0."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1606314616, "post_id": 48172952, "comment_id": 114927387, "body": "unclear cannot help. It is missing a reproducible code example to better understand what is going on. Assigning to a package level variable is OK."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9047033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06c38bc81c84a6ebafc064eba03aa81?s=128&d=identicon&r=PG&f=1", "display_name": "D13", "link": "https://stackoverflow.com/users/9047033/d13"}, "edited": false, "score": 0, "creation_date": 1515587529, "post_id": 48177749, "comment_id": 83354733, "body": "I tried this and my program keeps having the problem that I have told. Maybe it is not a concurrency matter."}, {"owner": {"reputation": 796, "user_id": 1286423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/69924a17cad0b5bfc37e4d83dd848ee1?s=128&d=identicon&r=PG", "display_name": "Dolanor", "link": "https://stackoverflow.com/users/1286423/dolanor"}, "reply_to_user": {"reputation": 51, "user_id": 9047033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06c38bc81c84a6ebafc064eba03aa81?s=128&d=identicon&r=PG&f=1", "display_name": "D13", "link": "https://stackoverflow.com/users/9047033/d13"}, "edited": false, "score": 0, "creation_date": 1515604154, "post_id": 48177749, "comment_id": 83365715, "body": "Does your now var changes between each call? Is your computation of hash correct? (don&#39;t have time to try it right now)"}], "tags": [], "owner": {"reputation": 796, "user_id": 1286423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/69924a17cad0b5bfc37e4d83dd848ee1?s=128&d=identicon&r=PG", "display_name": "Dolanor", "link": "https://stackoverflow.com/users/1286423/dolanor"}, "is_accepted": false, "score": 0, "last_activity_date": 1515537985, "creation_date": 1515537985, "answer_id": 48177749, "question_id": 48172952, "link": "https://stackoverflow.com/questions/48172952/static-global-variables-in-golang/48177749#48177749", "title": "Static global variables in Golang", "body": "<p>The fact that the package variable doesn't keep its value might be caused by concurrency.\nI would solve your problem that way. Use a package variable with a mutex around in case the function is called concurrently.</p>\n\n<pre><code>import \"sync\"\n\nvar(\n    gID  uint64\n    muID sync.Mutex\n)\n\nfunc myfunc(param bool) {\n    var id uint64\n    if param {\n        id = newID()\n\n        muID.Lock()\n        gID = id\n        muID.Unlock()\n    } else {\n        muID.Lock()\n        id = gID\n        muID.Unlock()\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 7961353, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2c0d31851dd72635ee741200a6ce5747?s=128&d=identicon&r=PG&f=1", "display_name": "Onkar Banerjee", "link": "https://stackoverflow.com/users/7961353/onkar-banerjee"}, "is_accepted": false, "score": 0, "last_activity_date": 1568044772, "last_edit_date": 1568044772, "creation_date": 1515599369, "answer_id": 48191215, "question_id": 48172952, "link": "https://stackoverflow.com/questions/48172952/static-global-variables-in-golang/48191215#48191215", "title": "Static global variables in Golang", "body": "<p>How about using a channel? You can have channel (global in your context) of <code>uint64</code>.</p>\n\n<pre><code>idChan := make(chan uint64)\n</code></pre>\n\n<p>And then inside your if condition you can put the <code>gID</code> in the <code>idChan</code> and read the same from your <code>else</code> condition.. something like this:</p>\n\n<pre><code>    if now != nil {\n        b = append(b, []byte(fmt.Sprintf(\"%d\", now.Unix()))...)\n        hash := sha1.Sum(b)\n        l.ID = types.ID(binary.BigEndian.Uint64(hash[:8]))\n        idChan &lt;- l.ID\n        return l\n    }  else {\n        l.ID &lt;- idChan\n        return l    \n    }\n</code></pre>\n\n<p>Do remember to close your channel appropriately though if you dont want to use it anywhere else anymore.</p>\n\n<p>Although, i must advise that such stuffs are usually better and more safely handled by goroutines with waitgroups probably since you actually want to share a value. In your case something like maybe a goroutine that does if part and another that does the else part and then share this channel amongst those two goroutines and wait on the wait groups for code that depends on these goroutines completion. That really is what concurrency is.</p>\n"}], "owner": {"reputation": 51, "user_id": 9047033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06c38bc81c84a6ebafc064eba03aa81?s=128&d=identicon&r=PG&f=1", "display_name": "D13", "link": "https://stackoverflow.com/users/9047033/d13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 9764, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1616785616, "creation_date": 1515516506, "last_edit_date": 1568043693, "question_id": 48172952, "link": "https://stackoverflow.com/questions/48172952/static-global-variables-in-golang", "title": "Static global variables in Golang", "body": "<p>I am new in Go language and I need some help. I have declared a global variable but the problem is that it does not keep its value. It would be solved with a static variable but no such variables exist in Go. How should I solve this?</p>\n\n<p><code>gID</code> is a global variable. This function is called twice. On the first call <code>if</code> code is executed. On the second, <code>else</code> code is executed. I want the second struct <code>Learner</code> instance, to get first Learner's instance ID. </p>\n\n<p><strong>I have to mention that NewLearner is called twice from two different files from different packages</strong>.</p>\n\n<pre><code>func NewLearner(name string, peerURLs types.URLs, clusterName string, now *time.Time) *Learner {\n\n    l := &amp;Learner{\n        RaftAttributes: RaftAttributes{PeerURLs: peerURLs.StringSlice()},\n        Attributes:     Attributes{Name: name},\n    }\n\n    var b []byte\n    sort.Strings(l.PeerURLs)\n    for _, p := range l.PeerURLs {\n        b = append(b, []byte(p)...)\n    }\n\n    b = append(b, []byte(clusterName)...)\n    if now != nil {\n        b = append(b, []byte(fmt.Sprintf(\"%d\", now.Unix()))...)\n        hash := sha1.Sum(b)\n        l.ID = types.ID(binary.BigEndian.Uint64(hash[:8]))\n        gID=l.ID\n        return l\n    }  else {\n        l.ID = gID\n        return l    \n    }\n\n}\n</code></pre>\n"}, {"tags": ["go", "grpc"], "answers": [{"comments": [{"owner": {"reputation": 9594, "user_id": 448734, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/94ccfc629c6862b5950de3512742bcae?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/448734/bryan"}, "edited": false, "score": 0, "creation_date": 1515953558, "post_id": 48178437, "comment_id": 83487675, "body": "Thanks; this is half-useful since it names functions to call, but it does not show how to use them. Also &quot;Always quote the most relevant part of an important link, in case the target site is unreachable or goes permanently offline.&quot; <a href=\"https://stackoverflow.com/help/how-to-answer\">stackoverflow.com/help/how-to-answer</a>."}], "tags": [], "owner": {"reputation": 576, "user_id": 7371810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53dfe10f0150e2213e244ef1b93ccde?s=128&d=identicon&r=PG&f=1", "display_name": "menghanl", "link": "https://stackoverflow.com/users/7371810/menghanl"}, "is_accepted": false, "score": 1, "last_activity_date": 1515542398, "creation_date": 1515542398, "answer_id": 48178437, "question_id": 48172594, "link": "https://stackoverflow.com/questions/48172594/how-to-enable-grpc-compression-in-go/48178437#48178437", "title": "How to enable GRPC compression in Go", "body": "<p>Doc on the compression APIs can be find at: <a href=\"https://github.com/grpc/grpc-go/blob/master/Documentation/compression.md\" rel=\"nofollow noreferrer\">https://github.com/grpc/grpc-go/blob/master/Documentation/compression.md</a></p>\n"}, {"tags": [], "owner": {"reputation": 315, "user_id": 2855881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/033c0a20e4d0a29e71be93febdf073a1?s=128&d=identicon&r=PG&f=1", "display_name": "cvigo", "link": "https://stackoverflow.com/users/2855881/cvigo"}, "is_accepted": true, "score": 6, "last_activity_date": 1523308596, "last_edit_date": 1523308596, "creation_date": 1522137829, "answer_id": 49507459, "question_id": 48172594, "link": "https://stackoverflow.com/questions/48172594/how-to-enable-grpc-compression-in-go/49507459#49507459", "title": "How to enable GRPC compression in Go", "body": "<p><code>grpc.WithCompressor</code> as DialOption is deprecated, according to the docs.</p>\n\n<p>You can use the <code>grpc.UseCompressor(gzip.Name)</code> CallOption, which operates at call level</p>\n\n<pre><code>var opts []grpc.CallOption\nopts = append(callOptions, grpc.UseCompressor(gzip.Name))\nopts = append(callOptions, ...)\nopts = append(callOptions, ...)\n\nerr := grpc.Invoke(mycontext, \"/myRpcFuntion\", myInput, myOutput, myGrpcConn, opts...)\n</code></pre>\n\n<p>You do not need to call <code>RegisterCompressor</code>. The gzip package import does it for you in the <code>init()</code> function</p>\n\n<pre><code>func init() {\n    c := &amp;compressor{}\n    c.poolCompressor.New = func() interface{} {\n        return &amp;writer{Writer: gzip.NewWriter(ioutil.Discard), pool: &amp;c.poolCompressor}\n    }\n    encoding.RegisterCompressor(c)\n}\n</code></pre>\n\n<p>At the server side, you need to import the <code>gzip</code> package to make sure that the gzip compressor is registered.</p>\n\n<pre><code>import _ \"google.golang.org/grpc/encoding/gzip\"\n</code></pre>\n"}], "owner": {"reputation": 9594, "user_id": 448734, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/94ccfc629c6862b5950de3512742bcae?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/448734/bryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3880, "favorite_count": 4, "accepted_answer_id": 49507459, "answer_count": 2, "score": 5, "last_activity_date": 1523308596, "creation_date": 1515515301, "question_id": 48172594, "link": "https://stackoverflow.com/questions/48172594/how-to-enable-grpc-compression-in-go", "title": "How to enable GRPC compression in Go", "body": "<p>I see some methods <code>WithCompression</code> and <code>UseCompression</code> but I'm not very clear how they all fit together - a simple example of what to put in the client and what to put in the server would really help.</p>\n\n<p>My first attempt, </p>\n\n<pre><code>conn, err := grpc.Dial(\n    addr,\n    grpc.WithTimeout(timeout),\n    grpc.WithCompressor(grpc.NewGZIPCompressor()),\n    ...\n</code></pre>\n\n<p>resulted in this error when I made a call:</p>\n\n<pre><code>grpc: Decompressor is not installed for grpc-encoding \\\"gzip\\\"\n</code></pre>\n"}, {"tags": ["go", "grpc"], "answers": [{"tags": [], "owner": {"reputation": 576, "user_id": 7371810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53dfe10f0150e2213e244ef1b93ccde?s=128&d=identicon&r=PG&f=1", "display_name": "menghanl", "link": "https://stackoverflow.com/users/7371810/menghanl"}, "is_accepted": true, "score": 1, "last_activity_date": 1515542216, "creation_date": 1515542216, "answer_id": 48178414, "question_id": 48172329, "link": "https://stackoverflow.com/questions/48172329/attaching-a-stats-handler-to-grpc-in-go/48178414#48178414", "title": "Attaching a stats handler to gRPC in Go", "body": "<p>stats handler is not fully support in ServeHTTP Handler now.</p>\n\n<p>More details in <a href=\"https://github.com/grpc/grpc-go/issues/1784\" rel=\"nofollow noreferrer\">https://github.com/grpc/grpc-go/issues/1784</a></p>\n\n<p>(I just noticed that you also filed the issue, but this may help other people also interested in this)</p>\n"}], "owner": {"reputation": 524, "user_id": 4695952, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ddbb13b83fa0193327392265d2b94963?s=128&d=identicon&r=PG&f=1", "display_name": "Dikshant Adhikari", "link": "https://stackoverflow.com/users/4695952/dikshant-adhikari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "accepted_answer_id": 48178414, "answer_count": 1, "score": 1, "last_activity_date": 1515542216, "creation_date": 1515514305, "question_id": 48172329, "link": "https://stackoverflow.com/questions/48172329/attaching-a-stats-handler-to-grpc-in-go", "title": "Attaching a stats handler to gRPC in Go", "body": "<p>So I am using a mux that will determine what type of request is incoming (gRPC or REST) and route the request accordingly. For gRPC requests I am attaching a stats handler to collect some metadata but one of the interface methods <code>TagRPC()</code> which we use to tag our metadata is not being called. </p>\n\n<pre><code>app.httpMux.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n    if isgRPC(r) {\n        app.gRPCServer.ServeHTTP(w, r)\n    } else {\n        app.rMux.ServeHTTP(w, r)\n    }\n})\n</code></pre>\n\n<p>I think the problem is with gRPC's ServeHTTP method not supporting all the methods. If I were to attach <code>TagGRPC()</code> manually where would be a good place to do it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1515510500, "post_id": 48171039, "comment_id": 83321600, "body": "It might be, but we can&#39;t help you without the code. See <a href=\"https://stackoverflow.com/questions/47660897/unknown-field-in-panic-stack-trace\" title=\"unknown field in panic stack trace\">stackoverflow.com/questions/47660897/&hellip;</a>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515526317, "post_id": 48171039, "comment_id": 83330491, "body": "That&#39;s not the full method signature, because you haven&#39;t provided the definition of the <code>Number</code> type, but the <code>num</code> argument from the stack is <code>0xf4698</code>"}], "answers": [{"comments": [{"owner": {"reputation": 573, "user_id": 1461482, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5705236c7b4c1258ea03199dee58f841?s=128&d=identicon&r=PG", "display_name": "Riyaz Mansoor", "link": "https://stackoverflow.com/users/1461482/riyaz-mansoor"}, "edited": false, "score": 0, "creation_date": 1515519823, "post_id": 48171365, "comment_id": 83327301, "body": "the signature is just an int -&gt; util.(*NumberEngine).Number(num int)"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 573, "user_id": 1461482, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5705236c7b4c1258ea03199dee58f841?s=128&d=identicon&r=PG", "display_name": "Riyaz Mansoor", "link": "https://stackoverflow.com/users/1461482/riyaz-mansoor"}, "edited": false, "score": 0, "creation_date": 1515520330, "post_id": 48171365, "comment_id": 83327560, "body": "@RiyazMansoor, I can&#39;t beleive it has a single argument of type <code>int</code>. Please double check."}, {"owner": {"reputation": 573, "user_id": 1461482, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5705236c7b4c1258ea03199dee58f841?s=128&d=identicon&r=PG", "display_name": "Riyaz Mansoor", "link": "https://stackoverflow.com/users/1461482/riyaz-mansoor"}, "edited": false, "score": 0, "creation_date": 1515520446, "post_id": 48171365, "comment_id": 83327617, "body": "have updated original post with full method signature."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515525322, "post_id": 48171365, "comment_id": 83330038, "body": "@kostix: return parameters are also allocated on the stack (I forgot to mention that in my linked answer, but probably should)"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 573, "user_id": 1461482, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5705236c7b4c1258ea03199dee58f841?s=128&d=identicon&r=PG", "display_name": "Riyaz Mansoor", "link": "https://stackoverflow.com/users/1461482/riyaz-mansoor"}, "edited": false, "score": 0, "creation_date": 1515528377, "post_id": 48171365, "comment_id": 83331462, "body": "@RiyazMansoor, please also provide the definition of <code>Number</code>"}, {"owner": {"reputation": 573, "user_id": 1461482, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5705236c7b4c1258ea03199dee58f841?s=128&d=identicon&r=PG", "display_name": "Riyaz Mansoor", "link": "https://stackoverflow.com/users/1461482/riyaz-mansoor"}, "edited": false, "score": 0, "creation_date": 1515530200, "post_id": 48171365, "comment_id": 83332362, "body": "Hi. Updated OP with definition of Number. This is getting really interesting now :)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 573, "user_id": 1461482, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5705236c7b4c1258ea03199dee58f841?s=128&d=identicon&r=PG", "display_name": "Riyaz Mansoor", "link": "https://stackoverflow.com/users/1461482/riyaz-mansoor"}, "edited": false, "score": 0, "creation_date": 1515534400, "post_id": 48171365, "comment_id": 83334262, "body": "@RiyazMansoor: it&#39;s not <i>that</i> interesting, because return parameters are not initialized, so the last 3 numbers are pretty much meaningless, but it does corroborate the stack is what is expected from your example."}, {"owner": {"reputation": 573, "user_id": 1461482, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5705236c7b4c1258ea03199dee58f841?s=128&d=identicon&r=PG", "display_name": "Riyaz Mansoor", "link": "https://stackoverflow.com/users/1461482/riyaz-mansoor"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515552922, "post_id": 48171365, "comment_id": 83339351, "body": "@JimB Hmmm, so how to find the int passed to the method from the panic stack trace ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 573, "user_id": 1461482, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5705236c7b4c1258ea03199dee58f841?s=128&d=identicon&r=PG", "display_name": "Riyaz Mansoor", "link": "https://stackoverflow.com/users/1461482/riyaz-mansoor"}, "edited": false, "score": 0, "creation_date": 1515554551, "post_id": 48171365, "comment_id": 83339708, "body": "@RiyazMansoor, just like in the answer I linked in the other comments, and in this answer. The int passed in is 0xf4698"}, {"owner": {"reputation": 573, "user_id": 1461482, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5705236c7b4c1258ea03199dee58f841?s=128&d=identicon&r=PG", "display_name": "Riyaz Mansoor", "link": "https://stackoverflow.com/users/1461482/riyaz-mansoor"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515571073, "post_id": 48171365, "comment_id": 83344908, "body": "Thanks @JimB @ kostix - this would save a lot time for me.  Quick question, same for floats? what about strings? would it be address of the string?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 573, "user_id": 1461482, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5705236c7b4c1258ea03199dee58f841?s=128&d=identicon&r=PG", "display_name": "Riyaz Mansoor", "link": "https://stackoverflow.com/users/1461482/riyaz-mansoor"}, "edited": false, "score": 2, "creation_date": 1515592239, "post_id": 48171365, "comment_id": 83357568, "body": "@RiyazMansoor: The arguments to the function are printed out, which would include floats, which again is explained in more detail in the answer I linked above. String are 2 word headers, so you can&#39;t see the actual string contents in the argument, just the length and data pointer."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 3, "last_activity_date": 1515511271, "creation_date": 1515511271, "answer_id": 48171365, "question_id": 48171039, "link": "https://stackoverflow.com/questions/48171039/panic-stack-trace-how-the-values-are-mapped-to-a-functions-arguments/48171365#48171365", "title": "Panic stack trace: How the values are mapped to a function&#39;s arguments?", "body": "<p>In the \"reference\" implementation (that one, dubbed <code>gc</code> and available for download at <a href=\"https://golang.org\" rel=\"nofollow noreferrer\">https://golang.org</a>):</p>\n\n<ul>\n<li><p>The first argument to a method is the method's receiver.</p>\n\n<p>In your case it's a pointer receiver, so <code>0xc042066150</code> is the\naddress of that <code>NumberEngine</code> instance in memory.</p></li>\n<li><p>All the arguments are passed on the stack \u2014 from left to right.</p>\n\n<ul>\n<li>The fields of compound types such as <code>struct</code>s appear in the order they are defined in the type.</li>\n<li><code>string</code>s and slices are compound types \u2014 of two and three fields each,\nrespectively: pointer + length and pointer + length + capacity.</li>\n</ul></li>\n</ul>\n\n<p>For more info, we need the signature of the <code>util.(*NumberEngine).Number</code> method, and the definitions of any custom types it uses, if any.</p>\n"}], "owner": {"reputation": 573, "user_id": 1461482, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5705236c7b4c1258ea03199dee58f841?s=128&d=identicon&r=PG", "display_name": "Riyaz Mansoor", "link": "https://stackoverflow.com/users/1461482/riyaz-mansoor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 620, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1515530161, "creation_date": 1515510235, "last_edit_date": 1515530161, "question_id": 48171039, "link": "https://stackoverflow.com/questions/48171039/panic-stack-trace-how-the-values-are-mapped-to-a-functions-arguments", "title": "Panic stack trace: How the values are mapped to a function&#39;s arguments?", "body": "<p>Looking at the last line there \".Number(...\"</p>\n\n<p>Is it possible to discern the arguments to the method <code>Number()</code> from those hex numbers? </p>\n\n<p>It would be a help, without hitting the debugger too often.</p>\n\n<pre><code>panic: runtime error: index out of range\n\ngoroutine 19 [running]:\ntesting.tRunner.func1(0xc042046340)\n    C:/Go/src/testing/testing.go:622 +0x2a4\npanic(0x523e20, 0x5df810)\n    C:/Go/src/runtime/panic.go:489 +0x2dd\nutil.(*NumberEngine).Number(0xc042066150, 0xf4698, 0xa, 0xc042b2a870, 0xa)\n</code></pre>\n\n<p>edit: including the full signature of method</p>\n\n<pre><code>func (fe *NumberEngine) Number(num int) Number {\n</code></pre>\n\n<p>edit: including the definition of Number</p>\n\n<pre><code>type Power struct{ Prime, Exp int }\ntype Number []Power\n</code></pre>\n"}, {"tags": ["javascript", "authentication", "go", "jwt"], "answers": [{"comments": [{"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 0, "creation_date": 1515505125, "post_id": 48169157, "comment_id": 83318104, "body": "Hmm, then I get index out of range. Maybe I will take [0] then."}, {"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 0, "creation_date": 1515506084, "post_id": 48169157, "comment_id": 83318718, "body": "The JWT is getting passed in the request header, so that&#39;s not the issue"}, {"owner": {"reputation": 867, "user_id": 5727404, "user_type": "registered", "profile_image": "https://graph.facebook.com/986754931395634/picture?type=large", "display_name": "Sebastian Krysiak", "link": "https://stackoverflow.com/users/5727404/sebastian-krysiak"}, "reply_to_user": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 0, "creation_date": 1515506174, "post_id": 48169157, "comment_id": 83318763, "body": "Can You show me how does the reqToken look like? Just anonymize the token"}, {"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 0, "creation_date": 1515506279, "post_id": 48169157, "comment_id": 83318827, "body": "I don&#39;t know how to do that. Sorry."}, {"owner": {"reputation": 867, "user_id": 5727404, "user_type": "registered", "profile_image": "https://graph.facebook.com/986754931395634/picture?type=large", "display_name": "Sebastian Krysiak", "link": "https://stackoverflow.com/users/5727404/sebastian-krysiak"}, "reply_to_user": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 0, "creation_date": 1515506399, "post_id": 48169157, "comment_id": 83318904, "body": "fmt.Println(reqToken) before the split part and replace your token with something like &quot;Bearer THISSHOULDBYMYTOKEN&quot;  : )"}, {"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 0, "creation_date": 1515509540, "post_id": 48169157, "comment_id": 83320907, "body": "Before: split <code>Bearer TOKEN</code>  , After split: <code>TOKEN</code>"}, {"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 0, "creation_date": 1515509590, "post_id": 48169157, "comment_id": 83320939, "body": "If I go to jwt.io , it says my signature is invalid for token? :-/"}, {"owner": {"reputation": 867, "user_id": 5727404, "user_type": "registered", "profile_image": "https://graph.facebook.com/986754931395634/picture?type=large", "display_name": "Sebastian Krysiak", "link": "https://stackoverflow.com/users/5727404/sebastian-krysiak"}, "reply_to_user": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 0, "creation_date": 1515513242, "post_id": 48169157, "comment_id": 83323449, "body": "Have you filled VERIFY SIGNATURE section (right bottom) on jwt.io with your token provider data?"}, {"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 0, "creation_date": 1515513689, "post_id": 48169157, "comment_id": 83323742, "body": "It works now. I was passing the token wrong. It verifies token for each user now :)"}], "tags": [], "owner": {"reputation": 867, "user_id": 5727404, "user_type": "registered", "profile_image": "https://graph.facebook.com/986754931395634/picture?type=large", "display_name": "Sebastian Krysiak", "link": "https://stackoverflow.com/users/5727404/sebastian-krysiak"}, "is_accepted": true, "score": 4, "last_activity_date": 1515504527, "last_edit_date": 1515504527, "creation_date": 1515504090, "answer_id": 48169157, "question_id": 48169033, "link": "https://stackoverflow.com/questions/48169033/go-parsing-jwt-error-verifying-id-token-illegal-base64-data-at-input-byte-0/48169157#48169157", "title": "Go parsing JWT: error verifying ID token: illegal base64 data at input byte 0", "body": "<p>Remove the leading space in Authorization header split</p>\n\n<pre><code>strings.Split(reqToken, \"Bearer \")\n</code></pre>\n"}], "owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 960, "favorite_count": 0, "accepted_answer_id": 48169157, "answer_count": 1, "score": 0, "last_activity_date": 1515504527, "creation_date": 1515503695, "question_id": 48169033, "link": "https://stackoverflow.com/questions/48169033/go-parsing-jwt-error-verifying-id-token-illegal-base64-data-at-input-byte-0", "title": "Go parsing JWT: error verifying ID token: illegal base64 data at input byte 0", "body": "<p>I'm adding a Firebase JWT to my Google App Engine Go-service in the request header of a GET request. Here's the JavaScript:</p>\n\n<pre><code>const response = await fetch(\n                'https://some-app.appspot.com/_ah/data', {\n                    method: 'get',\n                    headers: {\n                        'Authorization': 'Bearer ' + await Component.fetchJWT()\n                    }\n                });\n</code></pre>\n\n<p>On my Go service, which is hosted at the endpoint, the request is received. However, the error is thrown:</p>\n\n<p><code>error verifying ID token: illegal base64 data at input byte 0</code></p>\n\n<p>Here is how I process the JWT:</p>\n\n<pre><code>func (ma *myapp) SomeHandler(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    reqToken := r.Header.Get(\"Authorization\")\n    splitToken := strings.Split(reqToken, \"Bearer\")\n    reqToken = splitToken[1]\n    fmt.Println(reqToken) // Prints the token correctly\n\n    lib.VerifyIDToken(ma.fbapp, reqToken) // Error is thrown in this function\n\n    enc := json.NewEncoder(w)\n    err := enc.Encode(SomeData)\n\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n}\n</code></pre>\n\n<p>The token function is as such:</p>\n\n<pre><code>func VerifyIDToken(app *firebase.App, idToken string) *auth.Token {\n    // [START verify_id_token]\n    client, err := app.Auth(context.Background())\n    if err != nil {\n        log.Fatalf(\"error getting Auth client: %v\\n\", err)\n    }\n\n    token, err := client.VerifyIDToken(idToken)\n    if err != nil {\n        log.Fatalf(\"error verifying ID token: %v\\n\", err) // Error thrown here\n    }\n\n    log.Printf(\"Verified ID token: %v\\n\", token)\n    // [END verify_id_token]\n\n    return token\n}\n</code></pre>\n\n<p>When printing out the token, it appears fine to me. However, is my method of retrieving it from the request header wrong? It could appear so?</p>\n"}, {"tags": ["string", "go", "replace"], "comments": [{"owner": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 0, "creation_date": 1515503532, "post_id": 48168943, "comment_id": 83317129, "body": "....and the problem is?"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 9193147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eb21d4158dcdec4c0c2b119ed0e820e?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/9193147/john-f"}, "edited": false, "score": 0, "creation_date": 1515504239, "post_id": 48168963, "comment_id": 83317557, "body": "duh, yep that&#39;s it I copied some old code and forgot I was not assigning the value. Thx"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1515503482, "creation_date": 1515503482, "answer_id": 48168963, "question_id": 48168943, "link": "https://stackoverflow.com/questions/48168943/replace-windows-newline-character-in-go/48168963#48168963", "title": "Replace Windows newline character in Go", "body": "<p>You are just printing the same <code>string</code> value twice. <a href=\"https://golang.org/pkg/strings/#Replace\" rel=\"nofollow noreferrer\"><code>strings.Replace()</code></a> returns you the result which you just discard (you don't do anything with it). Store the result e.g. to the same variable:</p>\n\n<pre><code>fmt.Println(hw)\nhw = strings.Replace(hw, \"\\r\\n\", \" \", -1)\nfmt.Println(hw)\n</code></pre>\n\n<p>Output will be (try it on the <a href=\"https://play.golang.org/p/HM25PdgWuMg\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>hello\nworld\nhello world\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 9193147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eb21d4158dcdec4c0c2b119ed0e820e?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/9193147/john-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 0, "accepted_answer_id": 48168963, "answer_count": 1, "score": -2, "last_activity_date": 1515504151, "creation_date": 1515503403, "last_edit_date": 1515504151, "question_id": 48168943, "link": "https://stackoverflow.com/questions/48168943/replace-windows-newline-character-in-go", "title": "Replace Windows newline character in Go", "body": "<p>Trying to replace windows line ending using <code>strings.Replace</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nvar hw string = \"hello\\r\\nworld\"\n\nfunc main() {\n    fmt.Println(hw)\n    strings.Replace(hw, \"\\r\\n\", \" \", -1)\n    fmt.Println(hw)\n}\n</code></pre>\n\n<p>I suppose it is something very simple I am missing but not sure why the above does not work.</p>\n"}, {"tags": ["dictionary", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1515502881, "post_id": 48168670, "comment_id": 83316730, "body": "You cannot. Or use comma-okay to see if B--&gt;A is in the map and query A--&gt;B if not."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1515503018, "post_id": 48168670, "comment_id": 83316815, "body": "They may be the same route or distance but they are not the same <code>Route</code>. You need to come up with a type that is the same for both."}, {"owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "edited": false, "score": 0, "creation_date": 1515503190, "post_id": 48168670, "comment_id": 83316928, "body": "Is it possible to override the rules when one <code>Route</code> equals to another <code>Route</code>?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1515505535, "post_id": 48168670, "comment_id": 83318361, "body": "No. Equality is a fixed language construct and not user definable."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1515503156, "last_edit_date": 1515503156, "creation_date": 1515502764, "answer_id": 48168755, "question_id": 48168670, "link": "https://stackoverflow.com/questions/48168670/construct-user-defined-map-in-go/48168755#48168755", "title": "Construct user defined map in Go", "body": "<p>Index the map with a <code>Route</code> where <code>finish</code> and <code>start</code> are swapped: </p>\n\n<pre><code>m[Route{start: w.finish, finish: w.start}]\n</code></pre>\n\n<p>If you want to check both directions, create a helper function for it:</p>\n\n<pre><code>var m = make(map[Route]int)\n\nfunc dist(r Route) int {\n    if d, ok := m[r]; ok {\n        return d\n    }\n    return m[Route{start: r.finish, finish: r.start}]\n}\n</code></pre>\n\n<p>Note that <code>dist()</code> will return <code>0</code> if neither direction is in the map. If you want to return this info too:</p>\n\n<pre><code>func dist(r Route) (d int, found bool) {\n    d, found = m[r]\n    if !found {\n        d, found = m[Route{start: r.finish, finish: r.start}]\n    }\n    return\n}\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/BHPSHp8f8Er\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 1, "last_activity_date": 1515503166, "creation_date": 1515503166, "answer_id": 48168875, "question_id": 48168670, "link": "https://stackoverflow.com/questions/48168670/construct-user-defined-map-in-go/48168875#48168875", "title": "Construct user defined map in Go", "body": "<p>A few ways to do this without pushing an additional value. Either perform two map accesses:</p>\n\n<pre><code>r := Route{\n    start: \"B\",\n    finish: \"A\",\n}\nd, ok := m[r]\nif !ok {\n    r.start = \"B\"\n    r.finish = \"A\"\n    d, ok = m[r]\n}\nif !ok {\n    // value not found\n}\n</code></pre>\n\n<p>Or for every map store and access, sort the <code>start</code> and <code>finish</code>:</p>\n\n<pre><code>func Put(start, finish string, d int) {\n    r := Route{start, finish}\n    if start &gt; finish {\n        r.start = finish\n        r.finish = start\n    }\n    m[r] = d\n}\n\nfunc Get(r Route) int {\n    if r.start &gt; r.finish {\n        r.start, r.finish = r.finish, r.start\n    }\n    m[r] = d\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1515508091, "post_id": 48169509, "comment_id": 83320024, "body": "This line <code>routeDistance := map[Route]int(rd)</code> is unneeded, you can index <code>rd</code> just like a normal map."}], "tags": [], "owner": {"reputation": 1283, "user_id": 9079863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9c7362282ac6c2b944cb216fa2ab4c?s=128&d=identicon&r=PG&f=1", "display_name": "Ilayaraja", "link": "https://stackoverflow.com/users/9079863/ilayaraja"}, "is_accepted": false, "score": 2, "last_activity_date": 1515505317, "creation_date": 1515505317, "answer_id": 48169509, "question_id": 48168670, "link": "https://stackoverflow.com/questions/48168670/construct-user-defined-map-in-go/48169509#48169509", "title": "Construct user defined map in Go", "body": "<p>Define <code>map[Route]int</code> as a user-defined type like <code>RouteDistance</code>.</p>\n\n<pre><code>type RouteDistance map[Route]int\n</code></pre>\n\n<p>And then define a <code>Find</code> function on that type, to check for bi-directional routes and return the distance.</p>\n\n<pre><code>func (rd RouteDistance) Find(r Route) (d int, ok bool) {\n    routeDistance := map[Route]int(rd)\n    d, ok = routeDistance[r]\n    if ok {\n        return\n    }\n    d, ok = routeDistance[Route{start: r.finish, finish: r.start}]\n    if ok {\n        return\n    }\n    return -1, false\n}\n</code></pre>\n\n<p>Initiate the <code>RouteDistance</code> with just one-directional route and distance.</p>\n\n<pre><code>rd := make(RouteDistance)\nrd[Route{start: \"A\", finish: \"B\"}] = 42\n</code></pre>\n\n<p>Get bi-directional distance for routes.</p>\n\n<pre><code>rd.Find(Route{start: \"A\", finish: \"B\"})\nrd.Find(Route{start: \"B\", finish: \"A\"})\n</code></pre>\n\n<p>The working code is in <a href=\"https://play.golang.org/p/sOqmxgxEhCh\" rel=\"nofollow noreferrer\">Playground</a></p>\n"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1515505317, "creation_date": 1515502495, "last_edit_date": 1515503380, "question_id": 48168670, "link": "https://stackoverflow.com/questions/48168670/construct-user-defined-map-in-go", "title": "Construct user defined map in Go", "body": "<p>I want to create map which stores routes from one point to another, distance between them will be used as values in the map. </p>\n\n<pre><code>type Route struct {\n    start  string\n    finish string\n}\n\nm := make(map[Route]int)\nv := Route{start: \"A\",\n            finish: \"B\"}\nm[v] = 42\n</code></pre>\n\n<p>Distance from A to B equals to distance from B to A.</p>\n\n<pre><code>w := Route{start: \"B\",\n        finish: \"A\"}\n</code></pre>\n\n<p>How can I get <code>m[w]</code> without pushing <code>m[w] = 42</code> into the map again because <code>v</code> and <code>w</code> are the same route. </p>\n\n<p>P.S In other words, is it possible to override rules when one <code>Route</code> equals to another <code>Route</code> when using <code>Route</code> as a key in map?</p>\n"}, {"tags": ["http", "post", "go", "soap"], "answers": [{"tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": false, "score": 1, "last_activity_date": 1515505057, "creation_date": 1515505057, "answer_id": 48169425, "question_id": 48167984, "link": "https://stackoverflow.com/questions/48167984/http-post-with-an-xml-body-and-file-as-attachment/48169425#48169425", "title": "HTTP POST with an XML body and file as attachment", "body": "<p>Either you should use a SOAP library that supports adding attachment or you should know SOAP standard to include an attachment. </p>\n\n<p>From <a href=\"https://www.w3.org/TR/SOAP-attachments\" rel=\"nofollow noreferrer\">https://www.w3.org/TR/SOAP-attachments</a></p>\n\n<blockquote>\n  <p>The following example shows a SOAP 1.1 message with an attached\n  facsimile image of the signed claim form (claim061400a.tiff):</p>\n\n<pre><code>MIME-Version: 1.0\nContent-Type: Multipart/Related; boundary=MIME_boundary; type=text/xml;\n        start=\"&lt;claim061400a.xml@claiming-it.com&gt;\"\nContent-Description: This is the optional message description.\n\n--MIME_boundary\nContent-Type: text/xml; charset=UTF-8\nContent-Transfer-Encoding: 8bit\nContent-ID: &lt;claim061400a.xml@claiming-it.com&gt;\n\n&lt;?xml version='1.0' ?&gt;\n&lt;SOAP-ENV:Envelope\nxmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n&lt;SOAP-ENV:Body&gt;\n..\n&lt;theSignedForm href=\"cid:claim061400a.tiff@claiming-it.com\"/&gt;\n..\n&lt;/SOAP-ENV:Body&gt;\n&lt;/SOAP-ENV:Envelope&gt;\n\n--MIME_boundary\nContent-Type: image/tiff\nContent-Transfer-Encoding: binary\nContent-ID: &lt;claim061400a.tiff@claiming-it.com&gt;\n\n...binary TIFF image...\n--MIME_boundary--\n</code></pre>\n</blockquote>\n\n<p>It's a multipart MIME type. You could use <a href=\"https://golang.org/pkg/mime/multipart/\" rel=\"nofollow noreferrer\">mime/multipart</a> package to generate a multipart with ease.</p>\n\n<p>Here is another snippet that creates a multipart form that includes an arbitrary file from file system (from <a href=\"https://matt.aimonetti.net/posts/2013/07/01/golang-multipart-file-upload-example/\" rel=\"nofollow noreferrer\">this blog</a>).</p>\n\n<pre><code>file, err := os.Open(path)\nif err != nil {\n    return nil, err\n}\ndefer file.Close()\n\nbody := &amp;bytes.Buffer{}\nwriter := multipart.NewWriter(body)\npart, err := writer.CreateFormFile(paramName, filepath.Base(path))\nif err != nil {\n    return nil, err\n}\n_, err = io.Copy(part, file)\n\nerr = writer.Close()\nif err != nil {\n    return nil, err\n}\n\nreq, err := http.NewRequest(\"POST\", uri, body)\nreq.Header.Set(\"Content-Type\", writer.FormDataContentType())\nreturn req, err\n</code></pre>\n"}], "owner": {"reputation": 947, "user_id": 3218674, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/E7ZAV.jpg?s=128&g=1", "display_name": "Gauranga", "link": "https://stackoverflow.com/users/3218674/gauranga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1278, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515505057, "creation_date": 1515499890, "last_edit_date": 1515501185, "question_id": 48167984, "link": "https://stackoverflow.com/questions/48167984/http-post-with-an-xml-body-and-file-as-attachment", "title": "HTTP POST with an XML body and file as attachment", "body": "<p>I have an issue. I am working on a client in Go which contacts a SOAP server. I am supposed to send an HTTP POST request to the server with SOAP message in the body. And I have to also attach one file with the request. How do I do that?</p>\n\n<p>Till now, I am able to just put SOAP message in the request, but not getting how to include the file as well in the request.  Below is a code to generate the request. How do I include the file in this request?</p>\n\n<pre><code>payload := strings.NewReader(soapDataString)\n\nreq, _ := http.NewRequest(\"POST\", endPointUrl, payload)\n\nreq.SetBasicAuth(\"user\", \"password\")\nreq.Header.Add(\"content-type\", \"text/xml\")\nreq.Header.Add(\"cache-control\", \"no-cache\")\nreq.Header.Add(\"SOAPAction\", \"\")\n\nreturn req\n</code></pre>\n"}, {"tags": ["json", "go", "interface"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1515497942, "post_id": 48167286, "comment_id": 83313779, "body": "If <code>case []interface{}:</code> then do <code>test := b.([]interface{})</code>, not <code>map...</code>. You know you can iterate over a slice just as well as over a map, so do not attempt to type assert a slice as a map just for iteration&#39;s sake."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1515498097, "post_id": 48167286, "comment_id": 83313877, "body": "Maybe what you want is <code>bb[0].(map[string]interface{})</code>, to use the elements of the slice instead of parsing the slice again."}], "answers": [{"tags": [], "owner": {"reputation": 8533, "user_id": 11792, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/057dba7b6fe7b933e5ee23f7dc64dcb5?s=128&d=identicon&r=PG", "display_name": "Pavel Nikolov", "link": "https://stackoverflow.com/users/11792/pavel-nikolov"}, "is_accepted": false, "score": 1, "last_activity_date": 1515502618, "creation_date": 1515502618, "answer_id": 48168701, "question_id": 48167286, "link": "https://stackoverflow.com/questions/48167286/golang-json-and-slices-of-interface/48168701#48168701", "title": "golang json and slices of interface", "body": "<p>Well, you can't cast <code>[]interface{}</code> to <code>map[string]interface{}</code>. Since it's a slice, you can iterate over its elements (note that <code>bb</code> is <code>b</code> already cast to the appropriate type and you don't need to cast <code>b</code> again):</p>\n\n<pre><code>    case []interface{}:\n        fmt.Println(\" is []interface \", bb)\n        for _, val := range bb {\n            // do something with val\n        }\n    default:\n    ...\n</code></pre>\n\n<p>Why do you have to deal with something that you don't know? Is it possible that you reconsider your architecture and work with known type(s)?\nhave you seen the <a href=\"https://godoc.org/encoding/json#example-RawMessage--Unmarshal\" rel=\"nofollow noreferrer\">example of delaying unmarshaling using <code>json.RawMessage</code></a>? Or maybe try <a href=\"https://godoc.org/encoding/json#Unmarshaler\" rel=\"nofollow noreferrer\">implementing the Unmarshaler interface</a>?</p>\n"}, {"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 0, "last_activity_date": 1515505073, "last_edit_date": 1515505073, "creation_date": 1515504738, "answer_id": 48169341, "question_id": 48167286, "link": "https://stackoverflow.com/questions/48167286/golang-json-and-slices-of-interface/48169341#48169341", "title": "golang json and slices of interface", "body": "<p>You can add a switch case which is checking the type of interface for slice of interfaces and then run the same function as recursive until whole json is parsed.</p>\n\n<pre><code>output := make(map[string]interface{})\nerr = json.Unmarshal(body, &amp;output)\n\nfmt.Println(err)\nidentify(output)\n\nreturn err\n}\n\nfunc identify(output map[string]interface{}) {\n    fmt.Printf(\"%T\", output)\n    for a, b := range output {\n        switch bb := b.(type) {\n        case string:\n            fmt.Println(\"This is a string\")\n        case float64:\n            fmt.Println(\"this is a float\")\n        case []interface{}:\n        // Access the values in the JSON object and place them in an Item\n        for _, itemValue := range jsonObj {\n            fmt.Printf(\"%v is an interface\\n\", itemValue)\n            identify(itemValue.(map[string]interface{}))\n        }\n        default:\n            return\n        }\n    }\n}\n</code></pre>\n\n<p>There can be deep nested json. We just needs to create options for each case until json is completely parsed. </p>\n"}], "owner": {"reputation": 189, "user_id": 8890987, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66c0709a0e9fc420d07e6f23a0d6a9b5?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8890987/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1133, "favorite_count": 0, "accepted_answer_id": 48169341, "answer_count": 2, "score": 1, "last_activity_date": 1605006529, "creation_date": 1515497584, "question_id": 48167286, "link": "https://stackoverflow.com/questions/48167286/golang-json-and-slices-of-interface", "title": "golang json and slices of interface", "body": "<p>I am having trouble iterating over slices of interfaces that contain slices of interfaces.</p>\n\n<p>This problem has arisen through attempting to work with an API call which returns JSON data. There is quite a lot of data returned and the structure differs quite dramatically depending on the request. There is also no structure for the JSON responses in the API documentation so I am trying to implement some methods for working with arbitrary JSON responses.</p>\n\n<p>Presently when the initial call is made it is dropped into a map[string]interface{} and then a switch statement is run to determine the type of each element, the problem occurs when a slice of interfaces is encountered. I can't seem to do anything with them.</p>\n\n<p>I have tried using the sort package a few times (specifically the sort and slicestable functions) to no avail.</p>\n\n<p>The error I am receiving is: </p>\n\n<pre><code>interface conversion: interface {} is []interface {}, not map[string]interface {}\n</code></pre>\n\n<p>Which occurs when I try and map the slice of interfaces so I can iterate over them with the switch statement again.</p>\n\n<pre><code>output := make(map[string]interface{})\nerr = json.Unmarshal(body, &amp;output)\n\nfmt.Println(err)\nidentify(output)\n\nreturn err\n}\n\nfunc identify(output map[string]interface{}) {\n    fmt.Printf(\"%T\", output)\n    for a, b := range output {\n        switch bb := b.(type) {\n        case string:\n            fmt.Println(\"This is a string\")\n        case float64:\n            fmt.Println(\"this is a float\")\n        case []interface{}:\n            fmt.Println(\" is []interface \", bb)\n            test := b.(map[string]interface{}) // falis here\n            fmt.Println(\"Success!\", test)\n        default:\n            return\n        }\n    }\n}\n</code></pre>\n\n<p>So the basic question is how do I iterate over nested slices of interfaces without knowing the structure beforehand?</p>\n"}, {"tags": ["go", "virtual-machine"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 2, "creation_date": 1515497227, "post_id": 48167104, "comment_id": 83313372, "body": "We can&#39;t tell what&#39;s going on from that. Please include a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 99, "user_id": 7961353, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2c0d31851dd72635ee741200a6ce5747?s=128&d=identicon&r=PG&f=1", "display_name": "Onkar Banerjee", "link": "https://stackoverflow.com/users/7961353/onkar-banerjee"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515596347, "post_id": 48167104, "comment_id": 83360400, "body": "@Marc Added some description now. I guess this should be reproducible now, thanks :)"}], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 7961353, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2c0d31851dd72635ee741200a6ce5747?s=128&d=identicon&r=PG&f=1", "display_name": "Onkar Banerjee", "link": "https://stackoverflow.com/users/7961353/onkar-banerjee"}, "is_accepted": false, "score": 0, "last_activity_date": 1515596943, "last_edit_date": 1515596943, "creation_date": 1515594872, "answer_id": 48189728, "question_id": 48167104, "link": "https://stackoverflow.com/questions/48167104/running-go-bindata-in-a-vm-causes-an-input-output-error/48189728#48189728", "title": "Running go-bindata in a VM causes an input/output error?", "body": "<p>This got resolved. Issue is when you have bad blocks on disk, you tend to get this input/output error. But this error can come for so many reasons. So it's hard to tell what's the exact cause of it, but in my case i tried doing a lot of trial and error stuff to get a hold of it and turns out the VM needed to be restarted by sending a shutdown signal and not powering off the machine. You get those options easily while closing an Oracle VirtualBox machine. Thanks :)</p>\n"}], "owner": {"reputation": 99, "user_id": 7961353, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2c0d31851dd72635ee741200a6ce5747?s=128&d=identicon&r=PG&f=1", "display_name": "Onkar Banerjee", "link": "https://stackoverflow.com/users/7961353/onkar-banerjee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1515596943, "creation_date": 1515497002, "last_edit_date": 1515596253, "question_id": 48167104, "link": "https://stackoverflow.com/questions/48167104/running-go-bindata-in-a-vm-causes-an-input-output-error", "title": "Running go-bindata in a VM causes an input/output error?", "body": "<p>I am running go-bindata in my VM. It seems to prompt an input/output error, without any further description.\nHowever when i run the same go-bindata on my host OS, there is absolutely no error. What am i missing here?</p>\n\n<p>Steps:</p>\n\n<pre><code>1) Use an oracle virtualbox VM . Enable networking and start the vm. Download the go-bindata and check if it is installed . You can do so by checking the help menu(go-bindata -h) or the version(go-bindata -version). I get a proper help menu and version 3.1.0 when i do that.\n\n2) Now power off the vm, disable the networking and start the vm again.\n3) run go-bindata now( or again you can just do go-bindata -h or go-bindata -version). I am getting an error here. \n\n-bash: /path/to/bin/go-bindata: Input/output error\n</code></pre>\n\n<p>There is no more description after that.\nI checked the /var/log/dmesg but i see no bad blocks issue there as well.</p>\n"}, {"tags": ["regex", "string", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1515491605, "post_id": 48165429, "comment_id": 83309977, "body": "Please show your current attempt, and describe the problems you&#39;re having with it."}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1515491654, "post_id": 48165429, "comment_id": 83310020, "body": "<code>^(\\d{6})[^#]*(#[A-F0-9]{6}).*$</code> ... then use the first and second capture groups."}, {"owner": {"reputation": 27168, "user_id": 7355741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CMNt.jpg?s=128&g=1", "display_name": "fmw42", "link": "https://stackoverflow.com/users/7355741/fmw42"}, "edited": false, "score": 0, "creation_date": 1515524700, "post_id": 48165429, "comment_id": 83329760, "body": "In Imagemagick piping the output to sed, you can do:    <code>convert image -format &quot;%c&quot; histogram:info: | while read line; do echo $line | sed -n &#39;s&#47;^\\(.*\\):.*\\(#.*\\) .*$&#47;\\1 \\2\\n&#47;p&#39;; done</code>     Since this was on hold, I could not give a proper answer with an example."}, {"owner": {"reputation": 27168, "user_id": 7355741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CMNt.jpg?s=128&g=1", "display_name": "fmw42", "link": "https://stackoverflow.com/users/7355741/fmw42"}, "edited": false, "score": 0, "creation_date": 1515525203, "post_id": 48165429, "comment_id": 83329976, "body": "The question seems straightforward to me. It has two parts. The first is how to extract the two fields from the list of data. I have answered that above. The second is putting the results into some structure. That I cannot answer as I do not know what kind of structure. Putting it into an array is easy. <code>array=$(convert image -format &quot;%c&quot; histogram:info: | while read line; do echo $line | sed -n &#39;s&#47;^\\(.*\\):.*\\(#.*\\) .*$&#47;\\1 \\2\\n&#47;p&#39;; done)</code>  But that may not be what the OP wants."}], "answers": [{"comments": [{"owner": {"reputation": 27168, "user_id": 7355741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CMNt.jpg?s=128&g=1", "display_name": "fmw42", "link": "https://stackoverflow.com/users/7355741/fmw42"}, "edited": false, "score": 0, "creation_date": 1515526272, "post_id": 48165767, "comment_id": 83330476, "body": "The problem here is that histogram counts are not limited to 6 characters. The number of counts depends upon the size of the image and how frequently that color is being used."}, {"owner": {"reputation": 9384, "user_id": 761132, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fa462ba2bc6318a8b2e7662bb8e91aa1?s=128&d=identicon&r=PG", "display_name": "Rizwan M.Tuman", "link": "https://stackoverflow.com/users/761132/rizwan-m-tuman"}, "reply_to_user": {"reputation": 27168, "user_id": 7355741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CMNt.jpg?s=128&g=1", "display_name": "fmw42", "link": "https://stackoverflow.com/users/7355741/fmw42"}, "edited": false, "score": 0, "creation_date": 1515559945, "post_id": 48165767, "comment_id": 83340924, "body": "Updated the answer a bit as per your comment, let me know if that works for you... if so, then you may accept the answer as well"}, {"owner": {"reputation": 27168, "user_id": 7355741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CMNt.jpg?s=128&g=1", "display_name": "fmw42", "link": "https://stackoverflow.com/users/7355741/fmw42"}, "edited": false, "score": 0, "creation_date": 1515561930, "post_id": 48165767, "comment_id": 83341498, "body": "That was my comment, but I am not the OP. But that does fix the issue that I mentioned with more elegant regex than my sed command."}], "tags": [], "owner": {"reputation": 9384, "user_id": 761132, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fa462ba2bc6318a8b2e7662bb8e91aa1?s=128&d=identicon&r=PG", "display_name": "Rizwan M.Tuman", "link": "https://stackoverflow.com/users/761132/rizwan-m-tuman"}, "is_accepted": true, "score": 1, "last_activity_date": 1515560055, "last_edit_date": 1515560055, "creation_date": 1515492520, "answer_id": 48165767, "question_id": 48165429, "link": "https://stackoverflow.com/questions/48165429/parse-output-and-fetch-hex-colors/48165767#48165767", "title": "Parse output and fetch hex colors", "body": "<p>You may try this:</p>\n\n<pre><code>^(\\d{6})[^#]+(#\\S+)\n\nWhere group 1 contains first 6 digit\nand group 2 contains the hash value\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/pWcp1l/1\" rel=\"nofollow noreferrer\">Regex101 Demo</a></p>\n\n<p>Update Based on OP's comment:</p>\n\n<pre><code>^(\\d+)[^#]+(#\\S+)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>^(\\d{6,100})[^#]+(#\\S+)\n</code></pre>\n\n<p>If the starter digit is not limited to 6 digit then replace <code>\\d{6}</code>  with <code>\\d+</code> ( which means one or more digit) or in case you know the range then you do : <code>\\d{min,max}</code>  e.g <code>\\d{6,100}</code></p>\n\n<p>Sample Source (<a href=\"https://ideone.com/zcmXf2\" rel=\"nofollow noreferrer\">run here</a> ):</p>\n\n<pre><code>func main() {\n    var re = regexp.MustCompile(`(?m)^(\\d{6})[^#]+(#\\S+)`)\n    var str = `416327: ( 61, 65, 39) #3D4127 srgb(61,65,39)\n212997: (130,127, 83) #827F53 srgb(130,127,83)\n428312: (167,161, 99) #A7A163 srgb(167,161,99)\n481351: (198,187,116) #C6BB74 srgb(198,187,116)\n381013: (214,200,148) #D6C894 srgb(214,200,148)\n\n`\nsegs2 := re.FindAllStringSubmatch(str, -1)\nfor i := 0; i &lt; len(segs2); i++ {\n    fmt.Println(segs2[i][1], \",\" ,segs2[i][2]);\n}\n</code></pre>\n"}], "owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1515499293, "accepted_answer_id": 48165767, "answer_count": 1, "score": -1, "last_activity_date": 1515560055, "creation_date": 1515491517, "last_edit_date": 1515524985, "question_id": 48165429, "link": "https://stackoverflow.com/questions/48165429/parse-output-and-fetch-hex-colors", "closed_reason": "Not suitable for this site", "title": "Parse output and fetch hex colors", "body": "<p>I have the output of an ImageMagick command to compute the top few entries of the image histogram, which is this:</p>\n\n<pre><code>416327: ( 61, 65, 39) #3D4127 srgb(61,65,39)\n212997: (130,127, 83) #827F53 srgb(130,127,83)\n428312: (167,161, 99) #A7A163 srgb(167,161,99)\n481351: (198,187,116) #C6BB74 srgb(198,187,116)\n381013: (214,200,148) #D6C894 srgb(214,200,148)\n</code></pre>\n\n<p>It represents the most dominant colors of an image and now I want to \"extract\" these colors and store them in a struct so I can make use of them in the rest of my Go code. Now I'm struggling about how to do this?</p>\n\n<p>First, I though about using <code>fmt.Sscanf</code>, but I only want to extract two fields, the first one and the #XXXXXX. Can you point me in the correct directtion?</p>\n\n<p>So for example, the first line should result in</p>\n\n<pre><code>416327 #3D4127\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1515490817, "post_id": 48164940, "comment_id": 83309533, "body": "Related, see this answer <a href=\"https://stackoverflow.com/questions/47179890/too-many-open-files-in-mgo-go-server/47180097#47180097\">how MongoDB session should be handled / used</a>."}, {"owner": {"reputation": 179, "user_id": 8787614, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/aefd1dcd4a21c583289dc468e7d1e516?s=128&d=identicon&r=PG&f=1", "display_name": "R.Roshan", "link": "https://stackoverflow.com/users/8787614/r-roshan"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1515491584, "post_id": 48164940, "comment_id": 83309962, "body": "OK thanks. understood. But the session created on init will be there even after close the main method. Thats my worry ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1515491629, "post_id": 48164940, "comment_id": 83309998, "body": "If you return from the <code>main</code> function, your whole app will terminate and not wait for other non-<code>main</code> goroutines to complete. See: <a href=\"https://stackoverflow.com/questions/28958192/whats-wrong-with-this-golang-code/28958240#28958240\">What&#39;s wrong with this golang code?</a>"}, {"owner": {"reputation": 179, "user_id": 8787614, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/aefd1dcd4a21c583289dc468e7d1e516?s=128&d=identicon&r=PG&f=1", "display_name": "R.Roshan", "link": "https://stackoverflow.com/users/8787614/r-roshan"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1515491742, "post_id": 48164940, "comment_id": 83310068, "body": "OK.. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 1, "last_activity_date": 1518955401, "last_edit_date": 1518955401, "creation_date": 1515509125, "answer_id": 48170671, "question_id": 48164940, "link": "https://stackoverflow.com/questions/48164940/golang-mongo-defer-sessions/48170671#48170671", "title": "golang mongo defer sessions", "body": "<p>you can create global variable for assigning the session object, return session object from a function. Use session object to fetch data and then defer the session after querying from mongo.</p>\n\n<pre><code>var (\n    mgoSession     *mgo.Session\n    databaseName = \"myDB\"\n)\n\nfunc getSession () *mgo.Session {\n    if mgoSession == nil {\n        var err error\n        mgoSession, err = mgo.Dial(\"localhost\")\n        if err != nil {\n             panic(err) // no, not really\n        }\n    }\n    return mgoSession.Clone()\n}\n\nfunc withCollection(collection string, s func(*mgo.Collection) error)   \n{    \n    session := getSession()\n    defer session.Close()\n    c := session.DB(databaseName).C(collection)\n    return s(c)\n}\n</code></pre>\n\n<p>I have cloned session object and returned it to function used to query mongo and defer the session there.\nBy above approach you can directly access session object inside handler.</p>\n"}], "owner": {"reputation": 179, "user_id": 8787614, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/aefd1dcd4a21c583289dc468e7d1e516?s=128&d=identicon&r=PG&f=1", "display_name": "R.Roshan", "link": "https://stackoverflow.com/users/8787614/r-roshan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1150, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1531404168, "creation_date": 1515489870, "last_edit_date": 1531404168, "question_id": 48164940, "link": "https://stackoverflow.com/questions/48164940/golang-mongo-defer-sessions", "title": "golang mongo defer sessions", "body": "<p>I am creating the mongodb connection from main method and defer that open connection.</p>\n\n<pre><code>func main(){\n    session := db.CreateConnection(connectionStr)\n    defer session.Close()\n}\n</code></pre>\n\n<p>The issue is I need to pass this sesstion object to user handler struct and from that pass to db handler.</p>\n\n<pre><code>type UserController struct {\n    DB DBOps\n}\n\ntype DBOps struct {\n    session *mgo.Session\n}\n</code></pre>\n\n<p>Question:\nHow can we directly create the session object and inside db handler file and defer that when application closes ?</p>\n\n<p>db.go</p>\n\n<pre><code>type DBOps struct {\n    session *mgo.Session\n}\n\nfunc (m *DBOps) Init(connectionstr string) error {\n    session, err := mgo.Dial(connectionstr)\n\n    // Check if connection error, is mongo running?\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>inside main function I can just call </p>\n\n<pre><code>func main(){\n    db.Init(connectionstr);\n}\n</code></pre>\n\n<p>but How to defer this session object on the main method ?</p>\n"}, {"tags": ["firebase", "google-app-engine", "go", "firebase-authentication", "jwt"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1515492404, "post_id": 48164890, "comment_id": 83310491, "body": "I&#39;m not sure what you mean by &quot;passing an app&quot; around. &quot;App&quot; usually refers to the compiled program, and any supporting files. That&#39;s not something that can be &quot;passed around&quot;."}, {"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1515492916, "post_id": 48164890, "comment_id": 83310784, "body": "Ok, fair enough; But my question remains, how would I refer to it in the handler, then? I&#39;m new to Go. Sorry if it&#39;s a stupid question."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1515493033, "post_id": 48164890, "comment_id": 83310860, "body": "The normal way to pass arguments to a handler is to have it return a closure to the actual handler."}, {"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1515493060, "post_id": 48164890, "comment_id": 83310878, "body": "The function, <code>verifyIDToken</code>, takes <code>app *firebase.App</code> as one of two inputs, the other being the idToken itself. What should I pass into this function from <code>SomeHandler</code> to verify the token(in <code>ReqToken</code>)?"}, {"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1515493298, "post_id": 48164890, "comment_id": 83311020, "body": "In the line where I call <code>verifyIDToken</code>, I need to pass the &quot;app&quot; somehow.. I&#39;m asking how I get this from the context to pass it?"}], "answers": [{"comments": [{"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 0, "creation_date": 1515493905, "post_id": 48166020, "comment_id": 83311372, "body": "In my case, how would you pass the return value from <code>initializeAppDefault()</code> using your own example here?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 0, "creation_date": 1515493955, "post_id": 48166020, "comment_id": 83311405, "body": "<code>x := initializeAppDefault(); &#47;* ... *&#47; myHandler(x)</code>"}, {"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 0, "creation_date": 1515494084, "post_id": 48166020, "comment_id": 83311498, "body": "Thank you. Learning a lot :)"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 1, "last_activity_date": 1515493356, "creation_date": 1515493356, "answer_id": 48166020, "question_id": 48164890, "link": "https://stackoverflow.com/questions/48164890/how-do-i-pass-the-app-around-function/48166020#48166020", "title": "How do I pass the app around function?", "body": "<p>The way to pass arbitrary dependencies into an HTTP handler function is by returning a closure:</p>\n\n<pre><code>func myHandler(a *Something, b *SomethingElse) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        // The body of the handler here, using a and b\n    }\n}\n</code></pre>\n\n<p>Then you'll use it as:</p>\n\n<pre><code>http.Handle(\"/some/path\", myHandler(a, b))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 0, "creation_date": 1515501468, "post_id": 48167147, "comment_id": 83315866, "body": "When I use your syntax for <code>SomeHandler</code>, I lost access to it in the main function even though lib is imported.. How come?"}, {"owner": {"reputation": 11, "user_id": 9192475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c619n.jpg?s=128&g=1", "display_name": "dimuls", "link": "https://stackoverflow.com/users/9192475/dimuls"}, "reply_to_user": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 0, "creation_date": 1515637298, "post_id": 48167147, "comment_id": 83379063, "body": "@cbll what you mean &quot;lost access&quot;? Can you show more your code?"}, {"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 0, "creation_date": 1515657732, "post_id": 48167147, "comment_id": 83385409, "body": "I had to move <code>SomeHandler</code> into the <code>main.go</code> where main is called. I can&#39;t use <code>lib.Somehandler</code> anymore, it doesn&#39;t recognize it from the lib package?"}], "tags": [], "owner": {"reputation": 11, "user_id": 9192475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c619n.jpg?s=128&g=1", "display_name": "dimuls", "link": "https://stackoverflow.com/users/9192475/dimuls"}, "is_accepted": false, "score": 1, "last_activity_date": 1515498348, "last_edit_date": 1515498348, "creation_date": 1515497154, "answer_id": 48167147, "question_id": 48164890, "link": "https://stackoverflow.com/questions/48164890/how-do-i-pass-the-app-around-function/48167147#48167147", "title": "How do I pass the app around function?", "body": "<p>Define new struct type with member of your <code>*firebase.App</code>:</p>\n\n<pre><code>type myapp struct {\n    fbapp *firebase.App\n    // here can be other common states and resources\n    // like sessions, db connections, etc...\n}\n</code></pre>\n\n<p>Define your handlers as methods of that type</p>\n\n<pre><code>func (ma *myapp) SomeHandler(w http.ResponseWriter, r *http.Request) {\n    // here you have access to all members of myapp, including ma.fbapp\n    // also you can use your lib.* funcs here\n}\n</code></pre>\n\n<p>And in your main you need to create <code>myapp</code> and pass it to <code>http.HandleFunc</code>.</p>\n\n<pre><code>func main () {\n    ma := &amp;myapp{\n        fbapp: initializeAppDefault()\n    }\n    go lib.GetData()\n    http.HandleFunc(\"/_ah/somepoint\", ma.SomeHandler)\n</code></pre>\n\n<p>This is a common pattern. Check out how i use it <a href=\"https://github.com/someanon/yamc/blob/8bfa52eabc7d3c9781045ae01199e1900d5a454a/server/server.go#L16\" rel=\"nofollow noreferrer\">in my interview task</a>: pay attention how handlers are defined, <a href=\"https://github.com/someanon/yamc/blob/8bfa52eabc7d3c9781045ae01199e1900d5a454a/server/server.go#L56\" rel=\"nofollow noreferrer\">how they getting access to the common s.store</a> and <a href=\"https://github.com/someanon/yamc/blob/8bfa52eabc7d3c9781045ae01199e1900d5a454a/main.go#L60\" rel=\"nofollow noreferrer\">how main function inits all common resources, creates router and runs it</a>.</p>\n"}], "owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 48166020, "answer_count": 2, "score": 0, "last_activity_date": 1515510264, "creation_date": 1515489650, "last_edit_date": 1515510264, "question_id": 48164890, "link": "https://stackoverflow.com/questions/48164890/how-do-i-pass-the-app-around-function", "title": "How do I pass the app around function?", "body": "<p>In <code>main</code>, the app is started as such:</p>\n\n<pre><code>// ...\n\nfunc main () {\n    initializeAppDefault()\n    go lib.GetData()\n    http.HandleFunc(\"/_ah/somepoint\", lib.SomeHandler)\n// .. \n\nfunc initializeAppDefault() *firebase.App {\n    // [START initialize_app_default]\n    app, err := firebase.NewApp(context.Background(), nil)\n    if err != nil {\n        log.Fatalf(\"error initializing app: %v\\n\", err)\n    }\n    // [END initialize_app_default]\n    return app\n}\n</code></pre>\n\n<p>In <code>SomeHandler</code>, I need the app which <code>initializeAppDefault</code> returns, to verify a JSON Web Token(JWT).</p>\n\n<pre><code>func SomeHandler(w http.ResponseWriter, r *http.Request) {\n    // Set content type:\n    w.Header().Set(\"Content-Type\", \"application/json\")\n\n    if r.Header != nil {\n        ReqToken := r.Header.Get(\"Authorization\")\n        splitToken := strings.Split(ReqToken, \"Bearer\")\n        ReqToken = splitToken[1]\n        fmt.Println(ReqToken)\n        // Verify JWT\n        // If it's invalid, return?\n\n        verifyIDToken(app, ReqToken)\n        // How do I pass the app in here?\n\nfunc verifyIDToken(app *firebase.App, idToken string) *auth.Token {\n// ... \n</code></pre>\n\n<p>My question is, when the app is initialized in the <code>main.go</code> file by invoking <code>initializeAppDefault()</code>, how do I pass it to the <code>SomeHandler</code> which handles requests at <code>/_ah/somepoint</code>?</p>\n"}, {"tags": ["go", "operators", "bitwise-operators"], "answers": [{"comments": [{"owner": {"reputation": 4897, "user_id": 4573839, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-wLBU0P4GoTk/AAAAAAAAAAI/AAAAAAAAAPM/8Xy7C9d-XoU/photo.jpg?sz=128", "display_name": "yu yang Jian", "link": "https://stackoverflow.com/users/4573839/yu-yang-jian"}, "edited": false, "score": 0, "creation_date": 1515487272, "post_id": 48164198, "comment_id": 83307597, "body": "thank you, I&#39;ll mark it as answer after ten minutes, sorry I&#39;m not graduate in CS  so these knowledge is not so  sufficient  (and I got hint by SO when asking this question will get downvote @@)"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 4897, "user_id": 4573839, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-wLBU0P4GoTk/AAAAAAAAAAI/AAAAAAAAAPM/8Xy7C9d-XoU/photo.jpg?sz=128", "display_name": "yu yang Jian", "link": "https://stackoverflow.com/users/4573839/yu-yang-jian"}, "edited": false, "score": 2, "creation_date": 1515487390, "post_id": 48164198, "comment_id": 83307655, "body": "@yuyangJian Most of us aren&#39;t graduates in CS."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1515573057, "last_edit_date": 1515573057, "creation_date": 1515487127, "answer_id": 48164198, "question_id": 48164174, "link": "https://stackoverflow.com/questions/48164174/golang-operator-working-detail/48164198#48164198", "title": "Golang operator &amp;^ working detail", "body": "<p>It's mentioned in <a href=\"https://golang.org/ref/spec#Arithmetic_operators\" rel=\"nofollow noreferrer\">Spec: Arithmetic operators:</a></p>\n\n<blockquote>\n<pre><code>&amp;^   bit clear (AND NOT)\n</code></pre>\n</blockquote>\n\n<p>So it computes the AND connection of the first operand and the negated value of the second operand.</p>\n\n<p>Its name \"bit clear\" comes from what it does. Examined using it on two 1-bit value: if the second operand is <code>1</code>, it means to \"clear\": the result will be <code>0</code> regardless of what the first operand is. If the second operand is <code>0</code>, it means not to clear, and the result will be the first operand.</p>\n\n<p>Its <a href=\"https://en.wikipedia.org/wiki/Karnaugh_map\" rel=\"nofollow noreferrer\">Karnaugh-map</a> is:</p>\n\n<pre><code>A | B | A &amp;^ B = A AND NOT(B)\n--+---+----------------------\n0 | 0 |   0\n0 | 1 |   0\n1 | 0 |   1\n1 | 1 |   0\n</code></pre>\n\n<p>When used on integer numbers, the operation is carried out <em>bit-wise</em>, that is the 0th bit of the result will be using <code>&amp;^</code> on the 0th bit of the first number and the second number; the 1st bit of the result will be using <code>&amp;^</code> on the 1st bit of the fist number and the second number etc...</p>\n\n<p>So basically the result of <code>A &amp;^ B</code> will be the number derived from <code>A</code> by clearing the bits (setting them to <code>0</code>) marked by the ones in <code>B</code> (in <code>B</code>'s binary representation).</p>\n"}, {"tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": false, "score": 0, "last_activity_date": 1515487156, "creation_date": 1515487156, "answer_id": 48164209, "question_id": 48164174, "link": "https://stackoverflow.com/questions/48164174/golang-operator-working-detail/48164209#48164209", "title": "Golang operator &amp;^ working detail", "body": "<p>It will not the second operand then and them. It's the same as offing the bits.</p>\n\n<pre><code>     5 = 0101\n&amp;^   11= 1011\n-------------\n     0101\n&amp;    0100\n-------------\n     0100\n</code></pre>\n"}], "owner": {"reputation": 4897, "user_id": 4573839, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-wLBU0P4GoTk/AAAAAAAAAAI/AAAAAAAAAPM/8Xy7C9d-XoU/photo.jpg?sz=128", "display_name": "yu yang Jian", "link": "https://stackoverflow.com/users/4573839/yu-yang-jian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 1, "accepted_answer_id": 48164198, "answer_count": 2, "score": -3, "last_activity_date": 1515573057, "creation_date": 1515486979, "last_edit_date": 1515491391, "question_id": 48164174, "link": "https://stackoverflow.com/questions/48164174/golang-operator-working-detail", "title": "Golang operator &amp;^ working detail", "body": "<p>I'm reading a Golang tutorial book at operator chapter, it says <code>5 &amp;^ 11 = 4</code>, but this operator seems not so common so I can't understand immediately,</p>\n\n<p>I try to guess its logic by list the binary form of the three number:</p>\n\n<pre><code>      5 = 0101\n &amp;^)  11= 1011\n -------------\n      4 = 0100\n</code></pre>\n\n<p>But I still can't understand it, can anyone explain how <code>&amp;^</code> works?  Thank you.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1515486540, "post_id": 48163774, "comment_id": 83307244, "body": "If your <code>Campaign</code> does not contain <code>EventBoost</code>s and <code>LocationBoost</code>s embedded (just their IDs), then their type should be a slice of <code>string</code> (type of <code>Campaign.EventBoostIDs</code> and <code>Campaign.LocationBoostIDs</code> should be <code>[]string</code>). Is this correct that you store them in different collections? Or you populate these in your DAO?"}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1515487597, "post_id": 48163774, "comment_id": 83307747, "body": "Sorry, I made a wrong copy/paste.. These are strings of course. Let me edit the original post."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1515489139, "post_id": 48163774, "comment_id": 83308550, "body": "Also what&#39;s the use of storing these in <code>Campaign</code>? Because if the boosts also store the <code>Campaign</code> ID, they can be queried by filtering for Campaign ID?"}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1515490047, "post_id": 48163774, "comment_id": 83309086, "body": "The CampaignID could be removed from the <code>EventBoost</code> and <code>LocationBoost</code>, or the IDs in the Campaign, that is correct, but I want to keep it as of now."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1515490118, "post_id": 48163774, "comment_id": 83309122, "body": "What kind of answer are you expecting? A MongoDB (console) query or how to do it in Go (using <code>mgo</code>)?"}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1515492133, "post_id": 48163774, "comment_id": 83310340, "body": "Thanks a lot for helping, I would like to know how to do it in Golang with <code>mgo</code> yes."}], "answers": [{"comments": [{"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1515588824, "post_id": 48172860, "comment_id": 83355465, "body": "Hello, as the answer shows it above, it is not correct. Anyway, regarding the relation you mention, it is allowed to perform some lookups in Mongo. I use something called a DTO in my software, so that the objects that go from the DAO to the API are looked-up in full objects. But for many reason, I prefer to store them as relations (in this case, I also use embeded objects)"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1515516190, "creation_date": 1515516190, "answer_id": 48172860, "question_id": 48163774, "link": "https://stackoverflow.com/questions/48163774/get-a-value-in-a-reference-of-a-lookup-with-mongodb-and-golang/48172860#48172860", "title": "Get a value in a reference of a lookup with MongoDB and Golang", "body": "<p>Since you're only storing IDs to reference documents in other collections, rather than de-normalizing the data entirely, no, you cannot do this purely in MongoDB. MongoDB is not a relational database. What you're describing is exactly what MongoDB was designed <em>not</em> to do.</p>\n\n<p>You'll need to perform the logic in Go; whether you do so in the DAO is up to you, but personally, I would lean toward a simple method on the type that does the logic on the fly based on the field values, e.g. <code>Campaign.GetEventLevel</code> or something along those lines. Having a method that fine-grained in your DAO implies to me some unusual design decisions that don't suit the MongoDB model very well. For the most part, with MongoDB, you want to retrieve you documents (objects) and work with them in your app. Trying to perform query logic in MongoDB as you would with a typical RDBMS is going to lead to frustration and poor performance.</p>\n"}, {"comments": [{"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1515588251, "post_id": 48174216, "comment_id": 83355131, "body": "I really thank you, that is a huge help ! I also learned a new concept : <code>$unwind</code>. And it is working so.. Thanks."}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1515588627, "post_id": 48174216, "comment_id": 83355340, "body": "If I could add a remark, you use <code>result[0].Level</code> in case there are multiple results, which is quite smart. But if I am sure that an Event cannot be boosted many times at the same time (prevent from doing it when saving), we could use <code>One()</code> instead ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1515588865, "post_id": 48174216, "comment_id": 83355500, "body": "@Elwyn I advise not to use <code>Pipe.One()</code> in this case, as <code>One()</code> expects a result. If there is no result, it returns an error (although you could just as easily compare to <code>mgo.ErrNotFound</code>). So I opted to use <code>All()</code> which does not return an error if there are no results. You may also add a <code>$limit</code> stage to only fetch a single result, and also use <code>$project</code> to only return the <code>level</code> and omit the rest of the data."}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1515590678, "post_id": 48174216, "comment_id": 83356588, "body": "Thanks for the advices, I will take a look at <code>$project</code> that I do not know yet."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 1, "creation_date": 1515591102, "post_id": 48174216, "comment_id": 83356852, "body": "@Elwyn Added the optimization to fetch at most 1 result, and exclude everything else except the level. See edited answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1515591076, "last_edit_date": 1515591076, "creation_date": 1515521054, "answer_id": 48174216, "question_id": 48163774, "link": "https://stackoverflow.com/questions/48163774/get-a-value-in-a-reference-of-a-lookup-with-mongodb-and-golang/48174216#48174216", "title": "Get a value in a reference of a lookup with MongoDB and Golang", "body": "<p>Doing <em>most</em> (and the hardest part) of what you want can easily be done in MongoDB. The final step when returning \"basic\", \"premium\" or \"standard\" most likely can also be done, but I think it's not worth the hassle as that is trivial in Go.</p>\n\n<p>In MongoDB use the <a href=\"https://docs.mongodb.com/manual/aggregation/\" rel=\"nofollow noreferrer\">Aggregation framework</a> for this. This is available in the <code>mgo</code> package via the <a href=\"https://godoc.org/gopkg.in/mgo.v2#Collection.Pipe\" rel=\"nofollow noreferrer\"><code>Collection.Pipe()</code></a> method. You have to pass a slice to it, each element corresponds to an aggregation stage. Read this answer for more details: <a href=\"https://stackoverflow.com/questions/47379455/how-to-get-an-aggregate-from-a-mongodb-collection/47388623#47388623\">How to Get an Aggregate from a MongoDB Collection</a></p>\n\n<p>Back to your example. Your <code>GetEventLevel()</code> method could be implemented like this:</p>\n\n<pre><code>func (dao *campaignDAO) GetEventLevel(eventID string) (string, error) {\n    c := sess.DB(\"\").C(\"eventboosts\") // sess represents a MongoDB Session\n    now := time.Now()\n    pipe := c.Pipe([]bson.M{\n        {\n            \"$match\": bson.M{\n                \"_event_id\":    eventID,            // Boost for the specific event\n                \"is_published\": true,               // Boost is active\n                \"start_date\":   bson.M{\"$lt\": now}, // now is between start and end\n                \"end_date\":     bson.M{\"$gt\": now}, // now is between start and end\n            },\n        },\n        {\n            \"$lookup\": bson.M{\n                \"from\":         \"campaigns\",\n                \"localField\":   \"_campaign_id\",\n                \"foreignField\": \"_id\",\n                \"as\":           \"campaign\",\n            },\n        },\n        {\"$unwind\": \"$campaign\"},\n        {\n            \"$match\": bson.M{\n                \"campaign.is_published\": true,      // Attached campaign is active\n            },\n        },\n    })\n\n    var result []*EventBoost\n    if err := pipe.All(&amp;result); err != nil {\n        return \"\", err\n    }\n    if len(result) == 0 {\n        return \"standard\", nil\n    }\n    return result[0].Level, nil\n}\n</code></pre>\n\n<p>If you only need at most one <code>EventBoost</code> (or there may not be more at the same time), use <code>$limit</code> stage to limit results to a single one, and use <code>$project</code> to only fetch the <code>level</code> field and nothing more.</p>\n\n<p>Use this pipeline for the above mentioned simplification / optimization:</p>\n\n<pre><code>pipe := c.Pipe([]bson.M{\n    {\n        \"$match\": bson.M{\n            \"_event_id\":    eventID,            // Boost for the specific event\n            \"is_published\": true,               // Boost is active\n            \"start_date\":   bson.M{\"$lt\": now}, // now is between start and end\n            \"end_date\":     bson.M{\"$gt\": now}, // now is between start and end\n        },\n    },\n    {\n        \"$lookup\": bson.M{\n            \"from\":         \"campaigns\",\n            \"localField\":   \"_campaign_id\",\n            \"foreignField\": \"_id\",\n            \"as\":           \"campaign\",\n        },\n    },\n    {\"$unwind\": \"$campaign\"},\n    {\n        \"$match\": bson.M{\n            \"campaign.is_published\": true,      // Attached campaign is active\n        },\n    },\n    {\"$limit\": 1},             // Fetch at most 1 result\n    {\n        \"$project\": bson.M{\n            \"_id\":   0,        // We don't even need the EventBoost's ID\n            \"level\": \"$level\", // We do need the level and nothing more\n        },\n    },\n})\n</code></pre>\n"}], "owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1977, "favorite_count": 1, "accepted_answer_id": 48174216, "answer_count": 2, "score": 3, "last_activity_date": 1515591076, "creation_date": 1515485211, "last_edit_date": 1515521648, "question_id": 48163774, "link": "https://stackoverflow.com/questions/48163774/get-a-value-in-a-reference-of-a-lookup-with-mongodb-and-golang", "title": "Get a value in a reference of a lookup with MongoDB and Golang", "body": "<p>I have the structures below. I use <strong>Golang 1.9.2</strong>.</p>\n\n<pre><code>// EventBoost describes the model of a EventBoost\ntype EventBoost struct {\n  ID          string    `bson:\"_id\" json:\"_id\" valid:\"alphanum,printableascii\"`\n  CampaignID  string    `bson:\"_campaign_id\" json:\"_campaign_id\" valid:\"alphanum,printableascii\"`\n  Name        string    `bson:\"name\" json:\"name\"`\n  Description string    `bson:\"description\" json:\"description\"`\n  Level       string    `bson:\"level\" json:\"level\"`\n  EventID     string    `bson:\"_event_id\" json:\"_event_id\" valid:\"alphanum,printableascii\"`\n  StartDate   time.Time `bson:\"start_date\" json:\"start_date\"`\n  EndDate     time.Time `bson:\"end_date\" json:\"end_date\"`\n  IsPublished bool      `bson:\"is_published\" json:\"is_published\"`\n  CreatedBy   string    `bson:\"created_by\" json:\"created_by\"`\n  CreatedAt   time.Time `bson:\"created_at\" json:\"created_at\"`\n  ModifiedAt  time.Time `bson:\"modified_at\" json:\"modified_at\"`\n}\n\n// LocationBoost describes the model of a LocationBoost\ntype LocationBoost struct {\n  ID          string    `bson:\"_id\" json:\"_id\" valid:\"alphanum,printableascii\"`\n  CampaignID  string    `bson:\"_campaign_id\" json:\"_campaign_id\" valid:\"alphanum,printableascii\"`\n  Name        string    `bson:\"name\" json:\"name\"`\n  Description string    `bson:\"description\" json:\"description\"`\n  Level       string    `bson:\"level\" json:\"level\"`\n  LocationID  string    `bson:\"_location_id\" json:\"_location_id\" valid:\"alphanum,printableascii\"`\n  StartDate   time.Time `bson:\"start_date\" json:\"start_date\"`\n  EndDate     time.Time `bson:\"end_date\" json:\"end_date\"`\n  IsPublished bool      `bson:\"is_published\" json:\"is_published\"`\n  CreatedBy   string    `bson:\"created_by\" json:\"created_by\"`\n  CreatedAt   time.Time `bson:\"created_at\" json:\"created_at\"`\n  ModifiedAt  time.Time `bson:\"modified_at\" json:\"modified_at\"`\n}\n\n// Campaign describes the model of a Campaign\ntype Campaign struct {\n    ID               string           `bson:\"_id\" json:\"_id\" valid:\"alphanum,printableascii\"`\n    Name             string           `bson:\"name\" json:\"name\"`\n    Description      string           `bson:\"description\" json:\"description\"`\n    EventBoostIDs    []string         `bson:\"event_boost_ids\" json:\"event_boost_ids\"`\n    LocationBoostIDs []string         `bson:\"location_boost_ids\" json:\"location_boost_ids\"`\n    StartDate        time.Time        `bson:\"start_date\" json:\"start_date\"`\n    EndDate          time.Time        `bson:\"end_date\" json:\"end_date\"`\n    IsPublished      bool             `bson:\"is_published\" json:\"is_published\"`\n    CreatedBy        string           `bson:\"created_by\" json:\"created_by\"`\n    CreatedAt        time.Time        `bson:\"created_at\" json:\"created_at\"`\n    ModifiedAt       time.Time        `bson:\"modified_at\" json:\"modified_at\"`\n}\n</code></pre>\n\n<p>A <strong>Campaign</strong> (understand a marketing campaign) is made of <strong>Events</strong> or <strong>Locations</strong> that can be boosted with a level (basic or premium). A campaign has a start and a end date, so do have the boosts.</p>\n\n<p>The function <code>GetEventLevel</code> has to return me the level of a given event.</p>\n\n<pre><code>// GetEventLevel of an event\nfunc (dao *campaignDAO) GetEventLevel(eventID string) (string, error) {\n}\n</code></pre>\n\n<p>If the event is boosted in <em>an active campaign</em> (<code>isPublished</code> is <code>true</code>), and <em>the boost is active</em> (<code>isPublished</code> is <code>true</code>) and <em>the now date is between the start and end date of the boost</em>, then my Event is <strong>boosted</strong>, so the function returns the level (basic or premium). Else, it returns <code>\"standard\"</code>.</p>\n\n<p>My question is : <strong>can I do this fully with Mongo ? Or do I need to perform some logic in the DAO with Golang ?</strong></p>\n\n<p>If I can do this with Mongo, what I hope, I have no idea how to do this. From what I understand, I would first need to lookup the events and the locations of the campaign, and then search in it with dates, but..</p>\n"}, {"tags": ["firebase", "google-app-engine", "go", "firebase-authentication", "jwt"], "answers": [{"tags": [], "owner": {"reputation": 5314, "user_id": 5190886, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YLo4CPWOOeA/AAAAAAAAAAI/AAAAAAAAAAA/NEX8mDWN_F0/photo.jpg?sz=128", "display_name": "Hiranya Jayathilaka", "link": "https://stackoverflow.com/users/5190886/hiranya-jayathilaka"}, "is_accepted": false, "score": 0, "last_activity_date": 1518821114, "creation_date": 1518821114, "answer_id": 48835910, "question_id": 48163752, "link": "https://stackoverflow.com/questions/48163752/how-to-verify-jwt/48835910#48835910", "title": "How to verify JWT?", "body": "<p>You're already initializing a <code>firebase.App</code> in your <code>InitializeAppWithServiceAccount()</code> function. You just need to pass the return value into your handler.</p>\n\n<pre><code>conf := firebase.Config{\n    ProjectID: \"my-project-id\",\n}\napp, err := firebase.NewApp(context.Background(), &amp;conf)\nif err != nil {\n    log.Fatalln(err)\n}\nhandler := func(w http.ResponseWriter, r *http.Request) {\n    client, err := app.Auth(context.Background())\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    }\n\n    token := getTokenFromReq(r)\n    t, err := client.VerifyIDToken(token)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    }\n    w.Write([]byte(\"token verified\"))\n}\n</code></pre>\n\n<p>In this example I'm not using a service account (which is probably what you want as well). And since this is on GAE, make sure to pass the GAE context instead of the background context. </p>\n"}], "owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518821114, "creation_date": 1515485112, "last_edit_date": 1515510489, "question_id": 48163752, "link": "https://stackoverflow.com/questions/48163752/how-to-verify-jwt", "title": "How to verify JWT?", "body": "<p>I'm unsure of the examples in Google's documentation. How do I verify a JWT produced by Firebase, in a Google App engine flexible service?</p>\n\n<p><code>main.go</code>:</p>\n\n<pre><code>// ...\n\nfunc main () {\n    InitializeAppWithServiceAccount()\n    go lib.GetStockData()\n    http.HandleFunc(\"/_ah/someendPoint\", SomeHandler)\n}\n\nfunc InitializeAppWithServiceAccount() *firebase.App {\n    // [START initialize_app_service_account]\n    opt := option.WithCredentialsFile(\"keystore/someapp-firebase-adminsdk-1ts1k-1fbbbad63f.json\")\n    app, err := firebase.NewApp(context.Background(), nil, opt)\n    if err != nil {\n        log.Fatalf(\"error initializing app: %v\\n\", err)\n    }\n    return app\n}\n\n\nfunc someHandler(w http.ResponseWriter, r *http.Request) {\n    // Set content type:\n    w.Header().Set(\"Content-Type\", \"application/json\")\n\n    if r.Header != nil {\n        ReqToken := r.Header.Get(\"Authorization\")\n        splitToken := strings.Split(ReqToken, \"Bearer\")\n        ReqToken = splitToken[1]\n        fmt.Println(ReqToken) // Correctly prints the JWT\n        // Verify JWT\n        // If it's invalid, return?\n        // verifyIDToken(??, reqToken)\n\n        enc := json.NewEncoder(w)\n        err := enc.Encode(somedata)\n        fmt.Println(\"request made\")\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n    }\n    http.Error(w, \"Unauthorized\", http.StatusUnauthorized)\n}\n</code></pre>\n\n<p>According to their documentation, you can use the following function to verify an ID token? But what do I pass in as app? The documentation doesn't really say.</p>\n\n<pre><code>func verifyIDToken(app *firebase.App, idToken string) *auth.Token {\n    // [START verify_id_token]\n    client, err := app.Auth(context.Background())\n    if err != nil {\n        log.Fatalf(\"error getting Auth client: %v\\n\", err)\n    }\n\n    token, err := client.VerifyIDToken(idToken)\n    if err != nil {\n        log.Fatalf(\"error verifying ID token: %v\\n\", err)\n    }\n\n    log.Printf(\"Verified ID token: %v\\n\", token)\n    // [END verify_id_token]\n\n    return token\n}\n</code></pre>\n\n<p>Obviously, <code>idToken</code> is my token from the handler. But what is <code>app *firebase.App</code> and how would I pass it in to the function from the handler itself?</p>\n"}, {"tags": ["database", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1515485734, "post_id": 48163743, "comment_id": 83306871, "body": "Try using appengine&#39;s context, <code>appengine.NewContext(r)</code> instead of <code>context.Background()</code>."}, {"owner": {"reputation": 97, "user_id": 8523579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2a4ccd39501863fef94ac3b1adf50b1?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal Bisht", "link": "https://stackoverflow.com/users/8523579/vishal-bisht"}, "reply_to_user": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1515488270, "post_id": 48163743, "comment_id": 83308106, "body": "@abhink I am using it inside <code>Init function</code>so i dont have a request context available at that moment."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1515488853, "post_id": 48163743, "comment_id": 83308395, "body": "@VishalBisht the error you&#39;re getting doesn&#39;t seem like it has anything to do with db client reuse but more like you don&#39;t have enough permissions to use whatever service is returning that error, which is also something you don&#39;t state... So what is returning the error?"}, {"owner": {"reputation": 97, "user_id": 8523579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2a4ccd39501863fef94ac3b1adf50b1?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal Bisht", "link": "https://stackoverflow.com/users/8523579/vishal-bisht"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1515489489, "post_id": 48163743, "comment_id": 83308783, "body": "@mkopriva if i am returning <code>func GetDB() *datastore.Client {     return db }</code>  then it is giving PermissionDenied desc = Missing or insufficient permissions. But if i return <code>func GetDB() *datastore.Client { \treturn CreateDataStoreClient() \t&#47;&#47;return db } </code> then it is working fine"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1515490324, "post_id": 48163743, "comment_id": 83309257, "body": "@VishalBisht but what is giving you the error? <code>GetDB</code> does not have an error return argument so it cannot return an error."}, {"owner": {"reputation": 97, "user_id": 8523579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2a4ccd39501863fef94ac3b1adf50b1?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal Bisht", "link": "https://stackoverflow.com/users/8523579/vishal-bisht"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1515490573, "post_id": 48163743, "comment_id": 83309381, "body": "@mkopriva i am getting error when i use db variable to save data to datastore"}, {"owner": {"reputation": 5560, "user_id": 5183999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kAidT.jpg?s=128&g=1", "display_name": "nshmura", "link": "https://stackoverflow.com/users/5183999/nshmura"}, "edited": false, "score": 0, "creation_date": 1516171273, "post_id": 48163743, "comment_id": 83574634, "body": "Is <code>os.Getenv(&quot;SERVICE_ACCOUNT_PATH&quot;)</code> the same value in both cases?"}], "owner": {"reputation": 97, "user_id": 8523579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2a4ccd39501863fef94ac3b1adf50b1?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal Bisht", "link": "https://stackoverflow.com/users/8523579/vishal-bisht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 399, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1515490794, "creation_date": 1515485069, "last_edit_date": 1515490794, "question_id": 48163743, "link": "https://stackoverflow.com/questions/48163743/go-datastore-connection-reuse", "title": "GO Datastore connection reuse", "body": "<p>I am new to GO and i need to reuse the datastore client in the entire application instead of creating it again and again for each API call. I have created a db package and in it Init i am storing client in  a global db variable to reuse it via a GetDB() function. But i am getting the below error</p>\n\n<blockquote>\n  <p>PermissionDenied desc = Missing or insufficient permissions.</p>\n</blockquote>\n\n<p>Below is my db package code</p>\n\n<pre><code>package db\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n\n    \"cloud.google.com/go/datastore\"\n    \"google.golang.org/api/option\"\n)\n\nvar db *datastore.Client\n\nfunc init() {\n    fmt.Println(\"INIT IN DB PACKAGE CALLED\")\n    db = CreateDataStoreClient()\n}\n\n//CreateDataStoreClient client object\nfunc CreateDataStoreClient() *datastore.Client {\n    serviceAccountFilePath := os.Getenv(\"SERVICE_ACCOUNT_PATH\")\n    gcpProjectID := os.Getenv(\"PROJECT_ID\")\n    // Create a datastore client.\n    client, err := datastore.NewClient(context.Background(), gcpProjectID, option.WithServiceAccountFile(serviceAccountFilePath))\n    if err != nil {\n        log.Fatal(\"ERROR IN CONNECTING TO DATASTORE\")\n    }\n    return client\n}\n\n//GetDB ...\nfunc GetDB() *datastore.Client {\n    return db\n}\n</code></pre>\n\n<p>I am trying to use the db variable in the below controller <code>enter code here</code></p>\n\n<pre><code>func (ctrl CloudController) GenerateAPIKey(c *gin.Context) {\n    // get the data store client\n    dsClient := db.GetDB()\n    // Request\n    //ctx := appengine.NewContext(c.Request)\n    ctx := context.Background()\n    music := &amp;Music{\n        apiKey: generateAPIKey(40),\n    }\n    key := datastore.IncompleteKey(\"Account\", nil)\n    if _, err := dsClient.Put(ctx, key, music); err != nil {\n        fmt.Println(err)\n        c.JSON(200, gin.H{\"message\": \"error in generating api key\"})\n    }\n    c.JSON(200, gin.H{\"apiKey\": music.apiKey})\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 3, "creation_date": 1515476267, "post_id": 48161858, "comment_id": 83303363, "body": "Because for the lib <code>datastore</code>, your package is not &quot;the same package&quot;."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1515476278, "post_id": 48161858, "comment_id": 83303367, "body": "The <code>datastore</code> package is doing the storage, it is a separate package from the <code>test</code> package and therefore it has no access to lowercase fields defined on types inside that package."}, {"owner": {"reputation": 358, "user_id": 7296857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda7320a4b822f1f388b5996f6f4f00c?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/7296857/user"}, "edited": false, "score": 0, "creation_date": 1515478884, "post_id": 48161858, "comment_id": 83304135, "body": "Thanks, I falsely thought the same package meant calling the type from the same package as the type."}], "owner": {"reputation": 358, "user_id": 7296857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda7320a4b822f1f388b5996f6f4f00c?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/7296857/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515475327, "creation_date": 1515475327, "question_id": 48161858, "link": "https://stackoverflow.com/questions/48161858/why-doesnt-datastore-store-lower-case-struct-properties-even-though-the-struct", "title": "Why doesn&#39;t Datastore store lower-case struct properties even though the struct is in the same package?", "body": "<pre><code>package test\n\nimport (\n    \"net/http\"\n    \"google.golang.org/appengine\" \n    \"google.golang.org/appengine/datastore\" \n\n)\n\nfunc init() {\n    http.HandleFunc(\"/\", handler) \n}\n\n\ntype myStruct struct {\n    test string\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    var ctx = appengine.NewContext(r)   \n\n    datastore.Put(ctx, datastore.NewKey(ctx, \"myStruct\", \"mykey\", 0, nil), &amp;myStruct{ test: \"foo\" } )\n\n}\n</code></pre>\n\n<p>The above code will store the entity and its key name in the Datastore, but it does not store the property value \"foo\" unless I capitalize the property name to \"Test\". I thought upper case is not necessary when a variable is in the same package? I'm using the local development server.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 305, "user_id": 8406346, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3805482de243084ae3898bd42f413496?s=128&d=identicon&r=PG&f=1", "display_name": "JohnStephen.19", "link": "https://stackoverflow.com/users/8406346/johnstephen-19"}, "edited": false, "score": 0, "creation_date": 1515477212, "post_id": 48161934, "comment_id": 83303641, "body": "another problem occur, I don&#39;t know if I should put this in another thread. <code>2018&#47;01&#47;09 13:50:42 pq: remaining connection slots are reserved for non-replication superuser connections</code>"}], "tags": [], "owner": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "is_accepted": true, "score": 1, "last_activity_date": 1515477721, "last_edit_date": 1515477721, "creation_date": 1515475814, "answer_id": 48161934, "question_id": 48161844, "link": "https://stackoverflow.com/questions/48161844/how-to-repeatedly-call-a-function-for-each-iteration-in-a-loop-get-its-results/48161934#48161934", "title": "How to repeatedly call a function for each iteration in a loop, get its results then append the results into a slice (Golang?", "body": "<p>Just do the loop twice, e.g.</p>\n\n<pre><code>for _, symbol := range distinctSymbols {\n        go worker(symbol, stmt1, stmt2, c)\n}\nfor range distinctSymbols {\n        symbolsSlice = append(symbolsSlice, &lt;-c)\n}\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 8406346, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3805482de243084ae3898bd42f413496?s=128&d=identicon&r=PG&f=1", "display_name": "JohnStephen.19", "link": "https://stackoverflow.com/users/8406346/johnstephen-19"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 48161934, "answer_count": 1, "score": 1, "last_activity_date": 1515477721, "creation_date": 1515475215, "question_id": 48161844, "link": "https://stackoverflow.com/questions/48161844/how-to-repeatedly-call-a-function-for-each-iteration-in-a-loop-get-its-results", "title": "How to repeatedly call a function for each iteration in a loop, get its results then append the results into a slice (Golang?", "body": "<p>I have the ff:</p>\n\n<pre><code>func getSlice(distinctSymbols []string) []symbols {\n    // Prepare connection\n    stmt1, err := db.Prepare(\"Select count(*) from stockticker_daily where symbol = $1;\")\n    checkError(err)\n    defer stmt1.Close()\n    stmt2, err := db.Prepare(\"Select date from stockticker_daily where symbol = $1 order by date asc limit 1;\")\n    checkError(err)\n    defer stmt2.Close()\n    var symbolsSlice []symbols\n    c := make(chan symbols)\n    for _, symbol := range distinctSymbols {\n        go worker(symbol, stmt1, stmt2, c)\n        **symbolsFromChannel := &lt;-c**\n        **symbolsSlice = append(symbolsSlice, symbolsFromChannel})**\n    }\n    return symbolsSlice\n}\n\nfunc worker(symbol string, stmt1 *sql.Stmt, stmt2 *sql.Stmt, symbolsChan chan symbols) {\n    var countdp int\n    var earliestdate string\n    row := stmt1.QueryRow(symbol)\n    if err := row.Scan(&amp;countdp); err != nil {\n        log.Fatal(err)\n    }\n    row = stmt2.QueryRow(symbol)\n    if err := row.Scan(&amp;earliestdate); err != nil {\n        log.Fatal(err)\n    }\n    symbolsChan &lt;- symbols{symbol, countdp, earliestdate}\n}\n</code></pre>\n\n<p>Please take a look at the first function, I know it won't work as I expect since the line <code>symbolsFromChannel := &lt;-c</code> will block until it receives from the channel, so the iteration on the goroutine <code>go worker</code> will not continue unless the block is removed. What is the best or correct way to do that?</p>\n"}, {"tags": ["go", "logging"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1515469145, "post_id": 48161011, "comment_id": 83301691, "body": "I think it is a very detail thing of a third-party library code. Maybe you should ask the author of that library instead."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 5818900, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JPDOCjS8uB8/AAAAAAAAAAI/AAAAAAAAABk/zndUb5jJqX8/photo.jpg?sz=128", "display_name": "Sky_Sun", "link": "https://stackoverflow.com/users/5818900/sky-sun"}, "edited": false, "score": 0, "creation_date": 1515476208, "post_id": 48161118, "comment_id": 83303342, "body": "Yeah...  I made a stupid mistake...  I didn&#39;t see that return errors.New()...  F**k  Thank you, anyway.."}], "tags": [], "owner": {"reputation": 120, "user_id": 4699276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/962656f439a1d7a9c8854ced59253285?s=128&d=identicon&r=PG", "display_name": "user4699276", "link": "https://stackoverflow.com/users/4699276/user4699276"}, "is_accepted": true, "score": 2, "last_activity_date": 1515469298, "creation_date": 1515469298, "answer_id": 48161118, "question_id": 48161011, "link": "https://stackoverflow.com/questions/48161011/why-these-method-with-same-function-written-differently/48161118#48161118", "title": "Why these method with same function written differently?", "body": "<p>The most likely explanation is that due to the fact that <code>Logger.Warn</code> method returns an <code>error</code> value, it was refactored to at first save the value it needs to log into variable <code>msg</code> and then log it separately as well as return it as the error.\n<code>Logger.Info</code>, at the same time, logs the message as soon as it is possible because it is not required to return the message.\nThis seems to be the only difference in the way these functions work.</p>\n"}], "owner": {"reputation": 49, "user_id": 5818900, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JPDOCjS8uB8/AAAAAAAAAAI/AAAAAAAAABk/zndUb5jJqX8/photo.jpg?sz=128", "display_name": "Sky_Sun", "link": "https://stackoverflow.com/users/5818900/sky-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 48161118, "answer_count": 1, "score": -2, "last_activity_date": 1515486493, "creation_date": 1515468375, "last_edit_date": 1515486493, "question_id": 48161011, "link": "https://stackoverflow.com/questions/48161011/why-these-method-with-same-function-written-differently", "title": "Why these method with same function written differently?", "body": "<pre><code>func (log Logger) Warn(arg0 interface{}, args ...interface{}) error {\nconst (\n    lvl = WARNING\n)\nvar msg string\nswitch first := arg0.(type) {\ncase string:\n    // Use the string as a format string\n    msg = fmt.Sprintf(first, args...)\ncase func() string:\n    // Log the closure (no other arguments used)\n    msg = first()\ndefault:\n    // Build a format string so that it will be similar to Sprint\n    msg = fmt.Sprintf(fmt.Sprint(first)+strings.Repeat(\" %v\", len(args)), args...)\n}\nlog.intLogf(lvl, msg)\nreturn errors.New(msg)\n}\n\nfunc (log Logger) Info(arg0 interface{}, args ...interface{}) {\nconst (\n    lvl = INFO\n)\nswitch first := arg0.(type) {\ncase string:\n    // Use the string as a format string\n    log.intLogf(lvl, first, args...)\ncase func() string:\n    // Log the closure (no other arguments used)\n    log.intLogc(lvl, first)\ndefault:\n    // Build a format string so that it will be similar to Sprint\n    log.intLogf(lvl, fmt.Sprint(arg0)+strings.Repeat(\" %v\", len(args)), args...)\n}\n</code></pre>\n\n<p>}</p>\n\n<p>These two functions are from log4go library's source code,I don't know why Warn(in fact all level higher than Warn) is different from Info, Why does Warn function Sprintf the msg first while Info passes all args to the iniLogf function to handle the logging? Is it because the closure may be leave out if the process aborted at that timing?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1515480140, "post_id": 48160212, "comment_id": 83304525, "body": "Yes. -buildmode=shared. Google for plugins. Not simple."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8759138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b19193fd74b6c252d2416b95beb12d84?s=128&d=identicon&r=PG&f=1", "display_name": "Sudeep Dasgupta", "link": "https://stackoverflow.com/users/8759138/sudeep-dasgupta"}, "edited": false, "score": 0, "creation_date": 1515654723, "post_id": 48172446, "comment_id": 83384020, "body": "That means it is not possible in golang, for the timings. as all other languages supports this to invoke other methods of different class in runtime using string name. whether it is java, node, php, c# or other languages ."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 21, "user_id": 8759138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b19193fd74b6c252d2416b95beb12d84?s=128&d=identicon&r=PG&f=1", "display_name": "Sudeep Dasgupta", "link": "https://stackoverflow.com/users/8759138/sudeep-dasgupta"}, "edited": false, "score": 0, "creation_date": 1515673456, "post_id": 48172446, "comment_id": 83394876, "body": "All of the languages you listed are JIT languages that run in VMs. That&#39;s a very different prospect from Go, which generates a native binary with a minimal embedded runtime, which means it doesn&#39;t <i>need</i> a dynamic loader for its normal operation."}, {"owner": {"reputation": 21, "user_id": 8759138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b19193fd74b6c252d2416b95beb12d84?s=128&d=identicon&r=PG&f=1", "display_name": "Sudeep Dasgupta", "link": "https://stackoverflow.com/users/8759138/sudeep-dasgupta"}, "edited": false, "score": 0, "creation_date": 1515700714, "post_id": 48172446, "comment_id": 83411597, "body": "Thanks, but my purpose was to route the request to a controller page in runtime dynamically which is not possible till now in Go, I guess thanks anyway"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 21, "user_id": 8759138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b19193fd74b6c252d2416b95beb12d84?s=128&d=identicon&r=PG&f=1", "display_name": "Sudeep Dasgupta", "link": "https://stackoverflow.com/users/8759138/sudeep-dasgupta"}, "edited": false, "score": 0, "creation_date": 1515702475, "post_id": 48172446, "comment_id": 83412443, "body": "There&#39;s no reason you couldn&#39;t do dynamic routing at runtime; that&#39;s how the built-in router works as it is. That has nothing to do with dynamic class loading, though. Everything that might be used in a Go binary should be compiled into the Go binary."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1515514711, "creation_date": 1515514711, "answer_id": 48172446, "question_id": 48160212, "link": "https://stackoverflow.com/questions/48160212/dynamic-package-loading-like-java-in-golang/48172446#48172446", "title": "Dynamic package loading like java in golang", "body": "<p>What you're describing isn't dynamic package loading, it's just reflection. As long as the package is included in the binary and the types are exported, you can reference it the same way you can reference types in the same package.</p>\n\n<p>Dynamic package loading is a different matter entirely; there's the new plugin support, which is still in its early stages, and not yet supported on all platforms. That's the closest you'll get.</p>\n\n<p>Bear in mind that <em>Go is not Java</em>. Don't try to write Java in Go. It won't work. The platform, language, and standard library are very, very, <em>very</em> different between the two. Java can do dynamic class loading <em>because it has a class loader</em>. All types are dynamically loaded in Java. In Go, <em>nothing</em> is dynamically loaded; the Go compiler produces a native binary, there's nothing dynamic about it.</p>\n\n<p>If you're trying to replicate something you're used to in Java, you're probably best served by rethinking your design entirely in a way that's more suitable to the technology you've chosen (Go), or to choose a technology more suited to the problem you're trying to solve.</p>\n"}], "owner": {"reputation": 21, "user_id": 8759138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b19193fd74b6c252d2416b95beb12d84?s=128&d=identicon&r=PG&f=1", "display_name": "Sudeep Dasgupta", "link": "https://stackoverflow.com/users/8759138/sudeep-dasgupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 846, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1515514711, "creation_date": 1515460414, "question_id": 48160212, "link": "https://stackoverflow.com/questions/48160212/dynamic-package-loading-like-java-in-golang", "title": "Dynamic package loading like java in golang", "body": "<p>How Will I import package dynamically and invoke its method in golang like java reflection package, there are solutions of how to invoke method in the same file using golang reflection but what about invoking from different package</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1515456327, "post_id": 48159759, "comment_id": 83299074, "body": "Fix: If you intended to use <code>j</code> in the program, then fix the program.  Otherwise, delete <code>j</code>."}, {"owner": {"reputation": 2437, "user_id": 1914002, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ae822f979980ea450842c7cc36baeb94?s=128&d=identicon&r=PG", "display_name": "dapangmao", "link": "https://stackoverflow.com/users/1914002/dapangmao"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1515456525, "post_id": 48159759, "comment_id": 83299125, "body": "Thanks - Cerise! My mistake. It solved."}], "answers": [{"tags": [], "owner": {"reputation": 966, "user_id": 2166750, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7a98a414302c4331caa45d56a522202?s=128&d=identicon&r=PG", "display_name": "Bert Verhees", "link": "https://stackoverflow.com/users/2166750/bert-verhees"}, "is_accepted": true, "score": 1, "last_activity_date": 1515456449, "creation_date": 1515456449, "answer_id": 48159789, "question_id": 48159759, "link": "https://stackoverflow.com/questions/48159759/variable-declared-and-not-used-in-a-loop/48159789#48159789", "title": "Variable declared and not used in a loop", "body": "<p>You assign a value to j, but you don't use j. That is the problem. You could as well leave j out, without changing the functionality of the code.</p>\n"}], "owner": {"reputation": 2437, "user_id": 1914002, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ae822f979980ea450842c7cc36baeb94?s=128&d=identicon&r=PG", "display_name": "dapangmao", "link": "https://stackoverflow.com/users/1914002/dapangmao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 48159789, "answer_count": 1, "score": 0, "last_activity_date": 1515456449, "creation_date": 1515456210, "question_id": 48159759, "link": "https://stackoverflow.com/questions/48159759/variable-declared-and-not-used-in-a-loop", "title": "Variable declared and not used in a loop", "body": "<p>Got confusion with a function</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc dominantIndex(nums []int) int {\n    var max, max2 = -12423421, -12423421\n    var i, j = -1, -1\n    for k, num := range nums {\n        if num &gt; max {\n            max, max2 = num, max\n            i, j = k, i\n        } else if num &gt; max2 {\n            max2 = num\n            j = k\n        }\n    }\n    if max &gt;= max2*2 {\n        return i\n    }\n    return -1\n}\n\n\nfunc main() {\n    var a = []int{3, 6, 100, 1, 0 }\n    fmt.Print(dominantIndex(a))\n}\n</code></pre>\n\n<p>I have to insert a nonsense statement in the loop such as <code>j = j</code>. Otherwise, it raises <code>./hello.go:7:6: j declared and not used</code>. Wonder if there is any fix.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2166, "user_id": 110226, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e6cc459abcb5403402771b4b814ffc39?s=128&d=identicon&r=PG", "display_name": "Trent", "link": "https://stackoverflow.com/users/110226/trent"}, "edited": false, "score": 0, "creation_date": 1568015538, "post_id": 48158953, "comment_id": 102126373, "body": "How is this question a duplicate? The linked question discussed constant arrays, this one is asking for a constant date."}], "answers": [{"tags": [], "owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "is_accepted": true, "score": 1, "last_activity_date": 1515459682, "creation_date": 1515459682, "answer_id": 48160134, "question_id": 48158953, "link": "https://stackoverflow.com/questions/48158953/how-to-declare-a-constant-date-in-go/48160134#48160134", "title": "How to declare a constant date in go", "body": "<p>Unfortunately, Go doesn't let you define struct constants. What I would suggest you do is to declare const int64 representing your time as a Unix timestamp. Then whenever you need to use it, you can call <code>time.UnixNano</code>.</p>\n"}], "owner": {"reputation": 22448, "user_id": 1870481, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/478e3c60bf48e069b2f79bddd202d600?s=128&d=identicon&r=PG", "display_name": "michas", "link": "https://stackoverflow.com/users/1870481/michas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 878, "favorite_count": 0, "closed_date": 1515482039, "accepted_answer_id": 48160134, "answer_count": 1, "score": 2, "last_activity_date": 1515459682, "creation_date": 1515450576, "question_id": 48158953, "link": "https://stackoverflow.com/questions/48158953/how-to-declare-a-constant-date-in-go", "closed_reason": "Duplicate", "title": "How to declare a constant date in go", "body": "<p>I tried to define a constant date like this:</p>\n\n<pre><code>const fixed = time.Date(2018, time.January, 3, 1, 2, 3, 0, time.UTC)\n</code></pre>\n\n<p>However this does not work because of <code>const initializer is not a constant</code>. :(</p>\n\n<p>Although I understand that technically <code>Date</code> is a function call, semantically this is a very constant expression.</p>\n\n<p>Is there a way to define a date as a constant?</p>\n"}, {"tags": ["go", "struct", "syntax"], "comments": [{"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 2, "creation_date": 1515448247, "post_id": 48158487, "comment_id": 83296598, "body": "Grammar rules are grammar rules. While it <i>could</i> implicitly assume <code>struct</code> if not provided, such is not allowed by the Go language/grammar. Thus it&#39;s not allowed. (The Go grammar has been specifically designed to <i>avoid</i> much grammar complexity..)"}, {"owner": {"reputation": 7532, "user_id": 1826354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7b8892507cb6ede85be9ccb17132a6d1?s=128&d=identicon&r=PG", "display_name": "Charlie Martin", "link": "https://stackoverflow.com/users/1826354/charlie-martin"}, "edited": false, "score": 1, "creation_date": 1515453990, "post_id": 48158487, "comment_id": 83298468, "body": "Why are people down voting this question? It&#39;s a good question."}, {"owner": {"reputation": 10461, "user_id": 5173926, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/lcD7f.jpg?s=128&g=1", "display_name": "Vahid Amiri", "link": "https://stackoverflow.com/users/5173926/vahid-amiri"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1542394326, "post_id": 48158487, "comment_id": 93566421, "body": "@ThunderCat You expect beginners to read the language spec? Give me a break"}], "answers": [{"comments": [{"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 1, "creation_date": 1515448270, "post_id": 48158518, "comment_id": 83296605, "body": "<i>Part</i> of the question the OP is asking why <code>type T {..}</code> can&#39;t be implicitly treated as <code>type T struct {..}</code> (and that part is OT)."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 1, "creation_date": 1515448325, "post_id": 48158518, "comment_id": 83296624, "body": "OP explicitly asks: &quot;Please, explain me (and provide links) what else we can use instead of struct when we define some type.&quot;"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1515448473, "post_id": 48158518, "comment_id": 83296685, "body": "The part where it was edited into your comment after the fact. I answered what seemed to be the root of the question."}, {"owner": {"reputation": 425, "user_id": 5843293, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-xL8jaKZ19R0/AAAAAAAAAAI/AAAAAAAAB_g/P74cQsiGAQ0/photo.jpg?sz=128", "display_name": "Oleksii Shnyra", "link": "https://stackoverflow.com/users/5843293/oleksii-shnyra"}, "edited": false, "score": 0, "creation_date": 1515448601, "post_id": 48158518, "comment_id": 83296732, "body": "I see, thanks for providing options. But also, yes, my intention was to understand why we can&#39;t just use <code>type T {..}</code> with <code>struct</code> in mind as a default behavior."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1515448682, "post_id": 48158518, "comment_id": 83296772, "body": "That is a question for the Go maintainers, not for StackOverflow. If I had to hazard a guess, I&#39;d say they didn&#39;t chose <code>struct</code> as a default because it would be an arbitrary choice - there&#39;s no reason it makes a better default than anything else, so there is no default."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 4, "last_activity_date": 1515447943, "creation_date": 1515447943, "answer_id": 48158518, "question_id": 48158487, "link": "https://stackoverflow.com/questions/48158487/why-to-use-redundant-keyword-struct-for-types-in-go/48158518#48158518", "title": "Why to use &quot;redundant&quot; keyword &quot;struct&quot; for types in Go?", "body": "<p>It's not redundant. You can make types from existing types:</p>\n\n<pre><code>type MyType int\ntype MyType string\n</code></pre>\n\n<p>Or interfaces:</p>\n\n<pre><code>type Stringer interface {\n    String() string\n}\n</code></pre>\n\n<p>This is covered <a href=\"https://tour.golang.org/methods/9\" rel=\"nofollow noreferrer\">in the Go tour</a> and <a href=\"https://golang.org/ref/spec#Type_declarations\" rel=\"nofollow noreferrer\">in the spec</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 425, "user_id": 5843293, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-xL8jaKZ19R0/AAAAAAAAAAI/AAAAAAAAB_g/P74cQsiGAQ0/photo.jpg?sz=128", "display_name": "Oleksii Shnyra", "link": "https://stackoverflow.com/users/5843293/oleksii-shnyra"}, "edited": false, "score": 0, "creation_date": 1515455242, "post_id": 48159409, "comment_id": 83298803, "body": "Totally agree, that&#39;s why my question scoped only to <code>type</code>. I understand the value of <code>struct</code> for other places, but <code>type Person {name string}</code> looks straightforward and recognized for instance in TypeScript."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 425, "user_id": 5843293, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-xL8jaKZ19R0/AAAAAAAAAAI/AAAAAAAAB_g/P74cQsiGAQ0/photo.jpg?sz=128", "display_name": "Oleksii Shnyra", "link": "https://stackoverflow.com/users/5843293/oleksii-shnyra"}, "edited": false, "score": 0, "creation_date": 1515455392, "post_id": 48159409, "comment_id": 83298859, "body": "If you have to use the <code>struct</code> keyword &quot;outside&quot; of type declarations to specify the type (anonymous type), why would you want to change the type&#39;s &quot;appearance&quot; in type declaration? Isn&#39;t it more straightforward to use the same in all places?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 425, "user_id": 5843293, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-xL8jaKZ19R0/AAAAAAAAAAI/AAAAAAAAB_g/P74cQsiGAQ0/photo.jpg?sz=128", "display_name": "Oleksii Shnyra", "link": "https://stackoverflow.com/users/5843293/oleksii-shnyra"}, "edited": false, "score": 0, "creation_date": 1515455583, "post_id": 48159409, "comment_id": 83298899, "body": "I think a consistent syntax is more important than grabbing all chances to reduce the language (syntax) to the minimum possible. That hurts readability big time. The <code>for</code> loop example you mentioned is not really a simplification, but rather the usage of different forms of the <code>for</code> loop."}, {"owner": {"reputation": 425, "user_id": 5843293, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-xL8jaKZ19R0/AAAAAAAAAAI/AAAAAAAAB_g/P74cQsiGAQ0/photo.jpg?sz=128", "display_name": "Oleksii Shnyra", "link": "https://stackoverflow.com/users/5843293/oleksii-shnyra"}, "edited": false, "score": 0, "creation_date": 1515456000, "post_id": 48159409, "comment_id": 83298981, "body": "I am pursuing simplicity. If we roughly call <code>struct</code> an unnamed temporary type, then <code>type Person struct {name string}</code> <i>looks like</i> we create named type <code>Person</code> that infers from unnamed type <code>anonymous struct</code>. You see? We engaged two types instead of just one named type."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 425, "user_id": 5843293, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-xL8jaKZ19R0/AAAAAAAAAAI/AAAAAAAAB_g/P74cQsiGAQ0/photo.jpg?sz=128", "display_name": "Oleksii Shnyra", "link": "https://stackoverflow.com/users/5843293/oleksii-shnyra"}, "edited": false, "score": 0, "creation_date": 1515456230, "post_id": 48159409, "comment_id": 83299049, "body": "@OleksiiShnyra I don&#39;t see, because this initial hypothesis in your comment <i>&quot;if we roughly call <code>struct</code> an unnamed temporary type&quot;</i> is not true. <code>struct</code> itself is just a keyword, <code>struct{}</code> is the anonymous empty struct type."}, {"owner": {"reputation": 425, "user_id": 5843293, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-xL8jaKZ19R0/AAAAAAAAAAI/AAAAAAAAB_g/P74cQsiGAQ0/photo.jpg?sz=128", "display_name": "Oleksii Shnyra", "link": "https://stackoverflow.com/users/5843293/oleksii-shnyra"}, "edited": false, "score": 0, "creation_date": 1515456814, "post_id": 48159409, "comment_id": 83299193, "body": "I think this question appeared because I am using TypeScript. Thus, one more keyword (<code>struct</code> after <code>type</code>) seems strange (redundant) to me yet. The consistent syntax is more important - good point btw."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1515496022, "last_edit_date": 1515496022, "creation_date": 1515453482, "answer_id": 48159409, "question_id": 48158487, "link": "https://stackoverflow.com/questions/48158487/why-to-use-redundant-keyword-struct-for-types-in-go/48159409#48159409", "title": "Why to use &quot;redundant&quot; keyword &quot;struct&quot; for types in Go?", "body": "<p><a href=\"https://golang.org/ref/spec#Types\" rel=\"nofollow noreferrer\">Types</a> (may) not only appear in <a href=\"https://golang.org/ref/spec#Type_declarations\" rel=\"nofollow noreferrer\">type declarations</a>, but in countless other places, for example in <a href=\"https://golang.org/ref/spec#Function_declarations\" rel=\"nofollow noreferrer\">function declarations</a>.</p>\n\n<p>Structs may be \"used\" anonymously, without creating a named type for them. For example, the following declaration is  valid:</p>\n\n<pre><code>func GetPoint() struct{ x, y int } {\n    return struct{ x, y int }{1, 2}\n}\n</code></pre>\n\n<p>Without having to use the <code>struct</code> keyword, <strong>a parsing ambiguity would arise in multiple uses</strong>. Let's say we want to create a function which returns an empty struct:</p>\n\n<pre><code>func GetEmpty() struct{} {\n    return struct{}{}\n}\n</code></pre>\n\n<p>How would this look like without the <code>struct</code> keyword?</p>\n\n<pre><code>func GetEmpty2() {} {\n    return {}{}\n}\n</code></pre>\n\n<p>Now if you're the compiler, what would <em>you</em> make out of this? Is this a function with the same signature as <code>GetEmpty()</code>? Or is this a function without a return value and an empty body (<code>func GetEmpty2() {}</code>) followed by a <a href=\"https://golang.org/ref/spec#Blocks\" rel=\"nofollow noreferrer\">block</a> which contains a <code>return</code> statement? The return statement would be another ambiguity, as it may return nothing which is followed by 2 empty blocks, or it may return an empty struct value which is followed by an empty block...</p>\n\n<p>Now to avoid parsing ambiguity, we have to use the <code>struct</code> keyword when specifying struct types <em>elsewhere</em> (outside of type declarations), then why make it optional or disallow it in type declarations?<br>\nI think a <strong>consistent syntax</strong> is more important than grabbing all chances to reduce the language (syntax) to the minimum possible. That hurts readability big time. The <code>for</code> loop example you mentioned is not really a simplification, but rather the usage of different forms of the <code>for</code> loop. </p>\n"}], "owner": {"reputation": 425, "user_id": 5843293, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-xL8jaKZ19R0/AAAAAAAAAAI/AAAAAAAAB_g/P74cQsiGAQ0/photo.jpg?sz=128", "display_name": "Oleksii Shnyra", "link": "https://stackoverflow.com/users/5843293/oleksii-shnyra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 707, "favorite_count": 1, "accepted_answer_id": 48158518, "answer_count": 2, "score": 1, "last_activity_date": 1515496022, "creation_date": 1515447791, "question_id": 48158487, "link": "https://stackoverflow.com/questions/48158487/why-to-use-redundant-keyword-struct-for-types-in-go", "title": "Why to use &quot;redundant&quot; keyword &quot;struct&quot; for types in Go?", "body": "<p>I am a big fan of Golang, and very pleased to how the syntax of Go is designed. As a part of syntax philosophy, we have a rule as following: omit the things (keywords, characters etc.) if they are not needed actually.</p>\n\n<p>For that reason instead of writing redundant colons:</p>\n\n<pre><code>for ; sum &lt; 1000; {\n    sum += sum\n}\n</code></pre>\n\n<p>You allowed to simply put:</p>\n\n<pre><code>for sum &lt; 1000 {\n    sum += sum\n}\n</code></pre>\n\n<p><em>notice how we omitted redundant semicolons</em></p>\n\n<p>And there are lots of other cases where syntax is gratefully simplified.</p>\n\n<p>But what about <code>struct</code> when we define type?</p>\n\n<pre><code>type Person struct {\n    name string\n}\n</code></pre>\n\n<p>Why do we need to put <code>struct</code> keyword here?\nKeywords are to determine intention, to clarify the exact choice of available options so a compiler knows how to do his job properly.</p>\n\n<p>Will it be unclear and ambiguous if we simply put:</p>\n\n<pre><code>type Person {\n    name string\n}\n</code></pre>\n\n<p>??</p>\n\n<blockquote>\n  <p>I believe there is a meaning for <code>struct</code> in the examples above\n  because compiler fails when type defined without <code>struct</code> keyword.</p>\n</blockquote>\n\n<p>Please, explain me (and provide links) <strong>what else</strong> we can use instead of <code>struct</code> when we define some type.</p>\n\n<p>Please, list available options from which we want to clarify to a compiler that things in curly brackets after type name are exactly parts of a <strong>struct</strong> and not something else (<strong>what else</strong>?).</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "telegram-bot"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515448187, "post_id": 48158412, "comment_id": 83296575, "body": "Please include the relevant code in your question."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6478676"}, "is_accepted": false, "score": 1, "last_activity_date": 1515617449, "creation_date": 1515617449, "answer_id": 48195859, "question_id": 48158412, "link": "https://stackoverflow.com/questions/48158412/save-user-states-between-menu-interactions-in-telegram-bot/48195859#48195859", "title": "Save user states between menu interactions in Telegram bot", "body": "<p>Try to use <a href=\"https://core.telegram.org/bots/api#inlinequery\" rel=\"nofollow noreferrer\">InlineQuery</a>. You can store some key parameters through the dialog with user. For example, you can store them in <code>callback_data</code> field, if you are using <code>InlineKeyboard</code>.</p>\n"}], "owner": {"reputation": 975, "user_id": 2148352, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/HcT8H.jpg?s=128&g=1", "display_name": "James May", "link": "https://stackoverflow.com/users/2148352/james-may"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1515617449, "creation_date": 1515447443, "question_id": 48158412, "link": "https://stackoverflow.com/questions/48158412/save-user-states-between-menu-interactions-in-telegram-bot", "title": "Save user states between menu interactions in Telegram bot", "body": "<p>I'm creating a trade Telegram bot and I suppose to have about 5 different menus (keyboards) to communicate with the user. On the first step I provide to user an ability to choose the exnchange to trade, after that she should choose the currency, then choose the price, then she could see another user orders etc.</p>\n\n<p>From the backend view the user messages is just a text and I choose where to route the request by just analyzing that text (old school <strong>switch</strong> statement). For the first step is okay, I have only couple of exchanges so I know the user is on the first step, but when she chose the currency how could I know which exchange he had been chosen on the previous step? Of course I could use the database to save all user menus interactions, but I'm interested is there another choise exist?</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-elastic-beanstalk", "aws-sdk"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515506683, "post_id": 48158006, "comment_id": 83319078, "body": "Beanstalk log viewer is pretty rudimentary anyway. Just log somewhere else (loggly, graylog, splunk, logentries, kibana... there&#39;s about a million better options than the Beanstock tool.)"}], "answers": [{"comments": [{"owner": {"reputation": 469, "user_id": 2957055, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2626bc69c9070ac46b36b31fda0ee446?s=128&d=identicon&r=PG&f=1", "display_name": "margincall", "link": "https://stackoverflow.com/users/2957055/margincall"}, "edited": false, "score": 1, "creation_date": 1571390839, "post_id": 48160162, "comment_id": 103233813, "body": "now they collects <code>&#47;var&#47;log&#47;web-1.log</code>, <code>&#47;var&#47;log&#47;web-1.error.log</code>"}], "tags": [], "owner": {"reputation": 133, "user_id": 8271744, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aac49eb3971ab6cbf0b6b916c5b33413?s=128&d=identicon&r=PG&f=1", "display_name": "Books", "link": "https://stackoverflow.com/users/8271744/books"}, "is_accepted": false, "score": 2, "last_activity_date": 1515459980, "creation_date": 1515459980, "answer_id": 48160162, "question_id": 48158006, "link": "https://stackoverflow.com/questions/48158006/how-to-log-in-amazon-beanstalk/48160162#48160162", "title": "How to &quot;log&quot; in Amazon Beanstalk?", "body": "<p>Go logging is broken on beanstalk. THat's because cloudwatch doesn't collect the web logs (i.e. web-1.error.log) . You can see it on aws docs...it collects only the ebl and nginx/proxy logs. As this great cloud is not open source nobody but Amazon can ever fix it(if they decide to do so).</p>\n\n<p><a href=\"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/AWSHowTo.cloudwatchlogs.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/AWSHowTo.cloudwatchlogs.html</a></p>\n"}], "owner": {"reputation": 133, "user_id": 8271744, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aac49eb3971ab6cbf0b6b916c5b33413?s=128&d=identicon&r=PG&f=1", "display_name": "Books", "link": "https://stackoverflow.com/users/8271744/books"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1515459980, "creation_date": 1515445326, "last_edit_date": 1515459968, "question_id": 48158006, "link": "https://stackoverflow.com/questions/48158006/how-to-log-in-amazon-beanstalk", "title": "How to &quot;log&quot; in Amazon Beanstalk?", "body": "<p>I've deployed an application and enabled cloudwatch. The issue is that stderr from the application running is not displayed in cloudwatch? How am I supposed to view the logs generated by my app? All I see are the logs from the builder and nginx/proxy in front of my app.</p>\n\n<pre><code>/aws/elasticbeanstalk/Default-Environment/var/log/eb-activity.log\n/aws/elasticbeanstalk/Default-Environment/var/log/nginx/access.log\n/aws/elasticbeanstalk/Default-Environment/var/log/nginx/error.log\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515439385, "post_id": 48156730, "comment_id": 83292608, "body": "What does the <code>RemoteAddr</code> field have? Is it just a proxy or load balancer, or is it correlated with the client?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1515439748, "post_id": 48156730, "comment_id": 83292795, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17222021/google-app-engine-golang-how-to-get-users-ip-address\" title=\"google app engine golang how to get users ip address\">stackoverflow.com/questions/17222021/&hellip;</a>"}, {"owner": {"reputation": 75, "user_id": 355077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/717fbb89559e5694f26ce3aad01ba819?s=128&d=identicon&r=PG", "display_name": "Philip Constantinou", "link": "https://stackoverflow.com/users/355077/philip-constantinou"}, "edited": false, "score": 0, "creation_date": 1515481958, "post_id": 48156730, "comment_id": 83305190, "body": "RemoteAddr (when in App Engine) returns an empty string. Typically it has the IP address of the client, however, sometimes it gets the IP of the load balancer. To work around this, load balancers sometimes add an X-Forwarded-For header with the client&#39;s IP. The IP address of the client is obtained using system calls from the server the receives that receives the HTTP request. It&#39;s not passed from the client."}, {"owner": {"reputation": 75, "user_id": 355077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/717fbb89559e5694f26ce3aad01ba819?s=128&d=identicon&r=PG", "display_name": "Philip Constantinou", "link": "https://stackoverflow.com/users/355077/philip-constantinou"}, "edited": false, "score": 0, "creation_date": 1515482161, "post_id": 48156730, "comment_id": 83305278, "body": "I assume this problem is specific to App Engine."}, {"owner": {"reputation": 75, "user_id": 355077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/717fbb89559e5694f26ce3aad01ba819?s=128&d=identicon&r=PG", "display_name": "Philip Constantinou", "link": "https://stackoverflow.com/users/355077/philip-constantinou"}, "edited": false, "score": 0, "creation_date": 1515518114, "post_id": 48156730, "comment_id": 83326389, "body": "Also note this question does  a good job of enumerating all the possible headers used to pass client IP&#39;s, none of which are set by App Engine. <a href=\"https://stackoverflow.com/questions/16558869/getting-ip-address-of-client\" title=\"getting ip address of client\">stackoverflow.com/questions/16558869/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 2, "creation_date": 1515546455, "post_id": 48177799, "comment_id": 83337902, "body": "Note: that&#39;s a valid IPv6 address, you <i>might</i> want to take such addresses into acount as well for your purpose."}], "tags": [], "owner": {"reputation": 75, "user_id": 355077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/717fbb89559e5694f26ce3aad01ba819?s=128&d=identicon&r=PG", "display_name": "Philip Constantinou", "link": "https://stackoverflow.com/users/355077/philip-constantinou"}, "is_accepted": false, "score": 0, "last_activity_date": 1515561851, "last_edit_date": 1515561851, "creation_date": 1515538221, "answer_id": 48177799, "question_id": 48156730, "link": "https://stackoverflow.com/questions/48156730/how-do-you-get-the-remoteaddr-remote-ip-address-when-deployed-on-google-app-en/48177799#48177799", "title": "How do you get the RemoteAddr (remote IP address) when deployed on Google App Engine Standard in Go", "body": "<p>In Google App Engine <code>r.RemoteAddr</code> does in fact return the IP address (my bad). However despite <a href=\"https://stackoverflow.com/questions/17222021/google-app-engine-golang-how-to-get-users-ip-address\">other recommendations</a> \n<code>ip, _, err := net.SplitHostPort(r.RemoteAddr)</code> actual returns the error:</p>\n\n<p><code>address 2601:645:8101:7784:7112:5258:8ba3:c888: too many colons in address</code> </p>\n\n<p>and no IP address.</p>\n\n<p>Do not use <code>net.SplitHostPort</code> and you'll get an IPv6 address.</p>\n\n<p>I've logged <a href=\"https://issuetracker.google.com/issues/71730783\" rel=\"nofollow noreferrer\">an issue</a> with Google. </p>\n"}], "owner": {"reputation": 75, "user_id": 355077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/717fbb89559e5694f26ce3aad01ba819?s=128&d=identicon&r=PG", "display_name": "Philip Constantinou", "link": "https://stackoverflow.com/users/355077/philip-constantinou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1092, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1515561851, "creation_date": 1515438963, "question_id": 48156730, "link": "https://stackoverflow.com/questions/48156730/how-do-you-get-the-remoteaddr-remote-ip-address-when-deployed-on-google-app-en", "title": "How do you get the RemoteAddr (remote IP address) when deployed on Google App Engine Standard in Go", "body": "<p>I want to obtain the <em>client/browser IP</em> address to rate limit unauthenticated clients in my Google App Engine Standard/Go web app.</p>\n\n<p>In the deployed app <code>r.RemoteAddr</code> returns the empty string.</p>\n\n<p>Enumerating through the request headers (<code>r.Header [string][]string</code>) provides only the following entries. </p>\n\n<pre><code>    Content-Length\n    X-Appengine-Citylatlong\n    X-Appengine-Region\n    Upgrade-Insecure-Requests\n    Accept-Language\n    X-Cloud-Trace-Context\n    X-Appengine-Country\n    X-Appengine-City\n    Host\n    Cache-Control\n    Origin\n    Content-Type\n    Referer\n    User-Agent\n    Accept\n</code></pre>\n\n<p>No IP addresses.</p>\n\n<p>How do you obtain the client IP?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515431237, "post_id": 48154800, "comment_id": 83288750, "body": "I don&#39;t know, is it? That&#39;s a very fine-grained implementation-specific detail that no one can answer on your behalf, especially with no context."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515431259, "post_id": 48154800, "comment_id": 83288759, "body": "Every time you check you have the possibly of &quot;just missing&quot; a message, you can&#39;t go on forever, Just accept that a message within a few nanoseconds of the timeout might be after the timeout."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 2, "creation_date": 1515431496, "post_id": 48154800, "comment_id": 83288875, "body": "In most cases, no. Only if the result is ready when almost exactly the time runs out can the double check trigger. The time interval between is very slim. And when you use a timeout, it mostly means the result can be discarded if it is too slow and you do not need to be pricise on timing."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1515432870, "post_id": 48154800, "comment_id": 83289497, "body": "Not to mention, if having a message arrive <i>exactly</i> at <code>timeout</code> is valid, then just extend <code>timeout</code> slightly."}], "answers": [{"tags": [], "owner": {"reputation": 15599, "user_id": 73831, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4813b578ef6e0ca5ba25a77f57fdb5f1?s=128&d=identicon&r=PG", "display_name": "Sudhir Jonathan", "link": "https://stackoverflow.com/users/73831/sudhir-jonathan"}, "is_accepted": true, "score": 1, "last_activity_date": 1515432938, "creation_date": 1515432938, "answer_id": 48155292, "question_id": 48154800, "link": "https://stackoverflow.com/questions/48154800/double-check-with-gos-select-statement/48155292#48155292", "title": "Double check with Go&#39;s select statement", "body": "<p>If one of the channels is a timeout, odds of your work being done and the timeout firing at exactly the same time are so small they make no sense to consider. </p>\n\n<p>The statement \"... It chooses one at random if multiple are ready.\" is applicable when you actually have a viable reason for this to happen - when you have a select case on multiple job channels that you're processing with a single goroutine, for instance. </p>\n"}], "owner": {"reputation": 1195, "user_id": 2317369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ea03f26f205911ccad17bd4fcf7fcb?s=128&d=identicon&r=PG", "display_name": "cpr4t3s", "link": "https://stackoverflow.com/users/2317369/cpr4t3s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 48155292, "answer_count": 1, "score": -2, "last_activity_date": 1515432938, "creation_date": 1515430916, "last_edit_date": 1515431864, "question_id": 48154800, "link": "https://stackoverflow.com/questions/48154800/double-check-with-gos-select-statement", "title": "Double check with Go&#39;s select statement", "body": "<p>I'm learning Golang, and after reading <a href=\"https://blog.golang.org/go-concurrency-patterns-timing-out-and\" rel=\"nofollow noreferrer\">this post</a> on Go's blog, I have the following question.</p>\n\n<p>I start with the following code (from the post):</p>\n\n<pre><code>select {\ncase &lt;-ch:\n    // a read from ch has occurred\ncase &lt;-timeout:\n    // the read from ch has timed out\n}\n</code></pre>\n\n<p>And based on what <a href=\"https://tour.golang.org/concurrency/5\" rel=\"nofollow noreferrer\">A Tour of Go</a> states:</p>\n\n<blockquote>\n  <p>... It chooses one at random if multiple are ready.</p>\n</blockquote>\n\n<p>As I understand, it is possible to have my result ready and have a timeout at the same time. My question is whether it is worth it (or correct) to double-check for this inside the default case.</p>\n\n<p>Something like the following:</p>\n\n<pre><code>select {\ncase &lt;-ch:\n    // a read from ch has occurred\ncase &lt;-timeout:\n    // the read from ch has timed out\n\n    // So check ch one last time\n    select {\n    case &lt;-ch:\n        // a read from ch has occurred at same time of a timeout,\n        // so ignore the timeout\n    default:\n        // definitive timeout\n    }\n}\n</code></pre>\n"}, {"tags": ["function", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1515427743, "post_id": 48153929, "comment_id": 83286762, "body": "You don&#39;t, because that&#39;s the way the language is specified: <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">Calls spec</a>. If you want named fields, use a struct."}], "answers": [{"comments": [{"owner": {"reputation": 2264, "user_id": 1964489, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dced6d8951b4771cde68c08e372bbede?s=128&d=identicon&r=PG", "display_name": "Ziva", "link": "https://stackoverflow.com/users/1964489/ziva"}, "edited": false, "score": 0, "creation_date": 1515518786, "post_id": 48154019, "comment_id": 83326774, "body": "Thanks a lot! Very helpful answer!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 10, "last_activity_date": 1516951554, "last_edit_date": 1516951554, "creation_date": 1515427889, "answer_id": 48154019, "question_id": 48153929, "link": "https://stackoverflow.com/questions/48153929/initialize-function-fields/48154019#48154019", "title": "Initialize function fields", "body": "<p>The <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">spec does not allow</a> you to specify parameter names when calling a function. You can only list the values you wish to pass as arguments. You have to specify values for all parameters (except for the variadic parameter), and you have to list them in the expected order.</p>\n\n<p>The closest you can get to what you want is passing a struct. Create a struct type that wraps your current parameters, and change your function to accept a value of that struct (or a pointer to it):</p>\n\n<pre><code>type Params struct {\n    name, address, nick string\n    age, value          int\n}\n\nfunc MyFunction(p Params) {\n    // perform some operations\n}\n\nfunc main() {\n    MyFunction(Params{\n        name:    \"Bob\",\n        address: \"New York\",\n        nick:    \"Builder\",\n        age:     30,\n        value:   1000,\n    })\n}\n</code></pre>\n\n<p>Then of course you have to refer to these fields using a <a href=\"https://golang.org/ref/spec#Selectors\" rel=\"nofollow noreferrer\">selector</a> on the <code>p</code> parameter, e.g.:</p>\n\n<pre><code>func MyFunction(p Params) {\n    // perform some operations\n    fmt.Printf(\"%s lives in %s.\\n\", p.name, p.address)\n}\n</code></pre>\n\n<p>Also note that as an extra \"gain\" (or burden), the \"parameters\" (which are the fields of the struct parameter) become <em>optional</em> and <em>unordered</em>: you are not forced to specify a value to all the fields, and you can list the fields in any order you like.</p>\n\n<p>You can also call it like this:</p>\n\n<pre><code>MyFunction(Params{\n    name:    \"Alice\",\n    address: \"Washington\",\n})\n</code></pre>\n\n<p>Output of the above calls (try it on the <a href=\"https://play.golang.org/p/_ThT-wTryJi\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Bob lives in New York.\nAlice lives in Washington.\n</code></pre>\n\n<p>If you don't want to (or can't) change the function to accept a struct parameter, then you may leave it as-is, and create a new, helper function which will have this struct parameter, and all it would do is call the original function, passing the appropriate fields as arguments:</p>\n\n<pre><code>func MyFunction(name, address, nick string, age, value int) {\n    // perform some operations\n}\n\nfunc MyFunction2(p Params) {\n    MyFunction(p.name, p.address, p.nick, p.age, p.value)\n}\n</code></pre>\n\n<p>And then you can call <code>MyFunction()</code> indirectly like this:</p>\n\n<pre><code>MyFunction2(Params{\n    name:    \"Bob\",\n    address: \"New York\",\n    nick:    \"Builder\",\n    age:     30,\n    value:   1000,\n})\n</code></pre>\n\n<p>See this related question: <a href=\"https://stackoverflow.com/questions/31377433/getting-method-parameter-names-in-golang/31377793#31377793\">Getting method parameter names in Golang</a></p>\n"}, {"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1515430757, "post_id": 48154028, "comment_id": 83288523, "body": "Question isn&#39;t asking for default parameters, they just want to call functions with the argument names in the function call (which you also can&#39;t do in Go)."}], "tags": [], "owner": {"reputation": 177, "user_id": 4961041, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qbTeQU_6rek/AAAAAAAAAAI/AAAAAAAAAGM/wmWzkCfKKp4/photo.jpg?sz=128", "display_name": "Shaban Naasso", "link": "https://stackoverflow.com/users/4961041/shaban-naasso"}, "is_accepted": false, "score": -2, "last_activity_date": 1515433412, "last_edit_date": 1515433412, "creation_date": 1515427924, "answer_id": 48154028, "question_id": 48153929, "link": "https://stackoverflow.com/questions/48153929/initialize-function-fields/48154028#48154028", "title": "Initialize function fields", "body": "<p>There is no default Parameters in go.</p>\n\n<p>You just call it \n<code>MyFunction(\"Bob\", \"New York\", \"Builder\",30, 1000)</code></p>\n\n<p><strike>But if you provide a bit more background on what you try to achieve, there might be a way for people to find a solution for you.</strike></p>\n\n<p>After rereading i think i understand what you are trying to do.\nActually you can do it the opposite way around and bind the function to your data like so.</p>\n\n<pre><code>type Person struct{\n    Name string\n    Location string\n    Age int\n}\n</code></pre>\n\n<p>Now to the function. Instead of declaring <code>MyFunc()</code>you declare it like so.</p>\n\n<pre><code>func (p *Person)MyFunc(){\n    //Do whatever you want with\n    //p.Age p.Location and so on\n}\n</code></pre>\n\n<p>Then you can call this function like so</p>\n\n<pre><code>p := new(Person)\n//intitalize your parameters\np.MyFunc()\n</code></pre>\n"}], "owner": {"reputation": 2264, "user_id": 1964489, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dced6d8951b4771cde68c08e372bbede?s=128&d=identicon&r=PG", "display_name": "Ziva", "link": "https://stackoverflow.com/users/1964489/ziva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "accepted_answer_id": 48154019, "answer_count": 2, "score": -3, "last_activity_date": 1516951554, "creation_date": 1515427485, "last_edit_date": 1515492460, "question_id": 48153929, "link": "https://stackoverflow.com/questions/48153929/initialize-function-fields", "title": "Initialize function fields", "body": "<p>I have a function in Go as below:</p>\n\n<pre><code>func MyFunction(name, address, nick string, age, value int) {\n    // perform some operations\n}\n</code></pre>\n\n<p>and I want to call this function with arguments (\"Bob\", \"New York\", \"Builder\", 30, 1000) but I would like to use the fields names while calling the function. However none of the below technique worked (they throw the 'Unresolved reference error'):</p>\n\n<pre><code>MyFunction(name = \"Bob\", address = \"New York\", nick = \"Builder\", age = 30, value = 1000)\n\nMyFunction(name : \"Bob\", address : \"New York\", nick : \"Builder\", age : 30, value : 1000)\n</code></pre>\n\n<p>How should it be properly done? I have no problem to use the fields names while initializing a structure but for functions it seems I'm missing something.</p>\n"}, {"tags": ["go", "windows-xp", "blocking", "i386"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1515426325, "post_id": 48153493, "comment_id": 83285934, "body": "If Windows XP SP3 is still a supported platform (I haven&#39;t checked), then I would open an issue rather than asking here."}, {"owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515426742, "post_id": 48153493, "comment_id": 83286205, "body": "@JimB According to the Go website Windows XP SP 2 is the minimal supported Windows version. <a href=\"https://golang.org/doc/install#requirements\" rel=\"nofollow noreferrer\">golang.org/doc/install#requirements</a>"}, {"owner": {"reputation": 43, "user_id": 5210795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0918facd54557cb19f1dc62f1b4c993e?s=128&d=identicon&r=PG&f=1", "display_name": "ko80", "link": "https://stackoverflow.com/users/5210795/ko80"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515428845, "post_id": 48153493, "comment_id": 83287403, "body": "@JimB Okay, I&#39;ve opened an issue: <a href=\"https://github.com/golang/go/issues/23375\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/23375</a>"}, {"owner": {"reputation": 43, "user_id": 5210795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0918facd54557cb19f1dc62f1b4c993e?s=128&d=identicon&r=PG&f=1", "display_name": "ko80", "link": "https://stackoverflow.com/users/5210795/ko80"}, "edited": false, "score": 0, "creation_date": 1515434443, "post_id": 48153493, "comment_id": 83290274, "body": "Just tried to compile it on a previous stable version (go1.8.5 windows/386). The issue is the same."}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 5210795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0918facd54557cb19f1dc62f1b4c993e?s=128&d=identicon&r=PG&f=1", "display_name": "ko80", "link": "https://stackoverflow.com/users/5210795/ko80"}, "is_accepted": true, "score": 0, "last_activity_date": 1515842431, "creation_date": 1515842431, "answer_id": 48239358, "question_id": 48153493, "link": "https://stackoverflow.com/questions/48153493/accept-timeout-setting-on-windows-xp-sp3/48239358#48239358", "title": "Accept() timeout setting on Windows XP SP3", "body": "<p>I've found a solution: <strong>reinstall</strong> Windows XP SP3.</p>\n\n<p>I've tried to check how the app works on another installation of Windows XP SP3 and Windows XP SP2 and found that there were no issue.</p>\n\n<p>Obviously, this means my XP works in a different way. Unfortunately, I have no ideas what is wrong.</p>\n"}], "owner": {"reputation": 43, "user_id": 5210795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0918facd54557cb19f1dc62f1b4c993e?s=128&d=identicon&r=PG&f=1", "display_name": "ko80", "link": "https://stackoverflow.com/users/5210795/ko80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 48239358, "answer_count": 1, "score": 0, "last_activity_date": 1518221885, "creation_date": 1515425991, "last_edit_date": 1518221885, "question_id": 48153493, "link": "https://stackoverflow.com/questions/48153493/accept-timeout-setting-on-windows-xp-sp3", "title": "Accept() timeout setting on Windows XP SP3", "body": "<p>I faced a critical issue while using go1.9.2 windows/386 on Windows XP SP3.</p>\n\n<p>The Accept() blocks forever, even if I set a timeout using SetDeadline(), until the program exits.</p>\n\n<p>I consider it critical because I can't stop listeners when I need to. Additionally, conn.Read() blocks forever as well, but I didn't include it to the example to make is simpler.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n    \"time\"\n)\n\nfunc main() {\n\n    listener, err := net.Listen(\"tcp\", \":8888\")\n    if err != nil {\n        fmt.Println(err.Error())\n        return\n    }\n\n    tcplistener := listener.(*net.TCPListener)\n    tcplistener.SetDeadline(time.Now().Add(time.Second * 2))\n\n    fmt.Println(\"Listener started\")\n\n    go func() {\n\n        defer func() {\n            tcplistener.Close()\n            fmt.Println(\"Listener closed\")\n        }()\n\n        for {\n\n            conn, err := listener.Accept()\n            if err != nil {\n                fmt.Println(err.Error())\n                return\n            }\n\n            conn.Write([]byte(\"OK\\n\"))\n            conn.Close()\n\n        }\n\n    }()\n\n    time.Sleep(time.Second * 10)\n\n    fmt.Println(\"Exit\")\n}\n</code></pre>\n\n<p>Terminal output:</p>\n\n<pre><code>Listener started\nExit\n</code></pre>\n\n<p>In contrast, when I run this program on Windows 7 under VirtualBox (on the same Windows XP SP3), Accept() successfully unblocks after a timeout period.</p>\n\n<p>Terminal output:</p>\n\n<pre><code>Listener started\naccept tcp [::]:8888 i/o timeout\nListener closed\nExit\n</code></pre>\n"}, {"tags": ["amazon-web-services", "docker", "go", "aws-sdk", "aws-ecs"], "owner": {"reputation": 581, "user_id": 2799940, "user_type": "registered", "accept_rate": 13, "profile_image": "https://www.gravatar.com/avatar/e4fd00e6b370e5627b4ec535d036541f?s=128&d=identicon&r=PG&f=1", "display_name": "Know Nothing", "link": "https://stackoverflow.com/users/2799940/know-nothing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 669, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1515591672, "creation_date": 1515424632, "last_edit_date": 1515425115, "question_id": 48153115, "link": "https://stackoverflow.com/questions/48153115/how-to-push-docker-image-into-aws-ecr-using-golang-sdk", "title": "How to push docker image into aws ecr using golang sdk", "body": "<p>I am trying to write a tool to automatically push docker image into aws ECR.</p>\n\n<p>I am trying to push a docker image into aws ECR using aws golang sdk.\nwas trying to follow this documentation <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/ecr/#ECR.PutImage\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-go/api/service/ecr/#ECR.PutImage</a></p>\n\n<p>but no clue how to make ImageManifest object <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/ecr/#PutImageInput\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-go/api/service/ecr/#PutImageInput</a>\nHelp is very much appreciated.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1515424964, "post_id": 48151843, "comment_id": 83285084, "body": "Much better, that way you already have a <code>Close</code> function for the struct"}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 5, "last_activity_date": 1515419931, "creation_date": 1515419931, "answer_id": 48151843, "question_id": 48151651, "link": "https://stackoverflow.com/questions/48151651/struct-initializer-with-multiple-steps-that-can-fail/48151843#48151843", "title": "Struct initializer with multiple steps that can fail", "body": "<p>You can perhaps push the <code>Close</code> calls to <code>*MyStruct</code>'s <code>Close</code>:</p>\n\n<pre><code>func (s *MyStruct) Close() {\n    if s.r3 != nil {\n        s.r3.Close()\n    }\n    if s.r2 != nil {\n        s.r2.Close()\n    }\n    if s.r1 != nil {\n        s.r1.Close()\n    }\n}\n</code></pre>\n\n<p>And update the first implementation of <code>CreateMyStructWithR1R2R3</code> as:</p>\n\n<pre><code>func CreateMyStructWithR1R2R3() (*MyStruct, error) {\n  s := MyStruct{}\n\n  r1, err := OpenResource()\n  if err != nil { s.Close(); return nil, err; }\n  s.r1 = r1\n\n  r2, err := OpenResource()\n  if err != nil { s.Close(); return nil, err; }\n  s.r2 = r2\n\n  r3, err := OpenResource()\n  if err != nil { s.Close(); return nil, err; }\n  s.r3 = r3\n\n  return &amp;s\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 1, "last_activity_date": 1515426807, "last_edit_date": 1515426807, "creation_date": 1515422858, "answer_id": 48152632, "question_id": 48151651, "link": "https://stackoverflow.com/questions/48151651/struct-initializer-with-multiple-steps-that-can-fail/48152632#48152632", "title": "Struct initializer with multiple steps that can fail", "body": "<p>If you declare <code>err</code> as the return argument you don't need the extra <code>success</code> flag since <code>defer</code> will have access to the error value returned.</p>\n\n<hr>\n\n<p>One way to reduce the repetition a little is to introduce a type that will manage a slice of <code>Closer</code>s. When calling close on this new type it would then loop over multiple <code>Closer</code>s, whether you have 3 or 300, and close them all. Say, something like this:</p>\n\n<pre><code>type Closer interface {\n    Close()\n}\n\ntype multiCloser struct {\n    cc []Closer\n}\n\nfunc (mc *multiCloser) add(c Closer) {\n    mc.cc = append(mc.cc, c)\n}\n\nfunc (mc *multiCloser) Close() {\n    for _, c := range mc.cc {\n        c.Close()\n    }\n}\n</code></pre>\n\n<p>With this the implementation of <code>CreateMyStructWithR1R2R3</code> would look like this:</p>\n\n<pre><code>type MyStruct struct {\n    // ...\n    mc *multiCloser\n}\n\nfunc (ms *MyStruct) Close() {\n    ms.mc.Close()\n}\n\nfunc CreateMyStructWithR1R2R3() (ms *MyStruct, err error) {\n    ms = &amp;MyStruct{mc: &amp;multiCloser{}}\n    defer func() {\n        if err != nil {\n            ms.Close()\n        }\n    }()\n\n    if ms.r1, err = OpenResource(); err != nil {\n        return nil, err\n    }\n    ms.mc.add(ms.r1)\n\n    if ms.r2, err = OpenResource(); err != nil {\n        return nil, err\n    }\n    ms.mc.add(ms.r2)\n\n    if ms.r3, err = OpenResource(); err != nil {\n        return nil, err\n    }\n    ms.mc.add(ms.r3)\n\n    return ms, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 656, "user_id": 675011, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f43de6e91f46f77e195ef050273ebefa?s=128&d=identicon&r=PG", "display_name": "Remko", "link": "https://stackoverflow.com/users/675011/remko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1515426807, "creation_date": 1515419320, "question_id": 48151651, "link": "https://stackoverflow.com/questions/48151651/struct-initializer-with-multiple-steps-that-can-fail", "title": "Struct initializer with multiple steps that can fail", "body": "<p>I have the following base code:</p>\n\n<pre><code>r1, err := OpenResource()\nif err != nil { return err; }\ndefer r1.Close()\n\nr2, err := OpenResource()\nif err != nil { return err; }\ndefer r2.Close()\n\nr3, err := OpenResource()\nif err != nil { return err; }\ndefer r3.Close()\n\n// Do something with r1, r2, r3\n...\n</code></pre>\n\n<p>I want to wrap this into a struct, with a method <code>DoSomething</code>, which I would call as follows:</p>\n\n<pre><code>s, err := CreateMyStructWithR1R2R3()\nif err != nil { return err }\ndefer s.Close()\ns.DoSomethingWithR1R2R3() \n</code></pre>\n\n<p>My first approach of implementing this is:</p>\n\n<pre><code>func CreateMyStructWithR1R2R3() (*MyStruct, error) {\n  s := MyStruct{}\n\n  r1, err := OpenResource()\n  if err != nil { return nil, err; }\n  s.r1 = r1\n\n  r2, err := OpenResource()\n  if err != nil { r1.Close(); return nil, err; }\n  s.r2 = r2\n\n  r3, err := OpenResource()\n  if err != nil { r1.Close(); r2.Close(); return nil, err; }\n  s.r3 = r3\n\n  return &amp;s\n}\n\nfunc (s *MyStruct) Close() {\n   s.r3.Close()\n   s.r2.Close()\n   s.r1.Close()\n}\n\nfunc (s *MyStruct) DoSomethingWithR1R2R3() { /* ... */ }\n</code></pre>\n\n<p>However, the <code>Close()</code> calls in the <code>Create()</code> function when an error occurs feel ugly and prone to errors. </p>\n\n<p>An alternative approach that comes to mind is:</p>\n\n<pre><code>func CreateMyStructWithR1R2R3() (*MyStruct, error) {\n  s := MyStruct{}\n  success := false\n\n  r1, err := OpenResource()\n  if err != nil { return nil, err; }\n  defer func() { if !success { r1.Close() } }()\n  s.r1 = r1\n\n  r2, err := OpenResource()\n  if err != nil { return nil, err; }\n  defer func() { if !success { r2.Close() } }()\n  s.r2 = r2\n\n  r3, err := OpenResource()\n  if err != nil { return nil, err; }\n  defer func() { if !success { r3.Close() } }()\n  s.r3 = r3\n\n  success = true\n  return &amp;s\n}\n</code></pre>\n\n<p>This feels safer and cleaner, but the bool feels ugly, and when the Go formatter comes along, this makes the code quite a bit longer.</p>\n\n<p>Is there a better common pattern of making sure all resources are closed with such a multi-stage initialization?</p>\n"}, {"tags": ["json", "go", "nomad"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 1, "creation_date": 1515413486, "post_id": 48149969, "comment_id": 83278281, "body": "Please include a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 417, "user_id": 3049386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754afefdb87c446066459a9857d9a0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Bestbug", "link": "https://stackoverflow.com/users/3049386/bestbug"}, "edited": false, "score": 0, "creation_date": 1515415105, "post_id": 48149969, "comment_id": 83279168, "body": "Yeah can you explain how should be the final string?"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515415945, "post_id": 48149969, "comment_id": 83279661, "body": "You&#39;re not showing what you tried, and your description is very vague. From the looks of it, the values are not all strings (eg: <code>true</code> is not the same as the string <code>&quot;true&quot;</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 177, "user_id": 4961041, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qbTeQU_6rek/AAAAAAAAAAI/AAAAAAAAAGM/wmWzkCfKKp4/photo.jpg?sz=128", "display_name": "Shaban Naasso", "link": "https://stackoverflow.com/users/4961041/shaban-naasso"}, "is_accepted": true, "score": 13, "last_activity_date": 1515416036, "last_edit_date": 1515416036, "creation_date": 1515415433, "answer_id": 48150584, "question_id": 48149969, "link": "https://stackoverflow.com/questions/48149969/converting-map-to-string-in-golang/48150584#48150584", "title": "Converting map to string in golang", "body": "<p>I understand you need some key=value pair on each line representing one map entry.</p>\n\n<p>P.S. you just updated your question and i see you still need quotes around the values, so here come the quotes</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n)\n\nfunc createKeyValuePairs(m map[string]string) string {\n    b := new(bytes.Buffer)\n    for key, value := range m {\n        fmt.Fprintf(b, \"%s=\\\"%s\\\"\\n\", key, value)\n    }\n    return b.String()\n}\nfunc main() {\n    m := map[string]string{\n        \"LOG_LEVEL\": \"DEBUG\",\n        \"API_KEY\":   \"12345678-1234-1234-1234-1234-123456789abc\",\n    }\n    println(createKeyValuePairs(m))\n\n}\n</code></pre>\n\n<p>Working Example:\n<a href=\"https://play.golang.org/p/eRW0NEvBfEr\" rel=\"noreferrer\">Go Playground</a></p>\n"}, {"comments": [{"owner": {"reputation": 177, "user_id": 4961041, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qbTeQU_6rek/AAAAAAAAAAI/AAAAAAAAAGM/wmWzkCfKKp4/photo.jpg?sz=128", "display_name": "Shaban Naasso", "link": "https://stackoverflow.com/users/4961041/shaban-naasso"}, "edited": false, "score": 0, "creation_date": 1515844886, "post_id": 48153686, "comment_id": 83461580, "body": "config files can be very long thats why i used the bytes.buffer"}, {"owner": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "reply_to_user": {"reputation": 177, "user_id": 4961041, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qbTeQU_6rek/AAAAAAAAAAI/AAAAAAAAAGM/wmWzkCfKKp4/photo.jpg?sz=128", "display_name": "Shaban Naasso", "link": "https://stackoverflow.com/users/4961041/shaban-naasso"}, "edited": false, "score": 0, "creation_date": 1516013954, "post_id": 48153686, "comment_id": 83505858, "body": "@ShabanNaasso: I agree; it depends on the use case."}], "tags": [], "owner": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "is_accepted": false, "score": 2, "last_activity_date": 1515426619, "creation_date": 1515426619, "answer_id": 48153686, "question_id": 48149969, "link": "https://stackoverflow.com/questions/48149969/converting-map-to-string-in-golang/48153686#48153686", "title": "Converting map to string in golang", "body": "<p>I would do this very simple and pragmatic:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    m := map[string]string{\n        \"LOG_LEVEL\": \"x\",\n        \"API_KEY\":   \"y\",\n    }\n\n    var s string\n    for key, val := range m {\n        // Convert each key/value pair in m to a string\n            s = fmt.Sprintf(\"%s=\\\"%s\\\"\", key, val)\n        // Do whatever you want to do with the string;\n        // in this example I just print out each of them.\n        fmt.Println(s)\n        }\n}\n</code></pre>\n\n<p>You can see this in action in <a href=\"https://play.golang.org/p/sOu_x_5uUAG\" rel=\"nofollow noreferrer\">The Go Playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 1114, "user_id": 1645444, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/deb932782d59eed3c2d4c7db4c3e066c?s=128&d=identicon&r=PG", "display_name": "Elviss Strazdins", "link": "https://stackoverflow.com/users/1645444/elviss-strazdins"}, "is_accepted": false, "score": 1, "last_activity_date": 1608571253, "creation_date": 1608571253, "answer_id": 65397213, "question_id": 48149969, "link": "https://stackoverflow.com/questions/48149969/converting-map-to-string-in-golang/65397213#65397213", "title": "Converting map to string in golang", "body": "<p>You can use <code>fmt.Sprint</code> to convert the map to string:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    &quot;fmt&quot;\n)\n\nfunc main() {\n    m := map[string]string{\n        &quot;a&quot;: &quot;b&quot;,\n        &quot;c&quot;: &quot;d&quot;,\n    }\n\n    log.Println(&quot;Map: &quot; + fmt.Sprint(m))\n}\n</code></pre>\n<p>Or <code>fmt.Sprintf</code>:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    &quot;fmt&quot;\n)\n\nfunc main() {\n    m := map[string]string{\n        &quot;a&quot;: &quot;b&quot;,\n        &quot;c&quot;: &quot;d&quot;,\n    }\n\n    log.Println(fmt.Sprintf(&quot;Map: %v&quot;, m))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 786, "user_id": 6187674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8SN4E.gif?s=128&g=1", "display_name": "Max Droid", "link": "https://stackoverflow.com/users/6187674/max-droid"}, "is_accepted": false, "score": -1, "last_activity_date": 1617975659, "last_edit_date": 1617975659, "creation_date": 1617975495, "answer_id": 67022178, "question_id": 48149969, "link": "https://stackoverflow.com/questions/48149969/converting-map-to-string-in-golang/67022178#67022178", "title": "Converting map to string in golang", "body": "<pre><code>jsonString, err := json.Marshal(datas) \nfmt.Println(err)\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 7902359, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/cc136e9fe72b06c7f6c2f201bf9e7b39?s=128&d=identicon&r=PG&f=1", "display_name": "ecl0", "link": "https://stackoverflow.com/users/7902359/ecl0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38231, "favorite_count": 1, "accepted_answer_id": 48150584, "answer_count": 4, "score": 7, "last_activity_date": 1617975659, "creation_date": 1515413184, "last_edit_date": 1515416059, "question_id": 48149969, "link": "https://stackoverflow.com/questions/48149969/converting-map-to-string-in-golang", "title": "Converting map to string in golang", "body": "<p>I am trying to find the best way to convert </p>\n\n<p><code>map[string]string</code> to type string . I tried converting to json with marshall to keep the format and then converting back to string but this was not successful. More specifically I am trying to convert a map containing keys and vals to a string to accommodate <a href=\"https://www.nomadproject.io/docs/job-specification/template.html#environment-variables\" rel=\"noreferrer\">https://www.nomadproject.io/docs/job-specification/template.html#environment-variables</a>  <a href=\"https://github.com/hashicorp/nomad/blob/master/nomad/structs/structs.go#L3647\" rel=\"noreferrer\">https://github.com/hashicorp/nomad/blob/master/nomad/structs/structs.go#L3647</a> </p>\n\n<p>For example the final string should be like </p>\n\n<pre><code>LOG_LEVEL=\"x\"\nAPI_KEY=\"y\"    \n</code></pre>\n\n<p>The map </p>\n\n<pre><code>m := map[string]string{\n        \"LOG_LEVEL\": \"x\",\n        \"API_KEY\": \"y\",\n    }\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1515409783, "post_id": 48148497, "comment_id": 83276310, "body": "Can you come up with a minimal standalone example of your problem?"}], "answers": [{"comments": [{"owner": {"reputation": 1835, "user_id": 3195314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiMED.png?s=128&g=1", "display_name": "alseether", "link": "https://stackoverflow.com/users/3195314/alseether"}, "edited": false, "score": 0, "creation_date": 1515411364, "post_id": 48149316, "comment_id": 83277190, "body": "Please, describe a little what your snippet do."}], "tags": [], "owner": {"reputation": 177, "user_id": 4961041, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qbTeQU_6rek/AAAAAAAAAAI/AAAAAAAAAGM/wmWzkCfKKp4/photo.jpg?sz=128", "display_name": "Shaban Naasso", "link": "https://stackoverflow.com/users/4961041/shaban-naasso"}, "is_accepted": true, "score": 2, "last_activity_date": 1515414136, "last_edit_date": 1515414136, "creation_date": 1515410650, "answer_id": 48149316, "question_id": 48148497, "link": "https://stackoverflow.com/questions/48148497/passing-range-of-data-to-html-template/48149316#48149316", "title": "Passing range of data to HTML template", "body": "<pre><code>package main\n\nimport (\n    \"html/template\"\n    \"os\"\n)\n\n// here is your template\nconst tplString = `\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n  &lt;meta charset=\"UTF-8\"&gt;\n  &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n  &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt;\n  &lt;title&gt;{{.Title}}&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n{{range .Dummies}}\n&lt;div&gt;Square of {{.Number}} is {{.Square}}&lt;/div&gt;\n{{end}}\n&lt;/body&gt;\n&lt;/html&gt;\n`\n\nvar (\n    tpl *template.Template\n    err error\n)\n\n// the dummydata you talked about\ntype DummyData struct {\n    Number int\n    Square int\n}\n\n//some PageData just with dummies and a title\ntype PageData struct {\n    Title   string\n    Dummies []*DummyData\n}\n\n//here you would be using your sql queries\nfunc createSomeDummies(amount int) []*DummyData {\n    dummies := make([]*DummyData, amount)\n    for i := 0; i &lt; amount; i++ {\n        dd := new(DummyData)\n        dd.Number = i\n        dd.Square = i * i\n        dummies[i] = dd\n    }\n    return dummies\n}\n\nfunc main() {\n    pd := new(PageData)\n    pd.Title = \"Hello Dummies\"\n    pd.Dummies = createSomeDummies(10)\n\n    tpl = template.New(\"index\")\n    tpl, err = tpl.Parse(tplString)\n    if err != nil {\n        panic(err)\n    }\n    err = tpl.Execute(os.Stdout, pd)\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>This Snippet creates a PageData struct to hold the array of dummydata entries and a Title for the webpage.</p>\n\n<pre><code>type PageData struct {\n    Title   string\n    Dummies []*DummyData\n}\n</code></pre>\n\n<p>It then uses a function to create 10 dummydata structs.\nThis array is then assigned to the Dummmies field of the PageData.</p>\n\n<pre><code>pd.Dummies = createSomeDummies(10)\n</code></pre>\n\n<p>This function is a placeholder for your sql query function you just have to loop over your sql rows instead of manually creating them like i do.</p>\n\n<pre><code>func createSomeDummies(amount int) []*DummyData {\n    dummies := make([]*DummyData, amount)\n    for i := 0; i &lt; amount; i++ {\n        dd := new(DummyData)\n        dd.Number = i\n        dd.Square = i * i\n        dummies[i] = dd\n    }\n    return dummies\n}\n</code></pre>\n\n<p>The Template itself inserts the title like so:\n<code>&lt;title&gt;{{.Title}}&lt;/title&gt;</code></p>\n\n<p>The Dummies themselves are inserted by a range template directive that works like a for iterator.\nThe one thing to be careful about is that inside this loop all data points to the DummyData item and not the PageData</p>\n\n<pre><code>{{range .Dummies}}\n&lt;div&gt;Square of {{.Number}} is {{.Square}}&lt;/div&gt;\n{{end}}\n</code></pre>\n\n<p>Then the template is parsed. Errors will halt execution and print the error message.</p>\n\n<pre><code>tpl = template.New(\"index\")\ntpl, err = tpl.Parse(tplString)\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>And finally the template will be rendered to Stdout. For use in a http Handler you would have to use the http.ResponseWriter instead. \nOnce again errors halt execution and print the error message.</p>\n\n<pre><code>err = tpl.Execute(os.Stdout, pd)\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Working Example here:\n<a href=\"https://play.golang.org/p/_yUStH89fwG\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}], "owner": {"reputation": 75, "user_id": 4157343, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e342a12988be266cf9d95062ccfc47d5?s=128&d=identicon&r=PG&f=1", "display_name": "mac", "link": "https://stackoverflow.com/users/4157343/mac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 48149316, "answer_count": 1, "score": 0, "last_activity_date": 1515414136, "creation_date": 1515407718, "last_edit_date": 1515412603, "question_id": 48148497, "link": "https://stackoverflow.com/questions/48148497/passing-range-of-data-to-html-template", "title": "Passing range of data to HTML template", "body": "<p>I have inserted dummy data into the database.</p>\n\n<p>The sample print function prints 13 and its square as per the code in the console. But I need to pass the entire data to the HTML template(index) where I can see a table of all the numbers passed with their respective square number.</p>\n\n<p>How to pass this data in index HTML?</p>\n\n<p><code>Number x Number = SquareNumber\n1 x 1 = 1\n2 x 2 = 4\n3 x 3 = 9</code>\n...\nand so on.</p>\n\n<pre><code>func main() {\n\n    db, err := sql.Open(\"mysql\", \"root:@/godb\")\n    if err != nil {\n        panic(err.Error())  \n    }\n\n    defer db.Close() \n\n stmtIns, err := db.Prepare(\"INSERT INTO squarenum VALUES(?, ?, ? )\") // ? = \nplaceholder\n    if err != nil {\n        panic(err.Error()) }\n\n    defer stmtIns.Close() \n\n stmtOut, err := db.Prepare(\"SELECT squareNum FROM squareNum WHERE number = \n ?\")\n    if err != nil {\n        panic(err.Error()) \n    }\n\n    defer stmtOut.Close()\n\n    for i := 1; i &lt; 50; i++ {\n        _, err = stmtIns.Exec(0,i, (i * i)) \n        if err != nil {\n            panic(err.Error()) \n        }\n    }\n\n    err = stmtOut.QueryRow(13).Scan(&amp;squareNum) // WHERE number = 13\n    if err != nil {\n panic(err.Error()) // proper error handling instead of panic in your app\n\n    }\n    tRes:=pageData{}\n    tRes.SquareNum=squareNum\n    fmt.Printf(\"The square number of 13 is: %d \\n\", squareNum)\n\n\n    // Query another number.. 1 maybe?\n    err = stmtOut.QueryRow(1).Scan(&amp;squareNum) // WHERE number = 1\n    if err != nil {\n panic(err.Error()) // proper error handling instead of panic in your app\n    }\n    fmt.Printf(\"The square number of 1 is: %d \\n\", squareNum)\n    http.HandleFunc(\"/\",idx)\n    http.ListenAndServe(\":8888\", nil)\n}\n\nfunc idx(w http.ResponseWriter, r *http.Request) {\n\n    pd := pageData{\n        SquareNum: squareNum,\n        }\n\n    err := tpl.ExecuteTemplate(w, \"index.html\", pd)\n    if err != nil {\n        log.Println(\"LOGGED\", err)\nhttp.Error(w, \"Internal server error\", http.StatusInternalServerError)\n        return\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "concurrency", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6039450, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/10207345164361709/picture?type=large", "display_name": "Miha Zoubek", "link": "https://stackoverflow.com/users/6039450/miha-zoubek"}, "edited": false, "score": 0, "creation_date": 1518792972, "post_id": 48148309, "comment_id": 84662541, "body": "Hey but in this case will brake and ticker will not be triggered every second as main function exited. How to use that ticker will be triggered every second?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 43, "user_id": 6039450, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/10207345164361709/picture?type=large", "display_name": "Miha Zoubek", "link": "https://stackoverflow.com/users/6039450/miha-zoubek"}, "edited": false, "score": 0, "creation_date": 1518793812, "post_id": 48148309, "comment_id": 84663078, "body": "@MihaZoubek If you don&#39;t want to exit after the first tick, then obviously don&#39;t &quot;break&quot; out of the loop. But then you will need (another) goroutine to &quot;drain&quot; the <code>c</code> channel concurrently, else without receiving from it the 2nd send on it would block forever."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1515407352, "last_edit_date": 1515407352, "creation_date": 1515407043, "answer_id": 48148309, "question_id": 48148272, "link": "https://stackoverflow.com/questions/48148272/go-passing-data-to-channel/48148309#48148309", "title": "Go, passing data to channel", "body": "<p>Because you have an endless <code>for</code>, so the last <code>fmt.Println()</code> statement is never reached.</p>\n\n<p>You have to break out of the loop if you want the last <code>fmt.Println()</code> statement to ever execute, for example:</p>\n\n<pre><code>loop:\n    for {\n        select {\n        case &lt;-timer1.C:\n            wg.Add(1)\n            go Avg(c, &amp;wg)\n            wg.Wait()\n            break loop\n        }\n    }\n    fmt.Println(&lt;-c)\n</code></pre>\n\n<p>Note that you have to use a label, else the <code>break</code> would only break out of the <code>select</code> statement (and not from the <code>for</code> loop).</p>\n\n<p>Also note that this alone won't work, as the channel is unbuffered, and thus <code>Avg()</code> will be blocked forever, trying to send a value on <code>c</code> while noone is ever trying to receive from it.</p>\n\n<p>This simple example can be made working if you create the channel to be buffered:</p>\n\n<pre><code>c := make(chan string, 1) // Buffer for 1 value\n</code></pre>\n\n<p>Now it works and prints (try it on the <a href=\"https://play.golang.org/p/05QvPdbWRui\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>test\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6039450, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/10207345164361709/picture?type=large", "display_name": "Miha Zoubek", "link": "https://stackoverflow.com/users/6039450/miha-zoubek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 48148309, "answer_count": 1, "score": 2, "last_activity_date": 1515482823, "creation_date": 1515406865, "last_edit_date": 1515482823, "question_id": 48148272, "link": "https://stackoverflow.com/questions/48148272/go-passing-data-to-channel", "title": "Go, passing data to channel", "body": "<p>I have an issue. Here is example: <a href=\"https://play.golang.org/p/QSWY2INQuSE\" rel=\"nofollow noreferrer\">https://play.golang.org/p/QSWY2INQuSE</a></p>\n\n<pre><code>func Avg(c chan string, wg *sync.WaitGroup) {\n    defer wg.Done()\n    c &lt;- \"test\"\n}\n\nfunc main() {\n    var wg sync.WaitGroup\n    c := make(chan string)\n\n    timer1 := time.NewTicker(5 * time.Second)\n\n    for {\n        select {\n        case &lt;-timer1.C:\n            wg.Add(1)\n            go Avg(c, &amp;wg)\n            wg.Wait()\n        }\n    }\n    fmt.Println(&lt;-c)\n}\n</code></pre>\n\n<p>Why data does not reach <code>fmt.Println(&lt;-c)</code></p>\n\n<p>Thank you!</p>\n"}, {"tags": ["python", "python-2.7", "go", "rsa"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1515404491, "post_id": 48147522, "comment_id": 83273292, "body": "\u201cNot the same\u201d in what way? Does it throw an error?"}, {"owner": {"reputation": 977, "user_id": 2752185, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd5f32012130adff6fa78ed329229bc4?s=128&d=identicon&r=PG&f=1", "display_name": "kingcope", "link": "https://stackoverflow.com/users/2752185/kingcope"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1515404988, "post_id": 48147522, "comment_id": 83273577, "body": "@Ryan, rsa.pkcs1.DecryptionError: Decryption failed"}, {"owner": {"reputation": 1757, "user_id": 2808373, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BWOkv.png?s=128&g=1", "display_name": "turnip", "link": "https://stackoverflow.com/users/2808373/turnip"}, "edited": false, "score": 0, "creation_date": 1515407861, "post_id": 48147522, "comment_id": 83275223, "body": "Have you checked that both functions output the same private key? Your Python one might be parsing it differently."}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1515426051, "post_id": 48147522, "comment_id": 83285776, "body": "the python library does not have an rsa module. Which library are you using?"}], "answers": [{"tags": [], "owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "is_accepted": false, "score": 1, "last_activity_date": 1515442583, "creation_date": 1515442583, "answer_id": 48157453, "question_id": 48147522, "link": "https://stackoverflow.com/questions/48147522/translating-an-rsa-decrypt-function-from-golang-to-python/48157453#48157453", "title": "Translating an RSA decrypt function from Golang to Python", "body": "<p>You're using the wrong base64 decoder to decode your ciphertext. It's evident from the \"-\" and \"_\" characters present in your ciphertext that it was encoded using the URL-safe variant of base64. To decode this you should use the base64 module, e.g.</p>\n\n<pre><code>import base64\n\nline = '''\nLyzkh2pqrisgM_p32O6FmA8oDvzaimvrU9zyd0vyW6HBM2BznuHLbAYUMGp5oYgEHCxmZTWDs67Jt5AGulfn-LrcewCQi89wrb00ZvP69YdjwBe-7aoXBG4_zNMZ7ecLgd8WzUqBGGtVvUhCTVSBBi85mNMSCcgYHt__PFefRHZE09nHnEX25w6iR0ZZlQxuESBkuqTcs8qjUhs2Guin1xBMSWRINj4JDdCjIVHV4hdSjrINgFU-VF1sYFRibWcboYlXifROOxCF50MGtIBkcf7dnqsrR8HEXgZLnCyikhhlQAFoh2hsj4lPWNpWum-dBWj-B0b8P-hRmermDzcPqA==\n'''\n\nencrypted = base64.urlsafe_b64decode(line)\nprint len(encrypted)\nprint encrypted.encode('hex')\n</code></pre>\n"}], "owner": {"reputation": 977, "user_id": 2752185, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd5f32012130adff6fa78ed329229bc4?s=128&d=identicon&r=PG&f=1", "display_name": "kingcope", "link": "https://stackoverflow.com/users/2752185/kingcope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1515442583, "creation_date": 1515404155, "last_edit_date": 1515441753, "question_id": 48147522, "link": "https://stackoverflow.com/questions/48147522/translating-an-rsa-decrypt-function-from-golang-to-python", "title": "Translating an RSA decrypt function from Golang to Python", "body": "<p>I need an equivalent of this golang function in Python :</p>\n\n<pre><code>func RsaDecrypt(ciphertext []byte) ([]byte, error) {\n    block, _ := pem.Decode(privateKey)\n    if block == nil {\n        return nil, errors.New(\"private key error!\")\n    }\n    priv, err := x509.ParsePKCS1PrivateKey(block.Bytes)\n    if err != nil {\n        return nil, err\n    }\n    return rsa.DecryptPKCS1v15(rand.Reader, priv, ciphertext)\n}\n</code></pre>\n\n<p>I'm a python developer, and do not understand how this works. I have created this function, but it is not the same:</p>\n\n<pre><code>import rsa\n\nwith open(\"rsa.key\") as f:\n    priv_key_pkcs1 = f.read()\n\npriv_key = rsa.PrivateKey.load_pkcs1(priv_key_pkcs1)\nline = '''\nLyzkh2pqrisgM_p32O6FmA8oDvzaimvrU9zyd0vyW6HBM2BznuHLbAYUMGp5oYgEHCxmZTWDs67Jt5AGulfn-LrcewCQi89wrb00ZvP69YdjwBe-7aoXBG4_zNMZ7ecLgd8WzUqBGGtVvUhCTVSBBi85mNMSCcgYHt__PFefRHZE09nHnEX25w6iR0ZZlQxuESBkuqTcs8qjUhs2Guin1xBMSWRINj4JDdCjIVHV4hdSjrINgFU-VF1sYFRibWcboYlXifROOxCF50MGtIBkcf7dnqsrR8HEXgZLnCyikhhlQAFoh2hsj4lPWNpWum-dBWj-B0b8P-hRmermDzcPqA==\n'''\nencrypted = line.decode('base64')\ndecrypted = rsa.decrypt(encrypted, priv_key)\nprint decrypted\n</code></pre>\n\n<p>Can anybody can help me to convert golang function in Python? Or give me some info where I was wrong in my actual python code?</p>\n"}, {"tags": ["go", "websocket"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1515430376, "post_id": 48146465, "comment_id": 83288307, "body": "If the client connected using TLS, then the connection will use TLS. I don&#39;t think I understand the question, because if you&#39;re only listening with TLS, there&#39;s no other way the client could connect."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1515614379, "post_id": 48146465, "comment_id": 83371114, "body": "If you use ListenAndServeTLS, then all websocket traffic will use TLS."}], "owner": {"reputation": 604, "user_id": 2265106, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IKHQK.png?s=128&g=1", "display_name": "xrfang", "link": "https://stackoverflow.com/users/2265106/xrfang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515399536, "creation_date": 1515399536, "question_id": 48146465, "link": "https://stackoverflow.com/questions/48146465/is-tls-used-throughout-wss-connection-or-just-when-connect", "title": "is TLS used throughout wss connection or just when connect?", "body": "<p>I plan to write an secure websocket server in golang. My question is:</p>\n\n<p>Is TLS used throughout the entire connection when using <code>wss://</code>, or is it just used when upgrade from http(s) to websocket protocol?</p>\n\n<p>The reason I ask is that as I understand the websocket protocol has nothing to do with http except that the connection is initiated via http(s).</p>\n\n<p>So, if I use <code>ListenAndServeTLS</code> in my Go program, can I ensure that the entire websocket conversation is secure?</p>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1515401489, "post_id": 48146448, "comment_id": 83271824, "body": "That looks suspiciously like YAML, if it is then there might be a better way than <code>text&#47;template</code>."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1515400657, "last_edit_date": 1515400657, "creation_date": 1515399960, "answer_id": 48146547, "question_id": 48146448, "link": "https://stackoverflow.com/questions/48146448/range-through-values-within-variable-containing-dashes-in-golang-templates/48146547#48146547", "title": "Range through values within variable containing dashes in Golang templates", "body": "<p>The <code>index</code> function is documented at <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\"><code>text/template</code>: Functions section</a>:</p>\n\n<pre><code>index\n    Returns the result of indexing its first argument by the\n    following arguments. Thus \"index x 1 2 3\" is, in Go syntax,\n    x[1][2][3]. Each indexed item must be a map, slice, or array.\n</code></pre>\n\n<p>To use <code>index</code>: pass the value you want to index, and the values to index by, e.g.</p>\n\n<pre><code>index . \"Values\" \"something\" \"something-else\" \"values\" \"list\"\n</code></pre>\n\n<p>Combined with the <code>{{range}}</code> action:</p>\n\n<pre><code>Items:\n{{range index . \"Values\" \"something\" \"something-else\" \"values\" \"list\"}}\n    {{.}},\n{{end}}\n</code></pre>\n\n<p>See a simplified working example:</p>\n\n<pre><code>func main() {\n    t := template.Must(template.New(\"\").Parse(src))\n    m := map[string]interface{}{\n        \"something\": map[string]interface{}{\n            \"something-else\": map[string]interface{}{\n                \"list\": []string{\"one\", \"two\", \"three\"},\n            },\n        },\n    }\n    if err := t.Execute(os.Stdout, m); err != nil {\n        panic(err)\n    }\n}\n\nconst src = `data:\n{{- range index . \"something\" \"something-else\" \"list\" }} {{.}},{{ end }}`\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/mNLQ07dWn8A\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>data: one, two, three,\n</code></pre>\n"}], "owner": {"reputation": 899, "user_id": 2914587, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8264caf9ad892f1a8a3128aeebbdb0ac?s=128&d=identicon&r=PG&f=1", "display_name": "supercalifragilistichespirali", "link": "https://stackoverflow.com/users/2914587/supercalifragilistichespirali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1269, "favorite_count": 0, "accepted_answer_id": 48146547, "answer_count": 1, "score": 2, "last_activity_date": 1515400657, "creation_date": 1515399474, "question_id": 48146448, "link": "https://stackoverflow.com/questions/48146448/range-through-values-within-variable-containing-dashes-in-golang-templates", "title": "Range through values within variable containing dashes in Golang templates", "body": "<p>I would like to range through values specified under a variable containing dashes within Golang template:</p>\n\n<pre><code>data:\n  init: |\n{{- range .Values.something.something-else.values.list }}\n{{ . | indent 4 }}{{ end }}\n</code></pre>\n\n<p>I've seen that to access values from a variable with dashes in the name <code>index</code> function should be used.</p>\n\n<p>I'm not understanding though how to combine the two functions.</p>\n"}, {"tags": ["sqlite", "docker", "go"], "answers": [{"tags": [], "owner": {"reputation": 11839, "user_id": 730346, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/86187a52f1e2f64890194d0451748ce5?s=128&d=identicon&r=PG", "display_name": "Daniel YC Lin", "link": "https://stackoverflow.com/users/730346/daniel-yc-lin"}, "is_accepted": true, "score": 1, "last_activity_date": 1515396502, "last_edit_date": 1515396502, "creation_date": 1515392186, "answer_id": 48145115, "question_id": 48144135, "link": "https://stackoverflow.com/questions/48144135/is-it-possible-to-build-a-static-sqlite-go-app-by-docker-golangalpine-image/48145115#48145115", "title": "Is it possible to build a static sqlite Go app by docker golang:alpine image?", "body": "<p>refer to <a href=\"https://stackoverflow.com/questions/33113190/how-to-create-a-statically-linked-golang-executable-with-go-1-5\">how to create a statically linked golang executable with go 1.5+</a></p>\n\n<p>Change the Dockerfile's <code>go-wrapper install</code> line into</p>\n\n<pre><code>RUN go-wrapper install -ldflags \"-linkmode external -extldflags -static\"   \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 417, "user_id": 3049386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754afefdb87c446066459a9857d9a0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Bestbug", "link": "https://stackoverflow.com/users/3049386/bestbug"}, "is_accepted": false, "score": 1, "last_activity_date": 1515415823, "last_edit_date": 1515415823, "creation_date": 1515415608, "answer_id": 48150615, "question_id": 48144135, "link": "https://stackoverflow.com/questions/48144135/is-it-possible-to-build-a-static-sqlite-go-app-by-docker-golangalpine-image/48150615#48150615", "title": "Is it possible to build a static sqlite Go app by docker golang:alpine image?", "body": "<p>If I correctly understood your problem it depends on how you build the Golang executable. </p>\n\n<p>You should build your package with <code>CGO_ENABLED</code> set to <code>0</code>. In order to do that, before compiling, simply run <code>export CGO_ENABLED=0</code> on your terminal than build your Golang binary. </p>\n\n<p>If you are interested you can find more info about <code>CGO</code> <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 11839, "user_id": 730346, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/86187a52f1e2f64890194d0451748ce5?s=128&d=identicon&r=PG", "display_name": "Daniel YC Lin", "link": "https://stackoverflow.com/users/730346/daniel-yc-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2644, "favorite_count": 3, "accepted_answer_id": 48145115, "answer_count": 2, "score": 2, "last_activity_date": 1515553865, "creation_date": 1515384765, "last_edit_date": 1515553865, "question_id": 48144135, "link": "https://stackoverflow.com/questions/48144135/is-it-possible-to-build-a-static-sqlite-go-app-by-docker-golangalpine-image", "title": "Is it possible to build a static sqlite Go app by docker golang:alpine image?", "body": "<p>I'm trying to build my app which contains go-sqlite3 by docker. </p>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n        \"database/sql\"\n\n        _ \"github.com/mattn/go-sqlite3\"\n)\n\nfunc main() {\n        sql.Open(\"sqlite3\", \"test.db\")\n}\n</code></pre>\n\n<p>Dockerfile</p>\n\n<pre><code>FROM golang:alpine\nRUN apk add --no-cache git\nRUN apk add --no-cache sqlite-libs sqlite-dev\nRUN apk add --no-cache build-base\nWORKDIR /go/src/app\nCOPY *.go ./\nRUN go-wrapper download\nRUN go-wrapper install\n</code></pre>\n\n<p>I use this command to copy the compiled program out to my host OS (Arch Linux).</p>\n\n<pre><code>docker build -t mygo .\ndocker run --rm -v $$PWD:/usr/src/app mygo /bin/cp /go/bin/app /usr/src/app\n</code></pre>\n\n<p>The problem is the compiled program is missing dynamic library</p>\n\n<pre><code>$  ldd app\n   ...\n   libc.musl-x86_64.so.1 =&gt; not found\n</code></pre>\n\n<p>What I expected is like</p>\n\n<pre><code>$  ldd app\nnot a dynamic executable\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1515391830, "post_id": 48144134, "comment_id": 83268144, "body": "What is &quot;available&quot;? Any workers at all? Or at least one worker receiving on jobs?"}, {"owner": {"reputation": 2591, "user_id": 905486, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7f7e926f83a1b86e0681bae3b79f28ec?s=128&d=identicon&r=PG", "display_name": "Anton Medvedev", "link": "https://stackoverflow.com/users/905486/anton-medvedev"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1515430992, "post_id": 48144134, "comment_id": 83288638, "body": "See answer for."}], "answers": [{"comments": [{"owner": {"reputation": 2591, "user_id": 905486, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7f7e926f83a1b86e0681bae3b79f28ec?s=128&d=identicon&r=PG", "display_name": "Anton Medvedev", "link": "https://stackoverflow.com/users/905486/anton-medvedev"}, "edited": false, "score": 0, "creation_date": 1515474286, "post_id": 48145190, "comment_id": 83302780, "body": "Bot how to finish faster if there is always worker ready for job? How to stop it?"}, {"owner": {"reputation": 2591, "user_id": 905486, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7f7e926f83a1b86e0681bae3b79f28ec?s=128&d=identicon&r=PG", "display_name": "Anton Medvedev", "link": "https://stackoverflow.com/users/905486/anton-medvedev"}, "edited": false, "score": 0, "creation_date": 1515474409, "post_id": 48145190, "comment_id": 83302821, "body": "Also there is a deadlock possible."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 2591, "user_id": 905486, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7f7e926f83a1b86e0681bae3b79f28ec?s=128&d=identicon&r=PG", "display_name": "Anton Medvedev", "link": "https://stackoverflow.com/users/905486/anton-medvedev"}, "edited": false, "score": 0, "creation_date": 1515479764, "post_id": 48145190, "comment_id": 83304398, "body": "Stop it by closing the <code>stop</code> channel as shown on the playground example."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1515479713, "last_edit_date": 1515479713, "creation_date": 1515392550, "answer_id": 48145190, "question_id": 48144134, "link": "https://stackoverflow.com/questions/48144134/how-to-check-if-channel-is-open-in-worker/48145190#48145190", "title": "How to check if channel is open in worker?", "body": "<p>One option to use two channels, one for ready and one for the actual work:</p>\n\n<pre><code>func worker(ready chan struct{}, work chan int, wg *sync.WaitGroup) {\n    for range ready {\n        w, ok := &lt;-work\n        if !ok {\n            break\n        }\n        perform(w)\n    }\n    wg.Done()\n}\n\nfunc queue(ready chan struct{}, work chan int, stop chan struct{}) {\n    defer close(ready)\n    defer close(work)\n    for {\n        select {\n        case ready &lt;- struct{}{}:\n            work &lt;- receiveWork()\n        case &lt;-stop:\n            return\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Lpo4FogOoeS\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 2591, "user_id": 905486, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7f7e926f83a1b86e0681bae3b79f28ec?s=128&d=identicon&r=PG", "display_name": "Anton Medvedev", "link": "https://stackoverflow.com/users/905486/anton-medvedev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1444, "favorite_count": 0, "accepted_answer_id": 48145190, "answer_count": 1, "score": 1, "last_activity_date": 1515479713, "creation_date": 1515384746, "question_id": 48144134, "link": "https://stackoverflow.com/questions/48144134/how-to-check-if-channel-is-open-in-worker", "title": "How to check if channel is open in worker?", "body": "<p>Here is what I'm doing: a few workers and queue with job for them.</p>\n\n<p>I have a simple worker:</p>\n\n<pre><code>func worker(jobs &lt;-chan int, wg *sync.WaitGroup) {\n    for work := range jobs {\n        perform(work)\n    }\n    wg.Done()\n}\n</code></pre>\n\n<p>Start them:</p>\n\n<pre><code>    jobs := make(chan int)\n    var wg sync.WaitGroup\n\n    for w := 1; w &lt;= parallel; w++ {\n        wg.Add(1)\n        go worker(jobs, &amp;wg)\n    }\n</code></pre>\n\n<p>Also I have a queue, and here goes problem, how to check if there is available worker and write only then?</p>\n\n<pre><code>func queue(jobs chan int, stop chan bool) {\n    for {\n            select {\n            case jobs&lt;-?: // How to check what worker is available?\n                work := receiveWork()\n                jobs &lt;- work\n                continue\n            case &lt;-stop:\n                return\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Start queue: </p>\n\n<pre><code>stop := make(chan bool)\ngo queue(jobs, stop)\n</code></pre>\n\n<p>Note what <code>receiveWork()</code> should be called only if there is an available worker.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1515361647, "post_id": 48141744, "comment_id": 83261621, "body": "&quot;it is not work&quot; really is not a technical problem description. Given you expect a string to be returned, why do you have <code>[3]int</code> in the signature?"}, {"owner": {"reputation": 490, "user_id": 7155773, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/F4LBE.png?s=128&g=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/7155773/ivan"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1515361891, "post_id": 48141744, "comment_id": 83261693, "body": "Oh, sorry, I have corrected the signature. But problem is <code>strings.Join</code> expected <code>[]string</code>, not <code>[]int</code>"}], "answers": [{"tags": [], "owner": {"reputation": 966, "user_id": 2166750, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7a98a414302c4331caa45d56a522202?s=128&d=identicon&r=PG", "display_name": "Bert Verhees", "link": "https://stackoverflow.com/users/2166750/bert-verhees"}, "is_accepted": true, "score": 1, "last_activity_date": 1515364776, "last_edit_date": 1515364776, "creation_date": 1515361407, "answer_id": 48141808, "question_id": 48141744, "link": "https://stackoverflow.com/questions/48141744/golang-concatination-array-of-int/48141808#48141808", "title": "Golang: concatination array of int", "body": "<p>You should use the function <code>strconv.Itoa</code> or the <code>fmt.Sprintf(\"%d\",a)</code></p>\n\n<p>So like this</p>\n\n<pre><code>S := \"\"\nfor _,i := range intarray {\n   S = S + strconv.Itoa( i )\n}\n</code></pre>\n"}], "owner": {"reputation": 490, "user_id": 7155773, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/F4LBE.png?s=128&g=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/7155773/ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2474, "favorite_count": 0, "accepted_answer_id": 48141808, "answer_count": 1, "score": -2, "last_activity_date": 1515364776, "creation_date": 1515360783, "last_edit_date": 1515361798, "question_id": 48141744, "link": "https://stackoverflow.com/questions/48141744/golang-concatination-array-of-int", "title": "Golang: concatination array of int", "body": "<p>Initial data:</p>\n\n<pre><code>rawdata := []int{17, 23, 100500}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>result := convert(rawdata)\nexpected := \"1723100500\"\n</code></pre>\n\n<p>What should I do with <code>convert()</code>? I have:</p>\n\n<pre><code>func convert(param []int) string {\n    data := strings.Join(param)\n    return data\n}\n</code></pre>\n\n<p>but it is not work</p>\n"}, {"tags": ["go", "atom-editor", "hyperledger-fabric"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 3107825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58c3b04695591505c52a4d5df0cb962?s=128&d=identicon&r=PG&f=1", "display_name": "igors", "link": "https://stackoverflow.com/users/3107825/igors"}, "edited": false, "score": 0, "creation_date": 1515844618, "post_id": 48141982, "comment_id": 83461513, "body": "I moved to Visual Studio Code and everything works fine. I didn&#39;t even need to specify the build tags, no build errors, autocompletion works fine. Does it mean that Visual Studio doesn&#39;t rebuild all dependencies (like Atom does)? Btw, i already built fabric code with -nopkcs11 outside any dev environment."}], "tags": [], "owner": {"reputation": 7694, "user_id": 5529712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7uvxg.png?s=128&g=1", "display_name": "Gari Singh", "link": "https://stackoverflow.com/users/5529712/gari-singh"}, "is_accepted": true, "score": 0, "last_activity_date": 1515362678, "creation_date": 1515362678, "answer_id": 48141982, "question_id": 48141483, "link": "https://stackoverflow.com/questions/48141483/build-chaincodehyperledger-on-atom-on-windows-fail/48141982#48141982", "title": "Build chaincode(hyperledger) on Atom on Windows fail", "body": "<p>I believe there is still an <a href=\"https://github.com/joefitzgerald/go-plus/issues/573\" rel=\"nofollow noreferrer\">open issue for go-plus</a> to support build tags.  I have not used Atom in a while, but the only option I can think of would be to try to use a Makefile (which is not the easiest thing in the world on Windows since most of the built-in Atom commands assume GNU commands being available).</p>\n\n<p>If you are open to moving to something like Visual Studio Code it does support build tags.</p>\n\n<p>Perhaps we should actually reverse the build tag within Fabric and require you to enabled pkcs11 with a tag rather than disable it with a tag.  I debated this when first adding the tag.  Feel free to open up a <a href=\"https://jira.hyperledger.org\" rel=\"nofollow noreferrer\">JIRA item</a> for this.</p>\n"}], "owner": {"reputation": 23, "user_id": 3107825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58c3b04695591505c52a4d5df0cb962?s=128&d=identicon&r=PG&f=1", "display_name": "igors", "link": "https://stackoverflow.com/users/3107825/igors"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 48141982, "answer_count": 1, "score": 0, "last_activity_date": 1515467732, "creation_date": 1515358792, "last_edit_date": 1515467732, "question_id": 48141483, "link": "https://stackoverflow.com/questions/48141483/build-chaincodehyperledger-on-atom-on-windows-fail", "title": "Build chaincode(hyperledger) on Atom on Windows fail", "body": "<p>I'm trying to build simple chaincode example in Atom editor on Windows but build fails (I'm using go-plus package) with following error:</p>\n\n<pre><code>fatal error: ltdl.h: No such file or directory #include ltdl.h\n</code></pre>\n\n<p>I know that using flag: <code>-tags nopkcs11</code> will solve the problem, but how can i configure go-plus/Atom to use this flag?</p>\n"}, {"tags": ["mongodb", "date", "go", "aggregation", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 795, "user_id": 3041613, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/061da320c11b785e534f4fcc2ecfc6ac?s=128&d=identicon&r=PG&f=1", "display_name": "Artorias", "link": "https://stackoverflow.com/users/3041613/artorias"}, "edited": false, "score": 0, "creation_date": 1515684952, "post_id": 48139663, "comment_id": 83402473, "body": "sorry for late reply. It is exactly what I wanted. Thanks."}], "tags": [], "owner": {"reputation": 63390, "user_id": 2683814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16a4c2fb341c51388d5cdfcf0e956f6c?s=128&d=identicon&r=PG&f=1", "display_name": "s7vr", "link": "https://stackoverflow.com/users/2683814/s7vr"}, "is_accepted": true, "score": 1, "last_activity_date": 1515345709, "creation_date": 1515345709, "answer_id": 48139663, "question_id": 48138984, "link": "https://stackoverflow.com/questions/48138984/mongodb-mgo-aggregate-earliest-create-date-and-latest-last-modified-date/48139663#48139663", "title": "MongoDB mgo aggregate earliest create date and latest last modified date", "body": "<p>You can try below aggregation query.</p>\n\n<pre><code>db.colname.aggregate([\n{\"$group\":{\n  \"_id\":{\n    \"username\":\"$username\",\n    \"object_name\":\"$object_name\"\n  },\n  \"created_at\":{\"$min\":\"$created_at\"},\n  \"last_modified\":{\"$max\":\"$last_modified\"}\n}},\n{\"$group\":{\n  \"_id\":\"$_id.username\",\n  \"objects\":{\n    \"$push\":{\n      \"object_name\":\"$_id.object_name\",\n      \"created_at\":\"$created_at\",\n      \"last_modified\":\"$last_modified\"\n    }\n  }\n}}])\n</code></pre>\n"}], "owner": {"reputation": 795, "user_id": 3041613, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/061da320c11b785e534f4fcc2ecfc6ac?s=128&d=identicon&r=PG&f=1", "display_name": "Artorias", "link": "https://stackoverflow.com/users/3041613/artorias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 48139663, "answer_count": 1, "score": 0, "last_activity_date": 1515345709, "creation_date": 1515341250, "question_id": 48138984, "link": "https://stackoverflow.com/questions/48138984/mongodb-mgo-aggregate-earliest-create-date-and-latest-last-modified-date", "title": "MongoDB mgo aggregate earliest create date and latest last modified date", "body": "<p>I am trying to retrieve the earliest created date and latest last modified date for each object_name in the following data</p>\n\n<pre><code>{ \"_id\" : ObjectId(\"5a510666b2e543371cff44ef\"), \"object_name\" : \"A\", \"username\" : \"user1\", \"created_at\" : ISODate(\"2018-01-06T17:24:54.026Z\"), \"last_modified\" : ISODate(\"2018-01-06T17:24:54.026Z\") }\n{ \"_id\" : ObjectId(\"5a5106e7b2e543371cff4515\"), \"object_name\" : \"A\", \"username\" : \"user1\", \"created_at\" : ISODate(\"2018-01-06T17:27:03.262Z\"), \"last_modified\" : ISODate(\"2018-01-06T17:27:03.262Z\") }\n{ \"_id\" : ObjectId(\"5a510933b2e543371cff45be\"), \"object_name\" : \"B\", \"username\" : \"user1\", \"created_at\" : ISODate(\"2018-01-06T17:36:51.300Z\"), \"last_modified\" : ISODate(\"2018-01-06T17:36:51.300Z\") }\n{ \"_id\" : ObjectId(\"5a510939b2e543371cff45c5\"), \"object_name\" : \"C\", \"username\" : \"user2\", \"created_at\" : ISODate(\"2018-01-06T17:36:57.058Z\"), \"last_modified\" : ISODate(\"2018-01-06T17:36:57.058Z\") }\n</code></pre>\n\n<p>I have no problem to group distinct object_name with each username with the following pipeline</p>\n\n<pre><code>pipeline := []bson.M{\n    {\"$group\": bson.M{\"_id\": \"$username\", \"objects\": bson.M{\"$addToSet\": \"$object_name\"}}},\n}\n</code></pre>\n\n<p>However I also want to add earliest created date and latest last modified date for each object.</p>\n\n<p>Here is my desired output:</p>\n\n<pre><code>[\n    {\n        \"_id\": \"user1\",\n        \"objects\": [\n            {\n                \"object_name\": \"A\",\n                \"created_at\": \"2018-01-06T17:24:54.026Z\",\n                \"last_modified\": \"2018-01-06T17:27:03.262Z\"\n            },\n            {\n                \"object_name\": \"B\",\n                \"created_at\": \"2018-01-06T17:36:51.300Z\",\n                \"last_modified\": \"2018-01-06T17:36:51.300Z\"\n            }\n        ]\n    },\n    {\n        \"_id\": \"user2\",\n        \"objects\": [\n            {\n                \"object_name\": \"C\",\n                \"created_at\": \"2018-01-06T17:36:57.058Z\",\n                \"last_modified\": \"2018-01-06T17:36:57.058Z\"\n            }\n        ]\n    }\n]\n</code></pre>\n\n<p>I think it has something to do with $sort and $first or $last but I don't know how to put them together.</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-rds"], "comments": [{"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1515338445, "post_id": 48138267, "comment_id": 83254495, "body": "Presumably you have configured the RDS instance to allow  IAM DB Authentication (<a href=\"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.Enabling.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/AmazonRDS/latest/UserGuide/&hellip;</a>)?"}, {"owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "reply_to_user": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1515339779, "post_id": 48138267, "comment_id": 83254960, "body": "Hello! Yes I did. - I have nobody who can help me and I&#39;m sitting on this since 4 days. I beg you for help"}, {"owner": {"reputation": 1813, "user_id": 7753973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad1e4b4e9b97f11de7661e6cf68b332b?s=128&d=identicon&r=PG&f=1", "display_name": "sudo", "link": "https://stackoverflow.com/users/7753973/sudo"}, "edited": false, "score": 1, "creation_date": 1515351152, "post_id": 48138267, "comment_id": 83258669, "body": "@JulieNoobie The policy statement\u2019s resource shows that you are using \u201cus-west-2c\u201d which is am AZ. Could you please modify that to \u201cus-east-2\u201d i.e. the region where your RDS resource is and try again?"}, {"owner": {"reputation": 31092, "user_id": 1715121, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6nEEr.jpg?s=128&g=1", "display_name": "Ele", "link": "https://stackoverflow.com/users/1715121/ele"}, "edited": false, "score": 0, "creation_date": 1515355570, "post_id": 48138267, "comment_id": 83259929, "body": "Do you enable IAM authentication to your RDS instance?"}, {"owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "reply_to_user": {"reputation": 1813, "user_id": 7753973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad1e4b4e9b97f11de7661e6cf68b332b?s=128&d=identicon&r=PG&f=1", "display_name": "sudo", "link": "https://stackoverflow.com/users/7753973/sudo"}, "edited": false, "score": 0, "creation_date": 1515357593, "post_id": 48138267, "comment_id": 83260502, "body": "@sudo I changed it and still doesn&#39;t work :("}, {"owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "reply_to_user": {"reputation": 31092, "user_id": 1715121, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6nEEr.jpg?s=128&g=1", "display_name": "Ele", "link": "https://stackoverflow.com/users/1715121/ele"}, "edited": false, "score": 0, "creation_date": 1515357614, "post_id": 48138267, "comment_id": 83260510, "body": "@EleazarEnrique Yes, It is enabled"}, {"owner": {"reputation": 4459, "user_id": 6079732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1WHuY.jpg?s=128&g=1", "display_name": "abigperson", "link": "https://stackoverflow.com/users/6079732/abigperson"}, "edited": false, "score": 0, "creation_date": 1515358226, "post_id": 48138267, "comment_id": 83260673, "body": "i&#39;m not familiar with go, but for connecting to mysql with IAM authentication I believe the <code>--enable-cleartext-plugin</code> flag must be enabled as well as <code>--ssl-ca=</code> with the path to the key file from: <a href=\"https://s3.amazonaws.com/rds-downloads/rds-combined-ca-bundle.pem\" rel=\"nofollow noreferrer\">s3.amazonaws.com/rds-downloads/rds-combined-ca-bundle.pem</a> ... was a pain to figure all this out. good luck!"}, {"owner": {"reputation": 31092, "user_id": 1715121, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6nEEr.jpg?s=128&g=1", "display_name": "Ele", "link": "https://stackoverflow.com/users/1715121/ele"}, "reply_to_user": {"reputation": 4459, "user_id": 6079732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1WHuY.jpg?s=128&g=1", "display_name": "abigperson", "link": "https://stackoverflow.com/users/6079732/abigperson"}, "edited": false, "score": 1, "creation_date": 1515360052, "post_id": 48138267, "comment_id": 83261192, "body": "@abigperson those flags are available for CLI rather than programmatic access."}, {"owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "reply_to_user": {"reputation": 31092, "user_id": 1715121, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6nEEr.jpg?s=128&g=1", "display_name": "Ele", "link": "https://stackoverflow.com/users/1715121/ele"}, "edited": false, "score": 0, "creation_date": 1515360476, "post_id": 48138267, "comment_id": 83261315, "body": "@EleazarEnrique Do you have any suggestions for me? I don&#39;t know what to do..."}, {"owner": {"reputation": 31092, "user_id": 1715121, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6nEEr.jpg?s=128&g=1", "display_name": "Ele", "link": "https://stackoverflow.com/users/1715121/ele"}, "edited": false, "score": 0, "creation_date": 1515361460, "post_id": 48138267, "comment_id": 83261571, "body": "Are you passing the iam arn <code>arn:aws:rds-db:region:account-id:dbuser:dbi-resource-id&#47;data&zwnj;&#8203;base-user-name</code>?"}, {"owner": {"reputation": 4459, "user_id": 6079732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1WHuY.jpg?s=128&g=1", "display_name": "abigperson", "link": "https://stackoverflow.com/users/6079732/abigperson"}, "edited": false, "score": 0, "creation_date": 1515362188, "post_id": 48138267, "comment_id": 83261770, "body": "there should be equivalent methods through any connector to pass any CLI flags, e.g.: <a href=\"https://github.com/go-sql-driver/mysql#allowcleartextpasswords\" rel=\"nofollow noreferrer\">github.com/go-sql-driver/mysql#allowcleartextpasswords</a> &amp; <a href=\"https://godoc.org/github.com/go-sql-driver/mysql#RegisterTLSConfig\" rel=\"nofollow noreferrer\">godoc.org/github.com/go-sql-driver/mysql#RegisterTLSConfig</a>"}, {"owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "reply_to_user": {"reputation": 4459, "user_id": 6079732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1WHuY.jpg?s=128&g=1", "display_name": "abigperson", "link": "https://stackoverflow.com/users/6079732/abigperson"}, "edited": false, "score": 0, "creation_date": 1515365557, "post_id": 48138267, "comment_id": 83262632, "body": "@abigperson I have added it to my code snippet and it is still not working-"}], "answers": [{"comments": [{"owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "edited": false, "score": 0, "creation_date": 1515368660, "post_id": 48142233, "comment_id": 83263344, "body": "Hello. I just tried what the remake the example but it did not work. I think I will just go for an alternative. Can you recommend my any authentication ways? Should I just hardcode the password? Thanks so much for helping me."}, {"owner": {"reputation": 31092, "user_id": 1715121, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6nEEr.jpg?s=128&g=1", "display_name": "Ele", "link": "https://stackoverflow.com/users/1715121/ele"}, "reply_to_user": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "edited": false, "score": 1, "creation_date": 1515370100, "post_id": 48142233, "comment_id": 83263616, "body": "@JulieNoobie you don&#39;t need to hardcode the password.  You can authenticate using the common way passing the hostname, port, username, and password through environment variables."}, {"owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "edited": false, "score": 1, "creation_date": 1515370211, "post_id": 48142233, "comment_id": 83263640, "body": "Thanks a lot. Send me your bitcoin or ethereum wallet. I&#39;ll send you a gift."}, {"owner": {"reputation": 2454, "user_id": 1586025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9233950674b793e7d3d77bb219baaa52?s=128&d=identicon&r=PG", "display_name": "Joe Atzberger", "link": "https://stackoverflow.com/users/1586025/joe-atzberger"}, "edited": false, "score": 0, "creation_date": 1568676649, "post_id": 48142233, "comment_id": 102341891, "body": "At this time, the mysql limitation is <b>256</b> new connections per second (not 20)."}, {"owner": {"reputation": 712, "user_id": 8868419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a530d27369c9d4f6ecf421fe83d2b4?s=128&d=identicon&r=PG&f=1", "display_name": "Madeo", "link": "https://stackoverflow.com/users/8868419/madeo"}, "edited": false, "score": 0, "creation_date": 1616468082, "post_id": 48142233, "comment_id": 118005789, "body": "@Ele Ok, after a bit of time spent trying to make it work, I have realized that his answer is partially wrong! The <code>iamArn</code> you provided is not correct, it should the arn of the <b>role you want to assume not the iam user</b>"}], "tags": [], "owner": {"reputation": 31092, "user_id": 1715121, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6nEEr.jpg?s=128&g=1", "display_name": "Ele", "link": "https://stackoverflow.com/users/1715121/ele"}, "is_accepted": true, "score": 3, "last_activity_date": 1515364931, "creation_date": 1515364931, "answer_id": 48142233, "question_id": 48138267, "link": "https://stackoverflow.com/questions/48138267/unable-to-access-rds-database-via-iam-authentication/48142233#48142233", "title": "Unable to access RDS Database via IAM Authentication", "body": "<p><strong>According to the sample from AWS Github repository for Go programming language, you need to create the credentials as follow:</strong></p>\n\n<h1>IAM ARN</h1>\n\n<p><strong>Reference:</strong>  <a href=\"https://github.com/aws/aws-sdk-go/blob/master/example/service/rds/rdsutils/authentication/iam_authentication.go\" rel=\"nofollow noreferrer\">IAM authentication go example</a></p>\n\n<pre><code>import (\n    \"database/sql\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n\n    \"github.com/go-sql-driver/mysql\"\n\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/aws/credentials/stscreds\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/rds/rdsutils\"\n)\n\nawsCreds := stscreds.NewCredentials(session.New(&amp;aws.Config{Region: &amp;awsRegion}), iamArn) \n\n// iamArn: arn:aws:rds-db:region:account-id:dbuser:dbi-resource-id/data\u200c\u200bbase-user-name\n\nauthToken, err := rdsutils.BuildAuthToken(dbEndpoint, awsRegion, dbUser, awsCreds)\n</code></pre>\n\n<p>I almost sure you're missing that part of the IAM ARN.</p>\n\n<hr>\n\n<h1>Preparing a Database User</h1>\n\n<p><strong>Reference:</strong> <a href=\"https://dzone.com/articles/passwordless-database-authentication-for-aws-lambd\" rel=\"nofollow noreferrer\">Preparing a Database User</a></p>\n\n<blockquote>\n  <p>You need to connect to your database and create a user using the AWS authentication plugin.</p>\n  \n  <p>The following SQL statement creates a database user named lambda. Instead of specifying a password, the AWSAuthenticationPlugin is used for identifying the user. Replace  with the name of the database you want to grant the user access to.</p>\n</blockquote>\n\n<pre><code>CREATE USER 'master' IDENTIFIED WITH AWSAuthenticationPlugin as 'RDS';\nGRANT ALL PRIVILEGES ON &lt;DB_NAME&gt;.* TO 'master'@'%';\nFLUSH PRIVILEGES;\n</code></pre>\n\n<hr>\n\n<h1>Bonus recommendation</h1>\n\n<p><strong>Reference:</strong> <a href=\"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.html\" rel=\"nofollow noreferrer\">Limitations for IAM Database Authentication</a></p>\n\n<p>I don't know what's the purpose of IAM authentication in your project, but I consider important the following from AWS documentation:</p>\n\n<blockquote>\n  <h1>Limitations for IAM Database Authentication</h1>\n  \n  <p>With IAM database authentication, you are limited to a maximum of 20 new connections per second. If you are using a db.t2.micro instance class, the limit is 10 connections per second.</p>\n  \n  <p>The Amazon RDS for MySQL and Aurora MySQL database engines do not impose any limits on authentication attempts per second. However, when you use IAM database authentication, your application must generate an authentication token. Your application then uses that token to connect to the DB instance or cluster. If you exceed the maximum new-connection-per-second limit, then the extra overhead of IAM database authentication can cause connection throttling. The extra overhead can even cause existing connections to drop.</p>\n  \n  <h1>We recommend the following:</h1>\n  \n  <ul>\n  <li><p>Use IAM database authentication as a mechanism for temporary, personal access to databases.</p></li>\n  <li><p>Don't use IAM database authentication if your application requires more than 20 new connections per second.</p></li>\n  <li><p>Use IAM database authentication only for workloads that can be easily retried.</p></li>\n  </ul>\n  \n  <h1>Note</h1>\n  \n  <p>For information about the maximum total connections for MySQL, see see Maximum MySQL connections. For information about the maximum total connections for Aurora MySQL, see Maximum Connections to an Aurora MySQL DB Instance.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 712, "user_id": 8868419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a530d27369c9d4f6ecf421fe83d2b4?s=128&d=identicon&r=PG&f=1", "display_name": "Madeo", "link": "https://stackoverflow.com/users/8868419/madeo"}, "edited": false, "score": 0, "creation_date": 1616466517, "post_id": 61276968, "comment_id": 118005504, "body": "as my understanding <code>credentials.NewEnvCredentials()</code> does not work within ECS or EC2"}], "tags": [], "owner": {"reputation": 1, "user_id": 13341662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ffbb925004e30ed5c3aa786ea7f5da?s=128&d=identicon&r=PG&f=1", "display_name": "Sharath", "link": "https://stackoverflow.com/users/13341662/sharath"}, "is_accepted": false, "score": 0, "last_activity_date": 1587143310, "creation_date": 1587143310, "answer_id": 61276968, "question_id": 48138267, "link": "https://stackoverflow.com/questions/48138267/unable-to-access-rds-database-via-iam-authentication/61276968#61276968", "title": "Unable to access RDS Database via IAM Authentication", "body": "<p>I was stuck with the same issue. Got it resolved after (a huge lot of lookup online) I added port number for building Auth Token.</p>\n\n<p>Earlier it was like below:</p>\n\n<pre><code>authToken, err := rdsutils.BuildAuthToken(host, region, username, sess.Config.Credentials)\n</code></pre>\n\n<p><strong>Which I had to change to:</strong></p>\n\n<pre><code>authToken, err := rdsutils.BuildAuthToken(fmt.Sprintf(\"%s:%d\", host, 3306), region, username, sess.Config.Credentials)\n</code></pre>\n\n<p>This is for Golang application. But same might apply for other language SDKs.\nI got this answer from <a href=\"https://luktom.net/en/e1544-aws-lambda-and-mysql-iam-authentication-in-go\" rel=\"nofollow noreferrer\">https://luktom.net/en/e1544-aws-lambda-and-mysql-iam-authentication-in-go</a></p>\n\n<p><strong>Someone from AWS need to update their</strong> <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/rds/rdsutils/\" rel=\"nofollow noreferrer\">official docs on this</a></p>\n"}, {"tags": [], "owner": {"reputation": 712, "user_id": 8868419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a530d27369c9d4f6ecf421fe83d2b4?s=128&d=identicon&r=PG&f=1", "display_name": "Madeo", "link": "https://stackoverflow.com/users/8868419/madeo"}, "is_accepted": false, "score": 0, "last_activity_date": 1616468730, "last_edit_date": 1616468730, "creation_date": 1616468347, "answer_id": 66756657, "question_id": 48138267, "link": "https://stackoverflow.com/questions/48138267/unable-to-access-rds-database-via-iam-authentication/66756657#66756657", "title": "Unable to access RDS Database via IAM Authentication", "body": "<p>The answer provided by Ele is partially wrong this is the correct code:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>arn := &quot;arn:aws:iam::00000000000:role/your-TaskRole&quot;\nawsCreds := stscreds.NewCredentials(session.New(&amp;aws.Config{Region: aws.String(Region)}), arn)\n\n</code></pre>\n<p>So the <code>arn</code> <strong>is not the one of the iam db user, but is the arn of the role assigned to your resource (EC2, ECS, Fargate)</strong></p>\n<p>Remember that also you <strong>MUST</strong> use TLS to connect to a database via IAM authentication</p>\n"}], "owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4869, "favorite_count": 1, "accepted_answer_id": 48142233, "answer_count": 3, "score": 4, "last_activity_date": 1616468730, "creation_date": 1515336267, "last_edit_date": 1522789846, "question_id": 48138267, "link": "https://stackoverflow.com/questions/48138267/unable-to-access-rds-database-via-iam-authentication", "title": "Unable to access RDS Database via IAM Authentication", "body": "<p>I'm unable to connect to my RDS database with an IAM user.</p>\n\n<p>Database username: master<br>\nIAM User: api-user</p>\n\n<p>I have assigned the user programmatic access and added following policies to the user:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FDRRt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FDRRt.png\" alt=\"enter image description here\"></a></p>\n\n<p>The custom rds-permission is defined as: <a href=\"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.IAMPolicy.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.IAMPolicy.html</a></p>\n\n<pre><code>    {\n   \"Version\": \"2012-10-17\",\n   \"Statement\": [\n      {\n         \"Effect\": \"Allow\",\n         \"Action\": [\n             \"rds-db:connect\"\n         ],\n         \"Resource\": [\n             \"arn:aws:rds-db:REGION:ACCOUNT-ID:USER:dbi-resource-id/DB_ACCOUNT_NAME\"\n         ]\n      }\n   ]\n}\n</code></pre>\n\n<p>The strange thing is, even though I have defined my custom permission exactly like it is required in the documentation, it is not recognized:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Z0WQJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z0WQJ.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/dcopS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dcopS.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I'm trying to connect using an authentication token (via golang), I'm getting following error:</p>\n\n<pre><code>error: ERROR: Error 1045: Access denied for user 'master'@'x.x.x.189' (using password: YES)\n</code></pre>\n\n<p>My policies don't seem to work!</p>\n\n<p>Even though it is irrelevant, here is how I connect via my IAM user:</p>\n\n<pre><code>//Yes Env vars are available\n//creating new credentials from environment variables\n//AWS_ACCESS_KEY_ID  and  AWS_SECRET_ACCESS_KEY\nawsCreds := credentials.NewEnvCredentials()\n\n//creating authentication token for the database connection\nauthToken, err := rdsutils.BuildAuthToken(dbEndpoint, awsRegion, dbUser, awsCreds)\nif err != nil {\n    Logger.LogFatal(\"Unable to build Authentication Token\")\n    log.Fatal(\"Unable to build Authentication Token\")  //todo remove\n}\n\n//setting up TLS\nmysql.RegisterTLSConfig(\"custom\", &amp;tls.Config{\n    InsecureSkipVerify: true,\n})\n\n// Creating the MySQL DNS string for the DB connection\n// user:password@protocol(endpoint)/dbname?&lt;params&gt;\ndnsStr := fmt.Sprintf(\"%s:%s@tcp(%s:%s)/%s allowCleartextPasswords=true&amp;tls=custom\",\n    dbUser, authToken, dbEndpoint,dbPort, dbName,\n)\nrootCertPool := x509.NewCertPool() //NewCertPool returns a new, empty CertPool.\n\npem, err := ioutil.ReadFile(\"rds-ca-bundle.pem\") //reading the provided pem\nif err != nil {\n    log.Fatal(\"! Could not read certificates\")\n}\nfmt.Println(\"Loading certificate seems to work\")\n//AppendCertsFromPEM attempts to parse a series of PEM encoded certificates.\n//pushing in the pem\nif ok := rootCertPool.AppendCertsFromPEM(pem); !ok {\n    log.Fatal(\"Failed to append PEM.\")\n}\nfmt.Println(\"Appending certificate seems to work too\")\n\n//setting up TLS\n//we dont need a client ca?\nmysql.RegisterTLSConfig(\"custom\", &amp;tls.Config{\n    RootCAs: rootCertPool,\n    InsecureSkipVerify: true,\n})\ndatabase, err = sql.Open(\"mysql\", dnsStr)\n</code></pre>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515334905, "post_id": 48138042, "comment_id": 83253368, "body": "Welcome to Stack Overflow! &quot;Please help&quot; isn&#39;t much of a question. You should show what you have tried, and what didn&#39;t work. Please include a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>. You probably want to look at <a href=\"https://golang.org/pkg/regexp/\" rel=\"nofollow noreferrer\">regexp</a> for this."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9184395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32c6119da765fb58e211cc46d24e0069?s=128&d=identicon&r=PG&f=1", "display_name": "raji nair", "link": "https://stackoverflow.com/users/9184395/raji-nair"}, "edited": false, "score": 0, "creation_date": 1515338803, "post_id": 48138183, "comment_id": 83254629, "body": "I need to get the version details in a string. Not able to get that"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "reply_to_user": {"reputation": 37, "user_id": 9184395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32c6119da765fb58e211cc46d24e0069?s=128&d=identicon&r=PG&f=1", "display_name": "raji nair", "link": "https://stackoverflow.com/users/9184395/raji-nair"}, "edited": false, "score": 0, "creation_date": 1515339048, "post_id": 48138183, "comment_id": 83254703, "body": "<code>matches[1]</code> in my answer is a string containing <code>1.8.0.25</code>. As far as I can tell, this is exactly what you need."}, {"owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 1, "creation_date": 1515340168, "post_id": 48138183, "comment_id": 83255073, "body": "Might want to try it out on <a href=\"https://regex-golang.appspot.com/assets/html/index.html\" rel=\"nofollow noreferrer\">regex-golang.appspot.com/assets/html/index.html</a> to see the result?"}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": false, "score": 3, "last_activity_date": 1515339099, "last_edit_date": 1515339099, "creation_date": 1515335695, "answer_id": 48138183, "question_id": 48138042, "link": "https://stackoverflow.com/questions/48138042/go-regex-find-substring/48138183#48138183", "title": "Go regex find substring", "body": "<p>You need to specify capturing groups to extract submatches, as described in the <a href=\"https://golang.org/pkg/regexp/#pkg-overview\" rel=\"nofollow noreferrer\">package overview</a>:</p>\n\n<blockquote>\n  <p>If 'Submatch' is present, the return value is a slice identifying the\n  successive submatches of the expression. Submatches are matches of\n  parenthesized subexpressions (also known as capturing groups) within\n  the regular expression, numbered from left to right in order of\n  opening parenthesis. Submatch 0 is the match of the entire expression,\n  submatch 1 the match of the first parenthesized subexpression, and so\n  on.</p>\n</blockquote>\n\n<p>Something along the lines of the following:</p>\n\n<pre><code>func main() {\n    var re = regexp.MustCompile(`jdk\\.([^ ]+)`)\n    s := \"root 1 12345 /root/pathtomyfolder/jdk/jdk.1.8.0.25 org.catalina.startup\"\n    matches := re.FindStringSubmatch(s)\n    fmt.Printf(\"%s\", matches[1])\n    // Prints: 1.8.0.25\n}\n</code></pre>\n\n<p>You'll of course want to check whether there actually is a submatch, or <code>matches[1]</code> will panic.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 7933340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f114da804e3c53000e229c7f4e5afa6e?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Forkner", "link": "https://stackoverflow.com/users/7933340/rob-forkner"}, "is_accepted": false, "score": 0, "last_activity_date": 1586050772, "creation_date": 1586050772, "answer_id": 61037013, "question_id": 48138042, "link": "https://stackoverflow.com/questions/48138042/go-regex-find-substring/61037013#61037013", "title": "Go regex find substring", "body": "<p>if you need the value in a string variable to be used / manipulated elsewhere, you could add the following in the given example Marc gave:</p>\n\n<pre><code>a := fmt.Sprintf(\"%s\", matches[1])\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9184395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32c6119da765fb58e211cc46d24e0069?s=128&d=identicon&r=PG&f=1", "display_name": "raji nair", "link": "https://stackoverflow.com/users/9184395/raji-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1774, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1597124477, "creation_date": 1515334828, "last_edit_date": 1597124477, "question_id": 48138042, "link": "https://stackoverflow.com/questions/48138042/go-regex-find-substring", "title": "Go regex find substring", "body": "<p>I have a string:</p>\n\n<pre><code>s := \"root 1 12345 /root/pathtomyfolder/jdk/jdk.1.8.0.25 org.catalina.startup\"\n</code></pre>\n\n<p>I need to grep the version number to a string</p>\n\n<p>Tried,</p>\n\n<pre><code>var re = regexp.MustCompile(`jdk.*`)\nfunc main() {\nmatches := re.FindStringSubmatch(s)\nfmt.Printf (\"%q\", matches)\n}\n</code></pre>\n"}, {"tags": ["go", "object-initialization", "multiple-return-values"], "answers": [{"tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": false, "score": 2, "last_activity_date": 1515322226, "creation_date": 1515322226, "answer_id": 48136390, "question_id": 48136292, "link": "https://stackoverflow.com/questions/48136292/how-to-assign-only-on-return-value-of-a-function-to-field-of-an-struct-in-golang/48136390#48136390", "title": "how to assign only on return value of a function to field of an struct in golang?", "body": "<p>There is no generic way to get just one of returned parameters (Maybe you could implement something with <code>reflect</code> package that returns <code>interface{}</code>).</p>\n\n<p>Other than that it's not good to ignore errors. If you are sure that there's no error implement a helper function like this:</p>\n\n<pre><code>func myAtoi(s string) int {\n    i, err := strconv.Atoi(s)\n    if err != nil {\n        panic(err)\n    }\n    return i\n}\n\ndata := Data {\n    a: myAtoi(\"1000\")\n}\n</code></pre>\n"}], "owner": {"reputation": 1947, "user_id": 298851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/G7fYt.png?s=128&g=1", "display_name": "sepisoad", "link": "https://stackoverflow.com/users/298851/sepisoad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1884, "favorite_count": 0, "closed_date": 1515323772, "answer_count": 1, "score": 0, "last_activity_date": 1515322226, "creation_date": 1515321222, "question_id": 48136292, "link": "https://stackoverflow.com/questions/48136292/how-to-assign-only-on-return-value-of-a-function-to-field-of-an-struct-in-golang", "closed_reason": "Duplicate", "title": "how to assign only on return value of a function to field of an struct in golang?", "body": "<p>let's say we have a struct like this:</p>\n\n<pre><code>type Data struct {\n  a int\n}\n</code></pre>\n\n<p>and we want to get a single return value of a function that returns multiple values and assign it to an object of Data, for example</p>\n\n<pre><code>data := Data {\n  a: strconv.Atoi(\"1000\")\n}\n</code></pre>\n\n<p>the code above does not work because Atoi returns two value, a number and an error, so we need to handle the extra value (error) somehow, but in my case, I do not need to evaluate error value and it is not possible to dismiss it using <code>_</code> keyword. </p>\n\n<p>how can I achieve this when initializing a struct, I want to get rid of the error return value</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 3, "last_activity_date": 1515315572, "creation_date": 1515315572, "answer_id": 48135731, "question_id": 48135694, "link": "https://stackoverflow.com/questions/48135694/why-should-i-use-the-sign-on-structs/48135731#48135731", "title": "Why should I use the &amp; sign on structs?", "body": "<p>The comments pretty much spell it out:</p>\n\n<pre><code>   v1 = Vertex{1, 2}  // has type Vertex\n   p  = &amp;Vertex{1, 2} // has type *Vertex\n</code></pre>\n\n<p>As in many other languages, <code>&amp;</code> <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow noreferrer\">takes the address</a> of the identifier following it. This is useful when you want a pointer rather than a value.</p>\n\n<p>If you need to understand more about pointers in programming, you could start with <a href=\"http://goinbigdata.com/golang-pass-by-pointer-vs-pass-by-value/\" rel=\"nofollow noreferrer\">this</a> for go, or even the <a href=\"https://en.wikipedia.org/wiki/Pointer_(computer_programming)\" rel=\"nofollow noreferrer\">wikipedia</a> page.</p>\n"}, {"comments": [{"owner": {"reputation": 2384, "user_id": 1212682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136ef24f17c7bb9310a29d7df7c8ddbb?s=128&d=identicon&r=PG", "display_name": "Yiling", "link": "https://stackoverflow.com/users/1212682/yiling"}, "edited": false, "score": 1, "creation_date": 1576496245, "post_id": 58786146, "comment_id": 104906287, "body": "This is a thorough answer to the original question, it provided the foundational knowledge about copy of values vs. copy of pointers to the readers, which unlocked the puzzle many had about &amp; in front of a struct type name. Well done!"}, {"owner": {"reputation": 942, "user_id": 3297834, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3f5b6d179d320ac08ab9ff393543d392?s=128&d=identicon&r=PG&f=1", "display_name": "Stelios", "link": "https://stackoverflow.com/users/3297834/stelios"}, "edited": false, "score": 0, "creation_date": 1588160876, "post_id": 58786146, "comment_id": 108791750, "body": "Thanks YenForYang."}, {"owner": {"reputation": 105, "user_id": 8441360, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7tBCl5TUdpg/AAAAAAAAAAI/AAAAAAAAADY/-mLC9d4ETKY/photo.jpg?sz=128", "display_name": "Smruti Ranjan", "link": "https://stackoverflow.com/users/8441360/smruti-ranjan"}, "edited": false, "score": 0, "creation_date": 1589910051, "post_id": 58786146, "comment_id": 109478812, "body": "Any article which demonstrates real-life use cases would be great"}], "tags": [], "owner": {"reputation": 1414, "user_id": 7314180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZkLQ.png?s=128&g=1", "display_name": "YenForYang", "link": "https://stackoverflow.com/users/7314180/yenforyang"}, "is_accepted": false, "score": 25, "last_activity_date": 1573365692, "creation_date": 1573365692, "answer_id": 58786146, "question_id": 48135694, "link": "https://stackoverflow.com/questions/48135694/why-should-i-use-the-sign-on-structs/58786146#58786146", "title": "Why should I use the &amp; sign on structs?", "body": "<p>It's true that <code>p</code> (<code>&amp;Vertex{}</code>) has type <code>*Vertex</code> and that <code>c</code> (<code>Vertex{}</code>) has type <code>Vertex</code>.</p>\n\n<p>However, I don't believe that statement really answers the question of <em>why</em> one would choose one over the other. It'd be kind of like answering the question \"why use planes over cars\" with something like \"planes are winged, cars aren't.\" (Obviously we all know what wings are, but you get the point).</p>\n\n<p>But it also wouldn't be very helpful to simply say \"go learn about pointers\" (though I think it is a <em>really</em> good idea to so nonetheless).</p>\n\n<hr>\n\n<p>How you choose basically boils down to the following.</p>\n\n<ul>\n<li><p>Realize that <code>&amp;Vertex{}</code> and <code>Vertex{}</code> are fundamentally initialized in the same way.</p>\n\n<ul>\n<li>There might be some low-level memory allocation differences (i.e. stack vs heap), but you really should just let the compiler worry about these details</li>\n</ul></li>\n<li><p>What makes one more useful and performant than the other is determined by how they are <em>used</em> in the program.</p></li>\n<li><p>\"Do I want a pointer to the struct (<code>p</code>), or just the struct (<code>c</code>)?\"</p>\n\n<ul>\n<li>Note that you can get a pointer using the <code>&amp;</code> operator (e.g. <code>&amp;c</code>); you can dereference a pointer to get the value using <code>*</code> (e.g. <code>*p</code>)\n\n<ul>\n<li>So depending on what you choose, you may end up doing a lot of <code>*p</code> or <code>&amp;c</code></li>\n<li>Bottom-line: create what you will use; if you don't need a pointer, don't make one (this will help more with \"optimizations\" in the long run).</li>\n</ul></li>\n</ul></li>\n</ul>\n\n<hr>\n\n<ul>\n<li>Should I use <code>Vertex{}</code> or <code>&amp;Vertex{}</code>?\n\n<ul>\n<li>For the <code>Vertex</code> given in your example, I'd choose <code>Vertex{}</code> to a get a simple value object.</li>\n<li>Some reasons:\n\n<ul>\n<li><code>Vertex</code> in the example is pretty small in terms of size. Copying is cheap.</li>\n<li>Garbage collection is simplified, garbage creation may be mitigated by the compiler</li>\n<li>Pointers can get tricky and add unnecessary cognitive load to the programmer (i.e. gets harder to maintain)</li>\n<li>Pointers aren't something you want if you ever get into concurrency (i.e. it's unsafe)</li>\n<li><code>Vertex</code> doesn't really contain anything worth mutating (just return/create a new <code>Vertex</code> when needed).</li>\n</ul></li>\n<li>Some reasons why you'd want <code>&amp;Struct{}</code>\n\n<ul>\n<li>If <code>Struct</code> has a member caching some state that needs to be changed inside the original object itself.</li>\n<li><code>Struct</code> is <em>huge</em>, and you've done enough profiling to determine that the cost of copying is significant.\n\n<ul>\n<li>As an aside: you should try to keep your <code>struct</code>s small, it's just good practice.</li>\n</ul></li>\n<li>You find yourself making copies by accident (this is a bit of a stretch):<pre><code> v := Struct{}\nv2 := v  // Copy happens\n</code></pre><pre><code> v := &amp;Struct{}\nv2 := v  // Only a pointer is copied\n</code></pre></li>\n</ul></li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 182, "user_id": 7558383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d46701c5cd0040bf45ca0ad4b81ff6e?s=128&d=identicon&r=PG&f=1", "display_name": "Tomy", "link": "https://stackoverflow.com/users/7558383/tomy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3344, "favorite_count": 3, "accepted_answer_id": 48135731, "answer_count": 2, "score": 11, "last_activity_date": 1573365692, "creation_date": 1515315203, "question_id": 48135694, "link": "https://stackoverflow.com/questions/48135694/why-should-i-use-the-sign-on-structs", "title": "Why should I use the &amp; sign on structs?", "body": "<p>In the gotour, there is a section: struct literals.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Vertex struct {\n    X, Y int\n}\n\nvar (\n   v1 = Vertex{1, 2}  // has type Vertex\n   v2 = Vertex{X: 1}  // Y:0 is implicit\n   v3 = Vertex{}      // X:0 and Y:0\n   p  = &amp;Vertex{1, 2} // has type *Vertex\n)\n\nfunc main() {\n   fmt.Println(v1, p, v2, v3)\n}\n</code></pre>\n\n<p>What's the difference between a struct with an ampersand and the one without? I know that the ones with ampersands point to the same reference,  but why should I use them over the regular ones?</p>\n\n<pre><code> var p = &amp;Vertex{} // why should I use this\n var c = Vertex{} // over this\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 5060713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d30b11af0eb88c04a20eefc89738f1ec?s=128&d=identicon&r=PG&f=1", "display_name": "moneyzmey", "link": "https://stackoverflow.com/users/5060713/moneyzmey"}, "edited": false, "score": 0, "creation_date": 1515316448, "post_id": 48135774, "comment_id": 83248767, "body": "Thank you so much!"}], "tags": [], "owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "is_accepted": true, "score": 6, "last_activity_date": 1515316631, "last_edit_date": 1515316631, "creation_date": 1515315987, "answer_id": 48135774, "question_id": 48135649, "link": "https://stackoverflow.com/questions/48135649/reflect-methodbyname-not-valid/48135774#48135774", "title": "Reflect (MethodByName) not valid", "body": "<p>Two things needs to be corrected. </p>\n\n<ol>\n<li>MethodByName() returns only Exported methods. So you have to rename <code>prnt</code> tp <code>Prnt</code></li>\n<li>Needs to pass a pointer of struct <code>test</code> to <code>reflect.ValueOf()</code> method.</li>\n</ol>\n\n<p>Here is the modified working code <a href=\"https://play.golang.org/p/4MK2kqOz6e2\" rel=\"nofollow noreferrer\">https://play.golang.org/p/4MK2kqOz6e2</a></p>\n"}], "owner": {"reputation": 135, "user_id": 5060713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d30b11af0eb88c04a20eefc89738f1ec?s=128&d=identicon&r=PG&f=1", "display_name": "moneyzmey", "link": "https://stackoverflow.com/users/5060713/moneyzmey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 2, "accepted_answer_id": 48135774, "answer_count": 1, "score": 2, "last_activity_date": 1515316631, "creation_date": 1515314740, "question_id": 48135649, "link": "https://stackoverflow.com/questions/48135649/reflect-methodbyname-not-valid", "title": "Reflect (MethodByName) not valid", "body": "<p>Problem at reflection, with MethodByName</p>\n\n<p>Code: </p>\n\n<pre><code>package main\n\nimport (\n    \"reflect\"\n    \"fmt\"\n)\n\ntype test struct {}\n\nvar serviceType = map[string]reflect.Value{\n    \"test\": reflect.ValueOf(test{}),\n}\n\nfunc (t *test) prnt()  {\n    fmt.Println(\"test ok\")\n}\n\nfunc callFunc(strct string, fName string)  {\n\n    s := serviceType[strct].MethodByName(fName)\n    if !s.IsValid(){\n        fmt.Println(\"not correct\")\n        return\n    }\n\n    s.Call(make([]reflect.Value,0))\n}\n\nfunc main()  {\n    callFunc(\"test\", \"prnt\")\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>not correct\n</code></pre>\n\n<p>Playground:\n<a href=\"https://play.golang.org/p/ZLEQBGYoUOB\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ZLEQBGYoUOB</a></p>\n\n<p>Could you help, what I'm doing wrong ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1515311412, "post_id": 48135103, "comment_id": 83247809, "body": "Pass <a href=\"https://golang.org/pkg/bufio/#ScanWords\" rel=\"nofollow noreferrer\">golang.org/pkg/bufio/#ScanWords</a> into <a href=\"https://golang.org/pkg/bufio/#Scanner.Split\" rel=\"nofollow noreferrer\">golang.org/pkg/bufio/#Scanner.Split</a> and then the scanner should scan the input by words."}, {"owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "edited": false, "score": 0, "creation_date": 1515313326, "post_id": 48135103, "comment_id": 83248146, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/33017547/golang-scan-a-line-of-numbers-from-sdin\">golang scan a line of numbers from sdin</a>"}, {"owner": {"reputation": 2221, "user_id": 7359810, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-8MngnLBsx3E/AAAAAAAAAAI/AAAAAAAAetc/OsGMMV3Set4/photo.jpg?sz=128", "display_name": "Neha", "link": "https://stackoverflow.com/users/7359810/neha"}, "reply_to_user": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "edited": false, "score": 0, "creation_date": 1515314459, "post_id": 48135103, "comment_id": 83248356, "body": "@Anuruddha It&#39;s not because here I&#39;m talking about fast input scanning."}, {"owner": {"reputation": 314, "user_id": 5716193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v9QW0.jpg?s=128&g=1", "display_name": "Amnon", "link": "https://stackoverflow.com/users/5716193/amnon"}, "edited": false, "score": 0, "creation_date": 1515357855, "post_id": 48135103, "comment_id": 83260580, "body": "give us some sample input"}], "answers": [{"tags": [], "owner": {"reputation": 314, "user_id": 5716193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v9QW0.jpg?s=128&g=1", "display_name": "Amnon", "link": "https://stackoverflow.com/users/5716193/amnon"}, "is_accepted": true, "score": 1, "last_activity_date": 1515358887, "creation_date": 1515358887, "answer_id": 48141494, "question_id": 48135103, "link": "https://stackoverflow.com/questions/48135103/fast-method-to-take-input-separated-by-space-golang/48141494#48141494", "title": "Fast method to take input separated by space [Golang]", "body": "<p>why not just try something like</p>\n\n<pre><code>func main()  {\n    scanner := bufio.NewScanner(os.Stdin)\n\n    for scanner.Scan() {\n        val, err := strconv.Atoi(scanner.Text())\n        if err != nil {\n            log.Fatal(err)\n        }\n        fmt.Println(val)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1515400627, "creation_date": 1515400627, "answer_id": 48146666, "question_id": 48135103, "link": "https://stackoverflow.com/questions/48135103/fast-method-to-take-input-separated-by-space-golang/48146666#48146666", "title": "Fast method to take input separated by space [Golang]", "body": "<p>The default <a href=\"https://golang.org/pkg/bufio/#Scanner\" rel=\"nofollow noreferrer\"><code>bufio.Scanner</code></a> (with the default split function) breaks the input into lines with line termination stripped. If you want to break the input into words, you have to set a different split function using the <a href=\"https://golang.org/pkg/bufio/#Scanner.Split\" rel=\"nofollow noreferrer\"><code>Scanner.Split()</code></a> method.</p>\n\n<p>There is a ready split function for breaking words: <a href=\"https://golang.org/pkg/bufio/#ScanWords\" rel=\"nofollow noreferrer\"><code>bufio.ScanWords()</code></a>. We can see this function commented in your code.</p>\n\n<p>But know that <code>Scanner.Split()</code> method expects a <em>function value</em>. You do not need to call the split function, the scanner will call it to break the input data. You just have to pass the function value, which you can do so without calling it, without appending <code>()</code> after the function name, e.g.:</p>\n\n<pre><code>scanner.Split(bufio.ScanWords)\n</code></pre>\n\n<p>Also note that you only have to do this once, and you can only do this once, before starting to scan the input, so move this line above the <code>for</code> loop:</p>\n\n<pre><code>var t int\nfmt.Scanf(\"%d\", &amp;t)\n\nscanner := bufio.NewScanner(os.Stdin)\nscanner.Split(bufio.ScanWords)\nfor o := 0; o &lt; t; o++ {\n    scanner.Scan()\n    val := toInt(scanner.Bytes())\n    fmt.Println(val)\n}\n</code></pre>\n\n<p>Now running the app, and entering the following lines:</p>\n\n<pre><code>3\n1 2 3\n</code></pre>\n\n<p>The output will be:</p>\n\n<pre><code>1\n2\n3\n</code></pre>\n\n<p>Also note that <a href=\"https://golang.org/pkg/bufio/#Scanner.Scan\" rel=\"nofollow noreferrer\"><code>Scanner.Scan()</code></a> returns a <code>bool</code> value indicating if scanning was successful and you may process the token. You should use this return value and not rely on the user inputting valid data.</p>\n"}, {"tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 1, "last_activity_date": 1515447461, "creation_date": 1515447461, "answer_id": 48158416, "question_id": 48135103, "link": "https://stackoverflow.com/questions/48135103/fast-method-to-take-input-separated-by-space-golang/48158416#48158416", "title": "Fast method to take input separated by space [Golang]", "body": "<p>Assuming the input is <code>3 65 65 65</code> and <code>3</code> is the number of following bytes, then this works:</p>\n\n<pre><code>func main() {\n    var t int\n    fmt.Scanf(\"%d\", &amp;t)\n    values := make([]byte, t)\n    buf := make([]interface{}, t)\n    for i := 0; i &lt; t; i++ {\n        buf[i] = &amp;values[i]\n    }\n    fmt.Scanln(buf...)\n\n    // test\n    fmt.Printf(\"%v\\n\", values)\n}\n</code></pre>\n\n<p>The <em>test</em> output is <code>[65 65 65]</code>.</p>\n"}], "owner": {"reputation": 2221, "user_id": 7359810, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-8MngnLBsx3E/AAAAAAAAAAI/AAAAAAAAetc/OsGMMV3Set4/photo.jpg?sz=128", "display_name": "Neha", "link": "https://stackoverflow.com/users/7359810/neha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1318, "favorite_count": 0, "accepted_answer_id": 48141494, "answer_count": 3, "score": 2, "last_activity_date": 1515447461, "creation_date": 1515309043, "last_edit_date": 1515314750, "question_id": 48135103, "link": "https://stackoverflow.com/questions/48135103/fast-method-to-take-input-separated-by-space-golang", "title": "Fast method to take input separated by space [Golang]", "body": "<p>I'm trying to take fast input through <code>scanner.Bytes</code> and I'm it converting to int. The problem is : input provided is single line spaced elements ( like an array ) and <code>scanner.Bytes</code> reads it as a whole and converts it into int. How can I use a Splitfunction on the bytes read!</p>\n\n<pre><code>func main()  {\n    scanner := bufio.NewScanner(os.Stdin)\n    var t int\n    fmt.Scanf(\"%d\", &amp;t)\n\n    for o := 0; o &lt; t; o++ {\n        scanner.Scan()\n        //scanner.Split(bufio.ScanWords())\n        val := toInt(scanner.Bytes())\n        fmt.Println(val)\n    }\n}\n\nfunc toInt(buf []byte) (n int) {\n    for _, v := range buf {\n        n = n*10 + int(v-'0')\n    }\n    return\n}\n</code></pre>\n"}, {"tags": ["go", "kubernetes", "microservices", "devops", "docker-container"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1515327276, "post_id": 48134800, "comment_id": 83251223, "body": "I see more than 10 questions, this is faaar too broad to be a single SO question."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515430374, "post_id": 48134800, "comment_id": 83288305, "body": "There&#39;s no real reason to use containers; for the most part, containers solve problems that Go apps don&#39;t have because Go binaries are already self-contained. That said... this question is both too broad and largely opinion-based. Try Reddit maybe."}, {"owner": {"reputation": 151, "user_id": 9113939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71546f5f49e093576d1460877cfbfadf?s=128&d=identicon&r=PG&f=1", "display_name": "gregory112", "link": "https://stackoverflow.com/users/9113939/gregory112"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515431487, "post_id": 48134800, "comment_id": 83288867, "body": "@Adrian exactly what i was thinking. Sorry, I&#39;m new to stackoverflow but i will try to ask more specific question next time. Btw, Reddit is blocked at my place so I&#39;m having a hard time accessing it because proxies are slow and inconvinient."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 4, "last_activity_date": 1515307608, "creation_date": 1515307608, "answer_id": 48134960, "question_id": 48134800, "link": "https://stackoverflow.com/questions/48134800/deploying-go-apps-with-micro-service-architecture-in-containers-or-not-in-contai/48134960#48134960", "title": "Deploying Go apps with micro-service architecture in containers or not in containers?", "body": "<blockquote>\n  <p>I'm wondering if go applications should or should not be deployed in containers (Docker)<br>\n  Why should I deploy and run those binaries inside containers like Docker?</p>\n</blockquote>\n\n<p>Of course, provided you separate the build from the actual final image (in order to not include in said final image build dependencies)<br>\nSee \"<a href=\"https://made2591.github.io/posts/goa-docker-multistage\" rel=\"nofollow noreferrer\">Golang, Docker and multistage build</a>\" from <strong><a href=\"https://made2591.github.io/about/\" rel=\"nofollow noreferrer\">Matteo Madeddu</a></strong>.</p>\n\n<blockquote>\n  <p>Can I deploy these servers together in one host running on different ports?</p>\n</blockquote>\n\n<p>Actually, they could all run in their own container on their own port, even if that port is the same.<br>\nIntra-container communication will work, using <strong><a href=\"https://docs.docker.com/engine/reference/builder/#expose\" rel=\"nofollow noreferrer\">EXPOSEd port</a></strong>.\nHowever, if they are accessed from outside, then their <a href=\"https://docs.docker.com/engine/reference/run/#expose-incoming-ports\" rel=\"nofollow noreferrer\"><em>published</em> port</a> need to be different indeed.</p>\n\n<blockquote>\n  <p>What about scalibility and high availability without using Docker?<br>\n  And what about the scalability and availability of using Docker?</p>\n</blockquote>\n\n<p>As soon as you are talking about dynamic status, some kind of orchestration will be involved: see <a href=\"https://docs.docker.com/engine/swarm/\" rel=\"nofollow noreferrer\">Docker Swarm</a> or <a href=\"https://kubernetes.io/\" rel=\"nofollow noreferrer\">Kubernetes</a> for efficient cluster management.<br>\n<a href=\"https://blog.docker.com/2017/12/kubernetes-in-docker-ee/\" rel=\"nofollow noreferrer\">Both are available with the latest docker</a>.</p>\n\n<p>Examples:</p>\n\n<ul>\n<li>\"<a href=\"https://medium.com/wattpad-engineering/building-and-testing-go-apps-monorepo-speed-9e9ca4978e19\" rel=\"nofollow noreferrer\"><strong>Building and testing Go apps + monorepo + speed</strong></a>\": Or, how we test and build go code in a monorepo, with TravisCI, and deploy to Docker, quickly and easily. From <strong><a href=\"https://twitter.com/jharlap\" rel=\"nofollow noreferrer\">Jonathan Harlap</a></strong>, Principal Engineer @ Wattpad</li>\n<li>\"<a href=\"https://blog.alexellis.io/introducing-functions-as-a-service/\" rel=\"nofollow noreferrer\"><strong>Introducing Functions as a Service (OpenFaaS)</strong></a>\", from <strong><a href=\"https://twitter.com/alexellisuk\" rel=\"nofollow noreferrer\">Alex Ellis</a></strong></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 6967, "user_id": 7803650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WH7uu.png?s=128&g=1", "display_name": "Oswin Noetzelmann", "link": "https://stackoverflow.com/users/7803650/oswin-noetzelmann"}, "is_accepted": false, "score": 1, "last_activity_date": 1515481956, "creation_date": 1515481956, "answer_id": 48163027, "question_id": 48134800, "link": "https://stackoverflow.com/questions/48134800/deploying-go-apps-with-micro-service-architecture-in-containers-or-not-in-contai/48163027#48163027", "title": "Deploying Go apps with micro-service architecture in containers or not in containers?", "body": "<p>VonCs answer is great. I'd just like to add one thing: Golang is perfect for containers because it has built in support for self-sustained binaries. And that means you can build containers that are just the size of a few MB instead of the typical containers with alpine etc. that are often hundreds of MB.</p>\n\n<p>Check out this <a href=\"https://blog.codeship.com/building-minimal-docker-containers-for-go-applications/\" rel=\"nofollow noreferrer\">read</a>. </p>\n"}], "owner": {"reputation": 151, "user_id": 9113939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71546f5f49e093576d1460877cfbfadf?s=128&d=identicon&r=PG&f=1", "display_name": "gregory112", "link": "https://stackoverflow.com/users/9113939/gregory112"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 1, "accepted_answer_id": 48134960, "answer_count": 2, "score": 3, "last_activity_date": 1515481956, "creation_date": 1515305706, "last_edit_date": 1515445178, "question_id": 48134800, "link": "https://stackoverflow.com/questions/48134800/deploying-go-apps-with-micro-service-architecture-in-containers-or-not-in-contai", "title": "Deploying Go apps with micro-service architecture in containers or not in containers?", "body": "<p>I'm new to DevOps specifically using golang and microservice architecture.</p>\n\n<p>I'm wondering if go applications should or should not be deployed in containers (Docker). In this case, I have a system built with micro-service architecture. For example here, I have 2 web services, A and B. Also I have another web server acts as a gateway in front of those two.</p>\n\n<p>Both A and B need access for a database, MySQL for example. A handles table A, and B handles table B.</p>\n\n<p>I know that in Go, source codes are compiled into a single executable binary file. And because I have 3 services here, I have 3 binaries. All three run as web server exposing JSON REST API.</p>\n\n<p>My questions are these:</p>\n\n<ul>\n<li><p><strong>Can I deploy these servers together in one host running on different ports?</strong>\nIf my host get an IP x.x.x.x for example, my gateway can run in x.x.x.x:80, A in port 81, and B in port 82 for example. A and B will talk to a MySQL server somewhere outside or maybe inside the same host. Is this a good practice? Can Continuous Deployment works with this practice?</p></li>\n<li><p><strong>Why should I deploy and run those binaries inside containers like Docker?</strong>\nI know that since its release few years ago, Docker had found its way to be integrated inside a development workflow easily. But of course using Docker is not as simple as just compiling the code into a binary and then moving it to a deployment server. Using Docker we have to put the executable inside the container and then move the container as well to the deployment server.</p></li>\n<li><p><strong>What about scalibility and high availability without using Docker?</strong>\nCan I just replicate my services and run them all at once in different hosts using a load balancer? This way I should deploy A, B, and gateway in one host, and another A, B, and gateway in another host, then setup load balancer in front of them. A, B, and the gateway runs in port 80, 81, and 82 respectively. This way I could have  thousands of nodes in a form of VMs or LXD containers maybe, spread accross hundreds of bare metals, deployed with a simple bash script and ssh, or Ansible if things get complex. Yes or no?</p></li>\n<li><p><strong>And what about the scalability and availability of using Docker?</strong>\nShould I just put all my services inside containers and manage them with something like Kubernetes to achieve high availability? Doing this does add overhead, right? Because the team will have to learn new technology like Kubernetes if they haven't known it yet.</p></li>\n<li><p>Can you give me an example of some best practices of deploying golang services?</p></li>\n</ul>\n"}, {"tags": ["amazon-web-services", "go", "amazon-rds"], "comments": [{"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1515298306, "post_id": 48134122, "comment_id": 83245766, "body": "IAM Auth <a href=\"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.html\" rel=\"nofollow noreferrer\">seems to require an SSL connection to the db</a>.  It&#39;s not clear whether you are doing that."}, {"owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "edited": false, "score": 0, "creation_date": 1515311016, "post_id": 48134122, "comment_id": 83247746, "body": "What&#39;s the version of the AWS SDK you use? Seems like there was a related issue in SDK which fixed now <a href=\"https://github.com/aws/aws-sdk-go/issues/1248\" rel=\"nofollow noreferrer\">github.com/aws/aws-sdk-go/issues/1248</a>"}, {"owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "edited": false, "score": 0, "creation_date": 1515317442, "post_id": 48134122, "comment_id": 83248993, "body": "@JulieNoobie Can you post the connection error which you are seeing?"}, {"owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "reply_to_user": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "edited": false, "score": 0, "creation_date": 1515327576, "post_id": 48134122, "comment_id": 83251284, "body": "@Anuruddha Hey! I&#39;m using the latest version. I&#39;m pinging the connection and I receive an error. When I&#39;m not using the authtoken, no error will be noticed."}, {"owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1515329152, "post_id": 48134122, "comment_id": 83251666, "body": "@Michael-sqlbot hey, I have not added TLS to the connection and I&#39;m still getting this error: ERROR: Error 1045: Access denied for user &#39;master&#39;@&#39;x.x.x.189&#39; (using password: YES)"}, {"owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "edited": false, "score": 1, "creation_date": 1515344022, "post_id": 48134122, "comment_id": 83256358, "body": "Please help me :("}, {"owner": {"reputation": 712, "user_id": 8868419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a530d27369c9d4f6ecf421fe83d2b4?s=128&d=identicon&r=PG&f=1", "display_name": "Madeo", "link": "https://stackoverflow.com/users/8868419/madeo"}, "edited": false, "score": 0, "creation_date": 1616461916, "post_id": 48134122, "comment_id": 118004693, "body": "Same issue here, where you be able to resolve it?"}], "owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1526142827, "creation_date": 1515296389, "last_edit_date": 1526142827, "question_id": 48134122, "link": "https://stackoverflow.com/questions/48134122/cannot-connect-to-rds-using-rdsutils-buildauthtoken", "title": "Cannot connect to RDS using rdsutils.BuildAuthToken", "body": "<p>I followed every step in <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/rds/rdsutils/#BuildAuthToken\" rel=\"nofollow noreferrer\">the official documentation</a> and used the exact same code snippet.</p>\n\n<p>When I replace the authToken with a hard-coded password, then the connection will become successful. </p>\n\n<p>I have assigned the User Programmatic access, but no policies.</p>\n\n<pre><code>//Yes Env vars are available\n//creating new credentials from environment variables\n//AWS_ACCESS_KEY_ID  and  AWS_SECRET_ACCESS_KEY\nawsCreds := credentials.NewEnvCredentials()\n\n//creating authentication token for the database connection\nauthToken, err := rdsutils.BuildAuthToken(dbEndpoint, awsRegion, dbUser, awsCreds)\nif err != nil {\n    Logger.LogFatal(\"Unable to build Authentication Token\")\n    log.Fatal(\"Unable to build Authentication Token\")  //todo remove\n}\n\n//setting up TLS\nmysql.RegisterTLSConfig(\"custom\", &amp;tls.Config{\n    InsecureSkipVerify: true,\n})\n\n// Creating the MySQL DNS string for the DB connection\n// user:password@protocol(endpoint)/dbname?&lt;params&gt;\ndnsStr := fmt.Sprintf(\"%s:%s@tcp(%s:%s)/%s?tls=custom\",\n    dbUser, authToken, dbEndpoint,dbPort, dbName,\n)\ndatabase, err = sql.Open(\"mysql\", dnsStr)\n</code></pre>\n\n<p>I'm still trying to fix this. This is the error message I get:</p>\n\n<pre><code>error: ERROR: Error 1045: Access denied for user 'master'@'x.x.x.189' (using password: YES)\n</code></pre>\n"}, {"tags": ["http", "go", "gorilla"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1515282823, "post_id": 48132955, "comment_id": 83243357, "body": "<code>Walk</code> is a blocking call, there\u2019s nothing to wait for."}], "answers": [{"tags": [], "owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1515395561, "creation_date": 1515395561, "answer_id": 48145744, "question_id": 48132955, "link": "https://stackoverflow.com/questions/48132955/sending-the-result-of-mux-walk-to-responsewriter/48145744#48145744", "title": "Sending the result of mux.Walk to ResponseWriter", "body": "<blockquote>\n  <p>Since the Walk function takes an anonymous function, how can I make\n  the handler wait until all the paths are calculated and entered into\n  my array which I can send out?</p>\n</blockquote>\n\n<p>The output of the <code>Walk</code> function does not change, since you'll eventually end up with a static binary. In other words, you only need to get the ouput of the <code>Walk</code> function once.</p>\n\n<blockquote>\n  <p>If not waiting, is there a more efficient way of doing this?</p>\n</blockquote>\n\n<p>Have a look at the <a href=\"https://github.com/gorilla/mux#walking-routes\" rel=\"nofollow noreferrer\">sample code</a> provided in the official github repository.</p>\n\n<p>You can build your response for <code>walk</code> after the routes are first initialised, store this response locally, and return it once you receive a request for the available endpoints.</p>\n"}], "owner": {"reputation": 835, "user_id": 937660, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3d3f3a4b18a2410a122a9fb7ddb05d20?s=128&d=identicon&r=PG", "display_name": "Mohit Athwani", "link": "https://stackoverflow.com/users/937660/mohit-athwani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1515395561, "creation_date": 1515281621, "question_id": 48132955, "link": "https://stackoverflow.com/questions/48132955/sending-the-result-of-mux-walk-to-responsewriter", "title": "Sending the result of mux.Walk to ResponseWriter", "body": "<p>This is the first time I am writing any golang code and am building a basic web api. What I want to do is whenever a request is received on <code>\"/\"</code> path, I want to write out all the paths of <code>mux.Walk()</code> to my <code>ResponseWriter</code>. Since the <code>Walk</code> function takes an anonymous function, how can I make the handler wait until all the paths are calculated and entered into my array which I can send out? If not waiting, is there a more efficient way of doing this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515270107, "post_id": 48131439, "comment_id": 83240078, "body": "Can you check the full list by running <code>set | more</code> in <code>cmd.exe</code>. If they&#39;re there, try running your Go binary through the terminal too. You can also try <a href=\"https://golang.org/pkg/os/#LookupEnv\" rel=\"nofollow noreferrer\">os.LookupEnv</a> and print both returned args."}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 5, "creation_date": 1515270714, "post_id": 48131439, "comment_id": 83240278, "body": "And here is your standard suggestion from helpdesk: restart your PC :)"}, {"owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "edited": false, "score": 0, "creation_date": 1515270754, "post_id": 48131439, "comment_id": 83240292, "body": "Just checked the list and they are there. Also tried to run it through terminal"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1515270943, "post_id": 48131439, "comment_id": 83240367, "body": "Yeah, it&#39;s unclear: <a href=\"https://serverfault.com/questions/8855/how-do-you-add-a-windows-environment-variable-without-rebooting\" title=\"how do you add a windows environment variable without rebooting\">serverfault.com/questions/8855/&hellip;</a>, but this being windows, I would follow @Ain&#39;s suggestion."}], "answers": [{"comments": [{"owner": {"reputation": 9968, "user_id": 114900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZGjf9.jpg?s=128&g=1", "display_name": "msanford", "link": "https://stackoverflow.com/users/114900/msanford"}, "edited": false, "score": 0, "creation_date": 1555597989, "post_id": 48131778, "comment_id": 98173417, "body": "FYI Simply logging out and back in should also work."}, {"owner": {"reputation": 193, "user_id": 4779929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f77764f289a02f1f2802237e15e2a8?s=128&d=identicon&r=PG&f=1", "display_name": "Anan Raddad", "link": "https://stackoverflow.com/users/4779929/anan-raddad"}, "reply_to_user": {"reputation": 9968, "user_id": 114900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZGjf9.jpg?s=128&g=1", "display_name": "msanford", "link": "https://stackoverflow.com/users/114900/msanford"}, "edited": false, "score": 0, "creation_date": 1588774791, "post_id": 48131778, "comment_id": 109028912, "body": "@msanford i don&#39;t think that works, at least for me. i needed to restart."}, {"owner": {"reputation": 9968, "user_id": 114900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZGjf9.jpg?s=128&g=1", "display_name": "msanford", "link": "https://stackoverflow.com/users/114900/msanford"}, "reply_to_user": {"reputation": 193, "user_id": 4779929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f77764f289a02f1f2802237e15e2a8?s=128&d=identicon&r=PG&f=1", "display_name": "Anan Raddad", "link": "https://stackoverflow.com/users/4779929/anan-raddad"}, "edited": false, "score": 1, "creation_date": 1588782790, "post_id": 48131778, "comment_id": 109033958, "body": "@AnanRaddad I should have specified that this only works for user-scope environment variables. Unfortunately OP set a system-scope variable. OP, <b>don&#39;t do that</b> put it in the user scope. Putting it in the global system scope means any app can read them, which is bad for credentials."}], "tags": [], "owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "is_accepted": true, "score": 4, "last_activity_date": 1515271809, "creation_date": 1515271809, "answer_id": 48131778, "question_id": 48131439, "link": "https://stackoverflow.com/questions/48131439/unable-to-receive-environment-variables-in-golang-and-windows-10/48131778#48131778", "title": "Unable to receive environment variables in Golang and Windows 10", "body": "<p>Restarted my pc. Now, it works fine.</p>\n"}], "owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3042, "favorite_count": 0, "accepted_answer_id": 48131778, "answer_count": 1, "score": 3, "last_activity_date": 1522528741, "creation_date": 1515269377, "last_edit_date": 1522528741, "question_id": 48131439, "link": "https://stackoverflow.com/questions/48131439/unable-to-receive-environment-variables-in-golang-and-windows-10", "title": "Unable to receive environment variables in Golang and Windows 10", "body": "<p>I have set a couple of environment variables in Windows 10, but I cannot receive them in Golang and I just can't find out why.</p>\n\n<p><a href=\"https://i.stack.imgur.com/olVLQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/olVLQ.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>dbUser := os.Getenv(\"DB_USER\")\ndbName := os.Getenv(\"DB_NAME\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/MhSXN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MhSXN.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["linux", "go", "io", "low-level-io"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4041508, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4hxHt_CeVoI/AAAAAAAAAAI/AAAAAAAAACQ/odd2WHJC7wM/photo.jpg?sz=128", "display_name": "Adrian Challinor", "link": "https://stackoverflow.com/users/4041508/adrian-challinor"}, "edited": false, "score": 0, "creation_date": 1515268620, "post_id": 48131099, "comment_id": 83239596, "body": "Oh,  I do agree. For reference, I used to write device drives on VMS in days long ago, and I know that there is a lot more than dumping raw values.I was involved in writing a driver to make a Cray XMP appear as a peripheral on the VAX. I miss my low level stuff!   I just wanted to get started on some simple test cases and hit a brick wall. I know it&#39;s all &#39;unsafe&#39;, but then I am writing for a specific use case, on specific hardware configuration. Portability is not my issue.   Thanks for the reply, and so fast."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1515445373, "post_id": 48131099, "comment_id": 83295416, "body": "The portability is important, btw.  The size of those structures will change depending on 32 or 64-bit architecture, and the ordering and padding of those structures is not guaranteed to be the same between Go versions or the target OS/architecture for the compilation.  This really is a terribly bug-prone practice.  There&#39;s a <i>reason</i> Go doesn&#39;t let you muck with memory directly or do C things like pointer arithmetic.  It causes super brittle and buggy code that&#39;s insanely difficult to debug."}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": false, "score": 3, "last_activity_date": 1515311178, "last_edit_date": 1515311178, "creation_date": 1515267171, "answer_id": 48131099, "question_id": 48130984, "link": "https://stackoverflow.com/questions/48130984/golang-write-struct-as-raw-data/48131099#48131099", "title": "golang write struct as raw data", "body": "<p>Big warning first: <strong>don't do it: it is neither safe nor portable</strong></p>\n\n<p>For a given struct, you can reflect over it to figure out the in-memory size of the actual struct, then unsafely cast it to a <code>[]byte</code> using <code>unsafe</code>.</p>\n\n<p>eg: <code>(*[in-mem size]byte)(unsafe.Pointer(&amp;mystruct))</code></p>\n\n<p>This will give you something C-ish with absolutely no safety guarantees or portability.</p>\n\n<p>I'll quote the <a href=\"https://golang.org/ref/spec#Package_unsafe\" rel=\"nofollow noreferrer\">Go spec</a>:</p>\n\n<blockquote>\n  <p>A package using unsafe must be vetted manually for type safety and may\n  not be portable.</p>\n</blockquote>\n\n<p>You can find a lot more details in this <a href=\"https://syslog.ravelin.com/go-and-memory-layout-6ef30c730d51\" rel=\"nofollow noreferrer\">Go and Memory layout</a> post, including all the steps you need to unsafely treat structs as just bytes.</p>\n\n<p>Overall, it's fascinating to examine how Go functions on a low level, but this is absolutely the wrong thing to do in your case. Any real data infrastructure will need storage logic way more complicated than just dumping in-memory structs to disk anyway.</p>\n"}, {"tags": [], "owner": {"reputation": 7430, "user_id": 2105930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e884c31250cf768e8b8261e31cd0821?s=128&d=identicon&r=PG", "display_name": "chowey", "link": "https://stackoverflow.com/users/2105930/chowey"}, "is_accepted": false, "score": 2, "last_activity_date": 1515271602, "creation_date": 1515271602, "answer_id": 48131750, "question_id": 48130984, "link": "https://stackoverflow.com/questions/48130984/golang-write-struct-as-raw-data/48131750#48131750", "title": "golang write struct as raw data", "body": "<p>In general, you cannot do raw IO of a Go struct (i.e. memdump). This is because many things in Go contain pointers, and the actual data is not contiguous in memory.</p>\n\n<p>For example, a struct like this:</p>\n\n<pre><code>type Person struct {\n    Name string\n}\n</code></pre>\n\n<p>contains a string, which in turn <a href=\"https://golang.org/pkg/reflect/#StringHeader\" rel=\"nofollow noreferrer\">contains a pointer</a> to the bytes of the string. A raw memdump would only dump the pointer.</p>\n\n<p>The solution is serialization. This is never free, although some implementations do a pretty good job.</p>\n\n<p>The closest to what you are describing is something like <a href=\"https://github.com/alexflint/go-memdump\" rel=\"nofollow noreferrer\">go-memdump</a>, but I wouldn't recommend it for production.</p>\n\n<p>Otherwise, I recommend looking at a <a href=\"https://github.com/alecthomas/go_serialization_benchmarks\" rel=\"nofollow noreferrer\">performant serialization technique</a>. (Go's gob encoding is not the best.)</p>\n"}, {"tags": [], "owner": {"reputation": 314, "user_id": 5716193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v9QW0.jpg?s=128&g=1", "display_name": "Amnon", "link": "https://stackoverflow.com/users/5716193/amnon"}, "is_accepted": false, "score": 0, "last_activity_date": 1515446042, "creation_date": 1515446042, "answer_id": 48158155, "question_id": 48130984, "link": "https://stackoverflow.com/questions/48130984/golang-write-struct-as-raw-data/48158155#48158155", "title": "golang write struct as raw data", "body": "<blockquote>\n  <p>...Or am I going to have to handle GOBs as my unit of IO and suffer the penalty for encoding/decoding?</p>\n</blockquote>\n\n<p>Just use GOBs. \nPremature optimization is the root of all evil.</p>\n"}], "owner": {"reputation": 9, "user_id": 4041508, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4hxHt_CeVoI/AAAAAAAAAAI/AAAAAAAAACQ/odd2WHJC7wM/photo.jpg?sz=128", "display_name": "Adrian Challinor", "link": "https://stackoverflow.com/users/4041508/adrian-challinor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1461, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1515446042, "creation_date": 1515266444, "question_id": 48130984, "link": "https://stackoverflow.com/questions/48130984/golang-write-struct-as-raw-data", "title": "golang write struct as raw data", "body": "<p>I am working on a new type of database, using GO. One of the things I would like to do is have a distributed disk so that I can distribute queries over multiple machines (think Pi type architectures). This means building my own structures on raw disk. </p>\n\n<p>My challenge is that I can't find a GO package that will let me write N bytes from a pointer to a structure. All the IO packages limit the access to []byte slices.</p>\n\n<p>That's nice for protection, but if I have to buffer everything through a byte array via some form of encoding it will slow down the access to a specific object. </p>\n\n<p>Anyone got any idea on how to do raw IO? Or am I going to have to handle GOBs as my unit of IO and suffer the penalty for encoding/decoding?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1515265406, "post_id": 48130731, "comment_id": 83238499, "body": "<code>len(n.M)</code> and <code>... := range n.M</code>. No other way without redefining the methods on <code>N</code> or converting it to <code>M</code> before using the methods."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1515265770, "post_id": 48130731, "comment_id": 83238610, "body": "Actually aliases might work <a href=\"https://play.golang.org/p/ErTfzQ_Mbvj\" rel=\"nofollow noreferrer\">play.golang.org/p/ErTfzQ_Mbvj</a> , although i&#39;m not sure they were meant to be used for that..."}, {"owner": {"reputation": 573, "user_id": 1461482, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5705236c7b4c1258ea03199dee58f841?s=128&d=identicon&r=PG", "display_name": "Riyaz Mansoor", "link": "https://stackoverflow.com/users/1461482/riyaz-mansoor"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1515266006, "post_id": 48130731, "comment_id": 83238686, "body": "aliases work, for len/range BUT then I lost the methods :)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1515268498, "post_id": 48130731, "comment_id": 83239560, "body": "Actually with <a href=\"https://golang.org/ref/spec#Alias_declarations\" rel=\"nofollow noreferrer\">aliases</a> you don&#39;t lose the methods and you also can use len/range on the alias, but you cannot add new methods to it. Its intended for refactoring I believe. Note that aliases have <code>=</code> between the identifiers. <code>type N = M</code> is an alias, <code>type N M</code> is not an alias, although I&#39;m not sure what you would call it."}], "answers": [{"comments": [{"owner": {"reputation": 573, "user_id": 1461482, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5705236c7b4c1258ea03199dee58f841?s=128&d=identicon&r=PG", "display_name": "Riyaz Mansoor", "link": "https://stackoverflow.com/users/1461482/riyaz-mansoor"}, "edited": false, "score": 0, "creation_date": 1515265939, "post_id": 48130860, "comment_id": 83238664, "body": "Thanks. That did it. Maybe because I&#39;m new to Go, but that does not seem intuitive."}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 2, "last_activity_date": 1515265642, "creation_date": 1515265642, "answer_id": 48130860, "question_id": 48130731, "link": "https://stackoverflow.com/questions/48130731/go-golang-embedding-types-and-len-range/48130860#48130860", "title": "Go Golang - embedding types and &quot;len/range&quot;", "body": "<p>Ignoring packages (they don't matter in this scenario), you need to specify a valid type for the builtins <code>len</code> and <code>range</code>:</p>\n\n<pre><code>type M map[int]int\n\nfunc (m *M) SayHi() {\n    fmt.Println(\"Hi!\")\n}\n\ntype N struct{ M }\n\nfunc main() {\n    var foo N\n    fmt.Println(len(foo.M))\n    for k, v := range foo.M {\n        fmt.Printf(\"%d: %d\\n\", k, v)\n    }\n    foo.SayHi()\n}\n</code></pre>\n\n<p><code>foo.SayHi()</code> works because <code>SayHi</code> is promoted to <code>struct N</code>.</p>\n\n<p>However, <code>len</code> and <code>range</code> are not methods on <code>M</code>, they are builtins that expect specific types. Embedding does not change the type, it promotes methods from the embedded field to the container struct.</p>\n\n<p>You can read more about the details in the <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">Go spec</a> and <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">Effective Go</a>.</p>\n"}], "owner": {"reputation": 573, "user_id": 1461482, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5705236c7b4c1258ea03199dee58f841?s=128&d=identicon&r=PG", "display_name": "Riyaz Mansoor", "link": "https://stackoverflow.com/users/1461482/riyaz-mansoor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 48130860, "answer_count": 1, "score": 1, "last_activity_date": 1515265642, "creation_date": 1515264787, "question_id": 48130731, "link": "https://stackoverflow.com/questions/48130731/go-golang-embedding-types-and-len-range", "title": "Go Golang - embedding types and &quot;len/range&quot;", "body": "<pre><code>package m\ntype M map[int]int\n// have methods on M\n// can use len and range on M\n\npackage n\n// need methods of M\ntype N struct { M }\n// methods available\n// BUT cannot use len or range on N\n// if \" type N M \" - I lose the methods on M\n</code></pre>\n\n<p>Need the methods of M and len/range functionality in a different package. How can this be done ?</p>\n"}, {"tags": ["go", "testing", "credentials"], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 0, "last_activity_date": 1515262869, "creation_date": 1515262869, "answer_id": 48130451, "question_id": 48130143, "link": "https://stackoverflow.com/questions/48130143/passing-database-credentials-to-tests-in-go/48130451#48130451", "title": "Passing database credentials to tests in go?", "body": "<p>Environment variables tend to be best for this for the following reasons:</p>\n\n<ul>\n<li>easier to set in your local environment persistently</li>\n<li>most test infrastructure allows you to specify environment variables, and often has ways to mark them as \"sensitive\" (not visible after being set) and can be restricted by build type (to void leaking credentials to contributors)</li>\n<li>environment variables are not visible in process listing/logs (unless intentionally listed). command-line flags are.</li>\n<li>works with anything, not just go. (eg: if you need AWS credentials, the same settings will work for most AWS libraries).</li>\n</ul>\n\n<p>But overall, this is too broad a question. The ultimate answer depends on the people working on the project with a daily need to run tests. It also depends massively on your test infrastructure.</p>\n\n<p>And finally: if this is for unittests, you shouldn't need database credentials, external services should be mocked. You also don't want contributors to need database credentials to run unittests.</p>\n\n<p>If this is for integration tests, your test infrastructure will be the most important factor.</p>\n"}], "owner": {"reputation": 1472, "user_id": 282882, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/064cf2ac71f78d338e73dda6485b2477?s=128&d=identicon&r=PG", "display_name": "rzajac", "link": "https://stackoverflow.com/users/282882/rzajac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1551, "favorite_count": 0, "accepted_answer_id": 48130451, "answer_count": 1, "score": 0, "last_activity_date": 1538568745, "creation_date": 1515260972, "last_edit_date": 1538568745, "question_id": 48130143, "link": "https://stackoverflow.com/questions/48130143/passing-database-credentials-to-tests-in-go", "title": "Passing database credentials to tests in go?", "body": "<p>I have tried couple of approaches (shown below) but I don't like any of them. So I decided to ask the community if there is a better way to do it.</p>\n\n<p><strong>Approach 1</strong></p>\n\n<p>Pass database credentials as arguments:</p>\n\n<pre><code>go test -args -db_user=test -db_pass=secret\n</code></pre>\n\n<p>Then use it in tests as:</p>\n\n<pre><code>package my_test\nvar dbUser = flag.String(\"db_user\", \"\", \"test database user\")\nvar dbPass = flag.String(\"db_pass\", \"\", \"test database password\")\n\nfunc TestSomething(t *testing.T) {\n    db := open(*dbUser, *dbPass)\n}\n</code></pre>\n\n<p><strong>Approach 2</strong></p>\n\n<p>Set environment variables before running tests:</p>\n\n<pre><code>$ export TEST_DB_USER=user\n$ export TEST_DB_PASS=secret\n$ go test\n</code></pre>\n\n<p>or </p>\n\n<pre><code>$ TEST_DB_USER=user TEST_DB_PASS=secret go test -v\n</code></pre>\n\n<p>Then use it in tests as:</p>\n\n<pre><code>package my_test\nvar dbUser = flag.String(\"db_user\", \"\", \"test database user\")\nvar dbPass = flag.String(\"db_pass\", \"\", \"test database password\")\n\nfunc TestSomething(t *testing.T) {\n    db := open(os.Getenv(\"TEST_DB_USER\"), os.Getenv(\"TEST_DB_PASS\"))\n}\n</code></pre>\n\n<p><strong>Approach 3</strong></p>\n\n<p>Use <code>.env.test</code> file and <code>github.com/joho/godotenv</code> package to load database connection credentials before running tests.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": false, "score": 0, "last_activity_date": 1515249277, "creation_date": 1515249277, "answer_id": 48128393, "question_id": 48128313, "link": "https://stackoverflow.com/questions/48128313/i-am-getting-index-out-of-range-error-on-running-the-below-code/48128393#48128393", "title": "i am getting index out of range error on running the below code", "body": "<p><code>len(copy_numbers)</code> is zero because <code>copy</code> will only copy <code>min(len(src), len(dst))</code> elements and <code>copy_numbers</code> length is zero.</p>\n\n<p>Use this line to define a bigger <code>copy_numbers</code> so <code>copy</code> does what you want:</p>\n\n<pre><code>copy_numbers[] := make([]int, len(numbers))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 0, "last_activity_date": 1515249475, "creation_date": 1515249475, "answer_id": 48128424, "question_id": 48128313, "link": "https://stackoverflow.com/questions/48128313/i-am-getting-index-out-of-range-error-on-running-the-below-code/48128424#48128424", "title": "i am getting index out of range error on running the below code", "body": "<p><code>copy_numbers</code> is of size 0, just as you initialized it.</p>\n\n<p>If I add the following before your first for loop:</p>\n\n<pre><code>fmt.Println(numbers)\nfmt.Println(copy_numbers)\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>[5 2 3 5 3]\n[]\n</code></pre>\n\n<p>the <a href=\"https://golang.org/pkg/builtin/#copy\" rel=\"nofollow noreferrer\">copy</a> builtin copies up to the length of either argument, as mentioned in the docs:</p>\n\n<blockquote>\n  <p>Copy returns the number of elements copied, which will be the minimum\n  of len(src) and len(dst).</p>\n</blockquote>\n\n<p>You should initialize <code>copy_numbers</code> to be of the same length as <code>numbers</code></p>\n\n<pre><code>  copy_numbers := make([]int, len(numbers))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1855, "user_id": 1558705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1563795271fe55bf0beab2d12cd69b0?s=128&d=identicon&r=PG", "display_name": "Dean Elbaz", "link": "https://stackoverflow.com/users/1558705/dean-elbaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1515249532, "creation_date": 1515249532, "answer_id": 48128431, "question_id": 48128313, "link": "https://stackoverflow.com/questions/48128313/i-am-getting-index-out-of-range-error-on-running-the-below-code/48128431#48128431", "title": "i am getting index out of range error on running the below code", "body": "<p>From the documentaion:</p>\n\n<blockquote>\n  <p>The copy built-in function copies elements from a source slice into a destination slice. (As a special case, it also will copy bytes from a string to a slice of bytes.) The source and destination may overlap. Copy returns the number of elements copied, which will be the minimum of len(src) and len(dst).</p>\n</blockquote>\n\n<p>in your case, the destination is <code>copy_numbers</code>, which is an uninitialized slice. To initialize it, and have enough space to hold a copy of <code>numbers</code> you can simply do</p>\n\n<p><code>copy_numbers := make([]int, len(numbers)\n</code></p>\n"}, {"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 0, "last_activity_date": 1515249552, "creation_date": 1515249552, "answer_id": 48128433, "question_id": 48128313, "link": "https://stackoverflow.com/questions/48128313/i-am-getting-index-out-of-range-error-on-running-the-below-code/48128433#48128433", "title": "i am getting index out of range error on running the below code", "body": "<p>The issue is with the way you've used <code>copy</code>. From the <a href=\"https://golang.org/pkg/builtin/#copy\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>Copy returns the number of elements copied, which will be the minimum\n  of len(src) and len(dst).</p>\n</blockquote>\n\n<p>The manner in which you are creating <code>copy_numbers</code> initializes it with a zero length.</p>\n\n<pre><code>var copy_numbers []int // len(copy_numbers) == 0\n</code></pre>\n\n<p>This causes <code>copy</code> to not copy a single element from <code>numbers</code>.</p>\n\n<p>To fix this, you can change <code>copy_numbers</code> initialization to:</p>\n\n<pre><code>copy_numbers := make([]int, len(numbers))\n</code></pre>\n\n<p>The rest of the code should work.</p>\n"}], "owner": {"reputation": 61, "user_id": 7713615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a742ca0d59238b91e47c0906b511d5b?s=128&d=identicon&r=PG&f=1", "display_name": "praveen", "link": "https://stackoverflow.com/users/7713615/praveen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 48128424, "answer_count": 4, "score": -6, "last_activity_date": 1515249552, "creation_date": 1515248728, "question_id": 48128313, "link": "https://stackoverflow.com/questions/48128313/i-am-getting-index-out-of-range-error-on-running-the-below-code", "title": "i am getting index out of range error on running the below code", "body": "<p>i having the following code to print the indexes of an array which contains similar values.</p>\n\n<p>but on running this code getting panic: indexes out of range run time error</p>\n\n<p>why i am getting this</p>\n\n<p>package main</p>\n\n<pre><code>import \"fmt\"\n\nfunc main()  {\n    var numbers[] int = [] int {5,2,3,5,3}\n    var copy_numbers[] int\n    var count [5] int\n    var i,j int\n    copy(copy_numbers,numbers)\n    for i=0;i&lt;len(numbers);i++ {\n        for j=0;j&lt;len(numbers) ;j++  {\n            if numbers[i]==numbers[j] {\n                count[i]++;\n            }\n        }\n    }\n    fmt.Printf(\"%d\",count)\n\n    for i=0;i&lt;len(numbers) ;i++  {\n        fmt.Println(\"hello\")\n        if count[i]&gt;1{\n            for j=0;j&lt;len(numbers) ;j++  {\n                if numbers[i]==copy_numbers[j] {\n\n                    fmt.Printf(\"%d\",j)\n\n                }\n            }\n            fmt.Println(\"\")\n        }\n    }\n\nfmt.Printf(\"%d\",count)\n\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 2, "creation_date": 1515247994, "post_id": 48128185, "comment_id": 83232998, "body": "The correct syntax for <a href=\"https://golang.org/pkg/builtin/#append\" rel=\"nofollow noreferrer\">append</a> is: <code>testSlice = append(testSlice, row)</code>. Please take the <a href=\"https://tour.golang.org\" rel=\"nofollow noreferrer\">go tour</a>."}, {"owner": {"reputation": 29, "user_id": 5414050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65d487ea5b9ff729a940590f12e7db0?s=128&d=identicon&r=PG&f=1", "display_name": "Azmeena", "link": "https://stackoverflow.com/users/5414050/azmeena"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515248160, "post_id": 48128185, "comment_id": 83233041, "body": "Thank you. that was helpful."}], "answers": [{"tags": [], "owner": {"reputation": 3592, "user_id": 6276385, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89c7b071a5c25c2f6ccc6f1f41bdb2e3?s=128&d=identicon&r=PG&f=1", "display_name": "gonutz", "link": "https://stackoverflow.com/users/6276385/gonutz"}, "is_accepted": false, "score": 2, "last_activity_date": 1515247931, "creation_date": 1515247931, "answer_id": 48128195, "question_id": 48128185, "link": "https://stackoverflow.com/questions/48128185/go-lang-appending-a-struct-to-a-slice/48128195#48128195", "title": "Go Lang- Appending a struct to a slice", "body": "<p><code>testSlice = append(testSlice, Row{/*...*/})</code></p>\n"}], "owner": {"reputation": 29, "user_id": 5414050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65d487ea5b9ff729a940590f12e7db0?s=128&d=identicon&r=PG&f=1", "display_name": "Azmeena", "link": "https://stackoverflow.com/users/5414050/azmeena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3298, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1554478663, "creation_date": 1515247859, "last_edit_date": 1554478663, "question_id": 48128185, "link": "https://stackoverflow.com/questions/48128185/go-lang-appending-a-struct-to-a-slice", "title": "Go Lang- Appending a struct to a slice", "body": "<p>Is it Possible to append a <code>struct</code> to a <code>slice</code>? Can anyone please post an example?\nThis <code>slice</code> needs to have <code>struct</code> values.</p>\n\n<pre><code>testSlice = make([]Row, 10)\n</code></pre>\n\n<p>I tried appending this way but it did not work.</p>\n\n<pre><code>testSlice.append(row)\n</code></pre>\n"}, {"tags": ["go", "mutex"], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 2, "last_activity_date": 1515245109, "last_edit_date": 1515245109, "creation_date": 1515242918, "answer_id": 48127504, "question_id": 48127289, "link": "https://stackoverflow.com/questions/48127289/rwmutex-in-conditional-variable/48127504#48127504", "title": "RWMutex in conditional variable", "body": "<p>A <code>sync.Cond</code> only makes use of the methods required by a <a href=\"https://golang.org/pkg/sync/#Locker\" rel=\"nofollow noreferrer\">sync.Locker</a>: <code>Lock</code> and <code>Unlock</code>. The minimal <a href=\"https://golang.org/doc/effective_go.html#interfaces\" rel=\"nofollow noreferrer\">interface</a> needed by <code>Cond</code> is therefore just those two methods.</p>\n\n<p>You can still use your <code>RWMutex</code> directly (as opposed to going through <code>Cond</code>), and <code>Cond</code> will still work.</p>\n\n<pre><code>func main() {\n    myMutex := &amp;sync.RWMutex{}\n    cond := sync.NewCond(myMutex)\n    // Use the RW mutex directly.\n    myMutex.RLock()\n    myMutex.RUnlock()\n    // Use the mutex through cond. Lock and Unlock only.\n    cond.L.Lock()\n    cond.L.Unlock()\n}\n</code></pre>\n\n<p>Or you can use it through <code>Cond.L</code> after making sure it is of the expected type:</p>\n\n<pre><code>func main() {\n    cond := &amp;sync.Cond{L: &amp;sync.RWMutex{}}\n    // Typecheck cond.L.\n    myRWMutex, ok := cond.L.(*sync.RWMutex)\n    if !ok {\n        panic(\"AHHHH!!!\")\n    }\n    myRWMutex.RLock()\n    myRWMutex.RUnlock()\n}\n</code></pre>\n\n<p>(you can skip the type check and just say <code>cond.L.(*sync.RWMutex)</code> but if it isn't a <code>sync.RWMutex</code>, your program will panic)</p>\n"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 48127504, "answer_count": 1, "score": 1, "last_activity_date": 1515245109, "creation_date": 1515241369, "question_id": 48127289, "link": "https://stackoverflow.com/questions/48127289/rwmutex-in-conditional-variable", "title": "RWMutex in conditional variable", "body": "<p>Why <code>RWMutex</code> in conditional variable doesn't have <code>RLock</code> and <code>RUnLock</code> methods?</p>\n\n<pre><code>package main\n\nimport (\n    \"sync\"\n)\n\nfunc main() {\n    cond := &amp;sync.Cond{L: &amp;sync.RWMutex{}}\n    cond.L.RLock()\n    cond.L.RUnlock()\n}\n</code></pre>\n\n<p>I got an error:</p>\n\n<pre><code>cond.L.RLock undefined (type sync.Locker has no field or method RLock)\ncond.L.RUnlock undefined (type sync.Locker has no field or method RUnlock)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/LdGYlrQQx86\" rel=\"nofollow noreferrer\">https://play.golang.org/p/LdGYlrQQx86</a></p>\n"}, {"tags": ["curl", "go", "multipartform-data"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 2, "creation_date": 1515239159, "post_id": 48126954, "comment_id": 83230636, "body": "You don&#39;t seem to have tried anything. Please show what you have attempted and what did not work. Please include a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 319, "user_id": 4967975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9dyQN.jpg?s=128&g=1", "display_name": "Anam Shah", "link": "https://stackoverflow.com/users/4967975/anam-shah"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515240763, "post_id": 48126954, "comment_id": 83231037, "body": "@Marc i have added what you are asking, please check"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1515247396, "post_id": 48126954, "comment_id": 83232822, "body": "Instead of how you send the request we are more interested in how you genreate the request in <code>SendMultipartRequest</code>."}, {"owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "edited": false, "score": 0, "creation_date": 1556353733, "post_id": 48126954, "comment_id": 98416378, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/20205796/post-data-using-the-content-type-multipart-form-data\">POST data using the Content-Type multipart/form-data</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11826223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43261023c37176c2ac36655f39f21919?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/11826223/matt"}, "is_accepted": false, "score": 1, "last_activity_date": 1569621461, "creation_date": 1569621461, "answer_id": 58141716, "question_id": 48126954, "link": "https://stackoverflow.com/questions/48126954/sending-multipart-request-with-curl-usign-golang/58141716#58141716", "title": "Sending Multipart request with curl usign GoLang", "body": "<p>I just spent a long few days researching the same problem. After using <code>httputil.DumpRequest</code> to view what data I was actually passing to Documo, I saw that the content-type header for the file field was set to <code>Content-Type: application/octet-stream</code>. This is set by the <code>CreateFormFile</code> method you're using. See the <a href=\"https://golang.org/src/mime/multipart/writer.go?s=3374:3452#L130\" rel=\"nofollow noreferrer\">multipart pkg</a> for the source code.</p>\n\n<p>The <code>octet-stream</code> subtype is used as a default for binary files or files that need to be opened in an application. See <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types#applicationoctet-stream\" rel=\"nofollow noreferrer\">MDN</a>, <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types#applicationoctet-stream\" rel=\"nofollow noreferrer\">IANA</a>, or <a href=\"https://kb.iu.edu/d/agtj\" rel=\"nofollow noreferrer\">this awesome explanation</a>.</p>\n\n<p>The problem, as far as I understand it, is that <strong>Documo expects us to explicitly tell them what type of file we're sending them</strong> so they know how to handle the rendering. So for my case, <code>octet-stream</code> didn't tell them anything. Switching the file content-type to <code>application/pdf</code> did the trick. </p>\n\n<h2>Solution</h2>\n\n<p>Instead of calling <code>writer.CreateFormField</code>, I basically copied the three lines from the source code of <code>CreateFormFile</code> and hard coded the <code>Content-Type</code> to header to <code>application/pdf</code> instead of <code>application/octet-stream</code> (Note: my service only deals with PDF right now, so you may need to adjust this if your files are different types).</p>\n\n<p>Code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>\nfunc SendMultipartRequest(uri string, params map[string]string, files []*multipart.FileHeader) (*http.Request, error) {\n\n    body := &amp;bytes.Buffer{}\n    writer := multipart.NewWriter(body)\n\n    for i, _ := range files {\n        file, err := files[i].Open()\n        defer file.Close()\n        if err != nil {\n            fmt.Println(err)\n        }\n\n        //////////////////////////////////////////////////////\n        // replace create CreateFormFile with this\n        h := make(textproto.MIMEHeader) // import \"net/textproto\"\n        h.Set(\"Content-Disposition\", fmt.Sprintf(`form-data; name=\"file\"; filename=\"%s\"`, files[i].Filename)\n        h.Set(\"Content-Type\", \"application/pdf\") // this is where you'll set your document type(s)\n        fileWriter, err := form.CreatePart(h)\n        ///////////////////////////////////////////////////////\n\n        if err != nil {\n            fmt.Println(err)\n        }\n\n        if _, err = io.Copy(fileWriter, file); err != nil {\n            fmt.Println(err)\n        }\n\n        if err != nil {\n            fmt.Println(err)\n        }\n    }\n\n    for key, val := range params {\n        _ = writer.WriteField(key, val)\n    }\n\n    err := writer.Close()\n    if err != nil {\n        return nil, err\n    }\n\n    req, err := http.NewRequest(\"POST\", uri, body)\n    req.Header.Set(\"Content-Type\", writer.FormDataContentType())\n    req.Header.Set(\"Authorization\", \"Basic my_key\")\n\n    return req, err\n}\n\n</code></pre>\n\n<p>It's not the sexiest solution but I'm finally able to send complete documents through Documo now.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 319, "user_id": 4967975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9dyQN.jpg?s=128&g=1", "display_name": "Anam Shah", "link": "https://stackoverflow.com/users/4967975/anam-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 753, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1569621461, "creation_date": 1515238634, "last_edit_date": 1515246120, "question_id": 48126954, "link": "https://stackoverflow.com/questions/48126954/sending-multipart-request-with-curl-usign-golang", "title": "Sending Multipart request with curl usign GoLang", "body": "<p>I want to convert below code to golang.</p>\n\n<pre><code>curl -X POST\n  'https://api.documo.com/v1/fax/send' \\\n  -H 'Authorization: Basic YOUR_API_KEY' \\\n  -H 'content-type: multipart/form-data' \\\n  -F 'recipientFax=12345678900' \\\n  -F 'coverPage=false' \\\n  -F 'recipientName=John' \\\n  -F 'subject=test' \\\n  -F 'notes=test' \\\n  -F '=@/home/user/Documents/Sample.pdf'\n</code></pre>\n\n<p>Please help</p>\n\n<p>Below is my code what i have tried.</p>\n\n<pre><code>func SendFaxDocumo(files []*multipart.FileHeader, params map[string]string) {\n\n    request, err := SendMultipartRequest(\"https://api.documo.com/v1/fax/send\", params, files)\n    if err != nil {\n        fmt.Println(err.Error())\n\n    }\n    client := &amp;http.Client{}\n    resp, err := client.Do(request)\n    if err != nil {\n        fmt.Println(err.Error())\n    } else {\n        body := &amp;bytes.Buffer{}\n        _, err := body.ReadFrom(resp.Body)\n        if err != nil {\n            fmt.Println(err.Error())\n        }\n        resp.Body.Close()\n        fmt.Println(resp.StatusCode)\n        fmt.Println(resp.Header)\n        fmt.Println(body)\n    }\n}\n\nfunc SendMultipartRequest(uri string, params map[string]string, files []*multipart.FileHeader) (*http.Request, error) {\n\n    body := &amp;bytes.Buffer{}\n    writer := multipart.NewWriter(body)\n\n    for i, _ := range files {\n        // string_index := strconv.Itoa(i)\n        file, err := files[i].Open()\n        defer file.Close()\n        if err != nil {\n            fmt.Println(err)\n        }\n\n        doc , err := ioutil.ReadAll(file)\n        if err != nil {\n            fmt.Println(err,980)\n        }\n\n        part, err := writer.CreateFormFile(\"file\",files[i].Filename)\n\n        if err != nil {\n            fmt.Println(err)\n        }\n\n        part.Write([]byte(string(doc)))\n        if _, err = io.Copy(part, file); err != nil {\n            fmt.Println(err)\n        }\n\n        if err != nil {\n            fmt.Println(err)\n        }\n    }\n\n    for key, val := range params {\n        _ = writer.WriteField(key, val)\n    }\n\n    err := writer.Close()\n    if err != nil {\n        return nil, err\n    }\n\n    req, err := http.NewRequest(\"POST\", uri, body)\n    req.Header.Set(\"Content-Type\", writer.FormDataContentType())\n    req.Header.Set(\"Authorization\", \"Basic my_key\")\n\n    return req, err\n}\n</code></pre>\n\n<p>And the error i am getting is below:\n{\"error\":{\"name\":\"Error\",\"message\":\"File extension not allowed. Allowed formats: tiff,gif,png,jpeg,pdf,doc,xls,ppt,pcl,eps,ps,txt,rtf,xml,fxc,docx,pptx,xlsx\"}}</p>\n\n<p>This is the response got from the url requested even if i am trying it by pdf.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9180960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd110c0060890de3e4470373c1f8380b?s=128&d=identicon&r=PG&f=1", "display_name": "gen.alcazar", "link": "https://stackoverflow.com/users/9180960/gen-alcazar"}, "edited": false, "score": 0, "creation_date": 1515296531, "post_id": 48127005, "comment_id": 83245547, "body": "Aaah. Should&#39;ve mentioned that I&#39;m a noob at Go; got a little overconfident using interfaces and such, and overlooked some of the basics. Lesson learnt on slices. Thanks Marc!"}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 2, "last_activity_date": 1515239409, "last_edit_date": 1515239409, "creation_date": 1515239002, "answer_id": 48127005, "question_id": 48126879, "link": "https://stackoverflow.com/questions/48126879/populating-a-map-of-structs-with-incrementing-function/48127005#48127005", "title": "Populating a map of structs with incrementing function", "body": "<p><a href=\"https://golang.org/pkg/net/#IP\" rel=\"nofollow noreferrer\">net.IP</a> is a byte slice.</p>\n\n<p>You're basically modifying <code>mIP</code> constantly and storing it. But due to the way <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">slices work</a>, you're really storing a pointer to the underlying data.</p>\n\n<p>A quick workaround to your problem is to store a copy of <code>mIP</code>. eg:</p>\n\n<pre><code>for _, v := range s {\n    tmpIP := make([]byte, len(mIP))\n    copy(tmpIP, mIP)\n    m[v] = &amp;nbrStruct{\n        bgp: bgp{\n            tag: tmpIP,\n        },\n    }\n\n    mIP, _ = NextIP(mIP, 4)\n}\n</code></pre>\n\n<p>This results in the correct output:</p>\n\n<pre><code>key: string1 ---&gt; tag: 10.10.10.0\nkey: string2 ---&gt; tag: 10.10.10.4\n</code></pre>\n\n<p>I would strongly suggest you change <code>NextIP</code> to return a new IP, not a modified version of the input.</p>\n"}], "owner": {"reputation": 13, "user_id": 9180960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd110c0060890de3e4470373c1f8380b?s=128&d=identicon&r=PG&f=1", "display_name": "gen.alcazar", "link": "https://stackoverflow.com/users/9180960/gen-alcazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 48127005, "answer_count": 1, "score": 1, "last_activity_date": 1515296663, "creation_date": 1515238158, "last_edit_date": 1515296663, "question_id": 48126879, "link": "https://stackoverflow.com/questions/48126879/populating-a-map-of-structs-with-incrementing-function", "title": "Populating a map of structs with incrementing function", "body": "<p>I am trying to populate a map with string keys and pointer to struct values. Specifically, having issues populating one field, that needs to be incremented, by calling a function, over the range of another array. <a href=\"https://play.golang.org/p/bCCrf56kMmz\" rel=\"nofollow noreferrer\">Problem snippet is here</a>.</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"net\"\n)\n\ntype bgp struct {\n  tag net.IP\n}\n\ntype nbrStruct struct {\n  bgp\n}\n\nvar mIPStr = \"10.10.10.0\"\n\nfunc main() {\n  m := make(map[string]*nbrStruct)\n  s := []string{\"string1\", \"string2\"}\n  mIP := net.ParseIP(mIPStr)\n  mIP = mIP.To4()\n\n  for _, v := range s {\n    m[v] = &amp;nbrStruct{\n       bgp: bgp{\n         tag: mIP,\n       },\n    }\n    fmt.Println(mIP)\n    mIP, _ = NextIP(mIP, 4)\n  }\n  for key, value := range m {\n    fmt.Printf(\"key: %v ---&gt; tag: %v\\n\", key, value.bgp.tag)\n  }\n}\n\nfunc NextIP(ip net.IP, addIP int) (net.IP, error) {\n  var err error\n  if ip = ip.To4(); ip != nil {\n        // Case IPv4\n    ip[3] = ip[3] + uint8(addIP)\n    if ip[3] &gt; 255 {\n    ip[3] = ip[3] - 255\n    ip[2]++\n  }\n    if ip[2] &gt; 255 {\n        ip[2] = ip[2] - 255\n        ip[1]++\n    }\n    if ip[1] &gt; 255 {\n        err = fmt.Errorf(\"NextIP out of space in top IPv4 Octet %v\", ip)\n        return nil, err\n    }\n    // } else if ip = ip.To16(); ip != nil {\n    //  // Case IPv6\n} else {\n    err = fmt.Errorf(\"NextIP cannot understand IP: %v\", ip)\n    return nil, err\n}\nreturn ip, err\n}\n</code></pre>\n\n<p>The issue I have is with line #31 </p>\n\n<pre><code>mIP, _ = NextIP(mIP, 4)\n</code></pre>\n\n<p>I'm expecting the two values to be:</p>\n\n<pre><code>m[\"string1\"].bgp.tag == 10.10.10.0\nm[\"string2\"].bgp.tag == 10.10.10.4\n</code></pre>\n\n<p>...which the function NextIP is correctly returning. But on reading the map, the previous m[\"string1\"].bgp.tag value seems to be overwritten by the new one? They're both 10.10.10.8; super confused about this. What am I doing wrong?</p>\n"}, {"tags": ["regex", "go", "regex-group"], "comments": [{"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "edited": false, "score": 1, "creation_date": 1515223899, "post_id": 48125221, "comment_id": 83227228, "body": "Can you provide some test input strings?"}, {"owner": {"reputation": 1272, "user_id": 4309716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PWKIs.jpg?s=128&g=1", "display_name": "TheDevWay", "link": "https://stackoverflow.com/users/4309716/thedevway"}, "reply_to_user": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "edited": false, "score": 0, "creation_date": 1515224006, "post_id": 48125221, "comment_id": 83227254, "body": "@Gurman The input strings are from PHP codes. It searches project and looks for match in the code. I have updated the question with some examples by the way."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1515224036, "post_id": 48125221, "comment_id": 83227262, "body": "And to be sure, would you please post your assign statement like <code>patther := &quot;...&quot;</code>?"}, {"owner": {"reputation": 1451, "user_id": 6552776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UiuKq.jpg?s=128&g=1", "display_name": "csabinho", "link": "https://stackoverflow.com/users/6552776/csabinho"}, "edited": false, "score": 1, "creation_date": 1515224320, "post_id": 48125221, "comment_id": 83227296, "body": "It doesn&#39;t match because of the extra space! Otherwise it matches! I checked it on regex101.com. <a href=\"https://regex101.com/r/pz1Ce1/2\" rel=\"nofollow noreferrer\">see here</a>"}, {"owner": {"reputation": 1272, "user_id": 4309716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PWKIs.jpg?s=128&g=1", "display_name": "TheDevWay", "link": "https://stackoverflow.com/users/4309716/thedevway"}, "reply_to_user": {"reputation": 1451, "user_id": 6552776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UiuKq.jpg?s=128&g=1", "display_name": "csabinho", "link": "https://stackoverflow.com/users/6552776/csabinho"}, "edited": false, "score": 0, "creation_date": 1515224509, "post_id": 48125221, "comment_id": 83227321, "body": "@csabinho Oh. I guess that&#39;s the case. Can you provide regex to match spaces (if exists) in answer please ?"}], "answers": [{"comments": [{"owner": {"reputation": 1272, "user_id": 4309716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PWKIs.jpg?s=128&g=1", "display_name": "TheDevWay", "link": "https://stackoverflow.com/users/4309716/thedevway"}, "edited": false, "score": 0, "creation_date": 1515225011, "post_id": 48125281, "comment_id": 83227393, "body": "Thanks for the brief explanation. I guess adding <code>\\s*</code> in the places that may contain white space may do the trick as well."}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 1272, "user_id": 4309716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PWKIs.jpg?s=128&g=1", "display_name": "TheDevWay", "link": "https://stackoverflow.com/users/4309716/thedevway"}, "edited": false, "score": 0, "creation_date": 1515225056, "post_id": 48125281, "comment_id": 83227400, "body": "@sobhanbagheri I have tried to include that in my alternative solution as shown <a href=\"https://regex101.com/r/wDVP68/4\" rel=\"nofollow noreferrer\">HERE</a>"}, {"owner": {"reputation": 1272, "user_id": 4309716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PWKIs.jpg?s=128&g=1", "display_name": "TheDevWay", "link": "https://stackoverflow.com/users/4309716/thedevway"}, "edited": false, "score": 0, "creation_date": 1515242187, "post_id": 48125281, "comment_id": 83231396, "body": "Alternative regex had a little problem which caused some illegal strings (not translates) match and capture. I guess this is a better one (the non capturing group has been removed):  <code>Yii::t\\(\\s*[&#39;&quot;][^&#39;&quot;]*[&#39;&quot;]\\s*\\,\\s*[&#39;&quot;][^&#39;&quot;]*[&#39;&quot;]\\s*\\)</code>"}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 1272, "user_id": 4309716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PWKIs.jpg?s=128&g=1", "display_name": "TheDevWay", "link": "https://stackoverflow.com/users/4309716/thedevway"}, "edited": false, "score": 0, "creation_date": 1515294314, "post_id": 48125281, "comment_id": 83245207, "body": "It&#39;s OK if it suits your requirements. :)"}], "tags": [], "owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "is_accepted": true, "score": 2, "last_activity_date": 1515224962, "last_edit_date": 1515224962, "creation_date": 1515224349, "answer_id": 48125281, "question_id": 48125221, "link": "https://stackoverflow.com/questions/48125221/regex-not-matching-double-quotations-in-string-just-single-quotations/48125281#48125281", "title": "Regex not matching double quotations in string (just single quotations)", "body": "<p>Try this Regex:</p>\n\n<pre><code>Yii::t\\((?:['\"][^'\"]*['\"],?\\s*)*\\)\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/wDVP68/2\" rel=\"nofollow noreferrer\">Click for Demo</a></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n<li><code>Yii::t\\(</code> - matches <code>Yii::t(</code> literally</li>\n<li><code>(?:['\"][^'\"]+['\"],?\\s*)*\\)</code>\n\n<ul>\n<li><code>['\"]</code> - matches either <code>'</code> or <code>\"</code></li>\n<li><code>[^'\"]*</code> - matches 0+ occurrences of any character that is neither <code>'</code> nor <code>\"</code></li>\n<li><code>['\"]</code> - matches a single occurrence of either <code>'</code> or <code>\"</code></li>\n<li><code>,?</code> - matches 0 or 1 occurrence of a <code>,</code></li>\n<li><code>\\s*</code> - matches 0+ occurrences of a whitespace</li>\n<li><code>*</code> - The last <code>*</code> matches the above 5 sub-patterns 0+ times</li>\n<li><code>\\)</code> - matches <code>)</code> literally</li>\n</ul></li>\n</ul>\n\n<p><strong>Alternative Solution:</strong></p>\n\n<p><a href=\"https://regex101.com/r/wDVP68/3\" rel=\"nofollow noreferrer\"><code>Yii::t\\(\\s*['\"][^'\"]*['\"]\\s*(?:,\\s*['\"][^'\"]*['\"]\\s*)*\\)</code></a></p>\n"}, {"tags": [], "owner": {"reputation": 1451, "user_id": 6552776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UiuKq.jpg?s=128&g=1", "display_name": "csabinho", "link": "https://stackoverflow.com/users/6552776/csabinho"}, "is_accepted": false, "score": 1, "last_activity_date": 1515224776, "creation_date": 1515224776, "answer_id": 48125327, "question_id": 48125221, "link": "https://stackoverflow.com/questions/48125221/regex-not-matching-double-quotations-in-string-just-single-quotations/48125327#48125327", "title": "Regex not matching double quotations in string (just single quotations)", "body": "<p>This RegEx matches everything:</p>\n\n<pre><code>(Yii::t\\(\\s*)(\\'|\\\")(.*?)(\\'|\\\")\\,\\s*(\\'|\\\")(.*?)(\\'|\\\")\\)\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/pz1Ce1/3\" rel=\"nofollow noreferrer\">See here</a></p>\n"}, {"tags": [], "owner": {"reputation": 2005, "user_id": 9180179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IHVRQ.jpg?s=128&g=1", "display_name": "Usman", "link": "https://stackoverflow.com/users/9180179/usman"}, "is_accepted": false, "score": 0, "last_activity_date": 1515248055, "creation_date": 1515248055, "answer_id": 48128215, "question_id": 48125221, "link": "https://stackoverflow.com/questions/48125221/regex-not-matching-double-quotations-in-string-just-single-quotations/48128215#48128215", "title": "Regex not matching double quotations in string (just single quotations)", "body": "<p>Try this Regex , This matches everything :</p>\n\n<pre><code>Yii::t\\(('|\")(.*)(\\'|\\\"),('|[  ](\"|'))(.*)('|\")\\)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ACtzq.png\" rel=\"nofollow noreferrer\">Click here for output !</a></p>\n"}], "owner": {"reputation": 1272, "user_id": 4309716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PWKIs.jpg?s=128&g=1", "display_name": "TheDevWay", "link": "https://stackoverflow.com/users/4309716/thedevway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 48125281, "answer_count": 3, "score": 0, "last_activity_date": 1515248055, "creation_date": 1515223772, "last_edit_date": 1515226385, "question_id": 48125221, "link": "https://stackoverflow.com/questions/48125221/regex-not-matching-double-quotations-in-string-just-single-quotations", "title": "Regex not matching double quotations in string (just single quotations)", "body": "<p>I have written this regex to match translation strings. Everything works fine except it only matches single quotations <code>''</code> in strings, although I've written several rules to match both single and double quotations.</p>\n\n<p>Here is my regex rule:</p>\n\n<pre><code>(Yii::t\\()(\\'|\\\")(.*?)(\\'|\\\")\\,(\\'|\\\")(.*?)(\\'|\\\")\\)\n</code></pre>\n\n<p>as expected <code>(\\'|\\\")</code> should match both ones but it doesn't.</p>\n\n<p>I have also tried the following rules as well:</p>\n\n<pre><code>('|\")\n(['\"])\n</code></pre>\n\n<p>Examples:</p>\n\n<p>successfully matches these:</p>\n\n<pre><code>Yii::t('backend','My Profile')\nYii::t('backend','Log Out')\n</code></pre>\n\n<p>does not match these:</p>\n\n<pre><code>Yii::t(\"backend\", \"Search...\")\nYii::t(\"backend\", 'Sounds')\n</code></pre>\n\n<p>code i'm using to for matching regex:</p>\n\n<pre><code>re := regexp.MustCompile(`(Yii::t\\()(\\'|\\\")(.*?)(\\'|\\\")\\,(\\'|\\\")(.*?)(\\'|\\\")\\)`)\nmatches := re.FindAllString(line, -1)\n</code></pre>\n\n<p><strong>Update:\nThe problem was because some strings contained white spaces (not because of quotations).</strong></p>\n"}, {"tags": ["testing", "go"], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 5, "last_activity_date": 1515224635, "last_edit_date": 1515224635, "creation_date": 1515221678, "answer_id": 48125037, "question_id": 48124851, "link": "https://stackoverflow.com/questions/48124851/how-can-i-test-the-http-newrequest-in-go/48125037#48125037", "title": "How can I test the http.NewRequest in Go?", "body": "<p>The <a href=\"https://golang.org/pkg/net/http/httptest/#Server\" rel=\"nofollow noreferrer\">httptest.Server</a> has a <a href=\"https://golang.org/pkg/net/http/httptest/#Server.URL\" rel=\"nofollow noreferrer\">URL</a> field, you can use that value to send your requests to, so this would be the <code>url</code> argument to your function.</p>\n\n<p>Then to test whether the <a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\">http.Request</a> was sent with the right headers and body you can create the test server with a custom handler when calling <a href=\"https://golang.org/pkg/net/http/httptest/#NewServer\" rel=\"nofollow noreferrer\">httptest.NewServer</a>. This handler will then be invoked by the server on each request that is sent to the url mentioned above, so your test logic should go inside this handler.</p>\n\n<pre><code>ts := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    // Test that r is what you expect it to be\n}))\ndefer ts.Close()\n\nerr := postJson(ts.URL+\"/foo/bar\", data)\n</code></pre>\n\n<p>Playground:<a href=\"https://play.golang.org/p/SldU4JSs911\" rel=\"nofollow noreferrer\">https://play.golang.org/p/SldU4JSs911</a></p>\n"}], "owner": {"reputation": 41, "user_id": 9180311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ab7da2901c14a34dd014ca57de56fc?s=128&d=identicon&r=PG&f=1", "display_name": "user9180311", "link": "https://stackoverflow.com/users/9180311/user9180311"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1730, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1515224635, "creation_date": 1515219724, "question_id": 48124851, "link": "https://stackoverflow.com/questions/48124851/how-can-i-test-the-http-newrequest-in-go", "title": "How can I test the http.NewRequest in Go?", "body": "<p>I am mostly familiar with testing in Go, but struggling to find a way to test the following function:</p>\n\n<pre><code>func postJson(url string, jsonData []byte) error {\n    req, err := http.NewRequest(\"POST\", url, bytes.NewBuffer(jsonData))\n    if err != nil {\n        return err\n    }\n    req.Header.Set(\"Content-Type\", \"application/json\")\n\n    client := &amp;http.Client{}\n    resp, err := client.Do(req)\n    if err != nil {\n        return err\n    }\n    resp.Body.Close()\n    return nil\n}\n</code></pre>\n\n<p>I want to check that the request has correct post data with the right headers. Tried to look into <a href=\"https://golang.org/pkg/net/http/httptest/\" rel=\"nofollow noreferrer\">httptests</a>, but I am not sure how to use it.</p>\n"}, {"tags": ["go", "sdk", "google-compute-engine"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515228010, "post_id": 48124711, "comment_id": 83227942, "body": "Are you talking about the example in the <a href=\"https://godoc.org/golang.org/x/oauth2#example-Config\" rel=\"nofollow noreferrer\">oauth docs</a>? If so, you can scroll up about 15 lines and see that <code>Config</code> has a <code>RedirectURL string</code> field. If you are talking about something else, please link to it."}, {"owner": {"reputation": 13, "user_id": 9126484, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lwJ5WEqNakw/AAAAAAAAAAI/AAAAAAAAArU/lyZ8qiVm8hI/photo.jpg?sz=128", "display_name": "sheldon", "link": "https://stackoverflow.com/users/9126484/sheldon"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515231493, "post_id": 48124711, "comment_id": 83228770, "body": "Yes, I wonder what RedirectURL should be, because I don&#39;t quite understand this authentication flow."}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515231656, "post_id": 48124711, "comment_id": 83228812, "body": "I still don&#39;t know what you&#39;re asking. Redirect URI is the url of your application. After authentication with the oauth server, the user will be redirected to your application with an access token."}, {"owner": {"reputation": 13, "user_id": 9126484, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lwJ5WEqNakw/AAAAAAAAAAI/AAAAAAAAArU/lyZ8qiVm8hI/photo.jpg?sz=128", "display_name": "sheldon", "link": "https://stackoverflow.com/users/9126484/sheldon"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515233578, "post_id": 48124711, "comment_id": 83229273, "body": "What should RedirectURL be in a localhost test and where do I get the authentication code, and scan mean a manual interact , shouldn&#39;t this flow be automatic? I am trying to get instance information from GCE."}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515233780, "post_id": 48124711, "comment_id": 83229321, "body": "There are a lot of <a href=\"https://jacobmartins.com/2016/02/29/getting-started-with-oauth2-in-go/\" rel=\"nofollow noreferrer\">tutorials</a> available out there. Please read it thoroughly to 1) understand how oauth works and 2) how to use it inside your app. And yes, there&#39;s manual involvement. You&#39;re asking people to authenticate, they need to be able to provide permission and optionally specify which account to authenticate with."}, {"owner": {"reputation": 13, "user_id": 9126484, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lwJ5WEqNakw/AAAAAAAAAAI/AAAAAAAAArU/lyZ8qiVm8hI/photo.jpg?sz=128", "display_name": "sheldon", "link": "https://stackoverflow.com/users/9126484/sheldon"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515234019, "post_id": 48124711, "comment_id": 83229393, "body": "My target is compute engine other than an app. Automatic authenticate can be achieved by GCE javascript client  function authorization() {        gapi.client.setApiKey(API_KEY);        gapi.auth.authorize({          client_id: CLIENT_ID,          scope: SCOPES,          immediate: true        }, function(authResult) {             if (authResult &amp;&amp; !authResult.error) {               initializeApi();             } else {               window.alert(&#39;Auth was not successful&#39;);             }           }        );      }"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515234053, "post_id": 48124711, "comment_id": 83229399, "body": "Oh,  now I see. Oauth is to authenticate users. If you want to use the google cloud sdk within an instance, you should use <a href=\"https://cloud.google.com/compute/docs/access/service-accounts\" rel=\"nofollow noreferrer\">service accounts</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 9126484, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lwJ5WEqNakw/AAAAAAAAAAI/AAAAAAAAArU/lyZ8qiVm8hI/photo.jpg?sz=128", "display_name": "sheldon", "link": "https://stackoverflow.com/users/9126484/sheldon"}, "is_accepted": true, "score": 0, "last_activity_date": 1515251044, "creation_date": 1515251044, "answer_id": 48128617, "question_id": 48124711, "link": "https://stackoverflow.com/questions/48124711/how-to-achieve-automatic-authentication-using-gce-go-client-oauth2-authenticatio/48128617#48128617", "title": "How to achieve automatic authentication using GCE Go client oauth2 authentication", "body": "<p>Solved by using code example </p>\n\n<p><a href=\"https://cloud.google.com/compute/docs/reference/latest/instances/get#examples\" rel=\"nofollow noreferrer\">https://cloud.google.com/compute/docs/reference/latest/instances/get#examples</a> </p>\n\n<p>just set \"GOOGLE_APPLICATION_CREDENTIALS\" environment varibles as google.DefaultClient() requires.<br>\npackage main</p>\n\n<pre><code>import (\n    \"context\"\n    \"fmt\"\n    \"log\"\n\n    \"golang.org/x/oauth2/google\"\n    \"google.golang.org/api/compute/v1\"\n)\n\ntype GCE struct {\n    *compute.Service\n}\n\nvar ctx = context.Background()\n\nfunc initGCE() *GCE {\n    c, err := google.DefaultClient(ctx, compute.CloudPlatformScope)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    computeService, err := compute.New(c)\n    if err != nil {\n        log.Fatal(err)\n    }\n    return &amp;GCE{computeService}\n}\n\nfunc (g *GCE) Instance(project, zone, instance string) {\n    resp, err := g.Instances.Get(project, zone, instance).Context(ctx).Do()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"%#v\\n\", resp)\n}\n</code></pre>\n\n<p>Thanks for your reply.</p>\n"}], "owner": {"reputation": 13, "user_id": 9126484, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lwJ5WEqNakw/AAAAAAAAAAI/AAAAAAAAArU/lyZ8qiVm8hI/photo.jpg?sz=128", "display_name": "sheldon", "link": "https://stackoverflow.com/users/9126484/sheldon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 48128617, "answer_count": 1, "score": -1, "last_activity_date": 1515251044, "creation_date": 1515217939, "last_edit_date": 1515247280, "question_id": 48124711, "link": "https://stackoverflow.com/questions/48124711/how-to-achieve-automatic-authentication-using-gce-go-client-oauth2-authenticatio", "title": "How to achieve automatic authentication using GCE Go client oauth2 authentication", "body": "<p>This code is on the basis of golang.org/x/oauth2 example test. I am trying to get instance information from Google Compute Engine using Go client. Do I have to use oauth2 authentication? There is a generated link after <code>Visit the URL for the auth dialog</code>:</p>\n\n<p><a href=\"https://accounts.google.com/o/oauth2/auth?access_type=offline&amp;client_id=xxx&amp;redirect_uri=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcompute&amp;response_type=code&amp;scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcompute&amp;state=state\" rel=\"nofollow noreferrer\">https://accounts.google.com/o/oauth2/auth?access_type=offline&amp;client_id=xxx&amp;redirect_uri=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcompute&amp;response_type=code&amp;scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcompute&amp;state=state</a></p>\n\n<p>and it redirect to <a href=\"https://www.googleapis.com/auth/compute\" rel=\"nofollow noreferrer\">https://www.googleapis.com/auth/compute</a> which shows a 'compute'.\nHow do I achieve automatic authentication?</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"log\"\n\n    \"golang.org/x/oauth2\"\n    \"google.golang.org/api/compute/v1\"\n)\n\ntype GCE struct {\n    *compute.Service\n}\n\nvar ctx = context.Background()\n\nfunc initGCE() *GCE {\n    conf := &amp;oauth2.Config{\n        ClientID:     \"xxx\",\n        ClientSecret: \"xxx\",\n        Scopes:       []string{compute.ComputeScope},\n        Endpoint: oauth2.Endpoint{\n            AuthURL:  \"https://accounts.google.com/o/oauth2/auth\",\n            TokenURL: \"https://accounts.google.com/o/oauth2/auth\",\n        },\n        RedirectURL: \"https://www.googleapis.com/auth/compute\",\n\n    }\n    url := conf.AuthCodeURL(\"state\", oauth2.AccessTypeOffline)\n    fmt.Printf(\"Visit the URL for the auth dialog: %v\", url)\n    var code string\n    if _, err := fmt.Scan(&amp;code); err != nil {\n        log.Fatal(err)\n    }\n    tok, err := conf.Exchange(ctx, code)\n    if err != nil {\n        log.Fatal(err)\n    }\n    service, err := compute.New(conf.Client(ctx, tok))\n    if err != nil {\n        log.Fatal(err)\n    }\n    return &amp;GCE{service}\n}\n\nfunc (g *GCE) Instance() {\n    project := \"arctic-cyclist-189707\"\n    zone := \"us-east1-b\"\n    instance := \"centos7\"\n    resp, err := g.Instances.Get(project, zone, instance).Context(ctx).Do()\n    if err != nil {\n        fmt.Println(err)\n        return\n    } else {\n        fmt.Printf(\"%#v\\n\", resp)\n\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "visual-studio-code", "vscode-settings"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1515222819, "post_id": 48124565, "comment_id": 83227086, "body": "Does this happens to every golang file? Try saving to another path and/or another filename?"}, {"owner": {"reputation": 1462, "user_id": 988175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cb69696ada13fd415125cc89ef1f4b09?s=128&d=identicon&r=PG", "display_name": "Raffaello", "link": "https://stackoverflow.com/users/988175/raffaello"}, "edited": false, "score": 0, "creation_date": 1587641949, "post_id": 48124565, "comment_id": 108594331, "body": "to me happens on wrong detected not used import. so i have for free a build fail thanks to this smart auto delete code on saving. :)"}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 4, "last_activity_date": 1551424241, "last_edit_date": 1551424241, "creation_date": 1515220308, "answer_id": 48124896, "question_id": 48124565, "link": "https://stackoverflow.com/questions/48124565/why-does-vscode-delete-golang-source-on-save/48124896#48124896", "title": "Why does vscode delete golang source on save", "body": "<p>That seems strange.<br>\nI can understand the import disappearing (as in <a href=\"https://github.com/Microsoft/vscode-go/issues/748\" rel=\"nofollow noreferrer\">issue 748</a>) because of <a href=\"https://github.com/sqs/goreturns\" rel=\"nofollow noreferrer\"><code>goreturns</code> (<code>github.com/sqs/goreturns</code>)</a> removing unused import. But that shouldn't apply in your case.</p>\n\n<p>But if almost everything disappears, that means the file fails to be saved, and revert to its original content.<br>\nMaybe another process is keeping an handle on that file, preventing the save operation to proceed.</p>\n"}, {"comments": [{"owner": {"reputation": 457, "user_id": 7344033, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qf6h1.jpg?s=128&g=1", "display_name": "Exel Staderlin", "link": "https://stackoverflow.com/users/7344033/exel-staderlin"}, "edited": false, "score": 2, "creation_date": 1570676626, "post_id": 54698528, "comment_id": 102990233, "body": "Thankss mate you save my time"}, {"owner": {"reputation": 101, "user_id": 8478131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0f7949e0653c0aadd6898075e89e5a?s=128&d=identicon&r=PG&f=1", "display_name": "Sri", "link": "https://stackoverflow.com/users/8478131/sri"}, "edited": false, "score": 0, "creation_date": 1617004183, "post_id": 54698528, "comment_id": 118168925, "body": "This answer does not work for me. see the answer by LoremIpsum or this comment on the issue here <a href=\"https://github.com/golang/vscode-go/issues/1231#issuecomment-779738892\" rel=\"nofollow noreferrer\">github.com/golang/vscode-go/issues/1231#issuecomment-7797388&zwnj;&#8203;92</a>"}], "tags": [], "owner": {"reputation": 491, "user_id": 2616416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/558f22a6f997c64c52770c49542f6c3b?s=128&d=identicon&r=PG", "display_name": "akif1", "link": "https://stackoverflow.com/users/2616416/akif1"}, "is_accepted": false, "score": 36, "last_activity_date": 1593144665, "last_edit_date": 1593144665, "creation_date": 1550175925, "answer_id": 54698528, "question_id": 48124565, "link": "https://stackoverflow.com/questions/48124565/why-does-vscode-delete-golang-source-on-save/54698528#54698528", "title": "Why does vscode delete golang source on save", "body": "<p>Basically, your formatOnSave is on for go which is causing this problem.</p>\n<p>To disable it, go to your Command Palette (Ctrl+Shift+P), type in &quot;configure language specific settings&quot;, and look for Go.</p>\n<p>You should now see a json file where you can add the following setting to it:</p>\n<pre><code>&quot;editor.formatOnSave&quot;: false.\n</code></pre>\n<p>This is how the json file looks like if you just have on setting modified for go:</p>\n<pre><code>{\n    &quot;window.zoomLevel&quot;: 1,\n    &quot;[go]&quot;: {\n        &quot;editor.formatOnSave&quot;: false,\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1475, "user_id": 2707671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/142f15811338c5c642a5c4c47fe7b393?s=128&d=identicon&r=PG&f=1", "display_name": "user2707671", "link": "https://stackoverflow.com/users/2707671/user2707671"}, "edited": false, "score": 0, "creation_date": 1552338995, "post_id": 54938450, "comment_id": 96963867, "body": "Thanks! I tried all the go format tools available in vscode. goImports and goreturns &quot;fixed&quot; my code (it won&#39;t compile anymore), while gofmt and goformat don&#39;t. Switched to gofmt for now."}], "tags": [], "owner": {"reputation": 151, "user_id": 6121368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9585421c3faa6acd5633a44f929583e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro", "link": "https://stackoverflow.com/users/6121368/pedro"}, "is_accepted": false, "score": 10, "last_activity_date": 1551418504, "last_edit_date": 1551418504, "creation_date": 1551418142, "answer_id": 54938450, "question_id": 48124565, "link": "https://stackoverflow.com/questions/48124565/why-does-vscode-delete-golang-source-on-save/54938450#54938450", "title": "Why does vscode delete golang source on save", "body": "<p>By default Format Tool is set to \"goreturns\" in settings.json, change it to \"fmt\":</p>\n\n<pre><code>{\n    \"go.formatTool\": \"gofmt\"\n}\n</code></pre>\n\n<p>Now you can comment the imports:</p>\n\n<pre><code>import (\n    \"fmt\"\n    // \"reflect\"\n    // \"math/rand\"\n)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 991, "user_id": 6046943, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LcfRdHgltrQ/AAAAAAAAAAI/AAAAAAAAA8Q/ic7zQMbzDC8/photo.jpg?sz=128", "display_name": "Iakovos Belonias", "link": "https://stackoverflow.com/users/6046943/iakovos-belonias"}, "is_accepted": false, "score": 0, "last_activity_date": 1575548685, "creation_date": 1575548685, "answer_id": 59195136, "question_id": 48124565, "link": "https://stackoverflow.com/questions/48124565/why-does-vscode-delete-golang-source-on-save/59195136#59195136", "title": "Why does vscode delete golang source on save", "body": "<p>The reason why this happening is because of what you imported, you didn't use it in the program, so Golang deletes unnecessary dependencies.</p>\n"}, {"comments": [{"owner": {"reputation": 72, "user_id": 1912394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ddfbab735d58eaaba886668a8743de8b?s=128&d=identicon&r=PG", "display_name": "Arsalan", "link": "https://stackoverflow.com/users/1912394/arsalan"}, "edited": false, "score": 2, "creation_date": 1607788570, "post_id": 61316426, "comment_id": 115385543, "body": "This is a better solution. Thanks"}, {"owner": {"reputation": 61, "user_id": 6477214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tA5Mg.jpg?s=128&g=1", "display_name": "Sarveshwar Singh", "link": "https://stackoverflow.com/users/6477214/sarveshwar-singh"}, "edited": false, "score": 0, "creation_date": 1611197910, "post_id": 61316426, "comment_id": 116375850, "body": "Yes, this one also worked for me. Thanks !!"}], "tags": [], "owner": {"reputation": 835, "user_id": 4715129, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/5TCX1.png?s=128&g=1", "display_name": "LoremIpsum", "link": "https://stackoverflow.com/users/4715129/loremipsum"}, "is_accepted": false, "score": 22, "last_activity_date": 1589219304, "last_edit_date": 1589219304, "creation_date": 1587364592, "answer_id": 61316426, "question_id": 48124565, "link": "https://stackoverflow.com/questions/48124565/why-does-vscode-delete-golang-source-on-save/61316426#61316426", "title": "Why does vscode delete golang source on save", "body": "<p>config both editor.formatOnSave and  editor.codeActionsOnSave in the settings.json:</p>\n\n<pre><code>\"[go]\": {\n\n        \"editor.formatOnSave\": false,\n        \"editor.codeActionsOnSave\": {\n            \"source.organizeImports\": false\n        },\n    },\n    \"go.formatTool\": \"gofmt\",\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9646970, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UApmiOeInGg/AAAAAAAAAAI/AAAAAAAAAPo/pkKnTMD2aZM/photo.jpg?sz=128", "display_name": "Manoj Sharma", "link": "https://stackoverflow.com/users/9646970/manoj-sharma"}, "is_accepted": false, "score": -2, "last_activity_date": 1600023032, "creation_date": 1600023032, "answer_id": 63874398, "question_id": 48124565, "link": "https://stackoverflow.com/questions/48124565/why-does-vscode-delete-golang-source-on-save/63874398#63874398", "title": "Why does vscode delete golang source on save", "body": "<p>On VScode just press (CTRL + SHIFT + P ).</p>\n<p>Then, Click on &quot;Configure language-specific settings&quot;\nand select GO lang.</p>\n<p>Just paste code</p>\n<pre><code>&quot;[go]&quot;: {\n    &quot;editor.insertSpaces&quot;: false,\n    &quot;editor.formatOnSave&quot;: true,\n    &quot;editor.codeActionsOnSave&quot;: {\n        &quot;source.organizeImports&quot;: true\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9248, "user_id": 109561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33233d5bae5b1c8d8053dfa3b4e18267?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/109561/gerry"}, "is_accepted": false, "score": 3, "last_activity_date": 1604415828, "creation_date": 1604415828, "answer_id": 64665377, "question_id": 48124565, "link": "https://stackoverflow.com/questions/48124565/why-does-vscode-delete-golang-source-on-save/64665377#64665377", "title": "Why does vscode delete golang source on save", "body": "<p>I had a similar issue that was caused by not having the right case on method names.</p>\n<p>In the following code <code>import &quot;fmt&quot;</code> would disappear.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport &quot;fmt&quot;\n\nfunc main() {\n  fmt.println(&quot;hello world&quot;)\n}\n</code></pre>\n<p><strong>Solution</strong> I should be calling <code>Println</code> <strong>NOT</strong> <code>println</code> ! Note the uppercase <code>P</code>. Once changed <code>goreturns</code> adds the import instead of removing it.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13957731, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-viWxStpCPYI/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckIv2XBSl03KHErdo6d_BrX3Mrliw/photo.jpg?sz=128", "display_name": "Sabuhi Gurbani", "link": "https://stackoverflow.com/users/13957731/sabuhi-gurbani"}, "is_accepted": false, "score": 0, "last_activity_date": 1618674481, "creation_date": 1618674481, "answer_id": 67140035, "question_id": 48124565, "link": "https://stackoverflow.com/questions/48124565/why-does-vscode-delete-golang-source-on-save/67140035#67140035", "title": "Why does vscode delete golang source on save", "body": "<p>Ctrl+Shift+P   --&gt; Configure Language Specific Settings</p>\n<pre><code>       &quot;editor.insertSpaces&quot;: false,\n        &quot;editor.formatOnSave&quot;: **false,**\n        &quot;editor.codeActionsOnSave&quot;: {\n            &quot;source.organizeImports&quot;: **false**\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 581, "user_id": 2799940, "user_type": "registered", "accept_rate": 13, "profile_image": "https://www.gravatar.com/avatar/e4fd00e6b370e5627b4ec535d036541f?s=128&d=identicon&r=PG&f=1", "display_name": "Know Nothing", "link": "https://stackoverflow.com/users/2799940/know-nothing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12616, "favorite_count": 8, "answer_count": 8, "score": 23, "last_activity_date": 1618674481, "creation_date": 1515216544, "last_edit_date": 1515404143, "question_id": 48124565, "link": "https://stackoverflow.com/questions/48124565/why-does-vscode-delete-golang-source-on-save", "title": "Why does vscode delete golang source on save", "body": "<p>why can't save these line of code in vscode with golang extension</p>\n\n<pre><code>package app\n\nimport (\n  \"fmt\"\n)\n\n//this is just func\nfunc TestingHello(){\n  fmt.Println(\"Hissssss\")\n}\n</code></pre>\n\n<p>only the <code>package app</code> stays and remaining part got deleted on save in vscode.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 1, "creation_date": 1515232419, "post_id": 48124408, "comment_id": 83228999, "body": "Also note that a call to <code>os.Exit</code> will exit the program immediately, so there is no need to have the big <code>else</code> block. It doesn&#39;t really matter since the code is so small and simple, but for future reference, it would probably be better control flow to return <code>(string, error)</code> and call <code>os.Exit</code> from your main function <code>if err != nil</code>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1515234455, "post_id": 48124408, "comment_id": 83229499, "body": "Please take <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">A Tour of Go</a>. This question would never have been asked if you had even the most trivial understanding of Go."}], "answers": [{"tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": false, "score": 2, "last_activity_date": 1515215526, "creation_date": 1515215526, "answer_id": 48124475, "question_id": 48124408, "link": "https://stackoverflow.com/questions/48124408/return-data-from-a-function/48124475#48124475", "title": "Return data from a function", "body": "<p>Your function returns nothing:</p>\n\n<pre><code>func getbalance(address string) {\n   ....\n}\n</code></pre>\n\n<p>That function signature, return string:</p>\n\n<pre><code>func getbalance(address string) string {\n  ...\n}\n</code></pre>\n\n<p><sub>I suggest you to learn basic <a href=\"https://tour.golang.org/basics/4\" rel=\"nofollow noreferrer\">Go functions</a></sub></p>\n"}], "owner": {"reputation": 505, "user_id": 1237184, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9caabd5e72d6335175c7445750413d2d?s=128&d=identicon&r=PG", "display_name": "Bill Swearingen", "link": "https://stackoverflow.com/users/1237184/bill-swearingen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1515234460, "answer_count": 1, "score": -7, "last_activity_date": 1515215526, "creation_date": 1515214653, "last_edit_date": 1515215369, "question_id": 48124408, "link": "https://stackoverflow.com/questions/48124408/return-data-from-a-function", "closed_reason": "Not suitable for this site", "title": "Return data from a function", "body": "<p>I am trying to return data from a function. In this example, I am looking up a bitcoin address on Blockchain.info, and what I would like to do is call the function, passing it the address, and return the final balance in a variable that I can use. Can someone show me what I am doing wrong?</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n   \"io/ioutil\"\n   \"net/http\"\n    \"os\"\n)\n\nfunc getbalance(address string) {\n  response, err := http.Get(\"https://blockchain.info/q/addressbalance/\" + address)\n  if err != nil {\n      fmt.Printf(\"%s\", err)\n      os.Exit(1)\n  } else {\n      defer response.Body.Close()\n      contents, err := ioutil.ReadAll(response.Body)\n      if err != nil {\n          fmt.Printf(\"%s\", err)\n          os.Exit(1)\n      }\n      fmt.Printf(\"%s\\n\", string(contents))\n      return string(contents)\n  }\n}\n\n\nfunc main() {\n  finalB := getbalance(\"1A63imbiQBtsnTqtUpuUT5WL2Ti7oKNLeg\")\n  fmt.Printf(\"Final Balance: %s\", finalB)\n}\n</code></pre>\n"}, {"tags": ["docker", "go"], "answers": [{"comments": [{"owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "edited": false, "score": 0, "creation_date": 1515396256, "post_id": 48124393, "comment_id": 83269737, "body": "Well done on solving the issue. Please accept your own answer"}, {"owner": {"reputation": 358, "user_id": 361583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f7eba1b091276f51d22ef24b2a2ac1?s=128&d=identicon&r=PG", "display_name": "wasil", "link": "https://stackoverflow.com/users/361583/wasil"}, "edited": false, "score": 0, "creation_date": 1606826318, "post_id": 48124393, "comment_id": 115074149, "body": "Maybe someone will find it helpful: in my case, I had multi stage Dockerfile in which first stage was building Go executable which was afterwards copied and run in second stage. Problem was that first stage used <code>Debian-based</code> image, and the second - <code>Alpine</code> based. After using same image for both stages, everything started to work without any additional settings :)"}], "tags": [], "owner": {"reputation": 1973, "user_id": 72721, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/87bd5e904102ed9355e67afc0d1463e8?s=128&d=identicon&r=PG&f=1", "display_name": "Rohith", "link": "https://stackoverflow.com/users/72721/rohith"}, "is_accepted": true, "score": 3, "last_activity_date": 1515477415, "last_edit_date": 1515477415, "creation_date": 1515214435, "answer_id": 48124393, "question_id": 48124388, "link": "https://stackoverflow.com/questions/48124388/unable-to-run-a-go-program-inside-docker-bin-sh-program-not-found/48124393#48124393", "title": "Unable to run a go program inside docker /bin/sh: &lt;program&gt;: not found", "body": "<p>Initially, I thought that the problem was because I was compiling the go program for the wrong architecture. It was being compiled for amd64. When I tried compiling it for 386 (with GOARCH=386) it seemed to start up. On further investigation, the container was running centos 64 bit (checked using <code>uname -m</code> and <code>getconf LONG_BIT</code>). Finally the solution that worked is setting CGO_ENABLED=0 before compiling (see <a href=\"https://stackoverflow.com/a/36308464/72721\">here</a>)  </p>\n"}], "owner": {"reputation": 1973, "user_id": 72721, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/87bd5e904102ed9355e67afc0d1463e8?s=128&d=identicon&r=PG&f=1", "display_name": "Rohith", "link": "https://stackoverflow.com/users/72721/rohith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2149, "favorite_count": 1, "accepted_answer_id": 48124393, "answer_count": 1, "score": 1, "last_activity_date": 1515477415, "creation_date": 1515214360, "last_edit_date": 1515214521, "question_id": 48124388, "link": "https://stackoverflow.com/questions/48124388/unable-to-run-a-go-program-inside-docker-bin-sh-program-not-found", "title": "Unable to run a go program inside docker /bin/sh: &lt;program&gt;: not found", "body": "<p>I'm building my go program in WSL (bash on windows), mounting the output folder as a volume in a centos docker container and attempting to run the program. When attempting to run the program like so:</p>\n\n<pre><code>docker exec -it &lt;container-instance&gt; /bin/sh\n# ./&lt;program-name&gt;\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>/bin/sh: ./&lt;program-name&gt;: not found\n</code></pre>\n\n<p>What gives?</p>\n"}, {"tags": ["google-app-engine", "go", "datastore"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1515228334, "post_id": 48124262, "comment_id": 83228022, "body": "This article contains everything you need for this task with example code: <a href=\"https://cloud.google.com/appengine/articles/indexselection\" rel=\"nofollow noreferrer\">Index Selection and Advanced Search</a>"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1515228366, "post_id": 48124262, "comment_id": 83228029, "body": "Please show the values of <code>patient</code> before <code>NewQuery</code>, <code>patients</code> after <code>GetAll</code>, the value of <code>KINDPATIENT</code>. You may also want to query the datastore to make sure your data is as expected."}, {"owner": {"reputation": 33, "user_id": 8295662, "user_type": "registered", "profile_image": "https://graph.facebook.com/1187650834683871/picture?type=large", "display_name": "Srinath Reddy", "link": "https://stackoverflow.com/users/8295662/srinath-reddy"}, "edited": false, "score": 0, "creation_date": 1515229861, "post_id": 48124262, "comment_id": 83228350, "body": "I want to filter the values either with PHONE or FIRSTNAME or LASTNAME. Is it possible with DATASTORE by using FILTER."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8295662, "user_type": "registered", "profile_image": "https://graph.facebook.com/1187650834683871/picture?type=large", "display_name": "Srinath Reddy", "link": "https://stackoverflow.com/users/8295662/srinath-reddy"}, "edited": false, "score": 0, "creation_date": 1515231634, "post_id": 48126011, "comment_id": 83228807, "body": "<code>if (patient.FirstName != &quot;&quot; ){ \t q = datastore.NewQuery(KINDPATIENT).Filter(&quot;FirstName=&quot;,patient.&zwnj;&#8203;FirstName) \t \t}else if(patient.LastName != &quot;&quot;){  \t\tq = datastore.NewQuery(KINDPATIENT).Filter(&quot;LastName =&quot;, patient.LastName) \t\t \t}else if(patient.Phone != &quot;&quot;){ \t\tq = datastore.NewQuery(KINDPATIENT).Filter(&quot;Phone =&quot;, patient.Phone) \t\t \t}</code>  In these way i am doing .is it makes sense"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "reply_to_user": {"reputation": 33, "user_id": 8295662, "user_type": "registered", "profile_image": "https://graph.facebook.com/1187650834683871/picture?type=large", "display_name": "Srinath Reddy", "link": "https://stackoverflow.com/users/8295662/srinath-reddy"}, "edited": false, "score": 0, "creation_date": 1515231988, "post_id": 48126011, "comment_id": 83228890, "body": "You&#39;re not doing an OR search. If I specify both <code>firstname</code> and <code>lastname</code>, you will not search for <code>lastname</code> at all. I&#39;ve updated my answer with pseucode for what you want to do."}, {"owner": {"reputation": 33, "user_id": 8295662, "user_type": "registered", "profile_image": "https://graph.facebook.com/1187650834683871/picture?type=large", "display_name": "Srinath Reddy", "link": "https://stackoverflow.com/users/8295662/srinath-reddy"}, "edited": false, "score": 0, "creation_date": 1515248793, "post_id": 48126011, "comment_id": 83233246, "body": "The above code is not working for me i am getting an error showing that CANNOT USE QUERY , removeDuplicates(undefined) i am using datastore.NewQuery"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "reply_to_user": {"reputation": 33, "user_id": 8295662, "user_type": "registered", "profile_image": "https://graph.facebook.com/1187650834683871/picture?type=large", "display_name": "Srinath Reddy", "link": "https://stackoverflow.com/users/8295662/srinath-reddy"}, "edited": false, "score": 0, "creation_date": 1515249151, "post_id": 48126011, "comment_id": 83233340, "body": "I did say it was pseudocode, not actual code. you&#39;ll have to write <code>removeDuplicates</code> yourself, and <code>query(...)</code> stands for building/sending a query and parsing the result."}, {"owner": {"reputation": 33, "user_id": 8295662, "user_type": "registered", "profile_image": "https://graph.facebook.com/1187650834683871/picture?type=large", "display_name": "Srinath Reddy", "link": "https://stackoverflow.com/users/8295662/srinath-reddy"}, "edited": false, "score": 0, "creation_date": 1515252836, "post_id": 48126011, "comment_id": 83234335, "body": "i stuck with that .can you help me"}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": false, "score": 0, "last_activity_date": 1515249171, "last_edit_date": 1515249171, "creation_date": 1515231134, "answer_id": 48126011, "question_id": 48124262, "link": "https://stackoverflow.com/questions/48124262/search-the-record-based-on-struct-values-in-golang/48126011#48126011", "title": "Search the record based on struct values in golang", "body": "<p>If I understand correctly, you're trying to combine filters with <code>OR</code>. According to <a href=\"https://cloud.google.com/datastore/docs/concepts/queries#filters\" rel=\"nofollow noreferrer\">the docs</a>, this is not possible: </p>\n\n<blockquote>\n  <p>Cloud Datastore currently only natively supports combining filters\n  with the AND operator.</p>\n</blockquote>\n\n<p>There's a <a href=\"https://github.com/GoogleCloudPlatform/google-cloud-datastore/issues/36\" rel=\"nofollow noreferrer\">tracking issue</a> for this, but it's been there for ages with no action.</p>\n\n<p>You can instead issue a separate query for each filter, then merge the results (query for firstname, then query for lastname, then query for phone. Finally: combine all returns results while removing duplicates).</p>\n\n<p>Something along the lines of (pseudocode, but that's the logic for an OR search):</p>\n\n<pre><code>var results []Patients\nif firstname != \"\" {\n  results = append(results, query(\"firstname = \", firstname)\n}\nif lastname != \"\" {\n  results = append(results, query(\"lastname = \", lastname)\n}\netc...\nremoveDuplicates(results)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8295662, "user_type": "registered", "profile_image": "https://graph.facebook.com/1187650834683871/picture?type=large", "display_name": "Srinath Reddy", "link": "https://stackoverflow.com/users/8295662/srinath-reddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 392, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515411225, "creation_date": 1515212843, "last_edit_date": 1515411225, "question_id": 48124262, "link": "https://stackoverflow.com/questions/48124262/search-the-record-based-on-struct-values-in-golang", "title": "Search the record based on struct values in golang", "body": "<p>I am writing a service for search functionality. when i am passing values in the body to get the specific record i am able to get it based on the struct value only for PHONE.</p>\n\n<p>I am very new to golang.</p>\n\n<p>i need to search the values using all the fields  in the struct for  ex.phone or firstname or lastname of the patientstruct</p>\n\n<p>my struct is as below </p>\n\n<pre><code>type PatientEntity struct {\n    ID        int64 \n    FirstName string \n    LastName  string \n    Phone     string \n}\n</code></pre>\n\n<p>my code is</p>\n\n<pre><code>func SearchPatientsHandler(res http.ResponseWriter, req *http.Request) {\n    patient := &amp;PatientEntity{}\n    if err := json.NewDecoder(req.Body).Decode(patient); err != nil {\n        panic(err)\n    }\n\n    patients := []*PatientEntity{}  \n    q := datastore.NewQuery(KINDPATIENT).Filter(\"FirstName =\",patient.FirstName) \n\n    keys, err := q.GetAll(ctx, &amp;patients)\n\n    if err != nil {\n        // Handle error\n        return\n    }\n\n    json.NewEncoder(res).Encode(patients)\n}\n</code></pre>\n\n<p>i need to search with all the values of struct .how can i resolve.</p>\n"}, {"tags": ["google-chrome", "go", "godoc"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1515214220, "creation_date": 1515214220, "answer_id": 48124378, "question_id": 48124244, "link": "https://stackoverflow.com/questions/48124244/godoc-identifier-search-browser-interface/48124378#48124378", "title": "GoDoc Identifier search browser interface", "body": "<p>You typed \"F\" to bring up this interface. Type \"?\" for documentation on all keyboard shortcuts.  </p>\n\n<p>See <a href=\"https://godoc.org/-/about\" rel=\"nofollow noreferrer\">https://godoc.org/-/about</a> for information about more features.</p>\n"}], "owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "accepted_answer_id": 48124378, "answer_count": 1, "score": 1, "last_activity_date": 1515214220, "creation_date": 1515212632, "question_id": 48124244, "link": "https://stackoverflow.com/questions/48124244/godoc-identifier-search-browser-interface", "title": "GoDoc Identifier search browser interface", "body": "<p>I accidentally got to this UI when hitting some keys, but I don't remember what I pressed. What keys do I need to bring up this interface?</p>\n\n<p><a href=\"https://i.stack.imgur.com/loggW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/loggW.png\" alt=\"Id search\"></a></p>\n"}, {"tags": ["go", "null"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1515206554, "post_id": 48123767, "comment_id": 83224507, "body": "Why are you using the <code>types</code> package? Just check for <code>nil</code>."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1515206649, "creation_date": 1515206649, "answer_id": 48123803, "question_id": 48123767, "link": "https://stackoverflow.com/questions/48123767/type-of-nil-in-go/48123803#48123803", "title": "Type of nil in Go", "body": "<p>Use <code>nil</code>:</p>\n\n<pre><code>func main() {\n    switch someFunc().(type) {\n    case int:\n    case nil:\n        fmt.Println(\"5&gt;2\")\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/XcJwM2wnGZG\" rel=\"nofollow noreferrer\">https://play.golang.org/p/XcJwM2wnGZG</a></p>\n"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 778, "favorite_count": 0, "accepted_answer_id": 48123803, "answer_count": 1, "score": 0, "last_activity_date": 1515206649, "creation_date": 1515206224, "question_id": 48123767, "link": "https://stackoverflow.com/questions/48123767/type-of-nil-in-go", "title": "Type of nil in Go", "body": "<p>How can I handle <code>nil</code> return type in <code>switch-case</code> operators?</p>\n\n<pre><code>func someFunc() interface{}{\n    if 5&gt;2{\n        return nil\n    }else if something{\n        return 42\n    }\n    return nil\n}\n\nfunc main() {\n    switch someFunc().(type) {\n    case int:\n    case types.Nil:\n        fmt.Println(\"5&gt;2\")\n    }\n}\n</code></pre>\n\n<p>This code prints nothing, but I expected \"5>2\". \nHow should I do it properly?\n<a href=\"https://play.golang.org/p/vAdiH925LDl\" rel=\"nofollow noreferrer\">https://play.golang.org/p/vAdiH925LDl</a></p>\n"}, {"tags": ["unix", "go", "chmod"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515205923, "post_id": 48123541, "comment_id": 83224405, "body": "Numbers prefixed with <code>0</code> <i>are</i> octal. That\u2019s the common notation for it, just like the common prefix for hexidecimal is <code>0x</code>."}], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": false, "score": 3, "last_activity_date": 1515228553, "creation_date": 1515228553, "answer_id": 48125721, "question_id": 48123541, "link": "https://stackoverflow.com/questions/48123541/how-does-the-go-language-os-filemode-function-convert-permissions-from-integers/48125721#48125721", "title": "How does the go language os.FileMode function convert permissions from integers/octal/??? before setting the flags?", "body": "<p><code>os.FileMode</code> only knows about integers, it doesn't care whether the literal representation is octal or not.</p>\n\n<p>The fact that <code>0700</code> is interpreted in base 8 comes from the <a href=\"https://golang.org/ref/spec#Integer_literals\" rel=\"nofollow noreferrer\">language spec</a> itself:</p>\n\n<blockquote>\n  <p>An integer literal is a sequence of digits representing an integer\n  constant. An optional prefix sets a non-decimal base: 0 for octal, 0x\n  or 0X for hexadecimal. In hexadecimal literals, letters a-f and A-F\n  represent values 10 through 15.</p>\n</blockquote>\n\n<p>This is a fairly standard way of <a href=\"https://en.wikipedia.org/wiki/Octal#In_computers\" rel=\"nofollow noreferrer\">representing literal octal numbers</a> in programming languages.</p>\n"}, {"tags": [], "owner": {"reputation": 667, "user_id": 5627286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeYlo.jpg?s=128&g=1", "display_name": "aMike", "link": "https://stackoverflow.com/users/5627286/amike"}, "is_accepted": false, "score": 2, "last_activity_date": 1555206359, "creation_date": 1555206359, "answer_id": 55671322, "question_id": 48123541, "link": "https://stackoverflow.com/questions/48123541/how-does-the-go-language-os-filemode-function-convert-permissions-from-integers/55671322#55671322", "title": "How does the go language os.FileMode function convert permissions from integers/octal/??? before setting the flags?", "body": "<p>So your file mode was changed from the requested 0274 to the actual on-disk 0254. I'll bet that your umask is 0022. Sounds to me like everything is working fine.</p>\n"}], "owner": {"reputation": 554, "user_id": 776940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6b67f21cb40679174c25c0d41c07a84d?s=128&d=identicon&r=PG", "display_name": "Rob Fagen", "link": "https://stackoverflow.com/users/776940/rob-fagen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1628, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1555206359, "creation_date": 1515203442, "last_edit_date": 1515623993, "question_id": 48123541, "link": "https://stackoverflow.com/questions/48123541/how-does-the-go-language-os-filemode-function-convert-permissions-from-integers", "title": "How does the go language os.FileMode function convert permissions from integers/octal/??? before setting the flags?", "body": "<p><strong>Update</strong>: based on the comment and response so far, I guess I should make it explicit that I understand 0700 is the octal representation of the decimal number 448. My concern here is that when an octal mode parameter or when a decimal number is recast as octal and passed to the os.FileMode method the resulting permissions on the file created using WriteFile don't seem to line up in a way that makes sense.</p>\n\n<p>I worked as hard as I could to reduce the size of the question to its essence, maybe I need to go thru another round of that</p>\n\n<hr>\n\n<p>Update2: after re-re-reading, I think I can more succinctly state my issue. Calling os.FileMode(700) should be the same as calling it with the binary value 1-010-111-100. With those 9 least significant bits there should be permissions of:</p>\n\n<p><code>--w-rwxr--</code> or 274 in octal (and translates back to </p>\n\n<p>Instead, that FileMode results in WriteFile creating the file with: </p>\n\n<p><code>--w-r-xr--</code> which is 254 in octal.</p>\n\n<hr>\n\n<p>When using an internal utility written in go, there was a file creation permission bug caused by using decimal 700 instead of octal 0700 when creating the file with ioutil.WriteFile(). That is:\n<code>ioutil.WriteFile(\"decimal.txt\", \"filecontents\", 700) &lt;- wrong!</code>\n<code>ioutil.WriteFile(\"octal.txt\", \"filecontents\", 0700)  &lt;- correct!</code></p>\n\n<p>When using the decimal number (ie. no leading zero to identify it as an octal number to go_lang) the file that should have had permissions\n<code>0700 -&gt; '-rwx------'</code> had <code>0254 -&gt; '--w-r-xr--'</code></p>\n\n<p>After it was fixed, I noticed that when I converted 700 decimal to octal, I got \u201c1274\u201d instead of the experimental result of \"0254\". </p>\n\n<p>When I converted 700 decimal to binary, I got: <code>1-010-111-100</code> (I added dashes where the rwx\u2019s are separated). This looks like a permission of \"0274\" except for that leading bit being set. </p>\n\n<p>I went looking at <a href=\"https://golang.org/pkg/os/#FileMode\" rel=\"nofollow noreferrer\">the go docs for FileMode</a> and saw that under the covers FileMode is a uint32. The nine smallest bits map onto the standard unix file perm structure. The top 12 bits indicate special file features. I think that one leading bit in the tenth position is in unused territory.</p>\n\n<p>I was still confused, so I tried:</p>\n\n\n\n<pre><code>package main\nimport (\n    \"io/ioutil\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    content := []byte(\"temporary file's content\")\n    modes := map[string]os.FileMode{\n        \"700\": os.FileMode(700),\n        \"0700\": os.FileMode(0700),\n        \"1274\": os.FileMode(1274),\n        \"01274\": os.FileMode(01274)}\n    for name, mode := range modes {\n        if err := ioutil.WriteFile(name, content, mode); err != nil {\n            fmt.Println(\"error creating \", name, \" as \", mode)\n        }\n        if fi, err := os.Lstat(name); err == nil {\n            mode := fi.Mode()\n            fmt.Println(\"file\\t\", name, \"\\thas \", mode.String())\n        }\n    }\n}\n</code></pre>\n\n<p>And now I'm even more confused. The results I got are:</p>\n\n<pre><code>file     700    has  --w-r-xr--\nfile     0700   has  -rwx------\nfile     1274   has  --wxr-x---\nfile     01274  has  --w-r-xr--\n</code></pre>\n\n<p>and was confirmed by looking at the filesystem:</p>\n\n<pre><code>--w-r-xr--     1 rfagen  staff           24 Jan  5 17:43 700\n-rwx------     1 rfagen  staff           24 Jan  5 17:43 0700\n--wxr-x---     1 rfagen  staff           24 Jan  5 17:43 1274\n--w-r-xr--     1 rfagen  staff           24 Jan  5 17:43 01274\n</code></pre>\n\n<ul>\n<li>The first one is the broken situation that triggered the original bug in the internal application. </li>\n<li>The second one is the corrected code working as expected. </li>\n<li>The third one is bizarre, as 1274 decimal seems to translate into 0350</li>\n<li>The fourth one kind of makes a twisted sort of sense, given that dec(700)->oct(1274) and explicitly asking for 01274 gives the same puzzling 0254 as the first case.</li>\n</ul>\n\n<p>I have a vague suspicion that the extra part of the number larger than 2^9 is somehow messing it up but I can't figure it out, even after looking at <a href=\"https://golang.org/src/os/types.go?s=1131:1151#L25\" rel=\"nofollow noreferrer\">the source for FileMode</a>. As far as I can tell, it only ever looks at the 12 MSB and 9 LSB.</p>\n"}, {"tags": ["go", "operator-precedence"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 4, "creation_date": 1515203231, "post_id": 48123519, "comment_id": 83223996, "body": "Because the people who designed Go liked it more that way :)"}, {"owner": {"reputation": 4928, "user_id": 2736233, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/1R16X.png?s=128&g=1", "display_name": "Ivan Gabriele", "link": "https://stackoverflow.com/users/2736233/ivan-gabriele"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 2, "creation_date": 1542896325, "post_id": 48123519, "comment_id": 93739555, "body": "I don&#39;t understand why some members closed this question as <i>primarily opinion-based</i>. And I strongly disagree with @rici comment. If there is anything you <b>never</b> do when designing a programming language, especially within a company like Google, it&#39;s picking choices out of &quot;opinions&quot;. I&#39;m quite sure they started a RFC and seriously debated this design before making it, for well-argued reasons. Moreover, even if this question format is quite bad, the matter in itself is a very interesting one regarding SO standards."}], "answers": [{"comments": [{"owner": {"reputation": 52680, "user_id": 1673391, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d0fdf8fc4fd7daa19b20cd3f76d2a1e0?s=128&d=identicon&r=PG", "display_name": "Grijesh Chauhan", "link": "https://stackoverflow.com/users/1673391/grijesh-chauhan"}, "edited": false, "score": 0, "creation_date": 1542875750, "post_id": 48123537, "comment_id": 93727724, "body": "did not get you. Can you share some link to explore further?"}], "tags": [], "owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "is_accepted": false, "score": 4, "last_activity_date": 1515203416, "creation_date": 1515203416, "answer_id": 48123537, "question_id": 48123519, "link": "https://stackoverflow.com/questions/48123519/why-golang-shifting-operator-takes-precedence-over-addition/48123537#48123537", "title": "Why golang shifting operator takes precedence over addition?", "body": "<p>This is a difference in language philosophy and usability.\nGo views the operations as multiplication/division by powers of 2, a functional view.  The other languages regard it as a bit-based operators, which they class next to Boolean operators.  This is based more on a sense of common data type/view.</p>\n"}], "owner": {"reputation": 41, "user_id": 8181447, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BruVArmb5Bs/AAAAAAAAAAI/AAAAAAAAANc/TyDm9RSaJag/photo.jpg?sz=128", "display_name": "Hong Wang", "link": "https://stackoverflow.com/users/8181447/hong-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "closed_date": 1515205416, "answer_count": 1, "score": 0, "last_activity_date": 1556653307, "creation_date": 1515203148, "last_edit_date": 1556653307, "question_id": 48123519, "link": "https://stackoverflow.com/questions/48123519/why-golang-shifting-operator-takes-precedence-over-addition", "closed_reason": "Opinion-based", "title": "Why golang shifting operator takes precedence over addition?", "body": "<pre><code>java:  System.out.println(1 + (9 - 1) &gt;&gt; 1);  // OUPUT: \"4\"\n</code></pre>\n\n<pre><code>golang: fmt.Println(1 + (9 - 1) &gt;&gt; 1) // OUPUT: \"5\"\n</code></pre>\n\n<p>Go: <a href=\"https://kuree.gitbooks.io/the-go-programming-language-report/content/31/text.html\" rel=\"nofollow noreferrer\">https://kuree.gitbooks.io/the-go-programming-language-report/content/31/text.html</a></p>\n\n<p>Java: <a href=\"https://introcs.cs.princeton.edu/java/11precedence/\" rel=\"nofollow noreferrer\">https://introcs.cs.princeton.edu/java/11precedence/</a></p>\n\n<p>Python: <a href=\"http://www.mathcs.emory.edu/~valerie/courses/fall10/155/resources/op_precedence.html\" rel=\"nofollow noreferrer\">http://www.mathcs.emory.edu/~valerie/courses/fall10/155/resources/op_precedence.html</a></p>\n\n<p>C/C++: <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/c/language/operator_precedence</a></p>\n\n<p>It seems only golang >> is taking precedence over +? But why?</p>\n"}, {"tags": ["go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 9, "last_activity_date": 1515201711, "last_edit_date": 1515201711, "creation_date": 1515199227, "answer_id": 48123201, "question_id": 48123151, "link": "https://stackoverflow.com/questions/48123151/find-and-delete-elements-from-slice-in-golang/48123201#48123201", "title": "Find and delete elements from slice in golang", "body": "<p>Copy the surviving elements to the beginning of the slice, and reslice when done.</p>\n\n<pre><code>p := []int{1, -13, 9, 6, -21, 125}\nj := 0\n\nfor _, n := range p {\n    if n &gt;= 0 {\n        p[j] = n\n        j++\n    }\n}\np = p[:j]\n</code></pre>\n\n<p>No memory is allocated, but the original slice is modified. If you cannot modify the original slice, then allocate and copy to a new slice:</p>\n\n<pre><code>p := []int{1, -13, 9, 6, -21, 125}\nj := 0\nq := make([]int, len(p))\nfor _, n := range p {\n    if n &gt;= 0 {\n        q[j] = n\n        j++\n    }\n}\nq = q[:j] // q is copy with numbers &gt;= 0\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/gve4zlEqgaT\" rel=\"noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8087, "favorite_count": 1, "accepted_answer_id": 48123201, "answer_count": 1, "score": 3, "last_activity_date": 1515201711, "creation_date": 1515198831, "question_id": 48123151, "link": "https://stackoverflow.com/questions/48123151/find-and-delete-elements-from-slice-in-golang", "title": "Find and delete elements from slice in golang", "body": "<p>I have slice of numbers like <code>[1, -13, 9, 6, -21, 125]</code>. I want to find elements that are less than zero then delete them.</p>\n\n<p>It can be done by straightforward way: \njust iterate through slice and if element less than zero -> delete it. But it computationally costly because of possible slice changing on each step.   </p>\n\n<p>Is there any elegant way of doing it like <code>numpy.where(array, condition)</code> and <code>numpy.delete</code>?</p>\n"}, {"tags": ["google-app-engine", "nginx", "go"], "comments": [{"owner": {"reputation": 706, "user_id": 3105263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff6987b5d9588c8526a94e83439b6b9?s=128&d=identicon&r=PG", "display_name": "QuietOran", "link": "https://stackoverflow.com/users/3105263/quietoran"}, "edited": false, "score": 0, "creation_date": 1515198489, "post_id": 48123067, "comment_id": 83223052, "body": "your <code>script:</code> in your <code>app.yaml</code> should be pointing to <code>main.go</code>"}, {"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "reply_to_user": {"reputation": 706, "user_id": 3105263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff6987b5d9588c8526a94e83439b6b9?s=128&d=identicon&r=PG", "display_name": "QuietOran", "link": "https://stackoverflow.com/users/3105263/quietoran"}, "edited": false, "score": 0, "creation_date": 1515198604, "post_id": 48123067, "comment_id": 83223082, "body": "But Google&#39;s documentation states: <code>For Go apps, script should always have a value of _go_app.</code>? <a href=\"https://cloud.google.com/appengine/docs/standard/go/config/appref#handlers_element\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/standard/go/config/&hellip;</a>"}, {"owner": {"reputation": 706, "user_id": 3105263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff6987b5d9588c8526a94e83439b6b9?s=128&d=identicon&r=PG", "display_name": "QuietOran", "link": "https://stackoverflow.com/users/3105263/quietoran"}, "edited": false, "score": 0, "creation_date": 1515199289, "post_id": 48123067, "comment_id": 83223258, "body": "my bad, just checked again. You say that it runs locally just fine without the <code>appengine.Main()</code>, does the same happen when uploaded?"}, {"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "reply_to_user": {"reputation": 706, "user_id": 3105263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff6987b5d9588c8526a94e83439b6b9?s=128&d=identicon&r=PG", "display_name": "QuietOran", "link": "https://stackoverflow.com/users/3105263/quietoran"}, "edited": false, "score": 0, "creation_date": 1515199335, "post_id": 48123067, "comment_id": 83223272, "body": "No, if you upload without <code>appengine.Main()</code>, you get the error: <code>parser: found a top level package main with function main, but main does not call appengine.Main();</code>"}, {"owner": {"reputation": 706, "user_id": 3105263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff6987b5d9588c8526a94e83439b6b9?s=128&d=identicon&r=PG", "display_name": "QuietOran", "link": "https://stackoverflow.com/users/3105263/quietoran"}, "edited": false, "score": 0, "creation_date": 1515199469, "post_id": 48123067, "comment_id": 83223307, "body": "is your app engine using the Flexible Environment? on the appengine github it states it is not compatible with that environment: <a href=\"https://github.com/golang/appengine\" rel=\"nofollow noreferrer\">github.com/golang/appengine</a>"}, {"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "reply_to_user": {"reputation": 706, "user_id": 3105263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff6987b5d9588c8526a94e83439b6b9?s=128&d=identicon&r=PG", "display_name": "QuietOran", "link": "https://stackoverflow.com/users/3105263/quietoran"}, "edited": false, "score": 0, "creation_date": 1515199518, "post_id": 48123067, "comment_id": 83223320, "body": "No, I&#39;m using the standard one :)"}], "answers": [{"comments": [{"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 1, "creation_date": 1515237496, "post_id": 48123362, "comment_id": 83230211, "body": "It now returns JSON! Though, it&#39;s empty. <code>lib.GetStockData()</code> isn&#39;t run? It doesn&#39;t log what it should. Though the http server now responds 200, it never runs any of my <code>fmt.Println</code> commands.. Strange?"}, {"owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "edited": false, "score": 0, "creation_date": 1534177966, "post_id": 48123362, "comment_id": 90607971, "body": "This answer also worked for me for deploying my app on App Engine - Standard in GCP. After 4 days of playing with these scripts, this was finally the solution that worked (and the only place in the web where this solution apparently exists in relation to App Engine). Thank you very much! +1"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1515201170, "creation_date": 1515201170, "answer_id": 48123362, "question_id": 48123067, "link": "https://stackoverflow.com/questions/48123067/google-app-engine-golang-returns-404-page-not-found/48123362#48123362", "title": "Google App Engine Golang returns 404 page not found", "body": "<p>The standard environment provides the main program and runs the http server. Put your initialization code in an init() function. Do not use package main.</p>\n\n<pre><code>package app\n\nimport (\n    \"github.com/cbll/stockmarket-service/lib\"\n    \"net/http\"\n)\n\nfunc init() {\n    go lib.GetStockData()\n    http.HandleFunc(\"/\", lib.StocksHandler)\n}\n</code></pre>\n"}], "owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 602, "favorite_count": 0, "accepted_answer_id": 48123362, "answer_count": 1, "score": 0, "last_activity_date": 1515201170, "creation_date": 1515198049, "question_id": 48123067, "link": "https://stackoverflow.com/questions/48123067/google-app-engine-golang-returns-404-page-not-found", "title": "Google App Engine Golang returns 404 page not found", "body": "<p><code>app.yaml</code></p>\n\n<pre><code>runtime: go\napi_version: go1\n\nhandlers:\n- url: /.*\n  script: _go_app\n</code></pre>\n\n<p>My <code>main.go</code> file:</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"github.com/cbll/stockmarket-service/lib\"\n    \"net/http\"\n    \"log\"\n    \"google.golang.org/appengine\"\n)\n\nfunc main() {\n    appengine.Main()\n    fmt.Println(\"Starting the application...\")\n    // Run application until halted\n    for {\n        go lib.GetStockData()\n        StockController()\n    }\n}\n\n\n// Expose controller at http://localhost:8080/\nfunc StockController() {\n    var port = \":8080\"\n\n    fmt.Println(\"Starting web server listening on port\", port)\n\n    http.HandleFunc(\"/\", lib.StocksHandler)\n    log.Fatal(http.ListenAndServe(port, nil))\n}\n</code></pre>\n\n<p>If I comment out the <code>appengine.Main()</code>, I can run it locally without any issues. It starts on port <code>8080</code>.</p>\n\n<p><code>gcloud app deploy</code> works without issues and will correctly deploy the app to google cloud.</p>\n\n<p>However, <code>gcloud app browse</code> which takes me to the site returns <code>404 page not found</code>. And indeed, checking the logs with <code>gcloud app logs read</code>:</p>\n\n<pre><code>2018-01-06 00:04:18 default[20180106t010155]  + exec app\n2018-01-06 00:08:32 default[20180106t010155]  \"GET /\" 404\n</code></pre>\n\n<p>I'm a bit unsure of where to troubleshoot it here. It works locally, and it specifies :8080 as the port as it should(as far as I know?), and imports the appengine main method. What could I be missing?</p>\n\n<p>Edit:</p>\n\n<p>Changing the handlers to</p>\n\n<p><code>- url: /</code></p>\n\n<p>Results in:</p>\n\n<pre><code>2018-01-06 00:17:30 default[20180106t010915]  \"GET / HTTP/1.1\" 404\n</code></pre>\n\n<p>.. instead?</p>\n"}, {"tags": ["go", "intellij-idea", "import"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515189601, "post_id": 48121823, "comment_id": 83220456, "body": "Go imports are relative to GOPATH, never use relative import paths."}, {"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1515189689, "post_id": 48121823, "comment_id": 83220481, "body": "Ok. How would I solve it with this setup, then?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1515189812, "post_id": 48121823, "comment_id": 83220522, "body": "Follow the instructions at <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>"}], "owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1481, "favorite_count": 0, "closed_date": 1515189738, "answer_count": 0, "score": 0, "last_activity_date": 1515189783, "creation_date": 1515189333, "question_id": 48121823, "link": "https://stackoverflow.com/questions/48121823/go-install-go-local-import-app-lib-in-non-local-package", "closed_reason": "Duplicate", "title": "Go install: Go local import &quot;../app/lib&quot; in non-local package", "body": "<p>The code works with <code>go build main.go</code> and will run the application. However, <code>go install</code> will throw an error. What gives?</p>\n\n<p>Project structure:</p>\n\n<pre><code>app/\n    main.go\n    lib/\n        StockMarketController.go\n        GetStockMarketData.go\n</code></pre>\n\n<p>In my <code>main.go</code>, the two other .go files are imported as such:</p>\n\n<pre><code>import (\n    Lib \"../stockmarket-service/lib\"\n)\n</code></pre>\n\n<p>And called as such:</p>\n\n<pre><code>Lib.SomeFunction()\n</code></pre>\n\n<p>And it works!</p>\n\n<p>Why does it fail with <code>go install</code>? How do I fix my import of them? </p>\n\n<p>I'm using IntelliJ IDEA and building it in there with <code>go build</code>, the directory is <code>~./IdeaProjects/app</code>, could this be the issue?</p>\n"}, {"tags": ["regex", "go", "functional-programming"], "comments": [{"owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "edited": false, "score": 0, "creation_date": 1515186174, "post_id": 48121207, "comment_id": 83219053, "body": "Doesn&#39;t allow lookbehinds: <a href=\"https://github.com/google/re2/wiki/Syntax\" rel=\"nofollow noreferrer\">github.com/google/re2/wiki/Syntax</a>. It also doesn&#39;t support lookaheads"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1515186204, "post_id": 48121207, "comment_id": 83219072, "body": "Lookarounds are not supported in the stdlib regular expression parser: <a href=\"https://golang.org/pkg/regexp/syntax/\" rel=\"nofollow noreferrer\">golang.org/pkg/regexp/syntax</a>"}, {"owner": {"reputation": 91, "user_id": 7187595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/920037328128602/picture?type=large", "display_name": "Gustavo Yance", "link": "https://stackoverflow.com/users/7187595/gustavo-yance"}, "edited": false, "score": 0, "creation_date": 1515188650, "post_id": 48121207, "comment_id": 83220091, "body": "know if it&#39;s possible to find alone characters with regexp?"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 7187595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/920037328128602/picture?type=large", "display_name": "Gustavo Yance", "link": "https://stackoverflow.com/users/7187595/gustavo-yance"}, "edited": false, "score": 0, "creation_date": 1515188525, "post_id": 48121410, "comment_id": 83220039, "body": "positive lookahead are not supported supported too :&#39;("}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "reply_to_user": {"reputation": 91, "user_id": 7187595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/920037328128602/picture?type=large", "display_name": "Gustavo Yance", "link": "https://stackoverflow.com/users/7187595/gustavo-yance"}, "edited": false, "score": 0, "creation_date": 1515431792, "post_id": 48121410, "comment_id": 83289013, "body": "Oh, you&#39;re right. Then the only option is you have to capture before and after <code>((^|\\s)\\S)(\\s)(\\S(\\s|$))</code>. But, this sets the next match position past the last <code>\\s</code> which could be used for that match if <code>\\s</code> from the last match were available. If you are replacing the middle <code>\\s</code> with a non-space, you could restart the match from the beginning each time. Another alternative is to set the match position each time if that&#39;s possible. The final alternative is to scrap the crappy language and get a real lang that doesn&#39;t use RE2."}, {"owner": {"reputation": 91, "user_id": 7187595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/920037328128602/picture?type=large", "display_name": "Gustavo Yance", "link": "https://stackoverflow.com/users/7187595/gustavo-yance"}, "edited": false, "score": 1, "creation_date": 1515442105, "post_id": 48121410, "comment_id": 83293917, "body": "At the end i opted for creating a function to join stand alone characters:"}, {"owner": {"reputation": 91, "user_id": 7187595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/920037328128602/picture?type=large", "display_name": "Gustavo Yance", "link": "https://stackoverflow.com/users/7187595/gustavo-yance"}, "edited": false, "score": 1, "creation_date": 1515442125, "post_id": 48121410, "comment_id": 83293930, "body": "func joinStandAloneChars(str string) string{     arrayStr:= strings.Split(str,&quot; &quot;)     newStr := &quot;&quot;     for _,element := range arrayStr{         if element != &quot; &quot; &amp;&amp; element != &quot;&quot;{              if len(element) == 1 {                 newStr += element;             }else{                 if len(newStr)&gt;1 &amp;&amp; string(newStr[len(newStr)-1:]) == &quot; &quot;   {                     newStr += element +&quot; &quot;;                 }else{                     newStr +=&quot; &quot;+ element +&quot; &quot;;                 }                              }         }      }     return newStr }"}, {"owner": {"reputation": 91, "user_id": 7187595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/920037328128602/picture?type=large", "display_name": "Gustavo Yance", "link": "https://stackoverflow.com/users/7187595/gustavo-yance"}, "edited": false, "score": 2, "creation_date": 1515442153, "post_id": 48121410, "comment_id": 83293938, "body": "regexp of go gave me a headeache :("}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "is_accepted": true, "score": 0, "last_activity_date": 1515187042, "creation_date": 1515187042, "answer_id": 48121410, "question_id": 48121207, "link": "https://stackoverflow.com/questions/48121207/error-in-regexp-go-lang/48121410#48121410", "title": "Error in regexp Go lang", "body": "<p>If no lookbehinds supported, use a workaround like this:  </p>\n\n<p><code>((^|\\s)\\S)(\\s)(?=\\S(\\s|$))</code>  </p>\n\n<p>where:</p>\n\n<p>Capture group 1 contains what's to be written back in place of the<br>\nlookbehind.   </p>\n\n<p>Capture group 3 is the actual whitespace in question.<br>\nIt's in a capture group just to separate it from the entire match.  </p>\n\n<p>Summary: Group 1 + Group 3 = entire match.</p>\n\n<p>Expanded:  </p>\n\n<pre><code> #  (                             # (1 start)\n #       (?&lt;= ^ [^\\s] )\n #    |  (?&lt;= \\s [^\\s] )\n #  )                             # (1 end)\n\n (                             # (1 start)\n      ( ^ | \\s )                    # (2)\n      \\S \n )                             # (1 end)\n ( \\s )                        # (3)\n (?=\n      \\S \n      ( \\s | $ )                    # (4)\n )\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 7187595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/920037328128602/picture?type=large", "display_name": "Gustavo Yance", "link": "https://stackoverflow.com/users/7187595/gustavo-yance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1060, "favorite_count": 0, "accepted_answer_id": 48121410, "answer_count": 1, "score": 0, "last_activity_date": 1515187042, "creation_date": 1515186068, "last_edit_date": 1515186471, "question_id": 48121207, "link": "https://stackoverflow.com/questions/48121207/error-in-regexp-go-lang", "title": "Error in regexp Go lang", "body": "<p>I'm trying to use this regular expressions in Go lang: </p>\n\n<pre><code>~((?&lt;=^[^\\s])|(?&lt;=\\s[^\\s]))\\s(?=[^\\s](\\s|$))~\n\n{(c|d|e|i|l|n|o|p|r|t|z)\\1+}\n\n{( |a|b|d|[f-h]|i|[j-k]|m|q|s|[u-y])\\1+}\n\n{(c|d|e|i|l|n|o|p|r|t|z)\\1+}\n\n{( |a|b|[f-h]|i|[j-k]|m|q|s|[u-y])\\1+}\n\n{(si|sa|za|ja|to)\\1+}\n</code></pre>\n\n<p>and in everyone of those i get this error: </p>\n\n<blockquote>\n  <p>panic: regexp: Compile(<code>~((?&lt;=^[^\\s])|(?&lt;=\\s[^\\s]))\\s(?=[^\\s](\\s|$))~</code>): error parsing regexp: invalid or unsupported Perl syntax: <code>(?&lt;</code></p>\n</blockquote>\n\n<p>Maybe there is a trick know for someone? :/ or is it impossible to use them?</p>\n"}]