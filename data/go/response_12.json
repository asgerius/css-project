[{"tags": ["go"], "comments": [{"owner": {"reputation": 6849, "user_id": 1896761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e28ac3e5849a144937aa74efbc272e?s=128&d=identicon&r=PG", "display_name": "Austin Mullins", "link": "https://stackoverflow.com/users/1896761/austin-mullins"}, "edited": false, "score": 0, "creation_date": 1427928709, "post_id": 29402046, "comment_id": 46979915, "body": "I couldn&#39;t repeat this problem running Go 1.2 on Windows. Maybe it&#39;s a bug?"}, {"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "reply_to_user": {"reputation": 6849, "user_id": 1896761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e28ac3e5849a144937aa74efbc272e?s=128&d=identicon&r=PG", "display_name": "Austin Mullins", "link": "https://stackoverflow.com/users/1896761/austin-mullins"}, "edited": false, "score": 0, "creation_date": 1427928948, "post_id": 29402046, "comment_id": 46979996, "body": "I found what I needed to do to fix the problem, but I&#39;m still at a lose for explaining what caused it. I don&#39;t know what caused <code>util.a</code> to be cached."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1427929393, "post_id": 29402232, "comment_id": 46980138, "body": "This is another reason to use <code>go install</code> instead of <code>go build</code> or <code>go run</code>"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427929579, "post_id": 29402232, "comment_id": 46980191, "body": "This happened to me when I started Go and I tell you what .. I lost <i>a lot</i> of time figuring out what the problem was. Glad you got it sorted."}, {"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 0, "creation_date": 1427929694, "post_id": 29402232, "comment_id": 46980224, "body": "I am still open to understanding what created the pkg folder and it&#39;s content. At least I figured out my &quot;code disconnect&quot; problem."}, {"owner": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "edited": false, "score": 0, "creation_date": 1427944960, "post_id": 29402232, "comment_id": 46983930, "body": "you can use the -a option for the build command to force dependencies to be rebuilt as well in case funny things like this happen again. Otherwise, <code>go build</code> will only build 023.go with the cached dependency no matter how many times you change the util.go file. It worked with the function in main.go because you were building the main file each time. To fix this in another way, you would&#39;ve had to rebuild util.go after altering the file each time.   In short, <code>go build -a 023.go</code>"}], "tags": [], "owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "is_accepted": false, "score": 1, "last_activity_date": 1427928777, "creation_date": 1427928777, "answer_id": 29402232, "question_id": 29402046, "link": "https://stackoverflow.com/questions/29402046/function-not-behaving-properly-when-imported-from-an-external-file-but-fine-when/29402232#29402232", "title": "Function not behaving properly when imported from an external file but fine when in the same file?", "body": "<p>After a little more toying around, I've found that there exists a <code>/Project Euler/pkg</code> folder with a <code>util.a</code> inside it. Apparently a version of my code was built and it's intermediate files were cached.</p>\n\n<p>After deleting the pkg folder, everything fell into place. The mismatched function names became a compiler error, then (after correcting the function names) my util.go <code>fmt.Println</code> calls were starting to print, and my answer was coming out as <code>16</code>. In the end this wasn't a code solution, it was a caching problem.</p>\n"}, {"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1427953132, "post_id": 29404513, "comment_id": 46986088, "body": "<code>go run</code> works for fully self-contained script-like programs but that&#39;s it."}, {"owner": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1428093998, "post_id": 29404513, "comment_id": 47047596, "body": "@twotwotwo, yes. If he&#39;s just building a package then he could use <code>build</code> instead. And run for running."}], "tags": [], "owner": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "is_accepted": false, "score": 3, "last_activity_date": 1427945321, "creation_date": 1427945321, "answer_id": 29404513, "question_id": 29402046, "link": "https://stackoverflow.com/questions/29402046/function-not-behaving-properly-when-imported-from-an-external-file-but-fine-when/29404513#29404513", "title": "Function not behaving properly when imported from an external file but fine when in the same file?", "body": "<p>Use <code>go build -a 023.go</code></p>\n\n<p>This will rebuild all dependencies that 023.go has and will avoid using old compiled versions of a package. This is one of go's strong suits that enables faster build times but it can cause these types of problems too.</p>\n\n<p>As I mentioned in my comment, you kept building 023.go but you probably didn't run <code>go build util.go</code> to  update the util package that 023.go depended on. </p>\n\n<p>The -a option will rebuild all dependencies and you can even add <code>-v</code> to see what it is building and when.</p>\n\n<p><code>go build -a -v 023.go</code></p>\n\n<p>OR</p>\n\n<p><code>go run -a -v 023.go</code></p>\n\n<p>Run, build, clean, and test have similar flags. Run <code>go help build</code> for more info.</p>\n"}], "owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1427945321, "creation_date": 1427927710, "last_edit_date": 1427928390, "question_id": 29402046, "link": "https://stackoverflow.com/questions/29402046/function-not-behaving-properly-when-imported-from-an-external-file-but-fine-when", "title": "Function not behaving properly when imported from an external file but fine when in the same file?", "body": "<p>I'm working on Project Euler questions in order to get used to Go. The question is not about Project Euler, but there is Project Euler specific code in this question that might give away the challenge of a question. \"Spoiler Alert\" or whatever, but now you know. Here's my file structure:</p>\n\n<pre><code>+ Project Euler\n+-+ Go       &lt;= GOPATH set here\n  +-+ src\n    +-+ util\n    | +- util.go\n    |\n    +- 001.go\n    +- 002.go\n    ...\n    +- 023.go\n</code></pre>\n\n<p>For problem 23, I'm adding a new function <code>SumOfDivisors</code> to util.go (a file with various methods used by multiple problems):</p>\n\n<pre><code>func GetPrimeFactors(val int) map[int]int {\n    primes := map[int]int{}\n    init := val\n    num := 2\n    for val &gt; 1 {\n        if (val % num) == 0 {\n            if num == init {\n                return nil\n            }\n            _, e := primes[num]\n            if e {\n                primes[num]++\n            } else {\n                primes[num] = 1\n            }\n            val /= num\n        } else {\n            num++\n        }\n    }\n    return primes\n}\n\nfunc SumOfDivisors(val int) int {\n    primes := GetPrimeFactors(val)\n    if primes == nil {\n        if val == 0 {\n            return 0\n        } else {\n            return 1\n        }\n    }\n    total := 1\n    for k, v := range primes {\n        if v &gt; 1 {\n            n := int((math.Pow(float64(k), float64(v+1)) - 1) / float64(k-1))\n            total *= n\n        } else {\n            n := k + 1\n            total *= n\n        }\n    }\n    return total - val\n}\n</code></pre>\n\n<p>In order to test this method, I wrote this basic Go inside 023.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"util\"\n)\n\nfunc main() {\n    fmt.Println(util.SumOfDivisors(12))\n}\n</code></pre>\n\n<p>I have my <code>GOPATH</code> set to <code>/Project Euler/Go</code> and it builds and runs seemingly fine when I call <code>go run 023.go</code>. \"Seemingly fine\" meaning there are no errors, warnings, no output other than my code.</p>\n\n<p>What is printing to the screen is <code>1</code> when it should be <code>16</code>. I don't think it's a logic issue because when I copy the function from my util.go into 023.go (and fix the call to GetPrimeFactors to be util.GetPrimeFactors) then the function runs just fine and prints 16 just like it should. I've tried adding <code>fmt.Println(\"TEST\")</code> to <code>util.SumOfDivisors</code> but it won't print those statements out and I don't get errors or anything else. If I change the name of the function in <code>util.go</code> to anything else, even if the main function is <code>023.go</code> doesn't change, it still builds and runs outputting <code>1</code>. It's really behaving weird.</p>\n\n<p>Other functions in my util.go file seem to be called just fine.</p>\n\n<p>I'm running Go 1.4.2. What might be causing this kind of behavior? The function works properly locally but not when moved to an external file that's imported and why can't that external file print anything to screen? All this while building just fine.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1427919970, "post_id": 29400044, "comment_id": 46976122, "body": "I don&#39;t see a question. Are you having a problem with: <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">golang.org/doc/faq#convert_slice_of_interface</a>?"}, {"owner": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "edited": false, "score": 0, "creation_date": 1427920677, "post_id": 29400044, "comment_id": 46976472, "body": "Yes, please give some more details on the problem that you&#39;re having."}, {"owner": {"reputation": 643, "user_id": 2402831, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2c32d36536daf6acc5634e65379b691?s=128&d=identicon&r=PG", "display_name": "user2402831", "link": "https://stackoverflow.com/users/2402831/user2402831"}, "edited": false, "score": 0, "creation_date": 1427921520, "post_id": 29400044, "comment_id": 46976990, "body": "Updated in bold. I&#39;m looking to hand something of type []OtherType, or any other new struct I decide to create, to UnmarshalStruct, and have it return to me that same struct, just full of data"}, {"owner": {"reputation": 643, "user_id": 2402831, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2c32d36536daf6acc5634e65379b691?s=128&d=identicon&r=PG", "display_name": "user2402831", "link": "https://stackoverflow.com/users/2402831/user2402831"}, "edited": false, "score": 0, "creation_date": 1427923451, "post_id": 29400044, "comment_id": 46977899, "body": "Posted json but the question is getting pretty convoluted, as I feel I&#39;m repeating the same thing. Simply put, I want a generic func that I give an interface slice of an instantiated struct (let&#39;s call it A). It will then fill A, and I can return A from the original calling func."}, {"owner": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "edited": false, "score": 0, "creation_date": 1427938712, "post_id": 29400044, "comment_id": 46982560, "body": "so the question is: given a list of heterogenous json objects, what function can i write to magically unmarshal each json object into the correct struct type without telling the function which struct types to expect beforehand?"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1427986505, "last_edit_date": 1427986505, "creation_date": 1427938179, "answer_id": 29403576, "question_id": 29400044, "link": "https://stackoverflow.com/questions/29400044/golang-abstracted-interface-slice-conversion/29403576#29403576", "title": "Golang abstracted Interface Slice conversion", "body": "<p>If I understand correctly, you want to unmarshal data to slices of two types:</p>\n\n<pre><code>type A struct {\n  Foo string `json:\"foo\"`\n  ID string `json:\"id\"`\n}\n\ntype B struct {\n   Bar string `json:\"bar\"`\n   Baz string `json:\"baz\"`\n   Eee string `json:\"eee\"`\n}\n</code></pre>\n\n<p>from a <a href=\"https://godoc.org/github.com/olivere/elastic#SearchHit.Source\" rel=\"nofollow\">SearchHit Source</a>.</p>\n\n<p>The JSON package can do most of the work for you:</p>\n\n<pre><code>func executeQuery(q Query, v interface{}) error {\n   // Get a SearchHit. I am making this up. \n   // I have no idea how the package works.\n   searchHit, err := getHit(q) \n   if err != nil {\n      return err\n   }\n   // This is the important part. Convert the raw message to \n   // a slice of bytes and decode to the caller's slice.\n   return json.Unmarshal([]byte(*searchHit.Source), v)\n}\n</code></pre>\n\n<p>You can call this function to decode to a slice of the types or a slice of pointers to the types.</p>\n\n<pre><code>// Slice of type\nvar s1 []TypeA\nif err := executeQuery(q1, &amp;s1); err != nil {\n    // handle error\n}\n\n// Slice of pointer to type\nvar s2 []*TypeB\nif err := error(q2, &amp;s2); err != nil {\n   // handle error\n}\n</code></pre>\n\n<p>I know that this is not a direct answer to the question, but this is how this scenario is typically handled.</p>\n"}, {"tags": [], "owner": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "is_accepted": false, "score": 0, "last_activity_date": 1427939435, "creation_date": 1427939435, "answer_id": 29403729, "question_id": 29400044, "link": "https://stackoverflow.com/questions/29400044/golang-abstracted-interface-slice-conversion/29403729#29403729", "title": "Golang abstracted Interface Slice conversion", "body": "<p>I don't believe this is easy to do. In the <a href=\"http://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow\" title=\"Raw Message Example\">Raw Message Example</a> in the godocs they use a value within the json, \"Space\" in their example, to determine which struct type to unmarshal into.</p>\n\n<p>For this to work, the function would have to have some way of getting every struct that has been defined ever for the program, and then it would have to examine each json object and compare it to each struct using reflection to figure out which type it most likely is. And what if there are multiple structs that \"could be it\"? Then conflict resolution complicates things.</p>\n\n<p>In short, I don't think you can do this.</p>\n"}, {"comments": [{"owner": {"reputation": 643, "user_id": 2402831, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2c32d36536daf6acc5634e65379b691?s=128&d=identicon&r=PG", "display_name": "user2402831", "link": "https://stackoverflow.com/users/2402831/user2402831"}, "edited": false, "score": 0, "creation_date": 1427991402, "post_id": 29415590, "comment_id": 47007409, "body": "This is perfect, and is exactly what I was looking for. I wanted this to be as abstract as possible for my particular architecture constraints, perhaps I have this built weirdly in another sense, but this is spot on. Many thanks."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1427985812, "last_edit_date": 1427985812, "creation_date": 1427985224, "answer_id": 29415590, "question_id": 29400044, "link": "https://stackoverflow.com/questions/29400044/golang-abstracted-interface-slice-conversion/29415590#29415590", "title": "Golang abstracted Interface Slice conversion", "body": "<p>There's really no way to do what you want without reflection. I would personally structure this differently, so that you unmarshal into more generic types, like a <code>map[string]string</code>, or as @ThunderCat shows, get rid of the intermediary state and unamrshal directly into the correct types. But it can be done...</p>\n\n<p>(I moved the json.RawMessage directly into TestStruct to get rid of one level of indirection and make the example more clear)</p>\n\n<pre><code>type TestStruct struct {\n    Slice []json.RawMessage\n}\n\nfunc (t TestStruct) UnmarshalStruct(v interface{}) error {\n    // get the a Value for the underlying slice\n    slice := reflect.ValueOf(v).Elem()\n    // make sure we have adequate capacity\n    slice.Set(reflect.MakeSlice(slice.Type(), len(t.Slice), len(t.Slice)))\n\n    for i, val := range t.Slice {\n        err := json.Unmarshal(val, slice.Index(i).Addr().Interface())\n        if err != nil {\n            return err\n        }\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>You can then call it like so</p>\n\n<pre><code>var others []OtherType\nerr := ts.UnmarshalStruct(&amp;others)\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/dgly2OOXDG\" rel=\"nofollow\">http://play.golang.org/p/dgly2OOXDG</a></p>\n"}], "owner": {"reputation": 643, "user_id": 2402831, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2c32d36536daf6acc5634e65379b691?s=128&d=identicon&r=PG", "display_name": "user2402831", "link": "https://stackoverflow.com/users/2402831/user2402831"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 858, "favorite_count": 0, "accepted_answer_id": 29415590, "answer_count": 3, "score": 2, "last_activity_date": 1427986505, "creation_date": 1427919790, "last_edit_date": 1427923425, "question_id": 29400044, "link": "https://stackoverflow.com/questions/29400044/golang-abstracted-interface-slice-conversion", "title": "Golang abstracted Interface Slice conversion", "body": "<p>I have a list of objects (olievere/Elastic SearchResult.Hits to be exact). Each of these has a <code>json.RawMessage</code> object and I'm looking to create an abstractable method that takes in an interface slice of any struct, Unmarshal's each individual hits' <code>json.RawMessage</code> into said struct, and appends it to the passed in <code>[]interface</code>.    </p>\n\n<p>This func is not supposed to have any logic or insight into the desired business layer struct, and the DB Call is interfaced pretty heavily, and as such has no visibility into the Elastic package mentioned above. Example of what I was attempting to do...     </p>\n\n<pre><code>foo.go    \nimport (bar, package)\ntype TestStruct struct {    \n    Slice []*package.Struct // package.Struct has a value of Source which is a    \n                            // json.RawMessage    \n}    \n\nfunc GetData() bar.Test {\n    return &amp;TestStruct{*package.GetData()}\n}\n\nfunc (result TestStruct) UnmarshalStruct(v []interface{}) {    \n    for _, singleStruct := range result.Slice {     \n        append(json.Unmarshal(singleStruct, &amp;v))\n    }\n</code></pre>\n\n<p>Second File</p>\n\n<pre><code>bar.go\ntype Handler interface {\n    GetData() Test\n}\n\ntype Test interface {\n    UnmarshalStruct\n}\n\ntype OtherType struct {\n   foo string\n   bar string\n} \n\nfunc RetrieveData() []OtherType {\n    handler := New(Handler)\n    test := handler.GetData()\n    var typeSlice []OtherType    \n    test.UnmarshalStruct(&amp;typeSlice)\n}\n</code></pre>\n\n<p><strong>I'm looking to hand something of type <code>[]OtherType</code>, or any other new struct I decide to create, to <code>UnmarshalStruct</code>, and have it return to me that same struct, just full of data</strong></p>\n\n<p>As an example, I have two different types of data I'll be searching for from Elastic. I will be receiving a list of ONE of the following two objects.</p>\n\n<pre><code>{ 'foo': '',\n  'id': \n}\n</code></pre>\n\n<p>And in a different index</p>\n\n<pre><code>{ 'bar': '',\n  'baz': '',\n  'eee': ''\n}     \n</code></pre>\n\n<p>Each of these will naturally require two different structs.<br>\nHowever, I desire a single method to be able to decode either of these lists. I'll be given below, and using the same function I want to be able to convert this to a <code>bar</code> struct, and the other type to a <code>foo</code> struct.</p>\n\n<pre><code>{ 'source': [\n    { 'bar': '',\n      'baz': '',\n      'eee': ''\n    },\n    { 'bar': '',\n      'baz': '',\n      'eee': ''\n    },\n    { 'bar': '',\n      'baz': '',\n      'eee': ''\n    }    \n  ]\n}\n</code></pre>\n"}, {"tags": ["go", "shopify", "apache-kafka"], "comments": [{"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1427923739, "post_id": 29398051, "comment_id": 46978025, "body": "json.Unmarshal can cause an err , and if you don&#39;t want to throw panic ... Just don&#39;t :)"}, {"owner": {"reputation": 243, "user_id": 4639689, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IeGRx.jpg?s=128&g=1", "display_name": "premunk", "link": "https://stackoverflow.com/users/4639689/premunk"}, "reply_to_user": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 1, "creation_date": 1427924506, "post_id": 29398051, "comment_id": 46978324, "body": "Ha. Thanks. Any idea on how I could do #2 ?"}], "answers": [{"tags": [], "owner": {"reputation": 5205, "user_id": 118201, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3332136bbcc2736f3d2118dfd7d98a15?s=128&d=identicon&r=PG", "display_name": "eSniff", "link": "https://stackoverflow.com/users/118201/esniff"}, "is_accepted": true, "score": 2, "last_activity_date": 1427943492, "creation_date": 1427943492, "answer_id": 29404306, "question_id": 29398051, "link": "https://stackoverflow.com/questions/29398051/kafka-error-handling-using-shopify-sarama/29404306#29404306", "title": "Kafka Error Handling using Shopify Sarama", "body": "<p>Regarding 1) Check where I log error messages below.  This is more or less what I would do.</p>\n\n<p>Regarding 2) I don't know about trying to walk backwards in a topic.  Its very much possible by just creating a consumer over and over, with its starting offset minus one each time.   But I wouldn't advise it, as most likely you'll end up replaying the same message over and over.  I do advice saving your offset often so you can recover if things go south.  </p>\n\n<p>Below is code that I believe addresses most of your questions.  I haven't tried compiling this.  And sarama api has been changing lately, so the api may currently differ a bit. </p>\n\n<pre><code>func StartKafkaReader(wg *sync.WaitGroup, lastgoodoff int64, out chan&lt;- *Message) (error) {\n    wg.Add(1)\n    go func(){\n        defer wg.Done()\n        //to track the last known good offset we processed, which is \n        // updated after each successfully processed event. \n        saveprogress := func(off int64){\n            //Save the offset somewhere...a file... \n            //Ive also used kafka to store progress \n            //using a special topic as a WAL\n        }\n        defer saveprogress(lastgoodoffset)\n\n        client, err := sarama.NewClient(\"clientId\", brokers, sarama.NewClientConfig())\n        if err != nil {\n            log.Error(err)\n            return\n        }\n        defer client.Close()\n        sarama.NewConsumerConfig()\n        consumerConfig.OffsetMethod = sarama.OffsetMethodManual\n        consumerConfig.OffsetValue = int64(lastgoodoff)\n        consumer, err := sarama.NewConsumer(client, topic, partition, \"consumerId\", consumerConfig)\n        if err != nil {\n            log.Error(err)\n            return\n        }\n        defer consumer.Close()\n        for {\n            select {\n            case event := &lt;-consumer.Events():\n                if event.Err != nil {\n                    log.Error(event.Err)\n                    return\n                }\n                msgContent := &amp;Message{}\n                err = json.Unmarshal(message.Value, msgContent)\n                if err != nil {\n                    log.Error(err)\n                    continue //continue to skip this message or return to stop without updating the offset.\n                }\n                // Send the message on to be processed.\n                out &lt;- msgContent \n\n                lastgoodoff = event.Offset\n            }\n        }\n    }()\n}\n</code></pre>\n"}], "owner": {"reputation": 243, "user_id": 4639689, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IeGRx.jpg?s=128&g=1", "display_name": "premunk", "link": "https://stackoverflow.com/users/4639689/premunk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2003, "favorite_count": 0, "accepted_answer_id": 29404306, "answer_count": 1, "score": 3, "last_activity_date": 1427943492, "creation_date": 1427912670, "question_id": 29398051, "link": "https://stackoverflow.com/questions/29398051/kafka-error-handling-using-shopify-sarama", "title": "Kafka Error Handling using Shopify Sarama", "body": "<p>So I am trying to use Kafka for my application which has a producer logging actions into the Kafka MQ and the consumer which reads it off the MQ.Since my application is in Go, I am using the Shopify Sarama to make this possible.</p>\n\n<p>Right now, I'm able to read off the MQ and print the message contents using a</p>\n\n<pre><code>fmt.Printf\n</code></pre>\n\n<p>Howeveer, I would really like the error handling to be better than console printing and I am willing to go the extra mile. </p>\n\n<p>Code right now for consumer connection:</p>\n\n<pre><code>mqCfg := sarama.NewConfig()\n\nmaster, err := sarama.NewConsumer([]string{brokerConnect}, mqCfg)\nif err != nil {\n    panic(err) // Don't want to panic when error occurs, instead handle it\n}\n</code></pre>\n\n<p>And the processing of messages:</p>\n\n<pre><code>    go func() {\n    defer wg.Done()\n    for message := range consumer.Messages() {\n        var msgContent Message\n        _ = json.Unmarshal(message.Value, &amp;msgContent)\n        fmt.Printf(\"Reading message of type %s with id : %d\\n\", msgContent.Type, msgContent.ContentId) //Don't want to print it\n    }\n}()\n</code></pre>\n\n<p>My questions (I am new to testing Kafka and new to kafka in general):</p>\n\n<ol>\n<li><p>Where could errors occur in the above program, so that I can handle them? Any sample code will be great for me to start with. The error conditions I could think of are when the msgContent doesn't really contain any Type of ContentId fields in the JSON. </p></li>\n<li><p>In kafka, are there situations when the consumer is trying to read at the current offset, but for some reason was not able to (even when the JSON is well formed)? Is it possible for my consumer to backtrack to say x steps above the failed offset read and re-process the offsets? Or is there a better way to do this? again, what could these situations be?</p></li>\n</ol>\n\n<p>I'm open to reading and trying things. </p>\n"}, {"tags": ["casting", "go"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1427913538, "post_id": 29397801, "comment_id": 46972565, "body": "Puzzled what &#39;var t Mytime(time.Now())&#39; means at all. Seems like it&#39;s syntactically illegal. Does it&#39;s a shortcut for &#39;var t Mytime=Mytime(time.Now())&#39;?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1427914081, "post_id": 29397801, "comment_id": 46972870, "body": "@Uvelichitel It&#39;s invalid. I assumed it was a typo of <code>var t = Mytime(\u2026)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 1, "creation_date": 1427913222, "post_id": 29397985, "comment_id": 46972382, "body": "time.Add() return time.Time, not MyTime."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1427913811, "post_id": 29397985, "comment_id": 46972734, "body": "@Uvelichitel, okay, I changed it to show assignment of Add result."}, {"owner": {"reputation": 22059, "user_id": 112196, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e34b0f9e6f02cc448b42093ef14d22b0?s=128&d=identicon&r=PG", "display_name": "Pero P.", "link": "https://stackoverflow.com/users/112196/pero-p"}, "edited": false, "score": 0, "creation_date": 1427918750, "post_id": 29397985, "comment_id": 46975459, "body": "So a cast is still required back to <code>MyTime</code>"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 22059, "user_id": 112196, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e34b0f9e6f02cc448b42093ef14d22b0?s=128&d=identicon&r=PG", "display_name": "Pero P.", "link": "https://stackoverflow.com/users/112196/pero-p"}, "edited": false, "score": 0, "creation_date": 1427922789, "post_id": 29397985, "comment_id": 46977606, "body": "@pero yes, but it&#39;s not a cast. For some <code>var tt time.Time</code> it&#39;s either <code>newval := MyTime{tt}</code> or <code>oldval.Time = tt</code>."}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": false, "score": 2, "last_activity_date": 1427913592, "last_edit_date": 1427913592, "creation_date": 1427912448, "answer_id": 29397985, "question_id": 29397801, "link": "https://stackoverflow.com/questions/29397801/whats-the-best-practice-to-infer-the-methods/29397985#29397985", "title": "What&#39;s the best practice to infer the methods?", "body": "<p>Presumably you have <code>type Mytime time.Time</code>. If instead you embedded it:</p>\n\n<pre><code>type MyTime struct {\n        time.Time\n}\n</code></pre>\n\n<p>Then you could have:</p>\n\n<pre><code>func (t MyTime) MarshalJSON() ([]byte, error) {\n        \u2026 whatever \u2026\n}\n</code></pre>\n\n<p>and still access all of <code>time.Time</code>'s methods.\nE.g. something like:</p>\n\n<pre><code>        t := MyType{time.Now()}\n        t.Time = t.Add(time.Hour)\n</code></pre>\n\n<hr>\n\n<p>Fuller example showing differences between embedded and non-embedded custom time types. Note that embedding still doesn't allow for transparent inter-use with things that expect a <code>time.Time</code> value. (The reason for making these types, e.g.\u00a0to add a <code>MarshalJSON</code> method has been omitted here).</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype YourTime time.Time\n\ntype MyTime struct{ time.Time }\n\n// Some random functions, perhaps in a third party package,\n// that deals with time.Time values.\nfunc fn(t time.Time) {\n    fmt.Println(\"fn got:\", t)\n}\n\nfunc fn2() time.Time {\n    return time.Unix(14e8, 0)\n}\n\nfunc main() {\n    var t1 = YourTime(time.Now())\n    //t1 = t1.Add(time.Hour)             // compiler error\n    t1 = YourTime(time.Time(t1).Add(time.Hour))\n    fmt.Println(\"ugly t1:\", t1)\n    fmt.Println(\"nice t1:\", time.Time(t1))\n    //fn(t1)                        // compiler error\n    fn(time.Time(t1))\n\n    //t1 = fn2()                    // compiler error\n    t1 = YourTime(fn2())\n\n    var t2 = MyTime{time.Now()}\n    // t2 = t2.Add(time.Hour)       // compiler error\n    t2.Time = t2.Add(time.Hour)\n    fmt.Println(\"t2:\", t2)\n    //fn(t2)                        // compiler error\n    fn(t2.Time)\n\n    //t2 = fn2()                    // compiler error\n    t2.Time = fn2()\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/Of0NDTtokK\" rel=\"nofollow\"><kbd>Playground</kbd></a></p>\n\n<p>Output:</p>\n\n<pre><code>ugly t1: {63393494400 0 0x1c9340}\nnice t1: 2009-11-11 00:00:00 +0000 UTC\nfn got: 2009-11-11 00:00:00 +0000 UTC\nt2: 2009-11-10 23:00:00 +0000 UTC\nfn got: 2009-11-10 23:00:00 +0000 UTC\n</code></pre>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1427916267, "creation_date": 1427911770, "last_edit_date": 1427916267, "question_id": 29397801, "link": "https://stackoverflow.com/questions/29397801/whats-the-best-practice-to-infer-the-methods", "title": "What&#39;s the best practice to infer the methods?", "body": "<p>I have a custom time format which I use to properly encode/decode json. However whenever I need to do a time computation I need to do a cast. Is this the right way? It feels a bit ugly to keep casting. For example when I need to \"update\" the value I need to cast it twice ( once to time and once to my type)</p>\n\n<pre><code>type Mytime time.Time\nvar t Mytime\nt = Mytime(time.Now())\n// Add an hour to my typed time\nt = Mytime(time.Time(t).Add(1 * time.Hour))\n</code></pre>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427911254, "post_id": 29397645, "comment_id": 46971340, "body": "<b>Never</b> ignore <code>error</code> returns! IMO it&#39;s not even worth looking at this until you add at least minimal error checking."}, {"owner": {"reputation": 187, "user_id": 3995228, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3704db62cc1e1967db3ef022eea118f2?s=128&d=identicon&r=PG&f=1", "display_name": "\u017diga Pata\u010dko Koderman", "link": "https://stackoverflow.com/users/3995228/%c5%bdiga-pata%c4%8dko-koderman"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427911390, "post_id": 29397645, "comment_id": 46971401, "body": "is there any error ignored, beside the one that may occur when parsing json (which is not a problem - believe me, I checked)?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427911453, "post_id": 29397645, "comment_id": 46971431, "body": "You checked once maybe. If it&#39;s not checked in the code no one (even you) knows that some error isn&#39;t happening there now."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1427911509, "post_id": 29397645, "comment_id": 46971463, "body": "In particular, <code>rows.Scan</code> returns an <code>error</code> value."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427911643, "post_id": 29397645, "comment_id": 46971531, "body": "Side notes: share the results from <code>db.Open</code>, don&#39;t close and re-open it. It&#39;d be easier to do <code>p := Party{}</code> (or <code>var p Party</code>) and then use things like <code>&amp;p.id</code> in the scan."}], "answers": [{"tags": [], "owner": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "is_accepted": false, "score": 1, "last_activity_date": 1427921433, "creation_date": 1427921433, "answer_id": 29400563, "question_id": 29397645, "link": "https://stackoverflow.com/questions/29397645/go-mysql-returning-null-values/29400563#29400563", "title": "go mysql returning null values", "body": "<p>This is a guess, but I'm thinking that it's because you're closing the connection to the database here:</p>\n\n<pre><code>defer con.Close()\n</code></pre>\n\n<p>This will close the connection to the database when <code>getRowsFromSql</code> returns, so by the time you start calling <code>rows.Next()</code> in <code>scanForParties</code> the DB connection is gone. Once the DB connection is closed, any collection of rows will no longer be available.</p>\n\n<p>Something is probably returning an <code>error</code> because of this, but since you're not checking any errors anywhere you won't know. In Go it is idiomatic to check for errors whenever a function can return one (and other languages too, just more so in Go because of the lack of exceptions).</p>\n"}, {"tags": [], "owner": {"reputation": 187, "user_id": 3995228, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3704db62cc1e1967db3ef022eea118f2?s=128&d=identicon&r=PG&f=1", "display_name": "\u017diga Pata\u010dko Koderman", "link": "https://stackoverflow.com/users/3995228/%c5%bdiga-pata%c4%8dko-koderman"}, "is_accepted": false, "score": 1, "last_activity_date": 1427995184, "creation_date": 1427995184, "answer_id": 29418747, "question_id": 29397645, "link": "https://stackoverflow.com/questions/29397645/go-mysql-returning-null-values/29418747#29418747", "title": "go mysql returning null values", "body": "<p>Okay so all the others were right about the errors: rows.Scan() returns an error. And when I finally checked it, it said that there are insufficient scan variables provided. Simple fix: add the missing one.</p>\n\n<p>Thank you guys :)</p>\n"}], "owner": {"reputation": 187, "user_id": 3995228, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3704db62cc1e1967db3ef022eea118f2?s=128&d=identicon&r=PG&f=1", "display_name": "\u017diga Pata\u010dko Koderman", "link": "https://stackoverflow.com/users/3995228/%c5%bdiga-pata%c4%8dko-koderman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1412, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1427995184, "creation_date": 1427911202, "question_id": 29397645, "link": "https://stackoverflow.com/questions/29397645/go-mysql-returning-null-values", "title": "go mysql returning null values", "body": "<p>I am currently working on a Golang Google App Engine Project and have run into a small problem. I have a database \"party\" with table \"parties\". The problem is that when the following code is executed, a EMPTY json array is printed - it actually is properly long, but it only contains empty Parties. (And I do have entries in my database)</p>\n\n<p>Go code (not all of it):</p>\n\n<pre><code>func getParties(w http.ResponseWriter, r *http.Request) {\n    rows := getRowsFromSql(\"select * from parties;\")\n    parties := scanForParties(rows)\n\n    json, _ := json.Marshal(parties)\n    fmt.Fprint(w, string(json))\n}\n\nfunc scanForParties(rows *sql.Rows) []Party {\n    var parties []Party\n\n    for rows.Next() {\n        var id int\n        var name, author, datetime, datetime_to, host, location, description, longtitude, latitude, primary_image_id string\n        rows.Scan(&amp;id, &amp;name, &amp;author, &amp;datetime, &amp;datetime_to, &amp;host, &amp;location, &amp;description, &amp;longtitude, &amp;latitude, &amp;primary_image_id)\n        party := Party{\n            Id:           id,\n            Name:         name,\n            Author:       author,\n            Datetime:     datetime,\n            Datetime_to:  datetime_to,\n            Host:         host,\n            Location:     location,\n            Description:  description,\n            Longtitude:   longtitude,\n            Latitude:     latitude,\n            PrimaryImgId: primary_image_id,\n        }\n        parties = append(parties, party)\n    }\n\n    return parties\n}\n\nfunc getRowsFromSql(query string) *sql.Rows {\n    con, err := sql.Open(\"mysql\", dbConnectString)\n    if err != nil {\n        panic(err)\n    }\n    defer con.Close()\n\n    rows, err2 := con.Query(query)\n    if err != nil {\n        panic(err2)\n    }\n    return rows\n\n}\n\ntype Party struct {\n    Id           int\n    Name         string\n    Author       string\n    Datetime     string\n    Datetime_to  string\n    Host         string\n    Location     string\n    Description  string\n    Longtitude   string\n    Latitude     string\n    PrimaryImgId string\n}\n</code></pre>\n\n<p>And my parties table:</p>\n\n<pre><code>mysql&gt; describe parties;\n+------------------+----------------+------+-----+-------------------+-----------------------------+\n| Field            | Type           | Null | Key | Default           | Extra                       |\n+------------------+----------------+------+-----+-------------------+-----------------------------+\n| id               | int(11)        | NO   | PRI | NULL              | auto_increment              |\n| name             | varchar(64)    | NO   |     |                   |                             |\n| author           | varchar(64)    | YES  |     | NULL              |                             |\n| datetime         | datetime       | YES  |     | NULL              |                             |\n| last_edited      | timestamp      | NO   |     | CURRENT_TIMESTAMP | on update CURRENT_TIMESTAMP |\n| datetime_to      | datetime       | YES  |     | NULL              |                             |\n| host             | text           | YES  |     | NULL              |                             |\n| location         | text           | YES  |     | NULL              |                             |\n| description      | text           | YES  |     | NULL              |                             |\n| longitude        | decimal(23,20) | YES  |     | NULL              |                             |\n| latitude         | decimal(23,20) | YES  |     | NULL              |                             |\n| primary_image_id | varchar(256)   | YES  |     | NULL              |                             |\n+------------------+----------------+------+-----+-------------------+-----------------------------+\n</code></pre>\n\n<p>However, this old version of code works just fine:</p>\n\n<pre><code>func getParties(w http.ResponseWriter, r *http.Request) {\n\n    con, dbErr := sql.Open(\"mysql\", dbConnectString)\n\n    defer con.Close()\n\n    if dbErr == nil {\n        rows, _ := con.Query(\"select id, name, author, datetime from parties where datetime &gt;= NOW();\")\n\n        var parties []Party\n\n        var id int\n        var name string\n        var author string\n        var datetime string\n\n        for rows.Next() {\n            rows.Scan(&amp;id, &amp;name, &amp;author, &amp;datetime)\n            party := Party{}\n            party.Id = id\n            party.Name = name\n            party.Author = author\n            party.Datetime = datetime\n            parties = append(parties, party)\n        }\n\n        if len(parties) &gt; 0 {\n            json, _ := json.Marshal(parties)\n            fmt.Fprint(w, string(json))\n        } else {\n            fmt.Fprint(w, \"{}\")\n        }\n\n    } else {\n        fmt.Fprint(w, \"{\\\"Error\\\"}\")\n    }\n}\n</code></pre>\n\n<p>Any idea why this happens?\nThanks in advance :)</p>\n"}, {"tags": ["methods", "struct", "go", "parent-child"], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1427903551, "post_id": 29390981, "comment_id": 46966932, "body": "Further to this, in real code if you wanted/need something like your <code>func (s *Shape) PrintArea()</code> you&#39;d just turn it into <code>func ShapeArea(s ShapeInterface)</code>; a function that operated on any shape like thing (anything that provided the appropriate methods, e.g. <code>Area() float64</code>). Also, in real code it&#39;s not a good idea to call functions &quot;PrintFoo&quot; and output to stdout, instead take an <code>io.Writer</code> <i>or</i> return a <code>string</code>. And so-called &quot;getters&quot; usually don&#39;t include &quot;Get&quot; in idiomatic Go code; i.e. <code>Name() string</code> instead of <code>GetName() string</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1592416848, "last_edit_date": 1592416848, "creation_date": 1427891656, "answer_id": 29390981, "question_id": 29390736, "link": "https://stackoverflow.com/questions/29390736/go-embedded-struct-call-child-method-instead-parent-method/29390981#29390981", "title": "Go embedded struct call child method instead parent method", "body": "<p>Actually in your example calling <code>ShapeInterface.PrintArea()</code> works just fine in case of a <code>Circle</code> because you created a <code>PrintArea()</code> method for the type <code>Circle</code>. Since you did not create a <code>PrintArea()</code> for the <code>Rectangle</code> type, the method of the embedded <code>Shape</code> type will be called.</p>\n\n<p>This is not a bug, this is the intended working. Go is <a href=\"http://golang.org/doc/faq#Is_Go_an_object-oriented_language\" rel=\"nofollow noreferrer\">not (quite) an object oriented language</a>: it does not have classes and it <a href=\"http://golang.org/doc/faq#inheritance\" rel=\"nofollow noreferrer\">does not have type inheritance</a>; but it supports a similar construct called <em>embedding</em> both on <code>struct</code> level and on <code>interface</code> level, and it does have <a href=\"http://golang.org/ref/spec#Method_declarations\" rel=\"nofollow noreferrer\">methods</a>.</p>\n\n<p>What you expect is called <a href=\"http://en.wikipedia.org/wiki/Virtual_function\" rel=\"nofollow noreferrer\"><em>virtual methods</em></a>: you expect that the <code>PrintArea()</code> method will call the \"overridden\" <code>Area()</code> method, but in Go there is no inheritance and virtual methods.</p>\n\n<p>The definition of <code>Shape.PrintArea()</code> is to call <code>Shape.Area()</code> and this is what happens. <code>Shape</code> does not know about which struct it is and if it is embedded in, so it can't \"dispatch\" the method call to a virtual, run-time method.</p>\n\n<p>The <a href=\"http://golang.org/ref/spec#Selectors\" rel=\"nofollow noreferrer\">Go Language Specification: Selectors</a> describe the exact rules which are followed when evaluating an <code>x.f</code> expression (where <code>f</code> may be a method) to choose which method will be called in the end. Key Points:</p>\n\n<blockquote>\n  <ul>\n  <li>A selector <code>f</code> may denote a field or method <code>f</code> of a type <code>T</code>, or it may refer to a field or method <code>f</code> of a nested <a href=\"http://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">anonymous field</a> of <code>T</code>. The number of anonymous fields traversed to reach <code>f</code> is called its <em>depth</em> in <code>T</code>.</li>\n  <li>For a value <code>x</code> of type <code>T</code> or <code>*T</code> where <code>T</code> is not a pointer or interface type, <code>x.f</code> denotes the field or method at the shallowest depth in <code>T</code> where there is such an <code>f</code>.</li>\n  </ul>\n</blockquote>\n\n<h2>Going into details</h2>\n\n<h3>Circle</h3>\n\n<p>In case of <code>Circle</code>: <code>si.PrintArea()</code> will call <code>Circle.PrintArea()</code> because you created such a method:</p>\n\n<pre><code>func (c *Circle) PrintArea() {\n    fmt.Printf(\"%s : Area %v\\r\\n\", c.GetName(), c.Area())\n}\n</code></pre>\n\n<p>In this method <code>c.Area()</code> is called where <code>c</code> is a <code>*Circle</code>, so the method with <code>*Circle</code> receiver will be called which also exists.</p>\n\n<p><code>PrintArea(si)</code> calls <code>si.Area()</code>. Since <code>si</code> is a <code>Circle</code> and there is a method <code>Area()</code> with <code>Circle</code> receiver, it is invoked no problem.</p>\n\n<h3>Rectangle</h3>\n\n<p>In case of <code>Rectangle</code> <code>si.PrintArea()</code> will actually call the method <code>Shape.PrintArea()</code> because you <strong>did not</strong> define a <code>PrintArea()</code> method for the <code>Rectangle</code> type (there is no method with receiver <code>*Rectangle</code>). And the implementation of <code>Shape.PrintArea()</code> method calls <code>Shape.Area()</code> <strong>not</strong> <code>Rectangle.Area()</code> - as discussed, <code>Shape</code> doesn't know about <code>Rectangle</code>. So you'll see</p>\n\n<pre><code>Rectangle1 : Area 0\n</code></pre>\n\n<p>printed instead of the expected <code>Rectangle1 : Area 20</code>.</p>\n\n<p>But if you call <code>PrintArea(si)</code> (passing the <code>Rectangle</code>), it calls <code>si.Area()</code> which will be <code>Rectangle.Area()</code> because such method exists.</p>\n"}], "owner": {"reputation": 69, "user_id": 4046401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf4112ec78f5ec1ed33c5c2010c01ed9?s=128&d=identicon&r=PG", "display_name": "terrak1975", "link": "https://stackoverflow.com/users/4046401/terrak1975"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1404, "favorite_count": 5, "accepted_answer_id": 29390981, "answer_count": 1, "score": 5, "last_activity_date": 1592416848, "creation_date": 1427890926, "last_edit_date": 1470123331, "question_id": 29390736, "link": "https://stackoverflow.com/questions/29390736/go-embedded-struct-call-child-method-instead-parent-method", "title": "Go embedded struct call child method instead parent method", "body": "<p>Here a sample of Go code with an Interface, a Parent Struct and 2 Children Structs</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\n// Shape Interface : defines methods\ntype ShapeInterface interface {\n    Area() float64\n    GetName() string\n    PrintArea()\n}\n\n// Shape Struct : standard shape with an area equal to 0.0\ntype Shape struct {\n    name string\n}\n\nfunc (s *Shape) Area() float64 {\n    return 0.0\n}\n\nfunc (s *Shape) GetName() string {\n    return s.name\n}\n\nfunc (s *Shape) PrintArea() {\n    fmt.Printf(\"%s : Area %v\\r\\n\", s.name, s.Area())\n}\n\n// Rectangle Struct : redefine area method\ntype Rectangle struct {\n    Shape\n    w, h float64\n}\n\nfunc (r *Rectangle) Area() float64 {\n    return r.w * r.h\n}\n\n// Circle Struct : redefine Area and PrintArea method \ntype Circle struct {\n    Shape\n    r float64\n}\n\nfunc (c *Circle) Area() float64 {\n    return c.r * c.r * math.Pi\n}\n\nfunc (c *Circle) PrintArea() {\n    fmt.Printf(\"%s : Area %v\\r\\n\", c.GetName(), c.Area())\n}\n\n// Genreric PrintArea with Interface\nfunc  PrintArea (s ShapeInterface){\n    fmt.Printf(\"Interface =&gt; %s : Area %v\\r\\n\", s.GetName(), s.Area())\n}\n\n//Main Instruction : 3 Shapes of each type\n//Store them in a Slice of ShapeInterface\n//Print for each the area with the call of the 2 methods\nfunc main() {\n\n    s := Shape{name: \"Shape1\"}\n    c := Circle{Shape: Shape{name: \"Circle1\"}, r: 10}\n    r := Rectangle{Shape: Shape{name: \"Rectangle1\"}, w: 5, h: 4}\n\n    listshape := []c{&amp;s, &amp;c, &amp;r}\n\n    for _, si := range listshape {\n        si.PrintArea() //!! Problem is Witch Area method is called !! \n        PrintArea(si)\n    }\n\n}\n</code></pre>\n\n<p>I have for results : </p>\n\n<pre><code>$ go run essai_interface_struct.go\nShape1 : Area 0\nInterface =&gt; Shape1 : Area 0\nCircle1 : Area 314.1592653589793\nInterface =&gt; Circle1 : Area 314.1592653589793\nRectangle1 : Area 0\nInterface =&gt; Rectangle1 : Area 20\n</code></pre>\n\n<p>My problem is the call of <code>Shape.PrintArea</code> which call <code>Shape.Area</code> method for Circle and Rectangle instead calling <code>Circle.Area</code> and <code>Rectangle.Area</code> method.</p>\n\n<p>Is this a bug in Go ?</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["json", "struct", "go"], "answers": [{"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 0, "last_activity_date": 1427890058, "creation_date": 1427890058, "answer_id": 29390397, "question_id": 29389889, "link": "https://stackoverflow.com/questions/29389889/composing-arbitrary-json-objects-in-embedded-structs-in-go/29390397#29390397", "title": "Composing arbitrary JSON objects in embedded structs in Go", "body": "<p>You can't achieve this easily. Empty structure is also a structure and it will be serialized as <code>{}</code>. Even <code>nil</code> value will be serialized as <code>null</code>. </p>\n\n<p>The following code:\n    package main</p>\n\n<pre><code>import (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n     xs := []interface{}{struct{}{},nil}\n     b, _ := json.Marshal(xs)\n     fmt.Println(string(b))\n}\n</code></pre>\n\n<p>will produce:</p>\n\n<pre><code>[{},null]\n</code></pre>\n\n<p><kbd><a href=\"https://play.golang.org/p/95et2I4K9f\" rel=\"nofollow\">Playground</a></kbd></p>\n\n<p>The solution would be to implement <a href=\"http://golang.org/pkg/encoding/json/#Marshaler\" rel=\"nofollow\">json.Marshaller</a> interface for <code>Problems</code> type to skip empty structures.</p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 3691075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c51d7ab1d6c5ab5ca3a6d1431b48a7b8?s=128&d=identicon&r=PG&f=1", "display_name": "parens", "link": "https://stackoverflow.com/users/3691075/parens"}, "edited": false, "score": 0, "creation_date": 1427891576, "post_id": 29390512, "comment_id": 46958931, "body": "Yes, I was hoping there&#39;s a <code>json:&quot;,omitempty&quot;</code> type of magical potion to omit the empty struct altogether, and thus avoiding the creation of the semi-large JSON object once and then processing again to remove empty structs. :) But thanks for your answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1471954969, "last_edit_date": 1471954969, "creation_date": 1427890368, "answer_id": 29390512, "question_id": 29389889, "link": "https://stackoverflow.com/questions/29389889/composing-arbitrary-json-objects-in-embedded-structs-in-go/29390512#29390512", "title": "Composing arbitrary JSON objects in embedded structs in Go", "body": "<p>Once you add an element to the array/slice which you marshal, there's nothing you can do about it. If an element is in the array/slice, it will be marshalled (will be included in the JSON output). How could the <a href=\"http://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow\"><code>json.Marshal()</code></a> function guess which elements you don't want to marshal? It can't.</p>\n\n<p>You have to exclude elements which you don't what to appear in the output. In your case you want to exclude empty <code>Problem</code> structs.</p>\n\n<p>Best/easiest is to create a helper function which creates the <code>[]Problem</code> slice for you, empty structs excluded:</p>\n\n<pre><code>func createProbs(ps ...Problem) []Problem {\n    // Remove empty Problem structs:\n    empty := Problem{}\n    for i := len(ps) - 1; i &gt;= 0; i-- {\n        if ps[i] == empty {\n            ps = append(ps[:i], ps[i+1:]...)\n        }\n    }\n    return ps\n}\n</code></pre>\n\n<p>Using this creating a slice is like this:</p>\n\n<pre><code>probs := createProbs(prob0, prob1, prob2)\n</code></pre>\n\n<p>Try your modified application on the <a href=\"https://play.golang.org/p/r1dzOx_JzM\" rel=\"nofollow\">Go Playground</a>.</p>\n\n<p>Output of the modified code (notice the empty struct is missing):</p>\n\n<pre><code>[{\"s\":\"s0\",\"t\":\"t0\"},{\"s\":\"s1\",\"t\":\"t1\"},{\"s\":\"s2\",\"t\":\"t2\"}]\n[{\"s\":\"s0\",\"t\":\"t0\"},{\"s\":\"s2\",\"t\":\"t2\"}]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 3691075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c51d7ab1d6c5ab5ca3a6d1431b48a7b8?s=128&d=identicon&r=PG&f=1", "display_name": "parens", "link": "https://stackoverflow.com/users/3691075/parens"}, "edited": false, "score": 0, "creation_date": 1427892390, "post_id": 29390965, "comment_id": 46959456, "body": "Thanks, I don&#39;t yet know the eventual length of the probs JSON object and if reflection might cause any performance issues. Will check."}, {"owner": {"reputation": 654, "user_id": 3508122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1057c941dbec272576741ee1db60cdc2?s=128&d=identicon&r=PG&f=1", "display_name": "user3508122", "link": "https://stackoverflow.com/users/3508122/user3508122"}, "reply_to_user": {"reputation": 57, "user_id": 3691075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c51d7ab1d6c5ab5ca3a6d1431b48a7b8?s=128&d=identicon&r=PG&f=1", "display_name": "parens", "link": "https://stackoverflow.com/users/3691075/parens"}, "edited": false, "score": 0, "creation_date": 1427894194, "post_id": 29390965, "comment_id": 46960670, "body": "Personally I think the accepted answer is better for your situation, however the reflection approach works well when you have a slice of multiple types - e.g interface types. Here&#39;s a contrived example where this approach works with a slice of various different types and it removes all zero valued elements <a href=\"https://play.golang.org/p/WFkSFYcWos\" rel=\"nofollow noreferrer\">play.golang.org/p/WFkSFYcWos</a>"}, {"owner": {"reputation": 57, "user_id": 3691075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c51d7ab1d6c5ab5ca3a6d1431b48a7b8?s=128&d=identicon&r=PG&f=1", "display_name": "parens", "link": "https://stackoverflow.com/users/3691075/parens"}, "edited": false, "score": 0, "creation_date": 1427944123, "post_id": 29390965, "comment_id": 46983726, "body": "There&#39;s an another part of this app where this approach could be useful, thanks."}], "tags": [], "owner": {"reputation": 654, "user_id": 3508122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1057c941dbec272576741ee1db60cdc2?s=128&d=identicon&r=PG&f=1", "display_name": "user3508122", "link": "https://stackoverflow.com/users/3508122/user3508122"}, "is_accepted": false, "score": 0, "last_activity_date": 1427892534, "last_edit_date": 1427892534, "creation_date": 1427891597, "answer_id": 29390965, "question_id": 29389889, "link": "https://stackoverflow.com/questions/29389889/composing-arbitrary-json-objects-in-embedded-structs-in-go/29390965#29390965", "title": "Composing arbitrary JSON objects in embedded structs in Go", "body": "<pre><code>func TWO() {\n    prob0 := Problem{S: \"s0\", T: \"t0\"}\n    prob1 := Problem{S: \"\", T: \"\"} // empty values omited BUT NOT \"{}\"\n    prob2 := Problem{S: \"s2\", T: \"t2\"}\n    probs := Problems{prob0, prob1, prob2}\n\n    for i,v := range probs {\n        if v == reflect.Zero(reflect.TypeOf(v)).Interface() {\n            probs = append(probs[:i], probs[i+1:]...)\n        }\n    }\n\n    // fmt.Println(probs)\n    // GOT:    [{s0 t0} { } {s2 t2}]\n    // WANTED: [{s0 t0} {s2 t2}]\n    b, _ := json.Marshal(probs)\n    fmt.Println(string(b))\n    // GOT:    [{\"s\":\"s0\",\"t\":\"t0\"},{},{\"s\":\"s2\",\"t\":\"t2\"}]\n    // WANTED: [{\"s\":\"s0\",\"t\":\"t0\"},{\"s\":\"s2\",\"t\":\"t2\"}]\n}\n</code></pre>\n\n<p>Alternatively, you could use reflection</p>\n\n<p>Here's the link to the playground (<a href=\"https://play.golang.org/p/D0pW4xE4uf\" rel=\"nofollow\">https://play.golang.org/p/D0pW4xE4uf</a>). I'm not sure if this is the best answer but it's an alternative approach </p>\n"}], "owner": {"reputation": 57, "user_id": 3691075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c51d7ab1d6c5ab5ca3a6d1431b48a7b8?s=128&d=identicon&r=PG&f=1", "display_name": "parens", "link": "https://stackoverflow.com/users/3691075/parens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 29390512, "answer_count": 3, "score": 3, "last_activity_date": 1471954969, "creation_date": 1427888617, "last_edit_date": 1427890632, "question_id": 29389889, "link": "https://stackoverflow.com/questions/29389889/composing-arbitrary-json-objects-in-embedded-structs-in-go", "title": "Composing arbitrary JSON objects in embedded structs in Go", "body": "<p>I'm trying to generate JSON objects in the form of <code>{{\"s\":\"v1\", \"t\":\"v2\"}, {\"s\":\"v3\", \"t\":\"v4\"}, etc}</code> via embedded structs in Go. </p>\n\n<p>It all works out fine when all <code>Problem</code> items in <code>type Problems []Problem</code> are known ahead of time, as can be seen in func <code>ONE()</code> below and in <kbd><a href=\"https://play.golang.org/p/LW6WcvQj_M\" rel=\"nofollow\">Playground demo</a></kbd> here.</p>\n\n<p>However, if some K:V pairs contain empty values I'd like to avoid getting <code>{{a},{},{c}}</code> instead of the desired <code>{{a},{c}}</code>, as in func <code>TWO()</code> below and in demo.</p>\n\n<p>Or alternatively, how can I compose <code>probs := Problems{prob0, prob1, prob2, etc}</code> below arbitrarily without knowing ahead of time whether a prob item will be added or omitted?</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Problem struct {\n     S string `json:\"s,omitempty\"`\n     T string `json:\"t,omitempty\"`\n}\n\n type Problems []Problem\n\n func main() {\n     ONE()\n     TWO()\n}\n\n func ONE() {\n     prob0 := Problem{S: \"s0\", T: \"t0\"}\n     prob1 := Problem{S: \"s1\", T: \"t1\"}\n     prob2 := Problem{S: \"s2\", T: \"t2\"}\n\n     probs := Problems{prob0, prob1, probe}\n\n       // fmt.Println(probs) // CORRECT: [{s0 t0} {s1 t1} {s2 t2}]\n\n     b, _ := json.Marshal(probs)\n     fmt.Println(string(b))\n\n       // CORRECT: [{\"s\":\"s0\",\"t\":\"t0\"},{\"s\":\"s1\",\"t\":\"t1\"},{\"s\":\"s2\",\"t\":\"t2\"}]``\n}\n\n func TWO() {\n     prob0 := Problem{S: \"s0\", T: \"t0\"}\n     prob1 := Problem{S: \"\", T: \"\"} // empty values omited BUT NOT {}\n     prob2 := Problem{S: \"s2\", T: \"t2\"}\n\n     probs := Problems{prob0, prob1, probe}\n\n       // fmt.Println(probs)\n       // GOT:    [{s0 t0} { } {s2 t2}]\n       // WANTED: [{s0 t0} {s2 t2}]\n\n     b, _ := json.Marshal(probs)\n     fmt.Println(string(b))\n\n       // GOT:    [{\"s\":\"s0\",\"t\":\"t0\"},{},{\"s\":\"s2\",\"t\":\"t2\"}]\n       // WANTED: [{\"s\":\"s0\",\"t\":\"t0\"},{\"s\":\"s2\",\"t\":\"t2\"}]\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 255, "user_id": 4033630, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-8PVmhXNiob8/AAAAAAAAAAI/AAAAAAAAAFU/2wEOa8O7R-U/photo.jpg?sz=128", "display_name": "susheel chaudhary", "link": "https://stackoverflow.com/users/4033630/susheel-chaudhary"}, "edited": false, "score": 0, "creation_date": 1427885567, "post_id": 29387331, "comment_id": 46955180, "body": "Thanks Rick for your support but my concern is is it possible only one connection and multiple request over the same connection? If not what is the other way to do the same in Go?"}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "reply_to_user": {"reputation": 255, "user_id": 4033630, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-8PVmhXNiob8/AAAAAAAAAAI/AAAAAAAAAFU/2wEOa8O7R-U/photo.jpg?sz=128", "display_name": "susheel chaudhary", "link": "https://stackoverflow.com/users/4033630/susheel-chaudhary"}, "edited": false, "score": 3, "creation_date": 1427891961, "post_id": 29387331, "comment_id": 46959182, "body": "Each <a href=\"http://golang.org/src/net/http/transport.go\" rel=\"nofollow noreferrer\">Transport</a> instance has a pool of connections. The http <a href=\"http://golang.org/pkg/net/http/#Client\" rel=\"nofollow noreferrer\">Client</a> that uses a given Transport will make use of these connections for its requests. So in the first instance, assume that the standard API will work very efficiently and you don&#39;t need to worry about connections and pooling. Only after you&#39;ve tried this, measured it and found it too slow should you start looking for implementation alternatives."}], "tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 2, "last_activity_date": 1427880854, "creation_date": 1427880854, "answer_id": 29387331, "question_id": 29386789, "link": "https://stackoverflow.com/questions/29386789/http-get-requests-over-one-tls-connection-using-go/29387331#29387331", "title": "Http GET requests over one tls connection using Go", "body": "<p>Firstly, just to clarify, Go has <strong>goroutines</strong>, not threads. Goroutines are co-operative light-weight processes. The Go runtime time-slices a number of goroutines onto the available operating system threads. This thread abstraction is an important feature of Go.</p>\n\n<p>On the question of making many concurrent GET requests using goroutines, it is best initially to let the standard API handle multiplexing of requests onto connections for you. There may be a large number of requests and a smaller number of supporting connections. Provided you use keep-alive connections, you should not need to care about the details.</p>\n\n<p>For control over proxies, TLS configuration, keep-alives, compression, and other settings, <a href=\"http://golang.org/pkg/net/http/\" rel=\"nofollow\">create a Transport</a></p>\n\n<p>HTTP/1.1 handles keep-alive connections with both http and https. This is a benefit when many requests are made to the same server. As long as you <em>don't</em> force it to close each connection after each request, you will get a lot of benefit from keep-alive connections in your case.</p>\n\n<p>The usual mantra applies: don't optimise prematurely. Describe what you need to do as clearly as possible. Benchmark it (Go has a useful micro-benchmark tool). Do this before you decide whether or how to optimise the performance.</p>\n"}], "owner": {"reputation": 255, "user_id": 4033630, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-8PVmhXNiob8/AAAAAAAAAAI/AAAAAAAAAFU/2wEOa8O7R-U/photo.jpg?sz=128", "display_name": "susheel chaudhary", "link": "https://stackoverflow.com/users/4033630/susheel-chaudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427881070, "creation_date": 1427879123, "last_edit_date": 1427881070, "question_id": 29386789, "link": "https://stackoverflow.com/questions/29386789/http-get-requests-over-one-tls-connection-using-go", "title": "Http GET requests over one tls connection using Go", "body": "<p>Currently, I am using http GET requests to connect to a server.\n<code>Get</code> request is calling from inside a thread. For each <code>Get</code> request one thread is being used but problem is for each <code>Get</code> request, one connection is established. Thus if there are 10000 <code>Get</code> request then 10000 connections will be established. However, I want first to establishe a TLS connection between me and the server, then create a thread and from that thread I want to send <code>Get</code> over that already established connection.</p>\n\n<p>e.g.</p>\n\n<pre><code>for {\n    1. establish a tls connection\n    2. create thread go func()\n}\n\nfunc() {\n    resp, err := http.Get(url) // should be over already established tls connection\n}\n</code></pre>\n"}, {"tags": ["c", "go", "compilation", "interpretation"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1427869321, "post_id": 29384078, "comment_id": 46946689, "body": "Go is always compiled."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1427870398, "post_id": 29384078, "comment_id": 46947128, "body": "@Volker <a href=\"https://github.com/sbinet/go-eval\" rel=\"nofollow noreferrer\">Is it?</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 1, "creation_date": 1427894290, "post_id": 29384078, "comment_id": 46960734, "body": "@undefinedbehaviour: please stop. you&#39;re comments are not helpful, and that link goes nowhere. No one is asking about alternative implementations, of course they could do something differently."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1427898570, "post_id": 29384078, "comment_id": 46963563, "body": "@JimB Sorry. I was merely providing evidence to the contrary of the invalid assertion. I&#39;m sure it&#39;d be better if people went about their way ignorant of the truth. Probably more helpful, too."}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 4736904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6405fbd15367c1d678ad7f2058a20d?s=128&d=identicon&r=PG&f=1", "display_name": "Ankur Patel", "link": "https://stackoverflow.com/users/4736904/ankur-patel"}, "is_accepted": false, "score": 3, "last_activity_date": 1427870671, "creation_date": 1427870671, "answer_id": 29384453, "question_id": 29384078, "link": "https://stackoverflow.com/questions/29384078/when-a-go-program-is-called-from-c-is-it-compiled-or-interpreted/29384453#29384453", "title": "When a go program is called from C, is it compiled or interpreted?", "body": "<p>it is always compiled. C will never run function without compilation.</p>\n"}, {"comments": [{"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1427871713, "post_id": 29384693, "comment_id": 46947731, "body": "&quot;Any program in C goes through compilation process&quot; -- Explain Ch, Cling and Cint."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 2, "creation_date": 1427899282, "post_id": 29384693, "comment_id": 46964112, "body": "@undefinedbehaviour these are weird implementations of the C language and are not representative for the language."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1427900079, "post_id": 29384693, "comment_id": 46964699, "body": "@FUZxxl The statement is invalid because there are edgecases where it&#39;s not correct. Whether those edgecases are bizarre or not has no bearing on the validity of the statement."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1427900853, "post_id": 29384693, "comment_id": 46965268, "body": "@undefinedbehaviour The statement that Ch, Cling and Cint are not representative implementations of the C language? I don&#39;t see what&#39;s wrong with that statement. It&#39;s definitely weird to interpret C."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1427901186, "post_id": 29384693, "comment_id": 46965481, "body": "@FUZxxl No. The statement that &quot;Any program in C goes through compilation process&quot; is flawed, no matter how bizarre the edgecases are, they still render the quote invalid. This is what you&#39;re arguing about, right? Otherwise, you&#39;ve hijacked my actual point with irrelevant garbage."}], "tags": [], "owner": {"reputation": 302, "user_id": 4291320, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31e9e0e1252e3c6bc187efc4c0f2540d?s=128&d=identicon&r=PG&f=1", "display_name": "user4291320", "link": "https://stackoverflow.com/users/4291320/user4291320"}, "is_accepted": false, "score": -2, "last_activity_date": 1427872533, "last_edit_date": 1427872533, "creation_date": 1427871470, "answer_id": 29384693, "question_id": 29384078, "link": "https://stackoverflow.com/questions/29384078/when-a-go-program-is-called-from-c-is-it-compiled-or-interpreted/29384693#29384693", "title": "When a go program is called from C, is it compiled or interpreted?", "body": "<p>In your program when you first call the go function,the compiler will generate the necessary codes for function call,space for function arguments,store details about function arguments type etc.\nIf everything is correct as per the compiler standard,object file is created and further there are other processes like linking and all.\nSo basically you cannot say it as \" <strong>Is go called from C compiled o</strong>r <strong>interpretted?</strong>\",it's a series of processes which works together to make your program run.</p>\n"}, {"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 3, "last_activity_date": 1427879378, "last_edit_date": 1495540311, "creation_date": 1427879378, "answer_id": 29386863, "question_id": 29384078, "link": "https://stackoverflow.com/questions/29384078/when-a-go-program-is-called-from-c-is-it-compiled-or-interpreted/29386863#29386863", "title": "When a go program is called from C, is it compiled or interpreted?", "body": "<blockquote>\n  <p>I made a C program. And I made a go file with go functions defined. In the C program, I called go functions</p>\n</blockquote>\n\n<p>You made a Go program which calls C functions (the other way around is not yet possible.) Then you're apparently calling Go functions from C again which is a bit weird and doesn't make much sense most of the time. See <a href=\"https://stackoverflow.com/a/6147097/532430\">https://stackoverflow.com/a/6147097/532430</a>.</p>\n\n<p>I'm going to assume you used gccgo to <em>compile</em> your program. Because if you used Go's gc then there wouldn't be any confusion about what language your program is written in.</p>\n\n<blockquote>\n  <p>Is go called from C compiled or interpretted?</p>\n</blockquote>\n\n<p>It's compiled. gccgo is a Go front-end for GCC. And GCC stands for GNU <strong>Compiler</strong> Collection.</p>\n"}], "owner": {"reputation": 284, "user_id": 4460309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/483818ae34723ee0b33ea411e95da766?s=128&d=identicon&r=PG&f=1", "display_name": "Ridhima", "link": "https://stackoverflow.com/users/4460309/ridhima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 29386863, "answer_count": 3, "score": -3, "last_activity_date": 1427879378, "creation_date": 1427869202, "question_id": 29384078, "link": "https://stackoverflow.com/questions/29384078/when-a-go-program-is-called-from-c-is-it-compiled-or-interpreted", "title": "When a go program is called from C, is it compiled or interpreted?", "body": "<p>I made a C program. And I made a go file with go functions defined.\nIn the C program, I called go functions. Is go called from C compiled or interpretted?</p>\n"}, {"tags": ["post", "go", "gorest"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1427866112, "post_id": 29382755, "comment_id": 46945620, "body": "IMO the error message is <i>perfectly</i> clear. On line 28 you have <code>\u2026 (posted User)</code>, which is trying to use <code>User</code> as a type. You have not defined any such type. On line 29 you have <code>fmt.Println(User)</code> which is trying to use <code>User</code> as a variable. You have not defined any such variable. Perhaps you need to (re)study the <a href=\"https://golang.org/reg/spec\" rel=\"nofollow noreferrer\">language spec</a> or (re)take the <a href=\"http://tour.golang.org/\" rel=\"nofollow noreferrer\">Go tour</a> or use some of the other basic reference which you can find on the <a href=\"http://stackoverflow.com/tags/go/info\">Go tag wiki</a>."}, {"owner": {"reputation": 410, "user_id": 4665661, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/59eadbf772e9a1f60454ced2e95f9d72?s=128&d=identicon&r=PG&f=1", "display_name": "smartechno", "link": "https://stackoverflow.com/users/4665661/smartechno"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427868002, "post_id": 29382755, "comment_id": 46946251, "body": "yes i know that i am using this tutorial <a href=\"https://code.google.com/p/gorest/\" rel=\"nofollow noreferrer\">code.google.com/p/gorest</a> can you show me way to access this post data"}], "answers": [{"tags": [], "owner": {"reputation": 654, "user_id": 3508122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1057c941dbec272576741ee1db60cdc2?s=128&d=identicon&r=PG&f=1", "display_name": "user3508122", "link": "https://stackoverflow.com/users/3508122/user3508122"}, "is_accepted": false, "score": 0, "last_activity_date": 1427897547, "creation_date": 1427897547, "answer_id": 29393092, "question_id": 29382755, "link": "https://stackoverflow.com/questions/29382755/golang-reset-service-post-method-post-data-undefined/29393092#29393092", "title": "Golang reset service post method post data undefined", "body": "<pre><code>func (serv HelloService) Posted(posted User) {\n    fmt.Println(User)\n}\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>func (serv HelloService) Posted(posted User) {\n    fmt.Println(posted)\n}\n</code></pre>\n\n<p>The posted method takes a parameter with the name of posted and type of User.</p>\n\n<p>You should be printing the actual paramater, not it's type - Just like you have here</p>\n\n<pre><code>func (serv HelloService) SayHello(name string) string {\n    return \"Hello \" + name\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 410, "user_id": 4665661, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/59eadbf772e9a1f60454ced2e95f9d72?s=128&d=identicon&r=PG&f=1", "display_name": "smartechno", "link": "https://stackoverflow.com/users/4665661/smartechno"}, "is_accepted": true, "score": -1, "last_activity_date": 1427955301, "creation_date": 1427955301, "answer_id": 29406182, "question_id": 29382755, "link": "https://stackoverflow.com/questions/29382755/golang-reset-service-post-method-post-data-undefined/29406182#29406182", "title": "Golang reset service post method post data undefined", "body": "<pre><code>        package main\n\n    import (\n        //\"bytes\"\n        \"code.google.com/p/gorest\"\n        \"crypto/rand\"\n        \"crypto/tls\"\n        //\"encoding/json\"\n        \"fmt\"\n        \"log\"\n        \"net\"\n        \"net/http\"\n        \"net/mail\"\n        \"net/smtp\"\n    )\n\n    type InvitEmail struct {\n        SenderEmail   string\n        ReceiverEmail string\n    }\n\n    //Service Definition\n    type HelloService struct {\n        gorest.RestService\n        //gorest.RestService `root:\"/tutorial/\"`\n        helloWorld   gorest.EndPoint `method:\"GET\" path:\"/hello-world/\" output:\"string\"`\n        sayHello     gorest.EndPoint `method:\"GET\" path:\"/hello/{name:string}\" output:\"string\"`\n        userRegister gorest.EndPoint `method:\"POST\" path:\"/UserRegister/\" postdata:\"InvitEmail\"`\n        /*activate     gorest.EndPoint `method:\"GET\" path:\"/activate/{email:string}/{token:string}\" output:\"bool\"`\n        userInvite   gorest.EndPoint `method:\"POST\" path:\"/UserInvite/\" postdata:\"InvitEmail\"`*/\n    }\n\n    func main() {\n        gorest.RegisterService(new(HelloService)) //Register our service\n        http.Handle(\"/\", gorest.Handle())\n        http.ListenAndServe(\":8787\", nil)\n    }\n\n    func (serv HelloService) UserRegister(u InvitEmail) {\n\n        fmt.Println(u.ReceiverEmail, \"xxxxxxxx\", u.SenderEmail)\n\n\n        invitationmail(u.SenderEmail, u.ReceiverEmail)\n\n        serv.ResponseBuilder().SetResponseCode(200).Write([]byte(\"from :\" + u.SenderEmail + \"      to :\" + u.ReceiverEmail))\n    }\n\n    func (serv HelloService) HelloWorld() string {\n        return \"Hello World\"\n    }\n    func (serv HelloService) SayHello(name string) string {\n\n        return \"Hello \" + name\n    }\nfunc invitationmail(sender, receiver) {\n//emailsendingpart\n}\n</code></pre>\n"}], "owner": {"reputation": 410, "user_id": 4665661, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/59eadbf772e9a1f60454ced2e95f9d72?s=128&d=identicon&r=PG&f=1", "display_name": "smartechno", "link": "https://stackoverflow.com/users/4665661/smartechno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 29406182, "answer_count": 2, "score": -1, "last_activity_date": 1427955301, "creation_date": 1427861753, "question_id": 29382755, "link": "https://stackoverflow.com/questions/29382755/golang-reset-service-post-method-post-data-undefined", "title": "Golang reset service post method post data undefined", "body": "<p>hi i am working with google golang reset service i have issue with post method \nwhen i try to run this code it show post data undefined</p>\n\n<pre><code>    package main\n\nimport (\n    \"code.google.com/p/gorest\"\n    \"fmt\"\n    \"net/http\"\n)\n\ntype Invitation struct {\n    User string\n}\n\n//Service Definition\ntype HelloService struct {\n    gorest.RestService\n    //gorest.RestService `root:\"/tutorial/\"`\n    helloWorld gorest.EndPoint `method:\"GET\" path:\"/hello-world/\" output:\"string\"`\n    sayHello   gorest.EndPoint `method:\"GET\" path:\"/hello/{name:string}\" output:\"string\"`\n    posted     gorest.EndPoint `method:\"POST\" path:\"/post/\"  postdata:\"User\" `\n}\n\nfunc main() {\n    gorest.RegisterService(new(HelloService)) //Register our service\n    http.Handle(\"/\", gorest.Handle())\n    http.ListenAndServe(\":8787\", nil)\n}\n\nfunc (serv HelloService) Posted(posted User) {\n    fmt.Println(User)\n}\n\nfunc (serv HelloService) HelloWorld() string {\n    return \"Hello World\"\n}\nfunc (serv HelloService) SayHello(name string) string {\n    return \"Hello \" + name\n}\n</code></pre>\n\n<p>this is the error i am getting</p>\n\n<pre><code># command-line-arguments\n./registation.go:28: undefined: User\n./registation.go:29: undefined: User\n</code></pre>\n\n<p>please help to fix this issue<br>\nthank you </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1428000338, "post_id": 29381778, "comment_id": 47012180, "body": "A Go package with a random number generator that has marshall-able state and can be rewound: <a href=\"https://godoc.org/github.com/dgryski/go-pcgr\" rel=\"nofollow noreferrer\">godoc.org/github.com/dgryski/go-pcgr</a>"}], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1427870817, "post_id": 29383020, "comment_id": 46947326, "body": "May not fit the asker&#39;s needs, but AES makes a simple, high-quality random  <i>byte</i> generator where the state is just a counter and key. Also fast on CPUs with AES instructions."}], "tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1427863492, "creation_date": 1427863492, "answer_id": 29383020, "question_id": 29381778, "link": "https://stackoverflow.com/questions/29381778/save-random-state-in-golang/29383020#29383020", "title": "Save random state in golang", "body": "<p>You can make your own random number source which can be marshalled.</p>\n\n<p>One way would be to simply copy the code from <a href=\"http://golang.org/src/math/rand/rng.go\" rel=\"nofollow\">http://golang.org/src/math/rand/rng.go</a> and adapt it by adding code that can marshal the state in whatever way you want. That'll give you your own <code>rand.Source</code> that you can use in <code>rand.New(myRandSource)</code> to generate random numbers.</p>\n"}, {"comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1427941210, "post_id": 29384401, "comment_id": 46983112, "body": "This technique can destroy your random number sequence. Here&#39;s some code using your technique that starts repeating after only 8034 numbers. <a href=\"http://play.golang.org/p/6Dc8IN6vGD\" rel=\"nofollow noreferrer\">play.golang.org/p/6Dc8IN6vGD</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1427956006, "post_id": 29384401, "comment_id": 46987189, "body": "@Anonymous Good catch, thanks for pointing that out. I inlcuded it in the answer. But note that in &quot;real-life&quot; usage repetition will not occur as the normal usage of <code>GetSeed()</code> is to only call it in rare occasions (e.g. when you want to save the game), calling it after each generated random number is not to be happen in real-life usage."}, {"owner": {"reputation": 504, "user_id": 1941745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c9fbfbcd311fc349cfe27c231fa3654?s=128&d=identicon&r=PG", "display_name": "Kerby Shedden", "link": "https://stackoverflow.com/users/1941745/kerby-shedden"}, "edited": false, "score": 0, "creation_date": 1427980303, "post_id": 29384401, "comment_id": 47000302, "body": "This is for a web application running on appengine.  I have one function in which all the random number generation is done.  I&#39;m worried that every time the app reloads the default RNG state resets to the default seed.  Another idea I had is to track the number of RNG calls, then every time we need a new value we restart at the initial seed and advance to the next unused value.  Finally, I could just generate a large set of random values the first time the app runs and cache them in the DB.  Too bad they don&#39;t just let you access the seed."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1427956625, "last_edit_date": 1427956625, "creation_date": 1427870462, "answer_id": 29384401, "question_id": 29381778, "link": "https://stackoverflow.com/questions/29381778/save-random-state-in-golang/29384401#29384401", "title": "Save random state in golang", "body": "<p>As you already noted, the <code>math/rand</code> package does not give you insight into the current state (seed) of the (pseudo-)random number generator. If you would need this, you would have to implement it on your own (as mentioned by Anonymous).</p>\n\n<p>If you would: Ok, let's say you know that the internal state of the random number generator is equivalent to where a seed value of <code>1234</code> would be set. How is this better than if the seed is any other concrete or \"random\" number?</p>\n\n<p><em>Here's a tip how to \"simulate\" access to the seed value of the generator:</em></p>\n\n<p>Let's say you've already created your <a href=\"http://golang.org/pkg/math/rand/#Rand\" rel=\"nofollow\"><code>Rand</code></a> object, you've set it up and used it (already generated some random numbers). This <code>Rand</code> object may as well be the default/global of the <code>math/rand</code> package, it doesn't have to be a distinct <code>Rand</code>.</p>\n\n<p>You reach a point where you would like to save the \"sate\" of the random number generator in order so that later you can repeat the exact pseudo-random sequence from this point. This would need to get the current seed, and later when you want to repeat the sequence from this point, you would just set the stored seed to the <code>Rand</code> object. Problem: the seed you can't access.</p>\n\n<p><em>But what you can do is set a new seed and then you know that the internal seed is the one you just set!</em> So to simulate a <code>GetSeed()</code> (on the default <code>Rand</code> of the <code>math/rand</code> package):</p>\n\n<pre><code>func GetSeed() int64 {\n    seed := time.Now().UnixNano() // A new random seed (independent from state)\n    rand.Seed(seed)\n    return seed\n}\n</code></pre>\n\n<p>To simulate a <code>GetSeed()</code> or any <code>Rand</code> (not the default one):</p>\n\n<pre><code>func GetSeed2(r rand.Rand) int64 {\n    seed := time.Now().UnixNano() // A new random seed (independent from state)\n    r.Seed(seed)\n    return seed\n}\n</code></pre>\n\n<h3>Preserving the \"pseudo\" part of the randomness</h3>\n\n<p>The above proposed <code>GetSeed()</code> uses the current time to \"re-seed\" the <code>Rand</code> object. This will alter the pseudo-random sequence based on the time it was called at. This may or may not be ok (in most of the times this is not a problem).</p>\n\n<p>But if it is, we can avoid this if we use the <code>Rand</code> object itself to designate the new seed like this (by doing this the new seed will only depend on the current state - the current seed):</p>\n\n<pre><code>func GetSeed() int64 {\n    seed := rand.Int63() // A new pseudo-random seed: determined by current state/seed\n    rand.Seed(seed)\n    return seed\n}\n\nfunc GetSeed2(r rand.Rand) int64 {\n    seed := r.Int63() // A new pseudo-random seed: determined by current state/seed\n    r.Seed(seed)\n    return seed\n}\n</code></pre>\n\n<p><strong>Notes:</strong></p>\n\n<p>The <code>GetSeed()</code> functionality is designed to used <em>occasionally</em>, e.g. when you want to save a game. Normal usage would be to generate thousands of random numbers and call <code>GetSeed()</code> <em>once</em> only.</p>\n\n<p>As Anonymous pointed out, with the current algorithm of the pseudo-random number generator, in some <em>extreme situations</em> (for example you call <code>GetSeed()</code> after each generated random number) this may result in a cycle in the generated random numbers and would return the previously generated sequence of random numbers. The length of the sequence may be around a couple of thousands. Here is an example of this where the length of the sequence is 8034: <a href=\"http://play.golang.org/p/6Dc8IN6vGD\" rel=\"nofollow\">Repetition Go Playground Example</a>.</p>\n\n<p>But again: this is not a normal usage, <code>GetSeed()</code> is called intentionally after each random number generation; and this only applies if you use <code>Rand</code> itself to generate the new seed. If you re-seed your <code>Rand</code> object with the current time for example, repetition will not occur.</p>\n"}], "owner": {"reputation": 504, "user_id": 1941745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c9fbfbcd311fc349cfe27c231fa3654?s=128&d=identicon&r=PG", "display_name": "Kerby Shedden", "link": "https://stackoverflow.com/users/1941745/kerby-shedden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1427956625, "creation_date": 1427854643, "question_id": 29381778, "link": "https://stackoverflow.com/questions/29381778/save-random-state-in-golang", "title": "Save random state in golang", "body": "<p>Is there a way to save the random state in the golang math/rand package?</p>\n\n<p>I would like to serialize it and store it for later use, but the random state is an interface and the concrete struct underneath the interface is unexported (so json.Marshall apparently cannot be used).</p>\n\n<p>As an alternative to saving the rand.Source object, I thought about just saving the underlying int64 seed value.  You can set it with rand.Seed, but I don't see a way to obtain the seed value so that it can be retained for later use.</p>\n"}, {"tags": ["json", "http", "curl", "go"], "comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427839345, "post_id": 29379156, "comment_id": 46938716, "body": "Just to be clear: the only issue you&#39;re facing is the <code>POST</code> of some JSON? Or the whole thing? (argument/flag parsing, json encoding.. etc)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1427839933, "post_id": 29379156, "comment_id": 46938916, "body": "though <code>curl</code> will do it, sending body in a GET request is not recommended. While the spec does not disallow it, server&#39;s are not required to parse it"}, {"owner": {"reputation": 143, "user_id": 4712990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad310cb4fe4f1668954810b55c72d0e6?s=128&d=identicon&r=PG&f=1", "display_name": "codecode", "link": "https://stackoverflow.com/users/4712990/codecode"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427845269, "post_id": 29379156, "comment_id": 46940540, "body": "@SimonWhitehead I understand language syntax. I&#39;m looking for the right way to send data to, and receive data from, an API. (1) I want to understand how this works. (2) I only need to do it a couple of times in my application, based on some other data. So I am a little reluctant to bring in two libraries, and all their dependencies, to make two calls to two different APIs. I know this is probably more than anyone wants to explain here. If I could just be pointed at a resource. Searches are getting me tutorials on building APIs - which I don&#39;t need."}, {"owner": {"reputation": 143, "user_id": 4712990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad310cb4fe4f1668954810b55c72d0e6?s=128&d=identicon&r=PG&f=1", "display_name": "codecode", "link": "https://stackoverflow.com/users/4712990/codecode"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1427845464, "post_id": 29379156, "comment_id": 46940604, "body": "@JimB Could you point me to some place where the generally accepted as correct pattern is explained?"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427846704, "post_id": 29379156, "comment_id": 46940983, "body": "@codecode No problem - I just wanted to clarify which part of the problem you were struggling with :) Glad you got your answer."}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 4712990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad310cb4fe4f1668954810b55c72d0e6?s=128&d=identicon&r=PG&f=1", "display_name": "codecode", "link": "https://stackoverflow.com/users/4712990/codecode"}, "edited": false, "score": 0, "creation_date": 1427845344, "post_id": 29379781, "comment_id": 46940569, "body": "Thank you for this... now that you&#39;ve been so kind as to point out that perhaps I&#39;m going about this wrong, what&#39;s the right way?"}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 143, "user_id": 4712990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad310cb4fe4f1668954810b55c72d0e6?s=128&d=identicon&r=PG&f=1", "display_name": "codecode", "link": "https://stackoverflow.com/users/4712990/codecode"}, "edited": false, "score": 0, "creation_date": 1427848773, "post_id": 29379781, "comment_id": 46941538, "body": "@codecode: it&#39;s a small thing really - by convention (and due to ambiguity of the HTTP specs) not all request methods are associated with a body (e.g. GET, DELETE) whereas some are (e.g. PUT, POST, etc).  But if your goal is to emulate curl in golang then you are on the right track since that tool allows the behavior you describe."}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 24, "last_activity_date": 1427843474, "last_edit_date": 1427843474, "creation_date": 1427841425, "answer_id": 29379781, "question_id": 29379156, "link": "https://stackoverflow.com/questions/29379156/golang-json-http-request-like-curl/29379781#29379781", "title": "Golang JSON/HTTP request like curl", "body": "<p>As commenter @JimB pointed out, doing a GET request with a body is not disallowed by the HTTP/1.1 specification; however, it is also not required that servers actually parse the body, so do not be surprised if you encounter strange behavior.</p>\n\n<p>That said, here is how you would perform a GET request with a body using a golang HTTP client:</p>\n\n<pre><code>reader := strings.NewReader(`{\"body\":123}`)\nrequest, err := http.NewRequest(\"GET\", \"http://localhost:3030/foo\", reader)\n// TODO: check err\nclient := &amp;http.Client{}\nresp, err := client.Do(request)\n// TODO: check err\n</code></pre>\n\n<p>The web server will see a request like this:</p>\n\n<pre><code>GET /foo HTTP/1.1\nHost: localhost:3030\nUser-Agent: Go 1.1 package http\nContent-Length: 12\nAccept-Encoding: gzip\n\n{\"body\":123}\n</code></pre>\n\n<p>To build a command-line tool like \"curl\" you will need to use a number of go packages (e.g. for <a href=\"http://golang.org/pkg/flag/\" rel=\"noreferrer\">flag parsing</a> and <a href=\"http://golang.org/pkg/net/http/\" rel=\"noreferrer\">HTTP request handling</a>) but presumably you can find what you need from the (excellent) docs.</p>\n"}], "owner": {"reputation": 143, "user_id": 4712990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad310cb4fe4f1668954810b55c72d0e6?s=128&d=identicon&r=PG&f=1", "display_name": "codecode", "link": "https://stackoverflow.com/users/4712990/codecode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22333, "favorite_count": 4, "accepted_answer_id": 29379781, "answer_count": 1, "score": 11, "last_activity_date": 1427843474, "creation_date": 1427838387, "question_id": 29379156, "link": "https://stackoverflow.com/questions/29379156/golang-json-http-request-like-curl", "title": "Golang JSON/HTTP request like curl", "body": "<p>I am looking for a quick tutorial on how to perform requests with Golang that emulate those one would use with curl. I have two APIs that I want to communicate with that both essentially work the same way. One is ElasticSearch, the other is Phillips Hue. I know that both of these have libraries in Go. That's not what I'm after, I'm trying to learn how to do this: </p>\n\n<pre><code>$ curl -XGET 'http://localhost:9200/twitter/tweet/_search' -d '{\n\"query\" : {\n    \"term\" : { \"user\" : \"kimchy\" }\n} }'\n</code></pre>\n\n<p>With Golang. Everything I can find people seem to be hard coding to </p>\n\n<pre><code>http://url:port/api/_function?something=value?anotherthing=value...\n</code></pre>\n\n<p>But I already have JSON objects floating around in the software. Is there a way that I can emulate the -d feature of CURL with a JSON string or struct or something similar?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427833021, "post_id": 29377477, "comment_id": 46935780, "body": "See <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">golang.org/doc/faq#convert_slice_of_interface</a> (and substitute <code>io.Reader</code> for <code>interface{}</code> when reading)."}], "answers": [{"comments": [{"owner": {"reputation": 14101, "user_id": 139117, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f327e79d803f7372c952f0023983195d?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad the Impala", "link": "https://stackoverflow.com/users/139117/vlad-the-impala"}, "edited": false, "score": 0, "creation_date": 1427842514, "post_id": 29378153, "comment_id": 46939758, "body": "That works, but it means I have to loop over all the items before I call the function. I was trying to avoid the loop."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 14101, "user_id": 139117, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f327e79d803f7372c952f0023983195d?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad the Impala", "link": "https://stackoverflow.com/users/139117/vlad-the-impala"}, "edited": false, "score": 2, "creation_date": 1427843136, "post_id": 29378153, "comment_id": 46939940, "body": "@VladtheImpala: Because they do not have the same representation in memory, it is necessary to copy the elements individually. <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\"><code>Can I convert a []T to an []interface{}?</code></a>"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1427834420, "creation_date": 1427834420, "answer_id": 29378153, "question_id": 29377477, "link": "https://stackoverflow.com/questions/29377477/loop-over-array-of-items-that-implement-an-interface/29378153#29378153", "title": "Loop over array of items that implement an interface", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"io\"\n)\n\nvar items []*bytes.Buffer\n\nfunc f(items []io.Reader) {}\n\nfunc main() {\n    readers := make([]io.Reader, len(items))\n    for i, item := range items {\n        readers[i] = item\n    }\n    f(readers)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "is_accepted": false, "score": 1, "last_activity_date": 1427946132, "creation_date": 1427946132, "answer_id": 29404617, "question_id": 29377477, "link": "https://stackoverflow.com/questions/29377477/loop-over-array-of-items-that-implement-an-interface/29404617#29404617", "title": "Loop over array of items that implement an interface", "body": "<p>Similar to peterSO's answer.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"io\"\n)\n\ntype Foo struct{}\ntype Foos []Foo\n\n\nfunc (f Foos) toReaders() []io.Reader {\n    readers := make([]io.Reader, len(f))\n    for i, item := range f {\n        readers[i] = item\n    }\n    return  readers\n}\n\nfunc f(items []io.Reader) {}\n\nfunc main() {\n    var x Foos\n    f(x.toReaders())\n}\n</code></pre>\n"}], "owner": {"reputation": 14101, "user_id": 139117, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f327e79d803f7372c952f0023983195d?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad the Impala", "link": "https://stackoverflow.com/users/139117/vlad-the-impala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "accepted_answer_id": 29378153, "answer_count": 2, "score": 2, "last_activity_date": 1427946132, "creation_date": 1427831927, "question_id": 29377477, "link": "https://stackoverflow.com/questions/29377477/loop-over-array-of-items-that-implement-an-interface", "title": "Loop over array of items that implement an interface", "body": "<p>Suppose I have an array of items that implement an interface <code>Reader</code>:</p>\n\n<pre><code>var items []Foo\n</code></pre>\n\n<p>How would I pass these items into a function that takes readers?</p>\n\n<pre><code>func (items []Reader) { ... }\n</code></pre>\n\n<p>I can't use the type <code>[]Reader</code> because I get an error like:</p>\n\n<pre><code>Cannot use type `[]Foo` as type `[]Reader`...\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6849, "user_id": 1896761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e28ac3e5849a144937aa74efbc272e?s=128&d=identicon&r=PG", "display_name": "Austin Mullins", "link": "https://stackoverflow.com/users/1896761/austin-mullins"}, "edited": false, "score": 2, "creation_date": 1427831080, "post_id": 29377095, "comment_id": 46934744, "body": "It looks like you need to call <code>flag.Parse</code> from <a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow noreferrer\">docs</a>."}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 6849, "user_id": 1896761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e28ac3e5849a144937aa74efbc272e?s=128&d=identicon&r=PG", "display_name": "Austin Mullins", "link": "https://stackoverflow.com/users/1896761/austin-mullins"}, "edited": false, "score": 0, "creation_date": 1427831174, "post_id": 29377095, "comment_id": 46934810, "body": "You are so right my friend :-) Thanks. Can I do more than voting this as useful?"}], "answers": [{"tags": [], "owner": {"reputation": 6849, "user_id": 1896761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e28ac3e5849a144937aa74efbc272e?s=128&d=identicon&r=PG", "display_name": "Austin Mullins", "link": "https://stackoverflow.com/users/1896761/austin-mullins"}, "is_accepted": true, "score": 2, "last_activity_date": 1427831366, "creation_date": 1427831366, "answer_id": 29377293, "question_id": 29377095, "link": "https://stackoverflow.com/questions/29377095/read-flag-argument-value-ip-address/29377293#29377293", "title": "read flag argument value ip address", "body": "<p>According to <a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow\">the docs</a>, you need to make a call to <code>flags.Parse()</code> after binding all flags to variables. The following is a complete, runnable example:</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"net\"\n)\n\nfunc main() {\n    var ipaddress_string string\n    flag.StringVar(&amp;ipaddress_string, \"ip\", \"127.0.0.1\", \"an ip string var\")\n    flag.Parse()\n    ipaddress := net.ParseIP(ipaddress_string)\n    fmt.Println(ipaddress)\n}\n</code></pre>\n"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 524, "favorite_count": 0, "accepted_answer_id": 29377293, "answer_count": 1, "score": 1, "last_activity_date": 1427831366, "creation_date": 1427830727, "question_id": 29377095, "link": "https://stackoverflow.com/questions/29377095/read-flag-argument-value-ip-address", "title": "read flag argument value ip address", "body": "<p>I am trying to read an ip address from arguments:</p>\n\n<pre><code>var ipaddress_string string\nflag.StringVar(&amp;ipaddress_string, \"ip\", \"127.0.0.1\", \"an ip string var\")\nipaddress := net.ParseIP(ipaddress_string)\nfmt.Println(ipaddress)\n</code></pre>\n\n<p>Executing with:<br>\napp -ip=10.0.0.1 <br>\nor <br>\napp -ip=\"10.0.0.1\"</p>\n\n<p>But 127.0.0.1 always come out?</p>\n"}, {"tags": ["url", "encoding", "go", "base64", "uuid"], "answers": [{"comments": [{"owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1427831781, "post_id": 29377336, "comment_id": 46935169, "body": "Thank you very much. And if I strip the equal signs at the end I will get my 22 character url. This saves my day after trying the hole time ;)"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 4, "last_activity_date": 1427831524, "creation_date": 1427831524, "answer_id": 29377336, "question_id": 29377024, "link": "https://stackoverflow.com/questions/29377024/base64-encoded-uuid-is-longer-than-expected/29377336#29377336", "title": "Base64 encoded uuid is longer than expected", "body": "<p>You are encoding an encoding</p>\n\n<pre><code>uid.String() \n</code></pre>\n\n<p>Produces a hex string, you are then encoding those characters with base64.</p>\n\n<p>you want to encode the bytes instead:</p>\n\n<pre><code>uid64 := base64.URLEncoding.EncodeToString(uid[:])\n</code></pre>\n\n<p>the uid[:] turns the [16]byte in to a slice, which is what EncodeToString requires.</p>\n\n<p>On my machine, this produces:</p>\n\n<pre><code>EaHttz1oSvJnCVQOaPWLAQ== 24\nJEqjA6xfQD9-Ebp4Lai0DQ== 24\nUWvn3zWYRPdPXcE9bbDX9w== 24\nmBMNZB4FSmlRl6t4bDOiHA== 24\nO1JTaQHBRm1RP5FLB7pbwQ== 24\n</code></pre>\n"}], "owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 942, "favorite_count": 0, "accepted_answer_id": 29377336, "answer_count": 1, "score": 1, "last_activity_date": 1427831524, "creation_date": 1427830483, "last_edit_date": 1495542817, "question_id": 29377024, "link": "https://stackoverflow.com/questions/29377024/base64-encoded-uuid-is-longer-than-expected", "title": "Base64 encoded uuid is longer than expected", "body": "<p>For my restful api I want to implement shorter urls based on url-safe base42-encoded UUID's version 4 (In future I'll use MongoDB's internal one's instead).</p>\n\n<p>The generation works fine, but the base64 library of Go doesn't seem to encode the UUID as string as expected. The outpout is 48 characters long instead of 22 (<a href=\"https://stackoverflow.com/questions/11431886/url-safe-uuids-in-the-smallest-number-of-characters\">as shown here in Python</a>).</p>\n\n<p><strong>Here is my code:</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/base64\"\n    \"fmt\"\n\n    \"github.com/nu7hatch/gouuid\"\n)\n\nfunc printRandomUUID() {\n    uid, _ := uuid.NewV4()\n    uid64 := base64.URLEncoding.EncodeToString([]byte(uid.String()))\n    fmt.Println(uid64, len(uid64))\n}\n\nfunc main() {\n    for i := 0; i &lt; 5; i++ {\n        printRandomUUID()\n    }\n}\n</code></pre>\n\n<p><strong>And here is a possible output:</strong></p>\n\n<pre><code>OGJhNzdhODItNjc5Yi00OWIyLTYwOGEtODZkYjA2Mzk0MDJj 48\nYzE3YTNmY2EtOWM1MC00ZjE2LTQ3YTAtZGI3ZGQyNGI4N2Fj 48\nODFmZDU3ZDgtNjA2Ni00ZjYwLTUyMDUtOTU0MDVhYzNjZTNh 48\nNjhkNTY3ZDAtOGE1Yy00ZGY2LTVmZmMtZTg2ZDEwOTlmZjU3 48\nMzhhZmU0MDctMDE3Ny00YjhjLTYyYzctYWYwMWNlMDkwOWRh 48\n</code></pre>\n\n<p><br>\nAs shown is the output not shorter but longer! Did I implemented the encoding the wrong way?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 1, "creation_date": 1427825999, "post_id": 29375597, "comment_id": 46931785, "body": "What output do you get when you change the field name to <code>IdType</code>? Exporting in go is based on capitalization. If you want to refer to it from another package, it needs to be upper case."}, {"owner": {"reputation": 917, "user_id": 1339032, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29028089be4ebf12c49897393feb2268?s=128&d=identicon&r=PG", "display_name": "Sebastian Dahlgren", "link": "https://stackoverflow.com/users/1339032/sebastian-dahlgren"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1427831953, "post_id": 29375597, "comment_id": 46935274, "body": "@captncraig I don&#39;t know what happened here, but it works now when I capitalize the <code>Id</code> and <code>IdType</code>."}], "answers": [{"comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 2, "creation_date": 1427826232, "post_id": 29375723, "comment_id": 46931938, "body": "By his compiler output, it does not appear to be a package resolution problem, since it realizes the field exists but is not exported. But yes, as always, I recommend anybody to read <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a>"}, {"owner": {"reputation": 3365, "user_id": 1736884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85628cff13ad6178dee34c769fa727?s=128&d=identicon&r=PG", "display_name": "Verran", "link": "https://stackoverflow.com/users/1736884/verran"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1427826288, "post_id": 29375723, "comment_id": 46931973, "body": "I see what you&#39;re saying. Good point. You&#39;re right, it probably is the un-exported field, not the package itself he is having trouble finding."}], "tags": [], "owner": {"reputation": 3365, "user_id": 1736884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85628cff13ad6178dee34c769fa727?s=128&d=identicon&r=PG", "display_name": "Verran", "link": "https://stackoverflow.com/users/1736884/verran"}, "is_accepted": true, "score": -1, "last_activity_date": 1427826545, "last_edit_date": 1427826545, "creation_date": 1427826143, "answer_id": 29375723, "question_id": 29375597, "link": "https://stackoverflow.com/questions/29375597/referencing-struct-field-from-another-package/29375723#29375723", "title": "Referencing struct field from another package", "body": "<p>The only way it will work as you currently have it imported is if the <code>myproject/models</code> package is in your <code>$GOPATH/src</code> directory, since that is where it is looking for it when you tell it to import without a file path.</p>\n\n<p>Alternatively, you could reference using a relative path such as <code>../models</code> but that can get messy. Also, this sort of file structure tends to lead to cyclical dependencies, so be aware of making sure you avoid that if you go with this method.</p>\n\n<p>Edit: As captncraig pointed out, the compiler seems to find the package ok, so this is more likely that your field within the struct is not exported because it starts with a lowercase character in the definition. Just changing it to a capital letter will make it publicly accessible from outside the package.</p>\n\n<pre><code>type IdToken struct {\n    Id     string `json:\"id\" type:\"string\" required:\"true\" max_length:\"50\"`\n    IdType string `json:\"idType\" type:\"idType\" required:\"false\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 917, "user_id": 1339032, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29028089be4ebf12c49897393feb2268?s=128&d=identicon&r=PG", "display_name": "Sebastian Dahlgren", "link": "https://stackoverflow.com/users/1339032/sebastian-dahlgren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 29375723, "answer_count": 1, "score": -2, "last_activity_date": 1427826545, "creation_date": 1427825757, "question_id": 29375597, "link": "https://stackoverflow.com/questions/29375597/referencing-struct-field-from-another-package", "title": "Referencing struct field from another package", "body": "<p>I have the following folder structure:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 myproject\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 handlers\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 authorize_handler.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 models\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 id_token.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 server.go\n</code></pre>\n\n<p>From <code>authorize_handler.go</code> I try to reference the <code>IdToken.idType</code> field from the <code>id_token.go</code> file.</p>\n\n<p><strong><code>authorize_handler.go</code></strong></p>\n\n<pre><code>package handlers\n\nimport (\n    \"encoding/json\"\n    \"log\"\n    \"net/http\"\n\n    \"myproject/models\"\n)\n\nfunc AuthorizeHandler(rw http.ResponseWriter, req *http.Request) {\n    idToken := new(models.IdToken)\n\n    decoder := json.NewDecoder(req.Body)\n    err := decoder.Decode(&amp;idToken)\n    if err != nil {\n        panic(err)\n    }\n\n    log.Println(idToken.idType)\n}\n</code></pre>\n\n<p><strong><code>id_token.go</code></strong></p>\n\n<pre><code>package models\n\ntype IdToken struct {\n    id     string `json:\"id\" type:\"string\" required:\"true\" max_length:\"50\"`\n    idType string `json:\"idType\" type:\"idType\" required:\"false\"`\n}\n</code></pre>\n\n<p>When I start <code>server.go</code> using <code>go run server.go</code> I get the following error:</p>\n\n<pre><code>handlers/authorize_handler.go:29: idToken.idType undefined (cannot refer to unexported field or method idType)\n</code></pre>\n\n<p>Moving the <code>IdToken</code> to the <code>authorize_handler.go</code> does solve the problem. Changing <code>idType</code> to <code>IdType</code> does not.</p>\n\n<p>Any ideas or pointers to share?</p>\n"}, {"tags": ["bash", "colors", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1427824806, "post_id": 29375241, "comment_id": 46931071, "body": "<code>$ man grep</code> and search for color."}, {"owner": {"reputation": 823, "user_id": 894420, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/PHEan.jpg?s=128&g=1", "display_name": "Ian Walter", "link": "https://stackoverflow.com/users/894420/ian-walter"}, "edited": false, "score": 0, "creation_date": 1550771455, "post_id": 29375241, "comment_id": 96403247, "body": "I wish someone posted an answer specific to Go and not specific to grep for this."}], "answers": [{"comments": [{"owner": {"reputation": 3378, "user_id": 841810, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8900e9cbb7b1900a89c70010c11b8075?s=128&d=identicon&r=PG", "display_name": "Behram Mistree", "link": "https://stackoverflow.com/users/841810/behram-mistree"}, "edited": false, "score": 0, "creation_date": 1427837277, "post_id": 29375330, "comment_id": 46937847, "body": "Just to quickly expand on this response.  Looking through the grep source code, it appears that the way that grep detects whether it sends output to a terminal or not is to check the TERM environment variable.  (See <a href=\"https://www.gnu.org/software/gettext/manual/html_node/The-TERM-variable.html\" rel=\"nofollow noreferrer\">gnu.org/software/gettext/manual/html_node/&hellip;</a>)  Presumably, exec-ing with this environment variable set would also fix the problem.  (Although, I have not yet explicitly checked.)"}, {"owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "reply_to_user": {"reputation": 3378, "user_id": 841810, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8900e9cbb7b1900a89c70010c11b8075?s=128&d=identicon&r=PG", "display_name": "Behram Mistree", "link": "https://stackoverflow.com/users/841810/behram-mistree"}, "edited": false, "score": 0, "creation_date": 1427837566, "post_id": 29375330, "comment_id": 46937963, "body": "I would assume it also checks with <code>isatty</code> or similar calls but possibly not."}, {"owner": {"reputation": 3378, "user_id": 841810, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8900e9cbb7b1900a89c70010c11b8075?s=128&d=identicon&r=PG", "display_name": "Behram Mistree", "link": "https://stackoverflow.com/users/841810/behram-mistree"}, "edited": false, "score": 0, "creation_date": 1427923757, "post_id": 29375330, "comment_id": 46978037, "body": "Thanks for pointing that out, Etan.  I checked the source: it does use <code>isatty</code> as well.  Further, it requires <code>isatty</code> to return true (for stdout) <i>and</i> the TERM environment variable to be set (and not equal to &quot;dumb.&quot;)  As a result, I don&#39;t think my solution above of just passing an additional TERM env variable through to exec would work: the isatty condition might still return false."}], "tags": [], "owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "is_accepted": true, "score": 6, "last_activity_date": 1427824772, "creation_date": 1427824772, "answer_id": 29375330, "question_id": 29375241, "link": "https://stackoverflow.com/questions/29375241/preserve-color-codes-when-exec-ing/29375330#29375330", "title": "Preserve color codes when exec-ing", "body": "<p><code>grep</code> and most other color-using tools detect whether they are sending output to a terminal or not when they decide whether to use color.</p>\n\n<p>Files and pipes, etc. often don't want the color codes and don't know what to do with them.</p>\n\n<p>You can force <code>grep</code> to output colors anyway with the <code>--color=always</code> flag though.</p>\n"}], "owner": {"reputation": 3378, "user_id": 841810, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8900e9cbb7b1900a89c70010c11b8075?s=128&d=identicon&r=PG", "display_name": "Behram Mistree", "link": "https://stackoverflow.com/users/841810/behram-mistree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 746, "favorite_count": 1, "accepted_answer_id": 29375330, "answer_count": 1, "score": 1, "last_activity_date": 1427824772, "creation_date": 1427824469, "last_edit_date": 1495542134, "question_id": 29375241, "link": "https://stackoverflow.com/questions/29375241/preserve-color-codes-when-exec-ing", "title": "Preserve color codes when exec-ing", "body": "<p>As part of a larger program, I'm making a call to grep, and outputting its results to standard out:</p>\n\n<pre><code>// execute grep command\ncmd := exec.Command(GREP_BIN_PATH, argArray...)\nstdout, err := cmd.StdoutPipe()\nif err != nil {\n    log.Fatal(err)\n}\nstderr, err := cmd.StderrPipe()\nif err != nil {\n    log.Fatal(err)\n}\n\nerr = cmd.Start()\nif err != nil {\n    log.Fatal(err)\n}\ngo io.Copy(os.Stdout, stdout)\ngo io.Copy(os.Stderr, stderr)\ncmd.Wait()\n</code></pre>\n\n<p>If I make an identical call to grep directly from the terminal, grep outputs multi-color text (eg., highlighting in red any match in its output).  Doing a little research, it seems as though there are special <a href=\"http://en.wikipedia.org/wiki/ANSI_escape_code#Colors\" rel=\"nofollow noreferrer\">ansi color codes</a> that grep/other programs use to change color highlighting.</p>\n\n<p>Where do these colors go when I exec a command from go?  Is there any way that I can exec from within go to preserve ansi color codes and just copy the output from grep to standard out (similar to the post <a href=\"https://stackoverflow.com/questions/7725809/preserve-color-when-executing-child-process-spawn\">here</a>, but for go)?</p>\n\n<p>(I also know that I could manually re-insert color codes.  But that seems painful, and I'd rather just pipe grep's original colors.)</p>\n\n<p>Please let me know if something in the question is unclear/needs clarification.  Thanks!</p>\n"}, {"tags": ["c++", "image", "bitmap", "go"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4734674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873d57d1f3f999098e3ee7f5e5ff176c?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/4734674/gary"}, "edited": false, "score": 0, "creation_date": 1427821228, "post_id": 29374166, "comment_id": 46929062, "body": "That makes sense completely. I keep forgetting one of the main features of go is the ability to make your own interfaces for specific uses."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1427820795, "creation_date": 1427820795, "answer_id": 29374166, "question_id": 29373741, "link": "https://stackoverflow.com/questions/29373741/how-do-i-convert-an-rgb-byte-slice-to-an-image-image-in-go/29374166#29374166", "title": "How do I convert an RGB byte[] slice to an image.Image in go?", "body": "<p>The <a href=\"https://golang.org/pkg/image/#Image\" rel=\"nofollow\"><code>image</code></a> package is based on interfaces. Just define a new type with <a href=\"https://golang.org/pkg/image/#Image\" rel=\"nofollow\">those methods</a>.</p>\n\n<p>Your type's <code>ColorModel</code> would return <a href=\"https://golang.org/pkg/image/color/#Model\" rel=\"nofollow\"><code>color.RGBAModel</code></a>, <code>Bounds</code> - your rectangle's borders, and <code>At</code> - the color at (x, y) that you can compute if you know the image's dimensions.</p>\n"}], "owner": {"reputation": 25, "user_id": 4734674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873d57d1f3f999098e3ee7f5e5ff176c?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/4734674/gary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 816, "favorite_count": 0, "accepted_answer_id": 29374166, "answer_count": 1, "score": 2, "last_activity_date": 1427820795, "creation_date": 1427819527, "question_id": 29373741, "link": "https://stackoverflow.com/questions/29373741/how-do-i-convert-an-rgb-byte-slice-to-an-image-image-in-go", "title": "How do I convert an RGB byte[] slice to an image.Image in go?", "body": "<p>A C++ application running in another process passes in a char[] array of three-byte pixels (red, green, blue) to a go program. I've reconstructed this in go as a byte[] slice using cgo, but I'm unsure how to convert to an image. I can pass the width or height as well, if that is needed (I would imagine it would be).</p>\n\n<p>I'm aware of the <a href=\"https://golang.org/pkg/image/#RGBA\" rel=\"nofollow\">image.RGBA</a> type, but the documentation seems to imply that those aren't just single-byte-per-color, and that assumes that there is an alpha channel, which my very simplistic bitmap does not have. Would converting the 3 byte values I have into something that works with image.RGBA be a solution? If so, how should I do that?</p>\n\n<p>Alternatively, I could do the conversion in C/C++ before sending the values into a format that go recognizes (jpeg, gif, png). Either way works for my uses, but I don't know how to approach either.</p>\n"}, {"tags": ["google-app-engine", "go", "google-openid"], "comments": [{"owner": {"reputation": 18507, "user_id": 2213940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEbb2.jpg?s=128&g=1", "display_name": "Zig Mandel", "link": "https://stackoverflow.com/users/2213940/zig-mandel"}, "edited": false, "score": 0, "creation_date": 1427830464, "post_id": 29372846, "comment_id": 46934366, "body": "I was wondering the same. It would be very strange/broken if google&#39;s user service was still using oauth1. Maybe only happens to users that first accessed the appspot back when oauth1 was used? If so it would be interesting to know what happens to those after the deadline. I guess they will be offered to signin again."}, {"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "reply_to_user": {"reputation": 18507, "user_id": 2213940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEbb2.jpg?s=128&g=1", "display_name": "Zig Mandel", "link": "https://stackoverflow.com/users/2213940/zig-mandel"}, "edited": false, "score": 0, "creation_date": 1427898031, "post_id": 29372846, "comment_id": 46963170, "body": "Old users do not see the message when their sign in cookie expires and all they have to do is sign in to their Google account again.  They will get it only if/when they have to re-authorize, which I don&#39;t think they have to do unless they explicitly unauthorize my app.  I have done this with my own account just to test this out."}, {"owner": {"reputation": 18507, "user_id": 2213940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEbb2.jpg?s=128&g=1", "display_name": "Zig Mandel", "link": "https://stackoverflow.com/users/2213940/zig-mandel"}, "edited": false, "score": 1, "creation_date": 1427898606, "post_id": 29372846, "comment_id": 46963586, "body": "Yes but its not possible to test this until it deprecates. Hope a googler steps in here."}, {"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "reply_to_user": {"reputation": 18507, "user_id": 2213940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEbb2.jpg?s=128&g=1", "display_name": "Zig Mandel", "link": "https://stackoverflow.com/users/2213940/zig-mandel"}, "edited": false, "score": 0, "creation_date": 1427899797, "post_id": 29372846, "comment_id": 46964482, "body": "That is my hope!  I am getting a little desperate here, I don&#39;t want to have to redevelop my entire sign in process just in case, but I just might have to if I don&#39;t hear from somebody soon."}, {"owner": {"reputation": 18507, "user_id": 2213940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEbb2.jpg?s=128&g=1", "display_name": "Zig Mandel", "link": "https://stackoverflow.com/users/2213940/zig-mandel"}, "edited": false, "score": 0, "creation_date": 1427913273, "post_id": 29372846, "comment_id": 46972411, "body": "Its impossible that user service is broken like that but it might force users to log-in again and that can break things."}, {"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "reply_to_user": {"reputation": 18507, "user_id": 2213940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEbb2.jpg?s=128&g=1", "display_name": "Zig Mandel", "link": "https://stackoverflow.com/users/2213940/zig-mandel"}, "edited": false, "score": 0, "creation_date": 1427913381, "post_id": 29372846, "comment_id": 46972461, "body": "Impossible?  And why would cause problems if my users had to sign in again?"}, {"owner": {"reputation": 18507, "user_id": 2213940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEbb2.jpg?s=128&g=1", "display_name": "Zig Mandel", "link": "https://stackoverflow.com/users/2213940/zig-mandel"}, "edited": false, "score": 0, "creation_date": 1427913469, "post_id": 29372846, "comment_id": 46972525, "body": "By impossible i mean google would have informed that userservice wont work. It would be a huge issue if it did stop working. None of the docs say anything."}, {"owner": {"reputation": 1240, "user_id": 3906190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53225bcc1f5e7596424667a78708b77?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/3906190/mario"}, "edited": false, "score": 0, "creation_date": 1428419997, "post_id": 29372846, "comment_id": 47149144, "body": "I believe the warning is related to what you do before calling user.Current (LoginFederated is not OAuth 2.0). Please see these links: <a href=\"https://developers.google.com/accounts/docs/OpenID2?_ga=1.153281464.1089820907.1403527918\" rel=\"nofollow noreferrer\">developers.google.com/accounts/docs/&hellip;</a> and <a href=\"https://developers.google.com/accounts/docs/OpenID#openid-connect\" rel=\"nofollow noreferrer\">developers.google.com/accounts/docs/OpenID#openid-connect</a>"}, {"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "edited": false, "score": 0, "creation_date": 1428428378, "post_id": 29372846, "comment_id": 47154136, "body": "I had found those links before I posted my question.  What I am not clear about is: does the User service use old OAuth?  And if so, will it stop working on the 20th, or will Google update their code in time?  Since their are no warnings on the User service documentation, that would lead me to think that I&#39;m ok... it&#39;s just a little scary not knowing for sure."}, {"owner": {"reputation": 1240, "user_id": 3906190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53225bcc1f5e7596424667a78708b77?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/3906190/mario"}, "edited": false, "score": 0, "creation_date": 1428555654, "post_id": 29372846, "comment_id": 47213883, "body": "The call user.LoginURLFederated is definitely OpenID. So yes, the way you&#39;re using Users is affected by the deprecation and you could expect it to stop working. If you migrate to OAuth 2.0 authentication with Users, your users won&#39;t receive the warnings and you&#39;ll be safe about the deprecation deadline."}, {"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "reply_to_user": {"reputation": 1240, "user_id": 3906190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53225bcc1f5e7596424667a78708b77?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/3906190/mario"}, "edited": false, "score": 0, "creation_date": 1429194040, "post_id": 29372846, "comment_id": 47492549, "body": "@Mario, since the only thing I&#39;m really trying to access is the user.Email, is there really any difference between me using user.LoginURLFederated() vs user.LoginURL()?"}, {"owner": {"reputation": 1240, "user_id": 3906190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53225bcc1f5e7596424667a78708b77?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/3906190/mario"}, "edited": false, "score": 0, "creation_date": 1429685480, "post_id": 29372846, "comment_id": 47708659, "body": "I was away for a few days but as Glenn answered, yes, there is a difference and indeed is the point of conflict of your code."}], "answers": [{"tags": [], "owner": {"reputation": 279, "user_id": 2700937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oK9nr.jpg?s=128&g=1", "display_name": "Glenn Lewis", "link": "https://stackoverflow.com/users/2700937/glenn-lewis"}, "is_accepted": false, "score": 6, "last_activity_date": 1429570553, "last_edit_date": 1429570553, "creation_date": 1429312206, "answer_id": 29710884, "question_id": 29372846, "link": "https://stackoverflow.com/questions/29372846/will-the-login-functionality-built-into-the-users-api-stop-working-on-april-20th/29710884#29710884", "title": "Will the login functionality built into the Users API stop working on April 20th?", "body": "<p>Please read this information:\n    <a href=\"https://developers.google.com/identity/protocols/OpenID2Migration\">https://developers.google.com/identity/protocols/OpenID2Migration</a>\n    <a href=\"https://developers.google.com/identity/protocols/OpenIDConnect\">https://developers.google.com/identity/protocols/OpenIDConnect</a>\n    <a href=\"https://developers.google.com/identity/sign-in/auth-migration\">https://developers.google.com/identity/sign-in/auth-migration</a> </p>\n\n<p>You may also find this <a href=\"https://groups.google.com/forum/#!topic/google-appengine-go/s_lv0tJCAyE\">forum post</a> helpful.</p>\n\n<p>Apps that use <code>user.LoginURLFederated</code> in conjunction with Google Accounts will stop working.  These apps need to follow the information in the first link above to migrate.</p>\n\n<p>Apps can continue to use <code>user.LoginURLFederated</code> for use with various other third-party OpenID2 service providers.</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1430266693, "post_id": 29930759, "comment_id": 47986629, "body": "You say &quot;no&quot;, but to what? It sounds like your answer to your original question is actually &quot;yes, it will (did) stop working&quot;."}], "tags": [], "owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "is_accepted": true, "score": 2, "last_activity_date": 1430318344, "last_edit_date": 1495539837, "creation_date": 1430258576, "answer_id": 29930759, "question_id": 29372846, "link": "https://stackoverflow.com/questions/29372846/will-the-login-functionality-built-into-the-users-api-stop-working-on-april-20th/29930759#29930759", "title": "Will the login functionality built into the Users API stop working on April 20th?", "body": "<p>So, it turns out that the answer is \"YES!\".  Definitely stopped working.  The older development versions of my website now take you to an error page when you try to sign in.  Luckily I had moved away from the User package before the deadline to the <a href=\"https://stackoverflow.com/questions/29783824/what-is-actually-the-preferred-javascript-method-to-let-my-users-sign-in-with-go\">much</a> <a href=\"https://stackoverflow.com/questions/29755539/error-when-loading-google-oauth2-javascript-api-while-logged-into-multiple-googl\">buggier</a> <a href=\"https://developers.google.com/identity/sign-in/web/sign-in\" rel=\"nofollow noreferrer\">Google Sign-In for Websites</a>.</p>\n"}], "owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 29930759, "answer_count": 2, "score": 7, "last_activity_date": 1430318344, "creation_date": 1427816869, "last_edit_date": 1429652273, "question_id": 29372846, "link": "https://stackoverflow.com/questions/29372846/will-the-login-functionality-built-into-the-users-api-stop-working-on-april-20th", "title": "Will the login functionality built into the Users API stop working on April 20th?", "body": "<p>I am currently using the Users API (<a href=\"https://cloud.google.com/appengine/docs/go/users/\">this one here</a>) with the Go language on my Google App Engine application.  My users are getting the warning message when they first grant permissions that says \"OpenID 2.0 for Google accounts is going away. Developers should migrate to OpenID Connect by April 20, 2015.\"  But I can't find any warnings in the documentation for the Users API anywhere saying that anything will stop working, like I do all throughout other sections regarding OpenID 2.0 (<a href=\"https://developers.google.com/accounts/docs/OpenID2\">here</a>).</p>\n\n<p>I am using very little of the Users API code, just to create the login urls like this:</p>\n\n<pre><code>url, _ := user.LoginURLFederated(c, return_url, \"www.google.com/accounts/o8/id\")\n</code></pre>\n\n<p>And to read the users' email addresses, like this:</p>\n\n<pre><code>u := user.Current(appengine.NewContext(r))\nemail := u.Email\n</code></pre>\n\n<p>Do I need to worry about migrating, or will the Users API handle everything without failing after April 20th?</p>\n"}, {"tags": ["xml", "xpath", "go"], "comments": [{"owner": {"reputation": 5755, "user_id": 561269, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a4106076069fb946b298640fb65f4452?s=128&d=identicon&r=PG&f=1", "display_name": "web-nomad", "link": "https://stackoverflow.com/users/561269/web-nomad"}, "edited": false, "score": 0, "creation_date": 1427815556, "post_id": 29371661, "comment_id": 46925412, "body": "This might help. <a href=\"http://blog.labix.org/2013/06/07/efficient-xpath-for-go\" rel=\"nofollow noreferrer\">blog.labix.org/2013/06/07/efficient-xpath-for-go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 1311495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1232.jpg?s=128&g=1", "display_name": "Igor Sova", "link": "https://stackoverflow.com/users/1311495/igor-sova"}, "edited": false, "score": 0, "creation_date": 1427814975, "post_id": 29371960, "comment_id": 46924997, "body": "Possibly you don&#39;t understand me properly. I try to find golang implementation of php feature. But anyway thanks for answer!"}], "tags": [], "owner": {"reputation": 89, "user_id": 3480709, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/237ea618eaa456b8b89053885165088f?s=128&d=identicon&r=PG&f=1", "display_name": "MeTa", "link": "https://stackoverflow.com/users/3480709/meta"}, "is_accepted": false, "score": -3, "last_activity_date": 1427814424, "creation_date": 1427814424, "answer_id": 29371960, "question_id": 29371661, "link": "https://stackoverflow.com/questions/29371661/collect-all-xml-structs-with-given-name-in-golang/29371960#29371960", "title": "Collect all xml structs with given name in golang", "body": "<p>Try this</p>\n\n<pre><code>$extractvar = new DOMDocument();\n$extractvar -&gt;load(\"yourfile\");\n\n$itemextract= $extractvar -&gt;getElementsByTagName(\"faceContainerRefs\");\n\nforeach( $itemextract as $value )\n{\n$var1= $value-&gt;getElementsByTagName(\"faceContainerRef \");\n$var= $var1-&gt;item(0)-&gt;nodeValue;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1190, "user_id": 3102362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aad3a1fd058c92ec2b01d930bbbb1d0?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3102362/daniel"}, "edited": false, "score": 0, "creation_date": 1494892958, "post_id": 43988299, "comment_id": 75010005, "body": "You might want to add some context to your answer!"}], "tags": [], "owner": {"reputation": 1, "user_id": 8016269, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/882ebd0f4ecde392a4fdc6524070cb52?s=128&d=identicon&r=PG", "display_name": "anonymous", "link": "https://stackoverflow.com/users/8016269/anonymous"}, "is_accepted": false, "score": -1, "last_activity_date": 1494880192, "creation_date": 1494880192, "answer_id": 43988299, "question_id": 29371661, "link": "https://stackoverflow.com/questions/29371661/collect-all-xml-structs-with-given-name-in-golang/43988299#43988299", "title": "Collect all xml structs with given name in golang", "body": "<pre><code>////store all xml data in var response\ntype XMLQuery struct {\nLoc string `xml:\",chardata\"`\n}\nvar l XMLQuery\ndecoder := xml.NewDecoder(strings.NewReader(string(response))) //store \nall xml data in var response\nfor {\n\ntoken, _ := decoder.Token()\n\nif token == nil {\n  break\n}\n\nswitch Element := token.(type) {\ncase xml.StartElement:\n  if Element.Name.Local == \"processRef\" {\n    fmt.Println(\"Element name is : \", Element.Name.Local)\n\n    err := decoder.DecodeElement(&amp;l, &amp;Element)\n    if err != nil {\n      fmt.Println(err)\n    }\n\n    attrVal :=l.Loc\n    fmt.Println(\"Title: \", attrVal)\n\n}}}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 1311495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1232.jpg?s=128&g=1", "display_name": "Igor Sova", "link": "https://stackoverflow.com/users/1311495/igor-sova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1494880192, "creation_date": 1427813596, "last_edit_date": 1427815649, "question_id": 29371661, "link": "https://stackoverflow.com/questions/29371661/collect-all-xml-structs-with-given-name-in-golang", "title": "Collect all xml structs with given name in golang", "body": "<p>Have a problem porting php script to golang.</p>\n\n<p>Is there any method in golang similar to php's:</p>\n\n<p><code>$processRefList = $faceContainer-&gt;getElementsByTagName('processRef');</code></p>\n\n<p>There is an xml file with a huge number of nested elements named <code>processRef</code>.</p>\n\n<p>So I need to collect all this elements without dealing with tree of nested structures.</p>\n\n<p>Here an example part of xml:</p>\n\n<pre><code>&lt;face&gt;\n&lt;processes&gt;\n    &lt;process group=\"1\" type=\"regular\"/&gt;\n    &lt;process group=\"2\" type=\"spotUV\" state=\"off\"/&gt;\n&lt;/processes&gt;\n&lt;assets&gt;...&lt;/assets&gt;\n&lt;groups&gt;\n    &lt;group id=\"1\"&gt;\n        &lt;assetRefs&gt;\n            &lt;imageRef ref=\"1\" x=\"0\" y=\"0\" id=\"8\"&gt;\n                &lt;processRefs&gt;\n                    &lt;!-- This applies spotUV to this asset and removes the regular process. --&gt;\n                    &lt;processRef ref=\"1\" state=\"off\"/&gt;\n                    &lt;processRef ref=\"2\" state=\"on\"/&gt;\n                &lt;/processRefs&gt;\n            &lt;/imageRef&gt;\n            &lt;textRef ref=\"1\" x=\"161\" y=\"41\" id=\"7\"/&gt;\n            &lt;textRef ref=\"2\" x=\"160\" y=\"55\" id=\"6\"&gt;\n                &lt;processRefs&gt;\n                    &lt;!-- This applies spotUV to this asset and also leaves regular process applied. --&gt;\n                    &lt;processRef ref=\"2\" state=\"on\"/&gt;\n                &lt;/processRefs&gt;\n            &lt;/textRef&gt;\n        &lt;/assetRefs&gt;\n    &lt;/group&gt;\n    &lt;group id=\"2\"&gt;...&lt;/group&gt;\n&lt;/groups&gt;\n</code></pre>\n\n<p></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 3, "creation_date": 1427814056, "post_id": 29371278, "comment_id": 46924357, "body": "Did you mean to also iterate over <code>val.items</code>?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1427814271, "post_id": 29371278, "comment_id": 46924537, "body": "You code fragment doesn&#39;t compile. <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a>"}, {"owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1427814991, "post_id": 29371278, "comment_id": 46925005, "body": "@peterSO apologies, updated."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1427815390, "post_id": 29371278, "comment_id": 46925280, "body": "@EwanValentine: Why <code>main.go:21: cannot use KeyValue literal (type KeyValue) as type Params in array element</code> and <code>main.go:22: cannot use KeyValue literal (type KeyValue) as type Params in array element</code>? <a href=\"http://play.golang.org/p/gAaSsBDFGI\" rel=\"nofollow noreferrer\">play.golang.org/p/gAaSsBDFGI</a>"}, {"owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1427817063, "post_id": 29371278, "comment_id": 46926435, "body": "@peterSO that&#39;s what I&#39;m trying to find out"}], "answers": [{"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 2, "last_activity_date": 1427815186, "creation_date": 1427815186, "answer_id": 29372246, "question_id": 29371278, "link": "https://stackoverflow.com/questions/29371278/is-it-possible-to-pass-a-struct-as-a-parameter-in-go/29372246#29372246", "title": "Is it possible to pass a struct as a parameter in Go?", "body": "<p><code>values</code> is a <code>[]Params</code>. When you iterate over it, <code>val</code> will be a <code>Params</code>, but you're treating it as though it was a <code>KeyValue</code>. Did you actually mean to pass an <code>[]Params</code> at all, instead of just a <code>Params</code> or even just a <code>[]KeyValue</code>?</p>\n"}, {"tags": [], "owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "is_accepted": true, "score": 1, "last_activity_date": 1427815761, "last_edit_date": 1427815761, "creation_date": 1427815402, "answer_id": 29372320, "question_id": 29371278, "link": "https://stackoverflow.com/questions/29371278/is-it-possible-to-pass-a-struct-as-a-parameter-in-go/29372320#29372320", "title": "Is it possible to pass a struct as a parameter in Go?", "body": "<p>As others have mentioned, you have an <code>[]Params</code> but you are trying to initialize with <code>KeyValue</code>s.  </p>\n\n<pre><code>data := []Params{\n      KeyValue{ key: \"title\", value: \"Thingy\" },\n      KeyValue{ key: \"body\", value: \"Testing 123\" }}\n</code></pre>\n\n<p>Instead, try:</p>\n\n<pre><code>data := &amp;Params{items: []KeyValue{\n    {key: \"title\", value: \"Thingy\"},\n    {key: \"body\", value: \"Testing 123\"},\n}}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "edited": false, "score": 0, "creation_date": 1427820825, "post_id": 29373555, "comment_id": 46928801, "body": "Maybe you just simplified your code, but as @hobbs points out, you really don&#39;t need the <code>Params</code> struct as all you really care about passing is the <code>[]KeyValue</code>.  You could even ditch the whole <code>Params</code> <code>[]KeyValue</code> as you don&#39;t care about ordering and thus all you&#39;ve really done is create a <code>map[string]string</code>"}], "tags": [], "owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "is_accepted": false, "score": 0, "last_activity_date": 1427927204, "last_edit_date": 1427927204, "creation_date": 1427818992, "answer_id": 29373555, "question_id": 29371278, "link": "https://stackoverflow.com/questions/29371278/is-it-possible-to-pass-a-struct-as-a-parameter-in-go/29373555#29373555", "title": "Is it possible to pass a struct as a parameter in Go?", "body": "<p>Thanks folks, finally got it working with: <a href=\"http://play.golang.org/p/aCKU5bTnhT\" rel=\"nofollow\">http://play.golang.org/p/aCKU5bTnhT</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Params struct {\n    items []KeyValue\n}\n\ntype KeyValue struct {\n    key   string\n    value string\n}\n\nfunc main() {\n    data := Params{items: []KeyValue{\n        {key: \"title\", value: \"Thingy\"},\n        {key: \"body\", value: \"Testing 123\"},\n    }}\n\n    makePost(\"test-api.dev\", data)\n}\n\nfunc makePost(urlString string, values Params) string {\n\n    for _, val := range values.items {\n        fmt.Println(\"%s\", val.key+\":\"+val.value)\n    }\n\n    return string(\"test\")\n}\n</code></pre>\n"}], "owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "accepted_answer_id": 29372320, "answer_count": 3, "score": -1, "last_activity_date": 1427927204, "creation_date": 1427812628, "last_edit_date": 1427814905, "question_id": 29371278, "link": "https://stackoverflow.com/questions/29371278/is-it-possible-to-pass-a-struct-as-a-parameter-in-go", "title": "Is it possible to pass a struct as a parameter in Go?", "body": "<p>I'm trying to pass an array of key, values to another function in Go. Very new to Go so am struggling to figure it out.</p>\n\n<pre><code>package main\n\nimport(\n    \"net/http\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/url\"\n)\n\ntype Params struct {\n    items []KeyValue\n}\n\ntype KeyValue struct {\n    key string\n    value string\n}\n\nfunc main() {\n     data := []Params{\n          KeyValue{ key: \"title\", value: \"Thingy\" },\n          KeyValue{ key: \"body\", value: \"Testing 123\" }}\n\n     response, error := makePost(\"test-api.dev\", &amp;data)\n}\n\nfunc makePost(urlString string, values []Params) (string, error) {\n\n     v := url.Values{}\n\n    for _, val := range values {\n        v.Add(val.key, val.value)\n    }\n\n    response, err := http.PostForm(urlString, v)\n\n    defer response.Body.Close()\n\n    contents, err :=  ioutil.ReadAll(response.Body)\n\n    if err != nil {\n        fmt.Printf(\"%s\", err)\n    }\n\n    return string(contents), err\n}\n</code></pre>\n\n<p>I get errors:</p>\n\n<pre><code>val.key undefined (type Params has no field or method key)\nval.value undefined (type Params has no field or method key)\n</code></pre>\n\n<p>When I compile however. </p>\n\n<p>Go playground link <a href=\"http://play.golang.org/p/CQw03wZmAV\" rel=\"nofollow\">http://play.golang.org/p/CQw03wZmAV</a></p>\n\n<p>Thanks in advance! </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1427835763, "post_id": 29367129, "comment_id": 46937123, "body": "Looks like a problem with cgo. I don&#39;t know if it&#39;s OK at all to exec from within a qml context. I would bring this up with go-qml."}, {"owner": {"reputation": 43, "user_id": 2707413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe1ee9bd374d2a0eb0265298d8a9e05d?s=128&d=identicon&r=PG", "display_name": "yuntan_t", "link": "https://stackoverflow.com/users/2707413/yuntan-t"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1427987494, "post_id": 29367129, "comment_id": 47004900, "body": "@JimB Umm... I comment out <code>qml.Run()</code> and program runs without any error..."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1427989426, "post_id": 29367129, "comment_id": 47006160, "body": "yes. Like I said, it looks like a cgo problem, and it could be a bug. No on will no better than the go-qml developers. Try to make a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}], "owner": {"reputation": 43, "user_id": 2707413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe1ee9bd374d2a0eb0265298d8a9e05d?s=128&d=identicon&r=PG", "display_name": "yuntan_t", "link": "https://stackoverflow.com/users/2707413/yuntan-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1428132681, "creation_date": 1427799792, "last_edit_date": 1486566105, "question_id": 29367129, "link": "https://stackoverflow.com/questions/29367129/trace-trap-error-in-golang-when-execute-command-by-cmd-run", "title": "trace trap error in Golang when execute command by Cmd.Run", "body": "<p>My program use <code>os/exec.Cmd</code> to play mp3 sound with libsox (<a href=\"https://github.com/OUCC/prism/blob/d0b96fe82c1aefb183a0435404e92acd083b6247/kiosk/main.go#L100\" rel=\"nofollow noreferrer\">https://github.com/OUCC/prism/blob/d0b96fe82c1aefb183a0435404e92acd083b6247/kiosk/main.go#L100</a>). But after the sound is played (command is executed), I got following error and program exited.</p>\n\n<pre><code>trace trap (core dumped)  kiosk\n</code></pre>\n\n<p>Same problem is happen when I replaced the command with \"ls\". It's not important which command is executed.</p>\n\n<p>I used debugger to know what's wrong and I got this stack trace:</p>\n\n<p><img src=\"https://i.gyazo.com/e22c4fb957e0c7676926d51612347822.png\" /></p>\n\n<p>I tried to make simple program that cause same program but I failed to do this... Please give me some advice.</p>\n\n<p>go1.4 linux/amd64</p>\n\n<p><strong>update</strong><br>\nminimal example <a href=\"https://gist.github.com/yuntan/df45e29a00158f0076ef\" rel=\"nofollow noreferrer\">https://gist.github.com/yuntan/df45e29a00158f0076ef</a></p>\n"}, {"tags": ["go", "exe"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1427801080, "post_id": 29366722, "comment_id": 46917164, "body": "You&#39;re just writing a HTTP proxy. Ask yourself if you can write a better (faster, more functional, more secure) HTTP proxy than nginx or HAProxy."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1427811906, "post_id": 29366722, "comment_id": 46922783, "body": "This sounds like the old <a href=\"http://en.wikipedia.org/wiki/Common_Gateway_Interface\" rel=\"nofollow noreferrer\">CGI</a> or even <a href=\"http://en.wikipedia.org/wiki/FastCGI\" rel=\"nofollow noreferrer\">FastCGI</a> model."}, {"owner": {"reputation": 41, "user_id": 4733490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ab88e52f3825db8dd5bd18f9cef2bd?s=128&d=identicon&r=PG&f=1", "display_name": "rorstack", "link": "https://stackoverflow.com/users/4733490/rorstack"}, "reply_to_user": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1427878283, "post_id": 29366722, "comment_id": 46951183, "body": "Thanks lads.  See my comments below regarding a proxy. @maerics FastCGI looks like it might be a solution. Compiled Go might negate some of the downsides from back in the day with lower overheads."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4733490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ab88e52f3825db8dd5bd18f9cef2bd?s=128&d=identicon&r=PG&f=1", "display_name": "rorstack", "link": "https://stackoverflow.com/users/4733490/rorstack"}, "edited": false, "score": 0, "creation_date": 1427878328, "post_id": 29368204, "comment_id": 46951207, "body": "Thanks for the informative answer icza.  Go does allow access to low level TCP functionality but I&#39;m hoping I will not need to delve that deep if there is another solution out there.  Am I right in thinking that the proxy option would involve my destination apps listening on ports? A HTTP redirect would certainly involve every app implementing a web listener.  @maerics mentioned FastCGI above. This seems to offer the functionality I need. My apps can receive input via TCP connection, Unix socket or the standard input. There is a Go package, fcgi, which implements the FastCGI protocol."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 41, "user_id": 4733490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ab88e52f3825db8dd5bd18f9cef2bd?s=128&d=identicon&r=PG&f=1", "display_name": "rorstack", "link": "https://stackoverflow.com/users/4733490/rorstack"}, "edited": false, "score": 0, "creation_date": 1427880499, "post_id": 29368204, "comment_id": 46952489, "body": "@rorstack Yes, using a proxy the applications would have to listen. But any solution you choose, the applications must listen or poll something in order to get notified of an incoming request."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1427815091, "last_edit_date": 1427815091, "creation_date": 1427803377, "answer_id": 29368204, "question_id": 29366722, "link": "https://stackoverflow.com/questions/29366722/how-do-i-pass-the-response-writer-and-http-request-to-an-executable-in-go/29368204#29368204", "title": "How do I pass the response writer and http request to an executable in Go?", "body": "<p>Memory areas of running applications are isolated: a process cannot just read or write another application's memory (<a href=\"http://en.wikipedia.org/wiki/Process_isolation\" rel=\"nofollow\">Wikipedia: Process isolation</a>).</p>\n\n<p>So just passing the response writer and the http request is not so easy. And even if you would implement it (e.g. serializing them into binary or text data, sending/passing them over somehow, and reconstructing them on the other side) serving an HTTP request in the background is more than just interacting with the <a href=\"http://golang.org/pkg/net/http/#ResponseWriter\" rel=\"nofollow\"><code>ResponseWriter</code></a> and <a href=\"http://golang.org/pkg/net/http/#Request\" rel=\"nofollow\"><code>Request</code></a> objects: it involves reading from and writing to the underlying TCP connection... so you would also have to \"pass\" the TCP connection or create a bridge between the real HTTP client and the application you forward to.</p>\n\n<p>Another option would be to send a redirect back to the client (<a href=\"http://en.wikipedia.org/wiki/List_of_HTTP_status_codes#3xx_Redirection\" rel=\"nofollow\">HTTP <code>3xx</code> status codes</a>) after doing the authentication and routing logic. With this solution you could have authentication and certain routing logic implemented in your app, but you would lose further routing possibilities because further request would go directly to the designated host.</p>\n\n<p>Essentially what you try to create is the functionality of a <a href=\"http://en.wikipedia.org/wiki/Proxy_server\" rel=\"nofollow\">proxy server</a> which have plenty of implementations out there. Given the complexity of a good proxy server, it should not be feasible to reproduce one.</p>\n\n<p>I suggest to either utilize an existing proxy server or \"refactor\" your architecture to avoid this kind of segmentation.</p>\n"}], "owner": {"reputation": 41, "user_id": 4733490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ab88e52f3825db8dd5bd18f9cef2bd?s=128&d=identicon&r=PG&f=1", "display_name": "rorstack", "link": "https://stackoverflow.com/users/4733490/rorstack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1427815091, "creation_date": 1427798510, "question_id": 29366722, "link": "https://stackoverflow.com/questions/29366722/how-do-i-pass-the-response-writer-and-http-request-to-an-executable-in-go", "title": "How do I pass the response writer and http request to an executable in Go?", "body": "<p>I want to run a simple webserver in Go doing some basic authorisation and routing to multiple apps.</p>\n\n<p>Is it possible to have the webserver running as a standalone executable and pass the response writer and http request to other executables?</p>\n\n<p>The idea is that the app binaries can hopefully be compiled and deployed independently of the webserver.</p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 2, "last_activity_date": 1427818681, "last_edit_date": 1427818681, "creation_date": 1427814018, "answer_id": 29371822, "question_id": 29366038, "link": "https://stackoverflow.com/questions/29366038/looping-iterate-over-the-second-level-nested-json-in-go-lang/29371822#29371822", "title": "Looping/iterate over the second level nested JSON in go lang", "body": "<p>You'll need to parse the JSON and then recurse through the structure inspecting the types of the contained values and handling them in some way.</p>\n\n<p>The example function below takes an <code>*interface{}</code> (pointer to any type) and a handler function of string, int, and object pointers to which it yields the items it discovers:</p>\n\n<pre><code>func eachJsonValue(obj *interface{}, handler func(*string, *int, *interface{})) {\n  if obj == nil {\n    return\n  }\n  // Yield all key/value pairs for objects.\n  o, isObject := (*obj).(map[string]interface{})\n  if isObject {\n    for k, v := range o {\n      handler(&amp;k, nil, &amp;v)\n      eachJsonValue(&amp;v, handler)\n    }\n  }\n  // Yield each index/value for arrays.\n  a, isArray := (*obj).([]interface{})\n  if isArray {\n    for i, x := range a {\n      handler(nil, &amp;i, &amp;x)\n      eachJsonValue(&amp;x, handler)\n    }\n  }\n  // Do nothing for primitives since the handler got them.\n}\n</code></pre>\n\n<p>Calling it as demonstrated below will print the listed results.  Your handler function could, of course, do something special with known key/values such as \"fld1\":</p>\n\n<pre><code>func main() {\n  // Parse the JSON.\n  var obj interface{}\n  json.Unmarshal([]byte(input), &amp;obj) // XXX: check the error value.\n\n  // Handle object key/value pairs and array index/items.\n  eachJsonValue(&amp;obj, func(key *string, index *int, value *interface{}) {\n    if key != nil { // It's an object key/value pair...\n      fmt.Printf(\"OBJ: key=%q, value=%#v\\n\", *key, *value)\n    } else { // It's an array item...\n      fmt.Printf(\"ARR: index=%d, value=%#v\\n\", *index, *value)\n    }\n  })\n}\n\n// OBJ: key=\"outterJSON\", value=map[string]interface {}{...}\n// OBJ: key=\"innerJSON1\", value=map[string]interface {}{...}\n// OBJ: key=\"value1\", value=10\n// OBJ: key=\"value2\", value=22\n// OBJ: key=\"InnerInnerArray\", value=[]interface {}{...}\n// ARR: index=0, value=\"test1\"\n// ARR: index=1, value=\"test2\"\n// OBJ: key=\"InnerInnerJSONArray\", value=[]interface {}{...}\n// ARR: index=0, value=map[string]interface {}{...}\n// OBJ: key=\"fld1\", value=\"val1\"\n// ARR: index=1, value=map[string]interface {}{...}\n// OBJ: key=\"fld2\", value=\"val2\"\n// OBJ: key=\"InnerJSON2\", value=\"NoneValue\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 2327470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77475e78a4733d1783c34e6087e3788f?s=128&d=identicon&r=PG", "display_name": "Gani VastHad", "link": "https://stackoverflow.com/users/2327470/gani-vasthad"}, "edited": false, "score": 0, "creation_date": 1568385052, "post_id": 29382205, "comment_id": 102268664, "body": "good find!, in general <code>input</code> could be an array.. you can improve it.. Thanks!"}], "tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": true, "score": 23, "last_activity_date": 1447273911, "last_edit_date": 1447273911, "creation_date": 1427857604, "answer_id": 29382205, "question_id": 29366038, "link": "https://stackoverflow.com/questions/29366038/looping-iterate-over-the-second-level-nested-json-in-go-lang/29382205#29382205", "title": "Looping/iterate over the second level nested JSON in go lang", "body": "<p>See <a href=\"https://blog.golang.org/json-and-go\" rel=\"noreferrer\">this</a> blog entry which thoroughly covers this subject, specifically the section <strong>Decoding arbitrary data</strong>. Using that you can do something like this:\n(<a href=\"https://play.golang.org/p/5s8tVL7BgM\" rel=\"noreferrer\">playground example</a>)</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"    \n)\n\nfunc main() {\n    // Creating the maps for JSON\n    m := map[string]interface{}{}\n\n    // Parsing/Unmarshalling JSON encoding/json\n    err := json.Unmarshal([]byte(input), &amp;m)\n\n    if err != nil {\n        panic(err)\n    }\n    parseMap(m)\n}\n\nfunc parseMap(aMap map[string]interface{}) {\n    for key, val := range aMap {\n        switch concreteVal := val.(type) {\n        case map[string]interface{}:\n            fmt.Println(key)\n            parseMap(val.(map[string]interface{}))\n        case []interface{}:\n            fmt.Println(key)\n            parseArray(val.([]interface{}))\n        default:\n            fmt.Println(key, \":\", concreteVal)\n        }\n    }\n}\n\nfunc parseArray(anArray []interface{}) {\n    for i, val := range anArray {\n        switch concreteVal := val.(type) {\n        case map[string]interface{}:\n            fmt.Println(\"Index:\", i)\n            parseMap(val.(map[string]interface{}))\n        case []interface{}:\n            fmt.Println(\"Index:\", i)\n            parseArray(val.([]interface{}))\n        default:\n            fmt.Println(\"Index\", i, \":\", concreteVal)\n\n        }\n    }\n}\n\nconst input = `\n{\n    \"outterJSON\": {\n        \"innerJSON1\": {\n            \"value1\": 10,\n            \"value2\": 22,\n            \"InnerInnerArray\": [ \"test1\" , \"test2\"],\n            \"InnerInnerJSONArray\": [{\"fld1\" : \"val1\"} , {\"fld2\" : \"val2\"}]\n        },\n        \"InnerJSON2\":\"NoneValue\"\n    }\n}\n`\n</code></pre>\n\n<p>This will print:</p>\n\n<pre><code>    //outterJSON\n    //innerJSON1\n    //InnerInnerJSONArray\n    //Index: 0\n    //fld1 : val1\n    //Index: 1\n    //fld2 : val2\n    //value1 : 10\n    //value2 : 22\n    //InnerInnerArray\n    //Index 0 : test1\n    //Index 1 : test2\n    //InnerJSON2 : NoneValue\n</code></pre>\n\n<p>The key thing is that you have to use type assertion when working with interface types. The type switch makes it easy to determine the type as needed. The code will recursively range through any nested array or map so you can add as many levels as you wish and get all your values.</p>\n"}, {"tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 3, "last_activity_date": 1427968528, "last_edit_date": 1495540003, "creation_date": 1427968528, "answer_id": 29410031, "question_id": 29366038, "link": "https://stackoverflow.com/questions/29366038/looping-iterate-over-the-second-level-nested-json-in-go-lang/29410031#29410031", "title": "Looping/iterate over the second level nested JSON in go lang", "body": "<p>There are related questions <a href=\"https://stackoverflow.com/questions/23063517/golang-parsing-nested-json\">here</a> and <a href=\"https://stackoverflow.com/questions/29298645/how-to-do-deep-sets-and-gets-in-gos-mapstringinterface\">here</a> (and possibly others).</p>\n\n<p>There are some more sophisticated JSON parsing APIs that make your job easier. An example is <a href=\"https://godoc.org/github.com/stretchr/objx\" rel=\"nofollow noreferrer\">stretchr/objx</a>.</p>\n\n<p>An example of using objx:</p>\n\n<pre><code>document, err := objx.FromJSON(json)\n// TODO handle err\ndocument.Get(\"path.to.field[0].you.want\").Str()\n</code></pre>\n\n<p>This works when you really don't know what the JSON structure will be. However, if you do know the structure of your JSON input ahead of time, the preferred way is to describe it with structs and use the standard API for marshalling.</p>\n"}, {"tags": [], "owner": {"reputation": 106, "user_id": 1375156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcf5f488ce58296bab3efbdccbd1bb01?s=128&d=identicon&r=PG", "display_name": "Sandeep", "link": "https://stackoverflow.com/users/1375156/sandeep"}, "is_accepted": false, "score": 0, "last_activity_date": 1590753422, "creation_date": 1590753422, "answer_id": 62085415, "question_id": 29366038, "link": "https://stackoverflow.com/questions/29366038/looping-iterate-over-the-second-level-nested-json-in-go-lang/62085415#62085415", "title": "Looping/iterate over the second level nested JSON in go lang", "body": "<p>I have implemented something very similar to <a href=\"https://stackoverflow.com/users/1078890/iamnan\">https://stackoverflow.com/users/1078890/iamnan</a> solution. The body of <code>parseMap</code> and <code>parseArray</code> is combined into one and it looks something like this.</p>\n\n<pre><code>func printJson(res1 map[string]interface{}, res2 []interface{}) {\n    for k, v := range res1 {\n        switch vv := v.(type) {\n        case float64, int, string:\n            fmt.Println(k, \":\", vv)\n        case []interface{}:\n            fmt.Println(k, \":\")\n            printJson(nil, vv)\n        case map[string]interface{}:\n            fmt.Println(k, \":\")\n            printJson(vv, nil)\n        default:\n            fmt.Println(k, \":\", vv)\n        }\n    }\n    for k, v := range res2 {\n        switch vv := v.(type) {\n        case float64, int, string:\n            fmt.Println(k, \":\", vv)\n        case []interface{}:\n            fmt.Println(k, \":\")\n            printJson(nil, vv)\n        case map[string]interface{}:\n            fmt.Println(k, \":\")\n            printJson(vv, nil)\n        default:\n            fmt.Println(k, \":\", vv)\n        }\n    }\n}\n</code></pre>\n\n<p>Code can be found here <a href=\"https://gist.github.com/sandeep-sarkar/78a0e96461b4dec727386a96404d29b0\" rel=\"nofollow noreferrer\">https://gist.github.com/sandeep-sarkar/78a0e96461b4dec727386a96404d29b0</a></p>\n"}], "owner": {"reputation": 18920, "user_id": 1933917, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7abf55dbb13da076d7a75637f22a74db?s=128&d=identicon&r=PG", "display_name": "Amol M Kulkarni", "link": "https://stackoverflow.com/users/1933917/amol-m-kulkarni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15331, "favorite_count": 6, "accepted_answer_id": 29382205, "answer_count": 4, "score": 9, "last_activity_date": 1590753422, "creation_date": 1427796656, "last_edit_date": 1427798198, "question_id": 29366038, "link": "https://stackoverflow.com/questions/29366038/looping-iterate-over-the-second-level-nested-json-in-go-lang", "title": "Looping/iterate over the second level nested JSON in go lang", "body": "<p>Consider the following code:</p>\n\n<pre><code>package main\n\nimport (\n\"encoding/json\"\n\"fmt\"\n\"reflect\"\n)\n\n\nfunc main() {  \n    //Creating the maps for JSON\n    m := map[string]interface{}{}\n\n    //Parsing/Unmarshalling JSON encoding/json\n    err := json.Unmarshal([]byte(input), &amp;m)\n\n    fmt.Println(\"\\nReflect type of Parsing/Unmarshalling Error Object:\\n\",reflect.TypeOf(err))\n    fmt.Println(\"\\nParsing/Unmarshalling Error Object:\\n\",err)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(\"\\nParsed JSON is as follows:\\n\",m)\n    fmt.Println(\"\\nReflect type of parsed json object:\\n\", reflect.TypeOf(m))\n\n    for firstLvlkey, firstLvlValue := range m { \n        fmt.Println(\"First Level Key:\", firstLvlkey)\n        fmt.Println(\"First Level Key reflect type of :\", reflect.TypeOf(firstLvlkey))\n\n        fmt.Println(\"First Level Value:\", firstLvlValue)\n        fmt.Println(\"First Level Value reflect type of :\", reflect.TypeOf(firstLvlValue))\n         // &lt;===============================&gt;\n         //Here I want to iterate/loop over innerJSON1, InnerJSON2 then reach to level InnerInnerJSONArray - fld1 and fld2\n         // &lt;===============================&gt;\n\n    }\n}\n\nconst input = `\n{\n    \"outterJSON\":{\n        \"innerJSON1\":{\n            \"value1\":10,\n            \"value2\":22\n            ,\n            \"InnerInnerArray\": [ \"test1\" , \"test2\"],\n            \"InnerInnerJSONArray\": [ {\"fld1\" : \"val1\"} , {\"fld2\" : \"val2\"} ]\n            },\n            \"InnerJSON2\":\"NoneValue\"\n        }\n    }\n    `\n</code></pre>\n\n<p>I have some requirement like I want to read/get all the Key and value in <code>String</code> type for some processing adn I can't define the <code>struct</code> because I will be getting dynamic JSON input (e.g <code>InnerInnerArray</code> as a string then second level loop will give me index of array and process each JSON having key <code>fld1</code> and <code>val1</code>). </p>\n\n<p>I wish to iterate over every key/value pair contained within it, what is the most efficient way of going through the map?</p>\n\n<p>Note: I am Newbie for Go-lang, your suggestion/improvement on question is also most welcome.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 2, "creation_date": 1427795310, "post_id": 29365109, "comment_id": 46914037, "body": "as to 2D syntax: <code>var foo = [2][2]int{{1, 2}, {3, 4}}</code>"}, {"owner": {"reputation": 19, "user_id": 3431262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b69060923b5914cf646ba12483a8444?s=128&d=identicon&r=PG&f=1", "display_name": "user3431262", "link": "https://stackoverflow.com/users/3431262/user3431262"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1427797290, "post_id": 29365109, "comment_id": 46915197, "body": "The preferred answer gives no insight. The next answer indicates a compiler error: it&#39;s an invalid const, but does not indicate the purpose of not allowing array constants, which seems pretty obvious as necessary.  And that&#39;s not the compiler error in any event: it&#39;s an invalid syntax error, not an invalid constant.  And neither answer the question of why the poor compiler syntax, nor why arrays can not be constants.  These are not very satisfying answers, IMO."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 4733550, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/cc58d8b94edc8a0d286cd7e1384834b0?s=128&d=identicon&r=PG", "display_name": "user4733550", "link": "https://stackoverflow.com/users/4733550/user4733550"}, "is_accepted": false, "score": 2, "last_activity_date": 1427798725, "creation_date": 1427798725, "answer_id": 29366786, "question_id": 29365109, "link": "https://stackoverflow.com/questions/29365109/golang-constant-2d-array-syntax-fails/29366786#29366786", "title": "Golang constant 2d array syntax fails", "body": "<p>From the <a href=\"http://golang.org/ref/spec#Constants\" rel=\"nofollow\">specs</a>:</p>\n\n<blockquote>\n  <p>Constants</p>\n  \n  <p>There are boolean constants, rune constants, integer constants, floating-point constants, complex constants, and string constants. </p>\n</blockquote>\n\n<p>IOW, in Go no {struct,array,slice,map,interface,pointer} constants exists.</p>\n"}], "owner": {"reputation": 19, "user_id": 3431262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b69060923b5914cf646ba12483a8444?s=128&d=identicon&r=PG&f=1", "display_name": "user3431262", "link": "https://stackoverflow.com/users/3431262/user3431262"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1318, "favorite_count": 0, "closed_date": 1466682730, "answer_count": 1, "score": -3, "last_activity_date": 1427798725, "creation_date": 1427793972, "last_edit_date": 1427794889, "question_id": 29365109, "link": "https://stackoverflow.com/questions/29365109/golang-constant-2d-array-syntax-fails", "closed_reason": "Duplicate", "title": "Golang constant 2d array syntax fails", "body": "<p>I want to declare a constant golang 2d array (not slices), but I can't figure it out, having looked at the other golang comments on this issue.</p>\n\n<pre><code>type fooT [1][1]float64\nconst BAR fooT = {[1]float64 {.01}}\n</code></pre>\n\n<p>Gives the error <code>fubar.go:5: syntax error: unexpected {</code>.  But the following compiles fine:</p>\n\n<pre><code>type fooT [1][1]float64\nvar BAR = fooT {[1]float64 {.01}}\n</code></pre>\n\n<p>First, I do not understand why I need to redeclare the underlying array redundantly, and it does seem golang compiler knows the type because it gives an error if I change it.  But, why can I not make this array a const?  it is R/O, not a global.</p>\n\n<p>And, the syntax is cumbersome.</p>\n"}, {"tags": ["bash", "go", "environment-variables"], "comments": [{"owner": {"reputation": 14111, "user_id": 217019, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ede807eedb7fe77242664741f91627f7?s=128&d=identicon&r=PG", "display_name": "Mateusz Dymczyk", "link": "https://stackoverflow.com/users/217019/mateusz-dymczyk"}, "edited": false, "score": 2, "creation_date": 1427791188, "post_id": 29364178, "comment_id": 46911597, "body": "is the variable actually set? doesn listing <code>os.Environ</code> show you a <code>PS1=value</code> pair?"}, {"owner": {"reputation": 68230, "user_id": 1426056, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ac815b6fca201737db888a28efd7248?s=128&d=identicon&r=PG", "display_name": "waitingkuo", "link": "https://stackoverflow.com/users/1426056/waitingkuo"}, "reply_to_user": {"reputation": 14111, "user_id": 217019, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ede807eedb7fe77242664741f91627f7?s=128&d=identicon&r=PG", "display_name": "Mateusz Dymczyk", "link": "https://stackoverflow.com/users/217019/mateusz-dymczyk"}, "edited": false, "score": 0, "creation_date": 1427792789, "post_id": 29364178, "comment_id": 46912443, "body": "I can get it by <code>echo $PS1</code>"}, {"owner": {"reputation": 14111, "user_id": 217019, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ede807eedb7fe77242664741f91627f7?s=128&d=identicon&r=PG", "display_name": "Mateusz Dymczyk", "link": "https://stackoverflow.com/users/217019/mateusz-dymczyk"}, "edited": false, "score": 0, "creation_date": 1427792948, "post_id": 29364178, "comment_id": 46912540, "body": "are you starting the process (I mean running that go program) with the same user?"}, {"owner": {"reputation": 68230, "user_id": 1426056, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ac815b6fca201737db888a28efd7248?s=128&d=identicon&r=PG", "display_name": "waitingkuo", "link": "https://stackoverflow.com/users/1426056/waitingkuo"}, "reply_to_user": {"reputation": 14111, "user_id": 217019, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ede807eedb7fe77242664741f91627f7?s=128&d=identicon&r=PG", "display_name": "Mateusz Dymczyk", "link": "https://stackoverflow.com/users/217019/mateusz-dymczyk"}, "edited": false, "score": 0, "creation_date": 1427793267, "post_id": 29364178, "comment_id": 46912736, "body": "Yes. I found that i cannot get PS1 by <code>env | grep PS1</code> but can get it by <code>set | grep PS1</code>. Is there any difference?"}, {"owner": {"reputation": 14111, "user_id": 217019, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ede807eedb7fe77242664741f91627f7?s=128&d=identicon&r=PG", "display_name": "Mateusz Dymczyk", "link": "https://stackoverflow.com/users/217019/mateusz-dymczyk"}, "edited": false, "score": 2, "creation_date": 1427793909, "post_id": 29364178, "comment_id": 46913126, "body": "yes, <code>set</code> sees shell local and environment variables, <code>env</code> sees only environment variables (which are passed to child processes). If you don&#39;t see it in <code>env</code> then your go programme won&#39;t be able to use it, you need to properly export it. You can check SO for more detailed explanation of <code>env</code> vs <code>set</code>."}, {"owner": {"reputation": 68230, "user_id": 1426056, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ac815b6fca201737db888a28efd7248?s=128&d=identicon&r=PG", "display_name": "waitingkuo", "link": "https://stackoverflow.com/users/1426056/waitingkuo"}, "reply_to_user": {"reputation": 14111, "user_id": 217019, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ede807eedb7fe77242664741f91627f7?s=128&d=identicon&r=PG", "display_name": "Mateusz Dymczyk", "link": "https://stackoverflow.com/users/217019/mateusz-dymczyk"}, "edited": false, "score": 0, "creation_date": 1427794636, "post_id": 29364178, "comment_id": 46913593, "body": "Thanks~ Can you reply this to my post then i can approve your answer."}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427814326, "post_id": 29366704, "comment_id": 46924585, "body": "This is sh/bash specific. The csh family of shells (including zsh?) have a different syntax for the former and the portable, shell agnostic, way to do the later is <code>env VAR=val command\u2026</code>"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 6, "last_activity_date": 1427798452, "creation_date": 1427798452, "answer_id": 29366704, "question_id": 29364178, "link": "https://stackoverflow.com/questions/29364178/how-to-get-environment-variable-ps1-by-golang/29366704#29366704", "title": "How to get environment variable PS1 by golang?", "body": "<p>PS1 is probably not exported, meaning it won't show up in sub-processes of bash</p>\n\n<p>try </p>\n\n<pre><code>export PS1\n</code></pre>\n\n<p>before you run your app</p>\n\n<p>you could also do</p>\n\n<pre><code>PS1=$PS1 app\n</code></pre>\n\n<p>to set it specifically in the sub process</p>\n"}], "owner": {"reputation": 68230, "user_id": 1426056, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ac815b6fca201737db888a28efd7248?s=128&d=identicon&r=PG", "display_name": "waitingkuo", "link": "https://stackoverflow.com/users/1426056/waitingkuo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2439, "favorite_count": 1, "accepted_answer_id": 29366704, "answer_count": 1, "score": 3, "last_activity_date": 1509441564, "creation_date": 1427791078, "last_edit_date": 1509441564, "question_id": 29364178, "link": "https://stackoverflow.com/questions/29364178/how-to-get-environment-variable-ps1-by-golang", "title": "How to get environment variable PS1 by golang?", "body": "<p>PS1 is an environment variable for bash prompt. I can get this by <code>echo $PS1</code></p>\n\n<p>I try to use <a href=\"http://golang.org/pkg/os/#Getenv\" rel=\"nofollow\">os.Getenv</a> to get <code>PS1</code> but returns nothing:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"os\"\n)\n\nfunc main() {\n  fmt.Println(os.Getenv(\"PS1\"))\n}\n</code></pre>\n\n<p>Why does this happen and how should I fix this?\nThanks.</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 6, "creation_date": 1427787768, "post_id": 29363055, "comment_id": 46909892, "body": "<code>[:]</code> converts an array to a slice"}], "answers": [{"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1427788549, "post_id": 29363239, "comment_id": 46910296, "body": "BUG: <code>hashChannel &lt;- md5.Sum(buffer.Bytes())[:]</code> error is  <code>invalid operation md5.Sum(buffer.Bytes())[:] (slice of unaddressable value)</code>"}, {"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1427789134, "post_id": 29363239, "comment_id": 46910631, "body": "peterSo: Ah, yes. Sorry for that. Bug indeed. Corrected it"}, {"owner": {"reputation": 2317, "user_id": 4466589, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uPR5Y.jpg?s=128&g=1", "display_name": "Bora M. Alper", "link": "https://stackoverflow.com/users/4466589/bora-m-alper"}, "edited": false, "score": 1, "creation_date": 1500850567, "post_id": 29363239, "comment_id": 77504120, "body": "@ANisus Do you know why we need to introduce an intermediary variable <code>b</code> rather than just using <code>hashChannel &lt;- md5.Sum(buffer.Bytes())[:]</code> for instance?"}, {"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "reply_to_user": {"reputation": 2317, "user_id": 4466589, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uPR5Y.jpg?s=128&g=1", "display_name": "Bora M. Alper", "link": "https://stackoverflow.com/users/4466589/bora-m-alper"}, "edited": false, "score": 1, "creation_date": 1502696607, "post_id": 29363239, "comment_id": 78296572, "body": "@boramalper The specification for the slice expression states that &quot;If the sliced operand is an array, it must be addressable.&quot;. Which in this case means an <i>array variable</i> or a <i>pointer indirection</i> to the array. I can&#39;t answer exactly as to why they made that choice."}], "tags": [], "owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "is_accepted": false, "score": 6, "last_activity_date": 1427789104, "last_edit_date": 1427789104, "creation_date": 1427787809, "answer_id": 29363239, "question_id": 29363055, "link": "https://stackoverflow.com/questions/29363055/golang-convert-type-nbyte-to-byte/29363239#29363239", "title": "Golang convert type [N]byte to []byte", "body": "<p>Creating a slice using an array you can just make a <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"noreferrer\"><code>simple slice expression</code></a>:</p>\n\n<pre><code>foo := [5]byte{0, 1, 2, 3, 4}\nvar bar []byte = foo[:]\n</code></pre>\n\n<p>Or in your case:</p>\n\n<pre><code>b := md5.Sum(buffer.Bytes())\nhashChannel &lt;- b[:]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 13, "last_activity_date": 1427788444, "creation_date": 1427788444, "answer_id": 29363414, "question_id": 29363055, "link": "https://stackoverflow.com/questions/29363055/golang-convert-type-nbyte-to-byte/29363414#29363414", "title": "Golang convert type [N]byte to []byte", "body": "<p>Slice the array. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"crypto/md5\"\n    \"fmt\"\n)\n\nfunc main() {\n    var hashChannel = make(chan []byte, 1)\n    var buffer bytes.Buffer\n    sum := md5.Sum(buffer.Bytes())\n    hashChannel &lt;- sum[:]\n    fmt.Println(&lt;-hashChannel)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[212 29 140 217 143 0 178 4 233 128 9 152 236 248 66 126]\n</code></pre>\n"}], "owner": {"reputation": 335, "user_id": 2387196, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/186078e5a0be34f6180806030dc7a7b7?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/2387196/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18797, "favorite_count": 3, "closed_date": 1428575102, "accepted_answer_id": 29363414, "answer_count": 2, "score": 13, "last_activity_date": 1427789104, "creation_date": 1427787183, "question_id": 29363055, "link": "https://stackoverflow.com/questions/29363055/golang-convert-type-nbyte-to-byte", "closed_reason": "Duplicate", "title": "Golang convert type [N]byte to []byte", "body": "<p>I have this code:</p>\n\n<pre><code>hashChannel &lt;- []byte(md5.Sum(buffer.Bytes()))\n</code></pre>\n\n<p>And I get this error: </p>\n\n<pre><code>cannot convert md5.Sum(buffer.Bytes()) (type [16]byte) to type []byte\n</code></pre>\n\n<p>Even without the explicit conversion this does not work. I can keep the type [16]byte as well, but at some point I need to convert it, as I'm sending it over a TCP connection:</p>\n\n<pre><code>_, _ = conn.Write(h)\n</code></pre>\n\n<p>What is the best method to convert it?\nThanks</p>\n"}, {"tags": ["arrays", "go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 4, "last_activity_date": 1427781256, "last_edit_date": 1427781256, "creation_date": 1427780879, "answer_id": 29361426, "question_id": 29361377, "link": "https://stackoverflow.com/questions/29361377/creating-a-go-slice-without-make/29361426#29361426", "title": "Creating a Go slice without make", "body": "<p>Since you didn't specify the length, it is a slice.</p>\n\n<p>An array type definition specifies a length and an element type: see \"<a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Go Slices: usage and internals</a>\"</p>\n\n<p><img src=\"https://i.stack.imgur.com/pHaai.png\" alt=\"http://blog.golang.org/go-slices-usage-and-internals_slice-array.png\"></p>\n\n<blockquote>\n  <p>A slice literal is declared just like an array literal, except you leave out the element count.</p>\n</blockquote>\n\n<p>While a slice can be created with the built-in function called make, you used the literal form to create a slice.</p>\n\n<p>The internal of the created slice differs from an array:</p>\n\n<pre><code>make([]byte, 5)\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/aw7BJ.png\" alt=\"http://blog.golang.org/go-slices-usage-and-internals_slice-1.png\"></p>\n"}, {"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 3, "last_activity_date": 1427782115, "last_edit_date": 1427782115, "creation_date": 1427781688, "answer_id": 29361626, "question_id": 29361377, "link": "https://stackoverflow.com/questions/29361377/creating-a-go-slice-without-make/29361626#29361626", "title": "Creating a Go slice without make", "body": "<p>In go, <em>array</em> types include their <em>length</em>.  Since you omitted the length it is a <em>slice</em>:</p>\n\n<pre><code>array := [3]int{1, 2, 3} // Array since it includes length (3).\nslice := array[:] // Slice since there is no length specified.\n\nfmt.Printf(\"%#v - %T\\n\", slice, slice) // %T means \"type\".\nfmt.Printf(\"%#v - %T\\n\", array, array)\n// [3]int{1, 2, 3} - [3]int\n// []int{1, 2, 3} - []int\n</code></pre>\n\n<p>In the example above, we made a slice without invoking \"make\" by setting it to the full range of of <code>array</code>.  If you were to edit either <code>array</code> or <code>slice</code> then both will change, since \"slice\" is essentially a view into the storage that is \"array\".</p>\n\n<pre><code>slice[0] = 456 // And array[0] == 456\narray[0] = 789 // And slice[0] == 789\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1427789236, "last_edit_date": 1592644375, "creation_date": 1427782020, "answer_id": 29361702, "question_id": 29361377, "link": "https://stackoverflow.com/questions/29361377/creating-a-go-slice-without-make/29361702#29361702", "title": "Creating a Go slice without make", "body": "<p>Actually by doing this:</p>\n<pre><code>nums := []int{2, 3, 4}\n</code></pre>\n<p>You are creating <em>both</em>: an array <em>and</em> a slice. But since it is a <a href=\"http://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">slice literal</a>, the result will be of slice type, so the type of <code>nums</code> is <code>[]int</code> which you can verify with this code:</p>\n<pre><code>fmt.Printf(&quot;%T&quot;, nums) // Output: []int\n</code></pre>\n<p>What happens is that an array will be created/allocated automatically in the background with a length of 3 initialized with the listed elements, and a slice will be created referring to the array, and this slice will be the result of the expression.</p>\n<p>Quoting from the <a href=\"http://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">Go Language Specification: Composite literals</a>:</p>\n<blockquote>\n<p>A slice literal describes the entire underlying array literal. Thus, the length and capacity of a slice literal are the maximum element index plus one. A slice literal has the form</p>\n<pre><code>[]T{x1, x2, \u2026 xn}\n</code></pre>\n<p>and is shorthand for a slice operation applied to an array:</p>\n<pre><code>tmp := [n]T{x1, x2, \u2026 xn}\ntmp[0 : n]\n</code></pre>\n</blockquote>\n<p>An Array literal also includes the length, for example:</p>\n<pre><code>arr := [3]int{1, 2, 3}\narr2 := [...]int{1, 2, 3} // Length will be computed by the compiler\nfmt.Printf(&quot;%T&quot;, arr)  // Output: [3]int\nfmt.Printf(&quot;%T&quot;, arr2) // Output: [3]int\n</code></pre>\n"}], "owner": {"reputation": 6557, "user_id": 2495795, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13606de0b736d7191e2cf2bfea1d4fda?s=128&d=identicon&r=PG", "display_name": "BufBills", "link": "https://stackoverflow.com/users/2495795/bufbills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 1, "accepted_answer_id": 29361626, "answer_count": 3, "score": 2, "last_activity_date": 1427842467, "creation_date": 1427780681, "last_edit_date": 1427842467, "question_id": 29361377, "link": "https://stackoverflow.com/questions/29361377/creating-a-go-slice-without-make", "title": "Creating a Go slice without make", "body": "<pre><code>nums := []int{2, 3, 4}\n</code></pre>\n\n<p>What does this do in go? Am I creating an array or a slice?  </p>\n\n<p>From this: <a href=\"https://gobyexample.com/range\" rel=\"nofollow\">https://gobyexample.com/range</a>, it says slice. But I think it is an array.</p>\n"}, {"tags": ["arrays", "string", "go", "hex"], "answers": [{"tags": [], "owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "is_accepted": false, "score": 2, "last_activity_date": 1427775030, "creation_date": 1427775030, "answer_id": 29360465, "question_id": 29360197, "link": "https://stackoverflow.com/questions/29360197/encoding-hex-invalid-byte-u0068-h-golang/29360465#29360465", "title": "encoding/hex: invalid byte: U+0068 &#39;h&#39; Golang", "body": "<p>Your code is trying to decode <em>from</em> hex. That string is not hex encoded.</p>\n\n<p>To encode <em>to</em> hex try this</p>\n\n<pre><code>b := fmt.Sprintf(\"%x\", str)\n\nfmt.Printf(\"Decoded bytes %v\", []byte(b))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1427786402, "last_edit_date": 1427786402, "creation_date": 1427786088, "answer_id": 29362750, "question_id": 29360197, "link": "https://stackoverflow.com/questions/29360197/encoding-hex-invalid-byte-u0068-h-golang/29362750#29362750", "title": "encoding/hex: invalid byte: U+0068 &#39;h&#39; Golang", "body": "<blockquote>\n  <p>I want to convert my <code>string</code> into <code>byte</code> array containing hexadecimal values of each character in the <code>string</code>.</p>\n</blockquote>\n\n<p>You can simply convert a <code>string</code> to a <code>[]byte</code> (byte slice, not exactly the same as array!) by using a simple type <a href=\"http://golang.org/ref/spec#Conversions\" rel=\"nofollow\">conversion</a>:</p>\n\n<pre><code>b := []byte(str)\n</code></pre>\n\n<p>And you're done!</p>\n\n<p>If you want to print it as a hexadecimal <code>string</code>, you can do that with the <a href=\"http://golang.org/pkg/fmt/#Printf\" rel=\"nofollow\"><code>fmt.Printf()</code></a> function using both the <code>string</code> and the <code>[]byte</code>:</p>\n\n<pre><code>fmt.Printf(\"%x\", str)\n// Or:\nfmt.Printf(\"%x\", b)\n</code></pre>\n\n<p><em>Tip: you can use the format string <code>\"% x\"</code> to have a space printed between each of the hexadecimal forms of the bytes/characters:</em></p>\n\n<pre><code>fmt.Printf(\"% x\", str)\n</code></pre>\n\n<p>If you want the result of the hexadecimal form as a <code>string</code>, you can use the <a href=\"http://golang.org/pkg/fmt/#Sprintf\" rel=\"nofollow\"><code>fmt.Sprintf()</code></a> variant:</p>\n\n<pre><code>hexst := fmt.Sprintf(\"%x\", str)\n// Or:\nhexst := fmt.Sprintf(\"%x\", b)\n</code></pre>\n\n<p>Or as an alternative you can use the <a href=\"http://golang.org/pkg/encoding/hex/#EncodeToString\" rel=\"nofollow\"><code>hex.EncodeToString()</code></a> function from the <code>encoding/hex</code> package:</p>\n\n<pre><code>hexst := hex.EncodeToString(b)\n</code></pre>\n"}], "owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7236, "favorite_count": 2, "accepted_answer_id": 29362750, "answer_count": 2, "score": 1, "last_activity_date": 1427786402, "creation_date": 1427773272, "last_edit_date": 1427786363, "question_id": 29360197, "link": "https://stackoverflow.com/questions/29360197/encoding-hex-invalid-byte-u0068-h-golang", "title": "encoding/hex: invalid byte: U+0068 &#39;h&#39; Golang", "body": "<p>I'm trying to convert a <code>string</code> into a <code>byte</code> array containing its hexadecimal values, here is the code I've written:</p>\n\n<pre><code>package main\n\nimport (\n     \"encoding/hex\"\n     \"fmt\"\n     \"os\"\n)\n\nfunc main() {\n     str :=\"abcdefhijklmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ123456789\"\n\n     b, err := hex.DecodeString(str)\n\n     if err != nil {\n             fmt.Println(err)\n             os.Exit(1)\n     }\n\n     fmt.Printf(\"Decoded bytes %v \\n \", b)\n}\n</code></pre>\n\n<p>Here is the link from Go PlayGround: <a href=\"http://play.golang.org/p/8PMEFTCYSd\" rel=\"nofollow\">http://play.golang.org/p/8PMEFTCYSd</a> </p>\n\n<p>But it's giving me the error <strong>*encoding/hex: invalid byte: U+0068 'h' Golang *</strong>. What's the problem here? I want to convert my <code>string</code> into <code>byte</code> array containing hexadecimal values of each character in the <code>string</code>. I want <code>b[n]</code> to contain hexadecimal value of <code>str[n]</code>.</p>\n"}, {"tags": ["amazon-web-services", "go", "initialization"], "answers": [{"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 0, "last_activity_date": 1427783315, "creation_date": 1427783315, "answer_id": 29362030, "question_id": 29360093, "link": "https://stackoverflow.com/questions/29360093/better-initialization/29362030#29362030", "title": "Better initialization", "body": "<p>I don't know how much more acceptable this is, but it should do the same:</p>\n\n<pre><code>self := \"self\"\nresp, err := svc.DescribeImages(\n    &amp;ec2.DescribeImagesInput{\n        Owners: []*string{&amp;self},\n    },\n}\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Which could of course be shortened, albeit at the cost of readability IMO</p>\n\n<pre><code>self := \"self\"\nresp, err := svc.DescribeImages(&amp;ec2.DescribeImagesInput{Owners:[]*string{&amp;self}}}\nif err != nil {\n    panic(err)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1471955009, "last_edit_date": 1471955009, "creation_date": 1427783711, "answer_id": 29362116, "question_id": 29360093, "link": "https://stackoverflow.com/questions/29360093/better-initialization/29362116#29362116", "title": "Better initialization", "body": "<p>You can't get it any shorter than this:</p>\n\n<pre><code>self := \"self\"\nownImages := &amp;ec2.DescribeImagesInput{Owners: []*string{&amp;self}}\n</code></pre>\n\n<p>Or in one line (without the <code>self</code> string variable):</p>\n\n<pre><code>ownImages := &amp;ec2.DescribeImagesInput{Owners: []*string{&amp;[]string{\"self\"}[0]}}\n</code></pre>\n\n<p>(What happens here is I create a <code>[]string</code> slice with one element <code>\"self\"</code>, index its only element and take its address and use this value to initialize the required <code>[]*string</code>.)</p>\n\n<p>What you can do is create a helper function which constructs the slice of <code>string</code> pointers for you:</p>\n\n<pre><code>func sp(es ...string) []*string {\n    s := make([]*string, len(es))\n    for i := range es {\n        s[i] = &amp;es[i]\n    }\n    return s\n}\n</code></pre>\n\n<p>With this, the delcaration becomes:</p>\n\n<pre><code>ownImages = &amp;ec2.DescribeImagesInput{Owners: sp(\"self\")}\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/mJUe5WhV-W\" rel=\"nofollow\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 2612, "user_id": 106717, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/82437d8be141d96116e840f6a47cbe63?s=128&d=identicon&r=PG", "display_name": "Peter Sankauskas", "link": "https://stackoverflow.com/users/106717/peter-sankauskas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 29362116, "answer_count": 2, "score": 1, "last_activity_date": 1471955009, "creation_date": 1427772376, "question_id": 29360093, "link": "https://stackoverflow.com/questions/29360093/better-initialization", "title": "Better initialization", "body": "<p>I am making an API call to AWS to get a list of AMIs using the Golang SDK. The <a href=\"http://godoc.org/github.com/awslabs/aws-sdk-go/service/ec2#EC2.DescribeImages\" rel=\"nofollow\"><code>DescribeImages</code></a> function takes in <a href=\"http://godoc.org/github.com/awslabs/aws-sdk-go/service/ec2#DescribeImagesInput\" rel=\"nofollow\"><code>DescribeImagesInput</code></a>. I only want to see my own AMIs, so my code is doing this:</p>\n\n<pre><code>// Build input\nself := \"self\"\nownerSelf := []*string{&amp;self}\nownImages := &amp;ec2.DescribeImagesInput{\n    Owners: ownerSelf,\n}\n\n// Call the DescribeImages Operation\nresp, err := svc.DescribeImages(ownImages)\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Building input like that is very ugly. I am sure there is a better technique, but being a Golang n00b, I don't know it. What is a better way to do?</p>\n"}, {"tags": ["go", "vk", "martini"], "answers": [{"comments": [{"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1428488179, "post_id": 29510761, "comment_id": 47179434, "body": "Thank you, it is compiled nice, but still cannot login. Please see my update above."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": 0, "last_activity_date": 1428485107, "creation_date": 1428485107, "answer_id": 29510761, "question_id": 29359907, "link": "https://stackoverflow.com/questions/29359907/social-network-vk-auth-with-martini/29510761#29510761", "title": "social network vk auth with martini", "body": "<p>In the package documentation, <code>YourRedirectFunc</code> is intended as placeholder for the actual method used to redirect a request in your particular case. It could be <code>http.Redirect</code> for example. Same for <code>getCurrentUrl</code>.</p>\n\n<p>In fact, the example you linked to should be written as two handlers for your martini instance:</p>\n\n<pre><code>// This handler redirect the request to the vkontact system, which\n// will perform the authentification then redirect the request to\n// the URL we gave as the first paraemeter of the GetAuthUrl method\n// (treated by the second handler)\nm.Get(\"/vk/auth\", func(w http.ResponseWriter, r *http.Request) {\n    var api vk_api.Api\n    authUrl, err := api.GetAuthUrl(\"domain.com/vk/token\", \"token\", \"4672050\", \"wall,offline\")\n    if err != nil {\n        panic(err)\n    }\n\n    http.Redirect(w, r, authUrl, http.Found)\n})\n\n// This handler is the one that get the actual authentification \n// information from the vkontact api. You get the access token,\n// userid and expiration date of the authentification session. \n// You can do whatever you want with them, generally storing them \n// in session to be able to get the actual informations later using\n// the access token.\nm.Get(\"/vk/token\", func(w http.ResponseWriter, r *http.Request) {\n    accessToken, userId, expiresIn, err := vk_api.ParseResponseUrl(r.URL.String())\n    if err != nil {\n        panic(err)\n    }\n})\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1428499781, "post_id": 29513534, "comment_id": 47187369, "body": "Thank you, I have logged in, but code prints empty lines <code>fmt.Println(accessToken) fmt.Println(userId) fmt.Println(expiresIn) </code>. Please see <code>update 2</code> above"}, {"owner": {"reputation": 2297, "user_id": 661378, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/853372c681dc96b95f42adcb88b0cb3f?s=128&d=identicon&r=PG", "display_name": "qwertmax", "link": "https://stackoverflow.com/users/661378/qwertmax"}, "reply_to_user": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1428500194, "post_id": 29513534, "comment_id": 47187695, "body": "yeah, see the end of my answer - it&#39;s because vk response has fragment url, #access_token .... etc, they are NOT visible for backend (for your server)"}, {"owner": {"reputation": 2297, "user_id": 661378, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/853372c681dc96b95f42adcb88b0cb3f?s=128&d=identicon&r=PG", "display_name": "qwertmax", "link": "https://stackoverflow.com/users/661378/qwertmax"}, "reply_to_user": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1428500297, "post_id": 29513534, "comment_id": 47187765, "body": "if you print r.URL.String() you&#39;ll see just /vk/token because everything after # in url will stay on browser side (frontend)"}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1428501254, "post_id": 29513534, "comment_id": 47188545, "body": "so seemingly, the only one solution is to use javascript to get <code>access_token</code> like <code>document.location.hash</code>"}, {"owner": {"reputation": 2297, "user_id": 661378, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/853372c681dc96b95f42adcb88b0cb3f?s=128&d=identicon&r=PG", "display_name": "qwertmax", "link": "https://stackoverflow.com/users/661378/qwertmax"}, "reply_to_user": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1428501349, "post_id": 29513534, "comment_id": 47188618, "body": "yeah, any js solutions will 100% works. I don&#39;t know the aim of you project, and I can&#39;t advice you what could works for you."}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1428501493, "post_id": 29513534, "comment_id": 47188736, "body": "the aim of current code piece is to provide logining by vk, then just get Name and Vk UserId."}, {"owner": {"reputation": 2297, "user_id": 661378, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/853372c681dc96b95f42adcb88b0cb3f?s=128&d=identicon&r=PG", "display_name": "qwertmax", "link": "https://stackoverflow.com/users/661378/qwertmax"}, "reply_to_user": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1428502023, "post_id": 29513534, "comment_id": 47189198, "body": "ah, I see. I think that go vk api it not best solution to use ;) It is simple oauth you can find a lot of projects on github"}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "reply_to_user": {"reputation": 2297, "user_id": 661378, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/853372c681dc96b95f42adcb88b0cb3f?s=128&d=identicon&r=PG", "display_name": "qwertmax", "link": "https://stackoverflow.com/users/661378/qwertmax"}, "edited": false, "score": 0, "creation_date": 1428549646, "post_id": 29513534, "comment_id": 47212207, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/74780/discussion-between-efr-and-qwertmax\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 2297, "user_id": 661378, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/853372c681dc96b95f42adcb88b0cb3f?s=128&d=identicon&r=PG", "display_name": "qwertmax", "link": "https://stackoverflow.com/users/661378/qwertmax"}, "is_accepted": false, "score": 2, "last_activity_date": 1428493101, "creation_date": 1428493101, "answer_id": 29513534, "question_id": 29359907, "link": "https://stackoverflow.com/questions/29359907/social-network-vk-auth-with-martini/29513534#29513534", "title": "social network vk auth with martini", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/go-martini/martini\"\n    \"github.com/yanple/vk_api\"\n    \"net/http\"\n)\n\nvar api vk_api.Api\n\nfunc prepareMartini() *martini.ClassicMartini {\n    m := martini.Classic()\n\n    m.Get(\"/vk/auth\", func(w http.ResponseWriter, r *http.Request) {\n        var api vk_api.Api\n        authUrl, err := api.GetAuthUrl(\"http://localhost:3000/vk/token\", \"token\", \"2756549\", \"wall,offline\")\n\n        fmt.Println(authUrl)\n        if err != nil {\n            panic(err)\n        }\n\n        http.Redirect(w, r, authUrl, http.StatusFound)\n    })\n\n    m.Get(\"/vk/token\", func(w http.ResponseWriter, r *http.Request) {\n        accessToken, userId, expiresIn, err := vk_api.ParseResponseUrl(r.URL.String())\n        if err != nil {\n            panic(err)\n        }\n        fmt.Println(accessToken)\n        fmt.Println(userId)\n        fmt.Println(expiresIn)\n    })\n    return m\n}\n\nfunc main() {\n    prepareMartini().Run()\n}\n</code></pre>\n\n<p>for you VK settings you have to add your domain like on this screenshot</p>\n\n<p><img src=\"https://i.stack.imgur.com/fPZP9.png\" alt=\"enter image description here\"></p>\n\n<p>After that you will be redirected to <a href=\"http://localhost:3000/vk/token#access_token=some_token&amp;expires_in=0&amp;user_id=0000000\" rel=\"nofollow noreferrer\">http://localhost:3000/vk/token#access_token=some_token&amp;expires_in=0&amp;user_id=0000000</a></p>\n\n<p>but I'm not sure how you will Parse url via \"ParseResponseUrl\" because vk get to you \"fragment url\".</p>\n\n<p>Fragment url is not sending to serve via HTTP - I think that could be a problem. </p>\n"}, {"comments": [{"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 1, "creation_date": 1432785831, "post_id": 30485586, "comment_id": 49070991, "body": "In order to make this example work I had to update  <code>vk_api</code> package: <code>go get -u github.com&#47;yanple&#47;vk_api</code>"}], "tags": [], "owner": {"reputation": 81, "user_id": 1913412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd848ff68420fd54d260c7c46c20daf3?s=128&d=identicon&r=PG", "display_name": "happierall", "link": "https://stackoverflow.com/users/1913412/happierall"}, "is_accepted": true, "score": 1, "last_activity_date": 1432802724, "last_edit_date": 1432802724, "creation_date": 1432737197, "answer_id": 30485586, "question_id": 29359907, "link": "https://stackoverflow.com/questions/29359907/social-network-vk-auth-with-martini/30485586#30485586", "title": "social network vk auth with martini", "body": "<p>Thanks for answer,\nI added <a href=\"https://github.com/yanple/vk_api/blob/master/examples/martini.go\" rel=\"nofollow\">example</a> @qwertmax and fixed bug for parse fragment of url. Please update package and see example.</p>\n\n<pre><code>package main\n// Thanks @qwertmax for this example\n// (http://stackoverflow.com/questions/29359907/social-network-vk-auth-with-martini)\n\n\nimport (\n    \"log\"\n    \"github.com/go-martini/martini\"\n    \"github.com/yanple/vk_api\"\n    \"net/http\"\n)\n\nvar api vk_api.Api\n\nfunc prepareMartini() *martini.ClassicMartini {\n    m := martini.Classic()\n\n    m.Get(\"/vk/auth\", func(w http.ResponseWriter, r *http.Request) {\n        authUrl, err := api.GetAuthUrl(\n        \"http://localhost:3000/vk/token\",\n        \"app client id\",\n        \"wall,offline\")\n\n        if err != nil {\n            panic(err)\n        }\n\n        http.Redirect(w, r, authUrl, http.StatusFound)\n    })\n\n    m.Get(\"/vk/token\", func(w http.ResponseWriter, r *http.Request) {\n        code := r.URL.Query().Get(\"code\")\n\n        err := api.OAuth(\n        \"http://localhost:3000/vk/token\", // redirect uri\n        \"app secret key\",\n        \"app client id\",\n        code)\n        if err != nil {\n            panic(err)\n        }\n        http.Redirect(w, r, \"/\", http.StatusFound)\n    })\n\n    m.Get(\"/\", func(w http.ResponseWriter, r *http.Request) string {\n        if api.AccessToken == \"\" {\n            return \"&lt;a href='/vk/auth'&gt;\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f&lt;/a&gt;\"\n        }\n\n        // Api have: AccessToken, UserId, ExpiresIn\n        log.Println(\"[LOG] martini.go:48 -&gt;\", api.AccessToken)\n\n        // Make query\n        params := make(map[string]string)\n        params[\"domain\"] = \"yanple\"\n        params[\"count\"] = \"1\"\n\n        strResp, err := api.Request(\"wall.get\", params)\n        if err != nil {\n            panic(err)\n        }\n        return strResp\n    })\n    return m\n}\n\nfunc main() {\n    prepareMartini().Run()\n}\n</code></pre>\n\n<p><strong>Update 1:</strong>\n  Update your package with command: <strong>go get -u github.com/yanple/vk_api</strong>\n  Thanks for the comment.</p>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1230, "favorite_count": 0, "accepted_answer_id": 30485586, "answer_count": 3, "score": 2, "last_activity_date": 1432802724, "creation_date": 1427771083, "last_edit_date": 1592644375, "question_id": 29359907, "link": "https://stackoverflow.com/questions/29359907/social-network-vk-auth-with-martini", "title": "social network vk auth with martini", "body": "<p>I am trying to use <a href=\"https://github.com/yanple/vk_api#by-user-auth-click-allow-on-special-vk-page\" rel=\"nofollow noreferrer\">vk auth</a> with <a href=\"https://github.com/go-martini/martini\" rel=\"nofollow noreferrer\">martini</a>. But have error  on compile:</p>\n<pre><code>/goPath/vkAuthTry2.go:38: undefined: YourRedirectFunc\n</code></pre>\n<p>The question is how to define <code>YourRedirectFunc</code> function. Or if ask more widely I need working example of <code>martini</code> app with <code>vk</code> social network authentication or if even more widely an example of any golang website using <code>vk</code> authentication.</p>\n<p>Full code:</p>\n<pre><code>package main\n\nimport (\n    &quot;github.com/go-martini/martini&quot;\n    &quot;github.com/yanple/vk_api&quot;\n    &quot;net/http&quot;\n)\n\nvar api vk_api.Api\n\nfunc prepareMartini() *martini.ClassicMartini {\n    m := martini.Classic()\n    m.Get(&quot;/somePage&quot;, func(w http.ResponseWriter, r *http.Request) {\n        //  And receive token on the special method (redirect uri)\n        currentUrl := r.URL.RequestURI() // for example &quot;yoursite.com/get_access_token#access_token=3304fdb7c3b69ace6b055c6cba34e5e2f0229f7ac2ee4ef46dc9f0b241143bac993e6ced9a3fbc111111&amp;expires_in=0&amp;user_id=1&quot;\n        accessToken, userId, expiresIn, err := vk_api.ParseResponseUrl(currentUrl)\n        if err != nil {\n            panic(err)\n        }\n        api.AccessToken = accessToken\n        api.UserId = userId\n        api.ExpiresIn = expiresIn\n        w.Write([]byte(&quot;somePage&quot;))\n    })\n    return m\n}\n\nfunc main() {\n    authUrl, err := api.GetAuthUrl(\n        &quot;domain.com/method_get_access_token&quot;, // redirect URI\n        &quot;token&quot;,        // response type\n        &quot;4672050&quot;,      // client id\n        &quot;wall,offline&quot;, // permissions https://vk.com/dev/permissions\n    )\n    if err != nil {\n        panic(err)\n    }\n    YourRedirectFunc(authUrl)\n    prepareMartini().Run()\n}\n</code></pre>\n<h1>Update</h1>\n<p>I edited my code according to @Elwinar's answer:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;github.com/go-martini/martini&quot;\n    &quot;github.com/yanple/vk_api&quot;\n    &quot;net/http&quot;\n)\n\nvar api vk_api.Api\n\nfunc prepareMartini() *martini.ClassicMartini {\n    m := martini.Classic()\n    // This handler redirect the request to the vkontact system, which\n    // will perform the authentification then redirect the request to\n    // the URL we gave as the first paraemeter of the GetAuthUrl method\n    // (treated by the second handler)\n    m.Get(&quot;/vk/auth&quot;, func(w http.ResponseWriter, r *http.Request) {\n        var api vk_api.Api\n        authUrl, err := api.GetAuthUrl(&quot;http://localhost:3000/vk/token&quot;, &quot;token&quot;, &quot;4672050&quot;, &quot;wall,offline&quot;)\n        if err != nil {\n            panic(err)\n        }\n\n        http.Redirect(w, r, authUrl, http.StatusFound)\n    })\n\n    // This handler is the one that get the actual authentification\n    // information from the vkontact api. You get the access token,\n    // userid and expiration date of the authentification session.\n    // You can do whatever you want with them, generally storing them\n    // in session to be able to get the actual informations later using\n    // the access token.\n    m.Get(&quot;/vk/token&quot;, func(w http.ResponseWriter, r *http.Request) {\n        accessToken, userId, expiresIn, err := vk_api.ParseResponseUrl(r.URL.String())\n        if err != nil {\n            panic(err)\n        }\n        fmt.Println(accessToken)\n        fmt.Println(userId)\n        fmt.Println(expiresIn)\n    })\n    return m\n}\n\nfunc main() {\n    prepareMartini().Run()\n}\n</code></pre>\n<p>now no complie errors, but still cannot login.\nWhen I opened <code>http://localhost:3000/vk/auth</code> I was redirected on page...</p>\n<pre><code>https://oauth.vk.com/authorize?client_id=MY_APP_ID&amp;redirect_uri=localhost%3A3000%2Fvk%2Ftoken&amp;response_type=token&amp;scope=wall%2Coffline\n</code></pre>\n<p>... and got the following browser output:</p>\n<pre><code>{&quot;error&quot;:&quot;invalid_request&quot;,&quot;error_description&quot;:&quot;redirect_uri is incorrect, check application domain in the settings page&quot;}\n</code></pre>\n<p>Of course instead of <code>4672050</code> I pasted my app id. This app was specially generated for <code>localhost:3000</code>.\nMaybe I need to paste somewhere my private key for oauth like <code>pYFR2Xojlkad87880dLa</code>.</p>\n<h1>Update 2</h1>\n<p>@qwertmax's answer almost works. I have successfully logged in by vk, but my code prints empty lines instead of <code>userId</code> and another user information:</p>\n<pre><code> accessToken, userId, expiresIn, err := vk_api.ParseResponseUrl(r.URL.String())\n\nfmt.Println(accessToken)\nfmt.Println(userId)\nfmt.Println(expiresIn)\n</code></pre>\n"}, {"tags": ["windows", "go", "samba"], "comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 3, "creation_date": 1427761353, "post_id": 29358125, "comment_id": 46901456, "body": "Delay*bandwidth product"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1427762789, "post_id": 29358125, "comment_id": 46901843, "body": "Sounds like the file is too small, so you&#39;re measuring overheads rather than actual transfer speed."}, {"owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1427775311, "post_id": 29358125, "comment_id": 46904894, "body": "@Harry The file I&#39;ve been testing on is 50MB, so I don&#39;t think that&#39;s the issue."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 1, "creation_date": 1427779570, "post_id": 29358125, "comment_id": 46906172, "body": "So, to confirm, it&#39;s taking about five minutes to download a 50MB file via the proxy server?"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 1, "creation_date": 1427779752, "post_id": 29358125, "comment_id": 46906232, "body": "I&#39;d hazard a guess that, for whatever reason, io.Copy is not using a large enough buffer.  You might have to implement the copy yourself.  Second best guess would be some oddness in http.Response."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1427780320, "post_id": 29358125, "comment_id": 46906439, "body": "Try wrapping the file with bufio."}], "answers": [{"tags": [], "owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "is_accepted": true, "score": 1, "last_activity_date": 1427843353, "last_edit_date": 1427843353, "creation_date": 1427830878, "answer_id": 29377148, "question_id": 29358125, "link": "https://stackoverflow.com/questions/29358125/paradoxical-performance-serving-samba-files-in-go/29377148#29377148", "title": "Paradoxical performance serving samba files in go", "body": "<p>After trying to track down exactly where and under what circumstances I could reproduce the issue, I finally got it down to one line: if I commented out where io.Copy uses ReadFrom (currently <code>io/io.go</code>, line 358), I got maximum throughput.</p>\n\n<p>Checking out where ReadFrom is implemented (<code>net/http/server.go</code>, line 381):</p>\n\n<pre><code>// ReadFrom is here to optimize copying from an *os.File regular file\n// to a *net.TCPConn with sendfile.\n</code></pre>\n\n<p>I don't really have the will to dig any deeper, but I'm guessing this calls <code>net/sendfile_windows.go</code>, which calls the TransmitFile syscall, and somewhere between that and our various server configs something not good happens.</p>\n\n<p>The solution was to copy and paste the things I needed from http.ServeFile, and then turn the ResponseWriter into an io.Writer (or whatever) before passing it to io.Copy:</p>\n\n<pre><code>type writerOnly struct {\n    io.Writer\n}\n\n//...\nio.Copy(writerOnly{w}, f)\n//...\n</code></pre>\n"}], "owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 29377148, "answer_count": 1, "score": 1, "last_activity_date": 1427843353, "creation_date": 1427758289, "last_edit_date": 1427776631, "question_id": 29358125, "link": "https://stackoverflow.com/questions/29358125/paradoxical-performance-serving-samba-files-in-go", "title": "Paradoxical performance serving samba files in go", "body": "<p>I've written a program in go that acts as a simple HTTP interface to a samba share: the user makes a get request to <code>http://proxy.example.com/?path=\\\\repository\\foo\\bar.txt</code> and <code>\\\\repository\\foo\\bar.txt</code> is served up by way of http.ServeFile (more or less).</p>\n\n<p>However, the performance is abysmal. I ran some benchmarks and the results have me stumped. For context, there are three machines in the picture: the samba server (where the file is located), the proxy server (where the go program runs) and the end user's machine (where I ultimately want the file to get). The samba server and the proxy server are co-located, and the end users are fairly far away.</p>\n\n<p>A straight copy from the samba machine to the user machine using windows' copy runs at ~1.5MB/s. That's good enough for me, and what I'm aiming for in the proxy service.</p>\n\n<p>Unfortunately <code>curl 'http://proxy.example.com/?path=\\\\repository\\foo\\bar.txt' &gt; bar.txt</code> from a user's machine clocks in at about 150KB/s.</p>\n\n<p>So, let's see if there's connectivity issues between the samba server and the proxy server. A copy from the samba server to the proxy server looks like it's getting... about 15MB/s.</p>\n\n<p>Hm, maybe it's a go thing? I'll write a go program that benchmarks the transfer speed.</p>\n\n<pre><code>src, _ := os.Open(\"\\\\\\\\repository\\\\foo\\\\bar.txt\")\nstart := time.Now()\nwritten, _ := io.Copy(ioutil.Discard, src)\nelapsed := time.Since(start)\nbytesPerSecond := written/int64(elapsed/time.Second)\n</code></pre>\n\n<p>Dang, 15MB/s.</p>\n\n<p>Ok, ok, maybe there's something <em>else</em> in the go code causing the issue. Remote onto the proxy server, start up IE, go to <code>http://proxy.example.com/?path=\\\\repository\\foo\\bar.txt</code>, 15MB/s.</p>\n\n<p>Alright, so my code is obviously working great, it must be the connection between the proxy server and the end user. I'll copy <code>bar.txt</code> to the proxy server and use its local path in the url, <code>\\mycoolfiles\\bar.txt</code>. Huh, 1.5MB/s.</p>\n\n<p>To make things even weirder, I just happen to have <code>C:\\mycoolfiles</code> set up as a network share named <code>\\\\alexscoolfiles</code>, and <code>http://proxy.example.com/?path=\\\\alexscoolfiles\\bar.txt</code> clocks in at, dun dun dun, 150KB/s.</p>\n\n<p>Just to confirm this madness, I changed the go program to run in two steps:</p>\n\n<ol>\n<li>Copy the file from the share to the local hard drive</li>\n<li>http.SendFile from there</li>\n</ol>\n\n<p>Lo and behold, after a short pause while the file transfers over at 15MB/s, the download begins at a solid 1.5MB/s.</p>\n\n<p>So, share->proxy is 15MB/s, and proxy->user is 1.5MB/s, but share->proxy->user is... 150KB/s? Ten times slower than it should be? Except not when you're on the same machine as the proxy, because then it's exactly as fast as it should be? And further this problem exists even if it's the exact same file being accessed as long as one is a UNC path and the other is just a local path?</p>\n\n<p>WHAT?</p>\n\n<p>Please help, I just have no idea.</p>\n\n<p>EDIT: So my hunch is (as was commented) that it has something to do with TCP. The offending code has been isolated to pretty much just io.Copy.</p>\n\n<ul>\n<li>I know that when the reader is a samba file, and the writer is ioutil.Discard, I get about maximum throughput.</li>\n<li>I know that when the reader is a local file and the writer is an http.Response, I get about maximum throughput regardless of the bandwidth and RRT of the client consuming the response.</li>\n<li>I know that when the reader is a samba file, the writer is an http.Response, and the connection is local, I get about maximum throughput.</li>\n<li>I know that when the reader is a samba file, the writer is an http.Response, and the connection is not local, I get terrible (~1/10) throughput.</li>\n</ul>\n\n<p>Looking through io.Copy, it seems the only thing that could cause the issue is in the interplay between the timings of reading the samba file and writing the response; a sufficiently fast writer makes reading a samba file reach max throughput, a sufficiently fast reader makes http.Response.Write reach max throughput, but combining them makes everything suck.</p>\n\n<p>What would be very helpful is... What is actually happening and, more importantly, how can I make this problem go away.</p>\n"}, {"tags": ["search", "go", "elasticsearch", "lucene", "filtering"], "answers": [{"tags": [], "owner": {"reputation": 30915, "user_id": 1628375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9070d56379b05ec9417627d9378c6f8e?s=128&d=identicon&r=PG", "display_name": "femtoRgon", "link": "https://stackoverflow.com/users/1628375/femtorgon"}, "is_accepted": false, "score": 1, "last_activity_date": 1427757113, "creation_date": 1427757113, "answer_id": 29357936, "question_id": 29357148, "link": "https://stackoverflow.com/questions/29357148/how-to-filter-out-fields-that-do-not-exist-in-elastic-search/29357936#29357936", "title": "How to filter out fields that do not exist in elastic search?", "body": "<p>I won't try to provide a complete solution, being that I'm not really familiar with the library your using (or, indeed, the go language).</p>\n\n<p>However, Lucene doesn't support pure negative querying as you have here.  Lucene needs to be told what <em>to</em> match.  Negations like this serve strictly to prohibit search results, but do not implicitly match everything else.</p>\n\n<p>In order to do what you are looking for, you would want to use a boolean query to combine your not filter with a match all (which I see is <a href=\"https://github.com/olivere/elastic/blob/master/search_queries_match_all.go\" rel=\"nofollow\">available in the library</a>).</p>\n\n<p>Note: As with anytime you use a match all, performance may suffer.</p>\n"}, {"tags": [], "owner": {"reputation": 4047, "user_id": 3775217, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/G0bqn.jpg?s=128&g=1", "display_name": "user3775217", "link": "https://stackoverflow.com/users/3775217/user3775217"}, "is_accepted": false, "score": 10, "last_activity_date": 1610545217, "last_edit_date": 1610545217, "creation_date": 1427803448, "answer_id": 29368227, "question_id": 29357148, "link": "https://stackoverflow.com/questions/29357148/how-to-filter-out-fields-that-do-not-exist-in-elastic-search/29368227#29368227", "title": "How to filter out fields that do not exist in elastic search?", "body": "<p>Ok, I wont go deep in your language query API. Since you want to search on a field not existing (null), use an <code>exists</code> filter inside a <code>must_not</code> (if you use bool filters):</p>\n<pre><code>{\n  &quot;query&quot;: {\n    &quot;filtered&quot;: {\n      &quot;filter&quot;: {\n        &quot;bool&quot;: {\n          &quot;must_not&quot;: [\n            {\n              &quot;exists&quot;: {\n                &quot;field&quot;: &quot;your_field&quot;\n              }\n            }\n          ]\n        }\n      }\n    }\n  },\n  &quot;from&quot;: 0,\n  &quot;size&quot;: 500\n}\n</code></pre>\n<p>Hope this helps!</p>\n<p>Thanks</p>\n"}, {"tags": [], "owner": {"reputation": 17097, "user_id": 672689, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IPnRU.png?s=128&g=1", "display_name": "Roee Gavirel", "link": "https://stackoverflow.com/users/672689/roee-gavirel"}, "is_accepted": false, "score": 2, "last_activity_date": 1530603737, "creation_date": 1530603737, "answer_id": 51149090, "question_id": 29357148, "link": "https://stackoverflow.com/questions/29357148/how-to-filter-out-fields-that-do-not-exist-in-elastic-search/51149090#51149090", "title": "How to filter out fields that do not exist in elastic search?", "body": "<p>You can create a bool query for not exists like this:</p>\n\n<pre><code>existsQuery := elastic.NewExistsQuery(fieldName)\nexistsBoolQuery := elastic.NewBoolQuery().MustNot(existsQuery)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3095, "user_id": 1532769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wSiAS.jpg?s=128&g=1", "display_name": "Thiago Falcao", "link": "https://stackoverflow.com/users/1532769/thiago-falcao"}, "is_accepted": false, "score": 5, "last_activity_date": 1556128915, "creation_date": 1556128915, "answer_id": 55836041, "question_id": 29357148, "link": "https://stackoverflow.com/questions/29357148/how-to-filter-out-fields-that-do-not-exist-in-elastic-search/55836041#55836041", "title": "How to filter out fields that do not exist in elastic search?", "body": "<p>You can use <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-exists-query.html\" rel=\"noreferrer\">exist query</a> with <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-bool-query.html\" rel=\"noreferrer\">bool query must_not</a>:</p>\n\n<pre><code>GET /_search\n{\n    \"query\": {\n        \"bool\": {\n            \"must_not\": {\n                \"exists\": {\n                    \"field\": \"your_field\"\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Tested in Elasticsearch 6.5</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1128272"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21487, "favorite_count": 0, "answer_count": 4, "score": 7, "last_activity_date": 1610545217, "creation_date": 1427752940, "last_edit_date": 1560418172, "question_id": 29357148, "link": "https://stackoverflow.com/questions/29357148/how-to-filter-out-fields-that-do-not-exist-in-elastic-search", "title": "How to filter out fields that do not exist in elastic search?", "body": "<p>I would like to check if a field exists, and return results for documents where it does not exist. I am using the Golang library Elastic: <a href=\"https://github.com/olivere/elastic\" rel=\"nofollow noreferrer\">https://github.com/olivere/elastic</a></p>\n\n<p>I tried the following but it does not work:</p>\n\n<pre><code>e := elastic.NewExistsFilter(\"my_tag\")\nn := elastic.NewNotFilter(e)\nfilters = append(filters, n)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1427744781, "post_id": 29354470, "comment_id": 46894848, "body": "You were told before (in a clear comment on a question (<a href=\"http://stackoverflow.com/questions/29351734/negroni-mux-flow-refactor-the-sqlite3-database-connection\">?</a>) you asked minutes/hours ago that you deleted!) what your problem was. Don&#39;t waste people&#39;s time by ignoring comments, deleting questions, and re-asking the same damn thing."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1427743927, "creation_date": 1427743927, "answer_id": 29354672, "question_id": 29354470, "link": "https://stackoverflow.com/questions/29354470/troubles-sharing-the-db-global-handler/29354672#29354672", "title": "Troubles sharing the db global handler", "body": "<p>You're creatng a local <code>db</code> variable within <code>main</code>. When you call <code>getNames</code>, it is using the global <code>db</code>, which is still nil.</p>\n\n<p>use</p>\n\n<pre><code>var err error\ndb, err = sql.Open(\"sqlite3\", \"./data.db\")\n</code></pre>\n"}], "owner": {"reputation": 11628, "user_id": 1373105, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Wgf7P.jpg?s=128&g=1", "display_name": "Javier Cadiz", "link": "https://stackoverflow.com/users/1373105/javier-cadiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 29354672, "answer_count": 1, "score": -1, "last_activity_date": 1427743927, "creation_date": 1427743255, "last_edit_date": 1495542756, "question_id": 29354470, "link": "https://stackoverflow.com/questions/29354470/troubles-sharing-the-db-global-handler", "title": "Troubles sharing the db global handler", "body": "<p>My code is the following:</p>\n\n<pre><code>package main\n\nimport (\n  \"database/sql\"\n  \"fmt\"\n  _ \"github.com/mattn/go-sqlite3\"\n  \"log\"\n)\n\nvar db *sql.DB\n\nfunc main() {\n  fmt.Println(\"Starting test ...\")\n\n  db, err := sql.Open(\"sqlite3\", \"./data.db\")\n  checkErr(err)\n\n  err = db.Ping()\n  checkErr(err)\n\n  fmt.Println(getNames())\n}\n\nfunc checkErr(err error) {\n  if err != nil {\n    log.Fatal(err)\n  }\n}\n\nfunc getNames() []string {\n  query := `select name from places`\n  rows, err := db.Query(query)\n  checkErr(err)\n  defer rows.Close()\n\n  var names []string\n  for rows.Next() {\n    var name string\n    rows.Scan(&amp;name)\n    names = append(names, name)\n  }\n\n  return names\n}\n</code></pre>\n\n<p>I came across <a href=\"https://stackoverflow.com/questions/17376207/how-to-share-mysql-connection-between-http-goroutines/\">this question</a> but the approach don't work for me. I'm using sqlite3 for storage.\nMy goal is simple. Share the db handler across all the functions.\nI'm getting the following error when build and run.</p>\n\n<pre><code>Starting test ...\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x0 pc=0x411fc6e]\n\ngoroutine 1 [running]:\ndatabase/sql.(*DB).conn(0x0, 0x0, 0x0, 0x0)\n    /usr/local/Cellar/go/1.4.2/libexec/src/database/sql/sql.go:634   +0x7ae\ndatabase/sql.(*DB).query(0x0, 0x421cb10, 0x17, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0)\n    /usr/local/Cellar/go/1.4.2/libexec/src/database/sql/sql.go:933 +0x43\ndatabase/sql.(*DB).Query(0x0, 0x421cb10, 0x17, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0)\n    /usr/local/Cellar/go/1.4.2/libexec/src/database/sql/sql.go:924 +0xa6\nmain.getNames(0x0, 0x0, 0x0)\n    /Users/kdys/Code/go/src/test/main.go:32 +0x94\nmain.main()\n    /Users/kdys/Code/go/src/test/main.go:21 +0x188\n\ngoroutine 5 [chan receive]:\ndatabase/sql.(*DB).connectionOpener(0xc20802e000)\n    /usr/local/Cellar/go/1.4.2/libexec/src/database/sql/sql.go:589 +0x4c\ncreated by database/sql.Open\n    /usr/local/Cellar/go/1.4.2/libexec/src/database/sql/sql.go:452 +0x31c\n\ngoroutine 17 [syscall, locked to thread]:\nruntime.goexit()\n    /usr/local/Cellar/go/1.4.2/libexec/src/runtime/asm_amd64.s:2232 +0x1\n</code></pre>\n\n<p>What i'm doing wrong here ?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1427744028, "post_id": 29354257, "comment_id": 46894412, "body": "Set it to a string whose value is not <code>&quot;activity&quot;</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1327717"}, "edited": false, "score": 1, "creation_date": 1427744295, "post_id": 29354257, "comment_id": 46894572, "body": "I&#39;m just curious why did you copy pasted code you don&#39;t understand, because you definitely copy-pasted this code if you are clueless what is that ObjectType. And that validation is on ObjectType, not on ActivityType. It&#39;s pretty obvious you will want at least a positive and a negative test for ObjectType. So perhaps you want a version where you put the value &quot;activity&quot; and one which is not &quot;activity.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 485, "user_id": 3699672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/de7910fbb4b15bd89e7604b7ac021649?s=128&d=identicon&r=PG&f=1", "display_name": "chipmunk", "link": "https://stackoverflow.com/users/3699672/chipmunk"}, "edited": false, "score": 0, "creation_date": 1427911674, "post_id": 29365774, "comment_id": 46971546, "body": "Thank you! I am new to Go and this helped me rectify the error. Thanks."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1427912897, "last_edit_date": 1427912897, "creation_date": 1427795876, "answer_id": 29365774, "question_id": 29354257, "link": "https://stackoverflow.com/questions/29354257/testing-the-go-model/29365774#29365774", "title": "Testing the Go model", "body": "<p>The <code>ObjectReference.ObjectType</code> is a field of type <code>string</code>. That being said you can initialize it with an expression of type <code>string</code>. The most basic/simple expression of type <code>string</code> is a string literal such as <code>\"hello\"</code>.</p>\n\n<p>Since in your test code you compare it to the value <code>\"activity\"</code>, I assume that is what you want to initialize it with. You can do that like this:</p>\n\n<pre><code>testObj = models.ObjectReference{\n    IRI: \"http://localhost:8001/launched\",\n    ObjectType: \"activity\",\n    ActivityType: testObjType,\n}\n</code></pre>\n\n<p>But of course you can specify any other values/expressions of type <code>stirng</code>:</p>\n\n<pre><code>testObj = models.ObjectReference{\n    IRI: \"http://localhost:8001/launched\",\n    ObjectType: \"NOT-AN-ACTIVITY\",\n    ActivityType: testObjType,\n}\n</code></pre>\n"}], "owner": {"reputation": 485, "user_id": 3699672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/de7910fbb4b15bd89e7604b7ac021649?s=128&d=identicon&r=PG&f=1", "display_name": "chipmunk", "link": "https://stackoverflow.com/users/3699672/chipmunk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1427912897, "creation_date": 1427742517, "question_id": 29354257, "link": "https://stackoverflow.com/questions/29354257/testing-the-go-model", "title": "Testing the Go model", "body": "<p>So this is one of my Go models:</p>\n\n<pre><code>type ObjectReference struct {\nIRI           string    `json:\"iri\" bson:\"iri\"`\nObjectType    string    `json:\"objectType\" bson:\"objectType,omitempty\"`\nActivityType  string    `json:\"activityType,omitempty\" bson:\"activityType,omitempty\"`\nErrors                  `bson:\"-\"`\n</code></pre>\n\n<p>}</p>\n\n<p>I have a validation on the ActivityType as:</p>\n\n<pre><code>   objTypeSuccess := o.ObjectType == \"activity\"\nsuccess = success &amp;&amp; objTypeSuccess\nif (!objTypeSuccess) {\n    o.errors = append(o.errors, \"Object objectType supplied : \" + o.ObjectType + \" is invalid. Valid object types are : [activity]\")\n}\n</code></pre>\n\n<p>where </p>\n\n<pre><code>o *ObjectReference is in the func() definition \n</code></pre>\n\n<p>I am trying to write a test as so:</p>\n\n<pre><code>        testObj = models.ObjectReference{\n        // Invalid Obj Type\n        IRI: \"http://localhost:8001/launched\",\n        ObjectType: ????,\n        ActivityType: testObjType,\n    }\n</code></pre>\n\n<p>I don't quite understand how I could initialize the <code>ObjectType</code> in my testObj. Can someone help me with this?</p>\n"}, {"tags": ["go", "yaml"], "answers": [{"tags": [], "owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "is_accepted": true, "score": 2, "last_activity_date": 1427745456, "creation_date": 1427745456, "answer_id": 29355142, "question_id": 29353542, "link": "https://stackoverflow.com/questions/29353542/golang-iterate-over-data-to-unmarshal-multiple-yaml-structures/29355142#29355142", "title": "GoLang - Iterate over data to unmarshal multiple YAML structures", "body": "<p>A simple change to accomplish what you want is to have the data in the <code>yaml</code> be items in an array, then Unmarshal into a slice of <code>Container</code></p>\n\n<pre><code>var data = `\n- first: first value\n  second:\n    nested1: GET\n    nested2: /bin/bash\n    nested3: /usr/local/bin/customscript\n    nested4: 8080\n\n- first: second value\n  second:\n    nested1: POST\n    nested2: /bin/ksh\n    nested3: /usr/local/bin/customscript2\n    nested4: 8081\n`\n\nfunc main() {\n\n    container := []Container{}\n\n    err := yaml.Unmarshal([]byte(data), &amp;container)\n    if err != nil {\n        log.Fatalf(\"error: %v\", err)\n    }\n    fmt.Printf(\"---values found:\\n%+v\\n\\n\", container)\n\n}\n\n---values found:\n[{First:first value Second:{Nested1:GET Nested2:/bin/bash Nested3:/usr/local/bin/customscript Nested4:8080}} {First:second value Second:{Nested1:POST Nested2:/bin/ksh Nested3:/usr/local/bin/customscript2 Nested4:8081}}]\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 1576172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/be484182ed21e6989c05254b01d57b34?s=128&d=identicon&r=PG", "display_name": "gt-info", "link": "https://stackoverflow.com/users/1576172/gt-info"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1979, "favorite_count": 0, "accepted_answer_id": 29355142, "answer_count": 1, "score": 0, "last_activity_date": 1551864190, "creation_date": 1427740145, "last_edit_date": 1551864190, "question_id": 29353542, "link": "https://stackoverflow.com/questions/29353542/golang-iterate-over-data-to-unmarshal-multiple-yaml-structures", "title": "GoLang - Iterate over data to unmarshal multiple YAML structures", "body": "<p>I am fairly new to Golang, please excuse my newbyness.</p>\n\n<p>I am currently using yaml.v2 package (<a href=\"https://github.com/go-yaml/yaml\" rel=\"nofollow noreferrer\">https://github.com/go-yaml/yaml</a>) to unmarshal YAML data into structs. </p>\n\n<p>Consider the following example code:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"gopkg.in/yaml.v2\"\n  \"log\"\n)\n\ntype Container struct {\n  First  string\n  Second struct {\n    Nested1 string\n    Nested2 string\n    Nested3 string\n    Nested4 int\n  }\n}\n\nvar data = `\n  first: first value\n  second:\n    nested1: GET\n    nested2: /bin/bash\n    nested3: /usr/local/bin/customscript\n    nested4: 8080\n\n  first: second value\n  second:\n    nested1: POST\n    nested2: /bin/ksh\n    nested3: /usr/local/bin/customscript2\n    nested4: 8081\n`\n\nfunc main() {\n\n  container := Container{}\n\n  err := yaml.Unmarshal([]byte(data), &amp;container)\n  if err != nil {\n    log.Fatalf(\"error: %v\", err)\n  }\n  fmt.Printf(\"---values found:\\n%+v\\n\\n\", container)\n\n}\n</code></pre>\n\n<p>The result:</p>\n\n<pre><code>---values found: {First:second value Second:{Nested1:POST Nested2:/bin/ksh Nested3:/usr/local/bin/customscript2 Nested4:8081}}\n</code></pre>\n\n<p>This is as expected, the unmarshal function finds one occurrence of the YAML data. </p>\n\n<p>What I would like to do is write a simple while/each/for loop that loops through the data variable and marshals all the occurrences into seperate Container structs. How could I achieve this?</p>\n"}, {"tags": ["javascript", "go"], "answers": [{"tags": [], "owner": {"reputation": 5640, "user_id": 1938826, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/gTGEx.jpg?s=128&g=1", "display_name": "an earwig", "link": "https://stackoverflow.com/users/1938826/an-earwig"}, "is_accepted": true, "score": 4, "last_activity_date": 1439164502, "last_edit_date": 1439164502, "creation_date": 1427740278, "answer_id": 29353587, "question_id": 29353509, "link": "https://stackoverflow.com/questions/29353509/calling-golang-functions-from-within-javascript-code/29353587#29353587", "title": "calling Golang functions from within javascript code", "body": "<p>What you are looking for is called AJAX (<strong>A</strong>synchronous <strong>J</strong>avascript <strong>A</strong>nd <strong>X</strong>ml). It is a JavaScript technology that allows you make asynchronous HTTP requests to get data from the servers. It seems that you are using jQuery, and using jQuery with AJAX, would look like this:</p>\n\n<pre><code>$.ajax({\n  url: \"http://www.example.com/signup\",\n  data: {username: \"whatever\"} //If the request needs any data \n}).done(function (data) {\n  // Do whatever with returned data\n});\n</code></pre>\n\n<p>if you want, you can use functions specifically for <code>GET</code> and <code>POST</code>:</p>\n\n<pre><code>$.get(\"url: \"http://www.example.com/signup\", function (data) {\n  // Do whatever with the returned data\n});\n\n$.post(\"url: \"http://www.example.com/signup\", {username: \"whatever\"}, function (data) {\n  // Do whatever with the returned data\n});\n</code></pre>\n\n<p>AJAX can even be performed without jQuery:</p>\n\n<pre><code>var req = new XMLHTTPRequest();\nreq.addEventListener(\"load\", function (data) {// Do whatever});\nreq.open(\"get\", \"http://example.com\", true);\nreq.send();\n</code></pre>\n\n<p>If you need a reference for AJAX, here are a few sites:</p>\n\n<p><strong>jQuery</strong></p>\n\n<p><a href=\"https://api.jquery.com/jQuery.ajax/\" rel=\"nofollow\">https://api.jquery.com/jQuery.ajax/</a></p>\n\n<p><a href=\"https://api.jquery.com/category/ajax/shorthand-methods/\" rel=\"nofollow\">https://api.jquery.com/category/ajax/shorthand-methods/</a></p>\n\n<p><a href=\"https://api.jquery.com/category/ajax/\" rel=\"nofollow\">https://api.jquery.com/category/ajax/</a></p>\n\n<p><strong>Vanilla JavaScript</strong></p>\n\n<p><a href=\"https://developer.mozilla.org/en-US/docs/AJAX/Getting_Started\" rel=\"nofollow\">https://developer.mozilla.org/en-US/docs/AJAX/Getting_Started</a></p>\n\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest\" rel=\"nofollow\">https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest</a></p>\n"}], "owner": {"reputation": 459, "user_id": 1540033, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/275b35f80c93e82aa2c15456fd73b215?s=128&d=identicon&r=PG", "display_name": "mehdix_", "link": "https://stackoverflow.com/users/1540033/mehdix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5889, "favorite_count": 1, "accepted_answer_id": 29353587, "answer_count": 1, "score": 3, "last_activity_date": 1439164502, "creation_date": 1427740030, "question_id": 29353509, "link": "https://stackoverflow.com/questions/29353509/calling-golang-functions-from-within-javascript-code", "title": "calling Golang functions from within javascript code", "body": "<p>I'm working on a webapp which already has a layout css, bootstrap v.3 along with an index.html. I have successfully loaded the project with Golang up and running. I have embedded a signup button which upon click is supposed to call a Go function from within the server.go file that handles http requests.</p>\n\n<pre><code>    $(document).ready(function() {\n    $('#signup').on('click', loginHandler);\n});\n</code></pre>\n\n<p>I have a server.go file written like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n\n    \"github.com/bmizerany/pat\"\n)\n\nfunc init() {\n    m := pat.New()\n\n    m.Get(\"/signup\", http.HandlerFunc(loginHandler))\n    m.Get(\"/\", http.HandlerFunc(rootHandler))\n    http.Handle(\"/\", m)\n}\n\nfunc rootHandler(w http.ResponseWriter, r *http.Request) {\n    http.ServeFile(w, r, r.URL.Path[1:])\n}\n\nfunc loginHandler(w http.ResponseWriter, r *http.Request) {\n\n}\n</code></pre>\n\n<p>So the question is upon click on an button instance with <em>signup Id</em>, how do I have to trigger the golang <em>loginHandler</em> function in server.go file?\nAny idea on this would be appreciated.</p>\n"}, {"tags": ["methods", "go", "comma"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1427740125, "post_id": 29353429, "comment_id": 46892197, "body": "You <i>always</i> run <code>gofmt</code> don&#39;t you? Then it&#39;s not an issue as extraneous commas are removed. Have you looked at the <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">spec</a> to see where they allow this?"}, {"owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427740203, "post_id": 29353429, "comment_id": 46892242, "body": "<a href=\"https://golang.org/ref/spec#Signature\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Signature</a> was reading the spec and I came across it. My question is why...? Why can we do this, what purpose does it serve."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427740302, "post_id": 29353429, "comment_id": 46892304, "body": "IMO, if you&#39;ve done the appropriate research before asking then I think you should include the relevant link(s) in the question itself to (a) make it clear and (b) give interested parties or those trying to answer a place to start."}, {"owner": {"reputation": 139, "user_id": 397547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f59b4b8fb96df7f5f721e715d43175da?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/397547/eric"}, "edited": false, "score": 0, "creation_date": 1458930352, "post_id": 29353429, "comment_id": 60082422, "body": "Trailing commas make it easier to reorder, allows moving the parenthesis to the next line, easier to add a comment the last argument without disrupting the code block brackets, friendlier to version control systems, and easier to write code generators.  Obviously it doesn&#39;t make sense for a one line function declaration."}, {"owner": {"reputation": 139, "user_id": 397547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f59b4b8fb96df7f5f721e715d43175da?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/397547/eric"}, "edited": false, "score": 0, "creation_date": 1458930903, "post_id": 29353429, "comment_id": 60082696, "body": "Golang has style rules you are forced to adhere to (which is why gofmt exists), so I&#39;m not sure why this was closed as primarily opinion based."}], "answers": [{"comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1428755240, "post_id": 29354247, "comment_id": 47304004, "body": "Requiring commas for multi-line literals comes from the semi-colon insertion rules: If the lines wasn&#39;t ending in a comma, a semi-colon would be inserted by the lexer (?)."}, {"owner": {"reputation": 14728, "user_id": 2142577, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/820c611835bb6eea4851c318a3b73345?s=128&d=identicon&r=PG", "display_name": "laike9m", "link": "https://stackoverflow.com/users/2142577/laike9m"}, "edited": false, "score": 0, "creation_date": 1465729597, "post_id": 29354247, "comment_id": 63014730, "body": "Where are the multiline literal rules documented?"}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 5, "last_activity_date": 1427742466, "creation_date": 1427742466, "answer_id": 29354247, "question_id": 29353429, "link": "https://stackoverflow.com/questions/29353429/golang-commas-with-methods-functions/29354247#29354247", "title": "Golang commas with methods/functions", "body": "<p>Golang allows trailing commas after many declarations.</p>\n\n<p>This was likely an explicit design choice by the designers of the language to be more permissive of irrelevant syntax errors; however, only they can explain their motivations.</p>\n\n<pre><code>func (f *Foo,) Bar(x, y int,) (int, error,) { //...\nf.Bar(1, 2, 3,)\nxs := []int{1, 2, 3,}\n</code></pre>\n\n<p>In fact, in some multiline literal declarations it <em>requires</em> trailing commas (presumably to simplify reordering of elements):</p>\n\n<pre><code>ys := []int{\n  1,\n  2, // &lt;-- required comma.\n}\nm := map[string]int{\n  \"foo\": 1,\n  \"bar\": 2, // &lt;-- required comma.\n}\n</code></pre>\n\n<p>Note that the <code>go fmt</code> command automatically removes extraneous, optional trailing commas.  You should <em>always</em> run that tool before building your code.</p>\n"}, {"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 4, "last_activity_date": 1427756590, "creation_date": 1427756590, "answer_id": 29357843, "question_id": 29353429, "link": "https://stackoverflow.com/questions/29353429/golang-commas-with-methods-functions/29357843#29357843", "title": "Golang commas with methods/functions", "body": "<p>When you have a function with many arguments, you some times want to spread the function header over multiple lines like this:</p>\n\n<pre><code>func foo(\n    int arg1,\n    string arg2,\n    []byte arg3,\n    error arg4,\n ) {\n    /* implementation goes here */\n }\n</code></pre>\n\n<p>The trailing comma allows for a more orthogonal way to write down this argument list.</p>\n"}], "owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1166, "favorite_count": 0, "closed_date": 1428575147, "accepted_answer_id": 29354247, "answer_count": 2, "score": 2, "last_activity_date": 1442002899, "creation_date": 1427739779, "last_edit_date": 1442002899, "question_id": 29353429, "link": "https://stackoverflow.com/questions/29353429/golang-commas-with-methods-functions", "closed_reason": "Opinion-based", "title": "Golang commas with methods/functions", "body": "<p>Why are we allowed to put a comma at the end of a receiver in the method declaration, or in the parameter lists or the return lists. Like so: </p>\n\n<pre><code>func (ds *dasa,) yoooooolo (dsa dasa,) (dsaa dasa,) \n</code></pre>\n\n<p>Why is this allowed? All those commas at the end?</p>\n"}, {"tags": ["go", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "edited": false, "score": 0, "creation_date": 1427739303, "post_id": 29353103, "comment_id": 46891732, "body": "Thanks for the answer. I&#39;m aware of what close means and was asking about <code>close(ch)</code> vs <code>ch &lt;- struct{}{}</code>. Do you have some reference that close is a message and not rather a property of the channel?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "edited": false, "score": 0, "creation_date": 1427740337, "post_id": 29353103, "comment_id": 46892322, "body": "@murrekatt: <code>close</code> is a logical message, a special value that promises that no more values will be sent  What do you consider to be a message? A send and a close both just manipulate the internal state of the channel, causing a value to be sent to the receivers."}, {"owner": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "edited": false, "score": 1, "creation_date": 1427787909, "post_id": 29353103, "comment_id": 46909962, "body": "I had a look in the Go source to see what <code>close</code> does and it sets a flag indicating the channel is closed."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1427745456, "last_edit_date": 1427745456, "creation_date": 1427738651, "answer_id": 29353103, "question_id": 29353040, "link": "https://stackoverflow.com/questions/29353040/closing-the-channel-vs-sending-e-g-an-empty-struct/29353103#29353103", "title": "Closing the channel vs. sending e.g. an empty struct?", "body": "<p>closing a channel indicates that there will be no more sends on  that channel. It's usually preferable, since you would get a panic after that point in the case of an inadvertent send or close (programming error). A <code>close</code> also can signal multiple receivers that there are no more messages, which you can't as easily coordinate by just sending sentinel values.</p>\n\n<blockquote>\n  <p>Naturally, sending any other type in the channel takes up \"some\" amount of memory, but how is it with the empty struct?</p>\n</blockquote>\n\n<p>There's no guarantee that it does take any extra memory in an unbuffered channel (it's completely an implementation detail). The send blocks until the receive can proceed.</p>\n\n<blockquote>\n  <p>Close is just part of the channel so not \"sent\" as such even if information is passed between goroutines.</p>\n</blockquote>\n\n<p>There's no optimization here, <code>close</code> is simply another type of message that can be sent to a channel. </p>\n\n<p>Each construct has a clear meaning, and you should use the appropriate one.</p>\n\n<ul>\n<li><p>Send a sentinel value if you need to signal one receiver, and keep the channel open to send more values.</p></li>\n<li><p>Close the channel if this is the final message, possibly signal multiple receivers, and it would be an error to send or close again.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "edited": false, "score": 0, "creation_date": 1427787990, "post_id": 29354346, "comment_id": 46910003, "body": "@Uvelichtiel wouldn&#39;t you use a wait group to signal many to one for completion?"}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "reply_to_user": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "edited": false, "score": 0, "creation_date": 1427802791, "post_id": 29354346, "comment_id": 46918011, "body": "@murrekatt Sync wait group used to wait for all. But you can be interested in only the winner finished. In this case winner should not close the channel in order that outsiders would not panic sending on closed channel. Runners instead should only signal to referee they done and   referee in turn close the competition."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1427742806, "creation_date": 1427742806, "answer_id": 29354346, "question_id": 29353040, "link": "https://stackoverflow.com/questions/29353040/closing-the-channel-vs-sending-e-g-an-empty-struct/29354346#29354346", "title": "Closing the channel vs. sending e.g. an empty struct?", "body": "<p>You can receive from closed channel by multiple goroutines and they will never block. It's a main advantage. It's <em>one_to_many pattern</em>.</p>\n\n<p><code>finish := make(chan struct{})</code> can be used in <em>many_to_one</em> pattern when many concurrent runners want to report things done, and outsider will not <code>panic</code>.</p>\n\n<p>It's not about memory consumption.</p>\n"}], "owner": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3800, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1427745456, "creation_date": 1427738465, "question_id": 29353040, "link": "https://stackoverflow.com/questions/29353040/closing-the-channel-vs-sending-e-g-an-empty-struct", "title": "Closing the channel vs. sending e.g. an empty struct?", "body": "<p>I have a pipeline with goroutines connected by channels so that each goroutine will trigger another one until all have run. Put even simpler, imagine two goroutines <code>A</code> and <code>B</code> so that when <code>A</code> is done it should tell <code>B</code> it can run.</p>\n\n<p>It's working fine and I have tried a few variants as I have learnt more about <a href=\"https://blog.golang.org/pipelines\" rel=\"nofollow\">pipelines in Go</a>.</p>\n\n<p>Currently I have a signalling channel</p>\n\n<pre><code>ch := make(chan struct{})\ngo A(ch)\ngo B(ch)\n...\n</code></pre>\n\n<p>that <code>B</code> blocks on</p>\n\n<pre><code>func B(ch &lt;-chan struct{}) {\n    &lt;-ch\n    ...\n</code></pre>\n\n<p>and <code>A</code> closes when done</p>\n\n<pre><code>func A(ch chan struct{}) {\n    defer close(ch)\n    ...\n}\n</code></pre>\n\n<p>This works fine and I also tried, instead of closing, sending an empty struct <code>struct{}</code> in <code>A()</code>.</p>\n\n<p>Is there any difference between closing the channel or sending the empty struct? Is either way cheaper / faster / better?</p>\n\n<p>Naturally, sending any other type in the channel takes up \"some\" amount of memory, but how is it with the empty struct? Close is just part of the channel so not \"sent\" as such even if information is passed between goroutines.</p>\n\n<p>I'm well aware of premature optimization. This is only to understand things, not to optimize anything. </p>\n\n<p>Maybe there's an idiomatic Go way to do this even?</p>\n\n<p>Thanks for any clarification on this!</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-storage"], "comments": [{"owner": {"reputation": 31187, "user_id": 100142, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/tqqXC.png?s=128&g=1", "display_name": "rein", "link": "https://stackoverflow.com/users/100142/rein"}, "edited": false, "score": 0, "creation_date": 1427762862, "post_id": 29352471, "comment_id": 46901863, "body": "I&#39;m not sure if &quot;parse the bearer from the user request&quot; implies that you are running a web server and that you want to access the user&#39;s Google Cloud Storage account. If so, you may want to familiarize yourself with: <a href=\"https://developers.google.com/accounts/docs/OAuth2WebServer\" rel=\"nofollow noreferrer\">developers.google.com/accounts/docs/OAuth2WebServer</a>"}, {"owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "reply_to_user": {"reputation": 31187, "user_id": 100142, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/tqqXC.png?s=128&g=1", "display_name": "rein", "link": "https://stackoverflow.com/users/100142/rein"}, "edited": false, "score": 0, "creation_date": 1537682121, "post_id": 29352471, "comment_id": 91868778, "body": "@rein learning curve is high just for that token, documentation is not good enough in this case, code in the other hand is more usefull <a href=\"https://github.com/johnbalvin/google-cloud-go/blob/master/storage/resumableUpload.go\" rel=\"nofollow noreferrer\">github.com/johnbalvin/google-cloud-go/blob/master/storage/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 2366390, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/96c5488f6bcd24be881feb689f9e2539?s=128&d=identicon&r=PG", "display_name": "verdverm", "link": "https://stackoverflow.com/users/2366390/verdverm"}, "is_accepted": false, "score": 0, "last_activity_date": 1428390524, "creation_date": 1428390524, "answer_id": 29485802, "question_id": 29352471, "link": "https://stackoverflow.com/questions/29352471/golang-google-storage-resumable-upload-http-401/29485802#29485802", "title": "Golang google storage resumable upload HTTP 401", "body": "<p>I'm having similar difficulties, not sure if your situation is the same as mine. My goal is to </p>\n\n<ol>\n<li>User client uploads meta-data to my server</li>\n<li>Server authenticates and stores in DB</li>\n<li>Server asks Google Cloud Storage for <code>resumabale upload url</code></li>\n<li>Server returns url to client</li>\n<li>Client uses url to upload media to GCS</li>\n</ol>\n\n<p>I'm getting 401 unauthorized returns too. Maybe I'm not setting the headers correctly? or the <code>storage.SignedURL</code> doesn't handle resumable uploads properly...?</p>\n\n<p>I've been able to upload files using a Service Account PEM file</p>\n\n<pre><code>func setGcsFile(c context.Context, fileId string, content []byte) error {\n    expiration := time.Now().Add(time.Second * 30) //expire in 30 seconds\n\n    data, err = ioutil.ReadFile(serviceAccountPEMFilename)\n    if err != nil {\n        fmt.Printf(\"error: %v\", err)\n        panic(err)\n    }\n\n    log.Debugf(c, \"Getting upload url\")\n    opts := &amp;storage.SignedURLOptions{\n        GoogleAccessID: googleAccessID,\n        PrivateKey:     data,\n        Method:         \"PUT\",\n        Expires:        expiration,\n    }\n\n    putURL, err := storage.SignedURL(bucket, fileId, opts)\n    if err != nil {\n        log.Debugf(c, \"%v\", err)\n        return err\n    }\n\n    log.Debugf(c, \"PUT URL : %v\\n\", putURL)\n\n    client := urlfetch.Client(c)\n    req, err := http.NewRequest(\"PUT\", putURL, bytes.NewBuffer(content))\n    res, err := client.Do(req)\n    if err != nil {\n        log.Debugf(c, \"%v\", err)\n        return err\n    }\n    res.Body.Close()\n    log.Debugf(c, \"Response Code: %s\\n\", res.Status)\n    return nil\n}\n</code></pre>\n\n<p>I'm thinking about pulling and modifying the <code>storage.SignedURL</code> function next.</p>\n"}], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 584, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1428390524, "creation_date": 1427736422, "last_edit_date": 1427739478, "question_id": 29352471, "link": "https://stackoverflow.com/questions/29352471/golang-google-storage-resumable-upload-http-401", "title": "Golang google storage resumable upload HTTP 401", "body": "<p>Hey im trying to implement  a resumable upload to cloud storage .</p>\n\n<p>But im getting a    <strong>Status:\"401 Unauthorized\", StatusCode:401</strong></p>\n\n<p>And im assuming  that it`s something with the bearer but i can't figure out  another way to send the bearer Token.</p>\n\n<p>I've been able to delete files with the GetClinet method.   </p>\n\n<pre><code>func GetClinet(c endpoints.Context) *http.Client {\n    cli := &amp;http.Client{\n        Transport: &amp;oauth2.Transport{\n            Source: google.AppEngineTokenSource(c, storage.ScopeReadWrite),\n            Base:   &amp;urlfetch.Transport{Context: c},\n        },\n    }\n\n    return cli\n\n}\n\nclient := GetClinet(con)\n\nurl := \"https://storage.googleapis.com/bucketName/file.txt\"\nb := r.Header.Get(\"Authorization\") //parse the bearer from user request\nr, err = http.NewRequest(\"POST\", url, nil)\nr.Header.Add(\"Content-Type\", \"text/plain\")\nr.Header.Add(\"Content-Length\", \"0\")\nr.Header.Add(\"x-goog-resumable\", \"start\")\nr.Header.Add(\"Authorization\", b)\n\nresp, err := client.Do(r)\n</code></pre>\n"}, {"tags": ["json", "go", "pubnub"], "comments": [{"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1427727079, "post_id": 29348262, "comment_id": 46884275, "body": "Note that the first element of your sample document is not a string (as required by <code>body []string</code>) but instead an array of objects/structs with key &quot;text&quot;..."}, {"owner": {"reputation": 6540, "user_id": 983333, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/af2e20bf7ed9b97f26878bda2d9d3288?s=128&d=identicon&r=PG", "display_name": "vinnylinux", "link": "https://stackoverflow.com/users/983333/vinnylinux"}, "reply_to_user": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1427727893, "post_id": 29348262, "comment_id": 46884861, "body": "Yes, but how do i map an structure like that?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1327717"}, "edited": false, "score": 0, "creation_date": 1427742781, "post_id": 29348262, "comment_id": 46893635, "body": "Everyone should read this: <a href=\"http://talks.golang.org/2015/json.slide#1\" rel=\"nofollow noreferrer\">talks.golang.org/2015/json.slide#1</a>"}], "answers": [{"tags": [], "owner": {"reputation": 19808, "user_id": 1472049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1qeQt.jpg?s=128&g=1", "display_name": "serejja", "link": "https://stackoverflow.com/users/1472049/serejja"}, "is_accepted": false, "score": 0, "last_activity_date": 1427728492, "creation_date": 1427728492, "answer_id": 29349880, "question_id": 29348262, "link": "https://stackoverflow.com/questions/29348262/decoding-pubnub-messages-with-golang-json/29349880#29349880", "title": "Decoding PubNub messages with golang JSON", "body": "<p>You can define <code>UnmarshalJSON</code> on your <code>PubNubMessage</code> to provide custom JSON deserialization. You probably should tweak this a little bit for your purposes, but the general idea is that you just unmarshal this json array into a slice, and then get all necessary parts from it.</p>\n\n<p><a href=\"http://play.golang.org/p/Y1taBYMj8D\" rel=\"nofollow\">Playground example</a> here</p>\n"}, {"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 1, "last_activity_date": 1427733530, "last_edit_date": 1427733530, "creation_date": 1427728502, "answer_id": 29349883, "question_id": 29348262, "link": "https://stackoverflow.com/questions/29348262/decoding-pubnub-messages-with-golang-json/29349883#29349883", "title": "Decoding PubNub messages with golang JSON", "body": "<p>The short answer is that you cannot directly unmarshal a JSON array of non-homogenous types (per your example) into a golang struct.</p>\n\n<p>The long answer is that you should define an <a href=\"https://golang.org/src/encoding/json/decode.go#L81\" rel=\"nofollow\"><code>(m *PubNubMessage) UnmarshalJSON([]byte) error</code> method</a> for your PubNubMessage type which unmarshals the JSON string into an <code>interface{}</code> and then uses type assertions to ensure the expected format and populates the structure.</p>\n\n<p>For example:</p>\n\n<pre><code>type TextMessage struct {\n  Text string\n}\n\ntype PubNubMessage struct {\n  Messages []TextMessage\n  Id       string\n  Channel  string\n}\n\nfunc (pnm *PubNubMessage) UnmarshalJSON(bs []byte) error {\n  var arr []interface{}\n  err := json.Unmarshal(bs, &amp;arr)\n  if err != nil {\n    return err\n  }\n  messages := arr[0].([]interface{}) // TODO: proper type check.\n  pnm.Messages = make([]TextMessage, len(messages))\n  for i, m := range messages {\n    pnm.Messages[i].Text = m.(map[string]interface{})[\"text\"].(string) // TODO: proper type check.\n  }\n  pnm.Id = arr[1].(string) // TODO: proper type check.\n  pnm.Channel = arr[2].(string) // TODO: proper type check.\n  return nil\n}\n\n  // ...\n  jsonStr := `[[{\"text\":\"hey\"},{\"text\":\"ok\"}],\"1231212412423235\",\"channelName\"]`\n  message := PubNubMessage{}\n  err := json.Unmarshal([]byte(jsonStr), &amp;message)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1427741306, "creation_date": 1427741306, "answer_id": 29353877, "question_id": 29348262, "link": "https://stackoverflow.com/questions/29348262/decoding-pubnub-messages-with-golang-json/29353877#29353877", "title": "Decoding PubNub messages with golang JSON", "body": "<p>Your json is a heterogeneous array. You can at least define <code>PubNubMessage</code> as either</p>\n\n<p><code>type PubNubMessage []interface{}</code> and then access data with type assertions <code>text:= (message[0].([]interface {})[0].(map[string]interface {}))[\"text\"].(string)</code>\nworking example <a href=\"https://play.golang.org/p/xhwbE2ora1\" rel=\"nofollow\">https://play.golang.org/p/xhwbE2ora1</a></p>\n\n<p>or <code>type PubNubMessage []json.RawMessage</code> and after <code>json.Unmarshal(jsonBlob, &amp;message)</code> do 'json.Unmarshal(message[0], structured.text)' for each peace separately<br>\n<a href=\"https://play.golang.org/p/TJ0DfiweGo\" rel=\"nofollow\">https://play.golang.org/p/TJ0DfiweGo</a></p>\n"}, {"tags": [], "owner": {"reputation": 2246, "user_id": 274937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d848784d081501a5cba4a2fa7856e965?s=128&d=identicon&r=PG", "display_name": "valyala", "link": "https://stackoverflow.com/users/274937/valyala"}, "is_accepted": false, "score": 0, "last_activity_date": 1527706098, "creation_date": 1527706098, "answer_id": 50611582, "question_id": 29348262, "link": "https://stackoverflow.com/questions/29348262/decoding-pubnub-messages-with-golang-json/50611582#50611582", "title": "Decoding PubNub messages with golang JSON", "body": "<p>It is easier to use alternative to <code>encoding/json</code> packages for parsing JSON arrays with values of distinct types. For instance, give a try to <a href=\"https://github.com/valyala/fastjson\" rel=\"nofollow noreferrer\">fastjson</a>. It easily (and quickly) parses such arrays:</p>\n\n<pre><code>input := `[[{\"text\":\"hey\"}],\"1231212412423235\",\"channelName\"]`\n\nvar p fastjson.Parser\nv, err := p.Parse(input)\nif err != nil {\n    log.Fatal(err)\n}\na := v.GetArray()\nfor _, vv := range a {\n    switch vv.Type() {\n    case fastjson.TypeArray:\n        fmt.Printf(\"array %s\\n\", vv)\n    case fastjson.TypeString:\n        fmt.Printf(\"string %s\\n\", vv)\n    }\n}\n</code></pre>\n\n<p>Additionally <code>fastjson</code> provides handy functions for obtaining only the required fields from JSON:</p>\n\n<pre><code>// get v[0].text as Go byte slice\ntext := v.GetStringBytes(\"0\", \"text\")\n\n// get v[2]\nchannelName := v.Get(\"2\")  // this is the same as v.GetArray()[2]\n</code></pre>\n"}], "owner": {"reputation": 6540, "user_id": 983333, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/af2e20bf7ed9b97f26878bda2d9d3288?s=128&d=identicon&r=PG", "display_name": "vinnylinux", "link": "https://stackoverflow.com/users/983333/vinnylinux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 0, "accepted_answer_id": 29349883, "answer_count": 4, "score": 2, "last_activity_date": 1527706098, "creation_date": 1427724221, "question_id": 29348262, "link": "https://stackoverflow.com/questions/29348262/decoding-pubnub-messages-with-golang-json", "title": "Decoding PubNub messages with golang JSON", "body": "<p>I've been trying to parse this JSON message from PubNub without any luck:</p>\n\n<pre><code>type PubNubMessage struct {\n    body []string\n}\n\n[[{\"text\":\"hey\"}],\"1231212412423235\",\"channelName\"]\njson: cannot unmarshal array into Go value of type main.PubNubMessage\n</code></pre>\n\n<p>Does anyone have an idea on how to decode such complex types in golang?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1327717"}, "edited": false, "score": 0, "creation_date": 1427744897, "post_id": 29347092, "comment_id": 46894917, "body": "Read this <a href=\"http://talks.golang.org/2015/json.slide#1\" rel=\"nofollow noreferrer\">talks.golang.org/2015/json.slide#1</a>"}], "answers": [{"comments": [{"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 14, "creation_date": 1449141727, "post_id": 29347148, "comment_id": 55882420, "body": "Note that this only works if you are sure that your json doesn&#39;t contain any non-string values. Otherwise you have to use <code>map[string]interface{}{}</code>"}, {"owner": {"reputation": 556, "user_id": 157460, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ae8acaa8e78dbafd31a844977bd4b844?s=128&d=identicon&r=PG", "display_name": "f0ster", "link": "https://stackoverflow.com/users/157460/f0ster"}, "edited": false, "score": 2, "creation_date": 1461363772, "post_id": 29347148, "comment_id": 61182280, "body": "This also assumes the struct is only one level deep.. for instance this code won&#39;t work with literals and deeper json on the first level."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 556, "user_id": 157460, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ae8acaa8e78dbafd31a844977bd4b844?s=128&d=identicon&r=PG", "display_name": "f0ster", "link": "https://stackoverflow.com/users/157460/f0ster"}, "edited": false, "score": 1, "creation_date": 1461364808, "post_id": 29347148, "comment_id": 61182610, "body": "@f0ster Yes, which was the asker&#39;s case. For arbitrary depth, see this question: <a href=\"http://stackoverflow.com/questions/28877512/taking-a-json-string-unmarshaling-it-into-a-mapstringinterface-editing-an\">Taking a JSON string, unmarshaling it into a map, editing, and marshaling it again</a>"}, {"owner": {"reputation": 1986, "user_id": 4511560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/X7lzw.jpg?s=128&g=1", "display_name": "Tinkaal Gogoi", "link": "https://stackoverflow.com/users/4511560/tinkaal-gogoi"}, "edited": false, "score": 0, "creation_date": 1487069129, "post_id": 29347148, "comment_id": 71607852, "body": "What will be the scenario when we will have nested json , say temperature also holds other key-values."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1986, "user_id": 4511560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/X7lzw.jpg?s=128&g=1", "display_name": "Tinkaal Gogoi", "link": "https://stackoverflow.com/users/4511560/tinkaal-gogoi"}, "edited": false, "score": 1, "creation_date": 1487069211, "post_id": 29347148, "comment_id": 71607909, "body": "@TinkalGogoi Then unmarshal into a value of type <code>map[string]interface{}</code>, or <code>interface{}</code>. Also see the linked question+answer above your comment."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 50, "last_activity_date": 1513699759, "last_edit_date": 1513699759, "creation_date": 1427721112, "answer_id": 29347148, "question_id": 29347092, "link": "https://stackoverflow.com/questions/29347092/how-to-parse-deserialize-dynamic-json/29347148#29347148", "title": "How to parse/deserialize dynamic JSON", "body": "<p>You can unmarshal into a <code>map[string]string</code> for example:</p>\n\n<pre><code>m := map[string]string{}\nerr := json.Unmarshal([]byte(input), &amp;m)\nif err != nil {\n    panic(err)\n}\nfmt.Println(m)\n</code></pre>\n\n<p>Output (wrapped):</p>\n\n<pre><code>map[Bangalore_City:35_Temperature NewYork_City:31_Temperature\n    Copenhagen_City:29_Temperature]\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/TTm4vJxaNS\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p>This way no matter what the keys or values are, you will have all pairs in a <code>map</code> which you can print or loop over.</p>\n\n<p>Also note that although your example contained only <code>string</code> values, but if the value type is varying (e.g. <code>string</code>, numbers etc.), you may use <code>interface{}</code> for the value type, in which case your map would be of type <code>map[string]interface{}</code>.</p>\n\n<p>Also note that I created a library to easily work with such dynamic objects which may be a great help in these cases: <a href=\"https://github.com/icza/dyno\" rel=\"noreferrer\"><code>github.com/icza/dyno</code></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 833, "user_id": 825489, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/27b4ce861fcad13f3a8b5a0e09a19277?s=128&d=identicon&r=PG", "display_name": "Bean Taxi", "link": "https://stackoverflow.com/users/825489/bean-taxi"}, "edited": false, "score": 23, "creation_date": 1529634527, "post_id": 50611300, "comment_id": 88955451, "body": "You should mention that you are the author of the library you link to (fastjson)"}, {"owner": {"reputation": 4092, "user_id": 112882, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/CJq3e.png?s=128&g=1", "display_name": "Cetin Sert", "link": "https://stackoverflow.com/users/112882/cetin-sert"}, "reply_to_user": {"reputation": 833, "user_id": 825489, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/27b4ce861fcad13f3a8b5a0e09a19277?s=128&d=identicon&r=PG", "display_name": "Bean Taxi", "link": "https://stackoverflow.com/users/825489/bean-taxi"}, "edited": false, "score": 1, "creation_date": 1552636547, "post_id": 50611300, "comment_id": 97093740, "body": "@BeanTaxi why??"}, {"owner": {"reputation": 833, "user_id": 825489, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/27b4ce861fcad13f3a8b5a0e09a19277?s=128&d=identicon&r=PG", "display_name": "Bean Taxi", "link": "https://stackoverflow.com/users/825489/bean-taxi"}, "edited": false, "score": 5, "creation_date": 1552775242, "post_id": 50611300, "comment_id": 97141280, "body": "It&#39;s a common practice to note that you are the author of a library, package etc, when you happen to mention that library, package etc. And it&#39;s classy. I do not believe it&#39;s a requirement."}, {"owner": {"reputation": 4486, "user_id": 1841212, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/369bf24a2357cb876ffb1360eca96ee9?s=128&d=identicon&r=PG", "display_name": "VisualBean", "link": "https://stackoverflow.com/users/1841212/visualbean"}, "edited": false, "score": 10, "creation_date": 1553611453, "post_id": 50611300, "comment_id": 97443681, "body": "Its good practice to list that you are the author, since you might be biased towards something you, yourself wrote."}, {"owner": {"reputation": 13034, "user_id": 489560, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8aab444e4868be6745bf6128112d41cb?s=128&d=identicon&r=PG", "display_name": "Devin Burke", "link": "https://stackoverflow.com/users/489560/devin-burke"}, "edited": false, "score": 3, "creation_date": 1590253190, "post_id": 50611300, "comment_id": 109613919, "body": "The fact this has a downvote presumably for not saying he wrote <code>fastjson</code> is silly. We&#39;re all biased toward our own answers on SO. He just happened to have expressed his answer in the form of a very popular library a long time ago... And we have a voting system to de-risk his bias. Saying you wrote a <i>non-commercial</i> library is a nice practice, but ridiculous to warrant a downvote. (Assuming that was the reason.)"}], "tags": [], "owner": {"reputation": 2246, "user_id": 274937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d848784d081501a5cba4a2fa7856e965?s=128&d=identicon&r=PG", "display_name": "valyala", "link": "https://stackoverflow.com/users/274937/valyala"}, "is_accepted": false, "score": 7, "last_activity_date": 1527704887, "creation_date": 1527704887, "answer_id": 50611300, "question_id": 29347092, "link": "https://stackoverflow.com/questions/29347092/how-to-parse-deserialize-dynamic-json/50611300#50611300", "title": "How to parse/deserialize dynamic JSON", "body": "<p>Standard <code>encoding/json</code> is good for the majority of use cases, but it may be quite slow comparing to alternative solutions. If you need performance, try using <a href=\"https://github.com/valyala/fastjson\" rel=\"noreferrer\">fastjson</a>. It parses arbitrary JSONs without the need for creating structs or maps matching the JSON schema.</p>\n\n<p>See the example code below. It iterates over all the <code>(key, value)</code> pairs of the JSON object:</p>\n\n<pre><code>var p fastjson.Parser\nv, err := p.Parse(input)\nif err != nil {\n    log.Fatal(err)\n}\n\n// Visit all the items in the top object\nv.GetObject().Visit(func(k []byte, v *fastjson.Value) {\n    fmt.Printf(\"key=%s, value=%s\\n\", k, v)\n\n    // for nested objects call Visit again\n    if string(k) == \"nested\" {\n        v.GetObject().Visit(func(k []byte, v *fastjson.Value) {\n            fmt.Printf(\"nested key=%s, value=%s\\n\", k, v)\n        })\n    }\n})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 447, "user_id": 9466501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/132d2cd9be94fd6b7280a98845b91f8f?s=128&d=identicon&r=PG", "display_name": "Lars Christian Jensen", "link": "https://stackoverflow.com/users/9466501/lars-christian-jensen"}, "is_accepted": false, "score": 1, "last_activity_date": 1606740578, "last_edit_date": 1606740578, "creation_date": 1606729909, "answer_id": 65071298, "question_id": 29347092, "link": "https://stackoverflow.com/questions/29347092/how-to-parse-deserialize-dynamic-json/65071298#65071298", "title": "How to parse/deserialize dynamic JSON", "body": "<p>Just to add a general answer to how any valid JSON can be parsed; <code>var m interface{}</code> works for all types. That includes map (which OP asked for) arrays, strings, numbers and nested structures.</p>\n<pre><code>var m interface{}\nerr := json.Unmarshal([]byte(input), &amp;m)\nif err != nil {\n    panic(err)\n}\nfmt.Println(m)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 144, "user_id": 5148187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fY6Bu.jpg?s=128&g=1", "display_name": "Jo&#227;o Wiciuk", "link": "https://stackoverflow.com/users/5148187/jo%c3%a3o-wiciuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1609187540, "creation_date": 1609187540, "answer_id": 65483725, "question_id": 29347092, "link": "https://stackoverflow.com/questions/29347092/how-to-parse-deserialize-dynamic-json/65483725#65483725", "title": "How to parse/deserialize dynamic JSON", "body": "<p>Also consider using gabs package <a href=\"https://github.com/Jeffail/gabs\" rel=\"nofollow noreferrer\">https://github.com/Jeffail/gabs</a></p>\n<p>&quot;Gabs is a small utility for dealing with dynamic or unknown JSON structures in Go&quot;</p>\n"}], "owner": {"reputation": 18920, "user_id": 1933917, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7abf55dbb13da076d7a75637f22a74db?s=128&d=identicon&r=PG", "display_name": "Amol M Kulkarni", "link": "https://stackoverflow.com/users/1933917/amol-m-kulkarni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29379, "favorite_count": 9, "accepted_answer_id": 29347148, "answer_count": 4, "score": 38, "last_activity_date": 1609187540, "creation_date": 1427720952, "last_edit_date": 1566050359, "question_id": 29347092, "link": "https://stackoverflow.com/questions/29347092/how-to-parse-deserialize-dynamic-json", "title": "How to parse/deserialize dynamic JSON", "body": "<p><strong>Scenario:</strong>\n<br/>Consider the following is the JSON :</p>\n\n<pre><code>{\n   \"Bangalore_City\": \"35_Temperature\",\n   \"NewYork_City\": \"31_Temperature\",\n   \"Copenhagen_City\": \"29_Temperature\"\n}\n</code></pre>\n\n<p>If you notice, the data is structured in such a way that there is no hard-coded keys mentioning <code>City</code>/<code>Temperature</code> its basically just values.</p>\n\n<p><strong>Issue:</strong> I am not able to parse any JSON which is dynamic. </p>\n\n<p><strong>Question:</strong> Could anyone have found solution for this kind of JSON parsing? I tried <a href=\"https://github.com/bitly/go-simplejson\" rel=\"noreferrer\">go-simplejson</a>, <a href=\"https://github.com/Jeffail/gabs\" rel=\"noreferrer\">gabs</a> &amp; default <a href=\"http://blog.golang.org/json-and-go\" rel=\"noreferrer\"><code>encoding/json</code></a> but no luck.</p>\n\n<p><strong>Note:</strong> \nThe above JSON is just for sample. And there are lot of applications which are using the current API, So I do not want to change how the data is structured. I mean I can't change to something as follows:</p>\n\n<pre><code>[{\n   \"City_Name\":\"Bangalore\",\n   \"Temperature\": \"35\"\n},...]\n</code></pre>\n\n<p>Then I can define <code>struct</code></p>\n\n<pre><code>type TempData struct {\n  City_Name string\n  Temperature  string\n}\n</code></pre>\n"}, {"tags": ["linux", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1427720906, "post_id": 29346093, "comment_id": 46879896, "body": "Yes, If you create a static binary, it will run on every distro (with a supported kernel). I don&#39;t understand the last part, if you already have a static binary, then what are you asking?"}, {"owner": {"reputation": 22114, "user_id": 328989, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KQ3YE.jpg?s=128&g=1", "display_name": "Datageek", "link": "https://stackoverflow.com/users/328989/datageek"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1427721200, "post_id": 29346093, "comment_id": 46880111, "body": "@JimB, ignore the last bit, I just edited the question. If you can provide a sample example on how to compile a static binary in go I would be happy to accept the answer. In particular I am looking at compaling statically influxdb if that is any help."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1427722184, "post_id": 29346093, "comment_id": 46880795, "body": "If your want to know if it&#39;s possible to make a statically linked influxdb, you should ask that question (though it may be better to ask on an influxdb ML or forum). Depending on all the external dependencies, there may be other steps required if it&#39;s possible."}], "answers": [{"tags": [], "owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "is_accepted": true, "score": 8, "last_activity_date": 1427722087, "creation_date": 1427722087, "answer_id": 29347489, "question_id": 29346093, "link": "https://stackoverflow.com/questions/29346093/how-to-create-a-static-go-binary-which-runs-on-every-distro/29347489#29347489", "title": "How to create a static Go binary which runs on every distro?", "body": "<p>It will work on every Linux distro if you've compiled for GOOS==linux as long as the architecture is supported (amd64/x86 etc.), and the required syscalls are available. This is usually determined by your Linux kernel version.</p>\n"}], "owner": {"reputation": 22114, "user_id": 328989, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KQ3YE.jpg?s=128&g=1", "display_name": "Datageek", "link": "https://stackoverflow.com/users/328989/datageek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 729, "favorite_count": 0, "accepted_answer_id": 29347489, "answer_count": 1, "score": 2, "last_activity_date": 1427790488, "creation_date": 1427718012, "last_edit_date": 1427790488, "question_id": 29346093, "link": "https://stackoverflow.com/questions/29346093/how-to-create-a-static-go-binary-which-runs-on-every-distro", "title": "How to create a static Go binary which runs on every distro?", "body": "<p>How can I create a static Go application that runs on every Linux distribution?</p>\n\n<p>Is it enough just to compile Go statically as in: <a href=\"http://blog.hashbangbash.com/2014/04/linking-golang-statically/\" rel=\"nofollow\">http://blog.hashbangbash.com/2014/04/linking-golang-statically/</a></p>\n"}, {"tags": ["google-app-engine", "file-upload", "go", "http-post"], "comments": [{"owner": {"reputation": 1039, "user_id": 1201422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28b52a61797037f989c609529e16c414?s=128&d=identicon&r=PG", "display_name": "Chris Pushbullet", "link": "https://stackoverflow.com/users/1201422/chris-pushbullet"}, "edited": false, "score": 0, "creation_date": 1430449923, "post_id": 29345117, "comment_id": 48081737, "body": "I&#39;m not sure why you can&#39;t use the blobstore for this.  Why doesn&#39;t it look good? Why not use a POST?"}], "owner": {"reputation": 187, "user_id": 3995228, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3704db62cc1e1967db3ef022eea118f2?s=128&d=identicon&r=PG&f=1", "display_name": "\u017diga Pata\u010dko Koderman", "link": "https://stackoverflow.com/users/3995228/%c5%bdiga-pata%c4%8dko-koderman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1427715129, "creation_date": 1427715129, "question_id": 29345117, "link": "https://stackoverflow.com/questions/29345117/go-gae-and-file-upload-without-having-to-post-form-and-go-to-other-site", "title": "Go GAE and file upload without having to post form and go to other site", "body": "<p>I am trying to make a image upload service with Google App Engine application in Golang.</p>\n\n<p>I have already followed this <a href=\"https://cloud.google.com/appengine/docs/go/blobstore/\" rel=\"nofollow\">tutorial</a>. And it works just fine. However the problem appears when uploading big images, because it takes time and doesn't look good.</p>\n\n<p>I am looking for a way to upload image without having to POST form and recieve the image via other service.</p>\n\n<p>Could anyone please provide me an example of similar site or even a hint.</p>\n\n<p>Thanks in advance :)</p>\n"}, {"tags": ["string", "go", "type-conversion"], "answers": [{"comments": [{"owner": {"reputation": 781, "user_id": 2375505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/322780ece5ae3e7a2604592c45368c08?s=128&d=identicon&r=PG", "display_name": "rpkamp", "link": "https://stackoverflow.com/users/2375505/rpkamp"}, "edited": false, "score": 0, "creation_date": 1427711690, "post_id": 29343446, "comment_id": 46874219, "body": "Makes sense. Thanks for that!"}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1427790818, "post_id": 29343446, "comment_id": 46911398, "body": "<code>error</code> is the <i>only</i> builtin interface. <code>Stringer</code> is the more-normal case."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1443010538, "last_edit_date": 1443010538, "creation_date": 1427710040, "answer_id": 29343446, "question_id": 29342776, "link": "https://stackoverflow.com/questions/29342776/in-go-why-isnt-the-stringer-interface-used-when-casting-to-string/29343446#29343446", "title": "In Go, why isn&#39;t the stringer interface used when casting to string?", "body": "<p>There is no <em>casting</em> in Go, there is type <a href=\"http://golang.org/ref/spec#Conversions\" rel=\"nofollow\">Conversion</a> and <a href=\"http://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">Type assertion</a>.</p>\n\n<p>What you're doing (<code>T(Expression)</code>) is a conversion and it has strict rules when it can be used and what the result will be.</p>\n\n<p>There are specific rules applied to <a href=\"http://golang.org/ref/spec#Conversions_to_and_from_a_string_type\" rel=\"nofollow\">Conversions to and from a string type</a>. So what you want cannot be achieved with type conversion.</p>\n\n<p>The simplest and preferred way would be to call the method yourself:</p>\n\n<pre><code>v := f.String()\n</code></pre>\n\n<p><code>fmt.Sprintf()</code> would be just an unnecessary overhead and complication if your <code>struct</code> already implements <code>Stringer</code>. But if you don't have guarantee for this, then yes, <code>fmt.Sprintf()</code> would be the general way.</p>\n\n<p>You could ask why?</p>\n\n<p>In the specification level the type conversion expression is not defined as the result of a custom/user made function or method. The <code>Stringer</code> interface (<code>type Stringer interface{String() string}</code>) is not even a built-in type in contrast to the <a href=\"http://golang.org/pkg/builtin/#error\" rel=\"nofollow\"><code>error</code></a> interface.</p>\n\n<p>But despite the fact that <code>Stringer</code> is not a built-in type, it is still present in some packages (for example in <a href=\"http://golang.org/pkg/fmt/#Stringer\" rel=\"nofollow\"><code>fmt.Stringer</code></a>) and is checked by various methods or functions (e.g. <a href=\"http://golang.org/pkg/fmt/#Printf\" rel=\"nofollow\"><code>fmt.Printf()</code></a> and relatives).</p>\n"}], "owner": {"reputation": 781, "user_id": 2375505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/322780ece5ae3e7a2604592c45368c08?s=128&d=identicon&r=PG", "display_name": "rpkamp", "link": "https://stackoverflow.com/users/2375505/rpkamp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1050, "favorite_count": 0, "accepted_answer_id": 29343446, "answer_count": 1, "score": 1, "last_activity_date": 1475402569, "creation_date": 1427708062, "last_edit_date": 1475402569, "question_id": 29342776, "link": "https://stackoverflow.com/questions/29342776/in-go-why-isnt-the-stringer-interface-used-when-casting-to-string", "title": "In Go, why isn&#39;t the stringer interface used when casting to string?", "body": "<pre><code>package main\n\ntype foo struct {\n    bar string\n    baz string\n}\n\nfunc (f foo) String() string {\n    return f.bar + \" \" + f.baz\n}\n\nfunc main() {\n    f := foo{\"hello\", \"world\"}\n    v := string(f)\n}\n</code></pre>\n\n<p>This outputs <code>main.go:14: cannot convert f (type foo) to type string</code>.</p>\n\n<p>So it would seem that casting something to a string does not look at the stinger interface. My guess is that this is because casting is implemented on a lower level than the stringer interface and it's impossible/hard to mix the two, but I'm not sure. Can anyone shed any light on this?</p>\n\n<p>Also, since this is not possible, what would be idiomatic way to convert my struct to a string in this case? Do I just call <code>.String()</code> myself, or <code>fmt.Sprintf(\"%s\", f)</code>, or something else?</p>\n"}, {"tags": ["go", "channels"], "answers": [{"comments": [{"owner": {"reputation": 3615, "user_id": 4725175, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/10206540408857078/picture?type=large", "display_name": "Jakob Svenningsson", "link": "https://stackoverflow.com/users/4725175/jakob-svenningsson"}, "edited": false, "score": 1, "creation_date": 1427708502, "post_id": 29342733, "comment_id": 46872428, "body": "Thank you. So when &quot;write&quot; has written to ch, &quot;write2&quot; will wait/block until my &quot;read&quot; function receives the value from &quot;write&quot;?"}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "reply_to_user": {"reputation": 3615, "user_id": 4725175, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/10206540408857078/picture?type=large", "display_name": "Jakob Svenningsson", "link": "https://stackoverflow.com/users/4725175/jakob-svenningsson"}, "edited": false, "score": 2, "creation_date": 1427708740, "post_id": 29342733, "comment_id": 46872560, "body": "Yes, exactly. This way channels can be used to synchronize execution not only to pass data."}, {"owner": {"reputation": 3615, "user_id": 4725175, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/10206540408857078/picture?type=large", "display_name": "Jakob Svenningsson", "link": "https://stackoverflow.com/users/4725175/jakob-svenningsson"}, "edited": false, "score": 0, "creation_date": 1427708813, "post_id": 29342733, "comment_id": 46872598, "body": "Thanks mate! Really appreciate you taking the time!"}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 7, "last_activity_date": 1427707955, "creation_date": 1427707955, "answer_id": 29342733, "question_id": 29342701, "link": "https://stackoverflow.com/questions/29342701/write-to-same-channel-with-multiple-goroutines/29342733#29342733", "title": "Write to same channel with multiple goroutines", "body": "<p>You can write to it again because you read from it. After read operation another write can happen. It does not really matter from which goroutine executes the write or read operation.</p>\n\n<p>The <a href=\"https://golang.org/ref/mem#tmp_7\" rel=\"noreferrer\">Go Memory Management</a> page explains it.</p>\n"}], "owner": {"reputation": 3615, "user_id": 4725175, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/10206540408857078/picture?type=large", "display_name": "Jakob Svenningsson", "link": "https://stackoverflow.com/users/4725175/jakob-svenningsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7011, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1427715607, "creation_date": 1427707839, "last_edit_date": 1427715607, "question_id": 29342701, "link": "https://stackoverflow.com/questions/29342701/write-to-same-channel-with-multiple-goroutines", "title": "Write to same channel with multiple goroutines", "body": "<p>This piece of code work as properly and my question is why. Ive learnt that you can only send one value to an unbuffered channel before its blocked. But in my code i write to it two times, but from different go routines, and it works. Would appreciate if someone could explain to me why! </p>\n\n<pre><code>func main(){\n    var ch chan string =make(chan string)\n     go write(ch)\n     go write2(ch)\n     go read(ch)\n        select{}\n}\n\nfunc write(ch chan string){\n    for{\n        ch&lt;-\"write1\"\n    }\n}\n\nfunc write2(ch chan string){\n    for{\n        ch&lt;-\"write2\"\n    }\n}\n\nfunc read(ch chan string){\n    for{    \n        time.Sleep(time.Second)\n        select{\n            case res:= &lt;-ch: fmt.Println(res)\n            case &lt;-time.After(time.Millisecond*200): fmt.Println(\"time out\")\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["mysql", "database", "go"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 2, "creation_date": 1427704704, "post_id": 29341590, "comment_id": 46870337, "body": "You can <code>Scan</code> the value into a string variable, then get <code>myTime</code> by parsing that string."}, {"owner": {"reputation": 3704, "user_id": 859355, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YHgGT.jpg?s=128&g=1", "display_name": "Vincenzo Maggio", "link": "https://stackoverflow.com/users/859355/vincenzo-maggio"}, "edited": false, "score": 1, "creation_date": 1427705260, "post_id": 29341590, "comment_id": 46870621, "body": "Please add following information: type of database, type of column data"}, {"owner": {"reputation": 877, "user_id": 857429, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/132e09d6d68bad61580fdee8d9485b5b?s=128&d=identicon&r=PG&f=1", "display_name": "Caffeinatedwolf", "link": "https://stackoverflow.com/users/857429/caffeinatedwolf"}, "reply_to_user": {"reputation": 3704, "user_id": 859355, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YHgGT.jpg?s=128&g=1", "display_name": "Vincenzo Maggio", "link": "https://stackoverflow.com/users/859355/vincenzo-maggio"}, "edited": false, "score": 0, "creation_date": 1427706198, "post_id": 29341590, "comment_id": 46871118, "body": "@VincenzoMaggio type of database is mysql, the column is just current_time and id."}], "answers": [{"comments": [{"owner": {"reputation": 8004, "user_id": 973737, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d950f527c72c44682f219f09c6803981?s=128&d=identicon&r=PG", "display_name": "Rich Sutton", "link": "https://stackoverflow.com/users/973737/rich-sutton"}, "edited": false, "score": 3, "creation_date": 1525214422, "post_id": 29343013, "comment_id": 87267729, "body": "Alternatively, you can use a mysql.NullTime in your struct. This will parse the time irrespective of the connection string setting, and has the additional benefit of handling null values correctly."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 54, "last_activity_date": 1427709874, "last_edit_date": 1427709874, "creation_date": 1427708828, "answer_id": 29343013, "question_id": 29341590, "link": "https://stackoverflow.com/questions/29341590/how-to-parse-time-from-database/29343013#29343013", "title": "How to parse time from database", "body": "<p>Assuming you're using the <code>go-sql-driver/mysql</code> you can ask the driver to scan DATE and DATETIME automatically to <code>time.Time</code>, by adding <code>parseTime=true</code> to your connection string.</p>\n\n<p>See <a href=\"https://github.com/go-sql-driver/mysql#timetime-support\">https://github.com/go-sql-driver/mysql#timetime-support</a></p>\n\n<p>Example code:</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"root:@/?parseTime=true\")\nif err != nil {\n    panic(err.Error()) // Just for example purpose. You should use proper error handling instead of panic\n}\ndefer db.Close()\n\nvar myTime time.Time\nrows, err := db.Query(\"SELECT current_timestamp()\")\n\nif rows.Next() {\n    if err = rows.Scan(&amp;myTime); err != nil {\n        panic(err)\n    }\n}\n\nfmt.Println(myTime)\n</code></pre>\n\n<p>Notice that this works with <code>current_timestamp</code> but not with <code>current_time</code>. If you must use <code>current_time</code> you'll need to do the parsing youself.</p>\n\n<h3>This is how you do custom parsing:</h3>\n\n<p>First, we define a custom type wrapping []byte, that will automatically parse time values:</p>\n\n<pre><code>type rawTime []byte\n\nfunc (t rawTime) Time() (time.Time, error) {\n    return time.Parse(\"15:04:05\", string(t))\n}\n</code></pre>\n\n<p>And in the scanning code we just do this:</p>\n\n<pre><code>var myTime rawTime\nrows, err := db.Query(\"SELECT current_time()\")\n\nif rows.Next() {\n    if err = rows.Scan(&amp;myTime); err != nil {\n        panic(err)\n    }\n}\n\nfmt.Println(myTime.Time())\n</code></pre>\n"}], "owner": {"reputation": 877, "user_id": 857429, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/132e09d6d68bad61580fdee8d9485b5b?s=128&d=identicon&r=PG&f=1", "display_name": "Caffeinatedwolf", "link": "https://stackoverflow.com/users/857429/caffeinatedwolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23669, "favorite_count": 9, "accepted_answer_id": 29343013, "answer_count": 1, "score": 25, "last_activity_date": 1597189324, "creation_date": 1427704396, "last_edit_date": 1597189324, "question_id": 29341590, "link": "https://stackoverflow.com/questions/29341590/how-to-parse-time-from-database", "title": "How to parse time from database", "body": "<p>I am using golang and I am trying to read time from mysql and I am getting the following error.</p>\n\n<pre><code>var my_time time.Time\nrows, err := db.Query(\"SELECT current_time FROM table\")\nerr := rows.Scan(&amp;my_time)\n</code></pre>\n\n<p>The error I am getting is </p>\n\n<pre><code> unsupported driver -&gt; Scan pair: []uint8 -&gt; *time.Time\n</code></pre>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["github", "go", "cache-control"], "comments": [{"owner": {"reputation": 3303, "user_id": 941446, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/395ae688093d9074cdbcfabbccb6ce88?s=128&d=identicon&r=PG", "display_name": "Jamesking56", "link": "https://stackoverflow.com/users/941446/jamesking56"}, "edited": false, "score": 0, "creation_date": 1440605068, "post_id": 29340796, "comment_id": 52345411, "body": "Check out <a href=\"http://shields.io\" rel=\"nofollow noreferrer\">shields.io</a> and see how they are serving their images."}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 3, "creation_date": 1427740832, "post_id": 29341006, "comment_id": 46892554, "body": "OP: Of course don&#39;t blindly copy headers like &quot;ETag&quot; from another source. Ideally, read up on caching and how that is controlled via headers so you don&#39;t do something silly/wasteful like prevent all caching for something that only rarely changes or can only change once in some interval."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 3, "last_activity_date": 1427702039, "creation_date": 1427702039, "answer_id": 29341006, "question_id": 29340796, "link": "https://stackoverflow.com/questions/29340796/implementing-github-badges-in-golang/29341006#29341006", "title": "Implementing GitHub Badges in Golang", "body": "<p>Here's what travis are serving for their images:</p>\n\n<pre><code>Age:0\nCache-Control:no-cache\nContent-Length:0\nDate:Mon, 30 Mar 2015 07:49:10 GMT\nETag:\"88e168c2d5cdb30ee9af739765e78e4d\"\nExpires:Mon, 30 Mar 2015 07:49:10 GMT\nKeep-Alive:timeout=10, max=48\nLast-Modified:Wed, 07 Jan 2015 11:26:53 GMT\nTiming-Allow-Origin:https://github.com\nX-Timer:S1427701750.146025,VS0,VE156\n</code></pre>\n\n<p>It might be a good start to try these and see what works.</p>\n"}, {"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": false, "score": 4, "last_activity_date": 1440325779, "creation_date": 1440325779, "answer_id": 32165674, "question_id": 29340796, "link": "https://stackoverflow.com/questions/29340796/implementing-github-badges-in-golang/32165674#32165674", "title": "Implementing GitHub Badges in Golang", "body": "<p>Here is a Github issue about it : <a href=\"https://github.com/github/markup/issues/224\" rel=\"nofollow\">https://github.com/github/markup/issues/224</a></p>\n\n<blockquote>\n  <p>Assets must include Cache-Control: no-cache and ETag headers. If a\n  badge is not updating, then it means they are not properly setting\n  these headers.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>The assets may also need to include either an ETag or Expires header.\n  <a href=\"https://fastly.zendesk.com/entries/23358013-Intro-to-Caching-and-CDNs\" rel=\"nofollow\">Fastly's docs on Cache-Control</a> say that no-cache means \"re-validate\n  before serving this content\", but it doesn't specify what it does to\n  \"re-validate\". I'm guessing it is re-validating, but there's no\n  indication that the asset has changed, so it continues to serves the\n  cached asset.</p>\n  \n  <p>An ETag would be the biggest win, since it would guarantee that the\n  cache gets refreshed when it changes, but still saves bandwidth.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "is_accepted": true, "score": 1, "last_activity_date": 1440734841, "last_edit_date": 1440734841, "creation_date": 1440732816, "answer_id": 32262932, "question_id": 29340796, "link": "https://stackoverflow.com/questions/29340796/implementing-github-badges-in-golang/32262932#32262932", "title": "Implementing GitHub Badges in Golang", "body": "<p>Following <a href=\"https://github.com/badges/shields/commit/f778b9f4f3dce86a97e04301c93bcf2e72b5013a\" rel=\"nofollow\">this commit to shields.io server</a>, I made the following changes to the above code and it works now.</p>\n\n<pre><code>w.Header().Set(\"Date\", date)\nw.Header().Set(\"Expires\", date)\n</code></pre>\n\n<p>For completeness (and in case someone wants to try it out), here's the complete code. (Also on <a href=\"https://github.com/maddyonline/badges\" rel=\"nofollow\">GitHub</a>.)</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"time\"\n)\n\nvar mymap map[string][]byte\n\nvar state bool = false\n\nfunc viewHandler(w http.ResponseWriter, r *http.Request) {\n    date := time.Now().Format(http.TimeFormat)\n    log.Printf(\"%v\", date)\n    log.Printf(\"State %v\", state)\n    state = !state\n    w.Header().Set(\"Content-Type\", \"image/svg+xml\")\n    w.Header().Set(\"Cache-Control\", \"no-cache, no-store, must-revalidate\")\n    w.Header().Set(\"Date\", date)\n    w.Header().Set(\"Expires\", date)\n    if state {\n        w.Write(mymap[\"correct\"])\n    } else {\n        w.Write(mymap[\"wrong\"])\n    }\n}\n\nfunc main() {\n    mymap = make(map[string][]byte)\n    mymap[\"correct\"] = []byte(`&lt;svg xmlns=\"http://www.w3.org/2000/svg\" width=\"104\" height=\"20\"&gt;&lt;linearGradient id=\"b\" x2=\"0\" y2=\"100%\"&gt;&lt;stop offset=\"0\" stop-color=\"#bbb\" stop-opacity=\".1\"/&gt;&lt;stop offset=\"1\" stop-opacity=\".1\"/&gt;&lt;/linearGradient&gt;&lt;mask id=\"a\"&gt;&lt;rect width=\"104\" height=\"20\" rx=\"3\" fill=\"#fff\"/&gt;&lt;/mask&gt;&lt;g mask=\"url(#a)\"&gt;&lt;path fill=\"#555\" d=\"M0 0h54v20H0z\"/&gt;&lt;path fill=\"#4c1\" d=\"M54 0h50v20H54z\"/&gt;&lt;path fill=\"url(#b)\" d=\"M0 0h104v20H0z\"/&gt;&lt;/g&gt;&lt;g fill=\"#fff\" text-anchor=\"middle\" font-family=\"DejaVu Sans,Verdana,Geneva,sans-serif\" font-size=\"11\"&gt;&lt;text x=\"28\" y=\"15\" fill=\"#010101\" fill-opacity=\".3\"&gt;solution&lt;/text&gt;&lt;text x=\"28\" y=\"14\"&gt;solution&lt;/text&gt;&lt;text x=\"78\" y=\"15\" fill=\"#010101\" fill-opacity=\".3\"&gt;correct&lt;/text&gt;&lt;text x=\"78\" y=\"14\"&gt;correct&lt;/text&gt;&lt;/g&gt;&lt;/svg&gt;`)\n    mymap[\"wrong\"] = []byte(`&lt;svg xmlns=\"http://www.w3.org/2000/svg\" width=\"99\" height=\"20\"&gt;&lt;linearGradient id=\"b\" x2=\"0\" y2=\"100%\"&gt;&lt;stop offset=\"0\" stop-color=\"#bbb\" stop-opacity=\".1\"/&gt;&lt;stop offset=\"1\" stop-opacity=\".1\"/&gt;&lt;/linearGradient&gt;&lt;mask id=\"a\"&gt;&lt;rect width=\"99\" height=\"20\" rx=\"3\" fill=\"#fff\"/&gt;&lt;/mask&gt;&lt;g mask=\"url(#a)\"&gt;&lt;path fill=\"#555\" d=\"M0 0h54v20H0z\"/&gt;&lt;path fill=\"#e05d44\" d=\"M54 0h45v20H54z\"/&gt;&lt;path fill=\"url(#b)\" d=\"M0 0h99v20H0z\"/&gt;&lt;/g&gt;&lt;g fill=\"#fff\" text-anchor=\"middle\" font-family=\"DejaVu Sans,Verdana,Geneva,sans-serif\" font-size=\"11\"&gt;&lt;text x=\"28\" y=\"15\" fill=\"#010101\" fill-opacity=\".3\"&gt;solution&lt;/text&gt;&lt;text x=\"28\" y=\"14\"&gt;solution&lt;/text&gt;&lt;text x=\"75.5\" y=\"15\" fill=\"#010101\" fill-opacity=\".3\"&gt;wrong&lt;/text&gt;&lt;text x=\"75.5\" y=\"14\"&gt;wrong&lt;/text&gt;&lt;/g&gt;&lt;/svg&gt;`)\n\n    mux := http.NewServeMux()\n    mux.HandleFunc(\"/view\", viewHandler)\n    log.Println(\"Server started. Listening on 8085...\")\n    http.ListenAndServe(\":8085\", mux)\n}\n</code></pre>\n"}], "owner": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 774, "favorite_count": 0, "accepted_answer_id": 32262932, "answer_count": 3, "score": 5, "last_activity_date": 1440734841, "creation_date": 1427701320, "last_edit_date": 1495541679, "question_id": 29340796, "link": "https://stackoverflow.com/questions/29340796/implementing-github-badges-in-golang", "title": "Implementing GitHub Badges in Golang", "body": "<p>I have asked this question <a href=\"https://stackoverflow.com/questions/28121981/how-to-make-dynamic-github-badges-that-is-images-in-readme-which-change-state\">before</a> and didn't receive satisfactory answer, so this time I'd try to be more specific.</p>\n\n<p>I would like to implement a server in golang which outputs dynamic status updates in the form of svg. (Think \"Build Passing/Failing\" GitHub Badges.) The purpose is that one should be able to embed a link to the server's address in GitHub Readme and the Readme should update automatically depending on the server state.</p>\n\n<p>Here's the golang code that I came up with but it doesn't seem to work with GitHub aggressive caching. Do I need to add more Cache-Control headers? Do I need to add ETag?</p>\n\n<p>I'm using the following to embed the image in GitHub Readme.</p>\n\n<pre><code>[![Mine](http://58dcd0b5.ngrok.com/view)]()\n</code></pre>\n\n<p>Ideally, I would like to see the GitHub Readme change the image every time I load it -- flipping between the two images \"correct\"/\"wrong\". (This is just a proof of concept.)</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    _ \"time\"\n)\nvar mymap map[string][]byte\n\nvar state bool = false\n\n\nfunc viewHandler(w http.ResponseWriter, r *http.Request) {\n    log.Printf(\"State %v\", state)\n    state = !state\n    w.Header().Set(\"Content-Type\", \"image/svg+xml\")\n    w.Header().Set(\"Cache-Control\", \"no-cache, no-store, must-revalidate\")\n    if state {\n        w.Write(mymap[\"correct\"])\n    } else {\n        w.Write(mymap[\"wrong\"])\n    }\n}\n\nfunc main() {\n    mymap = make(map[string][]byte)\n    mymap[\"correct\"] = []byte(`&lt;svg xmlns=\"http://www.w3.org/2000/svg\" width=\"104\" height=\"20\"&gt;&lt;linearGradient id=\"b\" x2=\"0\" y2=\"100%\"&gt;&lt;stop offset=\"0\" stop-color=\"#bbb\" stop-opacity=\".1\"/&gt;&lt;stop offset=\"1\" stop-opacity=\".1\"/&gt;&lt;/linearGradient&gt;&lt;mask id=\"a\"&gt;&lt;rect width=\"104\" height=\"20\" rx=\"3\" fill=\"#fff\"/&gt;&lt;/mask&gt;&lt;g mask=\"url(#a)\"&gt;&lt;path fill=\"#555\" d=\"M0 0h54v20H0z\"/&gt;&lt;path fill=\"#4c1\" d=\"M54 0h50v20H54z\"/&gt;&lt;path fill=\"url(#b)\" d=\"M0 0h104v20H0z\"/&gt;&lt;/g&gt;&lt;g fill=\"#fff\" text-anchor=\"middle\" font-family=\"DejaVu Sans,Verdana,Geneva,sans-serif\" font-size=\"11\"&gt;&lt;text x=\"28\" y=\"15\" fill=\"#010101\" fill-opacity=\".3\"&gt;solution&lt;/text&gt;&lt;text x=\"28\" y=\"14\"&gt;solution&lt;/text&gt;&lt;text x=\"78\" y=\"15\" fill=\"#010101\" fill-opacity=\".3\"&gt;correct&lt;/text&gt;&lt;text x=\"78\" y=\"14\"&gt;correct&lt;/text&gt;&lt;/g&gt;&lt;/svg&gt;`)\n    mymap[\"wrong\"] = []byte(`&lt;svg xmlns=\"http://www.w3.org/2000/svg\" width=\"99\" height=\"20\"&gt;&lt;linearGradient id=\"b\" x2=\"0\" y2=\"100%\"&gt;&lt;stop offset=\"0\" stop-color=\"#bbb\" stop-opacity=\".1\"/&gt;&lt;stop offset=\"1\" stop-opacity=\".1\"/&gt;&lt;/linearGradient&gt;&lt;mask id=\"a\"&gt;&lt;rect width=\"99\" height=\"20\" rx=\"3\" fill=\"#fff\"/&gt;&lt;/mask&gt;&lt;g mask=\"url(#a)\"&gt;&lt;path fill=\"#555\" d=\"M0 0h54v20H0z\"/&gt;&lt;path fill=\"#e05d44\" d=\"M54 0h45v20H54z\"/&gt;&lt;path fill=\"url(#b)\" d=\"M0 0h99v20H0z\"/&gt;&lt;/g&gt;&lt;g fill=\"#fff\" text-anchor=\"middle\" font-family=\"DejaVu Sans,Verdana,Geneva,sans-serif\" font-size=\"11\"&gt;&lt;text x=\"28\" y=\"15\" fill=\"#010101\" fill-opacity=\".3\"&gt;solution&lt;/text&gt;&lt;text x=\"28\" y=\"14\"&gt;solution&lt;/text&gt;&lt;text x=\"75.5\" y=\"15\" fill=\"#010101\" fill-opacity=\".3\"&gt;wrong&lt;/text&gt;&lt;text x=\"75.5\" y=\"14\"&gt;wrong&lt;/text&gt;&lt;/g&gt;&lt;/svg&gt;`)\n\n    mux := http.NewServeMux()\n    mux.HandleFunc(\"/view\", viewHandler)\n    http.ListenAndServe(\":8085\", mux)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 1, "creation_date": 1427685917, "post_id": 29337865, "comment_id": 46863978, "body": "Is <code>~</code> equal to <code>&#47;home&#47;orc</code>? We could assume that but there&#39;s no indication in your question."}, {"owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "edited": false, "score": 0, "creation_date": 1427687260, "post_id": 29337865, "comment_id": 46864253, "body": "show the result of <code>uname -a</code>"}, {"owner": {"reputation": 4052, "user_id": 731647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f1025f04529c68572c09e9f6bfe4e0d?s=128&d=identicon&r=PG", "display_name": "Timofey Stolbov", "link": "https://stackoverflow.com/users/731647/timofey-stolbov"}, "edited": false, "score": 1, "creation_date": 1430820004, "post_id": 29337865, "comment_id": 48214437, "body": "Looks like some shared library is missing. Check <code>ldd $(which go)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1678, "user_id": 1007831, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/124aa665e7e1099f18a3248ca577ac3b?s=128&d=identicon&r=PG", "display_name": "Oussama L.", "link": "https://stackoverflow.com/users/1007831/oussama-l"}, "edited": false, "score": 0, "creation_date": 1607011399, "post_id": 29337963, "comment_id": 115143657, "body": "the gopath did it for me, add <code>export GOPATH=&quot;&#47;home&#47;xxx&#47;go&quot;</code> to your rc file"}], "tags": [], "owner": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 3, "last_activity_date": 1503015945, "last_edit_date": 1503015945, "creation_date": 1427686149, "answer_id": 29337963, "question_id": 29337865, "link": "https://stackoverflow.com/questions/29337865/go-no-such-file-or-directory-but-it-exists/29337963#29337963", "title": "Go: \u201cno such file or directory\u201d but it exists", "body": "<p>A couple of things to check, which may come to nothing, but they'll at least rule out things:</p>\n\n<ol>\n<li><p>There's no indication in your question that your current directory is within <code>/home/orc</code>, a simple <code>pwd</code> should clarify that.</p></li>\n<li><p>Can you run the file directly, such as with <code>./go</code> or <code>~/go/bin/go</code>?</p></li>\n<li><p>Is it executable? The output of <code>ls -l</code> should clarify that.</p></li>\n<li><p>Get the <em>full</em> machine details with <code>uname -a</code>.</p></li>\n<li><p>Check the system executables in case it's somehow not 64-bit, despite the indication: <code>file $(which ls)</code>.</p></li>\n<li><p>Make sure there's no funny characters in the path that would prevent it being picked up there: <code>echo $PATH | od -xcb</code>.</p></li>\n<li><p>Make sure your <code>GOPATH</code> is set up correctly (not sure this would affect <code>go version</code> but it's something extra to try).</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 1519, "user_id": 506016, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b2ef6443a54b6be94a1c522b67b661a?s=128&d=identicon&r=PG&f=1", "display_name": "MondayPaper", "link": "https://stackoverflow.com/users/506016/mondaypaper"}, "edited": false, "score": 2, "creation_date": 1444505023, "post_id": 31411191, "comment_id": 53935928, "body": "Thanks, the whole &quot;amd&quot; part kept me from grabbing the 64 bit version. But I realize that it&#39;s not referring to my chipset. This saved me a lot of time."}], "tags": [], "owner": {"reputation": 196, "user_id": 2022394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vEuHM.png?s=128&g=1", "display_name": "PJeffes", "link": "https://stackoverflow.com/users/2022394/pjeffes"}, "is_accepted": false, "score": 9, "last_activity_date": 1436888280, "creation_date": 1436888280, "answer_id": 31411191, "question_id": 29337865, "link": "https://stackoverflow.com/questions/29337865/go-no-such-file-or-directory-but-it-exists/31411191#31411191", "title": "Go: \u201cno such file or directory\u201d but it exists", "body": "<p>Have you checked that you have the correct version for your architecture installed. I have just had this exact problem when I put a 32-bit binary on a 64-bit virtual machine. I removed the 32-bit version and installed the architecture appropriate version (based on the instructions on the website) and it worked. Hope that works for you too.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7537658, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154375320702759/picture?type=large", "display_name": "Joe Shakely", "link": "https://stackoverflow.com/users/7537658/joe-shakely"}, "is_accepted": false, "score": 1, "last_activity_date": 1585000175, "creation_date": 1585000175, "answer_id": 60822018, "question_id": 29337865, "link": "https://stackoverflow.com/questions/29337865/go-no-such-file-or-directory-but-it-exists/60822018#60822018", "title": "Go: \u201cno such file or directory\u201d but it exists", "body": "<p>For me this was the answer, this is on ubuntu18.04 windows subsystem linux 2 install:</p>\n\n<p><code>export GOPATH=$HOME/go</code></p>\n\n<p><code>export PATH=$PATH:/usr/local/go/bin:$GOPATH/bin</code></p>\n"}], "owner": {"reputation": 81, "user_id": 3514212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fa2a1c0e0bd1971319cb5da4799c5c0?s=128&d=identicon&r=PG&f=1", "display_name": "user3514212", "link": "https://stackoverflow.com/users/3514212/user3514212"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12173, "favorite_count": 0, "answer_count": 3, "score": 7, "last_activity_date": 1585000175, "creation_date": 1427685445, "last_edit_date": 1427770911, "question_id": 29337865, "link": "https://stackoverflow.com/questions/29337865/go-no-such-file-or-directory-but-it-exists", "title": "Go: \u201cno such file or directory\u201d but it exists", "body": "<p>I installed the golang. </p>\n\n<pre><code>~/go/bin$ ls\ngo  godoc  gofmt\n</code></pre>\n\n<p>Trying to test, but to no avail.</p>\n\n<pre><code>~/go/bin$ go version\n-bash: /home/orc/go/bin/go: no such file or directory\n</code></pre>\n\n<p>My $PATH:</p>\n\n<pre><code>/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/home/orc/go/bin:\n</code></pre>\n\n<p>Info:</p>\n\n<pre><code>~/go/bin$ uname -m\nx86_64\n\n~/go/bin$ file go\ngo: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), not stripped\n\n~/go/bin$ pwd\n/home/orc/go/bin\n</code></pre>\n\n<p>Please tell me what's wrong?</p>\n\n<p>UPDATE</p>\n\n<pre><code>~/go/bin$ ls -l\n\u0438\u0442\u043e\u0433\u043e 28688\n-rwxr-xr-x 1 orc orc 9571864 \u0424\u0435\u0432 18 14:40 go\n-rwxr-xr-x 1 orc orc 16164032 \u0424\u0435\u0432 18 14:41 godoc\n-rwxr-xr-x 1 orc orc 3594712 \u0424\u0435\u0432 18 14:40 gofmt\n\n~/go/bin$ ./go\n-bash: ./go: \u041d\u0435\u0442 \u0442\u0430\u043a\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430 \u0438\u043b\u0438 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430\n</code></pre>\n\n<p><strong>!!!</strong></p>\n\n<pre><code>~/go/bin$ file $(which ls)\n/bin/ls: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.18, stripped\n\n~/go/bin$ uname -a\nLinux olimp-web 2.6.32-5-amd64 #1 SMP Mon Jun 13 05:49:32 UTC 2011 x86_64 GNU/Linux\n</code></pre>\n\n<p>Please explain how to fix it?</p>\n"}, {"tags": ["model-view-controller", "go", "beego"], "answers": [{"comments": [{"owner": {"reputation": 886, "user_id": 1619524, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b4c576b8a343b40cd00f38be1513a92d?s=128&d=identicon&r=PG", "display_name": "user1619524", "link": "https://stackoverflow.com/users/1619524/user1619524"}, "edited": false, "score": 0, "creation_date": 1525538874, "post_id": 33011746, "comment_id": 87400525, "body": "Is there a way to use bootstrap css with the forms ? Otherwise the generated form is very basic html, thank you."}], "tags": [], "owner": {"reputation": 472, "user_id": 2064183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9d0065dda5ffd11d5c0f516fc2bce5?s=128&d=identicon&r=PG", "display_name": "Kyaw Myint Thein", "link": "https://stackoverflow.com/users/2064183/kyaw-myint-thein"}, "is_accepted": true, "score": 7, "last_activity_date": 1444310474, "last_edit_date": 1444310474, "creation_date": 1444296448, "answer_id": 33011746, "question_id": 29336869, "link": "https://stackoverflow.com/questions/29336869/beego-creating-model-form-and-orm/33011746#33011746", "title": "Beego - Creating Model Form and ORM", "body": "<p>In controller\uff1a</p>\n\n<pre><code>func (this *AddController) Get() {\n   this.Data[\"Form\"] = &amp; UserProfile{}\n   this.TplNames = \"index.tpl\"\n</code></pre>\n\n<p>}</p>\n\n<p>In template :</p>\n\n<pre><code>&lt;form action=\"\" method=\"post\"&gt;\n    {{.Form | renderform}}\n&lt;/form&gt;\n</code></pre>\n"}], "owner": {"reputation": 1234, "user_id": 2648166, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000141011214/picture?type=large", "display_name": "Siddharth Gupta", "link": "https://stackoverflow.com/users/2648166/siddharth-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 0, "accepted_answer_id": 33011746, "answer_count": 1, "score": 2, "last_activity_date": 1444310474, "creation_date": 1427677053, "question_id": 29336869, "link": "https://stackoverflow.com/questions/29336869/beego-creating-model-form-and-orm", "title": "Beego - Creating Model Form and ORM", "body": "<p>I have created a model using the following code: </p>\n\n<pre><code>type UserProfile struct {\n    Id                  int             `orm:\"auto\"`\n    Name                string          `orm:\"size(100)\"`\n    Email               string          `orm:\"size(100)\"`\n    Type                string          `orm:\"size(30)\"`\n    Admin               bool\n    Car                 []*Car          `orm:\"reverse(many)\"`\n}\n</code></pre>\n\n<p>Is there any way I can render a form directly using this structure? I think <code>valid:required</code> rakes care of validation, but how do we control form rendering.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1681650"}, "edited": false, "score": 0, "creation_date": 1427682197, "post_id": 29337084, "comment_id": 46863037, "body": "Thank you for a working example. Not sure why I didn&#39;t think of moving the avoid bit into a separate function to simplify things."}, {"owner": {"reputation": 1905, "user_id": 84291, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f6b16fbd761468cc4d0e4d1eaf29f12d?s=128&d=identicon&r=PG", "display_name": "Hejazzman", "link": "https://stackoverflow.com/users/84291/hejazzman"}, "edited": false, "score": 0, "creation_date": 1427781998, "post_id": 29337084, "comment_id": 46907165, "body": "In any case you could also do it without moving the avoid in a separate function..."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 0, "last_activity_date": 1427680368, "last_edit_date": 1427680368, "creation_date": 1427678971, "answer_id": 29337084, "question_id": 29336792, "link": "https://stackoverflow.com/questions/29336792/golang-string-comparison-with-slices/29337084#29337084", "title": "GoLang string comparison with Slices", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n)\n\nfunc avoid(name string) bool {\n    profiles := []string{\"Administrator\", \"Default\", \"Public\"}\n    for _, p := range profiles {\n        if name == p {\n            return true\n        }\n    }\n    return false\n}\n\nfunc main() {\n    gcomputer := \"localhost\"\n    location := fmt.Sprintf(\"\\\\\\\\%s\\\\c$\\\\Users\\\\\", gcomputer)\n    files, err := ioutil.ReadDir(location)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    for _, f := range files {\n        if f.IsDir() &amp;&amp; !avoid(f.Name()) {\n            dpath := location + f.Name()\n            fmt.Println(dpath)\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1681650"}, "edited": false, "score": 0, "creation_date": 1427808232, "post_id": 29356537, "comment_id": 46920729, "body": "I was thinking about using a map for this, I appreciate you adding a map example for my current problem. Thank you."}], "tags": [], "owner": {"reputation": 81, "user_id": 1745676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bc4cc2f44f8f8b4d711a3ba8a225fae?s=128&d=identicon&r=PG", "display_name": "TheDorkKnight", "link": "https://stackoverflow.com/users/1745676/thedorkknight"}, "is_accepted": false, "score": 1, "last_activity_date": 1427750494, "creation_date": 1427750494, "answer_id": 29356537, "question_id": 29336792, "link": "https://stackoverflow.com/questions/29336792/golang-string-comparison-with-slices/29356537#29356537", "title": "GoLang string comparison with Slices", "body": "<p>If your list of strings to avoid gets bigger, you might not want to be iterating over them for every directory. Might I suggest a small modification to @peterSO's answer:</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"io/ioutil\"\n)\n\nvar avoidanceSet = map[string]bool{\n    \"Administrator\": true,\n    \"Default\": true,\n    \"Public\": true,\n}\n\nfunc avoid(name string) bool {\n    _, inSet := avoidanceSet[name]\n    return inSet\n}\n\nfunc main() {\n    gcomputer := \"localhost\"\n    location := fmt.Sprintf(\"\\\\\\\\%s\\\\c$\\\\Users\\\\\", gcomputer)\n    files, err := ioutil.ReadDir(location)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    for _, f := range files {\n        if f.IsDir() &amp;&amp; !avoid(f.Name()) {\n            dpath := location + f.Name()\n            fmt.Println(dpath)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1681650"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1135, "favorite_count": 1, "accepted_answer_id": 29337084, "answer_count": 2, "score": 0, "last_activity_date": 1427750494, "creation_date": 1427676380, "question_id": 29336792, "link": "https://stackoverflow.com/questions/29336792/golang-string-comparison-with-slices", "title": "GoLang string comparison with Slices", "body": "<p>I'm able to get a list of files and folders from a directory, I've written a function called isDir to return True if the path is a directory. </p>\n\n<p>Now my problem is that I want to make sure that none of the folders listed match a list of strings in a slice. The code I have might skip the first match but it will print out everything else anyways. I need to process the folders that aren't to be avoided.</p>\n\n<p>Code is for Windows 7/8 directories but I should be able to get a Linux sample working too should one be provided.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n    \"strings\"\n)\n\nfunc isDir(pth string) (bool) {\n         fi, err := os.Stat(pth)\n         if err != nil {\n                 return false\n         }\n         return fi.Mode().IsDir()\n}\n\nfunc main() {\n    gcomputer := \"localhost\"\n    location := fmt.Sprintf(\"\\\\\\\\%s\\\\c$\\\\Users\\\\\", gcomputer)\n    // Profiles to avoid\n    avoid := []string{\"Administrator\", \"Default\", \"Public\"}\n    // walk through files &amp; folders in the directory (location) &amp; return valid profiles\n    files, _ := ioutil.ReadDir(location)\n    for _, f := range files {\n        fdir := []string{location, f.Name()}\n        dpath := strings.Join(fdir, \"\")\n\n        if isDir(dpath) {\n            for _, iavoid := range avoid {\n                for iavoid != f.Name() {\n                    fmt.Println(dpath)\n                    break\n                }\n                break\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I don't mind using a third-party module, I've been working on this too long and starting to lose my cool, making understanding the docs a bit difficult. Any tips would be appreciated. Thank you.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427669570, "post_id": 29335766, "comment_id": 46860058, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/29319883/how-to-return-slice-by-reference\" title=\"how to return slice by reference\">stackoverflow.com/questions/29319883/&hellip;</a>"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427669675, "post_id": 29335766, "comment_id": 46860092, "body": "Don&#39;t use <code>unsafe</code>. You can change what the thing a pointer is pointing at (instead of where it is pointing) by dereferencing it with <code>*</code>. <code>*data = b</code>. Of course you rarely ever need to to pass a pointer to a slice and it&#39;s usually better instead to return a slice (possible modified), ala <code>append</code>."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427670326, "post_id": 29335766, "comment_id": 46860248, "body": "You also are not allocating the <code>data</code> variable so you&#39;re trying to modify what is pointed to by a nil pointer. E.g. <a href=\"https://play.golang.org/p/C6kiW-vbJn\" rel=\"nofollow noreferrer\">play.golang.org/p/C6kiW-vbJn</a>"}, {"owner": {"reputation": 769, "user_id": 294916, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1a9637acaccba514bf6c2cecf80c3f16?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/294916/leon"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427670592, "post_id": 29335766, "comment_id": 46860312, "body": "That&#39;s it. I was missing the new() call. I&#39;ll go read up on that. Thanks for the help Dave! If you&#39;ll post it as an answer I&#39;ll accept it."}], "answers": [{"tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": true, "score": 3, "last_activity_date": 1427687323, "creation_date": 1427687323, "answer_id": 29338110, "question_id": 29335766, "link": "https://stackoverflow.com/questions/29335766/how-to-change-pointer-slice-in-golang/29338110#29338110", "title": "How to change pointer slice in golang", "body": "<p>When you try to update <code>data</code> in <code>fillData</code>, you make two errors. First, you update the pointer rather than what it's pointed to. Second, <code>data</code> is a nil pointer, so writing through that pointer will cause a nil pointer error.</p>\n\n<p>Here's one possible way to write the code. <code>data</code> starts as a zero'ed slice, and gets updated inside <code>fillData</code>. This will copy the slice information (len, cap, and pointer to array) from <code>b</code> to <code>*data</code> which means that <code>data</code> will share information with <code>b</code> (importantly, including sharing the underlying array).</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var data []byte\n    fillData(&amp;data)\n    fmt.Println(data, data[0:5])\n}\n\nfunc fillData(data *[]byte) {\n    b := []byte(\"hello\")\n    *data = b[0:1]\n}\n</code></pre>\n\n<p>Another way would be to have <code>data</code> being a pointer, and updating it. Then you have to pass a double pointer into <code>fillData</code>. That would look like this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var data *[]byte\n    fillData(&amp;data)\n    fmt.Println((*data)[0:5])\n}\n\nfunc fillData(data **[]byte) {\n    b := []byte(\"hello\")\n    *data = &amp;b\n}\n</code></pre>\n\n<p>Finally, the best way to write this code isn't to use pointers at all, and just return the slice. Unlike C or C++, it's rarely needed to use \"output\" parameters to functions. That's because go allows multiple return values.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    data := getData()\n    fmt.Println(data, data[0:5])\n}\n\nfunc getData() []byte {\n    return []byte(\"hello\")[:1]\n}\n</code></pre>\n"}], "owner": {"reputation": 769, "user_id": 294916, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1a9637acaccba514bf6c2cecf80c3f16?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/294916/leon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2039, "favorite_count": 0, "accepted_answer_id": 29338110, "answer_count": 1, "score": 0, "last_activity_date": 1427687323, "creation_date": 1427668630, "last_edit_date": 1427669025, "question_id": 29335766, "link": "https://stackoverflow.com/questions/29335766/how-to-change-pointer-slice-in-golang", "title": "How to change pointer slice in golang", "body": "<p>I'm trying to get a better understanding of go. I created a little exercise for myself: pass a pointer slice to a function and modify it.</p>\n\n<p>This is what I came up with:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"unsafe\"\n)\n\nfunc main() {\n    var data *[]byte\n    fillData(data)\n    fmt.Println((*data)[0:5])\n}\n\nfunc fillData(data *[]byte) {\n    b := []byte(\"hello\")\n    fmt.Println(b[0:5])\n    fmt.Println(string(b[0:5]))\n    data = (*[]byte)(unsafe.Pointer(&amp;b[0]))\n}\n</code></pre>\n\n<p>But it gives an <code>invalid memory address or nil pointer dereference</code> error. I know I wouldn't use something like this in real code but I was just curious how to pass a slice and modify it without returning it.</p>\n\n<p><a href=\"https://play.golang.org/p/_K5ltKKKNV\" rel=\"nofollow\">https://play.golang.org/p/_K5ltKKKNV</a></p>\n"}, {"tags": ["postgresql", "go", "go-gorm"], "comments": [{"owner": {"reputation": 322, "user_id": 1282144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2651343b3621386a780990dc96109c9f?s=128&d=identicon&r=PG", "display_name": "Jasper", "link": "https://stackoverflow.com/users/1282144/jasper"}, "edited": false, "score": 0, "creation_date": 1427663849, "post_id": 29334915, "comment_id": 46858504, "body": "It might be useful to add some example code showing how you add the values to your database. Are you sure you didn&#39;t misspell a variable name and are using an empty variable when inserting Pack_ID?"}, {"owner": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "reply_to_user": {"reputation": 322, "user_id": 1282144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2651343b3621386a780990dc96109c9f?s=128&d=identicon&r=PG", "display_name": "Jasper", "link": "https://stackoverflow.com/users/1282144/jasper"}, "edited": false, "score": 0, "creation_date": 1427663940, "post_id": 29334915, "comment_id": 46858528, "body": "@Jasper, the DB was populated manually with PgAdminIII.  I&#39;ve checked several time and I can see no spelling error.  I&#39;m new to postgres, however, is there a way for me to dump relevant summary information about the table?"}, {"owner": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "reply_to_user": {"reputation": 322, "user_id": 1282144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2651343b3621386a780990dc96109c9f?s=128&d=identicon&r=PG", "display_name": "Jasper", "link": "https://stackoverflow.com/users/1282144/jasper"}, "edited": false, "score": 0, "creation_date": 1427664043, "post_id": 29334915, "comment_id": 46858561, "body": "@Jasper, there is one (potentially) relevant difference in the column name and the struct name, however.  In postgres, the column is called <code>pack_id</code>, but in the go code, it&#39;s called <code>Pack_ID</code>.  That said, shouldn&#39;t the <code>db:pack_id</code> declaration keep me out of trouble?  (Edit:  Please see the screenshot above)"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1427664600, "post_id": 29334915, "comment_id": 46858752, "body": "Don&#39;t you mean <code>.Where(&quot;uuid = $1&quot;, uuid).First(&amp;c)</code> given that Postgres&#39; uses <code>$1, $2, $3, etc</code> and not <code>?</code> for parameterisation?"}, {"owner": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1427664800, "post_id": 29334915, "comment_id": 46858813, "body": "@elithrar, Probably :)  What&#39;s the difference, exactly?  In any case I&#39;ve made the changes but my original problem persists."}], "answers": [{"tags": [], "owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "is_accepted": true, "score": 5, "last_activity_date": 1427671093, "last_edit_date": 1427671093, "creation_date": 1427669872, "answer_id": 29335958, "question_id": 29334915, "link": "https://stackoverflow.com/questions/29334915/why-is-the-value-of-my-database-column-always-0/29335958#29335958", "title": "Why is the value of my database column always 0?", "body": "<p>The struct tags you're using appear to be malformed.  A struct tag <a href=\"http://golang.org/pkg/reflect/#StructTag\" rel=\"nofollow\">should be of the form</a>:</p>\n\n<pre><code>name:\"value\"\n</code></pre>\n\n<p>but what you've got is missing the quotes around the value:</p>\n\n<pre><code>name:value\n</code></pre>\n\n<p>Try correcting this.  Otherwise, the struct tag parser in Go has no chance to work, as it depends on those quotes, <a href=\"http://golang.org/src/reflect/type.go?s=21589:21632#L752\" rel=\"nofollow\">as seen in the struct tag parser implementation</a>.</p>\n\n<p>With regards to specific struct tags: are you sure you're supposed to use <code>db</code>?  According to the <a href=\"https://github.com/jinzhu/gorm#existing-schema\" rel=\"nofollow\">Gorm documentation</a>, you probably want to use <code>gorm:\"column:...\"</code>.  I was expecting your type definition to be:</p>\n\n<pre><code>type Chip struct {\n    UUID    string `gorm:\"column:uuid;primary_key\"`\n    URL     string `gorm:\"column:url\"`\n    N       int    `gorm:\"column:n\"`\n    Pack_ID int    `gorm:\"column:pack_id\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "accepted_answer_id": 29335958, "answer_count": 1, "score": 0, "last_activity_date": 1427671093, "creation_date": 1427663678, "last_edit_date": 1427664232, "question_id": 29334915, "link": "https://stackoverflow.com/questions/29334915/why-is-the-value-of-my-database-column-always-0", "title": "Why is the value of my database column always 0?", "body": "<p>I'm using go-gorm to fetch values from a PostgreSQL database.  The relevant code is shown below:</p>\n\n<pre><code>type Chip struct {\n    UUID    string `db:uuid`\n    URL     string `db:url`\n    N       int    `db:n`\n    Pack_ID int    `db:pack_id`\n}\n\nfunc getChip(uuid string) (Chip, error) {\n    var c Chip\n    err := DB.Model(Chip{}).Where(\"uuid = ?\", uuid).First(&amp;c)\n    return c, err.Error\n}\n</code></pre>\n\n<p>When I pass a UUID string to <code>getChip</code>, the correct row is returned and all values are correct <strong>except</strong> for <code>c.Pack_ID</code>, which is always <code>0</code>.  Incidentally there is never a row for which <code>Pack_ID</code> is <code>0</code>.</p>\n\n<p>Here is a screenshot from pgAdminIII, which I hope will shed some light on the problem:</p>\n\n<p><img src=\"https://i.stack.imgur.com/cxC4f.png\" alt=\"enter image description here\"></p>\n\n<p>Any ideas as to what might be going wrong?  I'm at a complete loss, here...</p>\n"}, {"tags": ["http", "go", "connection"], "answers": [{"comments": [{"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "edited": false, "score": 0, "creation_date": 1427665882, "post_id": 29334924, "comment_id": 46859125, "body": "I&#39;m using httputil.NewSingleHostReverseProxy to construct a proxy, which exposes transport options but only for the upstream. The problems I am having are downstream, they need to be set on the http.Server object that uses the ReverseProxy as a handler. http.Server does not expose transport."}], "tags": [], "owner": {"reputation": 939, "user_id": 4648046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932ac0b92feea46110e78577f7047c74?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy R.", "link": "https://stackoverflow.com/users/4648046/eddy-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1427664131, "last_edit_date": 1427664131, "creation_date": 1427663747, "answer_id": 29334924, "question_id": 29334407, "link": "https://stackoverflow.com/questions/29334407/creating-an-idle-timeout-in-go/29334924#29334924", "title": "Creating an idle timeout in Go?", "body": "<p>See the <a href=\"http://golang.org/pkg/net/http/#Transport\" rel=\"nofollow\">net/http.Transport</a> docs. The Transport type has some options for dealing with idle HTTP connections in the keep-alive state. From reading your question, the option that seems most relevant to your problem is the MaxIdleConnsPerHost field:</p>\n\n<blockquote>\n  <p>MaxIdleConnsPerHost, if non-zero, controls the maximum idle (keep-alive) to keep per-host.  If zero, DefaultMaxIdleConnsPerHost is used.</p>\n</blockquote>\n\n<p>Reading the code, the default is 2 per host.</p>\n\n<p>The Transport type also has a method to zap all idle connections: CloseIdleConnections.</p>\n\n<blockquote>\n  <p>CloseIdleConnections closes any connections which were previously connected from previous requests but are now sitting idle in a \"keep-alive\" state. It does not interrupt any connections currently in use.</p>\n</blockquote>\n\n<p>You can specify a Transport on any http client:</p>\n\n<pre><code>tr := &amp;http.Transport{\n    TLSClientConfig:    &amp;tls.Config{RootCAs: pool},\n    DisableCompression: true,\n    MaxIdleConnsPerHost: 1,\n}\nclient := &amp;http.Client{Transport: tr}\nresp, err := client.Get(\"https://example.com\")\n</code></pre>\n\n<p>Another thing worth noting: the docs recommend that you keep a single http client object that is re-used across all your requests (i.e. like a global variable).</p>\n\n<blockquote>\n  <p>Clients and Transports are safe for concurrent use by multiple goroutines and for efficiency should only be created once and re-used.</p>\n</blockquote>\n\n<p>If you are creating many http client objects in your proxy implementation, it might explain unbounded growth of idle connections (just guessing at how you might be implementing this, though).</p>\n\n<p>EDIT: Reading a little bit more, the net/httputil package has some convenience types for reverse proxies. See the <a href=\"http://golang.org/pkg/net/http/httputil/#ReverseProxy\" rel=\"nofollow\">ReverseProxy type</a>. That struct also allows you to supply your own Transport object, allowing you to control your proxy's idle client behavior via this helper type.</p>\n"}, {"comments": [{"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "edited": false, "score": 0, "creation_date": 1427668156, "post_id": 29334926, "comment_id": 46859717, "body": "This fixes the upstream issue but we\u2019d also like to not potentially cut off an active uploader."}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "edited": false, "score": 0, "creation_date": 1427671052, "post_id": 29334926, "comment_id": 46860438, "body": "Oooo interesting. Thank you! Let me investigate."}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "edited": false, "score": 0, "creation_date": 1427680224, "post_id": 29334926, "comment_id": 46862571, "body": "Did I correctly set the timeouts by writing it like this? <code>c.SetReadDeadline(time.Now().Add(time.Duration(config.Downst&zwnj;&#8203;reamIdleTimeoutMs) * time.Millisecond))</code> where <code>config.DownstreamIdleTimeoutMs</code> is an <code>int</code>, say <code>2500</code> for instance?"}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "edited": false, "score": 0, "creation_date": 1427680405, "post_id": 29334926, "comment_id": 46862608, "body": "And as a follow up, now that I&#39;m setting them separately, I can remove <code>ReadTimeout: serverIdleTimeout,</code> from <code>http.Server</code> correct?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "edited": false, "score": 1, "creation_date": 1427848351, "post_id": 29334926, "comment_id": 46941417, "body": "Yeah, you can remove the server timeout."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1427670756, "last_edit_date": 1427670756, "creation_date": 1427663755, "answer_id": 29334926, "question_id": 29334407, "link": "https://stackoverflow.com/questions/29334407/creating-an-idle-timeout-in-go/29334926#29334926", "title": "Creating an idle timeout in Go?", "body": "<p>The proper way to hangup idle connections in the Go http server is to set the <a href=\"http://godoc.org/net/http#Server.ReadTimeout\" rel=\"nofollow\">read timeout</a>. </p>\n\n<p>It is not necessary to set the write timeout to hang up on idle clients. Don't set this value or adjust it up if it's cutting off responses.</p>\n\n<p>If you have long uploads, then use <a href=\"http://godoc.org/net/http#Server.ConnState\" rel=\"nofollow\">a connection state callback</a> to implement separate idle and read timeouts:</p>\n\n<pre><code>server.ConnState = func(c net.Conn, cs http.ConnState) {\n    switch cs {\n    case http.StateIdle, http.StateNew:\n        c.SetReadDeadline(time.Now() + idleTimeout)\n    case http.StateActive:\n        c.SetReadDeadline(time.Now() + activeTimeout)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4121, "favorite_count": 2, "accepted_answer_id": 29334926, "answer_count": 2, "score": 1, "last_activity_date": 1427670756, "creation_date": 1427660620, "last_edit_date": 1427669076, "question_id": 29334407, "link": "https://stackoverflow.com/questions/29334407/creating-an-idle-timeout-in-go", "title": "Creating an idle timeout in Go?", "body": "<p>I use CloudFlare for one of my high volume websites, and it sits in front of my stack. </p>\n\n<p>The thing is CloudFlare leaves idle connections open in addition to creating new ones, and it's not a setting I can change. </p>\n\n<p>When I have Varnish or Nginx sitting in front listening on port 80 they have out of the box configuration to hang up the idle connections. </p>\n\n<p>This is fine until I had to add a proxy written in Go to the front of my stack. It uses the <code>net/http</code> standard library. </p>\n\n<p>I'm not a Go wizard but based on what people are telling me there are only read and write timeout settings but not hanging up idle connections. </p>\n\n<p>Now my server will fill up with connections and die unless I set a set read and write timeouts, but the problem with this is my backend takes a long time sometimes and it's causing good requests to be cut off when they shouldn't. </p>\n\n<p>What is the proper way to handle idle connections with Go http? </p>\n\n<p><strong>Edit 1:</strong> To be more clear, I'm using <code>httputil.NewSingleHostReverseProxy</code> to construct a proxy, which exposes transport options but only for the upstream. The problems I am having are downstream, they need to be set on the <code>http.Server</code> object that uses the ReverseProxy as a handler. <code>http.Server</code> does not expose transport.</p>\n\n<p><strong>Edit 2:</strong> I would prefer an idle timeout to a read timeout, since the later would apply to an active uploader.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["multithreading", "web", "go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1427656343, "last_edit_date": 1427656343, "creation_date": 1427655919, "answer_id": 29333524, "question_id": 29333132, "link": "https://stackoverflow.com/questions/29333132/go-language-web-framework-design-thread-wise/29333524#29333524", "title": "go language web framework design thread wise", "body": "<p>The net/http server uses one goroutine per connection as stated in the <a href=\"http://godoc.org/net/http#Serve\" rel=\"nofollow\">documentation</a>.</p>\n"}], "owner": {"reputation": 267, "user_id": 3142398, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-IvPGTvqHRnQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oj_LM08CHikNlfbLewdR2yCc6P6g/mo/photo.jpg?sz=128", "display_name": "Amit Shani", "link": "https://stackoverflow.com/users/3142398/amit-shani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1427656343, "creation_date": 1427653934, "question_id": 29333132, "link": "https://stackoverflow.com/questions/29333132/go-language-web-framework-design-thread-wise", "title": "go language web framework design thread wise", "body": "<p>What is the threading design of GO net/http library?\nI heard <a href=\"https://www.youtube.com/watch?v=cN_DpYBzKso\" rel=\"nofollow\">this talk</a> a few days ago and I was really curious about how GO developers implemented their web framework design, thread wise.\nI know node.js uses 1 Computational thread reading events and a pool of I/O threads. ASP.NET uses a thread per call... how does GO handle the C10K problem?</p>\n"}, {"tags": ["types", "go"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 4, "last_activity_date": 1427657026, "last_edit_date": 1495540862, "creation_date": 1427655684, "answer_id": 29333486, "question_id": 29332879, "link": "https://stackoverflow.com/questions/29332879/golang-underlying-types/29333486#29333486", "title": "Golang underlying types", "body": "<p>The <a href=\"https://golang.org/ref/spec#Types\" rel=\"nofollow noreferrer\">spec mentions</a>:</p>\n\n<blockquote>\n  <p>Each type <code>T</code> has an underlying type: If <code>T</code> is one of the predeclared boolean, numeric, or string types, or a type literal, the corresponding underlying type is <code>T</code> itself.<br>\n  <strong>Otherwise, <code>T</code>'s underlying type is the underlying type of the type to which <code>T</code> refers in its type declaration</strong>. </p>\n</blockquote>\n\n<p><code>T2</code> refers in its type declaration to <code>T1</code>, which has the underlying type <code>string</code>.</p>\n\n<p>It is important for the underlying type of <code>T2</code> to be <code>string</code>, because it will help for <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">Assignability</a> where</p>\n\n<blockquote>\n  <p>A value x is assignable to a variable of type T (\"x is assignable to T\")<br>\n  x's type V and T have identical underlying types and at least one of V or T is not a <a href=\"https://golang.org/ref/spec#Types\" rel=\"nofollow noreferrer\">named type</a>. </p>\n</blockquote>\n\n<p>This is also detailed in \"<a href=\"https://stackoverflow.com/a/19334952/6309\">Golang: Why can I type alias functions and use them without casting?</a>\"</p>\n\n<hr>\n\n<p>When it comes to the underlying type of <code>T4</code>, we are talking about an underlying unnamed type <code>[]T1</code>.</p>\n\n<p>And again, the assignability rule says you can assign <code>[]T1</code> to T4 (since <code>[]T1</code> is not a named type): its underlying type stops at the first not-named type (<code>[]T1</code>).</p>\n\n<p>See <a href=\"https://play.golang.org/p/Bt3dKBB63L\" rel=\"nofollow noreferrer\">this example on playground</a></p>\n\n<pre><code>var t3 T3 = []T1{\"a\", \"b\"}\nfmt.Println(\"t3='%+v'\", t3)\n// var t4 T4 = []string{}\n// cannot use []string literal (type []string) as type T4 in assignment\nvar t4 T4 = T4(t3)\nfmt.Println(\"t4='%+v'\", t4)\nt4 = []T1{T1(\"c\"), T1(\"d\")}\nfmt.Println(\"t4='%+v'\", t4)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>t3='%+v' [a b]\nt4='%+v' [a b]\nt4='%+v' [c d]\n</code></pre>\n"}], "owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2491, "favorite_count": 1, "accepted_answer_id": 29333486, "answer_count": 1, "score": 3, "last_activity_date": 1427657026, "creation_date": 1427652710, "last_edit_date": 1427656063, "question_id": 29332879, "link": "https://stackoverflow.com/questions/29332879/golang-underlying-types", "title": "Golang underlying types", "body": "<p>In this code snippet from the spec</p>\n\n<pre><code>type T1 string\ntype T2 T1\ntype T3 []T1\ntype T4 T3\n</code></pre>\n\n<p>The spec says: </p>\n\n<blockquote>\n  <p>The underlying type of string, <code>T1</code>, and <code>T2</code> is <code>string</code>.<br>\n  The underlying type of <code>[]T1</code>, <code>T3</code>, and <code>T4</code> is <code>[]T1</code>.</p>\n</blockquote>\n\n<p>Why is the underlying type of <code>T2</code> not <code>T1</code>, but <code>string</code>?<br>\nShouldn't the underlying type of <code>T4</code> instead be <code>[]string</code> and not <code>[]T1</code> if the underlying type of <code>T1</code> is <code>string</code>?<br>\nConfused.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1427644601, "post_id": 29330263, "comment_id": 46851811, "body": "The correct way is to return two values"}, {"owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "edited": false, "score": 1, "creation_date": 1427651856, "post_id": 29330263, "comment_id": 46854405, "body": "For those downvoting, at the very least provide some feedback so the OP knows what to fix in their question."}], "answers": [{"comments": [{"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1427652899, "post_id": 29332840, "comment_id": 46854797, "body": "I wrote i complete rest api with Gorilla But for some reason i  couldn&#39;t figur out the Concurrency   part of go  thanks allot"}, {"owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "reply_to_user": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1427653277, "post_id": 29332840, "comment_id": 46854941, "body": "No problem, I&#39;m not sure if you wanted to execute both MethodA and MethodB concurrently from each other. The code you provided will execute them serially in a different goroutine, if you want to execute them concurrently from each other I&#39;d separate them in different goroutines."}], "tags": [], "owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "is_accepted": true, "score": 0, "last_activity_date": 1427652474, "creation_date": 1427652474, "answer_id": 29332840, "question_id": 29330263, "link": "https://stackoverflow.com/questions/29330263/golang-most-efficient-way-to-invoke-methods-together/29332840#29332840", "title": "Golang most efficient way to invoke method`s together", "body": "<p>In Go, it's idiomatic to return the two values and check for nil against the error</p>\n\n<p>For example:</p>\n\n<pre><code>func myFunc(sm SomeStruct) (MyStruct, error) {\n  s, err := sm.MethodA()\n  if err != nil {\n    return nil, err\n  }\n  if err := sm.MethodB(); err != nil {\n    return nil, err\n  }\n\n  return s, nil \n}\n</code></pre>\n\n<p>One thing to note, is that you're running your function in a <code>goroutine</code>. Any return value inside that goroutine won't be returned to your main goroutine. </p>\n\n<p>In order to get the return values for that go routine you must use channels that will wait for the values.</p>\n\n<p>In your case</p>\n\n<pre><code>errChan := make(chan error)\nretChan := make(chan SomeStructType)\n\ngo func() {\n    myVal, err := sm.MethodA()\n    if err != nil {\n        errChan &lt;- err\n        return\n    }\n\n    if err := sm.MethodB(); err != nil {\n        errChan &lt;- err\n        return\n    }\n\n    retChan &lt;- myVal\n}()\n\nselect {\ncase err := &lt;-errChan:\n    fmt.Println(err)\ncase val := &lt;-retChan:\n    fmt.Printf(\"My value: %v\\n\", val)\n}\n</code></pre>\n\n<p>You can mess around with it here to make more sense out of it: </p>\n\n<p><a href=\"http://play.golang.org/p/TtfFIZerhk\" rel=\"nofollow\">http://play.golang.org/p/TtfFIZerhk</a></p>\n"}], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 29332840, "answer_count": 1, "score": -3, "last_activity_date": 1427652474, "creation_date": 1427638907, "last_edit_date": 1427647674, "question_id": 29330263, "link": "https://stackoverflow.com/questions/29330263/golang-most-efficient-way-to-invoke-methods-together", "title": "Golang most efficient way to invoke method`s together", "body": "<p>im looking for the most efficient way to invoke couple of method \ntogether.</p>\n\n<p>Basically what im trying  to to is invoke those method together and if something went wrong return error else   return the struct Type.</p>\n\n<p>This code is working but i can't get the struct type or error and im not sure if its the correct way. </p>\n\n<pre><code>go func()(struct,err) {\n        struct,err= sm.MethodA()//return struct type or error\n         err = sm.MethodB()//return error or nill\nreturn struct,err\n    }()\n</code></pre>\n"}, {"tags": ["go", "xml-parsing"], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427653409, "post_id": 29332718, "comment_id": 46854996, "body": "FYI, it may have been <a href=\"http://stackoverflow.com/a/29319185/55504\">my failure</a> to remember the <code>golang.org&#47;x&#47;net&#47;html</code> Go project package that lead to the OP using <code>encoding&#47;xml</code>. Opps."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 1, "last_activity_date": 1427651815, "creation_date": 1427651815, "answer_id": 29332718, "question_id": 29327863, "link": "https://stackoverflow.com/questions/29327863/parsing-xml-with-go-ignoring-nested-elements/29332718#29332718", "title": "Parsing xml with Go, ignoring nested elements?", "body": "<p>Constder using <a href=\"https://godoc.org/golang.org/x/net/html\" rel=\"nofollow\">specialized package</a> for parsing HTML. In general, HTML is not XML (XHTML 1.0 is, but documents formatted using it are not very common, and that standard has been deprecated).</p>\n\n<p>An even better approach in my opinion&mdash;given your apparent use case,&mdash; would be using <a href=\"https://godoc.org/gopkg.in/xmlpath.v2\" rel=\"nofollow\">XPath</a> to extract the necessary information using a query.</p>\n\n<p>As to the question as stated, I think there's no built-in way to do what you want: the <code>xml.Decoder</code> implements the <code>Skip()</code> method but it only allows you to skip over unneeded content; there's nothing returning \"inner XML\" as is.  You could roll this yourself by using <code>xml.Decoder</code>'s <code>RawToken()</code>: by immediately rendering whatever it returns until it returns something denoting and end element you're looking for (you'll have to implement support for handling nested elements).</p>\n"}, {"tags": [], "owner": {"reputation": 4687, "user_id": 1221132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a5046ae2fcac22bc44c6663a121f0cc8?s=128&d=identicon&r=PG", "display_name": "theva", "link": "https://stackoverflow.com/users/1221132/theva"}, "is_accepted": false, "score": 0, "last_activity_date": 1427789584, "creation_date": 1427789584, "answer_id": 29363746, "question_id": 29327863, "link": "https://stackoverflow.com/questions/29327863/parsing-xml-with-go-ignoring-nested-elements/29363746#29363746", "title": "Parsing xml with Go, ignoring nested elements?", "body": "<p>I found a library that uses the jQuery style of getting html information: <a href=\"http://godoc.org/github.com/PuerkitoBio/goquery\" rel=\"nofollow\">http://godoc.org/github.com/PuerkitoBio/goquery</a></p>\n\n<p>I used that and it solved the problem.</p>\n"}], "owner": {"reputation": 4687, "user_id": 1221132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a5046ae2fcac22bc44c6663a121f0cc8?s=128&d=identicon&r=PG", "display_name": "theva", "link": "https://stackoverflow.com/users/1221132/theva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1427789584, "creation_date": 1427623759, "question_id": 29327863, "link": "https://stackoverflow.com/questions/29327863/parsing-xml-with-go-ignoring-nested-elements", "title": "Parsing xml with Go, ignoring nested elements?", "body": "<p>I am trying to parse a html document with the Golang xml parser. I have managed it to extract all the <code>&lt;li&gt;</code>elements but if the element contains a link <code>&lt;a&gt;</code>, then the content of the link is ignored. I would like to just ignore the nested <code>&lt;a&gt;</code> and display it's content as plain text but I don't know how.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>d := xml.NewDecoder(resp.Body)\nd.Strict = false\nd.AutoClose = xml.HTMLAutoClose\nd.Entity = xml.HTMLEntity\n\ntype list_item struct {\n    Data string `xml:\",chardata\"`\n}\n\nfor {\n    t,_ := d.Token()\n    if t == nil {\n        break\n    }\n\n    switch se := t.(type) {\n    case xml.StartElement:\n        if se.Name.Local == \"li\" {\n            var q list_item\n            d.DecodeElement(&amp;q, &amp;se)\n\n            c.Infof(\"%+v\\n\", q)\n\n        }\n    }\n}\n</code></pre>\n\n<p>Is there any way to just ignore nested elements and display their content?</p>\n"}, {"tags": ["arrays", "json", "go"], "comments": [{"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1427608326, "post_id": 29325956, "comment_id": 46842592, "body": "Do you get any error?  Can you post it ?"}, {"owner": {"reputation": 123, "user_id": 4331378, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OYJCQXQmc0s/AAAAAAAAAAI/AAAAAAAAACI/aJhgtBBX7qg/photo.jpg?sz=128", "display_name": "surfin Array", "link": "https://stackoverflow.com/users/4331378/surfin-array"}, "reply_to_user": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1427608984, "post_id": 29325956, "comment_id": 46842702, "body": "no, I get the response it looks like this: <code>2015&#47;03&#47;29 01:01:14 [{University of Phoenix CS Club Johnny Ive Johhny.Ive@uop.edu President } {University of San Francisco Marketing club steve jobs steven.job@uop.edu Student }]</code>"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427609380, "post_id": 29325956, "comment_id": 46842754, "body": "Field names don&#39;t match (e.g. you have <code>json:&quot;entity_title_name&quot;</code> but your json has &quot;entitiy_title&quot;, and <code>createUserArray</code> vs <code>array</code>); some fields have the wrong type (e.g. your <code>MsgBodyId string</code> but the JSON has a number; struct tags shouldn&#39;t contain spaces (e.g. remove the space from <code>json:&quot;msg_body_id, omitempty&quot;</code>) \u2026 etc \u2026"}], "answers": [{"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 10, "last_activity_date": 1427609501, "last_edit_date": 1427609501, "creation_date": 1427609259, "answer_id": 29326193, "question_id": 29325956, "link": "https://stackoverflow.com/questions/29325956/parsing-a-json-array-of-json-objects/29326193#29326193", "title": "Parsing a JSON array of JSON objects?", "body": "<p>Try this as your structs,</p>\n\n<pre><code>type MsgCreateUserArray struct {\n    CreateUser []MsgCreateUserJson `json:\"array\"`\n}\n\ntype MsgCreateUserJson struct {\n    EntityOrgName     string  `json:\"entity_org_name\"`\n    EntityTitle       string  `json:\"entity_title\"`\n    MsgBodyID         int64   `json:\"msg_body_id,omitempty\"`\n    PosibbleUserEmail string  `json:\"posibble_user_email\"`\n    PossibleUserName  string  `json:\"possible_user_name\"`\n    UserPositionTitle string  `json:\"user_position_title\"`\n}\n</code></pre>\n\n<p>Your <code>entity_title_name</code> is not named correctly, nor is the top level <code>array</code>.  After you decode into a <code>MsgCreateUserArray</code> you can iterate over the <code>CreateUser</code> slice to get each <code>MsgCreateUserJson</code> </p>\n"}], "owner": {"reputation": 123, "user_id": 4331378, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OYJCQXQmc0s/AAAAAAAAAAI/AAAAAAAAACI/aJhgtBBX7qg/photo.jpg?sz=128", "display_name": "surfin Array", "link": "https://stackoverflow.com/users/4331378/surfin-array"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12565, "favorite_count": 2, "accepted_answer_id": 29326193, "answer_count": 1, "score": 8, "last_activity_date": 1565533944, "creation_date": 1427607043, "last_edit_date": 1565533944, "question_id": 29325956, "link": "https://stackoverflow.com/questions/29325956/parsing-a-json-array-of-json-objects", "title": "Parsing a JSON array of JSON objects?", "body": "<p>I am trying to get each JSON object out of a JSON array. I get this data via a HTTP post.</p>\n\n<p>I know what my data will look like:</p>\n\n<pre><code>   {\n    \"array\":[\n       {\n          \"entity_title\":\"University of Phoenix\", \n          \"entity_org_name\":\"CS Club\",\n          \"possible_user_name\":\"Johnny Ive\",\n          \"posibble_user_email\":\"Johhny.Ive@uop.edu\",\n          \"user_position_title\":\"President\",\n          \"msg_body_id\":4\n       },\n      {\n          \"entity_title\":\"University of San Francisco\", \n          \"entity_org_name\":\"Marketing club\",\n          \"possible_user_name\":\"steve jobs\",\n          \"posibble_user_email\":\"steven.job@uop.edu\",\n          \"user_position_title\":\"Student\",\n          \"msg_body_id\":5\n      }\n    ]\n  }\n</code></pre>\n\n<p>My example code and my structs look like this:</p>\n\n<pre><code>    type MsgCreateUserArray struct {\n         CreateUser []MsgCreateUserJson `json:\"createUserArray\"`\n    }\n    type MsgCreateUserJson struct {\n        EntityTitleName string  `json:\"entity_title_name\"`\n        EntityOrgName   string  `json:\"entity_org_name\"`\n        PossibleUserName string `json:\"possible_user_name\"`\n        PossibleUserEmail   string  `json:\"possible_user_email\"`\n        UserPositionTitle   string  `json:\"user_position_title\"`\n        MsgBodyId       string  `json:\"msg_body_id, omitempty\"` \n    }\n\n\nfunc parseJson(rw http.ResponseWriter, request *http.Request) {\n    decodeJson := json.NewDecoder(request.Body)\n\n    var msg MsgCreateUserArray\n    err := decodeJson.Decode(&amp;msg)\n\n    if err != nil {\n        panic(err)\n    }\n    log.Println(msg.CreateUser)\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", parseJson)\n    http.ListenAndServe(\":1337\", nil)\n}\n</code></pre>\n\n<p>I am not sure where how to iterate over the JSON array and get the JSON objects and then just work with the JSON objects.</p>\n"}, {"tags": ["unix", "go"], "comments": [{"owner": {"reputation": 61700, "user_id": 5291015, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZFijZ.jpg?s=128&g=1", "display_name": "Inian", "link": "https://stackoverflow.com/users/5291015/inian"}, "edited": false, "score": 1, "creation_date": 1594056686, "post_id": 29324739, "comment_id": 110986921, "body": "See <a href=\"https://stackoverflow.com/a/62759969/5291015\">this answer</a> from <a href=\"https://stackoverflow.com/q/62759448/5291015\">How to get the file system type programmatic for syscall.Mount()</a>"}], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 4619735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0845c531615953b59d2c22b981cf1d71?s=128&d=identicon&r=PG&f=1", "display_name": "Sreekanth Pothanis", "link": "https://stackoverflow.com/users/4619735/sreekanth-pothanis"}, "edited": false, "score": 0, "creation_date": 1427644466, "post_id": 29326405, "comment_id": 46851756, "body": "I went with 1 for now, I will explore 2 &amp; 3 later. Thank you."}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": true, "score": 4, "last_activity_date": 1427611435, "creation_date": 1427611435, "answer_id": 29326405, "question_id": 29324739, "link": "https://stackoverflow.com/questions/29324739/get-blkid-of-an-unmounted-volume-in-go/29326405#29326405", "title": "Get BLKID of an unmounted volume in go", "body": "<p>I don't think there is a native library - I couldn't find one.</p>\n\n<p>I think you've got 3 choices</p>\n\n<ol>\n<li><a href=\"https://golang.org/pkg/os/exec/\" rel=\"nofollow\">Shell out</a> to the <code>blkid</code> utility</li>\n<li>Write a <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow\">cgo</a> interface to <a href=\"https://www.kernel.org/pub/linux/utils/util-linux/v2.21/libblkid-docs/\" rel=\"nofollow\">libblkid</a></li>\n<li>Trawl through the <code>libblkid</code> source and re-implement it in go</li>\n</ol>\n\n<p>1 is very easy.  2 is harder.  3 might be easy depending on exactly which feature of <code>blkid</code> you want.  <code>strace blkid args</code> and seem how many system calls it does to get the result you want to get an idea.</p>\n\n<p>I'd probably go with 1. as <code>blkid</code> is one of the core linux tools which you are guaranteed to have I think.</p>\n"}], "owner": {"reputation": 605, "user_id": 4619735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0845c531615953b59d2c22b981cf1d71?s=128&d=identicon&r=PG&f=1", "display_name": "Sreekanth Pothanis", "link": "https://stackoverflow.com/users/4619735/sreekanth-pothanis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 0, "accepted_answer_id": 29326405, "answer_count": 1, "score": 3, "last_activity_date": 1490195032, "creation_date": 1427593566, "last_edit_date": 1490195032, "question_id": 29324739, "link": "https://stackoverflow.com/questions/29324739/get-blkid-of-an-unmounted-volume-in-go", "title": "Get BLKID of an unmounted volume in go", "body": "<p>I am trying to find out if there is a way to get details of blkid of an unmounted volume, through some native golang library. I am particularly interested in fstype of the volume</p>\n"}, {"tags": ["xml", "go"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 4725333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3539208f9467cedf98733a31ba266e4?s=128&d=identicon&r=PG&f=1", "display_name": "Paul R.", "link": "https://stackoverflow.com/users/4725333/paul-r"}, "edited": false, "score": 0, "creation_date": 1427915157, "post_id": 29346377, "comment_id": 46973507, "body": "Thank you very much!  your example works perfectly.  Gosh I am still confused however, because I only supplied an excert of the xml.  The xml I am trying to parse essentially has a multiples of my above example, back to back in a parent container.  So I will need to create a third struct and parent loop to handle that? correct?  I am a little confused trying to figure out the proper syntax for this."}, {"owner": {"reputation": 39, "user_id": 4725333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3539208f9467cedf98733a31ba266e4?s=128&d=identicon&r=PG&f=1", "display_name": "Paul R.", "link": "https://stackoverflow.com/users/4725333/paul-r"}, "edited": false, "score": 0, "creation_date": 1427924833, "post_id": 29346377, "comment_id": 46978446, "body": "to rephrase the above question, how would it work with multiple results in the xml?  example xml: <a href=\"https://play.golang.org/p/h8mvC4jYgp\" rel=\"nofollow noreferrer\">play.golang.org/p/h8mvC4jYgp</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 39, "user_id": 4725333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3539208f9467cedf98733a31ba266e4?s=128&d=identicon&r=PG&f=1", "display_name": "Paul R.", "link": "https://stackoverflow.com/users/4725333/paul-r"}, "edited": false, "score": 0, "creation_date": 1427930762, "post_id": 29346377, "comment_id": 46980593, "body": "@PaulR. The current <code>Data</code> type in my solution represents a <code>&lt;GetCompetitivePricingForASINResult &gt;</code> tag. So if you have more of it, put a wrapper around it <i>both</i> in the xml and in the Go code."}, {"owner": {"reputation": 39, "user_id": 4725333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3539208f9467cedf98733a31ba266e4?s=128&d=identicon&r=PG&f=1", "display_name": "Paul R.", "link": "https://stackoverflow.com/users/4725333/paul-r"}, "edited": false, "score": 0, "creation_date": 1427932773, "post_id": 29346377, "comment_id": 46981148, "body": "I feel really dumb because I cannot figure this out for the life of me :("}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 39, "user_id": 4725333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3539208f9467cedf98733a31ba266e4?s=128&d=identicon&r=PG&f=1", "display_name": "Paul R.", "link": "https://stackoverflow.com/users/4725333/paul-r"}, "edited": false, "score": 0, "creation_date": 1427933053, "post_id": 29346377, "comment_id": 46981210, "body": "@PaulR. E.g. something like this: <code>type DataWrapper struct {Data []Data `xml:&quot;GetCompetitivePricingForASINResult&quot;`}</code> and in XML: <code>&lt;root&gt;&lt;GetCompetitivePricingForASINResult&gt;&lt;&#47;GetCompetitivePr&zwnj;&#8203;icingForASINResult&gt;&lt;&zwnj;&#8203;GetCompetitivePricin&zwnj;&#8203;gForASINResult&gt;&lt;&#47;Get&zwnj;&#8203;CompetitivePricingFo&zwnj;&#8203;rASINResult&gt;&lt;&#47;root&gt;</code>"}, {"owner": {"reputation": 39, "user_id": 4725333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3539208f9467cedf98733a31ba266e4?s=128&d=identicon&r=PG&f=1", "display_name": "Paul R.", "link": "https://stackoverflow.com/users/4725333/paul-r"}, "edited": false, "score": 0, "creation_date": 1427935452, "post_id": 29346377, "comment_id": 46981822, "body": "opps, I spoke too soon.   I solved it using incorrect source xml..  (still working on the solution.)"}, {"owner": {"reputation": 39, "user_id": 4725333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3539208f9467cedf98733a31ba266e4?s=128&d=identicon&r=PG&f=1", "display_name": "Paul R.", "link": "https://stackoverflow.com/users/4725333/paul-r"}, "edited": false, "score": 0, "creation_date": 1427938648, "post_id": 29346377, "comment_id": 46982546, "body": "nailed it. wow that took forever.  Can&#39;t wait till I am good at Golang!  Thanks again. Much appreciated.  (didn&#39;t use a wrapper)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1471955020, "last_edit_date": 1471955020, "creation_date": 1427718820, "answer_id": 29346377, "question_id": 29324564, "link": "https://stackoverflow.com/questions/29324564/golang-xml-unmarshal-value-overwriting-issue/29346377#29346377", "title": "Golang XML Unmarshal value overwriting issue", "body": "<p><a href=\"http://golang.org/pkg/encoding/xml/#Unmarshal\" rel=\"nofollow\"><code>xml.Unmarshal()</code></a> returns an <code>error</code> which you don't store and don't examine:</p>\n\n<pre><code>xml.Unmarshal([]byte(result), data)\nif (err != nil) {\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>So the <code>err</code> you test in the next line is <strong>not</strong> the result of the <code>xml.Unmarshal()</code> but the same value returned previously by <code>api.GetCompetitivePricingForASIN(asins)</code>.</p>\n\n<p>If you modify it to properly store the result of <code>Unmarshal()</code>:</p>\n\n<pre><code>err = xml.Unmarshal([]byte(result), data)\n</code></pre>\n\n<p>You will get the following error (wrapped):</p>\n\n<pre><code>expected element type &lt;GetCompetitivePricingForASINResponse&gt; but have\n&lt;GetCompetitivePricingForASINResult&gt;\n</code></pre>\n\n<p>Your model doesn't properly describe the XML input. Try the following structure to model the XML (the part you want to take out):</p>\n\n<pre><code>type Data struct {\n    ASIN       string      `xml:\"ASIN,attr\"`\n    SalesRanks []SalesRank `xml:\"Product&gt;SalesRankings&gt;SalesRank\"`\n}\n\ntype SalesRank struct {\n    Pcat string `xml:\"ProductCategoryId\"`\n    Rank string `xml:\"Rank\"`\n}\n</code></pre>\n\n<p>Using this model, you can print the results like this:</p>\n\n<pre><code>for _, item := range data.SalesRanks {\n    fmt.Printf(\"Cat: %s; Rank: %s\\n\", item.Pcat, item.Rank)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Cat: book_display_on_website; Rank: 48661\nCat: 4209; Rank: 31\nCat: 6511974011; Rank: 65\nCat: 16587; Rank: 93\n</code></pre>\n\n<p>Try the complete program on the <a href=\"http://play.golang.org/p/K7cu0d_NEL\" rel=\"nofollow\">Go Playground</a>.</p>\n\n<p>Here is even a more simple and more informative printing:</p>\n\n<pre><code>fmt.Printf(\"%+v\", data)\n</code></pre>\n\n<p>Output (wrapped):</p>\n\n<pre><code>&amp;{ASIN:0547569653 SalesRanks:[{Pcat:book_display_on_website Rank:48661}\n  {Pcat:4209 Rank:31} {Pcat:6511974011 Rank:65} {Pcat:16587 Rank:93}]}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 4725333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3539208f9467cedf98733a31ba266e4?s=128&d=identicon&r=PG&f=1", "display_name": "Paul R.", "link": "https://stackoverflow.com/users/4725333/paul-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1471955020, "creation_date": 1427591672, "last_edit_date": 1427595281, "question_id": 29324564, "link": "https://stackoverflow.com/questions/29324564/golang-xml-unmarshal-value-overwriting-issue", "title": "Golang XML Unmarshal value overwriting issue", "body": "<pre><code>&lt;GetCompetitivePricingForASINResult ASIN=\"0547569653\" status=\"Success\"&gt;\n    &lt;Product xmlns:ns2=\"http://mws.amazonservices.com/schema/Products/2011-10-01/default.xsd\"\n             xmlns=\"http://mws.amazonservices.com/schema/Products/2011-10-01\"&gt;\n        &lt;Identifiers&gt;\n            &lt;MarketplaceASIN&gt;\n                &lt;MarketplaceId&gt;ATVPDKIKX0DER&lt;/MarketplaceId&gt;\n                &lt;ASIN&gt;0547569653&lt;/ASIN&gt;\n            &lt;/MarketplaceASIN&gt;\n        &lt;/Identifiers&gt;\n        &lt;CompetitivePricing&gt;\n            &lt;CompetitivePrices&gt;\n                &lt;CompetitivePrice belongsToRequester=\"false\" condition=\"Used\" subcondition=\"Good\"&gt;\n                    &lt;CompetitivePriceId&gt;2&lt;/CompetitivePriceId&gt;\n                    &lt;Price&gt;\n                        &lt;LandedPrice&gt;\n                            &lt;CurrencyCode&gt;USD&lt;/CurrencyCode&gt;\n                            &lt;Amount&gt;9.95&lt;/Amount&gt;\n                        &lt;/LandedPrice&gt;\n                        &lt;ListingPrice&gt;\n                            &lt;CurrencyCode&gt;USD&lt;/CurrencyCode&gt;\n                            &lt;Amount&gt;9.95&lt;/Amount&gt;\n                        &lt;/ListingPrice&gt;\n                        &lt;Shipping&gt;\n                            &lt;CurrencyCode&gt;USD&lt;/CurrencyCode&gt;\n                            &lt;Amount&gt;0.00&lt;/Amount&gt;\n                        &lt;/Shipping&gt;\n                    &lt;/Price&gt;\n                &lt;/CompetitivePrice&gt;\n            &lt;/CompetitivePrices&gt;\n            &lt;NumberOfOfferListings&gt;\n                &lt;OfferListingCount condition=\"Any\"&gt;113&lt;/OfferListingCount&gt;\n                &lt;OfferListingCount condition=\"Used\"&gt;72&lt;/OfferListingCount&gt;\n                &lt;OfferListingCount condition=\"New\"&gt;41&lt;/OfferListingCount&gt;\n            &lt;/NumberOfOfferListings&gt;\n        &lt;/CompetitivePricing&gt;\n        &lt;SalesRankings&gt;\n            &lt;SalesRank&gt;\n                &lt;ProductCategoryId&gt;book_display_on_website&lt;/ProductCategoryId&gt;\n                &lt;Rank&gt;48661&lt;/Rank&gt;\n            &lt;/SalesRank&gt;\n            &lt;SalesRank&gt;\n                &lt;ProductCategoryId&gt;4209&lt;/ProductCategoryId&gt;\n                &lt;Rank&gt;31&lt;/Rank&gt;\n            &lt;/SalesRank&gt;\n            &lt;SalesRank&gt;\n                &lt;ProductCategoryId&gt;6511974011&lt;/ProductCategoryId&gt;\n                &lt;Rank&gt;65&lt;/Rank&gt;\n            &lt;/SalesRank&gt;\n            &lt;SalesRank&gt;\n                &lt;ProductCategoryId&gt;16587&lt;/ProductCategoryId&gt;\n                &lt;Rank&gt;93&lt;/Rank&gt;\n            &lt;/SalesRank&gt;\n        &lt;/SalesRankings&gt;\n    &lt;/Product&gt;\n&lt;/GetCompetitivePricingForASINResult&gt;\n</code></pre>\n\n<p>I am trying to retrieve the \"Rank\" field only when the ProductCategoryId is equal to \"book_display_on_website\", however, in my current attempt it appears to set it Rank to the last SalesRank Entry (93) (it should be (48661)).  Can someone point me in the right direction?</p>\n\n<p>Is this even possible using this Unmarshal method?  or is something like go-pkg-xmlx or gokogiri required? (I am coming from php and usually use simple_xml_parser on php for this type of stuff.)</p>\n\n<pre><code>type Data struct {\nXMLName xml.Name `xml:\"GetCompetitivePricingForASINResponse\"`\nItem   []Item  `xml:\"GetCompetitivePricingForASINResult\"`\n}\n\ntype Item struct {\nPcat string `xml:\"Product&gt;SalesRankings&gt;SalesRank&gt;ProductCategoryId\"`\nASIN string `xml:\"ASIN,attr\"`\nRank string `xml:\"Product&gt;SalesRankings&gt;SalesRank&gt;Rank\"`\n}\n\n\n    result, err := api.GetCompetitivePricingForASIN(asins)\n\n    if (err != nil) {\n        fmt.Println(err)\n    }\n\n    data := &amp;Data{}\n\n    xml.Unmarshal([]byte(result), data)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    for i := 0; i &lt; len(data.Item); i++ {\n        fmt.Printf(\"%s\\n\", data.Item[i])\n    }\n</code></pre>\n"}, {"tags": ["cookies", "go", "websocket", "gorilla"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1427599061, "post_id": 29324251, "comment_id": 46841280, "body": "Print req.Header to view the headers sent by the client. If the you don&#39;t see the cookie header or it&#39;s malformed in some way, then the problem is with the client library or application."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1427647300, "post_id": 29324251, "comment_id": 46852749, "body": "The server handles the WebSocket handshake as a normal HTTP request up to the point where upgrade is called. The Gorilla package is not in play at the line of code with the auth comment."}, {"owner": {"reputation": 958, "user_id": 2626742, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3376e8297d843faf775b3cee1a906f9a?s=128&d=identicon&r=PG", "display_name": "Cody", "link": "https://stackoverflow.com/users/2626742/cody"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1427660838, "post_id": 29324251, "comment_id": 46857521, "body": "Yup, you were right -- the cookie was malformed and wasn&#39;t being parsed into req.Cookies correctly. Thanks fro the help!"}, {"owner": {"reputation": 1261, "user_id": 22079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a07336bf2b6ecaca5e87cda7b99b9253?s=128&d=identicon&r=PG", "display_name": "Jeff Allen", "link": "https://stackoverflow.com/users/22079/jeff-allen"}, "edited": false, "score": 0, "creation_date": 1454436278, "post_id": 29324251, "comment_id": 58039613, "body": "Please mark this as answered so that it doesn&#39;t show up in the unanswered list. Or delete it entirely, since it is not a Go question in the end."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1455473579, "creation_date": 1455473579, "answer_id": 35395298, "question_id": 29324251, "link": "https://stackoverflow.com/questions/29324251/gorilla-websocket-with-cookie-authentication/35395298#35395298", "title": "Gorilla websocket with cookie authentication", "body": "<p>The server handles the WebSocket handshake as a normal HTTP request up to the point where Upgrade is called. Use whatever authentication you would use for normal HTTP requests. </p>\n\n<p>The Gorilla package is not in play at the line of code with the auth comment.</p>\n"}], "owner": {"reputation": 958, "user_id": 2626742, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3376e8297d843faf775b3cee1a906f9a?s=128&d=identicon&r=PG", "display_name": "Cody", "link": "https://stackoverflow.com/users/2626742/cody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3134, "favorite_count": 0, "accepted_answer_id": 35395298, "answer_count": 1, "score": 7, "last_activity_date": 1455473579, "creation_date": 1427588841, "question_id": 29324251, "link": "https://stackoverflow.com/questions/29324251/gorilla-websocket-with-cookie-authentication", "title": "Gorilla websocket with cookie authentication", "body": "<p>Here's my setup: I'm building a service (using Negroni and Gorilla) with user login, where upon login, the user gets a session cookie which the server uses to authorize protected endpoints. One of the protected endpoints allows the user/client to open a websocket with the server, like so:</p>\n\n<pre><code>app := negroni.New()\n\nr := mux.NewRouter()\n\nr.HandleFunc(\"/auth/connection\", func(rw http.ResponseWriter, req *http.Request) {\n    // authorize request using req.Cookie(\"session_id\")\n\n    // create websocket\n    conn, err := upgrader.Upgrade(rw, req, nil)\n    if err != nil {\n        panic(err)\n    }\n    defer conn.Close()\n\n    // do stuff...\n})\n\napp.UseHandler(r)\n\napp.Run(\":3000\")\n</code></pre>\n\n<p>However, <code>req.Cookies()</code> is always empty, meaning I can't authorize any requests to <code>\"/auth/connection\"</code> -- and I'm almost positive it is not a problem with the websocket client (if you're curious, I'm testing it using this Python package: <a href=\"https://github.com/liris/websocket-client\" rel=\"noreferrer\">https://github.com/liris/websocket-client</a>). Am I approaching authentication of a websocket correctly?</p>\n\n<p>Any help/advice would be greatly appreciated!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1427583400, "post_id": 29323572, "comment_id": 46837953, "body": "The right syntax is <code>&#39;a&#39; &gt;&gt; 2</code> and it does work, but how does this tell you the next character?"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1427583573, "post_id": 29323572, "comment_id": 46837998, "body": "funny, I ran that in the playground and it didn&#39;t work. In any case, I&#39;m really really rusty with this - I thought I&#39;d shift, then cast back to a character."}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 3, "creation_date": 1427584194, "post_id": 29323572, "comment_id": 46838153, "body": "I&#39;m not sure why you&#39;d expect <code>&#39;a&#39; &gt;&gt; 2</code> to give you the next character alphabetically in any language(?). It certainly won&#39;t do that in C."}, {"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1427794731, "post_id": 29323572, "comment_id": 46913661, "body": "Vote of -1 is enough"}], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 1, "last_activity_date": 1427583968, "creation_date": 1427583968, "answer_id": 29323670, "question_id": 29323572, "link": "https://stackoverflow.com/questions/29323572/how-to-find-next-character-in-golang/29323670#29323670", "title": "How to find next character in Golang?", "body": "<p>You're trying to shift a string, not a byte, like @Not_a_Golfer said <code>'a'&gt;&gt;2</code> should work fine.</p>\n\n<p>However to get the next character you can do something like:</p>\n\n<pre><code>func nextChar(ch byte) byte {\n    if ch += 1; ch &gt; 'z' {\n        return 'a'\n    }\n    return ch\n}\nfunc main() {\n    fmt.Println(string(nextChar('a')))\n}\n</code></pre>\n\n<p>Of course it'd be more complex if you need more than a-z support, take a look at the <a href=\"http://golang.org/pkg/unicode/\" rel=\"nofollow\"><code>unicode</code></a> package and <a href=\"https://blog.golang.org/strings\" rel=\"nofollow\">this</a> blog post about go strings.</p>\n"}, {"tags": [], "owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "is_accepted": true, "score": 2, "last_activity_date": 1427793586, "last_edit_date": 1427793586, "creation_date": 1427587423, "answer_id": 29324100, "question_id": 29323572, "link": "https://stackoverflow.com/questions/29323572/how-to-find-next-character-in-golang/29324100#29324100", "title": "How to find next character in Golang?", "body": "<p>I am not sure where you get the idea that this gives you the 'next character'. This is not true in any language. What <code>'a' &gt;&gt; 2</code> does is this:</p>\n\n<ul>\n<li>'a' is interpreted as <code>int32(97)</code> (<a href=\"http://play.golang.org/p/tkYcX7gO1x\" rel=\"nofollow\">example</a>)</li>\n<li><code>&gt;&gt;</code> means 'shift X right by Y bits'. Shifting something right by 2 bits is functionally the same as an integer divide by 4. So <code>(x &gt;&gt; 2) == (x / 4)</code>. (<a href=\"http://play.golang.org/p/0F3vr7srbf\" rel=\"nofollow\">example</a>)</li>\n<li><code>97 / 4 == 24</code>. The <code>b</code> character has ASCII value <code>98</code>. So this doesn't get you anywhere near. (<a href=\"http://play.golang.org/p/fiMbbbgnWG\" rel=\"nofollow\">example</a>)</li>\n</ul>\n\n<h3>More on the bit shifting</h3>\n\n<p>Bit shifting is most obvious when considering a number in its binary notation. For the expression <code>z = x &gt;&gt; y</code>, we can note the following:</p>\n\n<pre><code>x(97):  01100001\ny(2):   00000010\n        -------- &gt;&gt;\nz(24):  00011000\n</code></pre>\n\n<p>Note that all the bits in <code>x</code> have simply been moved to the right by two bits. The <code>1</code> that fell off the end is dropped.</p>\n\n<p>Similarly, you can 'shift left' (<code>&lt;&lt;</code>). Just like <code>x &gt;&gt; 1</code> is the same as <code>x / 2</code>, <code>x &lt;&lt; 1</code> is the same as <code>x * 2</code>.</p>\n\n<p>Expression: <code>5&gt;&gt;1 == 5/2 == 2</code>:</p>\n\n<pre><code>x(5):   00000101\ny(1):   00000001\n        -------- &gt;&gt;\nz(2):   00000010\n</code></pre>\n\n<p>Expression: <code>5&lt;&lt;1 == 5*2 == 10</code>:</p>\n\n<pre><code>x(5):   00000101\ny(1):   00000001\n        -------- &lt;&lt;\nz(10):  00001010\n</code></pre>\n\n<h3>Actually getting the next character</h3>\n\n<p>If you want the character directly following <code>'a'</code>, you simply add 1 to it as evidenced in this <a href=\"http://play.golang.org/p/rFQX-fHJE2\" rel=\"nofollow\">example</a>.</p>\n"}], "owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1422, "favorite_count": 0, "accepted_answer_id": 29324100, "answer_count": 2, "score": -4, "last_activity_date": 1427793586, "creation_date": 1427583255, "question_id": 29323572, "link": "https://stackoverflow.com/questions/29323572/how-to-find-next-character-in-golang", "title": "How to find next character in Golang?", "body": "<p>I'm just doing some algorithms problems out of interest in golang. I understand that in other languages to find the next character alphabetically I can bitshift the character, as a character (I'm thinking of C) is really a number. </p>\n\n<p>So I tried doing </p>\n\n<pre><code>\"a\" &gt;&gt; 2\n</code></pre>\n\n<p>Or something to that effect, but there is a type mismatch.</p>\n\n<p>I'd like to know how I can achieve this. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 14867, "user_id": 517371, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/0owFn.jpg?s=128&g=1", "display_name": "Tobia", "link": "https://stackoverflow.com/users/517371/tobia"}, "reply_to_user": {"reputation": 3615, "user_id": 4725175, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/10206540408857078/picture?type=large", "display_name": "Jakob Svenningsson", "link": "https://stackoverflow.com/users/4725175/jakob-svenningsson"}, "edited": false, "score": 0, "creation_date": 1427621739, "post_id": 29323726, "comment_id": 46845115, "body": "@JakobSvenningsson I see you&#39;re new here. If this answers your question, you should click on the check mark \u2714 right below the votes."}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1427637806, "post_id": 29323726, "comment_id": 46849531, "body": "Using a buffered channel is <i>one</i> way to solve the issue, but it is probably not the only way. The case here arises because the secondary goroutine is created on the fly and in some cases is never released - essentially, that one goroutine becomes <b>deadlocked</b>. This happens every time the <code>Read</code> function is called and a timeout occurs. I am interested in what alternative solutions might be possible."}, {"owner": {"reputation": 14867, "user_id": 517371, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/0owFn.jpg?s=128&g=1", "display_name": "Tobia", "link": "https://stackoverflow.com/users/517371/tobia"}, "reply_to_user": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1427638202, "post_id": 29323726, "comment_id": 46849655, "body": "@Rick-777 I would look for a way to set a timeout on a lower level. For example, if the underlying source of this data is an HTTP or TCP connection, you can set timeouts that are passed through to the OS, or at least are implemented in the stdlib. Barring that, a select with time.After is a good solution, but it needs a buffered channel. I don&#39;t think it&#39;s worthwhile (nor easy) to implement a different solution, without incurring in data races."}], "tags": [], "owner": {"reputation": 14867, "user_id": 517371, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/0owFn.jpg?s=128&g=1", "display_name": "Tobia", "link": "https://stackoverflow.com/users/517371/tobia"}, "is_accepted": true, "score": 2, "last_activity_date": 1427584814, "last_edit_date": 1427584814, "creation_date": 1427584392, "answer_id": 29323726, "question_id": 29323560, "link": "https://stackoverflow.com/questions/29323560/bug-detect-go-channels-with-select/29323726#29323726", "title": "Bug detect, go channels with select", "body": "<p>The fact is that a channel without a buffer, called synchronous, will block both the sender and the receiver until they can complete their exchange.</p>\n\n<p>Much like if you had to hand over something to your mate and you both knew the meeting place, but not the time. The first one to get there will wait for the other, whether it's the sender or the receiver. Now, given that computers are stupid :-) if one of them forgets about the appointment, the other will verily wait forever.</p>\n\n<p>The specific bug here is that when the select chooses the <code>time.After</code> (that is, the timeout occurs) nobody will be there to receive from <code>&lt;-ch</code> anymore. Not ever. So the poor <code>go func()</code> will sit there forever, waiting for someone to take her <code>*Response</code>, but nobody will ever show up.</p>\n\n<p>This does not actually waste any CPU power, but it wastes memory: that needed to keep track of the channel, of the goroutine, of her stack\u2014however small\u2014and her local variables. The memory will never be reclaimed until the entire process terminates or is killed.</p>\n\n<p>In a server, serving a lot of clients, this will build up quickly until the application eats all the memory of the server and\u2014if you're lucky\u2014gets killed by the OS safety measures, without taking down the entire machine.</p>\n\n<p>Using a buffered channel is one way to solve the issue, because then, whenever the poor <code>go func()</code> has her <code>*Response</code> ready, she will be able to store it into the channel's buffer, even if nobody is there to get it, and terminate peacefully. As soon as that happens, Go's garbage collector will notice that no live goroutine is holding any pointers to that channel anymore, so it will collect the channel and the <code>*Response</code> it points to and recycle all those bytes.</p>\n"}], "owner": {"reputation": 3615, "user_id": 4725175, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/10206540408857078/picture?type=large", "display_name": "Jakob Svenningsson", "link": "https://stackoverflow.com/users/4725175/jakob-svenningsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 29323726, "answer_count": 1, "score": 1, "last_activity_date": 1427584814, "creation_date": 1427583142, "last_edit_date": 1427583342, "question_id": 29323560, "link": "https://stackoverflow.com/questions/29323560/bug-detect-go-channels-with-select", "title": "Bug detect, go channels with select", "body": "<p>There is supposed to be a bug in this bit of code. My mate told me that it contains a memory leak and it occurs when the time out case happens in the select statement before the go function has finished and he also told me that adding a buffer of size one to ch would solve the problem. But i have a hard time understanding why it would solve the problem and would appreciate if someone could explain if for me? I've tried to search for the answer myself but with no success.</p>\n\n<p>Thanks.</p>\n\n<pre><code>func Read(url string, timeout time.Duration) (res *Response) {\n    ch := make(chan *Response)\n    go func() {\n        time.Sleep(time.Millisecond * 300)\n        ch &lt;- Get(url)\n    }()\n    select {\n    case res = &lt;-ch:\n    case &lt;-time.After(timeout):\n        res = &amp;Response{\"Gateway timeout\\n\", 504}\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1427574862, "post_id": 29322065, "comment_id": 46835610, "body": "why not pass this as a command line argument with an absolute path?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1427574893, "post_id": 29322065, "comment_id": 46835620, "body": "... or an environment variable, or a key in a config file for that matter?"}, {"owner": {"reputation": 90304, "user_id": 562769, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/e86681e49622d52817b36fd2a4c936b7?s=128&d=identicon&r=PG", "display_name": "Martin Thoma", "link": "https://stackoverflow.com/users/562769/martin-thoma"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1427575007, "post_id": 29322065, "comment_id": 46835647, "body": "@Not_a_Golfer Sure, that would be possible. But it would be simpler if I could get the directory of the current package. Isn&#39;t that possible with Go?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1427575185, "post_id": 29322065, "comment_id": 46835708, "body": "have you tried instead of os.Args[0] to get the CWD with os.Getwd? that&#39;s usually how I do it."}, {"owner": {"reputation": 90304, "user_id": 562769, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/e86681e49622d52817b36fd2a4c936b7?s=128&d=identicon&r=PG", "display_name": "Martin Thoma", "link": "https://stackoverflow.com/users/562769/martin-thoma"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1427575681, "post_id": 29322065, "comment_id": 46835889, "body": "@Not_a_Golfer I&#39;ve just tried it. One version works while running the server, the other works while running the tests with <code>go test .&#47;...</code>. No version works for both. The problem seems to be that <code>go test .&#47;...</code> runs the tests from another directory. Is it possible to run all tests from the &quot;usual&quot; directory?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1427575927, "post_id": 29322065, "comment_id": 46835970, "body": "well, you can always set some env var for the root working directory and read it from all tests. e.g. &quot;MYWD=`pwd` go test ./...&quot;"}, {"owner": {"reputation": 4316, "user_id": 486035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1654e9816b6e407e1daced17ac4fcf3b?s=128&d=identicon&r=PG", "display_name": "phemmer", "link": "https://stackoverflow.com/users/486035/phemmer"}, "edited": false, "score": 0, "creation_date": 1427577419, "post_id": 29322065, "comment_id": 46836405, "body": "Why not write a function which tries each method in turn? First look for env variable or command flag, then try using <code>os.Args</code>, then <code>runtime.Caller</code>, then <code>os.Getwd</code>. Return as soon as one of them finds a match. Though at my work we build from a common $GOPATH, bundle that up, and deploy to the same path (including sources), so we just use <code>runtime.Caller()</code> (helps to have a build server for this)."}], "answers": [{"tags": [], "owner": {"reputation": 90304, "user_id": 562769, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/e86681e49622d52817b36fd2a4c936b7?s=128&d=identicon&r=PG", "display_name": "Martin Thoma", "link": "https://stackoverflow.com/users/562769/martin-thoma"}, "is_accepted": true, "score": 0, "last_activity_date": 1427648097, "creation_date": 1427648097, "answer_id": 29332009, "question_id": 29322065, "link": "https://stackoverflow.com/questions/29322065/how-can-i-get-a-file-in-a-go-web-project-for-testing-and-production/29332009#29332009", "title": "How can I get a file in a Go web project for testing and production?", "body": "<p>I just realized that I can use the <code>GOPATH</code> environment variable. It is always set (see <a href=\"https://golang.org/doc/code.html#GOPATH\" rel=\"nofollow\">The GOPATH environment variable</a>) and therefore no additional work:</p>\n\n<pre><code>filedirectory := os.Getenv(\"GOPATH\")\ncsvFilename, _ := filepath.Abs(path.Join(filedirectory, \"src/github.com/gituser/backend/services/geo/cities.csv\"))\ncsvfile, err := os.Open(csvFilename)\n</code></pre>\n"}], "owner": {"reputation": 90304, "user_id": 562769, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/e86681e49622d52817b36fd2a4c936b7?s=128&d=identicon&r=PG", "display_name": "Martin Thoma", "link": "https://stackoverflow.com/users/562769/martin-thoma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 29332009, "answer_count": 1, "score": 1, "last_activity_date": 1427648097, "creation_date": 1427573619, "last_edit_date": 1427575592, "question_id": 29322065, "link": "https://stackoverflow.com/questions/29322065/how-can-i-get-a-file-in-a-go-web-project-for-testing-and-production", "title": "How can I get a file in a Go web project for testing and production?", "body": "<p>I am currently working on a web project where we use Go (with martini) a backend. It contains a reverse-geocoder which maps coordinates to city names. To do so, the reverse-geocoder has to read a <code>cities.csv</code>.</p>\n\n<p>The structure is</p>\n\n<pre><code>handlers/city/create.go\nservices/geo/reverse.go\nservices/geo/cities.csv\nmain.go\n</code></pre>\n\n<p>Now the <code>main.go</code> is started to start the web service. The handler <code>handlers/city/create.go</code> makes use of <code>services/geo/reverse.go</code> to get \nthe city with <code>cities.csv</code>.</p>\n\n<p>The problem is to get the <code>cities.csv</code>.</p>\n\n<h2>What I've tried</h2>\n\n<h3>plain filename</h3>\n\n<p>However, when I only use <code>csvFilename := \"cities.csv\"</code>:</p>\n\n<ul>\n<li>the tests work</li>\n<li>the handler doesn't work as go assumes <code>/home/me/go/src/github.com/githubuser/backend/cities.csv</code></li>\n</ul>\n\n<h3>adjusted filename</h3>\n\n<p>When I adjust the filename to be relative to the root (<code>csvFilename := \"services/geocalc/cities.csv\"</code>), the tests fail. They assume <code>/home/me/GitHub/go/src/github.com/githubuser/backend/services/geocalc/services/geocalc/city-names-geocoordinates.csv</code>.</p>\n\n<h3>args[0]</h3>\n\n<p>This doesn't work either:</p>\n\n<pre><code>filename := filepath.Dir(os.Args[0])\nfiledirectory := filepath.Dir(filename)\ncsvFilename, _ := filepath.Abs(path.Join(filedirectory, \"cities.csv\"))\n</code></pre>\n\n<p>Now the tests fail with <code>/tmp/go-build210484207/github.com/githubuser/logbook-backend/services/geocalc/cities.csv</code></p>\n\n<h3>runntime caller</h3>\n\n<pre><code>_, filename, _, _ := runtime.Caller(1)\nfiledirectory := filepath.Dir(filename)\ncsvFilename, _ := filepath.Abs(path.Join(filedirectory, \"cities.csv\"))\n</code></pre>\n\n<p>works for the tests, but in \"production\" (testing with http-queries) it assumes <code>/home/me/GitHub/go/src/github.com/githubuser/backend/handlers/packets/cities.csv</code></p>\n\n<h3>os.Getwd()</h3>\n\nVersion 1\n\n<pre><code>filedirectory, _ := os.Getwd()\ncsvFilename, _ := filepath.Abs(path.Join(filedirectory, \"cities.csv\"))\n</code></pre>\n\n<p>fails in production with <code>/home/me/GitHub/go/src/github.com/githubuser/logbook-backend/cities.csv</code>.</p>\n\nVersion 2\n\n<pre><code>filedirectory, _ := os.Getwd()\ncsvFilename, _ := filepath.Abs(path.Join(filedirectory, \"services/geo/cities.csv\"))\n</code></pre>\n\n<p>Fails in the test with <code>/home/me/GitHub/go/src/github.com/githubuser/logbook-backend/services/geo/services/geo/cities.csv</code></p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore", "gae-quotas"], "answers": [{"tags": [], "owner": {"reputation": 7763, "user_id": 501494, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5dc2a48c68041b350359e623be076651?s=128&d=identicon&r=PG", "display_name": "Jesse", "link": "https://stackoverflow.com/users/501494/jesse"}, "is_accepted": false, "score": 0, "last_activity_date": 1427642540, "creation_date": 1427642540, "answer_id": 29330929, "question_id": 29320807, "link": "https://stackoverflow.com/questions/29320807/how-to-avoid-safety-over-quota-panic-when-accessing-datastore-billing-is-en/29330929#29330929", "title": "How to avoid &quot;safety&quot; over quota panic when accessing datastore ? (billing is enabled)", "body": "<p>It really depends on where you are doing this processing for both of these use cases within the appengine platform.</p>\n\n<p>For example if you are performing a urlfetch for the file to process within a frontend instance then you have 60 seconds to do all this processing. App Engine requires that frontend instances respond to each request within 60 seconds.</p>\n\n<p>I'm making an assumption that this is what you are doing, as your request is being terminated. To get around this time restriction you should move this type of batch data processing to the taskqueue where each task is required to completed within 10 minutes. </p>\n\n<p>The same holds true for your reads. Either you need to look at how your reading data from the datastore or you need to batch it up with either deferred task or a pipeline. </p>\n\n<p>Do you have a snippet that you can share for how you are composing your json?</p>\n"}], "owner": {"reputation": 69, "user_id": 4722740, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/88dc974951ed17593f37537b582783a8?s=128&d=identicon&r=PG&f=1", "display_name": "JackS", "link": "https://stackoverflow.com/users/4722740/jacks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1475291117, "creation_date": 1427566602, "last_edit_date": 1475291117, "question_id": 29320807, "link": "https://stackoverflow.com/questions/29320807/how-to-avoid-safety-over-quota-panic-when-accessing-datastore-billing-is-en", "title": "How to avoid &quot;safety&quot; over quota panic when accessing datastore ? (billing is enabled)", "body": "<p>I deployed my site to Google App Engine (using Golang and datastore with 1000 records). billing is enabled and a daily budget established.   The Quota Details page indicates everything is under quota.   I am doing an Urlfetch to obtain a tsv file that I use to build data entities in the datastore.</p>\n\n<p>Two problems:</p>\n\n<ol>\n<li>Only 778 entities are create - log indicates it is a long running process but it appears to terminate prematurely without error message.  Docs say this is normal</li>\n<li>The second step involves creating a json file from the entities in the datastore. This process causes a \"Panic: overquota\"  because the process is taking too long I suppose.</li>\n</ol>\n\n<p>How do I proceed?  Should I divide the tsv datafile into several smaller files?  Can I request \"more time\" so I don't go over the safety quotas?</p>\n\n<p>Important to note is that the datastore part of the developers console is showing some problems:\nAlthough my application has access to 778 datastore entities, the console only reports 484 entities of that kind with a total of only 704 entities of all kinds (actually are 933)  </p>\n\n<p>I've been working at this for a while and am wondering if there is something going on with the system or are there things I can do to get my data entities set up properly.   I also wish I could find more to read about safety quotas... \n... and get the remote api working! thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 2, "creation_date": 1427562959, "post_id": 29319883, "comment_id": 46831702, "body": "Why want you pass slice by reference, just curious? Since slice is reference type itself doing double reference looks not very good idea for me."}, {"owner": {"reputation": 11891, "user_id": 1930219, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5ae618e4950c81bf0d83d17c2c2ddaab?s=128&d=identicon&r=PG", "display_name": "Alex Netkachov", "link": "https://stackoverflow.com/users/1930219/alex-netkachov"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1427563227, "post_id": 29319883, "comment_id": 46831800, "body": "I have some mgo (mongodb) code that use this pattern - <a href=\"http://godoc.org/labix.org/v2/mgo#Iter.All\" rel=\"nofollow noreferrer\">godoc.org/labix.org/v2/mgo#Iter.All</a> - so in order to not refactor too much I would like to use it."}], "answers": [{"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 5, "last_activity_date": 1427562375, "creation_date": 1427562375, "answer_id": 29320028, "question_id": 29319883, "link": "https://stackoverflow.com/questions/29319883/how-to-return-slice-by-reference/29320028#29320028", "title": "How to return slice by reference?", "body": "<p>By assigning to <code>items</code>, you alter where <code>items</code> points, not the value <code>items</code> points to. To do the latter, instead of <code>items = &amp;list</code> write <code>*items = list</code>.</p>\n"}], "owner": {"reputation": 11891, "user_id": 1930219, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5ae618e4950c81bf0d83d17c2c2ddaab?s=128&d=identicon&r=PG", "display_name": "Alex Netkachov", "link": "https://stackoverflow.com/users/1930219/alex-netkachov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "accepted_answer_id": 29320028, "answer_count": 1, "score": 1, "last_activity_date": 1427562621, "creation_date": 1427561644, "question_id": 29319883, "link": "https://stackoverflow.com/questions/29319883/how-to-return-slice-by-reference", "title": "How to return slice by reference?", "body": "<p>The returned slice by reference is empty:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc GetItems(items *[]string) {\n    list := make([]string, 0)\n    list = append(list, \"ok\")\n    items = &amp;list\n}\n\nfunc main() {\n    var items []string\n    GetItems(&amp;items)\n    fmt.Print(len(items)) // expect 1 here, but got 0\n}\n</code></pre>\n\n<p>How to return the slice from the function by reference?</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1427564547, "post_id": 29319783, "comment_id": 46832239, "body": "It&#39;d be neat if you could wrap the <code>net.Conn</code> in something that sends to the network but also writes to a logfile or buffer. But I don&#39;t see a place for you to insert that in the <code>net&#47;http</code> pipeline. Might be a question for golang-nuts if no one comes up with anything here this weekend."}], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 6, "last_activity_date": 1427580519, "last_edit_date": 1427580519, "creation_date": 1427571269, "answer_id": 29321643, "question_id": 29319783, "link": "https://stackoverflow.com/questions/29319783/logging-responses-to-incoming-http-requests-inside-http-handlefunc/29321643#29321643", "title": "Logging responses to incoming HTTP requests inside http.HandleFunc", "body": "<p>This can be achieved by using a custom <code>ServerMux</code> that does no routing, but replaces the response writer, and then forwards the request to a normal mux. Since ResponseWriter is just an interface we can fake it easily.</p>\n\n<p>First, we wrap the ResponseWriter interface with our own response writer, that will log everything and pass all functionality to a real response writer:</p>\n\n<pre><code>type DumpResponseWriter struct {\n    // the underlying writer\n    w http.ResponseWriter\n    // more stuff you want to use for logging context (ip, headers, etc) here\n}\n\n\nfunc (w *DumpResponseWriter)Header() http.Header {\n    return w.w.Header()\n}\n\nfunc (w *DumpResponseWriter)Write(b []byte) (int, error) {\n        // You can add more context about the connection when initializing the writer and log it here\n        log.Println(\"Writing &lt; more context details here&gt; \", string(b) )\n        return w.w.Write(b)\n}\n\n\nfunc (w *DumpResponseWriter)WriteHeader(h int) {\n    log.Println(\"Writing Header&lt; more context details here&gt; \", h)\n    w.w.WriteHeader(h)\n}\n</code></pre>\n\n<p>This leaves our handler func the same as before, and agnostic to the fact that we're using a \"Fake\" writer...</p>\n\n<pre><code>func MyHandler(w http.ResponseWriter, r *http.Request) {\n\n    w.Write([]byte(\"Hello world\"))\n}\n</code></pre>\n\n<p>And then we simply replace the default mux with our own proxy mux, that replaces the writer and lets a regular ServeMux do its thing:</p>\n\n<pre><code>func main(){\n\n    // we don't use the default mux, but a custom one\n    mux := http.NewServeMux()\n    mux.HandleFunc(\"/\", MyHandler)\n\n    // now we intercept each request and forward it to the mux to do    the routing to the handlers.\n    err := http.ListenAndServe(\":1337\", http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    // we wrap the response writer with our own. Add more context here if you want to the writer's instance\n        writer := &amp;DumpResponseWriter{w}\n\n        // and we let our ordinary mux take care of things from here\n        mux.ServeHTTP(writer, r)\n\n        // We can also dump the headers after the handler is done. It will not print the standard headers though\n        log.Printf(\"Response headers: %#v\", w.Header())\n\n    }))\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/hT1PCNxI-V\" rel=\"nofollow\">http://play.golang.org/p/hT1PCNxI-V</a></p>\n"}, {"comments": [{"owner": {"reputation": 689, "user_id": 724072, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/517c7f1998c927c0c362c730957f616b?s=128&d=identicon&r=PG", "display_name": "zai chang", "link": "https://stackoverflow.com/users/724072/zai-chang"}, "edited": false, "score": 1, "creation_date": 1427839158, "post_id": 29328884, "comment_id": 46938639, "body": "Thanks thwd this was the technique I went with in the end, because it allowed me to pick and choose particular URLs to monitor, minus using negroni. Though there are a couple of tweaks I needed to make: <code>next(w, c)   \u2013\u2013&gt;   next(c, r)</code> and <code>for k, v := c.HeaderMap {...}   \u2013\u2013\u2013&gt;   for k, v := range c.HeaderMap {...}</code>.   Cheers!"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 689, "user_id": 724072, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/517c7f1998c927c0c362c730957f616b?s=128&d=identicon&r=PG", "display_name": "zai chang", "link": "https://stackoverflow.com/users/724072/zai-chang"}, "edited": false, "score": 0, "creation_date": 1427874861, "post_id": 29328884, "comment_id": 46949328, "body": "Oh, sorry for that. I made the corrections to my answer. Thank you!"}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 7, "last_activity_date": 1471040544, "last_edit_date": 1471040544, "creation_date": 1427630766, "answer_id": 29328884, "question_id": 29319783, "link": "https://stackoverflow.com/questions/29319783/logging-responses-to-incoming-http-requests-inside-http-handlefunc/29328884#29328884", "title": "Logging responses to incoming HTTP requests inside http.HandleFunc", "body": "<h1>Middleware Chaining</h1>\n\n<p>A common solution to this problem is the so called <em>middleware chain</em>. There are several libraries that provide this functionality e.g. <a href=\"https://github.com/codegangsta/negroni\" rel=\"nofollow\">negroni</a>.</p>\n\n<p>It's a form of continuation-passing style where you write your <em>middleware</em> functions like this (taken from negroni's readme):</p>\n\n<pre><code>func MyMiddleware(rw http.ResponseWriter, r *http.Request, next http.HandlerFunc) {\n  // do some stuff before\n  next(rw, r)\n  // do some stuff after\n}\n</code></pre>\n\n<p>And then negroni gives you an HTTP handler that calls your middlewares in the right order.</p>\n\n<p>We could implement this solution slightly differently to a less magical and more functional (as in <em>functional programming</em>) approach. Define handler combinators as follows:</p>\n\n<pre><code>func NewFooHandler(next http.HandlerFunc) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        // do some stuff before\n        next(r,w)\n        // do some stuff after\n    }\n}\n</code></pre>\n\n<p>Then define your chain as a combination:</p>\n\n<pre><code>h := NewFooHandler(NewBarHandler(NewBazHandler(Sink)))\n</code></pre>\n\n<p>Now <code>h</code> is an <code>http.HandlerFunc</code> that does foo, then bar, then baz. <code>Sink</code> is just an empty last handler, that does nothing (to \"finish\" the chain.)</p>\n\n<h1>Applying this solution to your problem</h1>\n\n<p>Define a handler combinator:</p>\n\n<pre><code>func NewResponseLoggingHandler(next http.HandlerFunc) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n\n        // switch out response writer for a recorder\n        // for all subsequent handlers\n        c := httptest.NewRecorder()\n        next(c, r)\n\n        // copy everything from response recorder\n        // to actual response writer\n        for k, v := range c.HeaderMap {\n            w.Header()[k] = v\n        }\n        w.WriteHeader(c.Code)\n        c.Body.WriteTo(w)\n\n    }\n}\n</code></pre>\n\n<p>Now the problem boils down to handler management. You'll probably want this handler applied to all chains in a certain category. For this, you can use combinators again (this is somewhat equivalent to negroni's <code>Classic()</code> method):</p>\n\n<pre><code>func NewDefaultHandler(next http.HandlerFunc) http.HandlerFunc {\n    return NewResponseLoggingHandler(NewOtherStuffHandler(next))\n}\n</code></pre>\n\n<p>After this, whenever you start a chain like this:</p>\n\n<pre><code>h := NewDefaultHandler(...)\n</code></pre>\n\n<p>It will automatically include response logging and all the default stuff that you defined in <code>NewDefaultHandler</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 7907, "user_id": 1592008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e208220f7cb95e6854adb653663736a?s=128&d=identicon&r=PG", "display_name": "Oleg Neumyvakin", "link": "https://stackoverflow.com/users/1592008/oleg-neumyvakin"}, "is_accepted": false, "score": 2, "last_activity_date": 1539358415, "last_edit_date": 1539358415, "creation_date": 1539019773, "answer_id": 52707355, "question_id": 29319783, "link": "https://stackoverflow.com/questions/29319783/logging-responses-to-incoming-http-requests-inside-http-handlefunc/52707355#52707355", "title": "Logging responses to incoming HTTP requests inside http.HandleFunc", "body": "<p>Implementing Mat Ryer's <a href=\"https://medium.com/@matryer/writing-middleware-in-golang-and-how-go-makes-it-so-much-fun-4375c1246e81\" rel=\"nofollow noreferrer\">approach</a> with logging request id based on <code>httptest.ResponseRecorder</code></p>\n\n<p>Disadvantages of using <code>httptest.ResponseRecorder</code>:</p>\n\n<ul>\n<li>HTTP/1.1 only</li>\n<li>Doesn't supports ReadFrom(), Hijack(), Flush() maybe something else</li>\n<li>Headers like <code>Content-Length</code> and <code>Date</code> are not available in recorder </li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"github.com/google/uuid\"\n    \"log\"\n    \"net/http\"\n    \"net/http/httptest\"\n    \"net/http/httputil\"\n    \"strings\"\n)\n\nfunc main() {\n    logger := log.New(os.Stdout, \"server: \", log.Lshortfile)\n    http.HandleFunc(\"/api/smth\", Adapt(smth, httpLogger(quips.logger)))\n    panic(http.ListenAndServe(\":8080\", nil))\n}\n\ntype Adapter func(http.HandlerFunc) http.HandlerFunc\n\nfunc Adapt(h http.HandlerFunc, adapters ...Adapter) http.HandlerFunc {\n    for _, adapter := range adapters {\n        h = adapter(h)\n    }\n    return h\n}\n\nfunc httpLogger(logger *log.Logger) Adapter {\n    return func(h http.HandlerFunc) http.HandlerFunc {\n        return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n            dumpBody := true\n            if r.ContentLength &gt; 1024 {\n                dumpBody = false\n            }\n            dump, err := httputil.DumpRequest(r, dumpBody)\n            if err != nil {\n                http.Error(w, fmt.Sprint(err), http.StatusInternalServerError)\n                return\n            }\n\n            reqId, err := uuid.NewRandom()\n            if err != nil {\n                http.Error(w, fmt.Sprint(err), http.StatusInternalServerError)\n                return\n            }\n\n            logger.Printf(\"&lt;&lt;&lt;&lt;&lt; Request %s\\n%s\\n&lt;&lt;&lt;&lt;&lt;\", reqId.String(), string(dump))\n\n            recorder := httptest.NewRecorder()\n            defer func() {\n                var sb strings.Builder\n                fmt.Fprintf(&amp;sb, \"%s %d\\n\", recorder.Result().Proto, recorder.Result().StatusCode)\n\n                for h, v := range recorder.Result().Header {\n                    w.Header()[h] = v\n                    for _, headerValue := range v {\n                        fmt.Fprintf(&amp;sb, \"%s: %s\\n\", h, headerValue)\n                    }\n                }\n                w.Header().Set(\"X-Request-Id\", reqId.String())\n                fmt.Fprintf(&amp;sb, \"X-Request-Id: %s\\n\", reqId.String())\n                fmt.Fprintf(&amp;sb, \"Content-Length: %d\\n\", recorder.Body.Len())\n                fmt.Fprint(&amp;sb, \"\\n\")\n                sb.Write(recorder.Body.Bytes())\n\n                logger.Printf(\"&gt;&gt;&gt;&gt;&gt; Response %s\\n%s\\n&gt;&gt;&gt;&gt;&gt;\", reqId.String(), sb.String())\n\n                w.WriteHeader(recorder.Result().StatusCode)\n                recorder.Body.WriteTo(w)\n            }()\n            h.ServeHTTP(recorder, r)\n        })\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 689, "user_id": 724072, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/517c7f1998c927c0c362c730957f616b?s=128&d=identicon&r=PG", "display_name": "zai chang", "link": "https://stackoverflow.com/users/724072/zai-chang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5219, "favorite_count": 2, "accepted_answer_id": 29328884, "answer_count": 3, "score": 6, "last_activity_date": 1583234740, "creation_date": 1427561103, "last_edit_date": 1583234740, "question_id": 29319783, "link": "https://stackoverflow.com/questions/29319783/logging-responses-to-incoming-http-requests-inside-http-handlefunc", "title": "Logging responses to incoming HTTP requests inside http.HandleFunc", "body": "<p>This is a follow-up question to <a href=\"https://stackoverflow.com/questions/27983893/in-go-how-to-inspect-the-http-response-that-is-written-to-http-responsewriter/27988044\">In go, how to inspect the http response that is written to http.ResponseWriter?</a> since the solution there requires faking a request, which works great for a unit test but not on a live server.</p>\n\n<p>I would like to dump out HTTP response that my web service is returning in response to requests it receives from users into a log file (or to console). The output should tell me what the headers are and the JSON payload.</p>\n\n<p>How does one go about that?</p>\n\n<p>If there were a httputil.DumpResponse equivalent that takes a http.ResponseWriter as argument rather than http.Response it would be perfect, but currently I can only access the Header from http.ResponseWriter</p>\n\n<pre><code>r = mux.NewRouter()\nr.HandleFunc(\"/path\", func (w http.ResponseWriter, r *http.Request) {\n\n    fmt.Printf(\"r.HandleFunc /path\\n\")\n\n    resp := server.NewResponse()\n    defer resp.Close()\n\n    r.ParseForm()\n\n    // Server does some work here\n    // ...\n\n    // Insert debug code here, something like\n    //\n    // dump = http.DumpResponseFromWriter(w)\n    // fmt.Printf(\"%s\\n\", dump)\n});\nhttp.Handle(\"/path\", r)\n</code></pre>\n"}, {"tags": ["go", "docker", "coreos"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 4, "creation_date": 1427555772, "post_id": 29318742, "comment_id": 46829226, "body": "<b>Don&#39;t ever ignore <code>error</code> returns!!</b> You&#39;re ignoring your own answer that <code>template.ParseFiles</code> gives you and asking others without full context to come up with that same answer."}], "answers": [{"tags": [], "owner": {"reputation": 150, "user_id": 3737839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VRDR.jpg?s=128&g=1", "display_name": "Jordan L. Osier", "link": "https://stackoverflow.com/users/3737839/jordan-l-osier"}, "is_accepted": false, "score": 1, "last_activity_date": 1427559526, "creation_date": 1427559526, "answer_id": 29319453, "question_id": 29318742, "link": "https://stackoverflow.com/questions/29318742/cant-automatically-run-simple-go-web-server-with-docker-container-func-templ/29319453#29319453", "title": "Can&#39;t automatically run simple Go web server with Docker container (func (*Template) Execute)", "body": "<p>It was a working directory issue. Adding the following to the Dockerfile prior to the ENTRYPOINT statement fixed it.</p>\n\n<pre><code>WORKDIR /app\n</code></pre>\n\n<p>Previously, the app was trying to run in the root directory of the container and was unable to find the template file with the relative path in the GateHandler. </p>\n\n<p><a href=\"https://docs.docker.com/reference/builder/#workdir\" rel=\"nofollow\">https://docs.docker.com/reference/builder/#workdir</a></p>\n"}], "owner": {"reputation": 150, "user_id": 3737839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VRDR.jpg?s=128&g=1", "display_name": "Jordan L. Osier", "link": "https://stackoverflow.com/users/3737839/jordan-l-osier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427559526, "creation_date": 1427555560, "last_edit_date": 1427557502, "question_id": 29318742, "link": "https://stackoverflow.com/questions/29318742/cant-automatically-run-simple-go-web-server-with-docker-container-func-templ", "title": "Can&#39;t automatically run simple Go web server with Docker container (func (*Template) Execute)", "body": "<p>So I am trying to automatically run a simple \"hello world\" web server in a docker container on CoreOS. But I get an error when the app tries to exectute the HTML template.</p>\n\n<p>Here is the offending code:</p>\n\n<pre><code>func GateHandler(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"Entered the GateHandler.\")\n    t, _ := template.ParseFiles(\"templates/helloworld.html\")\n    fmt.Println(\"Passed the ParseFiles.\")\n    err := t.Execute(w, nil)\n    fmt.Println(\"Passed the Execute statement.\")\n    if err != nil {\n        fmt.Println(err)\n    }\n}\n</code></pre>\n\n<p>Here is my Dockerfile:</p>\n\n<pre><code>FROM ubuntu:14.04\nRUN mkdir app\nADD assets /app/assets \nADD templates /app/templates\nADD web /app/web\nENV PORT 80\nEXPOSE 80\nENTRYPOINT [\"/app/web\"]\n</code></pre>\n\n<p>When I run the docker container and navigate to the appropriate URL in my browser, I see the following error: </p>\n\n<pre><code>Entered the GateHandler.\nPassed the ParseFiles.\n2015/03/28 00:10:53 http: panic serving 10.0.2.2:56292: runtime error: invalid memory address or nil pointer dereference\ngoroutine 5 [running]:\nnet/http.func\u00b7011()\n    /usr/local/go/src/net/http/server.go:1130 +0xbb\nhtml/template.(*Template).escape(0x0, 0x0, 0x0)\n    /usr/local/go/src/html/template/template.go:56 +0x3a\nhtml/template.(*Template).Execute(0x0, 0x7f1593124360, 0xc20804c460, 0x0, 0x0, 0x0, 0x0)\n    /usr/local/go/src/html/template/template.go:75 +0x3d\nmain.GateHandler(0x7f1593124290, 0xc20804c460, 0xc20803c1a0)\n</code></pre>\n\n<p>... and so on.</p>\n\n<p>However, when I remove the entry point from the Dockerfile, run the container with /bin/bash and manually launch the app \"./app/web\", the web app runs perfectly. Looks like t.Execute() is not passing up an error like it should. The only difference is that I am launching the web app from docker run as opposed to manually starting it within the container.</p>\n\n<p>Any insights? It would be a lot more convenient to launch the container and not have to worry about starting the web server manually.</p>\n\n<p>Thanks.</p>\n\n<h3>UPDATE:</h3>\n\n<p>Being new to Go, I ignored the fundamental principle of never ignoring returned errors. Fixing the code gave more useful information.</p>\n\n<pre><code>Entered the GateHandler.\nopen templates/helloworld.html: no such file or directory\nPassed the ParseFiles.\n... and so on\n</code></pre>\n\n<p>So this means that when I automatically run the web app with the Docker container, it can't find the template file. Still working on figuring out why that is.</p>\n\n<p>golang-nuts post: <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/j6JTFpGg6fI\" rel=\"nofollow\">https://groups.google.com/forum/#!topic/golang-nuts/j6JTFpGg6fI</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 4, "creation_date": 1427555289, "post_id": 29318672, "comment_id": 46829077, "body": "Perhaps the <a href=\"https://godoc.org/golang.org/x/net/html\" rel=\"nofollow noreferrer\">html package</a> can be of use?"}, {"owner": {"reputation": 7514, "user_id": 1008837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f67dc852a25a639e13fafbec62eec69?s=128&d=identicon&r=PG&f=1", "display_name": "Pravin Mishra", "link": "https://stackoverflow.com/users/1008837/pravin-mishra"}, "edited": false, "score": 0, "creation_date": 1427555484, "post_id": 29318672, "comment_id": 46829125, "body": "Do you want to scrape whole websites?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427555686, "post_id": 29318672, "comment_id": 46829189, "body": "Don&#39;t try <a href=\"http://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454\">parsing HTML with regexp</a>. In general think twice before using regexp for just about anything, it has it&#39;s place but far too many people jump to it for every single thing they do."}, {"owner": {"reputation": 4687, "user_id": 1221132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a5046ae2fcac22bc44c6663a121f0cc8?s=128&d=identicon&r=PG", "display_name": "theva", "link": "https://stackoverflow.com/users/1221132/theva"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1427557130, "post_id": 29318672, "comment_id": 46829698, "body": "@DaveC That is exactly why I started this question, to find if there is any other more appropriate method. I don&#39;t understand all the down votes..."}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427653294, "post_id": 29319185, "comment_id": 46854950, "body": "Note, I blanked wrt the existence of the <code>golang.org&#47;x&#47;net&#47;html</code> package as Go project HTML parser so a previous version of this answer only mentioned the Go standard <code>encoding&#47;xml</code> package (which I&#39;ve used in the past for trivial HTML decoding when I wanted/needed to stick with standard packages)."}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 1, "last_activity_date": 1427653702, "last_edit_date": 1427653702, "creation_date": 1427557994, "answer_id": 29319185, "question_id": 29318672, "link": "https://stackoverflow.com/questions/29318672/parsing-list-items-from-html-with-go/29319185#29319185", "title": "Parsing list items from html with Go", "body": "<p>You likely want to use the <a href=\"https://godoc.org/golang.org/x/net/html\" rel=\"nofollow\">golang.org/x/net/html package</a>.\nIt's not in the Go standard packages, but instead in the <a href=\"https://golang.org/pkg/#subrepo\" rel=\"nofollow\">Go Sub-repositories</a>. (The sub-repositories are part of the Go Project but outside the main Go tree. They are developed under looser compatibility requirements than the Go core.)</p>\n\n<p>There is <a href=\"https://godoc.org/golang.org/x/net/html#example-Parse\" rel=\"nofollow\">an example</a> in that documentation that may be similar to what you want.</p>\n\n<p>If you need to stick with the Go standard packages for some reason, then\nfor \"typical HTML\" you can use <a href=\"https://golang.org/pkg/encoding/xml/#Decoder\" rel=\"nofollow\"><code>encoding/xml</code></a>.</p>\n\n<p>Both packages tend to use an <code>io.Reader</code> for input. If you have a <code>string</code> or <code>[]byte</code> variable you can wrap them with <code>strings.NewReader</code> or <code>bytes.Buffer</code> to get an <code>io.Reader</code>.</p>\n\n<p>For HTML it's more likely you'll come from an <code>http.Response</code> body\n(make sure to close it when done).\nPerhaps something like:</p>\n\n<pre><code>    resp, err := http.Get(someURL)\n    if err != nil {\n        return err\n    }\n    defer resp.Body.Close()\n\n    doc, err := html.parse(resp.Body)\n    if err != nil {\n        return err\n    }\n    // Recursively visit nodes in the parse tree\n    var f func(*html.Node)\n    f = func(n *html.Node) {\n        if n.Type == html.ElementNode &amp;&amp; n.Data == \"a\" {\n            for _, a := range n.Attr {\n                if a.Key == \"href\" {\n                    fmt.Println(a.Val)\n                    break\n                }\n            }\n        }\n        for c := n.FirstChild; c != nil; c = c.NextSibling {\n            f(c)\n        }\n    }\n    f(doc)\n}\n</code></pre>\n\n<p>Of course, parsing fetched web pages won't work for pages that modify their own contents with JavaScript on the client side.</p>\n"}, {"tags": [], "owner": {"reputation": 929, "user_id": 6146337, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10207160730031528/picture?type=large", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/6146337/sebastian"}, "is_accepted": false, "score": 0, "last_activity_date": 1524859724, "last_edit_date": 1524859724, "creation_date": 1524858097, "answer_id": 50069279, "question_id": 29318672, "link": "https://stackoverflow.com/questions/29318672/parsing-list-items-from-html-with-go/50069279#50069279", "title": "Parsing list items from html with Go", "body": "<p>Here's one way I found to solve this. </p>\n\n<p>If you're trying to extract the text after the <code>li</code> element you first find the <code>li</code> element and then <strong>move the tokenizer to the very next element</strong> which will be the text (hopefully). You may have to use some logic if the next element is an anchor, span, etc.</p>\n\n<pre><code>resp, err := http.Get(url)\nif err!=nil{\n    log.Fatal(err)\n}\ndefer resp.Body.Close()\n\nz := html.NewTokenizer(bufio.NewReader(resp.Body))\nfor {\n    tt := z.Next()\n    switch tt {\n    case html.ErrorToken:\n        return\n    case html.StartTagToken:\n        t := z.Token()\n        swith t.Data {\n        case \"li\":\n            z.Next()\n            t = z.Token()\n            fmt.Println(t.Data)\n        }\n    }\n}\n</code></pre>\n\n<p>but really, you should just use <code>github.com/PuerkitoBio/goquery</code></p>\n"}], "owner": {"reputation": 4687, "user_id": 1221132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a5046ae2fcac22bc44c6663a121f0cc8?s=128&d=identicon&r=PG", "display_name": "theva", "link": "https://stackoverflow.com/users/1221132/theva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2624, "favorite_count": 0, "accepted_answer_id": 29319185, "answer_count": 2, "score": -3, "last_activity_date": 1524859724, "creation_date": 1427555135, "question_id": 29318672, "link": "https://stackoverflow.com/questions/29318672/parsing-list-items-from-html-with-go", "title": "Parsing list items from html with Go", "body": "<p>I want to extract all list items (content of each <code>&lt;li&gt;&lt;/li&gt;</code>) with Go. Should I use regexp to get the <code>&lt;li&gt;</code> items or is there any other library for this?</p>\n\n<p>My intention is to get a list or array in Go that contains all list item from a specific html web page. How should I do that?</p>\n"}, {"tags": ["go", "deferred-execution"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1427545993, "post_id": 29316958, "comment_id": 46826291, "body": "This is interesting."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1427551588, "post_id": 29316958, "comment_id": 46827918, "body": "The playground does not interleave stdout and stderr.  See <a href=\"http://play.golang.org/p/KhR-DqqNZ3\" rel=\"nofollow noreferrer\">play.golang.org/p/KhR-DqqNZ3</a>.  Change <code>println</code> to <code>fmt.Println</code> to get expected output."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1427554477, "post_id": 29316958, "comment_id": 46828822, "body": "Don&#39;t use <a href=\"https://golang.org/pkg/builtin/#println\" rel=\"nofollow noreferrer\"><code>println</code>. From the docs:</a> &quot;[\u2026] in an implementation- specific way [\u2026] it is not guaranteed to stay in the language.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "edited": false, "score": 0, "creation_date": 1427550666, "post_id": 29317411, "comment_id": 46827652, "body": "Validated, it runs as expected when compiled on <code>go1.4.2 darwin&#47;amd64</code>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1427553772, "post_id": 29317411, "comment_id": 46828607, "body": "NOTE: The <a href=\"https://github.com/golang/go/issues/10279\" rel=\"nofollow noreferrer\">Go bug report</a> has been rejected as invalid. There is no Go bug. The behavior is as expected. The bug is in the program. See my answer for details."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1427554069, "post_id": 29317411, "comment_id": 46828709, "body": "It hasn&#39;t been rejected, I closed it. What is weird is that I wasn&#39;t able to reproduce this behaviour by any other means."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 0, "last_activity_date": 1427547298, "creation_date": 1427547298, "answer_id": 29317411, "question_id": 29316958, "link": "https://stackoverflow.com/questions/29316958/go-inconsistent-evaluation-of-deferred-functions/29317411#29317411", "title": "Go - Inconsistent Evaluation of Deferred Functions", "body": "<p>I suspect this is a bug with the Go playground. When I compile and run this program on my machine, it yields the expected output. A <a href=\"https://github.com/golang/go/issues/10279\" rel=\"nofollow\">bug report</a> pertaining this issue has been filed.</p>\n"}, {"comments": [{"owner": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "edited": false, "score": 0, "creation_date": 1427553923, "post_id": 29318406, "comment_id": 46828661, "body": "<code>println</code> writing to <code>stderr</code> explains things perfectly.  Could you share where this is documented?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "edited": false, "score": 0, "creation_date": 1427555779, "post_id": 29318406, "comment_id": 46829227, "body": "@PassKit: In the Go <a href=\"http://golang.org/pkg/builtin/\" rel=\"nofollow noreferrer\">builtin</a> pseudo package documentation. <a href=\"http://golang.org/pkg/builtin/#println\" rel=\"nofollow noreferrer\"><code>func println</code></a>: The <code>println</code> built-in function formats its arguments in an implementation-specific way and writes the result to standard error."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1427553598, "creation_date": 1427553598, "answer_id": 29318406, "question_id": 29316958, "link": "https://stackoverflow.com/questions/29316958/go-inconsistent-evaluation-of-deferred-functions/29318406#29318406", "title": "Go - Inconsistent Evaluation of Deferred Functions", "body": "<p>You are being inconsistent in your print destination.</p>\n\n<pre><code>stdout: fmt.Println\n\nstderr: println\n</code></pre>\n\n<p>Write to the same print destination.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar z = 1\n\nfunc main() {\n\n    defer increaseZ(10)\n    defer fmt.Println(\"z =\", increaseZ(20), \"Deferred Value 1\")\n    defer fmt.Println(\"z =\", increaseZ(30), \"Deferred Value 2\")\n\n    fmt.Println(\"z =\", z, \"Main Value\")\n}\n\nfunc increaseZ(y int) int {\n    z += y\n    fmt.Println(\"z =\", z, \"Inside Increase Function\")\n    return z\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>z = 21 Inside Increase Function\nz = 51 Inside Increase Function\nz = 51 Main Value\nz = 51 Deferred Value 2\nz = 21 Deferred Value 1\nz = 61 Inside Increase Function\n</code></pre>\n\n<p>or,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nvar z = 1\n\nfunc main() {\n\n    defer increaseZ(10)\n    defer fmt.Fprintln(os.Stderr, \"z =\", increaseZ(20), \"Deferred Value 1\")\n    defer fmt.Fprintln(os.Stderr, \"z =\", increaseZ(30), \"Deferred Value 2\")\n\n    fmt.Fprintln(os.Stderr, \"z =\", z, \"Main Value\")\n}\n\nfunc increaseZ(y int) int {\n    z += y\n    println(\"z =\", z, \"Inside Increase Function\")\n    return z\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>z = 21 Inside Increase Function\nz = 51 Inside Increase Function\nz = 51 Main Value\nz = 51 Deferred Value 2\nz = 21 Deferred Value 1\nz = 61 Inside Increase Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 2, "last_activity_date": 1427553644, "creation_date": 1427553644, "answer_id": 29318417, "question_id": 29316958, "link": "https://stackoverflow.com/questions/29316958/go-inconsistent-evaluation-of-deferred-functions/29318417#29318417", "title": "Go - Inconsistent Evaluation of Deferred Functions", "body": "<p>It's not about deferred evaluations. It's about printing. <code>println</code> function documented for completeness but are not guaranteed to stay in the language at all. Also Stdout and Stderr merged in one stream on Playground by design.\nIf you use <code>fmt.Println(...)</code> everywhere <a href=\"http://play.golang.org/p/PU3hxHCazA\" rel=\"nofollow\">http://play.golang.org/p/PU3hxHCazA</a>\nor explicitly define  <code>fmt.Fprintln(os.Stdout, ...</code> <a href=\"http://play.golang.org/p/OQpOQR2vm0\" rel=\"nofollow\">http://play.golang.org/p/OQpOQR2vm0</a> things would work as expected.</p>\n"}], "owner": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 1, "accepted_answer_id": 29318406, "answer_count": 3, "score": 1, "last_activity_date": 1427553644, "creation_date": 1427544481, "last_edit_date": 1427545986, "question_id": 29316958, "link": "https://stackoverflow.com/questions/29316958/go-inconsistent-evaluation-of-deferred-functions", "title": "Go - Inconsistent Evaluation of Deferred Functions", "body": "<p>I am experimenting with Go and am seeing some unexpected behaviour with deferred functions.  Consider the following program that increments a global variable by a given amount.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar z = 1\n\nfunc main() {\n\n    defer increaseZ(10)\n    defer fmt.Println(\"z =\", increaseZ(20), \"Deferred Value 1\")\n    defer fmt.Println(\"z =\", increaseZ(30), \"Deferred Value 2\")\n\n    fmt.Println(\"z =\", z, \"Main Value\")\n}\n\nfunc increaseZ(y int) int {\n    z += y\n    println(\"z =\", z, \"Inside Increase Function\")\n    return z\n}\n</code></pre>\n\n<p>When <a href=\"http://play.golang.org/p/6yi3bJ83K2\" rel=\"nofollow\">run in the go playground</a>, this outputs:</p>\n\n<pre><code>z = 21 Inside Increase Function\nz = 51 Inside Increase Function\nz = 61 Inside Increase Function\nz = 51 Main Value\nz = 51 Deferred Value 2\nz = 21 Deferred Value 1\n</code></pre>\n\n<p>If I switch the order of the deferred functions, it has another effect:</p>\n\n<pre><code>defer fmt.Println(\"z =\", increaseZ(20), \"Deferred Value 1\")\ndefer fmt.Println(\"z =\", increaseZ(30), \"Deferred Value 2\")\ndefer increaseZ(10)\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>z = 21 Inside Increase Function\nz = 51 Inside Increase Function\nz = 51 Main Value\nz = 61 Inside Increase Function\nz = 51 Deferred Value 2\nz = 21 Deferred Value 1\n</code></pre>\n\n<p>The Go documentation states:</p>\n\n<blockquote>\n  <p>The deferred call's arguments are evaluated immediately, but the\n  function call is not executed until the surrounding function returns.</p>\n</blockquote>\n\n<p>So <em>arguments being evaluated</em>, may explain why the Main Value returned is 51 and not 61, since the fmt.Println statements are taking <code>increaseZ</code> as an argument, but <code>defer increaseZ(10)</code> would not be called until after the main function returns.  </p>\n\n<p>However, this does not explain why in the first example the <code>increaseZ(10)</code> is outputting before main has completed, and after main has completed in the second example.</p>\n\n<p>I would be grateful if anyone could help me understand what is happening here, since this looks like fertile ground for difficult to diagnose bugs further down the line.</p>\n"}, {"tags": ["arrays", "struct", "go"], "answers": [{"tags": [], "owner": {"reputation": 4316, "user_id": 486035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1654e9816b6e407e1daced17ac4fcf3b?s=128&d=identicon&r=PG", "display_name": "phemmer", "link": "https://stackoverflow.com/users/486035/phemmer"}, "is_accepted": true, "score": 3, "last_activity_date": 1427530421, "creation_date": 1427530421, "answer_id": 29315049, "question_id": 29315014, "link": "https://stackoverflow.com/questions/29315014/go-array-in-struct-looses-its-content/29315049#29315049", "title": "go: array in struct looses its content", "body": "<p>Your <code>loadPos()</code> method is using a value receiver (as opposed to a pointer), meaning that it's operating on a copy of the <code>order</code> object.<br>\nSo when you call <code>o.loadPos()</code>, go is copying <code>o</code>, and calling <code>loadPos()</code> on that copy.</p>\n\n<p>The solution is to simply change the receiver to a pointer:</p>\n\n<pre><code>func (o *order) loadPos() {\n</code></pre>\n\n<p><sup><a href=\"https://play.golang.org/p/PATpBCZLT7\" rel=\"nofollow\">https://play.golang.org/p/PATpBCZLT7</a></sup></p>\n"}, {"tags": [], "owner": {"reputation": 7514, "user_id": 1008837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f67dc852a25a639e13fafbec62eec69?s=128&d=identicon&r=PG&f=1", "display_name": "Pravin Mishra", "link": "https://stackoverflow.com/users/1008837/pravin-mishra"}, "is_accepted": false, "score": 2, "last_activity_date": 1427536894, "last_edit_date": 1495539807, "creation_date": 1427536894, "answer_id": 29315835, "question_id": 29315014, "link": "https://stackoverflow.com/questions/29315014/go-array-in-struct-looses-its-content/29315835#29315835", "title": "go: array in struct looses its content", "body": "<p>Extending the Patrick <a href=\"https://stackoverflow.com/a/29315049/1008837\">answer</a>, there is more insight in <a href=\"https://golang.org/doc/faq#methods_on_values_or_pointers\" rel=\"nofollow noreferrer\">Golang FAQ</a></p>\n\n<p>Should I define methods on values or pointers?</p>\n\n<pre><code>func (s *MyStruct) pointerMethod() { } // method on pointer\nfunc (s MyStruct)  valueMethod()   { } // method on value\n</code></pre>\n\n<blockquote>\n  <p>First, and most important, does the method need to modify the\n  receiver? If it does, the receiver must be a pointer. (Slices and maps\n  act as references, so their story is a little more subtle, but for\n  instance to change the length of a slice in a method the receiver must\n  still be a pointer.) In the examples above, if pointerMethod modifies\n  the fields of s, the caller will see those changes, but valueMethod is\n  called with a copy of the caller's argument (that's the definition of\n  passing a value), so changes it makes will be invisible to the caller.</p>\n  \n  <p>Second is the consideration of efficiency. If the receiver is large, a\n  big struct for instance, it will be much cheaper to use a pointer\n  receiver.</p>\n  \n  <p>Next is consistency. If some of the methods of the type must have\n  pointer receivers, the rest should too, so the method set is\n  consistent regardless of how the type is used.</p>\n</blockquote>\n\n<p>For types such as basic types, slices, and small structs, a value\nreceiver is very cheap so unless the semantics of the method requires\na pointer, a value receiver is efficient and clear.</p>\n"}], "owner": {"reputation": 159, "user_id": 4673275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06fe0f333180734da76bee0c850ef4f1?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Fernandez", "link": "https://stackoverflow.com/users/4673275/mike-fernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 29315049, "answer_count": 2, "score": -1, "last_activity_date": 1427536894, "creation_date": 1427529997, "question_id": 29315014, "link": "https://stackoverflow.com/questions/29315014/go-array-in-struct-looses-its-content", "title": "go: array in struct looses its content", "body": "<p>The following go code (shared: <a href=\"https://play.golang.org/p/vGAcyzEMBQ\" rel=\"nofollow\">link</a>) should insert two positions in an order (both order and position are <em>struct</em>s:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype orderPosition struct{\n   art string\n   qty string   \n}\n\ntype order struct{\n   posList []orderPosition\n}\n\nfunc main() {\n  o := new(order)\n  o.loadPos()\n  fmt.Printf(\"# pos: %d\\n\",len(o.posList))\n\n}\n\nfunc (o order) loadPos() {\n  o.posList = append(o.posList, orderPosition {art: \"art 1\", qty: \"2 pc\"})\n  o.posList = append(o.posList, orderPosition {art: \"art 2\", qty: \"7 pc\"})\n  fmt.Printf(\"# pos: %d\\n\",len(o.posList))\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code># pos: 2\n# pos: 0    \n</code></pre>\n\n<p>The method <em>loadPos</em> fills the positions in the order. But as soon as the method is left the list of positions is lost.</p>\n\n<p>Why is the array loosing its content?</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["testing", "go"], "comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 3, "creation_date": 1427518686, "post_id": 29313626, "comment_id": 46820706, "body": "You should <a href=\"http://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\">read the documentation about testing</a> .. you have here some fundamentally wrong things that you should cover prior to attempting to write tests."}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 2, "creation_date": 1427524665, "post_id": 29313626, "comment_id": 46821632, "body": "...I linked to the documentation for you... ?"}, {"owner": {"reputation": 4316, "user_id": 486035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1654e9816b6e407e1daced17ac4fcf3b?s=128&d=identicon&r=PG", "display_name": "phemmer", "link": "https://stackoverflow.com/users/486035/phemmer"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 9, "creation_date": 1427524846, "post_id": 29313626, "comment_id": 46821658, "body": "Your comment is basically a &quot;RTFM&quot; comment without any specific examples of what is wrong or where to focus. I see absolutely nothing in the scenario I have provided that goes against the testing documentation. Certainly nothing &quot;fundamental&quot;."}, {"owner": {"reputation": 4316, "user_id": 486035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1654e9816b6e407e1daced17ac4fcf3b?s=128&d=identicon&r=PG", "display_name": "phemmer", "link": "https://stackoverflow.com/users/486035/phemmer"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427526519, "post_id": 29313626, "comment_id": 46821903, "body": "@SimonWhitehead Please see the accepted solution. The only thing wrong was missing a step."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1427553917, "post_id": 29313626, "comment_id": 46828657, "body": "@Patrick RTFM can be a perfectly valid answer. Questioners are expected to do research and read the basic relevant documents and to not be <a href=\"http://slash7.com/2006/12/22/vampires/\" rel=\"nofollow noreferrer\">help vampires</a>."}, {"owner": {"reputation": 4316, "user_id": 486035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1654e9816b6e407e1daced17ac4fcf3b?s=128&d=identicon&r=PG", "display_name": "phemmer", "link": "https://stackoverflow.com/users/486035/phemmer"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427566147, "post_id": 29313626, "comment_id": 46832788, "body": "@DaveC Except in this case I obviously had read the documentation, while Simon hadn&#39;t. If he had provided any additional info, this would have been apparent, and saved everyone headache."}, {"owner": {"reputation": 4316, "user_id": 486035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1654e9816b6e407e1daced17ac4fcf3b?s=128&d=identicon&r=PG", "display_name": "phemmer", "link": "https://stackoverflow.com/users/486035/phemmer"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427572395, "post_id": 29313626, "comment_id": 46834912, "body": "Opened a chat for further discussion on the topic: <a href=\"http://chat.stackoverflow.com/rooms/74004/29313626\">chat.stackoverflow.com/rooms/74004/29313626</a> . @SimonWhitehead, you are invited if you wish."}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427604560, "post_id": 29313626, "comment_id": 46842024, "body": "@Patrick Re-reading this.. it appears I upset you and I definitely did not intend to. I will pick my words with more care next time .. and also take more time to interpret the question better. I originally read this as &quot;I have this example, it doesn&#39;t work. Why not?&quot;. I have added a comment into your chat also."}], "answers": [{"comments": [{"owner": {"reputation": 2705, "user_id": 1501456, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/660e626ccb2d55bc2f3ca14940fb882e?s=128&d=identicon&r=PG", "display_name": "Buzzy", "link": "https://stackoverflow.com/users/1501456/buzzy"}, "edited": false, "score": 5, "creation_date": 1495429699, "post_id": 29314485, "comment_id": 75229861, "body": "Apparently it is also important <b>not</b> to have a space between the Output and the &quot;:&quot;. Putting it here in case someone else accidentally adds space there and then wastes an hour figuring out why it doesn&#39;t run."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 20, "last_activity_date": 1427524972, "creation_date": 1427524972, "answer_id": 29314485, "question_id": 29313626, "link": "https://stackoverflow.com/questions/29313626/go-example-wont-run/29314485#29314485", "title": "Go example won&#39;t run", "body": "<p>From the <a href=\"http://golang.org/pkg/testing/#hdr-Examples\">documentation</a>:</p>\n\n<blockquote>\n  <p>Example functions without output comments are compiled but not executed.</p>\n</blockquote>\n\n<p>Add an output comment:</p>\n\n<pre><code>func Example() {\n    junk.Poke()\n    // Output: MOOOO!\n}\n</code></pre>\n"}], "owner": {"reputation": 4316, "user_id": 486035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1654e9816b6e407e1daced17ac4fcf3b?s=128&d=identicon&r=PG", "display_name": "phemmer", "link": "https://stackoverflow.com/users/486035/phemmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7580, "favorite_count": 1, "accepted_answer_id": 29314485, "answer_count": 1, "score": 8, "last_activity_date": 1523982093, "creation_date": 1427516214, "last_edit_date": 1523982093, "question_id": 29313626, "link": "https://stackoverflow.com/questions/29313626/go-example-wont-run", "title": "Go example won&#39;t run", "body": "<p>I'm trying to add an example to a package, and run the example via <code>go test</code>, however the example is never run.</p>\n\n<p>For example, see this gist: <a href=\"https://gist.github.com/85469ecc65bb5bb85857\" rel=\"nofollow\">https://gist.github.com/85469ecc65bb5bb85857</a></p>\n\n<p>The gist has <code>example_test.go</code>:</p>\n\n<pre><code>package cow_test\n\nimport (\n    cow \"gist.github.com/85469ecc65bb5bb85857\"\n)\n\nfunc Example() {\n    cow.Poke()\n}\n</code></pre>\n\n<p>Yet when I run this:</p>\n\n<pre><code># go test -v example_test.go \ntesting: warning: no tests to run\nPASS\nok      command-line-arguments  0.002s\n</code></pre>\n\n<p>However other packages from stdlib work just fine:</p>\n\n<pre><code># cd /usr/lib/go/src/errors\n# go test -v example_test.go \n=== RUN: Example\n--- PASS: Example (0.00s)\nPASS\nok      command-line-arguments  0.002s\n</code></pre>\n\n<p>What is wrong with my example?</p>\n"}, {"tags": ["go", "buffer"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 4, "creation_date": 1427511879, "post_id": 29313133, "comment_id": 46819618, "body": "Don&#39;t read it all in at once. Steam it. Use <code>bufio.Scanner</code> (since you seem do indicate it&#39;s line based), process the line, insert into your db, <i>then forget that line</i>."}, {"owner": {"reputation": 169, "user_id": 4608248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a1a155709573d1fc48c4f3875e1ea7ec?s=128&d=identicon&r=PG&f=1", "display_name": "rvrtex", "link": "https://stackoverflow.com/users/4608248/rvrtex"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427540757, "post_id": 29313133, "comment_id": 46824824, "body": "Thank you for the response. How do I forget that line? In my attempts to use bufio.Scanner when I hit line 63700 (roughly) in my file I stop reading in new lines. My understanding is that it&#39;s because I hit the MaxScanTokenSize  (<a href=\"http://golang.org/pkg/bufio/#pkg-constants\" rel=\"nofollow noreferrer\">golang.org/pkg/bufio/#pkg-constants</a>) of the scanner. I would love to read the line, parse it, and throw it away but I don&#39;t know how to do the throw it away part so the scanner keeps moving through the whole file."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427547811, "post_id": 29313133, "comment_id": 46826810, "body": "@DaveC Hm... Steamed buffers."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1427547879, "post_id": 29313133, "comment_id": 46826832, "body": "@rvrtex You forget a line by not storing a reference to the corresponding string any more. For instance, if <code>line</code> is the only variable containing the line to forget, assign something else to <code>line</code> to forget the original content."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 5, "last_activity_date": 1427524735, "last_edit_date": 1427524735, "creation_date": 1427523575, "answer_id": 29314318, "question_id": 29313133, "link": "https://stackoverflow.com/questions/29313133/how-do-i-read-in-a-large-flat-file/29314318#29314318", "title": "How do I read in a large flat file", "body": "<p>It's not clear that it's necessary to read in all the lines before parsing them and inserting them into a database. Try to avoid that.</p>\n\n<p>You have a small file: \"a flat file that has 339276 line of text in it for a size of 62.1 MB.\" For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"io\"\n    \"io/ioutil\"\n)\n\nfunc readLines(filename string) ([]string, error) {\n    var lines []string\n    file, err := ioutil.ReadFile(filename)\n    if err != nil {\n        return lines, err\n    }\n    buf := bytes.NewBuffer(file)\n    for {\n        line, err := buf.ReadString('\\n')\n        if len(line) == 0 {\n            if err != nil {\n                if err == io.EOF {\n                    break\n                }\n                return lines, err\n            }\n        }\n        lines = append(lines, line)\n        if err != nil &amp;&amp; err != io.EOF {\n            return lines, err\n        }\n    }\n    return lines, nil\n}\n\nfunc main() {\n    // a flat file that has 339276 lines of text in it for a size of 62.1 MB\n    filename := \"flat.file\"\n    lines, err := readLines(filename)\n    fmt.Println(len(lines))\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 169, "user_id": 4608248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a1a155709573d1fc48c4f3875e1ea7ec?s=128&d=identicon&r=PG&f=1", "display_name": "rvrtex", "link": "https://stackoverflow.com/users/4608248/rvrtex"}, "edited": false, "score": 1, "creation_date": 1427757823, "post_id": 29317023, "comment_id": 46900534, "body": "This is the correct way to do this. After some re-factoring to forget each line input as per @DaveC suggested and using <code>.Scan()</code> and <code>.Text()</code>I ran it again and had the same problem. I then went and looked at the file I was actually running my program against and found the file was the problem. The program was doing exactly what it should be doing and I had bad files on my server side. Lesson learned, sometimes it is not bad programming but bad input. Thanks for your help, with it I made my program run much more efficiently."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 8, "last_activity_date": 1464255893, "last_edit_date": 1464255893, "creation_date": 1427544828, "answer_id": 29317023, "question_id": 29313133, "link": "https://stackoverflow.com/questions/29313133/how-do-i-read-in-a-large-flat-file/29317023#29317023", "title": "How do I read in a large flat file", "body": "<p><code>bufio.Scan()</code> and <code>bufio.Text()</code> in a loop perfectly works for me on a files with much larger size, so I suppose you have lines exceeded buffer capacity. Then </p>\n\n<ul>\n<li>check your line ending </li>\n<li>and which Go version you use <code>path, err :=r.ReadLine(\"\\n\") // 0x0A separator = newline</code>? Looks like <code>func (b *bufio.Reader) ReadLine() (line []byte, isPrefix bool, err error)</code> has return value <code>isPrefix</code> specifically for your use case\n<a href=\"http://golang.org/pkg/bufio/#Reader.ReadLine\" rel=\"noreferrer\">http://golang.org/pkg/bufio/#Reader.ReadLine</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2351, "user_id": 1661465, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/8x0xD.jpg?s=128&g=1", "display_name": "serghei", "link": "https://stackoverflow.com/users/1661465/serghei"}, "is_accepted": false, "score": 2, "last_activity_date": 1463874288, "creation_date": 1463874288, "answer_id": 37369131, "question_id": 29313133, "link": "https://stackoverflow.com/questions/29313133/how-do-i-read-in-a-large-flat-file/37369131#37369131", "title": "How do I read in a large flat file", "body": "<p>It seems to me this variant of <code>readLines</code> is shorter and faster than suggested peterSO</p>\n\n<pre><code>func readLines(filename string) (map[int]string, error) {\n    lines := make(map[int]string)\n\n    data, err := ioutil.ReadFile(filename)\n    if err != nil {\n        return nil, err\n    }\n\n    for n, line := range strings.Split(string(data), \"\\n\") {\n        lines[n] = line\n    }\n\n    return lines, nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 455, "user_id": 3797574, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/100000427948648/picture?type=large", "display_name": "Divakarcool", "link": "https://stackoverflow.com/users/3797574/divakarcool"}, "is_accepted": false, "score": 0, "last_activity_date": 1568367986, "creation_date": 1568367986, "answer_id": 57921194, "question_id": 29313133, "link": "https://stackoverflow.com/questions/29313133/how-do-i-read-in-a-large-flat-file/57921194#57921194", "title": "How do I read in a large flat file", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"log\"\n    \"bufio\"\n)\n\nfunc main() {\n    FileName := \"assets/file.txt\"\n    file, err := os.Open(FileName)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer file.Close()\n\n    scanner := bufio.NewScanner(file)\n\n    for scanner.Scan() { \n        fmt.Println(scanner.Text()) \n\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 4608248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a1a155709573d1fc48c4f3875e1ea7ec?s=128&d=identicon&r=PG&f=1", "display_name": "rvrtex", "link": "https://stackoverflow.com/users/4608248/rvrtex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18288, "favorite_count": 5, "accepted_answer_id": 29317023, "answer_count": 4, "score": 12, "last_activity_date": 1603260715, "creation_date": 1427511282, "last_edit_date": 1603260715, "question_id": 29313133, "link": "https://stackoverflow.com/questions/29313133/how-do-i-read-in-a-large-flat-file", "title": "How do I read in a large flat file", "body": "<p>I have a flat file that has 339276 line of text in it for a size of 62.1 MB. I am attempting to read in all the lines, parse them based on some conditions I have and then insert them into a database. </p>\n\n<p>I originally attempted to use a bufio.Scan() loop and bufio.Text() to get the line but I was running out of buffer space. I switched to using bufio.ReadLine/ReadString/ReadByte (I tried each) and had the same problem with each. I didn't have enough buffer space. </p>\n\n<p>I tried using read and setting the buffer size but as the document says it actually a const that can be made smaller but never bigger that 64*1024 bytes. I then tried to use File.ReadAt where I set the starting postilion and moved it along as I brought in each section to no avail. I have looked at the following examples and explanations (not an exhaustive list): </p>\n\n<p><a href=\"https://stackoverflow.com/questions/5884154/golang-read-text-file-into-string-array-and-write\">Read text file into string array (and write)</a>\n<a href=\"https://stackoverflow.com/questions/17863821/how-to-read-last-lines-from-a-big-file-with-go-every-10-secs\">How to Read last lines from a big file with Go every 10 secs</a>\n<a href=\"https://stackoverflow.com/questions/8757389/reading-file-line-by-line-in-go\">reading file line by line in go</a></p>\n\n<p>How do I read in an entire file (either line by line or the whole thing at once) into a slice so I can then go do things to the lines?</p>\n\n<p>Here is some code that I have tried:   </p>\n\n<pre><code>                 file, err := os.Open(feedFolder + value)\n                 handleError(err)\n                 defer file.Close()\n                 //              fileInfo, _ := file.Stat()\n                 var linesInFile []string\n\n             r := bufio.NewReader(file)\n             for {\n                     path, err := r.ReadLine(\"\\n\") // 0x0A separator = newline\n\n                     linesInFile = append(linesInFile, path)\n                     if err == io.EOF {\n                             fmt.Printf(\"End Of File: %s\", err)\n                             break\n                     } else if err != nil {\n                             handleError(err) // if you return error\n                     }\n             }\n             fmt.Println(\"Last Line: \", linesInFile[len(linesInFile)-1])\n</code></pre>\n\n<p>Here is something else I tried:  </p>\n\n<pre><code>var fileSize int64 = fileInfo.Size()\n    fmt.Printf(\"File Size: %d\\t\", fileSize)\n    var bufferSize int64 = 1024 * 60\n    bytes := make([]byte, bufferSize)\n    var fullFile []byte\n    var start int64 = 0\n    var interationCounter int64 = 1\n    var currentErr error = nil\n         for currentErr != io.EOF {\n            _, currentErr = file.ReadAt(bytes, st)\n            fullFile = append(fullFile, bytes...)\n            start = (bufferSize * interationCounter) + 1\n            interationCounter++\n          }\n     fmt.Printf(\"Err: %s\\n\", currentErr)\n     fmt.Printf(\"fullFile Size: %s\\n\", len(fullFile))\n     fmt.Printf(\"Start: %d\", start)\n\n     var currentLine []string\n\n\n   for _, value := range fullFile {\n      if string(value) != \"\\n\" {\n          currentLine = append(currentLine, string(value))\n      } else {\n         singleLine := strings.Join(currentLine, \"\")\n         linesInFile = append(linesInFile, singleLine)\n         currentLine = nil\n              }   \n      }\n</code></pre>\n\n<p>I am at a loss. Either I don't understand exactly how the buffer works or I don't understand something else. Thanks for reading. </p>\n"}, {"tags": ["types", "go", "inference"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1427489954, "post_id": 29309922, "comment_id": 46813974, "body": "This is probably due to the fact that you are running Go in a 32 bit environment. On a 64 bit machine both expressions are fine."}, {"owner": {"reputation": 86, "user_id": 4722305, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-P-6_rOryewY/AAAAAAAAAAI/AAAAAAAAAGw/RRnQe7CyVig/photo.jpg?sz=128", "display_name": "Tristan Rice", "link": "https://stackoverflow.com/users/4722305/tristan-rice"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1427490102, "post_id": 29309922, "comment_id": 46814039, "body": "That&#39;s not it. Both my OS and Go are 64 bit."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1427491277, "post_id": 29309922, "comment_id": 46814553, "body": "are you sure? what does <code>go env GOARCH</code> output?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1427491605, "post_id": 29309922, "comment_id": 46814710, "body": "@TristanRice @JimB at least the playground has 32 bit ints - <code>GOARCH</code> there prints <code>amd64p32</code> which AFAIK means that an integer is 32 bit wide."}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1427491798, "post_id": 29309922, "comment_id": 46814807, "body": "Works on my machine as expected &#39;Darwin Kernel Version 13.4.0: Sun Aug 17 19:50:11 PDT 2014; root:xnu-2422.115.4~1/RELEASE_X86_64&#39;"}, {"owner": {"reputation": 86, "user_id": 4722305, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-P-6_rOryewY/AAAAAAAAAAI/AAAAAAAAAGw/RRnQe7CyVig/photo.jpg?sz=128", "display_name": "Tristan Rice", "link": "https://stackoverflow.com/users/4722305/tristan-rice"}, "edited": false, "score": 0, "creation_date": 1427501725, "post_id": 29309922, "comment_id": 46817806, "body": "My bad. MaxInt64 works just fine on my system, but MaxUint64 doesn&#39;t."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427511245, "post_id": 29309922, "comment_id": 46819498, "body": "See also <a href=\"https://blog.golang.org/constants\" rel=\"nofollow noreferrer\">The Go Blog: Constants</a>"}], "answers": [{"comments": [{"owner": {"reputation": 86, "user_id": 4722305, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-P-6_rOryewY/AAAAAAAAAAI/AAAAAAAAAGw/RRnQe7CyVig/photo.jpg?sz=128", "display_name": "Tristan Rice", "link": "https://stackoverflow.com/users/4722305/tristan-rice"}, "edited": false, "score": 0, "creation_date": 1427501775, "post_id": 29310474, "comment_id": 46817811, "body": "Thanks! That explains it."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 7, "last_activity_date": 1427491604, "creation_date": 1427491604, "answer_id": 29310474, "question_id": 29309922, "link": "https://stackoverflow.com/questions/29309922/go-math-maxint64-and-type-inference-error/29310474#29310474", "title": "Go - math.MaxInt64 and Type Inference Error", "body": "<p><code>math.MaxInt64</code> is an <a href=\"http://golang.org/ref/spec#Constants\"><code>Untyped Constant</code></a>. Numeric constants represent values of arbitrary precision and do not overflow. When you assign this to a variable it needs to be converted to a numeric type, and if none is specified, <code>int</code> is used by default.</p>\n\n<p>Since the <code>int</code> type in Go represents the native size for your architecture, this will overflow on systems with 32 bit <code>int</code>s.</p>\n"}], "owner": {"reputation": 86, "user_id": 4722305, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-P-6_rOryewY/AAAAAAAAAAI/AAAAAAAAAGw/RRnQe7CyVig/photo.jpg?sz=128", "display_name": "Tristan Rice", "link": "https://stackoverflow.com/users/4722305/tristan-rice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1167, "favorite_count": 0, "accepted_answer_id": 29310474, "answer_count": 1, "score": 2, "last_activity_date": 1427491604, "creation_date": 1427489238, "question_id": 29309922, "link": "https://stackoverflow.com/questions/29309922/go-math-maxint64-and-type-inference-error", "title": "Go - math.MaxInt64 and Type Inference Error", "body": "<p>I've been working on metaprogramming involving packages and I've been running into the error <code>constant 9223372036854775807 overflows int</code> whenever <code>math.MaxInt64</code> and <code>math.MaxUint64</code> show up.</p>\n\n<p>I've isolated it into two cases:</p>\n\n<p>Valid</p>\n\n<pre><code>var a int64 = math.MaxInt64\nb := interface{}(int64(math.MaxInt64))\n</code></pre>\n\n<p>Not Valid</p>\n\n<pre><code>a := math.MaxInt64\nb := interface{}(math.MaxInt64)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/U1QDmFbV29\" rel=\"nofollow\">https://play.golang.org/p/U1QDmFbV29</a></p>\n\n<p>It seems like that Go doesn't do correct type inference.</p>\n\n<p>Is this a bug or expected behavior? And if expect, does anyone know why?</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 719, "user_id": 2388005, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/273ccccd4233ba91e2eb7bc0696bedf6?s=128&d=identicon&r=PG", "display_name": "Fakeer", "link": "https://stackoverflow.com/users/2388005/fakeer"}, "edited": false, "score": 0, "creation_date": 1427518221, "post_id": 29309846, "comment_id": 46820638, "body": "Tried this in my Go project source and got &quot;package code.google.com/p/gofpdf: unable to detect version control system for code.google.com/ path&quot;"}, {"owner": {"reputation": 719, "user_id": 2388005, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/273ccccd4233ba91e2eb7bc0696bedf6?s=128&d=identicon&r=PG", "display_name": "Fakeer", "link": "https://stackoverflow.com/users/2388005/fakeer"}, "edited": false, "score": 0, "creation_date": 1427525122, "post_id": 29309846, "comment_id": 46821704, "body": "Since pdf didn&#39;t work I tried go get github.com/revel/revel instead. The result was a compile error &quot;Failed parsing input: parser: bad import &quot;syscall&quot; in src\\golang.org\\x\\net\\ipv4\\payload_nocmsg.go&quot;. Any help is appreciated."}, {"owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "edited": false, "score": 1, "creation_date": 1427606359, "post_id": 29309846, "comment_id": 46842272, "body": "The first error is because you don&#39;t have the proper version control installed, you probably need to install mercurial. The second is because appengine restricts what can be used. The syscall package is one which is restricted. unsafe is also disallowed."}], "tags": [], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "is_accepted": false, "score": 3, "last_activity_date": 1427488906, "creation_date": 1427488906, "answer_id": 29309846, "question_id": 29309382, "link": "https://stackoverflow.com/questions/29309382/how-to-include-3rd-party-libraries-in-go-on-appengine/29309846#29309846", "title": "How to include 3rd party libraries in Go on AppEngine?", "body": "<p>If you want to use third party libraries   in go \nyou usually us the <strong>go -get command</strong><br>\nIn your case it wil be </p>\n\n<pre><code>go get code.google.com/p/gofpdf\n</code></pre>\n\n<p>I suggest that you will this this  doc on go</p>\n\n<p><a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">How to Write Go Code</a></p>\n"}], "owner": {"reputation": 719, "user_id": 2388005, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/273ccccd4233ba91e2eb7bc0696bedf6?s=128&d=identicon&r=PG", "display_name": "Fakeer", "link": "https://stackoverflow.com/users/2388005/fakeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427488906, "creation_date": 1427486984, "question_id": 29309382, "link": "https://stackoverflow.com/questions/29309382/how-to-include-3rd-party-libraries-in-go-on-appengine", "title": "How to include 3rd party libraries in Go on AppEngine?", "body": "<p>I want to use the pdf library <a href=\"https://godoc.org/code.google.com/p/gofpdf\" rel=\"nofollow\">https://godoc.org/code.google.com/p/gofpdf</a>. I only have the GAE SDK for Go installed and nothing else. i would like to be able to do:</p>\n\n<pre><code>import \"code.google.com/p/gofpdf\"\n</code></pre>\n\n<p>I have a feeling the entire library has to be downloaded into my codebase?</p>\n"}, {"tags": ["xml", "go", "decode", "attr", "unmarshalling"], "comments": [{"owner": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "edited": false, "score": 3, "creation_date": 1427477878, "post_id": 29306782, "comment_id": 46807932, "body": "Can you be more specific? What&#39;s the exact issue you&#39;re having?"}, {"owner": {"reputation": 13, "user_id": 4721586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cr_c_F0DTAs/AAAAAAAAAAI/AAAAAAAAADU/UblwW5hRffw/photo.jpg?sz=128", "display_name": "paulcull", "link": "https://stackoverflow.com/users/4721586/paulcull"}, "reply_to_user": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "edited": false, "score": 0, "creation_date": 1427480193, "post_id": 29306782, "comment_id": 46809148, "body": "The resulting object does not contain all the elements - <code>{Error:0 Context:2 LoginState:3 DI:0 DO:0 Clock:{Date:0&#47;0&#47;0 Time:12:54:52 Day:3} OWbus: Tmps:{Tmp:{ID:5 low: high: value:}} AOS:{AO:0} AIS:{AI:0}}</code> AOs and AIs are not holding values from the XML message, and the TMP is only holding the last TMP value"}, {"owner": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "edited": false, "score": 0, "creation_date": 1427482309, "post_id": 29306782, "comment_id": 46810236, "body": "As maerics said, you want to make sure that you have array types where you need array types."}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 2, "last_activity_date": 1427486392, "last_edit_date": 1427486392, "creation_date": 1427480658, "answer_id": 29307664, "question_id": 29306782, "link": "https://stackoverflow.com/questions/29306782/golang-xml-decoding-with-attr/29307664#29307664", "title": "Golang - XML decoding with attr", "body": "<p>Your modeling is very close, you just need to fix the type of the \"array holder\" struct elements (Tmps, AOs, AIs).  Try this:</p>\n\n<pre><code>type Tmps struct {\n  Tmp []Tmp\n}\ntype AOs struct {\n  AO []AO\n}\ntype AIs struct {\n  AI []AI\n}\n</code></pre>\n\n<p>Note also that the XML package will expect the <a href=\"http://golang.org/pkg/encoding/xml/#Unmarshal\" rel=\"nofollow\">XML element name to match the struct field name</a> unless otherwise specified, so you can omit some <code>xml:\"...\"</code> tags.</p>\n\n<p>Here is <a href=\"https://play.golang.org/p/jqlU4PSncA\" rel=\"nofollow\">a simplified example on the go playground</a>.</p>\n"}], "owner": {"reputation": 13, "user_id": 4721586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cr_c_F0DTAs/AAAAAAAAAAI/AAAAAAAAADU/UblwW5hRffw/photo.jpg?sz=128", "display_name": "paulcull", "link": "https://stackoverflow.com/users/4721586/paulcull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 973, "favorite_count": 0, "accepted_answer_id": 29307664, "answer_count": 1, "score": 1, "last_activity_date": 1427486392, "creation_date": 1427477734, "last_edit_date": 1427480576, "question_id": 29306782, "link": "https://stackoverflow.com/questions/29306782/golang-xml-decoding-with-attr", "title": "Golang - XML decoding with attr", "body": "<p>I've got stuck with trying to unmarshall some XML from an old device I'm trying to read from.</p>\n\n<p>The device produces XML in ISO-8859-1 format. I've managed to transcode, but am struggling to map the elements and attributes to my output model.</p>\n\n<p>I've not found any questions that combine these, and don't know if this is causing the issue.</p>\n\n<p>The issue is that not all of the XML details are being mapped to my object</p>\n\n<pre><code>{Error:0 Context:2 LoginState:3 DI:0 DO:0 Clock:{Date:0/0/0 Time:12:54:52 Day:3} OWbus: Tmps:{Tmp:{ID:5 low: high: value:}} AOS:{AO:0} AIS:{AI:0}}\n</code></pre>\n\n<p>The Tmps only holds the last repeat, and the AOS and AIS are not being mapped.</p>\n\n<p>Here's a standalone test wrapper with an example xml output. </p>\n\n<pre><code>    package main\n\n// go-webbrck is a lightweight package that is used to control a variety the legacy webbrick products\n\nimport (\n    \"bytes\"\n    \"code.google.com/p/go-charset/charset\" // For XML conversion\n    _ \"code.google.com/p/go-charset/data\"  // Specs for dataset conversion\n    \"encoding/xml\"                         // For XML work\n    \"fmt\"                                  // For outputting stuff\n)\n\ntype Clock struct {\n    Date string\n    Time string\n    Day  string\n}\n\ntype Tmps struct {\n    Tmp Tmp `xml:\"Tmp\"`\n}\n\ntype Tmp struct {\n    ID    string `xml:\"id,attr\"`\n    low   string `xml:\"low,attr\"`\n    high  string `xml:\"high,attr\"`\n    value string `xml:\",chardata\"`\n}\n\ntype AOs struct {\n    AO string `xml:\"AO\"`\n}\n\ntype AO struct {\n    id string `xml:\"id,attr\"`\n    AO string `xml:\",chardata\"`\n}\n\ntype AIs struct {\n    AI string `xml:\"AI\"`\n}\n\ntype AI struct {\n    id   string `xml:\"id,attr\"`\n    low  string `xml:\"low,attr\"`\n    high string `xml:\"high,attr\"`\n    AI   string `xml:\",chardata\"`\n}\n\ntype WebbrickStatus struct {\n    Error      string\n    Context    string\n    LoginState string\n    DI         string\n    DO         string\n    Clock      Clock `xml:\"Clock\"`\n    OWbus      string\n    Tmps       Tmps `xml:\"Tmps\"`\n    AOS        AOs  `xml:\"AOs\"`\n    AIS        AIs  `xml:\"AIs\"`\n}\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    GetWBStatus()\n}\n\n// Get WB Status on Initilisation\nfunc GetWBStatus() bool {\n\n    //var msg string\n    var strMsg string\n    strMsg = `&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;\n&lt;WebbrickStatus Ver=\"6.1.614\"&gt;\n&lt;Error&gt;0&lt;/Error&gt;\n&lt;Context&gt;2&lt;/Context&gt;\n&lt;LoginState&gt;3&lt;/LoginState&gt;\n&lt;DI&gt;0&lt;/DI&gt;\n&lt;DO&gt;0&lt;/DO&gt;\n&lt;Clock&gt;\n  &lt;Date&gt;0/0/0&lt;/Date&gt;\n  &lt;Time&gt;12:54:52&lt;/Time&gt;\n  &lt;Day&gt;3&lt;/Day&gt;\n&lt;/Clock&gt;\n&lt;OWBus&gt;1&lt;/OWBus&gt;\n&lt;Tmps&gt;\n  &lt;Tmp id=\"1\" lo=\"-800\" hi=\"384\"&gt;283&lt;/Tmp&gt;\n  &lt;Tmp id=\"2\" lo=\"-800\" hi=\"1600\"&gt;0&lt;/Tmp&gt;\n  &lt;Tmp id=\"3\" lo=\"-800\" hi=\"1600\"&gt;0&lt;/Tmp&gt;\n  &lt;Tmp id=\"4\" lo=\"-800\" hi=\"1600\"&gt;0&lt;/Tmp&gt;\n  &lt;Tmp id=\"5\" lo=\"-800\" hi=\"1600\"&gt;0&lt;/Tmp&gt;\n&lt;/Tmps&gt;\n&lt;AOs&gt;\n  &lt;AO id=\"0\"&gt;0&lt;/AO&gt;\n  &lt;AO id=\"1\"&gt;0&lt;/AO&gt;\n  &lt;AO id=\"2\"&gt;0&lt;/AO&gt;\n  &lt;AO id=\"3\"&gt;0&lt;/AO&gt;\n&lt;/AOs&gt;\n&lt;AIs&gt;\n  &lt;AI id=\"0\" lo=\"0\" hi=\"100\"&gt;1&lt;/AI&gt;\n  &lt;AI id=\"1\" lo=\"0\" hi=\"100\"&gt;0&lt;/AI&gt;\n  &lt;AI id=\"2\" lo=\"0\" hi=\"100\"&gt;0&lt;/AI&gt;\n  &lt;AI id=\"3\" lo=\"0\" hi=\"100\"&gt;0&lt;/AI&gt;\n&lt;/AIs&gt;\n&lt;/WebbrickStatus&gt;`\n\n    fmt.Println(\"\\n\\n*** Setting up\\n==============\\n\\n\")\n    fmt.Printf(\"%v\", strMsg)\n    msg := []byte(strMsg)\n\n    // // Decode XML encoding\n    var _wbs WebbrickStatus                   // create container to load the xml\n    reader := bytes.NewReader(msg)            // create a new reader for transcoding to utf-8\n    decoder := xml.NewDecoder(reader)         // create a new xml decoder\n    decoder.CharsetReader = charset.NewReader // bind the reader to the decoder\n    fmt.Println(\"*** Decoding\\n\")\n    xmlerr := decoder.Decode(&amp;_wbs) // unmarshall the xml\n    if xmlerr != nil {\n        fmt.Printf(\"error: %v\", xmlerr)\n        return false\n    }\n\n    fmt.Println(\"*** Result\\n\")\n\n    fmt.Printf(\"%+v\\n\\n\\n\", _wbs)\n\n    return true\n\n}\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"comments": [{"owner": {"reputation": 2013, "user_id": 219912, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/edb8a30b7125b23b5ddae9047019f1e0?s=128&d=identicon&r=PG", "display_name": "Steven Lu", "link": "https://stackoverflow.com/users/219912/steven-lu"}, "edited": false, "score": 0, "creation_date": 1427487505, "post_id": 29306818, "comment_id": 46812803, "body": "Thanks! Looks like I was searching for the wrong thing. Searching for <code>MultiError</code> instantaneously found me solutions. <a href=\"http://stackoverflow.com/questions/15252521/gae-go-how-to-use-getmulti-with-non-existent-entity-keys\" title=\"gae go how to use getmulti with non existent entity keys\">stackoverflow.com/questions/15252521/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "is_accepted": true, "score": 2, "last_activity_date": 1427477845, "creation_date": 1427477845, "answer_id": 29306818, "question_id": 29305850, "link": "https://stackoverflow.com/questions/29305850/querying-with-an-array-of-arbitrary-keys-on-google-datastore-in-golang/29306818#29306818", "title": "Querying with an array of arbitrary keys on Google datastore in Golang", "body": "<p>You need to type assert the error to an appengine.MultiError. This way you can get access to the errors for an individual entity. </p>\n\n<pre><code>if me, ok := err.(appengine.MultiError); ok {\n    for i, e := range me {\n        // e != nil if entity i failed\n    }\n} else {\n   // something else went wrong (timeout, etc).\n}\n</code></pre>\n\n<p>See the docs for MultiError <a href=\"https://cloud.google.com/appengine/docs/go/reference#MultiError\" rel=\"nofollow\">here</a></p>\n"}], "owner": {"reputation": 2013, "user_id": 219912, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/edb8a30b7125b23b5ddae9047019f1e0?s=128&d=identicon&r=PG", "display_name": "Steven Lu", "link": "https://stackoverflow.com/users/219912/steven-lu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 29306818, "answer_count": 1, "score": 1, "last_activity_date": 1475291127, "creation_date": 1427474575, "last_edit_date": 1495541637, "question_id": 29305850, "link": "https://stackoverflow.com/questions/29305850/querying-with-an-array-of-arbitrary-keys-on-google-datastore-in-golang", "title": "Querying with an array of arbitrary keys on Google datastore in Golang", "body": "<p>A continuation from this question:</p>\n\n<blockquote>\n  <p><a href=\"https://stackoverflow.com/questions/29202516/doing-a-in-array-query-on-google-app-engine-datastore-with-golang/29204370#29204370\">Doing a &quot;IN Array&quot; query on google app engine datastore with golang</a></p>\n</blockquote>\n\n<p>Right now, I am following the suggestion from the previous question on querying with an array of keys/ids <code>ids []int64</code>. These IDs may or may not actually exist (they have been deleted, but the reference on other instances have not been removed).</p>\n\n<p>My method of trying to obtain these instances looks like so:</p>\n\n<pre><code>var keys []*datastore.Key\n\nfor _, id := range ids {\n    keys = append(keys, datastore.NewKey(c, \"Category\", \"\", id, nil))\n}\n\ncategories := make([]Category, len(keys))\nerr := datastore.GetMulti(c, keys, categories)\nif err != nil {\n    return nil, err\n}\n\nfor i := 0; i &lt; len(categories); i++ {\n    categories[i].Id = keys[i].IntID()\n}\n</code></pre>\n\n<p>However, it errors out throwing me:</p>\n\n<pre><code>datastore: no such entity\n</code></pre>\n\n<p>I could on the other hand grab each one individually, but is there a more efficient way to approach this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 2, "creation_date": 1427470187, "post_id": 29304338, "comment_id": 46803173, "body": "Please provide sample code that demonstrates the output you see and your attempt to correct the unexpected behavior."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1427470226, "post_id": 29304338, "comment_id": 46803196, "body": "can you show exactly what is in your []byte slice? The literal value <code>\\u003C</code> should be <code>&lt;</code> since go always assumes utf-8."}, {"owner": {"reputation": 291, "user_id": 965538, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d9cede1d65dda79733c2b53fe12e8eca?s=128&d=identicon&r=PG", "display_name": "worthspending", "link": "https://stackoverflow.com/users/965538/worthspending"}, "edited": false, "score": 0, "creation_date": 1427471217, "post_id": 29304338, "comment_id": 46803853, "body": "I edited the post a little.  Hopefully that provides more of a context.  thx"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1427471280, "post_id": 29304338, "comment_id": 46803917, "body": "Why are you using <code>json.RawMessage</code> there? If a json encoder encoded message, presumably you want a json decoder to decode it."}, {"owner": {"reputation": 291, "user_id": 965538, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d9cede1d65dda79733c2b53fe12e8eca?s=128&d=identicon&r=PG", "display_name": "worthspending", "link": "https://stackoverflow.com/users/965538/worthspending"}, "edited": false, "score": 0, "creation_date": 1427471733, "post_id": 29304338, "comment_id": 46804217, "body": "because, the value is a generic value.  It can be anything.  So, the question is: how do I convert the unicode contained within a byte array to the character equivalent?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1427473052, "post_id": 29304338, "comment_id": 46805098, "body": "a <code>json.RawMessage</code> hasn&#39;t been unmarshaled. You either need to unmarshal it into a string(<a href=\"http://golang.org/pkg/encoding/json/#example_RawMessage\" rel=\"nofollow noreferrer\">example</a>), or unescape the unicode yourself."}], "answers": [{"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 3, "last_activity_date": 1427476526, "last_edit_date": 1427476526, "creation_date": 1427472672, "answer_id": 29305240, "question_id": 29304338, "link": "https://stackoverflow.com/questions/29304338/golang-convert-byte-array-containing-unicode/29305240#29305240", "title": "golang convert byte array containing unicode", "body": "<p>You decided to use <code>json.RawMessage</code> to prevent parsing of the value with key <code>value</code> in your json message.</p>\n\n<p>The string literal <code>\"\\u003chtml\\u003e\"</code> is a valid json representation of <code>\"&lt;html&gt;\"</code>.</p>\n\n<p>Since you told <code>json.Unmarshal</code> not to parse this part, it does not parse it and returns it to you as-is.</p>\n\n<p>If you want to have it parsed into an UTF-8 string, then change the definition of <code>MyStruct</code> to:</p>\n\n<pre><code>type MyStruct struct {\n    Value string `json:\"value\"`\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 598, "user_id": 9552116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Coconut", "link": "https://stackoverflow.com/users/9552116/coconut"}, "is_accepted": false, "score": 2, "last_activity_date": 1532854582, "creation_date": 1532854582, "answer_id": 51578746, "question_id": 29304338, "link": "https://stackoverflow.com/questions/29304338/golang-convert-byte-array-containing-unicode/51578746#51578746", "title": "golang convert byte array containing unicode", "body": "<p>There is a way to convert escaped unicode characters in <a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow noreferrer\"><code>json.RawMessage</code></a> into just valid UTF8 characters without unmarshalling it. (I had to deal with the issue since my primary language is Korean.)</p>\n\n<p>You can use the <a href=\"https://golang.org/pkg/strconv/#Quote\" rel=\"nofollow noreferrer\"><code>strconv.Quote()</code></a> and <a href=\"https://golang.org/pkg/strconv/#Unquote\" rel=\"nofollow noreferrer\"><code>strconv.Unquote()</code></a> to do the conversion.</p>\n\n<pre><code>func _UnescapeUnicodeCharactersInJSON(_jsonRaw json.RawMessage) (json.RawMessage, error) {\n    str, err := strconv.Unquote(strings.Replace(strconv.Quote(string(_jsonRaw)), `\\\\u`, `\\u`, -1))\n    if err != nil {\n        return nil, err\n    }\n    return []byte(str), nil\n}\n\nfunc main() {\n    // Both are valid JSON.\n    var jsonRawEscaped json.RawMessage   // json raw with escaped unicode chars\n    var jsonRawUnescaped json.RawMessage // json raw with unescaped unicode chars\n\n    // '\\u263a' == '\u263a'\n    jsonRawEscaped = []byte(`{\"HelloWorld\": \"\\uC548\\uB155, \\uC138\\uC0C1(\\u4E16\\u4E0A). \\u263a\"}`) // \"\\\\u263a\"\n    jsonRawUnescaped, _ = _UnescapeUnicodeCharactersInJSON(jsonRawEscaped)                        // \"\u263a\"\n\n    fmt.Println(string(jsonRawEscaped))   // {\"HelloWorld\": \"\\uC548\\uB155, \\uC138\\uC0C1(\\u4E16\\u4E0A). \\u263a\"}\n    fmt.Println(string(jsonRawUnescaped)) // {\"HelloWorld\": \"\uc548\ub155, \uc138\uc0c1(\u4e16\u4e0a). \u263a\"}\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/pUsrzrrcDG-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/pUsrzrrcDG-</a></p>\n\n<p>Hope this helps :D</p>\n"}], "owner": {"reputation": 291, "user_id": 965538, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d9cede1d65dda79733c2b53fe12e8eca?s=128&d=identicon&r=PG", "display_name": "worthspending", "link": "https://stackoverflow.com/users/965538/worthspending"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2416, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1532854582, "creation_date": 1427470007, "last_edit_date": 1427472034, "question_id": 29304338, "link": "https://stackoverflow.com/questions/29304338/golang-convert-byte-array-containing-unicode", "title": "golang convert byte array containing unicode", "body": "<pre><code>type MyStruct struct {\n    Value json.RawMessage `json:\"value\"`\n}\n\nvar resp *http.Response\n\nif resp, err = http.DefaultClient.Do(req); err == nil {\n    if resp.StatusCode == 200 {\n        var buffer []byte\n        if buffer, err = ioutil.ReadAll(resp.Body); err == nil {\n\n            mystruct = &amp;MyStruct{}\n            err = json.Unmarshal(buffer, mystruct)\n\n        }\n    }\n}\n\nfmt.Println(string(mystruct.Value))\n</code></pre>\n\n<p>it produces something like:</p>\n\n<pre><code>   \\u003Chead&gt;\\n  \\u003C/head&gt;\\n  \\u003Cbody&gt;\n</code></pre>\n\n<p>Doc at: <a href=\"http://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow\">http://golang.org/pkg/encoding/json/#Unmarshal</a></p>\n\n<p>says:\nWhen unmarshaling quoted strings, invalid UTF-8 or invalid UTF-16 surrogate pairs are not treated as an error. Instead, they are replaced by the Unicode replacement character U+FFFD.</p>\n\n<p>I kinda think this is what is going on.  I just can't see the answer as my experience with go is minimal and I'm tired.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1427459927, "post_id": 29300607, "comment_id": 46796316, "body": "BTW: gofmt your code. And if you ever have to read or approve a diff you&#39;ll start appreciating Go&#39;s style."}, {"owner": {"reputation": 12342, "user_id": 1300892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f3a5c87c28be1e3d1d31281c613deb?s=128&d=identicon&r=PG", "display_name": "Sverri M. Olsen", "link": "https://stackoverflow.com/users/1300892/sverri-m-olsen"}, "edited": false, "score": 2, "creation_date": 1427460038, "post_id": 29300607, "comment_id": 46796388, "body": "Go is a quite opinionated language. This is one of those opinions. The more you fight it, the more you will dislike the language. Just submit to the Gods and all will be well."}, {"owner": {"reputation": 751, "user_id": 1035699, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c34d74af214d50942081d3bfce6b5b4d?s=128&d=identicon&r=PG", "display_name": "BojanT", "link": "https://stackoverflow.com/users/1035699/bojant"}, "edited": false, "score": 2, "creation_date": 1427460281, "post_id": 29300607, "comment_id": 46796565, "body": "It wont gofmt <code>missing &#39;,&#39; before newline in composite literal</code>"}], "answers": [{"comments": [{"owner": {"reputation": 751, "user_id": 1035699, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c34d74af214d50942081d3bfce6b5b4d?s=128&d=identicon&r=PG", "display_name": "BojanT", "link": "https://stackoverflow.com/users/1035699/bojant"}, "edited": false, "score": 0, "creation_date": 1427459545, "post_id": 29300697, "comment_id": 46796086, "body": "I don&#39;t see much difference in having one more new line , I&#39;ll edit a question to be more specific"}, {"owner": {"reputation": 751, "user_id": 1035699, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c34d74af214d50942081d3bfce6b5b4d?s=128&d=identicon&r=PG", "display_name": "BojanT", "link": "https://stackoverflow.com/users/1035699/bojant"}, "edited": false, "score": 0, "creation_date": 1427460045, "post_id": 29300697, "comment_id": 46796395, "body": "I guess nobody understood my question, the first code snippet wont compile , but second one will compile  , in PHP JS first snippet is legit !"}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 751, "user_id": 1035699, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c34d74af214d50942081d3bfce6b5b4d?s=128&d=identicon&r=PG", "display_name": "BojanT", "link": "https://stackoverflow.com/users/1035699/bojant"}, "edited": false, "score": 8, "creation_date": 1427461418, "post_id": 29300697, "comment_id": 46797301, "body": "Well, your question was &quot;Is it the intended behavior that I have to add a comma at the end of the line or remove the newline&quot;. And the answer is yes."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": 14, "last_activity_date": 1427459697, "last_edit_date": 1427459697, "creation_date": 1427459311, "answer_id": 29300697, "question_id": 29300607, "link": "https://stackoverflow.com/questions/29300607/golang-bug-or-intended-feature-on-map-literals/29300697#29300697", "title": "Golang bug or intended feature on map literals?", "body": "<p>Yes it is. And you should choose the added comma.</p>\n\n<p>It is much more simple to edit map/slice literals that way : you can copy-paster, move items around without worrying about the fact that the last item shouldn't be followed by a comma.</p>\n\n<p>In fact, you can also do the same in PHP, javascript, and many other languages.</p>\n"}, {"comments": [{"owner": {"reputation": 14069, "user_id": 975129, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/376b5c51229d1bf892f6ecca1695aae3?s=128&d=identicon&r=PG", "display_name": "kfmfe04", "link": "https://stackoverflow.com/users/975129/kfmfe04"}, "edited": false, "score": 3, "creation_date": 1531791687, "post_id": 29301344, "comment_id": 89716095, "body": "Wow!  This certainly violates POLA - a bit of a blemish to a beautiful, simple language that is golang (relative to C++)."}, {"owner": {"reputation": 8130, "user_id": 239657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53c0fe850111d3f1bbd41c24c7c62b3?s=128&d=identicon&r=PG", "display_name": "Beni Cherniavsky-Paskin", "link": "https://stackoverflow.com/users/239657/beni-cherniavsky-paskin"}, "edited": false, "score": 1, "creation_date": 1564042246, "post_id": 29301344, "comment_id": 100902914, "body": "POLA = Principle of Least Astonishment.  The formal reason \u2014 yeah quite surprising \u2014 but the actual error message doesn&#39;t say confusing stuff like &quot;missing } before ;&quot;...  It says &quot;need trailing comma before newline in composite literal&quot; which is very clear and not astonishing \ud83d\udc4d.  I do prefer Python&#39;s definition of &quot;logical line can&#39;t end until you closed all )]}&quot;, and semicolon insertion had a history of astonishing people in JS, but I guess in Go they more carefully made astonishing scenarios invalid?  At least I never hit one."}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 44, "last_activity_date": 1427461335, "creation_date": 1427461335, "answer_id": 29301344, "question_id": 29300607, "link": "https://stackoverflow.com/questions/29300607/golang-bug-or-intended-feature-on-map-literals/29301344#29301344", "title": "Golang bug or intended feature on map literals?", "body": "<p>Go has semicolons, but you don't see them because they're inserted automatically by the lexer.</p>\n\n<p><a href=\"https://golang.org/ref/spec#Semicolons\">Semicolon insertion rules</a>:</p>\n\n<blockquote>\n  <p>a semicolon is automatically inserted into the token stream at the end of a non-blank line if the line's final token is</p>\n  \n  <ul>\n  <li>an integer, floating-point, imaginary, rune, or <strong>string literal</strong></li>\n  </ul>\n</blockquote>\n\n<p>So this:</p>\n\n<pre><code>mapa := map[string]string{\n    \"jedan\": \"one\",\n    \"dva\":   \"two\"\n}\n</code></pre>\n\n<p>is actually:</p>\n\n<pre><code>mapa := map[string]string{\n    \"jedan\": \"one\",\n    \"dva\":   \"two\";  // &lt;- semicolon\n}\n</code></pre>\n\n<p>Which is invalid Go.</p>\n"}], "owner": {"reputation": 751, "user_id": 1035699, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c34d74af214d50942081d3bfce6b5b4d?s=128&d=identicon&r=PG", "display_name": "BojanT", "link": "https://stackoverflow.com/users/1035699/bojant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8678, "favorite_count": 3, "accepted_answer_id": 29301344, "answer_count": 2, "score": 21, "last_activity_date": 1572812633, "creation_date": 1427459057, "last_edit_date": 1572812633, "question_id": 29300607, "link": "https://stackoverflow.com/questions/29300607/golang-bug-or-intended-feature-on-map-literals", "title": "Golang bug or intended feature on map literals?", "body": "<p>Just started to learn Go and I need map of string string, that I initialize literally.</p>\n\n<pre><code>mapa := map[string]string{\n        \"jedan\":\"one\",\n        \"dva\":\"two\"\n       }\n</code></pre>\n\n<p>But compiler is complaining <code>syntax error: need trailing comma before newline in composite literal</code></p>\n\n<p>So I had to add coma after <code>\"two\",</code> or delete a new line and have <code>}</code> after last value for compiler to be happy</p>\n\n<p>Is this intended behavior of code style? </p>\n\n<p>EDIT: to be clear follwing will compile and work</p>\n\n<pre><code>mapa := map[string]string{\n        \"jedan\":\"one\",\n        \"dva\":\"two\"  }\n</code></pre>\n\n<p><code>go version go1.4.2 darwin/amd64</code>  Mac OSX 10.9.5</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1427452782, "post_id": 29298645, "comment_id": 46792292, "body": "This can be done with 2 simple helper functions which I proposed <a href=\"http://stackoverflow.com/a/28878037/1705598\">here in this answer</a>."}, {"owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1427472258, "post_id": 29298645, "comment_id": 46804565, "body": "Thanks icza! That&#39;s what I&#39;m looking for. I&#39;ll try it out soon. As mentioned, this is only for quick debugging. For production code, I do create structs mapping to the JSON object."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1513699924, "post_id": 29298645, "comment_id": 82748239, "body": "I also created a library doing exactly this: <a href=\"https://github.com/icza/dyno\" rel=\"nofollow noreferrer\">github.com/icza/dyno</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "edited": false, "score": 0, "creation_date": 1427472154, "post_id": 29299557, "comment_id": 46804495, "body": "This approach isn&#39;t for production use where I do create structs that map to the JSON structure. This is mostly for quick debugging code that I&#39;m probably not going to use again."}, {"owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "edited": false, "score": 1, "creation_date": 1427555369, "post_id": 29299557, "comment_id": 46829097, "body": "Thanks Elwinar. I&#39;ll check this out. This is close as the <code>Get</code> function takes a single selector string but would be nice to automate creation of the string from a slice, e.g. <code>[]interface{}{&quot;data&quot;,0,&quot;links&quot;,&quot;author&quot;,&quot;linkage&quot;,&quot;id&quot;}</code>. Might be worth a pull request."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": 4, "last_activity_date": 1427455388, "creation_date": 1427455388, "answer_id": 29299557, "question_id": 29298645, "link": "https://stackoverflow.com/questions/29298645/how-to-do-deep-sets-and-gets-in-gos-mapstringinterface/29299557#29299557", "title": "How to do deep sets and gets in Go&#39;s map[string]interface{}?", "body": "<p>You have <a href=\"https://godoc.org/github.com/stretchr/objx\" rel=\"nofollow\"><code>stretchr/objx</code></a> that provide a similar approach.</p>\n\n<p>Example use:</p>\n\n<pre><code>document, _ := objx.FromJSON(json)\ndocument.Get(\"path.to.field[0].you.want\").Str()\n</code></pre>\n\n<p>However, unless you really don't know at all the structure of your JSON input ahead of time, this isn't the preferred way to go in golang\u2026</p>\n"}], "owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 792, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1427482466, "creation_date": 1427452568, "last_edit_date": 1427472285, "question_id": 29298645, "link": "https://stackoverflow.com/questions/29298645/how-to-do-deep-sets-and-gets-in-gos-mapstringinterface", "title": "How to do deep sets and gets in Go&#39;s map[string]interface{}?", "body": "<p>If I have some arbitrary JSON how can I do deep sets and gets on the nested properties using a slice of map keys and/or slice indexes?</p>\n\n<p>For example, in the following excerpt from the <a href=\"http://jsonapi.org/\" rel=\"nofollow\">JSON API example</a>:</p>\n\n<pre><code>{\n    \"data\": [{\n        \"type\": \"posts\",\n        \"id\": \"1\",\n        \"title\": \"JSON API paints my bikeshed!\",\n        \"links\": {\n            \"self\": \"http://example.com/posts/1\",\n            \"author\": {\n                \"self\": \"http://example.com/posts/1/links/author\",\n                \"related\": \"http://example.com/posts/1/author\",\n                \"linkage\": { \"type\": \"people\", \"id\": \"9\" }\n            }\n        }\n    }]\n}\n</code></pre>\n\n<p>I'd like to get the string <code>\"9\"</code> located at <code>data.0.links.author.linkage.id</code> using something like:</p>\n\n<pre><code>[]interface{}{\"data\",0,\"links\",\"author\",\"linkage\",\"id\"}\n</code></pre>\n\n<p>I know the ideal way to do this is to create nested structs that map to the JSON object which I do for production code, but sometimes I need to do some quick testing which would be nice to do in Go as well.</p>\n"}, {"tags": ["ruby-on-rails", "json", "go", "websocket"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1471955031, "last_edit_date": 1471955031, "creation_date": 1427447108, "answer_id": 29296816, "question_id": 29295999, "link": "https://stackoverflow.com/questions/29295999/golang-unmarshalling-websocket-rails-json-response/29296816#29296816", "title": "golang Unmarshalling websocket-rails JSON response", "body": "<p>This is not the best solution, but it is the simplest:</p>\n\n<p>Since the JSON input is not the convenient key-value pairs (or arrays of that), we can't just use a simple <code>struct</code> (which would be desirable) to model the content.</p>\n\n<p>Your JSON input is an array of arrays. Inside that there are mixed types, all which can be stored in the empty interface <code>interface{}</code> (which can hold a value of any type).</p>\n\n<p>So you can represent your data structure with the type:</p>\n\n<pre><code>js := [][]interface{}{}\n</code></pre>\n\n<p>Here's the complete code to unmarshal it and print it:</p>\n\n<pre><code>js := [][]interface{}{}\nerr := json.Unmarshal([]byte(input), &amp;js)\nif err != nil {\n    panic(err)\n}\nfmt.Printf(\"%q\", js)\n</code></pre>\n\n<p>Output (wrapped):</p>\n\n<pre><code>[[\"client_connected\" map[\"server_token\":&lt;nil&gt; \"id\":&lt;nil&gt; \"channel\":&lt;nil&gt; \n  \"user_id\":&lt;nil&gt; \"data\":map[\"connection_id\":&lt;nil&gt;] \"success\":&lt;nil&gt; \"result\":&lt;nil&gt;]]]\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/hDdNe1vJ8q\" rel=\"nofollow\">Go Playground</a>.</p>\n\n<p><strong>Notes:</strong></p>\n\n<p>Seemingly we could simplify it further by just using <code>interface{}</code> type for the <code>js</code> variable:</p>\n\n<pre><code>var js interface{}\n</code></pre>\n\n<p>And it works too, but in this case we would need <a href=\"http://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">Type assertions</a> even to just get to the elements of the \"wrapper\" arrays which would be a step back.</p>\n"}], "owner": {"reputation": 23, "user_id": 4719755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bbb598b3de4542333904f5f688f84c?s=128&d=identicon&r=PG&f=1", "display_name": "goquest123", "link": "https://stackoverflow.com/users/4719755/goquest123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 29296816, "answer_count": 1, "score": 2, "last_activity_date": 1471955031, "creation_date": 1427444004, "last_edit_date": 1427444368, "question_id": 29295999, "link": "https://stackoverflow.com/questions/29295999/golang-unmarshalling-websocket-rails-json-response", "title": "golang Unmarshalling websocket-rails JSON response", "body": "<pre><code>[\n    [\n        \"client_connected\",\n         {\n            \"id\": null,\n            \"channel\": null,\n            \"user_id\": null,\n            \"data\": {\n               \"connection_id\": null\n            },\n            \"success\": null,\n            \"result\": null,\n            \"server_token\": null\n        }   \n    ]\n]\n</code></pre>\n\n<p>Given this JSON response from a <em>websocket-rails</em> server, I was wondering what the best way to parse this as there is a string without any key?</p>\n"}, {"tags": ["go", "environment"], "comments": [{"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "edited": false, "score": 0, "creation_date": 1427435038, "post_id": 29293961, "comment_id": 46784271, "body": "I found this [os.Environ()] (<a href=\"http://golang.org/pkg/os/#Environ\" rel=\"nofollow noreferrer\">golang.org/pkg/os/#Environ</a>) which seems to do the job of finding the env variables but Im still having problems with restructuring the data."}], "answers": [{"comments": [{"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "edited": false, "score": 0, "creation_date": 1427445215, "post_id": 29294251, "comment_id": 46788078, "body": "I found something similar on my own but I haven&#39;t had time to post it yet so thanks!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1427436048, "creation_date": 1427436048, "answer_id": 29294251, "question_id": 29293961, "link": "https://stackoverflow.com/questions/29293961/get-variables-from-the-environment-in-go/29294251#29294251", "title": "Get variables from the environment in go?", "body": "<p><a href=\"http://godoc.org/os#Environ\" rel=\"noreferrer\">os.Environ()</a> returns the strings representing the environment in the form \"key=value\". To create a map, iterate through the strings, split on \"=\" and set the map entry.</p>\n\n<pre><code>m := make(map[string]string)\nfor _, e := range os.Environ() {\n    if i := strings.Index(e, \"=\"); i &gt;= 0 {\n        m[e[:i]] = e[i+1:]\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 1, "accepted_answer_id": 29294251, "answer_count": 1, "score": 3, "last_activity_date": 1427436048, "creation_date": 1427434424, "question_id": 29293961, "link": "https://stackoverflow.com/questions/29293961/get-variables-from-the-environment-in-go", "title": "Get variables from the environment in go?", "body": "<p>I have data set in the environment variable GOPATH and I would like to programatically extract this data in my program. I would prefer to fetch all the ENV variables as a <code>map[string]interface{}</code>. This is because I want to integrate the ENV values with my JSON config witch I currently fetch like so.</p>\n\n<pre><code> var data map[string]interface{}\n\n file, err := ioutil.ReadFile(configFilePath)\n if err != nil {\n   log.Fatal(err)\n }\n err = json.Unmarshal(file, &amp;data)\n if err != nil {\n   log.Fatal(err)\n }\n</code></pre>\n"}, {"tags": ["heroku", "go"], "answers": [{"comments": [{"owner": {"reputation": 353, "user_id": 2986350, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0fbcd2aac49ed0e01d129b4d7daaca4f?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2986350/miguel"}, "edited": false, "score": 0, "creation_date": 1428106985, "post_id": 29299817, "comment_id": 47051056, "body": "Very interesting.  I came upon this tutorial while trying to figure out how to use Heroku, but I don&#39;t think I tried this approach.  I posted on Reddit and I found another approach... using talks.godoc.org.  Unfortunately I don&#39;t have the time to try your approach at the time, but I will try at the beginning of May.. really busy with work at the time, but talks.godoc.org works! :)"}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 0, "last_activity_date": 1427466901, "last_edit_date": 1427466901, "creation_date": 1427456286, "answer_id": 29299817, "question_id": 29290983, "link": "https://stackoverflow.com/questions/29290983/go-present-on-heroku/29299817#29299817", "title": "Go &#39;present&#39; on Heroku?", "body": "<p>Copy the <code>present</code> binary and your slides into some directory. <code>git init</code> a new branch. Then add a <code>Procfile</code> with the contents:</p>\n\n<pre><code>web: present --param whatever\n</code></pre>\n\n<p>Then just clone the buildpack:</p>\n\n<pre><code>heroku create -b https://github.com/kr/heroku-buildpack-go.git\n</code></pre>\n\n<p>Commit and push to <code>heroku master</code>. You're done.</p>\n\n<p>I got all this from <a href=\"http://mmcgrana.github.io/2012/09/getting-started-with-go-on-heroku.html\" rel=\"nofollow\">http://mmcgrana.github.io/2012/09/getting-started-with-go-on-heroku.html</a></p>\n"}], "owner": {"reputation": 353, "user_id": 2986350, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0fbcd2aac49ed0e01d129b4d7daaca4f?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/2986350/miguel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1427466901, "creation_date": 1427414084, "last_edit_date": 1427466538, "question_id": 29290983, "link": "https://stackoverflow.com/questions/29290983/go-present-on-heroku", "title": "Go &#39;present&#39; on Heroku?", "body": "<p>So I'm new to deploying servers to Heroku, I wen't through a small <a href=\"https://mmcgrana.github.io/2012/09/getting-started-with-go-on-heroku.html\" rel=\"nofollow\">tutorial</a> on how to deploy a go app to Heroku. I've been working with the <code>present</code> package for presentations in html5 slides. I want to add my slides to Heroku so I can access them from any computer. I'm having a hard time figuring out how to get this to work.</p>\n\n<p>I know that the <code>present</code> binary is in the bin folder and I have my .slide markdown textfile in my <code>$GOPATH/src</code> folder. How can I deploy this to Heroku?</p>\n\n<p>Any help would be great thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1427406188, "post_id": 29289198, "comment_id": 46776002, "body": "Failure to assign the value from append is usually a mistake"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1427406263, "post_id": 29289198, "comment_id": 46776030, "body": "@JimB Thats a requirement for the OP. The idea is basically just to print a slice and each time remove one of the elements in sequence. OP: This isn&#39;t possible with slice indexing and shorthand like this. You&#39;ll have to be a bit more verbose."}], "answers": [{"tags": [], "owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "is_accepted": false, "score": 0, "last_activity_date": 1427405718, "creation_date": 1427405718, "answer_id": 29289325, "question_id": 29289198, "link": "https://stackoverflow.com/questions/29289198/removing-each-element-in-a-slice/29289325#29289325", "title": "Removing each element in a slice", "body": "<p>See what happens after the first iteration: </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := []string{\"A\", \"B\", \"C\"}\n    x := append(a[:0], a[1:]...)\n    fmt.Println(a)\n    fmt.Println(x)\n}\n</code></pre>\n\n<p>Gives </p>\n\n<pre><code>[B C C]\n[B C]\n</code></pre>\n\n<p>See <a href=\"https://play.golang.org/p/2LqBwHejhy\" rel=\"nofollow\">https://play.golang.org/p/2LqBwHejhy</a></p>\n\n<p>The next two iterations are similar. Just try it out.</p>\n"}, {"comments": [{"owner": {"reputation": 919, "user_id": 1043674, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/0090f1f22a03e38ca61dc955e1d0a346?s=128&d=identicon&r=PG", "display_name": "Jon Chan", "link": "https://stackoverflow.com/users/1043674/jon-chan"}, "edited": false, "score": 0, "creation_date": 1427465793, "post_id": 29290499, "comment_id": 46800096, "body": "This gives the best explanation about why the unexpected behavior is occurring and also gives an acceptable alternative. I do prefer the solution that @jimt provides better though."}], "tags": [], "owner": {"reputation": 3457, "user_id": 3108853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db3d997e8c35cb14623d4dc4de494801?s=128&d=identicon&r=PG&f=1", "display_name": "lsowen", "link": "https://stackoverflow.com/users/3108853/lsowen"}, "is_accepted": true, "score": 1, "last_activity_date": 1427411365, "creation_date": 1427411365, "answer_id": 29290499, "question_id": 29289198, "link": "https://stackoverflow.com/questions/29289198/removing-each-element-in-a-slice/29290499#29290499", "title": "Removing each element in a slice", "body": "<p>The \"what\" is because <a href=\"http://golang.org/pkg/builtin/#append\" rel=\"nofollow\"><code>append(slice, elems...)</code></a> is actually updating the <code>slice</code> with the new elements.  It returns a \"new\" slice only because it may have had to relocate the original slice due to memory reallocation.  So, in your example code, you are actually changing the contents of <code>a</code> with each call to <code>append</code>.  (A good overview is in the \"Append: An Example\" section of <a href=\"https://blog.golang.org/slices\" rel=\"nofollow\">this</a> golang blog post).</p>\n\n<p>As to \"how\", my attempt is:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := []string {\"A\", \"B\", \"C\"}\n    for i, _ := range a {\n        result := make([]string, i, len(a)-1)\n        copy(result, a[:i])\n        result = append(result, a[i+1:]...)\n        fmt.Println(result)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Caa_x20_7p\" rel=\"nofollow\">DEMO</a></p>\n\n<p>Initializing <code>result</code> with a length and capacity, as well as using <code>copy</code> instead of two <code>append</code>s attempts to reduce the number of memory reallocations required.</p>\n"}, {"comments": [{"owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "edited": false, "score": 1, "creation_date": 1427415753, "post_id": 29291021, "comment_id": 46779366, "body": "You can skip the swap in iteration 0 as swapping x[0] with x[0] is a no-op."}], "tags": [], "owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "is_accepted": false, "score": 5, "last_activity_date": 1427414997, "last_edit_date": 1427414997, "creation_date": 1427414274, "answer_id": 29291021, "question_id": 29289198, "link": "https://stackoverflow.com/questions/29289198/removing-each-element-in-a-slice/29291021#29291021", "title": "Removing each element in a slice", "body": "<p>If you want to do it without extra allocations, try just swapping out values as shown <a href=\"http://play.golang.org/p/2qWA46wxud\">in this example</a>:</p>\n\n<p>Note that this assumes you are OK with shuffling the list contents.\nIf not, just copy the list once before the loop and do the same as below.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    set := []string{\"a\", \"b\", \"c\"}\n    for i := range set {\n        set[0], set[i] = set[i], set[0]\n        fmt.Println(set[1:])\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[b c]\n[a c]\n[a b]\n</code></pre>\n"}], "owner": {"reputation": 919, "user_id": 1043674, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/0090f1f22a03e38ca61dc955e1d0a346?s=128&d=identicon&r=PG", "display_name": "Jon Chan", "link": "https://stackoverflow.com/users/1043674/jon-chan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 29290499, "answer_count": 3, "score": 2, "last_activity_date": 1427414997, "creation_date": 1427405226, "question_id": 29289198, "link": "https://stackoverflow.com/questions/29289198/removing-each-element-in-a-slice", "title": "Removing each element in a slice", "body": "<p>I'm getting some unexpected behavior when I try to loop through a slice and remove every element in sequence to print the remaining elements, using the suggested <strong>Delete</strong> method from <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow\">SliceTricks</a>. For example, when I try and loop through a slice that contains the letters <code>[A B C]</code>, I expect the output to be <code>[B C]</code>, <code>[A C]</code>, <code>[A B]</code> in that order:</p>\n\n<p><strong>Method 1</strong></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := []string {\"A\", \"B\", \"C\"}\n    for i, _ := range a {\n        fmt.Println(append(a[:i], a[i+1:]...))\n    }\n}\n</code></pre>\n\n<p>However, the output here is surprising to me. It outputs <code>[B C]</code> three times.</p>\n\n<p>I did eventually get my expected behavior by doing the following:</p>\n\n<p><strong>Method 2</strong></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := []string {\"A\", \"B\", \"C\"}\n    for i, _ := range a {\n        result := make([]string, 0)\n        result = append(result, a[:i]...)\n        result = append(result, a[i+1:]...)\n        fmt.Println(result)\n    }\n}\n</code></pre>\n\n<p>What is causing the unexpected behavior in method 1 and is there a better way to achieve this other than method 2?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 4, "creation_date": 1427404464, "post_id": 29288793, "comment_id": 46775183, "body": "You should browse the listing of standard library packages and become familiar with what they provide - <a href=\"http://golang.org/pkg/\" rel=\"nofollow noreferrer\">golang.org/pkg</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "edited": false, "score": 0, "creation_date": 1427404059, "post_id": 29288834, "comment_id": 46774984, "body": "Honestly I din&#39;t even know about the os package. I just started trying out go."}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1427466659, "post_id": 29288834, "comment_id": 46800725, "body": "Notice that the example code above doesn&#39;t check the errors. But remember to do so in real programs."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 7, "last_activity_date": 1427404989, "last_edit_date": 1427404989, "creation_date": 1427403852, "answer_id": 29288834, "question_id": 29288793, "link": "https://stackoverflow.com/questions/29288793/finding-the-current-working-directory-programmatically-in-go/29288834#29288834", "title": "Finding the current working directory programmatically in go?", "body": "<p><a href=\"http://golang.org/pkg/os/#Getwd\" rel=\"nofollow\">Getwd</a> from the os package will return your current working directory. For more operating system related functions look in the <code>os</code> package.</p>\n\n<p>If you want to print it do the following.</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    wd, _ := os.Getwd()\n    fmt.Println(\"Working Directory:\", wd)\n}\n</code></pre>\n"}], "owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 2, "accepted_answer_id": 29288834, "answer_count": 1, "score": 3, "last_activity_date": 1427404989, "creation_date": 1427403719, "last_edit_date": 1427404853, "question_id": 29288793, "link": "https://stackoverflow.com/questions/29288793/finding-the-current-working-directory-programmatically-in-go", "title": "Finding the current working directory programmatically in go?", "body": "<p>I have been looking trough the go documentation but so far I haven't found anything. I need help to find the <code>current working directory</code> programmaticly in go language. Does any one know how to do that?</p>\n"}, {"tags": ["http", "go", "port"], "comments": [{"owner": {"reputation": 26843, "user_id": 208997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/250e219125d8bff1f03e6faea950f218?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/208997/simon"}, "edited": false, "score": 0, "creation_date": 1427396884, "post_id": 29286860, "comment_id": 46771030, "body": "Sounds like a firewall issue\u2026 Can you try to disable your firewall / open these ports?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1427396921, "post_id": 29286860, "comment_id": 46771052, "body": "check the error from <code>http.ListenAndServe</code>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1427396936, "post_id": 29286860, "comment_id": 46771063, "body": "http.ListenAndServe returns an error. Print the error to find out what&#39;s wrong."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427396980, "post_id": 29286860, "comment_id": 46771087, "body": "&quot;showing no error output&quot;\u2026 no crap, you didn&#39;t capture and show it! <b>Never</b> ignore error returns in any Go code."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427397017, "post_id": 29286860, "comment_id": 46771108, "body": "BTW, the error is likely due to your operating system needing to hold the resources for the port for a while until old (possibly incompletely/incorrectly closed) connections fully expire."}, {"owner": {"reputation": 2349, "user_id": 653331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8a4bf914078e4f4732891156dd917d69?s=128&d=identicon&r=PG&f=1", "display_name": "p_mcp", "link": "https://stackoverflow.com/users/653331/p-mcp"}, "edited": false, "score": 0, "creation_date": 1427397100, "post_id": 29286860, "comment_id": 46771157, "body": "Thanks all. Printing the error returns &quot;listen tcp :1339: bind: address already in use&quot;. So i guess i need to kill the process or...?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427397386, "post_id": 29286860, "comment_id": 46771297, "body": "Search for <code>EADDRINUSE</code>"}, {"owner": {"reputation": 2349, "user_id": 653331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8a4bf914078e4f4732891156dd917d69?s=128&d=identicon&r=PG&f=1", "display_name": "p_mcp", "link": "https://stackoverflow.com/users/653331/p-mcp"}, "edited": false, "score": 0, "creation_date": 1427398233, "post_id": 29286860, "comment_id": 46771746, "body": "Sorted, see answer for lols"}], "answers": [{"tags": [], "owner": {"reputation": 2349, "user_id": 653331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8a4bf914078e4f4732891156dd917d69?s=128&d=identicon&r=PG&f=1", "display_name": "p_mcp", "link": "https://stackoverflow.com/users/653331/p-mcp"}, "is_accepted": false, "score": 1, "last_activity_date": 1427398302, "creation_date": 1427398302, "answer_id": 29287277, "question_id": 29286860, "link": "https://stackoverflow.com/questions/29286860/golang-port-blocking-using-http-listenandserve/29287277#29287277", "title": "Golang port blocking (?) using http.ListenAndServe", "body": "<p>Ok turns out the error was my silly mistake. I have today switched from using a PC to Mac and didn't realise that Ctrl+C killed the current command instead of Ctrl+z which simply returns to shell... Therefore the processes were still running and blocking each other</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427400236, "post_id": 29287532, "comment_id": 46772800, "body": "Since <code>ListenAndServe</code> (and <code>Serve</code>) don&#39;t normally return, this is often simplified to just <code>log.Fatalln(&quot;ListenAndServe:&quot;, http.ListenAndServe(&quot;:1337&quot;, nil))</code> or even just <code>log.Fatal(http.ListenAndServe(&quot;:1337&quot;, nil))</code>. If Serve would return a <code>nil</code> error (it never does, but the documentation doesn&#39;t promise it) this would log &quot;&lt;nil&gt;&quot; but that&#39;s often what would be desired: some log entry when the server terminates."}], "tags": [], "owner": {"reputation": 181, "user_id": 4613350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/095b243ee1916f8dcf674032244a2b6a?s=128&d=identicon&r=PG&f=1", "display_name": "maverickames", "link": "https://stackoverflow.com/users/4613350/maverickames"}, "is_accepted": true, "score": 2, "last_activity_date": 1427399260, "creation_date": 1427399260, "answer_id": 29287532, "question_id": 29286860, "link": "https://stackoverflow.com/questions/29286860/golang-port-blocking-using-http-listenandserve/29287532#29287532", "title": "Golang port blocking (?) using http.ListenAndServe", "body": "<p>The port is most likely in use. Catching the error will give you more details.</p>\n\n<pre><code>if err := http.ListenAndServe(\":1337\", nil);err != nil {\n        log.Fatal(\"ListenAndServe: \", err)\n}\n</code></pre>\n"}], "owner": {"reputation": 2349, "user_id": 653331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8a4bf914078e4f4732891156dd917d69?s=128&d=identicon&r=PG&f=1", "display_name": "p_mcp", "link": "https://stackoverflow.com/users/653331/p-mcp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2237, "favorite_count": 0, "accepted_answer_id": 29287532, "answer_count": 2, "score": 0, "last_activity_date": 1427399260, "creation_date": 1427396755, "question_id": 29286860, "link": "https://stackoverflow.com/questions/29286860/golang-port-blocking-using-http-listenandserve", "title": "Golang port blocking (?) using http.ListenAndServe", "body": "<p>I have a simple golang program which listens for activity on a port before executing a function called <em>testFunc</em></p>\n\n<pre><code>func main() {\n    http.HandleFunc(\"/test\", testFunc)\n    http.ListenAndServe(\":1337\", nil)\n}\n</code></pre>\n\n<p>When I build this program, run it and go to <a href=\"http://localhost:1337/test\" rel=\"nofollow\">http://localhost:1337/test</a>, it works fine. </p>\n\n<p>When I terminate the program and try and run it again, the program instantly terminates showing no error output.</p>\n\n<p>When I then change the port to 1338 for example, it works the first time, then fails each time after. Any ideas?</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1427403033, "post_id": 29285670, "comment_id": 46774389, "body": "This is a configuration problem. Show app.yaml and your source directory structure."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1427443391, "last_edit_date": 1427443391, "creation_date": 1427403926, "answer_id": 29288854, "question_id": 29285670, "link": "https://stackoverflow.com/questions/29285670/google-app-engine-golang-no-such-file-or-directory/29288854#29288854", "title": "Google App Engine Golang no such file or directory", "body": "<p>When you upload/deploy your application, application files and static files are stored separately. Static files are served by specialized/dedicated servers, not by your frontend instances.</p>\n\n<p>That means if you have a file which you want to read from your Go code, that file must not match any static file pattern and cannot be in a folder specified as a static directory, else the file will be considered a static file and will not be deployed next to your Go code.</p>\n\n<p>This is detailed on the <a href=\"https://cloud.google.com/appengine/docs/go/config/appconfig\" rel=\"nofollow\">Application configuration</a> page, Section <a href=\"https://cloud.google.com/appengine/docs/go/config/appconfig#Go_app_yaml_Static_file_handlers\" rel=\"nofollow\">Static file handlers</a>. Quoting the relevant part:</p>\n\n<blockquote>\n  <p>For efficiency, App Engine stores and serves static files separately from application files. Static files are not available in the application's file system. If you have data files that need to be read by the application code, the data files must be application files, and must not be matched by a static file pattern.</p>\n</blockquote>\n\n<p>If there is a file which you want to be both a static file and an application file, you have 2 options:</p>\n\n<p>1) You may duplicate it, e.g. put it next to your code and to a separate folder (e.g. <code>static</code>) which you can mark as a static dir.</p>\n\n<p>Or (preferred):</p>\n\n<p>2) Specify the <code>application_readable</code> option to the static file handler which includes/applies to the file. Quoting from the documentation:</p>\n\n<blockquote>\n  <p>Optional. By default, files declared in static file handlers are uploaded as static data and are only served to end users, they cannot be read by an application. If this field is set to true, the files are also uploaded as code data so your application can read them. Both uploads are charged against your code and static data storage resource quotas.</p>\n</blockquote>\n"}], "owner": {"reputation": 187, "user_id": 3995228, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3704db62cc1e1967db3ef022eea118f2?s=128&d=identicon&r=PG&f=1", "display_name": "\u017diga Pata\u010dko Koderman", "link": "https://stackoverflow.com/users/3995228/%c5%bdiga-pata%c4%8dko-koderman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1100, "favorite_count": 0, "accepted_answer_id": 29288854, "answer_count": 1, "score": 1, "last_activity_date": 1427443391, "creation_date": 1427392882, "question_id": 29285670, "link": "https://stackoverflow.com/questions/29285670/google-app-engine-golang-no-such-file-or-directory", "title": "Google App Engine Golang no such file or directory", "body": "<p>I am developing a Google App Engine project in go and got stuck at reading files.\nIn fact app works perfectly locally. However when deployed, it panics telling me that there is no such file or directory.</p>\n\n<p>Here is my fileValue method:</p>\n\n<pre><code>func fileValue(path string) string {\n    content, err := ioutil.ReadFile(path)\n    if err != nil {\n        panic(err)\n    }\n    return string(content)\n}\n</code></pre>\n\n<p>And I call it like this:</p>\n\n<pre><code>secondPart := fileValue(\"./console/page/secondPart.html\")\n</code></pre>\n\n<p>And this is what I can se under logs in developers console:</p>\n\n<pre><code>panic: open ./console/page/firstPart.html: no such file or directory\n\ngoroutine 11 [running]:\nconsole.fileValue(0x19582f0, 0x1d, 0x0, 0x0)\n    console/console.go:191 +0xbd\nconsole.generateUnsignedHtml(0xc01043a780, 0x0, 0x0)\n    console/console.go:68 +0x69\nconsole.consoleHandler(0x7f180fa61830, 0xc01042f380, 0xc0105640d0)\n    console/console.go:58 +0x37e\nnet/http.HandlerFunc.ServeHTTP(0x1a21210, 0x7f180fa61830, 0xc01042f380, 0xc0105640d0)\n    go/src/net/http/server.go:1265 +0x56\nnet/http.(*ServeMux).ServeHTTP(0xc01048a8a0, 0x7f180fa61830, 0xc01042f380, 0xc0105640d0)\n    go/src/net/http/server.go:1541 +0x1b4\nappengine_internal.executeRequestSafely(0xc01042f380, 0xc0105640d0)\n    go/src/appengine_internal/api_prod.go:280 +0xb7\nappengine_internal.(*server).HandleRequest(0x1be76f0, 0xc010540000, 0xc0104ba000, 0xc010430b60, 0x0, 0x0)\n    go/src/appengine_internal/api_prod.go:214 +0x102b\nreflect.Value.call(0x1842640, 0x1be76f0, 0x113, 0x18d1380, 0x4, 0xc010533f78, 0x3, 0x3, 0x0, 0x0, ...)\n    /tmp/appengine/go/src/reflect/value.go:419 +0x10fd\nreflect.Value.Call(0x1842640, 0x1be76f0, 0x113, 0xc010533f78, 0x3, \n</code></pre>\n\n<p>Any idea why this happens and how to fix it?</p>\n\n<p>Thanks in advance :)</p>\n"}, {"tags": ["function", "go"], "answers": [{"comments": [{"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 2, "creation_date": 1427392492, "post_id": 29285264, "comment_id": 46768540, "body": "What is the meaning of the <code>floor(x ...)</code> (lower case) function implementation then?  How does it relate to the assembly implementation?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 4, "creation_date": 1427392703, "post_id": 29285264, "comment_id": 46768673, "body": "@maerics I believe that&#39;s a fallback Go implementation, used for example by <a href=\"https://github.com/golang/go/blob/master/src/math/floor_arm.s#L8\" rel=\"nofollow noreferrer\">floor_arm.s</a>. Such things could possibly also be done for reference or for use in tests to check other implementations against. (Go itself implies no relation whatsoever between <code>Floor</code> and <code>floor</code> indentifiers)."}, {"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1427392847, "post_id": 29285264, "comment_id": 46768763, "body": "@DaveC Thanks for the quote. I added it to the answer."}], "tags": [], "owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "is_accepted": true, "score": 16, "last_activity_date": 1427392827, "last_edit_date": 1427392827, "creation_date": 1427391599, "answer_id": 29285264, "question_id": 29285129, "link": "https://stackoverflow.com/questions/29285129/bodiless-function-in-golang/29285264#29285264", "title": "Bodiless function in Golang", "body": "<p>It's the way how functions are implemented in assembly. You find the assembly implementation in the <code>floor_ARCH.s</code> (e.g.: <a href=\"https://github.com/golang/go/blob/master/src/math/floor_amd64.s#L10\">AMD64</a>) files.</p>\n\n<p>To quote the <a href=\"https://golang.org/ref/spec#Function_declarations\">spec</a>:</p>\n\n<blockquote>\n  <p>A function declaration may omit the body. Such a declaration provides the signature for a function implemented outside Go, such as an assembly routine.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 177, "user_id": 7071127, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/986173e162dac0ba1158be9da78e9d62?s=128&d=identicon&r=PG&f=1", "display_name": "user304611", "link": "https://stackoverflow.com/users/7071127/user304611"}, "edited": false, "score": 0, "creation_date": 1608656709, "post_id": 59498705, "comment_id": 115647258, "body": "Thanks, this fixed my issue."}], "tags": [], "owner": {"reputation": 351, "user_id": 6150881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a42d9d73c727b1b482f4e215ac1b663?s=128&d=identicon&r=PG&f=1", "display_name": "Rabhi salim", "link": "https://stackoverflow.com/users/6150881/rabhi-salim"}, "is_accepted": false, "score": 3, "last_activity_date": 1608711972, "last_edit_date": 1608711972, "creation_date": 1577439473, "answer_id": 59498705, "question_id": 29285129, "link": "https://stackoverflow.com/questions/29285129/bodiless-function-in-golang/59498705#59498705", "title": "Bodiless function in Golang", "body": "<p>In my case I had &quot;../../../pkg/mod/golang.org/x/tools@v0.0.0-20190814235402-ea4142463bf3/go/ssa/interp/testdata/src/fmt/fmt.go:3:6: <code>missing function body</code>&quot; error!</p>\n<p>and it was because I used fmt without importing it so my IDE imported the wrong package.</p>\n<p>I fixed it by removing the import (<code>golang.org/x/tools/go/ssa/interp/testdata/src/fmt</code>)</p>\n<p>and just importing <code>fmt</code></p>\n"}], "owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2784, "favorite_count": 0, "accepted_answer_id": 29285264, "answer_count": 2, "score": 14, "last_activity_date": 1608711972, "creation_date": 1427391127, "last_edit_date": 1427392255, "question_id": 29285129, "link": "https://stackoverflow.com/questions/29285129/bodiless-function-in-golang", "title": "Bodiless function in Golang", "body": "<p>Reading the source code of <a href=\"http://golang.org/src/math/floor.go#L13\"><code>math/floor.go</code>, starting from line 13</a>, I read some code like this:</p>\n\n<pre><code>func Floor(x float64) float64\n\nfunc floor(x float64) float64 {\n    if x == 0 || IsNaN(x) || IsInf(x, 0) {\n        return x\n    }\n    if x &lt; 0 {\n        d, fract := Modf(-x)\n        if fract != 0.0 {\n            d = d + 1\n        }\n        return -d\n    }\n    d, _ := Modf(x)\n    return d\n}\n</code></pre>\n\n<p>It seems the <code>func Floor</code> has no body. I tried to copy and paste these code in my go file. it doesn't compile. The error message is <code>missing function body</code>. So my question is: is a bodiless function legal in Go's syntax? Thanks.</p>\n"}, {"tags": ["templates", "go", "mustache"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1427388392, "post_id": 29282728, "comment_id": 46766143, "body": "If you&#39;re using a random 3rd party library you should provide a link to it. <a href=\"https://godoc.org/?q=mustache%5D\" rel=\"nofollow noreferrer\">godoc</a> shows multiple packages called mustache so just mentioning by name is unhelpful."}, {"owner": {"reputation": 181, "user_id": 4613350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/095b243ee1916f8dcf674032244a2b6a?s=128&d=identicon&r=PG&f=1", "display_name": "maverickames", "link": "https://stackoverflow.com/users/4613350/maverickames"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427391008, "post_id": 29282728, "comment_id": 46767763, "body": "Good point. This is the one I am using to clarify. godoc.org/github.com/hoisie/mustache"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427393366, "post_id": 29282728, "comment_id": 46769071, "body": "Gah! That package is completely non-idomatic and <b>horrible</b> with errors. It has a single <code>string</code> return value and it rams <code>err.Error()</code> into it if it encounters an error. That is <b>bad</b>. <b>Never</b>, ever do that! And refuse to use any package that does. (It should of course return <code>(string, error)</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 654, "user_id": 3508122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1057c941dbec272576741ee1db60cdc2?s=128&d=identicon&r=PG&f=1", "display_name": "user3508122", "link": "https://stackoverflow.com/users/3508122/user3508122"}, "is_accepted": true, "score": 1, "last_activity_date": 1427388191, "last_edit_date": 1427388191, "creation_date": 1427387829, "answer_id": 29284050, "question_id": 29282728, "link": "https://stackoverflow.com/questions/29282728/slice-of-structs-to-unsorted-list-with-mustache/29284050#29284050", "title": "Slice of structs to unsorted list with mustache", "body": "<p>Im not familiar with mustache but from looking at it I think the {{#DataKey}} is wrong.</p>\n\n<p>From the docs:</p>\n\n<p>Template:</p>\n\n<pre><code>{{#repo}}\n  &lt;b&gt;{{name}}&lt;/b&gt;\n{{/repo}}\n</code></pre>\n\n<p>Hash:</p>\n\n<pre><code>{\n  \"repo\": [\n    { \"name\": \"resque\" },\n    { \"name\": \"hub\" },\n    { \"name\": \"rip\" }\n  ]\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>&lt;b&gt;resque&lt;/b&gt;\n&lt;b&gt;hub&lt;/b&gt;\n&lt;b&gt;rip&lt;/b&gt;\n</code></pre>\n\n<p>I'd suggest trying the following</p>\n\n<pre><code>viewModel := struct{\n    items []DataKey{}\n}{\n    data\n}\n\nmustache.RenderFileInLayout(\"templates/datakeys.html.mustache\", \"templates/layout.html.mustache\", user, viewModel )))\n</code></pre>\n\n<p>and then replace the template with</p>\n\n<pre><code>{{#items}}\n    &lt;tr&gt;\n        &lt;td&gt;{{Id}}&lt;/td&gt;\n        &lt;td&gt;{{UserId}}&lt;/td&gt;\n        &lt;td&gt;{{Data}}&lt;/td&gt;\n        &lt;td&gt;{{CreatedAt}}&lt;/td&gt;\n    &lt;/tr&gt;\n{{/items}}\n</code></pre>\n\n<p>This is untested and might not be correct, but might be worth trying. My guess is that DataKey isn't a property on the model hence it's failing to evaluate.</p>\n\n<p>Edit for more clarity: In theory</p>\n\n<pre><code>viewModel := struct{\n    items []DataKey{}\n}{\n    data\n}\n</code></pre>\n\n<p>will become</p>\n\n<pre><code>{\n    \"items\": [\n        {...},{...} ... etc\n    ]\n}\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 4613350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/095b243ee1916f8dcf674032244a2b6a?s=128&d=identicon&r=PG&f=1", "display_name": "maverickames", "link": "https://stackoverflow.com/users/4613350/maverickames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 29284050, "answer_count": 1, "score": 0, "last_activity_date": 1427398024, "creation_date": 1427384306, "last_edit_date": 1427398024, "question_id": 29282728, "link": "https://stackoverflow.com/questions/29282728/slice-of-structs-to-unsorted-list-with-mustache", "title": "Slice of structs to unsorted list with mustache", "body": "<p>I have a struct.</p>\n\n<pre><code>type DataKey struct {\n    Id        int64     `db:\"id\"`\n    UserId    string    `db:\"user_id\"`\n    Data      string    `db:\"data\"`\n    CreatedAt time.Time `db:\"created_at\"`\n}\n</code></pre>\n\n<p>I create a slice of structs.</p>\n\n<pre><code>data := []DataKey{}\n</code></pre>\n\n<p>After doing a sql query and filling the slices I try to pass to <a href=\"https://godoc.org/github.com/hoisie/mustache#RenderFileInLayout\" rel=\"nofollow\">mustache</a> to build my list.</p>\n\n<pre><code>mustache.RenderFileInLayout(\"templates/datakeys.html.mustache\", \"templates/layout.html.mustache\", user, data)))\n</code></pre>\n\n<p>datakeys.html.mustache</p>\n\n<pre><code>&lt;table class=\"table table-striped\"&gt;\n&lt;thead&gt;\n    &lt;tr&gt;\n        &lt;th&gt;#&lt;/th&gt;\n        &lt;th&gt;UserID&lt;/th&gt;\n        &lt;th&gt;DataKey&lt;/th&gt;\n        &lt;th&gt;CreatedAt&lt;/th&gt;\n    &lt;/tr&gt;\n&lt;/thead&gt;\n{{#DataKey}}\n    &lt;tr&gt;\n        &lt;td&gt;{{Id}}&lt;/td&gt;\n        &lt;td&gt;{{UserId}}&lt;/td&gt;\n        &lt;td&gt;{{Data}}&lt;/td&gt;\n        &lt;td&gt;{{CreatedAt}}&lt;/td&gt;\n    &lt;/tr&gt;\n{{/DataKey}}\n&lt;/table&gt;\n</code></pre>\n\n<p>The only thing I get is the table header. This function does not return an error so I don't know why it didn't like the data. I have also tried passing it in as a reference.</p>\n"}, {"tags": ["json", "go", "redis", "revel"], "comments": [{"owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "edited": false, "score": 2, "creation_date": 1427383499, "post_id": 29282231, "comment_id": 46762545, "body": "This is the case for profiling. Please read <a href=\"http://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">blog.golang.org/profiling-go-programs</a>, and, at least, post profile output (if you will not be able to crack it yourself). It will probably help other people to solve your problem."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1427386962, "post_id": 29282231, "comment_id": 46765224, "body": "Not that it will make a big difference, but eliminate the unnecessary conversions: <code>pointTable, err := redis.Bytes(c.Do(&quot;GET&quot;, &quot;data&quot;)); json.Unmshal(pointTable, &amp;hashPoint);</code>.   Also, check errors."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1427404250, "post_id": 29282231, "comment_id": 46775092, "body": "&quot;Very slow&quot; compared to... ?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1427410122, "post_id": 29282231, "comment_id": 46777603, "body": "I&#39;m surprised none of them are fast enough. Could switch to protobufs or build something on <code>encoding&#47;binary</code> or write a parser for this JSON. I&#39;m taking your post at face value, but if you haven&#39;t profiled or timed so you <i>know</i> it&#39;s the unmarshal that&#39;s slow, I&#39;d verify that."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1427410315, "post_id": 29282231, "comment_id": 46777672, "body": "If it&#39;s taking 5 sec it must be a pretty big structure--maybe you want to store a hash in Redis mapping individual strings to <code>[]float64</code>s, so you do a little work each request?"}, {"owner": {"reputation": 53, "user_id": 4717045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3028d0f5f0824fc2b2b71be05ecbe9?s=128&d=identicon&r=PG&f=1", "display_name": "shiro_goto", "link": "https://stackoverflow.com/users/4717045/shiro-goto"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1427422213, "post_id": 29282231, "comment_id": 46781092, "body": "Thank you everyone.  @twotwotwo I will try the protobufs or msgpack."}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1427427441, "post_id": 29282231, "comment_id": 46782235, "body": "20 MB is a huge []byte data. You must profile to make sure part of the time wasn&#39;t used on accessing Redis (using hash, list and set make some differences in storing JSON). If you really can&#39;t cut down the time any more, why not create another goroutine for it?"}], "answers": [{"tags": [], "owner": {"reputation": 14867, "user_id": 517371, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/0owFn.jpg?s=128&g=1", "display_name": "Tobia", "link": "https://stackoverflow.com/users/517371/tobia"}, "is_accepted": true, "score": 9, "last_activity_date": 1427588913, "last_edit_date": 1427588913, "creation_date": 1427587941, "answer_id": 29324151, "question_id": 29282231, "link": "https://stackoverflow.com/questions/29282231/go-json-decoding-is-very-slow-what-would-be-a-better-way-to-do-it/29324151#29324151", "title": "Go JSON decoding is very slow. What would be a better way to do it?", "body": "<p>Parsing large JSON data does seem to be slower than it should be. It would be worthwhile to pinpoint the cause and submit a patch to the Go authors.</p>\n\n<p>In the meantime, if you can avoid JSON and use a binary format, you will not only avoid this issue; you will also gain the time your code is now spending parsing ASCII decimal representations of numbers into their binary IEEE 754 equivalents (and possibly introducing rounding errors while doing so.)</p>\n\n<p>If both your sender and receiver are written in Go, I suggest using Go's binary format: <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"noreferrer\"><strong>gob</strong></a>.</p>\n\n<p>Doing a quick test, generating a map with 2000 entries, each a slice with 1050 simple floats, gives me 20 MB of JSON, which takes 1.16 sec to parse on my machine.</p>\n\n<p>For these quick benchmarks, I take the best of three runs, but I make sure to only measure the actual parsing time, with <code>t0 := time.Now()</code> before the Unmarshal call and printing <code>time.Now().Sub(t0)</code> after it.</p>\n\n<p>Using GOB, the same map results in 18 MB of data, which takes 115 ms to parse:<br>\n <strong>one tenth the time</strong>.</p>\n\n<p>Your results will vary depending on how many actual floats you have there. If yours floats have a lot of significant digits, deserving their float64 representation, then 20 MB of JSON will contain much fewer than my two million floats. In that case the difference between JSON and GOB will be ever starker.</p>\n\n<p>BTW, this proves that the problem lies indeed in the JSON parser, not in the amount of data to parse, nor in the memory structures to create (because both tests are parsing ~ 20 MB of data and recreating the same slices of floats.) Replacing all the floats with strings in the JSON gives me a parsing time of 1.02 sec, confirming that the conversion from string representation to binary floats does takes a certain time (compared to just moving bytes around) but is not the main culprit.</p>\n\n<p>If the sender and the parser are not both Go, or if you want to squeeze the performance even further than GOB, you should use your own customised binary format, either using Protocol Buffers or manually with \"encoding/binary\" and friends.</p>\n"}, {"tags": [], "owner": {"reputation": 2246, "user_id": 274937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d848784d081501a5cba4a2fa7856e965?s=128&d=identicon&r=PG", "display_name": "valyala", "link": "https://stackoverflow.com/users/274937/valyala"}, "is_accepted": false, "score": 0, "last_activity_date": 1527631915, "creation_date": 1527631915, "answer_id": 50593728, "question_id": 29282231, "link": "https://stackoverflow.com/questions/29282231/go-json-decoding-is-very-slow-what-would-be-a-better-way-to-do-it/50593728#50593728", "title": "Go JSON decoding is very slow. What would be a better way to do it?", "body": "<p>Try <a href=\"https://github.com/valyala/fastjson\" rel=\"nofollow noreferrer\">fastjson</a>. It is optimized for speed and usually parses JSON much faster comparing to standard <code>encoding/json</code>. Additionally, <code>fastjson</code> doesn't need structs adhering JSON schema - a single parser may parse multiple JSONs with distinct schemas.</p>\n"}, {"tags": [], "owner": {"reputation": 1451, "user_id": 2930836, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh4.googleusercontent.com/-hOD6KYRyIY4/AAAAAAAAAAI/AAAAAAAAfv0/9V13VHORoHk/photo.jpg?sz=128", "display_name": "igonejack", "link": "https://stackoverflow.com/users/2930836/igonejack"}, "is_accepted": false, "score": 0, "last_activity_date": 1574224786, "creation_date": 1574224786, "answer_id": 58946805, "question_id": 29282231, "link": "https://stackoverflow.com/questions/29282231/go-json-decoding-is-very-slow-what-would-be-a-better-way-to-do-it/58946805#58946805", "title": "Go JSON decoding is very slow. What would be a better way to do it?", "body": "<p>Try <a href=\"https://github.com/json-iterator/go\" rel=\"nofollow noreferrer\">https://github.com/json-iterator/go</a></p>\n\n<p>I got 2x decoding speed upgrade comparing to official one, more benefit is jsoniter's APIs are compatible with encoding/json.</p>\n"}], "owner": {"reputation": 53, "user_id": 4717045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3028d0f5f0824fc2b2b71be05ecbe9?s=128&d=identicon&r=PG&f=1", "display_name": "shiro_goto", "link": "https://stackoverflow.com/users/4717045/shiro-goto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8528, "favorite_count": 0, "accepted_answer_id": 29324151, "answer_count": 3, "score": 5, "last_activity_date": 1574224786, "creation_date": 1427383007, "last_edit_date": 1427383306, "question_id": 29282231, "link": "https://stackoverflow.com/questions/29282231/go-json-decoding-is-very-slow-what-would-be-a-better-way-to-do-it", "title": "Go JSON decoding is very slow. What would be a better way to do it?", "body": "<p>I am using Go, Revel WAF and Redis.</p>\n\n<p>I have to store large json data in Redis (maybe 20MB).</p>\n\n<p><code>json.Unmarshal()</code> takes about roughly 5 seconds. What would be a better way to do it?</p>\n\n<p>I tried JsonLib, encode/json, ffjson, megajson, but none of them were fast enough.</p>\n\n<p>I thought about using groupcache, but Json is updated in real time.</p>\n\n<p>This is the sample code:</p>\n\n<pre><code>package main\n\nimport (\n \"github.com/garyburd/redigo/redis\"\n  json \"github.com/pquerna/ffjson/ffjson\"\n)\n\nfunc main() {\n  c, err := redis.Dial(\"tcp\", \":6379\")\n  defer c.Close()\n  pointTable, err := redis.String(c.Do(\"GET\", \"data\"))\n  var hashPoint map[string][]float64\n  json.Unmarshal([]byte(pointTable), &amp;hashPoint) //Problem!!!\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 4687, "user_id": 1221132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a5046ae2fcac22bc44c6663a121f0cc8?s=128&d=identicon&r=PG", "display_name": "theva", "link": "https://stackoverflow.com/users/1221132/theva"}, "edited": false, "score": 0, "creation_date": 1427371121, "post_id": 29277627, "comment_id": 46753727, "body": "I guess that there is something wrong with the path to the html template then. The file is in the same dir as my .go file, doesn&#39;t a relative path work then?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 4687, "user_id": 1221132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a5046ae2fcac22bc44c6663a121f0cc8?s=128&d=identicon&r=PG", "display_name": "theva", "link": "https://stackoverflow.com/users/1221132/theva"}, "edited": false, "score": 0, "creation_date": 1427371199, "post_id": 29277627, "comment_id": 46753761, "body": "@theva the file might be there, but the parsing might be faulty: only by actually <i>checking</i> the error will you know for sure."}, {"owner": {"reputation": 4687, "user_id": 1221132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a5046ae2fcac22bc44c6663a121f0cc8?s=128&d=identicon&r=PG", "display_name": "theva", "link": "https://stackoverflow.com/users/1221132/theva"}, "edited": false, "score": 0, "creation_date": 1427371507, "post_id": 29277627, "comment_id": 46753951, "body": "So adding log.Fatal(err) i get this: &quot;2015/03/26 12:04:23 open web.html: no such file or directory&quot;, how should I format the path?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 4687, "user_id": 1221132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a5046ae2fcac22bc44c6663a121f0cc8?s=128&d=identicon&r=PG", "display_name": "theva", "link": "https://stackoverflow.com/users/1221132/theva"}, "edited": false, "score": 0, "creation_date": 1427371634, "post_id": 29277627, "comment_id": 46754037, "body": "@theva it is case sensitive: do you respect the case for the file name?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 4687, "user_id": 1221132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a5046ae2fcac22bc44c6663a121f0cc8?s=128&d=identicon&r=PG", "display_name": "theva", "link": "https://stackoverflow.com/users/1221132/theva"}, "edited": false, "score": 0, "creation_date": 1427372206, "post_id": 29277627, "comment_id": 46754394, "body": "@theva are you executing your program in the same folder as the file is currently?"}, {"owner": {"reputation": 4687, "user_id": 1221132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a5046ae2fcac22bc44c6663a121f0cc8?s=128&d=identicon&r=PG", "display_name": "theva", "link": "https://stackoverflow.com/users/1221132/theva"}, "edited": false, "score": 0, "creation_date": 1427372297, "post_id": 29277627, "comment_id": 46754452, "body": "No I do not, it is executed form server.go which is in the root of the dir, should the path be relative to that one?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 4687, "user_id": 1221132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a5046ae2fcac22bc44c6663a121f0cc8?s=128&d=identicon&r=PG", "display_name": "theva", "link": "https://stackoverflow.com/users/1221132/theva"}, "edited": false, "score": 0, "creation_date": 1427372425, "post_id": 29277627, "comment_id": 46754537, "body": "@theva yes, can you try with a relative path to the server?"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 3, "last_activity_date": 1427370836, "last_edit_date": 1427370836, "creation_date": 1427370462, "answer_id": 29277627, "question_id": 29277525, "link": "https://stackoverflow.com/questions/29277525/memory-error-html-template-in-go/29277627#29277627", "title": "Memory error, html/template in Go", "body": "<p><a href=\"http://golang.org/pkg/text/template/#ParseFiles\" rel=\"nofollow\">template.ParseFiles</a> returns an error</p>\n\n<pre><code>func ParseFiles(filenames ...string) (*Template, error)\n</code></pre>\n\n<blockquote>\n  <p>If an error occurs, parsing stops and the returned <code>*Template</code> is nil. </p>\n</blockquote>\n\n<p>You should check the error in case there is an issue.<br>\nThat could explain why '<code>t</code>' might be nil.</p>\n\n<p>In general, the best practice is to never ignore error. </p>\n\n<p>Here:</p>\n\n<pre><code>var t *Template\nif t, err := template.ParseFiles(\"web.html\"); err != nil {\n    // do something\n    // return err\n    // or\n    // panic(err)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1427372458, "post_id": 29278236, "comment_id": 46754564, "body": "Good practice indeed. I missed the &#39;<code>Must()</code>&#39; method. +1"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1427387308, "post_id": 29278236, "comment_id": 46765460, "body": "Further, the parsing of the template file should likely be moved out of the specific handler unless you really want to re-parse the (likely) unchanged template file for each and every request. (If you want to be able to change the template without restarting the server a better solution would be to reload the server&#39;s config on SIGHUP or somesuch)."}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 2, "last_activity_date": 1427372212, "creation_date": 1427372212, "answer_id": 29278236, "question_id": 29277525, "link": "https://stackoverflow.com/questions/29277525/memory-error-html-template-in-go/29278236#29278236", "title": "Memory error, html/template in Go", "body": "<p>Another solution is to use <code>template.Must</code> function to cause a panic in case of error. Its usage is justified in this case because the program needs its resources.</p>\n\n<pre><code>t := template.Must(template.ParseFiles(\"web.html\"))\n</code></pre>\n"}], "owner": {"reputation": 4687, "user_id": 1221132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a5046ae2fcac22bc44c6663a121f0cc8?s=128&d=identicon&r=PG", "display_name": "theva", "link": "https://stackoverflow.com/users/1221132/theva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 1, "accepted_answer_id": 29277627, "answer_count": 2, "score": 0, "last_activity_date": 1427372212, "creation_date": 1427370135, "question_id": 29277525, "link": "https://stackoverflow.com/questions/29277525/memory-error-html-template-in-go", "title": "Memory error, html/template in Go", "body": "<p>I get some memory error when trying to execute this code:</p>\n\n<pre><code>package web\n\nimport (\n    \"net/http\"\n    \"html/template\"\n)\n\ntype Hello struct {\n    Level string\n}\n\nfunc Main(w http.ResponseWriter, r *http.Request) {\n\n    h := Hello{Level: \"gsdfg\"}\n\n    t, _ := template.ParseFiles(\"web.html\")\n    t.Execute(w, h)\n}\n</code></pre>\n\n<p>The error message I get in the browser is this:</p>\n\n<pre><code>the runtime process gave a bad HTTP response: ''\n\n2015/03/26 11:34:56 http: panic serving 127.0.0.1:43269: runtime error: invalid memory address or nil pointer dereference\n</code></pre>\n\n<p>I dont understand what I am doing wrong...</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore", "google-cloud-storage"], "comments": [{"owner": {"reputation": 654, "user_id": 3508122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1057c941dbec272576741ee1db60cdc2?s=128&d=identicon&r=PG&f=1", "display_name": "user3508122", "link": "https://stackoverflow.com/users/3508122/user3508122"}, "edited": false, "score": 1, "creation_date": 1427364696, "post_id": 29275359, "comment_id": 46750337, "body": "<a href=\"http://stackoverflow.com/questions/25823186/flattening-nested-structs-leads-to-a-slice-of-slices\" title=\"flattening nested structs leads to a slice of slices\">stackoverflow.com/questions/25823186/&hellip;</a> - The approach here suggests converting your entity to and from json when storing which sounds like it could work for you. Also - <a href=\"http://stackoverflow.com/questions/20710802/loading-datastore-entities-from-python-project-in-go-leads-to-nested-structs-sli\" title=\"loading datastore entities from python project in go leads to nested structs sli\">stackoverflow.com/questions/20710802/&hellip;</a> - This post in it the context of python, but it&#39;s the same problem. Hope these help."}, {"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "reply_to_user": {"reputation": 654, "user_id": 3508122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1057c941dbec272576741ee1db60cdc2?s=128&d=identicon&r=PG&f=1", "display_name": "user3508122", "link": "https://stackoverflow.com/users/3508122/user3508122"}, "edited": false, "score": 0, "creation_date": 1427368017, "post_id": 29275359, "comment_id": 46752038, "body": "@user3508122 i saw those  posts but i prefer not  to write my own serialize method ."}, {"owner": {"reputation": 4679, "user_id": 749854, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/541a5cb4925d352cac921c21e9213aa4?s=128&d=identicon&r=PG", "display_name": "nvcnvn", "link": "https://stackoverflow.com/users/749854/nvcnvn"}, "edited": false, "score": 0, "creation_date": 1427373942, "post_id": 29275359, "comment_id": 46755470, "body": "Checkout PropertyLoadSaver <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#hdr-The_PropertyLoadSaver_Interface\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/go/datastore/&hellip;</a> maybe it can help!"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 1, "creation_date": 1427373968, "post_id": 29275359, "comment_id": 46755489, "body": "In the linked question, Guido van Rossum (creator of Python) explains the cause and alternatives to the problem quite well. You&#39;re unlikely to get any better answers here."}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 7106385, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tWCakamvNMU/AAAAAAAAAAI/AAAAAAAAABQ/Ybt7WFOZ5Uc/photo.jpg?sz=128", "display_name": "Sarah Adams", "link": "https://stackoverflow.com/users/7106385/sarah-adams"}, "is_accepted": true, "score": 2, "last_activity_date": 1478112753, "creation_date": 1478112753, "answer_id": 40387646, "question_id": 29275359, "link": "https://stackoverflow.com/questions/29275359/google-datastore-nested-entitys-in-golang/40387646#40387646", "title": "Google Datastore nested entity&#39;s in Golang", "body": "<p>Fix for this is coming in a few days to cloud.google.com/go/datastore -- support for nested entity values!</p>\n\n<p>See post here for details:\n<a href=\"https://groups.google.com/forum/#!topic/google-api-go-announce/79jtrdeuJAg\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/google-api-go-announce/79jtrdeuJAg</a></p>\n"}], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1125, "favorite_count": 0, "accepted_answer_id": 40387646, "answer_count": 1, "score": 2, "last_activity_date": 1489766011, "creation_date": 1427363448, "last_edit_date": 1495542731, "question_id": 29275359, "link": "https://stackoverflow.com/questions/29275359/google-datastore-nested-entitys-in-golang", "title": "Google Datastore nested entity&#39;s in Golang", "body": "<p>I having some problems with design my model ,\nBecause my model contains slice of a slice and  im getting an  error</p>\n\n<pre><code>flattening nested structs leads to a slice of slices\n</code></pre>\n\n<p>What will be the best approach  to design   something like that </p>\n\n<p>I prefer to change my design instead of create my own serialize  method like suggested in this post:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/20710802/loading-datastore-entities-from-python-project-in-go-leads-to-nested-structs-sli\">Loading datastore entities from Python project in Go leads to nested structs slices of slices error</a></p>\n\n<pre><code>type Inner2 struct {\n    Y      float64\n    inner3 []Inner3\n}\n\ntype Inner3 struct {\n    Z bool\n}\n\ntype Outer struct {\n    A int16\n    I []Inner2\n}\n</code></pre>\n"}, {"tags": ["go", "packaging", "cyclic-dependency"], "answers": [{"comments": [{"owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "edited": false, "score": 0, "creation_date": 1427430127, "post_id": 29272506, "comment_id": 46782893, "body": "How does <code>go list -f</code> help?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "edited": false, "score": 1, "creation_date": 1427438089, "post_id": 29272506, "comment_id": 46785292, "body": "@MattJoiner See <a href=\"http://stackoverflow.com/a/16169115/6309\">stackoverflow.com/a/16169115/6309</a>: it shows  show import dependencies for a given package."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 4, "last_activity_date": 1470199232, "last_edit_date": 1495542324, "creation_date": 1427352288, "answer_id": 29272506, "question_id": 29271440, "link": "https://stackoverflow.com/questions/29271440/registering-packages-in-go-without-cyclic-dependency/29272506#29272506", "title": "Registering packages in Go without cyclic dependency", "body": "<blockquote>\n  <p>Those dependent client implementations also import the central package</p>\n</blockquote>\n\n<p>They should rely on another package defining interfaces that they need to rely on (and that are implemented by the first central package).</p>\n\n<p>This is usually how an import cycle is broken (and/or using <a href=\"http://en.wikipedia.org/wiki/Dependency_inversion_principle\" rel=\"nofollow noreferrer\">dependency inversion</a>).</p>\n\n<p>You have more options described in \"<a href=\"https://stackoverflow.com/a/20394211/6309\">Cyclic dependencies and interfaces in Golang</a>\".</p>\n\n<p><a href=\"https://stackoverflow.com/a/16169115/6309\"><code>go list -f</code></a> can also help visualizing those import cycles.</p>\n"}, {"comments": [{"owner": {"reputation": 697, "user_id": 387736, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/72cd33e485b03bcd7858052458a6f945?s=128&d=identicon&r=PG", "display_name": "JohanSJA", "link": "https://stackoverflow.com/users/387736/johansja"}, "edited": false, "score": 1, "creation_date": 1427417067, "post_id": 29272910, "comment_id": 46779775, "body": "May I have more clarification on solution #2? Is the 2nd last paragraph, an <code>init</code> functions refers to each <code>init</code> function in central and implementations?"}, {"owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "edited": false, "score": 1, "creation_date": 1427427158, "post_id": 29272910, "comment_id": 46782183, "body": "Great answer. So, I think #2 doesn&#39;t work for me because to use your example, my <code>image</code> packages <code>image&#47;*</code> need to import <code>image</code> because parts of the interface they&#39;re implementing includes other interfaces in <code>image</code>. I think you saw this, because #3 directly addresses this."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 697, "user_id": 387736, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/72cd33e485b03bcd7858052458a6f945?s=128&d=identicon&r=PG", "display_name": "JohanSJA", "link": "https://stackoverflow.com/users/387736/johansja"}, "edited": false, "score": 0, "creation_date": 1427442113, "post_id": 29272910, "comment_id": 46786816, "body": "@JohanSJA I&#39;m referring to the subpackages: png decoder will only work and be available for the <code>image.Decode()</code> function if the <code>init()</code> functions of the <code>image&#47;png</code> package have been executed which register the png decoder at the registry of the <code>image</code> package. This (calling <code>init()</code> functions of <code>image&#47;png</code>) is triggered if you import the package (even with just the <code>_</code> blank identifier): <code>import _ &quot;image&#47;png&quot;</code>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "edited": false, "score": 0, "creation_date": 1427442272, "post_id": 29272910, "comment_id": 46786880, "body": "@MattJoiner Yes, that is correct. Solution #3 solves this by moving the &quot;factory&quot; functions to a new package therefore <code>pi</code> does not need to import the implementation packages <code>pa</code> and <code>pb</code>."}, {"owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "edited": false, "score": 1, "creation_date": 1427605572, "post_id": 29272910, "comment_id": 46842156, "body": "Thank you for addressing this unreasonably contentious issue."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 33, "last_activity_date": 1468687509, "last_edit_date": 1468687509, "creation_date": 1427354342, "answer_id": 29272910, "question_id": 29271440, "link": "https://stackoverflow.com/questions/29271440/registering-packages-in-go-without-cyclic-dependency/29272910#29272910", "title": "Registering packages in Go without cyclic dependency", "body": "<p>The standard library solves this problem in multiple ways:</p>\n\n<h2>1) Without a \"Central\" Registry</h2>\n\n<p>Example of this is the different hash algorithms. The <a href=\"http://golang.org/pkg/crypto/\" rel=\"noreferrer\"><code>crypto</code></a> package just defines the <a href=\"http://golang.org/pkg/crypto/#Hash\" rel=\"noreferrer\"><code>Hash</code></a> interface (the type and its methods). Concrete implementations are in different packages (actually subfolders but doesn't need to be) for example <a href=\"http://golang.org/pkg/crypto/md5/\" rel=\"noreferrer\"><code>crypto/md5</code></a> and <a href=\"http://golang.org/pkg/crypto/sha256/\" rel=\"noreferrer\"><code>crypto/sha256</code></a>.</p>\n\n<p>When you need a \"hasher\", you explicitly state which one you want and instantiate that one, e.g. </p>\n\n<pre><code>h1 := md5.New()\nh2 := sha256.New()\n</code></pre>\n\n<p>This is the simplest solution and it also gives you good separation: the <code>hash</code> package does not have to know or worry about implementations.</p>\n\n<p>This is the preferred solution if you know or you can decide which implementation you want prior.</p>\n\n<h2>2) With a \"Central\" Registry</h2>\n\n<p>This is basically your proposed solution. Implementations have to register themselves in some way (usually in a package <code>init()</code> function).</p>\n\n<p>An example of this is the <a href=\"http://golang.org/pkg/image/\" rel=\"noreferrer\"><code>image</code></a> package. The package defines the <a href=\"http://golang.org/pkg/image/#Image\" rel=\"noreferrer\"><code>Image</code></a> interface and several of its implementations. Different image formats are defined in different packages such as <a href=\"http://golang.org/pkg/image/gif/\" rel=\"noreferrer\"><code>image/gif</code></a>, <a href=\"http://golang.org/pkg/image/jpeg/\" rel=\"noreferrer\"><code>image/jpeg</code></a> and <a href=\"http://golang.org/pkg/image/png/\" rel=\"noreferrer\"><code>image/png</code></a>.</p>\n\n<p>The <code>image</code> package has a <a href=\"http://golang.org/pkg/image/\" rel=\"noreferrer\"><code>Decode()</code></a> function which decodes and returns an <a href=\"http://golang.org/pkg/image/#Image\" rel=\"noreferrer\"><code>Image</code></a> from the specified <a href=\"http://golang.org/pkg/io/#Reader\" rel=\"noreferrer\"><code>io.Reader</code></a>. Often it is unknown what type of image comes from the reader and so you can't use the decoder algorithm of a specific image format.</p>\n\n<p>In this case if we want the image decoding mechanism to be extensible, a registration is unavoidable. The cleanest to do this is in package <code>init()</code> functions which is triggered by specifying the blank identifier for the package name when importing.</p>\n\n<p>Note that this solution also gives you the possibility to use a specific implementation to decode an image, the concrete implementations also provide the <code>Decode()</code> function, for example <a href=\"http://golang.org/pkg/image/png/#Decode\" rel=\"noreferrer\"><code>png.Decode()</code></a>.</p>\n\n<hr>\n\n<p>So the best way?</p>\n\n<p>Depends on what your requirements are. If you know or you can decide which implementation you need, go with #1. If you can't decide or you don't know and you need extensibility, go with #2.</p>\n\n<p>...Or go with #3 presented below.</p>\n\n<h2>3) Proposing a 3rd Solution: \"Custom\" Registry</h2>\n\n<p>You can still have the convenience of the \"central\" registry with interface and implementations separated with the expense of \"auto-extensibility\".</p>\n\n<p>The idea is that you have the interface in package <code>pi</code>. You have implementations in package <code>pa</code>, <code>pb</code> etc.</p>\n\n<p>And you create a package <code>pf</code> which will have the \"factory\" methods you want, e.g. <code>pf.NewClient()</code>. The <code>pf</code> package can refer to packages <code>pa</code>, <code>pb</code>, <code>pi</code> without creating a circular dependency.</p>\n"}], "owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2816, "favorite_count": 12, "accepted_answer_id": 29272910, "answer_count": 2, "score": 23, "last_activity_date": 1470199232, "creation_date": 1427346320, "question_id": 29271440, "link": "https://stackoverflow.com/questions/29271440/registering-packages-in-go-without-cyclic-dependency", "title": "Registering packages in Go without cyclic dependency", "body": "<p>I have a central package that provides several interfaces that other packages are dependent on (let us call one <code>Client</code>). Those other packages, provide several implementations of those first interfaces (<code>UDPClient</code>, <code>TCPClient</code>). I instantiate a <code>Client</code> by calling <code>NewClient</code> in the central package, and it selects and invokes the appropriate client implementation from one of the dependent packages.</p>\n\n<p>This falls apart when I want to tell the central package about those other packages, so it knows what clients it can create. Those dependent client implementations also import the central package, creating a cyclic dependency which Go does not allow.</p>\n\n<p>What's the best way forward? I'd prefer not to mash all those implementations in a single package, and creating a separate registry package seems overkill. Currently I have each implementation register itself with the central package, but this requires that the user knows to import every implementation in every separate binary that makes use of client.</p>\n\n<pre><code>import (\n    _ udpclient\n    _ tcpclient\n    client\n)\n</code></pre>\n"}, {"tags": ["sql", "database", "logging", "go"], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 1460991, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a8c1a4a881ddda8411db0c59c6678cf9?s=128&d=identicon&r=PG", "display_name": "FlowRaja", "link": "https://stackoverflow.com/users/1460991/flowraja"}, "edited": false, "score": 0, "creation_date": 1427381098, "post_id": 29275270, "comment_id": 46760675, "body": "So the first option is an obvious shortcut, but the repeat of query has issue because if the developer edits the Exec string and not the Println string, there will be a discrepancy and defeat the purpose.  Your second solution seems to be the answer. I need to write a wrapper package for accessing DB which does logging and other custom behavior for me. Thank you for the idea.  Basic reason why I don&#39;t want to depend on the DB server logging is that I don&#39;t have access to some of them and secondly, it would be great to have it in a centralized place."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 597, "user_id": 1460991, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a8c1a4a881ddda8411db0c59c6678cf9?s=128&d=identicon&r=PG", "display_name": "FlowRaja", "link": "https://stackoverflow.com/users/1460991/flowraja"}, "edited": false, "score": 0, "creation_date": 1427381928, "post_id": 29275270, "comment_id": 46761335, "body": "The bonus of the struct approach is that you can use an interface in your methods, which will simplify unit-testing\u2026"}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 2, "last_activity_date": 1427363715, "last_edit_date": 1427363715, "creation_date": 1427363146, "answer_id": 29275270, "question_id": 29270501, "link": "https://stackoverflow.com/questions/29270501/how-to-log-queries-to-database-drivers/29275270#29275270", "title": "How to log queries to database drivers?", "body": "<p>Assuming that you don't want to use the servers logging facilities, the obvious solution would be to simply log all queries as they are made.</p>\n\n<pre><code>db, err := sql.Open(driver, dataSourceName)\nlog.Println(dataSourceName, \"INSERT INTO users (name, age) VALUES (?, ?)\", \"gopher\", 27)\nresult, err := db.Exec(\n    \"INSERT INTO users (name, age) VALUES (?, ?)\",\n    \"gopher\",\n    27,\n)\n</code></pre>\n\n<p>This is the basic solution for your problem. You can refine it in multiple ways:</p>\n\n<ul>\n<li>Create a <code>log.Logger</code> exclusively for your queries, so you can direct it to a particular output destination</li>\n<li>Wrap the said <code>log.Logger</code> and the <code>sql.DB</code> objects in a special struct that will log queries as they are done</li>\n</ul>\n\n<p>Here is a rough example of the said struct:</p>\n\n<pre><code>type DB struct {\n    db *sql.DB\n    dsn string\n    log *log.Logger\n}\n\nfunc NewDB(driver, dsn string, log *log.Logger) (*DB, error) {\n    db, err := sql.Open(driver, dsn)\n    if err != nil {\n        return nil, err\n    }\n\n    return &amp;DB {\n        db: db,\n        dsn: dsn,\n        log: log,\n    }\n}\n\nfunc (d DB) Exec(query string, args ...interface{}) (sql.Result, err) {\n    d.log.Println(dsn, query, args)\n    return d.db.Exec(query, args...)\n}\n</code></pre>\n\n<p>And how you would use it:</p>\n\n<pre><code>l := log.New(os.Stdout, \"[sql]\", log.LstdFlags)\n\ndb, _ := NewDB(driver, dataSourceName, l)\nresult, _ := db.Exec(\n    \"INSERT INTO users (name, age) VALUES (?, ?)\",\n    \"gopher\",\n    27,\n)\n</code></pre>\n\n<p>Obviously, you can refined this design again, by adding error reporting, duration of the queries, etc.</p>\n"}], "owner": {"reputation": 597, "user_id": 1460991, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a8c1a4a881ddda8411db0c59c6678cf9?s=128&d=identicon&r=PG", "display_name": "FlowRaja", "link": "https://stackoverflow.com/users/1460991/flowraja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8542, "favorite_count": 2, "accepted_answer_id": 29275270, "answer_count": 1, "score": 3, "last_activity_date": 1610751456, "creation_date": 1427339722, "last_edit_date": 1610751456, "question_id": 29270501, "link": "https://stackoverflow.com/questions/29270501/how-to-log-queries-to-database-drivers", "title": "How to log queries to database drivers?", "body": "<p>I am trying to write a simple Database application in go which access multiple data servers, some MySQL, MSSQL and SqlLite3.\nI am using the &quot;database/sql&quot; package to access them.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>db, err := sql.Open(driver, dataSourceName)\nresult, err := db.Exec(\n    &quot;INSERT INTO users (name, age) VALUES (?, ?)&quot;,\n    &quot;gopher&quot;,\n    27,\n)\n</code></pre>\n<p>I need to log the SQL queries to the individual servers for debugging and auditing.\nHow can I achieve that?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1427339733, "post_id": 29270083, "comment_id": 46741799, "body": "Global variables storing per-request data? What if you get two overlapping requests?"}, {"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1427381156, "post_id": 29270083, "comment_id": 46760722, "body": "<code>if withKetchup == true</code> is the same as <code>if withKetchup</code>."}], "answers": [{"comments": [{"owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "edited": false, "score": 0, "creation_date": 1427337744, "post_id": 29270140, "comment_id": 46741300, "body": "ok, thank you for the suggestion. After removing the <code>:</code> as you indicated, I got another error, that I can&#39;t use r.FormValue(&quot;withKetchup&quot;) (type string) as type bool in assignment. Note, I had set the form values using Booleans in javascript. Any idea what be the problem (which I need to solve before trying your solution) (This is before trying your suggestion of passing them as parameters)"}, {"owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "edited": false, "score": 0, "creation_date": 1427338737, "post_id": 29270140, "comment_id": 46741573, "body": "thanks, however, the <code>!= &quot;&quot;</code> code is now setting the values to <code>true</code> no matter what, even if the Boolean false is passed through the form.Double checked twice."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "edited": false, "score": 0, "creation_date": 1427339022, "post_id": 29270140, "comment_id": 46741648, "body": "@BrainLikeADullPencil I assumed that your client is sending &quot;&quot; for false. You should compare with whatever the true or false value the client is sending.  Print r.FormValue(&quot;withMustard&quot;) to determine what the client is sending."}, {"owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "edited": false, "score": 0, "creation_date": 1427339133, "post_id": 29270140, "comment_id": 46741670, "body": "I printed r.FormValue to the Chrome consule, it says &quot;true&quot; when I check true, and &quot;false&quot; when I check/send false"}, {"owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "edited": false, "score": 0, "creation_date": 1427339202, "post_id": 29270140, "comment_id": 46741689, "body": "I found a way around the problem by sending a string and reading the content of the string, and then setting a bool in the go code based on the content of the string, however, that&#39;s just a way to avoid the problem of why the js bool is not translating as I intended to go"}, {"owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "edited": false, "score": 0, "creation_date": 1427339235, "post_id": 29270140, "comment_id": 46741692, "body": "I&#39;m not sure what you&#39;re asking me to do <code>r.FormValue(&quot;withMustard&quot;) == &quot;true&quot;.</code>"}, {"owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "edited": false, "score": 0, "creation_date": 1427339298, "post_id": 29270140, "comment_id": 46741708, "body": "ok, see your edit, but what if the order is without ketchup? That doesn&#39;t give me a possibility to set it to false, does it? ` r.FormValue(&quot;withKetchup&quot;) == &quot;true&quot;`"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "edited": false, "score": 0, "creation_date": 1427339405, "post_id": 29270140, "comment_id": 46741732, "body": "The variable withKetchup will be set to true if the form has a field &quot;withKetchup&quot; with the value &quot;true&quot;. Otherwise, the variable is set to false.  If the form value is &quot;false&quot;, then then the variable is set false. If the form value is not present, then the variable is set to false."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 8, "last_activity_date": 1427339209, "last_edit_date": 1427339209, "creation_date": 1427337365, "answer_id": 29270140, "question_id": 29270083, "link": "https://stackoverflow.com/questions/29270083/boolean-values-set-to-true-unintentionally-changing-to-false/29270140#29270140", "title": "boolean values set to true unintentionally changing to false", "body": "<p>The code</p>\n\n<pre><code> withKetchup := r.FormValue(\"withKetchup\") \n</code></pre>\n\n<p>declares and sets a local variable of type string using a <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"noreferrer\">short variable declaration</a>. To set the global bool variable, convert the statement to an assignment by removing the \":\". Also, compute a bool value by comparing the form value with \"\":</p>\n\n<pre><code> withKetchup = r.FormValue(\"withKetchup\") == \"true\"\n</code></pre>\n\n<p>Because the server executes handlers concurrently, it's not safe to use a global variable like this. I suggest passing the values as arguments to prepareOrder:</p>\n\n<pre><code>func orderProcess(w http.ResponseWriter, r *http.Request){\n\n     r.ParseForm()\n     withKetchup := r.FormValue(\"withKetchup\") == \"true\"\n     withMustard := r.FormValue(\"withMustard\") == \"true\"\n     prepareOrder(withKetchup, withMustard)\n}\n\nfunc prepareOrder(withKetchup, withMustard bool){\n     if withKetchup == true &amp;&amp; withMustard == true{\n\n     }else {\n\n     }\n}\n</code></pre>\n"}], "owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3235, "favorite_count": 1, "accepted_answer_id": 29270140, "answer_count": 1, "score": 2, "last_activity_date": 1427339209, "creation_date": 1427336955, "question_id": 29270083, "link": "https://stackoverflow.com/questions/29270083/boolean-values-set-to-true-unintentionally-changing-to-false", "title": "boolean values set to true unintentionally changing to false", "body": "<p>In my golang application, I'm setting some global variables to true based on form input, and then discovering that they have changed to false when used in a subsequent function. Question, what is the proper way to declare and set Boolean values in golang?</p>\n\n<pre><code>var withKetchup bool\nvar withMustard bool\n\nfunc orderProcess(w http.ResponseWriter, r *http.Request){\n\n     r.ParseForm()\n     withKetchup := r.FormValue(\"withKetchup\")  //set to true (in form js form selection)\n     withMustard := r.FormValue(\"withMustard\")  //set to true\n\n      code omitted ///\n}\n\nfunc prepareOrder(){\n\n      code omitted//\n     fmt.Println(withKetchup, withMustard) //both are false even though initially set to true\n     if withKetchup == true &amp;&amp; withMustard == true{\n\n     }else {\n\n     }\n\n\n}\n</code></pre>\n"}, {"tags": ["concurrency", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427339747, "post_id": 29269850, "comment_id": 46741804, "body": "You directly quote the documentation that answers your question?? &quot;\u2026 <b>and after</b> any <b>previously sent</b> values have been received\u2026&quot; BTW, I suspect that when you move the close the goroutines panic writing to a closed channel."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427340539, "post_id": 29269850, "comment_id": 46741983, "body": "@DaveC the issue was actually that when I tested it I didn&#39;t have time.Sleep so basically I just read from a closed channel because the go routines didn&#39;t have time to send any value . <a href=\"http://play.golang.org/p/ssBAwu3oXi\" rel=\"nofollow noreferrer\">play.golang.org/p/ssBAwu3oXi</a>"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 10, "last_activity_date": 1427336487, "last_edit_date": 1427336487, "creation_date": 1427335999, "answer_id": 29269960, "question_id": 29269850, "link": "https://stackoverflow.com/questions/29269850/why-do-i-receive-values-from-a-closed-channel/29269960#29269960", "title": "Why do I receive values from a closed channel?", "body": "<blockquote>\n  <p><a href=\"http://golang.org/ref/spec\" rel=\"noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"http://golang.org/ref/spec#Close\" rel=\"noreferrer\">Close</a></p>\n  \n  <p>For a channel c, the built-in function close(c) records that no more\n  values will be sent on the channel.\n  After calling close, and after any previously sent values have been\n  received, receive operations will return the zero value for the\n  channel's type without blocking.</p>\n</blockquote>\n\n<p>In the channel buffer there are 5 previously sent values followed by a close.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    iCh := make(chan int, 99)\n    var wg sync.WaitGroup\n    go func() {\n        for i := 0; i &lt; 5; i++ {\n            wg.Add(1)\n            go func(i int) {\n                defer wg.Done()\n                iCh &lt;- i\n            }(i)\n\n        }\n        wg.Wait()\n        close(iCh)\n    }()\n\n    time.Sleep(5 * time.Second)\n    fmt.Println(\"previously sent values\", len(iCh))\n    for i := range iCh {\n        fmt.Printf(\"%v\\n\", i)\n    }\n    print(\"the channel should be closed by now\\n\")\n    print(\"done\")\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>previously sent values 5\n0\n1\n2\n3\n4\nthe channel should be closed by now\ndone\n</code></pre>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6778, "favorite_count": 2, "accepted_answer_id": 29269960, "answer_count": 1, "score": 3, "last_activity_date": 1427336487, "creation_date": 1427335272, "question_id": 29269850, "link": "https://stackoverflow.com/questions/29269850/why-do-i-receive-values-from-a-closed-channel", "title": "Why do I receive values from a closed channel?", "body": "<p>I'm investigating the channels behaviour and I'm quite confused by their behaviour. The spec say <code>After calling close, and after any previously sent values have been received, receive operations will return the zero value for the channel's type without blocking.</code> However it seems I still get the values in the range statement even if by that time the channel is closed. Why is that?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"sync\"\nimport \"time\"\n\nfunc main() {\n    iCh := make(chan int, 99)\n    var wg sync.WaitGroup\n    go func() {\n        for i := 0; i &lt; 5; i++ {\n            wg.Add(1)\n            go func(i int) {\n                defer wg.Done()\n                iCh &lt;- i\n            }(i)\n\n        }\n        wg.Wait()\n        close(iCh)\n    }()\n    time.Sleep(5 * time.Second)\n    print(\"the channel should be closed by now\\n\")\n    for i := range iCh {\n        fmt.Printf(\"%v\\n\", i)\n    }\n    print(\"done\")\n}\n</code></pre>\n\n<p><strong>Edit:</strong> It seems that if I move the <code>close</code> statement just before the channel range it closes it for good. So I'm wondering why it's not working with the \"time.Sleep\" trick too . By that time (5 seconds) all the go routines should have been completed and the channel closed, isn't it ?</p>\n"}, {"tags": ["google-app-engine", "concurrency", "go"], "comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427332650, "post_id": 29269416, "comment_id": 46740087, "body": "That <code>done</code> channel gets created and closed within 3 lines. Its also the way you break out of your infinite loop. Perhaps you should review its use?"}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427332938, "post_id": 29269416, "comment_id": 46740163, "body": "I&#39;m not sure if I understand. I close the channel so that select can break. It breaks on a closed channel, isn&#39;t it ?"}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427333666, "post_id": 29269416, "comment_id": 46740339, "body": "@Simon Whitehead Here is a snippet which proves that it works. <a href=\"http://play.golang.org/p/hJg1fbfO5d\" rel=\"nofollow noreferrer\">play.golang.org/p/hJg1fbfO5d</a>"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427338136, "post_id": 29269416, "comment_id": 46741416, "body": "I wasn&#39;t debating that it worked .. I was raising a concern about your use of it. It seems completely redundant."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427338226, "post_id": 29269416, "comment_id": 46741439, "body": "How is that? I don&#39;t see any way to exit the loop and still return on errorCh without to wait for all the go routines to return."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1427339724, "post_id": 29269416, "comment_id": 46741796, "body": "You don&#39;t want to loop on a <code>select{}</code> with <code>default:</code>; if you drop the default, it will wait for communication to happen without occupying the CPU. I think App Engine has <code>GOMAXPROCS=1</code>, so if your machine doesn&#39;t have it, this may matter."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1427340507, "post_id": 29269416, "comment_id": 46741976, "body": "Design-wise, you can start a fixed set of tasks and collect results and errors with as little as one <code>go</code> statement in a loop, and a <code>for</code> loop collecting results/errors with a blocking select on a <code>chan struct { result int, err error }</code> until it gets to the expected count of items. If you have additional needs, it is still probably possible to get by with less than (4 <code>go</code>s + 2 <code>WaitGroup</code>s + 2 non-blocking <code>select</code>s + 3 <code>chan</code>s)."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1427340544, "post_id": 29269416, "comment_id": 46741985, "body": "(If there are app-specific reasons all of those pieces truly are necessary, you have a complicated situation and may need a consultant, not just SO.)"}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1427341717, "post_id": 29269416, "comment_id": 46742236, "body": "@twotwotwo I&#39;m not sure what &quot;truly necessary&quot; means but I would be surprised if you can reproduce the same results with one statement in a loop. The idea is basically to return as soon as there is an error on any go routine. That means that the error should be broadcasted to all the go routines including the &quot;main&quot; one otherwise new go routines are launched  from the loop while you &quot;wait&quot;."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1427341754, "post_id": 29269416, "comment_id": 46742245, "body": "@twotwotwo btw the question is if there is any go routine leak. I think it&#39;s pretty straightforward after all and shouldn&#39;t require &quot;consultancy&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1427345773, "post_id": 29271263, "comment_id": 46743208, "body": "This seems to be the answer through the change doesn&#39;t make much sense to me as the for loop is definitely not starving the resources(i.e is cheap). Some networking code would also make use of such loops but maybe I just get this wrong."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1427346170, "post_id": 29271263, "comment_id": 46743312, "body": "One run through the loop is cheap, but it never yields to the scheduler so other code can send an item for it to pick up, so it ends up an infinite loop. I don&#39;t have a source handy, but in networking code, you&#39;ll tend to make a blocking call (in that case often just <code>Dial()</code>/<code>Read()</code>/<code>Write()</code>) that yields to the scheduler and lets other goroutines do other work."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1427346231, "post_id": 29271263, "comment_id": 46743335, "body": "This may be a bit too much but is there any way that I could have &quot;detected&quot; this issue without to actually know the internals/behaviour of the scheduler ?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1427346673, "post_id": 29271263, "comment_id": 46743454, "body": "I can&#39;t think of a trivial way to catch it here, no."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1427346951, "post_id": 29271263, "comment_id": 46743512, "body": "Updated answer slightly: I get hangs on the Playground still but, interestingly, not seeing it on my machine. I think it&#39;s because it depends not only on <code>GOMAXPROCS</code> but what code happens to run first, but not certain."}], "tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 1, "last_activity_date": 1427355021, "last_edit_date": 1427355021, "creation_date": 1427345093, "answer_id": 29271263, "question_id": 29269416, "link": "https://stackoverflow.com/questions/29269416/where-is-the-go-routine-leak/29271263#29271263", "title": "Where is the Go routine leak?", "body": "<p><em>tl;dr</em>: A loop that does nothing but repeat a non-blocking check until it succeeds can cause hard-to-diagnose trouble (at a minimum, it can overuse CPU); using a blocking check can fix it. </p>\n\n<p>I'm not all that sure about the details of your case; I wrote a loop like yours that consistently hangs with \"process took too long\" on the Playground, but when I run it locally it does complete.</p>\n\n<p>As I commented, I'd aim for a simpler design, too.</p>\n\n<hr>\n\n<p><a href=\"http://golang.org/doc/go1.2#preemption\" rel=\"nofollow\">Go only has limited pre-emption of running goroutines</a>: the running thread only yields control to the goroutine scheduler when a blocking operation (an like I/O or channel op or waiting to take a lock) happens.</p>\n\n<p>So with <code>GOMAXPROCS=1</code>, if the (one) running thread starts looping, nothing else will necessarily get a chance to run. </p>\n\n<p>A <code>for { select { ...default: } }</code> can therefore start a loop checking for items in a channel but never give up control of the main thread so that another goroutine can write an item. Other code gets to run anyway when when <code>GOMAXPROCS</code> is over 1, but not when it's 1 as it is on App Engine (or the Playground). The behavior depends not only on <code>GOMAXPROCS</code>, but on which goroutine happens to run first, which isn't necessarily defined.</p>\n\n<p>To avoid that situation, remove the <code>default:</code> so the <code>select</code> is a blocking operation that yields to the scheduler when it can't receive an item, allowing other code to run. You can generalize this to other cases where you might loop doing a nonblocking check; any of them could keep resources busy constantly rechecking when a blocking call would not. When <code>GOMAXPROCS&gt;1</code> or the runtime's limited preemption saves you, polling (as repeated checking is called) can still consume more CPU than blocking.</p>\n\n<p>For example, this fails with \"process took too long\" <a href=\"http://play.golang.org/p/DWwfPd-Xqk\" rel=\"nofollow\">on the Playground</a>, though annoyingly it completes reliably on my machine:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    c := make(chan struct{})\n    go func() { c &lt;- struct{}{} }()\n    for {\n        select {\n        case &lt;-c:\n            fmt.Println(\"success\")\n            return\n        default:\n        }\n    }\n} \n</code></pre>\n\n<p>I can't tell if there are other problems, but the hang for a pattern similar to the sample is noteworthy.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 29271263, "answer_count": 1, "score": -1, "last_activity_date": 1427388285, "creation_date": 1427332443, "last_edit_date": 1427388285, "question_id": 29269416, "link": "https://stackoverflow.com/questions/29269416/where-is-the-go-routine-leak", "title": "Where is the Go routine leak?", "body": "<p>I'm trying to run several tasks concurrently and return immediately if there is any error without to wait for all of the routines  to return. The code looks as below. I've stripped out the noise to make it easier to digest but I can post the full code if the leak is not obvious. \nIt's worth to note that I'm deploying this on google app engine. I can't reproduce the leak on my machine but when I replace the concurrency after <code>// Consume the results</code> comment the app is working fine, though I don't understand why because the code looks correct to me.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"sync\"\nimport \"errors\"\n\nfunc main() {\n    indexes := []int{1, 2, 3, 4, 5, 6, 7}\n    devCh := make(chan int, 7)\n    stopCh := make(chan struct{})\n    errCh := make(chan error, 7)\n    var wg sync.WaitGroup\n    go func() {\n        for _, sub := range indexes {\n            wg.Add(1)\n            go func(sub int) {\n                defer wg.Done()\n                // some code which creates other\n                // wait groups and spans other go routines\n                // handle errors\n                if sub == 99 { // unreachable \n                    errCh &lt;- errors.New(\"new error\")\n\n                }\n            }(sub)\n            select {\n            // If there is any error we better stop the\n            // loop\n            case &lt;-stopCh:\n                return\n            default:\n            }\n            devCh &lt;- sub\n        }\n        wg.Wait()\n        close(devCh)\n    }()\n    // Consume the results\n    var results []int\n    var wt sync.WaitGroup\n    wt.Add(1)\n    go func() {\n        defer wt.Done()\n        for s := range devCh {\n            results = append(results, s)\n        }\n        return\n    }()\n    done := make(chan struct{})\n    go func() {\n        wt.Wait()\n        close(done)\n    }()\n\nL:\n    for {\n        select {\n        case err := &lt;-errCh:\n            fmt.Printf(\"error was %v\", err)\n            close(stopCh)\n            return\n        case &lt;-done:\n            break L\n        default:\n        }\n    }\n    fmt.Printf(\"all done, %v\", results)\n}\n</code></pre>\n\n<p>Edit: added some working code.</p>\n\n<p>Edit: added code closer to the real code which may explain the need of the for loop.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"sync\"\nimport \"errors\"\n\nfunc main() {\n    indexes := []int{1, 2, 3, 4, 5, 6, 7}\n    indexesString := []string{\"a\", \"b\", \"c\", \"d\"}\n    devChS := make(chan string, 1000)\n\n    devCh := make(chan int, 7)\n    stopCh := make(chan struct{})\n    errCh := make(chan error, 7)\n    var wg sync.WaitGroup\n    go func() {\n        for _, sub := range indexes {\n            wg.Add(1)\n            go func(sub int) {\n                defer wg.Done()\n                // some code which creates other\n                // wait groups and spans other go routines\n                // handle errors\n                if sub == 99 { // unreachable\n                    errCh &lt;- errors.New(\"new error\")\n\n                }\n                wg.Add(1)\n                go func(sub int) {\n                    defer wg.Done()\n                    for _, s := range indexesString {\n                        devChS &lt;- fmt.Sprintf(\"%s %s\", s, sub)\n\n                    }\n\n                    return\n                }(sub)\n            }(sub)\n            select {\n            // If there is any error we better stop the\n            // loop\n            case &lt;-stopCh:\n                return\n            default:\n            }\n            devCh &lt;- sub\n        }\n        wg.Wait()\n        close(devCh)\n        close(devChS)\n    }()\n    // Consume the results\n    var results = struct {\n        integers []int\n        strings  []string\n    }{}\n    var wt sync.WaitGroup\n    wt.Add(1)\n    go func() {\n        defer wt.Done()\n        for s := range devCh {\n            results.integers = append(results.integers, s)\n        }\n        return\n    }()\n    wt.Add(1)\n    go func() {\n        defer wt.Done()\n        for s := range devChS {\n            results.strings = append(results.strings, s)\n        }\n        return\n    }()\n    done := make(chan struct{})\n    go func() {\n        wt.Wait()\n        close(done)\n    }()\n\nL:\n    for {\n        select {\n        case err := &lt;-errCh:\n            fmt.Printf(\"error was %v\", err)\n            close(stopCh)\n            return\n        case &lt;-done:\n            break L\n        default:\n        }\n    }\n    fmt.Printf(\"all done, can return the results: %v\", results)\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 0, "last_activity_date": 1458330248, "last_edit_date": 1495540786, "creation_date": 1427353165, "answer_id": 29272701, "question_id": 29268881, "link": "https://stackoverflow.com/questions/29268881/how-to-enforce-testing-order-for-different-tests-in-a-go-framework/29272701#29272701", "title": "How to enforce testing order for different tests in a go framework?", "body": "<p>It isn't obvious, considering a <code>go test ./...</code> triggers test on all packages... but runs in parallel: see \"<a href=\"https://stackoverflow.com/a/23840896/6309\">Go: how to run tests for multiple packages?</a>\".</p>\n\n<p><code>go test -p 1</code> would run the tests sequentially, but not necessarily in the order you would need.</p>\n\n<p>A simple script calling <code>go test</code> on the packages listed in the right expected order would be easier to do.</p>\n"}], "owner": {"reputation": 316, "user_id": 4714525, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/24d28783dc3ba3a318ec3ebe1bd372b1?s=128&d=identicon&r=PG&f=1", "display_name": "kbinstance", "link": "https://stackoverflow.com/users/4714525/kbinstance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 1, "accepted_answer_id": 29272701, "answer_count": 1, "score": 2, "last_activity_date": 1458330248, "creation_date": 1427328572, "last_edit_date": 1458330230, "question_id": 29268881, "link": "https://stackoverflow.com/questions/29268881/how-to-enforce-testing-order-for-different-tests-in-a-go-framework", "title": "How to enforce testing order for different tests in a go framework?", "body": "<p>If I have different packages and each have a test file (<code>pkg_test.go</code>) is there a way for me to make sure that they run in a particular order ?</p>\n\n<p>Say <code>pkg1_test.go</code> gets executed first and then the rest. </p>\n\n<p>I tried using go channels but it seems to hang.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1427332679, "post_id": 29268860, "comment_id": 46740096, "body": "I hate to say it, but this is exactly what a router/mux package like Gorilla saves you from doing. Other than that, <code>r.URL.Path</code> provides that functionality."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1427336922, "creation_date": 1427336922, "answer_id": 29270077, "question_id": 29268860, "link": "https://stackoverflow.com/questions/29268860/get-the-current-pattern-that-matched-an-http-handlefunc/29270077#29270077", "title": "Get the current pattern that matched an http.HandleFunc", "body": "<p>It is not possible to get the current route that matched, but it is possible to eliminate the duplicate code in your scenario. Write a handler that checks the path before calling through to another handler:</p>\n\n<pre><code>func HandleFuncExact(mux *http.ServeMux, pattern string, handler func(http.ResponseWriter, *http.Request) {\n    mux.HandleFunc(pattern, func(w http.ResponseWriter, r *http.Request) {\n        if req.URL.Path != pattern {\n            http.NotFound(w, r)\n            return\n        }\n        handler(w, r)\n    })\n}\n</code></pre>\n\n<p>In your application, call the wrapper instead of HandlFunc:</p>\n\n<pre><code>HandleFuncExact(http.DefaultServeMux, \"/some-route/\", serveSomeRoute)\n</code></pre>\n\n<p>The function <code>serveSomeRoute</code> can assume that the path is exactly \"/some-route/\".</p>\n"}], "owner": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 29270077, "answer_count": 1, "score": 0, "last_activity_date": 1427336922, "creation_date": 1427328431, "last_edit_date": 1427328778, "question_id": 29268860, "link": "https://stackoverflow.com/questions/29268860/get-the-current-pattern-that-matched-an-http-handlefunc", "title": "Get the current pattern that matched an http.HandleFunc", "body": "<p>Is there a way to get the current route that triggered an <code>http.HandleFunc</code>? Maybe something like this?</p>\n\n<pre><code>http.HandleFunc(\"/foo/\", serveFoo)\nfunc serveFoo(rw http.ResponseWriter, req *http.Request) {\n    fmt.Println(http.CurrentRoute())\n    // Should print \"/foo/\"\n}\n</code></pre>\n\n<p>The reason I want to get the current route is because I find myself writing code like this often.</p>\n\n<pre><code>if req.URL.Path != \"/some-route/\" {\n    http.NotFound(resp, req)\n    return\n}\n// or\nkey := req.URL.Path[len(\"/some-other-route/\"):]\n</code></pre>\n\n<p>It would be nice if the code was a bit more copy-pastable, modular, and DRY like this.</p>\n\n<pre><code>if req.URL.Path != http.CurrentRoute() {\n    http.NotFound(resp, req)\n    return\n}\n// or\nkey := req.URL.Path[http.CurrentRoute():]\n</code></pre>\n\n<p>This is really just a small thing, so I'd rather not bring a whole other dependency into my project (Gorilla Mux).</p>\n"}]