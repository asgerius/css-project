[{"tags": ["html", "go", "arguments", "render", "template-engine"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 2, "creation_date": 1457566467, "post_id": 35904722, "comment_id": 59469929, "body": "You don&#39;t need to use <code>template.Must</code> here; you&#39;re doing the error checking on the previous lines."}, {"owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1457566759, "post_id": 35904722, "comment_id": 59470037, "body": "@TimCooper I haven&#39;t got it"}, {"owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1457566927, "post_id": 35904722, "comment_id": 59470097, "body": "@TimCooper When I removed <code>templates</code>, and use <code>t.Execute</code>, I compile successfully, the server starts, and the browser displays when requesting <code>index</code> page  <code>open base: no such file or directory</code>  I already register static file handler  <code>http.Handle(&quot;&#47;public&#47;&quot;, http.StripPrefix(&quot;&#47;public&#47;&quot;, http.FileServer(http.Dir(&quot;public&quot;))))</code>  And <code>index</code> route handler in main  <code>http.HandleFunc(&quot;&#47;&quot;,route.IndexHandler)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 235, "user_id": 4783884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac84df6f081961c434a45b71a098222?s=128&d=identicon&r=PG&f=1", "display_name": "Paul A. Fortin", "link": "https://stackoverflow.com/users/4783884/paul-a-fortin"}, "is_accepted": true, "score": 1, "last_activity_date": 1457804730, "creation_date": 1457804730, "answer_id": 35961173, "question_id": 35904722, "link": "https://stackoverflow.com/questions/35904722/go-not-enough-arguments-in-call-to-html-template-must/35961173#35961173", "title": "go - Not enough arguments in call to &quot;html/template&quot;.Must", "body": "<p>You do not need to call ParseFiles and Must, you can call one or the other</p>\n\n<pre><code>func RenderTemplate(w http.ResponseWriter, data interface{}, tmpl... string) {\n    cwd, _ := os.Getwd()\n    for _,file:=range tmpl{\n        file=filepath.Join(cwd,\"./view/\"+file+\".html\")\n    }\n    t, err := template.ParseFiles(tmpl...)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    err = t.Execute(w, data)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    }\n}\n</code></pre>\n\n<p>I believe the func above should do what you want...</p>\n"}, {"tags": [], "owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "is_accepted": false, "score": 1, "last_activity_date": 1457811685, "creation_date": 1457811685, "answer_id": 35962433, "question_id": 35904722, "link": "https://stackoverflow.com/questions/35904722/go-not-enough-arguments-in-call-to-html-template-must/35962433#35962433", "title": "go - Not enough arguments in call to &quot;html/template&quot;.Must", "body": "<p><code>template.Must()</code> has this signature:</p>\n\n<pre><code>func Must(t *Template, err error) *Template \n</code></pre>\n\n<p>the arguments to <code>Must()</code> are \"by coincidence\" the same as the return values to <code>ParseFiles()</code> and <code>ParseGlob()</code> so you can use those functions inside <code>Must()</code> and have the effect that it panics, if the error is non-nil. So you can say</p>\n\n<pre><code>t := template.Must(template.ParseFiles(....))\n</code></pre>\n\n<p>and don't care about the error checking. This is merely a convenience function, similar to all other <code>Must()</code> functions throughout the standard library, such as <code>regexp.MustCompile()</code>.</p>\n\n<p>The implementation of <code>Must()</code> is straightforward:</p>\n\n<pre><code>func Must(t *Template, err error) *Template {\n    if err != nil {\n            panic(err)\n    }\n    return t\n}\n</code></pre>\n\n<p>See <a href=\"https://golang.org/src/text/template/helper.go?s=576:619#L11\" rel=\"nofollow\">https://golang.org/src/text/template/helper.go?s=576:619#L11</a></p>\n"}], "owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1074, "favorite_count": 0, "accepted_answer_id": 35961173, "answer_count": 2, "score": -1, "last_activity_date": 1457811685, "creation_date": 1457566032, "question_id": 35904722, "link": "https://stackoverflow.com/questions/35904722/go-not-enough-arguments-in-call-to-html-template-must", "title": "go - Not enough arguments in call to &quot;html/template&quot;.Must", "body": "<p>I write a wrapper function in Golang for rendering template from multiple files like this:</p>\n\n<pre><code>func RenderTemplate(w http.ResponseWriter, data interface{}, tmpl... string) {\n    cwd, _ := os.Getwd()\n    for _,file:=range tmpl{\n        file=filepath.Join(cwd,\"./view/\"+file+\".html\")\n    }\n    t, err := template.ParseFiles(tmpl...)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n    templates:=template.Must(t)\n    err = templates.Execute(w, data)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    }\n}\n</code></pre>\n\n<p>When I run server from <code>main</code> function, the console throws an error:</p>\n\n<p><code>not enough arguments in call to \"html/template\".Must</code></p>\n\n<p>If I write like this:</p>\n\n<p><code>templates,err:=template.Must(t)</code></p>\n\n<p>It also throws the same error, plus:</p>\n\n<p><code>assignment count mismatch: 2 = 1</code></p>\n\n<p>I intend to use this function for a route handler in server:</p>\n\n<pre><code>func IndexHandler(w http.ResponseWriter, r *http.Request) {\n    files:=[]string{\"base\",\"index\"}\n    util.RenderTemplate(w, nil, files...)\n}\n</code></pre>\n\n<p><code>index.html</code> extends from <code>base.html</code> using template nesting</p>\n\n<p><code>base.html</code> template:</p>\n\n<pre><code>{{define \"base\"}}\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;meta charget=\"utf-8\"&gt;\n    &lt;title&gt;{{template \"title\".}}&lt;/title&gt;\n    &lt;script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-2.2.0.min.js\"&gt;&lt;/script&gt;\n    &lt;script type=\"text/javascript\" src=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js\"&gt;&lt;/script&gt;\n    &lt;script type=\"text/javascript\" src=\"/js/isotope.pkgd.min.js\"&gt;&lt;/script&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css\"&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css\"&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"/css/style.css\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    {{template \"index\".}}\n&lt;/body&gt;\n&lt;/html&gt;\n{{end}}\n</code></pre>\n\n<p>And <code>index.html</code> template:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n{{define \"title\"}}Homepage{{end}}\n&lt;body&gt;\n    {{define \"index\"}}\n    &lt;div class=\"wrapper\"&gt;\n        &lt;div class=\"page-content\"&gt;\n            &lt;div class=\"container\"&gt;\n                &lt;div class=\"left\"&gt;\n                    &lt;img src=\"../public/images/img_landing_page_mac.png\"&gt;\n                &lt;/div&gt;\n                &lt;div class=\"right\"&gt;\n                    &lt;h2 style=\"font-size: 33px; letter-spacing: 5px\"&gt;Organize &lt;br&gt;Modern Knowledge&lt;br&gt; for Mankind&lt;/h2&gt;\n                    &lt;p style=\"font-size: 20px;margin-top: 35px;letter-spacing: 4px\"&gt;Consume, Colect and Revisit &lt;br&gt;Knowledge at Your Fingertips&lt;/p&gt;\n                    &lt;a href=\"#\" style=\"margin-top: 80px;display: inline-block;margin-left: -17px\"&gt;&lt;img src=\"../public/images/btn_get_chrome.png\"&gt;&lt;/a&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n    {{end}}\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Did I miss something? I checked the prototype of <code>\"html/template\".Must</code> and didn't get what happened</p>\n"}, {"tags": ["image", "file-upload", "go", "websocket", "file-writing"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1457569040, "creation_date": 1457569040, "answer_id": 35905270, "question_id": 35904565, "link": "https://stackoverflow.com/questions/35904565/golang-websocket-detecting-file-message-and-writing-it-if-more-than-1-ws-frame-b/35905270#35905270", "title": "Golang Websocket detecting file message and writing it if more than 1 ws frame byte", "body": "<p>The sender <a href=\"https://tools.ietf.org/html/rfc6455#section-5.4\" rel=\"nofollow\">fragments</a> one of the messages into two frames. Because the x/net/websocket <a href=\"https://github.com/golang/go/issues/7632\" rel=\"nofollow\">API exposes frames instead of messages</a>, the application writes three files.</p>\n\n<p>It's not possible to detect message boundaries using the x/net/websocket package. Use the <a href=\"https://github.com/gorilla/websocket#gorilla-websocket-compared-with-other-packages\" rel=\"nofollow\">gorilla/websocket</a> package instead.</p>\n"}], "owner": {"reputation": 47, "user_id": 5982102, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ktHfiWwDS-E/AAAAAAAAAAI/AAAAAAAAAOQ/G0_t8-oxgpg/photo.jpg?sz=128", "display_name": "\u0412\u043b\u0430\u0434 \u0414\u0430\u0440\u044c\u0435\u0432", "link": "https://stackoverflow.com/users/5982102/%d0%92%d0%bb%d0%b0%d0%b4-%d0%94%d0%b0%d1%80%d1%8c%d0%b5%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 971, "favorite_count": 0, "accepted_answer_id": 35905270, "answer_count": 1, "score": 0, "last_activity_date": 1457569040, "creation_date": 1457565286, "question_id": 35904565, "link": "https://stackoverflow.com/questions/35904565/golang-websocket-detecting-file-message-and-writing-it-if-more-than-1-ws-frame-b", "title": "Golang Websocket detecting file message and writing it if more than 1 ws frame byte", "body": "<p>I need to save each new picture in one file, which is sent by several frames through websockets. Here is code of my file:</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"golang.org/x/net/websocket\"\n\"log\"\n\"net/http\"\n\"os\"\n\"time\"\n)\n\nvar (\ndirPath string\ntest    byte\nlenFile int\n)\n\nfunc check(e error) {\nif e != nil {\n    panic(e)\n}\n}\n\nfunc ChatServer(ws *websocket.Conn) {   \ndefer ws.Close()\nvar test []byte\nvar payload []byte\nfor {\n    err := websocket.Message.Receive(ws, &amp;payload)\n    if err != nil {\n        log.Println(err)\n    }\n\n    fmt.Println(\"Payload: \", len(payload))\n\n    test = append(test, payload...)\n    fmt.Println(\"Test: \", len(test))\n\n    fo, err := os.Create(fmt.Sprintf(\"./%d.png\", time.Now().UnixNano()))\n    check(err)\n    _, err = fo.Write(test)\n    check(err)\n    fo.Close()\n}\n log.Print(\"DONE\")\n\n}\n\nfunc main() {\nif len(os.Args) &lt; 2 {\n    log.Fatal(\"Usage: chatExample &lt;dir&gt;\")\n}\n\ndirPath = os.Args[1]\n\nfmt.Println(\"Starting... \")\n\nhttp.Handle(\"/\", http.FileServer(http.Dir(dirPath)))\nhttp.Handle(\"/ws\", websocket.Handler(ChatServer))\n\nerr := http.ListenAndServe(\":3000\", nil)\n\nif err != nil {\n    log.Fatal(\"ListenAndServe \", err)\n}\n}\n</code></pre>\n\n<p>And here is my results of downloading two files in order:</p>\n\n<p><a href=\"https://i.stack.imgur.com/QaTzk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QaTzk.png\" alt=\"Console logging of bytes every ws frame\"></a>\n<a href=\"https://i.stack.imgur.com/9Qzz4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9Qzz4.png\" alt=\"Two images that I sent\"></a>\n<a href=\"https://i.stack.imgur.com/LHrbL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LHrbL.png\" alt=\"Result in filesystem catalog\"></a>\nSo I need save only two files (images) if I send two files, not three. Also I need to save two different files, I have to somehow detect new file from websocket connect.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 7, "last_activity_date": 1457565512, "last_edit_date": 1457565512, "creation_date": 1457562066, "answer_id": 35903856, "question_id": 35903780, "link": "https://stackoverflow.com/questions/35903780/why-does-go-think-i-am-not-using-declared-variable/35903856#35903856", "title": "Why does Go think I am not using declared variable?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Blocks\" rel=\"nofollow\">Blocks</a></p>\n  \n  <p>A block is a possibly empty sequence of declarations and statements\n  within matching brace brackets.</p>\n\n<pre><code>Block = \"{\" StatementList \"}\" .\nStatementList = { Statement \";\" } .\n</code></pre>\n  \n  <p>In addition to explicit blocks in the source code, there are implicit\n  blocks:</p>\n  \n  <ul>\n  <li><p>The universe block encompasses all Go source text.</p></li>\n  <li><p>Each package has a package block containing all Go source text for that package.</p></li>\n  <li><p>Each file has a file block containing all Go source text in that file.</p></li>\n  <li><p>Each \"if\", \"for\", and \"switch\" statement is considered to be in its own implicit block.</p></li>\n  <li><p>Each clause in a \"switch\" or \"select\" statement acts as an implicit block.</p></li>\n  </ul>\n  \n  <p>Blocks nest and influence scoping.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow\">Declarations and scope</a></p>\n  \n  <p>A declaration binds a non-blank identifier to a constant, type,\n  variable, function, label, or package. Every identifier in a program\n  must be declared. No identifier may be declared twice in the same\n  block, and no identifier may be declared in both the file and package\n  block.</p>\n  \n  <p>The blank identifier may be used like any other identifier in a\n  declaration, but it does not introduce a binding and thus is not\n  declared. In the package block, the identifier init may only be used\n  for init function declarations, and like the blank identifier it does\n  not introduce a new binding.</p>\n\n<pre><code>Declaration   = ConstDecl | TypeDecl | VarDecl .\nTopLevelDecl  = Declaration | FunctionDecl | MethodDecl .\n</code></pre>\n  \n  <p>The scope of a declared identifier is the extent of source text in\n  which the identifier denotes the specified constant, type, variable,\n  function, label, or package.</p>\n  \n  <p>Go is lexically scoped using blocks:</p>\n  \n  <ul>\n  <li>The scope of a predeclared identifier is the universe block.</li>\n  <li>The scope of an identifier denoting a constant, type, variable, or function (but not method) declared at top level (outside any function)\n  is the package block.</li>\n  <li>The scope of the package name of an imported package is the file block of the file containing the import declaration.</li>\n  <li>The scope of an identifier denoting a method receiver, function parameter, or result variable is the function body.</li>\n  <li>The scope of a constant or variable identifier declared inside a function begins at the end of the ConstSpec or VarSpec (ShortVarDecl\n  for short variable declarations) and ends at the end of the innermost\n  containing block.</li>\n  <li>The scope of a type identifier declared inside a function begins at the identifier in the TypeSpec and ends at the end of the innermost\n  containing block.</li>\n  </ul>\n  \n  <p>An identifier declared in a block may be redeclared in an inner block.\n  While the identifier of the inner declaration is in scope, it denotes\n  the entity declared by the inner declaration.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow\">Short variable declarations</a></p>\n  \n  <p>A short variable declaration uses the syntax:</p>\n\n<pre><code>ShortVarDecl = IdentifierList \":=\" ExpressionList .\n</code></pre>\n  \n  <p>It is shorthand for a regular variable declaration with initializer\n  expressions but no types:</p>\n\n<pre><code>\"var\" IdentifierList = ExpressionList .\n</code></pre>\n  \n  <p>Short variable declarations may appear only inside functions. In some\n  contexts such as the initializers for \"if\", \"for\", or \"switch\"\n  statements, they can be used to declare local temporary variables.</p>\n</blockquote>\n\n<p>Each \"if\", \"for\", and \"switch\" statement is considered to be in its own implicit block.</p>\n\n<p>An identifier declared in a block may be redeclared in an inner block. While the identifier of the inner declaration is in scope, it denotes the entity declared by the inner declaration. </p>\n\n<p>In some contexts such as the initializers for \"if\", \"for\", or \"switch\" statements, short variable declarations can be used to declare local temporary variables.</p>\n\n<pre><code>if !grpExists {\n    vpcGrp, err := createDbSecurityGrp(grpName, vpcId, region)\n    if err != nil {\n        log.Error(err)\n        return nil, err\n    }\n}\n</code></pre>\n\n<p><code>vpcGrp</code>  is a local variable that is set but not read; it's not used. <code>err</code> is a local variable that is both set and read; it's used.</p>\n\n<p>Since <code>vpcGrp</code> and <code>err</code> have already been declared in an outer scope, try</p>\n\n<pre><code> vpcGrp, err = createDbSecurityGrp(grpName, vpcId, region)\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 5737452, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/17e1cbf59bde9523ef8a433fbe774cad?s=128&d=identicon&r=PG&f=1", "display_name": "desi Joe", "link": "https://stackoverflow.com/users/5737452/desi-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1457565512, "creation_date": 1457561794, "last_edit_date": 1457564010, "question_id": 35903780, "link": "https://stackoverflow.com/questions/35903780/why-does-go-think-i-am-not-using-declared-variable", "title": "Why does Go think I am not using declared variable?", "body": "<p>I am new to Go and wondering why does Go think I am not using vpcGrp? How would you code this?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>var vpcGrp *ec2.SecurityGroup\ngrpExists := false\nresp, err := svc.DescribeSecurityGroups(params)\nif err != nil {\n    log.Error(err)\n} else {\n    for _, v := range resp.SecurityGroups {\n        if *v.GroupName == grpName {\n            log.Debug(\"VPC Security Group Found [\", grpName, \"]\")\n            vpcGrp = v\n            grpExists = true\n        }\n    }\n}\n\nif !grpExists {\n    vpcGrp, err := createDbSecurityGrp(grpName, vpcId, region)\n    if err != nil {\n        log.Error(err)\n        return nil, err\n    }\n}\n\nreturn vpcGrp, nil\n</code></pre>\n"}, {"tags": ["go", "ubuntu-14.04", "supervisord"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1457561545, "post_id": 35902235, "comment_id": 59467739, "body": "Possibly <a href=\"http://stackoverflow.com/questions/27933477/supervisor-open-file-limit-wont-change-when-using-chef\">minfds</a> setting?"}, {"owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1457627565, "post_id": 35902235, "comment_id": 59502444, "body": "@Mark referring to supervisor setting? Hadn&#39;t thought of thought, will try"}, {"owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1457628768, "post_id": 35902235, "comment_id": 59503284, "body": "I went ahead and updated the supervisor conf to put that in but when I check the files for the process still doesnt show updated amount"}, {"owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1457651857, "post_id": 35902235, "comment_id": 59516969, "body": "@Mark that ended up working if you want to post a solution so I can credit you"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1457690341, "post_id": 35902235, "comment_id": 59530711, "body": "Thanks @nadermx, just glad your issue is solved, go ahead and answer if you like. Sounds like there was a bit more going on there than just the setting change."}], "answers": [{"comments": [{"owner": {"reputation": 755, "user_id": 4029966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8223f9015bf5db940b3f36e067ca9386?s=128&d=identicon&r=PG", "display_name": "Sid", "link": "https://stackoverflow.com/users/4029966/sid"}, "edited": false, "score": 0, "creation_date": 1558005962, "post_id": 35952450, "comment_id": 98961455, "body": "where to set that minfds number"}], "tags": [], "owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "is_accepted": true, "score": 3, "last_activity_date": 1457744252, "creation_date": 1457744252, "answer_id": 35952450, "question_id": 35902235, "link": "https://stackoverflow.com/questions/35902235/increase-open-files-limit-for-process/35952450#35952450", "title": "Increase open files limit for process", "body": "<p>After trying to resolve this issue in multiple questions, got it down to the fact that supervisor set's its own file limit on the program.  As seen in the comments, you have to use <code>minfds</code> setting in supervisor.</p>\n\n<p>To check to see if it is working you can run a <code>cat /proc/$PID/limits</code></p>\n\n<p>Which should output the number you set <code>minfds</code> too, in my case 100,000</p>\n\n<pre><code>Max open files            100000               100000               files     \n</code></pre>\n\n<p>I would like to note that when you go and put into supervisor the <code>minfds</code> you put it in the <code>/etc/supervisor/supervisord.conf</code> as if you put in your programs config file it will do nothing.</p>\n"}], "owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2566, "favorite_count": 0, "accepted_answer_id": 35952450, "answer_count": 1, "score": 2, "last_activity_date": 1565720847, "creation_date": 1457556381, "last_edit_date": 1565720847, "question_id": 35902235, "link": "https://stackoverflow.com/questions/35902235/increase-open-files-limit-for-process", "title": "Increase open files limit for process", "body": "<p>When I run <code>ulimit -n</code> I get <code>100000</code> as the value.</p>\n\n<p>I have edited the Added following lines in <code>/etc/security/limits.conf</code> </p>\n\n<pre><code>*     soft    nofile          100000\n*     hard    nofile          100000\n</code></pre>\n\n<p>I have also edited the <code>pan_limits</code></p>\n\n<p>But I am currently running a go program that keeps throwing out the error </p>\n\n<pre><code>2016/03/09 21:42:27 http: Accept error: accept tcp [::]:3000: accept4: too many open files; retrying in 5ms\n2016/03/09 21:42:27 getAudioOnlyInfo: open /dev/null: too many open files\n</code></pre>\n\n<p>The issue is that when I actually check to see the limits set on the actual process by running <code>cat /proc/1480/limits</code> I see this </p>\n\n<pre><code>Max open files            1024                 4096                 files   \n</code></pre>\n\n<p>I'm running a golang program through supervisor is there a reason it wouldn't be reading the system limits?</p>\n"}, {"tags": ["go", "tcp", "irc"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1457552802, "post_id": 35901052, "comment_id": 59462764, "body": "What is the error that you discard here? <code>line, err := tp.ReadLine(); if err != nil { break };</code>"}, {"owner": {"reputation": 1282, "user_id": 3648229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6b730f6984c01d9409a83abacb234580?s=128&d=identicon&r=PG", "display_name": "gempir", "link": "https://stackoverflow.com/users/3648229/gempir"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1457553133, "post_id": 35901052, "comment_id": 59462971, "body": "oh well that was stupid of me to not log. thanks."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1457555446, "creation_date": 1457555446, "answer_id": 35901943, "question_id": 35901052, "link": "https://stackoverflow.com/questions/35901052/how-to-analyze-go-golang-crash-logs/35901943#35901943", "title": "How to analyze Go (golang) crash logs", "body": "<p>If you follow the stack trace, you can see that, as expected, you are polling a network (TCP connection). Networks are fragile; you must expect errors and handle them gracefully.</p>\n\n<pre><code>reader := bufio.NewReader(conn)\ntp := textproto.NewReader(reader)\nfor {\n    line, err := tp.ReadLine()\n    if err != nil {\n        break // break loop on errors\n    }\n    // do stuff\n}\n</code></pre>\n\n<p>If an error occurs here</p>\n\n<pre><code>line, err := tp.ReadLine()\n</code></pre>\n\n<p>you discard it</p>\n\n<pre><code>    if err != nil {\n        break // break loop on errors\n    }\n</code></pre>\n\n<p>and keep going, pretending nothing happened</p>\n\n<pre><code>for {\n    line, err := tp.ReadLine()\n    if err != nil {\n        break // break loop on errors\n    }\n    // do stuff\n}\n</code></pre>\n\n<p>On the next </p>\n\n<pre><code>line, err := tp.ReadLine()\n</code></pre>\n\n<p>after an error, the results are undefined.</p>\n"}], "owner": {"reputation": 1282, "user_id": 3648229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6b730f6984c01d9409a83abacb234580?s=128&d=identicon&r=PG", "display_name": "gempir", "link": "https://stackoverflow.com/users/3648229/gempir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 754, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1457555446, "creation_date": 1457552335, "question_id": 35901052, "link": "https://stackoverflow.com/questions/35901052/how-to-analyze-go-golang-crash-logs", "title": "How to analyze Go (golang) crash logs", "body": "<p>So my application crashed and I can't for the life of me figure out what the problem is only from the error messages. Because it ran for hours fine.</p>\n\n<p>this is the error</p>\n\n<pre><code>(err): net.(*pollDesc).WaitRead(0xc20802ac30, 0x0, 0x0)\n(err):     /usr/lib/go/src/pkg/net/fd_poll_runtime.go:89 +0x42\n(err): net.(*netFD).Read(0xc20802abd0, 0xc208083000, 0x1000, 0x1000, 0x0, 0x7fab4f8082b8, 0xb)\n(err):     /usr/lib/go/src/pkg/net/fd_unix.go:242 +0x34c\n(err): net.(*conn).Read(0xc208038090, 0xc208083000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n(err):     /usr/lib/go/src/pkg/net/net.go:122 +0xe7\n(err): bufio.(*Reader).fill(0xc208004540)\n(err):     /usr/lib/go/src/pkg/bufio/bufio.go:97 +0x1b3\n(err): bufio.(*Reader).ReadSlice(0xc208004540, 0x7ffff8000000000a, 0x0, 0x0, 0x0, 0x0, 0x0)\n(err):     /usr/lib/go/src/pkg/bufio/bufio.go:298 +0x22c\n(err): bufio.(*Reader).ReadLine(0xc208004540, 0x0, 0x0, 0x0, 0x200, 0x0, 0x0)\n(err):     /usr/lib/go/src/pkg/bufio/bufio.go:326 +0x69\n(err): net/textproto.(*Reader).readLineSlice(0xc208022d50, 0x0, 0x0, 0x0, 0x0, 0x0)\n(err):     /usr/lib/go/src/pkg/net/textproto/reader.go:55 +0x9d\n(err): net/textproto.(*Reader).ReadLine(0xc208022d50, 0x0, 0x0, 0x0, 0x0)\n(err):     /usr/lib/go/src/pkg/net/textproto/reader.go:36 +0x4e\n(err): main.(*Bot).ListenToConnection(0xc208046460, 0x7fab4f809518, 0xc208038090)\n(err):     /home/gempir/gempbroker/main.go:73 +0xab\n(err): created by main.(*Bot).CreateConnection\n(err):     /home/gempir/gempbroker/main.go:106 +0x8a3\n</code></pre>\n\n<p>I found that main.go:73 which is a simple Readline reading from a TCP connection</p>\n\n<pre><code>reader := bufio.NewReader(conn)\n    tp := textproto.NewReader(reader)\n    for {\n        line, err := tp.ReadLine()\n        if err != nil {\n            break // break loop on errors\n        }\n        // do stuff\n    }\n</code></pre>\n\n<p>main.go:106 just creates a goroutine for listening to the connection</p>\n\n<pre><code>go listenToConnection(conn)\n</code></pre>\n\n<p>How do I find out what the error logs actually mean and find a solution to my problem?</p>\n"}, {"tags": ["go", "rpc", "gob"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1457572446, "post_id": 35899025, "comment_id": 59471874, "body": "<code>context.Context</code> is an interface, not a struct. You don&#39;t need to register an interface for gob to encode it. You should register the type(s) you&#39;re putting inside your context and encode those, putting them into a <i>new</i> context on the remote end."}, {"owner": {"reputation": 1162, "user_id": 1316907, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vl9Qn.jpg?s=128&g=1", "display_name": "Evan Lin", "link": "https://stackoverflow.com/users/1316907/evan-lin"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1457576055, "post_id": 35899025, "comment_id": 59472919, "body": "@elithrar Thanks, I try to use gob.Encode but it still got error on <code>gob: type not registered for interface: context.emptyCtx</code>. Any more direction how I trying to find a way to encode it?"}], "owner": {"reputation": 1162, "user_id": 1316907, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vl9Qn.jpg?s=128&g=1", "display_name": "Evan Lin", "link": "https://stackoverflow.com/users/1316907/evan-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 853, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1457576564, "creation_date": 1457546067, "last_edit_date": 1457576564, "question_id": 35899025, "link": "https://stackoverflow.com/questions/35899025/cannot-use-context-context-as-gob-rpc-call-parameter-in-golang", "title": "Cannot use context.Context as gob RPC call parameter in golang", "body": "<p>I try to write a kv-raft server code in Go. (refer this <a href=\"http://otm.github.io/2015/05/raft-a-first-implementation/\" rel=\"nofollow\">article</a>).</p>\n\n<p>However I found there is problem if I want using <code>context.Context</code> in my RPC call parameter</p>\n\n<pre><code>// Init of my RPC server\nkv := new(KVRaft)\nrpcs := rpc.NewServer()\nrpcs.Register(kv)\n....\n\n\n//My RPC call function\nfunc (kv *KVRaft) Msg(args *context.Context, reply *MsgReply) error {\n    log.Println(\"[MSG]\", *args)\n    return nil\n}\n</code></pre>\n\n<p>Code could be compiled but when I trying to run </p>\n\n<pre><code>c, _ := rpc.Dial(\"tcp\", \":1234\")\nvar reply MsgReply{}\n\nc.Call(\"KVRaft.Msg\", someContext, &amp;reply)\n</code></pre>\n\n<p>It will pop-up error as  <code>gob: type not registered for interface: context.emptyCtx</code> </p>\n\n<p>This code works well if I replace <code>*context.Context</code> to <code>*string</code>.\nI googled it could use <code>gob.Register()</code>, but I got compile failed on <code>gob.Register(context.Context{})</code>  </p>\n\n<pre><code>invalid type for composite literal: \"golang.org/x/net/context\".Context\n</code></pre>\n\n<p>Any idea how could I pass <code>context.Context</code> as gob RPC call parameter?</p>\n\n<p>[update]</p>\n\n<p>I try to use <code>gob.Register(context.Background())</code> but it will get empty context  when receive  RPC call.</p>\n\n<p>[update]\nCurrently my <a href=\"https://github.com/kkdai/rs\" rel=\"nofollow\">repo</a> here, but still ongoing.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 0, "creation_date": 1457543358, "post_id": 35897929, "comment_id": 59456672, "body": "What&#39;s the value of <code>GOMAXPROCS</code>?"}, {"owner": {"reputation": 71, "user_id": 5613532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7fcfda0f73fa7a2fc20924a755b7356?s=128&d=identicon&r=PG&f=1", "display_name": "Tesseract", "link": "https://stackoverflow.com/users/5613532/tesseract"}, "reply_to_user": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 0, "creation_date": 1457544376, "post_id": 35897929, "comment_id": 59457401, "body": "It&#39;s set to NumCPU() - 1. So in our case it&#39;s going to 7 (8 core machine)."}, {"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 0, "creation_date": 1457548849, "post_id": 35897929, "comment_id": 59460287, "body": "are you noticing the delay after the first few requests ? or right from the beginning when the server is started ? it would be useful to know the number of goroutines when each request is serviced in the handler using <code>runtime.NumGoroutine()</code>"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1457550098, "post_id": 35897929, "comment_id": 59461120, "body": "What&#39;s your <code>go version</code>?"}, {"owner": {"reputation": 71, "user_id": 5613532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7fcfda0f73fa7a2fc20924a755b7356?s=128&d=identicon&r=PG&f=1", "display_name": "Tesseract", "link": "https://stackoverflow.com/users/5613532/tesseract"}, "edited": false, "score": 0, "creation_date": 1457555348, "post_id": 35897929, "comment_id": 59464253, "body": "We are using GO 1.4 but have the same issue with another server that&#39;s on GO 1.5."}, {"owner": {"reputation": 71, "user_id": 5613532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7fcfda0f73fa7a2fc20924a755b7356?s=128&d=identicon&r=PG&f=1", "display_name": "Tesseract", "link": "https://stackoverflow.com/users/5613532/tesseract"}, "reply_to_user": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 0, "creation_date": 1457555564, "post_id": 35897929, "comment_id": 59464393, "body": "@algrebe It&#39;s from the start. The number of goroutine is fairly high (~2k) since we handle around 8-10k requests per second and we few routines running in background for updates."}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1457556229, "post_id": 35897929, "comment_id": 59464780, "body": "what is your fd limit?"}, {"owner": {"reputation": 71, "user_id": 5613532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7fcfda0f73fa7a2fc20924a755b7356?s=128&d=identicon&r=PG&f=1", "display_name": "Tesseract", "link": "https://stackoverflow.com/users/5613532/tesseract"}, "reply_to_user": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1457556442, "post_id": 35897929, "comment_id": 59464891, "body": "@jmaloney 200k for both"}, {"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 1, "creation_date": 1457598604, "post_id": 35897929, "comment_id": 59481398, "body": "@Tesseract if the only thing that has changed is the addition of <code>go doAnalysis(val)</code> then could you try initializing around N <code>doAnalysisWorkers</code> that accept the val through a channel and do the analysis. Then the handler can write to the channel instead ( avoids the little goroutine creation overhead ). You can play around with the channel buffer size to prevent blocking (which will keep the handler routine active), but expect an increase in ram usage"}, {"owner": {"reputation": 71, "user_id": 5613532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7fcfda0f73fa7a2fc20924a755b7356?s=128&d=identicon&r=PG&f=1", "display_name": "Tesseract", "link": "https://stackoverflow.com/users/5613532/tesseract"}, "reply_to_user": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 0, "creation_date": 1457618644, "post_id": 35897929, "comment_id": 59495609, "body": "@algrebe thanks for the suggestion. I was planing on doing that, but I was curious to know why the current implementation has increased response time even though it should spawn off an independent routine."}, {"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 0, "creation_date": 1457634697, "post_id": 35897929, "comment_id": 59507284, "body": "@Tesseract I was suggesting the implementation also as a test to figure out if the response time gets better as a result of lesser goroutines. While goroutines are very light weight, at scale, even lightweight things take their toll. Every request spawns a goroutine to handle it, and on top of that, another goroutine is spawned for each. This will have a crazy amount of goroutine. Given that true parallelism depends on the cores, there is bound to be some wait even though we think of it as an independent routine."}], "owner": {"reputation": 71, "user_id": 5613532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7fcfda0f73fa7a2fc20924a755b7356?s=128&d=identicon&r=PG&f=1", "display_name": "Tesseract", "link": "https://stackoverflow.com/users/5613532/tesseract"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1457542902, "creation_date": 1457542902, "question_id": 35897929, "link": "https://stackoverflow.com/questions/35897929/golang-high-timeout-for-server", "title": "Golang high timeout for server", "body": "<p>We have a simple http server that responds to POST requests. Normally it's running without any issues, but recently we decided to add in additional component for request analysis. </p>\n\n<p>Currently it's as follows:</p>\n\n<pre><code>func handleRequest(response http.ResponseWriter, request *http.Request) {\n    if request.Method != \"POST\" {\n        response.Write([]byte(\"Only POST\"))\n        return\n    }\n\n    body, err := ioutil.ReadAll(request.Body)\n    request.Body.Close()\n\n    val := generateResponse(body)\n    response.Write(val)\n}\n</code></pre>\n\n<p>Normally the response time for this is around 40-50ms. Server usage at around 25%-30%.</p>\n\n<p>With analysis tool added, the response time somehow increases even though it's on a separate routine. </p>\n\n<pre><code>func handleRequest(response http.ResponseWriter, request *http.Request) {\n    if request.Method != \"POST\" {\n        response.Write([]byte(\"Only POST\"))\n        return\n    }\n\n    body, err := ioutil.ReadAll(request.Body)\n    request.Body.Close()\n\n    val := generateResponse(body)\n    response.Write(val)\n    go doAnalysis(val)\n}\n</code></pre>\n\n<p>Server usage is slightly higher at around 35%-40% due to additional processing. The response time is around 70-90ms now. Shouldn't spawning off a go-routine result in similar response time since response is written already? </p>\n"}, {"tags": ["postgresql", "go"], "answers": [{"comments": [{"owner": {"reputation": 2269, "user_id": 3016716, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wCaTR.jpg?s=128&g=1", "display_name": "shivams", "link": "https://stackoverflow.com/users/3016716/shivams"}, "edited": false, "score": 0, "creation_date": 1457546186, "post_id": 35897298, "comment_id": 59458634, "body": "Thanks. It was a go noob mistake :P"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1457541176, "creation_date": 1457541176, "answer_id": 35897298, "question_id": 35897251, "link": "https://stackoverflow.com/questions/35897251/cannot-return-database-object/35897298#35897298", "title": "Cannot return database object.", "body": "<p>Your database is closed the moment you return from <code>Create</code> because your defer is inside it and not inside <code>main</code>. Move the defer to main and it should work as intended.</p>\n"}], "owner": {"reputation": 2269, "user_id": 3016716, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wCaTR.jpg?s=128&g=1", "display_name": "shivams", "link": "https://stackoverflow.com/users/3016716/shivams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 35897298, "answer_count": 1, "score": 0, "last_activity_date": 1457541176, "creation_date": 1457541058, "question_id": 35897251, "link": "https://stackoverflow.com/questions/35897251/cannot-return-database-object", "title": "Cannot return database object.", "body": "<p>This is my code for working with postgres database. </p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    _ \"github.com/lib/pq\"\n    \"fmt\"\n    \"log\"\n)\n\n//Details required for connection\nconst (\n    HOST     = \"HOSTNAME\"\n    USER     = \"USER\"\n    PASSWORD = \"PASSWORD\"\n    DATABASE = \"DB\"\n)\n\nfunc Create() (*sql.DB) {\n\n    dbinfo := fmt.Sprintf(\"host=%s user=%s password=%s dbname=%s\", HOST, USER, PASSWORD, DATABASE)\n    db,err  := sql.Open(\"postgres\", dbinfo)\n    defer db.Close()\n\n    if (err != nil) {\n        log.Fatal(err)\n    }\n\n    err = db.Ping()\n\n    if err != nil {\n      log.Fatal(err)\n    }\n\n    return db\n}\n\n\nfunc main() {\n    db := Create()\n    querStmt, err := db.Prepare(\"select count(*) from table\")\n\n    if err != nil {\n        fmt.Printf(\"Cannot prepare query\\n\")\n        log.Fatal(err)\n    }\n    res, err := querStmt.Exec()\n    if err != nil {\n        fmt.Printf(\"Cannot execute query\\n\")\n        log.Fatal(err)\n    }\n\n    fmt.Printf(\"%v\\n\", res)\n}\n</code></pre>\n\n<p>When running this code i am getting this error </p>\n\n<pre><code>Cannot prepare query\n2016/03/09 16:57:23 sql: database is closed\n</code></pre>\n\n<p>If i run query from <code>Create()</code> then it works perfectly but doing same on db object returned by <code>Create()</code> inside <code>main()</code> is not working. Thanks for help.  </p>\n"}, {"tags": ["go", "activemq", "stomp"], "answers": [{"comments": [{"owner": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "edited": false, "score": 0, "creation_date": 1457543693, "post_id": 35897813, "comment_id": 59456921, "body": "ActiveMQ has a failover concept.  <a href=\"http://activemq.apache.org/nms/stomp-uri-configuration.html\" rel=\"nofollow noreferrer\">activemq.apache.org/nms/stomp-uri-configuration.html</a>. I used the URI I mentioned in the question for a Java ActiveMQ client and it works perfect. Trying the same in Go client. But I did not find a reference to use failover protocol in Go-Stomp. Either its not supported or I might be using it the wrong way"}, {"owner": {"reputation": 200, "user_id": 6040694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a194f101db85d5b94cb0cd87f32edf3f?s=128&d=identicon&r=PG&f=1", "display_name": "animal", "link": "https://stackoverflow.com/users/6040694/animal"}, "reply_to_user": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "edited": false, "score": 0, "creation_date": 1457545271, "post_id": 35897813, "comment_id": 59458016, "body": "NMS is a stomp client. It does support failover syntax. The stomp protocol nor the go-stomp library provide this facility."}], "tags": [], "owner": {"reputation": 200, "user_id": 6040694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a194f101db85d5b94cb0cd87f32edf3f?s=128&d=identicon&r=PG&f=1", "display_name": "animal", "link": "https://stackoverflow.com/users/6040694/animal"}, "is_accepted": false, "score": 0, "last_activity_date": 1457542588, "creation_date": 1457542588, "answer_id": 35897813, "question_id": 35896944, "link": "https://stackoverflow.com/questions/35896944/failover-uri-for-activemq-in-go-stomp-client/35897813#35897813", "title": "failover URI for ActiveMQ in go stomp client", "body": "<p>What is the err you are receiving?\nI do not believe the format of your Dial is correct:\nThe Go-Stomp Dial uses the underlying net.Dial</p>\n\n<p>func Dial(network, addr string, opts ...func(*Conn) error) (*Conn, error) {</p>\n\n<p>c, err := net.Dial(network, addr)</p>\n\n<p>The underlying net.Dial documentation states</p>\n\n<p>For TCP and UDP networks, addresses have the form host:port. If host is a literal IPv6 address it must be enclosed in square brackets as in \"[::1]:80\" or \"[ipv6-host%zone]:80\". The functions JoinHostPort and SplitHostPort manipulate addresses in this form. If the host is empty, as in \":80\", the local system is assumed.</p>\n\n<p>There is no failover: syntax</p>\n"}, {"tags": [], "owner": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "is_accepted": true, "score": 1, "last_activity_date": 1457644566, "creation_date": 1457644566, "answer_id": 35927449, "question_id": 35896944, "link": "https://stackoverflow.com/questions/35896944/failover-uri-for-activemq-in-go-stomp-client/35927449#35927449", "title": "failover URI for ActiveMQ in go stomp client", "body": "<p>Due to lack of support for failover, had to write some code to achieve the desired result.</p>\n\n\n\n<pre><code>//connect to ActiveMQ using failover approach\n    var err error\n    for _, uri := range [\"10.01.02.03:61613\",\"10.04.05.06:61613\", {\n        if err = connect(uri); err == nil {\n            break\n        }\n    }\n    if conn == nil {\n        panic(fmt.Sprintf(\"Could not connect to ActiveMQ using brokerUri. Can not continue.\"))\n    }\n\nfunc connect(brokerIp string) (err error) {\n    log.Printf(\"Attempting to connect to ActiveMQ node %v\", brokerIp)\n    if conn, err = stomp.Dial(\"tcp\",\n        brokerIp,\n        stomp.ConnOpt.Login(Broker.User, Broker.Password)); err != nil {\n        log.Printf(\"Faild to connect to ActiveMQ using %v\", brokerIp)\n    }\n    if err == nil {\n        log.Printf(\"Successfully connected to ActiveMQ node %v\", brokerIp)\n    }\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1202, "favorite_count": 0, "accepted_answer_id": 35927449, "answer_count": 2, "score": 0, "last_activity_date": 1457644566, "creation_date": 1457540287, "question_id": 35896944, "link": "https://stackoverflow.com/questions/35896944/failover-uri-for-activemq-in-go-stomp-client", "title": "failover URI for ActiveMQ in go stomp client", "body": "<p>How do we connect to ActiveMQ using failover stomp connection URI in Go?\nUsing <a href=\"http://github.com/go-stomp/stomp\" rel=\"nofollow\">Go-Stomp</a> client, I tried below code and it fails to connect.</p>\n\n<pre><code>if conn, err = stomp.Dial(\"tcp\", \"failover:(tcp://10.01.02.03:61613,tcp://10.04.05.06:61613)?startupMaxReconnectAttempts=2\"); err != nil {\n        panic(fmt.Sprintf(\"Could not connect to ActiveMQ using brokerUri %v. Can not continue.\", Config.Broker.URI))\n    }\n</code></pre>\n"}, {"tags": ["go", "gofmt"], "answers": [{"comments": [{"owner": {"reputation": 574, "user_id": 1652623, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AbSax.jpg?s=128&g=1", "display_name": "Airomega", "link": "https://stackoverflow.com/users/1652623/airomega"}, "edited": false, "score": 0, "creation_date": 1457539591, "post_id": 35896405, "comment_id": 59454005, "body": "Fantastic! Thanks for your help. I was looking in the wrong package :D"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 574, "user_id": 1652623, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AbSax.jpg?s=128&g=1", "display_name": "Airomega", "link": "https://stackoverflow.com/users/1652623/airomega"}, "edited": false, "score": 1, "creation_date": 1457539762, "post_id": 35896405, "comment_id": 59454133, "body": "@Airomega No problem. Honestly, I&#39;m kinda surprised there seems to be no way of getting this result with <code>fmt</code>."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1457538929, "creation_date": 1457538929, "answer_id": 35896405, "question_id": 35896054, "link": "https://stackoverflow.com/questions/35896054/go-fmt-float64-issue/35896405#35896405", "title": "Go fmt float64 issue", "body": "<p>You can use <a href=\"https://golang.org/pkg/strconv/#FormatFloat\" rel=\"nofollow\"><code>strconv.FormatFloat</code></a> with prec set to -1:</p>\n\n<pre><code>fmt.Println(strconv.FormatFloat(big, 'f', -1, 64))\nfmt.Println(strconv.FormatFloat(small, 'f', -1, 64))\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>123456789000\n0.123456789\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/7p8xnQ_BzE\" rel=\"nofollow\">http://play.golang.org/p/7p8xnQ_BzE</a>.</p>\n"}], "owner": {"reputation": 574, "user_id": 1652623, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AbSax.jpg?s=128&g=1", "display_name": "Airomega", "link": "https://stackoverflow.com/users/1652623/airomega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1902, "favorite_count": 0, "accepted_answer_id": 35896405, "answer_count": 1, "score": 2, "last_activity_date": 1457538929, "creation_date": 1457537959, "last_edit_date": 1457538606, "question_id": 35896054, "link": "https://stackoverflow.com/questions/35896054/go-fmt-float64-issue", "title": "Go fmt float64 issue", "body": "<p>I've come across a bit of a gotcha in my noob understanding of go fmt package</p>\n\n<p>It relates to the following code:</p>\n\n<p>import \"fmt\"</p>\n\n<pre><code>func main() {\n    var smallFloat float64 = 0.123456789\n    var bigFloat float64 = 123456789000\n\n    fmt.Println(fmt.Sprintf(\"%f\", smallFloat))\n    fmt.Println(fmt.Sprintf(\"%f\", bigFloat))\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>0.123457\n123456789000.000000\n</code></pre>\n\n<p>I don't want to use scientific notation so thought %f would suit my needs.I can see from the formatting page (<a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow\">https://golang.org/pkg/fmt/</a>) it says:</p>\n\n<pre><code>The default precision for %e and %f is 6; for %g it is the smallest number of digits necessary to identify the value uniquely.\n</code></pre>\n\n<p>Is there a way I can use the fmt package that would allow me represent the full decimal value of smallFloat while at the same time not appending 6 zeros to the end of bigFloat?  </p>\n"}, {"tags": ["http", "go", "dns", "webserver", "multisite"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 3, "creation_date": 1457535883, "post_id": 35894894, "comment_id": 59450957, "body": "If they are the same program, then you have to recompile on change. The alternative is to use nginx as a reverse proxy to proxy to multiple Go programs (each handling a site/service) or something like Caddy (<a href=\"https://caddyserver.com/\" rel=\"nofollow noreferrer\">caddyserver.com</a>) to achieve the same."}], "answers": [{"comments": [{"owner": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "edited": false, "score": 1, "creation_date": 1457647590, "post_id": 35895356, "comment_id": 59515111, "body": "Thank you Elwinar and @Elithrar. &quot;Reverse proxy&quot; is the function I need to learn. (I didn&#39;t know if that kind exists; as I am not a professional software developer, but a hobbyist without any formal education on CS) I have found many libraries besides what you guys mentioned as well. That are plenty for me to study :) Again thank you both! Have a good one."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 1, "last_activity_date": 1457536606, "last_edit_date": 1457536606, "creation_date": 1457536248, "answer_id": 35895356, "question_id": 35894894, "link": "https://stackoverflow.com/questions/35894894/serving-two-websites-written-in-google-go-within-a-single-vm/35895356#35895356", "title": "Serving two websites written in Google Go within a single VM", "body": "<p>Well, you can do hotswapping in go, but I really wouldn't want to do that unless really ncecessary as the complexity added isn't negligible (and I'm not talking about code).</p>\n\n<p>You can have something close with a kind of proxy that would sit in front of the program and do a graceful swap whenever your binary change : the principle is to have the binary on one port, the proxy on another. When a new binary is ready, you run it on another port, and make the proxy redirect to the new port, then gracefully shutdown the old one.</p>\n\n<p>There was a tool for that in Go that I can't remember the name of\u2026</p>\n\n<p><strong>EDIT</strong>: not the one I had in mind, but close call <a href=\"https://github.com/rcrowley/goagain\" rel=\"nofollow\">https://github.com/rcrowley/goagain</a></p>\n\n<p><em>Personnal advice</em>: use a reverse proxy for that, its much more simple to do. My personnal setup is to use h2o to terminate SSL, HTTP2, etc, and send the requests to the various websites running on the background. Not only Go ones, though, but also PHP ones, a Gitlab instance, etc. Its much more flexible, and the performance penalty of the proxy is small\u2026</p>\n"}], "owner": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 35895356, "answer_count": 1, "score": 1, "last_activity_date": 1457536606, "creation_date": 1457535080, "question_id": 35894894, "link": "https://stackoverflow.com/questions/35894894/serving-two-websites-written-in-google-go-within-a-single-vm", "title": "Serving two websites written in Google Go within a single VM", "body": "<p>I have a VM from Digital Ocean. It currently has two domains linked to the VM.\nI do not use any other web server but Golang's built in http module. Performance-wise I like it, and I feel like I have a full control over it. </p>\n\n<p>Currently I am using a single Go program that has multiple websites built in.</p>\n\n<pre><code>http.HandleFunc(\"test.com/\", serveTest)\nhttp.HandleFunc(\"123.com/\", serve123)\nhttp.HandleFunc(\"/\", serve123)\n</code></pre>\n\n<p>As they are websites, Go program is using port 80 for that.\nAnd the problem is when I am trying to update only 1 website, I have to recompile whole thing as they are written in the same code. </p>\n\n<p>1) Is there a way to make it hot-swappable only with Golang (without Nginx or Apache)\n2) What would be a standard best practice?</p>\n\n<p>Thank you so much!</p>\n"}, {"tags": ["go", "static"], "comments": [{"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 1, "creation_date": 1457522916, "post_id": 35890248, "comment_id": 59441466, "body": "This is how your folder for serving static files is defined."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1457542990, "post_id": 35890248, "comment_id": 59456411, "body": "Replace &quot;/static/&quot; with &quot;/&quot; and see whether your question goes away."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1457543069, "post_id": 35890248, "comment_id": 59456472, "body": "Alternatively you could read the godoc for the http package, which I would advise anyway."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 4459280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86f5cb85c526dd8e14b2ff09265a934e?s=128&d=identicon&r=PG&f=1", "display_name": "David Rojko", "link": "https://stackoverflow.com/users/4459280/david-rojko"}, "edited": false, "score": 0, "creation_date": 1457524256, "post_id": 35890557, "comment_id": 59442516, "body": "But where is this /static/. Is it in my project file or where?"}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 7, "user_id": 4459280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86f5cb85c526dd8e14b2ff09265a934e?s=128&d=identicon&r=PG&f=1", "display_name": "David Rojko", "link": "https://stackoverflow.com/users/4459280/david-rojko"}, "edited": false, "score": 0, "creation_date": 1457528825, "post_id": 35890557, "comment_id": 59445716, "body": "Its the physical directory on your machine\u2026"}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": 1, "last_activity_date": 1457523474, "creation_date": 1457523474, "answer_id": 35890557, "question_id": 35890248, "link": "https://stackoverflow.com/questions/35890248/what-does-static-mean-in-this-code/35890557#35890557", "title": "What does /static/ mean in this code?", "body": "<p>Here, <code>/static/</code> is the path to the directory that will be used to serve the requests.</p>\n\n<p>Depending on your setup, you proabably want to set it to a relative path instead of an absolute one\u2026</p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 4459280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86f5cb85c526dd8e14b2ff09265a934e?s=128&d=identicon&r=PG&f=1", "display_name": "David Rojko", "link": "https://stackoverflow.com/users/4459280/david-rojko"}, "edited": false, "score": 0, "creation_date": 1457524561, "post_id": 35890746, "comment_id": 59442714, "body": "And where is this operating system /static/ directory in ubuntu?"}, {"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "reply_to_user": {"reputation": 7, "user_id": 4459280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86f5cb85c526dd8e14b2ff09265a934e?s=128&d=identicon&r=PG&f=1", "display_name": "David Rojko", "link": "https://stackoverflow.com/users/4459280/david-rojko"}, "edited": false, "score": 0, "creation_date": 1457526640, "post_id": 35890746, "comment_id": 59444147, "body": "Are you sure you are not using relative paths?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1457533019, "post_id": 35890746, "comment_id": 59448738, "body": "@SimoEndre The literal <code>&#47;static&#47;</code> is the URL that your Go application will serve files. Those files come from (using the above answer) <code>&#47;your&#47;directory&#47;to&#47;static&#47;files</code> - that is, anywhere you&#39;d like."}, {"owner": {"reputation": 7, "user_id": 4459280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86f5cb85c526dd8e14b2ff09265a934e?s=128&d=identicon&r=PG&f=1", "display_name": "David Rojko", "link": "https://stackoverflow.com/users/4459280/david-rojko"}, "edited": false, "score": 0, "creation_date": 1457594325, "post_id": 35890746, "comment_id": 59479092, "body": "Thanks i figured it out. Much appriciated"}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": true, "score": 1, "last_activity_date": 1457524016, "creation_date": 1457524016, "answer_id": 35890746, "question_id": 35890248, "link": "https://stackoverflow.com/questions/35890248/what-does-static-mean-in-this-code/35890746#35890746", "title": "What does /static/ mean in this code?", "body": "<p>This means that whenever you handle requests that serves HTTP requests with the contents of the file system rooted at root, it try to server files declared in <code>http.Dir</code> which uses the operating system's file system implementation.</p>\n\n<p>This means that whenever you access your web server index url it will try to serve files under the operating system <code>/static/</code> directory.</p>\n\n<p>To serve a directory on disk under an alternate URL path you can use <code>StripPrefix</code> to modify the request URL's path before the <a href=\"https://golang.org/pkg/net/http/#example_FileServer_stripPrefix\" rel=\"nofollow\"><code>FileServer</code></a> sees it.</p>\n\n<pre><code>http.Handle(\"/static/\", http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"/your/directory/to/static/files\"))))\nhttp.ListenAndServe(\":8989\", nil)\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 4459280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86f5cb85c526dd8e14b2ff09265a934e?s=128&d=identicon&r=PG&f=1", "display_name": "David Rojko", "link": "https://stackoverflow.com/users/4459280/david-rojko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 35890746, "answer_count": 2, "score": 0, "last_activity_date": 1457524558, "creation_date": 1457522678, "question_id": 35890248, "link": "https://stackoverflow.com/questions/35890248/what-does-static-mean-in-this-code", "title": "What does /static/ mean in this code?", "body": "<p>Im trying to serve static html file in GO. \nThis is how my code in main() looks like.</p>\n\n<pre><code>http.Handle(\"/\", http.FileServer(http.Dir(\"/static/\")))\nhttp.ListenAndServe(\":8989\", nil)\n</code></pre>\n\n<p>It works but i dont understand what does static mean! Someone please explain.</p>\n"}, {"tags": ["html", "css", "image", "go", "template-engine"], "answers": [{"tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 14, "last_activity_date": 1457522453, "creation_date": 1457522453, "answer_id": 35890152, "question_id": 35888817, "link": "https://stackoverflow.com/questions/35888817/load-image-and-css-in-golang/35890152#35890152", "title": "Load image and css in Golang", "body": "<p>You need to explicitly ask your server to serve static files.  </p>\n\n<p>See <a href=\"https://golang.org/pkg/net/http/#FileServer\" rel=\"noreferrer\">http.FileServer</a></p>\n\n<p>In your case register another handler.</p>\n\n<pre><code>http.Handle(\"/public/\", http.StripPrefix(\"/public/\", http.FileServer(http.Dir(\"public\"))))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 842, "user_id": 1198986, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6af477723fb832487f84973e990d2466?s=128&d=identicon&r=PG", "display_name": "libertylocked", "link": "https://stackoverflow.com/users/1198986/libertylocked"}, "is_accepted": false, "score": 3, "last_activity_date": 1457553371, "creation_date": 1457553371, "answer_id": 35901368, "question_id": 35888817, "link": "https://stackoverflow.com/questions/35888817/load-image-and-css-in-golang/35901368#35901368", "title": "Load image and css in Golang", "body": "<p>Like Aruna said, register a static file server handle</p>\n\n<pre><code>http.Handle(\"/public/\", http.StripPrefix(\"/public/\", http.FileServer(http.Dir(\"public\"))))\n</code></pre>\n\n<p>And to use the files in your HTML, simply</p>\n\n<pre><code>&lt;img src=\"/public/images/img_landing_page_mac.png\"&gt;\n</code></pre>\n"}], "owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9308, "favorite_count": 1, "accepted_answer_id": 35890152, "answer_count": 2, "score": 14, "last_activity_date": 1457553371, "creation_date": 1457518903, "question_id": 35888817, "link": "https://stackoverflow.com/questions/35888817/load-image-and-css-in-golang", "title": "Load image and css in Golang", "body": "<p>I setup a route in <code>server.js</code> in package <code>main</code> in root directory of project</p>\n\n<p><code>http.HandleFunc(\"/\",route.IndexHandler)</code></p>\n\n<p>The <code>IndexHandler</code> is implemented in package <code>route</code> like this:</p>\n\n<pre><code>func IndexHandler(w http.ResponseWriter, r *http.Request) {\n    data:=struct{\n        Name string\n    }{\n        \"My name\",\n    }\n    util.RenderTemplate(w, \"index\", data)\n}\n</code></pre>\n\n<p>The <code>RenderTemplate</code> function is implemented in package <code>util</code> like this:</p>\n\n<pre><code>func RenderTemplate(w http.ResponseWriter, tmpl string, data interface{}) {\n    cwd, _ := os.Getwd()\n    t, err := template.ParseFiles(filepath.Join(cwd, \"./view/\" + tmpl + \".html\"))\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n    err = t.Execute(w, data)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    }\n}\n</code></pre>\n\n<p>Directory structure in project like this:</p>\n\n<pre><code>/\n/public/css\n/public/images\n/public/js\n/route\n/view\n</code></pre>\n\n<p><code>index.html</code> view is located in folder <code>view</code>, router is in folder <code>route</code></p>\n\n<p>In <code>index.html</code> I include resources like these:</p>\n\n<p><code>&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"../public/css/style.css\"&gt;</code></p>\n\n<p><code>&lt;img src=\"../public/images/img_landing_page_mac.png\"&gt;</code></p>\n\n<p>When request the appropriate path, <code>index.html</code> is still rendered, but images and stylesheet are not loaded. How can I do to include them in Golang html template engine?</p>\n"}, {"tags": ["go", "package"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1457515100, "post_id": 35886317, "comment_id": 59436151, "body": "What would be wrong if the service <b>and</b> implementation would live in the same package <code>github.com&#47;user&#47;foo</code>? You could still provide different impls in other packages or in tests? Not all best practices from e.g. Java carry over to Go."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1457516064, "post_id": 35886317, "comment_id": 59436769, "body": "Also have a look at how golang.org/x/oauth2 is organized."}, {"owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "edited": false, "score": 0, "creation_date": 1457541469, "post_id": 35886317, "comment_id": 59455331, "body": "Just keep your API and implementation in the same package, only exporting the identifiers that are part of the public API."}, {"owner": {"reputation": 4515, "user_id": 1710704, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a3b646c4f3b358bc74cfe636ca9655f7?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Shire", "link": "https://stackoverflow.com/users/1710704/logan-shire"}, "edited": false, "score": 0, "creation_date": 1457564063, "post_id": 35886317, "comment_id": 59468968, "body": "Aedolon - that&#39;s kinda what i&#39;m doing now. I&#39;m making both foo service and the implementation a part of the foo package, and then for services I will import &quot;github.com/user/foo/api&quot;, but for packages where I need both, e.g. main, I will rename them as I import them."}], "answers": [{"tags": [], "owner": {"reputation": 4515, "user_id": 1710704, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a3b646c4f3b358bc74cfe636ca9655f7?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Shire", "link": "https://stackoverflow.com/users/1710704/logan-shire"}, "is_accepted": false, "score": 0, "last_activity_date": 1457512091, "creation_date": 1457512091, "answer_id": 35886441, "question_id": 35886317, "link": "https://stackoverflow.com/questions/35886317/soo-go-subpackage-naming/35886441#35886441", "title": "SOO Go Subpackage Naming", "body": "<p>I found a potential workaround but I'm not going to mark this closed because it's not ideal. I discovered that you can name your imports to disambiguate packages with the same name. E.g.</p>\n\n<pre><code>import (\nfapi \"github.com/user/foo/api\"\nfimplementation \"github.com/user/foo/implementation\"\n)\n</code></pre>\n"}], "owner": {"reputation": 4515, "user_id": 1710704, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a3b646c4f3b358bc74cfe636ca9655f7?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Shire", "link": "https://stackoverflow.com/users/1710704/logan-shire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457512091, "creation_date": 1457511645, "question_id": 35886317, "link": "https://stackoverflow.com/questions/35886317/soo-go-subpackage-naming", "title": "SOO Go Subpackage Naming", "body": "<p>I am porting a large web application to Go. In order to manage complexity and increase testability, we are employing a service-oriented architecture. I am trying to figure out the clearest way to name and structure packages such that no service has any knowledge of another's implementation and that I can tell them apart at the application level. Allow me to give an example:</p>\n\n<p>FooService</p>\n\n<pre><code>package api\n\ntype FooService interface {\n    foo()\n}\n</code></pre>\n\n<p>FooService Implementation</p>\n\n<pre><code>package implementation\n\nimport (\n    \"fmt\"\n    _ \"github.com/user/foo/api\"\n)\n\ntype FooImplementation struct {\n}\n\nfunc (self FooImplementation) foo() {\n    fmt.Println(\"foo\")\n}\n</code></pre>\n\n<p>In my application, I will need to bind this implementation to the interface, as well as numerous others. But they can't all be named api/implementation. Do I have too name the packages fooapi and fooimplementation? Or is there a better way to structure my application?\nThanks!</p>\n"}, {"tags": ["go", "angular", "frontend", "backend"], "answers": [{"comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1457511100, "post_id": 35886086, "comment_id": 59433906, "body": "One can even include those assets into the binary, using things like <a href=\"https://github.com/elazarl/go-bindata-assetfs\" rel=\"nofollow noreferrer\">bindata-assetfs</a> or <a href=\"https://github.com/GeertJohan/go.rice\" rel=\"nofollow noreferrer\">go.rice</a>."}, {"owner": {"reputation": 382, "user_id": 3354604, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LPWCX.jpg?s=128&g=1", "display_name": "EgorkZe", "link": "https://stackoverflow.com/users/3354604/egorkze"}, "edited": false, "score": 0, "creation_date": 1457511275, "post_id": 35886086, "comment_id": 59433990, "body": "I want to use golang and angular2 separatly. Golang server will send only json data. Angular will request data from golang server api&#39;s and render web pages. Can i host  angular and golang in one server? For example  i will have access to web site with link <a href=\"http://mywebsite.com\" rel=\"nofollow noreferrer\">mywebsite.com</a> and access to golang api <a href=\"http://api.mywebsite.com\" rel=\"nofollow noreferrer\">api.mywebsite.com</a>"}, {"owner": {"reputation": 181833, "user_id": 1873365, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/45TMV.png?s=128&g=1", "display_name": "Thierry Templier", "link": "https://stackoverflow.com/users/1873365/thierry-templier"}, "edited": false, "score": 0, "creation_date": 1457511442, "post_id": 35886086, "comment_id": 59434096, "body": "I can&#39;t see any reason not to do that. Just be careful to support CORS in your API. See <a href=\"http://restlet.com/blog/2015/12/15/understanding-and-using-cors/\" rel=\"nofollow noreferrer\">restlet.com/blog/2015/12/15/understanding-and-using-cors</a>"}], "tags": [], "owner": {"reputation": 181833, "user_id": 1873365, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/45TMV.png?s=128&g=1", "display_name": "Thierry Templier", "link": "https://stackoverflow.com/users/1873365/thierry-templier"}, "is_accepted": true, "score": 7, "last_activity_date": 1478028324, "last_edit_date": 1478028324, "creation_date": 1457510715, "answer_id": 35886086, "question_id": 35886032, "link": "https://stackoverflow.com/questions/35886032/can-i-host-angular2-frontend-and-golang-backend-in-one-server/35886086#35886086", "title": "Can I host Angular2 frontend and Golang backend in one server", "body": "<p>Angular2 applications correspond to a set of static files (dependencies and application code). To have your application served by Go, you need to add some code to serve these files.</p>\n\n<p>It seems possible. See this link: </p>\n\n<ul>\n<li><a href=\"https://github.com/golang/go/wiki/HttpStaticFiles\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/HttpStaticFiles</a></li>\n</ul>\n\n<p><strong>Edit</strong></p>\n\n<p>Following your comment:</p>\n\n<blockquote>\n  <p>If you want to host Angular2 and golang in one server. For example i will have access to web site with link mywebsite.com and access to golang api api.mywebsite.com</p>\n</blockquote>\n\n<p>I can't see any reason not to do that. Just be careful to support CORS in your API (send the CORS headers in the response and support prefligthed requests). See these links:</p>\n\n<ul>\n<li><a href=\"http://restlet.com/blog/2015/12/15/understanding-and-using-cors\" rel=\"nofollow noreferrer\">http://restlet.com/blog/2015/12/15/understanding-and-using-cors</a></li>\n<li><a href=\"http://restlet.com/blog/2016/09/27/how-to-fix-cors-problems/\" rel=\"nofollow noreferrer\">http://restlet.com/blog/2016/09/27/how-to-fix-cors-problems/</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "is_accepted": false, "score": 6, "last_activity_date": 1469485646, "creation_date": 1469485646, "answer_id": 38578359, "question_id": 35886032, "link": "https://stackoverflow.com/questions/35886032/can-i-host-angular2-frontend-and-golang-backend-in-one-server/38578359#38578359", "title": "Can I host Angular2 frontend and Golang backend in one server", "body": "<p>Actual implementation with the stadand library</p>\n\n<pre><code>type Adapter func(http.Handler) http.Handler\n\n// Adapt function to enable middlewares on the standard library\nfunc Adapt(h http.Handler, adapters ...Adapter) http.Handler {\n    for _, adapter := range adapters {\n        h = adapter(h)\n    }\n    return h\n}\n\n// Creates a new serve mux\nmux := http.NewServeMux()\n\n// Create room for static files serving\nmux.Handle(\"/node_modules/\", http.StripPrefix(\"/node_modules\", http.FileServer(http.Dir(\"./node_modules\"))))\nmux.Handle(\"/html/\", http.StripPrefix(\"/html\", http.FileServer(http.Dir(\"./html\"))))\nmux.Handle(\"/js/\", http.StripPrefix(\"/js\", http.FileServer(http.Dir(\"./js\"))))\nmux.Handle(\"/ts/\", http.StripPrefix(\"/ts\", http.FileServer(http.Dir(\"./ts\"))))\nmux.Handle(\"/css/\", http.StripPrefix(\"/css\", http.FileServer(http.Dir(\"./css\"))))\n\n// Do your api stuff**\nmux.Handle(\"/api/register\", Adapt(api.RegisterHandler(mux),\n    api.GetMongoConnection(),\n    api.CheckEmptyUserForm(),\n    api.EncodeUserJson(),\n    api.ExpectBody(),\n    api.ExpectPOST(),\n\n))\nmux.HandleFunc(\"/api/login\", api.Login)\nmux.HandleFunc(\"/api/authenticate\", api.Authenticate)\n\n// Any other request, we should render our SPA's only html file,\n// Allowing angular to do the routing on anything else other then the api    \n// and the files it needs for itself to work.\n// Order here is critical. This html should contain the base tag like\n// &lt;base href=\"/\"&gt; *href here should match the HandleFunc path below \nmux.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n    http.ServeFile(w, r, \"html/index.html\")\n})\n</code></pre>\n"}], "owner": {"reputation": 382, "user_id": 3354604, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LPWCX.jpg?s=128&g=1", "display_name": "EgorkZe", "link": "https://stackoverflow.com/users/3354604/egorkze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6044, "favorite_count": 4, "accepted_answer_id": 35886086, "answer_count": 2, "score": 6, "last_activity_date": 1503582927, "creation_date": 1457510503, "last_edit_date": 1503582927, "question_id": 35886032, "link": "https://stackoverflow.com/questions/35886032/can-i-host-angular2-frontend-and-golang-backend-in-one-server", "title": "Can I host Angular2 frontend and Golang backend in one server", "body": "<p>I want to create RESTful API with Golang and frontend with Angular2.\nCommunication will be made with http requests. Angular2 will send requests to Golang API's. I know for Angular2 I should run own http server for routing and services.</p>\n\n<p>Can I run Golang server on one host and Angular2 server on another one and connect them together?</p>\n"}, {"tags": ["winapi", "go"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1457514059, "post_id": 35885460, "comment_id": 59435545, "body": "Please pick an appropriate title for your question. Your current version is completely unrelated to the question you are asking. Also, don&#39;t add tags to the title; questions can be tagged explicitly."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1457524438, "post_id": 35885460, "comment_id": 59442635, "body": "For the first half, no, the <code>unsafe.Pointer</code> conversion should not need a <code>&amp;</code>. In fact, having the <code>&amp;</code> will end up trampling over unintended memory, and because you&#39;re using <code>unsafe</code> the compiler won&#39;t yell at you! What happens if you remove it?"}, {"owner": {"reputation": 263, "user_id": 1825951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c30a36ac42be226b0b23c1ad0464356?s=128&d=identicon&r=PG", "display_name": "b00stfr3ak", "link": "https://stackoverflow.com/users/1825951/b00stfr3ak"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1457541861, "post_id": 35885460, "comment_id": 59455601, "body": "@andlabs if I remove the <code>&amp;</code> nothing gets written to the struct.  It looks like kostix down below explains it better."}], "answers": [{"comments": [{"owner": {"reputation": 263, "user_id": 1825951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c30a36ac42be226b0b23c1ad0464356?s=128&d=identicon&r=PG", "display_name": "b00stfr3ak", "link": "https://stackoverflow.com/users/1825951/b00stfr3ak"}, "edited": false, "score": 0, "creation_date": 1457541772, "post_id": 35894540, "comment_id": 59455529, "body": "I&#39;ve tried what you stated above and the struct is just nil, nothing gets written to it.  Also entriesread, totalentries are still 0, it looks like nothing gets written to those values either."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1457552021, "post_id": 35894540, "comment_id": 59462313, "body": "And what are <code>x</code> and <code>z</code>? (Really they should be <code>ret</code> and <code>err</code> as you have in your first code block.)"}, {"owner": {"reputation": 263, "user_id": 1825951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c30a36ac42be226b0b23c1ad0464356?s=128&d=identicon&r=PG", "display_name": "b00stfr3ak", "link": "https://stackoverflow.com/users/1825951/b00stfr3ak"}, "edited": false, "score": 0, "creation_date": 1457552215, "post_id": 35894540, "comment_id": 59462435, "body": "0 Overlapped I/O operation is in progress."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 263, "user_id": 1825951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c30a36ac42be226b0b23c1ad0464356?s=128&d=identicon&r=PG", "display_name": "b00stfr3ak", "link": "https://stackoverflow.com/users/1825951/b00stfr3ak"}, "edited": false, "score": 0, "creation_date": 1457554776, "post_id": 35894540, "comment_id": 59463903, "body": "@b00stfr3ak, there are more problems with your code than it appears on the first sight. I&#39;ve got a 80% working solution as of now, will try to post a gist in a couple of hours."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 263, "user_id": 1825951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c30a36ac42be226b0b23c1ad0464356?s=128&d=identicon&r=PG", "display_name": "b00stfr3ak", "link": "https://stackoverflow.com/users/1825951/b00stfr3ak"}, "edited": false, "score": 0, "creation_date": 1457566868, "post_id": 35894540, "comment_id": 59470078, "body": "@b00stfr3ak, here we go--please see the updated answer."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1457566989, "post_id": 35894540, "comment_id": 59470120, "body": "@andlabs, to my knowledge, with Win32 API at least, only the first return value is used, and that&#39;s what function returned. One should consult MSDN to check what sense to made of it--typically it can be a <code>BOOL</code> with 0 and 1 standing for false and true or <code>HRESULT</code> ."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1457580310, "post_id": 35894540, "comment_id": 59474081, "body": "@kostix I know that already; I was just pointing out what the conventional variable names should be. I&#39;m not sure why the middle parameter is there; the stdcall calling convention does not seem to return two values. SOme other OS?"}, {"owner": {"reputation": 263, "user_id": 1825951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c30a36ac42be226b0b23c1ad0464356?s=128&d=identicon&r=PG", "display_name": "b00stfr3ak", "link": "https://stackoverflow.com/users/1825951/b00stfr3ak"}, "edited": false, "score": 0, "creation_date": 1457585693, "post_id": 35894540, "comment_id": 59475547, "body": "@kostix this is the output of the the code linked: <code>2016&#47;03&#47;09 21:48:27 []</code>  I tried to add some println to see if entriesread or totalentries had any values and both returned 0"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 263, "user_id": 1825951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c30a36ac42be226b0b23c1ad0464356?s=128&d=identicon&r=PG", "display_name": "b00stfr3ak", "link": "https://stackoverflow.com/users/1825951/b00stfr3ak"}, "edited": false, "score": 0, "creation_date": 1457596222, "post_id": 35894540, "comment_id": 59480077, "body": "@b00stfr3ak, that&#39;s normal: on all non-server Windows I tried it returns 0 entries; on a server instance I got 30-something sessions. You can try connecting to a Windows share on your box from another machine to see that session listed."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1457596312, "post_id": 35894540, "comment_id": 59480131, "body": "@b00stfr3eak, if you wanted to enumerate <i>logged in users</i> instead you picked wrong facet of the Win32 API -- look at Windows Terminal Services (WTS) instead."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1457596467, "post_id": 35894540, "comment_id": 59480222, "body": "@andlabs, I think so, yes. Go works on &quot;weird&quot; systems including Plan9 which, for instance, has string as the &quot;exit code&quot; of a process ;-) I think they provided for common ground where applicable."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1457627553, "post_id": 35894540, "comment_id": 59502435, "body": "@kostix yes, but Plan 9 also has a different syscall package and no shared libraries :) Still interesting..."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 1, "last_activity_date": 1591472443, "last_edit_date": 1591472443, "creation_date": 1457534170, "answer_id": 35894540, "question_id": 35885460, "link": "https://stackoverflow.com/questions/35885460/how-do-i-properly-call-netapi32netsessionenum/35894540#35894540", "title": "How do I properly call netapi32!NetSessionEnum()?", "body": "<p>&hellip;because you're not supposed to pass a pointer to <em>your</em> memory block there&mdash;to cite <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb525382\" rel=\"nofollow noreferrer\">the manual</a>:</p>\n\n<blockquote>\n  <p>This buffer is allocated by the system and must be freed using the NetApiBufferFree function.</p>\n</blockquote>\n\n<p>The type of that pointer is misleading but you're supposed to pass a pointer to a pointer there, something like this:</p>\n\n<pre><code>func NetSessionEnum() {\n      var pinfo *SESSION_INFO_10\n      var prefmaxlen int32 = -1\n      var entriesread uint32\n      var totalentries uint32\n      var resumehandle uint32\n      x, y, z := procNetSessionEnum.Call(0, 0, 0, 10,\n          uintptr(unsafe.Pointer(&amp;pinfo)), uintptr(prefmaxlen),\n          uintptr(unsafe.Pointer(&amp;entriesread)),\n          uintptr(unsafe.Pointer(&amp;totalentries)),\n          uintptr(unsafe.Pointer(&amp;resumehandle)))\n      fmt.Println(x, y, z)\n      fmt.Println(entriesread, totalentries)\n      spew.Dump(info)\n}\n\n// Now use `*pinfo.Cname` etc\n// Don't forget to later call `NetApiBufferFree()` on that pointer.\n</code></pre>\n\n<p>What happens here:</p>\n\n<ol>\n<li><p>The variable <code>pinfo</code> is a pointer to a value of type <code>SESSION_INFO_10</code>.</p></li>\n<li><p>You take the address of the memory block occupied by the value kept in that variable (which is a pointer) and pass it to <code>NetSessionEnum()</code>.</p></li>\n<li><p>That function allocates the buffer by itself and writes its address to the memory block pointed to by the address you have passed to the function.</p>\n\n<p>Since you've passed an address of the <code>pinfo</code> variable, the address of the buffer ends up being written into the variable <code>pinfo</code>.</p></li>\n<li><p>You then use that address stored in <code>pinfo</code> to access the memory allocated by <code>NetSessionEnum()</code>.</p></li>\n</ol>\n\n<p>That's called \"double indirection\" and is used in quite many places of Win32 API. Please read the manual page and study the code example it includes.</p>\n\n<p><strong>Update:</strong> as it turned out, there were more problems with the original code so I've took time to provide full solution&mdash;<a href=\"https://gist.github.com/kostix/50830f62972311afa43a\" rel=\"nofollow noreferrer\">here</a> is the gist (tested with Go 1.6 amd64 and i386 on Windows XP 32-bit, Windows 2003 R2 64-bit and Windows 8.1 64-bit).</p>\n"}], "owner": {"reputation": 263, "user_id": 1825951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c30a36ac42be226b0b23c1ad0464356?s=128&d=identicon&r=PG", "display_name": "b00stfr3ak", "link": "https://stackoverflow.com/users/1825951/b00stfr3ak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 35894540, "answer_count": 1, "score": 0, "last_activity_date": 1591472443, "creation_date": 1457508445, "last_edit_date": 1457534212, "question_id": 35885460, "link": "https://stackoverflow.com/questions/35885460/how-do-i-properly-call-netapi32netsessionenum", "title": "How do I properly call netapi32!NetSessionEnum()?", "body": "<p>I'v been trying to play with netapi32.dll, but I'm having mixed results.</p>\n\n<p>The following works as expected </p>\n\n<pre><code>type SERVER_INFO_101 struct {\n      PlatformID   uint32\n      Name         *uint16\n      VersionMajor uint32\n      VersionMinor uint32\n      Type         uint32\n      Comment      *uint16\n}\n\n\nfunc NetServerGetInfo() {\n      info := &amp;SERVER_INFO_101{}\n      ret, _, err := procNetServerGetInfo.Call(0, 101, uintptr(unsafe.Pointer(&amp;info)))\n      if ret != 0 {\n              log.Fatal(err)\n      }\n      spew.Dump(info)\n}\n</code></pre>\n\n<p>However, I'm not sure why info has to have &amp; inside the unsafe.Pointer also.</p>\n\n<p>The following does not work, and I can't seem to find out why. No error codes get thrown. Neither the struct or variables gets filled out. </p>\n\n<pre><code>type SESSION_INFO_10 struct {\n      Cname    *uint16\n      Username *uint16\n      Time     uint32\n      IdleTime uint32\n}\n\nfunc NetSessionEnum() {\n      info := &amp;SESSION_INFO_10{}\n      var prefmaxlen int32 = -1\n      var entriesread uint32\n      var totalentries uint32\n      var resumehandle uint32\n      x, y, z := procNetSessionEnum.Call(0, 0, 0, 10, uintptr(unsafe.Pointer(info)), uintptr(prefmaxlen), uintptr(unsafe.Pointer(&amp;entriesread)), uintptr(unsafe.Pointer(&amp;totalentries)), uintptr(unsafe.Pointer(&amp;resumehandle)))\n      fmt.Println(x, y, z)\n      fmt.Println(entriesread, totalentries)\n      spew.Dump(info)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 1, "creation_date": 1457506902, "post_id": 35884965, "comment_id": 59431896, "body": "Apparently you&#39;re using Cygwin, which you didn&#39;t mention anywhere in your question. Why not just run <code>go</code> from a regular Windows <code>cmd</code> window?"}, {"owner": {"reputation": 475, "user_id": 3182873, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/B9IsH.jpg?s=128&g=1", "display_name": "Sandun Tharaka", "link": "https://stackoverflow.com/users/3182873/sandun-tharaka"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1457507009, "post_id": 35884965, "comment_id": 59431937, "body": "@Michael i used Cygwin for build .sh file in a project"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1457514800, "post_id": 35884965, "comment_id": 59435961, "body": "Go under cygwin works perfectly fine all you have to remember is one thing: If you use a Windows Go installation it expects a Windows GOPATH which means: 1: No &#39;:&#39; to separate entries (I think it&#39;s &#39;;&#39; on Win) and 2: Use Windows paths like <code>c:\\User\\kamin</code>. That&#39;s all."}], "answers": [{"comments": [{"owner": {"reputation": 2341, "user_id": 4332644, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b58ce98e1b4a8b5738ed68a053499b0a?s=128&d=identicon&r=PG", "display_name": "LNI", "link": "https://stackoverflow.com/users/4332644/lni"}, "edited": false, "score": 1, "creation_date": 1464468372, "post_id": 36971792, "comment_id": 62502137, "body": "@sandun-tharaka if the solution resolved your issue please mark it as correct answer."}, {"owner": {"reputation": 3549, "user_id": 1089355, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e801d8674953ed0f2bac2d50de938c55?s=128&d=identicon&r=PG", "display_name": "R71", "link": "https://stackoverflow.com/users/1089355/r71"}, "edited": false, "score": 1, "creation_date": 1482149203, "post_id": 36971792, "comment_id": 69642910, "body": "extra note: If GOPATH is set in cygwin (in .bashrc) then change &quot;\\&quot; to &quot;/&quot;"}, {"owner": {"reputation": 1933, "user_id": 4424698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-Rpp-wUKIk-o/AAAAAAAAAAI/AAAAAAAABCc/2my33oV6DDs/photo.jpg?sz=128", "display_name": "Hrvoje T", "link": "https://stackoverflow.com/users/4424698/hrvoje-t"}, "edited": false, "score": 0, "creation_date": 1546438058, "post_id": 36971792, "comment_id": 94852103, "body": "In Linux,  I tried <code>export GOPATH=$&#47;media&#47;storage&#47;gocode</code> and got this error. I needed to remove dollar sign. It needs absolute path. So I did <code>export GOPATH=&#47;media&#47;storage&#47;gocode</code> and it worked."}], "tags": [], "owner": {"reputation": 2341, "user_id": 4332644, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b58ce98e1b4a8b5738ed68a053499b0a?s=128&d=identicon&r=PG", "display_name": "LNI", "link": "https://stackoverflow.com/users/4332644/lni"}, "is_accepted": true, "score": 13, "last_activity_date": 1462135828, "creation_date": 1462135828, "answer_id": 36971792, "question_id": 35884965, "link": "https://stackoverflow.com/questions/35884965/gopath-error-in-windows-gopath-entry-is-relative-must-be-absolute-path/36971792#36971792", "title": "GOPATH error in windows &quot;GOPATH entry is relative; must be absolute path: &quot;", "body": "<p>Ran into same problem. Fix is quite simple: just specify the drive in front of the entire path name. The issue occurred because I was following the instructions on Go \"Getting Started\" page and set <code>GOPATH=%HOMEPATH%\\Work</code> . The problem was that <code>%HOMEPATH%</code> was defined as a relative path (<code>\\Users\\MyName</code>), and so <code>GOPATH</code> now pointed to <code>\\Users\\MyName\\Work</code> . All I needed to do was set <code>GOPATH=c:\\Users\\MyName\\Work</code> and the error goes away.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6302623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e45988df1f92cd90fb7cf84021c7dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Homero Fonseca", "link": "https://stackoverflow.com/users/6302623/homero-fonseca"}, "is_accepted": false, "score": 1, "last_activity_date": 1477260696, "creation_date": 1477260696, "answer_id": 40208305, "question_id": 35884965, "link": "https://stackoverflow.com/questions/35884965/gopath-error-in-windows-gopath-entry-is-relative-must-be-absolute-path/40208305#40208305", "title": "GOPATH error in windows &quot;GOPATH entry is relative; must be absolute path: &quot;", "body": "<p>As alternative you can set it to %USERPROFILE%\\ under Windows 10</p>\n"}, {"tags": [], "owner": {"reputation": 1285, "user_id": 693547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cde330ffd63ce6f63f38766c4d262538?s=128&d=identicon&r=PG", "display_name": "Taranttini", "link": "https://stackoverflow.com/users/693547/taranttini"}, "is_accepted": false, "score": 1, "last_activity_date": 1496957242, "creation_date": 1496957242, "answer_id": 44445831, "question_id": 35884965, "link": "https://stackoverflow.com/questions/35884965/gopath-error-in-windows-gopath-entry-is-relative-must-be-absolute-path/44445831#44445831", "title": "GOPATH error in windows &quot;GOPATH entry is relative; must be absolute path: &quot;", "body": "<p>you can put this case uses cygwin this go path</p>\n\n<p>export GOPATH='c:\\folder\\folder\\folder\\'</p>\n\n<p>for cygwin is necessary in string 'c:\\path'</p>\n\n<p>normaly you try use /cygdrive/.../... </p>\n\n<p>but for GO is not possible ( need c:\\ or other drive )</p>\n"}, {"tags": [], "owner": {"reputation": 403, "user_id": 7294974, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/B26Kl.jpg?s=128&g=1", "display_name": "salamander", "link": "https://stackoverflow.com/users/7294974/salamander"}, "is_accepted": false, "score": 6, "last_activity_date": 1509690896, "creation_date": 1509690896, "answer_id": 47089799, "question_id": 35884965, "link": "https://stackoverflow.com/questions/35884965/gopath-error-in-windows-gopath-entry-is-relative-must-be-absolute-path/47089799#47089799", "title": "GOPATH error in windows &quot;GOPATH entry is relative; must be absolute path: &quot;", "body": "<p>I encountered the same problem. My go version is <strong>go1.9.1 windows/amd64</strong>.\nHowever I fixed the problem by deleting the simucolon end of the GOPATH.\n<a href=\"https://i.stack.imgur.com/2PAkD.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/2PAkD.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 4169, "user_id": 1149398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KWIoS.jpg?s=128&g=1", "display_name": "sud007", "link": "https://stackoverflow.com/users/1149398/sud007"}, "is_accepted": false, "score": 1, "last_activity_date": 1519741595, "creation_date": 1519741595, "answer_id": 49010997, "question_id": 35884965, "link": "https://stackoverflow.com/questions/35884965/gopath-error-in-windows-gopath-entry-is-relative-must-be-absolute-path/49010997#49010997", "title": "GOPATH error in windows &quot;GOPATH entry is relative; must be absolute path: &quot;", "body": "<p>Adding one more error case that I experienced, was a silly-silly mistake in setting the GOPATH.</p>\n\n<p>I added : <code>D\\Go</code> (Forgot to added the colons after Drive letter).\nCorrect should have been <code>D:\\Go</code>, Offcourse this resolved the error.</p>\n"}], "owner": {"reputation": 475, "user_id": 3182873, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/B9IsH.jpg?s=128&g=1", "display_name": "Sandun Tharaka", "link": "https://stackoverflow.com/users/3182873/sandun-tharaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19431, "favorite_count": 4, "accepted_answer_id": 36971792, "answer_count": 5, "score": 16, "last_activity_date": 1519741595, "creation_date": 1457506669, "last_edit_date": 1459470495, "question_id": 35884965, "link": "https://stackoverflow.com/questions/35884965/gopath-error-in-windows-gopath-entry-is-relative-must-be-absolute-path", "title": "GOPATH error in windows &quot;GOPATH entry is relative; must be absolute path: &quot;", "body": "<p>I am new to GO and getting an error when initializing GOPATH in windows. \nIn my project folder is</p>\n\n<p>C:\\Users\\kamin\\Documents\\pm-manager</p>\n\n<p>and i am try to set path in environment variable (GOPATH)but it is getting an error \ngo: GOPATH entry is relative; must be absolute path: \":/cygdrive/c/Users/kamin/Documents/pm-manager\\r\\r\".\nRun 'go help gopath' for usage.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 5788029, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8896839e0218c3ced9970f323947137e?s=128&d=identicon&r=PG&f=1", "display_name": "Maz Baig", "link": "https://stackoverflow.com/users/5788029/maz-baig"}, "edited": false, "score": 0, "creation_date": 1457500652, "post_id": 35882754, "comment_id": 59429435, "body": "Thanks! This is the part I was having trouble with: Pages: []Page{{Description: &quot;def&quot;,PageNumber:  3,Source:      &quot;xyz&quot;,},{ Description: &quot;qrs&quot;,PageNumber:  5,Source:      &quot;xxx&quot;, }"}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 3, "last_activity_date": 1457496780, "creation_date": 1457496780, "answer_id": 35882754, "question_id": 35882216, "link": "https://stackoverflow.com/questions/35882216/how-to-populate-a-nested-golang-struct-which-contains-an-array-of-structs/35882754#35882754", "title": "How to populate a nested golang struct, which contains an array of structs", "body": "<p>You may need to define those inner structs as types. This works:</p>\n\n<pre><code>type Page struct {\n    Description string\n    PageNumber  int\n    Source      string\n}\n\ntype Chapter struct {\n    Name    string\n    PageNum int\n    Pages   []Page\n}\n\ntype Initial_Load struct {\n    Chapters    []Chapter\n    NumChapters int\n}\n\nvar x Initial_Load = Initial_Load{\n    Chapters: []Chapter{\n        {\n            Name:    \"abc\",\n            PageNum: 3,\n            Pages: []Page{\n                {\n                    Description: \"def\",\n                    PageNumber:  3,\n                    Source:      \"xyz\",\n                },\n                {\n                    Description: \"qrs\",\n                    PageNumber:  5,\n                    Source:      \"xxx\",\n                },\n            },\n        },\n    },\n    NumChapters: 1,\n}\n</code></pre>\n\n<p>I only put in 1 chapter, but you get the idea.</p>\n"}], "owner": {"reputation": 77, "user_id": 5788029, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8896839e0218c3ced9970f323947137e?s=128&d=identicon&r=PG&f=1", "display_name": "Maz Baig", "link": "https://stackoverflow.com/users/5788029/maz-baig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2006, "favorite_count": 3, "accepted_answer_id": 35882754, "answer_count": 1, "score": 1, "last_activity_date": 1457500721, "creation_date": 1457493461, "question_id": 35882216, "link": "https://stackoverflow.com/questions/35882216/how-to-populate-a-nested-golang-struct-which-contains-an-array-of-structs", "title": "How to populate a nested golang struct, which contains an array of structs", "body": "<p>So I've been trying to populate this monster of a struct I created, but with no success. </p>\n\n<pre><code>type Initial_Load struct {\n    Chapters []struct {\n        Name    string `Chapter Name`\n        PageNum int    `Number of Page\"`\n        Pages   []struct {\n            Description string `Page Description`\n            PageNumber  int    `Page Number`\n            Source      string `Page Source`\n        }\n    }\n    NumChapters int `Total number of chapters`\n}\n</code></pre>\n\n<p>Here's the JSON that this struct is modeling</p>\n\n<pre><code>{\n\u00a0\u00a0\u00a0\"Num_Chapters\": 2,\n\u00a0\u00a0\u00a0\"Chapters\": [\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Name\": \"Pilot\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Page_Num\": 2,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Pages\": [\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Page_Number\": 1,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Source\": \"local.com\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Description\": \"First Page\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Page_Number\": 2,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Source\": \"local.com\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Description\": \"Second Page\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0}\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Name\": \"Chapter2\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Page_Num\": 2,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Pages\": [\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Page_Number\": 1,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Source\": \"local.com\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Description\": \"First Page\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Page_Number\": 2,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Source\": \"local.com\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Description\": \"Second Page\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0}\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Name\": \"Chapter3\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Page_Num\": 2,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Pages\": [\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Page_Number\": 1,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Source\": \"local.com\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Description\": \"First Page\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Page_Number\": 2,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Source\": \"local.com\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Description\": \"Second Page\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0}\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0}\n\u00a0\u00a0\u00a0]\n}\n</code></pre>\n\n<p>There's of answered questions about populating nested structs, but I haven't found one which contains an array of structs. I know this is probably very simple, but I just can't figure it out. Thanks.</p>\n"}, {"tags": ["logging", "go"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1457484983, "post_id": 35880960, "comment_id": 59425089, "body": "Your code doesn&#39;t compile: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a>"}, {"owner": {"reputation": 1, "user_id": 5540192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92569b56316f401948a8e89e58c5d871?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo J.", "link": "https://stackoverflow.com/users/5540192/leonardo-j"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1457485204, "post_id": 35880960, "comment_id": 59425149, "body": "Sorry, it is part of larger project, this is just one portion of code that is referenced (hence no main function)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1457491134, "post_id": 35880960, "comment_id": 59426737, "body": "I have no idea the context in which this is used, but <code>measureBandwidth</code> creates 2 tickers that are never stopped, and starts 2 goroutines which never return. If you call that repeatedly you&#39;ll be &quot;leaking&quot; those resources."}, {"owner": {"reputation": 1, "user_id": 5540192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92569b56316f401948a8e89e58c5d871?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo J.", "link": "https://stackoverflow.com/users/5540192/leonardo-j"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1457511286, "post_id": 35880960, "comment_id": 59433993, "body": "@JimB the idea was that we ran this to do bandwidth logging, it is called via the function <a href=\"https://gist.github.com/anonymous/b7117ec590aedcad56f8\" rel=\"nofollow noreferrer\">gist.github.com/anonymous/b7117ec590aedcad56f8</a> so yes, they are called frequently; however, how would I go about resolving that then?"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 0, "last_activity_date": 1457558771, "last_edit_date": 1495535282, "creation_date": 1457542623, "answer_id": 35897829, "question_id": 35880960, "link": "https://stackoverflow.com/questions/35880960/golang-datalogger-bandwidth-memory-leak/35897829#35897829", "title": "GoLang datalogger (bandwidth) memory leak", "body": "<p>You are starting 2 <code>time.Ticker</code> and never stopping them, and starting 2 goroutines which never return. Every time you call <code>measureBandwidth</code> you \"leak\" those resources.</p>\n\n<p>Since you already have a channel which you're only receiving on, you should use that as a signal to return from the counting goroutine. The caller would then close the returned channel to cleanup.</p>\n\n<p>The second goroutine is not needed, and only serves to race the counter to throw away values. The counting goroutine can keep up, and if the send to the logger is too slow, put that in its own select case.</p>\n\n<pre><code>func measureBandwidth() (bwCh chan int) {\n    bwCh = make(chan int, 64)\n\n    go func() {\n        ticker := time.NewTicker(config.DL.Interval)\n        defer ticker.Stop()\n\n        count := 0\n\n        for {\n            select {\n            case n, ok := &lt;-bwCh:\n                if !ok {\n                    return\n                }\n                count += n\n\n            case &lt;-ticker.C:\n                DataLoggerRecords &lt;- &amp;DataLoggerRecord{Bytes: count}\n                count = 0\n            }\n        }\n    }()\n\n    return bwCh\n}\n</code></pre>\n\n<p>Example: <a href=\"http://play.golang.org/p/RfpBxPlGeW\" rel=\"nofollow noreferrer\">http://play.golang.org/p/RfpBxPlGeW</a></p>\n\n<p>(minor nitpick, it's usually preferred to use signed types for operating on numeric values like this: see here for one such conversation: <a href=\"https://stackoverflow.com/questions/336/when-to-use-unsigned-values-over-signed-ones\">When to use unsigned values over signed ones?</a>)</p>\n"}], "owner": {"reputation": 1, "user_id": 5540192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92569b56316f401948a8e89e58c5d871?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo J.", "link": "https://stackoverflow.com/users/5540192/leonardo-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 285, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1457558771, "creation_date": 1457484657, "question_id": 35880960, "link": "https://stackoverflow.com/questions/35880960/golang-datalogger-bandwidth-memory-leak", "title": "GoLang datalogger (bandwidth) memory leak", "body": "<p>I'm trying to find the memory leak and I've zeroed it down to this portion of code but I can't find where the memory leak is or how to fix it, when I had some people look into it they suggested it has to do with \"tickers\" as mentioned here:\n<a href=\"https://golang.org/src/time/tick.go\" rel=\"nofollow\">https://golang.org/src/time/tick.go</a>\nit \"leaks\". Any ideas on fixes?</p>\n\n<p>Thanks! :)</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"encoding/csv\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"time\"\n)\n\n// Records information about a transfer window: the total amount of data\n// transferred in a fixed time period in a particular direction (clientbound or\n// serverbound) in a session.\ntype DataLoggerRecord struct {\n    // Number of bytes transferred in this transfer window.\n    Bytes uint\n}\n\nvar DataLoggerRecords = make(chan *DataLoggerRecord, 64)\n\n// The channel returned should be used to send the number of bytes transferred\n// whenever a transfer is done.\nfunc measureBandwidth() (bandwidthChan chan uint) {\n    bandwidthChan = make(chan uint, 64)\n    timer := time.NewTicker(config.DL.FlushInterval * time.Second)\n\n    go func() {\n        for _ = range timer.C {\n            drainchan(bandwidthChan)\n        }\n    }()  \n\n    go func() {\n        var count uint\n        ticker := time.Tick(config.DL.Interval)\n\n        for {\n            select {\n            case n := &lt;-bandwidthChan:\n                count += n\n\n            case &lt;-ticker:\n                DataLoggerRecords &lt;- &amp;DataLoggerRecord{\n                    Bytes:      count,\n                }\n                count = 0\n            }\n        }\n    }()\n\n    return bandwidthChan\n}\n\nfunc drainchan(bandwidthChan chan uint) {\n    for {\n        select {\n        case e := &lt;-bandwidthChan:\n            fmt.Printf(\"%s\\n\", e)\n        default:\n            return\n        }\n    }\n}\n\n\nfunc runDataLogger() {\n    f, err := os.OpenFile(dataloc, os.O_RDWR|os.O_CREATE|os.O_APPEND, 0666)\n    if err != nil {\n        log.Fatalf(\"[DL] Could not open %s\", err.Error())\n    }\n\n    bw := bufio.NewWriter(f)\n    defer func() {\n        bw.Flush()\n        f.Close()\n    }()\n\n    go func() {\n        for {\n            time.Sleep(time.Second)\n            bw.Flush()\n        }\n    }()\n\n    w := csv.NewWriter(bw)\n\n\n    for record := range DataLoggerRecords {\n        if record.Bytes != 0 {\n            err = w.Write([]string{\n                fmt.Sprintf(\"%d\", record.Bytes),\n            })\n            w.Flush()\n        } else {\n            continue\n        }\n    }\n    if err != nil {\n        if err.Error() != \"short write\" {\n            log.Printf(\"[DL] Failed to write record: %s\", err.Error())\n        } else {\n            w.Flush()\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "edited": false, "score": 0, "creation_date": 1457475303, "post_id": 35879039, "comment_id": 59421544, "body": "Something is off with your string, when I literally run that string and split it I get <code>[2015 10 04]</code>;"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1457475772, "post_id": 35879039, "comment_id": 59421782, "body": "You need to provide a reproducible example: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "edited": false, "score": 1, "creation_date": 1457475325, "post_id": 35879098, "comment_id": 59421558, "body": "Yes I get that too. It has to indicate that the &quot;string&quot; Mitchell has is tainted in some way with invalid bytes or hidden characters."}, {"owner": {"reputation": 15349, "user_id": 2282538, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0a4fff09f1f0e3360daeabb30c2c06bb?s=128&d=identicon&r=PG", "display_name": "Tyler", "link": "https://stackoverflow.com/users/2282538/tyler"}, "edited": false, "score": 0, "creation_date": 1457475664, "post_id": 35879098, "comment_id": 59421725, "body": "@Allendar I agree.  I added in an example with other Unicode dashes which could be his problem"}, {"owner": {"reputation": 674, "user_id": 866376, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1175553f0c746b7a2711465792aefe42?s=128&d=identicon&r=PG", "display_name": "Mitchell Ingram", "link": "https://stackoverflow.com/users/866376/mitchell-ingram"}, "edited": false, "score": 2, "creation_date": 1457477678, "post_id": 35879098, "comment_id": 59422590, "body": "Yep, the dash did not match. Never would have figured that out, thanks!"}], "tags": [], "owner": {"reputation": 15349, "user_id": 2282538, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0a4fff09f1f0e3360daeabb30c2c06bb?s=128&d=identicon&r=PG", "display_name": "Tyler", "link": "https://stackoverflow.com/users/2282538/tyler"}, "is_accepted": true, "score": 7, "last_activity_date": 1457476085, "last_edit_date": 1457476085, "creation_date": 1457475288, "answer_id": 35879098, "question_id": 35879039, "link": "https://stackoverflow.com/questions/35879039/strings-split-acting-weird/35879098#35879098", "title": "strings.Split acting weird", "body": "<p>Here's a complete working example:</p>\n\n<pre><code>package main\n\nimport \"strings\"\n\nfunc main() {\n    date := \"2015-01-02\"\n    month := strings.Split(date, \"-\")\n    println(month[0])\n    println(month[1])\n    println(month[2])\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2015\n01\n02\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/0KsywfAy8G\" rel=\"nofollow\">Playground</a></p>\n\n<hr>\n\n<p>Perhaps you're not using the correct \"dash\" character?  <a href=\"https://www.cs.tut.fi/~jkorpela/dashes.html\" rel=\"nofollow\">There are lots</a>:</p>\n\n<pre><code>+-------+--------+----------+\n| glyph |       codes       |\n+-------+--------+----------+\n| -     | U+002D | &amp;#45;    |\n| \u058a     | U+058A | &amp;#1418;  |\n| \u05be     | U+05BE | &amp;#1470;  |\n| \u1806     | U+1806 | &amp;#6150;  |\n| \u2010     | U+2010 | &amp;#8208;  |\n| \u2011     | U+2011 | &amp;#8209;  |\n| \u2012     | U+2012 | &amp;#8210;  |\n| \u2013     | U+2013 | &amp;#8211;  |\n| \u2014     | U+2014 | &amp;#8212;  |\n| \u2015     | U+2015 | &amp;#8213;  |\n| \u207b     | U+207B | &amp;#8315;  |\n| \u208b     | U+208B | &amp;#8331;  |\n| \u2212     | U+2212 | &amp;#8722;  |\n| \ufe58     | U+FE58 | &amp;#65112; |\n| \ufe63     | U+FE63 | &amp;#65123; |\n| \uff0d     | U+FF0D | &amp;#65293; |\n+-------+--------+----------+\n</code></pre>\n\n<p>Here is the code with a different input string, which also throws an index out of bounds exception:</p>\n\n<p>package main</p>\n\n<pre><code>import \"strings\"\n\nfunc main() {\n    date := \"2015\u201001\u201002\" // U+2010 dashes\n    month := strings.Split(date, \"-\")\n    println(month[0])\n    println(month[1])\n    println(month[2])\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/YuY1OyjydR\" rel=\"nofollow\">Playground.</a></p>\n"}], "owner": {"reputation": 674, "user_id": 866376, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1175553f0c746b7a2711465792aefe42?s=128&d=identicon&r=PG", "display_name": "Mitchell Ingram", "link": "https://stackoverflow.com/users/866376/mitchell-ingram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 35879098, "answer_count": 1, "score": 0, "last_activity_date": 1457476085, "creation_date": 1457475067, "question_id": 35879039, "link": "https://stackoverflow.com/questions/35879039/strings-split-acting-weird", "title": "strings.Split acting weird", "body": "<p>I am doing a simple strings.Split on a date.</p>\n\n<p>The format is <code>2015-10-04</code> </p>\n\n<pre><code>month := strings.Split(date, \"-\")\n</code></pre>\n\n<p>output is <code>[2015 10 03]</code>.</p>\n\n<p>If I do <code>month[0]</code> it returns 2015 but when I do month[1], it returns </p>\n\n<pre><code>panic: runtime error: index out of range\n</code></pre>\n\n<p>Though it clearly isn't. Am I using it wrong? Any idea what is going on?</p>\n"}, {"tags": ["arrays", "go"], "answers": [{"comments": [{"owner": {"reputation": 390, "user_id": 5605294, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/HRKeI.jpg?s=128&g=1", "display_name": "barthr", "link": "https://stackoverflow.com/users/5605294/barthr"}, "edited": false, "score": 0, "creation_date": 1457463133, "post_id": 35875388, "comment_id": 59414583, "body": "Yes the books says that. But it kinda got my attention because they were comparing pointers with slices. You made it very clear thanks!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1457463145, "last_edit_date": 1457463145, "creation_date": 1457462439, "answer_id": 35875388, "question_id": 35875217, "link": "https://stackoverflow.com/questions/35875217/passing-slices-instead-of-pointers/35875388#35875388", "title": "Passing slices instead of pointers", "body": "<p>Copying anything less than a cache line (usually 128 bytes on most common CPUs) basically takes the same amount of  time, so there's no real difference between 8 bytes and 24. More time is usually spent dereferencing the pointer than copying anything this small. </p>\n\n<p>Since the default method of manipulating arrays via pointers is within a slice, it's more idiomatic to use a slice rather than a pointer to an array. The quote from the book however is referring to passing an array value, not via a pointer, which <em>will</em> copy the entire array. </p>\n"}], "owner": {"reputation": 390, "user_id": 5605294, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/HRKeI.jpg?s=128&g=1", "display_name": "barthr", "link": "https://stackoverflow.com/users/5605294/barthr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 35875388, "answer_count": 1, "score": 0, "last_activity_date": 1457463145, "creation_date": 1457461919, "question_id": 35875217, "link": "https://stackoverflow.com/questions/35875217/passing-slices-instead-of-pointers", "title": "Passing slices instead of pointers", "body": "<p>I was reading a book and came across this topic about passing parameters.</p>\n\n<p>The book says passing a slice of an array to a function takes 24 bytes. And it states that it is better to pass the slice, because the underlying array will not be copied. But doesn't passing a pointer only take 8 bytes? </p>\n\n<p>Book: Go in action</p>\n\n<p>Is the overhead so little that passing slices is the way to go? Versus passing the pointers </p>\n"}, {"tags": ["go", "xml-parsing"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1457464648, "post_id": 35874580, "comment_id": 59415543, "body": "Welcome to SO. As a tip, adding a <a href=\"http://play.golang.org/\" rel=\"nofollow noreferrer\">Playground</a> link with an <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> helps people help you."}, {"owner": {"reputation": 23, "user_id": 6035617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hzUBy3PMiNw/AAAAAAAAAAI/AAAAAAAAR0E/4jO0DH6hyxc/photo.jpg?sz=128", "display_name": "Chase Martin", "link": "https://stackoverflow.com/users/6035617/chase-martin"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1457472640, "post_id": 35874580, "comment_id": 59420131, "body": "Thank you for the response. I have put some code into the Go Playground. I believe this replicates the issue I am having.       <a href=\"http://play.golang.org/p/J7wy6306Cj\" rel=\"nofollow noreferrer\">play.golang.org/p/J7wy6306Cj</a>"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1457506294, "post_id": 35874580, "comment_id": 59431622, "body": "Is your issue those <code>_xmlns:foo</code> that should be <code>xmlns:foo</code>?"}, {"owner": {"reputation": 23, "user_id": 6035617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hzUBy3PMiNw/AAAAAAAAAAI/AAAAAAAAR0E/4jO0DH6hyxc/photo.jpg?sz=128", "display_name": "Chase Martin", "link": "https://stackoverflow.com/users/6035617/chase-martin"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1457535784, "post_id": 35874580, "comment_id": 59450879, "body": "The namespace is one of the issues, but the output XML attributes is quite different than incoming attributes. For example, if I run my program on a gigantic GPS file, it will not import into Garmin Basecamp until I replace the &lt; gpx &gt; header."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6035617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hzUBy3PMiNw/AAAAAAAAAAI/AAAAAAAAR0E/4jO0DH6hyxc/photo.jpg?sz=128", "display_name": "Chase Martin", "link": "https://stackoverflow.com/users/6035617/chase-martin"}, "edited": false, "score": 0, "creation_date": 1457583601, "post_id": 35895543, "comment_id": 59474945, "body": "Accepted answer. You&#39;re right, it&#39;s a limitation with the XML encoder of Go. Unfortunately Garmin Basecamp is very persnickety with how the XML attributes are represented. As such, I performed some basic string manipulation to get the desired results. Unfortunate, because other languages (not mentioning any names) could easily give the required results."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1457536669, "creation_date": 1457536669, "answer_id": 35895543, "question_id": 35874580, "link": "https://stackoverflow.com/questions/35874580/go-unmarshal-xml-attribute-issues/35895543#35895543", "title": "Go - Unmarshal XML, Attribute issues", "body": "<p>Unfortunately, the default Go XML encoder cannot encode stuff like</p>\n\n<pre><code>xmlns:foo=\"http://example.com/Foo-V1\" foo:attr=\"bar\"\n</code></pre>\n\n<p>As <a href=\"https://github.com/golang/go/blob/7bc40ffb05d8813bf9b41a331b45d37216f9e747/src/encoding/xml/marshal.go#L333\" rel=\"nofollow\">the code shows</a>, it chooses the name based on the URL, and you can't just define namespaces yourself. The Go encoder emits code like this which, AFAIK, is basically equivalent to the one above:</p>\n\n<pre><code>xmlns:Foo-V1=\"http://example.com/Foo-V1\" Foo-V1:attr=\"bar\"\n</code></pre>\n\n<p>The only thing that is different here is the prefix for the namespace.</p>\n\n<p>As for forward-declaration of other namespaces, I'd suggest only declaring them on elements and attributes that need them. I.e. to encode something like</p>\n\n<pre><code>&lt;foo xmlns:bar=\"http://example.com/Bar-V1\"&gt;\n  &lt;bar:elem&gt;Hello world&lt;/bar:elem&gt;\n&lt;/foo&gt;\n</code></pre>\n\n<p>use structs like this</p>\n\n<pre><code>type Foo struct {\n    XMLName xml.Name `xml:\"foo\"`\n    BarElem BarElem\n}\n\ntype BarElem struct {\n    XMLName xml.Name `xml:\"http://example.com/Bar-V1 elem\"`\n    Data    string   `xml:\",innerxml\"`\n}\n</code></pre>\n\n<p>which serializes to</p>\n\n<pre><code>&lt;foo&gt;\n  &lt;elem xmlns=\"http://example.com/Bar-V1\"&gt;Hello world&lt;/elem&gt;\n&lt;/foo&gt;\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/79bhk70yFj\" rel=\"nofollow\">http://play.golang.org/p/79bhk70yFj</a>.</p>\n"}], "owner": {"reputation": 23, "user_id": 6035617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hzUBy3PMiNw/AAAAAAAAAAI/AAAAAAAAR0E/4jO0DH6hyxc/photo.jpg?sz=128", "display_name": "Chase Martin", "link": "https://stackoverflow.com/users/6035617/chase-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 35895543, "answer_count": 1, "score": 2, "last_activity_date": 1457536669, "creation_date": 1457459905, "last_edit_date": 1457473553, "question_id": 35874580, "link": "https://stackoverflow.com/questions/35874580/go-unmarshal-xml-attribute-issues", "title": "Go - Unmarshal XML, Attribute issues", "body": "<p>Maybe somebody could give some insight here... I seem to be hitting a brick wall with the encoding/XML library.</p>\n\n<p>For the life of me, I can't replicate the valid XML attributes from &lt; gpx >\nBasically i'm unmarshalling the XML data from a GPS file, then marshalling it back into another file. Everything is working correctly, except the attribute tags for the root XML &lt; gpx ></p>\n\n<p>I've tried various </p>\n\n<pre><code>func (c *gpx) UnmarshalXML(d *xml.Decoder, start xml.StartElement) error {} \n</code></pre>\n\n<p>type approaches to no avail. </p>\n\n<p>Basically I just want the root tag &lt; GPX > to have all the attributes assigned correctly. Why you can't do Attributes []xml.Attr xml:\",attr\"or something similar is beyond me.</p>\n\n<p>Good XML header -> <a href=\"http://pastebin.com/XjEZuBa1\" rel=\"nofollow\">http://pastebin.com/XjEZuBa1</a> </p>\n\n<p>I can't link the bad XML header, since I'm a new member.. but the XML unmarshal/marshal process adds _ to the namespace which causes issues, among other things. </p>\n\n<p>GO Playground link: <a href=\"http://play.golang.org/p/J7wy6306Cj\" rel=\"nofollow\">http://play.golang.org/p/J7wy6306Cj</a></p>\n\n<p>Any help would be greatly appreciated,\nThank you.</p>\n"}, {"tags": ["go", "profiling"], "comments": [{"owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "edited": false, "score": 2, "creation_date": 1457456536, "post_id": 35872019, "comment_id": 59410805, "body": "Why are you using &quot;i &lt; 1000&quot;? Benchmarks must use the b.N field or they won&#39;t give correct results, as each benchmark function is potentially called multiple times with different values of b.N."}], "answers": [{"comments": [{"owner": {"reputation": 1729, "user_id": 720638, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/112425a5ffe0c5a29ec1683e52d3aa62?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/720638/dan"}, "edited": false, "score": 1, "creation_date": 1473449014, "post_id": 35872302, "comment_id": 66161806, "body": "Can you please clarify this answer?  It&#39;s unclear what your solution was or whether it worked."}, {"owner": {"reputation": 259, "user_id": 6035136, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9abd7b0d8267fd3a9c0b39bc76a2fd1c?s=128&d=identicon&r=PG&f=1", "display_name": "sejvlond", "link": "https://stackoverflow.com/users/6035136/sejvlond"}, "reply_to_user": {"reputation": 1729, "user_id": 720638, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/112425a5ffe0c5a29ec1683e52d3aa62?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/720638/dan"}, "edited": false, "score": 0, "creation_date": 1473584890, "post_id": 35872302, "comment_id": 66191676, "body": "I think it&#39;s pretty clear. &quot;I miss to add binary to go tool pprof&quot; so it has to be: &quot;go tool pprof write cpu.out&quot; and after this command, you can see the output, so it worked.."}], "tags": [], "owner": {"reputation": 259, "user_id": 6035136, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9abd7b0d8267fd3a9c0b39bc76a2fd1c?s=128&d=identicon&r=PG&f=1", "display_name": "sejvlond", "link": "https://stackoverflow.com/users/6035136/sejvlond"}, "is_accepted": true, "score": 8, "last_activity_date": 1457453371, "creation_date": 1457453371, "answer_id": 35872302, "question_id": 35872019, "link": "https://stackoverflow.com/questions/35872019/golang-profiling-top10-shows-only-one-line-with-100/35872302#35872302", "title": "Golang profiling - top10 shows only one line with 100%", "body": "<p>Ok it's easy, I miss to add binary to go tool pprof, si it has to be</p>\n\n<pre><code># go tool pprof write cpu.out \nEntering interactive mode (type \"help\" for commands)\n(pprof) top10\n7.02s of 7.38s total (95.12%)\nDropped 14 nodes (cum &lt;= 0.04s)\nShowing top 10 nodes out of 32 (cum &gt;= 0.19s)\n      flat  flat%   sum%        cum   cum%\n     6.55s 88.75% 88.75%      6.76s 91.60%  syscall.Syscall\n    ...\n</code></pre>\n\n<p>and when using benchmark tests, binary is created there and using it gives same result.  </p>\n"}, {"tags": [], "owner": {"reputation": 885, "user_id": 606571, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0546906539a9b70ee3f1c1d1df018f07?s=128&d=identicon&r=PG", "display_name": "UltraMaster", "link": "https://stackoverflow.com/users/606571/ultramaster"}, "is_accepted": false, "score": 0, "last_activity_date": 1483177397, "creation_date": 1483177397, "answer_id": 41407180, "question_id": 35872019, "link": "https://stackoverflow.com/questions/35872019/golang-profiling-top10-shows-only-one-line-with-100/41407180#41407180", "title": "Golang profiling - top10 shows only one line with 100%", "body": "<p>To expand on sejvolnd's answer: </p>\n\n<p><code>pprof</code> needs the binary that actually generated <code>cpu.out</code> file as a first argument.</p>\n\n<p>So you need to run the command as <code>go tool pprof &lt;go binary of your program&gt; &lt;generaged profiling output file&gt;</code></p>\n\n<p>e.g. <code>go tool pprof go_binary cpu.pprof</code></p>\n"}], "owner": {"reputation": 259, "user_id": 6035136, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9abd7b0d8267fd3a9c0b39bc76a2fd1c?s=128&d=identicon&r=PG&f=1", "display_name": "sejvlond", "link": "https://stackoverflow.com/users/6035136/sejvlond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1253, "favorite_count": 0, "accepted_answer_id": 35872302, "answer_count": 2, "score": 5, "last_activity_date": 1483177397, "creation_date": 1457452648, "last_edit_date": 1457522085, "question_id": 35872019, "link": "https://stackoverflow.com/questions/35872019/golang-profiling-top10-shows-only-one-line-with-100", "title": "Golang profiling - top10 shows only one line with 100%", "body": "<p>I try to profiling my go library, to find out what is the cause of being so much slower than same thing in c++.</p>\n\n<p>I have simple benchmark</p>\n\n<pre><code>func BenchmarkFile(t *testing.B) {\n    tmpFile, err := ioutil.TempFile(\"\", TMP_FILE_PREFIX)\n\n    fw, err := NewFile(tmpFile.Name())\n    text := []byte(\"testing\")\n    for i := 0; i &lt; b.N; i++ {\n        _, err = fw.Write(text)\n    }\n    fw.Close()\n}\n</code></pre>\n\n<p>NewFile return my custom Writer which encodes data to our binary representation, even compress them, and write to file system.</p>\n\n<p>Running <code>go test -bench . -memprofile mem.out -cpuprofile cpu.out</code> I get</p>\n\n<pre><code>PASS\nBenchmarkFile-16    2000000000           0.20 ns/op\nok      .../writer/iowriter 9.074s\n</code></pre>\n\n<p>Than analysing it</p>\n\n<pre><code># go tool pprof cpu.out \nEntering interactive mode (type \"help\" for commands)\n(pprof) top10\n930ms of 930ms total (  100%)\n      flat  flat%   sum%        cum   cum%\n     930ms   100%   100%      930ms   100%  \n(pprof) \n</code></pre>\n\n<p>I even try to write example.go app which is using my writer, and add <code>pprof.StartCPUProfile(f)</code> as is shown in <a href=\"http://blog.golang.org/profiling-go-programs\">http://blog.golang.org/profiling-go-programs</a> but with same result.</p>\n\n<p>What am I doing wrong, and how can I determine what is bottleneck of my lib?\nThank you in advance </p>\n"}, {"tags": ["go", "pprof", "heap-profiling"], "comments": [{"owner": {"reputation": 23028, "user_id": 107156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mSIVv.jpg?s=128&g=1", "display_name": "Kyle Brandt", "link": "https://stackoverflow.com/users/107156/kyle-brandt"}, "edited": false, "score": 0, "creation_date": 1457450934, "post_id": 35871365, "comment_id": 59406669, "body": "Oh, and the context is that one instance of this binary is slowly leaking memory. I have this snapshot, and am going to grab another one in several hours compare them. Unless it turns out the leak isn&#39;t in the heap, then I&#39;m not sure what to do next."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1457454872, "post_id": 35871365, "comment_id": 59409561, "body": "Since Go has a precise GC, a &quot;leak&quot; almost always involves goroutines that aren&#39;t returning. A stack trace is often more helpful with this than a heap profile."}, {"owner": {"reputation": 23028, "user_id": 107156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mSIVv.jpg?s=128&g=1", "display_name": "Kyle Brandt", "link": "https://stackoverflow.com/users/107156/kyle-brandt"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1457455388, "post_id": 35871365, "comment_id": 59409951, "body": "@JimB I monitor the number of goroutines though (ironically, using the thing that is slowly consuming more memory), and the number of routines is stable."}], "answers": [{"tags": [], "owner": {"reputation": 15124, "user_id": 144969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a12d286134563e628089f733b946a00?s=128&d=identicon&r=PG", "display_name": "Dimitar Dimitrov", "link": "https://stackoverflow.com/users/144969/dimitar-dimitrov"}, "is_accepted": true, "score": 14, "last_activity_date": 1482153511, "last_edit_date": 1482153511, "creation_date": 1457454276, "answer_id": 35872619, "question_id": 35871365, "link": "https://stackoverflow.com/questions/35871365/interpreting-pprof-heap-diagrams/35872619#35872619", "title": "Interpreting pprof heap diagrams", "body": "<ol>\n<li>the perceived cumulative memory consumption of this function <strong>including</strong> all of its subfunctions </li>\n<li>the perceived memory consumption of this function <strong>excluding</strong> all of its subfunctions</li>\n<li>that it calls multiple subfunctions</li>\n<li>that multiple functions call it</li>\n</ol>\n\n<p>No difference between the meaning of the arrows between the heap and the CPU profiling mode.</p>\n\n<p>You may be interested in the output of the <code>top</code> pprof command, which can give you results in the following form:</p>\n\n<pre><code>9701.61kB of 9701.61kB total (  100%) Dropped 112 nodes (cum &lt;=\n48.51kB) Showing top 10 nodes out of 29 (cum &gt;= 3611.54kB)\n      flat  flat%   sum%        cum   cum%\n 4549.72kB 46.90% 46.90%  4549.72kB 46.90%  mystery.function\n 2587.52kB 26.67% 73.57%  2587.52kB 26.67%  reflect.unsafe_NewArray\n 1024.02kB 10.56% 84.12%  1024.02kB 10.56%  encoding/xml.copyValue\n     514kB  5.30% 89.42%      514kB  5.30%  compress/gzip.NewReader\n     514kB  5.30% 94.72%      514kB  5.30%  net/http.(*Transport).dialConn\n  512.34kB  5.28%   100%   512.34kB  5.28%  runtime.makeslice\n         0     0%   100%      514kB  5.30%  bytes.(*Buffer).ReadFrom\n         0     0%   100%  3611.54kB 37.23%  encoding/xml.(*Decoder).Decode\n         0     0%   100%  3611.54kB 37.23%  encoding/xml.(*Decoder).DecodeElement\n         0     0%   100%  3611.54kB 37.23%  encoding/xml.(*Decoder).unmarshal\n</code></pre>\n\n<p>And here are (IMHO) the two best references for Go heap profiling with pprof: </p>\n\n<ol>\n<li><a href=\"https://google-perftools.googlecode.com/svn/trunk/doc/heapprofile.html\" rel=\"noreferrer\">https://google-perftools.googlecode.com/svn/trunk/doc/heapprofile.html</a></li>\n<li><a href=\"https://software.intel.com/en-us/blogs/2014/05/10/debugging-performance-issues-in-go-programs\" rel=\"noreferrer\">https://software.intel.com/en-us/blogs/2014/05/10/debugging-performance-issues-in-go-programs</a></li>\n</ol>\n"}], "owner": {"reputation": 23028, "user_id": 107156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mSIVv.jpg?s=128&g=1", "display_name": "Kyle Brandt", "link": "https://stackoverflow.com/users/107156/kyle-brandt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3371, "favorite_count": 5, "accepted_answer_id": 35872619, "answer_count": 1, "score": 7, "last_activity_date": 1482153511, "creation_date": 1457450768, "question_id": 35871365, "link": "https://stackoverflow.com/questions/35871365/interpreting-pprof-heap-diagrams", "title": "Interpreting pprof heap diagrams", "body": "<p>When I profile the heap in go with pprof I get the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/o1uet.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/o1uet.png\" alt=\"enter image description here\"></a></p>\n\n<p>However, I'm not clear on how to interpret that visualization. In particular:</p>\n\n<p>\"The memory next to the arrows means _____ and the memory inside of a box means ______. So when a box has multiple arrows from it, it means _____, and when it has multiple arrows to it, it means _____\". </p>\n"}, {"tags": ["unicode", "encoding", "go", "utf-8", "character-encoding"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1457451094, "post_id": 35870974, "comment_id": 59406780, "body": "Related / Possible duplicate of <a href=\"http://stackoverflow.com/questions/31651410/go-encoding-transform-issue\">Go encoding transform issue</a>"}], "answers": [{"comments": [{"owner": {"reputation": 405, "user_id": 5460606, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/59d5893c1f82773c41ec9949450b7592?s=128&d=identicon&r=PG&f=1", "display_name": "RandomGuyqwert", "link": "https://stackoverflow.com/users/5460606/randomguyqwert"}, "edited": false, "score": 0, "creation_date": 1457451440, "post_id": 35871514, "comment_id": 59407058, "body": "&quot;Be prepared for all sorts of ugliness and a lot of pain.&quot;  Yeah ... I was hoping to avoid that with Go. I had to deal with that in Python ... Never again. Anyways, thanks for the answer."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 405, "user_id": 5460606, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/59d5893c1f82773c41ec9949450b7592?s=128&d=identicon&r=PG&f=1", "display_name": "RandomGuyqwert", "link": "https://stackoverflow.com/users/5460606/randomguyqwert"}, "edited": false, "score": 0, "creation_date": 1457452699, "post_id": 35871514, "comment_id": 59408032, "body": "As mat sated in <a href=\"http://stackoverflow.com/questions/31651410/go-encoding-transform-issue\" title=\"go encoding transform issue\">stackoverflow.com/questions/31651410/&hellip;</a> some pain might be relieved by golang.org/x/net/html/charset ."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 1, "last_activity_date": 1457451151, "creation_date": 1457451151, "answer_id": 35871514, "question_id": 35870974, "link": "https://stackoverflow.com/questions/35870974/go-and-utf-8-encoding-is-conversion-automatic/35871514#35871514", "title": "Go and UTF-8 encoding - Is conversion automatic?", "body": "<p>What <code>ioutil.ReadAll</code> reads will be written with <code>ioutil.WriteFile</code> without any conversions whatsoever.</p>\n\n<p>If you want to force UTF-8 encoded you will have to do the de-/encoding yourself, e.g. with the help of <code>golang.org/x/text/encoding{,/charmap}</code> and/or the <code>unicode/utf{8,16}</code> packages.</p>\n\n<p>Be prepared for all sorts of ugliness and a lot of pain.</p>\n"}], "owner": {"reputation": 405, "user_id": 5460606, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/59d5893c1f82773c41ec9949450b7592?s=128&d=identicon&r=PG&f=1", "display_name": "RandomGuyqwert", "link": "https://stackoverflow.com/users/5460606/randomguyqwert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1137, "favorite_count": 0, "accepted_answer_id": 35871514, "answer_count": 1, "score": 1, "last_activity_date": 1457451151, "creation_date": 1457449766, "question_id": 35870974, "link": "https://stackoverflow.com/questions/35870974/go-and-utf-8-encoding-is-conversion-automatic", "title": "Go and UTF-8 encoding - Is conversion automatic?", "body": "<p>I am making http requests using Go.</p>\n\n<pre><code>request, err := http.NewRequest(\"GET\", url, nil)\n</code></pre>\n\n<p>This request, if successful, returns a response.</p>\n\n<pre><code>response, err := client.Do(request)\n</code></pre>\n\n<p>After receiving a response, I want to save the content.</p>\n\n<pre><code>content, err := ioutil.ReadAll(response.Body)\nioutil.WriteFile(destination, content, 0644)\n</code></pre>\n\n<p>I looked at the Headers of the responses.</p>\n\n<pre><code>response.Header.Get(\"Content-Type\")\n</code></pre>\n\n<p>I saw the majority are already UTF-8 encoded, which is good. But there are some that have different encodings. I know Go has built in unicode support. Does that mean that if I write, for example, the content of a big-5 encoded page, it will be automatically converted to utf-8? Or do I need to manually decode using the big-5 encoding and re-encode using utf-8?</p>\n\n<p>Basically, I want to ensure that everything that gets written is utf-8 encoded. What is the best way to achieve this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "dart", "angular"], "comments": [{"owner": {"reputation": 483706, "user_id": 217408, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/IlnZm.jpg?s=128&g=1", "display_name": "G&#252;nter Z&#246;chbauer", "link": "https://stackoverflow.com/users/217408/g%c3%bcnter-z%c3%b6chbauer"}, "edited": false, "score": 4, "creation_date": 1457443300, "post_id": 35868480, "comment_id": 59400806, "body": "What is &quot;application&quot; in &quot;application doesn&#39;t connect to Dart side&quot;? Why would &quot;application&quot; connect to &quot;Dart side&quot;?. If Dart is used on the client (with Angular), then the client has to connect to the server instead of the other way around."}, {"owner": {"reputation": 382, "user_id": 3354604, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LPWCX.jpg?s=128&g=1", "display_name": "EgorkZe", "link": "https://stackoverflow.com/users/3354604/egorkze"}, "reply_to_user": {"reputation": 483706, "user_id": 217408, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/IlnZm.jpg?s=128&g=1", "display_name": "G&#252;nter Z&#246;chbauer", "link": "https://stackoverflow.com/users/217408/g%c3%bcnter-z%c3%b6chbauer"}, "edited": false, "score": 0, "creation_date": 1457443738, "post_id": 35868480, "comment_id": 59401146, "body": "@G&#252;nterZ&#246;chbauer when i go in browser to localhost:8080/ it must call &quot;Hello&quot; handler which describes in web/main.dart but it doesn&#39;t do it, and just redirect to 404"}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "reply_to_user": {"reputation": 483706, "user_id": 217408, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/IlnZm.jpg?s=128&g=1", "display_name": "G&#252;nter Z&#246;chbauer", "link": "https://stackoverflow.com/users/217408/g%c3%bcnter-z%c3%b6chbauer"}, "edited": false, "score": 0, "creation_date": 1457443748, "post_id": 35868480, "comment_id": 59401158, "body": "@G&#252;nterZ&#246;chbauer is right.  Try to localize the issue. First check - is server side is working and responding to HTTP requests (from bwoser by entering URL to address bar, not from Dart). If it works you need to provide some information on how you call the server and what are the error logs. Does the <a href=\"http://localhost:8080/api/hello\" rel=\"nofollow noreferrer\">localhost:8080/api/hello</a> works?"}, {"owner": {"reputation": 382, "user_id": 3354604, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LPWCX.jpg?s=128&g=1", "display_name": "EgorkZe", "link": "https://stackoverflow.com/users/3354604/egorkze"}, "reply_to_user": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 0, "creation_date": 1457444062, "post_id": 35868480, "comment_id": 59401391, "body": "@AlexanderTrakhimenok For example if i enter url &quot;localhost:8080/api/hello&quot; i see json response, it mean &quot;helloWorld&quot; handler was called, but if i go to &quot;localhost:8080/&quot;, Dart must get it and call hello method"}], "answers": [{"comments": [{"owner": {"reputation": 382, "user_id": 3354604, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LPWCX.jpg?s=128&g=1", "display_name": "EgorkZe", "link": "https://stackoverflow.com/users/3354604/egorkze"}, "edited": false, "score": 0, "creation_date": 1457451391, "post_id": 35868802, "comment_id": 59407021, "body": "I added what you say, but it didn&#39;t help( Are there new tutorials for dart angular2 and go?"}, {"owner": {"reputation": 483706, "user_id": 217408, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/IlnZm.jpg?s=128&g=1", "display_name": "G&#252;nter Z&#246;chbauer", "link": "https://stackoverflow.com/users/217408/g%c3%bcnter-z%c3%b6chbauer"}, "reply_to_user": {"reputation": 382, "user_id": 3354604, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LPWCX.jpg?s=128&g=1", "display_name": "EgorkZe", "link": "https://stackoverflow.com/users/3354604/egorkze"}, "edited": false, "score": 1, "creation_date": 1457451439, "post_id": 35868802, "comment_id": 59407056, "body": "I haven&#39;t seen any tutorials for Angular2 and Go."}], "tags": [], "owner": {"reputation": 483706, "user_id": 217408, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/IlnZm.jpg?s=128&g=1", "display_name": "G&#252;nter Z&#246;chbauer", "link": "https://stackoverflow.com/users/217408/g%c3%bcnter-z%c3%b6chbauer"}, "is_accepted": true, "score": 1, "last_activity_date": 1457443864, "creation_date": 1457443864, "answer_id": 35868802, "question_id": 35868480, "link": "https://stackoverflow.com/questions/35868480/cant-run-gollang-backend-with-dart-and-angular2-client/35868802#35868802", "title": "Can&#39;t run GolLang backend with dart and angular2 client", "body": "<p>The tutorial is quite old. You need to switch to <code>HashLocationStrategy</code> (which was the default back then as far as I know).</p>\n\n<p>See <a href=\"https://angular.io/docs/ts/latest/api/router/HashLocationStrategy-class.html\" rel=\"nofollow\">https://angular.io/docs/ts/latest/api/router/HashLocationStrategy-class.html</a></p>\n\n<p>Change </p>\n\n<pre><code>bootstrap(AppComponent);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>bootstrap(AppComponent, [\n  ROUTER_PROVIDERS,\n  provide(LocationStrategy, {useClass: HashLocationStrategy})\n]);\n</code></pre>\n\n<p>You also need to add some additional imports </p>\n\n<pre><code>import 'package:angular2/router.dart'\n    show\n        HashLocationStrategy,\n        LocationStrategy,\n        ROUTER_PROVIDERS;\n</code></pre>\n"}], "owner": {"reputation": 382, "user_id": 3354604, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LPWCX.jpg?s=128&g=1", "display_name": "EgorkZe", "link": "https://stackoverflow.com/users/3354604/egorkze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 35868802, "answer_count": 1, "score": 0, "last_activity_date": 1457443864, "creation_date": 1457443037, "last_edit_date": 1457443788, "question_id": 35868480, "link": "https://stackoverflow.com/questions/35868480/cant-run-gollang-backend-with-dart-and-angular2-client", "title": "Can&#39;t run GolLang backend with dart and angular2 client", "body": "<p>I use this <a href=\"http://www.sanarias.com/blog/615BuildingasimplewebappinGoDartandAngular2\" rel=\"nofollow noreferrer\">tutorial</a> to make a web application with GoLang, Angular2 and Dart, but when i start backend by console command 'backend', and route in browser to \"localhost:8080/\" it must call method from Dart's class \"Hello\" but it doesn't call, and i get 404 error. All code i got from tutorial and didn't change anything. And i can't find any other tutorials. Can you explain me what wrong am i doing?</p>\n\n<p>GoLang code:</p>\n\n<pre><code>func main() {\n   http.Handle(\"/\", http.FileServer(http.Dir(\"./app/web/\")))\n\n   fmt.Println(\"Text\")\n   http.HandleFunc(\"/api/hello\", helloWorld)\n   http.ListenAndServe(\":8080\", nil)\n\n}\nfunc helloWorld(w http.ResponseWriter, r *http.Request) {\n   data := struct {\n       Message string\n   }{\n       \"Hello, World\",\n   }\n\n   if err := json.NewEncoder(w).Encode(data); err != nil {\n       log.Println(err)\n   }\n}\n</code></pre>\n\n<p>and angular dart code:</p>\n\n<pre><code>class AppComponent {\n   Hello hello = new Hello();\n}\n\nclass Hello{\n  String message;\n\n  Hello(){\n\n    HttpRequest.getString('/api/hello')\n        .then((String content) {\n          Map parsedMap = JSON.decode(content);\n          message = parsedMap[\"Message\"];\n        })\n        .catchError((Error error) {\n          print(error.toString());\n        });\n  }\n}\n</code></pre>\n\n<p>and project structure :<a href=\"https://i.stack.imgur.com/jQ5o1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jQ5o1.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 2, "creation_date": 1457439789, "post_id": 35867071, "comment_id": 59398229, "body": "The <code>pass</code> Keyword in Python is something special that is not needed in most programming languages. It is a side-effect of indentation used to structure the code. In Go empty statements stands for itself."}], "answers": [{"comments": [{"owner": {"reputation": 3121, "user_id": 1889327, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/lFDYA.jpg?s=128&g=1", "display_name": "andy", "link": "https://stackoverflow.com/users/1889327/andy"}, "edited": false, "score": 1, "creation_date": 1457439541, "post_id": 35867140, "comment_id": 59398030, "body": "can you make an example about <code>EmptyStmt = .</code> means. I.e., what is the meaning about the tailing dot. :)"}, {"owner": {"reputation": 3121, "user_id": 1889327, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/lFDYA.jpg?s=128&g=1", "display_name": "andy", "link": "https://stackoverflow.com/users/1889327/andy"}, "edited": false, "score": 0, "creation_date": 1457440220, "post_id": 35867140, "comment_id": 59398551, "body": "that&#39;s the answer. :)"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 7, "last_activity_date": 1457440306, "last_edit_date": 1457440306, "creation_date": 1457439304, "answer_id": 35867140, "question_id": 35867071, "link": "https://stackoverflow.com/questions/35867071/what-is-the-empty-statement-in-golang/35867140#35867140", "title": "What is the empty statement in Golang?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Empty_statements\" rel=\"noreferrer\">Empty statements</a></p>\n  \n  <p>The empty statement does nothing.</p>\n  \n  <p>EmptyStmt = .</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Notation\" rel=\"noreferrer\">Notation</a></p>\n  \n  <p>The syntax is specified using Extended Backus-Naur Form (EBNF):</p>\n\n<pre><code>Production  = production_name \"=\" [ Expression ] \".\" .\nExpression  = Alternative { \"|\" Alternative } .\nAlternative = Term { Term } .\nTerm        = production_name | token [ \"\u2026\" token ] | Group | Option | Repetition .\nGroup       = \"(\" Expression \")\" .\nOption      = \"[\" Expression \"]\" .\nRepetition  = \"{\" Expression \"}\" .\n</code></pre>\n  \n  <p>Productions are expressions constructed from terms and the following\n  operators, in increasing precedence:</p>\n\n<pre><code>|   alternation\n()  grouping\n[]  option (0 or 1 times)\n{}  repetition (0 to n times)\n</code></pre>\n  \n  <p>Lower-case production names are used to identify lexical tokens.\n  Non-terminals are in CamelCase. Lexical tokens are enclosed in double\n  quotes \"\" or back quotes ``.</p>\n  \n  <p>The form a \u2026 b represents the set of characters from a through b as\n  alternatives. The horizontal ellipsis \u2026 is also used elsewhere in the\n  spec to informally denote various enumerations or code snippets that\n  are not further specified. The character \u2026 (as opposed to the three\n  characters ...) is not a token of the Go language.</p>\n</blockquote>\n\n<p>The empty statement is empty. In EBNF (<a href=\"https://en.wikipedia.org/wiki/Extended_Backus%E2%80%93Naur_Form\" rel=\"noreferrer\">Extended Backus\u2013Naur Form</a>) form: <code>EmptyStmt = .</code> or an empty string.</p>\n\n<p>For example,</p>\n\n<pre><code>for {\n}\n\nvar no\nif true {\n} else {\n    no = true\n}\n</code></pre>\n"}], "owner": {"reputation": 3121, "user_id": 1889327, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/lFDYA.jpg?s=128&g=1", "display_name": "andy", "link": "https://stackoverflow.com/users/1889327/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4909, "favorite_count": 1, "accepted_answer_id": 35867140, "answer_count": 1, "score": 5, "last_activity_date": 1457440306, "creation_date": 1457439107, "question_id": 35867071, "link": "https://stackoverflow.com/questions/35867071/what-is-the-empty-statement-in-golang", "title": "What is the empty statement in Golang?", "body": "<p>In Python we can use <code>pass</code> clause as an placeholder.<br>\nWhat is the equivalent clause in Golang?<br>\nAn <code>;</code> or something else?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 9, "creation_date": 1457436943, "post_id": 35866221, "comment_id": 59396297, "body": "Because array is not empty. First element of it is an empty string <code>&quot;&quot;</code>."}, {"owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "edited": false, "score": 2, "creation_date": 1457450855, "post_id": 35866221, "comment_id": 59406615, "body": "In cases such as this it&#39;s very useful to try fmt.Printf with &quot;%#v&quot; format string, as it prints out the exact Go representation of the value. In this case. <code>fmt.Printf(&quot;%#v\\n&quot;,test)</code> prints <code>[]string{&quot;&quot;}</code>, which makes it obvious that the slice is not empty, but contains an empty string."}, {"owner": {"reputation": 484, "user_id": 1625818, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b725c0a18612df0fd65bc5a07db00bfd?s=128&d=identicon&r=PG", "display_name": "wybourn", "link": "https://stackoverflow.com/users/1625818/wybourn"}, "edited": false, "score": 0, "creation_date": 1457450911, "post_id": 35866221, "comment_id": 59406651, "body": "Thanks, I&#39;ll remember that for future use."}, {"owner": {"reputation": 1761, "user_id": 4813600, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/D3xtB.jpg?s=128&g=1", "display_name": "alamin", "link": "https://stackoverflow.com/users/4813600/alamin"}, "reply_to_user": {"reputation": 163028, "user_id": 477878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qounX.jpg?s=128&g=1", "display_name": "Joachim Isaksson", "link": "https://stackoverflow.com/users/477878/joachim-isaksson"}, "edited": false, "score": 0, "creation_date": 1543256631, "post_id": 35866221, "comment_id": 93843513, "body": "@JoachimIsaksson I dont understand why it the length will be 2. can you please explain. I have printed the length. it shows length ONE."}], "answers": [{"tags": [], "owner": {"reputation": 484, "user_id": 1625818, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b725c0a18612df0fd65bc5a07db00bfd?s=128&d=identicon&r=PG", "display_name": "wybourn", "link": "https://stackoverflow.com/users/1625818/wybourn"}, "is_accepted": true, "score": 4, "last_activity_date": 1457437155, "creation_date": 1457437155, "answer_id": 35866353, "question_id": 35866221, "link": "https://stackoverflow.com/questions/35866221/why-does-an-empty-array-returned-from-strings-split-have-a-length-of-1-in-golang/35866353#35866353", "title": "Why does an empty array returned from strings.Split have a length of 1 in golang?", "body": "<p>As said in the comments by @u_mulder, the array isn't empty as it contains an empty string.</p>\n"}], "owner": {"reputation": 484, "user_id": 1625818, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b725c0a18612df0fd65bc5a07db00bfd?s=128&d=identicon&r=PG", "display_name": "wybourn", "link": "https://stackoverflow.com/users/1625818/wybourn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1977, "favorite_count": 0, "accepted_answer_id": 35866353, "answer_count": 1, "score": 9, "last_activity_date": 1457437155, "creation_date": 1457436748, "question_id": 35866221, "link": "https://stackoverflow.com/questions/35866221/why-does-an-empty-array-returned-from-strings-split-have-a-length-of-1-in-golang", "title": "Why does an empty array returned from strings.Split have a length of 1 in golang?", "body": "<p>I'm just starting out learning golang, and I've encountered something quite strange. When you get an empty array back from a call to strings.Split, it has a length of one.</p>\n\n<p>Example</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    test := strings.Split(\"\", \",\")\n\n    fmt.Println(test)\n    fmt.Println(len(test))\n}\n</code></pre>\n\n<p>This outputs: </p>\n\n<pre><code>[]\n1\n</code></pre>\n\n<p>Why is this? If this is expected behavior, what is the correct way to check if an array is empty?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["sql", "database", "go", "ovh"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1457450595, "post_id": 35865356, "comment_id": 59406393, "body": "You will also need to import a MySQL driver: <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"nofollow noreferrer\">github.com/go-sql-driver/mysql</a>"}, {"owner": {"reputation": 13, "user_id": 4034784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e671af42d85145e8cafd8254b0564b3d?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime Euss Joke", "link": "https://stackoverflow.com/users/4034784/maxime-euss-joke"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1457461997, "post_id": 35865356, "comment_id": 59413935, "body": "Thank for your answer"}, {"owner": {"reputation": 101, "user_id": 5987281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90f1fc62eef6a6992a58670627bdae1b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Jones", "link": "https://stackoverflow.com/users/5987281/lucas-jones"}, "edited": false, "score": 0, "creation_date": 1457534835, "post_id": 35865356, "comment_id": 59450114, "body": "You are getting the error (&#39;No connection could be made&#39;) because the MySQL instance on your server is not accepting connections. Check that it is running, and see if you can connect with the command line tool from the same machine <code>mysql -u &lt;username&gt; -p&lt;password&gt; -h &lt;host&gt; &lt;database&gt;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4034784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e671af42d85145e8cafd8254b0564b3d?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime Euss Joke", "link": "https://stackoverflow.com/users/4034784/maxime-euss-joke"}, "edited": false, "score": 0, "creation_date": 1457462007, "post_id": 35867715, "comment_id": 59413944, "body": "Thank for your answer"}], "tags": [], "owner": {"reputation": 101, "user_id": 5987281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90f1fc62eef6a6992a58670627bdae1b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Jones", "link": "https://stackoverflow.com/users/5987281/lucas-jones"}, "is_accepted": false, "score": 1, "last_activity_date": 1457440940, "creation_date": 1457440940, "answer_id": 35867715, "question_id": 35865356, "link": "https://stackoverflow.com/questions/35865356/remote-access-ovh-sql-database-from-golang-api/35867715#35867715", "title": "Remote access OVH SQL database from Golang API", "body": "<p><strong>dataSourceName</strong> should be provided in the DSN format:</p>\n\n<pre><code>&lt;username&gt;:&lt;password&gt;@tcp(&lt;host&gt;:&lt;port&gt;)/&lt;database&gt;\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"myuser:password@tcp(127.0.0.1:3306)/mydb\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 4034784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e671af42d85145e8cafd8254b0564b3d?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime Euss Joke", "link": "https://stackoverflow.com/users/4034784/maxime-euss-joke"}, "edited": false, "score": 0, "creation_date": 1458150855, "post_id": 35936513, "comment_id": 59735517, "body": "Ok thank for your answer. But how can I create a local db under win10 if I want to test in local?"}, {"owner": {"reputation": 4216, "user_id": 1447525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f2195fa2db341d08ccdd99736e4867?s=128&d=identicon&r=PG", "display_name": "Maresh", "link": "https://stackoverflow.com/users/1447525/maresh"}, "reply_to_user": {"reputation": 13, "user_id": 4034784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e671af42d85145e8cafd8254b0564b3d?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime Euss Joke", "link": "https://stackoverflow.com/users/4034784/maxime-euss-joke"}, "edited": false, "score": 0, "creation_date": 1458151754, "post_id": 35936513, "comment_id": 59736063, "body": "Ah, I figured you were already running that locally, then I guess the connection string password is not the problem unless your remote DB has no password which would be kinda unsafe. I never use windows for working (i find it horrible TBH) so I can&#39;t help you there sorry."}], "tags": [], "owner": {"reputation": 4216, "user_id": 1447525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f2195fa2db341d08ccdd99736e4867?s=128&d=identicon&r=PG", "display_name": "Maresh", "link": "https://stackoverflow.com/users/1447525/maresh"}, "is_accepted": false, "score": 0, "last_activity_date": 1457688727, "creation_date": 1457688727, "answer_id": 35936513, "question_id": 35865356, "link": "https://stackoverflow.com/questions/35865356/remote-access-ovh-sql-database-from-golang-api/35936513#35936513", "title": "Remote access OVH SQL database from Golang API", "body": "<p>There's a problem in your code, here:</p>\n\n<pre><code>dbi.url = (dbi.user + \":\" + dbi.password + \"@tcp(...\n</code></pre>\n\n<p>This way of building the connection string with the parameters I see above will result in:</p>\n\n<p><code>Emixam23:@tcp..</code>.</p>\n\n<p>With an empty password, which is wrong if we look at the spec:</p>\n\n<pre><code>[username[:password]@][protocol[(address)]]/dbname[?param1=value1&amp;...&amp;paramN=valueN]\n</code></pre>\n\n<p>We see that if no password is required you must not add the \":\"</p>\n\n<p>If the problem persists and the connection string actually matches the correct pattern, test that you can access your DB:</p>\n\n<pre><code>mysql -u Emixam23\n</code></pre>\n\n<p>or with password:</p>\n\n<pre><code>mysql -u Emixam23 -p\n</code></pre>\n\n<p>Then try to access the database to see if your user has the proper pemissions:</p>\n\n<pre><code>&gt; USE mydb; SELECT 1;\n</code></pre>\n\n<p>If you can't even connect:</p>\n\n<p>Check that your port and IP binding are correct:</p>\n\n<pre><code>sudo netstat -antp | grep mysql\n</code></pre>\n\n<p>If not, edit your <code>/etc/mysql/my.cnf</code> accordingly.</p>\n"}], "owner": {"reputation": 13, "user_id": 4034784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e671af42d85145e8cafd8254b0564b3d?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime Euss Joke", "link": "https://stackoverflow.com/users/4034784/maxime-euss-joke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1660, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1457688727, "creation_date": 1457434193, "last_edit_date": 1457523747, "question_id": 35865356, "link": "https://stackoverflow.com/questions/35865356/remote-access-ovh-sql-database-from-golang-api", "title": "Remote access OVH SQL database from Golang API", "body": "<p>I'm making a Golang API to be able to interact with a SQL database from my Android application. The problem I have is the following:</p>\n\n<p>I have a sql database hosted on <a href=\"https://phpmyadmin.ovh.net/\" rel=\"nofollow\">https://phpmyadmin.ovh.net/</a></p>\n\n<p>I'm trying to connect my locale API to this one. According to the documentation:</p>\n\n<pre><code>func Open(driverName, dataSourceName string) (*DB, error)\n</code></pre>\n\n<p>The driverName params would be \"mysql\" isn't it?\nBut, what would be the <strong>dataSourceName</strong> params?</p>\n\n<p>I saw lot of post about Open, however, I don't think I understand how to organize the url string about the dataSourceName params.</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"database/sql\"\n    \"fmt\"\n)\n\nvar db *sql.DB // global variable to share it between main and the HTTP handler\n\nfunc main() {\n\nfmt.Println(\"starting up\")\n\ndb, err := sql.Open(\"mysql\", \"????????????\")\nif err != nil {\n    fmt.Println(\"Error on initializing database connection: %s\", err.Error())\n}\n\nerr = db.Ping()\nif err != nil {\n    fmt.Println(\"Error on opening database connection: %s\", err.Error())\n}\n\nhttp.HandleFunc(\"/\", hello)\nhttp.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>Thank for read &amp; help !</p>\n\n<p><strong>/!\\ EDIT /!\\</strong></p>\n\n<p>So, after your both answers, I tried the code below:</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"net/http\"\n\"database/sql\"\n_ \"github.com/go-sql-driver/mysql\"\n)\n\ntype databaseinfos struct {\nuser string\npassword string\nname string\naddress string\nport string\nurl string\n}\n\nvar db *sql.DB // global variable to share it between main and the HTTP handler\nvar dbi *databaseinfos\n\nfunc main() {\n\ndbi := databaseinfos{\n    user: \"Emixam23\",\n    password: \"\",\n    name: \"mydb\",\n    address: \"127.0.0.1\",\n    port: \"3306\",\n    url: \"\"}\ndbi.url = (dbi.user + \":\" + dbi.password + \"@tcp(\" + dbi.address + \":\" + dbi.port + \")/\" + dbi.name)\n\nfmt.Println(dbi.url)\n\ndb, err := sql.Open(\"mysql\", dbi.url)\nif err != nil {\n    fmt.Println(\"Error on initializing database connection: %s\", err.Error())\n}\n\nerr = db.Ping()\nif err != nil {\n    fmt.Println(\"Error on opening database connection: %s\", err.Error())\n}\n\n/*http.HandleFunc(\"/\", hello)*/\nhttp.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>However, I got an error which is \"Error on opening database connection: %s dial tcp 127.0.0.1:3306: connectex: No connection could be made because the target machine actively refused it.\".</p>\n\n<p>Does the problem comes because of my computer or because of the <strong>dataSourceName</strong> params?</p>\n"}, {"tags": ["go", "maps", "trie"], "comments": [{"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1457427629, "post_id": 35862453, "comment_id": 59390127, "body": "A couple of things: 1) You don&#39;t want to add an entry to a specific node, but to the whole Trie. 2) Typically, you&#39;d implement something like a <code>walk</code> method that takes the next character and returns the corresponding node, you would use it to find a place for the new entry. 3) There are already implementations of a Trie in go. 4) If you want to do it right, use a double array implementation, see <a href=\"http://linux.thai.net/~thep/datrie/datrie.html\" rel=\"nofollow noreferrer\">linux.thai.net/~thep/datrie/datrie.html</a>"}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 2, "creation_date": 1457436869, "post_id": 35862453, "comment_id": 59396252, "body": "You are using multiple receivers in your methods, this won&#39;t work. Use something like: <code>func (root *TrieNode) AddEntry(entry string)</code> if you want to use methods, or <code>func AddEntry(root *TrieNode, entry string)</code> if you want plain functions."}], "owner": {"reputation": 13, "user_id": 5986075, "user_type": "registered", "profile_image": "https://graph.facebook.com/945960912126066/picture?type=large", "display_name": "Antony Zhong", "link": "https://stackoverflow.com/users/5986075/antony-zhong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1587254270, "creation_date": 1457425810, "last_edit_date": 1587254270, "question_id": 35862453, "link": "https://stackoverflow.com/questions/35862453/trie-implementation-in-go-using-maps", "title": "trie implementation in go using maps", "body": "<p>I am trying to implement the Trie data structure using go but I am not that familiar with the language nor using a map and was wondering if there were some tips to how I can factor out some of my recursion so it doesn't look so bad. Also would appreciate it if I could get some help on how to make just the add method better (less lines of code). </p>\n\n<p>Just noticed the problem where the tree itself would never know when a word is added so definitely a solution to that would be great!</p>\n\n<pre><code>// The overall tree\ntype TrieTree struct { \n    root TrieNode\n    count int\n}\n\n// The node for each character inside the tree\ntype TrieNode struct {\n    letter string // this is the value of the current node \n    isWord bool // if this letter + all of its parents make a word set = to true \n    children map[string]*TrieNode // maps children nodes\n}\n\n//method for adding a word into the tree\nfunc (root *TrieNode) AddEntry (entry string) {\n    //in case someone is trying to mess you up\n    if (entry != nil || len(entry) != 0 || root != nil) {\n        entry = strings.ToLower(entry)\n        AddEntryHelper(root, entry, 0)\n    }\n}\n\nfunc (node *TrieNode) AddEntryHelper (entry string, count int) {\n    // the last one and no child yet\n    if(node.children == nil &amp;&amp; count == len(entry)-1) { \n        node.children=(map[string(entry[count])]=TrieNode{string(entry[count]), true, nil})\n    // no children and not last one\n    } else if(node.children == nil &amp;&amp; count != len(entry)-1) { \n        node.children=(map[string(entry[count])]=TrieNode{string(entry[count]), false, nil})\n        AddEntryHelper(node.children[string(entry[count])], entry, count++) \n    // last one and child exist\n    } else if (node.children != nil &amp;&amp; count == len(entry)-1) {\n        node.children[string(entry[count])].isWord = true\n    // children node exists and just need to recurse down\n    } else {\n        AddEntryHelper(node.children[string(entry[count])], entry, count++)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "binary"], "comments": [{"owner": {"reputation": 760, "user_id": 2578506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad0cbfd564375424ce1304a84c256078?s=128&d=identicon&r=PG", "display_name": "factotum", "link": "https://stackoverflow.com/users/2578506/factotum"}, "edited": false, "score": 0, "creation_date": 1457442507, "post_id": 35862444, "comment_id": 59400219, "body": "can you add  sample file with values?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1457443038, "post_id": 35862444, "comment_id": 59400595, "body": "You haven&#39;t provided us with a reproducible error: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "edited": false, "score": 0, "creation_date": 1457475787, "post_id": 35862444, "comment_id": 59421787, "body": "Sounds like you&#39;re getting byte numbers from a string-type. But as peter says; can only tell if there&#39;s more information."}, {"owner": {"reputation": 920, "user_id": 1318584, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f62561cb4ac4b1b719ad7e5bedf18675?s=128&d=identicon&r=PG", "display_name": "cheese5505", "link": "https://stackoverflow.com/users/1318584/cheese5505"}, "reply_to_user": {"reputation": 760, "user_id": 2578506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad0cbfd564375424ce1304a84c256078?s=128&d=identicon&r=PG", "display_name": "factotum", "link": "https://stackoverflow.com/users/2578506/factotum"}, "edited": false, "score": 0, "creation_date": 1457493939, "post_id": 35862444, "comment_id": 59427545, "body": "Thanks guys, I&#39;ve added some example code and a sample file. @msingh"}, {"owner": {"reputation": 1320, "user_id": 4359699, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d7433b53d461a631e4e1cda7017c28db?s=128&d=identicon&r=PG&f=1", "display_name": "hraban", "link": "https://stackoverflow.com/users/4359699/hraban"}, "edited": false, "score": 1, "creation_date": 1474549635, "post_id": 35862444, "comment_id": 66583531, "body": "in case you&#39;re looking for a library that can read opus audio files and streams directly, I wrote one that does just that; <a href=\"https://github.com/hraban/opus\" rel=\"nofollow noreferrer\">github.com/hraban/opus</a>. It will take care of this for you."}, {"owner": {"reputation": 2422, "user_id": 202311, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7408fce5260e98922355385680be0179?s=128&d=identicon&r=PG", "display_name": "IanB", "link": "https://stackoverflow.com/users/202311/ianb"}, "edited": false, "score": 0, "creation_date": 1534906057, "post_id": 35862444, "comment_id": 90868744, "body": "Shouldn&#39;t you be storing your PCM frames into <code>int16</code> rather than <code>uint16</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1762, "user_id": 5120331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTAB.png?s=128&g=1", "display_name": "Corvus Crypto", "link": "https://stackoverflow.com/users/5120331/corvus-crypto"}, "is_accepted": false, "score": 0, "last_activity_date": 1457481354, "last_edit_date": 1457481354, "creation_date": 1457479869, "answer_id": 35880141, "question_id": 35862444, "link": "https://stackoverflow.com/questions/35862444/reading-int16-from-binary-file-in-golang/35880141#35880141", "title": "Reading int16 from binary file in Golang", "body": "<p>It sounds like you are getting encoded bytes. In other words, 1 is becoming 49, etc (depends on the encoding). The way around this is to normalize the byte back to the represented value (e.g. byte-'0') for each byte within the int16. </p>\n\n<p>a possible way you could do this is </p>\n\n<pre><code>a := uint16(((opuslen &amp; 0xff00) &gt;&gt; 8) - '0')\nb := uint16((opuslen &amp; 0x00ff) - '0')\nopuslen = (function to splice together)\n</code></pre>\n\n<p>Though this is a chore, this is what you'd have to do to ensure bytes are not maintaining their encoding. That, or just don't store as a utf/ascii/whatever encoded value. would look funky to a human when cat-ing it, but yeah who cares :)</p>\n\n<p>You'll also notice I changed opuslen to uint just for ease of demonstration. if you expect negative length (to denote compression maybe?) then adjust as needed.</p>\n\n<p>Edit: \nIf you truly are going to be working with encoded bytes, perhaps you should read into a string and use strconv.Atoi, which would make it easier for you since you wouldn't have to write the code yourself to convert.</p>\n"}], "owner": {"reputation": 920, "user_id": 1318584, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f62561cb4ac4b1b719ad7e5bedf18675?s=128&d=identicon&r=PG", "display_name": "cheese5505", "link": "https://stackoverflow.com/users/1318584/cheese5505"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1529, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457493910, "creation_date": 1457425791, "last_edit_date": 1457493910, "question_id": 35862444, "link": "https://stackoverflow.com/questions/35862444/reading-int16-from-binary-file-in-golang", "title": "Reading int16 from binary file in Golang", "body": "<p>I'm currently working on a Golang program which reads a 16-bit integer from stdin. I am expecting a value of between 3 and ~128, however, when I print out the integer value it is completely random, going from 30,000+ to -30,000.</p>\n\n<p>I am doing the same thing in PHP by doing the following:</p>\n\n<pre><code>&lt;?php\n\n$binary = fread($stream, 2);\n$unpacked = unpack('s', $binary);\n$int = reset($unpacked);\n</code></pre>\n\n<p>This works successfully. The Go code that I am working on is located on GitHub here: <a href=\"https://github.com/uniquoooo/dca/blob/decoding/main.go#L502-L536\" rel=\"nofollow\">https://github.com/uniquoooo/dca/blob/decoding/main.go#L502-L536</a></p>\n\n<p>I'm using bash pipes (e.g. <code>cat testfile | command</code>) to pipe the contents into the program.</p>\n\n<p>Here is some testing Golang code:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"encoding/binary\"\n    \"io\"\n    \"os\"\n\n    \"github.com/layeh/gopus\"\n)\n\nfunc main() {\n    OpusDecoder, err := gopus.NewDecoder(48000, 2)\n    if err != nil {\n        panic(err)\n    }\n    _ = OpusDecoder\n\n    dcabuf := bufio.NewReaderSize(os.Stdin, 16384)\n\n    var opuslen uint16\n\n    for {\n        err = binary.Read(dcabuf, binary.LittleEndian, &amp;opuslen)\n        if err != nil {\n            if err == io.EOF || err == io.ErrUnexpectedEOF {\n                return\n            }\n            panic(err)\n        }\n\n        fmt.Println(\"Frame Size:\", opuslen)\n\n        opus := make([]byte, opuslen)\n        err = binary.Read(dcabuf, binary.LittleEndian, &amp;opus)\n        if err != nil {\n            if err == io.EOF || err == io.ErrUnexpectedEOF {\n                return\n            }\n            panic(err)\n        }\n\n        // pcm, err := OpusDecoder.Decode(opus, 1920, false)\n        // if err != nil {\n        //     panic(err)\n        // }\n\n        // err = binary.Write(os.Stdout, binary.LittleEndian, &amp;pcm)\n        // if err != nil {\n        //     if err == io.EOF || err == io.ErrUnexpectedEOF {\n        //         return\n        //     }\n        //     panic(err)\n        // }\n    }\n}\n</code></pre>\n\n<p>I would expect output to be similar to <code>Frame Size: 128</code> but the value is a lot higher.</p>\n\n<p>I have uploaded a test file on my Google Drive here: <a href=\"https://drive.google.com/file/d/0B_559nfSNrcfMUNhbWdJMGptZGs/view?usp=sharing\" rel=\"nofollow\">https://drive.google.com/file/d/0B_559nfSNrcfMUNhbWdJMGptZGs/view?usp=sharing</a></p>\n\n<p>To run the program, build it with <code>go build</code> and then run like this:</p>\n\n<pre><code>cat test.dca | ./main\n</code></pre>\n\n<p>The executable name may be different.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 1245, "user_id": 2343398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f6ae55829560a4852a675f25e1729a3d?s=128&d=identicon&r=PG", "display_name": "user2343398", "link": "https://stackoverflow.com/users/2343398/user2343398"}, "reply_to_user": {"reputation": 87200, "user_id": 122005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MX2CF.jpg?s=128&g=1", "display_name": "chridam", "link": "https://stackoverflow.com/users/122005/chridam"}, "edited": false, "score": 0, "creation_date": 1457426772, "post_id": 35861602, "comment_id": 59389616, "body": "It&#39;s ISODate (2016-03-01T17:14:00.000Z)"}, {"owner": {"reputation": 43776, "user_id": 5031275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h8FTg.png?s=128&g=1", "display_name": "Blakes Seven", "link": "https://stackoverflow.com/users/5031275/blakes-seven"}, "edited": false, "score": 0, "creation_date": 1457429227, "post_id": 35861602, "comment_id": 59391140, "body": "It seems you got the code from that question but you misread the <code>$minute</code> which is acutally an aggregation operator, where you have interpreted it as a field. So the BSON here does not match the form, and why you don&#39;t get the correct result."}, {"owner": {"reputation": 1245, "user_id": 2343398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f6ae55829560a4852a675f25e1729a3d?s=128&d=identicon&r=PG", "display_name": "user2343398", "link": "https://stackoverflow.com/users/2343398/user2343398"}, "reply_to_user": {"reputation": 43776, "user_id": 5031275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h8FTg.png?s=128&g=1", "display_name": "Blakes Seven", "link": "https://stackoverflow.com/users/5031275/blakes-seven"}, "edited": false, "score": 0, "creation_date": 1457473763, "post_id": 35861602, "comment_id": 59420705, "body": "I got code from &quot;duplicate&quot; question, some other sources and mongodb manual - so I made my own version with all those :)."}, {"owner": {"reputation": 43776, "user_id": 5031275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h8FTg.png?s=128&g=1", "display_name": "Blakes Seven", "link": "https://stackoverflow.com/users/5031275/blakes-seven"}, "edited": false, "score": 0, "creation_date": 1457474694, "post_id": 35861602, "comment_id": 59421227, "body": "And that is where you went wrong. By following the example you would have arrived at the correct interval. You only got an incorrect result because you deviated from what was there and misinterpreted the purpose of the operators used. That&#39;s the lesson."}, {"owner": {"reputation": 1245, "user_id": 2343398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f6ae55829560a4852a675f25e1729a3d?s=128&d=identicon&r=PG", "display_name": "user2343398", "link": "https://stackoverflow.com/users/2343398/user2343398"}, "reply_to_user": {"reputation": 43776, "user_id": 5031275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h8FTg.png?s=128&g=1", "display_name": "Blakes Seven", "link": "https://stackoverflow.com/users/5031275/blakes-seven"}, "edited": false, "score": 0, "creation_date": 1457478082, "post_id": 35861602, "comment_id": 59422761, "body": "Well I had trouble also translating those structure to GO correctly, which caused creation of my version. Getting <code>{ &quot;$mod&quot;: [{ &quot;$minute&quot;: &quot;$timestamp&quot;, 15 }] }</code> to <code>bson.M{ &quot;$mod&quot;: []interface{}{ bson.M{&quot;$minute&quot;: &quot;$timestamp&quot;,},5,},},</code> wasn&#39;t so easy for me. Hope this helps to somebody else also."}], "answers": [{"comments": [{"owner": {"reputation": 43776, "user_id": 5031275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h8FTg.png?s=128&g=1", "display_name": "Blakes Seven", "link": "https://stackoverflow.com/users/5031275/blakes-seven"}, "edited": false, "score": 2, "creation_date": 1457429232, "post_id": 35863155, "comment_id": 59391143, "body": "Noting the lacking citation to where the code comes from. Being another question with pretty much the same title: <a href=\"http://stackoverflow.com/questions/26814427/group-result-by-15-minutes-time-interval-in-mongodb\">&quot; Group result by 15 minutes time interval in MongoDb&quot;</a>"}, {"owner": {"reputation": 1245, "user_id": 2343398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f6ae55829560a4852a675f25e1729a3d?s=128&d=identicon&r=PG", "display_name": "user2343398", "link": "https://stackoverflow.com/users/2343398/user2343398"}, "edited": false, "score": 1, "creation_date": 1457509234, "post_id": 35863155, "comment_id": 59433005, "body": "note: <code>{ &quot;$mod&quot;: [{ &quot;$minute&quot;: &quot;$timestamp&quot;, 15 }] }</code> is <code>bson.M{ &quot;$mod&quot;: []interface{}{ bson.M{&quot;$minute&quot;: &quot;$timestamp&quot;,},5,},},</code> in golang"}, {"owner": {"reputation": 2675, "user_id": 3896501, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b51303bba9ba5d45cf0a4fe20ab7a586?s=128&d=identicon&r=PG&f=1", "display_name": "user3896501", "link": "https://stackoverflow.com/users/3896501/user3896501"}, "edited": false, "score": 1, "creation_date": 1584379901, "post_id": 35863155, "comment_id": 107413920, "body": "totally copied from <a href=\"https://stackoverflow.com/questions/26814427/group-result-by-15-minutes-time-interval-in-mongodb\" title=\"group result by 15 minutes time interval in mongodb\">stackoverflow.com/questions/26814427/&hellip;</a>"}], "tags": [], "owner": {"reputation": 87200, "user_id": 122005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MX2CF.jpg?s=128&g=1", "display_name": "chridam", "link": "https://stackoverflow.com/users/122005/chridam"}, "is_accepted": true, "score": -1, "last_activity_date": 1475067811, "last_edit_date": 1475067811, "creation_date": 1457428059, "answer_id": 35863155, "question_id": 35861602, "link": "https://stackoverflow.com/questions/35861602/aggregate-group-by-time-of-intervals-of-15-minutes/35863155#35863155", "title": "aggregate group by time of intervals of 15 minutes", "body": "<p>Running the following pipeline in mongo shell should give you the correct result:</p>\n\n<pre><code>pipeline = [\n    { \n        \"$group\": {\n            \"_id\": {\n                \"year\": { \"$year\": \"$timestamp\" },\n                \"dayOfYear\": { \"$dayOfYear\": \"$timestamp\" },\n                \"minute_interval\": {\n                    \"$subtract\": [ \n                        { \"$minute\": \"$timestamp\" },\n                        { \"$mod\": [{ \"$minute\": \"$timestamp\" }, 15] }\n                    ]\n                }\n            },\n            \"averageSpeed\": { \"$avg\": \"$speed\" }\n        }\n    }\n]\ndb.collection.aggregate(pipeline)\n</code></pre>\n\n<hr>\n\n<p>of which the equivalent mGo expression follows (untested):</p>\n\n<pre><code>pipeline := []bson.D{   \n    bson.M{\n        \"$group\": bson.M{\n            \"_id\": bson.M{\n                \"year\": bson.M{ \"$year\": \"$timestamp\" },\n                \"dayOfYear\": bson.M{ \"$dayOfYear\": \"$timestamp\" },\n                \"minute_interval\": bson.M{\n                    \"$subtract\": []interface{}{ \n                        bson.M{ \"$minute\": \"$timestamp\" },\n                        bson.M{ \"$mod\": []interface{}{ bson.M{ \"$minute\": \"$timestamp\" }, 15, }, } }\n                    }\n                }\n            },\n            \"averageSpeed\": bson.M{ \"$avg\": \"$speed\" }\n        }\n    }\n}\n\npipe := collection.Pipe(pipeline)\niter := pipe.Iter()\n</code></pre>\n"}], "owner": {"reputation": 1245, "user_id": 2343398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f6ae55829560a4852a675f25e1729a3d?s=128&d=identicon&r=PG", "display_name": "user2343398", "link": "https://stackoverflow.com/users/2343398/user2343398"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1898, "favorite_count": 0, "closed_date": 1457429382, "accepted_answer_id": 35863155, "answer_count": 1, "score": 1, "last_activity_date": 1475067811, "creation_date": 1457422652, "last_edit_date": 1457426810, "question_id": 35861602, "link": "https://stackoverflow.com/questions/35861602/aggregate-group-by-time-of-intervals-of-15-minutes", "closed_reason": "Duplicate", "title": "aggregate group by time of intervals of 15 minutes", "body": "<p>I'm trying to calculate average speed of data for 15 minutes. I get the result back, it contains average speed, but not sure it's correct and for 15 minute sets, also <code>minutes</code> is nil.</p>\n\n<pre><code>o3 := bson.M{\n    \"$group\": bson.M{\n        \"_id\": bson.M{\n            \"minute\": bson.M{\n                \"$subtract\": []interface{}{\n                    \"$timestamp\",\n                    bson.M{\n                        \"$mod\": []interface{}{\n                            \"$minute\",\n                            15,\n                        },\n                    },\n                },\n            },\n        },\n        \"averageSpeed\": bson.M{\n            \"$avg\": \"$speed\",\n        },\n    },\n}\n</code></pre>\n\n<p>Anyone done something similar or can help?</p>\n\n<p>EDIT: $timestamp field is ISODate format and Date type</p>\n\n<p>Thank you</p>\n"}, {"tags": ["go", "oauth-2.0", "request", "google-oauth", "token"], "comments": [{"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 1, "creation_date": 1457420818, "post_id": 35860811, "comment_id": 59386536, "body": "Did you defined the <code>code</code> url parameter? I cannot find it."}, {"owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "reply_to_user": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1457422278, "post_id": 35860811, "comment_id": 59387225, "body": "@SimoEndre How can I define it?"}], "answers": [{"comments": [{"owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "edited": false, "score": 0, "creation_date": 1457425408, "post_id": 35861876, "comment_id": 59388795, "body": "I&#39;ve been learning how to use Google OAuth2. I haven&#39;t got it: How can I include or declared it specifically?"}, {"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "reply_to_user": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "edited": false, "score": 1, "creation_date": 1457426456, "post_id": 35861876, "comment_id": 59389409, "body": "The error is not related to Google OAuth2. It&#39;s related how you are trying to parse a url parameter. The error says that you are trying to access the  <code>code</code> parameter form the url, but this one is not existing.  Check this ones: <a href=\"https://golang.org/pkg/net/url/#URL.Query\" rel=\"nofollow noreferrer\">golang.org/pkg/net/url/#URL.Query</a>, <a href=\"https://golang.org/pkg/net/url/#Values.Get\" rel=\"nofollow noreferrer\">golang.org/pkg/net/url/#Values.Get</a>"}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": true, "score": 1, "last_activity_date": 1457423664, "creation_date": 1457423664, "answer_id": 35861876, "question_id": 35860811, "link": "https://stackoverflow.com/questions/35860811/oauth2-cannot-fetch-token-bad-request/35861876#35861876", "title": "oauth2 cannot fetch token: bad request", "body": "<p>You are trying to access an url parameter (<code>code</code>) which is not defined in your url.</p>\n\n<p><code>r.URL.Query().Get()</code> returns an url parameter defined in the url address. In your case you are searching for <code>code</code> param, which is missing.</p>\n\n<p>Checking the <a href=\"https://godoc.org/golang.org/x/oauth2#Config.Exchange\" rel=\"nofollow\"><code>Exchange</code></a> method, this converts an authorization code into a token.</p>\n\n<pre><code>func (c *Config) Exchange(ctx context.Context, code string) (*Token, error).\n</code></pre>\n\n<p>The token in your case is an url parameter, but it's not declared. To sum up please include the token string in the url as a parameter otherwise declare somewhere in your code.</p>\n"}], "owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4302, "favorite_count": 0, "accepted_answer_id": 35861876, "answer_count": 1, "score": 1, "last_activity_date": 1457423664, "creation_date": 1457419686, "question_id": 35860811, "link": "https://stackoverflow.com/questions/35860811/oauth2-cannot-fetch-token-bad-request", "title": "oauth2 cannot fetch token: bad request", "body": "<p>I write a handler so that when accessing the route <code>/auth/google/callback</code>, I try to login with Google account through OAuth2. The handler is implemented like this:</p>\n\n<pre><code>package route\n\nimport (\n    \"net/http\"\n    \"golang.org/x/oauth2\"\n    \"golang.org/x/oauth2/google\"\n    \"fmt\"\n)\n\nfunc GoogleOAuthHandler(w http.ResponseWriter, r *http.Request) {\n    conf:=&amp;oauth2.Config{\n        ClientID:\"myclientid\",\n        ClientSecret:\"myclientsecret\",\n        RedirectURL:\"http://localhost:3000\",\n        Scopes:[]string{\n            \"https://www.googleapis.com/auth/userinfo.profile\",\n            \"https://www.googleapis.com/auth/userinfo.email\",\n        },\n        Endpoint:google.Endpoint,\n    }\n\n    code := r.URL.Query().Get(\"code\")\n\n    token, err := conf.Exchange(oauth2.NoContext, code)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    fmt.Println(token)\n\n    http.Redirect(w, r, \"/\", http.StatusMovedPermanently)\n}\n</code></pre>\n\n<p>In <code>func main()</code>, <code>http.HandleFunc(\"/auth/google/callback\",route.GoogleOAuthHandler)</code> is setup</p>\n\n<p>When I access that path, it throws an error like this on browser:</p>\n\n<pre><code>oauth2: cannot fetch token: 400 Bad Request\nResponse: {\n  \"error\" : \"invalid_request\",\n  \"error_description\" : \"Missing required parameter: code\"\n}\n</code></pre>\n\n<p>Did I miss something? Please instruct me to make a proper access to OAuth2 and get token and information from Google account</p>\n"}, {"tags": ["go", "pprof"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1457448358, "post_id": 35860642, "comment_id": 59404626, "body": "notes: don&#39;t use <code>ab</code>, it&#39;s not good, and can&#39;t keep up with a basic go server. A CPU profile does  not specifically measure &quot;computing time&quot;. pprof is a sampling profiler, and you&#39;re counting samples."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1457448444, "post_id": 35860642, "comment_id": 59404698, "body": "Also, you created the <code>xxx.prof</code> file in your second example, but named it <code>x.cpuprofile</code>"}], "answers": [{"tags": [], "owner": {"reputation": 15124, "user_id": 144969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a12d286134563e628089f733b946a00?s=128&d=identicon&r=PG", "display_name": "Dimitar Dimitrov", "link": "https://stackoverflow.com/users/144969/dimitar-dimitrov"}, "is_accepted": true, "score": 1, "last_activity_date": 1457448342, "creation_date": 1457448342, "answer_id": 35870431, "question_id": 35860642, "link": "https://stackoverflow.com/questions/35860642/golang-how-to-get-computing-time-using-pprof-within-a-web-server/35870431#35870431", "title": "Golang: How to get computing time using pprof within a web server", "body": "<p>I've had success using Dmitry's advice from here: <a href=\"https://software.intel.com/en-us/blogs/2014/05/10/debugging-performance-issues-in-go-programs\" rel=\"nofollow\">https://software.intel.com/en-us/blogs/2014/05/10/debugging-performance-issues-in-go-programs</a></p>\n\n<blockquote>\n  <p>You merely need to import net/http/pprof, and collect profiles with:</p>\n  \n  <p>$ go tool pprof --text mybin <a href=\"http://myserver:6060:/debug/pprof/profile\" rel=\"nofollow\">http://myserver:6060:/debug/pprof/profile</a></p>\n</blockquote>\n\n<p>The net/http/pprof is imported solely for its side effects, so you can use </p>\n\n<pre><code>import (\n   ...\n   _ \"net/http/pprof\"\n)\n</code></pre>\n\n<p>Aside from \"mybin\" and \"myserver\" you also need to substitute your port number in and remove the trailing colons after the port number.\nE.g. for my pet project, the command is</p>\n\n<pre><code>go tool pprof http://127.0.0.1:8000/debug/pprof/profile\n</code></pre>\n\n<p>You'll then get a pprof archive created which you can explore interactively through pprof, or you can use an external tool - personally I prefer the built-in capabilities.</p>\n\n<p><em>Note that <a href=\"https://github.com/golang/go/issues/13841\" rel=\"nofollow\">https://github.com/golang/go/issues/13841</a> and <a href=\"https://github.com/golang/go/issues/6047\" rel=\"nofollow\">https://github.com/golang/go/issues/6047</a> are existing problems with the combination of pprof and some kernels.</em></p>\n"}], "owner": {"reputation": 141, "user_id": 6029027, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ac9c83841db833d09ea9bfaf8d72d42?s=128&d=identicon&r=PG&f=1", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/6029027/wyatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1230, "favorite_count": 0, "accepted_answer_id": 35870431, "answer_count": 1, "score": 1, "last_activity_date": 1457448342, "creation_date": 1457419011, "question_id": 35860642, "link": "https://stackoverflow.com/questions/35860642/golang-how-to-get-computing-time-using-pprof-within-a-web-server", "title": "Golang: How to get computing time using pprof within a web server", "body": "<p>I have built a web server and did an <strong>ab(apache benchmark)</strong> test. Now I want to know the computing time of each part.</p>\n\n<p>I used the <code>go tool pprof url:port/xxx</code> and get the profile of this program, but it does not tell me the computing time(only has memory). Following is the results:</p>\n\n<pre><code>(pprof) top10\n1827.59MB of 1978.12MB total (92.39%)\nDropped 175 nodes (cum &lt;= 9.89MB)\nShowing top 10 nodes out of 48 (cum &gt;= 43.50MB)\n  flat  flat%   sum%        cum   cum%\n  769.54MB 38.90% 38.90%   769.54MB 38.90%  reflect.unsafe_New\n  459.08MB 23.21% 62.11%   459.08MB 23.21%  services/semanticnew.TopicProbCounter.Update\n  189.17MB  9.56% 71.67%  1081.21MB 54.66% github.com/golang/protobuf/proto.(*Buffer).dec_slice_struct\n  122MB  6.17% 77.84%      122MB  6.17%  github.com/golang/protobuf/proto.(*Buffer).dec_int32\n  107.56MB  5.44% 83.28%   107.56MB  5.44% github.com/garyburd/redigo/redis.(*conn).readReply\n  68.13MB  3.44% 86.72%   527.21MB 26.65%  services/semanticnew.caculApPoiScore\n\n  40.51MB  2.05% 88.77%    40.51MB  2.05%  runtime.malg\n  28.59MB  1.45% 90.22%    28.59MB  1.45%  net/http.newBufioWriterSize\n  22.50MB  1.14% 91.35%       23MB  1.16%  redismanage.(*Manager).getRequest\n  20.50MB  1.04% 92.39%    43.50MB  2.20%  redismanage.(*Manager).GetRequest\n</code></pre>\n\n<p>In my web program, I have added the following code:</p>\n\n<pre><code>f, _ := os.Create(\"x.cpuprofile\")\npprof.StartCPUProfile(f)\ndefer pprof.StopCPUProfile()\n</code></pre>\n\n<p>but it still does not work.</p>\n\n<p>I have checked <a href=\"http://blog.golang.org/profiling-go-programs\" rel=\"nofollow\">http://blog.golang.org/profiling-go-programs</a>, but the <code>xxx.prof</code> file confused me. How can I generate this <code>xxx.prof</code> file? And the author used <code>go tool pprof xxx xxx.prof</code>, does it mean that <code>xxx</code> is the binary file which generated by <code>xxx.go</code>? </p>\n\n<p>Anyway, the target is getting the computing time, but how? Do I have to generate this <code>xxx.prof</code> file to achieve this goal?</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["templates", "go"], "answers": [{"tags": [], "owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "is_accepted": true, "score": 0, "last_activity_date": 1457417248, "creation_date": 1457417248, "answer_id": 35860194, "question_id": 35858441, "link": "https://stackoverflow.com/questions/35858441/can-i-use-a-template-variable-in-another-template-in-golang/35860194#35860194", "title": "Can I use a template variable in another template in Golang?", "body": "<p>From reading all the documentation. The answer seems to be <em>no</em>. When a template is executed before being embedded into another, that variable is gone and if its value is used in the template, it appears as static text.</p>\n\n<p>In the example of template <em>one</em>, <code>$var</code> isn't used anywhere, so it is thrown away.</p>\n\n<p>The order of execution would be.</p>\n\n<ol>\n<li>Load both templates.</li>\n<li>Template <em>one</em> is executed, throwing <code>$var</code> away because it wasn't used.</li>\n<li>Template <em>two</em> is executed, embedding the result of template <em>one</em> in it.</li>\n</ol>\n\n<p>If this explanation is incorrect. Please comment or edit it.</p>\n\n<p>But the answer to my question is that the standard templating library doesn't pass template variables between templates. They are meant for local use.</p>\n"}], "owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 35860194, "answer_count": 1, "score": 0, "last_activity_date": 1457417248, "creation_date": 1457408067, "question_id": 35858441, "link": "https://stackoverflow.com/questions/35858441/can-i-use-a-template-variable-in-another-template-in-golang", "title": "Can I use a template variable in another template in Golang?", "body": "<p>Template 1</p>\n\n<pre><code>{{define \"one\"}}\n  {{ $var := \"Hello\"}}\n{{end}}\n</code></pre>\n\n<p>Template 2</p>\n\n<pre><code>{{define \"two\"}}\n  {{template \"one\"}}\n  Say, {{print $var}}\n{{end}}\n</code></pre>\n\n<p>I know the above example isn't valid. But is there a way to use the variable of <code>\"one\"</code> template into <code>\"two\"</code> template?</p>\n"}, {"tags": ["debugging", "go", "delve"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1457401892, "post_id": 35856911, "comment_id": 59380467, "body": "Not really an answer, but you can try to use a UI, visual studio code&#39;s <a href=\"https://github.com/Microsoft/vscode-go\" rel=\"nofollow noreferrer\">Go</a> plugin has excellent support for delve."}, {"owner": {"reputation": 1059, "user_id": 2304441, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/n2dEA.jpg?s=128&g=1", "display_name": "benbot", "link": "https://stackoverflow.com/users/2304441/benbot"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1457409030, "post_id": 35856911, "comment_id": 59382259, "body": "I&#39;m running on linux so... so visual studio for me :("}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1457410093, "post_id": 35856911, "comment_id": 59382547, "body": "I think <code>break .&#47;otherfile.go:200</code> should work. If not this is probably a bug. See <a href=\"https://github.com/derekparker/delve/wiki/Location-specifiers\" rel=\"nofollow noreferrer\">github.com/derekparker/delve/wiki/Location-specifiers</a>"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1457411617, "post_id": 35856911, "comment_id": 59383035, "body": "vscode runs great on Linux, I&#39;m using it on Arch Linux right now. <a href=\"https://code.visualstudio.com/\" rel=\"nofollow noreferrer\">code.visualstudio.com</a>"}, {"owner": {"reputation": 1059, "user_id": 2304441, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/n2dEA.jpg?s=128&g=1", "display_name": "benbot", "link": "https://stackoverflow.com/users/2304441/benbot"}, "edited": false, "score": 0, "creation_date": 1457447606, "post_id": 35856911, "comment_id": 59404037, "body": "Really?!? I haven&#39;t looked at visual studio years. When did they add Linux support?"}, {"owner": {"reputation": 1017, "user_id": 956051, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1d763a82d19a257158887b612ebd6acb?s=128&d=identicon&r=PG", "display_name": "Lars", "link": "https://stackoverflow.com/users/956051/lars"}, "edited": false, "score": 1, "creation_date": 1462382349, "post_id": 35856911, "comment_id": 61618332, "body": "It&#39;s not Visual Studio, it&#39;s Visual Studio Code - think Atom... or Sublime text editor - <a href=\"https://code.visualstudio.com/\" rel=\"nofollow noreferrer\">code.visualstudio.com</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4670, "user_id": 1204312, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/27761f40eab7ee7ee015ccd60ad2ab88?s=128&d=identicon&r=PG", "display_name": "shriek", "link": "https://stackoverflow.com/users/1204312/shriek"}, "edited": false, "score": 0, "creation_date": 1487855550, "post_id": 42357327, "comment_id": 71978718, "body": "I was just about to open up a question asking for something that&#39;s similar to <code>debugger</code> in node. I&#39;m glad this exists in go too."}], "tags": [], "owner": {"reputation": 955, "user_id": 5056865, "user_type": "registered", "profile_image": "https://graph.facebook.com/1602911066615024/picture?type=large", "display_name": "Alejandro Serret", "link": "https://stackoverflow.com/users/5056865/alejandro-serret"}, "is_accepted": false, "score": 28, "last_activity_date": 1487688493, "last_edit_date": 1487688493, "creation_date": 1487642039, "answer_id": 42357327, "question_id": 35856911, "link": "https://stackoverflow.com/questions/35856911/how-can-i-set-breakpoints-by-the-sourcefile-line-number-in-delve/42357327#42357327", "title": "How can I set breakpoints by the sourcefile line number in Delve?", "body": "<p>In your Source code type </p>\n\n<pre><code>  runtime.Breakpoint()\n</code></pre>\n\n<p>type in the CLI </p>\n\n<blockquote>\n  <p>dlv test</p>\n</blockquote>\n\n<p>and then </p>\n\n<blockquote>\n  <p>continue</p>\n</blockquote>\n\n<p>The program will stop in the line of code where you set the breakpoint.</p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 1638035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0acfdef735910c2f9f5c731acdfbc85?s=128&d=identicon&r=PG", "display_name": "Wari Wahab", "link": "https://stackoverflow.com/users/1638035/wari-wahab"}, "is_accepted": false, "score": 5, "last_activity_date": 1560154993, "creation_date": 1560154993, "answer_id": 56522860, "question_id": 35856911, "link": "https://stackoverflow.com/questions/35856911/how-can-i-set-breakpoints-by-the-sourcefile-line-number-in-delve/56522860#56522860", "title": "How can I set breakpoints by the sourcefile line number in Delve?", "body": "<p>The following is valid in delve:</p>\n\n<pre><code>(dlv) break &lt;breakpoint_name&gt; &lt;filename_pattern&gt;:&lt;line_number&gt;\n</code></pre>\n\n<p>If you have ambiguous filenames, say <code>main.go</code> spread all over your sources and possibly vendor directory, just make you make it look \"unique\" to delve (filename_pattern is not your exact file location). For example:</p>\n\n<pre><code>(dlv) break myLoopingStuff project_name/loops.go:30\n(dlv) condition myLoopingStuff thing == someOther.thing\n</code></pre>\n"}], "owner": {"reputation": 1059, "user_id": 2304441, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/n2dEA.jpg?s=128&g=1", "display_name": "benbot", "link": "https://stackoverflow.com/users/2304441/benbot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6584, "favorite_count": 6, "answer_count": 2, "score": 14, "last_activity_date": 1560154993, "creation_date": 1457397800, "question_id": 35856911, "link": "https://stackoverflow.com/questions/35856911/how-can-i-set-breakpoints-by-the-sourcefile-line-number-in-delve", "title": "How can I set breakpoints by the sourcefile line number in Delve?", "body": "<p>The title pretty much says it all. </p>\n\n<p>The only way I know how to set one is either during the runtime of the program or just before with <code>breakpoint main.main</code></p>\n\n<p>Is there a way I can do this by line number like <code>breakpoint ./otherfile.go:200</code>?</p>\n"}, {"tags": ["go", "upstart", "launchd", "systemd", "sysv"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 8, "last_activity_date": 1457396974, "last_edit_date": 1457396974, "creation_date": 1457396618, "answer_id": 35856747, "question_id": 35856693, "link": "https://stackoverflow.com/questions/35856693/can-i-import-a-golang-package-based-on-the-os-im-building-for/35856747#35856747", "title": "Can I import a Golang package based on the OS I&#39;m building for?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/go/build/\" rel=\"noreferrer\">Package build</a></p>\n  \n  <p><a href=\"https://golang.org/pkg/go/build/\" rel=\"noreferrer\">Build Constraints</a></p>\n  \n  <p>A build constraint, also known as a build tag, is a line comment that\n  begins</p>\n\n<pre><code>// +build\n</code></pre>\n  \n  <p>that lists the conditions under which a file should be included in the\n  package. Constraints may appear in any kind of source file (not just\n  Go), but they must appear near the top of the file, preceded only by\n  blank lines and other line comments. These rules mean that in Go files\n  a build constraint must appear before the package clause.</p>\n  \n  <p>To distinguish build constraints from package documentation, a series\n  of build constraints must be followed by a blank line.</p>\n  \n  <p>A build constraint is evaluated as the OR of space-separated options;\n  each option evaluates as the AND of its comma-separated terms; and\n  each term is an alphanumeric word or, preceded by !, its negation.\n  That is, the build constraint:</p>\n\n<pre><code>// +build linux,386 darwin,!cgo\n</code></pre>\n  \n  <p>corresponds to the boolean formula:</p>\n\n<pre><code>(linux AND 386) OR (darwin AND (NOT cgo))\n</code></pre>\n  \n  <p>A file may have multiple build constraints. The overall constraint is\n  the AND of the individual constraints. That is, the build constraints:</p>\n\n<pre><code>// +build linux darwin\n// +build 386\n</code></pre>\n  \n  <p>corresponds to the boolean formula:</p>\n\n<pre><code>(linux OR darwin) AND 386\n</code></pre>\n  \n  <p>During a particular build, the following words are satisfied:</p>\n\n<pre><code>- the target operating system, as spelled by runtime.GOOS\n- the target architecture, as spelled by runtime.GOARCH\n- the compiler being used, either \"gc\" or \"gccgo\"\n- \"cgo\", if ctxt.CgoEnabled is true\n- \"go1.1\", from Go version 1.1 onward\n- \"go1.2\", from Go version 1.2 onward\n- \"go1.3\", from Go version 1.3 onward\n- \"go1.4\", from Go version 1.4 onward\n- \"go1.5\", from Go version 1.5 onward\n- \"go1.6\", from Go version 1.6 onward\n- any additional words listed in ctxt.BuildTags\n</code></pre>\n  \n  <p>If a file's name, after stripping the extension and a possible _test\n  suffix, matches any of the following patterns:</p>\n\n<pre><code>*_GOOS\n*_GOARCH\n*_GOOS_GOARCH\n</code></pre>\n  \n  <p>(example: source_windows_amd64.go) where GOOS and GOARCH represent any\n  known operating system and architecture values respectively, then the\n  file is considered to have an implicit build constraint requiring\n  those terms (in addition to any explicit constraints in the file).</p>\n  \n  <p>To keep a file from being considered for the build:</p>\n\n<pre><code>// +build ignore\n</code></pre>\n  \n  <p>(any other unsatisfied word will work as well, but \u201cignore\u201d is\n  conventional.)</p>\n  \n  <p>To build a file only when using cgo, and only on Linux and OS X:</p>\n\n<pre><code>// +build linux,cgo darwin,cgo\n</code></pre>\n  \n  <p>Such a file is usually paired with another file implementing the\n  default functionality for other systems, which in this case would\n  carry the constraint:</p>\n\n<pre><code>// +build !linux,!darwin !cgo\n</code></pre>\n  \n  <p>Naming a file dns_windows.go will cause it to be included only when\n  building the package for Windows; similarly, math_386.s will be\n  included only when building the package for 32-bit x86.</p>\n  \n  <p>Using GOOS=android matches build tags and files as for GOOS=linux in\n  addition to android tags and files.</p>\n</blockquote>\n\n<p>Use build constraints.</p>\n\n<p>Use a single package with multiple files. Each file specializes for a particular OS, architecture, etc, combination.</p>\n"}], "owner": {"reputation": 2324, "user_id": 2272652, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vKcw7.jpg?s=128&g=1", "display_name": "Christian Grabowski", "link": "https://stackoverflow.com/users/2272652/christian-grabowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1874, "favorite_count": 2, "accepted_answer_id": 35856747, "answer_count": 1, "score": 3, "last_activity_date": 1457397131, "creation_date": 1457396277, "last_edit_date": 1457397131, "question_id": 35856693, "link": "https://stackoverflow.com/questions/35856693/can-i-import-a-golang-package-based-on-the-os-im-building-for", "title": "Can I import a Golang package based on the OS I&#39;m building for?", "body": "<p>Say I have a go project that based on which OS, and in some cases which distro, I want to use say a Systemd client package vs an Upstart client package vs a sysv client package vs a launchd client package.  Is it possible to selectively import each package so I only import the one I need per OS/distro I'm building for?  Or do I have to import each package for each OS/distro?</p>\n"}, {"tags": ["go", "linked-list"], "answers": [{"comments": [{"owner": {"reputation": 727, "user_id": 1230453, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0e60ed45232805aeff3c9466ae9a8f48?s=128&d=identicon&r=PG", "display_name": "Long Thai", "link": "https://stackoverflow.com/users/1230453/long-thai"}, "edited": false, "score": 0, "creation_date": 1457390988, "post_id": 35855401, "comment_id": 59376919, "body": "It works! Thank you very much. But can your provide more explanation about the problem in my function. Cheers"}, {"owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "reply_to_user": {"reputation": 727, "user_id": 1230453, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0e60ed45232805aeff3c9466ae9a8f48?s=128&d=identicon&r=PG", "display_name": "Long Thai", "link": "https://stackoverflow.com/users/1230453/long-thai"}, "edited": false, "score": 1, "creation_date": 1457423996, "post_id": 35855401, "comment_id": 59388031, "body": "You explained the problem very well in your original post - <code>I believe that it is caused by cur_node.next = &amp;new_node which only makes the update locally</code>.  The fix is to use a pointer rather than the object, so I just took away one level of indirection."}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": true, "score": 2, "last_activity_date": 1457389755, "creation_date": 1457389755, "answer_id": 35855401, "question_id": 35855130, "link": "https://stackoverflow.com/questions/35855130/insert-item-at-the-end-of-a-linked-list/35855401#35855401", "title": "Insert item at the end of a linked list", "body": "<p>The problem is in your insert function - here is a corrected version</p>\n\n<pre><code>func insert(node_pointer **Node, // pointer to a pointer to a Node\n    value int) {\n    var new_node Node\n    new_node.value = value\n\n    if *node_pointer == nil {\n        fmt.Printf(\"Empty list\\n\")\n        *node_pointer = &amp;new_node\n    } else {\n        var cur_node *Node = *node_pointer\n        for cur_node.next != nil {\n            cur_node = cur_node.next\n        }\n        cur_node.next = &amp;new_node\n        fmt.Printf(\"Add %d\\n\", (*cur_node.next).value)\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/iq3b3KQhtC\" rel=\"nofollow\">Playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 6950, "user_id": 5371821, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/gHZQr.jpg?s=128&g=1", "display_name": "starkshang", "link": "https://stackoverflow.com/users/5371821/starkshang"}, "is_accepted": false, "score": 1, "last_activity_date": 1457417716, "creation_date": 1457417716, "answer_id": 35860330, "question_id": 35855130, "link": "https://stackoverflow.com/questions/35855130/insert-item-at-the-end-of-a-linked-list/35860330#35860330", "title": "Insert item at the end of a linked list", "body": "<p>Your error is because you get the node value,not the pointer here:</p>\n\n<pre><code>    var cur_node Node = **node_pointer\n</code></pre>\n\n<p><code>*note_pointer</code> is a pointer pointed to head of list,but you are using <code>**node_pointer</code>,then you get the value,then copy this value to <code>cur_node</code>, afterwards new node will be append to <code>cur_node</code>,no relevant to head node.So when your print form head node,you can only get the value of the head node.</p>\n\n<p>The fixed solution is like @Nick Craig-Wood said.</p>\n"}], "owner": {"reputation": 727, "user_id": 1230453, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0e60ed45232805aeff3c9466ae9a8f48?s=128&d=identicon&r=PG", "display_name": "Long Thai", "link": "https://stackoverflow.com/users/1230453/long-thai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 35855401, "answer_count": 2, "score": -1, "last_activity_date": 1457417716, "creation_date": 1457388696, "question_id": 35855130, "link": "https://stackoverflow.com/questions/35855130/insert-item-at-the-end-of-a-linked-list", "title": "Insert item at the end of a linked list", "body": "<p>I am very new to go and deicide to implement a linked list. Here is my source code</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Node struct {\n  value int\n  next *Node\n}\n\nfunc main() {\n\n  var head *Node\n  for i := 1; i &lt;= 10; i++ {\n    insert(&amp;head, i)\n  }\n\n  print_list(head)\n}\n\nfunc print_list(node_pointer *Node) {\n  if (node_pointer == nil) {\n    return\n  } else {\n    node := *node_pointer\n    fmt.Printf(\"%d\\n\", node.value)\n    print_list(node.next)\n  }\n}\n\nfunc insert(node_pointer **Node, // pointer to a pointer to a Node\n    value int) {\n  var new_node Node\n  new_node.value = value\n\n  if (*node_pointer == nil) {\n    fmt.Printf(\"Empty list\\n\")\n    *node_pointer = &amp;new_node\n  } else {\n    var cur_node Node = **node_pointer\n    for cur_node.next != nil {\n      cur_node = *cur_node.next\n    }\n    cur_node.next = &amp;new_node\n    fmt.Printf(\"Add %d\\n\", (*cur_node.next).value)      }\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>Empty list\nAdd 2\nAdd 3\nAdd 4\nAdd 5\nAdd 6\nAdd 7\nAdd 8\nAdd 9\nAdd 10\n1\n</code></pre>\n\n<p>In other words, I cannot insert a new Node at the end of the linked list. I believe that it is caused by <code>cur_node.next = &amp;new_node</code> which only makes the update locally, but don't know how to fix this.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 868, "user_id": 1013781, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dc650d6cc1e063dc10115f44d8cf0875?s=128&d=identicon&r=PG", "display_name": "Chris Adams", "link": "https://stackoverflow.com/users/1013781/chris-adams"}, "edited": false, "score": 0, "creation_date": 1457376147, "post_id": 35851380, "comment_id": 59368472, "body": "Oh, great! Didn&#39;t know it was so easy. Thanks!"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1457376219, "last_edit_date": 1457376219, "creation_date": 1457376003, "answer_id": 35851380, "question_id": 35851302, "link": "https://stackoverflow.com/questions/35851302/golang-parse-a-signed-int/35851380#35851380", "title": "Golang: parse a signed int", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc main() {\n    u, err := strconv.ParseUint(\"ff11223344556677\", 16, 64)\n    fmt.Printf(\"%x %v\\n\", u, err)\n    i := int64(u)\n    fmt.Println(i)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>ff11223344556677 &lt;nil&gt;\n-67234915848722825\n</code></pre>\n"}], "owner": {"reputation": 868, "user_id": 1013781, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dc650d6cc1e063dc10115f44d8cf0875?s=128&d=identicon&r=PG", "display_name": "Chris Adams", "link": "https://stackoverflow.com/users/1013781/chris-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1318, "favorite_count": 1, "accepted_answer_id": 35851380, "answer_count": 1, "score": 3, "last_activity_date": 1457376219, "creation_date": 1457375716, "question_id": 35851302, "link": "https://stackoverflow.com/questions/35851302/golang-parse-a-signed-int", "title": "Golang: parse a signed int", "body": "<p>I have some code that needs to be able to parse a string containing a 64-bit value into an int64. For example, <code>ff11223344556677</code> is valid, but a downstream system wants that in an <code>int64</code>.</p>\n\n<p><code>strconv.ParseInt(\"ff11223344556677\", 16, 64)</code> gives a range error - it only likes to parse positive integers. Is there a way to go about putting this value into an int64 even though it is going to be negative?</p>\n"}, {"tags": ["go", "gif", "animated-gif"], "answers": [{"comments": [{"owner": {"reputation": 2428, "user_id": 345350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/50cb4981bbaa51b1713269a29f78d826?s=128&d=identicon&r=PG", "display_name": "donatJ", "link": "https://stackoverflow.com/users/345350/donatj"}, "edited": false, "score": 1, "creation_date": 1590597943, "post_id": 35850754, "comment_id": 109742108, "body": "You can move the quantizer out of the loop, it contains no state other than NumColor so you don&#39;t need to create a new one every iteration."}, {"owner": {"reputation": 6974, "user_id": 199475, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f655f91b22aa5f97fc50936c8b6c0cd7?s=128&d=identicon&r=PG", "display_name": "carbocation", "link": "https://stackoverflow.com/users/199475/carbocation"}, "edited": false, "score": 0, "creation_date": 1594005005, "post_id": 35850754, "comment_id": 110964586, "body": "This was created after your question, but Eric Pauley&#39;s <a href=\"https://github.com/ericpauley/go-quantize/\" rel=\"nofollow noreferrer\">go-quantize</a> is a nice tool for this purpose."}], "tags": [], "owner": {"reputation": 1823, "user_id": 1898520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec06c4a785f136857c2ba2893925d29?s=128&d=identicon&r=PG", "display_name": "Taylor Hughes", "link": "https://stackoverflow.com/users/1898520/taylor-hughes"}, "is_accepted": false, "score": 6, "last_activity_date": 1619174025, "last_edit_date": 1619174025, "creation_date": 1457373861, "answer_id": 35850754, "question_id": 35850753, "link": "https://stackoverflow.com/questions/35850753/how-to-convert-image-rgba-image-image-to-image-paletted/35850754#35850754", "title": "How to convert image.RGBA (image.Image) to image.Paletted?", "body": "<p>It seems an automatic way of intelligently generating palettes is missing from the golang stdlib (correct me if I'm wrong here). But there seems to be a stub for providing your own <code>Quantizer</code>, which led me to the <code>gogif</code> project. (Which was the apparent source of <code>image.Gif</code>.)</p>\n<p>I was able to borrow the <code>MedianCutQuantizer</code> from that project, defined here:</p>\n<p><a href=\"https://github.com/andybons/gogif/blob/master/mediancut.go\" rel=\"nofollow noreferrer\">https://github.com/andybons/gogif/blob/master/mediancut.go</a></p>\n<p>Which results in the following:</p>\n<pre><code>var subimages []image.Image // RGBA, etc. images from somewhere else\n\noutGif := &amp;gif.GIF{}\nfor _, simage := range subimages {\n  bounds := simage.Bounds()\n  palettedImage := image.NewPaletted(bounds, nil)\n  quantizer := gogif.MedianCutQuantizer{NumColor: 64}\n  quantizer.Quantize(palettedImage, bounds, simage, image.ZP)\n\n  // Add new frame to animated GIF\n  outGif.Image = append(outGif.Image, palettedImage)\n  outGif.Delay = append(outGif.Delay, 0)\n}\ngif.EncodeAll(w, outGif)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 755, "user_id": 4654175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zHkjV.png?s=128&g=1", "display_name": "Shubham Sharma", "link": "https://stackoverflow.com/users/4654175/shubham-sharma"}, "edited": false, "score": 2, "creation_date": 1561031469, "post_id": 44710498, "comment_id": 99936152, "body": "Is it just for me or this draw.Draw function takes a <b>lot</b> of time to execute! Is there any workaround for this? For a GIF, I tried using multiple goroutines to encode my GIF but this draw function is a bottleneck!"}, {"owner": {"reputation": 81, "user_id": 8368023, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-seObgVQPcqo/AAAAAAAAAAI/AAAAAAAAESM/G-E0xjbbjR8/photo.jpg?sz=128", "display_name": "Chih-Chen Kao", "link": "https://stackoverflow.com/users/8368023/chih-chen-kao"}, "reply_to_user": {"reputation": 755, "user_id": 4654175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zHkjV.png?s=128&g=1", "display_name": "Shubham Sharma", "link": "https://stackoverflow.com/users/4654175/shubham-sharma"}, "edited": false, "score": 1, "creation_date": 1584904023, "post_id": 44710498, "comment_id": 107577455, "body": "@ShubhamSharma  I also experienced the same on a Mac Pro"}, {"owner": {"reputation": 539, "user_id": 1530494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qztu3.jpg?s=128&g=1", "display_name": "John Starich", "link": "https://stackoverflow.com/users/1530494/john-starich"}, "reply_to_user": {"reputation": 755, "user_id": 4654175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zHkjV.png?s=128&g=1", "display_name": "Shubham Sharma", "link": "https://stackoverflow.com/users/4654175/shubham-sharma"}, "edited": false, "score": 1, "creation_date": 1586124387, "post_id": 44710498, "comment_id": 108005318, "body": "@ShubhamSharma I had the same issue. Turns out the color palette can have a huge effect on performance in Draw. Using gogif.MedianCutQuantizer from Taylor Hughes&#39; answer for a color palette below gave me a big speedup."}], "tags": [], "owner": {"reputation": 66, "user_id": 4628047, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GTLqNXmYG80/AAAAAAAAAAI/AAAAAAAAAEE/XrlGPx1LWww/photo.jpg?sz=128", "display_name": "Mads Sejersen", "link": "https://stackoverflow.com/users/4628047/mads-sejersen"}, "is_accepted": true, "score": 5, "last_activity_date": 1498171764, "creation_date": 1498171764, "answer_id": 44710498, "question_id": 35850753, "link": "https://stackoverflow.com/questions/35850753/how-to-convert-image-rgba-image-image-to-image-paletted/44710498#44710498", "title": "How to convert image.RGBA (image.Image) to image.Paletted?", "body": "<p>Instead of generating your own palette, you can also use on of the predefined (<a href=\"https://golang.org/pkg/image/color/palette/\" rel=\"noreferrer\">https://golang.org/pkg/image/color/palette/</a>)</p>\n\n<pre><code>...\npalettedImage := image.NewPaletted(bounds, palette.Plan9)\ndraw.Draw(palettedImage, palettedImage.Rect, simage, bounds.Min, draw.Over)\n...\n</code></pre>\n"}], "owner": {"reputation": 1823, "user_id": 1898520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec06c4a785f136857c2ba2893925d29?s=128&d=identicon&r=PG", "display_name": "Taylor Hughes", "link": "https://stackoverflow.com/users/1898520/taylor-hughes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3135, "favorite_count": 1, "accepted_answer_id": 44710498, "answer_count": 2, "score": 6, "last_activity_date": 1619174175, "creation_date": 1457373861, "last_edit_date": 1619174175, "question_id": 35850753, "link": "https://stackoverflow.com/questions/35850753/how-to-convert-image-rgba-image-image-to-image-paletted", "title": "How to convert image.RGBA (image.Image) to image.Paletted?", "body": "<p>I'm trying to create an animated GIF from a series of arbitrary non-paletted images. In order to create a paletted image, I need to come up with a palette somehow.</p>\n<pre><code>// RGBA, etc. images from somewhere else\nvar frames []image.Image\n\noutGif := &amp;gif.GIF{}\nfor _, simage := range frames {\n  // TODO: Convert image to paletted image\n  // bounds := simage.Bounds()\n  // palettedImage := image.NewPaletted(bounds, ...)\n\n  // Add new frame to animated GIF\n  outGif.Image = append(outGif.Image, palettedImage)\n  outGif.Delay = append(outGif.Delay, 0)\n}\ngif.EncodeAll(w, outGif)\n</code></pre>\n<p>Is there an easy way in golang stdlib to accomplish this?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 342, "user_id": 5966373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc1d3a765c8c1ed7cca49e04162dc58?s=128&d=identicon&r=PG&f=1", "display_name": "sirwillem", "link": "https://stackoverflow.com/users/5966373/sirwillem"}, "edited": false, "score": 0, "creation_date": 1457373178, "post_id": 35850430, "comment_id": 59366708, "body": "Hmmm... We had this originally, but it seems rather unorganized to keep every file in the project in one folder.  Currently we are already at 50+ files not counting test files.  Also parts of our project are logically independent. Is there a way to create subfolders while maintaining a single package?"}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "reply_to_user": {"reputation": 342, "user_id": 5966373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc1d3a765c8c1ed7cca49e04162dc58?s=128&d=identicon&r=PG&f=1", "display_name": "sirwillem", "link": "https://stackoverflow.com/users/5966373/sirwillem"}, "edited": false, "score": 2, "creation_date": 1457373229, "post_id": 35850430, "comment_id": 59366741, "body": "No. Put them in one folder. Modules are not a code organization tool. They&#39;re a code reuse tool. It is completely normal to have many files in a single directory in Go. You may also be making your files too small. You do not need or desire a single file per type. What you&#39;re thinking of as being appropriate for directories may actually be appropriate for <i>files</i> in Go. Files are the natural code organization tool."}, {"owner": {"reputation": 342, "user_id": 5966373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc1d3a765c8c1ed7cca49e04162dc58?s=128&d=identicon&r=PG&f=1", "display_name": "sirwillem", "link": "https://stackoverflow.com/users/5966373/sirwillem"}, "edited": false, "score": 0, "creation_date": 1457373400, "post_id": 35850430, "comment_id": 59366831, "body": "Alright I guess there is no way around it then.  Thanks!!"}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1457376487, "post_id": 35850430, "comment_id": 59368685, "body": "I would disagree about code organization part. Internal packages are very useful for code organization and pretty much everyone uses them for that. One big advantage - you don&#39;t polute your code with inner details. You have some specific component with internal state and variables. Without packages all of this will be accesible to everything else. That&#39;s just bad. To solve that you put it in a package and make public only what you actually want to be public. It rather looks like a bad practive not to use them just to get around the fact that interface calls are slow."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1457376636, "post_id": 35850430, "comment_id": 59368787, "body": "And if you&#39;re working on something where &quot;every instruction counts&quot; it should be obvious that Go is not the right choice. Most of the time it&#39;s due to GC but if even interface calls are a bottleneck then there is just no place for Go here."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 2, "creation_date": 1457377058, "post_id": 35850430, "comment_id": 59369065, "body": "@creker i&#39;m not sure what you&#39;re talking about. 1. you can always write your hot code in C, C++ or in 1.7 fortrian and call it from cgo. 2. you can write in assembly. 3. there are a lot of ways to optimize around the gc. 4. go1.7 (current tip) optimizer got a LOT better. For example, my pure-go xxhash package is faster than the C version now using Go 1.7&#39;s optimizer."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1457378051, "post_id": 35850430, "comment_id": 59369668, "body": "@OneOfOne, cgo calls are very slow due to how they&#39;re implemented. Only if you can miminize jumping between C and Go. And that doesn&#39;t contradict with my post - Go is generally not suitable for raw performance and that&#39;s exactly why you mention cgo - to do something in a much faster language. You can optimize all you want but general consensus is that Go can&#39;t match C/C++ level of raw performance and probably never will due to presence of GC and the runtime. I understand it, golang team understands it. And the majority of benchmarks proof that. Go has it&#39;s place, C/C++ have their own"}, {"owner": {"reputation": 342, "user_id": 5966373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc1d3a765c8c1ed7cca49e04162dc58?s=128&d=identicon&r=PG&f=1", "display_name": "sirwillem", "link": "https://stackoverflow.com/users/5966373/sirwillem"}, "edited": false, "score": 2, "creation_date": 1457383610, "post_id": 35850430, "comment_id": 59373077, "body": "We are currently trying to get as much as we can out of go because GC is a big advantage for our project.  We have looked into cgo and writing in assembly, both of which are slow due to context switching too often, e.i. not enough time in C.  We wanted to look into Go for maintainability and it&#39;s strong typing.  We know that Go is not the best choice for performance, but it&#39;s other features were worth an exploration into how much performance we could get."}, {"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1457393778, "post_id": 35850430, "comment_id": 59378056, "body": "+1 for &quot;Don&#39;t create them just for code organization&quot;. You end up writing much more code that way, and worrying about exported/unexported identifiers much more often too."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "reply_to_user": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1457399627, "post_id": 35850430, "comment_id": 59379853, "body": "@sargas, how exactly you end up writing much more code? You write exactly like you would without packages. You need to worry only about exporting which is a good thing. Keeps your global scope clean and forces you to better design your components. That&#39;s how you achieve encapsulation which is always a good thing. Don&#39;t remember when throwing everything into the same scope become a good thing."}, {"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 1, "creation_date": 1457400083, "post_id": 35850430, "comment_id": 59379986, "body": "@creker I agree. Also, I&#39;m not suggesting avoiding packages, but avoiding using packages for the sake of &quot;code organization&quot; only. If every little component is put under different packages you then have to start importing them everywhere they are needed and refer to the exported identifiers with <code>package.Identifier</code> rather then just <code>Identifier</code>. This is a little consequence of having many packages for the sake of &quot;code organization&quot;."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "reply_to_user": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1457400854, "post_id": 35850430, "comment_id": 59380201, "body": "@sargas, that doesn&#39;t sound like code organization. More like the lack of it. Code organization is about keeping relevant stuff in separate directories. You can look at <code>godoc</code> source - there&#39;re many internal packages just for code organization. Keeping it all in the same directory would be a mess. In go&#39;s case files no longer work well as code organization tool because there&#39;re no include statements - everything that&#39;s inside a directory is visible no matter how much files there is."}, {"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1457401037, "post_id": 35850430, "comment_id": 59380260, "body": "@creker Again, agreed."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "reply_to_user": {"reputation": 342, "user_id": 5966373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc1d3a765c8c1ed7cca49e04162dc58?s=128&d=identicon&r=PG&f=1", "display_name": "sirwillem", "link": "https://stackoverflow.com/users/5966373/sirwillem"}, "edited": false, "score": 0, "creation_date": 1457410599, "post_id": 35850430, "comment_id": 59382706, "body": "@sirwillem, there is no context switching for calling functions that are written in assembly. Assembly functions cannot be inlined though (at least currently)."}, {"owner": {"reputation": 342, "user_id": 5966373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc1d3a765c8c1ed7cca49e04162dc58?s=128&d=identicon&r=PG&f=1", "display_name": "sirwillem", "link": "https://stackoverflow.com/users/5966373/sirwillem"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1457626704, "post_id": 35850430, "comment_id": 59501886, "body": "@kostya: Yes, You are right. I misspoke.  First I meant the switch between go and C and it is not a context switch because it is not switching between processes, but there is there is an overhead to switch between them.  For example we looked at using C to swap bytes when switching between little and big Endian.  This can be done with one function in C, but the cost of calling C to what amounted to one assembly was too high."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "reply_to_user": {"reputation": 342, "user_id": 5966373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc1d3a765c8c1ed7cca49e04162dc58?s=128&d=identicon&r=PG&f=1", "display_name": "sirwillem", "link": "https://stackoverflow.com/users/5966373/sirwillem"}, "edited": false, "score": 0, "creation_date": 1457670799, "post_id": 35850430, "comment_id": 59521848, "body": "@sirwillem, I think you probably already know this, but I&#39;ll clarify just in case ;) It is possible to write Go functions in assembly without using cgo. There is no overhead of calling such function, but they won&#39;t be inlined (so there is always function call overhead)."}, {"owner": {"reputation": 342, "user_id": 5966373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc1d3a765c8c1ed7cca49e04162dc58?s=128&d=identicon&r=PG&f=1", "display_name": "sirwillem", "link": "https://stackoverflow.com/users/5966373/sirwillem"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1457723491, "post_id": 35850430, "comment_id": 59552717, "body": "@kostya Yes we did look into doing that and it is a good solution.  Thanks for pointing it out!"}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 5, "last_activity_date": 1457372790, "creation_date": 1457372790, "answer_id": 35850430, "question_id": 35850167, "link": "https://stackoverflow.com/questions/35850167/how-do-you-get-the-maximum-performance-from-go-while-using-interfaces/35850430#35850430", "title": "How do you get the maximum performance from Go while using interfaces?", "body": "<p>If you're seeing circular dependencies, that suggests you have your code in separate modules. Move all the code into a single module. Then you shouldn't require an interface. Modules are generally quite large groupings in Go. Don't create them just for code organization.</p>\n"}, {"comments": [{"owner": {"reputation": 342, "user_id": 5966373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc1d3a765c8c1ed7cca49e04162dc58?s=128&d=identicon&r=PG&f=1", "display_name": "sirwillem", "link": "https://stackoverflow.com/users/5966373/sirwillem"}, "edited": false, "score": 0, "creation_date": 1457373464, "post_id": 35850476, "comment_id": 59366877, "body": "Thanks! This is great idea.  Especially if you make the functions their own type"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1457410775, "post_id": 35850476, "comment_id": 59382766, "body": "Would it be really much faster? There is still indirection and these functions cannot be inlined."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1457412056, "post_id": 35850476, "comment_id": 59383157, "body": "@kostya well, depends, on go 1.6 (current release), it&#39;s ~25% faster, on current git though it&#39;s only ~2% faster. <a href=\"http://play.golang.org/p/II_DHdYaLQ\" rel=\"nofollow noreferrer\">playground</a>"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 2, "last_activity_date": 1457372921, "creation_date": 1457372921, "answer_id": 35850476, "question_id": 35850167, "link": "https://stackoverflow.com/questions/35850167/how-do-you-get-the-maximum-performance-from-go-while-using-interfaces/35850476#35850476", "title": "How do you get the maximum performance from Go while using interfaces?", "body": "<p>Well, bad news first, interfaces are about as fast as they are gonna get for now, might be improved a bit by 1.7 but not much.</p>\n\n<p>If your interfaces aren't massive, you can pass funcs around rather than interfaces.</p>\n\n<p>Example:</p>\n\n<pre><code>func Sort(a sort.Interface) // can be rewritten as\nfunc Sort(ln int, lessFn func(i, j) bool, swapFn func(i, j))\n</code></pre>\n\n<p>But I 100% agree with @RobNapier.</p>\n"}], "owner": {"reputation": 342, "user_id": 5966373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc1d3a765c8c1ed7cca49e04162dc58?s=128&d=identicon&r=PG&f=1", "display_name": "sirwillem", "link": "https://stackoverflow.com/users/5966373/sirwillem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "closed_date": 1485389706, "accepted_answer_id": 35850430, "answer_count": 2, "score": 0, "last_activity_date": 1457372921, "creation_date": 1457371915, "question_id": 35850167, "link": "https://stackoverflow.com/questions/35850167/how-do-you-get-the-maximum-performance-from-go-while-using-interfaces", "closed_reason": "Needs more focus", "title": "How do you get the maximum performance from Go while using interfaces?", "body": "<p>I'm working on a simulator where every instruction counts. We were drawn to Go because of the interface abstraction, but from benchmarking, it is 5X worse to invoke the indirection of an interface rather than to call a method directly. However, our project structure now relies on the use of interfaces to get around circular dependencies. Is there a way to either make interfaces faster (doubtful) or get around circular dependencies without interfaces?</p>\n"}, {"tags": ["unit-testing", "go", "mocking", "testify"], "answers": [{"comments": [{"owner": {"reputation": 1057, "user_id": 974990, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c5a813df5e1175a873c40b2bf07db802?s=128&d=identicon&r=PG", "display_name": "Gregorio Di Stefano", "link": "https://stackoverflow.com/users/974990/gregorio-di-stefano"}, "edited": false, "score": 0, "creation_date": 1457393951, "post_id": 35850260, "comment_id": 59378129, "body": "Thanks, this seems like one way of doing it, but was hoping there was a simpler way of creating a mock method during testing"}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 1057, "user_id": 974990, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c5a813df5e1175a873c40b2bf07db802?s=128&d=identicon&r=PG", "display_name": "Gregorio Di Stefano", "link": "https://stackoverflow.com/users/974990/gregorio-di-stefano"}, "edited": false, "score": 0, "creation_date": 1457426669, "post_id": 35850260, "comment_id": 59389547, "body": "Well, due to its statically typed nature, mock in go are pretty raw compared to those in other languages (like PHP for example), so in terms of mock, I don&#39;t know of another solution. There may be a clever trick I don&#39;t know, though."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 1057, "user_id": 974990, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c5a813df5e1175a873c40b2bf07db802?s=128&d=identicon&r=PG", "display_name": "Gregorio Di Stefano", "link": "https://stackoverflow.com/users/974990/gregorio-di-stefano"}, "edited": false, "score": 0, "creation_date": 1457426801, "post_id": 35850260, "comment_id": 59389636, "body": "Another solution is @sargas answer, which became my way of doing once I started using files extensively: I created a <code>test</code> directory that contained a bunch of files in states I knews would make the methods I wanted fail. When dealing with the file system, I tend to find that much more simple\u2026"}, {"owner": {"reputation": 2771, "user_id": 404949, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5d457fe9d0c94a181f7631c3598b4e61?s=128&d=identicon&r=PG", "display_name": "puchu", "link": "https://stackoverflow.com/users/404949/puchu"}, "edited": false, "score": 0, "creation_date": 1589410875, "post_id": 35850260, "comment_id": 109287749, "body": "This is the only one possible solution for mocking, but it is awful, same as awful as all go language design."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 3, "last_activity_date": 1457372241, "creation_date": 1457372241, "answer_id": 35850260, "question_id": 35849985, "link": "https://stackoverflow.com/questions/35849985/mocking-method-from-golang-package/35850260#35850260", "title": "Mocking method from golang package", "body": "<p>My own solution was to take the method as an argument, which allow to inject a \"mock\" instead when testing. Additionnaly, create an exported method as public facade and an unexported one for testing.</p>\n\n<p>Example:</p>\n\n<pre><code>    func Foo() int {        \n            return foo(os.Getpid)\n    }                       \n\n    func foo(getpid func() int) int {\n            return getpid()      \n    } \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2771, "user_id": 404949, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5d457fe9d0c94a181f7631c3598b4e61?s=128&d=identicon&r=PG", "display_name": "puchu", "link": "https://stackoverflow.com/users/404949/puchu"}, "edited": false, "score": 1, "creation_date": 1589411993, "post_id": 35856467, "comment_id": 109288052, "body": "This is actually not <code>testing</code>, this is just dancing around enviroment to find possible bugs. Mockering of enviroment won&#39;t reproduce all possible testing cases."}], "tags": [], "owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "is_accepted": false, "score": 0, "last_activity_date": 1457394781, "creation_date": 1457394781, "answer_id": 35856467, "question_id": 35849985, "link": "https://stackoverflow.com/questions/35849985/mocking-method-from-golang-package/35856467#35856467", "title": "Mocking method from golang package", "body": "<p>Looks like that taking a look at the <a href=\"https://golang.org/src/os/os_test.go\" rel=\"nofollow\">os.Getwd test</a> could give you some example of how you could test your code. Look for the functions <code>TestChdirAndGetwd</code> and <code>TestProgWideChdir</code>.</p>\n\n<p>From reading those, it seems that the tests create temporary folders.</p>\n\n<p>So a pragmatic approach would be to create temporary folders, like the tests mentioned above do, then break them so <code>os.Getwd</code> throws an error for you to catch on your test.</p>\n\n<p>Just be careful doing these operations as they can mess up your system. I'd suggest testing in a lightweight container or a virtual machine.</p>\n"}, {"comments": [{"owner": {"reputation": 2771, "user_id": 404949, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5d457fe9d0c94a181f7631c3598b4e61?s=128&d=identicon&r=PG", "display_name": "puchu", "link": "https://stackoverflow.com/users/404949/puchu"}, "edited": false, "score": 0, "creation_date": 1589412215, "post_id": 40523713, "comment_id": 109288123, "body": "It is not possible to test <code>package</code> (like <code>os</code>) using this method, because it is not possible to pass package as argument in go. So you have to include your interface implementation (wrapper around <code>os</code>) into release version of application. This is awful, this should not be used by anyone."}, {"owner": {"reputation": 622, "user_id": 5604249, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7bed34ebe08c34a10addbea1bf85ff17?s=128&d=identicon&r=PG&f=1", "display_name": "Pharaoh", "link": "https://stackoverflow.com/users/5604249/pharaoh"}, "reply_to_user": {"reputation": 2771, "user_id": 404949, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5d457fe9d0c94a181f7631c3598b4e61?s=128&d=identicon&r=PG", "display_name": "puchu", "link": "https://stackoverflow.com/users/404949/puchu"}, "edited": false, "score": 0, "creation_date": 1589536567, "post_id": 40523713, "comment_id": 109339336, "body": "I am not saying we can test system calls using this method, We can test other functionalities by putting the system calls behind an interface. Which is exactly what you are saying"}], "tags": [], "owner": {"reputation": 622, "user_id": 5604249, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7bed34ebe08c34a10addbea1bf85ff17?s=128&d=identicon&r=PG&f=1", "display_name": "Pharaoh", "link": "https://stackoverflow.com/users/5604249/pharaoh"}, "is_accepted": false, "score": 0, "last_activity_date": 1478769107, "creation_date": 1478769107, "answer_id": 40523713, "question_id": 35849985, "link": "https://stackoverflow.com/questions/35849985/mocking-method-from-golang-package/40523713#40523713", "title": "Mocking method from golang package", "body": "<p>I know this is a bit late but, here is how you can do it.</p>\n\n<p>Testing DAL or SystemCalls or package calls is usually difficult. My approach to solve this problem is to push your system function calls behind an interface and then mock the functions of those interface. For example.</p>\n\n<pre><code>type SystemCalls interface {\n Getwd() error\n}\n\n\ntype SystemCallsImplementation struct{\n}\nfunc (SystemCallsImplementation) Getwd() error{\n return  Os.Getwd() \n}\n\nfunc MyFunc(sysCall SystemCalls) error{\n\nsysCall.Getwd()\n}\n</code></pre>\n\n<p>With this you inject your interface that has the system calls to your function. Now you can easily create a mock implementation of your interface for testing.</p>\n\n<p>like </p>\n\n<pre><code>type MockSystemCallsImplementation struct{\nerr error\n}\nfunc (MockSystemCallsImplementation) Getwd() error{\nreturn err  //this can be set to nil or some value in your test function\n}\n</code></pre>\n\n<p>Hope this answers your question.</p>\n"}, {"tags": [], "owner": {"reputation": 2771, "user_id": 404949, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5d457fe9d0c94a181f7631c3598b4e61?s=128&d=identicon&r=PG", "display_name": "puchu", "link": "https://stackoverflow.com/users/404949/puchu"}, "is_accepted": false, "score": 0, "last_activity_date": 1589413090, "creation_date": 1589413090, "answer_id": 61786722, "question_id": 35849985, "link": "https://stackoverflow.com/questions/35849985/mocking-method-from-golang-package/61786722#61786722", "title": "Mocking method from golang package", "body": "<p>This is the limitation of go compiler, google developers don't want to allow any hooks or monkey patching. If unit tests are important for you - than you have to select a method of source code poisoning. All these methods are the following:</p>\n\n<ul>\n<li>You can't use global packages directly.</li>\n<li>You have to create isolated version of method and test it.</li>\n<li>Production version of method includes isolated version of method and global package.</li>\n</ul>\n\n<p>But the best solution is to ignore go language completely (if possible).</p>\n"}], "owner": {"reputation": 1057, "user_id": 974990, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c5a813df5e1175a873c40b2bf07db802?s=128&d=identicon&r=PG", "display_name": "Gregorio Di Stefano", "link": "https://stackoverflow.com/users/974990/gregorio-di-stefano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3591, "favorite_count": 0, "accepted_answer_id": 35850260, "answer_count": 4, "score": 1, "last_activity_date": 1589413090, "creation_date": 1457371283, "question_id": 35849985, "link": "https://stackoverflow.com/questions/35849985/mocking-method-from-golang-package", "title": "Mocking method from golang package", "body": "<p>I have been unable to find a solution to mocking methods from golang packages. </p>\n\n<p>For example, my project has code that attempts to recover when Os.Getwd() returns an error. The easiest way I can thinking of making a unit test for this, is by mocking the Os.Getwd() method to return an error, and verify that the code works accordingly.</p>\n\n<p>I tried using testify, but it does not seem to be possible.</p>\n\n<p>Anyone have any experience with that?</p>\n"}, {"tags": ["mysql", "amazon-web-services", "heroku", "go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1457366738, "post_id": 35848084, "comment_id": 59362236, "body": "Do you want to import that into your Heroku database?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1457367387, "post_id": 35848084, "comment_id": 59362724, "body": "Assuming that: you would either use a MySQL add-on from a provider that works with Heroku, or Amazon RDS (MySQL). The latter can definitely import from S3."}], "answers": [{"tags": [], "owner": {"reputation": 4173, "user_id": 3479860, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/07d70ea6b00797e7e17daaa30b1dc363?s=128&d=identicon&r=PG&f=1", "display_name": "Valeriy Solovyov", "link": "https://stackoverflow.com/users/3479860/valeriy-solovyov"}, "is_accepted": false, "score": 0, "last_activity_date": 1457506377, "creation_date": 1457506377, "answer_id": 35884880, "question_id": 35848084, "link": "https://stackoverflow.com/questions/35848084/sql-database-on-remote-golang-instance/35884880#35884880", "title": "SQL database on remote Golang instance", "body": "<p><a href=\"https://devcenter.heroku.com/articles/heroku-mysql\" rel=\"nofollow\">https://devcenter.heroku.com/articles/heroku-mysql</a></p>\n\n<p>In heroku website, go to My Apps and select the app on which you have installed ClearDB. </p>\n\n<p>On the top corner click on <strong>Addons</strong> and then select <strong>ClearDB MySQL Database</strong>.\nOnce there, click on your database and choose the '<strong>Endpoint Information</strong>' tab. There you see your username/password. The URL to the database can be acquired by running \n<code>heroku config --app &lt;YOUR-APP-NAME&gt;</code> in the command line.</p>\n\n<p>In my case, it was something like: mysql://user:pass@<strong>us-cdbr-east.cleardb.com</strong>/TABLE?reconnect=true\nWhat you need is this part: <strong>us-cdbr-east.cleardb.com</strong></p>\n\n<p>PS:\n<a href=\"https://devcenter.heroku.com/articles/heroku-postgresql\" rel=\"nofollow\">https://devcenter.heroku.com/articles/heroku-postgresql</a></p>\n"}], "owner": {"reputation": 21, "user_id": 2628585, "user_type": "registered", "profile_image": "https://graph.facebook.com/1167735318/picture?type=large", "display_name": "Crystal Qian", "link": "https://stackoverflow.com/users/2628585/crystal-qian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 363, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1457506377, "creation_date": 1457365922, "question_id": 35848084, "link": "https://stackoverflow.com/questions/35848084/sql-database-on-remote-golang-instance", "title": "SQL database on remote Golang instance", "body": "<p>I'm trying to launch a Go app on Heroku. This app does use a fairly large SQL database; currently, the database is on my local and I call this</p>\n\n<p><code>db, err := sqlx.MustConnect(\"mysql\", username+\":\"+password+\"@tcp(localhost:3306)/\"+environment)\n</code></p>\n\n<p>in my code. The data is accessible as a <code>.sql</code> file from an AWS bucket. Is there anyway I could have my app directly connect to this sql file, or host the database somewhere other than localhost?</p>\n"}, {"tags": ["go", "channel", "goroutine"], "comments": [{"owner": {"reputation": 5459, "user_id": 1734730, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/L8dDj.jpg?s=128&g=1", "display_name": "Nathan Cooper", "link": "https://stackoverflow.com/users/1734730/nathan-cooper"}, "edited": false, "score": 3, "creation_date": 1457360523, "post_id": 35845596, "comment_id": 59357492, "body": "Alternatively, if the struct contained a slice, `[]int&#39;, the effect of passing the slice (and therefore struct) by value would not copy the internal array. I&#39;m not saying that is your answer however."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 5987281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90f1fc62eef6a6992a58670627bdae1b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Jones", "link": "https://stackoverflow.com/users/5987281/lucas-jones"}, "edited": false, "score": 3, "creation_date": 1457360023, "post_id": 35845823, "comment_id": 59357163, "body": "Here&#39;s a playground demonstration of both types of channel: <a href=\"https://play.golang.org/p/-VFWCgOnh0\" rel=\"nofollow noreferrer\">play.golang.org/p/-VFWCgOnh0</a>"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 101, "user_id": 5987281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90f1fc62eef6a6992a58670627bdae1b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Jones", "link": "https://stackoverflow.com/users/5987281/lucas-jones"}, "edited": false, "score": 0, "creation_date": 1457360179, "post_id": 35845823, "comment_id": 59357272, "body": "@LucasJones I&#39;ll add your example to the post for better visibility."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 2, "creation_date": 1457361719, "post_id": 35845823, "comment_id": 59358349, "body": "Just be aware of potential race conditions if you&#39;re sending a pointer only. You don&#39;t want to end up with both goroutines messing with the same struct"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 18, "last_activity_date": 1457361823, "last_edit_date": 1457361823, "creation_date": 1457359631, "answer_id": 35845823, "question_id": 35845596, "link": "https://stackoverflow.com/questions/35845596/is-a-struct-actually-copied-between-goroutines-if-sent-over-a-golang-channel/35845823#35845823", "title": "Is a struct actually copied between goroutines if sent over a Golang channel?", "body": "<p>Yes, everything is a copy in Go, you can easily work around that by changing the channel to use a pointer (aka <code>chan *largeStruct</code>).</p>\n\n<p>// demo: <a href=\"http://play.golang.org/p/CANxwt8s2B\" rel=\"noreferrer\">http://play.golang.org/p/CANxwt8s2B</a></p>\n\n<p>As you can see, the pointer to <code>v.buf</code> is different in each case, however if you change it to <code>chan *largeStruct</code>, the pointers will be the same.</p>\n\n<p>@LucasJones provided a little easier to follow example: <a href=\"https://play.golang.org/p/-VFWCgOnh0\" rel=\"noreferrer\">https://play.golang.org/p/-VFWCgOnh0</a></p>\n\n<p>As @nos pointed out, there's a potential race if you modify the value in both goroutines after sending it.</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 5, "last_activity_date": 1457361168, "last_edit_date": 1457361168, "creation_date": 1457360176, "answer_id": 35846000, "question_id": 35845596, "link": "https://stackoverflow.com/questions/35845596/is-a-struct-actually-copied-between-goroutines-if-sent-over-a-golang-channel/35846000#35846000", "title": "Is a struct actually copied between goroutines if sent over a Golang channel?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Send_statements\" rel=\"nofollow\">Send statements</a></p>\n  \n  <p>A send statement sends a value on a channel. The channel expression\n  must be of channel type, the channel direction must permit  send\n  operations, and the type of the value to be sent must be assignable to\n  the channel's element type.</p>\n</blockquote>\n\n<p>It's a copy because the value is sent to the channel by assignment to the channel's element type. If the value is a struct, then the struct is copied. If the value is a pointer to a struct, then the pointer to the struct is copied.</p>\n"}], "owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6260, "favorite_count": 4, "accepted_answer_id": 35845823, "answer_count": 2, "score": 13, "last_activity_date": 1559356310, "creation_date": 1457358952, "last_edit_date": 1559356310, "question_id": 35845596, "link": "https://stackoverflow.com/questions/35845596/is-a-struct-actually-copied-between-goroutines-if-sent-over-a-golang-channel", "title": "Is a struct actually copied between goroutines if sent over a Golang channel?", "body": "<p>If a large struct is sent over a channel in Go, is it actually copied between goroutines?</p>\n\n<p>For example, in the code below, will Go actually copy all largeStruct data between goroutines producer and consumer?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\ntype largeStruct struct {\n    buf [10000]int\n}\n\nfunc main() {\n    ch := make(chan largeStruct)\n    wg := &amp;sync.WaitGroup{}\n    wg.Add(2)\n    go consumer(wg, ch)\n    go producer(wg, ch)\n    wg.Wait()\n}\n\nfunc producer(wg *sync.WaitGroup, output chan&lt;- largeStruct) {\n    defer wg.Done()\n    for i := 0; i &lt; 5; i++ {\n        fmt.Printf(\"producer: %d\\n\", i)\n        output &lt;- largeStruct{}\n    }\n    close(output)\n}\n\nfunc consumer(wg *sync.WaitGroup, input &lt;-chan largeStruct) {\n    defer wg.Done()\n    i := 0\nLOOP:\n    for {\n        select {\n        case _, ok := &lt;-input:\n            if !ok {\n                break LOOP\n            }\n            fmt.Printf(\"consumer: %d\\n\", i)\n            i++\n        }\n    }\n}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/fawEQnSDwB\" rel=\"noreferrer\">http://play.golang.org/p/fawEQnSDwB</a></p>\n"}, {"tags": ["html", "forms", "go", "revel"], "answers": [{"tags": [], "owner": {"reputation": 38917, "user_id": 445210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b689cc1d73c4f1e7378d045a54abcca?s=128&d=identicon&r=PG", "display_name": "Herman Schaaf", "link": "https://stackoverflow.com/users/445210/herman-schaaf"}, "is_accepted": false, "score": 1, "last_activity_date": 1457360617, "creation_date": 1457360617, "answer_id": 35846145, "question_id": 35843156, "link": "https://stackoverflow.com/questions/35843156/how-to-handle-dynamic-number-of-inputs-from-html-form-with-with-revel-golang/35846145#35846145", "title": "How to handle dynamic number of inputs from html form with with Revel Golang", "body": "<p>Each Revel controller comes with an attached <code>Request</code>, which is really just a normal Go standard library <a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow\"><code>Request</code></a>. As such, this is the same as for plain Go web servers, in that we cannot use the <code>Request.Form.Get(\"inputname\")</code> method, as this would only give the first result. Instead, we need to access the values in the <code>Form</code> map directly:</p>\n\n<pre><code>package controllers\n\nimport (\n    \"log\"\n\n    \"github.com/robfig/revel\"\n)\n\ntype App struct {\n    *revel.Controller\n}\n\nfunc (c App) Index() revel.Result {\n    if err := c.Request.ParseForm(); err != nil {\n        // handle error\n    }\n    values := c.Request.Form[\"text\"]\n    for i := range values {\n        log.Println(values[i])\n    }\n    return c.Render()\n}\n</code></pre>\n\n<p>The example above is for a simple application like the one generated by Revel when you start a project, with an input named <code>text</code>, and can be adapted to your specific case.</p>\n\n<p>The <code>values</code> variable is of type <code>[]string</code>, which is why the following is logged, if you submit a GET request with query string <code>?text=value1&amp;text=value2&amp;text=value3</code>, as would happen for a form with <code>method=\"GET\"</code> and three text inputs with <code>name=\"text\"</code>:</p>\n\n<pre><code>2016/03/07 22:16:41 app.go:19: value1\n2016/03/07 22:16:41 app.go:19: value2\n2016/03/07 22:16:41 app.go:19: value3\n</code></pre>\n\n<p>The form in the question happens to use method POST, but the code for reading the values from the form remains the same.</p>\n"}], "owner": {"reputation": 382, "user_id": 3354604, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LPWCX.jpg?s=128&g=1", "display_name": "EgorkZe", "link": "https://stackoverflow.com/users/3354604/egorkze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1056, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494957591, "creation_date": 1457351877, "question_id": 35843156, "link": "https://stackoverflow.com/questions/35843156/how-to-handle-dynamic-number-of-inputs-from-html-form-with-with-revel-golang", "title": "How to handle dynamic number of inputs from html form with with Revel Golang", "body": "<p>I have an html form with dynamic number of inputs. Each input must be a Model object, and i also have a function, which receives values from this inputs.\nMy html form:</p>\n\n<pre><code>&lt;form action=\"{{url \"Votes.CreateVote\"}}\" id=\"formVoteCreate\" method=\"POST\"&gt;\n            &lt;p class=\"field\"&gt;\n                &lt;label&gt;Question:&lt;/label&gt;\n                &lt;input type=\"text\" name=\"question\" size=\"40\"  /&gt;\n            &lt;/p&gt;\n             &lt;div ng-repeat=\"answer in answers\"&gt;\n                &lt;p class=\"field\"&gt;\n                    &lt;label&gt;//stuff.title//:&lt;/label&gt;\n                    &lt;input type=\"text\" name=//stuff.name// size=\"40\"  /&gt;\n                &lt;/p&gt;\n             &lt;/div&gt;\n            &lt;p&gt;\n                &lt;input ng-click=\"addInput()\" class=\"btn\"  type=\"button\" value=\"Add answer\"&gt;\n            &lt;/p&gt;\n            &lt;p class=\"buttons\"&gt;\n                &lt;input class=\"btn\" type=\"submit\" value=\"Create\" /&gt;\n            &lt;/p&gt;\n        &lt;/form&gt;\n</code></pre>\n\n<p>And revel golang handler:</p>\n\n<pre><code>func (c Votes) CreateVote() revel.Result {\n   // in this place i want get a slice with answers from html form\n   return c.Redirect(routes.App.Index())\n}\n</code></pre>\n\n<p>and answer model:</p>\n\n<pre><code>type Answer struct {\n  Model\n  Text    string\n}\n</code></pre>\n\n<p>How can i send form's values as a slice with answers packed to Model?</p>\n"}, {"tags": ["sockets", "go", "raw-sockets", "raw-ethernet"], "comments": [{"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1457395263, "post_id": 35841275, "comment_id": 59378627, "body": "Have you tried using the standard library for making connections? Like the <a href=\"https://golang.org/pkg/net/\" rel=\"nofollow noreferrer\">net</a> package or the <a href=\"https://golang.org/pkg/crypto/tls/\" rel=\"nofollow noreferrer\">crypto/tls</a> package? They both have a <code>Dial</code> method that does raw TCP."}, {"owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "reply_to_user": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1457395943, "post_id": 35841275, "comment_id": 59378820, "body": "@sargas Thank you for replay. Yes I did use Dial method. However I need to change Ethernet part as well. Not only IP layer."}], "answers": [{"comments": [{"owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "edited": false, "score": 0, "creation_date": 1457481731, "post_id": 35863058, "comment_id": 59424103, "body": "Did you saw this example? <a href=\"http://yusufonlinux.blogspot.kr/2010/11/data-link-access-and-zero-copy.html\" rel=\"nofollow noreferrer\">yusufonlinux.blogspot.kr/2010/11/&hellip;</a>"}, {"owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "edited": false, "score": 0, "creation_date": 1457487071, "post_id": 35863058, "comment_id": 59425641, "body": "I tried syscall.BindToDev(name) function and it works without error. But Error 4 is still present."}, {"owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "edited": false, "score": 0, "creation_date": 1457512582, "post_id": 35863058, "comment_id": 59434706, "body": "I found solution. I will post it later today. Actually I was able to use syscall.Bind() syscall to bind a raw socket."}], "tags": [], "owner": {"reputation": 4143, "user_id": 1034255, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08361c2fe2bb01912c7a64ac848db2fd?s=128&d=identicon&r=PG", "display_name": "jupp0r", "link": "https://stackoverflow.com/users/1034255/jupp0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1457427780, "creation_date": 1457427780, "answer_id": 35863058, "question_id": 35841275, "link": "https://stackoverflow.com/questions/35841275/sending-raw-packet-with-ethernet-header-using-go-language/35863058#35863058", "title": "Sending Raw packet with Ethernet header using Go Language", "body": "<p>What you want to accomplish is more complicated.</p>\n\n<ol>\n<li>You cannot use the kernels bind syscall to bind to a raw socket: <code>err = syscall.Bind(fd, &amp;addr)</code></li>\n<li>You want to write ethernet frames to the raw socket. In order to do so you need to assemble the ethernet frame and TCP header yourself. The whole point of using a raw socket on that level is not having the kernel do this for you.</li>\n</ol>\n\n<p>Some working examples in C can be found <a href=\"http://www.pdbuchan.com/rawsock/rawsock.html\" rel=\"nofollow\">here</a>. They are probably easy to port to Go</p>\n"}, {"tags": [], "owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "is_accepted": false, "score": -2, "last_activity_date": 1457515147, "creation_date": 1457515147, "answer_id": 35887418, "question_id": 35841275, "link": "https://stackoverflow.com/questions/35841275/sending-raw-packet-with-ethernet-header-using-go-language/35887418#35887418", "title": "Sending Raw packet with Ethernet header using Go Language", "body": "<p>Here is working code of my problem. I will add explanation later.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n    \"syscall\"\n)\n\nfunc main() {\n\n    fmt.Println(\"=============================================================================\")\n    fmt.Println(\"= Start sending                                                             =\")\n    fmt.Println(\"=============================================================================\")\n\n    pkt := []byte{\n        0x6c, 0x62, 0x6d, 0x50, 0xe6, 0xe4, 0x94, 0xde, 0x80, 0xa5, 0xec, 0x79, 0x08, 0x00, 0x45, 0x00,\n        0x00, 0x3c, 0x4b, 0x72, 0x40, 0x00, 0x40, 0x06, 0x44, 0x7d, 0xc0, 0xa8, 0x34, 0x7b, 0xd8, 0x3a,\n        0xdd, 0x6e, 0xa6, 0x37, 0x01, 0xbb, 0x32, 0xf3, 0x21, 0xa9, 0x00, 0x00, 0x00, 0x00, 0xa0, 0x02,\n        0x72, 0x10, 0xae, 0xa5, 0x00, 0x00, 0x02, 0x04, 0x05, 0xb4, 0x04, 0x02, 0x08, 0x0a, 0x15, 0x13,\n        0x6a, 0xdb, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x03, 0x07,\n    }\n\n    fd, err := syscall.Socket(syscall.AF_PACKET, syscall.SOCK_RAW, syscall.ETH_P_ALL)\n    if err != nil {\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(\"= Error 1                                                                   =\")\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(err)\n    }\n\n    if_info, err := net.InterfaceByName(\"eth0\")\n    if err != nil {\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(\"= Error 2                                                                   =\")\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(err)\n    }\n\n    var haddr [8]byte\n    copy(haddr[0:7], if_info.HardwareAddr[0:7])\n    addr := syscall.SockaddrLinklayer{\n        Protocol: syscall.ETH_P_IP,\n        Ifindex:  if_info.Index,\n        Halen:    uint8(len(if_info.HardwareAddr)),\n        Addr:     haddr,\n    }\n\n    err = syscall.Bind(fd, &amp;addr)\n    if err != nil {\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(\"= Error 3                                                                   =\")\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(err)\n    }\n\n    err = syscall.SetLsfPromisc(\"eth0\", true)\n    if err != nil {\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(\"= Error 4                                                                   =\")\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(err)\n    }\n\n    n, err := syscall.Write(fd, pkt)\n    if err != nil {\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(\"= Error 5                                                                   =\")\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(err)\n        fmt.Println(n)\n    } else {\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(\"= Packet is sent                                                            =\")\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(n)\n    }\n\n    err = syscall.SetLsfPromisc(\"eth0\", false)\n    if err != nil {\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(\"= Error 6                                                                   =\")\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2033, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1457515147, "creation_date": 1457346330, "question_id": 35841275, "link": "https://stackoverflow.com/questions/35841275/sending-raw-packet-with-ethernet-header-using-go-language", "title": "Sending Raw packet with Ethernet header using Go Language", "body": "<p>I am trying to send raw TCP packet with custom Ethernet header through raw socket in Go language. I am trying to reproduce similar code in <a href=\"http://yusufonlinux.blogspot.kr/2010/11/data-link-access-and-zero-copy.html\" rel=\"nofollow\">c language</a>. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"syscall\"\n)\n\nfunc main() {\n\n    fmt.Println(\"=============================================================================\")\n    fmt.Println(\"= Start sending                                                             =\")\n    fmt.Println(\"=============================================================================\")\n\n    pkt := []byte{\n        0x6c, 0x62, 0x6d, 0x50, 0xe6, 0xe4, 0x94, 0xde, 0x80, 0xa5, 0xec, 0x79, 0x08, 0x00, 0x45, 0x00,\n        0x00, 0x3c, 0x47, 0xd9, 0x40, 0x00, 0x40, 0x06, 0xb5, 0x94, 0xc0, 0xa8, 0x34, 0x7b, 0x36, 0xe7,\n        0x11, 0x44, 0xc3, 0x66, 0x00, 0x50, 0x09, 0x58, 0x6b, 0xeb, 0x00, 0x00, 0x00, 0x00, 0xa0, 0x02,\n        0x72, 0x10, 0x26, 0x38, 0x00, 0x00, 0x02, 0x04, 0x05, 0xb4, 0x04, 0x02, 0x08, 0x0a, 0x0d, 0x3d,\n        0x2c, 0x32, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x03, 0x07,\n    }\n\n    fd, err := syscall.Socket(syscall.AF_PACKET, syscall.SOCK_RAW, syscall.ETH_P_ALL)\n    if err != nil {\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(\"= Error 1                                                                   =\")\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(err)\n    }\n\n    addr := syscall.SockaddrInet4{\n        Port: 0,\n        Addr: [4]byte{127, 0, 0, 1},\n    }\n\n    err = syscall.Bind(fd, &amp;addr)\n    if err != nil {\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(\"= Error 2                                                                   =\")\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(err)\n    }\n\n    err = syscall.SetLsfPromisc(\"eth0\", true)\n    if err != nil {\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(\"= Error 3                                                                   =\")\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(err)\n    }\n\n    n, err := syscall.Write(fd, pkt)\n    if err != nil {\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(\"= Error 4                                                                   =\")\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(err)\n        fmt.Println(n)\n    } else {\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(\"= Packet is sent                                                            =\")\n        fmt.Println(\"=============================================================================\")\n        fmt.Println(n)\n    }\n}\n</code></pre>\n\n<p>However I am getting following error:</p>\n\n<pre><code>=============================================================================\n= Start sending                                                             =\n=============================================================================\n=============================================================================\n= Error 2                                                                   =\n=============================================================================\ninvalid argument\n=============================================================================\n= Error 4                                                                   =\n=============================================================================\nno such device or address\n-1\n</code></pre>\n\n<p>Please guide me if you have any knowledge.</p>\n"}, {"tags": ["database", "go", "boltdb"], "comments": [{"owner": {"reputation": 8946, "user_id": 2398521, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/84bb49c56756a8c7cd54d4876d7a4467?s=128&d=identicon&r=PG", "display_name": "Maxim", "link": "https://stackoverflow.com/users/2398521/maxim"}, "edited": false, "score": 0, "creation_date": 1502702551, "post_id": 35839391, "comment_id": 78299889, "body": "The <a href=\"https://protonail.com\" rel=\"nofollow noreferrer\">Keylord</a> is GUI client for Bolt, Redis, etc. Since version 4.0 it can create, edit, delete buckets and values in Bolt DB."}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 97394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c76488dff9b5d9a872dff88f008f88e?s=128&d=identicon&r=PG", "display_name": "Ben Johnson", "link": "https://stackoverflow.com/users/97394/ben-johnson"}, "edited": false, "score": 4, "creation_date": 1457382694, "post_id": 35845935, "comment_id": 59372549, "body": "I agree that you should generally write code to manage your database state. However, if you need to inspect the database or tweak a value for some reason, Brian Buller&#39;s boltbrowser is a nice termbox UI for Bolt:   <a href=\"https://github.com/br0xen/boltbrowser\" rel=\"nofollow noreferrer\">github.com/br0xen/boltbrowser</a>"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 1, "last_activity_date": 1457360003, "creation_date": 1457360003, "answer_id": 35845935, "question_id": 35839391, "link": "https://stackoverflow.com/questions/35839391/manually-edit-boltdb-file/35845935#35845935", "title": "Manually edit boltdb file", "body": "<p>You can't edit it manually, you have to write code code that'd do that for you.</p>\n"}], "owner": {"reputation": 5556, "user_id": 1393225, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/MGcyh.png?s=128&g=1", "display_name": "Vnuuk", "link": "https://stackoverflow.com/users/1393225/vnuuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1610, "favorite_count": 0, "accepted_answer_id": 35845935, "answer_count": 1, "score": 1, "last_activity_date": 1457382671, "creation_date": 1457340084, "last_edit_date": 1457361890, "question_id": 35839391, "link": "https://stackoverflow.com/questions/35839391/manually-edit-boltdb-file", "title": "Manually edit boltdb file", "body": "<p>I have an app written on <strong>golang</strong> and I want to create a <strong>builin database</strong>, I've selected <strong>boltdb</strong>. <em>I have some init data that I want to seed into database manually</em>. I have <strong>database.db</strong> file and I want to put some data into it. </p>\n\n<p>When I open this file - <strong>I see many 'NUL' words</strong>. How can I edit .db file manually?</p>\n"}, {"tags": ["pointers", "go", "struct", "parameters", "func"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1457331599, "post_id": 35836735, "comment_id": 59341079, "body": "What are you trying to do? Why do you want to do this?"}], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1457338512, "post_id": 35837390, "comment_id": 59344063, "body": "You should add that this isn&#39;t very idiomatic (or safe) code. The OP&#39;s code could probably avoid this if we had more context around the &quot;why&quot;."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1457343462, "post_id": 35837390, "comment_id": 59346638, "body": "The OP presumably is not an advanced Go user. Why do you recommend using reflection?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1457358695, "post_id": 35837390, "comment_id": 59356241, "body": "@Volker The suitability of reflection for a given task is independent of the person asking."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1457358820, "post_id": 35837390, "comment_id": 59356339, "body": "@elithrar I updated the code to make it safe. Thanks for the feedback."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1457360083, "post_id": 35837390, "comment_id": 59357203, "body": "Also note that using reflection to call methods/funcs is extremely slow because of the added wrappers."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1457361266, "post_id": 35837390, "comment_id": 59358013, "body": "@OneOfOne Reflection does not add any wrappers around the function returned from <code>handlerByName</code>.   There is a cost to finding the function using reflection, but that cost is not extreme compared to other possible ways to find a function given a string."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1457362231, "post_id": 35837390, "comment_id": 59358765, "body": "@OneOfOne Thank you for that. Do you know where in the reflect code the wrapper is added?"}, {"owner": {"reputation": 45, "user_id": 4580168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a535f186b17b9ab2f7cb1e9230e3351?s=128&d=identicon&r=PG&f=1", "display_name": "herb", "link": "https://stackoverflow.com/users/4580168/herb"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1457403323, "post_id": 35837390, "comment_id": 59380838, "body": "@Volker yes, I just study golang about few days, you may think Im not qualified enough but I just want to write a web framework for myself, I know this is not a easy work but I will try my best"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1457362966, "last_edit_date": 1457362966, "creation_date": 1457331624, "answer_id": 35837390, "question_id": 35836735, "link": "https://stackoverflow.com/questions/35836735/how-to-pass-a-structs-method-as-a-parameter-into-another-function-using-golang/35837390#35837390", "title": "How to pass a struct&#39;s method as a parameter into another function using golang", "body": "<p>You can get the method by name using the reflect package. Here's a function to get a <code>Handler</code> given the name:</p>\n\n<pre><code>func handlerByName(v interface{}, name string) (Handler, error) {\n  m := reflect.ValueOf(v).MethodByName(name)\n  if !m.IsValid() {\n    return nil, errors.New(\"method not found\")\n  }\n  h, ok := m.Interface().(func(*Context))\n  if !ok {\n    return nil, errors.New(\"method is not a handler\")\n  }\n  return h, nil\n}\n</code></pre>\n\n<p>Here's how to use the function:</p>\n\n<pre><code>h, err := handlerByName(t, \"Go\")\nif err != nil {\n   // handle error\n}\nm.set(h)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/BZIvlkwpeT\" rel=\"nofollow\">playground example</a></p>\n\n<p>Note that the function returned by handlerByName is a reflection wrapper around the original function (thanks @OneOfOne for pointing this out). Calling the wrapper is slow compared to calling the function directly.</p>\n"}], "owner": {"reputation": 45, "user_id": 4580168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a535f186b17b9ab2f7cb1e9230e3351?s=128&d=identicon&r=PG&f=1", "display_name": "herb", "link": "https://stackoverflow.com/users/4580168/herb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1246, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1457362966, "creation_date": 1457328382, "last_edit_date": 1495541730, "question_id": 35836735, "link": "https://stackoverflow.com/questions/35836735/how-to-pass-a-structs-method-as-a-parameter-into-another-function-using-golang", "title": "How to pass a struct&#39;s method as a parameter into another function using golang", "body": "<p>Sorry, I post my question again.</p>\n\n<p>I have been read the solution before I ask my question. I think it can not help me because my question is <strong>how to pass a function as a parameter?</strong> I don't want to call it.</p>\n\n<p>I just want to pass it to another function that I can't edit (or I don't want to edit), and I want to use a string variable to point the function</p>\n\n<pre><code>funcName := \"Go\"\n m.set(t.funcName)\n</code></pre>\n\n<p>I think this is different from this question <a href=\"https://stackoverflow.com/questions/8103617/call-a-struct-and-its-method-by-name-in-go\">Call a Struct and its Method by name in Go?</a></p>\n\n<p>for example</p>\n\n<p>I have a function like:</p>\n\n<pre><code>type Context struct{}\ntype myclass struct{}\ntype Handler func (c *Context)\n\nfunc (r *myclass) set(ch Handler)  {\n\n}\n</code></pre>\n\n<p>I can use this way:</p>\n\n<pre><code>type testclass struct {}\nfunc (t *testclass) Go(c *Context){\n    println(\"Hello\");\n}\n\nt := &amp;testclass{}\nm := &amp;myclass{}\nm.set(t.Go)\n</code></pre>\n\n<p>and my question is</p>\n\n<pre><code>type testclass struct{}\nfunc (t *testclass) Go(c *Context){\n    println(\"Hello\");\n}\n\nt := &amp;testclass{}\nm := &amp;myclass{}\n\nfuncName := \"Go\"\nm.set(t.funcName)\n</code></pre>\n\n<p>any way can do this?</p>\n\n<p>reflect?or what?</p>\n\n<p>if it is impossible, there are other ways to do this?</p>\n\n<p>thanks</p>\n"}, {"tags": ["mysql", "go", "revel"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1457318070, "post_id": 35834645, "comment_id": 59337478, "body": "Is that in <code>package main</code> or a library?"}, {"owner": {"reputation": 458, "user_id": 3066874, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/M5PLK.png?s=128&g=1", "display_name": "Chemdream", "link": "https://stackoverflow.com/users/3066874/chemdream"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1457354206, "post_id": 35834645, "comment_id": 59353146, "body": "It&#39;s in package app (init.go file). I&#39;m trying to access is, anywhere else."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1457361557, "post_id": 35834645, "comment_id": 59358237, "body": "In the same package just call db.Query (or another method. If you need to access it from another package, you need to export it as <code>DB</code>. Lowercase variables are private."}, {"owner": {"reputation": 458, "user_id": 3066874, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/M5PLK.png?s=128&g=1", "display_name": "Chemdream", "link": "https://stackoverflow.com/users/3066874/chemdream"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1457369527, "post_id": 35834645, "comment_id": 59364351, "body": "I just edited to fix capitalization and add a function I&#39;d want to access DB in."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1457369596, "post_id": 35834645, "comment_id": 59364398, "body": "Have you tried it? If DB is global and within the same package, your Index() method should work."}, {"owner": {"reputation": 458, "user_id": 3066874, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/M5PLK.png?s=128&g=1", "display_name": "Chemdream", "link": "https://stackoverflow.com/users/3066874/chemdream"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1457370943, "post_id": 35834645, "comment_id": 59365326, "body": "I&#39;ve tried it. The Go code test/app/controllers/app.go does not compile: undefined: DB in DB.Exec  It doesn&#39;t work"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1457377616, "post_id": 35834645, "comment_id": 59369411, "body": "Which package is <code>Index()</code> in? It doesn&#39;t sound like the same package as <code>InitDB()</code>, which you&#39;ve said is in <code>package app</code>."}, {"owner": {"reputation": 458, "user_id": 3066874, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/M5PLK.png?s=128&g=1", "display_name": "Chemdream", "link": "https://stackoverflow.com/users/3066874/chemdream"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1458502565, "post_id": 35834645, "comment_id": 59877267, "body": "Index() is in package controller."}], "answers": [{"comments": [{"owner": {"reputation": 458, "user_id": 3066874, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/M5PLK.png?s=128&g=1", "display_name": "Chemdream", "link": "https://stackoverflow.com/users/3066874/chemdream"}, "edited": false, "score": 0, "creation_date": 1457354330, "post_id": 35834802, "comment_id": 59353247, "body": "Sorry, I&#39;m not sure I understand. Booking does not initiate the DB in the init.go file."}, {"owner": {"reputation": 3000, "user_id": 1335245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b201e069f3e6868c1c0285f6e31801c?s=128&d=identicon&r=PG", "display_name": "Charney Kaye", "link": "https://stackoverflow.com/users/1335245/charney-kaye"}, "reply_to_user": {"reputation": 458, "user_id": 3066874, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/M5PLK.png?s=128&g=1", "display_name": "Chemdream", "link": "https://stackoverflow.com/users/3066874/chemdream"}, "edited": false, "score": 1, "creation_date": 1457372157, "post_id": 35834802, "comment_id": 59366089, "body": "Hiya  @Chemdream I have updated the answer to be very specific to your case. Hope that helps!"}, {"owner": {"reputation": 458, "user_id": 3066874, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/M5PLK.png?s=128&g=1", "display_name": "Chemdream", "link": "https://stackoverflow.com/users/3066874/chemdream"}, "edited": false, "score": 0, "creation_date": 1457985683, "post_id": 35834802, "comment_id": 59646341, "body": "Thanks for you help. It&#39;s still not working for me. I&#39;m now getting: : undefined: app in app.DB ...  I&#39;ve updated the code above as well to include my package declaration. Thanks!"}], "tags": [], "owner": {"reputation": 3000, "user_id": 1335245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b201e069f3e6868c1c0285f6e31801c?s=128&d=identicon&r=PG", "display_name": "Charney Kaye", "link": "https://stackoverflow.com/users/1335245/charney-kaye"}, "is_accepted": false, "score": 1, "last_activity_date": 1457372122, "last_edit_date": 1457372122, "creation_date": 1457313966, "answer_id": 35834802, "question_id": 35834645, "link": "https://stackoverflow.com/questions/35834645/global-var-out-out-init-go-in-revel/35834802#35834802", "title": "global var out out init.go in revel", "body": "<p>Revel makes you \"roll your own db\" so it's up to you where connections are made and how to implement them.</p>\n\n<p>Your <code>InitDB()</code> function must setup a <strong><em>public</em></strong> variable, e.g. <code>DB</code> (meaning its name is capitalized) which you will then access via the package that it lives in.</p>\n\n<p>So notice your <code>app/init.go</code> is inside of <code>package app</code>:</p>\n\n<pre><code>package app\n\nvar DB *sql.DB\n\nfunc InitDB() { DB = .... }\n</code></pre>\n\n<p>In Go, when your application is running each package acts as a sort of \"singleton\" so that anywhere else in the application where you access:</p>\n\n<pre><code>app.DB\n</code></pre>\n\n<p>This will look for the variable called <code>DB</code> in the <code>app</code> package. And if you have already run <code>InitDB()</code> to connect to the database, then <code>app.DB</code> will allow all other packages to use the database.</p>\n"}], "owner": {"reputation": 458, "user_id": 3066874, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/M5PLK.png?s=128&g=1", "display_name": "Chemdream", "link": "https://stackoverflow.com/users/3066874/chemdream"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457985609, "creation_date": 1457312673, "last_edit_date": 1457985609, "question_id": 35834645, "link": "https://stackoverflow.com/questions/35834645/global-var-out-out-init-go-in-revel", "title": "global var out out init.go in revel", "body": "<p>(EDITING to fix capitalization and add context)</p>\n\n<p>In revel's init.go, I have a global var: DB.</p>\n\n<pre><code>package app\n\nimport (\n \"database/sql\"\n \"fmt\"\n\n _ \"github.com/go-sql-driver/mysql\"\n \"github.com/revel/revel\"\n)\nvar DB *sql.DB\n\nfunc InitDB() {\n\n connstring := fmt.Sprintf(\"revel:revel@tcp(localhost:3336)/revel\")\n\n var err error\n DB, err = sql.Open(\"mysql\", connstring)\n if err != nil {\n    revel.INFO.Println(\"DB Error\", err)\n }\n\n}\n</code></pre>\n\n<p>How do I get that db variable in the rest of the app? Specifically, I was going to use this var in the models.</p>\n\n<p>To start, how would I get it to work in this controller?\ncontrollers/app.go</p>\n\n<pre><code>package controller\n\nfunc (c App) Index() revel.Result {\n rows, err := app.DB.Exec(\"SELECT * FROM test_table\")\n //do something with rows\n return c.Render()\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1106925"}, "edited": false, "score": 1, "creation_date": 1457310363, "post_id": 35833793, "comment_id": 59335660, "body": "You must have something in mind as to how the data would get screwed up but you didn&#39;t describe it. Were you wondering if there would be a data-race in the channel or something?"}], "answers": [{"tags": [], "owner": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "is_accepted": false, "score": 0, "last_activity_date": 1457306972, "creation_date": 1457306972, "answer_id": 35833934, "question_id": 35833793, "link": "https://stackoverflow.com/questions/35833793/why-can-you-reuse-channels-in-go-when-doing-parallel-processing/35833934#35833934", "title": "Why can you reuse channels in Go when doing parallel processing?", "body": "<p>It's true that when you send two values over a channel from two different goroutines that the ordering is not necessarily guaranteed (unless you've done something else to coordinate their sends).</p>\n\n<p>However, in this example, the ordering doesn't matter at all. Two values are being sent on the channel: the sum of the first half and the sum of the second.</p>\n\n<pre><code>go sum(s[:len(s)/2], c)\ngo sum(s[len(s)/2:], c)\n</code></pre>\n\n<p>Since the only thing those two values are used for is to calculate the total sum, the order doesn't matter at all. In fact, if you ran the example enough times you should see that <code>x</code> and <code>y</code> are often swapped, but the sum <code>x+y</code> is always the same.</p>\n"}, {"tags": [], "owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "is_accepted": false, "score": 0, "last_activity_date": 1457312316, "creation_date": 1457312316, "answer_id": 35834597, "question_id": 35833793, "link": "https://stackoverflow.com/questions/35833793/why-can-you-reuse-channels-in-go-when-doing-parallel-processing/35834597#35834597", "title": "Why can you reuse channels in Go when doing parallel processing?", "body": "<p>Operations with channels are goroutine safe. You can read/write/close in any goroutine without corrupting anything that goes in or out of the channel. Basically, channels are synchronization points. Unbuffered channels (like in your case) will block on every write and read. When you write your code will block and wait until someone starts reading on the other end. When you read your code will block and wait until someone starts writing on the other end. </p>\n\n<p>In your case calculations in goroutines will be done concurrently (not necessary in parallel) but will block on channel write. Your main goroutine will block on the first read, read the value. Block on the second read, read the value.</p>\n\n<p>Even if you use a buffered channel - <code>c := make(chan int, 2)</code>. Your goroutines will finish calculations, write resuls to the channel without blocking and terminate. Nothing will be corrupted. In the meantime main goroutine will block on channel read and wait until someone writes to it.</p>\n\n<p>I suggest you read <a href=\"https://golang.org/doc/effective_go.html#channels\" rel=\"nofollow\">effective go</a>, <a href=\"https://blog.golang.org/pipelines\" rel=\"nofollow\">Go Concurrency Patterns</a> and try <a href=\"https://tour.golang.org/concurrency/1\" rel=\"nofollow\">A Tour of Go</a></p>\n"}], "owner": {"reputation": 1819, "user_id": 4379891, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/00537a374fd78cbd4f92745dbb2ee0f0?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4379891/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1134, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1457312316, "creation_date": 1457305907, "last_edit_date": 1457309796, "question_id": 35833793, "link": "https://stackoverflow.com/questions/35833793/why-can-you-reuse-channels-in-go-when-doing-parallel-processing", "title": "Why can you reuse channels in Go when doing parallel processing?", "body": "<p>Here is a code snippet from the <a href=\"https://tour.golang.org/concurrency/2\" rel=\"nofollow\">official tutorial</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc sum(s []int, c chan int) {\n    sum := 0\n    for _, v := range s {\n        sum += v\n    }\n    c &lt;- sum // send sum to c\n}\n\nfunc main() {\n    s := []int{7, 2, 8, -9, 4, 0}\n\n    c := make(chan int)\n    go sum(s[:len(s)/2], c)\n    go sum(s[len(s)/2:], c)\n    x, y := &lt;-c, &lt;-c // receive from c\n\n    fmt.Println(x, y, x+y)\n}\n</code></pre>\n\n<p>Since we are doing the calculation in parallel, and each thread saves its result into the same channel, doesn't this screw up the data?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1457310760, "post_id": 35833459, "comment_id": 59335755, "body": "We can only guess what you did. Provide us with a reproducible example: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a>"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1457318141, "post_id": 35833459, "comment_id": 59337495, "body": "Further, you should have a single GOPATH (don&#39;t set it dynamically). vendor your dependencies using gvt or gb, rather than trying to fight GOPATH."}], "answers": [{"tags": [], "owner": {"reputation": 468, "user_id": 1117026, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1b833426c9221e4b886def0ddd170d05?s=128&d=identicon&r=PG", "display_name": "elgris", "link": "https://stackoverflow.com/users/1117026/elgris"}, "is_accepted": true, "score": 0, "last_activity_date": 1457324684, "creation_date": 1457324684, "answer_id": 35836155, "question_id": 35833459, "link": "https://stackoverflow.com/questions/35833459/go-install-but-unable-to-run-app-from-folders-uther-than-bin/35836155#35836155", "title": "go install but unable to run app from folders uther than bin", "body": "<p><code>go install</code> installs a binary to <code>$GOPATH/bin</code> which is likely does not present in <code>PATH</code> env variable of your OS.</p>\n\n<p>You need to add<code>$GOPATH/bin</code> to your <code>PATH</code>: </p>\n\n<pre><code>export PATH=$GOPATH/bin:$PATH\n</code></pre>\n"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 35836155, "answer_count": 1, "score": -4, "last_activity_date": 1457324684, "creation_date": 1457303514, "question_id": 35833459, "link": "https://stackoverflow.com/questions/35833459/go-install-but-unable-to-run-app-from-folders-uther-than-bin", "title": "go install but unable to run app from folders uther than bin", "body": "<p>On a mac computer I set the export <code>export GOPATH=$(pwd)</code>.</p>\n\n<p><code>go install</code> is running fine and the bin folder contains the app, but I am unable to run the app/binary?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 43776, "user_id": 5031275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h8FTg.png?s=128&g=1", "display_name": "Blakes Seven", "link": "https://stackoverflow.com/users/5031275/blakes-seven"}, "edited": false, "score": 0, "creation_date": 1457299965, "post_id": 35832113, "comment_id": 59332609, "body": "Look at the documentation for <a href=\"https://docs.mongodb.org/manual/reference/operator/query/and/\" rel=\"nofollow noreferrer\"><code>$and</code></a>. It&#39;s argument(s) is an &quot;array&quot; <code>[]</code>, and the BSON map you are suppliying is <b>not</b> an array. Nor do you acutally need to use the <code>$and</code> since <b>ALL</b> MongoDB query conditions are <b>altready</b> and &quot;AND&quot; condition unless explicitly stated otherwise ( i.e <code>&quot;timestamp&quot;: { &quot;$gt&quot;: data, &quot;$lt&quot;: data }</code> is another way of writing an &quot;AND&quot;. So simply remove the wrapping <code>&quot;$and&quot;:: bson.M{ }</code> and just use the conditions directly as the keys of the map for the query."}], "answers": [{"tags": [], "owner": {"reputation": 3000, "user_id": 1335245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b201e069f3e6868c1c0285f6e31801c?s=128&d=identicon&r=PG", "display_name": "Charney Kaye", "link": "https://stackoverflow.com/users/1335245/charney-kaye"}, "is_accepted": true, "score": 2, "last_activity_date": 1457310792, "creation_date": 1457310792, "answer_id": 35834402, "question_id": 35832113, "link": "https://stackoverflow.com/questions/35832113/and-expression-must-be-a-nonempty-array/35834402#35834402", "title": "$and expression must be a nonempty array", "body": "<p>Try:</p>\n\n<pre><code>q := bson.M{\n    \"btId\": neighbour.BtId,\n    \"timestamp\": bson.M{\n        \"$gt\": sensorDataStartPoint.Timestamp,\n        \"$lt\": sensorDataStartPoint.Timestamp.Add(time.Second * 3000),\n    },\n}\n</code></pre>\n\n<p>It's unnecessary to use <code>$and</code> since that's the default for a MongoDB query.</p>\n\n<p>Also note, if it was necessary to use an <code>$and</code> the parameters expected there are an array, not a map!</p>\n"}], "owner": {"reputation": 1245, "user_id": 2343398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f6ae55829560a4852a675f25e1729a3d?s=128&d=identicon&r=PG", "display_name": "user2343398", "link": "https://stackoverflow.com/users/2343398/user2343398"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3942, "favorite_count": 0, "accepted_answer_id": 35834402, "answer_count": 1, "score": 1, "last_activity_date": 1457310792, "creation_date": 1457295991, "question_id": 35832113, "link": "https://stackoverflow.com/questions/35832113/and-expression-must-be-a-nonempty-array", "title": "$and expression must be a nonempty array", "body": "<p>I'm trying to create a query with mgo lib.</p>\n\n<pre><code>q := bson.M{\n    \"$and\": bson.M{\n        \"btId\": neighbour.BtId,\n        \"timestamp\": bson.M{\n            \"$gt\": sensorDataStartPoint.Timestamp,\n            \"$lt\": sensorDataStartPoint.Timestamp.Add(time.Second * 3000),\n        },\n    },\n}\n</code></pre>\n\n<p>So this renders into <code>map[$and:map[btId:BTR0102 timestamp:map[$gt:2012-04-11 19:08:59 +0200 CEST $lt:2012-04-11 19:58:59 +0200 CEST]]]</code> but I get error <code>$and expression must be a nonempty array</code> when trying to execute the query</p>\n\n<p>It should be : <code>btId = \"123\" AND timestamp &gt; sensorDataStartPoint.Timestamp AND timestamp &lt; sensorDataStartPoint.Timestamp + 3000s</code></p>\n\n<p>Thank you</p>\n"}, {"tags": ["variables", "go", "syntax", "declaration"], "comments": [{"owner": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "edited": false, "score": 2, "creation_date": 1457289077, "post_id": 35830676, "comment_id": 59328470, "body": "The syntax described here: <a href=\"https://tour.golang.org/basics/11\" rel=\"nofollow noreferrer\">tour.golang.org/basics/11</a>"}, {"owner": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "edited": false, "score": 1, "creation_date": 1457289275, "post_id": 35830676, "comment_id": 59328534, "body": "I didn&#39;t downvote you but I&#39;m guessing that the downvote is because this is a very, very basic concept in go. It&#39;s introduced in the second page of the go tutorial - that&#39;s how basic it is: <a href=\"https://tour.golang.org/basics/2\" rel=\"nofollow noreferrer\">tour.golang.org/basics/2</a>"}, {"owner": {"reputation": 15751, "user_id": 1345655, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2f01aca0b4d2d9347a6fd0f16f24d084?s=128&d=identicon&r=PG", "display_name": "Kshitiz Sharma", "link": "https://stackoverflow.com/users/1345655/kshitiz-sharma"}, "edited": false, "score": 0, "creation_date": 1507632806, "post_id": 35830676, "comment_id": 80278007, "body": "I up voted it because reading through a tutorial may not be everyone&#39;s preferred method of learning. If you&#39;re experienced with other languages, its quite helpful to just go through the source of a library/framework and google for things you find different from your language of expertise."}, {"owner": {"reputation": 4016, "user_id": 1580288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73de4b89ab05e67f13a4c0433c43ad23?s=128&d=identicon&r=PG", "display_name": "EthanB", "link": "https://stackoverflow.com/users/1580288/ethanb"}, "edited": false, "score": 0, "creation_date": 1535071596, "post_id": 35830676, "comment_id": 90941477, "body": "FYI: the Tour calls it a &quot;&#39;factored&#39; block&quot;, but the language spec doesn&#39;t even mention that much."}, {"owner": {"reputation": 4016, "user_id": 1580288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73de4b89ab05e67f13a4c0433c43ad23?s=128&d=identicon&r=PG", "display_name": "EthanB", "link": "https://stackoverflow.com/users/1580288/ethanb"}, "edited": false, "score": 0, "creation_date": 1535071644, "post_id": 35830676, "comment_id": 90941487, "body": "I also didn&#39;t pick up on the syntax when I ran through the tour. Page 11 was way too subtle for me (and/or I suppose I skim through text a little much) and page 2 is talking about imports -- which often have completely different syntax than variable declarations. I&#39;m only here now because I&#39;m trying to figure out what to call the syntax sugar now that I&#39;ve seen it."}], "answers": [{"tags": [], "owner": {"reputation": 20703, "user_id": 2805033, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TasHL.jpg?s=128&g=1", "display_name": "Ben Darnell", "link": "https://stackoverflow.com/users/2805033/ben-darnell"}, "is_accepted": false, "score": 8, "last_activity_date": 1457288641, "creation_date": 1457288641, "answer_id": 35830718, "question_id": 35830676, "link": "https://stackoverflow.com/questions/35830676/what-is-this-parenthesis-enclosed-variable-declaration-syntax-in-go/35830718#35830718", "title": "What is this parenthesis enclosed variable declaration syntax in Go?", "body": "<p><code>var (...)</code> (and <code>const (...)</code> are just shorthand that let you avoid repeating the <code>var</code> keyword. It doesn't make a lot of sense with a single variable like this, but if you have multiple variables it can look nicer to group them this way.</p>\n\n<p>It doesn't have anything to do with exporting. Variables declared in this way are exported (or not) based on the capitalization of their name, just like variables declared without the parentheses.</p>\n"}, {"comments": [{"owner": {"reputation": 2714, "user_id": 752297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lDqC1.jpg?s=128&g=1", "display_name": "ripat", "link": "https://stackoverflow.com/users/752297/ripat"}, "edited": false, "score": 0, "creation_date": 1593934103, "post_id": 35830737, "comment_id": 110945475, "body": "Also worth mentioning that <code>go fmt</code> does a pretty indenting for better readability with the <code>var(...)</code> syntax."}, {"owner": {"reputation": 3075, "user_id": 3014041, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7433d852e4ed35b9a7651702dacb40d6?s=128&d=identicon&r=PG&f=1", "display_name": "naneri", "link": "https://stackoverflow.com/users/3014041/naneri"}, "edited": false, "score": 0, "creation_date": 1613228273, "post_id": 35830737, "comment_id": 117013711, "body": "Why it does no need to add a semicolon like  rootDir := path.Join(home(), &quot;.coolconfig&quot;) ?"}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": true, "score": 17, "last_activity_date": 1594121108, "last_edit_date": 1594121108, "creation_date": 1457288731, "answer_id": 35830737, "question_id": 35830676, "link": "https://stackoverflow.com/questions/35830676/what-is-this-parenthesis-enclosed-variable-declaration-syntax-in-go/35830737#35830737", "title": "What is this parenthesis enclosed variable declaration syntax in Go?", "body": "<p>This code</p>\n<pre><code>// What's this syntax ? Is it exported ? \nvar (\n    rootDir = path.Join(home(), &quot;.coolconfig&quot;)\n)\n</code></pre>\n<p>is just a longer way of writing</p>\n<pre><code>var rootDir = path.Join(home(), &quot;.coolconfig&quot;)\n</code></pre>\n<p>However it is useful when declaring lots of vars at once.  Instead of</p>\n<pre><code>var one string\nvar two string\nvar three string\n</code></pre>\n<p>You can write</p>\n<pre><code>var (\n    one string\n    two string\n    three string\n)\n</code></pre>\n<p>The same trick works with <code>const</code> and <code>type</code> too.</p>\n"}], "owner": {"reputation": 18004, "user_id": 675100, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jTqPB.png?s=128&g=1", "display_name": "Patryk", "link": "https://stackoverflow.com/users/675100/patryk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2353, "favorite_count": 1, "accepted_answer_id": 35830737, "answer_count": 2, "score": 9, "last_activity_date": 1594121108, "creation_date": 1457288433, "last_edit_date": 1457289005, "question_id": 35830676, "link": "https://stackoverflow.com/questions/35830676/what-is-this-parenthesis-enclosed-variable-declaration-syntax-in-go", "title": "What is this parenthesis enclosed variable declaration syntax in Go?", "body": "<p>I am trying to find some information on parenthesis enclosed variable declaration syntax in Go but maybe I just do not know its name and that's why I cannot find it (just like with e.g. value and pointer receivers).</p>\n\n<p>Namely I would like to know the rules behind this type of syntax:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"path\"\n)\n\n// What's this syntax ? Is it exported ? \nvar (\n    rootDir = path.Join(home(), \".coolconfig\")\n)\n\nfunc main() {\n  // whatever\n}\n</code></pre>\n\n<p>Are those variables in <code>var ()</code> block available in modules that import this one?</p>\n"}, {"tags": ["go", "docker", "delve"], "comments": [{"owner": {"reputation": 4143, "user_id": 1034255, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08361c2fe2bb01912c7a64ac848db2fd?s=128&d=identicon&r=PG", "display_name": "jupp0r", "link": "https://stackoverflow.com/users/1034255/jupp0r"}, "edited": false, "score": 0, "creation_date": 1457343125, "post_id": 35827819, "comment_id": 59346458, "body": "what container are you running?"}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 4143, "user_id": 1034255, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08361c2fe2bb01912c7a64ac848db2fd?s=128&d=identicon&r=PG", "display_name": "jupp0r", "link": "https://stackoverflow.com/users/1034255/jupp0r"}, "edited": false, "score": 0, "creation_date": 1457343253, "post_id": 35827819, "comment_id": 59346528, "body": "<a href=\"https://hub.docker.com/_/golang/\" rel=\"nofollow noreferrer\">hub.docker.com/_/golang</a>"}], "answers": [{"tags": [], "owner": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "is_accepted": true, "score": 3, "last_activity_date": 1461336547, "creation_date": 1461336547, "answer_id": 36796964, "question_id": 35827819, "link": "https://stackoverflow.com/questions/35827819/fork-exec-debug-operation-not-permitted/36796964#36796964", "title": "fork/exec ./debug: operation not permitted", "body": "<p>It seems to work if you start the container with <code>--privileged</code>. I've tried to figure out if there is a more fine-grained capability but failed.</p>\n\n<p>Also I just found <a href=\"https://github.com/steeve/homebrew-delve\" rel=\"nofollow\">https://github.com/steeve/homebrew-delve</a> which should make things easier on OSX.</p>\n"}, {"tags": [], "owner": {"reputation": 5001, "user_id": 902217, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/w2DJ9.gif?s=128&g=1", "display_name": "CAMOBAP", "link": "https://stackoverflow.com/users/902217/camobap"}, "is_accepted": false, "score": 5, "last_activity_date": 1487945748, "creation_date": 1487945748, "answer_id": 42440893, "question_id": 35827819, "link": "https://stackoverflow.com/questions/35827819/fork-exec-debug-operation-not-permitted/42440893#42440893", "title": "fork/exec ./debug: operation not permitted", "body": "<p>According <a href=\"https://github.com/derekparker/delve/issues/515\" rel=\"noreferrer\">Delve Issue #515</a></p>\n\n<blockquote>\n  <p>Docker has security settings preventing ptrace(2) operations by\n  default with in the container. Pass --security-opt seccomp:unconfined\n  to docker run when starting.</p>\n</blockquote>\n\n<p>*confirmation of this in official docker bug tracker <a href=\"https://github.com/docker/docker/issues/21051\" rel=\"noreferrer\">https://github.com/docker/docker/issues/21051</a></p>\n"}, {"tags": [], "owner": {"reputation": 3641, "user_id": 3139595, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/r1GRx.png?s=128&g=1", "display_name": "Edwin O.", "link": "https://stackoverflow.com/users/3139595/edwin-o"}, "is_accepted": false, "score": 2, "last_activity_date": 1506897569, "creation_date": 1506897569, "answer_id": 46517562, "question_id": 35827819, "link": "https://stackoverflow.com/questions/35827819/fork-exec-debug-operation-not-permitted/46517562#46517562", "title": "fork/exec ./debug: operation not permitted", "body": "<p>Docker has security settings preventing ptrace(2)</p>\n\n<p>See how i fixed it.</p>\n\n<p>if using a docker-compose file to run the container then append <code>seccomp:unconfined</code> in the services section like below</p>\n\n<pre><code>api: \n  security_opt:\n    - seccomp:unconfined\n</code></pre>\n\n<p>if using docker run ...passing <code>seccomp:unconfined</code> works as well</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8157703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d075b9deac065a23c2431590053c851b?s=128&d=identicon&r=PG&f=1", "display_name": "user8157703", "link": "https://stackoverflow.com/users/8157703/user8157703"}, "is_accepted": false, "score": 0, "last_activity_date": 1548927911, "last_edit_date": 1548927911, "creation_date": 1548924028, "answer_id": 54456427, "question_id": 35827819, "link": "https://stackoverflow.com/questions/35827819/fork-exec-debug-operation-not-permitted/54456427#54456427", "title": "fork/exec ./debug: operation not permitted", "body": "<p>Run Docker container as a command:</p>\n\n<pre><code>docker run -itd -p 2028:22 -p 2345:2345 --dns=10.236.8.8 --privileged=true --name=golang  centos7-golang  /usr/bin/supervisord\n</code></pre>\n\n<p>it works for me~</p>\n"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5463, "favorite_count": 1, "accepted_answer_id": 36796964, "answer_count": 4, "score": 8, "last_activity_date": 1548927911, "creation_date": 1457273087, "last_edit_date": 1457295250, "question_id": 35827819, "link": "https://stackoverflow.com/questions/35827819/fork-exec-debug-operation-not-permitted", "title": "fork/exec ./debug: operation not permitted", "body": "<p>My goal is to be able to remote debug from <a href=\"https://atom.io\" rel=\"noreferrer\">Atom.io</a>. into a docker container running go in <a href=\"https://github.com/derekparker/delve\" rel=\"noreferrer\">dlv debugger</a>. This is the first problem:</p>\n\n<p>Update:1. I am running Docker container on a mac, but that should not influence the code signing thing as I am running in a container, right?</p>\n\n<p>Update:2. Codesignig the host, did not help.</p>\n\n<pre><code>Error:\n\n1. root@...:/go/src/app# go get github.com/derekparker/delve/cmd/dlv\n\n2. root@...:/go/src/app# dlv debug hello.go\n\ncould not launch process: fork/exec ./debug: operation not permitted\n</code></pre>\n\n<p>Then tried to</p>\n\n<pre><code>1. root@...:/go/src/app# sudo\n\n2. bash: sudo: command not found\n</code></pre>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1457272195, "post_id": 35827442, "comment_id": 59321890, "body": "This is entirely dependent on the logic in your program. Closing a channel is not a cleanup operation, and a buttered channel doesn&#39;t need to be empty to be GC&#39;ed, so neither of these are required."}], "answers": [{"tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": 7, "last_activity_date": 1457272483, "creation_date": 1457272483, "answer_id": 35827694, "question_id": 35827442, "link": "https://stackoverflow.com/questions/35827442/should-one-drain-a-buffered-channel-when-closing-it/35827694#35827694", "title": "Should one drain a buffered channel when closing it", "body": "<p>It depends on your program, but generally speaking I would tend to say no (you don't need to clear the channel before closing it): if there is items in your channel when you close it, any reader still reading from the channel will receive the items until the channel is emtpy.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>package main\n\nimport (\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n\n    var ch = make(chan int, 5)\n    var wg sync.WaitGroup\n    wg.Add(1)\n\n    for range make([]struct{}, 2) {\n        go func() {\n            for i := range ch {\n                wg.Wait()\n                println(i)\n            }\n        }()\n    }\n\n    for i := 0; i &lt; 5; i++ {\n        ch &lt;- i\n    }\n    close(ch)\n\n    wg.Done()\n    time.Sleep(1 * time.Second)\n}\n</code></pre>\n\n<p>Here, the program will output all the items, despite the fact that the channel is closed strictly before any reader can even read from the channel.</p>\n"}, {"comments": [{"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 0, "creation_date": 1457276172, "post_id": 35828242, "comment_id": 59323298, "body": "I use this pattern right now and will stick to it. After all it feels the only thing I need to do is to set the channel to nil in the publisher so that after the workers are terminated, the GC cleans up the channel and its content."}, {"owner": {"reputation": 344, "user_id": 9471220, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8CRMT.jpg?s=128&g=1", "display_name": "umi0410", "link": "https://stackoverflow.com/users/9471220/umi0410"}, "edited": false, "score": 0, "creation_date": 1603215909, "post_id": 35828242, "comment_id": 113964864, "body": "Why should we use and pass <code>done</code> channel? I guess only for loop with <code>in</code> channel is needed."}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 7, "last_activity_date": 1457275478, "creation_date": 1457275478, "answer_id": 35828242, "question_id": 35827442, "link": "https://stackoverflow.com/questions/35827442/should-one-drain-a-buffered-channel-when-closing-it/35828242#35828242", "title": "Should one drain a buffered channel when closing it", "body": "<p>There are better ways to achieve what you're trying to achieve. Your current approach can just lead to throwing away some records, and processing other records randomly (since the draining loop is racing all the consumers). That doesn't really address the goal.</p>\n\n<p>What you want is cancellation. Here's an example from <a href=\"http://blog.golang.org/pipelines\" rel=\"noreferrer\">Go Concurrency Patterns: Pipelines and cancellation</a></p>\n\n<pre><code>func sq(done &lt;-chan struct{}, in &lt;-chan int) &lt;-chan int {\n    out := make(chan int)\n    go func() {\n        defer close(out)\n        for n := range in {\n            select {\n            case out &lt;- n * n:\n            case &lt;-done:\n                return\n            }\n        }\n    }()\n    return out\n}\n</code></pre>\n\n<p>You pass a <code>done</code> channel to all the goroutines, and you close it when you want them all to stop processing. If you do this a lot, you may find the <code>golang.org/x/net/context</code> package useful, which formalizes this pattern, and adds some extra features (like timeout).</p>\n"}, {"comments": [{"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1457283661, "post_id": 35828715, "comment_id": 59326315, "body": "Your context paragraph wasn&#39;t here when I wrote my answer."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1457284053, "post_id": 35828715, "comment_id": 59326462, "body": "Now, using both atomic operations and sync routines feels wrong to me: you don&#39;t need to do a <code>CompareAndSwap</code>if you&#39;re going to lock right after that...  In your case, you may simply want your <code>Stop</code> method to set a boolean flag to <code>true</code>, and your workers to check that boolean to break out of their loop. That doesn&#39;t even require any syncing depending on your requirements."}, {"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "reply_to_user": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1457287162, "post_id": 35828715, "comment_id": 59327722, "body": "@Elwinar Sorry I did not have the context when you posted your answer. I only realised it could help after I read it. With respect to your remark about locking: locking is irrelevant to this question, but here the atomic is checked on submission on new tasks (without locking) and locking is used for starting and stopping only. But thanks to your comment, I realised how I can leave it out by changing the start method (not shown here)."}], "tags": [], "owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "is_accepted": false, "score": 1, "last_activity_date": 1457287189, "last_edit_date": 1457287189, "creation_date": 1457277955, "answer_id": 35828715, "question_id": 35827442, "link": "https://stackoverflow.com/questions/35827442/should-one-drain-a-buffered-channel-when-closing-it/35828715#35828715", "title": "Should one drain a buffered channel when closing it", "body": "<p>I feel that the supplied answers actually do not clarify much apart from the hints that <strong>neither drain nor closing is needed</strong>. As such the following solution for the described context looks clean to me that terminates the workers and removes all references to them or the channel in question, thus, letting the GC to clean up the channel and its content:</p>\n\n<pre><code>type worker struct {\n    submitted chan Task\n    stop      chan bool\n    p         *Processor\n}\n\n// executed in a goroutine\nfunc (w *worker) run() {\n    for {\n        select {\n        case task := &lt;-w.submitted:\n            if err := task.Execute(w.p); err != nil {\n                logger.Error(err.Error())\n            }\n        case &lt;-w.stop:\n            logger.Warn(\"Worker stopped\")\n            return\n        }\n    }\n}\n\nfunc (p *Processor) Stop() {\n    if atomic.CompareAndSwapInt32(&amp;p.status, running, stopped) {\n        for _, w := range p.workers {\n            w.stop &lt;- true\n        }\n        // GC all workers as soon as goroutines stop\n        p.workers = nil\n        // GC all published data when workers terminate\n        p.submitted = nil\n        // no need to do the following above:\n        // close(p.submitted)\n        // for range p.submitted {}\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10175, "favorite_count": 3, "accepted_answer_id": 35828242, "answer_count": 3, "score": 5, "last_activity_date": 1457287189, "creation_date": 1457270977, "last_edit_date": 1457273033, "question_id": 35827442, "link": "https://stackoverflow.com/questions/35827442/should-one-drain-a-buffered-channel-when-closing-it", "title": "Should one drain a buffered channel when closing it", "body": "<p>Given a (partially) filled buffered channel in Go</p>\n\n<pre><code>ch := make(chan *MassiveStruct, n)\nfor i := 0; i &lt; n; i++ {\n    ch &lt;- NewMassiveStruct()\n}\n</code></pre>\n\n<p>is it advisable to also drain the channel when closing it (by the writer) in case it is unknown when readers are going read from it (e.g. there is a limited number of those and they are currently busy)? That is</p>\n\n<pre><code>close(ch)\nfor range ch {}\n</code></pre>\n\n<p>Is such a loop guaranteed to end if there are other concurrent readers on the channel?</p>\n\n<p><strong>Context</strong>: a queue service with a fixed number of workers, which should drop processing anything queued when the service is going down (but not necessarily being GCed right after). So I am closing to indicate to the workers that the service is being terminated. I could drain the remaining \"queue\" immediately letting the GC free the resources allocated, I could read and ignore the values in the workers and I could leave the channel as is running down the readers and setting the channel to nil in the writer so that the GC cleans up everything. I am not sure which is the cleanest way.</p>\n"}, {"tags": ["go", "tdd", "viper-go"], "answers": [{"tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 17, "last_activity_date": 1457273283, "creation_date": 1457273283, "answer_id": 35827855, "question_id": 35827147, "link": "https://stackoverflow.com/questions/35827147/cobra-viper-golang-how-to-test-subcommands/35827855#35827855", "title": "Cobra + Viper Golang How to test subcommands?", "body": "<p>When I use Cobra/Viper or any other combination of CLI helpers, my way of doing this is to have the CLI tool run a function whose sole purpose will be to get arguments and pass them to another method who will do the actual work. </p>\n\n<p>Here is a short (and dumb) example using Cobra :</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"os\"\n\n        \"github.com/spf13/cobra\"\n)\n\nfunc main() {\n        var Cmd = &amp;cobra.Command{\n                Use:   \"boom\",\n                Short: \"Explode all the things!\",\n                Run:   Boom,\n        }\n\n        if err := Cmd.Execute(); err != nil {\n                fmt.Println(err)\n                os.Exit(-1)\n        }\n}\n\nfunc Boom(cmd *cobra.Command, args []string) {\n        boom(args...)\n}\n\nfunc boom(args ...string) {\n        for _, arg := range args {\n                println(\"boom \" + arg)\n        }\n}\n</code></pre>\n\n<p>Here, the <code>Boom</code> function is hard to test, but the <code>boom</code> one is easy.</p>\n\n<p>You can see another (non-dumb) example of this <a href=\"https://github.com/elwinar/rambler/blob/master/apply.go\" rel=\"noreferrer\">here</a> (and the correspond test <a href=\"https://github.com/elwinar/rambler/blob/master/apply_test.go\" rel=\"noreferrer\">here</a>).</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 5549820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27984e25c29f992199e3ab6e1af7bc82?s=128&d=identicon&r=PG&f=1", "display_name": "fireplay", "link": "https://stackoverflow.com/users/5549820/fireplay"}, "is_accepted": false, "score": 1, "last_activity_date": 1563863674, "creation_date": 1563863674, "answer_id": 57157988, "question_id": 35827147, "link": "https://stackoverflow.com/questions/35827147/cobra-viper-golang-how-to-test-subcommands/57157988#57157988", "title": "Cobra + Viper Golang How to test subcommands?", "body": "<p>i have found an easy way to test commands with multiple level sub  commands, it is not professional but it worked well.</p>\n\n<p>assume we have a command like this</p>\n\n<pre><code>RootCmd = &amp;cobra.Command{\n            Use:   \"cliName\",\n            Short: \"Desc\",\n    }\n\nSubCmd = &amp;cobra.Command{\n            Use:   \"subName\",\n            Short: \"Desc\",\n    }\n\nsubOfSubCmd = &amp;cobra.Command{\n            Use:   \"subOfSub\",\n            Short: \"Desc\",\n            Run: Exec\n    }\n\n//commands relationship\nRootCmd.AddCommand(SubCmd)\nSubCmd.AddCommand(subOfSubCmd)\n</code></pre>\n\n<p>When testing the subOfSubCmd we can do this way:</p>\n\n<pre><code>func TestCmd(t *testing.T) {\nconvey.Convey(\"test cmd\", t, func() {\n    args := []string{\"subName\", \"subOfSub\"}\n    RootCmd.SetArgs(args)\n    RootCmd.Execute()\n    })\n}\n</code></pre>\n"}], "owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8361, "favorite_count": 4, "accepted_answer_id": 35827855, "answer_count": 2, "score": 12, "last_activity_date": 1563863674, "creation_date": 1457269435, "last_edit_date": 1499629341, "question_id": 35827147, "link": "https://stackoverflow.com/questions/35827147/cobra-viper-golang-how-to-test-subcommands", "title": "Cobra + Viper Golang How to test subcommands?", "body": "<p>I am developing an web app with Go. So far so good, but now I am integrating Wercker as a CI tool and started caring about testing. But my app relies heavily on Cobra/Viper configuration/flags/environment_variables scheme, and I do not know how to properly init Viper values before running my test suite. Any help would be much appreciated. </p>\n"}, {"tags": ["go", "deferred"], "comments": [{"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 1, "creation_date": 1457268690, "post_id": 35826973, "comment_id": 59320705, "body": "why are you deferring the call to <code>Close()</code> anyway? If you have to call it you can just leave the defer out?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6025185, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_6mfnsQM1gY/AAAAAAAAAAI/AAAAAAAAACI/uCJFiJ-tghM/photo.jpg?sz=128", "display_name": "\u9648\u963f\u8fbe", "link": "https://stackoverflow.com/users/6025185/%e9%99%88%e9%98%bf%e8%be%be"}, "edited": false, "score": 0, "creation_date": 1457275398, "post_id": 35827065, "comment_id": 59322996, "body": "Yes, I want to make change to the file and then rename it. As the suggestion, it won&#39;t add the Close() to defer. But if that, something panic between the Open() and Close(), the Close() will not be called by defer."}, {"owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "reply_to_user": {"reputation": 9, "user_id": 6025185, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_6mfnsQM1gY/AAAAAAAAAAI/AAAAAAAAACI/uCJFiJ-tghM/photo.jpg?sz=128", "display_name": "\u9648\u963f\u8fbe", "link": "https://stackoverflow.com/users/6025185/%e9%99%88%e9%98%bf%e8%be%be"}, "edited": false, "score": 1, "creation_date": 1457276547, "post_id": 35827065, "comment_id": 59323472, "body": "Then split the execution in two parts. A part that performs the file modification, where you open/edit/close, and a part where you rename. Don&#39;t mix all the intent in a single method,"}, {"owner": {"reputation": 9, "user_id": 6025185, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_6mfnsQM1gY/AAAAAAAAAAI/AAAAAAAAACI/uCJFiJ-tghM/photo.jpg?sz=128", "display_name": "\u9648\u963f\u8fbe", "link": "https://stackoverflow.com/users/6025185/%e9%99%88%e9%98%bf%e8%be%be"}, "edited": false, "score": 0, "creation_date": 1457329279, "post_id": 35827065, "comment_id": 59340327, "body": "Thanks for the suggestion. Split and do not mix the intent is a good way."}], "tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": false, "score": 1, "last_activity_date": 1457268894, "creation_date": 1457268894, "answer_id": 35827065, "question_id": 35826973, "link": "https://stackoverflow.com/questions/35826973/close-the-file-before-rename-it-in-golang/35827065#35827065", "title": "Close the file before rename it in golang", "body": "<p>There are a few things that are not clear to me about your code.</p>\n\n<p>First of all, why do you open the file before renaming it? This is not required by the <a href=\"https://golang.org/pkg/os/#Rename\" rel=\"nofollow\"><code>os.Rename</code></a> function. The function takes two strings representing the old and new file name, there is no need to pass a file pointer.</p>\n\n<pre><code>func main() {\n    ...\n    ...\n    os.Rename(\"myfile.log\", \"myfile1.log\")\n}\n</code></pre>\n\n<p>Assuming you need to make changes to the file content (which doesn't seem to be the case given the <code>ugly_solution</code> method) and you have to open the file, then why deferring <code>file.Close()</code>? You don't have to defer the method if you need it to be called explicitly somewhere in the same method. Simply call it.</p>\n\n<pre><code>func main() {\n    pfile1, _ := os.Open(\"myfile.log\")\n    ...\n    ...\n    pfile1.Close()\n    os.Rename(\"myfile.log\", \"myfile1.log\")\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 6025185, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_6mfnsQM1gY/AAAAAAAAAAI/AAAAAAAAACI/uCJFiJ-tghM/photo.jpg?sz=128", "display_name": "\u9648\u963f\u8fbe", "link": "https://stackoverflow.com/users/6025185/%e9%99%88%e9%98%bf%e8%be%be"}, "edited": false, "score": 0, "creation_date": 1457275737, "post_id": 35827078, "comment_id": 59323124, "body": "But the rename will be called when function exit, maybe I want to add more code after the rename. It will not flexible."}], "tags": [], "owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "is_accepted": false, "score": 2, "last_activity_date": 1457268963, "creation_date": 1457268963, "answer_id": 35827078, "question_id": 35826973, "link": "https://stackoverflow.com/questions/35826973/close-the-file-before-rename-it-in-golang/35827078#35827078", "title": "Close the file before rename it in golang", "body": "<p>You can put both closing and renaming the file in the defer:</p>\n\n<pre><code>func main() { \n    pfile1, _ := os.Open(\"myfile.log\")\n    defer func(){\n        pfile1.Close()\n        os.Rename(\"myfile.log\", \"myfile1.log\")   \n    }() \n    ...\n    ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 2132264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3264f82fdd0b3cf5dacf096f9ff240a?s=128&d=identicon&r=PG", "display_name": "Stilmant Michael", "link": "https://stackoverflow.com/users/2132264/stilmant-michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1544001773, "last_edit_date": 1544001773, "creation_date": 1544001204, "answer_id": 53628758, "question_id": 35826973, "link": "https://stackoverflow.com/questions/35826973/close-the-file-before-rename-it-in-golang/53628758#53628758", "title": "Close the file before rename it in golang", "body": "<p>In situation like in your sample</p>\n\n<p>Maybe you want to follow this scenario:</p>\n\n<ul>\n<li>Create easily an identifiable temporary file. </li>\n<li>Write the data.</li>\n<li>Close the file. </li>\n<li>If successful rename the file.</li>\n</ul>\n\n<p>In that case where you want to follow OS system action of underlying files maybe you want to simply not deferring the close on IO.file since you want to get the Error returned by the close function itself. </p>\n\n<p>Also, in that case you maybe want to operate a file.sync() too. </p>\n\n<p>See <a href=\"https://www.joeshaw.org/dont-defer-close-on-writable-files/\" rel=\"nofollow noreferrer\">https://www.joeshaw.org/dont-defer-close-on-writable-files/</a></p>\n"}], "owner": {"reputation": 9, "user_id": 6025185, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_6mfnsQM1gY/AAAAAAAAAAI/AAAAAAAAACI/uCJFiJ-tghM/photo.jpg?sz=128", "display_name": "\u9648\u963f\u8fbe", "link": "https://stackoverflow.com/users/6025185/%e9%99%88%e9%98%bf%e8%be%be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3412, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1544001773, "creation_date": 1457268275, "question_id": 35826973, "link": "https://stackoverflow.com/questions/35826973/close-the-file-before-rename-it-in-golang", "title": "Close the file before rename it in golang", "body": "<p>When I do some file operations with golang, I firstly open a file and add the close() into defer list, then I try to rename that file. If I close the file manually, the defer will close it again. If I wait for the defer to close it, the rename will cause error because it is not closed yey. Code as below</p>\n\n<pre><code>func main() {\n\n    pfile1, _ := os.Open(\"myfile.log\")\n    defer pfile1.Close() //It will be closed again.\n    ...\n    ...\n    pfile1.Close() //I have to close it before rename it.\n    os.Rename(\"myfile.log\", \"myfile1.log\")\n}\n</code></pre>\n\n<p>I found some ugly solution, such as create another function to separate the open file, does any better solution that below?</p>\n\n<pre><code>func main() {\n\n    var pfile1 *os.File\n    ugly_solution(pfile1)\n\n    os.Rename(\"myfile.log\", \"myfile1.log\")\n}\n\nfunc ugly_solution(file *os.File) {\n    file, _ = os.Open(\"myfile.log\")\ndefer file.Close()\n}\n</code></pre>\n"}, {"tags": ["file", "go", "upload", "multipart"], "answers": [{"comments": [{"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1457266903, "post_id": 35826734, "comment_id": 59320193, "body": "Thank you.  I am trying to use this inside another form. so I tried that way. Is there any work around to use this inside another form? It would be very helpful"}, {"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "reply_to_user": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1457266959, "post_id": 35826734, "comment_id": 59320213, "body": "@DineshAppavoo Form inside form?"}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1457296868, "post_id": 35826734, "comment_id": 59331396, "body": "looks like it is not possible <a href=\"http://stackoverflow.com/questions/379610/can-you-nest-html-forms\">nest-forms</a>. I tried, the original form is getting collapsed. Is there any workaround for this?"}, {"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "reply_to_user": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 1, "creation_date": 1457335858, "post_id": 35826734, "comment_id": 59342795, "body": "@DineshAppavoo only one &quot;workaround&quot; that I can imagine is send files via AJAX and put their IDs into &quot;parent&quot; form. But I can&#39;t understand why do you need nested form at all if you can just send one with fields and files."}], "tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": true, "score": 4, "last_activity_date": 1457266667, "creation_date": 1457266667, "answer_id": 35826734, "question_id": 35826612, "link": "https://stackoverflow.com/questions/35826612/file-upload-failing-in-golang/35826734#35826734", "title": "File upload failing in golang", "body": "<p>To be honest I have no idea how do you even get error as your HTML is not form. But I think you getting error because by default form is send as GET request while <code>multipart/form-data</code> should be send via POST. Here is example of minimal form which should work.</p>\n\n<pre><code>&lt;form action=\"/uploadfile/\" enctype=\"multipart/form-data\" method=\"post\"&gt;\n    &lt;input type=\"file\" name=\"file\" id=\"file\" /&gt;\n    &lt;input type=\"hidden\"name=\"token\" value=\"{{.}}\" /&gt;\n    &lt;input type=\"submit\" value=\"upload\" /&gt;\n&lt;/form&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "edited": false, "score": 0, "creation_date": 1457267048, "post_id": 35826768, "comment_id": 59320243, "body": "He is not trying to send form from Go app. He can&#39;t get HTML form data in his Go app."}, {"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "reply_to_user": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "edited": false, "score": 0, "creation_date": 1457267350, "post_id": 35826768, "comment_id": 59320340, "body": "Yes, and this is the reason why he&#39;s receiving the above error."}, {"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "edited": false, "score": 1, "creation_date": 1457267501, "post_id": 35826768, "comment_id": 59320386, "body": "His Go code perfectly works with proper HTML form. And your link is about sending data from Go to remote service."}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 1, "last_activity_date": 1457266938, "creation_date": 1457266938, "answer_id": 35826768, "question_id": 35826612, "link": "https://stackoverflow.com/questions/35826612/file-upload-failing-in-golang/35826768#35826768", "title": "File upload failing in golang", "body": "<p>The issue is that you must include the header that contains the content type.</p>\n\n<pre><code>req.Header.Add(\"Content-Type\", writer.FormDataContentType())\n</code></pre>\n\n<p>This is included in the <a href=\"https://golang.org/pkg/mime/multipart/\" rel=\"nofollow\"><code>mime/multipart</code></a> package. </p>\n\n<p>For a working example please check <a href=\"https://matt.aimonetti.net/posts/2013/07/01/golang-multipart-file-upload-example/\" rel=\"nofollow\">this</a> blog post.</p>\n"}], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8371, "favorite_count": 0, "accepted_answer_id": 35826734, "answer_count": 2, "score": 4, "last_activity_date": 1457266938, "creation_date": 1457265689, "question_id": 35826612, "link": "https://stackoverflow.com/questions/35826612/file-upload-failing-in-golang", "title": "File upload failing in golang", "body": "<p>In my use case I am trying to upload a file to server in golang. I have the following html code,</p>\n\n<pre><code>&lt;div class=\"form-input upload-file\" enctype=\"multipart/form-data\" &gt;\n    &lt;input type=\"file\"name=\"file\" id=\"file\" /&gt;\n    &lt;input type=\"hidden\"name=\"token\" value=\"{{.}}\" /&gt;\n    &lt;a href=\"/uploadfile/\" data-toggle=\"tooltip\" title=\"upload\"&gt;\n        &lt;input type=\"button upload-video\" class=\"btn btn-primary btn-filled btn-xs\" value=\"upload\" /&gt;\n    &lt;/a&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And the server side,</p>\n\n<pre><code>func uploadHandler(w http.ResponseWriter, r *http.Request) {\n    // the FormFile function takes in the POST input id file\n    file, header, err := r.FormFile(\"file\")\n    if err != nil {\n        fmt.Fprintln(w, err)\n        return\n    }\n    defer file.Close()\n\n    out, err := os.Create(\"/tmp/uploadedfile\")\n    if err != nil {\n        fmt.Fprintf(w, \"Unable to create the file for writing. Check your write access privilege\")\n        return\n    }\n    defer out.Close()\n\n    // write the content from POST to the file\n    _, err = io.Copy(out, file)\n    if err != nil {\n        fmt.Fprintln(w, err)\n    }\n\n    fmt.Fprintf(w, \"File uploaded successfully : \")\n    fmt.Fprintf(w, header.Filename)\n}\n</code></pre>\n\n<p>When I try to upload the file, I am getting <code>request Content-Type isn't multipart/form-data</code> error in server side.</p>\n\n<p>Could anyone help me on this?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 405, "user_id": 2114780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a36c713960a084e733080489bb1172?s=128&d=identicon&r=PG", "display_name": "Dmitry Vodianyk", "link": "https://stackoverflow.com/users/2114780/dmitry-vodianyk"}, "edited": false, "score": 2, "creation_date": 1551793261, "post_id": 35822234, "comment_id": 96763550, "body": "This actually does not compile! <a href=\"https://play.golang.org/p/IN9vN3pfGui\" rel=\"nofollow noreferrer\">play.golang.org/p/IN9vN3pfGui</a> Here is the right version: <a href=\"https://play.golang.org/p/zh_qWbSkM5t\" rel=\"nofollow noreferrer\">play.golang.org/p/zh_qWbSkM5t</a>"}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 9, "last_activity_date": 1457229853, "creation_date": 1457229853, "answer_id": 35822234, "question_id": 35822102, "link": "https://stackoverflow.com/questions/35822102/json-single-value-parsing/35822234#35822234", "title": "JSON single value parsing", "body": "<p>You can decode into a <code>map[string]interface{}</code> and then get the element by key. </p>\n\n<pre><code>data := make(map[string]interface{})\nerr := json.Unmarshal(content, &amp;data)\nif err != nil {\n    return nil, err\n}\n\nprice, ok := data[\"ask_price\"].(string); !ok {\n    // ask_price is not a string\n    return nil, errors.New(\"wrong type\")\n}\n\n// Use price as you wish\n</code></pre>\n\n<p>Structs are often preferred as they are more explicit about the type. You only have to declare the fields in the JSON you care about, and you don't need to type assert the values as you would with a map (encoding/json handles that implicitly). </p>\n"}, {"tags": [], "owner": {"reputation": 2246, "user_id": 274937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d848784d081501a5cba4a2fa7856e965?s=128&d=identicon&r=PG", "display_name": "valyala", "link": "https://stackoverflow.com/users/274937/valyala"}, "is_accepted": false, "score": 3, "last_activity_date": 1527693388, "creation_date": 1527693388, "answer_id": 50608239, "question_id": 35822102, "link": "https://stackoverflow.com/questions/35822102/json-single-value-parsing/50608239#50608239", "title": "JSON single value parsing", "body": "<p>Try either <a href=\"https://github.com/valyala/fastjson\" rel=\"nofollow noreferrer\">fastjson</a> or <a href=\"https://github.com/buger/jsonparser\" rel=\"nofollow noreferrer\">jsonparser</a>. <code>jsonparser</code> is optimized for the case when a single JSON field must be selected, while <code>fastjson</code> is optimized for the case when multiple unrelated JSON fields must be selected.</p>\n\n<p>Below is an example code for <code>fastjson</code>:</p>\n\n<pre><code>var p fastjson.Parser\nv, err := p.Parse(content)\nif err != nil {\n    log.Fatal(err)\n}\n\n// obtain v[\"ask_price\"] as float64\nprice := v.GetFloat64(\"ask_price\")\n\n// obtain v[\"results\"][0] as generic JSON value\nresult0 := v.Get(\"results\", \"0\")\n</code></pre>\n"}], "owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9373, "favorite_count": 0, "accepted_answer_id": 35822234, "answer_count": 2, "score": 4, "last_activity_date": 1610098080, "creation_date": 1457228637, "last_edit_date": 1610098080, "question_id": 35822102, "link": "https://stackoverflow.com/questions/35822102/json-single-value-parsing", "title": "JSON single value parsing", "body": "<p>In python you can take a json object and grab a specific item from it without declaring a struct, saving to a struct then obtaining the value like in Go. Is there a package or easier way to store a specific value from json in Go?</p>\n\n<p>python</p>\n\n<pre><code>res = res.json()\nreturn res['results'][0] \n</code></pre>\n\n<p>Go</p>\n\n<pre><code>type Quotes struct {\nAskPrice string `json:\"ask_price\"`\n}\n\nquote := new(Quotes)\nerrJson := json.Unmarshal(content, &amp;quote)\nif errJson != nil {\n    return \"nil\", fmt.Errorf(\"cannot read json body: %v\", errJson)\n}\n</code></pre>\n"}, {"tags": ["go", "one-to-many", "one-to-one", "go-gorm"], "comments": [{"owner": {"reputation": 1037, "user_id": 2730407, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ea8cbda44bec55c4db6250eff89bbd8?s=128&d=identicon&r=PG&f=1", "display_name": "Ronna", "link": "https://stackoverflow.com/users/2730407/ronna"}, "edited": false, "score": 0, "creation_date": 1526560525, "post_id": 35821810, "comment_id": 87798732, "body": "I realize this has been asked a while ago, but can you please explain what you are trying to accomplish? i.e. what is the sql query you would like to have run, and we go backwards from there?"}], "answers": [{"comments": [{"owner": {"reputation": 1278, "user_id": 108826, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/861ed516fb54db2217b7e90aee1d2d3f?s=128&d=identicon&r=PG&f=1", "display_name": "S2201", "link": "https://stackoverflow.com/users/108826/s2201"}, "edited": false, "score": 0, "creation_date": 1585323987, "post_id": 50919587, "comment_id": 107727856, "body": "What if you need to get a list of orders?"}, {"owner": {"reputation": 1114, "user_id": 8190553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6OTwb.png?s=128&g=1", "display_name": "will7200", "link": "https://stackoverflow.com/users/8190553/will7200"}, "reply_to_user": {"reputation": 1278, "user_id": 108826, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/861ed516fb54db2217b7e90aee1d2d3f?s=128&d=identicon&r=PG&f=1", "display_name": "S2201", "link": "https://stackoverflow.com/users/108826/s2201"}, "edited": false, "score": 0, "creation_date": 1587490468, "post_id": 50919587, "comment_id": 108530487, "body": "Change the where to: <code>Where(&quot;orders.id in (?) and status = ?&quot;, [order.ID], &quot;pending&quot;)</code>"}], "tags": [], "owner": {"reputation": 1114, "user_id": 8190553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6OTwb.png?s=128&g=1", "display_name": "will7200", "link": "https://stackoverflow.com/users/8190553/will7200"}, "is_accepted": true, "score": 8, "last_activity_date": 1529372837, "creation_date": 1529372837, "answer_id": 50919587, "question_id": 35821810, "link": "https://stackoverflow.com/questions/35821810/golang-gorm-one-to-many-with-has-one/50919587#50919587", "title": "Golang Gorm one-to-many with has-one", "body": "<p>As described in this <a href=\"https://github.com/jinzhu/gorm/issues/1436\" rel=\"noreferrer\">issue</a>, gorm is not designed to use joins to preload other structs values. If you would like to continue to use gorm and have the ability to use joins to load values, one must use the <a href=\"http://gorm.io/docs/sql_builder.html\" rel=\"noreferrer\">SQL Builder</a> exposed in gorm, and write some code to scan the desired values.</p>\n\n<p>This would become burdensome if there are numerous tables that have to be accounted for.\nIf <a href=\"https://github.com/go-xorm/xorm\" rel=\"noreferrer\">xorm</a> is available as an option, they support loading struct values. Described under the find bullet point, <a href=\"https://github.com/go-xorm/xorm#quick-start\" rel=\"noreferrer\">here</a>.</p>\n\n<p>Note: I did not scan all the fields, just enough to get the point across. </p>\n\n<p><strong>EXAMPLE</strong>:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/jinzhu/gorm/dialects/sqlite\"\n    \"github.com/kylelemons/godebug/pretty\"\n)\n\n// Order\ntype Order struct {\n    gorm.Model\n    Status     string\n    OrderItems []OrderItem\n}\n\n// Order line item\ntype OrderItem struct {\n    gorm.Model\n    OrderID  uint\n    ItemID   uint\n    Item     Item\n    Quantity int\n}\n\n// Product\ntype Item struct {\n    gorm.Model\n    ItemName string\n    Amount   float32\n}\n\nvar (\n    items = []Item{\n        {ItemName: \"Go Mug\", Amount: 12.49},\n        {ItemName: \"Go Keychain\", Amount: 6.95},\n        {ItemName: \"Go Tshirt\", Amount: 17.99},\n    }\n)\n\nfunc main() {\n    db, err := gorm.Open(\"sqlite3\", \"/tmp/gorm.db\")\n    db.LogMode(true)\n    if err != nil {\n        log.Panic(err)\n    }\n    defer db.Close()\n\n    // Migrate the schema\n    db.AutoMigrate(&amp;OrderItem{}, &amp;Order{}, &amp;Item{})\n\n    // Create Items\n    for index := range items {\n        db.Create(&amp;items[index])\n    }\n    order := Order{Status: \"pending\"}\n    db.Create(&amp;order)\n    item1 := OrderItem{OrderID: order.ID, ItemID: items[0].ID, Quantity: 1}\n    item2 := OrderItem{OrderID: order.ID, ItemID: items[1].ID, Quantity: 4}\n    db.Create(&amp;item1)\n    db.Create(&amp;item2)\n\n    // Query with joins\n    rows, err := db.Table(\"orders\").Where(\"orders.id = ? and status = ?\", order.ID, \"pending\").\n        Joins(\"Join order_items on order_items.order_id = orders.id\").\n        Joins(\"Join items on items.id = order_items.id\").\n        Select(\"orders.id, orders.status, order_items.order_id, order_items.item_id, order_items.quantity\" +\n            \", items.item_name, items.amount\").Rows()\n    if err != nil {\n        log.Panic(err)\n    }\n\n    defer rows.Close()\n    // Values to load into\n    newOrder := &amp;Order{}\n    newOrder.OrderItems = make([]OrderItem, 0)\n\n    for rows.Next() {\n        orderItem := OrderItem{}\n        item := Item{}\n        err = rows.Scan(&amp;newOrder.ID, &amp;newOrder.Status, &amp;orderItem.OrderID, &amp;orderItem.ItemID, &amp;orderItem.Quantity, &amp;item.ItemName, &amp;item.Amount)\n        if err != nil {\n            log.Panic(err)\n        }\n        orderItem.Item = item\n        newOrder.OrderItems = append(newOrder.OrderItems, orderItem)\n    }\n    log.Print(pretty.Sprint(newOrder))\n}\n</code></pre>\n\n<p><strong>Output</strong>:</p>\n\n<pre><code>/tmp/main.go.go:55) \n[2018-06-18 18:33:59]  [0.74ms]  INSERT INTO \"items\" (\"created_at\",\"updated_at\",\"deleted_at\",\"item_name\",\"amount\") VALUES ('2018-06-18 18:33:59','2018-06-18 18:33:59',NULL,'Go Mug','12.49')  \n[1 rows affected or returned ] \n\n(/tmp/main.go.go:55) \n[2018-06-18 18:33:59]  [0.50ms]  INSERT INTO \"items\" (\"created_at\",\"updated_at\",\"deleted_at\",\"item_name\",\"amount\") VALUES ('2018-06-18 18:33:59','2018-06-18 18:33:59',NULL,'Go Keychain','6.95')  \n[1 rows affected or returned ] \n\n(/tmp/main.go.go:55) \n[2018-06-18 18:33:59]  [0.65ms]  INSERT INTO \"items\" (\"created_at\",\"updated_at\",\"deleted_at\",\"item_name\",\"amount\") VALUES ('2018-06-18 18:33:59','2018-06-18 18:33:59',NULL,'Go Tshirt','17.99')  \n[1 rows affected or returned ] \n\n(/tmp/main.go.go:58) \n[2018-06-18 18:33:59]  [0.71ms]  INSERT INTO \"orders\" (\"created_at\",\"updated_at\",\"deleted_at\",\"status\") VALUES ('2018-06-18 18:33:59','2018-06-18 18:33:59',NULL,'pending')  \n[1 rows affected or returned ] \n\n(/tmp/main.go.go:61) \n[2018-06-18 18:33:59]  [0.62ms]  INSERT INTO \"order_items\" (\"created_at\",\"updated_at\",\"deleted_at\",\"order_id\",\"item_id\",\"quantity\") VALUES ('2018-06-18 18:33:59','2018-06-18 18:33:59',NULL,'49','145','1')  \n[1 rows affected or returned ] \n\n(/tmp/main.go.go:62) \n[2018-06-18 18:33:59]  [0.45ms]  INSERT INTO \"order_items\" (\"created_at\",\"updated_at\",\"deleted_at\",\"order_id\",\"item_id\",\"quantity\") VALUES ('2018-06-18 18:33:59','2018-06-18 18:33:59',NULL,'49','146','4')  \n[1 rows affected or returned ] \n\n(/tmp/main.go.go:69) \n[2018-06-18 18:33:59]  [0.23ms]  SELECT orders.id, orders.status, order_items.order_id, order_items.item_id, order_items.quantity, items.item_name, items.amount FROM \"orders\" Join order_items on order_items.order_id = orders.id Join items on items.id = order_items.id WHERE (orders.id = '49' and status = 'pending')  \n[0 rows affected or returned ] \n--- ONLY ONE QUERY WAS USED TO FILL THE STRUCT BELOW\n2018/06/18 18:33:59 {Model:      {ID:        49,\n              CreatedAt: 0001-01-01 00:00:00 +0000 UTC,\n              UpdatedAt: 0001-01-01 00:00:00 +0000 UTC,\n              DeletedAt: nil},\n Status:     \"pending\",\n OrderItems: [{Model:    {ID:        0,\n                          CreatedAt: 0001-01-01 00:00:00 +0000 UTC,\n                          UpdatedAt: 0001-01-01 00:00:00 +0000 UTC,\n                          DeletedAt: nil},\n               OrderID:  49,\n               ItemID:   145,\n               Item:     {Model:    {ID:        0,\n                                     CreatedAt: 0001-01-01 00:00:00 +0000 UTC,\n                                     UpdatedAt: 0001-01-01 00:00:00 +0000 UTC,\n                                     DeletedAt: nil},\n                          ItemName: \"Go Mug\",\n                          Amount:   12.489999771118164},\n               Quantity: 1},\n              {Model:    {ID:        0,\n                          CreatedAt: 0001-01-01 00:00:00 +0000 UTC,\n                          UpdatedAt: 0001-01-01 00:00:00 +0000 UTC,\n                          DeletedAt: nil},\n               OrderID:  49,\n               ItemID:   146,\n               Item:     {Model:    {ID:        0,\n                                     CreatedAt: 0001-01-01 00:00:00 +0000 UTC,\n                                     UpdatedAt: 0001-01-01 00:00:00 +0000 UTC,\n                                     DeletedAt: nil},\n                          ItemName: \"Go Keychain\",\n                          Amount:   6.949999809265137},\n               Quantity: 4}]}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7414636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ho8BZ.jpg?s=128&g=1", "display_name": "Steven Victor", "link": "https://stackoverflow.com/users/7414636/steven-victor"}, "is_accepted": false, "score": -1, "last_activity_date": 1587467890, "last_edit_date": 1587467890, "creation_date": 1587464937, "answer_id": 61341351, "question_id": 35821810, "link": "https://stackoverflow.com/questions/35821810/golang-gorm-one-to-many-with-has-one/61341351#61341351", "title": "Golang Gorm one-to-many with has-one", "body": "<p>From the answer above, to get the list of orders, it will be:</p>\n\n<pre><code> .....\n\n    orders := make([]Order, 0)\n\n    for rows.Next() {\n        order := Order{}\n        orderItem := OrderItem{}\n\n        item := Item{}\n        err = rows.Scan(&amp;order.ID, &amp;order.Status, &amp;orderItem.OrderID, &amp;orderItem.ItemID, &amp;orderItem.Quantity, &amp;item.ItemName, &amp;item.Amount)\n        if err != nil {\n            log.Panic(err)\n        }\n\n        orderItem.Item = item\n\n        order.OrderItems = append(order.OrderItems, orderItem)\n\n        orders = append(orders, order)\n    }\n\n    log.Print(pretty.Sprint(orders))\n}\n</code></pre>\n"}], "owner": {"reputation": 563, "user_id": 3096935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f2b2f03ab65bb90ea760a384c48154e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Babcock", "link": "https://stackoverflow.com/users/3096935/michael-babcock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15352, "favorite_count": 4, "accepted_answer_id": 50919587, "answer_count": 2, "score": 16, "last_activity_date": 1587467890, "creation_date": 1457225857, "last_edit_date": 1459963866, "question_id": 35821810, "link": "https://stackoverflow.com/questions/35821810/golang-gorm-one-to-many-with-has-one", "title": "Golang Gorm one-to-many with has-one", "body": "<p>I'm trying to learn Go and Gorm by building a little prototype order management app. The database is MySQL. With simple queries Gorm has been stellar. However, when trying to obtain a result set involving a combination one-to-many with a has-one relationship Gorm seems to fall short. No doubt, it is my lack of understanding that is actually falling short. I can't seem to find any online examples of what I am trying to accomplish. Any help would be greatly appreciated.</p>\n\n<p><strong>Go Structs</strong></p>\n\n<pre><code>// Order\ntype Order struct {\n    gorm.Model\n    Status  string\n    OrderItems   []OrderItem\n}\n\n// Order line item\ntype OrderItem struct {\n    gorm.Model\n    OrderID uint\n    ItemID  uint\n    Item    Item\n    Quantity int\n}\n\n// Product\ntype Item struct {\n    gorm.Model\n    ItemName     string\n    Amount       float32\n}\n</code></pre>\n\n<p><strong>Database tables</strong></p>\n\n<pre><code>orders\nid | status\n 1 | pending\n\norder_items\nid | order_id | item_id | quantity\n 1 | 1        | 1       | 1\n 2 | 1        | 2       | 4\n\nitems\nid | item_name   | amount\n 1 | Go Mug      | 12.49\n 2 | Go Keychain | 6.95\n 3 | Go T-Shirt  | 17.99\n</code></pre>\n\n<p><strong>Current query</strong></p>\n\n<pre><code>order := &amp;Order \nif err := db.Where(\"id = ? and status = ?\", reqOrder.id, \"pending\")\n.First(&amp;order).Error; err != nil {\n    fmt.Printf(err.Error())\n}\n\ndb.Model(&amp;order).Association(\"OrderItems\").Find(&amp;order.OrderItems)\n</code></pre>\n\n<p><strong>Results (gorm makes 2 db queries)</strong></p>\n\n<pre><code>order == Order {\n  id: 1,\n  status: pending,\n  OrderItems[]: {\n    {\n      ID: 1,\n      OrderID: 1,\n      ItemID: 1,\n      Item: nil,\n      Quantity: 1,\n    },\n    {\n      ID: 2,\n      OrderID: 1,\n      ItemID: 2,\n      Item: nil,\n      Quantity: 4,\n    }\n }\n</code></pre>\n\n<p><strong>Alternative query</strong></p>\n\n<pre><code>order := &amp;Order\ndb.Where(\"id = ? and status = ?\", reqOrder.id, \"cart\")\n.Preload(\"OrderItems\").Preload(\"OrderItems.Item\").First(&amp;order)\n</code></pre>\n\n<p><strong>Results (gorm makes 3 db queries)</strong></p>\n\n<pre><code>order == Order {\n  id: 1,\n  status: pending,\n  OrderItems[]: {\n    {\n      ID: 1,\n      OrderID: 1,\n      ItemID: 1,\n      Item: {\n        ID: 1,\n        ItemName: Go Mug,\n        Amount: 12.49,\n      }\n      Quantity: 1,\n    },\n    {\n      ID: 2,\n      OrderID: 1,\n      ItemID: 2,\n      Item: {\n        ID: 2,\n        ItemName: Go Keychain,\n        Amount: 6.95,\n      },\n      Quantity: 4,\n    }\n }\n</code></pre>\n\n<p><strong>Ideal results</strong></p>\n\n<p>The \"Alternative query\" above produces the ideal query results. However, Gorm makes 3 separate database queries to do so. Ideally, the same results would be accomplished with 1 (or 2) database queries.</p>\n\n<p>This could be accomplished in MySQL with a couple of joins. Gorm allows for joins. But, I was hoping to take advantage of some of Gorm's relational magic.</p>\n\n<p>Thanks a bunch!</p>\n"}, {"tags": ["go", "homebrew", "osx-yosemite"], "comments": [{"owner": {"reputation": 6839, "user_id": 90096, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/498c5b4e0507a3388f07ea20f7230ab8?s=128&d=identicon&r=PG", "display_name": "Artem", "link": "https://stackoverflow.com/users/90096/artem"}, "edited": false, "score": 0, "creation_date": 1457223503, "post_id": 35821382, "comment_id": 59310355, "body": "Why downvote on this question?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1457229522, "post_id": 35821382, "comment_id": 59311629, "body": "Unset your GOROOT. Homebrew will manage this for you during installation."}], "answers": [{"tags": [], "owner": {"reputation": 2619, "user_id": 6999390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f923bf33f4e79dd6f0a670af214cd981?s=128&d=identicon&r=PG", "display_name": "Dan Cantir", "link": "https://stackoverflow.com/users/6999390/dan-cantir"}, "is_accepted": true, "score": 6, "last_activity_date": 1457222761, "last_edit_date": 1457222761, "creation_date": 1457222499, "answer_id": 35821446, "question_id": 35821382, "link": "https://stackoverflow.com/questions/35821382/go-1-6-does-not-work-on-os-x-yosemite/35821446#35821446", "title": "Go 1.6 does not work on OS X Yosemite", "body": "<p>Try to set your <code>GOROOT</code> to <code>/usr/local/Cellar/go/1.6/libexec</code>. I remember I had the same problem and this fixed it.</p>\n"}, {"tags": [], "owner": {"reputation": 934, "user_id": 3239666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638873245dd9cdc579bf551818c11fb3?s=128&d=identicon&r=PG&f=1", "display_name": "GarMan", "link": "https://stackoverflow.com/users/3239666/garman"}, "is_accepted": false, "score": 4, "last_activity_date": 1457240422, "creation_date": 1457240422, "answer_id": 35823325, "question_id": 35821382, "link": "https://stackoverflow.com/questions/35821382/go-1-6-does-not-work-on-os-x-yosemite/35823325#35823325", "title": "Go 1.6 does not work on OS X Yosemite", "body": "<p>You don't need to set the <code>GOROOT</code> variable anymore <a href=\"http://dave.cheney.net/2013/06/14/you-dont-need-to-set-goroot-really\" rel=\"nofollow\">http://dave.cheney.net/2013/06/14/you-dont-need-to-set-goroot-really</a></p>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 2, "last_activity_date": 1547254153, "last_edit_date": 1592644375, "creation_date": 1547254153, "answer_id": 54155841, "question_id": 35821382, "link": "https://stackoverflow.com/questions/35821382/go-1-6-does-not-work-on-os-x-yosemite/54155841#54155841", "title": "Go 1.6 does not work on OS X Yosemite", "body": "<blockquote>\n<p>Does Go support OS X 10.10?</p>\n</blockquote>\n<p>Yes, for Go up to 1.12.<br />\nStarting Q4 2019, not anymore. See <a href=\"https://tip.golang.org/doc/go1.12#darwin\" rel=\"nofollow noreferrer\">Go 1.12 doc</a>:</p>\n<blockquote>\n<h2>Darwin</h2>\n<p><strong>Go 1.12 is the last release that will run on macOS 10.10 Yosemite</strong>.</p>\n<p><strong>Go 1.13 (Q4 2019) will require macOS 10.11 El Capitan or later</strong>.</p>\n<p><code>libSystem</code> is now used when making syscalls on Darwin, ensuring forward-compatibility with future versions of macOS and iOS.<br />\nThe switch to <code>libSystem</code> triggered additional App Store checks for private API usage.<br />\nSince it is considered private, <code>syscall.Getdirentries</code> now always fails with <code>ENOSYS</code> on iOS.</p>\n</blockquote>\n"}], "owner": {"reputation": 6839, "user_id": 90096, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/498c5b4e0507a3388f07ea20f7230ab8?s=128&d=identicon&r=PG", "display_name": "Artem", "link": "https://stackoverflow.com/users/90096/artem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2563, "favorite_count": 2, "accepted_answer_id": 35821446, "answer_count": 3, "score": 3, "last_activity_date": 1547254153, "creation_date": 1457222021, "question_id": 35821382, "link": "https://stackoverflow.com/questions/35821382/go-1-6-does-not-work-on-os-x-yosemite", "title": "Go 1.6 does not work on OS X Yosemite", "body": "<p>OS X Yosemite with all patches. Installed go with</p>\n\n<pre><code>brew install go --cross-compile-common\n</code></pre>\n\n<p>Created ~/work, setup environments like this:</p>\n\n<pre><code>export GOPATH=$HOME/work\nexport GOROOT='/usr/local/Cellar/go/1.6'\nexport PATH=$PATH:$GOROOT/bin\n</code></pre>\n\n<p>Now attempt to add a package gives me an error:</p>\n\n<pre><code>go get golang.org/x/tools/cmd/godoc\n\npackage archive/zip: unrecognized import path \"archive/zip\" (import path does not begin with hostname)\npackage bytes: unrecognized import path \"bytes\" (import path does not begin with hostname)\npackage encoding/json: unrecognized import path \"encoding/json\" (import path does not begin with hostname)\npackage encoding/xml: unrecognized import path \"encoding/xml\" (import path does not begin with hostname)\npackage errors: unrecognized import path \"errors\" (import path does not begin with hostname)\npackage expvar: unrecognized import path \"expvar\" (import path does not begin with hostname)\npackage flag: unrecognized import path \"flag\" (import path does not begin with hostname)\npackage fmt: unrecognized import path \"fmt\" (import path does not begin with hostname)\n...\n</code></pre>\n\n<p>Does Go support OS X 10.10?\nWhat did I miss here?</p>\n"}, {"tags": ["mysql", "sql", "go", "mariadb"], "comments": [{"owner": {"reputation": 60275, "user_id": 1073631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b7f78513c544111980c6308b25a4ed?s=128&d=identicon&r=PG", "display_name": "sgeddes", "link": "https://stackoverflow.com/users/1073631/sgeddes"}, "edited": false, "score": 0, "creation_date": 1457207548, "post_id": 35818998, "comment_id": 59305583, "body": "Sample data and expected results would help."}], "answers": [{"tags": [], "owner": {"reputation": 775, "user_id": 3403603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9db5b967fdb6f0fd7d45e086a0c63b?s=128&d=identicon&r=PG&f=1", "display_name": "neal", "link": "https://stackoverflow.com/users/3403603/neal"}, "is_accepted": false, "score": 0, "last_activity_date": 1457207918, "creation_date": 1457207918, "answer_id": 35819144, "question_id": 35818998, "link": "https://stackoverflow.com/questions/35818998/how-do-i-get-a-row-of-the-same-type-from-one-table-or-another-table-along-with-t/35819144#35819144", "title": "How do I get a row of the same type from one table or another table along with the information about from which table it was", "body": "<p>Without looking at your tables or any idea as to what you want returned in the select statement:</p>\n\n<pre><code>SELECT  *\nFROM    people a,\n        students b,\n        teachers c,\n        library_access d\nWHERE   a.human_id = b.human_id\n    AND a.human_id = c.human_id\n    AND a.human_id = d.human_id\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 454, "user_id": 4240261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75ff9a37dd735232d0e1ffa2e7af1823?s=128&d=identicon&r=PG", "display_name": "Mika Feiler", "link": "https://stackoverflow.com/users/4240261/mika-feiler"}, "edited": false, "score": 0, "creation_date": 1457209867, "post_id": 35819184, "comment_id": 59306449, "body": "Thanks! It seems so simple now. Just one question to make sure I understand: the ALL keyword is needed only when I have a person which is both a student and a teacher?"}, {"owner": {"reputation": 60275, "user_id": 1073631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b7f78513c544111980c6308b25a4ed?s=128&d=identicon&r=PG", "display_name": "sgeddes", "link": "https://stackoverflow.com/users/1073631/sgeddes"}, "reply_to_user": {"reputation": 454, "user_id": 4240261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75ff9a37dd735232d0e1ffa2e7af1823?s=128&d=identicon&r=PG", "display_name": "Mika Feiler", "link": "https://stackoverflow.com/users/4240261/mika-feiler"}, "edited": false, "score": 0, "creation_date": 1457210194, "post_id": 35819184, "comment_id": 59306573, "body": "@ArchieT -- you&#39;re welcome. To answer your question, no, <code>union all</code> is used to combine results from multiple queries -- each <code>sql</code> statement must have the same number of columns.  Plus <code>union all</code> is faster than <code>union</code>  by itself since <code>union</code> removes duplicates.  In your scenario, that should never occur."}], "tags": [], "owner": {"reputation": 60275, "user_id": 1073631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b7f78513c544111980c6308b25a4ed?s=128&d=identicon&r=PG", "display_name": "sgeddes", "link": "https://stackoverflow.com/users/1073631/sgeddes"}, "is_accepted": true, "score": 0, "last_activity_date": 1457208121, "creation_date": 1457208121, "answer_id": 35819184, "question_id": 35818998, "link": "https://stackoverflow.com/questions/35818998/how-do-i-get-a-row-of-the-same-type-from-one-table-or-another-table-along-with-t/35819184#35819184", "title": "How do I get a row of the same type from one table or another table along with the information about from which table it was", "body": "<p>You said you need to know which table the data comes from.  You can use <code>union all</code> for this:</p>\n\n<pre><code>select la.access_id, s.id, 'Students' as source_table\nfrom library_access la \n    join students s on la.human_id = s.human_id\nunion all\nselect la.access_id, t.id, 'Teachers' as source_table\nfrom library_access la \n    join teachers t on la.human_id = t.human_id\n</code></pre>\n"}], "owner": {"reputation": 454, "user_id": 4240261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75ff9a37dd735232d0e1ffa2e7af1823?s=128&d=identicon&r=PG", "display_name": "Mika Feiler", "link": "https://stackoverflow.com/users/4240261/mika-feiler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 35819184, "answer_count": 2, "score": 0, "last_activity_date": 1457209117, "creation_date": 1457207240, "last_edit_date": 1457209117, "question_id": 35818998, "link": "https://stackoverflow.com/questions/35818998/how-do-i-get-a-row-of-the-same-type-from-one-table-or-another-table-along-with-t", "title": "How do I get a row of the same type from one table or another table along with the information about from which table it was", "body": "<p>Let's say I have tables:</p>\n\n<pre><code>create table people ( \n    human_id bigint auto_increment primary key, \n    birthday datetime );\n\ncreate table students ( \n    id bigint auto_increment primary key, \n    human_id bigint unique key not null, \n    group_id bigint not null );\n\ncreate table teachers ( \n    id bigint auto_increment primary key, \n    human_id bigint unique key not null, \n    academic_degree varchar(20) );\n\ncreate table library_access ( \n    access_id bigint auto_increment primary key, \n    human_id bigint not null, \n    accessed_on datetime );\n</code></pre>\n\n<p>Now I want to display information about a library access, along with the information whether it was a student or a teacher (and then the id corresponding to the table) (let's say I want something like <code>SELECT access_id,id,true_if_student_false_if_teacher FROM library_access</code>), in an idiomatic way.</p>\n\n<p>How do I form the query (in case such database was already deployed) and what are better and more idiomatic ways to solve that problem (in case it wasn't deployed so far).</p>\n\n<p>MariaDB 5.5, database accessed by Go and nothing else.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["go", "kubernetes", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 5960398, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e7dc6293643573010c290f60e2e6efa?s=128&d=identicon&r=PG&f=1", "display_name": "Srikanth", "link": "https://stackoverflow.com/users/5960398/srikanth"}, "edited": false, "score": 0, "creation_date": 1457204215, "post_id": 35818294, "comment_id": 59304342, "body": "Thanks for the quick response! I did figure that it was a floating representation and tested it as you&#39;ve shown but forgot to output a string. I do need the if statement because i&#39;ve data containers that do not have a ports array and want to avoid errors."}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 93, "user_id": 5960398, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e7dc6293643573010c290f60e2e6efa?s=128&d=identicon&r=PG&f=1", "display_name": "Srikanth", "link": "https://stackoverflow.com/users/5960398/srikanth"}, "edited": false, "score": 0, "creation_date": 1457204843, "post_id": 35818294, "comment_id": 59304600, "body": "range should be okay with undefined vars. You can test it by replacing <code>.ports</code> with <code>.foo</code>"}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 2, "last_activity_date": 1457204011, "last_edit_date": 1457204011, "creation_date": 1457203679, "answer_id": 35818294, "question_id": 35818105, "link": "https://stackoverflow.com/questions/35818105/kubectl-get-with-template-string-fails-with-incompatible-types-for-comparison/35818294#35818294", "title": "kubectl get with template string fails with incompatible types for comparison", "body": "<p>Inspecting the .containerPort with <code>printf \"%T\" .containerPort</code> shows that it's a float64. if you compare your port with a trailing <code>5445.0</code> it should work.</p>\n\n<p>You also have some unnecessary if statements. </p>\n\n<pre><code>--template='{{range .spec.template.spec.containers}}{{range .ports}}{{if eq .containerPort 5445.0}}True{{end}}{{end}}{{end}}'\n</code></pre>\n\n<p>Your example was also missing the <code>-o=\"go-template\"</code> flag to specify the output as a Go template.</p>\n"}], "owner": {"reputation": 93, "user_id": 5960398, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e7dc6293643573010c290f60e2e6efa?s=128&d=identicon&r=PG&f=1", "display_name": "Srikanth", "link": "https://stackoverflow.com/users/5960398/srikanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2240, "favorite_count": 1, "accepted_answer_id": 35818294, "answer_count": 1, "score": 1, "last_activity_date": 1457204011, "creation_date": 1457202861, "question_id": 35818105, "link": "https://stackoverflow.com/questions/35818105/kubectl-get-with-template-string-fails-with-incompatible-types-for-comparison", "title": "kubectl get with template string fails with incompatible types for comparison", "body": "<p>I have to check if my application container in a replication controller runs on a certain port. Here is the command with the go template string that I'm using.</p>\n\n<pre><code>kubectl get rc my-rc --namespace=nightly --template='{{range .spec.template.spec.containers}}{{if .ports}}{{range .ports}}{{if .containerPort}}{{if eq .containerPort 5445}}{{end}}{{end}}{{end}}{{end}}{{end}}'\n</code></pre>\n\n<p>I think it is not a string comparison since it is a port. even string comparison throws an error \"error calling eq: incompatible types for comparison'\"</p>\n\n<p>I could just fetch an array of container ports and do the comparison outside but want to get it done inside the go template.</p>\n\n<p>I am new to Go lang. Appreciate any suggestions to accomplish this using template string or using a template file.. Thanks</p>\n"}, {"tags": ["go", "dependency-management", "terraform", "godeps"], "answers": [{"tags": [], "owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "is_accepted": false, "score": 2, "last_activity_date": 1457982983, "creation_date": 1457982983, "answer_id": 35996145, "question_id": 35816421, "link": "https://stackoverflow.com/questions/35816421/how-to-update-the-vendor-folder-for-https-github-com-hashicorp-terraform-git-f/35996145#35996145", "title": "how to update the vendor folder for https://github.com/hashicorp/terraform.git for terraform", "body": "<p>You have to do a <code>godep restore -v</code> again. <code>update</code> only updates the dependency in the <code>Godep.json</code> file.</p>\n"}], "owner": {"reputation": 1251, "user_id": 3655695, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/42f05fe122cfe8437cfcf79be6631b74?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3655695/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1710, "favorite_count": 1, "answer_count": 1, "score": 7, "last_activity_date": 1457982983, "creation_date": 1457194139, "last_edit_date": 1457339897, "question_id": 35816421, "link": "https://stackoverflow.com/questions/35816421/how-to-update-the-vendor-folder-for-https-github-com-hashicorp-terraform-git-f", "title": "how to update the vendor folder for https://github.com/hashicorp/terraform.git for terraform", "body": "<p>Hi i am following steps given for hashicorp/terraform and performed below activity</p>\n\n<pre><code># Get latest master branch's dependencies staged in local $GOPATH\ngit checkout master\ngit pull\ngodep restore -v\n\n# Make your way to the dependency in question and checkout the target ref\npushd $GOPATH/src/github.com/some/dependency\ngit checkout [latest]\n\n# Head back to Terraform on a feature branch and update the dependncy to the\n# version currently in your $GOPATH\npopd\ngit checkout my-feature-branch\ngodep update github.com/...\n</code></pre>\n\n<p>after this i can see my Godep.json file has been updated however i dont see changes in the vendor folder . it still points to old. Well i am looking emr support from vendor for that i am updating go-aws-sdk which is available with the latest go-aws-sdk. when i called go update github.com/... it has modified the godep.json but not vendor folder .\nCould somebody please let me know the reason. Thanks</p>\n"}, {"tags": ["go", "struct"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1457189833, "last_edit_date": 1457189833, "creation_date": 1457188600, "answer_id": 35815370, "question_id": 35815248, "link": "https://stackoverflow.com/questions/35815248/trying-to-test-for-an-empty-self-referential-struct-value-in-go/35815370#35815370", "title": "Trying to test for an empty self referential struct value in Go", "body": "<p>Fix your typo:<code>node.next == nil</code> not <code>node.data == nil</code>. And fix your recursion error: delete the <code>for</code> loop. Even better, for safety, check for <code>node == nil</code>. For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Node struct {\n    data string\n    next *Node\n}\n\nfunc PrintList(node *Node) {\n    if node == nil {\n        return\n    }\n    fmt.Println(node.data)\n    PrintList(node.next)\n}\n\nfunc main() {\n    node3 := &amp;Node{data: \"three\"}\n    node2 := &amp;Node{data: \"two\", next: node3}\n    node1 := &amp;Node{data: \"one\", next: node2}\n    PrintList(node1)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>one\ntwo\nthree\n</code></pre>\n"}], "owner": {"reputation": 7316, "user_id": 343223, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ae23daf71dad2323709f67c12e81792f?s=128&d=identicon&r=PG", "display_name": "igniteflow", "link": "https://stackoverflow.com/users/343223/igniteflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1012, "favorite_count": 1, "accepted_answer_id": 35815370, "answer_count": 1, "score": 1, "last_activity_date": 1457189833, "creation_date": 1457187819, "question_id": 35815248, "link": "https://stackoverflow.com/questions/35815248/trying-to-test-for-an-empty-self-referential-struct-value-in-go", "title": "Trying to test for an empty self referential struct value in Go", "body": "<p>I am new to Go and am trying to implement a very simple linked list.  Currently while recursively traversing the list I am attempting to break out of the for loop if node.next is nil/unset, but the if conditional is never satisfied.  I can only assume that the value is not nil, but some sort of pointer to an empty Node struct type, but I can't figure out how to evaluate this.  Here is my code, any help would be much appreciated:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Node struct {\n    data string\n    next *Node\n}\n\nfunc PrintList(node *Node) {\n  for {\n    fmt.Println(node.data)\n\n    if node.data == nil {\n      break\n    } else {\n      PrintList(node.next)\n    }\n  }\n}\n\nfunc main() {\n  node3 := &amp;Node{data: \"three\"}\n  node2 := &amp;Node{data: \"two\", next: node3}\n  node1 := &amp;Node{data: \"one\", next: node2}\n\n  PrintList(node1)\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "edited": false, "score": 0, "creation_date": 1457192499, "post_id": 35816022, "comment_id": 59299703, "body": "Could I then just manualy copy the forhindre.com/or other to the vendor folder?"}, {"owner": {"reputation": 934, "user_id": 3239666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638873245dd9cdc579bf551818c11fb3?s=128&d=identicon&r=PG&f=1", "display_name": "GarMan", "link": "https://stackoverflow.com/users/3239666/garman"}, "reply_to_user": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "edited": false, "score": 1, "creation_date": 1457192598, "post_id": 35816022, "comment_id": 59299746, "body": "Yes, you can, that is basically what the tools do for you. But if your package forhindre.com/foo depends on other packages you need to recursively copy them to the vendor folder too, or those depedancies won&#39;t get vendored."}, {"owner": {"reputation": 934, "user_id": 3239666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638873245dd9cdc579bf551818c11fb3?s=128&d=identicon&r=PG&f=1", "display_name": "GarMan", "link": "https://stackoverflow.com/users/3239666/garman"}, "reply_to_user": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "edited": false, "score": 1, "creation_date": 1457192774, "post_id": 35816022, "comment_id": 59299825, "body": "The go repo&#39;s wiki has a nice page with a list of package management tools <a href=\"https://github.com/golang/go/wiki/PackageManagementTools\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/PackageManagementTools</a>"}], "tags": [], "owner": {"reputation": 934, "user_id": 3239666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638873245dd9cdc579bf551818c11fb3?s=128&d=identicon&r=PG&f=1", "display_name": "GarMan", "link": "https://stackoverflow.com/users/3239666/garman"}, "is_accepted": true, "score": 3, "last_activity_date": 1457192230, "creation_date": 1457192230, "answer_id": 35816022, "question_id": 35815054, "link": "https://stackoverflow.com/questions/35815054/package-management-with-go-vendoring/35816022#35816022", "title": "Package management with go vendoring", "body": "<p>As of 1.5 (with a flag) and 1.6 by default the go tools will look in the <code>vendor</code> folder for dependant packages before your <code>GOPATH</code>, for specifics see <a href=\"https://docs.google.com/document/d/1Bz5-UB7g2uPBdOx-rw5t9MxJwkfpx90cqG9AFL0JAYo\" rel=\"nofollow\">the design doc</a></p>\n\n<p>But the go tools do not include tooling to populate that folder for you.</p>\n\n<p>There are many tools that try to handle it for you, for example <a href=\"https://github.com/tools/godep\" rel=\"nofollow\" title=\"Godep\">Godep</a>, <a href=\"https://github.com/FiloSottile/gvt\" rel=\"nofollow\">gvt</a> and others. </p>\n\n<p>You still need to use <code>go get</code> to get the packages into your <code>GOPATH</code> first.</p>\n"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 35816022, "answer_count": 1, "score": 3, "last_activity_date": 1457192230, "creation_date": 1457186536, "question_id": 35815054, "link": "https://stackoverflow.com/questions/35815054/package-management-with-go-vendoring", "title": "Package management with go vendoring", "body": "<p>How do you use go vendoring. It is written many places that 1.6 now include vendoring, but I can not find any documentation?</p>\n\n<p>When use <code>go get</code>, I see no vendor folder?</p>\n\n<p>I just need to be able to control packages like npm, apt etc.</p>\n"}, {"tags": ["go", "atomic", "uint32"], "comments": [{"owner": {"reputation": 9029, "user_id": 2663692, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/LOx4z.png?s=128&g=1", "display_name": "Tal Avissar", "link": "https://stackoverflow.com/users/2663692/tal-avissar"}, "edited": false, "score": 0, "creation_date": 1457182964, "post_id": 35814424, "comment_id": 59296790, "body": "Tha approach  to pointers of the Go language is a bit confusing. In Go, you define a method receiver to specify which struct to attach a certain function to in order to make it invoke-able as a method."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 7, "last_activity_date": 1457183753, "last_edit_date": 1457183753, "creation_date": 1457182944, "answer_id": 35814469, "question_id": 35814424, "link": "https://stackoverflow.com/questions/35814424/strange-behaviour-of-int-inside-a-struct/35814469#35814469", "title": "Strange behaviour of int inside a struct", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Calls\">Calls</a></p>\n  \n  <p>In a function call, the function value and arguments are evaluated in\n  the usual order. After they are evaluated, the parameters of the call\n  are passed by value to the function and the called function begins\n  execution. The return parameters of the function are passed by value\n  back to the calling function when the function returns.</p>\n</blockquote>\n\n<p>The receiver <code>sm some</code> is passed by value to the method and the copy is discarded when you return from the method. Use a pointer receiver.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync/atomic\"\n)\n\ntype some struct {\n    I uint32\n}\n\nfunc (sm *some) Add1() {\n    atomic.AddUint32(&amp;sm.I, 1)\n}\n\nfunc main() {\n    var s some\n    s.Add1()\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{1}\n</code></pre>\n\n<blockquote>\n  <p><a href=\"https://golang.org/doc/faq\">Go Frequently Asked Questions (FAQ)</a></p>\n  \n  <p><a href=\"https://golang.org/doc/faq#pass_by_value\">When are function parameters passed by value?</a></p>\n  \n  <p>As in all languages in the C family, everything in Go is passed by\n  value. That is, a function always gets a copy of the thing being\n  passed, as if there were an assignment statement assigning the value\n  to the parameter. For instance, passing an int value to a function\n  makes a copy of the int, and passing a pointer value makes a copy of\n  the pointer, but not the data it points to.</p>\n  \n  <p><a href=\"https://golang.org/doc/faq#methods_on_values_or_pointers\">Should I define methods on values or pointers?</a></p>\n\n<pre><code>func (s *MyStruct) pointerMethod() { } // method on pointer\nfunc (s MyStruct)  valueMethod()   { } // method on value\n</code></pre>\n  \n  <p>For programmers unaccustomed to pointers, the distinction between\n  these two examples can be confusing, but the situation is actually\n  very simple. When defining a method on a type, the receiver (s in the\n  above examples) behaves exactly as if it were an argument to the\n  method. Whether to define the receiver as a value or as a pointer is\n  the same question, then, as whether a function argument should be a\n  value or a pointer. There are several considerations.</p>\n  \n  <p>First, and most important, does the method need to modify the\n  receiver? If it does, the receiver must be a pointer. (Slices and maps\n  act as references, so their story is a little more subtle, but for\n  instance to change the length of a slice in a method the receiver must\n  still be a pointer.) In the examples above, if pointerMethod modifies\n  the fields of s, the caller will see those changes, but valueMethod is\n  called with a copy of the caller's argument (that's the definition of\n  passing a value), so changes it makes will be invisible to the caller.</p>\n  \n  <p>By the way, pointer receivers are identical to the situation in Java,\n  although in Java the pointers are hidden under the covers; it's Go's\n  value receivers that are unusual.</p>\n  \n  <p>Second is the consideration of efficiency. If the receiver is large, a\n  big struct for instance, it will be much cheaper to use a pointer\n  receiver.</p>\n  \n  <p>Next is consistency. If some of the methods of the type must have\n  pointer receivers, the rest should too, so the method set is\n  consistent regardless of how the type is used. See the section on\n  method sets for details.</p>\n  \n  <p>For types such as basic types, slices, and small structs, a value\n  receiver is very cheap so unless the semantics of the method requires\n  a pointer, a value receiver is efficient and clear.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "is_accepted": false, "score": 2, "last_activity_date": 1457183294, "creation_date": 1457183294, "answer_id": 35814522, "question_id": 35814424, "link": "https://stackoverflow.com/questions/35814424/strange-behaviour-of-int-inside-a-struct/35814522#35814522", "title": "Strange behaviour of int inside a struct", "body": "<p>Your function need to receive a pointer for the value to be incremented, that way you are not passing a copy of the struct and on next iteration the I can be incremented.</p>\n\n<pre><code>package main\n\nimport (\n\"sync/atomic\"\n\"fmt\"\n)\n\ntype some struct{\n    I uint32\n}\n\nfunc main() {\nq := &amp;some{0}\nfor i := 0; i &lt; 10; i++ {\n        q.Add1()\n        fmt.Println(q.I)\n}\n}\n\nfunc (sm *some) Add1(){\n    atomic.AddUint32(&amp;sm.I,1)\n}\n</code></pre>\n"}], "owner": {"reputation": 495, "user_id": 5934834, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/263e6d6ad912197d1f650c8fead44bba?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/5934834/gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 1, "accepted_answer_id": 35814469, "answer_count": 2, "score": 4, "last_activity_date": 1457203530, "creation_date": 1457182658, "last_edit_date": 1457203530, "question_id": 35814424, "link": "https://stackoverflow.com/questions/35814424/strange-behaviour-of-int-inside-a-struct", "title": "Strange behaviour of int inside a struct", "body": "<p>Let's say we have this kind of a struct (one of the simplest ever):</p>\n\n<pre><code>type some struct{\n    I uint32\n}\n</code></pre>\n\n<p>And we want to have a variable of that type and to atomically increment in for loop (possibly in another goroutine but now the story is different). I do the following:</p>\n\n<pre><code>q := some{0}\nfor i := 0; i &lt; 10; i++ {\n        atomic.AddUint32(&amp;q.I,1) // increment [1]\n        fmt.Println(q.I)\n}\n</code></pre>\n\n<p>We're getting what we'd expect, so far so good, but if we declare a function for that type as follows:</p>\n\n<pre><code>func (sm some) Add1(){\n    atomic.AddUint32(&amp;sm.I,1)\n}\n</code></pre>\n\n<p>and call this function in the above sample (line [1]) the value isn't incremented and  we just get zeros. The question is obvious - why?</p>\n\n<p>This has to be something basic but since I am new to go I don't realize it.</p>\n"}, {"tags": ["mysql", "database", "go", "tcp", "go-gorm"], "comments": [{"owner": {"reputation": 2666, "user_id": 1421957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8e742c4a05e312502c828847c455ad?s=128&d=identicon&r=PG", "display_name": "Tico", "link": "https://stackoverflow.com/users/1421957/tico"}, "edited": false, "score": 2, "creation_date": 1457182404, "post_id": 35814320, "comment_id": 59296614, "body": "Do you use 5555 as your MySQL port? I&#39;m asking just in case, because the default one is 3306."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1457856191, "post_id": 35814320, "comment_id": 59590308, "body": "Is log.Debug(conn) printing the connection string :@tcp(:)/  ?"}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 2108556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a55b75f86850a1e1aa8d8e890fcc8c1?s=128&d=identicon&r=PG", "display_name": "Juan Guzm&#225;n", "link": "https://stackoverflow.com/users/2108556/juan-guzm%c3%a1n"}, "is_accepted": false, "score": 0, "last_activity_date": 1458001235, "creation_date": 1458001235, "answer_id": 36000536, "question_id": 35814320, "link": "https://stackoverflow.com/questions/35814320/cant-connect-to-remote-mysql-in-go/36000536#36000536", "title": "Can&#39;t connect to remote MySql in Go", "body": "<p>I'm guessing \"v\" is your config variable\u2026 Which contains no data, this is not a problem with Gorm, it's because dc.Open() is not receiving the config values.</p>\n\n<p>If you try to run it with static data, it should work.</p>\n"}], "owner": {"reputation": 31, "user_id": 6022227, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-BkKgi11r8Oc/AAAAAAAAAAI/AAAAAAAAAAs/Udr5NJ7Q7Q4/photo.jpg?sz=128", "display_name": "Nuwan Indika", "link": "https://stackoverflow.com/users/6022227/nuwan-indika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1245, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458001235, "creation_date": 1457182128, "last_edit_date": 1457183062, "question_id": 35814320, "link": "https://stackoverflow.com/questions/35814320/cant-connect-to-remote-mysql-in-go", "title": "Can&#39;t connect to remote MySql in Go", "body": "<p>I need to connect to a remote MySql server using Go. I'm using following code to connect to MySql via gorm.</p>\n\n<pre><code> type DBController struct {\n    DB gorm.DB\n}\n\nfunc (dc *DBController) InitDB() {\n    var err error\n\n  host := v.GetString(\"db.mysql.host\")\n  port := v.GetString(\"db.mysql.port\")\n\n  user := v.GetString(\"db.mysql.user\")\n  pass := v.GetString(\"db.mysql.pass\")\n\n  db := v.GetString(\"db.mysql.db\")\n\n  //user:password@tcp(localhost:5555)/dbname\n  conn := fmt.Sprintf(\"%s:%s@tcp(%s:%s)/%s\", user, pass, host, port, db)\n  //conn := v.GetString($user+\":\"$pass+\"@tcp(\"+$host+\":\"+$port+\")/\"+$db)\n  log.Debug(conn)\n\n    dc.DB, err = gorm.Open(\"mysql\", conn)\n    if err != nil {\n        log.Fatalf(\"Error when connect database, the error is '%v'\", err)\n    }\n    dc.DB.LogMode(true)\n}\n\nfunc (dc *DBController) GetDB() gorm.DB {\n  return dc.DB\n}\n</code></pre>\n\n<p>When I run the Go server I'm getting following errors</p>\n\n<pre><code>No configuration file loaded - using defaults\n:@tcp(:)/\nError when connect database, the error is 'dial tcp: unknown port tcp/'\nexit status 1\n</code></pre>\n\n<p>How can fix this error?</p>\n"}, {"tags": ["sql-server", "azure", "go", "azure-sql-database"], "comments": [{"owner": {"reputation": 90, "user_id": 5659695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f10cbc98d05809357f63cf942724e9?s=128&d=identicon&r=PG&f=1", "display_name": "Daredevil", "link": "https://stackoverflow.com/users/5659695/daredevil"}, "edited": false, "score": 0, "creation_date": 1457216520, "post_id": 35814017, "comment_id": 59308655, "body": "Are your apps and Azure SQL Database hosted in same region?"}, {"owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "reply_to_user": {"reputation": 90, "user_id": 5659695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f10cbc98d05809357f63cf942724e9?s=128&d=identicon&r=PG&f=1", "display_name": "Daredevil", "link": "https://stackoverflow.com/users/5659695/daredevil"}, "edited": false, "score": 0, "creation_date": 1457261412, "post_id": 35814017, "comment_id": 59318579, "body": "@Abhimanyu yes they are all on same region North Central US"}, {"owner": {"reputation": 2164, "user_id": 2094563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2dY2x.jpg?s=128&g=1", "display_name": "meet-bhagdev", "link": "https://stackoverflow.com/users/2094563/meet-bhagdev"}, "edited": false, "score": 0, "creation_date": 1457545720, "post_id": 35814017, "comment_id": 59458318, "body": "that is correct. retry logic is used for scenarios like these. it would be good for you to replicate the code here to GO: <a href=\"https://azure.microsoft.com/en-us/documentation/articles/sql-database-develop-csharp-retry-windows/\" rel=\"nofollow noreferrer\">azure.microsoft.com/en-us/documentation/articles/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "edited": false, "score": 0, "creation_date": 1458055197, "post_id": 35993803, "comment_id": 59682086, "body": "no, the package database/sql is handling the pool and is handling creation and recycle of connections"}], "tags": [], "owner": {"reputation": 2934, "user_id": 6850, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9154a88a7e5980a9b9398f0bdead6667?s=128&d=identicon&r=PG", "display_name": "David T. Macknet", "link": "https://stackoverflow.com/users/6850/david-t-macknet"}, "is_accepted": false, "score": 0, "last_activity_date": 1457975251, "creation_date": 1457975251, "answer_id": 35993803, "question_id": 35814017, "link": "https://stackoverflow.com/questions/35814017/how-to-prevent-handle-errbadconn-with-azure-sql-database/35993803#35993803", "title": "How to prevent / handle ErrBadConn with Azure SQL Database", "body": "<p>I'm not seeing anywhere that you close your database.  Best practice (in other languages - not positive about Go) is to close / deallocate / dereference the database object after use, to release the connection back into the pool.  If you're running out of connection resources, you're being told that you need to release things.  Holding the reference open means nobody else can use that connection, so it'll stay around until it gets recycled because it's timed out.  This is why you're getting it intermittently, rather than consistently - it depends on having a certain number of connections taking place w/in a certain period of time.</p>\n"}, {"tags": [], "owner": {"reputation": 2164, "user_id": 2094563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2dY2x.jpg?s=128&g=1", "display_name": "meet-bhagdev", "link": "https://stackoverflow.com/users/2094563/meet-bhagdev"}, "is_accepted": false, "score": 0, "last_activity_date": 1458117712, "creation_date": 1458117712, "answer_id": 36030497, "question_id": 35814017, "link": "https://stackoverflow.com/questions/35814017/how-to-prevent-handle-errbadconn-with-azure-sql-database/36030497#36030497", "title": "How to prevent / handle ErrBadConn with Azure SQL Database", "body": "<p>Pierre,</p>\n\n<p>How often do you run into these connection issues? I recommend you build retry logic to graciously fail from bad connections. Here is how you would do it with C#: <a href=\"https://azure.microsoft.com/en-us/documentation/articles/sql-database-develop-csharp-retry-windows/\" rel=\"nofollow\">https://azure.microsoft.com/en-us/documentation/articles/sql-database-develop-csharp-retry-windows/</a></p>\n\n<p>If you still feel you need assistance, feel free to shoot me an email with your server name and database name at meetb@microsoft.com and we will get our team to look into this issue.</p>\n\n<p>Cheers,\nMeet</p>\n"}], "owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1458117712, "creation_date": 1457180371, "last_edit_date": 1495540226, "question_id": 35814017, "link": "https://stackoverflow.com/questions/35814017/how-to-prevent-handle-errbadconn-with-azure-sql-database", "title": "How to prevent / handle ErrBadConn with Azure SQL Database", "body": "<p>I'm using this driver: <a href=\"https://github.com/denisenkom/go-mssqldb\" rel=\"nofollow noreferrer\">https://github.com/denisenkom/go-mssqldb</a> and on production with an Azure SQL Database Standard S3 level we are getting way too much ErrBadconn - <code>driver: Bad connection</code> returned.</p>\n\n<p>How can I prevent or at least gracefully handle that. Here's some code to show how things are setup.</p>\n\n<p>A typical database function call</p>\n\n<p>package dal</p>\n\n<pre><code>var db *sql.DB\n\ntype Database struct{}\n\nfunc (d Database) Open() {\n    newDB, err := sql.Open(\"mssql\", os.Getenv(\"dbconnestion\"))\n    if err != nil {\n        panic(err)\n    }\n\n    err = newDB.Ping()\n    if err != nil {\n        panic(err)\n    }\n\n    db = newDB\n}\n\nfunc (d Database) Close() {\n    db.Close()\n}\n// ... in another file\nfunc (e *Entities) Add(entity Entity) (int64, error) {\n    stmt, err := db.Prepare(\"INSERT INTO Entities VALUES(?, ?)\")\n    if err != nil {\n        return -1, err\n    }\n    defer stmt.Close()\n\n    result, err := stmt.Exec(entity.Field1, entity.Field2)\n\n    if err != nil {\n        return -1, err\n    }\n\n    return result.LastInsertId()\n}\n</code></pre>\n\n<p>On a web api</p>\n\n<pre><code>func main() {\n  db := dal.Database{}\n  db.Open()\n  defer db.Close()\n\n  http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n     entities := &amp;dal.Entites{}\n     id, err := entities.Add(dal.Entity{Field1: \"a\", Field2: \"b\"})\n     if err != nil {\n       // here all across my web api and other web package or cli cmd that uses the dal I'm getting random ErrBadConn\n     }\n  })\n}\n</code></pre>\n\n<p>So in short, the <code>dal</code> package is shared across multiple Azure web apps and command line Go apps.</p>\n\n<p>I cannot see a pattern, those errors, which are frequent and randomly occurring.  We are using Bugsnag to log the errors from all our apps.</p>\n\n<p>For completion, sometimes our Standard S3 limit of 200 concurrent connections is reached.</p>\n\n<p>I've triple checked everywhere on the package that access the database, making sure that all <code>sql.Rows</code> were closed, all <code>db.Prepare</code> statement are closed. As and example here's how a typical query function looks like:</p>\n\n<pre><code>func (e *Entities) GetByID(id int64) ([]Entity, error) {\n    rows, err := db.Query(\"SELECT * FROM Entities WHERE ID = ?\", id)\n    if err != nil {\n        return nil, err\n    }\n    defer rows.Close()\n\n    var results []Entity\n    for rows.Next() {\n        var r Entity\n        err := readEntity(rows, &amp;r)\n        if err != nil {\n            return nil, err\n        }\n        results = append(results, r)\n    }\n\n    if err = rows.Err(); err != nil {\n        return nil, err\n    }\n\n    return results, nil\n}\n</code></pre>\n\n<p>The <code>readEntity</code> is basically only doing <code>Scan</code> on the fields.</p>\n\n<p>I don't think it's code related, unit tests run well locally. It's just once deployed to Azure after running for sometimes, the driver: Bad connection start to show up very frequently.</p>\n\n<p>I've ran this query to try and see as suggested in this question: <a href=\"https://stackoverflow.com/questions/31162597/azure-sql-server-max-pool-size-was-reached-error\">Azure SQL server max pool size was reached error</a></p>\n\n<p><code>select * from sys.dm_exeC_requests</code></p>\n\n<p>But I'm not exactly sure what should I be paying attention here.</p>\n\n<p>Things I've did / made sure of.</p>\n\n<ol>\n<li><p>As it's suggested, the <code>database/sql</code> should handle the connection pool, so having a global variable for the database connection should be fine.</p></li>\n<li><p>Making sure <code>sql.Rows</code> and <code>db.Prepare</code> statement are closed everywhere.</p></li>\n<li><p>Increased the Azure SQL level to S3.</p></li>\n<li><p>There's an issue for the sql driver I'm using talking about Azure SQL making database connection is a bad state if they are idling for more thant 2 minutes.\n<a href=\"https://github.com/denisenkom/go-mssqldb/issues/81\" rel=\"nofollow noreferrer\">https://github.com/denisenkom/go-mssqldb/issues/81</a></p></li>\n</ol>\n\n<p>Does the way <code>database/sql</code> handle the connection pooling is in any way not working with the way Azure SQL Database are manage.</p>\n\n<p>Is there a way to gracefully handle this? I know that C# / Entity Framework have a connection resiliency / retry logic for Azure SQL, is it for the similar reasons? How could I implement this without having to pass everywhere on my error handling? I mean I don't want to do something like this clearly:</p>\n\n<pre><code>if err == sql.ErrBadConn {\n  // close and re-open the global db object\n  // retry\n}\n</code></pre>\n\n<p>This is certainly not my only option here?</p>\n\n<p>Any help would be extremely welcome.\nThank you</p>\n"}, {"tags": ["time", "go"], "comments": [{"owner": {"reputation": 2745, "user_id": 1268294, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/qymw2.jpg?s=128&g=1", "display_name": "Pawe\u0142 Adamski", "link": "https://stackoverflow.com/users/1268294/pawe%c5%82-adamski"}, "edited": false, "score": 1, "creation_date": 1457169310, "post_id": 35811913, "comment_id": 59292777, "body": "What is the type of cfg.Config.Timeout? Is it time.Duration?"}, {"owner": {"reputation": 2745, "user_id": 1268294, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/qymw2.jpg?s=128&g=1", "display_name": "Pawe\u0142 Adamski", "link": "https://stackoverflow.com/users/1268294/pawe%c5%82-adamski"}, "edited": false, "score": 1, "creation_date": 1457169349, "post_id": 35811913, "comment_id": 59292790, "body": "It works in simple solution: <a href=\"https://play.golang.org/p/XScNTsD3yX\" rel=\"nofollow noreferrer\">play.golang.org/p/XScNTsD3yX</a>"}, {"owner": {"reputation": 867, "user_id": 764516, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e9c6eb568d8f822119773908a236ebbc?s=128&d=identicon&r=PG", "display_name": "thinkhy", "link": "https://stackoverflow.com/users/764516/thinkhy"}, "reply_to_user": {"reputation": 2745, "user_id": 1268294, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/qymw2.jpg?s=128&g=1", "display_name": "Pawe\u0142 Adamski", "link": "https://stackoverflow.com/users/1268294/pawe%c5%82-adamski"}, "edited": false, "score": 0, "creation_date": 1457173008, "post_id": 35811913, "comment_id": 59293726, "body": "@Pawe\u0142Adamski  Yes, its type is time.Druation:Timeout time.Duration"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1457179899, "post_id": 35811913, "comment_id": 59295809, "body": "And are you updating cfg.Config.Timeout concurrently to this?"}, {"owner": {"reputation": 867, "user_id": 764516, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e9c6eb568d8f822119773908a236ebbc?s=128&d=identicon&r=PG", "display_name": "thinkhy", "link": "https://stackoverflow.com/users/764516/thinkhy"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1457181168, "post_id": 35811913, "comment_id": 59296222, "body": "@PaulHankin  no, cfg.Config.Timeout is updated only once while reading value from a config file(json format)."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1457181431, "post_id": 35811913, "comment_id": 59296304, "body": "@thinkhy and is it updated before or after you call StartCleanTask()? Can you include in your question how you&#39;re initializing it? Have you run your code using the race detector? (<a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow noreferrer\">golang.org/doc/articles/race_detector.html</a>)"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1457182110, "post_id": 35811913, "comment_id": 59296515, "body": "We can only guess since you haven&#39;t provided us with a reproducible example: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a>"}], "answers": [{"comments": [{"owner": {"reputation": 867, "user_id": 764516, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e9c6eb568d8f822119773908a236ebbc?s=128&d=identicon&r=PG", "display_name": "thinkhy", "link": "https://stackoverflow.com/users/764516/thinkhy"}, "edited": false, "score": 0, "creation_date": 1457182517, "post_id": 35814292, "comment_id": 59296649, "body": "You are right. Actually StartCleanTask() is invoked in the init function of cfg package, and  cfg.Config.Timeout is assigned to a specified value in main function. BUT I ignored that package&#39;s init() function is invoked before main().  Really thanks!"}], "tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1457181948, "creation_date": 1457181948, "answer_id": 35814292, "question_id": 35811913, "link": "https://stackoverflow.com/questions/35811913/product-of-two-time-duration-is-zero-in-a-golang-variable/35814292#35814292", "title": "Product of two time duration is zero in a Golang variable", "body": "<p>My guess is that you're updating <code>cfg.Config.Timeout</code> concurrently to this task. Perhaps like this:</p>\n\n<pre><code>func main() {\n    StartCleanTask()\n    cfg.Config.Timeout = 300\n    ...\n}\n</code></pre>\n\n<p>This introduces a race, and it happens that in the goroutine inside <code>StartCleanTask</code>, <code>delay</code> is assigned before the <code>Timeout</code> is initialized, and the <code>fmt.Println</code> happens after the initialization.</p>\n\n<p>You can use the <a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow\">race detector</a> to see if this is the problem.</p>\n\n<p>Assuming that <code>cfg</code> is only initialized once, probably the right fix is to only start the cleanup task once the initialization has finished.</p>\n"}], "owner": {"reputation": 867, "user_id": 764516, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e9c6eb568d8f822119773908a236ebbc?s=128&d=identicon&r=PG", "display_name": "thinkhy", "link": "https://stackoverflow.com/users/764516/thinkhy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1049, "favorite_count": 1, "accepted_answer_id": 35814292, "answer_count": 1, "score": -2, "last_activity_date": 1457182990, "creation_date": 1457166685, "last_edit_date": 1457182990, "question_id": 35811913, "link": "https://stackoverflow.com/questions/35811913/product-of-two-time-duration-is-zero-in-a-golang-variable", "title": "Product of two time duration is zero in a Golang variable", "body": "<p>It's weird in below Golang code that product of two time duration is zero in variable 'delay', but when print the product directly without through any variable, the output is as expected. Anyone can explain this? </p>\n\n<pre><code> func StartCleanTask() {\n  go func() {\n       delay := cfg.Config.Timeout * time.Second\n       for {\n           fmt.Println(\"Go clean task: \", delay, cfg.Config.Timeout*time.Second)\n           select {\n           case &lt;-time.After(cfg.Config.Timeout * time.Second):\n               clean()\n           }\n     }\n  }()\n</code></pre>\n\n<p>}</p>\n\n<p>The output is:</p>\n\n<pre><code> Go clean task: 0 5m0s\n</code></pre>\n\n<p><strong>Update:</strong></p>\n\n<p>I also attempted to run following code, it works well.</p>\n\n<pre><code>package main \nimport \"fmt\"\nimport \"time\"\n\nfunc main() {\n\n   var timeout time.Duration\n   timeout = 100\n   delay := timeout * time.Second\n\n   fmt.Println(\"Go clean task: \", delay, timeout*time.Second)\n\n}\n</code></pre>\n\n<p><strong>Update again:</strong></p>\n\n<p>Paul's answer is accepted. Actually StartCleanTask() is invoked in the init function of cfg package, and cfg.Config.Timeout is assigned to a specified value in main function. BUT I ignored that package's init() function is invoked implicitly before main(), so the variable delay is always ZERO. </p>\n\n<p>BTW, I don't understand why some people give negative score to this question. I think others may hit similar problem, and this post should be helpful to the victim who don't really know the calling sequence between init() and main().</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15557, "user_id": 390807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f64fce01ffa86130c3fae06b1fcadef?s=128&d=identicon&r=PG", "display_name": "chill", "link": "https://stackoverflow.com/users/390807/chill"}, "edited": false, "score": 0, "creation_date": 1457166767, "post_id": 35811907, "comment_id": 59292058, "body": "Where did you get that idea of getting an error if the communication over a channel cannot proceed immediately ?"}, {"owner": {"reputation": 191, "user_id": 1457733, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iA1HU.png?s=128&g=1", "display_name": "D. Luffy", "link": "https://stackoverflow.com/users/1457733/d-luffy"}, "reply_to_user": {"reputation": 15557, "user_id": 390807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f64fce01ffa86130c3fae06b1fcadef?s=128&d=identicon&r=PG", "display_name": "chill", "link": "https://stackoverflow.com/users/390807/chill"}, "edited": false, "score": 0, "creation_date": 1457166930, "post_id": 35811907, "comment_id": 59292109, "body": "May be I am mistaken but that&#39;s what I have experienced when I executed the first block."}, {"owner": {"reputation": 191, "user_id": 1457733, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iA1HU.png?s=128&g=1", "display_name": "D. Luffy", "link": "https://stackoverflow.com/users/1457733/d-luffy"}, "reply_to_user": {"reputation": 15557, "user_id": 390807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f64fce01ffa86130c3fae06b1fcadef?s=128&d=identicon&r=PG", "display_name": "chill", "link": "https://stackoverflow.com/users/390807/chill"}, "edited": false, "score": 0, "creation_date": 1457167207, "post_id": 35811907, "comment_id": 59292214, "body": "This is what I get with the first code block: fatal error: all goroutines are asleep - deadlock!  goroutine 1 [chan send]: main.main() \t/go-by-example/20.channel-buffering.go:33 +0xaf"}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 1457733, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iA1HU.png?s=128&g=1", "display_name": "D. Luffy", "link": "https://stackoverflow.com/users/1457733/d-luffy"}, "edited": false, "score": 0, "creation_date": 1457167806, "post_id": 35812036, "comment_id": 59292372, "body": "Thanks this is what I&#39;ve just noticed. So its nothing to do with a buffer overrun in any sort instead needing to have something else is running."}], "tags": [], "owner": {"reputation": 15557, "user_id": 390807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f64fce01ffa86130c3fae06b1fcadef?s=128&d=identicon&r=PG", "display_name": "chill", "link": "https://stackoverflow.com/users/390807/chill"}, "is_accepted": true, "score": 1, "last_activity_date": 1457167554, "creation_date": 1457167554, "answer_id": 35812036, "question_id": 35811907, "link": "https://stackoverflow.com/questions/35811907/go-channel-buffering-and-deadlocks/35812036#35812036", "title": "Go channel buffering and deadlocks", "body": "<p>You get a panic, when the Go runtime discovers that all goroutines are in a deadlock: waiting for some \"internal\" event, internal in the sense another goroutine is expected to trigger it.</p>\n\n<p>This is what you get in the first program.</p>\n\n<p>In the second program, you have a \"hidden\" goroutine, created by the call to <code>time.Tick</code>. This goroutine sends ticks on a channel, but does not block on it (\"drops ticks to make up for slow receivers\" form the docs). So you have at least one running goroutine in the second example, which occasionally blocks on external event (timer tick), thus the whole system is not deadlocked form the point of view of the Go runtime deadlock detection.</p>\n"}], "owner": {"reputation": 191, "user_id": 1457733, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iA1HU.png?s=128&g=1", "display_name": "D. Luffy", "link": "https://stackoverflow.com/users/1457733/d-luffy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 35812036, "answer_count": 1, "score": 0, "last_activity_date": 1457167554, "creation_date": 1457166649, "question_id": 35811907, "link": "https://stackoverflow.com/questions/35811907/go-channel-buffering-and-deadlocks", "title": "Go channel buffering and deadlocks", "body": "<p>Considering the following code block, it's expected to throw an error due to reaching a the buffer limit:</p>\n\n<pre><code>package main        \n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n\n    burstyLimiter := make(chan time.Time, 4)\n\n    for i := 0; i &lt; 5; i++ {\n        burstyLimiter &lt;- time.Now()\n        fmt.Println(\"adding to burstyLimiter\")\n    }\n\n}\n</code></pre>\n\n<p>But when I try the exact block with the following, it blocks instead of throwing an error. I am tying to understand this behavior. Thanks for your time.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n\n    requests := make(chan int, 5)\n    close(requests)\n\n    limiter := time.Tick(time.Millisecond * 200)\n\n    for req := range requests {\n        &lt;-limiter\n        fmt.Println(\"request\", req, time.Now())\n    }\n\n    burstyLimiter := make(chan time.Time, 4)\n\n    for i := 0; i &lt; 5; i++ {\n        burstyLimiter &lt;- time.Now()\n        fmt.Println(\"adding to burstyLimiter\")\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 623, "user_id": 5615224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7bea88308ec27975167f216eb8f998e?s=128&d=identicon&r=PG&f=1", "display_name": "sfault", "link": "https://stackoverflow.com/users/5615224/sfault"}, "edited": false, "score": 0, "creation_date": 1457161706, "post_id": 35811215, "comment_id": 59290902, "body": "For fields to be exported have first letter in capitals for eg: <code>user_id</code> should be <code>User_id</code> or better if its named <code>UserID</code>"}], "answers": [{"comments": [{"owner": {"reputation": 397, "user_id": 7455192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SFuGK.png?s=128&g=1", "display_name": "ame", "link": "https://stackoverflow.com/users/7455192/ame"}, "edited": false, "score": 1, "creation_date": 1541694437, "post_id": 35811275, "comment_id": 93311884, "body": "OMG! It&#39;s a s**t. I didn&#39;t name a function with the capital letter and Go didn&#39;t export it. I had <code>connect_db</code> func in package <code>models</code>, tried to call <code>models.connect_db()</code> in <code>main.go</code> and compiler said &quot;cannot use unexported name models.connect_db&quot;. So I renamed <code>connect_db</code> to <code>ConnectDB</code> and it was successfully exported from <code>models</code> package."}], "tags": [], "owner": {"reputation": 623, "user_id": 5615224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7bea88308ec27975167f216eb8f998e?s=128&d=identicon&r=PG&f=1", "display_name": "sfault", "link": "https://stackoverflow.com/users/5615224/sfault"}, "is_accepted": true, "score": 22, "last_activity_date": 1457162092, "creation_date": 1457162092, "answer_id": 35811275, "question_id": 35811215, "link": "https://stackoverflow.com/questions/35811215/undefined-cannot-refer-to-unexported-field-or-method/35811275#35811275", "title": "undefined (cannot refer to unexported field or method)", "body": "<p>Use Capitals for exported fields in struct, when referring struct in another package.</p>\n\n<pre><code>package models\n\nimport (\n    \"time\"\n)\n\ntype Users struct {\n    ID                   int       `json:\"user_id\" form:\"user_id\" gorm:\"column:user_id\"`\n    Login                string    `json:\"user_login\" form:\"user_login\" gorm:\"column:user_login\"`\n    Email                string    `json:\"user_email\" form:\"user_email\" gorm:\"column:user_email\"`\n    Password             string    `json:\"user_password\" form:\"user_password\" gorm:\"column:user_password\"`\n    PasswordSalt         string    `json:\"user_password_salt\" form:\"user_password_salt\" gorm:\"column:user_password_salt\"`\n    TwoFactorSecret      string    `json:\"user_2factor_secret\" form:\"user_2factor_secret\" gorm:\"column:user_2factor_secret\"`\n    Fullname             string    `json:\"user_fullname\" form:\"user_fullname\" gorm:\"column:user_fullname\"`\n    Description          string    `json:\"user_description\" form:\"user_description\" gorm:\"column:user_description\"`\n    Enabled              string    `json:\"user_enabled\" form:\"user_enabled\" gorm:\"column:user_enabled\"`\n    Verified             string    `json:\"user_verified\" form:\"user_verified\" gorm:\"column:user_verified\"`\n    PublisherInfoID      int       `json:\"PublisherInfoID\" form:\"PublisherInfoID\" gorm:\"column:PublisherInfoID\"`\n    DemandCustomerInfoID int       `json:\"DemandCustomerInfoID\" form:\"DemandCustomerInfoID\" gorm:\"column:DemandCustomerInfoID\"`\n    CreateDate           time.Time `json:\"create_date\" gorm:\"column:create_date\"`\n    UpdateDate           time.Time `json:\"update_date\" gorm:\"column:update_date\"`\n    PermissionCache      string    `json:\"user_permission_cache\" form:\"user_permission_cache\" gorm:\"column:user_permission_cache\"`\n    Role                 int       `json:\"user_role\" form:\"user_role\" gorm:\"column:user_role\"`\n}\n</code></pre>\n\n<p>Now do <code>Users.ID</code> to get fields.</p>\n"}], "owner": {"reputation": 131, "user_id": 974393, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ebe9451e3700456889e90e5d54053fd7?s=128&d=identicon&r=PG", "display_name": "nu123", "link": "https://stackoverflow.com/users/974393/nu123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10488, "favorite_count": 0, "accepted_answer_id": 35811275, "answer_count": 1, "score": 2, "last_activity_date": 1568880551, "creation_date": 1457161517, "last_edit_date": 1568880551, "question_id": 35811215, "link": "https://stackoverflow.com/questions/35811215/undefined-cannot-refer-to-unexported-field-or-method", "title": "undefined (cannot refer to unexported field or method)", "body": "<p>I'm trying to refer <code>Users struct</code> from the models package and trying to access the model from control.But I take following errors.</p>\n\n<pre><code>controllers/user.go:87: user.create_date undefined (cannot refer to unexported field or method create_date)\ncontrollers/user.go:88: user.update_date undefined (cannot refer to unexported field or method update_date)\ncontrollers/user.go:104: user.user_id undefined (cannot refer to unexported field or method user_id)\ncontrollers/user.go:119: user.update_date undefined (cannot refer to unexported field or method update_date)\ncontrollers/user.go:136: user.user_id undefined (cannot refer to unexported field or method user_id)\ncontrollers/user.go:151: user.update_date undefined (cannot refer to unexported field or method update_date)\ncontrollers/user.go:166: user.user_id undefined (cannot refer to unexported field or method user_id)\n</code></pre>\n\n<p>Models.go</p>\n\n<pre><code>package models\n\n\nimport(\n\n    \"time\"\n)\n\n    type Users struct {\n\n            user_id                                      int      `json:\"user_id\" form:\"user_id\" gorm:\"column:user_id\"`\n            user_login                                   string   `json:\"user_login\" form:\"user_login\" gorm:\"column:user_login\"` \n            user_email                                   string   `json:\"user_email\" form:\"user_email\" gorm:\"column:user_email\"` \n            user_password                                string   `json:\"user_password\" form:\"user_password\" gorm:\"column:user_password\"` \n            user_password_salt                           string   `json:\"user_password_salt\" form:\"user_password_salt\" gorm:\"column:user_password_salt\"` \n            user_2factor_secret                          string   `json:\"user_2factor_secret\" form:\"user_2factor_secret\" gorm:\"column:user_2factor_secret\"`\n            user_fullname                                string   `json:\"user_fullname\" form:\"user_fullname\" gorm:\"column:user_fullname\"`\n            user_description                             string   `json:\"user_description\" form:\"user_description\" gorm:\"column:user_description\"`\n            user_enabled                                 string   `json:\"user_enabled\" form:\"user_enabled\" gorm:\"column:user_enabled\"`\n            user_verified                                string   `json:\"user_verified\" form:\"user_verified\" gorm:\"column:user_verified\"`\n            PublisherInfoID                              int      `json:\"PublisherInfoID\" form:\"PublisherInfoID\" gorm:\"column:PublisherInfoID\"`\n            DemandCustomerInfoID                         int      `json:\"DemandCustomerInfoID\" form:\"DemandCustomerInfoID\" gorm:\"column:DemandCustomerInfoID\"`\n            create_date                                  time.Time `json:\"create_date\" gorm:\"column:create_date\"`\n            update_date                                  time.Time  `json:\"update_date\" gorm:\"column:update_date\"` \n            user_permission_cache                        string   `json:\"user_permission_cache\" form:\"user_permission_cache\" gorm:\"column:user_permission_cache\"`\n            user_role                                    int      `json:\"user_role\" form:\"user_role\" gorm:\"column:user_role\"`\n\n        }\n</code></pre>\n\n<p>in controllers</p>\n\n<pre><code>   package controllers\n\n    import (\n        \"time\"\n\n      \"github.com/op/go-logging\"\n        \"github.com/gin-gonic/gin\"\n        \"github.com/jinzhu/gorm\"\n      _ \"github.com/go-sql-driver/mysql\"\n\n        \"../models\"\n    )\n\n    var loguser = logging.MustGetLogger(\"AdsAPI\")\n\n    type AdsControllerUser struct {\n        DB gorm.DB\n    }\n\n    func (ac *AdsControllerUser) SetDB(d gorm.DB) {\n        ac.DB = d\n        ac.DB.LogMode(true)\n    }\n    func (ac *AdsControllerUser) CreateUsers(c *gin.Context) {\n\n      var user models.Users\n\n      // This will infer what binder to use depending on the content-type header.\n      c.Bind(&amp;user)\n\n        // Update Timestamps\n        user.create_date = time.Now()\n        user.update_date = time.Now()\n\n        err := ac.DB.Save(&amp;user)\n        if err != nil {\n            loguser.Debugf(\"Error while creating a user, the error is '%v'\", err)\n            res := gin.H{\n                    \"status\": \"403\",\n                    \"error\": \"Unable to create user\",\n            }\n            c.JSON(404, res)\n            return\n        }\n\n        content := gin.H{\n                \"status\": \"201\",\n                \"result\": \"Success\",\n                \"UserID\": user.user_id,\n            }\n\n      c.Writer.Header().Set(\"Content-Type\", \"application/json\")\n      c.JSON(201, content)\n    }\n\nfunc (ac *AdsControllerUser) UpdateUsers(c *gin.Context) {\n    // Grab id\n    id := c.Params.ByName(\"id\")\n  var user models.Users\n\n  c.Bind(&amp;user)\n\n    // Update Timestamps\n    user.update_date = time.Now()\n\n    //err := ac.DB.Model(&amp;models.auth_User).Where(\"user_id = ?\", id).Updates(&amp;cm)\n    err := ac.DB.Where(\"user_id = ?\", id).Updates(&amp;user)\n    if err != nil {\n        loguser.Debugf(\"Error while updating a user, the error is '%v'\", err)\n        res := gin.H{\n                \"status\": \"403\",\n                \"error\": \"Unable to update user\",\n        }\n        c.JSON(403, res)\n        return\n    }\n\n    content := gin.H{\n            \"status\": \"201\",\n            \"result\": \"Success\",\n            \"UserID\": user.user_id,\n        }\n\n    c.Writer.Header().Set(\"Content-Type\", \"application/json\")\n    c.JSON(201, content)\n}\n\nfunc (ac *AdsControllerUser) DeleteUsers(c *gin.Context) {\n    // Grab id\n    id := c.Params.ByName(\"id\")\n  var user models.Users\n\n  c.Bind(&amp;user)\n\n    // Update Timestamps\n    user.update_date = time.Now()\n\n    err := ac.DB.Where(\"user_id = ?\", id).Delete(&amp;user)\n    if err != nil {\n        loguser.Debugf(\"Error while deleting a user, the error is '%v'\", err)\n        res := gin.H{\n                \"status\": \"403\",\n                \"error\": \"Unable to delete user\",\n        }\n        c.JSON(403, res)\n        return\n    }\n\n    content := gin.H {\n            \"result\": \"Success\",\n            \"UserID\": user.user_id,\n        }\n\n  c.Writer.Header().Set(\"Content-Type\", \"application/json\")\n  c.JSON(201, content)\n}\n</code></pre>\n"}, {"tags": ["python", "encryption", "go", "cryptography", "aes"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1457188571, "post_id": 35811119, "comment_id": 59298406, "body": "I strongly recommend you use <a href=\"https://godoc.org/golang.org/x/crypto/nacl/secretbox\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/crypto/nacl/secretbox</a> and <a href=\"https://pynacl.readthedocs.org/en/latest/\" rel=\"nofollow noreferrer\">pynacl.readthedocs.org/en/latest</a> (for Python) if you need to encrypt messages."}], "answers": [{"comments": [{"owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 0, "creation_date": 1457187060, "post_id": 35812057, "comment_id": 59297939, "body": "These two suggestions are equivalent for modes like CFB (with full block shift register) and CBC, but will not work for modes like CTR. In that case, go with the first one."}, {"owner": {"reputation": 199, "user_id": 1167741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf35c1cb67665b1d9cde2cf851716a3e?s=128&d=identicon&r=PG&f=1", "display_name": "stihl", "link": "https://stackoverflow.com/users/1167741/stihl"}, "edited": false, "score": 0, "creation_date": 1457195947, "post_id": 35812057, "comment_id": 59301096, "body": "thanks this helped with the python part, i made an edit above for decrypting with Go. Thanks!"}], "tags": [], "owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "is_accepted": false, "score": 3, "last_activity_date": 1457167705, "creation_date": 1457167705, "answer_id": 35812057, "question_id": 35811119, "link": "https://stackoverflow.com/questions/35811119/aes-encryption-golang-and-python/35812057#35812057", "title": "AES Encryption Golang and Python", "body": "<p>You forgot to slice off the IV during decryption in Python. Change</p>\n\n<pre><code>x=(cipher.decrypt( enc ))\n</code></pre>\n\n<p>to </p>\n\n<pre><code>x = cipher.decrypt( enc[16:] )\n</code></pre>\n\n<p>or to</p>\n\n<pre><code>x = cipher.decrypt( enc )[16:]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 123, "user_id": 1097098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89ff05d5bc2c399ead0d60d63f418a58?s=128&d=identicon&r=PG", "display_name": "qatz", "link": "https://stackoverflow.com/users/1097098/qatz"}, "edited": false, "score": 0, "creation_date": 1589878247, "post_id": 42770165, "comment_id": 109460184, "body": "For me it needs a little modification and it works like a charm. Here&#39;s how: modify line 12 on decrypt() to this: <code>padded_value = value + b&#39;\\0&#39; * (16 - remainder) if remainder else value</code> and modify the last line on encrypt() to <code>return base64.b64encode(iv + value, b&#39;-_&#39;).rstrip(b&#39;=&#39;)</code>"}], "tags": [], "owner": {"reputation": 47233, "user_id": 119081, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4fa5be67e1e4b49c0765d218cfe7689b?s=128&d=identicon&r=PG", "display_name": "Blixt", "link": "https://stackoverflow.com/users/119081/blixt"}, "is_accepted": false, "score": 3, "last_activity_date": 1489427248, "creation_date": 1489427248, "answer_id": 42770165, "question_id": 35811119, "link": "https://stackoverflow.com/questions/35811119/aes-encryption-golang-and-python/42770165#42770165", "title": "AES Encryption Golang and Python", "body": "<p>Python uses 8-bit segments while Go uses 128-bit segments so the reason the first character works but the following ones don't is because each segment depends on the previous and thus a different segment size breaks the chain.</p>\n\n<p>I made these URL safe (non-padded base64 encoding) encrypt/decrypt functions for Python to optionally encrypt the same way Go does (when you specify <code>block_segments=True</code>).</p>\n\n<pre><code>def decrypt(key, value, block_segments=False):\n    # The base64 library fails if value is Unicode. Luckily, base64 is ASCII-safe.\n    value = str(value)\n    # We add back the padding (\"=\") here so that the decode won't fail.\n    value = base64.b64decode(value + '=' * (4 - len(value) % 4), '-_')\n    iv, value = value[:AES.block_size], value[AES.block_size:]\n    if block_segments:\n        # Python uses 8-bit segments by default for legacy reasons. In order to support\n        # languages that encrypt using 128-bit segments, without having to use data with\n        # a length divisible by 16, we need to pad and truncate the values.\n        remainder = len(value) % 16\n        padded_value = value + '\\0' * (16 - remainder) if remainder else value\n        cipher = AES.new(key, AES.MODE_CFB, iv, segment_size=128)\n        # Return the decrypted string with the padding removed.\n        return cipher.decrypt(padded_value)[:len(value)]\n    return AES.new(key, AES.MODE_CFB, iv).decrypt(value)\n\n\ndef encrypt(key, value, block_segments=False):\n    iv = Random.new().read(AES.block_size)\n    if block_segments:\n        # See comment in decrypt for information.\n        remainder = len(value) % 16\n        padded_value = value + '\\0' * (16 - remainder) if remainder else value\n        cipher = AES.new(key, AES.MODE_CFB, iv, segment_size=128)\n        value = cipher.encrypt(padded_value)[:len(value)]\n    else:\n        value = AES.new(key, AES.MODE_CFB, iv).encrypt(value)\n    # The returned value has its padding stripped to avoid query string issues.\n    return base64.b64encode(iv + value, '-_').rstrip('=')\n</code></pre>\n\n<p>Note that <strong>for secure message passing</strong> you want additional security features, such as a nonce to prevent against replay attacks.</p>\n\n<p>Here are the Go equivalent functions:</p>\n\n<pre><code>func Decrypt(key []byte, encrypted string) ([]byte, error) {\n    ciphertext, err := base64.RawURLEncoding.DecodeString(encrypted)\n    if err != nil {\n        return nil, err\n    }\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        return nil, err\n    }\n    if len(ciphertext) &lt; aes.BlockSize {\n        return nil, errors.New(\"ciphertext too short\")\n    }\n    iv := ciphertext[:aes.BlockSize]\n    ciphertext = ciphertext[aes.BlockSize:]\n    cfb := cipher.NewCFBDecrypter(block, iv)\n    cfb.XORKeyStream(ciphertext, ciphertext)\n    return ciphertext, nil\n}\n\nfunc Encrypt(key, data []byte) (string, error) {\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        return \"\", err\n    }\n    ciphertext := make([]byte, aes.BlockSize+len(data))\n    iv := ciphertext[:aes.BlockSize]\n    if _, err := io.ReadFull(rand.Reader, iv); err != nil {\n        return \"\", err\n    }\n    stream := cipher.NewCFBEncrypter(block, iv)\n    stream.XORKeyStream(ciphertext[aes.BlockSize:], data)\n    return base64.RawURLEncoding.EncodeToString(ciphertext), nil\n}\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 1167741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf35c1cb67665b1d9cde2cf851716a3e?s=128&d=identicon&r=PG&f=1", "display_name": "stihl", "link": "https://stackoverflow.com/users/1167741/stihl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2668, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1489427248, "creation_date": 1457160856, "last_edit_date": 1457195911, "question_id": 35811119, "link": "https://stackoverflow.com/questions/35811119/aes-encryption-golang-and-python", "title": "AES Encryption Golang and Python", "body": "<p>I am working on a fun side project for myself. A golang server and a python client. I want data transmitted to be encrypted but cant seem to get the two encryption schemes working together. I am a novice when it comes to encryption so please explain like you are talking to a toddler. </p>\n\n<p>Here is my golang encryption functions:</p>\n\n<pre><code>import (\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"crypto/rand\"\n    \"errors\"\n    \"io\"\n    \"fmt\"\n)\nfunc Encrypt(key, text []byte) (ciphertext []byte, err error) {\n    var block cipher.Block\n    if block, err = aes.NewCipher(key); err != nil {\n        return nil, err\n    }\n    ciphertext = make([]byte, aes.BlockSize+len(string(text)))\n    iv := ciphertext[:aes.BlockSize]\n    fmt.Println(aes.BlockSize)\n    if _, err = io.ReadFull(rand.Reader, iv); err != nil {\n        return\n    }\n    cfb := cipher.NewCFBEncrypter(block, iv)\n    cfb.XORKeyStream(ciphertext[aes.BlockSize:], text)\n    return\n}\n\nfunc Decrypt(key, ciphertext []byte) (plaintext []byte, err error) {\n    var block cipher.Block\n    if block, err = aes.NewCipher(key); err != nil {\n        return\n    }\n    if len(ciphertext) &lt; aes.BlockSize {\n        err = errors.New(\"ciphertext too short\")\n        return\n    }\n    iv := ciphertext[:aes.BlockSize]\n    ciphertext = ciphertext[aes.BlockSize:]\n    cfb := cipher.NewCFBDecrypter(block, iv)\n    cfb.XORKeyStream(ciphertext, ciphertext)\n    plaintext = ciphertext\n    return\n}\n</code></pre>\n\n<p>and here is my Python implementation:</p>\n\n<pre><code> class AESCipher:\n    def __init__( self, key ):\n        self.key = key\n        print \"INIT KEY\" + hexlify(self.key)\n    def encrypt( self, raw ):\n        print \"RAW STRING: \" + hexlify(raw)\n        iv = Random.new().read( AES.block_size )\n        cipher = AES.new( self.key, AES.MODE_CFB, iv )\n        r = ( iv + cipher.encrypt( raw ) )\n        print \"ECRYPTED STRING: \" + hexlify(r)\n        return r\n\n    def decrypt( self, enc ):\n        enc = (enc)\n        iv = enc[:16]\n        cipher = AES.new(self.key, AES.MODE_CFB, iv)\n        x=(cipher.decrypt( enc ))\n        print \"DECRYPTED STRING: \" + hexlify(x)\n        return x\n</code></pre>\n\n<p>i cant quite figure out the output of my python functions either. My Go routines are working perfectly. But i want to be able to encrypt in Go an decrypt in python and vice versa.</p>\n\n<p>Sample Output from Python:</p>\n\n<pre><code>INIT KEY61736466617364666173646661736466\nRAW STRING: 54657374206d657373616765\nECRYPTED STRING: dfee33dd40c32fbaf9aac73ac4e0a5a9fc7bd2947d29005dd8d8e21a\ndfee33dd40c32fbaf9aac73ac4e0a5a9fc7bd2947d29005dd8d8e21a\nDECRYPTED STRING: 77d899b990d2d3172a3229b1b69c6f2554657374206d657373616765\n77d899b990d2d3172a3229b1b69c6f2554657374206d657373616765\nw\u00d8\u2122\u00b9\ufffd\u00d2\u00d3*2)\u00b1\u00b6\u0153o%Test message\n</code></pre>\n\n<p>As you can see the message is decrypted but ends up at the end of the string?</p>\n\n<p><strong>EDIT:</strong>\nSample output decrypting from GO.\nIf i try and decrypt with GO the below (generated with Python)</p>\n\n<pre><code>ECRYPTED STRING: (Test Message) 7af474bc4c8ea9579d83a3353f83a0c2844f8efb019c82618ea0b478\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>Decrypted Payload: 54 4E 57 9B 90 F8 D6 CD 12 59 0B B1\nDecrypted Payload: TNW\ufffd\ufffd\ufffd\ufffd\ufffdY\ufffd\n</code></pre>\n\n<p>The strange part is the first character is always correct</p>\n\n<p>here are both full projects:</p>\n\n<p><a href=\"https://github.com/engineerbeard\" rel=\"nofollow\">Github</a></p>\n"}, {"tags": ["git", "go", "makefile"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1457161338, "post_id": 35811095, "comment_id": 59290836, "body": "Many developers setup their editor to run goimports/gofmt.  There&#39;s no need to <code>go get .&#47;...</code> unless you are pulling down something new.  If you name the directory containing the app &quot;${APP_NAME}&quot;, then all you need to do is <code>go build</code>.  With this config, no makefile is needed."}, {"owner": {"reputation": 1385, "user_id": 145768, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d3fc6a1bde744f0f1003880ed72afad?s=128&d=identicon&r=PG", "display_name": "Milan Aleksi\u0107", "link": "https://stackoverflow.com/users/145768/milan-aleksi%c4%87"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1457161454, "post_id": 35811095, "comment_id": 59290861, "body": "I disagree. I have many many other tasks, the upper one is just one example. gometalinter, go-bindata, etc. Question remains although a particular example mentioned above can be avoided by some editor setup"}], "answers": [{"tags": [], "owner": {"reputation": 1385, "user_id": 145768, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d3fc6a1bde744f0f1003880ed72afad?s=128&d=identicon&r=PG", "display_name": "Milan Aleksi\u0107", "link": "https://stackoverflow.com/users/145768/milan-aleksi%c4%87"}, "is_accepted": true, "score": 0, "last_activity_date": 1459066133, "creation_date": 1459066133, "answer_id": 36245211, "question_id": 35811095, "link": "https://stackoverflow.com/questions/35811095/patterns-of-partially-reused-makefiles/36245211#36245211", "title": "Patterns of partially reused makefiles", "body": "<p>I have found a simple workaround: I <code>include</code> Makefiles which I made from the starting monolithic Makefile.</p>\n\n<p>I am putting split Makefiles in a separate git project, that contains only them.</p>\n\n<p>I am referring to those Makefiles from root project and I have them locally via git submodule. A bit more work - yes, but it allows me to have trivial \"root\" Makefile and all hard (quite often - repeating) logic in the separate project.</p>\n\n<p>Example of how I made this work:</p>\n\n<ul>\n<li>a split makefile project: <a href=\"https://github.com/milanaleksic/gomakefiles\" rel=\"nofollow\">https://github.com/milanaleksic/gomakefiles</a></li>\n<li>a root makefile that utilizes the upper project via submodule: <a href=\"https://github.com/milanaleksic/jenkins_ping\" rel=\"nofollow\">https://github.com/milanaleksic/jenkins_ping</a></li>\n</ul>\n"}], "owner": {"reputation": 1385, "user_id": 145768, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d3fc6a1bde744f0f1003880ed72afad?s=128&d=identicon&r=PG", "display_name": "Milan Aleksi\u0107", "link": "https://stackoverflow.com/users/145768/milan-aleksi%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 36245211, "answer_count": 1, "score": 0, "last_activity_date": 1459066133, "creation_date": 1457160676, "question_id": 35811095, "link": "https://stackoverflow.com/questions/35811095/patterns-of-partially-reused-makefiles", "title": "Patterns of partially reused makefiles", "body": "<p>I am at this time creating more and more of small one-off projects in golang but I see many makefile tasks are literally copy&amp;paste from across projects. For example, in every project I have a:</p>\n\n<pre><code>${APP_NAME}: $(SOURCES)\n    go get ./...\n    goimports -w $(SOURCES)\n    go build -o ${APP_NAME}\n</code></pre>\n\n<p>I would like to know if anyone has experience of fragment extraction into a separate project and importing it. If so, how do you do it? </p>\n\n<ul>\n<li><p>Just curl a file from <code>raw.githubusercontent.com</code>? Because that's what I'm about to do since I don't see any other easy way.</p></li>\n<li><p>I also thought about using git submodules but that seems also a bit over the top for a couple of files.</p></li>\n</ul>\n"}, {"tags": ["go", "iterator"], "answers": [{"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 14, "last_activity_date": 1457158253, "creation_date": 1457158253, "answer_id": 35810778, "question_id": 35810674, "link": "https://stackoverflow.com/questions/35810674/in-go-is-it-possible-to-iterate-over-a-custom-type/35810778#35810778", "title": "In Go is it possible to iterate over a custom type?", "body": "<p>No, not using <code>range</code>. <code>range</code> accepts arrays, slices, strings, maps, and channels, and that's it.</p>\n\n<p>The usual sort of idiom for iterable things (for example a <code>bufio.Scanner</code>) seems to be</p>\n\n<pre><code>iter := NewIterator(...)\nfor iter.More() {\n    item := iter.Item()\n    // do something with item\n}\n</code></pre>\n\n<p>but there's no universal interface (wouldn't be very useful given the type system anyway) and different types that implement the pattern generally have different names for their <code>More</code> and<code>Item</code> methods (for example <code>Scan</code> and <code>Text</code> for a <code>bufio.Scanner</code>)</p>\n"}, {"comments": [{"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 2, "creation_date": 1457160031, "post_id": 35810932, "comment_id": 59290567, "body": "#2 is a lot like generators elsewhere. But yeah, not quite so easy to use. To avoid the leak without a buffered channel takes something like two channels, a <code>select</code>, a <code>defer close</code>, and a bit of care."}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "reply_to_user": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 2, "creation_date": 1457162863, "post_id": 35810932, "comment_id": 59291123, "body": "That, and a client willing to explicitly signal that they&#39;re done ranging."}, {"owner": {"reputation": 1923, "user_id": 298275, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/959931af6b71c9c3c9f1ed621ff09f61?s=128&d=identicon&r=PG", "display_name": "Koala3", "link": "https://stackoverflow.com/users/298275/koala3"}, "edited": false, "score": 2, "creation_date": 1457178634, "post_id": 35810932, "comment_id": 59295453, "body": "An outstanding answer joshif, thanks. I&#39;ll go with approach 3."}], "tags": [], "owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "is_accepted": false, "score": 56, "last_activity_date": 1457159414, "creation_date": 1457159414, "answer_id": 35810932, "question_id": 35810674, "link": "https://stackoverflow.com/questions/35810674/in-go-is-it-possible-to-iterate-over-a-custom-type/35810932#35810932", "title": "In Go is it possible to iterate over a custom type?", "body": "<p>The short answer is no.</p>\n\n<p>The long answer is still no, but it's possible to hack it in a way that it sort of works. But to be clear, this is most certainly a hack.</p>\n\n<p>There are a few ways you can do it, but the common theme between them is that you want to somehow transform your data into a type that Go is capable of ranging over.</p>\n\n<h2>Approach 1: Slices</h2>\n\n<p>Since you mentioned that you have a slice internally, this may be easiest for your use case. The idea is simple: your type should have an <code>Iterate()</code> method (or similar) whose return value is a slice of the appropriate type. When called, a new slice is created containing all of the elements of the data structure in whatever order you'd like them to be iterated over. So, for example:</p>\n\n<pre><code>func (m *MyType) Iterate() []MyElementType { ... }\n\nmm := NewMyType()\nfor i, v := range mm.Iterate() {\n    ...\n}\n</code></pre>\n\n<p>There are a few concerns here. First, allocation - unless you want to expose references to internal data (which, in general, you probably don't), you have to make a new slice and copy all of the elements over. From a big-O standpoint, this isn't that bad (you're doing a linear amount of work iterating over everything anyway), but for practical purposes, it may matter.</p>\n\n<p>Additionally, this doesn't handle iterating over mutating data. This is probably not an issue most of the time, but if you really want to support concurrent updates and certain types of iteration semantics, you might care.</p>\n\n<h2>Approach 2: Channels</h2>\n\n<p>Channels are also something that can be ranged over in Go. The idea is to have your <code>Iterate()</code> method spawn a goroutine that will iterate over the elements in your data structure, and write them to a channel. Then, when the iteration is done, the channel can be closed, which will cause the loop to finish. For example:</p>\n\n<pre><code>func (m *MyType) Iterate() &lt;-chan MyElementType {\n    c := make(chan MyElementType)\n    go func() {\n        for _, v := range m.elements {\n            c &lt;- v\n        }\n        close(c)\n    }()\n    return c\n}\n\nmm := NewMyType()\nfor v := range mm.Iterate() {\n    ...\n}\n</code></pre>\n\n<p>There are two advantages of this method over the slice method: first, you don't have to allocate a linear amount of memory (although you may want to make your channel have a bit of a buffer for performance reasons), and second, you can have your iterator play nicely with concurrent updates if you're into that sort of thing.</p>\n\n<p>The <em>big</em> downside of this approach is that, if you're not careful, you can leak goroutines. The only way around this is to make your channel have a buffer deep enough to hold all of the elements in your data structure so that the goroutine can fill it and then return even if no elements are read from the channel (and the channel can then later be garbage collected). The problem here is that, a) you're now back to linear allocation and, b) you have to know up-front how many elements you're going to write, which sort of puts a stop to the whole concurrent-updates thing.</p>\n\n<p>The moral of the story is that channels are cute for iterating, but you probably don't want to actually use them.</p>\n\n<h2>Approach 3: Internal Iterators</h2>\n\n<p>Credit to <a href=\"https://stackoverflow.com/users/152948/hobbs\">hobbs</a> for <a href=\"https://stackoverflow.com/questions/35810674/in-go-golang-is-it-possible-to-iterate-over-a-custom-type/35810778#35810778\">getting to this before me</a>, but I'll cover it here for completeness (and because I want to say a bit more about it).</p>\n\n<p>The idea here is to create an iterator object of sorts (or to just have your object only support one iterator at a time, and iterate on it directly), just like you would in languages that support this more directly. What you do, then, is call a <code>Next()</code> method which, a) advances the iterator to the next element and, b) returns a boolean indicating whether or not there's anything left. Then you need a separate <code>Get()</code> method to actually get the value of the current element. The usage of this doesn't actually use the <code>range</code> keyword, but it looks pretty natural nonetheless:</p>\n\n<pre><code>mm := MyNewType()\nfor mm.Next() {\n    v := mm.Get()\n    ...\n}\n</code></pre>\n\n<p>There are a few advantages of this technique over the previous two. First, it doesn't involve allocating memory up-front. Second, it supports errors very naturally. While it's not really an iterator, this is exactly what <a href=\"https://golang.org/pkg/bufio/#Scanner\"><code>bufio.Scanner</code></a> does. Basically the idea is to have an <code>Error()</code> method which you call after iteration is complete to see whether iteration terminated because it was done, or because an error was encountered midway through. For purely in-memory data structures this may not matter, but for ones that involve IO (e.g., walking a filesystem tree, iterating over database query results, etc), it's really nice. So, to complete the code snippet above:</p>\n\n<pre><code>mm := MyNewType()\nfor mm.Next() {\n    v := mm.Get()\n    ...\n}\nif err := mm.Error(); err != nil {\n    ...\n}\n</code></pre>\n\n<h2>Conclusion</h2>\n\n<p>Go doesn't support ranging over arbitrary data structures - or custom iterators - but you can hack it. If you have to do this in production code, the third approach is 100% the way to go, as it is both the cleanest and the least of a hack (after all, the standard library includes this pattern).</p>\n"}, {"tags": [], "owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "is_accepted": false, "score": 7, "last_activity_date": 1457180561, "creation_date": 1457180561, "answer_id": 35814051, "question_id": 35810674, "link": "https://stackoverflow.com/questions/35810674/in-go-is-it-possible-to-iterate-over-a-custom-type/35814051#35814051", "title": "In Go is it possible to iterate over a custom type?", "body": "<p>joshlf gave an excellent answer, but I'd like to add a couple of things:</p>\n\n<h2>Using channels</h2>\n\n<p>A typical problem with channel iterators is that you have to range through the entire data structure or the goroutine feeding the channel will be left hanging forever. But this can be quite easily circumvented, here's one way:</p>\n\n<pre><code>func (s intSlice) chanIter() chan int {\n    c := make(chan int)\n    go func() {\n        for _, i := range s {\n            select {\n            case c &lt;- i:\n            case &lt;-c:\n                close(c)\n                return\n            }\n        }\n        close(c)\n    }()\n    return c\n}\n</code></pre>\n\n<p>In this case <em>writing back</em> to the iterator channel interrupts the iteration early:</p>\n\n<pre><code>s := intSlice{1, 2, 3, 4, 5, 11, 22, 33, 44, 55}\nc := s.chanIter()\nfor i := range c {\n    fmt.Println(i)\n    if i &gt; 30 {\n        // Send to c to interrupt\n        c &lt;- 0\n    }\n}\n</code></pre>\n\n<p>Here it is very important that you don't simply <code>break</code> out of the for loop. You <em>can</em> break, but you must <em>must</em> write to the channel first to ensure the goroutine will exit.</p>\n\n<h2>Using closures</h2>\n\n<p>A method of iteration I often tend to favour is to use an iterator closure. In this case the iterator is a function value, which, when called repeatedly, returns the next element and indicates whether the iteration can continue:</p>\n\n<pre><code>func (s intSlice) cloIter() func() (int, bool) {\n    i := -1\n    return func() (int, bool) {\n        i++\n        if i == len(s) {\n            return 0, false\n        }\n        return s[i], true\n    }\n}\n</code></pre>\n\n<p>Use it like this:</p>\n\n<pre><code>iter := s.cloIter()\nfor i, ok := iter(); ok; i, ok = iter() {\n    fmt.Println(i)\n}\n</code></pre>\n\n<p>In this case it's perfectly ok to break out of the loop early, <code>iter</code> will eventually be garbage collected.</p>\n\n<h2>Playground</h2>\n\n<p>Here's the link to the implementations above: <a href=\"http://play.golang.org/p/JC2EpBDQKA\" rel=\"noreferrer\">http://play.golang.org/p/JC2EpBDQKA</a></p>\n"}, {"tags": [], "owner": {"reputation": 426, "user_id": 1182721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20f3f1dc553f33f198493f9061a0ac97?s=128&d=identicon&r=PG", "display_name": "Lu.nemec", "link": "https://stackoverflow.com/users/1182721/lu-nemec"}, "is_accepted": false, "score": 2, "last_activity_date": 1557136670, "creation_date": 1557136670, "answer_id": 56002845, "question_id": 35810674, "link": "https://stackoverflow.com/questions/35810674/in-go-is-it-possible-to-iterate-over-a-custom-type/56002845#56002845", "title": "In Go is it possible to iterate over a custom type?", "body": "<p>There is another option that wasn't mentioned.</p>\n\n<p>You can define a <strong>Iter(fn func(int))</strong> function which accepts some function that will be called for each item in your custom type.</p>\n\n<pre><code>type MyType struct {\n    data []int\n}\n\nfunc (m *MyType) Iter(fn func(int)) {\n    for _, item := range m.data {\n        fn(item)\n    }\n}\n</code></pre>\n\n<p>And it can be used like this:</p>\n\n<pre><code>d := MyType{\n    data: []int{1,2,3,4,5},\n}\n\nf := func(i int) {\n    fmt.Println(i)\n}\nd.Iter(f)\n</code></pre>\n\n<p><strong>Playground</strong><br>\nLink to working implementation: <a href=\"https://play.golang.org/p/S3CTQmGXj79\" rel=\"nofollow noreferrer\">https://play.golang.org/p/S3CTQmGXj79</a></p>\n"}], "owner": {"reputation": 1923, "user_id": 298275, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/959931af6b71c9c3c9f1ed621ff09f61?s=128&d=identicon&r=PG", "display_name": "Koala3", "link": "https://stackoverflow.com/users/298275/koala3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17388, "favorite_count": 13, "answer_count": 4, "score": 43, "last_activity_date": 1557136670, "creation_date": 1457157455, "last_edit_date": 1491170422, "question_id": 35810674, "link": "https://stackoverflow.com/questions/35810674/in-go-is-it-possible-to-iterate-over-a-custom-type", "title": "In Go is it possible to iterate over a custom type?", "body": "<p>I have a custom type which internally has a slice of data.</p>\n\n<p>Is it possible, by implementing some functions or an interface that the range operator needs, to iterate (using range) over my custom type?</p>\n"}, {"tags": ["go", "command-line-arguments"], "answers": [{"comments": [{"owner": {"reputation": 1506, "user_id": 713486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2a3b1ea7651ccc1259578b0f2853f4?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/713486/brian"}, "edited": false, "score": 0, "creation_date": 1457209643, "post_id": 35809327, "comment_id": 59306345, "body": "Plus, if <code>computedHostFlag()</code> is idempotent, this has the added benefit of making the usage (<code>.&#47;foo -h</code>) display an accurate default value."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1506, "user_id": 713486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2a3b1ea7651ccc1259578b0f2853f4?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/713486/brian"}, "edited": false, "score": 0, "creation_date": 1457210893, "post_id": 35809327, "comment_id": 59306814, "body": "The answer notes that the help shows the default. The function need not be idempotent as it&#39;s only called once."}, {"owner": {"reputation": 1506, "user_id": 713486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2a3b1ea7651ccc1259578b0f2853f4?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/713486/brian"}, "edited": false, "score": 0, "creation_date": 1457210934, "post_id": 35809327, "comment_id": 59306827, "body": "Whoops, completely missed that it was already included. Sorry! If it&#39;s not idempotent though, what you see with the Usage may differ than what the value is when it is subsequently run."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1506, "user_id": 713486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2a3b1ea7651ccc1259578b0f2853f4?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/713486/brian"}, "edited": false, "score": 0, "creation_date": 1457211213, "post_id": 35809327, "comment_id": 59306936, "body": "Oh, you are right. It need to return same value each time program is executed."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 3, "last_activity_date": 1457148721, "last_edit_date": 1457148721, "creation_date": 1457145523, "answer_id": 35809327, "question_id": 35809252, "link": "https://stackoverflow.com/questions/35809252/check-if-flag-was-provided-in-go/35809327#35809327", "title": "Check if Flag Was Provided in Go", "body": "<p>To use a dynamic default value for a flag, create the flag with the default set to the dynamic value:</p>\n\n<pre><code>func main() {\n  flagHost = flag.String(flagHostFlagKey, computedHostFlag(), \"...\")\n  flag.Parse()\n  // *flagHost equals the return value from computedHostFlag() if \n  // the flag is not specified on the command line.\n  ...\n}\n</code></pre>\n\n<p>With this approach, it's not necessary to detect if the flag is specified on the command line. Also, help shows the correct default.</p>\n\n<p>If the computed value depends on other flags or is expensive to calculate, then use the approach suggested in one of the other answers.</p>\n"}, {"comments": [{"owner": {"reputation": 1770, "user_id": 1054397, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f8218beaae675c36460465d04d068e69?s=128&d=identicon&r=PG", "display_name": "ardnew", "link": "https://stackoverflow.com/users/1054397/ardnew"}, "edited": false, "score": 1, "creation_date": 1540606827, "post_id": 35809400, "comment_id": 92939429, "body": "a word of warning before you go refactoring your code to implement this: if you wrap any <code>bool</code> flags in a <code>flag.Value</code> implementation, you won&#39;t be able to set them at invocation without argument. in other words, where you used to be able to set <code>bool</code> flags by simply using <code>prog -boolflag progargs</code>, you&#39;ll have to instead use <code>prog -boolflag true progargs</code>. otherwise, <code>progargs</code> gets swallowed up as the argument to <code>-boolflag</code> and won&#39;t be available later in <code>Args()</code>."}, {"owner": {"reputation": 1770, "user_id": 1054397, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f8218beaae675c36460465d04d068e69?s=128&d=identicon&r=PG", "display_name": "ardnew", "link": "https://stackoverflow.com/users/1054397/ardnew"}, "edited": false, "score": 3, "creation_date": 1580171762, "post_id": 35809400, "comment_id": 106002662, "body": "I was so ready to counter the above comment and criticize their carelessness, and then I realized it was <i>my</i> comment from over a year ago... anyway, it is not correct (anymore?). From the go docs, in your <code>flag.Value</code> implementation: <code>If a Value has an IsBoolFlag() bool method returning true, the command-line parser makes -name equivalent to -name=true rather than using the next command-line argument.</code>"}], "tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": false, "score": 28, "last_activity_date": 1457146255, "creation_date": 1457146255, "answer_id": 35809400, "question_id": 35809252, "link": "https://stackoverflow.com/questions/35809252/check-if-flag-was-provided-in-go/35809400#35809400", "title": "Check if Flag Was Provided in Go", "body": "<p>The built-in flag types don't support distinguishing default values and explicit assignment to the default value. However, the <code>flag</code> package is quite flexible, and allows you to roll your own type that does, using the <code>flag.Value</code> interface.</p>\n\n<p>Here's a full example that contains a string flag which records if it's been assigned to.</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n)\n\ntype stringFlag struct {\n    set   bool\n    value string\n}\n\nfunc (sf *stringFlag) Set(x string) error {\n    sf.value = x\n    sf.set = true\n    return nil\n}\n\nfunc (sf *stringFlag) String() string {\n    return sf.value\n}\n\nvar filename stringFlag\n\nfunc init() {\n    flag.Var(&amp;filename, \"filename\", \"the filename\")\n}\n\nfunc main() {\n    flag.Parse()\n    if !filename.set {\n        fmt.Println(\"--filename not set\")\n    } else {\n        fmt.Printf(\"--filename set to %q\\n\", filename.value)\n    }\n}\n</code></pre>\n\n<p>Here's some example runs:</p>\n\n<pre><code>$ go run a.go -filename=abc\n--filename set to \"abc\"\n\n$ go run a.go -filename=\n--filename set to \"\"\n\n$ go run a.go\n--filename not set\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 183, "user_id": 7011381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ef24234c19a94d8345b81829294364d?s=128&d=identicon&r=PG&f=1", "display_name": "Ben L", "link": "https://stackoverflow.com/users/7011381/ben-l"}, "is_accepted": false, "score": 17, "last_activity_date": 1476333628, "creation_date": 1476333628, "answer_id": 40012425, "question_id": 35809252, "link": "https://stackoverflow.com/questions/35809252/check-if-flag-was-provided-in-go/40012425#40012425", "title": "Check if Flag Was Provided in Go", "body": "<p>The issue with using a custom flag type (the stringFlag example in this thread) is you'll slightly upset the PrintDefaults output (i.e. --help). For example, with a string username  flag and a stringFlag servername flag, --help looks like this:</p>\n\n<pre><code>-server value\n    server:port (default localhost:1234)\n-username string\n    username (default \"kimmi\")\n</code></pre>\n\n<p>Note these are both string arguments as far as the user is concerned, but presented differently as a stringFlag is not a string.</p>\n\n<p><a href=\"https://golang.org/pkg/flag\" rel=\"noreferrer\">flag</a>'s Flagset has an internal map that includes the flags that were declared ('formal') and those actually set ('actual'). The former is available via Lookup(), though alas the latter is not exposed, or you could just write:</p>\n\n<pre><code>var servername = flag.String(\"server\", \"localhost:8129\", \"server:port\")\n\nflag.Parse()\n\nif f := flag.CommandLine.LookupActual(\"server\"); f != nil {\n    fmt.Printf(\"server set to %#v\\n\", f)\n} else {\n    fmt.Printf(\"server not set\\n\")\n}\n</code></pre>\n\n<p>Seems like the best you can do, if you want consistent PrintDefaults() output, is to use Visit to extract your own view of 'actual' (VisitAll does the same thing with 'formal'):</p>\n\n<pre><code>var servername = flag.String(\"server\", \"localhost:8129\", \"server:port\")\n\nflag.Parse()\n\nflagset := make(map[string]bool)\nflag.Visit(func(f *flag.Flag) { flagset[f.Name]=true } )\n\nif flagset[\"server\"] {\n    fmt.Printf(\"server set via flags\\n\")\n} else {\n    fmt.Printf(\"server not explicitly set, using default\\n\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 4143494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80bbe7c83ff0ec2d3fb82905e8067ebb?s=128&d=identicon&r=PG", "display_name": "ewgra", "link": "https://stackoverflow.com/users/4143494/ewgra"}, "is_accepted": false, "score": 1, "last_activity_date": 1534546846, "last_edit_date": 1534546846, "creation_date": 1534545552, "answer_id": 51903637, "question_id": 35809252, "link": "https://stackoverflow.com/questions/35809252/check-if-flag-was-provided-in-go/51903637#51903637", "title": "Check if Flag Was Provided in Go", "body": "<p>Face with same problem, but have even complex case with bool flag, in this case computedHostFlag() not working, since you can provide to flag creation only true or false. \"type stringFlag struct\" solution also not the best, since ruin idea of default values.</p>\n\n<p>Solve it in this way: create two sets of flags, with different default values, after parse - just check - if flag in first flagset have the same value that flag from second flagset - that it means that flag value was provided by user from command line. If they different - than this mean that flag was set by default.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"flag\"\n)\n\nfunc main() {\n    args := []string{\"-foo=\"}\n\n    flagSet1 := flag.NewFlagSet(\"flagSet1\", flag.ContinueOnError)\n    foo1 := flagSet1.String(\"foo\", \"-\", ``)\n    boolFoo1 := flagSet1.Bool(\"boolfoo\", false, ``)\n    flagSet1.Parse(args)\n\n    flagSet2 := flag.NewFlagSet(\"flagSet2\", flag.ContinueOnError)\n    foo2 := flagSet2.String(\"foo\", \"+\", ``)\n    boolFoo2 := flagSet2.Bool(\"boolfoo\", true, ``)\n    flagSet2.Parse(args)\n\n    if *foo1 != *foo2 {\n        fmt.Println(\"foo flag set by default\")\n    } else {\n        fmt.Println(\"foo flag provided by user\")\n    }\n\n    if *boolFoo1 != *boolFoo2 {\n        fmt.Println(\"boolfoo flag set by default\")\n    } else {\n        fmt.Println(\"boolfoo flag provided by user\")\n    }\n}\n</code></pre>\n\n<p>playground: <a href=\"https://play.golang.org/p/BVceE_pN5PO\" rel=\"nofollow noreferrer\">https://play.golang.org/p/BVceE_pN5PO</a> , for real CLI execution, you can do something like that: <a href=\"https://play.golang.org/p/WNvDaaPj585\" rel=\"nofollow noreferrer\">https://play.golang.org/p/WNvDaaPj585</a></p>\n"}, {"comments": [{"owner": {"reputation": 729, "user_id": 3566193, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/oUSeE.jpg?s=128&g=1", "display_name": "ec-m", "link": "https://stackoverflow.com/users/3566193/ec-m"}, "edited": false, "score": 1, "creation_date": 1598007718, "post_id": 54747682, "comment_id": 112324628, "body": "Note that this needs to be called after <code>flag.Parse</code>."}], "tags": [], "owner": {"reputation": 416, "user_id": 10978933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A1hVPi6GZRg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOL66QCKH25BfkF12OHr4nFEfRk2w/mo/photo.jpg?sz=128", "display_name": "Markus Heukelom", "link": "https://stackoverflow.com/users/10978933/markus-heukelom"}, "is_accepted": true, "score": 30, "last_activity_date": 1550494086, "creation_date": 1550494086, "answer_id": 54747682, "question_id": 35809252, "link": "https://stackoverflow.com/questions/35809252/check-if-flag-was-provided-in-go/54747682#54747682", "title": "Check if Flag Was Provided in Go", "body": "<p>Use the <code>flag.Visit()</code> function:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func isFlagPassed(name string) bool {\n    found := false\n    flag.Visit(func(f *flag.Flag) {\n        if f.Name == name {\n            found = true\n        }\n    })\n    return found\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6678650, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--1ty1oLL-vQ/AAAAAAAAAAI/AAAAAAAAB-8/6xnVtWXWE1k/photo.jpg?sz=128", "display_name": "zhayu", "link": "https://stackoverflow.com/users/6678650/zhayu"}, "is_accepted": false, "score": 0, "last_activity_date": 1551340112, "last_edit_date": 1551340112, "creation_date": 1551339615, "answer_id": 54920659, "question_id": 35809252, "link": "https://stackoverflow.com/questions/35809252/check-if-flag-was-provided-in-go/54920659#54920659", "title": "Check if Flag Was Provided in Go", "body": "<p>I think a more reliable way is to check whether any flag in the command-line parameters (os.Args[1:]) is prefixed by \"prefix\" + str, so the function:</p>\n\n<pre><code>func isInSlice(str string, list []string, prefix string) bool {\n    for _, v := range list {\n        if strings.HasPrefix(v, prefix + str) {\n            return true\n        }\n    }\n    return false\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18792, "user_id": 385548, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e8f290affc1d939cf9a4ad2c9e79592a?s=128&d=identicon&r=PG", "display_name": "Vojtech Vitek", "link": "https://stackoverflow.com/users/385548/vojtech-vitek"}, "edited": false, "score": 1, "creation_date": 1572607290, "post_id": 58076486, "comment_id": 103619696, "body": "<code>flag.Lookup()</code> returns the Flag structure of the named flag. It doesn&#39;t tell you if the flag was actually provided in the CLI or not."}], "tags": [], "owner": {"reputation": 2443, "user_id": 2220805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55VFm.jpg?s=128&g=1", "display_name": "taynguyen", "link": "https://stackoverflow.com/users/2220805/taynguyen"}, "is_accepted": false, "score": -1, "last_activity_date": 1569315112, "creation_date": 1569315112, "answer_id": 58076486, "question_id": 35809252, "link": "https://stackoverflow.com/questions/35809252/check-if-flag-was-provided-in-go/58076486#58076486", "title": "Check if Flag Was Provided in Go", "body": "<p>I found that we have the Lookup() method:</p>\n\n<pre><code>func isFlagPassed(name string) bool {\n  rs := flag.Lookup(name)\n  return rs != nil \n}\n</code></pre>\n\n<p>Full <a href=\"https://golang.org/pkg/flag/#Lookup\" rel=\"nofollow noreferrer\">docs</a></p>\n"}, {"comments": [{"owner": {"reputation": 313, "user_id": 3567989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ce071dd3264c7d9f5d9c0b7137faa6b?s=128&d=identicon&r=PG", "display_name": "emersion", "link": "https://stackoverflow.com/users/3567989/emersion"}, "edited": false, "score": 0, "creation_date": 1589210366, "post_id": 59390538, "comment_id": 109195724, "body": "This is accessing unexported fields. Go doesn&#39;t guarantee stability for private APIs. Programs shouldn&#39;t do this, this can break at any Go release."}], "tags": [], "owner": {"reputation": 19, "user_id": 5127058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OfOGl.jpg?s=128&g=1", "display_name": "Chenling Zhang", "link": "https://stackoverflow.com/users/5127058/chenling-zhang"}, "is_accepted": false, "score": -1, "last_activity_date": 1576667014, "last_edit_date": 1576667014, "creation_date": 1576666643, "answer_id": 59390538, "question_id": 35809252, "link": "https://stackoverflow.com/questions/35809252/check-if-flag-was-provided-in-go/59390538#59390538", "title": "Check if Flag Was Provided in Go", "body": "<p>The <a href=\"https://golang.org/pkg/flag/#FlagSet\" rel=\"nofollow noreferrer\">FlagSet</a> does not have a function <em>LookupActual()</em> in my environment (go version go1.13.4 windows/amd64), and the internal map <em>actual</em> mentioned in <a href=\"https://stackoverflow.com/a/40012425/5127058\">Ben L's answer</a> can not be accessed directly.</p>\n\n<p>I have an approach to check if a flag is set using <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">reflect</a>:</p>\n\n<pre><code>import \"reflect\"\n\nfs := flag.NewFlagSet(\"the flags\", flag.ExitOnError)\nflag_name := \"host\"\nhost := fs.String(flag_name, \"localhost\", \"specify the host address\")\n// other flags\nfs.Parse(os.Args[1:])\n\nif reflect.Indirect(reflect.ValueOf(fs)).FieldByName(\"actual\").MapIndex(reflect.ValueOf(flag_name)).IsValid() {\n     fmt.Printf(\"the host flag is set with value %v\", *host)\n} else {\n     fmt.Printf(\"the host flag is not set\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 313, "user_id": 3567989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ce071dd3264c7d9f5d9c0b7137faa6b?s=128&d=identicon&r=PG", "display_name": "emersion", "link": "https://stackoverflow.com/users/3567989/emersion"}, "is_accepted": false, "score": 0, "last_activity_date": 1589211300, "creation_date": 1589211300, "answer_id": 61733526, "question_id": 35809252, "link": "https://stackoverflow.com/questions/35809252/check-if-flag-was-provided-in-go/61733526#61733526", "title": "Check if Flag Was Provided in Go", "body": "<p>Same as <a href=\"https://stackoverflow.com/a/35809400/3567989\">https://stackoverflow.com/a/35809400/3567989</a> but with a pointer to a string instead of a custom struct. The <code>*string</code> is nil if unset, non-nil if set.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n)\n\ntype stringPtrFlag struct {\n    ptr **string\n}\n\nfunc (f stringPtrFlag) String() string {\n    if *f.ptr == nil {\n        return \"\"\n    }\n    return **f.ptr\n}\n\nfunc (f stringPtrFlag) Set(s string) error {\n    *f.ptr = &amp;s\n    return nil\n}\n\nvar filename *string\n\nfunc init() {\n    flag.Var(stringPtrFlag{&amp;filename}, \"filename\", \"the filename\")\n}\n\nfunc main() {\n    flag.Parse()\n    if filename == nil {\n        fmt.Println(\"--filename not set\")\n    } else {\n        fmt.Printf(\"--filename set to %q\\n\", *filename)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 23028, "user_id": 107156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mSIVv.jpg?s=128&g=1", "display_name": "Kyle Brandt", "link": "https://stackoverflow.com/users/107156/kyle-brandt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22671, "favorite_count": 9, "accepted_answer_id": 54747682, "answer_count": 9, "score": 31, "last_activity_date": 1589211300, "creation_date": 1457144721, "last_edit_date": 1457145425, "question_id": 35809252, "link": "https://stackoverflow.com/questions/35809252/check-if-flag-was-provided-in-go", "title": "Check if Flag Was Provided in Go", "body": "<p>With the flag package, is there a good way to distinguish if a string flag was passed?</p>\n\n<p>For example, when the flag is not passed, I want to set it to a dynamic default value.  However, I want to set it to empty if the flag was provided but with a value of <code>\"\"</code>.</p>\n\n<p>Current I am doing the following:</p>\n\n<pre><code>flagHost = flag.String(flagHostFlagKey, \"\", \"...\")\n...\nsetHostname := false\nfor _, arg := range os.Args {\n    if arg == \"-\"+flagHostFlagKey {\n        setHostname = true\n    }\n}\n\nif !setHostname {\n     ...\n</code></pre>\n\n<p>Which seems to work fine, but is kind of ugly. Is there a better way while staying with the standard flag package?</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 5, "creation_date": 1457124832, "post_id": 35805694, "comment_id": 59281061, "body": "If <code>GOMAXPROCS=1</code>, <code>for{}</code> freezes your program without ever letting it switch goroutines. <code>select{}</code> doesn&#39;t do that and doesn&#39;t eat CPU."}, {"owner": {"reputation": 1624, "user_id": 1816149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1ef0c1c5f57ec8705986fc3a646ac08?s=128&d=identicon&r=PG", "display_name": "Flopp", "link": "https://stackoverflow.com/users/1816149/flopp"}, "edited": false, "score": 0, "creation_date": 1457125060, "post_id": 35805694, "comment_id": 59281154, "body": "You could use a <code>WaitGroup</code> instead of the <code>for {}</code> loop - see <a href=\"http://nathanleclaire.com/blog/2014/02/15/how-to-wait-for-all-goroutines-to-finish-executing-before-continuing/\" rel=\"nofollow noreferrer\">nathanleclaire.com/blog/2014/02/15/&hellip;</a>"}, {"owner": {"reputation": 405, "user_id": 5460606, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/59d5893c1f82773c41ec9949450b7592?s=128&d=identicon&r=PG&f=1", "display_name": "RandomGuyqwert", "link": "https://stackoverflow.com/users/5460606/randomguyqwert"}, "edited": false, "score": 0, "creation_date": 1457125074, "post_id": 35805694, "comment_id": 59281165, "body": "Yes, I think you are right. Right before seeing your comment, I changed the for {} with time.Sleep() and it worked. I will change GOMAXPROCS now and see what that does."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1457125086, "post_id": 35805694, "comment_id": 59281175, "body": "Actually, even when GOMAXPROCS&gt;1 <code>for{}</code> will eventually block the scheduler altogether when the GC tries to stop the world. Never use a busy loop."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1457125633, "post_id": 35805694, "comment_id": 59281461, "body": "Checkout this answer <a href=\"http://stackoverflow.com/a/34885000/2363866\">stackoverflow.com/a/34885000/2363866</a> And maybe google about go scheduler, there&#39;re some great blog posts and golang team design documents. It&#39;s actually not as simple as <code>busy loop  freezes your program</code>. It can freeze in some case, in other cases it will work even with GOMAXPROCS=1 and without blocking operations."}], "answers": [{"comments": [{"owner": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "reply_to_user": {"reputation": 405, "user_id": 5460606, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/59d5893c1f82773c41ec9949450b7592?s=128&d=identicon&r=PG&f=1", "display_name": "RandomGuyqwert", "link": "https://stackoverflow.com/users/5460606/randomguyqwert"}, "edited": false, "score": 0, "creation_date": 1457125410, "post_id": 35805907, "comment_id": 59281346, "body": "@RandomGuyqwert - please accept this answer so that others may see the working solution"}], "tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 6, "last_activity_date": 1457125422, "last_edit_date": 1457125422, "creation_date": 1457125102, "answer_id": 35805907, "question_id": 35805694, "link": "https://stackoverflow.com/questions/35805694/why-arent-my-goroutines-launched/35805907#35805907", "title": "Why aren&#39;t my goroutines launched?", "body": "<p>If your program is running with <code>GOMAXPROCS=1</code> (that is, a single OS thread), <code>for{}</code> freezes it without ever letting Go's user-mode scheduler run. <a href=\"https://github.com/golang/go/issues/543\" rel=\"nofollow\">This is the issue about it</a>. JimB points out it causes other problems regardless of <code>GOMAXPROCS</code>; eventually the runtime has to stop your goroutine for garbage collection, and it can't stop <code>for{}</code>.</p>\n\n<p>Changing <code>for{}</code> to <code>select{}</code> lets the scheduler run and doesn't eat CPU. <a href=\"http://play.golang.org/p/c5qaYLHHH6\" rel=\"nofollow\">In this reduced program, your goroutine code runs</a>. It ends with \"all goroutines are asleep - deadlock!\" because your other goroutine quits and the only remaining one (main) is hung in the <code>select{}</code>.</p>\n\n<pre><code>package main\n\nimport \"log\"\n\nconst BASE_FILE_NAME = \"abc_\"\n\nfunc mygoroutine(file_name string) {\n    log.Println(\"In goroutine for file\", file_name)\n}\n\nfunc main() {\n    go mygoroutine(\"foo\")\n    log.Println(\"Finished launching.\")\n    select {}\n    log.Println(\"Now exiting\")\n}\n</code></pre>\n\n<p>Of course, you normally don't want to hang a goroutine even with <code>select{}</code>; that's going to leave some resources in use until your program ends. To build something useful you'll need something else like a <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow\"><code>sync.WaitGroup</code></a> or channel.</p>\n"}], "owner": {"reputation": 405, "user_id": 5460606, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/59d5893c1f82773c41ec9949450b7592?s=128&d=identicon&r=PG&f=1", "display_name": "RandomGuyqwert", "link": "https://stackoverflow.com/users/5460606/randomguyqwert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 35805907, "answer_count": 1, "score": 1, "last_activity_date": 1457125668, "creation_date": 1457124293, "last_edit_date": 1457125668, "question_id": 35805694, "link": "https://stackoverflow.com/questions/35805694/why-arent-my-goroutines-launched", "title": "Why aren&#39;t my goroutines launched?", "body": "<p>No, it's not because my program ends too fast.</p>\n\n<p>I have this script:</p>\n\n<pre><code>package main\n\nimport (\"log\"; \"io/ioutil\"; \"strings\")\n\nconst BASE_FILE_NAME = \"abc_\"\n\nfunc mygoroutine(file_name string) {\n    log.Println(\"In goroutine for file\", file_name)\n}\n\n\nfunc get_file_names() []string {\n  file_names := make([]string, 0)\n  files, _ := ioutil.ReadDir(\"./\")\n  for _, file := range files {\n      if strings.HasPrefix(file.Name(), BASE_FILE_NAME) {\n        file_names = append(file_names, file.Name())\n      }\n  }\n\n  return file_names\n}\n\nfunc main()  {\n    file_names := get_file_names()\n    for _, file_name := range file_names {\n        log.Println(\"Now lunching goroutine for file\", file_name)\n        go mygoroutine(file_name)\n    }\n\n    log.Println(\"Finished launching.\")\n\n    for {}\n\n    log.Println(\"Now exiting\")\n}\n</code></pre>\n\n<p>In the directory that contains the executable, I have two files that start with <code>abc_</code> so the output is this:</p>\n\n<pre><code>2016/03/04 20:35:14 Now lunching goroutine for file abc_fr\n2016/03/04 20:35:14 Now lunching goroutine for file abc_hrty\n2016/03/04 20:35:14 Finished launching.\n</code></pre>\n\n<p>The script doesn't stop, it never logs <code>Now exiting</code> , because it loops in the empty for. But I do not see the <code>In goroutine for file</code> message.</p>\n\n<p>Why is this happening? What am I doing wrong?</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["oop", "object", "methods", "go"], "answers": [{"comments": [{"owner": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "edited": false, "score": 0, "creation_date": 1457122518, "post_id": 35805090, "comment_id": 59279918, "body": "Thank you. But, how to do that with Remember() method? I am getting a nil pointer error."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "edited": false, "score": 0, "creation_date": 1457122807, "post_id": 35805090, "comment_id": 59280076, "body": "@Gon: You can call <code>Remember</code> exactly the same way as I call <code>Yell</code> here. If the pointer is nil, you haven&#39;t assigned a pointer to the parent."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1457122932, "last_edit_date": 1457122932, "creation_date": 1457121780, "answer_id": 35805090, "question_id": 35804991, "link": "https://stackoverflow.com/questions/35804991/golang-calling-parents-method/35805090#35805090", "title": "Golang, calling parents&#39; method", "body": "<p>You can add a pointer to the parent in the child struct</p>\n\n<pre><code>type child struct {\n    Name string\n    parent *parent\n}\n\nfunc (p *child) Yell() {\n    fmt.Println(\"Child's yelling\")\n    p.parent.Remember(p.Name + \" called\")\n    p.parent.Yell()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 855, "user_id": 1323552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d8c998581e1504213b9a0fab4a846df?s=128&d=identicon&r=PG", "display_name": "Johnny Wong", "link": "https://stackoverflow.com/users/1323552/johnny-wong"}, "is_accepted": false, "score": 1, "last_activity_date": 1507285712, "last_edit_date": 1507285712, "creation_date": 1507285356, "answer_id": 46603580, "question_id": 35804991, "link": "https://stackoverflow.com/questions/35804991/golang-calling-parents-method/46603580#46603580", "title": "Golang, calling parents&#39; method", "body": "<p>I am just a starter of Golang.</p>\n\n<p>Seems Golang convention is CamelCase for class name, and when inherit a base class (\"Parent\") shouldn't assign a variable name.  <code>p.Parent</code> will automatically work, i.e. as follows:</p>\n\n<pre><code>type Child struct {\n    *Parent   // put at top\n    Name string\n}\n\nfunc (p *Child) Yell() {\n    fmt.Println(\"Child's yelling\")\n    p.Parent.Remember(p.Name + \" called\")\n    p.Parent.Yell()\n}\n</code></pre>\n\n<p>Reference:</p>\n\n<ol>\n<li><a href=\"http://arch-stable.blogspot.hk/2012/05/golang-call-inherited-constructor.html\" rel=\"nofollow noreferrer\">http://arch-stable.blogspot.hk/2012/05/golang-call-inherited-constructor.html</a></li>\n<li><a href=\"https://medium.com/@simplyianm/why-gos-structs-are-superior-to-class-based-inheritance-b661ba897c67\" rel=\"nofollow noreferrer\">https://medium.com/@simplyianm/why-gos-structs-are-superior-to-class-based-inheritance-b661ba897c67</a></li>\n</ol>\n\n<p>Some other example inherit with non-pointer Parent like:</p>\n\n<pre><code>type Child struct {\n    Parent   // put at top\n    Name string\n}\n</code></pre>\n\n<p>Not sure which one is more official and handy yet</p>\n"}], "owner": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4193, "favorite_count": 0, "accepted_answer_id": 35805090, "answer_count": 2, "score": 1, "last_activity_date": 1507285712, "creation_date": 1457121415, "last_edit_date": 1457123055, "question_id": 35804991, "link": "https://stackoverflow.com/questions/35804991/golang-calling-parents-method", "title": "Golang, calling parents&#39; method", "body": "<p>From the example below, is there anyway that Child object can call Parent's method? For instance, I want Child (boy1 and girl1) to call parent's \"Remember\" method; so parents can remember what Child want them to remember. </p>\n\n<p>Thank you so much</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype child struct {\n    Name string \n}\n\nfunc (p *child) Yell() {\n    fmt.Println(\"Child's yelling\")\n}\n\ntype parent struct {\n    Name string \n    Children []child\n    Memory []string\n}\n\nfunc (p *parent) Yell() {\n    fmt.Println(\"Parent's yelling\")\n}\n\nfunc (p *parent) Remember(line string) {\n    p.Memory = append(p.Memory, line)\n}\n\nfunc main() {\n    p := parent{}\n    p.Name = \"Jon\"\n    boy1 := child{}\n    boy1.Name = \"Jon's boy\"\n    girl1 := child{}\n    girl1.Name = \"Jon's girl\"\n    p.Children = append(p.Children, boy1)\n    p.Children = append(p.Children, girl1)\n    fmt.Println(p)\n\n    p.Yell()\n    for i:=0;i&lt;len(p.Children);i++ {\n        p.Children[i].Yell()\n    }\n}\n</code></pre>\n\n<p>Thanks to @Jim, here's the solution. The pointer is always confusing.</p>\n\n<p>package main</p>\n\n<pre><code>import \"fmt\"\n\ntype child struct {\n    Name string\n    prnt *parent\n}\n\nfunc (p *child) Yell() {\n    fmt.Println(\"Child's yelling\")\n}\n\ntype parent struct {\n    Name     string\n    Children []child\n    Memory   []string\n}\n\nfunc (p *parent) Yell() {\n    fmt.Println(\"Parent's yelling\")\n}\n\nfunc (p *parent) Remember(line string) {\n    p.Memory = append(p.Memory, line)\n}\n\nfunc main() {\n    p := parent{}\n    p.Name = \"Jon\"\n    boy1 := child{}\n    boy1.Name = \"Jon's boy\"\n    boy1.prnt = &amp;p\n    girl1 := child{}\n    girl1.Name = \"Jon's girl\"\n    girl1.prnt = &amp;p\n\n    p.Children = append(p.Children, boy1)\n    p.Children = append(p.Children, girl1)\n    fmt.Println(p)\n\n    p.Yell()\n    for i := 0; i &lt; len(p.Children); i++ {\n        p.Children[i].Yell()\n        p.Children[i].prnt.Remember(\"test:\" + p.Children[i].Name)\n    }\n\n    fmt.Println(p.Memory)\n}\n</code></pre>\n"}, {"tags": ["go", "sqlite"], "answers": [{"comments": [{"owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "edited": false, "score": 1, "creation_date": 1457130205, "post_id": 35805826, "comment_id": 59283693, "body": "Thanks a lot! With WAL the performance improved to 3.06 seconds; with connection pool closed the performance further improved to 2.65 seconds :)"}], "tags": [], "owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "is_accepted": true, "score": 27, "last_activity_date": 1457124772, "creation_date": 1457124772, "answer_id": 35805826, "question_id": 35804884, "link": "https://stackoverflow.com/questions/35804884/sqlite-concurrent-writing-performance/35805826#35805826", "title": "Sqlite concurrent writing performance", "body": "<p>I recently evaluated SQLite3 performance in Go myself for a network application and learned that it needs a bit of setup before it even remotely usable.</p>\n\n<h2>Turn on the Write-Ahead Logging</h2>\n\n<p>You need to use WAL <code>PRAGMA journal_mode=WAL</code>. That's mainly why you get such a bad performance. With WAL I can do 10000 concurent writes without transactions in a matter of seconds. Within transaction it will be lightning fast.</p>\n\n<h2>Disable connections pool</h2>\n\n<p>I use <code>mattn/go-sqlite3</code> and it opens a database with <code>SQLITE_OPEN_FULLMUTEX</code> flag. It means that every SQLite call will be guarded with a lock. Everything will be serialized. And that's actually what you want with SQLite. The problem with Go in this situation is that you will get random errors that tell you that the database is locked. And the reason why is because of the way the <code>sql/DB</code> works inside. Inside it manages pool of connections for you, so it will open multiple SQLite connections and you don't want to do that. To solve this I had to, basically, disable the pool. Call <code>db.SetMaxOpenConns(1)</code> and it will work. Even on very high loads with tens of thousands of concurent reads and writes it works without a problem.</p>\n\n<p>Other solution might be to use <code>SQLITE_OPEN_NOMUTEX</code> to run SQLite in multi-threaded mode and let it manage that for you. But SQLite doesn't really work in multi-threaded apps. Reads can happen in parallel but only one write at a time. You will get occasional <code>busy</code> errors which are completely normal for SQLite but will require you to do something with them - you probably don't want to stop a write operation completely when that happens. That's why most of the time people work with SQLite either synchronously or by sending calls to a separate thread just for the SQLite.</p>\n"}], "owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4432, "favorite_count": 5, "accepted_answer_id": 35805826, "answer_count": 1, "score": 10, "last_activity_date": 1458236035, "creation_date": 1457121049, "last_edit_date": 1458236035, "question_id": 35804884, "link": "https://stackoverflow.com/questions/35804884/sqlite-concurrent-writing-performance", "title": "Sqlite concurrent writing performance", "body": "<p>I'm writing a website with Golang and Sqlite3, and I expect around 1000 concurrent writings per second for a few minutes each day, so I did the following test (ignore error checking to look cleaner):</p>\n\n<pre><code>t1 := time.Now()\ntx, _ := db.Begin()\nstmt, _ := tx.Prepare(\"insert into foo(stuff) values(?)\")\ndefer stmt.Close()\n\nfor i := 0; i &lt; 1000; i++ {\n    _, _ = stmt.Exec(strconv.Itoa(i) + \" - ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789,./;'[]-=&lt;&gt;?:()*&amp;^%$#@!~`\")\n}\n\ntx.Commit()\nt2 := time.Now()\nlog.Println(\"Writing time: \", t2.Sub(t1))\n</code></pre>\n\n<p>And the writing time is about 0.1 second. Then I modified the loop to:</p>\n\n<pre><code>for i := 0; i &lt; 1000; i++ {\n    go func(stmt *sql.Stmt, i int) {\n        _, err = stmt.Exec(strconv.Itoa(i) + \" - ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789,./;'[]-=&lt;&gt;?:()*&amp;^%$#@!~`\")\n        if err != nil {\n            log.Fatal(err)\n        }\n    }(stmt, i)\n}\n</code></pre>\n\n<p>This gives me holy 46.2 seconds! I run it many times and every time is beyond 40 seconds! Sometimes even over a minute! Since Golang handles each user concurrently, does it mean I have to switch database in order to make the webpage working? Thanks!</p>\n"}, {"tags": ["file", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1457109921, "post_id": 35801074, "comment_id": 59272426, "body": "By definition, &quot;append&quot; means write at the end of the file. What do mean by &quot;append to a specific location&quot;? You can&#39;t insert bytes into the middle of a file without rewriting it."}, {"owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1457111417, "post_id": 35801074, "comment_id": 59273456, "body": "@JimB Sorry I miss phrased my question I just want to be a able to write to a specific location in a file"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1457111493, "post_id": 35801074, "comment_id": 59273493, "body": "To write at a specific location, you seek to that location first: <a href=\"https://golang.org/pkg/os/#File.Seek\" rel=\"nofollow noreferrer\"><code>File.Seek</code></a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3088543"}, "edited": false, "score": 0, "creation_date": 1457111889, "post_id": 35801074, "comment_id": 59273739, "body": "Have you looked at gotemplate to see if it would work in your situation?"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 3, "creation_date": 1457112011, "post_id": 35801074, "comment_id": 59273803, "body": "Regardless of the OS or programming language, this is a limitation of general &quot;file&quot; access semantics. You can&#39;t easily <i>insert</i> data into a file, because you can&#39;t <i>move</i> data (after the insertion point)."}, {"owner": {"reputation": 490, "user_id": 3310759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/409b69c3ae7b431fc16129ccdadae9cd?s=128&d=identicon&r=PG", "display_name": "driusan", "link": "https://stackoverflow.com/users/3310759/driusan"}, "edited": false, "score": 0, "creation_date": 1457114114, "post_id": 35801074, "comment_id": 59275085, "body": "os.File implements the io.WriterAt interface. What problem are you having trying to write to a specific place in a file? It should be at easy as FileVariableName.WriteAt(bytes to write, offset)."}, {"owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "reply_to_user": {"reputation": 490, "user_id": 3310759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/409b69c3ae7b431fc16129ccdadae9cd?s=128&d=identicon&r=PG", "display_name": "driusan", "link": "https://stackoverflow.com/users/3310759/driusan"}, "edited": false, "score": 0, "creation_date": 1457115542, "post_id": 35801074, "comment_id": 59275919, "body": "@driusan the issue is the location changes each time so I don&#39;t know how to find the byte location"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1457119366, "post_id": 35801074, "comment_id": 59278094, "body": "@user3666882: this is why when you edit a file, you overwrite the file, or replace the old file with a new file. Unless this is a very very large file that changes frequently (e.g. a database), there&#39;s no point in trying to edit it byte by byte in place."}], "answers": [{"tags": [], "owner": {"reputation": 3167, "user_id": 978525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841c2b8e0327b7edc1ef1e592f7ac935?s=128&d=identicon&r=PG", "display_name": "Eamonn O&#39;Brien-Strain", "link": "https://stackoverflow.com/users/978525/eamonn-obrien-strain"}, "is_accepted": true, "score": 0, "last_activity_date": 1457157115, "last_edit_date": 1457157115, "creation_date": 1457152516, "answer_id": 35810068, "question_id": 35801074, "link": "https://stackoverflow.com/questions/35801074/how-to-write-to-a-specific-location-in-a-file/35810068#35810068", "title": "How to write to a specific location in a file", "body": "<p>For small files like this it is best to read the file into memory, modify it, and write it back out again.</p>\n\n<p>One possibility is to read it in to a list of strings, one per line. Then insert the added lines into the list.  Then write out the list back to the file.</p>\n\n<p>Another possibility would be to parse the file into a map, insert the new elements into the map, and then write the contents of the map out to the file in the required format.</p>\n\n<p>Alternatively if you always want to insert the new text at a fixed offset from the end of the file, you could read into a string, and insert your new text at the end, like so:</p>\n\n<pre><code>package main\n\nimport (\n    \"io/ioutil\"\n    \"log\"\n)\n\nconst textToInsert = `,\n'/example-route':{\nname: 'example-route',\ncomponent: ExampleRoute\n  }\n})\n`\n\nfunc main() {\n    original, err := ioutil.ReadFile(\"routes.js\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // replace last 4 characters with textToInsert\n    modified := append(original[0:len(original)-4], []byte(textToInsert)...)\n\n    err = ioutil.WriteFile(\"routes.js\", modified, 0644)\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "closed_date": 1457934974, "accepted_answer_id": 35810068, "answer_count": 1, "score": -3, "last_activity_date": 1457157115, "creation_date": 1457108769, "last_edit_date": 1457111868, "question_id": 35801074, "link": "https://stackoverflow.com/questions/35801074/how-to-write-to-a-specific-location-in-a-file", "closed_reason": "Needs details or clarity", "title": "How to write to a specific location in a file", "body": "<p>I'm writing a command line tool to help me scaffold my projects. I need to be able to add a line of text to a file but to a specific location. Here is the example:</p>\n\n<p>I have this <code>routes.js</code> file:</p>\n\n<pre><code>router.map({\n  '/home':{\n    name: 'home',\n    component: Home\n  },\n  '/about':{\n    name: 'about',\n    component: About\n  },\n  '/quote':{\n    name: 'quote',\n    component: Quote\n  }\n})\n</code></pre>\n\n<p>Now I want to run a command to create a new route so <code>my-cli generate route ExampleRoute</code></p>\n\n<p>And I would like it to write the route like so:</p>\n\n<pre><code>router.map({\n    '/home':{\n    name: 'home',\n    component: Home\n  },\n    '/about':{\n    name: 'about',\n    component: About\n  },\n    '/quote':{\n    name: 'quote',\n    component: Quote\n  },\n    '/example-route':{\n    name: 'example-route',\n    component: ExampleRoute\n  }\n})\n</code></pre>\n\n<p>Appending to the bottom of a file is easy but how do I write to a specific location? </p>\n"}, {"tags": ["linux", "windows", "go", "cgo"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1457105769, "post_id": 35799739, "comment_id": 59269559, "body": "I recall reading somewhere that Windows OSes don&#39;t have a syscall interface like unix systems do and instead expose a C API. Not sure how true that is though."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1457105939, "post_id": 35799739, "comment_id": 59269677, "body": "I could be wrong, but looking at <a href=\"https://github.com/golang/go/blob/master/src/syscall/zsyscall_windows.go\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/master/src/syscall/&hellip;</a>, it seems like all syscalls go through cgo, but I&#39;m not really familiar with windows. this question would fit better on the golangnuts ML."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1457109608, "post_id": 35799739, "comment_id": 59272196, "body": "In fact Windows <i>do</i> have syscalls. The problem is that contrary to certain other operating system kernels (Linux included) which have stable syscall number tables, which only get extended by adding new syscalls, Windows never published these numbers, and they <i>do</i> differ between different versions of the kernels of this family of OS. And they might even legitimately be different between, say, different service packs. Since the only documented way to access these syscalls is via DLLs, that&#39;s what Go is supposedly doing."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1457109896, "post_id": 35799739, "comment_id": 59272407, "body": "Note that what you&#39;re observing is one of the reasons for the existence of the <code>bufio</code> package: syscalls are expensive in any OS which has and privilege process separation as the execution context has to be &quot;gated&quot; from the user space to the kernel space and back.  If you&#39;d use <code>io.Copy()</code> which uses 32KiB buffer IIRC, the results would be substantially better I think."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1457111130, "post_id": 35799739, "comment_id": 59273264, "body": "@OneOfOne: &quot;I&#39;m not really familiar with windows. this question would fit better on the golangnuts.&quot; It&#39;s not necessary to ask the question on golang-nuts. There are many Windows experts on Stack Overflow."}, {"owner": {"reputation": 121, "user_id": 6018950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95585b13b40150da90cb5a180979a552?s=128&d=identicon&r=PG&f=1", "display_name": "samonzeweb", "link": "https://stackoverflow.com/users/6018950/samonzeweb"}, "edited": false, "score": 0, "creation_date": 1457111993, "post_id": 35799739, "comment_id": 59273793, "body": "The purpose of the test is not to use buffered I/O, but act in the same way as the C# code. But it&#39;s an interesting point. In fact the performance difference between C# version en Go version is due to .... C# FileStream buffering ! I know a bit about C#//NET, but I&#39;m not a specialist, and didn&#39;t though about that a first time. I made some research and found that System.IO.FileStream use buffered I/O in some cases. Then we can&#39;t compare the two versions. But the main purpose of the question is about cgo, and a perterSO made a reply below. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 6018950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95585b13b40150da90cb5a180979a552?s=128&d=identicon&r=PG&f=1", "display_name": "samonzeweb", "link": "https://stackoverflow.com/users/6018950/samonzeweb"}, "edited": false, "score": 0, "creation_date": 1457111645, "post_id": 35801802, "comment_id": 59273593, "body": "Thank. Then <code>runtime.cgocall</code> does not mean it use cgo.  But it does a similar job."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 121, "user_id": 6018950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95585b13b40150da90cb5a180979a552?s=128&d=identicon&r=PG&f=1", "display_name": "samonzeweb", "link": "https://stackoverflow.com/users/6018950/samonzeweb"}, "edited": false, "score": 0, "creation_date": 1457117342, "post_id": 35801802, "comment_id": 59276983, "body": "@samonzeweb: <code>runtime.cgocall</code> time measures the time spent outside Go when calling via <code>cgo</code> and, on Windows, when calling Windows <code>dll</code>s. In your <code>disk.go</code> program all the calls outside Go are to Windows <code>dll</code>s."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 121, "user_id": 6018950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95585b13b40150da90cb5a180979a552?s=128&d=identicon&r=PG&f=1", "display_name": "samonzeweb", "link": "https://stackoverflow.com/users/6018950/samonzeweb"}, "edited": false, "score": 0, "creation_date": 1457117440, "post_id": 35801802, "comment_id": 59277031, "body": "@samonzeweb: See my revised answer for some comments on benchmarks and some benchmark results."}, {"owner": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "reply_to_user": {"reputation": 121, "user_id": 6018950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95585b13b40150da90cb5a180979a552?s=128&d=identicon&r=PG&f=1", "display_name": "samonzeweb", "link": "https://stackoverflow.com/users/6018950/samonzeweb"}, "edited": false, "score": 0, "creation_date": 1457117643, "post_id": 35801802, "comment_id": 59277145, "body": "Also, if this answered your question, please accept it @samonzeweb"}, {"owner": {"reputation": 121, "user_id": 6018950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95585b13b40150da90cb5a180979a552?s=128&d=identicon&r=PG&f=1", "display_name": "samonzeweb", "link": "https://stackoverflow.com/users/6018950/samonzeweb"}, "edited": false, "score": 0, "creation_date": 1457118287, "post_id": 35801802, "comment_id": 59277506, "body": "As I said myself, I didn&#39;t compare performance between Windows and Linux, as it was not the same hardware. I wanted to see if the call to <code>runtime.cgocall</code> is specific to Windows or not, and then I asked the question about this difference. It&#39;s not a performance question, but an implementation one. I&#39;ve my answer, thanks. And even if benchmark between Linux and Windows wasn&#39;t the purpose, your benchmark is welcome, I&#39;ll ended to do it soon or later ;)"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 6, "last_activity_date": 1457117092, "last_edit_date": 1457117092, "creation_date": 1457110823, "answer_id": 35801802, "question_id": 35799739, "link": "https://stackoverflow.com/questions/35799739/why-go-use-cgo-on-windows-for-a-simple-file-write/35801802#35801802", "title": "Why Go use cgo on Windows for a simple File.Write?", "body": "<p>Go does not perform file I/O, it delegates the task to the operating system. See the Go operating system dependent <code>syscall</code> packages.</p>\n\n<p>Linux and Windows are different operating systems with different OS ABIs. For example, Linux uses syscalls via <code>syscall.Syscall</code> and Windows uses Windows dlls. On Windows, the dll call is a C call. It doesn't use <code>cgo</code>. It does go through the same dynamic C pointer check used by <code>cgo</code>, <code>runtime.cgocall</code>. There is no <code>runtime.wincall</code> alias.</p>\n\n<p>In summary, different operating systems have different OS call mechanisms.</p>\n\n<blockquote>\n  <p><a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow\">Command cgo</a></p>\n  \n  <p><a href=\"https://golang.org/cmd/cgo/#hdr-Passing_pointers\" rel=\"nofollow\">Passing pointers</a></p>\n  \n  <p>Go is a garbage collected language, and the garbage collector needs\n  to know the location of every pointer to Go memory. Because of this,\n  there are restrictions on passing pointers between Go and C.</p>\n  \n  <p>In this section the term Go pointer means a pointer to memory\n  allocated by Go (such as by using the &amp; operator or calling the\n  predefined new function) and the term C pointer means a pointer to\n  memory allocated by C (such as by a call to C.malloc). Whether a\n  pointer is a Go pointer or a C pointer is a dynamic property\n  determined by how the memory was allocated; it has nothing to do with\n  the type of the pointer.</p>\n  \n  <p>Go code may pass a Go pointer to C provided the Go memory to which it\n  points does not contain any Go pointers. The C code must preserve this\n  property: it must not store any Go pointers in Go memory, even\n  temporarily. When passing a pointer to a field in a struct, the Go\n  memory in question is the memory occupied by the field, not the entire\n  struct. When passing a pointer to an element in an array or slice, the\n  Go memory in question is the entire array or the entire backing array\n  of the slice.</p>\n  \n  <p>C code may not keep a copy of a Go pointer after the call returns.</p>\n  \n  <p>A Go function called by C code may not return a Go pointer. A Go\n  function called by C code may take C pointers as arguments, and it may\n  store non-pointer or C pointer data through those pointers, but it may\n  not store a Go pointer in memory pointed to by a C pointer. A Go\n  function called by C code may take a Go pointer as an argument, but it\n  must preserve the property that the Go memory to which it points does\n  not contain any Go pointers.</p>\n  \n  <p>Go code may not store a Go pointer in C memory. C code may store Go\n  pointers in C memory, subject to the rule above: it must stop storing\n  the Go pointer when the C function returns.</p>\n  \n  <p>These rules are checked dynamically at runtime. The checking is\n  controlled by the cgocheck setting of the GODEBUG environment\n  variable. The default setting is GODEBUG=cgocheck=1, which implements\n  reasonably cheap dynamic checks. These checks may be disabled entirely\n  using GODEBUG=cgocheck=0. Complete checking of pointer handling, at\n  some cost in run time, is available via GODEBUG=cgocheck=2.</p>\n  \n  <p>It is possible to defeat this enforcement by using the unsafe package,\n  and of course there is nothing stopping the C code from doing anything\n  it likes. However, programs that break these rules are likely to fail\n  in unexpected and unpredictable ways.</p>\n</blockquote>\n\n<p>\"These rules are checked dynamically at runtime.\"</p>\n\n<hr>\n\n<p>Benchmarks:</p>\n\n<p>To paraphrase, there are lies, damn lies, and benchmarks.</p>\n\n<p>For valid comparisons across operating systems you need to run on identical hardware. For example, the difference between CPUs, memory, and rust or silicon disk I/O. I dual-boot Linux and Windows on the same machine. </p>\n\n<p>Run benchmarks at least three times back-to-back. Operating systems try to be smart. For example, caching I/O. Languages using virtual machines need warm-up time. And so on.</p>\n\n<p>Know what you are measuring. If you are doing sequential I/O, you spend almost all your time in the operating system. Have you turned off malware protection? And so on.</p>\n\n<p>And so on.</p>\n\n<p>Here are some results for <code>disk.go</code> from the same machine using dual-boot Windows and Linux.</p>\n\n<p>Windows:</p>\n\n<pre><code>&gt;go build disk.go\n&gt;/TimeMem disk\nDuration : 18.3300322s\nElapsed time   : 18.38\nKernel time    : 13.71 (74.6%)\nUser time      : 4.62 (25.1%)\n</code></pre>\n\n<p>Linux:</p>\n\n<pre><code>$ go build disk.go\n$ time ./disk\nDuration : 18.54350723s\nreal    0m18.547s\nuser    0m2.336s\nsys     0m16.236s\n</code></pre>\n\n<p>Effectively, they are the same, 18 seconds <code>disk.go</code> duration. Just some variation between operating systems as to what is counted user time and what is counted as kernel or system time. Elapsed or real time is the same.</p>\n\n<p>In your tests, kernel or system time was 93.72%  <code>runtime.cgocall</code> versus 95.49%  <code>syscall.Syscall</code>.</p>\n"}], "owner": {"reputation": 121, "user_id": 6018950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95585b13b40150da90cb5a180979a552?s=128&d=identicon&r=PG&f=1", "display_name": "samonzeweb", "link": "https://stackoverflow.com/users/6018950/samonzeweb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 825, "favorite_count": 3, "accepted_answer_id": 35801802, "answer_count": 1, "score": 9, "last_activity_date": 1457117092, "creation_date": 1457105169, "question_id": 35799739, "link": "https://stackoverflow.com/questions/35799739/why-go-use-cgo-on-windows-for-a-simple-file-write", "title": "Why Go use cgo on Windows for a simple File.Write?", "body": "<p>Rewriting a simple program from C# to Go, I found the resulting executable 3 to 4 times slower. Expecialy the Go version use 3 to 4 times more CPU. It's surprising because the code does many I/O and is not supposed to consume significant amount of CPU.</p>\n\n<p>I made a very simple version only doing sequential writes, and made benchmarks. I ran the same benchmarks on Windows 10 and Linux (Debian Jessie). The time can't be compared (not the same systems, disks, ...) but the result is interesting.</p>\n\n<p>I'm using the same Go version on both platforms : 1.6</p>\n\n<p>On Windows os.File.Write use cgo (see <code>runtime.cgocall</code> below), not on Linux. Why ?</p>\n\n<p>Here is the disk.go program :</p>\n\n<pre><code>    package main\n\n    import (\n        \"crypto/rand\"\n        \"fmt\"\n        \"os\"\n        \"time\"\n    )\n\n    const (\n        // size of the test file\n        fullSize = 268435456\n        // size of read/write per call\n        partSize = 128\n        // path of temporary test file\n        filePath = \"./bigfile.tmp\"\n    )\n\n    func main() {\n        buffer := make([]byte, partSize)\n\n        seqWrite := func() error {\n            return sequentialWrite(filePath, fullSize, buffer)\n        }\n\n        err := fillBuffer(buffer)\n        panicIfError(err)\n        duration, err := durationOf(seqWrite)\n        panicIfError(err)\n        fmt.Printf(\"Duration : %v\\n\", duration)\n    }\n\n    // It's just a test ;)\n    func panicIfError(err error) {\n        if err != nil {\n            panic(err)\n        }\n    }\n\n    func durationOf(f func() error) (time.Duration, error) {\n        startTime := time.Now()\n        err := f()\n        return time.Since(startTime), err\n    }\n\n    func fillBuffer(buffer []byte) error {\n        _, err := rand.Read(buffer)\n        return err\n    }\n\n    func sequentialWrite(filePath string, fullSize int, buffer []byte) error {\n        desc, err := os.OpenFile(filePath, os.O_WRONLY|os.O_CREATE, 0666)\n        if err != nil {\n            return err\n        }\n        defer func() {\n            desc.Close()\n            err := os.Remove(filePath)\n            panicIfError(err)\n        }()\n\n        var totalWrote int\n        for totalWrote &lt; fullSize {\n            wrote, err := desc.Write(buffer)\n            totalWrote += wrote\n            if err != nil {\n                return err\n            }\n        }\n\n        return nil\n    }\n</code></pre>\n\n<p>The benchmark test (disk_test.go) :</p>\n\n<pre><code>    package main\n\n    import (\n        \"testing\"\n    )\n\n    // go test -bench SequentialWrite -cpuprofile=cpu.out\n    // Windows : go tool pprof -text -nodecount=10 ./disk.test.exe cpu.out\n    // Linux : go tool pprof -text -nodecount=10 ./disk.test cpu.out\n    func BenchmarkSequentialWrite(t *testing.B) {\n        buffer := make([]byte, partSize)\n        err := sequentialWrite(filePath, fullSize, buffer)\n        panicIfError(err)\n    }\n</code></pre>\n\n<p>The Windows result (with cgo) :</p>\n\n<pre><code>    11.68s of 11.95s total (97.74%)\n    Dropped 18 nodes (cum &lt;= 0.06s)\n    Showing top 10 nodes out of 26 (cum &gt;= 0.09s)\n          flat  flat%   sum%        cum   cum%\n        11.08s 92.72% 92.72%     11.20s 93.72%  runtime.cgocall\n         0.11s  0.92% 93.64%      0.11s  0.92%  runtime.deferreturn\n         0.09s  0.75% 94.39%     11.45s 95.82%  os.(*File).write\n         0.08s  0.67% 95.06%      0.16s  1.34%  runtime.deferproc.func1\n         0.07s  0.59% 95.65%      0.07s  0.59%  runtime.newdefer\n         0.06s   0.5% 96.15%      0.28s  2.34%  runtime.systemstack\n         0.06s   0.5% 96.65%     11.25s 94.14%  syscall.Write\n         0.05s  0.42% 97.07%      0.07s  0.59%  runtime.deferproc\n         0.04s  0.33% 97.41%     11.49s 96.15%  os.(*File).Write\n         0.04s  0.33% 97.74%      0.09s  0.75%  syscall.(*LazyProc).Find\n</code></pre>\n\n<p>The Linux result (without cgo) :</p>\n\n<pre><code>    5.04s of 5.10s total (98.82%)\n    Dropped 5 nodes (cum &lt;= 0.03s)\n    Showing top 10 nodes out of 19 (cum &gt;= 0.06s)\n          flat  flat%   sum%        cum   cum%\n         4.62s 90.59% 90.59%      4.87s 95.49%  syscall.Syscall\n         0.09s  1.76% 92.35%      0.09s  1.76%  runtime/internal/atomic.Cas\n         0.08s  1.57% 93.92%      0.19s  3.73%  runtime.exitsyscall\n         0.06s  1.18% 95.10%      4.98s 97.65%  os.(*File).write\n         0.04s  0.78% 95.88%      5.10s   100%  _/home/sam/Provisoire/go-disk.sequentialWrite\n         0.04s  0.78% 96.67%      5.05s 99.02%  os.(*File).Write\n         0.04s  0.78% 97.45%      0.04s  0.78%  runtime.memclr\n         0.03s  0.59% 98.04%      0.08s  1.57%  runtime.exitsyscallfast\n         0.02s  0.39% 98.43%      0.03s  0.59%  os.epipecheck\n         0.02s  0.39% 98.82%      0.06s  1.18%  runtime.casgstatus\n</code></pre>\n"}, {"tags": ["go", "udp", "broadcast"], "comments": [{"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1457107382, "post_id": 35797073, "comment_id": 59270673, "body": "Don&#39;t ignore the error you get from WriteToUDP"}, {"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1457107507, "post_id": 35797073, "comment_id": 59270752, "body": "Also: You don&#39;t handle several other errors. And log.Fatal ends the program anyway, the os.Exit will be never reached."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 2441381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc21a31c6e917b06e6388fe564a5ef24?s=128&d=identicon&r=PG", "display_name": "Marvin Ahlgrimm", "link": "https://stackoverflow.com/users/2441381/marvin-ahlgrimm"}, "edited": false, "score": 1, "creation_date": 1457118438, "post_id": 35801519, "comment_id": 59277577, "body": "Hi, thank you for looking into this. I just assigned amountBits, err from the result of WriteToUDP. amountBits is set to 7 and err is apparently nil. I also decreased the amount of bytes to a reasonable amount (256), but the port of the Go client is still not reachable according to wireshark"}, {"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "reply_to_user": {"reputation": 79, "user_id": 2441381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc21a31c6e917b06e6388fe564a5ef24?s=128&d=identicon&r=PG", "display_name": "Marvin Ahlgrimm", "link": "https://stackoverflow.com/users/2441381/marvin-ahlgrimm"}, "edited": false, "score": 0, "creation_date": 1457120979, "post_id": 35801519, "comment_id": 59279084, "body": "For me it works after. What Machine/OS and Go Version are you using? Any Firewall? Try to listen just on localhost:8888."}, {"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "reply_to_user": {"reputation": 79, "user_id": 2441381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc21a31c6e917b06e6388fe564a5ef24?s=128&d=identicon&r=PG", "display_name": "Marvin Ahlgrimm", "link": "https://stackoverflow.com/users/2441381/marvin-ahlgrimm"}, "edited": false, "score": 0, "creation_date": 1457121194, "post_id": 35801519, "comment_id": 59279197, "body": "Also: amountBytes does not change the len of your recvBuff. Also you shouldn&#39;t name it amountBytes, just n."}], "tags": [], "owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "is_accepted": false, "score": 1, "last_activity_date": 1457109984, "creation_date": 1457109984, "answer_id": 35801519, "question_id": 35797073, "link": "https://stackoverflow.com/questions/35797073/udp-client-written-in-golang-fails-to-receive-message-from-server/35801519#35801519", "title": "UDP-Client written in Golang fails to receive Message from Server", "body": "<p>If you don't ignore the error you get back from WriteToUDP it will actually give you an error: \"sendto: message to long\"</p>\n\n<p>On OSX the the maximum UDP Datagram size is set default to 9216 bytes. You try to send 15000 bytes. </p>\n\n<p>If you just want to write back what you received then write </p>\n\n<pre><code>recvBuff[:n]\n</code></pre>\n\n<p>, where n is the number of bytes received before.</p>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 2441381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc21a31c6e917b06e6388fe564a5ef24?s=128&d=identicon&r=PG", "display_name": "Marvin Ahlgrimm", "link": "https://stackoverflow.com/users/2441381/marvin-ahlgrimm"}, "edited": false, "score": 0, "creation_date": 1457123717, "post_id": 35804927, "comment_id": 59280557, "body": "Thanks! Makes sense that I only will get messages from the &quot;connected&quot; connection. But then again, why does Go build up a connection? Isn&#39;t UDP connectionless?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 79, "user_id": 2441381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc21a31c6e917b06e6388fe564a5ef24?s=128&d=identicon&r=PG", "display_name": "Marvin Ahlgrimm", "link": "https://stackoverflow.com/users/2441381/marvin-ahlgrimm"}, "edited": false, "score": 1, "creation_date": 1457124173, "post_id": 35804927, "comment_id": 59280771, "body": "@MarvinAhlgrimm: yes and no ;). Go is only exposing what&#39;s available from the underlying berkeley sockets API. DialUDP uses the <code>connect</code> syscall so you can send and receive from a single host, which is part of that standard API. UDP is still &quot;connectionless&quot;, but this provides the convenience of only needing to call <code>recv</code> and <code>send</code> when talking to a single host, and not having to filter out stray packets."}, {"owner": {"reputation": 6247, "user_id": 157744, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/399db2289f32a560396d0f72ccfe9714?s=128&d=identicon&r=PG", "display_name": "Adam Lewis", "link": "https://stackoverflow.com/users/157744/adam-lewis"}, "edited": false, "score": 0, "creation_date": 1481312347, "post_id": 35804927, "comment_id": 69342427, "body": "This was a huge help.  It&#39;s certainly not intuitive why the ReadFrom doesn&#39;t work on the <code>DialUDP</code>.  Especially when taking into account nearly every UDP example uses Dial over Listen."}, {"owner": {"reputation": 4120, "user_id": 1099314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jKm3r.png?s=128&g=1", "display_name": "Ninh Pham", "link": "https://stackoverflow.com/users/1099314/ninh-pham"}, "edited": false, "score": 0, "creation_date": 1595694147, "post_id": 35804927, "comment_id": 111566065, "body": "Is DNS working like that? If true, I wonder how DNS server can &quot;respond&quot; to the senders where they (senders) are in a private network."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 9, "last_activity_date": 1457121515, "last_edit_date": 1457121515, "creation_date": 1457121180, "answer_id": 35804927, "question_id": 35797073, "link": "https://stackoverflow.com/questions/35797073/udp-client-written-in-golang-fails-to-receive-message-from-server/35804927#35804927", "title": "UDP-Client written in Golang fails to receive Message from Server", "body": "<p>Even if you're you're only going to be sending UDP packets from the connection, you generally want to use <a href=\"https://golang.org/pkg/net/#ListenUDP\" rel=\"noreferrer\"><code>ListenUDP</code></a> to create the connection, and use the <code>ReadFromUDP</code> and <code>WriteToUDP</code> methods.</p>\n\n<p>When you use <code>DialUDP</code>, it creates a \"connected\" UDP socket, with an implicit remote endpoint, which will filter incoming packets. From the Linux <code>connect</code> man page:</p>\n\n<blockquote>\n  <p>If the socket sockfd is of type SOCK_DGRAM then addr is the address to which datagrams are sent by default, and the only address from which datagrams are received.</p>\n</blockquote>\n"}], "owner": {"reputation": 79, "user_id": 2441381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc21a31c6e917b06e6388fe564a5ef24?s=128&d=identicon&r=PG", "display_name": "Marvin Ahlgrimm", "link": "https://stackoverflow.com/users/2441381/marvin-ahlgrimm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4059, "favorite_count": 1, "accepted_answer_id": 35804927, "answer_count": 2, "score": 4, "last_activity_date": 1457121515, "creation_date": 1457097412, "last_edit_date": 1457097524, "question_id": 35797073, "link": "https://stackoverflow.com/questions/35797073/udp-client-written-in-golang-fails-to-receive-message-from-server", "title": "UDP-Client written in Golang fails to receive Message from Server", "body": "<p>I have written a Java Client, which sends a message to the broadcast address. </p>\n\n<p>I have also written a Java Server, which accepts all sent messages and sends the message back to the client.</p>\n\n<p>Now I wanted to try to do exactly the same in Go, just for gaining some experience. The server works fine and is receiving a message and responding to the Java client.</p>\n\n<p>But my Go Client is only sending a message to the Go/Java server but does not receive any message back. According to wireshark the message is sent back to the right IP and Port, but apparently the port is unreachable.</p>\n\n<p>My Code is as follows:\nGo Server:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net\"\n)\n\nfunc main() {\n    //Resolving address\n    udpAddr, err := net.ResolveUDPAddr(\"udp4\", \"0.0.0.0:8888\")\n\n    if err != nil {\n        log.Println(\"Error: \", err)\n    }\n\n    // Build listining connections\n    conn, err := net.ListenUDP(\"udp\", udpAddr)\n\n    defer conn.Close()\n\n    if err != nil {\n        log.Println(\"Error: \", err)\n    }\n\n    // Interacting with one client at a time\n    for {\n        fmt.Println(\"&gt;&gt;&gt;Ready to receive broadcast packets!\")\n\n        // Receiving a message\n        recvBuff := make([]byte, 15000)\n        _, rmAddr, err := conn.ReadFromUDP(recvBuff)\n\n        if err != nil {\n            panic(err)\n        }\n\n        fmt.Println(\"&gt;&gt;&gt;Discovery packet received from: \" + rmAddr.String())\n        fmt.Println(\"&gt;&gt;&gt;Packet received; data: \" + string(recvBuff))\n\n        // Sending the same message back to current client\n        conn.WriteToUDP(recvBuff, rmAddr)\n\n        fmt.Println(\"&gt;&gt;&gt;Sent packet to: \" + rmAddr.String())\n</code></pre>\n\n<p>}\n}</p>\n\n<p>Go Client:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net\"\n    \"os\"\n)\n\nfunc main() {\n    service := \"158.129.239.255:8888\"\n\n    // Resolving Address\n    RemoteAddr, err := net.ResolveUDPAddr(\"udp\", service)\n\n    // Make a connection\n    conn, err := net.DialUDP(\"udp\", nil, RemoteAddr)\n\n    defer conn.Close()\n\n    // Exit if some error occured\n    if err != nil {\n        log.Fatal(err)\n        os.Exit(1)\n    }\n\n    // write a message to server\n    message := []byte(\"message\")\n\n    _, err = conn.Write(message)\n    fmt.Println(\"&gt;&gt;&gt; Request packet sent to: 158.129.239.255 (DEFAULT)\")\n\n    if err != nil {\n        log.Println(err)\n    }\n\n    // Receive response from server\n    buf := make([]byte, 15000)\n    amountByte, remAddr, err := conn.ReadFromUDP(buf)\n\n    if err != nil {\n        log.Println(err)\n    } else {\n        fmt.Println(amountByte, \"bytes received from\", remAddr)\n    }\n\n}\n</code></pre>\n\n<p>Java Client:</p>\n\n<pre><code>import java.io.IOException;\nimport java.net.DatagramPacket;\nimport java.net.DatagramSocket;\nimport java.net.InetAddress;\nimport java.net.InterfaceAddress;\nimport java.net.NetworkInterface;\nimport java.util.Enumeration;\nimport java.util.logging.Level;\nimport java.util.logging.Logger;\n\npublic class BroadcastUDPClient {\n\n    public static void main(String[] args) {\n        // Find the server using UDP broadcast\n        try {\n            //Open a random port to send the package\n            DatagramSocket sendSD = new DatagramSocket();\n            sendSD.setBroadcast(true);\n\n                byte[] sendData = \"message\".getBytes();\n\n            //Try the 255.255.255.255 first\n            try {\n                DatagramPacket sendPacket = new DatagramPacket(sendData, sendData.length, InetAddress.getByName(\"158.129.239.255\"), 8888);\n                sendSD.send(sendPacket);\n                System.out.println(\"&gt;&gt;&gt; Request packet sent to: 158.129.239.255 (DEFAULT)\");\n            } catch (Exception e) {\n            }\n\n            //Wait for a response\n            byte[] recvBuf = new byte[15000];\n            DatagramPacket receivePacket = new DatagramPacket(recvBuf, recvBuf.length);\n            sendSD.receive(receivePacket);\n\n            //We have a response\n            System.out.println(\"&gt;&gt;&gt; Broadcast response from server: \" + receivePacket.getAddress().getHostAddress());\n            String message = new String(receivePacket.getData()).trim();\n            System.out.println(\"&gt;&gt;&gt; Message Body: \" + message);\n\n            //Close the port!\n            sendSD.close();\n        } catch (IOException ex) {\n            Logger.getLogger(BroadcastUDPClient.class.getName()).log(Level.SEVERE, null, ex);\n        }\n    }\n\n}\n</code></pre>\n\n<p>What am I doing wrong with my Go Client?</p>\n"}, {"tags": ["go", "antlr4", "ragel"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1457096763, "post_id": 35793242, "comment_id": 59263123, "body": "The standard library has a YACC port, I think it will work  (though it&#39;s pretty ugly)"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1457099603, "post_id": 35793242, "comment_id": 59265128, "body": "<a href=\"https://github.com/cznic?tab=repositories\" rel=\"nofollow noreferrer\">Jan Mercl</a> has a lot of packages related to generating parsers. You should be able to build your parser together from them."}, {"owner": {"reputation": 4042, "user_id": 1046374, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Ihqqd.png?s=128&g=1", "display_name": "Ivan Kochurkin", "link": "https://stackoverflow.com/users/1046374/ivan-kochurkin"}, "edited": false, "score": 0, "creation_date": 1457131215, "post_id": 35793242, "comment_id": 59284140, "body": "Go-target is in development. You can try ask author about it: <a href=\"https://github.com/antlr/antlr4/issues/659\" rel=\"nofollow noreferrer\">github.com/antlr/antlr4/issues/659</a>"}, {"owner": {"reputation": 3875, "user_id": 652101, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/10eb57143bcdb0cea1bc504810a3b633?s=128&d=identicon&r=PG", "display_name": "kliron", "link": "https://stackoverflow.com/users/652101/kliron"}, "reply_to_user": {"reputation": 4042, "user_id": 1046374, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Ihqqd.png?s=128&g=1", "display_name": "Ivan Kochurkin", "link": "https://stackoverflow.com/users/1046374/ivan-kochurkin"}, "edited": false, "score": 0, "creation_date": 1457167959, "post_id": 35793242, "comment_id": 59292404, "body": "@KvanTTT I know, I followed the discussion on github. It is, as I understand, quite far from production ready yet."}], "owner": {"reputation": 3875, "user_id": 652101, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/10eb57143bcdb0cea1bc504810a3b633?s=128&d=identicon&r=PG", "display_name": "kliron", "link": "https://stackoverflow.com/users/652101/kliron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1458748064, "creation_date": 1457086200, "last_edit_date": 1458748064, "question_id": 35793242, "link": "https://stackoverflow.com/questions/35793242/any-parser-that-can-handle-recursive-grammars-in-go", "title": "Any parser that can handle recursive grammars in Go?", "body": "<p>In a Node.js project I wrote a query parser in ANTLR4 (JS target). The user queries have a simplified SQL-like grammar that are then processed to full SQL on the server. The query structure can be arbitrarily nested.</p>\n\n<p>I am now porting this app to go. There is, at the moment, no ANTLR4 target for go. I started exploring <a href=\"https://www.colm.net/open-source/ragel/\" rel=\"nofollow\">Ragel</a> but according to the documentation, it expects a regular grammar and does not handle recursion, except for really simple tasks like balancing parentheses.</p>\n\n<p>Another solution is to use my ANTRL4 grammar with the C++ target and then link the C++ classes to go with SWIG (or something) which feels kinda hairy and last resort type of solution.</p>\n\n<p>Yet another solution is to do the parsing  on the client side but this would explode the amount of js needed for the client to download. Also feels a bit desparate.</p>\n\n<p><strong>So my questions are:</strong></p>\n\n<p>1) Are there any parser libraries able to handle recursive grammars usable from Go? </p>\n\n<p>2) I am completely unfamiliar with ragel and as it seems quite a complicated tool I want to get this straight before investing time into learning it: Is there any way to handle <em>some</em> recursion (say up to a certain level) in ragel if the grammar is simple enough?</p>\n"}, {"tags": ["go", "struct", "reflection", "types"], "comments": [{"owner": {"reputation": 623, "user_id": 5615224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7bea88308ec27975167f216eb8f998e?s=128&d=identicon&r=PG&f=1", "display_name": "sfault", "link": "https://stackoverflow.com/users/5615224/sfault"}, "edited": false, "score": 1, "creation_date": 1457079120, "post_id": 35790935, "comment_id": 59252138, "body": "seems if you do Ab{}, instead of new(Ab) you get expected result"}], "answers": [{"comments": [{"owner": {"reputation": 708, "user_id": 4144758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfea5e29717057a628f9363b652e5a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele D", "link": "https://stackoverflow.com/users/4144758/daniele-d"}, "edited": false, "score": 1, "creation_date": 1457080195, "post_id": 35791105, "comment_id": 59252645, "body": "Thank you. This answer is simply beautiful"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 1, "creation_date": 1457100461, "post_id": 35791105, "comment_id": 59265708, "body": "Second alternative also works for e.g. <code>**Ab</code>, first one doesn&#39;t."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 708, "user_id": 4144758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfea5e29717057a628f9363b652e5a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele D", "link": "https://stackoverflow.com/users/4144758/daniele-d"}, "edited": false, "score": 0, "creation_date": 1457107706, "post_id": 35791105, "comment_id": 59270893, "body": "@DanieleD Added to the answer, and showed how it still can be used to support <code>**Ab</code> (or any depth of pointers)."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 62, "last_activity_date": 1487169226, "last_edit_date": 1487169226, "creation_date": 1457079416, "answer_id": 35791105, "question_id": 35790935, "link": "https://stackoverflow.com/questions/35790935/using-reflection-in-go-to-get-the-name-of-a-struct/35791105#35791105", "title": "using reflection in Go to get the name of a struct", "body": "<p>In your example you pass a value of pointer type (<code>*Ab</code>), not a struct type.</p>\n\n<h3>Sticking to <code>Type.Name()</code></h3>\n\n<p>If it is not a pointer, <code>Type.Name()</code> will properly return <code>Ab</code>. In case of pointer if you still want the struct's name, you can use <code>Type.Elem()</code> to get the element's type:</p>\n\n<pre><code>func getType(myvar interface{}) string {\n    if t := reflect.TypeOf(myvar); t.Kind() == reflect.Ptr {\n        return \"*\" + t.Elem().Name()\n    } else {\n        return t.Name()\n    }\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>tst4 := Ab{}\ntst5 := new(Ab)\nfmt.Println(getType(tst4))\nfmt.Println(getType(tst5))\n</code></pre>\n\n<p>Output (try your modified example on the <a href=\"http://play.golang.org/p/ZiiLpxq1bY\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Ab\n*Ab\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>Note that as <code>Type.Name()</code> does not resolve pointers, it would not work if the value passed is a pointer to pointer, e.g. <code>**Ab</code>, while as <code>Type.String()</code> automatically resolves pointers, would work in this case too.</p>\n\n<p>We can easily make our <code>getType()</code> function to work with <code>**Ab</code> too (or with any depth of pointers):</p>\n\n<pre><code>func getType(myvar interface{}) (res string) {\n    t := reflect.TypeOf(myvar)\n    for t.Kind() == reflect.Ptr {\n        t = t.Elem()\n        res += \"*\"\n    }\n    return res + t.Name()\n}\n</code></pre>\n\n<p>Calling it with values:</p>\n\n<pre><code>tst4 := Ab{}\ntst5 := new(Ab)\ntst6 := &amp;tst5 // type of **Ab\ntst7 := &amp;tst6 // type of ***Ab\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/ppETDiN_v0\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Ab\n*Ab\n**Ab\n***Ab\n</code></pre>\n\n<h3>Using <code>Type.String()</code></h3>\n\n<p>A simpler and better approach would be to use <code>Type.String()</code> instead of <code>Type.Name()</code> which automatically handles pointers and also includes package name. E.g.:</p>\n\n<pre><code>func getType(myvar interface{}) string {\n    return reflect.TypeOf(myvar).String()\n}\n</code></pre>\n\n<p>For the modified example it outputs:</p>\n\n<pre><code>string\nint\nfloat64\nmain.Ab\n*main.Ab\n</code></pre>\n\n<p>Try this variant on the <a href=\"http://play.golang.org/p/VDySY-tdW9\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 623, "user_id": 5615224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7bea88308ec27975167f216eb8f998e?s=128&d=identicon&r=PG&f=1", "display_name": "sfault", "link": "https://stackoverflow.com/users/5615224/sfault"}, "is_accepted": false, "score": 4, "last_activity_date": 1457080323, "creation_date": 1457080323, "answer_id": 35791322, "question_id": 35790935, "link": "https://stackoverflow.com/questions/35790935/using-reflection-in-go-to-get-the-name-of-a-struct/35791322#35791322", "title": "using reflection in Go to get the name of a struct", "body": "<p>The problem is <code>new</code> returns pointer, following should get the desired result.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Ab struct {\n}\n\nfunc getType(myvar interface{}) {\n    valueOf := reflect.ValueOf(myvar)\n\n    if valueOf.Type().Kind() == reflect.Ptr {\n        fmt.Println(reflect.Indirect(valueOf).Type().Name())\n    } else {\n        fmt.Println(valueOf.Type().Name())\n    }\n}\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n\n    tst := \"string\"\n    tst2 := 10\n    tst3 := 1.2\n    tst4 := new(Ab)\n\n    getType(tst)\n    getType(tst2)\n    getType(tst3)\n    getType(tst4)\n\n}\n</code></pre>\n\n<p>Output is</p>\n\n<pre><code>Hello, playground\nstring\nint\nfloat64\nAb\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 923, "user_id": 711024, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/595b03bef5e51ded53769ba91df29955?s=128&d=identicon&r=PG", "display_name": "Azr", "link": "https://stackoverflow.com/users/711024/azr"}, "is_accepted": false, "score": 11, "last_activity_date": 1568181292, "last_edit_date": 1568181292, "creation_date": 1495796405, "answer_id": 44199875, "question_id": 35790935, "link": "https://stackoverflow.com/questions/35790935/using-reflection-in-go-to-get-the-name-of-a-struct/44199875#44199875", "title": "using reflection in Go to get the name of a struct", "body": "<p>fmt has a cool <code>%T</code> tag as well</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\ntype Potato struct {\n}\n\nfunc main() {\n    fmt.Printf(\"I have a %T, an %T and a %T\\n\", Potato{}, http.StatusMultipleChoices, &amp;http.Response{})\n}\n</code></pre>\n\n<p>outputs <code>I have a main.Potato, an int and a *http.Response</code>\n<a href=\"https://play.golang.org/p/6z7_0BSitm\" rel=\"noreferrer\">https://play.golang.org/p/6z7_0BSitm</a></p>\n"}], "owner": {"reputation": 708, "user_id": 4144758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfea5e29717057a628f9363b652e5a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele D", "link": "https://stackoverflow.com/users/4144758/daniele-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33786, "favorite_count": 7, "accepted_answer_id": 35791105, "answer_count": 3, "score": 27, "last_activity_date": 1568181292, "creation_date": 1457078737, "last_edit_date": 1531406514, "question_id": 35790935, "link": "https://stackoverflow.com/questions/35790935/using-reflection-in-go-to-get-the-name-of-a-struct", "title": "using reflection in Go to get the name of a struct", "body": "<p>I found this question with this great answers:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/20170275/how-to-find-a-type-of-a-object-in-golang\">How to find a type of a object in Golang?</a></p>\n\n<p>I played around with the answer and tried to get the name of a struct in the same way:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"reflect\"\n)\n\ntype Ab struct {\n\n}\n\nfunc getType(myvar interface{}) string {\n        return reflect.TypeOf(myvar).Name()\n}\n\nfunc main() {\n        fmt.Println(\"Hello, playground\")\n\n        tst := \"string\"\n        tst2 := 10\n        tst3 := 1.2\n        tst4 := new(Ab)\n\n        fmt.Println(getType(tst))\n        fmt.Println(getType(tst2))\n        fmt.Println(getType(tst3))\n        fmt.Println(getType(tst4))\n\n}\n</code></pre>\n\n<p>Go playground: <a href=\"http://play.golang.org/p/tD8mygvETH\" rel=\"noreferrer\">http://play.golang.org/p/tD8mygvETH</a></p>\n\n<p>But the output is:</p>\n\n<pre><code>Hello, playground\nstring\nint\nfloat64\n\n\nProgram exited.\n</code></pre>\n\n<p>Expected output would be:</p>\n\n<pre><code>Hello, playground\nstring\nint\nfloat64\nAb\n\nProgram exited.\n</code></pre>\n\n<p>I tried to figure out by reading the documentation but didn't find the issue about that. So, sorry for the very general question, but:</p>\n\n<p>What's the reason, <code>reflect.TypeOf().Name()</code> does not work with (this) struct(s)?</p>\n"}, {"tags": ["go", "godeps"], "answers": [{"comments": [{"owner": {"reputation": 1251, "user_id": 3655695, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/42f05fe122cfe8437cfcf79be6631b74?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3655695/sam"}, "edited": false, "score": 0, "creation_date": 1457082576, "post_id": 35791164, "comment_id": 59253876, "body": "Thanks @sthe . I tried godep save also however its coming with same result"}, {"owner": {"reputation": 1251, "user_id": 3655695, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/42f05fe122cfe8437cfcf79be6631b74?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3655695/sam"}, "edited": false, "score": 0, "creation_date": 1457086691, "post_id": 35791164, "comment_id": 59256670, "body": "No no error. Now i think the answer given by Rohardjo looks logical and this is how doc of hashicorp says. I am trying it will update again here. Thanks"}, {"owner": {"reputation": 2368, "user_id": 789655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7fac771a6c8fccc82fe34f951b7b3fd?s=128&d=identicon&r=PG", "display_name": "Sthe", "link": "https://stackoverflow.com/users/789655/sthe"}, "reply_to_user": {"reputation": 1251, "user_id": 3655695, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/42f05fe122cfe8437cfcf79be6631b74?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3655695/sam"}, "edited": false, "score": 0, "creation_date": 1457086924, "post_id": 35791164, "comment_id": 59256829, "body": "I see. Let us know how it goes :-)"}], "tags": [], "owner": {"reputation": 2368, "user_id": 789655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7fac771a6c8fccc82fe34f951b7b3fd?s=128&d=identicon&r=PG", "display_name": "Sthe", "link": "https://stackoverflow.com/users/789655/sthe"}, "is_accepted": false, "score": 0, "last_activity_date": 1457079744, "creation_date": 1457079744, "answer_id": 35791164, "question_id": 35790414, "link": "https://stackoverflow.com/questions/35790414/failed-to-update-vendor-deps-via-godep-update-command-and-godep-save-r/35791164#35791164", "title": "Failed to update vendor deps via godep update ... command and godep save -r ./", "body": "<p>Please check this out <a href=\"https://blog.codeship.com/godep-dependency-management-in-golang/\" rel=\"nofollow\">difference between godep update and godep save</a>.\nI usually just use <code>godep save</code> unless I am updating a specific package. This grabs all the updated packages for the project from <code>GOPATH</code>. \nBTW: I am also fairly new to Godeps.</p>\n"}, {"comments": [{"owner": {"reputation": 1251, "user_id": 3655695, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/42f05fe122cfe8437cfcf79be6631b74?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3655695/sam"}, "edited": false, "score": 0, "creation_date": 1457162059, "post_id": 35791966, "comment_id": 59290980, "body": "Thanks Rohardjo. This was exactly the problem. I overlooked git stuff while reading the doc of terrraform. Thanks"}], "tags": [], "owner": {"reputation": 24, "user_id": 6017333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jSDIw.jpg?s=128&g=1", "display_name": "Septiaji Purwono Rahardjo", "link": "https://stackoverflow.com/users/6017333/septiaji-purwono-rahardjo"}, "is_accepted": true, "score": 0, "last_activity_date": 1457082432, "creation_date": 1457082432, "answer_id": 35791966, "question_id": 35790414, "link": "https://stackoverflow.com/questions/35790414/failed-to-update-vendor-deps-via-godep-update-command-and-godep-save-r/35791966#35791966", "title": "Failed to update vendor deps via godep update ... command and godep save -r ./", "body": "<p>Make sure you have git committed package you want to update, you can check the commit sha-1 checksum using git log and make sure it has different rev commit version in Godeps.json.\nThen include package name in godep command <code>godep update github.com/package/...</code></p>\n"}], "owner": {"reputation": 1251, "user_id": 3655695, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/42f05fe122cfe8437cfcf79be6631b74?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3655695/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 689, "favorite_count": 1, "accepted_answer_id": 35791966, "answer_count": 2, "score": 0, "last_activity_date": 1522338038, "creation_date": 1457076679, "last_edit_date": 1522338038, "question_id": 35790414, "link": "https://stackoverflow.com/questions/35790414/failed-to-update-vendor-deps-via-godep-update-command-and-godep-save-r", "title": "Failed to update vendor deps via godep update ... command and godep save -r ./", "body": "<p>I have latest deps available in my $GOPATH. Now i want to update my project Godeps.json with new deps(with latest GOPATH) by calling <code>godep update ./...</code> and then calling <code>godep save ./...</code> . \nhowever still I am with old deps in Godeps.json .</p>\n"}, {"tags": ["php", "go", "binary"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1457077002, "post_id": 35790314, "comment_id": 59251080, "body": "Rule of thumb: <b>Never</b> <b>ever</b> fiddle with byte order. Never. Just write the byte slice <code>json</code>. If you really need to write the initial length: If possible use decimal (e.g. 4 bytes like &quot;2371&quot;) and not a binary format. For more see <a href=\"http://commandcenter.blogspot.ch/2012/04/byte-order-fallacy.html\" rel=\"nofollow noreferrer\">commandcenter.blogspot.ch/2012/04/byte-order-fallacy.html</a>"}, {"owner": {"reputation": 920, "user_id": 1318584, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f62561cb4ac4b1b719ad7e5bedf18675?s=128&d=identicon&r=PG", "display_name": "cheese5505", "link": "https://stackoverflow.com/users/1318584/cheese5505"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1457079773, "post_id": 35790314, "comment_id": 59252439, "body": "@Volker pretty new to this stuff so no idea what that means sorry, haha. I&#39;m  writing 4 bytes at the start of the file to identify the file, after that a uint16 containing the length of the JSON will be written, after that the JSON will be written and then the rest of the file will continue. It&#39;s a modified audio format."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1457087599, "post_id": 35790314, "comment_id": 59257292, "body": "If you do not know about byte order and that stuff, why are you using binary.Write? Don&#39;t do that."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1457100921, "post_id": 35790314, "comment_id": 59266042, "body": "Start from here: <code>json.NewEncoder(os.Stdout).Encode(Metadata)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 920, "user_id": 1318584, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f62561cb4ac4b1b719ad7e5bedf18675?s=128&d=identicon&r=PG", "display_name": "cheese5505", "link": "https://stackoverflow.com/users/1318584/cheese5505"}, "is_accepted": true, "score": 0, "last_activity_date": 1457215702, "creation_date": 1457215702, "answer_id": 35820548, "question_id": 35790314, "link": "https://stackoverflow.com/questions/35790314/golang-byte-to-php-string/35820548#35820548", "title": "Golang []byte to PHP string", "body": "<p>Sorted this by using:</p>\n\n<pre><code>wbuf.Write(json)\n</code></pre>\n"}], "owner": {"reputation": 920, "user_id": 1318584, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f62561cb4ac4b1b719ad7e5bedf18675?s=128&d=identicon&r=PG", "display_name": "cheese5505", "link": "https://stackoverflow.com/users/1318584/cheese5505"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 35820548, "answer_count": 1, "score": 0, "last_activity_date": 1457215702, "creation_date": 1457076336, "question_id": 35790314, "link": "https://stackoverflow.com/questions/35790314/golang-byte-to-php-string", "title": "Golang []byte to PHP string", "body": "<p>I'm currently writing a <code>[]byte</code> array with Golang to a file (code below). After I have written it to the file, I want to open the file in PHP and read the string. However, since it's encoded I need to use <code>unpack</code>? I'm not sure what format(s) to use.</p>\n\n<p>Here is my Golang code:</p>\n\n<pre><code>var jsonlen uint16\n// 16KB output buffer\nwbuf := bufio.NewWriterSize(os.Stdout, 16384)\n\n// write the magic bytes\nfmt.Print(MagicBytes)\n\n// encode and write json\njson, err := json.Marshal(Metadata)\nif err != nil {\n    fmt.Println(\"Failed to encode the Metadata JSON:\", err)\n    return\n}\njsonlen = uint16(len(json))\n\nerr = binary.Write(wbuf, binary.LittleEndian, &amp;jsonlen)\nif err != nil {\n    fmt.Println(\"error writing output: \", err)\n    return\n}\n\nerr = binary.Write(wbuf, binary.LittleEndian, &amp;json)\nif err != nil {\n    fmt.Println(\"error writing output: \", err)\n    return\n}\n</code></pre>\n\n<p>Haven't written any permanent PHP code yet so don't have any to show here.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 227, "user_id": 5956807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/75aeaea59178a778b256c7435a652fd5?s=128&d=identicon&r=PG", "display_name": "XXXX", "link": "https://stackoverflow.com/users/5956807/xxxx"}, "is_accepted": false, "score": 0, "last_activity_date": 1457096667, "creation_date": 1457096667, "answer_id": 35796830, "question_id": 35789782, "link": "https://stackoverflow.com/questions/35789782/go-build-with-no-buildable-go-source-files-in-error/35796830#35796830", "title": "Go build &quot;with no buildable Go source files in&quot; error", "body": "<p>1st, make sure you <code>sourced</code> your <code>setup</code>. Next, to build something make sure they are <code>package main</code>. If that doesn't work, <code>go get</code> and try again</p>\n"}], "owner": {"reputation": 1001, "user_id": 4160965, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/fbb0ff599a13cc579cbac731d8d38a81?s=128&d=identicon&r=PG&f=1", "display_name": "want_to_be_calm", "link": "https://stackoverflow.com/users/4160965/want-to-be-calm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2151, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1457096667, "creation_date": 1457074336, "question_id": 35789782, "link": "https://stackoverflow.com/questions/35789782/go-build-with-no-buildable-go-source-files-in-error", "title": "Go build &quot;with no buildable Go source files in&quot; error", "body": "<p>I tried to go build a project, however, it always encounter the following error. </p>\n\n<p>Godeps/_workspace/src/github.com/gocql/gocql/helpers.go:14:2: no buildable Go source files in /home/beego/src/mixpanel/releases/20160304055749/Godeps/_workspace/src/gopkg.in/inf.v0</p>\n\n<p>both gocql and inf.v0 are packages that I installed.</p>\n\n<p>I am confused and I cannot find a solution. Please share some hints on it.\nThanks</p>\n"}, {"tags": ["sockets", "go", "docker", "connection"], "comments": [{"owner": {"reputation": 3004, "user_id": 5321002, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LUAAK.jpg?s=128&g=1", "display_name": "Auzias", "link": "https://stackoverflow.com/users/5321002/auzias"}, "edited": false, "score": 2, "creation_date": 1457084124, "post_id": 35788262, "comment_id": 59254895, "body": "<code>What are the requirements to set up a container for TLS connections?</code> same as a regular-host requirement."}], "answers": [{"comments": [{"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1457110677, "post_id": 35788484, "comment_id": 59272940, "body": "Your second link was helpful to a point. I got another web app (that is a server) to work. How can I get it to work on an app that is a client (the app I refer to in this question)? In the app in question, I tried <code>docker run -p $(docker-machine ip):2000:2000 -v $GOPATH&#47;src&#47;path&#47;to&#47;app:&#47;go&#47;src&#47;path&#47;to&#47;app myContainer</code> without success."}, {"owner": {"reputation": 80, "user_id": 3894266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f19dbd43a462ebb814207f97639ee7f7?s=128&d=identicon&r=PG&f=1", "display_name": "bfvanrooyen", "link": "https://stackoverflow.com/users/3894266/bfvanrooyen"}, "reply_to_user": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1457239899, "post_id": 35788484, "comment_id": 59313670, "body": "Please see my edit above. I might be completely wrong on my assumptions. Let me know if it makes a difference or not. If not I&#39;ll try to recreate the situation on my end."}, {"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1457287043, "post_id": 35788484, "comment_id": 59327662, "body": "I haven&#39;t set up port forwarding. And you are correct, I&#39;m trying to make a TCP outgoing connection."}, {"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1457288126, "post_id": 35788484, "comment_id": 59328115, "body": "I updated the question with more information based on the input from this answer."}, {"owner": {"reputation": 80, "user_id": 3894266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f19dbd43a462ebb814207f97639ee7f7?s=128&d=identicon&r=PG&f=1", "display_name": "bfvanrooyen", "link": "https://stackoverflow.com/users/3894266/bfvanrooyen"}, "reply_to_user": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1457343394, "post_id": 35788484, "comment_id": 59346607, "body": "On what port are you attempting the outgoing connection?"}, {"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1457362273, "post_id": 35788484, "comment_id": 59358795, "body": "2500 in reality. I used 2000 as an example. The idea is that I&#39;m using the same port for incoming and outgoing connections."}, {"owner": {"reputation": 80, "user_id": 3894266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f19dbd43a462ebb814207f97639ee7f7?s=128&d=identicon&r=PG&f=1", "display_name": "bfvanrooyen", "link": "https://stackoverflow.com/users/3894266/bfvanrooyen"}, "reply_to_user": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1457511038, "post_id": 35788484, "comment_id": 59433875, "body": "Why are you forwarding a port? Outgoing connections do not require any port forwarding. You cannot use the same port for incoming and outgoing connections on the same ip address."}], "tags": [], "owner": {"reputation": 80, "user_id": 3894266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f19dbd43a462ebb814207f97639ee7f7?s=128&d=identicon&r=PG&f=1", "display_name": "bfvanrooyen", "link": "https://stackoverflow.com/users/3894266/bfvanrooyen"}, "is_accepted": true, "score": 5, "last_activity_date": 1457239609, "last_edit_date": 1457239609, "creation_date": 1457068481, "answer_id": 35788484, "question_id": 35788262, "link": "https://stackoverflow.com/questions/35788262/how-to-make-a-tcp-outgoing-connection-with-docker-container/35788484#35788484", "title": "How to make a TCP outgoing connection with Docker container?", "body": "<p>You are either using boot2docker or docker-machine (since you are running docker on OSX). If you are using boot2docker, you have to forward the ports on VirtualBox as well as docker, have a look at this blog post:\n<a href=\"https://fogstack.wordpress.com/2014/02/09/docker-on-osx-port-forwarding/\" rel=\"noreferrer\">https://fogstack.wordpress.com/2014/02/09/docker-on-osx-port-forwarding/</a></p>\n\n<p>If you are using docker-machine, you have to connect to the docker-machine assigned ip, not localhost, have a look at this post:\n<a href=\"https://github.com/docker/machine/issues/710\" rel=\"noreferrer\">https://github.com/docker/machine/issues/710</a></p>\n\n<p>I see now that you are using docker-machine specifically, so the post about docker-machine should answer your question.</p>\n\n<p>Edit: I misunderstood the question. You are trying to make an outgoing connection on a forwarded port. That is not correct. By default docker can make outgoing connections on any port. The port forwarding is for incoming connections only. Please try again without specifying any ports to forward. My suspicion  is that you are trying to make an outgoing connection on the incoming (forwarded) port.</p>\n"}, {"tags": [], "owner": {"reputation": 2139, "user_id": 208769, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7678cf457f3bcd08972a960104761cf9?s=128&d=identicon&r=PG", "display_name": "user208769", "link": "https://stackoverflow.com/users/208769/user208769"}, "is_accepted": false, "score": 1, "last_activity_date": 1554481337, "creation_date": 1554481337, "answer_id": 55539717, "question_id": 35788262, "link": "https://stackoverflow.com/questions/35788262/how-to-make-a-tcp-outgoing-connection-with-docker-container/55539717#55539717", "title": "How to make a TCP outgoing connection with Docker container?", "body": "<p>I've just had exactly the same problem. Was unable to connect out at all.</p>\n\n<p>Restarted the container, and suddenly outgoing connections worked fine. It's possible that the container survived an update of docker?</p>\n\n<p>Currently using Docker version 18.09.3, build 774a1f4</p>\n"}], "owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17405, "favorite_count": 0, "accepted_answer_id": 35788484, "answer_count": 2, "score": 3, "last_activity_date": 1554481337, "creation_date": 1457067320, "last_edit_date": 1457288703, "question_id": 35788262, "link": "https://stackoverflow.com/questions/35788262/how-to-make-a-tcp-outgoing-connection-with-docker-container", "title": "How to make a TCP outgoing connection with Docker container?", "body": "<p>My Go application makes <a href=\"https://github.com/andradei/quickfix/blob/feature/ssl/connection.go#L75\" rel=\"nofollow noreferrer\">TLS connections via <code>tls.Dial()</code></a> to exchange data.</p>\n\n<p>It works fine when run from the host:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Srmvg.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Srmvg.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>But the outgoing connection doesn't seem to work when the app is run from a Docker container. The app hangs indefinitely.</p>\n\n<p><a href=\"https://i.stack.imgur.com/dIIKM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dIIKM.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Note 1</strong>: Same behavior with using <code>docker run -p $(docker-machine ip):2500:2500 ...</code></p>\n\n<p><strong>Note 2</strong>: VM doesn't have extra port forwarding settings other than the default settings that came with docker-machine's default VM.</p>\n\n<p>Docker image build with Dockerfile:</p>\n\n<pre><code>FROM golang:latest\n\nRUN mkdir -p \"$GOPATH/src/path/to/app\"\n# Install dependencies\nRUN go get github.com/path/to/dep\n\nVOLUME \"$GOPATH/src/path/to/app\"\nEXPOSE 2500\nWORKDIR \"$GOPATH/src/path/to/app\"\nCMD [\"go\", \"run\", \"main.go\"]\n</code></pre>\n\n<p>Host is OS X running <em>docker-machine</em>.</p>\n\n<h2>Question</h2>\n\n<p>How can I make the TCP outgoing connection to work?</p>\n"}, {"tags": ["templates", "go"], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": -2, "last_activity_date": 1457067430, "creation_date": 1457067430, "answer_id": 35788285, "question_id": 35787799, "link": "https://stackoverflow.com/questions/35787799/go-template-calling-method-on-variable-in-template/35788285#35788285", "title": "Go template: calling method on $variable in template", "body": "<p>Just omit the parentheses and it should be fine. Example:</p>\n\n<pre><code>{{ range $key, $value := . }}\n  &lt;a href=\"{{ .Path }}\"&gt;{{ $key }}&lt;/a&gt;\n{{ end }}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 433, "user_id": 5425899, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CG0is.png?s=128&g=1", "display_name": "Elliot E", "link": "https://stackoverflow.com/users/5425899/elliot-e"}, "edited": false, "score": 0, "creation_date": 1457068488, "post_id": 35788366, "comment_id": 59247617, "body": "Thanks, I ended up changing the method to     func (f UpFile) Path() string { return f.path } rather than change the map."}, {"owner": {"reputation": 311, "user_id": 4957046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6e531ff15d53c5177d2ca8d9206b99?s=128&d=identicon&r=PG", "display_name": "exyzzy", "link": "https://stackoverflow.com/users/4957046/exyzzy"}, "edited": false, "score": 0, "creation_date": 1578895468, "post_id": 35788366, "comment_id": 105574041, "body": "Same issue, and same solution. pointers to methods do not appear to work on template variables.Change the method to non-pointer."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 311, "user_id": 4957046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6e531ff15d53c5177d2ca8d9206b99?s=128&d=identicon&r=PG", "display_name": "exyzzy", "link": "https://stackoverflow.com/users/4957046/exyzzy"}, "edited": false, "score": 0, "creation_date": 1578896965, "post_id": 35788366, "comment_id": 105574421, "body": "@exyzzy Pointer receiver methods work on template variables containing pointer values."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1578896901, "last_edit_date": 1578896901, "creation_date": 1457067921, "answer_id": 35788366, "question_id": 35787799, "link": "https://stackoverflow.com/questions/35787799/go-template-calling-method-on-variable-in-template/35788366#35788366", "title": "Go template: calling method on $variable in template", "body": "<p>The <code>Path</code> method is on the pointer receiver:</p>\n\n<pre><code>func (f *UpFile) Path() string { return f.path }\n</code></pre>\n\n<p>The value in <code>$path</code> is a <code>Path</code>. The method <code>Path()</code> cannot be called on a <code>Path</code> because pointer receiver methods are not in the value type's <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">method set</a>.</p>\n\n<p>There are two ways to fix the problem. The first is to declare the method with a value receiver:</p>\n\n<pre><code>func (f UpFile) Path() string { return f.path }\n</code></pre>\n\n<p>The second way to fix the problem is to use <code>*Path</code> values instead of <code>Path</code> values. Change the map to:</p>\n\n<pre><code>var m map[string]*UpFile\n</code></pre>\n"}], "owner": {"reputation": 433, "user_id": 5425899, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CG0is.png?s=128&g=1", "display_name": "Elliot E", "link": "https://stackoverflow.com/users/5425899/elliot-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 821, "favorite_count": 0, "accepted_answer_id": 35788366, "answer_count": 2, "score": 3, "last_activity_date": 1578896901, "creation_date": 1457064318, "last_edit_date": 1457065534, "question_id": 35787799, "link": "https://stackoverflow.com/questions/35787799/go-template-calling-method-on-variable-in-template", "title": "Go template: calling method on $variable in template", "body": "<p>For some reason my template is not working, and I can't tell why. The value of . is a map[string]UpFile where UpFile is a struct with the method Path() which takes no arguments. Here is the relevant part of the template:</p>\n\n<pre><code>{{ range $key, $value := . }}\n&lt;a href=\"{{ $value.Path }}\"&gt;{{ $key }}&lt;/a&gt;\n{{ end }}\n</code></pre>\n\n<p>The template works without the call to Path() on the variable $value. I've also tested the call to Path when the value of . was UpFile and it worked. The go doc on templates says calls to methods on variables is fine. The template compiles and is served however nothing in the range is outputted. When I omit the call to Path() I get a string of characters. Thanks for taking a look.</p>\n\n<p>edit: Using a field from UpFile rather than the Path method provides expected output. Still don't understand why calling Path doesn't work.</p>\n"}, {"tags": ["json", "go", "struct", "compiler-errors"], "answers": [{"comments": [{"owner": {"reputation": 2368, "user_id": 789655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7fac771a6c8fccc82fe34f951b7b3fd?s=128&d=identicon&r=PG", "display_name": "Sthe", "link": "https://stackoverflow.com/users/789655/sthe"}, "edited": false, "score": 1, "creation_date": 1457078275, "post_id": 35787560, "comment_id": 59251737, "body": "Just to elaborate a bit more, the <code>Decode</code> method in your <code>jsonParser</code> object is expecting a pointer (memory address) of the <code>ConfigVars</code> instance to write output to. <code>ConfigVars</code> is a type, meaning it will only be allocated a memory address once an instance of it is created by means of a variable definition. i.e. <code>var cfg ConfigVars</code>"}], "tags": [], "owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "is_accepted": true, "score": 7, "last_activity_date": 1457062981, "creation_date": 1457062981, "answer_id": 35787560, "question_id": 35787463, "link": "https://stackoverflow.com/questions/35787463/golang-type-type-is-not-an-expression-json-config-parsing/35787560#35787560", "title": "Golang: Type [type] is not an expression; json config parsing", "body": "<p>What you're doing there is trying to pass a pointer to the <code>ConfigVars</code> type (which obviously doesn't really mean anything). What you want to do is make a variable whose type is <code>ConfigVars</code> and pass a pointer to that instead:</p>\n\n<pre><code>var cfg ConfigVars\nerr = jsonParser.Decode(&amp;cfg)\n...\n</code></pre>\n"}], "owner": {"reputation": 4017, "user_id": 202184, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/2c987c4ad90011fdca692615603a5bc3?s=128&d=identicon&r=PG", "display_name": "Ben Dauphinee", "link": "https://stackoverflow.com/users/202184/ben-dauphinee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4660, "favorite_count": 1, "accepted_answer_id": 35787560, "answer_count": 1, "score": 1, "last_activity_date": 1457102929, "creation_date": 1457062304, "last_edit_date": 1457102929, "question_id": 35787463, "link": "https://stackoverflow.com/questions/35787463/golang-type-type-is-not-an-expression-json-config-parsing", "title": "Golang: Type [type] is not an expression; json config parsing", "body": "<p>I'm trying to work out a bit of code to pull in config from a JSON file.\nWhen I attempt to build, I get this error</p>\n\n<pre><code>type ConfigVars is not an expression\n</code></pre>\n\n<p>Below is the config and program code I'm trying to work with. Every example I've found so far is similar to the below code. Any suggestion of what I'm doing incorrectly?</p>\n\n<pre><code>-- Config File\n{\"beaconUrl\":\"http://test.com/?id=1\"}\n\n-- Program Code\npackage main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n)\n\n\ntype ConfigVars struct {\n    BeaconUrl   string\n}\n\n\nfunc main() {\n    configFile, err := os.Open(\"config.json\")\n    defer configFile.Close()\n    if err != nil {\n        fmt.Println(\"Opening config file\", err.Error())\n    }\n\n    jsonParser := json.NewDecoder(configFile)\n    if err = jsonParser.Decode(&amp;ConfigVars); err != nil {\n        fmt.Println(\"Parsing config file\", err.Error())\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "tcp", "tcpserver"], "answers": [{"comments": [{"owner": {"reputation": 2712, "user_id": 3902473, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/IRlSJ.png?s=128&g=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/3902473/momo"}, "edited": false, "score": 0, "creation_date": 1457055700, "post_id": 35786294, "comment_id": 59244277, "body": "Using NewReader(conn) indeed works, but I had to use &quot;ReadUvarInt(br)&quot; in order to get a proper value."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 2712, "user_id": 3902473, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/IRlSJ.png?s=128&g=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/3902473/momo"}, "edited": false, "score": 0, "creation_date": 1457055976, "post_id": 35786294, "comment_id": 59244326, "body": "@Momo Question says varint, not uvarint. Update the question to describe your data. I&#39;ll update the answer."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1457056009, "last_edit_date": 1457056009, "creation_date": 1457054405, "answer_id": 35786294, "question_id": 35786264, "link": "https://stackoverflow.com/questions/35786264/reading-the-first-uvarint-of-a-net-conn-buffer/35786294#35786294", "title": "Reading the first UVarInt of a net.Conn buffer", "body": "<p>Wrap the connection with a <a href=\"https://godoc.org/bufio#Reader\" rel=\"nofollow\">bufio.Reader</a>:</p>\n\n<pre><code>br := bufio.NewReader(conn)\n</code></pre>\n\n<p>Use the binary package to <a href=\"https://godoc.org/encoding/binary#ReadUvarInt\" rel=\"nofollow\">read an unsigned varint</a> through the bufio.Reader:</p>\n\n<pre><code>n, err := binary. ReadUvarInt(br)\n</code></pre>\n\n<p>Because the bufio.Reader can buffer more than the varint, you should use the bufio.Reader for all subsequent reads on the connection.   </p>\n"}], "owner": {"reputation": 2712, "user_id": 3902473, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/IRlSJ.png?s=128&g=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/3902473/momo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 35786294, "answer_count": 1, "score": 1, "last_activity_date": 1457057206, "creation_date": 1457054199, "last_edit_date": 1457057206, "question_id": 35786264, "link": "https://stackoverflow.com/questions/35786264/reading-the-first-uvarint-of-a-net-conn-buffer", "title": "Reading the first UVarInt of a net.Conn buffer", "body": "<p>I have a TCP packet connection (<code>net.Conn</code>) set up by listening on a port.</p>\n\n<pre><code>conn, err := ln.Accept()\n</code></pre>\n\n<p>I need to read the first <strong>UVarInt</strong> of the <code>Conn.Read([]byte)</code> buffer, which starts at index 0.</p>\n\n<p>Previously, I would only need the first byte, which is easy to do using</p>\n\n<pre><code>packetSize := make([]byte, 1)\nconn.Read(packetSize)\n// Do stuff with packetSize[0]\n</code></pre>\n\n<p>However, as previously mentioned, I need to get the first UVarInt I can reach using the net.Conn.Read() method. Keep in  mind that a UVarInt can have pretty much any length, which I cannot be sure of (the client doesn't send the size of the UVarInt). I do know however that the UVarInt starts at the very beginning of the buffer.</p>\n"}, {"tags": ["go", "docker"], "comments": [{"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 2, "creation_date": 1457046875, "post_id": 35784761, "comment_id": 59241263, "body": "I don&#39;t think there is. It&#39;s very platform specific and requires dealing with syscalls or connecting to special sockets. It&#39;s not that easy even in C. It will be much easier to just execute something depending on OS and parse it&#39;s output."}, {"owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1457557955, "post_id": 35784761, "comment_id": 59465754, "body": "Could you give an example? All of our go code will either be ran in a ubuntu environment or a docker."}], "owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1457049577, "creation_date": 1457045936, "question_id": 35784761, "link": "https://stackoverflow.com/questions/35784761/find-default-network-route-ip-address", "title": "Find default network route IP address", "body": "<p>How can I find the default network route IP address from Go? I have looked through the docs for the net and interfaces package but didn't see anything that could do this. I wanted to avoid running a bash command if possible. </p>\n"}, {"tags": ["go", "docker", "docker-compose", "docker-machine"], "answers": [{"tags": [], "owner": {"reputation": 24, "user_id": 6017333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jSDIw.jpg?s=128&g=1", "display_name": "Septiaji Purwono Rahardjo", "link": "https://stackoverflow.com/users/6017333/septiaji-purwono-rahardjo"}, "is_accepted": false, "score": 0, "last_activity_date": 1457083549, "creation_date": 1457083549, "answer_id": 35792292, "question_id": 35783562, "link": "https://stackoverflow.com/questions/35783562/golang-continous-workflow-with-docker/35792292#35792292", "title": "Golang continous workflow with docker", "body": "<p>Using wercker for local development will save you from rebuilding the container entirely on your machine. You can use <code>wercker dev</code> with <code>internal watch</code> and set the value <code>reload:true</code>. You can check the docs here <a href=\"http://devcenter.wercker.com/quickstarts/building/golang.html\" rel=\"nofollow\">Go wercker local development</a> and this blog post <a href=\"http://blog.wercker.com/2015/05/15/Introducing-local-development.html\" rel=\"nofollow\">Introducing local development with wercker</a></p>\n"}], "owner": {"reputation": 971, "user_id": 2202757, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/U5NGN.jpg?s=128&g=1", "display_name": "sh0umik", "link": "https://stackoverflow.com/users/2202757/sh0umik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 442, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457083549, "creation_date": 1457041070, "question_id": 35783562, "link": "https://stackoverflow.com/questions/35783562/golang-continous-workflow-with-docker", "title": "Golang continous workflow with docker", "body": "<p>What is the best and simple way to do continuous development with docker and golang . What i am concern about is compiling and running and building docker images again when i change some code in golang . </p>\n\n<p>I am using docker container inside docker machine without swarm and building containers with docker compose . Pretty simple strategy . Everything works fine . Just cant figure out the way to compile , build and run changed golang code instantly in running docker container without rebuilding the container again with static binary .</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "edited": false, "score": 1, "creation_date": 1457049341, "post_id": 35782213, "comment_id": 59242193, "body": "gofmt isn&#39;t meant for this and it can&#39;t do this. Try some tool made for this purpose, such as sed. Or even better: just write correct Go code in the first place. What&#39;s so special about single quotes?"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 3, "last_activity_date": 1457039346, "last_edit_date": 1457039346, "creation_date": 1457037904, "answer_id": 35782689, "question_id": 35782213, "link": "https://stackoverflow.com/questions/35782213/how-to-use-gofmt-to-replace-single-quote-with-double-quote/35782689#35782689", "title": "How to use gofmt to replace single quote with double quote", "body": "<blockquote>\n<pre><code>$ go doc cmd/gofmt\n</code></pre>\n  \n  <p>Gofmt formats Go programs. </p>\n  \n  <p>The flags are:</p>\n\n<pre><code>-r rule\n  Apply the rewrite rule to the source before reformatting.\n</code></pre>\n  \n  <p>The rewrite rule specified with the -r flag must be a string of the\n  form:</p>\n\n<pre><code>pattern -&gt; replacement\n</code></pre>\n  \n  <p>Both pattern and replacement must be valid Go expressions. In the\n  pattern, single-character lowercase identifiers serve as wildcards\n  matching arbitrary sub-expressions; those expressions will be\n  substituted for the same identifiers in the replacement.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Expressions\" rel=\"nofollow\">Expressions</a></p>\n  \n  <p>An expression specifies the computation of a value by applying\n  operators and functions to operands.</p>\n</blockquote>\n\n<hr>\n\n<p>Both pattern and replacement must be valid Go expressions.</p>\n"}], "owner": {"reputation": 27, "user_id": 5382437, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-3EPDwlGfSz8/AAAAAAAAAAI/AAAAAAAAAEA/cD29oLPZ5tA/photo.jpg?sz=128", "display_name": "Black Sun", "link": "https://stackoverflow.com/users/5382437/black-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1457040270, "creation_date": 1457036422, "last_edit_date": 1457040270, "question_id": 35782213, "link": "https://stackoverflow.com/questions/35782213/how-to-use-gofmt-to-replace-single-quote-with-double-quote", "title": "How to use gofmt to replace single quote with double quote", "body": "<p>I use go 1.6 and I love using single quotes. After I finish editing my file, in my terminal I'd like to use gofmt for replacing them, but nothing works.</p>\n\n<pre><code>    gofmt -r \"'-&gt;\\\"\" book.go\n    parsing pattern ' at 1:1: rune literal not terminated\n</code></pre>\n\n<p>I use zsh.</p>\n"}, {"tags": ["http", "go", "handler"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1457035510, "post_id": 35781571, "comment_id": 59235142, "body": "Related: <a href=\"http://stackoverflow.com/questions/27945310/why-do-i-need-to-use-http-stripprefix-to-access-my-static-files\">Why do I need to use http.StripPrefix to access my static files?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "is_accepted": true, "score": 0, "last_activity_date": 1457045598, "last_edit_date": 1457045598, "creation_date": 1457045082, "answer_id": 35784554, "question_id": 35781571, "link": "https://stackoverflow.com/questions/35781571/go-http-difference-between-serving-static-and-static/35784554#35784554", "title": "Go http: difference between serving /static and /static/", "body": "<p><code>http.Handle(\"/static\", http.StripPrefix(\"/static\", fs))</code> registers a <strong>fixed name</strong> pattern. </p>\n\n<p><code>http.Handle(\"/static/\", http.StripPrefix(\"/static/\", fs))</code> registers a <strong>rooted subtree</strong> pattern. </p>\n\n<p>The former matches only requests where <code>URL.path = \"/static\"</code>. The latter matches every path that starts with <code>\"/static/\"</code>. The <code>404</code> indicates that it could not match any pattern for the given request, not that the requested file wasn't found. (It does not even get to execute the <code>FileServer</code>'s handler!)</p>\n\n<hr>\n\n<p>And to answer your first question:</p>\n\n<pre><code>&lt;script src=\"/static/myscript.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>URLs starting with a slash <code>/</code> are <strong>absolute</strong>. That means it does not matter on what page you are, it will always append to the domain name e.g. <code>example.com/some/page</code> + <code>/static/myscript.js</code> = <code>example.com/static/myscript.js</code></p>\n\n<pre><code>&lt;script src=\"static/myscript.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>Is a <strong>relative</strong> path. That means it will be appended to URL of the currently visited page e.g. <code>example.com/some/page</code> + <code>static/myscript.js</code> = <code>example.com/some/page/static/myscript.js</code></p>\n"}], "owner": {"reputation": 737, "user_id": 5998704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2bb384518ab3b658ffe63bac77bafddf?s=128&d=identicon&r=PG&f=1", "display_name": "rodrigolece", "link": "https://stackoverflow.com/users/5998704/rodrigolece"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 35784554, "answer_count": 1, "score": 0, "last_activity_date": 1457045598, "creation_date": 1457034261, "question_id": 35781571, "link": "https://stackoverflow.com/questions/35781571/go-http-difference-between-serving-static-and-static", "title": "Go http: difference between serving /static and /static/", "body": "<p>I have a terrible confusion concerning <code>http.FileServer</code> and slashes.</p>\n\n<p>I need to serve a script to a html page. In the directory I'm working I have the page <code>index.html</code> and I have a <code>static</code> directory with <code>myscript.js</code> inside of it.</p>\n\n<p>First question: is it correct to write</p>\n\n<pre><code>&lt;script src=\"/static/myscript.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>? I have also seen <code>src=\"static/myscript.js\"</code> and I don't know if there is a reason for using one or the other (but I guess it influences the handler we have to write on the server).</p>\n\n<p>Let's suppose we settle for the first version. Second question: on the server side, I want to register the handler for directory <code>static</code>. Inspired by <a href=\"https://stackoverflow.com/questions/28793619/golang-what-to-use-http-servefile-or-http-fileserver\">this example</a>, I do:</p>\n\n<pre><code>fs := http.FileServer(http.Dir(\"./static\"))\nhttp.Handle(\"/static\", http.StripPrefix(\"/static\", fs))\n</code></pre>\n\n<p>but I get a <code>404</code>. However, if I use:</p>\n\n<pre><code>fs := http.FileServer(http.Dir(\"./static\"))\nhttp.Handle(\"/static/\", http.StripPrefix(\"/static/\", fs))\n</code></pre>\n\n<p>with the ending slashes, it works fine!</p>\n\n<p>I'm really new to web servers, so I would appreciate any explanation that includes what are the actual addresses passed around by functions. For example, I don't know (and I can't figure it out from the <code>net/http</code> documentation ) what is the  address that is passed to the handler when serving a <code>/static</code> request. I guess it's <code>/static/myscript.js</code> since we are using <code>http.StripPrefix</code> but I have no actual way of proving it.</p>\n"}, {"tags": ["mysql", "go"], "answers": [{"comments": [{"owner": {"reputation": 11009, "user_id": 926988, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/65e075e9b0046ba87908d3561e810ba6?s=128&d=identicon&r=PG", "display_name": "zupa", "link": "https://stackoverflow.com/users/926988/zupa"}, "edited": false, "score": 2, "creation_date": 1457087020, "post_id": 35781762, "comment_id": 59256901, "body": "Thank you for your effort jersten. I was puzzled whether it should work at all, you helped resolving that ambiguity thus I accept the answer. I did not post a very thorough question, and indeed it turns out my question did not contain the issue. It turns out I wanted to pass in the table name as well, which does not seem to be supported. I put together a full working example for anyone&#39;s reference. Thanks again! <a href=\"https://play.golang.org/p/VHTB2zddjl\" rel=\"nofollow noreferrer\">play.golang.org/p/VHTB2zddjl</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1529891"}, "is_accepted": true, "score": 0, "last_activity_date": 1457035280, "last_edit_date": 1457035280, "creation_date": 1457034909, "answer_id": 35781762, "question_id": 35781555, "link": "https://stackoverflow.com/questions/35781555/golang-mysql-exec-placeholder-not-expanded/35781762#35781762", "title": "golang mysql exec placeholder &quot;?&quot; not expanded", "body": "<p>You're (probably) not telling it to use the mysql driver;</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", connString)\n</code></pre>\n\n<p>Here is some of my sample code:</p>\n\n<pre><code>var query = \"INSERT IGNORE INTO blah (`col1`, `col2`, `col3`) VALUES (?, ?, ?)\"\n\nr, err := db.Query(query, some_data_1, some_data_2, some_data_3)\n\n// Failure when trying to store data\nif err != nil {\n    msg := fmt.Sprintf(\"fail : %s\", err.Error())\n    fmt.Println(msg)\n\n    return err\n}\n\nr.Close() // Always do this or you will leak connections\n</code></pre>\n\n<p>I create the MySQL pool (yes, it's a pool <strong>NOT</strong> a connection) with:</p>\n\n<pre><code>import (\n    // mysql driver\n    _ \"github.com/go-sql-driver/mysql\"\n\n    \"database/sql\"\n    \"fmt\"\n)\n\nconnString := fmt.Sprintf(\"%s:%s@(%s:%d)/%s?timeout=30s\",\n    user,\n    password,\n    host,\n    port,\n    database,\n)\n\ndb, err := sql.Open(\"mysql\", connString)\n\nif err != nil {\n    return nil, err\n}\n\nerr = db.Ping() // test the pool connection(s)\n\nif err != nil {\n    return nil, err\n}\n\nreturn db, nil // No error, return the pool connections\n</code></pre>\n\n<p>I also highly suggest you print out any errors in the database connection process and query process. It could be that you are using the driver, but you lack permissions, the database is down, etc.</p>\n"}], "owner": {"reputation": 11009, "user_id": 926988, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/65e075e9b0046ba87908d3561e810ba6?s=128&d=identicon&r=PG", "display_name": "zupa", "link": "https://stackoverflow.com/users/926988/zupa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2192, "favorite_count": 0, "accepted_answer_id": 35781762, "answer_count": 1, "score": 0, "last_activity_date": 1457035280, "creation_date": 1457034185, "question_id": 35781555, "link": "https://stackoverflow.com/questions/35781555/golang-mysql-exec-placeholder-not-expanded", "title": "golang mysql exec placeholder &quot;?&quot; not expanded", "body": "<p>I feel like I must be totally missing the point.\nI try to run something along the lines of the example below, but the <code>?</code> is not expanded into the argument passed in. </p>\n\n<pre><code>import (\n    \"database/sql\"\n    _ \"github.com/go-sql-driver/mysql\"\n)\n\ndb, err := sql.Open(...)\nif err != nil { ... }\n_, err = db.Query(\"SELECT * FROM foo WHERE bar=?\", bar)\n</code></pre>\n\n<p>Also, who's concern is expanding it? it show's up in the <a href=\"https://golang.org/pkg/database/sql/#example_DB_Query\" rel=\"nofollow\">doc</a> of <code>database/sql</code> but other conversations hinted it may be the concern of the driver.</p>\n\n<p>What am I missing? Any pointer in the right direction is greatly appreciated.</p>\n"}, {"tags": ["arrays", "go", "random", "slice"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1457077249, "post_id": 35781197, "comment_id": 59251214, "body": "1. You have a byte slice (not an array). 2. Don&#39;t worry about efficiency until needed. 3.) Consider crypto/rand instead of math/rand (or seed math/rand from crypto/rand occasionally). 4) io.ReadFull is handy."}], "answers": [{"comments": [{"owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "edited": false, "score": 1, "creation_date": 1457034735, "post_id": 35781334, "comment_id": 59234706, "body": "<code>rand.Read</code> always returns <code>nil</code> error, so there&#39;s no need to handle it - even if it&#39;s a respectable habit... :)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "edited": false, "score": 0, "creation_date": 1457035326, "post_id": 35781334, "comment_id": 59235040, "body": "@Aedolon Yeah, just added that."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 13, "last_activity_date": 1564688797, "last_edit_date": 1564688797, "creation_date": 1457033479, "answer_id": 35781334, "question_id": 35781197, "link": "https://stackoverflow.com/questions/35781197/generating-a-random-fixed-length-byte-array-in-go/35781334#35781334", "title": "Generating a random, fixed-length byte array in Go", "body": "<p>Go 1.6 added a new function to the <a href=\"https://golang.org/pkg/math/rand/\" rel=\"nofollow noreferrer\"><code>math/rand</code></a> package:</p>\n\n<pre><code>func Read(p []byte) (n int, err error)\n</code></pre>\n\n<p>which fills the passed <code>byte</code> slice with random data. Using this <a href=\"https://golang.org/pkg/math/rand/#Read\" rel=\"nofollow noreferrer\"><code>rand.Read()</code></a>:</p>\n\n<pre><code>token := make([]byte, 4)\nif _, err := rand.Read(token); err != nil {\n    // Handle err\n}\nfmt.Println(token)\n</code></pre>\n\n<p><code>rand.Read()</code> has 2 return values: the number of \"read\" bytes and an (optional) <a href=\"https://golang.org/pkg/builtin/#error\" rel=\"nofollow noreferrer\"><code>error</code></a>. This is to conform with the general <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\"><code>io.Reader</code></a> interface, but the documentation of <code>rand.Read()</code> states that (despite its signature) it will never actually return a non-<code>nil</code> error, so we may omit checking it, which simplifies it to this:</p>\n\n<pre><code>token := make([]byte, 4)\nrand.Read(token)\nfmt.Println(token)\n</code></pre>\n\n<p>Don't forget to call <a href=\"https://golang.org/pkg/math/rand/#Seed\" rel=\"nofollow noreferrer\"><code>rand.Seed()</code></a> to properly initialize it before you use the <code>math/rand</code> package, e.g.:</p>\n\n<pre><code>rand.Seed(time.Now().UnixNano())\n</code></pre>\n\n<p>Note: Prior to Go 1.6 there was no <code>math/rand.Read()</code> function, but there was (and still is) a <a href=\"https://golang.org/pkg/crypto/rand/#Read\" rel=\"nofollow noreferrer\"><code>crypto/rand.Read()</code></a> function, but the <a href=\"https://golang.org/pkg/crypto/rand/\" rel=\"nofollow noreferrer\"><code>crypto/rand</code></a> package implements a cryptographically secure pseudorandom number generator, so it is much slower than <code>math/rand</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 6245052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c04962a00b4557f2ce692e756c219352?s=128&d=identicon&r=PG&f=1", "display_name": "QIFENG LI", "link": "https://stackoverflow.com/users/6245052/qifeng-li"}, "edited": false, "score": 0, "creation_date": 1581146808, "post_id": 35781353, "comment_id": 106340314, "body": "call rand.Seed() before rand.Read, otherwise you will get the same output each run"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 47, "last_activity_date": 1457035817, "last_edit_date": 1457035817, "creation_date": 1457033535, "answer_id": 35781353, "question_id": 35781197, "link": "https://stackoverflow.com/questions/35781197/generating-a-random-fixed-length-byte-array-in-go/35781353#35781353", "title": "Generating a random, fixed-length byte array in Go", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/math/rand/\" rel=\"noreferrer\">Package rand</a></p>\n\n<pre><code>import \"math/rand\" \n</code></pre>\n  \n  <p><a href=\"https://golang.org/pkg/math/rand/#Read\" rel=\"noreferrer\">func Read</a></p>\n\n<pre><code>func Read(p []byte) (n int, err error)\n</code></pre>\n  \n  <p>Read generates len(p) random bytes from the default Source and writes\n  them into p. It always returns len(p) and a nil error.</p>\n  \n  <p>f<a href=\"https://golang.org/pkg/math/rand/#Rand.Read\" rel=\"noreferrer\">unc (*Rand) Read</a></p>\n\n<pre><code>func (r *Rand) Read(p []byte) (n int, err error)\n</code></pre>\n  \n  <p>Read generates len(p) random bytes and writes them into p. It always\n  returns len(p) and a nil error.</p>\n</blockquote>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"math/rand\"\n    \"fmt\"\n)\n\nfunc main() {\n    token := make([]byte, 4)\n    rand.Read(token)\n    fmt.Println(token)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[187 163 35 30]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1563, "user_id": 1619003, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wKhdR.png?s=128&g=1", "display_name": "GraphicalDot", "link": "https://stackoverflow.com/users/1619003/graphicaldot"}, "is_accepted": false, "score": 10, "last_activity_date": 1554836860, "last_edit_date": 1554836860, "creation_date": 1534929485, "answer_id": 51963547, "question_id": 35781197, "link": "https://stackoverflow.com/questions/35781197/generating-a-random-fixed-length-byte-array-in-go/51963547#51963547", "title": "Generating a random, fixed-length byte array in Go", "body": "<p>Using math.Rand means that you are using the system CSPRNG that your operating system provides. This means using /dev/urandom/ and Windows\u2019 CryptGenRandom API.\nGo\u2019s crypto/rand package, thankfully, abstracts these implementation details away to minimise the risk of getting it wrong.</p>\n\n<pre><code>import(\n   \"crypto/rand\"\n   \"encoding/base64\"\n )\n\n// GenerateRandomBytes returns securely generated random bytes. \n// It will return an error if the system's secure random\n// number generator fails to function correctly, in which\n// case the caller should not continue.\nfunc GenerateRandomBytes(n int) ([]byte, error) {\n     b := make([]byte, n)\n    _, err := rand.Read(b)\n    // Note that err == nil only if we read len(b) bytes.\n    if err != nil {\n       return nil, err\n   }\n\n   return b, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 2712, "user_id": 3902473, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/IRlSJ.png?s=128&g=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/3902473/momo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29269, "favorite_count": 5, "accepted_answer_id": 35781353, "answer_count": 3, "score": 30, "last_activity_date": 1564688797, "creation_date": 1457033065, "last_edit_date": 1531598718, "question_id": 35781197, "link": "https://stackoverflow.com/questions/35781197/generating-a-random-fixed-length-byte-array-in-go", "title": "Generating a random, fixed-length byte array in Go", "body": "<p>I have a byte array, with a fixed length of 4.</p>\n\n<pre><code>token := make([]byte, 4)\n</code></pre>\n\n<p>I need to set each byte to a random byte. How can I do so, in the most efficient matter? The <code>math/rand</code> methods do not provide a Random Byte function, as far as I am concerned. </p>\n\n<p>Perhaps there is a built-in way, or should I go with generating a random string and converting it to a byte array?</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "is_accepted": false, "score": 0, "last_activity_date": 1457077555, "creation_date": 1457077555, "answer_id": 35790649, "question_id": 35780199, "link": "https://stackoverflow.com/questions/35780199/using-grpc-with-latest-appengine-sdk-golang-1-4-2/35790649#35790649", "title": "Using grpc with latest appengine sdk (golang 1.4.2)", "body": "<p>This turned out to be an issue with my local configuration somehow:</p>\n\n<p>Just for the record...</p>\n\n<p><strong>davidk-osx:Desktop davidk$ more ~/.bash_profile</strong></p>\n\n<blockquote>\n  <p>export GOROOT=/usr/local/go\n  export PATH=$PATH:$GOROOT/bin\n  export GOPATH=/Users/davidk/Documents/golang\n  export PATH=$GOPATH/bin:$PATH</p>\n</blockquote>\n\n<p><strong>davidk-osx:Desktop davidk$ go version</strong></p>\n\n<blockquote>\n  <p>go version go1.6 darwin/amd64</p>\n</blockquote>\n\n<p><strong>davidk-osx:Desktop davidk$ /Applications/go_appengine/goapp version</strong></p>\n\n<blockquote>\n  <p>go version go1.4.2 (appengine-1.9.33) darwin/amd64</p>\n</blockquote>\n\n<p><strong>davidk-osx:Desktop davidk$ mkdir ./TEMP_GOPATH</strong>\n<strong>davidk-osx:Desktop davidk$ export GOPATH=/Users/davidk/Desktop/TEMP_GOPATH</strong>\n<strong>davidk-osx:Desktop davidk$ go get google.golang.org/grpc</strong>\n<strong>davidk-osx:Desktop davidk$ go get google.golang.org/cloud/storage</strong></p>\n\n<p>(i.e. everything is fine, but then...)</p>\n\n<p><strong>davidk-osx:Desktop davidk$ export GOPATH=/Users/davidk/Documents/golang</strong>\n<strong>davidk-osx:Desktop davidk$ go get google.golang.org/grpc</strong></p>\n\n<blockquote>\n  <p># google.golang.org/grpc/transport\n  ../Documents/golang/src/google.golang.org/grpc/transport/http2_client.go:678: undefined: http2.MetaHeadersFrame\n  ../Documents/golang/src/google.golang.org/grpc/transport/http2_client.go:774: undefined: http2.MetaHeadersFrame\n  ../Documents/golang/src/google.golang.org/grpc/transport/http2_server.go:140: undefined: http2.MetaHeadersFrame\n  ../Documents/golang/src/google.golang.org/grpc/transport/http2_server.go:253: undefined: http2.MetaHeadersFrame\n  ../Documents/golang/src/google.golang.org/grpc/transport/http_util.go:279: f.fr.ReadMetaHeaders undefined (type *http2.Framer has no field or method ReadMetaHeaders)\n  davidk-osx:Desktop davidk$</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 4706966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87783d48f814a3408b91c481cce250e8?s=128&d=identicon&r=PG&f=1", "display_name": "very", "link": "https://stackoverflow.com/users/4706966/very"}, "is_accepted": false, "score": 2, "last_activity_date": 1476780738, "creation_date": 1476780738, "answer_id": 40103707, "question_id": 35780199, "link": "https://stackoverflow.com/questions/35780199/using-grpc-with-latest-appengine-sdk-golang-1-4-2/40103707#40103707", "title": "Using grpc with latest appengine sdk (golang 1.4.2)", "body": "<p>update the http2 package using </p>\n\n<pre><code>go get -u golang.org/x/net/http2\n</code></pre>\n\n<p>from the description of go commands (<a href=\"https://golang.org/cmd/go/\" rel=\"nofollow\">https://golang.org/cmd/go/</a>):</p>\n\n<blockquote>\n  <p>The -u flag instructs get to use the network to update the named\n  packages and their dependencies. By default, get uses the network to\n  check out missing packages but does not use it to look for updates to\n  existing packages.</p>\n</blockquote>\n"}], "owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1476780738, "creation_date": 1457030056, "last_edit_date": 1457030847, "question_id": 35780199, "link": "https://stackoverflow.com/questions/35780199/using-grpc-with-latest-appengine-sdk-golang-1-4-2", "title": "Using grpc with latest appengine sdk (golang 1.4.2)", "body": "<p>Using latest appengine SDK which is go version 1.4.2 under the hood:</p>\n\n<p><code>go get google.golang.org/grpc</code> fails due to dependency on http2 which evidently doesn't work with the current appengine sdk release. Seems http2 stuff is only available only from 1.6+:</p>\n\n<blockquote>\n  <p>from Go 1.6 and later</p>\n</blockquote>\n\n<p>(ref: <a href=\"https://godoc.org/golang.org/x/net/http2\" rel=\"nofollow\">https://godoc.org/golang.org/x/net/http2</a>)</p>\n\n<p>calling <code>go get golang.org/x/net/http2</code> did not fix the errors</p>\n\n<p>While I originally caught this in working with google cloud storage, seems it's used throughout this library:  <a href=\"https://github.com/GoogleCloudPlatform/gcloud-golang/search?utf8=%E2%9C%93&amp;q=grpc\" rel=\"nofollow\">https://github.com/GoogleCloudPlatform/gcloud-golang/search?utf8=%E2%9C%93&amp;q=grpc</a></p>\n"}, {"tags": ["csv", "go", "file-writing"], "comments": [{"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 6, "creation_date": 1457026741, "post_id": 35778958, "comment_id": 59229953, "body": "Have you read the documentation for the tabwriter package ? Its stated purpose is explicitely to write aligned text using whitespaces. You probably want to use the <code>csv</code> package instead (<a href=\"https://golang.org/pkg/encoding/csv/#Writer\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/csv/#Writer</a>)."}], "answers": [{"comments": [{"owner": {"reputation": 1591, "user_id": 622121, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb5b05a7391cfa97fc9016ce95471ee?s=128&d=identicon&r=PG", "display_name": "Kenji Noguchi", "link": "https://stackoverflow.com/users/622121/kenji-noguchi"}, "edited": false, "score": 1, "creation_date": 1538784250, "post_id": 40348708, "comment_id": 92278655, "body": "csv writer is not a right choice to write tsv file because the writer wraps fields in double quotes &quot;&quot; when the field value contains &quot;.   There doesn&#39;t seem to be an option to turn off this wrapping in the csv module."}, {"owner": {"reputation": 1056, "user_id": 4154706, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/b91e34f88755d8517830e1389972fb18?s=128&d=identicon&r=PG", "display_name": "aitchkhan", "link": "https://stackoverflow.com/users/4154706/aitchkhan"}, "edited": false, "score": 0, "creation_date": 1539369194, "post_id": 40348708, "comment_id": 92491895, "body": "Havent tested it. but won&#39;t setting <code>LazyQuotes</code> to true would fix this?"}], "tags": [], "owner": {"reputation": 111, "user_id": 3848898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f050100babdef567ae82312c704681b1?s=128&d=identicon&r=PG", "display_name": "hauva69", "link": "https://stackoverflow.com/users/3848898/hauva69"}, "is_accepted": false, "score": 11, "last_activity_date": 1477940060, "creation_date": 1477940060, "answer_id": 40348708, "question_id": 35778958, "link": "https://stackoverflow.com/questions/35778958/writing-tab-separated-values-in-go/40348708#40348708", "title": "Writing tab separated values in Go", "body": "<p>As SirDarius suggested encoding/csv is indeed the right choice. All you have to do is to set the Comma to a horizontal tab instead of the default value, which unsurprisingly is comma.</p>\n\n<pre><code>package tabulatorseparatedvalues\n\nimport (\n    \"encoding/csv\"\n    \"io\"\n)\n\nfunc NewWriter(w io.Writer) (writer *csv.Writer) {\n    writer = csv.NewWriter(w)\n    writer.Comma = '\\t'\n\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 223, "user_id": 3502035, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1918db6efe80204a2a26c8ef590e9c04?s=128&d=identicon&r=PG&f=1", "display_name": "user3502035", "link": "https://stackoverflow.com/users/3502035/user3502035"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6524, "favorite_count": 2, "answer_count": 1, "score": 7, "last_activity_date": 1477940060, "creation_date": 1457026120, "question_id": 35778958, "link": "https://stackoverflow.com/questions/35778958/writing-tab-separated-values-in-go", "title": "Writing tab separated values in Go", "body": "<p>I'm trying to write tab separated values in a file using the <a href=\"https://golang.org/pkg/text/tabwriter/\" rel=\"noreferrer\">tabwriter</a> package in Go.</p>\n\n<pre><code>records map[string] []string\nfile, err := os.OpenFile(some_file,  os.O_CREATE|os.O_WRONLY, 0644)\nif err != nil {\n    log.Println(err)\n}\nw := new(tabwriter.Writer)\nw.Init(file, 0, 4, 0, '\\t', 0)\nfor _, v := range records {\n    fmt.Fprintln(w, v[0],\"\\t\",v[1],\"\\t\",v[2],\"\\t\",v[3])\n    w.Flush()\n}\n</code></pre>\n\n<p>The problem I'm facing is that the records written to the file have two additional spaces prepended to them. I added the debug flag and this is what I get in the file:</p>\n\n<pre><code>fname1  | mname1  | lname1      | age1\nfname2  | mname2  | lname2      | age2\n</code></pre>\n\n<p>I'm unable to see where I'm going wrong. Any help is appreciated.</p>\n"}, {"tags": ["opengl", "go", "glfw"], "comments": [{"owner": {"reputation": 3343, "user_id": 2718864, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/3qOW3.png?s=128&g=1", "display_name": "nasser-sh", "link": "https://stackoverflow.com/users/2718864/nasser-sh"}, "edited": false, "score": 0, "creation_date": 1457015130, "post_id": 35774594, "comment_id": 59220911, "body": "Have you run it through a debugger? Are the values of the vertices the same as the ones in the file?"}], "answers": [{"tags": [], "owner": {"reputation": 1725, "user_id": 1351828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a351d561f75641e458ce8f6dfd5b5227?s=128&d=identicon&r=PG", "display_name": "Adrian Krupa", "link": "https://stackoverflow.com/users/1351828/adrian-krupa"}, "is_accepted": false, "score": 3, "last_activity_date": 1457015218, "creation_date": 1457015218, "answer_id": 35774866, "question_id": 35774594, "link": "https://stackoverflow.com/questions/35774594/error-drawing-model-in-opengl/35774866#35774866", "title": "Error drawing model in opengl", "body": "<p>You should read all vertices data into array. Obj file contains information about triangles, and how vertices should be indexed. Lines starting with <code>f</code> contains 3 numbers which describes triangles. So your code should look like this (I don't know go):</p>\n\n<pre><code>var vertices [1000*3] float32\nfor scanner.Scan() {\n    var i=0\n    var v0, v1, v2 float32\n    var vv byte\n    t := strings.Split(scanner.Text(), \" \")\n    line := scanner.Text()\n    fmt.Sscanf(line, \"%c %f %f %f\", &amp;vv, &amp;v0, &amp;v1, &amp;v2)\n    if vv == \"v\" {\n        vertices[i] = v0\n        vertices[i+1] = v1\n        vertices[i+2] = v2\n    }\n    i = i+3\n}\ngl.Begin(gl.TRIANGLES)\nfor scanner.Scan() {\n    var v0, v1, v2 int\n    var vv byte\n    t := strings.Split(scanner.Text(), \" \")\n    line := scanner.Text()\n    fmt.Sscanf(line, \"%c %d %d %d\", &amp;vv, &amp;v0, &amp;v1, &amp;v2)\n    if vv == \"f\" {\n        gl.Vertex3f(vertices[v0], vertices[v1], vertices[v2])\n    }\n}\ngl.End()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "is_accepted": false, "score": 1, "last_activity_date": 1457015451, "creation_date": 1457015451, "answer_id": 35774950, "question_id": 35774594, "link": "https://stackoverflow.com/questions/35774594/error-drawing-model-in-opengl/35774950#35774950", "title": "Error drawing model in opengl", "body": "<p>Obj files store in addition to the vertices (v-lines) also how they have to be combined into faces (f-lines). The vertices themself are stored without a particular ordering, which means that the first triangle is not necessarily composed of the vertices 0-2.</p>\n\n<p>You will have to read all of the vertices into a vector/list/array and then parse the face entries which can be composed (according to here) in four different ways depending on which additional information (normals, texture coordinates) are additionally stored:</p>\n\n<pre><code>f v1 v2 v3 ...\nf v1/vt1 v2/vt2 v3/vt3 ...\nf v1/vt1/vn1 v2/vt2/vn2 v3/vt3/vn3 ....\nf v1//vn1 v2//vn2 v3//vn3 ...\n</code></pre>\n\n<p>where</p>\n\n<pre><code>v  ... index into the list of v-entries\nvt ... index into the list of vt-entries (texture coordinates)\nvn ... index into the list of vn-entries (normals)\n</code></pre>\n\n<p>For your example, you will have to do something similar to this pseudocode (assuming that all faces are already triangulated)</p>\n\n<pre><code>v-list vertices[];\nparse each v-line into v-list\n\nforeach (f-line)\n{\n    parse v-indices -&gt; {v0, v1, v2}\n\n    draw triangle {vertices[v0], vertices[v1], vertices[v2]}\n}\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 961786, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/c583f2c2db98cd0c19a9c6bc41b66bd4?s=128&d=identicon&r=PG", "display_name": "tommy_p1ckles", "link": "https://stackoverflow.com/users/961786/tommy-p1ckles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1457015750, "creation_date": 1457014516, "last_edit_date": 1457015750, "question_id": 35774594, "link": "https://stackoverflow.com/questions/35774594/error-drawing-model-in-opengl", "title": "Error drawing model in opengl", "body": "<p>So i'm trying to a basic opengl program that reads in an <code>.obj</code> file and then renders it (the obj file contains triangle vertices in the format \n<code>v 1.000000 2.000000, 3.00000</code>.</p>\n\n<p>So here's my code to do that (im using GLFW and a Golang binding library for it) (also im currently ignoring normals).</p>\n\n<pre><code>gl.Begin(gl.TRIANGLES)\nfor scanner.Scan() {\n    var v0, v1, v2 float32\n    t := strings.Split(scanner.Text(), \" \")\n    line := scanner.Text()\n    fmt.Sscanf(line, \"v %f %f %f\", &amp;v0, &amp;v1, &amp;v2)\n    if t[0] == \"v\" {\n        gl.Vertex3f(v0, v1, v2)\n    }\n}\ngl.End()\n</code></pre>\n\n<p>However when I go to run this the result isnt quite right</p>\n\n<p><a href=\"https://i.stack.imgur.com/DSjma.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DSjma.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried it on a few other files I found around the internet and I get similar results. It almost seems like the triangles vertices are offset or something.</p>\n"}]