[{"tags": ["go", "bitwise-operators"], "comments": [{"owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "edited": false, "score": 0, "creation_date": 1423692933, "post_id": 28465098, "comment_id": 45256847, "body": "Is there a reason this sits in a <code>bytes.Buffer</code> as opposed to just using the <code>[]byte</code> slice directly?"}, {"owner": {"reputation": 1826, "user_id": 3765772, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3b49d13ba84f10dbe67af56729f9951?s=128&d=identicon&r=PG&f=1", "display_name": "R.J. Robinson", "link": "https://stackoverflow.com/users/3765772/r-j-robinson"}, "reply_to_user": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "edited": false, "score": 0, "creation_date": 1423693029, "post_id": 28465098, "comment_id": 45256894, "body": "Thats how it will be handed off. .. but to keep this full circle, what do you mean? Is there a better way?"}, {"owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "edited": false, "score": 0, "creation_date": 1423693865, "post_id": 28465098, "comment_id": 45257319, "body": "It&#39;s not the buffer itself, but the way you use it in the <code>requestId = </code> part. See my answer below."}], "answers": [{"comments": [{"owner": {"reputation": 1826, "user_id": 3765772, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3b49d13ba84f10dbe67af56729f9951?s=128&d=identicon&r=PG&f=1", "display_name": "R.J. Robinson", "link": "https://stackoverflow.com/users/3765772/r-j-robinson"}, "edited": false, "score": 0, "creation_date": 1423693863, "post_id": 28465599, "comment_id": 45257318, "body": "That makes a lot of sense. Thank you. Couple of questions."}, {"owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "edited": false, "score": 1, "creation_date": 1423698904, "post_id": 28465599, "comment_id": 45259302, "body": "encoding/binary has special methods for reading uints, see here: <a href=\"http://play.golang.org/p/CC9HeZAvRj\" rel=\"nofollow noreferrer\">play.golang.org/p/CC9HeZAvRj</a>. It will be faster than <code>binary.Read</code> since it avoids the use of reflection."}, {"owner": {"reputation": 1826, "user_id": 3765772, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3b49d13ba84f10dbe67af56729f9951?s=128&d=identicon&r=PG&f=1", "display_name": "R.J. Robinson", "link": "https://stackoverflow.com/users/3765772/r-j-robinson"}, "edited": false, "score": 0, "creation_date": 1423751680, "post_id": 28465599, "comment_id": 45282616, "body": "I really get this now. Thank you for the help. &gt;&gt; The buffer that I provided came with a key as to what the values &quot;should&quot; return ( according to the frame that was provided) . in the end the RequestID should == 1 . When I run your code, it only returns 0. In @logiraptors code, he uses the slice of [16:24] and that returns 1. When I asked my lead about the Big or Little Endian he stated that it didn&#39;t matter. ( jr. dev here )"}, {"owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "edited": false, "score": 0, "creation_date": 1423755095, "post_id": 28465599, "comment_id": 45285028, "body": "Integers are stored in memory in either big- or little endian, depending on whether you run the program on linux, windows, OSX, etc. A 16-bit value <code>1234</code> might thus be represented as bytes <code>0x04 0xd2</code> or <code>0xd2 0x04</code>. Depending on how you interpret the bytes, you get either <code>1234</code> or <code>53764</code>. There is a generally accepted convention that data sent over a network is always encoded in Big Endian. But it&#39;s best to make sure this is the case."}], "tags": [], "owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "is_accepted": true, "score": 2, "last_activity_date": 1423693826, "last_edit_date": 1423693826, "creation_date": 1423692960, "answer_id": 28465599, "question_id": 28465098, "link": "https://stackoverflow.com/questions/28465098/golang-bitwise-calculation/28465599#28465599", "title": "GoLang bitwise calculation", "body": "<p>You have to do the manual bit shifting and OR'ing, but your code can be cleaned up by removing all those <code>buffer.Bytes()</code> calls.</p>\n\n<p>You also do not need the <code>&amp;0xff</code> parts. What <code>n&amp;0xff</code> does, is clear out all bits outside of the <code>0-255</code> range. Since each value in the buffer is already a byte (0-255), these operations do nothing at all. If we want to do <code>22 &amp; 255</code>, we get the following:</p>\n\n<pre><code>    Hexadecimal   | Decimal     | Binary\n    --------------|-------------|----------------------\nx   0x16          | 22          | 00010110\ny   0xff          | 255         | 11111111\n    --------------|-------------|---------------------- AND (&amp;)\n    0x16          | 22          | 00010110 = x\n</code></pre>\n\n<p>As you can see, the operation has no effect at all. Replace <code>x</code> with any 8-bit value and you will see the same result. The outcome of <code>x &amp; 0xff</code> is always <code>x</code>.</p>\n\n<p>Additionally, when you assign to the <code>requestId</code>, you start by shifting by 24 bits. This tells me you are reading a 32-bit integer. Why then do you continue reading values beyond 32 bits and converting it all to a 64 bit integer?</p>\n\n<p>If you are reading a 64-bit int in Big Endian, try this:</p>\n\n<pre><code>data := buf.Bytes()[8:]\nrequestid := uint64(data[0])&lt;&lt;56 | uint64(data[1])&lt;&lt;48 |\n    uint64(data[2])&lt;&lt;40 | uint64(data[3])&lt;&lt;32 |\n    uint64(data[4])&lt;&lt;24 | uint64(data[5])&lt;&lt;16 |\n    uint64(data[6])&lt;&lt;8 | uint64(data[7])\n</code></pre>\n\n<p>If you are reading a 64-bit int in Little Endian, try this:</p>\n\n<pre><code>data := buf.Bytes()[8:]\nrequestid := uint64(data[7])&lt;&lt;56 | uint64(data[6])&lt;&lt;48 |\n    uint64(data[5])&lt;&lt;40 | uint64(data[4])&lt;&lt;32 |\n    uint64(data[3])&lt;&lt;24 | uint64(data[2])&lt;&lt;16 |\n    uint64(data[1])&lt;&lt;8 | uint64(data[0])\n</code></pre>\n\n<p>If you are reading a 32-bit int in Big Endian, try this:</p>\n\n<pre><code>data := buf.Bytes()[8:]\nrequestid := uint32(data[0])&lt;&lt;24 | uint32(data[1])&lt;&lt;16 |\n    uint32(data[2])&lt;&lt;8 | uint32(data[3])\n</code></pre>\n\n<p>If you are reading a 32-bit int in Little Endian, try this:</p>\n\n<pre><code>data := buf.Bytes()[8:]\nrequestid := uint32(data[3])&lt;&lt;24 | uint32(data[2])&lt;&lt;16 |\n    uint32(data[1])&lt;&lt;8 | uint32(data[0])\n</code></pre>\n\n<h3>binary package</h3>\n\n<p>Alternatively, you can use the <a href=\"http://godoc.org/encoding/binary\" rel=\"nofollow\">encoding/binary</a> package:</p>\n\n<pre><code>var value uint64\nerr := binary.Read(buf, binary.LittleEndian, &amp;value)\n....\n</code></pre>\n"}], "owner": {"reputation": 1826, "user_id": 3765772, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3b49d13ba84f10dbe67af56729f9951?s=128&d=identicon&r=PG&f=1", "display_name": "R.J. Robinson", "link": "https://stackoverflow.com/users/3765772/r-j-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4491, "favorite_count": 1, "accepted_answer_id": 28465599, "answer_count": 1, "score": 1, "last_activity_date": 1423693826, "creation_date": 1423691036, "question_id": 28465098, "link": "https://stackoverflow.com/questions/28465098/golang-bitwise-calculation", "title": "GoLang bitwise calculation", "body": "<p>I have a buffer : </p>\n\n<pre><code>buffer := bytes.NewBuffer([]byte{\n        0x85, 0x02, 0xFF, 0xFF,\n        0x00, 0x01, 0x00, 0x02,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x01,\n        0x00, 0x00, 0x00, 0x03,\n        0x41, 0x42, 0x43,\n    })\n</code></pre>\n\n<p>I am trying to return the int value of buffer[8:24]\nI get  </p>\n\n<pre><code>[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1]\n</code></pre>\n\n<p>Not sure how to shift such a large section. of the byte. </p>\n\n<p>new to this. Any help would be great. my initial approach was  </p>\n\n<pre><code>requestid := (uint64(buffer.Bytes()[8]&amp;0xff)&lt;&lt;24 + uint64(buffer.Bytes()[9]&amp;0xff)&lt;&lt;16 + uint64(buffer.Bytes()[10]&amp;0xff)&lt;&lt;8 + uint64(buffer.Bytes()[11]&amp;0xff.....)))\n</code></pre>\n\n<p>but this got tedious, and I know there has to be an easier way. </p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 1, "creation_date": 1423690209, "post_id": 28464866, "comment_id": 45255402, "body": "...and <code>-</code> is not a valid character in a base64 encoded string. So, as <code>Unmarshal</code> comes to a byte slice and attempts to unencode it (assuming its base64), it will fail."}, {"owner": {"reputation": 584, "user_id": 2528719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ef4da676524b97d525de1c3a5ad3e87?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2528719/aaron"}, "edited": false, "score": 0, "creation_date": 1423690627, "post_id": 28464866, "comment_id": 45255613, "body": "Using a string is a valid fix for the issue, but it is inconvenient for me elsewhere in the app because I will have to do casting, which is fine but just a little messy looking. I read some stuff like that about hyphens, but I can reproduce the error without hyphens as well: <a href=\"http://play.golang.org/p/0zbUj5yuO9\" rel=\"nofollow noreferrer\">play.golang.org/p/0zbUj5yuO9</a> leading me to think that the issue is deeper than that."}, {"owner": {"reputation": 584, "user_id": 2528719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ef4da676524b97d525de1c3a5ad3e87?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2528719/aaron"}, "edited": false, "score": 0, "creation_date": 1423691477, "post_id": 28464866, "comment_id": 45256078, "body": "Per my update above, the base64 encoded string issue was indeed the root of the problem. I implemented that encoding on the client side and it solved the problem. Thanks!"}], "tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": true, "score": 2, "last_activity_date": 1423690134, "creation_date": 1423690134, "answer_id": 28464866, "question_id": 28464711, "link": "https://stackoverflow.com/questions/28464711/go-strange-json-hyphen-unmarshall-error/28464866#28464866", "title": "Go - strange json hyphen unmarshall error", "body": "<p>from the <a href=\"http://golang.org/pkg/encoding/json/\" rel=\"nofollow\">json package</a> documentation :</p>\n\n<blockquote>\n  <p>Array and slice values encode as JSON arrays, except that []byte\n  encodes as a base64-encoded string, and a nil slice encodes as the\n  null JSON object.</p>\n</blockquote>\n\n<p>so if you change your structure to <code>DeviceIdentifier string</code> it will work</p>\n\n<p><a href=\"http://play.golang.org/p/1M899l98kD\" rel=\"nofollow\">Go Playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 584, "user_id": 2528719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ef4da676524b97d525de1c3a5ad3e87?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2528719/aaron"}, "is_accepted": false, "score": 0, "last_activity_date": 1423691844, "creation_date": 1423691844, "answer_id": 28465326, "question_id": 28464711, "link": "https://stackoverflow.com/questions/28464711/go-strange-json-hyphen-unmarshall-error/28465326#28465326", "title": "Go - strange json hyphen unmarshall error", "body": "<p>Just to note another possibility, in order to keep the struct field as a <code>[]byte</code>, it also works perfectly well to just actually do the base64 encoding on the client side so that the value passed through the json represents something valid in base64. This was the solution I ended up using in my project. The <code>json.Marshal()</code> function in Go does this automatically for structs that contain a byte slice.</p>\n"}], "owner": {"reputation": 584, "user_id": 2528719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ef4da676524b97d525de1c3a5ad3e87?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2528719/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 853, "favorite_count": 0, "accepted_answer_id": 28464866, "answer_count": 2, "score": 0, "last_activity_date": 1423691844, "creation_date": 1423689568, "last_edit_date": 1423691390, "question_id": 28464711, "link": "https://stackoverflow.com/questions/28464711/go-strange-json-hyphen-unmarshall-error", "title": "Go - strange json hyphen unmarshall error", "body": "<p>I am having a very strange error while working with a json string. The problem was first introduced when I added a key-value pair of strings to the json input, which was <code>\"DeviceIdentifier\": \"device-id\"</code>. I pared down my code to the minimum necessary to display the error. The error disappears when I change pretty much anything about the data in that key-value pair, which seems very strange to me. I can just use other keys to circumvent the error, but it seems like there is something I am missing here. Either that or there would seem to be something wrong with the library function... Any ideas?</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype S struct {\n    Name            string\n    DeviceIdentifier []byte\n}\n\nfunc main() {\n    var s S\n\n    data := []byte(`{\"Name\": \"test\", \"DeviceIdentifier\": \"device-id\"}`)\n\n    if err := json.Unmarshal(data, &amp;s); err != nil {\n        fmt.Println(err.Error())\n    }\n}\n</code></pre>\n\n<p>Go playground link: <a href=\"http://play.golang.org/p/huXuaokGik\" rel=\"nofollow\">http://play.golang.org/p/huXuaokGik</a></p>\n\n<p>Json package documentation: <a href=\"http://golang.org/pkg/encoding/json/\" rel=\"nofollow\">http://golang.org/pkg/encoding/json/</a></p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I just discovered that the encoding succeeds when the value string has a length that is divisible by 4, e.g. <code>abcd</code> and <code>abcdefgh</code> work, while <code>abcde</code> and abcdefg` do not. </p>\n\n<p>Now that I know what base64 strings are the error makes a lot of sense. References here:</p>\n\n<p>Wikipedia: <a href=\"http://en.wikipedia.org/wiki/Base64\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Base64</a></p>\n\n<p>Conversion tool: <a href=\"http://www.string-functions.com/base64encode.aspx\" rel=\"nofollow\">http://www.string-functions.com/base64encode.aspx</a></p>\n"}, {"tags": ["asynchronous", "go", "channel", "goroutine"], "comments": [{"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1423688059, "post_id": 28464098, "comment_id": 45254296, "body": "Start here: <a href=\"http://talks.golang.org/2012/concurrency.slide\" rel=\"nofollow noreferrer\">talks.golang.org/2012/concurrency.slide</a>. The key to your problem is using <code>select</code> to watch an incoming connection channel, a response channel, and maybe a quit channel. Depending on your anticipated load, creating one goroutine per request may be fine; or you may need to create a pool. But you&#39;ll understand the right questions better once you go through Go Concurrency Patterns. See also <a href=\"http://blog.golang.org/advanced-go-concurrency-patterns\" rel=\"nofollow noreferrer\">blog.golang.org/advanced-go-concurrency-patterns</a> and especially the &quot;related articles&quot; at the end. Understanding <code>select</code> is one of the great &quot;oh, that&#39;s how Go works!&quot; moments."}, {"owner": {"reputation": 183757, "user_id": 20654, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94066dfa49c2feb14706cb081848fda7?s=128&d=identicon&r=PG", "display_name": "OscarRyz", "link": "https://stackoverflow.com/users/20654/oscarryz"}, "reply_to_user": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1423692290, "post_id": 28464098, "comment_id": 45256489, "body": "@RobNapier Uhm... I read through the slides before and I kind of get them but not quite. I&#39;ll go through them again in a few moments. Meanwhile I managed to have a small program, can you comment on it if you see anything particularly dangerous?"}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1423695326, "post_id": 28464098, "comment_id": 45257956, "body": "OK; I may have misunderstood what you meant by &quot;asynchronous.&quot; I had assumed that multiple requests and responses would happen on the same connection (interleaving requests). You seem to mean that you want to stream data as the reader gets it. This is possibly a little more parallel than just reading two bytes and writing two bytes in a single goroutine. You may want to look at <code>golang.org&#47;x&#47;text&#47;transform</code> for this purpose, together with <code>io.Copy()</code>. (Sorry I&#39;m not more helpful with actual code here; it was an interesting question, but I don&#39;t have time this minute to help extensively.)"}, {"owner": {"reputation": 183757, "user_id": 20654, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94066dfa49c2feb14706cb081848fda7?s=128&d=identicon&r=PG", "display_name": "OscarRyz", "link": "https://stackoverflow.com/users/20654/oscarryz"}, "reply_to_user": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1423701512, "post_id": 28464098, "comment_id": 45260099, "body": "No, you&#39;re right. This is the first step though. Without the channels I wasn&#39;t able to make another write between reads, and the flow will lock until I had something else to read.  Now with this change, I&#39;m able to &quot;broadcast&quot; messages coming from other connections without having to wait for a read to happen.  Next step will be read from a single goroutine and/or use a pool to avoid creating a goroutine for each open connection."}], "answers": [{"tags": [], "owner": {"reputation": 183757, "user_id": 20654, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94066dfa49c2feb14706cb081848fda7?s=128&d=identicon&r=PG", "display_name": "OscarRyz", "link": "https://stackoverflow.com/users/20654/oscarryz"}, "is_accepted": false, "score": 1, "last_activity_date": 1423692328, "creation_date": 1423692328, "answer_id": 28465438, "question_id": 28464098, "link": "https://stackoverflow.com/questions/28464098/asynchronous-messages-golang/28465438#28465438", "title": "Asynchronous messages golang", "body": "<p>This program seems to solve my immediate question</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/binary\"\n    \"log\"\n\n    \"net\"\n)\n\nvar rcs []chan int = make([]chan int,0)\n\n\nfunc main() {\n    a, e := net.ResolveTCPAddr(\"tcp\", \":8082\")\n    if e != nil {\n        log.Fatal(e)\n    }\n    l, e := net.ListenTCP(\"tcp\", a)\n    for {\n        c, e := l.Accept()\n        if e != nil {\n            log.Fatal(e)\n        }\n        rc := make(chan int)\n        go read(c, rc)\n        go write(c, rc)\n        rcs = append(rcs, rc)\n        // simulate broacast\n        log.Println(len(rcs))\n        if len(rcs) &gt; 5 {\n            func() {\n                for _, v := range rcs {\n                    log.Println(\"sending\")\n                    select {\n                    case v &lt;- 34:\n                        log.Println(\"done sending\")\n                    default:\n                        log.Println(\"didn't send\")\n                    }\n                }\n            }()\n        }\n    }\n}\nfunc read(c net.Conn, rc chan int) {\n    h := make([]byte, 2)\n    for {\n        _, err := c.Read(h)\n        if err != nil {\n            rc &lt;- -1\n        }\n        var v int16\n        binary.Read(bytes.NewReader(h[:2]), binary.BigEndian, &amp;v)\n        rc &lt;- int(v)\n    }\n}\nfunc write(c net.Conn, rc chan int) {\n    for {\n        r := &lt;-rc\n        o := []byte{byte(r * 2)}\n        c.Write(o)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 183757, "user_id": 20654, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94066dfa49c2feb14706cb081848fda7?s=128&d=identicon&r=PG", "display_name": "OscarRyz", "link": "https://stackoverflow.com/users/20654/oscarryz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1732, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423692328, "creation_date": 1423687356, "question_id": 28464098, "link": "https://stackoverflow.com/questions/28464098/asynchronous-messages-golang", "title": "Asynchronous messages golang", "body": "<p>I have a golang server doing something like this:\n    package main</p>\n\n<pre><code>func main() {\n    for {\n        c := listener.Accept()\n        go handle(c)\n    }\n}\n\n...\nfunc handle(c net.Conn) {\n    m := readMessage(c)    // func(net.Conn)Message\n    r := processMessage(m) //func(Message)Result\n    sendResult(c, r)       // func(net.Conn,Result)\n}\n</code></pre>\n\n<p>Which reads and writes messages synchronously. What I need now is to send messages asynchronously through a given open connection, I know a channel can be used by I'm kind of lost.</p>\n\n<p>This is my idea:</p>\n\n<pre><code>...\nfunc someWhereElese(c chan Result) {\n    // generate a message and a result\n    r := createResultFromSomewhere()\n    c &lt;- r // send the result through the channel\n}\n</code></pre>\n\n<p>And modify my handle to use that same channel instead</p>\n\n<pre><code>func handle(c net.Conn, rc chan Result) {\n    m := readMessage(c)    // func(net.Conn)Message\n    r := processMessage(m) //func(Message)Result\n    //sendResult(c, r)       // func(net.Conn,Result)\n    rc &lt;- r\n}\n</code></pre>\n\n<p>And here's where my confusion lies.</p>\n\n<p>The result channel should be created and it should have a connection where to send whatever it receives</p>\n\n<pre><code>func doSend(c net.Con, rc chan Result) {\n    r := rc          // got a result channel\n    sendResult(c, r) // send it through the wire\n}\n</code></pre>\n\n<p>But where should that channel be created? In the main loop?</p>\n\n<pre><code>func main() {\n    ...\n    for {\n        c := l.Accept()\n        rc := make(chan Result)\n        go doSend(c, rc)\n    }\n}\n</code></pre>\n\n<p>What about the read? Should it go in it's own channel/gorutine?\nIf I need to broadcast to n clients, should I keep a slice of result channels? a slice of connections?</p>\n\n<p>I'm kind of confused here, but I feel I'm close.</p>\n"}, {"tags": ["go", "variable-assignment", "deferred"], "answers": [{"comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 2, "creation_date": 1423673780, "post_id": 28459918, "comment_id": 45246044, "body": "Note for the future: Please do not sign your posts. There is a box below each post where it says your username, so signing is not required (and discouraged, as is any form of greeting)."}], "tags": [], "owner": {"reputation": 139, "user_id": 1946717, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/12596408b06f304d2f980914bc55ed6f?s=128&d=identicon&r=PG", "display_name": "Mike in SAT", "link": "https://stackoverflow.com/users/1946717/mike-in-sat"}, "is_accepted": false, "score": 7, "last_activity_date": 1423673539, "creation_date": 1423673539, "answer_id": 28459918, "question_id": 28459917, "link": "https://stackoverflow.com/questions/28459917/golang-defer-not-evaluating-when-expected/28459918#28459918", "title": "golang defer not evaluating when expected", "body": "<p>So I answered my own question while proofreading my post. Rather than delete it to hide my embarrassment, I'll leave it up in case others suffer the same confusion.</p>\n\n<p>The deferred function evaluates any ARGUMENTS to the function when it's called. It does not immediately evaluate any values WITHIN the function body. So internal assignments are executed when the deferred actions take place.</p>\n\n<p>So:</p>\n\n<ol>\n<li>code is run</li>\n<li>a defer statement is encountered</li>\n<li>golang stores the argument values for later</li>\n<li>the deferred func's body is completely ignored</li>\n<li>the rest of the code is run to the end of the enclosing func</li>\n<li>the deferred function is executed using the stored argument values</li>\n</ol>\n\n<p>-Mike</p>\n"}, {"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 2, "last_activity_date": 1423674486, "creation_date": 1423674486, "answer_id": 28460224, "question_id": 28459917, "link": "https://stackoverflow.com/questions/28459917/golang-defer-not-evaluating-when-expected/28460224#28460224", "title": "golang defer not evaluating when expected", "body": "<p>Good job answering your own question.  I think it is worth it to show what the correction would be to your initial attempt for future readers.</p>\n\n<pre><code>func (t *tss) test() {\n    if true {\n        defer func(q int) {\n            t.q = q //this should evaluate to 't.q = 50' right?\n            fmt.Println(\"assigned\", t.q, \"to t.q\")\n        }(t.q)\n        t.q = t.m\n    }\n    fmt.Printf(\"q=%v, m=%v\\n\", t.q, t.m)\n}\n</code></pre>\n\n<p><strong>OUTPUT</strong>  </p>\n\n<pre><code>q=50, m=1\nq=1, m=1\nassigned 50 to t.q\nq=50, m=1\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 1946717, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/12596408b06f304d2f980914bc55ed6f?s=128&d=identicon&r=PG", "display_name": "Mike in SAT", "link": "https://stackoverflow.com/users/1946717/mike-in-sat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1508, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1423766555, "creation_date": 1423673539, "last_edit_date": 1423766555, "question_id": 28459917, "link": "https://stackoverflow.com/questions/28459917/golang-defer-not-evaluating-when-expected", "title": "golang defer not evaluating when expected", "body": "<p>So according to spec, the values in a defer function are evaluated when the defer function is called, but the actions are not executed until the enclosing function returns. I get this, and understand the whole 'for i:=0;i&lt;4;i++ defer example prints 3210' thing.</p>\n\n<p>However, when i try to use defer to temporarily assign an override value (assign max m to queue-length q), then ensure that value is reset when I'm done (example simplified for demo):</p>\n\n<pre><code>type tss struct {\n    q int\n    m int\n}\n\nfunc (t *tss) test() {\n    if true {\n        defer func() {\n            t.q=t.q     //this should evaluate to 't.q = 50' right?\n            fmt.Println(\"assigned\",t.q,\"to t.q\")\n        }()\n        t.q = t.m\n    }\n    fmt.Printf(\"q=%v, m=%v\\n\", t.q, t.m)\n}\n\nfunc main() {\n    ts := tss{50,1}\n    fmt.Printf(\"q=%v, m=%v\\n\", ts.q, ts.m)\n    ts.test()\n    fmt.Printf(\"q=%v, m=%v\\n\", ts.q, ts.m)\n}\n</code></pre>\n\n<p>I would expect to receive the output:</p>\n\n<pre><code>q=50, m=1\nq=1, m=1\nassigned 50 to t.q\nq=50, m=1\n</code></pre>\n\n<p>But the actual output is:</p>\n\n<pre><code>q=50, m=1\nq=1, m=1\nassigned 1 to t.q\nq=1, m=1\n</code></pre>\n\n<p>So it would seem the values are being evaluated at the wrong time. However, when I dump t.q into a variable first and move that assignment outside the deferred function, and change the test function to look like:</p>\n\n<pre><code>func (t *tss) test() {\n    if true {\n        qtmp := t.q\n        defer func() {\n            //assigning qtmp here still assigns 1 back to t.q\n            t.q=qtmp\n            fmt.Println(\"assigned\",t.q,\"to t.q\")\n        }()\n        t.q = t.m\n    }\n    fmt.Printf(\"q=%v, m=%v\\n\", t.q, t.m)\n}\n</code></pre>\n\n<p>I get the expected output above, where 50 is assigned.</p>\n\n<p>Did I trip a bug, or is there something about assigning a value within the deferred func that I'm missing?</p>\n\n<p>Possibly of note, if I pass t.q in as a function argument, that works as well:</p>\n\n<pre><code>func (t *tss) test() {\n    if true {\n        defer func(q int) {\n            t.q=q\n            fmt.Println(\"assigned\",t.q,\"to t.q\")\n        }(t.q)\n        t.q = t.m\n    }\n    fmt.Printf(\"q=%v, m=%v\\n\", t.q, t.m)\n}\n</code></pre>\n\n<p>EDIT: here is the full version using the method in the answer:</p>\n\n<pre><code>type tss struct {\n    q int\n    m int\n}\n\nfunc (t *tss) test() {\n    if true {\n        defer func(q int) {\n            t.q=q     //this will correctly evaluate to 't.q = 50'\n            fmt.Println(\"assigned\",t.q,\"to t.q\")\n        }(t.q)\n        t.q = t.m\n    }\n    fmt.Printf(\"q=%v, m=%v\\n\", t.q, t.m)\n}\n\nfunc main() {\n    ts := tss{50,1}\n    fmt.Printf(\"q=%v, m=%v\\n\", ts.q, ts.m)\n    ts.test()\n    fmt.Printf(\"q=%v, m=%v\\n\", ts.q, ts.m)\n}\n</code></pre>\n\n<p>and the correct output:</p>\n\n<pre><code>q=50, m=1\nq=1, m=1\nassigned 50 to t.q\nq=50, m=1\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1423672479, "last_edit_date": 1423672479, "creation_date": 1423671446, "answer_id": 28459155, "question_id": 28459102, "link": "https://stackoverflow.com/questions/28459102/golang-compile-environment-variable-into-binary/28459155#28459155", "title": "Golang compile environment variable into binary", "body": "<p>There is an <a href=\"http://golang.org/pkg/os/#Setenv\" rel=\"nofollow\"><code>os.Setenv()</code></a> function which you can use to set environment variables.</p>\n\n<p>So you can start your application by setting the environment variable like this:</p>\n\n<pre><code>func init() {\n    os.Setenv(\"VERSION\", \"0.123\")\n}\n</code></pre>\n\n<p>If you don't want to do this by \"hand\", you could create a tool for this which would read the current value of the <code>VERSION</code> environment variable and generate a <code>.go</code> source file in your package containing exactly like the code above (except using the current value of the <code>VERSION</code> environment variable). You can run such code generation by issuing the <code>go generate</code> command.</p>\n\n<p>Read the <a href=\"http://blog.golang.org/generate\" rel=\"nofollow\"><strong>Generating code</strong></a> blog post for more details about <code>go generate</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1423687169, "post_id": 28460195, "comment_id": 45253762, "body": "+1 Really cool, I didn&#39;t know about this. One note: on Windows you have to write <code>go build -ldflags &quot;-X main.Version %VERSION%&quot;</code>"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1423694250, "post_id": 28460195, "comment_id": 45257472, "body": "@icza Thanks, added Windows version to the answer."}, {"owner": {"reputation": 1885, "user_id": 639133, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4781a491e1923d56755de71fbec9d5d4?s=128&d=identicon&r=PG", "display_name": "mozey", "link": "https://stackoverflow.com/users/639133/mozey"}, "edited": false, "score": 0, "creation_date": 1469514436, "post_id": 28460195, "comment_id": 64553513, "body": "Compiler complains about the syntax above <code>link: warning: option -X main.Version 0.2 may not work in future releases; use -X main.Version=0.2</code>. Also, I want to point out that you can set a default value when the env variable is not passed in, set <code>var Version = 0.1</code> in <code>example.go</code>"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 193, "user_id": 9591909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5WQdx.jpg?s=128&g=1", "display_name": "Muddz", "link": "https://stackoverflow.com/users/9591909/muddz"}, "edited": false, "score": 0, "creation_date": 1565265119, "post_id": 28460195, "comment_id": 101303891, "body": "@Muddz <code>-ldflags &quot;-X a=1 -X b=2&quot;</code>."}, {"owner": {"reputation": 193, "user_id": 9591909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5WQdx.jpg?s=128&g=1", "display_name": "Muddz", "link": "https://stackoverflow.com/users/9591909/muddz"}, "edited": false, "score": 0, "creation_date": 1565266177, "post_id": 28460195, "comment_id": 101304472, "body": "I can&#39;t getting it to work. Not even a simple line as <code>-ldflags &quot;-X main.test=Hello&quot;</code> with a declared <code>var test string</code> is doing anything. When I run my program as an .exe on windows I also log the <code>test</code> variable to a .txt file to see if it works, but &#180;test` variable is just an empty string"}, {"owner": {"reputation": 193, "user_id": 9591909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5WQdx.jpg?s=128&g=1", "display_name": "Muddz", "link": "https://stackoverflow.com/users/9591909/muddz"}, "edited": false, "score": 0, "creation_date": 1565267209, "post_id": 28460195, "comment_id": 101305066, "body": "@Ainar-G forgot to mention I&#39;m typing these commands in Golands <code>Program Arguments</code> under the Run Configurations page"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1565268961, "post_id": 28460195, "comment_id": 101306251, "body": "I&#39;m not using IDEs, I use vim. Search through your IDE&#39;s documentation."}, {"owner": {"reputation": 802, "user_id": 2018909, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/10ebdad579fc333db3830e893baf977e?s=128&d=identicon&r=PG", "display_name": "srini", "link": "https://stackoverflow.com/users/2018909/srini"}, "edited": false, "score": 0, "creation_date": 1578689737, "post_id": 28460195, "comment_id": 105534376, "body": "this is a cool trick to know, i didn&#39;t know that. thanks. but the question is about how to set the env variable at build time. does anyone has a correct answer?"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 28, "last_activity_date": 1590082355, "last_edit_date": 1590082355, "creation_date": 1423674375, "answer_id": 28460195, "question_id": 28459102, "link": "https://stackoverflow.com/questions/28459102/golang-compile-environment-variable-into-binary/28460195#28460195", "title": "Golang compile environment variable into binary", "body": "<p><strong>Go 1.5 and above edit:</strong></p>\n\n<p>As of now, the syntax has changed.</p>\n\n<p>On Unix use:</p>\n\n<pre><code>go build -ldflags \"-X main.Version=$VERSION\"\n</code></pre>\n\n<p>On Windows use:</p>\n\n<pre><code>go build -ldflags \"-X main.Version=%VERSION%\"\n</code></pre>\n\n<hr>\n\n<p>This is what <code>-X</code> linker flag is for. In your case, you would do</p>\n\n<pre><code>go build -ldflags \"-X main.Version $VERSION\"\n</code></pre>\n\n<p><strong>Edit:</strong> on Windows this would be</p>\n\n<pre><code>go build -ldflags \"-X main.Version %VERSION%\"\n</code></pre>\n\n<p><a href=\"https://golang.org/cmd/link/\" rel=\"nofollow noreferrer\">More info in the linker docs</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1885, "user_id": 639133, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4781a491e1923d56755de71fbec9d5d4?s=128&d=identicon&r=PG", "display_name": "mozey", "link": "https://stackoverflow.com/users/639133/mozey"}, "edited": false, "score": 0, "creation_date": 1533456542, "post_id": 47665780, "comment_id": 90346559, "body": "<a href=\"https://play.golang.org/p/B3IuewBqY67\" rel=\"nofollow noreferrer\">play.golang.org/p/B3IuewBqY67</a> example with the behavior I wanted. Notice that <code>go build</code> behaves different to <code>go run</code>?"}, {"owner": {"reputation": 5117, "user_id": 337735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5a4803c2f31a4f0e53705287430a6e3d?s=128&d=identicon&r=PG", "display_name": "Cody A. Ray", "link": "https://stackoverflow.com/users/337735/cody-a-ray"}, "reply_to_user": {"reputation": 193, "user_id": 9591909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5WQdx.jpg?s=128&g=1", "display_name": "Muddz", "link": "https://stackoverflow.com/users/9591909/muddz"}, "edited": false, "score": 1, "creation_date": 1565404003, "post_id": 47665780, "comment_id": 101354887, "body": "@Muddz Same basic approach. If you also have a <code>var date string</code>, then compile with <code>-ldflags &quot;-X main.version=$VERSION -X main.date=$DATE&quot;</code>"}], "tags": [], "owner": {"reputation": 5117, "user_id": 337735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5a4803c2f31a4f0e53705287430a6e3d?s=128&d=identicon&r=PG", "display_name": "Cody A. Ray", "link": "https://stackoverflow.com/users/337735/cody-a-ray"}, "is_accepted": false, "score": 10, "last_activity_date": 1556338905, "last_edit_date": 1556338905, "creation_date": 1512526523, "answer_id": 47665780, "question_id": 28459102, "link": "https://stackoverflow.com/questions/28459102/golang-compile-environment-variable-into-binary/47665780#47665780", "title": "Golang compile environment variable into binary", "body": "<p>Ainer-G's answer led me to the right place, but it wasn't a full code sample answering the question. A couple of changes were required:</p>\n\n<ol>\n<li>Declare the version as <code>var version string</code></li>\n<li>Compile with <code>-X main.version=$VERSION</code></li>\n</ol>\n\n<p>Here's the full code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nvar version string\n\nfunc main() {\n    fmt.Println(version)\n}\n</code></pre>\n\n<p>Now compile with</p>\n\n<pre><code>go build -ldflags \"-X main.version=$VERSION\"\n</code></pre>\n"}], "owner": {"reputation": 1885, "user_id": 639133, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4781a491e1923d56755de71fbec9d5d4?s=128&d=identicon&r=PG", "display_name": "mozey", "link": "https://stackoverflow.com/users/639133/mozey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9568, "favorite_count": 4, "accepted_answer_id": 28460195, "answer_count": 3, "score": 20, "last_activity_date": 1590082355, "creation_date": 1423671308, "last_edit_date": 1556338807, "question_id": 28459102, "link": "https://stackoverflow.com/questions/28459102/golang-compile-environment-variable-into-binary", "title": "Golang compile environment variable into binary", "body": "<p>If I compile this program</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nvar version = os.Getenv(\"VERSION\")\n\nfunc main() {\n    fmt.Println(version)\n}\n</code></pre>\n\n<p>It prints the env var when I run it</p>\n\n<pre><code>VERSION=\"0.123\" ./example\n&gt; 0.123\n</code></pre>\n\n<p>Is there a way to compile the env var into the binary, for example:</p>\n\n<pre><code>VERSION=\"0.123\" go build example.go\n</code></pre>\n\n<p>Then get the same output when I run</p>\n\n<pre><code>./example\n</code></pre>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1423659511, "post_id": 28454756, "comment_id": 45236639, "body": "Are you aware, that there are many flavours of regular expressions, and something that works for one engine might not work for another?"}, {"owner": {"reputation": 148, "user_id": 4372649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9727069850eea06e9b7914a26e56eef8?s=128&d=identicon&r=PG&f=1", "display_name": "pcwizz", "link": "https://stackoverflow.com/users/4372649/pcwizz"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1423686829, "post_id": 28454756, "comment_id": 45253592, "body": "Yes I did read the manual"}], "answers": [{"comments": [{"owner": {"reputation": 148, "user_id": 4372649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9727069850eea06e9b7914a26e56eef8?s=128&d=identicon&r=PG&f=1", "display_name": "pcwizz", "link": "https://stackoverflow.com/users/4372649/pcwizz"}, "edited": false, "score": 0, "creation_date": 1423686869, "post_id": 28455077, "comment_id": 45253613, "body": "Thanks that seems to have done the job. <a href=\"http://play.golang.org/p/JX9Vvcdjtg\" rel=\"nofollow noreferrer\">play.golang.org/p/JX9Vvcdjtg</a>"}], "tags": [], "owner": {"reputation": 62965, "user_id": 3679490, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/70f98fb23b16862298ea208aedfd18ae?s=128&d=identicon&r=PG&f=1", "display_name": "vks", "link": "https://stackoverflow.com/users/3679490/vks"}, "is_accepted": true, "score": 5, "last_activity_date": 1423659754, "creation_date": 1423659754, "answer_id": 28455077, "question_id": 28454756, "link": "https://stackoverflow.com/questions/28454756/regex-go-mismatch/28455077#28455077", "title": "Regex Go mismatch", "body": "<pre><code>^(\\+|-)?(((\\d{1,3}[, ])(\\d{3}[ ,])*\\d{3})|\\d+)( ?[\\.,] ?(\\d{3}[, ])*\\d+)?$\n</code></pre>\n\n<p>Try with anchors.<code>^$</code> will disable partial matching.See demo.</p>\n\n<p><a href=\"https://regex101.com/r/qH1uG3/4\">https://regex101.com/r/qH1uG3/4</a></p>\n"}], "owner": {"reputation": 148, "user_id": 4372649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9727069850eea06e9b7914a26e56eef8?s=128&d=identicon&r=PG&f=1", "display_name": "pcwizz", "link": "https://stackoverflow.com/users/4372649/pcwizz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "closed_date": 1536159892, "accepted_answer_id": 28455077, "answer_count": 1, "score": 5, "last_activity_date": 1459895911, "creation_date": 1423658787, "last_edit_date": 1459895911, "question_id": 28454756, "link": "https://stackoverflow.com/questions/28454756/regex-go-mismatch", "closed_reason": "Duplicate", "title": "Regex Go mismatch", "body": "<p>I have developed some regex in regexr where it works as expected, but when I use it in Go it seems to be mismatching strings.</p>\n\n<pre><code>(\\+|-)?(((\\d{1,3}[, ])(\\d{3}[ ,])*\\d{3})|\\d+)( ?[\\.,] ?(\\d{3}[, ])*\\d+)?\n</code></pre>\n\n<p>For example in regexr the following input does not match:</p>\n\n<pre><code>1.12,4.64\n</code></pre>\n\n<p>But in Go it does match.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1423658233, "post_id": 28454398, "comment_id": 45235933, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/28409118/error-handling-in-go-language\">Error handling in Go language</a>"}, {"owner": {"reputation": 8931, "user_id": 712579, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/189eb7faca6c8ab0ebd61de961b7d6a0?s=128&d=identicon&r=PG", "display_name": "Vector", "link": "https://stackoverflow.com/users/712579/vector"}, "edited": false, "score": 0, "creation_date": 1423726070, "post_id": 28454398, "comment_id": 45267486, "body": "I abandoned GoLang because GoLang abandoned exceptions."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1423726154, "post_id": 28454398, "comment_id": 45267529, "body": "why? Golang is such as nice language."}, {"owner": {"reputation": 8931, "user_id": 712579, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/189eb7faca6c8ab0ebd61de961b7d6a0?s=128&d=identicon&r=PG", "display_name": "Vector", "link": "https://stackoverflow.com/users/712579/vector"}, "edited": false, "score": 0, "creation_date": 1423761665, "post_id": 28454398, "comment_id": 45289543, "body": "I don&#39;t want to start a language war here - I agree GoLang is a <b>very</b> nice language - much to recommend it. I just cannot get comfortable with a language that does support exceptions, as stated, and as illustrated by your question (and numerous similar questions here) and the answers you received."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 4, "last_activity_date": 1423658753, "creation_date": 1423658753, "answer_id": 28454738, "question_id": 28454398, "link": "https://stackoverflow.com/questions/28454398/pretty-boring-to-handle-error/28454738#28454738", "title": "Pretty boring to handle error", "body": "<p>No, it would not be better. Checking your errors is not bad design in Go. Panicking when there is no reason to do so, on the other hand, <em>is</em> bad design, because it's harder to test and debug.</p>\n\n<p><a href=\"https://github.com/golang/go/wiki/CodeReviewComments#dont-panic\" rel=\"nofollow\">The Go Wiki</a> explicitly discourages the use of <code>panic</code> outside of truly exceptional cases, when the error is unrecoverable and state of the program can't be fixed.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 28454738, "answer_count": 1, "score": 1, "last_activity_date": 1423658753, "creation_date": 1423657814, "question_id": 28454398, "link": "https://stackoverflow.com/questions/28454398/pretty-boring-to-handle-error", "title": "Pretty boring to handle error", "body": "<p>I have struct that have a method that serve the response.  </p>\n\n<pre><code>type ctrl struct {\n    *base.AjaxCtrl\n    file ini.File\n}\n\nfunc (rcv *ctrl) getVar() string {\n    return mux.Vars(rcv.Req)[\"location\"]\n}\n\nfunc (rcv *ctrl) getFile() string {\n    return location.JoinPaths(folder, rcv.getVar()+ext)\n}\n\nfunc (rcv *ctrl) upload() {\n    file, err := ini.LoadFile(rcv.getFile())\n    if err != nil {\n        rcv.AddErr(\"TextError\", err.Error())\n        return\n    }\n    rcv.file = file\n}\n\n// Convert text to json structure\nfunc (rcv *ctrl) convertToJson() string {\n    js, err := json.Marshal(rcv.file.Section(\"text/signup\"))\n    if err != nil {\n        rcv.AddErr(\"ConvertError\", err.Error())\n        return \"\"\n    }\n    return string(js)\n}\n\nfunc (rcv *ctrl) serveHttp() (types.SuccsJSON, types.ErrorsJSON) {\n\n    rcv.upload()\n    if rcv.AnyErrors() {\n        return nil, rcv.Errs\n    }\n\n    str := rcv.convertToJson()\n    if rcv.AnyErrors() {\n        return nil, rcv.Errs\n    }\n    return c.Sucss, nil\n}\n</code></pre>\n\n<p>The method serveHttp() handle the response to client. As you can see, I am handling the error with the method AnyError() everytime. I find this way is pretty boring and maybe wrong design.\nWould it be better to throw a panic instead of error handling?</p>\n\n<pre><code>func (rcv *ctrl) upload() {\n    file, err := ini.LoadFile(rcv.getFile())\n    if err != nil {\n        rcv.AddErr(\"TextError\", err.Error())\n        panic()\n    }\n    rcv.file = file\n}\n</code></pre>\n"}, {"tags": ["unit-testing", "go"], "answers": [{"tags": [], "owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "is_accepted": false, "score": -1, "last_activity_date": 1423733991, "creation_date": 1423733991, "answer_id": 28474004, "question_id": 28454337, "link": "https://stackoverflow.com/questions/28454337/golang-mocking-with-elastic/28474004#28474004", "title": "Golang Mocking with Elastic", "body": "<p>The line</p>\n\n<pre><code>func CheckBucketExists(name string, client *elastic.Client) bool {\n</code></pre>\n\n<p>states that <code>CheckBucketExists</code> expects a <code>*elastic.Client</code>.</p>\n\n<p>The lines:</p>\n\n<pre><code>m := MockClient{}\nm.On(\"IndexExists\", \"thisuri\").Return(true) \nr := CheckBucketExists(\"thisuri\", m)\n</code></pre>\n\n<p>pass a <code>MockClient</code> to the <code>CheckBucketExists</code> function.</p>\n\n<p>This is causing a type conflict.</p>\n\n<p>Perhaps you need to import <code>github.com/olivere/elastic</code> into your test file and do:</p>\n\n<pre><code>m := &amp;elastic.Client{}\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>m := MockClient{}\n</code></pre>\n\n<p>But I'm not 100% sure what you're trying to do.</p>\n"}, {"comments": [{"owner": {"reputation": 643, "user_id": 2402831, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2c32d36536daf6acc5634e65379b691?s=128&d=identicon&r=PG", "display_name": "user2402831", "link": "https://stackoverflow.com/users/2402831/user2402831"}, "edited": false, "score": 1, "creation_date": 1516576205, "post_id": 48361695, "comment_id": 83732436, "body": "This was my question initially, and I haven&#39;t done much Go since I posted this years ago. <a href=\"https://github.com/golang/go/wiki/CodeReviewComments#interfaces\" rel=\"nofollow noreferrer\">CodeReviewComments#Interfaces</a> suggests that the external library should implement the struct, and the user should define an interface on that struct, passing it in using dep injection. Which, points to the first solution you mentioned in your post!"}], "tags": [], "owner": {"reputation": 725, "user_id": 957979, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/syfph.jpg?s=128&g=1", "display_name": "cesaregb", "link": "https://stackoverflow.com/users/957979/cesaregb"}, "is_accepted": false, "score": 3, "last_activity_date": 1516486953, "creation_date": 1516486953, "answer_id": 48361695, "question_id": 28454337, "link": "https://stackoverflow.com/questions/28454337/golang-mocking-with-elastic/48361695#48361695", "title": "Golang Mocking with Elastic", "body": "<p>This is an old question, but couldn't find the solution either. \nUnfortunately, this library is implemented using a struct, that makes mocking it not trivial at all, so the options I found are:  </p>\n\n<p>(1) Wrap all the <code>elastic.SearchResult</code> Methods on an interface on your own and \"proxy\" the call, so you end up with something like: </p>\n\n<pre><code>type ObjectsearchESClient interface {\n    // ... all methods... \n    Do(context.Context) (*elastic.SearchResult, error)\n}\n\n\n// NewObjectsearchESClient returns a new implementation of ObjectsearchESClient\nfunc NewObjectsearchESClient(cluster *config.ESCluster) (ObjectsearchESClient, error) {\n    esClient, err := newESClient(cluster)\n    if err != nil {\n        return nil, err\n    }\n\n    newClient := objectsearchESClient{\n        Client: esClient,\n    }\n    return &amp;newClient, nil\n}\n// ... all methods... \nfunc (oc *objectsearchESClient) Do(ctx context.Context) (*elastic.SearchResult, error) {\n    return oc.searchService.Do(ctx)\n}\n</code></pre>\n\n<p>And then mock this interface and responses as you would with other modules of your app. </p>\n\n<p>(2) Another option is like pointed in <a href=\"http://goinbigdata.com/unit-testing-golang-code-calling-elasticsearch/\" rel=\"nofollow noreferrer\">this blog post</a> that is mock the response from the Rest calls using <code>httptest.Server</code> </p>\n\n<p>for this, I mocked the handler, that consist of mocking the response from the \"HTTP call\" </p>\n\n<pre><code>func mockHandler () http.HandlerFunc{\n    return func(w http.ResponseWriter, r *http.Request) {\n        resp := `{\n            \"took\": 73,\n            \"timed_out\": false,\n            ... json ... \n            \"hits\": [... ]\n            ...json ... ,\n            \"aggregations\": { ... }\n        }`\n\n        w.Write([]byte(resp))\n    }\n}\n</code></pre>\n\n<p>Then you create a dummy elastic.Client struct </p>\n\n<pre><code>func mockClient(url string) (*elastic.Client, error) {\n    client, err := elastic.NewSimpleClient(elastic.SetURL(url))\n    if err != nil {\n        return nil, err\n    }\n    return client, nil\n}\n</code></pre>\n\n<p>In this case, I've a library that builds my elastic.SearchService and returns it, so I use the HTTP like:</p>\n\n<pre><code>    ... \n    ts := httptest.NewServer(mockHandler())\n    defer ts.Close()\n    esClient, err := mockClient(ts.URL)\n    ss := elastic.NewSearchService(esClient)\n    mockLibESClient := es_mock.NewMockSearcherClient(mockCtrl)\n    mockLibESClient.EXPECT().GetEmployeeSearchServices(ctx).Return(ss, nil)\n</code></pre>\n\n<p>where mockLibESClient is the library I mentioned, and we stub the <code>mockLibESClient.GetEmployeeSearchServices</code> method making it return the SearchService with that will return the expected payload. </p>\n\n<p>Note: for creating the mock mockLibESClient I used <a href=\"https://github.com/golang/mock\" rel=\"nofollow noreferrer\">https://github.com/golang/mock</a> </p>\n\n<p>I found this to be convoluted, but \"Wrapping\" the elastic.Client was in my point of view more work. </p>\n\n<p>Question: I tried to mock it by using <code>https://github.com/vburenin/ifacemaker</code> to create an interface, and then mock that interface with <code>https://github.com/golang/mock</code> and kind of use it, but I kept getting compatibility errors when trying to return an interface instead of a struct, I'm not a Go expect at all so probably I needed to understand the typecasting a little better to be able to solve it like that.  So if any of you know how to do it with that please let me know. </p>\n"}], "owner": {"reputation": 643, "user_id": 2402831, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2c32d36536daf6acc5634e65379b691?s=128&d=identicon&r=PG", "display_name": "user2402831", "link": "https://stackoverflow.com/users/2402831/user2402831"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3661, "favorite_count": 2, "answer_count": 2, "score": 5, "last_activity_date": 1516486953, "creation_date": 1423657639, "question_id": 28454337, "link": "https://stackoverflow.com/questions/28454337/golang-mocking-with-elastic", "title": "Golang Mocking with Elastic", "body": "<p>I've built a quick and easy API in Go that queries ElasticSearch. Now that I know it can be done, I want to do it correctly by adding tests. I've abstracted some of my code so that it can be unit-testable, but I've been having some issues mocking the elastic library, and as such I figured it would be best if I tried a simple case to mock just that.</p>\n\n<pre><code>import (\n    \"encoding/json\"\n    \"github.com/olivere/elastic\"\n    \"net/http\"\n)\n...\nfunc CheckBucketExists(name string, client *elastic.Client) bool {\n    exists, err := client.IndexExists(name).Do()\n    if err != nil {\n        panic(err)\n    }\n    return exists\n}\n</code></pre>\n\n<p>And now the test...</p>\n\n<pre><code>  import (\n      \"fmt\"\n      \"github.com/stretchr/testify/assert\"\n      \"github.com/stretchr/testify/mock\"\n      \"testing\"\n  )\n\ntype MockClient struct {\n      mock.Mock\n  }\n\n  func (m *MockClient) IndexExists(name string) (bool, error) {\n      args := m.Mock.Called()\n      fmt.Println(\"This is a thing\")\n      return args.Bool(0), args.Error(1)\n  }\n\n  func TestMockBucketExists(t *testing.T) {\n      m := MockClient{}\n      m.On(\"IndexExists\", \"thisuri\").Return(true)\n\n&gt;&gt;    r := CheckBucketExists(\"thisuri\", m)\n      assert := assert.New(t)\n      assert.True(r, true)\n  }\n</code></pre>\n\n<p>To which I'm yielded with the following error: <code>cannot use m (type MockClient) as type *elastic.Client in argument to CheckBucketExists</code>.</p>\n\n<p>I'm assuming this is something fundamental with my use of the elastic.client type, but I'm still too much of a noob. </p>\n"}, {"tags": ["pointers", "go"], "answers": [{"comments": [{"owner": {"reputation": 716, "user_id": 4527988, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1ddf49cc8851b301a92455d730200161?s=128&d=identicon&r=PG&f=1", "display_name": "Raghav salotra", "link": "https://stackoverflow.com/users/4527988/raghav-salotra"}, "edited": false, "score": 0, "creation_date": 1423658066, "post_id": 28454412, "comment_id": 45235841, "body": "Thank u, that was really helpful.. :)"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 7, "last_activity_date": 1423657849, "creation_date": 1423657849, "answer_id": 28454412, "question_id": 28454089, "link": "https://stackoverflow.com/questions/28454089/what-does-that-mean-when-we-say-uintptr-stores-the-uninterpreted-bits-of-a-point/28454412#28454412", "title": "What does that mean when we say uintptr stores the uninterpreted bits of a pointer value?", "body": "<p>Short answer: it's used when you need to use an address as if it's a number.</p>\n\n<p>Go is a garbage-collected language. Go always knows exactly, when a thing is a pointer, and when it's just a value. Go needs this knowledge to look for old unused values that it can free. Pointers are also special in Go in that you can't just add a number to a pointer like you would do in C.</p>\n\n<p>But sometimes, when you work with embedded systems or some kind of low-level libraries where you need to add or subtract from an address, you need to tell Go that it shouldn't check this pointer because it's not pointing to anything useful at the moment. You just want to use this address as if it was a number and add/subtract another number to it.</p>\n\n<p>This is where you would use <code>uintptr</code>. This type can hold any pointer value (any address), and when you put an address into it, Go doesn't see it as a pointer, so you can do whatever you want with it.</p>\n"}], "owner": {"reputation": 716, "user_id": 4527988, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1ddf49cc8851b301a92455d730200161?s=128&d=identicon&r=PG&f=1", "display_name": "Raghav salotra", "link": "https://stackoverflow.com/users/4527988/raghav-salotra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 1, "accepted_answer_id": 28454412, "answer_count": 1, "score": 3, "last_activity_date": 1423657849, "creation_date": 1423656779, "question_id": 28454089, "link": "https://stackoverflow.com/questions/28454089/what-does-that-mean-when-we-say-uintptr-stores-the-uninterpreted-bits-of-a-point", "title": "What does that mean when we say uintptr stores the uninterpreted bits of a pointer value?", "body": "<p>I read in golang website that uintptr stores the uninterpreted bits of a pointer value, the kind of anwsers that i found on web were very confusing.Can someone please explaing this to me in simple words .</p>\n"}, {"tags": ["security", "authentication", "go", "websocket", "gorilla"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2787959"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1423666833, "post_id": 28452222, "comment_id": 45241397, "body": "@ThunderCat Ok, so it seems that I have misunderstood the article. Is it because it is specific to Socket.IO?"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 5, "last_activity_date": 1426869693, "creation_date": 1426869693, "answer_id": 29171651, "question_id": 28452222, "link": "https://stackoverflow.com/questions/28452222/authentication-in-golang-websocket-application/29171651#29171651", "title": "Authentication in Golang WebSocket application", "body": "<p>Authenticate as you would for a plain HTTP request before <a href=\"http://godoc.org/github.com/gorilla/websocket#Upgrader.Upgrade\" rel=\"noreferrer\">upgrading</a> the connection to the WebSocket protocol. Use whatever methods or packages you would use for plain HTTP requests.</p>\n\n<p>A WebSocket connection can be hijacked to the extent that a plain HTTP connection can be hijacked. The WebSocket protocol does not introduce any new issues here.</p>\n\n<p>Socket.io is a layer above WebSockets, long-polling and other techniques for sending events from the server to a browser client. Issues with Socket.io do not necessarily apply to direct use of a WebSocket.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2787959"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4057, "favorite_count": 0, "accepted_answer_id": 29171651, "answer_count": 1, "score": 3, "last_activity_date": 1426869693, "creation_date": 1423651299, "last_edit_date": 1424187647, "question_id": 28452222, "link": "https://stackoverflow.com/questions/28452222/authentication-in-golang-websocket-application", "title": "Authentication in Golang WebSocket application", "body": "<p>I am trying to implement user authentication in an application that primarily uses WebSockets, but I am unsure how to begin.</p>\n\n<p>I am using the Gorilla mux and websocket packages.</p>\n\n<p>I have thought about using the method described <a href=\"https://github.com/matryer/goblueprints/tree/master/chapter3/chat\" rel=\"nofollow\">here</a> (files main.go and auth.go), but does this approach secure against authenticated users somehow hijacking each others sockets like described in <a href=\"https://auth0.com/blog/2014/01/15/auth-with-socket-io/\" rel=\"nofollow\">this article</a>?</p>\n\n<p>Can someone suggest a good method or package(s) in Go?</p>\n"}, {"tags": ["http", "templates", "go", "server", "go-templates"], "comments": [{"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1423649946, "post_id": 28451675, "comment_id": 45230991, "body": "I think we need more information to be able to give a good answer."}, {"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "edited": false, "score": 1, "creation_date": 1423650162, "post_id": 28451675, "comment_id": 45231118, "body": "You can try to profile it to see what it is doing by adding <code>import _ &quot;net&#47;http&#47;pprof&quot;</code> . See <a href=\"http://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">blog.golang.org/profiling-go-programs</a> for more information."}], "answers": [{"comments": [{"owner": {"reputation": 717, "user_id": 4445806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c5d013c30989c84e693d5f06458d4bde?s=128&d=identicon&r=PG&f=1", "display_name": "catric mia", "link": "https://stackoverflow.com/users/4445806/catric-mia"}, "edited": false, "score": 0, "creation_date": 1423658471, "post_id": 28453523, "comment_id": 45236075, "body": "Got it! Thank you so much!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 12, "last_activity_date": 1509101529, "last_edit_date": 1509101529, "creation_date": 1423655006, "answer_id": 28453523, "question_id": 28451675, "link": "https://stackoverflow.com/questions/28451675/it-takes-too-much-time-when-using-template-package-to-generate-a-dynamic-web-p/28453523#28453523", "title": "It takes too much time when using &quot;template&quot; package to generate a dynamic web page to client in Golang", "body": "<p>You should not parse templates every time you serve a request!</p>\n\n<p>There is a significant time delay to read a file, parse its content and build the template. Also since templates do not change (varying parts should be parameters!) you only have to read and parse a template once.<br>\nAlso parsing and creating the template each time when serving a request generates lots of values in memory which are then thrown away (because they are not reused) giving additional work for the garbage collector.</p>\n\n<p>Parse the templates when your application starts, store it in a variable, and you only have to execute the template when a request comes in. For example:</p>\n\n<pre><code>var t *template.Template\n\nfunc init() {\n    filename := NiConfig.webpath + \"/test.html\"\n    t = template.Must(template.ParseFiles(filename))\n\n    http.HandleFunc(\"/test\", TestHandler)\n}\n\nfunc TestHandler(w http.ResponseWriter, r *http.Request) {\n    Log.Info(\"Entering TestHandler ...\")\n    // Template is ready, just Execute it\n    if err := t.Execute(w, nil); err != nil {\n        log.Printf(\"Failed to execute template: %v\", err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 717, "user_id": 4445806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c5d013c30989c84e693d5f06458d4bde?s=128&d=identicon&r=PG&f=1", "display_name": "catric mia", "link": "https://stackoverflow.com/users/4445806/catric-mia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1726, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1554154963, "creation_date": 1423649702, "last_edit_date": 1554154963, "question_id": 28451675, "link": "https://stackoverflow.com/questions/28451675/it-takes-too-much-time-when-using-template-package-to-generate-a-dynamic-web-p", "title": "It takes too much time when using &quot;template&quot; package to generate a dynamic web page to client in Golang", "body": "<p>It is so slow when using <code>template</code> package to generate a dynamic web page to client. </p>\n\n<p>Testing code as below, golang 1.4.1</p>\n\n<pre><code>http.Handle(\"/js/\", (http.FileServer(http.Dir(webpath))))\nhttp.Handle(\"/css/\", (http.FileServer(http.Dir(webpath))))\nhttp.Handle(\"/img/\", (http.FileServer(http.Dir(webpath))))\nhttp.HandleFunc(\"/test\", TestHandler)\n\n\nfunc TestHandler(w http.ResponseWriter, r *http.Request) {\n\n    Log.Info(\"Entering TestHandler ...\")\n    r.ParseForm()\n\n    filename := NiConfig.webpath + \"/test.html\"\n\n    t, err := template.ParseFiles(filename)\n    if err != nil {\n        Log.Error(\"template.ParseFiles err = %v\", err)\n    } \n\n    t.Execute(w, nil)\n}\n</code></pre>\n\n<p>According to the log, I found that it took about 3 seconds in <code>t.Execute(w, nil)</code>, I do not know why it uses so much time. I also tried Apache server to test <code>test.html</code>, it responded very fast.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1423649432, "post_id": 28451435, "comment_id": 45230680, "body": "Fist of all, thanks very much. It is wrong to use panic, instead of <code>if err != nil</code> statement?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 1, "creation_date": 1423653505, "post_id": 28451435, "comment_id": 45233048, "body": "@zero_coding <code>panic</code> and <code>recover</code> have their uses, but they should be used only in <i>exceptional</i> cases. Prefer &quot;normal&quot; error handling if possible. For more details read <a href=\"http://golang.org/doc/faq#exceptions\" rel=\"nofollow noreferrer\">Why does Go not have exceptions?</a>, and blog posts <a href=\"http://blog.golang.org/error-handling-and-go\" rel=\"nofollow noreferrer\">Error handling and Go</a> and <a href=\"http://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow noreferrer\">Defer, Panic, and Recover</a>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1423663988, "last_edit_date": 1423663988, "creation_date": 1423648945, "answer_id": 28451435, "question_id": 28451380, "link": "https://stackoverflow.com/questions/28451380/how-to-handle-panic-outside/28451435#28451435", "title": "How to handle panic outside", "body": "<p>If you call <code>explode()</code> first, the function that would handle the <code>panic</code> and try to recover is not yet registered (and never will be because you call <code>panic</code> inside <code>explode()</code>), so it won't be called and obviously it can't do its work.</p>\n\n<p>You have to call <code>defer</code> first and then the <code>explode()</code> function:</p>\n\n<pre><code>defer func() {\n    // recover() here, Your code omitted\n}()\nexplode()\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/po5k7hBYnU\" rel=\"nofollow\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "accepted_answer_id": 28451435, "answer_count": 1, "score": 2, "last_activity_date": 1423663988, "creation_date": 1423648799, "question_id": 28451380, "link": "https://stackoverflow.com/questions/28451380/how-to-handle-panic-outside", "title": "How to handle panic outside", "body": "<p>Look at the following code snippet.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc explode() {\n    // Cause a panic.\n    panic(\"WRONG\")\n}\n\nfunc recovery() int {\n    explode()\n    defer func() {\n        fmt.Println(\"Try to handle panic\")\n        if err := recover(); err != nil {\n            fmt.Println(\"FIX\")\n            fmt.Println(\"ERR\", err)\n        }\n    }()\n    fmt.Println(\"Print value\")\n    return 100\n\n}\n\nfunc main() {\n    // Handle errors in defer func with recover.\n    fmt.Println(recovery())\n}\n</code></pre>\n\n<p>As you can see code above, I fired a panic in the explode function and want to handle it in the recovery function. But the panic does not get caught, I've got runtime error </p>\n\n<pre><code>goroutine 1 [running]:\nmain.explode()\n        D:/gocode/src/samples/panic1.go:7 +0x6b\nmain.recovery(0xc082002250)\n        D:/gocode/src/samples/panic1.go:18 +0x26\nmain.main()\n        D:/gocode/src/samples/panic1.go:27 +0x26\n\ngoroutine 2 [runnable]:\nruntime.forcegchelper()\n        c:/go/src/runtime/proc.go:90\nruntime.goexit()\n        c:/go/src/runtime/asm_amd64.s:2232 +0x1\n\ngoroutine 3 [runnable]:\nruntime.bgsweep()\n        c:/go/src/runtime/mgc0.go:82\nruntime.goexit()\n        c:/go/src/runtime/asm_amd64.s:2232 +0x1\n\ngoroutine 4 [runnable]:\nruntime.runfinq()\n        c:/go/src/runtime/malloc.go:712\nruntime.goexit()\n        c:/go/src/runtime/asm_amd64.s:2232 +0x1\nexit status 2\n</code></pre>\n\n<p>How to catch the panic in the recory function? </p>\n"}, {"tags": ["windows", "unit-testing", "google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 1167906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1f07a05d9d92b39b546a30f7765ec08?s=128&d=identicon&r=PG", "display_name": "Arthur G", "link": "https://stackoverflow.com/users/1167906/arthur-g"}, "edited": false, "score": 0, "creation_date": 1423729773, "post_id": 28453780, "comment_id": 45269268, "body": "It just not work. <code>goapp test</code> not search in current directory, because he search in <code>&#47;path&#47;to&#47;sdk&#47;go_appengine&#47;gopath</code>. And if i use path to my package, he didn&#39;t find depended packages. Why not found? Cause he search not in current dir."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1423656254, "last_edit_date": 1423656254, "creation_date": 1423655869, "answer_id": 28453780, "question_id": 28451266, "link": "https://stackoverflow.com/questions/28451266/how-to-test-app-engine-project-on-windows-system/28453780#28453780", "title": "How to test App Engine project on Windows system?", "body": "<p><code>goapp test</code> looks for <code>*_test.go</code> files in the current directory if you don't specify the packages as parameters.</p>\n\n<p>So either:</p>\n\n<ul>\n<li>navigate to the package directory which you want to test and which contains the <code>XX_test.go</code> files then execute the <code>goapp test</code> command</li>\n<li>or stay in your project folder and pass the package folder as parameter like this:<br>\n<code>goapp test ./my/package</code></li>\n</ul>\n\n<p>Read more about <a href=\"https://cloud.google.com/appengine/docs/go/tools/localunittesting/\" rel=\"nofollow\">Local Unit Testing for Go</a>.</p>\n"}], "owner": {"reputation": 117, "user_id": 1167906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1f07a05d9d92b39b546a30f7765ec08?s=128&d=identicon&r=PG", "display_name": "Arthur G", "link": "https://stackoverflow.com/users/1167906/arthur-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423656254, "creation_date": 1423648475, "question_id": 28451266, "link": "https://stackoverflow.com/questions/28451266/how-to-test-app-engine-project-on-windows-system", "title": "How to test App Engine project on Windows system?", "body": "<p>Standart way: <code>goapp test</code> \u2014 doesn't work.</p>\n\n<p>Output:</p>\n\n<pre><code>D:\\Projects\\MyProject&gt;goapp test\ncan't load package: package .: no buildable Go source files in D:\\Projects\\MyProject\n</code></pre>\n"}, {"tags": ["go", "mkdir"], "answers": [{"comments": [{"owner": {"reputation": 5146, "user_id": 851835, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/20bf44ece0e0db121f9a44812b113e03?s=128&d=identicon&r=PG", "display_name": "updogliu", "link": "https://stackoverflow.com/users/851835/updogliu"}, "edited": false, "score": 2, "creation_date": 1565148801, "post_id": 28448702, "comment_id": 101256549, "body": "You may want to choose between <code>0755</code> and <code>os.ModePerm</code>."}], "tags": [], "owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "is_accepted": true, "score": 202, "last_activity_date": 1553597236, "last_edit_date": 1553597236, "creation_date": 1423639513, "answer_id": 28448702, "question_id": 28448543, "link": "https://stackoverflow.com/questions/28448543/how-to-create-nested-directories-using-mkdir-in-golang/28448702#28448702", "title": "How to create nested directories using Mkdir in Golang?", "body": "<p><code>os.Mkdir</code> is used to create a single directory. To create a folder path, instead try using:</p>\n\n<pre><code>os.MkdirAll(folderPath, os.ModePerm)\n</code></pre>\n\n<p><a href=\"http://golang.org/pkg/os/#MkdirAll\" rel=\"noreferrer\">Go documentation</a></p>\n\n<blockquote>\n  <p>func MkdirAll(path string, perm FileMode) error  </p>\n  \n  <p>MkdirAll creates a directory named path, along with any necessary parents, and returns nil, or else returns an error. The permission bits perm are used for all directories that MkdirAll creates. If path is already a directory, MkdirAll does nothing and returns nil.</p>\n</blockquote>\n\n<p><strong>Edit:</strong></p>\n\n<p>Updated to correctly use <code>os.ModePerm</code> instead.<br>\nFor concatenation of file paths, use package <code>path/filepath</code> as described in @Chris' answer. </p>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 6, "last_activity_date": 1423639905, "last_edit_date": 1495540049, "creation_date": 1423639566, "answer_id": 28448727, "question_id": 28448543, "link": "https://stackoverflow.com/questions/28448543/how-to-create-nested-directories-using-mkdir-in-golang/28448727#28448727", "title": "How to create nested directories using Mkdir in Golang?", "body": "<p>If the issue is to create all the necessary parent directories, you could consider using <a href=\"http://golang.org/pkg/os/#MkdirAll\" rel=\"nofollow noreferrer\"><code>os.MkDirAll()</code></a></p>\n\n<blockquote>\n  <p><code>MkdirAll</code> creates a directory named path, along with any necessary parents, and returns nil, or else returns an error.</p>\n</blockquote>\n\n<p>The <a href=\"https://github.com/golang/go/blob/f3b73e040c24c5a589373e431b91babc249640bc/src/os/path_test.go#L18-L25\" rel=\"nofollow noreferrer\">path_test.go</a> is a good illustration on how to use it:</p>\n\n<pre><code>func TestMkdirAll(t *testing.T) {\n    tmpDir := TempDir()\n    path := tmpDir + \"/_TestMkdirAll_/dir/./dir2\"\n    err := MkdirAll(path, 0777)\n    if err != nil {\n    t.Fatalf(\"MkdirAll %q: %s\", path, err)\n    }\n    defer RemoveAll(tmpDir + \"/_TestMkdirAll_\")\n...\n}\n</code></pre>\n\n<p>(Make sure to specify a sensible permission value, as mentioned in <a href=\"https://stackoverflow.com/a/14921772/6309\">this answer</a>)</p>\n"}, {"comments": [{"owner": {"reputation": 26894, "user_id": 19020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VpVEj.jpg?s=128&g=1", "display_name": "Dan Esparza", "link": "https://stackoverflow.com/users/19020/dan-esparza"}, "edited": false, "score": 3, "creation_date": 1495381531, "post_id": 34451620, "comment_id": 75217898, "body": "This is the correct answer.  Much simpler and platform agnostic."}], "tags": [], "owner": {"reputation": 37028, "user_id": 59198, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6448b40e7037dd0fda767f2370c31809?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/59198/chris"}, "is_accepted": false, "score": 112, "last_activity_date": 1450954357, "creation_date": 1450954357, "answer_id": 34451620, "question_id": 28448543, "link": "https://stackoverflow.com/questions/28448543/how-to-create-nested-directories-using-mkdir-in-golang/34451620#34451620", "title": "How to create nested directories using Mkdir in Golang?", "body": "<p>This way you don't have to use any magic numbers:</p>\n\n<pre><code>os.MkdirAll(newPath, os.ModePerm)\n</code></pre>\n\n<p>Also, rather than using + to create paths, you can use:</p>\n\n<pre><code>import \"path/filepath\"\npath := filepath.Join(someRootPath, someSubPath)\n</code></pre>\n\n<p>The above uses the correct separators automatically on each platform for you.</p>\n"}, {"tags": [], "owner": {"reputation": 3454, "user_id": 1389118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e255cf198f6b068a1f6b56fe6809bda7?s=128&d=identicon&r=PG", "display_name": "skipy", "link": "https://stackoverflow.com/users/1389118/skipy"}, "is_accepted": false, "score": 4, "last_activity_date": 1546401857, "creation_date": 1546401857, "answer_id": 54001062, "question_id": 28448543, "link": "https://stackoverflow.com/questions/28448543/how-to-create-nested-directories-using-mkdir-in-golang/54001062#54001062", "title": "How to create nested directories using Mkdir in Golang?", "body": "<p>An utility method like the following can be used to solve this.</p>\n\n<pre><code>import (\n  \"os\"\n  \"path/filepath\"\n  \"log\"\n)\n\nfunc ensureDir(fileName string) {\n  dirName := filepath.Dir(fileName)\n  if _, serr := os.Stat(dirName); serr != nil {\n    merr := os.MkdirAll(dirName, os.ModePerm)\n    if merr != nil {\n        panic(merr)\n    }\n  }\n}\n\n\n\nfunc main() {\n  _, cerr := os.Create(\"a/b/c/d.txt\")\n  if cerr != nil {\n    log.Fatal(\"error creating a/b/c\", cerr)\n  }\n  log.Println(\"created file in a sub-directory.\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1746, "user_id": 5785743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a09b5b4639c7459d79f565db0d63da?s=128&d=identicon&r=PG&f=1", "display_name": "pr-pal", "link": "https://stackoverflow.com/users/5785743/pr-pal"}, "is_accepted": false, "score": 2, "last_activity_date": 1560573284, "creation_date": 1560573284, "answer_id": 56607362, "question_id": 28448543, "link": "https://stackoverflow.com/questions/28448543/how-to-create-nested-directories-using-mkdir-in-golang/56607362#56607362", "title": "How to create nested directories using Mkdir in Golang?", "body": "<p>This is one alternative for achieving the same but it avoids race condition caused by having two distinct \"check ..and.. create\" operations.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main()  {\n    if err := ensureDir(\"/test-dir\"); err != nil {\n        fmt.Println(\"Directory creation failed with error: \" + err.Error())\n        os.Exit(1)\n    }\n    // Proceed forward\n}\n\nfunc ensureDir(dirName string) error {\n\n    err := os.MkdirAll(dirName, os.ModeDir)\n\n    if err == nil || os.IsExist(err) {\n        return nil\n    } else {\n        return err\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1241, "user_id": 1992958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0721164a42f57063619d1dae85e89a?s=128&d=identicon&r=PG", "display_name": "tommymcdonald", "link": "https://stackoverflow.com/users/1992958/tommymcdonald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112570, "favorite_count": 15, "accepted_answer_id": 28448702, "answer_count": 5, "score": 108, "last_activity_date": 1560573284, "creation_date": 1423638916, "last_edit_date": 1544529344, "question_id": 28448543, "link": "https://stackoverflow.com/questions/28448543/how-to-create-nested-directories-using-mkdir-in-golang", "title": "How to create nested directories using Mkdir in Golang?", "body": "<p>I am trying to create a set of nested directories from a Go executable such as 'dir1/dir2/dir3'. I have succeeded in creating a single directory with this line:</p>\n\n<pre><code>os.Mkdir(\".\" + string(filepath.Separator) + c.Args().First(),0777);\n</code></pre>\n\n<p>However, I have no idea how to approach creating a predetermined nested set of directories inside of that directory.</p>\n"}, {"tags": ["struct", "go"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 5, "creation_date": 1423634903, "post_id": 28447297, "comment_id": 45223896, "body": "Session{} isn&#39;t an &quot;empty&quot; session; it&#39;s initialized with each field being the zero value."}], "answers": [{"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 5, "creation_date": 1468198429, "post_id": 28447372, "comment_id": 64012499, "body": "@kristen Dereference the pointer and compare.  If <code>session</code> is a non-nil <code>*Session</code>, then use <code>if (Session{} == *session {</code>."}, {"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 5, "creation_date": 1471312004, "post_id": 28447372, "comment_id": 65285521, "body": "So I get an error, <code>struct containing []byte cannot be compared</code>, because, well, my struct contains a byte slice."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 19, "creation_date": 1471317024, "post_id": 28447372, "comment_id": 65286610, "body": "@Nevermore The answer applies to a struct with comparable fields. If your struct contains non-comparable values like []byte, then you need to write code to test all fields or use the reflect package as outlined in another answer."}, {"owner": {"reputation": 157, "user_id": 1311538, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1dc49f99b84275d3364164127bf190d?s=128&d=identicon&r=PG", "display_name": "asgaines", "link": "https://stackoverflow.com/users/1311538/asgaines"}, "reply_to_user": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 2, "creation_date": 1540789659, "post_id": 28447372, "comment_id": 92977588, "body": "As mentioned by @Nevermore, <code>==</code> comparison with slice fields will fail. For comparing these structs, use either <code>reflect.DeepEqual</code> or consider something more specialized like discussed here: <a href=\"https://stackoverflow.com/questions/24534072/how-to-compare-struct-slice-map-are-equal\" title=\"how to compare struct slice map are equal\">stackoverflow.com/questions/24534072/&hellip;</a>"}, {"owner": {"reputation": 5242, "user_id": 601862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-2Y6YEzkNuKo/AAAAAAAAAAI/AAAAAAAAIsI/fpM-2_aHwnk/photo.jpg?sz=128", "display_name": "Franva", "link": "https://stackoverflow.com/users/601862/franva"}, "edited": false, "score": 0, "creation_date": 1550620717, "post_id": 28447372, "comment_id": 96333202, "body": "&quot;parsing ambiguity in [if condition]&quot; saved my day, thanks :) coz when I was trying it in fmt.Println(session == Session{}), it works."}, {"owner": {"reputation": 1168, "user_id": 786389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a3c4e1a6577f9a0a0b1c169588472f?s=128&d=identicon&r=PG", "display_name": "y3sh", "link": "https://stackoverflow.com/users/786389/y3sh"}, "edited": false, "score": 0, "creation_date": 1564667585, "post_id": 28447372, "comment_id": 101113486, "body": "In performance-sensitive scenarios, is checking a struct value faster than empty struct comparison? e.g <code>session.timestamp == nil</code> vs <code>(Session{}) == session</code>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 212, "last_activity_date": 1540790477, "last_edit_date": 1540790477, "creation_date": 1423633486, "answer_id": 28447372, "question_id": 28447297, "link": "https://stackoverflow.com/questions/28447297/how-to-check-for-an-empty-struct/28447372#28447372", "title": "How to check for an empty struct?", "body": "<p>You can use == to compare with a zero value composite literal because all fields are <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"noreferrer\">comparable</a>:</p>\n\n<pre><code>if (Session{}) == session  {\n    fmt.Println(\"is zero value\")\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/wRUmxj1naS\" rel=\"noreferrer\">playground example</a></p>\n\n<p>Because of a <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"noreferrer\">parsing ambiguity</a>, parentheses are required around the composite literal in the if condition.</p>\n\n<p>The use of <code>==</code> above applies to structs where all fields are <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"noreferrer\">comparable</a>. If the struct contains a non-comparable field (slice, map or function), then the fields must be compared one by one to their zero values.</p>\n\n<p>An alternative to comparing the entire value is to compare a field that must be set to a non-zero value in a valid session. For example, if the player id must be != \"\" in a valid session, use </p>\n\n<pre><code>if session.playerId == \"\" {\n    fmt.Println(\"is zero value\")\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 722, "user_id": 3072751, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/8J58M.jpg?s=128&g=1", "display_name": "thurt", "link": "https://stackoverflow.com/users/3072751/thurt"}, "edited": false, "score": 3, "creation_date": 1513743015, "post_id": 28447392, "comment_id": 82763979, "body": "using reflect.DeepEqual is a very clean solution but i wonder if it takes more  processing time? i assume it is comparing every field, plus you introduce a new import."}], "tags": [], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "is_accepted": false, "score": 22, "last_activity_date": 1423633563, "creation_date": 1423633563, "answer_id": 28447392, "question_id": 28447297, "link": "https://stackoverflow.com/questions/28447297/how-to-check-for-an-empty-struct/28447392#28447392", "title": "How to check for an empty struct?", "body": "<p>Using <a href=\"http://golang.org/pkg/reflect/#DeepEqual\" rel=\"noreferrer\">reflect.deepEqual</a> also <a href=\"http://play.golang.org/p/UsMuDZlnli\" rel=\"noreferrer\">works</a>, especially when you have map inside the struct</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\nimport \"reflect\"\n\ntype Session struct {\n    playerId string\n    beehive string\n    timestamp time.Time\n}\n\nfunc (s Session) IsEmpty() bool {\n  return reflect.DeepEqual(s,Session{})\n}\n\nfunc main() {\n  x := Session{}\n  if x.IsEmpty() {\n    fmt.Print(\"is empty\")\n  } \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1842, "user_id": 472153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8769b1ed68930f7adee6b6ed3425f2e?s=128&d=identicon&r=PG", "display_name": "Evgeny Goldin", "link": "https://stackoverflow.com/users/472153/evgeny-goldin"}, "edited": false, "score": 0, "creation_date": 1473448960, "post_id": 28449449, "comment_id": 66161772, "body": "Great answer. Thank you, icza!"}, {"owner": {"reputation": 374, "user_id": 1135241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c3887b1db529c83229af9f76611fa18?s=128&d=identicon&r=PG", "display_name": "DeivinsonTejeda", "link": "https://stackoverflow.com/users/1135241/deivinsontejeda"}, "edited": false, "score": 1, "creation_date": 1508157110, "post_id": 28449449, "comment_id": 80486096, "body": "Awesome answer! I think following the last choice looks pretty idiomatic."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 43, "last_activity_date": 1423669335, "last_edit_date": 1423669335, "creation_date": 1423642360, "answer_id": 28449449, "question_id": 28447297, "link": "https://stackoverflow.com/questions/28447297/how-to-check-for-an-empty-struct/28449449#28449449", "title": "How to check for an empty struct?", "body": "<p>Here are 3 more suggestions or techniques:</p>\n\n<h3>With an Additional Field</h3>\n\n<p>You can add an additional field to tell if the struct has been populated or it is empty. I intentionally named it <code>ready</code> and not <code>empty</code> because the zero value of a <code>bool</code> is <code>false</code>, so if you create a new struct like <code>Session{}</code> its <code>ready</code> field will be automatically <code>false</code> and it will tell you the truth: that the struct is not-yet ready (it's empty).</p>\n\n<pre><code>type Session struct {\n    ready bool\n\n    playerId string\n    beehive string\n    timestamp time.Time\n}\n</code></pre>\n\n<p>When you initialize the struct, you have to set <code>ready</code> to <code>true</code>. Your <code>isEmpty()</code> method isn't needed anymore (although you can create one if you want to) because you can just test the <code>ready</code> field itself.</p>\n\n<pre><code>var s Session\n\nif !s.ready {\n    // do stuff (populate s)\n}\n</code></pre>\n\n<p>Significance of this one additional <code>bool</code> field increases as the struct grows bigger or if it contains fields which are not comparable (e.g. slice, <code>map</code> and function values).</p>\n\n<h3>Using the Zero Value of an Existing Field</h3>\n\n<p>This is similar to the previous suggestion, but it uses the zero value of an existing field which is considered <em>invalid</em> when the struct is not empty. Usability of this is implementation dependant.</p>\n\n<p>For example if in your example your <code>playerId</code> cannot be the empty <code>string</code> <code>\"\"</code>, you can use it to test if your struct is empty like this:</p>\n\n<pre><code>var s Session\n\nif s.playerId == \"\" {\n    // do stuff (populate s, give proper value to playerId)\n}\n</code></pre>\n\n<p>In this case it's worth incorporating this check into an <code>isEmpty()</code> method because this check is implementation dependant:</p>\n\n<pre><code>func (s Session) isEmpty() bool {\n    return s.playerId == \"\"\n}\n</code></pre>\n\n<p>And using it:</p>\n\n<pre><code>if s.isEmpty() {\n    // do stuff (populate s, give proper value to playerId)\n}\n</code></pre>\n\n<h3>Use Pointer to your struct</h3>\n\n<p>The second suggestion is to use a Pointer to your struct: <code>*Session</code>. Pointers can have <code>nil</code> values, so you can test for it:</p>\n\n<pre><code>var s *Session\n\nif s == nil {\n    s = new(Session)\n    // do stuff (populate s)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "is_accepted": false, "score": 6, "last_activity_date": 1481733801, "creation_date": 1481733801, "answer_id": 41147803, "question_id": 28447297, "link": "https://stackoverflow.com/questions/28447297/how-to-check-for-an-empty-struct/41147803#41147803", "title": "How to check for an empty struct?", "body": "<p>Keep in mind that with pointers to struct you'd have to dereference the variable and not compare it with a pointer to empty struct:</p>\n\n<pre><code>session := &amp;Session{}\nif (Session{}) == *session {\n    fmt.Println(\"session is empty\")\n}\n</code></pre>\n\n<p>Check this <a href=\"https://play.golang.org/p/i4EjqJvALc\" rel=\"noreferrer\">playground</a>.</p>\n\n<p>Also here you can see that a struct holding a property which is a slice of pointers cannot be compared the same way...</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 7076892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ace0f6d11b93cbacfe6f4a68292fd7?s=128&d=identicon&r=PG&f=1", "display_name": "M.L.", "link": "https://stackoverflow.com/users/7076892/m-l"}, "is_accepted": false, "score": 1, "last_activity_date": 1484862018, "creation_date": 1484862018, "answer_id": 41752202, "question_id": 28447297, "link": "https://stackoverflow.com/questions/28447297/how-to-check-for-an-empty-struct/41752202#41752202", "title": "How to check for an empty struct?", "body": "<p>As an alternative to the other answers, it's possible to do this with a syntax similar to the way you originally intended if you do it via a <code>case</code> statement rather than an <code>if</code>:</p>\n\n<pre><code>session := Session{}\nswitch {\ncase Session{} == session:\n    fmt.Println(\"zero\")\ndefault:\n    fmt.Println(\"not zero\")\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/kgIqmRnA2M\" rel=\"nofollow noreferrer\" title=\"playground example\">playground example</a></p>\n"}, {"tags": [], "owner": {"reputation": 435, "user_id": 3498573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O1z25.jpg?s=128&g=1", "display_name": "Shibumi", "link": "https://stackoverflow.com/users/3498573/shibumi"}, "is_accepted": false, "score": 13, "last_activity_date": 1596735014, "creation_date": 1596735014, "answer_id": 63288877, "question_id": 28447297, "link": "https://stackoverflow.com/questions/28447297/how-to-check-for-an-empty-struct/63288877#63288877", "title": "How to check for an empty struct?", "body": "<p>Just a quick addition, because I tackled the same issue today:</p>\n<p>With Go 1.13 it is possible to use the new <code>isZero()</code> method:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>if reflect.ValueOf(session).IsZero() {\n     // do stuff...\n}\n</code></pre>\n<p>I didn't test this regarding performance, but I guess that this should be faster, than comparing via <code>reflect.DeepEqual()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 496, "user_id": 8367711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9Hu81.png?s=128&g=1", "display_name": "KEINOS", "link": "https://stackoverflow.com/users/8367711/keinos"}, "is_accepted": false, "score": 0, "last_activity_date": 1618542816, "creation_date": 1618542816, "answer_id": 67118617, "question_id": 28447297, "link": "https://stackoverflow.com/questions/28447297/how-to-check-for-an-empty-struct/67118617#67118617", "title": "How to check for an empty struct?", "body": "<p>@cerise-lim\u00f3n's <a href=\"https://stackoverflow.com/a/28447372/8367711\">answer</a> was the best. Though, if you get <code>struct containing ... cannot be compared</code> error like below.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>type Friends struct {\n    nice []string\n    mute []string\n}\n\ntype Session struct {\n    playerId  string\n    beehive   string\n    timestamp time.Time\n    friends   Friends\n}\n\nfunc main() {\n    session := Session{}\n    if (Session{}) == session  {\n        fmt.Println(&quot;zero&quot;)\n    }\n}\n\n// Output: ./prog.go:23:17: invalid operation: Session{} == session (struct containing Friends cannot be compared)\n</code></pre>\n<p>The above, <code>Friends</code>' object is causing an error.</p>\n<p>The <strong>easy way</strong> to fix it is to define as a pointer in the field.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>type Friends struct {\n    nice []string\n    mute []string\n    \n}\n\ntype Session struct {\n    playerId  string\n    beehive   string\n    timestamp time.Time\n    friends   *Friends // &lt;--- here\n}\n\nfunc main() {\n    session := Session{}\n    if (Session{}) == session  {\n        fmt.Println(&quot;zero&quot;)\n    }\n}\n\n// Output: zero\n</code></pre>\n<ul>\n<li><a href=\"https://play.golang.org/p/ElRYDoKH7MS\" rel=\"nofollow noreferrer\">Go Playground Example</a></li>\n</ul>\n"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158630, "favorite_count": 22, "accepted_answer_id": 28447372, "answer_count": 7, "score": 140, "last_activity_date": 1618542816, "creation_date": 1423633037, "question_id": 28447297, "link": "https://stackoverflow.com/questions/28447297/how-to-check-for-an-empty-struct", "title": "How to check for an empty struct?", "body": "<p>I define a struct ...</p>\n\n<pre><code>type Session struct {\n    playerId string\n    beehive string\n    timestamp time.Time\n}\n</code></pre>\n\n<p>Sometimes I assign an empty session to it (because nil is not possible)</p>\n\n<pre><code>session = Session{};\n</code></pre>\n\n<p>Then I want to check, if it is empty:</p>\n\n<pre><code>if session == Session{} {\n     // do stuff...\n}\n</code></pre>\n\n<p>Obviously this is not working. How do I write it?</p>\n"}, {"tags": ["date", "go"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1423637711, "post_id": 28446796, "comment_id": 45224936, "body": "Could you elaborate on &quot;dates that don&#39;t represent a single point in time&quot;? Are they ranges?"}, {"owner": {"reputation": 1739, "user_id": 57357, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/46b892c9b15be26fec41fe9112410d5f?s=128&d=identicon&r=PG", "display_name": "Dan Tanner", "link": "https://stackoverflow.com/users/57357/dan-tanner"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1423676270, "post_id": 28446796, "comment_id": 45247550, "body": "Sorry for the confusion - I used the plural form to mean dates in general...for this scenario I&#39;m dealing with one date at a time."}, {"owner": {"reputation": 3216, "user_id": 1273978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dd2212a18f9aba8d63b14c552027a12?s=128&d=identicon&r=PG", "display_name": "metakeule", "link": "https://stackoverflow.com/users/1273978/metakeule"}, "edited": false, "score": 5, "creation_date": 1423758538, "post_id": 28446796, "comment_id": 45287392, "body": "You could also define your methods on      <code>type LocalDate time.Time</code> if you don&#39;t need embedding"}, {"owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "edited": false, "score": 0, "creation_date": 1423912778, "post_id": 28446796, "comment_id": 45347624, "body": "Check out this recent Go talk: <a href=\"http://talks.golang.org/2015/json.slide\" rel=\"nofollow noreferrer\">talks.golang.org/2015/json.slide</a>"}], "answers": [{"tags": [], "owner": {"reputation": 336, "user_id": 163668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/655035a55b549d3abfb34e962a59985d?s=128&d=identicon&r=PG", "display_name": "Alexei Andreev", "link": "https://stackoverflow.com/users/163668/alexei-andreev"}, "is_accepted": false, "score": 3, "last_activity_date": 1427590469, "creation_date": 1427590469, "answer_id": 29324455, "question_id": 28446796, "link": "https://stackoverflow.com/questions/28446796/whats-the-idiomatic-way-to-work-with-dates-without-time-in-golang/29324455#29324455", "title": "What&#39;s the idiomatic way to work with dates without time in golang?", "body": "<p>I think you can store your data as <code>time.Time</code> but convert it to a string for JSON purposes:</p>\n\n<pre><code>type LocalDate struct {\n  t time.Time `json:\",string\"` // might even work anonymously here\n}\n</code></pre>\n\n<p>To see how to make this work with SQL: <a href=\"https://github.com/go-sql-driver/mysql#timetime-support\" rel=\"nofollow noreferrer\">https://github.com/go-sql-driver/mysql#timetime-support</a></p>\n"}, {"tags": [], "owner": {"reputation": 2619, "user_id": 2249725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06905a0d11a7662cbadd4daffe029452?s=128&d=identicon&r=PG", "display_name": "mvndaai", "link": "https://stackoverflow.com/users/2249725/mvndaai"}, "is_accepted": false, "score": 5, "last_activity_date": 1589933405, "last_edit_date": 1589933405, "creation_date": 1589931679, "answer_id": 61902619, "question_id": 28446796, "link": "https://stackoverflow.com/questions/28446796/whats-the-idiomatic-way-to-work-with-dates-without-time-in-golang/61902619#61902619", "title": "What&#39;s the idiomatic way to work with dates without time in golang?", "body": "<p>I use <code>civil.Date</code> from the package <a href=\"https://pkg.go.dev/cloud.google.com/go/civil\" rel=\"noreferrer\">cloud.google.com/go/civil</a></p>\n"}], "owner": {"reputation": 1739, "user_id": 57357, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/46b892c9b15be26fec41fe9112410d5f?s=128&d=identicon&r=PG", "display_name": "Dan Tanner", "link": "https://stackoverflow.com/users/57357/dan-tanner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13513, "favorite_count": 5, "answer_count": 2, "score": 22, "last_activity_date": 1589933405, "creation_date": 1423630151, "question_id": 28446796, "link": "https://stackoverflow.com/questions/28446796/whats-the-idiomatic-way-to-work-with-dates-without-time-in-golang", "title": "What&#39;s the idiomatic way to work with dates without time in golang?", "body": "<p>I'm writing a REST API in Go, working with dates that don't represent a single point in time.</p>\n\n<p>It's JSON data going to and from the server in \"2006-01-02\" format, with that data talking to a mysql database using DATE columns.</p>\n\n<p>One thing I've tried is to create a struct that embeds a Time, and implements JSON and SQL conversion interface implementations to be able to correctly interact with the endpoints while still having Time methods available for date math and formatting.  e.g.:</p>\n\n<pre><code>package localdate\n\nimport (\n    \"time\"\n    \"encoding/json\"\n    \"database/sql/driver\"\n)\n\ntype LocalDate struct {\n    time.Time\n}\n\nfunc NewLocalDate(year int, month time.Month, day int) LocalDate {\n    time := time.Date(year, month, day, 0, 0, 0, 0, time.UTC)\n    return LocalDate{Time: time}\n}\n\nconst LocalDateFormat = \"2006-01-02\" // yyyy-mm-dd\n\nfunc (ld *LocalDate) UnmarshalJSON(data []byte) error {\n    // parse and set the ld.Time variable\n}\n\nfunc (ld *LocalDate) MarshalJSON() ([]byte, error) {\n    return json.Marshal(ld.Format(LocalDateFormat))\n}\n\n// sql.Scanner implementation to convert a time.Time column to a LocalDate\nfunc (ld *LocalDate) Scan(value interface{}) error {}\n\n// sql/driver.Valuer implementation to go from LocalDate -&gt; time.Time\nfunc (ld *LocalDate) Value() (driver.Value, error)  {}\n\n// used to convert a LocalDate into something we can plug into a query\n// we could just use ld.Time, but that would send '2015-01-01 00:00:00 +0000 UTC'\n// instead of '2015-01-01' for the DATE query parameter.  (Which works for mysql, but is officially invalid SQL)\nfunc (ld *LocalDate) SqlDate() string  {\n    return ld.Format(LocalDateFormat)\n}\n</code></pre>\n\n<p>And then other structs can be of this type, and get 90% there to representing the date type in my problem domain.  </p>\n\n<p>The above code works, but I feel like I'm fighting against the Go current.  So a couple questions for the veterans of the language:  </p>\n\n<p>Do you think this code will cause more pain than it'll save?<br>\nIf so, what style would you recommend?</p>\n"}, {"tags": ["macos", "go", "terminal", "environment-variables"], "answers": [{"tags": [], "owner": {"reputation": 3127, "user_id": 2167797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ac8ecf899fb3365e8394844cb9081a1?s=128&d=identicon&r=PG", "display_name": "Linville", "link": "https://stackoverflow.com/users/2167797/linville"}, "is_accepted": true, "score": 5, "last_activity_date": 1423627681, "last_edit_date": 1495542752, "creation_date": 1423627681, "answer_id": 28446444, "question_id": 28446258, "link": "https://stackoverflow.com/questions/28446258/how-does-installers-set-path-variable-on-mac-osx/28446444#28446444", "title": "How does installers set PATH variable on Mac OSX?", "body": "<p>There are a couple methods of setting environment variables in Mac OS X (<a href=\"https://stackoverflow.com/q/25385934/2167797\">lots of discussion here</a>). In the case the Go package, it is adding a file in <code>/etc/paths.d</code> named <code>go</code> that contains <code>/usr/local/go/bin</code>. Here's an answer to another question <a href=\"https://apple.stackexchange.com/a/106814\">explaining that a utility called path_helper is being launched</a> and it's inspecting the <code>/etc/paths.d</code> directory.</p>\n\n<p>You can verify this yourself by using an application called <a href=\"https://www.charlessoft.com\" rel=\"nofollow noreferrer\">Pacifist</a> to inspect the contents of the Go package and looking at the files it's installing.</p>\n"}], "owner": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1488, "favorite_count": 0, "accepted_answer_id": 28446444, "answer_count": 1, "score": 2, "last_activity_date": 1423627681, "creation_date": 1423626295, "question_id": 28446258, "link": "https://stackoverflow.com/questions/28446258/how-does-installers-set-path-variable-on-mac-osx", "title": "How does installers set PATH variable on Mac OSX?", "body": "<p>I'm wondering how PATH variable is set by Mac Installers on Mac OSX.</p>\n\n<p>For example:</p>\n\n<p>Look at golang Mac OSX Installer. From the link <a href=\"https://golang.org/doc/install\" rel=\"nofollow\">https://golang.org/doc/install</a>:</p>\n\n<blockquote>\n  <p>Mac OS X package installer</p>\n  \n  <p>Download the package file, open it, and follow the prompts to install\n  the Go tools. The package installs the Go distribution to\n  /usr/local/go.</p>\n  \n  <p>The package should put the /usr/local/go/bin directory in your PATH\n  environment variable. You may need to restart any open Terminal\n  sessions for the change to take effect.</p>\n</blockquote>\n\n<p>So, the I can see /usr/local/go/bin in $PATH but it's not being set in .profile, .bashrc or launchd.conf.</p>\n\n<p>Can anybody please help me to understand?</p>\n"}, {"tags": ["go", "youtube-api", "google-api-go-client"], "comments": [{"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 1, "creation_date": 1423619957, "post_id": 28443412, "comment_id": 45220021, "body": "what youtube Go package are you using?"}], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "edited": false, "score": 0, "creation_date": 1423700871, "post_id": 28445646, "comment_id": 45259912, "body": "I can now read the current invideoPromotion data, but still cannot write through the api."}], "tags": [], "owner": {"reputation": 587, "user_id": 3587115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/veo3Q.jpg?s=128&g=1", "display_name": "Sundrique", "link": "https://stackoverflow.com/users/3587115/sundrique"}, "is_accepted": false, "score": 0, "last_activity_date": 1423738913, "last_edit_date": 1423738913, "creation_date": 1423622178, "answer_id": 28445646, "question_id": 28443412, "link": "https://stackoverflow.com/questions/28443412/using-google-api-go-client-in-golang-to-update-invideo-programming/28445646#28445646", "title": "Using google-api-go-client in golang to update InVideo Programming", "body": "<p>Second argument of Update function should be a channel you want to update</p>\n\n<pre><code>service, err := youtube.New(client)\nif err != nil {\n    log.Fatalf(\"Error creating YouTube client: %v\", err)\n}\n\nchannel := &amp;youtube.Channel{\n    //you channel details here\n}\n\ncall := service.Channels.Update(\"invideoPromotion\", channel)\n\nchannel, err = call.Do()\n\nif err != nil {\n    log.Fatalf(\"Error updating YouTube channel: %v\", err)\n}\n</code></pre>\n"}], "owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 481, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575361546, "creation_date": 1423608635, "last_edit_date": 1575361546, "question_id": 28443412, "link": "https://stackoverflow.com/questions/28443412/using-google-api-go-client-in-golang-to-update-invideo-programming", "title": "Using google-api-go-client in golang to update InVideo Programming", "body": "<p>I come from Tcl and I'm trying to move over to golang. I'm having a hard time grasping the entire structure of the youtube-api.json file, but my primary focus is making a call to Channels.Update(\"invideoPromotion\") to add a annotation in the video. </p>\n\n<pre><code>youtube, err := youtube.New(httpClient)\nif err != nil {\n    log.Fatalf(\"Error creating YouTube client: %v\", err)\n}\ncall := youtube.Channels.Update(\"invideoPromotion\")\n</code></pre>\n\n<p>Error: not enough arguments in call to youtube.Channels.Update</p>\n\n<p>To retrieve InvideoPromotion I can call the channels service but channels service doesn't have update or Insert methods so I can't update InvideoPromotion using the google-api-go-client correct?</p>\n\n<p>Eg: \nservice.Channels.List(\"invideoPromotion\").Id(\"Channel-Name\")\nbut not\nservice.Channels.Insert(\"invideoPromotion\").Id(\"Channel-Name\")</p>\n"}, {"tags": ["c", "go", "mingw", "hdf5"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1423607721, "post_id": 28442524, "comment_id": 45215996, "body": "Can you show me how the constant H5T_NATIVE_UINT64 is defined?"}, {"owner": {"reputation": 81, "user_id": 4039753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7852dbc759ef71d3ceedc48a7d287212?s=128&d=identicon&r=PG&f=1", "display_name": "kch", "link": "https://stackoverflow.com/users/4039753/kch"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1423608527, "post_id": 28442524, "comment_id": 45216354, "body": "Looking through the headers, I get this  <code>c:\\HDF_Group\\HDF5\\1.8.14_x86\\include&gt;grep H5T_NATIVE_UINT64 * H5Tpkg.h:H5_DLLVAR size_t       H5T_NATIVE_UINT64_ALIGN_g;  H5Tpublic.h:#define H5T_NATIVE_UINT64           (H5OPEN H5T_NATIVE_UINT64_g)  H5Tpublic.h:H5_DLLVAR hid_t H5T_NATIVE_UINT64_g;</code>"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1423609013, "post_id": 28442524, "comment_id": 45216561, "body": "Your comment is hard to read. Would you mind adding this information to your question? There is an \u201cedit\u201d button below it. Please add as much information as possible, including all type and relevant macro definitions."}, {"owner": {"reputation": 81, "user_id": 4039753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7852dbc759ef71d3ceedc48a7d287212?s=128&d=identicon&r=PG&f=1", "display_name": "kch", "link": "https://stackoverflow.com/users/4039753/kch"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1423609108, "post_id": 28442524, "comment_id": 45216594, "body": "Sure, sorry about that"}, {"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 1, "creation_date": 1423618716, "post_id": 28442524, "comment_id": 45219726, "body": "FYI tested this on Linux and the problem does not occur. Prints <code>50331683</code>. Also make sure to use <code>%u</code> instead of <code>%d</code> when dealing with unsigned integers. It would be nice to have a look into the generated code. Use <code>go build -work</code> to get the location."}, {"owner": {"reputation": 26843, "user_id": 208997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/250e219125d8bff1f03e6faea950f218?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/208997/simon"}, "edited": false, "score": 0, "creation_date": 1423699637, "post_id": 28442524, "comment_id": 45259558, "body": "Works on my Mac too. Since C is working but not cgo, could it be that one is using the shared library and the other the static one and one of them is somehow broken? Can you try to replace your LDFLAGS with the full paths to the static libraries for instance?"}, {"owner": {"reputation": 81, "user_id": 4039753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7852dbc759ef71d3ceedc48a7d287212?s=128&d=identicon&r=PG&f=1", "display_name": "kch", "link": "https://stackoverflow.com/users/4039753/kch"}, "edited": false, "score": 0, "creation_date": 1424527396, "post_id": 28442524, "comment_id": 45590931, "body": "Would be interested to hear if it works on another Win7 machine."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 4039753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7852dbc759ef71d3ceedc48a7d287212?s=128&d=identicon&r=PG&f=1", "display_name": "kch", "link": "https://stackoverflow.com/users/4039753/kch"}, "edited": false, "score": 0, "creation_date": 1429266257, "post_id": 29663370, "comment_id": 47529153, "body": "So why does it appear to work on Linux? Or doesn&#39;t it? Does this mean using hdf5 from golang is doomed?"}, {"owner": {"reputation": 1036, "user_id": 1737204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2851ca9622b504c85b92fc3e93d87b1f?s=128&d=identicon&r=PG", "display_name": "wldsvc", "link": "https://stackoverflow.com/users/1737204/wldsvc"}, "reply_to_user": {"reputation": 81, "user_id": 4039753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7852dbc759ef71d3ceedc48a7d287212?s=128&d=identicon&r=PG&f=1", "display_name": "kch", "link": "https://stackoverflow.com/users/4039753/kch"}, "edited": false, "score": 0, "creation_date": 1429307694, "post_id": 29663370, "comment_id": 47555649, "body": "cgo cannot evaluate non constant #defines on <i>any</i> platform. Using hdf5 from Go is not doomed, you just need to find/write a Go wrapper that does provide a proper Go style API with no funny #defines. You can also give <a href=\"http://www.swig.org/\" rel=\"nofollow noreferrer\">Swig</a> a try. BTW, the define you mention generates a func call followed by a variable... I guess the variable value is used as the value of the pseudo-expression that the #define is supposed to represent. What kind of API is that? Have you looked at the amount of warnings generated when you compiled the hdf5 libs? I wouldn&#39;t touch it with a poking stick."}, {"owner": {"reputation": 81, "user_id": 4039753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7852dbc759ef71d3ceedc48a7d287212?s=128&d=identicon&r=PG&f=1", "display_name": "kch", "link": "https://stackoverflow.com/users/4039753/kch"}, "edited": false, "score": 0, "creation_date": 1429357901, "post_id": 29663370, "comment_id": 47568384, "body": "OK thanks for the input! Well that package is the only one out there for go/hdf5. I guess I will stick with good old csv files until I can figure out a better way."}], "tags": [], "owner": {"reputation": 1036, "user_id": 1737204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2851ca9622b504c85b92fc3e93d87b1f?s=128&d=identicon&r=PG", "display_name": "wldsvc", "link": "https://stackoverflow.com/users/1737204/wldsvc"}, "is_accepted": true, "score": 0, "last_activity_date": 1429144660, "creation_date": 1429144660, "answer_id": 29663370, "question_id": 28442524, "link": "https://stackoverflow.com/questions/28442524/why-cant-i-read-a-c-constant-from-golang-properly/29663370#29663370", "title": "Why can&#39;t I read a C constant from Golang properly?", "body": "<p>H5T_NATIVE_UINT64 is NOT a constant but a #define that ultimately evaluates to <code>(H5Open(), H5T_NATIVE_UINT64_g)</code>, which cgo does not understand.</p>\n\n<p>It's easy to check by turning on debug output on gcc's preprocessor:</p>\n\n<pre><code>gcc -E -dM your_test_c_file.c | grep H5T_NATIVE_UINT64\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>#define H5T_NATIVE_UINT64 (H5OPEN H5T_NATIVE_UINT64_g)\n</code></pre>\n\n<p>Now the same for H5OPEN:</p>\n\n<pre><code>gcc -E -dM test_go.c | grep '#define H5OPEN'\n</code></pre>\n\n<p>gives:</p>\n\n<pre><code>#define H5OPEN H5open(),\n</code></pre>\n\n<p>Right now, cgo does understand simple integer constant defines like <code>#define VALUE  1234</code>, or anything that the gcc preprocessor will turn into an integer constant. See the function <code>func (p *Package) guessKinds(f *File)</code> in <code>$GOROOT/src/cmd/cgo/gcc.go</code>. </p>\n"}], "owner": {"reputation": 81, "user_id": 4039753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7852dbc759ef71d3ceedc48a7d287212?s=128&d=identicon&r=PG&f=1", "display_name": "kch", "link": "https://stackoverflow.com/users/4039753/kch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "accepted_answer_id": 29663370, "answer_count": 1, "score": 5, "last_activity_date": 1429144660, "creation_date": 1423605005, "last_edit_date": 1423609430, "question_id": 28442524, "link": "https://stackoverflow.com/questions/28442524/why-cant-i-read-a-c-constant-from-golang-properly", "title": "Why can&#39;t I read a C constant from Golang properly?", "body": "<p>I am using go-hdf5 to read an hdf5 file into golang. I am on windows7 using a pretty recent copy of mingw and hdf5 1.8.14_x86 and it seems like trying to use any of the predefined types doesn't work, let's focus for example on T_NATIVE_UINT64. I have reduced the issue to the following, which basically leaves go-hdf5 out of the problem and points at something quite fundamental going wrong:</p>\n\n<pre><code>package main\n\n/*\n #cgo CFLAGS: -IC:/HDF_Group/HDF5/1.8.14_x86/include\n #cgo LDFLAGS: -LC:/HDF_Group/HDF5/1.8.14_x86/bin -lhdf5 -lhdf5_hl\n #include \"hdf5.h\"\n\n #include &lt;stdio.h&gt;\n\n void print_the_value2() { printf(\"the value of the constant is %d\\n\", H5T_NATIVE_UINT64); }\n*/\nimport \"C\"\n\nfunc main() {\n    C.print_the_value2()\n}\n</code></pre>\n\n<p>You obviously need to have hdf5 and point the compiler at the headers/dlls and running go get, then executing prints this on my pc</p>\n\n<pre><code>the value of the constant is -1962924545\n</code></pre>\n\n<p>Running variations of the above, in how/where the constant is read, will give different answers for the value of H5T_NATIVE_UINT64. However I am pretty sure that is none are the right value and in fact trying to use a type with the id returned doesn't work, unsurprisingly. </p>\n\n<p>If I write and run a \"real\" C program, I get different results</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"hdf5.h\"\n\nhid_t _go_hdf5_H5T_NATIVE_UINT64() { return H5T_NATIVE_UINT64; }\n\nint main()\n{\n    printf(\"the value of the constant is %d\", _go_hdf5_H5T_NATIVE_UINT64());\n}\n</code></pre>\n\n<p>Compiling using</p>\n\n<pre><code>C:\\Temp&gt;gcc -IC:/HDF_Group/HDF5/1.8.14_x86/include -LC:/HDF_Group/HDF5/1.8.14_x86/bin -lhdf5 -lhdf5_hl -o stuff.exe stuff.c\n</code></pre>\n\n<p>and running gives me</p>\n\n<pre><code>the value of the constant is 50331683\n</code></pre>\n\n<p>And that appears to be the right value as I can use it directly from my go program. Obviously I want to be able to use the constants instead. Any idea why this could be happening? </p>\n\n<p>Extra info following comments below:</p>\n\n<p>I looked for the definition of H5T_NATIVE_UINT64 in the hdf5 headers and see the following</p>\n\n<pre><code>c:\\HDF_Group\\HDF5\\1.8.14_x86\\include&gt;grep H5T_NATIVE_UINT64 *\nH5Tpkg.h:H5_DLLVAR size_t H5T_NATIVE_UINT64_ALIGN_g; \nH5Tpublic.h:#define H5T_NATIVE_UINT64 (H5OPEN H5T_NATIVE_UINT64_g)\nH5Tpublic.h:H5_DLLVAR hid_t H5T_NATIVE_UINT64_g;\n</code></pre>\n\n<p>The whole header is here</p>\n\n<p><a href=\"http://www.hdfgroup.org/ftp/HDF5/prev-releases/hdf5-1.8.14/src/unpacked/src/H5Tpublic.h\" rel=\"noreferrer\">http://www.hdfgroup.org/ftp/HDF5/prev-releases/hdf5-1.8.14/src/unpacked/src/H5Tpublic.h</a></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-endpoints"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1423613449, "post_id": 28439555, "comment_id": 45218184, "body": "The client did not supply a BEARER or OAUTH Authorization header."}, {"owner": {"reputation": 1, "user_id": 4551810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda81d8ce35c489983924906f1a47dce?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Saini", "link": "https://stackoverflow.com/users/4551810/gaurav-saini"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1423635705, "post_id": 28439555, "comment_id": 45224171, "body": "What would be the fix for that?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1423666164, "post_id": 28439555, "comment_id": 45240925, "body": "The fix is to modify the client to send an appropriate Authorization heeader."}, {"owner": {"reputation": 1, "user_id": 4551810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda81d8ce35c489983924906f1a47dce?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Saini", "link": "https://stackoverflow.com/users/4551810/gaurav-saini"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1423666282, "post_id": 28439555, "comment_id": 45241008, "body": "I did this using api Explorer,  shouldn&#39;t that take care of passing appropriate authorization header?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1423666419, "post_id": 28439555, "comment_id": 45241120, "body": "Log the headers to find out if the header is supplied."}], "owner": {"reputation": 1, "user_id": 4551810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda81d8ce35c489983924906f1a47dce?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Saini", "link": "https://stackoverflow.com/users/4551810/gaurav-saini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1423594460, "creation_date": 1423594460, "question_id": 28439555, "link": "https://stackoverflow.com/questions/28439555/getting-no-token-in-the-current-context-while-fetching-user-in-go-endpoints-in", "title": "Getting &quot;No token in the current context&quot; while fetching user in Go endpoints in app-engine", "body": "<p>In using Go-endpoints in google app-engine, when i try to fetch the user from current context i get \"No token in the current context\" error.</p>\n\n<pre><code>var (\n    scopes    = []string{endpoints.EmailScope}\n    clientIds = []string{clientId, endpoints.APIExplorerClientID}\n    audiences = []string{clientId}\n)\n\ntype FlightAppApi struct{\n    }\n\nfunc ( flightApi *FlightAppApi ) RegisterNewUser ( r *http.Request, req *UserReq, resp *User ) error {\n    c := endpoints.NewContext( r )\n    u, err := getCurrentUser( c )\n    if err == nil {\n        newUserKey := datastore.NewKey( c, \"User\", u.ID, 0, nil )\n        newUser := &amp;User{ UserName: req.UserName, EmailId: u.Email }\n        _, err := datastore.Put( c, newUserKey, newUser )\n        return err\n        }\n    return err\n}\n\nfunc getCurrentUser(c endpoints.Context) (*user.User, error) {\n     u, err := endpoints.CurrentUser(c, scopes, audiences, clientIds)\n     if err != nil {\n         return nil, err\n     }\n     if u == nil {\n         return nil, errors.New(\"Unauthorized: Please, sign in.\")\n    }\n    c.Debugf(\"Current user: %#v\", u)\n    return u, nil\n }\n</code></pre>\n\n<p>In the getCurrentUser in endpoints.CurrentUser it gives \"No token in the current context\" error. What could be the problem ?</p>\n"}, {"tags": ["dictionary", "go"], "comments": [{"owner": {"reputation": 23431, "user_id": 719363, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/76ca4397a6ec4aa8fcf85dc53e1cbab6?s=128&d=identicon&r=PG", "display_name": "Alex Gitelman", "link": "https://stackoverflow.com/users/719363/alex-gitelman"}, "edited": false, "score": 0, "creation_date": 1423589286, "post_id": 28437937, "comment_id": 45205811, "body": "I don&#39;t think GO has anything like that out of the box. There may be some library though."}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1423589427, "post_id": 28437937, "comment_id": 45205891, "body": "Please don&#39;t confuse SQL which is a standardized language, with ORM-like method calls. This approach could be however be compared to LINQ. There is a library that implements that sort of thing, but I really don&#39;t recommend such a solution, because it is far from idiomatic."}, {"owner": {"reputation": 703, "user_id": 1765519, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/83bbd86d8107852b4b4ac417e452092b?s=128&d=identicon&r=PG", "display_name": "Avik", "link": "https://stackoverflow.com/users/1765519/avik"}, "reply_to_user": {"reputation": 23431, "user_id": 719363, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/76ca4397a6ec4aa8fcf85dc53e1cbab6?s=128&d=identicon&r=PG", "display_name": "Alex Gitelman", "link": "https://stackoverflow.com/users/719363/alex-gitelman"}, "edited": false, "score": 0, "creation_date": 1423589519, "post_id": 28437937, "comment_id": 45205936, "body": "@AlexGitelman Any ideas what such a library might be called? searching for linq, sql,query etc, has only gotten me database libraries."}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1423589813, "post_id": 28437937, "comment_id": 45206104, "body": "googling for &quot;go linq library&quot; leads to <a href=\"http://ahmetalpbalkan.github.io/go-linq/\" rel=\"nofollow noreferrer\">ahmetalpbalkan.github.io/go-linq</a> which is the library I knew."}, {"owner": {"reputation": 703, "user_id": 1765519, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/83bbd86d8107852b4b4ac417e452092b?s=128&d=identicon&r=PG", "display_name": "Avik", "link": "https://stackoverflow.com/users/1765519/avik"}, "reply_to_user": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1423632395, "post_id": 28437937, "comment_id": 45223203, "body": "@SirDarius what would you suggest instead?"}], "answers": [{"tags": [], "owner": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "is_accepted": false, "score": 0, "last_activity_date": 1423591608, "creation_date": 1423591608, "answer_id": 28438695, "question_id": 28437937, "link": "https://stackoverflow.com/questions/28437937/how-can-i-use-orm-like-queries-on-a-map/28438695#28438695", "title": "How can I use ORM-like queries on a Map?", "body": "<p>This solution IS a database, but you can embed it into your application for use rather than relying on an outside db: <a href=\"https://github.com/HouzuoGuo/tiedot\" rel=\"nofollow\">https://github.com/HouzuoGuo/tiedot</a></p>\n\n<p>Another possibility is an approach like this one, which uses the sql package against local flat files, which could potentially be adapted to run against map?: <a href=\"https://github.com/dinedal/textql\" rel=\"nofollow\">https://github.com/dinedal/textql</a></p>\n"}], "owner": {"reputation": 703, "user_id": 1765519, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/83bbd86d8107852b4b4ac417e452092b?s=128&d=identicon&r=PG", "display_name": "Avik", "link": "https://stackoverflow.com/users/1765519/avik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423632516, "creation_date": 1423589088, "last_edit_date": 1423632516, "question_id": 28437937, "link": "https://stackoverflow.com/questions/28437937/how-can-i-use-orm-like-queries-on-a-map", "title": "How can I use ORM-like queries on a Map?", "body": "<p>I have created a slice of structs that has 3 properties</p>\n\n<pre><code>type Person struct {\n  age int\n  gender string\n  name string\n}\n</code></pre>\n\n<p>How can I pull the item from the slice which matches my criteria?</p>\n\n<p>For example I would like to do </p>\n\n<pre><code>var persons []Person = mySliceOfPersons\nperson := getFrom(persons).Where(age ==10).Where(gender == \"male\")\n</code></pre>\n\n<p>The purpose here is to keep the data in memory, and not be restricted by IO. (I'm expecting thousands of calls per second). I am new to Go and I am not sure where to find a package that does this.  The data comes from Json and not a Database so I don't think I can use the sql package.</p>\n"}, {"tags": ["go", "proxy", "httprequest", "reverse-proxy"], "comments": [{"owner": {"reputation": 714, "user_id": 131778, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/4d30e77161509fd297a6db23352e65b5?s=128&d=identicon&r=PG", "display_name": "adamprocter", "link": "https://stackoverflow.com/users/131778/adamprocter"}, "edited": false, "score": 0, "creation_date": 1423588662, "post_id": 28436506, "comment_id": 45205408, "body": "one suggestion is have index.php which pulls remote page data in and injects it into actual page locate at newurl.com"}, {"owner": {"reputation": 714, "user_id": 131778, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/4d30e77161509fd297a6db23352e65b5?s=128&d=identicon&r=PG", "display_name": "adamprocter", "link": "https://stackoverflow.com/users/131778/adamprocter"}, "edited": false, "score": 0, "creation_date": 1423588711, "post_id": 28436506, "comment_id": 45205446, "body": "aka - CURL PHP <a href=\"https://github.com/joshdick/miniproxy\" rel=\"nofollow noreferrer\">github.com/joshdick/miniproxy</a>"}], "answers": [{"comments": [{"owner": {"reputation": 714, "user_id": 131778, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/4d30e77161509fd297a6db23352e65b5?s=128&d=identicon&r=PG", "display_name": "adamprocter", "link": "https://stackoverflow.com/users/131778/adamprocter"}, "edited": false, "score": 0, "creation_date": 1423603088, "post_id": 28438266, "comment_id": 45213552, "body": "thanks, I think based on my use case this is going to be more complicated than I expected"}], "tags": [], "owner": {"reputation": 23431, "user_id": 719363, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/76ca4397a6ec4aa8fcf85dc53e1cbab6?s=128&d=identicon&r=PG", "display_name": "Alex Gitelman", "link": "https://stackoverflow.com/users/719363/alex-gitelman"}, "is_accepted": false, "score": 2, "last_activity_date": 1423590935, "last_edit_date": 1423590935, "creation_date": 1423590096, "answer_id": 28438266, "question_id": 28436506, "link": "https://stackoverflow.com/questions/28436506/http-redirect-in-golang/28438266#28438266", "title": "HTTP Redirect in Golang", "body": "<p>Look at <code>httputil.ReverseProxy</code></p>\n\n<p>I used it to implement request dumper that essentially does what you described - listen on specific port and forwards to some url.</p>\n\n<p>This is example code. Mileage can vary as I just stripped out parts related to actual work that I am doing in proxy and left pieces that do routing.\nBut it could be a starting point.</p>\n\n<pre><code>func SetProxy(targetUrl string) (newUrl string, err error) {\n    var target *url.URL\n    target, err = url.Parse(targetUrl)\n    if err != nil {\n        return \"\", err\n    }\n    origHost := target.Host\n    origScheme := target.Scheme\n    d := func(req *http.Request) {\n        req.URL.Host = origHost\n        req.URL.Scheme = origScheme\n    }\n\n    p := &amp;httputil.ReverseProxy{Director: d,}\n    http.HandleFunc(\"/\", p)\n\n    target.Host = \"localhost:8000\"\n    target.Scheme = \"http\"\n    newUrl = target.String()\n    go func() {\n        err = http.ListenAndServe(\":\"+localPort, nil)\n        if err != nil {\n            panic(err)\n        }\n    }()\n\n    return newUrl, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 714, "user_id": 131778, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/4d30e77161509fd297a6db23352e65b5?s=128&d=identicon&r=PG", "display_name": "adamprocter", "link": "https://stackoverflow.com/users/131778/adamprocter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3186, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572851783, "creation_date": 1423585106, "last_edit_date": 1572851783, "question_id": 28436506, "link": "https://stackoverflow.com/questions/28436506/http-redirect-in-golang", "title": "HTTP Redirect in Golang", "body": "<p>I have this domain <a href=\"http://mynewurl.com/\" rel=\"nofollow noreferrer\">http://mynewurl.com/</a>, Which frame forwards to - \n<a href=\"http://oldurl.com:8000\" rel=\"nofollow noreferrer\">http://oldurl.com:8000</a> a Go server I\u2019m running for a blog.</p>\n\n<p>I need to have URLs for each post map correctly aka</p>\n\n<ul>\n<li><a href=\"http://mynewurl.com/propoal\" rel=\"nofollow noreferrer\">http://mynewurl.com/propoal</a>  </li>\n<li><a href=\"http://oldurl.com:8000/proposal\" rel=\"nofollow noreferrer\">http://oldurl.com:8000/proposal</a></li>\n</ul>\n\n<p>As at the moment visiting links on the main page masks the URL totally so any sharing (hopefully using webmentions) will not reference that post URL but the main URL\u2026</p>\n\n<p>But I was wondering if I can get Golang to play better and listen at the new URL?</p>\n\n<pre><code>func main() {\n  http.HandleFunc(\"/\", handlerequest)\n  http.ListenAndServe(\":8000\", nil)\n}\n</code></pre>\n"}, {"tags": ["go", "linkedin"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1423580526, "post_id": 28433779, "comment_id": 45199745, "body": "Please show us your Go code calling the URL."}, {"owner": {"reputation": 4679, "user_id": 749854, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/541a5cb4925d352cac921c21e9213aa4?s=128&d=identicon&r=PG", "display_name": "nvcnvn", "link": "https://stackoverflow.com/users/749854/nvcnvn"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1423581277, "post_id": 28433779, "comment_id": 45200343, "body": "OK, here is it <a href=\"http://pastebin.com/tV1yWUWu\" rel=\"nofollow noreferrer\">pastebin.com/tV1yWUWu</a>"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1423591090, "creation_date": 1423591090, "answer_id": 28438546, "question_id": 28433779, "link": "https://stackoverflow.com/questions/28433779/linkedin-api-call-with-url-encoded/28438546#28438546", "title": "LinkedIn API call with url encoded", "body": "<p>Set the URL Opaque field to the path after creating the request:</p>\n\n<pre><code>r, err := http.NewRequest(\"GET\", \"https://api.linkedin.com\", nil)\nif err != nil {\n  // handle error\n}\nr.URL.Opaque = \"/v1/people/~:(id,first-name,last-name)\"\nr.Header.Set(\"Authorization\", \"Bearer \"+respBody.AccessToken)\nresp, err = http.DefaultClient.Do(r)\n</code></pre>\n\n<p>The <a href=\"http://godoc.org/net/url#URL\" rel=\"nofollow\">URL type</a> documentation describes how to do this.</p>\n"}], "owner": {"reputation": 4679, "user_id": 749854, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/541a5cb4925d352cac921c21e9213aa4?s=128&d=identicon&r=PG", "display_name": "nvcnvn", "link": "https://stackoverflow.com/users/749854/nvcnvn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 620, "favorite_count": 0, "accepted_answer_id": 28438546, "answer_count": 1, "score": 3, "last_activity_date": 1423591090, "creation_date": 1423577520, "last_edit_date": 1423581464, "question_id": 28433779, "link": "https://stackoverflow.com/questions/28433779/linkedin-api-call-with-url-encoded", "title": "LinkedIn API call with url encoded", "body": "<p>For example, if I make a call to:</p>\n\n<pre><code>https://api.linkedin.com/v1/people/~:(id,first-name,last-name)\n</code></pre>\n\n<p>It should work fine, but if the URL encoded (and it should be) like this:</p>\n\n<pre><code>https://api.linkedin.com/v1/people/~:%28id,first-name,last-name%29\n</code></pre>\n\n<p>I get this error message:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;error&gt;\n    &lt;status&gt;404&lt;/status&gt;\n    &lt;timestamp&gt;1423577265744&lt;/timestamp&gt;\n    &lt;request-id&gt;6B2UQSA25W&lt;/request-id&gt;\n    &lt;error-code&gt;0&lt;/error-code&gt;\n    &lt;message&gt;[invalid.property.name]. Couldn&amp;#39;t find property with name {:%28id,first-name,last-name%29} in resource of type {Person}&lt;/message&gt;\n&lt;/error&gt;\n</code></pre>\n\n<p>How can you deal with that?<br>\nCurrently I cannot change the code because my language (Golang btw) do very properly encode this with standar package. Here is my code:  </p>\n\n<pre><code>r, _ := http.NewRequest(\"GET\", \"https://api.linkedin.com/v1/people/~:(id,first-name,last-name)\", nil)\nr.Header.Set(\"Authorization\", \"Bearer \"+respBody.AccessToken)\nresp, err = http.DefaultClient.Do(r)\n</code></pre>\n\n<p>Do you have solution for this issue except rewrite std lib code?</p>\n\n<p>Some what face with the same issue since 2013 here <a href=\"https://developer.linkedin.com/forum/edit-i-dont-way-uris-look\" rel=\"nofollow\">https://developer.linkedin.com/forum/edit-i-dont-way-uris-look</a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 3, "last_activity_date": 1423576732, "creation_date": 1423576732, "answer_id": 28433504, "question_id": 28432946, "link": "https://stackoverflow.com/questions/28432946/how-do-i-get-the-method-argument-names/28433504#28433504", "title": "How do i get the method argument names", "body": "<p>The names of local variables (including function arguments) are just for the programmer; the compiler discards them when it generates code. There is no way to retrieve argument names as they are not available in the compiled code.</p>\n"}], "owner": {"reputation": 2325, "user_id": 1492051, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/07ecac667abb2bfa8d6698dc629bbb54?s=128&d=identicon&r=PG", "display_name": "FPGA", "link": "https://stackoverflow.com/users/1492051/fpga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 28433504, "answer_count": 1, "score": 0, "last_activity_date": 1423576732, "creation_date": 1423575028, "question_id": 28432946, "link": "https://stackoverflow.com/questions/28432946/how-do-i-get-the-method-argument-names", "title": "How do i get the method argument names", "body": "<p>I have this nice function that prints some info about a given method in a given type, here is a <a href=\"https://play.golang.org/p/338BE3T7IW\" rel=\"nofollow\">goplay</a></p>\n\n<p>it does all i need except i can't find a way to get the method argument names,any idea to achieve that?</p>\n\n<pre><code>    func AnalyzeMethod(instance interface {},methodName string){\n        m,ok := reflect.ValueOf(instance).Type().MethodByName(methodName)\n    if ok{\n       isVariadic := m.Type.IsVariadic()\n       var VariadicIndex int\n       var VariadicType reflect.Type\n       var FirstPositionalIndex int\n       var LastPositionalIndex int\n       var ArgsLength int = m.Type.NumIn()-1\n       //var []string ArgumentNames //can't find a way to get an ordered slice of names of every argument that the function takes\n\n       if ArgsLength&gt;0{\n         FirstPositionalIndex = 1\n       }\n\n\n       if isVariadic{\n         VariadicIndex = ArgsLength\n         VariadicType = m.Type.In(VariadicIndex)\n         LastPositionalIndex = ArgsLength-1\n       } else {\n         VariadicIndex = -1\n         LastPositionalIndex = ArgsLength\n       }\n\n       fmt.Println(\"ArgsLength:\",ArgsLength)    \n       fmt.Println(\"FirstPositionalIndex:\",FirstPositionalIndex)\n       fmt.Println(\"LastPositionalIndex:\",LastPositionalIndex)  \n       fmt.Println(\"Variadic:\",isVariadic)\n       fmt.Println(\"VariadicIndex:\",VariadicIndex)\n       fmt.Println(\"VariadicType:\",VariadicType)\n       fmt.Println(\"ArgumentNames\",\"How?\")\n\n        }\n}\n</code></pre>\n"}, {"tags": ["arrays", "go", "garbage-collection", "slice"], "answers": [{"comments": [{"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 9, "creation_date": 1423578136, "post_id": 28432812, "comment_id": 45197954, "body": "To complete icza answer, and for your particular queue case: the unreachable part of the slice won&#39;t be garbage-collected, however, when you <code>PushBack</code> a new item and  <code>q</code> is already full, a new copy of <code>q</code> will be allocated, and in this case, <b>only reachable elements</b> will be copied, so A, B and C won&#39;t. <code>q</code> will not grow forever with unreachable elements."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1423641888, "post_id": 28432812, "comment_id": 45226680, "body": "@siritinga That&#39;s true, good suggestion. Thanks. Incorporated it into the answer with additional important info (like zeroing the &quot;slot&quot; if an element is removed)."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1534933109, "post_id": 28432812, "comment_id": 90879194, "body": "@icza Can you please provide an explained answer to this question <a href=\"https://stackoverflow.com/questions/51959783/garbage-collection-and-correct-usage-of-pointers-in-go\" title=\"garbage collection and correct usage of pointers in go\">stackoverflow.com/questions/51959783/&hellip;</a>, if you have some time."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1535022976, "post_id": 28432812, "comment_id": 90918347, "body": "I would also add a link to the <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">&quot;slice tircks&quot;</a> wiki page, especially <a href=\"https://github.com/golang/go/wiki/SliceTricks#delete-without-preserving-order\" rel=\"nofollow noreferrer\">this bit</a> dealing with the elements &quot;framed out&quot; due to reslicing."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1535023892, "post_id": 28432812, "comment_id": 90918926, "body": "@kostix Thanks, included in the answer."}, {"owner": {"reputation": 573, "user_id": 2699636, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/704d95a827d0af56e0e8c8c5d9d0706d?s=128&d=identicon&r=PG&f=1", "display_name": "himanshu219", "link": "https://stackoverflow.com/users/2699636/himanshu219"}, "edited": false, "score": 0, "creation_date": 1603699873, "post_id": 28432812, "comment_id": 114108169, "body": "@icza so if one is storing int then it is not required to set it to 0 right? It&#39;s only needed for string or pointers right?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 573, "user_id": 2699636, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/704d95a827d0af56e0e8c8c5d9d0706d?s=128&d=identicon&r=PG&f=1", "display_name": "himanshu219", "link": "https://stackoverflow.com/users/2699636/himanshu219"}, "edited": false, "score": 0, "creation_date": 1603701458, "post_id": 28432812, "comment_id": 114108728, "body": "@himanshu219 Right, only needed to clear the value if it references memory stored outside of the backing array of the slice, such as pointers or strings."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 27, "last_activity_date": 1535030551, "last_edit_date": 1592644375, "creation_date": 1423574608, "answer_id": 28432812, "question_id": 28432658, "link": "https://stackoverflow.com/questions/28432658/does-go-garbage-collect-parts-of-slices/28432812#28432812", "title": "Does go garbage collect parts of slices?", "body": "<p>Slices are just descriptors (small struct-like data structures) which if not referenced will be garbage collected properly.</p>\n<p>The underlying array for a slice (to which the descriptor points to) on the other hand is <em>shared</em> between all slices that are created by reslicing it: quoting from the <a href=\"http://golang.org/ref/spec#Slice_types\" rel=\"noreferrer\">Go Language Specification: Slice Types</a>:</p>\n<blockquote>\n<p>A slice, once initialized, is always associated with an underlying array that holds its elements. A slice therefore shares storage with its array and with other slices of the same array; by contrast, distinct arrays always represent distinct storage.</p>\n</blockquote>\n<p>Therefore if at least one slice exists, or a variable holding the array (if a slice was created by slicing the array), it will not be garbage collected.</p>\n<p><strong>Official Statement about this:</strong></p>\n<p>The blog post <a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"noreferrer\"><strong>Go Slices: usage and internals</strong></a> By Andrew Gerrand clearly states this behaviour:</p>\n<blockquote>\n<p>As mentioned earlier, re-slicing a slice doesn't make a copy of the underlying array. <strong>The full array will be kept in memory until it is no longer referenced.</strong> Occasionally this can cause the program to hold all the data in memory when only a small piece of it is needed.</p>\n<p>...</p>\n<p>Since the slice references the original array, <strong>as long as the slice is kept around the garbage collector can't release the array</strong>.</p>\n</blockquote>\n<p><strong>Back to your example</strong></p>\n<p>While the underlying array will not be freed, note that if you add new elements to the queue, the built-in <code>append</code> function occasionally might allocate a new array and copy the current elements to the new \u2013 but copying will only copy the elements of the slice and not the whole underlying array! When such a reallocation and copying occurs, the &quot;old&quot; array may be garbage collected if no other reference exists to it.</p>\n<p>Also another very important thing is that if an element is popped from the front, the slice will be resliced and not contain a reference to the popped element, but since the underlying array still contains that value, the value will also remain in memory (not just the array). It is recommended that whenever an element is popped or removed from your queue (slice/array), <strong>always zero it</strong> (its respective element in the slice) so the value will not remain in memory needlessly. This becomes even more critical if your slice contains pointers to big data structures.</p>\n<pre><code>func PopFront(q *[]string) string {\n    r := (*q)[0]\n    (*q)[0] = &quot;&quot;  // Always zero the removed element!\n    *q = (*q)[1:len(*q)]\n    return r\n}\n</code></pre>\n<p>This is mentioned <a href=\"https://github.com/golang/go/wiki/SliceTricks#delete-without-preserving-order\" rel=\"noreferrer\">Slice Tricks wiki page:</a></p>\n<blockquote>\n<h3>Delete without preserving order</h3>\n<pre><code>a[i] = a[len(a)-1] \na = a[:len(a)-1]\n</code></pre>\n<p><strong>NOTE</strong> If the type of the element is a <em>pointer</em> or a struct with pointer fields, which need to be garbage collected, the above implementations of <code>Cut</code> and <code>Delete</code> have a potential <em>memory leak</em> problem: some elements with values are still referenced by slice <code>a</code> and thus can not be collected.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2292, "user_id": 767903, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7ae9acb5bf16896b78a9708403da20ca?s=128&d=identicon&r=PG", "display_name": "Andrew W. Phillips", "link": "https://stackoverflow.com/users/767903/andrew-w-phillips"}, "is_accepted": false, "score": 1, "last_activity_date": 1513294636, "creation_date": 1513294636, "answer_id": 47823753, "question_id": 28432658, "link": "https://stackoverflow.com/questions/28432658/does-go-garbage-collect-parts-of-slices/47823753#47823753", "title": "Does go garbage collect parts of slices?", "body": "<p>Simple question, simple answer: No. (But if you keep pushing the slice will at some point overflow its underlying array then the unused elements become available to be freed.)</p>\n"}, {"comments": [{"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 1, "creation_date": 1532418294, "post_id": 51472324, "comment_id": 89954899, "body": "<code>append()</code> will sometimes allocate an entirely new array though, so I don&#39;t think this shows what you think it does."}], "tags": [], "owner": {"reputation": 34, "user_id": 2532523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5560d76d48a58067aa02a747cfe9f87c?s=128&d=identicon&r=PG", "display_name": "Daniel Sont", "link": "https://stackoverflow.com/users/2532523/daniel-sont"}, "is_accepted": false, "score": -1, "last_activity_date": 1532333688, "last_edit_date": 1532333688, "creation_date": 1532325334, "answer_id": 51472324, "question_id": 28432658, "link": "https://stackoverflow.com/questions/28432658/does-go-garbage-collect-parts-of-slices/51472324#51472324", "title": "Does go garbage collect parts of slices?", "body": "<p>Contrary to what I'm reading, Golang certainly seems to garbage collect at least unused slices starting sections. The following test case provides evidence.</p>\n\n<p>In the first case the slice is set to slice[:1] in each iteration. In the comparison case, it skips that step. </p>\n\n<p>The second case dwarfs the memory consumed in the first case. But why?</p>\n\n<pre><code>func TestArrayShiftMem(t *testing.T) {\n    slice := [][1024]byte{}\n\n    mem := runtime.MemStats{}\n    mem2 := runtime.MemStats{}\n    runtime.GC()\n    runtime.ReadMemStats(&amp;mem)\n\n    for i := 0; i &lt; 1024*1024*1024*1024; i++ {\n        slice = append(slice, [1024]byte{})\n        slice = slice[1:]\n        runtime.GC()\n\n        if i%(1024) == 0 {\n            runtime.ReadMemStats(&amp;mem2)\n            fmt.Println(mem2.HeapInuse - mem.HeapInuse)\n            fmt.Println(mem2.StackInuse - mem.StackInuse)\n            fmt.Println(mem2.HeapAlloc - mem.HeapAlloc)\n\n        }\n    }\n}\n\n\nfunc TestArrayShiftMem3(t *testing.T) {\n    slice := [][1024]byte{}\n\n    mem := runtime.MemStats{}\n    mem2 := runtime.MemStats{}\n    runtime.GC()\n    runtime.ReadMemStats(&amp;mem)\n\n    for i := 0; i &lt; 1024*1024*1024*1024; i++ {\n        slice = append(slice, [1024]byte{})\n        // slice = slice[1:]\n        runtime.GC()\n\n        if i%(1024) == 0 {\n            runtime.ReadMemStats(&amp;mem2)\n            fmt.Println(mem2.HeapInuse - mem.HeapInuse)\n            fmt.Println(mem2.StackInuse - mem.StackInuse)\n            fmt.Println(mem2.HeapAlloc - mem.HeapAlloc)\n\n        }\n    }\n}\n</code></pre>\n\n<p>Output Test1:</p>\n\n<pre><code>go test -run=.Mem -v .\n...\n0\n393216\n21472\n^CFAIL  github.com/ds0nt/cs-mind-grind/arrays   1.931s\n</code></pre>\n\n<p>Output Test3:</p>\n\n<pre><code>go test -run=.Mem3 -v .\n...\n19193856\n393216\n19213888\n^CFAIL  github.com/ds0nt/cs-mind-grind/arrays   2.175s\n</code></pre>\n\n<p>If you disable garbage collection on the first test, indeed memory skyrockets. The resulting code looks like this:</p>\n\n<pre><code>func TestArrayShiftMem2(t *testing.T) {\n    debug.SetGCPercent(-1)\n\n    slice := [][1024]byte{}\n\n    mem := runtime.MemStats{}\n    mem2 := runtime.MemStats{}\n    runtime.GC()\n    runtime.ReadMemStats(&amp;mem)\n    // 1kb per\n\n    for i := 0; i &lt; 1024*1024*1024*1024; i++ {\n        slice = append(slice, [1024]byte{})\n        slice = slice[1:]\n        // runtime.GC()\n\n        if i%(1024) == 0 {\n            fmt.Println(\"len, cap:\", len(slice), cap(slice))\n            runtime.ReadMemStats(&amp;mem2)\n            fmt.Println(mem2.HeapInuse - mem.HeapInuse)\n            fmt.Println(mem2.StackInuse - mem.StackInuse)\n            fmt.Println(mem2.HeapAlloc - mem.HeapAlloc)\n\n        }\n    }\n} \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14824, "user_id": 360539, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7285afee2564b71451f104352eb4d79b?s=128&d=identicon&r=PG", "display_name": "BMiner", "link": "https://stackoverflow.com/users/360539/bminer"}, "is_accepted": false, "score": 3, "last_activity_date": 1566512957, "last_edit_date": 1566512957, "creation_date": 1566512613, "answer_id": 57617695, "question_id": 28432658, "link": "https://stackoverflow.com/questions/28432658/does-go-garbage-collect-parts-of-slices/57617695#57617695", "title": "Does go garbage collect parts of slices?", "body": "<p><strong>No</strong>.  At the time of this writing, the Go garbage collector (GC) is not smart enough to collect the beginning of an underlying array in a slice, <strong>even if it is inaccessible</strong>.</p>\n\n<p>As mentioned by others here, a slice (under the hood) is a struct of exactly three things: a pointer to its underlying array, the length of the slice (values accessible without reslicing), and the capacity of the slice (values accessible by reslicing).  On the Go blog, <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">slice internals are discussed at length</a>.  Here is another article I like <a href=\"https://syslog.ravelin.com/go-and-memory-layout-6ef30c730d51\" rel=\"nofollow noreferrer\">about Go memory layouts</a>.</p>\n\n<p>When you reslice and cut off the <strong>tail end</strong> of a slice, it is obvious (upon understanding the internals) that the underlying array, the pointer to the underlying array, and the slice's capacity are all left unchanged; only the slice length field is updated.  When you re-slice and cut off the <strong>beginning</strong> of a slice, you are really changing the pointer to the underlying array along with the length and capacity.  In this case, it is generally unclear (based on my readings) why the GC does not clean up this inaccessible part of the underlying array because you cannot re-slice the array to access it again.  My assumption is that the underlying array is treated as one block of memory from the GC's point of view.  If you can point to <em>any part</em> of the underlying array, the entire thing is ineligible for deallocation.</p>\n\n<p>I know what you're thinking... like the true computer scientist you are, you may want some proof.  I'll indulge you:</p>\n\n<p><a href=\"https://goplay.space/#tDBQs1DfE2B\" rel=\"nofollow noreferrer\">https://goplay.space/#tDBQs1DfE2B</a></p>\n\n<p>As mentioned by others and as shown in the sample code, using <code>append</code> can cause a reallocation and copy of the underlying array, which allows the old underlying array to be garbage collected.</p>\n"}], "owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5431, "favorite_count": 7, "accepted_answer_id": 28432812, "answer_count": 4, "score": 22, "last_activity_date": 1566512957, "creation_date": 1423574216, "last_edit_date": 1551969090, "question_id": 28432658, "link": "https://stackoverflow.com/questions/28432658/does-go-garbage-collect-parts-of-slices", "title": "Does go garbage collect parts of slices?", "body": "<p>If I implement a queue like this...</p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n)\n\nfunc PopFront(q *[]string) string {\n    r := (*q)[0]\n    *q = (*q)[1:len(*q)]\n    return r\n}\n\nfunc PushBack(q *[]string, a string) {\n    *q = append(*q, a)\n}\n\nfunc main() {\n    q := make([]string, 0)\n\n    PushBack(&amp;q, \"A\")\n    fmt.Println(q)\n    PushBack(&amp;q, \"B\")\n    fmt.Println(q)\n    PushBack(&amp;q, \"C\")\n    fmt.Println(q)\n\n    PopFront(&amp;q)\n    fmt.Println(q)\n    PopFront(&amp;q)\n    fmt.Println(q)      \n}\n</code></pre>\n\n<p>... I end up with an array <code>[\"A\", \"B\", \"C\"]</code> that has no slices pointing to the first two elements. Since the \"start\" pointer of a slice can never be decremented (AFAIK), those elements can never be accessed.</p>\n\n<p>Is Go's garbage collector smart enough to free them?</p>\n"}, {"tags": ["math", "go", "operators", "bitwise-operators"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1423588924, "post_id": 28432398, "comment_id": 45205583, "body": "Grab a book like Petzold&#39;s &quot;Code&quot; to get a basic understanding of binary representation and the foundations of computing."}], "answers": [{"comments": [{"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 0, "creation_date": 1423640973, "post_id": 28433370, "comment_id": 45226262, "body": "Thank you! Really good answer. Could you suggest the book, that explain some basics of &quot;low level&quot; programming for newbie like me? (without deepening into too technical and mathematical terms)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 1, "creation_date": 1423644910, "post_id": 28433370, "comment_id": 45228092, "body": "@TimurFayzrakhmanov Just google it (the term <i>&quot;bitwise operators tutorial&quot;</i>), there are many good tutorials on the internet. Most are language specific but more or less they apply to all programming languages. Here is a good one found in 1 minute googling: <a href=\"http://code.tutsplus.com/articles/understanding-bitwise-operators--active-11301\" rel=\"nofollow noreferrer\">Understanding Bitwise Operators</a>. Also read the wikipedia article: <a href=\"http://en.wikipedia.org/wiki/Bitwise_operation\" rel=\"nofollow noreferrer\">Bitwise operation</a>"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1468356585, "post_id": 28433370, "comment_id": 64091630, "body": "Umm... your isOdd() function actually returns true if the number is even. isOdd should check for == 1"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1468357315, "post_id": 28433370, "comment_id": 64092008, "body": "@RayfenWindspear You&#39;re right. I mixed up the words <i>odd</i> and <i>even</i>. Corrected it."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 38, "last_activity_date": 1468357259, "last_edit_date": 1468357259, "creation_date": 1423576398, "answer_id": 28433370, "question_id": 28432398, "link": "https://stackoverflow.com/questions/28432398/difference-between-some-operators-golang/28433370#28433370", "title": "Difference between some operators &quot;|&quot;, &quot;^&quot;, &quot;&amp;&quot;, &quot;&amp;^&quot;. Golang", "body": "<p>Bitwise operators come into play when you have to work with <em>byte- or bit-level data</em>.</p>\n\n<p>Here I list a handful of examples using bit operations with code samples (in no particular order):</p>\n\n<hr>\n\n<p><strong>1.</strong> They are common and part of many algorithms in <em>cryptography</em> and <em>hash functions</em> (e.g. <a href=\"http://en.wikipedia.org/wiki/MD5\">MD5</a>).</p>\n\n<p><strong>2.</strong> They are also often used if you want to \"save\" space and you <em>pack multiple \"bool\" variables</em> into one <code>int</code> for example, you assign a bit to each bool variable. You have to use bitwise operators to be able to individually change/read the bits.</p>\n\n<p>For example packing 8 bits/bools into one <code>int</code>:</p>\n\n<pre><code>flags := 0x00  // All flags are 0\nflags |= 0x02  // Turn the 2nd bit to 1 (leaving rest unchanged)\nflags |= 0xff  // Turn 8 bits (0..7) to 1\nflags &amp;= 0xfe  // Set the lowest bit to 0 (leaving rest unchanged)\n\nistrue := flags&amp;0x04 != 0 // Test if 3rd bit is 1\n</code></pre>\n\n<p><strong>3.</strong> Another area is <em>compressing data</em> where you want to get the most out of a <code>byte</code> and use all its bits to store/retreive some info (a bit is the basic unit of information in computing and digital communications).</p>\n\n<p><strong>4.</strong> Similar to compression but not quite the same: <em>bitstreams</em>. It is also used to save space in a data stream by not sending complete bytes but rather fields having arbitrary bit-length.</p>\n\n<p>I've written and published a highly optimized bit-level Reader and Writer package, open sourced here: <a href=\"https://github.com/icza/bitio\"><strong>github.com/icza/bitio</strong></a>. You will see extensive usage of all kinds of bit operations in its sources.</p>\n\n<p><strong>5.</strong> Another practical usage: <em>testing certain properties of an (integer) number</em>. Knowing the binary representation of integer numbers (<a href=\"http://en.wikipedia.org/wiki/Two&#39;s_complement\">Two's complement</a>) there are certain characteristics of numbers in their binary representation. For example an integer number (in 2's complement) is <em>even</em> (can be divided by 2) if the lowest bit is 0:</p>\n\n<pre><code>func isEven(i int) bool {\n    return i&amp;0x01 == 0\n}\n</code></pre>\n\n<p>By testing the bits of an integer you can also tell if it's a power of 2. For example if a positive number only contains one <code>1</code> bit, then it is a power of 2 (e.g. <code>2 = 0x02 = 00000010b</code>, <code>16 = 0x10 = 00010000</code> but for example <code>17 = 0x11 = 00010001</code> not power of 2).</p>\n\n<p><strong>6.</strong> <em>Many encoding/decoding procedures</em> also use bit operations. The most trivial is the <a href=\"http://en.wikipedia.org/wiki/UTF-8\">UTF-8 encoding</a> which uses a variable-length encoding for representing unicode code points (<code>rune</code> in Go) as byte sequences.<br>\nA simple variation of a variable-length encoding could be to use the highest bit of a byte (8th or 7th if 0-indexed) to signal if more bytes are required to decode a number, and the remaining 7 bits are always the \"useful\" data. You can test the highest bit and \"separate\" the 7 useful bits like this:</p>\n\n<pre><code>b := readOneByte()\nusefulBits := b &amp; 0x7f\nhasMoreBytes := b &amp; 0x80 != 0\n</code></pre>\n\n<p>The profit of using such a variable-length encoding is that even if you use <code>uint64</code> type in Go which is 8 bytes in memory, small numbers can still be represented using less bytes (numbers in the range <code>0..127</code> only require 1 byte!). If the samples you want to store or transfer have many small values, this alone can compress the data to 1/8th = 12.5 %. The down side is that big numbers (which have bits even in the highest byte) will use more than 8 bytes. Whether it's worth it depends on the heuristic of the samples.</p>\n\n<p><strong>X.</strong> <em>And the list goes on...</em></p>\n\n<hr>\n\n<p>Can you live without knowing/using bitwise operators in Go (and in many other programming languages)? The answer is Yes. But if you know them, sometimes they can make your life easier and your programs more efficient.</p>\n\n<p>If you want to learn more on the topic, read the Wikipedia article: <a href=\"http://en.wikipedia.org/wiki/Bitwise_operation\">Bitwise operation</a> and google the term \"Bitwise Operators Tutorial\", there are many good articles.</p>\n"}, {"comments": [{"owner": {"reputation": 478, "user_id": 9668346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/126d93ec5bb3442bf2f73700bcf88a77?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/9668346/vaibhav"}, "edited": false, "score": 0, "creation_date": 1616318423, "post_id": 28433636, "comment_id": 117959454, "body": "This should be the accepted answer!"}], "tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": false, "score": 19, "last_activity_date": 1423577107, "creation_date": 1423577107, "answer_id": 28433636, "question_id": 28432398, "link": "https://stackoverflow.com/questions/28432398/difference-between-some-operators-golang/28433636#28433636", "title": "Difference between some operators &quot;|&quot;, &quot;^&quot;, &quot;&amp;&quot;, &quot;&amp;^&quot;. Golang", "body": "<p>For what they technically do check out the comments in this</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    // Use bitwise OR | to get the bits that are in 1 OR 2\n    // 1     = 00000001\n    // 2     = 00000010\n    // 1 | 2 = 00000011 = 3\n    fmt.Println(1 | 2)\n\n    // Use bitwise OR | to get the bits that are in 1 OR 5\n    // 1     = 00000001\n    // 5     = 00000101\n    // 1 | 5 = 00000101 = 5\n    fmt.Println(1 | 5)\n\n    // Use bitwise XOR ^ to get the bits that are in 3 OR 6 BUT NOT BOTH\n    // 3     = 00000011\n    // 6     = 00000110\n    // 3 ^ 6 = 00000101 = 5\n    fmt.Println(3 ^ 6)\n\n    // Use bitwise AND &amp; to get the bits that are in 3 AND 6\n    // 3     = 00000011\n    // 6     = 00000110\n    // 3 &amp; 6 = 00000010 = 2\n    fmt.Println(3 &amp; 6)  \n\n    // Use bit clear AND NOT &amp;^ to get the bits that are in 3 AND NOT 6 (order matters)\n    // 3      = 00000011\n    // 6      = 00000110\n    // 3 &amp;^ 6 = 00000001 = 1\n    fmt.Println(3 &amp;^ 6)\n}\n</code></pre>\n\n<p><kbd><a href=\"https://play.golang.org/p/FFYKdhU0zM\">View it on the playground</a></kbd></p>\n\n<p>Please note that I gave two examples of <code>|</code> to show that it's not really addition like <code>1 + 5</code>.</p>\n\n<p>As for practical uses I'm sure some others could comment with more examples but one common use is to create a bitmask of flags for something like a permission system.</p>\n"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25221, "favorite_count": 7, "accepted_answer_id": 28433370, "answer_count": 2, "score": 24, "last_activity_date": 1503600311, "creation_date": 1423573420, "question_id": 28432398, "link": "https://stackoverflow.com/questions/28432398/difference-between-some-operators-golang", "title": "Difference between some operators &quot;|&quot;, &quot;^&quot;, &quot;&amp;&quot;, &quot;&amp;^&quot;. Golang", "body": "<p>Recently I read golang specification and faced with some interesting operators:</p>\n\n<pre><code>&amp;    bitwise AND            integers\n|    bitwise OR             integers\n^    bitwise XOR            integers\n&amp;^   bit clear (AND NOT)    integers\n</code></pre>\n\n<p>I've tried to play with it, but the only one I have understood is that \"|\" add integers and \"+\" operator additionally work with floats, strings etc.</p>\n\n<p>What they are used for in practice? Could anyone give some explanation about these 4 operators above?</p>\n"}, {"tags": ["vim", "go"], "answers": [{"tags": [], "owner": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "is_accepted": true, "score": -1, "last_activity_date": 1423562786, "creation_date": 1423562786, "answer_id": 28428915, "question_id": 28428807, "link": "https://stackoverflow.com/questions/28428807/how-to-fold-errors-checks-in-go-in-vim/28428915#28428915", "title": "How to fold errors checks in go in vim?", "body": "<p>This will do the trick <code>:g/\\s*if err /normal jva{zf</code></p>\n"}], "owner": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 28428915, "answer_count": 1, "score": 1, "last_activity_date": 1423562786, "creation_date": 1423562479, "question_id": 28428807, "link": "https://stackoverflow.com/questions/28428807/how-to-fold-errors-checks-in-go-in-vim", "title": "How to fold errors checks in go in vim?", "body": "<p>In my code I have a lot of such checks:</p>\n\n<pre><code>if err != nil {\n  // foo\n}\n</code></pre>\n\n<p>How to easily fold them in vim?</p>\n"}, {"tags": ["go", "pprof"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1423557908, "post_id": 28426956, "comment_id": 45186339, "body": "it works for me. Are you sure the prof file is created ok? what&#39;s the size of it? you&#39;re not checking the error from opening it, any chance you simply can&#39;t?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1423559244, "post_id": 28426956, "comment_id": 45186978, "body": "Maybe your code simply does not enough work? CPU profiling is done by sampling. What happens if you run pprof interactively?"}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1423559729, "post_id": 28426956, "comment_id": 45187227, "body": "Are you on Linux? What kernel version? Older kernels (&gt;~9yrs) have problems. <a href=\"https://code.google.com/p/gperftools/issues/detail?id=335\" rel=\"nofollow noreferrer\">code.google.com/p/gperftools/issues/detail?id=335</a>"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1423563184, "post_id": 28426956, "comment_id": 45189227, "body": "@Julio is the memory growing when you are not running the cpu profiling?"}, {"owner": {"reputation": 2253, "user_id": 1630586, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/902ef27763348c8d6d6aba56ffdf7304?s=128&d=identicon&r=PG", "display_name": "Julio", "link": "https://stackoverflow.com/users/1630586/julio"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1423565880, "post_id": 28426956, "comment_id": 45190754, "body": "@Not_a_Golfer: Yes the memory consumption is growing slowly (from 1876 to 1996 in 30 minutes). Maybe the garbage collector is not flushing when the memory consumption is to slow?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1423567756, "post_id": 28426956, "comment_id": 45191707, "body": "@Julio you can tune the GC collection threshold. The default is 100% (meaning your process can use up to twice the memory it actually uses), but if you are short on memory, try a value in the range of 10-20%."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1423567909, "post_id": 28426956, "comment_id": 45191790, "body": "@Julio see <a href=\"http://golang.org/pkg/runtime/debug/#SetGCPercent\" rel=\"nofollow noreferrer\">golang.org/pkg/runtime/debug/#SetGCPercent</a>"}, {"owner": {"reputation": 2253, "user_id": 1630586, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/902ef27763348c8d6d6aba56ffdf7304?s=128&d=identicon&r=PG", "display_name": "Julio", "link": "https://stackoverflow.com/users/1630586/julio"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1423691548, "post_id": 28426956, "comment_id": 45256120, "body": "@Not_a_Golfer Thank you this helps me a lot."}], "owner": {"reputation": 2253, "user_id": 1630586, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/902ef27763348c8d6d6aba56ffdf7304?s=128&d=identicon&r=PG", "display_name": "Julio", "link": "https://stackoverflow.com/users/1630586/julio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1192, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1423596650, "creation_date": 1423556262, "last_edit_date": 1423596650, "question_id": 28426956, "link": "https://stackoverflow.com/questions/28426956/pprof-no-nodes-to-print", "title": "pprof, No nodes to print", "body": "<p>I have a memory leak in a small program. In order to find the leak, I would like to use <code>pprof</code>.</p>\n\n<p>I set it up like this:</p>\n\n<pre><code>func main() {\n    f, _ := os.Create(\"my_pprof.pprof\")\n    pprof.StartCPUProfile(f)\n\n    go func() {\n        main2()\n    }()\n\n    time.Sleep(1*time.Minute)\n    pprof.StopCPUProfile()\n    f.Close()\n    panic(\"QUIT\")\n}\n</code></pre>\n\n<p>When I want to generate the graph, I have the error:</p>\n\n<pre><code>$ go tool pprof --pdf my_prog my_pprof.pprof &gt; callgraph.pdf\nNo nodes to print\n</code></pre>\n\n<p>Why isn't possible to get nodes?</p>\n\n<p><strong>UPDATE:</strong>\nThis program will reproduce the issue.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n    \"time\"\n    \"os\"\n    \"log\"\n    \"runtime/pprof\"\n)\n\nfunc pollExec() {\n    ticker := time.NewTicker(5 * time.Millisecond)\n    quit := make(chan struct{})\n    for {\n        select {\n            case &lt;-ticker.C:\n                const command = \"cat\"\n                const arg= \"my_project/src/probe/test_pprof.go\"\n                log.Printf(\"Execute command: \" + command + \" \" + arg)\n                cmd := exec.Command(command, arg)\n                out, err := cmd.Output()\n                if err != nil {\n                    panic(\"Can't execute command: \" + command)\n                }\n                fmt.Printf(\"Output: %s\\n\", out)\n\n            case &lt;-quit:\n                ticker.Stop()\n                return\n        }\n    }\n}\n\n\nfunc main() {\n    const pprofFileName = \"my_project/src/probe/test.pprof\"\n    f, err := os.Create(pprofFileName)\n    if err != nil {\n        panic(\"Can't open file: \" + pprofFileName)\n    }\n    pprof.StartCPUProfile(f)\n\n    go func() {\n        pollExec()\n    }()\n\n    time.Sleep(1*time.Minute)\n    pprof.StopCPUProfile()\n    f.Close()\n    panic(\"QUIT\")\n}\n</code></pre>\n\n<p>I run it on:</p>\n\n<pre><code>$ uname -a\nLinux ubuntu 3.13.0-34-generic #60-Ubuntu SMP Wed Aug 13 15:45:27 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux\n</code></pre>\n\n<p>The global context is that I have a very small program pushing information based on a Unix command result. The program size is around 3MB, I have only 40MB ram to run it 24/7. When I leave the example running, the size is growing and growing. I don't know where the leak is and I am very uncomfortable with <code>go</code> as this is my first program in this language. \nFor the example provided in this post, the memory consumption increased with the time:</p>\n\n<pre><code> PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                            \n16723 paralle+  20   0    6408   1700    816 S   2.0  0.2   0:00.52 test_pprof\nAfter few minutes\u2026\n16723 paralle+  20   0    6408   1960    832 S   1.7  0.2   0:04.76 test_pprof  \n</code></pre>\n"}, {"tags": ["arrays", "random", "go", "cryptography"], "answers": [{"tags": [], "owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "is_accepted": true, "score": 5, "last_activity_date": 1423551921, "creation_date": 1423551921, "answer_id": 28425912, "question_id": 28425866, "link": "https://stackoverflow.com/questions/28425866/how-can-i-use-20bytes-type-as-parameter-instead-of-bytes-in-crypto-rand-read/28425912#28425912", "title": "How can I use [20]bytes type as parameter instead of []bytes in crypto.rand.Read?", "body": "<p>To create a slice that is backed by an array, you can write e.g. <code>hash[i:j]</code> (which returns a slice from index <code>i</code> to index <code>j-1</code>). In your case, you can write:</p>\n\n<pre><code>var hash [20]byte\n_, err := rand.Read(hash[0:20])\n</code></pre>\n\n<p>or, since the default endpoints are <code>0</code> and the array-length:</p>\n\n<pre><code>var hash [20]byte\n_, err := rand.Read(hash[:])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 2, "last_activity_date": 1423552061, "creation_date": 1423552061, "answer_id": 28425941, "question_id": 28425866, "link": "https://stackoverflow.com/questions/28425866/how-can-i-use-20bytes-type-as-parameter-instead-of-bytes-in-crypto-rand-read/28425941#28425941", "title": "How can I use [20]bytes type as parameter instead of []bytes in crypto.rand.Read?", "body": "<p>You can slice it (<a href=\"http://play.golang.org/p/cv9emWM305\" rel=\"nofollow\">see playground</a>):</p>\n\n<pre><code>shash := hash[:]\nrand.Read(shash)\n</code></pre>\n\n<p>As mentioned in <a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow\">Go Slices: usage and internals</a>:</p>\n\n<blockquote>\n  <p>The start and end indices of a slice expression are optional; they default to zero and the slice's length respectively.</p>\n</blockquote>\n"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 2, "accepted_answer_id": 28425912, "answer_count": 2, "score": 4, "last_activity_date": 1423575643, "creation_date": 1423551676, "last_edit_date": 1423575643, "question_id": 28425866, "link": "https://stackoverflow.com/questions/28425866/how-can-i-use-20bytes-type-as-parameter-instead-of-bytes-in-crypto-rand-read", "title": "How can I use [20]bytes type as parameter instead of []bytes in crypto.rand.Read?", "body": "<p>I want to read random values into a byte array. It works like this:</p>\n\n<pre><code>hash = make([]byte,20)\n_, err := rand.Read(hash)\n</code></pre>\n\n<p>But I want to do something like</p>\n\n<pre><code>var hash [20]byte\n_, err := rand.Read(hash)\n</code></pre>\n\n<p>which results in a </p>\n\n<pre><code>cannot use hash (type [20]byte) as type []byte in argument to \"crypto/rand\".Read\n</code></pre>\n\n<p>How can I use a [20]byte with rand.Read?</p>\n"}, {"tags": ["go", "youtube-api", "google-api-go-client"], "answers": [{"tags": [], "owner": {"reputation": 852, "user_id": 3557679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41a6a162eaae49373538db6356e0dda3?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Yeah", "link": "https://stackoverflow.com/users/3557679/mr-yeah"}, "is_accepted": false, "score": 1, "last_activity_date": 1423593260, "creation_date": 1423593260, "answer_id": 28439178, "question_id": 28423010, "link": "https://stackoverflow.com/questions/28423010/youtube-v3-api-using-code-google-com-p-google-api-go-client-youtube-v3/28439178#28439178", "title": "YouTube v3 api using code.google.com/p/google-api-go-client/youtube/v3", "body": "<pre><code>response.Items[0].ContentDetails.RelatedPlaylists.Uploads\n</code></pre>\n\n<p>should work.</p>\n"}], "owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1575361274, "creation_date": 1423534849, "last_edit_date": 1575361274, "question_id": 28423010, "link": "https://stackoverflow.com/questions/28423010/youtube-v3-api-using-code-google-com-p-google-api-go-client-youtube-v3", "title": "YouTube v3 api using code.google.com/p/google-api-go-client/youtube/v3", "body": "<p>Trying to grab a list of uploads from my channel but I get the error \"ChannelContentDetails has no field or method Uploads\"</p>\n\n<pre><code>apiCall := youtube.Channels.List(\"contentDetails\").Mine(true)\nresponse, err := apiCall.Do()\nif err != nil {\nlog.Fatalf(\"Error making API call: %v\", err.Error())\n}\nfmt.Println(response.Items[0].ContentDetails.uploads)\n</code></pre>\n"}, {"tags": ["caching", "go", "redis"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1423527607, "post_id": 28421536, "comment_id": 45177009, "body": "As long as your Redis instances stay up, you should not be losing data. Show how you store items in Redis and provide more info about the twemproxy config. A few nits: PING on every borrow is excessive. I would run this with no PINGs.  MaxIdle of 25000 is excessive. You will probably run of fds before hitting this limit.  MaxIdle of 3 may be low. I&#39;d instrument to see how often you are dialing and increase MaxIdle is appropriate. Use redis.Bytes instead of redis.String to save some pointless conversion to string and back to bytes. Use w.Write(p) where p is return from redis.Bytes."}, {"owner": {"reputation": 195, "user_id": 3058059, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b07c8569b1b5fbef32871087d9df0ec2?s=128&d=identicon&r=PG&f=1", "display_name": "ankits", "link": "https://stackoverflow.com/users/3058059/ankits"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1423528545, "post_id": 28421536, "comment_id": 45177276, "body": "Thanks for your reply ThunderCat, some very good insights there. I have removed the PING now and monitoring. I was actually load testing yesterday in anticipation of high traffic so left the setting at this high limit. Apart from this, I&#39;m sharing my code for storing items in Redis and twemproxy config."}, {"owner": {"reputation": 195, "user_id": 3058059, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b07c8569b1b5fbef32871087d9df0ec2?s=128&d=identicon&r=PG&f=1", "display_name": "ankits", "link": "https://stackoverflow.com/users/3058059/ankits"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1423529468, "post_id": 28421536, "comment_id": 45177556, "body": "Actually, as I am facing this issue I realise that I cannot see any data from redis-cli as well which means that for some reason my data is not persisted. I removed twemproxy yet the issue persists, any ideas ??"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1423531339, "post_id": 28421536, "comment_id": 45178052, "body": "SetIntoRedis does not close the connection. It&#39;s possible that the issue is related to this resource leak. It&#39;s best practice in Go to <code>defer</code> the call to release a resource immediately following the statement that gets the resource. Move <code>defer conn.Close()</code> up one line in <code>api</code>.  Add the defer to SetIntoRedis."}, {"owner": {"reputation": 195, "user_id": 3058059, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b07c8569b1b5fbef32871087d9df0ec2?s=128&d=identicon&r=PG&f=1", "display_name": "ankits", "link": "https://stackoverflow.com/users/3058059/ankits"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1423807101, "post_id": 28421536, "comment_id": 45307082, "body": "Thanks a lot, it does seem to resolve the now and also the results on load test have improved."}], "owner": {"reputation": 195, "user_id": 3058059, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b07c8569b1b5fbef32871087d9df0ec2?s=128&d=identicon&r=PG&f=1", "display_name": "ankits", "link": "https://stackoverflow.com/users/3058059/ankits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1234, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1423528377, "creation_date": 1423524904, "last_edit_date": 1423528377, "question_id": 28421536, "link": "https://stackoverflow.com/questions/28421536/redis-instance-missing-cache-often-using-go-lang-client-redigo", "title": "Redis instance missing cache often using go-lang client redigo", "body": "<p>I'm developing an api for blog or online publishing website to develop a recommendation engine for their content.\nSince my api returns same json for same url request, I decided to use Redis as a cache for high traffic websites by passing the url as key and json as value. I am developing this api in go-lang recently and have been using redigo to talk to our Redis instance. The way I decided to architect my system is to check the url of the query sent by the client (blog) and search for it in redis. If however, the url response in not cached I do a 301 redirect to another api that applied the logic to generate the json response for that particular url and also set the redis cache. However, while I'm testing if my Redis is working properly, I realised that it is missing cache far too often than what I would like. It's definitely caching the json response mapped to the url as confirmed by doing a simple GET in Redis-cli but after 3-4 hits I could see Redis missing cache again. I'm still very new to go-lang and caching world so I'm not sure if I'm missing something in my implementation. Also, I would like to know under what circumstances can Redis instance miss caches ? It can't be timeout because Redis docs says \"By default recent versions of Redis don't close the connection with the client if the client is idle for many seconds: the connection will remain open forever.\" so I'm not sure what exactly is happening with my setup. Relevant part of my code is below:</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"github.com/garyburd/redigo/redis\"\n    \"log\"\n    \"net/http\"\n    \"time\"\n)\n\nvar (\n    port          int\n    folder        string\n    pool          *redis.Pool\n    redisServer   = flag.String(\"redisServer\", \"redisip:22121\", \"\")\n    redisPassword = flag.String(\"redisPassword\", \"\", \"\")\n)\n\nfunc init() {\n    flag.IntVar(&amp;port, \"port\", 80, \"HTTP Server Port\")\n    flag.StringVar(&amp;folder, \"folder\", \"www\", \"Serve this folder\")\n}\n\nfunc newPool(server, password string) *redis.Pool {\n    return &amp;redis.Pool{\n        MaxIdle:     3,\n        MaxActive:   25000,\n        IdleTimeout: 30 * time.Second,\n        Dial: func() (redis.Conn, error) {\n            c, err := redis.Dial(\"tcp\", server)\n            if err != nil {\n                return nil, err\n            }\n            return c, err\n        },\n        TestOnBorrow: func(c redis.Conn, t time.Time) error {\n            _, err := c.Do(\"PING\")\n            return err\n        },\n    }\n}\n\nfunc main() {\n    flag.Parse()\n    pool = newPool(*redisServer, *redisPassword)\n    httpAddr := fmt.Sprintf(\":%v\", port)\n    log.Printf(\"Listening to %v\", httpAddr)\n    http.HandleFunc(\"/api\", api)\n\n    http.Handle(\"/static/\", http.StripPrefix(\"/static/\", http.FileServer(http.Dir(folder))))\n    log.Fatal(http.ListenAndServe(httpAddr, nil))\n\n}\n\nfunc api(w http.ResponseWriter, r *http.Request) {\n    link := r.URL.Query().Get(\"url\")\n    fmt.Println(link)\n    heading := r.URL.Query().Get(\"heading\")\n    conn := pool.Get()\n    reply, err := redis.String(conn.Do(\"GET\", link))\n    defer conn.Close()\n    if err != nil {\n        fmt.Println(\"Error for link %v:%v\", heading, err)\n        http.Redirect(w, r, \"json-producing-api\", 301)\n    }\n    fmt.Fprint(w, reply)\n\n}\n</code></pre>\n\n<p>I must also mention here that in the above code, my redis instance is actually a twemproxy client built by twitter which proxies three different redis client running behind on three different ports. Everything seemed to worked normal yesterday and I did a successful load test for 5k concurrent reuquests. However, when I checked the log today some queries were being missed by redis and were being redirected to my json-producing-api and I could see redigo:nil error. I'm totally confused as to what exactly is going wrong? Any help will be greatly appreciated.</p>\n\n<p>EDIT: As per discussions below, I'm detailing the code that I use to set the data in Redis</p>\n\n<pre><code>func SetIntoRedis(key string, value string) bool {\n    // returns true if successfully set, returns false in case of an error\n    conn := pool.Get()\n    _, err := conn.Do(\"SET\", key, value)\n    if err != nil {\n\n        log.Printf(\"Error Setting %v : %v\", key, err)\n        return false\n    }\n    return true\n}\n</code></pre>\n\n<p>Configuration of my twemproxy client </p>\n\n<pre><code>leaf:\n  listen: 0.0.0.0:22121\n  hash: fnv1a_64\n  distribution: ketama\n  redis: true\n  auto_eject_hosts: true\n  server_retry_timeout: 3000\n  server_failure_limit: 3\n  servers:\n   - 127.0.0.1:6379:1\n   - 127.0.0.1:6380:1\n   - 127.0.0.1:6381:1\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 305, "user_id": 680134, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4fa49ac041856525cdebfc3f79a85177?s=128&d=identicon&r=PG", "display_name": "plithner", "link": "https://stackoverflow.com/users/680134/plithner"}, "edited": false, "score": 0, "creation_date": 1423561879, "post_id": 28420039, "comment_id": 45188458, "body": "Thanks a lot for the help! In the end I used the method proposed by sberry instead, but I still appreciate the help!"}, {"owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "edited": false, "score": 0, "creation_date": 1470609973, "post_id": 28420039, "comment_id": 65005227, "body": "This is like &quot;Go-style Singleton Pattern&quot;."}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "edited": false, "score": 0, "creation_date": 1470673705, "post_id": 28420039, "comment_id": 65033723, "body": "@SiuChingPong-AsukaKenji- nah, just a global variable. You could have a singleton in Go with a private type with a public constructor function that returned the private var that was the instance of the private type, this would enforce the singleton pattern. I&#39;m not sure I&#39;ve seen anyone who codes in Go do much of that though."}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": false, "score": 2, "last_activity_date": 1423518514, "creation_date": 1423518514, "answer_id": 28420039, "question_id": 28419876, "link": "https://stackoverflow.com/questions/28419876/golang-handlefunc-with-channel/28420039#28420039", "title": "Golang handlefunc with channel", "body": "<p>There a few ways to solve this problem, the simplest is to define an exported channel in a package and import said package where ever you want to use the channel.</p>\n\n<pre><code>package mychannel\n\nvar Chan = make(chan string)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 305, "user_id": 680134, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4fa49ac041856525cdebfc3f79a85177?s=128&d=identicon&r=PG", "display_name": "plithner", "link": "https://stackoverflow.com/users/680134/plithner"}, "edited": false, "score": 0, "creation_date": 1423561813, "post_id": 28422416, "comment_id": 45188417, "body": "Thank you so much for the great example. I ended up using method 1, and it does the job perfectly."}, {"owner": {"reputation": 641, "user_id": 3182879, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/603989666/picture?type=large", "display_name": "Esser420", "link": "https://stackoverflow.com/users/3182879/esser420"}, "edited": false, "score": 1, "creation_date": 1514982428, "post_id": 28422416, "comment_id": 83128459, "body": "Coming from python I could not figure out how to do such a simple thing. Funny how there actually is a very simple solution to the problem, all that was needed is a paradigm shift."}, {"owner": {"reputation": 982, "user_id": 6554662, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154470556032446/picture?type=large", "display_name": "Andy", "link": "https://stackoverflow.com/users/6554662/andy"}, "edited": false, "score": 0, "creation_date": 1533505885, "post_id": 28422416, "comment_id": 90358501, "body": "method 2 won&#39;t work. Every time a channel is added to main(), the server spin up but doesn&#39;t work. Either by using a struct ad receiver or by global var chan."}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "reply_to_user": {"reputation": 982, "user_id": 6554662, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154470556032446/picture?type=large", "display_name": "Andy", "link": "https://stackoverflow.com/users/6554662/andy"}, "edited": false, "score": 0, "creation_date": 1533589367, "post_id": 28422416, "comment_id": 90392545, "body": "@Andy Does the example code above not work?  I think it shows pretty clearly that method 2 does work but I&#39;d be interested to know if I am wrong."}, {"owner": {"reputation": 347, "user_id": 2978960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fVcfi.jpg?s=128&g=1", "display_name": "fakturk", "link": "https://stackoverflow.com/users/2978960/fakturk"}, "edited": false, "score": 0, "creation_date": 1564006093, "post_id": 28422416, "comment_id": 100893196, "body": "I also end up using first method, it was useful"}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 17, "last_activity_date": 1423530367, "creation_date": 1423530367, "answer_id": 28422416, "question_id": 28419876, "link": "https://stackoverflow.com/questions/28419876/golang-handlefunc-with-channel/28422416#28422416", "title": "Golang handlefunc with channel", "body": "<p>There are two other ways to do this (other than exporting your channels as in the previous answer).</p>\n\n<p>The first is to use a function to return another handler function.  When the function is returned, it will create a closure around the channel.</p>\n\n<pre><code>func makeHello(logger chan string) func(http.ResponseWriter, *http.Request) {\n    return func(w http.ResponseWriter, r *http.Request) {\n        logger &lt;- r.Host\n        io.WriteString(w, \"Hello world!\")\n    }\n}\n</code></pre>\n\n<p>The second is to use a struct which holds the channel as a member and use pointer receiver methods to handle the request...</p>\n\n<pre><code>type DataPasser struct {\n    logs chan string\n}\n\nfunc (p *DataPasser) handleHello(w http.ResponseWriter, r *http.Request) {\n    p.logs &lt;- r.URL.String()\n    io.WriteString(w, \"Hello world\")\n}\n</code></pre>\n\n<p>This is a full working example (just hit /1 and /2 to see the two examples)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"net/http\"\n)\n\nfunc main() {\n    // METHOD 1\n    logs := make(chan string)\n    go logLogs(logs)\n    handleHello := makeHello(logs)\n\n    // METHOD 2\n    passer := &amp;DataPasser{logs: make(chan string)}\n    go passer.log()\n\n    http.HandleFunc(\"/1\", handleHello)\n    http.HandleFunc(\"/2\", passer.handleHello)\n    http.ListenAndServe(\":9999\", nil)\n}\n\n// METHOD 1\n\nfunc makeHello(logger chan string) func(http.ResponseWriter, *http.Request) {\n    return func(w http.ResponseWriter, r *http.Request) {\n        logger &lt;- r.Host\n        io.WriteString(w, \"Hello world!\")\n    }\n}\n\nfunc logLogs(logger chan string) {\n    for item := range logger {\n        fmt.Println(\"1. Item\", item)\n    }\n}\n\n// METHOD 2\n\ntype DataPasser struct {\n    logs chan string\n}\n\nfunc (p *DataPasser) handleHello(w http.ResponseWriter, r *http.Request) {\n    p.logs &lt;- r.URL.String()\n    io.WriteString(w, \"Hello world\")\n}\n\nfunc (p *DataPasser) log() {\n    for item := range p.logs {\n        fmt.Println(\"2. Item\", item)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 680134, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4fa49ac041856525cdebfc3f79a85177?s=128&d=identicon&r=PG", "display_name": "plithner", "link": "https://stackoverflow.com/users/680134/plithner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5424, "favorite_count": 3, "accepted_answer_id": 28422416, "answer_count": 2, "score": 7, "last_activity_date": 1423530367, "creation_date": 1423517846, "question_id": 28419876, "link": "https://stackoverflow.com/questions/28419876/golang-handlefunc-with-channel", "title": "Golang handlefunc with channel", "body": "<p>I think this question has been asked before (and probably more than once) but I can't find it...</p>\n\n<p>Im learning Go, and I wanted to extend the classical web server example by sending a channel to the \"handler\". </p>\n\n<p>I have this standard thing:</p>\n\n<pre><code>func hello(w http.ResponseWriter, r *http.Request) {\n   io.WriteString(w, \"Hello world!\")\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", hello)\n    http.ListenAndServe(\":8000\", nil)\n}\n</code></pre>\n\n<p>And now I would like the \"hello\" function to be able to write stuff on a channel, for someone to consume... The way I have done with \"normal\" functions is to create a channel:</p>\n\n<pre><code>c := make(chan string) \n</code></pre>\n\n<p>and pass c in the call to the function. Something like:</p>\n\n<pre><code>dosomething(c)\n</code></pre>\n\n<p>But... how would I go about doing that if I want \"hello\" to get access to the channel c?</p>\n"}, {"tags": ["go", "xml-parsing"], "answers": [{"comments": [{"owner": {"reputation": 1893, "user_id": 127958, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0846808c184064b26729044cdeb75a5d?s=128&d=identicon&r=PG", "display_name": "kadalamittai", "link": "https://stackoverflow.com/users/127958/kadalamittai"}, "edited": false, "score": 0, "creation_date": 1423519045, "post_id": 28419830, "comment_id": 45173483, "body": "yes that was my question. whats so special with that UTF character. how i parse with that character"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "reply_to_user": {"reputation": 1893, "user_id": 127958, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0846808c184064b26729044cdeb75a5d?s=128&d=identicon&r=PG", "display_name": "kadalamittai", "link": "https://stackoverflow.com/users/127958/kadalamittai"}, "edited": false, "score": 0, "creation_date": 1423519464, "post_id": 28419830, "comment_id": 45173706, "body": "Its <a href=\"http://en.wikipedia.org/wiki/Valid_characters_in_XML\" rel=\"nofollow noreferrer\">not a valid XML character</a>."}], "tags": [], "owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "is_accepted": false, "score": 3, "last_activity_date": 1423517666, "creation_date": 1423517666, "answer_id": 28419830, "question_id": 28419396, "link": "https://stackoverflow.com/questions/28419396/xml-unmarshal-failing/28419830#28419830", "title": "Xml Unmarshal failing", "body": "<h3>Don't ignore your errors</h3>\n\n<p>Your input data is invalid.</p>\n\n<p><code>xml.Unmarshal</code> returns an <code>error</code> if it fails. Replacing your call with this:</p>\n\n<pre><code>if err != nil {\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>...shows:</p>\n\n<pre><code>XML syntax error on line 6: illegal character code U+001F\n</code></pre>\n\n<p>Removing the <code>&amp;#031</code> from your input makes it work.</p>\n\n<p><kbd><a href=\"http://play.golang.org/p/7ZD1C0uyLD\" rel=\"nofollow\">See it on the Go Playground</a></kbd></p>\n"}], "owner": {"reputation": 1893, "user_id": 127958, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0846808c184064b26729044cdeb75a5d?s=128&d=identicon&r=PG", "display_name": "kadalamittai", "link": "https://stackoverflow.com/users/127958/kadalamittai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1593, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423517666, "creation_date": 1423516085, "question_id": 28419396, "link": "https://stackoverflow.com/questions/28419396/xml-unmarshal-failing", "title": "Xml Unmarshal failing", "body": "<p>i am trying to Unmarshal simple Xml Schema to Struct. appears to be failing if i have <code>&amp;#031;</code> found in any of my Xml Node value. </p>\n\n<p>Reading an Xml file leads to runtime error.\nReading an Xml string leads to missing all other</p>\n\n<p>Sample : <a href=\"http://play.golang.org/p/waNn_1NpD1\" rel=\"nofollow\">http://play.golang.org/p/waNn_1NpD1</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n)\n\nconst (\n  s = `&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n        &lt;feed&gt;\n            &lt;product&gt;\n                &lt;description&gt;\n                 TEST VALUE sdfsdfsdfsdfsd   TEST VALUE sdfsdfsdfsdfsd   TEST VALUE sdfsdfsdfsdfsd   TEST VALUE sdfsdfsdfsdfsd    &amp;#031;\n                &lt;/description&gt;\n                &lt;sku&gt;ABCDD!@#&lt;/sku&gt;\n            &lt;/product&gt;  \n       &lt;/feed&gt;`\n)\n\ntype (\n    Feed struct {\n        XMLName xml.Name `xml:\"feed\"`\n        Product Product  `xml:\"product\"`\n    }\n\n    Product struct {\n        XMLName     xml.Name `xml:\"product\"`\n        Description string   `xml:\"description\"`\n        SKU         string   `xml:\"sku\"`\n    }\n)\n\n    func main() {\n        fmt.Println(\"Hello, playground\")\n        b := []byte(s)\n        var feed Feed\n        xml.Unmarshal(b, &amp;feed)\n        fmt.Println(feed.Product.Description)\n        fmt.Println(feed.Product.SKU)\n    }\n</code></pre>\n"}, {"tags": ["windows", "go", "terminal"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 8, "last_activity_date": 1423518539, "creation_date": 1423518539, "answer_id": 28420046, "question_id": 28418950, "link": "https://stackoverflow.com/questions/28418950/get-terminal-width-in-windows-using-golang/28420046#28420046", "title": "Get terminal width in Windows using golang", "body": "<p>You need to call <code>termbox.Init()</code> before you call <code>termbox.Size()</code>, and then <code>termbox.Close()</code> when you're done.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/nsf/termbox-go\"\n)\n\nfunc main() {\n    if err := termbox.Init(); err != nil {\n        panic(err)\n    }\n    w, h := termbox.Size()\n    termbox.Close()\n    fmt.Println(w, h)\n}\n</code></pre>\n"}], "owner": {"reputation": 11762, "user_id": 14540, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c4ceadae4f61dac8ff3ababc3faa6c42?s=128&d=identicon&r=PG", "display_name": "kolrie", "link": "https://stackoverflow.com/users/14540/kolrie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2141, "favorite_count": 2, "accepted_answer_id": 28420046, "answer_count": 1, "score": 6, "last_activity_date": 1423518539, "creation_date": 1423514529, "question_id": 28418950, "link": "https://stackoverflow.com/questions/28418950/get-terminal-width-in-windows-using-golang", "title": "Get terminal width in Windows using golang", "body": "<p>Is it possible to get the terminal width in Go? </p>\n\n<p>I tried using <a href=\"http://github.com/nsf/termbox-go\" rel=\"noreferrer\">http://github.com/nsf/termbox-go</a> with the code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/nsf/termbox-go\"\n)\n\nfunc main() {\n    fmt.Println(termbox.Size())\n}\n</code></pre>\n\n<p>But it prints <code>0 0</code>.</p>\n\n<p>I also tried <a href=\"http://github.com/buger/goterm\" rel=\"noreferrer\">http://github.com/buger/goterm</a> but when I try to <code>go get</code> it, I get an error:</p>\n\n<pre><code>$ go get github.com/buger/goterm\n# github.com/buger/goterm\n..\\..\\buger\\goterm\\terminal.go:78: undefined: syscall.SYS_IOCTL\n..\\..\\buger\\goterm\\terminal.go:82: not enough arguments in call to syscall.Syscall\n</code></pre>\n\n<p>Any other ideas on how to get the terminal width?</p>\n"}, {"tags": ["unit-testing", "interface", "go", "mocking", "vsphere"], "comments": [{"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1598313948, "post_id": 28418430, "comment_id": 112412419, "body": "It may be worth noting that APIs that take in a one-method <code>interface</code> could be re-written as taking a function type. See <a href=\"https://stackoverflow.com/a/63557675/12817546\">stackoverflow.com/a/63557675/12817546</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "is_accepted": false, "score": 2, "last_activity_date": 1423514048, "creation_date": 1423514048, "answer_id": 28418822, "question_id": 28418430, "link": "https://stackoverflow.com/questions/28418430/interface-use-in-golang-for-mocking-third-party-libraries/28418822#28418822", "title": "Interface use in golang for mocking third party libraries", "body": "<p>This library is a SOAP client (<a href=\"http://godoc.org/github.com/vmware/govmomi/vim25/soap#Client\" rel=\"nofollow\">http://godoc.org/github.com/vmware/govmomi/vim25/soap#Client</a>). Abstract at the HTTP layer with net/http/httptest (<a href=\"http://golang.org/pkg/net/http/httptest/\" rel=\"nofollow\">http://golang.org/pkg/net/http/httptest/</a>) or by using your own HTTPRoundtripper to mock the response.</p>\n"}], "owner": {"reputation": 61, "user_id": 4547224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7667af193a588bb91bc317fa011fc55?s=128&d=identicon&r=PG&f=1", "display_name": "cptino", "link": "https://stackoverflow.com/users/4547224/cptino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1144, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1423514048, "creation_date": 1423512718, "question_id": 28418430, "link": "https://stackoverflow.com/questions/28418430/interface-use-in-golang-for-mocking-third-party-libraries", "title": "Interface use in golang for mocking third party libraries", "body": "<p>I'm trying to create a simple mock for unit testing some code using the VMware vSphere API client - <a href=\"http://godoc.org/github.com/vmware/govmomi\" rel=\"noreferrer\">govmomi</a> - but I'm having trouble finding a usable pattern.</p>\n\n<p>A simple use case for the client library would be to retrieve the installed licenses for a vSphere cluster:</p>\n\n<pre><code>vclient, err := govmomi.NewClient(*vcurl, true)\nif err != nil {\n return err\n}\nlic, err := vclient.LicenseManager().ListLicenses()\n</code></pre>\n\n<p><code>NewClient()</code> returns a pointer to a Client structure, <code>Client.LicenseManager()</code> returns an instance of a LicenseManager structure, and <code>LicenseManager.ListLicenses()</code> returns a slice of structures containing the license info.  Coming from a Python background, I'd usually monkey patch the <code>ListLicenses()</code> method on <code>LicenseManger</code> for a mock, but I can't seem to come up with a comparable pattern or methodology in Go.</p>\n\n<p>To this point, I've tried creating a wrapper structure <code>VCenterClient</code> with the govmomi <code>Client</code> structure as an anonymous member and a \"constructor\" function <code>NewVCenter()</code> to create new instances of the wrapper structure with logic for mocks:</p>\n\n<pre><code>import (\n \"net/url\"\n\n\n \"github.com/vmware/govmomi\"\n \"github.com/vmware/govmomi/vim25/types\"\n)\n\n\ntype VCenterClient struct {\n VCenterClientInterface\n}\n\n\ntype VCenterClientInterface interface {\n LicenseManager() LicenseManager\n}\n\n\ntype LicenseManager interface {\n ListLicenses() ([]types.LicenseManagerLicenseInfo, error)\n}\n\n\ntype VCenterClientMock struct{}\ntype LicenseManagerMock struct{}\n\n\nfunc (v *VCenterClientMock) LicenseManager() LicenseManager {\n return LicenseManagerMock{}\n}\n\n\nfunc (l LicenseManagerMock) ListLicenses() ([]types.LicenseManagerLicenseInfo, error) {\n return make([]types.LicenseManagerLicenseInfo, 0), nil\n}\n\n\nfunc NewVCenterClient(uri string, mock bool) *VCenterClient {\n if mock {\n return &amp;VCenterClient{&amp;VCenterClientMock{}}\n }\n\n\n vcurl, _ := url.Parse(uri)\n vclient, _ := govmomi.NewClient(*vcurl, true)\n return &amp;VCenterClient{vclient}\n}\n</code></pre>\n\n<p>...but I having trouble using interfaces to properly abstract the nested structures in the govmomi library.  I know the above will not work as <code>govmomi.LicenseManager()</code> returns a structure of type <code>govmomi.LicenseManager</code> and my <code>VCenterClientInterface.LicenseManager()</code> method returns an interface of type <code>LicenseManager</code>.  However, I'm struggling to find an alternative.</p>\n\n<p>Any help on a better design pattern or proper use of interfaces in this case would be much appreciated.</p>\n"}, {"tags": ["web", "go", "middleware"], "answers": [{"comments": [{"owner": {"reputation": 935, "user_id": 7594, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a64e06ddc713b9c2c9f96ca89d0f4f96?s=128&d=identicon&r=PG", "display_name": "Tharsan", "link": "https://stackoverflow.com/users/7594/tharsan"}, "edited": false, "score": 0, "creation_date": 1428897172, "post_id": 28433386, "comment_id": 47341796, "body": "However you don&#39;t have access to the <code>httprouter.Params</code> object in your handler functions anymore. Have you found a way to still access those?"}, {"owner": {"reputation": 409, "user_id": 1691675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8c70db782338e2396c9e407a8e3a8c45?s=128&d=identicon&r=PG", "display_name": "Larry Price", "link": "https://stackoverflow.com/users/1691675/larry-price"}, "reply_to_user": {"reputation": 935, "user_id": 7594, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a64e06ddc713b9c2c9f96ca89d0f4f96?s=128&d=identicon&r=PG", "display_name": "Tharsan", "link": "https://stackoverflow.com/users/7594/tharsan"}, "edited": false, "score": 0, "creation_date": 1429275073, "post_id": 28433386, "comment_id": 47535263, "body": "@Tharsan - Unfortunately, I was never able to get access to the <code>httprouter.Params</code>. My current workaround is to parse the information I need from the URL, which is kind of terrible but functional."}], "tags": [], "owner": {"reputation": 409, "user_id": 1691675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8c70db782338e2396c9e407a8e3a8c45?s=128&d=identicon&r=PG", "display_name": "Larry Price", "link": "https://stackoverflow.com/users/1691675/larry-price"}, "is_accepted": true, "score": 4, "last_activity_date": 1423576441, "creation_date": 1423576441, "answer_id": 28433386, "question_id": 28418168, "link": "https://stackoverflow.com/questions/28418168/route-specific-middlewares-with-negroni/28433386#28433386", "title": "Route-specific Middlewares with Negroni", "body": "<p>I was eventually able to wrap my brain around this process. The solution is to create new negroni.Negroni instances for each individual route. In the case above:</p>\n\n<pre><code>router := httprouter.New()\nrouter.Handler(\"GET\", \"/login\",\n               negroni.New(negroni.HandlerFunc(loginHandler)))\nrouter.Handler(\"GET\", \"/\",\n               negroni.New(authenticator.Get(),\n               negroni.HandlerFunc(indexHandler)))\n\nserver := negroni.Classic()\nserver.UseHandler(router)\nserver.Use(sessions.Sessions(\"example-web-dev\",\n           cookiestore.New([]byte(\"some secret\"))))\nserver.Run(\":3000\")\n</code></pre>\n\n<p><code>loginHandler</code> and <code>indexHandler</code> will both need to have this method signature:</p>\n\n<pre><code>func(http.ResponseWriter, *http.Request, http.HandlerFunc)\n</code></pre>\n\n<p>With the given example, all routes will utilize the middleware provided by <code>negroni.Classic()</code> and the <code>sessions</code> middleware added to <code>server</code>, but only <code>/</code> will use the middleware I created in <code>authenticator.Get()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6611033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c21fe05143b7c736fbdf409a114f462?s=128&d=identicon&r=PG&f=1", "display_name": "Unni", "link": "https://stackoverflow.com/users/6611033/unni"}, "is_accepted": false, "score": -1, "last_activity_date": 1469202182, "creation_date": 1469202182, "answer_id": 38530538, "question_id": 28418168, "link": "https://stackoverflow.com/questions/28418168/route-specific-middlewares-with-negroni/38530538#38530538", "title": "Route-specific Middlewares with Negroni", "body": "<p>if using httprouter, params can be retrieved by calling the router.Lookup function. Here is what I did:</p>\n\n<p>_, params, _ :=  router.Lookup(\"GET\", req.URL.Path)\nwhere router is an instance of httprouter.Router</p>\n"}], "owner": {"reputation": 409, "user_id": 1691675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8c70db782338e2396c9e407a8e3a8c45?s=128&d=identicon&r=PG", "display_name": "Larry Price", "link": "https://stackoverflow.com/users/1691675/larry-price"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1923, "favorite_count": 0, "accepted_answer_id": 28433386, "answer_count": 2, "score": 4, "last_activity_date": 1469202182, "creation_date": 1423511745, "question_id": 28418168, "link": "https://stackoverflow.com/questions/28418168/route-specific-middlewares-with-negroni", "title": "Route-specific Middlewares with Negroni", "body": "<p>I have a web server using httprouter and negroni. Users log into this system through external OAuth. We save the token to the encrypted session which indicates whether or not they are logged in. I would like to use a middleware to verify whether or not this token exists, and then kick the user back to the login page if it does not. I want to exclude some routes from using the authentication middleware. There is an example in the negroni README of doing this with gorilla mux, but I can't quite get my head around doing this scalably with httprouter. Something similar to my server setup is below:</p>\n\n<pre><code>router := httprouter.New()\nrouter.GET(\"/login\", Login) // auth not required\nrouter.GET(\"/\", Index)  // auth required\n\ns := negroni.Classic()\n\ns.Use(sessions.Sessions(\"example-web-dev\", cookiestore.New([]byte(\"some garbage\"))))\ns.Use(authenticator.Get())\ns.UseHandler(router)\n</code></pre>\n\n<p>Where <code>/login</code> is a route I do not want to require authorization through the middleware and <code>/</code> is. <code>authenticator.Get()</code> is my authentication handler func with contents I don't think are relevant to the question.</p>\n\n<p>How can I apply <code>authenticator.Get()</code> to <code>/</code> but not <code>/login</code>? Keeping in mind that there will be several other \"public\" routes alongside <code>/login</code> and many other gated routes as well.</p>\n\n<p>Some links:</p>\n\n<ul>\n<li><a href=\"https://github.com/codegangsta/negroni\" rel=\"noreferrer\">https://github.com/codegangsta/negroni</a></li>\n<li><a href=\"https://github.com/codegangsta/negroni/issues/25\" rel=\"noreferrer\">https://github.com/codegangsta/negroni/issues/25</a></li>\n<li><a href=\"http://godoc.org/github.com/codegangsta/negroni\" rel=\"noreferrer\">http://godoc.org/github.com/codegangsta/negroni</a></li>\n<li><a href=\"http://godoc.org/github.com/julienschmidt/httprouter\" rel=\"noreferrer\">http://godoc.org/github.com/julienschmidt/httprouter</a></li>\n</ul>\n"}, {"tags": ["go", "bluetooth", "raspberry-pi", "raspbian", "cgo"], "comments": [{"owner": {"reputation": 593, "user_id": 3380763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8083eb4cd5c69b1b1e9305bf2495d76?s=128&d=identicon&r=PG", "display_name": "yograterol", "link": "https://stackoverflow.com/users/3380763/yograterol"}, "edited": false, "score": 0, "creation_date": 1423508813, "post_id": 28416900, "comment_id": 45167807, "body": "Do you try compile in a raspberry pi?"}, {"owner": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "edited": false, "score": 1, "creation_date": 1423509998, "post_id": 28416900, "comment_id": 45168501, "body": "&quot;Trying to build the binary on the Pi itself works, however, I want to cross-compile this.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 2014394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e86ab7b4de578cbdf05b3de56cb65718?s=128&d=identicon&r=PG&f=1", "display_name": "Hadi Kocabas", "link": "https://stackoverflow.com/users/2014394/hadi-kocabas"}, "edited": false, "score": 1, "creation_date": 1453761159, "post_id": 28857861, "comment_id": 57735484, "body": "Did you ever get this to work? I am currently in the situation where cross compilation would make things significantly easier as the go project I am trying to build is too much for the Pi&#39;s RAM to handle apparently. I&#39;m using pretty much the same toolchain and environment variables as you and getting segmentation faults, too. My last resort would be increasing swap size on the Pi, but I&#39;d like to avoid that if possible. Thanks!"}, {"owner": {"reputation": 13363, "user_id": 252239, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/f2ada894473b5170440f31412c6a84ec?s=128&d=identicon&r=PG", "display_name": "Attila O.", "link": "https://stackoverflow.com/users/252239/attila-o"}, "reply_to_user": {"reputation": 429, "user_id": 2014394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e86ab7b4de578cbdf05b3de56cb65718?s=128&d=identicon&r=PG&f=1", "display_name": "Hadi Kocabas", "link": "https://stackoverflow.com/users/2014394/hadi-kocabas"}, "edited": false, "score": 1, "creation_date": 1453761382, "post_id": 28857861, "comment_id": 57735570, "body": "No, unfortunately I didn&#39;t get it to work. In the end I switched to the ARMv7 versions that seem to work. I used the ODROID-C but the Pi 2 should also work. Too bad I still have to compile on the device for my old Pi B+."}, {"owner": {"reputation": 429, "user_id": 2014394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e86ab7b4de578cbdf05b3de56cb65718?s=128&d=identicon&r=PG&f=1", "display_name": "Hadi Kocabas", "link": "https://stackoverflow.com/users/2014394/hadi-kocabas"}, "edited": false, "score": 0, "creation_date": 1453914416, "post_id": 28857861, "comment_id": 57811465, "body": "That&#39;s a bummer. I guess I am going to try compiling it on my Pi B+ again with increased swap size. Thank you for the reply!"}], "tags": [], "owner": {"reputation": 13363, "user_id": 252239, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/f2ada894473b5170440f31412c6a84ec?s=128&d=identicon&r=PG", "display_name": "Attila O.", "link": "https://stackoverflow.com/users/252239/attila-o"}, "is_accepted": true, "score": 0, "last_activity_date": 1425481798, "creation_date": 1425481798, "answer_id": 28857861, "question_id": 28416900, "link": "https://stackoverflow.com/questions/28416900/why-wont-my-cross-compiled-cgo-binary-run-on-the-raspberry-pi-raspbian/28857861#28857861", "title": "Why won&#39;t my cross-compiled CGO binary run on the Raspberry Pi (Raspbian)?", "body": "<p>So let me answer my own question by concluding, after weeks of trial and error, that\u2026</p>\n\n<h1>\u2026it just doesn't work.</h1>\n\n<p>As a last resort, I tried taking the very same Raspbian image that I used to compile the above code, and <strong>running it with <a href=\"http://www.qemu.org\" rel=\"nofollow\">QEMU</a></strong>. And guess what: I get a segfault. The very same instructions, using the very same image, gives me a working executable when I run it on the Pi, and a segfault when I emulate the Pi or try to cross-compile it in any way.</p>\n\n<p>In the end, it is just not worth the hassle. We just set up dedicated Pi that builds our project and the \"production\" Pis just pull the updated binary.</p>\n"}], "owner": {"reputation": 13363, "user_id": 252239, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/f2ada894473b5170440f31412c6a84ec?s=128&d=identicon&r=PG", "display_name": "Attila O.", "link": "https://stackoverflow.com/users/252239/attila-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1878, "favorite_count": 3, "accepted_answer_id": 28857861, "answer_count": 1, "score": 7, "last_activity_date": 1425481798, "creation_date": 1423507114, "last_edit_date": 1423584513, "question_id": 28416900, "link": "https://stackoverflow.com/questions/28416900/why-wont-my-cross-compiled-cgo-binary-run-on-the-raspberry-pi-raspbian", "title": "Why won&#39;t my cross-compiled CGO binary run on the Raspberry Pi (Raspbian)?", "body": "<p>When I compile the following snippet of code (<a href=\"http://play.golang.org/p/wHb5Mtco2I\" rel=\"noreferrer\">playground link</a>):</p>\n\n<pre><code>package main\n\n/*\n#cgo LDFLAGS: -lbluetooth\n\n#include &lt;bluetooth/bluetooth.h&gt;\n#include &lt;bluetooth/hci.h&gt;\n#include &lt;bluetooth/hci_lib.h&gt;\n*/\nimport \"C\"\n\nfunc main() {\n        C.hci_get_route(nil)\n}\n</code></pre>\n\n<p>\u2026using these environment variables:</p>\n\n<pre><code>CC=arm-linux-gnueabihf-gcc\nCGO_ENABLED=1\nGOARCH=arm\nGOARM=6\n</code></pre>\n\n<p>I get a 1.6Mb binary that:</p>\n\n<ul>\n<li>works on my ODROID-C1 (ARMv7, running Arch, from archlinuxarm.org), but</li>\n<li>does not work on my Raspberry Pi B+ (ARMv6, running Raspbian, from raspberrypi.org).</li>\n</ul>\n\n<p>When I run it on the Pi, I get a \"<code>Segmentation fault</code>\".</p>\n\n<p>When I run it with these environment variables:</p>\n\n<pre><code>LD_PRELOAD=/lib/arm-linux-gnueabihf/libSegFault.so\nSEGFAULT_USE_ALTSTACK=1\n</code></pre>\n\n<p>I get this output:</p>\n\n<pre><code>*** Segmentation fault\nRegister dump:\n R0: 00000000   R1: 00000001   R2: bebf37f4   R3: bebf37fc\n R4: 00000000   R5: 00000000   R6: 00010c59   R7: 00000000\n R8: 00000000   R9: 00000000   SL: b6f33000   FP: 00000000\n IP: 0000004f   SP: bebf37ec   LR: 00010c6b   PC: 0005d7f4\n CPSR: 40000030\n Trap: 0000000e   Error: 00000817   OldMask: 00000000\n Addr: 00000001\nBacktrace:\nMemory map:\n00010000-00125000 r-xp 00000000 b3:02 16193      /home/pi/test\n00135000-0013b000 rw-p 00115000 b3:02 16193      /home/pi/test\n0013b000-0014a000 rw-p 00000000 00:00 0 \n0026b000-00290000 rw-p 00000000 00:00 0          [heap]\nb6d53000-b6d73000 r-xp 00000000 b3:02 16080      /lib/arm-linux-gnueabihf/libgcc_s.so.1\nb6d73000-b6d7a000 ---p 00020000 b3:02 16080      /lib/arm-linux-gnueabihf/libgcc_s.so.1\nb6d7a000-b6d7b000 rw-p 0001f000 b3:02 16080      /lib/arm-linux-gnueabihf/libgcc_s.so.1\nb6d7b000-b6e9f000 r-xp 00000000 b3:02 4254       /lib/arm-linux-gnueabihf/libc-2.13.so\nb6e9f000-b6ea6000 ---p 00124000 b3:02 4254       /lib/arm-linux-gnueabihf/libc-2.13.so\nb6ea6000-b6ea8000 r--p 00123000 b3:02 4254       /lib/arm-linux-gnueabihf/libc-2.13.so\nb6ea8000-b6ea9000 rw-p 00125000 b3:02 4254       /lib/arm-linux-gnueabihf/libc-2.13.so\nb6ea9000-b6eac000 rw-p 00000000 00:00 0 \nb6eac000-b6ec0000 r-xp 00000000 b3:02 4247       /lib/arm-linux-gnueabihf/libpthread-2.13.so\nb6ec0000-b6ec7000 ---p 00014000 b3:02 4247       /lib/arm-linux-gnueabihf/libpthread-2.13.so\nb6ec7000-b6ec8000 r--p 00013000 b3:02 4247       /lib/arm-linux-gnueabihf/libpthread-2.13.so\nb6ec8000-b6ec9000 rw-p 00014000 b3:02 4247       /lib/arm-linux-gnueabihf/libpthread-2.13.so\nb6ec9000-b6ecb000 rw-p 00000000 00:00 0 \nb6ecb000-b6ee0000 r-xp 00000000 b3:02 44311      /usr/lib/arm-linux-gnueabihf/libbluetooth.so.3.12.0\nb6ee0000-b6ee7000 ---p 00015000 b3:02 44311      /usr/lib/arm-linux-gnueabihf/libbluetooth.so.3.12.0\nb6ee7000-b6ee8000 r--p 00014000 b3:02 44311      /usr/lib/arm-linux-gnueabihf/libbluetooth.so.3.12.0\nb6ee8000-b6eea000 rw-p 00015000 b3:02 44311      /usr/lib/arm-linux-gnueabihf/libbluetooth.so.3.12.0\nb6ef8000-b6efa000 r-xp 00000000 b3:02 25761      /usr/lib/arm-linux-gnueabihf/libcofi_rpi.so\nb6efa000-b6f01000 ---p 00002000 b3:02 25761      /usr/lib/arm-linux-gnueabihf/libcofi_rpi.so\nb6f01000-b6f02000 rw-p 00001000 b3:02 25761      /usr/lib/arm-linux-gnueabihf/libcofi_rpi.so\nb6f02000-b6f04000 r-xp 00000000 b3:02 4246       /lib/arm-linux-gnueabihf/libSegFault.so\nb6f04000-b6f0b000 ---p 00002000 b3:02 4246       /lib/arm-linux-gnueabihf/libSegFault.so\nb6f0b000-b6f0c000 r--p 00001000 b3:02 4246       /lib/arm-linux-gnueabihf/libSegFault.so\nb6f0c000-b6f0d000 rw-p 00002000 b3:02 4246       /lib/arm-linux-gnueabihf/libSegFault.so\nb6f0d000-b6f2a000 r-xp 00000000 b3:02 4248       /lib/arm-linux-gnueabihf/ld-2.13.so\nb6f2e000-b6f32000 rw-p 00000000 00:00 0 \nb6f32000-b6f33000 r--p 0001d000 b3:02 4248       /lib/arm-linux-gnueabihf/ld-2.13.so\nb6f33000-b6f34000 rw-p 0001e000 b3:02 4248       /lib/arm-linux-gnueabihf/ld-2.13.so\nbebd3000-bebf4000 rw-p 00000000 00:00 0 \nbee7f000-bee80000 r-xp 00000000 00:00 0          [sigpage]\nffff0000-ffff1000 r-xp 00000000 00:00 0          [vectors]\nSegmentation fault\n</code></pre>\n\n<p>Removing <code>/usr/lib/arm-linux-gnueabihf/libcofi_rpi.so</code> from <code>/etc/ld.so.preload</code> gives me the same output, except with no lines containing <code>libcofi_rpi.so</code>.</p>\n\n<p>Trying to build a statically linked binary with <code>-tags netgo -a -ldflags \"-linkmode external -extldflags -static\"</code> gives me an \"<code>Illegal instruction</code>\" instead of the \"<code>Segmentation fault</code>\".</p>\n\n<p>Trying to build the binary on the Pi itself works, however, I want to cross-compile this. And cross compilation works indeed, but only on the ODROID-C1/Arch, not on the Raspberry Pi/Raspbian.</p>\n\n<p>The exact build steps I use can be reproduced using Docker:</p>\n\n<pre><code>$ docker run -it golang:1.4.1-cross bash\n</code></pre>\n\n<p>Inside docker, I run:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>echo \"deb http://emdebian.org/tools/debian/ jessie main\" &gt;/etc/apt/sources.list.d/crosstools.list\ncurl -s http://emdebian.org/tools/debian/emdebian-toolchain-archive.key | apt-key add -\ndpkg --add-architecture armhf\napt-get update\napt-get install -y crossbuild-essential-armhf libbluetooth-dev:armhf\nexport CC=arm-linux-gnueabihf-gcc\nexport CGO_ENABLED=1\nexport GOARCH=arm\nexport GOARM=6\ngo build -o test test.go\n</code></pre>\n\n<p>This gives me an executable named \"test\" that, as noted above, will not run on the Pi.</p>\n\n<p>Here's some info about my test devices:</p>\n\n<h3>Raspberry Pi B+:</h3>\n\n<pre><code>$ uname -a\nLinux raspberrypi 3.18.5+ #744 PREEMPT Fri Jan 30 18:19:07 GMT 2015 armv6l GNU/Linux\n\n$ cat /proc/cpuinfo\nprocessor       : 0\nmodel name      : ARMv6-compatible processor rev 7 (v6l)\nBogoMIPS        : 2.00\nFeatures        : half thumb fastmult vfp edsp java tls \nCPU implementer : 0x41\nCPU architecture: 7\nCPU variant     : 0x0\nCPU part        : 0xb76\nCPU revision    : 7\nHardware        : BCM2708\nRevision        : 0010\nSerial          : 000000002a69d702\n\n$ ldd test\n        /usr/lib/arm-linux-gnueabihf/libcofi_rpi.so (0xb6f01000)\n        libbluetooth.so.3 =&gt; /usr/lib/arm-linux-gnueabihf/libbluetooth.so.3 (0xb6ed4000)\n        libpthread.so.0 =&gt; /lib/arm-linux-gnueabihf/libpthread.so.0 (0xb6eb5000)\n        libc.so.6 =&gt; /lib/arm-linux-gnueabihf/libc.so.6 (0xb6d84000)\n        /lib/ld-linux-armhf.so.3 (0xb6f0e000) \n</code></pre>\n\n<p><strong>Installed Bluetooth libraries:</strong></p>\n\n<pre><code>$ dpkg -s libbluetooth3\n\nPackage: libbluetooth3\nStatus: install ok installed\nPriority: optional\nSection: libs\nInstalled-Size: 172\nMaintainer: Debian Bluetooth Maintainers &lt;pkg-bluetooth-maintainers@lists.alioth.debian.org&gt;\nArchitecture: armhf\nMulti-Arch: same\nSource: bluez\nVersion: 4.99-2\nReplaces: libsdp2 (&lt;= 1.5-2)\nDepends: libc6 (&gt;= 2.13-28)\nPre-Depends: multiarch-support\nConflicts: libsdp2 (&lt;= 1.5-2)\nDescription: Library to use the BlueZ Linux Bluetooth stack\n BlueZ is the official Linux Bluetooth protocol stack. It is an Open Source\n project distributed under GNU General Public License (GPL).\nHomepage: http://www.bluez.org\n</code></pre>\n\n<h3>ODROID-C1:</h3>\n\n<pre><code>$ uname -a\nLinux alarm 3.10.66-1-ARCH #1 SMP PREEMPT Wed Jan 28 18:12:35 MST 2015 armv7l GNU/Linux\n\n$ cat /proc/cpuinfo\nProcessor       : ARMv7 Processor rev 1 (v7l)\nprocessor       : 0\nBogoMIPS        : 3.27\n\nprocessor       : 1\nBogoMIPS        : 3.27\n\nprocessor       : 2\nBogoMIPS        : 3.27\n\nprocessor       : 3\nBogoMIPS        : 3.27\n\nFeatures        : swp half thumb fastmult vfp edsp neon vfpv3 tls vfpv4 \nCPU implementer : 0x41\nCPU architecture: 7\nCPU variant     : 0x0\nCPU part        : 0xc05\nCPU revision    : 1\n\nHardware        : ODROIDC\nRevision        : 000a\nSerial          : 1b00000000000000\n\n$ ldd test\n       libbluetooth.so.3 =&gt; /usr/lib/libbluetooth.so.3 (0xb6eaf000)\n       libpthread.so.0 =&gt; /usr/lib/libpthread.so.0 (0xb6e87000)\n       libc.so.6 =&gt; /usr/lib/libc.so.6 (0xb6d48000)\n       /lib/ld-linux-armhf.so.3 (0xb6ed1000)\n</code></pre>\n\n<p><strong>Installed Bluetooth libraries &amp; development headers files:</strong></p>\n\n<pre><code>$ pacman -Qe bluez\nbluez 5.27-1\n</code></pre>\n\n<h3>Docker build environment</h3>\n\n<pre><code>$ uname -a\nLinux 094aa2ed34a5 3.18.5-gentoo-tp #1 SMP Fri Feb 6 20:14:55 CET 2015 x86_64 GNU/Linux\n</code></pre>\n\n<p><strong>Installed Bluetooth development headers:</strong></p>\n\n<pre><code>$ dpkg -s libbluetooth-dev:armhf\nPackage: libbluetooth-dev\nStatus: install ok installed\nPriority: extra\nSection: libdevel\nInstalled-Size: 429\nMaintainer: Debian Bluetooth Maintainers &lt;pkg-bluetooth-maintainers@lists.alioth.debian.org&gt;\nArchitecture: armhf\nSource: bluez (5.23-2)\nVersion: 5.23-2+b1\nReplaces: libsdp2-dev (&lt;= 1.5.2)\nProvides: libbluetooth3-dev\nDepends: libbluetooth3 (= 5.23-2+b1), libc6-dev | libc-dev\nSuggests: pkg-config\nConflicts: bluez-pan, libbluetooth-dev, libsdp2-dev (&lt;= 1.5.2)\nDescription: Development files for using the BlueZ Linux Bluetooth library\n BlueZ is the official Linux Bluetooth protocol stack. It is an Open Source\n project distributed under GNU General Public License (GPL).\nHomepage: http://www.bluez.org\n</code></pre>\n\n<hr>\n\n<p>Installing the exact same version of <code>libbluetooth-dev</code> in the Docker container as the one that is available on the Pi makes no difference.</p>\n\n<hr>\n\n<p>Copying over the newer <code>libbluetooth.so</code> from Jessie to Wheezie gives me this error:</p>\n\n<pre><code>./test: /lib/arm-linux-gnueabihf/libc.so.6: version `GLIBC_2.15' not found (required by /home/pi/libbluetooth.so.3.17.11)\n</code></pre>\n\n<hr>\n\n<h3>UPDATE:</h3>\n\n<p>Tried with Arch on the Pi, the cross compiled binary also segfaults, giving the same message (\"<code>Illegal instruction (core dumped)</code>\") with <code>GOARM=5</code>, <code>6</code> or <code>7</code>.</p>\n\n<p>So far I haven't found a way to cross-compile CGO code for the Pi, linked against <code>libbluetooth</code>.</p>\n\n<p>Will try with the Raspberry Pi 2 tomorrow.</p>\n"}, {"tags": ["exception", "error-handling", "exception-handling", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1423493990, "creation_date": 1423493990, "answer_id": 28412693, "question_id": 28412630, "link": "https://stackoverflow.com/questions/28412630/errors-are-values-blog-is-logically-same/28412693#28412693", "title": "Errors are values (blog) - is logically same?", "body": "<p>No, they are the same. If an <code>error</code> occurs at <code>fd.Write(p0[a:b])</code>, the <code>err</code> variable will hold its value.</p>\n\n<p>Now if you call <code>write(p1[c:d])</code>, then the <code>write()</code> func will first check if <code>err != nil</code> but since it already stores the <code>error</code> which occured in the previous call, it will return immediately and will not execute further code.</p>\n"}, {"comments": [{"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 0, "creation_date": 1432759791, "post_id": 28412715, "comment_id": 49063483, "body": "Both versions are not strictly equivalent regarding the operations being executed, since the original version uses an early return in case of error whereas second one checks for nil as many times as the write closure is called."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1423494038, "creation_date": 1423494038, "answer_id": 28412715, "question_id": 28412630, "link": "https://stackoverflow.com/questions/28412630/errors-are-values-blog-is-logically-same/28412715#28412715", "title": "Errors are values (blog) - is logically same?", "body": "<p>a) Yes, you are correct. If the error occures in the first write, it will return.</p>\n\n<p>b) No. The <code>write</code> in this example is a <a href=\"https://en.wikipedia.org/wiki/Closure_%28computer_programming%29\" rel=\"nofollow\">closure</a>. The <code>err</code> inside of it is the same as in the outer scope. So if the first write fails, the other will simply return, because the outer <code>err</code> is not <code>nil</code> anymore.</p>\n"}], "owner": {"reputation": 7376, "user_id": 2171928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a2dc8a6d4e15c61451d70f695ac18ae9?s=128&d=identicon&r=PG", "display_name": "Kishore Vaishnav", "link": "https://stackoverflow.com/users/2171928/kishore-vaishnav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 1, "accepted_answer_id": 28412715, "answer_count": 2, "score": 3, "last_activity_date": 1423494038, "creation_date": 1423493815, "question_id": 28412630, "link": "https://stackoverflow.com/questions/28412630/errors-are-values-blog-is-logically-same", "title": "Errors are values (blog) - is logically same?", "body": "<p>I just read the <a href=\"https://blog.golang.org/errors-are-values\" rel=\"nofollow\">blog</a> written by Rob Pike. I have a small question regarding this and may be I can be wrong too but would still like to get feedback and understand properly the Go.</p>\n\n<p>In the blog there was a snippet code (which actually was written by @jxck_)</p>\n\n<pre><code>_, err = fd.Write(p0[a:b])\nif err != nil {\n    return err\n}\n_, err = fd.Write(p1[c:d])\nif err != nil {\n    return err\n}\n_, err = fd.Write(p2[e:f])\nif err != nil {\n    return err\n}\n// and so on\n</code></pre>\n\n<p>a) As per my understanding the above code will return if error occurred at <code>fd.Write(p0[a:b])</code>, and will never execute <code>fd.Write(p1[c:d])</code> , right?</p>\n\n<p>And Rob suggested to write something like this</p>\n\n<pre><code>var err error\nwrite := func(buf []byte) {\n    if err != nil {\n        return\n    }\n    _, err = w.Write(buf)\n}\nwrite(p0[a:b])\nwrite(p1[c:d])\nwrite(p2[e:f])\n// and so on\nif err != nil {\n    return err\n}\n</code></pre>\n\n<p>b) Based on the above, looks like the error will return from the sub function. So this means if the error occurs at <code>write(p0[a:b])</code> then still it will execute <code>write(p1[c:d])</code>, right? So this means logically both are not same, right?</p>\n\n<p>Anybody explain.</p>\n"}, {"tags": ["java", "json", "go", "linkedin"], "answers": [{"comments": [{"owner": {"reputation": 3428, "user_id": 1326678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65c3940a1d07cf46f3c68e029c7deca2?s=128&d=identicon&r=PG", "display_name": "TruongSinh", "link": "https://stackoverflow.com/users/1326678/truongsinh"}, "edited": false, "score": 0, "creation_date": 1423493938, "post_id": 28412510, "comment_id": 45158626, "body": "Thank you, you are right &quot;we are not using it correctly&quot;"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 3428, "user_id": 1326678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65c3940a1d07cf46f3c68e029c7deca2?s=128&d=identicon&r=PG", "display_name": "TruongSinh", "link": "https://stackoverflow.com/users/1326678/truongsinh"}, "edited": false, "score": 0, "creation_date": 1423494588, "post_id": 28412510, "comment_id": 45159062, "body": "@TruongSinh I think you should write an update about what went wrong in your code so that other people facing similar problems could find a solution."}], "tags": [], "owner": {"reputation": 628808, "user_id": 139985, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=128&d=identicon&r=PG", "display_name": "Stephen C", "link": "https://stackoverflow.com/users/139985/stephen-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1423494089, "last_edit_date": 1423494089, "creation_date": 1423493420, "answer_id": 28412510, "question_id": 28412257, "link": "https://stackoverflow.com/questions/28412257/how-can-we-prepare-valid-json-from-linkedin-share-api/28412510#28412510", "title": "How can we prepare &quot;valid JSON&quot; from Linkedin Share API", "body": "<p>JSON can cope with Unicode characters ... provided that they are properly encoded.</p>\n\n<p>However the error message says:</p>\n\n<pre><code>Illegal unquoted character ((CTRL-CHAR, code 10))\n</code></pre>\n\n<p>which seems to be saying that you have a control character in the JSON.  The JSON syntax states that unescaped control characters are not permitted in strings.</p>\n\n<p>Now if we assume that 10 is decimal, then it is a newline character.  So I would look for a raw newline within the JSON about 187 characters from the start.</p>\n\n<hr>\n\n<blockquote>\n  <p>My question now is that why doesn't Go built-in JSON marshaller handle that.</p>\n</blockquote>\n\n<p>Two possibilities:</p>\n\n<ul>\n<li>it is a bug, or</li>\n<li>you are not using it correctly.</li>\n</ul>\n"}], "owner": {"reputation": 3428, "user_id": 1326678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65c3940a1d07cf46f3c68e029c7deca2?s=128&d=identicon&r=PG", "display_name": "TruongSinh", "link": "https://stackoverflow.com/users/1326678/truongsinh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 0, "accepted_answer_id": 28412510, "answer_count": 1, "score": 2, "last_activity_date": 1457947951, "creation_date": 1423492760, "last_edit_date": 1457947951, "question_id": 28412257, "link": "https://stackoverflow.com/questions/28412257/how-can-we-prepare-valid-json-from-linkedin-share-api", "title": "How can we prepare &quot;valid JSON&quot; from Linkedin Share API", "body": "<p>Recently, from our log, we saw this:</p>\n\n<pre><code>httpRes status received 400 Bad Request for this linkedinToken AQUz3sCODu312rHNtNfuns3awy0xoUxxxxxxxxxxx.\n With Request: {\"content\":{\"submitted-url\":\"http://mpg.smh.re/2Ra\",\"title\":\"Gestionnaire sinistre H/F \u2212 Belgique\u00a0\",\"description\":\"Responsable de la gestion de dossiers sinistres dans leur int\u00e9gralit\u00e9,\n vous serez en contact avec de nombreux interlocuteurs (compagnies \nd\u2019assurances, clients et bureaux locaux).\",\"submitted-image-url\":\"http://www.morganphilipsexecutivesearch.com/wp-content/uploads/2014/09/fyte-smarpshare.jpg\"},\"visibility\":{\"code\":\"anyone\"},\"comment\":\"FYTE, cabinet de recrutement sp\u00e9cialis\u00e9 recrute pour l\u2019un de ses clients situ\u00e9 en Belgique un Gestionnaire sinistre H/F.\"}.\n Response body: {\n  \"errorCode\": 0,\n  \"message\": \"Couldn&amp;#39;t parse Json body: Illegal unquoted character ((CTRL-CHAR, code 10)): has to be escaped using backslash to be included in string value\\n at [Source: java.io.StringReader@42ea5bc1; line: 1, column: 187]\",\n  \"requestId\": \"0GYQWP14U9\",\n  \"status\": 400,\n  \"timestamp\": 1423490252325\n}\n</code></pre>\n\n<p>```</p>\n\n<p>LinkedIn API said that it couldn't parse JSON body. Our doubt is that either character \"\u00e9\" or \"\u2019\" is not handled by JAVA JSON parser.</p>\n\n<p>My question is that is there any other special/unicode characters that we should be aware of? Because this JSON body was marshaled by Go's built-in.</p>\n\n<p>UPDATE: I recently discovered that \"line feed\" (\"CTRL-CHAR, code 10\") is the key to this issue. \"Line feed\" character appears after \"...leur int\u00e9gralit\u00e9,\". My question now is that why doesn't Go built-in JSON marshaller handle that</p>\n"}, {"tags": ["json", "go", "struct"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1423491547, "post_id": 28411394, "comment_id": 45157152, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/15452004/my-structures-are-not-marshalling-into-json\">My structures are not marshalling into json</a>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 9, "last_activity_date": 1423490790, "creation_date": 1423490790, "answer_id": 28411623, "question_id": 28411394, "link": "https://stackoverflow.com/questions/28411394/golang-and-json-with-array-of-struct/28411623#28411623", "title": "Golang and JSON with array of struct", "body": "<p>The <a href=\"http://golang.org/pkg/encoding/json/\" rel=\"noreferrer\"><code>json</code></a> package can only serialize exported fields of your struct. Change your struct to start all fields with an uppercase letter so they can be included in the output:</p>\n\n<pre><code>type SpanInfo struct {\n    Imsi string\n    Network string\n    Network_status string\n    Signal_quality int\n    Slot int\n    State string\n}\n</code></pre>\n\n<p>Read the documentation of <a href=\"http://golang.org/pkg/encoding/json/#Marshal\" rel=\"noreferrer\"><code>json.Marshal()</code></a> for details and more information.</p>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 7554925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4Xxz.png?s=128&g=1", "display_name": "V\u011bro\u0161 K.", "link": "https://stackoverflow.com/users/7554925/v%c4%9bro%c5%a1-k"}, "edited": false, "score": 2, "creation_date": 1500978676, "post_id": 28411626, "comment_id": 77562638, "body": "While code this answer works, Arjan should probably note that the fields&#39; names should start in upper case. (see icza answer below),"}, {"owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "reply_to_user": {"reputation": 103, "user_id": 7554925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4Xxz.png?s=128&g=1", "display_name": "V\u011bro\u0161 K.", "link": "https://stackoverflow.com/users/7554925/v%c4%9bro%c5%a1-k"}, "edited": false, "score": 0, "creation_date": 1501001747, "post_id": 28411626, "comment_id": 77580867, "body": "@V\u011bro\u0161K.Added clarification"}, {"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "edited": false, "score": 1, "creation_date": 1512032105, "post_id": 28411626, "comment_id": 82096031, "body": "it took me an hour to found this solution. Thanks"}], "tags": [], "owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "is_accepted": true, "score": 39, "last_activity_date": 1501001727, "last_edit_date": 1501001727, "creation_date": 1423490805, "answer_id": 28411626, "question_id": 28411394, "link": "https://stackoverflow.com/questions/28411394/golang-and-json-with-array-of-struct/28411626#28411626", "title": "Golang and JSON with array of struct", "body": "<p>Your struct fields must be exported (field is exported if it begins with a capital letter) or they won't be encoded:</p>\n\n<blockquote>\n  <p>Struct values encode as JSON objects. Each exported struct field\n  becomes a member of the object</p>\n</blockquote>\n\n<p>To get the JSON representation as probably expected change the code to this:</p>\n\n<pre><code>type SpanInfo struct {\n    IMSI string `json:\"imsi\"`\n    Network string `json:\"network\"`\n    NetworkStatus string `json:\"network_status\"`\n    SignalQuality int `json:\"signal_quality\"`\n    Slot int `json:slot\"`\n    State string `json:\"state\"`\n}\n\ntype GatewayInfo []SpanInfo\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8807509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93cfd8c945c06f0027f7f90d38f3f0d4?s=128&d=identicon&r=PG&f=1", "display_name": "Prafulla Girgaonkar", "link": "https://stackoverflow.com/users/8807509/prafulla-girgaonkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1573617364, "creation_date": 1573617364, "answer_id": 58830117, "question_id": 28411394, "link": "https://stackoverflow.com/questions/28411394/golang-and-json-with-array-of-struct/58830117#58830117", "title": "Golang and JSON with array of struct", "body": "<hr>\n\n<blockquote>\n  <p>This is not a new answer. It is just consolidation of comments on the\n  accepted answer.</p>\n</blockquote>\n\n<hr>\n\n<p><strong>From ORIGINAL Query</strong></p>\n\n<pre><code>type SpanInfo struct {\n    imsi string\n    network string\n    network_status string\n    signal_quality int\n    slot int\n    state string\n}\n</code></pre>\n\n<p><strong>From Answer and comments - Please note that the first char of each field in struct is now in UPPER case along with json representation added to each field</strong></p>\n\n<pre><code>type SpanInfo struct {\n    IMSI string `json:\"imsi\"`\n    Network string `json:\"network\"`\n    NetworkStatus string `json:\"network_status\"`\n    SignalQuality int `json:\"signal_quality\"`\n    Slot int `json:slot\"`\n    State string `json:\"state\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 2253, "user_id": 1630586, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/902ef27763348c8d6d6aba56ffdf7304?s=128&d=identicon&r=PG", "display_name": "Julio", "link": "https://stackoverflow.com/users/1630586/julio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30938, "favorite_count": 6, "accepted_answer_id": 28411626, "answer_count": 3, "score": 19, "last_activity_date": 1573617364, "creation_date": 1423490174, "last_edit_date": 1500978846, "question_id": 28411394, "link": "https://stackoverflow.com/questions/28411394/golang-and-json-with-array-of-struct", "title": "Golang and JSON with array of struct", "body": "<p>I would like to create a JSON of a <code>GatewayInfo</code> where the type are defined like this:</p>\n\n<pre><code>type SpanInfo struct {\n    imsi string\n    network string\n    network_status string\n    signal_quality int\n    slot int\n    state string\n}\n\ntype GatewayInfo []SpanInfo\n</code></pre>\n\n<p>The gateway information is created with:</p>\n\n<pre><code>var gatewayInfo = make(GatewayInfo, nb_spans)\n</code></pre>\n\n<p>To create the JSON, I use the <code>json.Marshal</code> function:</p>\n\n<pre><code>gatewayInfo := getGatewayInfo(spans)\nlog.Printf(\"Polling content: %s\\n\", gatewayInfo)\n\njsonInfo, _ := json.Marshal(gatewayInfo)\nlog.Printf(\"jsonInfo: %s\\n\", jsonInfo)\n</code></pre>\n\n<p>Unfortunately the result is not what I was expecting:</p>\n\n<pre><code>2015/02/09 13:48:26 Polling content: [{652020105829193 20801 Registered (Roaming) %!s(int=17) %!s(int=2) } {652020105829194 20801 Registered (Roaming) %!s(int=16) %!s(int=3) } {652020105829192 20801 Registered (Roaming) %!s(int=19) %!s(int=1) } {652020105829197 20801 Registered (Roaming) %!s(int=19) %!s(int=4) }]\n2015/02/09 13:48:26 jsonInfo: [{},{},{},{}]\n</code></pre>\n\n<p>As we can see, the <code>GatewayInfo</code> instance has the <code>SpanInfo</code>, but in the JSON I have empty <code>SpanInfo</code>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1423484563, "post_id": 28409445, "comment_id": 45152872, "body": "I assume you wanted to write <code>type GzipResponseWriter interface {</code> (missing <code>interface</code> keyword)..."}, {"owner": {"reputation": 459, "user_id": 4023435, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/94cbdaee2f17e8bcd9ea8b2046bafb1a?s=128&d=identicon&r=PG&f=1", "display_name": "cosiner", "link": "https://stackoverflow.com/users/4023435/cosiner"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1423484891, "post_id": 28409445, "comment_id": 45153045, "body": "Thanks. It&#39;s a struct."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1423485380, "post_id": 28409445, "comment_id": 45153326, "body": "Well, that changes the picture, I had to rewrite my answer."}], "answers": [{"comments": [{"owner": {"reputation": 459, "user_id": 4023435, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/94cbdaee2f17e8bcd9ea8b2046bafb1a?s=128&d=identicon&r=PG&f=1", "display_name": "cosiner", "link": "https://stackoverflow.com/users/4023435/cosiner"}, "edited": false, "score": 0, "creation_date": 1423485446, "post_id": 28409691, "comment_id": 45153368, "body": "But, if i call <code>Render</code> on a <code>myGzipResponseWriter</code>, which calls <code>Write</code>, the real <code>Write</code> method reciever is still <code>myResonseWriter</code>, rather than <code>myGzipResonseWriter</code>, so <code>GzipWrite</code> will not be called."}, {"owner": {"reputation": 459, "user_id": 4023435, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/94cbdaee2f17e8bcd9ea8b2046bafb1a?s=128&d=identicon&r=PG&f=1", "display_name": "cosiner", "link": "https://stackoverflow.com/users/4023435/cosiner"}, "edited": false, "score": 0, "creation_date": 1423488505, "post_id": 28409691, "comment_id": 45155164, "body": "Sorry, it still isn&#39;t  my wanted, if i want to enable gzip, i must add a method for change <code>out</code> field to <code>MyResponseWriter</code> interface."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1423487899, "last_edit_date": 1423487899, "creation_date": 1423484473, "answer_id": 28409691, "question_id": 28409445, "link": "https://stackoverflow.com/questions/28409445/how-to-implement-method-overwrite-of-an-interface/28409691#28409691", "title": "How to implement method overwrite of an interface", "body": "<p>Add a new field <code>out io.Writer</code> to the <code>myResponseWriter</code>, and also add the <code>io.Write()</code> method which uses this <code>out</code> field:</p>\n\n<pre><code>type myResponseWriter struct {\n    out io.Writer\n    server *Server\n    http.ResponseWriter\n}\n\nfunc (m *myResponseWriter) Write(b []byte) (int, error) {\n    return m.out.Write(b)\n}\n</code></pre>\n\n<p>And by default set the same <code>http.ResponseWriter</code> to the <code>out</code> field too.</p>\n\n<p>And when you want to switch to Gzipped response, simply wrap the <code>out</code> writer  like this:</p>\n\n<pre><code>out = gzip.NewWriter(out)\n</code></pre>\n\n<p>Since <code>myResponseWriter.Write()</code> uses the <code>out</code> field, your <code>Render()</code> method will send its output through the gzip writer.</p>\n"}], "owner": {"reputation": 459, "user_id": 4023435, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/94cbdaee2f17e8bcd9ea8b2046bafb1a?s=128&d=identicon&r=PG&f=1", "display_name": "cosiner", "link": "https://stackoverflow.com/users/4023435/cosiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423671506, "creation_date": 1423483729, "last_edit_date": 1423671506, "question_id": 28409445, "link": "https://stackoverflow.com/questions/28409445/how-to-implement-method-overwrite-of-an-interface", "title": "How to implement method overwrite of an interface", "body": "<p>I wrote a tool which wraps <code>http.ResponseWriter</code> and supplies a new method to render a template.</p>\n\n<pre><code> type MyResponseWriter interface {\n      http.ResponseWriter\n      Render(tmpl string, v interface{}\n }\n type myResponseWriter struct {\n     server *Server\n     http.ResponseWriter\n }\n\n func (rw *myResponseWriter) Render(tmpl string, v interface{}) {\n      rw.server.Render(rw, tmpl, v)\n }\n</code></pre>\n\n<p>Now, I want to override <code>MyResponseWriter</code>'s <code>Write</code> method to enable gzip compression as a pluggable filter without knowing the implementation of <code>MyResponseWriter</code>.</p>\n\n<p>I wrote a <code>GzipResponseWriter</code> here, and it's used as an <code>MyResponseWriter</code>, so it's pluggable:</p>\n\n<pre><code>type GzipResponseWriter struct {\n     MyResponseWriter\n}\n\nfunc (grw *GzipResponseWriter) Write(data []byte) (int, error) {\n      return GzipWrite(grw.MyResponseWriter, data)       \n}\n</code></pre>\n\n<p>But, when I enable <code>GzipResponseWriter</code> then call <code>Render</code>, it still calls the <code>MyResponseWriter</code>'s <code>Write</code>, rather than <code>GzipResponseWriter</code>,\nand the browser show me an \"Content Encoding Error\".</p>\n\n<p>That's all because of when I call <code>Render</code> of a <code>GzipResponseWriter</code>, the real method receiver is still the <code>myResponseWriter</code>, and <code>Render</code> calls <code>myResponseWriter</code>'s <code>Write</code>.</p>\n\n<p>I think it's a common requirement that we make changes on some methods of a interface that libraries/frameworks supplied, then other methods of this interface will call these new methods rather than old methods. In my question, the requirement is gzip compression, but this feature is so difficult to implement in Go.</p>\n\n<p>Is there a solution to implements this proposal?\nThanks.</p>\n"}, {"tags": ["error-handling", "exception-handling", "go"], "comments": [{"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1423499152, "post_id": 28409118, "comment_id": 45162127, "body": "It looks ugly at first (and later on), but I happen to like the kind of error catching. It really makes me think: &quot;what should I do in this case? Should I crash (fatal), should I keep on going with some other method/default or should I ask the user&quot;. If you do a <code>log.Fatalf()</code> anyway, you could define a method <code>CrashIfErr(err error)</code> whith a simple call to <code>log.Fatalf()</code>. BTW: there is no need for a <code>return</code>  after a <code>log.Fatalf()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 937, "user_id": 413094, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e6c5d6b4c67b1c0340da5e0efd4fcd08?s=128&d=identicon&r=PG", "display_name": "Xupypr MV", "link": "https://stackoverflow.com/users/413094/xupypr-mv"}, "edited": false, "score": 2, "creation_date": 1423485582, "post_id": 28409251, "comment_id": 45153442, "body": "I read that before. What if methods that i call returns not only errors but structs of different types?"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 5, "last_activity_date": 1423483094, "creation_date": 1423483094, "answer_id": 28409251, "question_id": 28409118, "link": "https://stackoverflow.com/questions/28409118/more-terse-error-handling-in-go/28409251#28409251", "title": "More terse error handling in Go", "body": "<p>That reminds me of the recent <a href=\"https://blog.golang.org/errors-are-values\" rel=\"noreferrer\">Errors are values</a> by Rob Pike, as well as <a href=\"http://vimeo.com/113825668\" rel=\"noreferrer\">Mr. Rob Pike taught me about practice of error handling in Go at GoCon 2014</a></p>\n\n<blockquote>\n  <p>The key lesson, however, is that errors are values and the full power of the Go programming language is available for processing them. </p>\n  \n  <p>It's worth stressing that whatever the design, it's critical that the program check the errors however they are exposed. The discussion here is not about how to avoid checking errors, it's about using the language to handle errors with grace. </p>\n</blockquote>\n\n<p>One technique was to define an object called an <code>errWriter</code>:</p>\n\n<pre><code>type errWriter struct {\n    w   io.Writer\n    err error\n}\n</code></pre>\n\n<blockquote>\n  <p>The <code>write</code> method calls the Write method of the underlying <code>Writer</code> and records the first error for future reference:</p>\n</blockquote>\n\n<pre><code>func (ew *errWriter) write(buf []byte) {\n    if ew.err != nil {\n        return\n    }\n    _, ew.err = ew.w.Write(buf)\n}\n</code></pre>\n\n<blockquote>\n  <p>As soon as an error occurs, the <code>write</code> method becomes a no-op but the <code>error</code> value is saved.</p>\n  \n  <p>Given the <code>errWriter</code> type and its write method, the code above can be refactored:</p>\n</blockquote>\n\n<pre><code>ew := &amp;errWriter{w: fd}\new.write(p0[a:b])\new.write(p1[c:d])\new.write(p2[e:f])\n// and so on\nif ew.err != nil {\n    return ew.err\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 1, "creation_date": 1423500484, "post_id": 28414717, "comment_id": 45163032, "body": "I like the <code>Mustxxx</code> approach, which can simplify the error management and clarify the expectation. +1"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1423500039, "creation_date": 1423500039, "answer_id": 28414717, "question_id": 28409118, "link": "https://stackoverflow.com/questions/28409118/more-terse-error-handling-in-go/28414717#28414717", "title": "More terse error handling in Go", "body": "<p>If the <code>error</code> is \"real\", you should (have to) handle it if you don't want unexpected panics at runtime.</p>\n\n<p>To supplement VonC's answer about the <code>errWriter</code> technique, there are more cases where you can reduce error handling code:</p>\n\n<p>These are the cases when you know that even though a function or method <em>may</em> return an <code>error</code>, it <em>will not</em> (e.g. you're supplying the parameters from source code which you know will work). In these cases you (or the author of the library) can provide <em>helper</em> functions (or methods) which do not return the <code>error</code> but raise a runtime panic if it still occurs.</p>\n\n<p>Great examples of these are the <a href=\"http://golang.org/pkg/text/template/\" rel=\"nofollow\"><code>template</code></a> and <a href=\"http://golang.org/pkg/regexp/\" rel=\"nofollow\"><code>regexp</code></a> packages: if you provide a valid template or regexp at compile time, you can be sure they can always be parsed without errors at runtime. For this reason the <code>template</code> package provides the <a href=\"http://golang.org/pkg/text/template/#Must\" rel=\"nofollow\"><code>Must(t *Template, err error) *Template</code></a> function and the <code>regexp</code> package provides the <a href=\"http://golang.org/pkg/regexp/#MustCompile\" rel=\"nofollow\"><code>MustCompile(str string) *Regexp</code></a> function: they don't return <code>error</code>s because their intended use is where the input is guaranteed to be valid.</p>\n\n<p>Examples:</p>\n\n<pre><code>// \"text\" is a valid template, parsing it will not fail\nvar t = template.Must(template.New(\"name\").Parse(\"text\"))\n\n// `^[a-z]+\\[[0-9]+\\]$` is a valid regexp, always compiles\nvar validID = regexp.MustCompile(`^[a-z]+\\[[0-9]+\\]$`)\n</code></pre>\n"}], "owner": {"reputation": 937, "user_id": 413094, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e6c5d6b4c67b1c0340da5e0efd4fcd08?s=128&d=identicon&r=PG", "display_name": "Xupypr MV", "link": "https://stackoverflow.com/users/413094/xupypr-mv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1423671747, "creation_date": 1423482654, "last_edit_date": 1423671747, "question_id": 28409118, "link": "https://stackoverflow.com/questions/28409118/more-terse-error-handling-in-go", "title": "More terse error handling in Go", "body": "<p>How do I handle a lot of errors in Go?</p>\n\n<p>I look at my code and find that it is full of error handlers:</p>\n\n<pre><code>err = result.Scan(&amp;bot.BID, &amp;bot.LANGUAGE, &amp;bot.SOURCE)\nif err != nil {\n    log.Fatalf(\"result.Scan: %v\", err)\n    return\n}\n\nfileName, err := copySourceToTemporaryFile(bot)\nif err != nil {\n    log.Fatalf(\"copySourceToTemporaryFile: %v\", err)\n    return\n}\n...\n</code></pre>\n\n<p>And a lot of lines look like:</p>\n\n<pre><code>// do something\n// handle error\n// handle error\n// handle error\n\n// do something 2\n// handle error\n// handle error\n// handle error\n</code></pre>\n\n<p>Can I create a default handler that prints an error and stops processing, or at least move out this \"error-handler-garbage\" out of my code logic?</p>\n"}, {"tags": ["sockets", "go", "udp"], "comments": [{"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 1, "creation_date": 1423497604, "post_id": 28408966, "comment_id": 45161064, "body": "Maybe this can help you <a href=\"http://stackoverflow.com/q/18427655/893693\">stackoverflow.com/q/18427655/893693</a>"}], "owner": {"reputation": 61, "user_id": 1618892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5bac31a48b4bd9f9c85d2606d52dc7a?s=128&d=identicon&r=PG", "display_name": "w32c", "link": "https://stackoverflow.com/users/1618892/w32c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1423482186, "creation_date": 1423482186, "question_id": 28408966, "link": "https://stackoverflow.com/questions/28408966/golang-how-to-change-srcip-with-udp", "title": "Golang how to change srcip with udp", "body": "<p>I want change srcip  My code is:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n    \"os\"\n)\n\nfunc main() {\n    udpAddr, err := net.ResolveUDPAddr(\"udp4\", \"127.0.0.1:1200\")\n    srcudpAddr, err := net.ResolveUDPAddr(\"udp4\", \"127.0.0.2:334\")\n    checkError(err)\n    conn, err := net.DialUDP(\"udp\", srcudpAddr, udpAddr)\n    checkError(err)\n    str := \"###11##22##asdfasdf##adsfadsfasdfasdfasdfasdf11###\"\n    conn.Write([]byte(str))\n}\n\nfunc checkError(err error) {\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Fatal error \", err.Error())\n        os.Exit(1)\n    }\n}\n</code></pre>\n\n<p>I want change the srcudpaddr</p>\n\n<pre><code>srcudpAddr, err := net.ResolveUDPAddr(\"udp4\", \"127.0.0.2:334\") \n</code></pre>\n\n<p>to </p>\n\n<pre><code>srcudpAddr, err := net.ResolveUDPAddr(\"udp4\", \"211.83.101.20:334\")\n</code></pre>\n\n<p>But error </p>\n\n<p>How can do it</p>\n\n<p>If use  scrapy it will be easy  </p>\n\n<p>But the golang is no way</p>\n"}, {"tags": ["authentication", "oauth", "go", "google-api", "google-oauth"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4514307"}, "is_accepted": false, "score": 0, "last_activity_date": 1423778844, "last_edit_date": 1423778844, "creation_date": 1423778225, "answer_id": 28488591, "question_id": 28408164, "link": "https://stackoverflow.com/questions/28408164/google-oauth2-shows-approval-prompt-on-every-login/28488591#28488591", "title": "Google oauth2 shows approval prompt on every login", "body": "<p>You can cache the token in a file and check on the start of your application, whether the token is still valid or not. You only need to show the approval prompt if the token is outdated.</p>\n\n<p>This is the how I did it. The relevant code can be found <a href=\"https://github.com/davidrjenni/taskfs/blob/master/auth.go#L50\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 418, "user_id": 3167570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e2157d1c50c03d213461ef08c0408e90?s=128&d=identicon&r=PG", "display_name": "dorajistyle", "link": "https://stackoverflow.com/users/3167570/dorajistyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2559, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1423778844, "creation_date": 1423479577, "question_id": 28408164, "link": "https://stackoverflow.com/questions/28408164/google-oauth2-shows-approval-prompt-on-every-login", "title": "Google oauth2 shows approval prompt on every login", "body": "<p>The problem is oauth2 login not works properly using <a href=\"https://github.com/golang/oauth2/\" rel=\"nofollow\">https://github.com/golang/oauth2/</a> library.</p>\n\n<p>Github works great and not shows approval prompt after once I've approved.\nBut Google oauth2 shows approval prompt on every login.</p>\n\n<p>Below url is golang oauth2 generated auth URL. And I didn't find the problem with it.</p>\n\n<pre><code>https://accounts.google.com/o/oauth2/auth?client_id=my_client_id&amp;redirect_uri=redirect_url&amp;response_type=code&amp;scope=email+profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fplus.login+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fplus.profile.emails.read&amp;state=state\n</code></pre>\n\n<p>The document(<a href=\"https://developers.google.com/youtube/v3/guides/authentication\" rel=\"nofollow\">https://developers.google.com/youtube/v3/guides/authentication</a>) said default approval_prompt value is auto.</p>\n\n<p>I've approved the API Testing app properly.\nAnd confirmed it from permissions page(<a href=\"https://security.google.com/settings/security/permissions\" rel=\"nofollow\">https://security.google.com/settings/security/permissions</a>)</p>\n\n<p>And then, <a href=\"https://accounts.google.com/o/oauth2/auth\" rel=\"nofollow\">https://accounts.google.com/o/oauth2/auth</a> shows approval prompt again.\nI've double checked approval_prompt is not 'force'.</p>\n"}, {"tags": ["linux", "macos", "performance", "go", "benchmarking"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1423475002, "post_id": 28406680, "comment_id": 45147637, "body": "What do the <a href=\"http://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">profiles</a> say?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1423475912, "post_id": 28406680, "comment_id": 45148134, "body": "Is there a deep reason you do not close your Request.Body? If you are leaking here in purpose: That&#39;s the reason for your slowdown :-)"}, {"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1423476816, "post_id": 28406680, "comment_id": 45148732, "body": "@Volker Closing request.body does not seem to solve the problem. I have added <code>r.Body.Close()</code> right before <code>w.WriteHeader(200)</code>, and no different benchmark result."}, {"owner": {"reputation": 4810, "user_id": 440935, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/748521f8ae12460dfa2acd0777072b94?s=128&d=identicon&r=PG", "display_name": "Pascal", "link": "https://stackoverflow.com/users/440935/pascal"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1423476880, "post_id": 28406680, "comment_id": 45148756, "body": "@Ainar-G struggling getting pprof to output something useful. It reports 100% of the time being spent in a mutex. Will add the information as soon as I have figured out pprof with net/http (but then I probably already know the answer anyways ;))"}, {"owner": {"reputation": 4810, "user_id": 440935, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/748521f8ae12460dfa2acd0777072b94?s=128&d=identicon&r=PG", "display_name": "Pascal", "link": "https://stackoverflow.com/users/440935/pascal"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1423476940, "post_id": 28406680, "comment_id": 45148800, "body": "@Volker I didn&#39;t know I had to call r.Body.Close() for incoming requests. Never seen any example / doc mentioning it. Will investigate this. Anyways, calling Close() on the request body doesn&#39;t change anything here. Still the same slowdown"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1423477110, "post_id": 28406680, "comment_id": 45148884, "body": "@paukul @Volker there is no need to close the request body on server requests. From TFM: <code>For server requests the Request Body is always non-nil. but will return EOF immediately when no body is present.The Server will close the request body. The ServeHTTP Handler does not need to. </code>"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1423477826, "post_id": 28406680, "comment_id": 45149272, "body": "@paukul how are you testing it on the client side? perhaps your client doesn&#39;t reuse or close connections, leading to some lingering connection leak or something that slows down the kernel."}, {"owner": {"reputation": 4810, "user_id": 440935, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/748521f8ae12460dfa2acd0777072b94?s=128&d=identicon&r=PG", "display_name": "Pascal", "link": "https://stackoverflow.com/users/440935/pascal"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1423477997, "post_id": 28406680, "comment_id": 45149373, "body": "@Not_a_Golfer just a <code>ab -n 20000 http:&#47;&#47;localhost:8080</code>"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1423478278, "post_id": 28406680, "comment_id": 45149530, "body": "@paukul try adding keepalive and some concurrency - <code>-k -c 100</code>"}, {"owner": {"reputation": 4810, "user_id": 440935, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/748521f8ae12460dfa2acd0777072b94?s=128&d=identicon&r=PG", "display_name": "Pascal", "link": "https://stackoverflow.com/users/440935/pascal"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1423478388, "post_id": 28406680, "comment_id": 45149575, "body": "@Not_a_Golfer that &quot;fixed&quot; it! Interesting. So it&#39;s not a problem with golang but with apache bench? Mind: blown. If you create this as an answer I&#39;ll happily accept it as the correct one :)"}], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 5, "last_activity_date": 1423482023, "creation_date": 1423482023, "answer_id": 28408917, "question_id": 28406680, "link": "https://stackoverflow.com/questions/28406680/why-does-this-hello-world-golang-http-example-slow-down-on-osx/28408917#28408917", "title": "why does this &quot;hello world&quot; golang http example slow down on osx", "body": "<p>Phrasing my comments as an answer of sorts:</p>\n\n<p>I'm not sure what's the specific difference between Linux and OSX, but your server code is perfectly fine and not leaking anything. (I don't have an OSX machine to dig deeper at the moment).</p>\n\n<p>My suspicion is that the client you're using (<code>ab</code>) doesn't reuse connections, and due to configuration and behavior differences between the two OSes, you're flooding the network stack with about-to-be closed connections or something along these lines.</p>\n\n<p>Simply use KeepAlive in your ab script - <code>ab -k -c 100 -n 20000 http://localhost:8080</code> - and as noted in the comments this fixed it. It's also worth trying other tools like JMeter, siege, etc - or just writing a simple Go based client for this. Go has connection reuse in the http library by default. </p>\n"}], "owner": {"reputation": 4810, "user_id": 440935, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/748521f8ae12460dfa2acd0777072b94?s=128&d=identicon&r=PG", "display_name": "Pascal", "link": "https://stackoverflow.com/users/440935/pascal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 800, "favorite_count": 0, "accepted_answer_id": 28408917, "answer_count": 1, "score": 4, "last_activity_date": 1423482023, "creation_date": 1423474883, "question_id": 28406680, "link": "https://stackoverflow.com/questions/28406680/why-does-this-hello-world-golang-http-example-slow-down-on-osx", "title": "why does this &quot;hello world&quot; golang http example slow down on osx", "body": "<p>I was benchmarking my little web application and noticed some significant slowdown when I was running apache bench against it after a couple of thousand requests.</p>\n\n<p><code>ab -n 20000 http://localhost:8080</code></p>\n\n<p>The first few thousand requests are fast, then it gets slower and slower. Dramatically slower. While the first thousand take maybe a second, requests 18000-20000 take up to 10 seconds.</p>\n\n<p>So I was trying to find the slow parts and at some point didn't have anything to exclude anymore until I ended up with benchmarking a \"hello world\" style http server example. To my surprise, the same slowdown occurred.</p>\n\n<pre><code>package main\n\nimport \"net/http\"\n\nfunc main() {\n    mux := http.NewServeMux()\n\n    mux.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        w.WriteHeader(200)\n    })\n    http.ListenAndServe(\":8080\", mux)\n}\n</code></pre>\n\n<p>The same little example runs consistently fast on a linux box. It's not really a big thing because I don't plan to run the app on osx in production ;) But I'm curious what's causing the terrible slowdown on osx anyways</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 998517, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5d31446a9e49708a93dd90706bee6474?s=128&d=identicon&r=PG", "display_name": "Swaminathan.M", "link": "https://stackoverflow.com/users/998517/swaminathan-m"}, "edited": false, "score": 0, "creation_date": 1423645471, "post_id": 28407323, "comment_id": 45228399, "body": "Thanks Volker! Now understand the problem here. Reason I was pressing on the &#39;go build&#39; is most of the developers will anyways uses this tool for their projects."}, {"owner": {"reputation": 1796, "user_id": 845048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7659ff88e145debc2c92b9ad2eea537?s=128&d=identicon&r=PG", "display_name": "tsuna", "link": "https://stackoverflow.com/users/845048/tsuna"}, "edited": false, "score": 3, "creation_date": 1439959294, "post_id": 28407323, "comment_id": 52069079, "body": "Heads up: this trick doesn&#39;t work anymore as of Go 1.5, see <a href=\"https://github.com/golang/go/issues/12186\" rel=\"nofollow noreferrer\">this GitHub issue</a>."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 14, "last_activity_date": 1470146381, "last_edit_date": 1470146381, "creation_date": 1423476788, "answer_id": 28407323, "question_id": 28406122, "link": "https://stackoverflow.com/questions/28406122/using-binary-packages-directly/28407323#28407323", "title": "Using binary packages directly", "body": "<p>The Go compiler just needs the <code>.a</code> files. If you ship them anybody will be able to use your package without the source code.</p>\n\n<p><strong>BUT</strong> your users will have to invoke the compiler (e.g. <code>6g</code>, not the <code>go</code> tool) manually. If you ship a <code>myfoo.a</code> file <em>and</em> a dummy source <code>myfoo.go</code> containing just <code>package myfoo</code> and the timestamp of <code>myfoo.a</code> is newer than that of <code>myfoo.go</code> (and you put everything in place) you may use the <code>go</code> tool. </p>\n\n<p><strong>Update</strong>: Newer version of the go tool detect deleted files and require all files (possibly empty) with the proper filenames and older timestamps in the src folder.\nManaging a timestamp should not be a dealbreaker.</p>\n\n<p>Don't get fooled that the <code>go</code> tool <em>is</em> Go: It is a dead convenient tool to build, test, get, whatever your Go code, but it is neither the language nor the compiler nor the linker.</p>\n\n<p>BTW: There is really no point in not distributing the sources.</p>\n"}, {"comments": [{"owner": {"reputation": 4827, "user_id": 303726, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5c9c83c99715bf38dd62c7ae20da3dd7?s=128&d=identicon&r=PG", "display_name": "Julio Guerra", "link": "https://stackoverflow.com/users/303726/julio-guerra"}, "edited": false, "score": 1, "creation_date": 1568108648, "post_id": 38594121, "comment_id": 102161128, "body": "Support was dropped."}, {"owner": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "edited": false, "score": 0, "creation_date": 1589352831, "post_id": 38594121, "comment_id": 109255970, "body": "Where does it say that?"}, {"owner": {"reputation": 79, "user_id": 11282204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tQy7z.jpg?s=128&g=1", "display_name": "Mayank Singhal", "link": "https://stackoverflow.com/users/11282204/mayank-singhal"}, "reply_to_user": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "edited": false, "score": 1, "creation_date": 1610529704, "post_id": 38594121, "comment_id": 116159987, "body": "@425nesp <a href=\"https://golang.org/pkg/go/build/#hdr-Binary_Only_Packages\" rel=\"nofollow noreferrer\">golang.org/pkg/go/build/#hdr-Binary_Only_Packages</a>"}], "tags": [], "owner": {"reputation": 1281, "user_id": 787553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4be2932e858c8fc42b83a705031b73?s=128&d=identicon&r=PG", "display_name": "dmitris", "link": "https://stackoverflow.com/users/787553/dmitris"}, "is_accepted": false, "score": 6, "last_activity_date": 1469547071, "creation_date": 1469547071, "answer_id": 38594121, "question_id": 28406122, "link": "https://stackoverflow.com/questions/28406122/using-binary-packages-directly/38594121#38594121", "title": "Using binary packages directly", "body": "<p>The binary-only packages will be available in go1.7 (August 2016) - <a href=\"https://tip.golang.org/doc/go1.7\" rel=\"noreferrer\">https://tip.golang.org/doc/go1.7</a></p>\n\n<blockquote>\n  <p>This release adds experimental, minimal support for building programs using binary-only packages, packages distributed in binary form without the corresponding source code. This feature is needed in some commercial settings but is not intended to be fully integrated into the rest of the toolchain. For example, tools that assume access to complete source code will not work with such packages, and there are no plans to support such packages in the \u201cgo get\u201d command.</p>\n</blockquote>\n\n<p>The proposal is at <a href=\"https://github.com/golang/proposal/blob/master/design/2775-binary-only-packages.md\" rel=\"noreferrer\">https://github.com/golang/proposal/blob/master/design/2775-binary-only-packages.md</a> , <a href=\"https://tip.golang.org/pkg/go/build/#hdr-Binary_Only_Packages\" rel=\"noreferrer\">https://tip.golang.org/pkg/go/build/#hdr-Binary_Only_Packages</a> has more information about the new feature.</p>\n"}, {"comments": [{"owner": {"reputation": 2299, "user_id": 3760216, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/gEcRI.jpg?s=128&g=1", "display_name": "Sachith Muhandiram", "link": "https://stackoverflow.com/users/3760216/sachith-muhandiram"}, "edited": false, "score": 1, "creation_date": 1480920764, "post_id": 40968343, "comment_id": 69146340, "body": "please post example answer here, then references"}, {"owner": {"reputation": 1239, "user_id": 5421426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/96a1eeb26ff88da78645596f42df3735?s=128&d=identicon&r=PG", "display_name": "Dr.Nemo", "link": "https://stackoverflow.com/users/5421426/dr-nemo"}, "edited": false, "score": 0, "creation_date": 1565591776, "post_id": 40968343, "comment_id": 101387015, "body": "any tool to auto add function prototype? a large amount functions in my project."}], "tags": [], "owner": {"reputation": 2364, "user_id": 4206629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ea9a378d5409478f2717aae6354396?s=128&d=identicon&r=PG", "display_name": "YongHao Hu", "link": "https://stackoverflow.com/users/4206629/yonghao-hu"}, "is_accepted": false, "score": 5, "last_activity_date": 1480921674, "last_edit_date": 1480921674, "creation_date": 1480919410, "answer_id": 40968343, "question_id": 28406122, "link": "https://stackoverflow.com/questions/28406122/using-binary-packages-directly/40968343#40968343", "title": "Using binary packages directly", "body": "<p>The binary-only packages is supported in go 1.7 now.</p>\n\n<p>You can only provide .a files and fake go files without source code to distribute it now.</p>\n\n<p>Here is a <a href=\"https://github.com/YongHaoWu/golang-binary-package-generator\" rel=\"noreferrer\">detailed example and a script of Go1.7 binary package generator.</a></p>\n\n<p>myframework/frameImplement.go</p>\n\n<pre><code>package myframework\n\nimport \"fmt\"\n\nfunc Hello(name string) string {\n    return fmt.Sprintf(\"Hello, %s!\", name)\n}\n</code></pre>\n\n<p>main/main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"golang-binary-package-generator/myframework\"\n)\n\nfunc main() {\n    fmt.Println(\" start program \")\n    fmt.Println(\" print program :\", myframework.Hello(\"print something now\"))\n}\n</code></pre>\n\n<p>If I want to hide my framework's source code, just build it with <code>go build -i -o $GOPATH/pkg/framework.a</code>, then modify your source code to </p>\n\n<pre><code>//go:binary-only-package\n\npackage framework\n\n//you can add function prototype here for go doc etc, but no necessary.\n</code></pre>\n\n<p>, which you can use my binary package generator(script) to help you.</p>\n"}, {"tags": [], "owner": {"reputation": 713, "user_id": 7935057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c9d728238e2fcff48bff90cb448f6c2?s=128&d=identicon&r=PG&f=1", "display_name": "Sully", "link": "https://stackoverflow.com/users/7935057/sully"}, "is_accepted": false, "score": 0, "last_activity_date": 1604117100, "creation_date": 1604117100, "answer_id": 64618303, "question_id": 28406122, "link": "https://stackoverflow.com/questions/28406122/using-binary-packages-directly/64618303#64618303", "title": "Using binary packages directly", "body": "<p>The decision to drop the feature:</p>\n<p><a href=\"https://github.com/golang/go/issues/28152\" rel=\"nofollow noreferrer\">cmd/go: drop support for binary-only packages</a></p>\n"}], "owner": {"reputation": 213, "user_id": 998517, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5d31446a9e49708a93dd90706bee6474?s=128&d=identicon&r=PG", "display_name": "Swaminathan.M", "link": "https://stackoverflow.com/users/998517/swaminathan-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7120, "favorite_count": 9, "accepted_answer_id": 28407323, "answer_count": 4, "score": 18, "last_activity_date": 1604117100, "creation_date": 1423472916, "last_edit_date": 1441052376, "question_id": 28406122, "link": "https://stackoverflow.com/questions/28406122/using-binary-packages-directly", "title": "Using binary packages directly", "body": "<p>I'm writing a library in Go. I'm planning to distribute it, and with a main requirement of '<strong>without source codes</strong>'. </p>\n\n<p>For testing, I have created two workspaces like following,</p>\n\n<p><strong>WS1</strong></p>\n\n<ul>\n<li>bin/</li>\n<li>pkg/linux_amd64/lib.a</li>\n<li>src/lib/src.go </li>\n</ul>\n\n<p><strong>WS2</strong></p>\n\n<ul>\n<li>bin/</li>\n<li>pkg/</li>\n<li>src/main/main.go</li>\n</ul>\n\n<p>My first workspace (WS1) is the actual dummy library, which has some utility functions. Second workspace (WS2) has main function which uses the package (lib.a) from WS1.</p>\n\n<p>Everything was working good until I remove the sources from WS1. If I remove the directory /lib/src.go in WS1, I'm getting the following error during go build,</p>\n\n<blockquote>\n  <p>main.go:5:2: cannot find package \"lib\" in any of:\n  /usr/local/go/src/pkg/lib (from $GOROOT)   ../Testing/ws1/src/lib\n  (from $GOPATH)</p>\n</blockquote>\n\n<p>The above message indicates us that we should keep the source files as well. <strong>Precompiled binary packages alone cannot be used directly</strong>.</p>\n\n<p>Based on few suggestions online, we may keep some dummy sources with timestamp value lesser than binary packages' timestamp. But, this doesn't seems to be a feasible solution for us. What happens if timestamp of the dummy sources got updated unfortunately?</p>\n\n<p>I have seen similar issue discussed here,\n<a href=\"https://github.com/golang/go/issues/2775\">https://github.com/golang/go/issues/2775</a></p>\n\n<p><strong>My Questions:</strong></p>\n\n<ol>\n<li><p>Distributing the sources is the only possibility in Golang?</p></li>\n<li><p>Why Go is not providing a provision for using '.a' files directly?</p></li>\n<li><p>If keeping the source is mandatory for Go, why this small thing is\nnot mentioned anywhere in Go? (or) Am I missing something here?</p></li>\n</ol>\n\n<p>Thanks in advance for your help guys!</p>\n"}, {"tags": ["string", "go", "hex", "slice"], "comments": [{"owner": {"reputation": 151, "user_id": 1420827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be05ded65dae8c949a236dbaff397849?s=128&d=identicon&r=PG", "display_name": "cuuboy", "link": "https://stackoverflow.com/users/1420827/cuuboy"}, "edited": false, "score": 0, "creation_date": 1423465269, "post_id": 28404326, "comment_id": 45143218, "body": "That would be more complicated than I thought, because I just use hex.EncodeToString, I wonder why I cannot use kind of this function to let it back."}, {"owner": {"reputation": 151, "user_id": 1420827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be05ded65dae8c949a236dbaff397849?s=128&d=identicon&r=PG", "display_name": "cuuboy", "link": "https://stackoverflow.com/users/1420827/cuuboy"}, "reply_to_user": {"reputation": 1312, "user_id": 2801779, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72877dd1a58afd31485006f1a2f06222?s=128&d=identicon&r=PG&f=1", "display_name": "EdmDroid", "link": "https://stackoverflow.com/users/2801779/edmdroid"}, "edited": false, "score": 0, "creation_date": 1423465593, "post_id": 28404326, "comment_id": 45143342, "body": "@EdmDroid yes question is simple, but that means I want a simple answer."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 1420827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be05ded65dae8c949a236dbaff397849?s=128&d=identicon&r=PG", "display_name": "cuuboy", "link": "https://stackoverflow.com/users/1420827/cuuboy"}, "edited": false, "score": 0, "creation_date": 1423465906, "post_id": 28404487, "comment_id": 45143447, "body": "You&#39;re right, I&#39;m so stupid, I thought that should not be transferred into dec, but indeed it should be, thanks. <a href=\"http://play.golang.org/p/S_blDzfpN7\" rel=\"nofollow noreferrer\">play.golang.org/p/S_blDzfpN7</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 17, "last_activity_date": 1423466013, "last_edit_date": 1423466013, "creation_date": 1423465706, "answer_id": 28404487, "question_id": 28404326, "link": "https://stackoverflow.com/questions/28404326/how-to-transfer-hex-strings-to-byte-directly-in-go/28404487#28404487", "title": "How to transfer hex strings to []byte directly in Go?", "body": "<p>Simply use the <a href=\"http://golang.org/pkg/encoding/hex/#DecodeString\" rel=\"noreferrer\"><code>hex.DecodeString()</code></a> function:</p>\n\n<pre><code>s := \"46447381\"\n\ndata, err := hex.DecodeString(s)\nif err != nil {\n    panic(err)\n}\nfmt.Printf(\"% x\", data)\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>46 44 73 81\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/3o67X5bBn3\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p><strong>Note:</strong></p>\n\n<p>If you just simply print the byte slice using <code>fmt.Println(data)</code>, the printed values will be in decimal format that's why it won't match your input <code>string</code> (because it is specified in hexadecimal format).<br>\nOutput of <code>fmt.Println(data)</code> would be:</p>\n\n<pre><code>[70 68 115 129]\n</code></pre>\n\n<p>These are the same numbers just in decimal base.</p>\n"}], "owner": {"reputation": 151, "user_id": 1420827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be05ded65dae8c949a236dbaff397849?s=128&d=identicon&r=PG", "display_name": "cuuboy", "link": "https://stackoverflow.com/users/1420827/cuuboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12749, "favorite_count": 4, "accepted_answer_id": 28404487, "answer_count": 1, "score": 13, "last_activity_date": 1595665687, "creation_date": 1423464980, "last_edit_date": 1595665687, "question_id": 28404326, "link": "https://stackoverflow.com/questions/28404326/how-to-transfer-hex-strings-to-byte-directly-in-go", "title": "How to transfer hex strings to []byte directly in Go?", "body": "<p>Question is simple,</p>\n\n<p>how to transfer <code>\"46447381\"</code> in to <code>[]byte{0x46,0x44,0x73,0x81}</code>?</p>\n"}, {"tags": ["arrays", "struct", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 601, "user_id": 2350858, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/460605907bb0a8083ae1469dbbc7d203?s=128&d=identicon&r=PG", "display_name": "user2350858", "link": "https://stackoverflow.com/users/2350858/user2350858"}, "edited": false, "score": 0, "creation_date": 1423465116, "post_id": 28404258, "comment_id": 45143156, "body": "Thank you sir, it would have taken me a whole day to figure that out."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1423464652, "creation_date": 1423464652, "answer_id": 28404258, "question_id": 28404140, "link": "https://stackoverflow.com/questions/28404140/how-to-populate-struct-slice-using-array/28404258#28404258", "title": "How to populate struct slice using array?", "body": "<p>Use make to create the slice and a for loop to populate the slice:</p>\n\n<pre><code>u := make([]User, len(a))\nfor i := range a {\n    u[i].NickName = a[i]\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/z6QUDf3cuC\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 601, "user_id": 2350858, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/460605907bb0a8083ae1469dbbc7d203?s=128&d=identicon&r=PG", "display_name": "user2350858", "link": "https://stackoverflow.com/users/2350858/user2350858"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 28404258, "answer_count": 1, "score": 0, "last_activity_date": 1423466345, "creation_date": 1423464162, "last_edit_date": 1423466345, "question_id": 28404140, "link": "https://stackoverflow.com/questions/28404140/how-to-populate-struct-slice-using-array", "title": "How to populate struct slice using array?", "body": "<p>In Go is it possible to populate a struct slice? My data is an array of strings.</p>\n\n<pre><code>a := [string1, string2, string3, string4]\n\ntype User struct {\n     NickName string\n}\n\nvar u []User\n</code></pre>\n\n<p>How do I populate <code>u</code> with the contents of <code>a</code>?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1423464238, "post_id": 28404050, "comment_id": 45142883, "body": "There&#39;s insufficient data presented in the question to conclude that domain name resolution is at fault. If possible, use an IP address in the call to ampq.Dial() and see if that makes a difference Also, how does ampq come into play? The program presented above in the question not use ampq."}, {"owner": {"reputation": 2703, "user_id": 2049333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3de211d5b26ab932c16ab465d1791018?s=128&d=identicon&r=PG", "display_name": "mschuett", "link": "https://stackoverflow.com/users/2049333/mschuett"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1423464647, "post_id": 28404050, "comment_id": 45143010, "body": "yeah i am sorry about that. I removed any code to it because i thought this was just a DNS issue but it does not seem to be. About to update it with some more info now."}], "owner": {"reputation": 2703, "user_id": 2049333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3de211d5b26ab932c16ab465d1791018?s=128&d=identicon&r=PG", "display_name": "mschuett", "link": "https://stackoverflow.com/users/2049333/mschuett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 919, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1423464783, "creation_date": 1423463677, "last_edit_date": 1423464783, "question_id": 28404050, "link": "https://stackoverflow.com/questions/28404050/golang-dns-resolution-issues", "title": "Golang DNS resolution issues", "body": "<p>I was playing with the <a href=\"https://github.com/streadway/amqp\" rel=\"nofollow\">https://github.com/streadway/amqp</a> library today and had a rough implementation working based of the example <a href=\"https://github.com/streadway/amqp/blob/master/_examples/simple-consumer/consumer.go\" rel=\"nofollow\">here</a>. It was working ok when using the domain name although for connecting to a vagrant box on my local machine it was taking fairly long. The issue came when I added in the functionality to also send a JSON request to that same server I ran into all kinds of timeout issues mostly related to rabbitmq closing a connection because it was waiting so long.</p>\n\n<p>So i ran this following code to see if i could isolate the issue.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc main() {\n    start := time.Now()\n    _, err := http.Get(\"http://local.test.dev/test\")\n    if err != nil {\n        log.Println(\"%s\", err.Error())\n    }\n    log.Printf(\"Time: %v\", time.Since(start))\n}\n</code></pre>\n\n<p>This resulted in the somewhat surprising output of this after running a few tests.</p>\n\n<pre><code>2015/02/09 01:27:33 Time: 1.131834476s\n2015/02/09 01:27:37 Time: 828.873332ms\n2015/02/09 01:27:40 Time: 862.059803ms\n2015/02/09 01:27:41 Time: 207.781482ms\n2015/02/09 01:27:43 Time: 810.567042ms\n2015/02/09 01:27:45 Time: 197.555383ms\n2015/02/09 01:27:55 Time: 776.675657ms\n</code></pre>\n\n<p>here is what the traceroute command looked like to make sure it wasn't some other issue.</p>\n\n<pre><code>traceroute to local.test.dev (192.168.56.101), 64 hops max, 52 byte packets\n 1  local.test.dev (192.168.56.101)  0.368 ms  0.430 ms  0.252 ms\n</code></pre>\n\n<p>I also tried the same snip-it from above but with the IP instead. It is only about 60ms faster which i find surprising but leads me to think the issue is not the net/http package but with the amqp library. The only place that I am using a domain name in the amqp library is for the following <a href=\"https://github.com/streadway/amqp/blob/master/connection.go#L125\" rel=\"nofollow\">call</a>.</p>\n\n<pre><code>amqp.Dial(amqpURI)\n</code></pre>\n\n<p>Does go have an issue with using domain names? Other than that I can't think of what could be causing the lookup time to take so long.</p>\n\n<p>EDIT:\nI thought this was a DNS issue at first but after playing around with IP vs domain name it seems that is not the case. Also amqp Dial does not seem to be the issue. It only takes 4ms to return a connection. This leaves only channel.Consume as the culprit. going to throw together some isolated sample code and update...</p>\n"}, {"tags": ["parsing", "go", "yaml"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1423466481, "post_id": 28403829, "comment_id": 45143656, "body": "Please show us your Go code how you parse the yaml file."}], "answers": [{"tags": [], "owner": {"reputation": 7376, "user_id": 2171928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a2dc8a6d4e15c61451d70f695ac18ae9?s=128&d=identicon&r=PG", "display_name": "Kishore Vaishnav", "link": "https://stackoverflow.com/users/2171928/kishore-vaishnav"}, "is_accepted": false, "score": 2, "last_activity_date": 1423488685, "creation_date": 1423488685, "answer_id": 28410961, "question_id": 28403829, "link": "https://stackoverflow.com/questions/28403829/how-to-preserve-spaces-and-newline-in-golang-yaml-parser/28410961#28410961", "title": "how to preserve spaces and newline in golang yaml parser?", "body": "<p>I am not sure which parser are you using to parse the YAML, but here is a snippet which works pretty good, I used <a href=\"https://github.com/spf13/viper\" rel=\"nofollow\">viper</a>.</p>\n\n<p><strong>testviber.yaml</strong></p>\n\n<pre><code>invoice: 34843\ndate   : 2001-01-23\nabc: |\n   There once was a short man from Ealing\n   Who got on a bus to Darjeeling\n       It said on the door\n       \"Please don't spit on the floor\"\n   So he carefully spat on the ceiling\nlast_invoice: 34843\n</code></pre>\n\n<p><strong>testviber.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/spf13/viper\"\n)\n\nfunc main() {\n    viper.SetConfigName(\"testviber\")\n    viper.ReadInConfig()\n    fmt.Printf(\"%v\", viper.Get(\"abc\"))\n}\n</code></pre>\n"}], "owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1467, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1424151366, "creation_date": 1423462516, "last_edit_date": 1424151366, "question_id": 28403829, "link": "https://stackoverflow.com/questions/28403829/how-to-preserve-spaces-and-newline-in-golang-yaml-parser", "title": "how to preserve spaces and newline in golang yaml parser?", "body": "<p>I want something like </p>\n\n<pre>Some text here,  \n    indented text here\n    next indented texr here</pre>\n\n<p>I tried this yaml style</p>\n\n<pre>\nkey: |\n    Some text here,\n        indented text here\n        next indented text here\n</pre>\n\n<p>the above yaml code preserves only the newline but discards the indented spaces.\nHow to preserve those extra spaces?</p>\n\n<p>code I used to parse the yaml file\n<code>\n    package main</p>\n\n<pre><code>import (\n    \"os\"\n    \"fmt\"\n    \"github.com/kylelemons/go-gypsy/yaml\"\n)\n\nfunc main(){\n    map_,err:=Parse()\nfmt.Println(map_.Key(\"Key\"),err)\n}\n\nfunc Parse() (yaml.Map, error) {\n    file, err := os.Open(\"testindent.yaml\")\n        if err != nil {\n        return nil, err\n    }\n    node, err := yaml.Parse(file)\n        if err != nil {\n            return nil, err\n    }\n    nodes := node.(yaml.Map)\n    return nodes, nil\n}\n</code></pre>\n\n<p></code></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 4040331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c5a21db72fd3f20fd41dda8cf76020e?s=128&d=identicon&r=PG&f=1", "display_name": "SKK", "link": "https://stackoverflow.com/users/4040331/skk"}, "is_accepted": true, "score": 0, "last_activity_date": 1423452550, "creation_date": 1423452550, "answer_id": 28402360, "question_id": 28402309, "link": "https://stackoverflow.com/questions/28402309/go-function-syntax-explanation/28402360#28402360", "title": "Go function syntax explanation", "body": "<p>This syntax allows you to call DefaultMask() from an IP type, similar to how member functions work in other languages:</p>\n\n<pre><code>ip.DefaultMask()\n</code></pre>\n\n<p>The (ip IP) basically represents the \"thiscall\" argument.</p>\n"}, {"tags": [], "owner": {"reputation": 2326, "user_id": 479008, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Nebls.gif?s=128&g=1", "display_name": "CodeFarmer", "link": "https://stackoverflow.com/users/479008/codefarmer"}, "is_accepted": false, "score": 1, "last_activity_date": 1423453034, "creation_date": 1423453034, "answer_id": 28402426, "question_id": 28402309, "link": "https://stackoverflow.com/questions/28402309/go-function-syntax-explanation/28402426#28402426", "title": "Go function syntax explanation", "body": "<p><a href=\"https://golang.org/ref/spec#Function_declarations\" rel=\"nofollow\">https://golang.org/ref/spec#Function_declarations</a></p>\n\n<p>\"Method declarations\" - the way to define a method for receiver base type.</p>\n"}], "owner": {"reputation": 2326, "user_id": 479008, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Nebls.gif?s=128&g=1", "display_name": "CodeFarmer", "link": "https://stackoverflow.com/users/479008/codefarmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 28402360, "answer_count": 2, "score": -2, "last_activity_date": 1423454709, "creation_date": 1423452086, "last_edit_date": 1423454709, "question_id": 28402309, "link": "https://stackoverflow.com/questions/28402309/go-function-syntax-explanation", "title": "Go function syntax explanation", "body": "<p>I am reading one book.</p>\n\n<p>One function came out: </p>\n\n<blockquote>\n  <p>func (ip IP) DefaultMask() IPMask</p>\n</blockquote>\n\n<p>Source code for this function is located inside the net package:</p>\n\n<pre><code>func (ip IP) DefaultMask() IPMask {\n    if ip = ip.To4(); ip == nil {\n        return nil\n    }\n    switch true {\n    case ip[0] &lt; 0x80:\n        return classAMask\n    case ip[0] &lt; 0xC0:\n        return classBMask\n    default:\n        return classCMask\n    }\n}\n</code></pre>\n\n<p>Question is: what is <code>(ip IP)</code>?</p>\n"}, {"tags": ["email", "go", "mailgun", "dkim"], "comments": [{"owner": {"reputation": 346, "user_id": 3604386, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j8XLj.jpg?s=128&g=1", "display_name": "masegaloeh", "link": "https://stackoverflow.com/users/3604386/masegaloeh"}, "edited": false, "score": 0, "creation_date": 1423460960, "post_id": 28401673, "comment_id": 45141933, "body": "Please try to send email to gmail and post the header of received email in above question"}], "answers": [{"comments": [{"owner": {"reputation": 23513, "user_id": 1029936, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BZUZK.png?s=128&g=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/1029936/bill"}, "edited": false, "score": 0, "creation_date": 1423506224, "post_id": 28415140, "comment_id": 45166399, "body": "No, I&#39;m sending from the domain that I authorized. In other words the mail.bar.com from above is the one that I&#39;ve specified in Mailgun."}, {"owner": {"reputation": 61, "user_id": 1848136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc64a5c3c5dd4a4caa7372f14b8ca914?s=128&d=identicon&r=PG", "display_name": "John Mark Scarborough", "link": "https://stackoverflow.com/users/1848136/john-mark-scarborough"}, "edited": false, "score": 2, "creation_date": 1439552709, "post_id": 28415140, "comment_id": 51920830, "body": "I think that&#39;s the problem!  You need to have setup foo.com in mailgun since you are sending &quot;from&quot; john@foo.com (and not mail.bar.com)."}], "tags": [], "owner": {"reputation": 1094, "user_id": 381385, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4c3a996a2b224de62d5c2aae1f2760b?s=128&d=identicon&r=PG", "display_name": "bvanvugt", "link": "https://stackoverflow.com/users/381385/bvanvugt"}, "is_accepted": false, "score": 3, "last_activity_date": 1423501237, "creation_date": 1423501237, "answer_id": 28415140, "question_id": 28401673, "link": "https://stackoverflow.com/questions/28401673/removing-on-behalf-of-when-sending-mail-using-mailgun/28415140#28415140", "title": "Removing &#39;on behalf of&#39; when sending mail using MailGun", "body": "<p>Are you trying to send from a different domain than the one you setup SPF/DKIM on?</p>\n\n<p>You can only send white-labelled emails from the domain you're authorized with Mailgun.</p>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 364086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6db8d3bfa6befd1e4f9ca118602769ef?s=128&d=identicon&r=PG", "display_name": "Skowronek", "link": "https://stackoverflow.com/users/364086/skowronek"}, "edited": false, "score": 1, "creation_date": 1463713220, "post_id": 36500003, "comment_id": 62191891, "body": "Thanks. This fixed my issue with Mailgun."}], "tags": [], "owner": {"reputation": 418, "user_id": 1247671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e79df57716511bafe0b5c9c844c4ed4d?s=128&d=identicon&r=PG", "display_name": "Dhodgin", "link": "https://stackoverflow.com/users/1247671/dhodgin"}, "is_accepted": true, "score": 21, "last_activity_date": 1460119826, "creation_date": 1460119826, "answer_id": 36500003, "question_id": 28401673, "link": "https://stackoverflow.com/questions/28401673/removing-on-behalf-of-when-sending-mail-using-mailgun/36500003#36500003", "title": "Removing &#39;on behalf of&#39; when sending mail using MailGun", "body": "<p>You need to set the <code>sender</code> property in the email header to the from address as well most likely.</p>\n\n<p>I had this same problem using NodeMailer for a node.js project. Gmail and Thunderbird would show the from address fine but Outlook would show the from address as</p>\n\n<pre><code>emailname=example.com@mail.example.com on behalf of emailname@example.com\n</code></pre>\n\n<p>When I looked into the full email message header I saw that the <code>sender:</code> in the header was <code>emailname=example.com@mail.example.com</code> and the <code>from:</code> was <code>emailname@example.com</code></p>\n\n<p>we looked into the spf and dkim records at first thinking it was an issue there but they were fine and in the email header it even said spf and dkim both were passing so then i noticed the sender header was different than the from and Outlook pays attention to that where gmail and thunderbird don't care as much.</p>\n\n<p>Try setting the <code>sender</code> header to the <code>from</code> value.</p>\n\n<p>Here is a sample of part of one of the wrong email headers edited to match example above</p>\n\n<pre><code>Received-SPF: pass (google.com....\nAuthentication-Results: mx.google.com;\n       dkim=pass header.i=@mail.example.com;\n       spf=pass (google.com.....\nSender: emailname=example.com@mail.example.com\nFrom: Persons Name &lt;emailname@example.com&gt;\n</code></pre>\n\n<p>make <code>Sender</code> equal to <code>Sender: Persons Name &lt;emailname@example.com&gt;</code></p>\n"}, {"comments": [{"owner": {"reputation": 6051, "user_id": 1809762, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3cca4aae174ab7ac37fe1e7f47f89c51?s=128&d=identicon&r=PG", "display_name": "Pete", "link": "https://stackoverflow.com/users/1809762/pete"}, "edited": false, "score": 4, "creation_date": 1552499906, "post_id": 39047819, "comment_id": 97037246, "body": "Hmm, in Mailgun&#39;s setup they say &quot;We recommend using a subdomain with Mailgun, like \u201cmg.mydomain.com\u201d. Using a subdomain you will still be able to send emails from your root domain e.g. \u201cyou@mydomain.com\u201d&quot;. If that&#39;s true, I wonder what the process would be?"}], "tags": [], "owner": {"reputation": 465, "user_id": 1185351, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/574271aa49127fca754aa115aeea3446?s=128&d=identicon&r=PG", "display_name": "kapale", "link": "https://stackoverflow.com/users/1185351/kapale"}, "is_accepted": false, "score": 14, "last_activity_date": 1542115018, "last_edit_date": 1542115018, "creation_date": 1471641576, "answer_id": 39047819, "question_id": 28401673, "link": "https://stackoverflow.com/questions/28401673/removing-on-behalf-of-when-sending-mail-using-mailgun/39047819#39047819", "title": "Removing &#39;on behalf of&#39; when sending mail using MailGun", "body": "<h2>Have you added an mg sub domain?</h2>\n\n<p>If you have added a sub-domain such as @mg.domain.com then <strong>make sure you send your emails from name@mg.domain.com</strong></p>\n\n<p>I had the same problem, as I didn't realize that I wanted to have the sender address <em>name@domain.com</em> but I had added - as recommended - a subdomain to mailgun: <em>mg.domain.com</em>. </p>\n\n<p>So when I tried to send an email from <em>name@domain.com</em> I got \"on behalf of\" / \"sent by\" but as soon as I've used the subdomain <strong>name@mg.domain.com</strong> - the \"on behalf\" message is gone... stupid me... </p>\n"}, {"comments": [{"owner": {"reputation": 23513, "user_id": 1029936, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BZUZK.png?s=128&g=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/1029936/bill"}, "edited": false, "score": 0, "creation_date": 1503226595, "post_id": 45445015, "comment_id": 78519805, "body": "This works, but note the header should be &quot;sender&quot; and not &quot;h:sender&quot;. When using the MailGun library, AddParameter adds the h: for you."}, {"owner": {"reputation": 245, "user_id": 2537052, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/eLt2m.jpg?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/2537052/ray"}, "edited": false, "score": 5, "creation_date": 1545152194, "post_id": 45445015, "comment_id": 94523556, "body": "This save my life! thanks!! btw I had to include the h:, i tried without it but nothing change until i used the h: to indicate the use of a header value"}, {"owner": {"reputation": 1900, "user_id": 1178042, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/35c6dfb9e75000cd62adba6399958ef2?s=128&d=identicon&r=PG", "display_name": "Petter Brodin", "link": "https://stackoverflow.com/users/1178042/petter-brodin"}, "reply_to_user": {"reputation": 245, "user_id": 2537052, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/eLt2m.jpg?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/2537052/ray"}, "edited": false, "score": 4, "creation_date": 1560933138, "post_id": 45445015, "comment_id": 99895131, "body": "I had the same experience as @Ray."}, {"owner": {"reputation": 2604, "user_id": 3385948, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YJIjJ.png?s=128&g=1", "display_name": "Sean McCarthy", "link": "https://stackoverflow.com/users/3385948/sean-mccarthy"}, "edited": false, "score": 0, "creation_date": 1601767993, "post_id": 45445015, "comment_id": 113508791, "body": "If any Pythonistas are using the requests library, you can add the &quot;h:sender&quot; like this: <code>response = requests.post(url, auth, data={&quot;h:sender&quot;: &quot;Name &lt;name@email.com&gt;&quot;, ...})</code>"}], "tags": [], "owner": {"reputation": 171, "user_id": 4816426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ee167f4d5f7bc14691416314f0ecb64?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/4816426/julian"}, "is_accepted": false, "score": 17, "last_activity_date": 1501611327, "creation_date": 1501611327, "answer_id": 45445015, "question_id": 28401673, "link": "https://stackoverflow.com/questions/28401673/removing-on-behalf-of-when-sending-mail-using-mailgun/45445015#45445015", "title": "Removing &#39;on behalf of&#39; when sending mail using MailGun", "body": "<p>To add to Dhodgin's answer:<br/><br/>\nThe <code>on behalf of</code> message comes up if you're using a subdomain in MailGun such as <code>mail.bar.com</code> and the from email address is using a different domain such as <code>john@foo.com</code><br/>\nTo fix this issue add a custom MIME header \"sender\" and set it to be the same as the from email address.<br/><br/>\nTo add a custom header using the <a href=\"https://documentation.mailgun.com/en/latest/api-sending.html#sending\" rel=\"noreferrer\"> MailGun api</a> make sure to add a <code>h:</code> prefix such as:</p>\n\n<pre><code>request.AddParameter(\"h:sender\", \"John Smith &lt;john@foo.com&gt; \");\n</code></pre>\n"}], "owner": {"reputation": 23513, "user_id": 1029936, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BZUZK.png?s=128&g=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/1029936/bill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13897, "favorite_count": 8, "accepted_answer_id": 36500003, "answer_count": 4, "score": 24, "last_activity_date": 1542115018, "creation_date": 1423446635, "last_edit_date": 1423447162, "question_id": 28401673, "link": "https://stackoverflow.com/questions/28401673/removing-on-behalf-of-when-sending-mail-using-mailgun", "title": "Removing &#39;on behalf of&#39; when sending mail using MailGun", "body": "<p>I'm trying to figure out how to send mails using the MailGun Golang API without having it sent 'on behalf of'.  </p>\n\n<p>This is how the From address currently looks (where foo.com is the sender's email domain and bar.com is my domain):</p>\n\n<pre><code>john=foo.com@mail.bar.com on behalf of John Smith &lt;john@foo.com&gt;\n</code></pre>\n\n<p>What do I need to do so that it looks like this instead:</p>\n\n<pre><code>John Smith &lt;john@foo.com&gt;\n</code></pre>\n\n<p>I've set up SPF and DKIM according to the MailGun instructions and everything passes as being correct.  I've also used <code>SetDKIM(true)</code> when I'm sending out the mail.  Is there some setting I'm missing or additional validation I need to do?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1423448906, "last_edit_date": 1423448906, "creation_date": 1423446371, "answer_id": 28401634, "question_id": 28401111, "link": "https://stackoverflow.com/questions/28401111/control-fmt-parse-output-on-parsing-error/28401634#28401634", "title": "Control fmt.Parse output on Parsing Error", "body": "<p>The <a href=\"http://golang.org/pkg/flag/#pkg-variables\" rel=\"nofollow\"><code>flag.CommandLine</code></a> <em>variable</em> of type the <a href=\"http://golang.org/pkg/flag/#FlagSet\" rel=\"nofollow\"><code>FlagSet</code></a> is used to handle command line arguments if you use the functions of the <code>flag</code> package which are not methods of the <code>FlagSet</code> type.</p>\n\n<p>You can set the output (an <a href=\"http://golang.org/pkg/io/#Writer\" rel=\"nofollow\"><code>io.Writer</code></a>) where error messages are printed with the <a href=\"http://golang.org/pkg/flag/#FlagSet.SetOutput\" rel=\"nofollow\"><code>FlagSet.SetOutput()</code></a> method. You can set a <a href=\"http://golang.org/pkg/bytes/#Buffer\" rel=\"nofollow\"><code>bytes.Buffer</code></a> so messages will only end up in a buffer (and not on your console). Note that do not set <code>nil</code> as that means to print to the standard output (console).</p>\n\n<p>And call <a href=\"http://golang.org/pkg/flag/#FlagSet.Parse\" rel=\"nofollow\"><code>FlagSet.Parse()</code></a> yourself where you can pass <code>os.Args[1:]</code> as the arguments to be parsed. <code>FlagSet.Parse()</code> returns an <code>error</code> which you can handle yourself.</p>\n"}], "owner": {"reputation": 786, "user_id": 1208277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEhwo.jpg?s=128&g=1", "display_name": "Kerry Kobashi", "link": "https://stackoverflow.com/users/1208277/kerry-kobashi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1423448906, "creation_date": 1423441933, "last_edit_date": 1423442370, "question_id": 28401111, "link": "https://stackoverflow.com/questions/28401111/control-fmt-parse-output-on-parsing-error", "title": "Control fmt.Parse output on Parsing Error", "body": "<pre><code>var timesFlag int  \nflag.IntVar(&amp;timesFlag, \"times\", 1, \"Number of times to print\")\nflag.Parse()\n</code></pre>\n\n<p>If I run the program and type in prog -times=abc  (&lt;--- not an int)</p>\n\n<p>fmt.Parse spits out this ugly error message on the console:</p>\n\n<p><em>invalid value \"-abc\" for flag -times: strconv.ParseInt: parsing \"-abc\": invalid syntax</em></p>\n\n<p>Obviously, I can't prevent the user from typing in anything from the command line. The error looks like garbage to the user and needs to look more friendlier. How do I silent this error from going to stderr/stdout and detect there was an error generated?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 2263546, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gyfDa.jpg?s=128&g=1", "display_name": "Mmeyer", "link": "https://stackoverflow.com/users/2263546/mmeyer"}, "edited": false, "score": 0, "creation_date": 1423443974, "post_id": 28400563, "comment_id": 45138145, "body": "With your code I&#39;m getting a from 127.0.0.1:53236 - [] , but if I change buffer := make([]byte, 0, 1024) -&gt; buffer := make([]byte, 1024) works fine."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 361, "user_id": 2263546, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gyfDa.jpg?s=128&g=1", "display_name": "Mmeyer", "link": "https://stackoverflow.com/users/2263546/mmeyer"}, "edited": false, "score": 0, "creation_date": 1423679924, "post_id": 28400563, "comment_id": 45249608, "body": "Thanks, fixed. (I thought I said this before, but comment wasn&#39;t here when I came back, so...)"}, {"owner": {"reputation": 5627, "user_id": 2534090, "user_type": "registered", "accept_rate": 34, "profile_image": "https://i.stack.imgur.com/DeBhf.png?s=128&g=1", "display_name": "JavaTechnical", "link": "https://stackoverflow.com/users/2534090/javatechnical"}, "edited": false, "score": 0, "creation_date": 1592915628, "post_id": 28400563, "comment_id": 110590454, "body": "Is not the order of events lost, with this? (atleast the order as it is received to the program)"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 5627, "user_id": 2534090, "user_type": "registered", "accept_rate": 34, "profile_image": "https://i.stack.imgur.com/DeBhf.png?s=128&g=1", "display_name": "JavaTechnical", "link": "https://stackoverflow.com/users/2534090/javatechnical"}, "edited": false, "score": 0, "creation_date": 1592945690, "post_id": 28400563, "comment_id": 110606020, "body": "@JavaTechnical That&#39;s true--this isn&#39;t really right for applications trying to build persistent connections on top of UDP (like QUIC or such do) or otherwise do more than handle a packet at a time. Doing that correctly is a deep topic and might be material for a different question."}], "tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 6, "last_activity_date": 1423444249, "last_edit_date": 1423444249, "creation_date": 1423437639, "answer_id": 28400563, "question_id": 28400340, "link": "https://stackoverflow.com/questions/28400340/how-support-concurrent-connections-with-a-udp-server-using-go/28400563#28400563", "title": "How support concurrent connections with a UDP Server using go", "body": "<p>UDP <a href=\"http://en.wikipedia.org/wiki/Connectionless_communication\" rel=\"noreferrer\">is a connectionless protocol</a>--hosts send packets without establishing a connection first. </p>\n\n<p>To get multiple cores handling UDP packets in parallel, you might start a bunch of goroutines that each do the <code>ReadFromUDP</code> loop:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"net\"\n        \"runtime\"\n)\n\nfunc listen(connection *net.UDPConn, quit chan struct{}) {\n        buffer := make([]byte, 1024)\n        n, remoteAddr, err := 0, new(net.UDPAddr), error(nil)\n        for err == nil {\n                n, remoteAddr, err = connection.ReadFromUDP(buffer)\n                // you might copy out the contents of the packet here, to\n                // `var r myapp.Request`, say, and `go handleRequest(r)` (or\n                // send it down a channel) to free up the listening\n                // goroutine. you do *need* to copy then, though,\n                // because you've only made one buffer per listen().\n                fmt.Println(\"from\", remoteAddr, \"-\", buffer[:n])\n        }\n        fmt.Println(\"listener failed - \", err)\n        quit &lt;- struct{}{}\n}\n\nfunc main() {\n        addr := net.UDPAddr{\n                Port: 12345,\n                IP:   net.IP{127, 0, 0, 1},\n        }\n        connection, err := net.ListenUDP(\"udp\", &amp;addr)\n        if err != nil {\n                panic(err)\n        }\n        quit := make(chan struct{})\n        for i := 0; i &lt; runtime.NumCPU(); i++ {\n                go listen(connection, quit)\n        }\n        &lt;-quit // hang until an error\n}\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 2263546, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gyfDa.jpg?s=128&g=1", "display_name": "Mmeyer", "link": "https://stackoverflow.com/users/2263546/mmeyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3996, "favorite_count": 2, "accepted_answer_id": 28400563, "answer_count": 1, "score": 1, "last_activity_date": 1423444249, "creation_date": 1423436122, "question_id": 28400340, "link": "https://stackoverflow.com/questions/28400340/how-support-concurrent-connections-with-a-udp-server-using-go", "title": "How support concurrent connections with a UDP Server using go", "body": "<p>I'm playing with my first basic udp server and I wondering how support concurrent connections? I think with my code only can get a connection at a time in order to process it, with a tcp simple server the things seems to be more clear than on this case, throwing a goroutine to process the data, but here I'm  very lost, thanks in advance.</p>\n\n<pre><code>func main() {\n    ListenerUDP(\"127.0.0.1\", 1111)\n}\n\nfunc ListenerUDP(ip string, port int) {\n    buffer := make([]byte, 1024)\n\n    log.Println(\"Listener Started!\")\n    addr := net.UDPAddr{\n        Port: port,\n        IP:   net.ParseIP(ip),\n    }\n\n    conn, err := net.ListenUDP(\"udp\", &amp;addr)\n    if err != nil {\n        log.Fatalf(\"Error Listening:%s\\n\", err.Error())\n        panic(err)\n    }\n    defer conn.Close()\n\n    for {\n        _, remoteAddr, err := conn.ReadFromUDP(buffer[0:])\n        if err != nil {\n            log.Fatalf(\"Error:%s\\n\", err)\n        }\n        // Process data here? using a &gt; go something()?\n        fmt.Printf(\"Data:%s From:%v\\n\", buffer, remoteAddr)\n    }\n\n}\n</code></pre>\n"}, {"tags": ["go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1423463203, "creation_date": 1423463203, "answer_id": 28403951, "question_id": 28399837, "link": "https://stackoverflow.com/questions/28399837/error-importing-mgo-driver/28403951#28403951", "title": "Error importing mgo driver", "body": "<p>Based on the error messages, I suspect that you are running Go 1. Run <code>go version</code> to confirm.</p>\n\n<p>If you are running Go 1, then you will need to upgrade to a newer version of Go. I recommend installing the most recent official binary <a href=\"http://golang.org/doc/install\" rel=\"nofollow\">from golang.org</a>. At the time that I am writing this, the most recent version is 1.4.1.</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 4205126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c873309b710f6fb26ea8b1c7cce177d1?s=128&d=identicon&r=PG&f=1", "display_name": "Aman Kapoor", "link": "https://stackoverflow.com/users/4205126/aman-kapoor"}, "is_accepted": false, "score": 0, "last_activity_date": 1496850863, "creation_date": 1496850863, "answer_id": 44417517, "question_id": 28399837, "link": "https://stackoverflow.com/questions/28399837/error-importing-mgo-driver/44417517#44417517", "title": "Error importing mgo driver", "body": "<p>Update Go to the latest version by going to <a href=\"https://golang.org/dl/\" rel=\"nofollow noreferrer\">https://golang.org/dl/</a>. In case you worry about uninstallation of Go, all you need to do is delete the Go folder, that's it. This will most probably solve the problem. But if the problem persists, then send me the screenshot of the errors.</p>\n"}], "owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 907, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496850863, "creation_date": 1423432640, "question_id": 28399837, "link": "https://stackoverflow.com/questions/28399837/error-importing-mgo-driver", "title": "Error importing mgo driver", "body": "<p>I'm trying to use the mgo driver. I run </p>\n\n<pre><code>go get gopkg.in/mgo.v2\n</code></pre>\n\n<p>To get the package, but get these errors -</p>\n\n<pre><code># gopkg.in/mgo.v2/internal/scram\n/usr/local/go/src/pkg/gopkg.in/mgo.v2/internal/scram/scram.go:86: c.out.Grow undefined (type bytes.Buffer has no field or method Grow)\n/usr/local/go/src/pkg/gopkg.in/mgo.v2/internal/scram/scram.go:87: c.authMsg.Grow undefined (type bytes.Buffer has no field or method Grow)\n# gopkg.in/mgo.v2/bson\n/usr/local/go/src/pkg/gopkg.in/mgo.v2/bson/decode.go:246: k.Convert undefined (type reflect.Value has no field or method Convert)\n/usr/local/go/src/pkg/gopkg.in/mgo.v2/bson/encode.go:56: undefined: json.Number\n/usr/local/go/src/pkg/gopkg.in/mgo.v2/bson/encode.go:282: undefined: json.Number\n</code></pre>\n\n<p>Should I be doing something else? </p>\n"}, {"tags": ["pointers", "methods", "go", "struct"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1423419881, "last_edit_date": 1423419881, "creation_date": 1423419578, "answer_id": 28397597, "question_id": 28397240, "link": "https://stackoverflow.com/questions/28397240/setter-method-not-setting-struct-property-golang/28397597#28397597", "title": "Setter method not setting struct property Golang", "body": "<p>The problem is that you have a method <code>SetName()</code> which has a pointer receiver:</p>\n\n<pre><code>func (m *MammalImpl) SetName(s string)\n</code></pre>\n\n<p>So if you have a value of type <code>MammalImpl</code>, the method set of that value does not contain the <code>SetName()</code> method therefore it does not implement the <code>Mammal</code> interface.</p>\n\n<p>But the method set of a pointer to <code>MammalImpl</code> (<code>*MammalImpl</code>) will contain the <code>SetName()</code> method therefore it will implement the <code>Mammal</code> interface.</p>\n\n<p>So when you populate the <code>mammals</code> slice, you have to populate it with <code>*MammalImpl</code> values, because that is the one that implements the element type of the slice (which is <code>Mammal</code>). You can easily obtain a pointer to a <code>MammalImpl</code> if you already have a <code>MammalImpl</code> value: use the <a href=\"http://golang.org/ref/spec#Address_operators\" rel=\"nofollow\">address <code>&amp;</code> operator</a> to generate a pointer to the value:</p>\n\n<pre><code>mammals := []Mammal{\n    &amp;MammalImpl{1, \"Carnivorious\"},\n    &amp;MammalImpl{2, \"Ominivorious\"},\n}\n</code></pre>\n\n<p>Try your modified program on the <a href=\"http://play.golang.org/p/dIUAhXGRkL\" rel=\"nofollow\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 699, "user_id": 4154266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0964f7df27f9558bbe660eca1a7971ad?s=128&d=identicon&r=PG", "display_name": "Ikenna", "link": "https://stackoverflow.com/users/4154266/ikenna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1477, "favorite_count": 1, "accepted_answer_id": 28397597, "answer_count": 1, "score": 0, "last_activity_date": 1475403822, "creation_date": 1423417799, "last_edit_date": 1475403822, "question_id": 28397240, "link": "https://stackoverflow.com/questions/28397240/setter-method-not-setting-struct-property-golang", "title": "Setter method not setting struct property Golang", "body": "<p>I need help with understanding why this error is being thrown:</p>\n\n<p>I am using a pointer because I want it to update the field.</p>\n\n<blockquote>\n  <p>prog.go:56: cannot use MammalImpl literal (type MammalImpl) as type\n  Mammal in array element:  MammalImpl does not implement Mammal\n  (SetName method has pointer receiver) prog.go:57: cannot use\n  MammalImpl literal (type MammalImpl) as type Mammal in array element:\n    MammalImpl does not implement Mammal (SetName method has pointer\n  receiver)</p>\n</blockquote>\n\n<p>I am not sure why this is unable to set/override the name property as follows.</p>\n\n<pre><code> package main\n\nimport (\n    \"fmt\"\n)\n\ntype Mammal interface {\n    GetID() int\n    GetName() string\n    SetName(s string)\n}\n\ntype Human interface {\n    Mammal\n\n    GetHairColor() string\n}\n\ntype MammalImpl struct {\n    ID   int\n    Name string\n}\n\nfunc (m MammalImpl) GetID() int {\n    return m.ID\n}\n\nfunc (m MammalImpl) GetName() string {\n    return m.Name\n}\n\nfunc (m *MammalImpl) SetName(s string) {\n    m.Name = s\n}\n\ntype HumanImpl struct {\n    MammalImpl\n    HairColor string\n}\n\nfunc (h HumanImpl) GetHairColor() string {\n    return h.HairColor\n}\n\nfunc Names(ms []Mammal) *[]string {\n    names := make([]string, len(ms))\n    for i, m := range ms {\n        m.SetName(\"Herbivorous\") // This modification is not having any effect and throws and error\n        names[i] = m.GetName()\n    }\n    return &amp;names\n}\n\nfunc main() {\n    mammals := []Mammal{\n        MammalImpl{1, \"Carnivorious\"},\n        MammalImpl{2, \"Ominivorious\"},\n    }\n\n    numberOfMammalNames := Names(mammals)\n    fmt.Println(numberOfMammalNames)\n}\n</code></pre>\n\n<p>Go Playground code is here <a href=\"http://play.golang.org/p/EyJBY3rH23\" rel=\"nofollow\">http://play.golang.org/p/EyJBY3rH23</a></p>\n"}, {"tags": ["intellij-idea", "go"], "answers": [{"comments": [{"owner": {"reputation": 2058, "user_id": 1821692, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/aXNO2.jpg?s=128&g=1", "display_name": "feeeper", "link": "https://stackoverflow.com/users/1821692/feeeper"}, "edited": false, "score": 0, "creation_date": 1474389515, "post_id": 28410581, "comment_id": 66507314, "body": "I have same problem with PyCharm 2016.2.3 Community Edition, Go Plugin 0.12.1799, Go 1.7, Windows 10"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 2058, "user_id": 1821692, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/aXNO2.jpg?s=128&g=1", "display_name": "feeeper", "link": "https://stackoverflow.com/users/1821692/feeeper"}, "edited": false, "score": 0, "creation_date": 1474489332, "post_id": 28410581, "comment_id": 66557088, "body": "Please open an issue on the bug tracker, it&#39;s impossible to tell what&#39;s the problem (or solution) without a having more details. Thanks."}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": false, "score": 0, "last_activity_date": 1423487312, "creation_date": 1423487312, "answer_id": 28410581, "question_id": 28395891, "link": "https://stackoverflow.com/questions/28395891/intellij-unresolved-symbol-for-go-lang-project/28410581#28410581", "title": "intellij unresolved symbol for go lang project", "body": "<p>As I have no information about which plugin version you are using I'm going to assume that you have 0.9.15.3 release.</p>\n\n<p>The fastest way to fix it would be to use one of the early releases for 1.0.0, available here: <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/releases\" rel=\"nofollow\">github releases page for go plugin for intellij idea</a></p>\n\n<p>The plugin is currently under a major refactoring and we've started releasing preview builds for it. While the alpha name might be scary, I'm using it daily at work and it's very stable but not everything is up on par with the quality we want it to have.</p>\n\n<p>If you have any further questions, either ask here or browse in the <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues?q=is%3Aopen%20is%3Aissue%20milestone%3A1.0.0\" rel=\"nofollow\">issue tracker</a></p>\n\n<p>Also, there's a small community on <a href=\"https://gitter.im/go-lang-plugin-org/go-lang-idea-plugin\" rel=\"nofollow\">Gitter</a> and you may get answers from there as well.</p>\n"}], "owner": {"reputation": 1001, "user_id": 4160965, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/fbb0ff599a13cc579cbac731d8d38a81?s=128&d=identicon&r=PG&f=1", "display_name": "want_to_be_calm", "link": "https://stackoverflow.com/users/4160965/want-to-be-calm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2324, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1423487312, "creation_date": 1423410228, "question_id": 28395891, "link": "https://stackoverflow.com/questions/28395891/intellij-unresolved-symbol-for-go-lang-project", "title": "intellij unresolved symbol for go lang project", "body": "<p>I am using go sdk 1.2.1 linux/386 in intellij 14.0.3. However, when I open a golang project many function and variable are unresolved. I do not what is wrong with intellij. Anything that I can do to make the unresolved symbol solved. I have met the problems before. but I do not know to to solve it. Anyone have met the same problem before? Please help. \nThanks.</p>\n"}, {"tags": ["windows", "build", "go"], "comments": [{"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 1, "creation_date": 1423414906, "post_id": 28395808, "comment_id": 45129327, "body": "If main.go has a main() function, it should build the executable and call it sub1.exe in Windows. Isn&#39;t sub1.exe what you are looking for? Remove it and run <code>go build</code> again to see if it is created."}, {"owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "reply_to_user": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1423463883, "post_id": 28395808, "comment_id": 45142756, "body": "Hm, there is no executable. I am in the directory of the package. I am using Windows, but building from cygwin commandline. But even when using Windows cmd, there is no executable."}], "answers": [{"comments": [{"owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "edited": false, "score": 0, "creation_date": 1423463945, "post_id": 28400955, "comment_id": 45142788, "body": "So, it&#39;s not possible to have a main() in a package other than main?"}, {"owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "edited": false, "score": 0, "creation_date": 1423464245, "post_id": 28400955, "comment_id": 45142887, "body": "The link is what I meant. It&#39;s a new main package in a project."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "edited": false, "score": 0, "creation_date": 1423475765, "post_id": 28400955, "comment_id": 45148047, "body": "I have to admit I do not understand your question. Any package which is declared <code>package main</code> must have a <code>main()</code> function and the go tool will build such a package into an executable and the main() function will be called when you run the executable. Regarding camget: camget is such a <code>package main</code> package and it contains a main() function an it is built into an executable. It does not matter if other packages, other non-main-packages, completely unrelated stuff to Go or whatever lives in other directories (higher up, siblings or subfolders)."}, {"owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "edited": false, "score": 0, "creation_date": 1423476042, "post_id": 28400955, "comment_id": 45148219, "body": "My misunderstanding was, that I thought I could build packages into executable binaries, if the packages provided a <code>main()</code>, regardless of whether the package is <code>main</code> or <code>cmd</code> or <code>xxx</code>. I thought the <code>main()</code> decided whether there is an executable."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "edited": false, "score": 0, "creation_date": 1423476864, "post_id": 28400955, "comment_id": 45148749, "body": "No, it is <code>package main</code> <i>and</i> <code>func main() {</code> for an executable."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 6, "last_activity_date": 1423440666, "creation_date": 1423440666, "answer_id": 28400955, "question_id": 28395808, "link": "https://stackoverflow.com/questions/28395808/how-to-build-binary-in-package-in-golang/28400955#28400955", "title": "How to build binary in package in Golang?", "body": "<p>It doesn't matter if you name your file <code>main.go</code> or <code>shubudoo.go</code>. The only thing what matters if you want to build an executable (a command) is that your files start with <code>package main</code>. One more thing: Go has <strong>absolutely</strong> <strong>no</strong> notion of \"subpackage\": All packages are equal for the compiler. The filesystem nesting is for your convenience only.</p>\n"}], "owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9482, "favorite_count": 0, "accepted_answer_id": 28400955, "answer_count": 1, "score": 5, "last_activity_date": 1423468583, "creation_date": 1423409757, "last_edit_date": 1423468583, "question_id": 28395808, "link": "https://stackoverflow.com/questions/28395808/how-to-build-binary-in-package-in-golang", "title": "How to build binary in package in Golang?", "body": "<p>I have a project in github.com/user called project:</p>\n\n<pre><code>src/\n    github.com/user/project\n        sub1/\n            main.go\n            sub1.exe (??)\n        sub2/\n            main.go\n            sub2.exe (??)\n</code></pre>\n\n<p>I am trying to compile the package in my project. When I:</p>\n\n<pre><code>$ cd github.com/user/project/sub1\n$ go build\n</code></pre>\n\n<p>Nothing happens. go build seems to finish without complaining, but there is no executable file. How can I build packages into executable?</p>\n\n<p>\"go version go1.3 windows/amd64\"</p>\n"}, {"tags": ["generics", "go", "struct", "interface"], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 4154266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0964f7df27f9558bbe660eca1a7971ad?s=128&d=identicon&r=PG", "display_name": "Ikenna", "link": "https://stackoverflow.com/users/4154266/ikenna"}, "edited": false, "score": 0, "creation_date": 1423403998, "post_id": 28393465, "comment_id": 45125919, "body": "Thanks a million icza"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1494345422, "last_edit_date": 1494345422, "creation_date": 1423395368, "answer_id": 28393465, "question_id": 28393166, "link": "https://stackoverflow.com/questions/28393166/generic-method-parameters-in-golang/28393465#28393465", "title": "Generic Method Parameters in Golang", "body": "<p>Use interfaces instead of concrete types, and use <a href=\"http://golang.org/ref/spec#Interface_types\" rel=\"nofollow noreferrer\">embedded interfaces</a> so the common methods do not have to be listed in both types:</p>\n\n<pre><code>type Mammal interface {\n    GetID() int\n    GetName() string\n}\n\ntype Human interface {\n    Mammal\n\n    GetHairColor() string\n}\n</code></pre>\n\n<p>And here is the implementation of these interfaces based on your code which uses <a href=\"http://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">embedded types</a> (structs):</p>\n\n<pre><code>type MammalImpl struct {\n    ID   int\n    Name string\n}\n\nfunc (m MammalImpl) GetID() int {\n    return m.ID\n}\n\nfunc (m MammalImpl) GetName() string {\n    return m.Name\n}\n\ntype HumanImpl struct {\n    MammalImpl\n    HairColor string\n}\n\nfunc (h HumanImpl) GetHairColor() string {\n    return h.HairColor\n}\n</code></pre>\n\n<p>But then of course in your <code>Count()</code> function you can only refer to the method and not the field of the implementation:</p>\n\n<pre><code>IDs[i] = strconv.Itoa(m.GetID())  // Access ID via the method: GetID()\n</code></pre>\n\n<p>And creating your slices of Mammals and Humans:</p>\n\n<pre><code>mammals := []Mammal{\n    MammalImpl{1, \"Carnivorious\"},\n    MammalImpl{2, \"Ominivorious\"},\n}\n\nhumans := []Mammal{\n    HumanImpl{MammalImpl: MammalImpl{ID: 1, Name: \"Peter\"}, HairColor: \"Black\"},\n    HumanImpl{MammalImpl: MammalImpl{ID: 2, Name: \"Paul\"}, HairColor: \"Red\"},\n}\n</code></pre>\n\n<p>Here is the complete working code on <a href=\"http://play.golang.org/p/kK07ntIxZJ\" rel=\"nofollow noreferrer\"><strong>Go Playground</strong></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 699, "user_id": 4154266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0964f7df27f9558bbe660eca1a7971ad?s=128&d=identicon&r=PG", "display_name": "Ikenna", "link": "https://stackoverflow.com/users/4154266/ikenna"}, "edited": false, "score": 0, "creation_date": 1423403982, "post_id": 28393607, "comment_id": 45125910, "body": "Thanks a million Uvelichitel"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 6, "last_activity_date": 1556438161, "last_edit_date": 1556438161, "creation_date": 1423396428, "answer_id": 28393607, "question_id": 28393166, "link": "https://stackoverflow.com/questions/28393166/generic-method-parameters-in-golang/28393607#28393607", "title": "Generic Method Parameters in Golang", "body": "<p>You can't do precisely what you ask for in Go. Closest way to do things in Go would be something like this as shown in code below:</p>\n\n<pre><code>type Ids interface{\n  Id() int\n}\n\nfunc (this Mammal) Id() int{\n  return this.ID\n} \n\nfunc (this Human) Id() int{\n  return this.ID\n} \n\n\nfunc Count(ms []Ids) *[]string {\n...\n    IDs[i] = strconv.Itoa(int(m.Id()))\n...\n}\n\nfunc main(){\n  mammals := []Ids{\n    Mammal{1, \"Carnivorious\"},\n    Mammal{2, \"Ominivorious\"},\n  }\n\n  humans := []Ids{\n    Human{ID:1, Name: \"Peter\", HairColor: \"Black\"},\n    Human{ID:2, Name: \"Paul\", HairColor: \"Red\"},\n  }\n  ...\n}  \n</code></pre>\n\n<p>here is the working <a href=\"https://play.golang.org/p/MYO7PKfwjL\" rel=\"nofollow noreferrer\">example</a></p>\n"}], "owner": {"reputation": 699, "user_id": 4154266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0964f7df27f9558bbe660eca1a7971ad?s=128&d=identicon&r=PG", "display_name": "Ikenna", "link": "https://stackoverflow.com/users/4154266/ikenna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8869, "favorite_count": 2, "accepted_answer_id": 28393465, "answer_count": 2, "score": 7, "last_activity_date": 1556438161, "creation_date": 1423393182, "last_edit_date": 1467113939, "question_id": 28393166, "link": "https://stackoverflow.com/questions/28393166/generic-method-parameters-in-golang", "title": "Generic Method Parameters in Golang", "body": "<p>I need help with making this work for any type. </p>\n\n<p>I have got a function I need to accept other types that have <code>ID</code> property. </p>\n\n<p>I have tried using interfaces but that did not work for my <code>ID</code> property case. Here is the code:</p>\n\n<pre><code>package main\n\n\nimport (\n  \"fmt\"\n  \"strconv\"\n  )\n\ntype Mammal struct{\n  ID int\n  Name string \n}\n\ntype Human struct {  \n  ID int\n  Name string \n  HairColor string\n}\n\nfunc Count(ms []Mammal) *[]string { // How can i get this function to accept any type not just []Mammal\n   IDs := make([]string, len(ms))\n   for i, m := range ms {\n     IDs[i] = strconv.Itoa(int(m.ID))\n   }\n   return &amp;IDs\n}\n\nfunc main(){\n  mammals := []Mammal{\n    Mammal{1, \"Carnivorious\"},\n    Mammal{2, \"Ominivorious\"},\n  }\n\n  humans := []Human{\n    Human{ID:1, Name: \"Peter\", HairColor: \"Black\"},\n    Human{ID:2, Name: \"Paul\", HairColor: \"Red\"},\n  } \n  numberOfMammalIDs := Count(mammals)\n  numberOfHumanIDs := Count(humans)\n  fmt.Println(numberOfMammalIDs)\n  fmt.Println(numberOfHumanIDs)\n}\n</code></pre>\n\n<p>I get this</p>\n\n<blockquote>\n  <p>error prog.go:39: cannot use humans (type []Human) as type []Mammal in argument to Count</p>\n</blockquote>\n\n<p>See Go Playground for more details here <a href=\"http://play.golang.org/p/xzWgjkzcmH\" rel=\"noreferrer\">http://play.golang.org/p/xzWgjkzcmH</a></p>\n"}, {"tags": ["javascript", "html", "qt", "go", "qt5"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1448902801, "post_id": 28391179, "comment_id": 55763440, "body": "Are you running Go on the client side, or on the server?"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 4542316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OMGh3LX21-U/AAAAAAAAAAI/AAAAAAAAABM/cD6Ke9uAj8Q/photo.jpg?sz=128", "display_name": "Green Bird", "link": "https://stackoverflow.com/users/4542316/green-bird"}, "edited": false, "score": 0, "creation_date": 1423394903, "post_id": 28391773, "comment_id": 45123466, "body": "Is there any example to get elements or submit forms from a target URL"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 61, "user_id": 4542316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OMGh3LX21-U/AAAAAAAAAAI/AAAAAAAAABM/cD6Ke9uAj8Q/photo.jpg?sz=128", "display_name": "Green Bird", "link": "https://stackoverflow.com/users/4542316/green-bird"}, "edited": false, "score": 0, "creation_date": 1423395205, "post_id": 28391773, "comment_id": 45123540, "body": "@GreenBird not directly from the gpoherjs project itself (<a href=\"https://github.com/gopherjs/gopherjs/search?q=post&amp;type=Code&amp;utf8=%E2%9C%93\" rel=\"nofollow noreferrer\">github.com/gopherjs/gopherjs/&hellip;</a>)"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 61, "user_id": 4542316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OMGh3LX21-U/AAAAAAAAAAI/AAAAAAAAABM/cD6Ke9uAj8Q/photo.jpg?sz=128", "display_name": "Green Bird", "link": "https://stackoverflow.com/users/4542316/green-bird"}, "edited": false, "score": 0, "creation_date": 1423399020, "post_id": 28391773, "comment_id": 45124498, "body": "@GreenBird although my older answer <a href=\"http://stackoverflow.com/a/27034623/6309\">stackoverflow.com/a/27034623/6309</a> is about POST."}, {"owner": {"reputation": 61, "user_id": 4542316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OMGh3LX21-U/AAAAAAAAAAI/AAAAAAAAABM/cD6Ke9uAj8Q/photo.jpg?sz=128", "display_name": "Green Bird", "link": "https://stackoverflow.com/users/4542316/green-bird"}, "edited": false, "score": 0, "creation_date": 1423401132, "post_id": 28391773, "comment_id": 45125105, "body": "I found <a href=\"https://github.com/sourcegraph/webloop\" rel=\"nofollow noreferrer\">this</a>, it&#39;s not as easy as I thought since I am using windows."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 2, "last_activity_date": 1423381669, "creation_date": 1423381669, "answer_id": 28391773, "question_id": 28391179, "link": "https://stackoverflow.com/questions/28391179/how-to-use-javascript-in-golang-to-get-a-specific-website-elements-or-submit-for/28391773#28391773", "title": "How to use javascript in Golang to get a specific website elements or submit forms", "body": "<blockquote>\n  <p>How can I use javascript in Golang</p>\n</blockquote>\n\n<p>You can use <a href=\"https://github.com/gopherjs/gopherjs\" rel=\"nofollow\"><strong>gopherjs</strong></a>, a compiler from Go to JavaScript.</p>\n\n<p>You can see an example in the <a href=\"https://github.com/tidwall/digitalrain\" rel=\"nofollow\"><code>tidwall/digitalrain</code></a> project, where the <a href=\"https://github.com/tidwall/digitalrain/blob/8a6813628b4ee1642765923f6eff4fbed226193b/digitalrain.go\" rel=\"nofollow\"><code>digitalrain.go</code></a> file access html elements</p>\n\n<pre><code>js.Global.Get(\"document\").Get(\"head\").Call(\"appendChild\", sheet)\njs.Global.Get(\"document\").Set(\"title\", \"whoa\")\n</code></pre>\n\n<p>(for <a href=\"http://tidwall.github.io/digitalrain/\" rel=\"nofollow\">a great effect</a>)</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 3162144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d800b8b936b3e09a4f9765002db66bb?s=128&d=identicon&r=PG&f=1", "display_name": "user3162144", "link": "https://stackoverflow.com/users/3162144/user3162144"}, "is_accepted": false, "score": 1, "last_activity_date": 1423917578, "creation_date": 1423917578, "answer_id": 28515720, "question_id": 28391179, "link": "https://stackoverflow.com/questions/28391179/how-to-use-javascript-in-golang-to-get-a-specific-website-elements-or-submit-for/28515720#28515720", "title": "How to use javascript in Golang to get a specific website elements or submit forms", "body": "<p>If you like to run JS code in Go, try Otto (<a href=\"https://github.com/robertkrimen/otto\" rel=\"nofollow\">https://github.com/robertkrimen/otto</a>), it's a JS VM written in Go and very powerful.</p>\n"}], "owner": {"reputation": 61, "user_id": 4542316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OMGh3LX21-U/AAAAAAAAAAI/AAAAAAAAABM/cD6Ke9uAj8Q/photo.jpg?sz=128", "display_name": "Green Bird", "link": "https://stackoverflow.com/users/4542316/green-bird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6316, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1423917578, "creation_date": 1423376141, "question_id": 28391179, "link": "https://stackoverflow.com/questions/28391179/how-to-use-javascript-in-golang-to-get-a-specific-website-elements-or-submit-for", "title": "How to use javascript in Golang to get a specific website elements or submit forms", "body": "<p>I used Qt before Golang, I can use javascript in Qt like this: </p>\n\n<pre><code>QWebView* view = new QWebView(parent);\nview-&gt;load(QUrl(\"http://www.example.com\"));\nQString cmd(\"example.value = \\\"test\\\"\"); //using javascript to fill value\nview-&gt;page()-&gt;mainFrame()-&gt;evaluateJavaScript(cmd);\n\nQString cmd2(\"document.forms[\\\"Form1\\\"].submit()\");//using javascript to submit a Form\nQVariant result = view-&gt;page()-&gt;mainFrame()-&gt;evaluateJavaScript(cmd2);\nqDebug() &lt;&lt; result.toString(); //get javascript return data\n</code></pre>\n\n<p>How can I use javascript in Golang to get a specific website elements or submit forms.</p>\n"}, {"tags": ["sqlite", "go"], "comments": [{"owner": {"reputation": 12677, "user_id": 220710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3616fa71abd6c30910910d4d439470?s=128&d=identicon&r=PG", "display_name": "Emil Davtyan", "link": "https://stackoverflow.com/users/220710/emil-davtyan"}, "edited": false, "score": 1, "creation_date": 1423352149, "post_id": 28388783, "comment_id": 45115102, "body": "Have you tried writing some benchmarks? <a href=\"http://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\">golang.org/pkg/testing</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1423383025, "creation_date": 1423383025, "answer_id": 28391913, "question_id": 28388783, "link": "https://stackoverflow.com/questions/28388783/is-mattn-go-sqlite3s-regexp-extension-faster-than-sqlite3s-like-operator-for/28391913#28391913", "title": "Is mattn/go-sqlite3&#39;s regexp extension faster than sqlite3&#39;s LIKE operator for &#39;%word%&#39; searches?", "body": "<p>The <a href=\"https://github.com/mattn/go-sqlite3\" rel=\"nofollow\"><code>mattn/go-sqlite3</code></a> project itself has already quite a few example of <a href=\"https://github.com/mattn/go-sqlite3/blob/25d045f12a64283630fdedec899655cc5710b683/sqlite3_test/sqltest.go#L360-L382\" rel=\"nofollow\"><code>SELECT</code> benchmarks</a></p>\n\n<pre><code>func BenchmarkRows(b *testing.B) {\n    db.once.Do(makeBench)\n    for n := 0; n &lt; b.N; n++ {\n    var n sql.NullString\n    var i int\n    var f float64\n    var s string\n    var t time.Time\n    r, err := db.Query(\"select * from bench\")\n    if err != nil {\n        panic(err)\n    }\n    ...\n}\n</code></pre>\n\n<p>You can adapt them for your specific tests.</p>\n"}], "owner": {"reputation": 970, "user_id": 2807904, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/74cf72489d0114349f7c5e0966ba6e05?s=128&d=identicon&r=PG&f=1", "display_name": "irregular", "link": "https://stackoverflow.com/users/2807904/irregular"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1423383025, "creation_date": 1423351972, "question_id": 28388783, "link": "https://stackoverflow.com/questions/28388783/is-mattn-go-sqlite3s-regexp-extension-faster-than-sqlite3s-like-operator-for", "title": "Is mattn/go-sqlite3&#39;s regexp extension faster than sqlite3&#39;s LIKE operator for &#39;%word%&#39; searches?", "body": "<p>I am currently using mattn's go-sqlite3 package and am looking to do many select statement searches with LIKE '%word%' conditions. Is mattn's regexp extension faster than the sqlite's built in LIKE operator? (more specifically for LIKE '%word%' searches)</p>\n"}, {"tags": ["process", "go", "child-process", "kill-process", "sigint"], "answers": [{"comments": [{"owner": {"reputation": 947, "user_id": 1544418, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/91dd51f38be716f8c29da7f4f656bc16?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/1544418/ethan"}, "edited": false, "score": 0, "creation_date": 1423427741, "post_id": 28391864, "comment_id": 45133750, "body": "Unfortunately this doesn&#39;t help. The problem isn&#39;t that the process doesn&#39;t have handlers for the signal, but rather the signals don&#39;t get to the process at all, since it&#39;s in this weird state of having been restarted by its child.  It&#39;s like the terminal has lost its hook to the process, but the pgid&#39;s have not changed."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1423382533, "creation_date": 1423382533, "answer_id": 28391864, "question_id": 28388758, "link": "https://stackoverflow.com/questions/28388758/golang-restarted-parent-process-doesnt-receive-sigint/28391864#28391864", "title": "golang restarted parent process doesn&#39;t receive SIGINT", "body": "<p>You can check out the approach taken by two http server frameworks in order to listen and intercept signals (including <code>SIGINT</code>, or even <code>SIGTERM</code>)</p>\n\n<ul>\n<li><p><a href=\"https://github.com/kornel661/nserv\" rel=\"nofollow\"><strong><code>kornel661/nserv</code></strong></a>, where the <a href=\"https://github.com/kornel661/nserv/blob/538bf3d952c213142b8615f6a0c56e58d13934e5/ZeroDowntime-example/server.go\" rel=\"nofollow\"><code>ZeroDowntime-example/server.go</code></a> uses a channel:</p>\n\n<pre><code>// catch signals:\nsignals := make(chan os.Signal)\nsignal.Notify(signals, os.Interrupt, os.Kill)\n</code></pre></li>\n<li><p><a href=\"https://github.com/zenazn/goji\" rel=\"nofollow\"><strong><code>zenazn/goji</code></strong></a>, where <a href=\"https://github.com/zenazn/goji/blob/72199883d9fd7f1e89e660d45fedbf11fc55ab1d/graceful/signal.go\" rel=\"nofollow\"><code>graceful/signal.go</code></a> uses a similar approach:</p>\n\n<pre><code>var stdSignals = []os.Signal{syscall.SIGINT, syscall.SIGTERM}\nvar sigchan = make(chan os.Signal, 1)\nfunc init() {\n    go waitForSignal()\n}\n</code></pre></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 947, "user_id": 1544418, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/91dd51f38be716f8c29da7f4f656bc16?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/1544418/ethan"}, "edited": false, "score": 0, "creation_date": 1423527262, "post_id": 28402692, "comment_id": 45176913, "body": "Yup. I was trying to understand if it&#39;s possible to keep the terminal hooked to the process group even though the parent died. it&#39;s not. So the solution is have A start A&#39;, and let D kill and restart A&#39;, and just let A block so the terminal can signal the whole group"}], "tags": [], "owner": {"reputation": 1051, "user_id": 809410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ffc49c668c0066df3196ecf48aa39f?s=128&d=identicon&r=PG", "display_name": "iant", "link": "https://stackoverflow.com/users/809410/iant"}, "is_accepted": false, "score": 1, "last_activity_date": 1423454904, "creation_date": 1423454904, "answer_id": 28402692, "question_id": 28388758, "link": "https://stackoverflow.com/questions/28388758/golang-restarted-parent-process-doesnt-receive-sigint/28402692#28402692", "title": "golang restarted parent process doesn&#39;t receive SIGINT", "body": "<p>This doesn't really have anything to do with Go.  You start process A from your terminal shell.  Process A starts process D (not sure what happened to B, but never mind).  Process D kills process A.  Now your shell sees that the process it started has exited, so the shell prepares to listen to another command.  Process D starts another copy of process A, but the shell doesn't know anything about it.  When you type ^C, the shell will handle it.  If you run another program, the shell will arrange so that ^C goes to that program.  The shell knows nothing about your copy of process A, so it's never going to direct a ^C to that process.</p>\n"}], "owner": {"reputation": 947, "user_id": 1544418, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/91dd51f38be716f8c29da7f4f656bc16?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/1544418/ethan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1423454904, "creation_date": 1423351819, "question_id": 28388758, "link": "https://stackoverflow.com/questions/28388758/golang-restarted-parent-process-doesnt-receive-sigint", "title": "golang restarted parent process doesn&#39;t receive SIGINT", "body": "<p>I'm writing a little program to manage restarts to other processes.</p>\n\n<p>Basically when an app process starts (call it A), it spawns a new process (call it D), which has a simple HTTP server. When D receives an http request, it kills A and restarts it.</p>\n\n<p>Problem is, A now doesn't respond to CTRL-C, and I'm not sure why. It may be something simple or maybe I don't really understand the relationship between processes, the terminal, and signals. But it's running in the same terminal with the same stdin/stdout/stderr. Below is a full program demonstrating this behaviour.</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n    \"os/exec\"\n    \"strconv\"\n    \"time\"\n)\n\n/*\n    Running this program starts an app (repeatdly prints 'hi') and spawns a new process running a simple HTTP server\n    When the server receives a request, it kills the other process and restarts it.\n    All three processes use the same stdin/stdout/stderr.\n    The restarted process does not respond to CTRL-C :(\n*/\n\nvar serv = flag.Bool(\"serv\", false, \"run server\")\n\n// run the app or run the server\nfunc main() {\n    flag.Parse()\n    if *serv {\n        runServer()\n    } else {\n        runApp()\n    }\n}\n\n// handle request to server\n// url should contain pid of process to restart\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    pid, err := strconv.Atoi(r.URL.Path[1:])\n    if err != nil {\n        log.Println(\"send a number...\")\n    }\n    // find the process\n    proc, err := os.FindProcess(pid)\n    if err != nil {\n        log.Println(\"can't find proc\", pid)\n        return\n    }\n    // terminate the process\n    log.Println(\"Terminating the process...\")\n    err = proc.Signal(os.Interrupt)\n    if err != nil {\n        log.Println(\"failed to signal interupt\")\n        return\n    }\n    // restart the process\n    cmd := exec.Command(\"restarter\")\n    cmd.Stdin = os.Stdin\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    if err := cmd.Start(); err != nil {\n        log.Println(\"Failed to restart app\")\n        return\n    }\n    log.Println(\"Process restarted\")\n}\n\n// run the server.\n// this will only work the first time and that's fine\nfunc runServer() {\n    http.HandleFunc(\"/\", handler)\n    if err := http.ListenAndServe(\":9999\", nil); err != nil {\n        log.Println(err)\n    }\n}\n\n// the app prints 'hi' in a loop\n// but first it spawns a child process which runs the server\nfunc runApp() {\n    cmd := exec.Command(\"restarter\", \"-serv\")\n    cmd.Stdin = os.Stdin\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    if err := cmd.Start(); err != nil {\n        log.Println(err)\n    }\n\n    log.Println(\"This is my process. It goes like this\")\n    log.Println(\"PID:\", os.Getpid())\n    for {\n        time.Sleep(time.Second)\n        log.Println(\"hi again\")\n    }\n}\n</code></pre>\n\n<p>The program expects to be installed. For convenience you can fetch it with <code>go get github.com/ebuchman/restarter</code>.</p>\n\n<p>Run the program with <code>restarter</code>. It should print its process id. Then <code>curl http://localhost:9999/&lt;procid&gt;</code> to initiate the restart. The new process will now not respond to CTRL-C. Why? What am I missing?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 1, "creation_date": 1423492423, "post_id": 28388710, "comment_id": 45157637, "body": "Is this a satisfactory solution? My concern is that there is a risk of unintentionally interchanging times with a timezone and times without. Ideally, they would be different types so that the compiler would enforce correct conversion. This is the sense in which JodaTime has &#39;local&#39; types."}, {"owner": {"reputation": 1739, "user_id": 57357, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/46b892c9b15be26fec41fe9112410d5f?s=128&d=identicon&r=PG", "display_name": "Dan Tanner", "link": "https://stackoverflow.com/users/57357/dan-tanner"}, "edited": false, "score": 1, "creation_date": 1423584700, "post_id": 28388710, "comment_id": 45202733, "body": "Emil answered my question, so I marked it as accepted.  As to the current situation, I completely agree that it is not a good solution when you need to work with dates that aren&#39;t a single point in time.  Ideally there&#39;d be a Date type that just represents year/month/day, and correlates with the SQL DATE type."}], "tags": [], "owner": {"reputation": 12677, "user_id": 220710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3616fa71abd6c30910910d4d439470?s=128&d=identicon&r=PG", "display_name": "Emil Davtyan", "link": "https://stackoverflow.com/users/220710/emil-davtyan"}, "is_accepted": true, "score": 1, "last_activity_date": 1423351533, "creation_date": 1423351533, "answer_id": 28388710, "question_id": 28388554, "link": "https://stackoverflow.com/questions/28388554/does-golang-have-a-local-date-concept/28388710#28388710", "title": "Does golang have a local date concept?", "body": "<p>The package you refer to uses UTC :</p>\n\n<blockquote>\n  <p>This chronology will be set internally to be in the UTC time zone for all calculations.</p>\n</blockquote>\n\n<p>You can simply <a href=\"http://golang.org/pkg/time/#Time.UTC\" rel=\"nofollow\">get the UTC time</a> using the <code>time</code> package and do calculations on that.</p>\n"}], "owner": {"reputation": 1739, "user_id": 57357, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/46b892c9b15be26fec41fe9112410d5f?s=128&d=identicon&r=PG", "display_name": "Dan Tanner", "link": "https://stackoverflow.com/users/57357/dan-tanner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 0, "accepted_answer_id": 28388710, "answer_count": 1, "score": 1, "last_activity_date": 1423351533, "creation_date": 1423350414, "question_id": 28388554, "link": "https://stackoverflow.com/questions/28388554/does-golang-have-a-local-date-concept", "title": "Does golang have a local date concept?", "body": "<p>Does golang's time package (or any other library) support the concept of a local date?<br>\nBy local date, I'm referring to the concept supported by <a href=\"http://joda-time.sourceforge.net/apidocs/org/joda/time/LocalDate.html\" rel=\"nofollow\">joda time</a>, which is a date without a time or timezone.</p>\n"}, {"tags": ["testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1423345854, "post_id": 28387616, "comment_id": 45113183, "body": "Yeah, I was afraid I might have to do that... oh well."}], "tags": [], "owner": {"reputation": 12677, "user_id": 220710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3616fa71abd6c30910910d4d439470?s=128&d=identicon&r=PG", "display_name": "Emil Davtyan", "link": "https://stackoverflow.com/users/220710/emil-davtyan"}, "is_accepted": false, "score": 2, "last_activity_date": 1423345226, "last_edit_date": 1423345226, "creation_date": 1423344662, "answer_id": 28387616, "question_id": 28387378, "link": "https://stackoverflow.com/questions/28387378/go-test-file-for-specific-os-or-architecture/28387616#28387616", "title": "Go test file for specific OS or architecture", "body": "<p>Just use a <a href=\"http://golang.org/pkg/go/build/\" rel=\"nofollow\">build constraint</a> on the test files. </p>\n\n<pre><code>// +build windows\n</code></pre>\n\n<blockquote>\n  <p>A build constraint is evaluated as the OR of space-separated options; each option evaluates as the AND of its comma-separated terms; and each term is an alphanumeric word or, preceded by !, its negation. That is, the build constraint:</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "reply_to_user": {"reputation": 19673, "user_id": 145435, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/824b41e6108a22c4c96f50ee23419369?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/145435/matt"}, "edited": false, "score": 0, "creation_date": 1520044981, "post_id": 28388233, "comment_id": 85166024, "body": "I don&#39;t remember, sorry. This was a long time ago. Try them both and see which one works, I guess?"}], "tags": [], "owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "is_accepted": false, "score": 2, "last_activity_date": 1423348306, "creation_date": 1423348306, "answer_id": 28388233, "question_id": 28387378, "link": "https://stackoverflow.com/questions/28387378/go-test-file-for-specific-os-or-architecture/28388233#28388233", "title": "Go test file for specific OS or architecture", "body": "<p>Turns out I was wrong. It does work. The issue was that I also had a file called <code>foo_unix_test.go</code>, and apparently Go doesn't support the <code>*_unix.go</code> syntax as a special case.</p>\n"}], "owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1678, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1423348306, "creation_date": 1423343114, "question_id": 28387378, "link": "https://stackoverflow.com/questions/28387378/go-test-file-for-specific-os-or-architecture", "title": "Go test file for specific OS or architecture", "body": "<p>In Go, filenames have semantic meaning. For example:</p>\n\n<pre><code>*_windows.go // Only include in compilations for Windows\n*_unix.go    // Only include in compilations for Unix\n*_386.go     // Only include in compilations for 386 systems\n*_test.go    // Only include when run with `go test`\n</code></pre>\n\n<p>However, I can't seem to get the following to work:</p>\n\n<pre><code>*_windows_test.go // Only include when running `go test` on windows\n*_test_windows.go // Another attempt\n</code></pre>\n\n<p>Is this even possible with Go? If so, how?</p>\n"}, {"tags": ["go", "gorilla", "servemux"], "comments": [{"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 1, "creation_date": 1423343146, "post_id": 28386387, "comment_id": 45112273, "body": "Works for me. Can you show where you register your router?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4211028"}, "reply_to_user": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1423343215, "post_id": 28386387, "comment_id": 45112291, "body": "I just register with <code>router := mux.NewRouter()</code>"}], "answers": [{"tags": [], "owner": {"reputation": 587, "user_id": 3587115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/veo3Q.jpg?s=128&g=1", "display_name": "Sundrique", "link": "https://stackoverflow.com/users/3587115/sundrique"}, "is_accepted": true, "score": 1, "last_activity_date": 1423362644, "creation_date": 1423362644, "answer_id": 28389934, "question_id": 28386387, "link": "https://stackoverflow.com/questions/28386387/gorilla-mux-to-handle-curl-request/28389934#28389934", "title": "Gorilla Mux to handle curl request", "body": "<p>You may try to add Queries to your router, in that case you will have all vars in one map.</p>\n\n<pre><code>router.Methods(\"GET\").Path(\"/api/myapiname/{version}\").Queries(\"number\", \"{number:[0-9]+}\", \"target\", \"{target:[^&amp;]+}\", \"message\", \"{message:[^&amp;]+}\").HandlerFunc(apihandler)\n\nfunc apihandler(rw http.ResponseWriter, q *http.Request) {\n    vars := mux.Vars(q)\n    log.Println(vars[\"version\"])\n    log.Println(vars(\"number\"))\n    log.Println(vars(\"target\"))\n    log.Println(vars(\"message\"))\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4211028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 1, "accepted_answer_id": 28389934, "answer_count": 1, "score": 0, "last_activity_date": 1423362644, "creation_date": 1423337282, "question_id": 28386387, "link": "https://stackoverflow.com/questions/28386387/gorilla-mux-to-handle-curl-request", "title": "Gorilla Mux to handle curl request", "body": "<p>I want to use Gorilla mux to handle api requests.</p>\n\n<p>Commands will be something like:</p>\n\n<p>curl <a href=\"http://0.0.0.0:8000/api/myapiname/v1?number=10&amp;target=google.com&amp;message=hello\" rel=\"nofollow\">http://0.0.0.0:8000/api/myapiname/v1?number=10&amp;target=google.com&amp;message=hello</a></p>\n\n<p>And I am serving with following handlers:</p>\n\n<pre><code>router.Methods(\"GET\").Path(\"/api/myapiname/{version}\").HandlerFunc(apihandler)\n\nfunc apihandler(rw http.ResponseWriter, q *http.Request) {\n    vars := mux.Vars(q)\n    log.Println(vars[\"version\"])\n    log.Println(q.FormValue(\"number\"))\n    log.Println(q.FormValue(\"target\"))\n    log.Println(q.FormValue(\"message\"))\n}\n</code></pre>\n\n<p>But for the <code>curl</code> requests I only get the form value of <code>number</code> not <code>target</code> and <code>message</code>'s</p>\n\n<p>What is the correct way of handle api requests using Gorilla mux? Do I need sub routing?</p>\n\n<p>I just want to receive any http request of form <code>http://0.0.0.0:8000/api/myapiname/v1?number=10&amp;target=google.com&amp;message=hello</code> and be able to map its key to value</p>\n\n<p>THanks!</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1423686768, "post_id": 28385311, "comment_id": 45253559, "body": "Using <code>this</code> as a receiver name is undesirable and <a href=\"https://github.com/golang/go/wiki/CodeReviewComments#receiver-names\" rel=\"nofollow noreferrer\">not recommended</a>."}, {"owner": {"reputation": 181, "user_id": 255740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55f85a712bfac5b25bd942272c571d03?s=128&d=identicon&r=PG", "display_name": "Tushar Khairnar", "link": "https://stackoverflow.com/users/255740/tushar-khairnar"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1423802694, "post_id": 28385311, "comment_id": 45305820, "body": "Thanks Dave. Java Hangover. I followed a tutorial which had &quot;this&quot; used."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 255740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55f85a712bfac5b25bd942272c571d03?s=128&d=identicon&r=PG", "display_name": "Tushar Khairnar", "link": "https://stackoverflow.com/users/255740/tushar-khairnar"}, "edited": false, "score": 0, "creation_date": 1423418984, "post_id": 28385422, "comment_id": 45130727, "body": "I changed the code again with re-assgining slice back to this.TestQueue still not working : <a href=\"http://play.golang.org/p/gYvp1a5OA0\" rel=\"nofollow noreferrer\">play.golang.org/p/gYvp1a5OA0</a>"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 181, "user_id": 255740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55f85a712bfac5b25bd942272c571d03?s=128&d=identicon&r=PG", "display_name": "Tushar Khairnar", "link": "https://stackoverflow.com/users/255740/tushar-khairnar"}, "edited": false, "score": 0, "creation_date": 1423433316, "post_id": 28385422, "comment_id": 45135504, "body": "You playground code is using the old <code>remainingTests</code> var, you need to call <code>server.GetRemainingTests()</code> again.  You should also name your error values <code>err</code> instead of <code>error</code>, since <code>error</code> is a builtin type. <a href=\"http://play.golang.org/p/TYKRi9IBVh\" rel=\"nofollow noreferrer\">here</a> is an updated working version."}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 1, "last_activity_date": 1423331503, "creation_date": 1423331503, "answer_id": 28385422, "question_id": 28385311, "link": "https://stackoverflow.com/questions/28385311/in-go-how-to-delete-an-item-from-slice-of-an-struct/28385422#28385422", "title": "In Go How to delete an item from slice of an Struct", "body": "<p>You are not assigning <code>slice</code> back to <code>this.TestQueue</code></p>\n"}], "owner": {"reputation": 181, "user_id": 255740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55f85a712bfac5b25bd942272c571d03?s=128&d=identicon&r=PG", "display_name": "Tushar Khairnar", "link": "https://stackoverflow.com/users/255740/tushar-khairnar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 1, "accepted_answer_id": 28385422, "answer_count": 1, "score": -1, "last_activity_date": 1423331503, "creation_date": 1423330948, "question_id": 28385311, "link": "https://stackoverflow.com/questions/28385311/in-go-how-to-delete-an-item-from-slice-of-an-struct", "title": "In Go How to delete an item from slice of an Struct", "body": "<p>I have struct containing a slice of another struct. I have added methods for Addition and Deletion of an item from the slice but addition is working deletion is not. I am new to Go so I am not able to understand why slice reassignment does not gets reflected in struct </p>\n\n<p>Short Version of my code below. Link to PlayGoLang : <a href=\"http://play.golang.org/p/4NnGh3Dtzw\" rel=\"nofollow\">http://play.golang.org/p/4NnGh3Dtzw</a></p>\n\n<pre><code> type BatteryTest struct {\n    Name, LocalConf, JdkPath, SysProps, LocalconfPath string\n    NumberOfNodes                                     int\n    }\n\n    type Server struct {\n    Port                                    int\n    TestQueue, CompletedTests, RunningTests []BatteryTest\n}\n\n    func (this *Server) AddBatteryTest(test BatteryTest) error {    \n        this.TestQueue = append(this.TestQueue, test)\n        return nil\n    }\n\nfunc (this *Server) TakeBatteryTest() error {\n    length := len(this.TestQueue)\n    if length == 0 {\n        fmt.Println(\"Len==\", 0)\n        return errors.New(\"Queue is empty\")\n    }\n\n    slice := this.TestQueue\n    i := len(this.TestQueue) - 1\n    slice = append(slice[:i], slice[i+1:]...)\n    return nil\n}\n</code></pre>\n"}, {"tags": ["pointers", "dictionary", "go"], "answers": [{"comments": [{"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "reply_to_user": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "edited": false, "score": 1, "creation_date": 1423327234, "post_id": 28384496, "comment_id": 45107045, "body": "I find this very rare. I tried it and it works: <a href=\"http://play.golang.org/p/85Mj8RixGm\" rel=\"nofollow noreferrer\">play.golang.org/p/85Mj8RixGm</a> . If @jmaloney solutions works for you, are you sure you are using the same code you posted here?"}, {"owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "edited": false, "score": 0, "creation_date": 1423381572, "post_id": 28384496, "comment_id": 45120538, "body": "I had other issues in the code. So it changed. I updated it in the question above. But the problem I had first went away after I got rid of all * and &amp;."}], "tags": [], "owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "is_accepted": false, "score": 10, "last_activity_date": 1423326716, "last_edit_date": 1423326716, "creation_date": 1423326480, "answer_id": 28384496, "question_id": 28384343, "link": "https://stackoverflow.com/questions/28384343/accessing-a-map-using-its-reference/28384496#28384496", "title": "Accessing a map using its reference", "body": "<p>You are not taking into account the precedence of <code>*</code>.</p>\n\n<p><code>*session[sid]</code> really means <code>*(session[sid])</code>, that is, first indexing the pointer to map (hence the error), then dereferencing it.</p>\n\n<p>You should use <code>(*session)[sid].timestamp</code> to first dereference the pointer to the map and then access it using the key.</p>\n"}, {"tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": false, "score": 13, "last_activity_date": 1575280134, "last_edit_date": 1575280134, "creation_date": 1423326515, "answer_id": 28384502, "question_id": 28384343, "link": "https://stackoverflow.com/questions/28384343/accessing-a-map-using-its-reference/28384502#28384502", "title": "Accessing a map using its reference", "body": "<p>De-reference the map first and then access it (<a href=\"https://play.golang.org/p/PZ55WWpUj7R\" rel=\"nofollow noreferrer\">Example on play</a>):</p>\n\n<pre><code>(*sessions)[sid]\n</code></pre>\n\n<p>It's also noteworthy that maps are actually reference types and therefore there is a very limited use-case of using pointers. Just passing a map value to a function will not copy the content. <a href=\"http://play.golang.org/p/hpmbkNLuuh\" rel=\"nofollow noreferrer\">Example on play</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 9424, "user_id": 1248913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ced76ce8952257b480f8b1c96ab0a79?s=128&d=identicon&r=PG", "display_name": "Roy Lee", "link": "https://stackoverflow.com/users/1248913/roy-lee"}, "edited": false, "score": 0, "creation_date": 1462753983, "post_id": 28384528, "comment_id": 61754681, "body": "question, would there be cases where its plausible to have a map&#39;s key to be pointer of x type?"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 9424, "user_id": 1248913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ced76ce8952257b480f8b1c96ab0a79?s=128&d=identicon&r=PG", "display_name": "Roy Lee", "link": "https://stackoverflow.com/users/1248913/roy-lee"}, "edited": false, "score": 1, "creation_date": 1462755107, "post_id": 28384528, "comment_id": 61754928, "body": "Do you mean something like <code>map[*T]string</code>?"}, {"owner": {"reputation": 600, "user_id": 2650894, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bc2b203d73595b699da9461f91a9fc2a?s=128&d=identicon&r=PG", "display_name": "harun_a", "link": "https://stackoverflow.com/users/2650894/harun-a"}, "edited": false, "score": 0, "creation_date": 1542673384, "post_id": 28384528, "comment_id": 93644977, "body": "Is something like map[*T]string possible?"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 600, "user_id": 2650894, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bc2b203d73595b699da9461f91a9fc2a?s=128&d=identicon&r=PG", "display_name": "harun_a", "link": "https://stackoverflow.com/users/2650894/harun-a"}, "edited": false, "score": 0, "creation_date": 1542837833, "post_id": 28384528, "comment_id": 93716559, "body": "@harunrashid indeed, check out this example <a href=\"https://play.golang.com/p/GlEzMDDZdPa\" rel=\"nofollow noreferrer\">play.golang.com/p/GlEzMDDZdPa</a>"}, {"owner": {"reputation": 1278, "user_id": 108826, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/861ed516fb54db2217b7e90aee1d2d3f?s=128&d=identicon&r=PG&f=1", "display_name": "S2201", "link": "https://stackoverflow.com/users/108826/s2201"}, "edited": false, "score": 0, "creation_date": 1575274933, "post_id": 28384528, "comment_id": 104497366, "body": "map[string]*Session will not modify the map globally,  as original code does"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 1278, "user_id": 108826, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/861ed516fb54db2217b7e90aee1d2d3f?s=128&d=identicon&r=PG&f=1", "display_name": "S2201", "link": "https://stackoverflow.com/users/108826/s2201"}, "edited": false, "score": 0, "creation_date": 1575305320, "post_id": 28384528, "comment_id": 104512985, "body": "@Savash yes it will, since a Map is a reference all changes to the map will be global. Here is a playground example to illustrate <a href=\"https://play.golang.org/p/Bmu-EAhreD5\" rel=\"nofollow noreferrer\">play.golang.org/p/Bmu-EAhreD5</a>"}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 43, "last_activity_date": 1554812215, "last_edit_date": 1554812215, "creation_date": 1423326622, "answer_id": 28384528, "question_id": 28384343, "link": "https://stackoverflow.com/questions/28384343/accessing-a-map-using-its-reference/28384528#28384528", "title": "Accessing a map using its reference", "body": "<p>You don't need to use a pointer with a map.</p>\n\n<blockquote>\n  <p><a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"noreferrer\">Map types are reference types, like pointers or slices</a></p>\n</blockquote>\n\n<p>If you needed to change the <code>Session</code> you could use a pointer:</p>\n\n<p><code>map[string]*Session</code></p>\n"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34356, "favorite_count": 9, "accepted_answer_id": 28384528, "answer_count": 3, "score": 22, "last_activity_date": 1575280134, "creation_date": 1423325515, "last_edit_date": 1562675781, "question_id": 28384343, "link": "https://stackoverflow.com/questions/28384343/accessing-a-map-using-its-reference", "title": "Accessing a map using its reference", "body": "<p>I try to loop through a map, that I pass as a pointer to a function, but I can't find a way to access the elements. This is the code:</p>\n\n<pre><code>func refreshSession(sessions *map[string]Session) {\n    now := time.Now()\n    for sid := range *sessions {\n        if now.After(*sessions[sid].timestamp.Add(sessionRefresh)) {\n            delete( *sessions, sid )\n        }\n    }\n}\n</code></pre>\n\n<p>Line 4 in this example return following compile error:</p>\n\n<pre><code>./controller.go:120: invalid operation: sessions[sid] (type *map[string]Session does not support indexing)\n</code></pre>\n\n<p>I tried brackets, but it had no effect. If I take away all reference operators (* &amp;) then it compiles fine. </p>\n\n<p>How must I write this?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 1271628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/210b281435b306783d0f6a312fd15a18?s=128&d=identicon&r=PG", "display_name": "Ian Childress", "link": "https://stackoverflow.com/users/1271628/ian-childress"}, "edited": false, "score": 0, "creation_date": 1423319231, "post_id": 28382764, "comment_id": 45104709, "body": "Excellent this is exactly what I was looking for."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1423324435, "last_edit_date": 1423324435, "creation_date": 1423316249, "answer_id": 28382764, "question_id": 28382593, "link": "https://stackoverflow.com/questions/28382593/how-to-add-a-filter-to-a-datastore-query-based-on-condition/28382764#28382764", "title": "How to add a filter to a datastore query based on condition", "body": "<p>Optionally call another <code>Query.Filter()</code> method on the query if the parameter exists. Just be sure you store the return value as it may be a different, derived query.<br>\nThe reason is that all query builder/modifier methods return a derived query which you can use to chain multiple operations. You don't have to do it all in one step though, you can store the intermediate result query and continue the \"work\" from there (e.g. add new filters). Just remember to always store the return values, and you have to use the <code>Query</code> returned by the last method.</p>\n\n<p><strong>Solution (candidate):</strong></p>\n\n<pre><code>q := datastore.NewQuery(\"book\").Filter(\"author =\", \"DB\")\nif title != nil {\n    q = q.Filter(\"title =\", title)\n}\nq = q.Order(\"author\")\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>You did not mention it, but I assume <code>title</code> is a <code>string</code>. Variables of type <code>string</code> cannot have a <code>nil</code> value. The zero value of a <code>string</code> is the empty string <code>\"\"</code> so use that to compare/test:</p>\n\n<pre><code>q := datastore.NewQuery(\"book\").Filter(\"author =\", \"DB\")\nif title != \"\" {\n    q = q.Filter(\"title =\", title)\n}\nq = q.Order(\"author\")\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 1271628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/210b281435b306783d0f6a312fd15a18?s=128&d=identicon&r=PG", "display_name": "Ian Childress", "link": "https://stackoverflow.com/users/1271628/ian-childress"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "accepted_answer_id": 28382764, "answer_count": 1, "score": 1, "last_activity_date": 1482861769, "creation_date": 1423315252, "last_edit_date": 1482861769, "question_id": 28382593, "link": "https://stackoverflow.com/questions/28382593/how-to-add-a-filter-to-a-datastore-query-based-on-condition", "title": "How to add a filter to a datastore query based on condition", "body": "<p>I am receiving parameters from a POST and based on if those parameters exist I want to alter the datastore query. Here is an example where we may or may not receive a \"title\" variable from the post message. If it does exist, I want to include it in the query as a filter:</p>\n\n<pre><code>q := datastore.NewQuery(\"book\").\n    Filter(\"author =\", \"DB\").\n    if title != nil {Filter(\"title =\",title).}\n    Order(\"author\")\n</code></pre>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["c++", "opencv", "go", "swig"], "answers": [{"comments": [{"owner": {"reputation": 9565, "user_id": 1371471, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/faf259d8e263234505409be153763398?s=128&d=identicon&r=PG", "display_name": "lazywei", "link": "https://stackoverflow.com/users/1371471/lazywei"}, "edited": false, "score": 0, "creation_date": 1423496772, "post_id": 28402708, "comment_id": 45160479, "body": "Thank you so much for answering!!! I&#39;ve been looking for answers for so long! Could you provide a very simple example how I can use %include to wrap the cv core or some other modules? I&#39;ve tried %include but get &quot;xxx.hpp&quot; not found ..."}], "tags": [], "owner": {"reputation": 1051, "user_id": 809410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ffc49c668c0066df3196ecf48aa39f?s=128&d=identicon&r=PG", "display_name": "iant", "link": "https://stackoverflow.com/users/809410/iant"}, "is_accepted": false, "score": 1, "last_activity_date": 1423455024, "creation_date": 1423455024, "answer_id": 28402708, "question_id": 28380168, "link": "https://stackoverflow.com/questions/28380168/use-swig-to-wrap-opencvs-c-api-in-go/28402708#28402708", "title": "Use SWIG to wrap OpenCV&#39;s C++ API in GO", "body": "<p>You can %include any header file you like.  It doesn't have to be in the same directory.</p>\n\n<p>I would start by thinking about the API you want to present to Go programs.  A good Go API is often different from a good C API.</p>\n"}], "owner": {"reputation": 9565, "user_id": 1371471, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/faf259d8e263234505409be153763398?s=128&d=identicon&r=PG", "display_name": "lazywei", "link": "https://stackoverflow.com/users/1371471/lazywei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423455024, "creation_date": 1423298300, "question_id": 28380168, "link": "https://stackoverflow.com/questions/28380168/use-swig-to-wrap-opencvs-c-api-in-go", "title": "Use SWIG to wrap OpenCV&#39;s C++ API in GO", "body": "<p>I'm trying to use SWIG to wrap OpenCV's C++ API. For now, I have system-wise OpenCV installed. My questions are:</p>\n\n<ol>\n<li><p>Is it possible to wrap \"system-wise\" library without putting them into the same directory of my SWIG files? For example, my opencv's header files are in <code>/usr/local/opt/opencv/opencv2/opencv.hpp</code>. Can I use <code>%include \"opencv2/opencv.hpp\"</code> in SWIG?</p></li>\n<li><p>How should I start with this work? Should I wrap the CONSTANTs first?</p></li>\n</ol>\n\n<p>thanks.</p>\n"}, {"tags": ["sql", "go", "beego"], "comments": [{"owner": {"reputation": 40575, "user_id": 793428, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/999b32fdf6b04835061fffd1c5c6cf76?s=128&d=identicon&r=PG&f=1", "display_name": "ozgur", "link": "https://stackoverflow.com/users/793428/ozgur"}, "edited": false, "score": 0, "creation_date": 1423286148, "post_id": 28378800, "comment_id": 45097454, "body": "Welcome to SO. Please read the <a href=\"http://stackoverflow.com/tour\">FAQ</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a>. The way your question is worded you appear to have posted a homework question and are asking us to provide you with the code. That is not how this site works; you are expected to write the code and when you encounter a problem you ask a specific question."}], "answers": [{"comments": [{"owner": {"reputation": 2099, "user_id": 1917479, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/daEaw.jpg?s=128&g=1", "display_name": "soapbar", "link": "https://stackoverflow.com/users/1917479/soapbar"}, "edited": false, "score": 0, "creation_date": 1423307811, "post_id": 28378862, "comment_id": 45101710, "body": "thx,This method can.But it must be turn on the orm.Debug by this way, I want to make a logging   for database operating at product mode, so I want to find other ways that do not need to turn on the orm.Debug."}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "reply_to_user": {"reputation": 2099, "user_id": 1917479, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/daEaw.jpg?s=128&g=1", "display_name": "soapbar", "link": "https://stackoverflow.com/users/1917479/soapbar"}, "edited": false, "score": 0, "creation_date": 1423312241, "post_id": 28378862, "comment_id": 45102826, "body": "You can set up many RDBMS&#39;s (such as PostgreSQL and MySQL) to log the queries on the server side. This may be a better option than logging on the client side."}], "tags": [], "owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "is_accepted": true, "score": 1, "last_activity_date": 1423286266, "creation_date": 1423286266, "answer_id": 28378862, "question_id": 28378800, "link": "https://stackoverflow.com/questions/28378800/how-to-get-the-finally-sql-string-in-the-beg-orm/28378862#28378862", "title": "how to get the finally sql string in the beg orm", "body": "<p>I think you want to use <code>orm.Debug</code> mode:</p>\n\n<blockquote>\n  <p>Setting <code>orm.Debug</code> to true will print out SQL queries</p>\n  \n  <p>It may cause performance issues. It's not recommend to be used in production env.<br>\n  ....<br>\n  Prints to <code>os.Stderr</code> by default.</p>\n  \n  <p>You can change it to your own <code>io.Writer</code></p>\n</blockquote>\n\n<p><a href=\"https://github.com/beego/beedoc/blob/master/en-US/mvc/model/orm.md#print-out-sql-query-in-debugging-mode\" rel=\"nofollow\">More info</a></p>\n"}], "owner": {"reputation": 2099, "user_id": 1917479, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/daEaw.jpg?s=128&g=1", "display_name": "soapbar", "link": "https://stackoverflow.com/users/1917479/soapbar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 0, "accepted_answer_id": 28378862, "answer_count": 1, "score": 0, "last_activity_date": 1423307995, "creation_date": 1423285615, "last_edit_date": 1423307995, "question_id": 28378800, "link": "https://stackoverflow.com/questions/28378800/how-to-get-the-finally-sql-string-in-the-beg-orm", "title": "how to get the finally sql string in the beg orm", "body": "<p>I want to get the finally sql string in the beego's orm.</p>\n\n<p>but I can not find the interface that can get sql string.</p>\n\n<p>I want to make a Logging for database Operating.</p>\n\n<p>I want to find other ways that do not need to turn on the orm.Debug. </p>\n\n<pre><code>orm.Debug = false\n</code></pre>\n"}, {"tags": ["post", "go"], "comments": [{"owner": {"reputation": 947, "user_id": 1544418, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/91dd51f38be716f8c29da7f4f656bc16?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/1544418/ethan"}, "edited": false, "score": 0, "creation_date": 1423353727, "post_id": 28376472, "comment_id": 45115533, "body": "This code works fine for me. How do you call <code>submitForm</code> and how do you start the php server? The server and this go code are running on the same machine right?"}, {"owner": {"reputation": 61, "user_id": 4538994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b59499dec35ec4cef0385cb06efb18e?s=128&d=identicon&r=PG&f=1", "display_name": "Jaxx", "link": "https://stackoverflow.com/users/4538994/jaxx"}, "reply_to_user": {"reputation": 947, "user_id": 1544418, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/91dd51f38be716f8c29da7f4f656bc16?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/1544418/ethan"}, "edited": false, "score": 0, "creation_date": 1423357384, "post_id": 28376472, "comment_id": 45116274, "body": "I call it like this: submitForm(&quot;asdf&quot;) The server was started on the same machine like this: php -S localhost:8080 Do you think it&#39;s PHP&#39;s (not Go&#39;s) fault?"}, {"owner": {"reputation": 947, "user_id": 1544418, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/91dd51f38be716f8c29da7f4f656bc16?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/1544418/ethan"}, "edited": false, "score": 0, "creation_date": 1423357997, "post_id": 28376472, "comment_id": 45116393, "body": "Possibly. What version php? Might be interesting to compare the http requests between curl and go and see if perhaps there are differences in the headers that the php server is looking out for."}, {"owner": {"reputation": 61, "user_id": 4538994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b59499dec35ec4cef0385cb06efb18e?s=128&d=identicon&r=PG&f=1", "display_name": "Jaxx", "link": "https://stackoverflow.com/users/4538994/jaxx"}, "reply_to_user": {"reputation": 947, "user_id": 1544418, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/91dd51f38be716f8c29da7f4f656bc16?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/1544418/ethan"}, "edited": false, "score": 0, "creation_date": 1423358908, "post_id": 28376472, "comment_id": 45116602, "body": "PHP 5.6.4 how can I see the http requests? printing $_POST in php won&#39;t work because the request is refused."}, {"owner": {"reputation": 947, "user_id": 1544418, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/91dd51f38be716f8c29da7f4f656bc16?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/1544418/ethan"}, "edited": false, "score": 0, "creation_date": 1423359488, "post_id": 28376472, "comment_id": 45116712, "body": "right, I thought you might be able to print the go request but you can&#39;t because you use PostForm. And I&#39;m not sure how to make the php server more verbose. Do the Get or Post functions in go work? Have you tried building the request with lower level go functions, as explained here <a href=\"http://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http</a> ?"}, {"owner": {"reputation": 61, "user_id": 4538994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b59499dec35ec4cef0385cb06efb18e?s=128&d=identicon&r=PG&f=1", "display_name": "Jaxx", "link": "https://stackoverflow.com/users/4538994/jaxx"}, "reply_to_user": {"reputation": 947, "user_id": 1544418, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/91dd51f38be716f8c29da7f4f656bc16?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/1544418/ethan"}, "edited": false, "score": 0, "creation_date": 1423361804, "post_id": 28376472, "comment_id": 45117113, "body": "I have tried those as well. I get the same errors. I just tried to send the post request to a random website on the internet instead of localhost and it works fine. So it&#39;s probably a php issue. Anyway, thanks for your help."}, {"owner": {"reputation": 947, "user_id": 1544418, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/91dd51f38be716f8c29da7f4f656bc16?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/1544418/ethan"}, "edited": false, "score": 0, "creation_date": 1423361928, "post_id": 28376472, "comment_id": 45117131, "body": "run curl with the verbose flag. use the NewRequest function in go and print your request and headers before sending it. See if there&#39;s something missing in the go headers present in curl, or vice versa."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1423463735, "post_id": 28376472, "comment_id": 45142712, "body": "One possibility is that the Go net package and curl are resolving &quot;localhost&quot; to different addresses. Try <code>curl --data &quot;key=asdf&quot; http:&#47;&#47;127.0.0.1:8080&#47;</code> to see what happens. Also, the path is &quot;/&quot; in the curl request and empty in the Go request. I doubt this is the issue, but you should update the Go program to use &quot;/&quot; (append a &quot;/&quot; to the URL argument to PostForm)."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1475544355, "post_id": 28376472, "comment_id": 66975203, "body": "This issue appears to be resolved in Go 1.6."}], "answers": [{"tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": false, "score": 10, "last_activity_date": 1475544341, "last_edit_date": 1475544341, "creation_date": 1436492120, "answer_id": 31331063, "question_id": 28376472, "link": "https://stackoverflow.com/questions/28376472/golang-http-post-error-connection-refused/31331063#31331063", "title": "Golang HTTP Post error: connection refused", "body": "<p><strong><em>This issue appears to be resolved in Go 1.6. For reference, the original answer follows.</em></strong></p>\n\n<hr>\n\n<p>The problem here is that Go's net.Dialer only makes IPv4 connections by default (this appears to be a bug), but your PHP server is listening <em>only</em> on IPv6.</p>\n\n<p>When you run <code>php -S localhost:8080</code> it is doing the (mostly) right thing and binding to the IPv6 address <code>::1</code>. It does not bind to IPv4.</p>\n\n<p>This isn't a problem for most software, which <a href=\"https://tools.ietf.org/html/rfc6724\" rel=\"noreferrer\">knows to attempt IPv6 connections first</a>, but what happens when you call http.PostForm() is that net.http uses its <a href=\"http://golang.org/pkg/net/http/#RoundTripper\" rel=\"noreferrer\">DefaultTransport</a>, which by default uses a <a href=\"http://golang.org/pkg/net/#Dialer\" rel=\"noreferrer\">net.Dialer</a> Dial() to make outgoing connections. Dial() attempts to resolve the address, and then we wind up <em>deep</em> in the resolver in src/net/ipsock.go, where we find out that the Go developers intentionally screwed it up while trying to work around something else:</p>\n\n<pre><code>        // We'll take any IP address, but since the dialing\n        // code does not yet try multiple addresses\n        // effectively, prefer to use an IPv4 address if\n        // possible. This is especially relevant if localhost\n        // resolves to [ipv6-localhost, ipv4-localhost]. Too\n        // much code assumes localhost == ipv4-localhost.\n</code></pre>\n\n<p>This is obviously a problem, since IPv6 is supposed to be the default and preferred protocol. Linux and PHP are behaving correctly, while Go itself is not.</p>\n\n<p>The comment above was found in the 1.4 branch. In the master branch this has been completely rewritten, but in the new code it's non-obvious whether an IPv6 or IPv4 address will be preferred. It may well be nondeterministic; I didn't spend too much time looking at it. Based on the issues I found on GitHub, (see below) it is unlikely to be actually fixed.</p>\n\n<p>In the meantime you can work around this bug by either having Go connect to <code>::1</code> or having PHP bind to <code>127.0.0.1</code>. You could also construct your own RoundTripper with correct behavior, but that's probably too much work, unless you're actually having problems reaching IPv6-enabled services (and eventually we all will, so this really needs to be fixed).</p>\n\n<p>Some relevant Go issues include:</p>\n\n<ul>\n<li><a href=\"https://github.com/golang/go/issues/10552\" rel=\"noreferrer\">net: provide RFC 6724 address sorting functionality</a> (the proper fix for this issue)</li>\n<li><a href=\"https://github.com/golang/go/issues/9801\" rel=\"noreferrer\">net: Dial only tries the first address</a></li>\n<li><a href=\"https://github.com/golang/go/issues/8453\" rel=\"noreferrer\">net: Dial should follow getaddrinfo address ordering</a> (this is the issue you are having)</li>\n<li><a href=\"https://github.com/golang/go/issues/5267\" rel=\"noreferrer\">net: Dial does not try all resolved addresses</a> (closely related to your issue)</li>\n</ul>\n\n<p>And several other older issues that are no longer relevant since the code has long since been rewritten...</p>\n"}], "owner": {"reputation": 61, "user_id": 4538994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b59499dec35ec4cef0385cb06efb18e?s=128&d=identicon&r=PG&f=1", "display_name": "Jaxx", "link": "https://stackoverflow.com/users/4538994/jaxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23262, "favorite_count": 2, "answer_count": 1, "score": 6, "last_activity_date": 1475544341, "creation_date": 1423264617, "last_edit_date": 1423357180, "question_id": 28376472, "link": "https://stackoverflow.com/questions/28376472/golang-http-post-error-connection-refused", "title": "Golang HTTP Post error: connection refused", "body": "<p>I am trying to send a post request to localhost on port 8080 where a PHP app is running.</p>\n\n<p>Curl work fine:</p>\n\n<pre><code>curl --data \"key=asdf\" http://localhost:8080/\n</code></pre>\n\n<p>But in Go I get the following error:</p>\n\n<pre><code>Post http://localhost:8080: dial tcp 127.0.0.1:8080: connection refused\n</code></pre>\n\n<p>Here is the code:</p>\n\n<pre><code>func submitForm(value string){\n    resp, err := http.PostForm(\"http://localhost:8080\", url.Values{\"key\": {value}})\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer resp.Body.Close()\n    _, err = ioutil.ReadAll(resp.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(\"status = \",resp.Status)\n}\nsubmitForm(\"asdf\")\n</code></pre>\n\n<p>I monitored http traffic with httpry and i found out that no http request is generated but there are some packages:</p>\n\n<pre><code>4 packets received, 0 packets dropped, 0 http packets parsed\n</code></pre>\n\n<p>Some more facts:</p>\n\n<ul>\n<li>My OS is Linux</li>\n<li><p>I use the PHP's built-in web server. The servers was started with this command:</p>\n\n<p>php -S localhost:8080</p></li>\n</ul>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1423264252, "post_id": 28376340, "comment_id": 45092940, "body": "<a href=\"https://play.golang.org/p/lZFMDGF_M_\" rel=\"nofollow noreferrer\">Works for me</a>."}, {"owner": {"reputation": 1587, "user_id": 2692578, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/422308f27d72a059a020981097da6589?s=128&d=identicon&r=PG", "display_name": "paulkon", "link": "https://stackoverflow.com/users/2692578/paulkon"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1423265194, "post_id": 28376340, "comment_id": 45093256, "body": "I&#39;ve changed the example to better explain the question."}], "answers": [{"tags": [], "owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "is_accepted": false, "score": 0, "last_activity_date": 1423264781, "last_edit_date": 1423264781, "creation_date": 1423264082, "answer_id": 28376381, "question_id": 28376340, "link": "https://stackoverflow.com/questions/28376340/lexical-scoping-in-golang/28376381#28376381", "title": "Lexical scoping in golang?", "body": "<p>This does not even compile (<em>I was answering the unedited version of the question</em>).</p>\n\n<p>You have to use <code>;</code> instead of <code>,</code>:</p>\n\n<pre><code>func main(){\n  a := 0\n  for i := 0; i &lt; 10; i++ {\n    a += 5\n  }\n  fmt.Println(a) // prints 50\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 11, "last_activity_date": 1458858655, "last_edit_date": 1458858655, "creation_date": 1423266697, "answer_id": 28376784, "question_id": 28376340, "link": "https://stackoverflow.com/questions/28376340/lexical-scoping-in-golang/28376784#28376784", "title": "Lexical scoping in golang?", "body": "<p><code>z</code> is getting <a href=\"https://golang.org/doc/go1#shadowing\" rel=\"noreferrer\">shadowed</a>. Change <code>:=</code> to <code>=</code> and it will work.</p>\n\n<pre><code>func main (){\n    z := 4\n    if true {\n        z = 2\n        fmt.Println(z)\n    }\n    fmt.Println(z) // prints 2\n}\n</code></pre>\n\n<p>The if statement has its own scope, when you used <code>:=</code> you declared a new variable and shadowed the old one.</p>\n"}], "owner": {"reputation": 1587, "user_id": 2692578, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/422308f27d72a059a020981097da6589?s=128&d=identicon&r=PG", "display_name": "paulkon", "link": "https://stackoverflow.com/users/2692578/paulkon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 700, "favorite_count": 0, "accepted_answer_id": 28376784, "answer_count": 2, "score": 3, "last_activity_date": 1458858655, "creation_date": 1423263877, "last_edit_date": 1423362086, "question_id": 28376340, "link": "https://stackoverflow.com/questions/28376340/lexical-scoping-in-golang", "title": "Lexical scoping in golang?", "body": "<p>I don't quite understand why <code>a</code> is not 2 at the end:</p>\n\n<pre><code>func main (){\n    z := 4\n    if true {\n        z := 2\n        fmt.Println(z)\n    }\n    fmt.Println(z) // prints 4\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "edited": false, "score": 0, "creation_date": 1423261887, "post_id": 28375142, "comment_id": 45092099, "body": "Hrm, that seems needlessly complex! Do people make packages for every util?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "edited": false, "score": 1, "creation_date": 1423262115, "post_id": 28375142, "comment_id": 45092177, "body": "@KyleChadha Yes. That&#39;s what people do and what you should do."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "edited": false, "score": 0, "creation_date": 1423263344, "post_id": 28375142, "comment_id": 45092606, "body": "@KyleChadha the other option would be to keep the routes in the same package of course."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 0, "last_activity_date": 1423258239, "creation_date": 1423258239, "answer_id": 28375142, "question_id": 28375034, "link": "https://stackoverflow.com/questions/28375034/referencing-package-main-in-a-subpackage/28375142#28375142", "title": "Referencing package main in a subpackage", "body": "<p>The only way to resolve this is to move the shared logger to a third package and import it into both <code>main</code> and <code>routes</code>. Otherwise you get a cyclic dependency which as you've seen is not allowed.</p>\n\n<p>Simply add a folder called <code>logger</code> and put your logger in there. now import it into the other 2 packages, and you're done. </p>\n"}], "owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1300, "favorite_count": 0, "accepted_answer_id": 28375142, "answer_count": 1, "score": 0, "last_activity_date": 1423258239, "creation_date": 1423257813, "question_id": 28375034, "link": "https://stackoverflow.com/questions/28375034/referencing-package-main-in-a-subpackage", "title": "Referencing package main in a subpackage", "body": "<p>new to Golang and have a seemingly simple question. If I have a logger in package main (and defined in <code>logger.go</code>) at my project root, how do I reference that logger in a subpackage (ie: my <code>routes package</code>)?</p>\n\n<p>My directory structure is:</p>\n\n<ul>\n<li>main.go</li>\n<li>logger.go</li>\n<li>routes\\routes.go</li>\n<li>...</li>\n</ul>\n\n<p>I would think if Logger is public it would already be available to routes, but I get 'undefined: Logger' in <code>routes.go</code>. And if I try to import my main package in <code>routes.go</code> I get an 'import cycle not allowed' error since <code>routes.go</code> imports package main and <code>main.go</code> imports package routes.</p>\n\n<p>Any help would be much appreciated!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "edited": false, "score": 0, "creation_date": 1423257152, "post_id": 28374461, "comment_id": 45090117, "body": "I get <code>autompg.go:35:3: no buildable Go source files in &#47;sites&#47;gopath&#47;src&#47;github.com&#47;fxsjy&#47;gonn</code>"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "edited": false, "score": 0, "creation_date": 1423257244, "post_id": 28374461, "comment_id": 45090174, "body": "you need to do first a <code>go get github.com&#47;fxsjy&#47;gonn</code>"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "edited": false, "score": 0, "creation_date": 1423258103, "post_id": 28374461, "comment_id": 45090577, "body": "@Shamoon then remove it from your import list: it doesn&#39;t seem that you are using that import in your example."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "edited": false, "score": 0, "creation_date": 1423258414, "post_id": 28374461, "comment_id": 45090701, "body": "@Shamoon do you have git installed? What <code>git --version</code> return?"}, {"owner": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "edited": false, "score": 0, "creation_date": 1423258432, "post_id": 28374461, "comment_id": 45090708, "body": "<code>git version 1.9.3 (Apple Git-50)</code>"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "edited": false, "score": 0, "creation_date": 1423258502, "post_id": 28374461, "comment_id": 45090733, "body": "@Shamoon <code>go get github.com&#47;fxsjy&#47;gonn</code> should have cloned the repo <a href=\"https://github.com/fxsjy/gonn\" rel=\"nofollow noreferrer\">github.com/fxsjy/gonn</a> to your <code>$GOPATH&#47;src&#47;github.com&#47;fxsjy&#47;gonn</code>."}, {"owner": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "edited": false, "score": 0, "creation_date": 1423258578, "post_id": 28374461, "comment_id": 45090762, "body": "Okay, started from scratch and now here&#39;s what happens when i <code>go get</code>, <code>package github.com&#47;fxsjy&#47;gonn \timports github.com&#47;fxsjy&#47;gonn \timports github.com&#47;fxsjy&#47;gonn: no buildable Go source files in &#47;sites&#47;gopath&#47;src&#47;github.com&#47;fxsjy&#47;gonn</code>"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "edited": false, "score": 0, "creation_date": 1423258737, "post_id": 28374461, "comment_id": 45090830, "body": "@Shamoon did you type only <code>go get github.com&#47;fxsjy&#47;gonn</code>?"}, {"owner": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "edited": false, "score": 0, "creation_date": 1423258784, "post_id": 28374461, "comment_id": 45090852, "body": "Yes, it apparently put it in <code>src</code>, but still has that error"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "edited": false, "score": 0, "creation_date": 1423258850, "post_id": 28374461, "comment_id": 45090874, "body": "@Shamoon can you access the chat? (<a href=\"http://chat.stackoverflow.com/rooms/70428/discussion-between-shamoon-and-vonc\">chat.stackoverflow.com/rooms/70428/&hellip;</a>)"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "edited": false, "score": 0, "creation_date": 1423258990, "post_id": 28374461, "comment_id": 45090922, "body": "@Shamoon tell me about it... anywhoozle, do you see now <code>&#47;sites&#47;gopath&#47;src&#47;github.com&#47;fxsjy&#47;gon</code>? If yes, can you go in that folder, and type <code>go install</code> (before trying again in your own project)"}, {"owner": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "edited": false, "score": 0, "creation_date": 1423259090, "post_id": 28374461, "comment_id": 45090969, "body": "Same: <code>$ go install can&#39;t load package: package github.com&#47;fxsjy&#47;gonn: no buildable Go source files in &#47;sites&#47;gopath&#47;src&#47;github.com&#47;fxsjy&#47;gonn</code>"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "edited": false, "score": 0, "creation_date": 1423259171, "post_id": 28374461, "comment_id": 45091005, "body": "@Shamoon do you see the same content as <a href=\"https://github.com/fxsjy/gonn\" rel=\"nofollow noreferrer\">github.com/fxsjy/gonn</a> in <code>&#47;sites&#47;gopath&#47;src&#47;github.com&#47;fxsjy&#47;gonn</code> when you do a <code>cd &#47;sites&#47;gopath&#47;src&#47;github.com&#47;fxsjy&#47;gonn</code>?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "edited": false, "score": 0, "creation_date": 1423259292, "post_id": 28374461, "comment_id": 45091067, "body": "@Shamoon if yes, can you go one level below? <code>cd &#47;sites&#47;gopath&#47;src&#47;github.com&#47;fxsjy&#47;gonn&#47;gonn</code>, and type <code>go install</code> from there?"}, {"owner": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "edited": false, "score": 0, "creation_date": 1423259353, "post_id": 28374461, "comment_id": 45091096, "body": "that did it! needed to import <code>github.com&#47;fxsjy&#47;gonn&#47;gonn</code>. How do I run this now?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "edited": false, "score": 0, "creation_date": 1423259520, "post_id": 28374461, "comment_id": 45091181, "body": "@Shamoon go back to your project, and a <code>go install</code> should put your executable in <code>$GOPATH&#47;bin</code>, which means you can type <code>autompg</code>  from anywhere to execute it."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1423259460, "last_edit_date": 1495535190, "creation_date": 1423255374, "answer_id": 28374461, "question_id": 28374371, "link": "https://stackoverflow.com/questions/28374371/how-to-set-up-a-basic-go-project-with-neural-networks/28374461#28374461", "title": "How to set up a basic Go project with neural networks?", "body": "<blockquote>\n  <p><code>go install autompg</code> from my <code>go-ann-test</code> folder:</p>\n</blockquote>\n\n<p>No, you need to go to the <code>go-ann-test/autompg</code> folder, and there type <code>go install</code></p>\n\n<p>That will compile <code>autompg.go</code> into an executable <code>autompg</code> and put in in your <code>$GOPATH/bin</code>.</p>\n\n<p>Finally, you can add, commit and push to <a href=\"https://github.com/shamoons/go-ann-test\" rel=\"nofollow noreferrer\">https://github.com/shamoons/go-ann-test</a>.</p>\n\n<p>The <a href=\"https://stackoverflow.com/users/239879/shamoon\">OP Shamoon</a> adds <a href=\"https://stackoverflow.com/questions/28374371/how-to-set-up-a-basic-go-project-with-neural-networks/28374461?noredirect=1#comment45090117_28374461\">in the comments</a>:</p>\n\n<blockquote>\n  <p>I get </p>\n</blockquote>\n\n<pre><code> autompg.go:35:3: no buildable Go source files in /sites/gopath/src/github.com/fxsjy/gonn\n</code></pre>\n\n<p>That means a <code>go get github.com/fxsjy/gonn</code> is needed to import and compile <code>github.com/fxsjy/gonn</code> first.</p>\n\n<p>Considering that imported repo structure <a href=\"https://github.com/fxsjy/gonn\" rel=\"nofollow noreferrer\">https://github.com/fxsjy/gonn</a>, it actually needed:</p>\n\n<pre><code>cd /sites/gopath/src/github.com/fxsjy/gonn/gonn\ngo install \n</code></pre>\n\n<p>That means the actual import was:</p>\n\n<pre><code>import github.com/fxsjy/gonn/gonn\n</code></pre>\n"}], "owner": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 28374461, "answer_count": 1, "score": 1, "last_activity_date": 1423259460, "creation_date": 1423255025, "last_edit_date": 1423258165, "question_id": 28374371, "link": "https://stackoverflow.com/questions/28374371/how-to-set-up-a-basic-go-project-with-neural-networks", "title": "How to set up a basic Go project with neural networks?", "body": "<p>I am super new go <code>Go</code> and need some help setting things up. First, the <code>$GOPATH</code>. It seems that all of my <code>go</code> projects should be in the same place on my machine? So I have that set:</p>\n\n<pre><code>$ echo $GOPATH\n/sites/gopath\n</code></pre>\n\n<p>Inside, I set up the folders recommended:</p>\n\n<pre><code>$ ls -a /sites/gopath\n.   ..  bin pkg src\n</code></pre>\n\n<p>Inside <code>src</code>, I have a folder called <code>github.com</code>, which has a folder in it called <code>shamoons</code> which has a folder in it called <code>go-ann-test</code>.</p>\n\n<p>Inside that, I have a folder called <code>autompg</code> and inside that, I have a file called <code>autompg.go</code>.</p>\n\n<p>Phew! That's a lot of set up for a project! But I'm going assume that I'm either doing it wrong or that it's somehow worth it.</p>\n\n<p>In my <code>autompg.go</code>, I have:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"github.com/fxsjy/gonn\"\n)\n\nfunc main() {\n  nn := gonn.DefaultNetwork(2,3,1,true)\n  inputs := [][]float64{\n    []float64{0,0},\n    []float64{0,1},\n    []float64{1,0},\n    []float64{1,1},\n  }\n\n  targets := [][]float64{\n    []float64{0},//0+0=0\n    []float64{1},//0+1=1\n    []float64{1},//1+0=1\n    []float64{2},//1+1=2\n  }\n\n  nn.Train(inputs,targets,1000)\n\n  for _,p := range inputs{\n    fmt.Println(nn.Forward(p))\n  }\n}\n</code></pre>\n\n<p>And when I type <code>go install autompg</code> from my <code>go-ann-test</code> folder, I get:</p>\n\n<pre><code>$ go install autompg \ncan't load package: package autompg: cannot find package \"autompg\" in any of:\n    /usr/local/Cellar/go/1.4.1/libexec/src/autompg (from $GOROOT)\n    /sites/gopath/src/autompg (from $GOPATH)\n</code></pre>\n\n<p>So what am I doing wrong and how can I properly set up the project to accept the external package?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1423255216, "post_id": 28373497, "comment_id": 45089168, "body": "It would help to create an MCVE (see stackoverflow.com/help/mcve ). This would give us a better chance at finding the problem."}], "answers": [{"comments": [{"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1423276040, "post_id": 28374852, "comment_id": 45095798, "body": "Fix currently going through code review.  <a href=\"https://go-review.googlesource.com/#/c/4152\" rel=\"nofollow noreferrer\">go-review.googlesource.com/#/c/4152</a>"}, {"owner": {"reputation": 1893, "user_id": 127958, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0846808c184064b26729044cdeb75a5d?s=128&d=identicon&r=PG", "display_name": "kadalamittai", "link": "https://stackoverflow.com/users/127958/kadalamittai"}, "edited": false, "score": 0, "creation_date": 1423412040, "post_id": 28374852, "comment_id": 45128412, "body": "thanks @dyoo i am checking the bug-id and code review process by golang team. appreciate that."}], "tags": [], "owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "is_accepted": false, "score": 2, "last_activity_date": 1423276066, "last_edit_date": 1423276066, "creation_date": 1423256979, "answer_id": 28374852, "question_id": 28373497, "link": "https://stackoverflow.com/questions/28373497/golang-race-condition-marshaling-to-xml-in-2-goroutines/28374852#28374852", "title": "golang race condition - marshaling to XML in 2 goroutines", "body": "<p>This looks like a bug in the Go 1.41 library.  I've reported it <a href=\"https://github.com/golang/go/issues/9796\" rel=\"nofollow\">as a bug</a>.  Hopefully it should get fixed.  I'll leave the analysis below for reference.</p>\n\n<hr>\n\n<p>What's happening is that there's an implicit shared value due to the use of <a href=\"https://golang.org/src/encoding/xml/typeinfo.go#L51\" rel=\"nofollow\"><code>getTypeInfo()</code></a> which returns a type description of the struct.  For efficiency, it appears to be globally cached state.  Other parts of the XML encoder take components of this state and pass it around.  It appears that there's an inadvertent mutation happening due to a slice <code>append</code> on a component of the shared value.</p>\n\n<p>The <code>p.stack</code> attribute that's reporting as the source of the data race originates from a part of the <code>typeInfo</code> shared value, where a slice of <code>tinfo.parents</code> gets injected on <a href=\"https://golang.org/src/encoding/xml/marshal.go#L821\" rel=\"nofollow\">line 821</a>.  That's ultimately where the sharing is happening with the potential for read and writing, because later on there are <code>appends</code> happening on the slice, and that can do mutation on the underlying array.</p>\n\n<p>What should probably happen instead is that the slice should be capacity-restricted so that any potential <code>append</code> won't do a write on the shared array value.</p>\n\n<p>That is, line 897 of the encoder library could probably be be changed from:</p>\n\n<pre><code>897        s.stack = parents[:split]\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>897        s.stack = parents[:split:split]\n</code></pre>\n\n<p>to correct the issue.</p>\n"}], "owner": {"reputation": 1893, "user_id": 127958, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0846808c184064b26729044cdeb75a5d?s=128&d=identicon&r=PG", "display_name": "kadalamittai", "link": "https://stackoverflow.com/users/127958/kadalamittai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1423276066, "creation_date": 1423251674, "last_edit_date": 1423262396, "question_id": 28373497, "link": "https://stackoverflow.com/questions/28373497/golang-race-condition-marshaling-to-xml-in-2-goroutines", "title": "golang race condition - marshaling to XML in 2 goroutines", "body": "<p>i am getting data race condition when i try to marshal Struct to XML in a GoRoutine of 2 or more. </p>\n\n<p>Sample main program : <a href=\"http://play.golang.org/p/YhkWXWL8C0\" rel=\"nofollow\">http://play.golang.org/p/YhkWXWL8C0</a></p>\n\n<p>i believe <code>xml:\"members&gt;member\"</code> causing this . if i change it to normal then all works fine. any thoughts why go-1.4.x version doing that.</p>\n\n<pre><code>Family struct {\n    XMLName xml.Name `xml:\"family\"`\n    Name    string   `xml:\"famil_name\"`\n    Members []Person `xml:\"members&gt;member\"`\n    //Members []Person `xml:\"members\"`\n}\n</code></pre>\n\n<p>go run -race data_race.go  giving me </p>\n\n<pre><code>2015/02/06 13:53:43  Total GoRoutine Channels Created 2\n2015/02/06 13:53:43 &lt;family&gt;&lt;famil_name&gt;&lt;/famil_name&gt;&lt;members&gt;&lt;person&gt;&lt;name&gt;ABCD&lt;/name&gt;&lt;age&gt;0&lt;/age&gt;&lt;/person&gt;&lt;person&gt;&lt;name&gt;dummy&lt;/name&gt;&lt;age&gt;0&lt;/age&gt;&lt;/person&gt;&lt;/members&gt;&lt;/family&gt;\n==================\nWARNING: DATA RACE\nWrite by goroutine 6:\n  runtime.slicecopy()\n      /usr/local/go/src/runtime/slice.go:94 +0x0\n  encoding/xml.(*parentStack).push()\n      /usr/local/go/src/encoding/xml/marshal.go:908 +0x2fb\n  encoding/xml.(*printer).marshalStruct()\n      /usr/local/go/src/encoding/xml/marshal.go:826 +0x628\n  encoding/xml.(*printer).marshalValue()\n      /usr/local/go/src/encoding/xml/marshal.go:531 +0x1499\n  encoding/xml.(*Encoder).Encode()\n      /usr/local/go/src/encoding/xml/marshal.go:153 +0xb8\n  encoding/xml.Marshal()\n      /usr/local/go/src/encoding/xml/marshal.go:72 +0xfb\n  main.ToXml()\n      /Users/kadalamittai/selfie/go/src/github.com/ivam/goal/command/data_race.go:51 +0x227\n  main.func\u00b7001()\n      /Users/kadalamittai/selfie/go/src/github.com/ivam/goal/command/data_race.go:61 +0x74\n\nPrevious read by goroutine 5:\n  encoding/xml.(*parentStack).trim()\n      /usr/local/go/src/encoding/xml/marshal.go:893 +0x2ae\n  encoding/xml.(*printer).marshalStruct()\n      /usr/local/go/src/encoding/xml/marshal.go:836 +0x203\n  encoding/xml.(*printer).marshalValue()\n      /usr/local/go/src/encoding/xml/marshal.go:531 +0x1499\n  encoding/xml.(*Encoder).Encode()\n      /usr/local/go/src/encoding/xml/marshal.go:153 +0xb8\n  encoding/xml.Marshal()\n      /usr/local/go/src/encoding/xml/marshal.go:72 +0xfb\n  main.ToXml()\n      /Users/kadalamittai/selfie/go/src/github.com/ivam/goal/command/data_race.go:51 +0x227\n  main.func\u00b7001()\n      /Users/kadalamittai/selfie/go/src/github.com/ivam/goal/command/data_race.go:61 +0x74\n\nGoroutine 6 (running) created at:\n  main.AsyncExecute()\n      /Users/kadalamittai/selfie/go/src/github.com/ivam/goal/command/data_race.go:67 +0x15d\n  main.main()\n      /Users/kadalamittai/selfie/go/src/github.com/ivam/goal/command/data_race.go:80 +0x2bf\n\nGoroutine 5 (finished) created at:\n  main.AsyncExecute()\n      /Users/kadalamittai/selfie/go/src/github.com/ivam/goal/command/data_race.go:67 +0x15d\n  main.main()\n      /Users/kadalamittai/selfie/go/src/github.com/ivam/goal/command/data_race.go:80 +0x2bf\n==================\n</code></pre>\n"}, {"tags": ["dictionary", "go"], "comments": [{"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 0, "creation_date": 1423254123, "post_id": 28373369, "comment_id": 45088637, "body": "I&#39;m not sure I fully understand the question but perhaps you want to return a slice of maps like <code>[]map[string]interface{}</code>? Or is it a strict requirement that you not change the function&#39;s return value?"}, {"owner": {"reputation": 21, "user_id": 4538257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64107b13295ffe4ed84ad44df88a5be9?s=128&d=identicon&r=PG&f=1", "display_name": "mendio", "link": "https://stackoverflow.com/users/4538257/mendio"}, "reply_to_user": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 0, "creation_date": 1423254376, "post_id": 28373369, "comment_id": 45088751, "body": "Well, I have to return a map[string]interface{}  Is this possble ?"}, {"owner": {"reputation": 21, "user_id": 4538257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64107b13295ffe4ed84ad44df88a5be9?s=128&d=identicon&r=PG&f=1", "display_name": "mendio", "link": "https://stackoverflow.com/users/4538257/mendio"}, "reply_to_user": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 0, "creation_date": 1423254969, "post_id": 28373369, "comment_id": 45089039, "body": "I just tested and, the []map[string]interface{} provide what I was looking for. I&#39;ll go for it. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": false, "score": 1, "last_activity_date": 1423255111, "creation_date": 1423255111, "answer_id": 28374397, "question_id": 28373369, "link": "https://stackoverflow.com/questions/28373369/returning-multiple-maps-in-one-variable/28374397#28374397", "title": "Returning multiple maps in one variable", "body": "<p>For the record then, as I mentioned in the comments you could try returning a slice of maps such as </p>\n\n<pre><code>func whatever() []map[string]interface{} {\n}\n</code></pre>\n\n<p>Though depending on your data you might find a better solution in defining an appropriate struct for your domain and returning that.</p>\n"}], "owner": {"reputation": 21, "user_id": 4538257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64107b13295ffe4ed84ad44df88a5be9?s=128&d=identicon&r=PG&f=1", "display_name": "mendio", "link": "https://stackoverflow.com/users/4538257/mendio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1423255111, "creation_date": 1423251153, "question_id": 28373369, "link": "https://stackoverflow.com/questions/28373369/returning-multiple-maps-in-one-variable", "title": "Returning multiple maps in one variable", "body": "<p>I am working on a XML parser and I have the following problem :</p>\n\n<p>I have this function which gather some tags value, for example movie title and release date :</p>\n\n<pre><code>func whatever() map[string]interface{} {\n\n}\n</code></pre>\n\n<p>And I would like it to return something of this form :</p>\n\n<pre><code>[map[title:Movie01] map[title:Movie02]]\n</code></pre>\n\n<p>Without changing the return type.</p>\n\n<p>All I have for now is :</p>\n\n<pre><code>map[title:Movie01]\n</code></pre>\n\n<p>And obviously I cannot have duplicate \"title\" key in one single map.</p>\n\n<p>Can you help me on this ? It's been bothering me for a couple of hours now.</p>\n"}, {"tags": ["multithreading", "go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1423245361, "post_id": 28370903, "comment_id": 45084118, "body": "I&#39;m not sure what you&#39;re asking for: the Go runtime <i>explicitly</i> hides low-level OS threads from you, and only exposes some control over them with the sole purpose of allowing better integration with external C libraries (and syscalls). Attempting to work against it (say, bolting your own low-level OS management onto the Go runtime) is not gonna work because this idea defeats the chief purpose of the Go runtime (with its fine-tuned goroutine scheduling etc). I mean, you would be creating some other runtime, not working with Go."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1423245487, "post_id": 28370903, "comment_id": 45084185, "body": "I mean, for instance, you&#39;re able to call out into the C code (via <code>cgo</code> or otherwise) and do any wild things while there -- including creating new pthreads, using polling etc, -- but not actually executing Go code. So what&#39;s the purpose?"}, {"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1423246263, "post_id": 28370903, "comment_id": 45084547, "body": "Maybe it&#39;s merely to fulfil his curiosity? The question sounds theoretical."}, {"owner": {"reputation": 2354, "user_id": 3973051, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/594835486/picture?type=large", "display_name": "Jonathan Eustace", "link": "https://stackoverflow.com/users/3973051/jonathan-eustace"}, "edited": false, "score": 0, "creation_date": 1423248614, "post_id": 28370903, "comment_id": 45085795, "body": "Yes it&#39;s theoretical. It&#39;s actually for an assignment in a software engineering class where we are explicitly testing the difference in performance using standard multithreading, select multiplexing (or level triggered epoll) and edge triggered epoll. The professor has given us the option to chose our own language, thus we all chose a different language to use. I chose Go."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1423250878, "post_id": 28370903, "comment_id": 45086958, "body": "If I understand correctly, the Go runtime uses <a href=\"https://github.com/golang/go/blob/4ce06f4b5caab3874f30f14551aa3f8e08f2de3e/src/runtime/netpoll_epoll.go#L42\" rel=\"nofollow noreferrer\">edge triggering</a>. The abstraction provided by the Go runtime over these low-level details may get in the way of this assignment. If I had to do this assignment, I&#39;d do it in Python. All of the low-level details of threads, select, epoll, etc are exposed directly to the application programmer in Python."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1423258852, "post_id": 28370903, "comment_id": 45090875, "body": "@Jthomps -- seconding that Go seems the wrong language here. Since one way to use epoll is built into the runtime, doing it another way is likely to be harder and may not work correctly at all."}], "answers": [{"comments": [{"owner": {"reputation": 1377, "user_id": 3011280, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mkyAT.jpg?s=128&g=1", "display_name": "Oshan Wisumperuma", "link": "https://stackoverflow.com/users/3011280/oshan-wisumperuma"}, "edited": false, "score": 0, "creation_date": 1548409075, "post_id": 28371856, "comment_id": 95539108, "body": "when you should lock goroutine to a CPU thread: <a href=\"https://stackoverflow.com/a/25362395/3011280\">stackoverflow.com/a/25362395/3011280</a>"}], "tags": [], "owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "is_accepted": false, "score": 2, "last_activity_date": 1423245386, "creation_date": 1423245386, "answer_id": 28371856, "question_id": 28370903, "link": "https://stackoverflow.com/questions/28370903/how-can-i-manually-create-threads-in-go/28371856#28371856", "title": "How can I manually create threads in Go?", "body": "<p>You might be able to bind a goroutine to a CPU thread: <a href=\"http://play.golang.org/p/mNPCyvpN2R\" rel=\"nofollow\">http://play.golang.org/p/mNPCyvpN2R</a> (run locally on a multi CPU/core machine).</p>\n"}, {"comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 1, "creation_date": 1423331526, "post_id": 28383980, "comment_id": 45108484, "body": "...and this is a Very Good Thing in the sense that concurrency is traditionally considered <i>hard</i>, because of exposing unnecessary detail. CSP provides a clean abstraction for concurrency, not unlike the way that programming languages provide a clean abstraction over assembly code."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 5, "last_activity_date": 1423323293, "creation_date": 1423323293, "answer_id": 28383980, "question_id": 28370903, "link": "https://stackoverflow.com/questions/28370903/how-can-i-manually-create-threads-in-go/28383980#28383980", "title": "How can I manually create threads in Go?", "body": "<p>You cannot do that. In Go you cannot control this kind of stuff.</p>\n"}], "owner": {"reputation": 2354, "user_id": 3973051, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/594835486/picture?type=large", "display_name": "Jonathan Eustace", "link": "https://stackoverflow.com/users/3973051/jonathan-eustace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3844, "favorite_count": 2, "accepted_answer_id": 28383980, "answer_count": 2, "score": 1, "last_activity_date": 1423323293, "creation_date": 1423242010, "question_id": 28370903, "link": "https://stackoverflow.com/questions/28370903/how-can-i-manually-create-threads-in-go", "title": "How can I manually create threads in Go?", "body": "<p>I'm aware that goroutines are the way to deal with concurrency in Go, however I'm running a test in which I will be comparing a regular multithreaded server vs a server using level triggered epoll vs edge triggered epoll. I can figure out how to create the epoll ones, however I've searched hi and low on how to create threads manually to no avail. </p>\n"}, {"tags": ["go", "exec", "fork"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1521621637, "post_id": 28370646, "comment_id": 85804360, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10027477/golang-fork-process\">Golang fork process</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2338, "user_id": 1213885, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1e39a4c25252ea2ccc058a0c8a5176f4?s=128&d=identicon&r=PG", "display_name": "Shashwat", "link": "https://stackoverflow.com/users/1213885/shashwat"}, "edited": false, "score": 0, "creation_date": 1423242949, "post_id": 28370835, "comment_id": 45082869, "body": "It is forking <code>ls</code> process. I want to fork the same process which I am running. How can I do that - <code>fork</code> of <code>c++</code>?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 2338, "user_id": 1213885, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1e39a4c25252ea2ccc058a0c8a5176f4?s=128&d=identicon&r=PG", "display_name": "Shashwat", "link": "https://stackoverflow.com/users/1213885/shashwat"}, "edited": false, "score": 0, "creation_date": 1423243096, "post_id": 28370835, "comment_id": 45082940, "body": "@Shashwat not sure: I have only seen the opposite (<a href=\"http://stackoverflow.com/q/22805059/6309\">stackoverflow.com/q/22805059/6309</a>)"}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1423332681, "post_id": 28370835, "comment_id": 45108872, "body": "I&#39;m guessing here: there&#39;s a <code>return</code> missing inside the <code>if err != nil</code> block of <code>Fork</code>."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1423338065, "post_id": 28370835, "comment_id": 45110716, "body": "@Rick-777 that seems sensible, but I don&#39;t see one in the original source code (<a href=\"https://github.com/akshaydeo/go_process/blob/0c6cc456e650c80ba08254271a127f83df03f31b/process.go#L28-L40\" rel=\"nofollow noreferrer\">github.com/akshaydeo/go_process/blob/&hellip;</a>)"}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1423349677, "post_id": 28370835, "comment_id": 45114413, "body": "I took a look at the original, but it looks incorrect too."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 2, "last_activity_date": 1423241766, "creation_date": 1423241766, "answer_id": 28370835, "question_id": 28370646, "link": "https://stackoverflow.com/questions/28370646/how-do-i-fork-a-go-process/28370835#28370835", "title": "How do I fork a go process?", "body": "<p>One solution is to use a <code>exec.Command</code> executed in its goroutine.</p>\n\n<p>That is what the little project <a href=\"https://github.com/akshaydeo/go_process/blob/0c6cc456e650c80ba08254271a127f83df03f31b/process.go#L28-L40\" rel=\"nofollow\"><code>akshaydeo/go_process</code></a> does:</p>\n\n<pre><code>// Method to fork a process for given command\n// and return ProcessMonitor\nfunc Fork(processStateListener ProcessStateListener, cmdName string, cmdArgs ...string) {\n    go func() {\n        processMonitor := &amp;ProcessMonitor{}\n        args := strings.Join(cmdArgs, \",\")\n        command := exec.Command(cmdName, args)\n        output, err := command.Output()\n        if err != nil {\n            processMonitor.Err = err\n            processStateListener.OnError(processMonitor, err)\n        }       \n        processMonitor.Output = &amp;output\n        processStateListener.OnComplete(processMonitor)\n    }()\n}\n</code></pre>\n\n<p><a href=\"https://github.com/akshaydeo/go_process/blob/0c6cc456e650c80ba08254271a127f83df03f31b/process_test.go\" rel=\"nofollow\">The test <code>process_test.go</code></a> shows some examples:</p>\n\n<pre><code>// Test case for fork\nfunc TestFork(t *testing.T) {\n    processStateListenerImpl := &amp;ProcessStateListenerImpl{make(chan bool)}\n    Fork(processStateListenerImpl,\"ls\", \"-a\") //(\"ping\",\"192.168.3.141\",\"-c\",\"3\")\n    // waiting onto monitor\n    &lt;-processStateListenerImpl.monitor\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9285, "user_id": 39974, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dd37fe19111e25842a4fd0aea245d1a?s=128&d=identicon&r=PG", "display_name": "Ivan Vu\u010dica", "link": "https://stackoverflow.com/users/39974/ivan-vu%c4%8dica"}, "edited": false, "score": 10, "creation_date": 1461451671, "post_id": 28371586, "comment_id": 61207052, "body": "&quot;Every other conceivable use for fork() implies immediate exec(), and that&#39;s what exec.Command() et al is for, so why just not use it?&quot; There&#39;s setrlimit(), setting up SELinux, chroot()ing, closing or setting up FDs before handing over control -- and those need to happen between fork() and exec(), no?"}, {"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 0, "creation_date": 1494006002, "post_id": 28371586, "comment_id": 74660982, "body": "What if &quot;best-effort asynchronous process state snapshotting&quot; is <i>precisely</i> what I am trying to do?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 1, "creation_date": 1494573459, "post_id": 28371586, "comment_id": 74895687, "body": "@cpcallen, I&#39;m afraid, that would be &quot;not in Go&quot; <i>this way.</i> The essense of the problem is that the Go runtime does two things to the OS-level threads: a) uses them to power your goroutines; b) uses them for its own needs. Since only a single threads survives a <code>fork()</code>, as soon as it&#39;s resumed in a new process, it will be in a half-assed state, impossible to work properly."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 1, "creation_date": 1494573722, "post_id": 28371586, "comment_id": 74895835, "body": "@cpcallen, there are two things possibly worthy of doing. 1) You may <code>fork()</code> in a call to some <code>C</code> code arranged via <code>cgo</code>; and that code must not &quot;return&quot; (that is, it must eventually call <code>exit(2)</code>). The upside is that the Go runtime, while its data pages will be &quot;inherited&quot; by the forked process, won&#39;t ever be given control. The downside is that your <code>C</code> code will have hard time accessing regular data managed by the Go runtime because of <a href=\"https://github.com/golang/go/issues/12416\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 1, "creation_date": 1494573897, "post_id": 28371586, "comment_id": 74895945, "body": "@cpcallen, 2) You sidestep a Go&#39;s GC (and the strict rules attached to it w.r.t. <code>cgo</code> calls) by allocating data for Go values from a custom memory region not owned by the Go runtime (typically obtained by <code>mmap(2)</code>-ing an anonymous memory region). This is cumbersome to maintain, but such data may be freely shared between the C and the Go worlds."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 1, "creation_date": 1494574087, "post_id": 28371586, "comment_id": 74896070, "body": "@cpcallen, all in all, if we squint at it harder, we&#39;ll see that process-state snapshotting via forking is actually employing a hack, so a proper solution would be having a similar hack somewhere in the Go&#39;s runtime -- working cooperatively with its GC. So may be start a thread on the <a href=\"https://groups.google.com/d/forum/golang-nuts\" rel=\"nofollow noreferrer\">Go mailing list</a> soliciting the insight of those who know the intimate details of the runtime?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 9285, "user_id": 39974, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dd37fe19111e25842a4fd0aea245d1a?s=128&d=identicon&r=PG", "display_name": "Ivan Vu\u010dica", "link": "https://stackoverflow.com/users/39974/ivan-vu%c4%8dica"}, "edited": false, "score": 5, "creation_date": 1494574458, "post_id": 28371586, "comment_id": 74896258, "body": "@IvanVu\u010dica, Go has direct support for some of this stuff in its <code>syscall.ForkExec()</code>: this function accepts an instance of a platform-speficic <code>syscall.ProcAttr</code> type which gives access to an assorted set of features including inheriting of FDs, setting the <code>cwd</code>, the environment block, controlling of session creation, chrooting, credentials, <code>clone(2)</code> flags etc. I&#39;m afraid SELinux is not supported (and neither is AppArmor and friends). See <code>go doc syscall.ProcAttr</code> and <code>go doc syscall.SysProcAttr</code> for more info."}, {"owner": {"reputation": 9285, "user_id": 39974, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dd37fe19111e25842a4fd0aea245d1a?s=128&d=identicon&r=PG", "display_name": "Ivan Vu\u010dica", "link": "https://stackoverflow.com/users/39974/ivan-vu%c4%8dica"}, "edited": false, "score": 0, "creation_date": 1494577183, "post_id": 28371586, "comment_id": 74897916, "body": "Thanks, I will take a look, but I do need cgroups, selinux, rlimits, etc. All I was saying is there are reasons for doing it multistep."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 9285, "user_id": 39974, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dd37fe19111e25842a4fd0aea245d1a?s=128&d=identicon&r=PG", "display_name": "Ivan Vu\u010dica", "link": "https://stackoverflow.com/users/39974/ivan-vu%c4%8dica"}, "edited": false, "score": 0, "creation_date": 1494577500, "post_id": 28371586, "comment_id": 74898121, "body": "@IvanVu\u010dica, sure! That&#39;s all about tradeoffs: when the original <code>fork()</code> was envisioned and implemented, there existed no software with a kind of layer of abstraction over the native OS threads the Go runtime implements, so this model simply does not work for Go. I&#39;m sure its designers were fully aware about this problem but they had to make this decision ;-) Again, SO is not fit for such broad discussions -- I invite you to post to a mailing list instead."}, {"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 2, "creation_date": 1494597601, "post_id": 28371586, "comment_id": 74911376, "body": "@kostix: very useful insights &amp; suggestions.  Re: <code>fork()</code>: when it was envisioned there was no &quot;software with a kind of layer of abstraction over native OS threads&quot; because <a href=\"http://www.serpentine.com/blog/threads-faq/the-history-of-threads/\" rel=\"nofollow noreferrer\">UNIX didn&#39;t get native OS threads until nearly a decade later</a>.  :-)"}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 40, "last_activity_date": 1572822271, "last_edit_date": 1572822271, "creation_date": 1423244359, "answer_id": 28371586, "question_id": 28370646, "link": "https://stackoverflow.com/questions/28370646/how-do-i-fork-a-go-process/28371586#28371586", "title": "How do I fork a go process?", "body": "<p>You supposedly want <code>syscall.ForkExec()</code> from the <a href=\"http://golang.org/pkg/syscall/\" rel=\"noreferrer\"><code>syscall</code></a> package.</p>\n\n<p>Note that <code>fork()</code> has been invented at the time when no threads were used at all, and a process had always had just a single thread of execution in it, and hence forking it was safe. With Go, the situation is radically different as it heavily uses OS-level threads to power its goroutine scheduling.</p>\n\n<p>Now, unadorned <a href=\"http://linux.die.net/man/2/fork\" rel=\"noreferrer\"><code>fork(2)</code></a> on Linux will make the child process have just the single thread&mdash;the one which called <code>fork(2)</code> in the parent process&mdash;among all those which were active, including some crucial threads used by the Go runtime.  Basically this means that you simply <em>cannot expect the child process to be able to continue executing Go code,</em> and the only thing you can sensibly do is to somehow immediately perform <code>exec(2)</code>.  Notice that that's what <code>syscall.ForkExec()</code> is supposed to be used for.</p>\n\n<p>And now think about the problem further.  I'd say these days the only thing a direct call to <code>fork(2)</code> is useful for is \"best-effort asynchronous process state snapshotting\"&mdash;the kind, say, <a href=\"http://redis.io\" rel=\"noreferrer\">Redis</a> uses.  This technique relies on the fact the child process inherits all the memory data pages from its parent, but the OS uses copy-on-write technique to not really copy all that data, so the child can just sit there and save all the data structures to disk while its parent is chugging away modifying them in its own address space.  Every other conceivable use for <code>fork()</code> implies immediate <code>exec()</code>, and that's what <code>exec.Command()</code> et al is for, so why just not use it?</p>\n"}], "owner": {"reputation": 2338, "user_id": 1213885, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1e39a4c25252ea2ccc058a0c8a5176f4?s=128&d=identicon&r=PG", "display_name": "Shashwat", "link": "https://stackoverflow.com/users/1213885/shashwat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26797, "favorite_count": 13, "accepted_answer_id": 28371586, "answer_count": 2, "score": 14, "last_activity_date": 1572822271, "creation_date": 1423241157, "question_id": 28370646, "link": "https://stackoverflow.com/questions/28370646/how-do-i-fork-a-go-process", "title": "How do I fork a go process?", "body": "<p>I want to fork a go process and get back the id of the new process(es), but all I can see in the <code>exec</code> or <code>os</code> libraries is to start a new process.</p>\n"}, {"tags": ["windows", "shell", "go", "web-frameworks", "beego"], "answers": [{"comments": [{"owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1423247490, "post_id": 28369468, "comment_id": 45085219, "body": "The %GOPATH% and %GOPATH%/bin paths working fine. The weird thing is, that I can do the following, if I&#39;m in the %GOPATH%/src folder: =&gt;  ` ..\\bin\\bee new project_name`   &lt;=              Bee.exe is present but I can&#39;t call it, if I&#39;m located in %GOPATH%.   <b>Stackoverflow doesn&#39;t seem to use my formating</b>"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1423253681, "post_id": 28369468, "comment_id": 45088412, "body": "&quot;bee is present but I can&#39;t call it&quot;: do you mean you get the same error message, even when you do a <code>..\\bin\\bee bew project_name</code> from <code>%GOPATH%\\src</code>? Or is it working in that specific case?"}, {"owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1423254347, "post_id": 28369468, "comment_id": 45088737, "body": "I can create a beego project with the shown command inside the /src dir but <b>can&#39;t</b> do it under %GOPATH%. The error message says, a cmdlet with the name bee can&#39;t be found."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1423255792, "post_id": 28369468, "comment_id": 45089468, "body": "@user3147268 that looks like a command discovery issue (as in <a href=\"http://powershell.cz/2012/12/07/last-modified-date-brainteaser/\" rel=\"nofollow noreferrer\">powershell.cz/2012/12/07/last-modified-date-brainteaser</a>, mentioned from <a href=\"http://stackoverflow.com/a/19579529/6309\">stackoverflow.com/a/19579529/6309</a>). In your Powershell session, does your <code>%PATH%</code> includes <code>%GOPATH%\\bin</code>?"}, {"owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1423256115, "post_id": 28369468, "comment_id": 45089636, "body": "I just needed to add %GOPATH%\\bin to the %PATH% variable. Now it works also under %GOPATH%. Thanks for your help ;)"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1423256208, "post_id": 28369468, "comment_id": 45089683, "body": "@user3147268 Great! I have included your comment in the answer for more visibility."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1423256188, "last_edit_date": 1495541571, "creation_date": 1423237587, "answer_id": 28369468, "question_id": 28364388, "link": "https://stackoverflow.com/questions/28364388/beego-golang-create-new-project-via-cli-in-windows/28369468#28369468", "title": "Beego (Golang): Create new project via CLI in Windows", "body": "<p>Make sure your environment variables are correctly set in your Powershell setup.<br>\nSee for instance \"<a href=\"https://stackoverflow.com/q/12587253/6309\">how to modify <code>GOPATH</code> in powershell</a>\"</p>\n\n<ul>\n<li><code>GOPATH</code> needs to be set</li>\n<li><code>%GOPAHT%\\bin</code> needs to be added to the <code>PATH</code> and <code>bee</code> must be in that folder.</li>\n</ul>\n\n<p>Note that you can set those variables in your <code>%USERPROFILE%\\Documents\\WindowsPowerShell\\Profile.ps1</code>, which is similar to  a <code>~\\.bashrc</code>.</p>\n\n<p>The OP adds <a href=\"https://stackoverflow.com/questions/28364388/beego-golang-create-new-project-via-cli-in-windows/28369468?noredirect=1#comment45089636_28369468\">in the comments</a>:</p>\n\n<blockquote>\n  <p>I just needed to add <code>%GOPATH%\\bin</code> to the <code>%PATH%</code> variable.<br>\n  Now it works also under <code>%GOPATH%</code></p>\n</blockquote>\n"}], "owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 1, "accepted_answer_id": 28369468, "answer_count": 1, "score": 2, "last_activity_date": 1423256188, "creation_date": 1423220866, "question_id": 28364388, "link": "https://stackoverflow.com/questions/28364388/beego-golang-create-new-project-via-cli-in-windows", "title": "Beego (Golang): Create new project via CLI in Windows", "body": "<p>I wanted to play with the Beego webframework. A simple command in the shell can setup a new project directory. If I run the following commandin Window's Powershell I get an error, because the command is unknown:</p>\n\n<p><code>\nbee new beego_project\n</code></p>\n\n<p>How can I register this command to make use of it?</p>\n"}, {"tags": ["tcp", "go"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 3, "creation_date": 1423219596, "post_id": 28363575, "comment_id": 45069546, "body": "In general it will not, I&#39;ve not enough time to post a complete answer - however the tcpkeepalive library you are using is buggy and seems to duplicate and leak a file descriptor."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 4, "last_activity_date": 1423255119, "creation_date": 1423255119, "answer_id": 28374399, "question_id": 28363575, "link": "https://stackoverflow.com/questions/28363575/why-does-tcp-keep-alive-affect-the-tcp-close-in-go/28374399#28374399", "title": "why does tcp-keep-alive affect the tcp-close in go?", "body": "<p>Don't use that keepalive library. It duplicates file descriptors, and fails to close them.</p>\n\n<p>If you need to set KeepAlive, use the methods provided in the net package. </p>\n\n<ul>\n<li><a href=\"http://golang.org/pkg/net/#TCPConn.SetKeepAlive\" rel=\"nofollow\">SetKeepAlive</a></li>\n<li><a href=\"http://golang.org/pkg/net/#TCPConn.SetKeepAlivePeriod\" rel=\"nofollow\">SetKeepAlivePeriod</a></li>\n</ul>\n\n<p>You likely don't need any extra options set, but only if you're certain you do, then you can try to apply what's needed with the appropriate syscalls.</p>\n"}], "owner": {"reputation": 1456, "user_id": 1784595, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KoQV5.png?s=128&g=1", "display_name": "frank.lin", "link": "https://stackoverflow.com/users/1784595/frank-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2917, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1423255119, "creation_date": 1423218308, "last_edit_date": 1423219269, "question_id": 28363575, "link": "https://stackoverflow.com/questions/28363575/why-does-tcp-keep-alive-affect-the-tcp-close-in-go", "title": "why does tcp-keep-alive affect the tcp-close in go?", "body": "<p>I have a server, when accepting a connection, I set tcp-keep-alive  for 120seconds.But when I close the connection, acctually the connection doesn't close.by <code>netstat -anp | grep  9999</code>, I found the state was <code>ESTABLISHED</code> .And the client didn't receive any error from the socket , either. I want to know will tcp-keep-alive affect the tcp-close?</p>\n\n<p>PS  go 1.4  centos</p>\n\n<pre><code>package main\nimport (\n    \"github.com/felixge/tcpkeepalive\"\n    \"net\"\n    \"runtime\"\n    \"time\"\n)\nfunc  Start() {\n    tcpAddr, err := net.ResolveTCPAddr(\"tcp4\", \"127.0.0.1:9999\")\n    if err != nil {\n        return\n    }\n    listener, err := net.ListenTCP(\"tcp\", tcpAddr)\n    if err != nil {\n        return\n    }\n    for {\n        conn, err := listener.AcceptTCP()\n        if err != nil {\n            continue\n        }\n        go handleClient(conn)\n    }\n}\n\nfunc handleClient(conn *net.TCPConn) {\n    kaConn, err := tcpkeepalive.EnableKeepAlive(conn)\n    if err != nil {\n    } else {\n        kaConn.SetKeepAliveIdle(120 * time.Second)\n        kaConn.SetKeepAliveCount(4)\n        kaConn.SetKeepAliveInterval(5 * time.Second)\n    }\n    time.Sleep(time.Second * 3)\n    conn.Close()\n    return\n}\n\nfunc main() {\n    runtime.GOMAXPROCS(runtime.NumCPU())\n    Start()\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 1017, "user_id": 2601733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AFDjZ.jpg?s=128&g=1", "display_name": "Andy Xu", "link": "https://stackoverflow.com/users/2601733/andy-xu"}, "is_accepted": false, "score": 0, "last_activity_date": 1423212043, "last_edit_date": 1495540232, "creation_date": 1423211726, "answer_id": 28361625, "question_id": 28359882, "link": "https://stackoverflow.com/questions/28359882/golang-mgo-populate-nested-structs-by-id-mongodb/28361625#28361625", "title": "Golang Mgo populate nested structs by ID (Mongodb)", "body": "<p>Please check out the following question on Stack Overflow: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/2350495/how-do-i-perform-the-sql-join-equivalent-in-mongodb\">How do I perform the SQL Join equivalent in MongoDB?</a></p>\n\n<p>However, it's not always necessary to simulate joins for a NoSQL database such as MongoDB. You might want to consider doing an extra query or using cache when you need to get <code>User</code> for all <code>Post</code>s.</p>\n\n<p>P.S. Even if you are using SQL database, <code>JOIN</code> statement should be carefully reviewed and is not recommended on production, because of its potential performance issue. </p>\n"}], "owner": {"reputation": 573, "user_id": 1886300, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/2ccaf4076b0f55b5a4ca31dd3b6e5aa9?s=128&d=identicon&r=PG", "display_name": "TheBigC", "link": "https://stackoverflow.com/users/1886300/thebigc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2708, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423212043, "creation_date": 1423204414, "last_edit_date": 1423205689, "question_id": 28359882, "link": "https://stackoverflow.com/questions/28359882/golang-mgo-populate-nested-structs-by-id-mongodb", "title": "Golang Mgo populate nested structs by ID (Mongodb)", "body": "<p>Using mongoose with NodeJs for document population to simulate joins is very common. I'm trying to understand how to achieve something similar with go and mgo.</p>\n\n<pre><code>type User struct {\n    Id bson.ObjectId `json:\"_id\" bson:\"_id\"`\n    UserName string\n}\n\ntype MessageBoard {\n    Id bson.ObjectId `json:\"_id\" bson:\"_id\"`\n}\n\ntype Tag struct {\n    Id bson.ObjectId `json:\"_id\" bson:\"_id\"`\n    text string\n}\n\ntype Post struct {\n    Id bson.ObjectId `json:\"_id\" bson:\"_id\"`\n    Text string\n    MessageBoard bson.ObjectId\n    User bson.ObjectId\n    Tags []bson.ObjectId\n}\n</code></pre>\n\n<p>I would like to store only User and Tag ids in Post. A user can have many posts and if the user edits UserName all posts should reflect this.</p>\n\n<pre><code>var posts []Post\n\nerr := PostCollection.Find(bson.M{\"MessageBoard\":mBoardId}).All(&amp;posts)\nif err != nil {\n    return nil, err\n}\n</code></pre>\n\n<p>This is a simple query to get posts, but how do I efficiently get posts with User and Tags models populated?</p>\n\n<p>There is Sleep (an Mgo extension) which appears to do what I am looking for, but I am interested in understanding the performance implications and design options better and if there is a solution using Mgo alone. <a href=\"https://github.com/mansoor-s/Sleep\" rel=\"nofollow\">https://github.com/mansoor-s/Sleep</a></p>\n"}, {"tags": ["time", "go", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 1, "last_activity_date": 1423196404, "creation_date": 1423196404, "answer_id": 28358526, "question_id": 28357556, "link": "https://stackoverflow.com/questions/28357556/golang-throttle-time-delay-function-is-not-working-in-goroutine-works-fine-i/28358526#28358526", "title": "Golang: throttle (time delay) function is not working in goroutine (works fine in main thread)", "body": "<p>Because you're introducing a data race, multiple routines are accessing / changing c.LastCallTime.</p>\n\n<p>You use <a href=\"http://golang.org/pkg/time/#Tick\" rel=\"nofollow\"><code>time.Tick</code></a> instead or make <code>c.LastCallTime</code> an <code>int64</code> (<code>c.LastCallTime = time.Now().Unix()</code>) and use <code>atomic.LoadInt64/StoreInt64</code> to check it.</p>\n"}, {"comments": [{"owner": {"reputation": 139, "user_id": 1946717, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/12596408b06f304d2f980914bc55ed6f?s=128&d=identicon&r=PG", "display_name": "Mike in SAT", "link": "https://stackoverflow.com/users/1946717/mike-in-sat"}, "edited": false, "score": 0, "creation_date": 1423674208, "post_id": 28369115, "comment_id": 45246323, "body": "Accepting my own answer, as this solution worked perfectly in production. several hundred long calls (~1-2 seconds per query) executed with no noticeable delay between them and overall time was greatly reduced by threading the calls, and several thousand short calls (&lt; .5 seconds per query) were properly throttled to exactly the amount they needed to be and no more. A benefit from threading was still seen, as the processing of the return data was also done in the goroutines."}], "tags": [], "owner": {"reputation": 139, "user_id": 1946717, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/12596408b06f304d2f980914bc55ed6f?s=128&d=identicon&r=PG", "display_name": "Mike in SAT", "link": "https://stackoverflow.com/users/1946717/mike-in-sat"}, "is_accepted": true, "score": 0, "last_activity_date": 1423674308, "last_edit_date": 1423674308, "creation_date": 1423236443, "answer_id": 28369115, "question_id": 28357556, "link": "https://stackoverflow.com/questions/28357556/golang-throttle-time-delay-function-is-not-working-in-goroutine-works-fine-i/28369115#28369115", "title": "Golang: throttle (time delay) function is not working in goroutine (works fine in main thread)", "body": "<p>Answering my own question, as I happened across a few solutions late last night.\n   The simplest answer for me was to use a sync.Mutex variable to lock and unlock the throttle function to make sure I wasn't accidentally hitting it at the same time. Another option would have been to move my throttling service to be housed in its own goroutine function (thus eliminating concurrent calls) and communicating throttled/OK with channels, but for this application the Mutex was a cleaner solution.\n   Here is the simplified version of the working code for those looking for a similar solution:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"sync\"\n)\n\ntype tStruct struct {\n    delay time.Duration\n    last time.Time\n    lock sync.Mutex //this will be our locking variable\n}\n\nfunc (t *tStruct) createT() *tStruct {\n    return &amp;tStruct {\n        delay: 500*time.Millisecond,\n        last: time.Now(),\n    }\n}\n\nfunc (t *tStruct) throttle(th int) {\n    //we lock our function, and any other routine calling this function will block.\n    t.lock.Lock()\n    //and we'll defer an unlock, so when we exit the throttle, we'll be ready for another call.\n    defer t.lock.Unlock()\n    fmt.Printf(\"\\tThread %v Entering Throttle Check.\\n\", th)\n    defer fmt.Printf(\"\\tThread %v Leaving Throttle Check.\\n\", th)\n    for {\n        p := time.Now().Sub(t.last)\n        if p &lt; t.delay {\n            fmt.Printf(\"\\tThread %v Sleeping %v.\\n\", th, t.delay-p)\n            time.Sleep(t.delay-p)\n        } else {\n            fmt.Printf(\"\\tThread %v No longer Throttled.\\n\", th)\n            t.last = time.Now()\n            break\n        }\n    }\n}\n\nfunc (t *tStruct) worker(rch &lt;-chan string, sch chan&lt;- string, th int) {\n    fmt.Printf(\"Thread %v starting up.\\n\", th)\n    defer fmt.Printf(\"Thread %v Dead.\\n\", th)\n    sch &lt;-\"READY\"\n    for {\n        r := &lt;-rch\n        fmt.Printf(\"Thread %v received %v\\n\", th, r)\n        switch r {\n            case \"STOP\":\n                fmt.Printf(\"Thread %v returning.\\n\", th)\n                sch &lt;-\"QUITTING\"\n                return\n            default:\n                fmt.Printf(\"Thread %v processing %v.\\n\", th, r)\n                t.throttle(th)\n                fmt.Printf(\"Thread %v done with %v.\\n\", th, r)\n                sch &lt;-\"OK\"\n        }\n    }\n}\n\nfunc main() {\n    ts := tStruct{}\n    ts.delay = 500*time.Millisecond\n    ts.last = time.Now()\n    sch := make(chan string)\n    rch := make(chan string)\n    tC := 3\n    tA := 0\n\n    fmt.Println(\"Starting Threads\")\n    for i:=1; i&lt;(tC+1); i++ {\n        go ts.worker(sch, rch, i)\n        r := &lt;-rch\n        if r==\"READY\" {\n            tA++\n        } else {\n            fmt.Println(\"ERROR not READY\")\n        }\n    }\n\n    fmt.Println(\"Feeding All Threads\")\n    for i:=1; i&lt;(tC+1); i++ {\n        sch &lt;- \"WORK\"\n    }\n\n    fmt.Println(\"Listening for threads\")\n    for tA &gt; 0{\n        r := &lt;-rch\n        switch r {\n            case \"QUITTING\":\n                tA--\n                fmt.Println(\"main received QUITTING\")\n                continue\n            case \"OK\":\n                fmt.Println(\"main received OK\")\n                sch &lt;-\"STOP\"\n                continue\n            default:\n                fmt.Println(\"Shouldn't be here!!!\")\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 139, "user_id": 1946717, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/12596408b06f304d2f980914bc55ed6f?s=128&d=identicon&r=PG", "display_name": "Mike in SAT", "link": "https://stackoverflow.com/users/1946717/mike-in-sat"}, "edited": false, "score": 0, "creation_date": 1423256139, "post_id": 28370381, "comment_id": 45089645, "body": "I considered that, but I don&#39;t want to wait a half second to farm the next job out, nor do I want to force a half second wait if the call already took 1.7 seconds to complete. I just want to ensure AT LEAST a half second has passed since the last actual http call was sent. It it has already been that long or longer, no delay should be introduced. The code in my own answer seems to do the trick with the sync.mutex."}, {"owner": {"reputation": 171, "user_id": 4493198, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kAjSGsEiJG4/AAAAAAAAAAI/AAAAAAABW2o/rzwHgxgYxY4/photo.jpg?sz=128", "display_name": "iccananea", "link": "https://stackoverflow.com/users/4493198/iccananea"}, "reply_to_user": {"reputation": 139, "user_id": 1946717, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/12596408b06f304d2f980914bc55ed6f?s=128&d=identicon&r=PG", "display_name": "Mike in SAT", "link": "https://stackoverflow.com/users/1946717/mike-in-sat"}, "edited": false, "score": 0, "creation_date": 1423407526, "post_id": 28370381, "comment_id": 45126982, "body": "But thst&#39;s exactly what&#39;s happening. The ticker will not introduce more delay than the duration defined. So, in this particular example, if you block on the ticker after the 500ms have passed, it will not block 500ms more."}], "tags": [], "owner": {"reputation": 171, "user_id": 4493198, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kAjSGsEiJG4/AAAAAAAAAAI/AAAAAAABW2o/rzwHgxgYxY4/photo.jpg?sz=128", "display_name": "iccananea", "link": "https://stackoverflow.com/users/4493198/iccananea"}, "is_accepted": false, "score": 1, "last_activity_date": 1423240252, "creation_date": 1423240252, "answer_id": 28370381, "question_id": 28357556, "link": "https://stackoverflow.com/questions/28357556/golang-throttle-time-delay-function-is-not-working-in-goroutine-works-fine-i/28370381#28370381", "title": "Golang: throttle (time delay) function is not working in goroutine (works fine in main thread)", "body": "<p>There is actually a much easier way to do this: <a href=\"http://play.golang.org/p/FUIt5hjskt\" rel=\"nofollow\">create a time ticker</a>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    rateLimit := time.Tick(500 * time.Millisecond)\n    &lt;-rateLimit\n\n    var wg sync.WaitGroup\n    for i := 0; i &lt; 10; i++ {\n        wg.Add(1)\n        go func(i int) {\n            &lt;-rateLimit\n            fmt.Println(\"Hello\", i)\n            wg.Done()\n        }(i)\n    }\n    wg.Wait()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 3813751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d5eaa07d882d324b1f6b5a282eed3f?s=128&d=identicon&r=PG", "display_name": "user3813751", "link": "https://stackoverflow.com/users/3813751/user3813751"}, "is_accepted": false, "score": 0, "last_activity_date": 1423435192, "creation_date": 1423435192, "answer_id": 28400216, "question_id": 28357556, "link": "https://stackoverflow.com/questions/28357556/golang-throttle-time-delay-function-is-not-working-in-goroutine-works-fine-i/28400216#28400216", "title": "Golang: throttle (time delay) function is not working in goroutine (works fine in main thread)", "body": "<p>Your new code is better. As mentioned in another answer you had a race. Go has a built in race detector <code>go build -race</code>. It's an amazing tool and would have found the race for you with a good unit test. </p>\n\n<p>I believe one of your initial assumptions is flawed. By pacing all API calls you eliminate the chance for any bursting. In your scheme every API call takes a latency hit even when it might not have to. Unless you are sure that every API call is going to hit the throttle there is a better way.</p>\n\n<p>Start a time.NewTicker to 10 seconds and initialize a counter to 0. Increment the counter for each API request. If the counter gets to 20 sleep the goroutines until the timer goes off. When the timer goes off reset the counter and continue the sleeping goroutines.</p>\n\n<p>I've always wanted to code an API rate limiter so I coded it up and you can see it here:\n<a href=\"https://github.com/tildeleb/limiter/blob/master/limiter.go\" rel=\"nofollow\">https://github.com/tildeleb/limiter/blob/master/limiter.go</a></p>\n\n<p>Except for the example, it's untested. Any feedback, please create an issue on github.</p>\n"}], "owner": {"reputation": 139, "user_id": 1946717, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/12596408b06f304d2f980914bc55ed6f?s=128&d=identicon&r=PG", "display_name": "Mike in SAT", "link": "https://stackoverflow.com/users/1946717/mike-in-sat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3087, "favorite_count": 0, "accepted_answer_id": 28369115, "answer_count": 4, "score": 0, "last_activity_date": 1423674308, "creation_date": 1423189439, "question_id": 28357556, "link": "https://stackoverflow.com/questions/28357556/golang-throttle-time-delay-function-is-not-working-in-goroutine-works-fine-i", "title": "Golang: throttle (time delay) function is not working in goroutine (works fine in main thread)", "body": "<p>So I am writing a utility to query an API at work, and they throttle to 20 calls every 10 seconds. Easy, I'll just throttle my calls to at least .5 seconds passed since last call. My Throttle utility worked fine until I tried to use goroutines. </p>\n\n<p>Right now I am using a struct/method combo:</p>\n\n<pre><code>func (c *CTKAPI) Throttle() {\nif c.Debug{fmt.Println(\"\\t\\t\\tEntering Throttle()\")}\nfor { //in case something else makes a call while we're sleeping, we need to re-check\n    if t := time.Now().Sub(c.LastCallTime); t &lt; c.ThrottleTime {\n        if c.Debug{fmt.Printf(\"\\t\\t\\tThrottle: Sleeping %v\\n\", c.ThrottleTime - t)}\n        time.Sleep(c.ThrottleTime - t)\n    } else {\n        if c.Debug{fmt.Println(\"\\t\\t\\tThrottle: Released.\")}\n        break\n    }\n}\nc.LastCallTime = time.Now()\nif c.Debug{fmt.Println(\"\\t\\t\\tExiting Throttle()\")}\n</code></pre>\n\n<p>}</p>\n\n<p>And then I call whatever.Throttle() before each call in each goroutine to make sure i've waited at least a half second before launching my next call.</p>\n\n<p>But that seems to be unreliable and gives unpredictable results. Is there a more elegant way of throttling concurrent requests?</p>\n\n<p>-Mike</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1051, "user_id": 809410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ffc49c668c0066df3196ecf48aa39f?s=128&d=identicon&r=PG", "display_name": "iant", "link": "https://stackoverflow.com/users/809410/iant"}, "edited": false, "score": 1, "creation_date": 1423184891, "post_id": 28354879, "comment_id": 45057243, "body": "There is no official documentation saying &quot;calling a C function does not block other goroutines&quot; because that is the way it should naturally work.  It would only be necessary to document this if it did not work this way."}], "tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": false, "score": 9, "last_activity_date": 1423192109, "last_edit_date": 1423192109, "creation_date": 1423173607, "answer_id": 28354879, "question_id": 28354141, "link": "https://stackoverflow.com/questions/28354141/c-code-and-goroutine-scheduling/28354879#28354879", "title": "C code and goroutine scheduling", "body": "<p>This is a very good question for which I did not find any official statement on the fly except in the code. I would be glad for any hint to official documentation.</p>\n\n<p>The answer is <strong>no, cgo calls do not block the scheduler</strong>.</p>\n\n<p>For the following it's good to know that internally Go uses <strong>G</strong> for goroutines, <strong>M</strong> for machines (threads) and <strong>P</strong> for proccessor. Goroutines are run on processors that run on machines.</p>\n\n<p>Calling a C function from G works as follows according to the <a href=\"https://code.google.com/p/go/source/browse/src/runtime/cgocall.go?name=go1.4\" rel=\"noreferrer\">code documentation</a>:</p>\n\n<pre><code>// To call into the C function f from Go, the cgo-generated code calls\n// runtime.cgocall(_cgo_Cfunc_f, frame), where _cgo_Cfunc_f is a\n// gcc-compiled function written by cgo.\n//\n// runtime.cgocall (below) locks g to m, calls entersyscall\n// so as not to block other goroutines or the garbage collector,\n// and then calls runtime.asmcgocall(_cgo_Cfunc_f, frame).\n//\n// runtime.asmcgocall (in asm_$GOARCH.s) switches to the m-&gt;g0 stack\n// (assumed to be an operating system-allocated stack, so safe to run\n// gcc-compiled code on) and calls _cgo_Cfunc_f(frame).\n//\n// _cgo_Cfunc_f invokes the actual C function f with arguments\n// taken from the frame structure, records the results in the frame,\n// and returns to runtime.asmcgocall.\n//\n// After it regains control, runtime.asmcgocall switches back to the\n// original g (m-&gt;curg)'s stack and returns to runtime.cgocall.\n//\n// After it regains control, runtime.cgocall calls exitsyscall, which blocks\n// until this m can run Go code without violating the $GOMAXPROCS limit,\n// and then unlocks g from m.\n</code></pre>\n\n<p><code>entersyscall</code> essentially tells the runtime that this goroutine is now under 'external' control, just like in the situation when we do syscalls to the kernel. Another probably useful bit is that locking <code>g</code> to <code>m</code> (locking the cgo calling goroutine to the OS thread) enables the runtime to allocate a new OS thread (theoretically exceeding <code>GOMAXPROCS</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 1051, "user_id": 809410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ffc49c668c0066df3196ecf48aa39f?s=128&d=identicon&r=PG", "display_name": "iant", "link": "https://stackoverflow.com/users/809410/iant"}, "is_accepted": true, "score": 12, "last_activity_date": 1423184813, "creation_date": 1423184813, "answer_id": 28356944, "question_id": 28354141, "link": "https://stackoverflow.com/questions/28354141/c-code-and-goroutine-scheduling/28356944#28356944", "title": "C code and goroutine scheduling", "body": "<p>Calling a C function from Go code does not prevent other goroutines from running.</p>\n\n<p>It does have an effect on the scheduler.  A goroutine running a C function does not necessarily count against the <a href=\"http://golang.org/pkg/runtime/#GOMAXPROCS\">GOMAXPROCS</a> limit.  It will start out counting against GOMAXPROCS, but if the C function has blocked for more than 20us at the time the sysmon background goroutine runs, then the scheduler will be permitted to start another goroutine if there is one ready to run.  These details depend on the specific Go version and are subject to change.</p>\n"}], "owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3509, "favorite_count": 4, "accepted_answer_id": 28356944, "answer_count": 2, "score": 10, "last_activity_date": 1423192109, "creation_date": 1423170953, "last_edit_date": 1423173046, "question_id": 28354141, "link": "https://stackoverflow.com/questions/28354141/c-code-and-goroutine-scheduling", "title": "C code and goroutine scheduling", "body": "<p>When I invoke a C code from a goroutine, does it affect scheduling of other goroutines in any way? I know that if I call a NIF in Erlang, it blocks the other (Erlang) processes, until the function returns. Is this the case in Golang? Does C code block the goroutines scheduler?</p>\n"}, {"tags": ["go", "writer"], "comments": [{"owner": {"reputation": 17004, "user_id": 1170385, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c171c042b0e2f97e9dedf0a6d76ea7e5?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1170385/alex"}, "edited": false, "score": 0, "creation_date": 1423168167, "post_id": 28353313, "comment_id": 45050557, "body": "Perhaps use this Play as a starting point:"}, {"owner": {"reputation": 17004, "user_id": 1170385, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c171c042b0e2f97e9dedf0a6d76ea7e5?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1170385/alex"}, "edited": false, "score": 0, "creation_date": 1423168504, "post_id": 28353313, "comment_id": 45050752, "body": "<a href=\"http://play.golang.org/p/wNtHFHobhm\" rel=\"nofollow noreferrer\">play.golang.org/p/wNtHFHobhm</a>"}, {"owner": {"reputation": 17004, "user_id": 1170385, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c171c042b0e2f97e9dedf0a6d76ea7e5?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1170385/alex"}, "reply_to_user": {"reputation": 13728, "user_id": 336186, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u4ox0.png?s=128&g=1", "display_name": "Lukasz Madon", "link": "https://stackoverflow.com/users/336186/lukasz-madon"}, "edited": false, "score": 0, "creation_date": 1423169602, "post_id": 28353313, "comment_id": 45051314, "body": "~100 MB on a very small server."}, {"owner": {"reputation": 17004, "user_id": 1170385, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c171c042b0e2f97e9dedf0a6d76ea7e5?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1170385/alex"}, "reply_to_user": {"reputation": 13728, "user_id": 336186, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u4ox0.png?s=128&g=1", "display_name": "Lukasz Madon", "link": "https://stackoverflow.com/users/336186/lukasz-madon"}, "edited": false, "score": 0, "creation_date": 1423169643, "post_id": 28353313, "comment_id": 45051342, "body": "Though I don&#39;t see why it matters to this question, unless you&#39;re going to reply &quot;Don&#39;t&quot;."}, {"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "edited": false, "score": 0, "creation_date": 1423170465, "post_id": 28353313, "comment_id": 45051740, "body": "Note that you have a value receiver, so <code>c.lastLineIsEmpty = thisLineIsEmpty</code> won&#39;t be observable by the next <code>Write</code> call."}, {"owner": {"reputation": 17004, "user_id": 1170385, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c171c042b0e2f97e9dedf0a6d76ea7e5?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1170385/alex"}, "edited": false, "score": 0, "creation_date": 1423174287, "post_id": 28353313, "comment_id": 45053646, "body": "zmb: I don&#39;t understand what you mean, can you explain?"}], "answers": [{"comments": [{"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "reply_to_user": {"reputation": 17004, "user_id": 1170385, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c171c042b0e2f97e9dedf0a6d76ea7e5?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1170385/alex"}, "edited": false, "score": 0, "creation_date": 1423259559, "post_id": 28355143, "comment_id": 45091195, "body": "You didn&#39;t say anything about spaces. &quot;Any group of newlines more than a normal paragraph break should be condensed&quot;"}, {"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "reply_to_user": {"reputation": 17004, "user_id": 1170385, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c171c042b0e2f97e9dedf0a6d76ea7e5?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1170385/alex"}, "edited": false, "score": 0, "creation_date": 1423259615, "post_id": 28355143, "comment_id": 45091215, "body": "Although that would be an easy update. Instead of comparing against the Newline var just check for any whitespace."}], "tags": [], "owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "is_accepted": false, "score": 0, "last_activity_date": 1423174677, "creation_date": 1423174677, "answer_id": 28355143, "question_id": 28353313, "link": "https://stackoverflow.com/questions/28353313/strip-consecutive-empty-lines-in-a-golang-writer/28355143#28355143", "title": "Strip consecutive empty lines in a golang writer", "body": "<p>The general idea is you'll have to look for consecutive newlines anywhere in the input slice and if such cases exist, skip over all but the first newline character.</p>\n\n<p>Additionally, you have to track whether the last byte written was a newline, so the next call to <code>Write</code> will know to eliminate a newline if necessary.  You were on the right track by adding a <code>bool</code> to your writer type.  However, you'll want to use a pointer receiver instead of a value receiver here, otherwise you'll be modifying a <em>copy</em> of the struct.</p>\n\n<p>You would want to change</p>\n\n<pre><code>func (c condensingWriter) Write(b []byte)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>func (c *condensingWriter) Write(b []byte)\n</code></pre>\n\n<p>You could try something like <a href=\"http://play.golang.org/p/TUDbgfFXUq\" rel=\"nofollow\">this</a>.  You'll have to test with larger inputs to make sure it handles all cases correctly.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"io\"\n    \"os\"\n)\n\nvar Newline byte = byte('\\n')\n\ntype ReduceNewlinesWriter struct {\n    w               io.Writer\n    lastByteNewline bool\n}\n\nfunc (r *ReduceNewlinesWriter) Write(b []byte) (int, error) {\n    // if the previous call to Write ended with a \\n\n    // then we have to skip over any starting newlines here\n    i := 0\n    if r.lastByteNewline {\n        for i &lt; len(b) &amp;&amp; b[i] == Newline {\n            i++\n        }\n        b = b[i:]\n    }\n    r.lastByteNewline = b[len(b) - 1] == Newline\n\n    i = bytes.IndexByte(b, Newline)\n    if i == -1 {\n        // no newlines - just write the entire thing\n        return r.w.Write(b)\n    }\n    // write up to the newline\n    i++\n    n, err := r.w.Write(b[:i])\n    if err != nil {\n        return n, err\n    }\n\n    // skip over immediate newline and recurse\n    i++\n\n    for i &lt; len(b) &amp;&amp; b[i] == Newline {\n        i++\n    }\n    i--\n    m, err := r.Write(b[i:])\n    return n + m, nil\n}\n\nfunc main() {\n    r := ReduceNewlinesWriter{\n        w: os.Stdout,\n    }\n    io.WriteString(&amp;r, \"this\\n\\n\\n\\n\\n\\n\\nhas\\nmultiple\\n\\n\\nnewline\\n\\n\\n\\ncharacters\")\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "edited": false, "score": 0, "creation_date": 1423870740, "post_id": 28375865, "comment_id": 45340118, "body": "Nice!  Although <code>striplines.Striplines</code> is a poor type name (it stutters).  How about <code>striplines.Writer</code>instead?"}], "tags": [], "owner": {"reputation": 17004, "user_id": 1170385, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c171c042b0e2f97e9dedf0a6d76ea7e5?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1170385/alex"}, "is_accepted": false, "score": 1, "last_activity_date": 1423264813, "last_edit_date": 1423264813, "creation_date": 1423261493, "answer_id": 28375865, "question_id": 28353313, "link": "https://stackoverflow.com/questions/28353313/strip-consecutive-empty-lines-in-a-golang-writer/28375865#28375865", "title": "Strip consecutive empty lines in a golang writer", "body": "<p>Inspired by zmb's approach, I've come up with the following package:</p>\n\n<pre><code>//Package striplines strips runs of consecutive empty lines from an output stream.\npackage striplines\n\nimport (\n  \"io\"\n  \"strings\"\n)\n\n// Striplines wraps an output stream, stripping runs of consecutive empty lines.\n// You must call Flush before the output stream will be complete.\n// Implements io.WriteCloser, Writer, Closer.\ntype Striplines struct {\n  Writer   io.Writer\n  lastLine []byte\n  currentLine []byte\n}\n\nfunc (w *Striplines) Write(p []byte) (int, error) {\n  totalN := 0\n  s := string(p)\n  if !strings.Contains(s, \"\\n\") {\n    w.currentLine = append(w.currentLine, p...)\n    return 0, nil \n  }\n  cur := string(append(w.currentLine, p...))\n  lastN := strings.LastIndex(cur, \"\\n\")\n  s = cur[:lastN]\n  for _, line := range strings.Split(s, \"\\n\") {\n    n, err := w.writeLn(line + \"\\n\")\n    w.lastLine = []byte(line)\n    if err != nil {\n      return totalN, err \n    }   \n    totalN += n\n  }\n  rem := cur[(lastN + 1):]\n  w.currentLine = []byte(rem)\n  return totalN, nil \n}\n\n// Close flushes the last of the output into the underlying writer.\nfunc (w *Striplines) Close() error {\n  _, err := w.writeLn(string(w.currentLine))\n  return err \n}\n\nfunc (w *Striplines) writeLn(line string) (n int, err error) {\n  if strings.TrimSpace(string(w.lastLine)) == \"\" &amp;&amp; strings.TrimSpace(line) == \"\" {\n    return 0, nil \n  } else {\n    return w.Writer.Write([]byte(line))\n  }\n}\n</code></pre>\n\n<p>See it in action here: <a href=\"http://play.golang.org/p/t8BGPUMYhb\" rel=\"nofollow\">http://play.golang.org/p/t8BGPUMYhb</a></p>\n"}], "owner": {"reputation": 17004, "user_id": 1170385, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c171c042b0e2f97e9dedf0a6d76ea7e5?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1170385/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2039, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1423264813, "creation_date": 1423167673, "question_id": 28353313, "link": "https://stackoverflow.com/questions/28353313/strip-consecutive-empty-lines-in-a-golang-writer", "title": "Strip consecutive empty lines in a golang writer", "body": "<p>I've got a Go text/template that renders a file, however I've found it difficult to structure the template cleanly while preserving the line breaks in the output.</p>\n\n<p>I'd like to have additional, unnecessary newlines in the template to make it more readable, but strip them from the output. Any group of newlines more than a normal paragraph break should be condensed to a normal paragraph break, e.g.</p>\n\n<pre><code>lines with\n\n\n\ntoo many breaks should become lines with\n\nnormal paragraph breaks.\n</code></pre>\n\n<p>The string is potentially too large to store safely in memory, so I want to keep it as an output stream.</p>\n\n<p>My first attempt:</p>\n\n<pre><code>type condensingWriter struct {\n    writer io.Writer\n    lastLineIsEmpty bool\n}\n\nfunc (c condensingWriter) Write(b []byte) (n int, err error){\n    thisLineIsEmpty := strings.TrimSpace(string(b)) == \"\"\n    defer func(){\n        c.lastLineIsEmpty = thisLineIsEmpty\n    }()\n    if c.lastLineIsEmpty &amp;&amp; thisLineIsEmpty{\n        return 0, nil\n    } else {\n        return c.writer.Write(b)\n    }\n}\n</code></pre>\n\n<p>This doesn't work because I naively assumed that it would buffer on newline characters, but it doesn't.</p>\n\n<p>Any suggestions on how to get this to work?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1418, "user_id": 48773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3874d15379ce2f06c598942bdf0c83fc?s=128&d=identicon&r=PG", "display_name": "Deep Kapadia", "link": "https://stackoverflow.com/users/48773/deep-kapadia"}, "is_accepted": false, "score": 2, "last_activity_date": 1423249991, "last_edit_date": 1423249991, "creation_date": 1423178325, "answer_id": 28355924, "question_id": 28353111, "link": "https://stackoverflow.com/questions/28353111/json2csv-install-setup-issue-via-go/28355924#28355924", "title": "JSON2CSV install/setup issue (via Go)", "body": "<p>Add $GOPATH/bin to your PATH variable in your shell, </p>\n\n<p>for bash:</p>\n\n<pre><code>export PATH=$GOPATH/bin:$PATH\n</code></pre>\n"}], "owner": {"reputation": 521, "user_id": 280069, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/af961026a72dc0754099ee30146d6f8f?s=128&d=identicon&r=PG", "display_name": "Brian Piercy", "link": "https://stackoverflow.com/users/280069/brian-piercy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 820, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1423249991, "creation_date": 1423166968, "question_id": 28353111, "link": "https://stackoverflow.com/questions/28353111/json2csv-install-setup-issue-via-go", "title": "JSON2CSV install/setup issue (via Go)", "body": "<p>I'm attempting to install <a href=\"https://github.com/jehiah/json2csv\" rel=\"nofollow\">https://github.com/jehiah/json2csv</a>. The problem is apparently tied to my noob status w.r.t. Bash.</p>\n\n<p>System: Ubuntu 14.04 LTS</p>\n\n<p>Load instruction:</p>\n\n<pre><code>$ go get github.com/jehiah/json2csv\n</code></pre>\n\n<p>Go is installed:</p>\n\n<pre><code>$ which go ==&gt; /usr/bin/go\n</code></pre>\n\n<p>~/.bashrc setup:</p>\n\n<pre><code>export GOROOT=/usr/bin/go\nexport GOPATH=$HOME/projects/go\n</code></pre>\n\n<p>The package seems to download correctly: </p>\n\n<pre><code>$ cd projects/go\n$ tree\n$ &gt; bin &gt; json2csv\n  &gt; src &gt; github.com\n        ...\n$ ls bin -l\n$ &gt; -rwxrwxr-x 1 &lt;user&gt; &lt;user&gt; 55400 Feb  5 13:57 json2csv\n</code></pre>\n\n<p>But $json2csv isn't recognized, even from the same directory. I'm sure this is a noob problem, but I haven't cracked it yet. Suggestions?</p>\n"}, {"tags": ["go", "format", "printf"], "answers": [{"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 3, "last_activity_date": 1423167839, "creation_date": 1423167839, "answer_id": 28353358, "question_id": 28352975, "link": "https://stackoverflow.com/questions/28352975/trouble-with-go-stringers-exercise/28353358#28353358", "title": "trouble with go stringers exercise", "body": "<p>Maps are not ordered.</p>\n\n<blockquote>\n  <p>When iterating over a map with a range loop, the iteration order is not specified and is not guaranteed to be the same from one iteration to the next[1]</p>\n</blockquote>\n\n<p><a href=\"https://blog.golang.org/go-maps-in-action#TOC_7.\" rel=\"nofollow\">[1]https://blog.golang.org/go-maps-in-action#TOC_7.</a></p>\n\n<p>I don't see any difference with <code>%v</code> and <code>%d</code> output other than order.</p>\n"}, {"comments": [{"owner": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 2, "creation_date": 1534158367, "post_id": 51820726, "comment_id": 90595495, "body": "Can you share some explanation about all that code?"}, {"owner": {"reputation": 109, "user_id": 8070261, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bnW_fbUsDBI/AAAAAAAAAAI/AAAAAAAAAds/qKQi3jXjAbA/photo.jpg?sz=128", "display_name": "thiru murugan", "link": "https://stackoverflow.com/users/8070261/thiru-murugan"}, "reply_to_user": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 0, "creation_date": 1534163920, "post_id": 51820726, "comment_id": 90599022, "body": "people are using byte array index to print the values what am did in using for loop for iterate and compute the answer incase the logic was works on more then 4 items in the array"}], "tags": [], "owner": {"reputation": 109, "user_id": 8070261, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bnW_fbUsDBI/AAAAAAAAAAI/AAAAAAAAAds/qKQi3jXjAbA/photo.jpg?sz=128", "display_name": "thiru murugan", "link": "https://stackoverflow.com/users/8070261/thiru-murugan"}, "is_accepted": false, "score": 0, "last_activity_date": 1534158463, "last_edit_date": 1534158463, "creation_date": 1534157775, "answer_id": 51820726, "question_id": 28352975, "link": "https://stackoverflow.com/questions/28352975/trouble-with-go-stringers-exercise/51820726#51820726", "title": "trouble with go stringers exercise", "body": "<pre><code>package main\n\nimport \"fmt\"\n\ntype IPAddr [4]byte\n\n// TODO: Add a \"String() string\" method to IPAddr.\n\nfunc (ip IPAddr) String() string {\n   var s string\n   for i:= range ip{\n     if(i==0){\n      s +=fmt.Sprint(int(ip[i]))\n     } else{\n        s +=\".\"+fmt.Sprint(int(ip[i]))\n     }\n  }     \n\n  return s\n}\nfunc main() {\n  hosts := map[string]IPAddr{\n    \"loopback\":  {127, 0, 0, 1},\n    \"googleDNS\": {8, 8, 8, 8},\n  }\n  for name, ip := range hosts {\n    fmt.Printf(\"%v: %v\\n\", name, ip)\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 15326345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b13a1f5bd1b59539693a0cfc6406020f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Y.", "link": "https://stackoverflow.com/users/15326345/brian-y"}, "is_accepted": false, "score": 1, "last_activity_date": 1615162907, "creation_date": 1615162907, "answer_id": 66522906, "question_id": 28352975, "link": "https://stackoverflow.com/questions/28352975/trouble-with-go-stringers-exercise/66522906#66522906", "title": "trouble with go stringers exercise", "body": "<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n)\n\ntype IPAddr [4]byte\n\n// TODO: Add a &quot;String() string&quot; method to IPAddr.\n\nfunc (ip IPAddr) String() string {\n    \n    var s string\n    for _, v := range ip {\n        s += fmt.Sprint(int(v)) + &quot;.&quot;\n    }\n    sr := s[:len(s)-1]\n    return sr\n}\n\nfunc main() {\n    hosts := map[string]IPAddr{\n        &quot;loopback&quot;:  {127, 0, 0, 1},\n        &quot;googleDNS&quot;: {8, 8, 8, 8},\n    }\n    for name, ip := range hosts {\n        fmt.Printf(&quot;%v: %v\\n&quot;, name, ip)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3443291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eebd518b5374202bcb14f0a3e41336d5?s=128&d=identicon&r=PG&f=1", "display_name": "user3443291", "link": "https://stackoverflow.com/users/3443291/user3443291"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2038, "favorite_count": 0, "accepted_answer_id": 28353358, "answer_count": 3, "score": 0, "last_activity_date": 1615162907, "creation_date": 1423166473, "question_id": 28352975, "link": "https://stackoverflow.com/questions/28352975/trouble-with-go-stringers-exercise", "title": "trouble with go stringers exercise", "body": "<p>For the Stringers exercise in tour of Go:\nI got two different outputs for two different format printings. And the only thing I changed was the format verbs. They were %v and %d. Theoretically, they would give the same output. However the output's order was changed too, which was so weird. Any ideas about that? Below is my code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype IPAddr [4]byte\n\n// TODO: Add a \"String() string\" method to IPAddr.\nfunc (a IPAddr)String() string{\n    // Here is what I changed\n    return fmt.Sprintf(\"%d.%d.%d.%d\",a[0],a[1],a[2],a[3])\n}\n\nfunc main() {\n    addrs := map[string]IPAddr{\n        \"loopback\":  {127, 0, 0, 1},\n        \"googleDNS\": {8, 8, 8, 8},\n    }\n    for n, a := range addrs {\n        fmt.Printf(\"%v: %v\\n\", n, a)\n    }\n}\n</code></pre>\n\n<p>OutPut:</p>\n\n<p>googleDNS: 8.8.8.8 </p>\n\n<p>loopback: 127.0.0.1</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype IPAddr [4]byte\n\n// TODO: Add a \"String() string\" method to IPAddr.\nfunc (a IPAddr)String() string{\n    // Here is what I changed\n    return fmt.Sprintf(\"%v.%v.%v.%v\",a[0],a[1],a[2],a[3])\n}\n\nfunc main() {\n    addrs := map[string]IPAddr{\n        \"loopback\":  {127, 0, 0, 1},\n        \"googleDNS\": {8, 8, 8, 8},\n    }\n    for n, a := range addrs {\n        fmt.Printf(\"%v: %v\\n\", n, a)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<p>loopback: 127.0.0.1 </p>\n\n<p>googleDNS: 8.8.8.8</p>\n\n<p>The output's order was also changed.</p>\n"}, {"tags": ["go", "httphandler", "gorilla", "servemux"], "comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1423170770, "post_id": 28351063, "comment_id": 45051880, "body": "...have you tried what you put here? There is nothing stopping you from passing a <code>http.HandlerFunc</code> that resides in another package to your router..."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4211028"}, "edited": false, "score": 0, "creation_date": 1423257438, "post_id": 28354525, "comment_id": 45090267, "body": "Then how do I avoide prefixing <code>my_</code> to every handler?"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1423260082, "post_id": 28354525, "comment_id": 45091411, "body": "@cvxv31431asdas I added a subrouter example.  It does not let you add <code>my_</code> but it does allow for a path prefix of <code>&#47;my&#47;</code>."}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 2, "last_activity_date": 1423259969, "last_edit_date": 1423259969, "creation_date": 1423172209, "answer_id": 28354525, "question_id": 28351063, "link": "https://stackoverflow.com/questions/28351063/gorilla-mux-for-sub-path-routing/28354525#28354525", "title": "Gorilla Mux for sub path Routing", "body": "<p>You could create a package for your router then import said package and add your routes.</p>\n\n<p>Router</p>\n\n<pre><code>package router\n\nvar Router = mux.NewRouter()\n// handle \"/my/\" routes\nvar MyRouter = Router.PathPrefix(\"/my\").Subrouter()\n</code></pre>\n\n<p>another package</p>\n\n<pre><code>import \"/path/to/router\"\n\nfunc init() {\n    router.MyRouter.Methods(\"POST\").Path(\"/post_01\").HandlerFunc(myHandler1)\n}\n</code></pre>\n\n<p>In main</p>\n\n<pre><code>import \"/path/to/router\"\n\nfunc main() {\n    http.Handle(\"/\", router.Router)\n\n    //...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1017, "user_id": 2601733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AFDjZ.jpg?s=128&g=1", "display_name": "Andy Xu", "link": "https://stackoverflow.com/users/2601733/andy-xu"}, "is_accepted": false, "score": 2, "last_activity_date": 1423212915, "creation_date": 1423212915, "answer_id": 28361900, "question_id": 28351063, "link": "https://stackoverflow.com/questions/28351063/gorilla-mux-for-sub-path-routing/28361900#28361900", "title": "Gorilla Mux for sub path Routing", "body": "<p>It would be a lot better if you could extract <code>id</code> from the request URL and handle it in a generic handler.</p>\n\n<p>Actually, it is not far from where you are right now, modify you router like this:</p>\n\n<pre><code>r := mux.NewRouter()\nr.Methods(\"POST\").HandleFunc(\"/articles/{article_id:[0-9]+}\", ArticlePostHandler)\n</code></pre>\n\n<p><code>article_id</code> is the parameter name and <code>[0-9]+</code> is the regexp to match it.</p>\n\n<p>And in the <code>ArticlePostHandler</code> (you could import it from another package), use <code>mux.Vars</code> to get the id, like this:</p>\n\n<pre><code>func ArticlePostHandler(resp http.ResponseWriter, req *http.Request) {\n   articleId := mux.Vars(req)[\"article_id\"]\n   // do whatever you want with `articleId`\n}\n</code></pre>\n\n<p>Document: <a href=\"http://www.gorillatoolkit.org/pkg/mux\" rel=\"nofollow\">http://www.gorillatoolkit.org/pkg/mux</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4211028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4024, "favorite_count": 2, "accepted_answer_id": 28354525, "answer_count": 2, "score": 1, "last_activity_date": 1423259969, "creation_date": 1423159874, "question_id": 28351063, "link": "https://stackoverflow.com/questions/28351063/gorilla-mux-for-sub-path-routing", "title": "Gorilla Mux for sub path Routing", "body": "<p>I have the following routes:</p>\n\n<pre><code>router.Methods(\"POST\").Path(\"/my_post_01\").HandlerFunc(myHandler1)\nrouter.Methods(\"GET\").Path(\"/my_get_01\").HandlerFunc(myHandler2)\n\nrouter.Methods(\"POST\").Path(\"/my_post_02\").HandlerFunc(myHandler3)\nrouter.Methods(\"GET\").Path(\"/my_get_02\").HandlerFunc(myHandler4)\n\nrouter.Methods(\"POST\").Path(\"/my_post_03\").HandlerFunc(myHandler5)\nrouter.Methods(\"GET\").Path(\"/my_get_03\").HandlerFunc(myHandler6)\n\nrouter.Methods(\"POST\").Path(\"/my_post_04\").HandlerFunc(myHandler7)\nrouter.Methods(\"GET\").Path(\"/my_get_04\").HandlerFunc(myHandler8)\n\nrouter.Methods(\"POST\").Path(\"/my_post_05\").HandlerFunc(myHandler9)\nrouter.Methods(\"GET\").Path(\"/my_get_05\").HandlerFunc(myHandler10)\n</code></pre>\n\n<p>As I have more and more routes, it gets harder to manage.</p>\n\n<p>I want to do something like:</p>\n\n<pre><code>router.Path(\"/my/*\").HandleFunc(mypackage.RegisterHandler)\n</code></pre>\n\n<p>with all handlers being separated in another package</p>\n\n<p>Is there any way that I can match those paths in a separate package?</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1423173648, "post_id": 28349491, "comment_id": 45053346, "body": "<code>beego.SetLogger</code> returns an error, add some error checking and see if <code>SetLogger</code> is failing."}, {"owner": {"reputation": 805, "user_id": 2521743, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Gle7p.jpg?s=128&g=1", "display_name": "joaonrb", "link": "https://stackoverflow.com/users/2521743/joaonrb"}, "reply_to_user": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1423221313, "post_id": 28349491, "comment_id": 45070476, "body": "I got a nil from beego.SetLogger. I have no problem logging into logs/test.log. The problem is that I don&#39;t have access logs or error logs. Basically th only lines printed in log are: 2015/02/06 11:00:49 [app.go:96] [I] http server Running on :8080"}], "answers": [{"tags": [], "owner": {"reputation": 805, "user_id": 2521743, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Gle7p.jpg?s=128&g=1", "display_name": "joaonrb", "link": "https://stackoverflow.com/users/2521743/joaonrb"}, "is_accepted": false, "score": 0, "last_activity_date": 1426525045, "creation_date": 1426525045, "answer_id": 29082623, "question_id": 28349491, "link": "https://stackoverflow.com/questions/28349491/how-make-beego-log-access-in-production-mode/29082623#29082623", "title": "How make Beego log access in production mode?", "body": "<p>It looks that the developers of Beego did this on purpose. Beego in production mode don't print access logs. Check the issue <a href=\"https://github.com/astaxie/beego/issues/1032\" rel=\"nofollow\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 4260018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd06dd9332267598282a36c5ce35cae7?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel Nemtsev", "link": "https://stackoverflow.com/users/4260018/pavel-nemtsev"}, "is_accepted": false, "score": 2, "last_activity_date": 1450274033, "creation_date": 1450274033, "answer_id": 34313877, "question_id": 28349491, "link": "https://stackoverflow.com/questions/28349491/how-make-beego-log-access-in-production-mode/34313877#34313877", "title": "How make Beego log access in production mode?", "body": "<pre><code>func main() {\n    beego.AccessLogs = true\n    beego.Run()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 9183698, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YFLM4dNqnwM/AAAAAAAAAAI/AAAAAAAAUmo/8tJBj8EpsO4/photo.jpg?sz=128", "display_name": "Kotori0", "link": "https://stackoverflow.com/users/9183698/kotori0"}, "is_accepted": false, "score": 0, "last_activity_date": 1565598610, "creation_date": 1565598610, "answer_id": 57457868, "question_id": 28349491, "link": "https://stackoverflow.com/questions/28349491/how-make-beego-log-access-in-production-mode/57457868#57457868", "title": "How make Beego log access in production mode?", "body": "<p>As for latest Beego, it would look like this.</p>\n\n<pre><code>func main() {\n    beego.BConfig.Log.AccessLogs = true\n    beego.Run()\n}\n</code></pre>\n"}], "owner": {"reputation": 805, "user_id": 2521743, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Gle7p.jpg?s=128&g=1", "display_name": "joaonrb", "link": "https://stackoverflow.com/users/2521743/joaonrb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1558, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1565598610, "creation_date": 1423154820, "question_id": 28349491, "link": "https://stackoverflow.com/questions/28349491/how-make-beego-log-access-in-production-mode", "title": "How make Beego log access in production mode?", "body": "<p>I'm having some trouble to set the right log configuration in Beego for production mod. While developing the log keeps on printing access logs but in production it stop. Even 404 are not printed.\nI tried to set the log level to Debug and set a new file logger but it still not printing access log. \n</p>\n\n<pre><code>func main() {\n    runtime.GOMAXPROCS(8)\n    beego.SetLevel(beego.LevelDebug)\n    beego.SetLogger(\"file\", `{\"filename\":\"logs/test.log\"}`)\n    beego.Run()\n}\n</code></pre>\n\n<p>Any help with this?</p>\n"}, {"tags": ["testing", "go", "code-coverage", "test-coverage"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user184968"}, "edited": false, "score": 0, "creation_date": 1544444440, "post_id": 28349085, "comment_id": 94265672, "body": "A useful utility for accurate code coverage reporting for Golang: <a href=\"https://github.com/ory/go-acc\" rel=\"nofollow noreferrer\">github.com/ory/go-acc</a>"}, {"owner": {"reputation": 1287, "user_id": 242320, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qLcF4.jpg?s=128&g=1", "display_name": "Anton Evangelatov", "link": "https://stackoverflow.com/users/242320/anton-evangelatov"}, "edited": false, "score": 0, "creation_date": 1544520841, "post_id": 28349085, "comment_id": 94295748, "body": "Thank you, Sergei. I was not aware of it, will check it out!"}], "answers": [{"comments": [{"owner": {"reputation": 1287, "user_id": 242320, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qLcF4.jpg?s=128&g=1", "display_name": "Anton Evangelatov", "link": "https://stackoverflow.com/users/242320/anton-evangelatov"}, "edited": false, "score": 0, "creation_date": 1423219240, "post_id": 28350827, "comment_id": 45069354, "body": "Thank you for your comment, but this is not exactly what I need. The problem was that the percentage of coverage does not cover the code in other packages of the project. I will update my question to reflect that and make it clearer."}, {"owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "reply_to_user": {"reputation": 1287, "user_id": 242320, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qLcF4.jpg?s=128&g=1", "display_name": "Anton Evangelatov", "link": "https://stackoverflow.com/users/242320/anton-evangelatov"}, "edited": false, "score": 0, "creation_date": 1423231036, "post_id": 28350827, "comment_id": 45075628, "body": "@antonevangelatov I see what you mean!  I&#39;ll leave this answer just in case anyone finds it useful, and I note <code>-coverpkg</code> in your answer, thanks!"}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": false, "score": 1, "last_activity_date": 1423159014, "creation_date": 1423159014, "answer_id": 28350827, "question_id": 28349085, "link": "https://stackoverflow.com/questions/28349085/how-to-measure-golang-integration-test-coverage/28350827#28350827", "title": "How to measure Golang integration test coverage?", "body": "<p>As far as I know, if you want coverage you need to run <code>go test -cover</code>.</p>\n\n<p>However it is easy enough to add a flag which you can pass in which will enable these extra tests, so you can make them part of your test suite but don't run them normally.</p>\n\n<p>So add a command line flag in your <code>whatever_test.go</code></p>\n\n<pre><code>var integrationTest = flag.Bool(\"integration-test\", false, \"Run the integration tests\")\n</code></pre>\n\n<p>Then in each test do something like this</p>\n\n<pre><code>func TestSomething(t *testing.T){\n    if !*integrationTest {\n        t.Skip(\"Not running integration test\")\n    }\n    // Do some integration testing\n}\n</code></pre>\n\n<p>Then to run the integration tests</p>\n\n<pre><code>go run -cover -integration-test\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 26843, "user_id": 208997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/250e219125d8bff1f03e6faea950f218?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/208997/simon"}, "edited": false, "score": 1, "creation_date": 1423238218, "post_id": 28364103, "comment_id": 45080059, "body": "Great! I&#39;m just linking this <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/fnDBPPUDdQ4\" rel=\"nofollow noreferrer\">relevant golang-nuts thread</a>."}, {"owner": {"reputation": 1287, "user_id": 242320, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qLcF4.jpg?s=128&g=1", "display_name": "Anton Evangelatov", "link": "https://stackoverflow.com/users/242320/anton-evangelatov"}, "reply_to_user": {"reputation": 26843, "user_id": 208997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/250e219125d8bff1f03e6faea950f218?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/208997/simon"}, "edited": false, "score": 0, "creation_date": 1423474301, "post_id": 28364103, "comment_id": 45147251, "body": "Thanks, Simon. This is indeed what I was looking for!"}], "tags": [], "owner": {"reputation": 1287, "user_id": 242320, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qLcF4.jpg?s=128&g=1", "display_name": "Anton Evangelatov", "link": "https://stackoverflow.com/users/242320/anton-evangelatov"}, "is_accepted": true, "score": 16, "last_activity_date": 1423219923, "creation_date": 1423219923, "answer_id": 28364103, "question_id": 28349085, "link": "https://stackoverflow.com/questions/28349085/how-to-measure-golang-integration-test-coverage/28364103#28364103", "title": "How to measure Golang integration test coverage?", "body": "<p>I was pointed at the <code>-coverpkg</code> directive, which does what I need - measures the test coverage in a particular package, even if tests that use this package and not part of it. For example:</p>\n\n<pre><code>$ go test -cover -coverpkg mypackage ./src/api/...\nok      /api    0.190s  coverage: 50.8% of statements in mypackage\nok      /api/mypackage   0.022s  coverage: 0.7% of statements in mypackage\n</code></pre>\n\n<p>compared to</p>\n\n<pre><code>$ go test -cover ./src/api/...\nok      /api    0.191s  coverage: 71.0% of statements\nok      /api/mypackage   0.023s  coverage: 0.7% of statements\n</code></pre>\n\n<p>In the example above, I have tests in <code>main_test.go</code> which is in <code>package main</code> that is using <code>package mypackage</code>. I am mostly interested in the coverage of <code>package mypackage</code> since it contains 99% of the business logic in the project.</p>\n\n<p>I am quite new to Go, so it is quite possible that this is not the best way to measure test coverage via integration tests.</p>\n"}, {"tags": [], "owner": {"reputation": 127, "user_id": 10176807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83f8fa107bdcc124bc29c8153bda63f1?s=128&d=identicon&r=PG&f=1", "display_name": "Sharon KatzR7", "link": "https://stackoverflow.com/users/10176807/sharon-katzr7"}, "is_accepted": false, "score": 2, "last_activity_date": 1541710872, "creation_date": 1541710872, "answer_id": 53216067, "question_id": 28349085, "link": "https://stackoverflow.com/questions/28349085/how-to-measure-golang-integration-test-coverage/53216067#53216067", "title": "How to measure Golang integration test coverage?", "body": "<p>you can run go test in a way that creates coverage html pages. like this:</p>\n\n<pre><code>go test -v -coverprofile cover.out ./...\ngo tool cover -html=cover.out -o cover.html\nopen cover.html\n</code></pre>\n"}], "owner": {"reputation": 1287, "user_id": 242320, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qLcF4.jpg?s=128&g=1", "display_name": "Anton Evangelatov", "link": "https://stackoverflow.com/users/242320/anton-evangelatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5188, "favorite_count": 3, "accepted_answer_id": 28364103, "answer_count": 3, "score": 18, "last_activity_date": 1541710872, "creation_date": 1423153664, "question_id": 28349085, "link": "https://stackoverflow.com/questions/28349085/how-to-measure-golang-integration-test-coverage", "title": "How to measure Golang integration test coverage?", "body": "<p>I am trying to use <code>go test -cover</code> to measure the test coverage of a service I am building. It is a REST API and I am testing it by spinning it up, making test HTTP requests and reviewing the HTTP responses. These tests are not part of the packages of the services and <code>go tool cover</code> returns 0% test coverage. Is there a way to get the actual test coverage? I would expect a best-case scenario test on a given endpoint to cover at least 30-50% of the code for specific endpoint handler, and by adding more tests for common error to improve this further.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 459, "user_id": 4023435, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/94cbdaee2f17e8bcd9ea8b2046bafb1a?s=128&d=identicon&r=PG&f=1", "display_name": "cosiner", "link": "https://stackoverflow.com/users/4023435/cosiner"}, "edited": false, "score": 0, "creation_date": 1423143779, "post_id": 28344984, "comment_id": 45035130, "body": "Thanks, it&#39;s a bit difficult to understand, in my opinon, there is no different between to these, but causes two different answers."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 459, "user_id": 4023435, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/94cbdaee2f17e8bcd9ea8b2046bafb1a?s=128&d=identicon&r=PG&f=1", "display_name": "cosiner", "link": "https://stackoverflow.com/users/4023435/cosiner"}, "edited": false, "score": 0, "creation_date": 1423143897, "post_id": 28344984, "comment_id": 45035225, "body": "@cosiner Read the doc of <a href=\"http://golang.org/pkg/sort/#Search\" rel=\"nofollow noreferrer\"><code>sort.Search()</code></a>. It clearly states that if the collection is sorted in ascending order, <code>&gt;=</code> have to be used, and if it is sorted in descending order, <code>&lt;=</code> have to be used. So since you used <code>&lt;</code> it certainly will not work."}, {"owner": {"reputation": 459, "user_id": 4023435, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/94cbdaee2f17e8bcd9ea8b2046bafb1a?s=128&d=identicon&r=PG&f=1", "display_name": "cosiner", "link": "https://stackoverflow.com/users/4023435/cosiner"}, "edited": false, "score": 0, "creation_date": 1423144226, "post_id": 28344984, "comment_id": 45035489, "body": "Thanks for your help, i have understood it."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1423143025, "last_edit_date": 1423143025, "creation_date": 1423142227, "answer_id": 28344984, "question_id": 28344757, "link": "https://stackoverflow.com/questions/28344757/golang-sort-search-cant-find-first-element-in-a-slice/28344984#28344984", "title": "golang: sort.Search can&#39;t find first element in a slice", "body": "<p>If you want to search for the first element, then in your comparator function you should compare the <code>i</code><sup>th</sup> element to the first which is <code>data[0]</code> (or the value which is <code>1</code>).</p>\n\n<p>And since your slice is sorted in ascending order, you have to use the <code>&gt;=</code> operator for comparision because <code>sort.Search()</code> returns the smallest index <code>i</code> in <code>[0, n)</code> at which <code>f(i)</code> is <code>true</code>.</p>\n\n<pre><code>data := []int{1, 2, 3}\nfmt.Println(sort.Search(len(data), func(i int) bool {\n    return data[i] &gt;= data[0] // You could also use 1 instead of data[0]\n}))\n</code></pre>\n\n<p>Output: <code>0</code> as expected. Try it on <a href=\"http://play.golang.org/p/hFKjcv27_q\" rel=\"nofollow\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 459, "user_id": 4023435, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/94cbdaee2f17e8bcd9ea8b2046bafb1a?s=128&d=identicon&r=PG&f=1", "display_name": "cosiner", "link": "https://stackoverflow.com/users/4023435/cosiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 957, "favorite_count": 0, "accepted_answer_id": 28344984, "answer_count": 1, "score": 2, "last_activity_date": 1423143025, "creation_date": 1423141567, "question_id": 28344757, "link": "https://stackoverflow.com/questions/28344757/golang-sort-search-cant-find-first-element-in-a-slice", "title": "golang: sort.Search can&#39;t find first element in a slice", "body": "<p>I have write some code to find element position in sorted slice use sort.Search, but it can't correctly get the right position of first element.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n)\n\nfunc main() {\n    data := []int{1, 2, 3}\n    fmt.Println(sort.Search(len(data), func(i int) bool {\n        return data[i] &lt; 2 // or data[i] == 1\n    }))\n}\n</code></pre>\n\n<p>The standard output is always 3 rather than 0.\nIs it a bug? Or am i wrong?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 93, "user_id": 715287, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/3a874c3d7f220b70c8a25132973a6e19?s=128&d=identicon&r=PG", "display_name": "Clay Shirky", "link": "https://stackoverflow.com/users/715287/clay-shirky"}, "edited": false, "score": 0, "creation_date": 1423148572, "post_id": 28343085, "comment_id": 45038616, "body": "Thanks icza! Newbie mistake, I appreciate the help"}], "answers": [{"comments": [{"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 1, "creation_date": 1423143316, "post_id": 28343171, "comment_id": 45034813, "body": "If you want to avoid creating a separate string, you can also just write the value to stdout (<code>os.Stdout.Write(b)</code>)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4122236"}, "edited": false, "score": 0, "creation_date": 1423151399, "post_id": 28343171, "comment_id": 45040584, "body": "If you want to use <a href=\"http://godoc.org/fmt\" rel=\"nofollow noreferrer\">fmt</a> and avoid the string, then use <code>fmt.Printf(&quot;%s\\n&quot;, b)</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1423136914, "creation_date": 1423136914, "answer_id": 28343171, "question_id": 28343085, "link": "https://stackoverflow.com/questions/28343085/go-output-with-ioutil-returning-array-of-ascii-numbers-from-http-call/28343171#28343171", "title": "Go output with ioutil: returning array of (ASCII?) numbers from http call", "body": "<p><a href=\"http://golang.org/pkg/io/ioutil/#ReadAll\" rel=\"nofollow\"><code>ioutil.ReadAll()</code></a> returns a byte slice (<code>[]byte</code>) and not a <code>string</code> (plus an <code>error</code>).</p>\n\n<p>Convert it to <code>string</code> and you're good to go:</p>\n\n<pre><code>fmt.Print(string(body))\n</code></pre>\n\n<p>See this simple example (try it on <a href=\"http://play.golang.org/p/cr-dwDLDAS\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>var b []byte = []byte(\"Hello\")\n\nfmt.Println(b)\nfmt.Println(string(b))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[72 101 108 108 111]\nHello\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 715287, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/3a874c3d7f220b70c8a25132973a6e19?s=128&d=identicon&r=PG", "display_name": "Clay Shirky", "link": "https://stackoverflow.com/users/715287/clay-shirky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1245, "favorite_count": 0, "accepted_answer_id": 28343171, "answer_count": 1, "score": 2, "last_activity_date": 1423148440, "creation_date": 1423136698, "last_edit_date": 1423148440, "question_id": 28343085, "link": "https://stackoverflow.com/questions/28343085/go-output-with-ioutil-returning-array-of-ascii-numbers-from-http-call", "title": "Go output with ioutil: returning array of (ASCII?) numbers from http call", "body": "<p>I am trying to write a web client in Go, but when I check the return value of the body of the http request, I get an array of numbers, instead of text. </p>\n\n<p>This is the most isolated version of the program that produces the output. I think I am failing do something with ioutil, but do not know what.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"net/http\"\nimport \"io/ioutil\"\n\nfunc main() {\n    resp, err := http.Get(\"http://test.com/\")\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer resp.Body.Close()\n    body, err := ioutil.ReadAll(resp.Body)\n    fmt.Print(body)\n}\n</code></pre>\n\n<p>The output comes out looking like:</p>\n\n<p>[239 187 191 60 33 68 79 67 84 89 80 69 32 104 116 109 108 ...</p>\n\n<p>instead of the test returned by test.com</p>\n"}, {"tags": ["unix", "go", "inode"], "answers": [{"tags": [], "owner": {"reputation": 19808, "user_id": 1472049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1qeQt.jpg?s=128&g=1", "display_name": "serejja", "link": "https://stackoverflow.com/users/1472049/serejja"}, "is_accepted": false, "score": 11, "last_activity_date": 1423125655, "creation_date": 1423125655, "answer_id": 28339521, "question_id": 28339240, "link": "https://stackoverflow.com/questions/28339240/get-file-inode-in-go/28339521#28339521", "title": "Get file inode in Go", "body": "<p>You can do the following:</p>\n\n<pre><code>file := \"/tmp/system.log\"\nvar stat syscall.Stat_t\nif err := syscall.Stat(file, &amp;stat); err != nil {\n    panic(err)\n}\nfmt.Println(stat.Ino)\n</code></pre>\n\n<p>Where <code>stat.Ino</code> is the inode you are looking for.</p>\n"}, {"comments": [{"owner": {"reputation": 2111, "user_id": 2159730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QLdPH.jpg?s=128&g=1", "display_name": "Randy Howard", "link": "https://stackoverflow.com/users/2159730/randy-howard"}, "edited": false, "score": 0, "creation_date": 1519596414, "post_id": 28339540, "comment_id": 84962982, "body": "Ignoring the error when you call os.Stat(file) above is not a good idea. Particularly when the file being searched for might not even be present. You can get a runtime panic if you dereference fileinfo without checking. I know it&#39;s just an example, but people might trip over this if they use the above model."}, {"owner": {"reputation": 17156, "user_id": 5836, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/444c8d7844ba3aed548964c7524208bf?s=128&d=identicon&r=PG", "display_name": "Brettski", "link": "https://stackoverflow.com/users/5836/brettski"}, "edited": false, "score": 0, "creation_date": 1558811657, "post_id": 28339540, "comment_id": 99226357, "body": "What does the line, <code>stat, ok := fileinfo.Sys().(*syscall.Stat_t)</code> actually do? <code>fileinfo.Sys()</code> returns a *syscall.Stat_t according to <code>fmt.Printf(&quot;%T&quot;, fileinfo.Sys())</code> Some clarity will be very helpful"}, {"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "reply_to_user": {"reputation": 17156, "user_id": 5836, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/444c8d7844ba3aed548964c7524208bf?s=128&d=identicon&r=PG", "display_name": "Brettski", "link": "https://stackoverflow.com/users/5836/brettski"}, "edited": false, "score": 1, "creation_date": 1580603984, "post_id": 28339540, "comment_id": 106152159, "body": "@Brettski: <code>fileinfo.Sys()</code> gets you an <code>interface{}</code> value\u2014possibly <code>nil</code>\u2014that captures whatever the <code>os.Stat()</code> call got from the underlying system call. The <code>stat, ok := fileinfo.Sys().(*syscall.Stat_t)</code> line is a <i>type assertion</i> that says <i>I think what&#39;s in this interface value is a <code>*syscall.Stat_t</code>. If so, let me have it, and set the variable <code>ok</code> to <code>true</code>.</i> If <code>ok</code> is true, <code>stat</code> now has the pointer you expected (if !ok, <code>stat</code> is nil) and you can now use <code>stat.Ino</code> and other such fields."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 17156, "user_id": 5836, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/444c8d7844ba3aed548964c7524208bf?s=128&d=identicon&r=PG", "display_name": "Brettski", "link": "https://stackoverflow.com/users/5836/brettski"}, "edited": false, "score": 0, "creation_date": 1580657432, "post_id": 28339540, "comment_id": 106160931, "body": "@Brettski, to expand on what @torek said: Go must balance between two mutually-excusive requirements when it comes to interfacing with the OS: on the one hand the API it provides in its stdlib should strive to be 100% homogenous (cross-platform), and on the other hand, quite often a programmer needs to get their hold on the nitty-gritty platform-specific details. That&#39;s why <code>os.(*Fileinfo).Stat()</code> returns a value of &quot;any type&quot;\u2014<code>interface{}</code>: the exact (dynamic) type of the returned value is OS-specific, and the programmer is required to <i>assert</i> its real type to obtain a properly-typed value."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 17156, "user_id": 5836, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/444c8d7844ba3aed548964c7524208bf?s=128&d=identicon&r=PG", "display_name": "Brettski", "link": "https://stackoverflow.com/users/5836/brettski"}, "edited": false, "score": 0, "creation_date": 1580657910, "post_id": 28339540, "comment_id": 106161081, "body": "@Brettski, for instance, I beleive, on Windows <code>os.(*FileInfo).Sys()</code> returns <code>*syscall.Win32FileAttributeData</code>\u2014you can read about it by running <code>$ GOOS=windows go doc syscall.Win32FileAttributeData</code>."}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": true, "score": 20, "last_activity_date": 1423125723, "creation_date": 1423125723, "answer_id": 28339540, "question_id": 28339240, "link": "https://stackoverflow.com/questions/28339240/get-file-inode-in-go/28339540#28339540", "title": "Get file inode in Go", "body": "<p>You can use a type assertion to get the underlying <code>syscall.Stat_t</code> from the fileinfo like this</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"syscall\"\n)\n\nfunc main() {\n    file := \"/etc/passwd\"\n    fileinfo, _ := os.Stat(file)\n    fmt.Printf(\"fileinfo.Sys() = %#v\\n\", fileinfo.Sys())\n    fmt.Printf(\"fileinfo = %#v\\n\", fileinfo)\n    stat, ok := fileinfo.Sys().(*syscall.Stat_t)\n    if !ok {\n        fmt.Printf(\"Not a syscall.Stat_t\")\n        return\n    }\n    fmt.Printf(\"stat = %#v\\n\", stat)\n    fmt.Printf(\"stat.Ino = %#v\\n\", stat.Ino)\n}\n</code></pre>\n"}], "owner": {"reputation": 14512, "user_id": 253098, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/400nc.png?s=128&g=1", "display_name": "SystematicFrank", "link": "https://stackoverflow.com/users/253098/systematicfrank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5161, "favorite_count": 0, "accepted_answer_id": 28339540, "answer_count": 2, "score": 10, "last_activity_date": 1423125907, "creation_date": 1423124560, "last_edit_date": 1423125285, "question_id": 28339240, "link": "https://stackoverflow.com/questions/28339240/get-file-inode-in-go", "title": "Get file inode in Go", "body": "<p>How can I get a file inode in Go?</p>\n\n<p>I already can print it like this:</p>\n\n<pre><code>file := \"/tmp/system.log\"\nfileinfo, _ := os.Stat(file)\nfmt.Println(fileinfo.Sys())\nfmt.Println(fileinfo)\n</code></pre>\n\n<p>Looking at Go implementation it was obvious looking for some <code>stat</code> method, but I still did not manage to find the structure definition for a Unix system.</p>\n\n<p>How can I get the inode value directly?</p>\n\n<p>Which file/s in the source code define the structure of <code>Sys()</code>?</p>\n"}, {"tags": ["pointers", "reflection", "go"], "answers": [{"comments": [{"owner": {"reputation": 4737, "user_id": 36693, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/OWMEs.jpg?s=128&g=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/36693/nate"}, "edited": false, "score": 0, "creation_date": 1423123079, "post_id": 28338747, "comment_id": 45022964, "body": "Thanks!. Really interesting. Reading the docs on Elem() is a bit confusing.         // Elem returns a type&#39;s element type. // It panics if the type&#39;s Kind is not Array, Chan, Map, Ptr, or Slice. Elem() Type. So, reflect.TypeOf returned a Type, Elem returns an elements Type. Is the &quot;element&quot; the value that I&#39;m reflecting on?"}, {"owner": {"reputation": 4737, "user_id": 36693, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/OWMEs.jpg?s=128&g=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/36693/nate"}, "edited": false, "score": 0, "creation_date": 1423123427, "post_id": 28338747, "comment_id": 45023131, "body": "Also, it seems that the only reason Elem() isn&#39;t panic&#39;ing is because the contained type is a pointer. I find it interesting that Elem().Name() then returns &quot;Foo&quot; instead of *Foo."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 4737, "user_id": 36693, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/OWMEs.jpg?s=128&g=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/36693/nate"}, "edited": false, "score": 2, "creation_date": 1423124371, "post_id": 28338747, "comment_id": 45023559, "body": "@Nate: The name <code>Elem</code> is a bit missleading for pointers but it is perfectly sensible for the other types. E.g. if you reflect on a <code>[]int</code> the <code>Elem()</code> method gives you the type of the slice elements, here int (and not []int). The same logic applies to pointers:You reflect on a pointer type and <code>Elem()</code> gives you the type of the &quot;element of the pointer type&quot; and thats Name is clearly &quot;Foo&quot; not &quot;*Foo&quot; as the name of the element of a []int is int and not []int."}, {"owner": {"reputation": 1027, "user_id": 814422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad082805d1ce2e3766886195c720fca6?s=128&d=identicon&r=PG", "display_name": "kbolino", "link": "https://stackoverflow.com/users/814422/kbolino"}, "edited": false, "score": 0, "creation_date": 1535675782, "post_id": 28338747, "comment_id": 91164939, "body": "For what it is worth, the type of <code>h</code> is <code>interface{}</code> not a pointer type. It is the <i>value</i> of <code>h</code> that has (unnamed) pointer type. This becomes apparent if you pass in <code>&amp;h</code> to <code>reflect.TypeOf</code> instead of <code>h</code>. However, interfaces are passed by value (mostly) in Go, and <code>reflect.TypeOf</code> takes <code>interface{}</code> so it has no way of knowing the type of <code>h</code> if passed by value. This distinction is not super important here, but would be more noticeable if <code>h</code> had a named interface type like <code>io.Reader</code>."}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": true, "score": 7, "last_activity_date": 1423122629, "creation_date": 1423122629, "answer_id": 28338747, "question_id": 28338600, "link": "https://stackoverflow.com/questions/28338600/why-does-putting-a-pointer-in-an-interface-in-go-cause-reflect-to-lose-the-nam/28338747#28338747", "title": "Why does putting a pointer in an interface{} in Go cause reflect to lose the name of the type?", "body": "<p>As the <code>Name</code> method's documentation says, unnamed types will return an empty string:</p>\n\n<blockquote>\n  <p><code>Name</code> returns the type's name within its package.\n  It returns an empty string for unnamed types.</p>\n</blockquote>\n\n<p>The type of <code>h</code> is an unnamed pointer type whose element type is the named struct type <code>Foo</code>:</p>\n\n<pre><code>v := reflect.TypeOf(h)\nfmt.Println(v.Elem().Name()) // prints \"Foo\"\n</code></pre>\n\n<p>If you want an identifier for complex unnamed types like this, use the <code>String</code> method:</p>\n\n<pre><code>fmt.Println(v.String()) // prints \"*main.Foo\"\n</code></pre>\n"}], "owner": {"reputation": 4737, "user_id": 36693, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/OWMEs.jpg?s=128&g=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/36693/nate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 650, "favorite_count": 0, "accepted_answer_id": 28338747, "answer_count": 1, "score": 9, "last_activity_date": 1423122629, "creation_date": 1423122067, "question_id": 28338600, "link": "https://stackoverflow.com/questions/28338600/why-does-putting-a-pointer-in-an-interface-in-go-cause-reflect-to-lose-the-nam", "title": "Why does putting a pointer in an interface{} in Go cause reflect to lose the name of the type?", "body": "<p>The example below shows what happens when you reflect on an interface {} that is set to an object (g) and a pointer to said object (h). Is this by design, should I expect that my datatype is lost or rather or that I cannot get name of the datatype back when I put my pointer in an interface {}?</p>\n\n<pre>\npackage main\n\nimport \"fmt\"\nimport \"reflect\"\n\ntype Foo struct {\n    Bar string\n}\n\nfunc main() {\n    f := Foo{Bar: \"FooBar\"}\n    typeName := reflect.TypeOf(f).Name()\n    fmt.Printf(\"typeName %v\\n\", typeName)\n\n    var g interface{}\n    g = f\n    typeName = reflect.TypeOf(g).Name()\n    fmt.Printf(\"typeName %v\\n\", typeName)\n\n    var h interface{}\n    h = &f\n    typeName = reflect.TypeOf(h).Name()\n    fmt.Printf(\"typeName %v\\n\", typeName)\n}\n</pre>\n\n<p>Outputs:</p>\n\n<pre>\ntypeName Foo\ntypeName Foo\ntypeName \n</pre>\n\n<p>Also at:</p>\n\n<p><a href=\"http://play.golang.org/p/2QuBoDxHfX\" rel=\"noreferrer\">http://play.golang.org/p/2QuBoDxHfX</a></p>\n"}, {"tags": ["javascript", "angularjs", "go", "beego"], "answers": [{"comments": [{"owner": {"reputation": 987, "user_id": 1139107, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/faf978713caf2baf42359335bd729c4d?s=128&d=identicon&r=PG", "display_name": "under5hell", "link": "https://stackoverflow.com/users/1139107/under5hell"}, "edited": false, "score": 0, "creation_date": 1423120365, "post_id": 28337872, "comment_id": 45021750, "body": "thanks for your response. i have delete that line  mention in commit f962475. but the error persists."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 987, "user_id": 1139107, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/faf978713caf2baf42359335bd729c4d?s=128&d=identicon&r=PG", "display_name": "under5hell", "link": "https://stackoverflow.com/users/1139107/under5hell"}, "edited": false, "score": 0, "creation_date": 1423122127, "post_id": 28337872, "comment_id": 45022502, "body": "@under5hell ok, I have only found one other instance of this error involving Session (I have edited the answer). But it is more a clue than a definitive answer."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1423122076, "last_edit_date": 1423122076, "creation_date": 1423119280, "answer_id": 28337872, "question_id": 28337387, "link": "https://stackoverflow.com/questions/28337387/post-request-treated-as-options-on-beego-framework/28337872#28337872", "title": "POST request treated as OPTIONS on beego framework", "body": "<p>That might because of an issue/pull request currently pending to be merged into master: <a href=\"https://github.com/astaxie/beego/issues/912\" rel=\"nofollow\">issue 912</a></p>\n\n<blockquote>\n  <p>Without this line everything is fine:: <a href=\"https://github.com/astaxie/beego/blob/d536f5b8dce63500b16e99d7977beecee0b23262/router.go#L861\" rel=\"nofollow\">router.go#L861</a></p>\n</blockquote>\n\n<p>That seems to be in line with <a href=\"https://github.com/astaxie/beego/commit/3bb4d6f0133dbe526e1917bebe2dc7a98ced6384\" rel=\"nofollow\">commit 3bb4d6f</a> which shows:</p>\n\n<pre><code>// Write status code if it has been set manually\n// Set it to 0 afterwards to prevent \"multiple response.WriteHeader calls\"\n</code></pre>\n\n<p>(and <code>router.go</code> do set a status, hence the error message)</p>\n\n<p><a href=\"https://github.com/astaxie/beego/commit/f96245786ae0e7b454420fb339a66cadb6676917\" rel=\"nofollow\">Commit f962457</a> is supposed to solve this issue, but isn't merged yet.</p>\n\n<hr>\n\n<p>The other <a href=\"https://github.com/astaxie/beego/issues/904\" rel=\"nofollow\">issue 904</a> mentions something about being unable to retrieve the Session data previously registered in the Session Engine.\nMaybe <a href=\"https://github.com/astaxie/beego/blob/d536f5b8dce63500b16e99d7977beecee0b23262/config.go#L54\" rel=\"nofollow\">Session.on flag</a> can help.</p>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 9173466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yf8Qn.jpg?s=128&g=1", "display_name": "Delly Fabian Lucas", "link": "https://stackoverflow.com/users/9173466/delly-fabian-lucas"}, "is_accepted": false, "score": 0, "last_activity_date": 1515080093, "creation_date": 1515080093, "answer_id": 48098559, "question_id": 28337387, "link": "https://stackoverflow.com/questions/28337387/post-request-treated-as-options-on-beego-framework/48098559#48098559", "title": "POST request treated as OPTIONS on beego framework", "body": "<p>I handle it like that, I hope it helps</p>\n\n<pre><code>import (\n_ \"info_apoyo/routers\"\n\n\"github.com/astaxie/beego\"\n\"github.com/astaxie/beego/plugins/cors\"\n)\n\nfunc main() {\nif beego.BConfig.RunMode == \"dev\" {\n    beego.BConfig.WebConfig.DirectoryIndex = true\n    beego.BConfig.WebConfig.StaticDir[\"/swagger\"] = \"swagger\"\n}\nbeego.InsertFilter(\"*\", beego.BeforeRouter, cors.Allow(&amp;cors.Options{\n    AllowOrigins:     []string{\"*\"},\n    AllowMethods:     []string{\"GET\", \"POST\", \"DELETE\", \"PUT\", \"PATCH\"},\n    AllowHeaders:     []string{\"Origin\", \"content-type\", \"Access-Control-\nAllow-Origin\"},\n    ExposeHeaders:    []string{\"Content-Length\", \"Access-Control-Allow-\nOrigin\"},\n    AllowCredentials: true,\n}))\nbeego.Run()\n}\n</code></pre>\n"}], "owner": {"reputation": 987, "user_id": 1139107, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/faf978713caf2baf42359335bd729c4d?s=128&d=identicon&r=PG", "display_name": "under5hell", "link": "https://stackoverflow.com/users/1139107/under5hell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1118, "favorite_count": 1, "accepted_answer_id": 28337872, "answer_count": 2, "score": 4, "last_activity_date": 1515080093, "creation_date": 1423117011, "question_id": 28337387, "link": "https://stackoverflow.com/questions/28337387/post-request-treated-as-options-on-beego-framework", "title": "POST request treated as OPTIONS on beego framework", "body": "<p>I'm using beego framework as my API framework and AngularJS on the client.\nI have set all CORS setting correctly. I can do GET request. But, when i try to POST, beego treat is as OPTIONS request. It also throw a warning: <code>multiple response.WriteHeader calls</code>. what could possibly wrong?</p>\n\n<p>my beego CORS setting:</p>\n\n<pre><code>func init() {\n    orm.RegisterDataBase(\"default\", \"mysql\", \"root:@tcp(127.0.0.1:3306)/fakeapi\")\n    beego.InsertFilter(\"*\", beego.BeforeRouter, cors.Allow(&amp;cors.Options{\n        AllowOrigins:     []string{\"*\"},\n        AllowMethods:     []string{\"GET\", \"DELETE\", \"PUT\", \"PATCH\", \"POST\"},\n        AllowHeaders:     []string{\"Origin\"},\n        ExposeHeaders:    []string{\"Content-Length\"},\n        AllowCredentials: true,\n    }))\n\n}\n</code></pre>\n\n<p>My ANgularJS request</p>\n\n<pre><code>var transaction = $http.post(BASE_URL + \"transaction\", transactionData);\n                return $q.all([transaction]).then(function(response) {\n            console.log(response);\n        });\n</code></pre>\n\n<p>my system:\nUbuntu 14.04\nbeego: 1.4.2\nbee: 1.2.4\nangularJS: 1.3.12</p>\n"}, {"tags": ["c++", "go"], "comments": [{"owner": {"reputation": 3055, "user_id": 2865186, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/ehbWg.jpg?s=128&g=1", "display_name": "MattSizzle", "link": "https://stackoverflow.com/users/2865186/mattsizzle"}, "edited": false, "score": 0, "creation_date": 1423112234, "post_id": 28336450, "comment_id": 45019023, "body": "Why not learn both (eventually)? I recommend <code>C++</code> to anyone who ask me the typical; I want to code, but I dont know what language to learn."}, {"owner": {"reputation": 126541, "user_id": 153285, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/1UiET.jpg?s=128&g=1", "display_name": "Potatoswatter", "link": "https://stackoverflow.com/users/153285/potatoswatter"}, "edited": false, "score": 0, "creation_date": 1423112738, "post_id": 28336450, "comment_id": 45019166, "body": "Do you have friends, classmates, or acquaintances with the sort of career you&#39;d like to get? Ask them what they use. A mature programmer knows plenty of languages, though. They&#39;re just skills to be picked up."}], "answers": [{"comments": [{"owner": {"reputation": 1550, "user_id": 653991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e58e451dc104f5e48ad56e24f456e1b8?s=128&d=identicon&r=PG", "display_name": "Gerardo Hernandez", "link": "https://stackoverflow.com/users/653991/gerardo-hernandez"}, "edited": false, "score": 0, "creation_date": 1464297975, "post_id": 28336512, "comment_id": 62441179, "body": "Go has no parity with C, as C is garbage collected. I have been programming in C++ for about 10 years and I have never used a &quot;embedded domain-specific language&quot;. It is certainly not the normal way of using C++. &quot;Deep, generic metaprogramming&quot; is not the norm. You can use if you want. But many users of the language do not (Google itself does not use templates)."}, {"owner": {"reputation": 126541, "user_id": 153285, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/1UiET.jpg?s=128&g=1", "display_name": "Potatoswatter", "link": "https://stackoverflow.com/users/153285/potatoswatter"}, "reply_to_user": {"reputation": 1550, "user_id": 653991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e58e451dc104f5e48ad56e24f456e1b8?s=128&d=identicon&r=PG", "display_name": "Gerardo Hernandez", "link": "https://stackoverflow.com/users/653991/gerardo-hernandez"}, "edited": false, "score": 0, "creation_date": 1464600480, "post_id": 28336512, "comment_id": 62536317, "body": "I think you mean <i>Go</i> has garbage collection, which would be an additional feature. You are only one person, not many. Generic programming is useful for writing libraries, including the standard library, which Google (and most everyone else) does use. As for programs, yes it&#39;s pretty optional."}], "tags": [], "owner": {"reputation": 126541, "user_id": 153285, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/1UiET.jpg?s=128&g=1", "display_name": "Potatoswatter", "link": "https://stackoverflow.com/users/153285/potatoswatter"}, "is_accepted": true, "score": 5, "last_activity_date": 1423112290, "creation_date": 1423112290, "answer_id": 28336512, "question_id": 28336450, "link": "https://stackoverflow.com/questions/28336450/is-the-go-programming-language-replacing-c/28336512#28336512", "title": "Is the Go programming language replacing C++?", "body": "<p>Go is designed for reliable, fast online services. It's the recommended language of Google App Engine. It does have general feature parity with C, plus additional scalability features. Perhaps, one day, it will be adopted for embedded programming and client-side applications, but that has yet to happen.</p>\n\n<p>C is used in many, many application domains. No other language approaches its breadth of use. As a first language, though, it won't help you develop good habits.</p>\n\n<p>C++ is a multi-paradigm language. It supports deep, generic metaprogramming. Many users of C++ are really using \"embedded domain-specific languages\" (EDSLs) where a library provides functionality defined within the C++ grammar. Go does not attempt to provide this depth, which is a Pandora's box of complexity.</p>\n"}], "owner": {"reputation": 165, "user_id": 4008702, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/105e4f498a400d9cfefd48c3a2625210?s=128&d=identicon&r=PG&f=1", "display_name": "Ayush Chaurasia", "link": "https://stackoverflow.com/users/4008702/ayush-chaurasia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1699, "favorite_count": 0, "closed_date": 1423122028, "accepted_answer_id": 28336512, "answer_count": 1, "score": 2, "last_activity_date": 1423117425, "creation_date": 1423111923, "last_edit_date": 1423117425, "question_id": 28336450, "link": "https://stackoverflow.com/questions/28336450/is-the-go-programming-language-replacing-c", "closed_reason": "Opinion-based", "title": "Is the Go programming language replacing C++?", "body": "<p>I have read on some blogs that Go is a better system programming language and is going to replace C/C++. I am currently learning C++. So, I was wondering whether I should continue learning C++ or move to Go? </p>\n"}, {"tags": ["http", "go", "gzip"], "answers": [{"comments": [{"owner": {"reputation": 359, "user_id": 2225493, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7134663e223da0dc6c1d20fd9dd7a46f?s=128&d=identicon&r=PG", "display_name": "homesalad", "link": "https://stackoverflow.com/users/2225493/homesalad"}, "edited": false, "score": 0, "creation_date": 1423142493, "post_id": 28338575, "comment_id": 45034293, "body": "Thanks! Good point about closing the inputChan. The code was just the smallest example I could produce that demonstrated the issue. I&#39;ll edit the post..."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1423121941, "creation_date": 1423121941, "answer_id": 28338575, "question_id": 28336313, "link": "https://stackoverflow.com/questions/28336313/golang-writing-to-http-response-breaks-input-reading/28338575#28338575", "title": "Golang writing to http response breaks input reading?", "body": "<p>The HTTP protocol is not full-duplex: it is request-response based. You should only send output once you're done with reading the input.</p>\n\n<p>In your code you use a <code>for</code> with <code>range</code> on a channel. This will try to read the channel <em>until</em> it is closed, but you never close the <code>inputChan</code>.</p>\n\n<p>If you never close <code>inputChan</code>, the following line is never reached:</p>\n\n<pre><code>donechan &lt;- true \n</code></pre>\n\n<p>And therefore receiving from <code>donechan</code> blocks:</p>\n\n<pre><code>&lt;-donechan\n</code></pre>\n\n<p>You have to close the <code>inputChan</code> when EOF is reached:</p>\n\n<pre><code>go func() {\n    for scanner.Scan() {\n        inputChan &lt;- scanner.Text()\n    }       \n    close(inputChan) // THIS IS NEEDED\n}()\n</code></pre>\n"}], "owner": {"reputation": 359, "user_id": 2225493, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7134663e223da0dc6c1d20fd9dd7a46f?s=128&d=identicon&r=PG", "display_name": "homesalad", "link": "https://stackoverflow.com/users/2225493/homesalad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 861, "favorite_count": 0, "accepted_answer_id": 28338575, "answer_count": 1, "score": 2, "last_activity_date": 1423142557, "creation_date": 1423110998, "last_edit_date": 1423142557, "question_id": 28336313, "link": "https://stackoverflow.com/questions/28336313/golang-writing-to-http-response-breaks-input-reading", "title": "Golang writing to http response breaks input reading?", "body": "<p>I'm attempting to write a small webapp in Go where the user uploads a gzipped file in a multipart form. The app unzips and parses the file and writes some output to the response. However, I keep running into an error where the input stream looks corrupted when I begin writing to the response. Not writing to the response fixes the problem, as does reading from a non-gzipped input stream. Here's an example http handler:</p>\n\n<pre><code>func(w http.ResponseWriter, req *http.Request) {\n\n//Get an input stream from the multipart reader\n//and read it using a scanner\nmultiReader, _ := req.MultipartReader()\npart, _ := multiReader.NextPart()\ngzipReader, _ := gzip.NewReader(part)\nscanner := bufio.NewScanner(gzipReader)\n\n//Strings read from the input stream go to this channel     \ninputChan := make(chan string, 1000)\n\n//Signal completion on this channel \ndonechan := make(chan bool, 1)\n\n//This goroutine just reads text from the input scanner\n//and sends it into the channel \ngo func() {\n    for scanner.Scan() {\n        inputChan &lt;- scanner.Text()\n    }       \n    close(inputChan)\n}()\n\n//Read lines from input channel. They all either start with #\n//or have ten tab-separated columns\ngo func() {\n    for line := range inputChan {\n        toks := strings.Split(line, \"\\t\")\n        if len(toks) != 10 &amp;&amp; line[0] != '#' {\n            panic(\"Dang.\")\n        }\n    }\n    donechan &lt;- true \n}()\n\n//periodically write some random text to the response\ngo func() {\n    for {\n        time.Sleep(10*time.Millisecond)     \n        w.Write([]byte(\"write\\n some \\n output\\n\"))\n    }\n}()\n\n//wait until we're done to return\n&lt;-donechan\n}\n</code></pre>\n\n<p>Weirdly, this code panics every time because it always encounters a line with fewer than 10 tokens, although at different spots every time. Commenting out the line that writes to the response fixes the issue, as does reading from a non-gzipped input stream. Am I missing something obvious? Why would writing to the response break if reading from a gzip file, but not a plain text formatted file? Why would it break at all? </p>\n"}, {"tags": ["xml", "go", "podcast"], "comments": [{"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 1, "creation_date": 1423099665, "post_id": 28334424, "comment_id": 45015891, "body": "The standard XML parser in Go can tolerate missing fields.  How &quot;variable&quot; are the XML documents that you are considering?  Is there a format that you can consider that represents the superset of the kinds of documents you&#39;ll be reading?"}, {"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1423100152, "post_id": 28334424, "comment_id": 45016009, "body": "Specifically, can you revise your question to <i>concretely</i> express which podcast formats you&#39;re talking about?  <code>RSS</code> and <code>Atom</code>?  The details matter here.  You might also look at the docs in <a href=\"https://github.com/gpodder/podcastparser/blob/master/doc/index.rst\" rel=\"nofollow noreferrer\">github.com/gpodder/podcastparser/blob/master/doc/index.rst</a> to see what other developers have considered in terms of what fields are interesting specifically for podcasts."}], "answers": [{"tags": [], "owner": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "is_accepted": false, "score": 0, "last_activity_date": 1423158063, "creation_date": 1423158063, "answer_id": 28350564, "question_id": 28334424, "link": "https://stackoverflow.com/questions/28334424/how-to-cope-with-different-type-of-xml/28350564#28350564", "title": "how to cope with different type of xml", "body": "<p>Self promotion: <a href=\"https://github.com/kylewolfe/simplexml\" rel=\"nofollow\">https://github.com/kylewolfe/simplexml</a></p>\n\n<p>This xml package is better suited for dynamic xml manipulation (imo). It's currently in development but I've used it for a few non critical tools so far.</p>\n"}], "owner": {"reputation": 7229, "user_id": 246095, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/edde29f5a7122602ae81653cb9108899?s=128&d=identicon&r=PG&f=1", "display_name": "nik", "link": "https://stackoverflow.com/users/246095/nik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423158063, "creation_date": 1423097750, "last_edit_date": 1423105794, "question_id": 28334424, "link": "https://stackoverflow.com/questions/28334424/how-to-cope-with-different-type-of-xml", "title": "how to cope with different type of xml", "body": "<p>I am writing a podcast application just as a weekend project. Just few minutes after starting I ran into an issue. So far I've looked at xml for two feeds. </p>\n\n<ol>\n<li><a href=\"http://feeds.feedburner.com/coderradiomp3?format=xml\" rel=\"nofollow\">http://feeds.feedburner.com/coderradiomp3?format=xml</a></li>\n<li><a href=\"http://feeds.twit.tv/sn.xml\" rel=\"nofollow\">http://feeds.twit.tv/sn.xml</a></li>\n<li><a href=\"http://revision3.com/tekzilla/feed/mp4-hd30/\" rel=\"nofollow\">http://revision3.com/tekzilla/feed/mp4-hd30/</a></li>\n</ol>\n\n<p>In both cases link to mp3 files are are at different locations. In  feed#2 it is under item -> link where as in feed # 1 it is under item -> media:content</p>\n\n<p>Similarly channel -> link in feed # 2 is url to feed's xml where as in feed  # 1 it is a link to the web site.</p>\n\n<p>so far I am just comparing feeds from two sites. there is a possibility that some other site is generating feed is some other way. </p>\n\n<p>Now because link to mp3 are/can be in different locations in feeds. how can I reliably parse feeds to always find link to mp3, title, pub date, etc all the time.</p>\n\n<p>Is it because one is rss and other is atom?\nHow will I know which one is what. Both feed # 2 and feed # 3 starts with rss, but have links to media file at different location.</p>\n"}]