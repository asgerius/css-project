[{"tags": ["parsing", "go", "jwt", "token", "jwt-go"], "answers": [{"comments": [{"owner": {"reputation": 6763, "user_id": 62662, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Wh1rm.png?s=128&g=1", "display_name": "o\u0254\u026f\u01dd\u0279", "link": "https://stackoverflow.com/users/62662/o%c9%94%c9%af%c7%9d%c9%b9"}, "edited": false, "score": 0, "creation_date": 1423077958, "post_id": 28326412, "comment_id": 45006741, "body": "While this code sample may possibly answer the question, it would be preferable to include some essential explanation to your answer. As it stands now this answer adds little to no value for future readers."}], "tags": [], "owner": {"reputation": 116, "user_id": 4529465, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3b28ede2f2e8dcf83a82feed2bfbdd67?s=128&d=identicon&r=PG", "display_name": "Jesse", "link": "https://stackoverflow.com/users/4529465/jesse"}, "is_accepted": true, "score": 10, "last_activity_date": 1423067275, "creation_date": 1423067275, "answer_id": 28326412, "question_id": 28204385, "link": "https://stackoverflow.com/questions/28204385/using-jwt-go-library-key-is-invalid-or-invalid-type/28326412#28326412", "title": "Using jwt-go Library - Key is invalid or invalid type", "body": "<pre><code>config struct {\n Key string\n}\n</code></pre>\n\n<p><code>Key</code> needs to be a <code>[]byte</code></p>\n"}, {"tags": [], "owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "is_accepted": false, "score": 4, "last_activity_date": 1423158746, "creation_date": 1423158746, "answer_id": 28350756, "question_id": 28204385, "link": "https://stackoverflow.com/questions/28204385/using-jwt-go-library-key-is-invalid-or-invalid-type/28350756#28350756", "title": "Using jwt-go Library - Key is invalid or invalid type", "body": "<p>Other way is to do something like this -</p>\n\n<pre><code>token, err := jwt.Parse(getToken, func(token *jwt.Token) (interface{}, error) {\n        return []byte(config.Config.Key), nil\n    })\n</code></pre>\n\n<p>The whole idea being that the Parse function returns a slice of bytes.</p>\n"}, {"tags": [], "owner": {"reputation": 540, "user_id": 4320971, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GTaVLU9qvKk/AAAAAAAAAAI/AAAAAAAAAzg/6UaPy5Cx1ys/photo.jpg?sz=128", "display_name": "Niko Kovacevic", "link": "https://stackoverflow.com/users/4320971/niko-kovacevic"}, "is_accepted": false, "score": 1, "last_activity_date": 1464281926, "creation_date": 1464281926, "answer_id": 37466956, "question_id": 28204385, "link": "https://stackoverflow.com/questions/28204385/using-jwt-go-library-key-is-invalid-or-invalid-type/37466956#37466956", "title": "Using jwt-go Library - Key is invalid or invalid type", "body": "<p>Taking a look at the function signatures in the <a href=\"https://godoc.org/github.com/dgrijalva/jwt-go#Parse\" rel=\"nofollow\">GoDoc for github.com/dgrijalva/jwt-go</a> we see:</p>\n\n<pre><code>func Parse(tokenString string, keyFunc Keyfunc) (*Token, error)\n\ntype Keyfunc func(*Token) (interface{}, error)\n</code></pre>\n\n<p><code>Keyfunc</code> requires you to return <code>(interface{}, error)</code>. Given the mysterious <code>interface{}</code> type, you might expect to be fine returning a <code>string</code>; however, a peek under the hood reveals that <code>Parse()</code> tries to <code>Verify()</code>, which attempts the following type assertion with your <code>interface{}</code> value as the <code>key</code>:</p>\n\n<pre><code>keyBytes, ok := key.([]byte)\n</code></pre>\n\n<p>That will succeed for <code>[]byte</code> types, but will fail for <code>string</code> types. When that fails, the result is the error message you are getting. Read more about <a href=\"https://golang.org/doc/effective_go.html#interface_conversions\" rel=\"nofollow\">type assertions in the Effective Go documentation</a> to learn why it fails.</p>\n\n<p>Example: <a href=\"https://play.golang.org/p/9KKNFLLQrm\" rel=\"nofollow\">https://play.golang.org/p/9KKNFLLQrm</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var a interface{}\n    var b interface{}\n\n    a = []byte(\"hello\")\n    b = \"hello\"\n\n    key, ok := a.([]byte)\n    if !ok {\n        fmt.Println(\"a is an invalid type\")\n    } else {\n        fmt.Println(key)\n    }\n\n    key, ok = b.([]byte)\n    if !ok {\n        fmt.Println(\"b is an invalid type\")\n    } else {\n        fmt.Println(key)\n    }\n}\n</code></pre>\n\n<hr>\n\n<pre><code>[104 101 108 108 111]\nb is an invalid type\n</code></pre>\n"}], "owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4158, "favorite_count": 1, "accepted_answer_id": 28326412, "answer_count": 3, "score": 4, "last_activity_date": 1588099018, "creation_date": 1422487712, "last_edit_date": 1588099018, "question_id": 28204385, "link": "https://stackoverflow.com/questions/28204385/using-jwt-go-library-key-is-invalid-or-invalid-type", "title": "Using jwt-go Library - Key is invalid or invalid type", "body": "<p>I am trying to pass in a token to the \"Parse(token String, keyFunc Keyfunc)\" GO routine defined in this GO-library (<a href=\"http://godoc.org/github.com/dgrijalva/jwt-go\" rel=\"nofollow\">http://godoc.org/github.com/dgrijalva/jwt-go</a>)  for JWT-token parsing/validation.</p>\n\n<p>When I pass the token to this function - </p>\n\n<pre><code>token, err := jwt.Parse(getToken, func(token *jwt.Token) (interface{}, error) {\n        return config.Config.Key, nil\n    })\n</code></pre>\n\n<p>I get an error which says \"Key is invalid or invalid type\".</p>\n\n<p>My config struct looks like this in config.go file  - </p>\n\n<pre><code>config struct {\n Key string\n}\n</code></pre>\n\n<p>Any suggestions to solve this problem? The token I am passing is a JWT token.</p>\n"}, {"tags": ["pointers", "go", "reflection", "struct"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1422480033, "last_edit_date": 1422480033, "creation_date": 1422476268, "answer_id": 28201599, "question_id": 28201395, "link": "https://stackoverflow.com/questions/28201395/how-to-get-the-underlying-type-of-the-pointer-using-reflect/28201599#28201599", "title": "How to get the underlying type of the pointer using reflect?", "body": "<p>You can get the <a href=\"http://golang.org/pkg/reflect/#Value\" rel=\"nofollow\"><code>Value</code></a> reflect object of some variable with  <a href=\"http://golang.org/pkg/reflect/#ValueOf\" rel=\"nofollow\"><code>reflect.ValueOf()</code></a>.</p>\n\n<p>If you also want to modify the variable or its fields, you have to pass the address (pointer) of the variable to <code>ValueOf()</code>. In this case the <code>Value</code> will belong to the pointer (not the pointed value), but you can use <a href=\"http://golang.org/pkg/reflect/#Value.Elem\" rel=\"nofollow\"><code>Value.Elem()</code></a> to \"navigate\" to the <code>Value</code> of the pointed object.</p>\n\n<p><code>*A</code> is embedded in <code>B</code>, so fields of <code>A</code> can be referenced from a value of <code>B</code>. You can simply use <a href=\"http://golang.org/pkg/reflect/#Value.FieldByName\" rel=\"nofollow\"><code>Value.FieldByName()</code></a> to access a field by name in order to get or set its value.</p>\n\n<p>So this does the work, try it on <a href=\"http://play.golang.org/p/TKD9ZvsbKy\" rel=\"nofollow\">Go Playground</a>:</p>\n\n<pre><code>b := B{A: &amp;A{\"initial\"}}\nfmt.Println(\"Initial value:\", *b.A)\n\nv := reflect.ValueOf(&amp;b).Elem()\nfmt.Println(\"Field_1 through reflection:\", v.FieldByName(\"Field_1\").String())\n\nv.FieldByName(\"Field_1\").SetString(\"works\")\nfmt.Println(\"After modified through reflection:\", *b.A)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Initial value: {initial}\nField_1 through reflection: initial\nAfter modified through reflection: {works}\n</code></pre>\n\n<p>I recommend to read this blog post to learn the basics of the reflection in Go:</p>\n\n<p><a href=\"http://blog.golang.org/laws-of-reflection\" rel=\"nofollow\"><strong>The Laws of Reflection</strong></a></p>\n"}], "owner": {"reputation": 131, "user_id": 2062175, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fc0e114424d432b14dd6d13a29919359?s=128&d=identicon&r=PG", "display_name": "Ary Purnomoz", "link": "https://stackoverflow.com/users/2062175/ary-purnomoz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1314, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1471855165, "creation_date": 1422475588, "last_edit_date": 1471855165, "question_id": 28201395, "link": "https://stackoverflow.com/questions/28201395/how-to-get-the-underlying-type-of-the-pointer-using-reflect", "title": "How to get the underlying type of the pointer using reflect?", "body": "<p>What I want is to get the fields of <code>A</code> through <code>B</code>, like </p>\n\n<pre><code>type A struct {\n  Field_1 string\n}\ntype B struct {\n  *A\n}\n\nfieldsOfA := someMagicFunc(&amp;B{})\n</code></pre>\n"}, {"tags": ["ajax", "nginx", "go", "proxy", "cors"], "comments": [{"owner": {"reputation": 10939, "user_id": 891636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6dbdad904867cda6f67f452860d212a4?s=128&d=identicon&r=PG", "display_name": "Dayo", "link": "https://stackoverflow.com/users/891636/dayo"}, "edited": false, "score": 1, "creation_date": 1422474936, "post_id": 28201163, "comment_id": 44768529, "body": "What exactly is the query? The error message seems to be quite clear on what needs to be done."}, {"owner": {"reputation": 831, "user_id": 2322343, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/207fabf36a3d8b41cb8577413b436ad0?s=128&d=identicon&r=PG", "display_name": "moosilauke18", "link": "https://stackoverflow.com/users/2322343/moosilauke18"}, "reply_to_user": {"reputation": 10939, "user_id": 891636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6dbdad904867cda6f67f452860d212a4?s=128&d=identicon&r=PG", "display_name": "Dayo", "link": "https://stackoverflow.com/users/891636/dayo"}, "edited": false, "score": 0, "creation_date": 1422475089, "post_id": 28201163, "comment_id": 44768637, "body": "Well, I from what I read, I have enabled CORS in the golang app. I have also forwarded the headers through the proxy, so it shouldn&#39;t still give this error, yet it is."}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1422478100, "post_id": 28201163, "comment_id": 44770375, "body": "Is ServeHTTP actually getting the request form Firefox? This is most likely a https certificate problem."}], "answers": [{"tags": [], "owner": {"reputation": 856, "user_id": 1127793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f511fb7651bd73b2d005443265bf151?s=128&d=identicon&r=PG", "display_name": "nkhumphreys", "link": "https://stackoverflow.com/users/1127793/nkhumphreys"}, "is_accepted": false, "score": 0, "last_activity_date": 1442507789, "creation_date": 1442507789, "answer_id": 32635553, "question_id": 28201163, "link": "https://stackoverflow.com/questions/28201163/golang-app-behind-nginx-reverse-proxy-wont-accept-ajax-request-on-firefox-due-t/32635553#32635553", "title": "Golang app behind Nginx reverse proxy won&#39;t accept ajax request on firefox due to CORS", "body": "<p>DISCLAIMER: I have just seen how old this post is, I imagine the problem has already been solved.</p>\n\n<p>This worked for me:</p>\n\n<pre><code>func corsHandler(fn http.HandleFunc) http.HandleFunc {\n    return func(rw http.ResponseWriter, req *http.Request) {\n        rw.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n        fn(rw, req)\n    }\n}\n</code></pre>\n\n<p>Then when setting up your routers you can:</p>\n\n<pre><code>r := mux.NewRouter()\nr.HandleFunc(\"/&lt;route&gt;\", corsHandler(handleRouteMethod)).Methods(\"&lt;METHOD&gt;\")\n</code></pre>\n\n<p>Slightly different approach but it has definitely worked, so if all else fails, you could give it a try (this assumes you are using gorilla mux, if you are using the httprouter or something else then your corsHandler method maybe needs to use a different function signature).</p>\n"}], "owner": {"reputation": 831, "user_id": 2322343, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/207fabf36a3d8b41cb8577413b436ad0?s=128&d=identicon&r=PG", "display_name": "moosilauke18", "link": "https://stackoverflow.com/users/2322343/moosilauke18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1611, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1442507789, "creation_date": 1422474749, "question_id": 28201163, "link": "https://stackoverflow.com/questions/28201163/golang-app-behind-nginx-reverse-proxy-wont-accept-ajax-request-on-firefox-due-t", "title": "Golang app behind Nginx reverse proxy won&#39;t accept ajax request on firefox due to CORS", "body": "<p>So I have a domain name which is a static html file that sends an ajax request to a subdomain app which is behind Nginx in a reverse proxy. </p>\n\n<p>Here is my ajax code:</p>\n\n<pre><code>$(document).ready(function(){\n  function call() {\n    $.ajax({\n      type: \"POST\",\n      url: \"https://test.example.com/call\",\n      crossDomain: true,\n      data: $(\"#form-call\").serialize(),\n      success: function(response) {\n        $(\"#response\").html(response);\n      },\n      error: function() {\n        alert(\"error\");\n      }\n\n});\n</code></pre>\n\n<p>And on Nginx I have:</p>\n\n<pre><code>    upstream example {\n         server 192.168.1.10:6000;\n    }\n    server {\n\n        listen 443;\n        server_name test.example.com;\n        ssl on;\n        ssl_certificate /etc/nginx/ssl/afs.crt;\n        ssl_certificate_key /etc/nginx/ssl/afs.key;\n        proxy_set_header Host             $http_host;\n        proxy_set_header X-Real-IP        $remote_addr;\n        proxy_set_header Authorization    \"\";\n\n        client_max_body_size 0;\n\n        chunked_transfer_encoding on;\n        add_header 'Access-Control-Allow-Origin' \"$http_origin\";\n\n\n        location / {\n            proxy_pass https://exapmle;\n            proxy_read_timeout 900;\n        }\n    }\n</code></pre>\n\n<p>And I have this on my golang app to help with CORS:</p>\n\n<pre><code>func (s *MyServer) ServeHTTP(rw http.ResponseWriter, req *http.Request) {\n    if origin := req.Header.Get(\"Origin\"); origin != \"\" {\n        rw.Header().Set(\"Access-Control-Allow-Origin\", origin)\n        rw.Header().Set(\"Access-Control-Allow-Methods\", \"POST, GET, OPTIONS, PUT, DELETE\")\n        rw.Header().Set(\"Access-Control-Allow-Headers\",\n            \"Accept, Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization\")\n    }\n    // Stop here if its Preflighted OPTIONS request\n    if req.Method == \"OPTIONS\" {\n        return\n    }\n    // Lets Gorilla work\n    s.r.ServeHTTP(rw, req)\n}\n</code></pre>\n\n<p>It works fine on chrome, but on firefox I get the error:</p>\n\n<p><code>Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at https://test.example.com/call. This can be fixed by moving the resource to the same domain or enabling CORS.</code></p>\n"}, {"tags": ["go", "channel", "unbuffered"], "answers": [{"comments": [{"owner": {"reputation": 580, "user_id": 1211070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wYkCS.png?s=128&g=1", "display_name": "AndyS", "link": "https://stackoverflow.com/users/1211070/andys"}, "edited": false, "score": 0, "creation_date": 1422475119, "post_id": 28200787, "comment_id": 44768659, "body": "A bit short - but it lead me to the answer - thank you"}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 2, "last_activity_date": 1422619160, "last_edit_date": 1422619160, "creation_date": 1422473411, "answer_id": 28200787, "question_id": 28200468, "link": "https://stackoverflow.com/questions/28200468/go-channels-behaviour-appears-inconsistent/28200787#28200787", "title": "Go Channels behaviour appears inconsistent", "body": "<p>Roughly: Send and receive happen concurrently. The details are explained in the Go Memory Model which determines this behaviour. Concurrent code is complicated...</p>\n"}, {"tags": [], "owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "is_accepted": false, "score": 1, "last_activity_date": 1422473415, "creation_date": 1422473415, "answer_id": 28200790, "question_id": 28200468, "link": "https://stackoverflow.com/questions/28200468/go-channels-behaviour-appears-inconsistent/28200790#28200790", "title": "Go Channels behaviour appears inconsistent", "body": "<blockquote>\n  <p>communication succeeds only when both a sender and receiver are ready</p>\n</blockquote>\n\n<p>The key is that this does not require the receiver to immediately start processing the message it has received. Specifically in your case, it is ready, so it receives the value without invoking the scheduler (no context switch). The goroutine continues running until it tries to send again, at which point the receiver is not ready, so the scheduler is invoked etc.</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 3, "last_activity_date": 1422474192, "last_edit_date": 1422474192, "creation_date": 1422473423, "answer_id": 28200794, "question_id": 28200468, "link": "https://stackoverflow.com/questions/28200468/go-channels-behaviour-appears-inconsistent/28200794#28200794", "title": "Go Channels behaviour appears inconsistent", "body": "<p>This timeline for the two goroutines shows what's going on:</p>\n\n<pre><code>send()                  main()\n\nfmt.Println(\"send 1\")\nsendto &lt;- \"Hello\"       msg := &lt;- hole              // sender and receiver both ready\nfmt.Println(\"send 2\")\n                        fmt.Println(\" recd \", msg)  // msg is \"Hello\"\nsendto &lt;- \"World\"       msg := &lt;- hole              // sender and receiver both ready\n                        fmt.Println(\" recd \", msg)  // msg is \"World\"\nfmt.Println(\"send 3\")\nsendto &lt;- \"\"\nfmt.Println(\"send() exit\")\n</code></pre>\n\n<p><code>send 2</code> is printed before <code>recd Hello</code> because send() runs to the print statement before the runtime schedules main() to run again. </p>\n\n<p>There is no <a href=\"https://golang.org/ref/mem#tmp_2\" rel=\"nofollow\">happens before</a> relationship for printing the two messages. They can be printed in either order. </p>\n"}], "owner": {"reputation": 580, "user_id": 1211070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wYkCS.png?s=128&g=1", "display_name": "AndyS", "link": "https://stackoverflow.com/users/1211070/andys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 28200787, "answer_count": 3, "score": 0, "last_activity_date": 1422619160, "creation_date": 1422472300, "question_id": 28200468, "link": "https://stackoverflow.com/questions/28200468/go-channels-behaviour-appears-inconsistent", "title": "Go Channels behaviour appears inconsistent", "body": "<p>I am seeing an inconsistency in the way unbuffered channels appear to work - this is either an inconsistency in Go, or in my understanding of Go...</p>\n\n<p>Here is a simple example with output. The 'inconsistency' is with the 'make channel' lines.</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    )\n\nfunc send(sendto chan string) {\n    fmt.Println(\"send 1\")\n    sendto &lt;- \"Hello\"\n    fmt.Println(\"send 2\")\n    sendto &lt;- \"World\"\n    fmt.Println(\"send 3\")\n    sendto &lt;- \"\"\n    fmt.Println(\"send() exit\")\n}\n\nfunc main() {\n    //hole := make(chan string)\n    //hole := make(chan string, 0)\n    hole := make(chan string, 1)\n    go send(hole)\n    fmt.Println(\"main loop\")\n    carryon := true\n    for carryon {\n        msg := &lt;- hole\n        if msg == \"\" {\n            carryon = false\n        } else {\n            fmt.Println(\" recd \", msg)\n        }\n    }\n}\n</code></pre>\n\n<p>When I run as above, the output is as expected (and also as expected for a buffer size of 2). i.e. the channel has a buffer of 1, which holds one value - on next attempting to write, there is a context switch to the main to allow it to consume the first value.</p>\n\n<pre><code>main loop\nsend 1\nsend 2\n recd  Hello\nsend 3\n recd  World\nsend() exit\n</code></pre>\n\n<p>When I then change the make channel line to:</p>\n\n<pre><code>hole := make(chan string, 0)\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>main loop\nsend 1\nsend 2\n recd  Hello\n recd  World\nsend 3\nsend() exit\n</code></pre>\n\n<p>I would have expected the <code>send 2</code> and the <code>recd Hello</code> to be the other way around...</p>\n\n<p>I get the same output for <code>hole := make(chan string)</code></p>\n\n<p>I checked the specification and it says</p>\n\n<blockquote>\n  <p>The capacity, in number of elements, sets the size of the buffer in the channel. If the capacity is <strong>zero or absent</strong>, the channel is <strong>unbuffered</strong> and communication succeeds <strong>only when both a sender and receiver are ready</strong>. Otherwise, the channel is buffered and communication succeeds without blocking if the buffer is not full (sends) or not empty (receives).</p>\n</blockquote>\n\n<p>Please can someone explain either</p>\n\n<ul>\n<li>Why my expectations are wrong - please be kind</li>\n<li>or whether Go is actually wrong</li>\n</ul>\n\n<p>Thank you</p>\n"}, {"tags": ["google-app-engine", "go", "liteide"], "owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1422472282, "creation_date": 1422471981, "last_edit_date": 1422472282, "question_id": 28200383, "link": "https://stackoverflow.com/questions/28200383/liteide-for-go-in-google-app-engine", "title": "LiteIDE for Go in Google App Engine", "body": "<p>It seems to me that LiteIDE is a good environment to get started with Go...</p>\n\n<p>But in order to debug, it's asking me for the following:</p>\n\n<p><img src=\"https://i.stack.imgur.com/5W79N.jpg\" alt=\"LiteIDE External Applications Settings\"></p>\n\n<p>What should I set these to if I'm developing a Google App Engine app?</p>\n\n<p>I need the ability to detect and give hints to compile-time errors in the IDE. That should also be the case when using GAE-specific APIs (Channel API, etc.)</p>\n\n<p>Though for runtime errors, I would assume that those are better left to visiting the dev site.</p>\n\n<p>In other words- the way Google App Engine does things if I understand correctly, is you launch dev_appserver.py and then you don't actually recompile/relaunch again, the dev server does all of that and you simply visit <a href=\"http://localhost:8080\" rel=\"nofollow noreferrer\">http://localhost:8080</a> to test it, and it will give runtime errors descriptively in the browser.</p>\n"}, {"tags": ["web", "go", "frameworks", "beego"], "answers": [{"tags": [], "owner": {"reputation": 3918, "user_id": 276983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f3b9e4af76309929e313be54f5bc1b4?s=128&d=identicon&r=PG", "display_name": "joshua", "link": "https://stackoverflow.com/users/276983/joshua"}, "is_accepted": false, "score": 0, "last_activity_date": 1453467153, "last_edit_date": 1453467153, "creation_date": 1453464892, "answer_id": 34946492, "question_id": 28198702, "link": "https://stackoverflow.com/questions/28198702/is-there-a-way-to-hot-reload-a-controller-into-beego-following-a-code-change/34946492#34946492", "title": "Is there a way to hot reload a controller into Beego following a code change?", "body": "<p>It works out of the box for me. </p>\n\n<p>Here are my versions:</p>\n\n<pre><code>bee   :1.4.1\nbeego :1.6.0\nGo    :go version go1.5.3 linux/amd64\n</code></pre>\n\n<p>Sometimes there is a delay of around 2 seconds. If you look at the console output, you will see something like :</p>\n\n<pre><code>2016/01/22 15:11:21 [INFO] Restarting myapp ...\n2016/01/22 15:11:21 [INFO] ./notes is running...\n2016/01/22 15:11:21 [asm_amd64.s:1721][I] http server Running on :8080\n2016/01/22 15:11:33 [router.go:828][D] | GET \n</code></pre>\n\n<p>If you have a syntax error, it wont reload. </p>\n\n<p>To watch and reload more file types, i added 'bee.json' file at the root of the project. The file looks like:</p>\n\n<pre><code>{\"watch_ext\": [\"go\",\"conf\",\"html\",\"css\",\"js\",\"tpl\"]}\n</code></pre>\n\n<p>Other properties you can set can be found <a href=\"http://beego.me/docs/install/bee.md#bee-tool-configuration\" rel=\"nofollow\">here</a></p>\n\n<p>Josh</p>\n"}], "owner": {"reputation": 837, "user_id": 2744842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a43dacfc8c5189bb35f3b012f96ec05e?s=128&d=identicon&r=PG&f=1", "display_name": "eric gilbertson", "link": "https://stackoverflow.com/users/2744842/eric-gilbertson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 736, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453467153, "creation_date": 1422466395, "question_id": 28198702, "link": "https://stackoverflow.com/questions/28198702/is-there-a-way-to-hot-reload-a-controller-into-beego-following-a-code-change", "title": "Is there a way to hot reload a controller into Beego following a code change?", "body": "<p>Is there any way to configure Beego 1.4.2 to hot patch a modified controller following a code change? Out of the box it reloads the entire application following a controller edit, thus causing any session data to be lost. A comment in GG suggests that hot reload existed in Beego 1.3, but I can't find any info as to why 1.4* does not do this. IMHO Beego is a neat framework but I wouldn't use it for a large project without the ability to dynamically update controllers.</p>\n"}, {"tags": ["hash", "go"], "answers": [{"comments": [{"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 1, "creation_date": 1422465313, "post_id": 28198255, "comment_id": 44763087, "body": "I see. If I create an &quot;empty&quot; md5 object and print it out I get the other half of h2. It seems I made a few too many assumptions brought in from other languages. Go is eventually going to break me of doing that."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1422465400, "last_edit_date": 1422465400, "creation_date": 1422465008, "answer_id": 28198255, "question_id": 28197777, "link": "https://stackoverflow.com/questions/28197777/difference-between-calling-writeval-then-sumnil-compared-to-sumval-in-hash/28198255#28198255", "title": "Difference between calling Write(val) then Sum(nil) compared to Sum(val) in hash?", "body": "<p><a href=\"http://godoc.org/hash#Hash.Sum\" rel=\"nofollow\">Sum</a> appends the current hash to the argument and returns the result. The argument is not added to the hash.</p>\n\n<p>The argument is provided so that applications can avoid an allocation when getting the hash.  Many applications do not need this optimization and can simply call <code>h.Sum(nil)</code>. </p>\n"}], "owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "accepted_answer_id": 28198255, "answer_count": 1, "score": 3, "last_activity_date": 1422465400, "creation_date": 1422463703, "last_edit_date": 1422464359, "question_id": 28197777, "link": "https://stackoverflow.com/questions/28197777/difference-between-calling-writeval-then-sumnil-compared-to-sumval-in-hash", "title": "Difference between calling Write(val) then Sum(nil) compared to Sum(val) in hash?", "body": "<p>I'm looking into using Go's crypto package and I have a simple example that I'm trying to figure out. I know I can use <code>io.WriteString</code> with the hash, but I want to understand the hash object directly before interfacing it with another library.</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/md5\"\n    \"fmt\"\n)\n\nfunc main() {\n    val := []byte(\"Hello World\")\n\n    h := md5.New()\n    h.Write(val)\n    fmt.Printf(\"%x\\n\", h.Sum(nil))\n\n    fmt.Println()\n\n    h2 := md5.New()\n    fmt.Printf(\"%x\\n\", h2.Sum(val))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/bjGbbwsIJ0\" rel=\"nofollow\">Running it</a> produces this output:</p>\n\n<pre><code>b10a8db164e0754105b7a99be72e3fe5\n\n48656c6c6f20576f726c64d41d8cd98f00b204e9800998ecf8427e\n</code></pre>\n\n<p>In pseudo code, I would expect that:</p>\n\n<pre><code>h.Write(part1)\nh.Write(part2)\nresult := h.Sum(part3)\n</code></pre>\n\n<p>Would produce the same results as</p>\n\n<pre><code>result := h.Sum(part1 + part2 + part3)\n</code></pre>\n\n<p>but in my simple example above I can't even get a single part to produce the same output in both scenarios. <code>Write</code> is mysteriously missing from <a href=\"https://golang.org/pkg/crypto/md5/\" rel=\"nofollow\">the GoLang pkg site listing for md5</a> which leads me to believe I might be using it wrong. I'm especially confused by the fact that if I only use the <code>Sum</code> method, I get a longer than usual hash.</p>\n\n<p>What's going on here?</p>\n\n<p>EDIT: I decided to print the hex for <code>val</code> and noticed that it exactly matched the beginning of <code>h2.Sum(val)</code>'s output. For comparison:</p>\n\n<pre><code>val: 48656c6c6f20576f726c64\n h2: 48656c6c6f20576f726c64d41d8cd98f00b204e9800998ecf8427e\n</code></pre>\n\n<p>I'm definitely doing something wrong. Should I avoid the <code>Write</code> function entirely and stick with <code>io</code>?</p>\n"}, {"tags": ["struct", "import", "go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1422462771, "post_id": 28197443, "comment_id": 44761373, "body": "Did you mean to write <code>. &quot;github.com&#47;mitchellh&#47;mapstructure&quot;</code>? Because _ is a blank import."}, {"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1422463589, "post_id": 28197443, "comment_id": 44761921, "body": "Why import with underscore <code>_</code> in the first place?  Can you use a regular import?"}], "answers": [{"tags": [], "owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "is_accepted": true, "score": 8, "last_activity_date": 1422462838, "creation_date": 1422462838, "answer_id": 28197489, "question_id": 28197443, "link": "https://stackoverflow.com/questions/28197443/golang-undefined-function-call-on-imported-library/28197489#28197489", "title": "golang undefined function call on imported library", "body": "<p>If you import a package with _ as first argument, you cannot use any function or type of that package. _ means that you are importing the package only for its secondary effects of calling the init() functions. </p>\n\n<p>In addition, you need to use the package name before the function, mapstructure.Decode in this case.</p>\n\n<p>Alternatively, as pointed out by Ainar-G, you may use \".\" instead of _ when importing the package. This way you will be importing the names to the \"default\" namespace, allowing to use Decode directly. However, this is not recommended because you are polluting the namespace with other names and there may be conflicts, now or in the future.</p>\n"}], "owner": {"reputation": 2741, "user_id": 2438413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cLAr2.jpg?s=128&g=1", "display_name": "Juan M", "link": "https://stackoverflow.com/users/2438413/juan-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 948, "favorite_count": 0, "accepted_answer_id": 28197489, "answer_count": 1, "score": 0, "last_activity_date": 1422462838, "creation_date": 1422462694, "question_id": 28197443, "link": "https://stackoverflow.com/questions/28197443/golang-undefined-function-call-on-imported-library", "title": "golang undefined function call on imported library", "body": "<p>I've imported</p>\n\n<pre><code>_ \"github.com/mitchellh/mapstructure\"\n</code></pre>\n\n<p>Into a project of mine. However i'm not able to utilize the Decode function included in that library in order to convert a map interface to struct:</p>\n\n<pre><code>var result Person\nerr := Decode(input, &amp;result)\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>This basic call returns \"undefined: Decode\" error. Is there anything else to be done besides the import?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["javascript", "html", "go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1422459903, "post_id": 28196391, "comment_id": 44759413, "body": "Have a look at this <a href=\"http://www.gorillatoolkit.org/pkg/websocket\" rel=\"nofollow noreferrer\">websocket library for Go</a>."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1422461189, "last_edit_date": 1422461189, "creation_date": 1422460010, "answer_id": 28196483, "question_id": 28196391, "link": "https://stackoverflow.com/questions/28196391/golang-html-pages-and-go-communication/28196483#28196483", "title": "Golang: html pages and GO communication", "body": "<p>You can use websockets (<a href=\"http://en.wikipedia.org/wiki/WebSocket\" rel=\"nofollow\">WebSocket@Wikipedia</a>).</p>\n\n<p>Here are 2 implementations:</p>\n\n<p><a href=\"http://godoc.org/golang.org/x/net/websocket\" rel=\"nofollow\"><strong><code>golang.org/x/net/websocket</code></strong></a></p>\n\n<p><a href=\"http://godoc.org/github.com/gorilla/websocket\" rel=\"nofollow\"><strong><code>github.com/gorilla/websocket</code></strong></a></p>\n\n<p>And here is an exhausting list of other websocket packages/implementations:</p>\n\n<p><a href=\"http://godoc.org/?q=websocket\" rel=\"nofollow\"><strong>godoc.org websocket search</strong></a></p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1422463466, "last_edit_date": 1422463466, "creation_date": 1422461181, "answer_id": 28196904, "question_id": 28196391, "link": "https://stackoverflow.com/questions/28196391/golang-html-pages-and-go-communication/28196904#28196904", "title": "Golang: html pages and GO communication", "body": "<p>Use <a href=\"http://en.wikipedia.org/wiki/WebSocket\" rel=\"nofollow\">websockets</a> or <a href=\"http://en.wikipedia.org/wiki/Server-sent_events\" rel=\"nofollow\">server sent events</a> to push events from the server to the browser client.</p>\n\n<p>Use the <a href=\"http://godoc.org/github.com/gorilla/websocket\" rel=\"nofollow\">gorilla/websocket</a> package for websockets. The <a href=\"http://godoc.org/golang.org/x/net/websocket\" rel=\"nofollow\">x/net/websocket</a> package is also available, but it's partial implementation of the protocol <a href=\"https://github.com/golang/go/issues/7632\" rel=\"nofollow\">does not work with recent versions of Chrome</a>.</p>\n\n<p>Server sent events are so simple that a helper package is not really needed. See <a href=\"https://github.com/kljensen/golang-html5-sse-example\" rel=\"nofollow\">this example</a> to get started with server sent events. </p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1422463081, "creation_date": 1422463081, "answer_id": 28197576, "question_id": 28196391, "link": "https://stackoverflow.com/questions/28196391/golang-html-pages-and-go-communication/28197576#28197576", "title": "Golang: html pages and GO communication", "body": "<p>It's not about Go. Client side i.e. browser must be capable to handle persistent connection. So nothing new here. You have</p>\n\n<ul>\n<li>Long-polling for older browsers </li>\n<li>Websockets for modern browsers</li>\n<li>Server-sent-events for tomorrow (to say, excluding IE, them holds even\nnow) </li>\n<li>Push-services provided by Google and Apple for mobile platforms</li>\n</ul>\n\n<p>Either technics can be easily implemented with Go on server side. Nothing tricky.</p>\n"}], "owner": {"reputation": 748, "user_id": 1617548, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/71837144a8831dea7319f5ff0650a62d?s=128&d=identicon&r=PG", "display_name": "vmandke", "link": "https://stackoverflow.com/users/1617548/vmandke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1263, "favorite_count": 0, "accepted_answer_id": 28196483, "answer_count": 3, "score": 1, "last_activity_date": 1422463466, "creation_date": 1422459758, "question_id": 28196391, "link": "https://stackoverflow.com/questions/28196391/golang-html-pages-and-go-communication", "title": "Golang: html pages and GO communication", "body": "<p>Is there a way other than templates to communicate between Go and html pages ? Using something like postmessages ?</p>\n\n<p>Scenario ::--> Streaming Twitter Api</p>\n\n<p>Streaming api call, updates with new content as and when available;</p>\n\n<p>Want to update the web page with the latest content, keeping the original content as it is.</p>\n\n<p>Want to avoid using NaCl... As it is only for chrome</p>\n"}, {"tags": ["go", "mux"], "answers": [{"comments": [{"owner": {"reputation": 20193, "user_id": 1779113, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fbd338a5ff4a8feb86507a4dacddc05b?s=128&d=identicon&r=PG", "display_name": "nburk", "link": "https://stackoverflow.com/users/1779113/nburk"}, "edited": false, "score": 0, "creation_date": 1543337816, "post_id": 28192473, "comment_id": 93878542, "body": "Does this refer to the JSON body or where exactly is the <code>login</code> field that&#39;s being retrieved? I&#39;m trying this method but <code>FormValue</code> always just returns an empty string."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 20193, "user_id": 1779113, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fbd338a5ff4a8feb86507a4dacddc05b?s=128&d=identicon&r=PG", "display_name": "nburk", "link": "https://stackoverflow.com/users/1779113/nburk"}, "edited": false, "score": 1, "creation_date": 1543338775, "post_id": 28192473, "comment_id": 93879115, "body": "@nburk No, this is about a usual HTML form. For JSON you need to decode a structure from a body."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 30, "last_activity_date": 1422448714, "creation_date": 1422448714, "answer_id": 28192473, "question_id": 28192178, "link": "https://stackoverflow.com/questions/28192178/access-post-parameters-in-handler/28192473#28192473", "title": "access post parameters in handler", "body": "<p>By using <a href=\"http://golang.org/pkg/net/http/#Request.FormValue\"><code>(*http.Request).FormValue</code></a> method.</p>\n\n<pre><code>func logonPost(w http.ResponseWriter, r *http.Request) {\n    login := r.FormValue(\"login\")\n    // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13754, "favorite_count": 1, "accepted_answer_id": 28192473, "answer_count": 1, "score": 16, "last_activity_date": 1422448714, "creation_date": 1422447837, "question_id": 28192178, "link": "https://stackoverflow.com/questions/28192178/access-post-parameters-in-handler", "title": "access post parameters in handler", "body": "<p>I can access <code>GET</code> parameters using <a href=\"http://github.com/gorilla/mux\" rel=\"noreferrer\">mux</a>:</p>\n\n<pre><code>import (\n    \"github.com/gorilla/mux\"\n)\nfunc main(){\n     rtr := mux.NewRouter()\n     rtr.HandleFunc(\"/logon\", logonGet).Methods(\"GET\")\n}\nfunc logonGet(w http.ResponseWriter, r *http.Request) {\n    params := mux.Vars(r)\n    login := params[\"login\"]\n}\n</code></pre>\n\n<p>But cannot figure out how to access <code>POST</code> params</p>\n\n<pre><code>func main(){\n     rtr := mux.NewRouter()\n     rtr.HandleFunc(\"/logon\", logonPost).Methods(\"POST\")\n}\nfunc logonPost(w http.ResponseWriter, r *http.Request) {\n    // how to get POST parameters from request\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 923, "user_id": 711024, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/595b03bef5e51ded53769ba91df29955?s=128&d=identicon&r=PG", "display_name": "Azr", "link": "https://stackoverflow.com/users/711024/azr"}, "is_accepted": false, "score": 0, "last_activity_date": 1425912702, "last_edit_date": 1425912702, "creation_date": 1425911494, "answer_id": 28944539, "question_id": 28188504, "link": "https://stackoverflow.com/questions/28188504/setting-up-an-app-engine-context-in-go/28944539#28944539", "title": "Setting up an App Engine Context in Go", "body": "<p>Does removing and re go getting <code>google.golang.org/appengine</code> from your GOPATH fixes the issue ?</p>\n\n<p>Edit: Also, a colleague of mine said that after rebooting all went well.</p>\n"}], "owner": {"reputation": 696, "user_id": 189303, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1417181e48148b2b441b46b0743d5ce4?s=128&d=identicon&r=PG", "display_name": "Etienne", "link": "https://stackoverflow.com/users/189303/etienne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 558, "favorite_count": 3, "answer_count": 1, "score": 2, "last_activity_date": 1425912702, "creation_date": 1422436767, "question_id": 28188504, "link": "https://stackoverflow.com/questions/28188504/setting-up-an-app-engine-context-in-go", "title": "Setting up an App Engine Context in Go", "body": "<p>I post JSON to an app I registered at Google App Engine but I am baffled by the authentication process in my Go code to get it working in appengine:</p>\n\n<pre><code>func init() {\n    http.HandleFunc(\"/post\", handler)\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n\n    app := appengine.NewContext(r)\n    client := &amp;http.Client{\n        Transport: &amp;oauth2.Transport{\n            Source: google.AppEngineTokenSource(app, \"https://www.googleapis.com/auth/bigquery\"),\n            Base: &amp;urlfetch.Transport{\n                Context: app,\n            },\n        },\n    }\n    log.Print(client)\n}\n</code></pre>\n\n<p>In following the docs, I have reduced my problem to the code above which consistently gives me the following error:</p>\n\n<pre><code>2015/01/28 09:05:32 appengine: NewContext passed an unknown http.Request\n</code></pre>\n\n<p>I'd love some pointers as to how I can provide appengine with a \"known\" http.Request because ultimately I am trying to get to the storage api which also requires a valid context.</p>\n"}, {"tags": ["sockets", "tcp", "go"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 1, "creation_date": 1422433953, "post_id": 28187519, "comment_id": 44743666, "body": "Can you show what you&#39;ve tried so far, specifically what your server code looks like?  What problems do you anticipate, what problems have you observed?  Have you tried running your server with both ways of writing and seeing how each behaves?"}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1422434025, "post_id": 28187519, "comment_id": 44743701, "body": "Note that if you&#39;re doing standard HTTP stuff with <code>ListenAndServe</code> and <code>HandlerFunc</code>s, you should write to the <code>ResponseWriter</code> synchronously.  Seeing as you&#39;re writing directly to some connection object, maybe you&#39;re doing something lower level than a standard HTTP server?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1422439797, "post_id": 28187519, "comment_id": 44746898, "body": "You can use a buffered writer (<code>bufio.Writer</code>) if you want, but it&#39;s not really necessary."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1422440106, "post_id": 28187519, "comment_id": 44747111, "body": "I think what the OP is actually asking is if <code>conn.Write(msg)</code> will:  1. Write the whole <code>msg</code> or error ? or 2. Can write part of <code>msg</code> and thus need a loop or similar to write the entire <code>msg</code> ?"}, {"owner": {"reputation": 1456, "user_id": 1784595, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KoQV5.png?s=128&g=1", "display_name": "frank.lin", "link": "https://stackoverflow.com/users/1784595/frank-lin"}, "edited": false, "score": 0, "creation_date": 1422441253, "post_id": 28187519, "comment_id": 44747805, "body": "even if there is a  <code>bufio.Writer</code>, when the network is busy, the system send the data slowly, it will block , right?  so it&#39;ll still slow the latency ."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1422442669, "post_id": 28187519, "comment_id": 44748580, "body": "@buzz if you&#39;re producing more data than you can send it to the client, you will buffer the data somewhere. What&#39;s the use of producing data faster than the client can consume it?"}], "answers": [{"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 1, "last_activity_date": 1422445790, "creation_date": 1422445790, "answer_id": 28191557, "question_id": 28187519, "link": "https://stackoverflow.com/questions/28187519/do-i-need-a-write-buffer-for-socket-in-go/28191557#28191557", "title": "Do I need a write buffer for socket in go?", "body": "<blockquote>\n  <p>server [...] create a new goroutine for a new connnection</p>\n</blockquote>\n\n<p>This makes sense because the handler goroutines can block without delaying the server's accept loop.</p>\n\n<p>If you handled each request serially, any blocking syscall would essentially lock up the server for all clients.</p>\n\n<blockquote>\n  <p>goroutine especially for writing</p>\n</blockquote>\n\n<p>This would only make sense in use cases where you're writing either a really big chunk of data or to a very slow connection and you need your handler to continue unblocked, for instance.</p>\n\n<p>Note that this is not what is commonly understood as a \"write buffer\".</p>\n"}, {"comments": [{"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1612092435, "post_id": 28204179, "comment_id": 116653323, "body": "You don&#39;t need to have a <code>for</code> for write, contrary to C, in Go <code>Write</code> should write the whole slice or return an error. From docs: Write must return a non-nil error if it returns n &lt; len(p)"}], "tags": [], "owner": {"reputation": 171, "user_id": 4493198, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kAjSGsEiJG4/AAAAAAAAAAI/AAAAAAABW2o/rzwHgxgYxY4/photo.jpg?sz=128", "display_name": "iccananea", "link": "https://stackoverflow.com/users/4493198/iccananea"}, "is_accepted": false, "score": 3, "last_activity_date": 1422486589, "creation_date": 1422486589, "answer_id": 28204179, "question_id": 28187519, "link": "https://stackoverflow.com/questions/28187519/do-i-need-a-write-buffer-for-socket-in-go/28204179#28204179", "title": "Do I need a write buffer for socket in go?", "body": "<p>You are actually asking two different questions here:</p>\n\n<p>1) Should you use a goroutine per accepted client connection in my TCP server?\n2) Given a []byte, how should I write to the connection?</p>\n\n<p>For 1), the answer is yes. This is the type of pattern that go is most suited for. If you take a look at the source code for the <a href=\"http://golang.org/src/net/http/server.go#L1724\" rel=\"nofollow\">net/http</a>, you will see that it spawns a goroutine for each connection.</p>\n\n<p>As for 2), you should do the same that you would do in a c/c++ server: write, check how much was written and keep on writing until your done, always checking for errors. Here is a code snippet on how to do it:</p>\n\n<pre><code>func writeConn(data []byte) error {\n    var start,c int\n    var err error\n    for {\n      if c, err = conn.Write(data[start:]); err != nil {\n          return err\n      }\n      start += c\n      if c == 0 || start == len(data) {\n          break\n      }\n    }\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 1456, "user_id": 1784595, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KoQV5.png?s=128&g=1", "display_name": "frank.lin", "link": "https://stackoverflow.com/users/1784595/frank-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2571, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1422486589, "creation_date": 1422433033, "last_edit_date": 1422434774, "question_id": 28187519, "link": "https://stackoverflow.com/questions/28187519/do-i-need-a-write-buffer-for-socket-in-go", "title": "Do I need a write buffer for socket in go?", "body": "<p>Suppose I had a Tcp server in linux, it would create a new goroutine for a new connnection. When I want to write data to the tcp connection, should I do it just like this </p>\n\n<pre><code>conn.Write(data)\n</code></pre>\n\n<p>or do it in a goroutine especially for writing, like this</p>\n\n<pre><code>func writeRoutine(sendChan chan []byte){\n      for {\n       select {\n       case  msg := &lt;- sendChan :\n          conn.Write(msg)\n       }\n      }\n}\n</code></pre>\n\n<p>just in case that the network was busy.</p>\n\n<p>In a short,  Did I need a write buffer in go just like in c/c++ when writing to a socket?</p>\n\n<p>PS   maybe I didn't exclaim the problem clearly. </p>\n\n<p>1     I talked of the server, meaning a tcp server runing in linux. It would create a new goroutine for a new connnection.  like this</p>\n\n<pre><code>   listener, err := net.ListenTCP(\"tcp\", tcpAddr)\n    if err != nil {\n        log.Error(err.Error())\n        os.Exit(-1)\n    }\n    for {\n        conn, err := listener.AcceptTCP()\n        if err != nil {\n            continue\n        }\n        log.Debug(\"Accept a new connection \", conn.RemoteAddr())\n        go handleClient(conn)\n    }\n</code></pre>\n\n<p>2  I think my problem isn't much concerned with the code. As we know, when we use <code>size_t write(int fd, const void *buf, size_t count);</code> to write a socket fd in c/c++, for a tcp server, we need a write buffer for a socket in your code necessaryly, or maybe only some of the data is writen successfully. I mean, Do I have to do so in go ?</p>\n"}, {"tags": ["scala", "go", "syntax"], "answers": [{"comments": [{"owner": {"reputation": 15571, "user_id": 210342, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7412dfe0e7374347dda68aff0c4943fa?s=128&d=identicon&r=PG", "display_name": "greenoldman", "link": "https://stackoverflow.com/users/210342/greenoldman"}, "edited": false, "score": 0, "creation_date": 1422436086, "post_id": 28187371, "comment_id": 44744786, "body": "Thank you very much for informative answer. Considering the data you provided, I am really surprised Go designers didn&#39;t take the next line into account -- it makes life easier."}], "tags": [], "owner": {"reputation": 162124, "user_id": 247533, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3698349ad0b898d398a6573f4d1f867a?s=128&d=identicon&r=PG", "display_name": "Rex Kerr", "link": "https://stackoverflow.com/users/247533/rex-kerr"}, "is_accepted": true, "score": 7, "last_activity_date": 1422432762, "last_edit_date": 1422432762, "creation_date": 1422432356, "answer_id": 28187371, "question_id": 28186733, "link": "https://stackoverflow.com/questions/28186733/what-is-a-perfomance-penalty-for-single-token-lookahead/28187371#28187371", "title": "What is a perfomance penalty for single token lookahead?", "body": "<p>The performance penalty is utterly negligible compared to everything else that the compiler has to do.  The Scala-internals mailing list has the following exchange between Haoyi Li and Martin Odersky regarding a parboiled2 parser Haoyi wrote for Scala:</p>\n\n<blockquote>\n  <p>Haoyi Li: In terms of perf[ormance], it can parse <em>everything</em> in scala/scala, lift, scalaz, scalajs, playframework and shapeless in 15 seconds.... Does anyone know how much of the time in the compiler and macros is spent parsing? My impression is that the vast vast vast majority of the time is spent in the typechecker.</p>\n  \n  <p>Odersky: Yes, parsing is pretty insignificant compared to the other tasks of a compiler ... That said, the [parser for the next-generation Scala compiler] (hand-written, 2100 lines including error reporting, accurate positions and tree construction) achieves several hundred thousand lines a second. So parboiled still has some way to go to beat that :-)</p>\n</blockquote>\n\n<p>When we're talking about hundreds of thousands of lines of code parsed per second <em>including</em> rule #2, one can infer that speed is not the issue.  Go compilation tends to clock in at <a href=\"http://ptspts.blogspot.com/2009/11/how-fast-does-8g-in-google-go-compile.html\">around 20k lines</a> per second, so even if Go parsing took zero time, and the <em>entire</em> time for Scala parsing was taken up by the one-line lookahead, it would be less than 10% of a penalty to the build process.</p>\n\n<p>In reality it should be more like 0%.  Lookahead is usually really cheap; you've already got a token stream, so you just look at the next one.</p>\n"}, {"comments": [{"owner": {"reputation": 15571, "user_id": 210342, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7412dfe0e7374347dda68aff0c4943fa?s=128&d=identicon&r=PG", "display_name": "greenoldman", "link": "https://stackoverflow.com/users/210342/greenoldman"}, "edited": false, "score": 0, "creation_date": 1422436178, "post_id": 28188222, "comment_id": 44744849, "body": "Yes, I know you can chain methods, but again Go makes again human working for computer needs. It is simply odd approach (if you ask me)."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1422435831, "creation_date": 1422435831, "answer_id": 28188222, "question_id": 28186733, "link": "https://stackoverflow.com/questions/28186733/what-is-a-perfomance-penalty-for-single-token-lookahead/28188222#28188222", "title": "What is a perfomance penalty for single token lookahead?", "body": "<p>Seems if line begins with anything but statement compiler would complain. Also you can chain methods in Go <a href=\"https://play.golang.org/p/h8NYnBXjFI\" rel=\"nofollow\">https://play.golang.org/p/h8NYnBXjFI</a></p>\n"}], "owner": {"reputation": 15571, "user_id": 210342, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7412dfe0e7374347dda68aff0c4943fa?s=128&d=identicon&r=PG", "display_name": "greenoldman", "link": "https://stackoverflow.com/users/210342/greenoldman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 28187371, "answer_count": 2, "score": 2, "last_activity_date": 1553426637, "creation_date": 1422429704, "last_edit_date": 1553426637, "question_id": 28186733, "link": "https://stackoverflow.com/questions/28186733/what-is-a-perfomance-penalty-for-single-token-lookahead", "title": "What is a perfomance penalty for single token lookahead?", "body": "<p>When comparing Go and Scala end of statement detection I found out that the rules for Scala are richer, namely:</p>\n\n<blockquote>\n  <p>A line ending is treated as a semicolon unless one of the following\n  conditions is true:</p>\n  \n  <ul>\n  <li>The line in question ends in a word that would not be legal as the end of a statement, such as a period or an infix operator.</li>\n  <li>The next line begins with a word that cannot start a statement.</li>\n  <li>The line ends while inside parentheses (...) or brackets [...], because these cannot contain multiple statements anyway.</li>\n  </ul>\n</blockquote>\n\n<p>Quoted from <a href=\"http://jittakal.blogspot.com/2012/07/scala-rules-of-semicolon-inference.html\" rel=\"nofollow noreferrer\">Scala - The rules of semicolon inference</a>.</p>\n\n<p>Rule #1 is how the Go works as well. Rule #3 too. The only difference is rule #2 &ndash; it involves single lookahead, since there is one token involved (\"word\").</p>\n\n<p>What kind of performance penalty is involved: 1% slower, 5%, 10%?</p>\n\n<p>I would love to see a comment (<strong>not the question</strong>) why Go designers left out that rule &ndash; if not for performance, it makes language more reliable, for example in method chaining:</p>\n\n<pre><code>x = some_object.select(...)\n               .sort(...)\n               .reverse(...)\n               .where(...)\n               .single()\n</code></pre>\n\n<p>If I am not mistaken for Go it is an error (you can solve it in two possible ways &ndash; taking entire statement in braces or expression in parentheses, but it is manual tweaking), Scala will take it as it should.</p>\n"}, {"tags": ["multithreading", "go", "concurrency", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "edited": false, "score": 3, "creation_date": 1422433253, "post_id": 28186656, "comment_id": 44743359, "body": "The statement <code>And since you explicitly set GOMAXPROCS to 2, you can&#39;t expect it to spawn 200 threads.</code> is incorrect.  Each blocking syscall can create a new thread."}, {"owner": {"reputation": 15564, "user_id": 6394722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/117654f31d6ad5c9b2b0e00dcf4b24f3?s=128&d=identicon&r=PG&f=1", "display_name": "atline", "link": "https://stackoverflow.com/users/6394722/atline"}, "reply_to_user": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "edited": false, "score": 0, "creation_date": 1592892492, "post_id": 28186656, "comment_id": 110579186, "body": "@NickCraig-Wood Would you please take a look for <a href=\"https://stackoverflow.com/questions/62527705/will-time-sleep-block-goroutine\">this</a>?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1422433664, "last_edit_date": 1592644375, "creation_date": 1422429415, "answer_id": 28186656, "question_id": 28186361, "link": "https://stackoverflow.com/questions/28186361/why-does-it-not-create-many-threads-when-many-goroutines-are-blocked-in-writing/28186656#28186656", "title": "Why does it not create many threads when many goroutines are blocked in writing file in golang?", "body": "<p>A goroutine is a <em>lightweight</em> thread, it is not equivalent to an operating system thread. The <a href=\"http://golang.org/ref/spec#Go_statements\" rel=\"nofollow noreferrer\">Language specification</a> specifies it as an <em>&quot;independent concurrent thread of control within the same address space&quot;</em>.</p>\n<p>Quoting from the documentation of package <a href=\"http://golang.org/pkg/runtime/\" rel=\"nofollow noreferrer\"><code>runtime</code></a>:</p>\n<blockquote>\n<p>The GOMAXPROCS variable limits the number of operating system threads that can execute user-level Go code simultaneously. There is no limit to the number of threads that can be blocked in system calls on behalf of Go code; those do not count against the GOMAXPROCS limit.</p>\n</blockquote>\n<p>Just because you start 200 goroutines, it doesn't mean 200 threads will be started for them. You set <code>GOMAXPROCS</code> to 2 which means there can be 2 &quot;active&quot; goroutines running at the same time. New threads may be spawed if a goroutine gets blocked (e.g. I/O wait). You didn't mention how big your test file is, goroutines you start might finish writing it too quickly.</p>\n<p>The <a href=\"http://golang.org/doc/effective_go.html#goroutines\" rel=\"nofollow noreferrer\">Effective Go</a> blog article defines them as:</p>\n<blockquote>\n<p>They're called <em>goroutines</em> because the existing terms\u2014threads, coroutines, processes, and so on\u2014convey inaccurate connotations. A goroutine has a simple model: it is a function executing concurrently with other goroutines in the same address space. It is lightweight, costing little more than the allocation of stack space. And the stacks start small, so they are cheap, and grow by allocating (and freeing) heap storage as required.</p>\n<p>Goroutines are multiplexed onto multiple OS threads so if one should block, such as while waiting for I/O, others continue to run. Their design hides many of the complexities of thread creation and management.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 2, "last_activity_date": 1422430138, "last_edit_date": 1495540301, "creation_date": 1422430138, "answer_id": 28186835, "question_id": 28186361, "link": "https://stackoverflow.com/questions/28186361/why-does-it-not-create-many-threads-when-many-goroutines-are-blocked-in-writing/28186835#28186835", "title": "Why does it not create many threads when many goroutines are blocked in writing file in golang?", "body": "<p>The <a href=\"https://github.com/golang/go/issues/4056\" rel=\"nofollow noreferrer\">issue 4056</a> discusses how to limit the number of actual threads (not goroutine) created.</p>\n\n<p>Go 1.2 introduced that thread limit management in <a href=\"https://github.com/golang/go/commit/665feeedcbef8a1c968d6da5be052e9fd9678380\" rel=\"nofollow noreferrer\">commit 665feee</a>.</p>\n\n<p>You can see a test to check if the number of thread created is actually reached or not in <a href=\"https://github.com/golang/go/blob/665feeedcbef8a1c968d6da5be052e9fd9678380/src/pkg/runtime/crash_test.go#L128-L134\" rel=\"nofollow noreferrer\"><code>pkg/runtime/crash_test.go#L128-L134</code></a>:</p>\n\n<pre><code>func TestThreadExhaustion(t *testing.T) {\n    output := executeTest(t, threadExhaustionSource, nil)\n    want := \"runtime: program exceeds 10-thread limit\\nfatal error: thread exhaustion\"\n    if !strings.HasPrefix(output, want) {\n        t.Fatalf(\"output does not start with %q:\\n%s\", want, output)\n    }\n}\n</code></pre>\n\n<p>That same file has an example to create an actual thread (for a given goroutine), using <a href=\"https://stackoverflow.com/q/25361831/6309\"><code>runtime.LockOSThread()</code></a>:</p>\n\n<pre><code>func testInNewThread(name string) {\n    c := make(chan bool)\n    go func() {\n        runtime.LockOSThread()\n        test(name)\n        c &lt;- true\n    }()\n    &lt;-c\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1456, "user_id": 1784595, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KoQV5.png?s=128&g=1", "display_name": "frank.lin", "link": "https://stackoverflow.com/users/1784595/frank-lin"}, "edited": false, "score": 0, "creation_date": 1422433575, "post_id": 28187522, "comment_id": 44743504, "body": "thank you, it helps me .And I made a mistake, I ran the program with <code>go run </code>  in my case."}, {"owner": {"reputation": 1183, "user_id": 386085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oCOny.jpg?s=128&g=1", "display_name": "Ionut Popa", "link": "https://stackoverflow.com/users/386085/ionut-popa"}, "reply_to_user": {"reputation": 1456, "user_id": 1784595, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KoQV5.png?s=128&g=1", "display_name": "frank.lin", "link": "https://stackoverflow.com/users/1784595/frank-lin"}, "edited": false, "score": 0, "creation_date": 1554286423, "post_id": 28187522, "comment_id": 97692403, "body": "@frank.lin what do you mean by this is there a difference in building and running the binary?"}, {"owner": {"reputation": 15564, "user_id": 6394722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/117654f31d6ad5c9b2b0e00dcf4b24f3?s=128&d=identicon&r=PG&f=1", "display_name": "atline", "link": "https://stackoverflow.com/users/6394722/atline"}, "edited": false, "score": 0, "creation_date": 1592899774, "post_id": 28187522, "comment_id": 110582436, "body": "<code>So I think the syscalls were exiting too quickly in your original test to show the effect you were expecting.</code> Does this mean even for IO operations, there still chance <code>P</code> will not detached from current <code>M</code>? Or something else which will make no new thread be produced?"}, {"owner": {"reputation": 307, "user_id": 5474221, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-DhllUtPCe88/AAAAAAAAAAI/AAAAAAAAAA8/oWjW4E8-KNE/photo.jpg?sz=128", "display_name": "Shubhang b", "link": "https://stackoverflow.com/users/5474221/shubhang-b"}, "reply_to_user": {"reputation": 15564, "user_id": 6394722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/117654f31d6ad5c9b2b0e00dcf4b24f3?s=128&d=identicon&r=PG&f=1", "display_name": "atline", "link": "https://stackoverflow.com/users/6394722/atline"}, "edited": false, "score": 0, "creation_date": 1593874301, "post_id": 28187522, "comment_id": 110932028, "body": "@atline yes you&#39;re right about the. Here is a really good article which helped me out <a href=\"https://www.ardanlabs.com/blog/2018/08/scheduling-in-go-part2.html\" rel=\"nofollow noreferrer\">ardanlabs.com/blog/2018/08/scheduling-in-go-part2.html</a>"}, {"owner": {"reputation": 307, "user_id": 5474221, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-DhllUtPCe88/AAAAAAAAAAI/AAAAAAAAAA8/oWjW4E8-KNE/photo.jpg?sz=128", "display_name": "Shubhang b", "link": "https://stackoverflow.com/users/5474221/shubhang-b"}, "edited": false, "score": 0, "creation_date": 1593874968, "post_id": 28187522, "comment_id": 110932225, "body": "Also why is there an indefinite for loop inside the goroutine? The code should produce the same output without it as well."}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": false, "score": 9, "last_activity_date": 1422433046, "creation_date": 1422433046, "answer_id": 28187522, "question_id": 28186361, "link": "https://stackoverflow.com/questions/28186361/why-does-it-not-create-many-threads-when-many-goroutines-are-blocked-in-writing/28187522#28187522", "title": "Why does it not create many threads when many goroutines are blocked in writing file in golang?", "body": "<p>I altered your program slightly to output a much bigger block</p>\n\n<pre><code>package main\n\nimport (\n    \"io/ioutil\"\n    \"os\"\n    \"runtime\"\n    \"strconv\"\n)\n\nfunc main() {\n    runtime.GOMAXPROCS(2)\n    data := make([]byte, 128*1024*1024)\n    for i := 0; i &lt; 200; i++ {\n        go func(n int) {\n            for {\n                err := ioutil.WriteFile(\"testxxx\"+strconv.Itoa(n), []byte(data), os.ModePerm)\n                if err != nil {\n                    println(err)\n                    break\n                }\n            }\n        }(i)\n    }\n    select {}\n}\n</code></pre>\n\n<p>This then shows >200 threads as you expected</p>\n\n<pre><code>$ cat /proc/17033/status | grep -i thread\nThreads:    203\n</code></pre>\n\n<p>So I think the syscalls were exiting too quickly in your original test to show the effect you were expecting.</p>\n"}], "owner": {"reputation": 1456, "user_id": 1784595, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KoQV5.png?s=128&g=1", "display_name": "frank.lin", "link": "https://stackoverflow.com/users/1784595/frank-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2783, "favorite_count": 6, "answer_count": 3, "score": 9, "last_activity_date": 1533545226, "creation_date": 1422428196, "last_edit_date": 1533545226, "question_id": 28186361, "link": "https://stackoverflow.com/questions/28186361/why-does-it-not-create-many-threads-when-many-goroutines-are-blocked-in-writing", "title": "Why does it not create many threads when many goroutines are blocked in writing file in golang?", "body": "<p>As we know in go, a thread may be created when the goroutine has to perform a blocking call, such as a system call, or a call to a C library via cgo. Some test code:</p>\n\n<pre><code>   package main\n\n   import (\n        \"io/ioutil\"\n        \"os\"\n        \"runtime\"\n        \"strconv\"\n    )\n\n    func main() {\n        runtime.GOMAXPROCS(2)\n        data, err := ioutil.ReadFile(\"./55555.log\")\n        if err != nil {\n            println(err)\n            return\n        }\n        for i := 0; i &lt; 200; i++ {\n            go func(n int) {\n                for {\n                    err := ioutil.WriteFile(\"testxxx\"+strconv.Itoa(n), []byte(data), os.ModePerm)\n                    if err != nil {\n                        println(err)\n                        break\n                    }\n                }\n            }(i)\n        }\n        select {}\n    }\n</code></pre>\n\n<p>When I run it, it didn't create many threads.</p>\n\n<pre><code>\u279c =99=[root /root]$ cat /proc/9616/status | grep -i thread\nThreads:    5\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1422619627, "post_id": 28184251, "comment_id": 44832590, "body": "Just do not use a linked list? Any reason you cannot use a slice?"}], "answers": [{"tags": [], "owner": {"reputation": 82, "user_id": 2133846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f126eb59387d563ffcf3d686b8e11f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jaehoon", "link": "https://stackoverflow.com/users/2133846/jaehoon"}, "is_accepted": false, "score": 2, "last_activity_date": 1422420365, "last_edit_date": 1422420365, "creation_date": 1422419865, "answer_id": 28184711, "question_id": 28184251, "link": "https://stackoverflow.com/questions/28184251/go-type-assertion-from-list/28184711#28184711", "title": "GO: Type assertion from list", "body": "<p>Swap a \"e.Value.(string)\" from \"e.Value\".</p>\n"}, {"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 5, "last_activity_date": 1422420528, "creation_date": 1422420528, "answer_id": 28184823, "question_id": 28184251, "link": "https://stackoverflow.com/questions/28184251/go-type-assertion-from-list/28184823#28184823", "title": "GO: Type assertion from list", "body": "<p>Since Go's linked list implementation uses an empty <code>interface{}</code> to store the values in the list, you have to you use <a href=\"https://golang.org/ref/spec#Type_assertions\">type assertion</a> like the error indicates to access your value.</p>\n\n<p>So if you store a <code>string</code> in the list, when you retrieve the value from the list you have to type assert that the value is a string. </p>\n\n<pre><code>for e := l.Front(); e != nil; e = e.Next() {\n    if(strings.EqualFold(\"[the]\", e.Value.(string))){\n        count++\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 469, "user_id": 3398752, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/631583589/picture?type=large", "display_name": "shivram", "link": "https://stackoverflow.com/users/3398752/shivram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "accepted_answer_id": 28184823, "answer_count": 2, "score": 0, "last_activity_date": 1422433104, "creation_date": 1422416524, "last_edit_date": 1422433104, "question_id": 28184251, "link": "https://stackoverflow.com/questions/28184251/go-type-assertion-from-list", "title": "GO: Type assertion from list", "body": "<p>I have stored a set of strings in a list. I iterate through the list to compare with the string <code>\"[the]\"</code>. </p>\n\n<p>When I use the function <code>strings.EqualFold</code>, it presents this error:</p>\n\n<blockquote>\n  <p>Cannot use e.Value (type interface {}) as type string in function argument: need type assertion</p>\n</blockquote>\n\n<p>The code is as follows:</p>\n\n<pre><code>for e := l.Front(); e != nil; e = e.Next() {\n        if(strings.EqualFold(\"[the]\", e.Value)){\n            count++\n\n        }\n    }\n</code></pre>\n"}, {"tags": ["go", "syntax", "lexer"], "answers": [{"tags": [], "owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "is_accepted": true, "score": 5, "last_activity_date": 1422393454, "creation_date": 1422393454, "answer_id": 28180177, "question_id": 28179995, "link": "https://stackoverflow.com/questions/28179995/how-end-of-the-statement-is-detected/28180177#28180177", "title": "How end of the statement is detected?", "body": "<p>You can look in the language specification:</p>\n\n<blockquote>\n  <p>The formal grammar uses semicolons \";\" as terminators in a number of\n  productions. Go programs may omit most of these semicolons using the\n  following two rules:</p>\n  \n  <p>When the input is broken into tokens, a semicolon is automatically\n  inserted into the token stream at the end of a non-blank line if the\n  line's final token is</p>\n  \n  <ul>\n  <li>an identifier</li>\n  <li>an integer, floating-point, imaginary, rune, or string literal</li>\n  <li>one of the keywords break, continue, fallthrough, or return</li>\n  <li>one of the operators and delimiters ++, --, ), ], or }</li>\n  </ul>\n  \n  <p>To allow complex statements to occupy a single line, a semicolon may\n  be omitted before a closing \")\" or \"}\".</p>\n</blockquote>\n\n<p><a href=\"http://golang.org/ref/spec#Semicolons\">http://golang.org/ref/spec#Semicolons</a></p>\n"}, {"tags": [], "owner": {"reputation": 11326, "user_id": 2328763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849491de0be9b3cdf39c96b4c6b32e2b?s=128&d=identicon&r=PG", "display_name": "Alper", "link": "https://stackoverflow.com/users/2328763/alper"}, "is_accepted": false, "score": 2, "last_activity_date": 1422397050, "creation_date": 1422397050, "answer_id": 28181097, "question_id": 28179995, "link": "https://stackoverflow.com/questions/28179995/how-end-of-the-statement-is-detected/28181097#28181097", "title": "How end of the statement is detected?", "body": "<p>Go parser recognizes the sentence structures (e.g., statements, expressions) according to the Go grammar. Parser uses tokens produced by the scanner (lexical analyzer). </p>\n\n<p>Semicolon is automatically inserted into the token stream by scanner, therefore, there is no extra workload for parser. The semicolon insertion code can be found <a href=\"https://github.com/golang/go/blob/master/src/go/scanner/scanner.go\" rel=\"nofollow\">here</a> in Go scanner.</p>\n\n<p>Go language specification defines how the scanner inserts semicolon as follow;</p>\n\n<blockquote>\n  <p><strong><a href=\"http://golang.org/ref/spec#Semicolons\" rel=\"nofollow\">Semicolons</a></strong></p>\n  \n  <p>The formal grammar uses semicolons \";\" as terminators in a number of\n  productions. Go programs may omit most of these semicolons using the\n  following two rules:</p>\n  \n  <ol>\n  <li><p>When the input is broken into tokens, a semicolon is automatically inserted into the token stream at the end of a non-blank line if the\n  line's final token is </p>\n  \n  <ul>\n  <li>an identifier</li>\n  <li>an integer, floating-point, imaginary, rune, or string literal</li>\n  <li>one of the keywords break, continue, fallthrough, or return</li>\n  <li>one of the operators and delimiters ++, --, ), ], or }</li>\n  </ul></li>\n  <li><p>To allow complex statements to occupy a single line, a semicolon may be omitted before a closing \")\" or \"}\".</p></li>\n  </ol>\n</blockquote>\n"}], "owner": {"reputation": 15571, "user_id": 210342, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7412dfe0e7374347dda68aff0c4943fa?s=128&d=identicon&r=PG", "display_name": "greenoldman", "link": "https://stackoverflow.com/users/210342/greenoldman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 28180177, "answer_count": 2, "score": 1, "last_activity_date": 1553426779, "creation_date": 1422392780, "last_edit_date": 1553426779, "question_id": 28179995, "link": "https://stackoverflow.com/questions/28179995/how-end-of-the-statement-is-detected", "title": "How end of the statement is detected?", "body": "<p><em>I don't know Go, I am just studying various languages syntax.</em></p>\n\n<p>From Go FAQ: \"Go borrows a trick from BCPL: the semicolons that separate statements are in the formal grammar but are injected automatically, without lookahead, by the lexer at the end of any line that could be the end of a statement.\"</p>\n\n<p>I wonder how it is done, I took a look at <code>lex.go</code> but maybe I don't know Go enough (very little actually) but I didn't find any reference to \"statement\" or \"semicolon\".</p>\n\n<p>So &ndash; how can you detect at lexer stage end of the valid statement without even lookahead?</p>\n"}, {"tags": ["go", "redis", "config"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1422384087, "post_id": 28176981, "comment_id": 44724488, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/16465705/how-to-handle-configuration-in-go\">How to handle configuration in Go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "edited": false, "score": 0, "creation_date": 1422382117, "post_id": 28177094, "comment_id": 44723310, "body": "Your viper link is broken, but that library looks pretty cool. +1 for sharing"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "edited": false, "score": 1, "creation_date": 1422382157, "post_id": 28177094, "comment_id": 44723333, "body": "@Lander I fixed link."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 7, "last_activity_date": 1513141429, "last_edit_date": 1513141429, "creation_date": 1422381958, "answer_id": 28177094, "question_id": 28176981, "link": "https://stackoverflow.com/questions/28176981/how-to-make-config-file-in-golang-elegantly/28177094#28177094", "title": "How to make config file in golang elegantly?", "body": "<p>It depends on the file format you want to support for those configs.</p>\n\n<p>One library able to read most of those format (from a simple ini file to a JSON one) would be <a href=\"https://github.com/spf13/viper\" rel=\"nofollow noreferrer\"><strong>spf13/viper</strong></a>:</p>\n\n<blockquote>\n  <p>Viper is a complete configuration solution for go applications. It has been designed to work within an application to handle all types of configuration. It supports</p>\n  \n  <ul>\n  <li>setting defaults</li>\n  <li>reading from yaml, toml and json config files</li>\n  <li>reading from environment variables</li>\n  <li>reading from remote config systems (Etcd or Consul)</li>\n  <li>reading from command line flags</li>\n  <li>setting explicit values</li>\n  </ul>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1422383402, "creation_date": 1422383402, "answer_id": 28177507, "question_id": 28176981, "link": "https://stackoverflow.com/questions/28176981/how-to-make-config-file-in-golang-elegantly/28177507#28177507", "title": "How to make config file in golang elegantly?", "body": "<p>As redis config file has very simple structure I'd suggest you to look at encoding/csv package with Reader.Comma delimiter set just to blank space. It allow you to both read, parse and write configuration easily. Seems to me \"slaveof {{.Host}} {{.Port}}\" as template looks not very handy. But it's sure correct approach. Just  matter of taste.</p>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1422391932, "post_id": 28179633, "comment_id": 44728592, "body": "Nice use of template. +1"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1422392088, "last_edit_date": 1422392088, "creation_date": 1422391433, "answer_id": 28179633, "question_id": 28176981, "link": "https://stackoverflow.com/questions/28176981/how-to-make-config-file-in-golang-elegantly/28179633#28179633", "title": "How to make config file in golang elegantly?", "body": "<p><a href=\"http://redis.io/topics/config\" rel=\"nofollow\">Redis configuration files</a> have a simple text format. You can generate a configuration file using the fmt package:</p>\n\n<pre><code>fmt.Fprintf(w, \"pidfile %s\\n\", pidFile)\nfmt.Fprintf(w, \"port %d\\n\", port)\n</code></pre>\n\n<p>where <code>w</code> is <code>io.Writer</code> for the output.</p>\n\n<p>The text/template package is also a viable option. Given the template</p>\n\n<pre><code>pidfile {{.PidFile}}\nport {{.Port}}\n</code></pre>\n\n<p>you can execute it with</p>\n\n<pre><code>t.Execute(w, map[string]interface{}{\n   \"PidFile\": pidFile,\n   \"Port\": port,\n})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": false, "score": -1, "last_activity_date": 1422411795, "creation_date": 1422411795, "answer_id": 28183562, "question_id": 28176981, "link": "https://stackoverflow.com/questions/28176981/how-to-make-config-file-in-golang-elegantly/28183562#28183562", "title": "How to make config file in golang elegantly?", "body": "<p>I would suggest to use some configuration library. I like <a href=\"http://spf13.com/project/viper\" rel=\"nofollow\">Viper</a> for is completeness. </p>\n"}, {"tags": [], "owner": {"reputation": 134, "user_id": 4098847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd49d43c52289efda3178fc27039c54?s=128&d=identicon&r=PG", "display_name": "Rem&#39;s", "link": "https://stackoverflow.com/users/4098847/rems"}, "is_accepted": false, "score": 0, "last_activity_date": 1532684460, "last_edit_date": 1532684460, "creation_date": 1532683533, "answer_id": 51554862, "question_id": 28176981, "link": "https://stackoverflow.com/questions/28176981/how-to-make-config-file-in-golang-elegantly/51554862#51554862", "title": "How to make config file in golang elegantly?", "body": "<p>If you want to make a config file for development, testing, staging and production, I would recommend to use the <code>// +build</code> possibility offered by Go.</p>\n\n<hr>\n\n<h2>Set up your Go program</h2>\n\n<p>You create 4 files in a <code>config</code> packages as followed :</p>\n\n<pre><code>src/program/config\n               |\n               |--config_dev.go\n               |--config_test.go\n               |--config_staging.go\n               |--config_prod.go\n</code></pre>\n\n<hr>\n\n<h2>In the config files</h2>\n\n<p>Then in each file, you define the tag used to use that file during the <code>go build</code> (or run, ...) process.</p>\n\n<p>It means for instance in <em>config_dev.go</em> :</p>\n\n<pre><code>// +build dev\n\npackage config\n\n// Development ready configuration const based on the build tags.\nconst (\n    MYSETTINGS = \"dev blablabla\"\n    ISREADY    = false\n)\n</code></pre>\n\n<p>In the <em>config_test.go</em>, that would look like : </p>\n\n<pre><code>// +build test\n\npackage config\n\n// Development ready configuration const based on the build tags.\nconst (\n    MYSETTINGS = \"test blablabla\"\n    ISREADY    = true\n)\n</code></pre>\n\n<hr>\n\n<p>Note the <code>// +build dev</code> and <code>// +build test</code>. </p>\n\n<p>That are the tags you are going to use during build to tell which config file you want to use.</p>\n\n<p>In any other Go file, you just have to call <code>config.ISREADY</code> without importing anything else that <code>\"config\"</code> in your file.</p>\n\n<hr>\n\n<h2>Build</h2>\n\n<p>Then to build your app, you just have to run :</p>\n\n<p><code>go build -tags dev</code> to build with the <em>development config</em></p>\n\n<p>or</p>\n\n<p><code>go build -tags test</code> to build with the <em>testing config</em>.</p>\n"}], "owner": {"reputation": 637, "user_id": 1646577, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb397bc4b574eee54f603a0ad6d7b002?s=128&d=identicon&r=PG", "display_name": "Shanicky_C", "link": "https://stackoverflow.com/users/1646577/shanicky-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7555, "favorite_count": 2, "accepted_answer_id": 28179633, "answer_count": 5, "score": 6, "last_activity_date": 1532684460, "creation_date": 1422381603, "last_edit_date": 1422384334, "question_id": 28176981, "link": "https://stackoverflow.com/questions/28176981/how-to-make-config-file-in-golang-elegantly", "title": "How to make config file in golang elegantly?", "body": "<p>I'm a newbie with go lang, \nI just want to write a program to manager my redis instances so that i can create a redis with specific config file, but I don't know how to create the config file for redis instances elegantly. </p>\n\n<p>I found \"text/template\" before, is that a good idea?</p>\n\n<p>Thanks a lot</p>\n"}, {"tags": ["go", "append", "slice", "capacity"], "comments": [{"owner": {"reputation": 171, "user_id": 982285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2788481a6b5033b81f5299bf41c3b712?s=128&d=identicon&r=PG", "display_name": "dutchie", "link": "https://stackoverflow.com/users/982285/dutchie"}, "edited": false, "score": 0, "creation_date": 1422379510, "post_id": 28176059, "comment_id": 44721791, "body": "Note you <i>don&#39;t</i> have to set it in make. There is a <a href=\"http://golang.org/ref/spec#Making_slices_maps_and_channels\" rel=\"nofollow noreferrer\">two-argument form</a> <code>make([]T, n)</code> to give you a slice of T of length n."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 11, "last_activity_date": 1422383661, "last_edit_date": 1422383661, "creation_date": 1422379300, "answer_id": 28176246, "question_id": 28176059, "link": "https://stackoverflow.com/questions/28176059/slices-in-go-why-does-it-allow-appending-more-than-the-capacity-allows/28176246#28176246", "title": "Slices in Go: why does it allow appending more than the capacity allows?", "body": "<p>The builtin <a href=\"http://golang.org/pkg/builtin/#append\" rel=\"noreferrer\"><code>append()</code></a> function uses the specified slice to append elements to <em>if</em> it has a big enough capacity to accomodate the specified elements.</p>\n\n<p>But if the passed slice is not big enough, it <em>allocates a new, big enough slice</em>, copies the elements from the passed slice to the new slice and append the elements to that new slice. And returns this new slice. Quoting from the <code>append()</code> documentation:</p>\n\n<blockquote>\n  <p>The append built-in function appends elements to the end of a slice. If it has sufficient capacity, the destination is resliced to accommodate the new elements. If it does not, a new underlying array will be allocated. Append returns the updated slice. It is therefore necessary to store the result of append, often in the variable holding the slice itself:</p>\n</blockquote>\n\n<p>When making a slice with <code>make</code> if the length and capacity are the same, the capacity can be omitted, in which case it is defaulted to the specified length:</p>\n\n<pre><code>// These 2 declarations are equivalent:\ns := make([]int, 2, 2)\ns := make([]int, 2)\n</code></pre>\n\n<p>Also note that <code>append()</code> appends elements after the last element of the slice. And the above slices already have <code>len(s) == 2</code> right after declaration so if you append even just 1 element to it, it will cause a reallocation as seen in this example:</p>\n\n<pre><code>s := make([]int, 2, 2)\nfmt.Println(s, len(s), cap(s))\ns = append(s, 1)\nfmt.Println(s, len(s), cap(s))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[0 0] 2 2\n[0 0 1] 3 4\n</code></pre>\n\n<p>So in your example what you should do is something like this:</p>\n\n<pre><code>s := make([]int, 0, 10) // Create a slice with length=0 and capacity=10\nfmt.Println(s, len(s), cap(s))\ns = append(s, 1)\nfmt.Println(s, len(s), cap(s))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[] 0 10\n[1] 1 10\n</code></pre>\n\n<p>I recommend the following blog articles if you want to understand slices in more details:</p>\n\n<p><a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"noreferrer\"><strong>Go Slices: usage and internals</strong></a></p>\n\n<p><a href=\"http://blog.golang.org/slices\" rel=\"noreferrer\"><strong>Arrays, slices (and strings): The mechanics of 'append'</strong></a></p>\n"}, {"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 3, "last_activity_date": 1422379497, "creation_date": 1422379497, "answer_id": 28176308, "question_id": 28176059, "link": "https://stackoverflow.com/questions/28176059/slices-in-go-why-does-it-allow-appending-more-than-the-capacity-allows/28176308#28176308", "title": "Slices in Go: why does it allow appending more than the capacity allows?", "body": "<p>It is mainly an optimization, and it is not unique to go, similar structures in other languages have this as well. </p>\n\n<p>When you append more than the capacity, the runtime needs to allocate more memory for the new elements. This is costly and can also cause memory fragmentation.</p>\n\n<p>By specifying the capacity, the runtime allocates what is needed in advance, and avoids reallocations. However if you do not know the estimated capacity in advance or it changes, you do not have to set it, and the runtime reallocates what is needed and grows the capacity itself. </p>\n"}], "owner": {"reputation": 15341, "user_id": 2228325, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Vn6At.png?s=128&g=1", "display_name": "TonyGW", "link": "https://stackoverflow.com/users/2228325/tonygw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1261, "favorite_count": 0, "accepted_answer_id": 28176246, "answer_count": 2, "score": 1, "last_activity_date": 1422383661, "creation_date": 1422378703, "question_id": 28176059, "link": "https://stackoverflow.com/questions/28176059/slices-in-go-why-does-it-allow-appending-more-than-the-capacity-allows", "title": "Slices in Go: why does it allow appending more than the capacity allows?", "body": "<p>The <strong>capacity</strong> parameter in making a <code>slice</code> in Go does not make much sense to me. For example, </p>\n\n<pre><code>aSlice := make([]int, 2, 2) //a new slice with length and cap both set to 2\naSlice = append(aSlice, 1, 2, 3, 4, 5) //append integers 1 through 5\nfmt.Println(\"aSlice is: \", aSlice)  //output [0, 0, 1, 2, 3, 4, 5]\n</code></pre>\n\n<p>If the slice allows inserting more elements than the capacity allows, why do we need to set it in the make() function?</p>\n"}, {"tags": ["jquery", "go", "beego", "jquery-ajaxq"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1422378190, "post_id": 28175800, "comment_id": 44720901, "body": "Check out the <a href=\"http://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\"><code>encoding&#47;json</code></a> package from the standard library."}], "answers": [{"tags": [], "owner": {"reputation": 1847, "user_id": 391464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1XdRz.png?s=128&g=1", "display_name": "yee", "link": "https://stackoverflow.com/users/391464/yee"}, "is_accepted": false, "score": 2, "last_activity_date": 1422416489, "creation_date": 1422416489, "answer_id": 28184244, "question_id": 28175800, "link": "https://stackoverflow.com/questions/28175800/returning-json-object-in-beego/28184244#28184244", "title": "Returning JSON object in beego", "body": "<p>Beego controller has a ServeJson() func, have a look at <a href=\"http://beego.me/docs/mvc/controller/jsonxml.md\" rel=\"nofollow\">it</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6158875, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QJZBr3MIWzw/AAAAAAAAAAI/AAAAAAAAADI/6lbdrjS3KSc/photo.jpg?sz=128", "display_name": "Patrick Mark Mazo", "link": "https://stackoverflow.com/users/6158875/patrick-mark-mazo"}, "is_accepted": false, "score": 0, "last_activity_date": 1469696968, "creation_date": 1469696968, "answer_id": 38631866, "question_id": 28175800, "link": "https://stackoverflow.com/questions/28175800/returning-json-object-in-beego/38631866#38631866", "title": "Returning JSON object in beego", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>type Data struct {\r\n    //Values that equivalent to your ajax post\r\n    Data string\r\n    Id   int\r\n    Name string\r\n}\r\nvar data Data\r\nreq := this.Ctx.Request\r\ndec\t:= json.NewDecoder(req.Body)\r\nerr := dec.Decode(&amp;data)\r\nif err == nil {\r\n\r\n    this.Data[\"JSON\"] = &amp;data\r\n    this.ServeJSON()\r\n\r\n}\r\n\r\nDont forget to import encoding/json</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 11, "user_id": 4414018, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000148809896/picture?type=large", "display_name": "lkb", "link": "https://stackoverflow.com/users/4414018/lkb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1792, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1541094233, "creation_date": 1422377795, "question_id": 28175800, "link": "https://stackoverflow.com/questions/28175800/returning-json-object-in-beego", "title": "Returning JSON object in beego", "body": "<p>I am using beego (golang framework) and I am trying to use jquery ajax to update my web pages after the go function finishes. However I am stocked at returning JSON object so that the jquery could handle it in its success function. Is there any way to return JSON in golang or beego and how? Thanks.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2703, "user_id": 2049333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3de211d5b26ab932c16ab465d1791018?s=128&d=identicon&r=PG", "display_name": "mschuett", "link": "https://stackoverflow.com/users/2049333/mschuett"}, "edited": false, "score": 0, "creation_date": 1422384799, "post_id": 28175214, "comment_id": 44724853, "body": "What do you mean it doesn&#39;t implement the io.Reader interface? <a href=\"http://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\">golang.org/pkg/io/#Reader</a>. Isn&#39;t declaring that method satisfying the io.Reader interface?"}, {"owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "reply_to_user": {"reputation": 2703, "user_id": 2049333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3de211d5b26ab932c16ab465d1791018?s=128&d=identicon&r=PG", "display_name": "mschuett", "link": "https://stackoverflow.com/users/2049333/mschuett"}, "edited": false, "score": 1, "creation_date": 1422388335, "post_id": 28175214, "comment_id": 44726734, "body": "I said &quot;does&quot; implement, not &quot;doesn&#39;t&quot;. But I&#39;m not sure I understood your question though... You said &quot;as far as I can tell is never implemented&quot;."}, {"owner": {"reputation": 2703, "user_id": 2049333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3de211d5b26ab932c16ab465d1791018?s=128&d=identicon&r=PG", "display_name": "mschuett", "link": "https://stackoverflow.com/users/2049333/mschuett"}, "edited": false, "score": 0, "creation_date": 1422389561, "post_id": 28175214, "comment_id": 44727348, "body": "Sorry my bad. I think i have been looking over this stuff too long my eyes are bugging out."}], "tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": true, "score": 10, "last_activity_date": 1422376039, "creation_date": 1422376039, "answer_id": 28175214, "question_id": 28174970, "link": "https://stackoverflow.com/questions/28174970/implementing-reader-interface/28175214#28175214", "title": "Implementing Reader interface", "body": "<p>You pass <code>Read</code> the byte slice. <code>Read</code> is supposed to put bytes in it. As slices are just references to arrays, changing the contents of a slice changes the underlying array, so the caller of <code>Read</code> can then just check the slice it has passed to it.</p>\n\n<p><code>ioutil.ReadAll</code> creates a buffer and calls <code>ReadFrom</code> on it. <code>ReadFrom</code> calls <code>Read</code> repeatedly, increasing the size of the buffer until <code>Read</code> tells it has been exhausted by returning <code>io.EOF</code> as error. <a href=\"https://golang.org/src/bytes/buffer.go#L150\">See for yourself</a>.</p>\n\n<p>The answer you link does implement the <code>io.Reader</code> interface. It is declaring a method <code>Read(p []byte) (n int, e error)</code>. That's all what is needed.</p>\n"}, {"comments": [{"owner": {"reputation": 2703, "user_id": 2049333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3de211d5b26ab932c16ab465d1791018?s=128&d=identicon&r=PG", "display_name": "mschuett", "link": "https://stackoverflow.com/users/2049333/mschuett"}, "edited": false, "score": 0, "creation_date": 1422480652, "post_id": 28202063, "comment_id": 44771640, "body": "Awesome thank you. I will update my answer so others don&#39;t implement this poorly."}], "tags": [], "owner": {"reputation": 389, "user_id": 3385070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pU0nE.jpg?s=128&g=1", "display_name": "tez", "link": "https://stackoverflow.com/users/3385070/tez"}, "is_accepted": false, "score": 1, "last_activity_date": 1422637445, "last_edit_date": 1422637445, "creation_date": 1422477901, "answer_id": 28202063, "question_id": 28174970, "link": "https://stackoverflow.com/questions/28174970/implementing-reader-interface/28202063#28202063", "title": "Implementing Reader interface", "body": "<p>Just to note, your implementation of <code>Read()</code> method here (<a href=\"http://play.golang.org/p/ejpUVOx8jR\" rel=\"nofollow\">http://play.golang.org/p/ejpUVOx8jR</a>) is incorrect. You do not account for a capacity of the provided <code>p []byte</code> argument. You'll get an \"index out of range\" panic if it is smaller than your test string (ex: <a href=\"http://play.golang.org/p/DhcY0hJ0c0\" rel=\"nofollow\">http://play.golang.org/p/DhcY0hJ0c0</a>). </p>\n\n<p>You might consider a different approach such as this - <a href=\"http://play.golang.org/p/t4Zg8TnF33\" rel=\"nofollow\">http://play.golang.org/p/t4Zg8TnF33</a>.</p>\n\n<p><strong>UPDATE</strong>\nI noticed a memory leak in my implementation. The fixed version is here - <a href=\"http://play.golang.org/p/9BbS54d8pb\" rel=\"nofollow\">http://play.golang.org/p/9BbS54d8pb</a>. This goes to show that even a trivial code sometimes is not so trivial :)</p>\n"}, {"tags": [], "owner": {"reputation": 693, "user_id": 2234529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/886677e5f1d6ec29e5ae93e480f7a37b?s=128&d=identicon&r=PG", "display_name": "clangager", "link": "https://stackoverflow.com/users/2234529/clangager"}, "is_accepted": false, "score": 4, "last_activity_date": 1479336631, "creation_date": 1479336631, "answer_id": 40643767, "question_id": 28174970, "link": "https://stackoverflow.com/questions/28174970/implementing-reader-interface/40643767#40643767", "title": "Implementing Reader interface", "body": "<p>The updated answer provided by tez totally works, but here is an alternative that I think is a bit cleaner utilizing Go's <code>copy</code>:</p>\n\n<pre><code>type Reader struct {\n    data []byte\n    readIndex int64\n}\n\nfunc (r *Reader) Read(p []byte) (n int, err error) {\n    if r.readIndex &gt;= int64(len(r.data)) {\n        err = io.EOF\n        return\n    }\n\n    n = copy(p, r.data[r.readIndex:])\n    r.readIndex += int64(n)\n    return\n}\n</code></pre>\n\n<p>By using <code>copy</code>, you don't have to worry about overflowing <code>p []byte</code>.  This also doesn't drain/destroy any state that you have on your reader, instead it just iterates over it with <code>readIndex</code>.</p>\n\n<p>Full example here: <a href=\"https://play.golang.org/p/8QTECCkies\" rel=\"nofollow noreferrer\">https://play.golang.org/p/8QTECCkies</a></p>\n\n<p>This strategy can be seen in some of Go's core packages (ie. <a href=\"https://golang.org/src/strings/reader.go\" rel=\"nofollow noreferrer\">https://golang.org/src/strings/reader.go</a>)</p>\n"}], "owner": {"reputation": 2703, "user_id": 2049333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3de211d5b26ab932c16ab465d1791018?s=128&d=identicon&r=PG", "display_name": "mschuett", "link": "https://stackoverflow.com/users/2049333/mschuett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11039, "favorite_count": 3, "accepted_answer_id": 28175214, "answer_count": 3, "score": 7, "last_activity_date": 1479336631, "creation_date": 1422375273, "last_edit_date": 1495541856, "question_id": 28174970, "link": "https://stackoverflow.com/questions/28174970/implementing-reader-interface", "title": "Implementing Reader interface", "body": "<p>I understand the general concept of Go's interfaces. However, I was recently looking into implementing the <code>io.Reader</code> interface, and it has me confused. I found this post which didn't help to much.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/25526790/reader-interface-and-the-read-method-in-golang\">Reader interface and the Read method in golang</a></p>\n\n<p>To start with, the accepted answer is using <code>io.Reader</code>'s <code>Read</code> function, which as far as I can tell is never implemented. Second, how does the <code>Read</code> function work in the context of something like <code>ioutil.ReadAll</code>. It takes something that implemented the <code>io.Reader</code> interface and returns a slice of bytes. I don't understand how something that is returning only an <code>int</code> and <code>err</code> can be processed into a slice of bytes.</p>\n\n<p>Edit:</p>\n\n<p>I was helped in the go-nuts IRC channel and this was the provided answer as to how you would likely actually implement one <a href=\"http://play.golang.org/p/ejpUVOx8jR\" rel=\"nofollow noreferrer\">http://play.golang.org/p/ejpUVOx8jR</a>. Much thanks to the go community.</p>\n\n<p>Edit 2:</p>\n\n<p>as pointed out below the implementation above will fail in the case where the strign is larger than the buffer. This is a more sane implementation <a href=\"http://play.golang.org/p/t4Zg8TnF33\" rel=\"nofollow noreferrer\">http://play.golang.org/p/t4Zg8TnF33</a>.</p>\n"}, {"tags": ["go", "deferred", "idioms", "scoped-lock"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1422363162, "post_id": 28170234, "comment_id": 44711199, "body": "I can&#39;t think of a shorter way to do it. The &quot;idiomatic&quot; way is to explicitly call <code>lock()</code> and then <code>defer unlock()</code>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1422371128, "post_id": 28170234, "comment_id": 44716203, "body": "This approach is used in the <a href=\"https://golang.org/doc/effective_go.html#defer\" rel=\"nofollow noreferrer\">Effective Go trace example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 2, "creation_date": 1422363230, "post_id": 28170992, "comment_id": 44711240, "body": "This is indeed the idiomatic way (god I&#39;m beginning to hate all this idiomatic nonsense), but the pattern proposed by OP is rather nice IMO."}, {"owner": {"reputation": 328, "user_id": 1176300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5382d5f3db26dfdd3d2a82db6dc99fc2?s=128&d=identicon&r=PG", "display_name": "Kokos", "link": "https://stackoverflow.com/users/1176300/kokos"}, "edited": false, "score": 0, "creation_date": 1422363995, "post_id": 28170992, "comment_id": 44711696, "body": "&#39;Logging engine&#39; is best when you must type just one line - with more there is increasing chance that users abaddon logging in some small functions."}, {"owner": {"reputation": 328, "user_id": 1176300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5382d5f3db26dfdd3d2a82db6dc99fc2?s=128&d=identicon&r=PG", "display_name": "Kokos", "link": "https://stackoverflow.com/users/1176300/kokos"}, "edited": false, "score": 0, "creation_date": 1422364212, "post_id": 28170992, "comment_id": 44711812, "body": "There is also possibility to use bad variable (<i>i</i> instead of <i>j</i>) or type different strings in our example logger (which may cause confusion in log analysis tools)."}], "tags": [], "owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "is_accepted": true, "score": 3, "last_activity_date": 1422363149, "creation_date": 1422363149, "answer_id": 28170992, "question_id": 28170234, "link": "https://stackoverflow.com/questions/28170234/is-there-idiomatic-scoped-semantics-in-golang/28170992#28170992", "title": "Is there idiomatic scoped semantics in golang?", "body": "<p>I do not believe there is an idiomatic way to do this. I'm not sure why you'd want to either, is it really so bad to write</p>\n\n<pre><code>m.Lock()\ndefer m.Unlock()\n</code></pre>\n\n<p>?</p>\n"}, {"comments": [{"owner": {"reputation": 328, "user_id": 1176300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5382d5f3db26dfdd3d2a82db6dc99fc2?s=128&d=identicon&r=PG", "display_name": "Kokos", "link": "https://stackoverflow.com/users/1176300/kokos"}, "edited": false, "score": 0, "creation_date": 1617835818, "post_id": 28171214, "comment_id": 118422258, "body": "Looking on it after half a decade, it looks slightly better than accepted answer, mostly because it uses simpler concepts.  I would only change return type of <code>start()</code>/argument of <code>end()</code> to some custom type, to enforce that user will not forget to call <code>start()</code> (it still could omit <code>end()</code> but it is perhaps less likely."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 5, "last_activity_date": 1422372559, "last_edit_date": 1422372559, "creation_date": 1422363837, "answer_id": 28171214, "question_id": 28170234, "link": "https://stackoverflow.com/questions/28170234/is-there-idiomatic-scoped-semantics-in-golang/28171214#28171214", "title": "Is there idiomatic scoped semantics in golang?", "body": "<p>Your proposed solution is already nice. You return a value of <code>func</code> type which you also have to call at the end of the <code>defer</code>. </p>\n\n<p>You can avoid that (returning a <code>func</code> value), but there have to be 2 function calls, one that logs the <em>start</em> event and another one that logs the <em>end</em> event.</p>\n\n<p>The alternative is to make a function call which produces the parameter value of the function that is deferred (rather than returning a function) which is evaluated with the <code>defer</code> statement, and this way it still can remain one line.</p>\n\n<p>You can also try it on the <a href=\"http://play.golang.org/p/TPouOCOWxU\" rel=\"nofollow\">Go Playground</a>:</p>\n\n<pre><code>func start(s string) string {\n    fmt.Println(\"Started\", s)\n    return s\n}\n\nfunc end(name string) {\n    fmt.Println(\"Ended\", name)\n}\n\nfunc main() {\n    defer end(start(\"main\"))\n\n    fmt.Println(\"Doing main's work...\")\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Started main\nDoing main's work...\nEnded main\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1422366558, "creation_date": 1422366558, "answer_id": 28172075, "question_id": 28170234, "link": "https://stackoverflow.com/questions/28170234/is-there-idiomatic-scoped-semantics-in-golang/28172075#28172075", "title": "Is there idiomatic scoped semantics in golang?", "body": "<p>I think question isn't relevant to Go idiomaticity, Seems it's generally better to reason about code when function behave identically either call. To keep state I'd better make an object and define function as method on that object. Means something like</p>\n\n<pre><code>type message string\nfunc (foo message) Log(bar string){\n    if bar==nil{doSomethingSpecial()}\n    switch foo{\n        case something: doSomething()\n        ...\n        case nil: doSomethingInitial()\n        default: doDefault()\n    }   \n    log.Println(bar, \"started\")\n    foo=bar\n} \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 761, "user_id": 2345647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c511ef77481eb163a14285a3b1e1016?s=128&d=identicon&r=PG", "display_name": "Jim Wood", "link": "https://stackoverflow.com/users/2345647/jim-wood"}, "edited": false, "score": 1, "creation_date": 1584833382, "post_id": 36588384, "comment_id": 107560732, "body": "Can&#39;t believe this isn&#39;t the top answer."}, {"owner": {"reputation": 328, "user_id": 1176300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5382d5f3db26dfdd3d2a82db6dc99fc2?s=128&d=identicon&r=PG", "display_name": "Kokos", "link": "https://stackoverflow.com/users/1176300/kokos"}, "edited": false, "score": 0, "creation_date": 1617835528, "post_id": 36588384, "comment_id": 118422177, "body": "It just puts content of accepted answer in anonymous function, so this is not novel in any way"}], "tags": [], "owner": {"reputation": 59, "user_id": 221077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d37139ba77a444d500580a5a1d75580?s=128&d=identicon&r=PG", "display_name": "rtxu", "link": "https://stackoverflow.com/users/221077/rtxu"}, "is_accepted": false, "score": 5, "last_activity_date": 1460520406, "creation_date": 1460520406, "answer_id": 36588384, "question_id": 28170234, "link": "https://stackoverflow.com/questions/28170234/is-there-idiomatic-scoped-semantics-in-golang/36588384#36588384", "title": "Is there idiomatic scoped semantics in golang?", "body": "<p>Take anonymous function as a <strong>scope</strong>: </p>\n\n<pre><code>func() {\n    Entrance()\n    defer Exit()\n    // anything you want to do in this scope\n}()\n</code></pre>\n"}], "owner": {"reputation": 328, "user_id": 1176300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5382d5f3db26dfdd3d2a82db6dc99fc2?s=128&d=identicon&r=PG", "display_name": "Kokos", "link": "https://stackoverflow.com/users/1176300/kokos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2020, "favorite_count": 0, "accepted_answer_id": 28170992, "answer_count": 4, "score": 6, "last_activity_date": 1493481967, "creation_date": 1422360679, "last_edit_date": 1493481967, "question_id": 28170234, "link": "https://stackoverflow.com/questions/28170234/is-there-idiomatic-scoped-semantics-in-golang", "title": "Is there idiomatic scoped semantics in golang?", "body": "<p>I wonder if there is any idiomatic way to represent <em>scoped</em> semantics. By scoped I mean things like:</p>\n\n<ul>\n<li>scoped mutex (oneliner instead of explicit Lock + deffered Unlock),</li>\n<li>logging function (or any code block) entrance and exit,</li>\n<li>measuring execution time.</li>\n</ul>\n\n<p>Example code for first two bullets:</p>\n\n<pre><code>package main\n\nimport \"log\"\nimport \"sync\"\n\nfunc Scoped(m *sync.Mutex) func() {\n    m.Lock()\n    return func() {\n        m.Unlock()\n    }\n}\n\nfunc Log(what string) func() {\n    log.Println(what, \"started\")\n    return func() {\n        log.Println(what, \"done\")\n    }\n}\n\nfunc main() {\n    defer Log(\"testing\")()\n\n    m := &amp;sync.Mutex{} // obviously mutex should be from other source in real life\n    defer Scoped(m)()\n    // use m\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/33j-GrBWSq\" rel=\"nofollow noreferrer\">https://play.golang.org/p/33j-GrBWSq</a></p>\n\n<p>Basically we need to make one function call <em>just now</em> (eg mutex lock), and one call should be postponed to defer (eg mutex unlock). I propose just returning unnamed function here, but it can be easily named (return struct with function field).</p>\n\n<p>There is only one problem: user can forget to 'call' result of first call.</p>\n\n<p>This code is (can be) idiomatic?</p>\n"}, {"tags": ["select", "go", "channel"], "answers": [{"comments": [{"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1422353864, "post_id": 28167940, "comment_id": 44705762, "body": "But when is <code>s &lt;- n</code> evaluated? What if I want to send the current time through the channel for example."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 2, "creation_date": 1422354153, "post_id": 28167940, "comment_id": 44705974, "body": "@Timmmm It&#39;s in the <a href=\"http://golang.org/ref/spec#Select_statements\" rel=\"nofollow noreferrer\">Spec</a>. Right-hand-side expressions of send statements are evaluated exactly once, <i>upon entering the &quot;select&quot; statement.</i>"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1422353674, "creation_date": 1422353674, "answer_id": 28167940, "question_id": 28167826, "link": "https://stackoverflow.com/questions/28167826/select-on-a-go-send-and-receive-channel-at-the-same-time/28167940#28167940", "title": "Select on a go send and receive channel at the same time", "body": "<p>It's a simple select:</p>\n\n<pre><code>select {\ncase s &lt;- n:\n    // Successful send.\ncase n := &lt;- r:\n    // Successful receive. Do something with n.\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1422355089, "post_id": 28168243, "comment_id": 44706576, "body": "Yeah while the <code>Sleep(1ms)</code> solution works it seems inelegant and it will definitely keep the CPU awake. Also checking the length before sending is surely fine as long as I know I am the only sender."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1422355182, "post_id": 28168243, "comment_id": 44706624, "body": "@Timmmm Yes, using <code>Sleep</code> is not elegant, but what you try to achieve cannot be done in other ways because you want the value to be decided/calculated <i>at the time</i> the channel becomes ready. If this wouldn&#39;t be a requirement, a simple <code>select</code> would do it."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1422355324, "post_id": 28168243, "comment_id": 44706713, "body": "Also note that if the 2 channels are not related, you can just use 2 goroutines, one to send and another to receive. If a channel is not ready, the operation will simply block and not consume CPU resources."}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1422355377, "post_id": 28168243, "comment_id": 44706756, "body": "Also your solution calls <code>valueToSend()</code> every millisecond. For me it is a slightly expensive operation and should only be called when necessary. In fact my original answer with an added <code>time.Sleep()</code> is better."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1422354576, "creation_date": 1422354576, "answer_id": 28168243, "question_id": 28167826, "link": "https://stackoverflow.com/questions/28167826/select-on-a-go-send-and-receive-channel-at-the-same-time/28168243#28168243", "title": "Select on a go send and receive channel at the same time", "body": "<p>You can do this with <code>select</code> but since the value to be sent is evaluated only once, if both channel are not ready, the value to be sent would become outdated by the time it can be sent.</p>\n\n<p>So add a <code>default</code> case which will be executed if none of the channels are ready, in which you just \"sleep\" a little, then try again (with an updated new value calculated/acquired to be sent). By sleeping you will not consume CPU resources:</p>\n\n<pre><code>s := make(chan&lt;- int, 5)\nr := make(&lt;-chan int)\n\nfor {\n    v := valueToSend() // Evaluated each time we try to send\n    select {\n    case s &lt;- v:\n        fmt.Println(\"Sent value:\", v)\n    case vr := &lt;-r:\n        fmt.Println(\"Received:\", vr)\n    default: // If none are ready currently, we end up here\n        time.Sleep(time.Millisecond * 1)\n    }\n}\n</code></pre>\n\n<p><strong>Note</strong> that checking the length or capacity of a channel <em>and then sending/receiving</em> is not considered a good solution because the channel might become not ready between the time you check its length/cap and you try to send/receive, as illustrated below:</p>\n\n<pre><code>if len(r) &gt; 0 {\n    // r is ready to receive\n\n    // Optional other code here,\n    // meanwhile another goroutine might receive the value from r!\n\n    r &lt;-  // If other goroutine received from r, this will block!\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "is_accepted": false, "score": 0, "last_activity_date": 1422362894, "creation_date": 1422362894, "answer_id": 28170905, "question_id": 28167826, "link": "https://stackoverflow.com/questions/28167826/select-on-a-go-send-and-receive-channel-at-the-same-time/28170905#28170905", "title": "Select on a go send and receive channel at the same time", "body": "<blockquote>\n  <p>Can I block until a channel is ready-to-send, without sending anything?</p>\n</blockquote>\n\n<p>Not with primitive go channels. You could probably manage to pull something together using the <code>SharedBuffer</code> type in my channels library, but even that is complicated and it uses a great deal of reflection under the covers.</p>\n\n<p><a href=\"https://godoc.org/github.com/eapache/channels#SharedBuffer\" rel=\"nofollow\">https://godoc.org/github.com/eapache/channels#SharedBuffer</a></p>\n"}, {"tags": [], "owner": {"reputation": 208, "user_id": 4123716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcb43fc8e331b08706c439643b56e390?s=128&d=identicon&r=PG", "display_name": "Dustin", "link": "https://stackoverflow.com/users/4123716/dustin"}, "is_accepted": false, "score": 1, "last_activity_date": 1422413896, "creation_date": 1422413896, "answer_id": 28183853, "question_id": 28167826, "link": "https://stackoverflow.com/questions/28167826/select-on-a-go-send-and-receive-channel-at-the-same-time/28183853#28183853", "title": "Select on a go send and receive channel at the same time", "body": "<p>Instead of sending the value directly, you could send an object which can compute the value. Then you can detect when the object is sent, and then compute. You can use sync.Once to make sure the computation is done once, and gate access to the result. This avoids using Sleeps.</p>\n\n<p>Something like this: <a href=\"https://play.golang.org/p/oL2HA2jl91\" rel=\"nofollow\">https://play.golang.org/p/oL2HA2jl91</a></p>\n"}], "owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2900, "favorite_count": 0, "answer_count": 4, "score": 5, "last_activity_date": 1422413896, "creation_date": 1422353334, "last_edit_date": 1422358417, "question_id": 28167826, "link": "https://stackoverflow.com/questions/28167826/select-on-a-go-send-and-receive-channel-at-the-same-time", "title": "Select on a go send and receive channel at the same time", "body": "<p>Suppose I have a buffered send and unbuffered receive channel:</p>\n\n<pre><code>s := make(chan&lt;- int, 5)\nr := make(&lt;-chan int)\n</code></pre>\n\n<p>Is it possible to <code>select</code> on them both, so that <code>r</code> will be selected if it has anything to read, and <code>s</code> will be selected if it is not full? Something equivalent to this, but not using 100% CPU:</p>\n\n<pre><code>for {\n    if len(s) &lt; cap(s) {\n        // Send something\n    }\n    if len(r) &gt; 0 {\n        // Receive something\n    }\n}\n</code></pre>\n\n<p>Note that I want to decide what to send at the time that I send it, not earlier.</p>\n\n<h3>Edit</h3>\n\n<p>This question is basically equivalent to \"Can I block until a channel is ready-to-send, <em>without</em> sending anything?\"</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 25686, "user_id": 975097, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dbbc1b2bc18739858cfa3b7ddcba7362?s=128&d=identicon&r=PG", "display_name": "Anderson Green", "link": "https://stackoverflow.com/users/975097/anderson-green"}, "edited": false, "score": 1, "creation_date": 1473470574, "post_id": 28166249, "comment_id": 66168068, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/6590054/get-a-list-of-all-installed-packages-in-go\">Get a list of all installed packages in Go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 0, "creation_date": 1422352507, "post_id": 28166550, "comment_id": 44705031, "body": "Can we list package dependencies, too?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 0, "creation_date": 1422353013, "post_id": 28166550, "comment_id": 44705272, "body": "Yes, you can do that too. Try running this command: <code>go list -f &quot;{{.ImportPath}} {{.Imports}}&quot; .&#47;...</code>"}, {"owner": {"reputation": 6478, "user_id": 1930535, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/R3UZw.png?s=128&g=1", "display_name": "Appleshell", "link": "https://stackoverflow.com/users/1930535/appleshell"}, "edited": false, "score": 1, "creation_date": 1523467679, "post_id": 28166550, "comment_id": 86577666, "body": "Depending on your shell, you might have to quote the triple dots. <code>go list &#39;...&#39;</code>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 79, "last_activity_date": 1556289503, "last_edit_date": 1556289503, "creation_date": 1422349192, "answer_id": 28166550, "question_id": 28166249, "link": "https://stackoverflow.com/questions/28166249/how-to-list-installed-go-packages/28166550#28166550", "title": "How to list installed go packages", "body": "<h2><code>goinstall</code> is now history</h2>\n\n<p><code>goinstall</code> was replaced by <code>go get</code>. <code>go get</code> is used to manage external / 3rd party libraries (e.g. to download them, update them, install them etc).</p>\n\n<p>Type <code>go help get</code> to see command line help, or check out these pages:</p>\n\n<p><a href=\"https://golang.org/cmd/go/\" rel=\"noreferrer\"><strong>Command go</strong></a></p>\n\n<p><a href=\"https://golang.org/doc/articles/go_command.html\" rel=\"noreferrer\"><strong>About the go command</strong></a> (blog post)</p>\n\n<p>If you want to list installed packages, you can do that with the <code>go list</code> command:</p>\n\n<h2>Listing Packages</h2>\n\n<p>To list packages in your workspace, go to your workspace folder and run this command:</p>\n\n<pre><code>go list ./...\n</code></pre>\n\n<p><code>./</code> tells to start from the current folder, <code>...</code> tells to go down recursively. Of course this works in any other folders not just in your go workspace (but usually that is what you're interested in).</p>\n\n<h2>List All Packages</h2>\n\n<p>Executing</p>\n\n<pre><code>go list ...\n</code></pre>\n\n<p>in any folder lists all the packages, including packages of the standard library first followed by external libraries in your go workspace.</p>\n\n<h2>Packages and their Dependencies</h2>\n\n<p>If you also want to see the imported packages by each package, you can try this custom format:</p>\n\n<pre><code>go list -f \"{{.ImportPath}} {{.Imports}}\" ./...\n</code></pre>\n\n<p><code>-f</code> specifies an alternate format for the list, using the syntax of package <a href=\"https://golang.org/pkg/text/template/\" rel=\"noreferrer\"><code>template</code></a>. The struct whose fields can be referenced can be printed by the <code>go help list</code> command.</p>\n\n<p>If you want to see all the dependencies <em>recursively</em> (dependencies of imported packages recursively), you can use this custom format:</p>\n\n<pre><code>go list -f \"{{.ImportPath}} {{.Deps}}\" ./...\n</code></pre>\n\n<p>But usually this is a long list and just the single imports (<code>\"{{.Imports}}\"</code>) of each package is what you want.</p>\n\n<hr>\n\n<p>Also see related question: <a href=\"https://stackoverflow.com/questions/55866604/whats-the-go-mod-equivalent-of-npm-outdated/55866702#55866702\">What&#39;s the Go (mod) equivalent of npm-outdated?</a></p>\n"}, {"comments": [{"owner": {"reputation": 620, "user_id": 3321356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e14f9190df43f297d8f64ba3bf14913?s=128&d=identicon&r=PG", "display_name": "markeissler", "link": "https://stackoverflow.com/users/3321356/markeissler"}, "edited": false, "score": 3, "creation_date": 1473470693, "post_id": 36776846, "comment_id": 66168083, "body": "In bash, the history command is limited to X number of lines, where X is configured via the HISTSIZE and HISTFILESIZE configuration options. So, the above solution isn&#39;t likely to be reliable."}, {"owner": {"reputation": 979, "user_id": 519990, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/yqwU3.png?s=128&g=1", "display_name": "skift", "link": "https://stackoverflow.com/users/519990/skift"}, "reply_to_user": {"reputation": 620, "user_id": 3321356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e14f9190df43f297d8f64ba3bf14913?s=128&d=identicon&r=PG", "display_name": "markeissler", "link": "https://stackoverflow.com/users/3321356/markeissler"}, "edited": false, "score": 0, "creation_date": 1475622411, "post_id": 36776846, "comment_id": 67014194, "body": "Yea thats a good point. But i figured my creation would have some kind of issues ;-)"}], "tags": [], "owner": {"reputation": 979, "user_id": 519990, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/yqwU3.png?s=128&g=1", "display_name": "skift", "link": "https://stackoverflow.com/users/519990/skift"}, "is_accepted": false, "score": 3, "last_activity_date": 1461262254, "last_edit_date": 1461262254, "creation_date": 1461260527, "answer_id": 36776846, "question_id": 28166249, "link": "https://stackoverflow.com/questions/28166249/how-to-list-installed-go-packages/36776846#36776846", "title": "How to list installed go packages", "body": "<p>on *nix systems (possibly on windows with bash tools like msysgit or cmder), to see what packages I have installed, I can run:</p>\n\n<pre><code>history | grep \"go get\"\n</code></pre>\n\n<p>But thats messy output. For whatever reason I decided to see of i could clean that output up a little so i made an alias for this command:</p>\n\n<pre><code>history | grep 'go get' | grep -v ' history ' | sed -e $'s/go get /\\\\\\\\\\ngo get /g' | grep 'go get ' | sed -e $'s/-u //g' | sed -e $'s/-v //g' | sed -e $'s/ &amp;&amp;//g' | grep -v '\\\\\\n' | egrep 'get [a-z]' | sed -e $'s/go get //g' | sed -e $'s/ //g' | sort -u\n</code></pre>\n\n<p>please don't ask why I did this. Challenge maybe? Let me explain the parts</p>\n\n<p><code>history</code> the history</p>\n\n<p><code>grep \"go get\"</code> grep over history and only show lines where we went and got something</p>\n\n<p><code>grep -v \" history \"</code> and remove times when we have searched for \"got get\" in history</p>\n\n<p><code>sed -e $'s/go get /\\\\\\\\\\ngo get /g'</code> Now we take any instances of \"go get \" and shove a new line in front of it. Now they're all at the beginning.</p>\n\n<p><code>grep \"go get \"</code> filter only lines that now start with \"go get\"</p>\n\n<p><code>sed -e $'s/-u //g'</code> and <code>sed -e $'s/-v //g'</code> remove flags we have searched for. You could possibly leave them in but may get duplicates when output is done.</p>\n\n<p><code>sed -e $'s/ &amp;&amp;//g'</code> some times we install with multiple commands using '&amp;&amp;' so lets remove them from the ends of the line.</p>\n\n<p><code>grep -v \"\\\\\\n\"</code> my output had other lines with newlines printed I didnt need. So this got rid of them</p>\n\n<p><code>egrep \"get [a-z]\"</code> make sure to get properly formatted go package urls only. </p>\n\n<p><code>sed -e $'s/go get //g'</code> remove the \"go get \" text</p>\n\n<p><code>sed -e $'s/ //g'</code> strip any whitespace (needed to filter out duplicates)</p>\n\n<p><code>sort -u</code> now sort the remaining lines and remove duplicates.</p>\n\n<p>This is totally untested on other systems. Again, I am quite sure there is a cleaner way to do this. Just thought it would be fun to try.</p>\n\n<p>It would also probably be more fun to make a <code>go ls</code> command to show the actual packages you explicitly installed. But thats a lot more work. Especially since i'm only still learning Go.</p>\n\n<p>Output:</p>\n\n<pre><code>&gt; gols \ncode.google.com/p/go.crypto/bcrypt\ngithub.com/golang/lint/golint\ngithub.com/kishorevaishnav/revelgen\ngithub.com/lukehoban/go-find-references\ngithub.com/lukehoban/go-outline\ngithub.com/newhook/go-symbols\ngithub.com/nsf/gocode\ngithub.com/revel/cmd/revel\ngithub.com/revel/revel\ngithub.com/rogpeppe/godef\ngithub.com/tpng/gopkgs\ngolang.org/x/tools/cmd/goimports\ngolang.org/x/tools/cmd/gorename\ngopkg.in/gorp.v1\nsourcegraph.com/sqs/goreturns\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "edited": false, "score": 2, "creation_date": 1581704628, "post_id": 42687029, "comment_id": 106538453, "body": "If you don&#39;t have <code>godoc</code> installed, use: <code>go get -u golang.org&#47;x&#47;tools&#47;...</code>"}], "tags": [], "owner": {"reputation": 642, "user_id": 807248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac14602bbca62eb0ad27d25a67eab945?s=128&d=identicon&r=PG", "display_name": "Michael A.", "link": "https://stackoverflow.com/users/807248/michael-a"}, "is_accepted": false, "score": 21, "last_activity_date": 1581704165, "last_edit_date": 1581704165, "creation_date": 1489035186, "answer_id": 42687029, "question_id": 28166249, "link": "https://stackoverflow.com/questions/28166249/how-to-list-installed-go-packages/42687029#42687029", "title": "How to list installed go packages", "body": "<p>Start Go documentation server:</p>\n\n<pre><code>godoc --http :6060\n</code></pre>\n\n<p>Visit <a href=\"http://localhost:6060/pkg\" rel=\"noreferrer\">http://localhost:6060/pkg</a></p>\n\n<p>There will be list of all your packages.</p>\n\n<p>When you install new ones they do not appear automatically. You need to restart <code>godoc</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 4305171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ce90y.jpg?s=128&g=1", "display_name": "zor-el", "link": "https://stackoverflow.com/users/4305171/zor-el"}, "is_accepted": false, "score": 0, "last_activity_date": 1595255691, "creation_date": 1595255691, "answer_id": 62997775, "question_id": 28166249, "link": "https://stackoverflow.com/questions/28166249/how-to-list-installed-go-packages/62997775#62997775", "title": "How to list installed go packages", "body": "<p><code>go list ...</code> is quite useful, but there were two possible issues with it for me:</p>\n<ol>\n<li>It will list <em>all</em> packages <em>including standard library packages</em>. There is no way to get the <em>explicitly</em> installed packages only (which is what I assume the more interesting inquiry).</li>\n<li>A lot of times I need only the packages used in my projects (i.e. those listed in the respective <code>go.mod</code> files), and I don't care about other packages lying around (which may have been installed just to try them out). <code>go list ...</code> doesn't help with that.</li>\n</ol>\n<p>So here's a somewhat different take. Assuming all projects are under <code>~/work</code>:</p>\n<pre class=\"lang-sh prettyprint-override\"><code>find ~/work -type f -name go.mod \\\n-exec sed $'/^require ($/,/^)$/!d; /^require ($/d;/^)$/d; /\\/\\/ indirect$/d; s/^\\t+//g' {} \\; \\\n| cut -d' ' -f1 \\\n| sort | uniq\n</code></pre>\n<p>A line by line explanation:</p>\n<ol>\n<li>find all <code>go.mod</code> files</li>\n<li>apply <code>sed</code> to each file to filter its content as follows (explained expression by expression):\n<ul>\n<li>extract just the <code>require(</code> ... <code>)</code> chunks</li>\n<li>remove the <code>require(</code> and <code>)</code> lines, so just lines with packages remain</li>\n<li><strong>remove all indirect packages</strong></li>\n<li>remove leading tabs <sup>1)</sup></li>\n</ul>\n</li>\n<li>extract just the qualified package name (drop version information)</li>\n<li>remove duplicate package names</li>\n</ol>\n<hr />\n<p><sup>1)</sup> Note the sed expression argument uses <a href=\"http://www.gnu.org/software/bash/manual/bash.html#ANSI_002dC-Quoting\" rel=\"nofollow noreferrer\">bash quoting</a> to escape the TAB character as &quot;\\t&quot; for readability over a literal TAB.</p>\n"}], "owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51823, "favorite_count": 17, "accepted_answer_id": 28166550, "answer_count": 4, "score": 41, "last_activity_date": 1611231822, "creation_date": 1422348056, "question_id": 28166249, "link": "https://stackoverflow.com/questions/28166249/how-to-list-installed-go-packages", "title": "How to list installed go packages", "body": "<p>To my knowledge <code>go distribution</code> comes with some sort of <code>package manager</code>. After <code>go 1.4.1</code> installation I've run <code>go help</code> in order to find any sub-command capable of listing locally installed <code>go packages</code>, but unfortunately got none.</p>\n\n<p>So how to do it?</p>\n"}, {"tags": ["build", "sqlite", "go"], "answers": [{"comments": [{"owner": {"reputation": 7376, "user_id": 2171928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a2dc8a6d4e15c61451d70f695ac18ae9?s=128&d=identicon&r=PG", "display_name": "Kishore Vaishnav", "link": "https://stackoverflow.com/users/2171928/kishore-vaishnav"}, "edited": false, "score": 0, "creation_date": 1422804543, "post_id": 28164957, "comment_id": 44885379, "body": "I tried with <code>GOOS=linux GOARCH=arm CGO_ENABLED=1 go build -o pravasan pravasan.go</code> but got an error <code># runtime&#47;cgo clang: error: argument unused during compilation: &#39;-mno-thumb&#39;</code>."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1422342078, "last_edit_date": 1592644375, "creation_date": 1422342078, "answer_id": 28164957, "question_id": 28164654, "link": "https://stackoverflow.com/questions/28164654/gox-throws-error-for-sqlite3-and-all-the-builds-are-failed/28164957#28164957", "title": "gox - throws error for sqlite3 and all the builds are failed", "body": "<p>The <a href=\"https://github.com/mitchellh/gox/issues/23\" rel=\"nofollow noreferrer\">gox issue 23</a> mentions:</p>\n<blockquote>\n<p>if you add <code>CGO_ENABLED=1</code> to the environment, it successfully compiles, but does not link (it needs a linux linker still), but gets much further along.</p>\n<blockquote>\n<p>so maybe we need to add a new <code>-cgo</code> flag (or, just do it) to gox to set that.</p>\n</blockquote>\n<p>That seems to be necessary, with <a href=\"http://golang.org/doc/go1.4#gocmd\" rel=\"nofollow noreferrer\">Go 1.4 now being more strict when compiling C source files</a>:</p>\n<p>Unless <code>cgo</code> is being used to build the package, the go command now refuses to compile C source files, since the relevant C compilers (6c etc.) are intended to be removed from the installation in some future release.<br />\n(They are used today only to build part of the runtime.)<br />\nIt is difficult to use them correctly in any case, so any extant uses are likely incorrect, so we have disabled them.</p>\n</blockquote>\n"}], "owner": {"reputation": 7376, "user_id": 2171928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a2dc8a6d4e15c61451d70f695ac18ae9?s=128&d=identicon&r=PG", "display_name": "Kishore Vaishnav", "link": "https://stackoverflow.com/users/2171928/kishore-vaishnav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 315, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1422342078, "creation_date": 1422340877, "question_id": 28164654, "link": "https://stackoverflow.com/questions/28164654/gox-throws-error-for-sqlite3-and-all-the-builds-are-failed", "title": "gox - throws error for sqlite3 and all the builds are failed", "body": "<p>I have Go application <a href=\"http://github.com/pravasan/pravasan\" rel=\"nofollow\">pravasan</a> and in my deploy branch I am trying to execute <a href=\"https://github.com/mitchellh/gox\" rel=\"nofollow\"><code>gox</code></a> to build its binaries, I am getting couple of errors and they are </p>\n\n<pre><code>18 errors occurred:\n--&gt; linux/amd64 error: exit status 2\nStderr: # github.com/mattn/go-sqlite3\n../../mattn/go-sqlite3/sqlite3.c:92 unknown #: if\n../../mattn/go-sqlite3/sqlite3.c:94 6c: No such file or directory: mingw.h\n\n--&gt; darwin/386 error: exit status 2\nStderr: # github.com/mattn/go-sqlite3\n../../mattn/go-sqlite3/sqlite3.c:92 unknown #: if\n../../mattn/go-sqlite3/sqlite3.c:94 8c: No such file or directory: mingw.h\n\n--&gt; linux/386 error: exit status 2\nStderr: # github.com/mattn/go-sqlite3\n../../mattn/go-sqlite3/sqlite3.c:92 unknown #: if\n../../mattn/go-sqlite3/sqlite3.c:94 8c: No such file or directory: mingw.h\n</code></pre>\n\n<p>Do anybody has suggestions to resolve this..</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12822, "user_id": 87750, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9eb0c80f3b41463ed45f45584b065a9?s=128&d=identicon&r=PG", "display_name": "fredrik", "link": "https://stackoverflow.com/users/87750/fredrik"}, "edited": false, "score": 0, "creation_date": 1422339563, "post_id": 28162577, "comment_id": 44699380, "body": "<a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">golang.org/doc/install</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1422339419, "creation_date": 1422339419, "answer_id": 28164356, "question_id": 28162577, "link": "https://stackoverflow.com/questions/28162577/go-path-and-setup/28164356#28164356", "title": "Go path and setup", "body": "<blockquote>\n  <p>I also downloaded it from git</p>\n</blockquote>\n\n<p>The <a href=\"https://github.com/golang/go\" rel=\"nofollow\">Go repo (github.com/golang/go)</a> wouldn't include the go binary.<br>\nOnly the msi or the archive at <a href=\"https://golang.org/dl/\" rel=\"nofollow\">golang.org/dl/</a> would (like <a href=\"https://storage.googleapis.com/golang/go1.4.1.windows-amd64.zip\" rel=\"nofollow\">go1.4.1.windows-amd64.zip</a>) would.</p>\n\n<p>You can unzip the archive anywhere, and set <code>GOROOT</code> to it, and <code>%GOROOT%\\bin</code> will point the the go binary.</p>\n"}, {"tags": [], "owner": {"reputation": 607, "user_id": 6001349, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PTE_eA98cOE/AAAAAAAAAAI/AAAAAAAAACI/GhBOo8gJQbU/photo.jpg?sz=128", "display_name": "harold ramos", "link": "https://stackoverflow.com/users/6001349/harold-ramos"}, "is_accepted": false, "score": 1, "last_activity_date": 1459541413, "creation_date": 1459541413, "answer_id": 36365032, "question_id": 28162577, "link": "https://stackoverflow.com/questions/28162577/go-path-and-setup/36365032#36365032", "title": "Go path and setup", "body": "<p>Add under user variables:\nGOPATH: C/:go</p>\n\n<p>Add under systems variable:\nC:/go</p>\n"}], "owner": {"reputation": 185, "user_id": 4414317, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-z7zBoPJUaLQ/AAAAAAAAAAI/AAAAAAAAABI/lhiohDzAXCA/photo.jpg?sz=128", "display_name": "Joe", "link": "https://stackoverflow.com/users/4414317/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1459541413, "creation_date": 1422328104, "last_edit_date": 1422342075, "question_id": 28162577, "link": "https://stackoverflow.com/questions/28162577/go-path-and-setup", "title": "Go path and setup", "body": "<p>I installed go binary for windows 64 and set up Go Paths like </p>\n\n<p><img src=\"https://i.stack.imgur.com/wqxvA.gif\" alt=\"this\"></p>\n\n<p>I also downloaded it from git. Why wont it find the go command?</p>\n"}, {"tags": ["templates", "go"], "answers": [{"tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": true, "score": 7, "last_activity_date": 1422318282, "creation_date": 1422318282, "answer_id": 28161269, "question_id": 28161229, "link": "https://stackoverflow.com/questions/28161229/text-template-space-in-maps-key/28161269#28161269", "title": "text/template: space in map&#39;s key", "body": "<p>Use the index function: <code>Movie name: {{index . \"name of the movie\"}}</code></p>\n\n<p>From <a href=\"http://godoc.org/text/template#hdr-Functions\" rel=\"noreferrer\">the docs</a>:</p>\n\n<pre><code>index\n  Returns the result of indexing its first argument by the\n  following arguments. Thus \"index x 1 2 3\" is, in Go syntax,\n  x[1][2][3]. Each indexed item must be a map, slice, or array.\n</code></pre>\n"}], "owner": {"reputation": 2414, "user_id": 1405208, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/3d7057ec4f36e18100f92b15ca310a5a?s=128&d=identicon&r=PG", "display_name": "Julien Fouilh&#233;", "link": "https://stackoverflow.com/users/1405208/julien-fouilh%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 832, "favorite_count": 0, "accepted_answer_id": 28161269, "answer_count": 1, "score": 1, "last_activity_date": 1422318282, "creation_date": 1422317954, "question_id": 28161229, "link": "https://stackoverflow.com/questions/28161229/text-template-space-in-maps-key", "title": "text/template: space in map&#39;s key", "body": "<p>I have the following code (using <code>text/template</code>):</p>\n\n<pre><code>inventory := map[string]string{\"name of the movie\": \"hello\"}\ntmpl, err := template.New(\"test\").Parse(\"Movie name \") // I want to display \"hello\" there\nif err != nil { panic(err) }\nerr = tmpl.Execute(os.Stdout, inventory)\nif err != nil { panic(err) }\n</code></pre>\n\n<p>As you can see, there is spaces in my map's key <code>name of the movie</code>. How can I do in the parse argument to display <code>hello</code> (which is the value of <code>name of the movie</code>)?</p>\n"}, {"tags": ["go", "namespaces"], "answers": [{"comments": [{"owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "edited": false, "score": 1, "creation_date": 1422315088, "post_id": 28160706, "comment_id": 44692691, "body": "By the way, <code>&quot;.&#47;some_package&quot;</code> as a path to a package is valid, but not recommended. See the <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">how to write Go code</a> tutorial."}, {"owner": {"reputation": 869, "user_id": 2620356, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d70e7de8674154dc8b6a5dde5d5c75?s=128&d=identicon&r=PG", "display_name": "kingSlayer", "link": "https://stackoverflow.com/users/2620356/kingslayer"}, "edited": false, "score": 0, "creation_date": 1422358397, "post_id": 28160706, "comment_id": 44708486, "body": "Thanks for the advice :)"}], "tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": true, "score": 3, "last_activity_date": 1422314998, "creation_date": 1422314998, "answer_id": 28160706, "question_id": 28160603, "link": "https://stackoverflow.com/questions/28160603/error-passing-map-to-a-function-in-imported-golang-package/28160706#28160706", "title": "Error passing map to a function in imported Golang package", "body": "<p>Even though the two types are named the same and contain the same structure, they are not the same type. A type always belongs to a package, and those two types belong to different packages.</p>\n\n<p>So you shouldn't copypaste the type <code>ticket</code> from <code>some_package</code> to <code>main</code>, but instead 1. export it to other packages by naming it in uppercase: <code>type Ticket struct</code>; and 2. use it from <code>main</code> like <code>make(map[string]sp.Ticket)</code>.</p>\n"}], "owner": {"reputation": 869, "user_id": 2620356, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d70e7de8674154dc8b6a5dde5d5c75?s=128&d=identicon&r=PG", "display_name": "kingSlayer", "link": "https://stackoverflow.com/users/2620356/kingslayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 28160706, "answer_count": 1, "score": -1, "last_activity_date": 1422315292, "creation_date": 1422314537, "question_id": 28160603, "link": "https://stackoverflow.com/questions/28160603/error-passing-map-to-a-function-in-imported-golang-package", "title": "Error passing map to a function in imported Golang package", "body": "<p>I need to send a map to a function declared in a imported package, and keep getting this error:</p>\n\n<blockquote>\n  <p>./main.go:21: cannot use m (type map[string]ticket) as type map[string]some_package.ticket in function argument</p>\n</blockquote>\n\n<p>This is the code of main.go in golang GOPATH folder:</p>\n\n<pre><code>package main\n\nimport (    \n        \"time\"\n         sp \"./some_package\"\n        )\n\ntype ticket struct {\n  Timestamp int64\n  Identification_number int\n}\nvar m map[string]ticket\n\n\nfunc main() {\n  humans := 10\n  m = make(map[string]ticket)\n  m[\"ticket1\"] = ticket{time.Now().Unix(), 1234}\n  sp_ := sp.New(humans)\n  sp_.SetTicket(m)\n}\n</code></pre>\n\n<p>And this is the code of some_package.go in /some_package in golang GOPATH folder:</p>\n\n<pre><code>package some_package\n\ntype park struct{\n  card map[string]ticket\n  people int\n}\n\ntype ticket struct {\n  Timestamp int64\n  Identification_number int\n}\n\nfunc (p *park) SetTicket(m map[string]ticket)(){\n\n}\n\nfunc New(humans int)(p *park){\n  p.card = make(map[string]ticket)\n  p.people = humans\n  return p\n}\n</code></pre>\n\n<p>How should I pass the value of the map to the imported package function or get the map value inside the function\nfrom the parent package?\nIs this even possible or is there a workaround?</p>\n"}, {"tags": ["http", "authentication", "go", "mux"], "answers": [{"comments": [{"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "edited": false, "score": 0, "creation_date": 1422309966, "post_id": 28159544, "comment_id": 44690566, "body": "How about i use something like this - token := req.URL.Query().Get(&quot;token&quot;)"}, {"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "edited": false, "score": 0, "creation_date": 1422310589, "post_id": 28159544, "comment_id": 44690868, "body": "Cool, thanks , How do i pass in this token parameter to the Auth function being used in the code above ?    Another question is have that the external library i am using looks for &quot;access_token&quot; parameter and in my server code, i would add this logic to handle &quot;token&quot; parameter. How can i internally map &quot;token&quot; to &quot;Access_token&quot; so that the library can successfully authenticate this token being passed in the request?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "edited": false, "score": 0, "creation_date": 1422311488, "post_id": 28159544, "comment_id": 44691297, "body": "How does the library get the query parameter? Does it use req.Form?"}, {"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "edited": false, "score": 0, "creation_date": 1422312602, "post_id": 28159544, "comment_id": 44691722, "body": "This is the Auth function  token, err := jwt.ParseFromRequest(req, func(token *jwt.Token) (interface{}, error) { \t\treturn config.Config.Key, nil \t})"}, {"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "edited": false, "score": 0, "creation_date": 1422312649, "post_id": 28159544, "comment_id": 44691744, "body": "The library has the implementation of ParseFromRequest which looks like this -   func ParseFromRequest(req *http.Request, keyFunc Keyfunc) (token *Token, err error) {  \t// Look for an Authorization header \tif ah := req.Header.Get(&quot;Authorization&quot;); ah != &quot;&quot; { \t\t// Should be a bearer token \t\tif len(ah) &gt; 6 &amp;&amp; strings.ToUpper(ah[0:6]) == &quot;BEARER&quot; { \t\t\treturn Parse(ah[7:], keyFunc) \t\t} \t}  \t// Look for &quot;access_token&quot; parameter \treq.ParseMultipartForm(10e6) \tif tokStr := req.Form.Get(&quot;access_token&quot;); tokStr != &quot;&quot; { \t\treturn Parse(tokStr, keyFunc) \t}  \treturn nil, ErrNoTokenInRequest  }"}, {"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "edited": false, "score": 0, "creation_date": 1422312712, "post_id": 28159544, "comment_id": 44691764, "body": "Pasted the above function in the description on the top."}, {"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "edited": false, "score": 0, "creation_date": 1422313841, "post_id": 28159544, "comment_id": 44692254, "body": "I see, thanks 3of3 , I will let you know if this worked for me. I am interested in authenticating this request as you would have seen by passing the token."}, {"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "edited": false, "score": 0, "creation_date": 1422394813, "post_id": 28159544, "comment_id": 44730136, "body": "Is there a way that I use req.URL.Query().Get(&quot;token&quot;) to fetch the token and be able to assign it to req.Form(&quot;access_token&quot;) ?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "edited": false, "score": 0, "creation_date": 1422398619, "post_id": 28159544, "comment_id": 44732092, "body": "You can <code>req.ParseForm(); req.Form.Set(&quot;access_token&quot;, req.URL.Query().Get(&quot;token&quot;))</code>   ParseForm sets req.Form to req.URL.Query() in this scenario.  Calling req.URL.Query() a second time is pointless."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 16, "last_activity_date": 1579630485, "last_edit_date": 1579630485, "creation_date": 1422309683, "answer_id": 28159544, "question_id": 28159520, "link": "https://stackoverflow.com/questions/28159520/passing-a-query-parameter-to-the-go-http-request-handler-using-the-mux-package/28159544#28159544", "title": "Passing a query parameter to the Go HTTP request handler using the MUX package", "body": "<p>Call <a href=\"http://godoc.org/net/http#Request.FormValue\" rel=\"nofollow noreferrer\">FormValue</a> to get a query parameter:</p>\n\n<pre><code>token := req.FormValue(\"token\")\n</code></pre>\n\n<p><code>req</code> is a the <code>*http.Request</code></p>\n\n<p>An alternative is to call <a href=\"http://godoc.org/net/http#Request.ParseForm\" rel=\"nofollow noreferrer\">ParseForm</a> and access <code>req.Form</code> directly:</p>\n\n<pre><code>if err := req.ParseForm(); err != nil {\n   // handle error\n}\ntoken := req.Form.Get(\"token\")\n</code></pre>\n\n<p>The OP asks in a comment how to map <code>\"token\"</code> to <code>\"access_token\"</code> for an external package that's looking <code>\"access_token\"</code>. Execute this code before calling the external package:</p>\n\n<pre><code>if err := req.ParseForm(); err != nil {\n   // handle error\n}\nreq.Form[\"access_token\"] = req.Form[\"token\"]\n</code></pre>\n\n<p>When the external package calls <code>req.Form.Get(\"access_token\")</code>, it will get the same value as the <code>\"token\"</code> parameter.</p>\n"}, {"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1422311844, "post_id": 28159806, "comment_id": 44691434, "body": "The <a href=\"http://godoc.org/net/url#URL.Query\" rel=\"nofollow noreferrer\">Query</a> method parses the query string every time the method is called. The preferred apporach is to parse the query string once by calling <a href=\"http://godoc.org/net/http#Request.ParseForm\" rel=\"nofollow noreferrer\">ParseForm</a> and accessing the parsed parameters in the request <a href=\"http://godoc.org/net/http#Request.Form\" rel=\"nofollow noreferrer\">Form</a> field.  The <a href=\"http://godoc.org/net/http#Request.FormValue\" rel=\"nofollow noreferrer\">FormValue</a> is a useful helper method that combines these two steps."}], "tags": [], "owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "is_accepted": false, "score": 4, "last_activity_date": 1422310882, "creation_date": 1422310882, "answer_id": 28159806, "question_id": 28159520, "link": "https://stackoverflow.com/questions/28159520/passing-a-query-parameter-to-the-go-http-request-handler-using-the-mux-package/28159806#28159806", "title": "Passing a query parameter to the Go HTTP request handler using the MUX package", "body": "<p>Depending on the way you want to parse the token , if its coming from the form or the URL. </p>\n\n<p>The first answer can be used if the token is being sent from the form while in case of a URL, I would suggest using this. This works for me</p>\n\n<pre><code>token := req.URL.Query().Get(\"token\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9835, "user_id": 512907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/vIyJf.jpg?s=128&g=1", "display_name": "bluehallu", "link": "https://stackoverflow.com/users/512907/bluehallu"}, "is_accepted": false, "score": 0, "last_activity_date": 1441635114, "creation_date": 1441635114, "answer_id": 32440698, "question_id": 28159520, "link": "https://stackoverflow.com/questions/28159520/passing-a-query-parameter-to-the-go-http-request-handler-using-the-mux-package/32440698#32440698", "title": "Passing a query parameter to the Go HTTP request handler using the MUX package", "body": "<p>For url query parameters:</p>\n\n<pre><code>mux.Vars(r)[\"token\"]\n</code></pre>\n"}], "owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12042, "favorite_count": 3, "accepted_answer_id": 28159544, "answer_count": 3, "score": 7, "last_activity_date": 1579630485, "creation_date": 1422309577, "last_edit_date": 1457964416, "question_id": 28159520, "link": "https://stackoverflow.com/questions/28159520/passing-a-query-parameter-to-the-go-http-request-handler-using-the-mux-package", "title": "Passing a query parameter to the Go HTTP request handler using the MUX package", "body": "<p>I am trying to pass an additional parameter in the request I am trying to send to the Go server -</p>\n\n<pre><code>websocket.create_connection(\"ws://&lt;ip&gt;:port/x/y?token=\"qwerty\")\n</code></pre>\n\n<p>The Go server implementation is as follows - </p>\n\n<pre><code>func main() {\n    err := config.Parse()\n    if err != nil {\n        glog.Error(err)\n        os.Exit(1)\n        return\n    }\n\n    flag.Parse()\n    defer glog.Flush()\n\n    router := mux.NewRouter()\n    http.Handle(\"/\", httpInterceptor(router))\n\n    router.Handle(\"/v1/x\", common.ErrorHandler(stats.GetS)).Methods(\"GET\")\n    router.Handle(\"/v1/x/y\", common.ErrorHandler(stats.GetS)).Methods(\"GET\")\n\n    var listen = fmt.Sprintf(\"%s:%d\", config.Config.Ip, config.Config.Port)\n    err = http.ListenAndServe(listen, nil)\n\n    if err != nil {\n        glog.Error(err)\n        os.Exit(1)\n    }\n}\n\nfunc httpInterceptor(router http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, req *http.Request) {\n        startTime := time.Now()\n\n        if !auth.Auth(w, req) {\n            http.Error(w, \"Failed authentication\", 401)\n            return\n        }\n\n        router.ServeHTTP(w, req)\n\n        finishTime := time.Now()\n        elapsedTime := finishTime.Sub(startTime)\n\n        switch req.Method {\n        case \"GET\":\n        case \"POST\":\n        }\n\n    })\n}\n</code></pre>\n\n<p>How should I look and parse for the token in the Go server so that the authentication is successful? </p>\n\n<p>Library function</p>\n\n<pre><code>func ParseFromRequest(req *http.Request, keyFunc Keyfunc) (token *Token, err error) {\n\n    // Look for an Authorization header\n    if ah := req.Header.Get(\"Authorization\"); ah != \"\" {\n        // Should be a bearer token\n        if len(ah) &gt; 6 &amp;&amp; strings.ToUpper(ah[0:6]) == \"BEARER\" {\n            return Parse(ah[7:], keyFunc)\n        }\n    }\n\n    // Look for \"access_token\" parameter\n    req.ParseMultipartForm(10e6)\n    if tokStr := req.Form.Get(\"access_token\"); tokStr != \"\" {\n        return Parse(tokStr, keyFunc)\n    }\n\n    return nil, ErrNoTokenInRequest\n\n}\n</code></pre>\n"}, {"tags": ["go", "reader"], "answers": [{"comments": [{"owner": {"reputation": 707, "user_id": 721861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784046b1b72d7969ae850ea7c8b46cba?s=128&d=identicon&r=PG", "display_name": "krait", "link": "https://stackoverflow.com/users/721861/krait"}, "edited": false, "score": 0, "creation_date": 1422311159, "post_id": 28159117, "comment_id": 44691139, "body": "ioutil.NopCloser only wraps io.Reader. You can create your own equivalent to produce an io.WriteCloser"}, {"owner": {"reputation": 890, "user_id": 1137085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0zXKR.jpg?s=128&g=1", "display_name": "Glenn &#39;devalias&#39; Grant", "link": "https://stackoverflow.com/users/1137085/glenn-devalias-grant"}, "edited": false, "score": 3, "creation_date": 1549438367, "post_id": 28159117, "comment_id": 95897378, "body": "It also has uses where you want to be able to read from it multiple times, without losing the content, as in this example: <a href=\"https://medium.com/@xoen/golang-read-from-an-io-readwriter-without-loosing-its-content-2c6911805361\" rel=\"nofollow noreferrer\">medium.com/@xoen/&hellip;</a>"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 13, "last_activity_date": 1422375837, "last_edit_date": 1422375837, "creation_date": 1422307853, "answer_id": 28159117, "question_id": 28158990, "link": "https://stackoverflow.com/questions/28158990/golang-io-ioutil-nopcloser/28159117#28159117", "title": "Golang io/ioutil NopCloser", "body": "<p>It's used for functions that require <code>io.ReadCloser</code> but your current object (for example a <code>bytes.Buffer</code>) doesn't provide a Close function.</p>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 31, "last_activity_date": 1446083594, "last_edit_date": 1446083594, "creation_date": 1422307862, "answer_id": 28159124, "question_id": 28158990, "link": "https://stackoverflow.com/questions/28158990/golang-io-ioutil-nopcloser/28159124#28159124", "title": "Golang io/ioutil NopCloser", "body": "<p>Whenever you need to return an <a href=\"http://golang.org/pkg/io/#ReadCloser\" rel=\"noreferrer\"><code>io.ReadCloser</code></a>, while making sure a <code>Close()</code> is available, you can use a <code>NopCloser</code> to build such a ReaderCloser.</p>\n\n<p>You can see one example in this <a href=\"https://github.com/fromkeith/gorest\" rel=\"noreferrer\">fork of gorest</a>, in <a href=\"https://github.com/fromkeith/gorest/blob/master/util.go\" rel=\"noreferrer\"><code>util.go</code></a></p>\n\n<pre><code>//Marshals the data in interface i into a byte slice, using the Marhaller/Unmarshaller specified in mime.\n//The Marhaller/Unmarshaller must have been registered before using gorest.RegisterMarshaller\nfunc InterfaceToBytes(i interface{}, mime string) (io.ReadCloser, error) {\n    v := reflect.ValueOf(i)\n    if v.Kind() == reflect.Ptr {\n        v = v.Elem()\n    }\n    switch v.Kind() {\n    case reflect.Bool:\n        x := v.Bool()\n        if x {\n            return ioutil.NopCloser(bytes.NewBuffer([]byte(\"true\"))), nil\n        }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1617756256, "creation_date": 1617756256, "answer_id": 66978202, "question_id": 28158990, "link": "https://stackoverflow.com/questions/28158990/golang-io-ioutil-nopcloser/66978202#66978202", "title": "Golang io/ioutil NopCloser", "body": "<p>It is for when you need to supply an item that has a <code>Close</code> function, but when\n<code>Close</code> doesnt really make sense for that item. As such, the function pretty much\ndoes nothing:</p>\n<pre><code>func (nopCloser) Close() error { return nil }\n</code></pre>\n<p><a href=\"https://github.com/golang/go/blob/go1.16.3/src/io/io.go#L620\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/go1.16.3/src/io/io.go#L620</a></p>\n"}], "owner": {"reputation": 1892, "user_id": 3158810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ebf9e065f654642fecfee399b439030?s=128&d=identicon&r=PG&f=1", "display_name": "G4143", "link": "https://stackoverflow.com/users/3158810/g4143"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10750, "favorite_count": 5, "accepted_answer_id": 28159124, "answer_count": 3, "score": 28, "last_activity_date": 1617756256, "creation_date": 1422307328, "last_edit_date": 1513801537, "question_id": 28158990, "link": "https://stackoverflow.com/questions/28158990/golang-io-ioutil-nopcloser", "title": "Golang io/ioutil NopCloser", "body": "<p>Does anyone have a good or any explanation of Golang's <a href=\"https://golang.org/pkg/io/ioutil/#NopCloser\" rel=\"noreferrer\"><code>NopCloser</code></a> function? <br> I looked around but failed to find anything besides Golang's main doc's explanation of:</p>\n\n<blockquote>\n  <p>NopCloser returns a ReadCloser with a no-op Close method wrapping the\n  provided Reader r.</p>\n</blockquote>\n\n<p>Any pointers or explanation would be appreciated. Thanks.</p>\n"}, {"tags": ["arrays", "unit-testing", "testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "edited": false, "score": 0, "creation_date": 1422305485, "post_id": 28158046, "comment_id": 44688276, "body": "Noted. Thank you. But it seems that I need to compare one element at time. &quot;slice con only be compared to nill&quot;"}], "tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": false, "score": 3, "last_activity_date": 1422303566, "last_edit_date": 1592644375, "creation_date": 1422303566, "answer_id": 28158046, "question_id": 28157891, "link": "https://stackoverflow.com/questions/28157891/testing-lists-in-go/28158046#28158046", "title": "Testing lists in GO", "body": "<p>Why do you wrote that in the first place? That's not Go syntax. From <a href=\"http://golang.org/ref/spec\" rel=\"nofollow noreferrer\">the spec</a>:</p>\n<blockquote>\n<p>A slice literal describes the entire underlying array literal. Thus, the length and capacity of a slice literal are the maximum element index plus one. A slice literal has the form</p>\n<pre><code>[]T{x1, x2, \u2026 xn}\n</code></pre>\n</blockquote>\n<p>So, in your case:</p>\n<pre><code>var testCases = []struct {\n    p        int\n    expected []int\n}{\n    {15, []int{3, 5}},\n    {26, []int{2, 13}},\n    {37, []int{37}},\n    {42, []int{2, 3, 7}},\n}\n</code></pre>\n<p>The spec is pretty readable and less scary than one might think. You may want to give it a full look and keep it close for reference.</p>\n"}, {"comments": [{"owner": {"reputation": 2324, "user_id": 86375, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/830d4a5362713c3080d20f4222922f10?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/86375/cameron"}, "edited": false, "score": 0, "creation_date": 1615505022, "post_id": 28158838, "comment_id": 117718974, "body": "Note: reflecting can be 2x to orders of magnitude slower. If you are concerned about performance, you might want a simple for loop."}], "tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": true, "score": 4, "last_activity_date": 1422306651, "creation_date": 1422306651, "answer_id": 28158838, "question_id": 28157891, "link": "https://stackoverflow.com/questions/28157891/testing-lists-in-go/28158838#28158838", "title": "Testing lists in GO", "body": "<p>Toni's answer addresses your specific problem but to address the other issue of comparing slices you'll want to use <a href=\"http://golang.org/pkg/reflect/#DeepEqual\" rel=\"nofollow\">reflect.DeepEqual</a></p>\n\n<p>Check out this example: </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    observed := []int{1, 2}\n    expected := []int{1, 3}\n\n    if reflect.DeepEqual(observed, expected) {\n        fmt.Println(\"Slices are the same\")\n    } else {\n        fmt.Println(\"Slices are different\")\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/_JRQ5bqmJf\" rel=\"nofollow\">https://play.golang.org/p/_JRQ5bqmJf</a></p>\n"}, {"comments": [{"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 0, "creation_date": 1422307842, "post_id": 28158947, "comment_id": 44689521, "body": "+1. I&#39;ve been trying to learn Go for a few months and especially interested in what the community considers &quot;idiomatic.&quot; Is it typical to avoid the <code>reflect</code> package for just this simple use case? Or is your post just &quot;for completeness&quot; as you said?"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "reply_to_user": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 1, "creation_date": 1422308157, "post_id": 28158947, "comment_id": 44689673, "body": "While in examples <code>reflect.DeepEqual</code> works (and will work very quickly with small slices), the bigger your slice gets, the slower it will get. It jumps through all sorts of hoops to return you a result because its trying to determine the types used in the slice and how to compare them. Whereas, you already know the type of the slices (<code>int</code>), so you can fine tune your own version for your use case. Some people consider it personal preference .. but I think you&#39;ll find a lot of Gophers prefer speed."}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "reply_to_user": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 0, "creation_date": 1422308277, "post_id": 28158947, "comment_id": 44689743, "body": "...if you&#39;re worried about the &quot;custom written&quot; aspect of it, don&#39;t be - utility functions like this will grow over time for you. Simply place them in their own package and reference them again in future and that issue goes away :)"}], "tags": [], "owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "is_accepted": false, "score": 2, "last_activity_date": 1422307116, "creation_date": 1422307116, "answer_id": 28158947, "question_id": 28157891, "link": "https://stackoverflow.com/questions/28157891/testing-lists-in-go/28158947#28158947", "title": "Testing lists in GO", "body": "<p>...and for completeness, here's just a simple example of writing your own function that your test can call to compare the slices:</p>\n\n<pre><code>func slicesMatch(a, b []int) bool {\n    la := len(a)\n    lb := len(b)\n\n    if la != lb {\n        return false\n    }\n\n    for i := 0; i &lt; la; i++ {\n        if a[i] != b[i] {\n            return false\n        }\n    }\n\n    return true\n}\n</code></pre>\n\n<p><kbd><a href=\"https://play.golang.org/p/w9lYC3lfZ4\" rel=\"nofollow\">View it on the Playground</a></kbd></p>\n"}], "owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1610, "favorite_count": 0, "accepted_answer_id": 28158838, "answer_count": 3, "score": 1, "last_activity_date": 1422307116, "creation_date": 1422302929, "question_id": 28157891, "link": "https://stackoverflow.com/questions/28157891/testing-lists-in-go", "title": "Testing lists in GO", "body": "<p>I'm trying to implement a test in GO. But I'm struggling with the list's syntax inside the struct.</p>\n\n<pre><code>package primeFactor\n\nimport \"testing\"\n\nvar testCases = []struct {\n    p        int\n    expected []int\n}{\n    {15, [3,5]},\n    {26, [2,13]},\n    {37, [37]},\n    {42, [2,3,7]},\n}\n\nfunc TestPrimeFactor(t *testing.T) {\n    for _, test := range testCases {\n        observed := PrimeFactor(test.p)\n        if observed != test.expected {\n            t.Error(\"For p = %d, expected %t. Got %t.\",\n                test.p, test.expected, observed)\n        }\n    }\n}\n</code></pre>\n\n<p>The output error I have is:  </p>\n\n<pre><code>expected ']', found ','\n: expected operand, found '{'\n: expected ';', found 'for'\n</code></pre>\n\n<p>I appreciate your help. Thanks.</p>\n"}, {"tags": ["go", "docker", "boot2docker"], "answers": [{"tags": [], "owner": {"reputation": 47142, "user_id": 47110, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/80c06a160eab494c0706b0ffd10d44e7?s=128&d=identicon&r=PG", "display_name": "Abdullah Jibaly", "link": "https://stackoverflow.com/users/47110/abdullah-jibaly"}, "is_accepted": true, "score": 1, "last_activity_date": 1422293042, "last_edit_date": 1495540170, "creation_date": 1422293042, "answer_id": 28155336, "question_id": 28155182, "link": "https://stackoverflow.com/questions/28155182/rebuild-when-files-changes-on-docker/28155336#28155336", "title": "Rebuild when files changes on docker", "body": "<p>Docker does not do this by default. I described a couple approaches to this in my question &amp; answer <a href=\"https://stackoverflow.com/questions/23796772/using-docker-during-the-development-workflow\">here</a>. A simple way to accomplish what you want is to use a watcher (like nodemon) to monitor your folder and kick off a script (or better, use fig) that recreates and runs your images.</p>\n"}], "owner": {"reputation": 4633, "user_id": 506712, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/QxcR9.jpg?s=128&g=1", "display_name": "Javier Manzano", "link": "https://stackoverflow.com/users/506712/javier-manzano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 28155336, "answer_count": 1, "score": 0, "last_activity_date": 1422293042, "creation_date": 1422292498, "question_id": 28155182, "link": "https://stackoverflow.com/questions/28155182/rebuild-when-files-changes-on-docker", "title": "Rebuild when files changes on docker", "body": "<p>i'm starting to work with docker (with boot2docker on Mac OSX) and golang,</p>\n\n<p>Whenever I make changes on my .go files I want to be visible on the docker image.</p>\n\n<p>Is there anyway to do this? Or docker is not the appropiate thing to do this?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "undefined", "func"], "comments": [{"owner": {"reputation": 15253, "user_id": 456188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ab34924e6d4e07371b890c5655c185a9?s=128&d=identicon&r=PG", "display_name": "Chris Pfohl", "link": "https://stackoverflow.com/users/456188/chris-pfohl"}, "edited": false, "score": 0, "creation_date": 1422286099, "post_id": 28153203, "comment_id": 44677705, "body": "do your files have package statements? What you typed doesn&#39;t have a <code>package x</code>, also your main package typically only contains a single file, then imports the other pieces it needs"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 9, "creation_date": 1422286175, "post_id": 28153203, "comment_id": 44677770, "body": "are you using <code>go run</code>? (and see <a href=\"http://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a>)"}, {"owner": {"reputation": 2741, "user_id": 2438413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cLAr2.jpg?s=128&g=1", "display_name": "Juan M", "link": "https://stackoverflow.com/users/2438413/juan-m"}, "reply_to_user": {"reputation": 15253, "user_id": 456188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ab34924e6d4e07371b890c5655c185a9?s=128&d=identicon&r=PG", "display_name": "Chris Pfohl", "link": "https://stackoverflow.com/users/456188/chris-pfohl"}, "edited": false, "score": 0, "creation_date": 1422286278, "post_id": 28153203, "comment_id": 44677839, "body": "@Crisfole yes the imports in main.go are &quot;flag&quot; and &quot;fmt&quot;. Employee.go has no imports and both files are under a package called &quot;main&quot;"}, {"owner": {"reputation": 2741, "user_id": 2438413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cLAr2.jpg?s=128&g=1", "display_name": "Juan M", "link": "https://stackoverflow.com/users/2438413/juan-m"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1422286326, "post_id": 28153203, "comment_id": 44677867, "body": "@JimB I tried both go run and go build, to no avail"}, {"owner": {"reputation": 15253, "user_id": 456188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ab34924e6d4e07371b890c5655c185a9?s=128&d=identicon&r=PG", "display_name": "Chris Pfohl", "link": "https://stackoverflow.com/users/456188/chris-pfohl"}, "edited": false, "score": 1, "creation_date": 1422286416, "post_id": 28153203, "comment_id": 44677930, "body": "@JuanM, my question was is that the <b>complete</b> source of <code>main.go</code> and <code>employee.go</code>? Because all go files are supposed to have a package statement, and I don&#39;t see any in yours. See: <a href=\"https://golang.org/doc/code.html#PackageNames\" rel=\"nofollow noreferrer\">golang.org/doc/code.html#PackageNames</a>"}, {"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 1, "creation_date": 1422286434, "post_id": 28153203, "comment_id": 44677938, "body": "The last func of employee.go is wrong (no function name, no return type declared). It is not the problem you ask for, but it shows that there are more problems. Could you post the complete code and the complete error when compiling?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1422286439, "post_id": 28153203, "comment_id": 44677942, "body": "then show us what your doing! GOPATH, actual code, and how you&#39;re invoking the <code>go</code> tool."}, {"owner": {"reputation": 2741, "user_id": 2438413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cLAr2.jpg?s=128&g=1", "display_name": "Juan M", "link": "https://stackoverflow.com/users/2438413/juan-m"}, "edited": false, "score": 0, "creation_date": 1422286804, "post_id": 28153203, "comment_id": 44678186, "body": "%GOPATH% C:\\gocode\\src  the files Employee.go and main.go are under C:\\gocode\\src"}, {"owner": {"reputation": 2741, "user_id": 2438413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cLAr2.jpg?s=128&g=1", "display_name": "Juan M", "link": "https://stackoverflow.com/users/2438413/juan-m"}, "edited": false, "score": 0, "creation_date": 1422287029, "post_id": 28153203, "comment_id": 44678324, "body": "also edited the original post to add package statements. thanks!"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1422303728, "post_id": 28153203, "comment_id": 44687437, "body": "Please add the commands you use to compile to your question."}], "answers": [{"comments": [{"owner": {"reputation": 2741, "user_id": 2438413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cLAr2.jpg?s=128&g=1", "display_name": "Juan M", "link": "https://stackoverflow.com/users/2438413/juan-m"}, "edited": false, "score": 0, "creation_date": 1422289163, "post_id": 28153553, "comment_id": 44679696, "body": "thanks for the input @JimB! I edited the environment variables (I also had forgotten to set GOBIN), moved my files to the correct location, but still when i try go intstall i get the same error. Any suggestions?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2741, "user_id": 2438413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cLAr2.jpg?s=128&g=1", "display_name": "Juan M", "link": "https://stackoverflow.com/users/2438413/juan-m"}, "edited": false, "score": 0, "creation_date": 1422289662, "post_id": 28153553, "comment_id": 44680032, "body": "Are you certain there&#39;s no other errors? Your employee.go file can&#39;t compile as is. Otherwise, I need to see <i>exactly</i> what you&#39;re doing. Exact paths, invocation, etc."}, {"owner": {"reputation": 303, "user_id": 931475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e010b1912f1a428a6031baeb0ab0c137?s=128&d=identicon&r=PG", "display_name": "Kyle Mcgill", "link": "https://stackoverflow.com/users/931475/kyle-mcgill"}, "edited": false, "score": 0, "creation_date": 1613091464, "post_id": 28153553, "comment_id": 116976884, "body": "Also running <code>go run .</code> -  the period being &quot;this directory&quot;"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 964, "user_id": 93276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zMfFU.jpg?s=128&g=1", "display_name": "Puran", "link": "https://stackoverflow.com/users/93276/puran"}, "edited": false, "score": 1, "creation_date": 1614088120, "post_id": 28153553, "comment_id": 117273203, "body": "@Puran <code>go run *.go</code> is a bad idea, because it will break if you have any build constraints or test files."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 213, "last_activity_date": 1614086265, "last_edit_date": 1614086265, "creation_date": 1422287219, "answer_id": 28153553, "question_id": 28153203, "link": "https://stackoverflow.com/questions/28153203/undefined-function-declared-in-another-file/28153553#28153553", "title": "&quot;undefined&quot; function declared in another file?", "body": "<p>Please read <a href=\"http://golang.org/doc/code.html\" rel=\"noreferrer\">&quot;How to Write Go Code&quot;</a>.</p>\n<p>Use <code>go build</code> or <code>go install</code> within the package directory, or supply an import path for the package. Do not use file arguments for <code>build</code> or <code>install</code>.</p>\n<p>While you can use file arguments for <code>go run</code>, you should build a package instead, usually with <code>go run .</code>, though you should almost always use <code>go install</code>, or <code>go build</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1348, "user_id": 1929406, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e9276c036f99fff7dba74db8f5a06bac?s=128&d=identicon&r=PG", "display_name": "kivagant", "link": "https://stackoverflow.com/users/1929406/kivagant"}, "edited": false, "score": 6, "creation_date": 1569408911, "post_id": 44918068, "comment_id": 102585590, "body": "Thank you, this is what I was looking for. Please mention that your answer is about Intellij IDEA."}, {"owner": {"reputation": 696, "user_id": 1364759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3b01238f289cc93432a681999f9e07d8?s=128&d=identicon&r=PG", "display_name": "Shadoninja", "link": "https://stackoverflow.com/users/1364759/shadoninja"}, "edited": false, "score": 0, "creation_date": 1605810721, "post_id": 44918068, "comment_id": 114773366, "body": "I wish this would show up closer to the top by default. This is a really valuable answer."}, {"owner": {"reputation": 589, "user_id": 1336815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61fcbda129ff1e0534c5cb5031470ffe?s=128&d=identicon&r=PG&f=1", "display_name": "hukeping", "link": "https://stackoverflow.com/users/1336815/hukeping"}, "edited": false, "score": 0, "creation_date": 1616982031, "post_id": 44918068, "comment_id": 118164288, "body": "This addresses my problem with IDEA."}], "tags": [], "owner": {"reputation": 2292, "user_id": 767903, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7ae9acb5bf16896b78a9708403da20ca?s=128&d=identicon&r=PG", "display_name": "Andrew W. Phillips", "link": "https://stackoverflow.com/users/767903/andrew-w-phillips"}, "is_accepted": false, "score": 87, "last_activity_date": 1571636406, "last_edit_date": 1571636406, "creation_date": 1499234483, "answer_id": 44918068, "question_id": 28153203, "link": "https://stackoverflow.com/questions/28153203/undefined-function-declared-in-another-file/44918068#44918068", "title": "&quot;undefined&quot; function declared in another file?", "body": "<p>I just had the same problem in GoLand (which is Intellij IDEA for Go) and worked out a solution. You need to change the <code>Run kind</code> from <code>File</code> to <code>Package</code> or <code>Directory</code>. You can choose this from a drop-down if you go into <code>Run/Edit</code> Configurations.</p>\n\n<p>Eg: for package <code>~/go/src/a_package</code>, use a <code>Package path</code> of <code>a_package</code> and a <code>Directory</code> of <code>~/go/src/a_package</code> and <code>Run kind</code> of <code>Package</code> or <code>Directory</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 445, "user_id": 5365398, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KWdK0wTHJ3A/AAAAAAAAAAI/AAAAAAAAAHQ/_GYeZ3DEpgo/photo.jpg?sz=128", "display_name": "Druhin Bala", "link": "https://stackoverflow.com/users/5365398/druhin-bala"}, "reply_to_user": {"reputation": 2105, "user_id": 5821408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f6ca899d084f02ac63e71e9e8711046?s=128&d=identicon&r=PG&f=1", "display_name": "shmsr", "link": "https://stackoverflow.com/users/5821408/shmsr"}, "edited": false, "score": 0, "creation_date": 1596746531, "post_id": 47581949, "comment_id": 111918231, "body": "And here&#39;s a digital ocean article too: <a href=\"https://www.digitalocean.com/community/tutorials/how-to-build-and-install-go-programs\" rel=\"nofollow noreferrer\">digitalocean.com/community/tutorials/&hellip;</a>"}], "tags": [], "owner": {"reputation": 445, "user_id": 5365398, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KWdK0wTHJ3A/AAAAAAAAAAI/AAAAAAAAAHQ/_GYeZ3DEpgo/photo.jpg?sz=128", "display_name": "Druhin Bala", "link": "https://stackoverflow.com/users/5365398/druhin-bala"}, "is_accepted": false, "score": -2, "last_activity_date": 1512073377, "creation_date": 1512073377, "answer_id": 47581949, "question_id": 28153203, "link": "https://stackoverflow.com/questions/28153203/undefined-function-declared-in-another-file/47581949#47581949", "title": "&quot;undefined&quot; function declared in another file?", "body": "<p>If your source folder is structured /go/src/blog (assuming the name of your source folder is blog).</p>\n\n<ol>\n<li>cd /go/src/blog ... (cd inside the folder that has your package)</li>\n<li>go install</li>\n<li>blog</li>\n</ol>\n\n<p>That should run all of your files at the same time, instead of you having to list the files manually or \"bashing\" a method on the command line.</p>\n"}, {"comments": [{"owner": {"reputation": 1885, "user_id": 1211604, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3467e7fbe37fc3da7eacb526cd36aeba?s=128&d=identicon&r=PG", "display_name": "Stavros_S", "link": "https://stackoverflow.com/users/1211604/stavros-s"}, "edited": false, "score": 0, "creation_date": 1536082965, "post_id": 50593262, "comment_id": 91293653, "body": "Are there any downfalls to doing it this way? This seems like the simplest answer to the OPs question."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 1, "creation_date": 1565644808, "post_id": 50593262, "comment_id": 101409826, "body": "A more general solution under Bash: <code>go run !(*_test).go</code> -- <a href=\"https://stackoverflow.com/a/41479692/86967\">Golang: run all .go files within current directory through the command line (multi file package)</a>"}], "tags": [], "owner": {"reputation": 5962, "user_id": 3873510, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/YpJMi.jpg?s=128&g=1", "display_name": "Paul Razvan Berg", "link": "https://stackoverflow.com/users/3873510/paul-razvan-berg"}, "is_accepted": false, "score": 23, "last_activity_date": 1527631015, "last_edit_date": 1527631015, "creation_date": 1527629463, "answer_id": 50593262, "question_id": 28153203, "link": "https://stackoverflow.com/questions/28153203/undefined-function-declared-in-another-file/50593262#50593262", "title": "&quot;undefined&quot; function declared in another file?", "body": "<p>If you're using <code>go run</code>, do <code>go run *.go</code>. It will automatically find all go files in the current working directory, compile and then run your main function.</p>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 7284813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf048eea8c37a190ea901523c7880c7?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet Tokhi", "link": "https://stackoverflow.com/users/7284813/puneet-tokhi"}, "is_accepted": false, "score": 5, "last_activity_date": 1527823503, "creation_date": 1527823503, "answer_id": 50635684, "question_id": 28153203, "link": "https://stackoverflow.com/questions/28153203/undefined-function-declared-in-another-file/50635684#50635684", "title": "&quot;undefined&quot; function declared in another file?", "body": "<p>If you want to call a function from another go file and you are using Goland, then find the option 'Edit configuration' from the Run menu and change the run kind from File to Directory. It clears all the errors and allows you to call functions from other go files.</p>\n"}, {"tags": [], "owner": {"reputation": 4250, "user_id": 5729421, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/rUUiV.jpg?s=128&g=1", "display_name": "Chanaka Anuradh Caldera", "link": "https://stackoverflow.com/users/5729421/chanaka-anuradh-caldera"}, "is_accepted": false, "score": 11, "last_activity_date": 1596589535, "last_edit_date": 1596589535, "creation_date": 1543757645, "answer_id": 53580751, "question_id": 28153203, "link": "https://stackoverflow.com/questions/28153203/undefined-function-declared-in-another-file/53580751#53580751", "title": "&quot;undefined&quot; function declared in another file?", "body": "<p>You can try one of the following:</p>\n<p><strong>Method 1</strong>:</p>\n<ul>\n<li>Assume that your project name is <code>MyProject</code></li>\n<li>Go to your path, run <code>go build</code></li>\n<li>It will create an executable file as your project name (&quot;MyProject&quot;)</li>\n<li>Then run the executable using <code>./MyProject</code></li>\n</ul>\n<p>You can do both steps at once by typing <code>go build &amp;&amp; ./MyProject</code>. Go files of the <code>package main</code> are compiled to an executable.</p>\n<p><strong>Method 2</strong>:</p>\n<ul>\n<li>Just run <code>go run *.go</code>. It won't create any executable but it runs.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 14451, "user_id": 1334561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhV7w.jpg?s=128&g=1", "display_name": "Muhammad Soliman", "link": "https://stackoverflow.com/users/1334561/muhammad-soliman"}, "is_accepted": false, "score": 0, "last_activity_date": 1557816384, "creation_date": 1557816384, "answer_id": 56124448, "question_id": 28153203, "link": "https://stackoverflow.com/questions/28153203/undefined-function-declared-in-another-file/56124448#56124448", "title": "&quot;undefined&quot; function declared in another file?", "body": "<p>I ran into the same issue with <code>Go11</code>, just wanted to share how I did solve it for helping others just in case they run into the same issue. </p>\n\n<p>I had my Go project <strong>outside</strong> <code>$GOPATH</code>, so I had to turned on <code>GO111MODULE=on</code> without this option turned on, it will give you this issue; even if you you try to build or test the whole <code>package</code> or <code>directory</code> it won't be solved without <code>GO111MODULE=on</code> </p>\n"}, {"comments": [{"owner": {"reputation": 151, "user_id": 9475736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a40bb61cfdd2205f8e1c0a339d08167a?s=128&d=identicon&r=PG", "display_name": "moondaddi", "link": "https://stackoverflow.com/users/9475736/moondaddi"}, "edited": false, "score": 1, "creation_date": 1596595656, "post_id": 60051057, "comment_id": 111859025, "body": "I&#39;ve been a while to run my old go project and forget how to run. I finally found it with your answer. This should be an upvoted answer!"}], "tags": [], "owner": {"reputation": 1634, "user_id": 2500817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff5e270af21c3c368c7a4c6974dd553f?s=128&d=identicon&r=PG", "display_name": "Miguel Reyes", "link": "https://stackoverflow.com/users/2500817/miguel-reyes"}, "is_accepted": false, "score": 5, "last_activity_date": 1580793662, "creation_date": 1580793662, "answer_id": 60051057, "question_id": 28153203, "link": "https://stackoverflow.com/questions/28153203/undefined-function-declared-in-another-file/60051057#60051057", "title": "&quot;undefined&quot; function declared in another file?", "body": "<p><code>go run .</code> will run all of your files. The entry point is the function <code>main()</code> which has to be unique to the <code>main</code> package.</p>\n\n<p>Another option is to build the binary with <code>go build</code> and run it.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 2248583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WVe0.jpg?s=128&g=1", "display_name": "Jeetsang", "link": "https://stackoverflow.com/users/2248583/jeetsang"}, "is_accepted": false, "score": 1, "last_activity_date": 1594366626, "creation_date": 1594366626, "answer_id": 62829413, "question_id": 28153203, "link": "https://stackoverflow.com/questions/28153203/undefined-function-declared-in-another-file/62829413#62829413", "title": "&quot;undefined&quot; function declared in another file?", "body": "<p>you should use <a href=\"https://blog.golang.org/using-go-modules\" rel=\"nofollow noreferrer\">go modules</a> now, if you are not following <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to write go code</a></p>\n<p>With go module you don't have to put the code in the $GOPATH/src. it can live in any other location as well.</p>\n<p>You can move the code to different directory like /employee, To make it work Just under employee directory initialise the go module</p>\n<pre><code>go mod init example.com/employee\n</code></pre>\n"}], "owner": {"reputation": 2741, "user_id": 2438413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cLAr2.jpg?s=128&g=1", "display_name": "Juan M", "link": "https://stackoverflow.com/users/2438413/juan-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118735, "favorite_count": 36, "accepted_answer_id": 28153553, "answer_count": 9, "score": 167, "last_activity_date": 1614086265, "creation_date": 1422286032, "last_edit_date": 1614071550, "question_id": 28153203, "link": "https://stackoverflow.com/questions/28153203/undefined-function-declared-in-another-file", "title": "&quot;undefined&quot; function declared in another file?", "body": "<p>I'm trying to write a basic go program that calls a function on a different file, but a part of the same package. However, it returns:</p>\n\n<pre><code>undefined: NewEmployee\n</code></pre>\n\n<p>Here is the source code:</p>\n\n<p><code>main.go</code>:</p>\n\n<pre><code>package main\n\nfunc main() {\nemp := NewEmployee()    \n}\n</code></pre>\n\n<p><code>employee.go</code>:</p>\n\n<pre><code>package main\n\ntype Employee struct {\n    name string\n    age int\n}   \n\nfunc NewEmployee() *Employee {\n    p := &amp;Employee{}\n    return p\n}\n\nfunc PrintEmployee (p *Employee)  {\n    return \"Hello world!\"\n}\n</code></pre>\n"}, {"tags": ["string", "go", "type-conversion", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1422284019, "post_id": 28152276, "comment_id": 44676295, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/7988543/how-to-get-hex-encoded-md5-hash-in-go\">How to get hex-encoded md5 hash in Go</a>"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1422284853, "last_edit_date": 1422284853, "creation_date": 1422283774, "answer_id": 28152461, "question_id": 28152276, "link": "https://stackoverflow.com/questions/28152276/slice-can-not-convert-to-string/28152461#28152461", "title": "Slice can not convert to string", "body": "<p><code>md5.Sum()</code> returns bytes, not printable ASCII characters. If you want to see hex representation of those bytes, you can use <code>fmt.Sprintf(\"%x\", ...)</code>, like this:</p>\n\n<pre><code>v_pwd_encrypt := fmt.Sprintf(\"%x\", v_pwd_encrypt_byte)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 2, "last_activity_date": 1422284635, "creation_date": 1422284635, "answer_id": 28152747, "question_id": 28152276, "link": "https://stackoverflow.com/questions/28152276/slice-can-not-convert-to-string/28152747#28152747", "title": "Slice can not convert to string", "body": "<p>Adding to @Ainar-G's answer, <a href=\"http://golang.org/pkg/encoding/hex/#EncodeToString\" rel=\"nofollow\"><code>hex.EncodeToString</code></a> is the most efficient way to do it since it doesn't involve reflection or type guessing like <code>fmt.Sprintf</code>.</p>\n\n<pre><code>func main() {\n    sum := md5.Sum([]byte(\"meh\"))\n    stringSum := hex.EncodeToString(sum[:])\n    fmt.Println(stringSum)\n}\n</code></pre>\n"}], "owner": {"reputation": 2099, "user_id": 1917479, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/daEaw.jpg?s=128&g=1", "display_name": "soapbar", "link": "https://stackoverflow.com/users/1917479/soapbar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 28152747, "answer_count": 2, "score": 0, "last_activity_date": 1422284853, "creation_date": 1422283199, "question_id": 28152276, "link": "https://stackoverflow.com/questions/28152276/slice-can-not-convert-to-string", "title": "Slice can not convert to string", "body": "<pre><code>func (this *AdminModel) Login(v_name string, v_pwd string) (bool, error, uint) {\n    o := orm.NewOrm()\n    v_pwd_encrypt_byte := md5.Sum([]byte(v_pwd))\n    v_pwd_encrypt := string(v_pwd_encrypt_byte[:])\n    t_admin := Admin{Name: v_name, Pwd: v_pwd_encrypt}\n    fmt.Printf(\"username:%v  password:%v\\n\", v_name, v_pwd_encrypt_byte)\n    fmt.Printf(\"username:%v  password:%v\\n\", v_name, v_pwd_encrypt_byte[:])\n    fmt.Printf(\"username:%v  password:%v\\n\", v_name, v_pwd_encrypt)\n    err := o.Read(&amp;t_admin, \"Name\", \"Pwd\")\n    if err != nil {\n        return false, err, 0\n    } else {\n        return true, nil, t_admin.Id\n    }\n}\n</code></pre>\n\n<p>print result:</p>\n\n<pre><code>username:yuhaya  password:[97 22 175 237 203 11 195 16 131 147 92 28 38 47 244 201]\nusername:yuhaya  password:[97 22 175 237 203 11 195 16 131 147 92 28 38 47 244 201]\nusername:yuhaya  password:a???\n                          ???\\&amp;/??\n</code></pre>\n\n<p>Why the last line of the printing results gibberish?</p>\n\n<pre><code>v_pwd_encrypt := string(v_pwd_encrypt_byte[:])\n</code></pre>\n\n<p>Is this position convert out of the question?</p>\n"}, {"tags": ["concurrency", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1422282336, "post_id": 28151816, "comment_id": 44675198, "body": "yes. (that&#39;s not enough to put in an answer). Do you have a specific question about this that isn&#39;t a yes or no answer?"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1422283036, "post_id": 28151816, "comment_id": 44675616, "body": "It is a right way to use buffered channel in this scenario? Or I have to prevent buffered channel as much as possible?"}, {"owner": {"reputation": 86, "user_id": 98245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f77bc946e48e3ac630f7ce2f000db39d?s=128&d=identicon&r=PG", "display_name": "filmil", "link": "https://stackoverflow.com/users/98245/filmil"}, "edited": false, "score": 0, "creation_date": 1422283507, "post_id": 28151816, "comment_id": 44675940, "body": "err3() and err4() check for the same value of n == 3.  Is this correct?  Also, the code repeats a lot and can be refactored to remove repetition."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1422283735, "post_id": 28151816, "comment_id": 44676093, "body": "@zero_coding: if you need a buffered chan, use a buffered chan. It serves a purpose and there&#39;s no reason to blindly avoid them."}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1422281818, "creation_date": 1422281818, "question_id": 28151816, "link": "https://stackoverflow.com/questions/28151816/right-way-to-use-buffered-channel", "title": "Right way to use buffered channel", "body": "<p>I have the following code, that use goroutines and buffered channels. I want to know, if I use the channel in the right way or not.</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"math/rand\"\n    \"runtime\"\n    \"time\"\n)\n\nfunc random(min, max int) int {\n    rand.Seed(time.Now().Unix())\n    return rand.Intn(max-min) + min\n}\n\nfunc err1(rand int) &lt;-chan error {\n    output := make(chan error, 1)\n    go func(n int) {\n        if n == 1 {\n            output &lt;- errors.New(\"Error 1\")\n        }\n        fmt.Println(\"Leave 1\")\n        close(output)\n    }(rand)\n\n    return output\n}\n\nfunc err2(rand int) &lt;-chan error {\n    output := make(chan error, 1)\n    go func(n int) {\n        if n == 2 {\n            output &lt;- errors.New(\"Error 2\")\n        }\n        fmt.Println(\"Leave 2\")\n        close(output)\n    }(rand)\n    return output\n}\n\nfunc err3(rand int) &lt;-chan error {\n    output := make(chan error, 1)\n    go func(n int) {\n        if n == 3 {\n            output &lt;- errors.New(\"Error 3\")\n        }\n        fmt.Println(\"Leave 3\")\n        close(output)\n    }(rand)\n    return output\n}\n\nfunc err4(rand int) &lt;-chan error {\n    output := make(chan error, 1)\n    go func(n int) {\n        if n == 3 {\n            output &lt;- errors.New(\"Error 4\")\n        }\n        fmt.Println(\"Leave 4\")\n        close(output)\n    }(rand)\n    return output\n}\n\nfunc err5(rand int) &lt;-chan error {\n    output := make(chan error, 1)\n    go func(n int) {\n        if n == 4 {\n            output &lt;- errors.New(\"Error 5\")\n        }\n        fmt.Println(\"Leave 5\")\n        close(output)\n    }(rand)\n    return output\n}\n\nfunc process(chs ...&lt;-chan error) error {\n    var err error\n\n    for _, ch := range chs {\n        err = &lt;-ch\n        if err != nil {\n            //fmt.Println(\"Leave channel loop\")\n            break\n        }\n        //fmt.Println(\"Channel loop\")\n    }\n    return err\n}\n\nfunc main() {\n\n    runtime.GOMAXPROCS(runtime.NumCPU())\n\n    n := random(1, 8)\n    //n := 3\n    fmt.Println(n)\n\n    err := process(err1(n), err2(n), err3(n), err4(n), err5(n))\n    fmt.Println(err)\n\n    time.Sleep(time.Second * 3)\n\n}\n</code></pre>\n"}, {"tags": ["go", "digital-ocean", "drone.io", "drone"], "comments": [{"owner": {"reputation": 2383, "user_id": 160454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c58a0be77ee441bb8f8595b7f1b4e87?s=128&d=identicon&r=PG", "display_name": "Brad Rydzewski", "link": "https://stackoverflow.com/users/160454/brad-rydzewski"}, "edited": false, "score": 0, "creation_date": 1471738283, "post_id": 28150077, "comment_id": 65469002, "body": "I recommend using the official drone documentation. The digital ocean tutorials are not written / maintained by the drone authors, and are therefore out of date and inaccurate. For example, drone no longer uses <code>&#47;api&#47;auth&#47;github.com</code> as the callback URL which is probably why the oauth flow isn&#39;t working for you. It needs to be configured to <code>&#47;authorize</code>"}], "answers": [{"tags": [], "owner": {"reputation": 139, "user_id": 1143798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67d3880bbfaafdb2a2108b7c9a64df47?s=128&d=identicon&r=PG", "display_name": "aemadrid", "link": "https://stackoverflow.com/users/1143798/aemadrid"}, "is_accepted": false, "score": 0, "last_activity_date": 1422916477, "creation_date": 1422916477, "answer_id": 28288086, "question_id": 28150077, "link": "https://stackoverflow.com/questions/28150077/where-are-the-drone-logs-stored/28288086#28288086", "title": "Where are the drone logs stored?", "body": "<p>I had a similar issue and in the end it was that my github app authorization url was not the same or that I was using the wrong api url. For that last error make sure you are using the one in the api docs and not the one in the tutorial (it was wrong at the time).</p>\n"}, {"tags": [], "owner": {"reputation": 3312, "user_id": 4175960, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QbvYc.png?s=128&g=1", "display_name": "Eddy Hernandez", "link": "https://stackoverflow.com/users/4175960/eddy-hernandez"}, "is_accepted": false, "score": 6, "last_activity_date": 1460147013, "creation_date": 1460147013, "answer_id": 36508686, "question_id": 28150077, "link": "https://stackoverflow.com/questions/28150077/where-are-the-drone-logs-stored/36508686#36508686", "title": "Where are the drone logs stored?", "body": "<p>You can see the log of your container as follow:</p>\n\n<p>Go to the server where drone.io is running, and view the id of the container</p>\n\n<pre><code>docker ps -a\n</code></pre>\n\n<p>To view the log of your container.</p>\n\n<pre><code>docker logs -f CONTAINER-ID\n</code></pre>\n\n<p>see the docker documentation for more info.\n<a href=\"https://docs.docker.com/engine/reference/commandline/logs/\" rel=\"noreferrer\">https://docs.docker.com/engine/reference/commandline/logs/</a></p>\n"}], "owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2684, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1460147013, "creation_date": 1422275040, "last_edit_date": 1422275760, "question_id": 28150077, "link": "https://stackoverflow.com/questions/28150077/where-are-the-drone-logs-stored", "title": "Where are the drone logs stored?", "body": "<p>I'm trying install and configure <a href=\"https://github.com/drone/drone\" rel=\"nofollow\">drone.io</a>  on my server following some <a href=\"https://www.digitalocean.com/community/tutorials/how-to-perform-continuous-integration-testing-with-drone-io-on-coreos-and-docker\" rel=\"nofollow\">tutorials</a> from digital ocean . However when I try to authorize my account (xxx.xxx.:8080/login ) I get a blank webpage which throws with  http 400 status code, The final url that I'm redirected to looks like this: <code>xxx.xxx.xxx.xxx:8080/api/auth/github.com?code=28c9ea949a200523edasdaae&amp;state=V5dsadaKLDQC4MASSMFUH2MLF5ZVSNCWNOIDEQ7JSVR4HLAW7EMGX4NJA%3D%3D%3D%3D</code>.</p>\n\n<p>How can I debug why this is failing? I've successfully logged into the drone but I don't know where the logs are stored. I've checked /var/log but couldn't find anything related to drone. </p>\n\n<p>Digging though the <a href=\"https://github.com/drone/drone/blob/master/server/handler/repo.go\" rel=\"nofollow\">code</a> I've found something I can't believe. Are the all errors just ignored?  </p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1422275256, "post_id": 28149682, "comment_id": 44671375, "body": "Why do you have defer func() { sess.Close } and not just defer sess.Close() ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1422281600, "post_id": 28149682, "comment_id": 44674756, "body": "it helps to always think of it as &quot;sender closes&quot;. Even if that doesn&#39;t happen directly, the sender[s] always needs to initiate the close."}, {"owner": {"reputation": 1456, "user_id": 1784595, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KoQV5.png?s=128&g=1", "display_name": "frank.lin", "link": "https://stackoverflow.com/users/1784595/frank-lin"}, "edited": false, "score": 0, "creation_date": 1422324182, "post_id": 28149682, "comment_id": 44695325, "body": "it is difficault to do as &quot;sender closes&quot;,   because I need deal the rest message in <code>recvChan</code> in <code>handleDispatch</code> .If I close it in <code>handleRecv</code> , <code>handleDispatch</code> may be blocked for several seconds.In my case, <code>handleRecv</code> exits later than <code>handleDispatch</code> sometimes, maybe  several seconds when there are many connnections."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1422281203, "post_id": 28149974, "comment_id": 44674506, "body": "A receive operation will always succeed on a closed chan, and you can still receive all items in a closed, buffered chan."}, {"owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1422281308, "post_id": 28149974, "comment_id": 44674579, "body": "Oh, I didn&#39;t realize the second part. Thanks."}], "tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": false, "score": 0, "last_activity_date": 1422274649, "creation_date": 1422274649, "answer_id": 28149974, "question_id": 28149682, "link": "https://stackoverflow.com/questions/28149682/how-can-i-close-the-channel-elegantly/28149974#28149974", "title": "How can I close the channel elegantly?", "body": "<p>Channels synchronize goroutines via sending, but <code>close</code> on them isn't synchronized itself. What if you close a channel at the same time another goroutine was sending something through it?</p>\n\n<p>You should have another channel through which <code>handleDispatch</code> notifies the \"owner\" (ie. the writer) of <code>sess.recvChan</code>, namely <code>handleRecv</code>, that it wants to close the channel. Then <code>handleRecv</code> should stop sending from it and close it.</p>\n\n<p>Apart from that: I don't understand the line next to <code>#2</code>: <code>for msg := range sess.recvChan {</code> What are you trying to get there from <code>sess.recvChan</code>, if you just closed it?</p>\n"}], "owner": {"reputation": 1456, "user_id": 1784595, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KoQV5.png?s=128&g=1", "display_name": "frank.lin", "link": "https://stackoverflow.com/users/1784595/frank-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 527, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1422274649, "creation_date": 1422273463, "question_id": 28149682, "link": "https://stackoverflow.com/questions/28149682/how-can-i-close-the-channel-elegantly", "title": "How can I close the channel elegantly?", "body": "<p>I have a server , which deal the connection <code>Session</code> like this </p>\n\n<pre><code>type Session struct {\n    conn *net.TCPConn //the tcp connection from client\n    recvChan      chan []byte\n    closeNotiChan chan bool \n    ok   bool\n    lock sync.Mutex\n}\n\nfunc (sess *Session) Close() {\n    sess.conn.Close()\n    sess.lock.Lock()\n    if sess.ok {\n        sess.ok = false\n        close(sess.closeNotiChan)\n    }\n    sess.lock.Unlock()\n}\n\nfunc (sess *Session) handleRecv() {\n    defer func() {\n        sess.Close()\n    }()\n    ch := sess.recvChan\n    header := make([]byte, 2) \n    for {\n        /**block until recieve len(header)**/\n        n, err := io.ReadFull(sess.conn, header)\n        if n == 0 &amp;&amp; err == io.EOF {\n            //Opposite socket is closed\n            log.Warn(\"Socket Read EOF And Close\", sess)\n            break\n        } else if err != nil {\n            //Sth wrong with this socket\n            log.Warn(\"Socket Wrong:\", err)\n            break\n        }\n        //body lenght\n        size := binary.LittleEndian.Uint16(header) + 4\n\n        data := make([]byte, size)\n\n        n, err = io.ReadFull(sess.conn, t.Data)\n        if n == 0 &amp;&amp; err == io.EOF {\n            log.Warn(\"Socket Read EOF And Close\", sess)\n            break\n        } else if err != nil {\n            log.Warn(\"Socket Wrong:\", err)\n            break\n        }\n        ch &lt;- t //#1\n    }\n}\n\nfunc (sess *Session) handleDispatch() {\n    defer func() {\n        sess.Close()\n        close(sess.recvChan)//#2\n        for msg := range sess.recvChan {\n            //do something \n        }\n    }()\n    for {\n        select {\n        case msg, ok := &lt;-sess.recvChan:\n            if ok {\n                //do something\n            }\n        case &lt;-sess.closeNotiChan:\n            return\n        }\n    }\n}\n\nfunc StartClient() {//deal a new connection \n    var client Session\n    client.conn = connection\n    client.recvChan = make(chan []byte, 64)\n    client.closeNotiChan = make(chan bool)\n    client.ok = true\n    go client.handleRecv()\n    client.handleDispatch()\n}\n</code></pre>\n\n<p>receiving data and dispatching data are in different goroutines.Now I have a problem. When a connection close,there is a data race ,<code>#1</code> and <code>#2</code> ,something like the following(I don't post complete code)</p>\n\n<pre><code>WARNING: DATA RACE\nWrite by goroutine 179:\n  runtime.closechan()\n      /usr/local/go/src/runtime/chan.go:257 +0x0\n  sanguo/gameserver.func\u00b7004()\n      /data/mygo/src/sanguo/gameserver/session.go:149 +0xc7\n  sanguo/gameserver.(*Session).handleDispatch()\n      /data/mygo/src/sanguo/gameserver/session.go:173 +0x413\n  sanguo/gameserver.(*Session).Start()\n      /data/mygo/src/sanguo/gameserver/session.go:223 +0xc6\n  sanguo/gameserver.handleClient()\n      /data/mygo/src/sanguo/gameserver/gameserver.go:79 +0x43\n\nPrevious read by goroutine 126:\n  runtime.chansend()\n      /usr/local/go/src/runtime/chan.go:83 +0x0\n  sanguo/gameserver.(*Session).handleRecv()\n      /data/mygo/src/sanguo/gameserver/session.go:140 +0x1171\n</code></pre>\n\n<p>So, My problem is that how can I close the <code>recvChan</code> elegently and effectively  ,without \"data race\" and <code>panic</code>.</p>\n"}, {"tags": ["linux", "unix", "go", "signals"], "comments": [{"owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "edited": false, "score": 0, "creation_date": 1422271682, "post_id": 28149165, "comment_id": 44669688, "body": "to find the PID running <code>ps aux | grep go</code>"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1422272739, "post_id": 28149165, "comment_id": 44670205, "body": "Your program works for me. Please specify what behaviour you were expecting."}], "answers": [{"tags": [], "owner": {"reputation": 11326, "user_id": 2328763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849491de0be9b3cdf39c96b4c6b32e2b?s=128&d=identicon&r=PG", "display_name": "Alper", "link": "https://stackoverflow.com/users/2328763/alper"}, "is_accepted": true, "score": 1, "last_activity_date": 1422273071, "last_edit_date": 1422273071, "creation_date": 1422272699, "answer_id": 28149472, "question_id": 28149165, "link": "https://stackoverflow.com/questions/28149165/go-app-cannot-catch-signals/28149472#28149472", "title": "Go app cannot catch signals", "body": "<p><code>func()</code> is terminated after receiving the first signal, I think <code>CTLR+C</code> was the first one when you try. It works when it is wrapped in a loop.</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n   \"os\"\n   \"os/signal\"\n)\n\nfunc main() {\n    sigs := make(chan os.Signal, 1)\n    done := make(chan bool, 1)\n    signal.Notify(sigs)\n    go func() {\n        for {\n            sig := &lt;-sigs\n            fmt.Println(sig)\n        }\n    }()\n    fmt.Println(\"waiting\")\n    &lt;-done\n    fmt.Println(\"exiting\")\n}\n</code></pre>\n\n<p>Tested with;</p>\n\n<pre><code>$ kill -15 &lt;pid&gt;\n$ kill -2 &lt;pid&gt;\n$ kill -10 &lt;pid&gt;\n$ kill -1 &lt;pid&gt;\n$ kill -10 &lt;pid&gt;\n\n$ ./signal \nwaiting\nterminated\ninterrupt\nuser defined signal 1\nhangup\nuser defined signal 1\n</code></pre>\n"}], "owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 28149472, "answer_count": 1, "score": 3, "last_activity_date": 1422273071, "creation_date": 1422271452, "question_id": 28149165, "link": "https://stackoverflow.com/questions/28149165/go-app-cannot-catch-signals", "title": "Go app cannot catch signals", "body": "<p>Sending signals from kill on linux,\n<code>kill -s 2 &lt;PID&gt;</code> or <code>kill -s 15 &lt;PID&gt;</code></p>\n\n<p>The code is:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n   \"os\"\n   \"os/signal\"\n)\n\nfunc main() {\n    sigs := make(chan os.Signal, 1)\n    done := make(chan bool, 1)\n    signal.Notify(sigs)\n    go func() {\n        sig := &lt;-sigs\n        fmt.Println(sig)\n    }()\n    fmt.Println(\"waiting\")\n    &lt;-done\n    fmt.Println(\"exiting\")\n}\n</code></pre>\n\n<p>The program does not handle signals,\nonly <code>CTRL+C</code> works well.</p>\n"}, {"tags": ["python", "logging", "go"], "comments": [{"owner": {"reputation": 9683, "user_id": 4076764, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c214b9830295015777d8c6cbc8462b4f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Hughes", "link": "https://stackoverflow.com/users/4076764/adam-hughes"}, "edited": false, "score": 0, "creation_date": 1422257025, "post_id": 28146023, "comment_id": 44663806, "body": "Python has a logging library, but if you already have the logs and just need to store them, what did you have in mind specifically?"}, {"owner": {"reputation": 509, "user_id": 2142567, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ed49628e944bcf0a72076be83b688139?s=128&d=identicon&r=PG", "display_name": "Tarzan", "link": "https://stackoverflow.com/users/2142567/tarzan"}, "reply_to_user": {"reputation": 9683, "user_id": 4076764, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c214b9830295015777d8c6cbc8462b4f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Hughes", "link": "https://stackoverflow.com/users/4076764/adam-hughes"}, "edited": false, "score": 0, "creation_date": 1422257199, "post_id": 28146023, "comment_id": 44663854, "body": "Our services are written in some languages (PHP, Python, ...). Our need is not only store python&#39;s log but also store other logs like user&#39;s activity, product&#39;s information changing, api request/response log, ... etc. That&#39;s why we need namespace and tagging."}, {"owner": {"reputation": 814, "user_id": 4474211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf24f2226878c4c08d709a6efd3355f?s=128&d=identicon&r=PG", "display_name": "tmichel", "link": "https://stackoverflow.com/users/4474211/tmichel"}, "edited": false, "score": 1, "creation_date": 1422259676, "post_id": 28146023, "comment_id": 44664581, "body": "Have you looked at <a href=\"http://logstash.net/\" rel=\"nofollow noreferrer\">logstash</a>?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1422260073, "post_id": 28146023, "comment_id": 44664710, "body": "<a href=\"http://www.elasticsearch.org/overview/kibana/\" rel=\"nofollow noreferrer\">elasticsearch.org/overview/kibana</a>"}, {"owner": {"reputation": 509, "user_id": 2142567, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ed49628e944bcf0a72076be83b688139?s=128&d=identicon&r=PG", "display_name": "Tarzan", "link": "https://stackoverflow.com/users/2142567/tarzan"}, "edited": false, "score": 0, "creation_date": 1422265535, "post_id": 28146023, "comment_id": 44666911, "body": "Thank you, we will take try those solutions. However, for the first look, we are aware about elasticsearch&#39;s memory consumption."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1422267961, "post_id": 28146023, "comment_id": 44668064, "body": "@Tarzan where I work we&#39;re using Kibana for a very large volume of logs and it works great.  Logs are aggregated using Scribe and then pushed to Kibana for indexing. Works like a charm. BTW a commercial solution to look at would be Splunk, but personally I don&#39;t like it so much."}], "answers": [{"comments": [{"owner": {"reputation": 509, "user_id": 2142567, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ed49628e944bcf0a72076be83b688139?s=128&d=identicon&r=PG", "display_name": "Tarzan", "link": "https://stackoverflow.com/users/2142567/tarzan"}, "edited": false, "score": 0, "creation_date": 1422496946, "post_id": 28165652, "comment_id": 44777199, "body": "Thank you, we are going to deploy Graylogs. We are almost satisfied  when looking at Graylogs&#39; features."}], "tags": [], "owner": {"reputation": 26, "user_id": 2408967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53a9f71d3096f8fe26bd5e3c9ba25d4c?s=128&d=identicon&r=PG", "display_name": "vmintam", "link": "https://stackoverflow.com/users/2408967/vmintam"}, "is_accepted": true, "score": 1, "last_activity_date": 1422345363, "creation_date": 1422345363, "answer_id": 28165652, "question_id": 28146023, "link": "https://stackoverflow.com/questions/28146023/logging-storage-with-web-backend/28165652#28165652", "title": "Logging storage with web backend", "body": "<p>in my opinion, i will analytic some opensource system for log that i know:</p>\n\n<ol>\n<li><p>logstash : you need kibana or any the same for web interface. logstash can push log from file with RFC log system format. You can use Logstash Forwarder for send log from logstash client to logstash server, too. but with log of applications that you want push to logstash server is very complex.</p></li>\n<li><p>Scribe: i think that Scribe do not longer support by facebook. it is very old.</p></li>\n<li><p><a href=\"http://graylog2.org\" rel=\"nofollow\">Graylogs</a> : Full stack for log central with interface, filter, input, ouput. we can push message log from any applications to API of graylog server very easy. but gray log can't read log from file :) .</p></li>\n</ol>\n"}], "owner": {"reputation": 509, "user_id": 2142567, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ed49628e944bcf0a72076be83b688139?s=128&d=identicon&r=PG", "display_name": "Tarzan", "link": "https://stackoverflow.com/users/2142567/tarzan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 28165652, "answer_count": 1, "score": -1, "last_activity_date": 1422345363, "creation_date": 1422256605, "question_id": 28146023, "link": "https://stackoverflow.com/questions/28146023/logging-storage-with-web-backend", "title": "Logging storage with web backend", "body": "<p>We need to store our logs from some services, each log has its level, namespace (maybe dotted namespace), tags (as a list), timestamp (when the log created) and its content (as a text).</p>\n\n<p>We also need a web backend with ability to show/search/filter the log with its level, namespace, tag.</p>\n\n<p>Is there an open-source system for that? I prefer Go or Python language. If not, what is the best solution for us?</p>\n\n<p><em>I do not know is this question legal or not for stackoverflow. I am just asking about a open-source solution.</em></p>\n\n<p>Thank you for reading this,</p>\n"}, {"tags": ["variables", "go"], "comments": [{"owner": {"reputation": 1759, "user_id": 1512962, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/EfW0L.png?s=128&g=1", "display_name": "Anonymous Penguin", "link": "https://stackoverflow.com/users/1512962/anonymous-penguin"}, "edited": false, "score": 0, "creation_date": 1422230168, "post_id": 28142771, "comment_id": 44657664, "body": "After a little more research I saw <a href=\"http://www.veracode.com/blog/2013/12/golangs-context-aware-html-templates\" rel=\"nofollow noreferrer\">this</a>, although I still don&#39;t understand exactly what it&#39;s doing."}, {"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1422238655, "post_id": 28142771, "comment_id": 44659638, "body": "To get background on context-aware HTML templating, read: <a href=\"http://js-quasis-libraries-and-repl.googlecode.com/svn/trunk/safetemplate.html#problem_definition\" rel=\"nofollow noreferrer\">js-quasis-libraries-and-repl.googlecode.com/svn/trunk/&hellip;</a> and <a href=\"http://googleonlinesecurity.blogspot.com/2009/03/reducing-xss-by-way-of-automatic.html\" rel=\"nofollow noreferrer\">googleonlinesecurity.blogspot.com/2009/03/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 4, "last_activity_date": 1422231616, "creation_date": 1422231616, "answer_id": 28143184, "question_id": 28142771, "link": "https://stackoverflow.com/questions/28142771/what-are-context-aware-variables/28143184#28143184", "title": "What are context aware variables?", "body": "<p>The <a href=\"http://golang.org/pkg/html/template/\" rel=\"nofollow\">html/template</a> package is context aware.</p>\n\n<blockquote>\n  <p>This package understands HTML, CSS, JavaScript, and URIs. It adds sanitizing functions to each simple action pipeline</p>\n</blockquote>\n\n<p>So if you have variable <code>Foo</code> that contains <code>&lt;script&gt;alert('you have been pwned')&lt;/script&gt;</code> and you print it inside an html element <code>&lt;p&gt;{{.Foo}}&lt;/p&gt;</code> Foo will be properly escaped to avoid script injection.</p>\n\n<p>When using <code>html/template</code> you have to add explicet types to your variables if you want to override when escaping should happen.</p>\n\n<p>Here is an <a href=\"http://play.golang.org/p/BjRNvEJwzZ\" rel=\"nofollow\">example</a></p>\n"}], "owner": {"reputation": 1759, "user_id": 1512962, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/EfW0L.png?s=128&g=1", "display_name": "Anonymous Penguin", "link": "https://stackoverflow.com/users/1512962/anonymous-penguin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 1, "accepted_answer_id": 28143184, "answer_count": 1, "score": 1, "last_activity_date": 1422231616, "creation_date": 1422228092, "question_id": 28142771, "link": "https://stackoverflow.com/questions/28142771/what-are-context-aware-variables", "title": "What are context aware variables?", "body": "<p>I heard someone talking about how Go has a good implementation of \"context aware variables\" when working with HTML. What are they and how do they work?</p>\n\n<p>I'm guessing since it was related to security that it's some sort of variable that knows if it has been sanitized or not. Is it something like a class called <code>unsanitizedString</code> where it automatically sanitizes the contents when casting to a normal string?</p>\n"}, {"tags": ["go", "ports"], "comments": [{"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 1, "creation_date": 1422222206, "post_id": 28141776, "comment_id": 44655325, "body": "Possibly because port 8081 remains in TIME_WAIT after the connection is closed. I&#39;ve tried to run your programs and I&#39;m not having any problem, I can run it sequentially."}, {"owner": {"reputation": 89, "user_id": 1813460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a98a741844f16548bac23f24cc2d4a?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/1813460/jason"}, "reply_to_user": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1422223286, "post_id": 28141776, "comment_id": 44655665, "body": "Thanks @siritinga. <a href=\"http://www4.cs.fau.de/Projects/JX/Projects/TCP/tcpstate.html\" rel=\"nofollow noreferrer\">www4.cs.fau.de/Projects/JX/Projects/TCP/tcpstate.html</a>"}, {"owner": {"reputation": 89, "user_id": 1813460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a98a741844f16548bac23f24cc2d4a?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/1813460/jason"}, "reply_to_user": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1422223640, "post_id": 28141776, "comment_id": 44655799, "body": "If that is the case I don&#39;t know why netstat says it is in the SYN_SENT state and why the delay is not triggered for all requests, but it could lead somewhere."}, {"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1422223741, "post_id": 28141776, "comment_id": 44655829, "body": "I don&#39;t know either. And I&#39;m having no problems in my computer (Ubuntu 14.04), maybe the default TCP stack is configured differently."}, {"owner": {"reputation": 259, "user_id": 211769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67fae53ce6128f445a68f9f3d8c059be?s=128&d=identicon&r=PG", "display_name": "BeMasher", "link": "https://stackoverflow.com/users/211769/bemasher"}, "edited": false, "score": 0, "creation_date": 1423289537, "post_id": 28141776, "comment_id": 45098003, "body": "Can&#39;t reproduce the problem on my system (go1.4 windows/amd64)."}], "answers": [{"tags": [], "owner": {"reputation": 2854, "user_id": 41292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/939e50606775eea4b7589dd7aebbd8b3?s=128&d=identicon&r=PG", "display_name": "LenW", "link": "https://stackoverflow.com/users/41292/lenw"}, "is_accepted": true, "score": 0, "last_activity_date": 1434991375, "creation_date": 1434991375, "answer_id": 30985411, "question_id": 28141776, "link": "https://stackoverflow.com/questions/28141776/why-does-the-client-hang-when-the-local-port-is-specified/30985411#30985411", "title": "Why does the client hang when the local port is specified?", "body": "<p>I can reproduce that error. AFAICS it has to do with the TCP closing sequence, see this - <a href=\"http://www.tcpipguide.com/free/t_TCPConnectionTermination-4.htm\" rel=\"nofollow\">http://www.tcpipguide.com/free/t_TCPConnectionTermination-4.htm</a></p>\n\n<p>On OS X you can mess with the tcp MSL like this </p>\n\n<pre><code>sudo sysctl net.inet.tcp.msl=100\n</code></pre>\n\n<p>So a modified client </p>\n\n<pre><code>// client.go\npackage main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"net\"\n    \"os\"\n    \"time\"\n)\n\nfunc check() {\n    d := net.Dialer{\n        LocalAddr: &amp;net.TCPAddr{\n            Port: 8081,\n        },\n    }\n\n    // Dial the server from client port 8081 to server port 8080\n    conn, err := d.Dial(\"tcp\", \":8080\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // Request the resource and log the response\n    fmt.Fprint(conn, \"GET /server.go HTTP/1.0\\r\\n\\r\\n\")\n    io.Copy(os.Stdout, conn)\n    conn.Close()\n}\n\n// sudo sysctl net.inet.tcp.msl=100\nfunc main() {\n\n    count := 0\n    for {\n        fmt.Printf(\"Try num %d\\n\", count)\n        count++\n        check()\n        time.Sleep(200 * time.Millisecond)\n    }\n}\n</code></pre>\n\n<p>See <a href=\"https://en.wikipedia.org/wiki/Maximum_segment_lifetime\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Maximum_segment_lifetime</a></p>\n"}], "owner": {"reputation": 89, "user_id": 1813460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a98a741844f16548bac23f24cc2d4a?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/1813460/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 30985411, "answer_count": 1, "score": 1, "last_activity_date": 1434991375, "creation_date": 1422221528, "question_id": 28141776, "link": "https://stackoverflow.com/questions/28141776/why-does-the-client-hang-when-the-local-port-is-specified", "title": "Why does the client hang when the local port is specified?", "body": "<p>This is related to a homework assignment that must be submitted in Java. The program works as expected printing the contents of server.go to the terminal. Why does the client hang for 30 seconds after two or more sequential runs?</p>\n\n<p>The delay only occurs when the client port is specified (related to the assignment).</p>\n\n<pre><code>// server.go\npackage main\n\nimport (\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    log.Fatal(http.ListenAndServe(\":8080\", http.FileServer(http.Dir(\".\"))))\n}\n</code></pre>\n\n<p>I'd expect the delay to be a timeout waiting for the connection to close if it were not for defer conn.Close() and the client running only after the previous client returned.</p>\n\n<pre><code>// client.go\npackage main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"net\"\n    \"os\"\n)\n\nfunc main() {\n    d := net.Dialer{\n        LocalAddr: &amp;net.TCPAddr{\n            Port: 8081,\n        },\n    }\n\n    // Dial the server from client port 8081 to server port 8080\n    conn, err := d.Dial(\"tcp\", \":8080\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer conn.Close()\n\n    // Request the resource and log the response\n    fmt.Fprint(conn, \"GET /server.go HTTP/1.0\\r\\n\\r\\n\")\n    io.Copy(os.Stdout, conn)\n}\n</code></pre>\n\n<p>Output of netstat during a delay:</p>\n\n<pre><code>$ netstat -anp tcp | grep \"8080\\|8081\"\ntcp4       0      0  127.0.0.1.8081         127.0.0.1.8080         SYN_SENT   \ntcp46      0      0  *.8080                 *.*                    LISTEN    \n</code></pre>\n"}, {"tags": ["go", "connection-pooling"], "comments": [{"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1422240005, "post_id": 28141316, "comment_id": 44659889, "body": "You can look at how the <code>DefaultTransport</code> is constructed, near the documentation of RoundTripper: <a href=\"http://golang.org/pkg/net/http/#RoundTripper\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#RoundTripper</a>.  Note how the <code>Dial</code> function is the component that does the connection creation.  A <code>Dial</code> function itself returns a <code>Conn</code> (<a href=\"http://golang.org/pkg/net/#Dial\" rel=\"nofollow noreferrer\">golang.org/pkg/net/#Dial</a>).  Judicious use of delegation should let you keep track whenever a <code>Dial</code> is happening and when a corresponding <code>Conn.Close()</code> is performed."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1422254454, "post_id": 28141316, "comment_id": 44663159, "body": "Just speaking generally, you could also look at what syscalls your program is making or what it has open with general OS tools (<code>strace</code>, <code>netstat -ap</code>, etc.)--<a href=\"http://jvns.ca/blog/2014/04/20/debug-your-programs-like-theyre-closed-source/\" rel=\"nofollow noreferrer\">Julia Evans wrote about this a while back</a>."}, {"owner": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1422294626, "post_id": 28141316, "comment_id": 44682748, "body": "Unlike forum sites, we don&#39;t use &quot;Thanks&quot;, or &quot;Any help appreciated&quot;, or signatures on <a href=\"https://stackoverflow.com\">Stack Overflow</a>. See &quot;<a href=\"http://meta.stackexchange.com/questions/2950/should-hi-thanks-taglines-and-salutations-be-removed-from-posts\">Should &#39;Hi&#39;, &#39;thanks,&#39; taglines, and salutations be removed from posts?</a>. BTW, it&#39;s &quot;Thanks in advance&quot;, not &quot;Thanks in advanced&quot;."}], "owner": {"reputation": 1153, "user_id": 1371064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NnrmE.jpg?s=128&g=1", "display_name": "Carlos Andr&#233;s Garc&#237;a", "link": "https://stackoverflow.com/users/1371064/carlos-andr%c3%a9s-garc%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1422294614, "creation_date": 1422218913, "last_edit_date": 1422294614, "question_id": 28141316, "link": "https://stackoverflow.com/questions/28141316/how-many-connections-are-created-and-reused-by-golang", "title": "How many connections are created and reused by Golang", "body": "<p>Anybody knows how can I test the numbers of connections that transport is currently creating on the pool of the connections, it is clear that in the code I have put MaxIdleConnsPerHost: 5 like number maximum of connections on the pool and DisableKeepAlives: false like the option which let to reuse the connection\n but I do not sure about how Go is managed this topic and the documentation is not clear <a href=\"http://golang.org/src/net/http/transport.go\" rel=\"nofollow\">Source-code-transport.go</a> , <a href=\"http://golang.org/pkg/net/http/\" rel=\"nofollow\">Documentation-net/http</a></p>\n\n<p><a href=\"http://play.golang.org/p/bvdiS0HFJS\" rel=\"nofollow\">Server</a> is a example of a server that receive a XML and send the same XML like response with an attribute more.</p>\n\n<p><a href=\"http://play.golang.org/p/B0o6teNktF\" rel=\"nofollow\">Client</a> is the code that has the configuration of the pool and send 100 request to server.</p>\n"}, {"tags": ["go", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1422215667, "post_id": 28140677, "comment_id": 44653172, "body": "Thanks for the answer, but is your code that similar to mine, I am creating three different threads, while you are creating just one. Am I missing something?"}], "tags": [], "owner": {"reputation": 2166, "user_id": 3103130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uwRyn.jpg?s=128&g=1", "display_name": "Innominate", "link": "https://stackoverflow.com/users/3103130/innominate"}, "is_accepted": false, "score": 2, "last_activity_date": 1422214859, "creation_date": 1422214859, "answer_id": 28140677, "question_id": 28140496, "link": "https://stackoverflow.com/questions/28140496/deadlock-after-attempting-to-print-values-of-channel-using-range/28140677#28140677", "title": "Deadlock after attempting to print values of channel using &#39;range&#39;", "body": "<p>When you use <code>range</code> on a channel, it will wait for values forever or until the channel is closed. It's deadlocking because when the last value is written to my_channel, it will wait forever for a value that will never come.</p>\n\n<p>Here's a slightly modified variant that shows how to cleanly leave the range: <a href=\"https://play.golang.org/p/YDlM8EcRnx\" rel=\"nofollow\">https://play.golang.org/p/YDlM8EcRnx</a></p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1422214954, "creation_date": 1422214954, "answer_id": 28140690, "question_id": 28140496, "link": "https://stackoverflow.com/questions/28140496/deadlock-after-attempting-to-print-values-of-channel-using-range/28140690#28140690", "title": "Deadlock after attempting to print values of channel using &#39;range&#39;", "body": "<p><code>for range chan</code> exit when chan receive close signal. You must <code>close(my_channel)</code> somewhere, or loop will wait forever.</p>\n"}, {"tags": [], "owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "is_accepted": true, "score": 3, "last_activity_date": 1422218172, "creation_date": 1422218172, "answer_id": 28141169, "question_id": 28140496, "link": "https://stackoverflow.com/questions/28140496/deadlock-after-attempting-to-print-values-of-channel-using-range/28141169#28141169", "title": "Deadlock after attempting to print values of channel using &#39;range&#39;", "body": "<p>A for-range on a empty channel will block until there are elements to read from the channel or until the channel is closed.</p>\n\n<p>Here is a version that uses <code>sync.WaitGroup</code> to account for how many goroutines remain active. After all goroutines have finished, the channel is closed and the for-range loop exists.</p>\n\n<p><a href=\"https://play.golang.org/p/ZnLYxLMNdF\" rel=\"nofollow\">https://play.golang.org/p/ZnLYxLMNdF</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc sum_up(my_int int, cs chan int, wg *sync.WaitGroup) {\n    my_sum := 0\n    for i := 0; i &lt; my_int; i++ {\n        my_sum += i\n    }\n    cs &lt;- my_sum\n    wg.Done()\n}\n\nfunc main() {\n    wg := &amp;sync.WaitGroup{}\n    my_channel := make(chan int)\n    for i := 2; i &lt; 5; i++ {\n        wg.Add(1)\n        go sum_up(i, my_channel, wg)\n    }\n\n    // Run a goroutine that will monitor how many sum_up are running.\n    go func(cs chan int, wg *sync.WaitGroup) {\n        wg.Wait()\n        close(cs)\n    }(my_channel, wg)\n\n    for ele := range my_channel {\n        fmt.Println(ele)\n    }\n\n    //fatal error: all goroutines are asleep - deadlock!\n\n    fmt.Println(\"Done\")\n\n}\n</code></pre>\n"}], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 28141169, "answer_count": 3, "score": 1, "last_activity_date": 1422288061, "creation_date": 1422213933, "last_edit_date": 1422288061, "question_id": 28140496, "link": "https://stackoverflow.com/questions/28140496/deadlock-after-attempting-to-print-values-of-channel-using-range", "title": "Deadlock after attempting to print values of channel using &#39;range&#39;", "body": "<p>Here is my code at <a href=\"https://play.golang.org/p/npkyBF0ClP\" rel=\"nofollow\">Go Playground</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc sum_up(my_int int, cs chan int) {\n    my_sum := 0\n    for i := 0; i &lt; my_int; i++ {\n        my_sum += i\n    }\n    cs &lt;- my_sum\n}\n\nfunc main() {\n\n    my_channel := make(chan int)\n    for i := 2; i &lt; 5; i++ { \n        go sum_up(i, my_channel)\n    }\n\n\n    for ele := range my_channel {\n        fmt.Println(ele)\n    }  \n\n    //fatal error: all goroutines are asleep - deadlock!\n\n    fmt.Println(\"Done\")\n\n}\n</code></pre>\n\n<p>Which results in:</p>\n\n<pre><code>1\n3\n6\nfatal error: all goroutines are asleep - deadlock!\n</code></pre>\n\n<p>And I don't understand what causes the error. My understanding is that in my function <code>sum_up</code> I am adding new values to <code>my_channel</code>. Why does the problem occur after I try to print out the values? Since I see 1,3,6 are printed it means that all <code>goroutines</code> have successfully finished.</p>\n\n<p>Moreover, if the block that attempts to print the values of the channel</p>\n\n<pre><code>    for ele := range my_channel {\n        fmt.Println(ele)\n    }\n</code></pre>\n\n<p>Is removed, then I don't get the error. So it is including the block that causes the error, but why?</p>\n"}, {"tags": ["ajax", "go"], "answers": [{"comments": [{"owner": {"reputation": 970, "user_id": 2807904, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/74cf72489d0114349f7c5e0966ba6e05?s=128&d=identicon&r=PG&f=1", "display_name": "irregular", "link": "https://stackoverflow.com/users/2807904/irregular"}, "edited": false, "score": 0, "creation_date": 1422213910, "post_id": 28139478, "comment_id": 44652527, "body": "The js function does send to the posthandler now and now the url changes to localhost:8888/post but the page is blank. How can I get the client to say on the same page with only the div id=&quot;fromserver&quot; changing with the data from the ajax call? Also if I were to use jquery which has a lot of files would I need to use the singleServe() for every file?"}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1422222443, "post_id": 28139478, "comment_id": 44655408, "body": "For jquery You could add an hadler which serves all the files in given dir, something like <code>http.Handle(&quot;&#47;jquery&quot;, http.FileServer(http.Dir(&quot;&#47;path&#47;to&#47;jquery&quot;)))</code>"}, {"owner": {"reputation": 7376, "user_id": 2171928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a2dc8a6d4e15c61451d70f695ac18ae9?s=128&d=identicon&r=PG", "display_name": "Kishore Vaishnav", "link": "https://stackoverflow.com/users/2171928/kishore-vaishnav"}, "reply_to_user": {"reputation": 970, "user_id": 2807904, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/74cf72489d0114349f7c5e0966ba6e05?s=128&d=identicon&r=PG&f=1", "display_name": "irregular", "link": "https://stackoverflow.com/users/2807904/irregular"}, "edited": false, "score": 0, "creation_date": 1422228991, "post_id": 28139478, "comment_id": 44657377, "body": "@user2807904, based on your initial question, I assumed you needed to make it work and understand yourself what is wrong. Anyway read this <a href=\"http://stackoverflow.com/a/14086560/2171928\">link</a> to understand how you can render static assets."}], "tags": [], "owner": {"reputation": 7376, "user_id": 2171928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a2dc8a6d4e15c61451d70f695ac18ae9?s=128&d=identicon&r=PG", "display_name": "Kishore Vaishnav", "link": "https://stackoverflow.com/users/2171928/kishore-vaishnav"}, "is_accepted": true, "score": -1, "last_activity_date": 1422208090, "creation_date": 1422208090, "answer_id": 28139478, "question_id": 28138952, "link": "https://stackoverflow.com/questions/28138952/ajax-request-not-sending-to-go-web-server/28139478#28139478", "title": "Ajax Request not sending to Go web server", "body": "<p>There are two things:</p>\n\n<ul>\n<li>No handler present to render assest (in this case js/<em>.</em>)</li>\n<li>Form by itself get submitted due to \"submit\" HTML element.</li>\n</ul>\n\n<p>here is your updated code</p>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n)\n\nvar INDEX_HTML []byte\n\nfunc main() {\n    fmt.Println(\"starting server on http://localhost:8888/\\nvalue is %s\", \"asdf\")\n    http.HandleFunc(\"/\", IndexHandler)\n    http.HandleFunc(\"/post\", PostHandler)\n    serveSingle(\"/js/getData.js\", \"./js/getData.js\")\n    http.ListenAndServe(\":8888\", nil)\n}\n\nfunc serveSingle(pattern string, filename string) {\n    http.HandleFunc(pattern, func(w http.ResponseWriter, r *http.Request) {\n        http.ServeFile(w, r, filename)\n    })\n}\n\nfunc IndexHandler(w http.ResponseWriter, r *http.Request) {\n    log.Println(\"GET /\")\n    w.Write(INDEX_HTML)\n}\n\nfunc PostHandler(w http.ResponseWriter, r *http.Request) {\n    r.ParseForm()\n    log.Println(\"in posthandler\", r.Form)\n    var value = r.FormValue(\"textfield\")\n    w.Write([]byte(value))\n}\nfunc init() {\n    INDEX_HTML, _ = ioutil.ReadFile(\"./html/index.html\")\n}\n</code></pre>\n\n<p>index.html</p>\n\n<pre><code>&lt;!doctype html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;Page Title&lt;/title&gt;\n  &lt;script src=\"js/getData.js\"&gt;&lt;/script&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;form action=\"/post\" method=\"post\"&gt;\n      &lt;textarea type=\"text\" name=\"input\" id=\"textfield\"&gt;&lt;/textarea&gt;\n      &lt;br /&gt;\n      &lt;input type=\"button\" name=\"button\" id=\"button\" value=\"Send\" onclick=\"loadXMLDoc()\"/&gt;\n    &lt;/form&gt;\n    &lt;div id=\"fromserver\"&gt;\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}], "owner": {"reputation": 970, "user_id": 2807904, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/74cf72489d0114349f7c5e0966ba6e05?s=128&d=identicon&r=PG&f=1", "display_name": "irregular", "link": "https://stackoverflow.com/users/2807904/irregular"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 967, "favorite_count": 0, "accepted_answer_id": 28139478, "answer_count": 1, "score": 0, "last_activity_date": 1422208090, "creation_date": 1422205204, "question_id": 28138952, "link": "https://stackoverflow.com/questions/28138952/ajax-request-not-sending-to-go-web-server", "title": "Ajax Request not sending to Go web server", "body": "<p>I am just starting with learning web development, Go, and Ajax but I am having trouble seeing what is going wrong. I am trying to simply send data back and forth between the client and the server. With the Ajax request, I am sending data from the form to the server but it does not seem to reach the server because the log doesn't print \"in posthandler\" which leads me to think something is wrong with the ajax request. Attached is the main.go, index.html, and js/getData.js with all the relevant code.</p>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"io/ioutil\"\n    \"log\"\n)\n\nvar INDEX_HTML []byte\n\nfunc main(){\n    fmt.Println(\"starting server on http://localhost:8888/\\nvalue is %s\", value)\n    http.HandleFunc(\"/\", IndexHandler)\n    http.HandleFunc(\"/post\", PostHandler)\n    http.ListenAndServe(\":8888\", nil)\n}\n\nfunc IndexHandler(w http.ResponseWriter, r *http.Request){\n    log.Println(\"GET /\")\n    w.Write(INDEX_HTML)\n}\n\nfunc PostHandler(w http.ResponseWriter, r *http.Request){\n    r.ParseForm()\n    log.Println(\"in posthandler\", r.Form)\n    var value = r.FormValue(\"textfield\")\n    w.Write([]byte(value))\n}\nfunc init(){\n    INDEX_HTML, _ = ioutil.ReadFile(\"./html/index.html\")\n}\n</code></pre>\n\n<p>index.html</p>\n\n<pre><code>&lt;!doctype html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;Page Title&lt;/title&gt;\n  &lt;script src=\"js/getData.js\"&gt;&lt;/script&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;form action=\"/post\" method=\"post\"&gt;\n      &lt;textarea type=\"text\" name=\"input\" id=\"textfield\"&gt;&lt;/textarea&gt;\n      &lt;br /&gt;\n      &lt;input type=\"submit\" name=\"button\" id=\"button\" value=\"Send\" onclick=\"loadXMLDoc()\"/&gt;\n    &lt;/form&gt;\n    &lt;div id=\"fromserver\"&gt;\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>js/getData.js</p>\n\n<pre><code>function loadXMLDoc() {\n    var xmlhttp;\n    xmlhttp=new XMLHttpRequest();\n    xmlhttp.onreadystatechange=function()\n    {\n    if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200)\n    {\n        document.getElementById(\"fromserver\").innerHTML=xmlhttp.responseText;\n    }\n    }\n    xmlhttp.open(\"POST\",\"post\",true);\n    xmlhttp.send();\n}\n</code></pre>\n"}, {"tags": ["postgresql", "go"], "answers": [{"comments": [{"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 0, "creation_date": 1422196616, "post_id": 28137539, "comment_id": 44646841, "body": "still didn&#39;t get this part: 923331Z"}, {"owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "reply_to_user": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 0, "creation_date": 1422197260, "post_id": 28137539, "comment_id": 44647019, "body": "It didn&#39;t? It works for me: <a href=\"http://play.golang.org/p/CsEZfbnz_b\" rel=\"nofollow noreferrer\">play.golang.org/p/CsEZfbnz_b</a>  gives <code>2015-01-25T15:47:58.411372Z</code>"}], "tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": true, "score": 3, "last_activity_date": 1422197307, "last_edit_date": 1422197307, "creation_date": 1422196427, "answer_id": 28137539, "question_id": 28137495, "link": "https://stackoverflow.com/questions/28137495/go-format-timestamp-to-default-postgres-format/28137539#28137539", "title": "Go: Format timestamp to default postgres format", "body": "<p>Use <code>\"2006-01-02T15:04:05.000000Z\"</code> as the format\u00a0instead. It's just <code>RFC3339</code> with decimals added.</p>\n"}], "owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 686, "favorite_count": 1, "accepted_answer_id": 28137539, "answer_count": 1, "score": 0, "last_activity_date": 1422208542, "creation_date": 1422196148, "question_id": 28137495, "link": "https://stackoverflow.com/questions/28137495/go-format-timestamp-to-default-postgres-format", "title": "Go: Format timestamp to default postgres format", "body": "<p>How do I make the timestamp format:</p>\n\n<pre><code>2015-01-25T22:22:46+08:00\n</code></pre>\n\n<p>look like this</p>\n\n<pre><code>2015-01-25T22:22:46.923331Z\n</code></pre>\n\n<p>To get the first format, I used </p>\n\n<pre><code>time.Now().Format(time.RFC3339)\n</code></pre>\n\n<p>The second format is the default postgres format that I'm trying to duplicate. Thanks!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 5974, "user_id": 431715, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d1b099b5fa9eddc1b9a2d01a99b4b804?s=128&d=identicon&r=PG", "display_name": "Marcus Riemer", "link": "https://stackoverflow.com/users/431715/marcus-riemer"}, "edited": false, "score": 0, "creation_date": 1422192672, "post_id": 28136878, "comment_id": 44645645, "body": "I must admit that blurring the line between heap and stack allocation is a nice reason to stay away from explicit calls to <code>new</code>. But seeing something like <code>return (&amp;MyStruct{ ... })</code> still sends shivers down my C++ accommodated spine."}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1422288229, "post_id": 28136878, "comment_id": 44679081, "body": "Even if you use <code>new</code>, the compiler can decide to put your variable on the stack if it wants to - this can be more efficient in cases where your variable does not &quot;escape&quot; from the current function. This blurs the heap / stack distinction even further. The stack is good to use because no garbage collection is needed."}], "tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": true, "score": 5, "last_activity_date": 1422192128, "creation_date": 1422192128, "answer_id": 28136878, "question_id": 28136763, "link": "https://stackoverflow.com/questions/28136763/idiomatic-difference-between-newt-and-t/28136878#28136878", "title": "(Idiomatic?) Difference between new(T) and &amp;T{...}?", "body": "<p>Yes, you are correct. <code>new</code> is not that useful with structs. But it is with other basic types. <code>new(int)</code> will get you a pointer to a zero-valued <code>int</code>, and you can't do <code>&amp;int{}</code> or similar.</p>\n\n<p>In any case, in my experience, you rarely want that, so <code>new</code> is rarely used. You can just declare a plain <code>int</code> and pass around a pointer to it. In fact, doing this is probably better because liberates you from thinking about allocating in the stack vs. in the heap, as the compiler will decide for you.</p>\n"}], "owner": {"reputation": 5974, "user_id": 431715, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d1b099b5fa9eddc1b9a2d01a99b4b804?s=128&d=identicon&r=PG", "display_name": "Marcus Riemer", "link": "https://stackoverflow.com/users/431715/marcus-riemer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 28136878, "answer_count": 1, "score": 3, "last_activity_date": 1422192128, "creation_date": 1422191425, "question_id": 28136763, "link": "https://stackoverflow.com/questions/28136763/idiomatic-difference-between-newt-and-t", "title": "(Idiomatic?) Difference between new(T) and &amp;T{...}?", "body": "<p>I started kidding around with Go and am a little irritated by the <code>new</code> function. It seems to be quite limited, especially when considering structures with anonymous fields or inline initialisations.  So I read through the spec and <a href=\"https://golang.org/ref/spec#Variables\" rel=\"nofollow\">stumbled over the following paragraph</a>:</p>\n\n<blockquote>\n  <p>Calling the built-in function new or taking the address of a composite literal allocates storage for a variable at run time.</p>\n</blockquote>\n\n<p>So I have the suspicion that <code>new(T)</code> and <code>&amp;T{}</code> will behave in the exact same way, is that correct? And if that is correct, in what situation should <code>new</code> be used?</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 381, "user_id": 2090580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a314d273ca6d78f6401ad88f4fde945?s=128&d=identicon&r=PG", "display_name": "nights", "link": "https://stackoverflow.com/users/2090580/nights"}, "edited": false, "score": 1, "creation_date": 1575961946, "post_id": 28135580, "comment_id": 104732229, "body": "Having exactly this problem, thanks a lot for asking!"}], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 4, "last_activity_date": 1422184651, "creation_date": 1422184651, "answer_id": 28135749, "question_id": 28135580, "link": "https://stackoverflow.com/questions/28135580/golang-mysql-error-1040-too-many-connections/28135749#28135749", "title": "Golang, mysql: Error 1040: Too many connections", "body": "<p>Try to make prepared statements <code>db.Prepare(query string) (*Stmt, error)</code> and than <code>stmt.Query</code> or <code>stmt.Exec</code> and than <code>stmt.Close</code> to reuse connections.</p>\n"}, {"tags": [], "owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "is_accepted": true, "score": 33, "last_activity_date": 1422186224, "creation_date": 1422186224, "answer_id": 28135985, "question_id": 28135580, "link": "https://stackoverflow.com/questions/28135580/golang-mysql-error-1040-too-many-connections/28135985#28135985", "title": "Golang, mysql: Error 1040: Too many connections", "body": "<p><a href=\"http://golang.org/pkg/database/sql/#DB\">sql.Open doesn't really open a connection to your database.</a></p>\n\n<p>A sql.DB maintains a pool of connections to your database. Each time you query your database your program will try to get a connection from this pool or create a new one otherwise. These connections are than put back into the pool once you close them.</p>\n\n<p>This is what <code>rows.Close()</code> does.\nYour <code>db.QueryRow(\"...\")</code> does the same thing internally when you call <code>Scan(...)</code>.</p>\n\n<p>The basic problem is that you're creating too many queries, of which each one needs a connection, but you are not closing your connections fast enough. This way your program has to create a new connection for each query.</p>\n\n<p>You can limit the maximum number of connections your program uses by calling <a href=\"http://golang.org/pkg/database/sql/#DB.SetMaxOpenConns\">SetMaxOpenConns</a> on your sql.DB.</p>\n\n<p>See <a href=\"http://go-database-sql.org/surprises.html\">http://go-database-sql.org/surprises.html</a> for more information.</p>\n"}, {"tags": [], "owner": {"reputation": 814, "user_id": 4474211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf24f2226878c4c08d709a6efd3355f?s=128&d=identicon&r=PG", "display_name": "tmichel", "link": "https://stackoverflow.com/users/4474211/tmichel"}, "is_accepted": false, "score": 7, "last_activity_date": 1422186314, "creation_date": 1422186314, "answer_id": 28136002, "question_id": 28135580, "link": "https://stackoverflow.com/questions/28135580/golang-mysql-error-1040-too-many-connections/28136002#28136002", "title": "Golang, mysql: Error 1040: Too many connections", "body": "<p>The <code>*DB</code> object that you get back from <code>sql.Open</code> doesn't corresponds to a <em>single</em> connection. It is better thought as a handle for the database: it manages a connection pool for you.</p>\n\n<p>You can control the number of open connections with <a href=\"http://godoc.org/database/sql#DB.SetMaxOpenConns\" rel=\"noreferrer\">`(*DB).SetMaxOpenConns</a> and <a href=\"http://godoc.org/database/sql#DB.SetMaxIdleConns\" rel=\"noreferrer\">its pair</a> for idling connections.</p>\n\n<p>So basically what happens here is that <code>db.Query</code> and <code>db.QueryRow</code> tries to acquire a connection for themselves and the DB handle doesn't put any restrictions on the number of simultaneous connections so your code panics when it opens more than what mysql can handle.</p>\n"}, {"tags": [], "owner": {"reputation": 713, "user_id": 12162813, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-22W2wmyNnEQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfCiW9MIj-T5ov3H31eHm8dOqD1pg/photo.jpg?sz=128", "display_name": "Thushara Buddhika", "link": "https://stackoverflow.com/users/12162813/thushara-buddhika"}, "is_accepted": false, "score": 0, "last_activity_date": 1589285857, "creation_date": 1589285857, "answer_id": 61751515, "question_id": 28135580, "link": "https://stackoverflow.com/questions/28135580/golang-mysql-error-1040-too-many-connections/61751515#61751515", "title": "Golang, mysql: Error 1040: Too many connections", "body": "<p>My program is connecting always to database. (Realtime Face Recognition for Attendance)</p>\n\n<p>Therefore opening and closing database connection is worthless.</p>\n\n<p>Therefore it's keep opens the database connection only initializing the program.</p>\n\n<pre><code>func GetAllFaces() interface{} {\n    OpenDatabaseConnection() ... \n}\n</code></pre>\n\n<p>But access database later, increased the no of connection and crashed the program. But closing the <code>rows</code> object kept no of active connection at minimum. (for me 1)</p>\n\n<pre><code> func SaveAttendance(faceId int, date time.Time) error {\n    sqlQuery := fmt.Sprintf(\"SELECT ... \"))\n\n    rows, err := DB.Query(sqlQuery) ...\n    err = rows.Close()\n    return err\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13546019, "user_type": "registered", "profile_image": "https://graph.facebook.com/2922014517895150/picture?type=large", "display_name": "Watcharapong Tassoongnern", "link": "https://stackoverflow.com/users/13546019/watcharapong-tassoongnern"}, "is_accepted": false, "score": 1, "last_activity_date": 1589514302, "creation_date": 1589514302, "answer_id": 61811390, "question_id": 28135580, "link": "https://stackoverflow.com/questions/28135580/golang-mysql-error-1040-too-many-connections/61811390#61811390", "title": "Golang, mysql: Error 1040: Too many connections", "body": "<p>hi can you try close connection after used</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", str)\ndefer db.Close() // close after end scope\n</code></pre>\n"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20622, "favorite_count": 8, "accepted_answer_id": 28135985, "answer_count": 5, "score": 25, "last_activity_date": 1589514302, "creation_date": 1422183305, "question_id": 28135580, "link": "https://stackoverflow.com/questions/28135580/golang-mysql-error-1040-too-many-connections", "title": "Golang, mysql: Error 1040: Too many connections", "body": "<p>I'm using the github.com/go-sql-driver/mysql driver for go.</p>\n\n<p>I open a database:</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", str)\n</code></pre>\n\n<p>Then I have two functions that are called 200 times each with following mysql code:</p>\n\n<pre><code>rows, err := db.Query(\"select name from beehives\")\nif err != nil {\n    panic(err)\n}       \ndefer rows.Close()\n</code></pre>\n\n<p>The second:</p>\n\n<pre><code>    err = db.QueryRow(\"select id, secret, shortname from beehives where shortname = ?\", beehive).Scan(&amp;id, &amp;secre\n    switch {\n    case err == sql.ErrNoRows:\n        err = errors.New(\"Beehive '\"+beehive+\"' not found.\")\n    case err != nil:\n        panic(\"loginBeehive: \"+ err.Error())\n    default:\n        // ... do the work\n</code></pre>\n\n<p>The first one is panicing.</p>\n\n<p>How can there be more than one connection when I open the database only once and how do I close them?</p>\n"}, {"tags": ["model-view-controller", "go"], "comments": [{"owner": {"reputation": 1672, "user_id": 2464397, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8l2kG.png?s=128&g=1", "display_name": "ThinkChaos", "link": "https://stackoverflow.com/users/2464397/thinkchaos"}, "edited": false, "score": 0, "creation_date": 1422175886, "post_id": 28134710, "comment_id": 44641564, "body": "You can always use if;else/switch statement(s)."}, {"owner": {"reputation": 565, "user_id": 2593451, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/YbvhP.jpg?s=128&g=1", "display_name": "Jason Young", "link": "https://stackoverflow.com/users/2593451/jason-young"}, "reply_to_user": {"reputation": 1672, "user_id": 2464397, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8l2kG.png?s=128&g=1", "display_name": "ThinkChaos", "link": "https://stackoverflow.com/users/2464397/thinkchaos"}, "edited": false, "score": 0, "creation_date": 1422175991, "post_id": 28134710, "comment_id": 44641578, "body": "That&#39;s not a good choice"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1422179871, "post_id": 28134710, "comment_id": 44642371, "body": "I&#39;d use interfaces for it: and interface to identify controllers by name that will allow me to index them in a map or something (although if the number is very low it would be more efficient to simply scan them all). For calling the function you can use reflect."}, {"owner": {"reputation": 565, "user_id": 2593451, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/YbvhP.jpg?s=128&g=1", "display_name": "Jason Young", "link": "https://stackoverflow.com/users/2593451/jason-young"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1422183777, "post_id": 28134710, "comment_id": 44643247, "body": "@Not_a_Golfer, Can you give some code?"}], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 2, "last_activity_date": 1422188095, "creation_date": 1422188095, "answer_id": 28136257, "question_id": 28134710, "link": "https://stackoverflow.com/questions/28134710/can-i-instance-differenct-types-according-to-string-in-golang/28136257#28136257", "title": "Can I instance differenct types according to string in golang?", "body": "<p>You could do something like that:</p>\n\n<p>Define an interface for your controllers:</p>\n\n<pre><code>type Controller interface {\n   // Route returns the root route for that controller\n   Route() string\n}\n</code></pre>\n\n<p>In a controller just implement it:</p>\n\n<pre><code>// this tells our app what's the route for this controller\nfunc (c *TestController) Route() string {\n    return \"test\"\n}\n\nfunc (c *TestController) Test() {\n    //\n}\n\nfunc (c *TestController) Index() {\n    //\n}\n</code></pre>\n\n<p>In our app, create a registry of your controllers, and you can look them up:</p>\n\n<pre><code>var controllers = make([]Controller, 0)\n\n// register them somehow\n</code></pre>\n\n<p>And now in the serving process:</p>\n\n<pre><code>// assuming the path is /&lt;controller&gt;/&lt;method&gt;\ncontrollerName := strings.Split(r.URL.Path, \"/\")\n\n// again, you can use a map here, but for a few controllers it's not worth it probably\nfor _, c := range controllers {\n    if c.Route() == controllerName[1] {\n\n       // do what you did in the single controller example\n       callControllerWithReflection(c, controllerName[2])\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 565, "user_id": 2593451, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/YbvhP.jpg?s=128&g=1", "display_name": "Jason Young", "link": "https://stackoverflow.com/users/2593451/jason-young"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 28136257, "answer_count": 1, "score": 0, "last_activity_date": 1422188095, "creation_date": 1422175503, "question_id": 28134710, "link": "https://stackoverflow.com/questions/28134710/can-i-instance-differenct-types-according-to-string-in-golang", "title": "Can I instance differenct types according to string in golang?", "body": "<p>I want to implement MVC in golang. But it seems like hard to achieve what I want.\nin Testcontroller.go I have:</p>\n\n<pre><code>func (c *TestController) Test() {\n    //\n}\n\nfunc (c *TestController) Index() {\n    //\n}\n</code></pre>\n\n<p>With only a controller, I can use reflect.ValueOf(TestController{}).MethodByName().Call() to execute that function.\nnow I want to add another controller. but It seems like I can't new different instance by different string:</p>\n\n<pre><code>controllerName := strings.Split(r.URL.Path, \"/\")\ncontroller = reflect.ValueOf(controllerName[1])\n</code></pre>\n\n<p>I know this is totaly wrong, but I hope I can get a TestController instance if controllerName == \"Test\" and get a IndexController instance if controllerName == \"Index\", using reflect seems can't achieve what I want. Is there any way to do is?\nThank you very much!</p>\n"}, {"tags": ["python", "arrays", "pointers", "go"], "answers": [{"comments": [{"owner": {"reputation": 353, "user_id": 4491253, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T0Hvr5oyBPA/AAAAAAAAAAI/AAAAAAAAABY/1pOTmMzEs1o/photo.jpg?sz=128", "display_name": "Travis", "link": "https://stackoverflow.com/users/4491253/travis"}, "edited": false, "score": 0, "creation_date": 1422170440, "post_id": 28133354, "comment_id": 44640653, "body": "Great explanation! That is good to know about <code>:=</code> copying the value. Also, do you know if there is a better way to do <code>[e for e in G if condition(e)]</code>?"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1422162119, "last_edit_date": 1422162119, "creation_date": 1422161447, "answer_id": 28133354, "question_id": 28133288, "link": "https://stackoverflow.com/questions/28133288/subset-of-array-in-golang/28133354#28133354", "title": "subset of array in golang", "body": "<p>This simpler snippet of code shows what's going on:</p>\n\n<pre><code>var a Object\na.x = 1\nb := a\nfmt.Println(a, b) // prints {1} {1}\nb.x = 2\nfmt.Println(a, b) // prints {1} {2}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/lYWJTBbA-a\" rel=\"nofollow\">playground example</a></p>\n\n<p>The statement <code>b := a</code> copies the <code>Object</code> value in variable <code>a</code> to the variable <code>b</code>. There are now two copies of the value. Changing one does not change the other.</p>\n\n<p>This is different from Python where assignment copies a reference to a value.</p>\n\n<p>The loop in the question also copies the values:</p>\n\n<pre><code>for _,v := range *G {\n    H = append(H,v)\n}\n</code></pre>\n\n<p>The variable <code>v</code> is a copy the slice element from <code>*G</code>. A copy of <code>v</code> is appended to slice <code>H</code>. There are three independent Object values: the value in slice <code>*G</code>, the value in <code>v</code> and the value in slice <code>H</code>.</p>\n\n<p>If you want the slices to all refer to the same <code>Object</code> value, then store pointers to <code>Object</code> values in the slice:</p>\n\n<pre><code>type Group []*Object\n\narr := make(Group, 1)\narr[0] = &amp;Object{x: 1}\nfmt.Println(arr[0].x)  // prints 1\narr2 := arr.get()\narr[0].x = 3\nfmt.Println(arr[0].x)  // prints 3\nfmt.Println(arr2[0].x) // prints 3\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/KStKQ2kMP8\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 353, "user_id": 4491253, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T0Hvr5oyBPA/AAAAAAAAAAI/AAAAAAAAABY/1pOTmMzEs1o/photo.jpg?sz=128", "display_name": "Travis", "link": "https://stackoverflow.com/users/4491253/travis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1162, "favorite_count": 0, "accepted_answer_id": 28133354, "answer_count": 1, "score": 2, "last_activity_date": 1422162119, "creation_date": 1422160712, "question_id": 28133288, "link": "https://stackoverflow.com/questions/28133288/subset-of-array-in-golang", "title": "subset of array in golang", "body": "<p>I am trying to write the equivalent of the following line in python</p>\n\n<p><code>H = [e for e in G if condition(e)]</code></p>\n\n<p>Here is my example code. Basically I am just trying to use a getter function (G.get) to get a subset of <code>G</code>. So I think I want <code>arr2</code> to be a new array but containing the same object.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Object struct {\n    x int\n}\n\ntype Group []Object\n\nfunc (G *Group) get() (H []Object) {\n    for _,v := range *G {\n        H = append(H,v)\n    }\n    return\n}\n\nfunc main() {\n    arr := make(Group,1)\n    arr[0].x = 1\n    fmt.Println(arr)\n    arr2 := arr.get()\n    arr[0].x = 3\n    fmt.Println(arr)\n    fmt.Println(arr2)\n}\n</code></pre>\n\n<p>Which compiles and runs and gives me</p>\n\n<pre><code>[{1}]\n[{3}]\n[{1}]\n</code></pre>\n\n<p>My question is \"Why does <code>arr2</code> not contain the same instance of an Object as <code>arr</code>?\" I believe I understand <code>make</code> only instantiates a <code>Group</code> thing which means it includes one <code>Object</code> in it. But then the for loop shouldn't create a new <code>Object</code> should it?</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2484, "user_id": 3794472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTwGs.jpg?s=128&g=1", "display_name": "Jeremiah Winsley", "link": "https://stackoverflow.com/users/3794472/jeremiah-winsley"}, "edited": false, "score": 1, "creation_date": 1422129030, "post_id": 28129535, "comment_id": 44631992, "body": "A struct method acts upon the data contained in that particular struct. If you aren&#39;t acting on the data in the struct, then don&#39;t assign it to the struct."}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 1821015, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4466adde9f6accac78dc37db5d776ca9?s=128&d=identicon&r=PG", "display_name": "nikolai-s", "link": "https://stackoverflow.com/users/1821015/nikolai-s"}, "edited": false, "score": 0, "creation_date": 1422129801, "post_id": 28129557, "comment_id": 44632211, "body": "I have 7 structs and all methods for them should return string. I thought if I&#39;ll have struct methods, code will look better. Are you think 7 separate methods will be better variant? Thanks!"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 197, "user_id": 1821015, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4466adde9f6accac78dc37db5d776ca9?s=128&d=identicon&r=PG", "display_name": "nikolai-s", "link": "https://stackoverflow.com/users/1821015/nikolai-s"}, "edited": false, "score": 0, "creation_date": 1422130899, "post_id": 28129557, "comment_id": 44632535, "body": "@rtm7777 if those strings aren&#39;t related to the struct, it is better to manage them at the package level."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1422129047, "creation_date": 1422129047, "answer_id": 28129557, "question_id": 28129535, "link": "https://stackoverflow.com/questions/28129535/golang-call-method-from-struct/28129557#28129557", "title": "Golang, call method from struct", "body": "<p>You can define a package <a href=\"https://golang.org/ref/spec#Function_declarations\" rel=\"nofollow\">function</a> (without any receiver).<br>\nIt differs from a <a href=\"https://golang.org/ref/spec#Method_declarations\" rel=\"nofollow\">method</a>, as a method needs a receiver.</p>\n\n<pre><code>func GetSomeAdditionalData() string {\n  return \"additional data string\"\n}\n</code></pre>\n\n<p>Which you can call directly, without any instance of the struct <code>MyStruct</code> needed (since you don't need any of <code>MyStruct</code> data anyway):</p>\n\n<pre><code>func main() {\n  fmt.Println(models.GetSomeAdditionalData())\n  fmt.Println(GetSomeAdditionalData())\n</code></pre>\n\n<p>(the second form works if you are in the package <code>models</code> already)</p>\n"}, {"comments": [{"owner": {"reputation": 197, "user_id": 1821015, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4466adde9f6accac78dc37db5d776ca9?s=128&d=identicon&r=PG", "display_name": "nikolai-s", "link": "https://stackoverflow.com/users/1821015/nikolai-s"}, "edited": false, "score": 0, "creation_date": 1422130156, "post_id": 28129640, "comment_id": 44632327, "body": "It works, Thanks!   I&#39;ll also try find better variant, how to organize my code."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1422129665, "creation_date": 1422129665, "answer_id": 28129640, "question_id": 28129535, "link": "https://stackoverflow.com/questions/28129535/golang-call-method-from-struct/28129640#28129640", "title": "Golang, call method from struct", "body": "<p>To say you can. <code>MyStruct.GetSomeAdditionalData()</code> is called method expression and you must provide first argument of type <code>MyStruct</code> to that call. Argument can be anonymous composite literal <code>MyStruct.GetSomeAdditionalData(MyStruct{}).</code>\nHere is working example <a href=\"https://play.golang.org/p/Wc_DjqnpLC\" rel=\"nofollow\">https://play.golang.org/p/Wc_DjqnpLC</a> . But all that looks not very sensible.</p>\n"}, {"comments": [{"owner": {"reputation": 255, "user_id": 3446582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wLrPg.jpg?s=128&g=1", "display_name": "Niemi", "link": "https://stackoverflow.com/users/3446582/niemi"}, "edited": false, "score": 0, "creation_date": 1474160401, "post_id": 28130360, "comment_id": 66417755, "body": "<code>(*MyStruct)(nil).GetSomeAdditionalData()</code> will panic since the nil pointer can&#39;t be dereferenced for the value receiver in the method."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 255, "user_id": 3446582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wLrPg.jpg?s=128&g=1", "display_name": "Niemi", "link": "https://stackoverflow.com/users/3446582/niemi"}, "edited": false, "score": 0, "creation_date": 1474188019, "post_id": 28130360, "comment_id": 66422477, "body": "@Niemi True. Though, that only applies if the method operators on a value (as opposed to a pointer)."}, {"owner": {"reputation": 255, "user_id": 3446582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wLrPg.jpg?s=128&g=1", "display_name": "Niemi", "link": "https://stackoverflow.com/users/3446582/niemi"}, "edited": false, "score": 0, "creation_date": 1474208015, "post_id": 28130360, "comment_id": 66427756, "body": "yes. I just wanted to point it out for future readers since a pointer receiver is not used in the code snippet in the question."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 6, "last_activity_date": 1422134333, "creation_date": 1422134333, "answer_id": 28130360, "question_id": 28129535, "link": "https://stackoverflow.com/questions/28129535/golang-call-method-from-struct/28130360#28130360", "title": "Golang, call method from struct", "body": "<p>You can use a struct literal or a <code>nil</code> pointer.</p>\n\n<pre><code>MyStruct{}.GetSomeAdditionalData()\n(*MyStruct)(nil).GetSomeAdditionalData()\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 1821015, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4466adde9f6accac78dc37db5d776ca9?s=128&d=identicon&r=PG", "display_name": "nikolai-s", "link": "https://stackoverflow.com/users/1821015/nikolai-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8292, "favorite_count": 3, "accepted_answer_id": 28130360, "answer_count": 3, "score": 5, "last_activity_date": 1422134333, "creation_date": 1422128888, "question_id": 28129535, "link": "https://stackoverflow.com/questions/28129535/golang-call-method-from-struct", "title": "Golang, call method from struct", "body": "<p>Is it possible to call method from struct without variable with this struct type?</p>\n\n<pre><code>//models.go\ntype MyStruct struct {\n  id int\n  name string\n}\n\nfunc (s MyStruct) GetSomeAdditionalData() string {\n  return \"additional data string\"\n}\n\n//app.go\nfunc main() {\n  fmt.Println(models.MyStruct.GetSomeAdditionalData()) // not works\n\n  var variable models.MyStruct\n  fmt.Println(variable.GetSomeAdditionalData()) // it worked\n}\n</code></pre>\n\n<p>Or maybe Go have other method to add some data for struct?  </p>\n\n<p>Or maybe I select wrong way to do it? :)</p>\n"}, {"tags": ["python", "authentication", "go", "websocket", "jwt"], "comments": [{"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "edited": false, "score": 0, "creation_date": 1422134567, "post_id": 28129139, "comment_id": 44633555, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/69523/discussion-between-psbits-and-thwd\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4611106, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w9BT0.png?s=128&g=1", "display_name": "patrick", "link": "https://stackoverflow.com/users/4611106/patrick"}, "is_accepted": false, "score": 1, "last_activity_date": 1424967835, "creation_date": 1424967835, "answer_id": 28747543, "question_id": 28129139, "link": "https://stackoverflow.com/questions/28129139/websocket-jwt-token-connection-authorization/28747543#28747543", "title": "WebSocket JWT Token connection authorization", "body": "<p>Quite simply the serve does not expect the token to be handed over as a query parameter but instead expects it to be included in the headers of the request. </p>\n\n<p>Example using the websocket library from <a href=\"https://github.com/liris/websocket-client\" rel=\"nofollow\">https://github.com/liris/websocket-client</a></p>\n\n<pre><code>def test_auth_token(token)\n    header=\"Authorization: BEARER \" + str(token)\n    conn = create_connection(\"ws://&lt;IP&gt;:port\"+ '/'+ container.uuid\", header)\n    result = conn.recv()\n    assert result is not None\n</code></pre>\n"}], "owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4595, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1424967835, "creation_date": 1422126020, "last_edit_date": 1422227749, "question_id": 28129139, "link": "https://stackoverflow.com/questions/28129139/websocket-jwt-token-connection-authorization", "title": "WebSocket JWT Token connection authorization", "body": "<p>I am trying to make a websocket connection to a URL(python client) which needs to have a jwt token passed in and the server(implemented in GO) listens to this request on and is supposed to authenticate by parsing the token.</p>\n\n<p>I try to use this part of the code to make the request - </p>\n\n<pre><code>def test_auth_token(token)\n    conn = create_connection(\"ws://&lt;IP&gt;:port\"+ '/'+ container.uuid + '?token='+token)\n    result = conn.recv()\n    assert result is not None\n</code></pre>\n\n<p>This request hits the server which runs this code to validate this request</p>\n\n<p>func ParseFromRequest(req *http.Request, keyFunc Keyfunc) (token *Token, err error) {</p>\n\n<pre><code>// Look for an Authorization header\nif ah := req.Header.Get(\"Authorization\"); ah != \"\" {\n    // Should be a bearer token\n    if len(ah) &gt; 6 &amp;&amp; strings.ToUpper(ah[0:6]) == \"BEARER\" {\n        return Parse(ah[7:], keyFunc)\n    }\n}\n\n// Look for \"access_token\" parameter\nreq.ParseMultipartForm(10e6)\nif tokStr := req.Form.Get(\"access_token\"); tokStr != \"\" {\n    return Parse(tokStr, keyFunc)\n}\n\nreturn nil, ErrNoTokenInRequest\n</code></pre>\n\n<p>}</p>\n\n<p>Every time, I am getting the \"ErrNoTokenInRequest\" output despite I am passing the token as a query parameter. The server side token validation is being done by this external library which contains the above GO Routine - <a href=\"https://github.com/dgrijalva/jwt-go/blob/master/jwt.go\" rel=\"nofollow\">https://github.com/dgrijalva/jwt-go/blob/master/jwt.go</a></p>\n\n<p>I am not sure, what could be the possible reasons that server doesn't find the token sent in my client? Is it supposed to be sent as payload or headers or something else?  Could someone point to get this module working?</p>\n\n<p>With \"access_token\" as query parameter i get this exception - </p>\n\n<pre><code>self = &lt;websocket._core.WebSocket object at 0x10a15a6d0&gt;\nhost = 'x.x.x.x.', port = 9345\nresource = '/v1/stats/fff51e85-f2bb-4ace-8dcc-fde590932cca?access_token=eyJhbGciOiJSUzI1NiJ9.eyJleHAiOjE0MjIxMzEyMzUsInN1YiI6ImNh...vxvBmtZRrUTY5AcvrjbojXqLxFHL_CMsmTZfTXhOiy-7W2V95bqts2Wy4R8oQvsfDylYJWCBTzZNKHvPVFpcl0jQKLm1ms-LOJg1w-k23VfojZucPGtY5A'\noptions = {}\nheaders = ['GET /v1/stats/fff51e85-f2bb-4ace-8dcc-fde590932cca?access_token=eyJhbGciOiJSUzI1NiJ9.eyJleHAiOjE0MjIxMzEyMzUsInN1YiI... 'Host: x.x.x.x.:9345', 'Origin: http://x.x.x.x.:9345', 'Sec-WebSocket-Key: BN1n2BcCT/CUGh9MHeyL5g==', ...]\nkey = 'BN1n2BcCT/CUGh9MHeyL5g=='\nheader_str = 'GET /v1/stats/fff51e85-f2bb-4ace-8dcc-fde590932cca?access_token=eyJhbGciOiJSUzI1NiJ9.eyJleHAiOjE0MjIxMzEyMzUsInN1YiI6...3:9345\nOrigin: http://192.168.59.103:9345\nSec-WebSocket-Key: BN1n2BcCT/CUGh9MHeyL5g==\nSec-WebSocket-Version: 13\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "docker"], "answers": [{"tags": [], "owner": {"reputation": 384, "user_id": 1835188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M582S.png?s=128&g=1", "display_name": "Lorenz Leutgeb", "link": "https://stackoverflow.com/users/1835188/lorenz-leutgeb"}, "is_accepted": true, "score": 0, "last_activity_date": 1426151239, "creation_date": 1426151239, "answer_id": 29005576, "question_id": 28128598, "link": "https://stackoverflow.com/questions/28128598/how-do-i-debug-no-default-robot/29005576#29005576", "title": "How do I debug &quot;No default robot&quot;?", "body": "<p>I managed to resolve this with <a href=\"https://groups.google.com/forum/#!topic/google-appengine/9yyRgsu6SGs\" rel=\"nofollow\">some help</a> on <code>google-appengine@googlegroups.com</code> (the legacy support community for Google App Engine).</p>\n\n<p>It turned out that for some reason \"Cloud Integration\" was not correctly set up for my project. I had to navigate to \"Application Settings\" on appspot.com where \"Cloud Integration\" (it's quite far down on the page) would show following error: \"<a href=\"http://imgur.com/G4NwRve\" rel=\"nofollow\">An error occured when creating the project. Please retry.</a>\"</p>\n\n<p>Hitting \"Retry\" and waiting a few minutes did the trick.</p>\n"}], "owner": {"reputation": 384, "user_id": 1835188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M582S.png?s=128&g=1", "display_name": "Lorenz Leutgeb", "link": "https://stackoverflow.com/users/1835188/lorenz-leutgeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 29005576, "answer_count": 1, "score": 1, "last_activity_date": 1426151239, "creation_date": 1422122886, "last_edit_date": 1425985346, "question_id": 28128598, "link": "https://stackoverflow.com/questions/28128598/how-do-i-debug-no-default-robot", "title": "How do I debug &quot;No default robot&quot;?", "body": "<p>I have an Application (written in Go) running on Google AppEngine and am in the process of moving to Managed VMs. The App has been embedded in a Docker container with slight modifications to <code>Dockerfile</code>.</p>\n\n<p>The local development server started by <code>gcloud preview app run app.yaml</code> runs fine and serves as expected.</p>\n\n<p>When trying to deploy, however, I run into the following error.</p>\n\n<p>Using <code>gcloud</code>'s <code>--verbosity debug</code> I was able to isolate the request causing troubles (sorry for repeated output):</p>\n\n<pre><code>INFO: Preparing project for VM runtimes.\nDEBUG: Running [appcfg.py] with: appcfg.py --application=coduno --called_by_gcloud --noisy --oauth2 --oauth2_credential_file=/Users/flowlo/.config/gcloud/legacy_credentials/flowlo@example.com/singlestore.json --skip_sdk_update_check --version=master prepare_vm_runtime\n11:53 AM Host: appengine.google.com\nDEBUG: _Authenticate configuring auth; needs_auth=False\nDEBUG: Sending request to https://appengine.google.com/api/vms/prepare?app_id=coduno headers={'X-appcfg-api-version': '1', 'content-length': '0', 'Content-Type': 'application/octet-stream'} body=\nDEBUG: Got http error 400, this is try #1\nDEBUG: Unexpected results: {'status': '400', 'content-length': '65', 'expires': 'Fri, 01 Jan 1990 00:00:00 GMT', 'server': 'Google Frontend', 'cache-control': 'no-cache', 'date': 'Tue, 10 Mar 2015 10:53:09 GMT', 'content-type': 'text/plain'}\nError 400: --- begin server output ---\nFailed Project Preparation (app_id='s~example'). No default robot.\n--- end server output ---\nDEBUG: Received error code [1] while running: [appcfg.py --application=example --called_by_gcloud --noisy --oauth2 --oauth2_credential_file=/Users/lorenz/.config/gcloud/legacy_credentials/flowlo@example.com/singlestore.json --skip_sdk_update_check --version=master prepare_vm_runtime]\n</code></pre>\n\n<p><sub><strong>Note</strong>: The real application ID was replaced with <code>example</code>, the prefix <code>s~</code> is present in original output. Similarily I replaced the location of <code>app.yaml</code> with <code>/path/to</code>.</sub></p>\n\n<p>My <code>gcloud</code> is up to date:</p>\n\n<pre><code>$ gcloud --version\nGoogle Cloud SDK 0.9.50\n\napp 2015.03.03\napp-engine-go-darwin-x86_64 1.9.18\napp-engine-java 1.9.18\napp-engine-managed-vms 2015.01.22\napp-engine-python 1.9.18\napp-engine-python-extras 1.9.18\nbq 2.0.18\nbq-nix 2.0.18\ncompute 2015.03.03\ncore 2015.03.03\ncore-nix 2014.10.20\ndns 2015.03.03\ngae-go 2015.03.03\ngae-go-nix 2014.09.10\ngae-python 2014.05.06\ngae-python-launcher-mac 1.9.18\ngcutil 1.16.5\ngcutil-nix 1.16.5\ngsutil 4.9\ngsutil-nix 4.6\npreview 2015.03.03\npreview-extensions-darwin-x86_64 0.11.0\nsql 2015.03.03\n</code></pre>\n\n<p>Deploying the exact same app (same directory, same files) to a different project works.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1422219827, "post_id": 28128285, "comment_id": 44654538, "body": "The question is strange.  What does it mean to interpret an md5 to a single decimal?  An MD5 is a 128-bit (16 byte) hash.  Those bytes are not intended to be interpreted as a single integer."}, {"owner": {"reputation": 2484, "user_id": 3794472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTwGs.jpg?s=128&g=1", "display_name": "Jeremiah Winsley", "link": "https://stackoverflow.com/users/3794472/jeremiah-winsley"}, "reply_to_user": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1422220638, "post_id": 28128285, "comment_id": 44654799, "body": "@dyoo An MD5 hash is binary (base2), usually encoded to hex (base16), and OP wants to convert it to decimal (base10). No, it&#39;s not intended to be used for math, but it&#39;s certainly possible."}, {"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 1, "creation_date": 1422220977, "post_id": 28128285, "comment_id": 44654929, "body": "There&#39;s <i>possible</i>, and then there&#39;s <i>useful</i>.  If the original questioner is concerned about space, then they can just hold onto the byte-string of 16 bytes (not the hexdigest, but the actual bytes) and do straightforward equality comparisons.  It&#39;s the coersion to big-integer representation that seems odd to me: that indicates that they&#39;re trying to do something... arithmetic?  So more context into what future operations they plan to do with the integer value would be very helpful; as it is, without context, the original question is trying to do something weird."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4985526"}, "reply_to_user": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1575273008, "post_id": 28128285, "comment_id": 104496674, "body": "@dyoo yes, Your are right, it&#39;s very useful, when doing a map reduce or load banlance consistant hasing algorithm, there&#39;s needs to create a hashring using md5 or other hash algorithm. This powers the distributed system like memcache, redis, map-reduce, and cdn load-banlancer and even on the amazon dynamo kv database in the open system, almost everyone use it now."}], "answers": [{"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 3, "creation_date": 1422218644, "post_id": 28128535, "comment_id": 44654152, "body": "Minor optimization, you don&#39;t actually need to encode it to hex, you can use <code>bi.SetBytes</code> directly : <a href=\"http://play.golang.org/p/hHSnNPWUP8\" rel=\"nofollow noreferrer\">play.golang.org/p/hHSnNPWUP8</a>"}, {"owner": {"reputation": 2484, "user_id": 3794472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTwGs.jpg?s=128&g=1", "display_name": "Jeremiah Winsley", "link": "https://stackoverflow.com/users/3794472/jeremiah-winsley"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 2, "creation_date": 1422220405, "post_id": 28128535, "comment_id": 44654710, "body": "@OneOfOne That&#39;s true if you&#39;re starting with the <code>[]byte</code> value, the question references an MD5 string so OP may be starting with the hex."}], "tags": [], "owner": {"reputation": 2484, "user_id": 3794472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTwGs.jpg?s=128&g=1", "display_name": "Jeremiah Winsley", "link": "https://stackoverflow.com/users/3794472/jeremiah-winsley"}, "is_accepted": true, "score": 4, "last_activity_date": 1422122510, "creation_date": 1422122510, "answer_id": 28128535, "question_id": 28128285, "link": "https://stackoverflow.com/questions/28128285/best-way-to-convert-an-md5-to-decimal-in-golang/28128535#28128535", "title": "Best way to convert an MD5 to decimal in Golang?", "body": "<p>You can do this with <a href=\"https://golang.org/pkg/math/big/\" rel=\"nofollow\">math/big</a>. </p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/md5\"\n    \"encoding/hex\"\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc main() {\n    bi := big.NewInt(0)\n    h := md5.New()\n    h.Write([]byte(\"hello world\"))\n    hexstr := hex.EncodeToString(h.Sum(nil))\n    bi.SetString(hexstr, 16)\n    fmt.Println(bi.String())\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/3h521Ao1UY\" rel=\"nofollow\">http://play.golang.org/p/3h521Ao1UY</a></p>\n"}], "owner": {"reputation": 13715, "user_id": 252253, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2057c9a8fb934a4aa7f0fbac2d8349d5?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/252253/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3394, "favorite_count": 0, "accepted_answer_id": 28128535, "answer_count": 1, "score": 1, "last_activity_date": 1422124827, "creation_date": 1422121000, "last_edit_date": 1422124827, "question_id": 28128285, "link": "https://stackoverflow.com/questions/28128285/best-way-to-convert-an-md5-to-decimal-in-golang", "title": "Best way to convert an MD5 to decimal in Golang?", "body": "<p>In Python I can do</p>\n\n<pre><code>int(hashlib.md5('hello world').hexdigest(), 16)\n</code></pre>\n\n<p>which results in </p>\n\n<pre><code>125893641179230474042701625388361764291L\n</code></pre>\n\n<p>What's the equivalent in Golang to take an MD5 string and get the decimal representation?</p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 0, "creation_date": 1528426345, "post_id": 28127909, "comment_id": 88513333, "body": "I think gccgo may have less overhead when calling C code. You could try doing some further research on that."}], "answers": [{"comments": [{"owner": {"reputation": 138660, "user_id": 298661, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3445f56229632874a44596385ed6d40c?s=128&d=identicon&r=PG", "display_name": "Puppy", "link": "https://stackoverflow.com/users/298661/puppy"}, "edited": false, "score": 0, "creation_date": 1422119782, "post_id": 28128074, "comment_id": 44629026, "body": "Your logic is completely flawed. People don&#39;t remove unneeded overhead all the time, simply because they don&#39;t need to expend energy on removing it."}, {"owner": {"reputation": 28073, "user_id": 377037, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fb2956c6a757f40f0ee02aa30fd2090f?s=128&d=identicon&r=PG", "display_name": "Tom van der Woerdt", "link": "https://stackoverflow.com/users/377037/tom-van-der-woerdt"}, "edited": false, "score": 0, "creation_date": 1422122870, "post_id": 28128074, "comment_id": 44630032, "body": "Right, so what you&#39;re saying is that the extra stack in cgo is unavoidable - and I agree. But that doesn&#39;t mean that all the other overhead can&#39;t be removed"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 28073, "user_id": 377037, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fb2956c6a757f40f0ee02aa30fd2090f?s=128&d=identicon&r=PG", "display_name": "Tom van der Woerdt", "link": "https://stackoverflow.com/users/377037/tom-van-der-woerdt"}, "edited": false, "score": 0, "creation_date": 1422126770, "post_id": 28128074, "comment_id": 44631341, "body": "@TomvanderWoerdt duh... all the extra overhead is required exactly for that to work."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 138660, "user_id": 298661, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3445f56229632874a44596385ed6d40c?s=128&d=identicon&r=PG", "display_name": "Puppy", "link": "https://stackoverflow.com/users/298661/puppy"}, "edited": false, "score": 0, "creation_date": 1422126805, "post_id": 28128074, "comment_id": 44631354, "body": "@Puppy I&#39;m pretty sure that the Go team would take any possible mean to reduce the latency of cgo calls as it&#39;s a very important feature."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1422140679, "post_id": 28128074, "comment_id": 44635118, "body": "@FUZxxl: &quot;You could compile your C code with the C compiler from the Go project&quot;. Go 1.5 has deleted the Go C compilers."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1422140762, "post_id": 28128074, "comment_id": 44635141, "body": "@peterSO That&#39;s why I said \u201cyour code will definitely break in a future version of Go\u201d"}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 0, "last_activity_date": 1578671209, "last_edit_date": 1578671209, "creation_date": 1422119616, "answer_id": 28128074, "question_id": 28127909, "link": "https://stackoverflow.com/questions/28127909/how-to-bind-go-functions-to-c-calls-without-using-cgo/28128074#28128074", "title": "How to bind Go functions to C calls without using cgo?", "body": "<p>What you want to do is not possible. There is a reason that C code has a high overhead, which is that C code uses a different ABI (the platform's native ABI) which doesn't support the short stacks Go uses. Thus whenever Go code calls C code, execution has to continue on the threads native stack. This causes the overhead you see. There is no way to remove this overhead. Think about it: If the overhead wasn't needed, it wouldn't exist.</p>\n\n<p>It's hard to say what you should do instead without knowing what your program looks like.</p>\n"}], "owner": {"reputation": 28073, "user_id": 377037, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fb2956c6a757f40f0ee02aa30fd2090f?s=128&d=identicon&r=PG", "display_name": "Tom van der Woerdt", "link": "https://stackoverflow.com/users/377037/tom-van-der-woerdt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1705, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1578671209, "creation_date": 1422118599, "question_id": 28127909, "link": "https://stackoverflow.com/questions/28127909/how-to-bind-go-functions-to-c-calls-without-using-cgo", "title": "How to bind Go functions to C calls without using cgo?", "body": "<p>In a project I'm working on I need to use a bunch of C functions from Go. The current implementation is using cgo to achieve that, but doing so has a massive performance impact, which I am trying to remove.</p>\n\n<ul>\n<li>cgo marks all C code as a syscall, causing the scheduler to allocate a new thread if needed. Since ~80% of the CPU time in my project is spent doing the heavy C work, this quickly results in having a lot of threads (500+ instead of <code>GOMAXPROCS</code> (= 8)), which my Linux kernel does not like much.</li>\n<li>Doing the usual 'limiter' approach (have a buffered channel lock the cgo calls) results in a lot of mutexes, slowing the program down.</li>\n</ul>\n\n<p>I want to keep using Go for this project as it's a great way of managing concurrency.</p>\n\n<p>Things I have tried :</p>\n\n<ul>\n<li>Comment out some stuff like <code>entersyscall()</code> in <code>src/runtime/cgocall.go</code> (didn't seem to help much, and I'd prefer to avoid modifying the Go code).</li>\n<li>Put my code in a .c file and call it from Go, without the <code>import \"C\"</code>. No luck here - I couldn't call the function and when I wrote the function names as <code>package\u00b7function</code> the compiler complained about invalid characters in the file.</li>\n<li>Use a .s file and just write it as assembly. My asm isn't that great and I couldn't figure it out.</li>\n</ul>\n\n<p>So, my question is: <em>how does one use C functions from Go while avoiding the overhead of cgo?</em></p>\n\n<p>Side note: I'm aware of why cgo marks all calls as a syscall, but in this specific case the functions I call do not block on locks or IO.</p>\n"}, {"tags": ["parsing", "time", "go", "duration", "iso8601"], "comments": [{"owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "edited": false, "score": 2, "creation_date": 1422106505, "post_id": 28125963, "comment_id": 44625176, "body": "From a quick google: <a href=\"https://github.com/ChannelMeter/iso8601duration\" rel=\"nofollow noreferrer\">github.com/ChannelMeter/iso8601duration</a>"}, {"owner": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "reply_to_user": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "edited": false, "score": 0, "creation_date": 1422106612, "post_id": 28125963, "comment_id": 44625192, "body": "Nothing out-of-the-box?"}, {"owner": {"reputation": 439, "user_id": 2314047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7cs4.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/2314047/david"}, "edited": false, "score": 1, "creation_date": 1422113648, "post_id": 28125963, "comment_id": 44627197, "body": "Hope this helps:  <a href=\"http://go-search.org/search?q=ISO+8601+duration\" rel=\"nofollow noreferrer\">go-search.org/search?q=ISO+8601+duration</a>"}, {"owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "edited": false, "score": 5, "creation_date": 1422122237, "post_id": 28125963, "comment_id": 44629811, "body": "No, nothing in the standard library. Why are you so concerned about using a library? It&#39;s not that big of a deal in Go, with no external dependencies tool needed and static binaries."}], "answers": [{"comments": [{"owner": {"reputation": 1789, "user_id": 527242, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ZNsWz.jpg?s=128&g=1", "display_name": "Lee Jensen", "link": "https://stackoverflow.com/users/527242/lee-jensen"}, "edited": false, "score": 0, "creation_date": 1566491889, "post_id": 30592146, "comment_id": 101682550, "body": "Nice and simple but it doesn&#39;t support fractional times. The smallest value used may also have a decimal fraction, as in &quot;P0.5Y&quot; to indicate half a year. This decimal fraction may be specified with either a comma or a full stop, as in &quot;P0,5Y&quot; or &quot;P0.5Y&quot;. It is common for milliseconds to be represented as PT0.032S."}], "tags": [], "owner": {"reputation": 8822, "user_id": 356528, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/c5c2e6aa207dd3686244700d39117bdc?s=128&d=identicon&r=PG", "display_name": "R&#233;gis B.", "link": "https://stackoverflow.com/users/356528/r%c3%a9gis-b"}, "is_accepted": false, "score": 3, "last_activity_date": 1433237109, "creation_date": 1433237109, "answer_id": 30592146, "question_id": 28125963, "link": "https://stackoverflow.com/questions/28125963/golang-parse-time-duration/30592146#30592146", "title": "Golang parse time.Duration", "body": "<p>It's not exactly \"out of the box\" but a regular expression does the job:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"regexp\"\nimport \"strconv\"\nimport \"time\"\n\nfunc main() {\n    fmt.Println(ParseDuration(\"PT15M\"))\n    fmt.Println(ParseDuration(\"P12Y4MT15M\"))\n}\n\nfunc ParseDuration(str string) time.Duration {\n    durationRegex := regexp.MustCompile(`P(?P&lt;years&gt;\\d+Y)?(?P&lt;months&gt;\\d+M)?(?P&lt;days&gt;\\d+D)?T?(?P&lt;hours&gt;\\d+H)?(?P&lt;minutes&gt;\\d+M)?(?P&lt;seconds&gt;\\d+S)?`)\n    matches := durationRegex.FindStringSubmatch(str)\n\n    years := ParseInt64(matches[1])\n    months := ParseInt64(matches[2])\n    days := ParseInt64(matches[3])\n    hours := ParseInt64(matches[4])\n    minutes := ParseInt64(matches[5])\n    seconds := ParseInt64(matches[6])\n\n    hour := int64(time.Hour)\n    minute := int64(time.Minute)\n    second := int64(time.Second)\n    return time.Duration(years*24*365*hour + months*30*24*hour + days*24*hour + hours*hour + minutes*minute + seconds*second)\n}\n\nfunc ParseInt64(value string) int64 {\n    if len(value) == 0 {\n        return 0\n    }\n    parsed, err := strconv.Atoi(value[:len(value)-1])\n    if err != nil {\n        return 0\n    }\n    return int64(parsed)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1789, "user_id": 527242, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ZNsWz.jpg?s=128&g=1", "display_name": "Lee Jensen", "link": "https://stackoverflow.com/users/527242/lee-jensen"}, "edited": false, "score": 0, "creation_date": 1596825442, "post_id": 57617885, "comment_id": 111945598, "body": "There is a problem here if you are planning on adding the duration to a time since the meaning of Year and Month is dependent on the actual time you are adding the duration to. For example, if you add a year that is a leap year, or a month that doesn&#39;t have 30 days, you will get the wrong answer."}], "tags": [], "owner": {"reputation": 1789, "user_id": 527242, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ZNsWz.jpg?s=128&g=1", "display_name": "Lee Jensen", "link": "https://stackoverflow.com/users/527242/lee-jensen"}, "is_accepted": false, "score": 1, "last_activity_date": 1566514156, "creation_date": 1566514156, "answer_id": 57617885, "question_id": 28125963, "link": "https://stackoverflow.com/questions/28125963/golang-parse-time-duration/57617885#57617885", "title": "Golang parse time.Duration", "body": "<p>Here is code that handles fractional time units like <code>PT3.001S</code>.</p>\n\n<pre><code>var durationRegex = regexp.MustCompile(`P([\\d\\.]+Y)?([\\d\\.]+M)?([\\d\\.]+D)?T?([\\d\\.]+H)?([\\d\\.]+M)?([\\d\\.]+?S)?`)\n\n// ParseDuration converts a ISO8601 duration into a time.Duration\nfunc ParseDuration(str string) time.Duration {\n   matches := durationRegex.FindStringSubmatch(str)\n\n   years := parseDurationPart(matches[1], time.Hour*24*365)\n   months := parseDurationPart(matches[2], time.Hour*24*30)\n   days := parseDurationPart(matches[3], time.Hour*24)\n   hours := parseDurationPart(matches[4], time.Hour)\n   minutes := parseDurationPart(matches[5], time.Second*60)\n   seconds := parseDurationPart(matches[6], time.Second)\n\n   return time.Duration(years + months + days + hours + minutes + seconds)\n}\n\nfunc parseDurationPart(value string, unit time.Duration) time.Duration {\n   if len(value) != 0 {\n       if parsed, err := strconv.ParseFloat(value[:len(value)-1], 64); err == nil {\n           return time.Duration(float64(unit) * parsed)\n       }\n   }\n   return 0\n}\n</code></pre>\n"}], "owner": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16710, "favorite_count": 0, "answer_count": 2, "score": 9, "last_activity_date": 1566514156, "creation_date": 1422106113, "last_edit_date": 1422133240, "question_id": 28125963, "link": "https://stackoverflow.com/questions/28125963/golang-parse-time-duration", "title": "Golang parse time.Duration", "body": "<p>I would like to parse <code>time.Duration</code>. The duration is <code>\"PT15M\"</code> (string/bytes) and would like to convert it to a valid <code>time.Duration</code>. </p>\n\n<hr>\n\n<p>If this were a <code>time.Time</code> thing, I would use: </p>\n\n<p><code>t, err := time.Parse(time.RFC3339Nano, \"2013-06-05T14:10:43.678Z\")\n</code></p>\n\n<p>But this doesn't exist (<code>ParseDuration</code> only takes one parameter):</p>\n\n<p><code>d, err := time.ParseDuration(time.RFC3339Nano, \"PT15M\")\n</code></p>\n\n<hr>\n\n<p>How can I parse this <a href=\"http://en.wikipedia.org/wiki/ISO_8601?oldformat=true#Durations\" rel=\"noreferrer\">ISO 8601 duration</a>? </p>\n"}, {"tags": ["bash", "go", "debian"], "answers": [{"comments": [{"owner": {"reputation": 28716, "user_id": 828193, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/pmNlX.png?s=128&g=1", "display_name": "user000001", "link": "https://stackoverflow.com/users/828193/user000001"}, "edited": false, "score": 1, "creation_date": 1422102789, "post_id": 28125468, "comment_id": 44624223, "body": "In bash you can also write <code>.&#47;server &amp;&gt; err</code>"}], "tags": [], "owner": {"reputation": 814, "user_id": 4474211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf24f2226878c4c08d709a6efd3355f?s=128&d=identicon&r=PG", "display_name": "tmichel", "link": "https://stackoverflow.com/users/4474211/tmichel"}, "is_accepted": true, "score": 4, "last_activity_date": 1422102852, "last_edit_date": 1422102852, "creation_date": 1422102630, "answer_id": 28125468, "question_id": 28125433, "link": "https://stackoverflow.com/questions/28125433/debian-how-can-i-write-error-messages-to-file/28125468#28125468", "title": "Debian: How can I write error messages to file?", "body": "<p>Error message are sent to <code>stderr</code>, so you have to redirect that as well to a file.</p>\n\n<p>Start your server with:</p>\n\n<pre><code>./server &gt; err 2&gt;&amp;1\n</code></pre>\n"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 28125468, "answer_count": 1, "score": -1, "last_activity_date": 1422102852, "creation_date": 1422102366, "last_edit_date": 1422102396, "question_id": 28125433, "link": "https://stackoverflow.com/questions/28125433/debian-how-can-i-write-error-messages-to-file", "title": "Debian: How can I write error messages to file?", "body": "<p>I wrote a websocket server with go, running on Debian. Now I have a very long panic message and I want to write it to a file</p>\n\n<pre><code>./server &gt; err\n</code></pre>\n\n<p>writes only the normal output. Error messages still appear on stdout.</p>\n\n<p>How can I redirect them?</p>\n"}, {"tags": ["interface", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1422095630, "post_id": 28124412, "comment_id": 44622495, "body": "There is absolutely nothing to deal with: <b>Any</b> type which has a method <code>Do() string</code> implements <i>both</i> interfaces <code>A.Doer</code> and <code>B.Doer</code>."}, {"owner": {"reputation": 20459, "user_id": 1120221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0977d36f1cf30241c35121f1d741c8e9?s=128&d=identicon&r=PG&f=1", "display_name": "Salah Eddine Taouririt", "link": "https://stackoverflow.com/users/1120221/salah-eddine-taouririt"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1422098869, "post_id": 28124412, "comment_id": 44623312, "body": "I think you are right @Volker, there is no fix for that, and this situation can occur in any language that uses interfaces (<code>java</code> for example)."}], "answers": [{"comments": [{"owner": {"reputation": 20459, "user_id": 1120221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0977d36f1cf30241c35121f1d741c8e9?s=128&d=identicon&r=PG&f=1", "display_name": "Salah Eddine Taouririt", "link": "https://stackoverflow.com/users/1120221/salah-eddine-taouririt"}, "edited": false, "score": 0, "creation_date": 1422098743, "post_id": 28124575, "comment_id": 44623280, "body": "but the logic implemented in the <code>Do</code> method to satisfy <code>A </code> is completely different from the one in <code>B</code>."}, {"owner": {"reputation": 20459, "user_id": 1120221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0977d36f1cf30241c35121f1d741c8e9?s=128&d=identicon&r=PG&f=1", "display_name": "Salah Eddine Taouririt", "link": "https://stackoverflow.com/users/1120221/salah-eddine-taouririt"}, "edited": false, "score": 0, "creation_date": 1422100059, "post_id": 28124575, "comment_id": 44623560, "body": "Thanks @VonC, me too, I added more code to clarify the issue."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 8, "last_activity_date": 1422099978, "last_edit_date": 1422099978, "creation_date": 1422095755, "answer_id": 28124575, "question_id": 28124412, "link": "https://stackoverflow.com/questions/28124412/how-to-implement-two-different-interfaces-with-the-same-method-signature/28124575#28124575", "title": "How to implement two different interfaces with the same method signature", "body": "<p>As the <a href=\"http://golang.org/doc/faq#overloading\" rel=\"noreferrer\">FAQ mentions</a></p>\n\n<blockquote>\n  <p>Experience with other languages told us that having a variety of methods with the same name but different signatures was occasionally useful but that it could also be confusing and fragile in practice.<br>\n  <strong>Matching only by name and requiring consistency in the types was a major simplifying decision in Go's type system</strong>. </p>\n</blockquote>\n\n<p>In your case, you would satisfy both interfaces.</p>\n\n<p>You can you the can test whether an object (of an interface type) satisfies another interface type <code>A.Doer</code>, by doing:</p>\n\n<pre><code>if _, ok := obj.(A.Doer); ok {\n}\n</code></pre>\n\n<hr>\n\n<p>The OP adds:</p>\n\n<blockquote>\n  <p>But the logic implemented in the <code>Do</code> method to satisfy <code>A</code> is completely different from the one in <code>B</code>.</p>\n</blockquote>\n\n<p>Then you need to implement a wrapper around you object:</p>\n\n<ul>\n<li>a <code>DoerA</code>, which has your object <code>C</code> as a field, and implement <code>A.Do()</code> in a manner that satisfy how <code>A.Do()</code>is supposed to work</li>\n<li>a <code>DoerB</code>, which has your same object <code>C</code> as a field, and implement <code>B.Do()</code> in a manner that satisfy how <code>B.Do()</code> is supposed to work</li>\n</ul>\n\n<p>That way, you will know which Doer to pass to a function expecting an <code>A.Doer</code> or a <code>B.Doer</code>.<br>\nYou won't have to implement a <code>Do()</code> method on your original object <code>C</code>, which would be unable to cope with the different logic of <code>A.Do()</code> and <code>B.Do()</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 171, "user_id": 4493198, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kAjSGsEiJG4/AAAAAAAAAAI/AAAAAAABW2o/rzwHgxgYxY4/photo.jpg?sz=128", "display_name": "iccananea", "link": "https://stackoverflow.com/users/4493198/iccananea"}, "is_accepted": false, "score": 3, "last_activity_date": 1422232613, "creation_date": 1422232613, "answer_id": 28143295, "question_id": 28124412, "link": "https://stackoverflow.com/questions/28124412/how-to-implement-two-different-interfaces-with-the-same-method-signature/28143295#28143295", "title": "How to implement two different interfaces with the same method signature", "body": "<p>By definition, <a href=\"http://golang.org/doc/faq#implements_interface\" rel=\"nofollow\">you are satisfying both</a>:</p>\n\n<blockquote>\n  <p>A Go type satisfies an interface by implementing the methods of that interface, nothing more. This property allows interfaces to be defined and used without having to modify existing code. It enables a kind of structural typing that promotes separation of concerns and improves code re-use, and makes it easier to build on patterns that emerge as the code develops. The semantics of interfaces is one of the main reasons for Go's nimble, lightweight feel.</p>\n</blockquote>\n\n<p>So, with that in mind, you can either:</p>\n\n<p>a) Add comments to the the interface methods defining your expectations on the logic (see the io.Reader interface or a good example)</p>\n\n<p>b) Add an extra method called ImplementsDoerA and ImplementsDoerB on the interfaces (also mentioned in the FAQ).</p>\n"}], "owner": {"reputation": 20459, "user_id": 1120221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0977d36f1cf30241c35121f1d741c8e9?s=128&d=identicon&r=PG&f=1", "display_name": "Salah Eddine Taouririt", "link": "https://stackoverflow.com/users/1120221/salah-eddine-taouririt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3730, "favorite_count": 3, "accepted_answer_id": 28124575, "answer_count": 2, "score": 8, "last_activity_date": 1422232613, "creation_date": 1422094484, "last_edit_date": 1422125428, "question_id": 28124412, "link": "https://stackoverflow.com/questions/28124412/how-to-implement-two-different-interfaces-with-the-same-method-signature", "title": "How to implement two different interfaces with the same method signature", "body": "<p>Suppose that I have to implement two different interfaces declared in two different packages (in two different separated projects).</p>\n\n<p>I have in the package  <code>A</code></p>\n\n<pre><code>package A\n\ntype interface Doer {\n    Do() string\n}\n\nfunc FuncA(Doer doer) {\n     // Do some logic here using doer.Do() result\n\n     // The Doer interface that doer should implement, \n     // is the A.Doer\n}\n</code></pre>\n\n<p>And in package <code>B</code></p>\n\n<pre><code>package B\n\ntype interface Doer {\n    Do() string\n}\n\nfunction FuncB(Doer doer) {\n    // some logic using doer.Do() result\n\n     // The Doer interface that doer should implement, \n     // is the B.Doer\n}\n</code></pre>\n\n<p>In my <code>main</code> package</p>\n\n<pre><code>package main\n\nimport (\n    \"path/to/A\"\n    \"path/to/B\"\n)\n\ntype C int\n\n// this method implement both A.Doer and B.Doer but\n// the implementation of Do here is the one required by A !\nfunc (c C) Do() string {\n    return \"C now Imppement both A and B\"\n}\n\nfunc main() {\n    c := C(0)\n    A.FuncA(c)\n    B.FuncB(c) // the logic implemented by C.Do method will causes a bug here !\n}\n</code></pre>\n\n<p>How to deal with this situation ?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "is_accepted": true, "score": 4, "last_activity_date": 1422087593, "creation_date": 1422087593, "answer_id": 28123621, "question_id": 28123595, "link": "https://stackoverflow.com/questions/28123595/variables-not-working-in-included-templates-html-template/28123621#28123621", "title": "Variables not working in included templates (html/template)", "body": "<p>You have to pass the variables to the template:</p>\n\n<pre><code>{{ template \"head\" . }}\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 4489257, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/755572e35afde5bf222b3096a3b9d36b?s=128&d=identicon&r=PG&f=1", "display_name": "Maxim Lis", "link": "https://stackoverflow.com/users/4489257/maxim-lis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 28123621, "answer_count": 1, "score": 1, "last_activity_date": 1422117516, "creation_date": 1422087299, "last_edit_date": 1422117516, "question_id": 28123595, "link": "https://stackoverflow.com/questions/28123595/variables-not-working-in-included-templates-html-template", "title": "Variables not working in included templates (html/template)", "body": "<p>The template \"head\" inserted on \"index\" template and use one variable {{ .Title }}</p>\n\n<p>Main.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"html/template\"\n    \"net/http\"\n\n    \"github.com/julienschmidt/httprouter\"\n)\n\nvar (\n    t = template.Must(template.ParseGlob(\"templates/*.tpl\"))\n)\n\ntype Page struct {\n    Title string\n    Desc  string\n}\n\nfunc Index(w http.ResponseWriter, r *http.Request, _ httprouter.Params) {\n    index := Page{Title: \"This is title\", Desc: \"Desc\"}\n    t.ExecuteTemplate(w, \"index\", index)\n}\n\nfunc main() {\n    router := httprouter.New()\n    router.GET(\"/\", Index)\n\n    http.ListenAndServe(\":8080\", router)\n}\n</code></pre>\n\n<p>Index.tpl:</p>\n\n<pre><code>{{ define \"index\" }}\n\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n    {{ template \"head\" }}\n&lt;body&gt;\n    &lt;h1&gt;Main info:&lt;/h1&gt;\n    Title: {{ .Title }}\n    Desc: {{ .Desc }}\n&lt;/body&gt;\n&lt;/html&gt;\n\n\n{{ end }}\n</code></pre>\n\n<p>head.tpl:</p>\n\n<pre><code>{{ define \"head\" }}\n\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;{{ .Title }}&lt;/title&gt;\n&lt;/head&gt;\n\n{{ end }}\n</code></pre>\n\n<p>I get this html:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n\n\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;&lt;/title&gt;\n&lt;/head&gt;\n\n\n&lt;body&gt;\n    &lt;h1&gt;Main info:&lt;/h1&gt;\n    Title: This is title\n    Desc: Desc\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Variable {{ .Title }} works on site body, but doesn't work in head.</p>\n"}, {"tags": ["eclipse", "go", "goclipse"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1422095722, "post_id": 28122455, "comment_id": 44622523, "body": "There is no need to run a Go program from your IDE: The command line works fine for Go code. Go is not Java where manually crafting a classpath is for masochists only."}], "answers": [{"comments": [{"owner": {"reputation": 1357, "user_id": 393898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b55a355cb66fff949fe85c45ea4897?s=128&d=identicon&r=PG", "display_name": "BrunoMedeiros", "link": "https://stackoverflow.com/users/393898/brunomedeiros"}, "edited": false, "score": 0, "creation_date": 1422366896, "post_id": 28125392, "comment_id": 44713435, "body": "Not all IDEs hide how the command-line tools work, and in particular, Goclipse doesn&#39;t. But then this means one needs to understand how the command-line tools work, to work with Goclipse effectively. That&#39;s why the example above didn&#39;t work - the go source is not in a layout that the go tools understand: to use go build with &quot;./...&quot;, then the .go files must be in a subfolder of <code>src&#47;</code>. The documentation has been updated to clarify this: <a href=\"https://github.com/GoClipse/goclipse/blob/latest/documentation/UserGuide.md#project-structure\" rel=\"nofollow noreferrer\">github.com/GoClipse/goclipse/blob/latest/documentation/&hellip;</a> (admittedly the IDE could do a better job of warning the user)"}], "tags": [], "owner": {"reputation": 814, "user_id": 4474211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf24f2226878c4c08d709a6efd3355f?s=128&d=identicon&r=PG", "display_name": "tmichel", "link": "https://stackoverflow.com/users/4474211/tmichel"}, "is_accepted": true, "score": 2, "last_activity_date": 1422102115, "creation_date": 1422102115, "answer_id": 28125392, "question_id": 28122455, "link": "https://stackoverflow.com/questions/28122455/issue-running-golang-hello-world-in-eclipse/28125392#28125392", "title": "Issue running golang Hello World in eclipse", "body": "<p>If you don't use the <a href=\"https://golang.org/doc/code.html#GOPATH\" rel=\"nofollow\"><code>GOPATH</code></a> environment variable and you don't put your project folder under <code>$GOPATH/src</code> the compiler won't find it. As I see it goclipse lets you skip the <code>GOPATH</code> entirely but in this case you have to put your code under the <code>src</code> directory that you can see in the Project Explorer. See the <a href=\"https://github.com/GoClipse/goclipse/blob/4162eab4ac3fbe5f0741179f2502e212a4c3fdd4/documentation/UserGuide.md#project-structure\" rel=\"nofollow\">related section of the goclipe documentation</a>.</p>\n\n<p>Although I think you make your life harder by using a full-fetched IDE for go development. Just use the command line tools. And it has the added benefit that you will actually understand what's going on (IDEs hide this from you).</p>\n\n<p>So for building you can use <code>go build</code> or <code>go install</code>. The latter will copy the binary to your <code>$GOPATH/bin</code> directory. For running test just call <code>go test</code> or <code>go test path/to/package</code>. There is a hidden gem in the <code>go</code> tool: when you are working with multiple packages in the same directory you can use <code>go test ./...</code> to test all of them at once. This also works with other go commands.</p>\n"}], "owner": {"reputation": 453, "user_id": 3895044, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/04f5cfc310395e48c2877e599c0d3a28?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian773", "link": "https://stackoverflow.com/users/3895044/adrian773"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2439, "favorite_count": 0, "accepted_answer_id": 28125392, "answer_count": 1, "score": 2, "last_activity_date": 1422215106, "creation_date": 1422075604, "last_edit_date": 1422215106, "question_id": 28122455, "link": "https://stackoverflow.com/questions/28122455/issue-running-golang-hello-world-in-eclipse", "title": "Issue running golang Hello World in eclipse", "body": "<p>Alright, so just a disclaimer I suspect this question will be a duplicate of another question however I'm not even sure what to search for. </p>\n\n<p>I have never used Eclipse or Golang before and am attempting to get a basic hello world application to work.</p>\n\n<p>I have installed the goclipse plugin, created a new go package and go command source file. From what I have read to run a project in Eclipse you right click the package, select Run as then set the run configurations. The problem occurs when I attempt to select the go package as none shows up and if I leave it blank it throws a 'Go package not found' exception. </p>\n\n<p><img src=\"https://i.stack.imgur.com/2MsYs.png\" alt=\"enter image description here\"></p>\n\n<p>Thank you for any help you can provide.</p>\n\n<p>EDIT: Upon the answers advice I have decided to go with the basic command line, however a friend did also recommend LiteIDE. I will \"assume\" tmichels answer is correct in regards to getting Go to work within eclipse. </p>\n"}, {"tags": ["github", "go", "badge"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1422080905, "post_id": 28121981, "comment_id": 44619738, "body": "GitHub proxies and caches images. They originally did it for http only to avoid mixed content warnings, but at some point they started to proxy https images as well. If you view the source of the README, you will see that the image URL is not the same as the one in the markdown source. I suspect they proxy images to prevent third parties from collecting information about GitHub users."}, {"owner": {"reputation": 787, "user_id": 2614250, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/eUIEo.jpg?s=128&g=1", "display_name": "Minhaz", "link": "https://stackoverflow.com/users/2614250/minhaz"}, "edited": false, "score": 0, "creation_date": 1427669491, "post_id": 28121981, "comment_id": 46860034, "body": "This problem can still be solved using <code>no cache</code> and proper <code>Etag</code> header I believe because services like <code>travis ci</code> have proper implementation for this"}], "answers": [{"comments": [{"owner": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "edited": false, "score": 0, "creation_date": 1422071833, "post_id": 28121992, "comment_id": 44618246, "body": "Yes, but look at the image that this link provides: <a href=\"https://github-shields.com/github/maddyonline/copyshields/issues/1.svg\" rel=\"nofollow noreferrer\">github-shields.com/github/maddyonline/copyshields/issues/1.s&zwnj;&#8203;vg</a>, but the github page (<a href=\"https://github.com/maddyonline/copyshields\" rel=\"nofollow noreferrer\">github.com/maddyonline/copyshields</a>)  using this link  in README is not getting updated automatically with the image that this url outputs."}, {"owner": {"reputation": 331062, "user_id": 139010, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0df2f3c2d3b43605889eb90231fb6884?s=128&d=identicon&r=PG", "display_name": "Matt Ball", "link": "https://stackoverflow.com/users/139010/matt-ball"}, "reply_to_user": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "edited": false, "score": 0, "creation_date": 1422077598, "post_id": 28121992, "comment_id": 44619176, "body": "The image in the README <b>is</b> updated. It&#39;s likely just browser caching that you&#39;re seeing. <a href=\"http://i.stack.imgur.com/oxBXF.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/oxBXF.png</a>"}], "tags": [], "owner": {"reputation": 331062, "user_id": 139010, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0df2f3c2d3b43605889eb90231fb6884?s=128&d=identicon&r=PG", "display_name": "Matt Ball", "link": "https://stackoverflow.com/users/139010/matt-ball"}, "is_accepted": false, "score": 3, "last_activity_date": 1422070389, "creation_date": 1422070389, "answer_id": 28121992, "question_id": 28121981, "link": "https://stackoverflow.com/questions/28121981/how-to-make-dynamic-github-badges-that-is-images-in-readme-which-change-state/28121992#28121992", "title": "How to make dynamic github badges, that is, images in README which change state?", "body": "<p>It's just an image at a URL. It's up to the server <a href=\"https://wiki.jenkins-ci.org/display/JENKINS/Embeddable+Build+Status+Plugin\" rel=\"nofollow\">(your example looks like Jenkins)</a> to decide what image to provide.</p>\n"}], "owner": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2152, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1422070389, "creation_date": 1422070286, "question_id": 28121981, "link": "https://stackoverflow.com/questions/28121981/how-to-make-dynamic-github-badges-that-is-images-in-readme-which-change-state", "title": "How to make dynamic github badges, that is, images in README which change state?", "body": "<p>How do you add a \"badge\" in GitHub README so that it is dynamic? By \"badge\", I mean <img src=\"https://i.stack.imgur.com/LPdPH.png\" alt=\"enter image description here\"></p>\n\n<p>The question is even if one puts a URL in GitHub README which maps to a server returning an svg/png, how does it update automatically on GitHub README page?</p>\n\n<p>As an example if you visit the <a href=\"https://github-shields.com/github/maddyonline/copyshields/issues/1.svg\" rel=\"nofollow noreferrer\">link</a>\n, you'd see the updated status of the issue (which is closed), but my GitHub <a href=\"https://github.com/maddyonline/copyshields\" rel=\"nofollow noreferrer\">README page</a> still shows outdated badge, that is, shows the issue being open.</p>\n\n<p>What is an example server code (say in golang) which can render github badges dynamically?</p>\n"}, {"tags": ["go", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "edited": false, "score": 0, "creation_date": 1422076448, "post_id": 28122403, "comment_id": 44618983, "body": "Thanks @John. It looks like the API has changed as <code>home.Path</code> returns a <code>Route</code> type and it does not have <code>StrictSlash</code> method. I have updated my answer with a workaround but it does not use a Subroute."}, {"owner": {"reputation": 151, "user_id": 4488916, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4YIsYO-CEGo/AAAAAAAAAAI/AAAAAAAAAyk/OhXyn62ljOA/photo.jpg?sz=128", "display_name": "John Adams", "link": "https://stackoverflow.com/users/4488916/john-adams"}, "reply_to_user": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "edited": false, "score": 0, "creation_date": 1422246339, "post_id": 28122403, "comment_id": 44661379, "body": "The issue you were having was due to not using PathPrefix when defining the home Subrouter"}, {"owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "edited": false, "score": 0, "creation_date": 1422331492, "post_id": 28122403, "comment_id": 44697079, "body": "Thanks, that works! You will have to add <code>StrictSlash(true)</code> at the end (your code does not have the input param <code>true</code>). Could you please update it when you get a chance so it will be fully functional?"}], "tags": [], "owner": {"reputation": 151, "user_id": 4488916, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4YIsYO-CEGo/AAAAAAAAAAI/AAAAAAAAAyk/OhXyn62ljOA/photo.jpg?sz=128", "display_name": "John Adams", "link": "https://stackoverflow.com/users/4488916/john-adams"}, "is_accepted": true, "score": 3, "last_activity_date": 1422419777, "last_edit_date": 1422419777, "creation_date": 1422074888, "answer_id": 28122403, "question_id": 28121681, "link": "https://stackoverflow.com/questions/28121681/reversing-a-subrouter-in-gorilla-mux/28122403#28122403", "title": "Reversing a Subrouter in Gorilla / Mux", "body": "<p>I believe you'd need to specify your subroute with a PathPrefix, then in order to support /home and /home/ enable StrictSlash (<a href=\"https://github.com/gorilla/mux/issues/31\" rel=\"nofollow\">due to this issue</a>)</p>\n\n<pre><code>router := mux.NewRouter() \nhome := router.PathPrefix(\"/home\").Subrouter().StrictSlash(true)\nhome.Path(\"/\").Methods(\"GET\").HandlerFunc(GetHomeHandler).Name(\"home\")\nhome.Path(\"/post/\").Methods(\"POST\").HandlerFunc(PostHomeHandler).Name(\"home-post\")\n\n\np, err := router.Get(\"home\").URL()\nif (err != nil) { panic (err) }\nlog.Printf(p.Path)\n\np, err = home.Get(\"home-post\").URL()\nif (err != nil) { panic (err) }\nlog.Printf(p.Path)\n</code></pre>\n"}], "owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "accepted_answer_id": 28122403, "answer_count": 1, "score": 2, "last_activity_date": 1422419777, "creation_date": 1422066338, "last_edit_date": 1422076543, "question_id": 28121681, "link": "https://stackoverflow.com/questions/28121681/reversing-a-subrouter-in-gorilla-mux", "title": "Reversing a Subrouter in Gorilla / Mux", "body": "<p>I would like to get the path for a named subroute but my code below does not work. When I try to use the same logic on a non-subroute, it works fine. How do I get the path of a named subroute? </p>\n\n<pre><code>router = mux.NewRouter() // this is a global variable\nhome := router.Path(\"/home\").Subrouter()\nhome.Methods(\"GET\").HandlerFunc(c.GetHomeHandler).Name(\"home\")\nhome.Methods(\"POST\").HandlerFunc(c.PostHomeHandler)\n\np, err := router.Get(\"home\").URL()\nif (err != nil) { panic (err) }\nlog.Printf(p.Path)\n</code></pre>\n\n<p>The above gives this error:</p>\n\n<pre><code>panic: mux: route doesn't have a host or path\n</code></pre>\n\n<p>Now if I do  <code>router.HandleFunc(\"/home\", c.GetHomeHandler).Name(\"home\")</code>, it works just fine. </p>\n\n<p>Appreciate your help.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>This is a reasonable workaround but it avoids creating a Subroute. It is fine for the example I had above but probably not ideal as you will not get all the benefits of a Subroute. </p>\n\n<pre><code>router.Path(\"/home\").Methods(\"GET\").HandlerFunc(c.GetHomeHandler).Name(\"home\")\nrouter.Path(\"/home\").Methods(\"POST\").HandlerFunc(c.PostHomeHandler)\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["interface", "go"], "comments": [{"owner": {"reputation": 2240, "user_id": 4099598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc50a32e3a3dffad460e83c0e02f6ba?s=128&d=identicon&r=PG", "display_name": "Nathan Tuggy", "link": "https://stackoverflow.com/users/4099598/nathan-tuggy"}, "edited": false, "score": 3, "creation_date": 1422062579, "post_id": 28121260, "comment_id": 44616770, "body": "In the future, please include all relevant code in your post and <b>don&#39;t</b> just include a link to a code hosting site. Your post should stand alone from any other resource; consider what&#39;d happen if play.golang.org went down in the future."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1422062643, "post_id": 28121260, "comment_id": 44616782, "body": "No error from first code because interface Abc is not used."}, {"owner": {"reputation": 7376, "user_id": 2171928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a2dc8a6d4e15c61451d70f695ac18ae9?s=128&d=identicon&r=PG", "display_name": "Kishore Vaishnav", "link": "https://stackoverflow.com/users/2171928/kishore-vaishnav"}, "reply_to_user": {"reputation": 2240, "user_id": 4099598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc50a32e3a3dffad460e83c0e02f6ba?s=128&d=identicon&r=PG", "display_name": "Nathan Tuggy", "link": "https://stackoverflow.com/users/4099598/nathan-tuggy"}, "edited": false, "score": 0, "creation_date": 1422122474, "post_id": 28121260, "comment_id": 44629888, "body": "@NathanTuggy I learned from other posts stating that as play.golang.org is present so don&#39;t paste the code here and make it complicated. Anyway I don&#39;t have any problem to put here."}, {"owner": {"reputation": 2240, "user_id": 4099598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc50a32e3a3dffad460e83c0e02f6ba?s=128&d=identicon&r=PG", "display_name": "Nathan Tuggy", "link": "https://stackoverflow.com/users/4099598/nathan-tuggy"}, "edited": false, "score": 1, "creation_date": 1422144860, "post_id": 28121260, "comment_id": 44636152, "body": "@KishoreVaishnav whoever told you that was exactly the opposite of right and helpful. <a href=\"http://meta.stackoverflow.com/a/269154/4099598\">Always</a> put the relevant portions of your code directly in your question. (Yes, that&#39;s a site moderator saying that in the link.)"}], "answers": [{"tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": false, "score": 1, "last_activity_date": 1422062724, "creation_date": 1422062724, "answer_id": 28121310, "question_id": 28121260, "link": "https://stackoverflow.com/questions/28121260/erroring-in-serverhttp-but-not-in-my-code-why/28121310#28121310", "title": "Erroring in serverHTTP but not in my code, why?", "body": "<p>You specify an interface <code>Abc</code> with the method <code>CreateTable</code> but none of your variable are actually of type interface <code>Abc</code>\nThis slightly  modified version will bring the error you seek:\n<a href=\"http://play.golang.org/p/ETdexzPYaM\" rel=\"nofollow\">http://play.golang.org/p/ETdexzPYaM</a></p>\n\n<pre><code>package main\n\nimport \"log\"\n\n// Abc asdlkfjaslf as\ntype Abc interface {\n    CreateTable(a, b)\n}\n\ntype a int\ntype b int\n\n// Def klajsdlfkjaslfd\ntype Def int\n\n// // CreateTable laksjdfljasfdl\n// func (d *Def) CreateTable() {\n//  log.Println(\"inside Def CreateTable....\")\n// }\n\nfunc main() {\n    var m1 Abc = Def(5)\n    log.Println(\"inside main %d\", m1)\n}\n</code></pre>\n"}], "owner": {"reputation": 7376, "user_id": 2171928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a2dc8a6d4e15c61451d70f695ac18ae9?s=128&d=identicon&r=PG", "display_name": "Kishore Vaishnav", "link": "https://stackoverflow.com/users/2171928/kishore-vaishnav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1422062724, "creation_date": 1422062202, "question_id": 28121260, "link": "https://stackoverflow.com/questions/28121260/erroring-in-serverhttp-but-not-in-my-code-why", "title": "Erroring in serverHTTP but not in my code, why?", "body": "<p>First code: <a href=\"http://play.golang.org/p/OEDetydMbW\" rel=\"nofollow\">http://play.golang.org/p/OEDetydMbW</a></p>\n\n<p>Second code: <a href=\"http://play.golang.org/p/QZIrWALAm_\" rel=\"nofollow\">http://play.golang.org/p/QZIrWALAm_</a></p>\n\n<p>Can somebody explain me why I am not getting error on First code, I was expecting to error out stating <code>missing CreateTable method</code>.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3883, "user_id": 92694, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3e0b5461e0e5c733af00292ec2d15c83?s=128&d=identicon&r=PG", "display_name": "DragonFax", "link": "https://stackoverflow.com/users/92694/dragonfax"}, "edited": false, "score": 0, "creation_date": 1422211468, "post_id": 28120967, "comment_id": 44651598, "body": "Or make both functions return a value?"}, {"owner": {"reputation": 3883, "user_id": 92694, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3e0b5461e0e5c733af00292ec2d15c83?s=128&d=identicon&r=PG", "display_name": "DragonFax", "link": "https://stackoverflow.com/users/92694/dragonfax"}, "edited": false, "score": 0, "creation_date": 1422211498, "post_id": 28120967, "comment_id": 44651610, "body": "Method Values?! I didn&#39;t even know Go had that. Thats awesome. Thanks a lot!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1422059843, "last_edit_date": 1422059843, "creation_date": 1422059529, "answer_id": 28120967, "question_id": 28120871, "link": "https://stackoverflow.com/questions/28120871/passing-a-method-on-an-instance-of-a-struct-as-a-parameter/28120967#28120967", "title": "passing a method on an instance of a struct as a parameter", "body": "<p>You can use a <a href=\"https://golang.org/ref/spec#Method_values\" rel=\"nofollow\">method value</a>.  Here's something similar to your example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc send(n int, c func(x int)) {\n    c(n)\n}\n\ntype data struct {\n    value int\n}\n\nfunc (t *data) set(x int) {\n    t.value = x\n}\n\nfunc main() {\n    d := data{1}\n    fmt.Println(d)\n    send(2, d.set)\n    fmt.Println(d)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/-7OoCCcARi\" rel=\"nofollow\">playground example</a></p>\n\n<p>I could not use the types in the question because the function argument to send returns a value and the method does not. If you do need to use the types in the question, then use an anonymous function to adapt the method to the function argument type:</p>\n\n<pre><code> send(2, func(v int) int { d.set(v); return 0 })\n</code></pre>\n"}], "owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 28120967, "answer_count": 1, "score": 0, "last_activity_date": 1422059843, "creation_date": 1422058774, "question_id": 28120871, "link": "https://stackoverflow.com/questions/28120871/passing-a-method-on-an-instance-of-a-struct-as-a-parameter", "title": "passing a method on an instance of a struct as a parameter", "body": "<p>I have a function that accepts a function as a parameter:</p>\n\n<pre><code>func send(n int, c func(x int) int) int {\n    return c(n)\n}\n</code></pre>\n\n<p>and I have a structure with a method defined on it</p>\n\n<pre><code>type data struct {\n    value int\n}\n\nfunc (t *data) set(x int) {\n    t.value = x\n}\n</code></pre>\n\n<p>I would like to create an instance of the structure and pass method <code>set</code> bound to this instance to the <code>send</code> function as the second parameter, to set the <code>value</code> field from <code>send</code>.</p>\n\n<p>Is this possible?</p>\n\n<p><a href=\"https://play.golang.org/p/bv1JevQBcq\" rel=\"nofollow\">https://play.golang.org/p/bv1JevQBcq</a></p>\n"}, {"tags": ["arrays", "multidimensional-array", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1422056240, "post_id": 28120321, "comment_id": 44615155, "body": "Nitpick: These are not arrays but slices."}, {"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1422220046, "post_id": 28120321, "comment_id": 44654610, "body": "Also, show your code.  Make it easier for people who want to help you to reproduce the problem you&#39;re seeing."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 9, "last_activity_date": 1422056171, "creation_date": 1422056171, "answer_id": 28120459, "question_id": 28120321, "link": "https://stackoverflow.com/questions/28120321/appending-2-dimensional-slices-in-go/28120459#28120459", "title": "Appending 2 dimensional slices in Go", "body": "<p>Use <code>...</code> to pass the second slice as <a href=\"https://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"noreferrer\">variadic</a> parameters to append. For example:</p>\n\n<pre><code>a := [][]string{{\"a\", \"b\"}, {\"c\", \"d\"}}\nb := [][]string{{\"1\", \"2\"}, {\"3\", \"4\"}}\na = append(a, b...)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/W1AYFLXlT1\" rel=\"noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 17465, "user_id": 559850, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/vJfye.jpg?s=128&g=1", "display_name": "styler1972", "link": "https://stackoverflow.com/users/559850/styler1972"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4676, "favorite_count": 1, "accepted_answer_id": 28120459, "answer_count": 1, "score": 2, "last_activity_date": 1558123803, "creation_date": 1422055202, "last_edit_date": 1558123803, "question_id": 28120321, "link": "https://stackoverflow.com/questions/28120321/appending-2-dimensional-slices-in-go", "title": "Appending 2 dimensional slices in Go", "body": "<p>I have a couple 2 dimensional slices in my Go program and I want to join them together.</p>\n\n<p>However, <code>append()</code> doesn't take this type.</p>\n\n<p><code>cannot use myArray (type [][]string) as type []string in append</code></p>\n\n<p>How do you append multi-dimensional slices using Go in an idiomatic way?</p>\n"}, {"tags": ["struct", "reference", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "edited": false, "score": 0, "creation_date": 1422056002, "post_id": 28119798, "comment_id": 44615081, "body": "Thanks, the reason for the pointer is because I will be marshal-ing the data in to JSON and that is how Andrew Gerrand from Google told me to do it so I do not have empty elements showing up in the JSON data."}, {"owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "reply_to_user": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "edited": false, "score": 3, "creation_date": 1422056966, "post_id": 28119798, "comment_id": 44615361, "body": "And that&#39;s true for non-reference Go types, e. g. for mapping JSON objects to structs, or JSON numbers to ints. But slices themselves can be nil, represented as null. <a href=\"http://play.golang.org/p/psN_WIcCo4\" rel=\"nofollow noreferrer\">play.golang.org/p/psN_WIcCo4</a>"}, {"owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "edited": false, "score": 0, "creation_date": 1422059260, "post_id": 28119798, "comment_id": 44616006, "body": "Great.  I now understand Andrew&#39;s comments better... Thanks for all of your feedback.  This really helps me."}], "tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": true, "score": 4, "last_activity_date": 1422054824, "last_edit_date": 1422054824, "creation_date": 1422052219, "answer_id": 28119798, "question_id": 28119707, "link": "https://stackoverflow.com/questions/28119707/golang-problems-with-referencing-arrays-of-sub-structures/28119798#28119798", "title": "Golang problems with referencing arrays of sub structures", "body": "<p>First, <code>*[]Home</code> is really wasteful. A slice is a three worded struct under the hood, one of them being itself a pointer to an array. You are introducing a double indirection there. <a href=\"http://research.swtch.com/godata\" rel=\"nofollow\">This article on data structures in Go</a> is very useful.</p>\n\n<p>Now, because of this indirection, you need to put the dereference operator <code>*</code> in every pointer-to-slice expression. Like this:</p>\n\n<pre><code>fmt.Println((*(*n.Homes)[0].Rooms)[0].Size)\n</code></pre>\n\n<p>But, really, just take out the pointers.</p>\n"}], "owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 28119798, "answer_count": 1, "score": 0, "last_activity_date": 1422054824, "creation_date": 1422051771, "last_edit_date": 1422053018, "question_id": 28119707, "link": "https://stackoverflow.com/questions/28119707/golang-problems-with-referencing-arrays-of-sub-structures", "title": "Golang problems with referencing arrays of sub structures", "body": "<p>I am having a problem figuring out how to reference elements of a sub structure.  </p>\n\n<p>See: <a href=\"http://play.golang.org/p/pamS_ZY01s\" rel=\"nofollow\">http://play.golang.org/p/pamS_ZY01s</a></p>\n\n<p>Given something like following....  How do you reference data in the room struct?  I have tried <code>fmt.Println(*n.Homes[0].Rooms[0].Size)</code>, but that does not work.</p>\n\n<p>Begin Code example</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Neighborhood struct {\n    Name  string\n    Homes *[]Home\n}\n\ntype Home struct {\n    Color string\n    Rooms *[]Room\n}\n\ntype Room struct {\n    Size string\n}\n\nfunc main() {\n    var n Neighborhood\n    var h1 Home\n    var r1 Room\n\n    n.Name = \"Mountain Village\"\n    h1.Color = \"Blue\"\n    r1.Size = \"200 sq feet\"\n\n    // Initiaize Array of Homes\n    homeslice := make([]Home, 0)\n    n.Homes = &amp;homeslice\n\n    roomslice := make([]Room, 0)\n    h1.Rooms = &amp;roomslice\n\n    *h1.Rooms = append(*h1.Rooms, r1)\n    *n.Homes = append(*n.Homes, h1)\n\n    fmt.Println(n)\n    fmt.Println(*n.Homes)\n\n}\n</code></pre>\n"}, {"tags": ["json", "go", "bson"], "answers": [{"tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": false, "score": 1, "last_activity_date": 1422051254, "creation_date": 1422051254, "answer_id": 28119604, "question_id": 28119490, "link": "https://stackoverflow.com/questions/28119490/unmarshalling-oid-and-date-json-bson-to-go/28119604#28119604", "title": "Unmarshalling $oid and $date json/bson to go", "body": "<p>If you know the format of the JSON you're getting, the best you can do is to design a struct with the same format.</p>\n\n<pre><code>type MyJSON struct {\n    Dt struct {\n        Date int64 `json:\"$date\"`\n    } `json:\"dt\"`\n    Id struct {\n        Oid string `json:\"$oid\"`\n    } `json:\"_id\"`\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/C2Bc7kf0B8\" rel=\"nofollow\">http://play.golang.org/p/C2Bc7kf0B8</a></p>\n"}, {"comments": [{"owner": {"reputation": 601, "user_id": 4488156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1d8c4a11ea96f0de5e8cdd12cd6b46a?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar Etzioni", "link": "https://stackoverflow.com/users/4488156/zohar-etzioni"}, "edited": false, "score": 0, "creation_date": 1422052806, "post_id": 28119618, "comment_id": 44614020, "body": "var v struct {     ID bson.ObjectID <code>bson:&quot;_id&quot;</code>     Dt time.Time  }  is ideally what I&#39;d like to do but is there a way to do it given the json string I&#39;m getting?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 601, "user_id": 4488156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1d8c4a11ea96f0de5e8cdd12cd6b46a?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar Etzioni", "link": "https://stackoverflow.com/users/4488156/zohar-etzioni"}, "edited": false, "score": 0, "creation_date": 1422053792, "post_id": 28119618, "comment_id": 44614359, "body": "There is not a direct way. The only option is to unmarshal to one struct and manually copy to the other.  I&#39;d try to get the BSON directly and use the BSON marshaler on it."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1422051307, "creation_date": 1422051307, "answer_id": 28119618, "question_id": 28119490, "link": "https://stackoverflow.com/questions/28119490/unmarshalling-oid-and-date-json-bson-to-go/28119618#28119618", "title": "Unmarshalling $oid and $date json/bson to go", "body": "<p>Here's one way to unmarshal the JSON to Go:</p>\n\n<pre><code>d := []byte(`{\"dt\": {\"$date\": 1422019966844}, \"_id\": {\"$oid\": \"54c24d7eabb7c06d4f000371\"}}`)\nvar v struct {\n    Dt struct {\n        Date int64 `json:\"$date\"`\n    }\n    ID struct {\n        OID string `json:\"$oid\"`\n    } `json:\"_id\"`\n}\nerr := json.Unmarshal(d, &amp;v)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/wRLfhd2Rrj\" rel=\"nofollow\">playground example</a></p>\n\n<p>You probably want to unmarshal to something like:</p>\n\n<pre><code> var v struct {\n    ID bson.ObjectID `bson:\"_id\"`\n    Dt time.Time\n }\n</code></pre>\n\n<p>I suggest unmarshalling the original BSON instead of the Javascript client's representation of the BSON.</p>\n"}], "owner": {"reputation": 601, "user_id": 4488156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1d8c4a11ea96f0de5e8cdd12cd6b46a?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar Etzioni", "link": "https://stackoverflow.com/users/4488156/zohar-etzioni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1428395200, "creation_date": 1422050724, "last_edit_date": 1428395200, "question_id": 28119490, "link": "https://stackoverflow.com/questions/28119490/unmarshalling-oid-and-date-json-bson-to-go", "title": "Unmarshalling $oid and $date json/bson to go", "body": "<p>I'm trying to unmarshal the following json string in go:</p>\n\n<pre><code>{\"dt\": {\"$date\": 1422019966844}, \"_id\": {\"$oid\": \"54c24d7eabb7c06d4f000371\"}}\n</code></pre>\n\n<p>I've tried a number of different ways to unmarshal this but couldn't find a way that works. What is the idiomatic way to unmarshal that to an object?</p>\n\n<p>Thanks,\nZ.</p>\n"}, {"tags": ["go", "system-calls"], "answers": [{"comments": [{"owner": {"reputation": 48731, "user_id": 329700, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/41910a452554b187d044c00c576866b1?s=128&d=identicon&r=PG", "display_name": "Kevin Burke", "link": "https://stackoverflow.com/users/329700/kevin-burke"}, "edited": false, "score": 0, "creation_date": 1422050077, "post_id": 28119303, "comment_id": 44612923, "body": "As I explained in the question, I tried converting to an int, and I get the compile time error <code>cannot convert err (type error) to type int</code>"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428177670, "post_id": 28119303, "comment_id": 47067549, "body": "Also note that this is in the <code>syscall</code> package which can have different definitions on different operating systems."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1422050234, "last_edit_date": 1422050234, "creation_date": 1422049870, "answer_id": 28119303, "question_id": 28119214, "link": "https://stackoverflow.com/questions/28119214/how-do-you-pass-syscall-errno-to-os-exit/28119303#28119303", "title": "How do you pass syscall.Errno to os.Exit?", "body": "<p>You can normally just convert a <code>syscall.Errno</code> to an int</p>\n\n<pre><code>if err == syscall.EAGAIN {\n    os.Exit(int(err))\n}\n</code></pre>\n\n<p><a href=\"http://golang.org/pkg/syscall/#Errno\" rel=\"nofollow\"><code>syscall.Errno</code></a> is defined as a <code>uintptr</code>, which can be converted directly to an <code>int</code>. There's no interface, assertion, or reflection involved.</p>\n\n<p>But when receiving it as an <code>error</code> interface, you need to assert it first.</p>\n\n<pre><code>if err == syscall.EAGAIN {\n    os.Exit(int(err.(syscall.Errno)))\n}\n</code></pre>\n\n<p>The <code>syscall.Errno</code> is used as a value, not a pointer, no need to try and dereference it with <code>*</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": false, "score": -1, "last_activity_date": 1428177520, "creation_date": 1428177520, "answer_id": 29450843, "question_id": 28119214, "link": "https://stackoverflow.com/questions/28119214/how-do-you-pass-syscall-errno-to-os-exit/29450843#29450843", "title": "How do you pass syscall.Errno to os.Exit?", "body": "<p><strong>Don't use <code>errno</code> values as exit codes.</strong></p>\n\n<p>Exit values and <code>errno</code> values may both be integers, but they otherwise have nothing in common.</p>\n\n<p>In particular, <code>EPERM</code> is often (always?) \"1\" but shells often handle/expect that an exit code of one is \"alternate success\" rather than failure (for example, when <code>grep</code> doesn't find a match).</p>\n\n<p>An additional example,\nthe <a href=\"https://www.freebsd.org/cgi/man.cgi?query=sysexits&amp;sektion=3&amp;manpath=FreeBSD+10.1-RELEASE&amp;format=html\" rel=\"nofollow\">sysexits(3) manpage</a>\nfor the BSDs define some values for use with <code>exit</code>.</p>\n\n<p>However, Go (being more OS agnostic) doesn't use these.\nE.g.\u00a0the flag package exits with \"2\" instead of \"64\" (<code>EX_USAGE</code>) as recommended by BSD. (Note, on BSD 64 as an errno value is <code>EHOSTDOWN</code>).</p>\n"}], "owner": {"reputation": 48731, "user_id": 329700, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/41910a452554b187d044c00c576866b1?s=128&d=identicon&r=PG", "display_name": "Kevin Burke", "link": "https://stackoverflow.com/users/329700/kevin-burke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1199, "favorite_count": 0, "accepted_answer_id": 28119303, "answer_count": 2, "score": -1, "last_activity_date": 1428177520, "creation_date": 1422049526, "question_id": 28119214, "link": "https://stackoverflow.com/questions/28119214/how-do-you-pass-syscall-errno-to-os-exit", "title": "How do you pass syscall.Errno to os.Exit?", "body": "<p>Let's say I try to acquire a lock, fail, and want to exit the program.</p>\n\n<pre><code>err = syscall.Flock(lockfd, syscall.LOCK_EX|syscall.LOCK_NB)\nif err == syscall.EAGAIN {\n    os.Exit(err)\n}\n</code></pre>\n\n<p>The problem is you need to pass an integer to os.Exit.</p>\n\n<p>I've tried:</p>\n\n<pre><code>os.Exit(int(err))\nos.Exit(syscall.EAGAIN)\n\n// Compiles fine, but the cast fails.. no idea why\neerr, _ := err.(*syscall.Errno); os.Exit(int(*eerr)) \n\n// panics\nreflect.ValueOf(err).Int()\n</code></pre>\n\n<p>It seems like you can compare the syscall.Errno to other integers, but actually trying to get the value of it is escaping me...</p>\n"}, {"tags": ["go", "google-compute-engine", "beego"], "comments": [{"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1422042965, "post_id": 28116428, "comment_id": 44609472, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/20396820/socket-programing-permission-denied\">Socket programing Permission denied</a>"}], "answers": [{"tags": [], "owner": {"reputation": 814, "user_id": 4474211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf24f2226878c4c08d709a6efd3355f?s=128&d=identicon&r=PG", "display_name": "tmichel", "link": "https://stackoverflow.com/users/4474211/tmichel"}, "is_accepted": false, "score": 1, "last_activity_date": 1422103003, "creation_date": 1422103003, "answer_id": 28125523, "question_id": 28116428, "link": "https://stackoverflow.com/questions/28116428/running-beego-in-port-80-and-apache/28125523#28125523", "title": "running beego in port 80 and apache", "body": "<p>Ports under 1024 are privileged, so you need root access to run a process that listens on any of them.</p>\n\n<p>For your second question: you can use apache or any other reverse proxy to host your application. This basically means that you run two separate processes (one for apache and one for your application). Apache listens on port 80 and forwards the request that are meant for your application. It is quite easy to <a href=\"http://httpd.apache.org/docs/2.2/mod/mod_proxy.html\" rel=\"nofollow\">set up a the reverse proxy</a> for your vhost.</p>\n"}], "owner": {"reputation": 11, "user_id": 4414018, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000148809896/picture?type=large", "display_name": "lkb", "link": "https://stackoverflow.com/users/4414018/lkb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 595, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422103003, "creation_date": 1422037864, "question_id": 28116428, "link": "https://stackoverflow.com/questions/28116428/running-beego-in-port-80-and-apache", "title": "running beego in port 80 and apache", "body": "<p>I was trying to run my beego in google compute engine instances. I have it running on port 8080. But when I tried to change it to port 80,  it will have an ListenAndServe Permission denied error. What shall I do to make it run on port 80. Also can I serve the beego project using Apache2 so that I can run the project without doing bee run?</p>\n"}, {"tags": ["dictionary", "reflection", "struct", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1422043702, "last_edit_date": 1422043702, "creation_date": 1422036429, "answer_id": 28116053, "question_id": 28115815, "link": "https://stackoverflow.com/questions/28115815/assigning-a-value-to-struct-member-through-reflection-in-go/28116053#28116053", "title": "Assigning a value to struct member through reflection in Go", "body": "<p>Yes, it is possible.</p>\n\n<p><strong>Introduction</strong></p>\n\n<p>Since you want to access and modify the value of a variable (or field), you need to use the <a href=\"http://golang.org/pkg/reflect/#Value\" rel=\"nofollow\"><code>reflect.Value</code></a> type instead of <a href=\"http://golang.org/pkg/reflect/#Type\" rel=\"nofollow\"><code>reflect.Type</code></a>. You can acquire it with <a href=\"http://golang.org/pkg/reflect/#ValueOf\" rel=\"nofollow\"><code>reflect.ValueOf()</code></a>. Also in order to modify it with reflection, you need to pass the address (a pointer) of the <code>struct</code> or value you want to modify (else you could only read it but not modify it).</p>\n\n<p>But you don't want to modify the address/pointer but the <em>pointed</em> value, so you have to \"navigate\" from the <code>Value</code> of the pointer to the <code>Value</code> of the pointed variable (struct), this is what <a href=\"http://golang.org/pkg/reflect/#Value.Elem\" rel=\"nofollow\"><code>Value.Elem()</code></a> is for. It looks like this: <code>reflect.ValueOf(&amp;s).Elem()</code></p>\n\n<p>You can get the <code>Value</code> of a struct field with the <a href=\"http://golang.org/pkg/reflect/#Value.FieldByName\" rel=\"nofollow\"><code>Value.FieldByName()</code></a> method, which since we passed the address of the pointer to the <code>ValueOf()</code> function will be <em>settable</em>.</p>\n\n<p><strong>The Code</strong></p>\n\n<p>The code is much simpler than the introduction once you understand it. You can also try it on the <a href=\"http://play.golang.org/p/dclLzinFok\" rel=\"nofollow\">Go Playground</a>:</p>\n\n<pre><code>var s struct {\n    A, B, C string\n}\ns.A, s.B, s.C = \"a1\", \"b2\", \"c3\"\n\nfmt.Println(\"Before:  \", s)\n\nv := reflect.ValueOf(&amp;s).Elem()\n\nv.FieldByName(\"A\").SetString(\"2a\")\nv.FieldByName(\"B\").SetString(\"2b\")\nv.FieldByName(\"C\").SetString(\"2c\")\n\nfmt.Println(\"After:   \", s)\n\n// Using a map:\nm := map[string]string{\"A\": \"ma\", \"B\": \"mb\", \"C\": \"mc\"}\nfor mk, mv := range m {\n    v.FieldByName(mk).SetString(mv)\n}\n\nfmt.Println(\"From Map:\", s)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Before:   {a1 b2 c3}\nAfter:    {2a 2b 2c}\nFrom Map: {ma mb mc}\n</code></pre>\n\n<p>I recommend to read this blog post to learn the basics of the reflection in Go:</p>\n\n<p><a href=\"http://blog.golang.org/laws-of-reflection\" rel=\"nofollow\"><strong>The Laws of Reflection</strong></a></p>\n"}], "owner": {"reputation": 359, "user_id": 552641, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/279c4f78d46e503ec487e1b50d728ae4?s=128&d=identicon&r=PG", "display_name": "Ken", "link": "https://stackoverflow.com/users/552641/ken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 28116053, "answer_count": 1, "score": 2, "last_activity_date": 1422043702, "creation_date": 1422035614, "last_edit_date": 1422036872, "question_id": 28115815, "link": "https://stackoverflow.com/questions/28115815/assigning-a-value-to-struct-member-through-reflection-in-go", "title": "Assigning a value to struct member through reflection in Go", "body": "<p>I have a struct v with members A, B, C string. Using reflection, I can get the names of the fields and their values:</p>\n\n<pre><code>typ := v.Type()\nfor i := 0; i &lt; v.NumField(); i++ {\n    // gets us a StructField\n    fi := typ.Field(i)\n    fieldname := fi.Name\n    fmt.Println(fieldname)\n    val := fmt.Sprintf(\"%v\", v.Field(i).Interface())\n }\n</code></pre>\n\n<p>since I have the name, and can get the value OUT, can I assign new values to the fields? I would like to do essentially:</p>\n\n<pre><code>v.Field(fieldname).Interface() = \"new value\"\n</code></pre>\n\n<p>but that obviously doesn't work. Is it possible to assign a value into a struct if you only know the name of the field?</p>\n\n<p>In practice, I'm trying to assign values from a <code>map[string]string</code> to corresponding fields in a struct, where the struct and map definitions may expand of change over time, and the map may contain more, or less, values than the struct. I've considered doing it w/JSON, but that approach leaves me a little cold, seeing as how easy it was to use reflection to get \"almost\" there!</p>\n\n<p>Thanks,\nKen</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 1, "creation_date": 1422045219, "post_id": 28115599, "comment_id": 44610546, "body": "<a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">blog.golang.org/go-slices-usage-and-internals</a> as well as <a href=\"http://blog.golang.org/slices\" rel=\"nofollow noreferrer\">blog.golang.org/slices</a> may be relevant to your question."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 2, "creation_date": 1422278129, "post_id": 28115599, "comment_id": 44672720, "body": "See also <a href=\"http://stackoverflow.com/questions/17332227/big-o-of-append-in-golang\" title=\"big o of append in golang\">stackoverflow.com/questions/17332227/big-o-of-append-in-gola&zwnj;&#8203;ng</a>"}], "answers": [{"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 5, "last_activity_date": 1422035551, "creation_date": 1422035551, "answer_id": 28115801, "question_id": 28115599, "link": "https://stackoverflow.com/questions/28115599/when-does-golang-append-create-a-new-slice/28115801#28115801", "title": "When does Golang append() create a new slice?", "body": "<p>When <code>append()</code> creates a new slice, it doesn't create a slice that's just one larger than the slice before. It actually creates a slice that is already a couple of elements larger than the previous one. Have a look at this code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var sl []bool\n\n    for i := 0; i &lt; 100; i++ {\n        sl = append(sl, true)\n        fmt.Println(cap(sl))\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/mpkk6IurMB\" rel=\"nofollow\"><kbd>Playground</kbd></a></p>\n\n<p>If you run this code, you see that the capacity initially doubles on every allocation; this strategy is of course changed for larger slice sizes.</p>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 1736306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f31bc8d67cda4208b00c9ff990d19fb?s=128&d=identicon&r=PG", "display_name": "lambda", "link": "https://stackoverflow.com/users/1736306/lambda"}, "edited": false, "score": 0, "creation_date": 1422275076, "post_id": 28143457, "comment_id": 44671293, "body": "Are you saying that append() &#39;returning a new slice&#39; is, in fact, simply making an identical slice descriptor, but increasing the capacity value? I appreciate the nuances of the way a slice is represented, but my understanding of &#39;new slice&#39; is allocating an entirely new (extended) memory block with a copy of the data. It seems like the issue is, per FUZxxl&#39;s answer, that the capacity is extended by more than one element, and so a new slice isn&#39;t created on each iteration."}, {"owner": {"reputation": 171, "user_id": 4493198, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kAjSGsEiJG4/AAAAAAAAAAI/AAAAAAABW2o/rzwHgxgYxY4/photo.jpg?sz=128", "display_name": "iccananea", "link": "https://stackoverflow.com/users/4493198/iccananea"}, "reply_to_user": {"reputation": 103, "user_id": 1736306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f31bc8d67cda4208b00c9ff990d19fb?s=128&d=identicon&r=PG", "display_name": "lambda", "link": "https://stackoverflow.com/users/1736306/lambda"}, "edited": false, "score": 1, "creation_date": 1422277470, "post_id": 28143457, "comment_id": 44672381, "body": "@lambda I&#39;m not. FUZxxl is right in that there is more capacity than need available and hence the data ptr is shared. I&#39;ve added a code snippet to illustrate my point that the same data ptr is being used by both slices."}, {"owner": {"reputation": 103, "user_id": 1736306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f31bc8d67cda4208b00c9ff990d19fb?s=128&d=identicon&r=PG", "display_name": "lambda", "link": "https://stackoverflow.com/users/1736306/lambda"}, "edited": false, "score": 0, "creation_date": 1422280065, "post_id": 28143457, "comment_id": 44673817, "body": "That&#39;s great, thanks for the clarification. The crucial mistake of mine was to assume append() only extended a slice by one element."}], "tags": [], "owner": {"reputation": 171, "user_id": 4493198, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kAjSGsEiJG4/AAAAAAAAAAI/AAAAAAABW2o/rzwHgxgYxY4/photo.jpg?sz=128", "display_name": "iccananea", "link": "https://stackoverflow.com/users/4493198/iccananea"}, "is_accepted": false, "score": 5, "last_activity_date": 1422277413, "last_edit_date": 1422277413, "creation_date": 1422234179, "answer_id": 28143457, "question_id": 28115599, "link": "https://stackoverflow.com/questions/28115599/when-does-golang-append-create-a-new-slice/28143457#28143457", "title": "When does Golang append() create a new slice?", "body": "<p>You are confusing slice, the data type, with the actual representation. <a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"noreferrer\">The slice descriptor</a> is composed of a pair of ints, one for len and one for cap, and a pointer to the underlying data.</p>\n\n<p>So, what append returns is indeed a new slice and what is passed to add option is indeed a copy of the slice descriptor. But since the descriptor has a pointer to data, the pointer value (the address to the underlying data) is the same.</p>\n\n<p><strong>EDIT</strong>: Here is a code snippet to illustrate my point:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    s := make([]int, 0, 5)\n    s = append(s, []int{1, 2, 3, 4}...)\n\n    a := append(s, 5)\n    fmt.Println(a)\n\n    b := append(s, 6)\n    fmt.Println(b)\n    fmt.Println(a)\n}\n</code></pre>\n\n<p>If you <a href=\"http://play.golang.org/p/6ZwyNG1Bpm\" rel=\"noreferrer\">run this</a>, you get:</p>\n\n<pre><code>[1 2 3 4 5]\n[1 2 3 4 6]\n[1 2 3 4 6]\n</code></pre>\n\n<p>Because since <code>s</code> still has capacity, both <code>a</code> and <code>b</code> share the same data ptr. If you change the capacity to 4, it prints:</p>\n\n<pre><code>[1 2 3 4 5]\n[1 2 3 4 6]\n[1 2 3 4 5]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1224, "user_id": 2052755, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ec83e8c62d4ad62a26ab4ee7771177d1?s=128&d=identicon&r=PG", "display_name": "user31986", "link": "https://stackoverflow.com/users/2052755/user31986"}, "is_accepted": false, "score": 0, "last_activity_date": 1455846442, "creation_date": 1455846442, "answer_id": 35495890, "question_id": 28115599, "link": "https://stackoverflow.com/questions/28115599/when-does-golang-append-create-a-new-slice/35495890#35495890", "title": "When does Golang append() create a new slice?", "body": "<p>Ref: <a href=\"http://criticalindirection.com/2016/02/17/slice-with-a-pinch-of-salt/\" rel=\"nofollow\">http://criticalindirection.com/2016/02/17/slice-with-a-pinch-of-salt/</a></p>\n\n<p>According to the link: </p>\n\n<blockquote>\n  <p>Go takes a more lean and lazy approach in doing this. It keeps\n  modifying the same underlying array until the capacity of a slice is\n  reached.</p>\n</blockquote>\n\n<p>This is quite different from the behavior of slices in other languages: </p>\n\n<blockquote>\n  <p>Most languages, like Python, create another copy of the underlying\n  array when any of the slices pointing to it does a write.</p>\n</blockquote>\n\n<p>The output of <a href=\"http://play.golang.org/p/YJ7-67gGzj\" rel=\"nofollow\">example</a> mentioned, explains the behavior.</p>\n\n<pre><code>Slice a len=7 cap=7 [0 0 0 0 0 0 0]\nSlice b refers to the 2, 3, 4 indices in slice a. Hence, the capacity is 5 (= 7-2).\nb := a[2:5]\nSlice b len=3 cap=5 [0 0 0]\n\nModifying slice b, also modifies a, since they are pointing to the same underlying array.\nb[0] = 9\nSlice a len=7 cap=7 [0 0 9 0 0 0 0]\nSlice b len=3 cap=5 [9 0 0]\n\nAppending 1 to slice b. Overwrites a.\nSlice a len=7 cap=7 [0 0 9 0 0 1 0]\nSlice b len=4 cap=5 [9 0 0 1]\n\nAppending 2 to slice b. Overwrites a.\nSlice a len=7 cap=7 [0 0 9 0 0 1 2]\nSlice b len=5 cap=5 [9 0 0 1 2]\n\nAppending 3 to slice b. Here, a new copy is made as the capacity is overloaded.\nSlice a len=7 cap=7 [0 0 9 0 0 1 2]\nSlice b len=6 cap=12 [9 0 0 1 2 3]\n\nVerifying slices a and b point to different underlying arrays after the capacity-overload in the previous step.\nb[1] = 8\nSlice a len=7 cap=7 [0 0 9 0 0 1 2]\nSlice b len=6 cap=12 [9 8 0 1 2 3]\n</code></pre>\n\n<blockquote>\n  <p>Here, in the last verification-step, it feels a bit spooky that any\n  modification to b is no more causing modification to the underlying\n  array pointed to by a. A logical expectation would be that: when b\n  hits the limit, a and b both point to the same newly allocated\n  underlying array, instead of a continuing to point to the older one.</p>\n</blockquote>\n\n<p>Having multiple slices pointing to same underlying array, with frequent <code>append</code> operations can get tricky. More on this in the link above.</p>\n"}], "owner": {"reputation": 103, "user_id": 1736306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f31bc8d67cda4208b00c9ff990d19fb?s=128&d=identicon&r=PG", "display_name": "lambda", "link": "https://stackoverflow.com/users/1736306/lambda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3608, "favorite_count": 0, "accepted_answer_id": 28115801, "answer_count": 3, "score": 7, "last_activity_date": 1540102566, "creation_date": 1422034793, "last_edit_date": 1495540805, "question_id": 28115599, "link": "https://stackoverflow.com/questions/28115599/when-does-golang-append-create-a-new-slice", "title": "When does Golang append() create a new slice?", "body": "<p>According to the <a href=\"http://golang.org/pkg/builtin/#append\" rel=\"nofollow noreferrer\" title=\"builtin append&#40;&#41; docs\">builtin api docs</a>, append() will reallocate and copy to a new array block when the capacity of the original slice is not large enough.</p>\n\n<p>Here is a (simplified version of) a recursive algorithm for creating combinations of an alphabet (in this case booleans). Members of the alphabet (true, false) are recursively added to a slice until it is the correct length, at which point it is sent over the channel.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc AddOption(c chan []bool, combo []bool, length int) {\n    if length == 0 {\n        fmt.Println(combo, \"!\")\n        c &lt;- combo\n        return\n    }\n    var newCombo []bool\n    for _, ch := range []bool{true, false} {\n        newCombo = append(combo, ch)\n        AddOption(c, newCombo, length-1)\n    }\n}\n\nfunc main() {\n    c := make(chan []bool)\n    go func(c chan []bool) {\n        defer close(c)\n        AddOption(c, []bool{}, 4)\n    }(c)\n    for combination := range c {\n        fmt.Println(combination)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/cDnFkaWCMh\" rel=\"nofollow noreferrer\" title=\"Playground\">Here</a> is the playground link to this code. In the output:</p>\n\n<pre><code>[true true true true] !\n[true true true false] !\n[true true true false]\n[true true true false]\n[true true false true] !\n[true true false false] !\n[true true false false]\n[true true false false]\n[true false true true] !\n[true false true false] !\n[true false true false]\n[true false true false]\n[true false false true] !\n[true false false false] !\n[true false false false]\n[true false false false]\n[false true true true] !\n[false true true false] !\n[false true true false]\n[false true true false]\n[false true false true] !\n[false true false false] !\n[false true false false]\n[false true false false]\n[false false true true] !\n[false false true false] !\n[false false true false]\n[false false true false]\n[false false false true] !\n[false false false false] !\n[false false false false]\n[false false false false]\n</code></pre>\n\n<p>Lines ending in an exclamation mark are those sent into the channel from AddOption. Those without are what emerges on the other side (i.e. in main()). It is clear that the slices send over the channel are changed after they are sent.</p>\n\n<p>Since AddOption returns immediately after sending the slice, the modification has to come from the code block </p>\n\n<pre><code>var newCombo []bool\nfor _, ch := range []bool{true, false} {\n    newCombo = append(combo, ch)\n    AddOption(c, newCombo, length-1)\n}\n</code></pre>\n\n<p>But, according to the docs, append() should return a new slice (cap(combo) is not large enough). According to <a href=\"https://stackoverflow.com/a/20197469/1736306\">this answer</a>, the slice descriptor sent to AddOption should be a copy; is that not true? As far as I can tell, either the value sent as the second argument to AddOption() is either a pointer to a slice descriptor, or append() is not returning a new slice.</p>\n"}, {"tags": ["regex", "string", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1422028979, "post_id": 28113770, "comment_id": 44601570, "body": "Check the error returned from ioutil.ReadFile in case there was some error in reading the file."}, {"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1422048032, "post_id": 28113770, "comment_id": 44612013, "body": "body==str is true? If not, you are not reading the same content."}, {"owner": {"reputation": 285, "user_id": 3373877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/532526780ffab7d05fae3a14045c3f8d?s=128&d=identicon&r=PG&f=1", "display_name": "user3373877", "link": "https://stackoverflow.com/users/3373877/user3373877"}, "edited": false, "score": 0, "creation_date": 1422072993, "post_id": 28113770, "comment_id": 44618418, "body": "ioutil.ReadFile is no error."}, {"owner": {"reputation": 285, "user_id": 3373877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/532526780ffab7d05fae3a14045c3f8d?s=128&d=identicon&r=PG&f=1", "display_name": "user3373877", "link": "https://stackoverflow.com/users/3373877/user3373877"}, "edited": false, "score": 0, "creation_date": 1422074406, "post_id": 28113770, "comment_id": 44618653, "body": "why not try to save the str into a file, and then read from the file ,and then do a match?"}], "answers": [{"tags": [], "owner": {"reputation": 7376, "user_id": 2171928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a2dc8a6d4e15c61451d70f695ac18ae9?s=128&d=identicon&r=PG", "display_name": "Kishore Vaishnav", "link": "https://stackoverflow.com/users/2171928/kishore-vaishnav"}, "is_accepted": false, "score": 0, "last_activity_date": 1422171401, "creation_date": 1422171401, "answer_id": 28134277, "question_id": 28113770, "link": "https://stackoverflow.com/questions/28113770/why-not-the-regexp-match-different-from-the-file-and-the-variable/28134277#28134277", "title": "why not the regexp match different from the file and the variable?", "body": "<p>Can you give a try like this...</p>\n\n<pre><code>body, _ := ioutil.ReadFile(\"./ag.xml\") //ap.xml content is the str's contents\nstr := string(body) //str is the above 1 str's contents\nre := regexp.MustCompile(&lt; R o w [^&gt;]*&gt; [\\s\\S.].*({{[range|end].*?}}) &lt; / D a t a &gt; &lt; / C e l l &gt; [\\s\\S]*? &lt; / R o w &gt;)\nfmt.Println(re.MatchString(str))\n</code></pre>\n\n<p>I might have missed spaces inbetween characters, check it once again. If this works out that it means that the file which you are using is UTF16 charset or something but your regexp is matching with the string, so you might need to convert UTF16 to string and match it.</p>\n"}], "owner": {"reputation": 285, "user_id": 3373877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/532526780ffab7d05fae3a14045c3f8d?s=128&d=identicon&r=PG&f=1", "display_name": "user3373877", "link": "https://stackoverflow.com/users/3373877/user3373877"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1422171401, "creation_date": 1422028672, "question_id": 28113770, "link": "https://stackoverflow.com/questions/28113770/why-not-the-regexp-match-different-from-the-file-and-the-variable", "title": "why not the regexp match different from the file and the variable?", "body": "<p>when i do a regexp match using golang. what's the different between the file and the variable?\n1. in var</p>\n\n<pre><code>str:=`&lt;Row ss:Height=\"19.8\"&gt;\n &lt;Cell ss:StyleID=\"s74\"&gt;&lt;Data&gt;{{range $prj:=.prj}}&lt;/Data&gt;&lt;/Cell&gt;\n   &lt;/Row&gt;\n   &lt;Row ss:AutoFitHeight=\"0\" &gt;\n    &lt;Cell ss:StyleID=\"s70\"/&gt;\n    &lt;Cell ss:StyleID=\"s71\"&gt;&lt;Data&gt;{{$prj.PrjName}}&lt;/Data&gt;&lt;/Cell&gt;\n    &lt;Cell ss:StyleID=\"s72\"&gt;&lt;Data&gt;{{$prj.ReplyNo}}&lt;/Data&gt;&lt;/Cell&gt;\n   &lt;/Row&gt;\n   &lt;Row ss:AutoFitHeight=\"0\"&gt;\n   &lt;Cell&gt;&lt;Data&gt;{{end}}&lt;/Data&gt;&lt;/Cell&gt;\n   &lt;/Row&gt;`\n   re := regexp.MustCompile(`&lt;Row[^&gt;]*&gt;[\\s\\S.].*({{[range|end].*?}})&lt;/Data&gt;&lt;/Cell&gt;[\\s\\S]*?&lt;/Row&gt;`)\n   fmt.Println(re.MatchString(str)) //it is true!\n</code></pre>\n\n<ol start=\"2\">\n<li><p>from the file.</p>\n\n<p>body, _ := ioutil.ReadFile(\"./ag.xml\")  //ap.xml content is the str's contents<br>\nstr := string(body) //str is the above 1 str's contents<br>\nre := regexp.MustCompile(<code>&lt;Row[^&gt;]*&gt;[\\s\\S.].*({{[range|end].*?}})&lt;/Data&gt;&lt;/Cell&gt;[\\s\\S]*?&lt;/Row&gt;</code>)<br>\nfmt.Println(re.MatchString(str)) //but the result alaways is false? </p></li>\n</ol>\n\n<p>What's the different in them? how to  solve it?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 0, "creation_date": 1422028054, "post_id": 28113523, "comment_id": 44600920, "body": "ok, but this one won&#39;t work because <code>go fmt</code> will indent the first line."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 0, "creation_date": 1422028143, "post_id": 28113523, "comment_id": 44600973, "body": "@akonsu that is what i just saw indeed. I have edited the answer accordingly."}, {"owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 0, "creation_date": 1422028364, "post_id": 28113523, "comment_id": 44601126, "body": "thanks. this is consistent with the style of the golang code itself: <a href=\"http://golang.org/src/cmd/go/main.go#L174\" rel=\"nofollow noreferrer\">golang.org/src/cmd/go/main.go#L174</a>"}, {"owner": {"reputation": 14450, "user_id": 438615, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Dseeq.jpg?s=128&g=1", "display_name": "Jonah", "link": "https://stackoverflow.com/users/438615/jonah"}, "edited": false, "score": 0, "creation_date": 1551112041, "post_id": 28113523, "comment_id": 96511625, "body": "The way that breaks the indentation of the surrounding code is pretty ugly... This might be the best solution, but it&#39;s not a good one.  Eg, compare with ruby&#39;s <a href=\"http://www.virtuouscode.com/2016/01/06/about-the-ruby-squiggly-heredoc-syntax/\" rel=\"nofollow noreferrer\">squiggly heredoc solution</a> to this same problem."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 14450, "user_id": 438615, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Dseeq.jpg?s=128&g=1", "display_name": "Jonah", "link": "https://stackoverflow.com/users/438615/jonah"}, "edited": false, "score": 2, "creation_date": 1551113633, "post_id": 28113523, "comment_id": 96512525, "body": "@Jonah I agree. I haven&#39;t seen any evolution proposed for Go 2 though... <a href=\"https://github.com/golang/go/issues?page=1&amp;q=is%3Aopen+is%3Aissue+label%3AGo2+string+literal&amp;utf8=%E2%9C%93\" rel=\"nofollow noreferrer\">github.com/golang/go/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 3, "last_activity_date": 1551112551, "last_edit_date": 1551112551, "creation_date": 1422027970, "answer_id": 28113523, "question_id": 28113427, "link": "https://stackoverflow.com/questions/28113427/indentation-style-for-multi-line-string-literals/28113523#28113523", "title": "indentation style for multi-line string literals", "body": "<p>Considering both propositions would add newline or spaces to the litteral string, I would favor (even though <a href=\"http://play.golang.org/p/5phsUhq9N2\" rel=\"nofollow noreferrer\"><code>fmt</code> format the first line</a>):</p>\n\n<pre><code>    select, err = db.Prepare(\n     `select name\nfrom table\nwhere id=$1`)\n</code></pre>\n\n<p>As the <a href=\"https://stackoverflow.com/users/410102/akonsu\">OP akonsu</a>  comments below,  it seems consistent with the style of the golang code itself, as seen in <a href=\"https://github.com/golang/go/blob/5282e3ab26dd01180640a1a0e59ed5a4d070ba44/src/cmd/go/main.go#L175-L198\" rel=\"nofollow noreferrer\"><code>src/cmd/go/main.go#L175</code></a>, which keeps the first line at the level of the opening '<code>(</code>'</p>\n\n<pre><code>var usageTemplate = `Go is a tool for managing Go source code.\nUsage:\ngo command [arguments]\n...\n`\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1610483647, "creation_date": 1610483647, "answer_id": 65691664, "question_id": 28113427, "link": "https://stackoverflow.com/questions/28113427/indentation-style-for-multi-line-string-literals/65691664#65691664", "title": "indentation style for multi-line string literals", "body": "<p>Regarding SQL, the whitespace doesnt matter, so its just a personal preference.\nIn my case, as SQL is a different language from Go, I like to make sure that the\nSQL code shares no lines with Go code:</p>\n<pre><code>if select == nil {\n   select, err = db.Prepare(`\n   select name\n   from table\n   where id = $1\n   `)\n   if err != nil {\n      return nil, err\n   }\n}\n</code></pre>\n"}], "owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6681, "favorite_count": 1, "accepted_answer_id": 28113523, "answer_count": 2, "score": 7, "last_activity_date": 1610483647, "creation_date": 1422027725, "last_edit_date": 1495542511, "question_id": 28113427, "link": "https://stackoverflow.com/questions/28113427/indentation-style-for-multi-line-string-literals", "title": "indentation style for multi-line string literals", "body": "<p>What is the proposed style for indenting a raw string literal? If I indent it based on its first line, it might not align properly in editors that have a different tab length. For example:</p>\n\n<pre><code>if select == nil {\n    select, err = db.Prepare(`select name\n                              from table\n                              where id=$1`)\n    if err != nil {\n        return nil, err\n    }\n}\n</code></pre>\n\n<p>I have found this question, but I am still unclear: <a href=\"https://stackoverflow.com/questions/20940194/best-practice-for-long-string-literals-in-go\">Best practice for long string literals in Go</a></p>\n\n<p>Should I do it like below?</p>\n\n<pre><code>if select == nil {\n    select, err = db.Prepare(`\nselect name\nfrom table\nwhere id=$1`)\n    if err != nil {\n        return nil, err\n    }\n}\n</code></pre>\n"}, {"tags": ["xml", "go", "dtd"], "answers": [{"comments": [{"owner": {"reputation": 9718, "user_id": 87584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f6dfb6c18bce2c8487312b77c32dbc3?s=128&d=identicon&r=PG", "display_name": "Fabien", "link": "https://stackoverflow.com/users/87584/fabien"}, "edited": false, "score": 0, "creation_date": 1422019002, "post_id": 28108323, "comment_id": 44595212, "body": "Hah, not the answer I was expecting, that&#39;s sure. I had seen this solution but was expecting to be able to avoid it. I&#39;ll try to <code>go generate it</code>, good point, thanks a lot. I&#39;ll try to contribute a parser that takes entities into consideration if I find the time."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 2, "last_activity_date": 1422010538, "creation_date": 1422010538, "answer_id": 28108323, "question_id": 28107960, "link": "https://stackoverflow.com/questions/28107960/how-can-i-force-gos-standard-xml-parser-to-read-dtd-entities/28108323#28108323", "title": "How can I force Go&#39;s standard xml parser to read DTD entities", "body": "<p>Probably not the answer you would like to hear...</p>\n\n<p>You could use the <code>Entity</code>-field of <code>http://golang.org/pkg/encoding/xml/#Decoder</code>. Unfortunately I do not know of an automatic way to generate such entity maps from a dtd. But this should be straightforward to extract from the dtd. If the dtd doesn't change this might be a nice task for <code>go generate</code>.</p>\n\n<p>If the list if entities is fixed (and small enough) I would hardcode the entity map.</p>\n"}], "owner": {"reputation": 9718, "user_id": 87584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f6dfb6c18bce2c8487312b77c32dbc3?s=128&d=identicon&r=PG", "display_name": "Fabien", "link": "https://stackoverflow.com/users/87584/fabien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1057, "favorite_count": 0, "accepted_answer_id": 28108323, "answer_count": 1, "score": 1, "last_activity_date": 1422010538, "creation_date": 1422009365, "question_id": 28107960, "link": "https://stackoverflow.com/questions/28107960/how-can-i-force-gos-standard-xml-parser-to-read-dtd-entities", "title": "How can I force Go&#39;s standard xml parser to read DTD entities", "body": "<p>I'm using go's <code>encoding/xml</code> package to parse an XML file. When parsing a file, here's the error I get :</p>\n\n<pre><code>XML syntax error on line 16: invalid character entity &amp;uuml;\n</code></pre>\n\n<p>But the xml file references a dtd :</p>\n\n<pre><code>&lt;!DOCTYPE dblp SYSTEM \"dblp.dtd\"&gt;\n</code></pre>\n\n<p>And that dtd itself contains the definition of that entity :</p>\n\n<pre><code>    &lt;!ENTITY uuml    \"&amp;#252;\" &gt;&lt;!-- small u, dieresis or umlaut mark --&gt;\n</code></pre>\n\n<p>Is there a way to force Go's xml parser to parse DTDs, did I miss something somewhere or am I doomed to use a third-party xml parser ?</p>\n"}, {"tags": ["reflection", "go"], "answers": [{"tags": [], "owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "is_accepted": true, "score": 6, "last_activity_date": 1422008864, "creation_date": 1422008864, "answer_id": 28107799, "question_id": 28105598, "link": "https://stackoverflow.com/questions/28105598/convert-interface-to-its-respecting-map/28107799#28107799", "title": "Convert interface to its respecting map", "body": "<p>Getting the Key type is easy:</p>\n\n<pre><code>reflect.TypeOf(any).Key()\n</code></pre>\n\n<p>To make the entire conversion, you need to create a map value of type <code>map[keyType]interface{}</code> and then copy the values over. Below is a working example how this can be done:</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"reflect\"   \n)\n\nfunc InterfaceMap(i interface{}) (interface{}, error) {\n    // Get type\n    t := reflect.TypeOf(i)\n\n    switch t.Kind() {\n    case reflect.Map:\n        // Get the value of the provided map\n        v := reflect.ValueOf(i)\n\n        // The \"only\" way of making a reflect.Type with interface{}\n        it := reflect.TypeOf((*interface{})(nil)).Elem()\n\n        // Create the map of the specific type. Key type is t.Key(), and element type is it\n        m := reflect.MakeMap(reflect.MapOf(t.Key(), it))\n\n        // Copy values to new map\n        for _, mk := range v.MapKeys() {            \n            m.SetMapIndex(mk, v.MapIndex(mk))\n        }\n\n        return m.Interface(), nil\n\n    }\n\n    return nil, errors.New(\"Unsupported type\")\n}\n\nfunc main() {\n    foo := make(map[string]int)\n    foo[\"anisus\"] = 42\n\n    bar, err := InterfaceMap(foo)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"%#v\\n\", bar.(map[string]interface{}))\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>map[string]interface {}{\"anisus\":42}\n</code></pre>\n\n<p><strong>Playground:</strong> <a href=\"http://play.golang.org/p/tJTapGAs2b\" rel=\"noreferrer\">http://play.golang.org/p/tJTapGAs2b</a></p>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1614, "favorite_count": 1, "accepted_answer_id": 28107799, "answer_count": 1, "score": 4, "last_activity_date": 1422008864, "creation_date": 1422000862, "last_edit_date": 1422001960, "question_id": 28105598, "link": "https://stackoverflow.com/questions/28105598/convert-interface-to-its-respecting-map", "title": "Convert interface to its respecting map", "body": "<p>For example if I have an <code>interface{}</code> value that originally a <code>map[string]map[int64][]int64</code> or any other kind of map, how to get the key type of the map? or more precise, how to convert it to <code>map[theKeyType]interface{}</code>?</p>\n\n<pre><code>func Transverse(any interface{}) string {\n  res := ``\n  switch any.(type) {\n    case string:\n      return ``\n    case []byte:\n      return ``\n    case int, int64, int32:\n      return ``\n    case float32, float64:\n      return ``\n    case bool:\n      return ``\n    case map[int64]interface{}:\n      return ``\n    case map[string]interface{}:\n      return ``\n    case []interface{}:\n      return ``\n    default:\n      kind := reflect.TypeOf(any).Kind()\n      switch kind {\n      case reflect.Map:\n        // how to convert it to map[keyType]interface{} ?\n      }\n      return `` // handle other type\n   }\n   return ``\n}\n</code></pre>\n"}, {"tags": ["intellij-idea", "go"], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1421996726, "post_id": 28104603, "comment_id": 44583994, "body": "Here is another case where Debug is disabled: <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/pull/657\" rel=\"nofollow noreferrer\">github.com/go-lang-plugin-org/go-lang-idea-plugin/pull/657</a>"}, {"owner": {"reputation": 161, "user_id": 4485502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a8e43d04085e718cd979a3055e27fe7?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/4485502/eric"}, "edited": false, "score": 0, "creation_date": 1422000564, "post_id": 28104603, "comment_id": 44585544, "body": "I looked this ,but when I set the params &#39;-l&#39; the Intellij will show Finished building project F:\\goproj\\GitTest.git\\trunk\\src\\test1\\bin/newPackage.exe C:/Go/bin/go.exe build -o F:\\goproj\\GitTest.git\\trunk\\src\\test1\\bin/newPackage.exe -gcflags - -l&#39; newPackage/ flag provided but not defined: -l&#39;"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 161, "user_id": 4485502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a8e43d04085e718cd979a3055e27fe7?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/4485502/eric"}, "edited": false, "score": 0, "creation_date": 1422001537, "post_id": 28104603, "comment_id": 44585968, "body": "@Eric not just <code>- -l</code>: <code>-N -l</code>"}, {"owner": {"reputation": 6499, "user_id": 680372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qQ6rK.jpg?s=128&g=1", "display_name": "pylover", "link": "https://stackoverflow.com/users/680372/pylover"}, "edited": false, "score": 0, "creation_date": 1442921868, "post_id": 28104603, "comment_id": 53273937, "body": "you are the man, after setting the <code>outputDir</code> debugger is working"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1421996938, "last_edit_date": 1421996938, "creation_date": 1421996441, "answer_id": 28104603, "question_id": 28104508, "link": "https://stackoverflow.com/questions/28104508/how-to-use-intellij-idea14-0-2-to-debug-the-golang/28104603#28104603", "title": "How to Use Intellij idea14.0.2 to Debug the golang\uff1f", "body": "<p>The debug feature was introduced by <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/25\" rel=\"nofollow\">issue 25</a>, and <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/commit/3a21e14a9807f6c51ee5bca308a50f15eaa01e9d\" rel=\"nofollow\">commit 3a21e14</a></p>\n\n<blockquote>\n  <p>The correct way is to implement the debugger interfaces in inteliij and to hook them to a running gdb process.</p>\n</blockquote>\n\n<p>(Here is an <a href=\"http://thornydev.blogspot.com/2014/01/debugging-go-golang-programs-with-gdb.html\" rel=\"nofollow\">example of manually calling gdb to debug a Go program</a>; using the options <code>-c -gcflags '-N -l'</code>: not sure if the <code>-l</code> would matter as it is missing from the OP's screenshot \"<code>Go builder arguments</code>\")</p>\n\n<p>It is possible the debug button is disabled if no gcc is configure for the Go debug process to use.</p>\n\n<p>Note also that since <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/pull/644\" rel=\"nofollow\">PR 644</a>:</p>\n\n<blockquote>\n  <p>\"Debug\" is disabled, if \"Build Before run\" is not enabled.<br>\n  This should fix the problem, when <code>gdb</code> wants to run a not existing executable, because the <code>outputDir</code> is not set.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1422005438, "post_id": 28106067, "comment_id": 44587860, "body": "So the PR 644 I mention in the answer was the exact cause of your issue?"}], "tags": [], "owner": {"reputation": 161, "user_id": 4485502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a8e43d04085e718cd979a3055e27fe7?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/4485502/eric"}, "is_accepted": false, "score": 3, "last_activity_date": 1422002902, "creation_date": 1422002902, "answer_id": 28106067, "question_id": 28104508, "link": "https://stackoverflow.com/questions/28104508/how-to-use-intellij-idea14-0-2-to-debug-the-golang/28106067#28106067", "title": "How to Use Intellij idea14.0.2 to Debug the golang\uff1f", "body": "<p><img src=\"https://i.stack.imgur.com/1ZCEY.png\" alt=\"enter image description here\"></p>\n\n<p>thanks ,solved it. \nIntellij Config is not right</p>\n"}, {"comments": [{"owner": {"reputation": 2855, "user_id": 5105305, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-i8lMihc1yYc/AAAAAAAAAAI/AAAAAAAAAJE/ooPD4M12q8I/photo.jpg?sz=128", "display_name": "Kasun Siyambalapitiya", "link": "https://stackoverflow.com/users/5105305/kasun-siyambalapitiya"}, "edited": false, "score": 0, "creation_date": 1505823676, "post_id": 28410649, "comment_id": 79562870, "body": "@disniper can you provide steps in installing the <code>Delve</code> in linux"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 2855, "user_id": 5105305, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-i8lMihc1yYc/AAAAAAAAAAI/AAAAAAAAAJE/ooPD4M12q8I/photo.jpg?sz=128", "display_name": "Kasun Siyambalapitiya", "link": "https://stackoverflow.com/users/5105305/kasun-siyambalapitiya"}, "edited": false, "score": 0, "creation_date": 1599128136, "post_id": 28410649, "comment_id": 112680326, "body": "There is no need to install Delve manually, it&#39;s bundled with the plugin."}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": false, "score": 10, "last_activity_date": 1457387844, "last_edit_date": 1457387844, "creation_date": 1423487524, "answer_id": 28410649, "question_id": 28104508, "link": "https://stackoverflow.com/questions/28104508/how-to-use-intellij-idea14-0-2-to-debug-the-golang/28410649#28410649", "title": "How to Use Intellij idea14.0.2 to Debug the golang\uff1f", "body": "<p>Update. The Go plugin supports Delve on Linux and Mac since September 2015 and on Windows since January 2016.</p>\n\n<p>Original answer:</p>\n\n<p>Currently we are dropping support for the debugger with gdb as it's very hard to use and unstable. Please see <a href=\"https://golang.org/doc/gdb\" rel=\"noreferrer\">the go docs for gdb debugging</a></p>\n\n<p>However, there are efforts in getting <a href=\"https://github.com/derekparker/delve\" rel=\"noreferrer\">the open-source Delve debugger</a>  <a href=\"https://github.com/derekparker/delve/pull/57\" rel=\"noreferrer\">support for IDEs</a> from which IDEA will benefit as well.</p>\n\n<p>Please bug the Go team to support Delve or another debugger in order to have a stable solution and then integration with IDEA could be done.</p>\n"}], "owner": {"reputation": 161, "user_id": 4485502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a8e43d04085e718cd979a3055e27fe7?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/4485502/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20384, "favorite_count": 5, "answer_count": 3, "score": 12, "last_activity_date": 1457387844, "creation_date": 1421996000, "last_edit_date": 1421996798, "question_id": 28104508, "link": "https://stackoverflow.com/questions/28104508/how-to-use-intellij-idea14-0-2-to-debug-the-golang", "title": "How to Use Intellij idea14.0.2 to Debug the golang\uff1f", "body": "<p>The Debug button is disable, <kbd>Shift</kbd>+<kbd>Alt</kbd>+<kbd>F9</kbd> will show this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Rw33L.png\" alt=\"debug button is disabled\"></p>\n\n<p>How to properly configure  the debug page?</p>\n\n<p><img src=\"https://i.stack.imgur.com/aBCCe.png\" alt=\"the confige page\"></p>\n"}, {"tags": ["c++", "go"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1421982858, "post_id": 28102434, "comment_id": 44580172, "body": "I don&#39;t see any code here for <code>myFunction()</code>."}, {"owner": {"reputation": 1632, "user_id": 1580190, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/2083c14a176bd7ab5c9e6f53ea021aee?s=128&d=identicon&r=PG", "display_name": "Puzzler3141", "link": "https://stackoverflow.com/users/1580190/puzzler3141"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1421982968, "post_id": 28102434, "comment_id": 44580196, "body": "@RobertHarvey Does the implementation of myFunction matter? Its included in <code>otherMain.cpp</code>"}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1421983014, "post_id": 28102434, "comment_id": 44580207, "body": "You might as well show us all of the relevant moving parts.  Otherwise, how are we supposed to diagnose it?  Include the code for <code>othermain.hpp</code> in your question, if it&#39;s not too large."}, {"owner": {"reputation": 1456, "user_id": 1784595, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KoQV5.png?s=128&g=1", "display_name": "frank.lin", "link": "https://stackoverflow.com/users/1784595/frank-lin"}, "edited": false, "score": 0, "creation_date": 1421983293, "post_id": 28102434, "comment_id": 44580278, "body": "<code>libMyLibrary.dylib</code> is complied by g++? I don&#39;t think go can work with the function wrapped by c++, at least I don&#39;t make it."}, {"owner": {"reputation": 1632, "user_id": 1580190, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/2083c14a176bd7ab5c9e6f53ea021aee?s=128&d=identicon&r=PG", "display_name": "Puzzler3141", "link": "https://stackoverflow.com/users/1580190/puzzler3141"}, "reply_to_user": {"reputation": 1456, "user_id": 1784595, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KoQV5.png?s=128&g=1", "display_name": "frank.lin", "link": "https://stackoverflow.com/users/1784595/frank-lin"}, "edited": false, "score": 0, "creation_date": 1421983421, "post_id": 28102434, "comment_id": 44580316, "body": "@buzz it is compiled by g++... I was under the impression cgo would work with both C and C++, though."}, {"owner": {"reputation": 49960, "user_id": 32453, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bec38d63650c8912b6ba9b557fb953b9?s=128&d=identicon&r=PG", "display_name": "rogerdpack", "link": "https://stackoverflow.com/users/32453/rogerdpack"}, "edited": false, "score": 0, "creation_date": 1422031020, "post_id": 28102434, "comment_id": 44602987, "body": "C vs. c++ header issue?"}], "owner": {"reputation": 1632, "user_id": 1580190, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/2083c14a176bd7ab5c9e6f53ea021aee?s=128&d=identicon&r=PG", "display_name": "Puzzler3141", "link": "https://stackoverflow.com/users/1580190/puzzler3141"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1422021195, "creation_date": 1421982721, "last_edit_date": 1421986264, "question_id": 28102434, "link": "https://stackoverflow.com/questions/28102434/embedding-c-executable-functions-in-go-program", "title": "Embedding C++ executable functions in go program", "body": "<p>My goal is to include a function I have in a compiled executable into a go program.</p>\n\n<p>My directory structure is set up as follows:</p>\n\n<pre><code>ProjectDir/\n    include/\n        &lt;header files&gt;\n    main.go\n    libMyLibrary.dylib\n    otherMain.cpp\n    otherMain.hpp\n</code></pre>\n\n<p>My go file is as follows</p>\n\n<pre><code>package main\n\n/*\n#cgo CFLAGS: -I include\n#cgo LDFLAGS: -framework Cocoa -L ./ -lMyLibrary\n#include \"otherMain.hpp\"\ngtype_real64 myFunction();\n*/\nimport \"C\"\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(C.myFunction());\n}\n</code></pre>\n\n<p>However, when I try to run <code>go build main.go</code> I get the following error from the linker:</p>\n\n<pre><code># command-line-arguments\nUndefined symbols for architecture x86_64:\n  \"_myFunction\", referenced from:\n      __cgo_159d40466606_Cfunc_myFunction in main.cgo2.o\n     (maybe you meant: __cgo_159d40466606_Cfunc_myFunction)\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>I've been puzzling over this and can't see as to why the linker can't find the library. Any ideas?</p>\n\n<p>otherMain.hpp:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;memory.h&gt;\n\n#include &lt;Carbon/Carbon.h&gt;\n\n#define MAX_NUM_MEASUREMENTS 100\n\n#include \"&lt;a header file in include&gt;.h\"\n\nint main(int argc, char* argv[]);\ngtype_real64 myFunction();\n</code></pre>\n"}, {"tags": ["json", "pointers", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1421983392, "post_id": 28101966, "comment_id": 44580309, "body": "Duplicate of <a href=\"http://stackoverflow.com/questions/26703458/golang-parse-json-returns-0/26704224#26704224\" title=\"golang parse json returns 0\">stackoverflow.com/questions/26703458/&hellip;</a> <a href=\"http://stackoverflow.com/questions/26327391/golang-json-marshalstruct-returns/26327436#26327436\" title=\"golang json marshalstruct returns\">stackoverflow.com/questions/26327391/&hellip;</a> <a href=\"http://stackoverflow.com/questions/25595096/unmarshalling-json-golang-not-working/25595269#25595269\" title=\"unmarshalling json golang not working\">stackoverflow.com/questions/25595096/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6335, "user_id": 57639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb98866927698460535541131a29d823?s=128&d=identicon&r=PG", "display_name": "Buddy", "link": "https://stackoverflow.com/users/57639/buddy"}, "is_accepted": true, "score": 3, "last_activity_date": 1421980504, "creation_date": 1421980504, "answer_id": 28102155, "question_id": 28101966, "link": "https://stackoverflow.com/questions/28101966/array-of-pointers-to-json/28102155#28102155", "title": "Array of pointers to JSON", "body": "<p>I'm not sure if I'm answering your question because the built in JSON package will do the reflection of the pointers automatically. It should \"just work\". I did notice that you are not exporting the properties in your struct, maybe that is the issue you have? When using reflection, you cannot inspect unexported values.</p>\n\n<p><a href=\"http://play.golang.org/p/zTuMLBgGWk\" rel=\"nofollow\">http://play.golang.org/p/zTuMLBgGWk</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype point struct {\n    X int\n    Y int\n}\n\ntype cell struct {\n    Point   point\n    Visited bool\n    Walls   walls\n}\n\ntype walls struct {\n    N bool\n    E bool\n    S bool\n    W bool\n}\n\ntype maze struct {\n    Cells [][]*cell\n}\n\nfunc main() {\n    m := maze{}\n\n    var row1 []*cell\n    var row2 []*cell\n\n    row1 = append(row1, &amp;cell{\n        Point: point{1, 2},\n        Walls: walls{N: true},\n    })\n    row2 = append(row2, &amp;cell{\n        Point: point{3, 4},\n        Walls: walls{E: true},\n    })\n    m.Cells = append(m.Cells, row1, row2)\n\n    mazeJson, _ := json.MarshalIndent(m, \"\", \"  \")\n    fmt.Println(string(mazeJson))\n}\n</code></pre>\n"}], "owner": {"reputation": 7229, "user_id": 246095, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/edde29f5a7122602ae81653cb9108899?s=128&d=identicon&r=PG&f=1", "display_name": "nik", "link": "https://stackoverflow.com/users/246095/nik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1068, "favorite_count": 0, "accepted_answer_id": 28102155, "answer_count": 1, "score": 0, "last_activity_date": 1421980504, "creation_date": 1421978965, "question_id": 28101966, "link": "https://stackoverflow.com/questions/28101966/array-of-pointers-to-json", "title": "Array of pointers to JSON", "body": "<p>In golang I have two dimensional slice of pointers to struct, as shown in code below.</p>\n\n<pre><code>type point struct {\n    x int\n    y int\n}\n\ntype cell struct {\n    point   point\n    visited bool\n    walls   walls\n}\n\ntype walls struct {\n    n bool\n    e bool\n    s bool\n    w bool\n}\n\ntype maze struct {\n    cells         [][]*cell\n    solutionStack Stack\n}\n</code></pre>\n\n<p>I would like to serialize cells slice into JSON. But as all the elements are pointers calling encode will give empty JSON. What would be the best way to serialize this slice. </p>\n\n<p>One solution that comes to my mid is to create a local copy of this 2D slice ad replace all pointers with actual struct. It'll work but it is no</p>\n"}, {"tags": ["multithreading", "go"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1421974381, "post_id": 28101302, "comment_id": 44578097, "body": "Are you missing a call to <code>Goroutine2</code> in your first example?  Where&#39;s the definition of <code>Goroutine2</code> in your second example?  You mentioned something about a &quot;wait statement&quot; in your second example -- what&#39;s a &quot;wait statement&quot; and where is it?"}, {"owner": {"reputation": 11620, "user_id": 1832301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dfe654f47e3de2384ffd4e2165c575c?s=128&d=identicon&r=PG", "display_name": "BraveNewCurrency", "link": "https://stackoverflow.com/users/1832301/bravenewcurrency"}, "edited": false, "score": 1, "creation_date": 1421990054, "post_id": 28101302, "comment_id": 44581882, "body": "Note: Go doesn&#39;t have &quot;threads&quot; as a language construct. Do you mean &quot;goroutines&quot;?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1422000220, "post_id": 28101302, "comment_id": 44585418, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/16228887/why-does-fmt-println-inside-a-goroutine-not-print-a-line\">Why does fmt.Println inside a goroutine not print a line?</a>"}, {"owner": {"reputation": 121, "user_id": 3756875, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d39ae99e5fb40f82bc9745635fc6ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user123577", "link": "https://stackoverflow.com/users/3756875/user123577"}, "reply_to_user": {"reputation": 11620, "user_id": 1832301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dfe654f47e3de2384ffd4e2165c575c?s=128&d=identicon&r=PG", "display_name": "BraveNewCurrency", "link": "https://stackoverflow.com/users/1832301/bravenewcurrency"}, "edited": false, "score": 0, "creation_date": 1422031011, "post_id": 28101302, "comment_id": 44602980, "body": "@BraveNewCurrency goroutines are how I understood it green threads so you would write the keyword go and go starts up a new green thread. Correct?"}, {"owner": {"reputation": 121, "user_id": 3756875, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d39ae99e5fb40f82bc9745635fc6ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user123577", "link": "https://stackoverflow.com/users/3756875/user123577"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1422031065, "post_id": 28101302, "comment_id": 44603017, "body": "@Amit Kumar Gupta. Yeah some copy pasta error right there. I did fix it now. By wait statement it&#39;s the sleep statement in the end. So basically it does not really wait for anything to finish it just put the main thread to sleep."}, {"owner": {"reputation": 121, "user_id": 3756875, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d39ae99e5fb40f82bc9745635fc6ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user123577", "link": "https://stackoverflow.com/users/3756875/user123577"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1422031576, "post_id": 28101302, "comment_id": 44603368, "body": "I got my answer down bellow if anyone is interested.  @Volker yeah it&#39;s in the same area/ basically the same problem as the main thread finishes before the two other threads are done."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1421999235, "last_edit_date": 1421999235, "creation_date": 1421995819, "answer_id": 28104473, "question_id": 28101302, "link": "https://stackoverflow.com/questions/28101302/synchronisation-of-threads-in-go-lang/28104473#28104473", "title": "Synchronisation of threads in Go lang", "body": "<p>Note that your <a href=\"http://play.golang.org/p/WTplbTQx1G\" rel=\"nofollow\">first example would deadlock, since it never calls <code>GoRoutine2</code></a> (the OP since edited the question).<br>\nIf <a href=\"http://play.golang.org/p/tRVqx9g4he\" rel=\"nofollow\">it calls <code>GoRoutine2</code>, then the expected <code>i</code> value is indeed 0</a>.</p>\n\n<p>Without synchronization, (as <a href=\"http://play.golang.org/p/5w9mxsQgvj\" rel=\"nofollow\">in this example</a>), there is no guarantee that the main() doesn't exit <em>before</em> the completion of <code>Goroutine1()</code> and <code>Goroutine2()</code>.<br>\nFor a 1000000 loop, a 1 millisecond wait seems enough, but again, no guarantee.</p>\n\n<pre><code>func main() {\n    i_chan := make(chan int, 1)\n    i_chan &lt;- 0\n    runtime.GOMAXPROCS(runtime.NumCPU())\n    go Goroutine2(i_chan)\n    go Goroutine1(i_chan)\n    time.Sleep(1 * time.Millisecond)\n    Printf(\"This is the value of i:%d\\n\", &lt;-i_chan)\n}\n</code></pre>\n\n<p>see more at \"<a href=\"http://nathanleclaire.com/blog/2014/02/15/how-to-wait-for-all-goroutines-to-finish-executing-before-continuing/\" rel=\"nofollow\">How to Wait for All Goroutines to Finish Executing Before Continuing</a>\", where the canonical way is to use the <a href=\"http://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow\">sync package\u2019s <code>WaitGroup</code> structure</a>, as in <a href=\"http://runnable.com/UwEzO6LcUjMdAABH/using-sync-waitgroup-to-slurp-json-from-reddit-concurrently-wait-for-all-goroutines-to-finish-before-continuing-\" rel=\"nofollow\">this runnable example</a>.</p>\n"}], "owner": {"reputation": 121, "user_id": 3756875, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d39ae99e5fb40f82bc9745635fc6ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user123577", "link": "https://stackoverflow.com/users/3756875/user123577"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 677, "favorite_count": 2, "accepted_answer_id": 28104473, "answer_count": 1, "score": -3, "last_activity_date": 1421999235, "creation_date": 1421974001, "last_edit_date": 1421998715, "question_id": 28101302, "link": "https://stackoverflow.com/questions/28101302/synchronisation-of-threads-in-go-lang", "title": "Synchronisation of threads in Go lang", "body": "<p>I want to understand a bit more about how synchronisation of threads works in go. Below here I've have a functioning version of my program which uses a done channel for syncronization.</p>\n\n<pre><code>package main\n\nimport (\n    . \"fmt\"\n    \"runtime\"\n)\n\nfunc Goroutine1(i_chan chan int, done chan bool) {\n    for x := 0; x &lt; 1000000; x++ {\n        i := &lt;-i_chan\n        i++\n        i_chan &lt;- i\n    }\n    done &lt;- true\n}\nfunc Goroutine2(i_chan chan int, done chan bool) {\n    for x := 0; x &lt; 1000000; x++ {\n        i := &lt;-i_chan\n        i--\n        i_chan &lt;- i\n    }\n    done &lt;- true\n}\n\nfunc main() {\n    i_chan := make(chan int, 1)\n    done := make(chan bool, 2)\n    i_chan &lt;- 0\n\n    runtime.GOMAXPROCS(runtime.NumCPU())\n    go Goroutine1(i_chan, done)\n    go Goroutine2(i_chan)\n    &lt;-done\n    &lt;-done\n    Printf(\"This is the value of i:%d\\n\", &lt;-i_chan)\n}\n</code></pre>\n\n<p>However when I try to run it with out any synchronisation. Using a wait statement and no channel to specify when it's done so no synchronisation.</p>\n\n<pre><code>const MAX = 1000000\n\nfunc Goroutine1(i_chan chan int) {\n    for x := 0; x &lt; MAX-23; x++ {\n        i := &lt;-i_chan\n        i++\n        i_chan &lt;- i\n    }\n}\n\nfunc main() {\n    i_chan := make(chan int, 1)\n    i_chan &lt;- 0\n    runtime.GOMAXPROCS(runtime.NumCPU())\n    go Goroutine1(i_chan)\n    go Goroutine2(i_chan)\n    time.Sleep(100 * time.Millisecond)\n    Printf(\"This is the value of i:%d\\n\", &lt;-i_chan)\n}\n</code></pre>\n\n<p>It'll print out the wrong value of i. If you extend the wait for let say 1 sec it'll finish and print out the correct statement. I kind of understand that it has something with both thread not being finished before you print what's on the <code>i_chan</code> I'm just a bit curious about how this works.</p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1421974341, "post_id": 28101162, "comment_id": 44578082, "body": "You can add runtime type assertions.  <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Type_assertions</a>.  You&#39;re using the first form of type assertions, but you can also check whether the assertion succeeds or fails.  Also see: <a href=\"http://stackoverflow.com/questions/28015753/serialize-to-json-a-mixed-type-array-in-go/28016508#28016508\" title=\"serialize to json a mixed type array in go\">stackoverflow.com/questions/28015753/&hellip;</a>"}, {"owner": {"reputation": 7845, "user_id": 1261942, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a5604800360c8ea563ba329aacc3f757?s=128&d=identicon&r=PG", "display_name": "DanRedux", "link": "https://stackoverflow.com/users/1261942/danredux"}, "reply_to_user": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1421974974, "post_id": 28101162, "comment_id": 44578271, "body": "Yes that is what I&#39;m currently doing."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428180002, "post_id": 28101162, "comment_id": 47068202, "body": "Wouldn&#39;t this better be done with a struct type and an attached <code>UnmarshalJSON</code> method (so that it can handle the <code>[]</code> vs <code>{}</code> difference)?"}], "answers": [{"tags": [], "owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "is_accepted": false, "score": 1, "last_activity_date": 1421982127, "last_edit_date": 1421982127, "creation_date": 1421981777, "answer_id": 28102312, "question_id": 28101162, "link": "https://stackoverflow.com/questions/28101162/fixed-size-array-that-contains-multiple-specific-types/28102312#28102312", "title": "Fixed-size array that contains multiple specific types?", "body": "<p>At the first, answer is No. But you can get values from <code>interface{}</code> with type you expected.\nHow about this?</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"github.com/mattn/go-scan\"\n    \"log\"\n)\n\nfunc main() {\n    text := `[\"foo\", 42]`\n\n    var v interface{}\n    err := json.Unmarshal([]byte(text), &amp;v)\n    if err != nil {\n        log.Fatal(err)\n    }\n    var key string\n    var val int\n    e1, e2 := scan.ScanTree(v, \"[0]\", &amp;key), scan.ScanTree(v, \"[1]\", &amp;val)\n    if e1 != nil || e2 != nil {\n        log.Fatal(e1, e2)\n    }\n    fmt.Println(key, val)\n}\n</code></pre>\n"}], "owner": {"reputation": 7845, "user_id": 1261942, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a5604800360c8ea563ba329aacc3f757?s=128&d=identicon&r=PG", "display_name": "DanRedux", "link": "https://stackoverflow.com/users/1261942/danredux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421982127, "creation_date": 1421973117, "question_id": 28101162, "link": "https://stackoverflow.com/questions/28101162/fixed-size-array-that-contains-multiple-specific-types", "title": "Fixed-size array that contains multiple specific types?", "body": "<p>I have an array (coming from JSON) that always contains a string and an int, like so: <code>[\"foo\",42]</code></p>\n\n<p>Right now, I have to use <code>[]interface{}</code> with assertions <code>arr[0].(string)</code> <code>arr[1].(int)</code></p>\n\n<p>I'm wondering if there's any way to specify the types expected in the array? I'm picturing something like.. <code>[...]{string,int}</code></p>\n\n<p>Thanks.</p>\n"}, {"tags": ["linux", "go"], "answers": [{"comments": [{"owner": {"reputation": 3378, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "edited": false, "score": 0, "creation_date": 1421969531, "post_id": 28100428, "comment_id": 44576730, "body": "I changed 42 to 48 in the program, so it takes 31.55s to run.  The profile still shows no breakdown.  The various visualization formats just show a single node."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3378, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "edited": false, "score": 0, "creation_date": 1421970323, "post_id": 28100428, "comment_id": 44576952, "body": "I took your code verbatim and pprof shows the time split between main.a and main.b. Are you running this in a VM by chance? I&#39;ve had trouble profiling inside virtualbox on osx, Linux on aws seems to work well though."}, {"owner": {"reputation": 3378, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "edited": false, "score": 0, "creation_date": 1422054300, "post_id": 28100428, "comment_id": 44614552, "body": "Thanks for reporting that the example works for you.  That rules out coding errors.  It must be my installation or machine.  I thought I wasn&#39;t on a virtual machine, but I&#39;ll double-check."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 0, "last_activity_date": 1421970207, "last_edit_date": 1421970207, "creation_date": 1421968579, "answer_id": 28100428, "question_id": 28100203, "link": "https://stackoverflow.com/questions/28100203/how-to-get-function-breakdown-from-go-profile/28100428#28100428", "title": "How to get function breakdown from Go profile", "body": "<p>You're not going to get enough profiling samples in 1.7s. I like to profile for at least 30s, or more.</p>\n\n<p>Once you have a large enough profile, try using pprof interactively (without the <code>--text</code> option). You'll be able to view the stats a few different ways, as well as output the various other visualization formats.</p>\n\n<p><a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"nofollow\">https://blog.golang.org/profiling-go-programs</a></p>\n"}, {"tags": [], "owner": {"reputation": 3378, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "is_accepted": false, "score": 0, "last_activity_date": 1422634062, "creation_date": 1422634062, "answer_id": 28239954, "question_id": 28100203, "link": "https://stackoverflow.com/questions/28100203/how-to-get-function-breakdown-from-go-profile/28239954#28239954", "title": "How to get function breakdown from Go profile", "body": "<p>It turns out the mistake was omitting the binary name when invoking the pprof tool.  The correct invocation is:</p>\n\n<pre><code>$ go tool pprof --text silly silly.prof\n1750ms of 1750ms total (  100%)\n      flat  flat%   sum%        cum   cum%\n    1060ms 60.57% 60.57%     1750ms   100%  main.a\n     690ms 39.43%   100%     1750ms   100%  main.b\n         0     0%   100%     1750ms   100%  main.main\n         0     0%   100%     1750ms   100%  runtime.goexit\n         0     0%   100%     1750ms   100%  runtime.main\n</code></pre>\n\n<p>The line in my question omitted <code>silly</code>, i.e. the binary file to be profiled.</p>\n"}], "owner": {"reputation": 3378, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 274, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1422634062, "creation_date": 1421967523, "question_id": 28100203, "link": "https://stackoverflow.com/questions/28100203/how-to-get-function-breakdown-from-go-profile", "title": "How to get function breakdown from Go profile", "body": "<p>I've been trying to use pprof for Go on Linux, but get no function information.  What am I doing wrong?  Here are my build/run steps:</p>\n\n<pre><code>$ rm -f silly\n$ go build -gcflags \"-N -l\" silly.go\n$ rm -f silly.prof\n$ ./silly --cpuprofile silly.prof\nfib(42)=267914296\nt=1.758997214s\n$ go tool pprof --text silly.prof\n1.75s of 1.75s total (  100%)\n      flat  flat%   sum%        cum   cum%\n     1.75s   100%   100%      1.75s   100%\n</code></pre>\n\n<p>I was expecting more detail in the output from pprof.  The \"t=1.75...\" line indicates that the program took 1.75 sec to run, which seems ample time to collect samples at the profiler's 100 Hz sampling rate.</p>\n\n<p>Here is the program:</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"runtime/pprof\"\n    \"time\"\n)\n\nfunc b(n int) int {\n    if n &lt; 2 {\n        return n\n    } else {\n        return a(n-1) + b(n-2)\n    }\n}\n\nfunc a(n int) int {\n    if n &lt; 2 {\n        return n\n    } else {\n        return a(n-1) + b(n-2)\n    }\n}\n\nvar cpuprofile = flag.String(\"cpuprofile\", \"\", \"write cpu profile to file\")\n\nfunc main() {\n    flag.Parse()\n    if *cpuprofile != \"\" {\n        f, err := os.Create(*cpuprofile)\n        if err != nil {\n            log.Fatal(err)\n        }\n        pprof.StartCPUProfile(f)\n        defer pprof.StopCPUProfile()\n    }\n\n    t0 := time.Now()\n    fmt.Printf(\"fib(42)=%v\\n\", a(42))\n    t1 := time.Now()\n    fmt.Printf(\"t=%v\\n\", t1.Sub(t0))\n}\n</code></pre>\n\n<p>I'm running on I'm on Red Hat Enterprise Linux Server release 7.0, using Go version go1.4 linux/amd64.</p>\n"}, {"tags": ["function", "recursion", "go"], "answers": [{"comments": [{"owner": {"reputation": 1055, "user_id": 1563701, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/63da13112be95f5fd032d1c3c409ec0c?s=128&d=identicon&r=PG", "display_name": "marczoid", "link": "https://stackoverflow.com/users/1563701/marczoid"}, "edited": false, "score": 2, "creation_date": 1447333175, "post_id": 28099489, "comment_id": 55116676, "body": "Some explanation would be nice"}], "tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": false, "score": 5, "last_activity_date": 1421964098, "creation_date": 1421964098, "answer_id": 28099489, "question_id": 28099441, "link": "https://stackoverflow.com/questions/28099441/define-a-recursive-function-within-a-function-in-go/28099489#28099489", "title": "Define a recursive function within a function in Go", "body": "<pre><code>var Function2 func(m int) int\nFunction2 = func(m int) int {\n    ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3292, "user_id": 2709093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042262218/picture?type=large", "display_name": "James K", "link": "https://stackoverflow.com/users/2709093/james-k"}, "edited": false, "score": 0, "creation_date": 1576164930, "post_id": 28099510, "comment_id": 104818248, "body": "The parameter doesn&#39;t need to be named in the declaration so <code>var Function2 func(int) int</code> also works and avoids repeating oneself.  Not sure when/if this changed."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3292, "user_id": 2709093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042262218/picture?type=large", "display_name": "James K", "link": "https://stackoverflow.com/users/2709093/james-k"}, "edited": false, "score": 1, "creation_date": 1576242744, "post_id": 28099510, "comment_id": 104846138, "body": "@JamesK This has always been like that, see <a href=\"https://stackoverflow.com/questions/31377433/getting-method-parameter-names/31377793#31377793\">Getting method parameter names</a>. Providing parameter names might still have documentation value."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1612131351, "post_id": 28099510, "comment_id": 116664451, "body": "TLDR: There is a simple solution -- declare the function before defining it."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 48, "last_activity_date": 1538766026, "last_edit_date": 1538766026, "creation_date": 1421964179, "answer_id": 28099510, "question_id": 28099441, "link": "https://stackoverflow.com/questions/28099441/define-a-recursive-function-within-a-function-in-go/28099510#28099510", "title": "Define a recursive function within a function in Go", "body": "<p>You can't access <code>Function2</code> inside of it if it is in the line where you declare it. The reason is that you're not referring to a <em>function</em> but to a <em>variable</em> (whose type is a function) and it will be accessible only after the declaration.</p>\n\n<p>Quoting from <a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"noreferrer\">Spec: Declarations and scope:</a></p>\n\n<blockquote>\n  <p>The scope of a constant or variable identifier declared inside a function begins at the end of the ConstSpec or VarSpec (ShortVarDecl for short variable declarations) and ends at the end of the innermost containing block.</p>\n</blockquote>\n\n<p>In your example <code>Function2</code> is a variable declaration, and the VarSpec is:</p>\n\n<pre><code>Function2 := func(m int) int {\n    if m &lt;= a {\n        return a\n    }\n    return Function2(m-1)\n}\n</code></pre>\n\n<p>And as the quote form the language spec describes, the variable identifier <code>Function2</code> will only be in scope after the declaration, so you can't refer to it inside the declaration itself. For details, see <a href=\"https://stackoverflow.com/questions/52503560/understanding-variable-scope-in-go/52506086#52506086\">Understanding variable scope in Go</a>.</p>\n\n<p>Declare the <code>Function2</code> variable first, so you can refer to it from the <a href=\"https://golang.org/ref/spec#Function_literals\" rel=\"noreferrer\">function literal</a>:</p>\n\n<pre><code>func Function1(n int) int {\n    a := 10\n    var Function2 func(m int) int\n\n    Function2 = func(m int) int {\n        if m &lt;= a {\n            return a\n        }\n        return Function2(m - 1)\n    }\n\n    return Function2(n)\n}\n</code></pre>\n\n<p>Try it on <a href=\"http://play.golang.org/p/fD6fjED8oN\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 7273, "user_id": 2641547, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/660520007/picture?type=large", "display_name": "Spearfisher", "link": "https://stackoverflow.com/users/2641547/spearfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5404, "favorite_count": 4, "accepted_answer_id": 28099510, "answer_count": 2, "score": 21, "last_activity_date": 1538766026, "creation_date": 1421963890, "last_edit_date": 1515914412, "question_id": 28099441, "link": "https://stackoverflow.com/questions/28099441/define-a-recursive-function-within-a-function-in-go", "title": "Define a recursive function within a function in Go", "body": "<p>I am trying to define a recursive function within another function in Go but I am struggling to get the right syntax. I am looking for something like this:</p>\n\n<pre><code>func Function1(n) int {\n   a := 10\n   Function2 := func(m int) int {\n      if m &lt;= a {\n         return a\n      }\n      return Function2(m-1)\n   }\n\n   return Function2(n)\n}\n</code></pre>\n\n<p>I'd like to keep Function2 inside the scope of Function1 as it is accessing some elements of its scope.</p>\n\n<p>How can I do this in Go?</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 5, "creation_date": 1421964000, "post_id": 28099004, "comment_id": 44574597, "body": "Try manually installing based on the instructions here: <a href=\"https://github.com/golang/protobuf\" rel=\"nofollow noreferrer\">github.com/golang/protobuf</a> <code>go get -u github.com&#47;golang&#47;protobuf&#47;{proto,protoc-gen-go}</code>. There may be something wrong with the homebrew install."}, {"owner": {"reputation": 1826, "user_id": 3765772, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3b49d13ba84f10dbe67af56729f9951?s=128&d=identicon&r=PG&f=1", "display_name": "R.J. Robinson", "link": "https://stackoverflow.com/users/3765772/r-j-robinson"}, "reply_to_user": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1421972794, "post_id": 28099004, "comment_id": 44577664, "body": "Reinstalled everything. still the same error. I switched over to ver 2.6.0 . Still the same error."}, {"owner": {"reputation": 30998, "user_id": 2686899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/StqEe.jpg?s=128&g=1", "display_name": "Kenton Varda", "link": "https://stackoverflow.com/users/2686899/kenton-varda"}, "edited": false, "score": 2, "creation_date": 1421983602, "post_id": 28099004, "comment_id": 44580354, "body": "You say <code>protoc-gen-go</code> is in your &quot;go path&quot;, but it needs to be in your shell path, i.e. one of the directories listed in the <code>PATH</code> environment variable. What happens if you just type <code>protoc-gen-go</code> at the command line? If it says &quot;command not found&quot; (or similar) then it&#39;s not in your <code>PATH</code>."}, {"owner": {"reputation": 636, "user_id": 564872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e7b460f32c77fa753907bb4c2631459c?s=128&d=identicon&r=PG", "display_name": "Civilian", "link": "https://stackoverflow.com/users/564872/civilian"}, "reply_to_user": {"reputation": 30998, "user_id": 2686899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/StqEe.jpg?s=128&g=1", "display_name": "Kenton Varda", "link": "https://stackoverflow.com/users/2686899/kenton-varda"}, "edited": false, "score": 0, "creation_date": 1430964511, "post_id": 28099004, "comment_id": 48294203, "body": "Thanks @KentonVarda, you should submit that as an answer."}, {"owner": {"reputation": 30998, "user_id": 2686899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/StqEe.jpg?s=128&g=1", "display_name": "Kenton Varda", "link": "https://stackoverflow.com/users/2686899/kenton-varda"}, "edited": false, "score": 0, "creation_date": 1430993295, "post_id": 28099004, "comment_id": 48307515, "body": "OK, I posted it as an answer."}], "answers": [{"comments": [{"owner": {"reputation": 2410, "user_id": 908336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J9cmH.jpg?s=128&g=1", "display_name": "Masood Khaari", "link": "https://stackoverflow.com/users/908336/masood-khaari"}, "edited": false, "score": 12, "creation_date": 1507387520, "post_id": 30097929, "comment_id": 80193654, "body": "FYI, it should live at <code>$GOPATH&#47;bin</code>. So do this: <code>export PATH=$PATH:$GOPATH&#47;bin</code>"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 5, "creation_date": 1515155490, "post_id": 30097929, "comment_id": 83203050, "body": "I have it in path and executable, but still report <code>Plugin failed with status code 1.</code>"}, {"owner": {"reputation": 762, "user_id": 112739, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7adc3e47dc4f712bfd2101673eac5564?s=128&d=identicon&r=PG", "display_name": "Renato Aquino", "link": "https://stackoverflow.com/users/112739/renato-aquino"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 3, "creation_date": 1520265212, "post_id": 30097929, "comment_id": 85233744, "body": "@JiangYD, I had the same problem. Looks like protoc couldn&#39;t expand paths like ~/go/bin. Make sure you are using the complete directory in your PATH settings like /home/johndoe/go/bin instead of ~/go/bin."}, {"owner": {"reputation": 356, "user_id": 3104032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FCOUO.jpg?s=128&g=1", "display_name": "darkdefender27", "link": "https://stackoverflow.com/users/3104032/darkdefender27"}, "edited": false, "score": 0, "creation_date": 1521538149, "post_id": 30097929, "comment_id": 85761635, "body": "I have tried all the above suggestions. Still it fails to work for me. FYI, protoc-gen-go is not there for me under <code>$GOPATH&#47;bin&#47;</code>"}, {"owner": {"reputation": 7587, "user_id": 79389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32d3c88e6303e7947f1b73e069038eb6?s=128&d=identicon&r=PG", "display_name": "Shaun Bouckaert", "link": "https://stackoverflow.com/users/79389/shaun-bouckaert"}, "reply_to_user": {"reputation": 356, "user_id": 3104032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FCOUO.jpg?s=128&g=1", "display_name": "darkdefender27", "link": "https://stackoverflow.com/users/3104032/darkdefender27"}, "edited": false, "score": 1, "creation_date": 1525782452, "post_id": 30097929, "comment_id": 87484608, "body": "@darkdefender27 do you have GOPATH set? If not the default is $HOME/go/ . protoc seems to be ok expanding $HOME instead of ~ so for me adding $HOME/go/bin to my path worked."}, {"owner": {"reputation": 740, "user_id": 2467454, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/784d4fa00e161595564f95894f047042?s=128&d=identicon&r=PG", "display_name": "Jimmy Shaw", "link": "https://stackoverflow.com/users/2467454/jimmy-shaw"}, "edited": false, "score": 0, "creation_date": 1525910507, "post_id": 30097929, "comment_id": 87545305, "body": "I had the same issue but it was because GOPATH itself was not set within .bash_profile. So add the following line <code>export GOPATH=$(go env GOPATH)</code> above your <code>export PATH=$PATH:$GOPATH&#47;bin</code> line inside the .bash_profile file."}], "tags": [], "owner": {"reputation": 30998, "user_id": 2686899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/StqEe.jpg?s=128&g=1", "display_name": "Kenton Varda", "link": "https://stackoverflow.com/users/2686899/kenton-varda"}, "is_accepted": true, "score": 51, "last_activity_date": 1430993271, "creation_date": 1430993271, "answer_id": 30097929, "question_id": 28099004, "link": "https://stackoverflow.com/questions/28099004/unable-to-build-protobuf-to-go-endpoint/30097929#30097929", "title": "Unable to build protobuf to go endpoint", "body": "<p><code>protoc-gen-go</code> needs to be in your <em>shell</em> path, i.e. one of the directories listed in the <code>PATH</code> environment variable, which is different from the Go path. You can test this by simply typing <code>protoc-gen-go</code> at the command line: If it says \"command not found\" (or similar) then it's not in your <code>PATH</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 4478, "user_id": 557406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99836456ec6d87389df32d2cdcf8d825?s=128&d=identicon&r=PG", "display_name": "Charles L.", "link": "https://stackoverflow.com/users/557406/charles-l"}, "edited": false, "score": 0, "creation_date": 1454017389, "post_id": 33842956, "comment_id": 57868275, "body": "Tried this 1/28/2016 and this does not work anymore.  you can build <code>.pb.go</code> files, but not import them."}, {"owner": {"reputation": 141, "user_id": 4190422, "user_type": "registered", "profile_image": "https://graph.facebook.com/1234410004/picture?type=large", "display_name": "Matt Rkiouak", "link": "https://stackoverflow.com/users/4190422/matt-rkiouak"}, "edited": false, "score": 0, "creation_date": 1488593202, "post_id": 33842956, "comment_id": 72314563, "body": "tried 3-3-2017, solved my issue same as OP, protoc-gen-go: program not found or is not executable"}], "tags": [], "owner": {"reputation": 405, "user_id": 3678439, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/m6V5B.jpg?s=128&g=1", "display_name": "00imvj00", "link": "https://stackoverflow.com/users/3678439/00imvj00"}, "is_accepted": false, "score": 12, "last_activity_date": 1533738267, "last_edit_date": 1533738267, "creation_date": 1448106455, "answer_id": 33842956, "question_id": 28099004, "link": "https://stackoverflow.com/questions/28099004/unable-to-build-protobuf-to-go-endpoint/33842956#33842956", "title": "Unable to build protobuf to go endpoint", "body": "<p>On Ubuntu 18.04, this is verified working to solve this issue:    </p>\n\n<p><code>sudo apt-get install golang-goprotobuf-dev</code></p>\n"}, {"tags": [], "owner": {"reputation": 301, "user_id": 5292451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72597cbcfc2557e6e849603bd61787b0?s=128&d=identicon&r=PG&f=1", "display_name": "Xibai Li", "link": "https://stackoverflow.com/users/5292451/xibai-li"}, "is_accepted": false, "score": 30, "last_activity_date": 1453284030, "last_edit_date": 1453284030, "creation_date": 1453283935, "answer_id": 34896844, "question_id": 28099004, "link": "https://stackoverflow.com/questions/28099004/unable-to-build-protobuf-to-go-endpoint/34896844#34896844", "title": "Unable to build protobuf to go endpoint", "body": "<p>Using </p>\n\n<pre><code>$ go get -u github.com/golang/protobuf/{proto,protoc-gen-go}\n</code></pre>\n\n<p>is more safe than using </p>\n\n<pre><code>$ sudo apt-get install golang-goprotobuf-dev\n</code></pre>\n\n<p>Because the latest <code>protoc-gen-go</code> is using the lib <code>github.com/golang/protobuf/proto</code>, but <code>protoc-gen-go</code> in <code>apt-get</code> using the lib <code>code.google.com/p/goprotobuf/proto</code> which didn't exist now.</p>\n"}, {"comments": [{"owner": {"reputation": 356, "user_id": 3104032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FCOUO.jpg?s=128&g=1", "display_name": "darkdefender27", "link": "https://stackoverflow.com/users/3104032/darkdefender27"}, "edited": false, "score": 0, "creation_date": 1521538207, "post_id": 42848196, "comment_id": 85761679, "body": "Can you explain how did you find the installation directory for <code>protoc-gen-go</code>? FYI, protoc-gen-go is not there for me under <code>$GOPATH&#47;bin&#47;</code>"}, {"owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "reply_to_user": {"reputation": 356, "user_id": 3104032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FCOUO.jpg?s=128&g=1", "display_name": "darkdefender27", "link": "https://stackoverflow.com/users/3104032/darkdefender27"}, "edited": false, "score": 0, "creation_date": 1521540225, "post_id": 42848196, "comment_id": 85763124, "body": "@darkdefender27  How did you install the <code>protoc-gen-go</code>?"}, {"owner": {"reputation": 356, "user_id": 3104032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FCOUO.jpg?s=128&g=1", "display_name": "darkdefender27", "link": "https://stackoverflow.com/users/3104032/darkdefender27"}, "edited": false, "score": 0, "creation_date": 1521543627, "post_id": 42848196, "comment_id": 85765596, "body": "Using <code>$ go get -u github.com&#47;golang&#47;protobuf&#47;protoc-gen-go</code> @pangpang"}], "tags": [], "owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "is_accepted": false, "score": 3, "last_activity_date": 1489717874, "creation_date": 1489717874, "answer_id": 42848196, "question_id": 28099004, "link": "https://stackoverflow.com/questions/28099004/unable-to-build-protobuf-to-go-endpoint/42848196#42848196", "title": "Unable to build protobuf to go endpoint", "body": "<p>I met the same problem. </p>\n\n<pre><code>$ protoc --go_out=plugins=grpc:pb/ *.proto\nprotoc-gen-go: program not found or is not executable\n--go_out: protoc-gen-go: Plugin failed with status code 1.\n</code></pre>\n\n<p>The solution as below:</p>\n\n<p>Find the installation directory of <code>protoc-gen-go</code>, it must be in your <code>$PATH</code>.</p>\n\n<pre><code>export PATH=$PATH:/path/to/dir\n</code></pre>\n\n<p>You'd better add it to your <code>.bash_profile</code></p>\n\n<pre><code>echo $\"export PATH=\\$PATH:$(/path/to/dir)\" &gt;&gt; ~/.bash_profile\nsource ~/.bash_profile\n</code></pre>\n\n<p>then everything is ok.</p>\n"}, {"tags": [], "owner": {"reputation": 517, "user_id": 9956279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iStX1.jpg?s=128&g=1", "display_name": "Sushilinux", "link": "https://stackoverflow.com/users/9956279/sushilinux"}, "is_accepted": false, "score": 4, "last_activity_date": 1535898753, "creation_date": 1535898753, "answer_id": 52137967, "question_id": 28099004, "link": "https://stackoverflow.com/questions/28099004/unable-to-build-protobuf-to-go-endpoint/52137967#52137967", "title": "Unable to build protobuf to go endpoint", "body": "<p>How I solved:</p>\n\n<ol>\n<li>Add <code>$GOPATH/bin</code> to PATH by running\n<code>export PATH=$PATH:$GOPATH/bin</code></li>\n<li>add <code>export GOPATH=$(go env GOPATH)</code> above <code>export PATH=$PATH:$GOPATH/bin</code> line inside the <code>.bash_profile</code> file.</li>\n<li>run <code>go get -u</code> for the required packages again.</li>\n<li>run the code <code>protoc --go_out=../cloud/ *.proto</code> in your case.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 13366, "user_id": 208623, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b59d0c91a5997a921ccd300576267d78?s=128&d=identicon&r=PG", "display_name": "napolux", "link": "https://stackoverflow.com/users/208623/napolux"}, "edited": false, "score": 2, "creation_date": 1554929816, "post_id": 52941064, "comment_id": 97935361, "body": "Worked for me! :)"}], "tags": [], "owner": {"reputation": 3629, "user_id": 2463695, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/hSucb.png?s=128&g=1", "display_name": "Quy Tang", "link": "https://stackoverflow.com/users/2463695/quy-tang"}, "is_accepted": false, "score": 25, "last_activity_date": 1540267888, "creation_date": 1540267888, "answer_id": 52941064, "question_id": 28099004, "link": "https://stackoverflow.com/questions/28099004/unable-to-build-protobuf-to-go-endpoint/52941064#52941064", "title": "Unable to build protobuf to go endpoint", "body": "<ol>\n<li><p>You should properly define your <code>GO_PATH</code> - where your go packages\nlive.\nIn other words, <code>GO_PATH</code> is your go workspace. The <code>GO_PATH</code>\nshould be <code>~/go</code>.</p></li>\n<li><p><code>protoc-gen-go</code> should be in your <code>PATH</code>. While <code>protoc-gen-go</code> lives in <code>$GO_PATH/bin</code> after you installed it.</p></li>\n</ol>\n\n<hr>\n\n<p>Add these 2 important lines to your <code>~/.bash_profile</code>:</p>\n\n<pre><code>export GO_PATH=~/go\nexport PATH=$PATH:/$GO_PATH/bin\n</code></pre>\n\n<p>Then you need to start a new shell session or just type in this line:</p>\n\n<pre><code>$ source ~/.bash_profile\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 884, "user_id": 6651080, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EY45JeKlPi8/AAAAAAAAAAI/AAAAAAAAG8I/5bwaHIx2IoQ/photo.jpg?sz=128", "display_name": "Dzintars", "link": "https://stackoverflow.com/users/6651080/dzintars"}, "is_accepted": false, "score": 2, "last_activity_date": 1543100606, "creation_date": 1543100606, "answer_id": 53463132, "question_id": 28099004, "link": "https://stackoverflow.com/questions/28099004/unable-to-build-protobuf-to-go-endpoint/53463132#53463132", "title": "Unable to build protobuf to go endpoint", "body": "<p>Mby will help for somebody. I'm on Fedora 29.</p>\n\n<p>When I installed Go I did:</p>\n\n<pre><code>echo 'export GOPATH=$HOME/Go' &gt;&gt; $HOME/.bashrc\nsource $HOME/.bashrc\n</code></pre>\n\n<p>So I have my GOPATH set up.\nNext I do:</p>\n\n<pre><code>echo 'export PATH=$PATH:$GOPATH/bin' &gt;&gt; $HOME/.bashrc\nsource $HOME/.bashrc\n</code></pre>\n\n<p>And my <code>protoc</code> compiler work lika a charm.</p>\n"}, {"tags": [], "owner": {"reputation": 1903, "user_id": 98071, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f1a4dedc45c7856be78196f677456cb2?s=128&d=identicon&r=PG", "display_name": "Pep", "link": "https://stackoverflow.com/users/98071/pep"}, "is_accepted": false, "score": -1, "last_activity_date": 1543701993, "creation_date": 1543701993, "answer_id": 53575466, "question_id": 28099004, "link": "https://stackoverflow.com/questions/28099004/unable-to-build-protobuf-to-go-endpoint/53575466#53575466", "title": "Unable to build protobuf to go endpoint", "body": "<p>Ensure that your path to <code>proton-gen-go</code> in your <code>PATH</code> variable is absolute (i.e. <code>/Users/me/go/bin</code> instead of <code>~/go/bin</code>.</p>\n\n<p>Apparently <code>protoc</code> does not know how to expand <code>~</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 5937053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b722d8e7814512aed276d878b7d8ec26?s=128&d=identicon&r=PG&f=1", "display_name": "Bhaskar Reddy", "link": "https://stackoverflow.com/users/5937053/bhaskar-reddy"}, "is_accepted": false, "score": 3, "last_activity_date": 1553295405, "creation_date": 1553295405, "answer_id": 55308808, "question_id": 28099004, "link": "https://stackoverflow.com/questions/28099004/unable-to-build-protobuf-to-go-endpoint/55308808#55308808", "title": "Unable to build protobuf to go endpoint", "body": "<p>I have Ubuntu 18.04.02 LTS and installed <code>protoc</code> using </p>\n\n<pre><code>sudo apt install protobuf-compiler\n</code></pre>\n\n<p>I have my GOPATH and GOBIN set correctly, but still when I did a \n<code>protoc --go_out=. &lt;filename&gt;</code>\nI was getting </p>\n\n<pre><code>protoc-gen-go: program not found or is not executable\n--go_out: protoc-gen-go: Plugin failed with status code 1.\n\n</code></pre>\n\n<p>After reading bunch of places, was able to find that doing</p>\n\n<pre><code>go get -u github.com/golang/protobuf/protoc-gen-go\n</code></pre>\n\n<p>was able to fix the issue. \nHope this helps someone out there.</p>\n"}, {"comments": [{"owner": {"reputation": 617, "user_id": 5080765, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-N7W0Wdo04K0/AAAAAAAAAAI/AAAAAAAABa0/_N_PFZRPZK8/photo.jpg?sz=128", "display_name": "Marco Feregrino", "link": "https://stackoverflow.com/users/5080765/marco-feregrino"}, "edited": false, "score": 0, "creation_date": 1597677876, "post_id": 57952703, "comment_id": 112205058, "body": "I tried adding the PATH variables and restaring terminal or source to reload PATH variables. Copying the file fix all the stuff and generating code on ma Catalina is working now, thanks !"}], "tags": [], "owner": {"reputation": 101, "user_id": 12073040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A8mue.jpg?s=128&g=1", "display_name": "Boluwatife Fakorede", "link": "https://stackoverflow.com/users/12073040/boluwatife-fakorede"}, "is_accepted": false, "score": 3, "last_activity_date": 1568621175, "creation_date": 1568621175, "answer_id": 57952703, "question_id": 28099004, "link": "https://stackoverflow.com/questions/28099004/unable-to-build-protobuf-to-go-endpoint/57952703#57952703", "title": "Unable to build protobuf to go endpoint", "body": "<p>What I did to solve this was:</p>\n\n<p>copy protoc-gen-go from the go bin folder in go workspace to /usr/local/bin/</p>\n\n<p>run your command as before in your case \"protoc --go_out=../cloud/ *.proto\"</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12254840, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAOrMHy6NXUIVAetfvTaJj_8f9ILPH-WzZVU4Rg=k-s128", "display_name": "Daniel Ospitia", "link": "https://stackoverflow.com/users/12254840/daniel-ospitia"}, "is_accepted": false, "score": 0, "last_activity_date": 1578692102, "creation_date": 1578692102, "answer_id": 59689312, "question_id": 28099004, "link": "https://stackoverflow.com/questions/28099004/unable-to-build-protobuf-to-go-endpoint/59689312#59689312", "title": "Unable to build protobuf to go endpoint", "body": "<p>If you're using Fedora, ensure that the package \"protoc-gen-go\" is installed, and it's binary is in your shel PATH.</p>\n\n<p>$sudo dnf install protoc-gen-go -y</p>\n"}, {"tags": [], "owner": {"reputation": 504, "user_id": 2725353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8743e994aaa7936b7d63f97ed5ed3f91?s=128&d=identicon&r=PG", "display_name": "Yrineu Rodrigues", "link": "https://stackoverflow.com/users/2725353/yrineu-rodrigues"}, "is_accepted": false, "score": 1, "last_activity_date": 1610767767, "creation_date": 1610767767, "answer_id": 65746200, "question_id": 28099004, "link": "https://stackoverflow.com/questions/28099004/unable-to-build-protobuf-to-go-endpoint/65746200#65746200", "title": "Unable to build protobuf to go endpoint", "body": "<p>Directly from <a href=\"https://grpc.io/docs/languages/go/quickstart/#prerequisites\" rel=\"nofollow noreferrer\">grpc documentation</a>:</p>\n<p>Go plugins for the protocol compiler:</p>\n<p>Install the protocol compiler plugins for Go using the following commands:</p>\n<pre><code>$ export GO111MODULE=on  # Enable module mode\n$ go get google.golang.org/protobuf/cmd/protoc-gen-go \\\n         google.golang.org/grpc/cmd/protoc-gen-go-grpc\n</code></pre>\n<p>Update your PATH so that the protoc compiler can find the plugins:</p>\n<pre><code>$ export PATH=&quot;$PATH:$(go env GOPATH)/bin&quot;\n</code></pre>\n"}], "owner": {"reputation": 1826, "user_id": 3765772, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3b49d13ba84f10dbe67af56729f9951?s=128&d=identicon&r=PG&f=1", "display_name": "R.J. Robinson", "link": "https://stackoverflow.com/users/3765772/r-j-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53183, "favorite_count": 15, "accepted_answer_id": 30097929, "answer_count": 12, "score": 62, "last_activity_date": 1610767767, "creation_date": 1421962021, "last_edit_date": 1421962667, "question_id": 28099004, "link": "https://stackoverflow.com/questions/28099004/unable-to-build-protobuf-to-go-endpoint", "title": "Unable to build protobuf to go endpoint", "body": "<p>using protobuf version 2.6.1 ( which i installed via homebrew)  </p>\n\n<p>I am trying to run  </p>\n\n<pre><code>$ protoc --go_out=../cloud/ *.proto\n</code></pre>\n\n<p>I keep receiving this error. </p>\n\n<pre><code>$ protoc-gen-go: program not found or is not executable\n$ --go_out: protoc-gen-go: Plugin failed with status code 1.\n</code></pre>\n\n<p>I have the protoc-gen-go installed in my go path. \nAnyone else have this issue?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 568, "user_id": 1271462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X0hD9.jpg?s=128&g=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/1271462/frank"}, "edited": false, "score": 0, "creation_date": 1422555996, "post_id": 28097735, "comment_id": 44806866, "body": "Thanks for the link, that should give me some good pointers. The formatting with tabs etc. was pretty easy. For the keywords groups I just used map[string]struct{}."}], "tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": false, "score": 1, "last_activity_date": 1421957228, "creation_date": 1421957228, "answer_id": 28097735, "question_id": 28097468, "link": "https://stackoverflow.com/questions/28097468/go-format-string-according-to-keywords/28097735#28097735", "title": "Go: Format string according to keywords", "body": "<p>If you want to do this truly right you need a full-fledged SQL parser. <a href=\"http://godoc.org/code.google.com/p/vitess/go/vt/sqlparser\" rel=\"nofollow\">This one</a> could work, but for what I see the output is not really what you are looking for. So you'd need to tweak it yourself.</p>\n"}], "owner": {"reputation": 568, "user_id": 1271462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X0hD9.jpg?s=128&g=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/1271462/frank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421957228, "creation_date": 1421956306, "question_id": 28097468, "link": "https://stackoverflow.com/questions/28097468/go-format-string-according-to-keywords", "title": "Go: Format string according to keywords", "body": "<p>In Go (golang) what would be the best way to format a string like this:</p>\n\n<pre><code>select col1, col2, col3 from foo where col1 &gt; 1000 and col2 &lt; 2000\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>SELECT col1, col2, col3 \nFROM foo \nWHERE col1 &gt; 1000 \n    AND col2 &lt; 2000\n</code></pre>\n\n<p>Would it be best to split it up, then if it's a keyword insert a \"\\n\" in front of it. And if it contains AND etc. also add a tab or spaces in front of it. </p>\n\n<p>But what if the string was like this:</p>\n\n<pre><code>if (1 &gt; 0)\nbegin\nif (2 &gt; 1)\nbegin\nselect * from foo\nend\nend\n</code></pre>\n\n<p>Then the formatting get's a little more complicated, since you would need additional tabs for the inner query after the begin. And also the 2nd begin would also need to be formatted. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1422024136, "post_id": 28095956, "comment_id": 44598258, "body": "Note that Go also allows the terse alternative <code>type SquareEdges int</code>, for declaring types that have a single underlying data value. Everything else discussed here apples to these terse types too."}], "answers": [{"tags": [], "owner": {"reputation": 1993, "user_id": 623949, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cf441bdd92dabf1b772104901c78cf99?s=128&d=identicon&r=PG", "display_name": "tgrosinger", "link": "https://stackoverflow.com/users/623949/tgrosinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1421951403, "creation_date": 1421951403, "answer_id": 28096152, "question_id": 28095956, "link": "https://stackoverflow.com/questions/28095956/understanding-interfaces-in-go/28096152#28096152", "title": "Understanding interfaces in Go", "body": "<p>Go isn't an object oriented language, and those fields are internal fields since they start with lower case letters. Instead, try something like this:</p>\n\n<pre><code>type Shape interface {\n    EdgeCount() int\n}\n\ntype Square struct {\n   edgesCount int\n}\n\nfunc (s Square) EdgeCount() int {\n    return s.edgesCount\n}\n\ntype Triangle struct {\n   edgesCount int\n}\n\nfunc (t Triangle) EdgeCount() int {\n    return t.edgesCount\n}\n</code></pre>\n\n<p>Now you can do things using the EdgeCount function on either type of object since they both implement the Shape interface.</p>\n\n<pre><code>func IsItSquare(s Shape) bool {\n    // If it has 4 sides, maybe\n    return s.EdgeCount == 4\n}\n</code></pre>\n\n<p>But you will still need to create the different types of shapes with independent New functions, or just by declaring them literally.</p>\n\n<pre><code>// Obviously a contrived example\ns := Triangle{edgesCount: 3}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 3, "last_activity_date": 1421951564, "last_edit_date": 1495535358, "creation_date": 1421951564, "answer_id": 28096200, "question_id": 28095956, "link": "https://stackoverflow.com/questions/28095956/understanding-interfaces-in-go/28096200#28096200", "title": "Understanding interfaces in Go", "body": "<p>What you are referring to isn't interface (which allows to pass an object as that interface, simply because the object is a receiver for all the interface method).<br>\nHere, an <a href=\"https://stackoverflow.com/a/23148998/6309\">empty <code>interface{}' Shape</code> would be satisfied by any type</a>, which isn't useful here.</p>\n\n<p>It is more about <a href=\"http://www.hydrogen18.com/blog/golang-embedding.html\" rel=\"nofollow noreferrer\">type embedding</a> (using an <a href=\"https://stackoverflow.com/a/28014640/6309\">anonymous type structure</a> for instance): </p>\n\n<p>That would <em>promote</em> the common field <code>edgesCount</code> to both struct.<br>\nAs the <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">spec mentions</a>:</p>\n\n<blockquote>\n  <p>A field or method <code>f</code> of an anonymous field in a <code>struct x</code> is called <strong>promoted</strong> if <code>x.f</code> is a legal selector that denotes that field or method <code>f</code>.</p>\n</blockquote>\n\n<p>See <a href=\"https://play.golang.org/p/7MQwSgumUx\" rel=\"nofollow noreferrer\">this example</a>:</p>\n\n<pre><code>type Shape struct {\n    edgesCount int\n}\n\ntype Square struct {\n    Shape\n}\n\ntype Triangle struct {\n    Shape\n}\n\nfunc NewSquare() *Square {\n    return &amp;Square{\n        Shape{edgesCount: 4},\n    }\n}\nfunc NewTriangle() *Triangle {\n    return &amp;Triangle{\n        Shape{edgesCount: 3},\n    }\n}\n\nfunc main() {\n    fmt.Printf(\"Square %+v\\n\", NewSquare())\n    fmt.Printf(\"Triangle %+v\\n\", NewTriangle())\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Square &amp;{Shape:{edgesCount:4}}\nTriangle &amp;{Shape:{edgesCount:3}}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171, "user_id": 4493198, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kAjSGsEiJG4/AAAAAAAAAAI/AAAAAAABW2o/rzwHgxgYxY4/photo.jpg?sz=128", "display_name": "iccananea", "link": "https://stackoverflow.com/users/4493198/iccananea"}, "is_accepted": false, "score": 0, "last_activity_date": 1422236758, "creation_date": 1422236758, "answer_id": 28143741, "question_id": 28095956, "link": "https://stackoverflow.com/questions/28095956/understanding-interfaces-in-go/28143741#28143741", "title": "Understanding interfaces in Go", "body": "<p>Interface only group methods, as their purpose is to define behavior, very much like in other languages (see <a href=\"http://docs.oracle.com/javase/tutorial/java/concepts/interface.html\" rel=\"nofollow\">Java Interfaces</a>, for example).</p>\n\n<p>What you are looking for is something like code inheritance, which doesn't exist in Go. BUT, you can get something similar with <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow\">struct embedding</a>:</p>\n\n<blockquote>\n  <p>Go does not provide the typical, type-driven notion of subclassing, but it does have the ability to \u201cborrow\u201d pieces of an implementation by embedding types within a struct or interface.</p>\n</blockquote>\n\n<p>So, you can get what you want by doing the following (<a href=\"http://play.golang.org/p/jDoCl3yOIK\" rel=\"nofollow\">play link</a>):</p>\n\n<pre><code>type Shape struct {\n    edgeCount int\n}\n\nfunc (s Shape) EdgeCount() int {\n    return s.edgeCount\n}\n\ntype Square struct {\n    Shape\n}\n\ntype Triangle struct {\n    Shape\n}\n\nfunc main() {\n    sq := Square{Shape{edgeCount: 4}}\n    tr := Square{Shape{edgeCount: 3}}\n    fmt.Println(sq.EdgeCount())\n    fmt.Println(tr.EdgeCount())\n}\n</code></pre>\n"}], "owner": {"reputation": 7273, "user_id": 2641547, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/660520007/picture?type=large", "display_name": "Spearfisher", "link": "https://stackoverflow.com/users/2641547/spearfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 1, "accepted_answer_id": 28096200, "answer_count": 3, "score": 0, "last_activity_date": 1422236758, "creation_date": 1421950774, "last_edit_date": 1421989576, "question_id": 28095956, "link": "https://stackoverflow.com/questions/28095956/understanding-interfaces-in-go", "title": "Understanding interfaces in Go", "body": "<p>I am trying to understand how interfaces work in Go.</p>\n\n<p>Let's say I have 2 structs:</p>\n\n<pre><code>package \"Shape\"\n\ntype Square struct {\n   edgesCount int\n}\n\ntype Triangle struct {\n   edgesCount int\n}\n</code></pre>\n\n<p>Now I create a <code>Shape</code> interface:</p>\n\n<pre><code>type Shape interface {\n\n}\n</code></pre>\n\n<p>Why can't I specify that the <code>Shape</code> interface has an <code>egdesCount</code> property? Are interfaces only supposed to regroup methods?</p>\n\n<p>Another problem I face is sharing function. Isn't possible to come up with something like this:</p>\n\n<pre><code>func New() *Shape {\n  s:=new(Shape)\n  s.edgesCount = 0\n  return s\n}\n</code></pre>\n\n<p>This would be much better than having to rewrite the exact same code:</p>\n\n<pre><code>func New() *Square {\n  s:=new(Square)\n  s.edgesCount = 0\n  return s\n}\n\nfunc New() *Triangle {\n  s:=new(Triangle)\n  s.edgesCount = 0\n  return s\n}\n</code></pre>\n\n<p>(which also poses problem as I cannot redeclare my <code>New</code> function...)</p>\n\n<p>Many thanks for your help</p>\n"}, {"tags": ["csv", "go", "directory"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1421951953, "post_id": 28095639, "comment_id": 44568296, "body": "How exactly are you running this?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1421961699, "post_id": 28095639, "comment_id": 44573581, "body": "no, I mean are you running the compiled binary, or <code>go run</code>? Are you using absolute paths, or relative paths?"}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1421998221, "post_id": 28095639, "comment_id": 44584623, "body": "Actually I have tried both with relative paths."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1421960994, "last_edit_date": 1421960994, "creation_date": 1421954033, "answer_id": 28096858, "question_id": 28095639, "link": "https://stackoverflow.com/questions/28095639/how-to-fix-file-access-when-using-a-sub-directory/28096858#28096858", "title": "How to fix file access when using a sub-directory?", "body": "<p><a href=\"http://godoc.org/os#FileInfo.Name\" rel=\"nofollow\">FileInfo.Name</a> returns the base name of the file. You need to <a href=\"http://godoc.org/path/filepath#Join\" rel=\"nofollow\">join</a> the directory name with the base name to get a file path.</p>\n\n<p>Change this line in GetFiles</p>\n\n<pre><code>result = append(result, file.Name())\n</code></pre>\n\n<p>to</p>\n\n<pre><code>result = append(result, filepath.Join(importPath, file.Name()))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 0, "creation_date": 1423087232, "post_id": 28096951, "comment_id": 45011665, "body": "I finally decided to use Glob in my last script version. When I came to the point where I needed the filename I used strip + separator to get rid of the path and slash. Thanks for this!"}], "tags": [], "owner": {"reputation": 9694, "user_id": 797538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b50394e88b7b1ff30dbca04c06560e5a?s=128&d=identicon&r=PG", "display_name": "lnmx", "link": "https://stackoverflow.com/users/797538/lnmx"}, "is_accepted": false, "score": 3, "last_activity_date": 1421954351, "creation_date": 1421954351, "answer_id": 28096951, "question_id": 28095639, "link": "https://stackoverflow.com/questions/28095639/how-to-fix-file-access-when-using-a-sub-directory/28096951#28096951", "title": "How to fix file access when using a sub-directory?", "body": "<p>In this case, you might consider using the higher-level <a href=\"http://golang.org/pkg/path/filepath/#Glob\" rel=\"nofollow\">filepath.Glob()</a> instead:</p>\n\n<pre><code>files, err := filepath.Glob(filepath.Join(importPath, \"*.csv\"))\n</code></pre>\n"}], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1006, "favorite_count": 0, "accepted_answer_id": 28096858, "answer_count": 2, "score": 1, "last_activity_date": 1566485532, "creation_date": 1421949609, "last_edit_date": 1566485532, "question_id": 28095639, "link": "https://stackoverflow.com/questions/28095639/how-to-fix-file-access-when-using-a-sub-directory", "title": "How to fix file access when using a sub-directory?", "body": "<p>Which way Go does handle read access to directories and files?</p>\n\n<p>I want to read a folder, search for csv files and save the content per csv file in order to send the content via http request.</p>\n\n<p>Here's my code: </p>\n\n<pre><code>func GetFileContent(fileName string) ([][]string, error) {\n  file, err := os.Open(fileName)\n  if err != nil {\n    log.Println(\"There was an error:\", err)\n    return nil, err\n  }\n\n  defer file.Close()\n  reader := csv.NewReader(file)\n  reader.FieldsPerRecord = -1\n  csvFileContent, err := reader.ReadAll()\n  if err != nil {\n    log.Println(\"There was an error:\", err)\n    return nil, err\n  }\n  return csvFileContent, nil\n}\n\nfunc GetFiles(importPath string, fileExtension string) ([]string, error) {\n\n  var result []string\n\n  directory, err := os.Open(importPath)\n  if err != nil {\n    return result, err\n  }\n  defer directory.Close()\n\n  files, err := directory.Readdir(-1)\n  if err != nil {\n    return result, err\n  }\n\n  for _, file := range files {\n    if file.Mode().IsRegular() {\n      if filepath.Ext(file.Name()) == \".\" + fileExtension {\n        log.Println(\"Import Files: \", file.Name())\n        result = append(result, file.Name())\n      }\n    }\n  }\n  if len(result) == 0 {\n    log.Println(\"No import files of type \" + fileExtension + \" found.\")\n    log.Println(\"Import skipped.\")\n  }\n  return result, nil\n}\n</code></pre>\n\n<blockquote>\n  <p>Error: open : no such file or directory </p>\n</blockquote>\n\n<p>appears when I do not use the root folder / working directory of my application but another (parent) folder? It works as long as I use ./ as source folder. </p>\n"}, {"tags": ["google-app-engine", "go", "cron"], "comments": [{"owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "edited": false, "score": 0, "creation_date": 1421949689, "post_id": 28095329, "comment_id": 44567068, "body": "10-20 million writes for &quot;some meta data&quot; seems awfully a lot."}, {"owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "edited": false, "score": 0, "creation_date": 1421949771, "post_id": 28095329, "comment_id": 44567119, "body": "It&#39;s not clear what you are asking. Your costs are driven by these datastore writes (since you are not using a backend, instance hours is not an issue). How you do them (at night, using a cron job, on backends, etc.) does not matter."}, {"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "reply_to_user": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "edited": false, "score": 0, "creation_date": 1421950884, "post_id": 28095329, "comment_id": 44567736, "body": "I suppose part of the issue is that I don&#39;t know exactly what I&#39;m trying to ask because I&#39;m not very familiar with backends/modules (or other options) and what their specific benefits are.  But you have a good point, if my cost is driven by the write ops, and the main benefit of backends/modules is cheaper instance hours, then they would not help.  I suppose I will have to take the long road and look into making my logic and data structure more efficient instead.  Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "edited": false, "score": 1, "creation_date": 1422029434, "post_id": 28110881, "comment_id": 44601899, "body": "Thank you, Christiaan, very helpful advice.  I think the main problem lies with my data model, just too many writes are required to do what I am doing.  I&#39;m a fairly new convert from SQL to BigTable, so I have definitely made some mistakes along the way.  I have learned the importance of knowing ahead of time what you will want to do with the data in the end (I wish my boss could actually tell me what he wanted me to do with the data, that would greatly help).  Again, thank you for the input on such a vague question."}], "tags": [], "owner": {"reputation": 2377, "user_id": 188947, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9071f831fb4fc3e58fe2467d9d3bb65b?s=128&d=identicon&r=PG", "display_name": "Christiaan", "link": "https://stackoverflow.com/users/188947/christiaan"}, "is_accepted": true, "score": 1, "last_activity_date": 1422019300, "creation_date": 1422019300, "answer_id": 28110881, "question_id": 28095329, "link": "https://stackoverflow.com/questions/28095329/google-appengine-least-expensive-way-to-run-heavy-datastore-write-cron-job/28110881#28110881", "title": "Google appengine, least expensive way to run heavy datastore write cron job?", "body": "<p>Look at your instances at 3am. It might be that GAE spins up a lot of them to handle the job. You could configure your job to make it run less paralel so it will take longer but perhaps it will need only 1 instance then.\nHowever, if your database writes are indeed the biggest factor this won't make a big impact.</p>\n\n<p>You can try looking at your data models and indexes. Remember that each indexed field costs 2 writes extra, so see if you can remove indexes from some fields if you don't need them.</p>\n"}, {"comments": [{"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "edited": false, "score": 0, "creation_date": 1422550741, "post_id": 28121236, "comment_id": 44803769, "body": "1) Interesting... I didn&#39;t realize that would help.  I thought (but am open to being made fun of if I&#39;m totally wrong) that the number of writes depended on the data structure and indexes, not how often I actually called the datastore.Put() method."}, {"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "edited": false, "score": 0, "creation_date": 1422550949, "post_id": 28121236, "comment_id": 44803912, "body": "2) I didn&#39;t realize there was a &quot;reliable&quot; memcache, the docs I read said to use memcache as if the data may disappear at any time.  If that is true, isn&#39;t it entirely possible that the data I am temporarily keeping in memcache could just get lost?  I can&#39;t afford to lose any of this data, although I guess I could validate it before I write it to the datastore.  My strategy has been to store data in it after I pull it out of the datastore, but to erase it from memcache after I write an update to the datastore."}, {"owner": {"reputation": 2571, "user_id": 2149974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb21c41d027acd90bb86547189a7da7?s=128&d=identicon&r=PG", "display_name": "marcadian", "link": "https://stackoverflow.com/users/2149974/marcadian"}, "reply_to_user": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "edited": false, "score": 0, "creation_date": 1422645073, "post_id": 28121236, "comment_id": 44846699, "body": "1) It would since you reduce your datastore write operation by. Let me clarify, instead of writing N rows to datastore directly, you write them into a single entry in memcache, and when it&#39;s almost full, you write the entry in memcache into a single entry in datastore. This will reduce the datastore operations. However this will only work if your entry is small (but many of them) and the downside is, you cannot query it back. 2. possible in theory, that&#39;s just based on my experience that the dedicated is more reliable. Since you have a dedicated size for you instead of shared with other apps."}, {"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "edited": false, "score": 0, "creation_date": 1422898439, "post_id": 28121236, "comment_id": 44920916, "body": "I think I&#39;m confused.  Why would you ever want to store something if you can&#39;t query it back?  I definitely need to re-query the data that I am storing, the whole reason I am creating it in the first place is to provide a filterable report for my users.  My data has values like Date, Department, Location, etc., with a numeric value attached.  So my report needs to be able to pull all entries for a given date range, department, location, etc, and add up all the numeric values (and display several other string values), so it definitely needs to be query-able."}, {"owner": {"reputation": 2571, "user_id": 2149974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb21c41d027acd90bb86547189a7da7?s=128&d=identicon&r=PG", "display_name": "marcadian", "link": "https://stackoverflow.com/users/2149974/marcadian"}, "reply_to_user": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "edited": false, "score": 0, "creation_date": 1422933553, "post_id": 28121236, "comment_id": 44935033, "body": "For analytics purposes, you do not need to query from appengine. So store it in the cheapest possible way, and dump it to another database that is built for analytics :)"}, {"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "edited": false, "score": 0, "creation_date": 1422986924, "post_id": 28121236, "comment_id": 44962646, "body": "Hm... that sounds like more work than I had hoped, but you may be on to something."}], "tags": [], "owner": {"reputation": 2571, "user_id": 2149974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb21c41d027acd90bb86547189a7da7?s=128&d=identicon&r=PG", "display_name": "marcadian", "link": "https://stackoverflow.com/users/2149974/marcadian"}, "is_accepted": false, "score": 1, "last_activity_date": 1422061924, "creation_date": 1422061924, "answer_id": 28121236, "question_id": 28095329, "link": "https://stackoverflow.com/questions/28095329/google-appengine-least-expensive-way-to-run-heavy-datastore-write-cron-job/28121236#28121236", "title": "Google appengine, least expensive way to run heavy datastore write cron job?", "body": "<p>One improvement that you can do is to batch your write operations, you can use memcache for this (pay the dedicated one since it's more reliable). Write the updates to memcache, once it's about 900K, flush it to datastore. This will reduces the number of write to datastore A LOT, especially if your metadata's size is small.</p>\n"}], "owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 0, "accepted_answer_id": 28110881, "answer_count": 2, "score": 0, "last_activity_date": 1422061924, "creation_date": 1421948691, "question_id": 28095329, "link": "https://stackoverflow.com/questions/28095329/google-appengine-least-expensive-way-to-run-heavy-datastore-write-cron-job", "title": "Google appengine, least expensive way to run heavy datastore write cron job?", "body": "<p>I have a Google appengine application, written in Go, that has a cron process which runs once a day at 3am.  This process looks at all of the changes that have happened to my data during the day and stores some meta data about what happened.  My users can run reports on this meta data to see trends that have happened over several months.  The process does around 10-20 million datastore writes every night.  It all works just fine, but since I have started running it I have noticed a significant increase in my monthly bill from Google (from around $50/month to around $400/month).</p>\n\n<p>I have just setup a very basic taskqueue that this runs in, I have not changed the default settings at all.  Is there a better way that I could be running this process at night that could save me money?  I have never messed around with the backends (which are now depreciated) or the modules api, and I know they've changed a lot of this stuff recently so I'm not sure where to start looking.  Any advice would be greatly appreciated.</p>\n"}, {"tags": ["python", "hash", "go", "cryptography", "sha1"], "comments": [{"owner": {"reputation": 16853, "user_id": 4101725, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dGwoPMFb_tM/AAAAAAAAAAI/AAAAAAAABks/tMMqc6E9REg/photo.jpg?sz=128", "display_name": "Michele d&#39;Amico", "link": "https://stackoverflow.com/users/4101725/michele-damico"}, "edited": false, "score": 1, "creation_date": 1421946921, "post_id": 28094673, "comment_id": 44565488, "body": "val in python is not bytes ... try <code>val = b&#39;nJ1m4Cc3&#39;</code>"}, {"owner": {"reputation": 26078, "user_id": 145400, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e40548053ab6deeef715a1f7fd0aafef?s=128&d=identicon&r=PG", "display_name": "Dr. Jan-Philip Gehrcke", "link": "https://stackoverflow.com/users/145400/dr-jan-philip-gehrcke"}, "edited": false, "score": 1, "creation_date": 1421948699, "post_id": 28094673, "comment_id": 44566485, "body": "A Python method that reproduces what you have shown in Go now is contained in my answer. <code>hmac.new(&quot;sha1&quot;, val)</code> is wrong: it provides <code>&quot;sha1&quot;</code> as <code>key</code>, and does not specify the right digest constructor, so that this method actually uses md5 internally. You just need to carefully read the documentation and understand what the <code>msg</code>, <code>key</code>, and <code>digestmod</code> arguments mean in the <code>hmac.new()</code> signature. <a href=\"https://docs.python.org/2/library/hmac.html\" rel=\"nofollow noreferrer\">docs.python.org/2/library/hmac.html</a>"}, {"owner": {"reputation": 26078, "user_id": 145400, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e40548053ab6deeef715a1f7fd0aafef?s=128&d=identicon&r=PG", "display_name": "Dr. Jan-Philip Gehrcke", "link": "https://stackoverflow.com/users/145400/dr-jan-philip-gehrcke"}, "edited": false, "score": 0, "creation_date": 1421950006, "post_id": 28094673, "comment_id": 44567247, "body": "You are welcome, it was a good opportunity to use Go again, which I have set up for a while already on my system :-). And, just in case, don&#39;t forget to accept the answer :-)."}], "answers": [{"comments": [{"owner": {"reputation": 2021, "user_id": 2325264, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9a5b28c1bf706b9138017bf0fd23ac45?s=128&d=identicon&r=PG", "display_name": "eric chiang", "link": "https://stackoverflow.com/users/2325264/eric-chiang"}, "edited": false, "score": 0, "creation_date": 1421947683, "post_id": 28094882, "comment_id": 44565933, "body": "I&#39;m trying to keep consistent with existing passwords I have hashed using <a href=\"https://github.com/yhat/phash\" rel=\"nofollow noreferrer\">github.com/yhat/phash</a> and furthermore node&#39;s password-hash which uses the <code>hasher := hmac.New(sha1.New, val)</code> line. But thanks!"}], "tags": [], "owner": {"reputation": 26078, "user_id": 145400, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e40548053ab6deeef715a1f7fd0aafef?s=128&d=identicon&r=PG", "display_name": "Dr. Jan-Philip Gehrcke", "link": "https://stackoverflow.com/users/145400/dr-jan-philip-gehrcke"}, "is_accepted": true, "score": 6, "last_activity_date": 1421949764, "last_edit_date": 1421949764, "creation_date": 1421947252, "answer_id": 28094882, "question_id": 28094673, "link": "https://stackoverflow.com/questions/28094673/python-vs-go-hashing-differences/28094882#28094882", "title": "Python vs Go Hashing Differences", "body": "<p>You have to make sure that</p>\n\n<ul>\n<li>the input in both scenarios is equivalent and that</li>\n<li>the processing method in both scenarios is equivalent.</li>\n</ul>\n\n<p>In both cases, the input should be the same binary blob. In your Python program you define a unicode object, and you do not take control of its binary representation. Replace the <code>u</code> prefix with a <code>b</code>, and you are fine (this is the explicit way to define a byte sequence in Python 2.7 and 3). This is not the actual problem, but better be explicit here.</p>\n\n<p><strong>The problem is that you apply different methods in your Go and Python implementations.</strong></p>\n\n<h2>Given that Python is the reference</h2>\n\n<p>In Go, no need to import <code>\"crypto/hmac\"</code> at all,  in Python you just build a SHA1 hash of your data. In Go, the equivalent would be:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/sha1\"\n    \"fmt\"\n)\n\nfunc main() {\n    data := []byte(\"nJ1m4Cc3\")\n    fmt.Printf(\"%x\", sha1.Sum(data))\n}\n</code></pre>\n\n<p>Test and output:</p>\n\n<pre><code>go run hashit.go\nd67c1f445987c52bceb8d6475c30a8b0e9a3365d\n</code></pre>\n\n<p>This reproduces what your first Python snippet creates.</p>\n\n<p>Edit: I have simplified the Go code a bit, to not make Python look more elegant. Go is quite elegant here, too :-).</p>\n\n<h2>Given that Go is the reference</h2>\n\n<pre><code>import hmac\nimport hashlib\n\ndata = b'nJ1m4Cc3'\nh = hmac.new(key=data, digestmod=hashlib.sha1)\nprint h.hexdigest()\n</code></pre>\n\n<p>Test &amp; output:</p>\n\n<pre><code>python hashit.py\nf7c0aebfb7db2c15f1945a6b7b5286d173df894d\n</code></pre>\n\n<p>This reproduces what your Go snippet creates. I am, however, not sure about the cryptographic significance of an HMAC when one does use an empty message.</p>\n"}], "owner": {"reputation": 2021, "user_id": 2325264, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9a5b28c1bf706b9138017bf0fd23ac45?s=128&d=identicon&r=PG", "display_name": "eric chiang", "link": "https://stackoverflow.com/users/2325264/eric-chiang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 28094882, "answer_count": 1, "score": 2, "last_activity_date": 1421949764, "creation_date": 1421946583, "last_edit_date": 1421948589, "question_id": 28094673, "link": "https://stackoverflow.com/questions/28094673/python-vs-go-hashing-differences", "title": "Python vs Go Hashing Differences", "body": "<p>I have a Go program</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/hmac\"\n    \"crypto/sha1\"\n    \"fmt\"\n)\n\nfunc main() {\n    val := []byte(\"nJ1m4Cc3\")\n    hasher := hmac.New(sha1.New, val)\n    fmt.Printf(\"%x\\n\", hasher.Sum(nil))\n    // f7c0aebfb7db2c15f1945a6b7b5286d173df894d\n}\n</code></pre>\n\n<p>And a Python (2.7) program that is attempting to reproduce the Go code (using <code>crypto/hmac</code>)</p>\n\n<pre><code>import hashlib\nval =  u'nJ1m4Cc3'\nhasher = hashlib.new(\"sha1\", val)\nprint hasher.hexdigest()\n# d67c1f445987c52bceb8d6475c30a8b0e9a3365d\n</code></pre>\n\n<p>Using the <code>hmac</code> module gives me a different result but still not the same as the Go code.</p>\n\n<pre><code>import hmac\nval = 'nJ1m4Cc3'\nh = hmac.new(\"sha1\", val)\nprint h.hexdigest()\n# d34435851209e463deeeb40cba7b75ef\n</code></pre>\n\n<p>Why do these print different values when they use the same hash on the same input?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1421943685, "post_id": 28093573, "comment_id": 44563523, "body": "However, as far as I know, the GC won&#39;t free anything on the stack, because the whole stack is freed when the function ends. So why <i>b</i> memory is not used if I declare more variables after the if? isn&#39;t the stack used by variables declared inside the <i>if</i> made available again? I thought that what&#39;s is the stack about."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1421944091, "post_id": 28093573, "comment_id": 44563784, "body": "Yes, but only if the do not escape. There is no need to think about such stuff until you want to improve the compiler or are under heavy GC pressure and want to create a minimum of garbage. And b&#39;s memory is not used by other stuff because that would be a compiler bug."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1421943371, "creation_date": 1421943371, "answer_id": 28093573, "question_id": 28093437, "link": "https://stackoverflow.com/questions/28093437/is-it-safe-to-use-the-memory-address-of-descoped-variables/28093573#28093573", "title": "Is it safe to use the memory address of descoped variables?", "body": "<p>There are no dangling pointers in Go. </p>\n\n<p>It doesn't matter if <code>b</code> is out of scope; <code>a</code> now holds that address and would be scanned by the GC.</p>\n"}, {"comments": [{"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1421943776, "post_id": 28093593, "comment_id": 44563590, "body": "That applies to the heap, but AFAIK the GC doesn&#39;t free anything on the stack. Is it guaranteed that the stack memory that previously used <i>b</i> won&#39;t be used by any other variable declared in the same function after the <i>if</i> ?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1421944161, "post_id": 28093593, "comment_id": 44563830, "body": "Escaping is from functions (as far as I understand it), not from block scopes."}, {"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1421944661, "post_id": 28093593, "comment_id": 44564147, "body": "Yes, it is for functions and I it works like Ainar-G says: if they escape, they are moved to the heap. But I thought that the stack memory used by variables was &quot;freed&quot; (the stack pointer goes down) for next declarations inside the same function. It seems that it is not the case in Go, and that memory is not made available, so it is use to point to their memory addresses. Am I right?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1421955141, "post_id": 28093593, "comment_id": 44570110, "body": "Traditionally the stackpointer changes on function invocation and returns."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1421944080, "last_edit_date": 1421944080, "creation_date": 1421943414, "answer_id": 28093593, "question_id": 28093437, "link": "https://stackoverflow.com/questions/28093437/is-it-safe-to-use-the-memory-address-of-descoped-variables/28093593#28093593", "title": "Is it safe to use the memory address of descoped variables?", "body": "<p>Yes, it's perfectly fine.</p>\n\n<p>Scope doesn't matter in Go as much as in C or Rust. Go is a garbage-collected language. As long as the memory can be reached, it won't be freed. In your example, the original value of <code>a</code> will be freed during the next GC, as it's not reachable any more.</p>\n\n<p><strong>Edit:</strong> On stack. In your program, <code>b</code> does not escape because it doesn't need to. If you rewrite your program so that <code>b</code> will be deleted if allocated on stack (for example, <a href=\"http://play.golang.org/p/T1Ex7Lfzhi\" rel=\"nofollow\">like this</a>) you'll see that <code>b</code> does escape. Go's escape analysis is clever enough to see such things.</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 2, "last_activity_date": 1421945402, "creation_date": 1421945402, "answer_id": 28094281, "question_id": 28093437, "link": "https://stackoverflow.com/questions/28093437/is-it-safe-to-use-the-memory-address-of-descoped-variables/28094281#28094281", "title": "Is it safe to use the memory address of descoped variables?", "body": "<p>Code is safe. Any assignment in Go has copy semantic, so</p>\n\n<pre><code>a = &amp;b\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>c = &amp;b\na = c\n</code></pre>\n\n<p>assigning to reference you effectively take a copy of this reference</p>\n\n<p>so this sure will also work</p>\n\n<pre><code>b := 5\nc := &amp;b\na = c\nc = nil\n\nfmt.Println(*a)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/fGTYhEXl1S\" rel=\"nofollow\">http://play.golang.org/p/fGTYhEXl1S</a></p>\n"}], "owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 28093593, "answer_count": 3, "score": 1, "last_activity_date": 1421945402, "creation_date": 1421942978, "question_id": 28093437, "link": "https://stackoverflow.com/questions/28093437/is-it-safe-to-use-the-memory-address-of-descoped-variables", "title": "Is it safe to use the memory address of descoped variables?", "body": "<p>Is this code safe? <em>b</em> gets descoped when the <em>if</em> block ends, but <em>a</em> still points to <em>b</em>'s memory address. In this simple example it seems to work (it prints the right value), but it is in the language specification that this will always work? </p>\n\n<p>Compiling with -m to check the compiler optimizations, it says that <em>b</em> doesn't escape to the heap.</p>\n\n<p>Playground: <a href=\"http://play.golang.org/p/ZzYkMg6FqB\" rel=\"nofollow\">http://play.golang.org/p/ZzYkMg6FqB</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := new(int)\n    *a = 10\n    if *a &gt; 0 {\n        b := 5\n        a = &amp;b\n    }\n    fmt.Println(*a)\n}\n</code></pre>\n"}, {"tags": ["unit-testing", "testing", "concurrency", "go", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 15901, "user_id": 10093, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f2a0aab1b23c61729aee2685e1bbd502?s=128&d=identicon&r=PG", "display_name": "dave mankoff", "link": "https://stackoverflow.com/users/10093/dave-mankoff"}, "edited": false, "score": 0, "creation_date": 1421942447, "post_id": 28092796, "comment_id": 44562698, "body": "Except that I don&#39;t wait to wait for runCmd to finish. At least, I would prefer not to. The calling function in this case is meant to be short lived, used simply to kick off the potentially longer running <code>runCmd</code>."}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 15901, "user_id": 10093, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f2a0aab1b23c61729aee2685e1bbd502?s=128&d=identicon&r=PG", "display_name": "dave mankoff", "link": "https://stackoverflow.com/users/10093/dave-mankoff"}, "edited": false, "score": 0, "creation_date": 1421945303, "post_id": 28092796, "comment_id": 44564574, "body": "@davemankoff then you risk that your program exists without all work finishing. But if you really don&#39;t want to wait, your main program can ignore the done channel and your testing code can use the done channel."}, {"owner": {"reputation": 15901, "user_id": 10093, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f2a0aab1b23c61729aee2685e1bbd502?s=128&d=identicon&r=PG", "display_name": "dave mankoff", "link": "https://stackoverflow.com/users/10093/dave-mankoff"}, "edited": false, "score": 0, "creation_date": 1421946155, "post_id": 28092796, "comment_id": 44565050, "body": "If I ignore the done channel, won&#39;t runCmd block, waiting for it to be read from? <a href=\"http://golang.org/ref/spec#Channel_types\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Channel_types</a>. It seems like I could maybe make it buffered, but it&#39;s unclear to me the exact behavior there if I never read from it."}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 15901, "user_id": 10093, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f2a0aab1b23c61729aee2685e1bbd502?s=128&d=identicon&r=PG", "display_name": "dave mankoff", "link": "https://stackoverflow.com/users/10093/dave-mankoff"}, "edited": false, "score": 1, "creation_date": 1421952903, "post_id": 28092796, "comment_id": 44568888, "body": "I updated my answer to use a wait group instead.  This will work but your main program should probably stick around to handle any error reporting that might occur from your exec commands."}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 1, "last_activity_date": 1421957548, "last_edit_date": 1421957548, "creation_date": 1421941208, "answer_id": 28092796, "question_id": 28092062, "link": "https://stackoverflow.com/questions/28092062/testing-goroutine-that-my-code-does-not-wait-for/28092796#28092796", "title": "Testing Goroutine That My Code Does Not Wait For", "body": "<p>Use a wait group</p>\n\n<pre><code>wg := sync.WaitGroup{}\nerrc := make(chan error)\nwg.Add(1)\ngo func() {\n    runCmd([]string{\"sleep\", 1}, errc)\n    wg.Done()\n}()\nerr &lt;- errc\nif err != nil {\n    // handle error\n}\nwg.Wait()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1421947541, "last_edit_date": 1421947541, "creation_date": 1421946287, "answer_id": 28094577, "question_id": 28092062, "link": "https://stackoverflow.com/questions/28092062/testing-goroutine-that-my-code-does-not-wait-for/28094577#28094577", "title": "Testing Goroutine That My Code Does Not Wait For", "body": "<p>Simplest method to aware all goroutings done is to add <code>select{}</code> as last <code>main.main()</code> statement. But <code>main()</code> will never return this way and you should kill process explicitly.\nIt's also more gentle <code>runtime.Goshed()</code> to wait for others, but it can't provide such a strong guarantee.\nAnd the canonical way would be</p>\n\n<pre><code>wg := sync.WaitGroup\n...\nwg.Add(1)\ngo runCmd(...)\n...\nwg.Wait()\n</code></pre>\n"}], "owner": {"reputation": 15901, "user_id": 10093, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f2a0aab1b23c61729aee2685e1bbd502?s=128&d=identicon&r=PG", "display_name": "dave mankoff", "link": "https://stackoverflow.com/users/10093/dave-mankoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 1, "accepted_answer_id": 28092796, "answer_count": 2, "score": 1, "last_activity_date": 1421957548, "creation_date": 1421939261, "question_id": 28092062, "link": "https://stackoverflow.com/questions/28092062/testing-goroutine-that-my-code-does-not-wait-for", "title": "Testing Goroutine That My Code Does Not Wait For", "body": "<p>I have a function that is executed concurrently. It's task is to run a command line method, logging an error if there is one. My main thread of execution does not wait for this method to finish. It simply returns optimistically.</p>\n\n<p>How do I <em>test</em> my function? Assuming that I give it a <code>cmdStr</code>, such as <code>{\"sleep\", \"1\"}</code>, that works but doesn't return instantly, how can I get my test to wait for this function to finish?</p>\n\n<p>I want to ensure that the actual program that runs this does <em>not</em> have to wait for it to finish.</p>\n\n<pre><code>func runCmd(cmdStr []string, errChan chan error) {\n  cmd := exec.Command(cmdStr...)\n  var out bytes.Buffer\n  cmd.Stdout = &amp;out\n  err := cmd.Start()\n  if err != nil {\n    errChan &lt;- err\n    return\n  }\n  // Command started successfully, so our caller can continue.\n  errChan &lt;- nil\n  err = cmd.Wait()\n  if err != nil {\n    log.Println(err)\n  }\n}\n</code></pre>\n"}, {"tags": ["go", "flags", "command-line-tool"], "answers": [{"comments": [{"owner": {"reputation": 4001, "user_id": 1245380, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IuBwG.png?s=128&g=1", "display_name": "Stratus3D", "link": "https://stackoverflow.com/users/1245380/stratus3d"}, "edited": false, "score": 1, "creation_date": 1421941265, "post_id": 28092077, "comment_id": 44561820, "body": "I shouldn&#39;t have been reading the commits to flag.go. They are for 1.4rc2 and I am still on 1.3.3. The code I posted does not work for me. But your solution of setting <code>flag.Usage</code> did work."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 8, "last_activity_date": 1421942377, "last_edit_date": 1421942377, "creation_date": 1421939283, "answer_id": 28092077, "question_id": 28091963, "link": "https://stackoverflow.com/questions/28091963/golang-flag-library-unable-to-override-usage-function-that-prints-out-command-l/28092077#28092077", "title": "Golang flag library: Unable to override Usage function that prints out command line usage", "body": "<p><strong>Edit:</strong></p>\n\n<p>Actually revisiting your code it works! What version of Go are you using? Maybe you need to rebuild your code.</p>\n\n<p>The decision of what <code>Usage</code> function to call is in the <code>flag.go</code> source file, <a href=\"http://golang.org/src/flag/flag.go?#L708\" rel=\"noreferrer\">line 708</a>, unexported function <code>usage()</code> (this is from Go 1.4):</p>\n\n<pre><code>func (f *FlagSet) usage() {\n    if f.Usage == nil {\n        if f == CommandLine {\n            Usage()\n        } else {\n            defaultUsage(f)\n        }\n    } else {\n        f.Usage()\n    }\n}\n</code></pre>\n\n<p>This tells if the <code>FlagSet.Usage</code> is not <code>nil</code>, it will be called. If it is not called for you, it's most likely you're using a Go version prior to 1.4 (which you confirmed in your comment).</p>\n\n<p>But since you're using the default <code>flag.CommandLine</code> flagset, you can simply write:</p>\n\n<pre><code>// Note \"flag.Usage\" instead of \"f.Usage\"\n\nflag.Usage = func() {\n    fmt.Println(\"foo bar\")\n}\n</code></pre>\n"}], "owner": {"reputation": 4001, "user_id": 1245380, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IuBwG.png?s=128&g=1", "display_name": "Stratus3D", "link": "https://stackoverflow.com/users/1245380/stratus3d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3845, "favorite_count": 0, "accepted_answer_id": 28092077, "answer_count": 1, "score": 3, "last_activity_date": 1421942377, "creation_date": 1421939015, "last_edit_date": 1421941628, "question_id": 28091963, "link": "https://stackoverflow.com/questions/28091963/golang-flag-library-unable-to-override-usage-function-that-prints-out-command-l", "title": "Golang flag library: Unable to override Usage function that prints out command line usage", "body": "<p>I am working on a simple command line tool and I found the default Usage message a bit lacking. I want to define my own and I think I am doing it right I am referring to <a href=\"http://play.golang.org/p/uaycqgIurf\" rel=\"nofollow\">this example</a>.</p>\n\n<p>I commented out most of the code I had written so the file containing the main function now looks like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    // set the custom Usage function\n    setupFlags(flag.CommandLine)\n    // define flags...\n    // then parse flags\n    flag.Parse()\n    // custom code that uses flag values...\n}\n\nfunc setupFlags(f *flag.FlagSet) {\n    f.Usage = func() {\n        fmt.Println(\"foo bar\")\n    }\n}\n</code></pre>\n\n<p>It seems like this should work, but it doesn't. When running <code>&lt;binary&gt; -h</code> I get the default usage message and not my custom <code>foo bar</code> message that I defined in my custom function. I am using Go version 1.3.3 on OSX. I found <a href=\"https://github.com/golang/go/commit/b2487ef6a399790cfe57127c3f50fc59341460e4\" rel=\"nofollow\">this commit</a> but it is for Go 1.4rc2.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": [".net", "go", "wrapper"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1421933854, "post_id": 28089712, "comment_id": 44556748, "body": "You can use the <code>cgo</code> tool to generate C wrapper files, compile that and build a library from it, I suppose. Haven&#39;t tried it myself. see here: <a href=\"http://golang.org/cmd/cgo/#hdr-C_references_to_Go\" rel=\"nofollow noreferrer\">golang.org/cmd/cgo/#hdr-C_references_to_Go</a>"}, {"owner": {"reputation": 5169, "user_id": 6776, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bd9d1f08afc749be0095b81df67da2c8?s=128&d=identicon&r=PG", "display_name": "thomasb", "link": "https://stackoverflow.com/users/6776/thomasb"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1421935653, "post_id": 28089712, "comment_id": 44558042, "body": "Yo, I heard you liked wrappers, so I put a wrapper inside of your wrapper. Thanks, I&#39;ll take a look. (edit : I haven&#39;t tried because I&#39;m merely at the &quot;what&#39;s possible ?&quot; stage)"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1421937506, "post_id": 28089712, "comment_id": 44559234, "body": "Why Go and not C? AFAIK, the C image handling libraries tend to be faster."}, {"owner": {"reputation": 5169, "user_id": 6776, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bd9d1f08afc749be0095b81df67da2c8?s=128&d=identicon&r=PG", "display_name": "thomasb", "link": "https://stackoverflow.com/users/6776/thomasb"}, "edited": false, "score": 0, "creation_date": 1421939382, "post_id": 28089712, "comment_id": 44560487, "body": "Just because I heard Go was more modern than C and about as fast. I am exploring all possibilities."}], "answers": [{"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 4, "last_activity_date": 1421936333, "creation_date": 1421936333, "answer_id": 28090992, "question_id": 28089712, "link": "https://stackoverflow.com/questions/28089712/is-there-a-way-to-wrap-a-go-library-in-net/28090992#28090992", "title": "Is there a way to wrap a Go library in .Net", "body": "<p>It is currently not possible to embed Go code into a program whose main language isn't Go because Go needs a non-trivial runtime that hooks into many things. The only possible thing is to call C functions from a Go program; these functions may then in turn call Go functions. You might want to design a solution that uses some sort of inter-process communication instead where the part you want to write in Go runs in a different process.</p>\n"}], "owner": {"reputation": 5169, "user_id": 6776, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bd9d1f08afc749be0095b81df67da2c8?s=128&d=identicon&r=PG", "display_name": "thomasb", "link": "https://stackoverflow.com/users/6776/thomasb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 28090992, "answer_count": 1, "score": 0, "last_activity_date": 1421939471, "creation_date": 1421932498, "last_edit_date": 1421939471, "question_id": 28089712, "link": "https://stackoverflow.com/questions/28089712/is-there-a-way-to-wrap-a-go-library-in-net", "title": "Is there a way to wrap a Go library in .Net", "body": "<p>I have seen here and there that Go is like a modern-time C/C++ (meaning: with modern syntax and memory management, but about as fast).<br>\nI'm interested in leveraging the power of such a language, to include an image processing library in our .Net application.</p>\n\n<p>But that raises the problem of wrapping the Go library in a .Net shell. I have successfully wrapped a C library using C++/CLI ; is there a way to do a similar thing with Go ?</p>\n\n<p>I would like to NOT use Swig, which I tried before, and is absolutely awful and doesn't work most of the time.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 1, "creation_date": 1421925617, "post_id": 28087471, "comment_id": 44551952, "body": "hint, try using the numeric values for each part"}, {"owner": {"reputation": 714, "user_id": 1366283, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/93f9b66f8fbbc083e0b3a788ab63ee52?s=128&d=identicon&r=PG", "display_name": "soroushjp", "link": "https://stackoverflow.com/users/1366283/soroushjp"}, "reply_to_user": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1421925915, "post_id": 28087471, "comment_id": 44552118, "body": "Hahaha wish I had looked a little closer"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1421925817, "creation_date": 1421925817, "answer_id": 28087547, "question_id": 28087471, "link": "https://stackoverflow.com/questions/28087471/what-is-the-significance-of-gos-time-formatlayout-string-reference-time/28087547#28087547", "title": "What is the significance of Go&#39;s time.Format(layout string) reference time?", "body": "<p>In American date format, it's <code>Mon, 1/2 03:04:05 PM 2006 -0700</code>.</p>\n\n<p>1, 2, 3, 4, 5, 6, 7.</p>\n"}, {"tags": [], "owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "is_accepted": true, "score": 18, "last_activity_date": 1598259837, "last_edit_date": 1598259837, "creation_date": 1421925907, "answer_id": 28087574, "question_id": 28087471, "link": "https://stackoverflow.com/questions/28087471/what-is-the-significance-of-gos-time-formatlayout-string-reference-time/28087574#28087574", "title": "What is the significance of Go&#39;s time.Format(layout string) reference time?", "body": "<p>Each part of the date is used as an index:</p>\n<pre><code>Jan        -&gt; 1      -&gt; Month\n2          -&gt; 2      -&gt; Day-of-Month\n15 = 3PM   -&gt; 15/3   -&gt; hour\n04         -&gt; 4      -&gt; minute\n05         -&gt; 5      -&gt; second\n2006       -&gt; 6      -&gt; year\n-0700      -&gt; 7      -&gt; time-zone\n</code></pre>\n<p>So according to the doc:</p>\n<blockquote>\n<p>Since MST is GMT-0700, the reference time can be thought of as\n01/02 03:04:05PM '06 -0700</p>\n</blockquote>\n<p>This makes it easy for the <code>time.Format</code> method to parse human-readable date format specifications that are visually identical to the desired result.</p>\n<p>Compare this to for example the <code>strftime</code> C function that uses hard-to-remember format strings such as <code>&quot;%a, %d %b %y %T %z&quot;</code> which represents a RFC 822-compliant date format.</p>\n<p>The Go equivalent is: <code>&quot;Mon, 02 Jan 06 15:04 MST&quot;</code>.</p>\n<p>The <code>time.Format</code> will tokenize this string and analyze each word.</p>\n<ul>\n<li>Mon is recognized litteraly as monday so this is the week day's name</li>\n<li>the comma is left untouched</li>\n<li>02 is recognized as the integer value 2, representing a day-of-month in the index</li>\n<li>Jan is the known english abbreviation for the january month, so this is used for the month part</li>\n<li>06 is 6 so this the year part</li>\n<li>15 is equivalent to 3 and represent the hour</li>\n<li>the <code>':'</code> character is left untouched</li>\n<li>04 is 4, therefore the minute</li>\n<li>MST is interpreted litteraly</li>\n</ul>\n<p>See <a href=\"https://github.com/golang/go/blob/go1.15/src/time/format.go#L151\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/go1.15/src/time/format.go#L151</a> for the exact algorithm.</p>\n"}], "owner": {"reputation": 714, "user_id": 1366283, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/93f9b66f8fbbc083e0b3a788ab63ee52?s=128&d=identicon&r=PG", "display_name": "soroushjp", "link": "https://stackoverflow.com/users/1366283/soroushjp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1554, "favorite_count": 3, "accepted_answer_id": 28087574, "answer_count": 2, "score": 8, "last_activity_date": 1598259837, "creation_date": 1421925534, "question_id": 28087471, "link": "https://stackoverflow.com/questions/28087471/what-is-the-significance-of-gos-time-formatlayout-string-reference-time", "title": "What is the significance of Go&#39;s time.Format(layout string) reference time?", "body": "<p>What is the significance of Go's time.Format(layout string) reference time, ie:</p>\n\n<p><em>Mon Jan 2 15:04:05 -0700 MST 2006</em></p>\n\n<p>This specific time couldn't have been chosen completely randomly, right?</p>\n\n<p>Source: <a href=\"http://golang.org/pkg/time/#Time.Format\" rel=\"noreferrer\">http://golang.org/pkg/time/#Time.Format</a></p>\n"}, {"tags": ["http", "github", "oauth", "go"], "answers": [{"tags": [], "owner": {"reputation": 414, "user_id": 4436671, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000195935196/picture?type=large", "display_name": "FrAn", "link": "https://stackoverflow.com/users/4436671/fran"}, "is_accepted": false, "score": 0, "last_activity_date": 1421916030, "creation_date": 1421916030, "answer_id": 28084332, "question_id": 28083629, "link": "https://stackoverflow.com/questions/28083629/unable-to-complete-oauth-web-workflow-for-github-in-golang/28084332#28084332", "title": "Unable to complete oauth web workflow for GitHub in golang", "body": "<p>You should double check your 'client_secret' and 'client_id' (must be right because you get the code) if it is correct, apparently Github returns HTTP status code 404 if it is wrong.</p>\n"}, {"tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": true, "score": 3, "last_activity_date": 1421918888, "creation_date": 1421918888, "answer_id": 28085169, "question_id": 28083629, "link": "https://stackoverflow.com/questions/28083629/unable-to-complete-oauth-web-workflow-for-github-in-golang/28085169#28085169", "title": "Unable to complete oauth web workflow for GitHub in golang", "body": "<p>You are generating empty JSON objects. Your struct fields should start in capitals for the JSON encoder to be able to encode them.</p>\n\n<pre><code>type goodparam struct {\n    Code         string `json:\"code\"`\n    ClientId     string `json:\"client_id\"`\n    ClientSecret string `json:\"client_secret\"`\n}\n</code></pre>\n\n<p>See <a href=\"http://play.golang.org/p/MwTj2zsrlS\" rel=\"nofollow\">this in action</a>.</p>\n"}], "owner": {"reputation": 180, "user_id": 2947248, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0542054052bc2b70ab7680077bb7afce?s=128&d=identicon&r=PG", "display_name": "pravj", "link": "https://stackoverflow.com/users/2947248/pravj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 1, "accepted_answer_id": 28085169, "answer_count": 2, "score": 0, "last_activity_date": 1421918888, "creation_date": 1421912994, "question_id": 28083629, "link": "https://stackoverflow.com/questions/28083629/unable-to-complete-oauth-web-workflow-for-github-in-golang", "title": "Unable to complete oauth web workflow for GitHub in golang", "body": "<p>I'm trying to implement oauth-workflow for GitHub in golang and using <a href=\"https://github.com/franela/goreq\" rel=\"nofollow\">https://github.com/franela/goreq</a> to perform http(s) requests.</p>\n\n<p>There is a section in which GitHub returns a <code>code</code> and you have to make a <code>POST</code> request to <a href=\"https://github.com/login/oauth/access_token\" rel=\"nofollow\">https://github.com/login/oauth/access_token</a> with <code>code</code>, <code>client_id</code> and <code>client_secret</code>.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"github.com/franela/goreq\"\n\ntype param struct {\n  code string\n  client_id string\n  client_secret string\n}\n\nfunc main() {\n  params := param {code: \"XX\", client_id:\"XX\", client_secret: \"XX\"}\n  req := goreq.Request{\n    Method : \"POST\",\n    Uri : \"https://github.com/login/oauth/access_token\",\n    Body : params,\n  }\n  req.AddHeader(\"Content-Type\", \"application/json\")\n  req.AddHeader(\"Accept\", \"application/json\")\n  res, _ := req.Do()\n  fmt.Println(res.Body.ToString())\n}\n</code></pre>\n\n<p>It is giving <code>404</code> with <code>{\"error\":\"Not Found\"}</code> message always.\nWhile using Python, I'm getting the correct results with the same input data.</p>\n"}, {"tags": ["regex", "go"], "answers": [{"comments": [{"owner": {"reputation": 285, "user_id": 3373877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/532526780ffab7d05fae3a14045c3f8d?s=128&d=identicon&r=PG&f=1", "display_name": "user3373877", "link": "https://stackoverflow.com/users/3373877/user3373877"}, "edited": false, "score": 0, "creation_date": 1421910855, "post_id": 28083071, "comment_id": 44544208, "body": "the output should be like this:{{range $prj:=.prj}}   &lt;Row ss:AutoFitHeight=&quot;0&quot; ss:Height=&quot;45.449999999999996&quot;&gt;     &lt;Cell ss:StyleID=&quot;s72&quot;/&gt;     &lt;Cell ss:StyleID=&quot;s70&quot;&gt;&lt;Data ss:Type=&quot;String&quot;&gt;{{$prj.PrjName}}&lt;/Data&gt;&lt;/Cell&gt;     &lt;Cell ss:StyleID=&quot;s70&quot;&gt;&lt;Data ss:Type=&quot;String&quot;&gt;{{$prj.ConstrDept}}&lt;/Data&gt;&lt;/Cell&gt;     &lt;Cell ss:StyleID=&quot;s71&quot;&gt;&lt;Data ss:Type=&quot;String&quot;&gt;{{$prj.Assumer}}&lt;/Data&gt;&lt;/Cell&gt;&lt;/Row&gt;.......&zwnj;&#8203;{{end}}"}, {"owner": {"reputation": 285, "user_id": 3373877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/532526780ffab7d05fae3a14045c3f8d?s=128&d=identicon&r=PG&f=1", "display_name": "user3373877", "link": "https://stackoverflow.com/users/3373877/user3373877"}, "edited": false, "score": 0, "creation_date": 1421912164, "post_id": 28083071, "comment_id": 44544770, "body": "only want to get the &quot; {{range $prj:=.prj}}&quot; and &quot;{{end}}&quot; ,and throw the tag &quot;&lt;Row&gt;&quot; around them. others keep still."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 285, "user_id": 3373877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/532526780ffab7d05fae3a14045c3f8d?s=128&d=identicon&r=PG&f=1", "display_name": "user3373877", "link": "https://stackoverflow.com/users/3373877/user3373877"}, "edited": false, "score": 0, "creation_date": 1421912671, "post_id": 28083071, "comment_id": 44544993, "body": "@user3373877 ok, that is a task for xml parsing then."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 285, "user_id": 3373877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/532526780ffab7d05fae3a14045c3f8d?s=128&d=identicon&r=PG&f=1", "display_name": "user3373877", "link": "https://stackoverflow.com/users/3373877/user3373877"}, "edited": false, "score": 0, "creation_date": 1421934487, "post_id": 28083071, "comment_id": 44557201, "body": "@user3373877 I have added an xml Unmarshal example"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1421934454, "last_edit_date": 1495542035, "creation_date": 1421910559, "answer_id": 28083071, "question_id": 28082879, "link": "https://stackoverflow.com/questions/28082879/ommit-the-tag-from-the-text-using-golang/28083071#28083071", "title": "Ommit the tag from the text using golang?", "body": "<p>You could use (if we discard nested <code>{{}}</code>) a regexp like <code>{{[^}]*?}}</code> with <a href=\"http://golang.org/pkg/regexp/#Regexp.FindAllString\" rel=\"nofollow noreferrer\"><code>Regexp.FindAllString()</code></a>.<br>\n<a href=\"http://play.golang.org/p/bNP26trJqJ\" rel=\"nofollow noreferrer\">This example</a> would extract the expected results:</p>\n\n<pre><code>re := regexp.MustCompile(\"{{[^}]*?}}\")\nres := re.FindAllString(input, -1)\nfor _, s := range res {\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{{range $prj:=.prj}}\n{{$prj.PrjName}}\n{{$prj.ConstrDept}}\n{{$prj.Assumer}}\n...\n</code></pre>\n\n<p>But if the data depends on the context of the structure, then a simple regexp is ill-suited for the task (obligatory reference to \"<a href=\"https://stackoverflow.com/q/1732348/6309\">The Center cannot Hold</a>\").  </p>\n\n<p>A xml Marshall or Decoder would be better: <a href=\"http://golang.org/pkg/encoding/xml/\" rel=\"nofollow noreferrer\"><code>pkg/encoding/xml/</code></a>, using techniques like \"<a href=\"https://stackoverflow.com/a/20600762/6309\">Parse both XML element value and attributes for groups</a>\"</p>\n\n<p>See <a href=\"http://play.golang.org/p/87bAtRbGpV\" rel=\"nofollow noreferrer\">this example</a>:</p>\n\n<pre><code>type Data struct {\n    Type  string `xml:\"Type,attr\"`\n    Value string `xml:\",chardata\"`\n}\ntype Cell struct {\n    StyleID string `xml:\"StyleID,attr\"`\n    Data    Data\n}\ntype Row struct {\n    Afh    string `xml:\"AutoFitHeight,attr\"`\n    Height string `xml:\"Height,attr\"`\n    Cells  []Cell `xml:\"Cell\"`\n}\ntype Column struct{}\ntype Table struct {\n    Rows []Row `xml:\"Row\"`\n}\ntype Worksheet struct {\n    Table Table `xml:\"Table\"`\n}\nw := &amp;Worksheet{}\nerr := xml.Unmarshal([]byte(input), &amp;w)\nif err != nil {\n    fmt.Printf(\"error: %v\", err)\n    return\n}\nfmt.Printf(\"%+v\\n\", w)\n</code></pre>\n\n<p>That will extract all cells, and you can filter the ones that include the Data you want (one with <code>{{}}</code>)</p>\n\n<pre><code>&amp;{Table:\n    { Rows:[\n    {Afh:0 Height: \n    Cells:[\n        {StyleID:s63 Data:{Type:String Value:This is a title of the sheet!}}\n    ]} \n    {Afh:0 Height: \n    Cells:[\n        {StyleID:s69 Data:{Type:String Value:{{range $prj:=.prj}}}} \n        {StyleID:s70 Data:{Type: Value:}}\n    ]} \n    {Afh:0 Height:45.449999999999996 \n    Cells:[\n        {StyleID:s72 Data:{Type: Value:}} \n        {StyleID:s70 Data:{Type:String Value:{{$prj.PrjName}}}} \n        {StyleID:s70 Data:{Type:String Value:{{$prj.ConstrDept}}}} \n        {StyleID:s71 Data:{Type:String Value:{{$prj.Assumer}}}}\n    ]} \n    {Afh:0 Height: \n    Cells:[\n        {StyleID:s73 Data:{Type:String Value:{{end}}}}\n    ]}\n]}}\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 3373877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/532526780ffab7d05fae3a14045c3f8d?s=128&d=identicon&r=PG&f=1", "display_name": "user3373877", "link": "https://stackoverflow.com/users/3373877/user3373877"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1421934454, "creation_date": 1421909693, "last_edit_date": 1421910780, "question_id": 28082879, "link": "https://stackoverflow.com/questions/28082879/ommit-the-tag-from-the-text-using-golang", "title": "Ommit the tag from the text using golang?", "body": "<p>I want to do some template by using golang,and want to ommit some tags from a xml like xlsx.  the xml source like this: </p>\n\n<pre><code>  input := `&lt;?xml version=\"1.0\"?&gt;\n&lt;?mso-application progid=\"Excel.Sheet\"?&gt; \n  &lt;Worksheet ss:Name=\"sheet1\"&gt;\n  &lt;Names&gt;\n   &lt;NamedRange ss:Name=\"_FilterDatabase\" ss:RefersTo=\"=sheet!R3C1:R3C13\"\n    ss:Hidden=\"1\"/&gt;\n  &lt;/Names&gt;\n  &lt;Table ss:ExpandedColumnCount=\"15\" ss:ExpandedRowCount=\"7\" x:FullColumns=\"1\"\n   x:FullRows=\"1\" ss:DefaultColumnWidth=\"52.8\" ss:DefaultRowHeight=\"15.45\"&gt;\n   &lt;Column ss:AutoFitWidth=\"0\" ss:Width=\"37.200000000000003\"/&gt;\n   &lt;Column ss:AutoFitWidth=\"0\" ss:Width=\"67.2\"/&gt;\n   &lt;Column ss:AutoFitWidth=\"0\" ss:Width=\"75.600000000000009\"/&gt;\n   &lt;Column ss:AutoFitWidth=\"0\" ss:Width=\"71.400000000000006\"/&gt;  \n\n   &lt;Row ss:AutoFitHeight=\"0\"&gt;\n    &lt;Cell ss:MergeAcross=\"12\" ss:MergeDown=\"1\" ss:StyleID=\"s63\"&gt;&lt;Data\n      ss:Type=\"String\"&gt;This is a title of the sheet!&lt;/Data&gt;&lt;/Cell&gt;\n   &lt;/Row&gt;\n\n   &lt;Row ss:AutoFitHeight=\"0\"&gt;\n    &lt;Cell ss:StyleID=\"s69\"&gt;&lt;Data ss:Type=\"String\"&gt;{{range $prj:=.prj}}&lt;/Data&gt;&lt;/Cell&gt;\n    &lt;Cell ss:StyleID=\"s70\"/&gt;\n    &lt;Cell ss:StyleID=\"s70\"/&gt;\n    &lt;Cell ss:StyleID=\"s70\"/&gt;\n   &lt;/Row&gt;\n   &lt;Row ss:AutoFitHeight=\"0\" ss:Height=\"45.449999999999996\"&gt;\n    &lt;Cell ss:StyleID=\"s72\"/&gt;\n    &lt;Cell ss:StyleID=\"s70\"&gt;&lt;Data ss:Type=\"String\"&gt;{{$prj.PrjName}}&lt;/Data&gt;&lt;/Cell&gt;\n    &lt;Cell ss:StyleID=\"s70\"&gt;&lt;Data ss:Type=\"String\"&gt;{{$prj.ConstrDept}}&lt;/Data&gt;&lt;/Cell&gt;\n    &lt;Cell ss:StyleID=\"s71\"&gt;&lt;Data ss:Type=\"String\"&gt;{{$prj.Assumer}}&lt;/Data&gt;&lt;/Cell&gt;\n    &lt;Cell ss:StyleID=\"s71\"&gt;&lt;Data ss:Type=\"String\"&gt;{{$prj.ReplyNo}}&lt;/Data&gt;&lt;/Cell&gt;\n    &lt;Cell ss:StyleID=\"s71\"&gt;&lt;Data ss:Type=\"String\"&gt;{{$prj.AnPingNo}}&lt;/Data&gt;&lt;/Cell&gt;   \n\n   &lt;/Row&gt;\n   &lt;Row ss:AutoFitHeight=\"0\"&gt;\n    &lt;Cell ss:StyleID=\"s73\"&gt;&lt;Data ss:Type=\"String\"&gt;{{end}}&lt;/Data&gt;&lt;/Cell&gt;\n   &lt;/Row&gt;\n  &lt;/Table&gt; \n &lt;/Worksheet&gt;\n&lt;/Workbook&gt;`\n</code></pre>\n\n<p>and i want to get as following:</p>\n\n<ol>\n<li><p>\n    {{range $prj:=.prj}}\n    \n    \n    \n   </p>\n\n<p>in this row,i only want to get the \"<code>{{range $prj:=.prj}}</code>\",and ommit the tag around the \"<code>&lt;Row&gt;</code>\"</p></li>\n</ol>\n\n<p>2.</p>\n\n<pre><code>   &lt;Row ss:AutoFitHeight=\"0\"&gt;\n    &lt;Cell ss:StyleID=\"s73\"&gt;&lt;Data ss:Type=\"String\"&gt;{{end}}&lt;/Data&gt;&lt;/Cell&gt;\n   &lt;/Row&gt;\n</code></pre>\n\n<p>in the row, i only want to get the \"<code>{{end}}</code>\",and ommit the tag around the \"<code>&lt;Row&gt;</code>\"</p>\n\n<ol start=\"3\">\n<li>any other tag ,i want to remain.  how to do?</li>\n</ol>\n"}, {"tags": ["go", "mutex"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1421905249, "post_id": 28081740, "comment_id": 44542321, "body": "Send the process a SIGQUIT to find out where the goroutines are blocked. That might lead to some insight about what the issue is."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1421906397, "post_id": 28081740, "comment_id": 44542644, "body": "I suggest running your code with <code>go race</code> to see what&#39;s going on."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1428184564, "post_id": 28081740, "comment_id": 47069294, "body": "It&#39;s never safe to acquire the same read lock multiple times in the same thread of execution."}], "answers": [{"tags": [], "owner": {"reputation": 227, "user_id": 2662982, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/71e0b6a6f2b7ffd24505733ced4bc705?s=128&d=identicon&r=PG", "display_name": "user2662982", "link": "https://stackoverflow.com/users/2662982/user2662982"}, "is_accepted": false, "score": 2, "last_activity_date": 1421908066, "last_edit_date": 1421908066, "creation_date": 1421907657, "answer_id": 28082415, "question_id": 28081740, "link": "https://stackoverflow.com/questions/28081740/golang-sync-rwlock-appears-to-create-deadlock/28082415#28082415", "title": "golang sync.RWLock appears to create deadlock?", "body": "<p>After thinking about the problem with the back to back RLock, it makes sense.</p>\n\n<p>What I'm not logging here is the Locks, and what is clear now is a condition is occurring where a Lock is getting in between the back to back RLocks.</p>\n\n<p>Basically the lock is queued.</p>\n\n<pre><code>(Thread 1) GetString -&gt; Request Read Lock\n(Thread 1) GetString -&gt; Got Read Lock\n(Thread 2) Set -&gt; Request Write Lock (Blocked, queued.)\n(Thread 1) Get -&gt; Request Read Lock (Blocked, queued.)\n</code></pre>\n\n<p>From <a href=\"http://golang.org/src/sync/rwmutex.go?s=862:888#L19\" rel=\"nofollow\">http://golang.org/src/sync/rwmutex.go?s=862:888#L19</a></p>\n\n<blockquote>\n<pre><code>34        if atomic.AddInt32(&amp;rw.readerCount, 1) &lt; 0 {\n35            // A writer is pending, wait for it.\n36            runtime_Semacquire(&amp;rw.readerSem)\n37        }\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 227, "user_id": 2662982, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/71e0b6a6f2b7ffd24505733ced4bc705?s=128&d=identicon&r=PG", "display_name": "user2662982", "link": "https://stackoverflow.com/users/2662982/user2662982"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1426, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1421908066, "creation_date": 1421904020, "question_id": 28081740, "link": "https://stackoverflow.com/questions/28081740/golang-sync-rwlock-appears-to-create-deadlock", "title": "golang sync.RWLock appears to create deadlock?", "body": "<p>I've been using an RWLock for reads on a mysql database, but it appears that intermittently the following code locks the programs as it waits for a unlock?</p>\n\n<pre><code>// Returns string value from key in table specified, third parameter should be set to false if it shouldn't be case senstive.\nfunc (self *DBStore) GetString(table string, key string, vargs...interface{}) (output string) {\n\n    defer func() { fmt.Println(\"GETSTRING Freeing Mutex!\") }()\n    self.mutex.RLock()\n    fmt.Println(\"GETSTRING Got Mutex!\")\n    defer self.mutex.RUnlock()\n\n    self.Get(table, key, &amp;output, vargs...)\n    return\n\n}\n\n// Retreive a value at key in table specified.\nfunc (self *DBStore) Get(table string, key string, output interface{}, vargs...interface{}) (found bool) {\n\n    defer func() { fmt.Println(\"GET Freeing Mutex!\") }()\n    fmt.Println(\"Requesting Mutex\")\n    self.mutex.RLock()\n    fmt.Println(\"GET Got Mutex!\")\n    defer self.mutex.RUnlock()\n</code></pre>\n\n<p>Now with the above, I can see that I really don't need to perform the RLock here and I can simply enough just remove it, but I was under the impression read locks shouldn't interfere with another read lock. Also it seems to be intermittent, and it usually takes me a few times of running the same thing before it reoccurs.</p>\n\n<p>Output of program is:</p>\n\n<pre><code>Requesting Mutex\nGET Got Mutex!\nGET Freeing Mutex!\nGETSTRING Got Mutex!\nRequesting Mutex\n</code></pre>\n\n<p>and then it just sits forever, locked. What am I missing here?</p>\n\n<p>Any info would be appreciated!</p>\n\n<p>go version go1.4 darwin/amd64</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 698, "user_id": 210827, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/da0d68721d1a1c02dcebebd6a5c35887?s=128&d=identicon&r=PG", "display_name": "getWeberForStackExchange", "link": "https://stackoverflow.com/users/210827/getweberforstackexchange"}, "edited": false, "score": 10, "creation_date": 1439451637, "post_id": 28081554, "comment_id": 51869857, "body": "Unless you have <code>*_test.go</code> in your folder. Then you need to (1) <code>shopt -s ext glob</code> and (2) <code>go run !(*_test).go</code>."}, {"owner": {"reputation": 1674, "user_id": 1219971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8x885.jpg?s=128&g=1", "display_name": "dwp4ge", "link": "https://stackoverflow.com/users/1219971/dwp4ge"}, "edited": false, "score": 0, "creation_date": 1446696054, "post_id": 28081554, "comment_id": 54853940, "body": "and what about those using appengine?"}, {"owner": {"reputation": 707, "user_id": 2905274, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c9e3b6b5fbc86a188e28c92a3718eff9?s=128&d=identicon&r=PG&f=1", "display_name": "VinGarcia", "link": "https://stackoverflow.com/users/2905274/vingarcia"}, "edited": false, "score": 0, "creation_date": 1553706878, "post_id": 28081554, "comment_id": 97487930, "body": "I tried <code>go run .&#47;cmd&#47;myCmd&#47;...</code> and it worked for me. Maybe this is the correct way when there are <code>_test.go</code> files?"}, {"owner": {"reputation": 982, "user_id": 6554662, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154470556032446/picture?type=large", "display_name": "Andy", "link": "https://stackoverflow.com/users/6554662/andy"}, "edited": false, "score": 0, "creation_date": 1559634027, "post_id": 28081554, "comment_id": 99472339, "body": "<code>go run ..&#47;your_folder</code> from inside the working folder works for me"}, {"owner": {"reputation": 865, "user_id": 3220303, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f061937011d0ae7e3414e33128ddc170?s=128&d=identicon&r=PG&f=1", "display_name": "BarthesSimpson", "link": "https://stackoverflow.com/users/3220303/barthessimpson"}, "edited": false, "score": 3, "creation_date": 1563596360, "post_id": 28081554, "comment_id": 100761367, "body": "Just do <code>go run .</code>"}], "tags": [], "owner": {"reputation": 7466, "user_id": 288424, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cf91d37f026ddaccc28c9907b567ab13?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/288424/neil"}, "is_accepted": true, "score": 229, "last_activity_date": 1580168781, "last_edit_date": 1580168781, "creation_date": 1421902767, "answer_id": 28081554, "question_id": 28081486, "link": "https://stackoverflow.com/questions/28081486/how-can-i-go-run-a-project-with-multiple-files-in-the-main-package/28081554#28081554", "title": "How can I &quot;go run&quot; a project with multiple files in the main package?", "body": "<h1>Update 26th July 2019 (for go >=1.11)</h1>\n\n<pre><code>go run .\n</code></pre>\n\n<h1>Original answer</h1>\n\n<p>The code above actually works. The problem was I needed to run</p>\n\n<pre><code>go run *.go\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>go run main.go\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14727, "user_id": 1766230, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fb3eebee376e8d506503148d021a409a?s=128&d=identicon&r=PG", "display_name": "Luke", "link": "https://stackoverflow.com/users/1766230/luke"}, "edited": false, "score": 1, "creation_date": 1468817670, "post_id": 28082734, "comment_id": 64263875, "body": "Is there a workaround for running multiple go files with <code>run</code> using the Windows command prompt?"}, {"owner": {"reputation": 803, "user_id": 181364, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c967b96b560cb3a1eb79a38b088a5131?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/181364/chris"}, "edited": false, "score": 1, "creation_date": 1539156872, "post_id": 28082734, "comment_id": 92394628, "body": "Thanks! This helped me a ton. I kept wondering why I couldn&#39;t just run the code with just main.go since it was the same package but it kind of makes sense to me as to why they didn&#39;t allow for that."}, {"owner": {"reputation": 127, "user_id": 4288004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c71a13ea10117773c01ac54bd2ca2a57?s=128&d=identicon&r=PG&f=1", "display_name": "xuiqzy", "link": "https://stackoverflow.com/users/4288004/xuiqzy"}, "reply_to_user": {"reputation": 14727, "user_id": 1766230, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fb3eebee376e8d506503148d021a409a?s=128&d=identicon&r=PG", "display_name": "Luke", "link": "https://stackoverflow.com/users/1766230/luke"}, "edited": false, "score": 0, "creation_date": 1600015181, "post_id": 28082734, "comment_id": 112948225, "body": "@Luke just specify both files separated by a space."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 71, "last_activity_date": 1549624051, "last_edit_date": 1549624051, "creation_date": 1421909059, "answer_id": 28082734, "question_id": 28081486, "link": "https://stackoverflow.com/questions/28081486/how-can-i-go-run-a-project-with-multiple-files-in-the-main-package/28082734#28082734", "title": "How can I &quot;go run&quot; a project with multiple files in the main package?", "body": "<p>Update August 2018, with <a href=\"https://golang.org/doc/go1.11\" rel=\"noreferrer\">Go 1.11</a>, a <a href=\"https://golang.org/doc/go1.11#run\" rel=\"noreferrer\">section \"Run\"</a> states:</p>\n\n<blockquote>\n  <p>The <a href=\"https://golang.org/cmd/go/\" rel=\"noreferrer\"><code>go run</code></a> command now allows a single import path, a directory name or a pattern matching a single package.<br>\n  This allows <code>go run pkg</code> or <code>go run dir</code>, most importantly <code>go run .</code></p>\n</blockquote>\n\n<hr>\n\n<p>Original answer Jan. 2015</p>\n\n<p>As mentioned in \"<a href=\"https://stackoverflow.com/a/10872133/6309\">How to compile Go program consisting of multiple files?</a>\", <a href=\"https://golang.org/cmd/go/#hdr-Compile_and_run_Go_program\" rel=\"noreferrer\"><code>go run</code></a> expects a list of files, since it \"compiles and runs the <code>main</code> package comprising the named Go source files\".<br>\nSo you certainly can split your <code>main</code> package in several files with <code>go run</code>.</p>\n\n<p>That differs from <a href=\"https://golang.org/cmd/go/#hdr-Compile_packages_and_dependencies\" rel=\"noreferrer\"><code>go build/go install</code></a> which expect package names (and not go filenames).<br>\nA simple <code>go build</code> would produce an executable named after the parent folder.</p>\n\n<p>Note that, as <a href=\"http://osdir.com/ml/go-language-discuss/2013-01/msg03653.html\" rel=\"noreferrer\">illustrated by this thread</a>, a <code>go run *.go</code> wouldn't work in a Windows CMD session, since the <a href=\"http://blogs.msdn.com/b/dancre/archive/2005/05/14/417547.aspx\" rel=\"noreferrer\">shell doesn't do wildcard expansion</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 5340, "user_id": 1059446, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2993872284fcac27003cf02b201ea0c3?s=128&d=identicon&r=PG", "display_name": "Aleksandr Kravets", "link": "https://stackoverflow.com/users/1059446/aleksandr-kravets"}, "edited": false, "score": 0, "creation_date": 1531929260, "post_id": 47563434, "comment_id": 89783599, "body": "I would suggest MinGW for that, but the approach is right if you ask me. I doubt that anyone could be really emotionally attached to <code>cmd.exe</code>"}], "tags": [], "owner": {"reputation": 117, "user_id": 1443898, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d046c88b97ff72a97fd60b100183d07f?s=128&d=identicon&r=PG", "display_name": "Alex Dvoretskiy", "link": "https://stackoverflow.com/users/1443898/alex-dvoretskiy"}, "is_accepted": false, "score": 0, "last_activity_date": 1511999913, "last_edit_date": 1511999913, "creation_date": 1511997243, "answer_id": 47563434, "question_id": 28081486, "link": "https://stackoverflow.com/questions/28081486/how-can-i-go-run-a-project-with-multiple-files-in-the-main-package/47563434#47563434", "title": "How can I &quot;go run&quot; a project with multiple files in the main package?", "body": "<p>For Windows install Cygwin and use it instead of command prompt. \"go run *.go\" will work then.</p>\n"}, {"comments": [{"owner": {"reputation": 848, "user_id": 2194284, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/iJLEH.jpg?s=128&g=1", "display_name": "KTM", "link": "https://stackoverflow.com/users/2194284/ktm"}, "edited": false, "score": 0, "creation_date": 1595921205, "post_id": 51856079, "comment_id": 111632980, "body": "Yes thats correct. In windows i had to run <code>go run .</code>"}], "tags": [], "owner": {"reputation": 155, "user_id": 4295424, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HWX3cnEN5hQ/AAAAAAAAAAI/AAAAAAAAAGM/9_Xom6ReDb0/photo.jpg?sz=128", "display_name": "Karl Penzhorn", "link": "https://stackoverflow.com/users/4295424/karl-penzhorn"}, "is_accepted": false, "score": 5, "last_activity_date": 1534324874, "creation_date": 1534324874, "answer_id": 51856079, "question_id": 28081486, "link": "https://stackoverflow.com/questions/28081486/how-can-i-go-run-a-project-with-multiple-files-in-the-main-package/51856079#51856079", "title": "How can I &quot;go run&quot; a project with multiple files in the main package?", "body": "<p>As mentioned, you can say <code>go run *.go</code> but for Windows you can just list the script files (since *.go won't work) - <code>go run main.go other.go third.go</code></p>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 8807669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a0c06065758f0a6808250af10bc323?s=128&d=identicon&r=PG&f=1", "display_name": "Bharath Kuppala", "link": "https://stackoverflow.com/users/8807669/bharath-kuppala"}, "is_accepted": false, "score": 0, "last_activity_date": 1538988945, "creation_date": 1538988945, "answer_id": 52698664, "question_id": 28081486, "link": "https://stackoverflow.com/questions/28081486/how-can-i-go-run-a-project-with-multiple-files-in-the-main-package/52698664#52698664", "title": "How can I &quot;go run&quot; a project with multiple files in the main package?", "body": "<p>If you are trying to run multiple files on localhost using gorilla mux in go as per latest version(1.11). Try using any of the following 2 commands.</p>\n\n<blockquote>\n  <ol>\n  <li><p>go install &amp;&amp; FolderName  -port 8081 .</p></li>\n  <li><p>go build &amp;&amp; ./FolderName  -port 8081.</p></li>\n  </ol>\n</blockquote>\n\n<p>Make sure that you are in the source folder ie go/src/FolderName before executing the command in the Terminal.</p>\n"}, {"tags": [], "owner": {"reputation": 7639, "user_id": 673282, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/19b35416cb9ff0ed4f6573afaabd00a5?s=128&d=identicon&r=PG", "display_name": "chim", "link": "https://stackoverflow.com/users/673282/chim"}, "is_accepted": false, "score": 10, "last_activity_date": 1564137529, "creation_date": 1564137529, "answer_id": 57218312, "question_id": 28081486, "link": "https://stackoverflow.com/questions/28081486/how-can-i-go-run-a-project-with-multiple-files-in-the-main-package/57218312#57218312", "title": "How can I &quot;go run&quot; a project with multiple files in the main package?", "body": "<p>In my opinion, the best answer to this question is hidden in the comments to the top answer.</p>\n\n<p>Just run this:</p>\n\n<pre><code>go run .\n</code></pre>\n\n<p>This will run all the files in main package, but will <strong>not</strong> give an error message like</p>\n\n<pre><code>go run: cannot run *_test.go files (main_test.go)\n</code></pre>\n\n<p>Kudos to @BarthesSimpson </p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 12420313, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCr465r9KMNxu_XCkBzYD8K6Jk9mRpVTRX2MT7t=k-s128", "display_name": "Nishant Raj", "link": "https://stackoverflow.com/users/12420313/nishant-raj"}, "is_accepted": false, "score": 0, "last_activity_date": 1598280395, "creation_date": 1598280395, "answer_id": 63563327, "question_id": 28081486, "link": "https://stackoverflow.com/questions/28081486/how-can-i-go-run-a-project-with-multiple-files-in-the-main-package/63563327#63563327", "title": "How can I &quot;go run&quot; a project with multiple files in the main package?", "body": "<p>The first method to do so will be to run</p>\n<pre><code>go run *.go\n</code></pre>\n<p>The another method is to generate an exe file</p>\n<pre><code>go build\n</code></pre>\n<p>Then run that .exe file</p>\n<pre><code>./filename.exe\n</code></pre>\n"}], "owner": {"reputation": 7466, "user_id": 288424, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cf91d37f026ddaccc28c9907b567ab13?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/288424/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92726, "favorite_count": 33, "accepted_answer_id": 28081554, "answer_count": 7, "score": 172, "last_activity_date": 1598280395, "creation_date": 1421902270, "last_edit_date": 1531247568, "question_id": 28081486, "link": "https://stackoverflow.com/questions/28081486/how-can-i-go-run-a-project-with-multiple-files-in-the-main-package", "title": "How can I &quot;go run&quot; a project with multiple files in the main package?", "body": "<p>I currently have a single file in my main package called <code>main.go</code>. How do I split the contents of <code>main.go</code> into multiple files without creating a separate package because the code isn't reusable. </p>\n\n<p>I want a directory structure like this:</p>\n\n<pre><code>$ ls foo\n\nmain.go\nbar.go\n</code></pre>\n\n<p><code>bar.go</code></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc Bar() {\n    fmt.Println(\"Bar\")\n}\n</code></pre>\n\n<p>Then in <code>main.go</code></p>\n\n<pre><code>package main\n\nfunc main() {\n    Bar()\n}\n</code></pre>\n\n<p>But <code>go run main.go</code> gives me:</p>\n\n<pre><code># command-line-arguments\n./main.go:4:2: undefined: Bar\n</code></pre>\n"}, {"tags": ["go", "integration-testing"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1421911776, "post_id": 28081348, "comment_id": 44544605, "body": "Why do you want to dump the counters periodically? BTW: the <code>-var</code> flag is used to change the name of the counter which is useful only in special circumstances."}, {"owner": {"reputation": 259, "user_id": 2008119, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7478fedd2a9fbe87c53a4562524f215c?s=128&d=identicon&r=PG", "display_name": "kerlyn", "link": "https://stackoverflow.com/users/2008119/kerlyn"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1421942575, "post_id": 28081348, "comment_id": 44562787, "body": "I want to profile my code running in a pre-production environment.  As I expect different paths to be taken at different times, I want to dump the counters periodically.  I think you will find that &quot;go tool cover -mode=count -var=fooCtr foo.go &gt; foo_i.go&quot; provides you with an instrumented version of foo.go.  What &quot;special circumstances&quot; did you have in mind?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1421943700, "post_id": 28081348, "comment_id": 44563539, "body": "No, thats not how it works. <code>cover</code> is used to measure code coverage, it is completely unsuitable for profiling which is done by cmd <code>pprof</code> and package <code>runtime&#47;pprof</code>. The &quot;special circumstance&quot; is when you want to instrument code which contains variables named  &quot;GoCover&quot; which is unlikely."}, {"owner": {"reputation": 259, "user_id": 2008119, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7478fedd2a9fbe87c53a4562524f215c?s=128&d=identicon&r=PG", "display_name": "kerlyn", "link": "https://stackoverflow.com/users/2008119/kerlyn"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1421956529, "post_id": 28081348, "comment_id": 44570876, "body": "From go tool cover -help: &quot;Finally, to generate modified source code with coverage annotations (what go test -cover does): \tgo tool cover -mode=set -var=CoverageVariableName program.go&quot;  I&#39;m using the term &quot;profile&quot; informally.  The point of a unit test is to provide 100% coverage.  My app may only be using 10% of a given library.  I want to know which 10%.  Coverage is the right tool for what I need."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1422003987, "post_id": 28081348, "comment_id": 44587109, "body": "Instrumenting a third-party library to see which code path are used is a legitimate use case for the cover tool. But it is unlikely that you will have a <i>need</i> to use the <code>-var</code> flag, probably the default would be okay. Second: This use case does not answer my original question: Why do you want to dump the counters periodically? What would a conclusion like &quot;The third-party library L used the following source code blocks B1 in second 12 of the execution of my program while it used a different set of blocks B2 during second 27.&quot;? What has this to do with 100% code coverage in unit testing?"}, {"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "edited": false, "score": 1, "creation_date": 1442635938, "post_id": 28081348, "comment_id": 53174326, "body": "Integration testing is all about getting the components wired up together and seeing common use cases fulfilled. It&#39;s not for verifying edge cases or tracking comprehensive code coverage."}, {"owner": {"reputation": 1997, "user_id": 1776889, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/caAzY.jpg?s=128&g=1", "display_name": "dgil", "link": "https://stackoverflow.com/users/1776889/dgil"}, "edited": false, "score": 0, "creation_date": 1464082980, "post_id": 28081348, "comment_id": 91265431, "body": "I&#39;ve noticed some Go projects are using <a href=\"https://coveralls.io/\" rel=\"nofollow noreferrer\">coveralls.io</a> to show the coverage of their tests. The projects below have the coveralls&#39; coverage badge: * <a href=\"https://github.com/kubernetes/kubernetes\" rel=\"nofollow noreferrer\">github.com/kubernetes/kubernetes</a> * <a href=\"https://github.com/getlantern/lantern\" rel=\"nofollow noreferrer\">github.com/getlantern/lantern</a> * <a href=\"https://github.com/google/go-github\" rel=\"nofollow noreferrer\">github.com/google/go-github</a> It also allows to check coverage by file too. Check out this [lantern&#39;s commit][2] to see how it does it. It&#39;s free for open source projects. You can check out <a href=\"https://coveralls.io/\" rel=\"nofollow noreferrer\">their page</a> for pricing. I know this is a specific solution but I couldn&#39;t find anything better to get Go tests coverage... ["}], "answers": [{"tags": [], "owner": {"reputation": 1359, "user_id": 113316, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4772c3b95b4065144bb7f26dd24eae37?s=128&d=identicon&r=PG", "display_name": "rajeshnair", "link": "https://stackoverflow.com/users/113316/rajeshnair"}, "is_accepted": true, "score": 7, "last_activity_date": 1555015431, "creation_date": 1555015431, "answer_id": 55640874, "question_id": 28081348, "link": "https://stackoverflow.com/questions/28081348/golang-code-coverage-in-integration-tests/55640874#55640874", "title": "golang code coverage in integration tests?", "body": "<p>We use this to collect code coverage from our various tests to get a single code coverage number across the tests and to see the uncovered code paths\n* Module tests\n* Integration tests\n* UI tests\n* API tests\n* unit tests</p>\n\n<p>The way to achieve this is </p>\n\n<ul>\n<li><p>Build an instrumented binary (app.debug) with coverage enables. The below command generates an app.debug with coverage instrumentation enabled</p>\n\n<pre><code>$ go test -c -covermode=atomic -coverpkg=\"pkg/path/...\" -o app.debug\n</code></pre></li>\n<li><p>Use this app.debug instead of your app in the tests and run tests against it. Ours is an HTTP server but this should work for most applications. Each test generates a seperate cov file which later needs to be merged.</p>\n\n<pre><code>$ ./app.debug -test.coverprofile=functest.cov -- app.params\n</code></pre></li>\n<li><p>Merge all the test cov files to get a single cov file .For this, you can use <a href=\"https://github.com/wadey/gocovmerge\" rel=\"noreferrer\">gocovmerge</a></p>\n\n<pre><code>$ find $COVERAGE_DIR -name *.cov | xargs gocovmerge &gt; final.cov\n</code></pre></li>\n</ul>\n\n<p>And you have finally a coverage file which gives you complete picture of code coverage from all sorts of coverage. </p>\n"}], "owner": {"reputation": 259, "user_id": 2008119, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7478fedd2a9fbe87c53a4562524f215c?s=128&d=identicon&r=PG", "display_name": "kerlyn", "link": "https://stackoverflow.com/users/2008119/kerlyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3371, "favorite_count": 4, "accepted_answer_id": 55640874, "answer_count": 1, "score": 13, "last_activity_date": 1555015431, "creation_date": 1421901203, "question_id": 28081348, "link": "https://stackoverflow.com/questions/28081348/golang-code-coverage-in-integration-tests", "title": "golang code coverage in integration tests?", "body": "<p>It seems the point of \"go tool cover -var=foo\" may be to generate instrumented code that can be deployed in an integration test harness.  Is anyone using this feature for that purpose?  If so, is there a conventional way to dump the counters periodically?  It seems the tricky part would be doing this across all files of interest with near simultaneity.  Even then, some skew (if using -mode=count) would be unavoidable.</p>\n"}, {"tags": ["go", "vpn", "pptp"], "answers": [{"tags": [], "owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "is_accepted": false, "score": 1, "last_activity_date": 1421903894, "last_edit_date": 1421903894, "creation_date": 1421903200, "answer_id": 28081606, "question_id": 28081336, "link": "https://stackoverflow.com/questions/28081336/how-to-use-vpnpptp-with-golang-net-package/28081606#28081606", "title": "How to use VPN(pptp) with golang net package?", "body": "<p>You probably want <a href=\"http://golang.org/pkg/net/#Interfaces\" rel=\"nofollow\"><code>net.Interfaces()</code></a> to get a slice of <a href=\"http://golang.org/pkg/net/#Interface\" rel=\"nofollow\"><code>net.Interface()</code></a> representing the network interfaces on your system, or, as you know the interface names, you can use <a href=\"http://golang.org/pkg/net/#InterfaceByName\" rel=\"nofollow\"><code>net.InterfaceByName()</code></a> to get a particular <code>net.Interface</code>.</p>\n\n<pre><code>ppp0, err := net.InterfaceByName(\"ppp0\")\n</code></pre>\n\n<p>You can then call <a href=\"http://golang.org/pkg/net/#Interface.Addrs\" rel=\"nofollow\"><code>Interface.Addrs()</code></a> on the returned <code>net.Interface</code> and get the interface's IP address(es).</p>\n\n<pre><code>addrs, err := ppp0.Addrs()\n</code></pre>\n\n<p>You can then use the desired address in the rest of your code (probably using <a href=\"http://golang.org/pkg/net/#ListenIP\" rel=\"nofollow\"><code>net.ListenIP</code></a> or <a href=\"http://golang.org/pkg/net/#DialIP\" rel=\"nofollow\"><code>net.DialIP</code></a>.</p>\n\n<pre><code>addr, err := net.ResolveIPAddr(\"ip4\", addrs[0])\n// check err\nconn, err := net.ListenIP(\"ip4:pptp\", addr)\n// check err, then do stuff with conn\n</code></pre>\n\n<p>Regarding doing this for more than one interface concurrently, you can launch a goroutine for each listener / interface, and move the traffic over channels, but this really depends on what you want to do. (are you just logging the data, sending  the data, modifying the data etc.)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11701977, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C54BCHH12r0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re6uVlrTmt8fa5VfbIHYoEOsHDMSg/photo.jpg?sz=128", "display_name": "Mitch Li", "link": "https://stackoverflow.com/users/11701977/mitch-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1561538418, "creation_date": 1561538418, "answer_id": 56768662, "question_id": 28081336, "link": "https://stackoverflow.com/questions/28081336/how-to-use-vpnpptp-with-golang-net-package/56768662#56768662", "title": "How to use VPN(pptp) with golang net package?", "body": "<p>The dialer's LocalAddr doesn't work for ppp interfaces, we should set the <code>SOL_SOCKET</code> flag to socket using <code>setsockopt</code>, for go 1.11+ you can create a dialer like this</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    dialer := net.Dialer{\n        Control: func(network, address string, c syscall.RawConn) error {\n            return c.Control(func(fd uintptr) {\n                err := syscall.SetsockoptString(int(fd), syscall.SOL_SOCKET, 25, \"ppp0\")\n                if err != nil {\n                    log.Printf(\"control: %s\", err)\n                    return\n                }\n            })\n        },\n    }\n    // use the dialer\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 2228376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6f566ff9d2f7759a076d514a6a358dc?s=128&d=identicon&r=PG", "display_name": "yh_like_programing", "link": "https://stackoverflow.com/users/2228376/yh-like-programing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2539, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1561538418, "creation_date": 1421901139, "question_id": 28081336, "link": "https://stackoverflow.com/questions/28081336/how-to-use-vpnpptp-with-golang-net-package", "title": "How to use VPN(pptp) with golang net package?", "body": "<p>I've bound several vpn on the server which is ppp0 ~ ppp4.\nNow comes the problem.I want to start 5 progresses each one use the difference network interface.<br />\nproc0 -> ppp0<br />\nproc1 -> ppp1<br />\nproc2 -> ppp2<br />\nproc3 -> ppp3<br />\nproc4 -> ppp4<br />\nI now how to do this with c language.Just use setsockopt with parameter SO_BINDTODEVICE.\nBut how to do this with net package in golang?</p>\n"}, {"tags": ["regex", "go"], "answers": [{"tags": [], "owner": {"reputation": 65435, "user_id": 2206004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCB1e.png?s=128&g=1", "display_name": "hwnd", "link": "https://stackoverflow.com/users/2206004/hwnd"}, "is_accepted": true, "score": 1, "last_activity_date": 1421891289, "last_edit_date": 1421891289, "creation_date": 1421889639, "answer_id": 28079852, "question_id": 28079788, "link": "https://stackoverflow.com/questions/28079788/get-rid-of-the-outer-tag-using-golang-and-regexp/28079852#28079852", "title": "get rid of the outer tag using golang and regexp?", "body": "<p>You can use the following to get your desired output.</p>\n\n<pre><code>package main\n\nimport (\n   \"fmt\"\n   \"regexp\"\n)\n\nfunc main() {\n    re := regexp.MustCompile(\"(?s)&lt;dxh[^&gt;]*&gt;.*?({{[^}]*}}).*?&lt;/dxh&gt;\")\n\n    input := `aaa&lt;div&gt;&lt;dxh r=\"4\" spans=\"1:15\"&gt;&lt;c r=\"A4\" s=\"7\"&gt;&lt;v&gt;{{4567}}\n              &lt;/v&gt;&lt;/c&gt;&lt;c r=\"B4\" t=\"s\" s=\"7\"&gt;&lt;v&gt;11&lt;/v&gt;&lt;/c&gt;&lt;c r=\"C4\" t=\"s\" s=\"7\"&gt;&lt;v&gt;12&lt;/v&gt;\n              &lt;/c&gt;&lt;c r=\"M4\" t=\"s\" s=\"8\"&gt;&lt;v&gt;20&lt;/v&gt;&lt;/c&gt;&lt;/dxh&gt;aaa&lt;/div&gt;bbb&lt;dxh&gt;{{12345}}\n              &lt;/dxh&gt;amrambler`\n\n    res := re.ReplaceAllString(input, \"$1\")\n    fmt.Println(res) // aaa&lt;div&gt;{{4567}}aaa&lt;/div&gt;bbb{{12345}}amrambler  \n}\n</code></pre>\n\n<p><kbd><a href=\"http://play.golang.org/p/PdOEt0_ayf\" rel=\"nofollow\"><strong>GoPlay</strong></a></kbd></p>\n"}], "owner": {"reputation": 285, "user_id": 3373877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/532526780ffab7d05fae3a14045c3f8d?s=128&d=identicon&r=PG&f=1", "display_name": "user3373877", "link": "https://stackoverflow.com/users/3373877/user3373877"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 28079852, "answer_count": 1, "score": 0, "last_activity_date": 1421891289, "creation_date": 1421889143, "last_edit_date": 1421889672, "question_id": 28079788, "link": "https://stackoverflow.com/questions/28079788/get-rid-of-the-outer-tag-using-golang-and-regexp", "title": "get rid of the outer tag using golang and regexp?", "body": "<p>I am using the goalng to do some template,and want to get rid of the outer  tag .\nas the following:</p>\n\n<pre><code>  input := `aaa&lt;div&gt;&lt;dxh r=\"4\" spans=\"1:15\"&gt;&lt;c r=\"A4\" s=\"7\"&gt;&lt;v&gt;{{4567}}\n\n&lt;/v&gt;&lt;/c&gt;&lt;c r=\"B4\" t=\"s\" s=\"7\"&gt;&lt;v&gt;11&lt;/v&gt;&lt;/c&gt;&lt;c r=\"C4\" t=\"s\" s=\"7\"&gt;&lt;v&gt;12&lt;/v&gt;\n\n&lt;/c&gt;&lt;c r=\"M4\" t=\"s\" s=\"8\"&gt;&lt;v&gt;20&lt;/v&gt;&lt;/c&gt;&lt;/dxh&gt;aaa&lt;/div&gt;bbb&lt;dxh&gt;{{12345}}\n\n&lt;/dxh&gt;amrambler`\n</code></pre>\n\n<p>and i want to get the string. it ommit the tag <code>\"&lt;dxh ....&gt;\"</code>,<code>\"&lt;/dxh&gt;\"</code> . and only remain the content between them, <code>\"{{4567}}\"</code> and <code>\"{{12345}}\"</code></p>\n\n<pre><code>str=`aaa&lt;div&gt;{{4567}}aaa&lt;/div&gt;bbb{{12345}}amrambler`\n</code></pre>\n\n<p>thanks in advance !</p>\n"}]